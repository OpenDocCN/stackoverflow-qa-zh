# StackOverflow 问答 000609000-000609999

# java - Java中的弹跳球

> ID：609002
> 
> 赞同：3
> 
> 时间：2009-03-04T02:05:24.867
> 
> 标签：java, graphics, physics

这可能是一个非常基本的问题，但我似乎找不到任何其他文章。

无论如何，我已经用 Java 编写了一个小的弹跳球程序来尝试扩展我的基本技能。该程序只是一个简单的弹跳球，它会掉落并*希望*弹跳一段时间。原始程序运行良好，但现在我尝试在程序中添加重力。重力实际上可以正常工作一段时间，但是一旦反弹变得非常小，动画就会在很短的时间内变得不稳定，然后球的位置就会不断减小。我试图找出问题所在，但我就是看不到它。任何帮助都将受到欢迎。

```
public final class Ball extends Rectangle {
float xspeed = 1.0f; float yspeed = 1.0f; float gravity = 0.4f;

public Ball(float x, float y, float width, float height) {
    super(x, y, width, height);
}

public void update(){
    yspeed += gravity;

    move(xspeed, yspeed);

    if(getX() < 0){
        xspeed = 1;
    }
    if(getX() + getWidth() > 320){
        xspeed = -1;
    }
    if(getY() < 0){
        yspeed = 1;
    }
    if(getY() + getHeight() > 200 && yspeed > 0){
        yspeed *= -0.98f;
    }
    if(getY() + getHeight() > 200 && yspeed < 0){
        yspeed *= 0.98f;
    }

}

public void move(float x, float y){
    this.setX(getX()+x);
    this.setY(getY()+y);
} 
```

}

编辑：谢谢，似乎已经对不稳定的运动进行了分类。我仍在努力寻找如何在球停止弹跳时阻止它向下移动。现在它会移动停止弹跳然后继续向下移动通过“地板”。我认为这与我的 yspeed += 重力线有关。我只是看不出我将如何停止运动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T02:24:06.070

当你这样做

```
yspeed += gravity; 
```

您*假设*球有空间移动距离 dx = v_i * t + 1/2 (-g) t^2。当您非常靠近地板时，这可能不是真的。如果出现以下情况，它会失败：

*   你离地板足够近并且向下移动
*   您非常靠近地板并且速度很低（例如当球失去大部分能量时）

此错误会导致您的模拟*停止保存能量*，从而导致您在低幅度下看到的不稳定行为。

您可以通过使用较小的时间步来减少问题，如果您进行测试计算以注意到您何时没有空间并*为该*迭代选择一个安全的时间步（即始终使用您的默认值，除非有问题，则计算最佳时间步长）。

但是，您在此处使用的基本近似值也存在其他问题。在任何数值分析文本中查找关于数值求解微分方程的讨论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T02:24:42.650

我怀疑这是因为当球反弹时，它实际上会略低于“地面”，并且在低速时，它不会在一个滴答声中移回地面 - 所以下一次 update() 会看到它仍然低于地面，然后再次反弹 - 但这次*向下，所以循环继续。*

当球反弹时，您需要将球移回地面，如下所示：

```
 if(getY() + getHeight() > 200){
            yspeed *= -0.981;
            setY(200 - getHeight());
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T02:25:24.647

首先要做的事情：当你在窗口顶部弹跳时将 y-speed 设置为 1 是不正确的，你应该将 yspeed 设置为 -yspeed （但如果你从边界内开始，它无论如何都不应该弹到顶部）。

其次，在底部弹跳时乘以 -0.981 是可以的，但我担心每次迭代都会向 yspeed 添加恒定的 0.4 重力。我认为这就是导致您在底部摆动的原因，因为您在检查可能导致球跌至地面以下之前进行了移动。

我会尝试通过替换移动来确保 y 值永远不会低于地面：

```
if (getY() + getHeight() + yspeed > 200) {
    move(xspeed, 200 - getY() - getHeight());
} else {
    move(xspeed, yspeed);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T02:25:40.310

问题是当反弹变得非常小时，

```
yspeed *= -0.981; 
```

线路将在短时间内被调用。球会低于底部，然后开始反弹，但最终仍会低于底部（因为 0.981 < 1.0），并且它的表现会非常糟糕。以下是您修复它的方法：

```
if(getY() + getHeight() > 200){
  yspeed *= -0.981;
  setY(400 - getY() - getHeight()); // I believe this is right.
} 
```

通过固定位置，您不会在减少和增加之间快速交替，也不会陷入它总是在减少的情况，因为它总是低于界限​​。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T02:25:45.927

[编辑：我想我误解了，所以这可能没什么用:)]

```
if(getY() + getHeight() > 200){
  yspeed *= -0.981;
} 
```

您正在否定每次更新的垂直速度。我可能会尝试在更新大小的切片中处理重力。假设您每秒进行 30 次更新（对于 30fps），可能类似于

```
// Define some constants
SecondsPerUpdate = (1.0f / 30);
AccelDueToGravity = 0.981;

if(getY() + getHeight() > 200){
  yspeed -= (AccelDueToGravity * SecondsPerUpdate);
} 
```

# ruby - 在 Ruby 中删除目录的安全且简单的方法是什么？

> ID：609014
> 
> 赞同：27
> 
> 时间：2009-03-04T02:09:58.943
> 
> 标签：ruby

我想删除一个可能包含也可能不包含文件或其他目录的目录。在 Ruby 文档中我找到[了 Dir.rmdir](http://apidock.com/ruby/Dir/rmdir/class)但它不会删除非空目录。有没有一种方便的方法可以让我这样做？还是我需要编写一个递归方法来检查目录下的所有内容？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-03-04T02:35:47.523

```
require 'fileutils'

FileUtils.rm_rf(dir) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T04:24:19.107

纯 Ruby 方式：

需要'fileutils'

FileUtils.rm_rf("/directory/to/go")

如果您需要线程安全：（警告，更改工作目录）

FileUtils.rm_rf("directory/to/go", :secure=>true)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-09T20:21:23.070

如果有人在@ferventcoder 评论上寻找答案 -

请注意，我发现使用 Windows 和 Ruby 1.9.3（至少）FileUtils.rm_rf 将跟随链接（在这种情况下为符号链接）并删除这些文件和文件夹。这是基于使用 CreateSymbolicLinkW 创建符号链接，然后针对符号链接所在的父目录运行 FileUtils.rm_rf 发现的。不完全是预期的行为。

– 狂热的编码器

最安全的方法是迭代路径并手动删除它。

def rec_del（路径）：

1.  如果路径是文件调用 FileUtils.rm_rf - 即使在 Windows 中也可以安全删除
2.  如果 dir 调用 Dir.rmdir 将成功为空 dir 和 dir 符号链接。否则将获得常规非空目录的 ENOTEMPTY。
3.  迭代目录并为每个项目调用 rec_del。
4.  现在再次调用 Dir.rmdir 这将成功

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2009-03-04T02:12:55.223

最懒的方法是：

```
def delete_all(path)
    `rm -rf "#{path}"`
end 
```

# javascript - 在 iphone 上没有提交按钮的情况下在键盘关闭时提交 ajax 表单？

> ID：609021
> 
> 赞同：2
> 
> 时间：2009-03-04T02:13:26.190
> 
> 标签：javascript, iphone, html, ajax

我在 iphone 上提交 AJAX 表单时遇到问题。我在顶部有一个搜索字段，没有提交按钮。我的计划是当用户在 iphone 键盘上点击“Go”或“Search”时提交表单。有人有什么想法吗？

编辑：我有 ajax 工作，但我似乎无法在按搜索后关闭键盘。

这是代码：

```
<form id="searchForm" method="post" onsubmit="event.preventDefault(); showSearch(search.value);">
        <input type="text" name="search" id="searchField">
</form> 
```

谢谢！我得到了它。谁知道会这么简单。我刚刚添加了 search.blur(); 到提交。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T03:39:00.803

要移除键盘，您需要做的就是移除对该特定字段的关注。你可以用 JavaScript 做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T03:41:36.460

几年前，我曾尝试使用内置于其中一款零售库存管理手持设备中的条形码扫描仪和内置网络浏览器。这是一个仓库管理系统，我想让它基于网络。有一个可以在设备上运行的第三方浏览器。

所以我有一个输入框，条形码扫描仪会“输入”到输入框（它的行为就像一个键盘楔子）。我遇到的问题是条形码扫描仪无法按 RETURN 启动搜索，这与您的问题类似。该设备也有一个虚拟键盘，因此人们可以打开它然后按回车键，但这只是破坏了条形码扫描仪提供的瞄准射击的灵活性。

我想出的解决方案是运行一个计时器，看看输入框的内容是否发生了变化。如果一段时间后没有任何变化，我认为输入已经完成，我强制提交。

这也可能对您有用。

# javascript - 我可以在这里使用 Javascript 闭包而不是全局变量吗？

> ID：609023
> 
> 赞同：0
> 
> 时间：2009-03-04T02:15:03.220
> 
> 标签：javascript, closures

当前设置：

```
var placeId;
function selectPlace(place) {
    $('#selectPlace').html('Selected Place: <b>' + place.Name + '</b>');
    $('#map').hide(400);
    placeId = place.Id;
}

$(document).ready(function()
{
    $('#postMessage').click(function() {
        alert("PlaceId: " + placeId);
    });
}); 
```

我可以/应该使用闭包吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-04T02:29:24.857

这似乎是一件合理的事情，根据上下文，您可以通过用函数表达式替换代码来轻松地做到这一点：

```
 (function(){
     var placeId;
     // It looks like you want selectPlace to be a global function?
     // hence i'm using assignment of a function expression here
     selectPlace = function (place) { 
         $('#selectPlace').html('Selected Place: <b>' + place.Name + '</b>');
         $('#map').hide(400);
         placeId = place.Id;
     }

     $(document).ready(function()
     {
         $('#postMessage').click(function() {
             alert("PlaceId: " + placeId);
         });
     });
 })(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T07:15:38.287

根据您的评论，您正在寻找的似乎是：

```
function selectPlace(place) {
  if(!place){
    return selectPlace.placeId;
  }else{
    $('#selectPlace').html('Selected Place: <b>' + place.Name + '</b>');
    $('#map').hide(400);
    selectPlace.placeId = place.Id;
  }
}

$(document).ready(function(){
  $('#postMessage').click(function() {
    alert("PlaceId: " + selectPlace());
  });
}); 
```

这不使用闭包，它只是将最后分配的 ID 存储在函数对象上。然后，如果他们不将该函数用作设置器，则您将返回该值。如果你想使用闭包来做同样的事情，它看起来很像上面的例子：

```
(function(){
  var placeId;

  window.selectPlace = function(place) {
    if(!place){
      return placeId;
    }else{
      $('#selectPlace').html('Selected Place: <b>' + place.Name + '</b>');
      $('#map').hide(400);
      placeId = place.Id;
    }
  }
})(); 
```

顺便说一句，发现闭包的最简单方法是，如果一个函数中的变量尚未`var`在当前函数内部声明，但已在它所在的其他函数中。正如你在上面看到的，变量`placeId`没有在`selectPlace`函数内部声明，这意味着`selectPlace`函数是一个使用`placeId`变量的闭包。

# soap - gsoap - SOAP Header 中的 WS-Addressing 元素

> ID：609030
> 
> 赞同：1
> 
> 时间：2009-03-04T02:19:20.807
> 
> 标签：soap, wsdl, header, gsoap, ws-addressing

我需要在我的 Soap 标头中添加 WS Addressing（我正在使用 gsoap 框架）。有没有办法自动添加？我查阅了 gsoap 文档，但没有找到任何相关信息。所以现在我已经手动将 WS-Addressing 添加到我的 SOAP_ENV_Header 中，如下所示

```
struct SOAP_ENV__Header
{
   mustUnderstand _wsa__MessageID wsa__MessageID 0;
   mustUnderstand _wsa__RelatesTo *wsa__RelatesTo 0;
   mustUnderstand _wsa__From *wsa__From 0;
   mustUnderstand _wsa__ReplyTo *wsa__ReplyTo 0;
   mustUnderstand _wsa__FaultTo *wsa__FaultTo 0;
   mustUnderstand _wsa__To wsa__To 0;
   mustUnderstand _wsa__Action wsa__Action 0;
}; 
```

但我想自动生成它，因为我必须向 Soap Header 添加一些其他结构，这些结构是从我的 wsdl/xsd 文件自动生成的。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-30T11:46:46.903

您可以在 typemap.dat 中定义 SOAP_ENV_Header，如下所示：

```
wsa = <http://schemas.xmlsoap.org/ws/2004/08/addressing>

SOAP_ENV__Header =\
#import "wsa.h"\n\
struct SOAP_ENV__Header\n\
{\n\
   mustUnderstand _wsa__MessageID    wsa__MessageID 0;\n\
   mustUnderstand _wsa__RelatesTo *  wsa__RelatesTo 0;\n\
   mustUnderstand _wsa__From *       wsa__From      0;\n\
   mustUnderstand _wsa__ReplyTo *    wsa__ReplyTo   0;\n\
   mustUnderstand _wsa__FaultTo *    wsa__FaultTo   0;\n\
   mustUnderstand _wsa__To           wsa__To        0;\n\
   mustUnderstand _wsa__Action       wsa__Action    0;\n\
}; 
```

然后使用带有选项“-t”的 wsdl2h 来指定外部 typemap.dat。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-26T06:50:36.597

为 gSoap 使用 ws 寻址插件。

# php - 如何确定 FastCGI 是否用于运行 php 脚本

> ID：609044
> 
> 赞同：17
> 
> 时间：2009-03-04T02:25:47.330
> 
> 标签：php, iis, iis-7, fastcgi

我有一个托管站点，但在配置 Joomla 时遇到问题（在 IIS7 上运行 Joomla + php + mySQL + win server 2008）。我在本地机器上运行了类似的配置（IIS7 + vista x64 上的 Joomla + php + mySQL），所以我至少能够按照各种教程中关于如何设置它的说明进行操作。

托管站点的这种症状是我无法在 Joomla 中打开任何 SEO 设置（甚至不是第一个设置，“搜索引擎友好 URL”）。我得到 404（未找到文件）或 URL 显示正确重写，但始终显示主页的内容。我在我的家用机器上遇到了类似的问题，原来是因为我没有使用 FastCGI 来托管 php，所以我决定在托管站点上进行调查。

无论如何，我在托管站点上托管 joomla 的目录的 web.config 文件中注意到以下行：

```
<add name="Plesk_Handler_3522909676" path="*.php" verb="*" modules="IsapiModule" scriptProcessor="c:\program files (x86)\parallels\plesk\additional\pleskphp5\php5isapi.dll" resourceType="Either" /> 
```

根据过去的经验，我知道 php 在 fastCGI 下不运行时会出现一些问题。我注意到根文件夹中的 web.config 使用了以下行：

```
<add name="Plesk_Handler_0286090609" path="*.php" verb="*" modules="CgiModule" scriptProcessor="c:\program files (x86)\parallels\plesk\additional\pleskphp5\php-cgi.exe" resourceType="Either" /> 
```

我将它复制到 joomla 目录的 web.config 中，并得到了不同的行为......但仍然无法正常工作。如果我在运行 phpInfo() 的 joomla 目录中加载 .php 文件，则在 Server API 下它会显示 CGI/FastCGI 。这是对正在使用 FastCGI 的**肯定确认吗？**为什么 web 配置中的处理程序指向 modules="CgiModule" 而不是 modules="FastCgiModule" （我什至不确定是否存在，但我只是发现提到 CgiModule 很可疑）。

这是一个托管站点，据我所知，我无权访问 ApplicationHost.config 文件...

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-17T01:09:49.787

这是一个简单的测试：

1.  创建一个 phpinfo.php 文件

```
 <?php phpinfo(); ?> 
```

里面;

2.  请求[http://yoursite.com/phpinfo.php/foobar?foo=bar](http://yoursite.com/phpinfo.php/foobar?foo=bar)

3.  检查 phpinfo 的输出并查找 _SERVER["REQUEST_URI"]。

如果缺少此变量，则使用 CGI。如果变量存在并正确设置为 /phpinfo.php/foobar?foo=bar，则使用 ISAPI 或 FastCGI。查看服务器 API 的输出顶部附近；它应该设置为 ISAPI（这意味着正在使用 ISAPI）或 CGI/FastCGI（这意味着正在使用 FastCGI，因为我们已经排除了 CGI）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-04-01T19:12:08.400

php_sapi_name() 或 PHP_SAPI 都可以。

[http://php.net/manual/en/function.php-sapi-name.php](http://php.net/manual/en/function.php-sapi-name.php)

```
<?php
    if (php_sapi_name() != 'cgi-fcgi'){
        echo 'I knew fastcgi wasn\'t working.';
    }else{
        echo 'Holy crap, something worked for once.';
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-01-30T17:49:24.303

您可以使用 (on centos) `apachectl -M`，您将显示启用了哪些模块：

```
apachectl -M:

file_cache_module (shared)
mem_cache_module (shared)
version_module (shared)
fastcgi_module (shared) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-25T05:53:47.170

不幸的是，检查`\_SERVER["REQUEST_URI"]`对我不起作用。使用**CGI**或**FastCGI**，它总是显示`/phpinfo.php/foobar?foo=bar`。

也没有看到是否`Server API = CGI/FastCGI`已设置 - 它只告诉您编译后的 php 版本支持哪些接口，而不是正在使用什么。但是，我发现了另一种可能更可靠的方法。

Plonk 一个名为**phpinfo.php**的文件，其中包含以下文本：`<? php phpinfo(); ?>`

检查变量`\_ENV["REDIRECT_HANDLER"]`：
如果它设置为`php5-fastcgi`（或其他 fastcgi-ish），则请求很可能通过**FastCGI**。如果它被设置为`application/x-httpd-php`（或者我假设不是上面的），你正在使用**CGI**。

然而，一个万无一失的方法是运行一个小测试。为此，您需要`ab`(Apache Bench) 工具。
无论有没有 CGI，都可以从另一台机器上运行：

```
ab -c 100 -n 1000 http://yourdomain.com/path/phpinfo.php 
```

检查线路`Time taken for tests:`。至少在我的机器上，通过 1.3Mbps ADSL 连接访问我的 VPS，FastCGI 将其完全最大化，而使用 CGI 只能填充一半。

希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T04:05:28.057

你应该看到从

```
<?php
phpinfo();
?> 
```

服务器 API = CGI/FastCGI

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-06T20:42:35.477

Joomla 创建一个 .htaccess 文件，其中包含重写规则，以启用搜索引擎友好的 URL。如果您使用的是 Apache，则需要为包含您的 joomla 安装的目录设置“AllowOverride FileInfo”。如果您使用的是 IIS，您将需要一个模块，例如 IISModRewrite。以下是相关说明：[ [http://www.micronovae.com/ModRewrite/articles/SEFJoomla.html]](http://www.micronovae.com/ModRewrite/articles/SEFJoomla.html])

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-02T14:14:36.050

确保在 fastcgi 未运行时，最初设置为脚本完全失败的位置。然后你就会知道，当它工作时，fastcgi 守护进程就是原因。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-27T19:20:20.567

这对我有用。

```
/**
 * return phpinfo() results as an array
 *
 * @credit http://php.net/manual/en/function.phpinfo.php#106862
 * @param void
 * @return array
 */
function phpinfo_array(){
    ob_start();
    phpinfo();
    $info_arr = array();
    $info_lines = explode("\n", strip_tags(ob_get_clean(), '<tr><td><h2>'));
    $cat = 'general';
    foreach($info_lines as $line){
        preg_match('/<h2>(.*)<\/h2>/', $line, $title) ? $cat = preg_replace('/\s+/', '_', strtolower(trim($title[1]))) : null;
        if(preg_match('/<tr><td[^>]+>([^<]*)<\/td><td[^>]+>([^<]*)<\/td><\/tr>/', $line, $val)){
            $subcat = preg_replace('/\s+/', '_', strtolower(trim($val[1])));
            $info_arr[$cat][$subcat] = $val[2];
        } elseif(preg_match('/<tr><td[^>]+>([^<]*)<\/td><td[^>]+>([^<]*)<\/td><td[^>]+>([^<]*)<\/td><\/tr>/', $line, $val)){
            $subcat = preg_replace('/\s+/', '_', strtolower(trim($val[1])));
            $info_arr[$cat][$subcat] = array('local' => $val[2], 'master' => $val[3]);
        }
    }
    return $info_arr;
}

// output proper response code
$phpinfo = phpinfo_array();
$configure = (@isset($phpinfo['general']['configure_command'])) ?: null;

// properly account for FastCGI
if ($configure && preg_match('/--enable-fastcgi/', $configure)){
    // fastcgi response
    header('Status: 403 Access is forbidden');
} else {
    // http response
    header('HTTP/1.0 403 Access is forbidden');
} 
```

# visual-studio-2005 - 更改 ListBox 选择不会将更改从 BindingSource 移动到 DataSet

> ID：609052
> 
> 赞同：0
> 
> 时间：2009-03-04T02:30:45.837
> 
> 标签：visual-studio-2005, .net-2.0, c#-2.0

这个问题的答案可能是“不使用绑定导航器就不要使用类型化的数据集”。然而，我很好奇我看到的行为。

因此，我创建了一个表单，其中每个控件都从数据源浏览器中拖出。我删除了 Binding Navigator，因为它丑陋且不适合这种特殊形式。我添加了一个 ListBox 并将 DataSource 设置为 BindingSource。
请注意，ListBox 未绑定，它只是从 BindingSource 填充自身。通过一些我没有指望的魔法，在 ListBox 中四处移动正在导航 BindingSource 并且所有其他控件都相应地更新。

我可以对绑定的控件进行更改，并在 BindingSource 上显式调用 EndEdit，然后通过 Table Adapter 更新 DataSource。效果很好。

当我在绑定控件中进行更改并单击 ListBox 中的新选项时，我希望能够检查更改并提示保存或重置（如果有）。

这是我无法弄清楚的奇怪部分。

无论我附加到什么事件，DataSet.HasChanges 在第二个 ListBox 更改之前都不会返回 true。我已经搜索并尝试了几十个建议，其中大多数是荒谬的，但有一些看起来很有希望。没运气。

编辑：重要的不是第二次点击，而是当您再次点击原始（已编辑）项目时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-17T17:32:51.203

自从提出这个问题后，我对 BindingSources、DataSets 和 TableAdapters 有了更多了解。

这是有效的：

```
 private void MyListBox_Click(object sender, EventArgs e)
    {
        this.myBindingSource.EndEdit();
        if (myDataSet.HasChanges())
        {
            if (MessageBox.Show("Save changes?", "Before moving on", MessageBoxButtons.YesNo) == DialogResult.Yes)
            {
                myTableAdapter.Update(myDataSet.myDataTable);
            }
            else
            {
                myDataSet.RejectChanges();
            }
        }
    } 
```

# reflection - 不使用 RCW 调用 COM 对象方法的最快方法

> ID：609054
> 
> 赞同：2
> 
> 时间：2009-03-04T02:31:50.527
> 
> 标签：reflection, com, interop, rcw

我试图找到调用 COM 对象方法的最干净和最快的方法。

我为该对象使用了 RCW，但每次第三方 COM 对象的新版本出现时，它的 GUID 都会发生变化，这会使 RCW 变得无用，所以我不得不更改并开始使用

```
Type mytype = Type.GetTypeFromProgID("MyCOMApp.Application"); 
```

这样每当 COM 对象的新版本出现时，我就不必重新编译和重新部署我的应用程序。

目前我正在使用反射，`mytype.InvokeMemeber`但与仅调用 RCW 相比，我觉得它太慢了。

其他人如何解决更改第 3 方 COM 对象版本的问题，但仍保持 RCW 的速度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T02:37:47.473

如果您想让反射中的调用更容易，您可以使用 VB.NET，并对类型为 Object 的变量进行后期调用。VB.NET 将帮助调用反射。您还可以设置对 Microsoft.VisualBasic.dll 的引用并调用 CallByName 以帮助进行反射调用。

但是，是 IID（接口 GUID）还是类 GUID 发生了变化？如果是类 GUID 发生变化，则可以定义一次接口，然后通过调用 GetTypeFromProgID 获取 Type。一旦你有了它，你可以将类型传递给 Activator 类的 CreateInstance 方法，然后强制转换为接口，这不会改变。

但是，如果 IID 确实发生了变化，则每次都必须使用反射。

# detailsview - detailsview：插入/更新单条记录

> ID：609058
> 
> 赞同：0
> 
> 时间：2009-03-04T02:34:37.480
> 
> 标签：detailsview, sqldatasource

我想实现以下场景......

本题相关表格如下：

ProfileID int (identity) FirstName varchar(100) LastName varchar(100)

步骤 1\. 用户访问profiles.aspx 页面。在网格视图中，他可以看到其他人的个人资料。（我知道该怎么做。）

步骤 2\. 用户访问 MyProfile.aspx 页面。由于他的个人资料不存在，因此详细信息视图为空白，并启用了插入按钮。用户单击插入按钮，他只能添加自己的个人资料。（我不知道该怎么做）。

第 3 步。添加用户配置文件后，它会显示在profiles.aspx 页面上。他想更新自己的个人资料。他导航到带有 ProfileID 的 MyProfile.aspx 页面，可以说是 33。DetailsView 能够根据 profileid 提取他的个人资料并启用更新按钮。（我不知道该怎么做。）

有人可以帮我完成第 2 步和第 3 步。我不知道如何设置 sqldatasource 和 detailsview 来完成此操作。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-18T05:24:24.590

见下面的例子........ **源文件.aspx** 我正在使用gridview 和detailsview 来插入、更新、编辑一个卡车管理员表。执行以下步骤： 1.take a gridview.assign datakeynames 作为表中的唯一列。您可以为每个字段编写 boundfields。事实上这是更好的方法。2.获取数据源控制。将其绑定到您的表。3.将此数据源绑定到Gridview。通过以下代码，您将更好地理解此步骤。4.获取详细信息视图。将数据键名指定为表中的唯一列。5.获取另一个数据源。将其绑定到同一个表。声明插入命令，选择命令。声明选择参数，更新参数，如下面的代码。希望它会帮助你。

```
<asp:GridView id                  ="gridTruckMaster" 
          runat               ="server" 
          CssClass            ="GridView" 
          DataKeyNames        ="TruckType" 
          DataSourceID        ="SqlDataSource1" 
          AutoGenerateColumns ="False" 
          ShowFooter          ="True" 
          AllowPaging         ="True">
<FooterStyle BackColor="#5D7B9D" Font-Bold="True"    ForeColor="White"></FooterStyle>
<RowStyle    VerticalAlign="Top" BackColor="#F7F6F3" ForeColor="#333333"></RowStyle>
<Columns>
<asp:BoundField   DataField="TruckType"     HeaderText="TruckType"     SortExpression="TruckType"></asp:BoundField>
<asp:BoundField   DataField="TruckCapacity" HeaderText="TruckCapacity" SortExpression="TruckCapacity"></asp:BoundField>
<asp:CommandField ShowSelectButton="True"></asp:CommandField>
</Columns>
<PagerStyle       BackColor="#284775" HorizontalAlign="Center"   ForeColor="White"></PagerStyle>
<SelectedRowStyle BackColor="#669999" Font-Bold="True"           ForeColor="White"></SelectedRowStyle>
<HeaderStyle      BackColor="#5D7B9D" Font-Bold="True"           ForeColor="White"></HeaderStyle>
</asp:GridView> 

<asp:SqlDataSource ID               ="SqlDataSource1" 
                   runat            ="server" 
                   ConnectionString ="<%$ ConnectionStrings:GodrejReporterConnectionString %>"
                   SelectCommand    ="SELECT [TruckType], [TruckCapacity] FROM [tbl_TruckMaster]"></asp:SqlDataSource>

<asp:DetailsView  id               ="dtlviewTruckMaster"   
              runat            ="server"         
              CssClass         ="GridView" 
              Width            ="125px" 
              DataKeyNames     ="TruckType" 
              Height           ="50px" 
              AutoGenerateRows ="False"
              HeaderText       ="Truck Details"
        ><Fields>
<asp:BoundField   DataField="TruckType"     HeaderText="TruckType" ReadOnly="True"></asp:BoundField>
<asp:BoundField   DataField="TruckCapacity" HeaderText="TruckCapacity"></asp:BoundField>
<asp:CommandField ShowInsertButton="True"></asp:CommandField>
<asp:CommandField ShowEditButton="True"></asp:CommandField>
</Fields>
<FooterStyle     BackColor="#5D7B9D"      Font-Bold="True"    ForeColor="White"></FooterStyle>
<RowStyle        VerticalAlign="Top"      BackColor="#F7F6F3" ForeColor="#333333"></RowStyle>
<EditRowStyle    Width="250px"            Height="10px"/>
<InsertRowStyle  Width="250px"            Height="10px" />
<PagerStyle      HorizontalAlign="Center" BackColor="#284775" ForeColor="White"></PagerStyle>
<HeaderStyle     BackColor="#5D7B9D"      Font-Bold="True"    ForeColor="White"></HeaderStyle>
<CommandRowStyle BackColor="#5D7B9D" />
</asp:DetailsView> 

<asp:SqlDataSource ID               ="SqlDataSource2" 
                   runat            ="server" 
                   ConnectionString ="<%$ ConnectionStrings:GodrejReporterConnectionString %>"
                   SelectCommand    ="SELECT [TruckType], [TruckCapacity] FROM [tbl_TruckMaster] where TruckType=@pTruckType"
                   insertcommand    ="insert into tbl_TruckMaster(TruckType,TruckCapacity) values(@TruckType,@TruckCapacity)"
                   updatecommand    ="update tbl_TruckMaster set TruckCapacity=@TruckCapacity where TruckType=@pType"
    >
    <SelectParameters>
        <asp:ControlParameter ControlID="gridTruckMaster" Name="pTruckType" PropertyName="SelectedValue" />
    </SelectParameters>
    <UpdateParameters>
        <asp:ControlParameter ControlID="gridTruckMaster" Name="pType"      PropertyName="SelectedValue" />
    </UpdateParameters>
</asp:SqlDataSource> 
```

如果您遇到问题，可以通过 tbchandgude@gmail.com 给我发邮件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T02:55:27.680

好的，我会给你一个简单的解决方案，你可以根据自己的需要进行更改。

对于第 2 步：例如，您创建一个名为 create.aspx 的页面；在该页面中，您放置了所有需要的文本框和一个注册按钮。在该按钮的单击事件上，编写如下内容

```
//using System.Data;
//using System.Data.Sql; you have to import these

//Put connection string
SqlConnection sqlcon = new SqlConnection("your connection string here which will be able to find in MSDN");
sql.Open();
SqlCommand sqlcmd = new SqlCommand("INSERT INTO Statement which easily find in MSDN too",sqlcon);
sqlcmd.ExecuteNoneQuery();
sql.Close(); 
```

您可以根据需要将该代码插入到数据库中。在 INSERT INTO 字符串中，您连接您的输入，但要非常小心，这可能会导致非常危险的 SqlInjection 错误。（请阅读有关它的文章）。

对于第 3 步：一切都是一样的，除了你必须使用可以在 MSDN 上找到的“UPDATE ...”语句而不是放置“INSERT ....”语句。

问候， 波利亚。

# javascript - 在 ViewData 中使用选择列表填充下拉列表

> ID：609063
> 
> 赞同：2
> 
> 时间：2009-03-04T02:37:58.843
> 
> 标签：javascript, model-view-controller, drop-down-menu, viewdata, selectlist

我正在尝试填充 HTML。`selectlist`使用来自数据库调用的字符串值（位置地址）和文本（位置描述）字段填充的下拉列表。我将选择列表作为视图数据传递给我的视图。下拉列表填充得很好，但是当我使用该值时，它是 null 或空，正如我在我的 javascript 函数中放置的警报所看到的那样。这是代码任何想法为什么`this.locations.value`为空：

我的查看代码：

```
<script type="text/javascript">
    var map;
    var gdir;
    var geocoder = null;
    var addressMarker;

    function setDirections(fromAddress, toAddress, locale) {
        alert(toAddress);
        gdir.load("from: " + fromAddress + " to: " + toAddress, { "locale": locale });
    }
</script>

<div id="maincontent2">
    <form action="#" onsubmit="setDirections(this.from.value, this.locations.value, 'en_US'); return false">
        <table>
            <tr>
                <th align="left">From:&nbsp;</th>
                <td align="left" ><input type="text" id="fromAddress" name="from" size="35px" value="King of Prussia, PA"/></td>
                <th align="left">&nbsp;&nbsp;To:&nbsp;</th>
                <td align="left"> <%= Html.DropDownList("locations",(SelectList)ViewData["OfficeLocations"])%></td>
            </tr>
            <tr>
                <td></td>
                <td align="left">
                    <br />
                    <input name="submit" type="submit" value="Get Directions!" />
                </td>
            </tr>
        </table>
        <table>
            <tr>
                <td valign="top"><div id="drv_directions" style="width: 250px"></div></td>
                <td valign="top" style="padding-top:15px"><div id ="map_canvas"></div></td>
            </tr>
        </table>      
     </form>
</div> 
```

我的控制器代码：

```
public ActionResult Directions()
{
    uls_dbDataContext ulsdb_dc = new uls_dbDataContext();
    ViewData["OfficeLocations"] = new SelectList(ulsdb_dc.GetOfficeLocations(),"location_address", "location_name");
    ViewData["Title"] = "Directions";

    return View();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T03:05:26.640

Locations 是一个选择，没有 value 属性。要获取所选选项的值，您需要使用所选索引，找到正确的选项，并引用选项的值。但是，如果您使用 jQuery，则可以使用 jQuery 对象的 val() 方法获取 select 的值。我建议使用 jQuery，因为它会使代码更简单，并且 MS 将通过 Visual Studio 支持它。

使用 jQuery 的示例：

```
<script type='text/javascript'>
    $(document).ready( function() {
       $('form').submit( function() {
          var fromAddress = $(this).find('#from').val();
          var toAddress = $(this).find('#locations').val();
          var locale = 'en-US';

          ....
          return false;
       });
    });
</script>

  <form action="#">

    <table>
    <tr><th align="left">From: </th>

    <td align="left" ><input type="text" id="fromAddress" name="from" size="35px"
    value="King of Prussia, PA"/></td>
    <th align="left">  To: </th>
    <td align="left"> <%= Html.DropDownList("locations",(SelectList)ViewData["OfficeLocations"])%></td>

    ... 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-03-04T04:10:33.410

这是现在工作的代码：

```
<script type="text/javascript">

    var map;
    var gdir;
    var geocoder = null;
    var addressMarker;

    function setDirections(fromAddress, toAddress, locale) {

        gdir.load("from: " + fromAddress + " to: " + toAddress,
        { "locale": locale });
    }

    $(document).ready(function() {
        if (GBrowserIsCompatible()) {
            map = new GMap2(document.getElementById("map_canvas"));
            gdir = new GDirections(map, document.getElementById("drv_directions"));
            GEvent.addListener(gdir, "load", onGDirectionsLoad);
            GEvent.addListener(gdir, "error", handleErrors);

            setDirections("King of Prussia", "1302 Conshohocken Road, Conshohocken, PA 19428", "en_US");
        }
        $('form').submit(function() {
            var fromAddress = $(this).find('#from').val();
            var toAddress = $(this).find('#locations').val();
            var locale = 'en-US';
            alert(fromAddress);
            alert(toAddress);
            setDirections(fromAddress, toAddress, locale);
            return false;
        });

    });

</script> 
```

# php - PHP文件上传被部分上传“劫持”

> ID：609064
> 
> 赞同：6
> 
> 时间：2009-03-04T02:38:35.643
> 
> 标签：php, post, file-upload

我有一个网站每天收到 30-40k 张照片上传，我现在看到的问题出现的频率更高。这个问题是这样的：

我们的上传脚本（通过 $_FILES['name']['tmp_name']）接收到一个不是由用户上传的文件（照片），并且大部分时间收到的文件是“部分”上传。

当然，起初我认为这是我的 PHP 代码犯了一个简单的错误，我花了几天时间检查它以确保，但是在对代码进行检查后，我发现通过 HTTP POST 上传到 PHP 收到的文件实际上是错误的文件。所以问题在它到达我的代码之前就已经发生了。脚本接收到的 tmp 文件 (phpxxxx) 有时不正确，就好像它以某种方式被另一个进程覆盖，并且通常被部分上传的文件覆盖。

有没有人见过这样的问题？任何帮助是极大的赞赏。在搜索/询问其他 PHP 开发人员数天后，我将其作为最后的手段

回顾一下：

*   用户上传照片
*   PHP 脚本接收用户未上传的文件（预代码，通过 /var/tmp 中的 $_FILES）
*   通常接收到的错误文件是部分上传或损坏的上传
*   它似乎是随机发生的，而不是一直发生

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T08:04:37.390

您可以为临时文件尝试不同的名称以避免其被覆盖吗？你能确定新的、不正确的和不完整的文件的来源吗？

这是开发环境吗？是否可能有多个用户同时上传文件？

尝试使用非常小的图像来检查 SchizoDuckie 在文件大小问题上是否正确。

尝试使用不同的导航器来消除公认的远程可能性，即这是本地问题。

检查存储临时文件的目录的权限。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T07:42:59.237

首先，检查你的 PHP 版本。

其次，检查您的文件上传限制和 php.ini 中的 POST_MAX_SIZE

可能只是有人试图上传一个太大的文件:-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-25T19:40:17.853

PHP 的内置文件处理不支持部分上传。

每次上传后关闭 KeepAlives 和/或发送“连接：关闭”标题。

配置您的网络服务器以发送标头“允许范围：无”。

# c++ - 脚本语言在游戏编程中的作用

> ID：609076
> 
> 赞同：21
> 
> 时间：2009-03-04T02:51:51.633
> 
> 标签：c++, scripting

所以我在工作中一直在争论脚本语言在游戏开发中的正确角色。据我所知，对此有两种思想流派：

1）脚本语言功能强大，功能齐全。大部分游戏代码都是用这种语言编写的，并且只有在性能要求有必要时才会将代码移到 C++ 中。这通常类似于 Lua 或 Unrealscript。

2) 这种脚本语言极其有限。几乎所有的游戏代码都是用 C++ 编写的，而这种语言只是为了向设计人员公开底层功能。

我的挫败感来自于看到第二种方法经常被滥用，大型系统使用一种语言实现，而这种语言不具备使代码可维护的特性。

所以我开始支持第一种方法，但在与一些设计师交谈后，我意识到他们中的许多人似乎更喜欢第二种方法，而且大多数程序员更喜欢第一种。

所以我仍然想知道哪种方法更好。我只是看到糟糕的代码并责怪工具而不是程序员，还是我们真的需要更复杂的工具？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-04T03:40:03.530

当您处理像视频游戏这样复杂的事情时，编译的 C++ 代码的编译-链接-运行-测试周期非常非常慢。使用脚本引擎可以让您对游戏进行较大的功能更改，而无需编译程序。这是一个巨大的、大量的时间节省。正如你所说，需要优化的东西可以根据需要移到 C++ 中。

AAA 引擎高度受脚本驱动。Torque，用于 Tribes II（以及许多其他游戏！）是脚本化的，Unreal 有 Unrealscript 等等。脚本不仅适用于模组，它还是高效开发的关键。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-04T03:37:59.247

我认为设计师需要看到一种适合他们的语言。这是没有商量余地的：他们必须把时间花在设计上，而不是编程上。

如果脚本允许快速开发具有产品价值的游戏代码，那么程序员也应该这样做。但它必须具有产品价值：每件事都做两次并不能节省时间。因此，您必须保留脚本。如果开发人员可以在一周内编写库存系统脚本，或者在一个月内用 C++ 编写它，那么您需要功能齐全的脚本，如果只是为了给您更多时间来手动优化可能会达到性能限制的部分。所以不是库存，或者高分表，或者键映射系统，或者像角色应该做的那样的高级游戏逻辑。如果这样做可以节省您花在加速图形和物理速度上的任何时间，那么这一切都可以编写脚本：程序员需要能够准确地计算出瓶颈是什么，

设计师可能不应该知道或关心程序员是否使用脚本语言来实现游戏代码。他们不应该对（1）是好还是坏有意见。所以即使程序员想要（1）是对的，为什么这会给设计者带来不便呢？如果他们只需要相当少量的标准食谱，他们怎么会注意到脚本语言功能齐全？出了点问题，但我不认为 Lua 是一种太好的语言。

一种可能性是，对两者使用相同的脚本语言会成为在设计师使用的界面和游戏代码内部界面之间划清界限的障碍。正如我在顶部所说的那样，这是没有商量余地的。即使他们使用相同的脚本语言，程序员仍然必须为设计人员提供他们完成工作所需的功能。仅仅因为设计师使用 Lua 来编写 AI 策略和对话树，并且 Lua 是能够编写物理引擎的全功能语言，并不意味着您的设计师应该编写自己的物理引擎。或者使用超过 10% 的 Lua 能力。

请注意，您可能可以同时执行 (1) 和 (2)。没有理由不给程序员 Lua 和设计者一些功能不足的微型 DSL，这些 DSL 使用 Lua 脚本“编译”成 Lua。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-03-04T03:35:04.353

我认为你想要的平衡是这样的：你想要脚本中的游戏*逻辑*，但代码中的游戏*功能*。

脚本的一大优势是您可以轻松设置等待。例如：

敌人 = GetObjectFromScene ("enemy01"); 在 5 秒内 { 敌人.ThrowGrenadeAt (玩家); }

只是一个人为的例子。这种逻辑在 C++ 中设置会很烦人。脚本可以更容易地表达这种逻辑，但您希望实际功能（它调用的函数）在 C++ 中。

并且脚本不必*很*慢。有大量脚本游戏在游戏机上以 60fps 的速度运行，但它需要良好的设计并在上述选项 1 和 2 之间找到适当的平衡。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-04T03:04:41.790

我真的看不出大量脚本代码将优于大量 C++ 的论点。有人可以提出反驳论点。我见过用脚本语言编写的可怕的大型项目，这些项目都是从脚本思维开始的——把事情完成得又快又脏。不幸的是，这不能很好地扩展。真的没有办法仅仅基于编程语言来进行代码质量论证。人们可以用任何语言编写大量可维护的代码，无论是编译的还是脚本的。

无论如何，如果不知道性能瓶颈在哪里以及您的用户最想“编写”什么脚本，就真的不可能知道您的“方法 1”和“方法 2”之间的界限。

我建议使用“方法 3”，即全部或部分在 C++ 中完成，并在 C++ 中公开一个干净的 SDK。这将具有强制您编写代码的优势，就好像它是您组织之外的人必须使用的用户界面一样。它有望使它更易于维护，并具有为您实现脚本接口的附加副作用。您现在需要做的所有脚本接口就是转发到您的 SDK。中提琴！

使用这种方法，您可以避免在“脚本化”领域与 C++ 领域之间划清界限。您和您的用户可以选择使用 SDK 添加 C++ 功能或使用脚本语言。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-04T03:10:44.833

像往常一样，我认为答案是“视情况而定”。

光环 3 或使命召唤 4 不可能主要基于脚本。根据定义，顶级 AAA 游戏必须突破他们所接触的任何平台的极限。这不能通过脚本来完成。

然而，休闲游戏是另一回事。像 Unity 这样的主要游戏引擎内置了大量脚本。

模组也有市场。具有良好脚本环境的可靠游戏引擎可以成为调整、衍生甚至在某些情况下全新游戏的平台。Counter Strike 是我个人最喜欢的例子。我认为在这种情况下你仅限于 FPS 跑枪类型的游戏。

所以，在游戏中有一个脚本编写的地方，但它可能会留在小型/休闲游戏和模组制作者的空间中。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-04T12:15:34.900

脚本在行动中的最佳示例之一是《文明 IV》。它使用 Boost Python。结果，它非常缓慢。与“当性能表明有必要时将代码移入 C++”这一说法的明显对立面。

正确的方法是预先设计一个架构，并决定哪些问题是计算困难的，哪些是复杂的，需要预先指定。图形、物理、寻路、输入的即时反馈、文本到语音——所有这些显然都很难计算。“友好或敌对姿态”、“防御或攻击”、“花费或保存”类型的 AI 决策都很难预先指定。

结论是您希望将有能力但没有灵魂的演员暴露给您的脚本代码。脚本代码描述*了*演员应该做什么，但 C++ 代码负责*如何*.

关于编译链接周期，拥有适当的模块化架构很重要。当您处理寻路逻辑时，您永远不必编译图形代码。此外，Incredibuild 等工具可以帮助加快编译时间。大型游戏公司可能已经有一个渲染农场，它可以作为编译农场翻倍。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-04-06T09:56:44.320

说游戏应该只用 C++ 完成（或声称 AAA 游戏就是这样完成的）只是无知。现在的大多数游戏都以某种方式编写脚本，无论是专有脚本语言（UnrealScript）、通用语言（Lua、python、C#、Java 等）还是数据驱动（xml、专有二进制格式等）。只需进行一些研究，您就会发现大多数引擎都以一种或另一种形式使用脚本。

我认为是否拥有 1) 功能强大且功能齐全的脚本语言与 2) 极其有限的脚本语言的问题正在从错误的角度解决问题。脚本环境（语言或数据驱动）的设计应使其能够最好地支持创建游戏的过程。系统的表现力在这里至关重要：设计者和脚本编写者应该能够轻松解决他们遇到的问题而不会太头疼，同时他们不应该接触到他们难以理解和学习的过于复杂的系统。通常程序员（包括我自己）倾向于通过假设系统将如何使用并试图确保地球和天堂之间的所有功能都可以实现来设计系统，从而产生复杂的系统。被这种复杂性压得喘不过气来，

例如，在我们的游戏 ( [Rochard](http://www.rochardthegame.com/) ) 中，我们设计了一个完全可扩展且可编写脚本的数据驱动 AI 系统，但关卡设计师最终只使用了现有的 AI 模式，因为他们没有时间或精力充分利用 AI 系统程度。所以最后我只是创建了一个很好的 UI 来轻松选择那些股票 AI 模式。

我想说这件事没有灵丹妙药。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-11T17:25:55.797

> 所以我开始支持第一种方法，但在与一些设计师交谈后，我意识到他们中的许多人似乎更喜欢第二种方法，而且大多数程序员更喜欢第一种。

这应该是显而易见的：如果脚本语言“功能强大且功能齐全”，那么设计人员就有责任必须创建系统，因为他们可以利用这个机会。另一方面，如果脚本语言只暴露了硬编码游戏的小细节，那么程序员就必须创建这些系统，因为设计师做不到。我并不是说每一方都很懒惰，但显然双方都有项目要求他们关注的个人技能（因为没有其他人可以有效地做到这一点），这意味着总是有兴趣让其他人完成给定的任务，如果可能的。

自然而然地，合适的角色将取决于你公司的人力资源是如何布局的，以及你游戏的任何性能要求。一旦你知道有多少人需要任何类型的脚本，你就会知道有多少游戏需要它，因此可以决定界面需要多宽或多窄。正如上面 onebyone.livejournal.com 所提到的，这有助于语言的“域”是什么。

（无论如何，我是一名专业的游戏开发人员，也是 Gamedev.net 上脚本语言论坛的版主。）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-04T03:37:32.507

游戏开发社区已经使用脚本作为构建用户界面和调整 AI 响应的一种非常常见的方式。您可以在 Gamasutra 等网站上找到大量信息。有趣的是标准语言开始取代自定义解释器。

我想到的 AAA 游戏中最好的两个脚本示例是魔兽世界（使用 Lua）和 EvE Online（使用 Python）。EvE 也在服务器端使用脚本：他们对 Stackless Python 进行了大量投资。

更新：由于多核，性能基本上不会成为问题。即使是低端机器最终也会拥有比显示器和型号更新所需的更多内核。您不妨将其中一个内核用于运行 UI 的脚本解决方案。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-04T04:09:30.950

如前所述；使用脚本编写游戏逻辑，使用 C++ 编写游戏功能。一个示例是编写游戏模式脚本，但使用 C++ 进行渲染。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-10T04:24:27.087

如果我们将游戏分为两部分：引擎和实际游戏（设计）。

一个可靠的顶级游戏引擎很可能是用 C/C++ 编写的，有些人甚至使用汇编代码进一步优化。你可以用特定的 CPU 指令为图形和物理做很多非常快速的事情。仅从脚本语言渲染大型景观或多个复杂对象时，无法获得性能。

当谈到游戏本身时，有很多方面可以用更慢但更高级别的编程语言来完成。AI和其他游戏逻辑可以成功地用脚本编写。它可以加快开发速度，并以简单的方式为改装和社区扩展打开大门。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-01-12T00:56:06.943

我认为这里的海报支持方法＃1是正确的。这是一种更清洁的方法，尽管有设计师的抱怨，但仍会产生更好的长期效果。最终，代码将决定从平庸（差）到好的[游戏编程。](http://gameshastra.com/GameDev_Overview.html)

# c - 什么是 XML 解析器？使用外籍人士

> ID：609083
> 
> 赞同：0
> 
> 时间：2009-03-04T02:58:17.190
> 
> 标签：c, xml-parsing, expat-parser

这似乎是一个简单的问题。

但我一直在寻找一种 XML 解析器，以便在我的一个在 Linux 上运行的应用程序中使用。

我正在使用[Expat](http://en.wikipedia.org/wiki/Expat_%28XML%29)并通过读取一个 XML 文件来解析我的 XML 文件。但是，输出与输入相同。

这是我正在阅读的文件：

```
<?xml version="1.0" encoding="utf-8"?>
    <books>
         <book>
              <id>1</id>
              <name>Hello, world!</name>
         </book>
    </books> 
```

但是，在我通过这个之后，我得到的输出与输出完全相同。这让我想知道解析器的用途是什么？

还有一件事。我正在使用外籍人士。这似乎很难使用。我的代码如下：这读入一个文件。但是我的应用程序必须解析一个缓冲区，该缓冲区将由套接字接收，而不是从文件中接收。有没有任何人有这方面的样品？

```
int parse_xml(char *buff)
{
    FILE *fp;
    fp = fopen("mybook.xml", "r");
    if(fp == NULL)
    {
        printf("Failed to open file\n");
        return 1;
    }

   /* Obtain the file size. */
    fseek (fp, 0, SEEK_END);
    size_t file_size = ftell(fp);
    rewind(fp);

    XML_Parser parser = XML_ParserCreate(NULL);
    int done;
    memset(buff, 0, sizeof(buff));

    do
    {
        size_t len = fread(buff, 1, file_size, fp);
        done = len < sizeof(buff);

        if(XML_Parse(parser, buff, len, done) == XML_STATUS_ERROR)
        {
            printf("%s at line %d\n", XML_ErrorString(XML_GetErrorCode(parser)),
                                      XML_GetCurrentLineNumber(parser));
            return 1;
        }
    }
    while(!done);

    fclose(fp);
    XML_ParserFree(parser);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T03:08:14.793

Expat 是一个偶数驱动的解析器。您必须编写代码来处理标签、属性等，然后将代码注册到解析器。[这里](http://www.xml.com/pub/a/1999/09/expat/index.html)有一篇文章描述了如何做到这一点。

关于从套接字读取，根据您的平台，您可以将套接字视为文件句柄。否则，您需要自己从套接字读取数据，然后将数据显式传递给 expat。有一个 API 可以做到这一点。但是，我会先尝试让它与普通文件一起使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T03:16:22.357

我花了一些时间来理解 XML 解析（虽然我是用 Perl 而不是 C 来做的）。基本上，您注册回调函数。解析器将为每个节点 ping 您的回调并传入包含各种多汁位（如纯文本、任何属性、子节点等）的数据结构。您必须维护某种状态信息——例如您插入的哈希树，或者包含所有内容但不包含 XML 的字符串。

请记住，XML 不是线性的，像一大块文本一样解析它没有多大意义。相反，您将其解析为一棵树。祝你好运。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T08:24:06.813

您可能想要查看 libxml2 而不是 expat，它可能已经包含在您的发行版中。它比 expat 强大得多，并为您提供各种好东西：DOM（树模式）、SAX（流模式）、XPath（恕我直言，用 XML 做任何复杂的事情都是必不可少的）等等。它不像 expat 那样轻巧，但使用起来要容易得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T08:46:00.583

好吧，您选择了最复杂的 XML 解析器（事件驱动的解析器更难处理）。为什么是 Expat 而不是[libxml](http://xmlsoft.org/)？

# xslt - 如何在 XPath/XSLT 中获取数字的模数？

> ID：609086
> 
> 赞同：19
> 
> 时间：2009-03-04T03:02:10.643
> 
> 标签：xslt, xpath, modulo

我想计算 XPath 中数字的模数，但这不起作用：

```
<xsl:if test="(count()%8)"> 
```

我该怎么做？我在这里查看了 XPath[函数参考](http://www.w3schools.com/xpath/xpath_functions.asp)，但没有看到类似的内容。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-03-04T03:04:05.333

试试“模组”

见[http://www.w3.org/TR/xpath#numbers](http://www.w3.org/TR/xpath#numbers)

该链接的详细信息：

> mod 运算符返回截断除法的余数。例如，
> 
> 5 mod 2 返回 1
> 
> 5 mod -2 返回 1
> 
> -5 mod 2 返回 -1
> 
> -5 mod -2 返回 -1
> 
> 注意：这与 Java 和 ECMAScript 中的 % 运算符相同。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-03-04T03:04:59.683

尝试

```
<xsl:if test="(count() mod 8)"> 
```

就像在 XSL 中一样，你必须使用“mod”来获取模数

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-04T18:31:53.917

做加法/减法时也要小心。在进行加法时，$var1+$var2 应该是好的。但在减法中，由于破折号 (-) 在变量名中有效，$var1-$var2 不起作用。但是 $var1 - $var2 应该，并且 number($var1) - number($var2) 应该总是有效的，您可以看到我写的一篇文章，介绍了在 Novell 的 Identity Manager 产品中使用 XPATH。

[XPATH 数学思想](http://www.novell.com/communities/node/6109/xpath-and-math)

# java-me - J2ME 中的日期字段

> ID：609088
> 
> 赞同：4
> 
> 时间：2009-03-04T03:03:14.680
> 
> 标签：java-me

我在表单中使用了 DateField。当我尝试选择日期时，它会打开手机提供的日历功能。

如您所知，j2me 中的 UI 功能并不是那么好。我查看了第三方库来设计精美的 UI。到目前为止，我还没有找到任何让 DateField 看起来很棒的 api。有人知道任何支持 DateField 的 API 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T13:03:26.373

为此使用手机的本机控件正是 j2me 应该做的。该系统在更改电话语言时具有明显的优势，尤其是当字母表不是基本的 ASCII 字符时。

如果您想精确控制日历的外观，您需要自己在 Canvas 中绘制它并自己处理用户输入、屏幕大小和本地化问题。

通常，您可能希望查看 LWUIT 库，以寻找固定本机控件和直接屏幕访问之间的中间解决方案。

# xml - 有没有办法将 flex 中的标签映射到多个目录中的组件？

> ID：609092
> 
> 赞同：2
> 
> 时间：2009-03-04T03:04:44.177
> 
> 标签：xml, apache-flex, namespaces, xml-namespaces

给定一个 flex 应用程序或模块，您可以指定一个自定义 xml 命名空间，如下所示：

```
<mx:Module xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:custom="custom.namespace.*"> 
```

然后我们可以使用自定义标签来引用目录 custom/namespace/ 中的 mxml 组件。例如，如果我在 custom/namespace 目录中有组件 Custom1 和 Custom2，我可以像这样引用它们：

```
<custom:Custom1/>
<custom:Custom2/> 
```

有没有办法将多个目录映射到同一个标签上？也就是说，如果我在 custom/namespace 的子目录中有组件，例如带有组件 SubCustom1 的 custom/namespace/sub，有没有办法修改 flex 文档，以便自定义标签可以引用 SubCustom1？

请注意，我发现的一种解决方法是为每个目录添加一个新标签（例如 xmlns:custom.sub="custom.namespace.sub.*"，然后：

```
<custom.sub:SubCustom1> 
```

不过，这个解决方案似乎是一个杂项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T21:35:02.543

要在 flex 中创建自定义命名空间，您需要

1）创建一个自定义清单文件：例如

```
<?xml version="1.0" encoding="utf-8" ?>
<componentPackage>

    <component id="Accordion" class="mx.containers.Accordion"/>
    .... 
```

2) 在 flex-compiler.xml 文件中添加类似于以下内容的内容：

```
<compiler>
    ...
      <namespaces>
         <!-- Specify a URI to associate with a manifest of components for use as MXML -->
         <!-- elements.                                                                -->
         <namespace>
            <uri>http://mycustomnamespace.com</uri>
            <manifest>custom-manifest.xml</manifest>
         </namespace>
      </namespaces>
</compiler> 
```

[您可以在此处](http://blog.flashgen.com/2007/07/04/manifests-namespaces-and-flex-builder-2/)阅读更详细的说明。

这个问题也在[这里](http://www.actionscript.org/forums/showthread.php3?t=199432)得到了回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T05:19:20.343

命名直接遵循命名空间的 XML 规范。如果要更改`custom`引用子目录更改命名空间声明：

```
xmlns:custom="custom.namespace.*" 
```

到

```
xmlns:custom="custom.namespace.sub.*" 
```

# unit-testing - 当程序不适合函数式风格时，单元测试如何工作？

> ID：609100
> 
> 赞同：8
> 
> 时间：2009-03-04T03:09:41.437
> 
> 标签：unit-testing

我在考虑程序并没有真正计算任何东西的情况，它只是做了很多。当您编写计算某些东西并且需要检查结果的函数时，单元测试对我来说很有意义，但是如果您不计算任何东西怎么办？例如，我在工作中维护的一个程序依赖于让用户填写表格，然后打开一个外部程序，并根据用户输入自动执行外部程序。这个过程相当复杂。大约有 3000 行代码（分布在多个函数中*），但我想不出任何对单元测试有意义的事情。

这只是一个例子。您是否应该尝试对“程序”程序进行单元测试？

*编辑

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T03:17:44.613

我不是这方面的专家，但出于同样的原因，我已经困惑了一段时间。不知何故，我正在做的应用程序不适合为单元测试给出的示例（非常异步和随机，取决于大量的用户交互）我最近意识到（如果我错了请告诉我）它不进行一种全局测试是有意义的，而是对每个组件进行无数小测试。最简单的方法是在创建实际过程的同时甚至之前构建测试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T03:22:47.660

根据您的描述，这些是我希望进行单元测试的地方：

*   用户输入的表单验证工作是否正常工作
*   给定来自表单的有效输入是正确调用的外部程序
*   将用户输入输入到外部程序，看看你是否得到正确的输出

从您描述的声音来看，真正的问题是您正在使用的代码不是模块化的。我发现单元测试的好处之一是难以测试的代码要么不够模块化，要么接口笨拙。尝试将代码分解成更小的部分，您会发现编写单元测试有意义的地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T03:18:16.983

您在单个过程/方法中有 3000 行代码吗？如果是这样，那么您可能需要将代码重构为更小、更易于理解的部分，以使其可维护。当您这样做时，您将拥有可以并且应该进行单元测试的那些部分。如果没有，那么您已经拥有了这些部分——由您的主程序调用的各个过程/方法。

但是，即使没有单元测试，您仍然应该为代码编写测试，以确保您为外部程序提供正确的输入，并测试您在正常和异常条件下正确处理程序的输出。单元测试中使用的技术——比如模拟——可以在这些集成测试中使用，以确保您的程序在不涉及外部资源的情况下正确运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T03:57:16.423

您的应用程序的一个有趣“切入点”是您说“用户填写表格”。如果你想测试，你应该重构你的代码以将该表单的显式表示构造为数据结构。然后，您可以开始收集表单并测试系统是否对每个表单做出适当响应。

可能是您的系统采取的行动在文件系统受到影响之前是不可观察的。这里有几个想法：

*   为文件系统的初始状态设置一个 git 存储库之类的东西，运行一个表单，然后查看 git diff 的输出。这可能更像是回归测试而不是单元测试。

*   创建一个新模块，其唯一目的是使程序的操作可观察。这可以像将相关文本写入日志文件一样简单，也可以像您喜欢的那样复杂。如有必要，您可以使用条件编译或链接来确保该模块仅在系统处于测试状态时才执行某些操作。这更接近于传统的单元测试，因为您现在可以编写测试来说明*在收到表单 A 时，系统应该采取一系列动作 B*。显然，您必须决定应该观察哪些动作才能形成合理的测试。

我怀疑您会发现自己正在迁移到看起来更像回归测试而不是单元测试*本身的*东西。这不一定是坏事。不要忽视代码覆盖率！

（最后的附注：在交互式控制台应用程序的糟糕时代，Don Libes 创建了一个名为[Expect](http://expect.nist.gov/)的工具，它对您编写像用户一样交互的程序非常有帮助。在我看来，我们迫切需要类似的东西与网页交互。我想我会发布一个关于这个的问题:-)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T03:16:27.050

您至少应该重构看起来可能是问题的东西并对其进行单元测试。但作为一项规则，一个函数不应该那么长。一旦你开始重构，你可能会发现一些值得单元测试的东西

[关于 TDD 的好对象导师文章](http://blog.objectmentor.com/articles/2007/10/17/tdd-with-acceptance-tests-and-unit-tests)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T03:21:55.400

您不一定必须实现测试单个方法或组件的自动化测试。您可以实现一个自动化单元测试来模拟用户与您的应用程序交互，并测试您的应用程序是否以正确的方式响应。

我假设您当前正在手动测试您的应用程序，如果是这样，请考虑如何自动化并从那里开始工作。随着时间的推移，您应该能够将您的测试分成逐渐更小的块，以测试更小的代码部分。任何类型的自动化测试通常都比没有好得多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-04T03:22:22.373

大多数程序（无论语言范式如何）都可以分解为原子单元，这些原子单元接受输入并提供输出。正如其他响应者所提到的，考虑重构程序并将其分解为更小的部分。测试时，少关注端到端功能，多关注处理数据的各个步骤。

此外，一个单元不一定需要是一个单独的功能（尽管这通常是这种情况）。单元是可以使用输入和测量输出进行测试的功能部分。我在使用 JUnit 测试 Java API 时看到了这一点。单个方法可能不一定能提供我测试所需的粒度，尽管一系列方法调用可以。因此，我将其视为“单元”的功能比单个方法要大一些。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-04T03:52:22.707

正如一些人之前回答的那样，有几种方法可以测试您所概述的内容。首先是表单输入，可以通过几种方式进行测试。如果输入了无效数据、有效数据等会发生什么。然后可以测试每个函数，以查看这些函数在提供各种形式的正确和错误数据时是否以正确的方式作出反应。接下来，您可以模拟正在调用的应用程序，以确保您的应用程序正确地向外部程序发送和处理数据。不要确保您的程序也处理来自外部程序的意外数据。

通常，我想如何为分配给我维护的程序编写测试的方式是查看我手动执行的程序来测试程序。然后尝试弄清楚如何尽可能多地自动化它。此外，不要将您的测试工具仅限于您编写代码的编程语言。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-04T04:00:14.623

我认为一波测试偏执狂正在蔓延 :) 最好检查一下测试是否有意义，有时答案是否定的。

我唯一要测试的是确保正确处理虚假表单输入。我真的看不出自动化测试还有什么帮助。我认为您希望测试是非侵入性的（即在测试期间实际上没有保存记录），因此可能会排除其他几种可能性。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-04T10:31:36.193

如果你不能测试某样东西，你怎么知道它有效？软件设计的一个关键是代码应该是可测试的。这可能会使软件的实际编写更加困难，但它在以后更容易维护中得到了回报。

# php - 使用 PHP 对图像进行圆角处理？

> ID：609109
> 
> 赞同：1
> 
> 时间：2009-03-04T03:19:40.350
> 
> 标签：php, rounded-corners

有谁知道如何使用 PHP 脚本使图像具有圆角？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-02-16T07:57:57.590

它可以使用 php-gd 完成，但我最终使用 CSS 将该任务传递给浏览器：

> <img src="photo.jpg" width="42" height="42" alt="我的酷照片" style="border-radius: 15px; -moz-border-radius: 15px;" />

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-18T14:06:46.513

[从此链接](http://www.mywebmymail.com/?q=content/easyphpthumbnail-class)下载 easyphpthumbnail.class.php

从此您可以调整图像大小并将图像转换为圆形图像。

在下面的示例中，图像被转换为​​透明的圆形图像。

```
include_once('easyphpthumbnail.class.php');
$source = 'demo.jpg';
$width      =  100;
$height     =  100;    
$thumb = new easyphpthumbnail;
$thumb -> Thumbheight = $width;
$thumb -> Thumbwidth = $height;
$thumb -> Backgroundcolor = '#FFFFFF';
$thumb -> Clipcorner = array(2,50,0,1,1,1,1);
$thumb -> Maketransparent = array(1,0,'#FFFFFF',10);   
$thumb -> Createthumb($source); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-29T17:44:47.880

You can look at [https://www.phpcontext.com/thumbnailer/](https://www.phpcontext.com/thumbnailer/) . There's a script for creating nice rounded corner thumbs with PHP. They are antialiased too.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-04T11:10:17.907

有很多可用的选项，您可以使用 Google 找到它们。最简单的方法是使用[Thumbnailer](http://freelogic.pl/thumbnailer/demo)。它就像两行代码一样简单：

```
// make an object
$th=new Thumbnailer("your-photo.jpg");

// create a 120x90 thumb and round its corners
$th->thumbFixed(120,90)->round()->save("your-thumb.jpg"); 
```

很有趣，不是吗？:) 还有很多其他可用的选项。角落将被抗锯齿。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T04:30:08.293

与其修改图像，不如将其包装在一些 HTML 中，在每个角落都有图像，覆盖原始图像以提供圆角的外观？

通过在您的 .php 脚本中进行图像编辑，您将在您的 Web 服务器上施加过多的负载，这意味着您的应用程序将无法很好地扩展。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T04:41:55.817

GD 非常适合图像处理，但如果您使用 CSS，它对您来说会容易得多，并且在您的服务器上也容易得多。

这是使用 CSS 的一些很酷的图像效果的很棒的教程：

[http://www.webdesignerwall.com/tutorials/css-decorative-gallery/](http://www.webdesignerwall.com/tutorials/css-decorative-gallery/)

对于现代浏览器，您可以在纯 CSS 中完成：

[http://www.css3.info/preview/rounded-border/](http://www.css3.info/preview/rounded-border/)

其他几个值得注意的：

[http://www.spiffycorners.com/](http://www.spiffycorners.com/)

[http://www.html.it/articoli/niftycube/index.html](http://www.html.it/articoli/niftycube/index.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-24T17:01:20.787

[使用 php 创建一些圆形拇指](http://www.freelogic.pl/thumbnailer/)很容易，只需使用 Thumbnailer :)

# .net - 调用不带 .asmx 扩 展名的 IIS Web 服务

> ID：609125
> 
> 赞同：3
> 
> 时间：2009-03-04T03:33:30.677
> 
> 标签：.net, web-services, iis, asmx

我编写了一个 .NET Web 服务，供不受我控制的客户端使用（我的服务器是用 PHP 编写的实时服务器的模拟器）。Web 服务按需要工作，但客户端无法在其调用中添加 .asmx 扩​​展名或任何与此相关的扩展名。他们基本上使用[http://localhost/soap/MyWebService](http://localhost/soap/MyWebService)而 IIS 需要[http://localhost/soap/MyWebService.asmx](http://localhost/soap/MyWebService.asmx)。有没有办法让 IIS 响应没有 .asmx 扩​​展名的请求？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-04T03:41:02.780

添加通配符映射，它将通过 ASP.NET 路由所有请求：

[http://professionalaspnet.com/archive/2007/07/27/Configure-IIS-for-Wildcard-Extensions-in-ASP.NET.aspx](http://professionalaspnet.com/archive/2007/07/27/Configure-IIS-for-Wildcard-Extensions-in-ASP.NET.aspx)

您还需要进行一些 URL 重写，以允许传入的请求`http://localhost/soap/MyWebService`映射到`http://localhost/soap/MyWebService.asmx`.

[http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx)

基本上，您可以在`Application_BeginRequest`方法中添加类似以下内容：

```
string path = Request.Path;
if (path.Contains("/soap/") && !path.EndsWith(".asmx"))
    Context.RewritePath(path + ".asmx"); 
```

我还没有测试过它（它是一个 HACK），但它应该让你开始。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T03:43:55.067

您也可以将它单独放在一个目录中，然后在 IIS 中将其设置为默认文档。

在服务器上：C:/mywebsite.com/mywebservice/mywebservice.asmx

在 IIS 中将 mywebservice.asmx 设置为默认文档

在网上： http: [//mywebsite.com/mywebservice](http://mywebsite.com/mywebservice)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T14:36:31.107

在我看来，PHP 客户端出了点问题。他们不应该以任何方式解释服务的 URL。在服务器元数据或客户端配置中指定的任何 URL 都是它们应该使用的 URL。

我不了解 PHP，但谁能告诉我为什么 PHP 关心 URL 中有多少个点有意义？我看不出我的服务是在[http://localhost/foo/bar](http://localhost/foo/bar)还是“ [http://localhost/foo/barasmx?PHP=0](http://localhost/foo/b.a.r.asmx?PHP=0) ”对任何客户来说都很重要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-06T20:39:56.670

在 php 中你只需要调用 wsdl，你不需要 asxm 或 .net 做的那种愚蠢的事情。

一个简单的例子

```
$wsdl = "http://domain/wsdlfile.wsdl"; //url to wsdl 
$client = new SoapClient($wsdl,array('trace' => 1,'encoding' => 'UTF-8','exceptions' => 0)); 
$Return = $client->callfunction();
echo htmlspecialchars($client->__getLastResponse()); 
```

就这样。

# c# - 生成某些数据的防篡改签名？

> ID：609127
> 
> 赞同：8
> 
> 时间：2009-03-04T03:35:09.033
> 
> 标签：c#, .net

我有一个数据。目前，它是一个 XML 文件，但架构可能会发生变化。所以让我们暂时假设它是一个 C# 类。

当我将数据存储在磁盘或数据库中时，我需要添加某种签名或指纹或校验和或其他任何东西，以确保没有人可以修改数据。警告：即使是有权访问所有源代码的管理员或开发人员也不应该修改它。

我假设由于具有完整代码访问权限的人可以轻松创建新签名（签名需要以编程方式完成，因此无需手动输入密码），因此签名需要包含一些额外的数据。理想情况下，我应该能够从签名中提取这些数据，例如签名日期和一些字符串。

我的一般方法是使用对称加密。我从所有字段生成一个哈希，即 SHA-512，然后使用哈希作为密码加密该哈希和我的附加数据以获得我的签名。为了解密，我的函数将从文件中的实际数据生成哈希，并尝试解密签名。这不会是防篡改的，因为它很容易生成签名日期和附加信息仍然完好无损的签名。

由于我不是该领域的专家，我相信我正在尝试重新发明轮子，而且它不是一个很好的轮子。我只是想知道是否有一些标准方法？我相信我的部分请求是不可能的（毕竟如果有人控制了整个环境，那么那个人也控制了系统时间），但我仍然想知道这通常是如何解决的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-04T03:55:55.770

在我看来，您想要将[数字签名](http://www.rsa.com/rsalabs/node.asp?id=2182)与[安全数字时间戳](http://www.rsa.com/rsalabs/node.asp?id=2347)相结合。

简而言之，在签署数据后，您调用第三方 Web 服务以提供官方时间戳和他们自己的数字签名，将该时间戳链接到您的签名值，从而提供证据证明原始签名（以及原始数据）是在或在该日期之前。使用此方案，即使原始签名密钥后来被泄露、撤销或以其他方式失效，由于时间戳，在失效之前进行的任何签名仍然有效。

防篡改硬件签名设备可能会有所帮助。如果目标硬件是相当新的，它可能已经在主板上以[TPM](http://en.wikipedia.org/wiki/Trusted_Platform_Module)的形式提供了一些支持，但是有很多供应商愿意为他们自己的[硬件安全模块](http://en.wikipedia.org/wiki/Hardware_Security_Module)收费，或者稍微少一些。智能[卡](http://en.wikipedia.org/wiki/Smart_card)。

仅靠技术可能无法实现足够的安全性。您可能需要对系统进行独立验证。您可能需要远程闭路电视监控和机器位置记录或其他物理安全措施来检测或停止篡改。您可能需要第三方代码托管、审查和签名，以确保机器上加载的代码符合预期，并阻止和/或检测将后门逻辑插入代码中。

最重要的是，您需要为此花费多少金钱、时间和精力，很大程度上取决于如果记录被伪造，您将遭受的损失。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T03:55:32.463

您需要[数字签名](http://en.wikipedia.org/wiki/Digital_signature)和[可信时间戳](http://en.wikipedia.org/wiki/Trusted_timestamping)。受信任的时间戳让第三方参与验证消息。那么任何攻击者都无法“完全控制”整个系统。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T04:06:05.823

您可能希望通过使用[GPGME](http://www.gnupg.org/related_software/libraries.en.html) (GnuPG Made Easy) 来利用 PGP，该库旨在使应用程序更轻松地访问 GnuPG。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T04:12:36.370

杰弗里汉廷的回答是我认为你能做到的最好的。但它*并不*完美：

1）它不会阻止你的黑帽进行完全虚假的交易。

2）它并不能完全停止篡改交易。是的，新交易会有不同的时间戳，但是如果他们清理了相关数据，你如何证明时间戳被弄乱了？即使你给他们一些防篡改收据（散列并在上面签名），当涉及到摊牌时，你如何证明谁的记录是伪造的？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T03:41:35.417

您需要使用非对称加密的[数字签名。](http://en.wikipedia.org/wiki/Digital_signature)

这篇[文章](http://www.c-sharpcorner.com/UploadFile/Gowri%20S%20Paramasivam/Cryptography211242005003308AM/Cryptography2.aspx)似乎有一些很好的例子和解释。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T03:43:40.747

这基本上就是[代码签名](http://msdn.microsoft.com/en-us/library/ms537361.aspx)的内容，除了在您的情况下，实际上签名的不是代码。您必须安排购买证书或设置自己的证书服务器。

# javascript - 是否有 Flash onload 事件？

> ID：609135
> 
> 赞同：1
> 
> 时间：2009-03-04T03:39:09.227
> 
> 标签：javascript, flash, dom-events

当 Flash 插件加载其内容时，有什么方法可以检测到错误？

基本上，我想做的是提供一些替代内容，以防在 Flash 插件尝试加载它的 .swf 文件时出现问题。

.swf 文件由 CMS 类型系统管理，因此我想创建某种回退默认内容，以防出现问题，例如 .swf 文件已被删除。

我知道如何检测闪存版本等，但我在这种情况下找不到任何资源。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T04:37:02.177

如果您使用[SWFObject](http://code.google.com/p/swfobject/)嵌入，那么我认为您想查看嵌入 javascript 的结果：

```
var so = swfobject.createSWF( ... ); 
```

以下是一些细节： http: [//pipwerks.com/lab/swfobject/test-embed-success/index.html](http://pipwerks.com/lab/swfobject/test-embed-success/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T23:15:22.660

不幸的是，没有这样的事件，您也无法使用 SWFObject 检测到这一点。
仅当您*拥有*SWF 文件时才有可能。

> 注意：如果所需的最低 Flash 播放器可用并且 SWF 的 Flash 插件 DOM 元素已创建，则成功报告为 true。**SWFObject 无法检测 swf 文件请求是否已实际加载**。

来自：[https ://code.google.com/p/swfobject/wiki/api](https://code.google.com/p/swfobject/wiki/api)

# php - 如何在 php 中使用全局缓存？

> ID：609150
> 
> 赞同：0
> 
> 时间：2009-03-04T03:45:16.547
> 
> 标签：php, caching

大家好，我是 php 和服务器脚本的新手（来自 java/cpp 背景）我的问题是，如果我希望能够构建某种单音缓存，它将在所有 Web 应用程序生命中将数据保存在内存中，当我启动Web服务器时，它将启动主缓存，该缓存将为Web应用程序提供服务，而不是在会话中静态缓存，例如c ++ / java中的单调映射，这一直存在我的选择是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T03:50:45.860

为此，在 PHP 中你需要[APC](http://au2.php.net/apc)，它现在几乎是 PHP 的标准（并且将成为 PHP 6 的标准）——你所要做的就是在配置中启用它——或者[memcached](http://www.danga.com/memcached/)，特别是如果你'有某种集群解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-19T19:57:29.650

```
function resetCache(){
    restoreCacheSession();
    session_unset();
    restoreTrueSession();
}

function restoreCacheSession(){

    $sessionId = session_id();
    if(strlen($sessionId))  {
        $origSetting = ini_get('session.use_cookies');
        session_write_close();
    }

    session_id('cache');
    ini_set('session.use_cookies', false);
    session_start();

    if($sessionId)
    {
        $_SESSION["_trueSessionId"] = $sessionId;
        $_SESSION["_trueSessionSettings"] = $origSetting;
    }
}

function restoreTrueSession(){
    if(isset($_SESSION["_trueSessionId"])){
        $sessionId = $_SESSION["_trueSessionId"];
        $origSetting = $_SESSION["_trueSessionId"];
    }

    session_write_close();

    if(isset($sessionId)) { 
        ini_set('session.use_cookies', $origSetting);
        session_id($sessionId);
        session_start();
    } 
    elseif(isset($_COOKIE['phpSESSID'])){ 
        session_id($_COOKIE['phpSESSID']);
        session_start();
    } 
    else { 
        session_start();
        session_unset();
        session_regenerate_id();
    }   
}

function cache($var, $value = null){
    restoreCacheSession();
    if(!isset($value)){
        if(isset($_SESSION[$var])){
            $result = $_SESSION[$var];
        }

        restoreTrueSession();
        return isset($result)?$result:null;
    }

    $_SESSION[$var] = $value;

    restoreTrueSession();
} 
```

要在缓存中设置变量，您只需`<?php cache("yourvarname",yourvarvalue) ?>` 要获取缓存中变量的值：`<?php cache("yourvarname") ?>` 重置缓存`<?php resetCache("yourvarname") ?>`

# c# - WebService、WebMethod 和继承

> ID：609152
> 
> 赞同：3
> 
> 时间：2009-03-04T03:49:11.357
> 
> 标签：c#, web-services, inheritance, asmx

在 Web 服务上下文中，我有以下类继承自 Mammal 类。Mammal 类是在代理中定义的。我无法更改该类的定义。因为我需要在客户端给 Mammal 类添加一些方法，所以我继承了 Mammal 并创建了 Giraffe。

```
namespace TestApplication
{  
    public class Giraffe : Mammal
    {
        public Giraffe()
        {
        }
    }
} 
```

当我调用一个期望 Mammal 类型对象的 WebMethod 时，我收到以下异常，告诉我不需要 Giraffe。

```
 Error: System.InvalidOperationException: There was an error generating the XML document. ---> System.InvalidOperationException: The type Giraffe was not expected. Use the XmlInclude or SoapInclude attribute to specify types that are not known statically.
   at Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriterPaymentRequestAuthorization.Write6_Tender(String n, String ns, Tender o, Boolean isNullable, Boolean needType)
   at Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriterPaymentRequestAuthorization.Write12_PaymentRequestAuthorization(String n, String ns, PaymentRequestAuthorization o, Boolean isNullable, Boolean needType)
   at Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriterPaymentRequestAuthorization.Write13_PaymentRequestAuthorization(Object o)
   --- End of inner exception stack trace --- 
```

有解决方法吗？我不能真正添加​​ XmlInclude ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T04:01:18.520

要添加方法，您应该使用部分类。尝试使用（在正确的命名空间等中）添加第二个类文件：

```
partial class Mammal {
    public void ExtraMethod() {...}
} 
```

该`partial`关键字告诉编译器允许将类拆分为多个文件 - 非常适合代码生成场景。但是，它确实需要`partial`每个文件中的关键字；这些成员只是简单地组合在一起（C# 3.0 中的部分方法除外，它们有自己的微妙行为）。我*希望*wsdl.exe（或其他）包含这个！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-10T01:18:06.453

如果您只想向无法更改的类添加方法，只需创建扩展方法。

```
public static class MammalExt {
public static void ExtraMethod(this Mammal mammal) {...}} 
```

虽然如果哺乳动物是一个代理生成的类，它应该是一个部分类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-08-03T13:36:16.530

您必须使用 XmlInclude。这是你唯一的选择。你必须告诉序列化器你将序列化哪个类，因为它必须生成代码来进行序列化。

写这篇文章的时候让我很震惊，你可能会在让 Giraffe 实现 IXmlSerializable 的情况下侥幸逃脱，但这需要更多的工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-10T10:51:50.850

正确的答案确实是使用部分类。当您打开客户端项目并生成 Web 引用时，Visual Studio 会解析 WSDL 并生成一个`Mammal`为您调用的类。此类仅对客户端项目可见，因此您不必担心服务器端的事情。

假设您有一个名为 MyWebService 的 Web 引用。然后会有一个类叫做`MyWebService.Mammal`. 要将成员添加到此类，您需要做的就是创建一个包含以下内容的新源文件：

```
namespace MyWebService {
    public partial class Mammal {
        public void ExtraMethod() { ... }
    }
} 
```

当您在 Web 服务上调用返回 a 的方法时`Mammal`，Web 参考代码将创建“改进的” Mammal 类的新实例，并将线路上的 xml 中的值复制到实例。

# performance - 监控 IIS 6.0

> ID：609153
> 
> 赞同：5
> 
> 时间：2009-03-04T03:49:35.647
> 
> 标签：performance, iis, iis-6, monitoring

我可以使用哪些好工具来监控 IIS。包含的内容似乎没有我想要的那么有用。我意识到我可以添加性能计数器；那些并没有告诉我太多；它只是插入到通用绘图工具中的属性集合。

我对旧的遗留应用程序挂起以及各种杂乱无章的其他事情有疑问。此外，当我需要获取基本信息时，例如我在 IIS 中有多少个连接及其**详细信息**，我不知道该怎么做。我用谷歌搜索了很多，我找不到太多。我找到了一些日志解析器，但我想要实时。我发现一些商业工具看起来并不是我想要的，除了我想找到一些免费的东西。这是非常基本的东西，在 Apache 中很容易获得。我找到[了 IISracer](http://iismonitor.motobit.com/)，但我对此有点怀疑；我确实安装并试用了它。还有别的事吗？这些遗留应用程序中的一些是经典的 ASP，因此只是 CLR Profiler 不是我想要的，尽管它们很方便。

编辑：IISracer 真的是 IIS 中唯一这样的工具吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T04:00:20.737

[IIS 6.0 故障排除工具](http://technet.microsoft.com/en-us/library/cc780913.aspx)

[IIS 请求监视器 (IIS 6.0)](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/f0831c18-39e1-4d13-99e7-8a32362ba4ff.mspx?mfr=true)

跟踪和缓解不良站点问题的技术之一是使用[应用程序池](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/67e39bd8-317e-4cf6-b675-6431d4425248.mspx?mfr=true)。本文[介绍](http://www.developer.com/net/asp/article.php/2245511)了如何设置。

在 SO 上也提到过：

*   [是什么导致 IIS 中的应用程序池循环使用？](https://stackoverflow.com/questions/302110/what-causes-an-application-pool-in-iis-to-recycle)

*   [与将 Web 应用程序保存在一个默认应用程序池中相比，拥有专用应用程序池的优缺点](https://stackoverflow.com/questions/223326/pros-and-cons-of-having-dedicated-application-pools-over-keeping-web-applications)

# iphone - 如何从 iPhone 的字典中检索随机单词？

> ID：609158
> 
> 赞同：1
> 
> 时间：2009-03-04T03:52:55.293
> 
> 标签：iphone, dictionary

有没有办法通过 SDK 从内置字典中随机检索单词？

我可以提供自己的单词列表，但使用内置词典可以轻松进行本地化。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T04:53:11.157

不幸的是，这是应用程序无法访问的 iPhone 领域之一。

但是，您可以使用许多免费词典作为替代。将基于文本的文件转换为 ansqlite 数据库非常容易，这使得随机挑选单词变得超级容易。

是的，正如您指出的那样，本地化是一个问题:(

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T03:56:15.303

拼写检查器不提供访问权限。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-11T02:29:11.280

iPhone 检查 UITextField 对象中的拼写。创建一个 UITextField 作为用户输入区域。声明您的接口以符合协议。添加任何其他代表，然后使用 UITextChecker

它有诸如availableLanguages、hasLearnedWord、learnWord、unlearnWord之类的东西。它还有guessesForWordRange:inString:language，它返回一个单词列表，这些单词可能是拼写错误的单词的有效替换。

有关更多信息，请查看 UITextChecker 上的 iPhone OS 参考库 [http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UITextChecker_Class/Reference/Reference.html](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UITextChecker_Class/Reference/Reference.html)

潘道格

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-15T13:31:10.400

[Lexicontext](http://www.lexicontext.com/)（我的库）为英语单词提供了这样的功能，虽然不是来自内置字典，而是来自内置的 WordNet 实例。

# asp.net - ASP 和 ' 不起作用

> ID：609166
> 
> 赞同：5
> 
> 时间：2009-03-04T03:56:28.063
> 
> 标签：asp.net

我不是 ASP 专家，只是想帮助一个朋友。

过去，HTML，我`&apos;`用于文本中的撇号。

使用以下它在 Firefox 中呈现良好但在 IE 7 中不正确。

```
asp:LinkButton ID="AceFrehley95Button" Text="Ace Frehley &apos; 95" OnCommand="lbtnSubMenu_Command" CommandArgument="AceFrehley95.wmv" Runat="Server" 
```

在 Firefox 中呈现：Ace Frehley '95

在 IE 7 中它呈现：Ace Frehley &apos 95

我如何让 IE 呈现 Firefox 的功能......

杰森

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-04T04:04:32.007

HTML 实际上没有`&apos;`实体。许多浏览器都支持它（可能是因为它*是*XHTML 的一部分），但“官方”并不存在。你应该`&#39;`改用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T04:11:02.507

你也可以试试：

```
&rsquo; 
```

呈现为：

'

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-03-04T04:09:20.857

除非你是排版纯粹主义者，

```
 &acute; 
```

可能足够接近。

# jquery - 谷歌浏览器中的 JQuery 找不到背景图片

> ID：609168
> 
> 赞同：4
> 
> 时间：2009-03-04T03:57:29.277
> 
> 标签：jquery, google-chrome, css

我有一个按钮，我想更改其背景以显示当用户单击它时它被禁用。它在 IE/FF 中运行良好，但在 chrome 中似乎找不到背景图像并且背景没有。

![替代文字](https://secure.readyinteractive.com/images/buttons.jpg)

我只是在 jQuery 1.2.6 中设置了一个简单的 css

```
$(".CheckoutBt").css("background-image", "url(/Portals/_default/images/buttons/checkout-end-disabled.gif)"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T05:05:36.383

好的，我已经设法找出问题所在。正如 tvanfosson 所说，这是因为 WebKit 没有下载图像。为了解决这个问题，我只需在未点击的类中加载两个图像

```
<style>
.unclicked {
 background-image: url('/Portals/_default/images/buttons/checkout-end-disabled.gif');
 background-image: url('/Portals/_default/images/buttons/checkout-end.gif');
}
.clicked {
   background-image: url('/Portals/_default/images/buttons/checkout-end-disabled.gif');
}
</style> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T04:12:16.370

我解决这个问题的方法是上课。每个按钮状态都有一个单独的 CSS 类，然后只需使用 jQuery 来更改按钮的类。这将确保在设置类时所有图像都已实际下载并可用——我认为这是 Chrome 失败的地方（可能所有 WebKit 浏览器都会这样做）。

```
<style>
.unclicked {
 ...
}
.unclicked :hover {
 ...
}
.clicked {
   background-image: url('/Portals/_default/images/buttons/checkout-end-disabled.gif');
}
</style>
...
$(".CheckoutBt").click( function() {
    $(this).removeClass('unclicked').addClass('clicked');
    ...do what ever action...
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T04:35:25.380

而不是“背景图像”使用“背景图像”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T04:32:42.343

尝试完整的“背景”、“url(/Portals/_default/images/buttons/checkout-end-disabled.gif) 0 0 no-repeat”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T05:55:21.397

我还建议[像这样](http://wellstyled.com/css-nopreload-rollovers.html)将所有背景图像合并成一个图像。然后，您使用`background-position`偏移量来实现翻转效果。您可以通过制作一个非常长的按钮图像（其中包含正常状态和翻转状态）并左右对齐来生成您的“滑动门”，从而进一步利用此技术。

# python - 有什么不能出现在括号内的吗？

> ID：609169
> 
> 赞同：1
> 
> 时间：2009-03-04T03:58:35.467
> 
> 标签：python, vim, syntax, syntax-highlighting

我对这个关于[让 vim 突出显示](https://stackoverflow.com/questions/542929/highlighting-unmatched-brackets-in-vim)python 代码中不匹配的括号的问题的[答案](https://stackoverflow.com/questions/542929/highlighting-unmatched-brackets-in-vim/543881#543881)很感兴趣。具体来说，我在谈论他回答的第二部分，他提到 C 语法突出显示实际上将括号内的任何花括号实例标记为错误。当所有下游花括号都以红色点亮时，这是一个不显眼的提示，即您有未闭合的括号。

这个技巧有效，因为 C 语法不允许括号内的花括号。为了满足我的（病态？）好奇心，我可以用 python 代码做类似的事情吗？python语法中是否有括号内不合法的内容？

注意：我不是在为我的另一个问题寻找更好的答案（那里已经有很多好的答案）。我只是好奇这个技巧是否可以用 python 代码实现。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T08:17:45.220

任何 Python 语句（import、if、for、while、def、class 等）都不能放在括号中：

```
In [1]: (import sys)
------------------------------------------------------------
File "<ipython console>", line 1
  (import sys)
       ^
<type 'exceptions.SyntaxError'>: invalid syntax 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T08:42:09.297

这是一个确切的答案：

*   [http://docs.python.org/reference/expressions.html#grammar-token-expression_list](http://docs.python.org/reference/expressions.html#grammar-token-expression_list)
*   [http://docs.python.org/reference/compound_stmts.html#function](http://docs.python.org/reference/compound_stmts.html#function)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T04:03:26.563

我不确定您要做什么，但是“def”或“class”怎么样？

此代码段在不在括号内时有效

```
class dummy: pass 
```

# optimization - D中的常量与枚举

> ID：609175
> 
> 赞同：7
> 
> 时间：2009-03-04T04:03:05.147
> 
> 标签：optimization, enums, constants, d

[从此处](https://forum.dlang.org/thread/gmveqg$1t6p$1@digitalmars.com)查看此报价，位于页面底部。（我相信引用的关于`const`s 的评论也适用于`invariant`s）

> 枚举与 const 的不同之处在于它们不会占用最终输出的对象/库/可执行文件中的任何空间，而 const 会。

所以显然`value1`会使可执行文件膨胀，而`value2`被视为文字并且不会出现在目标文件中。

```
const int value1 = 0xBAD;
enum int value2 = 42; 
```

回到 C++ 中，我一直认为这是由于遗留原因，以及无法优化常量的旧编译器。但如果这在 D 中仍然成立，那么这背后一定有更深层次的原因。有谁知道为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T04:40:31.357

就像在 C++ 中一样，D 中的枚举似乎是一个“保守的整数文字”（**编辑**：令人惊叹，D2 甚至支持[浮点数和字符串](http://www.digitalmars.com/d/2.0/enum.html)）。它的枚举器没有位置。作为没有身份的价值观，它们只是无关紧要的。

配售`enum`是 D2 中的新功能。它首先定义了一个新变量。它不是左值（所以你也不能取它的地址）。一个

```
enum int a = 10; // new in D2 
```

就好像

```
enum : int { a = 10 } 
```

如果我可以相信我可怜的 D 知识。所以，`a`这里不是左值（没有位置，你不能取它的地址）。然而，一个 const*有*一个地址。如果您有一个全局（不确定这是否是正确的 D 术语）const 变量，编译器通常无法优化它，因为它不知道哪些模块可以访问该变量或可以获取其地址。所以它必须为它分配存储空间。

我认为如果你有一个本地常量，编译器仍然可以像在 C++ 中一样优化它，因为编译器通过查看它的范围来知道是否有人对其地址感兴趣，或者是否每个人都只接受它的价值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T16:04:26.487

您的实际问题；为什么 D 中的 enum/const 与 C++ 中的相同；似乎没有答案。遗憾的是，这种选择没有充分的理由。我相信这只是 C++ 中一个无意的副作用，它成为了事实上的模式。在 D 中需要相同的模式，Walter Bright 决定应该像在 C++ 中那样完成，这样来自那个地方的人就会知道要做什么......事实上，在这个相当愚蠢的决定之前，使用了关键字 manifest而不是这个用例的枚举。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-04T04:31:33.907

我认为一个好的编译器/链接器仍然应该删除常量。只是使用枚举，它实际上在规范中得到了保证。区别主要是语义问题。（还请记住，2.0 尚未完成）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-04T16:19:59.943

`enum`据我了解，在语法上扩展以支持单个清单常量的真正目的是 D 模板专家 Don Clugston 正在用模板做一些疯狂的事情。他一直遇到很长的构建时间、荒谬的编译器内存使用等问题，因为编译器一直在为 const 变量创建内部数据结构。与枚举相比，常量/不可变变量的一个关键是常量/不可变变量是左值，并且可以获取它们的地址。这意味着编译器有一些额外的开销。这通常无关紧要，但是当您执行非常复杂的编译时元程序时，即使优化了 const 变量，这仍然是编译时的重大开销。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T04:25:41.533

听起来枚举值将在表达式中“内联”使用，因为 const 实际上会占用存储空间，并且任何引用它的表达式都将从内存存储中加载值。

这听起来类似于 C# 中 const 与 readonly 之间的区别。前者是编译时常量，后者是运行时常量。这肯定会影响程序集的版本控制（因为引用只读的程序集会在编译时收到一个副本，并且如果使用不同的值重新构建引用的程序集，则不会更改该值）。

# testing - 是否有相当于 Don Libes 的 *expect* 工具来编写与网页交互的脚本？

> ID：609177
> 
> 赞同：7
> 
> 时间：2009-03-04T04:04:00.010
> 
> 标签：testing, scripting, interactive, expect

在交互式控制台应用程序的糟糕时代，Don Libes 创建了一个名为[Expect](http://expect.nist.gov/)的工具，它使您能够编写与这些应用程序交互的 Tcl 脚本，就像用户一样。Expect 有两个巨大的好处：

*   可以编写交互脚本，否则必须手动重复繁琐的操作。一个典型的例子是拨号上网地狱（从 PPP 之前的日子开始）。

*   作为回归套件的一部分，可以编写脚本以编程方式测试自己的交互式应用程序。

如今，大多数交互式应用程序都在 Web 上，而不是在控制台上。因此我的问题是：是否有任何工具能够以编程方式与网页和 Web 表单交互，就像 Expect 提供以编程方式与控制台应用程序交互的能力一样？

（我所知道的最接近的是[Chickenfoot](http://groups.csail.mit.edu/uid/chickenfoot/)。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-04T04:07:22.390

您可能正在寻找[硒](http://seleniumhq.org/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-04T04:08:51.997

我将[Selenium](http://seleniumhq.org/projects/remote-control/) RC 与 Python 结合使用，以编程方式驱动网页交互。这使我能够编写相当广泛的用户测试，其中驱动表单和输入并测量其结果。

查看 Firefox 上的[Selenium](http://seleniumhq.org/projects/ide/) IDE（如上所述）。它允许您使用 IDE 本身或远程控制应用程序在浏览器中记录测试并播放它们。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-04T19:08:16.123

Perl [Mechanize](http://search.cpan.org/dist/WWW-Mechanize/)非常适合这个确切的问题。

HTTPS 和一些身份验证问题有时很棘手。我将在未来发布一些关于这些的问题。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-02T20:23:20.660

我在前世做过大量的 Expect 工作，并且一直认为 Don Libes 的 Expect 书是我见过的写得最好、最有启发性的技术书籍之一。

毫无疑问，我会说 Perl 的 WWW::Mechanize 库是您想要的。我在上面注意到您在查找文档时遇到了麻烦。有很好的文档！在 search.cpan.org 上查找该模块的发行版，并查看其中包含的所有内容。有一个常见问题解答、带有示例的食谱等。另外，我总是能够在网络上获得帮助。如果您无法在此处获得它，请尝试在 use.perl.org 或 perlmonks.org 上。WWW::Mechanize 的作者 Andy Lester[出现在 Stack Overflow 上](https://stackoverflow.com/users/8454/andy-lester)。（他也是一个非常友好和乐于助人的人。）

我相信 WWW::Mechanize 也有一个类似于 Expect 的 autoexpect 程序的程序：你设置一个代理进程运行这个程序作为服务器，将你的浏览器指向它作为代理，执行你想要自动化的操作，然后代理程序为您提供了一个 WWW::Mechanize 程序，供您用作项目的基础。（如果它像 autoexpect 一样工作，您肯定会想从那里进行修改。）

如上所述，WWW::Mechanize*是*一个浏览器（更准确地说，它是一个 Web 客户端或 http 客户端），恰好是可编程的。我上次查看时，甚至有工作正在进行中以使其支持 JavaScript。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T19:12:24.413

除了 Selenium，如果你正在做 Ruby/Rails 的事情，还有[Webrat](http://github.com/brynary/webrat)。

# python - 如何阻止 IDLE 打印巨型列表？

> ID：609190
> 
> 赞同：2
> 
> 时间：2009-03-04T04:10:12.617
> 
> 标签：python, ide, editor, python-idle

有时我会在 IDLE 中处理数千个项目的列表，然后不小心将其打印到 shell。发生这种情况时，它会崩溃或至少非常显着地减慢 IDLE。可以想象，这非常不方便。有没有办法制作它，而不是打印整个东西，只给我一个总结的 [1, 2, ...] 输出？任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-12T00:21:44.533

如上所述，尝试自定义打印功能，例如：

```
def my_print(obj):  
    if hasattr(obj, '__len__') and len(obj) > 100:  
        print '... omitted object of %s with length %d ...' % (type(obj), len(obj))  
    else: print obj 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T08:14:28.067

改为使用[IPython](http://ipython.scipy.org/moin/FrontPage)作为 shell。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T19:37:20.220

您可以使用自定义打印功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-14T00:56:35.357

在 Python 3 中，由于 print 是一个函数，因此您应该能够“覆盖”它。（我没有安装它，所以我无法尝试确定。）可能不推荐用于实际应用程序，但如果你只是尝试一下，我想没关系。

它会是这样的：

```
def myprint(*args):
    # write the function as described by other people
print = myprint 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-23T04:27:36.437

IDLE的[Squeezer](http://pypi.python.org/pypi/Squeezer/1.0)扩展就是为此而编写的。根据 Pypi 的描述：

> 如果打印很长的输出，IDLE 可能会挂起。为避免这种情况，Squeezer 扩展会捕获任何超过 80 行文本（可配置）的输出，并改为显示一个矩形框：

Squeezer 和许多其他 IDLE 扩展都包含在[IdleX](http://idlex.sourceforge.net)中。

# javascript - javascript加载条件语句

> ID：609192
> 
> 赞同：0
> 
> 时间：2009-03-04T04:10:37.453
> 
> 标签：javascript, internet-explorer

几天来，我一直在努力摆脱 IE 中的错误，并且“几乎”无济于事。

我刚刚尝试加载 jquery 1.2.6 而不是 1.3.2，并且错误消失了（尽管该站点现在明显变慢了）。

但是，我怀疑我可能会坚持使用此解决方案。是否有基于浏览器的方法来包含类似于 css 条件语句的脚本？

如果需要，我可以在服务器端进行，但客户端会很好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T05:50:12.127

您可以使用[条件注释](http://msdn.microsoft.com/en-us/library/ms537512.aspx)来仅包含 IE 的脚本。

```
<!--[if IE]>
    <script type="text/javascript">
        /*  Do Stuff */
    </script>
<![endif]--> 
```

要从 IE 中排除脚本块：

```
<![if !IE]>
    <script type="text/javascript">
        /*  Do Stuff */
    </script>
<![endif]> 
```

# graph-theory - 在异构集合之间找到最佳的 2x2 匹配

> ID：609201
> 
> 赞同：2
> 
> 时间：2009-03-04T04:14:46.803
> 
> 标签：graph-theory, matching, mathematical-optimization

我有一个问题：

我有一个 A 类和一个 B 类，可以通过编程检查它们的实例对象是否在不同数量上彼此相似或不同。例如，它们可能完全匹配，或者完全不同（即使类别不同，它们仍然可以表示相同的信息并且得分相同。）

现在，给定两个集合，一个是 A，一个是 B，将 As 和 B 配对的最佳方式是什么，以使它们最匹配，如果任一集合大于另一个集合或如果某些 As 或 B 完全不同而无法匹配？

我的第一次尝试是创建一个二维数组，其中每个单元格都是匹配的“分数”（0 = 完美，数字越大越差），并在每条路径中递归查找最低累积分数。这行得通，结果很完美，但速度非常慢。

关于更有效算法的任何想法？

如果您想知道，我的 A 类代表一个混音器输入通道，我的 B 代表相同的持久状态（称为场景）。我要解决的问题是如何将场景导入现有混音器，其中场景 (B) 可能与任何现有通道 (A) 略有不同甚至高度不同。如果我可以稍微修改任何一个以匹配，我不想只添加频道 (A)。例如，我可以在 A 中添加一个效果插入，以便与 B 完美匹配，避免添加另一个 A。

麦克风

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T04:28:29.827

这听起来像是一个二分匹配问题，并且可能可以通过使用相似性度量来加权边缘，使用标准的最大流/最小切割解决方案来解决。

[这可能有帮助](http://www.topcoder.com/tc?module=Static&d1=tutorials&d2=maxFlow2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-10T12:04:36.047

我会启发式地这样做。

首先收集一组完全匹配。

然后有一个阈值，并收集比该阈值更好的匹配项。

扩大阈值并重复，直到用尽一组或两组。

现在你有一场试赛，这可能不是最好的。

运行大量模拟退火循环，在其中随机排列匹配链接，并根据取决于它们各自成本的概率保留或不保留它们。

这使您可以探索匹配空间，如果附近有更好的匹配，它应该会找到它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T11:18:04.117

我没有算法，只有一般建议。您可以尝试随机抽样的可能性，直到您花费了您愿意花费的时间并采取了一路上找到的最佳选择。这种方法通常不会找到最佳解决方案，但通常很容易编程。并且根据问题，它可能足够接近最佳值。您可以进行实验，看看随着随机样本数量的增加，质量如何提高。如果幸运的话，少量样本可能就足够了。

# c++ - 从目录中读取文件名

> ID：609203
> 
> 赞同：19
> 
> 时间：2009-03-04T04:15:58.610
> 
> 标签：c++, file, file-io

我想知道 C++ 中是否有一种简单的方法可以从包含许多文件的文件夹中读取多个文件名。如果有人想知道，它们都是位图。

我对 Windows 编程了解不多，所以我希望它可以使用简单的 C++ 方法来完成。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-04T04:34:53.120

Boost 提供了[`basic_directory_iterator`](http://www.boost.org/doc/libs/1_38_0/libs/filesystem/doc/reference.html#Class-template-basic_directory_iterator)一个符合 C++ 标准的输入迭代器，它可以访问目录的内容。如果可以使用 Boost，那么这至少是跨平台的代码。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2017-02-09T12:16:22.527

C ++ 17 包括实现该目标的**标准**方法

[http://en.cppreference.com/w/cpp/filesystem/directory_iterator](http://en.cppreference.com/w/cpp/filesystem/directory_iterator)

```
#include <fstream>
#include <iostream>
#include <filesystem>
namespace fs = std::filesystem;

int main()
{
    fs::create_directories("sandbox/a/b");
    std::ofstream("sandbox/file1.txt");
    std::ofstream("sandbox/file2.txt");
    for(auto& p: fs::directory_iterator("sandbox"))
        std::cout << p << '\n';
    fs::remove_all("sandbox");
} 
```

可能的输出：

```
sandbox/a
sandbox/file1.txt
sandbox/file2.txt 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-04T04:20:33.077

我认为您正在寻找[`FindFirstFile()`](http://msdn.microsoft.com/en-us/library/aa364418(VS.85).aspx)and [`FindNextFile()`](http://msdn.microsoft.com/en-us/library/aa364428(VS.85).aspx)。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-03-04T08:36:52.477

刚刚快速浏览了我的片段目录。发现这个：

```
vector<CStdString> filenames;
CStdString directoryPath("C:\\foo\\bar\\baz\\*");

WIN32_FIND_DATA FindFileData; 
HANDLE hFind = FindFirstFile(directoryPath, &FindFileData);

if (hFind  != INVALID_HANDLE_VALUE)
{
    do
    {
        if (FindFileData.dwFileAttributes != FILE_ATTRIBUTE_DIRECTORY)
              filenames.push_back(FindFileData.cFileName);
    } while (FindNextFile(hFind, &FindFileData));

    FindClose(hFind);
} 
```

这为您提供了一个包含目录中所有文件名的向量。当然，它只适用于 Windows。

* * *

[João Augusto在](https://stackoverflow.com/users/6909/jo%c3%a3o-augusto)[回答](https://stackoverflow.com/a/609909/15168)中指出：

*不要忘记检查后`FindClose(hFind)`：*

```
DWORD dwError = GetLastError();
if (dwError != ERROR_NO_MORE_FILES) 
{
  // Error happened        
} 
```

*如果在网络上扫描，这一点尤其重要。*

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-04T04:32:53.717

您还可以使用 POSIX opendir() 和 readdir() 函数。请参阅[此手册页](http://www.opengroup.org/onlinepubs/009695399/functions/readdir.html)，其中也有一些很棒的示例代码。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-04T04:26:13.187

我建议您可以使用本机 Win32`FindFirstFile()`和`FindNextFile()`函数。这些使您可以完全控制搜索文件的方式。这是简单的 C API，不难使用。

另一个优点是 Win32 错误不会被隐藏或由于 C/C++ 库层而更难发现。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-05T07:56:41.867

另一种选择是 -

1.  `system("dir | findstr \".bmp\" > temp.txt ");`
2.  现在逐行读取 temp.txt 以获取所有文件名。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-02-10T18:59:01.997

为什么不使用`glob()`？

```
glob_t glob_result;
glob("/foo/bar/*",GLOB_TILDE,NULL,&glob_result);
for(unsigned int i=0;i<glob_result.gl_pathc;++i){
  cout << glob_result.gl_pathv[i] << endl;
} 
```

# crystal-reports - 以编程方式为我的 Crystal Report 设置用户名和密码？

> ID：609205
> 
> 赞同：0
> 
> 时间：2009-03-04T04:17:44.407
> 
> 标签：crystal-reports

如何以编程方式为 Crystal Report 设置用户名和密码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-05T16:18:53.573

Through the connectioninfo object on the reportdocument is the only way I know of.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2010-08-02T15:14:30.850

在命令提示符下转到 odbcad32 并更改那里的设置...

# java - 从目录列表下载文件

> ID：609207
> 
> 赞同：2
> 
> 时间：2009-03-04T04:19:58.427
> 
> 标签：java, api, download, directory-listing

是否可以从目录列表中下载所有文件？例如，以下链接指向一个列表。

[http://www.arthika.net/1234TB/new/Kuruvi/](http://www.arthika.net/1234TB/new/Kuruvi/)

请指点我一些相关的 API 以从此类列表中下载所有文件（如果可能）。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T04:37:35.717

```
wget -r -l 1 http://url.example.com/directory/ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T04:39:35.027

假设您的意思是从 Java 编程，您可以查看 java.net.URL.connect 方法。这是[Java 教程](http://java.sun.com/docs/books/tutorial/networking/urls/connecting.html)中使用它的示例，以及[从 URL 读取](http://java.sun.com/docs/books/tutorial/networking/urls/readingWriting.html)的示例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T04:29:36.673

你的意思是程序化的吗？对于初学者，请查看 wget 和批处理脚本。

# python - PY：没有变量名的 URL 编码

> ID：609212
> 
> 赞同：3
> 
> 时间：2009-03-04T04:23:36.657
> 
> 标签：python

python中有没有办法在没有变量名的情况下对列表进行url编码？例如
q=['with space1', 'with space2']
变成 qescaped=['with%20space1', 'with%20space2']

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-04T04:31:00.367

您可以将[urllib.quote](http://docs.python.org/library/urllib.html#urllib.quote)与[map](http://docs.python.org/library/functions.html#map)一起使用：

```
import urllib
q = ['with space1', 'with space2']
qescaped = map(urllib.quote, q) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T12:15:43.203

如今，列表推导式是 Pythonic 的方法：

```
q = [ 'with space1', 'with space2' ]
qescaped = [ urllib.quote(u) for u in q ] 
```

通常，您甚至不必构建该列表，而是可以使用生成器本身：

```
qescapedGenerator = (urllib.quote(u) for u in q) 
```

（这样可以节省内存，如果您不需要所有元素，还可以节省计算时间。）

许多接收器也可以在生成器上处理：

```
urlsInLines = '\n'.join(urllib.quote(u) for u in q) 
```

```
for escapedUrl in (urllib.quote(u) for u in q):
    print escapedUrl 
```

如果任何接收毕竟需要一个列表，那么只要放在`list()`生成器周围就会创建列表。

# sql-server - 从 SQL Server 2000 设置 SQL Server 2005 报告数据库

> ID：609217
> 
> 赞同：0
> 
> 时间：2009-03-04T04:25:26.153
> 
> 标签：sql-server, backup, reporting

我们最近从 SQL Server 2000 标准数据库上的简单数据库恢复模型（每天进行完整数据库转储）转变为完整恢复——结合每周完整数据库备份、每日增量和每 10 分钟一次的事务转储。

我们之前的报告数据库实例 (SQL Server 2005) 是根据不再存在的每日备份构建的。我可以通过加载每周转储来重新构建报告数据库，使其处于恢复模式，然后恢复增量备份。不幸的是，这不是很容易编写脚本的，而且手工操作很糟糕。

对 2000 生产数据库进行额外的完整备份将破坏增量（出于多种原因，这是可取的）。

有一个更好的方法吗？我们无法进行日志传送，因为我们只是 SQL Server 2000 Standard（最终我们将升级到 2K5）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T04:51:09.960

根据您的数据需要的最新程度，[快照复制](http://msdn.microsoft.com/en-us/library/aa256286(SQL.80).aspx#)似乎最适合您。[设置起来](http://www.mssqlcity.com/Articles/Replic/SetupSR/SetupSR.htm)并不难，我相信它在像你这样的场景中相当普遍。

# mysql - 应该对总计进行非规范化吗？

> ID：609225
> 
> 赞同：5
> 
> 时间：2009-03-04T04:28:46.393
> 
> 标签：mysql, denormalization

我正在一个带有简单规范化数据库的网站上工作。

有一个名为 Pages 的表和一个名为 Views 的表。每次查看 Page 时，该 View 的唯一记录都会记录在 Views 表中。

在网站上显示页面时，我使用一个简单的 MySQL COUNT() 来汇总显示的视图数。

数据库设计似乎很好，除了这个问题：我不知道如何检索数千个浏览次数最多的前 10 个页面。

我是否应该通过添加 Pages.views 列来保存每个页面的总视图数来非规范化 Pages 表？或者有没有一种有效的方法来查询前 10 个浏览次数最多的页面？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-04T04:35:21.947

```
 SELECT p.pageid, count(*) as viewcount FROM 
   pages p
   inner join views v on p.pageid = v.pageid
   group by p.pageid
   order by count(*) desc   
   LIMIT 10 OFFSET 0; 
```

我无法对此进行测试，但可以进行类似的测试。除非由于性能限制而不得不存储值，否则我不会存储该值（我刚刚学习了“过早优化”一词，如果您这样做，它似乎也适用）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T04:38:29.833

这取决于您尝试维护的信息级别。如果你想记录谁在什么时候看过？然后单独的表就可以了。否则，视图列是要走的路。此外，如果您保留一个单独的列，您会发现该表将更频繁地被锁定，因为每个页面视图都会尝试更新其相应行的列。

```
Select pageid, Count(*) as countCol from Views
group by pageid order by countCol DESC
LIMIT 10 OFFSET 0; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T04:37:25.703

数据库规范化是关于存储数据的最有效/最少冗余的方式。这有利于事务处理，但通常与再次有效获取数据的需求直接冲突。该问题通常通过具有更易于访问的预处理数据的派生表（索引、物化视图、汇总表...）来解决。这里的（有点过时的）流行词是数据仓库。

我认为您希望保持 Pages 表标准化，但有一个包含总数的额外表。根据这些计数需要多长时间，您可以在更新原始表时更新表，或者您可以让后台作业定期重新计算总数。

您还希望仅在确实遇到性能问题时才这样做，除非您有大量记录或大量并发访问，否则您不会这样做。保持您的代码灵活，以便能够在拥有表格和不拥有表格之间切换。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T04:34:09.407

我可能会在 Pages 表中包含视图列。

对我来说，这似乎是一个完全合理的规范化突破。特别是因为我无法想象您会删除视图，因此您不会期望计数会失控。在这种情况下，参照完整性似乎不是超级关键。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T04:38:18.103

在这种情况下，非规范化肯定会起作用。你的损失是额外的柱子用完了额外的存储空间。

或者，您可以设置一个计划的作业，以每晚填充此信息，只要您的流量较低，x 时间段。

在这种情况下，除非您手动运行此查询，否则您将无法立即了解您的页数。

非规范化绝对可以用来提高性能。

——克里斯

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-29T15:18:07.693

虽然这是一个老问题，但我想添加我的答案，因为我发现接受的问题被误导了。

对单个选定行进行 COUNT 是一回事。对所有列的 COUNT 进行排序是另一回事。

即使您只有 1000 行，每行都有一些连接，您也可以轻松地读取数万行，甚至数百万行。

如果你只是偶尔调用它是可以的，但否则它会非常昂贵。

你可以做的是添加一个触发器：

```
CREATE TRIGGER ins AFTER INSERT ON table1 FOR EACH ROW
UPDATE table2
SET count = count + 1
WHERE CONDITION 
```

# sql-server - 在 ASP 中显示希伯来语文本

> ID：609230
> 
> 赞同：0
> 
> 时间：2009-03-04T04:32:00.350
> 
> 标签：sql-server, asp-classic, character-encoding

我正在研究从 sql server 读取数据并将其显示在表中的 ASP 应用程序。我所有的希伯来语文本都被替换为“?????”。

我在区域选项中安装并配置了希伯来字体。我在 Head,Meta 标记中设置了适当的字符集，我可以在 sqlServer2005ManagementSudioExpress 中看到正确的希伯来语文本。我为希伯来语的列 (SQL_Latin1_General_CP1255_CI_AS) 设置了适当的排序规则。我还看到“？？？？？？” 而不是希伯来语文本。

我错过了什么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T04:40:31.843

确保该列设置为存储 Unicode。例如，`nvarchar`代替`varchar`，或`ntext`代替`text`。

# c++ - 访问冲突

> ID：609240
> 
> 赞同：0
> 
> 时间：2009-03-04T04:36:15.970
> 
> 标签：c++, debugging, memory

大家好，在清除此异常时需要一些帮助。

在 Microsoft Visual C++ 6.0 中调试我的编译程序时，我得到以下信息：

```
Loaded 'ntdll.dll', no matching symbolic information found.
Loaded 'C:\WINDOWS\system32\kernel32.dll', no matching symbolic information found.
Loaded 'C:\WINDOWS\system32\tsappcmp.dll', no matching symbolic information found.
Loaded 'C:\WINDOWS\system32\msvcrt.dll', no matching symbolic information found.
Loaded 'C:\WINDOWS\system32\advapi32.dll', no matching symbolic information found.
Loaded 'C:\WINDOWS\system32\rpcrt4.dll', no matching symbolic information found.
First-chance exception in SA.exe: 0xC0000005: Access Violation. 
```

以下是调试器的相关屏幕截图。

显示 ostream.h：

http://img237.imageshack.us/my.php?image=accessviolation.png'>http://img237.imageshack.us/img237/1116/accessviolation.th.png'border='0'/>

显示 main.ccp：

http://img509.imageshack.us/my.php?image=accessviolation2.png'>http://img509.imageshack.us/img509/3619/accessviolation2.th.png'border='0'/>

我试图在我的代码中搜索空指针，并且还试图忽略异常但没有运气。以下是我的脚本的三个主要组成部分：

主文件

```
#include <iostream>

#include "SA.h" 

using namespace std; // For the use of text generation in application

int main() 
{
    SimAnneal Go;

    cout << "Quadratic Function" << endl
         << "Solving method: Simulated Annealing" << endl;

    cout << "\nSelect desired Initial Temperature:" << endl
         << "> ";
    cin >> Go.T_initial;

    cout << "\nSelect desired number of Temperature Iterations:" << endl
         << "> ";
    cin >> Go.N_max;

    cout << "\nSelect desired number of step Iterations:" << endl
         << "> ";
    cin >> Go.N_step;

    cout << "\nSelect desired Absolute Temperature:" << endl
         << "> ";
    cin >> Go.T_abs;

    Go.LoadCities();

    Go.Initialize();

    Go.SA();

    system ("PAUSE");

    return 0;
} 
```

SA.h

```
 #ifndef SA_H
    #define SA_H

class SimAnneal {

        double S_order [15];        
        double S_trial [15];        

        int SwapNum1;
        int SwapNum2;

        double CityArray [15][15];

        double E_initial;
        double E_current;

        double T;

        void Metropolis (double, int, int);
        void Next_State (double, int);
        double Schedule (double, int);
        double ObjFunction (double CityOrder []);

        void EquateArray ();
        void OrderInt ();
        void OrderTrial ();
        void OrderList (double array[]);

        void WriteResults (double, double, double, double, double);

      public:
        int N_step;
        int N_max; 
        double T_initial;
        double T_abs;

        void SA ();
        void Initialize ();
        void LoadCities ();
    };

    double Random_Number_Generator(double nHigh, double nLow);

#endif 
```

SA.cpp

```
#include <math.h>
#include <iostream>
#include <fstream>          
#include <iterator>
#include <iomanip>
#include <time.h>           
#include <cstdlib>          

#include "SA.h"

using namespace std;

void SimAnneal::SA() 
{
    T = T_initial;
    E_current = E_initial;

        for ( int N_temperatures = 1 ; N_temperatures <= N_max ; N_temperatures++ )
        {
            Metropolis(T, N_step, N_temperatures);
            T = Schedule(T, N_temperatures);

        if (T <= T_abs)
            break;
        }

    cout << "\nResults:" << endl
    << "Distance> " << E_current << endl
    << "Temperature> " << T << endl;

    OrderList(S_order);
}

void SimAnneal::Metropolis(double T_current, int N_Steps, int N_temperatures)
{
    for ( int i=1; i <= N_step; i++ )           
        Next_State(T_current, N_temperatures);      
}

void SimAnneal::Next_State (double T_current, int i) 
{
    OrderTrial();

    double EXP = 2.718281828;

    double E_t = ObjFunction(S_trial);
    double E_c = ObjFunction(S_order);

    double deltaE = E_t - E_c;                              
        if ( deltaE <= 0 )
        {    
        EquateArray();
        E_current = E_t;
    }
        else
        {
        double R = Random_Number_Generator(1,0);
        double Ratio = 1-(float)i/(float)N_max;         
        double ctrl_pram = pow(EXP, (-deltaE / T_current));

            if (R < ctrl_pram*Ratio)                        
            {   
            EquateArray();
            E_current = E_t;
        }
        else 
            E_current = E_c;
    }
}

double SimAnneal::Schedule (double Temp, int i) 
{
    double CoolingRate = 0.9999;

    return Temp *= CoolingRate; 
}

double SimAnneal::ObjFunction (double CityOrder []) 
{
    int a, b;

    double distance = 0;

    for (int i = 0; i < 15 - 1; i++)
    {
        a =  CityOrder [i];
        b =  CityOrder [i + 1];

        distance += CityArray [a][b];
    }

    return distance;
}

void SimAnneal::Initialize () 
{
    int a, b;

    double distance = 0;

    OrderInt();

    for (int i = 0; i < 15 -1; i++)
    {
        a =  S_order [i];
        b =  S_order [i + 1];

        distance += CityArray [a][b];
    }

    E_initial = distance;
}

void SimAnneal::EquateArray () 
{
    for (int i = 0; i < 15; i++)
    {
        S_order [i] = S_trial [i];
    }
}

void SimAnneal::OrderInt () 
{
    for (int i = 0; i <15; i++)
    {
        S_order [i] = i;
    }
}

void SimAnneal::OrderTrial () 
{
    for (int i = 0; i < 15; i++)
    {
        S_trial [i] = S_order [i];
    }

    SwapNum1 = (int)Random_Number_Generator(15, 0);         
    SwapNum2 = (int)Random_Number_Generator(15, 0);

    for (int n = 0; n <= 100000; n++)                       
    {
        SwapNum2 = (int)Random_Number_Generator(15, 0); 

        if ( SwapNum1 != SwapNum2 )
            break;
    }

    S_trial [SwapNum1] = S_order [SwapNum2];
    S_trial [SwapNum2] = S_order [SwapNum1];
}

void SimAnneal::OrderList (double array[]) 
{
    cout << "Array List : " << endl;
    for (int i = 0; i < 15; i++)
    {
        cout << " > " << array[i] << endl;
    }

    cout << "End of array" << endl;
}

void SimAnneal::LoadCities () 
{
    int x, y;

    for (y = 0; y < 15; y++)                    
    {    
        for (x = 0; x < 15; x++)            
        {      
            if (x == y)
            {   CityArray[x][y] = 0.0;  
            }
            else if (x != y)
            {   CityArray[x][y] = Random_Number_Generator(7, 1); 
            }
        }  
    }  

    for (y = 0; y < 15; y++) 
    {    
        for (x = 0; x < 15; x++) 
        {      
            if (y > x)
                CityArray[y][x] = CityArray[x][y];
        }  
    }  
}

double Random_Number_Generator(double nHigh, double nLow)
{
    double fr = ((rand() % ((int)nHigh*1000 - (int)nLow*1000 + 1)) + nLow) / 1000;

    return fr;
} 
```

任何援助将不胜感激。我自己都没有想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T04:57:01.287

a = S_order [i];
b = S_order [i + 1]；
距离 += CityArray [a][b]; <--- 这看起来很可疑。当 i = 14, b = 15...明显超出范围...我的 2 美分

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T05:07:05.833

您发布的代码甚至无法编译：

1)

```
cin >> Go.Write; 
```

类中没有这样的变量`SimAnneal` 。

2)

```
Go.SA(Go.Write) 
```

您的`SA`方法不接受任何参数。

另一件事是，为什么不直接在 VC++ 6.0 中以调试模式运行项目？屏幕截图上的 VS 显然是 200*X*。

根据屏幕截图，您正在在线崩溃：

```
cout << "Quadratic Function" << endl
     << "Solving method: Simulated Annealing" << endl; 
```

这没有多大意义，除非您的输出流以某种方式被肢解。您是否尝试在崩溃发生之前观看控制台？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T04:47:55.943

看起来你在代码中做的事情并没有太致命，我可以看到，你试过删除代码行吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T04:58:42.093

试试这个：

[http://bytes.com/groups/net-vc/535224-whats-first-chance-exception-how-do-i-fix](http://bytes.com/groups/net-vc/535224-whats-first-chance-exception-how-do-i-fix)

但我认为答案是别人说的——距离=线

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T05:09:27.903

```
for (int i = 0; i < 15; i++)
{
    S_trial [i] = S_order [i];
}

// ....
for (int i = 0; i <15; i++)
{
    S_order [i] = i;
} 
```

两个循环都太高了。将它们更改为 14 而不是 15。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T17:58:10.893

你总是可以在代码周围放置 try { } catch(...) { } 块并使用 /EHa 编译

识别问题区域

# html - 如何确保被 CSS 反转的按钮间隔均匀？

> ID：609250
> 
> 赞同：1
> 
> 时间：2009-03-04T04:41:08.797
> 
> 标签：html, css, internet-explorer, firefox

我有一个向导样式的 HTML 表单，其中有一排用于返回/下一步/取消操作的提交按钮（按此顺序）。表单还可以包含不同数量的输入字段，例如文本字段、单选按钮、复选框、下拉列表（选择标签）和文本区域。客户要求“下一步”按钮作为默认操作，因此如果用户在文本字段中键入并按 Enter，它应该提交表单，就好像他们单击了“下一步”按钮一样。

问题是在这种情况下，浏览器（至少 IE，这是我们 99% 的客户使用的）使用表单中声明的​​第一个按钮提交表单，从上面的列表中可以看出，该按钮是“返回” ，而不是所需的“下一步”。

我读到的一个修复方法是以相反的顺序声明 Back 和 Next 按钮（即 Next first），然后使用 CSS 以正确的方式显示它们，如下所示：

```
<html>
  <head>
    <style type="text/css">
      .formSubmitButtons {
        direction: rtl;
        float: left;
      }
      .formSubmitButtons input {
        direction: ltr;
        float: none;
      }
    </style>
  </head>
  <body>
    <form action="blah" method="POST" enctype="application/x-www-form-urlencoded">
      <div class="formSubmitButtons">
        <input type="submit" name="btnNext" value="Next">
        <input type="submit" name="btnBack" value="Back">
      </div>
      <input type="submit" name="btnCancel" value="Cancel">
      <br/>Some text fields go here...
    </form>
  </body>
</html> 
```

这在 Firefox 和 IE 中都提供了所需的行为和按钮顺序，但是 Cancel 按钮相对于其他按钮的间距不一致。在 IE6 中它看起来足够好，但在 Firefox 3.0.5 中，取消按钮与下一步按钮卡住了。

有谁知道我需要编织什么 CSS 魔法才能让这三个按钮在两个浏览器中均匀分布？

（通过排序按钮 Next/Back/Cancel 来避免问题不是一个选项）

（也感谢所有建议基于 JavaScript 的解决方案的人，但并非我们的所有客户都允许使用 JS，因此它必须是直接的 HTML 和/或 CSS 解决方案）

这是我最终做得很好的方法（基于 Cletus 的建议）：

```
<!--
<input type="submit" name="btnNext" style="position: absolute; left: -9999px" tabindex="-1">
<input type="submit" name="btnBack" value="Back">
<input type="submit" name="btnNext" value="Next">
<input type="submit" name="btnCancel" value="Cancel">
--> 
```

（忽略包装注释标签，它们只是为了让您可以看到 HTML）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T04:57:35.123

你有没有考虑过使用[这个技巧](http://tapestryjava.blogspot.com/2005/06/html-form-trick.html)？基本上，您首先会出现一个隐藏按钮，它会执行所需的操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T05:07:24.757

你能定义一个风格吗

```
.btnMargin {
    margin-left:5px;
    margin-right:5px;
} 
```

只需将其应用于按钮

```
<input type="submit" name="btnNext" class="btnMargin" value="Next">
<input type="submit" name="btnBack" class="btnMargin" value="Back">
...
<input type="submit" name="btnCancel" class="btnMargin" value="Cancel"> 
```

?

如果您对所有人都有相同的样式，那么 Next/Back 和 Back/Cancel 之间似乎会产生一些像素差异。如果不发生这种情况至关重要，您可以为按钮定义单独的边距。?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T07:18:18.640

这会将按钮放在后面，下一个，取消订单，彼此相邻。唯一的缺点是您必须在第一个按钮容器上设置一个特定宽度才能使其在 IE7 中工作。在 Firefox 和 IE8 中没有它也可以正常工作。

doctype 很重要，以便页面以符合标准的模式呈现。没有它，页面将以怪异模式显示，这使得 IE 以完全不同的间距显示表单元素。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<style type="text/css">
    .formButtons { float: left;  }
    .formSubmitButtons { width: 120px; }
    .formSubmitButtons input { float: right; }
    .formFields { clear: both; }
</style>
</head>
<body>
    <form action="blah" method="POST" enctype="application/x-www-form-urlencoded">
    <div class="formButtons formSubmitButtons">
        <input type="submit" name="btnNext" value="Next">
        <input type="submit" name="btnBack" value="Back">
    </div>
    <div class="formButtons">
        <input type="submit" name="btnCancel" value="Cancel">
    </div>
    <div  class="formFields">
        Some text fields go here...
    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T12:54:11.233

使按钮 type="button" 而不是 type="submit"。然后，添加一个隐藏字段，例如：

```
<hidden name="continue" value="Next"/> 
```

最后，为按钮添加javascript onclick 处理程序，它首先将隐藏字段的值设置为按下按钮的名称，然后提交表单。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T23:28:12.193

为什么你不只是浮动取消按钮呢？

如果这只是一个 firefox 问题，您可以使用像这样的属性选择器 input[name="btnCancel"] {float: right;} 或 margin-left 或任何您想要的。否则，只需在输入上使用类。

# java-me - 手机上的 J2ME 应用程序与浏览器

> ID：609254
> 
> 赞同：3
> 
> 时间：2009-03-04T04:42:35.643
> 
> 标签：java-me, mobile

最近我开始开发一个 J2ME 应用程序原型。我注意到开发一个好看的 UI 是多么困难。考虑在 J2ME 中开发一个应用程序来预订与 Web 服务交互的航班。

一个预订航班的网站将很容易开发，具有漂亮的用户界面，并且可以通过手机上的浏览器访问。我知道并非所有手机都有浏览器，但所有新的和即将推出的手机都有浏览器并且也有大屏幕。

在 j2me 中开发这样一个需要与 web 服务对话才能工作的应用程序是一个好主意吗？还是 j2me 只适用于独立应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-10T08:15:31.197

J2ME 的优点：

*   可以访问电话资源，如文件系统、电话簿和 GPS。最后一点在地图应用中非常重要。
*   您可以构建更丰富的用户界面。正如您所说，这可能很困难，但是有许多 GUI 库可以帮助您。相反，移动浏览器的 UI（你不能依赖 CSS 和 javascript 工作）会很差。
*   通信逻辑更灵活。您可以加密/解密数据、压缩它们、使用 SOAP Web 服务。使用浏览器，您最好的选择是开发 REST 服务。

J2ME的缺点：

*   Midlets 需要签名。这需要一些成本，并且在某些情况下，即使是已签名的应用程序也无法在特定手机中正常运行。
*   开发一个能在所有类型的手机上运行的 midlet 是一场噩梦。相反，设计良好的移动 Web 应用程序将在所有最近的手机中正常显示。
*   您需要有一个分发应用程序的渠道。人们需要下载它并为所需的带宽付费。您需要照顾那些对应用程序有问题的愤怒客户。有了网站，事情就容易多了。
*   J2ME 应用程序不可避免地与本地应用程序（iPhone、Windows Mobile、Symbian）进行比较。与这些相比，它们非常贫穷，许多人会发现为它们付费甚至使用它们是不合理的。

我的结论是：如今真正的智能手机越来越受欢迎，并赢得了越来越大的市场份额。在这种情况下，J2ME 的优势并不能真正克服它的限制。我能想到的唯一例外是，如果必须开发 GPS 应用程序。对于所有其他情况，移动网站是一个更好的主意。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-15T20:52:51.060

以前的答案中有*很多*误解和明显的错误陈述。

我建议你自己做研究。如今，您无需编写自己的 GUI 框架即可使用 J2ME 开发非常漂亮的应用程序*。*看看 LWUIT 真的。例如，他们将虚拟键盘作为其触摸屏功能之一，而 N97 等设备本身没有虚拟键盘。顺便说一句，使用 LWUIT，如果有人关心，您将包含一个 Blackberry 和 Android 端口。

如今，应用程序也成为许多平台的中心舞台，而不仅仅是 iPhone。看看这个领域的最新发展，比如 OVI、RIM、三星、SE、Orange World，它们都是从应用商店开始的。

“让人们在手机上使用网站比让他们下载应用程序更容易。” 这只是一个没有证据的主张。你不能这样说。这取决于很多其他因素。- 为什么用户要再次在相当小的屏幕上输入您的移动网址？

无论如何，这个答案可能为时已晚，所以我不会写更多。移动行业现在正在快速变化，但对于跨平台开发，还没有 J2ME 的替代品。也许在未来会有更好的浏览器和小部件技术。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T05:14:14.210

只是一个简短的说明，像 google maps 或 gmail mobile 之类的应用程序可能不使用 WebServices 与其服务器部分对话。WebService 有很多开销，尤其是考虑到移动用户通常是根据他们传输的数据量来评定的。在客户端应用程序与其服务器部分之间执行通信的最佳方式是通过套接字连接使用二进制数据。

我个人认为，要制作一个能够在大量手机上运行的一致且可靠的 J2ME 应用程序真的很难。根据我的经验，如果有严格的要求，我只会开发 J2ME 应用程序（而不是 Web 应用程序）——例如，能够在不连接到网络的情况下查看您的预订。与 J2ME 应用程序相关的其他成本 - 必须下载应用程序，当应用程序尝试连接时，用户将被询问是否允许连接到网络（这种情况有例外，但我认为必须对应用程序进行签名由第 3 方公司 - 涉及更多 $$$），您将不得不维护在各种手机上运行的应用程序的不同版本（应用程序更复杂），等等......

这样想——如果你正在为计算机开发类似的东西，你会构建桌面应用程序还是 Web 应用程序？对于今天的手机（其中许多可以使用 javascript - 这意味着 ajax 访问完整的 html 网站），问题的提议是有效的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-10T08:34:14.133

我认为一个好的经验法则应该是：**如果您想要实现的目标可以通过移动网站完成 - 选择网站。**

恕我直言，只有在无法利用移动硬件（如位置、声音、视频、3d、图片等）的情况下才应使用应用程序...

即使应用程序的开发成本微不足道（它们通常不是），您也必须提供一些非常惊人的功能来让用户不费吹灰之力地下载它。

（所有这些对于 J2ME/BREW 来说基本上都是正确的。iPhone 有点不同，因为应用程序占据了中心舞台）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-10T15:19:01.367

值得强调的一点是：部署 MIDlet 的唯一标准方法是通过 OTA 下载，因此您不会期望支持 J2ME 的手机没有 Web 浏览器。

像 Webkit 和 Opera 这样的移动网络浏览器变得比 J2ME 更快（至少在 MIDP3.0 开始发布之前，如果有的话）。

无论您选择哪个平台，您都需要在许多设备上测试您的服务。我不认为从 J2ME 切换到 webapp 在这方面会有很大的不同，因为手机制造商一直在更改手机固件中的二进制文件。

让人们在手机上使用网站比让他们下载应用程序更容易。除非他们在购买手机时已经安装了该应用程序，否则就是这样。

您可能希望查看 LWUIT 以获得更好、更简单的 J2ME GUI。

J2ME 将为航班预订服务完成的一件事是通过不需要持续的网络数据传输来节省电池寿命，这要归功于本地存储机制。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T04:49:56.670

有许多很棒的 j2me 应用程序（需要）与 Web 服务对话。想想谷歌应用程序，比如 gmail 手机和手机地图。它们比通过手机浏览器使用服务更快、更容易使用。所以如果你能设计一个好的应用程序，那绝对是值得的。

编辑：此外，j2me 应用程序使 Web 应用程序无法提供的功能成为可能：与电话功能（地址簿、日历）、“呼叫此号码”、位置 api 等集成。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-08T21:59:02.407

我认为对于商业应用程序或更多面向文本/数据的事物，移动 web/wap 站点可能更易于维护，因为您不必处理将客户端更新推送到手机的问题。

对于 UI 密集型应用程序（地图、游戏等），客户端应用程序可能是要走的路，因此您可以在客户端处理更多的处理和渲染。

不过，这两种选择都很困难，因为手机存在很多兼容性问题。缩小您希望为您的应用程序支持的手机类型可能会为您提供最好的服务。如果您认为您的大多数客户将是 iPhone 或 Android 手机，那么您可以针对这些平台（使用客户端应用程序或 Web 应用程序）并完全避免使用老式的 j2me。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-09-01T10:46:22.880

我讨厌手机上的 WebApps。它们很慢，并且不能在半连接的环境中工作。

J2ME 应用程序可以进行本地备份、蓝牙备份、两部手机之间的蓝牙数据共享和更好的响应式 UI。但是，这需要金钱，技能，时间等。

My main gripes with MIDP though is pushing software updates and wav real time mixing. Technically those are possible within the scope of MIDP but the goons at wheel are not very creative.

# linq - Linq To Entity Framework 选择整个表

> ID：609257
> 
> 赞同：0
> 
> 时间：2009-03-04T04:43:19.073
> 
> 标签：linq, entity-framework

我有以下 Linq 语句：

```
(from order in Orders.AsEnumerable()
 join component in Components.AsEnumerable()
    on order.ORDER_ID equals component.ORDER_ID
 join detail in Detailss.AsEnumerable()
    on component.RESULT_ID equals detail.RESULT_ID
 where orderRestrict.ORDER_MNEMONIC == "MyOrderText"
 select new 
            {
                Mnemonic = detail.TEST_MNEMONIC,
                OrderID = component.ORDER_ID,
                SeqNumber = component.SEQ_NUM
            }).ToList() 
```

我希望这会提出以下查询：

```
select  *   
from    Orders ord (NoLock)   
        join Component comp (NoLock)
          on ord .ORDER_ID = comp.ORDER_ID
        join Details detail (NoLock)
          on comp.RESULT_TEST_NUM = detail .RESULT_TEST_NUM
where   res.ORDER_MNEMONIC = 'MyOrderText' 
```

但相反，我得到 3 个单独的查询，它们从表中选择所有行。我猜测 Linq 正在过滤这些值，因为我最终得到了正确的值。

问题是它花费的时间太长了，因为它正在从所有三个表中拉下所有行。

有什么想法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T04:50:19.527

从查询中删除 .AsEnumerable()，因为它们会阻止在服务器上评估整个查询。

# perforce - Perforce 保存打开文件的本地副本

> ID：609261
> 
> 赞同：4
> 
> 时间：2009-03-04T04:45:17.400
> 
> 标签：perforce

我已经检查了 perforce 客户端上的几个文件。我可以通过命令'p4 opens'获取这些文件的列表它以 //depot/... 的形式给出路径，就像我想知道如何将其转换为本地路径上的路径（我的意思是客户端路径）这样我就可以在一天结束之前创建一个批处理文件来备份那些提前谢谢 Uday

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-09T03:41:02.610

此批处理脚本可以将文件压缩到单独的更改列表中。

```
for /F "tokens=1,5,6 delims=# " %%a IN ('p4 opened') do for /F "tokens=3" %%j IN ('p4 where %%a') do zip %%b%%c %%j 
```

它将创建如下文件：

```
change571620.zip
change673450.zip
change723098.zip
defaultchange.zip 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-04T05:51:56.990

您可以使用[`p4 where`](http://www.perforce.com/perforce/doc.current/manuals/cmdref/where.html)将仓库文件规范转换为本地文件规范。

要解析`p4 where`Windows 批处理文件的输出，类似以下内容可能会有所帮助：

```
for /f "tokens=3" %%i in ('p4 where %my_depot_filespec%') do echo %%i 
```

`p4 where`请注意，对于更复杂的映射，例如文档中描述的映射，for 循环的主体可能会执行多次。如果您需要处理这些，您可能需要进行更复杂的解析。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-05T09:46:27.810

您可能还想考虑*为什么*您觉得除了使用 Perforce 本身之外，还需要在每天结束时备份文件。

您可能会发现在每天结束时使用开发分支并提交更改（选中“重新打开以进行编辑”标记）实际上更容易更好。首先，您使用 Perforce 来跟踪您的更改，而不是您自己的手动系统。

使用开发分支意味着您可以进行这些签入，而不会有弄乱同事的风险。

只是一个值得考虑的建议，仅此而已。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-04T05:51:30.610

```
p4 where filename 
```

这是您要查找的命令。

它将列出本地文件系统上文件的 depot 路径、客户端路径和绝对路径。只需将输出输入`cut`并选择绝对路径并将它们复制过来。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-09T03:53:13.633

此批处理脚本可以将文件压缩到单独的更改列表中。

for /F "tokens=1,5,6 delims=#" %%a IN ('p4 打开') for /F "tokens=3" %%j IN ('p4 where %%a') 做 zip % %b%%c %%j

它将创建如下文件：
change571620.zip
change673450.zip
change723098.zip
defaultchange.zip

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T04:51:40.067

检查您的 p4 客户端，因为您已经定义了 //depot 到文件系统路径的映射。替换 //depot 以获取文件的本地路径，以便您可以备份。

我不知道如何在批处理文件中以编程方式获取它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-11T00:57:11.090

以下 BAT 脚本从挂起的更改列表（%1 命令行参数）复制 perforce 打开的文件

p4 opens -c %1 > open-%1.txt
for /F "tokens=1 delims=#" %%i IN (open- %1.txt) do call :add-to-zip %%i

:add-to-zip
for /F "tokens=3" %%j IN ('p4 where %1') do zip [zip-file-name ] %%j

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-06-30T20:04:31.630

仅供参考，从 v2012/2013 开始，您最好使用 Perforce 的搁置功能进行日常备份操作。然后，您团队中的其他用户也可以访问这些书架。以这种方式使用它进行备份可以防止您的历史记录被您并不真正关心的中间文件变体污染（或其中部分不适合签入）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-08-31T15:23:45.697

非常感谢 :-) 只是在搜索可以为我提供打开文件的客户端路径的命令，原因与备份文件的原因相同。不仅我得到了命令，还有脚本:-)

# java - Java SWT 中的窗口 ID

> ID：609262
> 
> 赞同：5
> 
> 时间：2009-03-04T04:46:12.577
> 
> 标签：java, swt

我想找到我的 SWT 程序的窗口 ID。

我以标准方式启动我的 SWT shell。然后如何找到已创建的窗口的 ID？该程序使用 Compiz-Fusion 窗口管理器在 Fedora 10 上执行（如果有区别的话）。

帮助解释我的意思的代码：

```
public static void main(String[] args) {
  Display display = new Display();
  Shell shell = new Shell();

  // find window ID here??

  shell.open();

  while (!shell.isDisposed()) {
    if(!display.readAndDispatch()) {
      display.sleep();
    }
  }
} 
```

**2009 年 3 月 6 日更新** 在查看并尝试了一系列事情之后（感谢 VonC 的以下建议），我发现了一些迄今为止有效的东西。这是非常狡猾的，但至少让我暂时可以继续做一些其他的工作。

从 Control.embeddedHandle 返回的 ID 接近窗口 ID。它的不同之处在于可预测的偏移量。所以我的代码是：

```
public static void main(String[] args) {
  ...
  Shell shell = new shell(display, SWT.NONE);

  Composite e = new Composite(shell, SWT.EMBEDDED);
  long windowID = e.embeddedHandle - WINDOW_ID_MAGIC_NUMBER;
  e.dispose();
  .... 
```

WINDOW_ID_MAGIC_NUMBER 是 5+（在嵌入复合之前添加到外壳的小部件数量）。

到目前为止，它在我的系统上似乎是可靠的。我还没有看到它是否会在不同的环境中摔倒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T05:11:42.813

如果您使用 SWT.EMBEDDED 样式[创建一个 Composite ，那么在 SWT/GTK+ Composite.embeddedHandle 下将是一个 X 窗口 ID，您可以使用它来作为 XEMBED 子级的父级。](http://dev.eclipse.org/newslists/news.eclipse.platform/msg43903.html)

```
Composite embed = new Composite(shell, SWT.EMBEDDED);
System.out.println ("X window ID: " + embed.embeddedHandle);
int hwndChild = OS.GetWindow ( c.handle, OS.GW_CHILD); 
```

这支持使用 XEMBED 协议进行嵌入。

这类似于用于从句柄获取窗口 ID 的 JNI 代码

```
GtkWidget *widget = (GtkWidget *) handle;
GdkWindow *window = widget->window;
xwinid = GDK_WINDOW_XWINDOW(window); 
```

[这里的代码](http://dev.eclipse.org/newslists/news.eclipse.platform.swt/msg18374.html)示例。

使用操作系统的类示例：

[org.eclipse.swt.widgets.Tree](http://www.koders.com/java/fidCDDF21A1919AFCEB1555C1A723B8FFEDFE8F337B.aspx?s=eclipse+OS.GetWindow#L496)， [org.eclipse.swt.widgets.CoolItem](http://www.koders.com/java/fid9837296398E6960E9552ADBD83E550DF48555877.aspx?s=eclipse+OS.GetWindow#L307)，

我可以找到的操作系统确实是[**org.eclipse.swt.internal.win32.OS**](http://kickjava.com/src/org/eclipse/swt/internal/win32/OS.java.htm)，而不是 gtk，它不是一个完美的解决方案，因为您将访问一个*内部*包，但这可以让您知道在哪里查看。

在您的情况下，[`org.eclipse.swt.internal.gtk.OS`](http://www.koders.com/java/fid4D21714D4CC96A78F3483959B93F4F95BA66C762.aspx)是正确的类，您应该在 Tree 或 CoolItem 源中查看它们如何使用 GetWindow 函数。
需要在 GTK 中调用其他一些函数，比如可能是`gtk_container_get_children(int container);`

在对我一开始提到的消息[的回答](http://dev.eclipse.org/newslists/news.eclipse.platform/msg43905.html)中说

> 如果您需要 X 窗口，则无法从公共 SWT API 执行此操作（甚至通过内部），而且即使有一种方法我认为您不能保证所有控件都可以使用它。我不确定这是否有效，但最接近的可能是：
> 
> 1.  `Control.fixedHandle`公开 _
> 2.  用于`OS.GTK_WIDGET_WINDOW (control.fixedHandle)`获取`GdkWindow`
> 3.  用于`OS.gdk_x11_drawable_get_xid (gdkWindow)`将其转换为 X 窗口
> 
> 我猜另一种方法可能是采取**`Control.handle`**，然后调用`GTK_WIDGET_WINDOW()`它，或者如果它`null`一直调用它的父母，直到你找到一个带有 的`GdkWindow`，然后将其转换为 X 窗口。
> 
> 这里的困难在于 SWT 与 GTK+ 对话，GTK+ 与 GDK 对话，然后与 X 对话。因此，在您和 X 窗口之间存在三层。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-10-17T02:44:38.913

不知道这对你是否仍然重要，7 年后:-)，但这对我有用：

```
private static long getWindowIdFromShell(Shell shell) {
  long handle = shell.handle;
  long topWidget = OS._gtk_widget_get_toplevel(handle);
  long topWindow = OS._gtk_widget_get_window(topWidget);
  long topXid = OS._gdk_x11_window_get_xid(topWindow);
  return topXid;
} 
```

特别是，“get_toplevel”步骤是跳转到根窗口小部件/窗口的步骤，因此意味着您不需要“减去魔法窗口偏移”黑客（我最初也被困在这样做）。

# java - 区分从 HTML 表单提交的 HTTP 请求和从用户提交的 HTTP 请求

> ID：609265
> 
> 赞同：0
> 
> 时间：2009-03-04T04:48:12.510
> 
> 标签：java

我为服务器发送和接收的信息编写了 java 代码，以字节为单位。问题是我如何区分从 HTML 表单提交的 HTTP 请求和从用户提交的 HTTP 请求。我们正在尝试通过 HTTP 标头中的引用，但对于第一个请求，引用者为空。因此这个选项是不可行的。还有其他 API/其他方法吗？请让我知道一个示例代码...谢谢，Ps

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T05:19:55.133

我现在更好地理解了这个问题。简单回答是不。更复杂的答案是，你能做的最好的就是做出明智的猜测。

如果请求没有 Referrer 标头 ( [1](http://en.wikipedia.org/wiki/HTTP_referrer) )，则这可能意味着用户直接访问了 URL（例如通过在地址栏中输入 URL，或选择书签）。这里的问题是不能保证您会收到该标头，因此您必须希望浏览器正常运行。

接下来，如果请求类型是 POST 并且 mime 类型是“application/x-www-form-urlencoded”或“multipart/form-data”，那么这通常是表单提交，即用户点击了提交，或类似的.( [2](http://www.w3.org/TR/html401/interact/forms.html#h-17.3) )

使用浏览器的用户（通常）不可能直接发出 POST 请求。

所以这是一些帮助你做出最佳猜测的基本规则，但是浏览器端有很多东西会扰乱这个逻辑，老实说，我不认为你会找到能准确帮助你的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T04:59:55.837

这是高级别的算法：

1.  生成 HTML 表单时，生成一个随机数/字符串/GUID，并将其作为隐藏输入嵌入到表单中。将此随机值存储在服务器端（在应用程序上下文中，在[LinkedHashMap 中，以便您可以设置最大大小/MRU 缓存](https://stackoverflow.com/questions/583852/how-to-implement-a-most-recently-used-cache)，在某种[缓存解决方案](http://ehcache.sourceforge.net/)等中）
2.  处理表单请求时，检查是否存在此随机令牌。
    *   如果请求包含随机令牌，则`source = HTML form`
    *   别的，`source = human`

您还可以在发送原始 HTML 表单时设置 cookie，在回发时检查它们的存在；将一些数据放入 Session 对象等；这些都是同一个想法的变体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T10:38:20.173

如果这是出于安全原因，那么这是不可能的。浏览器发送给您的任何内容也可以由用户发送。

但不清楚您所说的由用户发送是什么意思。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T11:35:13.453

就像布林迪说的。检查方法，如果它的帖子检查 MIME 类型。它与您将要获得的一样准确。除非用户是专业人士，否则他不会知道如何伪造表单提交，并且大多数使用 post 进行通信的非浏览器应用程序将指定不同的 mime 类型。

# c - 将 char 缓冲区传递给函数并获取缓冲区的大小

> ID：609267
> 
> 赞同：12
> 
> 时间：2009-03-04T04:49:33.240
> 
> 标签：c, arrays, function, char

我已将缓冲区大小设置为 100。我在声明缓冲区的主函数中显示缓冲区。但是，当我将缓冲区传递给函数并获取 sizeof '4' 时，我认为它应该是 100，因为这是我在 main.js 中创建的缓冲区的大小。输出：缓冲区大小：100 sizeof（缓冲区）：4

```
#include <string.h>
#include <stdio.h>

void load_buffer(char *buffer);

int main()
{
    char buffer[100];
    printf("buffer size: %d\n", sizeof(buffer));
    load_buffer(buffer);

    return 0;
}

void load_buffer(char *buffer)
{
    printf("sizeof(buffer): %d\n", sizeof(buffer));
} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-03-04T04:52:19.787

您正在使用指向缓冲区的指针的大小（4 个字节），而不是缓冲区的大小。

在 C 中，您必须单独传递缓冲区的大小，这是缓冲区溢出如此容易和频繁发生的部分原因。

```
void load_buffer(char * buffer, size_t bufSize)
{    
    ...
} 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-04T05:11:58.023

Mitch Wheat 和 hhafez 的回答是完全正确和中肯的。我将展示一些有时可能有用的附加信息。

请注意，如果您告诉编译器您有一个大小正确的数组，也会发生同样的情况

```
void load_buffer(char buffer[100]) {
    /* prints 4 too! */
    printf("sizeof(buffer): %d\n", sizeof(buffer));
} 
```

数组作为参数只是声明一个指针。`char *name`即使它被声明为，编译器也会自动将其更改为`char name[N]`.

如果你想强制调用者只传递一个大小为 100 的数组，你可以接受数组的地址（以及它的类型）：

```
void load_buffer(char (*buffer)[100]) {
    /* prints 100 */
    printf("sizeof(buffer): %d\n", sizeof(*buffer));
} 
```

它是指向您在 main 中的数组的指针，因此您需要在函数中取消引用以获取数组。然后索引由

```
buffer[0][N] or (*buffer)[N] 
```

我认识的人都没有这样做，我自己也没有这样做，因为这会使争论的传递变得复杂。但很高兴知道它。然后你可以像这样调用函数

```
load_buffer(&buffer) 
```

如果您也想接受其他尺寸，我会选择其他两个答案推荐的 pass-N 选项。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-04T04:57:17.387

来自 OP

> ```
> void load_buffer(char *buffer)
> {
>     printf("sizeof(buffer): %d\n", sizeof(buffer));
> } 
> ```

即使您可以想象它`load_buffer()`是`buffer`按引用传递的，但真正发生的是您传递的是`char`按**值传递的指针。**实际数组未传递，因此`load_buffer()`函数无法知道缓冲区数组的大小

那么在`sizeof(buffer)`做什么呢？它只是返回指向 char 的指针的大小。如果`load_buffer()`需要它的大小，`buffer`则需要单独传递。

或者您可以创建一个包含 char 数组和数组大小的新结构，然后将指针传递给该结构，这样缓冲区和它的大小总是在一起;)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-04T04:56:01.070

发生的情况是，当您将数组传递给函数时，您只传递了数组在内存中的地址，而不是数组的大小。load_buffer() 中输出的 sizeof(buffer) 是指针的大小，即四个字节。

保持函数中缓冲区大小的最佳方法是将函数更改为：

```
void load_buffer(char *buffer, int length); 
```

并呼吁：

```
load_buffer(buffer, sizeof(buffer)); 
```

然后在需要缓冲区大小时使用长度。

# wix - ServiceInstall 或 ServiceControl 问题

> ID：609271
> 
> 赞同：2
> 
> 时间：2009-03-04T04:50:23.643
> 
> 标签：wix, windows-installer, wix3

在安装期间，我正在使用 ServiceInstall 和 ServiceControl 标签安装我的服务。但是，我的服务没有运行。我收到错误消息“请检查您是否有足够的权限来启动服务”。但是，我在管理员组中。我正在使用 Wix 3.0 版。

代码片段在这里，

```
<File Id='myexe' Name='myexe.exe' DiskId='1'
        Source='myexe.exe' Vital='yes'>
</File>

<ServiceInstall Id='myService' DisplayName='MySampleService' 
                Name='MySampleService' 
                ErrorControl='normal' Start='auto' 
                Type='ownProcess' Vital='yes' />

     <ServiceControl Id="StartService"
                  Name="MySampleService" Start="install" Wait="yes" />
     <ServiceControl Id="StopService" Name="MySampleService"
                  Stop="both" Wait="yes" Remove="uninstall" /> 
```

请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-13T01:19:13.673

这是由于任何原因服务无法安装或启动（如果您告诉它这样做）时出现的一般错误。这是非常令人沮丧的。调试的唯一方法是慢慢删除依赖项，直到事情最终正常工作。通常，该服务需要一些代码（GAC 中的程序集？），这些代码直到以后才完全配置。

我通常通过查看 Services.msc 并在错误消息出现时尝试启动服务来进行调试。这通常会提供比 Windows Installer 更好的错误消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T14:04:25.943

不要尝试根据安装到全局程序集缓存 GAC 中的组件来启动 .NET 服务，ServiceStart 来得太早了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-03-05T11:29:37.557

尝试使用 util:User 元素

例如：

```
<util:User Id="myServiceUser" Name="[USERNAME]" LogonAsService="yes" UpdateIfExists="yes" CreateUser="no"
                   FailIfExists="no" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-19T14:11:03.663

您还可以检查 Window Eventlog 以确定问题。如果问题是缺少二进制文件，您可以使用[Depends](http://www.dependencywalker.com/)找出丢失的内容。

# image - 在 HTML/CSS 中将图像转换为灰度

> ID：609273
> 
> 赞同：648
> 
> 时间：2009-03-04T04:51:26.887
> 
> 标签：image, css, grayscale

有没有一种简单的方法来显示灰度颜色位图`HTML/CSS`？

它不需要与 IE 兼容（我想它不会）——如果它在 FF3 和/或 Sf3 中工作，那对我来说已经足够了。

我知道我可以同时使用`SVG`Canvas 和 Canvas，但现在这似乎需要做很多工作。

有没有真正懒人的方法来做到这一点？

* * *

## 回答 #1

> 赞同：771
> 
> 时间：2011-12-23T03:45:01.577

[对 CSS 过滤器的支持已经登陆 Webkit。](http://updates.html5rocks.com/2011/12/CSS-Filter-Effects-Landing-in-WebKit) 所以我们现在有了一个跨浏览器的解决方案。

```
img {
  filter: gray; /* IE6-9 */
  -webkit-filter: grayscale(1); /* Google Chrome, Safari 6+ & Opera 15+ */
  filter: grayscale(1); /* Microsoft Edge and Firefox 35+ */
}

/* Disable grayscale on hover */
img:hover {
  -webkit-filter: grayscale(0);
  filter: none;
}
```

```
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/04/Wikimedia_Canadian_Community_Logo.svg/240px-Wikimedia_Canadian_Community_Logo.svg.png">
```

* * *

**Internet Explorer 10 怎么样？**

您可以使用像[gray](https://github.com/karlhorky/gray)这样的 polyfill 。

* * *

## 回答 #2

> 赞同：130
> 
> 时间：2010-10-26T23:45:45.277

Following on from [brillout.com's answer](https://stackoverflow.com/questions/609273/convert-an-image-to-grayscale-in-html-css/4027029#4027029), and also [Roman Nurik's answer](https://stackoverflow.com/questions/609273/convert-an-image-to-grayscale-in-html-css/979261#979261), and relaxing somewhat the the 'no SVG' requirement, you can desaturate images in Firefox using only a single SVG file and some CSS.

Your SVG file will look like this:

```
<?xml version="1.0" encoding="UTF-8"?>
<svg version="1.1"
     baseProfile="full"
     xmlns="http://www.w3.org/2000/svg">
    <filter id="desaturate">
        <feColorMatrix type="matrix" values="0.3333 0.3333 0.3333 0 0
                                             0.3333 0.3333 0.3333 0 0
                                             0.3333 0.3333 0.3333 0 0
                                             0      0      0      1 0"/>
    </filter>
</svg> 
```

Save that as resources.svg, it can be reused from now on for any image you want to change to greyscale.

In your CSS you reference the filter using the Firefox specific `filter` property:

```
.target {
    filter: url(resources.svg#desaturate);
} 
```

Add the MS proprietary ones too if you feel like it, [apply that class to any image you want to convert to greyscale (works in Firefox >3.5, IE8)](http://www.boogdesign.com/examples/svg/desaturate.html).

**edit**: [Here's a nice blog post](http://thenewcode.com/532/Convert-Images-To-Black-And-White-With-CSS) which describes using the new CSS3 `filter` property in SalmanPK's answer in concert with the SVG approach described here. Using that approach you'd end up with something like:

```
img.desaturate{
    filter: gray; /* IE */
    -webkit-filter: grayscale(1); /* Old WebKit */
    -webkit-filter: grayscale(100%); /* New WebKit */
    filter: url(resources.svg#desaturate); /* older Firefox */
    filter: grayscale(100%); /* Current draft standard */
} 
```

[Further browser support info here](http://caniuse.com/#feat=css-filters).

* * *

## 回答 #3

> 赞同：85
> 
> 时间：2012-11-30T06:57:02.373

对于 Firefox，您不需要创建 filter.svg 文件，您可以使用[data URI scheme](http://en.wikipedia.org/wiki/Data_URI_scheme)。

占用第一个答案的css代码给出：

```
filter: url("data:image/svg+xml;utf8,<svg%20xmlns='http://www.w3.org/2000/svg'><filter%20id='grayscale'><feColorMatrix%20type='matrix'%20values='0.3333%200.3333%200.3333%200%200%200.3333%200.3333%200.3333%200%200%200.3333%200.3333%200.3333%200%200%200%200%200%201%200'/></filter></svg>#grayscale"); /* Firefox 3.5+ */
filter: grayscale(100%); /* Current draft standard */
-webkit-filter: grayscale(100%); /* New WebKit */
-moz-filter: grayscale(100%);
-ms-filter: grayscale(100%); 
-o-filter: grayscale(100%);
filter: gray; /* IE6+ */ 
```

注意用您的文件编码替换“utf-8”字符串。

这种方法应该比另一种更快，因为浏览器不需要进行第二次 HTTP 请求。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2012-11-01T19:32:33.247

**更新：**我把它做成了一个完整的 GitHub 存储库，包括 IE10 和 IE11 的 JavaScript polyfill：[https ://github.com/karlhorky/gray](https://github.com/karlhorky/gray)

我最初使用[SalmanPK 的答案](https://stackoverflow.com/a/8612047/1268612)，但随后创建了以下变体以消除 SVG 文件所需的额外 HTTP 请求。内联 SVG 在 Firefox 10 及以上版本中工作，低于 10 的版本不再占全球浏览器市场的 1%。

从那以后，我一直在[此博客文章](http://www.karlhorky.com/2012/06/cross-browser-image-grayscale-with-css.html)中更新解决方案，添加对退色的支持、对 SVG 的 IE 10/11 支持以及演示中的部分灰度。

```
img.grayscale {
  /* Firefox 10+, Firefox on Android */
  filter: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg'><filter id='grayscale'><feColorMatrix type='matrix' values='0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0'/></filter></svg>#grayscale");

  /* IE 6-9 */
  filter: gray;

  /* Chrome 19+, Safari 6+, Safari 6+ iOS */
  -webkit-filter: grayscale(100%);
}

img.grayscale.disabled {
  filter: none;
  -webkit-filter: grayscale(0%);
} 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2010-12-08T15:41:21.377

如果您能够使用 JavaScript，那么此脚本可能就是您正在寻找的。它可以跨浏览器工作，到目前为止对我来说工作正常。您不能将它与从不同域加载的图像一起使用。

[http://james.padolsey.com/demos/grayscale/](http://james.padolsey.com/demos/grayscale/)

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2016-11-04T09:34:07.973

仅使用 CSS 实现灰度的最简单方法是通过`filter`属性。

```
img {
    -webkit-filter: grayscale(100%); /* Safari 6.0 - 9.0 */
    filter: grayscale(100%);
} 
```

该属性仍不完全受支持，并且仍需要该`-webkit-filter`属性以支持所有浏览器。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2012-03-05T16:04:24.243

今天刚遇到同样的问题。我最初使用[SalmanPK 解决方案](https://stackoverflow.com/a/8612047/933464)，但发现 FF 和其他浏览器之间的效果不同。这是因为转换矩阵只对亮度起作用，而不像 Chrome/IE 中的过滤器那样对亮度起作用。令我惊讶的是，我发现 SVG 中的替代和更简单的解决方案也适用于 FF4+ 并产生更好的结果：

```
<svg xmlns="http://www.w3.org/2000/svg">
  <filter id="desaturate">
    <feColorMatrix type="saturate" values="0"/>
  </filter>
</svg> 
```

使用CSS：

```
img {
    filter: url(filters.svg#desaturate); /* Firefox 3.5+ */
    filter: gray; /* IE6-9 */
    -webkit-filter: grayscale(1); /* Google Chrome & Safari 6+ */
} 
```

还有一点需要注意的是，IE10 在标准兼容模式下不再支持“过滤器：灰色：”，因此需要在标头中切换兼容模式才能工作：

```
<meta http-equiv="X-UA-Compatible" content="IE=9" /> 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2015-03-02T18:17:14.390

一段时间以来，现代浏览器上已经有一种新的方法可以做到这一点。

**background-blend-mode**可以让你得到一些有趣的效果，其中之一就是灰度转换

设置在白色背景上的值*luminosity允许它。*（悬停以灰色查看）

```
.test {
  width: 300px;
  height: 200px;
    background: url("http://placekitten.com/1000/750"), white; 
    background-size: cover;
}

.test:hover {
    background-blend-mode: luminosity;
}
```

```
<div class="test"></div>
```

亮度取自图像，颜色取自背景。因为它总是白色的，所以没有颜色。

但它允许更多。

您可以为效果设置 3 层设置动画。第一个是图像，第二个是黑白渐变。如果您对此应用乘法混合模式，您将在白色部分获得与以前一样的白色结果，但黑色部分上的原始图像（乘以白色得到白色，乘以黑色没有效果。）

在渐变的白色部分，你会得到和以前一样的效果。在渐变的黑色部分，您将图像与自身混合，结果是未修改的图像。

现在，所需要的只是移动渐变以获得动态效果：（悬停以查看颜色）

```
div {
    width: 600px;
    height: 400px;
}

.test {
    background: url("http://placekitten.com/1000/750"), 
linear-gradient(0deg, white 33%, black 66%), url("http://placekitten.com/1000/750"); 
    background-position: 0px 0px, 0px 0%, 0px 0px;
    background-size: cover, 100% 300%, cover;
    background-blend-mode: luminosity, multiply;
    transition: all 2s;
}

.test:hover {
    background-position: 0px 0px, 0px 66%, 0px 0px;
}
```

```
<div class="test"></div>
```

[参考](http://www.w3.org/TR/compositing-1/)

[兼容性矩阵](http://caniuse.com/#feat=css-backgroundblendmode)

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2013-04-28T05:23:54.677

对于在其他答案中询问被忽略的 IE10+ 支持的人，请查看这段 CSS：

```
img.grayscale:hover {
    filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'1 0 0 0 0, 0 1 0 0 0, 0 0 1 0 0, 0 0 0 1 0\'/></filter></svg>#grayscale");
}

svg {
    background:url(http://4.bp.blogspot.com/-IzPWLqY4gJ0/T01CPzNb1KI/AAAAAAAACgA/_8uyj68QhFE/s400/a2cf7051-5952-4b39-aca3-4481976cb242.jpg);
}

svg image:hover {
    opacity: 0;
} 
```

应用于此标记：

```
<!DOCTYPE HTML>
<html>
<head>

    <title>Grayscaling in Internet Explorer 10+</title>

</head>
<body>

    <p>IE10 with inline SVG</p>
    <svg xmlns="http://www.w3.org/2000/svg" id="svgroot" viewBox="0 0 400 377" width="400" height="377">
      <defs>
         <filter id="filtersPicture">
           <feComposite result="inputTo_38" in="SourceGraphic" in2="SourceGraphic" operator="arithmetic" k1="0" k2="1" k3="0" k4="0" />
           <feColorMatrix id="filter_38" type="saturate" values="0" data-filterid="38" />
        </filter>
      </defs>
      <image filter="url(&quot;#filtersPicture&quot;)" x="0" y="0" width="400" height="377" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://4.bp.blogspot.com/-IzPWLqY4gJ0/T01CPzNb1KI/AAAAAAAACgA/_8uyj68QhFE/s1600/a2cf7051-5952-4b39-aca3-4481976cb242.jpg" />
    </svg>

</body>
</html> 
```

有关更多演示，请查看 IE testdrive 的[CSS3 图形部分](http://ie.microsoft.com/testdrive/Graphics/hands-on-css3/hands-on_svg-filter-effects.htm)和这个旧的 IE 博客[http://blogs.msdn.com/b/ie/archive/2011/10/14/svg-filter-effects-in-ie10.aspx](http://blogs.msdn.com/b/ie/archive/2011/10/14/svg-filter-effects-in-ie10.aspx)

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-06-11T04:05:36.613

`-webkit-`即使使用 CSS3 或专有或`-moz-`CSS 属性，看起来也不可能（目前） 。

但是，我确实发现[了去年 6 月的这篇文章，](http://weblogs.mozillazine.org/roc/archives/2008/06/applying_svg_ef.html)它在 HTML 上使用了 SVG 过滤器。在任何当前浏览器中都不可用（演示暗示了自定义 WebKit 构建），但作为概念证明非常令人印象深刻。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2010-10-26T18:58:22.623

在 Internet Explorer 中使用过滤器属性。

在 webkit 和 Firefox 中，目前无法仅使用 CSS 对图像进行去饱和处理。因此，您将需要使用画布或 SVG 作为客户端解决方案。

但我认为使用 SVG 更优雅。查看我的博客文章，了解适用于 Firefox 和 webkit 的 SVG 解决方案： [http ://webdev.brillout.com/2010/10/desaturate-image-without-javascript.html](http://webdev.brillout.com/2010/10/desaturate-image-without-javascript.html)

严格来说，因为 SVG 是 HTML，所以解决方案是纯 html+css :-)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2016-05-03T15:12:47.183

Maybe this way help you

```
img {
    -webkit-filter: grayscale(100%); /* Chrome, Safari, Opera */
    filter: grayscale(100%);
} 
```

[w3schools.org](http://www.w3schools.com/cssref/css3_pr_filter.asp)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2009-03-04T05:20:43.320

如果我记得正确使用专有的 CSS 属性，实际上使用 IE 更容易做到这一点。`FILTER: Gray`从[http://www.ssi-developer.net/css/visual-filters.shtml](http://www.ssi-developer.net/css/visual-filters.shtml)试试这个

[Ax](https://stackoverflow.com/questions/609273/convert-an-image-to-grayscale-in-html-css/609302#609302)的方法只是使图像透明并在其后面有黑色背景。我敢肯定你会说这是灰度。

尽管您不想使用 Javascript，但我认为您必须使用它。您也可以使用服务器端语言来做到这一点。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2014-09-18T14:30:55.540

作为对其他答案的补充，可以在 FF 上对图像进行一半去饱和，而无需 SVG*矩阵的*头痛：

```
<feColorMatrix type="saturate" values="$v" /> 
```

和`$v`之间在哪里。它相当于.`0``1``filter:grayscale(50%);`

现场示例：

```
.desaturate {
    filter: url("#desaturate");
    -webkit-filter: grayscale(50%);
}
figcaption{
    background: rgba(55, 55, 136, 1);
    padding: 4px 98px 0 18px;
    color: white;
    display: inline-block;
    border-top-left-radius: 8px;
    border-top-right-radius: 100%;
    font-family: "Helvetica";
}
```

```
<svg version="1.1" xmlns="http://www.w3.org/2000/svg">
  <filter id="desaturate">
  	<feColorMatrix type="saturate" values="0.4"/>
  </filter>
</svg>

<figure>
  <figcaption>Original</figcaption>
  <img src="http://www.placecage.com/c/500/200"/>
  </figure>
<figure>
  <figcaption>Half grayed</figcaption>
  <img class="desaturate" src="http://www.placecage.com/c/500/200"/>
</figure>
```

[MDN 上的参考资料](https://developer.mozilla.org/fr/docs/Web/SVG/Element/feColorMatrix)

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2010-10-19T04:58:39.350

如果您愿意使用 Javascript，那么您可以使用画布将图像转换为灰度。由于 Firefox 和 Safari 支持`<canvas>`，它应该可以工作。

所以我用谷歌搜索了“canvas grayscale”，第一个结果是[http://www.permadi.com/tutorial/jsCanvasGrayscale/index.html](http://www.permadi.com/tutorial/jsCanvasGrayscale/index.html)这似乎有效。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2015-01-26T06:22:38.607

你不需要使用这么多前缀来充分使用，因为如果你为旧的火狐选择前缀，你不需要为新的火狐使用前缀。

所以为了充分利用，足够使用这个代码：

```
img.grayscale {
    filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/></filter></svg>#grayscale"); /* Firefox 10+, Firefox on Android */
    filter: gray; /* IE6-9 */
    -webkit-filter: grayscale(100%); /* Chrome 19+, Safari 6+, Safari 6+ iOS */
}

img.grayscale.disabled {
    filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'1 0 0 0 0, 0 1 0 0 0, 0 0 1 0 0, 0 0 0 1 0\'/></filter></svg>#grayscale");
    filter: none;
    -webkit-filter: grayscale(0%);
} 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2013-11-08T20:00:35.007

这是 LESS 的 mixin，可让您选择任何不透明度。以不同的百分比为纯 CSS 自己填写变量。

**这里有一个很好的提示**，它使用矩阵的饱和类型，所以你不需要做任何花哨的事情来改变百分比。

```
.saturate(@value:0) {
    @percent: percentage(@value);

    filter: url("data:image/svg+xml;utf8,<svg%20xmlns='http://www.w3.org/2000/svg'><filter%20id='grayscale'><feColorMatrix%20type='saturate'%20values='@value'/></filter></svg>#grayscale"); /* Firefox 3.5+ */
    filter: grayscale(@percent); /* Current draft standard */
    -webkit-filter: grayscale(@percent); /* New WebKit */
    -moz-filter: grayscale(@percent);
    -ms-filter: grayscale(@percent);
    -o-filter: grayscale(@percent);
} 
```

然后使用它：

```
img.desaturate {
    transition: all 0.2s linear;
    .saturate(0);
    &:hover {
        .saturate(1);
    }
} 
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2012-05-16T10:56:05.223

从当前版本 19.0.1084.46 添加了对 webkit 中原生 CSS 过滤器的支持

所以 -webkit-filter: grayscale(1) 会起作用，这比 webkit 的 SVG 方法更容易......

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2013-06-18T13:01:16.567

是**旧浏览器的另一种选择**是使用由伪元素或内联标签产生的掩码。

*通过 rgba() 或 translucide png*将绝对定位悬停在 img （或无需单击或选择的文本区域）可以密切模仿色标的效果。

它不会给出一个单一的色阶，但会使颜色超出范围。

通过伪元素用 10 种不同颜色的代码笔测试，最后是灰色。[http://codepen.io/gcyrillus/pen/nqpDd](http://codepen.io/gcyrillus/pen/nqpDd)（重新加载以切换到另一个图像）

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-09-13T20:42:11.560

根据[robertc 的回答](https://stackoverflow.com/a/4028908/1784053)：

要从彩色图像**正确**转换为灰度图像，而不是像这样使用矩阵：

```
0.3333 0.3333 0.3333 0 0
0.3333 0.3333 0.3333 0 0
0.3333 0.3333 0.3333 0 0
0      0      0      1 0 
```

您应该像这样使用转换矩阵：

```
0.299 0.299 0.299 0
0.587 0.587 0.587 0
0.112 0.112 0.112 0
0     0     0     1 
```

这应该适用于基于 RGBA（红绿蓝阿尔法）模型的所有类型的图像。

有关为什么您应该使用矩阵的更多信息，我更可能发布了 robertc 的一个检查以下链接：

*   [亮度和色差信号](https://intranet.rave.ac.uk/download/attachments/9116/The+Y,+U+and+V+signals.pdf?version=1&modificationDate=1180887337667)
*   [Margus 对问题的回答：“colorvalue 中的灰度值”@stackoverflow 部分：**编辑 2：@Hans Passant**](https://stackoverflow.com/a/5410393/1784053)
*   [Charles A. Bouman - 普渡大学 - 模拟电视第 20 和 21 页](https://engineering.purdue.edu/%7Ebouman/ece637/notes/guestlecture/Torres/Analog_TV.pdf)
*   [在这里你可以找到一些 C# 和 VB 代码](https://web.archive.org/web/20141230145627/http://bobpowell.net/grayscale.aspx)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-10-21T01:01:41.693

对于 Firefox 中的灰度百分比，请使用[饱和过滤器](https://developer.mozilla.org/en-US/docs/Web/SVG/Element/feColorMatrix)：（搜索“饱和”）

```
filter: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg'><filter id='saturate'><feColorMatrix in='SourceGraphic' type='saturate' values='0.2' /></filter></svg>#saturate" 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-06-11T04:41:43.877

一个糟糕但可行的解决方案：使用 Flash 对象渲染图像，然后为您提供 Flash 中所有可能的转换。

**如果**您的用户正在使用最先进的浏览器并且**Firefox** 3.5 和 Safari 4 支持它（我不知道是否会这样做），您可以调整图像的 CSS*颜色配置文件*属性，将其设置为灰度 ICC个人资料网址。但这是很多如果的！

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-10-01T11:00:46.167

您可以使用 jFunc 的功能之一 - 使用功能“jFunc_CanvasFilterGrayscale” [http://jfunc.com/jFunc-functions.aspx](http://jfunc.com/jFunc-functions.aspx)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2013-11-12T15:05:17.710

试试这个 jquery 插件。虽然，这不是一个纯粹的 HTML 和 CSS 解决方案，但它是实现你想要的一种懒惰的方式。您可以自定义灰度以最适合您的使用。使用它如下：

```
$("#myImageID").tancolor(); 
```

有一个交互式[演示](http://nicolaisi.github.io/tancolor/)。你可以玩弄它。

查看有关用法的文档，它非常简单。[文档](https://github.com/nicolaisi/tancolor)

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2010-10-16T00:56:41.560

如果您或将来面临类似问题的其他人对 PHP 持开放态度。（我知道你说的是 HTML/CSS，但也许你已经在后端使用 PHP）这是一个 PHP 解决方案：

我从 PHP GD 库中得到它并添加了一些变量来自动化该过程......

```
<?php
$img = @imagecreatefromgif("php.gif");

if ($img) $img_height = imagesy($img);
if ($img) $img_width = imagesx($img);

// Create image instances
$dest = imagecreatefromgif('php.gif');
$src = imagecreatefromgif('php.gif');

// Copy and merge - Gray = 20%
imagecopymergegray($dest, $src, 0, 0, 0, 0, $img_width, $img_height, 20);

// Output and free from memory
header('Content-Type: image/gif');
imagegif($dest);

imagedestroy($dest);
imagedestroy($src);

?> 
```

# c# - ListView DataItem 显示为空

> ID：609276
> 
> 赞同：18
> 
> 时间：2009-03-04T04:52:58.677
> 
> 标签：c#, asp.net, listview

几天前，我[写了一篇关于](https://stackoverflow.com/questions/583689/dictionaryt-of-listt-and-listviews-in-asp-net)在 ASP.NET 中实现 ListView 的问题。现在，在编写了所有其他代码后，我无法将更改的项目保存在 ListView 中。

有几点需要注意：

*   Save 按钮不是 ListView 的一部分；它调用该`GetListViewItems()`方法，该方法又调用该`Save()`方法。
*   `Listview.DataBind()`当按下按钮请求更新记录时调用该事件
*   Listview 显示文本 using`<%#Eval("Key.Name") %>`和[命名`DropDownList`](https://stackoverflow.com/questions/595761/concatenating-two-properties-for-display-in-a-dropdownlist)using`<%#Eval("Value") %>`

### 从 ListView 中获取项目

```
public void GetListViewItems()
{
 List<Foo> Result = FooManager.CreateFooList();
 DropDownList ddl = null;
 ListViewItem Item = null;
    try
      {
       foreach (ListViewDataItem item in lvFooList.Items)
         {
          Item = item;
          ddl = ((DropDownList) (Item.FindControl("ddlListOfBars")));
          if (//something is there)
           {
            Foo foo = FooManager.CreateFoo();
            foo.Id = item.DataItemIndex; //shows null
            int barId = int.Parse(ddl.SelectedItem.Value); //works just fine
            foo.barId = barId;
            Result.Add(foo);
           }
         }
      }
   catch (Exception ex)
     {
             //Irrelevant for our purposes
     }
} 
```

### 数据绑定 ListView

数据绑定 ListView 的代码[显示在我之前的问题](https://stackoverflow.com/questions/583689/dictionaryt-of-listt-and-listviews-in-asp-net)中。

### 问题）：

1.  为什么当我遍历每个项目的`ListViewDataItem`in时？`Listview``null`
2.  如何`Foo.Id`从字典中检索？
3.  我还可能缺少什么？
4.  如果我想`Id`根据显示的项目以编程方式获得它，我会使用什么？就像现在一样，当前的 ListView 是根据`Foo`选择的 s 显示的。然后显示选择的那些`Foo`，并且用户可以更改`Bar`中的`DropDownList`，点击保存，并且这些更改被传播。

* * *

### 更新

事实证明，我的问题是[leppie](https://stackoverflow.com/questions/609276/listview-dataitem-shows-null/609331#609331)所说的。那就是我需要指定`DataKeyNames`并使用它们来保留来自 ListView 的信息。

这是我添加的代码：

```
try
{
   int DataKeyArrayIndex = 0;
   foreach (ListViewDataItem item in lvFooList.Items)
     {
      Item = item;
      ddl = ((DropDownList) (Item.FindControl("ddlListOfBars")));
      if (//something is there)
       {
        Foo foo = FooManager.CreateFoo();
        Foo tempFoo = FooManager.CreateFoo();
        if (lvFooList != null)
        {
             tempFoo = ((Foo)(lvFooList.DataKeys[DataKeyArrayIndex].Value));
        }

        foo.Id = tempFoo.Id;
        int barId = int.Parse(ddl.SelectedItem.Value); //works just fine
        foo.barId = barId;
        Result.Add(foo);
        DataKeyArrayIndex++;
     }
   }
} 
```

然后在`.ascx`文件中，我添加了`DataKeyNames="Key"`，如下所示：

```
<asp:ListView ID="lvFooList" runat="server" DataKeyNames="Key"> 
```

这使我可以使用`Key` [我之前帖子](https://stackoverflow.com/questions/583689/dictionaryt-of-listt-and-listviews-in-asp-net)中的 Foo 来确定正在查看的 Foo。

对这种方法的任何批评，以及使其更好的方法都将受到高度赞赏。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-04T05:24:25.730

一些快速的答案：

1.  您需要使用数据绑定才能工作，换句话说，分配给`DataSource`和调用`DataBind()`。编辑：似乎你正在这样做。但请记住，它不会在回发之间持续存在，只是`DataKey`（见下文）。

2.  如果我没记错的话，您需要指定`DataKeyNames`，然后可以从`DataKey`属性中检索它们。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-18T21:50:41.397

您还可以使用 ListViewDataItem.DataItemIndex 属性而不是保留自己的索引，如下所示：

```
foreach (ListViewDataItem item in MyListView.Items)
{
    // in this example key is a string value
    Foo foo = new Foo(MyListView.DataKeys[item.DataItemIndex].Value as string);

    // do stuff with foo
} 
```

# visual-c++ - 为什么释放 calloc'ed 内存会使我的 VC6 项目崩溃？

> ID：609279
> 
> 赞同：0
> 
> 时间：2009-03-04T04:55:04.100
> 
> 标签：visual-c++, memory-management, visual-c++-6, gmp

比较这两个基本相同的功能。首先，`buff`使用 _alloca 分配内存。这工作正常。第二种，使用 calloc 和 free 代替 _alloca。这崩溃了。

奇怪的是，我在我拥有的几乎所有其他 GMP 包装函数中都使用了 calloc/free 技术，而且它们都可以工作。在这里他们没有。有任何想法吗？

# 1：

```
#define Z(x) mpz_t (x); mpz_init( (x) );
#define BUFF_SIZE (1024 * 32)

BSTR __stdcall IBIGDIV(BSTR p1, BSTR p2 ) { 
    USES_CONVERSION;

    Z(n1);
    Z(n2);
    Z(res);

    char * buff =  (char *) _alloca( mpz_sizeinbase( res, 10 ) + 2 );

    LPSTR sNum1 = W2A( p1 );
    LPSTR sNum2 = W2A( p2 );

    mpz_set_str( n1, sNum1, 10 );
    mpz_set_str( n2, sNum2, 10 );

    if ( mpz_sgn( n2 ) != 0 ) { 
        mpz_div( res, n1, n2 );
        mpz_get_str(buff, 10, res);
    } else {
        strcpy( buff, "-0" );
    }

    BSTR bResult = _com_util::ConvertStringToBSTR( buff );
    return bResult;
} 
```

# 2：

```
#define Z(x) mpz_t (x); mpz_init( (x) );
#define BUFF_SIZE (1024 * 32)

BSTR __stdcall IBIGDIV(BSTR p1, BSTR p2 ) { 
    USES_CONVERSION;

    Z(n1);
    Z(n2);
    Z(res);

    char * buff =  (char *) calloc( mpz_sizeinbase( res, 10 ) + 2, sizeof( char ) );

    LPSTR sNum1 = W2A( p1 );
    LPSTR sNum2 = W2A( p2 );

    mpz_set_str( n1, sNum1, 10 );
    mpz_set_str( n2, sNum2, 10 );

    if ( mpz_sgn( n2 ) != 0 ) { 
        mpz_div( res, n1, n2 );
        mpz_get_str(buff, 10, res);
    } else {
        strcpy( buff, "-0" );
    }

    BSTR bResult = _com_util::ConvertStringToBSTR( buff );
    free( buff );
    return bResult;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T05:01:24.210

这可能是不相关的，但是这种类型的“以一种方式工作，但不能以另一种方式工作”通常表示一个错误，它恰好在一种情况下吱吱作响，但在另一种情况下会导致致命错误。

如果您怀疑可能发生内存覆盖，您可以尝试在缓冲区中分配额外的 8 字节并写入 4 字节的开始和结束标记，然后在释放之前检查这些标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T05:05:53.217

我曾经花了一周的时间试图弄清楚类似的事情。这是一个缓冲区溢出，破坏了指针，因此自由进入树林。Rational purify 很快就发现了问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T05:13:49.547

添加日志记录并转储所有内容以找出问题所在。这通常比试图猜测更有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T05:17:15.793

如果出现错误（例如内存不足），calloc 可能会返回 NULL。我建议对照 NULL 检查任何内存分配函数的结果。如果为 NULL，则打印一条消息，然后 exit(1)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T22:18:57.430

`_alloca`返回堆栈内存，因此踩到它的末尾可能不一定会覆盖重要的东西。在堆内存分配结束后写入将更有可能覆盖一些重要的东西。

您的代码没有做任何事情来确保缓冲区至少与`res`将 n1 除以 n2 后格式化的一样大（反之亦然，因为我不知道实际函数的作用）；它只确保它有足够的内存用于初始化`res`，这可能是 1。如果`n1/n2`有更多的数字，欢迎来到 crashville。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-06T14:22:12.457

@johnny 指出了一些相当尴尬的事情，这需要重写代码。（在这里能够勾选评论会很有用。）

```
BSTR __stdcall IBIGDIV(BSTR p1, BSTR p2 ) { 
    USES_CONVERSION;

    Z(n1);
    Z(n2);
    Z(res);

    char * buff;

    LPSTR sNum1 = W2A( p1 );
    LPSTR sNum2 = W2A( p2 );

    mpz_set_str( n1, sNum1, 10 );
    mpz_set_str( n2, sNum2, 10 );

    if ( mpz_sgn( n2 ) != 0 ) { 
        mpz_div( res, n1, n2 );
        buff =  (char *) calloc( mpz_sizeinbase( res, 10 ) + 2, sizeof( char ) );
        mpz_get_str(buff, 10, res);
    } else {
        buff =  (char *) calloc( 3, sizeof( char ) );
        strcpy( buff, "-0" );
    }

    BSTR bResult = _com_util::ConvertStringToBSTR( buff );
    free( buff );
    return bResult;
} 
```

在以前的版本中，内存是根据`res`代码中包含零的点的值分配的。因此，我试图调用零字节并且 free 不喜欢它。在上面的代码中，`res`实际上包含了一些`mpz_sizeinbase`可以使用的东西。

# ruby - 堆栈级别太深错误Ruby-Gnome2

> ID：609282
> 
> 赞同：0
> 
> 时间：2009-03-04T04:56:23.723
> 
> 标签：ruby, gnome, ruby-gnome2

我有一个带有 Gtk::TreeModel 和 Gtk::TreeModelFilter 的 Gtk::TreeView。树模型是这样的：

```
category1
  --> actual row of data
category2
  --> actual row of data 
```

我想过滤@search_entry 的内容，但如果category1 下的行仍然可见，则显示category1，如果category2 下没有行仍然可见，则隐藏category2。我对 Gtk::TreeModelFilter#set_visible_func 的理解是从“子模型”中获取模型和迭代器，这样就可以检查是否显示子迭代器。每次我调用 Gtk::TreeModelFilter#refilter 时，模型中的每个迭代都会调用此函数。因此我的意思是：如果您刚刚给我的迭代在第一级，则获取路径，降级，转换为过滤器模型上的相同路径，并使用新路径是否存在来测试可见性。

```
@store = Gtk::TreeStore.new(Gdk::Pixbuf, String, String, Menagerie::Program, TrueClass)
@tree_filter = Gtk::TreeModelFilter.new(@store)
@treeview.model = @tree_filter

# @first_time gets set to false after the model is loaded the first time
@first_time = true
@tree_filter.set_visible_func do |model, iter|
  has_visible_children = true
  begin
    iter_path = iter.path
    if iter_path.depth == 1 && @first_time != true
      iter_path.down!
      has_visible_children = @tree_filter.convert_child_path_to_path(iter_path) ? true : false
    end
  rescue => e
    puts "THIS ERROR: " + e.message
  end
  unless @search_entry.text == ""
    if [1,2].collect {|i| iter[i] =~ /#{@search_entry.text}/i }.any?
      true
    elsif iter[4] == true and has_visible_children
      true
    else
      false
    end
  else
    true
  end
end 
```

线

```
has_visible_children = @tree_filter.convert_child_path_to_path(iter_path) ? true : false 
```

导致每个迭代器的“此错误：堆栈级别太深”输出。

这里有一个无限递归，但我不知道它发生在哪里，也不知道如何避免它。我确定我在考虑这个错误的方式，但我已经在这几天没有突破。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T05:07:41.887

我对 Ruby 一无所知，但这个错误显然指向了太多的递归迭代。每次调用都需要将上下文存储在堆栈中，导致 - 欢呼 - 一个

> 堆栈溢出

:-) 添加一个变量来跟踪您的迭代级别并将其打印出来并显示错误。您的数据或递归逻辑有问题，或两者都有。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T22:34:51.667

`refilter`调用每个节点上的块。但是，返回值不会与节点一起保存，因此无论您如何操作，如果您必须向下查看树，您将重复计算。

```
# Simplified version - returns true if search_text found in iter or any of its
# first-level children.
# Let's assume you add a method to GTK::TreeIter:
#    def has_text? search_text
#      self[1] =~ /#{search_text}/i or self[2] =~ /#{search_text}/i
#    end
@tree_filter.set_visible_func do |model, iter|
  next true if @search_entry.text.empty?   # No filtering if no search text
  next true if iter.path.depth == 0        # Always show root node
  next true if iter.has_text? @search_entry.text

  if child_iter = iter.first_child # Then we have children to check
    has_visible_children = false
    loop do 
      has_visible_children ||= child_iter.has_text? @search_entry.text
      break unless child_iter.next! # returns false if no more children
    end
    next has_visible_children
  end

  next false # Not root, doesn't contain search_text, has no children
end 
```

# java - Java异常处理成语...谁说得对，如何处理？

> ID：609293
> 
> 赞同：7
> 
> 时间：2009-03-04T05:00:26.130
> 
> 标签：java, exception

我目前与熟人有技术差异。简而言之，这就是这两种 Java 异常处理的基本风格之间的区别：

选项1（我的）：

```
try {
...
} catch (OneKindOfException) {
...
} catch (AnotherKind) {
...
} catch (AThirdKind) {
...
} 
```

选项 2（他的）：

```
try {
...
} catch (AppException e) {
    switch(e.getCode()) {
    case Constants.ONE_KIND:
    ...
    break;
    case Constants.ANOTHER_KIND:
    ...
    break;
    case Constants.A_THIRD_KIND:
    ...
    break;
    default:
    ...
    }
} 
```

他的论点——在我使用了大量关于用户输入验证、异常处理、断言和合同等的链接来支持我的观点之后——归结为：

“这是一个很好的模型。自从我和我的一个朋友在大约 10 年前的 1998 年提出它以来，我就一直在使用它。再看看，你会发现我们对学术论点做出的妥协让我受益匪浅有道理的。”

有没有人对为什么选项 1 是要走的路有一个击倒的论据？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-04T05:04:22.377

当你有一个 switch 语句时，你就不那么面向对象了。也有更多的错误机会，忘记一个“ `break;`”语句，忘记添加一个案例，`Exception`如果你添加一个新`Exception`的抛出。

我还发现你这样做的方式更具可读性，这是所有开发人员都会立即理解的标准习语。

根据我的口味，做你熟人的方法的样板数量，与实际处理异常无关的代码量是不可接受的。实际程序逻辑周围的样板代码越多，代码就越难阅读和维护。并且使用不常见的习语会使代码更难理解。

但是正如我上面所说的那样，交易破坏者是当您修改被调用的方法以使其抛出一个附加的`Exception`时，您将自动知道您必须修改您的代码，因为它将无法编译。但是，如果您使用熟人的方法并修改被调用的方法以抛出一个新的变体`AppException`，您的代码将不会知道这个新变体有什么不同，并且您的代码可能会因为不适当的错误处理腿而默默地失败。这是假设您实际上记得输入默认值，因此至少它已被处理并且不会被忽略。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-04T05:22:44.003

*   选项 2 的编码方式，任何*意外*的异常类型都会被吞掉！（这可以通过在默认情况下重新抛出来解决，但这可以说是一件丑陋的事情 - 更好/更有效地首先不抓住它）
*   选项 2 是选项 1 最可能在幕后所做的手动重建，即它忽略了语言的首选语法，以使用出于维护和可读性原因最好避免的旧结构。换句话说，选项 2 使用比语言结构提供的更丑陋的语法重新发明轮子。

显然，两种方式都有效；选项 2 只是被选项 1 支持的更现代的语法所淘汰

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-04T05:04:46.683

我不知道我是否有一个击倒的论点，但最初的想法是

*   选项 2 一直有效，直到您尝试捕获未实现 getCode() 的异常
*   选项 2 鼓励开发人员捕获一般异常，这是一个问题，因为如果您不为 AppException 的给定子类实现 case 语句，编译器将不会警告您。当然，您可能会遇到与选项 1 相同的问题，但至少选项 1 并没有积极鼓励这一点。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-04T05:05:22.640

使用选项 1，调用者可以选择准确选择要捕获的异常，并忽略所有其他异常。使用选项 2，调用者必须记住重新抛出任何未明确捕获的异常。

此外，选项 1 有更好的自文档，因为方法签名需要准确指定抛出哪些异常，而不是单个覆盖异常。

如果需要一个包罗万象的 AppException，其他异常类型总是可以继承自它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-04T05:30:40.257

击倒的论点是它破坏了封装，因为我现在必须了解有关 Exception 的公共接口的子类的一些信息，以便通过它处理异常。JDK 中这种“错误”的一个很好的例子是 java.sql.SQLException，它暴露了 getErrorCode 和 getSQLState 方法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-04T06:16:55.527

在我看来，无论哪种情况，您都在过度使用异常。作为一般规则，我尝试仅在以下**两个都**为真时抛出异常：

1.  发生了无法在此处处理的意外情况。
2.  有人会关心堆栈跟踪。

第三条路怎么走？您可以将 an`enum`用于错误类型，并将其作为方法类型的一部分简单地返回。为此，您可以使用，例如，[`Option<A>`](http://functionaljava.googlecode.com/svn/artifacts/2.17/javadoc/fj/data/Option.html)或[`Either<A, B>`](http://functionaljava.googlecode.com/svn/artifacts/2.17/javadoc/fj/data/Either.html)。

例如，您将拥有：

```
enum Error { ONE_ERROR, ANOTHER_ERROR, THIRD_ERROR }; 
```

而不是

```
public Foo mightError(Bar b) throws OneException 
```

你将会有

```
public Either<Error, Foo> mightError(Bar b) 
```

Throw/catch 有点像 goto/comefrom。容易滥用。请参阅[Go To 被认为有害的语句。](http://www.u.arizona.edu/~rubinson/copyright_violations/Go_To_Considered_Harmful.html)和[惰性错误处理](http://apocalisp.wordpress.com/2008/06/04/throwing-away-throws/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-04T06:23:21.347

我认为这取决于使用它的程度。我当然不会有任何事情都会抛出的“一个例外来统治他们所有人”。另一方面，*如果*有一整类情况几乎肯定会以相同的方式处理，但您可能需要区分它们以用于（例如）用户反馈目的，则选项 2*仅适用于这些例外情况*. 它们的范围应该非常狭窄——因此，只要抛出一个“代码”是有意义的，那么抛出所有其他“代码”也应该是有意义的。

对我来说，关键的测试是：“用一个代码捕获一个代码是否有意义`AppException`，但又想让另一个代码保持未被捕获？” 如果是这样，它们应该是不同的类型。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-04T07:00:37.713

每个已检查的异常都是一个，嗯，为定义程序行为而**必须**处理的异常条件。没有必要进入合同义务之类的，这是一个简单的意义问题。假设您向店主询问某件商品的价格，结果发现该商品不出售。现在，如果您坚持只接受非负数值作为答案，则永远无法为您提供正确的答案。这是检查异常的要点，您要求执行某些操作（可能会产生响应），如果您的请求无法以有意义的方式执行，您必须合理地计划。这是编写健壮代码的成本。

使用选项 2，您完全模糊了代码中*异常条件的含义。*您不应该将不同的错误条件合并到一个通用的 AppException 中，除非它们永远不需要以不同的方式处理。您正在分支的事实`getCode()`表明并非如此，因此对不同的异常使用不同的异常。

我可以看到选项 2 的唯一真正优点是使用相同的代码块干净地处理不同的异常。这篇[不错的博客文章](http://fishbowl.pastiche.org/2003/03/12/wanted_multiple_exceptiontype_catch_blocks/)讨论了 Java 的这个问题。尽管如此，这是一个风格与正确性的问题，正确性胜出。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-04T05:27:54.723

如果是，我会支持选项 2：

```
default:
  throw e; 
```

它的语法有点难看，但是为多个异常（即连续的情况）执行相同代码的能力要好得多。唯一让我烦恼的是在异常时产生一个唯一的 id，并且系统肯定可以改进。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-04T05:36:20.147

1.  不必要地知道代码并为使用选项 1 时可能是抽象的异常声明常量。

2.  当只有一个特定的异常要捕获时，第二个选项（我猜）将更改为传统的（作为选项 1），所以我看到那里不一致。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-04T06:26:00.153

两者都用。

代码中大多数异常的第一个。

第二个用于您创建的那些非常“特定”的异常。

不要为这样的小事而挣扎。

顺便说一句，第一个更好。

# opencv - How to interpolate between data points?

> ID：609297
> 
> 赞同：9
> 
> 时间：2009-03-04T05:01:54.770
> 
> 标签：opencv, signals, interpolation, signal-processing

I am currently developing a piece of software using opencv and qt that plots data points. I need to be able fill in an image from incomplete data. I want to interpolate between the points I have. Can anyone recommend a library or function that could help me. I thought maybe the opencv reMap method but I can't seem to get that to work.

The data is a 2-d matrix of intensity values. I want to create an image of some sort. Its a school project.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-31T15:05:01.117

Interpolation is a complex subject. There are infinitely many ways to interpolate a set of points, and this assuming that you truly do wish to do interpolation, and not smoothing of any sort. (An interpolant reproduces the original data points exactly.) And of course, the 2-d nature of this problem makes things more difficult.

There are several common schemes for interpolation of scattered data in 2-d. Actually, for those who have access to it, a very nice paper is available (Richard Franke, "Scattered data interpolation: Tests of some methods", Mathematics of Computation, 1982.)

Perhaps the most common method used is based on a triangulation of your data. Merely build a triangulation of the domain from your data points. Then any point inside the convex hull of the data must lie inside exactly one of the triangles, or it will be on a shared edge. This allows you to interpolate linearly inside the triangle. If you are using MATLAB, then the function griddata is available for this express purpose.)

The problem when trying to populate a complete rectangular image from scattered points is that very likely the data does not extend to the 4 corners of the array. In that event, a triangulation based scheme will fail, since the corners of the array do not lie inside the convex hull of the scattered points. An alternative then is to use "radial basis functions" (often abbreviated RBF). There are many such schemes to be found, including Kriging, when used by the geostatistics community.

[http://en.wikipedia.org/wiki/Kriging](http://en.wikipedia.org/wiki/Kriging)

Finally, inpainting is the name for a scheme of interpolation where elements are given in an array, but where there are missing elements. The name obviously refers to that done by an art conservator who needs to repair a tear or rip in a valuable piece of artwork.

[http://en.wikipedia.org/wiki/Inpainting](http://en.wikipedia.org/wiki/Inpainting)

The idea behind inpainting is typically to formulate a boundary value problem. That is, define a partial differential equation on the region where there is a hole. Using the known boundary values, fill in the hole by solving the PDE for the unknown elements. This can be computationally intensive if there are a huge number of unknown elements, since it typically requires the solution of at least a massive sparse system of linear equations. If the PDE is a nonlinear one, then it becomes a more intensive problem yet. A simple, reasonably good choice for the PDE is the Laplacian, which results in a linear system that extrapolates well. Again, I can offer a solution for a MATLAB user.

[http://www.mathworks.com/matlabcentral/fileexchange/4551](http://www.mathworks.com/matlabcentral/fileexchange/4551)

Better choices for the PDE may come from nonlinear PDEs. Once such is the Navier/Stokes equation. It is well suited to modeling the types of surfaces typically seen, but it is also more difficult to deal with. As in many facets of life, you get what you pay for.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-04T05:08:39.543

Phew! Big subject.

The "right" answer depends *a lot* on your problem domain and various details of what you're doing.

Interpolating in more than 1 dimension requires making some choices. I'll assume that you are plotting on a regular grid, but that some of your grid points have no data. Big question: are the missing points sparse, or do they make big blobs?

You *can't* add information, so you're just trying to establish something that will *look* OK.

Conceptually simple suggestion (but the implementation may be some work):

For each region on missing data, identify all the edge points. That is find the x's in this figure

```
oooxxooo
oox..xoo 
oox...xo
ox..xxoo
oox.xooo
oooxoooo 
```

where the .'s are the points missing data, and the x's and o's have data (for a single missing point, this will be the four nearest neighbors). Fill in each missing data point with an average over the edge points around this blob. To make it smooth, weight each point by `1/d` where d is the taxidriver distance (delta x + delta y) between the two points..

* * *

**From before we had any details:**

In the absence of that kind of information, have you tried straight ahead linear interpolation? If your data is reasonably dense this might do it for you, and it is simple enough to code in-line when you need it.

Next step is usually a cubic spline, but for that you'll probably want to grab an existing implementation.

* * *

When I need something more powerful than a quick linear interpolation, I usually use [ROOT](http://root.cern.ch/) (and pick one of the TSpline classes), but this may be more overhead than you need.

As noted in the comments, ROOT is *big*, and while it is fast, it does try to force you to do things the ROOT way, so it can have a big effect on your program.

* * *

A linear interpolation between (or indeed extrapolation from) two points (x1, y1) and (x2, y2) gives you

```
 y_i = (x_i-x1)*(y2-y1)/(x2-x1) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T22:25:37.500

Considering this is a simple school project, probably the easiest interpolation technique to implement is the "Nearest Neighbors"

For each missing data point you find the nearest "filled" data point and use that as the value.

If you want to improve the retults a little bit more, then you can lets say, find K nearest data points, and use their weighted average as the value of your missing data point.

the weight could be proportional to the distance of the point from the missing data point.

There are zillion other techniques, but nearest neighbor is probably the easiest to implement.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T03:59:48.617

if I understand that your need is as follows.

I think you have a subset of x,y,Intensity for a dimension of L by W and you want to fill for all X ranging from 0 to L and Y ranging from 0 to W.

If this is your question, then solution is to get other intensities by using Filters.

I think Bayer filter or Gaussian filter would do the job for you.

You can google these filters and you will get answers to implement.

Best of luck.

# javascript - 在 Eclipse 中调试 JavaScript

> ID：609316
> 
> 赞同：49
> 
> 时间：2009-03-04T05:13:54.867
> 
> 标签：javascript, eclipse, debugging, remote-debugging

如何在 Eclipse 中调试 JavaScript。我正在使用 Eclipse 3.2.1。每次我单击侧面时，它都会提供添加书签的选项，但没有断点。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-02T14:39:10.960

2015 年，Eclipse 中的 JavaScript 调试至少有六种选择：

*   自 Eclipse 3.7 以来的新功能：[JavaScript 开发工具调试支持](http://www.eclipse.org/webtools/jsdt/debug/)。孵化部分列出了[CrossFire](https://github.com/mrennie/crossfire/wiki)支持。这意味着，无需任何 Java 代码更改即可使用 Firefox + Firebug 作为页面查看器。
*   自 2012 年 10 月以来的新功能：[VJET JavaScript IDE](http://eclipse.org/vjet/)
*   [Ajax 工具框架](http://wiki.eclipse.org/ATF)
*   [Aptana](http://www.aptana.com/products/studio3.html)提供 JavaScript 调试功能。
*   商业[MyEclipse IDE](https://www.genuitec.com/products/myeclipse/?utm_source=stackoverflow&utm_medium=forum&utm_campaign=myeclipse)也有[JavaScript 调试支持](https://www.genuitec.com/products/myeclipse/learning-center/web/myeclipse-javascript-development-and-debugging-tutorial/?utm_source=stackoverflow&utm_medium=forum&utm_campaign=myeclipse)
*   来自与 MyEclipse 相同的稳定版，[Webclipse](https://www.genuitec.com/products/webclipse/?utm_source=stackoverflow&utm_medium=forum&utm_campaign=webclipse)插件具有相同的 JavaScript 调试技术。

除了以上内容，这里还有几个视频，重点是“使用 eclipse 调试 JavaScript”

*   [使用 Eclipse 和 Chrome 工具调试 JavaScript](http://www.youtube.com/watch?v=_uzSw_fb7NQ)
*   [使用 Eclipse 和 CrossFire（使用 FB）调试 JavaScript](http://www.youtube.com/watch?v=uvzqMmMDzUE)

# 过时的

*   适用于 Java的[Google Chrome 开发人员工具](http://code.google.com/p/chromedevtools/)允许使用 Chrome 进行调试。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-04T05:19:15.367

我不相信 Eclipse 有 JavaScript 调试器 - 这些断点是用于 Java 代码的（我猜你正在编辑 JSP 文件？）

使用[Firebug](http://getfirebug.com/)调试 Javascript 代码，它是一个优秀的插件，所有 Web 开发人员都应该在他们的工具箱中拥有它。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-04T06:05:32.417

我不是 100% 肯定，但我认为[Aptana](http://www.aptana.com)让你这样做。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-04-21T22:26:41.227

我试图让 aptana 在我的 ubuntu 10.4 上运行。不幸的是我没有成功。另一方面，Chrome 有一个 Eclipse 插件，可让您调试在 chrome 实例中运行的 javascript。效果很好。你必须安装你可以在这里找到的 eclipse 插件：

[http://code.google.com/p/chromedevtools/](http://code.google.com/p/chromedevtools/)

在您在 eclipse 中编辑的 javascript 源代码中设置断点并在 chrome 中浏览您的页面。一旦遇到 javascript 断点，eclipse 调试器就会停止并让您进入、跳过、浏览变量等。非常好！

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-06-19T15:28:30.253

Use the debugging tools supported by the browser. As mentioned above Firebug for Firefox Chrome Developer Tools from Chrome IE Developer for IE.

That way you can detect cross-browser issues. To help reduce the cross-browser issues, use a javascript framework ie jQuery, YUI, moo tools, etc.

Below is a screenshot (javascript-debug.png) of what it looks lime in Firebug.
1) hit 'F12'
2) click the 'Script' tab and 'enable it' (if you are already on your page - hit 'F5' to re-load)
3) next to the 'All' drop down, there will be another dropdown to the right. Select your javascript file from that dropdown.
In the screenshot, I've set a break-point at line 42 by 'left-mouse-click'. This will enable you to break, inspect, watch, etc.

![enter image description here](https://i.stack.imgur.com/9rt8Y.png)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-03-04T05:21:56.330

JavaScript 在浏览器中执行，这与 Eclipse 相去甚远。Eclipse 必须以某种方式连接到浏览器的 JavaScript 引擎才能对其进行调试。因此，没有通过 Eclipse 对 JavaScript 进行内置调试，因为无论如何 JS 并不是它的主要关注点。

但是，您可以安装一些插件来进行 JavaScript 调试。我相信主要的是[AJAX Toolkit Framework (ATF)](http://www.eclipse.org/atf/)。它在 Eclipse 中嵌入了一个 Mozilla 浏览器以进行调试，因此它无法处理编写 JavaScript 时通常出现的跨浏览器并发症，但它肯定会有所帮助。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-08-15T18:38:27.223

[可以通过使用AJAX 工具框架](http://wiki.eclipse.org/ATF)在 Eclipse 中设置断点来调试 JavaScript 。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-08-26T10:08:19.860

[MyEclipse](https://www.genuitec.com/products/myeclipse/?utm_source=stackoverflow&utm_medium=forum&utm_campaign=myeclipse)（基于 Eclipse，需要订阅）和[Webclipse](https://www.genuitec.com/products/webclipse/?utm_source=stackoverflow&utm_medium=forum&utm_campaign=webclipse)（一个 Eclipse 插件，目前免费），来自我的公司 Genuitec，新设计了（截至 2015 年）内置的[JavaScript 调试：](https://www.genuitec.com/products/myeclipse/learning-center/web/myeclipse-javascript-development-and-debugging-tutorial/?utm_source=stackoverflow&utm_medium=forum&utm_campaign=myeclipse)

[![在此处输入图像描述](https://i.stack.imgur.com/amUgs.png)](https://i.stack.imgur.com/amUgs.png)

您可以调试通用 Web 应用程序和 Node.js 文件。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-03-29T10:12:26.373

对于 Node.js，有[Nodeclipse 0.2 ，其中包含一些针对](http://github.com/nodeclipse/)[chromedevtools](http://code.google.com/p/chromedevtools/)的错误修复

# asp.net-mvc - 为 ASP.NET MVC 应用程序使用 .resx 本地化有哪些优势？

> ID：609324
> 
> 赞同：10
> 
> 时间：2009-03-04T05:19:19.173
> 
> 标签：asp.net-mvc, localization, resx

此站点上有许多与[如何](https://stackoverflow.com/questions/62995/access-global-resx-file-in-asp-net-view-page)在 ASP.NET MVC 应用程序中访问 RESX 文件以及使用它们的[最佳实践](https://stackoverflow.com/questions/381070/asp-net-mvc-localization-best-practice)相关的问题。

然而，在阅读了（我可能是第一次添加）[关于资源的 MSDN 文章后，](http://msdn.microsoft.com/en-us/library/ms227427.aspx#)我想知道使用 RESX 文件是否有任何优势，因为我不会使用服务器控件。有所有关于“隐式”和“显式”本地化的讨论，但我不会从 MVC 中受益。

最终，我的应用程序将需要用于按钮和菜单项的字符串资源，以及用于更长杂项内容的更长的 HTML 项。我想对较长的项目使用 CMS，因为我很确定我不想将它们粘贴到 RESX 文件中。

**是否有任何令人信服的理由在新**应用程序中使用或不使用 ASP.NET 资源。我将假设任何未来的 MVC 增强或 RESX 增强将协同工作，但就我所见，现在我只是得到一个美化的 IDictionary。

我应该继续使用 RESX 还是寻找其他地方？我是否应该考虑为 RESX 设计的资源类型使用 CMS？

任何经验教训将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-04T05:53:15.770

RESX 基础架构有几个优点：

*   您不必加载正确的每种语言资源。一旦建立了线程的语言环境，CLr 就会负责查找适当的程序集并加载资源。
*   很容易将特定于语言环境的资源移交给第三方进行本地化。
*   非本地化资源有一个默认的回退机制。

RESX 方法还有一个特别的缺点：

*   很难支持用户为您翻译资源的翻译模型。

我想详细说明最后一点。以 Facebook 翻译模型为例。Facebook 有相当简单的方法供人们提供各种资源的翻译并对其进行投票。如果这些存储在数据库中，则可以在适当的编辑过程之后使用它们，而无需重新构建和重新部署应用程序。使用 RESX 模型，必须重新构建和重新部署资源组件，这可能具有足够高的成本，具体取决于部署过程。

因此，在决定使用什么本地化过程之前，我会先决定谁将进行本地化，以及在主应用程序已经部署后本地化资源的部署过程是什么。

**编辑：**我忘了提到这些注意事项与 ASP.NET 框架选择（MVC 或 WebForms）是正交的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T05:25:24.433

我会说“是”，resx 文件仍然是新应用程序的不错选择。我不认为 ASP.NET MVC 特别改变了存储字符串的任何内容。

使用资源的好处是

*   他们很容易管理
*   本地化您的网站比没有资源要容易得多（而且我强调*要*容易得多）
*   您可以随时替换资源存储，因为资源使用提供者模型。您可以在不更改站点实现的情况下为 db 条目切换 resx 文件。

我推荐“站点字符串”的资源文件，这些文件不同于您可能经常编辑的大块数据。因此，对于完整的建议，我会说对按钮、标签等使用资源文件（resx 开始），对丰富的内容使用 CMS。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-04T13:27:08.520

如果您打算使用 Resx 而不是像在 MVC 中那样使用 Server Controls，为什么不扩展 MVC Helper 方法以便创建本地化标签和文本？然后只需在辅助方法中从资源中调用文本。

例如'<%=Html.CultureLabel("ResouceId") %>'

或 '<%=Html.CultureButton("Name","ResouceId", HtmlButtonType.Button) %>'

只是一个想法。

此外，使用 resx 文本更容易管理站点的全球化。

# php - 用于选择子项的 mySQL 查询

> ID：609328
> 
> 赞同：1
> 
> 时间：2009-03-04T05:21:49.043
> 
> 标签：php, mysql, database

我不确定这在 mySQL 中是否可行。这是我的桌子：-

分类表：

*   ID
*   姓名
*   parent_id（指向 Categories.id）

我使用上表来映射所有类别和子类别。

产品表：

*   ID
*   姓名
*   类别ID

Products 表中的 category_id 指向它所属的子类别 id。

例如，如果我有玩具 > 教育 > ABC，其中 ABC 是产品，玩具是类别，教育是子类别，那么 ABC 的 category_id 将为 2。

现在的问题是我想使用 SQL 查询来显示特定类别的所有产品（在所有子类别及其子类别中.. n 级别）。

例如：

```
select * from categories,products where  category.name = 'Toys' and .... 
```

上述查询还应显示来自教育和所有其他子类别及其子类别的产品。

这可以使用 mySQL 查询吗？如果不是，我有什么选择？我想避免 PHP 递归。

**更新：**基本上我想通过在产品表中添加命中列来显示主要类别中的前 10 种产品。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T06:40:33.363

我在以前的项目中需要做同样的事情，我添加了两个新列。

*   i_depth：类别深度的int值
*   nvc_breadcrumb：面包屑类型格式的类别的完整路径

然后我在包含类别信息的表中添加了一个触发器来执行以下操作（所有三个更新都在同一个触发器中）......

```
-- Reset all branches
UPDATE t_org_branches
    SET nvc_breadcrumb = NULL,
    i_depth = NULL

-- Update the root branches first
UPDATE t_org_branches 
    SET nvc_breadcrumb = '/', 
        i_depth = 0 
    WHERE guid_branch_parent_id IS NULL

-- Update the child branches on a loop
WHILE EXISTS (SELECT * FROM t_branches WHERE i_depth IS NULL) 
    UPDATE tobA 
        SET tobA.i_depth = tobB.i_depth + 1, 
            tobA.nvc_breadcrumb = tobB.nvc_breadcrumb + Ltrim(tobA.guid_branch_parent_id) + '/' 
        FROM t_org_branches AS tobA
            INNER JOIN t_org_branches AS tobB ON (tobA.guid_branch_parent_id = tobB.guid_branch_id) 
        WHERE tobB.i_depth >= 0 
            AND tobB.nvc_breadcrumb IS NOT NULL 
            AND tobA.i_depth IS NULL 
```

然后只需在类别 ID 上与您的产品表进行连接，然后执行“LIKE '%/[CATEGORYID]/%'”。请记住，这是在 MS SQL 中完成的，但它应该很容易转换为 MySQL 版本。

它可能足以兼容剪切和粘贴（在表和列名称更改后）。

* * *

展开说明...

t_categories （就目前而言）...

```
Cat Parent  CategoryName
1   NULL    MyStore
2   1       Electronics
3   1       Clothing
4   1       Books
5   2       Televisions
6   2       Stereos
7   5       Plasma
8   5       LCD 
```

t_categories（修改后）...

```
Cat  Parent  CategoryName   Depth   Breadcrumb
1   NULL    MyStore         NULL    NULL    
2   1       Electronics     NULL    NULL
3   1       Clothing        NULL    NULL
4   1       Books           NULL    NULL
5   2       Televisions     NULL    NULL
6   2       Stereos         NULL    NULL
7   5       Plasma          NULL    NULL
8   5       LCD             NULL    NULL 
```

t_categories （使用我给出的脚本后）

```
Cat  Parent  CategoryName   Depth   Breadcrumb
1   NULL    MyStore         0       /   
2   1       Electronics     1       /1/
3   1       Clothing        1       /1/
4   1       Books           1       /1/
5   2       Televisions     2       /1/2/
6   2       Stereos         2       /1/2/
7   5       LCD             3       /1/2/5/
8   7       Samsung         4       /1/2/5/7/ 
```

t_products （就像你现在拥有的那样，没有修改）......

```
ID   Cat Name
1   8   Samsung LNT5271F
2   7   LCD TV mount, up to 36"
3   7   LCD TV mount, up to 52"
4   5   HDMI Cable, 6ft 
```

加入类别和产品（其中类别为 C，产品为 P）

```
C.Cat Parent CategoryName   Depth   Breadcrumb  ID   p.Cat  Name
1    NULL   MyStore         0       /           NULL NULL   NULL
2    1      Electronics     1       /1/         NULL NULL   NULL
3    1      Clothing        1       /1/         NULL NULL   NULL
4    1      Books           1       /1/         NULL NULL   NULL
5    2      Televisions     2       /1/2/       4    5      HDMI Cable, 6ft
6    2      Stereos         2       /1/2/       NULL NULL   NULL
7    5      LCD             3       /1/2/5/     2    7      LCD TV mount, up to 36"
7    5      LCD             3       /1/2/5/     3    7      LCD TV mount, up to 52"
8    7      Samsung         4       /1/2/5/7/   1    8      Samsung LNT5271F 
```

现在假设 products 表更完整，因此每个类别中都有东西并且没有 NULL，您可以执行“Breadcrumb LIKE '%/5/%'”来获取我提供的最后一个表的最后三个项目。请注意，它包括该类别的直接项和子项（如三星电视）。如果您只想要特定类别的项目，只需执行“c.cat = 5”。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-04T09:58:08.380

我认为实现这一目标的最简洁方法是使用**嵌套集模型**。实现起来有点复杂，但使用起来很强大。MySQL 有一个名为[Managing Hierarchical Data in MySQL](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)的教程。[一位大 SQL 大师 Joe Celko在这里](http://www.ibase.ru/devinfo/DBMSTrees/sqltrees.html)写过同样的事情。如果您需要更多信息，请查看[Troel 的关于存储分层数据的链接](http://troels.arvin.dk/db/rdbms/links/#hierarchical)。

在我的情况下，我会远离使用 RDBMS 来存储这种数据，而是使用图形数据库，因为这种情况下的数据实际上是有向图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T05:45:05.773

向类别表中添加一个列，该列将包含每个组的完整的逗号分隔树。使用您的示例，教育子类别将其作为树“1,2”，其中 1 = 玩具，2 = 教育（它包括自身）。下一个嵌套级别的类别将继续添加到树中。

要获取组中的所有产品，请使用 MySQL 的 FIND_IN_SET 函数，如下所示

```
SELECT p.ID 
FROM Products p INNER JOIN Categories c ON p.category_ID = c.ID
WHERE FIND_IN_SET(your_category_id, c.tree) 
```

我不会对大表使用这种方法，因为我认为这个查询不能使用索引。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T06:26:23.943

一种方法是维护一个包含祖先与后代关系的表。您可以查询此特定表并获取所有受抚养人的列表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T22:32:30.080

假设 MySQL，很难避免 PHP 中的递归。

您的问题本质上是如何在 MySQL 中模仿 Oracle 的[CONNECT BY PRIOR](http://www.adp-gmbh.ch/ora/sql/connect_by.html)语法。[人们反复](http://bugs.mysql.com/bug.php?id=2341)问这个[问题](http://lists.mysql.com/mysql/214808) ，但它是一个从未进入 MySQL 的功能，并且通过存储过程实现可能不起作用，因为（现在）[存储函数不能是递归](http://dev.mysql.com/doc/refman/5.1/en/stored-routines-syntax.html)的。

当心迄今为止提供的数据库杂物。

迄今为止最好的信息是[来自 nawroth 的三个链接](https://stackoverflow.com/questions/609328/mysql-query-for-selecting-children/609924#609924)：

*   [在 MySQL 中管理分层数据](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)，包括[嵌套集模型](http://en.wikipedia.org/wiki/Nested_set_model)。
*   SQL 中的树 - Joel Celko 的[嵌套集模型](http://www.ibase.ru/devinfo/DBMSTrees/sqltrees.html)
*   Troels 的链接：关系数据库系统：[RDBMS 中的分层数据](http://troels.arvin.dk/db/rdbms/links/#hierarchical)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T05:26:43.430

表类别有多大？您可能需要在应用程序级别缓存它并构造适当的查询： ... where id in (2, 3, 6, 7)

此外，最好按 id 获取类别，这是它们的唯一 ID，索引和快速而不是按名称查找。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-04T06:19:09.750

请耐心等待，因为我从来没有做过这样的事情。

```
BEGIN
  SET cat = "5";
  SET temp = "";

  WHILE STRCMP(temp, cat) != 0 DO
    SET temp = cat;
    SET cat = SELECT CONCAT_WS(GROUP_CONCAT(id), cat) FROM Categories GROUP BY (parent_id) HAVING FIND_IN_SET(parent_id, cat);
  END LOOP;
END;

SELECT * FROM products WHERE FIND_IN_SET(category_id, cat) 
```

我几乎可以保证上述方法行不通，但是您可以看到我正在尝试做的事情。我已经走到这一步了，我只是决定不完成查询的结尾（从每个类别中选择前 N 个），对不起。:P

# c++ - 限制 C++ 函数允许的抛出有什么好处？

> ID：609332
> 
> 赞同：11
> 
> 时间：2009-03-04T05:25:16.913
> 
> 标签：c++, function, throw

从 C++ 函数声明可能的异常抛出有什么好处？换句话说，添加关键字`throw()`实际上做了什么？

我读过一个函数声明，例如`void do_something() throw();`应该保证没有异常来自`do_something()`函数；但是，这似乎不适用于调用 within 的函数`do_something()`，因此使其成为一个薄弱的保证。

请概述此语言功能的有用性（和最佳用例）。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-03-04T05:40:45.050

没有人比萨特更能解释这一点

[http://www.ddj.com/architect/184401544](http://www.ddj.com/architect/184401544)

简短的版本是

1.  永远不要编写异常规范
2.  除了可能是空的

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-04T05:35:51.210

C++ 标准要求，`unexpected()`如果函数试图抛出不在其异常列表中的异常，则调用该函数。MSDN 对此的简短描述如下：http: [//msdn.microsoft.com/en-us/library/awbt5tew (VS.80).aspx](http://msdn.microsoft.com/en-us/library/awbt5tew(VS.80).aspx)

大多数编译器实际上并不支持此 C++ 功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T05:38:00.113

```
void do_something() throw(); 
```

这是实现者方面的保证，该函数永远不会抛出异常。这就是该功能的客户所**期望**的。但是，这也意味着函数内部某处生成的任何异常都会得到处理，而不是重新抛出给`do_something()`. 从内部重新开始的人感到羞耻`throw`，因为没有什么能阻止他投掷。这是因为，从具有空异常规范的函数中抛出等效于抛出规范中未提及的异常并使其`std::unexpected()`成为预期的，然后是程序终止。

BTW：强异常保证的普遍接受的定义是：如果公共操作由于某种原因失败，则抛出异常，并且对象的状态保持不变（原子操作）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T05:33:17.877

基本上，通过与`throw();`你一起声明函数告诉编译器你*百分百确定*该函数**不会**抛出任何异常，从而允许编译器执行一些优化。如果您的函数无论如何都抛出异常，那么您就有麻烦了，因为它很可能会导致未定义的行为。

# sql - SQL Server 中的覆盖索引和覆盖查询是什么？

> ID：609343
> 
> 赞同：65
> 
> 时间：2009-03-04T05:37:13.623
> 
> 标签：sql, sql-server, indexing

你能解释一下微软 SQL Server 中覆盖索引和覆盖查询的概念以及它们之间的关系吗？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-03-04T05:39:09.300

覆盖索引是一种可以满足查询中所有请求的列而无需进一步查找聚集索引的索引。

没有覆盖查询之类的东西。

看看这篇 Simple-Talk 文章：[使用覆盖索引来提高查询性能](http://www.simple-talk.com/sql/learn-sql-server/using-covering-indexes-to-improve-query-performance/)。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-09-19T14:02:26.973

如果查询列表中请求的**所有列都****在索引中可用**，则查询引擎不必再次查找表，这可以显着提高查询的性能。由于索引中所有请求的列都可用，因此索引覆盖了查询。因此，查询称为覆盖查询，索引是覆盖索引。`select`

 **如果选择列表中的列来自同一个表，则聚集索引始终可以覆盖查询。

如果您不熟悉索引概念，以下链接可能会有所帮助：

*   [关于索引的优缺点以及涵盖查询和索引的优秀视频。](http://csharp-video-tutorials.blogspot.co.uk/2012/09/advantages-and-disadvantages-of-indexes.html)
*   [SQL Server 中的索引](http://csharp-video-tutorials.blogspot.com/2012/09/indexes-in-sql-server-part-35.html)

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2016-12-10T00:42:17.683

覆盖索引是一个`Non-Clustered`索引。聚集索引和非聚集索引都使用 B-Tree 数据结构来改进对数据的搜索，不同之处在于在聚集索引的叶子中，整条记录（即行）物理存储在那里！但这不是非聚集索引的情况。以下示例说明了这一点：

示例：我有一个包含三列的表：ID、Fname 和 Lname。

[![在此处输入图像描述](https://i.stack.imgur.com/TnLMf.png)](https://i.stack.imgur.com/TnLMf.png)

但是，对于非聚集索引，有两种可能性：表已经有聚集索引或者没有：

[![在此处输入图像描述](https://i.stack.imgur.com/ojZjo.png)](https://i.stack.imgur.com/ojZjo.png)

如两个图所示，此类非聚集索引不能提供良好的性能，因为它们无法仅从 B-Tree 中找到最喜欢的值（即 Lname）。相反，他们必须执行额外的查找步骤（Key 或 RID 查找）来查找 Lname 的值。而且，*这是覆盖索引出现在屏幕上的地方。*在这里，ID 上的非聚集索引覆盖了 B-Tree 叶子中紧邻它的 Lname 的值，不再需要任何类型的查找。

[![在此处输入图像描述](https://i.stack.imgur.com/rSDOI.png)](https://i.stack.imgur.com/rSDOI.png)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-03-04T05:52:21.373

**覆盖查询**是一种查询，其中查询结果集中的所有列都是从非聚集索引中提取的。

通过索引的明智安排，一个查询变成了一个覆盖查询。

覆盖查询通常比非覆盖查询性能更高，部分原因是非聚集索引每页的行数比聚集索引或堆索引多，因此需要将更少的页面放入内存以满足查询。它们每页有更多行，因为只有部分表行是索引行的一部分。

**覆盖索引**是在覆盖查询中使用的索引。没有索引本身就是覆盖索引这样的东西。索引可以是关于查询 A 的覆盖索引，同时不是关于查询 B 的覆盖索引。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-03-04T05:57:49.427

这是[devx.com 上的一篇文章，内容如下](http://www.devx.com/dbzone/Article/29530)：

> 创建包含 SQL 查询中使用的所有列的非聚集索引，这种技术称为**索引覆盖**

我只能假设一个**被覆盖的查询**是一个查询，它的索引覆盖了它返回的记录集中的所有列。一个警告 - 必须构建索引和查询以允许 SQL 服务器从查询中实际推断出索引是有用的。

例如，表自身的连接可能不会从这样的索引中受益（取决于 SQL 查询执行计划器的智能）：

```
PersonID ParentID Name
1        NULL     Abe
2        NULL     Bob
3        1        Carl
4        2        Dave 
```

让我们假设有一个索引`PersonID,ParentID,Name`- 这将是一个查询的覆盖索引，例如：

```
SELECT PersonID, ParentID, Name FROM MyTable 
```

但是这样的查询：

```
SELECT PersonID, Name FROM MyTable LEFT JOIN MyTable T ON T.PersonID=MyTable.ParentID 
```

即使所有列都在索引中，也可能不会有太多好处。为什么？因为您并没有真正告诉它您要使用`PersonID,ParentID,Name`.

相反，您正在构建一个基于两列的条件 - `PersonID`and `ParentID`（省略`Name`），然后您要求所有记录，以及 columns `PersonID, Name`。实际上，根据实施情况，索引可能会对后半部分有所帮助。但是对于第一部分，您最好使用其他索引。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-04T05:43:34.717

覆盖查询是关于可以使用基础表上的索引匹配所有谓词的位置。

这是提高正在考虑的 sql 性能的第一步。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-03-06T06:43:50.663

覆盖索引是提供每个所需列的索引，其中 SQL 服务器没有跳回聚集索引来查找任何列。这是通过使用非聚集索引和使用 INCLUDE 选项来覆盖列来实现的。非键列只能包含在非聚集索引中。不能在键列和 INCLUDE 列表中定义列。INCLUDE 列表中的列名不能重复。只有先删除非键索引后，才能从表中删除非键列。[请在此处查看详细信息](http://blog.sqlauthority.com/2007/04/23/sql-server-understanding-new-index-type-of-sql-server-2005-included-column-index-along-with-clustered-index-and-non-clustered-index/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-12-10T00:37:29.833

当我简单地回忆起聚集索引由已定义表中所有列的键排序非堆列表组成时，我的灯亮了。那么，“簇”这个词指的是所有列都有一个“簇”，就像那个“热点”中的一簇鱼一样。如果没有索引覆盖包含搜索值的列（等式的右侧），则执行计划使用聚簇索引搜索请求列的聚簇索引表示，因为它在任何其他列中都找不到请求的列“覆盖”指数。缺失将导致建议的执行计划中出现聚集索引查找运算符，其中查找的值在聚集索引表示的有序列表内的列内。

因此，一种解决方案是创建一个非聚集索引，该索引的列包含索引内的请求值。这样，就不需要引用聚集索引，优化器应该能够在执行计划中挂钩该索引而无需任何提示。但是，如果有一个 Predicate 命名单列集群键和一个参数到集群键上的标量值，则仍然使用集群索引查找运算符，即使在第二列上已经存在覆盖索引。没有索引的表。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-12-20T02:19:10.480

第 178 页，高性能 MySQL，第 3 版

> 包含（或“覆盖”）满足查询所需的所有数据的索引称为覆盖索引。
> 
> 当你发出一个被索引覆盖的查询（一个被索引覆盖的查询）时，你会在 EXPLAIN 的 Extra 列中看到“Using Index”。

# objective-c - 如何制作类似（播放列表、库）左侧（可折叠）导航栏的 iTunes？

> ID：609347
> 
> 赞同：5
> 
> 时间：2009-03-04T05:39:32.497
> 
> 标签：objective-c, cocoa, macos

我说的是 iTunes 左侧用于库和播放列表的导航区域。我想知道这是一个内置类（我找不到文档）还是Apple自定义实现的东西。

我正在使用一个 Mac 应用程序，我想在其中包含这种类型的导航。我想让人们通过使用三角形“折叠”类别。我是否需要为此编写自定义实现，或者我可以在 Interface Builder 或一些开源库中使用一些控件？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-04T05:55:58.820

该栏称为*源列表*。在 10.5 中，您可以为此使用 an ，如此[处](http://chanson.livejournal.com/176310.html)`NSTableView`所述。在 10.5 之前，您将不得不求助于第三方实现。

另请参阅：[“如何在 Cocoa/IB 中实现类似于 Mail/iTunes/Finder/etc 的侧边栏？”](https://stackoverflow.com/questions/241507/how-would-one-implement-a-sidebar-similar-to-mail-itunes-finder-etc-in-cocoa-ib)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T08:37:47.450

您也可以使用`NSOutlineView`，如[本例所示](http://developer.apple.com/samplecode/SourceView/index.html)

# c++ - 用 C++ 读取文件名

> ID：609349
> 
> 赞同：-2
> 
> 时间：2009-03-04T05:40:39.437
> 
> 标签：c++, file-io

有没有办法使用纯 C（或 C++）从文件夹中读取文件名？这意味着不包括 windows.h（没有 FindFirstFile() 等......）。

看起来 fstream 没有这个功能。我知道文件名取决于操作系统，但我希望有一些库可以在 Windows 中使用它。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-04T05:42:19.183

[boost 文件系统](http://www.boost.org/doc/libs/1_38_0/libs/filesystem/doc/index.htm)是一个不错的解决方案。当然，在幕后，它仍将使用 Windows API 调用（当您在 Windows 上构建时），但这是从您那里抽象出来的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T05:42:29.197

C++ 通常不为您提供此类功能。一个跨平台的解决方案是使用[`boost::filesystem`](http://www.boost.org/doc/libs/1_38_0/libs/filesystem/doc/index.htm).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T05:48:44.847

尝试使用 POSIX 函数 opendir() 和 readdir() 来遍历目录。请参阅[此链接](http://www.opengroup.org/onlinepubs/009695399/functions/opendir.html)以获取包含一些出色示例代码的手册页。这些功能应该在大多数平台上都可用，包括 Windows 和 UNIX。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T05:57:04.530

如果你想在 windows 上使用 opendir() 和 readdir()，你可以下载 MinGW，一个著名的 GNU 编译器集合的 windows 端口。它包括 UNIX 头文件的 windows 端口，包括 dirent.h，它将允许您使用指定的功能。请记住，无论哪种方式，这些都将调用本机 API。

-约翰

# java - 在休眠统计中，加载和获取之间有什么区别

> ID：609351
> 
> 赞同：11
> 
> 时间：2009-03-04T05:40:54.443
> 
> 标签：java, performance, hibernate

我主要看 EntityStatics ( [http://www.hibernate.org/hib_docs/v3/api/org/hibernate/stat/EntityStatistics.html](http://www.hibernate.org/hib_docs/v3/api/org/hibernate/stat/EntityStatistics.html) )。我可以看到很多获取、加载和更新，但我找不到任何说明它们之间有什么区别的地方。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-04T06:25:45.507

通过代码向后工作，获取计数器仅在从数据源检索实体时才会增加（与任何缓存相反） -

```
 protected Object loadFromDatasource(
        final LoadEvent event,
        final EntityPersister persister,
        final EntityKey keyToLoad,
        final LoadEventListener.LoadType options) {
    final SessionImplementor source = event.getSession();
    Object entity = persister.load(
            event.getEntityId(),
            event.getInstanceToLoad(),
            event.getLockMode(),
            source
    );

    if ( event.isAssociationFetch() && source.getFactory().getStatistics().isStatisticsEnabled() ) {
        source.getFactory().getStatisticsImplementor().fetchEntity( event.getEntityClassName() );
    }

    return entity;
} 
```

加载计数器从太多地方调用以跟踪它们，但看起来它在实体加载时会增加，无论是从数据源还是缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-07-20T10:17:07.213

[https://vladmihalcea.com/hibernate-statistics/](https://vladmihalcea.com/hibernate-statistics/) 本文包含 fetch 和 load 计数之间的明确区别：

> long getEntityLoadCount() 它为您提供当前 EntityManagerFactory 或 SessionFactory 加载的实体总数（包括从一级或二级缓存或数据库中获取的实体）。long getEntityFetchCount() 它为您提供当前 EntityManagerFactory 或 SessionFactory 从数据库中获取的实体总数。

# multicore - 纯函数可以读取全局状态吗？

> ID：609352
> 
> 赞同：3
> 
> 时间：2009-03-04T05:41:12.290
> 
> 标签：multicore, global-state

请注意：通过“纯”功能，我不是指“纯虚拟”
，我指的是[这个](http://en.wikipedia.org/wiki/Pure_function)

如果一个函数“读取”了一些全局状态，这会自动使它变得不纯吗？还是取决于其他因素？

如果它自动使其不纯，请解释原因。

如果它取决于其他因素，请解释它们是什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-04T05:44:13.997

“纯”函数是其结果*仅*取决于其输入参数的函数。如果它读取任何其他内容，则它不是纯函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T05:56:35.887

在某些特殊情况下，是的。例如，如果您有一个仅由您的函数读取和写入的已计算值的全局缓存，那么它在数学上仍然是纯的，因为输出仅取决于输入，但它不会是纯的在最严格的意义上。例如：

```
static int cache[256] = {0};
int compute_something(uint8_t input)
{
    if(cache[input] == 0)
        cache[input] = (perform expensive computation on input that won't return 0);
    return cache[input];
} 
```

在这种情况下，只要没有其他函数接触 global `cache`，它仍然是数学上的纯函数，即使它在技术上依赖于外部全局状态。然而，这种状态只是一种性能优化——没有它它仍然会执行相同的计算，只是速度更慢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T05:48:21.803

> 纯函数是构造纯表达式所必需的。常量表达式在定义上是纯粹的。

所以，如果你的全局“状态”没有改变，你就可以了。

另请参阅[参考透明度](http://en.wikipedia.org/wiki/Referential_transparency_(computer_science))：

> 一个更微妙的例子是使用全局变量（或动态范围变量，或词法闭包）来帮助计算结果的函数。由于此变量不作为参数传递但可以更改，因此即使参数相同，后续调用该函数的结果也可能不同。（在纯函数式编程中，不允许破坏性赋值；因此使用全局（或动态范围）变量的函数仍然是引用透明的，因为这些变量不能更改。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T06:55:06.993

例如，在 Haskell 中，您可以在不纯的一侧创建一个无限的随机数列表，并将该列表传递给您的纯函数。该实现将生成纯函数仅在需要时使用的下一个数字，但该函数仍然是纯函数。

# jquery - jQuery自动完成插件不关注下一个点击的字段

> ID：609362
> 
> 赞同：1
> 
> 时间：2009-03-04T05:45:36.350
> 
> 标签：jquery, jquery-plugins, autocomplete

我正在使用[Jörn Zaefferer 的 jQuery 自动完成插件](http://bassistance.de/jquery-plugins/jquery-plugin-autocomplete/)，它工作得很好，除了一个小错误：如果用户开始输入自动完成附加到的一个字段，但是当建议仍然显示他们点击另一个输入字段时，光标返回到具有自动完成功能的字段。

是否有任何解决方案，或者它几乎是有效的方式？我注意到 jQuery UI 自动完成[功能也是如此](http://view.jquery.com/trunk/plugins/autocomplete/demo/)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T05:51:57.303

我很乐意为您查看代码，取消注释此行：

```
// TODO provide option to avoid setting focus again after selection? useful for cleanup-on-focus
input.focus(); 
```

`jquery.autocomplete.js`在行`583`。_

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T15:55:45.433

修复方法是：

注释掉解压版本的第 308-310 行：

```
//if (wasVisible)
    // position cursor at end of input field
    //$.Autocompleter.Selection(input, input.value.length, input.value.length); 
```

在 Luca 的帖子中，注释掉第 510 行：

```
//input.focus(); 
```

这两个都需要注释掉以使其正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-10-13T09:30:37.247

如果用户使用 Enter 键或 TAB 键呢？那么如何阻止插件在输入字段中设置焦点？您也可以使用它，还是仅当用户使用鼠标从下拉列表中进行选择时？

# c - 使用 xml 解析器 expat 获取 xml 数据

> ID：609376
> 
> 赞同：6
> 
> 时间：2009-03-04T05:54:45.533
> 
> 标签：c, xml-parsing, expat-parser

我已经成功解析。但是现在我无法获得所需的值。我可以得到元素和属性。但无法获取值。我想在这个 xml 中获取 frame 的值，它是 20。

```
/* track the current level in the xml tree */
static int depth = 0;
/* first when start element is encountered */
void start_element(void *data, const char *element, const char **attribute)
{
int i;

for(i = 0; i < depth; i++)
{
    printf(" ");
}

printf("%s", element);

for(i = 0; attribute[i]; i += 2)
{
    printf(" %s= '%s'", attribute[i], attribute[i + 1]);
}

printf("\n");
depth++;
}

/* decrement the current level of the tree */
void end_element(void *data, const char *el)
{
depth--;
}
int parse_xml(char *buff, size_t buff_size)
{
    FILE *fp;
    fp = fopen("start_indication.xml", "r");
    if(fp == NULL)
    {
    printf("Failed to open file\n");
    return 1;
    }

    XML_Parser parser = XML_ParserCreate(NULL);
    int done;
    XML_SetElementHandler(parser, start_element, end_element);

    memset(buff, 0, buff_size);
    printf("strlen(buff) before parsing: %d\n", strlen(buff));

    size_t file_size = 0;
    file_size = fread(buff, sizeof(char), buff_size, fp);

    /* parse the xml */
    if(XML_Parse(parser, buff, strlen(buff), XML_TRUE) == XML_STATUS_ERROR)
    {
        printf("Error: %s\n", XML_ErrorString(XML_GetErrorCode(parser)));
    }

    fclose(fp);
    XML_ParserFree(parser);

    return 0;
}

<data>
    <header length="4">
            <item name="time" type="time">16</item>
            <item name="ref" type="string">3843747</item>
            <item name="port" type="int16">0</item>
            <item name="frame" type="int16">20</item>
    </header>
</data>

Output from parsing

Element: data
Element: header length= '4'
Element: item name= 'time' type= 'time'
Element: item name= 'ref' type= 'string'
Element: item name= 'port' type= 'int16'
Element: item name= 'frame' type= 'int16' 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-04T08:44:00.523

外籍人士是相当困难的。当您只对结构而不是元素的内容感兴趣时， expat 会更好。为什么不使用[libxml](http://xmlsoft.org/)呢？您使用像 expat 这样的基于偶数的解析器而不是基于树的解析器的原因是什么？

无论如何，这样做的方法是设置一个字符数据处理程序。这是一个示例，基于您的代码：

```
#include <expat.h>
#include <stdio.h>
#include <string.h>

#define BUFFER_SIZE 100000

/* track the current level in the xml tree */
static int      depth = 0;

static char    *last_content;

/* first when start element is encountered */
void
start_element(void *data, const char *element, const char **attribute)
{
    int             i;

    for (i = 0; i < depth; i++) {
        printf(" ");
    }

    printf("%s", element);

    for (i = 0; attribute[i]; i += 2) {
        printf(" %s= '%s'", attribute[i], attribute[i + 1]);
    }

    printf("\n");
    depth++;
}

/* decrement the current level of the tree */
void
end_element(void *data, const char *el)
{
    int             i;
    for (i = 0; i < depth; i++) {
        printf(" ");
    }
    printf("Content of element %s was \"%s\"\n", el, last_content);
    depth--;
}

void
handle_data(void *data, const char *content, int length)
{
    char           *tmp = malloc(length);
    strncpy(tmp, content, length);
    tmp[length] = '\0';
    data = (void *) tmp;
    last_content = tmp;         /* TODO: concatenate the text nodes? */
}

int
parse_xml(char *buff, size_t buff_size)
{
    FILE           *fp;
    fp = fopen("start_indication.xml", "r");
    if (fp == NULL) {
        printf("Failed to open file\n");
        return 1;
    }

    XML_Parser      parser = XML_ParserCreate(NULL);
    XML_SetElementHandler(parser, start_element, end_element);
    XML_SetCharacterDataHandler(parser, handle_data);

    memset(buff, 0, buff_size);
    printf("strlen(buff) before parsing: %d\n", strlen(buff));

    size_t          file_size = 0;
    file_size = fread(buff, sizeof(char), buff_size, fp);

    /* parse the xml */
    if (XML_Parse(parser, buff, strlen(buff), XML_TRUE) == XML_STATUS_ERROR) {
        printf("Error: %s\n", XML_ErrorString(XML_GetErrorCode(parser)));
    }

    fclose(fp);
    XML_ParserFree(parser);

    return 0;
}

int
main(int argc, char **argv)
{
    int             result;
    char            buffer[BUFFER_SIZE];
    result = parse_xml(buffer, BUFFER_SIZE);
    printf("Result is %i\n", result);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-04T08:49:10.793

'value' 20 是标记名为“item”且名称属性为“frame”的元素中的字符数据“20”。

[`XML_SetCharacterDataHandler`](http://www.xml.com/pub/a/1999/09/expat/index.html?page=3#chardatahandler)要接收字符数据事件，请使用该函数注册回调。

此回调将接收字符数据。解析器可能会拆分字符数据 - 通常用于处理到达缓冲区的末尾或实体（因此`foo&amp;bar`您的处理程序将获得三个调用 - “foo”、“&”和“bar”），因此您必须粘贴字符串如果您需要全部数据，请再次组合在一起。

当您收到下一个元素启动或关闭回调时，您就知道节点内的所有字符数据何时完成。

当您拥有所有字符数据时，您可以对其进行处理。

从您的代码简化的独立示例：

```
#include <expat.h>
#include <stdio.h>
#include <stdbool.h>
#include <string.h>

static const char* xml =
    "<data>\n"\
    "    <header length=\"4\">\n"\
    "            <item name=\"time\" type=\"time\">16</item>\n"\
    "            <item name=\"ref\" type=\"string\">3843747</item>\n"\
    "            <item name=\"port\" type=\"int16\">0</item>\n"\
    "            <item name=\"frame\" type=\"int16\">20</item>\n"\
    "    </header>\n"\
    "</data>\n";

void reset_char_data_buffer ();
void process_char_data_buffer ();
static bool grab_next_value;

void start_element(void *data, const char *element, const char **attribute) {
    process_char_data_buffer();
    reset_char_data_buffer();

    if ( strcmp("item", element) == 0 ) {
        size_t matched = 0;

        for (size_t i = 0; attribute[i]; i += 2) {
            if ( ( strcmp("name", attribute[i]) == 0 ) && ( strcmp("frame", attribute[i+1]) == 0 ) )
                ++matched;

            if ( ( strcmp("type", attribute[i]) == 0 ) && ( strcmp("int16", attribute[i+1]) == 0 ) )
                ++matched;
        }

        if (matched == 2) {
            printf("this is the element you are looking for\n");
            grab_next_value = true;
        }
    }
}

void end_element(void *data, const char *el) {
    process_char_data_buffer();
    reset_char_data_buffer();
}

static char char_data_buffer[1024];
static size_t offs;
static bool overflow;

void reset_char_data_buffer (void) {
    offs = 0;
    overflow = false;
    grab_next_value = false;
}

// pastes parts of the node together
void char_data (void *userData, const XML_Char *s, int len) {
    if (!overflow) {
        if (len + offs >= sizeof(char_data_buffer) ) {
            overflow = true;
        } else {
            memcpy(char_data_buffer + offs, s, len);
            offs += len;
        }
    }
}

// if the element is the one we're after, convert the character data to
// an integer value
void process_char_data_buffer (void) {
    if (offs > 0) {
        char_data_buffer[ offs ] = '\0';

        printf("character data: %s\n", char_data_buffer);

        if ( grab_next_value ) {
            int value = atoi( char_data_buffer );

            printf("the value is %d\n", value);
        }
    }
}

int main (void ) {
    XML_Parser parser = XML_ParserCreate(NULL);

    XML_SetElementHandler(parser, start_element, end_element);
    XML_SetCharacterDataHandler(parser, char_data);

    reset_char_data_buffer();

    if (XML_Parse(parser, xml, strlen(xml), XML_TRUE) == XML_STATUS_ERROR)
        printf("Error: %s\n", XML_ErrorString(XML_GetErrorCode(parser)));

    XML_ParserFree(parser);

    return 0;
} 
```

# wpf - 如何将 System.ServiceProcess 命名空间导入 WPF 项目？未在 CodeSense 中显示

> ID：609378
> 
> 赞同：5
> 
> 时间：2009-03-04T05:55:11.443
> 
> 标签：wpf, vb.net, import

如何将`System.ServiceProcess`命名空间导入 VB.NET（不是 C#）中的 WPF 项目？该`ServiceController`对象不在 VS2008 的工具箱中，我似乎无法弄清楚。有任何想法吗？如果该特定命名空间无法导入 WPF 项目，有人可以建议另一种从 WPF 应用程序控制 Windows 服务的方法吗？我知道这个框架更侧重于多媒体应用程序，但我真的很想将我的一些工具切换到 WPF。

提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-04T06:57:47.393

您需要添加对`System.ServiceProcess.dll`.

令人困惑的是，这个程序集不在`C:\Program Files\Reference Assemblies\Microsoft\Framework`. 它应该在 GAC 中；但是，它可能不会显示在程序集列表中。您可以`C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727`从那里浏览并引用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T06:01:56.950

我假设您的意思是要添加项目引用，而不是专门将其添加到 XAML 文件中。

您将需要添加对适当 DLL 的引用，但如果您没有针对正确的框架版本，它可能对您隐藏——确保您的项目属性表明您的目标是 3.5。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-12-25T23:30:01.267

就我而言，我使用了 VS2017，我`System.ServiceProcess`在 NuGet 管理器中进行了搜索（工具 -> NuGet 包管理器 -> 管理 NuGet 包以获取解决方案...）

为所需的项目安装它，就是这样。

[![在此处输入图像描述](https://i.stack.imgur.com/Xvb8R.png)](https://i.stack.imgur.com/Xvb8R.png)

# gis - 如何将坐标转换为纬度和经度？

> ID：609379
> 
> 赞同：7
> 
> 时间：2009-03-04T05:55:19.477
> 
> 标签：gis, latitude-longitude

我正在对运输可视化应用程序进行逆向工程。我需要找出他们数据源的纬度。具体来说 XY 0,0 是什么。我发现的唯一公式计算两点之间的距离，或方位/距离的位置。

他们使用 XY 在非常旧的应用程序中显示地图。XY 以英尺为单位。

我有这些坐标：

```
47.70446615506108, -122.34469839507263: x=1268314, y=260622
47.774182540800616,-122.3412994737105:  x=1269649, y=286031
47.60024792289405, -122.32767331735774: x=1271767, y=222532
47.57012494413499, -122.29129609983679: x=1280532, y=211374 
```

我需要找出纬度和经度`x=0, y=0`是什么以及找出这个的公式是什么。

他们有两个数据源，一个比另一个更新。具有最新数据的提要不包括纬度、经度，而仅包括 XY。我试图根据他们当前较少但信息更丰富（包括纬度、经度）的数据馈送来推断 0,0 是什么，因此我可以简单地将他们（更多当前）数据馈送的 XY 坐标转换为纬度和经度。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-04T07:24:59.233

如果您查看前 2 行数据，然后减去纬度

```
47.7044 - 47.7741 = -0.06972 degrees 
```

每纬度有60海里，每海里有6076英尺。

```
-.06972 * 60 * 6076 = 25,415 ft 
```

减去两个“Y”值：

```
260662 - 286031 = 25,409 ft 
```

所以确实这似乎证明了 X 和 Y 值以英尺为单位。

例如，如果您采用任何 Y 值并将其转换回度数

```
260622 ft / ( 6076 ft/nm ) / ( 60 nm/degree ) = .71
286031 ft / 6076 / 60 = .78 
```

因此，从（47.70 和 47.77）的纬度中减去这些值会使您非常接近 47 度，这应该是您的 y=0 点。

对于经度，赤道为 60 海里，两极为 0 海里。所以每度的英里数必须乘以纬度的余弦，所以大约是 cos(47 度)，或 0.68。因此，不是每度 6076 nm，而是大约 4145 nm。

所以对于 X 值，

```
1268314 ft / ( 4145 ft/nm ) / ( 60 nm/degree ) = 5.10 degrees
1269649 ft / 4145 / 60 = 5.10 degrees 
```

这些X数随着纬度的增加而增加（负数较小），所以我相信你应该增加5.1度，这意味着X基点大约是

```
-122.3 + 5.1 = 117.2 West longitude for your x=0 point. 
```

这大致是斯波坎WA的位置。

所以给定 X=1280532, Y=211374

```
Lat = 47 + ( 211374 / 6096 / 60 ) = 47.58
Lon = -117.2 - ( 1280532 / ( 6096 * cos(47.58)) / 60 ) = -122.35 
```

大致相当于给定数据 47.57 和 -122.29

差异可能是由于不同的投影 - X，Y 系统可能是“扁平”投影，而不是适用于球形投影的纬度/经度？因此，准确地说，您可能还需要更高级的数学或开源库:)

这个问题也可能有帮助，它包含计算大圆距离的代码：

[计算两个经纬度点之间的距离？（Haversine 公式）](https://stackoverflow.com/questions/27928/how-do-i-calculate-distance-between-two-latitude-longitude-points/215849#215849)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-04T06:23:38.083

有许多不同的坐标系。您需要找出纬度/经度（例如 WGS84 等）和 x/y 的坐标系（例如，可能是某种投影系统）的坐标系。

获得这些信息后，您可以使用多种工具进行转换和操作。[proj4](http://trac.osgeo.org/proj/)是一个（免费开源编码库的）示例。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-04T14:02:22.567

问他们他们使用的是什么坐标系！（或者如果您从某个数据库中获取数据集，请查看数据集的元数据，它应该会告诉您。否则我会怀疑它的价值）

这很可能是[状态平面坐标系](http://en.wikipedia.org/wiki/State_Plane_Coordinate_System)之一。它们用于地球的局部区域（有点像[UTM](http://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system)），并且经常用于测量。

您可以使用[CORPSCON](http://crunch.tec.army.mil/software/corpscon/corpscon.html)（或其他 GIS 程序；如果您有 GIS 选项包， [ExpertGPS](http://www.expertgps.com/)将执行此操作，但它不是免费的。我忘记[GPSBabel](http://www.gpsbabel.org/)是否进行转换）在纬度/经度和任何国家平面坐标系之间进行转换。您还需要知道坐标所在的[基准面](http://en.wikipedia.org/wiki/Datum_(geodesy))。WGS84 和 NAD83 非常接近，但 NAD27 不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-25T04:58:25.333

您已经对坐标系提出了很好的建议，所以我将附上我过去使用过的图书馆并取得了巨大的成功。

Geotrans 经美国国防部批准使用，因此您可以确定它经过了良好的测试。你可以从这里获取它：

```
http://earth-info.nga.mil/GandG/geotrans/index.html 
```

这可能不是正确的链接，因为该页面讨论的是应用程序，而不是库。我希望该库位于 Developers 包中。许可条款在记忆中非常宽松，但请确保在将其用于商业用途之前查看条款。

编辑：

可以在此处找到有关 Geotrans 许可的有趣讨论：

```
http://www.mail-archive.com/debian-legal@lists.debian.org/msg39263.html 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-15T20:41:40.417

[在这里，我是这样说的：](https://stackoverflow.com/questions/753560/how-to-convert-utm-coordinates-to-latitude-and-longitude/753609#753609)

在 Java 中，我会使用[OpenMap 转换器](http://openmap.bbn.com/doc/api/com/bbn/openmap/proj/coords/UTMPoint.html#toLatLonPoint())将 UTM 中的点表达式转换为使用纬度和经度的表达式（假设 GPS 中最常用的 WGS-84 椭球）。

OpenMap 是开源的，我会发布一个指向他们下载页面的链接，但他们有一个简短的许可证脚本。因此，为避免粗鲁，我不会进行深层链接。相反，前往[他们的主页](http://openmap.bbn.com/)并[点击下载](http://openmap.bbn.com/cgi-bin/license.cgi)。

那应该直接解决您的问题，或者至少将您指向一个有用的算法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-15T20:47:53.600

我曾多次使用 Brenor Brophey 的[gPoint PHP 类](http://www.phpclasses.org/browse/package/2542.htm)来执行此操作。可靠的结果，GPL 代码，并且易于部署。受到推崇的。

# jquery - jQuery 选择器：ID 以？

> ID：609382
> 
> 赞同：418
> 
> 时间：2009-03-04T05:56:22.143
> 
> 标签：jquery, jquery-selectors

是否`selector`可以查询 ID 以给定字符串结尾的元素？

假设我有一个 id 的元素`ctl00$ContentBody$txtTitle`。我怎样才能通过只是得到这个`txtTitle`？

* * *

## 回答 #1

> 赞同：663
> 
> 时间：2009-03-04T06:06:42.337

如果您知道元素类型，那么：（例如：将 'element' 替换为 'div'）

```
$("element[id$='txtTitle']") 
```

如果您不知道元素类型：

```
$("[id$='txtTitle']") 
```

[提供更多信息](http://docs.jquery.com/Selectors/attributeEndsWith#attributevalue)

* * *

```
// the old way, needs exact ID: document.getElementById("hi").value = "kk";
$(function() {
  $("[id$='txtTitle']").val("zz");
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<input id="ctl_blabla_txtTitle" type="text" />
```

* * *

## 回答 #2

> 赞同：260
> 
> 时间：2011-05-03T07:15:24.197

问题的答案是`$("[id$='txtTitle']")`，[正如 Mark Hurd 回答](https://stackoverflow.com/a/609399/615882)的那样，但是对于像我一样想要找到所有 id**以给定字符串开头**的元素（例如 txtTitle）的人，试试这个（[doc](http://api.jquery.com/attribute-starts-with-selector/)）：

```
$("[id^='txtTitle']") 
```

如果要选择 id**包含**给定字符串 ( [doc](http://api.jquery.com/attribute-contains-selector/) ) 的元素：

```
$("[id*='txtTitle']") 
```

如果要选择 id**不是**给定字符串 ( [doc](http://api.jquery.com/attribute-not-equal-selector/) ) 的元素：

```
$("[id!='myValue']") 
```

（它也匹配没有指定属性的元素）

如果要选择 id 包含给定单词的元素，由空格( [doc )](http://api.jquery.com/attribute-contains-word-selector/)**分隔**：

```
$("[id~='myValue']") 
```

如果要选择 id**等于给定字符串或以该字符串开头后跟连字符**( [doc](http://api.jquery.com/attribute-contains-prefix-selector/) ) 的元素：

```
$("[id|='myValue']") 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-03-04T06:06:46.317

尝试

```
$("element[id$='txtTitle']"); 
```

编辑：晚了 4 秒：P

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2009-03-20T14:50:46.640

```
$('element[id$=txtTitle]') 
```

引用您要匹配的文本片段并不是绝对必要的

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2009-05-14T08:29:01.250

将下划线或 $ 添加到您正在搜索的术语中更安全，因此不太可能匹配以相同 ID 结尾的其他元素：

```
$("element[id$=_txtTitle]") 
```

（其中*element*是您要查找的元素类型 - 例如`div`，`input`等。

（注意，您是在暗示您的 ID 中往往带有 $ 符号，但我认为 .NET 2 现在倾向于在 ID 中使用下划线，因此我的示例使用下划线）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-07-22T08:24:26.707

示例：选择`<a>`ID 以 _edit 结尾的所有 s：

```
jQuery("a[id$=_edit]") 
```

或者

```
jQuery("a[id$='_edit']") 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-10-19T15:27:42.753

由于这是 ASP.NET，您可以简单地使用 ASP <%= %> 标签打印生成的 txtTitle 的 ClientID：

```
$('<%= txtTitle.ClientID %>') 
```

这将导致...

```
$('ctl00$ContentBody$txtTitle') 
```

...当页面被渲染时。

注意：在 Visual Studio 中，Intellisense 会因为您在 JavaScript 中放置 ASP 标签而大喊大叫。您可以忽略它，因为结果是有效的 JavaScript。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-05-09T09:16:14.770

试试这个：

```
<asp:HiddenField ID="0858674_h" Value="0" runat="server" />

var test = $(this).find('[id*="_h"').val(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-12-06T20:32:43.830

为了在包含许多 iframe 的页面中找到以“iFrame”结尾的 iframe id。

```
jQuery(document).ready(function (){     
                  jQuery("iframe").each(function(){                     
                    if( jQuery(this).attr('id').match(/_iFrame/) ) {
                            alert(jQuery(this).attr('id'));

                     }                   
                  });     
         }); 
```

# php - 为什么在类常量中指定定义的常量会引发错误？

> ID：609383
> 
> 赞同：0
> 
> 时间：2009-03-04T05:56:26.917
> 
> 标签：php

这是我的代码的一部分

```
define('DIR_APP', 'app/');

 class Questions
    {

        const QUESTIONS_FILE = DIR_APP . 'questions.xml';
    } 
```

似乎当我`define()`从类常量声明中取出 'd 常量时，它工作正常。但是当我添加它时，它会抛出这个错误：

```
Parse error: syntax error, unexpected '.', expecting ',' or ';' in /home/public_html/app/classes/Questions.class.php on line 7 
```

那么我怎样才能让我`define()`的'd常量在那里？我认为它没有正确查找`DIR_APP`它可能在类中定义的想法。我如何让它在全球范围内解决它？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T06:54:57.027

这是不可能的。

引自[http://www.php.net/manual/en/language.oop5.constants.php](http://www.php.net/manual/en/language.oop5.constants.php)：

> “值必须是常量表达式，而不是（例如）变量、类成员、数学运算的结果或函数调用”

我想你可以

> 定义（'QUESTIONS_FILE'，DIR_APP。'questions.xml'）；

但这是全球性的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T06:16:40.677

以前从未尝试过。Zend Studio 目前给了我一个问题，让我自己看看。不过试试这个怎么样...

```
const QUESTIONS_FILE = constant("DIR_APP") . 'questions.xml'; 
```

# php - PHP 和 mssql 库可以从 varchar 列中选择超过 256 个字符吗？

> ID：609386
> 
> 赞同：5
> 
> 时间：2009-03-04T05:57:13.607
> 
> 标签：php, sql-server

是否有解决方法（除了将列类型更改为文本字段）使用 PHP 和 mssql 库选择大型 varchar 字段？例如 varchar(500)。PHP是否真的将字符数限制为255？有没有办法拉回更多？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T09:43:23.830

从 PHP 页面来看，问题似乎出在 Windows 平台上的底层数据库驱动程序上。Varchar 只能返回 < 255 个字符。解决方法是将 varchar 转换为 sql SELECT 语句中的文本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-08T18:42:42.613

在 MS SQL 中将宽 VARCHAR 转换为 TEXT：

```
SELECT convert(text,myWideField) FROM myTable 
```

myWideField 是被截断的列，而 myTable 很好......我的表。

结果将被转换为返回超过 256 个字符的 TEXT。

d。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-23T14:33:37.283

尝试更改 freetds 配置。

在服务器中，编辑 /etc/freetds.conf

改变：

```
tds version = 4.2 
```

到：

```
tds version = 8.0 
```

在用户贡献的笔记，[Mssql 函数参考](http://www.php.net/manual/en/ref.mssql.php)中查看更多信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T18:56:04.507

我尝试改变php.ini中变量的值：

```
mssql.textlimit = 2147483647
mssql.textsize = 2147483647 
```

但不起作用...

我将列 varchar (2000) 的类型更改为 varchar (max)。这对我有用！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T13:27:46.223

我不确定要转换，我会将相关字段类型更改为 Text 而不是 Varchar。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-03-04T06:09:44.157

原因实际上可能是 MySQL 而不是 PHP……在 MySQL 5.0.3 之前，MySQL 本身只能在 VARCHAR 中存储 255 个字符。在更高版本中，此限制已提高到 65535。

# regex - 搜索和替换标签的文本内容

> ID：609390
> 
> 赞同：1
> 
> 时间：2009-03-04T05:59:08.487
> 
> 标签：regex, replace

我正在尝试专门在 a 标签的文本中填充 /。

```
1234/1234/ABCDE => 1234 / 1234 / ABCDE 
```

在上下文中; 如果我有一个标签：

```
<a href="http://www.domain.com/path/to/page.html">12 34/1234A/BC DEFG</a> 
```

我想得到：

```
<a href="http://www.domain.com/path/to/page.html">12 34 / 1234A / BC DEFG</a> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T06:06:18.890

这并不是正则表达式擅长的事情。使用 HTML 或 XML 解析器可能会更好——它会从文档中创建一个节点树，然后您可以逐步遍历标签内的所有文本节点并根据需要添加空格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T06:08:37.700

这个正则表达式应该可以解决问题：

```
(\s*/\s*(?=[^<>]+<)) 
```

它只会替换`'/'`inside 标签而不是 URL。

在 C# 中：

```
 myHtml = Regex.Replace(myHtml, @"(\s*/\s*(?=[^<>]+<))", " / "); 
```

在 Perl 中：

```
$myHtml =~ s!(\s*/\s*(?=[^<>]+<))! / !g; 
```

在 JavaScript 中：

```
myHtml = myHtml.replace(/(\s*\/\s*(?=[^<>]+<))/g, " / "); 
```

**笔记：**

在这些示例中，必须将整个文档加载到`myHtml`字符串中。
如果您一次只处理一行，那么如果标签内或标签对之间有换行符，它显然不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T06:04:12.157

什么语言？在 Perl 中，尝试`s/\// \/ /g`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T06:20:33.583

我认为我们在这里缺乏一些背景。数据是 HTML、XML 还是只是带有标签的文本片段？

如果它是 HTML 或 XML，正如经常提到的那样，正则表达式是不安全的，除非您准确控制数据的格式，并且您知道您将始终控制它。然后你记录下来。

如果我是你，我会使用合适的解析器。如果你安装了 Perl 和 XML::Twig，下面的单行代码就可以了：

```
perl -MXML::Twig -e'XML::Twig->parse( keep_spaces => 1, "my_file.xml")->subs_text( "/", " / ")->print' 
```

如果您正在处理没有注释和 CDATA 部分的格式良好的 XML，那么更有效的方法是使用 PYX（您需要安装 XML::PYX）：

```
pyx my_file.xml | perl -p -e's{/}{ / }g if m{-}' | pyxw 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T06:28:21.600

如果需要，您可以尝试使用正则表达式提取两个标签之间的文本，然后对其进行处理，然后重新插入它，但由于您的限制，此任务可能比单个正则表达式更复杂。

这是 Perl 中有效的东西（但不使用正则表达式）：

```
my (@a, $in_tag);
foreach(split //, $string) { # assuming $string holds our string
  $in_tag = 1 if $_ eq "<";
  $in_tag = 0 if $_ eq ">";
  if($_ eq "/" and not $in_tag) {
    push @a, " ", "/", " ";
  }
  else {
    push @a, $_;
  }
}
$string = join "", @a; 
```

然而，这不是一个正则表达式，而是一个非常简单的解析器。

# sql-server - 确定 SQL 触发器中的旧主键

> ID：609401
> 
> 赞同：5
> 
> 时间：2009-03-04T06:06:47.627
> 
> 标签：sql-server, sql-server-2000, triggers

我以前在某个地方做过这个，我很确定！

我有一个 SQL Server 2000 表，我需要在更新时记录对字段的更改并插入到第二个 Logging 表中。我正在使用的结构的简化版本如下：

```
MainTable
ID varchar(10) PRIMARY KEY
DESCRIPTION varchar(50)

LogTable
OLDID varchar(10)
NEWID varchar(10) 
```

对于任何其他领域，这样的事情都会很好用：

```
Select i.DESCRIPTION As New, d.DESCRIPTION As Old 
From Inserted i
LEFT JOIN Deleted d On i.ID=d.ID 
```

...但显然，如果更改 ID，则连接将失败。

我无法修改表格，我在这个数据库中唯一的权力是创建一个触发器。

或者有没有人可以教我时间旅行，我会回到过去问自己当时我是怎么做到的？干杯:)

* * *

**编辑：**

我想我需要在这里澄清一些事情。这**实际上不是我的数据库**，它是一个预先存在的系统，我几乎无法控制，除了编写这个触发器。

我的问题是，如果所述主键已更改，我如何检索旧主键。我不需要被告知我不应该更改主键或追逐外键等。那不是我的问题:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T08:26:44.777

```
DECLARE @OldKey int, @NewKey int;

SELECT @Oldkey = [ID] FROM DELETED;
SELECT @NewKey = [ID] FROM INSERTED; 
```

这仅在您有单行时才有效。否则，您没有“锚”来链接新旧行。因此，在 INSERTED 中检查 > 1 的触发器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-25T04:59:49.623

是否可以假设在触发器中呈现给您的 INSERTED 和 DELETED 表保证顺序相同？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T15:49:41.093

我不认为这是可能的。想象一下，如果表中有 4 行：

```
1  Val1
2  Val2
3  Val3
4  Val4 
```

现在发布以下更新：

```
UPDATE MainTable SET
ID = CASE ID WHEN 1 THEN 2 WHEN 2 THEN 1 ELSE ID END
Description = CASE ID WHEN 3 THEN 'Val4' WHEN 4 THEN 'Val3' ELSE Description END 
```

现在，您将如何区分第 1 行和第 2 行发生的情况以及第 3 和第 4 行发生的情况。更重要的是，您能描述一下它们之间的不同之处吗？告诉您哪些列已更新的所有内容都对您没有帮助。

如果在这种情况下，表上可能有一个附加键（例如，描述是唯一的），并且您的更新规则允许它，您可以编写触发器以防止同时更新两个键，然后您可以使用任何键没有' t 已更新以关联这两个表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T21:48:19.500

如果您必须处理多行插入/更新，并且没有保证不会更改的备用键，那么我能看到的唯一方法是使用 INSTEAD OF 触发器。例如，在触发器中，您可以将原始插入/更新命令分解为每行一个命令，在插入/更新之前获取每个旧 id。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T15:40:01.523

----new---- 将标识列添加到应用程序无法更改的表中，然后您可以使用该新列将插入的列连接到触发器内的已删除表中：

```
ALTER TABLE YourTableName ADD
    PrivateID int NOT NULL IDENTITY (1, 1)
GO 
```

----旧---- 永远不要更新/更改键值。你怎么能做到这一点并修复你所有的外键？

我不建议使用无法处理一组行的触发器。

如果您必须更改键，请使用正确的新键和值插入新行，如果您正在这样做，请使用 SCOPE_IDENTITY()。删除旧行。记录已更改为新行键的旧行，您现在应该拥有该键。我希望您的日志中更改的键上没有外键...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-05T14:01:15.637

在 SQL Server 的触发器中，您可以访问两个表：已删除表和已插入表。这两个都已经提到了。以下是它们的作用方式，具体取决于触发器触发的操作：

**插入操作**

*   已删除 - 未使用
*   插入 - 包含要添加到表中的新行

**删除操作**

*   已删除 - 包含要从表中删除的行
*   插入 - 未使用

**更新操作**

*   已删除 - 包含在 UPDATE 操作之前存在的行
*   已插入 - 包含在 UPDATE 操作之后将存在的行

这些功能在各个方面都像表格一样。因此，完全可以使用基于行的操作，如下所示（操作仅存在于审计表上，DateChanged 也是如此）：

```
INSERT INTO MyAuditTable
(ID, FirstColumn, SecondColumn, ThirdColumn, Operation, DateChanged)
VALUES
SELECT ID, FirstColumn, SecondColumn, ThirdColumn, 'Update-Before', GETDATE()
FROM deleted
UNION ALL
SELECT ID, FirstColumn, SecondColumn, ThirdColumn, 'Update-After', GETDATE()
FROM inserted 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-17T13:15:15.823

您可以在表 MainTable（例如命名为correlationid）上创建一个新的标识列，并使用该列关联插入和删除的表。这个新列对现有代码应该是透明的。

```
INSERT INTO LOG(OLDID, NEWID)
SELECT deleted.id AS OLDID, inserted.id AS NEWID
FROM inserted 
INNER JOIN deleted 
    ON inserted.correlationid = deleted.correlationid 
```

请注意，您可以在日志表中插入重复记录。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-09-12T17:36:21.710

当然，没有人应该更改表上的主键——但这正是触发器应该（部分）用于的目的，就是阻止人们做他们不应该做的事情。在 Oracle 或 MySQL 中编写一个触发器来拦截对主键的更改并停止它们是一项微不足道的任务，但在 SQL Server 中却一点也不容易。

您当然希望能够做的就是简单地做这样的事情：

```
if exists
  (
  select *
    from inserted changed
           join deleted old
   where changed.rowID = old.rowID
     and changed.id != old.id
  )
... [roll it all back] 
```

这就是为什么人们出去搜索与 ROWID 等效的 SQL Server 的原因。好吧，SQL Server 没有。所以你必须想出另一种方法。

一个快速但遗憾的是不是防弹的版本是编写一个代替更新触发器来查看是否有任何插入的行具有在更新的表中找不到的主键，反之亦然。这将捕获大多数（但不是全部）错误：

```
if exists
  (
  select *
    from inserted lost
           left join updated match
             on match.id = lost.id
   where match.id is null
  union
  select *
    from deleted new
           left join inserted match
             on match.id = new.id
    where match.id is null
  )
  -- roll it all back 
```

但这仍然没有像...这样的更新

```
update myTable
   set id = case
              when id = 1 then 2 
              when id = 2 then 1
              else id
              end 
```

现在，我尝试假设插入和删除的表是按这样的方式排序的，即同时游标通过插入和删除的表将为您提供正确匹配的行。这似乎有效。实际上，您将触发器转换为相当于 Oracle 中可用的 for-each-row 触发器和 MySQL 中的强制触发器......但我想大规模更新的性能会很差，因为这不是 SQL Server 的本机行为。此外，它还取决于一个假设，即我实际上无法在任何地方找到文档，因此不愿依赖。但是以这种方式构造的代码似乎可以在我的 SQL Server 2008 R2 安装上正常工作。本文末尾的脚本突出了快速但非防弹解决方案的行为和第二种伪 Oracle 解决方案的行为。

如果有人能指出我的假设被微软记录并保证的某个地方，我将是一个非常感激的人......

```
begin try
  drop table kpTest;
end try
begin catch
end catch
go

create table kpTest( id int primary key, name nvarchar(10) )
go

begin try
  drop trigger kpTest_ioU;
end try
begin catch
end catch
go

create trigger kpTest_ioU on kpTest
instead of update
as
begin
  if exists
    (
    select *
      from inserted lost
             left join deleted match
               on match.id = lost.id
     where match.id is null
    union
    select *
      from deleted new
             left join inserted match
               on match.id = new.id
      where match.id is null
    )
      raisError( 'Changed primary key', 16, 1 )
  else
    update kpTest
       set name = i.name
      from kpTest
             join inserted i
               on i.id = kpTest.id
    ;
end
go

insert into kpTest( id, name ) values( 0, 'zero' );
insert into kpTest( id, name ) values( 1, 'one' );
insert into kpTest( id, name ) values( 2, 'two' );
insert into kpTest( id, name ) values( 3, 'three' );

select * from kpTest;

/*
0   zero
1   one
2   two
3   three
*/

-- This throws an error, appropriately
update kpTest set id = 5, name = 'FIVE' where id = 1
go

select * from kpTest;

/*
0   zero
1   one
2   two
3   three
*/

-- This allows the change, inappropriately
update kpTest 
   set id = case   
              when id = 1 then 2
              when id = 2 then 1
              else id
              end
     , name = UPPER( name )
go

select * from kpTest

/*
0   ZERO
1   TWO   -- WRONG WRONG WRONG
2   ONE   -- WRONG WRONG WRONG
3   THREE
*/

-- Put it back
update kpTest 
   set id = case   
              when id = 1 then 2
              when id = 2 then 1
              else id
              end
     , name = LOWER( name )
go

select * from kpTest;

/*
0   zero
1   one
2   two
3   three
*/

drop trigger kpTest_ioU
go

create trigger kpTest_ioU on kpTest
instead of update
as
begin
  declare newIDs cursor for select id, name from inserted;
  declare oldIDs cursor for select id from deleted;
  declare @thisOldID int;
  declare @thisNewID int;
  declare @thisNewName nvarchar(10);
  declare @errorFound int;
  set @errorFound = 0;
  open newIDs;
  open oldIDs;
  fetch newIDs into @thisNewID, @thisNewName;
  fetch oldIDs into @thisOldID;
  while @@FETCH_STATUS = 0 and @errorFound = 0
    begin
      if @thisNewID != @thisOldID
        begin
          set @errorFound = 1;
          close newIDs;
          deallocate newIDs;
          close oldIDs;
          deallocate oldIDs;
          raisError( 'Primary key changed', 16, 1 );
        end
      else
        begin
          update kpTest
             set name = @thisNewName
           where id = @thisNewID
          ;
          fetch newIDs into @thisNewID, @thisNewName;
          fetch oldIDs into @thisOldID;
        end
    end;
  if @errorFound = 0
    begin
      close newIDs;
      deallocate newIDs;
      close oldIDs;
      deallocate oldIDs;
    end
end
go

-- Succeeds, appropriately
update kpTest
   set name = UPPER( name )
go

select * from kpTest;

/*
0   ZERO
1   ONE
2   TWO
3   THREE
*/

-- Succeeds, appropriately
update kpTest
   set name = LOWER( name )
go

select * from kpTest;

/*
0   zero
1   one
2   two
3   three
*/

-- Fails, appropriately
update kpTest 
   set id = case   
              when id = 1 then 2
              when id = 2 then 1
              else id
              end
go

select * from kpTest;

/*
0   zero
1   one
2   two
3   three
*/

-- Fails, appropriately
update kpTest 
   set id = id + 1
go

select * from kpTest;

/*
0   zero
1   one
2   two
3   three
*/

-- Succeeds, appropriately
update kpTest 
   set id = id, name = UPPER( name )
go

select * from kpTest;

/*
0   ZERO
1   ONE
2   TWO
3   THREE
*/

drop table kpTest
go 
```

# excel-2007 - 自动化插件中的用户定义函数行为不同 Excel 2007

> ID：609402
> 
> 赞同：1
> 
> 时间：2009-03-04T06:07:06.750
> 
> 标签：excel-2007, user-defined-functions, shim

我在 C# .NET 中创建了一个自动化插件，并为其提供了一个 shim dll。shim dll 中包含所有用户定义的方法，这些方法调用 .NET 程序集中的适当方法。

我面临的问题与 Excel 2007 有关。

在 Excel 2003 中， 1\. 向工作表添加新形状 2\. 插入 >> 函数 >> SUM。出现函数参数对话框 3\. 单击新插入的形状而不是单元格 注意：没有任何反应，并且不会在参数框中自动输入单元格值

现在在 Excel 2007 中，1\. 插入新形状 2\. 公式功能区选项卡 >> 插入函数 >> SUM。出现函数参数对话框 3\. 单击新插入的形状 请注意，现在会显示一个错误对话框，上面写着“您键入的公式包含错误”

**此对话框针对预定义函数 (SUM) 出现。如果我从 SUM 列表中选择我的函数，则不会显示错误对话框，并且函数参数对话框会消失。然后该单元格显示错误智能标签。**

是否需要为每个函数放入 SHIM dll 中的内容？像属性或将显示此错误对话框的东西。或者可能是该方法返回的一些特殊值，以告知参数已生成错误。

COM shim 中定义的函数如下：

```
STDMETHOD(GetArea)(MyExcelAddIn::Range *r, double *pRetVal)
{
   return m_pMyUDF->GetArea(r, pRetVal);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-19T05:32:38.790

**我联系了 Microsoft，他们确认这是 Excel 产品中的错误。当我从他们那里得到它时，我会发布错误链接。**

# java - 在没有应用程序/Web 服务器的情况下呈现 JSP 页面的简便方法是什么

> ID：609405
> 
> 赞同：2
> 
> 时间：2009-03-04T06:08:54.140
> 
> 标签：java, testing, jsp

**首先，一些背景：**

我将不得不为需要大量代码修复和测试的 JSP 编写代码。这个 JSP 将接收给定对象的结构，并根据几个规则呈现它。

我想做的是编写一个“测试服务器”，它将从固定文件中读取一些模拟数据，并将这些对象模拟到一个工厂中，供相关 JSP 使用。

目标 App Server 是 WebSphere，我想编写代码、更改代码以测试适当的 HTML 呈现。我过去做过类似的事情，但是 JSP 部分只是调用渲染对象的方法，所以我创建了一个 Ad Hoc HTTP 服务器，它可以读取夹具文件、解析它并渲染 HTML。

我所要做的就是在 RAD 中运行它，更改 HTML 代码并按 F5。

**所以问题几乎可以归结为：**是否有任何独立的库或轻量级服务器（我想到了 Jetty）会采用 JSP，并在给定正确的上下文（请求、响应、会话等）的情况下呈现正确的 HTML？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T11:00:45.360

您需要的不仅仅是 Web 服务器。您必须有一个 servlet/JSP 引擎，所以没有办法解决这个问题。

码头很轻。也许 Resin 也值得一看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T06:15:59.553

码头和雄猫

不过，这些可能不够清淡，不适合你的口味。
您会在 SO for tomcat 上找到大量用户和支持，因此这很重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T06:18:08.987

没有（afaik）。

我可以建议的唯一解决方法是改用 Velocity。但是，当然，您将不得不完全放弃 jsp，这不是一个选择。

如果你这样做了，那么你可以用 Velocity 隔离你的测试，将结果移动到网络中。

这是一篇关于如何将 Velocity + Ruby（或 JRuby）用于独立解决方案的文章。

[http://martinfowler.com/bliki/JRubyVelocity.html](http://martinfowler.com/bliki/JRubyVelocity.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T06:19:24.380

我从未使用过 JSP，但*我*玩过[OOWeb](http://ooweb.sourceforge.net/tutorial.html)。它绝对是轻量级的，并且遵循请求/响应模型，但是如果没有大量胶水，您将很难将它与您的 JSP 连接起来。

[这里](http://www.artima.com/forums/flat.jsp?forum=1&thread=34027)列出了几个轻量级容器。看起来[Tiny Java Web Server](http://tjws.sourceforge.net/)正在积极开发中。不幸的是，没有太多可用的文档。

# c++ - 如何在同一个函数中创建多个对象但不相互覆盖？

> ID：609411
> 
> 赞同：0
> 
> 时间：2009-03-04T06:16:50.363
> 
> 标签：c++, pointers, variables, object

我试图在函数中创建一个对象，但我遇到了必须在运行时定义变量名的问题。有没有我可以对数组做的事情，它允许 ne 在函数中动态创建一个变量，并且最好给它一个与上次调用函数时创建的名称不同的名称？

***我正在使用 C++

编辑：我不能提供任何代码，因为我现在没有任何代码。我现在只有伪代码。

基本上，我正在尝试创建一个链接列表，但我想使用的 addNewItem() 方法需要使用相同的方法来创建不同的对象。

编辑：从技术上讲，我们不是在制作链接列表，只是为了了解它们如何工作的概念证明。

编辑：这是代码：

```
#include "linklist.h"
#include <iostream>
using namespace std;

struct linklist
{
    Student * obj;
    linklist * next;
};

linklist * head;

int main()
{

}
void addStudent(char * newsdnt)
{
    if(!head){
            linklist * a = new linklist;
            a->obj = new Student(newsdnt);
            a->next = 0;
            head = a;
            return;
    }else{
            linklist * a = new linklist;
            a->obj = new Student(newsdnt);
            a->next = 0;
            if(!head->next){
                    head->next = a;  // Can only have one or two items in list
            }
    } 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T06:42:30.193

如果您想要一个链表 - 调用 new 来创建每个新节点，然后将其添加到列表中。

像这样：

```
void addStudent(char * newsdnt)
{
    linklist* a = new linklist;
    a.obj = new Student(newsdnt);
    a.next = 0;

    if( head == 0 ) {
        head = a;
    } else {
        linklist* whereToAdd = head;
        while( whereToAdd.next != 0 ) {
            whereToAdd = whereToAdd.next;
        }
        whereToAdd.next = a;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T07:41:05.620

构建（单个）链表的最简单方法是在前面添加新项目：

```
linklist *head = 0;

...
a->next = head;
head = a;
... 
```

如果可以接受在 O(N) 时间内在尾部添加项目，那么您每次都扫描列表以找到末尾。

```
linklist head;

...
a->next = 0;
item = &head;
while (item->next != 0)
    item = item->next;
item->next = a;
... 
```

如果您必须在 O(1) 时间内在列表的尾部添加新项目，则保留一个循环列表和一个指向列表尾部的指针（即`tail->next`指向列表头部的指针）。（以前的列表结构可以称为“开放式”。）

```
linklist  root = { 0, &root };
linklist *tail = &root;

...
a->next = tail;
tail->next = a;
... 
```

请注意：遍历整个列表的终止条件（例如，在列表中查找项目）取决于所使用的结构（圆形与开放式）。

**警告**：未经测试的代码！

如果您不确定 O(1) 和 O(N) 的含义，请阅读“大 O”表示法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T06:18:25.990

我建议一个向量：

```
#include <vector>
using namespace std;
void foo()
{
    vector<int> v;
    v.push_back(1);
    v.push_back(2);
    v.push_back(3);
    cout << v[0] + v[1] << endl;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T06:20:54.783

假设您需要`N`某种类型的对象`T`：数组在 C++ 中非常普遍。为您提供大量机会的 STL 也是如此。您需要定义访问和使用这些对象的方式——这会影响容器的选择。但是您能否发布一些代码，以便我们的答案不那么含糊（并且对您更有帮助）？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T06:29:25.433

我不确定你想要什么，但听起来你可以使用 [Multiset](http://www.cppreference.com/wiki/stl/multiset/start)。

请提供更多详细信息，我也许可以提供更多帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T09:44:56.900

对于初学者，我建议您将链接列表结构重命名为节点并添加一个新的链接列表结构来保存头部和（可能）当前/尾部指针。然后，您应该在此类/结构中实现允许您对其进行操作的方法。

您目前缺少的是一种将遍历列表的方法（递归获取下一个指针，直到您到达末尾）并返回指向最后一个元素的指针。一旦你有了它，你就可以将该元素的下一个指针设置为新创建的对象。

# php - 在 php 中管理 QUERY_STRING 的最佳方法是什么？

> ID：609413
> 
> 赞同：4
> 
> 时间：2009-03-04T06:18:05.697
> 
> 标签：php, optimization, query-string

我的一个网站在分页之上有一些非常复杂的排序功能，各种变量加起来就是一个非常复杂的 URL，管理起来非常麻烦。有没有办法有效地管理 QUERY_STRING？

我的意思是...如果网址是 index.php?catid=3&sort=date&year=2009&page=2 并且我希望用户跳转到第 3 页，或者更改排序方法.....我将如何保留剩余的 var 不使用 if/else 条件检查每个单独的 var，并在链接到第 3 页或替代排序方法的链接中回显它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T06:26:08.563

PHP 为您提供了一个全局 $_GET ，它将您的查询字符串很好地解析为元素

```
$_GET['catid'] will be '3'
$_GET['sort'] will be 'date'
$_GET['year'] will be '2009' 
```

ETC

您可以取消设置您不想传递的内容，然后通过以下方式移至新网址：

```
$get = array_intersect_key($_GET, array_keys($_GET));
unset($get['sort']);
$url = 'target.php?' . http_build_query($get); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T07:28:58.083

要处理实际的查询**字符串**（字符串格式），您可以使用[`parse_str()`](http://php.net/parse_str). 当您要构建查询字符串时，请使用[`http_build_query()`](http://php.net/http_build_query).

这些文档页面上有很多示例。

如果由于某种原因您不能使用`http_build_query`，请查看我关于[内爆关联数组的最快方法的](https://stackoverflow.com/questions/408032/fastest-way-to-implode-an-associative-array-with-keys)问题。

```
<?php
$QueryString = 'catid=3&sort=date&year=2009&page=2'; // sample querystring
parse_str($QueryString, $HttpQuery);

print_r($HttpQuery); // will be an associative array

$HttpQuery['page'] = 3; // change any values

$NewQueryString = http_build_query($HttpQuery); // rebuild the querystring 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T06:42:04.873

如果您的意思是您希望第 3 页的链接仅

```
index.php?page=3 
```

或更改排序方法的链接将只是

```
index.php?sort=date 
```

您必须将其他变量存储在[会话变量](http://fi2.php.net/manual/en/intro.session.php)（或 cookie，如果您希望它们持续更长时间）中。

像这样的东西：

```
<?php

  session_start();

  foreach($_GET as $var => $val) {
    // filter any malicious stuff and invalid variables out of $var and $val here
    // like
    if (in_array($var, $array_of_valid_variable_names)) {
      if ($var == 'page') $val = intval($val);

      $_SESSION[$var] = $val;
    }
  }

  // do stuff based on the values stored in $_SESSION

  echo '<a href="index.php?page='.($_SESSION['page'] + 1).'">Next page</a>';
?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T07:35:39.270

尽管此处提供的大多数解决方案都可以使用，但我认为最简单的方法是

```
// parse query string into an array
$queryData = array();
parse_str($_SERVER['QUERY_STRING'], $queryData);
/*
 * ... manipulate array $queryData
 */
// rebuild query string
$queryString = http_build_query($queryData, null, '&amp;'); // or use & if you don't need XHTML compliance 
```

就是这样。请参阅有关[`http_build_query()`](http://de2.php.net/http_build_query)and的文档[`parse_str()`](http://de2.php.net/manual/en/function.parse-str.php)（这是名称完全混乱的函数之一 - 没有人会期望该函数仅通过查看名称来完成它的工作）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T07:19:52.693

对于一般的“为我构建一个可排序的、可分页的表”类，我遇到了完全相同的问题。这就是为什么有人在 php.ini 中发明了称为“函数”的子过程。

您必须创建一个函数来准确处理链接构建过程。像这样：

```
/**
* $set: associative array of changing vars
* $unset : normal array of vars to delete
**/
function get_link($set,$unset=array())
{
 $set+=$_GET;
 if ($unset && is_array($unset))
   foreach($unset as $idx) 
      unset($set[$idx]);

 if ($set)
   foreach($set as $name=>$value)
      $pairs[]=$name.'='.urlencode($value);

 return $_SERVER['SCRIPT_NAME']."?".join('&',$pairs);
} 
```

未经测试的代码！动动脑筋

或者你可以使用 $_SESSION-vars 进行分页和排序（一个'东西）并且链接只改变那些（这是我现在主要做的）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T07:34:59.880

在查询字符串的末尾添加变量名称和值（将页面更改为 3）：

```
index.php?catid=3&sort=date&year=2009&page=2&x=page&y=3 
```

然后，在提取 $_GET 之后，使用一个简单的函数来检查是否设置了 x 和 y。

如果是，则将名称包含在 x 中的变量设置为值 y。

您可以在任何地方使用相同的链接，最后只需简单添加，并且编程量最少。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-03-04T06:47:09.120

不要直接管理字符串，而是管理它的数组（ key => value ）表示，并仅在需要时将其转换回字符串。

一种可能的方法：

```
function explodeQueryString( $queryString )
{
    $parts = array();
    if ( strlen( $queryString ) > 1 && substr( $queryString, 0, 1 ) == '?' )
    {
        $q = explode( '&', substr( $queryString, 1 ) );
        foreach( $q as $part )
        {
            list( $key, $value ) = explode( '=', $part );
            $parts[ urldecode( $key ) ] = urldecode( $value );
        }
    }
    return $parts;
}

function implodeQueryString( array $arguments )
{
    $parts = array();
    foreach( $arguments as $key => $value )
    {
        $parts[ ] = sprintf( '%s=%s', urlencode( $key ), urlencode( $value ) );
    }
    return sprintf( '?%s', implode( '&', $parts ) );
}

// $query = $_GET;

$query = '?something=1&somethingelse=2&page=1&yetsomethingelse=3';

$q = explodeQueryString( $query );

print_r( $q );

$q[ 'page' ] += 1;

$query = implodeQueryString( $q );

echo $query; 
```

# c++ - 如何将 C++ Visual Studio 2008 项目降级到 2005

> ID：609419
> 
> 赞同：7
> 
> 时间：2009-03-04T06:19:50.777
> 
> 标签：c++, visual-studio, visual-studio-2008, visual-studio-2005

如何将 C++ Visual Studio 2008 项目降级到 Visual Studio 2005？

也许有人知道一个转换器程序或我可以执行的其他过程。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-04T06:25:46.130

我不知道它有多好用，但这里有一个开源转换器工具：

*   [http://sourceforge.net/projects/vspc](http://sourceforge.net/projects/vspc)

这是对本文中概述的工具的扩展：

*   [http://www.codeproject.com/KB/macros/vsconvert.aspx](http://www.codeproject.com/KB/macros/vsconvert.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T07:44:07.517

我总是讨厌手动编辑 .sln/proj 文件，因为它们可能非常挑剔和有问题。最简单的方法是在 2005 年创建一个新项目，然后将所有代码文件复制回其中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T06:27:31.477

您将需要更改`sln`和`vcproj`文件（包括`ToolsVersion`、`TargetFramework`等属性`ProductVersion`）。可能会提供一些免费软件，但我对它们的评价并不高。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T08:06:52.440

您的解决方案文件是否在版本控制系统中？只需查看升级到 VS 2008 对项目和解决方案文件所做的修改，然后撤消它们。他们不是很多。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-03T03:48:44.097

这是将VS2008项目转换为VS2005的开源。

[http://www.emmet-gray.com/Articles/ProjectConverter.htm](http://www.emmet-gray.com/Articles/ProjectConverter.htm)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-05T11:43:04.580

您可以删除 .sln 文件，然后在 VS2005 中打开 .vcproj，然后将其另存为新解决方案。由于所有项目选项都保存在 .vcproj 文件中，因此应该这样做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-03-20T06:27:00.483

您可以使用[sed](http://gnuwin32.sourceforge.net/packages/sed.htm)来执行此操作，使用以下脚本或类似的东西：

```
s#Version=\"9.00\"#Version=\"8.00\"#g
s#<ProductVersion>9.0.21022</ProductVersion>#<ProductVersion>8.0.50727</ProductVersion>#g
s#<TargetFrameworkVersion>v2.0</TargetFrameworkVersion>##g
s# ToolsVersion=\"3.5\"##g
s#MSBuildToolsPath#MSBuildBinPath#g 
```

将其放入名为“downgrade_vc9_to_vc8.sed”的文本文件中，然后使用以下命令调用它：

```
"C:\Program Files\GnuWin32\bin\sed.exe" -f "downgrade_sln_vc9_to_vc8.sed" "MyProject.vcproj" > "MyProject_VC8.vcproj" 
```

# redirect - 移动重定向

> ID：609423
> 
> 赞同：7
> 
> 时间：2009-03-04T06:21:58.040
> 
> 标签：redirect, mobile

我有一个网页，最近有人要求我为其创建移动版本，现在我已经完成了，我被要求进行自动重定向，以便如果用户通过 PDA/iPhone/智能手机/等进入网页他/她会自动定向到 m.website.com，但我不知道该怎么做 =/ 我尝试了一些使用 google 找到的 php 和 javascript，但到目前为止没有任何帮助。你们可以吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T06:24:52.713

查看 WURFL 并为与其移动浏览器用户代理字符串列表匹配的用户代理构建 302 重定向器。

或者，只需在 User-Agent 中查找 iPhone 并将其重定向到您的 iPhone 站点。其他浏览器的市场份额如此之小，几乎不值得瞄准它们。iPhone 占移动网络 HTML 流量的 67%。您可以在网页上使用 Javascript 执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-23T19:14:19.897

我已经发布了“Apache Mobile Filter”的最后一个版本，这个开源项目在前 8 个月内有超过 1100 次来自 sourceforge 的下载，我想来自 CPAN 的下载量也是如此。

Apache Mobile Filter 允许您从任何编程语言访问 WURFL，而不仅仅是传统上用于动态移动网站的 Java 和 php。

该模块检测移动设备并将 WURFL 功能作为环境变量传递给其他 Web 应用程序。它还可以用于动态调整图像大小以适应移动设备的屏幕尺寸。试试看，让我知道你的意见。

欲了解更多信息：[http ://www.idelfuschini.it/it/apache-mobile-filter-v2x.html](http://www.idelfuschini.it/it/apache-mobile-filter-v2x.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-09T05:59:40.733

我编写了一个名为“ **redirection_mobile.js** ”的 JS 脚本来解决这个问题。如果您从移动设备访问站点，它会检​​测用户代理并重定向到移动版本。

在某些情况下，您想从移动设备重定向到桌面版本（例如使用“转到主站点”链接），脚本将处理该问题，一旦您完成会话，您将再次访问移动版本.

您可以在 github 上找到源代码**https://github.com/sebarmeli/JS-Redirection-Mobile-Site**并且您可以在我的一篇文章中阅读更多详细信息：

[http://blog.sebarmeli.com/2010/11/02/how-to-redirect-your-site-to-a-mobile-version-through-javascript/](http://blog.sebarmeli.com/2010/11/02/how-to-redirect-your-site-to-a-mobile-version-through-javascript/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T06:34:20.400

也许如果您列出了不起作用的代码，可以提供更多帮助。

如果您有 php，则用户代理检测在大多数情况下都能正常工作。

```
< ?php
$browser = strpos($_SERVER['HTTP_USER_AGENT'],"iPhone");
if ($browser == true) { header(”Location: http://www.example.com/“); }
}
?> 
```

此外，这看起来像是一个骗局： [识别不同的手机并重定向到不同的网站](https://stackoverflow.com/questions/291609/identifying-different-mobile-handsets-and-redirecting-to-different-websites)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-31T16:39:09.253

这里提出并回答了一个非常相似的问题：

[如何确定它是否是带有 PHP 的移动设备？](https://stackoverflow.com/questions/386046/how-do-i-determine-whether-its-a-mobile-device-with-php)

> 传统上，通过将 HTTP User-Agent 标头与众所周知的移动 UA 字符串列表进行比较来检测移动设备。相反，一种新颖的方法试图检测桌面操作系统的存在——任何被发现不是桌面操作系统的东西都必须是移动的。
> 
> 这导致更少的误报。
> 
> 我在这里用 Python 写了一篇带有示例代码的帖子：
> 
> [http://notnotmobile.appspot.com](http://notnotmobile.appspot.com)

检测设备是否是桌面设备 - 如果不是，则重定向到您的移动站点！

干杯，

约翰

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-31T16:46:10.407

设置好移动子域后，请务必参考*A List Apart*中的这篇文章，该文章描述了移动设备如何对 CSS 属性 media="handheld" 做出反应。不幸的是，并非所有人的反应都一样。

[http://www.alistapart.com/articles/returnofthemobilestylesheet](http://www.alistapart.com/articles/returnofthemobilestylesheet)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-11T19:40:07.770

“Apache Mobile Filter”是“Apache Module Registry”门户（[http://modules.apache.org/search.php?id=1787](http://modules.apache.org/search.php?id=1787)）的模块之一

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-06-08T07:53:09.973

我使用[http://detectmobilebrowser.com](http://detectmobilebrowser.com/)，发现它是最快和最简单的方法。它工作得很好。该站点自动生成服务器脚本（php、perl、python、coldfusion、apache、jquery 等），检测移动浏览器并相应地重定向。您可以将代码复制并粘贴到您的索引文件中的某处。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-02-25T19:59:37.320

这一点 Javascript 也可能会有所帮助：

```
<script>
    if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|BB10|IEMobile|Opera Mini/i.test(navigator.userAgent) ) //Specify the mobile devices that you would like this if statement to apply to. 
    {
        image_y = document.getElementById('bodyID'); //Get the ID of the body and assign it to a variable.
        image_y.parentNode.removeChild(image_y); //Remove the body to prevent anything loading on the screen in case there are issues with the window location redirect.
        window.location = "mobile.html"; //Re-assign the window location to a new html page that is caters for the redirect. 
    }
</script> 
```

我把它放在 HTML 正文的开头。

# javascript - Eclipse 的 JSDT 发生了什么？

> ID：609432
> 
> 赞同：7
> 
> 时间：2009-03-04T06:25:55.223
> 
> 标签：javascript, eclipse, jsdt

[JSDT](http://wiki.eclipse.org/index.php/ATF/JSDT)（Javascript 开发工具）是一个 Eclipse 项目，旨在为 Javascript 实现 JDT API。它的早期演示确实令人印象深刻，但它似乎自 2007 年以来没有任何版本，没有提及它发生了什么。

有人知道它的状态吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-04T07:07:35.030

如您提供的[页面链接](http://wiki.eclipse.org/index.php/ATF/JSDT)中所述，它现在是 WTP（Web 工具平台）的一部分

因此，它仍然包含在自 2007 年以来的 WTP 版本中，就像[这条消息所说明的那样，](http://www.nabble.com/Released-fixes-for-3.1M6-JSDT-failures-and-org.eclipse.wst.xml.validation.tests-version-problem-td22107393.html) [wtp.jsdt 组件](https://bugs.eclipse.org/bugs/buglist.cgi?query_format=advanced&short_desc_type=allwordssubstr&short_desc=&classification=WebTools&component=wst.jsdt&long_desc_type=allwordssubstr&long_desc=&bug_file_loc_type=allwordssubstr&bug_file_loc=&status_whiteboard_type=allwordssubstr&status_whiteboard=&keywords_type=allwords&keywords=&bug_status=UNCONFIRMED&bug_status=NEW&bug_status=ASSIGNED&bug_status=REOPENED&bug_status=RESOLVED&bug_status=VERIFIED&bug_status=CLOSED&emailtype1=substring&email1=&emailtype2=substring&email2=&bugidtype=include&bug_id=&votes=&chfieldfrom=&chfieldto=Now&chfieldvalue=&cmdtype=doit&order=Reuse+same+sort+as+last+time&field0-0-0=product&type0-0-0=substring&value0-0-0=wst.jsdt&field0-0-1=component&type0-0-1=substring&value0-0-1=wst.jsdt&field0-0-2=short_desc&type0-0-2=substring&value0-0-2=wst.jsdt&field0-0-3=status_whiteboard&type0-0-3=substring&value0-0-3=wst.jsdt&field0-0-4=longdesc&type0-0-4=substring&value0-0-4=wst.jsdt&field0-0-5=bug_file_loc&type0-0-5=substring&value0-0-5=wst.jsdt)的错误列表似乎相当活跃。

[然而，直到最近](https://bugs.eclipse.org/bugs/show_bug.cgi?id=263865)它的方面（围绕安装 JSDT 特性的包装器）才消失。

# tdd - 设备通信器的 TDD

> ID：609436
> 
> 赞同：2
> 
> 时间：2009-03-04T06:26:54.927
> 
> 标签：tdd, inversion-of-control

我一直在阅读有关 TDD 的内容，并希望将它用于我的下一个项目，但我不确定如何使用这种新范例来构建我的类。我想使用的语言是 Java，尽管问题并不是特定于语言的。

**该项目**

我有一些硬件带有 ASCII-over-RS232 接口。我可以发出简单的命令，得到简单的响应，并像从前面板一样控制它们。每个都有稍微不同的语法和非常不同的命令集。我的目标是创建一个抽象/接口，以便我可以通过 GUI 和/或远程过程调用来控制它们。

**问题**

我相信第一步是创建一个抽象类（我不擅长名称，'Communicator' 怎么样？）来实现所有东西，如串行 I/O，然后为每个设备创建一个子类。我相信它会比这更复杂一些，但这是我心目中应用程序的核心。

现在，对于单元测试，我认为我真的不需要实际的硬件或串行连接。我想做的是给我的通讯器一个 InputStream 和 OutputStream（或 Reader 和 Writer），它们可以来自串行端口、文件、stdin/stdout、从测试函数管道传输等等。那么，我会让 Communicator 构造函数将它们作为输入吗？如果是这样，将所有设置的责任都放在测试框架上很容易，但对于真实的事情，谁来建立实际的连接？一个单独的构造函数？再次调用构造函数的函数？一个单独的类，谁的工作是将 Communicator “连接”到正确的 I/O 流？

**编辑**

我正要重写问题部分，以便得到我认为我要问的问题的答案，但我想我想通了。我（对吗？）确定了两个不同的功能区域。

1）处理串口

2）与设备通信（了解其输出和生成命令）

几个月前，我会把所有这些都合并到一个班级中。我摆脱这种情况的第一个想法是只将 IO 流传递给理解设备的类，我不知道谁将负责创建流。

在对控制反转进行了更多研究之后，我想我有*一个*答案。有一个单独的接口和类来解决问题 #1，并将其传递给解决问题 #2 的类的构造函数。这样，很容易分别测试两者。#1 通过连接到实际硬件并允许测试框架做不同的事情。#2 可以通过模拟 #1 来测试。

这听起来合理吗？我需要分享更多信息吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T06:37:23.090

使用 TDD，您应该**让您的设计出现**，从小处着手，一步一步地逐步发展您的课程，一点一点地逐个测试。

澄清：从一个具体的类开始，发送一个命令，用模拟或存根对其进行单元测试。当它足够工作时（也许不是所有选项），在你的真实设备上测试一次，以验证你的模拟/存根/模拟器。

一旦第一个命令的类可操作，开始执行第二个命令，方法相同：首先再次模拟/存根，然后针对设备进行验证。现在，如果您看到两个类之间的相似之处，您可以重构为基于抽象类的设计 - 或不同的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T06:39:37.577

抱歉有点以 Linux 为中心..

我最喜欢的模拟小工具的方法是[编写](http://luv.asn.au/overheads/chrdev-talk.html)模拟其行为的字符设备驱动程序。这也为您提供了有趣的能力，例如提供使模拟设备行为异常的 ioctl() 接口。

那时......从测试到现实世界，只有您实际打开、读取和写入的设备才重要。

模仿您的小工具的行为应该不会太难......听起来他们接受非常基本的指令并返回非常基本的响应。同样，一个简单的 ioctl() 可以告诉模拟设备该到了该行为不端的时候了，因此您可以确保您的代码充分处理此类事件。例如，在每第 n 条指令上故意失败，其中 n 是在调用 ioctl() 时随机选择的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-11T11:05:42.247

After seeing your edits I think you are heading in exactly the right direction. TDD tends to drive you towards a design composed of small classes with a well-defined responsibility. I would also echo tinkertim's advice - a device simulator which you can control and "provoke" into behaving in different ways is invaluable for testing.

# svn - 使用expect登录SVN

> ID：609445
> 
> 赞同：1
> 
> 时间：2009-03-04T06:30:50.983
> 
> 标签：svn, unix, build-automation, expect

我正在尝试使用自动脚本，该脚本将登录到 SVN，更新我的源，用这些创建一个 tarball 并将它们 scp 到远程主机。

这里的问题是，每次登录 SVN（即使是结帐或更新），我们都需要输入密码。密码输入的自动化，我能找到的唯一方法，就是使用 expect 来解决这个问题。

是否有任何脚本可以处理 SVN 和 scp 来检测并将密码提供给 SVN，然后提供给 SCP？

我正在使用以下内容：

```
spawn svn [lindex $argv 0]
expect " password: $"
send "$password\r"
expect { 
    " password: $"    send "$password\r"
    "^At revision "
    "^Updated to revision "
} 
```

我从命令行传递密码和 up 命令，但如果有人可以访问历史记录，就会存在安全威胁。下面提到的答案不满足我的先决条件，我现在也无法进行出口[其他一些安全问题:-(]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T06:43:43.683

如果您使用 svn+ssh 协议来访问您的 SVN 存储库，那么您可以使用 SSH 密钥和 ssh-agent 来管理握手，因此您不需要涉及密码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T06:48:55.043

**linuxbashscript.sh**

```
svn up /path/to/local/copy
tar -cf backup.tar /path/to/local/copy
scp backup.tar user@192.1.1.1:/path/on/remote/host 
```

甚至更好的用户 svn export 将排除所有 .svn 目录。

```
svn export /path/to/repo /path/to/exported
tar -cf backup.tar /path/to/local/copy
scp backup.tar user@192.1.1.1:/path/on/remote/host 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T06:44:38.987

我个人会使用 ANT 来完成所有这些任务，然后您可以根据需要调用您的 ant 脚本。Ant 为 svn 和 scp 以及许多其他构建自动化类型的任务预先配置了任务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-22T08:11:12.837

如果（像 Dave 建议的那样）您将使用 Ant，您将拥有以下任务：

*   [SvnAnt](http://subclipse.tigris.org/svnant.html)进行签出、签入以及介于两者之间的所有事情
*   [Ant TAR](http://ant.apache.org/manual/Tasks/tar.html)任务创建存档
*   [Ant SCP](http://ant.apache.org/manual/Tasks/scp.html)任务发布它

如果您担心安全性，可以将密码保存到单独的属性文件中。

# c - C 错误（初学者）

> ID：609447
> 
> 赞同：4
> 
> 时间：2009-03-04T06:31:45.100
> 
> 标签：c

```
#include <stdio.h>

main(void) {
file *file = fopen("words.txt","r") 
if(file != null) {
    char line[128];
    while(fgets( line, sizeof line, file) != null) 
    {
    fputs ( line, stdout );
    }
    fclose ( file );
    }
} 
```

这是我的代码。我试图读取文件并输出内容。但这给了我错误代码

```
main.c: In function 'main':
main.c:4: error: 'file' undeclared (first use in this function)
main.c:4: error: (Each undeclared identifier is reported only once
main.c:4: error: for each function it appears in.)
main.c:5: error: parse error before "if"
main.c:7: error: 'line' undeclared (first use in this function)
main.c:7: error: 'null' undeclared (first use in this function)
main.c: At top level:
main.c:13: error: parse error before '}' token
main.c:13:2 warning: no newline at end of file 
```

我该如何解决这个错误。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-04T06:37:06.070

FILE 和 NULL 写错了（C 区分大小写）。fopen 行缺少分号。

下面的代码编译并运行。

```
#include <stdio.h>

main(void) {
FILE *file = fopen("words.txt","r"); 
if(file != NULL) {
    char line[128];
    while(fgets( line, sizeof line, file) != NULL) 
    {
    fputs ( line, stdout );
    }
    fclose ( file );
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T06:45:57.330

以下工作正常，并在函数调用和定义以及循环/ifs 中使用一致的大括号和空格进行了清理。如果这是您从标签中的意图，它也可以在 C 中工作，如果文件无法打开，则打印错误并返回 1。

```
#include <stdio.h>
#include <errno.h>

int main (void) {
    char line[128];
    FILE *file = fopen ("words.txt", "r");
    if (file != NULL) {
        while (fgets (line, sizeof line, file) != NULL) {
            fputs (line, stdout);
        }
        fclose (file);
    } else {
        fprintf (stderr, "Cannot open 'words.txt', error = %d\n", errno);
        return 1;
    }
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T06:45:23.990

除了已经指出的其他内容之外，您的`main()`函数应该被指定为返回一个`int`并且应该在最后明确地这样做。另外，我不太了解您的缩进和括号样式。

```
#include <stdio.h>

int main(void)
{
  FILE *file = fopen("words.txt","r"); 
  if(file != NULL)
  {
    char line[128];
    while(fgets( line, sizeof line, file) != NULL) 
    {
      fputs ( line, stdout );
    }
    fclose ( file );
  }
  return 0;
} 
```

或者，如果文件未打开，您可以创建它`return 1;`（错误代码在 UNIX 上通常为非零）：

```
#include <stdio.h>

int main(void)
{
  FILE *file = fopen("words.txt","r"); 
  if(file != NULL)
  {
    char line[128];
    while(fgets( line, sizeof line, file) != NULL) 
    {
      fputs ( line, stdout );
    }
    fclose ( file );
    return 0;
  }
  else
  {
    return 1;
  }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-04T06:35:24.467

尝试大写`FILE`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T06:36:12.627

*   文件应在第 4 行开头大写
*   第 4 行末尾缺少分号，导致第 5 行出现解析问题

编辑了两次，因为我在编辑上错了。哎呀。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T06:38:21.810

文件类型在 stdio.h 中定义，并且必须是全大写 (FILE)。犯简单的错误。

# sql-server-2005 - Sql Server 客户端协议

> ID：609455
> 
> 赞同：2
> 
> 时间：2009-03-04T06:36:18.367
> 
> 标签：sql-server-2005, network-protocols

SQL Server 客户端协议中的 VIA 协议是什么？

更准确地说，VIA 代表什么？

是芯片制造商威盛的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T07:06:35.657

从 Google 图书上的 [SQL Server 2005 管理开始：](http://books.google.com.au/books?id=TVVLWLJtpIUC&pg=PA236&lpg=PA236&dq=via+protocol+sql+server&source=bl&ots=x62NmzAs1C&sig=N0KsRpIUQ4HH5MxWgcr5LPuwG20&hl=en&ei=viOuScKPPIG86gOEhYzgBQ&sa=X&oi=book_result&resnum=7&ct=result)

> 威盛协议用于支持威盛设备，例如威盛存储区域网络设备。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T10:50:58.400

从以下MSDN 论坛上的[SQL 数据访问论坛](http://social.msdn.microsoft.com/forums/en-US/sqldataaccess/thread/3ef32b96-ecd7-40d9-95fd-dc6d4bccef45/#)线程：

***虚拟接口适配器 (VIA) - 一种适用于 VIA 硬件的协议。这是一个专门的协议；配置详细信息可从您的硬件供应商处获得。***

有一个关于它的[维基百科](http://en.wikipedia.org/wiki/Virtual_Interface_Adapter)条目，但它也只是一个存根。

# apache-flex - Flex：如何在运行时调整和移动组件？

> ID：609456
> 
> 赞同：0
> 
> 时间：2009-03-04T06:36:57.723
> 
> 标签：apache-flex, resize, move

请，任何人都可以指导我如何做这些事情。

我有一个面板和一个框，面板是我的组件面板（内部组件面板是例如图像、文本区域、视频），框是我创建组件的目标框。用户可以选择他/她想要创建的组件（动态创建）并将其拖动到目标 Box（拖放事件）。然后在创建组件后，用户可以拖动他/她创建的组件并将其放置在目标 Box 上的任何位置，并且用户还可以调整他/她创建的组件的大小（运行时调整大小）。

我有这个用于拖放的代码，似乎这个代码只适用于图像

```
//-----action script-----//
        private function dragIt(event:MouseEvent, value: String, objParent: String, objName: String):void 
        {           
            var dragInitiator:Image = event.currentTarget as Image;    
            var dragSource:DragSource = new DragSource();

            dragSource.addData(value,'value');
            dragSource.addData(objParent, 'parent');
            dragSource.addData(objName, 'objname'); 

            var dragProxy:Image = new Image();
            dragProxy.source = event.currentTarget.source;

            DragManager.doDrag(dragInitiator, dragSource, event, dragProxy);
        }

        private function dragEnterHandler(event:DragEvent):void 
        {
            var dropTarget:Box=event.currentTarget as Box;
            dropTarget.setStyle("borderThickness", 5);
            DragManager.acceptDragDrop(dropTarget);
        }

        private function dragExitHandler(event:DragEvent):void
        {
            var dropTarget:Box=event.currentTarget as Box;                
            revertBoxBorder();                
        }     

        private function revertBoxBorder():void
        {
            targetBox.setStyle("borderThickness", 1);                
        }

        private function dragDropHandler(event:DragEvent):void 
        {
            var value:String = event.dragSource.dataForFormat('value') as String;
            var objParent:String = event.dragSource.dataForFormat('parent') as String;
            if(value == "mp3")
            {
             //do something     
            }
            else if (value == "image")
            {
                if (objParent == "panel")
                {
                    var imgView: Image = new Image;                 
                    imgView.x = event.stageX;
                    imgView.y = event.stageY;

                    addChild(imgView);
                    imgView.name = String(getChildByName(imgView.name).parent.numChildren-1);     
                    imgView.addEventListener(MouseEvent.MOUSE_MOVE,  function(e:MouseEvent):void 
                    {
                    dragIt(e, value, 'box', Image(e.target).name);
                });
                    imgView.source = ImgInsert;
                }
                else
                {
                    var objName:String = event.dragSource.dataForFormat('objname') as String;
                    getChildByName(objName).parent.getChildAt(int(objName)).x = event.stageX;
                    getChildByName(objName).parent.getChildAt(int(objName)).y = event.stageY;
                }

            }
            else if (value == "textarea")
            {
                //do something                  
            }

        }

//-----mxml code------//
<mx:Panel x="0" y="37" width="91" height="417" layout="absolute" title="Component" borderColor="#8DA5AB" color="#345860" borderStyle="outset">
    <mx:Image x="7" y="43" width="21" height="18" source="{TxtAreaInsert}" mouseMove="dragIt(event,'textarea','panel','')"/>
    <mx:Image x="36" y="43" width="21" height="18" source="{ImgInsert}" mouseMove="dragIt(event,'image','panel','')"/>
    <mx:Image x="36" y="80" width="21" height="18" source="{Mp3Insert}" mouseMove="dragIt(event,'mp3','panel','')"/>
    <mx:Image x="7" y="80" width="21" height="18" source="{VdoInsert}" mouseMove="dragIt(event,'video','panel','')"/>
</mx:Panel>
<mx:Box id="targetBox" y="37" width="589" height="417" borderColor="#8CC2E8" backgroundColor="#D5DBEE"
    dragExit="dragExitHandler(event)" dragEnter="dragEnterHandler(event)" dragDrop="dragDropHandler(event)" left="99">
</mx:Box>; 
```

如何移动像 TxtArea 这样的非图像组件？如何调整目标框内的组件大小？（这就像创建组件时 flex 的 GUI）谢谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T07:06:12.803

查看[Rogue-Development.com 的 Object Handles](http://www.rogue-development.com/objectHandles.html)我已经成功地使用它来移动/调整组件大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-27T05:51:04.453

也可以试试[Pantaste 库](http://blog.comtaste.com/2009/06/example_of_implementation_of_t_1.html)，它比 Object Handles 复杂得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-16T16:19:28.903

如果需要，请转到[http://sourceforge.net/projects/tcycomponents/并下载包和演示。](http://sourceforge.net/projects/tcycomponents/)

使用 TcyReziser 组件可以像 Delphi 2009 那样轻松移动/调整大小！

问候，毛里西奥

# sifr - sifr 替代文本始终显示

> ID：609466
> 
> 赞同：0
> 
> 时间：2009-03-04T06:41:39.710
> 
> 标签：sifr

使用 sifr3-r436。的第一页加载似乎很好。重新加载页面和 sifr-alternate 文本始终显示导致双标题、一个 Flash 文本和一个 HTML。有任何想法吗？

请在此处查看示例：http: [//v3.kevincarrollkatalyst.com/blog/](http://v3.kevincarrollkatalyst.com/blog/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T19:13:08.593

这是某种 CSS 问题。将 sifr css 属性滚动到我的屏幕并打印样式表解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-26T10:58:37.650

很可能是您的 SIFR 样式表未正确加载。请确保路径正确：

# jquery - Jquery UI-调整对话框大小时覆盖不调整大小

> ID：609469
> 
> 赞同：0
> 
> 时间：2009-03-04T06:43:19.940
> 
> 标签：jquery, jquery-ui, modal-dialog

使用 Jquery 打开一个对话框（使用 modal:true），其中包含一个表单。现在我根据用户在表单上所做的选择从表单中删除一些元素。这会调整对话框的大小，但不会调整覆盖层的大小。留下一个影子。调整对话框大小时，有没有办法调整叠加层的大小？

下面是一些代码

```
//fadeout() some components on page based on choices made by user.
        if(selectedVal == 1){
            $("#modify_task_window").fadeIn();
            $("#modify_tag_window").fadeIn();
            $("#task_help_text").fadeIn();
        }else{
            $("#modify_task_window").fadeOut();
            $("#modify_tag_window").fadeOut();
            $("#task_help_text").fadeOut(); 
```

现在，在此之后`fadeOut()`，对话框被调整大小，但覆盖没有被调整大小。留下一个影子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T16:50:25.893

得到了答案。我只是将阴影的不透明度设置为零。这解决了问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T12:56:08.050

触发窗口调整大小事件。叠加层将随之调整大小。$(window).trigger('resize')

# mysql - 应用程序如何收集统计信息？

> ID：609474
> 
> 赞同：2
> 
> 时间：2009-03-04T06:45:20.950
> 
> 标签：mysql, statistics, storage

我需要从用 python 编写的服务器应用程序收集统计信息。我正在寻找一些关于如何设置模型以及如何存储统计信息的一般指导。我正在考虑在数据库中存储和组织所有这些信息，但我的实现变得过于具体。

我需要随着时间的推移收集活跃用户、处理的请求等统计数据。

是否有任何指南或技术可以创建一些更通用的统计存储系统？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T07:05:01.307

像大多数软件解决方案一样，我可以推荐没有一种解决方案可以解决您的问题。但是我已经创建了一些类似的程序，这里有一些我发现效果很好的东西。

*   创建一个异步日志服务，以便日志不会对代码的性能产生不利影响。（您需要注意存储数据的位置、处理数据的位置等，因为如果不小心，仍然会显着降低性能。）我发现创建 Web 服务通常很方便。
*   尝试并尽可能多地保存有关请求的信息。将来，这将使添加新查询和报告变得更加容易。
    *   [规范化](http://en.wikipedia.org/wiki/Database_normalization)您的数据
    *   始终包括执行操作的时间。如果您可以捕获它通常也有用的运行时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T07:04:18.487

一种方法是分阶段进行：将活动日志（包括请求和用户）存储为文本文件。稍后，将日志挖掘成数据点（python 应该能够轻松做到这一点）。您可能希望将[python 的日志库用于](http://docs.python.org/library/logging.html)日志记录阶段。一般来说，从高时间分辨率的日志记录开始，您可以稍后将其汇总为每小时、每天、每周摘要等。

# ruby-on-rails - Rails：在 ApplicationController 中，它们是默认呈现 xml 的吗？

> ID：609478
> 
> 赞同：1
> 
> 时间：2009-03-04T06:47:38.307
> 
> 标签：ruby-on-rails

我希望能够同时呈现 html 和 xml。默认情况下会呈现 html，除非我们添加格式，例如 /myresource.xml。我想默认呈现 xml 并且只响应 .html 格式：

GET /myresource/ 返回 html

GET /myresource.xml 返回 xml

我想：

GET /myresource/ 返回 xml

GET /myresource.html 返回 html

有没有简单的方法来实现这一目标？

问候，

克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T23:57:47.707

由于 Rails 中的这种非标准，最好通过`mod_rewrite`Apache 来解决。映射`/whatever`到`/whatever.xml`和映射`/whatever.html`到`/whatever`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-15T19:12:30.603

如果您想在控制器级别控制它，您可以执行以下操作（在 ApplicationController 或 MyResourceController 中）

```
类 MyResourceController（或 ApplicationController）< ApplicationController
  before_filter :change_format

  ...

  受保护
  def change_format
    params[:format] = 'xml' 如果 params[:format].blank?
  结尾
结尾

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T07:23:01.467

尝试添加`:format => 'xml'`到您的资源定义中，尽管我不确定 restfull 的东西应该以这种方式工作

# iphone - iPhone Development Provisioning Assistant Step 3 公钥/私钥问题

> ID：609486
> 
> 赞同：3
> 
> 时间：2009-03-04T06:51:35.130
> 
> 标签：iphone, provisioning

嗨，我正在使用开发配置助手

在第 3 步：在 Keychain Access 中验证您的私钥和公钥，我在 Keychains->login 中有“iPhone Developer: XXXXXXX”证书，但我找不到任何密钥。如果我单击类别-> 键，我什么也看不到。

我应该怎么做才能让它在那里有私钥和公钥？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T07:19:09.900

当您使用钥匙串访问创建“从证书颁发机构请求证书”时，应生成密钥。应该是先一步。

登录“iPhone Developer Program Portal”后，下载并阅读右侧的“Program Portal User Guide”。遵循该指南可以解决很多问题。

# design-patterns - 枚举 vs 查找表 vs 枚举反射 vs 状态模式

> ID：609487
> 
> 赞同：6
> 
> 时间：2009-03-04T06:52:43.850
> 
> 标签：design-patterns, reflection, enums, state-pattern

我将要构建的软件将涉及很多不同状态之间的“应用程序”切换。可以完成的某些任务取决于应用程序所处的状态。我正在考虑使用枚举作为状态

```
public class Application
{
  public int Id {get;set;}
  public Status {get;set;}
}
public enum Status
{
  [Description("New")]New = 1, [Description("Closed")]Closed = 2
} 
```

但是后来我想在数据库中使用查找表可能会很好，因为状态确实会经常更新/重新排序

```
table status (id int pk, desc string, sort_order int)
table application (id int pk, status_id int fk) 
```

就我而言，我需要做类似的事情

```
if (application.Status == Status.New)
{ //do something }
else if (application.Status == Status.Closed)
{ //do other things } 
```

我认为使用枚举更容易实现上述情况。但是，当涉及到更新状态排序顺序或描述时，它会非常困难。

我应该使用反射根据查找表中的值动态创建枚举吗？或者我应该使用状态模式？我看到枚举相关的问题是性能影响。而状态模式会产生大量的冗余代码。

你怎么看？提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-04T07:08:38.943

你不应该在任何地方都用这个检查来洒你的代码

```
if (application.Status == Status.New)
{ //do something }
else if (application.Status == Status.Closed)
{ //do other things } 
```

相反，使用状态模式。每当应用程序的模式发生变化时更改状态并将所有调用转发到状态的方法。您将拥有更清洁、更易于维护的代码。

至于改变状态，与状态模式无关。因此，您可以使用任何优雅的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T07:07:06.280

我会创建一个包含差异的 Status 类，然后调用它们。所以（在 ​​Python 中）：

```
class StatusZero(object):
    def call_me(self, app):
       print 'Hello, from ' + app.name
       return db.prepare_specific_status_zero_request()

class StatusOne(object):
    def call_me(self, app):
        print 'Hi, from ' + app.name
        return db.prepare_specific_status_one_request()

states = { 'status_zero' : StatusZero(), 'status_one' : StatusOne() }

class Application(object):
    name = 'My App'
    status = states['status_zero']

    def change_state(self, state):
        status = state

    def call_me(self):
        state_key = self.status.call_me(self)
        self.change_state(states[state_key]) 
```

快速、易于保持功能分区，并且在状态之间具有合理的继承模式，您可以共享没有区别的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T09:51:11.940

我的理解是状态模式非常适合仅 UI 或仅内存执行，在我的情况下，当从应用程序表中检索数据时，仍然需要 if else 语句来确定要转换到的对象。

```
public AbstractApplication convert_db_application_to_object(obj db_application)
{
   AbstractApplication app;
   if (db_application.Status == (int)Status.New)
      app = application_factory.create(application_state_new);
   else if(db_application.Status == (int)Status.Closed)
      app = application_factory.create(application_state_closed);

   return app;
} 
```

我不认为这是一个优雅的解决方案，因为我仍然需要一个枚举或查找表来将应用程序状态保存到数据库中

# java - 在 JTable 单元格中显示时间计数器的有效方法

> ID：609492
> 
> 赞同：0
> 
> 时间：2009-03-04T06:57:14.073
> 
> 标签：java, swing, jtable

时间计数器以秒为单位显示表中一行的年龄。理想情况下，它将每秒更新一次。我知道我可以在表模型中增加适当的数据，触发事件（每行一个）等。这似乎有点矫枉过正！有没有更好、更轻便的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T10:15:04.987

你需要的是：

*   一种在表格模型中对行的“年龄”进行建模的方法。这最好隐式完成，因此您只需存储一次行的创建时间并计算请求单元格值时的年龄（Object getValueAt(row, column)）。
*   每秒触发表更改事件的（守护程序）线程。您不必每行触发一个事件，而是可以触发一个指示整列更新的事件。

这是表模型的一些伪代码：

```
public Object getValueAt (int rowIndex, int columnIndex) {

    // if it's the column with the 'row age', calculate the age and return it
    long rowAgeMs = System.currentTimeMs() - getCreationTime(rowIndex);

   // return the age in milliseconds, or a date, or a formatted time string 
} 
```

然后，表模型还应该为线程提供一个方法，因此它可以为“行年龄”列触发一个更改事件：

公共类 MyTableModel 实现 TableModel {

```
 private final List<TableModelListener> listeners = new LinkedList<TableModelListener>();

   public void addTableModelListener (TableModelListener l) {
          listeners.add(l);
   }

   public void removeTableModelListener (TableModelListener l) {
          listeners.remove(l);
   }

   public void updateColumn (int column) {
          TableModelEvent evt = new TableModelEvent(this, 0, Math.max(0, getRowCount() - 1), column);
          for (TableModelListener listener : listeners) {
                 listener.tableChanged(evt);
          }
   } 
```

然后，该线程将每秒为“行年龄”列触发 updateColumn(..) 方法。该方法的调用应该在 EventDispatchThread 中完成，这是使用 SwingUtilities.invokeAndWait(..) 或 SwingUtilities.invokeLater(..) 完成的。

```
Thread rowAgeUpdater = new Thread() {

        @Override
        public void run () {
            while (isAlive()) {
                try {

                    long time = System.currentTimeMillis();
                    long sleepTime = (time / 1000 + 1) * 1000 - time;
                    Thread.sleep(sleepTime);

                    SwingUtilities.invokeAndWait(new Runnable() {
                        public void run () {
                            model.updateColumn(ROW_AGE_COLUMN_INDEX);
                        }
                    });

                } catch (Exception e) {
                    return;
                }

            }
        }
    };
    rowAgeUpdater.setDaemon(true);
    rowAgeUpdater.setPriority(Thread.MIN_PRIORITY);
    rowAgeUpdater.start(); 
```

只要 TableModelEvent 的粒度仅涵盖需要更新的单元格（在您的情况下：仅具有行龄的列），这是实现这一点的最有效方法。

# tfs - 如何从自定义任务中获取 MSBuild 属性的值？

> ID：609498
> 
> 赞同：5
> 
> 时间：2009-03-04T07:00:52.660
> 
> 标签：tfs, msbuild, properties

有没有办法从自定义任务中访问 MSBuild 属性的值？

我知道我可以将它们全部发送，但最好不要:) 我正在尝试从[TFS](http://en.wikipedia.org/wiki/Team_Foundation_Server)构建中执行此操作。

或者有什么方法可以访问当前正在运行的“构建脚本”？也许像一个对象模型并从那里得到我需要的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T08:24:25.360

这应该可以完成这项工作。

```
 public override bool Execute()
  {
    string projectFile = BuildEngine.ProjectFileOfTaskNode;

    Engine buildEngine = new Engine(System.Runtime.InteropServices.RuntimeEnvironment.GetRuntimeDirectory());

    Project project = new Project(buildEngine);
    project.Load(projectFile);
    foreach(var o in project.EvaluatedProperties)
    {
      // Use properties
    }

    return true;
  } 
```

# domain-driven-design - 处理贫血域模型的技术

> ID：609499
> 
> 赞同：20
> 
> 时间：2009-03-04T07:00:58.213
> 
> 标签：domain-driven-design, business-logic

我已经阅读了一些关于贫血域模型和关注点分离的问题。在贫血的域对象上执行/附加域逻辑的最佳技术是什么？在我的工作中，我们有一个非常贫乏的模型，我们目前正在使用“帮助器”类来在域对象上执行数据库/业务逻辑。例如：

```
public class Customer
{
    public string Name {get;set;}
    public string Address {get;set;}
}

public class Product
{
    public string Name {get;set;}
    public decimal Price {get;set;}
}

public class StoreHelper
{
    public void PurchaseProduct(Customer c, Product p)
    {
         // Lookup Customer and Product in db
         // Create records for purchase
         // etc.
    }
} 
```

当应用程序需要进行购买时，它会创建 StoreHelper，并调用域对象上的方法。对我来说，客户/产品知道如何将自己保存到存储库是有意义的，但您可能不希望域对象上的 Save() 方法。对于像 Customer.Purchase(Product) 这样的方法也很有意义，但这会将域逻辑放在实体上。

以下是我遇到的一些技术，不确定哪些是好/坏：

1.  Customer 和 Product 继承自“Entity”类，该类以通用方式提供基本的 CRUD 操作（可能使用 ORM）。
    *   优点：每个数据对象都会自动获取 CRUD 操作，但随后会绑定到数据库/ORM
    *   缺点：这并没有解决对象上的业务操作问题，并且还将所有域对象绑定到可能不合适的基本实体
2.  使用帮助类来处理 CRUD 操作和业务逻辑
    *   将 DAO 用于“纯数据库”操作是否有意义，而将业务助手用于更特定于业务的操作是否有意义？
    *   为此使用非静态或静态辅助类更好吗？
    *   优点：领域对象不依赖于任何数据库/业务逻辑（完全贫乏）
    *   缺点：不是很面向对象，在应用程序代码中使用助手不是很自然（看起来像 C 代码）
3.  使用 Double Dispatch 技术，其中实体具有保存到任意存储库的方法
    *   优点：更好的关注点分离
    *   缺点：实体附加了一些额外的逻辑（尽管它是解耦的）
4.  在 C# 3.0 中，您可以使用扩展方法将 CRUD/业务方法附加到域对象而不接触它
    *   这是一种有效的方法吗？什么是优点/缺点？
5.  其他技术？

处理此问题的最佳技术是什么？我对 DDD 很陌生（我正在阅读 Evans 的书——所以也许这会让我大开眼界）

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-21T13:46:04.607

为了避免贫血模型，重构你的助手类：

类似的逻辑：
“Customer.PurchaseProduct(Product product, Payment payment)”、
“Customer.KillCustomer(Person killer, Weapon weapon)”
应该存在于“Customer”域对象中。

像这样的逻辑：
“Customer.IsCustomerAlive()”
“Customer.IsCustomerHappy()”
应该去规范。

像这样的逻辑：
“Customer.Create()”、
“Customer.Update()”
显然应该去存储库。

像这样的逻辑：
“Customer.SerializeInXml()”
“Customer.GetSerializedCustomerSizeInBytes()”
应该去服务。

复杂的构造器应该去工厂。

我就是这么看的。如果有人能评论我对 DDD 方法的理解，我会很高兴。

* * *

**编辑：**

[有时，不应该避免](http://www.lostechies.com/blogs/jimmy_bogard/archive/2009/12/03/persistence-model-and-domain-anemia.aspx)贫血的领域模型。

编辑了我的答案以添加 DDD 不是关于拾取和删除模式。
DDD 是关于我们的思考方式。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-07T08:13:37.983

Martin Fowler 写了很多关于领域模型的文章，包括[贫血领域模型](http://martinfowler.com/bliki/AnemicDomainModel.html)。他还对可能有用的领域模型和数据库的许多设计模式进行了简要描述（和 UML 类图）：[“企业应用程序体系结构模式”目录](http://martinfowler.com/eaaCatalog/)。

我建议查看[Active Record](http://martinfowler.com/eaaCatalog/activeRecord.html)和[Data Mapper](http://martinfowler.com/eaaCatalog/dataMapper.html)模式。从您的问题的描述中，听起来您的帮助类包含域/业务规则*和*数据库实现细节。

Active Record 会将助手的域逻辑和数据库代码移动到其他域对象（如您的`Entity`基类）中。数据映射器会将助手的域逻辑移动到域对象中，并将数据库代码移动到单独的映射对象中。这两种方法都比过程式辅助类更面向对象。

Eric Evans 的“领域驱动设计”一书非常出色。它有点干，但绝对值得。InfoQ 有一本[“Domain Driven Design Quickly”迷你书](http://www.infoq.com/minibooks/domain-driven-design-quickly)，它很好地介绍了 Evans 的书。此外，“快速领域驱动设计”以免费 PDF 格式提供。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T09:12:49.190

我一直认为贫血域模型是一种反模式。很明显，客户将购买产品，这种能力可以通过接口实现来生成

```
Interface IPurchase
      Purchase(Product); 
```

，因此您的任何域对象都可以根据需要实现它。通过这种方式，您可以将功能引入您的域对象 - 这正是它应该在的地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-19T10:19:08.613

您没有提到的一种方法是使用 AOP 来处理您的数据访问。我最近使用这种方法的一个例子（尽管为了发布目的而大大简化）是我有一个`Account`域实体，它有一个`debit`方法，封装了从帐户中成功借记所需的业务逻辑。

*注意所有代码都是带有 AspectJ AOP 表示法的 Java...*

```
public boolean debit(int amount) {
    if (balance - amount >= 0) {
        balance = balance - amount;
        return true;
    }
    return false;
} 
```

将适当的存储库注入到我的方面，然后我使用切入点来拦截对此方法的调用......

```
pointcut debit(Account account,int amount) :
    execution(boolean Account.debit(int)) &&
    args(amount) &&
    target(account); 
```

...并应用了一些建议：

```
after(Account account, int amount) returning (boolean result)  : debit(account,amount) {
    if (result) getAccountRepository().debit(account, amount);
} 
```

在我看来，这很好地分离了关注点，并允许您的域实体完全专注于应用程序的业务逻辑。

# c# - 在 C# 中生成随机小数

> ID：609501
> 
> 赞同：69
> 
> 时间：2009-03-04T07:02:02.877
> 
> 标签：c#, .net, random, decimal

我怎样才能得到一个随机的 System.Decimal？`System.Random`不直接支持。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-03-04T07:12:23.413

编辑：删除旧版本

这类似于 Daniel 的版本，但会给出完整的范围。它还引入了一种新的扩展方法来获取随机的“任意整数”值，我认为这很方便。

请注意，这里的小数分布**并不均匀**。

```
/// <summary>
/// Returns an Int32 with a random value across the entire range of
/// possible values.
/// </summary>
public static int NextInt32(this Random rng)
{
     int firstBits = rng.Next(0, 1 << 4) << 28;
     int lastBits = rng.Next(0, 1 << 28);
     return firstBits | lastBits;
}

public static decimal NextDecimal(this Random rng)
{
     byte scale = (byte) rng.Next(29);
     bool sign = rng.Next(2) == 1;
     return new decimal(rng.NextInt32(), 
                        rng.NextInt32(),
                        rng.NextInt32(),
                        sign,
                        scale);
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-03-04T11:50:53.773

您通常会期望随机数生成器不仅生成随机数，而且这些数字是均匀随机生成的。

均匀随机有两种定义：[离散均匀随机](http://en.wikipedia.org/wiki/Uniform_distribution_%28discrete%29)和[连续均匀随机](http://en.wikipedia.org/wiki/Uniform_distribution_(continuous))。

对于具有有限数量的不同可能结果的随机数生成器，离散均匀随机是有意义的。例如生成一个介于 1 和 10 之间的整数。然后您会期望得到 4 的概率与得到 7 的概率相同。

当随机数生成器生成一个范围内的数字时，连续均匀随机是有意义的。例如，生成器生成 0 到 1 之间的实数。然后您会期望得到 0 到 0.5 之间的数字的概率与得到 0.5 到 1 之间的数字的概率相同。

当随机数生成器生成浮点数（这基本上是 System.Decimal - 它只是以 10 为底的浮点数）时，统一随机的正确定义是有争议的：

一方面，由于浮点数在计算机中由固定数量的位表示，显然存在有限数量的可能结果。因此有人可能会争辩说，正确的分布是离散的连续分布，每个可表示的数字具有相同的概率。这基本上就是[Jon Skeet](https://stackoverflow.com/questions/609501/generating-a-random-decimal-in-c/609529#609529)和[John Leidegren 的](https://stackoverflow.com/questions/609501/generating-a-random-decimal-in-c/609569#609569)实现所做的。

另一方面，有人可能会争辩说，由于浮点数应该是实数的近似值，我们最好尝试近似连续随机数生成器的行为——即使实际的 RNG 是实际上是离散的。这是您从 Random.NextDouble() 获得的行为，其中 - 即使 0.00001-0.00002 范围内的可表示数字与 0.8-0.9 范围内的可表示数字一样多，您获得第二个范围内的数字 - 正如您所期望的那样。

因此 Random.NextDecimal() 的正确实现可能应该是连续均匀分布的。

这是 Jon Skeet 答案的一个简单变体，它均匀分布在 0 和 1 之间（我重用了他的 NextInt32() 扩展方法）：

```
public static decimal NextDecimal(this Random rng)
{
     return new decimal(rng.NextInt32(), 
                        rng.NextInt32(),
                        rng.Next(0x204FCE5E),
                        false,
                        0);
} 
```

您还可以讨论如何在整个小数范围内获得均匀分布。可能有一种更简单的方法可以做到这一点，但是对[John Leidegren 答案的](https://stackoverflow.com/questions/609501/random-decimal-in-c/609569#609569)这种轻微修改应该会产生一个相对均匀的分布：

```
private static int GetDecimalScale(Random r)
{
  for(int i=0;i<=28;i++){
    if(r.NextDouble() >= 0.1)
      return i;
  }
  return 0;
}

public static decimal NextDecimal(this Random r)
{
    var s = GetDecimalScale(r);
    var a = (int)(uint.MaxValue * r.NextDouble());
    var b = (int)(uint.MaxValue * r.NextDouble());
    var c = (int)(uint.MaxValue * r.NextDouble());
    var n = r.NextDouble() >= 0.5;
    return new Decimal(a, b, c, n, s);
} 
```

基本上，我们确保比例值的选择与相应范围的大小成比例。

这意味着我们应该得到 0 90% 的时间比例 - 因为该范围包含 90% 的可能范围 - 1 9% 的时间比例等等。

实现仍然存在一些问题，因为它没有考虑到某些数字具有多种表示形式 - 但它应该比其他实现更接近均匀分布。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-03-04T17:15:41.543

我知道这是一个老问题，但是[Rasmus Faber 描述的分发问题](https://stackoverflow.com/a/610228/3344334)一直困扰着我，所以我想出了以下问题。我没有深入研究[Jon Skeet 提供的 NextInt32 实现，我假设（希望）它与](https://stackoverflow.com/a/609529/3344334)[Random.Next()](https://msdn.microsoft.com/en-us/library/9b3ta19y.aspx)具有相同的分布。

```
//Provides a random decimal value in the range [0.0000000000000000000000000000, 0.9999999999999999999999999999) with (theoretical) uniform and discrete distribution.
public static decimal NextDecimalSample(this Random random)
{
    var sample = 1m;
    //After ~200 million tries this never took more than one attempt but it is possible to generate combinations of a, b, and c with the approach below resulting in a sample >= 1.
    while (sample >= 1)
    {
        var a = random.NextInt32();
        var b = random.NextInt32();
        //The high bits of 0.9999999999999999999999999999m are 542101086.
        var c = random.Next(542101087);
        sample = new Decimal(a, b, c, false, 28);
    }
    return sample;
}

public static decimal NextDecimal(this Random random)
{
    return NextDecimal(random, decimal.MaxValue);
}

public static decimal NextDecimal(this Random random, decimal maxValue)
{
    return NextDecimal(random, decimal.Zero, maxValue);
}

public static decimal NextDecimal(this Random random, decimal minValue, decimal maxValue)
{
    var nextDecimalSample = NextDecimalSample(random);
    return maxValue * nextDecimalSample + minValue * (1 - nextDecimalSample);
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-04-06T14:52:53.050

通过简单的东西的力量，它也可以做到：

```
var rand = new Random();
var item = new decimal(rand.NextDouble()); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-09-12T12:22:42.760

这是具有 Range 实现的 Decimal random 对我来说很好。

```
public static decimal NextDecimal(this Random rnd, decimal from, decimal to)
{
    byte fromScale = new System.Data.SqlTypes.SqlDecimal(from).Scale;
    byte toScale = new System.Data.SqlTypes.SqlDecimal(to).Scale;

    byte scale = (byte)(fromScale + toScale);
    if (scale > 28)
        scale = 28;

    decimal r = new decimal(rnd.Next(), rnd.Next(), rnd.Next(), false, scale);
    if (Math.Sign(from) == Math.Sign(to) || from == 0 || to == 0)
        return decimal.Remainder(r, to - from) + from;

    bool getFromNegativeRange = (double)from + rnd.NextDouble() * ((double)to - (double)from) < 0;
    return getFromNegativeRange ? decimal.Remainder(r, -from) + from : decimal.Remainder(r, to);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-04T07:03:40.093

我对此感到困惑。这是我能想到的最好的：

```
public class DecimalRandom : Random
    {
        public override decimal NextDecimal()
        {
            //The low 32 bits of a 96-bit integer. 
            int lo = this.Next(int.MinValue, int.MaxValue);
            //The middle 32 bits of a 96-bit integer. 
            int mid = this.Next(int.MinValue, int.MaxValue);
            //The high 32 bits of a 96-bit integer. 
            int hi = this.Next(int.MinValue, int.MaxValue);
            //The sign of the number; 1 is negative, 0 is positive. 
            bool isNegative = (this.Next(2) == 0);
            //A power of 10 ranging from 0 to 28\. 
            byte scale = Convert.ToByte(this.Next(29));

            Decimal randomDecimal = new Decimal(lo, mid, hi, isNegative, scale);

            return randomDecimal;
        }
    } 
```

编辑：如评论 lo、mid 和 hi 中所述，永远不能包含 int.MaxValue，因此不可能包含完整的小数范围。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-04T08:34:35.960

给你...使用 crypt 库生成几个随机字节，然后将它们转换为十进制值...[有关十进制构造函数，请参见 MSDN](http://msdn.microsoft.com/en-us/library/aa326746(VS.71).aspx)

```
using System.Security.Cryptography;

public static decimal Next(decimal max)
{
    // Create a int array to hold the random values.
    Byte[] randomNumber = new Byte[] { 0,0 };

    RNGCryptoServiceProvider Gen = new RNGCryptoServiceProvider();

    // Fill the array with a random value.
    Gen.GetBytes(randomNumber);

    // convert the bytes to a decimal
    return new decimal(new int[] 
    { 
               0,                   // not used, must be 0
               randomNumber[0] % 29,// must be between 0 and 28
               0,                   // not used, must be 0
               randomNumber[1] % 2  // sign --> 0 == positive, 1 == negative
    } ) % (max+1);
} 
```

*修改为使用不同的十进制构造函数以提供更好的数字范围*

```
public static decimal Next(decimal max)
{
    // Create a int array to hold the random values.
    Byte[] bytes= new Byte[] { 0,0,0,0 };

    RNGCryptoServiceProvider Gen = new RNGCryptoServiceProvider();

    // Fill the array with a random value.
    Gen.GetBytes(bytes);
    bytes[3] %= 29; // this must be between 0 and 28 (inclusive)
    decimal d = new decimal( (int)bytes[0], (int)bytes[1], (int)bytes[2], false, bytes[3]);

        return d % (max+1);
    } 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-01-23T18:12:17.373

由于 OP 问题非常具有包容性，并且只想要一个没有任何限制的随机 System.Decimal，因此下面是一个对我有用的非常简单的解决方案。

我不关心生成数字的任何类型的一致性或精度，所以如果你有一些限制，这里的其他答案可能会更好，但这个在简单的情况下工作正常。

```
Random rnd = new Random();
decimal val;
int decimal_places = 2;
val = Math.Round(new decimal(rnd.NextDouble()), decimal_places); 
```

在我的具体情况下，我正在寻找一个随机小数作为货币字符串，所以我的完整解决方案是：

```
string value;
value = val = Math.Round(new decimal(rnd.NextDouble()) * 1000,2).ToString("0.00", System.Globalization.CultureInfo.InvariantCulture); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-08-27T16:39:11.220

```
static decimal GetRandomDecimal()
    {

        int[] DataInts = new int[4];
        byte[] DataBytes = new byte[DataInts.Length * 4];

        // Use cryptographic random number generator to get 16 bytes random data
        RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider();

        do
        {
            rng.GetBytes(DataBytes);

            // Convert 16 bytes into 4 ints
            for (int index = 0; index < DataInts.Length; index++)
            {
                DataInts[index] = BitConverter.ToInt32(DataBytes, index * 4);
            }

            // Mask out all bits except sign bit 31 and scale bits 16 to 20 (value 0-31)
            DataInts[3] = DataInts[3] & (unchecked((int)2147483648u | 2031616));

          // Start over if scale > 28 to avoid bias 
        } while (((DataInts[3] & 1835008) == 1835008) && ((DataInts[3] & 196608) != 0));

        return new decimal(DataInts);
    }
    //end 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-02-05T01:40:57.477

查看以下链接以获取应有帮助的现成实现：

[MathNet.Numerics、随机数和概率分布](http://numerics.mathdotnet.com/docs/RandomAndDistributions.html)

广泛的分布特别令人感兴趣，它建立在直接从 System.Random 派生的随机数生成器（MersenneTwister 等）之上，所有这些都提供了方便的扩展方法（例如 NextFullRangeInt32、NextFullRangeInt64、NextDecimal 等）。当然，您可以只使用默认的 SystemRandomSource，它只是使用扩展方法修饰的 System.Random。

哦，如果需要，您可以将 RNG 实例创建为线程安全的。

确实很方便！

这是一个老问题，但对于那些刚刚阅读它的人来说，为什么要重新发明轮子呢？

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-11-22T06:57:04.063

老实说，我不相信 C# 小数的内部格式会像许多人认为的那样工作。出于这个原因，这里提出的至少一些解决方案可能无效或可能无法始终如一地工作。考虑以下 2 个数字以及它们如何以十进制格式存储：

```
0.999999999999999m
Sign: 00
96-bit integer: 00 00 00 00 FF 7F C6 A4 7E 8D 03 00
Scale: 0F 
```

和

```
0.9999999999999999999999999999m
Sign: 00
96-bit integer: 5E CE 4F 20 FF FF FF 0F 61 02 25 3E
Scale: 1C 
```

请特别注意比例如何不同，但两个值几乎相同，也就是说，它们都小于 1 仅一小部分。似乎是比例和位数有直接关系。除非我遗漏了什么，否则这应该会在大多数篡改小数的 96 位整数部分但保持比例不变的代码中使用活动扳手。

在实验中，我发现数字 0.9999999999999999999999999999m 有 28 个 9，在小数点前最大可能的 9 数将四舍五入到 1.0m。

进一步的实验证明，以下代码将变量“Dec”设置为值 0.9999999999999999999999999999m：

```
double DblH = 0.99999999999999d;
double DblL = 0.99999999999999d;
decimal Dec = (decimal)DblH + (decimal)DblL / 1E14m; 
```

正是从这个发现中，我提出了 Random 类的扩展，可以在下面的代码中看到。我相信这段代码功能齐全，工作状态良好，但很高兴其他人能检查它是否有错误。我不是统计学家，所以我不能说这段代码是否会产生真正均匀的小数分布，但如果我不得不猜测，我会说它没有完美但非常接近（如 51 万亿次中的 1 次支持一定范围的数字）。

第一个 NextDecimal() 函数应产生等于或大于 0.0m 且小于 1.0m 的值。do/while 语句通过循环防止 RandH 和 RandL 超过值 0.99999999999999d，直到它们低于该值。我相信这个循环重复的几率是 51 万亿分之一（强调相信这个词，我不相信我的数学）。这反过来应该防止函数将返回值四舍五入到 1.0m。

第二个 NextDecimal() 函数应该与 Random.Next() 函数一样工作，只是使用十进制值而不是整数。我实际上没有使用过第二个 NextDecimal() 函数，也没有测试过它。它相当简单，所以我认为我做对了，但我还没有测试过它——所以你需要在依赖它之前确保它正常工作。

```
public static class ExtensionMethods {
    public static decimal NextDecimal(this Random rng) {
        double RandH, RandL;
        do {
            RandH = rng.NextDouble();
            RandL = rng.NextDouble();
        } while((RandH > 0.99999999999999d) || (RandL > 0.99999999999999d));
        return (decimal)RandH + (decimal)RandL / 1E14m;
    }
    public static decimal NextDecimal(this Random rng, decimal minValue, decimal maxValue) {
        return rng.NextDecimal() * (maxValue - minValue) + minValue;
    }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-01-04T11:57:27.487

我想生成最多 9 位小数的“随机”小数。我的方法是只生成一个双精度数并将其除以小数。

```
int randomInt = rnd.Next(0, 100);

double randomDouble = rnd.Next(0, 999999999);
decimal randomDec = Convert.ToDecimal(randomint) + Convert.ToDecimal((randomDouble/1000000000)); 
```

“randomInt”是小数点前的数字，您可以只输入 0。要减少小数点，只需删除随机的“9”和除法的“0”

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2022-01-25T18:29:42.207

```
 public static decimal RandomDecimal()
    {
        int a = RandomNumber(2, 10);
        int b = RandomNumber(0, 99);

        string c = a + "." + b;
        decimal d = decimal.Parse(c);
        return d;
    }

    public static int RandomNumber(int min, int max)
    {
        return _random.Next(min, max);
    } 
```

# deployment - 禁用 clickonce 应用程序回滚

> ID：609509
> 
> 赞同：1
> 
> 时间：2009-03-04T07:06:57.200
> 
> 标签：deployment, clickonce

有没有办法在 clickonce 安装的应用程序中禁用回滚（获取以前的版本）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T07:55:34.667

打开项目的属性，切换到`Publish`选项卡并单击`Updates`按钮。弹出的对话框中有一个“此应用程序所需的最低版本”部分，它允许您强制用户升级到特定版本。

设置后，用户将无法回滚到以前的版本。如果他们运行的版本早于最低版本，他们也将被迫升级。

请注意，我没有尝试过，但这是我对“最低版本”功能的理解。

# python - pysqlite 用户类型在 select 语句中

> ID：609516
> 
> 赞同：1
> 
> 时间：2009-03-04T07:08:06.840
> 
> 标签：python, sqlite, pysqlite

使用 pysqlite 如何将用户定义类型用作比较中的值，例如。g：“... WHERE columnName > userType”？

例如，我定义了一个带有必要注册、转换器等的 bool 类型。Pysqlite/Sqlite 按预期响应 INSERT 和 SELECT 操作（bool 'True' 存储为整数 1 并返回为 True）。

但是，当布尔用于“SELECT * from tasks WHERE display = True”或“... WHERE display = 'True'”时，它会失败。“ 第一种情况 Sqlite 报错没有名为 True 的列。在第二种情况下，不返回任何记录。如果使用 1 代替 True，则选择有效。使用 pysqlite 自己的日期和时间戳适配器时，我似乎遇到了同样的问题。

我可以为这种和其他用户类型解决这种行为，但这并不那么有趣。我想知道是否可以在查询中使用用户定义的类型，这样我就不会一直把头撞在这个特定的墙上。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T17:27:33.887

使用将变量传递给查询的正确方法：**不要构建查询，使用问号并将参数作为元组传递给`execute()`.**

```
myvar = True
cur.execute('SELECT * FROM tasks WHERE display = ?', (myvar,)) 
```

这样 sqlite 驱动程序将直接使用该值。不再需要转义、引用、转换。

对每个参数使用这种技术，甚至是字符串、整数等。这样可以自动避免 SQL 注入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T14:17:11.893

您可能必须将其转换为正确的类型。尝试“SELECT * FROM tasks WHERE (display = CAST ('True' AS bool))”。

# css - 为什么是 em 而不是 px？

> ID：609517
> 
> 赞同：817
> 
> 时间：2009-03-04T07:08:11.910
> 
> 标签：css, units-of-measurement

我听说您应该在样式表中定义大小和距离，`em`而不是像素。所以问题是为什么我应该使用`em`而不是`px`在 CSS 中定义样式时？有没有一个很好的例子来说明这一点？

* * *

## 回答 #1

> 赞同：589
> 
> 时间：2009-03-04T07:24:55.050

说一个是比另一个更好的选择是错误的（或者两者都不会在规范中被赋予自己的目的）。甚至值得注意的是 StackOverflow 广泛使用 px 单位。这不是 Spoike 被告知的糟糕选择。

**单位的定义**

*   **px**是一个绝对测量单位（如*in*、*pt*或*cm*），也恰好是*in*单位的 1/96（稍后会详细说明原因）。因为它是一个绝对测量值，所以它可以在您想要将某些东西定义为特定大小的任何时候使用，而不是与浏览器窗口大小或字体大小等其他东西成比例。

    与所有其他绝对单位一样，*px*单位不会根据浏览器窗口的宽度进行缩放。因此，如果您的整个页面设计使用绝对单位，例如*px*而不是*%*，它将无法适应浏览器的宽度。这本身并没有好坏之分，只是设计师需要在坚持精确尺寸和不灵活与拉伸之间做出选择，但在此过程中不遵守精确尺寸。一个站点通常会混合使用固定大小和灵活大小的对象。

    固定大小的元素通常需要合并到页面中——例如广告横幅、徽标或图标。这可确保您在设计中几乎总是需要至少*一些*基于 px 的测量值。例如，图像（默认情况下）将被缩放，使得每个像素的大小为 1 *px*，因此如果您围绕图像进行设计，则需要*px*单位。它对于精确的字体大小和边框宽度也非常有用，由于四舍五入，在大多数屏幕上使用*px*单位是最有意义的。

    所有绝对测量值都彼此严格相关；也就是说，*1in*总是*96px*，就像*1in**总是* *72pt*一样*。*（请注意，在谈论基于屏幕的媒体时， *1in*几乎从来都不是物理*英寸）。*所有绝对测量都假定标称屏幕分辨率为 96ppi 和桌面显示器的标称观看距离，在这样的屏幕上 1 *px*将等于屏幕上的 1 个*物理*像素和 1 *in* *********将等于 96 个物理像素。在像素密度或观看距离明显不同的屏幕上，或者如果用户使用浏览器的缩放功能缩放了页面，*px*将不再与物理像素相关。*********

***   **em**不是一个绝对单位——它是一个相对于当前选择的字体大小的单位。除非您通过使用绝对单位（例如*px*或*pt*）设置字体大小来覆盖字体样式，否则这将受到用户浏览器或操作系统中字体选择的影响（如果他们已经制作了字体），因此没有意义使用 em 作为一般长度单位，除非您特别希望它随着字体大小的缩放而缩放。

    当您特别希望某物的大小取决于当前字体大小时，请使用*em 。*

    *   **rem**类似于*em*，但它与文档（特别是根元素）的基本字体大小有关，而不是与当前元素的字体大小有关。

    *   **%**也是一个相对单位，在这种情况下，相对于父元素的高度或宽度。如果您的设计不依赖特定像素大小来设置其大小，它们是*px单位的一个很好的替代品，例如设计的总宽度。*

    在您的设计中使用*%*单位可以让您的设计适应屏幕/设备的宽度，而使用*px*等绝对单位则不能。

    *   **vh**、**vw**、**vmin**和**vmax是像***%*一样的相对单位，但它们是相对于*视口*的大小（窗口的可视区域的大小）而不是父元素的大小。它们分别与视口的高度、宽度、两者中的较小者和两者中的较大者相关。** 

 *** * *

## 回答 #2

> 赞同：148
> 
> 时间：2009-03-04T07:18:22.993

我有一台高分辨率的小型笔记本电脑，必须以 120% 的文本缩放运行 Firefox，才能在不眯眼的情况下阅读。

许多网站都有这个问题。布局变得乱码，按钮中的文本被切成两半或完全消失。甚至 stackoverflow.com 也深受其害：

![Firefox 120% 文本缩放的屏幕截图](https://i.stack.imgur.com/fzVrR.png)

请注意顶部按钮和页面选项卡如何重叠。如果他们使用 em 单位而不是 px，就不会有问题。

* * *

## 回答 #3

> 赞同：106
> 
> 时间：2009-03-18T10:06:41.447

我问这个问题的原因是我忘记了如何使用 em，因为有一段时间我在 CSS 中愉快地进行黑客攻击。人们没有注意到我将问题保持在一般性，因为我不是在谈论字体本身的大小。**我对如何在页面上的任何给定块元素**上定义样式更感兴趣。

正如[Henrik Paul](https://stackoverflow.com/questions/609517/why-em-instead-of-px/609541#609541)和其他人指出的那样，em 与元素中使用的字体大小成正比。在 px 中定义块元素的大小是一种常见的做法，但是，在浏览器中调整字体大小通常会破坏这种设计。调整字体大小通常使用快捷键`Ctrl`+`+`或`Ctrl`+完成`-`。因此，一个好的做法是改用 em。

## 使用 px 定义宽度

这是一个说明性示例。假设我们有一个 div-tag 想要变成一个时尚的日期框，我们可能有如下 HTML 代码：

```
<div class="date-box">
    <p class="month">July</p>
    <p class="day">4</p>
</div> 
```

`date-box`一个简单的实现会以 px为单位定义类的宽度：

```
* { margin: 0; padding: 0; }

p.month { font-size: 10pt; }

p.day { font-size: 24pt; font-weight: bold; }

div.date-box {
    background-color: #DD2222;
    font-family: Arial, sans-serif;
    color: white;
    width: 50px;
} 
```

## 问题

但是，如果我们想在浏览器中放大文本的大小，设计就会中断。[正如弗洛丁](https://stackoverflow.com/questions/609517/why-em-instead-of-px/609543#609543)指出的那样，文本也会在框外流血，这与 SO 的设计所发生的情况几乎相同。这是因为盒子的宽度将保持与锁定时相同的大小`50px`。

## 改用 em

更聪明的方法是在 ems 中定义宽度：

```
div.date-box {
    background-color: #DD2222;
    font-family: Arial, sans-serif;
    color: white;
    width: 2.5em;
}

* { margin: 0; padding: 0; font-size: 10pt; }

// Initial width of date-box = 10 pt x 2.5 em = 25 pt
// Will also work if you used px instead of pt 
```

这样，您就可以在日期框上进行流畅的设计，即该框将与文本一起按为日期框定义的字体大小成比例地变大。在这个例子中，字体大小被定义`*`为 10pt，并且会放大到该字体大小的 2.5 倍。因此，当您在浏览器中调整字体大小时，该框的大小将是该字体大小的 2.5 倍。

* * *

## 回答 #4

> 赞同：60
> 
> 时间：2013-06-01T23:09:13.787

来自 thomasrutter 的最高投票答案在他对*em*的回应中是正确的。但是关于像素的大小是非常非常错误的。因此，即使它很旧，我也不能让它毫无争议。

电脑屏幕通常不是 96dpi！（或者 ppi，如果你想学究气的话。）

像素没有固定的物理尺寸。
（是的，它只固定在*一个*屏幕中，但在下一个屏幕中，像素很可能更大或更小，而且肯定不是 1/96 英寸。）

**证明**
画一条 960 像素长的线。用物理尺测量它。是10英寸吗？不..？
将笔记本电脑连接到电视。现在是10英寸的线吗？还没有？
在你的 iPhone 上显示这条线。还是一样大？为什么不？

到底是谁发明了 96dpi 的电脑屏幕神话？
（一些宗教以 72dpi 的神话运作。但同样错误。）

* * *

## 回答 #5

> 赞同：54
> 
> 时间：2009-03-04T07:12:34.457

**它适用于必须根据字体大小进行缩放的所有内容。**

它在通过缩放字体大小实现缩放的浏览器上特别有用。因此，如果您使用`em`它们调整所有元素的大小，它们会相应地缩放。

* * *

## 回答 #6

> 赞同：23
> 
> 时间：2009-03-04T07:18:05.317

因为 em ( [http://en.wikipedia.org/wiki/Em_(typography)](http://en.wikipedia.org/wiki/Em_(typography)) ) 与当前使用的字体大小成正比。如果字体大小是 16 磅，那么 1 个 em 就是 16 磅。如果您的字体大小为 16 像素（*注意*：与点不同），则 1 个 em 为 16 像素。

这导致了两个（相关的）事情：

1.  如果您稍后选择在 CSS 中编辑字体大小，则很容易保持比例。
2.  许多浏览器支持自定义字体大小，覆盖您的 CSS。如果您以像素为单位设计所有内容，那么您的布局可能会在这些情况下中断。但是，如果您使用 em，这些覆盖应该可以缓解这些问题。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-03-04T07:13:50.490

使用 px 精确放置图形元素。使用 em 进行测量，必须围绕文本元素（如行高等）进行定位和间距。px 是像素精确的，em 可以随着使用的字体动态变化

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2014-04-18T05:51:40.970

例子：

代码：body{font-size:10px;} //保持10以下所有尺寸正确，更改此值，其余更改为例如此值的1.4

# 1{font-size:1.2em;} //12px

# 2{font-size:1.4em;} //14px

# 3{font-size:1.6em;} //16px

# 4{font-size:1.8em;} //18px

# 5{font-size:2em;} //20px

…</p>

身体

1

2

3

4

5

通过更改 body 中的值，其余部分会自动更改为基值的一种...</p>

10×2=20 10×1.6=16 等

您可以将基值设置为 8px... 所以 8×2=16 8×1.6=12.8 //可能会被浏览器四舍五入

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2009-03-04T07:30:15.787

一个非常实际的原因是，如果使用 px 指定字体，IE 6 不允许您调整字体大小，而如果您使用相对单位（例如 em 或百分比）则可以。不允许用户调整字体大小对可访问性非常不利。尽管它在下降，但仍然有很多 IE 6 用户。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2020-03-09T08:14:43.317

> **像素**是绝对单位，而`rem`/`em`是相对单位。更多信息：[https ://drafts.c​​sswg.org/css-values-3/](https://drafts.csswg.org/css-values-3/)

当您希望字体大小根据系统的字体大小自适应时，您应该使用相对单位，因为系统将`font-size`值提供给作为 HTML 元素的根元素。

在这种情况下，在谷歌浏览器中打开网页的情况下，`font-size`HTML 元素是由 Chrome 设置的，尝试更改它以查看对字体为`rem`/`em`单位的网页的效果。

> [![在此处输入图像描述](https://i.stack.imgur.com/gtlb1.png)](https://i.stack.imgur.com/gtlb1.png)

如果您使用`px`作为字体的单位，则字体不会调整大小，而带有`rem`/`em`单位的字体会在您更改系统字体大小时调整大小。

因此`px`，当您希望大小固定时使用，当您希望大小自适应/动态地适应系统大小时使用`rem`/ 。`em`

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-04T19:54:07.713

使用 em 或百分比的主要原因是允许用户在不破坏设计的情况下更改文本大小。*如果您使用以 px 指定的字体进行设计，如果用户选择text size -* large ，它们不会更改大小（在 IE 6 和其他版本中）。这对于有视觉障碍的用户来说是非常糟糕的。

有关此类设计的几个示例和文章（有无数种可供选择），请参阅最新一期的 A List Apart：[Fluid Grids](http://www.alistapart.com/articles/fluidgrids)、较早的文章[How to Size Text in CSS](http://www.alistapart.com/articles/howtosizetextincss/)或 Dan Cederholm 的[Bulletproof Web Design](http://simplebits.com/publications/bulletproof/)。

您的图像仍应以 px 大小显示，但一般来说，使用 px 调整文本大小并不是一种好的形式。

尽管我个人很鄙视 IE6，但它是目前*唯一*为我们财富 200 强公司的大部分用户批准的浏览器。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-05-11T04:20:05.947

如果您想使用 px 来指定字体大小，但仍然希望 em 通过将其放在 CSS 文件中提供的可用性，有一个简单的解决方案：

```
body {
  font-size: 62.5%;
} 
```

现在像这样指定您**`p`**（和其他）标签：

```
p {
  font-size: 0.8em; /* This is equal to 8px */
  font-size: 1.0em; /* This is equal to 10px */
  font-size: 1.2em; /* This is equal to 12px */
  font-size: 2.0em; /* This is equal to 20px */
} 
```

等等。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-04T23:35:47.230

在 IE6 消失（来自您的站点）之前，您可能希望使用 em 来表示字体大小。当页面缩放（而不是文本缩放）成为标准行为时，Px 就可以了。

Traingamer 已经提供了必要的[链接](https://stackoverflow.com/questions/609517/why-em-instead-of-px/612168#612168)。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-03-06T00:40:43.277

普遍的共识是使用百分比来调整字体大小，因为它在浏览器/平台之间更加一致。

有趣的是，我一直使用 pt 来调整字体大小，并且我认为所有网站都使用它。您通常不会在其他应用程序（例如 Word）中使用 px 大小。我想这是因为它们是用于打印的 - 但在 Web 浏览器中的大小与在 Word 中的大小相同......

* * *

## 回答 #15

> 赞同：-5
> 
> 时间：2020-04-09T11:13:30.253

避免 em 或 px 使用 rem 代替，因为它更容易找到计算值。但是在 em 和 px 之间，px 更好，因为 em 很难调试。

# eclipse-plugin - 如何在 Eclipse 中侦听 File>New>Project 事件

> ID：609522
> 
> 赞同：0
> 
> 时间：2009-03-04T07:10:08.487
> 
> 标签：eclipse-plugin, listener, event-handling

我正在创建一个 Eclipse 插件，当用户选择 File > New > Project 时，它应该监听并处理生成的事件。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T08:15:21.747

聆听和响应菜单项选择的一种好方法是添加[**处理程序**](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_ui_handlers.html)。

> 处理程序是命令在特定时间点的行为。
> 一个命令可以有零个或多个与之关联的处理程序。
> 然而，在任何一个时间点，一个命令要么没有活动的处理程序，要么只有一个活动的处理程序。
> 活动处理程序是当前负责执行命令行为的处理程序。这与动作处理程序和可重定向动作的概念非常相似。

因此，您必须找到与 File New Project 对应的 Command id，并确保您的扩展是默认的活动处理程序，在执行您的自定义过程后默认重定向到新项目功能。

有关[菜单贡献](http://wiki.eclipse.org/Menu_Contributions)文章的更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T13:10:47.113

File New Project 是一个完善的操作/命令。如果你想用你自己的替换它，那么我猜你是在 RCP 环境中，你可以自由地做你想做的事。我可能会从我自己的命令开始，然后根据需要将其添加到菜单、工具栏、键绑定等。[eclipse-tips](http://blog.eclipse-tips.com/search/label/Commands)有一套优秀的教程/技巧。

如果您正在为 Eclipse（IDE）编写插件，那么您几乎可以肯定是从太低的层次来完成这项任务。在这种情况下，我猜你想贡献你自己的向导，当你在包导航器视图中右键单击时，在 New 菜单下会出现一些事情。

如果是这种情况，那么我会直接去[newWizards 扩展点](http://help.eclipse.org/help33/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/dialogs_wizards_newWizards.htm)，

# java - Java语音识别

> ID：609528
> 
> 赞同：11
> 
> 时间：2009-03-04T07:11:48.670
> 
> 标签：java, linux, speech-recognition

是否有人对任何开源或相对便宜的 Java 语音识别 API 有经验？我几乎在寻找可以将口语变成文本的东西。

从sun上的java语音识别页面来看，似乎是一个比较死的东西。我的要求是至少在 linux 上运行的东西。

任何人都可以推荐一些东西吗？纯 java 将是一个奖励，否则可以考虑基于 linux 的解决方案。而且由于这是一个家庭项目……越便宜越好。

*   编辑

CMU Sphinx 正如 Amit 指出的 CMU Sphinx [http://cmusphinx.sourceforge.net/html/cmusphinx.php](http://cmusphinx.sourceforge.net/html/cmusphinx.php) 我的问题是一个巨大的单词错误率。训练本身就是一个项目，我希望能积攒点力气在这个周末尝试一下。

IBM ViaVoice
2004 年有消息称[Via Voice 将开源](http://www.linux.com/feature/10482)。新闻发布似乎为时过早，而且从未发生过。威盛语音在某个时候[为 li​​nux 发布了](http://www.articlearchives.com/computing/software-services-applications/440754-1.html)，但似乎它们停止了。IBM 网站上似乎只剩下[ViaVoice Embedded](http://www.ibm.com/software/speech)了。

IBM Websphere Voice
我想这就是 ViaVoice（桌面）似乎停产的原因。IBM 创建了这个商业解决方案，其成本将超过一条胳膊和一条腿。至少在我使用 websphere 及其 IDE 的经验之后，只要使用它就会占用你剩下的那些。

Nuance
似乎他们仍然可以为 linux 创建产品。但我认为他们迷路了，跟随 IBM 进入了服务器市场。我不太确定这一点，他们的网站在查找有用信息方面并不那么友好。

[开放思想/言论自由](http://freespeech.sourceforge.net/)
这些人不断更改他们的项目名称。可能是一些贪钱的公司一直在威胁他们，但我不知道。该项目看起来有点死。

这个周末我可能会尝试训练狮身人面像，看看它是否想成为朋友。其他更糟糕的情况，我将考虑使用 Microsoft 的语音解决方案。过去它对我来说效果很好，但它不是一个很好的 linux 解决方案。我可能可以通过 wine 使用它，但是我将有两个单独的服务器......凌乱凌乱。

哦，还有什么似乎是参观语音/语音[SpeechTechMag](http://www.speechtechmag.com)的好地方。他们有一个“年度参考”，其中列出了一些与语音/语音相关的公司。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-04T07:14:40.707

主要是 Java：[http ://cmusphinx.sourceforge.net/html/cmusphinx.php](http://cmusphinx.sourceforge.net/html/cmusphinx.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-26T14:50:30.453

如果您的预算有限，sphinx 是迄今为止最好的选择。但是，您使用什么型号、如何调整它们*以及*如何调整音频源也会产生*巨大的差异。*绝对一切都必须匹配，否则它将无法正常工作。考虑到你描述的问题，我愿意赌大笔钱，你把你的模型弄混了，你的麦克风没有正确校准。此外，如果你有口音，它可能不起作用——这不是解码器的问题，而是声学模型的问题——如果训练数据中没有包含与你的语音/口音相似的人，你会得到很差的结果.

 *也就是说，你看过他们的开源模型页面吗？

[http://www.speech.cs.cmu.edu/sphinx/models/](http://www.speech.cs.cmu.edu/sphinx/models/)

根据您要执行的操作，您应该能够使用 16kHz WSJ 模型和 gigaword LMs NVP 获得大约 90% 的言论自由准确度。但我警告说，ASR 是一项艰巨的任务，尚未达到商品状态。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-10T16:28:39.333

[您可以从http://www.basic-signalprocessing.com](http://www.basic-signalprocessing.com)下载 vPass（语音密码）。

这些组件是为 Java 和 .Net 语言设计的。识别周期为 5 秒。VPass 经过良好测试 vText 还没有，仍然是新的，这就是为什么还没有打包的原因。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-05T17:01:41.617

几天来我一直在寻找同样的东西。到目前为止，我已经找到了 Sphinx4 和 FreeTTS。两者都是 java 实现，Sphinx 似乎与 FreeTTS 不同，它更新得相当频繁。我遇到的唯一问题是 Sphinx 在办公环境中无法理解我，我需要一个仓库环境的解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-07T07:22:50.983

我的小组用 Java 完成了一个小程序，以使用[Sphinx](http://cmusphinx.sourceforge.net/sphinx4/)识别口语数字。

# javascript - 仅使用 Javascript 将 textarea 内容下载为文件（无服务器端）

> ID：609530
> 
> 赞同：29
> 
> 时间：2009-03-04T07:12:31.103
> 
> 标签：javascript, html, download, content-disposition

我被要求制作一个“下载”按钮，将文本区域的内容与文件下载到同一页面上，并显示浏览器的“另存为...”对话框。复制/粘贴可以很好地完成这项工作，但这是一个“要求”。

现在，我只是将 textarea 的内容发布到服务器，服务器会用`Content-disposition: attachment`耳光回响它们。有没有办法只用客户端 Javascript 来做到这一点？

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-10-12T09:17:43.147

这可能是您正在寻找的： [http ://thiscouldbebetter.wordpress.com/2012/12/18/loading-editing-and-saving-a-text-file-in-html5-using-javascrip/](http://thiscouldbebetter.wordpress.com/2012/12/18/loading-editing-and-saving-a-text-file-in-html5-using-javascrip/)

它使用浏览器的下载对话框，但只支持 FF 和 Chrome，也许现在更多的浏览器？

* * *

```
 function saveTextAsFile(textToWrite, fileNameToSaveAs)
    {
    	var textFileAsBlob = new Blob([textToWrite], {type:'text/plain'}); 
    	var downloadLink = document.createElement("a");
    	downloadLink.download = fileNameToSaveAs;
    	downloadLink.innerHTML = "Download File";
    	if (window.webkitURL != null)
    	{
    		// Chrome allows the link to be clicked
    		// without actually adding it to the DOM.
    		downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
    	}
    	else
    	{
    		// Firefox requires the link to be added to the DOM
    		// before it can be clicked.
    		downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
    		downloadLink.onclick = destroyClickedElement;
    		downloadLink.style.display = "none";
    		document.body.appendChild(downloadLink);
    	}

    	downloadLink.click();
    }
```

```
<textarea id=t>Hey</textarea><br>
<button onclick=saveTextAsFile(t.value,'download.txt')>Download</button>
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-07-05T10:31:57.797

我在这里找到了一个简单的解决方案：[https ://codepen.io](https://codepen.io/pedro404/pen/KKaaovd)

```
My text area:<br />
<textarea rows='10' cols='80' id='myTextArea' ></textarea>

<br /><br />

Download button: <br />
<input value='download' type='button'
onclick='doDL(document.getElementById("myTextArea").value)' />

<script type='text/javascript'>
function doDL(s){
    function dataUrl(data) {return "data:x-application/text," + escape(data);}
    window.open(dataUrl(s));
}
</script> 
```

希望它会有所帮助。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-04T07:28:53.700

您可以尝试`window.location = "data:application/octet-stream,"+text`，但这并没有提供可以建议名称的机制，而且 IE 对数据 URI 的最大长度的限制非常小，这可能是个问题。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-06-07T23:00:15.777

有一些 javascript 库通过小型嵌入式 SWF 文件来做这种事情。比如[这个](http://github.com/dcneiner/Downloadify)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-05-28T13:32:38.753

`saveAs`绝对可以使用 HTML5功能的这种跨浏览器 JavaScript 实现： [https ://github.com/koffsyrup/FileSaver.js](https://github.com/koffsyrup/FileSaver.js)

如果您只想保存文本，则上述脚本适用于所有浏览器（包括所有版本的 IE），无需 SWF。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-12-10T20:08:32.017

您可以使用`data:`URI*并*为其指定文件名，同时仍然下载文本。尝试这个：

```
document.getElementById("dload").onclick = function(){
  var l = document.createElement("a");
  l.href = "data:text/plain;charset=UTF-8," + document.getElementById("dload-txt").value;
  l.setAttribute("download", document.getElementById("dload-fn").value);
  l.click();
}
```

```
textarea {width: 200px; height: 75px;}
input {width: 200px;}
```

```
<!DOCTYPE html>
<html>
  <head>
    <title>Download File</title>
    <meta charset="UTF-8"/>
  </head>
  <body>
    <textarea placeholder="Enter text to download" id="dload-txt"></textarea><br/>
    <input placeholder="Enter file name to download as" id="dload-fn"/><br/><br/>
    <button id="dload">Download</button>
  </body>
</html>
```

这适用于大多数浏览器。

它所做的是获取包含必要数据的`<textarea>`和`<input>`标签，创建一个具有`href`to的链接，`data:text/plain;UTF-8,<textarea data>`并使用标签设置的名称设置下载属性`<input>`。然后单击链接，它将下载文本。

这里唯一不是所有浏览器兼容的东西是：

1.  `data:`用于将数据下载为可下载链接的 URI。 [单击此处查看 CanIUse 浏览器兼容性表](https://caniuse.com/datauri)

2.  `click()`点击链接的功能。[单击此处查看 CanIUse 浏览器兼容性表](https://caniuse.com/mdn-api_htmlelement_click)

3.  `download`属性来表示下载。[单击此处查看 CanIUse 浏览器兼容性](https://caniuse.com/download)

所以基本上：

*   在 IE 中不起作用

*   不适用于 Opera Mini

*   不适用于早期版本的 Firefox、Chrome、Safari、Opera 和 iOS Safari

否则，这适用于所有主要浏览器，并且不需要任何`Blob`对象。

[Blob 构建 CanIUse 兼容性表](https://caniuse.com/blobbuilder)

[Blob URL CanIUse 兼容性表](https://caniuse.com/bloburls)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-05-15T15:58:38.220

基于@Cyrlop 的回答和[https://stackoverflow.com/a/41948732/3096687](https://stackoverflow.com/a/41948732/3096687)，这提供了一种指定文件名的方法：

```
 function doDownload(str) {
              function dataUrl(data) {
                return "data:x-application/xml;charset=utf-8," + escape(data);
              }
              var downloadLink = document.createElement("a");
              downloadLink.href = dataUrl(str);
              downloadLink.download = "foo.xml";

              document.body.appendChild(downloadLink);
              downloadLink.click();
              document.body.removeChild(downloadLink);
            } 
```

如果您不介意在 JavaScript 中包含更多字节，@Superphonic 的解决方案可能会更好。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-04T07:38:42.460

可以通过创建一个框架，在那里写入内容，然后在 IE 中调用 *以及*`document.execCommand('saveas', ...)`在 Mozilla 中使用 nsIFilePicker 进行调用，但我相信这需要一些非凡的权限（比如成为浏览器本身的一部分）。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2021-12-25T09:48:28.723

不工作

```
document.getElementById("dload").onclick = function(){
  var l = document.createElement("a");
  l.href = "data:text/plain;charset=UTF-8," + document.getElementById("dload-txt").value;
  l.setAttribute("download", document.getElementById("dload-fn").value);
  l.click();
}
```

```
textarea {width: 200px; height: 75px;}
input {width: 200px;}
```

```
<!DOCTYPE html>
<html>
  <head>
    <title>Download File</title>
    <meta charset="UTF-8"/>
  </head>
  <body>
    <textarea placeholder="Enter text to download" id="dload-txt"></textarea><br/>
    <input placeholder="Enter file name to download as" id="dload-fn"/><br/><br/>
    <button id="dload">Download</button>
  </body>
</html>
```

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-03-04T07:16:53.340

简短的回答：这是不可能的。您必须将其发布到服务器，并且来自服务器的响应可以是“内容处置：附件”。

# c# - 如何以编程方式打开事件日志？

> ID：609533
> 
> 赞同：2
> 
> 时间：2009-03-04T07:13:42.893
> 
> 标签：c#, .net, winforms, event-log

我使用通常的方法将错误记录到事件日志中：

```
 System.Diagnostics.Trace.TraceError("<" + purpose + "><time>" + DateTime.Now.ToUniversalTime() + "</time><message>" + message + "</message></" + purpose + ">"); 
```

并且想知道是否有一种方法可以调用此日志文件并将其显示给用户（以我自己的格式或像“事件查看器”一样直接打开事件日志文件）。

我在 %SystemRoot%\System32\Winevt\Logs\mylog.evtx 中找到了该文件，但不确定是否应该以这种方式处理它。理想情况下，我想模拟事件查看器的功能，但为我的应用程序定制。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T07:18:54.287

尝试[System.Diagnostics.EventLog](http://msdn.microsoft.com/en-us/library/system.diagnostics.eventlog.aspx)

例如，您可以查看应用程序日志中的条目，如下所示

```
var log = EventLog.GetEventLogs().Where(x => x == "Application").First();
foreach (var entry in log.Entries) {
  // Do something with the entry
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T07:20:30.570

我还没有尝试查看事件日志中的数据在 Vista/Win Server 2k8 (*.evtx) 中的可访问性，但是 MMC 控制台是可扩展的，因此您现在可以编写自己的 MMC 插件。因此，如果您最终编写了自己的 EventVwr.msc 版本，那么现在就很容易了。

[http://msdn.microsoft.com/en-us/library/ms692759(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms692759(VS.85).aspx)

您想在当前功能中缺少的自定义日志查看器中做什么？

# vb6 - VB6项目EXE文件不运行

> ID：609552
> 
> 赞同：0
> 
> 时间：2009-03-04T07:20:51.677
> 
> 标签：vb6, exe

我有一个生成 .EXE 文件的 Visual Basic 6.0 SP5 EXE 项目。这个项目引用了一些自定义 DLL（也是用 VB6 项目制作的）。
这个 EXE 和 DLL 在另一台机器上运行正常。

现在我对 EXE 源代码进行了一些更改。这些更改在 VB6 IDE 中运行良好。然后我通过运行 Make 创建 EXE 文件。生成的 EXE 文件在我的机器上运行正常。接下来，将该 EXE 文件复制到另一台机器，覆盖原始文件，然后运行它，没有任何反应。据我所知，EXE 甚至没有启动，而且我没有看到任务管理器中出现任务。

不知道这里发生了什么。有人见过这种行为并知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T07:22:50.360

您是否修改了您依赖的 DLL？尝试复制自定义 DLL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T17:05:06.297

我肯定会遵循有关在事件查看器中寻找原因的建议。但我认为您还需要获得适当的部署方法。

首先，我会[为 VB6 安装服务包 6，](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=a8494edb-2e89-4676-a16a-5c5477cb9713)以便您使用最新版本。然后我会做一个合适的msi安装程序。

为此，您需要：

[来自 MS 的 Visual Studio 安装程序 1.1](http://www.microsoft.com/downloads/details.aspx?familyid=5FBBC453-CD04-4562-A66E-5C21436E6F56&displaylang=en)。

[合并 VB6 SP6 的模块](http://www.microsoft.com/downloads/details.aspx?displaylang=en&FamilyID=f9d19334-61ec-48cf-bb4e-3aec65edd50b)。

合并模块需要从 Visual Studio 安装程序附带的现有合并模块中提取出来，`C:\Program Files\Microsoft Visual Studio\COMMON\Tools\VSInst\BuildRes` 然后我将创建一个 msi 安装程序并使用它来部署您的应用程序。它将为您注册 dll 并确保已安装依赖项。

要创建安装程序：

```
1) Open visual studio installer
2) Pick the VB Installer package type in the wizard
3) Change the name to the name of your project
4) Change the location to where you want the installer package to be created (I typically create a folder under the project called Install)
5) Choose create Installer, not merge module (unless you want to package up dependencies for a subproject)
6) Pick the existing VB project to deploy
7) Under Files on right add any other files that aren't straight dependencies (documentation or other related files)
8) Under Build Menu -> Build Configuration change it to release.
9) Click File System, then Application Folder, change the default install folder to be <company name>\<app Name>
10) Right click and Delete unneeded/bad dependencies.  For example MDAC.msm doesn't normally need to be deployed by the app.
11) Change ActiveX dlls to be self register in properties.
12) Under File System, User's Start Menu - Add folder hierarchy User's Start Menu -> Programs -> <company name> -> <app name>
13) Drag system created shortcut to app from User's Start Menu to the App Name folder.  Rename as appropriate.
14) Add shortcut to user's desktop folder if desired
15) Add any other file shortcuts (say to documentation) in the App Name folder or user's desktop
16) Under User Interface, click all the leaf nodes (like the welcome screen) and change the banner bitmap if you have one.
17) Configure Project Properties as appropriate (I fill in support information and update version number)

Build -> Build

THe msi file will be created in a subfolder of the install folder.
Whenever you make a new exe you just open the existing visual studio installer project and choose build->build.  It will create a new msi for you. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T08:30:16.533

值得确保两台机器上的自定义 DLL 相同，并且它们已使用[regsvr32](http://technet.microsoft.com/en-us/library/bb490985.aspx)注册。尽管如果不是，您应该会收到一条错误消息，否则程序中会出现错误，而不是您所描述的。

检查启动过程中的代码 - Sub Main() 或主窗体的 Form_Load() 事件，具体取决于您的项目设置。如果发生错误，请确保它不会退出程序。

检查任何事件查看器消息（基于Valentin Galea 的[这个答案](https://stackoverflow.com/questions/607763/vb6-application-no-longer-opens-on-vista-computer)，它帮助诊断 VB6 应用程序在损坏的数据库文件上保释）。

将日志消息添加到启动过程。本机 VB6 [App.LogEvent](http://support.microsoft.com/kb/154576)方法可能很有用。确保程序中的第一行是日志记录语句，以便您可以检查它是否完全启动。如果您在启动过程中有错误处理程序，请确保它在执行其他任何操作之前记录错误详细信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T07:23:01.560

您可能需要运行[REGSVR32](http://technet.microsoft.com/en-us/library/bb490985.aspx)以在这些 DLL 或 EXE 中注册 COM 对象。（VS IDE 会自动为您执行此操作）

# c# - C# 3.0 中 Windows 本地用户帐户的身份验证

> ID：609553
> 
> 赞同：1
> 
> 时间：2009-03-04T07:21:16.807
> 
> 标签：c#, .net, windows, authentication, user-accounts

如何在 C# 3.0 中验证本地 Windows 用户帐户。我必须验证密码的 Windows 操作系统是 Vista 和 Win2K8。注意：用户帐户是本地帐户，而不是域帐户。我在 C# 3.5（PrincipalContext 类）中找到了解决方案，但在 3.0 框架中找不到。请推荐，谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T07:28:56.150

如果您希望验证本地用户，可以使用 LogonUser 来执行此操作。它可以验证本地和远程用户。对于本地用户，只需传递机器名称来代替域。

以下博客条目详细介绍了如何从 C# 调用此函数。

~~[ [http://alt.pluralsight.com/wiki/default.aspx/Keith.GuideBook/HowToGetATokenForAUser.html]](http://alt.pluralsight.com/wiki/default.aspx/Keith.GuideBook/HowToGetATokenForAUser.html])~~

[https://web.archive.org/web/20110224015020/http://alt.pluralsight.com/wiki/default.aspx/Keith.GuideBook/HowToGetATokenForAUser.html](https://web.archive.org/web/20110224015020/http://alt.pluralsight.com/wiki/default.aspx/Keith.GuideBook/HowToGetATokenForAUser.html)

**编辑**

这是对用户进行身份验证的最佳方式。完成会话后，您应该对生成的令牌调用[CloseHandle](http://msdn.microsoft.com/en-us/library/ms724211(VS.85).aspx)。

# python - 没有外键 在 Django 中尝试内联模型时

> ID：609556
> 
> 赞同：6
> 
> 时间：2009-03-04T07:22:27.570
> 
> 标签：python, django, django-admin

我需要能够创建一个包含 20 个奇怪的多项选择题的测验类型的应用程序。

我有 3 个模型：`Quizzes`、`Questions`和`Answers`。

我想在管理界面中创建一个测验，并内联测验和答案元素。

目标是单击“添加测验”，然后转到包含 20 个问题字段的页面，每个字段有 4 个答案字段。

这是我目前拥有的：

```
class Quiz(models.Model):
    label = models.CharField(blank=true, max_length=50)

class Question(models.Model):
    label = models.CharField(blank=true, max_length=50)
    quiz = models.ForeignKey(Quiz)

class Answer(models.Model):
    label = models.CharField(blank=true, max_length=50)
    question = models.ForeignKey(Question)

class QuestionInline(admin.TabularInline):
    model = Question
    extra = 20

class QuestionAdmin(admin.ModelAdmin):
    inlines = [QuestionInline]

class AnswerInline(admin.TabularInline):
    model = Answer
    extra = 4

class AnswerAdmin(admin.ModelAdmin):
    inlines = [AnswerInline]

class QuizAdmin(admin.ModelAdmin):
    inlines = [QuestionInline, AnswerInline]

admin.site.register(Question, QuestionAdmin)
admin.site.register(Answer, AnswerAdmin)
admin.site.register(Quiz, QuizAdmin) 
```

尝试添加测验时出现以下错误：

```
class 'quizzer.quiz.models.Answer'> has no ForeignKey to <class 'quizzer.quiz.models.Quiz'> 
```

这是可行的，还是我试图从 Django Admin 应用程序中提取太多内容？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-04T15:46:04.660

您不能在 Django 管理员中进行[“嵌套”内联](http://code.djangoproject.com/ticket/9025)（即，您不能进行带有内联问题的测验，每个内联问题都有内联答案）。因此，您需要将目光放低到仅具有内联问题（然后，如果您导航以查看单个问题，它可能具有内联答案）。

所以你的模型很好，但你的管理代码应该是这样的：

```
class QuestionInline(admin.TabularInline):
    model = Question
    extra = 20

class AnswerInline(admin.TabularInline):
    model = Answer
    extra = 4

class QuestionAdmin(admin.ModelAdmin):
    inlines = [AnswerInline]

class AnswerAdmin(admin.ModelAdmin):
    pass

class QuizAdmin(admin.ModelAdmin):
    inlines = [QuestionInline] 
```

AnswerAdmin 有一个 AnswerInline 或 QuestionAdmin 有一个 QuestionInline 是没有意义的（除非这些是具有自引用外键的模型）。而且 QuizAdmin 不能有 AnswerInline，因为 Answer 没有 Quiz 的外键。

如果 Django 确实支持嵌套内联，则 QuestionInline 的逻辑语法是接受您设置为 [AnswerInline] 的“内联”属性。但事实并非如此。

另请注意，“extra = 20”意味着每次加载时，每个测验的底部都会有 20 个空白问题表格（即使它已经有 20 个实际问题）。也许这就是您想要的 - 使页面很长，但可以轻松地一次添加大量问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T10:51:57.097

让我们一步一步来。

错误：“Answer has no FK to Quiz”。

这是正确的。答案模型对测验没有 FK。它有一个 FK 要提问，但没有测验。

为什么 Answer 需要 FK 才能进行测验？

QuizAdmin 有一个 AnswerInline 和一个 QuestionInline。对于具有内联的管理员，这意味着内联模型（答案和问题）必须具有父管理员的 FK。

让我们检查。问题对测验有一个 FK。

和。答案对测验没有 FK。因此，您的测验管理员需要您的模型缺少的 FK。这就是错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T07:41:15.697

正确：试图从管理应用程序中提取太多内容 :) 内联模型需要父模型的外键。

# django - 如何从现场添加经理

> ID：609563
> 
> 赞同：2
> 
> 时间：2009-03-04T07:25:52.740
> 
> 标签：django, django-managers, django-models

我想要做的是当某个模型使用我的字段时，它会自动将自定义管理器添加到该模型。

据我所知， contibute_to_class 提供这样的功能

```
class MyCustomField(CharField):
    def contribute_to_class(self, cls, name):
        super(MyCustomField, self).contribute_to_class(cls, name)
        setattr(cls, 'custom_manager', CustomManager()) 
```

问题是，在我的自定义管理器中，我使用 self.model._default_manager 对默认管理器进行查询，但是当我尝试这样做时，django 说 AttributeError: 'NoneType' object has no attribute '_default_manager'

如果我不使用contribute_to_class 并在我的模型类旁边编写自定义管理器，它会按预期工作。可能是什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T16:04:19.500

经理，就像 Fields 一样，有一个contribute_to_class 方法，如果你不调用它，它们将无法正确设置。调用它的正确方法是使用 Model.add_to_class：

```
class MyCustomField(CharField):
    def contribute_to_class(self, cls, name):
        super(MyCustomField, self).contribute_to_class(cls, name)
        cls.add_to_class('custom_manager', CustomManager()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T08:35:40.637

```
class MyCustomField(CharField):
    def contribute_to_class(self, cls, name):
        super(MyCustomField, self).contribute_to_class(cls, name)
        manager = CustomManager()
        manager.model = cls
        setattr(cls, 'custom_manager', manager) 
```

# c# - 将“额外数据”添加到 LINQ to SQL 生成的实体？

> ID：609564
> 
> 赞同：0
> 
> 时间：2009-03-04T07:25:58.903
> 
> 标签：c#, .net, linq-to-sql

我有一个名为 Job 的 LINQ to SQL 实体，它只是 SQL 中的一个简单表。大多数情况下，它可以满足我的需要，但有时我需要在此实体中填充更多字段。我知道我可以使用部分类向 LINQ 生成的类添加新字段，但我的问题是如何填充这些额外数据？例如，我有一个存储过程，它可以拉回 Job 表的所有值以及我需要填充的额外数据。我想加入实体填充例程，当这个数据存在时，填充它，当它不存在时，忽略它。我知道简单的解决方案是创建一个视图，但我不喜欢那个解决方案。

我似乎无法弄清楚 LINQ 在哪里获取数据并填充实体。有没有人有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T07:51:50.477

（疯狂猜测）您可能能够从 SQL 视图创建实体。使用连接等在数据库中创建视图，就像在 SP 中一样，然后将该视图添加到 LINQ 设计器，它应该创建一个具有您需要的所有装备的实体。

**或者**

（更好）创建一个代表您的完整实体（带有可选字段）的类并映射到许多实体（您目前拥有）作为该过程的另一个步骤。更长的时间，因为您可能想要创建另一层抽象来执行此操作..然后更进一步，您可能想要抽象整个实体集等。所以它的工作量更大..但它让您更接近到一个更干净的域模型（如果这是你想要的）。

# iphone - 在 iPhone 上的 OpenGL ES 中，如何滚动两个图像？

> ID：609565
> 
> 赞同：0
> 
> 时间：2009-03-04T07:27:24.170
> 
> 标签：iphone, opengl-es

事实证明，使用 UIView 和 Quartz 对我的 2D 游戏来说太慢了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T07:47:30.877

一般来说，在OpenGL中，“滚动”基本上有两种方式，即垂直于观察方向移动显示的内容：

1.  调整观看，即“移动相机”，使内容发生变化。
2.  直接移动内容，保持相机固定。

这些当然是完全等价的，并且彼此相反。

这些都假设您为每一帧都重新绘制了场景。在更“经典”的意义上滚动，通过复制帧缓冲区的内容同时偏移 (dx,dy) 量，这不是一种非常适合 OpenGL 的技术。

基本上，创建一个滚动图像就像绘制一个带纹理的四边形一样简单，然后为每个新帧移动它的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T16:41:27.053

你的图像有多大，太慢有多慢？使用 UIScrollView 和包含 UIView 的内容是通过 Quartz 绘制的，我已经能够平滑地滚动视图，最大尺寸为 2000 x 2000。如果您不是每帧都重绘图像内容，而是移动视图的位置并让 Core Animation 完成其余的工作，我敢打赌，您将能够获得所需的性能，而无需使用 OpenGL。

我见过的大多数 2-D 性能问题是由于人们试图在 drawRect 中完成所有动画，不断地重绘他们的内容。您想绘制一次，然后只需移动绘制视图或图层的原点即可。视图的内容被缓存为 OpenGL 纹理，因此动画变得非常高效。

对于 2-D 工作，我认为 OpenGL 是在您用尽所有其他替代方案后最后转向的地方。使用简单的 UIViews 和 Core Animation 做同样的事情会花费你更长的时间。

# php - 在 Zend Framework 0.7 版中使用 PHPUnit

> ID：609571
> 
> 赞同：0
> 
> 时间：2009-03-04T07:31:05.317
> 
> 标签：php, unit-testing, zend-framework, phpunit

我们有一个使用 Zend Framework 预览版 0.7 开发的应用程序。现在我想编写单元测试它的控制器/逻辑文件。

逻辑主要处理数据库，对于数据库，我使用自己的包装器。

有人尝试在 Zend Framework 0.7 版之上对应用程序进行单元测试吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T07:50:10.810

我是 Zend Framework 0.7 的项目经理。您提到的预览版是在2007 年[1 月发布](http://www.nabble.com/Zend-Framework-0.7.0-released-td8440612.html)的——大约 26 个月前！这是一个非常早的版本，从那时起 ZF 已经进行了多次重构。

你真的不应该在一个持续这么长时间的项目中使用如此早期的原始版本的 ZF。

您应该升级到 ZF 1.6 或更高版本，并使用提供的[单元测试组件](http://framework.zend.com/manual/en/zend.test.html)。

* * *

关于您的评论，有关从旧版本升级的信息，请参阅[http://framework.zend.com/manual/en/zend.controller.migration.html](http://framework.zend.com/manual/en/zend.controller.migration.html)。这仅涵盖`Zend_Controller`ZF 的其他组件，而不是其他组件。这是我知道的唯一指南。没有具体的“0.7 到 1.7”指南。

祝你好运。

# javascript - Firefox 扩展的线程行为可能吗？

> ID：609573
> 
> 赞同：1
> 
> 时间：2009-03-04T07:31:11.760
> 
> 标签：javascript, multithreading, firefox

Firefox 扩展的线程行为可能吗？

我的意思是让每个 Firefox 选项卡运行一个“线程”。

刚刚完成了一个对 Firefox 窗口中的页面执行某些操作的扩展，但发现如果我想在每个选项卡中运行扩展逻辑，则需要进行一些重大的重组才能使扩展正常工作。

我认为除了跟踪每个选项卡的上下文之外，我还必须以循环方式安排每个选项卡内容的处理，以便一旦我暂停处理一个选项卡并转到另一个选项卡，当我保存前一个选项卡的上下文时再次回到它。

是的——我必须把我的扩展变成一个进程调度程序！

我宁愿把这项工作交给 Firefox 或操作系统。

虽然我可以为我处理的每个页面生成一个新窗口，以便扩展程序只能在单个页面上工作，但我更愿意使用选项卡。

尽管我已经开始编写 GM 脚本以便免费获得“线程”，但我想知道是否有人有更好的主意？

类似于从扩展中为创建的每个选项卡生成一个线程，以便每个线程都本地化并专用于每个选项卡？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T07:45:48.730

抱歉，我之前的回答是错误的（因为我很久以前就为 Firefox 2 开发了扩展）。现在看起来可以在扩展中使用 Javascript 线程：

*   [在扩展中使用工人](https://developer.mozilla.org/En/Using_workers_in_extensions)
*   [线程管理器](https://developer.mozilla.org/En/The_Thread_Manager)
*   [线程](https://developer.mozilla.org/En/Code_snippets/Threads)

但是从线程访问 DOM 或 UI 是不安全的。

此外，您实际上并不需要线程来访问多个选项卡。所有选项卡都等同于 Firefox 扩展。

# javascript - 使用 JavaScript 获取字符串中的第一个整数

> ID：609574
> 
> 赞同：43
> 
> 时间：2009-03-04T07:31:26.457
> 
> 标签：javascript, string, string-formatting

我在一个循环中有一个字符串，对于每个循环，它都充满了如下所示的文本：

```
"123 hello everybody 4"
"4567 stuff is fun 67"
"12368 more stuff" 
```

我只想检索字符串中文本的第一个数字，当然我不知道长度。

提前致谢！

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-03-04T07:41:24.810

如果数字在字符串的开头：

```
("123 hello everybody 4").replace(/(^\d+)(.+$)/i,'$1'); //=> '123' 
```

如果它在字符串中的某个位置：

```
(" hello 123 everybody 4").replace( /(^.+)(\w\d+\w)(.+$)/i,'$2'); //=> '123' 
```

对于字符之间的数字：

```
("hello123everybody 4").replace( /(^.+\D)(\d+)(\D.+$)/i,'$2'); //=> '123' 
```

[**附录**]

匹配字符串中所有数字的正则表达式：

```
"4567 stuff is fun4you 67".match(/^\d+|\d+\b|\d+(?=\w)/g); //=> ["4567", "4", "67"] 
```

您可以将结果数组映射到数字数组：

```
"4567 stuff is fun4you 67"
  .match(/^\d+|\d+\b|\d+(?=\w)/g)
  .map(function (v) {return +v;}); //=> [4567, 4, 67] 
```

包括花车：

```
"4567 stuff is fun4you 2.12 67"
  .match(/\d+\.\d+|\d+\b|\d+(?=\w)/g)
  .map(function (v) {return +v;}); //=> [4567, 4, 2.12, 67] 
```

如果存在字符串不包含任何数字的可能性，请使用：

```
( "stuff is fun"
   .match(/\d+\.\d+|\d+\b|\d+(?=\w)/g) || [] )
   .map(function (v) {return +v;}); //=> [] 
```

因此，要检索字符串的开始或结束数字`4567 stuff is fun4you 2.12 67"`

```
// start number
var startingNumber = ( "4567 stuff is fun4you 2.12 67"
  .match(/\d+\.\d+|\d+\b|\d+(?=\w)/g) || [] )
  .map(function (v) {return +v;}).shift(); //=> 4567

// end number
var endingNumber = ( "4567 stuff is fun4you 2.12 67"
  .match(/\d+\.\d+|\d+\b|\d+(?=\w)/g) || [] )
  .map(function (v) {return +v;}).pop(); //=> 67 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-03-04T07:40:58.320

```
var str = "some text and 856 numbers 2";
var match = str.match(/\d+/);
document.writeln(parseInt(match[0], 10)); 
```

如果字符串以数字开头（可能前面有空格），简单`parseInt(str, 10)`就足够了。 `parseInt`将跳过前导空格。

`10`是必要的，因为否则 string like`08`将被转换为`0`（`parseInt`在大多数实现中，考虑以八进制开头的数字`0`）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-04T07:38:18.000

如果你想要一个 int，只需`parseInt(myString, 10)`. （`10`表示基数为 10；否则，JavaScript 可能会尝试使用不同的基数，例如 8 或 16。）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-01-17T09:11:02.070

此**`replace`**方法带有**一个简单的正则表达式**( `[^\d].*`)：

```
'123 your 1st string'.replace( /[^\d].*/, '' );
// output: "123" 
```

删除**没有第一个数字的所有内容**。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-04T07:41:16.307

使用正则表达式：

```
var re = new RegExp(/^\d+/); //starts with digit, one or more
var m = re.exec("4567 stuff is fun 67");
alert(m[0]); //4567

m = re.exec("stuff is fun 67");
alert(m); // null 
```

# .net - 在 IE 中通过 powershell 调用 __dopostback

> ID：609577
> 
> 赞同：1
> 
> 时间：2009-03-04T07:33:39.117
> 
> 标签：.net, internet-explorer, powershell, vbscript

我正在编写模拟用户在页面上执行的操作的 powershell 脚本。我在执行单击按钮时遇到问题。页面有表单和内部按钮，用于保存对数据库的更改：

```
input type="button" onClick="__doPostBack('someIdentifier','SAVE')" value="Save changes" 
```

我需要从客户端调用它。问题是它本身具有 id="" 和 tag="" 的按钮，因此以下内容不起作用：

```
$ie = new-object -com "InternetExplorer.Application";
$ie.visible = $true;
$ie.navigate("http://myTestedPage.com");
$doc = $ie.Document;

#doesn't work
$save = $doc.getElementByID("")
#doesn't work neither
$save = $doc.getElementsByTagName("");

#so how to call
$save.click(); 
```

getElementbyID 和 getElementsByTagName 都只是执行一些操作，但它们的唯一影响是我的 CPU 使用率跳到了最大值。

我正在考虑获取`elements[]`表单并在那里找到按钮，但两者都没有（效果类似于前一种情况）。

是否有其他（出色的）方法可以做到这一点（显然我不知道）？我需要类似的东西`InvokeScript`

```
webBrowser = new System.Windows.Forms.WebBrowser()
webBrowser.Document.InvokeScript(@"__doPostBack", new object[] {@"someIdentifier", @"SAVE"}); 
```

但我需要使用由 powershell（或其他脚本/编程语言，也许是 VBScript？）操作的 IE 实例，而不是 .NET 独立应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T12:24:12.447

**第二次尝试**

以下代码搜索并单击所有`input`具有`value="Save changes"`属性的元素。

我必须`nodeValue`动态读取属性的属性，因为它没有在界面中公开。

```
function getProperty ([System.__ComObject] $obj, [string] $prop)
{
    [System.__ComObject].InvokeMember($prop, [System.Reflection.BindingFlags]::GetProperty, $null, $obj, $null)
}

$ie = new-object -com "InternetExplorer.Application"
$ie.visible = $true
$ie.navigate('e:\scratch\h.html')
$doc = $ie.Document

$inputElts = $doc.getElementsByTagName('input')
foreach ($elt in $inputElts)
{
    $a = $elt.getAttributeNode('value')
    if ($a -and (getProperty $a 'nodeValue') -eq 'Save changes')
    {
        $elt.Click()
    }
} 
```

这是我的 HTML：

```
<html>
<head>
<script type="text/javascript">
function alertMsg() {alert("Button was clicked!")}
</script>
</head>
<body>
<form>
<input type="button" onclick="alertMsg()"  value="Save changes" />
</form>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-06-06T16:44:16.750

Yoosiba，我一直在努力解决类似的问题。我可以给你元素名称。从 CLI 运行此代码。然后使用 tab 键突出显示要单击的元素。然后你可以输入“$doc.activeelement”来获取你想要的元素的属性。请记住，您可以通过标记名、名称或 ID 获取元素。我必须做这样的事情才能得到我想要的元素：

$link=$doc.getElementsByTagName("A") | 其中 {$_.sourceIndex -like "256"}

您可能可以做类似的事情。戴夫 M

# batch-file - 批处理文件：从字符串中获取值

> ID：609583
> 
> 赞同：2
> 
> 时间：2009-03-04T07:36:45.553
> 
> 标签：batch-file

我收到一个包含以下内容的文件：

```
\direcotry1\directory2\directory3\file1
\direcotry1\file2
\direcotry1\directory2\directory3\directory4\file3
\direcotry1\file4
\direcotry1\directory2\file5
file6 
```

文件中的文件数量和目录数量是可变的。

我需要的是文件名（file1，file2，file3，file4，file5，...）。这是因为我需要为每个文件执行一些操作。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T07:50:34.083

用这个。只需替换循环内的 echo 即可对 file1、file2 等执行任何您需要执行的操作。

```
@echo off
setlocal enableextensions enabledelayedexpansion
for /f %%i in (infile.txt) do (
    set x=%%~ni
    echo !x!
)
endlocal 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T07:42:46.723

你在找这个命令吗？

```
dir /r /b /A:-D 
```

**编辑**：

对不起，我没有正确理解。您可以使用该 dir 命令以与您要求的方式类似的方式直接收集文件名。

您不能在批处理文件中使用太多的字符串处理功能，但您想要的是可能的：

```
@echo off
for /f %%I in (inputfile.txt) DO ECHO %%~nxI 
```

这将打印没有来自 inputfile.txt 的路径的文件名。

# c# - 如何确定 Windows 应用程序的网络传输速度？

> ID：609584
> 
> 赞同：0
> 
> 时间：2009-03-04T07:37:36.550
> 
> 标签：c#, windows, networking

我想确定我的应用程序的网络使用情况。它使用各种方法进行数据传输（Web 服务、net.tcp WCF 合同、P2P 合同），所以我想我对正在运行的进程的统计数据感兴趣。像 uTorrent 这样的东西会显示它的总传输率。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T12:53:54.947

[Wireshark](http://www.wireshark.org/)是一个非常强大的网络分析工具。Is 比您要求的要多，因为它允许对通过您的网卡的所有内容进行数据包检查。

但是，它确实有一些不错的分析工具，因此您可以从应用程序中捕获网络流量并查看其 IO 配置文件，按 IP 地址或协议过滤，保存快照等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T08:31:11.287

你可以试试[Netlimiter 2 Monitor](http://www.netlimiter.com/download.php)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T08:38:44.453

图片中有多少种不同的服务器和协议？你设法列出了一个大杂烩。您正在尝试衡量整体使用情况，或按服务器或按协议

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T12:58:59.350

性能监视器将为您提供流程级别所需的信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-12T03:46:53.650

打算使用 IpHelperApi，我将发布更多关于它的信息。

[http://www.codeproject.com/KB/IP/iphlpapi.aspx](http://www.codeproject.com/KB/IP/iphlpapi.aspx)

# jpeg - 如何在不使用十六进制编辑器解码的情况下无损地将 2 个 jpeg 连接在一起？

> ID：609586
> 
> 赞同：13
> 
> 时间：2009-03-04T07:38:22.587
> 
> 标签：jpeg

我正在尝试编写一个程序（java中的prob）以无损地将多个jpeg连接在一起而无需先解码它们。

我想我会从简单开始，尝试使用十六进制编辑器附加 2 个相同大小的 jpeg，使用相同的设置压缩在另一个之上。

首先，我提取 jpeg B 的图像数据并将其附加到 jpeg A。通过修改标题中指定的尺寸，我得到了一个可以显示的新可识别图片（jpeg A + jpeg B 附加在 y 轴上）。然而，虽然 jpeg B 的图像数据清晰可辨，但似乎丢失了很多颜色信息，显然是不正确的。

所以我的问题是我在这里错过了哪些步骤？我认为我不需要更改任何其他特定于维度的标头值，所以也许我需要对两个 jpeg 中的图像数据进行霍夫曼解码，然后将它们附加在一起，然后重新编码很多？

我花了一些时间阅读 jpeg 规范和标题等，但老实说，我已经超出了我的深度，真的可以用一两个指针来做！

非常感谢您的帮助。

* * *

感谢所有的建议。是的，这绝对是可能的，我应该在我原来的问题中提到 jpegtran。我基本上是在尝试复制 jpegtran 功能的这一方面，但在我自己的程序中使用它。我想我应该看一下 jpegtran 源代码，但我对 C 一无所知，对一般编程也不太了解，所以逆向工程源代码说起来容易做起来难！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-03-04T08:42:02.540

这是非常可行的。我在很多谷歌地图图像块上做了这个，加入这些块并形成一个海报大小的图像。有一个用于 Unix 的包叫做 JPEG Tools 来做这件事。该程序称为[jpegjoin](http://jpegclub.org/)。纯 C 源代码，提供[Windows 二进制文件](http://jpegclub.org/jpegjoin/)。编译后，它会创建一个命令行应用程序，该应用程序在运行时会无损地连接两个 jpeg 图像以及许多其他内容。它不会解压缩任何图像，只是将压缩数据合并在一起并相应地修复标题。我用它合并了 100 个图像以创建 50 个条带，然后再次合并这些条带以创建一个大图像。

更多信息可以在[http://en.wikipedia.org/wiki/Lossy_compression#Lossless_editing找到](http://en.wikipedia.org/wiki/Lossy_compression#Lossless_editing)

**源代码**

可以在[此处](http://www.ijg.org/)找到底层[jpegtran](http://jpegclub.org/jpegtran/)库的源代码。**一个模拟jpegjoin**的示例脚本在[这里](http://jpegclub.org/makesample.txt)。

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-19T16:13:41.703

好的，我找出了哪里出错了。

1）图像扫描数据以字节为单位保存，但实际的重要信息被编码为可变长度的位串。这意味着实际图像数据的结尾不一定落在字节边界上。当 jpeg 编码器需要填充比特数以形成字节边界时，它只需添加一系列 1。

2）实际像素信息的存储方式有点太复杂（至少对我来说）无法解释，但基本上所有内容都在 MCU 内编码，最小编码单元或其他东西。它们的大小取决于色度二次采样，水平和垂直大小为 8 或 16 像素。对于每个 MCU，都有 DC 和 AC 部分组成亮度、Y 或色度、Cb 和 Cr 的单个分量。问题是直流分量被存储为与前一个 MCU 的相关直流值相关的值。因此，当我添加来自 jpg B 的新图像数据时，它已经存储了与 0 相关的 DC 值（因为没有以前的 MCU），但它需要考虑来自 jpg A 的最后一个 MCU 的最终 DC 值。 （希望这是有道理的）。

解决方案：

您需要对图像数据进行初始解码（霍夫曼 + 游程长度），以准确找出图像数据结束的位置，然后去除尾随的 1。您还需要适当地更改第二个 jpg 中的初始 DC 值。然后，您需要重新编码适当的位，添加 1 以适应字节边界，等等。

如果你想在 x 轴上追加，它有点复杂。您必须重新排列 MCU，以便它们以正确的顺序扫描。Jpgs 从左到右扫描，然后从上到下扫描，然后适当调整 DC 值。

到目前为止，我只在单个 MCU jpg 上对此进行了测试，但理论上它也应该适用于更大的 jpg。

顺便说一句，感谢这个[优秀的 jpg 相关资源/博客的所有者，我才解决了这个问题](http://www.impulseadventure.com/photo/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T08:23:19.793

jpeg 与 mp3 一样 - 在您重新压缩它时通常是稳定的（使用相同的算法）。

因此，当您加入图像并重新压缩它们时，只需确保新的压缩率高于或等于 2 张图片中的最高值。这样你就不会真正失去准确性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-04T08:29:06.223

两种方法：

1）解码两个源JPEG图像，合并生成的位图并再次编码为JPEG。这里的缺点是重新压缩。

2) 确保源图像的宽度和高度是 16 的倍数，可能通过裁剪图像。不要解码图像，而是从源 MCU 块（16 x 16 像素大小，因此裁剪）组装目标 JPEG。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-20T02:20:41.867

我建议您考虑 DRI 和 RSTn 标记，虽然这需要很多先决条件，但它适用于我：将 PPM（位图格式）附加到使用 DRI 和 RSTn 编码的 jpeg，两者宽度相同，两者都是 MCU 的倍数。

我只是在最后一个 RSTn 标记（如果有）之后剪掉 jpeg 数据，将其解码为 PPM，然后将两个 PPM 连接到单个 MCU 行，使用与原始 jpeg 相同的选项对其进行编码，重新排列结果中的 RST jpeg 根据原始 jpeg，然后将结果附加到原始 jpeg。使用这种方法，它可以防止我解码整个原始 jpeg 并再次对其进行编码。

作为解码和编码的东西，我使用的是 libjpeg。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-02T12:58:04.477

与水平附加图像不同，将每个图像旋转 90 度，然后垂直连接它们，然后将生成的图像旋转回 -90 度可能更容易。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-03-04T07:52:19.307

无损 JPEG 操作几乎是矛盾的。你可以做一些诡计，比如旋转，但仅此而已。

我建议您使用无损源图像（想到 TIFF 或 PNG），或者重新评估您的图像质量要求 - 再次重新采样 JPEG，给定不错的原始文件，对于那里的绝大多数人来说是无法区分的。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2009-03-04T08:24:31.693

你想要做的基本上是不可能的。
JPEG 文件的编码有点复杂，如果您要更改像素的内容，那么编码将会被更改。您最终可能会得到一个小于或大于您组合的两个图像的总和的图像。唯一可能无损的操作是与原始图像的像素保持一一对应的操作。这基本上可以归结为 90 度旋转。

# c# - 索引器有什么用？

> ID：609594
> 
> 赞同：7
> 
> 时间：2009-03-04T07:41:35.947
> 
> 标签：c#

C#中索引器的真正用途是什么？

因为我是一个新的 c# 程序员，所以看起来很混乱。它看起来像一个对象数组，但事实并非如此。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-04T07:51:43.350

您可以将索引器视为带有参数的属性。你用这个参数做什么取决于你。

通常，索引器用于为您的对象提供*索引*是有意义的。

例如，如果您的对象处理项目的集合，则能够使用简单的`'[]'`语法访问它们是有意义的，因为很容易将其视为一个数组，我们将要返回的对象的位置提供给该数组。

不久前，我写了一篇关于[使用反射的索引器](http://blog.nkadesign.com/2006/net-the-limits-of-using-reflection/)方面的博客文章。
我举的一个例子是：

```
 using System;  
 using System.Collections;  

 public class DayPlanner  
 {  
     // We store our indexer values in here   
     Hashtable _meetings = new System.Collections.Hashtable();  

     // First indexer  
     public string this[DateTime date] {  
         get {  
             return _meetings[date] as string;  
         }  
         set {  
             _meetings[date] = value;  
         }  
     }  

     // Second indexer, overloads the first  
     public string this[string datestr] {  
         get {  
             return this[DateTime.Parse(datestr)] as string;   
         }  
         set {  
             this[DateTime.Parse(datestr)] = value;  
         }  
     }  
 } 
```

然后你可以像这样使用它：

```
 DayPlanner myDay = new DayPlanner();  
  myDay[DateTime.Parse("2006/02/03")] = "Lunch";  
  ...  
  string whatNow = myDay["2006/06/26"]; 
```

这只是为了表明你可以扭曲索引器的目的来做你想做的事。
但这并不意味着你应该...... :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T08:04:05.737

索引器允许类或结构的实例像数组一样被索引，它们最常在主要目的是封装内部集合或数组的类型中实现。

get 访问器返回一个值，而 set 访问器分配一个值：

```
public T this[int i]
{
    get
    {
        return arr[i];
    }
    set
    {
        arr[i] = value;
    }
} 
```

使用枚举，他们定义的值仅限于一小组原始整数类型（byte、sbyte、short、ushort、int、uint、long、ulong）。

char 类型也是一个整数类型，但它与其他整数类型有两个不同之处：

*   没有从其他类型到 char 类型的隐式转换。特别是，即使 sbyte、byte 和 ushort 类型具有可以使用 char 类型完全表示的值范围，但不存在从 sbyte、byte 或 ushort 到 char 的隐式转换。

*   char 类型的常量必须写为字符文字或整数文字与转换为 char 类型的组合。例如，(char)10 与 '\x000A' 相同。

（[C# 语言规范 3.0，第 4.1.5 节](http://msdn.microsoft.com/en-us/vcsharp/aa336809.aspx)）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T08:17:20.963

索引器的目的只是它像数组一样工作，但是您为读取和写入索引器时发生的事情指定代码。

索引器几乎可以做任何事情来提供像 behviour 这样的集合。通常有某种私有集合，您可以使用索引器提供读或读/写访问权限。

枚举不能使用 char 作为其基本类型，但您可以使用字符文字来指定整数值：

```
public enum Characters : int {
    Alpha = 'a',
    Beta = 'b'
} 
```

Characters.Alpha 的值为 97，Characters.Alpha.ToString() 将返回字符串“Alpha”。(char)Characters.Alpha 给出值“a”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T07:50:03.790

.NET 中的任何集合，无论是 ArrayList 还是泛型 List，都在其底层结构中具有幕后数组。索引器只是一种改变常规数组索引工作方式的方法，无论是通过接受字符串作为输入来查找具有该属性的对应对象，还是通过其他输入。但是，再一次，在所有这些语法糖之下，它仍然以数组的表示形式结束。

本文[可能有助于解释如何制作自定义索引器](http://www.csharphelp.com/archives/archive140.html)。

关于第二点，枚举是整数。如果您需要枚举的字符表示，则仅限于字符串操作，或者您可以[使用适当的属性装饰您的枚举，](http://weblogs.asp.net/stefansedich/archive/2008/03/12/enum-with-string-values-in-c.aspx)以便它们发出您想要的字符串或字符表示。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T09:01:28.470

关于枚举，如果您需要特定的枚举，请考虑使用类型安全的枚举模式，请参阅链接： [http ://www.javacamp.org/designPattern/enum.html](http://www.javacamp.org/designPattern/enum.html)

# hardware - 如何以编程方式确定 DVD 或 HDD 的连接方式 - 主设备还是从设备？

> ID：609595
> 
> 赞同：1
> 
> 时间：2009-03-04T07:42:16.227
> 
> 标签：hardware

在桌面上可以轻松查看跳线。笔记本电脑并非如此，如果要更换驱动器，确定驱动器的连接方式将很有用。

关于如何做到这一点的任何想法，甚至是否有可能？

预期平台是 Windows（XP 或 Vista）。

最近的经验是使用东芝 A50 笔记本电脑，其固件被证明是东芝特定的，通过标准渠道（东芝）的驱动器比 PC 的价值所能支持的要贵 5 倍，而且 BIOS 在极端情况下也无济于事。

花了 5 次尝试和一个非常乐于助人的供应商来破解那个问题，我想知道如果将来出现这个问题，应该避免这个问题！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T08:03:41.493

如果您使用的是 Windows 平台，[WMI](http://msdn.microsoft.com/en-us/library/aa394582.aspx)可能会告诉您...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T08:04:05.660

大多数较旧的 BIOS（我说较旧的，因为您在谈论 PATA）为检测到的硬盘驱动器提供了一个汇总表 - 您通常可以在其中覆盖一些参数。尝试在引导过程中进入 BIOS 设置（F2，删除）并查看基本设置/IDE 硬盘配置或类似的内容。

# sql - 为什么 LINQ to SQL 会被扩展方法欺骗？现在怎么办？

> ID：609596
> 
> 赞同：4
> 
> 时间：2009-03-04T07:42:18.927
> 
> 标签：sql, linq-to-sql, datetime, extension-methods, utc

考虑我的`Event`班级，并且我将`DateTime`' 存储在数据库中作为 UTC 日期。我只是想根据特定时区的当前日期返回过滤范围 - 很简单吧？

这工作正常：

```
IQueryable<Event> test1 = this.GetSortedEvents().Where(e => e.FinishDateTime.Date >= DateTime.UtcNow.Date); 
```

这也可以正常工作：

```
IQueryable<Event> test2 = this.GetSortedEvents().Where(e => e.FinishDateTime.AddHours(3).Date >= DateTime.UtcNow.AddHours(3).Date); 
```

.. 并且还满足我的时区要求。

所以在这里我想我可以把这个特定的转换移到这个扩展方法中：

> ```
>  public static DateTime RiyadhTimeFromUtc(this DateTime utcTime)
>     {
>         return utcTime.AddHours(3);
>     } 
> ```

这不起作用：

```
IQueryable<Event> test3 = this.GetSortedEvents().Where(e => e.FinishDateTime.RiyadhTimeFromUtc().Date >= DateTime.UtcNow.RiyadhTimeFromUtc().Date); 
```

.. 我得到这个 NotSupportedException: Method 'System.DateTime RiyadhTimeFromUtc(System.DateTime)' has no supported translation to SQL.

这显然是垃圾，因为当扩展方法中没有相同的代码时，编译器很乐意将其转换为 SQL。

在某些类型和最近的 DateTime 之前，我遇到过“没有支持的 SQL 转换”问题。但是我上面的测试和[这个链接](http://msdn.microsoft.com/en-us/library/bb425822.aspx)证明在 SQL 翻译中应该支持 AddHours 方法。

如果有人能告诉我我在这里做错了什么（或解决此问题的不同解决方法），我将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-04T07:55:43.107

您必须从表达式树的角度来考虑它，这就是 Linq-to-SQL 解析查询以将其转换为 SQL 的方式。

检查树时，它会看到一个`DateTime`对象，然后检查在它上面调用的方法是否是受支持的方法之一（`Add`、`AddHours`等），因此当您直接使用该方法时，它可以正常工作。

当您使用其他一些扩展方法时，它无法查看该方法的内部以查看其作用，因为有关该方法主体的信息不在表达式树中，而是隐藏在 IL 中。所以扩展方法的内容是否支持无关紧要，因为Linq-to-SQL无法计算出内容是什么。

创建方法的重点是封装和信息隐藏，这通常在应用程序开发中运行良好，但不幸的是，这里它隐藏了 Linq-to-SQL 的信息，您需要能够看到这些信息。

* * *

针对已编辑的问题 - 你如何解决这个问题？如果你想在 Linq 表达式中保留日期计算，你唯一能做的就是保持查询效率不使用扩展方法，`AddHours(3)`直接在`DateTime`对象上使用。

这是 Linq 的不幸限制之一。像许多事情一样，它是一个有点泄漏的抽象，虽然在一系列源上提供通用语法，但对源的提供者可以/将支持哪些操作有不同的限制和限制（例如，这在 Linq-to 中可以很好地工作-Objects，因为它不需要翻译表达式树来执行它）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T07:58:31.210

似乎 LINQ-to-SQL 能够弄清楚这`RiyadhTimeFromUtc`实际上只是`AddHours(3)`对它的调用，必须对您的代码进行一些非常复杂的分析。假设你写道：

```
public static DateTime RiyadhTimeFromUtc(this DateTime utcTime)
{
    if (Random.GetInt() < 99) {
       return utcTime.AddHours(3);
    } else {
       return utcTime.AddDays(5);
    }
} 
```

它将如何将其转换为 SQL？有关更多信息，请参阅[此讨论。](http://social.msdn.microsoft.com/forums/en-US/linqprojectgeneral/thread/ce3e3721-ded0-4dc6-a40a-ddeb981c2ebe/)

# jquery - ASP.NET MVC 将复杂类型传递给控制器 问题

> ID：609603
> 
> 赞同：1
> 
> 时间：2009-03-04T07:44:53.270
> 
> 标签：jquery, asp.net-mvc, controller

我在将复杂类型传递给控制器​​时遇到问题。

这是我的模型的样子：

```
public class Party
{
    [XmlAttribute]
    public int RsvpCode { get; set; }
    public List<Guest> Guests { get; set; }
    public string Comments { get; set; }
}

public class Guest
{
    [XmlAttribute]
    public string Name { get; set; }
    [XmlAttribute]
    public int MealOption { get; set; }
    [XmlAttribute]
    public bool Attending { get; set; }
} 
```

我的控制器方法如下所示：

```
 public JsonResult Submit(Party party)
    {
        return Json(party);
    } 
```

我正在尝试像这样进行我的 ajax 调用：

```
var party = { RsvpCode: 1, Guests: [{ Name: "test asdfasdf", MealOption: 1, Attending: true }, { Name: "test asdfasdf", MealOption: 1, Attending: true}] };

                $.getJSON("/Rsvp/Submit", party, function(response) {
                    alert(response);
                }); 
```

出了点问题，但我不确定是什么。我在警报声明中收到任何返回给我的东西。有任何想法吗？

我还尝试查看提交到控制器方法中的值，但它看起来不正确。我在 ajax 调用中的某处丢失了信息。

我也试过这样创建我的派对对象，但它没有用：

```
var party = { "RsvpCode": 1, "Guests": [{ "Name": "test asdfasdf", "MealOption": 1, "Attending": true }, { "Name": "test asdfasdf", "MealOption": 1, "Attending": true}], "Comments": "testdsfsdf" }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-19T04:05:24.787

当我构造party 变量时，ASP.NET MVC 期望它看起来像这样：

var party = { "RsvpCode": 1, "Guests[0].Name": "test asdfasdf", "Guests[0].MealOption": 1, "Guests[0].Attending": true, "Guests[1 ].Name": "test asdfasdf", "Guests[1].MealOption": 1, "Guests[1].Attending": true, "Comments": "testdsfsdf" };

# svn - 无法使用 TortoiseSVN 签出代码

> ID：609604
> 
> 赞同：0
> 
> 时间：2009-03-04T07:45:06.173
> 
> 标签：svn, tortoisesvn

当我尝试使用 TortoiseSVN 检出代码时出现错误。

> 错误：“服务器路径”的选项：无法连接到服务器（http：服务器路径）

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T09:03:54.673

我遇到了这个问题，它归结为大小写 - SVN 取决于大小写，而 http 不是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T08:06:35.590

如果是 http，您可能想尝试使用 Web 浏览器来访问它，或者可能是 url 的子集，以查看该服务器是否已启动。如果你输入正确。输入错误的路径真的很容易。

当然，如果不是http，但你得到这样的错误，那么这也是一个线索。也许您遗漏了 svn:// 部分？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T07:51:41.070

如果您在 svn 正在侦听的端口上 telnet 到服务器会发生什么。我认为默认的svn协议端口是3690

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T11:53:26.840

我在 TortoiseSVN 中的网络设置有问题。它现在正在工作。

# c# - 从 IEnumerable 强制转换 to IEnumerable Recently I found a very surprising behavior in c#. I had a method which takes IEnumerable<Object> as a parameter and i was passing IEnumerable<string> 问问题 Praveen 问问题 2009-03-04T07:48:07.210 15984 次 This question shows research effort; it is useful and clear 6 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. Recently I found a very surprising behavior in c#. I had a method which takes IEnumerable<Object> as a parameter and i was passing IEnumerable<string> but it's not possible. While in c# everything can be upcast to Object than why this is not possible? It's totally confusing for me. Please someone clear me on this issue. The technical term for this is that generics are invariant in C# 3.0 and earlier. From C#4.0 onward, the cast works. What invariant means is that there is no relationship between two generic types just because their generic type parameters are related (i.e. are sub- or supertypes of each other). In your example, there is no typing relationship between an IEnumerable<object> and an IEnumerable<string>, just because string is a subtype of object. They're just considered two completely unrelated types, like a string and an int (they still both are subtypes of object, but everything is) There are a few workarounds and exceptions for this issue you've run into. First, you can cast each string individually to object, if you're using .NET 3.0 you can do that using the Cast<T>() extension method. Otherwise, you can use a foreach and put the result into a new variable of the static type you want. Second, arrays are an exception for reference type, i.e. passing in a string[] type to a method acccepting object[] types should work. c#covariancecontravariance 4 5 回答 5 This answer is useful 11 这方面的技术术语是泛型在 C# 3.0 及更早版本中是不变的。从 C#4.0 开始，演员表工作。 不变的意思是两个泛型类型之间没有关系，仅仅因为它们的泛型类型参数是相关的（即彼此的子类型或超类型）。 IEnumerable<object>在您的示例中， an和 an之间没有类型关系IEnumerable<string>，只是因为 string 是对象的子类型。它们只是被认为是两种完全不相关的类型，例如字符串和 int（它们仍然都是对象的子类型，但一切都是） 对于您遇到的此问题，有一些解决方法和例外情况。 首先，您可以将每个字符串单独转换为对象，如果您使用的是 .NET 3.0，您可以使用Cast<T>()扩展方法来做到这一点。否则，您可以使用 foreach 并将结果放入您想要的静态类型的新变量中。 其次，数组是引用类型的一个例外，即将 string[] 类型传递给接受 object[] 类型的方法应该可以工作。 于 2009-03-04T07:56:00.453 回答 This answer is useful 8 As others have pointed out, generics types are invariant. IEnumerable<T> could be co-variant but C# doesn't currently support specifying variants. C# 4.0 is expected to support variants so this might be supported in the future. To work around this now you can using a the LINQ extension method Cast<object>(). Assuming you have a method called Foo that takes an IEnumerable<object>>. You can call it like this, Foo(stringEnumerable.Cast<object>()); 于 2009-03-04T08:29:59.170 回答 This answer is useful 3 The easiest way to pass IEnumerable<string> to function requiring IEnumerable<object> is through converting function like this: public IEnumerable<object> convert<T>(IEnumerable<T> enumerable) { foreach (T o in enumerable) yield return o; } When C# 4 comes out, this won't be neccessary, because it will support covariance and contravariance. 于 2009-03-04T08:15:12.747 回答 This answer is useful 0 You should be using IEnumerable<T> if you want to pass in different types, then you can query T to find out what type it is. 于 2009-03-04T08:01:11.673 回答 This answer is useful 0 A good way to think about this is to ask yourself "What would happen if you could do this?". Take the following example: IEnumerable<String> strings=...; IEnumerable<Object> objects = strings; // assume this were legal objects.Add(new Integer(5)); // what the... We just added an integer to a list of strings. The compiler does this to preserve type safety. 于 2009-03-04T08:01:44.883 回答 Related 1 properties - 通过关系访问 ember-data 的属性（不在模板中） 0 ruby-on-rails - 邮件未在 Ruby on Rails 中发送（以前在 Depot 的生产环境中重定向怪癖） 1 python - 尝试使用一些已解析的 HTML 数据在 Python 中创建一个有组织的表 1 java - 创建序列时出现 SQL 错误 1 git - 推送分支和合并到主然后推送有什么区别？ 1 sql-server-2008 - 我可以获得将我的 grails 连接到 MSSQL 的步骤吗？ 2 java - 创建 SQS 消息后，如何监控它何时被删除？ 1 c# - 从网络中的 UNC 路径加载图像并隐藏路径 2 javascript - 干净、模块化的代码与 MV* 框架 4 java - 字符串操作比较 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：609608
> 
> 赞同：6
> 
> 时间：
> 
> 标签：c#, covariance, contravariance

Recently I found a very surprising behavior in c#. I had a method which takes `IEnumerable<Object>` as a parameter and i was passing `IEnumerable<string>` but it's not possible. While in c# everything can be upcast to Object than why this is not possible? It's totally confusing for me. Please someone clear me on this issue.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-04T07:56:00.453

这方面的技术术语是泛型在 C# 3.0 及更早版本中是不变的。从 C#4.0 开始，演员表工作。

不变的意思是两个泛型类型之间没有关系，仅仅因为它们的泛型类型*参数*是相关的（即彼此的子类型或超类型）。

`IEnumerable<object>`在您的示例中， an和 an之间没有类型关系`IEnumerable<string>`，只是因为 string 是对象的子类型。它们只是被认为是两种完全不相关的类型，例如字符串和 int（它们仍然都是对象的子类型，但一切都是）

对于您遇到的此问题，有一些解决方法和例外情况。

首先，您可以将每个字符串单独转换为对象，如果您使用的是 .NET 3.0，您可以使用`Cast<T>()`扩展方法来做到这一点。否则，您可以使用 foreach 并将结果放入您想要的静态类型的新变量中。

其次，数组是引用类型的一个例外，即将 string[] 类型传递给接受 object[] 类型的方法应该可以工作。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-04T08:29:59.170

As others have pointed out, generics types are invariant. `IEnumerable<T>` could be co-variant but C# doesn't currently support specifying variants. C# 4.0 is expected to support variants so this might be supported in the future.

To work around this now you can using a the LINQ extension method `Cast<object>()`. Assuming you have a method called `Foo` that takes an `IEnumerable<object>>`. You can call it like this,

```
Foo(stringEnumerable.Cast<object>()); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-04T08:15:12.747

The easiest way to pass `IEnumerable<string>` to function requiring `IEnumerable<object>` is through converting function like this:

```
public IEnumerable<object> convert<T>(IEnumerable<T> enumerable)
    {
    foreach (T o in enumerable)
        yield return o;
    } 
```

When C# 4 comes out, this won't be neccessary, because it will support covariance and contravariance.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T08:01:11.673

You should be using

```
IEnumerable<T> 
```

if you want to pass in different types, then you can query T to find out what type it is.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T08:01:44.883

A good way to think about this is to ask yourself "What would happen if you could do this?". Take the following example:

```
IEnumerable<String> strings=...;
IEnumerable<Object> objects = strings; // assume this were legal

objects.Add(new Integer(5)); // what the... 
```

We just added an integer to a list of strings. The compiler does this to preserve type safety.

# java - 在循环中创建最终变量

> ID：609609
> 
> 赞同：52
> 
> 时间：2009-03-04T07:48:31.360
> 
> 标签：java, final

这在java中是否允许：

```
for(int i=0;i<5;i++){
  final int myFinalVariable = i;
} 
```

我的问题的关键字是`final`。是否允许做一个随着循环的每次运行而改变的最终变量？我想知道这一点，因为 final 说您不能更改变量的值（仅调用`myFinalVariable = i`），但我正在重新定义整个变量`final int`。

它们是两个完全不同的变量，只是同名吗？循环上一次运行的变量已经在通往垃圾收集器的路上了？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-03-04T07:49:57.377

是的，这是允许的。`final`关键字意味着您不能在其范围内更改变量的*值*。对于您的循环示例，您可以认为变量在循环底部超出范围，然后在循环顶部以新值返回范围。分配给循环内的变量将不起作用。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-04T07:54:34.323

您是对的，对于循环中的每次迭代，您都在创建一个新变量。这些变量确实共享相同的名称，但这很好，因为它们不在同一个范围内。下一个示例*不起作用*：

```
final int myFinalVariable = 0;
for(int i=0;i<5;i++){
  myFinalVariable = i;
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-04T08:00:26.433

变量只是堆栈上的一个位置。尝试将变量保持在尽可能小的范围内，并尝试使它们成为最终变量。然而，范围和最终只是源代码的东西......从代码生成/VM的角度来看，它们根本不重要。

在您的具体示例中，使用“int”不会创建垃圾。但是，如果创建的是对象，那么对于这两种情况，垃圾的数量和垃圾何时有资格进行清理将是相同的。

采取以下代码：

```
public class X
{
    public static void main(final String[] argv)
    {
        foo();
        bar();
    }

    private static void foo()
    {
        for(int i=0;i<5;i++)
        {
            final int myFinalVariable = i;
        }
    }

    private static void bar()
    {
        for(int i=0;i<5;i++)
        {
            int myFinalVariable = i;
        }
    }
} 
```

编译器为每种方法生成相同的字节码：

```
public class X extends java.lang.Object{
public X();
  Code:
   0:   aload_0
   1:   invokespecial   #1; //Method java/lang/Object."<init>":()V
   4:   return

public static void main(java.lang.String[]);
  Code:
   0:   invokestatic    #2; //Method foo:()V
   3:   invokestatic    #3; //Method bar:()V
   6:   return

private static void foo();
  Code:
   0:   iconst_0
   1:   istore_0
   2:   iload_0
   3:   iconst_5
   4:   if_icmpge       15
   7:   iload_0
   8:   istore_1
   9:   iinc    0, 1
   12:  goto    2
   15:  return

private static void bar();
  Code:
   0:   iconst_0
   1:   istore_0
   2:   iload_0
   3:   iconst_5
   4:   if_icmpge       15
   7:   iload_0
   8:   istore_1
   9:   iinc    0, 1
   12:  goto    2
   15:  return

} 
```

由于声明变量的顺序，添加另一个在循环外声明变量的方法会为您提供稍微不同的字节码）。请注意，此版本不能将变量设为最终版本。最后一个版本不是最好的方法（如果可以的话，循环内的最终变量是最好的）：

```
private static void car()
{
    int myFinalVariable;

    for(int i=0;i<5;i++)
    {
        myFinalVariable = i;
    }
}

private static void car();
  Code:
   0:   iconst_0
   1:   istore_1
   2:   iload_1
   3:   iconst_5
   4:   if_icmpge       15
   7:   iload_1
   8:   istore_0
   9:   iinc    1, 1
   12:  goto    2
   15:  return

} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-30T08:48:41.270

正如回答的那样，是的，您确实可以将循环中的变量标记为“最终”。这是这样做的效果（Java 7、Eclipse Indigo、Mac OS X Lion）。

```
for ( int i = 0; i < 5; i++ ) {

  // With 'final' you cannot assign a new value.
  final int myFinalVariable = i;  // Gets 0, 1, 2, 3, or 4 on each iteration.
  myFinalVariable = 7; // Compiler error: The final local variable myFinalVariable cannot be assigned.

  // Without 'final' you can assign a new value.
  int myNotFinalVariable = i;  // Gets 0, 1, 2, 3, or 4 on each iteration.
  myNotFinalVariable = 7; // Compiler is OK with re-assignment of variable's value.

} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-07T11:56:19.850

在循环内声明的变量仅在循环的单次执行之前具有作用域。

在循环内将变量声明为 final 对循环内的变量没有任何影响，但是如果我们在循环外使用 final 修饰符声明变量，则分配给原始类型的值或分配给引用变量的 Object 不能更改。

在下面的示例中，前两个循环没有问题，两个循环都给出相同的输出，但第三个循环给出了编译时错误。

公共类测试{

```
public static void main(String[] args) {
    for (int i = 0; i < 5; i++) {
        final int j= i;
        System.out.println(j);
    }
    for (int i = 0; i < 5; i++) {
        int j= i;
        System.out.println(j);
    }

    final int j;
    for (int i = 0; i < 5; i++) {
        j= i;
        System.out.println(j);
    }
} 
```

}

如果我错了，请纠正我。

# ruby - Ruby 代码解释

> ID：609612
> 
> 赞同：5
> 
> 时间：2009-03-04T07:50:03.167
> 
> 标签：ruby

有人可以解释一下这段 Ruby 代码吗：

```
def add_spec_path_to(args) # :nodoc:
  args << {} unless Hash === args.last
  args.last[:spec_path] ||= caller(0)[2]
end 
```

我已经看到`<<`用于连接字符串的运算符或其他语言中的按位运算符，但有人可以在这种情况下解释它。是否以某种方式将空白 lamda 附加到 args 上还是我完全错了？

我还可以看到它是这样使用的：

```
before_parts(*args) << block 
```

是`Hash`关键字吗？

我也不确定`||=`接线员在说什么。

至于是什么，我同样一无所知`caller(0)[2]`。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-04T07:57:11.230

我假设那`args`是一个`Array`.

`Hash`是一个类的名称——*除非*最后一个元素已经是一个，否则第一行将一个空的散列`{}`推到上面（类的运算符测试一个对象是否属于某个类）。`args` *`args``Hash``===`*

 *`||=`运算符类似于运算符：它`+=`或多或少等同于：

```
args.last[:spec_path] = args.last[:spec_path] || caller(0)[2] 
```

因此，`args.last[:spec_path]`当且仅当它当前未设置时才会设置。

该[`caller`](http://www.ruby-doc.org/core/classes/Kernel.html#M005955)方法返回有关调用方法的信息。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-03-04T09:30:53.720

||= 是一个常见的 Ruby 习惯用法：它仅在尚未设置值时才分配值。效果和code一样

```
if some_variable == nil
   some_variable = some_value
end 
```

或者

```
some_variable= some_value unless some_variable 
```

===，当没有被覆盖时，比较两个对象的身份。在 的情况下`Hash === args.last`，Hash（它是 Class 类型的对象）正在检查它是否与 args 数组中最后一项的类匹配。代码利用了 Class#=== 的实现强制检查比较对象的类这一明显事实。

相反，它不起作用，例如：

```
a = [{}]
Hash === a.last #=> true
a.last === Hash #=> false 
```

方法的尾随参数可以作为散列的内容提供，而无需提供 {}

所以你可以这样做：

```
def hello(arg1, arg2, arg3)
  puts [arg1.class, arg2.class, arg3.class].join(',')
end

hello 1,2,3 #=> Fixnum,Fixnum,Fixnum
hello :a, "b", :c => 1, :d => 99 #=> Symbol,String,Hash 
```

它通常用于为函数提供可变长度的可选参数列表。

顺便说一句，您确定您准确地转录了原始代码吗？为了获得一个参数数组，您通常会在声明的参数中添加一个 * ，否则 args 必须作为数组输入，这宁愿打败对象。

```
def add_spec_path_to(*args)              # now args is an array
    args << {} unless Hash === args.last # if trailing arguments cannot be
                                         # interpreted as a Hash, add an empty 
                                         # Hash here so that following code will 
                                         # not fail
    args.last[:spec_path] ||= caller(0)[2] # Set the spec_path option if it's not
                                         # already set
end 
```

编辑：进一步扩展 *args 事情，试试这个：

```
def x(*args)
  puts args.join(',')
  puts args.map{|a| a.class }.join(',')
end

x 1,2,:a=>5,:b=>6 
1,2,a5b6
Fixnum,Fixnum,Hash 
```

... 使用 *args 会导致 args 作为数组呈现给方法。如果我不使用 *，像这样，例如：

```
def y(args)
  puts args.join(',')
  puts args.map{|a| a.class }.join(',')
end 
```

...然后在我调用该方法之前 args 必须是一个数组，否则我会得到一个“ArgumentError：错误数量的参数”，除了一件事传递。所以它必须看起来像这样：

```
y [1,2,{:c=>3,:d=>4}] 
```

...使用 {} 显式创建的哈希。而且很丑。

顺便说一句，以上所有内容均使用 MRI 1.8.6 进行了测试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-02T03:39:38.140

以更短的方式：

```
def add_spec_path_to(args) # :nodoc:

...

# Append an empty hash to args UNLESS the last arg is a hash.. in which case do nothing
args << {} unless Hash === args.last # so we need a hash. If it is not there, make an empty one and put it there.

...

#if args.last[:spec_path] equals nil or false, set it to caller(0)[2]... 

#so inside that hash from the first part, if :spec_path is not there, create it by using caller(0)[2].

args.last[:spec_path] ||= caller(0)[2] 

...

end 
```

# ruby-on-rails - 如何控制用户资产，但让管理员查看所有内容？

> ID：609621
> 
> 赞同：2
> 
> 时间：2009-03-04T07:52:11.630
> 
> 标签：ruby-on-rails, activerecord

我有一个 Rails 应用程序，其中用户拥有项目的成员资格（以及其他事物，多态）。用户也有角色。我希望 User#projects 像普通的 ActiveRecord 查找一样工作，但我也希望管理员能够访问每个项目。

有一段时间我一直在这样做：

```
class User < ActiveRecord::Base
   has_many :memberships, :dependent => :destroy

   def projects
     if has_role?(:admin)
       Project.find(:all)
     else
       Project.find(:all, :include => :memberships, :conditions => ["memberships.user_id = ?", id])
     end
   end
end

class Project < ActiveRecord::Base
  has_many :memberships, :as => :member, :dependent => :destroy
end

class Membership < ActiveRecord::Base
  belongs_to :user
  belongs_to :member, :polymorphic => :true
end 
```

但我真的宁愿做这样的事情：

```
class User < ActiveRecord::Base
  has_many :memberships, :dependent => :destroy
  has_many :projects, :through => :memberships, :source => :member, :source_type => "Project"
end 
```

这样我就可以更经常地使用named_scope（例如'alfred.projects.recent.active'）。这

如果您自动为管理员添加新会员资格，则此方法有效，但很快就会失控。

我想保留 User#projects 界面。这里的正确路线是什么？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T11:10:59.843

[看一下activefx的restfull authenticationaion教程：](http://github.com/activefx)（restful authentication tutorial）它是一个rails应用，具有以下特点：

当前功能

```
- Login / Logout
- Restful, with the exception of the "activate" action
- Namespaced admin and user sections
- OpenID Authentication with support for incomplete OpenID    profiles
- Roles and permissions
- Administrative user controller
- Set roles, activate, enable / disable users  
- Login, permission, and access denied redirection system
- Member list and public profiles for logged in users
- Activation, with option to resend activation code
- Beta invitation system 
- easy on/off functionality, add/remove invites, send emails to   
- pending users
- Forgot Password / Reset Password
- Change Password 
- Failed login attempts database logging
- Recaptcha displayed for more than 5 failed logins
- Helper methods (link_to_user, if_admin?, etc.) 
```

[该主题将解释您如何授予所有者和管理员访问权限。#28。](http://railsforum.com/viewtopic.php?id=14216&p=2)

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-05T01:36:51.493

我会为 RESTful_ACL 插入一个不要脸的插件：http: [//github.com/mdarby/restful_acl/tree/master](http://github.com/mdarby/restful_acl/tree/master)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T22:42:43.270

我个人不喜欢以您尝试这样做的方式在模型之间传播授权问题。

这有几个原因（主要是最终它通常会导致非 RESTful 设计）。另一个是矛盾方法的问题。

想想看。

在您的系统中是什么`user.projects`意思？在您的模型中，它有两个含义：它意味着

1.  用户参与的所有项目，
2.  存在的所有项目。

如果您以这种方式建模您的系统，您最终会得到一堆具有许多不同含义的方法，即。目的（想想你有三个、四个或更多角色的情况），这不是一个好的做法。不过，还有更多的原因。例如。如果某个用户拥有多个角色怎么办？管理员通常也是普通用户。

那么什么是“正确”的解决方案呢？好吧，它们可能还有更多 pf，但我现在喜欢和使用的是 rails-authorization-plugin 使用的那个。在模型中定义角色并在控制器和视图中实现授权逻辑。查看[插件](http://github.com/DocSavage/rails-authorization-plugin/tree/master)以了解更多信息。

希望有帮助！如果没有，请发表评论。

# php - file_get_contents：无法打开流：主机已关闭

> ID：609626
> 
> 赞同：0
> 
> 时间：2009-03-04T07:53:08.277
> 
> 标签：php

我在我的 mac osx 10.5 上运行 php5。如果我写一个简单的 php 脚本：

```
<?php
file_get_contents('http://www.google.com');
?> 
```

并在命令行中运行它，我收到以下错误：

“警告：file_get_contents（[http://www.google.com](http://www.google.com)）：无法打开流：主机已关闭”

我不确定我是否缺少 php.ini 中的某些设置或其他内容。我知道如果我在服务器上运行相同的脚本，它会在没有警告的情况下执行。

关于我在这里缺少什么的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T08:01:21.500

防火墙或者您没有连接到互联网（或者您可能正在运行阻止 Terminal.app 访问的 LittleSnitch 之类的东西）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T07:57:12.867

检查你的防火墙？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T08:21:45.540

检查 PHP 设置`allow_url_fopen`是否设置为`On`. 用于`phpinfo()`检查所有设置。

# interface - 面向对象的分析与设计

> ID：609630
> 
> 赞同：0
> 
> 时间：2009-03-04T07:54:44.747
> 
> 标签：interface, access-modifiers, ooad

为什么我不能在接口中指定静态类型的方法。

有没有其他方法可以做到这一点？

但我应该只使用抽象类的接口。

/

在接口中指定访问说明符有什么问题吗？

我想在接口中指定事件，并且只能由实现的类访问，所以我想要该事件的受保护访问说明符。

我有某些功能可以在另一个类中使用接口，在这种情况下我可以使用公共访问说明符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T08:03:21.793

我不知道您使用的是哪种语言，但我会像在 C# 中一样回答。

为什么我不能在接口中指定静态类型的方法。有没有其他方法可以做到这一点？

这是因为您不能覆盖静态方法。你想达到什么目的？

接口中的成员在 C# 中始终是公共的。如果您需要其他保护级别，请使用抽象类。如果您无法从界面访问受保护事件，它们的目的是什么？那么它与接口无关（记住，接口不能有任何代码）。如果您指的是只有实现类可以引发事件，请放心，它们是唯一可以引发事件的类。事件就是这样构建的——只有类本身可以引发事件。你不能在类外部引发事件（除非你在类上有一个方法，引发事件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T08:01:42.543

接口只向公众描述你的实现者。接口的唯一访问修饰符是接口本身的“内部”，这使其成为仅对同一程序集的所有成员或使用“InternalsVisibleTo”属性已知的成员可见的接口。

如果只有实现者应该看到某个事件，那么该事件必须在某种基类中。

静态方法几乎是过程编程的残余。它们确实有它们的用途（参见例如扩展方法），但实际上与 OOP 并没有太大关系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T08:02:30.017

我不知道您对第一个问题的意思是什么，但是您关于在接口中使用受保护的第二个问题是直接“不”。接口被称为“接口”，因为它们指定了您可以与该对象通信的“接口”（即公共方法）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T08:13:50.910

我在 OOP 方面的经验与 Actionscript 3 相关，但我确信它是相对的。

静态方法不能被覆盖，并且在类扩展祖先类时不会使用它们。

接口中不使用访问修饰符，因为该接口用于设置 PUBLIC 方法。

在 AS3 中，接口只是一个没有块的方法签名，但包括数据类型。

重要的是要注意 getter/setter 方法签名也可以在接口中使用。这些很有用，如果您只使用 setter，则您已经创建了对私有封装变量的只读公共访问。

至于接口而不是抽象类，这完全取决于您希望如何实现代码。通常，接口和抽象类一起使用，以利用继承和多态（扩展/实现）实现不同的结果。

# mysql - mysql中的id是否保证不重复，即使行被删除？

> ID：609655
> 
> 赞同：2
> 
> 时间：2009-03-04T08:05:07.293
> 
> 标签：mysql

当然，如果我最终放了足够多的行，就会重复。但是让我们假设我选择了一个足够大的 id 字段。

我想知道我是否可以假设 id 随着时间的推移唯一标识行。如果客户端向我发送了一个 id，我希望能够确定它指的是哪一行，或者该行是否被删除（或者它是否是一个假的 id，但在这种情况下，我不会错误地告诉我该行是已删除）。

另请参阅以下内容：如果我重新启动数据库，或者备份和恢复 - 是否会继续在它离开的地方创建 id - 或者它可能会决定“填补漏洞”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T08:06:31.487

如果你有一个从未重置的“int not null auto increment primary key”，那么yes ID 将不会被重用。

然而，这提出了一个有趣的问题——*如果*你碰巧重用了一个旧的 ID 会发生什么（即使它在 MySQL 中默认不会发生，但人为因素总是很重要）？

如果您的数据库经过适当的规范化、级联*和*约束，您的应用程序应该能够处理 ID 的重用。

**编辑**（因为你编辑了你的帖子，我会充实我的答案），关于这句话：*“如果客户给我发了一个 id，我希望能够确定它指的是哪一行，或者该行是否被删除”*。如果 ID 未被删除，则始终可以确定它属于哪一行（能够从数据库中提取信息至关重要）。

**但是**，如果 id 所指的行被删除，则*无法*确定它属于哪一行……因为它不存在。如果你需要这个，我建议你实现某种类型的审计功能，最好是通过[triggers](http://www.google.com/search?hl=sv&q=mysql+triggers+to+audit&btnG=S%C3%B6k&lr=)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T09:30:04.487

当前的自动增量值通过附加到表的额外属性在备份/恢复中保留。您可以在 ENGINE= 之后的转储中看到它：

```
mysql> create table foo ( bar int(11) primary key auto_increment );
Query OK, 0 rows affected (0.06 sec)

mysql> insert into foo () values (), (), (), ();
Query OK, 4 rows affected (0.00 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql> show create table foo \G
*************************** 1\. row ***************************
       Table: foo
Create Table: CREATE TABLE `foo` (
  `bar` int(11) NOT NULL auto_increment,
  PRIMARY KEY  (`bar`)
) ENGINE=MyISAM AUTO_INCREMENT=5 DEFAULT CHARSET=latin1
1 row in set (0.00 sec) 
```

您可以使用“ALTER TABLE tablename AUTO_INCREMENT=”重置它，但在我看来，如果在执行插入时属性值不超过最大现有 id，则该属性值将被忽略。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T09:50:58.477

另请注意，所描述的不重用以前使用的 ID 的行为对 MyISAM 引擎有效，但实际上并非对所有可用引擎都有效。

# php - PHP中的文本显示

> ID：609666
> 
> 赞同：0
> 
> 时间：2009-03-04T08:12:08.790
> 
> 标签：php

如果我将数据存储在包含 URL 的数据库中（例如：浏览此链接[http://www.google.com](http://www.google.com)）。

当我在浏览器中显示该数据时，我想显示该数据，例如“通过此链接[http://www.google.com](http://www.google.com) ”。但是那个看起来像锚链接的网址......

如果你没有得到这个..打开谷歌聊天...向 http://google.com 之类的任何人发送一些消息 ..如果你发送像[http://google.com](http://google.com,but)[这样](http://google.com..if)的纯文本，但它会显示超链接..到那个网址..

我想要 PHP 技术中的这个功能......我们如何实现这个

提前致谢...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-04T08:19:55.637

那么，您想[将 url 转换为 php 中的链接](http://www.google.com/search?q=convert+url+to+link+php)吗？查看第[一个结果](http://www.liamdelahunty.com/tips/php_convert_url_to_link.php)，或[stackoverflow 中相同问题的](https://stackoverflow.com/questions/206059/php-validation-regex-for-url)答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T08:19:21.537

如果我理解正确，您希望将文本中的 URL 自动转换为链接，而无需进一步详细说明，现在应该使用粗略（非常粗略）的正则表达式：

```
$textWithLinks = preg_replace('#(http|ftp)s?://[^\s]+#i', '<a href="$0">$0</a>', $textWithUrls); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-26T12:36:55.583

```
function add_href ($text) {
    return preg_replace('/((www\.|(http|https|ftp|news|file)+\:\/\/)[&#95;.a-z0-9-]+\.[a-z0-9\/&#95;:@=.+?,##%&~-]*[^.|\'|\# |!|\(|?|,| |>|<|;|\)])/', '<a href="$0">$0</a>', $text);
} 
```

表达式取自[http://rickyrosario.com/blog/converting-a-url-into-a-link-in-csharp-using-regular-expressions/](http://rickyrosario.com/blog/converting-a-url-into-a-link-in-csharp-using-regular-expressions/)

# asp.net - C# ASP.NET 回发数据

> ID：609671
> 
> 赞同：0
> 
> 时间：2009-03-04T08:14:37.943
> 
> 标签：asp.net, webforms, textbox, postback

我有一个网页表单，其中包含大约 20 个表单（home.aspx），其中一个我需要在一个文本框旁边放置一个链接，当用户单击链接（search.aspx）时会弹出该链接。在此弹出链接中将有一个搜索文本框，它将根据用户输入的关键字搜索数据库。假设用户输入 id 号 (1111)，显示的结果将是 ID 1111 的名称。问题是当用户单击结果行时，它将自动返回 home.aspx 并且选择的名称是放在文本框中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T08:21:11.967

您可以从 search.aspx 到 home.aspx进行[跨页回发。](http://msdn.microsoft.com/en-us/library/ms178139.aspx)我会考虑将搜索放在页面中。当您单击链接时，为什么不让搜索框出现在您的主表单中（使其成为链接按钮而不是链接）。

# sql - 表列的唯一约束

> ID：609676
> 
> 赞同：1
> 
> 时间：2009-03-04T08:18:11.630
> 
> 标签：sql, sql-server, constraints, diacritics, unique-key

我有一个表（其中包含数据的现有表）并且该表有一个用户名列。我希望这个用户名是唯一的。所以我添加了一个这样的约束：

```
ALTER TABLE Users 
ADD CONSTRAINT [IX_UniqueUserUserName] UNIQUE NONCLUSTERED ([UserName]) 
```

现在我不断收到此表中存在重复用户的错误。但我已经使用以下查询检查了数据库：

```
SELECT COUNT(UserId) as NumberOfUsers, UserName 
FROM Users 
GROUP BY UserName, UserId 
ORDER BY UserName 
```

这会产生一个用户列表，所有用户的 NumberOfUsers 都为 1。所以那里没有重复。但是当我检查他失败的用户名时，我看到以下结果：

```
beluga
béluga 
```

所以显然他没有比较“e”和“é”或“è”......就像他忽略了这些，有什么办法让sql在添加唯一键约束时不忽略这些重音。

解决方案：

谢谢你们，我找到了解决方案。这解决了问题：

```
ALTER TABLE Users 
ALTER COLUMN UserName nvarchar(250) COLLATE SQL_Latin1_General_CP1_CI_AS 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-04T08:22:17.410

在比较时，您使用的排序规则很可能会忽略大小写和重音符号。您需要更改排序规则。

*   `Latin1_General_CI_AI`忽略大小写和重音
*   `Latin1_General_CI_AS`不会忽略重音

SQL 服务器排序规则名称列表[在这里](http://msdn.microsoft.com/en-us/library/ms180175.aspx)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-04T08:23:31.057

您的查询也按 UserID 分组 - 您不想这样做。

采用：

```
SELECT COUNT(*) as NumberOfUsers, UserName 
    FROM Users 
    GROUP BY UserName 
    ORDER BY UserName 
```

您的查询只会显示具有相同名称和相同用户 ID 的用户。或者，也许，按顺序排列数据，`COUNT(*)`以便显示的最后一行很可能是麻烦制造者？

正如其他人所建议的那样，您也可能遇到整理问题，但通常， GROUP BY 将是自洽的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T08:24:25.003

大概 UserId 是您的主键。由于它是您分组依据的一部分，因此您可以保证每组获得一行。将“userId”列从您的组中取出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T08:23:30.807

正如 Andrew Barrett 所说，MySQL 中的默认排序规则不能正确识别重音符号。

将字段的排序规则更改为**`UTF8_unicode_ci`**，它应该可以正确看到重音符号。

ci 表示不区分大小写，如果大小写很重要，您可以使用不同的排序规则。

您可以使用新排序规则创建一个新表，然后将现有表中的 * 复制到新表中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T08:34:27.880

另请注意，您还可以仅创建您对相关排序规则感兴趣的表（而不是服务器范围）。因此您还可以执行以下操作：

```
CREATE TABLE Users (c1 varchar (10), .., COLLATE Latin1_General_CI_AS NULL ) 
```

# jquery - Microsoft AJAX 客户端库与 jQuery

> ID：609683
> 
> 赞同：7
> 
> 时间：2009-03-04T08:22:23.213
> 
> 标签：jquery, ajax, client

在 jquery 集成新闻之后，关于 jQuery 和 MS Ajax 的讨论很多。

我目前正在说服我的团队考虑使用 jQuery，但我不是其中任何一个的专家。

我真的想在 jQuery 和 MS Ajax“客户端”库之间进行一些很好的比较，因为我的团队认为，如果我们只使用原始的 ms ajax 客户端库，我们可以实现 jQuery 的功能，而 jQuery 似乎只是有一个更好的选择器。

有人可以对在某些情况下为什么使用 jQuery 而不是 MS Ajax 提供一些很好的见解吗？如果更好的性能问题？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-04T08:26:30.427

我两个都用。我认为这两个用于不同的用例——MS AJAX 用于在初始加载（ScriptControl）期间将一些数据从服务器传送到客户端，并用于创建初始控制元素关联。此外，Web 服务包装器对于数据 AJAX 非常有用，并且包装器依赖于 MS AJAX 库。

jQuery 用于页面加载后的 DOM 遍历/修改。MS AJAX 可以做到这一点，但比 jQuery 复杂得多。此外，jQuery 作为一个框架可以访问大量插件——客户端脚本和控件，例如菜单/树/等。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-04T08:27:25.120

SO 问题：[MS Ajax 与 jQuery 在 ASP.NET MVC 应用程序中的优缺点？](https://stackoverflow.com/questions/498680/pros-and-cons-of-ms-ajax-vs-jquery-in-an-asp-net-mvc-app)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-05T04:47:21.363

Microsoft 现在将 jQuery 作为 Asp.net MVC 的一部分提供。他们不会在内部使用 jQuery，而是在推广它。看看[这篇](http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx)文章。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-15T23:08:41.113

我们需要问——我们为什么要使用 ASP.NET？主要是因为它提供的控件。如果 jQuery 将控件作为插件提供，那么也不需要 ASP.NET 或 Microsoft AJAX 工具包。如果我们将网站设计为基于纯 HTML 页面，使用 jQuery 来控制 HTML 页面的动态部分，最后使用 WebService 从数据库中存储/检索信息，那么我们完全消除了 ASP.NET ASP.NET 减慢网站速度请求经过很多阶段才能到达已编译的 ASPX 页面，然后对其进行解析，然后合并代码隐藏和设计器文件，最后呈现 HTML。

有人可能会争辩说，微软提供了 MasterPages。再次考虑使用 MasterPages，因为它们也会降低您的网站速度。在每次页面请求时，都会重建整个 MasterPage。而是尝试使用 IFRAME。让您的起始页面包含所有导航控件，并将内容区域作为 IFRAME。此内容区域应根据用户菜单点击加载正确的 HTML 页面。

# c# - C#：是否可以取消 linq2sql 查询？

> ID：609692
> 
> 赞同：5
> 
> 时间：2009-03-04T08:26:08.617
> 
> 标签：c#, linq-to-sql

是否可以取消 linq2sql 查询？就像我构建了一个需要一段时间才能运行的查询一样，我希望用户可以取消它。有人对此有什么好主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T08:53:04.997

如果您设置[DataContext的](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.aspx)[CommandTimeout](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.commandtimeout.aspx) (seconds) 属性，它将在超时后自动抛出异常。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T14:28:04.667

因此，根据[Richard Szalay](https://stackoverflow.com/users/3603/richard-szalay)的评论：

> 您最好的选择是在后台线程中运行查询，并在用户点击取消时简单地取消订阅容器对象的事件。

而且我认为我同意目前这是一个不错的解决方法。我希望看到框架中已经有一些异步查询功能，但在此之前必须这样做。

还没有开始实现这个（必须先完成一些其他的事情），但它可以工作的一种方式：

*   在工作线程中，在单独的查询线程中执行查询，然后加入该线程直到完成。
*   当用户点击取消时，调用`Interrupt`工作线程的方法，然后它会得到一个`ThreadInterruptedException`并停止等待查询线程完成。

* * *

稍后我制作时可能会添加一些代码。但我们会看到结果有多漂亮：p

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T16:00:21.090

我知道这个答案有点晚了，但这就是我的做法：

```
class Program
{        
    public class Person
    {
        public string Name;
        public int Age;
    }        

    public static void ExecuteQueryAsync ( IEnumerable<Person> collectionToQuery , Action<List<Person>> onQueryTerminated , out Action stopExecutionOfQuery )
    {
        var abort = false;

        stopExecutionOfQuery = () =>
        {
            abort = true;
        };            

        Task.Factory.StartNew( () =>
        {
            try
            {
                var query = collectionToQuery.Where( x =>
                {
                    if ( abort )
                        throw new NotImplementedException( "Query aborted" );

                    // query logic:
                    if ( x.Age < 25 )
                        return true;
                    return
                        false;
                } );

                onQueryTerminated( query.ToList() );

            }
            catch
            {
                onQueryTerminated( null );
            }
        });
    }

    static void Main ( string[] args )
    {
        Random random = new Random();

        Person[] people = new Person[ 1000000 ];

        // populate array
        for ( var i = 0 ; i < people.Length ; i++ )
            people[ i ] = new Person() { Age = random.Next( 0 , 100 ) };

        Action abortQuery;
        ExecuteQueryAsync( people , OnQueryDone , out abortQuery );

        // if after some time user wants to stop query:
        abortQuery();

        Console.Read();
    }

    static void OnQueryDone ( List<Person> results )
    {
        if ( results == null )
            Console.WriteLine( "Query was canceled by the user" );
        else
            Console.WriteLine( "Query yield " + results.Count + " results" );
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-04T08:37:30.383

我会说您可能需要在单独的线程上运行它并取消它。

# java - 如何将 AutocadDWG 转换为 PDF？

> ID：609697
> 
> 赞同：4
> 
> 时间：2009-03-04T08:27:59.970
> 
> 标签：java, pdf, autocad, dwg

除了使用第三方程序，还有其他方法可以将 AutocadDWG 转换为 PDF 吗？感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-04T21:59:35.750

如果您想在没有 AutoCAD 的情况下这样做，那么[开放设计联盟](http://www.opendesign.com/)是我发现的少数选择之一。如果您安装了 AutoCAD，则较新版本中有 PDF 驱动程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-07-28T22:20:07.320

您可以使用 DWG Trueview（[从 AutoDesk 免费](http://usa.autodesk.com/adsk/servlet/index?id=6703438&siteID=123112)）并通过 PDF 打印驱动程序进行打印。[PDF Xchange](http://www.docu-track.com/)是我为 AutoCAD 找到的最好的 PDF 打印机。大多数其他人，包括 AutoCAD 自己的实现，将 PDF 膨胀到大约 10 倍的大小，并将文本渲染为线条对象。那是完全失败的。

您曾经能够以编程方式连接到 Trueview 的一部分，但它从来没有这样的文档化 API，而且肯定没有得到正式批准。尝试谷歌寻找类似的解决方案。

# javascript - 为什么innerHTML =“”在Firefox中很慢

> ID：609698
> 
> 赞同：6
> 
> 时间：2009-03-04T08:28:30.950
> 
> 标签：javascript, firefox, dom, browser

我正在测试将 html 元素动态添加到 DOM 的不同方法的速度。我在[这里](http://www.nicon.nl/testhtml/elwrap_.html)建立了一个测试器（代码是工作版本，非常草率）。对于不同的浏览器，结果（非常）不同，Chrome 在速度方面获得了所有分数，而 Opera 则是第二好——但这不是这里的问题。

在 Firefox 中，我检测到清除 div（来自它的 childNodes）的问题。当添加大约 50.000 个 div 元素时，需要很长时间才能清除，仅使用

```
[div].innerHTML = ""; 
```

这里发生了什么？Firefox 是否为此实现了一些内在的垃圾收集方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-04T08:51:11.910

虽然我不确定 innerHTML = "" 您遗漏了一种使用 DocumentFragments 插入 DOM 的可能快速方法：[正如 John Resig 所示](http://ejohn.org/blog/dom-documentfragments/)。

正如Ólafur Waage 已经提到的，尽管innerHTML 在很多情况下速度更快，因为它不是任何[W3C](http://en.wikipedia.org/wiki/World_Wide_Web_Consortium)标准的一部分，但如果出现怪癖，则更有可能被引入。并不是说 innerHTML 不是现代浏览器中的事实标准。

[这篇博](http://blog.stevenlevithan.com/archives/faster-than-innerhtml)文似乎表明 Firefox 在使用 innerHTML 删除元素时会花费大量时间进行自我清理。

> 在某些浏览器（最显着的是 Firefox）中，虽然 innerHTML 通常比 DOM 方法快得多，但它花费了不成比例的时间来清除现有元素而不是创建新元素。知道了这一点，我们可以结合使用标准 DOM 方法删除元素的父元素和使用 innerHTML 创建新元素的速度来破坏元素。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T08:45:01.597

innerHTML 不是 W3C DOM 规范的一部分。

> 它永远不应该用于编写表格的一部分——应该使用 W3C DOM 方法——尽管它可以用于编写整个表格或单元格的内容。
> 
> 由于此属性没有公共规范，因此实现差异很大。例如，在文本输入中输入文本时，IE 会更改输入的 innerHTML 属性的 value 属性，但 Gecko 浏览器不会。
> 
> 对于那些希望遵守标准的人，[这里有一组 JavaScript 函数](http://innerdom.sourceforge.net/)提供序列化或解析 XML，以便通过 DOM 将定义为字符串的元素内容设置为字符串，或者将从 DOM 获取的元素内容作为字符串获取。

[来源 - Mozilla 开发](https://developer.mozilla.org/en/DOM/element.innerHTML)

# iphone - 如何在 iPhone 上自定义多行标签？

> ID：609701
> 
> 赞同：0
> 
> 时间：2009-03-04T08:29:52.650
> 
> 标签：iphone, user-interface, label, tail, truncation

如何让标签显示多行字符串？

例如，给定的字符串是@"HelloA\nHelloB\nHelloC\n"。

如何显示它：

@“你好”

@“你好乙”

@“你好ç”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T08:55:50.543

我找到了一些自定义 UILabel 的属性：

```
label.numberOfLines = 3;
label.adjustsFontSizetoFitWidth = YES;
label.minimumFontSize = 8.0f; 
```

'\n' 可以用作尾部截断标记。

# c# - 在c#中计算大写字符数的最快方法

> ID：609704
> 
> 赞同：16
> 
> 时间：2009-03-04T08:30:42.240
> 
> 标签：c#, linq

关于这个效率的任何想法？...

```
CommentText.ToCharArray().Where(c => c >= 'A' && c <= 'Z').Count() 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-03-04T08:39:11.567

好的，刚刚敲了一些代码来为你的方法计时：

```
int count = 0;
for (int i = 0; i < s.Length; i++)
{
    if (char.IsUpper(s[i])) count++;
} 
```

结果：

> 你的：19737 滴答声
> 
> 我的：118 滴答声

差别蛮大的！有时，最直接的方式是最有效的。

**编辑**

只是出于兴趣，这是：

```
int count = s.Count(c => char.IsUpper(c)); 
```

大约 2500 滴答声进入。因此，对于“Linqy”单行来说，它非常快。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-04T08:45:25.700

首先，您没有理由需要调用`ToCharArray()`，因为假设`CommentText`是一个字符串，它已经是一个`IEnumerable<char>`. 其次，您可能应该调用`char.IsUpper`而不是假设您只处理 ASCII 值。代码应该看起来像，

```
CommentText.Count(char.IsUpper) 
```

第三，如果您担心速度，没有什么比旧的 for 循环更好的了，

```
int count = 0;
for (int i = 0; i < CommentText.Length; i++) 
   if (char.IsUpper(CommentText[i]) count++; 
```

一般来说，调用任何方法都会比内联代码慢，但这种优化只有在你绝对确定这是你代码中的瓶颈时才应该进行。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-04T08:38:57.307

您只计算标准 ASCII 而不是 ÃÐÊ 等。

怎么样

```
CommentText.ToCharArray().Where(c => Char.IsUpper(c)).Count() 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-04T08:41:32.340

甚至没有测试我会说

```
int count = 0;
foreach (char c in commentText)
{
    if (Char.IsUpper(c))
        count++;
} 
```

更快，现在关闭测试它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-04T08:45:46.073

您使用该代码所做的是创建一个包含字符的集合，然后创建一个仅包含大写字符的新集合，然后遍历该集合以找出有多少。

这会表现得更好（但仍然不如普通循环好），因为它不会创建中间集合：

```
CommentText.Count(c => Char.IsUpper(c)) 
```

编辑：正如马特建议的那样，也删除了 ToCharArray 调用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-04T09:27:51.747

我有这个

```
Regex x = new Regex("[A-Z]{1}", 
  RegexOptions.Compiled | RegexOptions.CultureInvariant);
int c = x.Matches(s).Count; 
```

~~但我不知道它是否特别快。我想它也不会得到特殊字符~~

**编辑：**

快速比较这个问题的答案。在 vshost 中调试，使用字符串进行 10'000 次迭代：
**aBcDeFGHi1287jKK6437628asghwHllmTbynerA**

*   答案：20-30 毫秒
*   正则表达式解决方案：140-170 毫秒

# asp.net - 在文件下载 HTTP 处理程序中处理 404 的最佳方法？

> ID：609706
> 
> 赞同：1
> 
> 时间：2009-03-04T08:32:23.547
> 
> 标签：asp.net, http-status-code-404, httphandler

我有一个网格，它为用户提供了一些下载文件的链接。文件存储在应用程序之外，路径引用从数据库中读取，并且 HTTP 处理程序 (*.ashx) 用于为每个请求的文件提供服务。但是，可能存在指向不存在文件的数据库条目。我抓住了`FileNotFoundException`，但我不确定通知用户丢失文件的最佳方法是什么（以便他们可以联系支持）。

第一个想法是在响应上设置一个标准的 404 代码，这就是我现在正在做的事情。

更有用的方法是显示有关丢失文件的通知 (jQuery)，但文件下载不是在 AJAX 中完成的，因此这将涉及两步过程 - 客户端 onclick 处理程序调用 Web 服务方法来检查是否该文件存在，如果不存在，那么我取消单击（返回 false）并向用户显示一条友好消息。但是，如果文件存在，我将继续正常执行。但这又增加了另一个服务器调用。

你有没有处理过类似的问题？你是怎么解决的？

一些说明 - 该应用程序是在 ASP.NET 2.0 中构建的，并使用 jQuery 来调用 Web 服务方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T11:35:38.973

帕维尔，你似乎已经回答了你的问题......

> ...（以便他们可以联系支持）...

通过说明上述内容，我建议您创建一个自定义 404 页面，通知用户磁盘上不存在的文件，并向他们提供有关如何与支持办公室联系的信息。

我创建了一个用于处理文件的 HTTP 处理程序，如果磁盘上不存在文件，则返回 404 响应。如果抛出 404 响应，我已经设置 IIS 以显示自定义页面..（我对错误 500 执行相同操作）。

希望这有助于找到适合您需求的解决方案并祝您好运！

# linux - 解释Linux的权威网站或pdf？

> ID：609717
> 
> 赞同：0
> 
> 时间：2009-03-04T08:36:44.363
> 
> 标签：linux

比如什么是X windows、Cygwin、文件系统

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T08:42:07.300

[我认为这是一个很好的开始方式](http://www.linux.com/whatislinux/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T08:44:44.190

好吧，首先你必须选择你想使用/学习的 Linux 发行版，然后你只需使用该发行版的文档，该文档通常包含分配信息。

你可以在这里找到一些 linux 初学者课程：[http ://www.linux.org/lessons/beginner/toc.html](http://www.linux.org/lessons/beginner/toc.html)

最后，除了阅读之外，最好的学习方式是“弄脏你的手”。安装您选择的发行版并弄乱它:)

# iphone - iPhone上的尾部截断标记是什么？

> ID：609719
> 
> 赞同：0
> 
> 时间：2009-03-04T08:37:06.343
> 
> 标签：iphone, objective-c, string, tail, truncation

我想为几个字符串添加一些尾标。iPhone上有'\n'之类的标记吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T08:53:32.390

你的意思是Objective-C？嗯，就像 C 一样，字符 '\n' 代表换行符。

# sql-server - 生成大型 RS 报告时出现奇怪的 DataRowView 错误

> ID：609723
> 
> 赞同：0
> 
> 时间：2009-03-04T08:38:12.847
> 
> 标签：sql-server, sql-server-2005, reporting-services, datarowview

我有一个 ASP.NET 应用程序，`DotNetNuke`在我的大学中用于学生管理。

有时，在生成一些长时间运行的报告时，应用程序会抛出如下错误：

> DataBinding：“System.Data.DataRowView”不包含名为 XXXX 的属性

哪里`XXX`可能不一样。

我必须强调*所有这些属性*（似乎找不到）*都存在*，并且它们是由存储过程生成的（在 Sql Management Studio 中查询时）。代码在 95% 的情况下都可以工作，但是在生成报告时，它会停止工作......

重新编译或应用程序重新启动后，一切似乎都正常工作（直到我再次生成一些报告）。

该`DotNetNuke`站点可能一直都可以成功访问，而我的模块会抛出以前的异常。所有抛出错误的模块都是使用`SqlServerDataSource`. 我指定了一个`e.Command.CommandTimeout = 60;`但是......没有运气。我们的应用程序使用`ObjectDataSource`,`SqlDataSource`和代码隐藏数据绑定。这些错误似乎只出现在使用的页面中，`SqlDataSource`而不出现在使用`ObjectDataSource`或代码隐藏数据绑定的页面中。

为了解决机器上的这个“谜团”，我们创建了另一个实例，我们在其中移动了用于密集型和大型报告（如数据仓库）的表。对于本例，我们还安装了 Reporting Services。

因此，使用了 SQL 2005：

*   实例 1：主要生产数据库 + Reporting Services 实例 1，用于简单报表
*   实例 2：用于报告活动的数据库 + 用于大型报告的 Reporting Services 实例 2

我们还使用 1222 标志检查了死锁，但是当错误开始发生时，两个实例的日志中都没有死锁（实际上没有错误或警告）。

此外，主应用程序和两个报告服务实例都有单独的应用程序池。

服务器规格：

*   操作系统：Windows 2003 R2，64 位
*   SQL Server 2005 标准版，64 位
*   8 GB 内存
*   英特尔至强 E 5345 2.33 Ghz（2 个四核）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-31T04:44:36.240

使用 SQL Profiler 监视来自 SQL Server 的错误。这将告诉您是 SQL Server 愚蠢还是 Web 服务器端有问题。

# internet-explorer - IE 6.x 中的 Alpha 通道

> ID：609734
> 
> 赞同：1
> 
> 时间：2009-03-04T08:43:36.983
> 
> 标签：internet-explorer, png

> **可能重复：**
> [如何让 PNG 透明度在本身不支持它的浏览器中工作？](https://stackoverflow.com/questions/10243/how-to-get-png-transparency-working-in-browsers-that-dont-natively-support-it)

如何让 IE 6.x 正确显示 png 文件？

我有一位设计师坚持在背景图案上放置阴影，而出于某种原因坚持使用 IE 6.x 的客户

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T08:46:52.547

尝试在谷歌搜索“png hack”......提出[这个](http://www.mongus.net/pngInfo/)和[这个](http://webfx.eae.net/dhtml/pngbehavior/pngbehavior.html)

编辑：
不知何故重复[这个](https://stackoverflow.com/questions/10243/how-to-get-png-transparency-working-in-browsers-that-dont-natively-support-it)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T08:48:07.177

您的设计师是否绝对坚持在 IE6 中存在阴影？市场份额每天都在减少的浏览器。或者他会为大多数使用更现代浏览器的用户看到阴影而感到高兴。

这可能是技术决策，基于您的站点当前和预计的 IE 6 使用统计数据，以及实施这些阴影的成本。但是不要害怕从技术成本/收益的角度来争论它，而且并不是所有的浏览器都需要以相同的方式呈现您的网站。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T08:50:17.810

您可以直接使用 AlphaImageLoader，也可以通过许多覆盖它的脚本来使用。我个人推荐[IE7](http://dean.edwards.name/IE7/)，因为它解决了很多其他 IE6 问题，而不仅仅是 alpha 透明度。

此外，对于某些布局，可能完全没有透明度，但仍然看起来像您的设计师想要的那样。我不知道它是什么样子的，所以我不能肯定地说。

# google-app-engine - 如何在 Google App Engine 中实现互联网高分

> ID：609735
> 
> 赞同：10
> 
> 时间：2009-03-04T08:43:59.527
> 
> 标签：google-app-engine, gql, gqlquery

我想为我的游戏实现互联网高分。并向玩家反馈他们的位置（不仅仅是top100或类似的东西）。在普通 SQL 中，它看起来像这样：

SELECT COUNT(*) FROM Scores WHERE points > :newUsersPoints

和 GQL 有类似的东西

db.GqlQuery("SELECT * FROM Score WHERE points > :1", newUsersPoints).count()

但由于 count() 仅限于 1000，因此在我的情况下它不会很有用。您对如何实现这一点有任何想法吗？

我有两个

第一的：

1.  使用分片计数器的想法（[http://code.google.com/intl/pl/appengine/articles/sharding_counters.html](http://code.google.com/intl/pl/appengine/articles/sharding_counters.html)）创建新的“表”来存储在某个范围内的分数（from_points，to_points）

2.  总结上表中 range.to_points < newUsersPoints 的所有计数器

3.  在新分数为 db.GqlQuery("SELECT * FROM Score WHERE points > :1 AND points >= :2 AND points < :3", newUsersPoints, range.from_points, range. to_points).count() + sumfrom2

4.  查找新分数所在的范围并增加其计数器

5.  拆分计数器大于 1000（或 999）的范围，以便 3\. 不会达到限制

6.  将新分数添加到分数表

这是相当复杂且容易出错的。在添加分数之前，我们可能会增加一些范围和超时。（非交易性）

第二个想法：

不时（每天一次？）按分数对所有分数进行排序并给他们新的位置（脚本可能超时，所以我们必须分块执行）

要找出新分数在哪个地方，我们只需要做

db.GqlQuery("SELECT * FROM Score WHERE points > :1 LIMIT 1", newUsersPoints).get().precalculated_position + 1

还有其他想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-10T06:00:31.950

我已经在几个 GAE 应用程序中实现了 Ranker。它们是 Facebook 应用程序，有成千上万的人在玩。它运作良好，但就我而言，它有一个很大的缺点：您需要提前声明参与者分数将落入的最终范围。所以这很糟糕，原因有两个：

1.  如果你有一场没有尽头的比赛，人们的分数可以无上限地继续攀升，那么你就被圈住了。

2.  在比赛开始时，当每个人都聚集在一起接近零时，ranker.py 使用的树结构效率不高。这棵树很深，几乎没有使用它的任何宽度。

换句话说，ranker.py 非常适合您的参赛者的分数以均匀方式随机分布在已知值范围内的情况。对于其他用途，它不是最佳的。

我希望尽快开发出更通用的排名引擎。发生这种情况时肯定会更新此线程！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T08:57:00.757

google-appengine 组上的这个[线程](http://groups.google.com/group/google-appengine/browse_thread/thread/2c9831982eb67f53/a74344d0c250d1c1?lnk=gst&q=rank#a74344d0c250d1c1)可能会引起人们的兴趣。看起来也有一个专门用于此的库[ranklist](http://code.google.com/p/google-app-engine-ranklist/)。

基本上，听起来他们做了类似于分片计数器的事情。

# .net - WCF 绑定配置在哪里？

> ID：609743
> 
> 赞同：1
> 
> 时间：2009-03-04T08:46:10.567
> 
> 标签：.net, wcf, wcf-binding

我正在查看 Programming WCF Services 书中的流式传输，并且发现了关于配置的一行。

> 您需要根据所需的流模式在客户端或服务端（或两者）配置绑定

那么这是什么？我怎么知道我应该在哪里配置它们？这在 WCF 中很常见吗？对我来说似乎有点奇怪。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-08T20:01:00.253

这是一个关于如何在 web/app.config 中配置 WCF 服务的非常基本的示例：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <system.serviceModel>
        <services>
            <service name="MyServiceTypes.MyService" >
                <endpoint address="http://localhost:55555/MyService"
                          binding="basicHttpBinding"
                          contract="MyServiceTypes.IMyService" />
            </service>
        </services>
    </system.serviceModel>
</configuration> 
```

在客户端，您希望使用完全相同的端点设置，如下所示：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
    <system.serviceModel>
        <client>
            <endpoint address="http://localhost:55555/MyService"
                      binding="basicHttpBinding"
                      contract="MyServiceTypes.IMyService" />
        </client>
    </system.serviceModel>
</configuration> 
```

通过添加 bindingConfiguration 部分和类似的东西，有很多方法可以自定义绑定等。绑定配置可能是您配置流模式的位置。

放置合约接口通常是最佳实践；您的服务和客户端实现；如果可以的话，将您的 DataContract 类型（您的数据传输对象）放在一个单独的 DLL 中。如果您无法控制合同（例如，您正在访问您无法控制的机器上的服务），生成客户端代码的简单方法是使用 Visual Studio 中的“添加服务引用”，或者svcutil 工具。与添加服务引用相比，我更喜欢 svcutil，因为它可以让您更轻松地控制生成的代码在项目中的最终位置。

# oop - 在 Scala 中拥有伴生对象的基本原理是什么？

> ID：609744
> 
> 赞同：115
> 
> 时间：2009-03-04T08:46:40.783
> 
> 标签：oop, scala, companion-object

是否存在需要类的伴随对象（单例）的情况？为什么我要创建一个类，比如说`Foo`并为它创建一个伴生对象？

* * *

## 回答 #1

> 赞同：84
> 
> 时间：2009-03-04T22:54:04.537

伴随对象基本上提供了一个可以放置“类静态”方法的地方。此外，伴随对象或伴随模块可以完全访问类成员，包括私有成员。

伴随对象非常适合封装工厂方法之类的东西。例如，您可以让一个带有伴随对象的类承担工厂责任，而不是必须在任何地方都有`Foo`。`FooFactory`

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2010-08-20T12:16:35.337

伴随对象可用于存储类的所有实例共有的状态和方法，**但它们不使用静态**方法或字段。他们使用可以通过继承覆盖的常规虚拟方法。Scala 确实没有什么静态的。有很多方法可以使用它，但这里有一个简单的例子。

```
abstract class AnimalCounter
{
    var animals = 0

    def name: String

    def count()
    {
        animals += 1
        println("%d %ss created so far".format(animals, name))
    }
}

abstract class Animal
{
    def companion: AnimalCounter
    companion.count()
}

object Dog extends AnimalCounter
{
    val name = "dog"
}

class Dog extends Animal
{
    def companion = Dog
}

object Cat extends AnimalCounter
{
    val name = "cat"
}

class Cat extends Animal
{
    def companion = Cat
} 
```

产生这个输出：

```
scala> new Dog
1 dogs created so far

scala> new Cat
1 cats created so far

scala> new Dog
2 dogs created so far

scala> new Cat
2 cats created so far 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-03-10T12:55:21.493

...并且它是存储伴随类的静态工厂方法（不是那个 DP）的好地方。如果您将那些重载的工厂方法命名为 apply(/ *...* /) 您将能够创建/初始化您的类

1.  没有“新”（不是那么重要）

2.  具有不同的可能参数集（与 Bloch 在 Effective Java 中写的关于伸缩构造函数的内容相比）

3.  能够决定您要创建哪个派生类，而不是抽象（伴随的）派生类

示例代码：

```
abstract class AbstractClass;
class RealThing(s: String) extends AbstractClass;
class AlternativeThing(i: Int) extends AbstractClass;
object AbstractClass {
  def apply(s: String) = {
    new RealThing(s)
  }
  def apply(i: Int) = {
    new AlternativeThing(i)
  }
}

// somewhere else you can
val vs = AbstractClass("asdf")  // gives you the RealThing wrapped over string
val vi = AbstractClass(123)  // gives you AlternativeThing wrapped over int 
```

我不会调用对象/基类 AbstractXxxxx 因为它看起来不错：就像创建抽象的东西一样。给这些名字一个真正的意义。考虑使用不可变、无方法、案例类并封装抽象基类。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-03-04T23:12:28.253

除了 Saem 在[他的回复](https://stackoverflow.com/questions/609744/what-is-the-rationale-behind-having-companion-objects-in-scala/612848#612848)中所说的内容之外，Scala 编译器还在相应的伴随对象（源或目标）中查找类型的[隐式转换](http://www.artima.com/weblogs/viewpost.jsp?thread=179766)，因此不需要导入转换。

[关于Scala 编程中](http://www.artima.com/shop/programming_in_scala)的单例对象的原因说：

> 如第 1 章所述，Scala 比 Java 更面向对象的一种方式是 Scala 中的类不能有静态成员。相反，Scala 有单例对象（第 65 页）。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-05-11T13:13:24.733

我总是将伴随对象视为在 Scala 中编写函数式代码和面向对象代码的*桥梁。*很多时候，我们只需要接受一些输入并提供处理结果的纯函数。将这些相关函数放在伴随对象中可以很容易地查找和使用，对我自己以及在我的代码之上构建的一些人来说。

此外，它是一种语言提供的功能，可以在不做任何事情的情况下编写单例模式。当您需要一个单例来为 JVM 的生命周期封装委托者时，这尤其有用。例如，在 Scala 中编写一个简单的 HTTP 客户端库，您可以在其中封装基于 Java 实现的底层委托，并让 API 的使用者生活在纯粹的世界中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-22T17:56:35.877

如果您在同一个文件中以相同的名称定义类和对象，则它们称为伴生类和对象。Scala 没有 static 作为 JAVA 关键字，您可以将静态替换为 Scala 中的伴随类和对象。

有关更多详细信息，请查看 [Scala 编程中的文章类和对象关键字](https://blog.knoldus.com/2017/06/18/class-and-object-keyword-in-scala-programming/)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-11-02T15:14:00.577

首先，它提供了静态与非静态方法方法的清晰分离。还提供了一种创建单例类的简单方法。

它还可以从其他类和/或特征继承方法，这是 Java 静态方法无法做到的。并且可以作为参数传递。

# wcf - 在 Vista 上为 WCF 服务获取 System.ServiceModel.AddressAccessDeniedException

> ID：609750
> 
> 赞同：18
> 
> 时间：2009-03-04T08:49:25.130
> 
> 标签：wcf

我们有一个启动 WCF 服务器的应用程序，该应用程序从中读取数据。

它启动并且可以在所有 Windows XP 机器上正常阅读。

然而，在我们的 Vista 机器上，我们得到：

```
System.ServiceModel.AddressAccessDeniedException
"The process has no rights to this namespace."
System.Net.HttpListenerException 
```

URL 位于 localhost：

[http://localhost:8731/ABC.Testing.Business.Core/SecurityService/?wsdl](http://localhost:8731/ABC.Testing.Business.Core/SecurityService/?wsdl)

错误消息在这里发送给我们：

[http://msdn.microsoft.com/en-us/library/ms733768.aspx](http://msdn.microsoft.com/en-us/library/ms733768.aspx)

我们做了它所说的：

```
netsh http add urlacl url=... user=... 
```

更改了权限，但 WCF 服务仍然无法在 Vista 上启动。

有没有人有这方面的经验可以推动我们前进？谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2011-07-12T02:41:53.717

我在运行 Visual Studio 2010 的 Windows 7 上遇到了类似的问题。我的解决方案是一个简单的 WCF 服务库，其中一个简单的控制台项目用作 WCF 服务主机。

我在 app.config 中的基址是“http://localhost:8080/BookService”，我忘记了必须以管理员身份启动 Visual Studio 才能让 Windows 将该端口映射到我的应用程序。

一旦我以管理员身份启动 Visual Studio（右键单击，以管理员身份运行），它就像冠军一样运行。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-25T15:35:02.607

尝试通读这篇博文，看看是否有帮助。

[http://blogs.msdn.com/paulwh/archive/2007/05/04/addressaccessdeniedexception-http-could-not-register-url-http-8080.aspx](http://blogs.msdn.com/paulwh/archive/2007/05/04/addressaccessdeniedexception-http-could-not-register-url-http-8080.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-05-24T12:43:21.607

我在 Windows 8 操作系统上运行 VS2013 中的项目时遇到了类似的问题，当我以管理员身份启动项目时，这个问题得到了解决。

尝试以管理员身份启动您的应用程序。

感谢 Mayank Nagar

# asp.net - 如何在asp.net文本框多行中显示刹车线？

> ID：609753
> 
> 赞同：0
> 
> 时间：2009-03-04T08:50:42.957
> 
> 标签：asp.net, textbox

我有一个启用多行的文本框。但是当我按下回车按钮时我可以得到线刹车，关于如何让它工作的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T09:07:09.580

如果您调试多行文本框发布的内容，您可以看到该值是这样的：

> 第 1 行。**\r\n**第 2 行。

因此，如果您像这样分配多行文本框的文本属性，则可以使用中断设置文本：

```
txtMulti.Text = "line 1.\r\nline 2."; 
```

# ajax - onLoad 或类似的 Ajax？

> ID：609755
> 
> 赞同：0
> 
> 时间：2009-03-04T08:51:24.360
> 
> 标签：ajax

再会，

我想知道只有当服务器端代码页中包含的所有元素都完全加载时，是否有办法让 Ajax 移动到下一个代码段。当检索到的数据是纯文本时没有问题，但有时会包含照片。

这是我一直在使用的代码的一部分：

```
xajx.onreadystatechange = function(){
  if(xajx.readyState==4){
    document.all.div1.innerHTML = xajx.responseText;
    document.all.div1.style.display = “”;
  }
} 
```

问题是，当获取响应（readyState 设置为 4）并显示 div1 时，Photo 还没有完全加载，所以实际上用户可以看到图片慢慢出现的过程，就像他在任何其他“正常”的情况。我想要做的是让 div1 仅在所有组件完全加载后才可显示，同时系统在后台执行其工作。在 Ajax 之前，我像其他人一样使用隐藏的 iframe，因此我可以在 iframe 标记（或外部脚本）中包含一个 onload 事件处理程序，因此 div1 仅在 iframe 完全加载后才会出现，包括照片。

任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T08:56:23.443

您可以在图像本身上使用“onload”事件。当您像您的情况一样动态下载代码时，您需要弄清楚如何附加该事件。

# php - 您可以在会话中切换 PHP 会话吗？

> ID：609756
> 
> 赞同：11
> 
> 时间：2009-03-04T08:52:06.853
> 
> 标签：php, content-management-system, session, single-sign-on

我有两个要统一的应用程序。一个是我写的，另一个是我正在使用的 CMS。我的身份验证发生在我编码的那个中，我希望我的 CMS 知道该信息。问题是 CMS 使用一个会话名称，而我的应用程序使用另一个。由于可能的命名空间冲突，我不想让他们使用同一个，但我仍然想获得这些信息。

是否可以在请求中间切换会话名称？例如，在 CMS 中执行以下操作：

```
//session_start already called by cms by here

$oldSession = session_name();
session_name("SESSION_NAME_OF_MY_APP");
session_start();

//get values needed
session_name($oldSession);
session_start(); 
```

像这样的东西会起作用吗？如果在调用 session_start() 后这样的事情会起作用，我在文档或网络上找不到任何东西。提示？

除了这个解决方案，我一直在考虑只开发一个 Web 服务来获取信息，但显然只从会话中获取它会更好，因为该信息已经可用。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-10-25T09:05:19.107

这是一个如何在会话之间切换的工作示例：

```
session_id('my1session');
session_start();
echo ini_get('session.name').'<br>';
echo '------------------------<br>';
$_SESSION['value'] = 'Hello world!';
echo session_id().'<br>';
echo $_SESSION['value'].'<br>';
session_write_close();
session_id('my2session');
session_start();
$_SESSION['value'] = 'Buy world!';
echo '------------------------<br>';
echo session_id().'<br>';
echo $_SESSION['value'].'<br>';
session_write_close();
session_id('my1session');
session_start();
echo '------------------------<br>';
echo $_SESSION['value']; 
```

日志将如下所示：

```
 PHPSESSID
------------------------
my1session
Hello world!
------------------------
my2session
Buy world!
------------------------
Hello world!
```

因此，如您所见，会话变量在更改会话时保存和恢复。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T09:24:26.887

**注意：下面的答案不正确，请不要使用或投票。我把它留在这里作为讨论的地方**

您的解决方案应该可以工作（不是我曾经尝试过类似的事情），除了您必须在任何调用之前手动关闭上一个会话`session_name()`，否则它将默默地失败。

你可以尝试这样的事情：

```
session_write_close();
$oldsession = session_name("MY_OTHER_APP_SESSION");
session_start();

$varIneed = $_SESSION['var-I-need'];
session_write_close();
session_name($oldsession);
session_start; 
```

没有必要通过 PHP 会话 ID 操作例程或通过手动 cookie 修改来真正弄乱会话 ID 值 - PHP 将自行处理所有这些，您不应该搞砸。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-10T01:11:44.250

我一直在努力完善这一点，这就是我想出的。我使用子应用程序中的会话名称切换到父会话，然后返回到子应用程序的会话。如果父会话不存在，该解决方案将创建它。

```
$current_session_id = session_id();
$current_session_name = session_name();

session_write_close();

$parent_session_name = 'NameOfParentSession';

// Does parent session exist?   
if (isset($_COOKIE[$parent_session_name])) {

    session_id($_COOKIE[$parent_session_name]);
    session_name($parent_session_name);
    session_start();

} else {
    session_name($parent_session_name);
    session_start();

    $success = session_regenerate_id(true);
}

$parent_session_id = session_id();

// Do some stuff with the parent $_SESSION 

// Switch back to app's session
session_write_close();
session_id($current_session_id);
session_name($current_session_name);
session_start(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T09:15:00.450

[session_regenerate _id()](http://is.php.net/manual/en/function.session-regenerate-id.php)

该手册很好地解释了这一点，但这是手册中的一些示例

```
session_start();

$old_sessionid = session_id();

session_regenerate_id();

$new_sessionid = session_id();

echo "Old Session: $old_sessionid<br />";
echo "New Session: $new_sessionid<br />";

print_r($_SESSION); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T08:56:49.027

您应该使用[session_id](http://www.php.net/session_id)，您可以使用它来设置/获取会话 ID（或名称）。

因此，不要使用 session_name（在您的伪代码中），而是使用 session_id。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T09:16:26.780

[Zend_Session](http://framework.zend.com/manual/en/zend.session.html)为会话提供命名空间。

> Zend_Session_Namespace 实例是 $_SESSION 命名空间切片的访问器对象。Zend_Session 组件用管理接口包装现有的 PHP ext/session，并为 Zend_Session_Namespace 提供 API 以保持会话名称空间。Zend_Session_Namespace 提供了一个标准化的、面向对象的接口，用于处理 PHP 标准会话机制中持久化的名称空间。支持匿名和认证（例如，“登录”）会话名称空间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-04T09:18:22.440

有可能的。但我认为你必须自己处理会话：

```
session_name('foo');
// start first session
session_start();

// …

// close first session
session_write_close();

session_name('bar');
// obtain session id for the second session
if (ini_get('session.use_cookies') && isset($_COOKIE[session_name()])) {
    session_id($_COOKIE[session_naem()]);
} else if (ini_get('session.use_trans_sid') && !ini_get('session.use_only_cookies') && isset($_REQUEST[session_name()])) {
    session_id($_REQUEST[session_naem()]);
}
// start second session
session_start();

// … 
```

但请注意，您可能还会执行其他一些会话处理事情，例如 cookie 设置。我不知道 PHP 在这种情况下是否也这样做。

# sharepoint - SharePoint 注册表单 - 如何隐藏字段

> ID：609761
> 
> 赞同：1
> 
> 时间：2009-03-04T08:53:32.763
> 
> 标签：sharepoint, forms, sharepoint-2007, list

我使用 SharePoint 2007 自定义列表创建了一个基本注册表单，用户可以在其中填写表单上的字段。我创建了一个“审批者”字段，我试图向客户隐藏该字段，以便只有表单的审批者才能编辑该字段（批准请求 - 客户倾向于批准他们自己的请求）。如何隐藏此审批字段，使其只能由审批人编辑？

尝试的解决方案： 1\. 我将该批准列的内容类型设置为“隐藏”。我将如何访问隐藏审批字段的 URL，以便审批者可以访问该字段并为该特定项目更新它？如果我单击“编辑项目”，则隐藏字段不可见。我是否错过了隐藏内容类型的某些内容，以便在编辑页面上看到该列？2.我通过删除隐藏的批准字段在设计器中自定义了newform.aspx，它起作用了。但是自定义新表单时，“附加文件”不起作用。它吐出一个错误。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-08T23:58:55.737

查看 codeplex 中的[SPListDisplaySettings](http://splistdisplaysetting.codeplex.com/)组件。添加此解决方案将允许您指定如何根据 SharePoint 用户和组在显示、新建和编辑模式下显示字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T14:37:47.740

为什么不直接使用带有此列表的[审批工作流程？](http://office.microsoft.com/en-us/sharepointserver/HA101544251033.aspx)用户将能够创建批准请求，这将自动触发批准工作流，该工作流将创建任务并发送电子邮件以供批准者批准请求。一旦获得批准 - 请求的状态将更改为已批准。如果需要，审批人还可以在审批表上添加评论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T09:46:04.557

可能会创建一个自定义字段控件（[如何](http://msdn.microsoft.com/en-us/library/bb417414.aspx)？），它将在选择显示字段之前再次检查当前[用户角色。](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.sproleassignmentcollection.aspx)

与创建列表相比，这是非常硬的核心定制。

# java - 需要示例 Java 代码来运行 shellscript

> ID：609762
> 
> 赞同：-4
> 
> 时间：2009-03-04T08:55:13.087
> 
> 标签：java, shell

我尝试了许多不同的示例，但它不起作用。

我真的很感激一些示例 Java 代码来运行 shell 脚本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T09:03:11.540

你需要 Runtime.getRuntime().exec(...)。查看[一个非常广泛的示例](http://www.javaworld.com/javaworld/jw-12-2000/jw-1229-traps.html?page=4)（不要忘记阅读前三页）。

请记住， Runtime.exec*不是外壳*；如果你想执行一个 shell 脚本，你的命令行看起来像

```
/bin/bash scriptname 
```

也就是说，您需要的 shell 二进制文件是完全限定的（尽管我怀疑 /bin 总是在路径中）。你不能假设如果

```
myshell> foo.sh 
```

运行，

```
Runtime.getRuntime.exec("foo.sh"); 
```

也可以像在第一个示例中已经在运行的 shell 中一样运行，但不在 Runtime.exec 中。

[一个经过测试的示例（Works on My Linux Machine(TM)），大部分是从前面提到的文章中](http://www.javaworld.com/javaworld/jw-12-2000/jw-1229-traps.html?page=4)截取的：

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
public class ShellScriptExecutor {

    static class StreamGobbler extends Thread {
        InputStream is;

        String type;

        StreamGobbler(InputStream is, String type) {
            this.is = is;
            this.type = type;
        }

        public void run() {
            try {
                InputStreamReader isr = new InputStreamReader(is);
                BufferedReader br = new BufferedReader(isr);
                String line = null;
                while ((line = br.readLine()) != null)
                    System.out.println(type + ">" + line);
            } catch (IOException ioe) {
                ioe.printStackTrace();
            }
        }
    }

    public static void main(String[] args) {
        if (args.length < 1) {
            System.out.println("USAGE: java ShellScriptExecutor script");
            System.exit(1);
        }

        try {
            String osName = System.getProperty("os.name");
            String[] cmd = new String[2];
            cmd[0] = "/bin/sh"; // should exist on all POSIX systems
            cmd[1] = args[0];

            Runtime rt = Runtime.getRuntime();
            System.out.println("Execing " + cmd[0] + " " + cmd[1] );
            Process proc = rt.exec(cmd);
            // any error message?
            StreamGobbler errorGobbler = new StreamGobbler(proc
                    .getErrorStream(), "ERROR");

            // any output?
            StreamGobbler outputGobbler = new StreamGobbler(proc
                    .getInputStream(), "OUTPUT");

            // kick them off
            errorGobbler.start();
            outputGobbler.start();

            // any error???
            int exitVal = proc.waitFor();
            System.out.println("ExitValue: " + exitVal);
        } catch (Throwable t) {
            t.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-08T09:58:35.403

Shell 脚本 test.sh 代码

```
#!/bin/sh
echo "good" 
```

执行 shell 脚本 test.sh 的 Java 代码

```
 try {
            Runtime rt = Runtime.getRuntime();
            Process pr = rt.exec(new String[]{"/bin/sh", "./test.sh"});

            BufferedReader input = new BufferedReader(new InputStreamReader(pr.getInputStream()));
            String line = "";
            while ((line = input.readLine()) != null) {
                System.out.println(line);
            }
        } catch (Exception e) {
            System.out.println(e.toString());
            e.printStackTrace();
        } 
```

# visual-studio - 使 Visual Studio 部署文件夹的内容，而无需在项目中更新它

> ID：609763
> 
> 赞同：3
> 
> 时间：2009-03-04T08:55:30.653
> 
> 标签：visual-studio, deployment

在我的 web 项目中，我的 app_data 文件夹中经常有许多文件。这些文件可能会不时变化（例如翻译文件获得新语言，lucene 索引得到更新并获得新文件名等）。

如果文件单独添加到项目中，Visual Studio 只会将文件添加到部署过程中。所以如果一个文件已经添加到磁盘上，但不是在项目中，这个文件将不会被复制到服务器...

有没有办法让 VS 将文件夹中的*所有*文件添加到部署过程中，而无需我手动更新？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-06-08T17:13:45.183

您可以使用构建后事件将文件夹的内容复制到构建目标。

这应该让你开始：http: [//visualstudiohacks.com/general/customize-your-project-build-process/](http://visualstudiohacks.com/general/customize-your-project-build-process/)

哇，我刚刚看到这是在 2009 年被问到的……我希望你已经知道了：）

# php - 必需的邮件标头

> ID：609764
> 
> 赞同：0
> 
> 时间：2009-03-04T08:55:37.500
> 
> 标签：php, email

我有一个网站，我会在其中发送一封确认邮件作为注册过程的一部分。

前段时间，由于我没有使用标题（PHP邮件功能），我发送的邮件遇到了一些麻烦。

一旦我放置了一些标头，我就从用户那里得到了更多的响应，但我怀疑并不是每条消息都到达了它的目的地。

我如何确定消息到达目的地？

哪些标题可以被视为“必须”？

这是我的 SendMail 函数的代码

```
mail($to,
    $subject,
        $message,
            "MIME-Version: 1.0\n".
            "Content-type: text/plain; charset=ISO-8859-1; format=flowder\n".
            "Content-Transfer-Encoding: 8bit\n".
            "Message-Id: <" . md5(uniqid(microtime())) . "@mysite.com>\n".
            "Return-Path: <admin@mysite.com>\n".
            "X-Mailer: PHP v".phpversion()."\n".
            "From: admin@ mysite.com"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T09:20:00.530

您应该使用外部库来处理 php 中的电子邮件，例如[PhpMailer](http://phpmailer.codeworxtech.com)、[SwiftMailer](http://www.swiftmailer.org/)或[Zend_Mail](http://framework.zend.com/manual/en/zend.mail.html)。你所有的问题都会迎刃而解。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T09:04:27.090

标题需要在底部有一个空格来将标题与主体分开。像 Spam Assassin 这样的工具会给你一个很大的分数。

此外，您应该`\r\n`用作行终止符，而不仅仅是`\n`

[来自 PHP.net](http://is.php.net/manual/en/function.mail.php)

> 多个额外的标头应该用 CRLF (\r\n) 分隔。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T09:02:00.327

标题对我来说似乎很好。我看到的唯一故障是 From 标头中有一个额外的空格。

我确定你已经检查过了，但以防万一......

```
"From: admin@ mysite.com");
  should be (?)
"From: admin@mysite.com"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-05T08:16:59.007

这是我用于 html 邮件的有效邮件功能，变量 $return 被定义为在发送失败的情况下从邮件服务器获取错误报告。

```
$headers = "MIME-Version: 1.0" . "\r\n";
$headers .= "Content-type:text/html;charset=iso-8859-1" . "\r\n";
$headers .= 'From: <'.$from.'>' . "\r\n";
$return = '-f'.$from;

@mail($to, $subject, $msg, $headers, $return); 
```

您可以在此处查看更多详细信息[sugunan.com](http://www.sugunan.com/forum/title/1/how-to-send-html-mail-with-php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T09:07:47.720

标题看起来不错，除了@Eineki 指出的细节。此外，如果您使用的是 Windows，则需要以“user@mail.com”而不是“用户名”的形式发送 $to 参数，因为它可能会导致麻烦，因为 mail() 函数在 Windows 平台上实现的方式，“to”地址可能被错误地解析。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T09:16:02.460

您应该添加一个`Date:`标题（它是[RFC5322](https://www.rfc-editor.org/rfc/rfc5322)强制的），如果没有给出，一些邮件客户端可能会假设 1970 年 1 月 1 日作为电子邮件日期（并且它会在所有其他旧邮件之间丢失）。

# asp.net-mvc - 即时渲染视图

> ID：609772
> 
> 赞同：3
> 
> 时间：2009-03-04T08:58:45.683
> 
> 标签：asp.net-mvc, frameworks, view, render

我正在开发一个 ASP.NET MVC 应用程序，它将向用户发送一封确认电子邮件。对于电子邮件本身，我想创建一个视图，然后渲染该视图并使用 .NET 邮件对象发送它。

如何使用 MVC 框架做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T09:09:09.777

你基本上需要使用`IView.Render`. 您可以使用`ViewEngineCollection.FindView`(`ViewEngines.Engines.FindView`默认值) 来获取视图。将输出渲染到 a`TextWriter`并确保`ViewEngine.ReleaseView`之后调用。下面的示例代码（未经测试）：

```
StringWriter output = new StringWriter();

string viewName = "Email";
string masterName = "";

ViewEngineResult result = ViewEngines.Engines.FindView(ControllerContext, viewName, masterName);

ViewContext viewContext = new ViewContext(ControllerContext, result.View, viewData, tempData);
result.View.Render(viewContext, output);

result.ViewEngine.ReleaseView(ControllerContext, result.View);

string viewOutput = output.ToString(); 
```

我会把 viewData / tempData 留给你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-04T03:47:15.607

根据我对理查德回答的评论，这段代码确实有效，但它总是导致“发送 HTTP 标头后无法重定向”错误。

在对谷歌进行了*大量*挖掘并感到沮丧之后，我终于在这篇文章中找到了一些似乎可以解决问题的代码：

[http://mikehadlow.blogspot.com/2008/06/mvc-framework-capturing-output-of-view_05.html](http://mikehadlow.blogspot.com/2008/06/mvc-framework-capturing-output-of-view_05.html)

这家伙的方法是创建自己的HttpContext。

> 我没有使用 MVCContrib BlockRenderer，而是将当前的 HttpContext 替换为新的 HttpContext，该新的 HttpContext 承载写入 StringWriter 的响应。

这种方法效果很好（一个小的区别是我必须创建一个单独的动作来渲染我的局部视图，但那里没有戏剧性）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-12T03:37:57.310

这对我有用：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Web;
using System.Web.Mvc;

namespace Profiteer.WebUI.Controllers
{
    public class SampleController : Controller
    {
        public ActionResult Index()
        {
            RenderViewAsHtml(RouteData.Values["controller"].ToString(), 
                             RouteData.Values["action"].ToString());
            return View();
        }

        private void RenderViewAsHtml(string controllerName, string viewName)
        {
            var vEngine = (from ve in ViewEngineCollection
                           where ve.GetType() == typeof(RazorViewEngine)
                           select ve).FirstOrDefault();
            if (vEngine != null)
            {
                var view = 
                    vEngine.FindView(
                        ControllerContext, 
                        viewName, "_Layout", false).View as RazorView;
                if (view != null)
                {
                    var outPath = 
                       Server.MapPath(
                          string.Format("~/Views/{0}/{1}.html", 
                                        controllerName, viewName));
                    using (var sw = new StreamWriter(outPath, false))
                    {
                        var viewContext = 
                            new ViewContext(ControllerContext, 
                                            view, 
                                            new ViewDataDictionary(), 
                                            new TempDataDictionary(), 
                                            sw);
                        view.Render(viewContext, sw);
                    }
                }
            }
        }
    }
} 
```

# iis - IIS SMTP 服务器

> ID：609781
> 
> 赞同：1
> 
> 时间：2009-03-04T09:02:45.487
> 
> 标签：iis, smtp

我的应用程序每天需要发送数千封电子邮件。

所以我考虑编写自己的 smtp 服务器，使用 C#，它会每分钟拉一个数据库以查看是否有任何待处理的电子邮件。

但是，后来我遇到了微软的 IIS SMTP 服务......

**我的问题 ：**

IIS SMTP 服务可以处理这么多的外发电子邮件吗？它可靠吗？还是我应该重新发明轮子并自己编写？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T09:13:28.333

是的，IIS SMTP 可以处理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T12:03:40.187

是的 iis SMTP 应该没问题。但是你应该考虑的事情很少。

1.  负载测试服务器：这将为您提供一次可以发送的最大电子邮件数量。

2.  如果您打算发送大量电子邮件，最好在发送几封电子邮件后“睡觉”，然后继续其余的。

3.  我曾经写了一个 cron 作业来在短时间内发送电子邮件，我犯了一个错误，没有检查上一个作业的状态。一项工作在两者之间崩溃，第二个工作开始向同一个地址发送电子邮件，该地址崩溃了，然后下一个工作开始......

只有当你能设计出更好的轮子时才重新发明轮子；-)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-25T03:11:06.587

我会考虑使用第三方服务。这并不便宜，他们有充分的理由为此收费。1、如果您打算定期发送大量电子邮件，您需要与主要的电子邮件供应商建立信任关系：肯定是 gmail、hotmail、yahoo、excite、altavista 等。这种关系需要一段时间，但非常值得它。否则，您的服务器将很快被禁止。查看 iContact、Mailchimp 或 Aweber。

祝你好运

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T09:17:46.903

我建议您在 SMTP 服务器上进行一些负载测试，以确保它能够处理您期望对其施加的负载。

我不建议您通过构建自己的 SMTP 服务器来重新发明轮子。如果您发现 IIS SMTP 性能达不到标准，您可以尝试找到一个开源的。

# javascript - 从位置数据库中读取

> ID：609789
> 
> 赞同：0
> 
> 时间：2009-03-04T09:06:03.013
> 
> 标签：javascript, google-maps, dataset

我有这种情况，有人可以为我填补空白吗？就像这样：

**数据库表映射的字段：**

Map_ID、坐标、MarkerTitle、MarkerField。

**代码背后：**

```
Dim myTableAdapter As New myDatasetTableAdapters.tblMapsTableAdapters
Dim myTable As myDataset.tblMapsDataTable = myTableAdapter.GetAllMaps() 
```

现在，我一次分配一个值，以便能够在我的页面中显示一个 googleMap，只需使用 Friend 变量和代码隐藏，它在 PageLoad 上获取它们的值，并且我在我的脚本中声明了具有相同名称的变量，显示地图，就像：

**代码背后：**

```
Friend coordinates As String
Friend zoom As String
Friend maptitle As String
Friend text As String 
```

**脚本：**

```
<script type="text/javascript">
  function load() {
    var map = new GMap2(document.getElementById("map"));
    var marker1 = new GMarker(new GLatLng(<%=coordinates%>));
    var html1="<%=maptitle%><br/>" + "<%=text%>";
    map.setCenter(new GLatLng(<%=coordinates%>), 5);
    map.setMapType(G_HYBRID_MAP);
    map.addOverlay(marker1);

    map.addControl(new GLargeMapControl());
    map.addControl(new GScaleControl());
    map.addControl(new GMapTypeControl());
    marker.openInfoWindowHtml(html1);
  }
</script> 
```

我怎样才能从上面的过程转到类似的东西：将整个 tableOfMaps 传递给 JavaScript 或读取这些数据（从 JavaScript 端检索数据库信息），然后像这样迭代：

```
For Each map In MapsTable
{
var marker1 = new GMarker(new GLatLng(<%=coordinates%>));
var html1="<%=maptitle%><br/>" + "<%=text%>";
map.addOverlay(marker1);
marker.openInfoWindowHtml(html1);
} 
```

我知道这要求太多，因此我们将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T10:23:54.420

我将使用jQuery来简化事情，希望没关系...

在服务器端执行数据库查找，并将数据发送到 HTML。您应该寻求产生这样的东西：

```
<div id="maps-table">
  <div class="map-entry">
    <span class="map-title">Title 1</span>
    <span class="map-text">Text 1</span>
    <span class="map-coordinates">Coordinates 1</span>
  </div>
  <div class="map-entry">
    <span class="map-title">Title 2</span>
    <span class="map-text">Text 2</span>
    <span class="map-coordinates">Coordinates 2</span>
  </div>
  ...
</div> 
```

如果您使用的是 ASP.NET 之类的东西，则可以使用 asp:Repeater。

在 HTML 中呈现数据后，您可以对其进行查询和迭代：

```
$('#maps-table .map-entry').each(function() {

  var title = $(this).find('.map-title').text();
  var text = $(this).find('.map-text').text();
  var coordinates = $(this).find('.map-coordinates').text();

  // Add map markers here, eg:

  var marker = new GMarker(new GLatLng(coordinates));
  var html = title + "<br/>" + text;

  map.addOverlay(marker);
  marker.openInfoWindowHtml(html);

}); 
```

# .net - 为什么我不应该使用 Process.GetCurrentProcess().Kill() 来退出我的 WinForm 应用程序？

> ID：609795
> 
> 赞同：24
> 
> 时间：2009-03-04T09:08:53.303
> 
> 标签：.net, termination

现在，当用户想要退出我的应用程序时，我会做一些我必须做的事情（即从服务器断开连接，保存用户数据......）然后我执行以下操作：

*   使用布尔值退出我的所有主循环
*   中止仍在运行的线程（通常是我的服务器轮询线程）
*   请致电 Application.Exit();

这需要几秒钟才能退出，并且没有任何实际用途（所有内容都已保存在服务器上，所以我并不关心那里发生了什么）

如果我改用它，我会立即终止，没有我能想到的缺点：

```
 System.Diagnostics.Process.GetCurrentProcess().Kill(); 
```

为什么我不终止我的进程并让 CLR 删除 AppDomain ？

我知道仔细处理您的共享资源（IO 文件处理程序等）很重要（所以请不要回答这个问题:)），但是一旦完成，是否有真正的理由干净地退出我的应用程序？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-04T13:44:30.693

杀死进程意味着 finally 块将不会被执行，甚至可能不会执行[关键的终结器对象](http://msdn.microsoft.com/en-us/library/system.runtime.constrainedexecution.criticalfinalizerobject.aspx)，这实际上可能是关键的，并导致系统级别的资源泄漏。当其他人维护代码时，它还可能在将来导致意外的错误，因为他们（或您）将不得不扭头，每次他们编写 finally 块时都必须考虑它是否会被执行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T09:16:37.560

首先，我认为你的意思是`Process.Kill()`，不是`Process.TerminateProcess()`。其次，杀死进程只会把它撕掉。任何清理代码都不会执行，并且您的应用程序将没有机会取消终止（例如，如果用户有未保存的数据）。如果你对此感到满意，那就去吧。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-04T09:23:07.577

这确实是一个好问题！

曾几何时（十多年前），我写了一个 VB6 应用程序，由于 WinINet OCX（或其他任何名称）中的一个确认错误，由于它正在与之交谈的 Web 服务器上使用的特定证书，该应用程序在终止时挂起。

没有任何办法解决这个错误，我使用了 TerminateProcess，据我所知，这个应用程序已经在数千台机器上使用了好几年，我从未听说过关于这个 hack 的任何问题！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-30T20:39:32.490

使用第三方库而无法捕获它们的错误或泄漏，有时在不引发崩溃 MessageBox 的情况下结束它的唯一方法是终止进程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T09:28:31.027

请记住，如果您正在写入文件/网络流，则您的写入可能不完整。

如果您的应用程序已准备好以这种方式处理损坏的数据，那么没有理由不这样做。但是，如果您可以通过其他方式退出，我建议您这样做。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-13T12:43:11.463

应该注意的是[终结器实际上可能*永远不会*被执行](https://stackoverflow.com/questions/3458177/are-net-finalizers-always-executed)，因此终止进程与跳过终结代码的任何其他原因没有太大区别，例如慢终结器或终结器抛出异常。

总而言之，我不会太担心关闭应用程序需要几秒钟，特别是如果它立即隐藏所有窗口并为用户“消失”。但是，如果关闭需要几十秒和/或用户可能会再次执行应用程序并且它不支持多个实例，那么调用`Process.Kill`可能是一个好主意。

我知道一些应用程序需要很*长时间*才能终止，我希望有一天他们会残忍地杀死自己，而不是让我，用户，这样做（在操作系统重新启动时尤其烦人）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-14T19:41:26.117

Why not use [System.Environment.Exit(int)](http://msdn.microsoft.com/en-us/library/system.environment.exit.aspx)? It seems like you want to do this just to save code. To me it's much clearer to see the call to Exit does and your shutdown will be more controlled, Finalizers and Critical Finalizers will run.

# java - 将 Liferay portlet 导入 Eclipse IDE

> ID：609798
> 
> 赞同：1
> 
> 时间：2009-03-04T09:09:40.183
> 
> 标签：java, eclipse, liferay, liferay-ide

我有一个关于使用 liferay 插件 SDK 开发 liferay portlet 的问题。我的问题主要在于开发 IDE 的设置。建议的方法是使用我也尝试过的 Netbeans IDE，但它在我的机器上运行似乎非常缓慢，而 Eclipse 的性能非常好。Netbeans IDE 的设置如下

1.  转到目录 \portlets
2.  运行 create.bat（或 sh 文件，具体取决于操作系统）以创建新的示例 portlet
3.  运行 Netbeans IDE，创建一个新的“Java 自由形式项目”并将其指向创建的示例 portlet 的目录

就是这样，很简单。

由于上面提到的原因（并且因为我对 Eclipse 更熟悉），我想以同样的方式将项目导入 Eclipse。有没有一种方法可以做到这一点，而不必对创建的示例 portlet 的原始结构和相应的 build.xml（ant 文件）进行太多更改？我已经尝试从创建的示例 portlet 的 build.xml ant 文件中创建一个新项目，但是这样它不包括我的源代码。

我也没有在网上找到很好的教程......有人可以帮我解决这个问题，指出在线教程或给我一些提示。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-11T06:36:48.353

我知道你的痛苦。开始使用 Liferay 需要很多时间。如果您不想编辑现有源代码，而只想创建您自己的 portlet，您可以从 Liferay 网站上的“附加文件”部分下载插件 SDK。这提供了 ant 脚本，以创建一个简单的 JSR 兼容的 portlet，并创建所有必要的东西，以创建一个健全的 Eclipse 项目，例如：

```
ant -Dportlet.name=<project name> -Dportlet.display.name="<portlet title>" create 
```

然后 cd 进入您创建的 portlet 的目录并执行以下操作：

```
ant setup-eclipse 
```

之后，您应该能够从 Eclipse 中该目录中的源代码创建一个新项目，然后可以通过另一个 ant 脚本将其部署到正在运行的 tomcat 实例。如果您已经了解一些关于 portlet 编程的知识，那么您现在应该已经很确定了。如果没有，请先尝试查找有关 JSR portlet 编程的文档，然后再查看 Liferay 规范 portlet 开发。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-08T16:39:14.167

Liferay 现在已经发布了一组支持portlet 开发的官方Eclipse 插件。以下是安装 eclipse 插件的安装指南：

[Liferay IDE 安装指南](http://www.liferay.com/community/wiki/-/wiki/Main/Liferay+IDE+Installation+Guide)

还有一个入门指南，它显示了安装后要做什么来实际设置您的第一个 portlet 项目。

[入门教程](http://www.liferay.com/community/wiki/-/wiki/Main/Liferay+IDE+Getting+Started+Tutorial)

Liferay IDE 在幕后使用 Liferay 的插件 SDK 来完成所有工作。如果您已经有使用 Plugins SDK 创建的现有项目，也可以将它们导入 Liferay IDE。

[导入现有项目](http://www.liferay.com/community/wiki/-/wiki/Main/Liferay+IDE+Importing+Existing+Projects)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-07T09:37:53.357

你可以找到在**eclipse**中部署**liferay的教程**

 **[http://www.liferay.com/web/guest/community/wiki/-/wiki/Main/Development+Environment+(Windows)](http://www.liferay.com/web/guest/community/wiki/-/wiki/Main/Development+Environment+(Windows))

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T16:48:09.457

不知道 Liferay 的细节，但总的来说，我会这样做：

1.  按照 NB 设置列表中的步骤 1 和 2
2.  在 Eclipse 中创建一个新的动态 Web 项目（如果您不需要 Web 项目的功能，则可以创建一个 Java 项目）
3.  通过在 Eclipse 中执行 Import -> File system 来导入示例 portlet 目录的内容
4.  调整项目的 Java 源目录以指向生成的示例 portlet 源目录（现在应该出现在您的项目中）
5.  调整项目的类路径，将其指向 LR lib 文件夹，...
6.  如果有生成的 build.xml，检查它是否可用于部署到 LR，或生成构建。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-23T16:24:56.453

截至 2011 年 3 月，有一些对 NetBeans 的官方 Liferay 支持，如前所述，有对 Eclipse 的官方支持（在市场中）。Documentarian 自己使用 Eclipse，尽管许多示例只是使用带有 shell 脚本、ant 脚本且没有 IDE 的 Plugins-SDK。

我们在 Eclipse 上与 Liferay 进行了斗争，Eclipse 似乎有问题且不可预测，但我们对 J2EE 和 Eclipse 也是新手（所以请稍微忽略最后一条评论），并且我在 SVN 的单独区域中设置了我们的 portlet 文件，需要重构-move，重构肯定是错误的。

您应该知道，官方纪录片即将推出一本面向开发人员的书——我们已经购买了早期版本并发现它很有用。他确实涵盖了一些 IDE 问题。见曼宁出版社。

Liferay 示例 portlet（有很多）不是为 Eclipse 项目设置的，您必须导入一些 java 文件并跳过一些 Eclipse 箍，才能将它们放入您可以开发的正在运行的 Eclipse 项目中。

# c# - .NET 的离散事件模拟框架

> ID：609799
> 
> 赞同：5
> 
> 时间：2009-03-04T09:09:53.583
> 
> 标签：c#, .net, events, simulation

有没有人有一些可以在.NET（C#）中使用的离散事件模拟库的经验？

尽管有排队事件和调度它们的基本功能，但有一些非确定性的行为（例如故障模拟）是可以的。

我有一些技巧，我什至正在考虑自己写，但首先，我想收集一些建议。

谢谢。

**附加信息：**我没有明确寻找免费产品，但是，奖品很重要:) 只是为了精确我需要映射的领域，这里是一个产品的例子：http: [//www.holushko.com/index。 html](http://www.holushko.com/index.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T09:38:34.310

那里有很多基于模拟的产品供应商，但他们会想要钱，而且通常需要很多钱。例如 - [http://www.solver.com/exceluse.htm](http://www.solver.com/exceluse.htm)作为其中之一） - 这个是基于 excel 的，但他们也为它提供 SDK。

当我查看 - [COIN - OR](http://www.coin-or.org/) - 运筹学计算基础设施时，他们的项目中没有列出离散事件模拟框架。这个站点是运筹学的站点，因为模拟属于 OR 我在那里看了一下。

我想我在硬拷贝的某个地方对模拟包进行了审查，但它们都是为产品付费的，所以在你的情况下可能不是一个选择。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T09:47:51.243

前段时间我考虑编写类似 Simula.Simulation 系统的东西（只是一个小的可行性检查），但对 dotNet 中缺乏 Fiber（协程）支持感到失望。我最终在 Delphi/Win32 中完成了它，因为 Windows 确实有 Fibers。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-20T13:39:25.410

你可以试试 MicroSaint。它价格昂贵，但功能强大。我曾将早期版本用于一个非常严肃的商业级分析项目。链接如下 [http://www.maad.com/index.pl/micro_saint](http://www.maad.com/index.pl/micro_saint)

# iphone - 如何为 iPhone 创建安装程序包？

> ID：609800
> 
> 赞同：1
> 
> 时间：2009-03-04T09:11:24.640
> 
> 标签：iphone, objective-c

如何为 iPhone 创建安装程序包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T09:29:53.410

您应该以更详细和更好的方式公开您的问题。你在用xcode吗？它拥有为 iPhone 构建应用程序所需的一切。

您只需编写应用程序代码，然后点击“构建”或“构建并运行”按钮，就会自动生成 .app 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T13:55:25.253

iPhone 没有“安装程序包”之类的东西。作为开发人员，您创建一个包含可执行文件和所有资源的应用程序包，然后将其压缩并通过 iTunes Connect 将其上传到 App Store。

iPhone 程序门户中提供了将应用程序上传到 App Store 的详细说明。

设备上的应用程序安装由 iPhone OS 和 App Store 或 iTunes 处理（或在开发期间由 Xcode 处理）。

# pdf - 将 Foxit PDF Reader 嵌入网页

> ID：609804
> 
> 赞同：2
> 
> 时间：2009-03-04T09:12:34.323
> 
> 标签：pdf, deployment, object-tag, foxit

我需要将 Foxit Reader（PDF 阅读软件）嵌入到网页中。有谁知道在以下代码中使用的正确 classid 和参数：

```
<object id="pdfReaderObj" classid="CLSID:XXXX" width="500" height="700">
    <param name="Filename" value="/1234-56789-abc-123-3.pdf">
    <param name="SRC" value="/1234-56789-abc-123-3.pdf">
    You must install Foxit Reader to view this document.
</object> 
```

此外，如果有人有企业部署、静默安装、注册表设置等经验。这些也将受到欢迎。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-11T18:46:00.287

福昕阅读器本身不包含任何可嵌入组件；为此，他们有[Foxit Reader ActiveX ，这是一个与 Reader 分开分发的付费组件。](http://www.foxitsoftware.com/pdf/sdk/activex/)例如，标准 ActiveX 版本可以通过以下方式嵌入到网页中：

```
<script type="text/javascript"">
function openFile() {
    document.getElementById("foxitReader").OpenFile("foo.pdf", "");
}
</script>

<body onload="openFile()">
    <object id="foxitReader"
        classid="clsid:DB2189DF-ABF4-445A-A4E5-BF32F2CEA4D9"
        width="800" height="600">
    <p>You must install Foxit Reader ActiveX to view this PDF file.</p>
    </object>
</body> 
```

（我不是网络开发人员，所以这段代码可能远非完美，但它应该可以帮助你理解这个想法。）

如果您不适合使用 Foxit Reader ActiveX，请查看[此问题](https://stackoverflow.com/questions/291813/best-way-to-embed-pdf-in-html)，该问题讨论了显示 PDF 内容的其他可能方式。

# wpf - 无法让 MediaElement Storyboard 自动反转

> ID：609807
> 
> 赞同：1
> 
> 时间：2009-03-04T09:14:12.200
> 
> 标签：wpf, video

这让我很疯狂。我试图让 WMV 文件在播放完毕后自动反转，但它不起作用。我尝试将 Storyboard autoreverse 设置为 true，但这会引发错误，说明

“带有 CanSlip 的时钟不能有带有 AutoReverse、AccelerationRatio 或 DecelerationRatio 的父代或父代。”

这是因为我使用的不是动画而是视频吗？我怎样才能达到同样的目的？我的视频正在播放，播放、暂停和恢复。但是完成后它就停止了。

我有三个故事板，一个是视频本身。还有两个动画在视频播放和暂停时淡出白色矩形。

代码如下所示：

```
public partial class Window1
{

    public Storyboard RectangleFadeA;
    public Storyboard RectangleFadeBackA;
    public Storyboard VideoA;

    bool isPlaying;
    bool isPaused;

    public Window1()
    {
        this.InitializeComponent();

        // Insert code required on object creation below this point.
        RectangleFadeA = (Storyboard)TryFindResource("RectangleFadeA");
        RectangleFadeBackA = (Storyboard)TryFindResource("RectangleFadeBackA");
        VideoA = (Storyboard)TryFindResource("GTTV_promo_wmv");          

        isPlaying = false;
        isPaused = false;
    }

    private void rectangle_MouseDown(object sender, System.Windows.Input.MouseButtonEventArgs e)
    {
        if (!isPlaying)
        {
            if (!isPaused)
            {

                if (RectangleFadeA != null)
                    RectangleFadeA.Begin(this, true);

                if (VideoA != null)
                    VideoA.Begin(this, true);

                isPlaying = true;
                return;

            }
            if (isPaused)
            {
                if (RectangleFadeA != null)
                    RectangleFadeA.Begin(this, true);
                if (VideoA != null)
                    VideoA.Resume(this);
                isPaused = false;
                isPlaying = true;
                return;
            }
        }

        if (isPlaying)
        {
            if (RectangleFadeBackA != null)
                RectangleFadeBackA.Begin(this, true);
            VideoA.Pause(this);
            isPlaying = false;
            isPaused = true;
            return;

        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-05T14:22:13.387

刚刚找到没有太多代码的解决方案。首先，我将视频 (MediaTimeLine) 设置为 repeatbehaviour=forever。然后我在“MediaEnded”处向 MediaElement 添加一个事件处理程序

C# 代码如下所示：

```
private void GTTV_promo_wmv_MediaEnded(object sender, RoutedEventArgs e)
    {
        RectangleFadeBackA.Begin(this, true);
        VideoA.Pause(this);
        isPaused = true;
        isPlaying = false;
        return;

    } 
```

因此，到目前为止，完整的 C# 代码如下所示：

```
public partial class Window1
{
    public Storyboard RectangleFadeA;
    public Storyboard RectangleFadeBackA;

    public Storyboard VideoA;

    bool isPlaying;
    bool isPaused;

    public Window1()
    {
        this.InitializeComponent();

        // Insert code required on object creation below this point.
        RectangleFadeA = (Storyboard)TryFindResource("RectangleFadeA");
        RectangleFadeBackA = (Storyboard)TryFindResource("RectangleFadeBackA");
        VideoA = (Storyboard)TryFindResource("GTTV_promo_wmv");
        isPlaying = false;
        isPaused = false;

    }

    private void rectangle_MouseDown(object sender, System.Windows.Input.MouseButtonEventArgs e)
    {
        if (!isPlaying)
        {
            if (!isPaused)
            {

                if (RectangleFadeA != null)
                    RectangleFadeA.Begin(this, true);

                if (VideoA != null)
                    VideoA.Begin(this, true);

                isPlaying = true;
                return;

            }
            if (isPaused)
            {
                if (RectangleFadeA != null)
                    RectangleFadeA.Begin(this, true);
                if (VideoA != null)
                    VideoA.Resume(this);
                isPaused = false;
                isPlaying = true;
                return;
            }

        }

        if (isPlaying)
        {
            if (RectangleFadeBackA != null)
                RectangleFadeBackA.Begin(this, true);
            VideoA.Pause(this);
            isPlaying = false;
            isPaused = true;
            return;

        }

    }

    private void ButtonWebcam_Click(object sender, RoutedEventArgs e)
    {
        OpeningWindows.Window2 Window2 = new OpeningWindows.Window2();
        Window2.ShowDialog();
    }

    private void GTTV_promo_wmv_MediaEnded(object sender, RoutedEventArgs e)
    {
        RectangleFadeBackA.Begin(this, true);
        VideoA.Pause(this);
        isPaused = true;
        isPlaying = false;
        return;

    }
} 
```

# c++ - STL 中的 Eclipse C++ 调试中断

> ID：609810
> 
> 赞同：2
> 
> 时间：2009-03-04T09:15:54.783
> 
> 标签：c++, eclipse, debugging, stl

我是使用 Eclipse 调试的新手。

我尝试调试我的应用程序以了解它的段错误。

问题是 Eclipse 在 STL 内部中断，这很烦人。

例如：我在我的源文件中的第 134 行创建了一个断点，它工作正常，但如果我按 F6 键“Step Over”，Eclipse/gdb 会在下一行使用 std::cout 的 basic_string 构造函数中中断。

对此有任何提示吗？是否有 Eclipse 等的配置选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T09:20:23.463

也许这就是它的段错误？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T09:52:00.423

我没有使用过 Eclipse，但我确信有一个“堆栈回溯”或“调用堆栈”视图，您可以使用它来查看最终在 STL 代码中的调用链。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-05T11:35:01.150

鉴于信息有限，这就是我想到的，

1.  进入 (F5) 而不是跨过 (F6) 以定位发生这种情况的位置。
2.  如果这不起作用，请将 CDT 升级到最新版本并重试。
3.  如果这也不起作用，请尝试在没有 Eclipse 的情况下使用 gdb。
4.  最后一个选项，输入一堆 cerr 输出。注意 cerr （未缓冲）不是 cout。

如果这些都不起作用，请发布更多详细信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-05T11:42:08.590

我有类似的问题。这是关于内联函数（stl cuases）。

您需要添加一些编译器标志来生成一些额外的调试信息。如果您使用 gcc，请参阅 -g* 标志（-ggdb 用于 gdb 调试器合规性，它为您提供了对此类调试器的最体面的支持）。

此外，您可能想要关闭优化。

Ps 我不够清楚：这不是 Eclipse 的错，而是编译器/调试器的错。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T14:05:03.530

如果代码经过优化，那么它可能会在 stl 中中断。尝试使用调试模式进行编译，它可能会有所帮助。

# java - ThreadLocal 变量的性能

> ID：609826
> 
> 赞同：91
> 
> 时间：2009-03-04T09:22:41.883
> 
> 标签：java, multithreading, performance, thread-local

从`ThreadLocal`变量中读取的速度比从常规字段中读取的速度慢多少？

更具体地说，简单的对象创建比访问`ThreadLocal`变量更快还是更慢？

我认为它足够快，因此拥有实例比每次`ThreadLocal<MessageDigest>`创建实例都要快得多。`MessageDigest`但这也适用于 byte[10] 或 byte[1000] 吗？

编辑：问题是调用`ThreadLocal`get 时到底发生了什么？如果这只是一个领域，就像任何其他领域一样，那么答案将是“它总是最快的”，对吧？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-03-04T11:36:20.250

2009 年，一些 JVM`ThreadLocal`使用非同步对象`HashMap`实现。`Thread.currentThread()`这使得它变得非常快（当然，虽然不如使用常规字段访问快），并确保对象在死亡`ThreadLocal`时得到整理。`Thread`在 2016 年更新了这个答案，似乎大多数（全部？）较新的 JVM 都使用`ThreadLocalMap`线性探测。我不确定它们的性能——但我无法想象它比早期的实现要差得多。

当然，`new Object()`这几天也很快，垃圾收集器也很擅长回收短寿命的对象。

除非您确定创建对象会很昂贵，或者您需要逐个线程地保持某些状态，否则您最好在需要时使用更简单的分配解决方案，并且仅在`ThreadLocal`探查器时切换到实现告诉你你需要。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-03-04T11:56:55.117

在我的机器上运行未发布的基准测试，`ThreadLocal.get`每次迭代大约需要 35 个周期。没什么大不了的。在 Sun 的实现中，将 s 映射到值中的自定义线性探测哈希`Thread`映射`ThreadLocal`。因为它只能由单个线程访问，所以它可以非常快。

小对象的分配需要相似数量的周期，尽管由于缓存耗尽，您可能会在紧密循环中获得较低的数字。

建设`MessageDigest`可能相对昂贵。它具有相当数量的状态，并且通过`Provider`SPI 机制进行构建。您可以通过例如克隆或提供`Provider`.

仅仅因为在 a 中缓存而不是在创建中可能更快`ThreadLocal`并不一定意味着系统性能会提高。您将有与 GC 相关的额外开销，这会减慢一切。

除非您的应用程序非常频繁地使用，否则您`MessageDigest`可能需要考虑使用传统的线程安全缓存。

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2011-01-21T07:59:41.400

好问题，我最近一直在问自己。为了给你确定的数字，下面的基准测试（在 Scala 中，编译为与等效 Java 代码几乎相同的字节码）：

```
var cnt: String = ""
val tlocal = new java.lang.ThreadLocal[String] {
  override def initialValue = ""
}

def loop_heap_write = {                                                                                                                           
  var i = 0                                                                                                                                       
  val until = totalwork / threadnum                                                                                                               
  while (i < until) {                                                                                                                             
    if (cnt ne "") cnt = "!"                                                                                                                      
    i += 1                                                                                                                                        
  }                                                                                                                                               
  cnt                                                                                                                                          
} 

def threadlocal = {
  var i = 0
  val until = totalwork / threadnum
  while (i < until) {
    if (tlocal.get eq null) i = until + i + 1
    i += 1
  }
  if (i > until) println("thread local value was null " + i)
} 
```

可[在此处](https://github.com/axel22/threads/blob/master/src/main/scala/scala/threads/ParallelTests.scala)获得，在 AMD 4x 2.8 GHz 双核和具有超线程 (2.67 GHz) 的四核 i7 上执行。

这些是数字：

## i7

**规格：Intel i7 2x 四核 @ 2.67 GHz 测试：scala.threads.ParallelTests**

**测试名称：loop_heap_read**

线程数：1 总测试：200

运行时间：（显示最后 5 个）9.0069 9.0036 9.0017 9.0084 9.0074（平均 = 9.1034 最小值 = 8.9986 最大值 = 21.0306）

线程数：2 总测试：200

运行时间：（显示最后 5 个）4.5563 4.7128 4.5663 4.5617 4.5724（平均 = 4.6337 最小值 = 4.5509 最大值 = 13.9476）

线程数：4 总测试：200

运行时间：（显示最后 5 个）2.3946 2.3979 2.3934 2.3937 2.3964（平均 = 2.5113 最小值 = 2.3884 最大值 = 13.5496）

线程数：8 总测试：200

运行时间：（显示最后 5 个）2.4479 2.4362 2.4323 2.4472 2.4383（平均 = 2.5562 分钟 = 2.4166 最大值 = 10.3726）

**测试名称：threadlocal**

线程数：1 总测试：200

运行时间：（显示最后 5 个）91.1741 90.8978 90.6181 90.6200 90.6113（平均 = 91.0291 分钟 = 90.6000 最大 = 129.7501）

线程数：2 总测试：200

运行时间：（显示最后 5 个）45.3838 45.3858 45.6676 45.3772 45.3839（平均 = 46.0555 分钟 = 45.3726 最大 = 90.7108）

线程数：4 总测试：200

运行时间：（显示最后 5 个）22.8118 22.8135 59.1753 22.8229 22.8172（平均 = 23.9752 最小值 = 22.7951 最大值 = 59.1753）

线程数：8 总测试：200

运行时间：（显示最后 5 个）22.2965 22.2415 22.3438 22.3109 22.4460（平均 = 23.2676 分钟 = 22.2346 最大 = 50.3583）

## AMD

**规格：AMD 8220 4x 双核 @ 2.8 GHz 测试：scala.threads.ParallelTests**

**测试名称：loop_heap_read**

总工作量：20000000 线程数：1 总测试：200

运行时间：（显示最后 5 个）12.625 12.631 12.634 12.632 12.628（平均 = 12.7333 最小 = 12.619 最大 = 26.698）

测试名称：loop_heap_read 总工作量：20000000

运行时间：（显示最后 5 个）6.412 6.424 6.408 6.397 6.43（平均 = 6.5367 最小值 = 6.393 最大值 = 19.716）

线程数：4 总测试：200

运行时间：（显示最后 5 个）3.385 4.298 9.7 6.535 3.385（平均 = 5.6079 最小值 = 3.354 最大值 = 21.603）

线程数：8 总测试：200

运行时间：（显示最后 5 个）5.389 5.795 10.818 3.823 3.824（平均 = 5.5810 最小值 = 2.405 最大值 = 19.755）

**测试名称：threadlocal**

线程数：1 总测试：200

运行时间：（显示最后 5 个）200.217 207.335 200.241 207.342 200.23（平均 = 202.2424 最小值 = 200.184 最大值 = 245.369）

线程数：2 总测试：200

运行时间：（显示最后 5 个）100.208 100.199 100.211 103.781 100.215（平均 = 102.2238 最小 = 100.192 最大 = 129.505）

线程数：4 总测试：200

运行时间：（显示最后 5 个）62.101 67.629 62.087 52.021 55.766（平均 = 65.6361 最小值 = 50.282 最大值 = 167.433）

线程数：8 总测试：200

运行时间：（显示最后 5 个）40.672 74.301 34.434 41.549 28.119（平均 = 54.7701 最小 = 28.119 最大 = 94.424）

## 概括

本地线程大约是堆读取的 10-20 倍。在这个 JVM 实现和这些架构上，它似乎也可以很好地扩展处理器的数量。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-04T10:14:47.717

@Pete 在您优化之前是正确的测试。

如果与实际使用相比，构造 MessageDigest 有任何严重的开销，我会感到非常惊讶。

错过使用 ThreadLocal 可能是泄漏和悬空引用的来源，它们没有明确的生命周期，通常我从不使用 ThreadLocal 没有非常明确的计划何时删除特定资源。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-09-07T09:19:50.237

这是另一个测试。结果显示 ThreadLocal 比常规字段慢一点，但顺序相同。大约慢 12%

```
public class Test {
private static final int N = 100000000;
private static int fieldExecTime = 0;
private static int threadLocalExecTime = 0;

public static void main(String[] args) throws InterruptedException {
    int execs = 10;
    for (int i = 0; i < execs; i++) {
        new FieldExample().run(i);
        new ThreadLocaldExample().run(i);
    }
    System.out.println("Field avg:"+(fieldExecTime / execs));
    System.out.println("ThreadLocal avg:"+(threadLocalExecTime / execs));
}

private static class FieldExample {
    private Map<String,String> map = new HashMap<String, String>();

    public void run(int z) {
        System.out.println(z+"-Running  field sample");
        long start = System.currentTimeMillis();
        for (int i = 0; i < N; i++){
            String s = Integer.toString(i);
            map.put(s,"a");
            map.remove(s);
        }
        long end = System.currentTimeMillis();
        long t = (end - start);
        fieldExecTime += t;
        System.out.println(z+"-End field sample:"+t);
    }
}

private static class ThreadLocaldExample{
    private ThreadLocal<Map<String,String>> myThreadLocal = new ThreadLocal<Map<String,String>>() {
        @Override protected Map<String, String> initialValue() {
            return new HashMap<String, String>();
        }
    };

    public void run(int z) {
        System.out.println(z+"-Running thread local sample");
        long start = System.currentTimeMillis();
        for (int i = 0; i < N; i++){
            String s = Integer.toString(i);
            myThreadLocal.get().put(s, "a");
            myThreadLocal.get().remove(s);
        }
        long end = System.currentTimeMillis();
        long t = (end - start);
        threadLocalExecTime += t;
        System.out.println(z+"-End thread local sample:"+t);
    }
}
}' 
```

输出：

0-跑步现场样本

0-结束字段样本：6044

0-运行线程本地示例

0-结束线程局部样本：6015

1-跑场样本

1-结束字段样本：5095

1-运行线程本地示例

1-结束线程本地样本：5720

2-跑场样本

2 端字段样本：4842

2-运行线程本地示例

2端螺纹局部样品：5835

3-跑场样本

3 端字段示例：4674

3-运行线程本地示例

3端螺纹局部样品：5287

4-跑场样本

4 端字段样本：4849

4-运行线程本地示例

4 端螺纹局部样品：5309

5-跑场样本

5端字段样本：4781

5-运行线程本地示例

5端螺纹局部样品：5330

6-跑场样本

6端字段样本：5294

6-运行线程本地示例

6端螺纹局部样品：5511

7-跑场样本

7端字段样本：5119

7-运行线程本地示例

7 端螺纹局部样品：5793

8-跑场样本

8 端字段样本：4977

8-运行线程本地示例

8 端螺纹局部样例：6374

9-跑场样本

9端字段样本：4841

9-运行线程本地示例

9 端螺纹局部样品：5471

场均值：5051

线程本地平均：5664

环境：

openjdk 版本“1.8.0_131”

Intel® Core™ i7-7500U CPU @ 2.70GHz × 4

Ubuntu 16.04 LTS

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T09:42:48.090

建造它并测量它。

此外，如果您将消息摘要行为封装到一个对象中，则您只需要一个 threadlocal。如果出于某种目的需要本地 MessageDigest 和本地 byte[1000]，请创建一个带有 messageDigest 和 byte[] 字段的对象，并将该对象放入 ThreadLocal 而不是单独放入。

# python - 在 Python 中对字符串进行标题大小写的问题

> ID：609830
> 
> 赞同：3
> 
> 时间：2009-03-04T09:24:35.030
> 
> 标签：python, string, uppercase

我有一个名字作为字符串，在这个例子中是“markus johansson”。

我正在尝试编写一个使“m”和“j”大写的程序：

```
name = "markus johansson"

for i in range(1, len(name)):
    if name[0] == 'm':
        name[0] = "M"
    if name[i] == " ":
        count = name[i] + 1
    if count == 'j':    
            name[count] = 'J' 
```

我很确定这应该可行，但它给了我这个错误：

```
File "main.py", line 5 in <module> 
   name[0] = "M" 
TypeError: 'str' object does support item assignment 
```

我知道有一个名为 .title() 的库函数，但我想做“真正的编程”。

我该如何解决？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-04T09:31:19.833

我想你想要实现的是：

```
from string import capwords
capwords(name) 
```

产生：

```
'Markus Johansson' 
```

编辑：好的，我看到你想拆掉一扇敞开的门。这是低级实现。

```
''.join([char.upper() if prev==' ' else char for char,prev in zip(name,' '+name)]) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-04T10:55:15.607

```
>>> "markus johansson".title()
'Markus Johansson' 
```

内置的字符串方法是要走的路。

编辑：我看到你想重新发明轮子。有什么特别的原因吗？您可以从任意数量的复杂方法中进行选择，例如：

```
' '.join(j[0].upper()+j[1:] for j in "markus johansson".split()) 
```

标准库仍然是要走的路。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-04T12:08:36.290

### `string.capwords()`（定义在[`string.py`](http://svn.python.org/view/python/trunk/Lib/string.py?view=markup)）

```
# Capitalize the words in a string, e.g. " aBc  dEf " -> "Abc Def".
def capwords(s, sep=None):
    """capwords(s, [sep]) -> string

    Split the argument into words using split, capitalize each
    word using capitalize, and join the capitalized words using
    join. Note that this replaces runs of whitespace characters by
    a single space.

    """
    return (sep or ' ').join(x.capitalize() for x in s.split(sep)) 
```

### `str.title()`（定义在[`stringobject.c`](http://svn.python.org/view/python/trunk/Objects/stringobject.c?view=markup)）

```
PyDoc_STRVAR(title__doc__,
"S.title() -> string\n\
\n\
Return a titlecased version of S, i.e. words start with uppercase\n\
characters, all remaining cased characters have lowercase.");
static PyObject*
string_title(PyStringObject *self)
{
    char *s = PyString_AS_STRING(self), *s_new;
    Py_ssize_t i, n = PyString_GET_SIZE(self);
    int previous_is_cased = 0;
    PyObject *newobj = PyString_FromStringAndSize(NULL, n);
    if (newobj == NULL)
        return NULL;
    s_new = PyString_AsString(newobj);
    for (i = 0; i < n; i++) {
        int c = Py_CHARMASK(*s++);
        if (islower(c)) {
            if (!previous_is_cased)
                c = toupper(c);
            previous_is_cased = 1;
        } else if (isupper(c)) {
            if (previous_is_cased)
                c = tolower(c);
            previous_is_cased = 1;
        } else
            previous_is_cased = 0;
        *s_new++ = c;
    }
    return newobj;
} 
```

### `str.title()`在纯 Python 中

```
class String(str):
    def title(self):
        s = []
        previous_is_cased = False
        for c in self:
            if c.islower():
               if not previous_is_cased:
                  c = c.upper()
               previous_is_cased = True
            elif c.isupper():
               if previous_is_cased:
                  c = c.lower()
               previous_is_cased = True
            else:
               previous_is_cased = False
            s.append(c)
        return ''.join(s) 
```

例子：

```
>>> s = ' aBc  dEf '
>>> import string
>>> string.capwords(s)
'Abc Def'
>>> s.title()
' Abc  Def '
>>> s
' aBc  dEf '
>>> String(s).title()
' Abc  Def '
>>> String(s).title() == s.title()
True 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-04T09:31:16.323

字符串是不可变的。它们不能改变。您必须使用更改的内容创建一个新字符串。如果你想让每个 'j' 大写：

```
def make_uppercase_j(char):
    if char == 'j':
        return 'J'
    else:
        return char
name = "markus johansson"
''.join(make_uppercase_j(c) for c in name) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-04T13:35:03.257

如果您正在寻找更通用的名称解决方案，您还应该查看以下示例：

*   约翰·亚当斯-史密斯
*   Joanne d'Arc
*   让-吕克·德布鲁
*   多纳蒂安·阿尔方斯·弗朗索瓦·德·萨德

此外，名称的某些部分不应以大写字母开头，例如：

*   赫伯特·冯·洛克
*   桑德·范多恩
*   埃德温·范德萨德

因此，如果您正在考虑创建更通用的解决方案，请记住所有这些小事。

*（这将是运行测试驱动开发的理想场所，您的方法/函数必须遵循所有这些条件）*。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-04T09:37:03.970

如果我正确理解您的原始算法，这就是您想要做的：

```
namn = list("markus johansson")

if namn[0] == 'm':
    namn[0] = "M"

count = 0

for i in range(1, len(namn)):
    if namn[i] == " ":
        count = i + 1
    if count and namn[count] == 'j':    
        namn[count] = 'J'

print ''.join(namn) 
```

当然，有一百万种更好的方法（“想要的”方法）来做你想做的事情，就像 vartec 的回答所示。:)

就目前而言，您的代码仅适用于分别以 J 和 M 开头的名字和姓氏的名称。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-04T11:42:23.577

很多好的建议，所以我会在好公司里加上我自己的 2 美分 :-)

我假设您想要一些更通用的东西，它可以处理的不仅仅是以“m”和“j”开头的名称。您可能还需要考虑在连字符后也有大写字母的连字符名称（如 Markus Johnson-Smith）。

```
from string import lowercase, uppercase
name = 'markus johnson-smith'

state = 0
title_name = []

for c in name:
    if c in lowercase and not state:
        c = uppercase[lowercase.index(c)]
        state = 1
    elif c in [' ', '-']:
        state = 0
    else:
        state = 1 # might already be uppercase

    title_name.append(c)

print ''.join(title_name) 
```

最后一个警告是非 ASCII 字符的潜力。在这种情况下，使用模块的`uppercase`and`lowercase`属性`string`很好，因为它们的内容会根据用户的语言环境而变化（即：系统相关，或者调用 locale.setlocale() 时）。我知道你想避免`upper()`在这个练习中使用，这很整洁......作为一个仅供参考，也`upper()`使用`locale`受控者`setlocale()`，所以使用的实践是对 API 的良好使用`uppercase`，`lowercase`而不会太高级。也就是说，如果您需要在运行英语语言环境的系统上处理法语名称，您将需要更健壮的实现。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-04T11:07:10.650

“真正的编程”？

我会使用 .title()，而且我是一个真正的程序员。

或者我会使用正则表达式

```
re.sub(r"(^|\s)[a-z]", lambda m: m.group(0).upper(), "this   is a set of  words") 
```

这表示“如果文本的开头或空白字符后跟一个小写字母”（英文 - 可能不支持其他语言），然后对于每个匹配项将匹配文本转换为大写字母。由于匹配文本是空格和小写字母，因此效果很好。

如果您希望它作为低级代码，那么以下工作。这里我只允许空格作为分隔符（但您可能希望支持换行符和其他字符）。另一方面，“string.lowercase”是国际化的，所以如果你在另一个语言环境中，那么它在大多数情况下仍然可以工作。如果您不希望这样，请使用 string.ascii_lowercase。

```
import string

def title(s):
    # Capitalize the first character
    if s[:1] in string.lowercase:
        s = s[0].upper() + s[1:]

    # Find spaces
    offset = 0
    while 1:
        offset = s.find(" ", offset)
        # Reached the end of the string or the
        # last character is a space
        if offset == -1 or offset == len(s)-1:
            break

        if s[offset+1:offset+2] in string.lowercase:
            # Is it followed by a lower-case letter?
            s = s[:offset+1] + s[offset+1].upper() + s[offset+2:]
            # Skip the space and the letter
            offset += 2
        else:
            # Nope, so start searching for the next space
            offset += 1

    return s 
```

为了详细说明我对这个答案的评论，这个问题只能是为了好奇而做的练习。真实姓名有特殊的大写规则：“Johannes Diderik van der Waals”中的“van der”从不大写，“Farrah Fawcett-Majors”有“M”，“Cathal Ó hEochaidh”使用非ASCII Ó和h ，将“Eochaidh”修改为“Eochaidh 的孙子”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-09-09T11:02:36.927

```
string = 'markus johansson'

string = ' '.join(substring[0].upper() + substring[1:] for substring in string.split(' '))

# string == 'Markus Johansson' 
```

# c# - 为什么我不能在我的结构中初始化我的字段？

> ID：609831
> 
> 赞同：4
> 
> 时间：2009-03-04T09:24:38.803
> 
> 标签：c#

我很惊讶我无法在结构中初始化我的字段，为什么会这样？像：

```
struct MyStruct
{
    private int a = 90;
} 
```

但这是一个编译时间错误。不知道为什么会出问题？请给我解释一下。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-04T09:25:58.147

在 C# 中，a`struct`不能声明默认构造函数。

`struct`编译器将初始化语句移动到构造函数，这在 C# 中是不会发生的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T09:31:57.867

原因主要是性能。考虑以下，

```
var a = new MyStruct[1000]; 
```

如果 C# 允许初始化结构中的字段，则必须执行 1000 次初始化，数组中的每个元素执行一次。C# 想要避免在其他语言中可能出现的这种隐式行为。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-04T09:44:16.107

那是因为您的分配实际上是由编译器转换为在默认构造函数中完成的。但是 C#`struct`没有默认构造函数，正如您在Kent Boogaart 发布的[链接中看到的那样。](https://stackoverflow.com/questions/333829/why-cant-i-define-a-default-constructor-for-a-struct-in-net)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T09:44:05.280

是为了表演。当您使用默认构造函数新建一个结构时，它所做的只是在堆栈上分配许多字节并将它们初始化为 0。

# java - Java 绑定 JTextField -> java.lang.Integer 问题

> ID：609833
> 
> 赞同：4
> 
> 时间：2009-03-04T09:25:03.217
> 
> 标签：java, binding

我有一个与 Integer 变量绑定的文本字段，因此当用户在此字段中输入数字时，绑定机制会自动将文本转换为 Integer 并将此值设置为 var。问题是，由于用户在文本字段中键入文本，该绑定机制仅转换值，如果用户在其中键入一些字母，绑定将不会激活，因为文本字段内没有合法值。在这种情况下我需要什么，绑定必须触发 null 值的更改，所以我的 Integer var 中有 null。

因此，如果用户将此字段留空或不是数字，则绑定将不得不触发空值传播；不要忽略事件......如果没有在文本字段上设置事件，我怎么能做到这一点？

java绑定是否能够改变其默认行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T09:35:31.010

您需要的是[JFormattedTextField](http://java.sun.com/j2se/1.4.2/docs/api/javax/swing/JFormattedTextField.html)和[NumberFormat](http://java.sun.com/j2se/1.4.2/docs/api/java/text/NumberFormat.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T12:09:01.047

Swing 对受限文本输入的支持令人震惊。`JFormattedTextField`会给你一个完全悲惨的用户体验。与大多数有趣的 Swing 工作一样，忽略`JComponent`并选择模型。在这种情况下`Document`，尤其如此`DocumentFilter`。

（编辑：原始答案有一个简单的 Swing 应用程序的链接，该应用程序使用限制为我之前准备的整数的文本字段。）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T09:34:16.317

除了更改绑定机制的行为外，您还可以将 Formatter 放入仅接受数字的 TextField 中。您需要为此扩展 javax.swing.text.DefaultFormatter。然后您将使用 JFormattedTextField 而不是普通的 JTextField。

结果将是您只能在文本字段中获得有效输入，而不必使用不正确的值进行任何操作。

# sql - 这是 sql groupby 查询的候选者吗？

> ID：609836
> 
> 赞同：2
> 
> 时间：2009-03-04T09:25:34.887
> 
> 标签：sql

我有两个表：**TableA** (`ID [int, pk], Name [string])`和**TableB** `(ID [int, pk], TableA_ID [int, fk], Name [string], DateStamp [datetime (dd/mm/yyyy hh:MM:ss)])`。 TableA 和 TableB 之间存在一对多的关系。

两个表的内连接会给我以下结果：

```
TableA.ID、TableA.Name、TableB.Name、TableB.DateStamp
        1，“文件 A”，“版本 1”，2009 年 1 月 1 日 15:00:00
        1，“文件 A”，“版本 2”，05/01/2009 08:15:00
        1，“文件 A”，“版本 3”，2009 年 6 月 1 日 19:33:00
        2，“文件 B”，“版本 1”，2009 年 3 月 1 日 09:10:00
        2，“文件 B”，“版本 2”，2009 年 1 月 20 日 20:00:00
        3, '文件 C', '版本 1', 01/01/2009 17:00:00

```

我真正想要的是以下内容（TableA 中的每一行和 TableB 中的最后一个匹配行）：

```
TableA.ID、TableA.Name、TableB.Name、TableB.DateStamp
        1，“文件 A”，“版本 3”，2009 年 6 月 1 日 19:33:00
        2，“文件 B”，“版本 2”，2009 年 1 月 20 日 20:00:00
        3, '文件 C', '版本 1', 01/01/2009 17:00:00

```

这是我用来实现此目的的查询：

```
SELECT ta.ID, ta.Name, tb.Name, tb.DateStamp
FROM TableA ta INNER JOIN TableB tb ON ta.ID = tb.TableA_ID
WHERE tb.ID IN (
 SELECT TOP 1 tb2.ID 
 FROM TableB tb2 
 WHERE tb2.TableA_ID = ta.ID 
 ORDER BY tb2.DateStamp DESC) 
```

这行得通，但我的直觉是我没有以“最好的方式”这样做。看起来它是聚合查询（即 groupby）的候选者，但我对此没有任何运气。最后，我总是不得不使用子查询来获取我在 TableB 中的行。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T10:14:20.213

不，这里不需要做 GROUP BY，这应该通过相关子查询来解决：

```
SELECT
  TableA.ID, 
  TableA.Name, 
  TableB.Name, 
  TableB.DateStamp
FROM
  TableA
  INNER JOIN TableB ON 
    TableA.ID = TableB.TableA_ID
    AND TableB.DateStamp = (
      SELECT MAX(DateStamp) 
      FROM TableB
      WHERE TableA_ID = TableA.ID
    ) 
```

`TableB`仅当您在equal`TableA_ID` *和*equal中有多个记录时，才需要额外的 GROUP BY `DateStamp`。

* * *

对于您展示的特定示例，GROUP BY 查询*恰好产生*正确的结果。它仍然是错误的，因为在这种情况下，正确的结果更多的是副作用。

```
SELECT
  TableA.ID, 
  TableA.Name, 
  MAX(TableB.Name) Max_TableBName, 
  MAX(TableB.DateStamp) Max_TableBDateStamp
FROM
  TableA
  INNER JOIN TableB ON TableA.ID = TableB.TableA_ID
GROUP BY
  TableA.ID, 
  TableA.Name 
```

这依赖于巧合，`MAX(TableB.Name)`实际上是您想要得到的值，并且它与`MAX(TableB.DateStamp)`. 但是由于这种关联只是一个意外，所以 GROUP BY 查询是错误的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T11:39:23.113

您也可以尝试 RANK() OVER 函数：

```
-- Test data
DECLARE @TableA TABLE (ID INT, Name VARCHAR(20))
INSERT INTO @TableA
SELECT 1, 'File A' UNION
SELECT 2, 'File B' UNION
SELECT 3, 'File C'

DECLARE @TableB TABLE (ID INT, TableAID INT, Name VARCHAR(20), 
  DateStamp DATETIME)
INSERT INTO @TableB
SELECT 1, 1, 'Version 1', '01/01/2009 15:00:00' UNION
SELECT 2, 1, 'Version 2', '01/05/2009 08:15:00' UNION
SELECT 3, 1, 'Version 3', '01/06/2009 19:33:00' UNION
SELECT 4, 2, 'Version 1', '01/03/2009 09:10:00' UNION
SELECT 5, 2, 'Version 2', '01/20/2009 20:00:00' UNION
SELECT 6, 3, 'Version 1', '01/01/2009 17:00:00'

-- Actually answer
SELECT M.ID, M.AName, M.BName, M.DateStamp FROM
(   SELECT RANK() OVER(PARTITION BY A.ID ORDER BY B.DateStamp DESC) AS N, 
    A.ID, A.Name AS AName, B.Name AS BName, B.DateStamp
    FROM @TableA A INNER JOIN @TableB B ON A.ID = B.TableAID
) M WHERE M.N = 1 
```

请参阅[2\. 使用分组的最后日期选择 - 使用 RANK() OVER](https://stackoverflow.com/questions/488020/what-is-your-most-useful-sql-trick-to-avoid-writing-more-code/557238#557238)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T10:57:37.083

您还可以使用分析函数进行查询。在 Oracle 中，您可以执行以下操作：

```
select distinct
       A.Id
,      A.Name
,      first_value(B.Name)      over (partition by B.id
                                      order     by B.DateStamp desc)   BName
,      first_value(B.DateStamp) over (partition by B.id
                                      order     by B.DateStamp desc)   DateStamp
from   TableA A inner join TableB B  on A.id = B.id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T09:48:19.857

如果你想使用 group by 你可以使用：

```
select 
    ta.id, ta.name, tb.name, tb.dateStamp
from 
    tableA ta 
    inner join tableB tb on ta.id = tb.tablea_id
    inner join (
        select tablea_id, max(DateStamp) as maxDateStamp from tableB
        group by tablea_id
    ) latestB 
        on tb.tablea_id = latestB.tablea_id
        and tb.DateStamp = latestB.maxDateStamp 
```

但是，如果您在 tableB 中有多个条目具有相同的 DateStamp 值引用 tableA 中的同一行，我将返回多条记录

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T10:24:45.727

您不能可靠地从分组中的 B 表中获取多个字段，但您可以根据结果加入 B 表以获取其他字段：

```
select x.ID, x.Name, b.Name, b.DateStamp
from (
  select a.ID, a.Name, max(b.DateStamp) as DateStamp
  from TableA a
  inner join TableB b on b.TableA_ID = a.ID
  group by a.ID, a.Name
) x
inner join TableB b on b.TableA_ID = x.ID and b.DateStamp = x.DateStamp 
```

# c - 循环文件记录

> ID：609840
> 
> 赞同：4
> 
> 时间：2009-03-04T09:26:40.530
> 
> 标签：c, logging

我想知道是否有任何 C 的记录器库，可以进行循环文件记录？

我目前正在查看 log4C，但找不到足够的文档可以说它会进行循环日志记录。

如果有人这样做了。请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T10:25:04.323

*这是一个例子*

这是一个精简版。在我们的中，我们使用 vargs 并在调用 log_it 之前对其进行格式化。

* * *

```
typedef const char* c_str;
FILE* log_fp = 0;
const int max_log_size = 4 * 1024 * 1024;
const int max_no = 5;
c_str prefix = "logs_";
c_str postfix = ".txt";

void log_it( c_str str )
    {
    char file1[100], file2[100];

    if( ! log_fp )
        {
        sprintf( file1 "%s%d%s", prefix, 0, postfix );
        log_fp = fopen( file1, "a" );
        }

    if( log_fp )
        {
        if( ftell( log_fp ) > max_log_size )
            {
            fclose( log_fp );
            log_fp = 0;

            for( int i = (max_no - 1); i >= 0; i-- )
                {
                sprintf( file1 "%s%d%s", prefix, i, postfix );
                sprintf( file1 "%s%d%s", prefix, i+1, postfix );
                rename( file1, file2 );
                }

            sprintf( file1 "%s%d%s", prefix, 0, postfix );
            log_fp = fopen( file1, "a" );
            }

        fputs( str, log_fp );
        fflush( log_fp );
        }
    } 
```

* * *

我希望这会有所帮助。

戴夫

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T09:45:21.797

您确定要循环记录吗？我认为滚动日志会更好。

IE

循环记录：记录到 log.1 然后 log.2 然后 log.3 然后 log.4 然后返回 log.1

滚动日志记录：有四个日志文件，其中 log.1 始终是最新的，而 log.2、3、4 是较旧的日志条目？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T09:33:47.410

[在这一点上， Log4C](http://log4c.sourceforge.net/)似乎没有很好的记录。他们确实指向 Log4J 页面，其中提到了“滚动”日志，这可能是您想要的吗？这可能只是术语混淆的问题。

# silverlight - 在 Silverlight 中实现拖放操作到底有多容易？

> ID：609846
> 
> 赞同：3
> 
> 时间：2009-03-04T09:28:32.133
> 
> 标签：silverlight, drag-and-drop

我是 silverlight 的新手——我已经看过[教程](https://stackoverflow.com/questions/70269/silverlight-2-drag-and-drop-tutorials)和所有内容，我正在寻找的是实现拖放所需的高级步骤，也许还有一些（伪）代码只是为了得到一个想法。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-05T03:45:24.463

您能否准确解释一下您希望通过 Silverlight 中的拖放实现什么？您链接到此页面链接的问题的最佳答案：http: [//www.adefwebserver.com/DotNetNukeHELP/Misc/Silverlight/DragAndDropTest/](http://www.adefwebserver.com/DotNetNukeHELP/Misc/Silverlight/DragAndDropTest/)

这包含一个示例项目，其中包含实现拖放的源代码（巧合的是，基于我为 Silverlight 2 的 beta 1 制作的示例 :-)）。这段代码不适合您的需求怎么办？

编辑：拖放实现的基本框架如下所示：

```
bool isDragging = false;

void elementMouseLeftButtonUp(object sender, MouseButtonEventArgs e)
{
    if (element.CaptureMouse())
    {
        isDragging = true;
        element.MouseMove += elementMouseMove;
        //start drag code goes here
    }
}

void elementMouseMove(object sender, MouseEventArgs e)
{
    //Drag code goes here
}

void element_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
{
    if (isDragging)
    {
        element.ReleaseMouseCapture();
        isDragging = false;
        element.MouseMove -= elementMouseMove;

        //Drop code goes here
    }
} 
```

将 MouseLeftButtonUp/Down 处理程序添加到要拖动的元素。

在 MouseMove 事件处理程序中，添加您希望在拖动期间执行的代码：例如更改 Canvas.Top 和 Canvas.Left 以匹配鼠标位置。您可以从事件参数中获取鼠标位置。您可能希望获得相对于元素容器的位置。

在 MouseLeftButtonUp 事件处理程序中，添加将在“drop”发生时执行的代码。例如，您可能想要实现一个可以将元素拖到的“回收站”。在这种情况下，您可能想知道鼠标在拖放点下方的元素。您可以使用 VisualTreeHelper.FindElementsAtHostCoordinates，传递相对于应用程序根的鼠标位置（使用 e.GetPosition(null)）。然后，如果 FindElementsInHostCoordinates 返回您的“回收站”元素，您就知道要执行适当的操作。

这有助于回答您的问题吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-10T04:04:21.023

不是 MouseLeftButtonDown 你应该开始捕获的地方，而不是 mouseleftbuttonup？

# c++ - 将持有人类别与读者分开

> ID：609852
> 
> 赞同：0
> 
> 时间：2009-03-04T09:30:52.813
> 
> 标签：c++, oop

继续我在这里提出的问题：[C++ 多维数据处理](https://stackoverflow.com/questions/606004/c-multi-dimensional-data-handling)

在我的例子中：我有很多芯片，每个芯片有很多寄存器，每个寄存器有很多单元，每个单元有很多晶体管。我问是为他们使用一个复杂的 STL 容器，还是为他们实现完整的类。而且，按照建议，我选择为他们实施完整的课程。我有：

```
class Chip
{
    map<RegisterLocation, Register> RegistersPerLocation;
};

class Register
{
    map<CellLocation, Cell> CellsPerLocation;
};

// etc.. 
```

现在，我需要将数据填充到类中，但我无法决定：读取数据是否应该由这些类负责，或者它们是否应该只是包装容器并在外部完成读取。

我的意思是我必须选择以下之一： 要么：

```
class Chip
{
    map<RegisterLocation, Register> RegistersPerLocation;
  public:
    void AddRegisterPerLocation(RegisterLocation, Register); 
};
void ReadChipData(Chip & chip)
{
    for (RegisterLocation loc = 0; loc < 10; loc++)
    {
        Register reg;
        ReadReg(reg);
        chip.AddRegisterPerLocation(loc, reg);   
    }
}     
void ReadReg(Register & reg)
{
    for (CellLocation loc = 0; loc < 10; loc++)
    {
        Cell cell;
        ReadCell(cell);
        reg.AddRegisterPerLocation(loc, cell);   
    }
}
//etc... 
```

或者：

```
class Chip
{
    map<RegisterLocation, Register> RegistersPerLocation;
  public:
    void ReadData(); 
};
void Chip::ReadData() 
{
    for (RegisterLocation loc = 0; loc < 10; loc++)
    {          
        Register reg;
        reg.ReadData();
        RegistersPerLocation[loc] = reg;   
    }
}
//etc...
void ReadChipData(Chip & chip)
{
    chip.ReadData();
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T09:40:36.270

如果您考虑将读写器绑定到域对象以遵循封装原则，那么您在一定程度上是正确的。但请记住：您绑定的不仅仅是任何操作，而是一个*有效的行为*。Valid as in 对域中的对象有意义。

要记住的另一件事是关注点分离。可序列化性不是 a`Chip`的内在行为——将其建模到域对象中将是不公平的 IMO。YMMV。

将阅读（和写作）与课程分开。就像图书馆一样。如果必须，公开迭代器。您可以重载 '<<' 和 '>>' 运算符以获得语法糖；）

类的小问题——基于模板的方法看起来很有前途。

这是我编写的一些代码：您也可以尝试以下方法。（我已经在 MS VS2005 上成功编译并运行了它，但在你的系统上检查它。另外，有人可以修复标签 - 懒得做这个：P）

```
/*+-----------8<----------------------------8<-----------+*/
#include <vector>
#include <iostream>
#include <algorithm>
#include <map>
#include <iterator>

/* mother template */
template<class _Item>
struct Hardware
{       
    Hardware() : _myCont(2 + ::rand() % 5) {}
private:
    typename vector<_Item> _myCont;

    // i/o friends
    template<class _Item> 
    friend ostream& operator<<(ostream& output, 
                               const Hardware<_Item>& me);
    template<class _Item>
    friend istream& operator>>(istream& in, 
                               const Hardware<_Item>& me);

};

/* actual domain objects */
/* base object */
struct Transistor {
};
/* built objects */
typedef Hardware<Transistor> Cell;
typedef Hardware<Cell> Register;
typedef Hardware<Register> Chip;

/* poorman's introspection utility */
template<class T>
const char *who() { return ""; }

template<>
const char *who<Transistor>() { return "Transistor"; }

template<>
const char *who<Cell>() { return "Cell"; }

template<>
const char *who<Register>() { return "Register"; }

template<>
const char *who<Chip>() { return "Chip"; }

/* writer/serialize out */
template<class T>
ostream& operator<<(ostream& out, const Hardware<T>& hw) {
    // whatever you need to do to write
    // os << chip works fine, because you will provide a specialization
    out << "[ " << ::who<Hardware<T>>() << " ]\n\t";

    std::copy(hw._myCont.begin(), hw._myCont.end(), 
        std::ostream_iterator< T >(std::cout, "\n\t"));

    return out;
}

/* specialize for base object */
ostream& operator<< (ostream& out, const Transistor& hw) {
    out << "[ " << ::who<Transistor>() << " ]\n";
    return out;
}

/* reader/serialize in */
template<class T>
istream& operator>>(istream& in, const Hardware<T>& hw) {
    // whatever you need to do to read
    // similarly in >> chip works fine, 
    return in;
}

// driver showing relationships
// Chip -> Register -> Cell -> Transistor
int main() {
    Transistor t;
    std::cout << t << std::endl;
    Cell ce;
    std::cout << ce << std::endl;
    Register r;
    std::cout << r << std::endl;
    Chip C;
    std::cout << C << std::endl;
}
/*+-----------8<----------------------------8<-----------+*/ 
```

**警告：**尚未测试，因此可能存在相当多的编译器错误/警告。但这应该让您了解我要说的内容。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-03-04T09:36:25.733

让类负责它们的序列化会更好——一旦你改变了类字段，你必须改变相同的类序列化方法，而不是那里的一些读/写代码。

# php - 在尝试创建数据库之前检查用户权限

> ID：609855
> 
> 赞同：2
> 
> 时间：2009-03-04T09:31:17.120
> 
> 标签：php, mysql

有些主机允许您的脚本创建数据库，有些则不允许，并要求您改用他们的控制面板。如何检查数据库是否允许我在不实际创建任何数据库的情况下使用给定的用户/密码运行此查询？

因为如果我没有足够的权限，我只想从 UI 中完全隐藏“创建数据库”按钮。

我正在使用 PHP 和 MySQL。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T09:49:14.580

您可以通过以下方式获得权利：

```
SHOW GRANTS FOR CURRENT_USER; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-04T10:22:21.647

正如 Vartec 所说，`SHOW GRANTS FOR CURRENT_USER`这是要走的路。当您没有完全权限时，我只是添加此答案以显示该语句的输出：

```
GRANT USAGE ON *.* TO 'myusername'@'%' IDENTIFIED BY PASSWORD '*8D4A4D198E31D6EA9D7997F7B29A2BCA254178B6'
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, REFERENCES, INDEX, ALTER, CREATE TEMPORARY TABLES, LOCK TABLES, CREATE ROUTINE ON `mydb1`.* TO 'myusername'@'%'
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, REFERENCES, INDEX, ALTER, CREATE TEMPORARY TABLES, LOCK TABLES, CREATE ROUTINE ON `mydb2`.* TO 'myusername'@'%'
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, REFERENCES, INDEX, ALTER, CREATE TEMPORARY TABLES, LOCK TABLES, CREATE ROUTINE ON `mydb3`.* TO 'myusername'@'%' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T09:35:43.053

只需创建一个测试脚本

```
<?php
mysql_connect(...);
$result = mysql_query('CREATE DATABASE testDB');
if (!$result)
{
    //Failed
}
else
{
    mysql_query('DROP DATABASE testDB');
}
mysql_close();
?> 
```

您可以在 IF 中定义一个变量，然后将其写入配置文件。

# refactoring - 代码复制和重构

> ID：609858
> 
> 赞同：0
> 
> 时间：2009-03-04T09:31:25.683
> 
> 标签：refactoring

我想听听关于检查相同条件的方法中少量代码复制的意见，例如

```
While(condition){
...... do x 

} 
```

通常，如果有任何这种复制，我会重构代码，因为它会使版本控制成为一场噩梦，如果条件发生变化，例如你必须更改每个实例，这不是一件好事。但是，如果条件相对简单并且仅在说 3 种方法中使用，那么重构是明智的，

总而言之，人们在重构代码时在哪里划清界限？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T09:34:10.140

重构不是免费的。对代码的任何更改都可能引入错误。因此，每个有意识的开发人员都会考虑是否有时间仔细检查更改，并且在许多情况下决定不进行重构。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T09:35:27.657

这取决于两件事，IMO - 重复的大小（涉及多少行）和重复的位置 - 它们在上下文方面有多“接近”。

如果您在同一个类中的多个方法中重复了代码，那么我会考虑将单行的重复代码提取到一个单独的方法中（假设有问题的行是易于识别、易于隔离、相当解耦的一段代码）。

或者，如果我在项目的一个部分中有一些代码，并且在（几乎）不相关的区域中有一段几乎相同的代码，那么我不会考虑到这一点，因为未来分歧的范围似乎很大......

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-04T09:38:58.863

重构的关键是在**需要**时进行。在上面的示例中，如果您有 3 个具有相同条件的不同 while 循环，也就是说将来您可能需要不同的条件，如果您已经重构，那么您已经引入了潜在的错误情况。

这是一个判断的问题，同样的条件 3 次似乎还可以，同样的条件 10 次是明显的重构，但引爆点在哪里？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T10:22:16.450

我个人通常对重构非常积极。我相信如果你定期清理你的代码，你主要需要做一些小而简单的重构。如果您将其放置一段时间，它会变得如此混乱且难以维护。

在您的特定情况下，如果条件具有合理的业务意义，我肯定会重构，因为它会使代码更具可读性。但即使这是技术性问题，我也会考虑重构，只要它只是提取函数或属性的问题。

理想情况下，您应该进行单元测试，以确保您的重构仍然正确，因此执行此操作的成本实际上应该是几分钟，通常比编写此响应要小。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-18T14:08:03.023

一个常见的经验法则是Martin Fowler 在开创性著作[Refactoring中引入](http://martinfowler.com/books.html#refactoring)[的三](http://preview.tinyurl.com/ckus28)法则。规则说，两个基本相同的东西可以保留，但是一旦你添加了第三个，你就应该重构它们。

除了您提到的使未来的更改更容易之外，重构还有助于提高可读性并使意图更加明显。

# java - 从枚举序数转换为枚举类型

> ID：609860
> 
> 赞同：350
> 
> 时间：2009-03-04T09:32:07.087
> 
> 标签：java, enums

我有`ReportTypeEnum`在所有类的方法之间传递的枚举类型，但是我需要在 URL 上传递它，所以我使用序数方法来获取 int 值。在我的另一个 JSP 页面中得到它之后，我需要将它转换回一个`ReportTypeEnum`，以便我可以继续传递它。

如何将序数转换为`ReportTypeEnum`？

使用 Java 6 SE。

* * *

## 回答 #1

> 赞同：699
> 
> 时间：2009-03-04T09:34:44.427

要将序数转换为其枚举表示，您可能需要这样做：

```
ReportTypeEnum value = ReportTypeEnum.values()[ordinal]; 
```

请注意数组边界。

请注意，每次调用都会`values()`返回一个新克隆的数组，这可能会对性能产生负面影响。如果要经常调用它，您可能需要缓存该数组。

[关于如何缓存的代码示例`values()`](https://stackoverflow.com/a/19277247/4773888)。

* * *

[编辑此答案以包含评论中给出的反馈]

* * *

## 回答 #2

> 赞同：140
> 
> 时间：2009-03-04T09:40:59.513

这几乎可以肯定**是个坏主意**。当然，如果序数*实际上*是持久的（例如，因为有人为 URL 添加了书签） - 这意味着您必须始终保留`enum`将来的顺序，这对于代码维护人员来说可能并不明显。

为什么不编码`enum`using `myEnumValue.name()`（和解码 via `ReportTypeEnum.valueOf(s)`）呢？

* * *

## 回答 #3

> 赞同：107
> 
> 时间：2013-10-09T16:11:15.627

如果我要使用`values()`很多：

```
enum Suit {
   Hearts, Diamonds, Spades, Clubs;
   public static final Suit values[] = values();
} 
```

同时where.java：

```
Suit suit = Suit.values[ordinal]; 
```

如果您希望阵列是私有的，请成为我的客人：

```
private static final Suit values[] = values();
public static Suit get(int ordinal) { return values[ordinal]; }

...

Suit suit = Suit.get(ordinal); 
```

注意你的数组界限。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2014-01-01T20:01:53.893

我同意大多数人的观点，即使用序数可能是个坏主意。我通常通过为枚举提供一个私有构造函数来解决这个问题，该构造函数可以采用例如一个 DB 值，然后创建一个`fromDbValue`类似于 Jan 的答案中的静态函数。

```
public enum ReportTypeEnum {
    R1(1),
    R2(2),
    R3(3),
    R4(4),
    R5(5),
    R6(6),
    R7(7),
    R8(8);

    private static Logger log = LoggerFactory.getLogger(ReportEnumType.class);  
    private static Map<Integer, ReportTypeEnum> lookup;
    private Integer dbValue;

    private ReportTypeEnum(Integer dbValue) {
        this.dbValue = dbValue;
    }

    static {
        try {
            ReportTypeEnum[] vals = ReportTypeEnum.values();
            lookup = new HashMap<Integer, ReportTypeEnum>(vals.length);

            for (ReportTypeEnum  rpt: vals)
                lookup.put(rpt.getDbValue(), rpt);
         }
         catch (Exception e) {
             // Careful, if any exception is thrown out of a static block, the class
             // won't be initialized
             log.error("Unexpected exception initializing " + ReportTypeEnum.class, e);
         }
    }

    public static ReportTypeEnum fromDbValue(Integer dbValue) {
        return lookup.get(dbValue);
    }

    public Integer getDbValue() {
        return this.dbValue;
    }

} 
```

现在您可以在不更改查找的情况下更改顺序，反之亦然。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-01-09T01:00:40.757

您*可以*使用静态查找表：

```
public enum Suit {
  spades, hearts, diamonds, clubs;

  private static final Map<Integer, Suit> lookup = new HashMap<Integer, Suit>();

  static{
    int ordinal = 0;
    for (Suit suit : EnumSet.allOf(Suit.class)) {
      lookup.put(ordinal, suit);
      ordinal+= 1;
    }
  }

  public Suit fromOrdinal(int ordinal) {
    return lookup.get(ordinal);
  }
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-04-01T14:38:56.780

这就是我使用的。我不假装它比上面更简单的解决方案“效率”低得多。当在上述解决方案中使用无效的序数值时，它的作用是提供比“ArrayIndexOutOfBounds”更清晰的异常消息。

它利用了 EnumSet javadoc 指定迭代器以自然顺序返回元素的事实。如果这不正确，则有一个断言。

JUnit4 测试演示了它是如何使用的。

```
 /**
 * convert ordinal to Enum
 * @param clzz may not be null
 * @param ordinal
 * @return e with e.ordinal( ) == ordinal
 * @throws IllegalArgumentException if ordinal out of range
 */
public static <E extends Enum<E> > E lookupEnum(Class<E> clzz, int ordinal) {
    EnumSet<E> set = EnumSet.allOf(clzz);
    if (ordinal < set.size()) {
        Iterator<E> iter = set.iterator();
        for (int i = 0; i < ordinal; i++) {
            iter.next();
        }
        E rval = iter.next();
        assert(rval.ordinal() == ordinal);
        return rval;
    }
    throw new IllegalArgumentException("Invalid value " + ordinal + " for " + clzz.getName( ) + ", must be < " + set.size());
}

@Test
public void lookupTest( ) {
    java.util.concurrent.TimeUnit tu = lookupEnum(TimeUnit.class, 3);
    System.out.println(tu);
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2020-10-16T19:37:58.467

安全第一（使用 Kotlin）：

```
// Default to null
EnumName.values().getOrNull(ordinal)

// Default to a value
EnumName.values().getOrElse(ordinal) { EnumName.MyValue } 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-06-28T11:37:26.850

这就是我在 Android 上使用 Proguard 所做的：

```
public enum SomeStatus {
    UNINITIALIZED, STATUS_1, RESERVED_1, STATUS_2, RESERVED_2, STATUS_3;//do not change order

    private static SomeStatus[] values = null;
    public static SomeStatus fromInteger(int i) {
        if(SomeStatus.values == null) {
            SomeStatus.values = SomeStatus.values();
        }
        if (i < 0) return SomeStatus.values[0];
        if (i >= SomeStatus.values.length) return SomeStatus.values[0];
        return SomeStatus.values[i];
    }
} 
```

它很短，我不需要担心在 Proguard 中有异常

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-05-23T06:16:17.380

您可以定义一个简单的方法，例如：

```
public enum Alphabet{
    A,B,C,D;

    public static Alphabet get(int index){
        return Alphabet.values()[index];
    }
} 
```

并像这样使用它：

```
System.out.println(Alphabet.get(2)); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-03-02T01:21:20.733

```
public enum Suit implements java.io.Serializable, Comparable<Suit>{
  spades, hearts, diamonds, clubs;
  private static final Suit [] lookup  = Suit.values();
  public Suit fromOrdinal(int ordinal) {
    if(ordinal< 1 || ordinal> 3) return null;
    return lookup[value-1];
  }
} 
```

测试类

```
public class MainTest {
    public static void main(String[] args) {
        Suit d3 = Suit.diamonds;
        Suit d3Test = Suit.fromOrdinal(2);
        if(d3.equals(d3Test)){
            System.out.println("Susses");
        }else System.out.println("Fails");
    }
} 
```

如果您有更高效的代码，我很感激您与我们分享，我的枚举很大并且不断被调用数千次。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-01-20T23:33:10.430

因此，一种方法是`ExampleEnum valueOfOrdinal = ExampleEnum.values()[ordinal];`可行且简单，但是，如前所述，`ExampleEnum.values()`每次调用都会返回一个新的克隆数组。这可能是不必要的昂贵。我们可以通过像这样缓存数组来解决这个问题`ExampleEnum[] values = values()`。允许修改我们的缓存数组也是“危险的”。有人可以写`ExampleEnum.values[0] = ExampleEnum.type2;`所以我会使用不进行额外复制的访问器方法将其设为私有。

```
private enum ExampleEnum{
    type0, type1, type2, type3;
    private static final ExampleEnum[] values = values();
    public static ExampleEnum value(int ord) {
        return values[ord];
    }
} 
```

您将使用`ExampleEnum.value(ordinal)`获取与关联的枚举值`ordinal`

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2012-09-17T23:33:05.033

每个枚举都有 name()，它给出了一个带有枚举成员名称的字符串。

给予`enum Suit{Heart, Spade, Club, Diamond}`，`Suit.Heart.name()`将给予`Heart`。

每个枚举都有一个`valueOf()`方法，它接受一个枚举类型和一个字符串，来执行相反的操作：

`Enum.valueOf(Suit.class, "Heart")`返回`Suit.Heart`。

为什么有人会使用序数超出了我的范围。它可能快纳秒，但不安全，如果枚举成员发生变化，因为另一个开发人员可能不知道某些代码依赖于序数值（特别是在问题中引用的 JSP 页面中，网络和数据库开销完全占主导地位）时间，而不是在字符串上使用整数）。

# java - Java SWT：如何指示选择了菜单项

> ID：609862
> 
> 赞同：4
> 
> 时间：2009-03-04T09:33:35.537
> 
> 标签：java, swt, menu

使用 SWT，指示菜单项（来自任务栏菜单）是当前活动选择的常用方法是什么？复选标记？胆大？这是如何用代码完成的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-04T10:10:06.340

在实例化期间使用[CHECK样式：](http://help.eclipse.org/stable/nftopic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/SWT.html#CHECK)

```
MenuItem menuItem = new MenuItem(menu, SWT.CHECK); 
```

使用[getSelection](http://help.eclipse.org/stable/nftopic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/widgets/MenuItem.html#getSelection())检查状态：

```
boolean isSelected = menuItem.getSelection(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T10:12:04.057

[org.eclipse.swt.widgets.MenuItem](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/widgets/MenuItem.html) **setSelection(true)** / **getSelection()**

选择的样式取决于菜单项的样式：CHECK、CASCADE、PUSH、RADIO、SEPARATOR，如：

[![替代文字](https://i.stack.imgur.com/ryw2M.png)](https://i.stack.imgur.com/ryw2M.png)
[（来源：[developpez.com](http://jmdoudoux.developpez.com/cours/developpons/java/images/swt047.png)）] [（来源：][[developpez.com](http://jmdoudoux.developpez.com/cours/developpons/java/images/swt046.png)][）][![替代文字](https://i.stack.imgur.com/kq5wn.png)](https://i.stack.imgur.com/kq5wn.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T09:43:31.067

```
MenuItem.getSelection() 
```

# git - 如何在一个工作目录中使用两个 SVN 项目和相应的 git-svn 分支？

> ID：609872
> 
> 赞同：2
> 
> 时间：2009-03-04T09:36:46.293
> 
> 标签：git, git-svn

我对 Git 比较陌生，但我想尝试一下（与 SVN 和 Bazaar 相比）。

任何人都可以向我推荐一个类似于以下情况的工作流程：

*   1 个 SVN 存储库，包含多个项目
*   1个工作副本“src”

想法是在“src”中我需要检查项目 A 或有时项目 B。这两个项目都有几个分支。

目前，我已经制作了 SVN 存储库的 2 个 git 克隆，每个项目一个。（我更喜欢 --bare repos，但它不适用于`git svn clone`）

然后，我在“src”和`git remote add projA ..a_repo_git`“ `git remote add projB ..b_repo_git`”中做了一个git repo。

现在，我可以使用“git remote”从“src”查看它们，并且可以使用“git remote show projA”查看它们的分支

而现在的麻烦..

*   我怎样才能进入 projA/projB 中的“src”任何分支？
*   如何修改它们，然后能够将它们推回（首先到 git_repos，或直接到 SVN 存储库）？
*   这个“工作流程”可以吗，还是你有更好的主意？

我确实在 src: 中尝试过`git checkout --track -b work_branch projA branch_in_A` ，在摆弄“fetch”之后，我设法得到了东西。但是后来，我在将其推回`a_repo_git`，然后推回 SVN 时遇到了问题。这主要是反复试验。

我不得不承认，我仍然有远程分支的问题！`origin local_branch:origin_branch`（当我必须使用“ ”或“ `origin origin_branch:local_branch`”，或“ `origin origin_branch`”或“ ”时，我会迷路`origin/origin_branch`！返回 Git 手册以获取更多信息。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-10T20:12:10.850

我还没有更新这个问题，因为在过去的几天里，在我的新仓库的帮助下，我能够非常轻松地工作:)

这是我最后所做的：

在同一目录中初始化两个 SVN 存储库。（我现在不记得了，但之前可能在同一个目录中完成了“git init”：

```
mkdir src && cd src
（对此不确定：git init）
git svn init --stdlayout --prefix=projA/ -RprojA file:///path/to/svn/repo/A
git svn init --stdlayout --prefix=projB/ -RprojB file:///path/to/svn/repo/B

```

“--stdlayout”表示SVN repos采用标准格式，主干、分支和标签在同一级别。

“--prefix”用于分支名称。当我们执行“git branch -a”时，项目 A 中的所有 SVN 分支都有前缀“projA”（例如：projA/branch_name_of_A）。B也是一样。

-R 选项在 git repo 内部设置 SVN 存储库的名称（这是我们在引用 SVN 存储库/项目时与 git 一起使用的名称）

file:///path 是 SVN 存储库的路径，在这种情况下是存储库中项目的路径。我使用“file://”，因为我使用的是平面文件存储库，没有服务器。对于 SVN 服务器，我确信它也可以与 http:// 一起使用。

在这一步之后，出于好奇，我查看了文件 src/.git/config。上面的两个命令创建了几个“svn-remote”部分，一个用于每个项目（-R 选项），一个称为“svn”的通用部分。我已经修改了条目，所以只有对项目的引用。每个引用都有 repo 路径（获取）和标签/分支/主干的条目。如果您查看该文件，您将了解需要更改的内容。

在此之后，我获取了每个项目的内容，使用

```
git svn fetch projA #项目A repo的内容已下载
git svn fetch projB #项目B repo的内容已下载

```

现在，runnig "git branch -a" 显示了来自两个 repos 的所有分支，以及 master 分支（本地）。“git branch -r”没有显示任何分支；可能是因为它们是“svn-remote”而不是“remote”

当前的“master”分支指向第二个项目的主干。我决定摆脱它，因为它会在从一个项目切换到另一个项目时引起问题。

我创建了两个新分支来指向每个项目的主干，然后删除了“主”分支：

```
git checkout -b master_project_A projA/trunk
git checkout -b master_project_B projB/trunk
git 分支 -D 主

```

现在，对于“工作流程”；从事项目A：

```
git checkout master_project_A #切换到项目A
git svn rebase #检查SVN repo上的任何更新
git checkout -b work_on_A master_project_A #从项目A的master开始创建一个分支

在 work_on_A 上工作；提交等

git checkout master_project_A #回到项目A的master
git svn rebase #再次检查SVN repo上的任何更新
git checkout work_on_A #回到工作分支
git rebase master_project_A #update 分支，包含来自项目 A 的 master 的任何更改
git checkout master_project_A #回到项目A的master
git merge work_on_A #merge 到项目 A 的 master 来自工作分支的更改
git svn dcommit #commit 更改主干中的 SVN 存储库，因为 master_project_A 指向其主干

```

如果我想从 SVN 中检出一个现有的分支，我可以这样做：

```
git checkout -b work_on_branch projA/branch_name

工作工作工作

git svn rebase #更新来自 projA/branch_name 的任何更改
git svn dcommit #commit 更新回 SVN repo 中的分支

```

对于项目 BI 可以做完全相同的事情。最后，我可以在同一个目录“src”中拥有项目 A 或 B 的内容，并且可以从同一个 git 存储库访问 SVN 存储库中的两个项目！:D

我还没有弄清楚如何创建一个本地分支然后将其推送到 SVN 存储库 - 我很接近，但它没有工作。

此外，了解命令“reset”（“git reset --hard projPrefix/branch”）可能很有用，但我使用它破坏了一些东西，所以最好把它留到其他时间。

我希望这可以帮助别人！

干杯，亚历克斯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-04T10:08:47.403

让我们首先考虑一个远程仓库和一个本地仓库的简单情况。

本地 repo 中的A [`remote`](http://www.kernel.org/pub/software/scm/git/docs/git-remote.html)“仅”作为对另一个 repo 的引用。您可以使用[`fetch`](http://www.kernel.org/pub/software/scm/git/docs/git-fetch.html)将远程对象检索到本地存储：

```
git remote add upstream git://...
git fetch upstream 
```

现在所有分支`upstream`都可以在本地引用并使用`upstream/branchname`. 要真正在远程分支上工作，您应该始终创建一个跟踪远程分支的本地分支：

```
git checkout -b new_local_branchname upstream/branchname 
```

现在，您可以在本地工作并随心所欲地提交/合并。作为最后一步，您可以[`push`](http://www.kernel.org/pub/software/scm/git/docs/git-push.html)更改回中央存储库。重要的是 AFAIK`push`只能进行快进合并，即上传更改并设置新的头部。因此，您必须准备本地分支，以便本地更改从远程分支的尖端开始。在本地工作时，您可以使用它[`rebase`](http://git-scm.com/docs/git-rebase)来实现或避免更改中央存储库。

这描述了两个存储库之间的简单工作流程。现在来看 SVN 的具体情况。

[`git svn`](http://git-scm.com/docs/git-svn)通过进一步限制您可以进行的更改类型，使情况复杂化。与远程一样，您永远不应直接修改 svn 分支，而应始终在本地分支上工作。与遥控器不同，`git svn`在提交进入 SVN 存储库时始终修改提交以添加必要的元数据。最后一个事实可能是造成许多问题的原因，因为 SVN 分支上的提交总是与本地分支上的原始提交具有不同的哈希值。

最后，关于同一个仓库中多个项目的问题。

Git 不支持在同一个 repo 中并行检出多个分支。您可能希望查看[子模块](http://git-scm.com/docs/git-submodule)以集成多个存储库。

# entity-framework - 实体构造函数 - 实体框架

> ID：609881
> 
> 赞同：1
> 
> 时间：2009-03-04T09:41:51.867
> 
> 标签：entity-framework, entity

我试图找到在实体框架中处理对象的最佳方式。我不想让我的表单知道任何有关 ObjectContext 的信息，所以我将所有逻辑都放在了实体中（我编写了部分类）。我一直在寻找其他人的经验，但在任何地方都没有找到这种方法。那么，你是如何工作的呢？您如何从 ObjectContext 获取对象并使用它，而不会丢失其实体状态和其他所有内容？我已经找到了一些解决方案，但仍然想知道其他人。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T09:51:11.097

在 DDD 之后，让我们将您的实体与对其进行操作的逻辑分开。就个人而言，我使用存储库模式来创建一个通用存储库以及一些在我的实体上运行的专用存储库。存储库可以在构造函数给定的 ObjectContext 上运行，或者在未指定时（从配置）创建一个新的。

我的示例 IRepository 接口：

```
public interface IRepository<T> where T : class
{
    /// <summary>
    /// Return all instances of type T.
    /// </summary>
    /// <returns></returns>
    IQueryable<T> All();

    /// <summary>
    /// Return all instances of type T that match the expression exp.
    /// </summary>
    /// <param name="exp"></param>
    /// <returns></returns>
    IEnumerable<T> Find(Func<T, bool> exp);

    /// <summary>Returns the single entity matching the expression. 
    /// Throws an exception if there is not exactly one such entity.</summary>
    /// <param name="exp"></param><returns></returns>
    T Single(Func<T, bool> exp);

    /// <summary>Returns the first element satisfying the condition.</summary>
    /// <param name="exp"></param><returns></returns>
    T First(Func<T, bool> exp);

    /// <summary>
    /// Mark an entity to be deleted when the context is saved.
    /// </summary>
    /// <param name="entity"></param>
    void Delete(T entity);

    /// <summary>
    /// Create a new instance of type T.
    /// </summary>
    /// <returns></returns>
    T CreateInstance();

    /// <summary>Persist the data context.</summary>
    void SaveAll();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-18T05:24:48.327

如何按照复杂性顺序将实体框架 4 置于 n 层架构中的示例：

1.  [http://devtalk.dk/2009/06/09/Entity+Framework+40+Beta+1+POCO+ObjectSet+Repository+And+UnitOfWork.aspx](http://devtalk.dk/2009/06/09/Entity+Framework+40+Beta+1+POCO+ObjectSet+Repository+And+UnitOfWork.aspx)
2.  [http://blog.keithpatton.com/2009/05/30/Entity+Framework+POCO+Repository+Using+Visual+Studio+2010+Net+40+Beta+1.aspx](http://blog.keithpatton.com/2009/05/30/Entity+Framework+POCO+Repository+Using+Visual+Studio+2010+Net+40+Beta+1.aspx)
3.  [http://danielwertheim.files.wordpress.com/2009/12/putting-entity-framework-4-to-use-in-a-business-architecture-v2.pdf](http://danielwertheim.files.wordpress.com/2009/12/putting-entity-framework-4-to-use-in-a-business-architecture-v2.pdf)
4.  [http://www.simonsegal.net/blog/2010/01/11/entity-framework-repositories-fetching-strategies-specification-and-mapping-using-nfetchspec-for-role-driven-development-parts-1- 4](http://www.simonsegal.net/blog/2010/01/11/entity-framework-repositories-fetching-strategies-specification-and-mapping-using-nfetchspec-for-role-driven-development-parts-1-4)

顺便说一句，如果您更愿意实现@twk 发布的接口，请使用`IEnumerable<T> Find(Expression<Func<T, bool>> exp);`所有查询操作的语法。实施`IEnumerable<T> Find(Func<T, bool> exp);`将导致实现整个表和内存过滤。

# sql-server-2005 - SQL Server 如何维护连接？

> ID：609882
> 
> 赞同：2
> 
> 时间：2009-03-04T09:41:59.807
> 
> 标签：sql-server-2005

SQL Server 2005 是否为每个连接创建一个线程？或者它如何管理连接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T09:44:27.320

不，它有一个线程池，可以根据需要创建或终止。连接与执行实际查询执行的工作线程分开管理。一个查询也可能导致多个线程用于并行执行计划。

一些较旧的基于 unix 的数据库，例如 Informix SE 或较旧版本的 Postgres 会为每个连接分叉一个进程，通过附加到共享内存池来维护共享数据结构。Oracle 也可以在“共享服务器”模式下工作，该模式 (IIRC) 也以这种方式工作。

[《大师指南》](http://www.amazon.com/s/ref=nb_ss_gw?url=search-alias%3Daps&field-keywords=henderson+gurus+guide&x=0&y=0)系列的第三本书详细介绍了 SQL Server 2000 的内部架构；在大多数方面，SQL Server 2005 并没有太大的不同。除其他事项外，这还讨论了线程管理。作为奖励，本书的前半部分很好地概述了 Win32 系统编程的关键方面，作为数据库服务器架构审查的背景资料。

# java - 使用java运行shell脚本时出现问题

> ID：609888
> 
> 赞同：2
> 
> 时间：2009-03-04T09:44:14.187
> 
> 标签：java, linux, shell

我有一个`test.sh`在`/tmp/padm`文件夹中命名的 shell 脚本。在那个 shell 脚本中，我有一个语句

```
echo "good" 
```

我正在尝试使用 Java 代码运行 shell 脚本。

```
String cmd=("/tmp/padm/.test.sh");            
Runtime rt = Runtime.getRuntime();
Process pr=rt.exec(cmd); 
```

但我的问题是我看不到 shell 脚本的输出“好”。

如何让脚本运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T10:18:16.163

您可以使用以下代码获取命令输出。希望这可以帮助。

```
Process process = Runtime.getRuntime().exec(cmd);
String s = "";
BufferedReader br = new BufferedReader(new InputStreamReader(process
            .getInputStream()));
while ((s = br.readLine()) != null)
{
   s += s + "\n";
}    
System.out.println(s);

BufferedReader br2 = new BufferedReader(new InputStreamReader(process.getErrorStream()));
while (br2.ready() && (s = br2.readLine()) != null)
{
  errOutput += s;
}
System.out.println(errOutput); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T09:46:55.257

那是行不通的。您必须在脚本的第一行添加“hash bang”，以告诉 Linux 它必须使用合适的解释器（例如 bash）来解释脚本，或者通过 bash 从 Java 显式运行它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T09:47:31.433

当您说“在终端上”时，您是什么意思？如果您想查看流程的输出/错误，您需要使用：

```
process.getErrorStream();
process.getOutputStream(); 
```

`Runtime.exec`除此之外，从您调用 shell 脚本中我可以看出没有问题

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T10:26:13.117

```
process.getErrorStream();
process.getOutputStream(); 
```

*是oxbow_lakes*指出的正确方法。

此外，请确保您`/bin/sh`使用 shell 脚本位置作为参数执行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-08T04:45:14.333

试试这个，它肯定会奏效。

Shell 脚本 test.sh 代码

```
 #!/bin/sh
   echo "good" 
```

执行 shell 脚本 test.sh 的 Java 代码

```
 try {
                Runtime rt = Runtime.getRuntime();
                Process pr = rt.exec(new String[]{"/bin/sh", "/tmp/padm/.test.sh"});

                BufferedReader input = new BufferedReader(new InputStreamReader(pr.getInputStream()));
                String line = "";
                while ((line = input.readLine()) != null) {
                    System.out.println(line);
                }
            } catch (Exception e) {
                System.out.println(e.toString());
                e.printStackTrace();
            } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T13:45:43.373

这是[Need sample java code to run a shellscript](https://stackoverflow.com/questions/609762/need-sample-java-code-to-run-a-shellscript)的副本。

我的答案中的示例程序确实打印出标准错误和标准输出（示例程序稍后添加）。

请注意，streamGobbler 在单独的线程中运行，以防止由于输入/输出缓冲区满而导致的执行问题。

如果您愿意，当然可以让 StreamGobblers 将输出存储在列表中，并在进程执行后检索列表，而不是将其直接转储到 stdout。

# java - 如何使用 jsp/servlet/javascript 创建具有放置在服务器文件夹中的图像的幻灯片效果的照片库

> ID：609890
> 
> 赞同：0
> 
> 时间：2009-03-04T09:44:19.803
> 
> 标签：java, javascript, ajax, jsp

我需要创建服务器中图像的幻灯片。这些图像会随着用户上传而改变。我需要这个使用 jsp/javascript/servlet/ajax

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T13:56:47.933

通常当页面加载时，幻灯片代码已经有一个可用文件的列表。它需要使用 AJAX 定期轮询服务器以确定此列表是否已更改（用户已上传文件）。通常，您只需替换 AJAX 调用中保存文件列表的数组或字符串。

服务器端代码只需要以幻灯片期望的格式提供文件夹中的文件列表。

这里有[一系列不同的幻灯片](http://www.smashingmagazine.com/2007/05/18/30-best-solutions-for-image-galleries-slideshows-lightboxes/)，您可以为此抓取和修改。

# vb6 - 全局函数是否有等效的 CallByName？

> ID：609894
> 
> 赞同：3
> 
> 时间：2009-03-04T09:45:24.073
> 
> 标签：vb6

我想这样做：“如果有一个包含函数*Y的模块**X*则调用它，否则不要。”

 *我知道我可以`CallByName(Object, MethodName, ...)` 用来调用对象实例的方法或属性。

是否可以调用未绑定到对象的全局子/函数？

```
//Module1
Public Sub DoSomething
End Sub

//Module2
Public Sub TriggerDoSomething
  On Error Resume Next
  CallByName2 "Module1", "DoSomething", ...
End Sub 
```

我知道，最好重构我的代码以包装`DoSomething`到一个类中，但目前这是不可能的，因为它会破坏我同事的代码，而这种方式无法在几个小时内修复。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T09:58:59.657

CallByName 一个类真的会更容易 - 你不能用一个将调用重定向到模块的类来包装模块吗？

可以使用 FunctionDelegator 按名称调用模块中的例程。这在 Matt Curland 的优秀著作[Advanced Visual Basic 6](https://rads.stackoverflow.com/amzn/click/com/0201707128)中有解释。

谷歌搜索可能会发现一些使用 CallWindowProc 的 hack，但 Matt Curland 说这很危险。这几乎是关于此事的最后一句话：）

* * *

编辑：RS Conley 的答案不使用模块，使用具有 GlobalMultiUse 实例化属性的类，您将能够使用 CallByName。如果您的代码位于 DLL 而不是 EXE 中，这将起作用。RS Conley 建议在任何情况下，在 DLL 中拥有几乎所有功能的最小 EXE 会更加灵活：这很可能是真的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T09:57:54.327

条件编译可以解决您的问题吗？

```
//Module2
Public Sub TriggerDoSomething
    #If DoSomething_IsPresent Then
        DoSomething
    #End if
End Sub 
```

然后在您的项目设置中，您将添加以下条件编译参数：

*   如果 DoSomething 存在：DoSomething_IsPresent = -1
*   如果 DoSomething 不存在：DoSomething_IsPresent = 0

* * *

顺便说一句，请注意以下中的“On Error Resume Next”：

```
//Module2
Public Sub TriggerDoSomething
  On Error Resume Next
  CallByName2 "Module1", "DoSomething", ...
End Sub 
```

如果 DoSomething 存在于 Module1 中但有未处理的错误，您将不会注意到它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T12:26:32.657

不要使用模块，使用具有 GlobalMultiUse 实例化属性的类，您将能够使用 CallbyName

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-05-12T09:00:03.080

伙计们，应该这样做。我接受捐款。

```
Public Sub callbyname2(proc As String)
    Dim vbComp As VBComponent
     For Each vbComp In ActiveWorkbook.VBProject.VBComponents
        On Error Resume Next
        Application.Run (vbComp.name & "." & proc)
        If Err.Number <> 1004 Then
            Exit For
        End If
    Next
End Sub 
```

# javascript - YUI编辑器： 而是 换行？

> ID：609898
> 
> 赞同：4
> 
> 时间：2009-03-04T09:46:17.537
> 
> 标签：javascript, ruby-on-rails, yui, richtextbox, richtextediting

如果用户发出换行符，我如何告诉 YUI 编辑器将所有文本包含在内`<p></p>`并使用？`<p></p>``<br>`

这里有一个例子来说明我正在尝试做的事情：

而不是这个：

```
The quick brown fox<br>jumps over the lazy dog 
```

我想要这个：

```
<p><p>The quick brown fox</p><p>jumps over the lazy dog</p></p> 
```

除了在保存和查找替换标签之前解析整个 html 之外，任何想法如何做到这一点？

**更新**：我刚刚注意到，`<p></p>`如果整个文本包含在`<p></p>`. 换句话说，问题将是：

> 如何告诉 YUI 编辑器将整个文本包含在 textarea 中`<p></p>`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-04T10:00:48.157

看起来你想要“ptags”配置选项：

```
var myEditor = new YAHOO.widget.Editor('msgpost', {
    height: '300px',
    width: '522px',
    dompath: true, //Turns on the bar at the bottom
    animate: true, //Animates the opening, closing and moving of Editor windows
    ptags: true
});
myEditor.render(); 
```

如此[处所述](http://developer.yahoo.com/yui/docs/YAHOO.widget.SimpleEditor.html#config_ptags)。

# .net - 在 VS2008 中创建单元测试，不必要的引用？

> ID：609899
> 
> 赞同：2
> 
> 时间：2009-03-04T09:46:22.560
> 
> 标签：.net, visual-studio, unit-testing

在 VS2008 中创建单元测试（右键单击，创建单元测试）会导致将大量引用添加到我的测试项目中。这些与正在测试的项目使用的引用相同。

为什么这是必要的？有什么地方可以关闭它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T09:51:22.360

某些正在测试的类型可能会公开`public`成员及其参数和/或在其他程序集中定义的返回类型。测试器程序集需要了解它们才能测试这些成员。这是通过引用被测试的程序集所引用的所有程序集来完成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T10:01:11.837

如果您担心额外的参考，我会手动进行。对于您可能拥有的每个项目 Foo，创建另一个项目 FooTests。

然后你只需要添加对 Foo 的引用，然后说 NUnit，然后希望你需要添加哪些额外的引用会变得很明显。ReSharper 在这方面做得很好，并且非常清楚您需要添加什么。

右键单击-> 创建单元测试是 VS2008 的新功能。所以它可能还不完美。

# c# - 如何在较高级别指定要使用的数据库隔离级别？

> ID：609907
> 
> 赞同：3
> 
> 时间：2009-03-04T09:48:56.873
> 
> 标签：c#, .net, sql-server, performance, isolation

我`TransactionScope`在高级别使用 s 来包装一些与数据库建立多个连接的高级代码。

`read uncommitted`我调用的函数之一是通用读取，用于需要隔离级别的只读函数。但在某些情况下，它被用作大型更新操作的一部分，a`read committed`会更合适。

在事务范围内调用函数的最高级别，我应该能够为事务设置隔离级别吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T09:59:36.693

您可以在 TransactionScope 本身上设置隔离级别。你是这个意思吗？

```
using (var txn = new TransactionScope(
    TransactionScopeOption.Required, 
    new TransactionOptions
    {
        IsolationLevel = IsolationLevel.ReadUncommitted
    }
))
{
    // Your LINQ to SQL query goes here
} 
```

（从我的博客文章中窃取的代码[在这里](http://www.madprops.org/blog/linq-to-sql-and-nolock-hints/)。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T09:59:46.020

您可以在连接级别和语句/事务级别定义事务隔离级别。

如果我正确理解您的场景，我会考虑仅在您的特定更新查询之前调整事务隔离级别，如果给定连接中的大多数其他活动将是只读活动。

请记住，SQL Server 的默认隔离级别是 Read Committed，因此如果您在连接级别设置不同的隔离级别，那么您需要在更新之前切换到事务/语句级别的 Read Committed。

当然要考虑的一件事是保持默认隔离级别不变。您认为 Read Committed 不适合您的通用读取活动是否有特定原因？

有道理？如果您需要进一步说明，请告诉我。

干杯，约翰

根据评论更新。

公平地说，如果您正在开发一个高端 OLTP 数据库，您可能希望查看一种称为行版本控制的 SQL Server 技术/原理。可以这么说，这将允许您读取某个版本的记录。使用此类技术时 tempdb 有开销，但如果您使用足够的硬件，那么它可能是合适的。以下白皮书是 SQL Server 行版本控制/快照隔离的出色指南

[http://msdn.microsoft.com/en-us/library/ms345124.aspx](http://msdn.microsoft.com/en-us/library/ms345124.aspx)

# java - 在 Ehcache 中检索过期对象

> ID：609918
> 
> 赞同：8
> 
> 时间：2009-03-04T09:54:25.003
> 
> 标签：java, configuration, caching, ehcache

我想在 Ehcache 上面实现以下算法：

*   尝试从缓存中获取元素
*   如果元素未过期
    *   服务于价值
*   别的
    *   服务过期值
    *   在后台刷新元素

但我从来没有得到一个过期的元素（Element.isExpired()）。我尝试使用我的缓存配置（尤其是 TimeToLive 和 TimeToIdle），但我似乎无法让它按我的意愿工作。我可以列出缓存中的键，但是如果我“get()”一个过期的元素，我总是得到一个空值。

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T11:36:47.910

你没有做错什么。文档说，获取过期元素会将其从缓存中删除并返回 null。

我怀疑元素过期的唯一时间是如果您有一个事件侦听器正在侦听元素过期事件，但我不能说我曾经测试过这个。

# svn - svn 是否会自动检测您的用户凭据？

> ID：609925
> 
> 赞同：1
> 
> 时间：2009-03-04T09:58:41.640
> 
> 标签：svn

有没有办法让 svn 自动检测您的凭据（例如通过读取主目录中的 .file ）？

我有一个包含一些 svn 命令的 bash 脚本，我希望它以运行脚本的用户身份自动运行。如果我将一个用户的凭据放在脚本中，那么运行起来会更容易（没有问题就可以轻松运行），但是我们不知道谁做了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-04T10:20:06.177

好吧，shell 中的环境变量通常提供一个 USER 或 UID 变量。USER 是当前用户的用户名，UID 是当前用户的数字用户 id。例如：'回声 $USER'

或者，您可以使用“id”程序，如下所示：“id -nu”

我不认为 svn 可以自动检测当前用户的名称，但由于您使用的是 bash 脚本，您可以自己提供名称，例如：'svn --username $USER'

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T17:03:42.913

如果您根本不使用任何身份验证（例如通过 file://-protocol），Subversion 将使用您的登录名作为提交名

# c# - WinForms 文本框的自定义插入符号

> ID：609927
> 
> 赞同：10
> 
> 时间：2009-03-04T09:59:00.080
> 
> 标签：c#, .net, winforms, caret

我正在 WinForms .Net 2.0 应用程序中开发一个自定义的 HyperTerminal 类应用程序。我在面板中有一个多行文本框，您可以在其中与硬件设备进行交互。

我的客户想要一个自定义的插入符号，一个填充了一个字符空间大小的矩形，而不是默认的垂直线。

我知道 .Net 默认情况下不提供执行此操作的选项，但必须有一些 Windows 功能才能执行此操作。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-04T10:32:23.447

这些是 Windows 提供的 Native Caret 函数列表，您可以将它们用于您的应用程序。

```
 [DllImport("User32.dll")]
    static extern bool CreateCaret(IntPtr hWnd, int hBitmap, int nWidth, int nHeight);

    [DllImport("User32.dll")]
    static extern bool SetCaretPos(int x, int y);

    [DllImport("User32.dll")]
    static extern bool DestroyCaret();

    [DllImport("User32.dll")]
    static extern bool ShowCaret(IntPtr hWnd);

    [DllImport("User32.dll")]
    static extern bool HideCaret(IntPtr hWnd); 
```

参考 SharpDevelop，源代码@src\Libraries\ICSharpCode.TextEditor\Project\Src\Gui\Caret.cs

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-03-04T10:42:56.620

假设一个带有文本框的表单：

```
public partial class Form1 : Form
{
    [DllImport("user32.dll")]
    static extern bool CreateCaret(IntPtr hWnd, IntPtr hBitmap, int nWidth, int nHeight);
    [DllImport("user32.dll")]
    static extern bool ShowCaret(IntPtr hWnd);

    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Shown(object sender, EventArgs e)
    {
        CreateCaret(textBox1.Handle, IntPtr.Zero, 10, textBox1.Height);
        ShowCaret(textBox1.Handle);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T10:28:22.473

我会使用 System.Drawing 来绘制自定义光标（位图），也许使用计时器让它像另一个光标一样闪烁。

获取光标的当前位置（以像素为单位）并在该光标上绘制位图。找到正确的位置可能很棘手，但应该是可行的。

在这里查看[winforms 中所有者绘制的文本框。](https://web.archive.org/web/20131130031200/http://www.codedblog.com/2007/09/17/owner-drawing-a-windowsforms-textbox/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-30T09:17:09.770

采用：

```
richTextBoxConsole.GetPositionFromCharIndex(cursorPos) 
```

隐藏正常的插入符号并自己绘制？未经测试，但我认为应该可以。

# mysql - Mysql全文索引的限制？

> ID：609935
> 
> 赞同：4
> 
> 时间：2009-03-04T10:02:55.733
> 
> 标签：mysql, full-text-search

有哪些限制、陷阱、反模式或陷阱？

看起来很吸引人，显然你可以创建一个几乎不费吹灰之力的搜索引擎。但它不可能没有它的问题......

你有什么经验？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-04T12:17:16.283

> 它不可能没有问题......

当然不是！

任何纯粹由阻塞词组成的搜索词都会默默地失败。由于最小/最大长度限制和/或停用词文件，单词可能会被阻止。

我发现默认停用词文件过于激进，它阻止了许多有效搜索。此外，默认的最小长度 4 经常用于人们可能想要搜索的首字母缩略词。我将 ft_min_word_len 减少到 3 并完全删除了停止列表（ft_stopword_file=''）。文档：[http ://dev.mysql.com/doc/refman/5.1/en/fulltext-fine-tuning.html](http://dev.mysql.com/doc/refman/5.1/en/fulltext-fine-tuning.html)

您还可以检查搜索查询以查看它是否仅包含 <4 个字母的单词，并在这种情况下回退到 LIKE 搜索。在应用程序级别绕过停止列表没有那么简单的方法。

“字字符”的选择可能无法满足您的需求，并且很难更改。例如，搜索“Terry”不会匹配“Terry's”。一般来说，不支持任何类型的词干，所以“饼干”也不会匹配“饼干”。

最后，正如 cg 所提到的，不支持 InnoDB。在这个时代，您不希望将所有数据都放在 MyISAM 表中。

如果您有多余的存储空间，您可以做的是将主要的、规范的数据版本放在 InnoDB 表中，然后创建一个单独的 MyISAM 表，其中包含自由文本内容的副本，纯粹用作搜索诱饵。您确实必须在更改时更新两个表，但如果 MyISAM 表失去完整性，那么至少您只会失去搜索相关行的能力，而不是破坏真实的实时数据并获得应用程序错误。

然后，如果您有空闲的周期，您可以在搜索诱饵和查询词上实现自己的文本处理，以绕过上述一些限制。例如，您可以转义您想成为单词字符的字符，删除您不想成为单词字符的字符，并执行简单的手动英语词干提取。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T10:14:56.233

对于大型表，您需要在 MySQL 配置文件中增加缓冲区大小和缓存限制。

此外，您在搜索中使用的 MATCH() 列必须与索引中的列相同。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-04T10:25:27.817

在我看来，最大的缺点是 MySQL 全文索引仅限于 MyISAM 表。与 InnoDB 表相反，它们缺少很多重要的特性，例如事务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-04T19:23:23.167

In addition to bobince's very good answer, there is an article in MySQL documentation which talks about restrictions of full-text. Hope this helps. [http://dev.mysql.com/doc/refman/5.0/en/fulltext-restrictions.html](http://dev.mysql.com/doc/refman/5.0/en/fulltext-restrictions.html) (Olafur Waage talked about one of these already)

# wcf - 关于使用 WCF 传输文件的一些问题

> ID：609936
> 
> 赞同：2
> 
> 时间：2009-03-04T10:02:57.323
> 
> 标签：wcf, file-transfer

我有一个托管在 Windows 服务上的 WCF 服务。现在我想向该服务添加文件传输功能，但我有以下问题；考虑到传输文件是双向的，而且文件不大（大约 10MB）：

1：我在[MSDN](http://msdn.microsoft.com/en-us/library/ms731913.aspx)中读到**“跨流传输发生的操作最多可以与一个输入或输出参数签订合同”**。这是否意味着我不能进行具有多个参数的操作或什么？

2：如果我使用**Streamed**传输模式，我是否必须关心在“in”或“out”参数是集合的操作中传输的数据大小？

3：为了将模式设置为流式传输，我是否必须更改 TransferMode 以外的任何其他内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T12:28:20.593

查看[这篇文章](http://weblogs.asp.net/cibrax/archive/2007/08/29/sending-attachments-with-wcf.aspx)，了解有关 WCF 文件传输的一些方向。您应该使用 MTOM 编码器。这篇文章有一些很好的理由，并有一些例子。

1.  是的。
2.  只要它全部使用 MTOM 进行流式编码，大小就无关紧要。只需确保在绑定配置上设置了 maxReceivedMessageSize。
3.  那并为消息创建消息合同。见下文：

示例消息合约：

```
[MessageContract()]
public class FileTransferRequest
{
  [MessageHeader(MustUnderstand = true)]
  public string FileName;

  [MessageBodyMember(Order = 1)]
  public System.IO.Stream Data;
} 
```

# c++ - 从 std::binary_function （或 std::unary 函数）继承有什么好处？

> ID：609937
> 
> 赞同：27
> 
> 时间：2009-03-04T10:03:07.527
> 
> 标签：c++, stl

从 std::binary_function（或 std::unary_function）继承有什么好处？

例如我有这样的代码：

```
class Person
{
 public:
    Person();
    Person(int a, std::string n);
    Person(const Person& src);

    int age;
    std::string name;
 };

 Person::Person()
           : age(0)
             , name("")
               {};

 Person::Person(int a, std::string n)
 : age(a)
 , name(n)
 {};

 Person::Person(const Person& src)
 {
   age = src.age;
   name = src.name;
 };

 struct PersonPrint : public std::unary_function<Person, void>{
   void operator() (Person p){
     std::cout << " Person age: " << p.age 
               << " name: " << p.name << std::endl;
   }
 };

 struct PersonGreater : public std::binary_function<Person, Person, bool>{
   bool operator()(const Person& p1, const Person p2){
     if (p1.age > p2.age) return true;
     if (p1.name.compare(p2.name) > 0) return true;
     return false;
   }
 };

 int main(int count, char** args)
 {
   std::vector<Person> personVec;
   Person p1(10, "Person1");
   Person p2(12, "Person2");
   Person p3(12, "Person3");

   personVec.push_back(p1);
   personVec.push_back(p2);
   personVec.push_back(p3);

   std::cout << "before sort: " << std::endl;
   std::for_each(personVec.begin(), personVec.end(), PersonPrint());
   std::sort(personVec.begin(), personVec.end(), PersonGreater());
   std::cout << "after: " << std::endl;
   std::for_each(personVec.begin(), personVec.end(), PersonPrint());
 } 
```

但是我也可以在没有继承形式的情况下编写这段代码`std::unary_function/std::binary_function`？

```
 struct PersonPrint {
     void operator() (Person p) {
         std::cout << " Person age: " << p.age << " name: " << p.name << std::endl; 
     } 
 }; 

 struct PersonGreater {
     bool operator()(const Person& p1, const Person p2) {
         if (p1.age > p2.age) return true; 
         if (p1.name.compare(p2.name) > 0) return true; 
         return false; 
     } 
 }; 
```

**更新**

std::binary_function 和 std::unary_function 自 C++11 起已弃用，请参阅@AlexandreC 的评论。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-04T10:10:27.510

从 [unary|binary]_function 继承只会在类中为您提供额外的 typedef：

对于 unary_function

```
argument_type
result_type 
```

对于 binary_function

```
first_argument_type
second_argument_type
result_type 
```

您传递给 [unary|binary]_function 的类型有哪些。在您的情况下，没有任何好处。

如果您打算将您的 Functor 与其他 std Functor 修饰符（例如 not1、bind1st）一起使用，您必须从 [unart|binart]_function 继承。

如果您要为您的目的存储此模板信息，最好使用现成的解决方案。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-04T11:26:03.240

除了 typedefs（已经提到过）之外，还有可读性方面。当我看到`struct Foo {...`我的第一个想法是“Foo 是一种类型”。但是`struct Foo : public unary_function<...`我已经知道 Foo 是一个仿函数。对于程序员（与编译器不同），类型和仿函数是完全不同的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-04T10:51:53.617

就像 Mykola 解释的那样，他们只是在添加 typedef。想象一下`PersonGreater`，您想将第一个参数固定给某个人。`binder1st`需要将第一个参数存储在某处，因此它需要第一个参数的类型。`binary_function`将其作为 typedef 提供：

```
// get a function object that compares person1 against 
// another person
std::bind1st(PersonGreater(), person1) 
```

现在，返回的`binder1st`对象知道它需要存储的参数类型是 Person 类型。

一些函数对象否定另一个函数对象的结果。这里我们也需要参数的类型：

```
template <class Predicate>
class unary_negate
    : public unary_function<typename Predicate::argument_type,bool> {
    Predicate pred;
public:
    explicit unary_negate(const Predicate& pred):pred(pred) { }
    bool operator()(const typename Predicate::argument_type& x) const {
        return !pred(x);
    }
}; 
```

这也可以使用 templated `operator()`，但标准将其定义为使用`argument_type`类型作为参数。否定器本身是从 unary_function 派生的，无论如何都需要提供第一个参数类型。

有时，人们尝试使用`[unary,binary]_function`来存储函数对象/指针。但是，它们不能用于此目的。[`boost::function`](http://www.boost.org/doc/libs/1_38_0/doc/html/function.html)完成了这项工作，并将在下一个标准中作为`std::function`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-04T18:02:49.603

这是编译器强制执行的一种强大的文档形式。

通过继承，您承诺您将实现 binary_function 接口，编译器将支持您。然后，客户可以相信您的类可以在任何需要 binary_function 的地方使用。

# javascript - 将Javascript变量获取到隐藏输入值的问题

> ID：609939
> 
> 赞同：0
> 
> 时间：2009-03-04T10:03:51.457
> 
> 标签：javascript, input, variables

我正在尝试创建一个系统，您可以在其中拖动和调整 div（jquery ui）的大小，然后将位置和大小保存到 css 文件中。

我已经让系统使用一个 div，但是现在我尝试更新系统以支持多个 div，我遇到了一个问题。

来源：[http](http://ezmundorf.110mb.com/problem.txt) ://ezmundorf.110mb.com/problem.txt （这很丑，但我几乎只是在尝试这些东西是如何工作的）。

当我单击#update div 时，页面变为空白，页面的来源只是表单开始标记。该页面正在尝试执行某些操作，因为 Firefox 正在显示加载图形。

如果我删除写入隐藏输入字段的行，我会看到保存按钮，但 javascript 仍然有问题，因为浏览器一直在做某事。

很抱歉在这里发布这样一个“为我修复此代码”的问题，但如果没有完整的代码，我不知道如何解释它，而且我在任何地方都找不到答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T10:09:20.040

`$(document).ready`页面完成加载后（例如在事件处理程序中，包括），您不能使用 document.write 。相反，您可以使用 jQuery 方法[`.html(val)`](http://docs.jquery.com/Attributes/html#val)来更改现有元素的内容，或者使用其他[jQuery 操作](http://docs.jquery.com/Manipulation)方法将新元素插入 DOM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T10:09:32.970

`document.write`如您所见，您无法在页面加载完成后使用它而不覆盖整个页面。

您应该`.innerHTML`在某些容器上使用，例如：

```
$('myDiv').innerHTML = '<form>...</form>'; 
```

或使用 DOM 方法：

```
var form = document.createElement('form');
var body = document.getElementsByTagName('body')[0];

body.appendChild('form'); 
```

# php - 从日期中提取一个月

> ID：609941
> 
> 赞同：0
> 
> 时间：2009-03-04T10:05:52.357
> 
> 标签：php, mysql, propel

我正在尝试使用推进标准构建一个查询，以获取给定月份的所有 Foo。

例如，我想要三月份的所有 Foo。在常规 SQL 中，我会构建一个这样的查询：

```
SELECT * FROM FooPeer WHERE MONTH(startDate) = 3 
```

知道如何在标准对象中实现“MySQL Month-function”吗？

```
$c = new Criteria();
$c -> add(FooEvent::START_DATE, 3, Criteria::EQUAL); //where do I have to put the Month function ?
return self::doSelect($c); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T11:24:12.403

好的，自定义标准完成了这项工作！

```
$month = 3; //march
$criteria->add(FooPeer::START_DATE, 'MONTH('.FooPeer::START_DATE.')='. $month, Criteria::CUSTOM); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T10:50:38.550

这个问题部分回答了：[如何在 Propel 中使用 MySQL 函数](https://stackoverflow.com/questions/260229/how-to-use-mysql-functions-in-propel)

使用 Criteria::CUSTOM 或编写自定义 SQL 似乎是唯一的解决方案。

# asp.net-mvc - 如何在 ASP.NET MVC 中对 ActionFilter 进行单元测试？

> ID：609942
> 
> 赞同：6
> 
> 时间：2009-03-04T10:06:37.627
> 
> 标签：asp.net-mvc, unit-testing

`ActionFilter`我的控制器类上有一个。`OnActionExecuting`当在 Web 应用程序中调用控制器的操作时，将调用该方法。

现在我`Action`在 UnitTest 中调用：

```
 NiceController niceController = new NiceController();
    ActionResult result = niceController.WhateverAction(); 
```

有没有办法调用 ActionFilter？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-04T13:30:45.780

为了自动调用 ActionFilter，您需要运行控制器动作调用程序。这是可能的，但这意味着 MVC 框架将尝试执行结果。这意味着您将不得不使用模拟来存根执行结果。同样，这是可能的，但这意味着您的单元测试变得比实际代码更多。直接测试过滤器可能更正确。毕竟调用 OnActionExecuting 是框架的一个特性，你不需要对框架本身进行单元测试。

但我认为你真正想说的是你想测试WhateverAction，除非ActionFilter 已经执行，否则该操作无法工作。

首先，我会询问有关此设计的问题。**它是否正确？**有可能。例如，具有 Authorize 属性的操作可以假定当它执行时有一个登录用户是合理的。当然，行动应该对此进行测试，但假设是安全的。另一方面，动作可能不需要过滤器来执行特定于动作的初始化。所以你应该问这个问题，但答案很可能是设计是正确的。

在这种情况下，单元测试的最佳决策可能是在单元测试中手动执行过滤器，并*编写一个单独的单元测试来证明该操作被正确的属性修饰。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-26T16:20:41.130

> 编写一个单独的单元测试，证明该动作用正确的属性装饰

这是编写这样一个单元测试的方法

```
Type t = typeof(MyController);
Assert.IsTrue(t.GetCustomAttributes(typeof(MyCustomAttribute)).Length > 0); 
```

# asp.net - 在 DataFormWebPart 中动态设置 ParameterBinding 的 DefaultValue

> ID：609943
> 
> 赞同：6
> 
> 时间：2009-03-04T10:08:05.190
> 
> 标签：asp.net, sharepoint, dataformwebpart, parameterbinding

在 WSS 中的自定义 aspx 页面中，我使用带有 xsl 文件的 DataFormWebPart 来呈现一些数据。为了将值传递给 xsl，我使用参数绑定。具体来说，我需要像这样传入服务器主机 url：

```
<ParameterBinding 
    Name="HttpHost" 
    Location="CAMLVariable" 
    DefaultValue="http://hardcoded.com" /> 
```

这很好用，但接下来我要做的是动态获取主机名。因此，为了弄清楚如何从 SharePoint 中获取它，我添加了以下绑定：

```
<ParameterBinding 
    Name="HttpHost" 
    Location="CAMLVariable" 
    DefaultValue='<%# SPContext.Current.Site.Url.Replace
       (SPContext.Current.Site.ServerRelativeUrl, "") %>' /> 
```

现在来解决问题。如果在页面中的其他位置使用，该代码将按预期工作，但使用 SharePoint 报告的上述代码：

> Web 部件错误：“WebPartPages:DataFormWebPart”的“ParameterBindings”属性不允许子对象。

有人对此有意见吗？

更新：我根据[这篇文章启用了服务器端代码](http://weblogs.asp.net/soever/archive/2006/07/27/SharePoint-2007_3A00_-using-ASP.NET-server-side-code-in-your-pages.aspx)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-05T11:05:32.517

好的，我找到了一个不太优雅但有效的解决方案。

在尝试了各种操作 ParameterBindings 属性但没有成功的方法后，我想到了如何使用 Location 属性在其中获取动态值。

属性是指从`ParameterBinding` `Location`哪里获取值。[此类](http://blogs.msdn.com/sharepointdesigner/archive/2007/03/05/asp-net-controls-filter-the-data-view.aspx)文章暗示了“Control()”选项。因此将参数绑定更改为：

```
<ParameterBinding
  Name="HttpHost"
  Location="Control(MyHttpHost, Text)"
  DefaultValue="" /> 
```

并将以下代码添加到我的页面：

```
<asp:TextBox ID="MyHttpHost" runat="server" Visible="false" />
<script runat="server">
protected void Page_Load()
{
  MyHttpHost.Text = 
   SPContext.Current.Site.Url.Replace(SPContext.Current.Site.ServerRelativeUrl, ""); 
}
</script> 
```

...实际上成功了！

为了从随附的 XSL 文件中获取参数值，我将 param 元素放在根元素中。param name 属性必须与`ParameterBinding`:

```
<xsl:stylesheet ...>
    ...
    <xsl:param name="HttpHost"/> 
```

然后可以将该参数作为任何其他 XSL 变量进行引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-02-07T14:29:26.953

使用服务器变量可能更有意义： http: [//mdasblog.wordpress.com/2007/10/19/data-view-web-part-parameters-based-on-server-variables/](http://mdasblog.wordpress.com/2007/10/19/data-view-web-part-parameters-based-on-server-variables/)

# python - django Web 应用程序中的图表

> ID：609944
> 
> 赞同：20
> 
> 时间：2009-03-04T10:08:21.867
> 
> 标签：python, django, charts

我想在使用 django 开发的 Web 应用程序中嵌入图表。

我遇到过[Google 图表 API](http://code.google.com/p/google-chartwrapper/)、[ReportLab](http://code.djangoproject.com/wiki/Charts)、[PyChart](http://home.gna.org/pychart/)、[MatPlotLib](http://matplotlib.sourceforge.net/)和[ChartDirector](http://www.advsofteng.com/?gid=misc&gclid=CJLaibjeiJkCFQMwpAodXkETng)

我想在服务器端执行此操作，而不是将 AJAX 请求发送到 Google 图表 API，因为我还想将图表嵌入到 PDF 中。

哪个是最好的选择，一个相对于另一个的优缺点是什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-04T10:29:38.540

另一种选择是[CairoPlot](http://linil.wordpress.com/2008/09/16/cairoplot-11/)。

我们选择 matplotlib 而不是其他的，用于在我们的一个 django 应用程序中进行一些严肃的图形处理，主要是因为它是唯一一个能够为我们提供所需的控制类型的软件。

生成PNG的性能对我们来说很好，但是......它是一个高度专业化的应用程序，每天登录不到10次。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-04T17:04:50.320

好吧，我参与了一个使用[OpenFlashChart 2的开源项目](http://teethgrinder.co.uk/open-flash-chart-2/)[Djime](http://djime.github.com/)。

从[我们的代码](http://github.com/mikl/djime/blob/e6832c6e8d2aa8a3801b16121a0499f3b6d63503/djime/statistics/flashcharts.py)中可以看出，生成 OFC 使用的 JSON 数据有点复杂，但输出非常好且用户友好，因为您可以向不同的元素添加工具提示等。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-04T12:06:15.030

打开 Flash 图表 2

[http://teethgrinder.co.uk/open-flash-chart-2/](http://teethgrinder.co.uk/open-flash-chart-2/)

python 库[http://btbytes.github.com/pyofc2/](http://btbytes.github.com/pyofc2/)

基比

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-09-06T22:44:31.510

我想尝试的一个包是[石墨](http://graphite.wikidot.com/)。这是一个用 Django 构建的图形服务器/平台。它专门用于“数字时间序列数据”，例如股票价格或带宽利用率。如果这符合您的需要，我会检查一下。以下是一些截图：

[http://graphite.wikidot.com/screen-shots](http://graphite.wikidot.com/screen-shots)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-22T13:29:06.883

我喜欢客户端图表，因为您可以获得整页绘图。

一个不错的选择似乎是 Jquery Flot：[http](http://code.google.com/p/flot/) ://code.google.com/p/flot/ ，它可以加载 JSON 数据。但是，您不会获得 pdf 支持。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-25T17:43:37.330

也许你可能想看看这里：[Django Plotting app](http://www.rotareeclub.de/?p=312)。HowTo 描述了如何将 matplotlib 图嵌入管理界面并创建 PDF 视图。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-06T14:37:36.087

我在 Django中使用了[FusionCharts Free 。](http://www.fusioncharts.com/free/)

它基于闪存、开源、多许可并且有据可查。它是 ActionScript 1，但 AS 版本对我来说并不是一个真正的标准，尽管它可能适用于其他人。

# tdd - How can I remove the "Test With" menu left after uninstalling TestDriven.NET?

> ID：609949
> 
> 赞同：1
> 
> 时间：2009-03-04T10:09:33.237
> 
> 标签：tdd, testdriven.net

I have uninstalled my trial of TestDriven.NET but it leaves this menu behind on the context menu. How can I remove this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-16T03:24:35.197

The [release notes for TestDriven.NET 2.19](http://www.testdriven.net/downloads/releasenotes.html) mention that this problem (issue 1631) was fixed in 2.19:

> 1631: After uninstalling TestDriven.Net, ghost 'Test With' menus are left behind 'Test With' menus will be deleted as part of the uninstallation process.

so I imagine you were running an earlier version.

Could you try downloading, installing, and uninstalling 2.19 to see if that gets rid of the ghost menu?

If that doesn't work, since it's acknowledged bug, perhaps you need to contact the author directly [here](http://www.testdriven.net/contact.aspx) or [here](http://www.testdriven.net/support.aspx).

# c# - 未调用重写的虚函数

> ID：609955
> 
> 赞同：3
> 
> 时间：2009-03-04T10:13:13.523
> 
> 标签：c#, virtual-inheritance, typeloadexception

我的项目中有一个奇怪的问题。我有一个从基类继承的类（它又从另一个基类继承）并覆盖了一个函数。但是，当调用该函数时，它永远不会调用被覆盖的函数，而是调用基函数。

但是，当我在中间类中覆盖该函数时，它会被调用。但这很令人困惑：让我们用一张图来解释:)

*   lib GuiShared

    *   b级屏幕
        *   虚函数 InitializeRoc
*   库 TigerControlRoot

    *   bTigerScreen 类
        *   覆盖函数 InitializeRoc <-- 当在这里被覆盖时，它被调用
*   lib TigerControlRootCommonScreens
    *   类 CheckInRules
        *   覆盖函数 InitializeRoc <-- 未调用：s

然而，构造函数被调用......

这是我的（简化的）代码：

# 共享基类

```
namespace Ppb.GuiShared.Screens {
    public partial class bScreen<T> : Ppb.Controls.pPanel where T : FrameworkMiddleware.Framework.Remoting.Remotable, FrameworkMiddleware.IInitialize, new() {
        public virtual void Load(bMain<T>.LoadEventArgs args) {
            log.Trace("InitializeRoc " + this.GetType().FullName);
            InitializeRoc(args);
            _hasLoaded = true;
        }

        protected virtual void InitializeRoc(bMain<T>.LoadEventArgs args) { }
    }
} 
```

# 项目基类

```
namespace Tiger.ControlRoot.Screens {
    public partial class bTigerScreen : Ppb.GuiShared.Screens.bScreen<roc.Tiger> {
        public bTigerScreen(GuiSettings settings, roc.Tiger tiger)
            : base(settings, tiger) {
            InitializeComponent();
            InitializeMenu();
        }
    }
} 
```

# 失败的类（或该库中的任何其他类）

```
namespace Tiger.ControlRoot.CommonScreens {
    [ControlRoot.Screens.TigerScreenInfo("Testje", Tiger.ControlRoot.Screens.TigerScreenInfoAttribute.elevel.User, true)]
    public class CheckInRules : ControlRoot.Screens.bTigerScreen {

        public CheckInRules(GuiSettings settings, roc.Tiger tiger)
            : base(settings, tiger) {

        }

        protected override void InitializeRoc(Ppb.GuiShared.bMain<TigerMiddleware.TigerRoc.Tiger>.LoadEventArgs args) {
            base.InitializeRoc(args);
        }
    }
} 
```

如果这还不够，当我尝试调用基类上的某个函数时，我会收到 TypeLoadException。

```
GenericArguments[0], 'TigerMiddleware.TigerRoc.Tiger', on 'Ppb.GuiShared.bMain`1+LoadEventArgs[T]' 违反了类型参数 'T' 的约束。
```

在另一个项目中使用了具有相同 GuiShared 库的类似代码，没有问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-04T11:49:41.967

好的，感谢所有（这些）响应，但我同时修复了它。

问题如下：失败的类在一个 dll 中，它在调试模式下的输出路径设置为可执行文件的插件文件夹。到目前为止没问题，但它也会将其依赖项复制到该文件夹​​中。
但是，一些依赖项已经复制到可执行文件的根文件夹中。可执行文件在启动时搜索插件文件夹中的所有插件，并在需要时实例化插件。
那么问题是插件使用插件文件夹中的依赖项，而可执行文件使用根文件夹中的依赖项，这些依赖项基本上是不同目录中的相同文件，因此在运行 clr 时将它们视为 2 个不同的 dll，这真的混淆了 clr :)。

因此，当共享依赖项未复制到插件文件夹时，一切运行正常，因为插件使用根文件夹中的依赖项，因此使用相同的 dll。

# c++ - std::list<>::sort 稳定吗？

> ID：609956
> 
> 赞同：11
> 
> 时间：2009-03-04T10:14:06.907
> 
> 标签：c++, sorting, stl

对于这个问题，我找不到任何明确的答案。

我想大多数实现都使用稳定的合并排序，但是稳定性是要求还是副作用？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-04T11:19:19.090

C++ 标准 ISO/IEC 14882:2003 说：

> 23.2.2.4/31
> 
> **注：**稳定：等价元素的相对顺序保持不变。如果抛出异常，则列表中元素的顺序是不确定的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-04T10:23:50.393

是的， std::list<>::sort 保证是稳定的。

见[http://www.sgi.com/tech/stl/List.html](http://www.sgi.com/tech/stl/List.html)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-03-04T10:24:33.230

根据“The C++ Programming Language”（Stroustrup p470），是的，stl::list<>::sort 是稳定的。

# entity-framework - 实体框架 - 模型定义的函数

> ID：609959
> 
> 赞同：0
> 
> 时间：2009-03-04T10:14:31.493
> 
> 标签：entity-framework

我是实体框架的新手。

我有一个 SQL 函数，它返回给定生日的年龄。( [http://www.sql-server-helper.com/functions/get-age.aspx](http://www.sql-server-helper.com/functions/get-age.aspx) )

我想将它与 linq 一起使用。我知道这是可能的。我在这里读过：http: [//blogs.msdn.com/efdesign/archive/2009/01/07/model-defined-functions.aspx](http://blogs.msdn.com/efdesign/archive/2009/01/07/model-defined-functions.aspx) [http://blogs.msdn.com/efdesign/archive/2008/ 10/08/edm-and-store-functions-exposed-in-linq.aspx](http://blogs.msdn.com/efdesign/archive/2008/10/08/edm-and-store-functions-exposed-in-linq.aspx)

但似乎这是 EF 扩展（我有）的一部分，或者它仍在开发中。

谁能帮我这个？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T13:17:55.920

模型定义的函数不在交付的实体框架中，我也不认为它们在扩展中。据我所知，它们是为 .NET 4.0 计划的新功能。我不知道他们是否在社区技术预览中。如果您观看 PDC 的 Entity Framework 演示文稿，您可以看到模型定义函数的演示。但它们肯定不在 .NET 3.5 SP1 中。

作为一种解决方法，您可以在使用该函数的表上定义一个计算列，然后映射该列而不是直接映射该函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T10:19:53.523

您可能可以执行“FunctionImportMapping”，请参阅[msdn](http://msdn.microsoft.com/en-us/library/bb399203.aspx)以获取更多信息。如果您将其公开为存储过程，您可以定义这样做，但我没有尝试过仅使用函数。

# java - Java：除了它们所属的对象之外，同步方法会锁定什么（如果有的话）？

> ID：609963
> 
> 赞同：5
> 
> 时间：2009-03-04T10:15:18.620
> 
> 标签：java, concurrency, locking, mutex, semaphore

现在，我不确定这是否是一个愚蠢的问题，如果是，请多多包涵。

对象上的锁是“递归的”吗，即如果两个对象在其字段中引用了第三个对象，并且一个线程正在两者之一上运行同步方法，那么任何其他线程都可以访问第三个对象吗？

```
// a and b are some objects that implement Runnable
// they both reference the same third object
a.ref = c;
b.ref = c;

// a is run in a thread and processes some data in a loop for a long time
// the method the loop belongs to is declared synchronized
threadA = new Thread(a);
threadA.start();

a.someSyncedMethod(); // this would block ...
b.ref.someOtherSyncedMethod(); // ... but would this?
a.ref.someOtherSyncedMethod(); // ... and how about this? 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-04T10:19:30.543

值得将“锁”和“锁定对象”的概念分开。没有真正的“锁定对象”的概念——“获取（和释放）”*与对象关联*的锁。是的，这听起来像是我在吹毛求疵——但区别很重要，因为如果你谈论一个*对象*被锁定，听起来好像没有其他线程能够在持有该锁定时更改对象中的任何内容。

相反，它只是意味着在持有锁时没有其他线程能够获取相同的锁。锁与与锁关联的对象的任何内容之间没有直接关系。

声明为“同步”的方法获取与它们所属对象的实例关联的锁。这只会使同一对象上的其他同步方法等待，并在其上显式同步的同步语句。

就我个人而言，我不喜欢同步方法 - 我喜欢通过显式同步仅用于同步的（私有，最终）成员变量来使其更清晰。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T10:20:10.667

> ```
> a.someSyncedMethod(); // this would block ... 
> ```

仅当您将运行方法标记为同步或使 ThreadA 在同步方法中运行代码时。

在 JVM 中，每个对象都拥有所谓的监视器。一次只有一个线程可以拥有与给定对象关联的监视器。同步是您告诉当前线程在继续之前获取监视器的方法。

类本身也拥有一个静态方法的监视器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T10:26:08.797

“锁”的含义（实际上这个变体被称为监视器）完全是一种约定，没有强制访问限制。

该功能依赖于所有对象都表现良好并在访问数据之前获取相应的锁。只有通过使用适当的访问控制将这种期望的行为封装在一个类中，您才能为客户端对象强制执行它。

# apache-flex - Flex - 自动调整数据网格大小的问题

> ID：609964
> 
> 赞同：4
> 
> 时间：2009-03-04T10:15:30.773
> 
> 标签：apache-flex

我正在尝试创建一个数据网格，它将垂直调整大小以确保所有渲染器都完整显示。此外，

*   渲染器的高度可变
*   渲染器可以调整自己的大小

一般来说，事件的流程如下：

*   其中一个项目渲染器自行调整大小（通常响应用户点击等）
*   它调度父数据网格拾取的冒泡事件
*   DataGrid 尝试调整大小以确保所有渲染器保持完整可见。

我目前在数据网格中使用此代码来计算高度：

```
height = measureHeightOfItems(0, dataProvider.length ) + headerHeight; 
```

这似乎得到了不正确的高度。我尝试了许多变体，包括 callLater（以确保调整大小已完成，以便测量可以正常工作），以及覆盖 meausre() 和调用 invalidateSize() / validateSize()，但两者都不起作用。

下面是 3 个类，它们将说明这个问题。单击项目渲染器中的按钮可调整渲染器的大小。网格也应该扩展，以便所有 3 个渲染器都完整显示。

任何建议将不胜感激。

问候

马蒂

**DataGridProblem.mxml（应用程序文件）**

```
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="vertical"
    xmlns:view="view.*">
    <mx:ArrayCollection id="dataProvider">
        <mx:String>Item A</mx:String>
        <mx:String>Item B</mx:String>
        <mx:String>Item C</mx:String>
    </mx:ArrayCollection>
    <view:TestDataGrid
        id="dg" 
        dataProvider="{ dataProvider }"
        width="400">
        <view:columns>
            <mx:DataGridColumn dataField="text" />
            <mx:DataGridColumn itemRenderer="view.RendererButton" />
        </view:columns>
    </view:TestDataGrid>
</mx:Application> 
```

**视图.TestDataGrid.as**

```
package view
{
    import flash.events.Event;

    import mx.controls.DataGrid;
    import mx.core.ScrollPolicy;

    public class TestDataGrid extends DataGrid
    {
        public function TestDataGrid()
        {
            this.verticalScrollPolicy = ScrollPolicy.OFF;
            this.variableRowHeight = true;
            this.addEventListener( RendererButton.RENDERER_RESIZE , onRendererResize );
        }
        private function onRendererResize( event : Event ) : void
        {
            resizeDatagrid();
        }
        private function resizeDatagrid():void
        {
            height = measureHeightOfItems(0, dataProvider.length ) + headerHeight;
        }
    }
} 
```

**view.RendererButton.mxml**

```
<?xml version="1.0" encoding="utf-8"?>
<mx:HBox xmlns:mx="http://www.adobe.com/2006/mxml">
    <mx:Button width="50" height="50"
        click="onClick()" />

    <mx:Script>
        <![CDATA[

            public static const RENDERER_RESIZE : String = "resizeRenderer";
            private function onClick() : void
            {
                this.height += 20;
                dispatchEvent( new Event( RENDERER_RESIZE , true ) );
            }
        ]]>
    </mx:Script>
</mx:HBox> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-12-11T15:58:14.847

您可以使用以下代码通过 AdvancedDataGrid 实现此目标。如果删除 this.headerHeight，它也适用于 List，这让我相信它应该适用于常规的旧 DataGrid。

```
 override protected function measure():void
  {
   super.measure();

   if ( this.dataProvider )
   {
    var newHeight : int = measureHeightOfItems( 0, this.dataProvider.length ) + this.headerHeight;

    this.minHeight = newHeight;
    this.height = newHeight;
   }
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-20T06:11:10.953

要在运行时调整数据网格的大小......使用 rowcount 属性并将其与 dataprovider 长度绑定。随着数据提供者的更新，行数也会更新。[您可以在此处](http://blog.flexexamples.com/2007/11/01/resizing-a-flex-datagrid-control-using-the-rowcount-property/)
查看如何在 flex 中使用 rowcount 的示例

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-04T10:18:55.147

要做诸如可变宽度和高度单元格/行/列之类的事情，以及其他“高级”功能 - 尝试扩展`AdvancedDataGrid`而不是旧的、更无聊的`DataGrid`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-18T09:11:36.573

对于它的价值，我从来没有设法解决这个问题。代码很快就沉迷于处理边缘情况。

我最终放弃了 dataGrid 方法，并使用 VBox 和 HBox 编写了一个解决方案以方便调整大小。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-03T23:24:04.980

物有所值; 您应该使用数据网格/高级数据网格的 variableRowHeight="true" 属性。

如果它让你感觉更好，我创建了自定义 VBox，HBox 解决方案，然后发现它已经完成了！（折断！！）

祝你好运！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-26T02:48:41.210

您的方法存在潜在问题。ItemRenderers 旨在以一致的方式渲染数据项，如果您丢弃当前渲染器并创建一个新渲染器并设置新渲染器的数据属性，它应该看起来与前一个相同。您不应该在数据成员之外对渲染器进行临时更改，并且当您这样做时渲染器将以奇怪的方式运行。

我怀疑如果您更改数据模型对象以包含计数属性并将渲染器的高度绑定到表达式“{50 + data.count * 20}”，然后使按钮的点击处理程序将 data.count 增加 1，这将正常工作。（我的经验是，只要在调用 makeRowsAndColumns() 之前由于 data 属性完成更改，DataGrid 就会以适当的大小为每一行重新绘制自身。）我没有为您的示例尝试过这种方法，所以我不能肯定它确实有效，但肯定这是使用项目渲染器的正确心态。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-11-10T10:57:54.447

对于此类问题，我有一些肮脏的解决方案试试这个

```
private function ResizeGrid():void{
    if ( this.dg.maxVerticalScrollPosition > 0 ){
        this.dg.height +=5;
        setTimeout(this.ResizeGrid,100);
    }
} 
```

并延迟调用您的函数，如下所示

```
setTimeout(this.ResizeGrid,100); 
```

这是一种肮脏的方法，但对我有用:)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-02-24T07:35:38.603

以下代码`gridItemRenderer`帮助了我：

```
protected function resize():void
{
    column.grid.validateSize();
    column.grid.validateDisplayList();
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-07-28T13:12:12.620

我有这个问题的解决方案，渲染器更改需要与您的数据提供者同步。那么只有 measureHeightOfItems 方法才能给出准确的结果。

# javascript - 检测鼠标何时不移动

> ID：609965
> 
> 赞同：24
> 
> 时间：2009-03-04T10:15:50.850
> 
> 标签：javascript, events, mouse

我能够找到光标位置。但是我需要确定鼠标是否稳定。如果鼠标超过 1 分钟没有移动，那么我们必须提醒用户。

这怎么可能，有什么特别活动吗？（仅适用于 JavaScript 中的 IE）

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-03-04T10:24:17.663

当鼠标在未来一分钟移动时设置超时，如果鼠标移动，则清除超时：

```
var timeout;
document.onmousemove = function(){
  clearTimeout(timeout);
  timeout = setTimeout(function(){alert("move your mouse");}, 60000);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-08-30T20:29:26.830

**这是一个一次性的功能，可以检查任何元素的移动：**

```
function mouse (element, delay, callback) {

   // Counter Object
   element.ms = {};

   // Counter Value
   element.ms.x = 0;

   // Counter Function
   element.ms.y = function () {

      // Callback Trigger
      if ((++element.ms.x) == delay) element.ms.callback(element, element.ms);
   };

   // Counter Callback
   element.ms.callback = callback;

   // Function Toggle
   element.ms.toggle = function (state) {

      // Stop Loop
      if ([0, "off"][state]) clearInterval(element.ms.z);

      // Create Loop
      if ([1, "on"][state]) element.ms.z = setInterval(element.ms.y, 1);
   };

   // Function Disable
   element.ms.remove = function () {

      // Delete Counter Object
      element.ms = null; return delete element.ms;
   };

   // Function Trigger
   element.onmousemove = function () {

      // Reset Counter Value
      element.ms.x = -1;
   };

   // Return
   return element.ms;
}; 
```

**用法：** `mouse(element, delay, callback)`

**示例：** *让视频播放器在空闲和全屏时 5 秒后隐藏鼠标*

```
let x = mouse(video, 5000, function (a) {
   if (document.webkitIsFullScreen) video.style.cursor = "none";
});

x.toggle(1); addEventListener("mousemove", function () {
   video.style.cursor = "auto";
}); 
```

*聊天室AFK（45秒）（假设你有一个聊天框和一个发送消息功能）：*

```
let x = mouse(chatBox, (45e3), function (a) {
   chatBox.send({ text: chatBox.username + " is AFK.", italic: true });
});

x.toggle(1); x.addEventListener("mousemove", function () {
  chatBox.send({ text: chatBox.username + " is no longer AFK", italic: true });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T10:22:12.410

有没有办法设置计时器在每次鼠标移动事件后开始递增？

如果达到一分钟，则弹出消息框，但每次鼠标移动计时器都会重置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T10:22:48.977

使用在 mousemove 事件上重置其值的计时器。如果计时器达到 1 分钟 --> 做点什么。

更多关于**计时器**的信息在这里[http://www.w3schools.com/js/js_timing.asp](http://www.w3schools.com/js/js_timing.asp)
更多关于**捕捉鼠标事件**的信息在这里[http://www.quirksmode.org/js/events_mouse.html](http://www.quirksmode.org/js/events_mouse.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-04T10:24:38.300

是的，你在 Javascript 中有一个 onmousemove 事件，所以要实现你所需要的，你只需要编写如下代码：

```
startTimer();
element.onmousemove = stopTimer(); //this stops and resets the timer 
```

例如，您可以在文档正文标签上使用它。

更新：@Marius 取得了比这个更好的例子。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-04T10:24:01.097

您可以使用 onmousemove 事件。在其中，clearTimeout() 和 setTimeout(your_warning, 1 分钟)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-04T10:24:08.707

您可以使用[此脚本/片段](http://www.codelifter.com/main/javascript/capturemouseposition1.html)来检测鼠标指针位置并“记住”它。然后使用计时器“setTimeout(...)”来检查位置，比如说每秒并记住那个时间。

如果超过一分钟并且位置没有改变，您可以提醒用户。

# user-controls - 基于主题的用户控件 asp.net

> ID：609968
> 
> 赞同：0
> 
> 时间：2009-03-04T10:16:50.987
> 
> 标签：user-controls, app-themes

有没有办法根据站点使用的主题来使用特定的用户控件？

场景：我在我的 asp.net 项目中使用主题。我将拥有相同的代码库和不同的外观和感觉，因此使用主题和皮肤。现在的问题是，如果我想根据站点的类型使用不同的页眉和页脚（它们是用户控件），我们如何在主题的帮助下做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-08T14:55:38.447

是的，可以使用主题修改控件层次结构。

这可以通过Themeable 的**ITemplate**属性**实现**。

例如，如果您有一个自定义控件，该控件仅具有可主题化的**Contents**属性，您可以说：

```
<custom:MyThemeableControl runat="server">
    <Contents>
    ... any valid *.skin markup here
    </Contents>
</custom:MyThemeableControl> 
```

现在您可以将 Contents 中的控件换成不同的主题，如下所示 - 对于*ThemeA*，您将拥有以下皮肤：

```
<custom:MyThemeableControl runat="server">
    <Contents>
        <asp:Button runnat="server" />
    </Contents>
</custom:MyThemeableControl> 
```

对于*ThemeB*，您将拥有以下皮肤：

```
<custom:MyThemeableControl runat="server">
    <Contents>
        <asp:TextBox runnat="server" />
    </Contents>
</custom:MyThemeableControl> 
```

然后此页面将在*ThemeA下呈现一个***Button** ，在*ThemeB*下呈现一个**TextBox**：

 ****```
<@Page Theme="ThemeA">
<custom:MyThemeableControl runat="server" />

<@Page Theme="ThemeB">
<custom:MyThemeableControl runat="server" /> 
```

# c - 如何从 Delphi 制作的 DLL 中导入函数？

> ID：609970
> 
> 赞同：1
> 
> 时间：2009-03-04T10:17:45.480
> 
> 标签：c, delphi, dll, function

你能告诉我如何在我的 C 程序中使用以下函数吗？

Delphi DLL - 导出函数：

```
function GetCPUID (CpuCore: byte): ShortString; stdcall;
function GetPartitionID(Partition : PChar): ShortString; stdcall; 
```

我没有那个 DLL 的源代码，所以我必须让我的 C 程序适应那个 DLL，而不是反过来。

我执行以下操作并收到错误

```
typedef char* (_stdcall *GETCPUID)(BYTE);
typedef char* (_stdcall *GETPID)(PCHAR);
GETCPUID pGetSerial;
GETPID pGetPID

HMODULE hWtsLib = LoadLibrary("HardwareIDExtractor.dll");
if (hWtsLib){
pGetSerial = (GETCPUID)GetProcAddress(hWtsLib, "GetCPUID");
char *str = (char*) malloc(1024);
str = pGetSerial((BYTE)"1");

pGetPID= (GETPID )GetProcAddress(hWtsLib, "GetPartitionID");
char *str1 = (char*) malloc(1024);
str1 = pGetPID("C:");
} 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-04T17:29:55.597

由于您没有 DLL 的源代码，因此您需要在 C 方面获得一些创意。尽管 ShortString 被列为函数结果，但实际上**调用者**有责任提供放置结果的位置。因为这是一个stdcall函数，参数是从右到左传入的，也就是说最后传入的是ShortString结果的地址。要使其对齐，它需要列出的第一个参数。我将做第一个 API，GetCPUID。在 C 中，它可能看起来像这样：

```
typedef struct ShortString {
  char len;
  char data[255];
};
typedef void (_stdcall *GETCPUID)(struct ShortString *result, BYTE cpuCore);

GETCPUID pGetSerial;

HMODULE hWtsLib = LoadLibrary("HardwareIDExtractor.dll");
if (hWtsLib) {
  ShortString serial;
  pGetSerial = (GETCPUID)GetProcAddress(hWtsLib, "GetCPUID");
  pGetSerial(&serial, '1');
  char *str = malloc(serial.len + 1); // include space for the trailing \0
  strlcpy(str, serial.data, serial.len);
  str[serial.len] = '\0'; // drop in the trailing null
} 
```

我将把 GetPartitionID 作为练习留给读者:-)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-04T15:24:11.297

ShortString 与 PChar (char *) 不同。它是一个 char 数组，第一个 char 是字符串的长度。对于 C，最好一直使用 PChar (char *)。

```
procedure GetCPUID (CpuCore: byte; CpuId: PChar; Len: Integer); stdcall;
procedure GetPartitionID(Partition : PChar; PartitionId: PChar; Len: Integer); stdcall;

typedef (_stdcall *GETCPUID)(BYTE, char*, int);
typedef (_stdcall *GETPID)(PCHAR, char*, int);
GETCPUID pGetSerial;
GETPID pGetPID

HMODULE hWtsLib = LoadLibrary("HardwareIDExtractor.dll");
if (hWtsLib){
pGetSerial = (GETCPUID)GetProcAddress(hWtsLib, "GetCPUID");
char *str = (char*) malloc(1024);
pGetSerial((BYTE)"1", str, 1024);

pGetPID= (GETPID )GetProcAddress(hWtsLib, "GetPartitionID");
char *str1 = (char*) malloc(1024);
pGetPID("C:", str, 1024); 
```

# python - 如何在 Python 中使用布尔值“和”

> ID：609972
> 
> 赞同：51
> 
> 时间：2009-03-04T10:17:53.043
> 
> 标签：python, boolean-logic

在 C# 中，我们可以`&&`像这样使用 (boolean and)：

```
int i = 5;
int ii = 10;
if(i == 5 && ii == 10) {
    Console.WriteLine("i is 5, and ii is 10");
}
Console.ReadKey(true); 
```

但是用 python 试试：

```
i = 5
ii = 10
if i == 5 && ii == 10:
    print "i is 5 and ii is 10"; 
```

我收到一个错误：`SyntaxError: invalid syntax`

如果我使用单个`&`，至少我没有语法错误。如何`&&`在 Python 中进行布尔运算？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2009-03-04T10:21:37.437

尝试这个：

```
i = 5
ii = 10
if i == 5 and ii == 10:
      print "i is 5 and ii is 10" 
```

**编辑**：哦，你不需要最后一行的分号（编辑从我的代码中删除它）。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-03-04T13:52:59.003

正如所指出的，python 中的“&”执行按位与运算，就像它在 C# 中一样。`and`是`&&`运算符的适当等价物。

由于我们正在处理布尔值（`i == 5`is`True`和`ii == 10`is also `True`），您可能想知道为什么这无论如何都不起作用（True 被视为整数应该仍然意味着 True & True 是一个 True 值），或者抛出异常（例如，通过禁止对布尔类型进行按位运算）

原因是运算符优先级。" `and`" 运算符比 绑定得更松散`==`，因此表达式：" `i==5 and ii==10`" 等价于：" `(i==5) and (ii==10)`"

但是，按位`&`的优先级高于“ `==`”（因为您不希望像“ `a & 0xff == ch`”这样的表达式表示“ `a & (0xff == ch)`”），因此该表达式实际上将被解释为：

```
if i == (5 & ii) == 10: 
```

这是使用 python 的运算符链接来表示： ii 与 5 的值是否等于 i 和 10。显然这永远不会是真的。

如果您包含括号来强制优先级，您实际上会得到（看似）正确的答案，所以：

```
if (i==5) & (ii=10) 
```

将导致打印该语句。这是错误的做法，但是 - " `&`" 与 " " - 有许多不同的语义`and`（优先级、短路、带有整数参数的行为等），所以幸运的是你在这里抓住了这一点，而不是被愚弄直到它变得不那么明显错误。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-03-04T10:30:09.630

要使用的正确运算符是关键字“或”和“和”，在您的示例中，表达这一点的正确方法是：

```
if i == 5 and ii == 10:
    print "i is 5 and ii is 10" 
```

您可以参考[语言参考中“布尔运算”部分](http://docs.python.org/reference/expressions.html#boolean-operations)的详细信息。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-04T12:44:06.063

您也可以将它们作为一对进行测试。

```
if (i,ii)==(5,10):
    print "i is 5 and ii is 10" 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-03-04T10:22:35.983

`&`用于逐位比较。改为使用`and`。顺便说一句，您不需要在 print 语句的末尾使用分号。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-03-04T13:22:37.733

在 python 中，使用`and`而不是`&&`这样：

```
#!/usr/bin/python
foo = True;
bar = True;
if foo and bar:
    print "both are true"; 
```

这打印：

```
both are true 
```

# .net - 实体框架与 AssociateWith

> ID：609973
> 
> 赞同：4
> 
> 时间：2009-03-04T10:18:01.423
> 
> 标签：.net, linq-to-sql, entity-framework

当我使用 Linq2Sql 时，我可以通过在 DataLoadOptions.AssociateWith 方法中使用 lambda 表达式来过滤表。

我用它来过滤使用的语言——所以我有一个包含所有语言的语言表和一个包含对象的对象表。

喜欢：

```
DataLoadOptions opt = ...;
opt.AssociateWith<DB.Objects>(o => o.Language.Where(p => p.Culture == CurrentUser.Culture)); 
```

如何使用实体框架来做到这一点 - 我必须使用 .Include(string) 而不是 dataloadoptions？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-11-22T07:02:28.597

您能否告诉我们您使用的是哪个版本的 EF。

但是说你想使用“include”方法，那么它可能看起来像这样。

```
var result = dbContext.Objects.Include("Language").Where(p=>p.Culture == CurrentUser.Culture ); 
```

请注意，“语言”应反映模型中导航属性名称中设置的内容。（所以要注意复数）

# database - 您最大的索引改进是什么？

> ID：609977
> 
> 赞同：0
> 
> 时间：2009-03-04T10:18:32.607
> 
> 标签：database, database-design, indexing

几年前，我在优化运行缓慢的数据库表时得到了启示。在具有大型数据字段的表中，原始查询大约需要 20 分钟。在最终意识到没有人首先为表建立索引后，我为几个键建立了一个索引。瞧，查询在 0.15 秒内运行！

在为表添加索引时，您最大的改进是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-04T15:28:19.320

这与一个非常古老的 DBMS 产品有关，它类似于 Oracle，但与 Oracle 本身不同。该产品使创建没有索引的表变得非常容易。Oracle 不同的是，如果你声明了一个主键，Oracle 会自动在主键上创建一个索引。这个产品没有做到这一点。

我被要求加速正在爬行的数据库。有一个名为“CostCenters”的表，其中有 900 行并且没有索引。几年前，该表有 20 行。此表上的参照完整性查找需要进行表扫描。系统已经瘫痪。

创建索引花了五分钟。它将速度提高了 100 倍。我们还做了一些其他的事情，比如对磁盘进行碎片整理，以及重建一些已经过度填充的索引。一个在加速前需要 10 分钟的任务在加速后需要两秒钟。

话虽如此，不要让对速度的担忧使您对简单而合理的设计视而不见。您需要简单而可靠的表、索引、数据库对象、应用程序代码和查询。加速简单而合理的事情很容易。将只为速度而设计的东西变得简单而合理要困难得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-05T02:44:03.453

我曾经修改过一个分析函数，在窗口子句中包含几个逻辑冗余列，允许分区和子分区修剪以及基于索引的访问。

一小时的查询减少到 0.02 秒，快了 180,000 倍。

[http://oraclesponge.wordpress.com/2006/03/15/predicate-pushing-and-analytic-functions/](http://oraclesponge.wordpress.com/2006/03/15/predicate-pushing-and-analytic-functions/)

我赢了吗？:D

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T10:23:47.680

我有一个非常相似的情况，一个没有设置主键的表 - 所以加入这个表（包含 5 行左右）大约需要 10 分钟（是的 - 另一个表很大）

一切都发生在 MSSQL2k 上

设置PK后不到十分之一秒...

因此，当没有 PK 时，查询优化器真的很糟糕:)***************