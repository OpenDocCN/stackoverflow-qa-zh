# StackOverflow 问答 10721000-10721999

# svn - svn删除项目主干

> ID：10721015
> 
> 赞同：4
> 
> 时间：2012-05-23T13:31:42.820
> 
> 标签：svn, project, trunk

如何删除项目的主干文件夹以及主干文件夹中的所有内容。

例如我的项目是 WHOTest，我想删除 WHOTest/trunk

让我知道谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T14:00:07.480

您可以像 SVN 中的任何其他文件夹一样删除它。行李箱文件夹没有什么特别之处。按照惯例，它们只是这样命名的。

这是[命令](http://svnbook.red-bean.com/en/1.8/svn.ref.svn.c.delete.html)[的文档`svn delete`](http://svnbook.red-bean.com/en/1.8/svn.ref.svn.c.delete.html)

# google-app-engine - 全文搜索索引的大小会受到限制吗？

> ID：10721018
> 
> 赞同：5
> 
> 时间：2012-05-23T13:31:49.790
> 
> 标签：google-app-engine

我们即将将我们的应用程序迁移到 FTS 以替换数据存储索引。一旦 FTS 处于我们的实验状态，索引大小是否会有限制，还是像数据存储一样不受限制？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-26T00:39:34.617

一旦 Search API 不再是实验性的，索引大小就应该没有限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-22T15:19:21.640

从[App Engine 版本 1.9.0](https://code.google.com/p/googleappengine/wiki/SdkReleaseNotes)开始：“搜索 API 的大小限制现在是基于每个索引计算和强制执行的，而不是针对整个应用程序。每个索引限制现在是 10GB。没有对索引数量或应用程序可能使用的搜索 API 存储总量的固定限制。”

# asp.net-mvc-3 - 如何在 MVC3 中使用 ViewBag 作为列表

> ID：10721029
> 
> 赞同：1
> 
> 时间：2012-05-23T13:32:08.507
> 
> 标签：asp.net-mvc-3, viewbag

我需要在另一个 ViewBag 中使用 ViewBag 作为列表，但我不明白我应该怎么做。
这是我的代码：

```
 List<string> srclist = new List<string>();
            foreach(var item in candidateportfolio)
            {
                if(item.PortfolioID!=0 && item.ChandidateID!=0)
                {
                    string filepath = Server.MapPath("~/ePortfolio/PortFolioContent/" + HobbyDetailID + "/Assignments/Exhb_" + item.PortfolioID + "_" + item.ChandidateID + ".jpg");
                    if (System.IO.File.Exists(filepath))
                    {
                        srclist.Add(filepath);
                    }
                }
            }
            ViewBag.Thumbnail = srclist; 
```

Candidateportfolio 是 CandidatePortfolio 类的对象。

我在类中获取数据并检查其字段是否不为空。然后我将文件路径添加到列表中并将列表分配给 Viewbag

然后在视图中我像这样使用它：

```
 @foreach (var item in ViewBag.Thumbnail as List<string>)
{   
<img src="@item" title="Learner:@ViewBag.FirstName" width="150px" height="150px" border="5" style="align:right;margin:10px"/> 
} 
```

现在的问题是我也想获取 ViewBag.FirstName 作为列表。我不能在这个列表中运行另一个列表。请告诉我我应该怎么做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T13:47:06.813

如果您想要一个包含两者`FirstName`和路径的列表，例如照片，您可以创建一个新类：

```
public class ThumbnailModel
{
    public string FirstName { get; set; }
    public string PhotoPath { get; set; }
} 
```

现在您可以`List<Thumbnail>`在`ViewBag`.

`List<Thumbnail>`但我建议只使用包含属性的相关模型创建一个强类型视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T13:47:16.663

用户1274646，

您最好的选择是创建一个包含现有缩略图元素和附加 FirstName 属性的公共类。这可能是这样的：

```
public class CandidateItem{
  public string FirstName {get; set;}
  public string Filepath {get; set;} 
} 
```

然后，在您的循环中，创建一个新的 CandidateItem 并将其添加到列表（即列表）中。这是修改后的代码：

```
List<CandidateItem> srclist = new List<CandidateItem>();
foreach(var item in candidateportfolio)
{
    if(item.PortfolioID!=0 && item.ChandidateID!=0)
    {
        CandidateItem candItem = new CandidateItem();
        candItem.Filepath = Server.MapPath("~/ePortfolio/PortFolioContent/" + HobbyDetailID + "/Assignments/Exhb_" + item.PortfolioID + "_" + item.ChandidateID + ".jpg");
        candItem.FirstName = item.FirstName;
        if (System.IO.File.Exists(filepath))
        {
            srclist.Add(candItem);
        }
    }
}
ViewBag.Thumbnail = srclist; 
```

然后在视图中使用它：

```
@foreach (var item in ViewBag.Thumbnail as List<CandidateItem>)
{   
    <img src="@item.Filepath" title="Learner:@item.FirstName" width="150px" height="150px"   border="5" style="align:right;margin:10px"/> 
} 
```

# java - 在循环中使用 httpclient

> ID：10721033
> 
> 赞同：0
> 
> 时间：2012-05-23T13:32:16.717
> 
> 标签：java, httpclient, connection

我有一个用于测试链接的类。我使用 for 循环将链接传递给类。在我的课堂上，我使用 httpclient 打开到链接的连接。这可能会发生数千次。过了一会儿，我开始出现超时，我认为这是因为创建了这么多 httpclients。

我的问题是，管理此问题的最佳方法是什么（我是初学者，仅供参考）。我是否应该关闭连接，只使用一个 httpclient 等？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T13:41:32.927

在每个循环结束之前，您应该这样做`Webpage.close();`。

另一个想法是在循环外部创建对象，并在内部实例化它们。就像是：

```
WebPage obj = null;

while(true) {
    obj = new Object(); //I don't recall the correct arguments here

    //Processing

    obj.close;
} 
```

# java - AspectJ：访问私有字段？

> ID：10721037
> 
> 赞同：5
> 
> 时间：2012-05-23T13:32:25.530
> 
> 标签：java, aop, aspectj

我想使用方面为私有 id 字段添加 getter 和 setter。我知道如何通过方面添加方法，但是如何访问私有 id 字段？

我认为我只需要使方面得到授权。我尝试了以下代码，但方面无法访问 id 字段。

```
public privileged aspect MyAspect {

public String Item.getId(){

    return this.id;
} 
```

一种可能性是用户反映，如本博客文章所示：http: [//blog.m1key.me/2011/05/aop-aspectj-field-access-to-inejct.html](http://blog.m1key.me/2011/05/aop-aspectj-field-access-to-inejct.html)

反射是唯一的可能性还是有办法用 AspectJ 做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-24T14:27:30.323

你确定你不能？我刚刚测试并运行了。这是我的完整代码：

```
package com.example;

public class ClassWithPrivate {
    private String s = "myStr";
}

==========

package com.example.aspect;

import com.example.ClassWithPrivate;

privileged public aspect AccessPrivate {

    public String ClassWithPrivate.getS() {
        return this.s;
    }

    public void ClassWithPrivate.setS(String str) {
        this.s = str;
    }
}

==========

package com.example;

public class TestPrivate {

    public static void main(String[] args) {

        ClassWithPrivate test = new ClassWithPrivate();
        System.out.println(test.getS());
        test.setS("hello");
        System.out.println(test.getS());
    }
} 
```

如果由于某种原因，这对您不起作用，您可以使用反射或此处描述的其他方式： [https ://web.archive.org/web/20161215045930/http://blogs.vmware.com/vfabric/ 2012/04/using-aspectj-for-accessing-private-members-without-reflection.html](https://web.archive.org/web/20161215045930/http://blogs.vmware.com/vfabric/2012/04/using-aspectj-for-accessing-private-members-without-reflection.html) 但是，根据基准，它可能不值得。

# hibernate - OpenJPA 是否支持批量插入？

> ID：10721038
> 
> 赞同：2
> 
> 时间：2012-05-23T13:32:29.993
> 
> 标签：hibernate, jpa, openjpa

OpenJPA 是否支持类似于[Hibernate](http://docs.jboss.org/hibernate/core/3.3/reference/en/html/batch.html)的批量插入？我没有在文档中找到它，但我希望我错过了它。我知道[JPA 通常不支持它](https://stackoverflow.com/questions/1362972/portable-jpa-batch-bulk-insert)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T12:52:35.323

简短的回答，是的。

更长的答案，获取指向 Hibernate 文档的链接，并将 Session 替换为 JPA EntityManager。

```
EntityManager em = emf.createEntityManager();
Transaction tx = em.getTransaction();

tx.begin();   
for ( int i=0; i<100000; i++ ) {
    Customer customer = new Customer(.....);
    em.persist(customer);
    if ( i % 20 == 0 ) { //20, same as the JDBC batch size
        //flush a batch of inserts and release memory:
        em.flush();
        em.clear();
    }
}

tx.commit();
em.close(); 
```

# google-chrome - 跨浏览器弹出调整大小问题

> ID：10721041
> 
> 赞同：0
> 
> 时间：2012-05-23T13:32:36.573
> 
> 标签：google-chrome, popup, resize

我有以下在 Firefox 中运行但在 IE 和 Chrome 中不起作用的代码。我也更改了窗口大小（高度和宽度）。但是其他浏览器没有变化。它只在 FireFox 中运行良好。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="expires" content="Fri, 30 Dec 2005 12:00:00 GMT" />
<meta http-equiv="cache-control" content="no-cache" />
<title>RSI Q</title>
<script>
function OpenNewWindow()
{
    var WindowWidth=250;
    var WindowHeight=400;

    // calculate x-distance
    var PageWidth = screen.width;
    var xDistance = parseInt(PageWidth) - parseInt(WindowWidth);

    // calculate y-distance
    var PageHeight = screen.height;
    var yDistance = parseInt(PageHeight) - parseInt(WindowHeight);

    window.open('mypopuppage.php', 'MyPopup', 'fullscreen=0,width='+WindowWidth+',height='+WindowHeight+',resizable=0,scrollbars=0,status=0,titlebar=0,toolbar=0,top='+yDistance+',left='+xDistance);
}
</script>
</head>
<body onload="OpenNewWindow();">
</body>
</html> 
```

IE 扩展了宽度，chrome 在高度和宽度上都搞砸了。而FF表现良好。[http://i50.tinypic.com/2yvnlae.jpg](http://i50.tinypic.com/2yvnlae.jpg)在这里您可以看到不同浏览器中窗口大小的差异

# c++ - 将莫尔斯值解码为字母

> ID：10721044
> 
> 赞同：-1
> 
> 时间：2012-05-23T13:32:40.370
> 
> 标签：c++

我正在尝试将莫尔斯电码解码为英语。基本上我从文件中得到一串行并将我的显示排成一行，例如

```
** -* -  --** --- --- -- L* ***- * *-**  = -- *- *--* V** * *-- .--* 
```

我在代码之间有空格我应该分隔除莫尔斯电码旁边的上部 isspace 之外的任何其他字符。我有一棵树，其中包含莫尔斯电码和相关的莫尔斯电码，我已经手动测试过它返回的字母。但问题是解码部分读取每个莫尔斯电码并传递给我从莫尔斯电码到字母的转换。请我绝望地寻求帮助。任何提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:30:03.660

它看起来像一个家庭作业问题，如果是，您应该将其标记为@homework。

您应该有一个二叉树，将字母映射到一侧符号“*”和另一侧符号“-”的节点。每个节点应该有：LeftChild、RightChild、Letter。

要解析文本，您应该获取每个字符并遍历摩尔斯电码树，直到到达一个空格。当你到达一个空间时，你应该在你到达的节点中获得字母，然后从树的根部重新开始。

应该还有一个 char 代表单词的结尾，是 'L' 吗？

如果您提供更多信息，人们将能够帮助您...

# javascript - 连续的背景声音

> ID：10721047
> 
> 赞同：-1
> 
> 时间：2012-05-23T13:32:42.503
> 
> 标签：javascript, jquery, html, audio

如何在页面中实现连续的背景声音，当用户在不使用 iframe 的情况下从一个页面移动到另一个页面时不会中断？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T13:39:27.973

使用一个技巧，如果框架集对您来说不是问题，请使用框架集构建您的页面，并使用一个框架作为背景（无大小）播放声音和其他（全 100%x100%）您可以导航的地方。这还具有隐藏导航 URL 的优点，仅在导航栏上留下站点 url。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:03:28.683

如果你疯了，你可以`timeupdate`在元素的事件上设置一个事件监听`<audio>`器并将其存储`currentTime`在 localStorage（或 cookie）中。然后，当您加载页面时，读取该值并`currentTime`再次设置。但是，我想每秒向 localStorage 写入数十次可能会很糟糕（但在测试之前我不会做出任何性能声明！）。

但是，此解决方案需要具有`audio`和`localStorage`支持的现代浏览器。

# c# - 在 LINQ 选择期间无法设置枚举属性

> ID：10721050
> 
> 赞同：1
> 
> 时间：2012-05-23T13:32:47.467
> 
> 标签：c#, mysql, linq, entity-framework-4, google-shopping-api

我有以下代码片段

```
IQueryable<RssItem> rssItems = from prodotti prodotto in tuttiProdotti
                                               join marca in tutteMarche on prodotto.marca equals marca.id

                                               where prodotto.eliminato == 0
                                               orderby prodotto.id ascending
                                               select new GoogleShoppingRssItem
                                               {
                                                   Author = AUTHOR,
                                                   //Availability = prodotto.disponibilita > 0 ? AvailabilityType.instock : AvailabilityType.outofstock,
                                                   //Availability = AvailabilityType.instock,
                                                   Title = prodotto.titolo,
                                               }; 
```

当可用性行的第一个版本未被注释时，我得到了`ArgumentException`，说那`value`不是类型`Edm.Int32`。我认为它与`prodotto.disponibilita`属性有关`int?`（但 DB 上没有`null`值）。第二个版本，不检查产品数量，抛出同样的异常。

只有在注释了可用性设置的第二个版本之后，代码才最终起作用并且表达式得到了评估。

枚举定义如下：

```
 [System.CodeDom.Compiler.GeneratedCodeAttribute("xsd", "2.0.50727.3038")]
    [System.SerializableAttribute()]
    [XmlType(Namespace="http://base.google.com/ns/1.0")]
    [XmlRoot("availability", Namespace="http://base.google.com/ns/1.0", IsNullable=false)]
    public enum AvailabilityType {

        /// <remarks/>
        [XmlEnum("in stock")]
        instock,

        /// <remarks/>
        [XmlEnum("available for order")]
        availablefororder,

        /// <remarks/>
        [XmlEnum("out of stock")]
        outofstock,

        /// <remarks/>
        preorder,
    } 
```

`enum`关于在 LINQ 选择语句中设置属性，我应该知道些什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T13:57:40.450

> 关于在 LINQ 选择语句中设置枚举属性，我应该知道些什么？

是的。EF4 不支持枚举，您不能在 Linq-to-Entities 查询中使用它们。如果您在 Linq-to-Objects 查询中使用它们，它应该可以工作，所以试试这个：

```
IQueryable<RssItem> rssItems = (from prodotto in tuttiProdotti
                                join marca in tutteMarche on prodotto.marca equals marca.id
                                where prodotto.eliminato == 0
                                orderby prodotto.id ascending
                                select prodotto).ToList() // Now you switched to L2O
                               .Select(x => new GoogleShoppingRssItem
                                               {
                                                   Author = AUTHOR,
                                                   Availability = x.disponibilita > 0 ? AvailabilityType.instock : AvailabilityType.outofstock,
                                                   Title = x.titolo,
                                               }); 
```

# php - 使用 PHP 变量的 PHP javascript 调用

> ID：10721053
> 
> 赞同：-2
> 
> 时间：2012-05-23T13:32:50.643
> 
> 标签：php, javascript, html

美好的一天，我的 PHP 代码出现了一个非常奇怪的错误。我正在尝试通过读取 xml 文件来动态更改网页的内容。我读入一些数据并将数据分配给一个名为 $course_title 的 PHP 变量，然后尝试调用一些 Javascript 来更新 DOM 元素的“innerHTML”。注意：在“echo $course_title;”这一行 将正确的数据打印到屏幕上。

```
$fn = dirname(__FILE__)."/course.xml";  
$xml = simplexml_load_file($fn);
$course_bookimagelocation = "";
foreach ($xml->children() as $child)
{
    if($child[0]->getName()=="book")
        $course_bookimagelocation = $child;
    if($child[0]->getName()=="title")
        $course_title = $child;
}   
//Problems start here...
echo $course_title;
echo '<script type="text/javascript">document.getElementById("heading").innerHTML = "';
echo $course_title;
echo '";</script>'; 
```

非常独特的是，第一个 echo 语句打印了正确的信息，但接下来的三行，.innerHTML 没有更改为相同的值。有谁知道那是什么？同样奇怪的是，如果我替换第二个“echo '$course_title';” 像“你好世界！” 然后是“你好世界！” 显示为“标题”id 对象的 innerHTML。

**编辑**

在名为 course.xml 的 XML 文件中，title 元素是*IC 210 Fall 2010*，$course_title 的内容是**IC 210 Fall 2010**，因此 php 文件的解析似乎是正确的，并且没有任何特殊字符，例如一个**"**或**'**

我还尝试将所有内容放在同一行，而不是运气......（我什至在 xml 文件中确保 <title> 元素的文本在同一行......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:23:31.017

确保`.innerHTML = "Some text"`它们在同一行，因为`.innerHTML = "\nSome Text\n"`在 javascript 中不起作用。

如果你想要这样的东西：

```
.innerHTML = "
Some String
"; 
```

尝试：

```
.innerHTML = ""+
"Some String" +
""; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T13:50:33.023

“调用一些 Javascript 来更新 DOM 元素的“innerHTML”。” 为此，我们使用 AJAX，不是吗？

好吧，你可以这样做，但我认为将文本预加载到一些隐藏的 DIV 中并使用你的函数来更改 DIVS 的内容甚至切换 DIV 的可见性（如你所愿）会更简单。这样，您将避免评论中提到的许多转义问题。

如果不使用 AJAX，我会这样做

# c# - 在C#中将方法拆分为几个最小的

> ID：10721054
> 
> 赞同：-1
> 
> 时间：2012-05-23T13:32:52.937
> 
> 标签：c#, .net

仅在良好的代码可读性方面（但可能为方法调用支付一些性能），是否有一个好的做法将复杂方法的部分功能拆分为几个较小的方法？或者这是某种“坏风格”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T13:35:35.343

最基本的规则是你的方法应该只做一件事。如果您检测到它正在做许多不同的事情，那么您就有了明显的重构机会。

如果您的方法具有单一的责任，但无论如何大小太长，请尝试将“帮助”功能提取到分离的方法中。您甚至可以检测到可以提升为单独类的代码。

TDD 开发是避免此类问题的一种很好的方法，因为它确实有助于清楚地分离关注点并避免仅仅为了可测试性而在单个方法上编写一堆代码。如果您不编写简洁的方法，则很难正确地测试它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T13:38:07.117

如果你考虑重用代码（**[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)**原则），你应该考虑重构。根据功能将方法内容拆分为不同的小模块，使其可重用。例如：如果您有一种方法可以保存客户注册详细信息并为他创建新订单。您可能可以检查很多方法，例如`CheckUserExist`,`SaveUser`和`SaveOrder`. 您应该能够根据需要在代码的其他区域重用此功能。将其拆分为模块化的部分也使您的代码更具可读性。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T13:38:45.937

Unclebob (Robert C. Martin) 认为方法不应超过 4-5 行代码。关于这一点，他的座右铭是[“萃取至滴落”](https://sites.google.com/site/unclebobconsultingllc/one-thing-extract-till-you-drop)。就个人而言，我认为这是一个非常好的做法。

Visual Studio 允许您通过按 CTRL+R、M 来提取方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T13:39:32.893

除了克劳迪奥的回答之外，如果检测到一些气味，则意味着您必须重构和拆分代码。

1- 非[DRY](http://www.artima.com/intv/dry.html)代码：如果您发现自己将某些行复制/粘贴到多个位置，这是一种难闻的气味，需要放置在中心位置，并尽可能多地调用。

2- 数百行的方法：任何好的方法都不应超过 50 行代码，可能多于或少于这个数字，但请放心，这种 346 行的方法不是一件好事。

3- 参数太多：方法中的一长串参数会使可读性和代码质量变差。

4-代码入侵：使用许多从另一个类阻止的方法，应该存在于这个类中。

希望有帮助。

# mysql - cakephp mysql错误

> ID：10721058
> 
> 赞同：0
> 
> 时间：2012-05-23T13:33:00.100
> 
> 标签：mysql, database, cakephp

我的网站有些问题。我想要这个视图做的是显示与用户 ID 相关的所有发票（在另一个表中），而不是代码在一个视图中打印出所有发票（忽略用户 ID）。当查看 cakephp 调试吐出的 sql 语句时，它将 where 显示为空白（别担心，我会包含实际的 sql 语句）。我也创建了会话代码，但我不确定如何对其进行编码，以便 mysql 数据将说明 where userid = current user;

这是视图的代码

```
<table width="100%" border="1">

            <table width="100%" border="1">
                <tr>
                    <th>Biller</th>
                    <th>Subject</th>
                    <th>Date</th>
                    <th>Action</th>
                </tr>
                <?php foreach($invoices as $invoice):?>
                    <tr> debug($invoices);
                        <td align='center'><?php echo $this->Html->link($invoice['Invoice']['biller'], 
                        array('action' => 'viewinvoice', $invoice['Invoice']['id'])); ;?> </td>
                        <td align='center'><?php echo $invoice['Invoice']['subject']; ?></td>
                        <td align='center'><?php echo $invoice['Invoice']['datecreated']; ?></td>
                        <td align='center'><a href="viewinvoice"><button>View Invoice</button></a><a href="disputeinvoice"><button>Dispute Invoice</button></a></td>
                    </tr>
                <?php endforeach; ?>

            </table> 
```

这是与此视图相关的类中的代码

```
 public function payinvoice($id = null){
        $this->set('title_for_layout', 'Pay Invoice');
        $this->set('stylesheet_used', 'homestyle');
        $this->set('image_used', 'eBOXLogoHome.jpg');   
        $this->layout='home_layout';

        $this->set('invoices', $this->Invoice->find('all' , array('conditions' => array('Invoice.biller' => $id)))); 
} 
```

这是该站点用于检索数据的 sql 代码

```
 SELECT `Invoice`.`id`, `Invoice`.`to`, `Invoice`.`biller`, `Invoice`.`subject`, `Invoice`.`description`, `Invoice`.`amount`, `Invoice`.`datecreated`, `Invoice`.`duedate` FROM `pra_cake`.`invoices` AS `Invoice` WHERE `Invoice`.`biller` IS NULL 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T17:10:36.390

这可能是网址的问题

尝试这个

```
<?php echo $this->Html->link('Invoice',
    array('controller' => 'invoices', 
          'action' => 'payinvoice', 
          $invoice['Invoice']['id'])
    );?> 
```

它会产生

```
<a href="/invoices/payinvoice/6">Invoice</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:05:38.480

看起来您没有将 id 传递到您的页面中。网址应如下所示：

```
/invoices/payinvoice/2 
```

# c# - WPF 启动画面和主窗口加载事件

> ID：10721060
> 
> 赞同：2
> 
> 时间：2012-05-23T13:33:05.870
> 
> 标签：c#, .net, wpf, xaml

`LOADED`基本上我的应用程序在主窗口的事件中做了很多事情。

我只想在这段时间（事件）**显示一些启动画面**`LOADED`，根本不显示主窗口。

我在这里找到了一些例子[http://www.codeproject.com/Articles/38291/Implement-Splash-Screen-with-WPF](http://www.codeproject.com/Articles/38291/Implement-Splash-Screen-with-WPF)但这不是一个好例子。[这个](https://stackoverflow.com/questions/1741922/wpf-splashscreen-implementing)提示也没有涵盖我的目的。

此外，我想在初始屏幕下的 LOADED 事件下显示每个阶段我所做的事情。所以我想在启动画面中添加一个状态更新。每个已完成的任务都会更新一个初始屏幕状态标签。

任何线索如何做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:17:26.767

这是给你的小代码。

```
 void TemplateSelector_Loaded(object sender, RoutedEventArgs e)
        {
            showWin();

            Thread.Sleep(10000);

            CloseWin();

        }

        private void CloseWin()
        {
            WindowManager.Close();
        }
        Window tempWindow = new Window();
        public void showWin()
        {
            WindowManager.LaunchWindowNewThread<SplashWindow>();

        }
    }

    public class WindowManager
    {
        private static Window win;
        public static void LaunchWindowNewThread<T>() where T : Window, new()
        {
            Thread newWindowThread = new Thread(ThreadStartingPoint);
            newWindowThread.SetApartmentState(ApartmentState.STA);
            newWindowThread.IsBackground = true;

            Func<Window> f = delegate
            {
                T win = new T();
                return win;
            };

            newWindowThread.Start(f);
        }

        private static void ThreadStartingPoint(object t)
        {
            Func<Window> f = (Func<Window>)t;
            win = f();

            win.WindowStartupLocation = WindowStartupLocation.CenterScreen;
            win.Topmost = true;
            win.Show();
            Dispatcher.Run();
        }
        public static void Close()
        {

            if (win != null)
                win.Dispatcher.BeginInvokeShutdown(DispatcherPriority.Send);

        }
    } 
```

您可以根据需要进行修改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:18:39.143

我在这里找到了一些很酷的解决方案[http://plaincolumn.blogspot.com/2009/11/wpf-splash-screen-with-status-update.html](http://plaincolumn.blogspot.com/2009/11/wpf-splash-screen-with-status-update.html)

所以它100%满足我的需求。

# java - Spring RMI 错误 java.lang.ClassNotFoundException: org.springframework.remoting.rmi.RmiInvocationHandler

> ID：10721062
> 
> 赞同：1
> 
> 时间：2012-05-23T13:33:13.177
> 
> 标签：java, spring, jakarta-ee, classloader, rmi

我正在尝试使用创建一些bean`Spring`并将它们导出到RMI ...

这是我的代码：

```
<bean class="org.springframework.remoting.rmi.RmiServiceExporter">
    <property name="serviceName" value="OfferService" />
    <property name="service" ref="offerService" />
    <property name="serviceInterface" value="ro.project.services.OfferService" />
    <property name="registryPort" value="1199" />
</bean> 
```

我在我的根文件夹中创建了一个名为“policy.all”的文件，我正在使用该参数运行我的虚拟机，但我仍然有这个错误：

```
java.lang.ClassNotFoundException: org.springframework.remoting.rmi.RmiInvocationHandler (no security manager: RMI class loader disabled) 
```

我不知道该怎么做......在linux中，完全相同的项目运行正常（使用jdk 1.7.0.4）但在windows中不是......在java 1.5（windows）中它正在工作......但在java 1.7中。 0.4（Windows）它不工作......

**编辑：**

我的错误是：

```
Exception in thread "main" org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.remoting.rmi.RmiServiceExporter#0' defined in class path resource [spring/services.xml]: Invocation of init method failed; nested exception is java.rmi.ServerException: RemoteException occurred in server thread; nested exception is: 
java.rmi.UnmarshalException: error unmarshalling arguments; nested exception is: 
java.lang.ClassNotFoundException: org.springframework.remoting.rmi.RmiInvocationHandler (no security manager: RMI class loader disabled) 
```

添加此行后：

```
if (System.getSecurityManager() == null)
{ 
    RMISecurityManager manager = new RMISecurityManager();
    System.setSecurityManager(manager); 
} 
```

我有这个错误：

```
Exception in thread "main" org.springframework.beans.factory.BeanDefinitionStoreException: IOException parsing XML document from class path resource [spring/application-context.xml]; nested exception is java.io.FileNotFoundException: class path resource [spring/application-context.xml] cannot be opened because it does not exist 
```

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T21:46:28.277

这里的重点不是安装安全管理器，而是查找类。您的部署中缺少一些 JAR 文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-03T11:21:54.100

我认为它仍然不重要，但我个人今天面临同样的问题，找不到答案。我把它贴在这里，也许它对某人有帮助。

解决方案：停止`rmiregistry`程序，或`rmiregistry`使用 -J 选项将 Spring jar 传递给。最简单的方法就是停止 rmiregistry 并允许 Spring 使用所有必需的类启动另一个。并且不要设置`RMISecurityManager`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T18:22:04.303

您需要在代码的一部分中包含此内容：

```
System.setSecurityManager(new RMISecurityManager()); 
```

您也可以安装另一个安全管理器，但只需要安装一个安全管理器。

实际上，我发布的行可以很容易地在独立桌面应用程序的主类中触发，但我不确定你的情况。您应该寻找一个可能执行此操作的配置选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-26T19:40:23.457

使用 Spring RMIServiceExporter，正确管理 RMI Registry 的最佳实践是使用 RMIRegistryFactoryBean。为了更好地让您理解，我粘贴了一个带有 RemoteBean 的 Spring 配置示例：

```
<bean id="RemoteServices" class="remote.RMIServicesImpl"/>
<bean id="RemoteRmiRegistry" class="org.springframework.remoting.rmi.RmiRegistryFactoryBean">
        <property name="alwaysCreate" value="true" />
        <property name="port" value="1093"></property>
</bean>
<bean class="org.springframework.remoting.rmi.RmiServiceExporter">
        <property name="service" ref="RemoteServices" />
        <property name="serviceInterface" value="remote.RemoteInterface" />
        <property name="serviceName" value="RemoteServices" />
        <property name="replaceExistingBinding" value="true"></property>
        <property name="registry" ref="RemoteRmiRegistry"></property>
    </bean> 
```

通过这种方式，RmiRegistryFactoryBean 将自主管理有关 RMI 套接字层的所有内容，您无需停止 JVM，只需重新部署它即可。

如果它有效，请评价我。

# jsp - 找不到文件“/WEB-INF/displaytag.tld”异常

> ID：10721063
> 
> 赞同：0
> 
> 时间：2012-05-23T13:33:15.767
> 
> 标签：jsp

我正在尝试jstl代码。这是来自 web.xml 的代码

```
<jsp-config>
<taglib>
    <taglib-uri >http://displaytag.sf.net</taglib-uri>
    <taglib-location>WEB-INF/displaytag.tld</taglib-location> 
</taglib>
</jsp-config> 
```

在我的 jsp 文件中，我写了以下行：

```
<%@ taglib uri="http://displaytag.sf.net" prefix="display" %> 
```

我对jstl一无所知。我在网上搜索 jstl 示例时得到了这个代码。根据网上的注释，这个代码正在工作。但我得到以下异常：

```
org.apache.jasper.JasperException: File "/WEB-INF/displaytag.tld" not found 
```

完整的堆栈跟踪：

```
org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:51)
    org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:409)
    org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:116)
    org.apache.jasper.compiler.TagLibraryInfoImpl.<init>(TagLibraryInfoImpl.java:160)
    org.apache.jasper.compiler.Parser.parseTaglibDirective(Parser.java:424)
    org.apache.jasper.compiler.Parser.parseDirective(Parser.java:493)
    org.apache.jasper.compiler.Parser.parseElements(Parser.java:1557)
    org.apache.jasper.compiler.Parser.parse(Parser.java:127)
    org.apache.jasper.compiler.ParserController.doParse(ParserController.java:212)
    org.apache.jasper.compiler.ParserController.parse(ParserController.java:101)
    org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:156)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:296)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:277)
    org.apache.jasper.compiler.Compiler.compile(Compiler.java:265)
    org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:564)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:302)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:329)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:265)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:803) 
```

我还包含了 jstl.jar 和 standard.jar 文件。这段代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T13:42:46.010

这与 JSTL**无关。**要了解 JSTL 究竟是什么，请查看[我们的 JSTL wiki 页面](https://stackoverflow.com/tags/jstl/info)。

Displaytag 不是 JSTL 的一部分。Displaytag 是一个完全独立的标签库，需要从[http://displaytag.sf.net](http://displaytag.sf.net)[下载](http://www.displaytag.org/1.2/download.html)。同一个站点还包含[安装说明](http://www.displaytag.org/1.2/install.html)。

# kentico - 自定义转换函数抛出错误。

> ID：10721067
> 
> 赞同：0
> 
> 时间：2012-05-23T13:33:30.243
> 
> 标签：kentico

这是我的转换函数调用：

```
<p><%# MyFunctions.getDocumentCategory(Eval("DocumentID"))%></p> 
```

这是功能：

```
public static string getDocumentCategory(int documentID)
{

    string category;

    StringBuilder sb = new StringBuilder();
    // Get document categories 
    var ds = CategoryInfoProvider.GetDocumentCategories(documentID, "CategoryEnabled = 1", null);
    // Check whether exists at least one category
    if (!DataHelper.DataSourceIsEmpty(ds))
    {

        // Loop thru all categories
        foreach (DataRow dr in ds.Tables[0].Rows)
        {
            sb.Append(Convert.ToString(dr["CategoryDisplayName"]) + ",");
        }
    }
    string content = sb.ToString();

    category = content.Split(',')[0];

    return category;
}
} 
```

这是错误：

```
MyFunctions.getDocumentCategory(int) has some invalid arguments. 
```

我尝试了另一种形式的函数，它接受字符串而不是整数，但它会引发相同的错误。我已经验证了`Eval("DocumentID")`单独放置时可以正常工作。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T13:49:18.527

eval 返回一个`object`. 您要么需要将其转换为`int`，要么将函数更改为接受`object`，然后将其转换`object`为`int`.

```
<p><%# MyFunctions.getDocumentCategory( Convert.ToInt32( Eval("DocumentID") ) )%></p> 
```

或者

```
public static string getDocumentCategory(object document)
{
     int documentID = Convert.ToInt32( document );

     etc...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T14:50:06.270

感谢 Doozer 的精彩解释和示例。

第二种方法 - 接受对象并在您的自定义函数中进行转换 - 可能会更好地保持转换代码更清洁。结果是平等的。

Just to add a little bit - you can use Kentico's *ValidationHelper* for conversions, for example:

transformation:

```
<%# MyFunctions.getDocumentCategory(Eval("DocumentID"))%> 
```

code:

```
public static string getDocumentCategory(object docID)
{
   int documentID = ValidationHelper.GetInteger(docID, 0); //0 is the default value
   ... 
```

# iphone - 如何将 xcode 4.1 iPhone 应用程序转换为通用应用程序

> ID：10721077
> 
> 赞同：0
> 
> 时间：2012-05-23T13:34:12.750
> 
> 标签：iphone, objective-c, ios, xcode4, ipad-2

我最近在 Xcode 4.1 版的 iPhone 上开发了一个应用程序。

现在我还需要将此应用程序转换为 iPad。

我已经验证了这么多链接，但都是关于 Xcode 3 及其扩展的。

如何升级，如何调整视图大小等请帮助我。提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T13:57:38.080

好的，首先打开你的项目，点击项目图标，然后选择Targets下面的图标。从右侧选择摘要，然后将设备从 iPhone 更改为通用（在 iOS 应用程序目标下）。现在您的应用程序已准备好用于 iPad。现在要修改视图，如果您不使用 XIB 文件，请转到您的视图控制器 viewDidLoad / loadView 方法并编写以下代码：

```
if(UI_USER_INTERFACE_IDIOM())
{
   // re-size your views here
} 
```

如果您使用的是 XIB 文件，请转到您的 viewcontrollers XIB 文件，选择视图（即视图窗口、标签、按钮等）并从实用程序中选择 Show Size Inspector。现在您可以在 origins 和 height-width 菜单下看到 Autosizing 面板。选择框内的箭头设置 autoResizeMask 以在 iPad 中获得所需的大小，然后选择框外的箭头以设置 iPad 中的位置。就是这样，希望这对你有帮助:) 干杯！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T11:59:52.633

感谢大家帮助我。事实证明，本教程解释了我需要什么。

[http://www.youtube.com/watch?v=RY-btZ-KjX0](http://www.youtube.com/watch?v=RY-btZ-KjX0)

它可能对其他人有帮助。

# python - 在另一个字典中排序一个字典

> ID：10721083
> 
> 赞同：0
> 
> 时间：2012-05-23T13:34:47.993
> 
> 标签：python

我想按分数对字典进行排序。如果分数相同，则按名称对其进行排序

```
{ 
'sudha'  : {score : 75} 
'Amruta' : {score : 95} 
'Ramesh' : {score : 56} 
'Shashi' : {score : 78} 
'Manoj'  : {score : 69} 
'Resham'  : {score : 95} 
} 
```

帮助请谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T13:36:36.040

我认为这应该工作......

```
sorted(yourdict,key=lambda x:(yourdict[x]['score'],x)) 
```

它通过比较元组（分数，名称）来工作。元组比较查看第一项——如果它们相同，则查看第二项，依此类推。所以，(55,'jack') > (54,'lemon) 和 (55,'j') < (55,'k')。

当然，这`yourdict`会按所需的顺序返回 的键——因为字典没有顺序的概念，所以实际上无法对字典进行排序。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-23T13:36:47.493

```
d = { 
'sudha'  : {'score' : 75},
'Amruta' : {'score' : 95},
'Ramesh' : {'score' : 56}, 
'Shashi' : {'score' : 78}, 
'Manoj'  : {'score' : 69}, 
'Resham'  : {'score' : 95}, 
} 

sorted(d, key=lambda x: (d[x]['score'], x)) 
```

返回：

```
['Ramesh', 'Manoj', 'sudha', 'Shashi', 'Amruta', 'Resham'] 
```

# java - Joda Time - 获取一年中的所有时间

> ID：10721084
> 
> 赞同：6
> 
> 时间：2012-05-23T13:34:49.740
> 
> 标签：java, jodatime, date-arithmetic

有没有办法让一年中的所有星期加上每周的开始和结束日期？（与[乔达时间](http://www.joda.org/joda-time/)）

像这样（2012）：

周：21 开始：21.05.2012 结束：27.05.12

谢谢你的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T13:51:00.770

试试这个：

```
SimpleDateFormat df = new SimpleDateFormat("dd.MM.yyyy"); 
Period weekPeriod = new Period().withWeeks(1);
DateTime startDate = new DateTime(2012, 1, 1, 0, 0, 0, 0 );
DateTime endDate = new DateTime(2013, 1, 1, 0, 0, 0, 0 );
Interval i = new Interval(startDate, weekPeriod );
while(i.getEnd().isBefore( endDate)) {
    System.out.println( "week : " + i.getStart().getWeekOfWeekyear()
            + " start: " + df.format( i.getStart().toDate() )
            + " ending: " + df.format( i.getEnd().minusMillis(1).toDate()));
    i = new Interval(i.getStart().plus(weekPeriod), weekPeriod);
} 
```

请注意，周数从 52 开始，然后从 1 到 51，因为 1 月 1 日不是星期日。

相反，如果您想查看每个周一至周日的日期：

```
SimpleDateFormat df = new SimpleDateFormat("dd.MM.yyyy"); 
Period weekPeriod = new Period().withWeeks(1);
DateTime startDate = new DateTime(2012, 1, 1, 0, 0, 0, 0 );
while(startDate.getDayOfWeek() != DateTimeConstants.MONDAY) {
    startDate = startDate.plusDays(1);
}

DateTime endDate = new DateTime(2013, 1, 1, 0, 0, 0, 0);
Interval i = new Interval(startDate, weekPeriod);
while(i.getStart().isBefore(endDate)) {
    System.out.println("week : " + i.getStart().getWeekOfWeekyear()
            + " start: " + df.format(i.getStart().toDate())
            + " ending: " + df.format(i.getEnd().minusMillis(1).toDate()));
    i = new Interval(i.getStart().plus(weekPeriod), weekPeriod);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-07-10T04:03:46.323

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T13:41:19.630

从未使用过乔达时间。我会做这样的事情：

1.  创建一个具有周数和两个日期时间（开始、结束）的类
2.  创建此类的列表
3.  迭代一年（每周一周）并将当前周保存在列表中

这就是我使用标准 java 日历 api 执行此操作的方式。可能 Joda Time 更容易一些，我不知道。

# windows - 网络摄像头，视频源对话框出现

> ID：10721085
> 
> 赞同：1
> 
> 时间：2012-05-23T13:34:53.547
> 
> 标签：windows, winforms, video, camera, webcam

所以已经看到很多人有同样的问题但没有答案。我的 SendMessage 在带有一个摄像头的 Windows 7 笔记本电脑上弹出“视频源”对话框。我已安装 Cyber​​ Link YouCam。 ![“视频源”对话框](../Images/b2a2da2ee36ac5085fc88f1304ee0af3.png)

如果我卸载 Cyber​​ Link YouCam，“视频源”对话框就会消失。似乎操作系统的行为就好像 YouCam 是同一设备的第二个驱动程序。我的问题是如何阻止“视频源”对话框出现？一旦我在对话框中选择了一个选项，我就没有得到对话框（直到我重新启动应用程序），所以必须在某处设置一个设置。

虽然调试发现这段代码（见下面的整个部分）似乎是调用对话框的那个 - SendMessage (deviceHandle, WM_CAP_CONNECT, deviceno, ((IntPtr) 0).ToInt32 ())

```
 public void StartWebCam (int height, int width, int handleofthepicturebox, int deviceno)
        {

        string deviceIndex = "" + deviceno;

        deviceHandle = capCreateCaptureWindowA (ref deviceIndex, WS_VISIBLE | WS_CHILD, 0, 0, width, height, handleofthepicturebox, 0);

        if (SendMessage (deviceHandle, WM_CAP_CONNECT, deviceno, ((IntPtr) 0).ToInt32 ()) > 0)
            {

            SendMessage (deviceHandle, WM_CAP_SET_SCALE, -1, 0);
            SendMessage (deviceHandle, WM_CAP_SET_PREVIEWRATE, 0x42, 0);
            SendMessage (deviceHandle, WM_CAP_SET_PREVIEW, -1, 0);

            }
        else
            {
            // nothing failed maybe some clean up needed
            }

        } 
```

所以问题又是 - 我如何阻止“视频源”对话框出现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T13:55:07.250

我开发了一个表单来在 Windows XP 上使用 avicap32 显示两个实时捕获。我在我的案例中找到的修复有可能也适用于你的。

在 avicap 的情况下，可以以编程方式管理您的网络摄像头，所有这些都是基于注册表的。这是我发现[的线索](http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/c4fd12d8-2870-47ed-8f2e-3dc613afeb6f/)，可以指导我并实现我想要的。

在此线程中，`HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\MediaResources\msvideo\MSVideo.VFWWDM\DevicePath`突出显示了注册表项的作用，以选择活动的网络摄像头。

这可能是一条有用的信息：我必须将值设置为小写以避免弹出视频源对话框。

`SendMessage`我通过在调用with之前和之后监视注册表项来确定它`WM_CAP_CONNECT`。

据我所知（和谷歌搜索），没有其他人提供修复，所以即使我可能回答得有点晚，如果你能告诉我们它是否也对你有用，那就太好了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-02T22:12:27.293

最后我找到了解决方案。
问题发生在 Windows 7 / 8

首先你需要这个API函数

```
Private Declare Function GetTickCount Lib "kernel32" () As Long 
```

然后......在你打电话后`capCreateCaptureWindowA()`你必须等待1秒处理事件，（注意：睡眠不一样）

```
IniTime = GetTickCount()
While GetTickCount() < (IniTime + 1000)
   DoEvents
Wend 
```

然后你打电话`WM_CAP_DRIVER_CONNECT`（也许几次）......就是这样......没有更多的视频源对话框

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-12T02:00:06.637

使用此解决方案，它可以完美运行。`GetTickCount()`等待事件与调用函数一起工作，直到它返回 true 。

```
Private Sub PreviewVideo(ByVal pbCtrl As PictureBox)    
    hWnd = capCreateCaptureWindowA(VideoSource, WS_VISIBLE Or WS_CHILD, 0, 0, 0,
   0, pbCtrl.Handle.ToInt64, 0)    
    Dim IniTime As Long = GetTickCount() 
    While GetTickCount() < (IniTime + 1000)
        Application.DoEvents()
    End While    
    Dim OKAnswer As Boolean = False
    For xretries As Integer = 1 To 10
          ' I'll give you Only 10 tries to connect, otherwise I AM LEAVING MICROSOFT!
          OKAnswer = SendMessage(hWnd, WM_CAP_DRIVER_CONNECT, VideoSource, 0)
          If OKAnswer Then
              Exit For
          End If    
    Next    
    If okanswer Then
          SendMessage(hWnd, WM_CAP_SET_SCALE, True, 0)
          SendMessage(hWnd, WM_CAP_SET_PREVIEWRATE, 30, 0)
          SendMessage(hWnd, WM_CAP_SET_PREVIEW, True, 0)
          SetWindowPos(hWnd, HWND_BOTTOM, 0, 0, pbCtrl.Width, pbCtrl.Height, SWP_NOMOVE Or SWP_NOZORDER)    
    Else
          DestroyWindow(hWnd)    
    End If    
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-17T09:43:52.927

我遇到过同样的问题。一旦不再需要网络摄像头，请确保调用 capDriverDisconnect。请注意，我使用的是 Logitech C110，但我想它也应该适用于您的情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-19T18:53:09.357

来到这里寻找“WM_CAP_DRIVER_CONNECT”和“视频设置”对话框弹出错误的解决方案。

找到解决方案：

是驱动问题。使用 OEM 的驱动程序，因为通用 Microsoft 驱动程序不适用于您的相机。

使用 www.astra32.com 查找 USB 摄像头的设备信息：制造商或型号；然后谷歌搜索正确的驱动程序。

祝你好运！

# c# - 具有预订功能的网站的 ASP.Net 事件日历

> ID：10721088
> 
> 赞同：0
> 
> 时间：2012-05-23T13:34:58.573
> 
> 标签：c#, asp.net-ajax, fullcalendar, webforms

我需要设计一个可以预订不同类型活动的活动日历。假设一个事件将有

创建事件日历.aspx

```
Title: Some Title
Details: Details of the Event
Start Date: 10-June-2012
End Date: 20-June-2012
Start Time: 2PM
End Time:   4PM
Recurring: YES/NO
Block Date: YES/NO
ShowEventOnWebsite: YES/NO
EventVisible: YES/NO
Type Of Event: Activity / Event 
```

基于此，我们的数据库将类似于这些条目以及 EventID。

我需要设计一个屏幕来接受上述详细信息，仅由网站管理员管理，其他页面供公众使用..

1.  在活动页面上显示活动类型事件。
2.  在事件页面上显示事件类型事件。
3.  显示类似于此链接中的一个节目的日历[http://arshaw.com/fullcalendar/](http://arshaw.com/fullcalendar/)
4.  在访客预订中，预订日期应与管理员阻止的日期相同，并且还应预订周六和周日等日期。

只需提及 CreateEventCalender.aspx 由网站管理员管理。

如果有人能指出一个具有类似功能的示例，我将不胜感激。我寻找它，但找不到太多。很少有示例与 ASP.NET MVC 相关，而我需要为 ASP.NET webform 执行此操作

如果有人可以帮助我将以下示例转换为asp.net webform [http://blog.scheduler-net.com/post/2012/04/03/simple-event-calendar-asp-net.aspx ，我也将不胜感激](http://blog.scheduler-net.com/post/2012/04/03/simple-event-calendar-asp-net.aspx)

我不确定这是否使用并支付了控制权。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:25:52.217

您提到的教程是用于在 asp.net webform 中创建事件日历。您能否具体说明将此控件集成到项目中时遇到的问题？关于日阻塞，有一个用于此目的的客户端 API。这是相关的[文档](http://docs.dhtmlx.com/doku.php?id=dhtmlxscheduler%3acollisions#work_hours_limiting)

# linux - 使用命令行工具组合两个音频文件

> ID：10721089
> 
> 赞同：4
> 
> 时间：2012-05-23T13:35:00.597
> 
> 标签：linux, audio, encoding, ffmpeg

我必须将两个（或更多）音频文件（如吉他和鼓轨道）合并到一个文件中。我在 linux CentOS 上运行，我需要一个命令行工具来执行此操作，因为我必须将它作为后台进程的一部分运行，通过自定义 bash 脚本的 crontab 触发。我还需要能够更改声像、音量、修剪和开始时间（即，我希望吉他音轨在鼓音轨后 1.25 毫秒后开始，这样它们就可以彼此同步）。

我的第一选择是 ffmpeg，但我想知道是否有比 ffmpeg 更具体、更可靠且不那么模糊的东西。

谢谢一吨！-k-

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-11-06T02:58:09.540

[Sox](http://sox.sourceforge.net/)是最好的方法。您的命令如下：

```
sox -M guitar.wav drum.wav final.wav 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T22:28:36.820

我不确定 sox 是否可以做到所有这些（尤其是开始时间），但我认为可以：[http ://sox.sourceforge.net/](http://sox.sourceforge.net/)

当然，这将是我的“goto”工具，而不是我自己的。

# java - 删除的 defaultTreeModel 节点仍显示在表中

> ID：10721091
> 
> 赞同：1
> 
> 时间：2012-05-23T13:35:07.070
> 
> 标签：java, swing, jtree, treemodel

我正在尝试从`DefaultTreeModel`. 如果我尝试删除单个节点，它不会从 GUI 中删除。如果我删除 2 个节点，则只有其中 1 个被删除，等等。

我正在使用`removeNodeFromParent(node);`删除节点。

有人可以帮我解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T13:49:23.193

听起来您的树没有检测到`nodesWereRemoved`应该由该`removeNodeFromParent(node);`方法触发的事件。

您是否使用标准`DefaultTreeModel`和`JTree`对象？如果是这样，它们应该在删除时自动刷新。如果您编写了任一类的自定义，则您可能没有处理`nodesWereRemoved`事件（在您的 custom 中`JTree`），或者您没有触发事件（在您的 custom 中`DefaultTreeModel`）。

如果您使用的是标准对象，请尝试在删除节点后调用`JTree.revalidate();`并`JTree.repaint();`强制从模型更改中重新绘制树。

最后的建议，您是否尝试过任何`removeXXX()`方法`JTree`？

# ios - 使用不带地图的 MKMapView，仅覆盖

> ID：10721092
> 
> 赞同：0
> 
> 时间：2012-05-23T13:35:08.477
> 
> 标签：ios, cocoa-touch, google-maps, mkmapview, mapkit

我需要带有自定义叠加层且不显示/加载地图本身的地图。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T01:56:51.103

我想这已经被问过几次了。这是我见过的最佳答案：[MkMapView cancel loading google tiles](https://stackoverflow.com/questions/5317712/mkmapview-cancel-loading-google-tiles/10702022#10702022)

# zend-framework - 存储和设置请求

> ID：10721094
> 
> 赞同：0
> 
> 时间：2012-05-23T13:35:13.653
> 
> 标签：zend-framework

我在 ZF 有一个工作机制。jobque simlpy 存储函数调用（类、方法和参数），然后将其作为 CLI 守护程序执行。守护进程工作，但是应用程序在某些地方从请求对象中查找信息，当从 CLI 调用这些地方时，这些地方会失败，或者没有得到任何信息。

我想将原始请求对象与作业一起存储，并且在处理作业时将请求对象设置回来，就好像作业是由原始请求完成的一样，类似于以下伪代码的行：

```
$ser_request = serialize(Zend_Controller_Front::getInstance ()->getRequest ());
-->save to db

-->retrive from db
$ZCF= new Zend_Controller_Front;
$ZCF::getInstance ()->setRequest (unserialize($ser_request)) 
```

目的是稍后存储和重播作业，而无需更改应用程序的其余部分。

任何建议如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T19:52:22.887

我不确定这是否有效，但这是一个想法。尝试实现[_ *sleep*](http://www.php.net/manual/en/language.oop5.magic.php#object.sleep)*和*[_wakeup](http://www.php.net/manual/en/language.oop5.magic.php#object.wakeup)请求对象的魔术方法。还没有尝试过，但也许它至少是一个开始的解决方案。

# netbeans - 我可以将 CVS 差异的副本复制到我的本地驱动器吗？

> ID：10721095
> 
> 赞同：1
> 
> 时间：2012-05-23T13:35:14.683
> 
> 标签：netbeans, project, cvs, vcs-checkout

我无法在家中访问 CVS 帐户，但我想签出 cvs 存储库并将其带回家，从而能够在家中查看 NetBeans 中的每一个差异。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T13:40:28.253

没有命令可以让您“签出”包括所有历史信息在内的整个存储库，但如果您（或您的代理）有权访问服务器，则*可以简单地复制文件。*CVS 存储库只是一个充满文件的目录，如果您制作该目录的完整副本，它的行为与原始目录完全相同，可用于根据需要创建差异和更改日志。

# php - Valums jquery上传器工作但返回“失败”

> ID：10721101
> 
> 赞同：2
> 
> 时间：2012-05-23T13:35:36.137
> 
> 标签：php, jquery, file-upload, upload, mkdir

我试图设置一个包含多个文件上传器部分的页面，
到目前为止它工作正常，但我遇到了一个小问题：

每次使用该页面上的上传程序时，我都希望为文件创建一个新文件夹。

所以我`mkdir`在 php.php 中添加了一个命令，该命令用于处理上传过程。

使用`mkdir`php.php 中的内容，创建文件夹并上传文件，因此程序正常工作......
**但**我在传输列表上的每个文件名旁边收到一条“失败”消息。

没有那个，整个事情都很好`mkdir`。

我应该从哪里开始寻找？有任何想法吗？

这是代码

```
 <script>        
    function createUploader<?php  echo $c; ?>(){            
        var uploader = new qq.FileUploader({
            element: document.getElementById('uploadroom<?php  echo $c; ?>'),
            action: '../common/jqueryplugins/valums/server/php.php',
            debug: true,
    // ex. ['jpg', 'jpeg', 'png', 'gif'] or []
    allowedExtensions: ['jpg', 'jpeg', 'png', 'gif'],
    dragDrop: false,
    params: {
            planid: '<?php  echo $_SESSION['planid']; ?>',
            roomname: 'room<?php  echo $c;   ?>'
        }
        });           
    }

  $(document).ready(function(){createUploader<?php  echo $c; ?>();  });
                </script> 
```

我从 php 获得了一些变量，因为这部分被复制了很多次，不同的按钮上传到不同的文件夹。

在 php.php 文件中（在顶部）我得到了这样的东西：
`$uploaddir = '../../../../rental/userfiles/1/'.$_GET['planid'].'/images/'.$_GET['roomname'].'/';`

`mkdir($uploaddir);`

一个奇怪的 uploaddir 和我的 mkdir 命令
，最后：

```
 `$result = $uploader->handleUpload($uploaddir);` 
```

这些主要是我改变的东西
，我在文件名旁边得到一个“失败”，尽管它工作得很好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-11T20:10:33.960

如果您没有加载提供的 CSS，它将显示失败。默认情况下，跨度是隐藏的。

# svn - 使用 svnant 在类路径上缺少 svnkit 依赖项

> ID：10721104
> 
> 赞同：5
> 
> 时间：2012-05-23T13:35:42.997
> 
> 标签：svn, ant, svnkit, svnant

我正在尝试`svnkit`与`svnant`.

这是我的构建文件：

```
<path id="svnant.classpath">
    <pathelement location="${env.ANT}/../lib/svnant.jar"/>
    <pathelement location="${env.ANT}/../lib/svnClientAdapter.jar"/>
    <pathelement location="${env.ANT}/../lib/svnkit.jar"/>
    <pathelement location="${env.ANT}/../lib/ganymed.jar"/>
</path>

    <typedef resource="org/tigris/subversion/svnant/svnantlib.xml" classpathref="svnant.classpath" /> 

    <svnSetting
        svnkit="true"
        javahl="false"
        id="svn.settings"/>

    <target 
        name="svnTest">
        <svn refid="svn.settings">
            <wcversion
                path="${basedir}\..\"
                prefix="svn."
            />

            <info 
                target="${basedir}\..\"
                propPrefix="svn.info."/>
        </svn>
    </target> 
```

运行此构建文件时，我收到以下错误。`svnkit.jar`并且`ganymed.jar`在我的 ant/lib 目录中，我在类路径中包含的其他内容也是如此。我究竟做错了什么？

```
svnTest:
      [svn] Missing 'svnkit' dependencies on the classpath !

BUILD FAILED
build.xml:53: Cannot find javahl, svnkit nor command line svn client 
```

* * *

详细错误：

```
repoCheckDev:
      [svn] Missing 'svnkit' dependencies on the classpath !

BUILD FAILED
build.xml:line#: Cannot find javahl, svnkit nor command line svn client
        at org.tigris.subversion.svnant.SvnFacade.getClientAdapter(Unknown Source)
        at org.tigris.subversion.svnant.SvnTask.executeImpl(Unknown Source)
        at org.tigris.subversion.svnant.SvnTask.execute(Unknown Source)
        at org.apache.tools.ant.UnknownElement.execute(UnknownElement.java:291)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.tools.ant.dispatch.DispatchUtils.execute(DispatchUtils.java:106)
        at org.apache.tools.ant.Task.perform(Task.java:348)
        at org.apache.tools.ant.Target.execute(Target.java:390)
        at org.apache.tools.ant.Target.performTasks(Target.java:411)
        at org.apache.tools.ant.Project.executeSortedTargets(Project.java:1399)
        at org.apache.tools.ant.Project.executeTarget(Project.java:1368)
        at org.apache.tools.ant.helper.DefaultExecutor.executeTargets(DefaultExecutor.java:41)
        at org.apache.tools.ant.Project.executeTargets(Project.java:1251)
        at org.apache.tools.ant.Main.runBuild(Main.java:809)
        at org.apache.tools.ant.Main.startAnt(Main.java:217)
        at org.apache.tools.ant.launch.Launcher.run(Launcher.java:280)
        at org.apache.tools.ant.launch.Launcher.main(Launcher.java:109) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T13:56:00.117

您缺少svnkit 所需的`ganymed.jar`和。`javahl.jar`此信息来自[指南](http://subclipse.tigris.org/svnant/svn.html)：

> svnkit
> 
> svnkit 绑定是纯粹基于 java 的。使用此绑定需要将 jar svnkit.jar 用于 svnant 声明。您还需要为基于 SSH 的通信提供必要功能的 ganymed.jar。

`ganymed.jar`是 svnant 下载的一部分，或者可以在[这里下载](http://www.ganymed.ethz.ch/ssh2/)

### 通过 classpath 和 taskdef 配置 svnant

这是类路径的正确版本，所有库都在一个 svnlib 文件夹中，该文件夹相对于

```
 <path id="svnant.classpath">
      <pathelement location="svnlib/svnant.jar"/>
      <pathelement location="svnlib/svnClientAdapter.jar"/>
      <pathelement location="svnlib/svnkit.jar"/>
      <pathelement location="svnlib/ganymed.jar"/>
      <pathelement location="svnlib/svnjavahl.jar"/>
  </path> 
```

### ANT_HOME/lib 中的所有库

如果您在 ANT_HOME/lib 中有所有所需的库，则可以简单地使用以下内容：

```
<typedef resource="org/tigris/subversion/svnant/svnantlib.xml" /> 
```

# sql - 使用连接将 sql 更改为 hql

> ID：10721105
> 
> 赞同：0
> 
> 时间：2012-05-23T13:35:54.370
> 
> 标签：sql, hibernate, hql

我的 hql 查询似乎有什么问题？

```
String queryString = "SELECT A.INITIAL, A.NUMBER, A.OWNR_SCAC , A.INITIAL||A.NUMBER AS CAR," + 
            "A.LESSEE_SCAC, A.TRUK_CNT, A.EQP_TYP_CD, A.AXL_CNT, B.STABILITY_DEV_EQP," +
            "A.C_CNT, A.G_WGT, B.TRUK_AXL_CNT, A.EIN FROM DS.E_UT AS A" +
            "LEFT JOIN DS.E_PRIMARY AS B" +
            "WHERE A.INITIAL||A.NUMBER IN (:carList) AND A.INITIAL IN {:initList) AND A.NUMBER IN (:numberList)" + 
            "AND B.TRUK_AXL_CNT > 0"; 
```

错误：

org.hibernate.hql.internal.ast.QuerySyntaxException：意外令牌：靠近第 1 行，第 263 列

我想它是在谈论`A`之后`FROM DS.E_UT AS A`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T13:41:52.743

在 HQL 中，您**不**提供表名和列名。相反，您提供映射到表和列的类和成员变量的 Java 类名称和成员变量名称（或 getter/setter）名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T13:44:51.137

我认为你应该在每一行添加一些空格。

```
"A.C_CNT, A.G_WGT, B.TRUK_AXL_CNT, A.EIN FROM DS.E_UT AS A" +
"LEFT JOIN DS.E_PRIMARY AS B" 
```

会成为：

```
A.C_CNT, A.G_WGT, B.TRUK_AXL_CNT, A.EIN FROM DS.E_UT AS ALEFT JOIN DS.E_PRIMARY AS B 
```

注意'ALEFT'

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T13:50:28.667

我不完全确定您的架构，或者这是否是您正在寻找的，但您可以将连接的表映射在一起。这可以使事情变得更容易一些，并且您不需要显式地加入您的查询。

[这是一个小例子](http://tadtech.blogspot.com/2007/02/hibernate-annotation-many-to-oneforeign.html)

该示例中的示例查询可能类似于：

```
SELECT p 
    FROM Person 
WHERE p.name like :name 
AND p.address.street like :street 
```

# qt - 让`QWebView`在鼠标滚轮上水平滚动

> ID：10721118
> 
> 赞同：2
> 
> 时间：2012-05-23T13:36:14.283
> 
> 标签：qt, qwebview

在鼠标滚轮事件上让`QWebView`水平滚动而不是垂直滚动的最简单方法是什么。我可以想到以下替代方案，但也许有一些更简单的方法：

1.  子类 QWebView 并重新实现`QWebView::wheelEvent()`
2.  在显示的页面上加载一些 javascript 来进行转换

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-09-03T12:58:54.483

另一种方法是发送一个带有水平方向的伪造车轮事件。

```
void HScrollWebView::wheelEvent(QWheelEvent *ev)
{
  QWheelEvent weHorizontal( ev->pos(), ev->delta(), ev->buttons(), ev->modifiers(), 
                            Qt::Horizontal );
  QWebView::wheelEvent( &weHorizontal );
} 
```

此版本也适用于复杂的网页。例如，带有可滚动子部分的网页不会通过调用滚动正确的区域

```
page()->currentFrame()->scroll(ev->delta(), 0); 
```

如果 currentFrame() 指向错误的帧（例如大型机）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T12:20:40.940

在我的问题中，我高估了选项 1\. 的复杂性。我现在已经实现了，像这样（省略构造函数）：

```
class HScrollWebView : public QWebView
{
     Q_OBJECT
public:
     explicit HScrollWebView(QWidget *parent = 0);
protected:
     virtual void wheelEvent(QWheelEvent *ev);
};

void HScrollWebView::wheelEvent(QWheelEvent *ev){
     page()->currentFrame()->scroll(ev->delta(), 0);
} 
```

# c# - 在电子邮件正文中发送 RTF 文件

> ID：10721120
> 
> 赞同：2
> 
> 时间：2012-05-23T13:36:22.333
> 
> 标签：c#, vb.net, c#-4.0

我的应用程序将报告生成为 rtf 文件。我想通过电子邮件发送这个文件，但不是作为附件，而是在电子邮件正文中。接收者必须看到格式化的文本。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:54:52.013

您可以将您的 RTF 转换为 HTML，然后将其作为 HTML 邮件发送。试试这个：

[http://www.codeproject.com/Articles/27431/Writing-Your-Own-RTF-Converter](http://www.codeproject.com/Articles/27431/Writing-Your-Own-RTF-Converter)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:14:38.503

让我们在这里下订单，电子邮件正文仅适用于标准文本。

为了发送 HTML，只需像创建 html 页面一样从标签构造电子邮件内容，大多数电子邮件客户端（尤其是基于 Web 的）将能够将其作为 HTML 显示给读者，因为它们遵循标签并格式化页面.

关于 RTF - 它是非常非标准的，并且在处理电子邮件的微软产品中大多受支持，他们会在正文中放置一些预标头以将其标记为 RTF 对象。

# c# - 从 ASP.NET 中的 C# 代码隐藏调用 Javascript（Raphael.js 库）

> ID：10721121
> 
> 赞同：0
> 
> 时间：2012-05-23T13:36:23.700
> 
> 标签：c#, javascript, asp.net, raphael, code-behind

我试图从 C# 后面的代码中调用一些函数。我正在寻找如何做到这一点，并且能够在我想要的时候调用一个警报来显示。但是，我不知道如何称呼其他东西！

这是我需要从后面的代码中调用的：

```
var paper = Raphael("paper1", 800, 800);
var Plan = paper.path("M100, 100 a 50, 50 0 0,1 50, 50 l -50 0 l 0, -50");
Plan.attr({ fill: "#FF6600" }); 
```

我已经在纯 HTML 文件上尝试过这些，但我无法使用它。我也在使用母版页，我发现的大多数示例都没有母版页，所以我对此很迷茫。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T13:42:38.790

Javascript 只能在客户端调用。如果您绝对需要从服务器端调用它，您可以使用 asp:HiddenField 的值作为您需要在返回时执行 javascript 代码时的标志，然后在满足要求时运行所需的 javascript。

但这不是一个好的解决方案，您可能应该尝试将服务器和客户端分开。

无论如何，希望这会有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T13:44:48.113

在 .aspx 页面中创建一个 Javascript 函数，然后从后面的代码中调用该函数，如下所示：

html代码中的函数

```
function dostuff()
{
  // code here
}

C# code in code behind
 protected void callmethod()
    {
        StringBuilder oSB = new StringBuilder();
         Type cstype = this.GetType();

        try
        {
            oSB.Append("<script language=javaScript>");
            oSB.Append("dostuff();");
            oSB.Append("</script>");
            Page.ClientScript.RegisterClientScriptBlock(cstype, Guid.NewGuid().ToString(), oSB.ToString(), false);
        }
        catch (Exception ex)
        {
            throw ex;
        }
        finally
        {
            oSB = null;
        }
    } 
```

# arrays - 在数组上使用“包含”

> ID：10721126
> 
> 赞同：5
> 
> 时间：2012-05-23T13:36:32.827
> 
> 标签：arrays, vb6

好的，所以我对 VB6 不是很熟悉，但我想看看一个数组是否包含一个值。这就是我所拥有的，但它向我抛出了一个错误。可能是“passedValue”类型错误的问题，但我不这么认为。

```
 Dim transCodes As Variant
    transCodes = Array(40, 41, 42, 43)
    If (transCodes.Contains("passedValue")) Then
    *Do Stuff*
    End If 
```

任何帮助将非常感激！

**更新**

未能更正我的语法，你能给我一个我可能用来确保“passedValue”是正确类型的转换/转换的例子吗？

**更新我的更新**

那么VB6中没有“包含”方法吗？还有其他方法可以完成这个简单的任务吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-23T13:53:10.713

`Contains`VB6在数组上没有本地方法。

您最好的选择是遍历数组依次检查每个项目：

```
Found = False
For Index = LBound(transCodes) To UBound(transCodes )
  If transCodes(Index) = PassedValue Then
    Found = True
    Exit For
  End If
Next

If Found Then
  'Do stuff
  'Index will contain the location it was found
End If 
```

替代方法包括使用集合并尝试根据它们的值检索项目，但对于这个简单的案例来说，这是更多的工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-10-25T11:51:31.613

如果您只想在一行中使用它，您可以使用以下代码检查字符串数组是否包含一个项目（没有循环）：

```
' ARR is an array of string, SEARCH is the value to be searched
Found = InStr(1, vbNullChar & Join(arr, vbNullChar) & vbNullChar, _
vbNullChar & search & vbNullChar) > 0 
```

这取自[Devx 提示](http://www.devx.com/vb2themax/Tip/18364)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-23T15:29:47.633

最后基于@Mostafa Anssary

我使用了这个功能

```
 Function instrSplit(ByVal searchEstado As String, ByVal arrayEstados As String)

       instrSplit = 0

       instrSplit = InStr(1, " " & Join(Split(arrayEstados, ","), " ") & " ", _
                " " & searchEstado & " ")

    End Function 
```

我打电话来

```
found = instrSplit(mySearchValue, arrayValues) 
```

例如

```
arrayValues = "8, 64, 72, 1520"
mySearchValue  = "8"

found = instrSplit(mySearchValue, arrayValues) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-02T15:45:08.267

我将 Deanna 的答案包装为 VB6 函数：

```
Public Function StringArrayContains(ByRef arrString() As Boolean, PassedValue) As String
   Dim Found As Boolean
   Found = False
   Dim index  As Integer
    For Index = LBound(arrString) To UBound(arrString)
      If arrString(Index) = PassedValue Then
        Found = True
        Exit For
      End If
    Next
    StringArrayContains = Found
End Function 
```

# python - 如何在 Python 中通过 HTTP 请求发送 XML？

> ID：10721127
> 
> 赞同：0
> 
> 时间：2012-05-23T13:36:32.497
> 
> 标签：python, xml, httprequest

```
import urllib2
request = urllib2.Request("URL HERE", data="<port>0</port>",
                     headers={'Content-Type': 'application/xml'})
u = urllib2.urlopen(request)
response = u.read() 
```

我试过了，但发现 XML 永远不会到达服务器。我需要 XML 在 HTTP 请求执行的同时到达服务器，以便发回正确的响应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T13:53:13.620

也许这就是你要找的东西： [http ://www.voidspace.org.uk/python/articles/urllib2.shtml#data](http://www.voidspace.org.uk/python/articles/urllib2.shtml#data)

# c++ - 在默认模板参数中调用 constexpr

> ID：10721130
> 
> 赞同：12
> 
> 时间：2012-05-23T13:36:39.550
> 
> 标签：c++, gcc, c++11, clang, constexpr

在 C++11 中，我使用 constexpr 函数作为模板参数的默认值 - 它看起来像这样：

```
template <int value>
struct bar
{
    static constexpr int get()
    {
        return value;
    }
};

template <typename A, int value = A::get()>
struct foo
{
};

int main()
{
    typedef foo<bar<0>> type;

    return 0;
} 
```

G++ 4.5 和 4.7 编译了这个，但 Clang++ 3.1 没有。来自 clang 的错误消息是：

```
clang_test.cpp:10:35: error: non-type template argument is not a constant expression
template <typename A, int value = A::get()>
                                  ^~~~~~~~
clang_test.cpp:17:19: note: while checking a default template argument used here
        typedef foo<bar<3>> type;
                ~~~~~~~~~^~
clang_test.cpp:10:35: note: undefined function 'get' cannot be used in a constant expression
template <typename A, int value = A::get()>
                                  ^
clang_test.cpp:4:23: note: declared here
        static constexpr int get()
                             ^
1 error generated. 
```

**哪一个是正确的？**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-23T20:56:55.517

LLVM IRC 频道的 Richard Smith (zygoloid) 与我就这个问题进行了简短的交谈，这是你的答案

```
<litb> hello folks
<litb> zygoloid, what should happen in this case?
<litb> http://stackoverflow.com/questions/10721130/calling-constexpr-in-default-template-argument
<litb> it seems to be clang's behavior is surprising
<litb> zygoloid, i cannot apply the "point of instantiation" rule to constexpr 
  function templates. if i call such a function template, the called definition's 
  POI often is *after* the specialization reference, which means at the point of 
  the call, the constexpr function template specialization is "undefined".
<zygoloid> it's a horrible mess. Clang does not do what the standard intends, but 
  as you note, the actual spec is gloriously unclear
<d0k> :(
<zygoloid> we should instantiate bar<3>::get(), because it is odr-used, but we 
  don't, because we incorrectly believe it's used in an unevaluated context
<zygoloid> conversely, the point of instantiation is too late :/
<zygoloid> PR11851 
```

因此，似乎有时，Clang 实例化称为函数模板或类模板的成员函数，但它们的实例化为时已晚，调用无法看到，而在其他情况下，它甚至不实例化它们，因为它认为它永远不需要它们（未评估语境）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T13:51:49.963

我认为 GCC ~~Clang~~是正确的

引自 n3290：

> 14.3.2 模板非类型参数 [temp.arg.nontype]
> 
> 1.  非类型、非模板模板参数的模板参数应为以下之一：
>     *   对于整数或枚举类型的非类型模板参数，模板参数类型的转换 > 常量表达式（5.19）；或者
>     *   ...

编辑：5.19 3

> 文字常量表达式是文字类型的纯右值核心常量表达式，但不是指针类型。整型常量表达式是整型或无范围枚举类型的字面常量表达式。[ 注意：此类表达式可用作数组边界 (8.3.4, 5.3.4)、位字段长度 (9.6)、如果基础类型不固定 (7.2) 则用作枚举器初始化器、空指针常量 (4.10 )，并作为对齐方式 (7.6.2)。—尾注] T 类型的已转换常量表达式是字面常量表达式，隐式转换为 T 类型，其中隐式转换（如果有）在字面常量表达式中是允许的，并且隐式转换序列仅包含用户定义的转换，左值到右值的转换 (4.1)、整数提升 (4.5) 和除缩小转换 (8.5.4) 之外的整数转换 (4.7)。
> 
> [注意：此类表达式可以用作 case 表达式 (6.4.2)，如果基础类型是固定的 (7.2)，则可以用作枚举器初始化器，以及用作整数或枚举非类型模板参数 (14.3)。——尾注]

# sql - SQL如何让一个作业运行一个作业？

> ID：10721134
> 
> 赞同：9
> 
> 时间：2012-05-23T13:36:47.553
> 
> 标签：sql, jobs

我想在第一个作业完成后立即调用另一个作业，或者更准确地说，是否可以通过作业步骤调用整个 sql 作业。我想避免将这些工作合并为 1，所以我想知道这个解决方案是否可行？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T13:40:09.477

是的，您可以使用此存储过程执行作业。在您的情况下，您可以简单地在第一个作业的末尾添加一个步骤，以调用您接下来要执行的作业的名称。

```
EXEC msdb.dbo.sp_start_job N'Job Name'; 
```

有关详细信息，请参阅[sp_start_job (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms186757.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T13:44:45.460

创建一个 T-SQl 步骤并使用`EXEC msdb.dbo.sp_start_job N'YourJob';`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-23T13:40:28.900

从存储过程中按您希望的顺序调用作业。

# android - Android GridView 不完善，如何去掉右边多余的空白

> ID：10721140
> 
> 赞同：6
> 
> 时间：2012-05-23T13:37:22.843
> 
> 标签：android, gridview, selector, margins

我有一个基于 GridView 的日历。`android:listSelector="@null"`根据我从该站点获得的建议，我有以下 XML 布局，其中选择器设置为 null 。现在我在 GridView 的右侧得到了几个像素宽的条带。为什么？我已尽我所能，但无济于事。这是我的 XML 布局：

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="fill_parent"
            android:layout_height="match_parent"
            android:orientation="vertical" >

            <GridView
                android:id="@+id/calendar"
                android:layout_width="fill_parent"
                android:layout_height="match_parent"
                android:horizontalSpacing="-1px"
                android:numColumns="7"
                android:stretchMode="columnWidth" 
                android:gravity="center"
                android:verticalSpacing="-1px"
                android:listSelector="@null" >

            </GridView>

        </LinearLayout> 
```

我得到的是这张照片：

![在此处输入图像描述](../Images/7c1a31f704e64dca1da283367848afc7.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T14:07:28.450

该空间是由于网格每一行的计算不完善造成的。例如，您的设备宽度是 320 像素，并且您有 7 行，尝试任何符合 320 像素的计算。如果每个单元格的宽度为 45.71428571428571 px，则只能缩小。

其他选项

在网格中应用 **android:gravity="center"** 属性，以便空间从左到右均分

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-08-22T18:21:48.183

就我而言，我的水平间距为 1dp

```
android:horizontalSpacing="1dp" 
```

所以要解决这个问题，我只需将正确的填充设置为 -1dp

```
android:paddingRight="-1dp" 
```

即使我希望因此在左侧有一个空间，但它工作正常

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T13:52:33.400

尝试使用

```
android:layout_margin="0dp"
android:padding="0dp" 
```

您也可能为滚动条分配了该空间。
为什么你的垂直和水平间距为负值？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-19T19:45:35.680

我遇到了同样的问题，但在我的情况下，我无法控制`GridView`实例，所以我无法读取列宽。不过，我可以将其容器子类化。
这不是很正统，但您可以覆盖该`onMeasure`方法并添加一些像素。
像这样的东西：

```
@Override
protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
    final int RIGHT_MARGIN_OVERSIZE_DIP = 6;
    super.onMeasure(widthMeasureSpec, heightMeasureSpec);
    int width = this.getMeasuredWidth()
    int overSize = (int)((getResources().getDisplayMetrics().density*RIGHT_MARGIN_OVERSIZE_DIP) + 0.5f);
    widthMeasureSpec = MeasureSpec.makeMeasureSpec(width + overSize, MeasureSpec.getMode(widthMeasureSpec));        
    super.onMeasure(widthMeasureSpec, heightMeasureSpec);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-01T13:37:41.963

```
grid.setColumnWidth(grid.getColumnWidth()+1); 
```

这将获得当前的 ColumnWidth 并向其添加 1 个像素。记得在 onCreateView 之后使用它，因为在此之前需要初始化网格。

此外，您的网格视图应使用 match_parent（高度和宽度）。列中的图像/布局也应为 match_parent。

# python - 我们可以使用 django 中 /admin 的登录页面供我们自己使用吗？

> ID：10721143
> 
> 赞同：9
> 
> 时间：2012-05-23T13:37:28.680
> 
> 标签：python, django, django-login

我可以使用以下网址提供的登录页面：`/admin`供编外用户登录吗？我在我的 django 设置文件中使用以下设置：

```
LOGIN_URL = '/admin/'
LOGIN_REDIRECT_URL = '/' 
```

当我登录时，它不会将我重定向到根文件夹。我做对了吗？

注意：我`@login_required`在我的视图上使用装饰器。

**编辑**

它使用以下 URL 将我登录到管理站点：`http://127.0.0.1:8000/admin/?next=/`

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-23T14:00:16.530

非员工成员无法通过管理员视图登录，因此您不能。

有一个 Django 视图可以满足您的需要，但是：`django.contrib.auth.views.login`

您可以轻松地将其添加到您的`urlconf`：

```
from django.contrib.auth.views import login

urlpatterns = ('',
    #snip
    url(r'^login/$', login)
) 
```

查看文档以了解如何自定义其行为：[https ://docs.djangoproject.com/en/dev/topics/auth/#limiting-access-to-logged-in-users](https://docs.djangoproject.com/en/dev/topics/auth/#limiting-access-to-logged-in-users)

您只需要为要使用的视图定义一个模板，默认情况下，它应该位于`registration/login.html`，但可以覆盖。

**更新**

1）对于 django 1.11+ 更好地使用[LoginView](https://docs.djangoproject.com/en/2.0/topics/auth/default/#django.contrib.auth.views.LoginView)（即`from django.contrib.auth.views import LoginView`），因为`login`代码实际上使用 LoginView 并且代码`login`甚至有警告消息：

> ```
> warnings.warn(
>     'The login() view is superseded by the class-based LoginView().',
>     RemovedInDjango21Warning, stacklevel=2
> ) 
> ```

2) 您可能想要更改管理员登录页面的默认标题。这可以通过`site_header`在上下文中提供来完成。

所以更新的版本看起来像这样：

```
from django.contrib.auth.views import LoginView

urlpatterns = [
   # your patterns here,
    url(r'^login/$',
        LoginView.as_view(
            template_name='admin/login.html',
            extra_context={
                'site_header': 'My custom header',
            })),
] 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-06-04T13:30:49.580

使用 Django 1.6，我可以使用 django 自己的管理员登录模板和以下设置。然后当我打开“/”时，它会将我重定向到登录屏幕，登录后它会将我发送回“/”

**设置.py**

```
INSTALLED_APPS = (
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'core',
    'south',
)

LOGIN_URL = '/login' 
```

**网址.py**

```
from django.conf.urls import patterns, include, url
from django.contrib import admin
from django.contrib.auth.views import login

admin.autodiscover()
urlpatterns = patterns(
    '',
    url(r'^', include('core.urls')),
    url(r'^admin/', include(admin.site.urls)),
    url(r'^login/$', login, {'template_name': 'admin/login.html'})
    # I didn't create this 'admin/login.html' template
    # Django will use the one from the admin application ;-)
) 
```

**核心/urls.py**

```
from django.conf.urls import patterns, url
urlpatterns = patterns(
    'core.views.web_views',
    url(r'^$', 'home'),
) 
```

**核心/视图/web_views.py**

```
from django.shortcuts import render_to_response
from django.template.context import RequestContext

__author__ = 'tony'

from django.contrib.auth.decorators import login_required

@login_required
def home(request):
    return render_to_response('home.html', {}, context_instance = RequestContext(request)) 
```

# c - 如何实现线程安全队列

> ID：10721148
> 
> 赞同：8
> 
> 时间：2012-05-23T13:37:42.700
> 
> 标签：c, multithreading, pthreads, queue, posix

我之前在 Python 中使用过多线程库，但这是我第一次尝试在 C 中使用线程。我想创建工作池。反过来，这些工作人员应该推送到队列或从队列中弹出。下面的代码还没有，但是我到目前为止所做的就是：

```
#include <stdio.h>
#include <stdlib.h>
#include <pthread.h>
#define NUMTHREADS 20 /* number of threads to create */

typedef struct node node;
typedef struct queue queue;

struct node {
    char *name;
    node *next;
};

struct queue {
    node *head;
    node *tail;
};

/* pop: remove and return first name from a queue */
char *pop(queue *q)
{
    if (q->head == NULL)
        return NULL;
    char *name = q->head->name;
    node *tmp = q->head;
    q->head = q->head->next;
    free(tmp);
    return name;
}

/* push: add name to the end of the queue */
int push(queue *q, char *name)
{
    node *new = malloc(sizeof(node));
    if (new == NULL)
        return -1;
    new->name = name;
    new->next = NULL;
    if (q->tail != NULL)
        q->tail->next = new;

    q->tail = new;
    if (q->head == NULL) /* first value */
        q->head = new;
    return 0;
}

/* printname: get a name from the queue, and print it. */
void *printname(void *sharedQ)
{
    queue *q = (queue *) sharedQ;
    char *name = pop(q);
    if (name == NULL)
        pthread_exit(NULL);
    printf("%s\n",name);
    pthread_exit(NULL);
}

int main()
{
    size_t i;
    int rc;
    pthread_t threads[NUMTHREADS];
    char *names[] = {
        "yasar",
        "arabaci",
        "osman",
        "ahmet",
        "mehmet",
        "zeliha"
    };

    queue *q = malloc(sizeof(queue));
    q->head = NULL;
    q->tail = NULL;

    /* number of elements in the array */
    size_t numelems = sizeof(names) / sizeof(char *);

    for (i = 0; i < numelems; i++) /* push each name */
        push(q, names[i]);

    for (i = 0; i < NUMTHREADS; i++) { /* fire up threads */
        rc = pthread_create(&threads[i], NULL, printname,
                (void *)q);
        if (rc) {
            printf("Error, return code from pthread is %d\n", rc);
            exit(-1);
        }
    }

    pthread_exit(NULL);
} 
```

我尝试了上面的代码，它总是将每个名称打印一次。它没有跳过任何名称，或两次打印相同的名称。另一方面，我不确定这个队列实现的线程安全性如何。所以我的问题是，这是一个线程安全队列吗？如果不是，为什么不呢？以及如何使其线程安全？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T13:58:39.867

代码不是线程安全的。

push 和 pop 函数不是线程安全的。在代码中，push 只是由单个线程执行的，所以没关系，但是 pop 是由多个线程执行的。

```
1\. char *name = q->head->name;
2\. node *tmp = q->head;
3\. q->head = q->head->next;
4\. free(tmp); 
```

假设线程 A 执行到第 2 行（包括第 2 行）。然后线程 B 执行到第 4 行（包括第 4 行）。线程 A 恢复执行。它发现 q->head 已经被 free()ed 了。

现在，到目前为止，这讨论了逻辑问题。

但是，有一些物理问题需要考虑。

想象一下，我们有一个锁定机制，线程可以同步它们的行为，这样一次只有一个线程可以执行第 1 到第 4 行中的代码，例如互斥锁，它是一个对象，一次只有一个线程可以“持有” ，以及尝试获取互斥锁的位置会阻塞线程，直到持有线程释放。

```
0\. get mutex
1\. char *name = q->head->name;
2\. node *tmp = q->head;
3\. q->head = q->head->next;
4\. free(tmp);
5\. release mutex 
```

我们仍然会遇到一个问题，因为任何给定 CPU 内核（不是线程）执行的写入仅对该内核上的线程立即可见；不要在其他内核上使用线程。

仅仅同步执行是不够的；同时，我们还必须确保一个核心执行的写入对其他核心可见。

（不）幸运的是，所有现代同步方法也执行此写入刷新（例如，当您获得互斥体时，您还将所有写入刷新到内存）。我说不幸的是，因为您并不总是需要这种行为，而且它对性能有害。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T14:00:38.697

它不是线程安全的，因为多个线程可能同时修改链表中的指针，从而可能破坏它。

在这里你有一个非常相似的问题的答案： [Multiple-writer thread-safe queue in C](https://stackoverflow.com/questions/1212623/multiple-writer-thread-safe-queue-in-c)

在那里你可以看到如何使队列线程安全。

# php - 为什么无法在此 html 输入字段中输入字符？

> ID：10721152
> 
> 赞同：-1
> 
> 时间：2012-05-23T13:38:14.697
> 
> 标签：php, html

有一个 html 输入字段文本具有来自数据库的值，值为 : `<input type=radio id="%id%" name="%name%" value="%valeur%" %checked% onclick="" />`。实际上，该字段的数据是使用`htmlentities`函数在`PHP`从数据库返回的列值上获得的。

问题是我无法在该字段中键入任何字符，尽管该字段不是只读的！但我可以使用后退键盘或删除键盘删除其中的字符。

那么它怎么可能是可写的呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T13:42:37.330

您不能使用单选按钮将文本写入其中。使用`type="text"`或`<textarea>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T13:42:40.913

`<input type="text" id="%id%" name="%name%" value="%valeur%" />`改为使用

**在我最初的帖子之后编辑：**

您需要使用从数据库中转义双引号`&quot;`。

所以这应该有效：

```
<input type="text" value="<input type=radio id=&quot;%id%&quot; name=&quot;%name%&quot; value=&quot;%valeur%&quot; %checked% onclick=&quot;&quot;/>" /> 
```

因此，您需要在数据库插入之前或将值放入文本字​​段时进行转义。但在这两种情况下，都需要更改双引号。

`htmlspecialchars()`为此使用 php 。

看看[这个小提琴](http://jsfiddle.net/wrPjD/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T13:41:36.647

它是一个单选按钮。制作`type=text`

如果您的文本字段的值`<input type=radio id="%id%" name="%name%" value="%valeur%" %checked% onclick="" />` `<, >`在文本框中的值使用等中无效`&lt;`，`&gt;`等等。

[`htmlspecialchars`](http://php.net/manual/en/function.htmlspecialchars.php)在放入东西之前使用`value`。

# matlab - 使用机器学习进行预测/延迟预测？

> ID：10721154
> 
> 赞同：-1
> 
> 时间：2012-05-23T13:38:27.760
> 
> 标签：matlab, machine-learning, data-mining, weka, data-analysis

我有一组过去 5 年的数据。大约 7000 行数据，其特征为二进制 {yes/no} 或多分类 {product A, B, C} 总共约 20 多个特征。

我正在尝试制作一个程序（或一次分析项目）来根据此历史数据确定（预测）产品发货日期（发货延迟天数）。我有两列表示产品计划何时发货，另一列表示*实际*发货时间！目前。

我想知道如何制作一个预测程序，根据历史数据确定产品的新数据输入何时预计发货。我不在乎得到一个具体的日期，甚至只是一个可以告诉我要添加的延迟天数的程序...

不久前我参加了 ML 课程，但我不知道如何开始这样的事情。有什么建议吗？再加上我能想到的最接近的事情是使用 NN 的图像识别任务。但这太容易了，我必须处理日期而不是像素白色/黑色......我以前使用过 Matlab（我仍然知道如何使用它）但我刚刚下载了 Weka 数据挖掘工具。

我正在考虑一个神经网络，但我不确定如何设置它以让我的程序从输入的发货日期给我一个预期的延迟时间（天数/月数）。

基本上，

我想输入（尺寸 = 5，产品 = A，....，预计发货日期 = 1 月 1 日）

考虑到历史趋势，程序返回天数作为延迟添加到我的预期发货日期......

对于如何以正确/最简单/最好的方式开始这样的事情，我们将不胜感激......在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T17:59:59.117

如果您使用 weka，则将您的输入/标签数据转换为[arff](http://www.cs.waikato.ac.nz/ml/weka/arff.html)格式，然后尝试所有不同的[回归量](http://weka.sourceforge.net/doc/weka/classifiers/functions/package-summary.html)（这毕竟是一个回归问题）。为了避免做太多的编程（如果您只是处于探索阶段），请使用[weka Experimenter](http://www.cse.yorku.ca/course_archive/2006-07/W/4412/doc/weka/ExperimenterTutorial-3.5.5.pdf)，它有一个 GUI 可以在您的数据集上尝试一大堆回归量。

然后，当您找到一个可以做一些预期的事情并且您想使用 MATLAB 进行更多数据分析时，您可以使用[weka/matlab 接口](http://www.mathworks.com/matlabcentral/fileexchange/21204-matlab-weka-interface)。

# database - 如何从 extbase 操作中获取数据库字段值？

> ID：10721155
> 
> 赞同：1
> 
> 时间：2012-05-23T13:38:29.553
> 
> 标签：database, repository, action, typo3, extbase

现在我设法获得了随机 AJAX 输出，下一步我想从数据库中获取一些有用的值。

再一次，我的 AJAX 调用看起来像这样（另外，我添加了一个 JSON 调用，这样会更好）。

```
        $.ajax({
              url: "index.php",
              data: "tx_myext_myplugin1[controller]=Mycontroller1&tx_myext_myplugin1[action]=ajax&type=89657201",
              success: function(result) {
                alert(result);
              }
            });

    /*
    var uri = '<f:uri.action action="ajax" controller="Mycontroller1" pageType="89657201" />';

    jQuery.getJSON(uri, function(result) {
        alert(result.c);
    });
    */ 

```

我的 ajaxAction 函数：

```
        public function ajaxAction() {
        $arr = array ('a'=>1,'b'=>2,'c'=>3,'d'=>4,'e'=>5);

        return json_encode($arr);
    } 

```

这在我使用 JSON 调用时有效，但现在我需要获取一个包含数据库值的数组。我认为使用 findAll() 函数调用存储库已经有所帮助，但我认为它不是一个数组，这就是我不能使用它的原因。一个不同的想法是使用我在模型中编写的 getValue 方法，但我不确定这是否会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:03:42.380

***免责声明：*** *通常使用 findAll() 方法可能是真实的`performance killer`，因此尝试编写自定义查找器，仅选择所需的属性，特别是如果您的模型很大或包含许多关系！*

您已经足够接近了，因为您可以使用 json_encode() 发送 findAll() 结果，但请注意，根据您的模型，从 findAll 创建的 json 可能非常巨大。迭代结果并重写新数组只需要值是更好的主意。

```
 $dataFromRepo = $this->yourRepository->findAll();

    $resultArray = array();

    foreach ($dataFromRepo as $object){
        $resultArray[$object->getUid()] = $object->getTitle();
    }

    return json_encode($resultArray); 
```

结果你会得到基本的 JSON `object`：

```
{
    "1": "Title of first item",
    "2": "Second item",
    "3": "Et cetera"
} 
```

何时删除自定义索引`$resultArray`

```
 foreach ($dataFromRepo as $object){
        $resultArray[] = $object->getTitle();
    } 
```

你会得到 JSON`array`

```
[
    "Title of first item",
    "Second item",
    "Et cetera"
] 
```

等等。当然，您也可以通过这种方式构建`multidimensional array`并发送更复杂的对象来一次获得所有您需要的东西。

PS 尝试始终使用示例[JsonLint](http://jsonlint.com/) - 在线验证器来验证您期望的输出是否有效。

# ios - 如何避免让每个 viewController 都成为 adWhirl 委托？（是否有 AdWhirl 设计模式）

> ID：10721157
> 
> 赞同：1
> 
> 时间：2012-05-23T13:38:30.710
> 
> 标签：ios, iad, adwhirl

**背景：** 上周我问了一个关于在多个视图控制器中使用 adWhirl 的问题，但不幸的是我仍然没有得到它。

我接受了建议，现在在每个 viewController 中使用在应用程序委托中创建的一个 adWhirl 实例，但我看不到如何响应我的 viewController （等）中的 adWhirl 委托事件，`adWhirlDidReceiveAd:, adWhirlDidFailToReceiveAd:`因为应用程序委托不知道哪个 viewController 当前正在显示它的 adView。

因此我的困惑...

这有设计模式吗？我认为必须有。如果可以避免的话，我不想用样板 adWhirl 委托代码来填充我的所有视图控制器。

我现在在每个 viewController 中得到的内容如下。我尝试在应用程序委托中设置一个方法，每个视图控制器都可以调用该方法来“注册”，该方法正在获取应用程序委托的 adView 的所有权 - 认为当委托接收到类似的事件时`adWhirlDidReceiveAd`，它可以完成以下工作。这种工作但让我认为我正在重新发明轮子。

**问题：**是否有跨多个视图控制器使用 adWhirl 视图的设计模式？

```
- (void)viewDidLoad
{
[super viewDidLoad];

AppDelegate *appDelegate = (AppDelegate*)[[UIApplication sharedApplication] delegate];

[self.view addSubview:appDelegate.adView];
[self.view bringSubviewToFront:appDelegate.adView];

CGSize adSize = [appDelegate.adView actualAdSize];
CGRect onScreenFrame = appDelegate.adView.frame;
onScreenFrame.size.height = adSize.height; // fit the ad 
onScreenFrame.size.width = adSize.width; 
onScreenFrame.origin.x = (self.view.frame.size.width - adSize.width)/2; // center 
onScreenFrame.origin.y = (self.view.frame.size.height - adSize.height); 

appDelegate.adView.frame = onScreenFrame;

}

- (void)viewDidDisappear:(BOOL)animated
{
AppDelegate *appDelegate = (AppDelegate*)[[UIApplication sharedApplication] delegate];
[appDelegate.adView removeFromSuperview];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T13:53:04.377

显而易见的答案是创建一个 Controller 类，您的所有视图控制器都将成为其子类。那么那么

```
AdviewDelegateController : UIViewController 
```

和

```
YourViewController : AdviewDelegateController 
```

然后你把你所有的 adview 逻辑放在 AdviewDelegateController 中。

# sql-server - 将 MS Access 中的 VBA 代码转换为 SQL Server

> ID：10721158
> 
> 赞同：0
> 
> 时间：2012-05-23T13:38:30.757
> 
> 标签：sql-server, ms-access

以下代码来自 MS Access，我正在尝试对其进行转换并使其在 SQL Server 中工作。我不知道如何转换包含 IsNull 的最后一行。PS：LIS是驱动器的名称。感谢任何可以给我提示的人。

```
SELECT DISTINCT [Molecular Pathology].[ID#], [Molecular Pathology].[Last Name], 
[Molecular Pathology].[First Name], [Molecular Pathology].Gender, 
[Molecular Pathology].[Date of Birth], [Molecular Tests].[Test Type], 
[Molecular Pathology].[Testing Gene], [Molecular Pathology].[Testing Exon], 
[Molecular Pathology].[Tested Mutation], [Molecular Pathology].[Testing Gene 2], 
[Molecular Pathology].[Testing Exon 2], [Molecular Pathology].[Tested Mutation 2], 
[Molecular Tests].[Test Name], [Molecular Pathology].[Result Reported],
[Molecular Pathology].[Date Received], [Molecular Pathology].[gp#]
FROM ([Molecular Pathology] 
LEFT JOIN [Molecular Select Tests] 
  ON [Molecular Pathology].ID = [Molecular Select Tests].ForKey) 
LEFT JOIN [Molecular Tests] 
  ON [Molecular Select Tests].Test = [Molecular Tests].[Test Name]
WHERE ((IsNull([Molecular Pathology].[LIS SignOut])<>False)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T13:40:55.407

只有几个小问题，但是您可以通过正确使用表别名来大大提高此查询的可读性。请尝试重新编写：

```
SELECT DISTINCT 
  mp.[ID#],            mp.[Last Name],       mp.[First Name], 
  mp.Gender,           mp.[Date of Birth],   mt.[Test Type],       
  mp.[Testing Gene],   mp.[Testing Exon],    mp.[Tested Mutation], 
  mp.[Testing Gene 2], mp.[Testing Exon 2],  mp.[Tested Mutation 2], 
  mt.[Test Name],      mp.[Result Reported], mp.[Date Received],
  mp.[gp#]
FROM 
  dbo.[Molecular Pathology] AS mp 
LEFT OUTER JOIN 
  dbo.[Molecular Select Tests] AS mst
  ON mp.ID = mst.ForKey -- Molecular Pathology has an ID column and an ID# column? 
LEFT OUTER JOIN 
  dbo.[Molecular Tests] AS mt
  ON mst.Test = mt.[Test Name]
WHERE 
  mp.[LIS SignOut] IS NULL; 
```

# javascript - 跨浏览器 showModalDialog 替换

> ID：10721159
> 
> 赞同：2
> 
> 时间：2012-05-23T13:38:37.167
> 
> 标签：javascript, jquery, html

所以我们有一个内部网络应用程序，它是在 IE6 时代写回的，我们正试图达到一个可以跨浏览器工作的状态，包括移动设备。我们使用的是 ASP.NET，代码隐藏是用 VB.NET 编写的。

不幸的是，该应用程序使用了 showModalDialog 功能，该功能只能在 Internet Explorer（以及某种在 Firefox 中）中真正有效。它还利用这些弹出窗口中的 window.returnValue，因此它所期望的是，当调用 PopUpWindow() 时，javascript 将阻塞该语句并停止执行。大多数调用的格式为“var a = PopUpWindow(..)”。然后当弹出窗口关闭时，它将恢复并将 a 设置为 returnValue 然后使用它。

看起来这些天 javascript 并没有真正做阻塞函数调用，这使得寻找一个简单的跨浏览器替换的过程令人沮丧。我们有一个 javascript 文件，该文件包含在每个页面上，其中包含打开弹出窗口的功能。理想情况下，我们希望在这个文件中替换这个函数，让它在整个应用程序中工作，而不必在每个有弹出窗口的页面上进行更改。

有什么可以帮助解决这个问题的，或者是否有替换这些对话框弹出窗口的标准方法？我们正在考虑用 jQuery 对话框替换它们，但由于我们需要使用回调函数来获取 returnValue，因此它不能作为直接替换。我感觉没有简单的方法可以做到这一点（因为我们的代码依赖于阻塞 javascript），我们将不得不硬着头皮对每个页面进行更改，并弹出一个弹出窗口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-04T16:05:30.013

您可以使用我的[showModalDialog polyfill](https://github.com/niutech/showModalDialog)使用模态`<dialog>`元素，该元素适用于最新的 Google Chrome。对于其他浏览器，可以使用[`<dialog>`polyfill](https://github.com/GoogleChrome/dialog-polyfill)。

# svn - SVN 在 Jenkins 中的 2 个标签之间发生变化

> ID：10721162
> 
> 赞同：3
> 
> 时间：2012-05-23T13:38:46.730
> 
> 标签：svn, jenkins

我正在使用 Jenkins 创建一个发布包。工作完成后，我将在 SVN 中使用特定版本标记新版本。现在，此时我需要生成一封电子邮件给项目的首席开发人员，并附上一份报告，该报告将显示 2 个 SVN 标签之间的变化，因此 Lead Dev 可以快速查看将要生产的内容。有人有过这样的经历吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:26:31.703

如果你知道标签，那么编写一个 shell 构建步骤，执行（取决于你的 repo 的结构）类似的东西`svn diff http://<repo>/tags/<tag1> http://<repo>/tags/<tag2> > diff.txt`（你也可以添加`--summarize`）。现在，`diff.txt`将“生活”在您的工作区中。然后，您可以使用[EmailExt 插件](https://wiki.jenkins-ci.org/display/JENKINS/Email-ext+plugin)在带有令牌的电子邮件中包含*diff.txt*`${FILE}`内容（当您选中“可编辑电子邮件通知”框时，将通过“？”图标提供 EmailExt 插件令牌参考）。

确保`diff.txt`在运行下一个构建之前删除（[工作区清理插件](https://wiki.jenkins-ci.org/display/JENKINS/Workspace+Cleanup+Plugin)可能会有所帮助）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T14:06:20.970

我在 mercurial 中做了类似的事情。我在 2 个标签之间获取了 hg 日志并将其保存到文件中。所以像 svn log -r[tag] 这样的东西我认为会从标签到提示。 [http://www.bernzilla.com/item.php?id=613](http://www.bernzilla.com/item.php?id=613)

# sql - 是否可以让 WHERE 仅适用于 SQL Server 中的 1 列？

> ID：10721163
> 
> 赞同：0
> 
> 时间：2012-05-23T13:38:54.060
> 
> 标签：sql, sql-server, sql-server-2008, where-clause

我有如下数据：

tblBio

```
bio        bioid
some data  1
some data  2 
```

tbl联系人

```
email        email_pub    bioid
me@me.com    1            1
you@me.com   0            2 
```

我需要选择

```
bio + 'email: ' + email WHERE email_pub = 1 
```

我目前有：

```
SELECT b.bio + 'Email: ' + COALESCE(c.email, '')
FROM tblbio b
INNER JOIN tblContact c ON b.bioid = c.bioid
WHERE c.email_pub = 1
AND b.bioid = 1 
```

但是，我总是需要选择 bio，然后仅在 email_pub 设置为 1 时将文本“email:”以及电子邮件地址附加到末尾。如果 email_pub 为 0，则使用“WHERE email_pub = 1”即可然后什么都没有选择。

同样，即使没有已发布的电子邮件，文本“电子邮件：”也将始终显示。

谢谢，

托马斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T13:41:55.007

这是一个需要`CASE`-`CASE`用于表达式的内联评估的场景。

```
SELECT b.bio + 'Email: ' + CASE WHEN email_pub=1 THEN COALESCE(c.email, '') ELSE '' END
FROM tblbio b
INNER JOIN tblContact c ON b.bioid = c.bioid
WHERE b.bioid = 1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-23T13:41:19.203

使用`CASE`：

```
SELECT b.bio + case when email_pub = 1 then 'Email: ' + COALESCE(c.email, '') else '' end
FROM tblbio b
INNER JOIN tblContact c ON b.bioid = c.bioid
WHERE b.bioid = 1 
```

# android - 如何在返回网格视图时将选择器设置为 true

> ID：10721165
> 
> 赞同：0
> 
> 时间：2012-05-23T13:39:03.793
> 
> 标签：android, gridview, imageview, longlistselector

我在这里使用网格视图，并在单击网格视图项目时打开完整图像当我向后按到我的网格视图时，我希望我的最后一个选择器位置为真。请帮我找出这个

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T13:44:02.500

一种简单的方法是在单击时保存单击元素的网格视图位置。使用共享首选项。您可以在 onResume() 函数中加载状态。

# ruby-on-rails-3 - Rails / Heroku：nil的未定义方法“事件”：NilClass

> ID：10721167
> 
> 赞同：0
> 
> 时间：2012-05-23T13:39:08.770
> 
> 标签：ruby-on-rails-3, heroku

我有一种方法可以在我的机器上本地运行，但在 Heroku 中失败了。Heroku 日志说：

> NoMethodError（nil:NilClass 的未定义方法“事件”）

我已经将 heroku 控制台用于此方法的等效方法，并且它可以工作，因此有支持它的数据。方法是：

```
 def index
    @events = current_user.school.events
 end 
```

我正在使用我相信它给了我 current_user 方法的设计。等价的 a = User.first.school.events 产生带有数据的真实实例值。User.first 产生正确的数据。

这是我的模型：

```
class School < ActiveRecord::Base
  #validates_presence_of :name

  has_many :events, :dependent => :destroy
  has_many :users, :dependent => :destroy
  belongs_to :user
  belongs_to :event

  def self.fetch_for_name(_name)
    school = self.new(:name => _name)
  end
end

class User < ActiveRecord::Base
  belongs_to :school

  rolify
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable

  attr_accessible :name, :email, :password, :password_confirmation, :remember_me
end

 class Event < ActiveRecord::Base

   belongs_to :school

 end 
```

如果我忽略了一些简单、基本的事情，那会像我一样，但如果我能在 Heroku 控制台中正确地做到这一点，为什么这个方法会中断。另一个不相关的页面在 Heroku 上正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T15:37:15.937

current_user 是登录的用户。它不一定意味着 User.first。这在本地应该与 Heroku 上的相同。如果您无法确定登录的用户，您可以将其添加到您的应用程序控制器

```
before_filter :debug

def debug
  Rails.logger.info("Current User is: #{current_user.inspect}")
end 
```

然后查看输出，`$ heroku logs --tail`它应该会显示 current_user 的当前值。归根结底，@thesis 所说的是正确的，您有一个没有与之关联的学校的用户。

# jquery - JQuery 适用于 Firefox 而不是 Chrome

> ID：10721171
> 
> 赞同：0
> 
> 时间：2012-05-23T13:39:26.620
> 
> 标签：jquery

我有两个这样的功能：

```
<script type="text/javascript" lang="javascript">
    $(document).ready(function() {
        $('div').hover(
            function() { $('> span', this).show(); }, 
            function() { $('> span', this).hide(); }
        );
    });
</script>

<script type="text/javascript">
    !function(d,s,id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (!d.getElementById(id)) {
            js = d.createElement(s);
            js.id = id;
            js.src = "//platform.twitter.com/widgets.js";
            fjs.parentNode.insertBefore(js,fjs);
        }
    }(document,"script","twitter-wjs");
</script>

<script type="text/javascript" lang="javascript">
    $.getJSON("http://twitter.com/statuses/user_timeline/username.json?callback=?&count=5", function(data) {
        $.each(data, function(index, value) { 
            $('.tweets').append('<div id='+data[index].id+'>'+data[index].text+'&nbsp<span style="display:none"class="hideTweeterIcons"><a href="https://twitter.com/intent/tweet?in_reply_to='+data[index].id+'"><img src="//si0.twimg.com/images/dev/cms/intents/icons/reply.png"></a><a href="https://twitter.com/intent/retweet?tweet_id='+data[index].id+'"><img src="//si0.twimg.com/images/dev/cms/intents/icons/retweet.png"></a><a href="https://twitter.com/intent/favorite?tweet_id='+data[index].id+'"><img src="https://si0.twimg.com/images/dev/cms/intents/icons/favorite.png"></a></span></div><hr>');
        });     
    });
</script> 
```

但是，功能的悬停部分在 Chrome 中不起作用。它在 Firefox 中运行良好。怎么了？我知道 Chrome 有更好的 webkit。怎么了 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T13:46:39.800

以这种方式编写它们，它们会正常工作：

```
$('div').hover(function()
    {
        $(this).find('span').show();
    }, function()
    {
        $(this).find('span').hide();
    }); 
```

让我知道这是否有效，如果您需要其他方案，请告诉我，以便我修改答案，谢谢。

# mediawiki - Bot vs 基于 Rest 的调用 - Media Wiki

> ID：10721173
> 
> 赞同：-4
> 
> 时间：2012-05-23T13:39:26.933
> 
> 标签：mediawiki

MediaWiki 上的机器人与使用基于 Rest 的 api 进行操作有什么区别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T13:58:08.580

如果您所说的“机器人”是指屏幕抓取，那么此类“机器人”将受到严重劝阻，并且我们的开发人员不保证屏幕抓取能够可靠地工作，即 HTML 输出可能随时发生巨大变化，恕不另行通知。另一方面，MediaWiki 的 web API 在设计时考虑到了稳定性——除了其他好处，例如机器可读的输出（ol'好的 JSON 比标签汤更容易解析）和更好的性能（我们不花费服务器资源在皮肤渲染上，您不会花费带宽来接收它）。

# php - 如何通过 imagettftext 在 Facebook php 应用程序 [heroku] 中使用 ttf 字体

> ID：10721174
> 
> 赞同：-1
> 
> 时间：2012-05-23T13:39:28.257
> 
> 标签：php, facebook, facebook-graph-api, facebook-php-sdk

我使用以下代码在 png 图像上使用 imagettftext() 函数。

但这似乎不起作用。

有什么解决办法吗？

ttf字体在index.php文件的当前目录下

```
<?php 
        require ("sdk/src/facebook.php");
        $facebook=new Facebook(array('appId'=>'144694832322411','secret'=>'56456456456e6f75a5c4657befa','fileUpload'=>true,));

        $user = $facebook->getUser();

        if($user){
                 echo "User";
                 $im = imagecreate(200,200);
                 $rt='font.ttf';
                 $col = imagecolorallocate($im,255,0,0);
                 $v= imagecolorallocate($im,255,0,0);
                 try{
                imagettftext($im,30.0,0.0,0,0,$v,$rt,"Hello");} catch (Exception $e){print_r($e);}
                 imagepng($im,'img.png');
                 echo "<img src='img.png'></img>";
             } else {
                      $auth= "https://www.facebook.com/dialog/oauth/?client_id=144694832322411&redirect_uri=".urlencode("https://apps.facebook.com/lucky_elements")."&scope=user_about_me";
                       echo "<script>top.location.href=\"$auth\"</script>";
                      }

        ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-29T12:09:25.047

heroku 不支持 imagettftext()，它不支持 pfb 字体，并且它有错误的 gdf ​​支持，看起来不能正常工作。所以要么更改服务器，要么尝试构建自定义构建（[https://github.com/heroku/heroku-buildpack-php](https://github.com/heroku/heroku-buildpack-php)）

# c# - 从虚拟化注册表读取 Windows 服务

> ID：10721178
> 
> 赞同：0
> 
> 时间：2012-05-23T13:39:36.607
> 
> 标签：c#, .net, windows-services, registry, registry-virtualization

如果我对此有误，请纠正我，因为我确定我在某处读过它：Windows 服务已禁用注册表虚拟化。此外，对 x64 二进制文件禁用了虚拟化。

我有一个用 C# 编写的 Windows 服务，它需要从 HKEY_LOCAL_MACHINE\SOFTWARE 加载一个值。当我将服务编译为 x86 并启动它时，它无法读取该值。当我编译与 x64 相同的代码并启动它时，它读取的值就好了。除了 x64 机器之外，我希望我的服务能够在 x86 机器上运行，但它还需要能够读取此值。如何让我的 Windows 服务读取非虚拟化的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T13:58:43.197

> Windows 服务禁用注册表虚拟化。此外，对 x64 二进制文件禁用了虚拟化。

是的，你是对的，它对 64 位进程和“*非交互式进程，例如服务*”被禁用。

有关注册表视图的一些详细信息，请查看我[之前](https://stackoverflow.com/questions/10533421/accessing-64-bit-registry-from-32-bit-application/10533865#10533865)关于 SO 的帖子。请不要将*视图*与*虚拟化*混淆。他们是不同的。需要使用视图将 32 位应用程序与 64 位应用程序隔离开来。

在 C# 中，您可以执行相同的操作，只需*要求*操作系统打开 64 位版本的注册表：

```
RegistryKey baseKey = RegistryKey.OpenBaseKey(
    RegistryHive.LocalMachine, RegistryView.Registry64);
RegistryKey key = baseKey.OpenSubKey("Software", false);
object value = key.GetValue(""); 
```

如果您的应用程序/服务将在 32 位机器上运行，*即使*您要求`RegistryView.Registry64`. 在 64 位机器上运行时，您将始终获得注册表的*正常*版本（= 64 位版本）。

附带问题：为什么需要将应用程序编译为 X86 或 X64？不能简单地保留AnyCPU？

虚拟化有不同的目的，它并不是要将注册表与 32 位应用程序分开，而是为了增加与*遗留*应用程序的兼容性，我们都希望 64 位本机应用程序以正确的方式使用注册表。要访问注册表的非虚拟化版本，您必须使用`REG_KEY_DONT_VIRTUALIZE`标志打开注册表项。无法将此标志与`Microsoft.Win32`类一起使用，因此您必须使用`DllImport`它们和 P/Invoke。

# r - 如何加快这个 _for_ 循环？使用 data.table + lapply？

> ID：10721180
> 
> 赞同：3
> 
> 时间：2012-05-23T13:39:41.700
> 
> 标签：r, data.table, lapply

此代码生成类似于我自己的数据集：

* * *

```
df <- c(seq(as.Date("2012-01-01"), as.Date("2012-01-10"), "days"))
  df <- as.data.frame(df)
  df <- rbind(df, df)

id <- c(rep.int(1, 10), rep.int(2, 10))
  id <- as.data.frame(id)

cnt <- c(1:3, 0, 0, 4, 5:8, 0, 1, 0, 1:7)
  cnt <- as.data.frame(cnt)

df <- cbind(id, df, cnt)
  names(df) <- c("id", "date", "cnt")

df$date[df$date == "2012-01-10"] <- "2012-01-20" 
```

* * *

我试图找出过去 7 天内发生的变量“cnt”的总和。有时日期不是连续的（参见前面的“df”中的最后一个日期）——按 id。

这是循环：

* * *

```
system.time(

  for(i in 1:length(df$date)) {
    df$cnt.weekly[i] <- 
      sum(df$cnt[which((df$date == df$date[i] - 1) & df$id == df$id[i])],
          df$cnt[which((df$date == df$date[i] - 2) & df$id == df$id[i])],
          df$cnt[which((df$date == df$date[i] - 3) & df$id == df$id[i])],
          df$cnt[which((df$date == df$date[i] - 4) & df$id == df$id[i])],
          df$cnt[which((df$date == df$date[i] - 5) & df$id == df$id[i])],
          df$cnt[which((df$date == df$date[i] - 6) & df$id == df$id[i])])}) 
```

* * *

我最终在 800 万行 data.frame（数千个 id）上运行它，所以虽然玩具在这里很快，但在实践中却非常慢。

我在代码的其他部分使用 data.table 包非常幸运，但我不知道如何让它在这里工作。也许 lapply 在 data.table 内？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T15:39:16.970

怎么样 ：

```
> DT = as.data.table(df)
> DT
      id       date cnt
 [1,]  1 2012-01-01   1
 [2,]  1 2012-01-02   2
 [3,]  1 2012-01-03   3
 [4,]  1 2012-01-04   0
 [5,]  1 2012-01-05   0
 [6,]  1 2012-01-06   4
 [7,]  1 2012-01-07   5
 [8,]  1 2012-01-08   6
 [9,]  1 2012-01-09   7
[10,]  1 2012-01-20   8
[11,]  2 2012-01-01   0
[12,]  2 2012-01-02   1
[13,]  2 2012-01-03   0
[14,]  2 2012-01-04   1
[15,]  2 2012-01-05   2
[16,]  2 2012-01-06   3
[17,]  2 2012-01-07   4
[18,]  2 2012-01-08   5
[19,]  2 2012-01-09   6
[20,]  2 2012-01-20   7 
```

然后在组内累积。这一步目前很难看，但`:=`按组（即将在 1.8.1 中）会整理一下。

```
> DT[,cumcnt:=DT[,cumsum(cnt),by=id][[2]]]
      id       date cnt cumcnt
 [1,]  1 2012-01-01   1      1
 [2,]  1 2012-01-02   2      3
 [3,]  1 2012-01-03   3      6
 [4,]  1 2012-01-04   0      6
 [5,]  1 2012-01-05   0      6
 [6,]  1 2012-01-06   4     10
 [7,]  1 2012-01-07   5     15
 [8,]  1 2012-01-08   6     21
 [9,]  1 2012-01-09   7     28
[10,]  1 2012-01-20   8     36
[11,]  2 2012-01-01   0      0
[12,]  2 2012-01-02   1      1
[13,]  2 2012-01-03   0      1
[14,]  2 2012-01-04   1      2
[15,]  2 2012-01-05   2      4
[16,]  2 2012-01-06   3      7
[17,]  2 2012-01-07   4     11
[18,]  2 2012-01-08   5     16
[19,]  2 2012-01-09   6     22
[20,]  2 2012-01-20   7     29 
```

现在加入 7 天前，允许不规则日期：

```
> setkey(DT,id,date)
> DT[,before7dayago:=DT[SJ(id,date-7),cumcnt,roll=TRUE,mult="last"]]
      id       date cnt cumcnt before7dayago
 [1,]  1 2012-01-01   1      1            NA
 [2,]  1 2012-01-02   2      3            NA
 [3,]  1 2012-01-03   3      6            NA
 [4,]  1 2012-01-04   0      6            NA
 [5,]  1 2012-01-05   0      6            NA
 [6,]  1 2012-01-06   4     10            NA
 [7,]  1 2012-01-07   5     15            NA
 [8,]  1 2012-01-08   6     21             1
 [9,]  1 2012-01-09   7     28             3
[10,]  1 2012-01-20   8     36            28
[11,]  2 2012-01-01   0      0            NA
[12,]  2 2012-01-02   1      1            NA
[13,]  2 2012-01-03   0      1            NA
[14,]  2 2012-01-04   1      2            NA
[15,]  2 2012-01-05   2      4            NA
[16,]  2 2012-01-06   3      7            NA
[17,]  2 2012-01-07   4     11            NA
[18,]  2 2012-01-08   5     16             0
[19,]  2 2012-01-09   6     22             1
[20,]  2 2012-01-20   7     29            22 
```

最后从另一个中减去一个。

```
> DT[,`7daysum`:=cumcnt-before7dayago]
      id       date cnt cumcnt before7dayago 7daysum
 [1,]  1 2012-01-01   1      1            NA      NA
 [2,]  1 2012-01-02   2      3            NA      NA
 [3,]  1 2012-01-03   3      6            NA      NA
 [4,]  1 2012-01-04   0      6            NA      NA
 [5,]  1 2012-01-05   0      6            NA      NA
 [6,]  1 2012-01-06   4     10            NA      NA
 [7,]  1 2012-01-07   5     15            NA      NA
 [8,]  1 2012-01-08   6     21             1      20
 [9,]  1 2012-01-09   7     28             3      25
[10,]  1 2012-01-20   8     36            28       8
[11,]  2 2012-01-01   0      0            NA      NA
[12,]  2 2012-01-02   1      1            NA      NA
[13,]  2 2012-01-03   0      1            NA      NA
[14,]  2 2012-01-04   1      2            NA      NA
[15,]  2 2012-01-05   2      4            NA      NA
[16,]  2 2012-01-06   3      7            NA      NA
[17,]  2 2012-01-07   4     11            NA      NA
[18,]  2 2012-01-08   5     16             0      16
[19,]  2 2012-01-09   6     22             1      21
[20,]  2 2012-01-20   7     29            22       7 
```

那应该非常快。

# c++ - opencv：创建矩阵或矩阵向量

> ID：10721181
> 
> 赞同：-1
> 
> 时间：2012-05-23T13:39:50.110
> 
> 标签：c++, image-processing, opencv, matrix

我有以下代码，这是我正在遵循的算法的一部分。如您所见，我需要对 10 个不同的频段进行一些计算。最终会得到一个矩阵，我需要从中重新创建一个图像，问题是我不知道如何在while循环上创建/保存10个不同的矩阵，然后在while循环之后我可以构造图片一张一张。如果您有任何想法，请告诉我谢谢

```
cv::Mat _reconstructionMatrix(height,width,CV_8UC1);
_reconsPointer = _reconstructionMatrix.ptr<uchar>(0);   

    while(_bandIteration<_bandsNumber){                     
if(_mainMatrix.isContinuous())
{
    nCols *= nRows;
    nRows = 1;
}
//for all the pixels 
for(int i = 0; i < nRows; i++)
{           
    p = _mainMatrix.ptr<uchar>(i);
    //in the images
    for (int  j = 0; j < nCols; j++)
    {               
        if(_pCounter<_totalImgNO){              
            ....
        }else{                                                      
            ...

            _reconsPointer[_resultFlag]=_summation; 
            _resultFlag++;

            ...             
        }
    }                   
}           

_bandIteration++;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T14:05:52.477

你的问题有点含糊。但是，如果您只是简单地询问，`how to create/hold the 10 different matrix on the while loop?`那么您可以照常使用 STL 向量。

```
#include<vector>
...   
std::vector<cv::Mat> listOfMatrices;
...       
cv::Mat M = SomehowGetMatrix();
listOfMatrices.push_back(M); 
```

如果这不是您正在寻找的内容，请为您的问题提供更多详细信息。

# c - 检查管道状态

> ID：10721189
> 
> 赞同：0
> 
> 时间：2012-05-23T13:40:14.840
> 
> 标签：c, printf, pipe

我创建了一个命名的 posix 管道，比如 pipe_out，使用

```
mkfifo $path_tmp/pipe_out 
```

用C打开

```
out_pipe = fopen(TMP_PATH "/pipe_out", "w"); 
```

并使用 fprintf 命令写入它

```
fprintf(out_pipe,"%s",string); 
```

我想我可以使用 fprintf 的返回值来检查写入了多少，并将其与字符串的实际长度进行比较，以了解是否将完整的字符串写入管道。然后，如果它（过度）满了，我会以某种方式暂停并尝试从尚未写入的内容开始以无限循环再次写入......

这会是什么样子的详细信息，是否有一种更高级的方法可以在管道已满时自动停止（暂停）fprintf。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T15:46:11.083

如果您想主动检测管道何时已满，则使用`fprintf()`不是一个好主意，因为它会在内部缓冲您的数据。

即使管道 fd 不再可写， fprintf() 将继续返回，除非内部缓冲区也已满。在这种情况下，它不会返回一个缩短的值，而是阻塞，直到它可以写入/缓冲整个字符串。

如果要检测管道状态，则不应使用缓冲函数，但：

*   open() 打开先进先出/管道
*   select() 测试文件描述符是否可写
*   write() 写入字符串（必须处理返回值）

# javascript - JavaScript utf-8 编码问题

> ID：10721190
> 
> 赞同：1
> 
> 时间：2012-05-23T13:40:16.590
> 
> 标签：javascript, jquery, json, jsp, utf-8

我想填充从服务器到 UI 页面以 json 形式出现的 utf-8 数据。

我可以看到“jsonStr”有 utf-8 数据。我已经在 Eclipse 的调试模式下进行了验证。

但是当我看到 json 变量值时，它显示为“？？？？？？”。

这是我使用的代码片段

```
 <script  language="JavaScript" charset="utf-8">
var json = <%=jsonStr%>
</script> 
```

有人可以在这个问题上帮助我吗？

甚至 jQuery 代码片段也可以

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T13:44:46.253

问题可能是您的服务器没有将数据作为 utf8 发送出去。我不确定您使用的是哪种服务器端语言，但这是我在 PHP 中所做的：

```
/**
 * encodes a string / array values to utf8
 * @param (mixed) $mixed
 */
static function utf8Encode( $mixed ) {
    if( is_array( $mixed ) ) {
        foreach( $mixed as $key => $value ) {
            $mixed[$key] = self::utf8Encode( $value );
        }
    } else {
        if( !mb_check_encoding( $mixed, 'UTF-8') ) {
            $mixed = utf8_encode( $mixed );
        }
    }

    return $mixed;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T13:49:18.350

通过在 JSP 页面顶部添加以下行来告诉 JSP 使用 UTF-8 编写响应正文：

```
<%@page pageEncoding="UTF-8" %> 
```

为避免对每个 JSP 页面重复此操作，您还可以`web.xml`按如下方式对其进行配置，以便它自动应用于每个 JSP：

```
<jsp-config>
    <jsp-property-group>
        <url-pattern>*.jsp</url-pattern>
        <page-encoding>UTF-8</page-encoding>
    </jsp-property-group>
</jsp-config> 
```

请注意，当通过 HTTP 提供页面时，将**忽略**`Content-Type`HTML 元标记。它仅在页面保存到客户端磁盘然后通过URL 从它重新打开时使用。**`file://`**

 **### 也可以看看：

*   [Unicode - 如何让字符正确？](http://balusc.blogspot.com/2009/05/unicode-how-to-get-characters-right.html)**

# git - 恢复到文件的旧版本

> ID：10721192
> 
> 赞同：1
> 
> 时间：2012-05-23T13:40:27.853
> 
> 标签：git, xcode4.3

我很确定有很多关于如何返回到旧版本的文件的资源，比如[这个](https://stackoverflow.com/questions/2733873/reverting-a-single-file-to-a-previous-version-in-git)，但是使用命令行，我想做的是相同的，但来自 Xcode 接口。有什么办法吗？提前谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:19:45.693

我知道的唯一方法是找到文件的先前版本，将内容复制到工作版本，然后提交结果。您可以使用“版本编辑器”窗格找到所有早期版本，单击“时间轴”图标，然后滚动浏览版本（比如在右侧）。在那里选择您想要的版本并复制内容。

# jquery - jquery.Load 仅在 asp.net 中有效

> ID：10721197
> 
> 赞同：0
> 
> 时间：2012-05-23T13:40:30.857
> 
> 标签：jquery, jquery-load

我对 jQuery 很陌生，不知道什么不起作用。

在以下示例中，当页面是 asp Web 应用程序的一部分时，代码可以正常工作。

但是当我在 IIS 中创建一个正常的网站时，负载不起作用。事件引发（通过警报尝试）但没有加载任何内容。

我假设 jScript ( jQuery ) 是独立的表单主机机制。我错了吗？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script src="../../Scripts/jquery-1.5.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#MyButton').click(function () {
                //Load HTML from HelpDetails.html
                $('#OutputDiv').load('../HelpDetails.html #SubTOC');
            });
        });
    </script>
</head>
<body>
    <button id="MyButton">Click to Get HTML</button>
    <div id="OutputDiv"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T13:42:42.353

**萤火虫控制台**在说什么？我能想到的唯一原因是错误的（远程）文件路径。`HelpDetails.html`确保在 jQuery 加载方法正在寻找的位置有一个文件被调用。404**错误**？

![在此处输入图像描述](../Images/0001338d080ff335a3fd6acd1dcbeba3.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T13:55:53.583

可能的问题可能是： jQuery 未加载（但如果它在某些情况下工作则不太可能）， html 未加载。要排除两者：检查浏览器中的控制台。如果您不知道为什么，请发布您使用的浏览器。此外，将您的 jQuery 链接到另一个主机的库（例如 Google 的）可能是一个更好的主意

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T13:46:28.107

您可以尝试使用 Server.MapPath("~/your-path-to-jquery") 来获取脚本的路径，可能只是找不到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T13:48:25.860

将脚本行更改为：

`<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>`

# internationalization - 从使用 haml 标记的 simple_form 中调用 I18n 翻译方法

> ID：10721203
> 
> 赞同：0
> 
> 时间：2012-05-23T13:41:02.207
> 
> 标签：internationalization, haml, translation, simple-form, i18n-gem

我正在使用 I18n gem，只是想知道如何在使用基于 haml 的 simple_form 时调用翻译方法。目前我的代码如下：

**\users\new.html.haml** - content_for :title, "Admin | Create New User" .page-header %h1 创建新用户

**/config/localses/en.yml** en：new_tenant：title：“租户管理|创建新租户”标题：“创建新租户”

**/config/localses/de.yml** de：new_tenant：title：“Mieter Administration | Create New Mieter”标题：“Erstellen Neuer Mieter”

我在 Railcasts 第 138 集中看到，这可以这样称呼：

```
<% title t('new_tenant.title') %>
<h2><%= t 'new_tenant.header' %></h2> 
```

如何将相同的方法应用于 haml 标记？任何提示将非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T05:45:18.447

干得好。

```
%title=t 'new_tenant.title' 
%h2=t 'new_tenant.header' 
```

有时您不能使用 i18n 速记**t**，在这种情况下，只需使用**I18n.t**而不是快捷方式。祝你好运。

# opencv - 使用 BlobTrackerAuto 在计算机视觉应用程序中跟踪人员

> ID：10721207
> 
> 赞同：3
> 
> 时间：2012-05-23T13:41:20.360
> 
> 标签：opencv, computer-vision, emgucv

我目前正在尝试开发一个使用 EmguCV（OpenCV Wrapper）跟踪队列中的人的系统。我首先运行并理解了我下载的 Emgu 包中的 VideoSurveilance 示例。这是我基于示例的代码：

```
 private static void processVideo(string fileName)
    {
        Capture capture = new Capture(fileName);
        MCvFont font = new MCvFont(Emgu.CV.CvEnum.FONT.CV_FONT_HERSHEY_SIMPLEX, 
            1.0, 1.0);
        BlobTrackerAuto<Bgr> tracker = new BlobTrackerAuto<Bgr>();

        //I'm using a class that I implemented for foreground segmentation
        MyForegroundExtractor fgExtractor = new MyForegroundExtractor();

        Image<Bgr, Byte> frame = vVideo.QueryFrame();
        fgExtractor.initialize(frame);

        while (frame != null)
        {
            Image<Gray, Byte> foreground = fgExtractor.getForegroundImg(frame);
            tracker.Process(frame, foreground);

            foreach (MCvBlob blob in tracker)
            {
                if (isPersonSize(blob))
                {
                    frame.Draw((Rectangle)blob, new Bgr(0, 0, 255), 3);
                    frame.Draw(blob.ID.ToString(), ref font, 
                        Point.Round(blob.Center), new Bgr(255.0, 255.0, 255.0));
                }
            }
            CvInvoke.cvShowImage("window", frame);
            CvInvoke.cvWaitKey(1);

            frame = capture.QueryFrame();
        }
    } 
```

上面的代码用于处理 AVI 视频的每一帧，并在场景中每个人周围用红色矩形显示处理后的帧。我不喜欢`IBGFGDetector<Bgr>`使用 VideoSurveilance 示例中使用的类得到的结果，所以我尝试使用我自己的前景检测器，使用 Emgu 的函数，例如 CvInvoke.cvRunningAvg()、CvInvoke.cvAbsDiff()、CvInvoke。 cvThreshold() 和 cvErode/cvDilate()。我有几个问题：

1.  视频开始时场景中已经有几个人。视频开始时，我没有得到与场景中的人相对应的斑点。
2.  有时我“失去”一个人几帧：我在一个人周围画了几秒钟/几帧的红色矩形，它消失了，过了一会儿又用不同的 ID 绘制了。
3.  正如您从示例代码中看到的那样，我检查 blob 是否可能是检查其高度和宽度的人（isPersonSize() 方法），并且仅在通过测试的那些中绘制红色矩形。我怎样才能删除那些不是人大小的？
4.  我想测量一个人在场景中停留的时间。知道 blob 何时消失的最佳方法是什么？我是否应该将我认为与人相对应的 blob 的 ID 存储在一个数组中，并在每个循环中检查每个 blob 是否仍然存在使用`tracker.GetBlobByID()`？
5.  如果我不处理循环中的每一帧，我认为我会得到更好的结果。我添加了一个计数器变量和一个 if 语句以每 3 帧处理一次：

    ```
    if (i % 3 == 0)
        tracker.Process(frame, foreground); 
    ```

我添加了 if 语句，因为程序执行速度非常慢。但是当我这样做时，我能够追踪我以前无法追踪的人。

总而言之，如果有人更习惯于 OpenCV/EmguCV 帮助我说这是否是使用 BlobTrackerAuto 跟踪人员的好方法，并帮助我解决上述问题，我将非常感激。我觉得我没有利用 EmguCV 可以提供的工具。

# web-services - tomcat webservice 信息 java

> ID：10721218
> 
> 赞同：0
> 
> 时间：2012-05-23T13:41:55.413
> 
> 标签：web-services, tomcat

我尝试在 Google 中查找并在论坛中浏览不同的问题，但找不到解决方案。我有一个 Web 服务，我想创建一个方法来返回有关该服务以及有关 tomcat 的信息。但是，我找不到如何查询 tomcat。例如，我想知道 tomcat 正在侦听哪个端口、它的 JVM 配置、内存 Perm 大小等。

谢谢，克林特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T19:27:48.393

在 conf/server.xml 中查找定义 - 您可以看到端口和线程定义。

您在 startup.sh 或 Catalina.sh 中的 JAVA_OPTS 是什么？您可以为 jmx 标志、XMx、垃圾收集标志等添加定义

将此视为示例[Tomcat jmx](http://www.gesea.de/techdocs.htm?id=67626&page=0)

然后，您还可以从 jconsole 连接到您的应用程序并查看它所公开的 tomcat jmx bean。

# java - Java 线程：使用 ArrayList 的等待通知机制

> ID：10721223
> 
> 赞同：0
> 
> 时间：2012-05-23T13:42:10.830
> 
> 标签：java, arraylist, thread-safety, wait, notify

我尝试实现等待/通知机制来修改`ArrayList`使用两个单独的线程。

第一次迭代似乎工作正常，但第二次迭代它在`addToArray()`方法中永远等待。我无法弄清楚为什么它在方法中永远等待？根据我的理解，当其他线程等待时，其他线程（删除项目）应该接起。

请查看并指出可能的错误（如果有）。我知道我可以用来`Vector`进行线程安全操作，但这不是我想要的。

```
package threadTest;
import java.util.*;

public class DhagaJava {

    public static void main(String...strings){
        ArrayModification am = new ArrayModification();

        Thread t1 = new Thread(new AddToArray(am));
        Thread t2 = new Thread(new RemoveFromArray(am));
        t1.start();
        t2.start();
    }
}

class ArrayModification{
    boolean added = false;
    ArrayList<Integer> al;

    ArrayModification(){
        al = new ArrayList<Integer>();
    }

    public synchronized void addToArrayList(int x) {
        if (added == true){
            try {
                wait();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        this.al.add(x);
        System.out.println(al);
        System.out.println("Added!! :)");
        added = true;
        notifyAll();
    }

    public synchronized void removeFromList(){
        if( added== false){
            try {
                wait();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        System.out.println(al);     
        this.al.remove(0);
        System.out.println("Removed!! :' ");
        added = false;
        notifyAll();
    }
}

class AddToArray implements Runnable{

    ArrayModification ma;

    AddToArray(ArrayModification m){
        this.ma = m;
    }

    public void run() { 
        for (int i = 0; i<10; i++)
            ma.addToArrayList(i);
    }
}

class RemoveFromArray implements Runnable{

    ArrayModification ma;

    RemoveFromArray(ArrayModification a){
        this.ma = a;
    }

    public void run(){
            ma.removeFromList();
    }
}

class RemoveFromArray implements Runnable{

      ArrayModification ma;

      RemoveFromArray(ArrayModification a){
            this.ma = a;
      }

      public void run(){
            //for(int j=11;j<20; j++)
                  ma.removeFromList();
      }
} 
```

输出是：

```
[0]
Added!! :)
[0]
Removed!! :' 
[1]
Added!! :) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T07:27:49.070

与其重新发明轮子，不如使用[`CopyOnWriteArrayList`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/CopyOnWriteArrayList.html). 它具有开箱即用的并发性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T11:13:23.490

你唯一的问题是 removeFromList 只运行一次（因为你推荐了 for 循环）。这就是日志中没有第二次删除并且 addToArrayList 开始永远等待的原因（等待有人从列表中删除该项目）。

我在删除评论后尝试了您的代码并且工作正常！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T07:19:43.150

您的 notifyAll 在同步块内。所以其他线程可能在他行动之前就被唤醒了。所以可能会被屏蔽。

我不确定我是否理解您的目标，但这种结构可能会更好：

```
public void addToArrayList(int x) {
    synchonized(this.al) {
        if (added == true){
            try {
                wait();
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
        this.al.add(x);
        System.out.println(al);
        System.out.println("Added!! :)");
        added = true;
    }
    notifyAll();
} 
```

但这非常复杂。你有更普遍的目标吗？也许只有一个线程的任务队列更适合你：它会更快、更轻、更简单，并且并行化（根本不是）。

# jquery - 在 jquery 条件下修改 Rails 模型元素

> ID：10721224
> 
> 赞同：0
> 
> 时间：2012-05-23T13:42:15.693
> 
> 标签：jquery, ruby-on-rails

我的应用程序中有一个表单，其中有一个复选框。在提交表单时，我需要查看复选框是否被选中，如果是 - 我需要修改模型的属性。这是我的代码不起作用：

```
$("#customer_submit").click(function(){
if ($("#default_check").is(':checked')){
    <%current_merchant.has_default = true
    <%current_merchant.save%>
} 
```

});

即使不满足检查，Ruby 代码也会被实现。我知道我在做一些根本错误的事情。请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T13:43:53.520

您正在将客户端脚本与服务器端代码混合。

<% %> 中的 ruby​​ 代码在代码发送到客户端之前正在执行。它周围的javascript在客户端执行。

所以实际上你正在发送这个 JavaScript 代码来执行到浏览器：

```
$("#customer_submit").click(function(){
  if ($("#default_check").is(':checked')){
  }
}); 
```

是的，你这样做从根本上是错误的:)

您真正想要做的是将 AJAX 调用或某种其他形式的消息发送回服务器以将模型更改保留在那里。

# ruby-on-rails - Rails - 使用功能测试测试 JSON API

> ID：10721225
> 
> 赞同：7
> 
> 时间：2012-05-23T13:42:17.457
> 
> 标签：ruby-on-rails, ruby, unit-testing, testing, ruby-on-rails-3.1

我只有一个简单的问题，但我找不到任何答案。

我的 ruby​​ on rails 3.2.2 appilcation 有一个带有设计会话身份验证的 JSON API。

我的问题是：**如何使用功能或集成测试来测试这个 API - 有没有办法处理会话？**

我没有前端，只有一个可以 GET 的 API。邮政。放。并使用 JSON 正文删除。

测试这个自动化的最好方法是什么？

**示例创建新用户**

发布 www.exmaple.com/users

```
{
 "user":{
    "email" : "test@example.com",
    "password " : "mypass"
  }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-23T14:13:33.823

功能测试很容易做到。在用户示例中，我会将它们放入`spec/controllers/users_controller_spec.rb`Rspec 中：

```
 require 'spec_helper'

 describe UsersController do
   render_views # if you have RABL views

   before do
     @user_attributes = { email: "test@example.com", password: "mypass" }
   end

   describe "POST to create" do

     it "should change the number of users" do
        lambda do
          post :create, user: @user_attributes
        end.should change(User, :count).by(1)
     end

     it "should be successful" do
       post :create, user: @user_attributes
       response.should be_success
     end

     it "should set @user" do
       post :create, user: @user_attributes
       assigns(:user).email.should == @user_attributes[:email]
     end

     it "should return created user in json" do # depend on what you return in action
       post :create, user: @user_attributes
       body = JSON.parse(response.body)
       body["email"].should == @user_attributes[:email]
      end
  end 
```

显然，您可以优化上述规格，但这应该可以帮助您入门。干杯。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T14:52:27.033

查看 Anthony Eden 的演讲[“使用 Ruby 和 Cucumber 构建和测试 API”](http://www.confreaks.com/videos/2141-arrrrcamp2011-build-and-test-apis-with-ruby-and-cucumber)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T19:06:12.153

您可以使用 Cucumber(BDD) 来测试这种情况，例如：

```
Feature: Successful login
  In order to login
  As a user 
  I want to use my super API

  Scenario: List user
    Given the system knows about the following user:
      | email            | username |
      | test@example.com | blabla   |
    When the user requests POST /users
    Then the response should be JSON:
    """
    [
      {"email": "test@example.com", "username": "blabla"}
    ]
    """ 
```

然后，您只需要编写步骤，其中[pickle](https://www.google.kg/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CFgQFjAA&url=https://github.com/ianwhite/pickle&ei=_jS9T7_jMsHqOYuavCk&usg=AFQjCNEIVrgJYG7P4BCrPxMpiqFLg4t9zQ) gem 会非常有用

# javascript - 如何判断后退/前进按钮是否触发了 Spotify 应用程序中的 argumentsChanged 事件？

> ID：10721228
> 
> 赞同：1
> 
> 时间：2012-05-23T13:42:32.733
> 
> 标签：javascript, spotify

我正在使用[应用程序 URI](https://developer.spotify.com/technologies/apps/guidelines/#applicationuris)和`argumentsChanged`事件来触发我的 Spotify 应用程序中的页面呈现。页面被重新渲染，被scolled 到页面的顶部。对于仅使用链接和侧边栏等浏览，这是有道理的。

但是，本机的后退和前进按钮会触发相同的事件。如果用户单击后退按钮，我不想重置页面并滚动到顶部 - 我想恢复以前的状态，就像在普通浏览器中发生的那样。

如何区分这两种类型的导航？

# php - 对于大于 100 Kb 的文件，php 上传脚本会产生错误 500

> ID：10721234
> 
> 赞同：1
> 
> 时间：2012-05-23T13:42:46.260
> 
> 标签：php, file-upload

我有以下 php 脚本

```
<?php

  if ($_FILES["file"]["error"] > 0)
    {
    echo "Return Code: " . $_FILES["file"]["error"] . "<br />";
    }
  else
    {
    echo "Upload: " . $_FILES["file"]["name"] . "<br />";
    echo "Type: " . $_FILES["file"]["type"] . "<br />";
    echo "Size: " . ($_FILES["file"]["size"] / 1024) . " Kb<br />";
    echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br />";

    if (file_exists("upload/" . $_FILES["file"]["name"]))
      {
      echo $_FILES["file"]["name"] . " already exists. ";
      }
    else
      {
      move_uploaded_file($_FILES["file"]["tmp_name"],
      "upload/" . $_FILES["file"]["name"]);
      echo "Stored in: " . "upload/" . $_FILES["file"]["name"];
      }
    }

?> 
```

谁能帮助它上传大于 100 Kb 左右的 pdf 文件？

我已经与我的托管服务提供商核对过，那里的一切都是正确的，我还检查了 phpinfo()，它指出应该允许上传到 8 Mb

任何人都可以帮助我指出正确的方向来解决这个问题，我的托管服务提供商建议我创建一个 php.ini 文件，但是想要它需要包含允许上传的命令吗？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T13:47:18.063

这里有一个小提示，您可以使用表单的文件字段和 PHP 中的 move_uploaded_file() 函数来上传如此大的文件。

1) 在 Web 服务器的根文件夹中创建一个 .htaccess 文件。

2) 将以下代码放在 .htaccess 文件中并保存。

```
php_value upload_max_filesize 8M
php_value post_max_size 8M
php_value max_execution_time 200
php_value max_input_time 200 
```

现在，您可以使用 html 表单中的文件字段和 PHP 中可用的 move_uploaded_file() 函数以简单的方式上传最大 8MB 的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T13:47:43.523

对于 1Mb。

在您的本地 php.ini 中：

```
upload_max_filesize = 1M
post_max_size = 1M 
```

如果不起作用，请添加到根目录中的 .htaccess 文件中。

```
php_value upload_max_filesize 1M
php_value post_max_size 1M 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T13:49:41.837

首先尝试 Query Master 的响应 - 这应该可以保证设置是正确的。如果这不能解决问题，那么，如果您收到 500 错误，则需要检查错误日志以找出问题的实际原因。

如果您无法检查错误日志，请在 PHP 文件的顶部添加

```
error_reporting(E_ALL);
ini_set('display_errors', 'on'); 
```

这会将问题归还给您。

请记住删除实时应用程序的这些行（您不应该向最终用户透露错误，因为它展示了可能被利用的弱点）。

# macos - 内联汇编 - AT&T 语法 - LLVM 编译错误（虽然不是 w/GCC）

> ID：10721237
> 
> 赞同：1
> 
> 时间：2012-05-23T13:43:03.877
> 
> 标签：macos, assembly, inline-assembly, att

所以我试图在我的 Objective-C 可执行文件中包含这个程序集：

```
__asm volatile(
               "pushl %[a5]\n\t"
               "pushl %[a4]\n\t"
               "call %%ebx\n\t"
               "addl  $8, %%esp\n\t"               
               : "=a" (result)
               :  "b" (FuncPtr), "a" (MyVal), "d" (MyVal2), "c" (MyVal3), [a5] "r" (iOut), [a4] "r" (a4)
               : "memory"
               ); 
```

如果我使用 GCC 编译器，它编译得很好，但是在使用上述函数返回时，由于 GCC 抛出了一个很好的 ud2a 指令而不是在编译时抛出一个错误（在 gdb 中捕获），所以会抛出一个错误。

如果我使用 Apple LLVM 编译器，它会对我大喊“push %[a4]\n\t”这行错误：“Unknown use of instruction mnemonic without a size suffix”

有谁知道这意味着什么？我完全不知道如何调整上述内容才能正常运行。

注意：这是它试图做的：将 a5、a4 压入堆栈。将 FuncPtr 移至 ebx，将 MyVal 移至 eax，将 MyVal2 移至 edx，将 MyVal3 移至 ecx，然后调用 ebx。

# spring - REST CXF 和 Spring cxf-extension-jaxrs-binding 文件未找到异常？

> ID：10721243
> 
> 赞同：8
> 
> 时间：2012-05-23T13:43:50.957
> 
> 标签：spring, rest, cxf, java-io

**我正在尝试使用 CXF 2.6.0 和 spring 2.5.6 开发 REST Web 服务，我在 pom.xml 中的 CXF maven 依赖项是：**

```
<dependency>
  <groupId>org.apache.cxf</groupId>
        <artifactId>cxf-rt-rs-extension-providers</artifactId>
  <version>2.6.0</version>
   </dependency>

<dependency>
  <groupId>org.apache.cxf</groupId>
        <artifactId>cxf-rt-rs-extension-search</artifactId>
  <version>2.6.0</version>
</dependency> 
```

**我正在使用 Spring 2.5.6，并且我已经在 applicationcontext.xml spring 文件中声明了我的 Web 服务：**

```
<jaxrs:server id="restContainer" address="/sav">
    <jaxrs:serviceBeans>
        <ref bean="wssav"/>
    </jaxrs:serviceBeans>
</jaxrs:server>

 <import resource="classpath:META-INF/cxf/cxf.xml"/>
<import resource="classpath:META-INF/cxf/cxf-extension-jaxrs-binding.xml"/>
<import resource="classpath:META-INF/cxf/cxf-servlet.xml"/> 
```

**我已经通过以下代码将我的 Web 服务声明为 web.xml 文件：**

```
<servlet>
    <servlet-name>CXFServlet</servlet-name>

    <servlet-class>
        org.apache.cxf.transport.servlet.CXFServlet
    </servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>CXFServlet</servlet-name>
    <url-pattern>/rest/*</url-pattern>
</servlet-mapping> 
```

**当我在 tomcat 上部署我的项目时，我在 applicationcontext.xml 文件中的第二个导入文件中遇到了这个异常：**

```
 java.io.FileNotFoundException: class path resource [META-INF/cxf/cxf-extension-jaxrs-binding.xml] cannot be opened because it does not exist 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-23T14:13:30.660

据此，cxf > 2.4.x 不再需要此文件[。](https://stackoverflow.com/a/6352007/320180)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-06T07:49:25.137

Try removing the line that imports cxf-extension-jaxrs-binding.xml. The other 2 xml files are in the cxf-X.Y.Z.jar. For me that is cxf-2.7.7.jar.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T14:28:18.657

我也得到了完全相同的错误。我得到的错误是 -

```
IOException parsing XML document from class path resource [META-INF/cxf/cxf-extension-jaxrs-binding.xml]; 
nested exception is java.io.FileNotFoundException: 
class path resource [META-INF/cxf/cxf-extension-jaxrs-binding.xml] cannot be opened because it does not exist. 
```

**即使我读到更新版本的 cxf 除了cxf-rt-frontend-jaxrs**之外不需要任何东西。收到这些错误后，我在我的 pom 文件中添加了以下依赖项，但它们没有帮助 -

```
<dependency>
    <groupId>org.apache.cxf</groupId>
    <artifactId>cxf-rt-frontend-jaxrs</artifactId>
    <version>2.6.2</version>
</dependency>
<dependency>
    <groupId>org.apache.cxf</groupId>
    <artifactId>cxf-rt-rs-extension-providers</artifactId>
    <version>2.6.2</version>
</dependency>
<dependency>
    <groupId>org.apache.cxf</groupId>
    <artifactId>cxf-rt-rs-extension-search</artifactId>
    <version>2.6.2</version>
</dependency> 
```

我也不明白为什么几乎所有详细说明使用 CXF 构建 REST 服务的步骤的教程都希望您在 spring 配置中包含以下 3 行的原因（当我无法在任何地方找到这些文件时） -

```
<import resource="classpath:META-INF/cxf/cxf.xml"/>
<import resource="classpath:META-INF/cxf/cxf-extension-jaxrs-binding.xml"/>
<import resource="classpath:META-INF/cxf/cxf-servlet.xml"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-11T11:20:42.413

文件 META-INF/cxf/cxf-extension-jaxrs-binding.xml 在以下工件中可用。

```
<groupId>org.apache.cxf</groupId>
<artifactId>cxf-rt-frontend-jaxrs</artifactId>
<version>2.2.7</version> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-07T18:59:45.383

在 applicationContext.xml 中，注释掉以下导入在 cxf 3.1.10 中对我有用。导入资源="classpath:META-INF/cxf/cxf-extension-jaxrs-binding.xml

# jquery - AJAX 发布到 Python cgi

> ID：10721244
> 
> 赞同：5
> 
> 时间：2012-05-23T13:43:51.857
> 
> 标签：jquery, python, html, ajax

> **可能重复：**
> [将 JSON 发布到 Python CGI](https://stackoverflow.com/questions/10718572/post-json-to-python-cgi)

我已经安装了 Apache2 并且 Python 正在工作。

我有一个问题。我有两页。

一个是 Python 页面，另一个是带有 JQuery 的 Html 页面，我无法将 Src 粘贴到 google jquery 链接。

有人可以告诉我如何让我的 ajax 帖子正常工作。

```
 $(function()
    {
        alert('Im going to start processing');

        $.ajax({
            url: "saveList.py",
            type: "post",
            data: {'param':{"hello":"world"}},
            dataType: "application/json",
            success : function(response)
            {
                alert(response);
            }
        });
    }); 
```

和 Python 代码

```
import sys
import json

def index(req):
    result = {'success':'true','message':'The Command Completed Successfully'};

    data = sys.stdin.read();

    myjson = json.loads(data);

    return str(myjson); 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-23T17:18:42.537

这是一个示例 html 文件和随附的 python CGI 脚本，它应该可以帮助您：

使用这个 html：

```
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8">

        <title>test</title>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script>

            $(function()
            {
                $('#clickme').click(function(){
                    alert('Im going to start processing');

                    $.ajax({
                        url: "/scripts/ajaxpost.py",
                        type: "post",
                        datatype:"json",
                        data: {'key':'value','key2':'value2'},
                        success: function(response){
                            alert(response.message);
                            alert(response.keys);
                        }
                    });
                });
            });

        </script>
    </head>
    <body>
        <button id="clickme"> click me </button>
    </body>

</html> 
```

这个脚本：

```
#!/usr/bin/env python

import sys
import json
import cgi

fs = cgi.FieldStorage()

sys.stdout.write("Content-Type: application/json")

sys.stdout.write("\n")
sys.stdout.write("\n")

result = {}
result['success'] = True
result['message'] = "The command Completed Successfully"
result['keys'] = ",".join(fs.keys())

d = {}
for k in fs.keys():
    d[k] = fs.getvalue(k)

result['data'] = d

sys.stdout.write(json.dumps(result,indent=1))
sys.stdout.write("\n")

sys.stdout.close() 
```

点击按钮后可以看到cgi脚本返回：

```
{
 "keys": "key2,key", 
 "message": "The command Completed Successfully", 
 "data": {
  "key2": "value2", 
  "key": "value"
 }, 
 "success": true
} 
```

# bash - 这行 bash 脚本中句号的结果是什么？

> ID：10721246
> 
> 赞同：3
> 
> 时间：2012-05-23T13:43:54.390
> 
> 标签：bash

我正在计算集群上运行生物信息学 Web 应用程序，并且正在尝试解决一些问题。webapp 运行一个预定义的 shell 脚本，该脚本传递集群计算参数（存储在`defaultJobRunner.sh`运行计算密集型工作之前命名的文件中。

对于创建的每个作业，都会创建一个随附的 shell 脚本，其中包含以下行：

```
[ -f "/home/galaxy/defaultJobRunner.sh" ] && . /home/galaxy/defaultJobRunner.sh 
```

我理解这是“如果方括号中的文件是常规文件，则运行它”的缩写形式。我不明白的是和之间的那个时期的功能或`&&`意义`/home/galaxy/defaultJobRunner.sh`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T13:47:06.920

它是 的缩写`source`。它的运行`/home/galaxy/defaultJobRunner.sh`就像每一行都输入到当前会话中一样。（[来源](http://ss64.com/bash/period.html)）

# c# - C# 增量数组

> ID：10721247
> 
> 赞同：7
> 
> 时间：2012-05-23T13:43:57.800
> 
> 标签：c#, arrays, optimization, loops, increment

如果我想生成一个从 1 到 6 并以 0.01 递增的数组，那么最有效的方法是什么？

我想要的是一个数组，最小值和最大值稍后会发生变化......就像这样：`x[1,1.01,1.02,1.03...]`

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-23T13:51:20.983

Assuming a `start`, `end` and an `increment` value, you can abstract this further:

```
Enumerable
    .Repeat(start, (int)((end - start) / increment) + 1)
    .Select((tr, ti) => tr + (increment * ti))
    .ToList() 
```

Let's break it down:

`Enumerable.Repeat` takes a starting number, repeats for a given number of elements, and returns an enumerable (a collection). In this case, we start with the `start` element, find the difference between `start` and `end` and divide it by the `increment` (this gives us the number of increments between `start` and `end`) and add one to include the original number. This should give us the number of elements to use. Just be warned that since the `increment` is a decimal/double, there might be rounding errors when you cast to an int.

`Select` transforms all elements of an enumerable given a specific selector function. In this case, we're taking the number that was generated and the index, and adding the original number with the index multiplied by the increment.

Finally, the call to `ToList` will save the collection into memory.

If you find yourself using this often, then you can create a method to do this for you:

```
public static List<decimal> RangeIncrement(decimal start, decimal end, decimal increment)
{
    return Enumerable
        .Repeat(start, (int)((end - start) / increment) + 1)
        .Select((tr, ti) => tr + (increment * ti))
        .ToList()
} 
```

Edit: Changed to using Repeat, so that non-whole number values will still be maintained. Also, there's no error checking being done here, so you should make sure to check that `increment` is not 0 and that `start` < `end * sign(increment`). The reason for multiplying end by the sign of increment is that if you're incrementing by a negative number, end should be before start.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-23T13:50:38.043

最简单的方法是使用[`Enumerable.Range`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.range.aspx)：

```
double[] result = Enumerable.Range(100, 500)
                  .Select(i => (double)i/100)
                  .ToArray(); 
```

（因此在可读性和代码行方面很有效）

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-23T14:07:14.557

I would just make a simple function.

```
 public IEnumerable<decimal> GetValues(decimal start, decimal end, decimal increment)
    {
        for (decimal i = start; i <= end; i += increment)
            yield return i;
    } 
```

Then you can turn that into an array, query it, or do whatever you want with it.

```
 decimal[] result1 = GetValues(1.0m, 6.0m, .01m).ToArray();
        List<decimal> result2 = GetValues(1.0m, 6.0m, .01m).ToList();
        List<decimal> result3 = GetValues(1.0m, 6.0m, .01m).Where(d => d > 3 && d < 4).ToList(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-23T13:50:49.597

使用增量为 0.01 的 for 循环：

```
List<decimal> myList = new List<decimal>();

for (decimal i = 1; i <= 6; i+=0.01)
{
  myList.Add(i);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-23T13:51:27.077

**Elegant**

```
double[] v = Enumerable.Range(1, 600).Select(x => x * 0.01).ToArray(); 
```

**Efficient**

```
Use for loop 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-23T13:48:56.703

无论您做什么，都不要使用浮点数据类型（如`double`），它们不适用于代表舍入行为的此类事情。选择 a`decimal`或带有因子的整数。对于后者：

```
Decimal[] decs = new Decimal[500];
for (int i = 0; i < 500; i++){
  decs[i] = (new Decimal(i) / 100)+1 ;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-28T09:53:06.017

You could solve it like this. The solution method returns a double array

```
double[] Solution(double min, int length, double increment)
{
    double[] arr = new double[length];
    double value = min;
    arr[0] = value;
    for (int i = 1; i<length; i++)
    {
        value += increment;
        arr[i] = value;
    }
    return arr;
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-05-23T13:50:46.330

```
var ia = new float[500]; //guesstimate
var x = 0;
for(float i =1; i <6.01; i+= 0.01){
    ia[x] = i;
    x++;
} 
```

你可以多线程来提高速度，但除非你计划在一个非常慢的处理器上运行它，否则它可能不值得开销。

# c# - 按百分比从我的数据库中获取当月的所有记录

> ID：10721254
> 
> 赞同：-4
> 
> 时间：2012-05-23T13:44:30.827
> 
> 标签：c#

我正在使用 VS2010 为我的应用程序构建报告。
我的数据库有两个表：Users 和clinical_data。Users 表有一个名为：Gender、
PatientRegistrationNo 的列，Clinical_data 表包含列：RegistrationNo。对于退出用户表并为
他或她拥有临床数据存储的每个注册用户，我希望我的查询显示：
男性和女性的总数，当前日期男性和女性的百分比：这是我的查询，但不是为我工作：

```
 select COUNT(gender )  From Bio_Data
where  DateCreated = ADDDATE(GETDATE()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:05:31.367

我认为以下查询将帮助您获得结果

```
SELECT ( Sum(CASE 
               WHEN Gender = 'm' THEN 1.0 
               ELSE 0 
             END) / Count(*) ) * 100 AS male_percent, 
       ( Sum(CASE 
               WHEN Gender = 'f' THEN 1.0 
               ELSE 0 
             END) / Count(*) ) * 100 AS female_percent, 
       Sum(CASE 
             WHEN Gender = 'm' THEN 1.0 
             ELSE 0 
           END) / Sum(CASE 
                        WHEN Gender = 'f' THEN 1.0 
                        ELSE 0 
                      END)           AS ratio, 
       Sum(1)                        AS total_Male_Female 
FROM   Users 
       INNER JOIN Clinical_data 
         ON Users.RegistrationNo = Clinical_data.RegistrationNo 
```

# java - 在非映射元素上产生 JAXB 错误

> ID：10721257
> 
> 赞同：8
> 
> 时间：2012-05-23T13:44:40.730
> 
> 标签：java, xml, jaxb

我正在尝试做相反的事情：[JAXB - Ignore element](https://stackoverflow.com/questions/5044042/jaxb-ignore-element)

**那就是我正在尝试将带有 JAXB 的 XML 解析为 POJO，如果它没有**为给定元素找到匹配的 Java 属性，我希望 JAXB 失败。我知道我可能可以进行模式验证，但我宁愿不这样做。

例子：

```
@XmlRootElement(name="Dog")
public class Dog {
    private String name;
    public String getName() {return name;}
    public String setName(String name) {this.name = name};
} 
```

此 XML 将失败：

```
<Dog>
<id>blah</id>
<name>Stuff</name>
</Dog> 
```

因为没有`id`Java 属性

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T17:39:14.590

您可以利用 a`ValidationEventHandler`来获得您正在寻找的行为。意外元素被视为默认情况下忽略的警告。为了支持您的用例，您可以提供一个`ValdidationEventHandler`失败的警告（见下文）。

**演示**

```
package forum10721257;

import java.io.File;
import javax.xml.bind.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Dog.class);

        File xml = new File("src/forum10721257/input.xml");
        Unmarshaller unmarshaller = jc.createUnmarshaller();
        unmarshaller.setEventHandler(new ValidationEventHandler () {

            @Override
            public boolean handleEvent(ValidationEvent event) {
                return false;
            }

        });
        Dog dog = (Dog) unmarshaller.unmarshal(xml);
    }

} 
```

**JAXB RI 异常**

```
Exception in thread "main" javax.xml.bind.UnmarshalException: unexpected element (uri:"", local:"id"). Expected elements are <{}name>
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallingContext.handleEvent(UnmarshallingContext.java:647)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.Loader.reportError(Loader.java:243)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.Loader.reportError(Loader.java:238)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.Loader.reportUnexpectedChildElement(Loader.java:105)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.Loader.childElement(Loader.java:90)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.StructureLoader.childElement(StructureLoader.java:236)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallingContext._startElement(UnmarshallingContext.java:483)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallingContext.startElement(UnmarshallingContext.java:465)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.SAXConnector.startElement(SAXConnector.java:135)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.startElement(AbstractSAXParser.java:506)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanStartElement(XMLNSDocumentScannerImpl.java:376)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2715)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:607)
    at com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.next(XMLNSDocumentScannerImpl.java:116)
    at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:488)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:835)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:764)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:123)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(AbstractSAXParser.java:1210)
    at com.sun.org.apache.xerces.internal.jaxp.SAXParserImpl$JAXPSAXParser.parse(SAXParserImpl.java:568)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(UnmarshallerImpl.java:202)
    at com.sun.xml.internal.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal(UnmarshallerImpl.java:174)
    at javax.xml.bind.helpers.AbstractUnmarshallerImpl.unmarshal(AbstractUnmarshallerImpl.java:157)
    at javax.xml.bind.helpers.AbstractUnmarshallerImpl.unmarshal(AbstractUnmarshallerImpl.java:162)
    at javax.xml.bind.helpers.AbstractUnmarshallerImpl.unmarshal(AbstractUnmarshallerImpl.java:171)
    at javax.xml.bind.helpers.AbstractUnmarshallerImpl.unmarshal(AbstractUnmarshallerImpl.java:189)
    at forum10721257.Demo.main(Demo.java:26) 
```

**EclipseLink JAXB (MOXy)**

我们最近将此行为添加到 MOXy。您将需要使用 EclipseLink 2.4.0 或 2.3.3。可以从以下位置获得夜间构建：

*   [http://www.eclipse.org/eclipselink/downloads/nightly.php](http://www.eclipse.org/eclipselink/downloads/nightly.php)

* * *

**更新**

我需要`Dog`根据您的问题调整课程。下面是我用的。

**狗**

```
package forum10721257;

import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement(name="Dog")
public class Dog {
    private String name;
    public String getName() {return name;}
    public void setName(String name) {this.name = name;}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T17:29:51.047

我能够验证缺少的 Java 属性（无模式）的唯一方法是将 XML 解组为我的 POJO，然后使用相同的 POJO 将其重新编组为 XML 并进行比较。

下面是一个使用 XMLUnit 的示例，它有助于忽略顺序和空格问题。

```
@Test
public void testSerialization() throws Exception {
    XMLUnit.setIgnoreWhitespace(true);

    EventSearchResults r = 
            JAXB.unmarshal(getClass().getResourceAsStream("/EventSearchResults.xml"), 
                    EventSearchResults.class);
    StringWriter sw = new StringWriter();
    JAXB.marshal(r, sw);
    String expected = 
            IOUtils.toString(getClass().getResourceAsStream("/EventSearchResults.xml"), "UTF-8");
    String actual = sw.toString();
    //System.out.println(expected);
    System.out.println(actual);
    assertXMLEqual(expected, actual);
} 
```

这并不理想，但在大多数情况下适用于单元测试。

# java - 不同的应用程序签名问题android？

> ID：10721263
> 
> 赞同：3
> 
> 时间：2012-05-23T13:44:48.390
> 
> 标签：java, android, installation, uninstallation

在我的项目中，我创建了一个应用程序，现在当我尝试安装新应用程序时，它会要求**完全卸载该应用程序。**以前的应用程序，但我不能做同样的事情，因为我要**重用以前的应用程序留下的数据，**我不能修复**不同的应用程序签名。**问题我可以在不卸载的情况下将其安装到设备上。

> `I'm to retain application data`

```
[2012-05-23 19:09:56 - iCam] Re-installation failed due to different application signatures.
[2012-05-23 19:09:56 - iCam] You must perform a full uninstall of the application. WARNING: This will remove the application data!
[2012-05-23 19:09:56 - iCam] Please execute 'adb uninstall iCam.Cam' in a shell.
[2012-05-23 19:09:56 - iCam] Launch canceled! 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T13:54:22.887

您需要安装与设备上已有的签名相同的应用程序。

您将需要确定应用程序是如何安装在设备上的。你至少有两个选择：

*   使用来自 Eclipse 的默认调试签名密钥（密钥`androiddebugkey`库中的密钥`~/.android/debug.keystore`）
*   在文件->导出期间使用了其他密钥库...

如果您使用在`bin`目录中生成的二进制文件（或直接从 Eclipse 安装的 apk），则使用默认密钥库，并且要创建兼容的 apk，您需要找到在创建第一个 apk 时位于此位置的相同文件：`~/.android/debug.keystore`. 然后使用`File->Export...`并选择此文件。输入`android`密码，再次选择`androiddebugkey`并输入`android`密码。最后选择目标 apk 名称并单击`Finish`。

如果无法找到以前的签名密钥，您可以尝试：

*   备份应用程序数据
*   卸载应用程序
*   安装具有不同签名的应用程序（现在它成功了）
*   安装回应用程序数据

可以使用 TitaniumBackup 应用程序备份和恢复应用程序数据。它可能需要有根设备。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T13:48:41.697

//使用-r通过命令提示符安装，通过保留其数据重新安装

```
adb install -r ./yourfolder/MyCam.apk 
```

//adb 安装选项

```
adb install [-l] [-r] [-s] <file> - push this package file to the device and install it
                                 ('-l' means forward-lock the app)
                                 ('-r' means reinstall the app, keeping its data)
                                 ('-s' means install on SD card instead of internal storage) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T13:48:57.217

您必须使用与您上次构建时签署的相同签名。如果您在 Eclipse 中重置了调试签名，或者您使用新的发布密钥对应用程序进行了签名，那么您将无法更新。解决此问题的唯一方法是使用与上次 AFAIK 签署的相同密钥。

但是，在 DDMS 中，您可以从 SD 卡中提取数据，卸载应用程序，重新安装，然后将数据放回原处。我从未尝试过，但我认为这可能是您唯一的选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T13:53:25.587

我有同样的问题。幸运的是，我在这个应用程序中有一个“to-file”备份功能。您需要相同的签名。你使用调试密钥库吗？对于现实世界的使用，这不是一个好主意。您需要使用与原始创建者相同的调试密钥。

# c++ - C++ 在退出 WINAPI 之前将控制台输出保存到文本文件（无 MFC）

> ID：10721264
> 
> 赞同：2
> 
> 时间：2012-05-23T13:44:48.793
> 
> 标签：c++, winapi, file-io, console

我试图让我的程序在退出之前将控制台应用程序的输出记录到文本文件中。这是一个启动控制台应用程序 (tool.exe) 的 GUI 程序。问题是我正在使用 CTRL + C 退出控制台应用程序。此控制台应用程序也无法更改。我尝试了几种方法，但似乎都没有奏效（ tool.exe > output.txt ）。

谁能指出我采取哪种方法的正确方向？这将不胜感激。

**编辑：**

该文件已创建，但它是空的并且不接收任何数据。不过，我注意到的是，如果我自己从命令行运行该工具，它将起作用。例如。`c:\>tool.exe > output.txt`但是，当它从我的 GUI 应用程序执行时，这不起作用。

这是我用来执行该工具的代码：

```
 strcpy (tool, "\" start /D \"");
    strcat (tool, toolLocation);
    strcat (tool, "\" tool.exe > output.txt\"");
    system (tool); 
```

这将运行 tool.exe 并正常创建 output.txt，但不会向文件输出任何内容。

**编辑2：**

我认为实际发生的事情是因为我正在使用`start`，所以`>output.txt`正在输出`start`而不是`tool.exe`. 这可以解释为什么它会创建空文件。Start 只是运行一个新的命令行，然后运行`tool.exe`​​. 问题是，我现在该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:57:36.863

尝试：

```
#include <signal.h>
void signal_handlerkill(int sig)
{
  //Do Soemthing
  exit(1);
}

int main()
{
  signal(SIGINT, signal_handlerkill); //Connect the interrupt signal (^C) to the function
  //Do your code here
  return 0;
} 
```

如果这不起作用，我建议看[这里](http://msdn.microsoft.com/en-us/library/xdkz3x12%28v=vs.80%29.aspx)。具体来说：

```
// crt_signal.c
// compile with: /c
// Use signal to attach a signal handler to the abort routine
#include <stdio.h>
#include <stdlib.h>
#include <signal.h>
#include <tchar.h>

void SignalHandler(int signal)
{
    printf("Application aborting...\n");
}

int main()
{
    typedef void (*SignalHandlerPointer)(int);

    SignalHandlerPointer previousHandler;
    previousHandler = signal(SIGABRT, SignalHandler);

    abort();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T15:26:32.997

如果您在不重定向到文件的情况下运行应用程序，当您按 ctrl+c 时，您是否在控制台上看到了所需的输出？

如果您不这样做，那么您无能为力，因为您无法更改应用程序。

**更新**

您需要将 stdout 和 stderr 重定向到文件。我从来没有这样做过，但 jamesdlin 似乎已经这样做了。看看他的评论。

您可以尝试的是直接使用`start`try using而不是`cmd.exe`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T08:59:33.100

这是设法为我解决问题的代码：

```
 char path[500]; //Create character array
            strcpy (path, "cd "); //Copy 'cd' into the array
            strcat (path, toolLocation); //Copy the path of the tool into the array
            strcat (path, " & ip.exe > output.txt"); //Append on the name of the exe and output to a file
            system (path); //Run the built array 
```

我正在创建一个字符数组，然后附加到它。这里最重要的一点是`&`在系统调用中使用。这是在执行 .exe 之前作为`and`第一次 cd'ing 到 firectory 工作。

# c++ - 调用 RevokeDragDrop 后，“OLE 应用程序调用了为不同线程编组的接口”是什么意思？

> ID：10721269
> 
> 赞同：2
> 
> 时间：2012-05-23T13:45:01.500
> 
> 标签：c++, com, ole

我仍在试图找出[这个问题](https://stackoverflow.com/questions/10697991/hooking-explorer-drag-drop-fails)的答案。我会很感激朝着正确的方向轻推（因为我在 OLE 方面的经验很少）。有没有人在调用 RevokDragDrop 后遇到过类似的错误？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T13:50:30.017

您将封送接口传递到不同的公寓。调用方法的尝试揭示了这一点，并且调用因该错误而中止`RPC_E_WRONG_THREAD`。

您应该小心在多个线程上使用接口指针。如果您打算使用已经从不同线程中保存的指针，则必须考虑是否允许或需要显式编组/解组指针以供此类使用，例如使用`CoMarshalInterThreadInterfaceInStream`函数。

我想问题的根源是`GetProp`/ `SetProp`API used。这些存储原始指针，因为它们不需要在途中进行封送处理。

# php - 将数据从php中的数组插入mysql

> ID：10721270
> 
> 赞同：0
> 
> 时间：2012-05-23T13:45:08.513
> 
> 标签：php, mysql, sql, arrays

我有一个带有两列&`test`的表名的数据库。我下面的代码有什么问题？我无法将数组添加到我的数据库`table``user``email``$u`

```
<?php
    $con = mysql_connect("localhost","root","");
    if (!$con)
      {
      die('Could not connect: ' . mysql_error());
      }

    mysql_select_db("test", $con);

    $user = "safwan";
    $email = "esafw@jdjd.com";

    $u = array ( user => $user,
                    email => $email
                   );

    $q =   "INSERT INTO table  VALUES ($u)";

    mysql_query($q) OR die(mysql_error());

    mysql_close($con);
    ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T13:48:00.953

你有几个问题：

1.  您正在尝试将数组直接插入到数据库中。您需要单独访问这些值。

2.  您应该在字符串周围使用引号，包括它们何时是数组中的键

3.  你需要了解 SQL 注入

4.  您应该考虑从 mysql_* 函数迁移出去，因为[它们很快就会消失。](https://chat.stackoverflow.com/transcript/message/3656047#3656047)

5.  table 是 MySQL 关键字，如果它实际上是表名，则需要反引号

    $user, 'email' => $email ); $q = "INSERT INTO table (user, email) VALUES ('".mysql_real_escape_string($u['user'])."', '".mysql_real_escape_string($u['email'])."')"; mysql_query($q) 或死(mysql_error()); mysql_close($con); ?>

或者：

```
<?php
    $con = mysql_connect("localhost","root","");
    if (!$con)
      {
      die('Could not connect: ' . mysql_error());
      }

    mysql_select_db("test", $con);

    $user = "safwan";
    $email = "esafw@jdjd.com";

    $q =   "INSERT INTO table (user, email) VALUES ('".mysql_real_escape_string($user)."', '".mysql_real_escape_string($email)."')";

    mysql_query($q) OR die(mysql_error());

    mysql_close($con);
    ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T13:47:45.410

请查看 MySQL 数据类型。[http://dev.mysql.com/doc/refman/5.5/en/data-types.html](http://dev.mysql.com/doc/refman/5.5/en/data-types.html)

您必须遍历数组并单独添加元素。我还建议使用其他东西，例如 MySQLi 或 PDO 来确保安全[http://php.net/manual/en/book.pdo.php](http://php.net/manual/en/book.pdo.php)

事实上，使用 PDO，您可以“添加数组”（因为它的设计方式）。

```
$dbh = new PDO('mysql:host=localhost;dbname=test', $user, $pass);
$stmt = $dbh->prepare("SELECT * FROM REGISTRY where name=? AND password=?);
$stmt->execute(array($_GET['username'], $_GET['password'])); 
```

我不会介绍太多细节，因为你真的应该学习其中一种新技术。使用准备好的语句和 SQL 注入等东西更安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T13:48:18.480

尝试回显您的查询。它看起来像：

```
"INSERT INTO table  VALUES (array)". 
```

肯定是你不想要的。

您可以通过遍历数组或直接使用来构造插入查询：

```
INSERT INTO table  VALUES ($user, $email) 
```

# iphone - 阅读推文中 HTML 链接的内容

> ID：10721273
> 
> 赞同：1
> 
> 时间：2012-05-23T13:45:21.650
> 
> 标签：iphone, ios, parsing

我正在开发一个新的应用程序，它将从 twitter 读取数据。我可以成功阅读推文，但如果推文有链接，则应用程序应该读取该链接的内容（该链接上的页面内容）并显示它而不是推文内容（就像 FLIPBOARD APP 中发生的那样）。

是否有任何课程可以自动执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T13:50:16.423

没有任何内置功能可以为您自动预览，但是您始终可以在收到推文时扫描链接，然后触发一些异步 NSURLConnections 以获取网站内容，完成后将其添加到推文中。

# apache-poi - 带有 xlsx (XSSF) 的 POI OutOfMemory 异常

> ID：10721279
> 
> 赞同：2
> 
> 时间：2012-05-23T13:45:56.970
> 
> 标签：apache-poi, xlsx, out-of-memory

我们正在尝试将 POI 3.8 用于我们应用程序中的 excel 组件，该组件必须处理大型 excel 文件的创建。我很高兴使用 SXSSF 流式传输方法，这种方法速度快且内存占用少。但是，我无法进行数据验证，必须使用 XSSF。

在 XSSF 中，当我尝试打开 xlsx 文件 (~5 MB) 时，内存会猛增，主要导致 OutOfMemory。我的问题是，

1.  是否可以使用 SXSSF 进行数据验证（如从下拉列表中选择）。这对我来说将是一种祝福。

2.  有没有办法使用 XSSF 进行数据验证，但内存占用更少。

3.  是否有用于 xlsx 数据验证的替代 Java 解决方案，它快速且内存高效。

先感谢您..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-12T20:26:27.133

从调试器 POI 3.10.1 中可以看出 OutOfMemory 的原因：

```
XSSFWorkbook has ArrayList<XSSFSheet>; 
XSSFSheet has TreeMap<Integer,XSSFRow>;
XSSFRow has field _row._textsource._srcAfter found as char[32768] 
```

计数：32768 *（行数）=完全浪费内存......在我的情况下超过 1 GB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T15:02:15.550

它适用于 ss.usermodel ( [http://poi.apache.org/spreadsheet/quick-guide.html#Validation](http://poi.apache.org/spreadsheet/quick-guide.html#Validation) )

只是不像手册中那样使用 XSSF 工作簿：

```
Workbook workbook = new XSSFWorkbook();    
Sheet sheet = workbook.createSheet("Data Validation");  
     DataValidationHelper dvHelper = sheet.getDataValidationHelper(); 
```

将您的 SXSSF 工作簿放在那里，以便从 SXSSF 表中提取 DataValidationHelper

```
 Workbook workbook = new SXSSFWorkbook();    
    Sheet sheet = workbook.createSheet("Data Validation");  
         DataValidationHelper dvHelper = sheet.getDataValidationHelper();  
//stuff with validation 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-20T07:31:32.990

我在解析xlsx文件时也遇到了同样的OOM问题……经过两天的努力，我终于发现下面的代码非常完美；

此代码基于 sjxlsx。它读取 xlsx 并存储在 HSSF 表中。

```
 // read the xlsx file
       SimpleXLSXWorkbook = new SimpleXLSXWorkbook(new File("C:/test.xlsx"));

        HSSFWorkbook hsfWorkbook = new HSSFWorkbook();

        org.apache.poi.ss.usermodel.Sheet hsfSheet = hsfWorkbook.createSheet();

        Sheet sheetToRead = workbook.getSheet(0, false);

        SheetRowReader reader = sheetToRead.newReader();
        Cell[] row;
        int rowPos = 0;
        while ((row = reader.readRow()) != null) {
            org.apache.poi.ss.usermodel.Row hfsRow = hsfSheet.createRow(rowPos);
            int cellPos = 0;
            for (Cell cell : row) {
                if(cell != null){
                    org.apache.poi.ss.usermodel.Cell hfsCell = hfsRow.createCell(cellPos);
                    hfsCell.setCellType(org.apache.poi.ss.usermodel.Cell.CELL_TYPE_STRING);
                    hfsCell.setCellValue(cell.getValue());
                }
                cellPos++;
            }
            rowPos++;
        }
        return hsfSheet; 
```

# c++ - Matlab Coder Toolbox 生成的 C++ 代码是否紧凑且最少？

> ID：10721280
> 
> 赞同：1
> 
> 时间：2012-05-23T13:45:59.840
> 
> 标签：c++, matlab, toolbox

Matlab Coder Toolbox 生成的 C++ 代码是否紧凑且最少？有没有人评估过 Matlab 的 Coder 工具箱生成的 C++ 代码？它是紧的和最小的吗？有人告诉我，很多生成的代码可能非常臃肿，这并不能使其成为在高频交易环境中使用的低延迟质量。这种说法有道理吗？即使您在 Coder 的最低设置下构建代码也是如此。我将使用的 Matlab M 脚本只是 M 核心，因此我不会使用任何扩展的 Matlab 工具箱，例如 Econmetrics。感谢您的任何见解

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:26:50.777

如果您知道自己在做什么，并且首先以正确的方式编写 MATLAB（其中不仅包括很少的工具箱，而且还限制自己使用 MATLAB 语言的子集），那么它可以变得紧凑和最小化. 有很多人在算法和高频交易中使用 MATLAB 生成的 C 代码。

如果您认真地想知道它的精确度和最小化程度，您需要如何更改您的 MATLAB 编码风格，以及这可能有多困难，我真的建议您与 MathWorks 联系。MATLAB Coder 是一个复杂的产品，人们通常需要建议才能充分利用它。

[免责声明，以防上述听起来像是推销——我是一名前数学工作者，但我不再有兴趣向你推销任何东西。这只是我的 2 美分建议。]

# r - 从 XTS 对象中删除条目并更新指数移动平均线的以下评估

> ID：10721284
> 
> 赞同：0
> 
> 时间：2012-05-23T13:46:06.540
> 
> 标签：r, time-series, xts

我有一个 xts，我计算 EMA。我想将 i 值与之前的 EMA 进行比较，如果高于阈值，则删除该点并随后更新 EMA 评估。

就像是：

```
dat<-as.xts(data)
dat_EMA<-EMA(abs(dat),n=10)
dat_EMA<-lag(dat_EMA,k=-1) 
```

然后，如果`dat > 100*dat_EMA`，则从该点移除`dat`并重新计算 EMA 的以下部分。

有什么有效的程序吗？

# c - 如何旋转和缩放单应性

> ID：10721289
> 
> 赞同：5
> 
> 时间：2012-05-23T13:46:13.567
> 
> 标签：c, algorithm, math, opencv, augmented-reality

我需要帮助 ，

我正在从服务器接收单应性，因此我想将此单应性标准化为我的应用程序的坐标系，当我尝试用坐标表示对象时，服务器应用程序会生成接下来的 4 个点：

收到 [96.629539, 217.31934; 97.289948、167.21941；145.69249、168.28044；145.69638, 219.84604]

我的应用程序生成接下来的 4 点：

本地 [126.0098, 55.600437; 262.39163、53.98035；259.41382、195.34763；121.48138、184.95235]

我用图形表示这些点，R（接收），P（本地）

![在此处输入图像描述](../Images/21b5d74d41fc2726fb4292f61a3f8125.png)

看起来生成的正方形是旋转和缩放的，所以我想知道是否有任何方法可以将此旋转缩放应用到服务器单应性，以便能够具有与我的应用程序单应性相同的单应性。

谢谢，我需要更多信息，请问我。

* * *

非常感谢您的快速回答，最后我使用其他近似值，就像从服务器获取点并使用 findhomography 获得逆单应性一样简单。

单应性=findHomography(srcPoints, dstPoints, match_mask, RANSAC, 10);

谢谢！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T15:30:55.367

我想我想通了。下面是你的两个单应性的更准确的图。蓝色是“接收”的单应性，红色是“本地”的单应性。

![在此处输入图像描述](../Images/e5ec974f9004c8ab7580f7e9d7f4e3f1.png)

您可以使用 OpenCV 函数[getAffineTransform](http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#getaffinetransform)来计算与 3 个点对相关的仿射变换（我不得不重新组织您的点对，因为它们的顺序错误）。我在 numpy 中运行如下：

```
r = array([[97.289948, 167.21941], [96.629539, 217.31934], [145.69638, 219.84604]], np.float32)
l = array([[126.0098, 55.600437], [121.48138, 184.95235], [259.41382, 195.34763]], np.float32)
A = cv2.getAffineTransform(r, l) 
```

这给了我们以下仿射关系：

```
array([[  2.81385763e+00,  -5.32961421e-02,  -1.38838108e+02],
       [  7.88519054e-02,   2.58291747e+00,  -3.83984986e+02]]) 
```

我把它应用回来，`r`看看我是否可以`l`确保它像这样工作：

```
# split affine warp into rotation, scale, and/or shear + translation matrix
T = mat(A[:, 2]).T
matrix([[-138.83810801],
        [-383.98498637]])

A = mat(A[:, 0:2])
matrix([[ 2.81385763, -0.05329614],
        [ 0.07885191,  2.58291747]])

# apply warp to r to get l
r = mat(r).T
A*r + T
# gives
matrix([[ 126.00980377,  121.48137665,  259.41381836],
        [  55.60043716,  184.9523468 ,  195.34762573]])
# which equals
l = mat(l).T
matrix([[ 126.00980377,  121.48137665,  259.41381836],
        [  55.60043716,  184.9523468 ,  195.34762573]], dtype=float32) 
```

另外值得注意的是，您可以`Markus Jarderot`使用 OpenCV 函数[getPerspectiveTransform](http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html?highlight=getperspective#Mat%20getPerspectiveTransform%28const%20Point2f*%20src,%20const%20Point2f*%20dst%29)生成透视变换。

希望有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T16:28:50.860

如果您将点和变换插入 Maple，您可以很快得到结果。

```
> with(LinearAlgebra);

> # The server coordinates
  pa := [[96.629539, 217.31934], [97.289948, 167.21941], [145.69249, 168.28044],
         [145.69638, 219.84604]]:

> # The local coordiantes
  pb := [[126.0098, 55.600437], [262.39163, 53.98035], [259.41382, 195.34763],
         [121.48138, 184.95235]]:

> # The placeholder variables for the transformation (last one is '1', because it
  # is scale-invariant)
  T := [seq]([seq](`if`(i = 3 and j = 3, 1, t[i, j]), j = 1 .. 3), i = 1 .. 3):
  V := convert(map(op, T)[1 .. -2], set):

> # Transformation function (Matrix multiplication + divide with 3rd coordinate)
  trans := (p, T) -> [
      (T[1, 1]*p[1]+T[1, 2]*p[2]+T[1, 3])/(T[3, 1]*p[1]+T[3, 2]*p[2]+T[3, 3]),
      (T[2, 1]*p[1]+T[2, 2]*p[2]+T[2, 3])/(T[3, 1]*p[1]+T[3, 2]*p[2]+T[3, 3])
  ]:

> # Transform pa, and construct the equation system
  pat := map(trans, pa, T):
  eqs := {op}(zip((p1, p2) -> op(zip(`=`, p1, p2)), pat, pb)):

> # Solve for the transform variables
  sol := solve(eqs, V):

> # Populate the transform
  eval(T, sol); 
```

**输出：**

```
[[  .1076044020,   -3.957029830,    1074.517140  ],
 [ 4.795375318,      .3064507355,   -430.7044862 ],
 [ 0.3875626264e-3, 0.3441632491e-2,   1         ]] 
```

要使用它，请将它与服务器点相乘作为`T * <x, y, 1>`.

* * *

```
void ServerToLocal(double serverX, double serverY, double *localX, double *localY)
{
    double w;
    w = 0.3875626264e-3 * serverX + 0.3441632491e-2 * serverY + 1.0;
    *localX = (.1076044020 * serverX - 3.957029830 * serverY + 1074.517140) / w;
    *localY = (4.795375318 * serverX + .3064507355 * serverY - 430.7044862) / w;
} 
```

* * *

另一种方法可以在 [http://alumni.media.mit.edu/~cwren/interpolator/阅读](http://alumni.media.mit.edu/~cwren/interpolator/)

给定一个合理的线性代数库，这个可以用 C 语言编写。

# actionscript-3 - 如何使 .swf 电影只播放一次并停止，而不是重复？

> ID：10721290
> 
> 赞同：0
> 
> 时间：2012-05-23T13:46:14.030
> 
> 标签：actionscript-3, flash

我制作了一部电影，其中一个立方体转动并应该停止，但因为它是一部 .swf 电影，它不断重复我不想要的。我希望它只播放一次并停止。我怎样才能做到这一点？如果需要一个动作脚本，请告诉那是什么？我有 Adob​​e Flash 专业 CS5.5

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T13:48:32.420

在 Flash 文件的最后一帧上，您需要做的就是单击时间轴内的帧，单击操作面板，然后输入：

```
 stop(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T13:48:16.577

放置停止（）；在动作脚本面板的最后一帧中。那应该可以解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-27T17:19:31.667

您还可以进入您的代码并将该 swf 文件的循环设置为 false：

```
 <param name="loop" value="false" /> 
```

这将使它在您加载页面后播放一次。

# line - 设置 Perforce 行尾

> ID：10721294
> 
> 赞同：7
> 
> 时间：2012-05-23T13:46:26.487
> 
> 标签：line, perforce

我正在使用 perforce 来管理一些代码。我在本地机器和 unix 机器上设置了一个工作区。但是最近 perforce 开始在行尾添加 ^M 字符，这在 unix env 中运行代码时会导致问题。如何在编辑文件时在本地设置我的 perforce 不这样做。我正在使用 Notepad++ 进行本地编辑

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T22:37:40.137

我建议对两个客户端都使用 Unix 行尾。

Unix 行尾，尽管有名字，会告诉 perforce 客户端在文件从最初提交的方式同步时**不要修改行尾。**在两个客户端上使用此设置，如果您在 Windows 上创建一个文件并将其同步到 Unix，它仍然会有 Windows 行尾，但它不应该在 Unix 上造成问题，并且 perforce 不会删除/添加导致^M.

一个小缺点是 Windows 机器需要 Unix 行尾感知实用程序，例如 Notepad++，但这听起来对你来说不是问题。

在我们的团队环境中，Unix、Mac 和 Windows 都在同一个仓库上使用，我们所有的客户端都被 [Unix] 服务器上的一个简单的单行触发器强制为 Unix 行尾，这样就没有人遇到这个问题（它也强制submitunchanged 和 rmdir 但您可以选择去掉这些）：

```
clientspec form-in client "sed -i -e s/LineEnd.*/LineEnd:unix/ -e s/submitunchanged/revertunchanged/ -e s/normdir/rmdir/ %formfile%" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-23T18:21:21.680

听起来您需要在客户端规范中将 LineEnd 选项设置为“共享”。

请参阅：[http ://www.perforce.com/perforce/doc.current/manuals/cmdref/client.html#1040665](http://www.perforce.com/perforce/doc.current/manuals/cmdref/client.html#1040665)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-11-27T02:41:04.547

Perforce 文档试图简化其 EOL 设置。它失败了，因为 EOL 问题总是很复杂，*不能*简单化。`p4 client`以下是所有不同设置“真正”所做的总结。这是通过慢慢阅读有关该主题的*整个*Perforce 文档、[其他一些 stackoverflow 答案](https://stackoverflow.com/questions/2157025/perforce-keeping-perforce-from-altering-text-file-format)，当然还有一些试验和错误（提示：`p4 client`+ `p4 diff -f ...`）来学习的。

*   `unix`: 从来没有转换，因为 Perforce 假设它的内部数据库是完全“LF-normalized”的*，即使这不是严格执行的*！更多内容如下。
*   `win`: 在输入上转换 CRLF -> LF，在输出上转换 LF -> CRLF
*   `local`： 默认值。`win`在 Windows 上执行转换，在 macOS X、Linux 和任何其他 Unix（包括 Linux 的 Windows 子系统）上不执行 ( )`unix`转换。
*   `share`: = "清理 CRLF"。输入时将 CRLF 转换为 LF，输出时不转换。
*   `mac`: pre-macOS X 所以让我们忽略它以使事情稍微简单一点

通常情况下，间接描述关键设计问题[的警告比有关该主题的所有其余文档都更能说明问题：](https://community.perforce.com/s/article/3096)

> 例如，将带有 CRLF 行尾的文本文件保存在`unix`工作区中，然后提交它会导致文件存储在库中，并且每行末尾都有额外的 CR 字符。当这些文件同步到其他`unix`工作空间时，它们将具有 CRLF 行结尾而不是正确的 LF 行结尾，并且当这些文件同步到`win`工作空间时，它们将具有 CRCRLF 行结尾（因为原始文件中的每个 LF 都是转换为 CRLF）。

请注意同一页面上的早期陈述给人的（错误的！）印象是“一切都是 LF 内部”。

虽然没有在内部严格执行 LF，但 Perforce 手册警告说，当内部发现一些非 LF 行尾时，某些操作可能会遇到困难。希望在存储 CRLF 时出现[虚假但无害的 ^M 字符？](https://adaptivepatchwork.com/2012/03/01/mind-the-end-of-your-line/)幸好单独的 CR 和 pre-macOS X 现在已经死了。

PS：除非来不及使用`unix`，让编辑处理行尾；*不是*版本控制。编辑器几乎都非常擅长，并且比版本控制更好。例如，版本控制中没有 EOL 转换是在同一个地方拥有一些[`build.sh`](https://stackoverflow.com/questions/14609779/how-can-i-configure-bash-to-handle-crlf-shell-scripts)和一些其他文件的唯一实用方法。[`build.bat`](https://stackoverflow.com/questions/1522129/windows-batch-file-the-system-cannot-find-the-batch-label-specified)

# r - 在 R 中使用 NA 值进行聚类

> ID：10721299
> 
> 赞同：13
> 
> 时间：2012-05-23T13:46:43.120
> 
> 标签：r, cluster-analysis

我很惊讶地发现`clara`from`library(cluster)`允许 NA。但是函数文档没有说明它如何处理这些值。

所以我的问题是：

1.  如何`clara`处理 NA？
2.  这可以以某种方式用于`kmeans`（不允许Nas）吗？

**[更新]**所以我确实在`clara`函数中找到了代码行：

```
inax <- is.na(x)
valmisdat <- 1.1 * max(abs(range(x, na.rm = TRUE)))
x[inax] <- valmisdat 
```

将缺失值替换为`valmisdat`. 不确定我是否理解使用这种公式的原因。有任何想法吗？将每列分别处理 NA 是否更“自然”，也许用平均值/中位数代替？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-23T14:19:19.600

虽然没有明确说明，但我相信会按照帮助页面`NA`中描述的方式进行处理。`?daisy`详细信息部分有：

> 在菊花算法中，x 行中的缺失值不包括在涉及该行的相异性中。

鉴于内部将使用相同的代码，`clara()`这就是我理解`NA`数据中的 s 可以被处理的方式——它们只是不参与计算。在这种情况下，这是一种合理的标准处理方式，例如用于定义 Gower 的广义相似系数。

**更新**`C`源`clara.c`清楚地表明这（上面）是s`NA`的处理方式`clara()`（第 350-356 行`./src/clara.c`）：

```
 if (has_NA && jtmd[j] < 0) { /* x[,j] has some Missing (NA) */
        /* in the following line (Fortran!), x[-2] ==> seg.fault
           {BDR to R-core, Sat, 3 Aug 2002} */
        if (x[lj] == valmd[j] || x[kj] == valmd[j]) {
        continue /* next j */;
        }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-05T08:37:42.617

不确定是否`kmeans`可以通过忽略连续缺失值来处理缺失数据。

有两个步骤`kmeans`；

1.  计算观测值和原始聚类平均值之间的距离。
2.  根据新计算的距离更新新的聚类平均值。

当我们的观察中缺少数据时：步骤 1 可以通过适当地调整距离度量来处理，就像在`clara/pam/daisy`包中一样。但是只有当我们对观察的每一列都有一些值时，才能执行第 2 步。因此，插补可能是`kmeans`处理缺失数据的下一个最佳选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-06T23:21:45.037

通过查看 Clara c 代码，我注意到在 clara 算法中，当观察中存在缺失值时，平方和与缺失值的数量成正比“减少”，我认为这是错误的！[clara.c](https://svn.r-project.org/R-packages/trunk/cluster/src/clara.c)的第 646 行类似于“ dsum *= (nobs / pp) ”，它显示它计算每对观察值 (nobs) 中非缺失值的数量，将其除以变量数 (pp) 并相乘这是平方和。我认为它必须以其他方式完成，即“ dsum *= (pp / nobs) ”。

# c# - GridViewComboBoxColumns 获得 NullReferenceException

> ID：10721302
> 
> 赞同：0
> 
> 时间：2012-05-23T13:46:57.923
> 
> 标签：c#, combobox, nullreferenceexception

我有`ComboBoxColumn`一个`DataGridView`。当我单击它时，然后移动到同一列中的下一行或上一行，我得到一个`Exception`（并且我的应用程序崩溃）。

这是我的代码，我该如何解决？

```
private void cmbBox_SelectedIndexChanged(object sender, EventArgs e)
{
    try
    {
        // dgv_Panchang.EndEdit();
        string SpID = string.Empty;
        //ComboBox cmbBox = (ComboBox)sender;
        ComboBox cmbBox = new ComboBox();
        cmbBox = (ComboBox)sender;
        if (cmbBox != null)
        {

            if (dgv_Panchang.CurrentCell.ColumnIndex == 1)
            {
                Cls_Global_Var.Name = string.Empty;
                Cls_Global_Var.Name = cmbBox.SelectedItem.ToString();
                if (Cls_Global_Var.Name != string.Empty)
                {
                    Cls_Global_Var.StrSql = string.Empty;
                    Cls_Global_Var.StrSql = "select Pk_SpecialDay from    tbl_specialday where V_Title ='" + Cls_Global_Var.Name + "'";

                    SpID = Cls_DataBase.GetIdentCurrentID(Cls_Global_Var.StrSql);

                    if (SpID != null)
                    {
                        int RowIndex = dgv_Panchang.CurrentCell.RowIndex;
                        int ColIndex = dgv_Panchang.CurrentCell.ColumnIndex;
                        DataGridViewCell dgvCurrent = dgv_Panchang[ColIndex + 2, RowIndex];
                        if (dgvCurrent != null)
                        {
                            dgv_Panchang.CurrentCell = dgvCurrent;
                            dgv_Panchang.CurrentRow.Cells["SPDValue"].Value = SpID;

                            Cls_PanchangMaster_Obj.GetSpecialDayName(Convert.ToInt32(SpID), ColIndex, dgv_Panchang);
                        }

                    }
                }
                else
                {
                    return;
                }
            }
            else if (dgv_Panchang.CurrentCell.ColumnIndex == 4)
            {
                try
                {
                    Cls_Global_Var.Name = string.Empty;
                    Cls_Global_Var.Name = cmbBox.SelectedItem.ToString();
                    if (Cls_Global_Var.Name != string.Empty && Cls_Global_Var.Name != null)
                    {
                        Cls_Global_Var.StrSql = string.Empty;
                        Cls_Global_Var.StrSql = "select Pk_SpecialDay from  tbl_specialday where V_Title ='" + Cls_Global_Var.Name + "'";

                        SpID = Cls_DataBase.GetIdentCurrentID(Cls_Global_Var.StrSql);
                        if (SpID != null)
                        {
                            int RowIndex = dgv_Panchang.CurrentCell.RowIndex;
                            int ColIndex = dgv_Panchang.CurrentCell.ColumnIndex;
                            DataGridViewCell dgvCurrent = dgv_Panchang[ColIndex + 2, RowIndex];
                            if (dgvCurrent != null)
                            {
                                dgv_Panchang.CurrentCell = dgvCurrent;
                                dgv_Panchang.CurrentRow.Cells["SPDValue"].Value = SpID;

                                Cls_PanchangMaster_Obj.GetSpecialDayName(Convert.ToInt32(SpID), ColIndex, dgv_Panchang);
                            }

                        }
                    }
                }
                catch (Exception ex)
                {
                    Cls_GlobalMessage.CreatErrorLog(ex.Message.ToString());
                }
            }
        }
    }
    catch (Exception ex)
    {
        Cls_GlobalMessage.CreatErrorLog(ex.Message.ToString());
    }
    finally
    {
        dgv_Panchang.ClearSelection();
        dgv_Panchang.EndEdit();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T17:41:26.790

这个问题问得不好，不太可能给你带来可以解决你问题的回答。请阅读[http://tinyurl.com/so-hints](http://tinyurl.com/so-hints)了解如何提出编码问题的一般指南。您在问题中投入的工作越多，回答者可能会投入更多的工作来回答您的问题。根据迄今为止提供的大量信息，我们可以为您提供的最好的信息是异常可能是因为您在`.`具有空值的变量上使用了运算符。有用的权利;-)

**话虽如此**，您还可以采取其他几个步骤来稍微清理一下您的代码。让我们从第一次 try catch 开始。您`dgv_Panchang`在许多地方取消引用，包括您的 finally 块。你确定那`dgv_Panchang`永远不会为空吗？如果它为空，你可以得到一个`NullReferenceException`. 此外，看起来你的两个 catch 块都在做同样的事情。您可能可以删除内部 try-catch 而不更改代码的任何语义（堆栈跟踪可能具有不同的行号以捕获异常）

继续。在许多地方，您将变量设置为新对象，然后立即将其设置为不同的对象：即

```
ComboBox cmbBox = new ComboBox();
cmbBox = (ComboBox)sender;

Cls_Global_Var.Name = string.Empty;
Cls_Global_Var.Name = cmbBox.SelectedItem.ToString();

Cls_Global_Var.StrSql = string.Empty;
Cls_Global_Var.StrSql = "select Pk_SpecialDay from    tbl_specialday where V_Title ='" + Cls_Global_Var.Name + "'"; 
```

在所有这些情况下都可以删除第一行以节省时间和内存。这没有错，而只是代码审查建议。

看来您正在使用一些静态全局类来存储信息，例如`Cls_Global_Var.Name`或`Cls_Global_Var.StrSql`。可能有更好的方法可以在没有静态的情况下处理此问题，并且如果您还必须注意多线程问题（如果适用），但这是一个太大的问题，并且需要比您在此处讨论的内容更多的上下文。

`dgv_Panchang.CurrentCell.ColumnIndex == 1`何时和何时的代码`4`非常相似。除了后面的附加 try-catch，正如我之前提到的，可能不需要，唯一的区别在于 if 语句中的额外子句：

```
Cls_Global_Var.Name = cmbBox.SelectedItem.ToString();
if (Cls_Global_Var.Name != string.Empty && Cls_Global_Var.Name != null) 
```

由于`.ToString()`永远不会返回 null，因此`&& Cls_Global_Var.Name != null`不需要并且可以将其删除。（作为旁注，请查看`string.IsNullOrEmpty()`）

删除它后，这两个代码块的含义相同，您可以使用以下内容压缩 if 语句：

`if (dgv_Panchang.CurrentCell.ColumnIndex == 1 || dgv_Panchang.CurrentCell.ColumnIndex == 4)`

像这样缩短 LOC 计数是一件好事。

另一个批评：我希望您的组合框不允许原始用户输入，以免他输入类似`"';DROP TABLE tbl_specialday;--"`或更糟的内容并破坏您的一天。查看 SQL 参数以使您的代码更健壮。

# windows-phone-7 - 尝试创建任何类型的文件时发出 IsolatedStorageFileStream

> ID：10721305
> 
> 赞同：0
> 
> 时间：2012-05-23T13:47:02.510
> 
> 标签：windows-phone-7

`IsolatedStorageFileStream`我的WP7 项目中有一个非常奇怪的问题。我总是收到类似“ **Operation not allowed on IsolatedStorageFileStream** ”的错误。

这是我的代码（2个案例）：

**1º：**

```
void camera_Completed(object sender, PhotoResult e)
{
    var imageBytes = new byte[e.ChosenPhoto.Length];
    e.ChosenPhoto.Read(imageBytes, 0, imageBytes.Length);

    using (IsolatedStorageFile myIsolatedStorage = IsolatedStorageFile.GetUserStoreForApplication())
    {
        if (!myIsolatedStorage.DirectoryExists("Fotos"))
            myIsolatedStorage.CreateDirectory("Fotos");

         IsolatedStorageFileStream fileStream = myIsolatedStorage.CreateFile("foto." + DateTime.Now.Date + "jpeg");

        BitmapImage bitmap = new BitmapImage();

          bitmap.SetSource(e.ChosenPhoto);
        WriteableBitmap wb = new WriteableBitmap(bitmap);
        Extensions.SaveJpeg(wb, fileStream, wb.PixelWidth, wb.PixelHeight, 0, 85);
        fileStream.Close();
    }

    e.ChosenPhoto.Seek(0, SeekOrigin.Begin);
    imgField.Source = PictureDecoder.DecodeJpeg(e.ChosenPhoto);

    thumbnail = imageBytes;
    base64String = System.Convert.ToBase64String(imageBytes, 0, imageBytes.Length);
} 
```

**2º：**

```
void camera_Completed(object sender, PhotoResult e)
{
    var imageBytes = new byte[e.ChosenPhoto.Length];
    e.ChosenPhoto.Read(imageBytes, 0, imageBytes.Length);

    using (IsolatedStorageFile myIsolatedStorage = IsolatedStorageFile.GetUserStoreForApplication())
    {
        if (!myIsolatedStorage.DirectoryExists("Fotos"))
            myIsolatedStorage.CreateDirectory("Fotos");

        IsolatedStorageFileStream fileStream = new IsolatedStorageFileStream(@"Shared/foto." + DateTime.Now.Date + "jpeg", FileMode.CreateNew, myIsolatedStorage);

        BitmapImage bitmap = new BitmapImage();

        bitmap.SetSource(e.ChosenPhoto);
        WriteableBitmap wb = new WriteableBitmap(bitmap);
        Extensions.SaveJpeg(wb, fileStream, wb.PixelWidth, wb.PixelHeight, 0, 85);
        fileStream.Close();
    }

    e.ChosenPhoto.Seek(0, SeekOrigin.Begin);
    imgField.Source = PictureDecoder.DecodeJpeg(e.ChosenPhoto);

    thumbnail = imageBytes;
    base64String = System.Convert.ToBase64String(imageBytes, 0, imageBytes.Length);
} 
```

谁能告诉为什么此代码不起作用，并且该站点的示例有效： http: [//www.windowsphonegeek.com/tips/All-about-WP7-Isolated-Storage---Read-and-Save-Captured-图片](http://www.windowsphonegeek.com/tips/All-about-WP7-Isolated-Storage---Read-and-Save-Captured-Image)？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:20:08.550

来自 IsolatedStorage 的错误消息非常有用。例如，如果您尝试打开一个不存在的文件，您将收到同样的消息。如果不知道您在哪里得到异常，很难猜测代码中的确切问题是什么，但如果我不得不猜测，我会说原因是试图生成这样的文件名：

```
@"Shared/foto." + DateTime.Now.Date + "jpeg" 
```

我不确定日期是如何转换为字符串的，这取决于语言环境，但我的猜测是它没有创建有效的文件名。

# javascript - 使用 JavaScript 下载 xml 文件并将其保存在变量中

> ID：10721316
> 
> 赞同：0
> 
> 时间：2012-05-23T13:47:28.750
> 
> 标签：javascript, jquery, jquery-mobile, cordova

我正在使用 jQuery Mobile 创建一个 PhoneGap 应用程序。我有一个位于 Internet 上的服务器上的 xml 文件（可通过 Web 服务器访问（例如[http://www.example.com/myXmlFile.xml](http://www.example.com/myXmlFile.xml)））。我想以某种方式读取这个 xml 文件并将文件的内容保存在一个变量中作为 Java Script 中的字符串。你会怎么做？

```
var contentOfXmlFile = "";

read Xml file --> Save it in the contentOfXmlFile variable.

alert(contentOfXmlFile); 
```

在此之后，来自 xml 文件的文本将显示在警报窗口中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T13:56:03.030

只需使用 AJAX：

```
var myXML = ""
var request = new XMLHttpRequest();
request.open("GET", "http://www.example.com/myXmlFile.xml", true);
request.onreadystatechange = function(){
    if (request.readyState == 4) {
        if (request.status == 200 || request.status == 0) {
            myXML = request.responseXML;
        }
    }
}
request.send(); 
```

变量 myXML 将是您可以操作的 XML 文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T13:52:34.337

你可以用一个ajax查询来做到这一点，比如follwing ...

```
jQuery.ajax({
    type :"GET",
    url : dataUrl,
    success : function(dataXML){
        //dataXML will have the complete xml..
    },
    error : function(){
        //error handler..
    }
}); 
```

其中 dataUrl 是您的 xml 网址。

# resharper - Resharper 可以将 var 更改为显式类型吗？

> ID：10721317
> 
> 赞同：8
> 
> 时间：2012-05-23T13:47:30.760
> 
> 标签：resharper

是否可以使 Resharper 的工具“清理代码”（在 Visual Studio 中）将所有内容更改`var`为显式类型？

示例：我想要这样：

```
var person = new Person(); 
```

改成这样：

```
Person person = new Person(); 
```

**在建议的解决方案后编辑：**

也许我做错了什么，但它对我不起作用：

![显示建议的解决方案如何不起作用的图像](../Images/bce9436f8a87da31f67552677e53e101.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-23T13:57:10.667

您可以在代码清理下的 (Resharper) 选项中进行设置。只需创建一个新配置文件/修改现有配置文件，然后导航到 C#->在声明中使用“var”。将“替换方向”设置为“可以（更改）'var'以使用类型”和“局部变量声明样式”设置为“始终使用显式类型”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T13:49:56.040

是的。在“代码清理”工具中，在“在声明中使用 'var'”下，将“替换方向”设置为“可以使用 'var' 来键入用法”。

![创建自定义配置文件](../Images/5fc67e48b1338b52c919a29636435ef9.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-24T13:11:19.787

注意：您还可以在执行“引入变量”时阻止 resharper 默认为 var。

**这些设置位于代码编辑 --> C# --> 代码样式下**

[![在此处输入图像描述](../Images/ed860c6aa5d0af704f867706b4aa1dd8.png)](https://i.stack.imgur.com/3Qcbw.png)

# php - 带有ajax响应的奇怪编码

> ID：10721330
> 
> 赞同：3
> 
> 时间：2012-05-23T13:48:10.197
> 
> 标签：php, javascript, jquery, html, character-encoding

我需要将带有 Ajax 函数的字符串从 Jquery 发送到我的 javascript 文件。问题是我在需要接收的字符串之前得到了一组奇怪的问号/菱形块。

```
 (function( $ ) 
 {
  $.fn.CallPhpClass = function(className, functionName, parameters, destination)
  {
      return this.each(function()
      {
        if (destination === undefined) {
            destination = $(this);
        };

        $.ajax({
        type : 'POST',
        url : 'php/executer.php',
        data : { className : className, functionName : functionName , parameters : parameters},
        dataType:'text',
        cache: false,
        success : function(data) {
            if (className == "User" && functionName == "logout")
            {
                getMenu();
                return;
            }
            if (className == "User" && functionName == "login")
            {
                getMenu();
                return;
            }
            if (className == "User" && functionName == "lastView")
            {
                $('#main-content').CallPhpClass(data, 'view');
                return;
            }
            if (data.search('alert alert-error') != -1 || data.search('alert alert-success') != -1)
            {
                $('#main-content').CallPhpClass('User', 'lastView');
                destination = $('#error-box');
            }

            if(destination != false)
            {
                destination.html(data);
            }

        },
        error : function(data) {
            console.info(data);
        }
    });
});

}
}) 
```

设置类的代码是：

```
 if (className == "User" && functionName == "lastView")
            {
                $('#main-content').CallPhpClass(data, 'view');
                return;
            } 
```

有了萤火虫，我收到了这个：

[![萤火虫视图](../Images/1594bab34814f5a52169e2658bba5fea.png)](https://i.stack.imgur.com/HvtFJ.png)

所有字符集都在 UTF-8 上，我不知道我做错了什么！

有人能帮我吗？

亲切的问候，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T13:58:31.623

检查元标记的字符集

`<meta http-equiv="content-type" content="text/html;charset=UTF-8" />`

设置**executer.php**文件的响应头

`header('Content-Type: text/html; charset=UTF-8');`

在发送 Ajax 请求时使用`contentType`并传递字符集

```
$.ajax({
        type : 'POST',
        url : 'php/executer.php',
        data : { className : className, functionName : functionName , parameters : parameters},
        dataType:'text',
        cache: false,
        contentType: "application/json; charset=utf-8",
        success : function(data) { 
```

如果它仍然不起作用，请在包含 js 文件的同时尝试`charset`在您的标签中`<script>`

```
<script type="text/javascript" src="myscripts.js" charset="UTF-8"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T13:56:17.683

在发送之前对您的数据使用 utf8_encode：http: [//us2.php.net/utf8_encode](http://us2.php.net/utf8_encode)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-07T03:24:14.150

```
setlocale(LC_TIME, "es_ES.UTF8"); 
```

这适用于西班牙语

# java - Java - 具有相互调用的重载方法的抽象类

> ID：10721333
> 
> 赞同：0
> 
> 时间：2012-05-23T13:48:13.583
> 
> 标签：java, overloading, abstract

我有一个具有重载方法的类。

```
 public class MyCal extends GregorianCalendar {

   //constructor
   public MyCal(Date date) {
     super();
     setTime(date);
   }

   boolean isSameDay(Date date) {
      return (isSameDay(new MyCal(date))) {
   }

   boolean isSameDay(MyCal cal) {
       if (...) {
         return true;
       } else {
         return false;
       }
   }

   //abstract String toString(String pattern) {};
   //if I have this I can't call new MyCal(date) from above
} 
```

现在我希望类是抽象的（需要子类实现一些其他方法），并且仍然避免第一个 isSameDay 方法的所有逻辑（调用第二个）。如果只是这种方法，那我可以做到，但是这种情况在许多其他重载方法上都会复制。

类是抽象的，我无法实例化它，所以方法 isSameDay(date) 会报告一个错误......而且真的不想在所有方法上都有逻辑，它会使类变得巨大并且更难维持。任何人都可以有这样做的好方法吗？先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T13:58:20.450

删除需要实例化抽象类的逻辑。在上面的示例中，您可以通过反转您定义的方法的角色来有效地做到这一点：

```
boolean isSameDay(Date date) {
    if (...) {
        return true;
    } else {
        return false;
    } 
}

boolean isSameDay(MyCal cal) {
    if(cal == null) return false;
    return (isSameDay(cal.getTime()));
} 
```

根据需要扩展到您的其他方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T13:58:59.837

你可以定义一个方法`getMyCal(date)`

```
public class MyCal extends GregorianCalendar {

    abstract MyCal getMyCal(Date date);

    // further implementation
} 
```

而不是使用`new MyCal(date)`你可以`getMyCal(date)`在你的方法中使用。

抽象类的实现只需要实现 getMyCal 方法。

```
public ConcreteCal extends MyCal {

    MyCal getMyCal(Date date) {
        return new ConcreteCal(date);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T14:24:21.507

我认为他的意思是他想在父类中实例化派生类的对象。

我建议做这样的事情：

家长班

```
public class MyCal extends GregorianCalendar {  
(...)
boolean isSameDay(Date date) {  
   return (isSameDay(newInstance())) {  
   }  
abstract MyCal newInstance(){}
(...)
} 
```

派生类

```
public class MyDerivedCal extends MyCal{  
(...)
abstract MyCal newInstance(){
   return new MyDerivedCal();
   }
(...)
} 
```

请原谅我可能的 java 语法错误....

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T13:59:16.787

很难说出你在问什么，但我猜......

如果你想让这个类抽象，但仍然实例化它，你不能（你不能实例化一个抽象类），但你可以这样做：

```
public abstract class MyCal ... {
    ...
    abstract String toString(String pattern);
}

public class MyCalBasic extends MyCal {
    String toString(String pattern) {
        // some vanilla impl
    }
} 
```

当你想要类的“香草”版本时，只需使用`MyCalBasic`而不是使用。`MyCal`

# php - 将这两个 MySQL 查询合并为一个

> ID：10721336
> 
> 赞同：1
> 
> 时间：2012-05-23T13:48:17.677
> 
> 标签：php, mysql, arrays

这是手头的任务：我有一个名为“reports”的数据库表，该表中的一列是“submitted_by”。此列包含提交报告的人的用户名。

现在，我需要做的是显示用户名列表，按照他们发布的报告数量排序。所以应该会出现这样的情况：

用户 | 报告

* * *

马克 | 25

* * *

约翰 | 18

* * *

玛丽 | 7

等等

我已经编写了这个 PHP/MySQL 代码来执行此操作，它非常简单，但我想知道这些是否可以合并到 1 个查询中。此外，这会在效率方面获得很大收益吗？

```
$users=array();

$result=mysql_query("select id,submitted_by from reports group by submitted_by");
while($row=mysql_fetch_array($result)){
    $result1=mysql_query("select id,submitted_by from reports where submitted_by='$row[submitted_by]' ");
    $users[$row[submitted_by]]=mysql_num_rows($result1);
}

arsort($users); 
```

然后只回显来自`$users`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T13:53:08.497

试试下面的代码：

```
$users = array();

$result=mysql_query("SELECT id, submitted_by, COUNT(*) as cnt FROM reports GROUP BY submitted_by ORDER BY COUNT(*) DESC");

while($row=mysql_fetch_array($result)){
    $users[$row['submitted_by']] = $row['cnt'];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T13:52:42.023

```
$users = array();

$result = mysql_query("
SELECT id,submitted_by, COUNT(*) as amount 
FROM reports 
GROUP BY submitted_by
ORDER BY amount DESC
");

while($row = mysql_fetch_array($result))
    $users[$row['submitted_by']] = $row['amount'];

// arsort($users); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T13:59:42.120

尝试：

```
$query = "SELECT id, submitted_by, COUNT(*) as numbers FROM reports GROUP BY submitted_by ORDER BY COUNT(*) DESC";

$result = mysql_query($query);

echo "<table><tr><th>User</th><th>Reports</th></tr><tr>";

while($row = mysql_fetch_assoc($result)) {

  echo "<td>$row[submitted_by]<td>";
  echo "<td>$row[numbers]<td>";

}

echo "</tr></table>" 
```

# jsf-2 - JSF 中的 UTF-8 表单提交正在破坏数据

> ID：10721342
> 
> 赞同：11
> 
> 时间：2012-05-23T13:48:37.950
> 
> 标签：jsf-2, character-encoding, primefaces

在其中一个项目中，我在表单数据上提供了非英语内容（芬兰语）。我们正在使用带有 PrimeFaces 的 JSF 2.0。将数据提交到服务器时遇到问题。提交表单时数据已损坏。只有芬兰角色在这方面变得腐败。

有没有人已经遇到过这个问题并找到了解决方案？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-23T13:56:13.463

这是自 PrimeFaces 3.0 以来的一个已知问题。这是由于它检查当前 HTTP 请求是否为 ajax 请求的方式发生了变化。它由请求参数而不是请求标头标识。在 JSF 视图恢复之前第一次检索请求参数时，所有请求参数都将使用服务器的默认字符编码（通常是 ISO-8859-1）进行解析，而不是 JSF 自己的默认字符编码 UTF-8。有关深入解释，请参阅[通过 PrimeFaces 输入组件检索的 Unicode 输入变得损坏](https://stackoverflow.com/questions/9634230/typing-chinese-with-primefaces-editor-component/9839362#9839362)。

解决方案之一是创建一个过滤器，它执行`request.setCharacterEncoding("UTF-8")`.

```
@WebFilter("*.xhtml")
public class CharacterEncodingFilter implements Filter {

    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws ServletException, IOException {
        request.setCharacterEncoding("UTF-8");
        chain.doFilter(request, response);
    }

    // ...
} 
```

# c# - C# 继承混淆

> ID：10721344
> 
> 赞同：3
> 
> 时间：2012-05-23T13:48:39.043
> 
> 标签：c#, inheritance

我正在尝试实现基类和派生类的调用方法。但是，如果我做得正确，我会有点困惑。我想从基类设置值并在派生类中使用它们。

```
namespace Inheritance
{
    using System;

    public class BaseClass
    {
        public BaseClass() { }

        protected string methodName;
        protected int noOfTimes;
        public void Execute(string MethodName, int NoOfTimes)
        {
            this.methodName = MethodName;
            this.noOfTimes = NoOfTimes;
        }
    }

    public class DerivedClass : BaseClass
    {
        public DerivedClass() : base() { }

        public void Execute()
        {
            Console.WriteLine("Running {0}, {1} times", base.methodName, base.noOfTimes);
        }
    }

    public class Program
    {
        static void Main(string[] args)
        {
            DerivedClass d = new DerivedClass();
            d.Execute("Func", 2);
            d.Execute();

            Console.ReadLine();
        }
    }
} 
```

问题：我可以只使用 1 次调用 Execute 而不是 2 次来实现与上述相同的效果吗？

我希望我上面的例子很清楚。如果不是这样，请告诉我，我将提供更多详细信息。

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-23T13:51:47.187

***免责声明***，我的回答假设您想要一个围绕方法继承及其实现的解决方案。提供的其他答案也是该问题的良好解决方案。

听起来您想覆盖派生类中的方法。为此，基类需要标记方法[`virtual`](http://msdn.microsoft.com/en-us/library/9fkccyh4%28v=vs.100%29.aspx)或[`abstract`](http://msdn.microsoft.com/en-us/library/sf985hc5%28v=vs.100%29.aspx). 但是，在您的情况下，派生类方法签名是不同的。我会假设这是不理解它是如何工作的错误，所以我已经为你纠正了。

在这种情况下，派生类使用[`override`](http://msdn.microsoft.com/en-us/library/ebca9ah3%28v=vs.100%29.aspx)C# 关键字标记方法。然后`base.Execute(MethodName, NoOfTimes);`，我想在重写的实现中使用基类的实现时调用。然后我输入我自己的代码。

[`base`](http://msdn.microsoft.com/en-us/library/hfw7t1ce%28v=vs.100%29.aspx)是另一个关键字，可让您访问您所在类的正下方的基类中的成员，而不会让继承链将您推回派生成员。

`abstract`值得一读，但在这种情况下不是必需的（它具有不同的行为，`virtual`但也与 结合使用`override`）。

```
namespace Inheritance
{
    using System;

    public class Program
    {
        internal protected class BaseClass
        {
            public BaseClass() { }

            protected string methodName;
            protected int noOfTimes;
            public virtual void Execute(string MethodName, int NoOfTimes)
            {
                this.methodName = MethodName;
                this.noOfTimes = NoOfTimes;
            }
        }

        internal class DerivedClass : BaseClass
        {
            public DerivedClass() : base() { }

            public override void Execute(string MethodName, int NoOfTimes)
            {
                base.Execute(MethodName, NoOfTimes);
                Console.WriteLine("Running {0}, {1} times", base.methodName, base.noOfTimes);
            }
        }

        static void Main(string[] args)
        {
            DerivedClass d = new DerivedClass();
            d.Execute("Func", 2);

            Console.ReadLine();
        }
    }
} 
```

此示例有一些代码格式和命名怪癖，但我将不理会它，以尽可能接近您的原始代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-23T13:57:14.593

这将是[模板方法模式](http://en.wikipedia.org/wiki/Template_method_pattern)的理想候选者。基类没有重写 Execute，而是调用`doWork`必须由派生类提供的方法。这样，您就不会忘记调用`base.Execute`，并且可以在调用之前和之后在基类中做一些事情`doWork`。

```
abstract class BaseClass 
{ 
    public BaseClass() { } 

    protected string methodName; 
    protected int noOfTimes; 
    public void Execute(string MethodName, int NoOfTimes) 
    { 
        this.methodName = MethodName; 
        this.noOfTimes = NoOfTimes;
        doWork();
    } 

    protected abstract void doWork(); // will be provided by derived classes
} 

class DerivedClass : BaseClass 
{ 
    public DerivedClass() : base() { } 

    protected override void doWork()
    {
        Console.WriteLine("Running {0}, {1} times", this.methodName, this.noOfTimes); 
    } 
} 

public class Program   
{   
    static void Main(string[] args) 
    { 
        DerivedClass d = new DerivedClass(); 
        d.Execute("Func", 2); 

        Console.ReadLine(); 
    } 
} 
```

**编辑**：正如亚当在评论中正确指出的那样（谢谢），没有必要使基类抽象（如果您不需要实例化基类，这很方便，因为它会在以下情况下创建编译时错误子类不提供`doWork`) 的实现。或者，您可以在基类中指定默认行为：

```
class BaseClass 
{ 
    public BaseClass() { } 

    protected string methodName; 
    protected int noOfTimes; 
    public void Execute(string MethodName, int NoOfTimes) 
    { 
        this.methodName = MethodName; 
        this.noOfTimes = NoOfTimes;
        doWork();
    } 

    protected virtual void doWork() {
        // default behaviour, can be modified by subclasses
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T13:55:44.750

此外，在这种情况下，您不需要显式调用默认构造函数。

```
public DerivedClass() : base() { } 
```

定义它就足够了

```
public DerivedClass() { } 
```

基本构造函数将在派生构造函数之前自动调用。

至于我同意亚当的原始问题，他只是更快地完成了他的回答。:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T14:01:14.670

首先，在派生类中，您可以访问在基类中定义为公共或受保护的所有方法、变量和属性。这意味着不需要在派生类中使用 base.methodName。

base 用于（而不是通常隐含的 this）来访问在基类中定义的方法/属性的版本，而不是在派生类中重新定义它。这里不是这样。

此外，在您的情况下，您在基类和派生类中使用不同的签名（即参数的不同数量和/或类型）定义 Execute。这意味着您必须单独调用它们，因为它们是不同的。

仅当您在派生类中使用完全相同的参数定义版本时，您才能像 Adam 指出的那样使用 virtual 和 override，即使该版本没有使用它们。顺便说一句，在这里你使用 base 因为你想调用基类中定义的 Execute 版本。

# sql - 验证两个表并在新表中插入结果

> ID：10721347
> 
> 赞同：0
> 
> 时间：2012-05-23T13:48:44.283
> 
> 标签：sql

我有两个表（`table1`和`table2`），我必须验证 table1 中特定列中的值是否存在于 table2 中，如果存在，则将结果插入新表（由 table1 和 table2 中的字段组成）。

例如：

表 1 的列如下：

```
Imagem
Tipo_Backup
Periocidade 
```

表 2 有如下列：

```
ClientName
Outcome
StartDateTime
EndDateTime 
```

表 3 需要这样组成：

```
Imagem (from table1)
Tipo_Backup (from Table1)
Periocidade (from Table1)
Outcome (from Table2)
StartDatetime (from Table2)
EndDatetime (from Table2) 
```

到目前为止，这是我的代码：

```
SELECT Imagem, periocidade, 
into LGP_tbl_ExecMBackups
FROM LGP_tbl_MapaBackups A
WHERE A.Imagem in
(select REPLACE (B.clientName,'_DB2','')
from Lgp_tbl_import_fx_bocada B) 
```

我不知道如何完成获取table3的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T13:57:23.457

尝试

```
INSERT INTO LGP_tbl_ExecMBackups
SELECT 
A.Imagem,
A.Tipo_Backup,
A.Periocidade,
B.Outcome,
B.StartDateTime,
B.EndDateTime
FROM LGP_tbl_MapaBackups A
INNER JOIN Lgp_tbl_import_fx_bocada B
ON A.Imagem = REPLACE (B.clientName,'_DB2','') 
```

但是，table1 和 table2 之间似乎没有关系。如果您有大量数据，则查询将需要很长时间才能完成。

# c++ - 在 QComboBox 中搜索 QString

> ID：10721348
> 
> 赞同：3
> 
> 时间：2012-05-23T13:48:52.357
> 
> 标签：c++, search, qt4, qstring, qcombobox

如何在 QComboBox 中找到 QString？我想获取组合框中与我的字符串对应的元素的索引。有本地方法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T13:51:33.813

我认为[findText](http://doc.qt.io/qt-4.8/qcombobox.html#findText)方法是您正在寻找的

# assembly - 在 WinDbg 中编辑程序集

> ID：10721353
> 
> 赞同：5
> 
> 时间：2012-05-23T13:49:07.437
> 
> 标签：assembly, windbg, cracking, ollydbg

我一直在尝试使用 WinDbg解决一些“crackmes”（来自[http://crackmes.de ）。](http://crackmes.de)我看过的大多数解决方案都涉及使用 Olly Dbg 对程序集进行修改。有没有办法在 WinDbg 中做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T15:30:14.430

您可以使用**a**命令：

[http://msdn.microsoft.com/en-us/library/windows/hardware/ff538153(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff538153(v=vs.85).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T23:23:55.970

您可以使用反汇编窗口查看汇编代码，并使用`u`命令反汇编代码：

[http://msdn.microsoft.com/en-us/library/windows/hardware/ff541965%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff541965%28v=vs.85%29.aspx)

以及更多信息：

[http://msdn.microsoft.com/en-us/library/windows/hardware/ff540661%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff540661%28v=vs.85%29.aspx)

# ajax - 使用 jquery 的 $.ajax 获取 node.js 脚本的输出，而不是其代码

> ID：10721355
> 
> 赞同：3
> 
> 时间：2012-05-23T13:49:13.330
> 
> 标签：ajax, node.js, jquery

我正在构建一个小型原型，并且遇到以下问题：

我正在尝试在客户端 jQuery 和服务器端 node.js 之间进行通信；当我向我的 node.js 代码发出 jQuery ajax 请求时，它只给了我代码，而不是代码的输出。

我究竟做错了什么？

**client.js 的一部分：**

```
$.ajax({url      : './../includes/get_data.js', 
        success  : function(data) {
          alert('success!');
        },
        error    : function(data) {
          alert('error!');
        }
}); 
```

**get_data.js：**

```
var fs = require('fs');

console.log('test'); 
```

当我向 get_data.js 发出请求时，我想要的输出是：test

但相反，我得到了源代码：

```
var fs = require('fs');

console.log('test'); 
```

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T14:12:01.730

你只是要求一个静态的 .js 文件，你根本没有与 Node 交互。如果您想这样做，请创建一个 HTTP 服务器（复制[http://nodejs.org/](http://nodejs.org/)上的示例），将其绑定到端口并写回响应，不要使用 console.log（它只会输出到控制台）。

例子：

将以下文件另存为 app.js，然后在终端中运行它，`node app.js`然后在端口 1337 上访问 localhost：

```
var http = require('http'),
    ajaxResponse = { 'hello': 'world' },
    htmlContent;

htmlContent  = "<html><title></title><head>";
htmlContent += "<script src='http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js'></script>";
htmlContent += "<script>$(function() {$.ajax({url:'/ajax',success:function(data){alert('success!');console.log(data);},error:function(data){alert('error!');}});});</script>";
htmlContent += "</head><body><h1>Hey there</h1>";
htmlContent +="</body></html>";

http.createServer(function (req, res) {   
  if (req.url === '/ajax') {
    res.writeHead(200, {'Content-Type': 'text/json'});
    res.end(JSON.stringify(ajaxResponse));
  } else {
    res.writeHead(200, {'Content-Type': 'text/html'});
    res.end(htmlContent);  
  }  
}).listen(1337, '127.0.0.1');
console.log('Server running at http://127.0.0.1:1337/'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-06T04:41:32.067

我猜你想在你的服务器（运行节点）上获取某个 URL，然后在你的服务器上执行 get_data.js 中的代码？

如果是这样，请使用 express - 查看[http://expressjs.com/api.html#express](http://expressjs.com/api.html#express)。

*   在您的 Node Express 的 app.get() ...
    1.  第一个参数 - 提供您想要的路线（例如，'/mygetdata'）。
    2.  第二个参数 - 在这个回调函数中，调用你的 get_data.js 代码
*   在您的客户端代码中，修改它以请求 URL（例如，' [http](http://mywebsite.com/mygetdata) ://mywebsite.com/mygetdata'），而不是 get_data.js。

# delphi - TMS Intraweb 如何手动设置端口

> ID：10721360
> 
> 赞同：0
> 
> 时间：2012-05-23T13:49:26.437
> 
> 标签：delphi, port, delphi-2010, intraweb, tms

我想手动设置我网站的端口，但是每当我使用 TMS 组件时，端口都会随机设置。

如何在使用 TMS 组件时指定应用程序的端口？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T01:41:45.570

这可能是因为您使用的是 TMS 控件的演示版本，或者没有正确安装 IW 或 TMS 许可证

# java - wsimport - 未定义模式描述符

> ID：10721365
> 
> 赞同：1
> 
> 时间：2012-05-23T13:49:39.540
> 
> 标签：java, xml, web-services, command-line, wsdl

我正在使用 wsimport 从服务器导入 wsdl 文件。这是我正在使用的命令：

```
X:>wsimport -keep -verbose http://xxxxxxxxxx

parsing WSDL...

[ERROR] Schema descriptor {http://XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX in message part "in" is not defined and could not be bound to Java. Perhaps the schema descriptor is not defined in the schema imported/included in the WSDL. You can either a
dd such imports/includes or run wsimport and provide the schema location using -
b switch. 
```

如何导入 wsdl 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:03:44.600

指定了确切的 JDK 版本

> %AS_HOME%/bin/wsimport -keep -d ./build -p com.sample.hello [http://localhost:8080/HelloSvr/HelloService?wsdl](http://localhost:8080/HelloSvr/HelloService?wsdl)

# authentication - 应用程序用户认证

> ID：10721368
> 
> 赞同：0
> 
> 时间：2012-05-23T13:49:48.590
> 
> 标签：authentication, architecture, credentials, application-design

在开发 iOS 应用程序时，我有一个关于用户身份验证的问题。当用户启动应用程序时，将提示他们主屏幕，该屏幕将提示他们输入有效的用户名和密码。一旦他们的凭据得到验证，他们将能够访问应用程序的其余部分。我不知道如何创建此验证操作。我知道如何创建应用程序的可视化部分，但是，除此之外的任何东西我都不明白。简而言之，您如何创建一个需要用户提供凭据才能运行的应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T13:57:10.930

首先，如果未经身份验证就不能做有用的*事情，Apple 将拒绝您的应用程序。*其次，您从用户那里收集输入，然后您必须向您的服务器发送一个 NSURLConnection 以进行身份​​验证、观察响应并采取相应的行动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:09:06.660

考虑到您正在使用服务器进行验证，这取决于您的服务器的设置方式。您会`NSURLConnection`以这种方式使用，这就是我在自己的应用程序中的操作方式（根据您的参数量身定制）：

```
+ (NSDictionary *)executeCallWithRequest:(NSMutableURLRequest *)request {
  NSHTTPURLResponse *response = nil;
  NSError *error = nil;
  NSData *jsonData = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error]; 
  NSString *dataString = [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding];
  error = nil;
  NSDictionary *result = jsonData ? [NSJSONSerialization JSONObjectWithData:jsonData options:NSJSONReadingMutableContainers|NSJSONReadingMutableLeaves error:&error] : nil;
  if (error == nil && response.statusCode == 200) {
    NSLog(@"%i", response.statusCode);
  } else {
    NSLog(@"%@", dataString);
    NSLog(@"%@", [error localizedDescription]);
  }
  return result;
}

+ (NSDictionary *)executePostWithRequest:(NSMutableURLRequest *)request {
  request.HTTPMethod = @"POST";
  return [self executeCallWithRequest:request];
}

+ (NSDictionary *)loginUserWithCredentials:(NSDictionary *)userCredentials {
  NSURL *url = [NSURL URLWithString:[NSString stringWithFormat:@"%@", YOUR_URL]];
  NSMutableURLRequest *request = [NSMutableURLRequest requestWithURL:url];

  NSString *requestFields = [NSString stringWithString:@""];
  for (NSString *key in [userCredentials allKeys]) {
    requestFields = [requestFields stringByAppendingFormat:@"(param name)&", key, [userCredentials objectForKey:key]];
  }

  //removes the trailing &
  requestFields = [requestFields substringToIndex:requestFields.length - 1];
  requestFields = [requestFields stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
  NSData *requestData = [requestFields dataUsingEncoding:NSUTF8StringEncoding];
  request.HTTPBody = requestData;

  return [self executePostWithRequest:request];
} 
```

在我的例子中，我用一个 JSON 编码的数组来响应。

# php - 在 PHP 中关闭浏览器后如何保持会话打开？

> ID：10721370
> 
> 赞同：5
> 
> 时间：2012-05-23T13:50:01.733
> 
> 标签：php, mysql, session, cookies

我按照这里的答案，但它对我不起作用：
[即使在浏览器关闭后也可以保持会话？](https://stackoverflow.com/questions/3684620/is-possible-to-keep-session-even-after-the-browser-is-closed)

这是我尝试过的代码：

```
$session_life = 2592000; // 30 days
session_set_cookie_params($session_life);
session_name('my_cart');
session_start();
// update the session_life
setcookie(session_name(),session_id(),time()+$session_life); 
```

**这样做的问题是，每次关闭浏览器时，我仍然会得到一个新的 session_id，而不是旧的。**

我正在使用数据库将项目存储在“my_cart”中，而 session_id 仅用于识别用户以向他们展示自己的购物车。

让用户购物车存活 30 天的最佳方法是什么？

* * *

这是我最终得到的代码：

```
$cart_name = "my_cart";
$cart_life = 2592000; // 30 days
session_start();
if (isset($_COOKIE[$cart_name])) {
    session_id($_COOKIE[$cart_name]);
}
setcookie($cart_name, session_id(), time()+$cart_life); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T13:58:20.420

我不得不对自己编写的网站做类似的事情（允许客户在 30 分钟内输入代码）

我没有使用 cookie（因为您不能保证客户会在同一个浏览器中返回网站），而是根据用户记录存储了代码的到期时间。这样，无论他们从哪个浏览器访问页面（例如，从移动设备开始，在桌面上结束），它们总是会同时过期。

当客户返回站点时，我将当前时间与到期时间进行比较并采取相应措施

由于您已经存储了客户的购物篮，我会根据记录添加到期时间，然后在客户返回时进行比较。这很容易做到：

```
update basket set expiryDateTime=date_add(now(),interval 7 day) where basketID=[xyz] 
```

如果您愿意，您甚至可以通过在 MySQL 中使用更多技巧将一天中的时间设置为标准值 (20:00)

# windows - 是否有与 Windows XP 中可用的 SetupDiGetDeviceProperty 等效的功能？

> ID：10721371
> 
> 赞同：0
> 
> 时间：2012-05-23T13:50:02.273
> 
> 标签：windows, winapi

我正在尝试检索 USB 设备的“友好名称”。我发现的代码示例使用了 SetupDiGetDeviceProperty，并且在 Windows Vista 及更高版本上运行良好。不幸的是，我还必须支持 Windows XP。在 XP 中是否有备用 API 调用可以让我检索相同的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:14:12.823

您可以使用WMI 类来获取函数[`Win32_PnPEntity`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394353%28v=vs.85%29.aspx)返回的大部分信息。`SetupDiGetDeviceProperty`

试试这个 C++ 示例

```
#include "stdafx.h"
#define _WIN32_DCOM
#include <iostream>
using namespace std;
#include <comdef.h>
#include <Wbemidl.h>
# pragma comment(lib, "wbemuuid.lib")

//CREDENTIAL structure
//http://msdn.microsoft.com/en-us/library/windows/desktop/aa374788%28v=vs.85%29.aspx
#define CRED_MAX_USERNAME_LENGTH            513
#define CRED_MAX_CREDENTIAL_BLOB_SIZE       512
#define CREDUI_MAX_USERNAME_LENGTH CRED_MAX_USERNAME_LENGTH
#define CREDUI_MAX_PASSWORD_LENGTH (CRED_MAX_CREDENTIAL_BLOB_SIZE / 2)

#pragma argsused
int main(int argc, char* argv[])
{
    wchar_t pszName[CREDUI_MAX_USERNAME_LENGTH+1] = L"user";
    wchar_t pszPwd[CREDUI_MAX_PASSWORD_LENGTH+1]  = L"password";
    BSTR strNetworkResource;
    //To use a WMI remote connection set localconn to false and configure the values of the pszName, pszPwd and the name of the remote machine in strNetworkResource
    bool localconn = true;  
    strNetworkResource = localconn ?  L"\\\\.\\root\\CIMV2" : L"\\\\remote--machine\\root\\CIMV2";

    COAUTHIDENTITY *userAcct =  NULL ;
    COAUTHIDENTITY authIdent;

    // Initialize COM. ------------------------------------------

    HRESULT hres;
    hres =  CoInitializeEx(0, COINIT_MULTITHREADED);
    if (FAILED(hres))
    {
        cout << "Failed to initialize COM library. Error code = 0x" << hex << hres << endl;
        cout << _com_error(hres).ErrorMessage() << endl;
        cout << "press enter to exit" << endl;
        cin.get();      
        return 1;                  // Program has failed.
    }

    // Set general COM security levels --------------------------

    if (localconn)
        hres =  CoInitializeSecurity(
            NULL,
            -1,                          // COM authentication
            NULL,                        // Authentication services
            NULL,                        // Reserved
            RPC_C_AUTHN_LEVEL_DEFAULT,   // Default authentication
            RPC_C_IMP_LEVEL_IMPERSONATE, // Default Impersonation
            NULL,                        // Authentication info
            EOAC_NONE,                   // Additional capabilities
            NULL                         // Reserved
            );
    else
        hres =  CoInitializeSecurity(
            NULL,
            -1,                          // COM authentication
            NULL,                        // Authentication services
            NULL,                        // Reserved
            RPC_C_AUTHN_LEVEL_DEFAULT,   // Default authentication
            RPC_C_IMP_LEVEL_IDENTIFY,    // Default Impersonation
            NULL,                        // Authentication info
            EOAC_NONE,                   // Additional capabilities
            NULL                         // Reserved
            );

    if (FAILED(hres))
    {
        cout << "Failed to initialize security. Error code = 0x" << hex << hres << endl;
        cout << _com_error(hres).ErrorMessage() << endl;
        CoUninitialize();
        cout << "press enter to exit" << endl;
        cin.get();      
        return 1;                    // Program has failed.
    }

    // Obtain the initial locator to WMI -------------------------

    IWbemLocator *pLoc = NULL;
    hres = CoCreateInstance(CLSID_WbemLocator, 0, CLSCTX_INPROC_SERVER, IID_IWbemLocator, (LPVOID *) &pLoc);

    if (FAILED(hres))
    {
        cout << "Failed to create IWbemLocator object." << " Err code = 0x" << hex << hres << endl;
        cout << _com_error(hres).ErrorMessage() << endl;
        CoUninitialize();       
        cout << "press enter to exit" << endl;
        cin.get();      
        return 1;                 // Program has failed.
    }

    // Connect to WMI through the IWbemLocator::ConnectServer method

    IWbemServices *pSvc = NULL;

    if (localconn)  
        hres = pLoc->ConnectServer(
             _bstr_t(strNetworkResource),      // Object path of WMI namespace
             NULL,                    // User name. NULL = current user
             NULL,                    // User password. NULL = current
             0,                       // Locale. NULL indicates current
             NULL,                    // Security flags.
             0,                       // Authority (e.g. Kerberos)
             0,                       // Context object
             &pSvc                    // pointer to IWbemServices proxy
             );
    else
        hres = pLoc->ConnectServer(
            _bstr_t(strNetworkResource),  // Object path of WMI namespace
            _bstr_t(pszName),             // User name
            _bstr_t(pszPwd),              // User password
            NULL,                // Locale
            NULL,                // Security flags
            NULL,                // Authority
            NULL,                // Context object
            &pSvc                // IWbemServices proxy
            );

    if (FAILED(hres))
    {
        cout << "Could not connect. Error code = 0x" << hex << hres << endl;    
        cout << _com_error(hres).ErrorMessage() << endl;
        pLoc->Release();
        CoUninitialize();
        cout << "press enter to exit" << endl;
        cin.get();          
        return 1;                // Program has failed.
    }

    cout << "Connected to root\\CIMV2 WMI namespace" << endl;

    // Set security levels on the proxy -------------------------
    if (localconn)
        hres = CoSetProxyBlanket(
           pSvc,                        // Indicates the proxy to set
           RPC_C_AUTHN_WINNT,           // RPC_C_AUTHN_xxx
           RPC_C_AUTHZ_NONE,            // RPC_C_AUTHZ_xxx
           NULL,                        // Server principal name
           RPC_C_AUTHN_LEVEL_CALL,      // RPC_C_AUTHN_LEVEL_xxx
           RPC_C_IMP_LEVEL_IMPERSONATE, // RPC_C_IMP_LEVEL_xxx
           NULL,                        // client identity
           EOAC_NONE                    // proxy capabilities
        );
    else
    {
        // Create COAUTHIDENTITY that can be used for setting security on proxy
        memset(&authIdent, 0, sizeof(COAUTHIDENTITY));
        authIdent.PasswordLength = wcslen (pszPwd);
        authIdent.Password = (USHORT*)pszPwd;
        authIdent.User = (USHORT*)pszName;
        authIdent.UserLength = wcslen(pszName);
        authIdent.Domain = 0;
        authIdent.DomainLength = 0;
        authIdent.Flags = SEC_WINNT_AUTH_IDENTITY_UNICODE;
        userAcct = &authIdent;

        hres = CoSetProxyBlanket(
           pSvc,                           // Indicates the proxy to set
           RPC_C_AUTHN_DEFAULT,            // RPC_C_AUTHN_xxx
           RPC_C_AUTHZ_DEFAULT,            // RPC_C_AUTHZ_xxx
           COLE_DEFAULT_PRINCIPAL,         // Server principal name
           RPC_C_AUTHN_LEVEL_PKT_PRIVACY,  // RPC_C_AUTHN_LEVEL_xxx
           RPC_C_IMP_LEVEL_IMPERSONATE,    // RPC_C_IMP_LEVEL_xxx
           userAcct,                       // client identity
           EOAC_NONE                       // proxy capabilities
        );
    }

    if (FAILED(hres))
    {
        cout << "Could not set proxy blanket. Error code = 0x" << hex << hres << endl;
        cout << _com_error(hres).ErrorMessage() << endl;
        pSvc->Release();
        pLoc->Release();
        CoUninitialize();
        cout << "press enter to exit" << endl;
        cin.get();      
        return 1;               // Program has failed.
    }

    // Use the IWbemServices pointer to make requests of WMI ----

    IEnumWbemClassObject* pEnumerator = NULL;
    hres = pSvc->ExecQuery( L"WQL", L"SELECT * FROM Win32_PnPEntity",
    WBEM_FLAG_FORWARD_ONLY | WBEM_FLAG_RETURN_IMMEDIATELY, NULL, &pEnumerator);

    if (FAILED(hres))
    {
        cout << "ExecQuery failed" << " Error code = 0x"    << hex << hres << endl;
        cout << _com_error(hres).ErrorMessage() << endl;
        pSvc->Release();
        pLoc->Release();
        CoUninitialize();
        cout << "press enter to exit" << endl;
        cin.get();      
        return 1;               // Program has failed.
    }

    // Secure the enumerator proxy
    if (!localconn)
    {

        hres = CoSetProxyBlanket(
            pEnumerator,                    // Indicates the proxy to set
            RPC_C_AUTHN_DEFAULT,            // RPC_C_AUTHN_xxx
            RPC_C_AUTHZ_DEFAULT,            // RPC_C_AUTHZ_xxx
            COLE_DEFAULT_PRINCIPAL,         // Server principal name
            RPC_C_AUTHN_LEVEL_PKT_PRIVACY,  // RPC_C_AUTHN_LEVEL_xxx
            RPC_C_IMP_LEVEL_IMPERSONATE,    // RPC_C_IMP_LEVEL_xxx
            userAcct,                       // client identity
            EOAC_NONE                       // proxy capabilities
            );

        if (FAILED(hres))
        {
            cout << "Could not set proxy blanket on enumerator. Error code = 0x" << hex << hres << endl;
            cout << _com_error(hres).ErrorMessage() << endl;
            pEnumerator->Release();
            pSvc->Release();
            pLoc->Release();
            CoUninitialize();
            cout << "press enter to exit" << endl;
            cin.get();              
            return 1;               // Program has failed.
        }
    }

    // Get the data from the WQL sentence
    IWbemClassObject *pclsObj = NULL;
    ULONG uReturn = 0;

    while (pEnumerator)
    {
        HRESULT hr = pEnumerator->Next(WBEM_INFINITE, 1, &pclsObj, &uReturn);

        if(0 == uReturn || FAILED(hr))
          break;

        VARIANT vtProp;

                hr = pclsObj->Get(L"Description", 0, &vtProp, 0, 0);// String
                if (!FAILED(hr))
                {
                  if ((vtProp.vt==VT_NULL) || (vtProp.vt==VT_EMPTY))
                    wcout << "Description : " << ((vtProp.vt==VT_NULL) ? "NULL" : "EMPTY") << endl;
                  else
                  if ((vtProp.vt & VT_ARRAY))
                    wcout << "Description : " << "Array types not supported (yet)" << endl;
                  else
                    wcout << "Description : " << vtProp.bstrVal << endl;
                }
                VariantClear(&vtProp);

                hr = pclsObj->Get(L"DeviceID", 0, &vtProp, 0, 0);// String
                if (!FAILED(hr))
                {
                  if ((vtProp.vt==VT_NULL) || (vtProp.vt==VT_EMPTY))
                    wcout << "DeviceID : " << ((vtProp.vt==VT_NULL) ? "NULL" : "EMPTY") << endl;
                  else
                  if ((vtProp.vt & VT_ARRAY))
                    wcout << "DeviceID : " << "Array types not supported (yet)" << endl;
                  else
                    wcout << "DeviceID : " << vtProp.bstrVal << endl;
                }
                VariantClear(&vtProp);

                hr = pclsObj->Get(L"HardwareID", 0, &vtProp, 0, 0);// String
                if (!FAILED(hr))
                {
                  if ((vtProp.vt==VT_NULL) || (vtProp.vt==VT_EMPTY))
                    wcout << "HardwareID : " << ((vtProp.vt==VT_NULL) ? "NULL" : "EMPTY") << endl;
                  else
                  if ((vtProp.vt & VT_ARRAY))
                    wcout << "HardwareID : " << "Array types not supported (yet)" << endl;
                  else
                    wcout << "HardwareID : " << vtProp.bstrVal << endl;
                }
                VariantClear(&vtProp);

                hr = pclsObj->Get(L"Manufacturer", 0, &vtProp, 0, 0);// String
                if (!FAILED(hr))
                {
                  if ((vtProp.vt==VT_NULL) || (vtProp.vt==VT_EMPTY))
                    wcout << "Manufacturer : " << ((vtProp.vt==VT_NULL) ? "NULL" : "EMPTY") << endl;
                  else
                  if ((vtProp.vt & VT_ARRAY))
                    wcout << "Manufacturer : " << "Array types not supported (yet)" << endl;
                  else
                    wcout << "Manufacturer : " << vtProp.bstrVal << endl;
                }
                VariantClear(&vtProp);

                hr = pclsObj->Get(L"PNPDeviceID", 0, &vtProp, 0, 0);// String
                if (!FAILED(hr))
                {
                  if ((vtProp.vt==VT_NULL) || (vtProp.vt==VT_EMPTY))
                    wcout << "PNPDeviceID : " << ((vtProp.vt==VT_NULL) ? "NULL" : "EMPTY") << endl;
                  else
                  if ((vtProp.vt & VT_ARRAY))
                    wcout << "PNPDeviceID : " << "Array types not supported (yet)" << endl;
                  else
                    wcout << "PNPDeviceID : " << vtProp.bstrVal << endl;
                }
                VariantClear(&vtProp);

        pclsObj->Release();
        pclsObj=NULL;
    }

    // Cleanup

    pSvc->Release();
    pLoc->Release();
    pEnumerator->Release();
    if (pclsObj!=NULL)
     pclsObj->Release();

    CoUninitialize();
    cout << "press enter to exit" << endl;
    cin.get();
    return 0;   // Program successfully completed.
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T15:02:39.617

`SetupDiGetDeviceProperty`是 Window Vista 及更高版本，但[`SetupDiGetDeviceRegistryProperty`](http://msdn.microsoft.com/en-us/library/windows/hardware/ff551967%28v=vs.85%29.aspx)在 Windows XP 中可用。出于查询的目的，`FriendlyName`它应该是一个足够（且容易）的替换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:04:59.300

您可以查看[Windows Portable Devices 界面](http://msdn.microsoft.com/en-us/library/windows/desktop/dd319285%28v=vs.85%29.aspx)。我曾经使用过这种技术，我认为它也适用于 XP。

# html - HTML/CSS - 列表 - 使用列表样式时将背景颜色应用于整行？

> ID：10721376
> 
> 赞同：1
> 
> 时间：2012-05-23T13:50:31.483
> 
> 标签：html, css, html-lists, styling

我正在尝试重新设计我的网站菜单配置。

我正在使用列表来显示菜单选项，并且列表的样式类型为圆形。

这是一张图片：

![1](../Images/bd32012948acf979ed568e539e1e11fc.png)

这是代码：

```
<li class='category'><a href='$docPath/category/$catDirPath/'>$catName</a></li>

li.listCategory {
    list-style-type: circle;
    margin-left: 17px;
} 
```

我想要做的是，一旦该人选择了导航菜单的这一部分，就将整行突出显示为黄色。

与此相关的所有代码都在工作，但我遇到的问题是关于这一行或`<li>`标签的样式。

我的第一次尝试会产生不良影响：

![2](../Images/47e6ca12916389b17c7c1a1969018589.png)

```
<li class='category' id='selectedCat'><a href='$docPath/category/$catDirPath/'>$catName</a></li>

li#selectedCat {
    background-color: #FFCC00;
    list-style-type: disc;
} 
```

因此，我删除了类别类中设置的边距，最终得到以下结果：

![3](../Images/93ad5ebf0d276b013ea432b850948263.png)

请注意，现在我的漂亮列表样式也显示该选项已被选中，它刚刚消失了......

所以我基本上想做的是给这个区域设置样式：

![4](../Images/9d3b9a93bbc410a4aba2ec7ab53e45b7.png)

有没有人对我如何完成这项任务有任何建议或想法？

提前感谢您抽出宝贵时间阅读本文！！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T13:52:49.370

您需要一个附加`list-style-position: inside;`项才能在列表项内移动项目符号。

[https://developer.mozilla.org/en/CSS/list-style-position](https://developer.mozilla.org/en/CSS/list-style-position)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T13:58:44.507

这将做：

```
li#selectedCat {
    padding: 5px;
    background-color: #FFCC00;
    list-style-position: inside;
    list-style-type: disc;
} 
```

演示：[http ://dabblet.com/gist/2775371](http://dabblet.com/gist/2775371)

# .htaccess - 重定向错误的目录请求

> ID：10721379
> 
> 赞同：0
> 
> 时间：2012-05-23T13:50:36.687
> 
> 标签：.htaccess

在过去的几天里，bingbot 试图访问不存在的页面，我到现在还没有找到这些链接的来源。在原始有效网址之前，它增加了一个随机目录，例如：

```
GET /ToWLQ/my-valid-url-here-4416.html HTTP/1.1" 404 2608 "-" "Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)"

My correct url is:
/my-valid-url-here-4416.html 
```

字符串 /XuRT/ 和页面经常更改。

我想通过 htaccess 重定向以避免很多错误。

```
from: /ToWLQ/my-valid-url-here-4416.html  
to: /my-valid-url-here-4416.html 
```

谢谢

维拉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T17:01:04.943

这里的最佳答案取决于您是否可以有效地概括 bingbot 为您的页面添加前缀的模式，以及您的页面模式。根据您在问题中提供的信息，您的 .htaccess 中的类似规则将起作用：

```
RewriteRule ^[A-Z][a-z][A-Z]+/(.*) $1 [L,R=301,QSA] 
```

这假设第一个字母是大写，第二个是小写，其余的都是大写，然后是斜线，然后是你的真实页面。

**编辑**：基于更多信息的新重写规则：

```
RewriteCond %{HTTP_USER_AGENT}  (msnbot|bingbot)
RewriteRule ^([a-zA-Z]{5}/)+(.*) $2 [L,R=301,QSA] 
```

# java - 未装饰窗户的 Windows Snap 功能？

> ID：10721380
> 
> 赞同：2
> 
> 时间：2012-05-23T13:50:37.720
> 
> 标签：java, swing, awt

有谁知道允许未装饰的窗户使用此功能的方法？唯一的另一种选择是重新实施它。有任何想法吗？谢谢。

![在此处输入图像描述](../Images/cadcfafc3358951708bb0564300f3559.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:46:58.803

*   可停靠可以在ĺy [JToolBar](http://docs.oracle.com/javase/tutorial/uiswing/components/toolbar.html)

或者

*   [J内部框架](http://docs.oracle.com/javase/tutorial/uiswing/components/internalframe.html)

在 Win7 中半透明和未装饰的 JFrame 内部

# visual-studio-2008 - 在 MS Visual Studio 2005 中为 32 位和 64 位构建 MSI

> ID：10721388
> 
> 赞同：1
> 
> 时间：2012-05-23T13:51:01.837
> 
> 标签：visual-studio-2008, windows-installer, 32bit-64bit

全部，

我想将与 32 位和 64 位相关的两个文件放在一个 MSI 项目中 让我知道是否有人做过

谢谢拉杰尼尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T05:52:59.097

x86 和 x64 机器上只能安装 32 位 MSI 软件包。但是，32 位 MSI 包无法写入 x64 机器上的 64 位位置，例如“C:\Program Files”或“C:\Windows\system32”。它将始终被重定向到“C:\Program Files (x86)”或“C:\Windows\SysWOW64”。您是否需要将 64 位文件安装在 64 位位置？

# salesforce - 如何在 Salesforce 到 Salesforce 连接上维护查找关系？

> ID：10721390
> 
> 赞同：0
> 
> 时间：2012-05-23T13:51:07.373
> 
> 标签：salesforce, data-sharing

我们的客户需要通过 Salesforce 将联系人信息从合作伙伴组织导入到 Salesforce。他们还需要导入具有联系人查找字段的 CustomObject__c 记录（即：一个联系人有 n 个 CustomObject__c）。

在导入联系人 A（在我的组织上创建副本）后，我如何才能实现这一点，我导入的属于合作伙伴组织中联系人 A 的 CustomObjects 将与我组织中的同一联系人 A 相关联？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T19:32:20.803

假设数据迁移不仅仅是一次性活动，您将需要在您的联系人对象上创建一个公式字段，该字段将保存记录的原始 ID。然后，您可以将此值映射到目标组织的联系人对象上的文本字段。然后，您的 CustomObject__c 对象上的触发器中的一些代码应该能够根据旧 ID 查询正确的联系人记录，然后相应地更新查找字段。

有关代码示例，请查看 Salesforce 到 Salesforce指南的[最佳实践中](http://wiki.developerforce.com/page/Best_Practices_for_Salesforce_to_Salesforce#Best_Practice%3a_Reestablishing_lookup_relationships)的“重新建立查找关系”部分。

# sms - 写短信时Arduino重启

> ID：10721398
> 
> 赞同：2
> 
> 时间：2012-05-23T13:51:29.530
> 
> 标签：sms, arduino, gsm

当我尝试响应发送到机器的 SMS 时，我的 Arduino（Arduino Duemilanove 克隆）重新启动。这可能是内存问题（它只有 2048 字节 RAM）吗？

我对变量使用的不多。只有发送工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:17:58.007

GSM 库占用的字节数略少于 1000 个字节。您用于调试的串行端口（假设您使用它），另外 100 个左右。所以我猜你内存不足导致调试控制台出现垃圾或重新启动Arduino。

您可以根据我在 Arduino Cookbook 中找到的信息使用此代码检查您的记忆：

```
int memory_free()
{
    int free_value;
    if ((int)__brkval == 0)
        free_value = ((int)&free_value) - ((int)&__bss_end);
    else
        free_value = ((int)&free_value) - ((int)__brkval);
    return free_value;
} 
```

根据我的经验，如果返回的字节数少于 150，那么您就有麻烦了。

如果 SMS 的缓冲区大小最多为 160 个字符，则将其减至最小。一旦一切正常，将任何内容切换到调试控制台（保存超过 100 个字节）并增加 SMS 大小。您实际上可以通过发送短信来进行调试，包括内存状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T07:42:43.087

如果您的 Arduino 和 GSM 调制解调器使用相同的电源，那么您可以尝试使用更好的电源并重复测试。您还可以分离电源 - 一个用于 Arduino，一个用于 GSM 调制解调器，然后重复测试。如果 GSM 调制解调器靠近 Arduino，您可以尝试将其移得更远。如果在所有这些措施之后仍然发生重置，则您有软件问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-24T16:37:46.090

如果电源和内存都正常，那么您的 Arduino 正在重新启动，因为程序中有错误。寻找杂散指针。

# python - 为什么python中日期时间对象的json序列化不能为日期时间对象开箱即用

> ID：10721409
> 
> 赞同：53
> 
> 时间：2012-05-23T13:52:03.117
> 
> 标签：python, json, serialization, simplejson

为什么 json 序列化不适用于 datetime 对象。据我了解 json 序列化，任何对象的基本思想都可以调用 `__str__`内置函数，然后对作为响应的对象进行 urlencode。但是在日期时间的情况下，我会收到以下错误

```
TypeError: datetime.datetime(2012, 5, 23, 18, 38, 23, 37566) is not JSON serializable 
```

虽然有`__str__`一种方法可以将已经可用的对象串起来，但似乎有意识地决定不这样做，为什么会这样？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2012-05-23T14:01:05.543

`json`不，它在模块中不起作用。该模块为您提供了一个默认编码器：`json.JSONEncoder`. 您需要扩展它以提供`default`序列化对象的方法的实现。像这样的东西：

```
import json
import datetime
from time import mktime

class MyEncoder(json.JSONEncoder):

    def default(self, obj):
        if isinstance(obj, datetime.datetime):
            return int(mktime(obj.timetuple()))

        return json.JSONEncoder.default(self, obj)

print json.dumps(obj, cls=MyEncoder) 
```

正如其他人正确指出的那样，原因是[json 的标准](http://www.json.org/)没有指定如何表示日期时间。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-23T13:57:00.117

你希望它们如何被序列化？

JSON 没有指定如何处理日期，因此 python`json`库无法决定如何为您表示这些日期。这完全取决于另一方（浏览器、脚本等）如何处理 JSON 中的日期。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-08-26T11:31:37.160

修补 json 模块以使序列化支持日期时间的简单方法。

```
import json
import datetime

json.JSONEncoder.default = lambda self,obj: (obj.isoformat() if isinstance(obj, datetime.datetime) else None) 
```

比像往常一样使用 json 序列化 - 这次将 datetime 序列化为 isoformat。

```
json.dumps({'created':datetime.datetime.now()}) 
```

导致：'{"created": "2015-08-26T14:21:31.853855"}'

在以下位置查看更多详细信息和一些注意事项： [StackOverflow：Python 和 JavaScript 之间的 JSON 日期时间](https://stackoverflow.com/questions/455580/json-datetime-between-python-and-javascript/32224522#32224522)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-10-19T21:51:07.393

如果你想在不实现的情况下获得日期时间的编码和解码，你可以使用[json_tricks](https://github.com/mverleg/pyjson_tricks)，它是一个为各种流行类型添加编码和解码的包装器。只需安装：

```
pip install json_tricks 
```

然后从而`json_tricks`不是导入`json`，例如：

```
from json_tricks import dumps, loads
json = dumps({'name': 'MyName', 'birthday': datetime.datetime(1992, 5, 23, 18, 38, 23, 37566)})
me = loads(json) 
```

免责声明：它是由我制作的。因为我有同样的问题。

* * *

如果你想自动序列化任何可以被字符串化的东西，你可以很容易地用标准实现来做到这一点：

```
dumps(obj, default=str) 
```

但请注意，这有缺点，例如，如果不付出额外的努力，它们都不会被反序列化，也许有时你只是不想序列化某些东西（比如一个大的 numpy 数组的函数），而是得到一个警告，这种方法会安静。

# xml - 如何从整个 XML 文件中获取特定标签以添加到列表框？

> ID：10721410
> 
> 赞同：2
> 
> 时间：2012-05-23T13:52:06.300
> 
> 标签：xml, vb.net, visual-studio-2010, listbox, nodes

我的 XML 文件如下所示：

```
<?xml version="1.0" encoding="utf-8" ?>
<Tabel>
  <Member>
    <Naam>Cruciatum</Naam>
    <Kills>1000</Kills>
    <Deaths>10</Deaths>
    <KD>100</KD>
  </Member>
</Tabel> 
```

添加更多节点时，如何获取`<Naam>`要添加到列表框中的标签中的值？

注意：没有固定数量的`<Member>`节点，它们都必须将它们的`<Naam>`元素添加到列表框中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:09:03.613

```
 Dim doc = XDocument.Load("members.xml")
    Dim members = From m In doc.Element("Tabel").Elements("Member")
                  Select naam = m.Element("Naam").Value
    For Each member In members
        lstmembers.Items.Add(member)
    Next 
```

编辑：针对 VB.NET 和 op 的细节进行了更改

# javascript - 用于检索所有用户信息的 Javascript 函数

> ID：10721412
> 
> 赞同：0
> 
> 时间：2012-05-23T13:52:20.187
> 
> 标签：javascript, facebook, facebook-graph-api

我有这个功能可以帮助我检索我的朋友 ID，但我似乎无法让它用于检索一个朋友的 ID。我需要做一个循环来获取所有朋友的 ID。

你能帮我处理这段代码吗？

```
function(response) {
    console.log(response);
    var testdiv = document.getElementById("test");
    testdiv.innerHTML = (
        response[0].uid2
    );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:00:21.277

只需迭代`response`：

```
for (i=0; i<=response.length; i++) {
   var uid2 = response[i].uid2;
   // do what you need to with uid2
} 
```

[`for`这里的文档](https://developer.mozilla.org/en/JavaScript/Reference/Statements/for)

并展示你将如何使用它

```
function(response) {
    console.log(response);
    var testdiv = document.getElementById("test");
    var newhtml = "";
    for (i=0; i<=response.length; i++) {
       newhtml += response[i].uid2;
    }
    testdiv.innerHTML = newhtml;
} 
```

# facebook-graph-api - Facebook 粉丝专页应用

> ID：10721417
> 
> 赞同：2
> 
> 时间：2012-05-23T13:52:39.607
> 
> 标签：facebook-graph-api, facebook-c#-sdk, facebook-apps

我已经使用 c# sdk 构建了一些 facebook 应用程序。并使用下面的代码检查用户是否喜欢粉丝页面并显示内容以反映这一点。

```
protected void Page_Load(object sender, EventArgs e)
{
    if (Session["SignedRequest"] != null)
    {
        signedRequest = Session["SignedRequest"].ToString();
    }
    else
    {
        signedRequest = Request.Form["signed_request"];
    }

    if (!string.IsNullOrEmpty(signedRequest))
    {
        dynamic SignedRequestData;
        var DecodedSignedRequest = FacebookWebContext.Current.SignedRequest.Data;
        SignedRequestData = DecodedSignedRequest

        var RawRequestData = (IDictionary<string, object>)SignedRequestData;

        foreach (KeyValuePair<string, object> paird in RawRequestData)
        {
            Response.Write("key =" + paird.Key.ToString() + " value =" + paird.Value.ToString() + "<br/>");

        }

        if (RawRequestData.ContainsKey("page"))
        {
            Facebook.JsonObject RawPageData = (Facebook.JsonObject)RawRequestData["page"];

            if (RawPageData.ContainsKey("liked"))
            {
                if (bool.Parse(RawPageData["liked"].ToString()))
                {
                    LikedContent.Visible = true;

                    if (!IsPostBack)
                    {
                        PageSetup();
                    }
                }
                else
                {
                    UnlikedContent.Visible = true;
                }
            }
            else
            {
                UnlikedContent.Visible = true;
            }
        }
        else
        {
            DefaultContent.Visible = true;
        }
    }
    else
    {
        DefaultContent.Visible = true;
    }
} 
```

这样做的问题是，如果我在应用程序上有多个页面，我会遇到跨域问题。可以很容易地解决这个问题，即使用 gloabl.asac.cs 文件中的 p3p 标头。然而，这个问题仍然存在于 Safari 中。

现在，c# sdk 的当前版本 6 建议使用 facebook javascript sdk 来调用打开的图形并检查用户是否喜欢一个页面，然后将其传递给后面的代码，我想知道实际上构建的最佳实践是什么Facebook粉丝页面标签应用程序？

当我使用 javascript sdk 访问用户信息时，我会弹出一个框来授权该应用程序。我不想要这个。有办法解决这个问题吗？

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T05:40:50.510

您可以在后面的代码中调用这样的图形 api 方法

```
void CallFacebookApi(string oAuthToken, string userId)
{       
string userLikeUrl = "https://graph.facebook.com/me/Likes/" + pageId +"?access_token=" + oAuthToken;

  response = requestFBData(userLikeUrl);
  if (response.Length > 0)
    {

     JObject userLike = JObject.Parse(response);
     int count = userLike["data"].Count();

     if (count > 0){
     //user liked your page.
     } 
     else {
      //user do not liked your page yet
      }
    }

 }

public string requestFBData(string action)
{
   string results = string.Empty;

    try
    {
     HttpWebRequest req = (HttpWebRequest)WebRequest.Create(action);
     HttpWebResponse resp = (HttpWebResponse)req.GetResponse();

     StreamReader sr = new StreamReader(resp.GetResponseStream());
     results = sr.ReadToEnd();
     sr.Close();
    }
    catch (Exception e)
    {
      if (e.Message.Contains("400"))
      {
       //invalid reponse
      }
    }

    return results;
  } 
```

# c# - WebGui 中的 ShowDialog 不等待响应

> ID：10721421
> 
> 赞同：2
> 
> 时间：2012-05-23T13:52:52.880
> 
> 标签：c#, asp.net, html, visual-web-gui

解决 webgui 中 ShowDialog 问题的最佳方法是什么？

我有两个表格。MainForm i LogonForm。在 MainForm 的页面加载上，我想显示 LogonForm（通过 ShowDialog）供用户连接到数据库。当结果正常时，主窗体的其余部分将加载。

但是在 webgui ShowDialog 中的工作方式与在 WinForms 中不同。并且在显示 LogonFrom 之后它不会等待响应（因此响应不正确）。

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:18:29.843

由于网站的性质，必须先完成整个 Load 方法，然后才能将任何内容发送到客户端。理论上，您可以构建整个页面，隐藏所有内容，然后在成功登录后显示它，但这仍然需要将页面的所有信息发送给客户端，以及任何精明的用户如果他们愿意，将能够查看所有这些内容。

您需要做的是不在对话框下方的页面上生成任何内容，并且当用户按下登录弹出窗口上的“提交”（或其他）按钮时，您应该向服务器发送一个新请求（而不是尝试处理它是客户端），您在其中验证用户，如果合适，将它们重定向到主页。

现在通常网站只会有一个单独的登录页面，它会将您发送到常规页面。如果你想有一个弹出窗口，你可以，但它只是一个空白站点顶部的弹出窗口，它重定向到一个全新的页面而没有弹出窗口（成功登录时）。

Web 环境本质上不同于桌面应用程序，作为程序员，它需要您进行重大的范式转换。解决方案不仅仅是“我如何阻止表单加载直到弹出窗口完成”，因为阻止表单加载意味着用户永远看不到任何东西（这会导致死锁）。

# xpages - 从客户端 JS 调用事件处理程序

> ID：10721422
> 
> 赞同：0
> 
> 时间：2012-05-23T13:52:55.790
> 
> 标签：xpages, xpages-ssjs

我正在查看 Jeremy Hodge 的这篇文章 [http://xpagesblog.com/XPagesHome.nsf/Entry.xsp?documentId=88065536729EA065852578CB0066ADEC](http://xpagesblog.com/XPagesHome.nsf/Entry.xsp?documentId=88065536729EA065852578CB0066ADEC) 使用事件处理程序并从 ClientSide JS 调用它们。但是，如果我将一些 SSJS 放在我想触发的事件中，我可以让它们工作。

这仍然有效还是我做错了什么？

```
 <xp:button value="click me" id="button1">
        <xp:eventHandler event="onclick" submit="true"
            refreshMode="complete">
            <xp:this.script><![CDATA[executeOnServer('dostuff');]]></xp:this.script>

        </xp:eventHandler>
    </xp:button>
    <xp:eventHandler event="onfubar" id="dostuff" submit="true">
        <xp:this.action><![CDATA[#{javascript:print("1");viewScope.data="Y"}]]></xp:this.action>
    </xp:eventHandler> 
```

executeOnServer 函数直接来自 Jeremys 页面

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-24T10:30:29.433

如果事件包含在自定义控件中，则该事件是自定义控件的子控件，并且在 XPage 中的事件中具有另一个 ID。

普通 XPage 中的事件 id：

```
view:_id1:dostuff 
```

如果它包含在自定义控件中：

```
view:_id1:_id5:dostuff 
```

其中**_id5**是自定义控件的 id。

这不适用于当前的 CSJS 代码。

要解决此问题，您可以向自定义控件添加一个 id

```
 <xc:event id="abc"></xc:event> 
```

然后计算自定义控件的id并添加到事件中：

```
<xp:button value="click meCC" id="button1">
    <xp:eventHandler event="onclick" submit="false"
        refreshMode="none">
        <xp:this.script><![CDATA[
        var ccId = '#{javascript:getComponent('abc').getId()}';
         executeOnServer(ccId + ':dostuff');]]></xp:this.script>
    </xp:eventHandler>
</xp:button> 
```

希望这可以帮助

斯文

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-29T14:56:20.093

发现问题不在我的代码中，而是在 Executeonserver 代码中。感谢大家帮助获得解决方案。

此行需要更改 dojo.query('[name="$$xspsubmitid"]')[0].value = form.id + ':' +functionName;

至

dojo.query('[name="$$xspsubmitid"]')[0].value = functionName;

当然，当你得到答案时，一切都很容易。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T15:23:29.560

首先，对于“click me”按钮，“Server Options”应该设置为“No Submission”（删除 refreshMode="complete" 并设置 submit="false"）。这意味着它只执行客户端脚本（在这种情况下运行“dostuff”事件）。其次，“dostuff”事件处理程序中的“提交”参数应设置为“假”。

单击“单击我”按钮时，下面的代码将在服务器控制台中打印“1”。希望这可以帮助。

```
<xp:this.resources>
    <xp:script src="/executeOnServer.js" clientSide="true"></xp:script>
</xp:this.resources>

<xp:button value="click me" id="button1">
    <xp:eventHandler event="onclick" submit="false">
        <xp:this.script><![CDATA[executeOnServer("dostuff");]]></xp:this.script>
    </xp:eventHandler>
</xp:button>

<xp:eventHandler event="onfubar" id="dostuff" submit="false">
    <xp:this.action><![CDATA[#{javascript:print("1");}]]></xp:this.action>
</xp:eventHandler> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-26T22:12:21.877

我不知道这是否是您要找的东西，但我更喜欢扩展库 (xe:jsonRpcService) 中的远程服务控件。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-23T19:50:31.690

Jeremy Hodge 就这个主题写了一篇很棒的博客文章。 [http://xpagesblog.com/XPagesHome.nsf/Entry.xsp?documentId=88065536729EA065852578CB0066ADEC](http://xpagesblog.com/XPagesHome.nsf/Entry.xsp?documentId=88065536729EA065852578CB0066ADEC)

事件处理程序可以在没有周围按钮的情况下存在，给事件处理程序一个 id 并且您可以访问它。

# php - jQuery $.post 发送正确的变量，但 PHP 什么也没收到

> ID：10721428
> 
> 赞同：3
> 
> 时间：2012-05-23T13:53:13.387
> 
> 标签：php, jquery, post

我有这个 jQuery 脚本，它将用户名和密码发送到 PHP 文件，该文件检查该用户是否存在并返回 JSON 用户对象。在非 IE 浏览器中工作正常，但 IE 失败。

奇怪的是，IE“萤火虫”说一切都很好，但 PHP 脚本没有收到任何变量......

**这是请求正文：**

> 用户名=johanderowan&密码=1234

**这些是请求标头（出于安全原因，我省略了一些变量）：**

> Request = POST /1.0/account/login.json HTTP/1.1
> Accept = **/**
> Origin = [DEVURL]
> Accept-Language = nl-NL
> UA-CPU = AMD64
> Accept-Encoding = gzip, deflate
> User-Agent = Mozilla/5.0（兼容; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
> Host = [DEVURL]
> Content-Length = 66
> Connection Keep-Alive Cache-Control no-cache

**响应正文是（前三个空数组是 $_GET、$_POST 和 $_REQUEST）：**

> Array ( )
> Array ( )
> Array ( )
> {"status":"error","message":"未指定用户名或密码。","httpCode":500}

**这是请求脚本：**

```
$('.mobyNowLoginForm form').bind('submit', function(){  
    var username = $(this).find('.username').val();  
    var password = $(this).find('.password').val();  
    $.post('[url]/1.0/account/login.json', {
        username: username,
        password: password
    }, function(response) {
        // do something
    }, "JSON");  
    return false;
}); 
```

我完全不知道这里可能出了什么问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T08:40:27.517

看来 IE 没有在跨域请求中发送正确的内容类型。内容类型始终设置为“文本/纯文本”。

在此博文中了解有关此缺点的更多信息：http: [//blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx](http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx)

我们通过解析 php://input 字符串并将其设置为 $_POST vars 在服务器上解决了这个问题。

```
if ($_SERVER['REQUEST_METHOD'] == 'POST' && count($_POST) == 0) {
    $postData = file_get_contents('php://input');
    $postVars = explode('&', $postData);
    foreach ($postVars as $postVar) {
        list($key, $var) = explode('=', $postVar);
        $_POST[$key] = $var;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:01:03.477

您是否尝试将缓存设置为 false。我有一个类似的问题，这解决了它：

```
$.ajax({
  type: 'POST',
  url: '[url]/1.0/account/login.json',
  dataType: 'json',
  data: {
      username: username,
      password: password
  },
  cache: false,
  success: function() {
      // Do something
  }
}); 
```

我希望这可以帮助你！

史蒂芬

**编辑**

> 问题也可能出在您的请求 URL 中。您尝试调用 .json 文件。您可以尝试调用 .php 文件。

确保你把它放在你的 .php 文件中：

```
header("Content-Type: application/json"); 
```

# javascript - 数据排序应该在客户端还是服务器上进行？

> ID：10721430
> 
> 赞同：19
> 
> 时间：2012-05-23T13:53:14.710
> 
> 标签：javascript, ajax, gwt, sorting, architecture

我从服务器获取数据并希望在客户端使用 GWT 显示它。

GWT 不是这里的问题，您可以通过 Ajax 调用替换 GWT，或者您可以将其转换为实际应用程序而不是 Web 应用程序。

在接收数据之后和显示它们之前，应该在服务器上还是在客户端上使用 JavaScript 进行排序？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-23T14:04:55.290

每种方法都有其优点和缺点：

*   如果需要分页，又不想将整个数据下载到客户端，那么就必须在服务端进行排序（否则客户端只能对当前拥有的行进行排序，会导致错误的结果，如果你按不同的列重新排序）
*   在服务器上排序更快（例如：您可以每秒排序更多行），但如果您必须一次为 10000 个客户端提供服务，这可能很容易反转。
*   在客户端排序时，无需重新下载数据即可重新排序。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-23T14:06:47.923

理想情况下，排序应该在服务器上完成，因为：-

1.  最好假设您的客户资源不足。例如，有些人会从桌面启动 GWT 应用程序，但另一些人可能会从 CPU/RAM 较少的 iPad/手机启动 GWT 应用程序

2.  有在服务器端进行排序的标准方法，例如，通过使用 SQL ORDER BY 子句，但您可能必须实现自己的例程/方法才能在客户端进行排序。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-24T17:33:30.560

这取决于... ：）

1.  有多少数据需要排序？多快？“尽可能快”好的……你能接受的最慢的速度是多少？客户可以处理吗？服务器呢？这些元素还有哪些其他职责，这会产生冲突吗？
2.  数据排序的可靠性如何？例如，如果数据有时没有排序，这样可以吗？
3.  您的架构中的元素是如何分配职责的？就此而言，元素是什么？你有数据库吗？业务层呢？世界可能比“客户端与服务器”更复杂
4.  数据将如何使用？是否需要执行多种排序？例如，A->Z 和 Z->A?
5.  在客户端和服务器之间传输数据的成本是否合理？还有其他方法可以使它合理吗？

从架构上讲，要回答这个问题，您需要确定系统中所需的属性并评估各种设计备选方案之间的权衡。在不了解您的系统的情况下，很难提供除此之外的建议。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-16T15:49:03.563

应该注意一个包罗万象的声明，即在服务器上排序总是比在客户端上排序更快。我有一个案例，我返回了几千条按姓氏和名字串联排序的记录。这些字段都没有被索引，我无法控制这一点。众所周知，对连接的字符串进行排序并不是数据库本质上做得很好的事情。它看起来是数字和/或索引字段。在这种情况下，在客户端上进行排序最终会更快。如果我可以控制数据库，我会在 Oracle 中在这两个字段上放置一个函数索引。

这个故事的寓意是什么都不做，并分析您的应用程序以找出最适合您的场景的方法。

# android - 安装 .apk

> ID：10721436
> 
> 赞同：1
> 
> 时间：2012-05-23T13:53:41.327
> 
> 标签：android, eclipse, android-emulator, android-install-apk

我使用 Eclipse => "export" 为 Android 版本 2.2 生成了一个 apk 文件，然后我将它放入我的 Galaxy ACE GT-S5830M (Android 2.3.6) 并尝试安装，但我收到了这条消息：“你是应用程序安装将替换另一个应用程序。” 但我是第一次安装这个应用程序。当我单击确定时，安装开始但在两秒钟后停止，我收到此错误：“未安装应用程序”。我试了几次。我也试过我朋友的智能手机，他有一个谷歌 Nexus 并且安装成功。我还检查了“允许安装非市场应用程序”，但没有帮助。

有谁知道我能做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T13:57:50.887

是的，当我安装了我在测试调试版本一段时间后编写的最终应用程序时发生在我身上。这两个应用程序被认为是相同的，但具有不同的签名，因此安装失败。我删除了旧的调试版本，安装工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T13:58:05.037

您可以尝试在 eclipse 中重命名应用程序名称和包名称，因为这是 android 识别相同应用程序的方式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T13:59:03.230

确保您的应用程序使用“可能是唯一的”包名称，而不是`com.example`您在手机上运行的其他项目可能使用的名称。有关示例，请参阅[包命名约定](http://en.wikipedia.org/wiki/Java_package#Package_naming_conventions)，它通常围绕您拥有的某些域名来减少冲突的可能性。

# c# - 集合列表具有不止一种类型的用户定义对象？

> ID：10721443
> 
> 赞同：1
> 
> 时间：2012-05-23T13:54:20.480
> 
> 标签：c#, c#-4.0, interface

我有一个静态列表：

```
public static List<IMachines>mList =new List<IMachines>(); 
```

该列表包含两种不同类型的对象（机器）：

```
IMachines machine = new AC();
IMachines machine = new Generator(); 
```

如果在将项目添加到列表后，我想通过其名称属性搜索特定机器，然后在使用 foreach 循环进行遍历之后，如果在列表中找到该项目......我应该如何知道项目是否属于`AC`类型或`Generator`类型？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T13:56:56.503

您可以使用[`is`运算符](http://msdn.microsoft.com/en-us/library/scekt9xw.aspx)：

> 检查对象是否与给定类型兼容

例如：

```
if(item is AC)
{
  // it is AC
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T14:00:13.093

```
 interface IVehicle {

    }

    class Car : IVehicle
    {

    }

    class Bicycle : IVehicle
    {

    }

    static void Main(string[] args)
    {
        var v1 = new Car();
        var v2 = new Bicycle();

        var list = new List<IVehicle>();
        list.Add(v1);
        list.Add(v2);

        foreach (var v in list)
        {
            Console.WriteLine(v.GetType());
        }

    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T14:02:14.447

使用“是”运算符。

```
List<IMachines> list = new List<IMachines>();
list.Add(new AC());
list.Add(new Generator());
foreach(IMachines o in list)
{
  if (o is Ingredient)
  {
    //do sth
  }
  else if (o is Drink)
  {
    //do sth
  }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T13:58:53.207

您还可以使用该`OfType()`方法仅返回指定类型的项目：

```
IEnumerable<Generator> generators = mList.OfType<Generator>(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-23T14:14:48.323

如果你想根据类型做不同的操作，你可以使用`GroupBy` `type`.

通过这样做，您可以获得与每个派生类型对应的子列表。

以下是代码片段

```
 void Main()
    {
        List<IMachines> mList = new List<IMachines>();

        mList.Add(new AC());
        mList.Add(new Generator());
        mList.Add(new AC());
        mList.Add(new Generator());
        mList.Add(new Generator());
        mList.Add(new Generator());

        var differentIMachines = mList.GroupBy(t=>t.GetType());
        foreach(var grouping in differentIMachines)
        {
                Console.WriteLine("Type - {0}, Count - {1}", grouping.Key, grouping.Count());

                foreach(var item in grouping)
                {
                //iterate each item for particular type here
                }
        }

    }

    interface IMachines {   }

    class AC : IMachines {}

    class Generator : IMachines {} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-23T14:02:55.073

使用`is`和`as`运算符。

```
 List<IMachines> mList =new List<IMachines>();
        IMachines machine = mList.Where(x => x.Name == "MachineName").FirstOrDefault();

        if (machine != null)
        {
            if (machine is Generator)
            {
                Generator generator = machine as Generator;
                //do something with generator
            }
            else if (machine is AC)
            {
                AC ac = machine as AC;
                //do something with ac
            }
            else
            {
                //do you other kinds? if no, this is never going to happen
                throw new Exception("Unsupported machine type!!!");
            }

        } 
```

# php - 当我尝试从我的主文件夹中获取文件内容时权限被拒绝

> ID：10721448
> 
> 赞同：0
> 
> 时间：2012-05-23T13:54:35.753
> 
> 标签：php, linux, permissions

我使用名为的系统用户运行 cron 作业，`system_user`并使 cron 作业将其输出保存到`outputFile.txt`我​​的 system_user 主文件夹中的文件中 `/home/system_user/outputDir/outputFile.txt`。

这一切都有效，但现在我需要在我的 php 脚本中访问这个文件，`/var/www/html/scripts/phpScriptFile.php`我得到一个权限被拒绝的错误。

我发现php脚本是用`apache`用户运行的，所以我这样做了：

```
sudo chown system_user:apache outputFile.txt 
```

但这并没有帮助。

如果 cron 在文件`/var/www/html/scripts/`夹中输出文件，那么我不会收到此权限错误。

我试图将 outputFile.txt 移出 /var/www/html 文件夹的原因是，如果我离开它，则可以通过 http 协议访问它，并且我不希望任何人看到此文件的内容。

请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T13:58:43.760

outputFile.txt 的权限是什么？

```
sudo chown system_user:apache outputFile.txt 
```

这将 system_user 保留为所有者，但将组更改为 apache。为此，该文件必须至少`rw-r-----`可以由`chmod 640 outputFile.txt`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:01:44.063

包含该文件的文件夹中的某些权限可能不正确。

此外，可能未命名 apache 用户`apache`的组或未正确分配组权限。

重新分配您的用户组：

```
sudo chown system_user:system_user outputFile.txt 
```

并测试为整个路径授予一般读取权限：

```
chmod o+rx /home/system_user
chmod o+rx /home/system_user/outputDir
chmod o+r /home/system_user/outputDir/outputFile.txt 
```

如果这有效（应该有效），那么您可以尝试调查组名是否正确，将访问权限移动到组部分。

# google-maps - Google Maps API v3 在自定义地图上重复标记

> ID：10721449
> 
> 赞同：4
> 
> 时间：2012-05-23T13:54:36.967
> 
> 标签：google-maps, google-maps-markers, word-wrap, repeat

我有这个问题一段时间了，我已经在网上搜索了答案，但我找不到与我的问题相关的好答案。

![我的问题截图](../Images/939d094c51ef1951f40c2da00e6fe835.png)

你可以看到我渲染了我自己的一组瓷砖。问题是标记水平重复，因为包裹的地图。我不能使用放大技巧来避免这个问题，因为地图必须是动态的，所以它支持多种分辨率。

我希望有人知道如何处理这个问题！我真的很感激。

我使用谷歌地图 API v3。

**编辑**

这是另一个屏幕截图：

![另一个截图](../Images/a8b190432bedff8075312a2879eb00b0.png)

# html - html 文件上传控件不更新 IE7 和 IE8 中的文本框字段

> ID：10721452
> 
> 赞同：0
> 
> 时间：2012-05-23T13:54:39.720
> 
> 标签：html, file, internet-explorer-8, upload, internet-explorer-7

我们这里的一个 QA 人员发现 IE7/IE8 的一个问题，我似乎找不到解决方案。

一个基本的文件上传控件在 IE7/8 中呈现，带有一个浏览按钮和一个文本框。

如果文件路径比文本框长，则无法滚动到路径末尾。好吧，您可以使用左/右箭头或主页/结束键滚动，但文本框未更新/未移动到正确的光标位置。

任何想法为什么？

所有其他浏览器，FF，Google，IE9 都可以。

我还尝试隐藏真正的文件上传控件并使用自定义按钮/文本框“模仿”该控件 - 在此自定义按钮的单击事件中，文件上传单击事件被触发，但 IE 不会像那样上传文件。

提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:05:12.763

文件上传控件的功能非常有限，尤其是在较旧的浏览器中，即使涉及 CSS/脚本也是如此。

无论如何，用户几乎没有理由看到这些信息，因为它只是一个上传文件的路径。由于他们从文件对话框中选择了此文件，因此也没有真正的理由能够编辑此信息。

我不确定这是否符合“为什么”的要求，但它确实解释了为什么对这种类型的控制没有太多关注。是的，它可能与其他浏览器版本不同，但我几乎看不出这是一个严重的 QA 问题，除非对此有特定要求。

# xml - XSLT remove() function

> ID：10721453
> 
> 赞同：1
> 
> 时间：2012-05-23T13:54:50.917
> 
> 标签：xml, xslt-2.0

In XSLT, there is a `remove()` function for sequences. Given a sequence and a position, it returns the sequence minus the item at the given position.

The question is: **How do I employ this function in an actual XSLT file?**

The only place I've found mention of an example that isn't just a regurgitation of the function spec completely devoid of context is here: [http://books.google.com/books?id=W6SpffnfEPoC&pg=PA776&lpg=PA776&dq=xslt+%22remove+function%22&source=bl&ots=DQQrnXF_nB&sig=nrJtpEvYjBaZU0K8iAtdPTGUIbI&hl=en&sa=X&ei=QOq8T7aPDOyI6AHh-JBP&ved=0CEQQ6AEwAQ#v=onepage&q=xslt%20%22remove%20function%22&f=false](http://books.google.com/books?id=W6SpffnfEPoC&pg=PA776&lpg=PA776&dq=xslt+%22remove+function%22&source=bl&ots=DQQrnXF_nB&sig=nrJtpEvYjBaZU0K8iAtdPTGUIbI&hl=en&sa=X&ei=QOq8T7aPDOyI6AHh-JBP&ved=0CEQQ6AEwAQ#v=onepage&q=xslt%20%22remove%20function%22&f=false)

Unfortunately, the stylesheet examples are on pages 777 and 778, which are, of course, not included. And I don't own that book.

So, does anyone have an example of using the `remove()` XSLT function in an actual stylesheet?

**Edit:** Let's provide a slightly more concrete example, shall we?

I have a sequence in an XSLT. This sequence is comprised of all of the lines from a text file.

```
<xsl:variable name="lines" select="tokenize(unparsed-text($filePath), '\r?\n')" /> 
```

Every one of these lines is a record...except for one, which gives me the record count. So I have the following code for finding that line:

```
<xsl:variable name="recordCount">
  <xsl:for-each select="$lines[position()]">
    <xsl:variable name="i" select="position()" />
    <xsl:analyze-string select="$lines[$i]" regex="RECORD COUNT = \d+">
      <xsl:matching-substring>
        <xsl:value-of select="replace($lines[$i], '[^0-9]', '')" />
      </xsl:matching-substring>
    </xsl:analyze-string>
  </xsl:for-each>
</xsl:variable> 
```

I do the above before I start looping through the lines to get all the actual records, so my goal here is to remove the "RECORD COUNT" line from the `$lines` sequence when I find it. That way when I'm looping through grabbing records I don't have to do a check every time asking "Is this actually not a record, but in fact the RECORD COUNT line? You know, that thing I looked for and found already?"

**Edit (2):** Based on Martin Honnen's answer(s), my final XSLT:

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="2.0">
  <!-- I want to produce an XML document. -->
  <xsl:output method="xml" indent="yes" />

  <!-- Path to input text file. -->
  <xsl:param name="filePath" select="TestFile.txt" />

  <!-- Regex in replace() removes leading and trailing blank space. -->
  <xsl:variable name="text" select="replace(unparsed-text($filePath), '(^[\r\n]*\s*[\r\n]+)|([\r\n]+\s*[\r\n]*$)', '')" />

  <!-- Regex in tokenize() sets the delimiter to be any blank space between record lines. -->
  <!-- This effectively removes any blank lines. -->
  <xsl:variable name="lines" select="tokenize($text, '[\r\n]+\s*[\r\n]*')" />

  <!-- This finds the "RECORD COUNT = ?" line. -->
  <xsl:variable name="recordCountIndex"
    select="for $pos in 1 to count($lines) return $pos[matches($lines[$pos], 'RECORD COUNT = \d+')]" />

  <!-- Regex in replace() strips everything that's not a number, leaving only the numeric count. -->
  <!-- Example: "RECORD COUNT = 25" -> "25" -->
  <xsl:variable name="recordCount" select="replace($lines[$recordCountIndex], '[^0-9]', '')" />

  <xsl:template name="main">
    <root>
      <recordCount>
        <!-- The record count value being inserted. -->
        <xsl:value-of select="$recordCount" />
      </recordCount>
      <records>
        <!-- Iterate over the $lines minus the line containing the record count. -->
        <xsl:for-each select="remove($lines, $recordCountIndex)">
          <!-- Items in each record, split by blank space. -->
          <!-- Example: "a b c" -> "[a, b, c]" -->
          <xsl:variable name="record" select="tokenize(., ' ')[position()]" />
          <record>
            <aThing>
              <xsl:value-of select="$record[1]" />
            </aThing>
            <aDifferentThing>
              <xsl:value-of select="$record[2]" />
            </aDifferentThing>
            <someStuff>
              <xsl:value-of select="$record[3]" />
            </someStuff>
          </record>
        </xsl:for-each>
      </records>
    </root>
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:14:01.670

Well

```
<xsl:variable name="seq1" select="1, 2, 3, 4"/>
<xsl:variable name="seq2" select="remove($seq1, 2)"/> 
```

makes the value of the variable `seq2` a sequence of three number values 1, 3, 4.

[edit]

Here is an example based on your edited problem description:

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  exclude-result-prefixes="xs"
  version="2.0">

  <xsl:output method="text"/>

  <xsl:param name="filePath" select="'test2012052301.txt'"/>

  <xsl:variable name="lines" select="tokenize(unparsed-text($filePath), '\r?\n')" />

  <xsl:variable name="index" as="xs:integer"
    select="for $pos in 1 to count($lines) return $pos[matches($lines[$pos], 'RECORD COUNT = [0-9]+')]"/>

  <xsl:variable name="recordCount" as="xs:integer"
    select="xs:integer(replace($lines[$index], '[^0-9]', ''))"/>

  <xsl:template name="main">
    <xsl:value-of select="remove($lines, $index)" separator="&#10;"/>
    <xsl:text>count is: </xsl:text>
    <xsl:value-of select="$recordCount"/>
  </xsl:template>

</xsl:stylesheet> 
```

With the text file being for instance

```
foo
bar
RECORD COUNT = 3
baz 
```

the stylesheet outputs

```
foo
bar
baz
count is: 3 
```

[edit2] I think you can shorten the section

```
 <records>
    <!-- The $lines sequence trimmed down to only consist of valid records. -->
    <!-- (I have found no way around having this intermediate variable.) -->
    <xsl:variable name="records" select="remove($lines, $recordCountIndex)" />
    <xsl:for-each select="$records[position()]">
      <!-- Variable for iteration. Perhaps there's a more elegant way to do this. -->
      <xsl:variable name="i" select="position()" />
      <!-- Items in each record, split by blank space. -->
      <!-- Example: "a b c" -> "[a, b, c]" -->
      <xsl:variable name="recordItems" select="tokenize($records[$i], ' ')" />
      <record>
        <item1>
          <xsl:value-of select="$recordItems[1]" />
        </item1>
        <item2>
          <xsl:value-of select="$recordItems[2]" />
        </item2>
        <item3>
          <xsl:value-of select="$recordItems[3]" />
        </item3>
      </record>
    </xsl:for-each>
  </records> 
```

of your stylesheet to

```
 <records>
    <xsl:for-each select="remove($lines, $recordCountIndex)">
      <record>
        <xsl:for-each select="tokenize(., ' ')[position() lt 4]">
          <xsl:element name="item{position()}">
            <xsl:value-of select="."/>
          </xsl:element>
        </xsl:for-each>
      </record>
    </xsl:for-each>
  </records> 
```

Actually the predicate `position() lt 4` is only needed if a line can contain more than three tokens.

And as a note, I have now seen a construct like `for-each select="$records[position()]` two times in your post, that predicate with `[position()]` is complete useless, you can simply use `for-each select="$records"`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T16:13:05.857

It's hard to work out exactly where your confusion lies.

Firstly, removing an item from a sequence will never remove a node from a tree. (I've fought against the way the spec talks about sequences "containing nodes"; I think it's better to think of them as containing references to nodes. So you're removing a reference to a node, which doesn't affect the node itself in any way.)

Secondly, you seem to be thinking of variables as they are sometimes described in procedural languages, as named boxes containing values, which can contain different values at different times. Don't think of XSLT and XQuery variables that way: think of them as named values. "Over-writing" just isn't a meaningful operation.

Finally, use-cases. The most common way I use remove is to get the tail of a sequence: `remove($seq, 1)`. You can also write that as `subsequence($seq, 2)` or as `$seq[position() gt 1]`, but `remove()` is fewer keystrokes. To be honest, I'm having trouble thinking of a real life example where I have used `remove()` any other way, and I can't think of one.

Which leads me to an observation about your question. Asking "how to I use this feature" is a pretty strange sort of question. What we expect people to ask is "how do I solve this problem". Sometimes, when people ask how to use a feature, they are struggling to solve a particular problem, but they aren't telling us what the problem is. It would help if you told us: there's a good chance that `remove()` isn't part of the solution.

# c - 计算 C 数组（向量）中数字的出现次数

> ID：10721458
> 
> 赞同：0
> 
> 时间：2012-05-23T13:55:12.150
> 
> 标签：c, loops, for-loop, vector

我正在尝试用 C 中的向量（数组）实现以下问题的解决方案。我想输入一个数字和它发生的次数。

这是一个例子：

```
Imput n:  5

Imput num 1: 8
Imput num 2: 9
Imput num 3: 8
Imput num 4: 5
Imput num 5: 5 
```

该程序现在将显示：

```
Number 8: 2 occurences
Number 9: 1 occurences
Number 5: 2 occurences 
```

但我的节目：

```
Number 8: 2 occurences
Number 9: 1 occurences
Number 8: 2 occurences
Number 5: 2 occurences
Number 5: 2 occurences 
```

我能怎么做？？？泰

```
#include <stdio.h>
#include <stdlib.h>
#define SIZE 20

int main ()
{
    int vett1[SIZE], vett2[SIZE];
    int n, i, j;
    int flag;

    printf ("Imput n: ");
    scanf  ("%d", &n);

    for (i=0; i<n; i++)
    {
        printf ("Imput %d di %d: ", i+1, n);
        scanf  ("%d", &vett1[i]);
    }

    printf ("\n\nYour vector: : ");

    for (i=0; i<n; i++)
    {
        printf ("%d ", vett1[i]);
    }

    for (i=0; i<n; i++)
    {
        flag=0;

        for (j=0; j<n; j++)
        {
            if (vett1[j] == vett1[i])
            {
                flag++;
            }
        }

        vett2[i] = flag;
    }

    printf ("\n\n");

    for (i=0; i<n; i++)
    {
        printf ("Number %d: %d occurencese\n", vett1[i], vett2[i]);
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:26:50.653

您需要一种方法来跟踪 (1) 数字和 (2) 出现次数。像这样想：如果你是用手做的，用铅笔和纸，而不是用电脑，你会怎么做？

您可能需要一张纸，上面有一张小桌子，左栏中有数字，右栏中有出现次数。然后，您将检查数字（在您的情况下为 8、9、8、5、5），对于每个数字，您将检查它是否在您的表格中。如果它已经在表中，则将计数加一。如果它不在表中，则将其放在新行上，计数为 1。

现在您需要做的就是将该表实现为不是纸上的表，而是某种数据结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:22:34.400

您的最后一个代码写道：

```
for (i=0; i<n; i++)
{
    printf ("Number %d: %d occurencese\n", vett1[i], vett2[i]);
} 
```

您打印每个输入数字的 n 次以显示相应的出现，所以我认为您只需要更改打印输出功能就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:28:10.310

您只想查看每个数字一次。有几种方法可以实现这一点：

1.  每当您检查一个数字时，首先查看它是否是该数字在数组中的第一次出现。如果没有，请忽略它。非常低效，因为在查看第 n 个元素时，您需要返回并检查它之前的所有元素。

2.  与上述类似，但将首次出现验证与计数结合起来。您有两个嵌套循环，带有`i`和`j`。如果`j`循环看到`vett1[j] == vett1[i]`where `j<i`，这意味着这不是这个数字的第一次出现。忽略它。这与您当前的解决方案一样有效。

3.  排序 - 用于`qsort`对数组进行排序。然后只复习一次。现在每个数字的所有出现都一个接一个地出现，因此您只需遍历数组即可轻松计算它们。这是最有效的方法，但有点复杂。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-19T11:39:25.433

您的代码是正确的，您只需要修改上次打印的 for 循环，只需检查那里的条件，如果元素与以前的元素相似，则再次跳过打印。

```
for(i=0;i<n;i++)
{
    if(vett1[i+1] == vett1[i])
        continue;
    else
        printf("Number %d %d occurence",vett1[i],vett2[i]);
} 
```

# c++ - 尝试在 C++ 中使用很少的设计模式

> ID：10721459
> 
> 赞同：0
> 
> 时间：2012-05-23T13:55:26.820
> 
> 标签：c++, inheritance, pointers

我正在学习 C++。我非常了解 java 和 python，但我在我的 c++ 试验中使用了一点设计模式，我很生气。

这是我的文件，我认为它们是非常自动解释的，如果有任何问题，欢迎评论！

我有一个具有行为的类引擎..我想将行为划分为不同的特定行为..但是没有子类也很容易..

主.cpp：

```
#include "Engine.h"

int main() {
    Engine e;
    e.work();
    return 0;
}; 
```

引擎.h：

```
#ifndef ENGINE_H_
#define ENGINE_H_

#include <iostream>
#include "Behaviour.h"

class Engine {

public:

    Engine() {
        std::cout << "Engine constructor" << std::endl;
        this->b = new Behaviour(this);
    };
    virtual ~Engine(){};

    void work() {
        std::cout << "Engine work" << std::endl;
    };

    int getFoo() { return 42; };

private:
    Behaviour * b;
};

#endif /*  ENGINE_H_ */ 
```

行为.h：

```
#ifndef BEHAVIOUR_H_
#define BEHAVIOUR_H_

#include <iostream>
#include "Engine.h"

class Behaviour {

public:

    Behaviour(Engine* e) {
        std::cout << "behaviour constructor, kind of abstract class" << std::endl;
        this->e = e;
    };

    virtual ~Behaviour(){};

    void work() {
        std::cout << "Behaviour work" << this->e->getFoo() << std::endl;
    };

protected:
    Engine * e;

};

#endif /*  BEHAVIOUR_H_ */ 
```

我的编译器错误：

```
$ rm *.gch; c++ *
In file included from Behaviour.h:5:
Engine.h:26: error: ISO C++ forbids declaration of ‘Behaviour’ with no type
Engine.h:26: error: expected ‘;’ before ‘*’ token
Engine.h: In constructor ‘Engine::Engine()’:
Engine.h:14: error: ‘class Engine’ has no member named ‘b’
Engine.h:14: error: expected type-specifier before ‘Behaviour’
Engine.h:14: error: expected ‘;’ before ‘Behaviour’
In file included from Engine.h:5:
Behaviour.h:11: error: expected ‘)’ before ‘*’ token
Behaviour.h:23: error: ISO C++ forbids declaration of ‘Engine’ with no type
Behaviour.h:23: error: expected ‘;’ before ‘*’ token
Behaviour.h: In member function ‘void Behaviour::work()’:
Behaviour.h:19: error: ‘class Behaviour’ has no member named ‘e’
Engine.h: In constructor ‘Engine::Engine()’:
Engine.h:14: error: no matching function for call to ‘Behaviour::Behaviour(Engine* const)’
Behaviour.h:7: note: candidates are: Behaviour::Behaviour()
Behaviour.h:7: note:                 Behaviour::Behaviour(const Behaviour&) 
```

我想我需要一些前向声明，但我不确定，浏览教程并进行一些试验并不能解决我的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T13:57:05.483

用`Engine.h`前向声明替换包含：

```
#include "Behaviour.h" 
```

和

```
class Behaviour; 
```

`class Engine;`里面也一样`Behavior.h`。

因为你有一个循环依赖，你需要使用前向声明而不是包含。

**您还需要将实现分离到一个`cpp`文件中。**单独的前向声明不会让你打电话`this->b = new Behaviour(this);`。

另外，花一些时间重新考虑你的设计。这种依赖通常是一种代码味道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:19:57.460

您遇到循环依赖问题，通常，您必须在 CPP 文件中实现 Behaviour 的方法，但这可能不是最佳实践。我认为Engine在你的应用程序中是一个非常重要的抽象概念，你可以用一个纯虚类作为接口定义来描述它。

例如：

引擎.h

```
class IEngine {
public:
    void work() = 0;
};

IEngine* newEngine(); 
```

EngineImpl.h

```
class EngineImpl : public IEngine {
public:
    void work();
}; 
```

EngineImpl.cpp

```
void EngineImpl::work();
   // do some works
}

IEngine* newEngine() {
    return new EngineImpl();
} 
```

现在，您可以在代码中的任何位置通过 IEngine 使用您的引擎，只需包含 IEngine.h。你甚至可以通过定义实现一个引擎单例：

IEngine.h：

```
IEngine* sharedEngine(); 
```

EngineImpl.cpp

```
IEngine* sharedEngine() {
    static IEngine *engineInst = 0;
    if (!engineInst)
        engineInst = new EngineImpl();
    return engineInst; 
} 
```

# windows - 如何在仅消息窗口中获取 WM_TOUCH 消息

> ID：10721462
> 
> 赞同：1
> 
> 时间：2012-05-23T13:55:37.747
> 
> 标签：windows, winapi, input, touch

我刚刚开始一个项目，我想从触摸屏接收所有触摸事件以处理它们，无论是哪个活动窗口。我正在使用带有 C++ 的 Win32 API（我是 Win32 编程的新手）。我想使用一个仅消息窗口，但我没有成功获得 WM_TOUCH 消息（尽管我认为它是为触摸事件正确创建和注册的）。这是我初始化仅消息窗口的函数。

```
HWND InitMessageOnlyWindow(HINSTANCE hInstance, int nCmdShow) {
    LPWSTR szWindowClassName = TEXT("msgOnly");

    WNDCLASSEX windowClass;
    memset(&windowClass, 0, sizeof(windowClass));
    windowClass.cbSize = sizeof(windowClass);
    windowClass.lpfnWndProc    = WndProc;
    windowClass.lpszClassName  = szWindowClassName;
    if(RegisterClassEx(&windowClass)==0) {
    std::cerr << "RegisterClass" << std::endl;
    return 0;
    }

    HWND hWindow = CreateWindow(
    szWindowClassName,
    L"",
    0,
    0, 0, 0, 0,
    HWND_MESSAGE,
    0, 0, 0);
    if (!hWindow) {
    std::cerr << "CreateWindow" << std::endl;
    return 0;
    }

    if(RegisterTouchWindow(hWindow, 0)==0) {
    std::cerr << "RegisterTouchWindow" << std::endl;
    return 0;
    }

    return hWindow;
} 
```

我已经测试了以下内容：

*   要在仅消息窗口中获取 WM_INPUT 消息，它可以工作。
*   要在经典窗口中获取 WM_TOUCH 消息，它可以工作。

根据这篇[文章](https://stackoverflow.com/questions/3104509/getting-input-if-the-window-is-not-active-windows)，仅消息窗口需要处于活动状态。我试了一下，结果很奇怪，SetActiveWindow返回NULL（所以应该有问题）但是GetLastError不持有。这不会使我的程序正常工作。我还没有深入研究钩子的事情，我想知道为什么这首先不起作用。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-26T08:48:47.803

使用以下代码，您可以注册所有调用 wm_touch hook dll 的窗口。function.so 您可以捕获 Wm_TOUCH 消息。RegisterTouchWindow(((PCWPSTRUCT)lParam)->hwnd,0);

# objective-c - XCode - 在变量上设置调试器

> ID：10721464
> 
> 赞同：1
> 
> 时间：2012-05-23T13:55:45.660
> 
> 标签：objective-c, xcode, debugging

有没有办法在一个集合上设置调试器，这样如果变量产生错误（例如数组越界），就会给出发生这种情况的行号？

我正在寻找有关如何在 Xcode 3 中执行此操作的说明。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:17:00.077

您需要添加一个全局“On Throw”异常断点。如果您打开断点窗口，您应该可以添加一个，尽管我不记得 Xcode 3 中的确切步骤。

一旦你打开了这个，调试器就会在异常产生的地方停止。当通过`performSelector`调用传递异常并且堆栈跟踪丢失时，这通常会有所帮助。

# mysql - 自 Lion (OS X 10.7.4 ug) 以来，无法通过 localhost、CAN 通过 127.0.0.7 登录到 MSQL

> ID：10721466
> 
> 赞同：2
> 
> 时间：2012-05-23T13:55:52.687
> 
> 标签：mysql, phpmyadmin, osx-lion

我最近从 Snow Leopard 升级到 OS X 10.7.4。

从那时起，当将 MySQL 指定为 Wordpress 网站和 PHPMyAdmin 等的“主机”时，就无法通过“localhost”访问 MySQL。如果我使用 127.0.0.1，它可以正常工作。

一些注意事项/测试： - Apache 正在“http://localhost”（以及大量其他虚拟主机）上运行和访问 - 我确实知道 mysql root pass，并且可以使用“/usr/local/mysql/bin”登录/mysql -u 'root' -p" - 如果我 ping localhost，它会解析为 127.0.0.1。

我应该检查或报告什么以进一步解决此问题？是否有我需要将“localhost”添加到的 my.ini 或 my.cnf 文件？我试图找到/找到它们，但它们似乎不存在。

在此先感谢，本

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:03:38.313

登录 mysql 后，执行以下查询...

```
UPDATE mysql.user
SET Host = '%'
WHERE User = 'root'; 
```

有时，当我弄乱 MYSQL DB 表时，我需要这样做（如下），但这很可能与您的情况无关：

```
FLUSH PRIVILEGES; 
```

如果可以的话，重新启动 MySQL 服务器（服务）。然后尝试通过 127.0.0.1 或 localhost 访问 MySQL。***警告：上面的命令可能可以在开发机器上运行，但绝对不能在生产服务器上运行！***

# c# - 扩展的 InstanceContext Initialize 方法永远不会触发

> ID：10721469
> 
> 赞同：2
> 
> 时间：2012-05-23T13:55:55.890
> 
> 标签：c#, wcf, extension-methods

我接手了一个项目，该项目是根据[Dan Rigsby 的这篇文章中的建议构建的](http://www.danrigsby.com/blog/index.php/2008/05/24/extending-wcf-instancecontext-to-store-custom-state/)

但是由于某种原因，继承*IInstanceContextIntializer*的类中的**Initalize**方法永远不会像构造函数一样被触发。我需要 Initialize 触发，以便可以将扩展添加到 InstanceContext。

 *有人经历过这种情况并有可能的解决方案或建议吗？

非常感激

部分代码块：

```
[ServiceContract]
public interface IPSRestService
{
    [OperationContract]
    [WebInvoke(Method = "POST", UriTemplate = "blockActivityTrans", ResponseFormat = WebMessageFormat.Xml, RequestFormat = WebMessageFormat.Xml)]
    transAckResponseData PostBlockActivity(blockActivityData blockactivitydata);
    ...
} 
```

* * *

```
[ESBAPICreation]
    public class PSRestService : IPSRestService
    {
    ...
            public transAckResponseData PostBlockActivity(blockActivityData blockactivitydata)
        {
            OutgoingWebResponseContext outResponse = WebOperationContext.Current.OutgoingResponse;
            IncomingWebRequestContext inRequest = WebOperationContext.Current.IncomingRequest;
            bool isNew;
            transAckResponseData trans = PSDB.PutBlockActivity(blockactivitydata, out isNew);

            return trans;
        }
    ...} 
```

* * *

```
public class PSRestServiceFactory : ServiceHostFactoryBase
{
    public override ServiceHostBase CreateServiceHost(string service, Uri[] baseAddresses)
    {
    // The service parameter is ignored here because we know our service.
        PSRestServiceHost serviceHost = new PSRestServiceHost(typeof(PSRestService), baseAddresses);

        serviceHost.Opening += new EventHandler(serviceHost_Opening);
        serviceHost.Opened += new EventHandler(serviceHost_Opened);
        serviceHost.Closing += new EventHandler(serviceHost_Closing);
        serviceHost.Closed += new EventHandler(serviceHost_Closed);
        serviceHost.Faulted += new EventHandler(serviceHost_Faulted);
        serviceHost.UnknownMessageReceived += new EventHandler<UnknownMessageReceivedEventArgs>(serviceHost_UnknownMessageReceived);

        return serviceHost;
    }

    void serviceHost_UnknownMessageReceived(object sender, UnknownMessageReceivedEventArgs e)
    {
        Logger.Log("Unknown Message Received");
    }

    void serviceHost_Faulted(object sender, EventArgs e)
    {
        Logger.Log("service faulted");
    }

    void serviceHost_Closed(object sender, EventArgs e)
    {
        Logger.Log("service closed");
    }

    void serviceHost_Closing(object sender, EventArgs e)
    {
        Logger.Log("service closing by sender: {0}", sender.GetType().ToString());
    }

    void serviceHost_Opened(object sender, EventArgs e)
    {
        Logger.Log("service opened by sender: {0}", sender.GetType().ToString());
    }

    void serviceHost_Opening(object sender, EventArgs e)
    {
        Logger.Log("service opening by sender: {0}", sender.GetType().ToString());
    }
} 
```

* * *

```
public class PSRestServiceHost : ServiceHost
{
    public PSRestServiceHost(Type t, Uri[] addresses) : base(t, addresses)
    {
        Logger.Log("PSRestServiceHost constructor");
    }
} 
```

* * *

```
[DataContract]
public class PSESBAPIExtension : IExtension<InstanceContext>
{
    private ESBAPIManager _manager;

    [DataMember]
    public ESBAPIManager ESBAPIManager
    {
        get { return _manager; }
    }

    public PSESBAPIExtension(ESBAPIManager Manager)
    {
        Logger.Log("PSESBAPIExtension constructor called");
        _manager = Manager;
    }

    public void Attach(InstanceContext owner)
    {
    }

    public void Detach(InstanceContext owner)
    {
    }
} 
```

* * *

```
public class PSESBAPIInitializer : IInstanceContextInitializer
{
    private static ESBAPIManager _manager = null;

    public PSESBAPIInitializer()
    {
        if (_manager == null)
        {
            _manager = new ESBAPIManager();
            Logger.Log("New instance of API manager initialized");
        }
    }

    public void Initialize(InstanceContext instanceContext, Message message)
    {
        Logger.Log("Extension added to the instance context");

        instanceContext.Extensions.Add(new PSESBAPIExtension(_manager));
    }
} 
```

* * *

```
public class ESBAPICreationAttribute : Attribute, IContractBehavior
{
    public void AddBindingParameters(
        ContractDescription contractDescription,
        ServiceEndpoint endpoint,
        BindingParameterCollection bindingParameters)
    {
    }

    public void ApplyClientBehavior(
        ContractDescription contractDescription,
        ServiceEndpoint endpoint,
        ClientRuntime clientRuntime)
    {
    }

    public void ApplyDispatchBehavior(
        ContractDescription contractDescription,
        ServiceEndpoint endpoint,
        DispatchRuntime dispatchRuntime)
    {
        dispatchRuntime.InstanceContextInitializers.Add(new PSESBAPIInitializer());
        Logger.Log("Instance context initializer added");
    }

    public void Validate(
        ContractDescription contractDescription,
        ServiceEndpoint endpoint)
    {
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-15T13:57:39.287

我尝试了您的确切代码，添加了一些缺失的部分9，结果很好。主要区别在于我在工厂本身中定义了端点（我想象你在 web.config 上做了）。我尝试了自我和网络托管的情况，并且在所有情况下都添加了初始化程序。代码如下所示。与你所拥有的进行比较，差异应该告诉你哪里出了问题。

**自托管：**

```
public class StackOverflow_10721469
{
    public class ESBAPICreationAttribute : Attribute, IContractBehavior
    {
        public void AddBindingParameters(
            ContractDescription contractDescription,
            ServiceEndpoint endpoint,
            BindingParameterCollection bindingParameters)
        {
        }

        public void ApplyClientBehavior(
            ContractDescription contractDescription,
            ServiceEndpoint endpoint,
            ClientRuntime clientRuntime)
        {
        }

        public void ApplyDispatchBehavior(
            ContractDescription contractDescription,
            ServiceEndpoint endpoint,
            DispatchRuntime dispatchRuntime)
        {
            dispatchRuntime.InstanceContextInitializers.Add(new PSESBAPIInitializer());
            Logger.Log("Instance context initializer added");
        }

        public void Validate(
            ContractDescription contractDescription,
            ServiceEndpoint endpoint)
        {
        }
    }
    public class PSESBAPIInitializer : IInstanceContextInitializer
    {
        private static ESBAPIManager _manager = null;

        public PSESBAPIInitializer()
        {
            if (_manager == null)
            {
                _manager = new ESBAPIManager();
                Logger.Log("New instance of API manager initialized");
            }
        }

        public void Initialize(InstanceContext instanceContext, Message message)
        {
            Logger.Log("Extension added to the instance context");

            instanceContext.Extensions.Add(new PSESBAPIExtension(_manager));
        }
    }
    [DataContract]
    public class PSESBAPIExtension : IExtension<InstanceContext>
    {
        private ESBAPIManager _manager;

        [DataMember]
        public ESBAPIManager ESBAPIManager
        {
            get { return _manager; }
        }

        public PSESBAPIExtension(ESBAPIManager Manager)
        {
            Logger.Log("PSESBAPIExtension constructor called");
            _manager = Manager;
        }

        public void Attach(InstanceContext owner)
        {
        }

        public void Detach(InstanceContext owner)
        {
        }
    }
    public class ESBAPIManager { }
    public class PSRestServiceHost : ServiceHost
    {
        public PSRestServiceHost(Type t, Uri[] addresses)
            : base(t, addresses)
        {
            Logger.Log("PSRestServiceHost constructor");
        }
    }
    public class PSRestServiceFactory : ServiceHostFactoryBase
    {
        public override ServiceHostBase CreateServiceHost(string service, Uri[] baseAddresses)
        {
            // The service parameter is ignored here because we know our service. 
            PSRestServiceHost serviceHost = new PSRestServiceHost(typeof(PSRestService), baseAddresses);

            serviceHost.Opening += new EventHandler(serviceHost_Opening);
            serviceHost.Opened += new EventHandler(serviceHost_Opened);
            serviceHost.Closing += new EventHandler(serviceHost_Closing);
            serviceHost.Closed += new EventHandler(serviceHost_Closed);
            serviceHost.Faulted += new EventHandler(serviceHost_Faulted);
            serviceHost.UnknownMessageReceived += new EventHandler<UnknownMessageReceivedEventArgs>(serviceHost_UnknownMessageReceived);

            return serviceHost;
        }

        void serviceHost_UnknownMessageReceived(object sender, UnknownMessageReceivedEventArgs e)
        {
            Logger.Log("Unknown Message Received");
        }

        void serviceHost_Faulted(object sender, EventArgs e)
        {
            Logger.Log("service faulted");
        }

        void serviceHost_Closed(object sender, EventArgs e)
        {
            Logger.Log("service closed");
        }

        void serviceHost_Closing(object sender, EventArgs e)
        {
            Logger.Log("service closing by sender: {0}", sender.GetType().ToString());
        }

        void serviceHost_Opened(object sender, EventArgs e)
        {
            Logger.Log("service opened by sender: {0}", sender.GetType().ToString());
        }

        void serviceHost_Opening(object sender, EventArgs e)
        {
            Logger.Log("service opening by sender: {0}", sender.GetType().ToString());
        }
    }
    [ServiceContract]
    public interface IPSRestService
    {
        [OperationContract]
        [WebInvoke(Method = "POST", UriTemplate = "blockActivityTrans", ResponseFormat = WebMessageFormat.Xml, RequestFormat = WebMessageFormat.Xml)]
        transAckResponseData PostBlockActivity(blockActivityData blockactivitydata);
    }
    [ESBAPICreation]
    public class PSRestService : IPSRestService
    {
        public transAckResponseData PostBlockActivity(blockActivityData blockactivitydata)
        {
            return new transAckResponseData();
        }
    }
    public class blockActivityData { }
    public class transAckResponseData { }
    public class Logger
    {
        public static void Log(string text, params object[] args)
        {
            if (args != null && args.Length > 0) text = string.Format(text, args);
            Console.WriteLine(text);
        }
    }
    public static void Test()
    {
        string baseAddress = "http://" + Environment.MachineName + ":8000/Service";
        ServiceHostFactoryBase factory = new PSRestServiceFactory();
        ServiceHost host = (ServiceHost)factory.CreateServiceHost("unused", new Uri[] { new Uri(baseAddress) });
        host.Open();
        Console.WriteLine("Host opened");

        WebClient c = new WebClient();
        c.Headers[HttpRequestHeader.ContentType] = "application/json";
        Console.WriteLine(c.UploadString(baseAddress + "/blockActivityTrans", "null"));

        Console.Write("Press ENTER to close the host");
        Console.ReadLine();
        host.Close();
    }
} 
```

**网络主机**：

**文件：StackOverflow_10721469.svc**

```
<%@ ServiceHost Language="C#" Debug="true" Service="StackOverflow_10721469.PSRestService"
            CodeBehind="StackOverflow_10721469.svc.cs" 
            Factory="StackOverflow_10721469.PSRestServiceFactory" %> 
```

**文件：StackOverflow_10721469.svc.cs**

```
namespace StackOverflow_10721469
{
    public class ESBAPICreationAttribute : Attribute, IContractBehavior
    {
        public void AddBindingParameters(
            ContractDescription contractDescription,
            ServiceEndpoint endpoint,
            BindingParameterCollection bindingParameters)
        {
        }

        public void ApplyClientBehavior(
            ContractDescription contractDescription,
            ServiceEndpoint endpoint,
            ClientRuntime clientRuntime)
        {
        }

        public void ApplyDispatchBehavior(
            ContractDescription contractDescription,
            ServiceEndpoint endpoint,
            DispatchRuntime dispatchRuntime)
        {
            dispatchRuntime.InstanceContextInitializers.Add(new PSESBAPIInitializer());
            Logger.Log("Instance context initializer added");
        }

        public void Validate(
            ContractDescription contractDescription,
            ServiceEndpoint endpoint)
        {
        }
    }
    public class PSESBAPIInitializer : IInstanceContextInitializer
    {
        private static ESBAPIManager _manager = null;

        public PSESBAPIInitializer()
        {
            if (_manager == null)
            {
                _manager = new ESBAPIManager();
                Logger.Log("New instance of API manager initialized");
            }
        }

        public void Initialize(InstanceContext instanceContext, Message message)
        {
            Logger.Log("Extension added to the instance context");

            instanceContext.Extensions.Add(new PSESBAPIExtension(_manager));
        }
    }
    [DataContract]
    public class PSESBAPIExtension : IExtension<InstanceContext>
    {
        private ESBAPIManager _manager;

        [DataMember]
        public ESBAPIManager ESBAPIManager
        {
            get { return _manager; }
        }

        public PSESBAPIExtension(ESBAPIManager Manager)
        {
            Logger.Log("PSESBAPIExtension constructor called");
            _manager = Manager;
        }

        public void Attach(InstanceContext owner)
        {
        }

        public void Detach(InstanceContext owner)
        {
        }
    }
    public class ESBAPIManager { }
    public class PSRestServiceHost : ServiceHost
    {
        public PSRestServiceHost(Type t, Uri[] addresses)
            : base(t, addresses)
        {
            Logger.Log("PSRestServiceHost constructor");
        }
    }
    public class PSRestServiceFactory : ServiceHostFactoryBase
    {
        public override ServiceHostBase CreateServiceHost(string service, Uri[] baseAddresses)
        {
            // The service parameter is ignored here because we know our service. 
            PSRestServiceHost serviceHost = new PSRestServiceHost(typeof(PSRestService), baseAddresses);

            var endpoint = serviceHost.AddServiceEndpoint(typeof(IPSRestService), new WebHttpBinding(), "");
            endpoint.Behaviors.Add(new WebHttpBehavior());

            serviceHost.Opening += new EventHandler(serviceHost_Opening);
            serviceHost.Opened += new EventHandler(serviceHost_Opened);
            serviceHost.Closing += new EventHandler(serviceHost_Closing);
            serviceHost.Closed += new EventHandler(serviceHost_Closed);
            serviceHost.Faulted += new EventHandler(serviceHost_Faulted);
            serviceHost.UnknownMessageReceived += new EventHandler<UnknownMessageReceivedEventArgs>(serviceHost_UnknownMessageReceived);

            return serviceHost;
        }

        void serviceHost_UnknownMessageReceived(object sender, UnknownMessageReceivedEventArgs e)
        {
            Logger.Log("Unknown Message Received");
        }

        void serviceHost_Faulted(object sender, EventArgs e)
        {
            Logger.Log("service faulted");
        }

        void serviceHost_Closed(object sender, EventArgs e)
        {
            Logger.Log("service closed");
        }

        void serviceHost_Closing(object sender, EventArgs e)
        {
            Logger.Log("service closing by sender: {0}", sender.GetType().ToString());
        }

        void serviceHost_Opened(object sender, EventArgs e)
        {
            Logger.Log("service opened by sender: {0}", sender.GetType().ToString());
        }

        void serviceHost_Opening(object sender, EventArgs e)
        {
            Logger.Log("service opening by sender: {0}", sender.GetType().ToString());
        }
    }
    [ServiceContract]
    public interface IPSRestService
    {
        [OperationContract]
        [WebInvoke(Method = "POST", UriTemplate = "blockActivityTrans", ResponseFormat = WebMessageFormat.Json, RequestFormat = WebMessageFormat.Json)]
        transAckResponseData PostBlockActivity(blockActivityData blockactivitydata);
    }
    [ESBAPICreation]
    public class PSRestService : IPSRestService
    {
        public transAckResponseData PostBlockActivity(blockActivityData blockactivitydata)
        {
            return new transAckResponseData { Logs = Logger.GetCurrentLog() };
        }
    }
    public class blockActivityData { }
    public class transAckResponseData
    {
        public string Logs { get; set; }
    }
    public static class Logger
    {
        static StringBuilder sb = new StringBuilder();
        public static void Log(string text, params object[] args)
        {
            if (args != null && args.Length > 0) text = string.Format(text, args);
            Console.WriteLine(text);
            sb.AppendLine(text);
        }
        public static string GetCurrentLog()
        {
            string result = sb.ToString();
            sb.Clear();
            return result;
        }
    }
} 
```

**文件：TestPage.html**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Quick template</title>
    <script type="text/javascript" src="scripts/jquery-1.7.2.js"></script>
</head>
<body>
    <script type="text/javascript">
        function StackOverflow_10721469_Test() {
            var url = "/StackOverflow_10721469.svc/blockActivityTrans";
            $.ajax({
                type: 'POST',
                url: url,
                contentType: "application/json",
                data: "{}",
                success: function (data, textStatus, jqXHR) {
                    $("#result").text(data.Logs);
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    $("#result").text("error");
                }
            });
        }
    </script>
    <input type="button" value="StackOverflow 10721469" onclick="StackOverflow_10721469_Test();" /> <br />
    <div id='result'></div>
</body>
</html> 
```*

# tomcat - Liferay - 此站点处于非活动状态。请联系管理员

> ID：10721472
> 
> 赞同：2
> 
> 时间：2012-05-23T13:56:08.170
> 
> 标签：tomcat, liferay, portal, liferay-6

嗨，我正在测试 Liferay 门户，但是我无法再访问该门户 - 当我现在访问该门户时，我收到以下消息

```
This site is inactive. Please contact the administrator. 
```

我相信发生的事情是我在控制面板中使该站点处于非活动状态，但是我无法再访问控制面板。

如果有任何建议我可以解决这个问题以重新激活该网站，我们将不胜感激。

非常感谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-23T14:08:54.003

登录 Liferay 数据库并执行此查询。

```
UPDATE group_ SET active = 1 WHERE name = '<name of your site>' 
```

然后，重新启动 Liferay。

# javascript - 如何使用 Backbone.Marionette 构建用于将项目创建到列表中的应用程序？

> ID：10721473
> 
> 赞同：0
> 
> 时间：2012-05-23T13:56:10.543
> 
> 标签：javascript, backbone.js, coffeescript, backbone-views, marionette

这是使用 Marionette 时仍然让我感到困惑的一件事。

想象一个用于查看评论列表和发表新评论的简单界面。我目前构建它的方式与`CommentApp`我在下面包含的类似。

我想我的问题有两个部分：

这是我应该如何构建这种类型的应用程序吗？我尝试尽可能遵循[BBCloneMail 示例应用程序](http://bit.ly/JCFryc)，但这似乎没有提供将新项目创建到集合中的示例。

为什么`layout.listRegion`下面会返回`undefined`我尝试调用`.show()`它的地方？更一般地说，是否有一种确定的方法来处理触发和绑定到`'layout:rendered'`具有嵌套布局的事件。它似乎变得相当混乱。

```
App.module "CommentApp", (CommentApp, App, B, M, $, _) ->
  class Layout extends M.Layout
    template: 'comment_layout'

    regions:
      listRegion: '#comment_list_region'
      newRegion: '#new_comment_region'

  class CommentView extends M.ItemView
    # this is as you would expect

  class NewCommentView extends M.ItemView
    # this is as you would expect
    # This view triggers a 'new:comment' on the CommentApp.vent
    # event aggregator when the user submits a new comment.

  class CommentsListView extends M.CollectionView
    # this is as you would expect
    # This view listens to the 'new:comment' event on the
    # CommentApp.vent event aggregator.

  # Public API
  # ----------

  CommentApp.showComments = (comments) ->
    # In here I need to render a layout
    layout = new Layout()

    # I also need to render a comments list an the
    # view for writing a new comment.
    commentsListView = new CommentsList(collection: comments)
    newCommentView = new NewCommentView()

    # THen I need to place these views into the layout when ready.
    layout.on "show", ->
      # This part fails because it seems that the layout.listRegion
      # is not yet defined for some reason. Don't understand why?
      layout.listRegion.show(commentsListView)
      layout.newRegion.show(newCommentView)

    # Now I need to stick the commenting layout into it's
    # place in the main app layout.
    App.layout.mainRegion.show(layout)

  App.addInitializer (options) ->
    @vent.bind "layout:rendered", -> CommentApp.showComments(comments) 
```

该`'comment_layout'`模板只是一个基本的容器模板：

```
<h2>Comments</h2>
<section id="comment_list_region"></section>
<section id="new_comment_region"></section> 
```

我正在使用`JST`它来渲染它。我已经用这段代码覆盖了渲染函数：

```
# Override the marionette renderer to make it use JST.
Backbone.Marionette.Renderer.render = (template, data) ->
  # Check if a template is specified first.
  if template
    throw "Template '" + template + "' not found!" unless JST[template]
    JST[template](data) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T04:27:40.530

## 结构

您的应用程序通常按照我的方式构建。不过，有几点我会改变。

例如，您不需要使用初始化程序来为“layout:rendered”设置事件绑定。你可以这样做：

`App.vent.bind "layout:rendered", -> CommentApp.showComments(comments)`

在这种情况下，在初始化程序内部设置事件绑定没有任何实际价值。

## 布局

> 为什么下面的 layout.listRegion 在我尝试调用 .show() 的地方返回未定义？

......我不确定......虽然这段代码看起来有点奇怪：`App.layout.mainRegion.show(layout)`

这是故意的`App.mainRegion.show(layout)`吗？

当布局的`render`方法被调用时，布局的区域将被实例化。在区域中显示布局将调用布局的`render`方法，并监听`show`布局事件以在布局区域中显示内容应该可以正常工作。事实上，我经常这样做。

不过，我最近看到了一些类似问题的报告，我认为这里有一个我无法隔离的错误。

模板`comment_template`指的是什么？这是某个地方的预编译模板吗？您是否覆盖了模板的呈现？如果是这样，您可以发布处理此问题的代码吗？

如果您`console.dir(layout)`在布局的“显示”事件处理程序内部进行操作，它会返回什么？你看到区域对象了吗？你在那个物体上还能看到什么？

# php - 如何将分隔字符串拆分为 XML 节点树

> ID：10721477
> 
> 赞同：1
> 
> 时间：2012-05-23T13:56:19.313
> 
> 标签：php, mysql, xml, xslt, xslt-2.0

好的，我是 PHP 和 Java 的新手，但是在过去十年进入管理领域后试图更新我的编码。

我有一张表格：

```
heading1_sub1_element1 = data1
heading1_sub1_element2 = data2
heading1_sub1_element3 = data3
heading1_sub2_element1 = data4
heading1_sub2_element2 = data5
heading1_sub2_element3 = data6 
```

使用[Tony Marsden 网站上](http://www.tonymarston.net/php-mysql/domxml.html)的精彩示例，我已经能够获取表格以将数据提取到表单中：

```
<table>
    <heading1_sub1_element1>data1</heading1_sub1_element1>
    <heading1_sub1_element2>data2</heading1_sub1_element2>
    <heading1_sub1_element3>data3</heading1_sub1_element3>
    <heading1_sub2_element1>data4</heading1_sub2_element1>
    <heading1_sub2_element2>data5</heading1_sub2_element2>
    <heading1_sub2_element3>data6</heading1_sub2_element3>
</table> 
```

但是我想得到的是：

```
<heading1>
    <sub1>
        <element1>Data1</element1>
        <element2>Data2</element2>
        <element3>Data3</element3>
    </sub1>
    <sub2>
        <element1>Data4</element1>
        <element2>Data5</element2>
        <element3>Data6</element3>
    </sub2>
</heading1> 
```

有谁知道如何将数据转换为该格式？我需要使用 XSLT，还是 PHP 可以直接这样做？

我这样做的唯一原因是 XML 看起来更好。

在此先感谢您，我们将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T04:21:52.497

**这是一个通用解决方案，可以正确处理*任何*具有指定格式的行集**——即使每行有不同数量的下划线，并且第一个“名称”在所有行上都不相同：

```
<xsl:stylesheet version="2.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema"
 xmlns:my="my:my" exclude-result-prefixes="my xs">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:variable name="vLines" select="tokenize(/*, '\r?\n')[.]"/>

 <xsl:variable name="vPass1">
  <t>
   <xsl:apply-templates mode="pass1"/>
  </t>   
 </xsl:variable>

 <xsl:template match="/*" mode="pass1">
  <xsl:for-each select="$vLines">
   <xsl:sequence select="my:makeTree(normalize-space(.))"/>
  </xsl:for-each>
 </xsl:template>

 <xsl:template match="/">
  <xsl:apply-templates select="$vPass1" mode="pass2"/>
 </xsl:template>

 <xsl:function name="my:makeTree">
  <xsl:param name="pLine"/>

  <xsl:variable name="vName" select="substring-before($pLine, '_')"/>

  <xsl:choose>
    <xsl:when test="$vName">
      <xsl:element name="{$vName}">
        <xsl:sequence select="my:makeTree(substring-after($pLine, '_'))"/>
      </xsl:element>
    </xsl:when>
    <xsl:otherwise>
     <xsl:element name=
       "{normalize-space(substring-before($pLine, '='))}">
       <xsl:sequence select="substring-after($pLine, '=')"/>
     </xsl:element>
    </xsl:otherwise>
  </xsl:choose>
 </xsl:function>

 <xsl:function name="my:group">
  <xsl:param name="pNodes" as="node()*"/>

  <xsl:for-each-group select="$pNodes[self::*]" group-by="name()">
    <xsl:element name="{name()}">
      <xsl:for-each select="current-group()">
         <xsl:sequence select="my:group(node())"/>
      </xsl:for-each>
    </xsl:element>
  </xsl:for-each-group>
  <xsl:copy-of select="$pNodes[not(self::*)]"/>
 </xsl:function>

  <xsl:template match="*[not(my:path(.) = preceding::*/my:path(.))]" mode="pass2">
  <xsl:copy>
   <xsl:apply-templates select="//*[my:path(.) = my:path((current()))]/node()"
        mode="pass2"/>
  </xsl:copy>
 </xsl:template>

 <xsl:template match="*" mode="pass2"/>

 <xsl:template match="/*" mode="pass2" priority="3">
   <xsl:apply-templates mode="pass2"/>
 </xsl:template>

 <xsl:function name="my:path" as="xs:string">
  <xsl:param name="pElement" as="element()"/>

  <xsl:sequence select=
   "string-join($pElement/ancestor-or-self::*/name(.), '/')"/>
 </xsl:function>

</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时**（给定的行，包装到顶部元素中以使其成为格式良好的 XML 文档）：

```
<t>
    heading1_sub1_element1 = data1
    heading1_sub1_element2 = data2
    heading1_sub1_element3 = data3
    heading1_sub2_element1 = data4
    heading1_sub2_element2 = data5
    heading1_sub2_element3 = data6
</t> 
```

**产生了想要的正确结果：**

```
<heading1>
   <sub1>
      <element1> data1</element1>
      <element2> data2</element2>
      <element3> data3</element3>
   </sub1>
   <sub2>
      <element1> data4</element1>
      <element2> data5</element2>
      <element3> data6</element3>
   </sub2>
</heading1> 
```

**当对这个更复杂的 XML 文档应用相同的转换时**：

```
<t>
    heading1_sub1_element1 = data1
    heading1_sub1_element2 = data2
    heading1_sub1_element3 = data3
    heading1_sub2_element1 = data4
    heading1_sub2_element2 = data5
    heading1_sub2_element3 = data6
    heading2_sub1_sub2_sub3 = data7
    heading2_sub1_sub2_sub3_sub4 = data8
    heading2_sub1_sub2 = data9
    heading2_sub1 = data10
    heading2_sub1_sub2_sub3 = data11
</t> 
```

**我们再次得到正确的、想要的结果**：

```
<heading1>
   <sub1>
      <element1> data1</element1>
      <element2> data2</element2>
      <element3> data3</element3>
   </sub1>
   <sub2>
      <element1> data4</element1>
      <element2> data5</element2>
      <element3> data6</element3>
   </sub2>
</heading1>
<heading2>
   <sub1>
      <sub2>
         <sub3>
            data7
            <sub4> data8</sub4>
            data11
         </sub3>
         data9
      </sub2>
      data10
  </sub1>
</heading2> 
```

**说明**：

这是一个两遍处理：

1.  在 pass1 中，我们将输入转换为一个临时树（在上面的第一个 XML 文档的情况下），如下所示：

......

```
<t>
   <heading1>
      <sub1>
         <element1> data1</element1>
      </sub1>
   </heading1>
   <heading1>
      <sub1>
         <element2> data2</element2>
      </sub1>
   </heading1>
   <heading1>
      <sub1>
         <element3> data3</element3>
      </sub1>
   </heading1>
   <heading1>
      <sub2>
         <element1> data4</element1>
      </sub2>
   </heading1>
   <heading1>
      <sub2>
         <element2> data5</element2>
      </sub2>
   </heading1>
   <heading1>
      <sub2>
         <element3> data6</element3>
      </sub2>
   </heading1>
</t> 
```

.2\. 在第二遍中，我们执行特定类型的分组，以便产生想要的结果。

**注意**：在这个解决方案中，我们将输入字符串作为 XML 文档中唯一元素的唯一文本节点子节点来访问。这实际上是不必要的，我这样做只是为了方便。我们可以使用标准 XSLT 2.0 函数从外部文本文件中读取字符串**[`unparsed-text()`](http://www.w3.org/TR/2007/REC-xslt20-20070123/#function-unparsed-text)**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:57:07.410

就个人而言，除非您真的与您制作的 XML 的第一个版本相关联，否则我只会从原始文本文件格式开始，并将整个内容转换为 php 以创建您想要的 XML。是的，您可以使用 XSL 从第一个转换为第二个，但实际上，将这些原始字符串拆分为键值对，然后作为常规表达式或字符串拆分，拆分字符串在'_' 字符并将其用作 XML 结构。如果你使用

```
$vals = explode("_", $string_input); 
```

仅在关键上，这将为您提供第一个：

```
$vals[0] = "heading1";
$vals[1] = "sub1";
$vals[2] = "element1"; 
```

你可以用它来制作你想要的结构

我通常不会建议某人使用字符串制作 XML 结构（当您遇到编码问题时），但如果您确定不会，只需将其作为字符串输出（或者如其他答案所说，simpleXML）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T15:10:17.117

我很确定您必须执行一些字符串操作来解析出您想要的节点名称，但之后查看 PHP 的 simpleXML。这是一个[很好的答案](https://stackoverflow.com/questions/3361036/php-simplexml-insert-node-at-certain-position)，展示了如何使用它。

# c# - 在访问依赖属性设置器之前调用用户控件上的 TextChanged 事件

> ID：10721479
> 
> 赞同：1
> 
> 时间：2012-05-23T13:56:23.867
> 
> 标签：c#, .net, wpf, user-controls, dependency-properties

在使用自定义用户控件之前，我使用的是标准文本框，文本属性绑定到列表框中所选项目的属性。该绑定还使用了验证规则。设置此属性后，在 xaml 中触发了文本更改事件，一切正常。

现在我已将其更改为使用包含文本框的用户控件。我向绑定到文本框的文本属性的用户控件添加了一个依赖属性。现在，在验证发生之前更改文本时会触发该事件。在我的对话框中绑定到同一项目的另一个属性的复选框被选中之前，验证不会发生。除了在列表框中的初始选择之外，我的模型视图中的 set 方法上的断点不再被破坏，但是当我单击文本框后看到效果时，值正在更新。在单击复选框之前，验证显示的我的错误消息不会出现。

我的窗口中用户控件的 XAML：

```
<my:BoundTextBox x:Name="spacingValueBox" TextBoxBase.TextChanged="spacingValueBox_TextChanged">
    <my:BoundTextBox.Text>
       <Binding Path="SelectedItem.Property" UpdateSourceTrigger="PropertyChanged" Mode="TwoWay">                                       
           <Binding.ValidationRules>
              <validators:ValidationRule ErrorMessage="Invalid"/>
           </Binding.ValidationRules>
      </Binding>
   </my:BoundTextBox.Text> 
```

在 XAML 中绑定到我的用户控件的 Text 属性：

```
<UserControl x:Class="ButtonTextBox" ...
         ... Name="control">
<TextBox Text="{Binding Text, ElementName=control}"/> 
```

依赖属性：

```
public static readonly DependencyProperty TextProperty =
TextBox.TextProperty.AddOwner(typeof(BoundTextBox));

public string Text
{
  get { return (string)GetValue(TextProperty); }
  set { SetValue(TextProperty, value); }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T14:30:44.917

解决方案实际上非常简单，我只需将`UpdateSourceTrigger`值设置为`PropertyChanged`.

```
<TextBox Text="{Binding Text, ElementName=control, UpdateSourceTrigger=PropertyChanged}"/> 
```

# android - 关于从 android eclipse 使用 web 服务的编辑文本和按钮

> ID：10721480
> 
> 赞同：0
> 
> 时间：2012-05-23T13:56:28.510
> 
> 标签：android, eclipse, web-services

我正在使用 SOAP 方法使用 Web 服务。我必须在 android eclipse 上创建一个编辑文本框和一个按钮，这应该类似于这个[web](http://www.webservicex.net/BibleWebservice.asmx?op=GetBibleWordsbyKeyWord)
服务这里我想通过使用 web 服务在 android eclipse 中显示一些文本，即 edittextbox应该从用户那里获取输入并准确打印上述 web 服务将显示的内容。
我已经尝试过，但它不起作用。任何人都可以让我知道想法或一些示例代码，如果你有的话。

感谢您的宝贵时间！..

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-23T14:33:46.267

Manick，指定你的问题你想做什么？你有一个edittext和一个按钮和网络服务数据。当您输入 edittext 并单击按钮时，应根据用户输入列出网络服务数据。或其他任何东西。试试[这个](http://wiki.javaforum.hu/display/ANDROIDSOAP/Step+by+step+tutorial)

好吧，让我们来看看！

首先，您必须从[这里](http://code.google.com/p/ksoap2-android/)为您的项目下载 KSOAP 库，这是一个适用于 Android 平台的轻量级且高效的 SOAP 客户端库。将此库添加到您的项目中。以下代码将帮助您 -

```
private Button button1;
private EditText editText1;

public void onClick(Bundle b){
    ........//type your other code here

    editText1 = (EditText) findViewById(R.id.editText1);        
    button1 = (EditText) findViewById(R.id.button1);
    button.setOnClickListener(this);

    ........//type your other code here
}

@Override
public void onClick(){
    SoapObject soapResponseObject = getSOAPResponse(editText1.getText());
    String result= soapResponseObject.getProperty(0).toString();
    //use result to into your code to your own way
    Toast.makeText(getApplicationContext(), result, Toast.LENGTH_SHORT).show();
}

//getSOAPResponse() method returns SOAP Response 
public SoapObject getSOAPResponse(String search){
    SoapObject soapObject = new SoapObject("http://www.webservicex.net", "GetBibleWordsbyKeyWord");
    soapObject.addProperty("BibleWords", search);
    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER12);
    envelope.dotNet = true;
    envelope.setOutputSoapObject(soapObject);
    HttpTransportSE androidHttpTransport = new HttpTransportSE("http://www.webservicex.net/BibleWebservice.asmx?");
    try {
    androidHttpTransport.call("http://www.webserviceX.NET/GetBibleWordsbyKeyWord", envelope);//call the eb service Method
    } catch (Exception e) {
        e.printStackTrace();
    }
    return (SoapObject) envelope.response();
} 
```

希望这会帮助你。乐趣！

# vbscript - HTA如何将窗口定位到角落？

> ID：10721482
> 
> 赞同：2
> 
> 时间：2012-05-23T13:56:45.113
> 
> 标签：vbscript, hta

我需要将 Window 定位到 0,0

如何使用 VBScript 和 HTA 做到这一点

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T15:09:04.847

只是为了避免脚本专家的混乱（头部和身体之间的脚本）并在 .HTA 中显示顶级（功能外）代码：

```
<html>
 <!-- stolen & sanitized from:
      !! http://blogs.technet.com/b/heyscriptingguy/archive/2005/10/10/how-can-i-center-an-hta-on-the-screen.aspx
 -->
 <head>
  <title>TopLeft HTA</title>
  <HTA:APPLICATION
    APPLICATIONNAME="TopLeft HTA"
  >
  <SCRIPT Language="VBScript">
    window.moveTo 0, 0
  </SCRIPT>
 </head>
 <body></body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T14:43:56.760

[从The Scripting Guy](http://blogs.technet.com/b/heyscriptingguy/archive/2005/10/10/how-can-i-center-an-hta-on-the-screen.aspx)中提取答案是：

```
<html>
<head>

<title>My Awesome HTA</title>

<HTA:APPLICATION 
     ID="objHTA"
     APPLICATIONNAME="Awesome HTA"
     SCROLL="yes"
     SINGLEINSTANCE="yes"
>
</head>

<SCRIPT Language="VBScript">
    Sub Window_Onload
        window.moveTo 0, 0
    End Sub
</SCRIPT>

<!--/*    the rest of you HTA goes here...   */--> 
```

# powershell - IIS7.5 PowerShell preloadEnabled

> ID：10721484
> 
> 赞同：19
> 
> 时间：2012-05-23T13:56:56.737
> 
> 标签：powershell, iis-7.5

我是否可以使用 PowerShell 命令（例如 New-WebSite）来创建网站并设置网站的 preloadEnabled="true"？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-08-29T20:01:18.300

这应该可以解决问题。您可以使用`get-itemproperty`来验证它是否有效。我花了一段时间才弄清楚`preloadEnabled`在 powershell 中的位置，但是如果您将站点路径通过管道传输到`get-member`，那么您可以从那里开始工作。

```
import-module webadministration
set-itemproperty IIS:\Sites\SiteName -name applicationDefaults.preloadEnabled -value True 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-07-07T19:05:28.700

这有点晚了，但这会帮助其他人......这对我有用，而且不那么冗长。主要区别在于我删除了 ApplicationDefaults 因为我正在设置应用程序，而不是此处的默认值：

```
Set-ItemProperty IIS:\Sites\<siteName>\<applicationName> -name preloadEnabled -value True 
```

WHERE: 'SiteName' 可能等于 Default Web Site 'ApplicationName' 可能等于 MyApplication

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-08-29T07:13:17.207

实际上有一种方法可以做到这一点（假设您在 / 有一个要为其设置的应用程序并且您知道您的站点名称）：

```
[System.Reflection.Assembly]::LoadFrom("C:\windows\system32\inetsrv\Microsoft.Web.Administration.dll")
$serverManager = (New-Object Microsoft.Web.Administration.ServerManager)
$serverManager.Sites["YOUR_SITE_NAME"].Applications["/"].SetAttributeValue("preloadEnabled", $true)
$serverManager.CommitChanges() 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-01-08T19:16:57.457

您可以为网站的根应用程序启用预加载，如下所示：

```
$w = New-Item "IIS:\Sites\AAA" -type site –physicalPath "C:\W" -bindings $binding
$w.Collection[0].preloadEnabled = $true
$w | Set-Item 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-03-09T20:32:34.240

我可以提供更细粒度和确定性的方法：

```
# Creating the website:
$website = New-WebSite -Name $WebSiteName -PhysicalPath $WebSiteFolder -ApplicationPool $PoolName

# Setting preload enabled:
Set-WebConfigurationProperty `
    -PSPath "IIS:\" `
    -Filter "/system.applicationHost/sites/site[@name='$WebSiteName']/application[@path='/']" `
    -Name "preloadEnabled" `
    -Value $True  # or $False to turn that off 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-10-23T18:20:23.587

我也一直在寻找这个，但在 WebAdministration 中找不到任何东西来设置这个选项。据推测，该方法是在正确的 WebApplication 上调用 New-ItemProperty。不幸的是，我无法获得给定网站的“默认”应用程序，或在其上设置此属性。看起来 WebAdministration 模块（它启用像 New-WebSite 这样的 cmdlet）是在考虑早期版本的 IIS 的情况下编写的，而且肯定是在应用程序初始化模块之前编写的。

这是一种解决方法，它通过编辑底层 applicationHost.config 文件来强制设置这些属性。这是我们现在使用的脚本的一个稍微简化的版本。您需要以管理员身份运行此脚本。

```
# Copy applicationHost.config to the temp directory,
# Edit the file using xml parsing,
# copy the file back, updating the original

$file = "applicationhost.config"
$source = Join-Path "$env:windir" "\system32\inetsrv\config\$file"
$temp = Join-Path "$env:temp" "$([Guid]::NewGuid().ToString())"
$tempFile = Join-Path "$temp" "$file"

#update all applications in websites whose name matches this search term
$search = "website name to search for"

#copy applicationHost.config to  temp directory for edits
#assignments to $null simply silence output
$null = New-Item -itemType Directory -path $temp
$null = Copy-Item "$source" "$temp"

# Load the config file for edits
[Xml]$xml = Get-Content $tempFile

# find sites matching the $search string, enable preload on all applications therein
$applications = $xml.SelectNodes("//sites/site[contains(@name, `"$search`")]/application") 
$applications | % { 
    $_.SetAttribute("preloadEnabled", "true") 
}

#save the updated xml
$xml.Save("$tempFile.warmed")

#overwrite the source with updated xml
Copy-Item "$tempfile.warmed" "$source"

#cleanup temp directory
Remove-Item -recurse $temp 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2019-06-07T08:49:35.283

老问题，但我想分享我的见解。

我需要从 Octopus 部署后脚本执行此操作，其中我的应用程序位于站点根目录中。我在这里尝试了所有建议的解决方案，而 Robert Moore 的解决方案是唯一适合我的解决方案。

但是，我最终使用了它，它也完成了这项工作：

```
$Site = Get-Item IIS:\Sites\<site name>
$Site.applicationDefaults.preloadEnabled = $true
$Site | Set-Item -Verbose 
```

**警告**：如果您的站点中有任何应用程序，请不要这样做（请参阅@Sergey Nudnov 的评论

# c# - 如何通过winforms c# app控制第三方应用？

> ID：10721487
> 
> 赞同：1
> 
> 时间：2012-05-23T13:57:02.727
> 
> 标签：c#, winforms

我有一个适用于/适用于第三方 exe 的 winform 应用程序。这些第三方应用程序没有任何 api 或命令行参数。是否可以使用 c# 从 winform 应用程序控制第三方应用程序。

我需要的是：-

*   在 winform 应用程序中打开第三方 exe。Winform 将作为容器工作。
*   让用户使用第三方应用
*   然后通过 winform 应用程序退出/结束/关闭第三方 exe。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:01:26.783

我认为你可以使用 `Process.Start`

但是该应用程序不能作为容器工作。

[http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx)

Process.Start 返回`system.diagnostics.process`可用于停止它的对象

[http://msdn.microsoft.com/en-us/library/system.diagnostics.process](http://msdn.microsoft.com/en-us/library/system.diagnostics.process)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:04:16.403

是的，您可以通过重新设置为许多应用程序执行此操作。[初学者](https://stackoverflow.com/questions/333171)请看这里。

我提到了许多暗示“不是全部”的应用程序。例如，如果您尝试切换模式（标准、科学等），Windows 计算器会让您头疼，因为每次模式更改都会创建一个新窗口。MS Word 也有一个复杂的窗口方案。但是像记事本和其他简单的应用程序这样的东西会起作用。

因此，您需要获取/启动进程，获取进程的窗口句柄并将父级设置为应用程序的窗口。

[这是获取进程的窗口句柄](https://stackoverflow.com/questions/2832236)的另一个有用链接。

# winapi - C++/C#/Win32_API - 删除磁盘卷/分区 - 调试？

> ID：10721489
> 
> 赞同：0
> 
> 时间：2012-05-23T13:57:09.093
> 
> 标签：winapi, volume, disk

我正在尝试使用[DeleteFileW](http://msdn.microsoft.com/en-us/library/aa363915%28v=vs.85%29)删除磁盘卷，[根据文档](http://msdn.microsoft.com/en-us/library/aa363983%28v=vs.85%29)，这是我应该使用的功能。

我使用 WMI 调用 Win32_Volume 来获取设备 ID，如果我添加一个文件，它可以正常工作。

但是，如果我只提供卷 ID，则会收到错误 5，拒绝访问。我认为在删除它之前需要完成一些准备工作，但我不知道是什么。我正在考虑将调试器附加到 DiskPart 但由于 DeleteFile 函数将是最后一次调用，因此我真的不知道如何设置断点以在此之前捕获所有内容。另外，我对调试器并不出色。

所以，问题是我如何删除一个卷，或者我如何设置调试器来捕获删除，以便我可以读取以前的函数调用？

# ios - 帧缓冲区的 OpenGLES 问题

> ID：10721496
> 
> 赞同：0
> 
> 时间：2012-05-23T13:57:24.380
> 
> 标签：ios, opengl-es, framebuffer

一直涉足 OpenGLES 并取得了不同程度的成功。我当前的问题是尝试加载 .obj 文件。我发现了一个很棒的[GLOBJLoader](http://bill.dudney.net/roller/objc/entry/wave_front_obj_textures_working)，我一直在我当前的项目中实现它，但还没有完全实现。

这是我的代码

```
- (void)createFramebuffer
{

glGenFramebuffersOES(1, &viewFrameBuffer);
NSLog(@"Check 1");
[self checkFrameBuffer];
glGenRenderbuffersOES(1, &viewRenderBuffer);
NSLog(@"Check 2");
[self checkFrameBuffer];

glBindFramebufferOES(GL_FRAMEBUFFER_OES, viewFrameBuffer);
NSLog(@"Check 3");
[self checkFrameBuffer];
glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewRenderBuffer);
NSLog(@"Check 4");
[self checkFrameBuffer];
[context renderbufferStorage:GL_RENDERBUFFER_OES fromDrawable:(CAEAGLLayer*)self.layer];
NSLog(@"Check 5");
[self checkFrameBuffer];
glFramebufferRenderbufferOES(GL_FRAMEBUFFER_OES, GL_COLOR_ATTACHMENT0_OES, GL_RENDERBUFFER_OES, viewFrameBuffer);
NSLog(@"Check 6");
[self checkFrameBuffer];

GLint wide = 320;
GLint high = 480;

glGetRenderbufferParameterivOES(GL_RENDERBUFFER_OES, GL_RENDERBUFFER_WIDTH_OES, &wide);
NSLog(@"Check 7");
[self checkFrameBuffer];
glGetRenderbufferParameterivOES(GL_RENDERBUFFER_OES, GL_RENDERBUFFER_HEIGHT_OES, &high);
NSLog(@"Check 8");
[self checkFrameBuffer];

if(USE_DEPTH_BUFFER)
{
    glGenRenderbuffersOES(1, &depthRenderBuffer);
    NSLog(@"Check 9");
    [self checkFrameBuffer];
    glBindRenderbufferOES(GL_RENDERBUFFER_OES, depthRenderBuffer);
    NSLog(@"Check 10");
    [self checkFrameBuffer];
    glRenderbufferStorageOES(GL_RENDERBUFFER_OES, GL_DEPTH_COMPONENT16_OES, glWidth, glHeight);
    NSLog(@"Check 11");
    [self checkFrameBuffer];
    glFramebufferRenderbufferOES(GL_FRAMEBUFFER_OES, GL_DEPTH_ATTACHMENT_OES, GL_RENDERBUFFER_OES, depthRenderBuffer);
    NSLog(@"Check 12");
    [self checkFrameBuffer];
}
}

-(void)checkFrameBuffer
{
GLuint returned = (glCheckFramebufferStatus(GL_FRAMEBUFFER_OES));

if(returned != GL_FRAMEBUFFER_COMPLETE_OES)
{
    NSLog(@"Error code: %x -->", returned);
    switch (returned) {
        case GL_FRAMEBUFFER_INCOMPLETE_DIMENSIONS_OES:
            NSLog(@"Incomplete: Dimensions");
            break;

        case GL_FRAMEBUFFER_INCOMPLETE_FORMATS_OES:
            NSLog(@"Incomplete: Formats");
            break;

        case GL_FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT_OES:
            NSLog(@"Incomplete: Missing Attachment");
            break;

        case GL_FRAMEBUFFER_INCOMPLETE_ATTACHMENT_OES:
            NSLog(@"Incomplete: Attachment");
            break;

        default:
            NSLog(@"Complete");
            break;
    }
}
} 
```

createFrameBuffer() 方法显然是为了创建帧缓冲区，而 checkFrameBuffer() 只是为了帮助调试并在我执行每一步后输出帧缓冲区的状态。

我从中得到的输出是：

1.  检查 1
2.  错误代码：8cdd -->
3.  完全的
4.  检查 2
5.  错误代码：8cdd -->
6.  完全的
7.  检查 3
8.  错误代码：8cd7 -->
9.  不完整：缺少附件
10.  检查 4
11.  错误代码：8cd7 -->
12.  不完整：缺少附件
13.  检查 5
14.  错误代码：8cd7 -->
15.  不完整：缺少附件
16.  检查 6
17.  错误代码：8cd6 -->
18.  不完整：附件
19.  检查 7
20.  错误代码：8cd6 -->
21.  不完整：附件
22.  检查 8
23.  错误代码：8cd6 -->
24.  不完整：附件
25.  检查 9
26.  错误代码：8cd6 -->
27.  不完整：附件
28.  检查 10
29.  错误代码：8cd6 -->
30.  不完整：附件
31.  检查 11
32.  错误代码：8cd6 -->
33.  不完整：附件
34.  检查 12
35.  错误代码：8cd6 -->
36.  不完整：附件

这些问题正在阻止它工作，我完全感到困惑。应该说我对 OpenGL 的了解并不多，我只是在拼凑一些东西并尝试边做边学，但我确实浏览了[Jeff Lamarche 的“OpenGLES From the Ground Up”](http://iphonedevelopment.blogspot.co.uk/2009/05/opengl-es-from-ground-up-table-of.html)，所以了解的很少。

任何帮助将不胜感激，如果您需要更多信息，请随时询问！

谢谢，

马特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T17:32:00.680

您是否在此之前的某个时间使用此设置您的上下文：

```
[EAGLContext setCurrentContext:context]; 
```

在您附加所有内容之前，不要费心检查您的帧缓冲区状态。只有这样，它才会注册为完整的。

以下是我用于设置具有深度缓冲区的 OpenGL ES 1.1（鉴于我在您的代码中看到的 OES 后缀）帧缓冲区的代码：

```
 [EAGLContext setCurrentContext:context];

    glGenFramebuffersOES(1, &viewFramebuffer);
    glGenRenderbuffersOES(1, &viewRenderbuffer);

    glBindFramebufferOES(GL_FRAMEBUFFER_OES, viewFramebuffer);
    glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewRenderbuffer);

    [context renderbufferStorage:GL_RENDERBUFFER_OES fromDrawable:glLayer];
    glFramebufferRenderbufferOES(GL_FRAMEBUFFER_OES, GL_COLOR_ATTACHMENT0_OES, GL_RENDERBUFFER_OES, viewRenderbuffer);

    glGetRenderbufferParameterivOES(GL_RENDERBUFFER_OES, GL_RENDERBUFFER_WIDTH_OES, &backingWidth);
    glGetRenderbufferParameterivOES(GL_RENDERBUFFER_OES, GL_RENDERBUFFER_HEIGHT_OES, &backingHeight);

    glGenRenderbuffersOES(1, &viewDepthBuffer);
    glBindRenderbufferOES(GL_RENDERBUFFER_OES, viewDepthBuffer);
    glRenderbufferStorageOES(GL_RENDERBUFFER_OES, GL_DEPTH_COMPONENT16_OES, backingWidth, backingHeight);
    glFramebufferRenderbufferOES(GL_FRAMEBUFFER_OES, GL_DEPTH_ATTACHMENT_OES, GL_RENDERBUFFER_OES, viewDepthBuffer);

    if(glCheckFramebufferStatusOES(GL_FRAMEBUFFER_OES) != GL_FRAMEBUFFER_COMPLETE_OES) 
    {
        return;
    } 
```

让我印象深刻的一个区别是，您输入的是帧缓冲区而不是`glFramebufferRenderbufferOES()`. 这可能是你问题的根源。此外，您以像素为单位明确设置 FBO 大小，而不是从视图层中获取该大小，我不知道您是否想这样做。

# php - 使用 FPDF 和 FPDI 编辑现有的 PDF 多页文件

> ID：10721497
> 
> 赞同：1
> 
> 时间：2012-05-23T13:57:24.487
> 
> 标签：php, fpdf, fpdi

我正在使用 FPDI 来编辑我现有的 pdf 文件，它的工作非常适合单页。如您所见，我正在编辑我的`$tplIdx = $pdf->importPage(1);`第一页。我有六页的 pdf 文件，需要在不同的页面中添加 2 个变量。

有可能吗？如何？

```
<?php
require_once('fpdf.php');
require_once('fpdi.php');

// initiate FPDI
$pdf = new FPDI();
// add a page
$pdf->AddPage();
// set the sourcefile
$pdf->setSourceFile('ex.pdf');

// import page 1
$tplIdx = $pdf->importPage(1);

// use the imported page and place it at point 10,10 with a width of 100 mm
$pdf->useTemplate($tplIdx, 10, 10, 200);

// now write some text above the imported page
$pdf->SetFont('Arial');
$pdf->SetTextColor(255,0,0);
$pdf->SetXY(50, 50);
$pdf->Write(0, "Ajay Patel");

$pdf->Output('newpdf1.pdf', 'D');
?> 
```

提前致谢 ！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-23T15:55:36.523

没有安装 FPDI 很难尝试。但我相信核心思想如下：

```
<?php

  require_once('fpdf.php');
  require_once('fpdi.php');

  // initiate FPDI
  $pdf = new FPDI();

  /* <Virtual loop> */
  $pdf->AddPage();
  $pdf->setSourceFile('ex.pdf');
  $tplIdx = $pdf->importPage(1);

  $pdf->useTemplate($tplIdx, 10, 10, 200);

  // now write some text above the imported page
  $pdf->SetFont('Arial');
  $pdf->SetTextColor(255,0,0);
  $pdf->SetXY(50, 50);
  $pdf->Write(0, "Ajay Patel");

  /* </Virtual loop/> */

  $pdf->AddPage();
  //$pdf->setSourceFile('ex.pdf');
  $tplIdx = $pdf->importPage(2);

  $pdf->useTemplate($tplIdx, 10, 10, 200); // dynamic parameter based on your page

  $pdf->SetFont('Arial');
  $pdf->SetTextColor(255,0,0);
  $pdf->SetXY(50, 50);
  $pdf->Write(0, "Ajay Patel2");

  $pdf->Output('newpdf1.pdf', 'D');
?> 
```

如果这可行，您可以摆脱代码的第二块并在循环中退出（以及动态定位）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T07:28:47.230

谢谢@JA 你的想法对我有用

我刚刚发布了其他人的答案以帮助他们

```
<?php
require_once('fpdf.php');
require_once('fpdi.php');

// initiate FPDI
$pdf = new FPDI();
// add a page
$pdf->AddPage();
// set the sourcefile
$pdf->setSourceFile('newpdf.pdf');

// import page 1
$tplidx = $pdf->importPage(1);
for ($i = 1; $i < 6; $i++) { 
              $tplidx = $pdf->ImportPage($i); 

                     $pdf->useTemplate($tplidx, 10, 10, 200);
                     $pdf->AddPage();

                     $pdf->SetFont('Arial');
                     $pdf->SetTextColor(0,0,0);
                     $pdf->SetFontSize(8);

                     if ($i==3) {
                        $pdf->SetXY(50, 124);
                        $pdf->Write(1, "Ajay Patel");

                        $pdf->SetXY(50, 133);
                        $pdf->Write(1, date("d/m/Y"));
                     }

                     if ($i==4) {
                        $pdf->SetXY(50, 171);
                        $pdf->Write(1, "Ajay Patel");

                        $pdf->SetXY(50, 185);
                        $pdf->Write(1, date("d/m/Y"));
                     }

                }

$pdf->Output('newpdf1.pdf', 'D');
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-23T11:33:22.573

您应该真正利用 setSourceFile 的返回值来遍历所有页面：

描述

`public int FPDI::setSourceFile ( string $filename )`

根据所用文档的 PDF 版本，生成的文档的 PDF 版本将调整为更高版本。

参数

```
$filename : string // A valid path to the PDF document from which pages should be imported from 
```

返回值

**文档中的页数**

# android - Android将自定义对象从服务传递给活动

> ID：10721498
> 
> 赞同：6
> 
> 时间：2012-05-23T13:57:25.223
> 
> 标签：android, service, asmack

我正在使用 asmack 为 android 创建一个 Instant Messenger。我已经启动了一个连接到 xmpp 服务器的聊天服务。该服务连接到 xmpp 服务器，我正在获取名册和存在。但现在我必须更新 UI 并将帐户对象列表从服务传递到活动。我遇到了 Parcelable 和可序列化的。我无法弄清楚这项服务的正确方法是什么。有人可以提供一些我可以做的代码示例吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:24:57.127

你正在制作一个不错的应用程序。我不太了解 smack，但我知道如何将对象从服务传递到 Activity。您可以为您的服务制作 AIDL。AIDL 会将您的服务对象传递给活动。然后您可以更新您的活动 UI。这个[链接](http://marakana.com/forums/android/examples/48.html)可能对你有帮助！

首先，您必须使用编辑器制作 .aidl 文件并将此文件保存在桌面上。AIDL 只是一个接口而已。比如，**ObjectFromService2Activity.aidl**

```
package com.yourproject.something

// Declare the interface.
interface ObjectFromService2Activity {
    // specify your methods 
    // which return type is object [whatever you want JSONObject]
    JSONObject getObjectFromService();

} 
```

现在复制此文件并将其粘贴到您的项目文件夹中，ADT 插件将在 gen/ 文件夹中自动生成 ObjectFromService2Activity 接口和存根。

Android SDK 还包括一个（命令行）编译器辅助工具（位于 tools/ 目录中），您可以使用它来生成 java 代码，以防您不使用 Eclipse。

覆盖服务中的 obBind() 方法。比如，**Service1.java**

```
public class Service1 extends Service {
private JSONObject jsonObject;

@Override
public void onCreate() {
  super.onCreate();
  Log.d(TAG, "onCreate()");
  jsonObject = new JSONObject();
}

@Override
public IBinder onBind(Intent intent) {

return new ObjectFromService2Activity.Stub() {
  /**
   * Implementation of the getObjectFromService() method
   */
  public JSONObject getObjectFromService(){
    //return your_object;
    return jsonObject;
  }
 };
}
@Override
public void onDestroy() {
   super.onDestroy();
   Log.d(TAG, "onDestroy()");
 }
} 
```

使用您的活动或您想要启动此服务的位置启动您的服务并进行 ServiceConnection。喜欢，

```
Service1 s1;
private ServiceConnection mConnection = new ServiceConnection() {
    // Called when the connection with the service is established
    public void onServiceConnected(ComponentName className, IBinder service) {
        // Following the example above for an AIDL interface,
        // this gets an instance of the IRemoteInterface, which we can use to call on the service
        s1 = ObjectFromService2Activity.Stub.asInterface(service);
    }

    // Called when the connection with the service disconnects unexpectedly
    public void onServiceDisconnected(ComponentName className) {
        Log.e(TAG, "Service has unexpectedly disconnected");
        s1 = null;
    }
}; 
```

使用 ObjectFromService2Activity 的对象，您可以访问方法 s1.getObjectFromService() 将返回 JSONObject。[更多帮助](http://developer.android.com/guide/developing/tools/aidl.html)乐趣！

# javascript - keydown 上的普通字符和半字符的区别

> ID：10721499
> 
> 赞同：2
> 
> 时间：2012-05-23T13:57:26.440
> 
> 标签：javascript, macos, mediawiki, ime, wysiwym

我们分叉了实验性的 Mediawiki VisualEditor。这个 WYSIWYM 编辑器使用隐藏的文本区域和 DOM 中的内容表示。当您聚焦视图时，焦点被赋予 textarea，视图监听 keydown 事件以将每个键入的字符添加到内容中，然后清空 textarea 的值。

仅在 Mac OS X 上出现半字符问题。如果您键入 ^ 或 ¨ 或任何需要打印第二个字符的字符，则会触发 keydown 事件。因此，当用户想要一个“ê”时，他输入“^”。查看获取 textarea 值（'^'）并清理 textarea 值。然后，用户键入“e”。视图显示“^e”。作为奖励，在 Chrome 上（在这种情况下 Firefox 更好），用户将永远无法在不重新加载窗口的情况下在任何输入中键入当前页面上的任何重音符号。

有什么办法可以区分真人和半人吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T08:12:24.277

刚刚找到一个解决方法。通过监听`keyup`事件，死键返回一个`keyIdentifier`设置为 的属性`Unidentified`。

所以 ：

```
keyuphandler = function(e)
{
    if (e.keyIdentifier === 'Unidentified')
    {
        return;
    }
    doSomething();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:12:05.417

您是从按键事件中获取字符还是从文本区域读取字符？我只是用一个输入字段尝试了这个，它的值在第一次按下 ^ 按钮时没有改变。但是，我正在使用 Windows。最后的手段显然是以不同的方式处理这些修改按键。如果您的目标是支持 alt+654 等组合键，这可能会有些复杂。下班回家后，我会在我的 Mac 上再试一次。

# ant - 在远程运行 Ant JUnit 测试期间避免 SSH 超时

> ID：10721504
> 
> 赞同：1
> 
> 时间：2012-05-23T13:57:53.330
> 
> 标签：ant, junit, ssh

我正在使用 Ant 从本地机器远程运行 JUnit 测试套件到远程服务器，超时约 30 分钟。使用 javac/java 运行这些 JUnit 测试可以正常工作，因为 JUnit在每次测试之后输出 a `.`or 。`E`这种连续输出使 ssh 连接在测试套件需要运行的大约 9 个小时内保持活动状态。但是对于 Ant，在测试套件完成之前没有任何输出，这会过早地终止测试过程。我尝试了几种不同的结果报告方法（写入文件、几乎所有格式选项等）。

我的问题是：

如何使 SSH 连接保持足够长的时间以完成我的测试套件？我无权更改任何 ssh 连接设置，并且由于代码位于远程服务器上，因此我无法在每次测试之前/期间/之后从本地计算机向服务器发送任何内容。

或者

如何设置 Ant 在每次测试期间打印/回显某种输出？使用带有 Java 的 ProcessBuilder 的 echo 不会出现在终端中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T14:06:54.007

我不知道是否有参数可以避免超时（可能是服务器端），但您应该考虑使用 NOHUP 命令（请参阅[NOHUP](http://en.wikipedia.org/wiki/Nohup)）。这将允许您在不停止命令的情况下启动您的命令并关闭您的 ssh 会话。

亚历克西斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:09:54.530

假设防火墙因为看到它处于非活动状态而终止连接，请尝试将 ServerAliveInterval 设置为 15 左右`~/.ssh/config`。

或者，尝试在 Tmux 或 GNU Screen 会话中运行测试套件。您的 ssh 连接仍将中断，但您的测试将继续运行，您将能够重新连接到它们。

# javascript - 当我调用“viewModel.errors().length”时会触发假错误消息

> ID：10721505
> 
> 赞同：-1
> 
> 时间：2012-05-23T13:57:55.897
> 
> 标签：javascript, validation, jquery-validate, knockout.js, knockout-2.0

我有一个 ViewModel，我将它与[ericmbarnard / Knockout-Validation](https://github.com/ericmbarnard/Knockout-Validation)一起使用。在其中我有这个领域：

```
self.checksum = ko.observable().extend({required: {message: " * Required"}}); 
```

在我的 html 中，这是：

```
<input type="text" id="txtCheckSum" name="txtCheckSum" data-bind="value: checksum"/> 
```

我用 javascript 代码添加“输入文件”值。在这段 javascript 代码中，我计算 md5 文件，然后填写字段 txtCheckSum。但不幸的是，这不会自动填充我的 ViewModel。

所以，当我调用检查“viewModel.errors().length == 0”时，我有一个像空的错误。

帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T15:22:36.330

As mentioned in the comments the point of KO is to separate your data from your view. By using the jquery selectors to update the value of inputs you are essentially using KO wrong. In very few circumstances is plain jquery needed.

The correct approach would be to update the observable itself.

```
vm.checksum("md5 code"); 
```

Then you can eliminate the $("#txtCheckSum").val/trigger all together.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T10:50:33.430

**我找到了解决方案**

在 Javascript 代码中，我放了这个：

```
 $("#txtCheckSum").val('md5 code');
    $('#txtCheckSum').trigger('change'); 
```

我的视图模型接受了这些更改。

# html - HTML：为什么元素占用这么多宽度？

> ID：10721506
> 
> 赞同：0
> 
> 时间：2012-05-23T13:58:04.483
> 
> 标签：html, css, wordpress, width

我一直在研究一个自定义的 wordpress 主题，这是一个学校项目的一部分，我们应该为一个协会（在我的例子中是一个剧院组）重新设计一个主页。

我已经自定义了 wordpress 菜单以添加四个页面的图像。但是，`<nav>`这些图像所在的元素占用的宽度比预期的要大，即使我`width: auto`在 CSS 中使用。正因为如此，我重新定位了`<nav>`我`margin-right: -133px;`认为不应该解决这个问题的方法。

上部横幅的 HTML 是：（删除了一大堆注释代码）

```
<header role="banner" id="branding">
    <a href="http://dev.zomis.net/talat/">
        <img alt="" src="http://dev.zomis.net/talat/wp-content/themes/talat/talat-logo.png" id="header_logotype">
    </a>
    <nav role="navigation" id="access">
        <a href="http://dev.zomis.net/talat/forening">
            <img src="http://dev.zomis.net/talat/wp-content/themes/talat/talat_meny_forening_gray.jpg" id="menu_image_forening" class="menu_image">
        </a>
        <a href="http://dev.zomis.net/talat/scen">
            <img src="http://dev.zomis.net/talat/wp-content/themes/talat/talat_meny_scen.jpg" id="menu_image_scen" class="menu_image">
        </a>
        <a href="http://dev.zomis.net/talat/film">
            <img src="http://dev.zomis.net/talat/wp-content/themes/talat/talat_meny_film_gray.jpg" id="menu_image_film" class="menu_image">
        </a>
        <a href="http://dev.zomis.net/talat/natverk">
            <img src="http://dev.zomis.net/talat/wp-content/themes/talat/talat_meny_natverk_gray.jpg" id="menu_image_natverk" class="menu_image">
        </a>
        <div class="menu-talat-container"><ul class="menu" id="menu-talat"></ul></div>
    </nav>
</header> 
```

为了更容易看到问题，我`header`用红色标记了整个元素，`nav`用黄色标记了 。

我一直在使用 Firebug 来玩耍，看看是什么原因造成的，但我无法弄清楚。我一直怀疑`<div class="menu-talat-container">`内部的空白`<header>`是造成这种情况的原因，但是我已经用 Firebug 多次删除了该部分，并且没有发现任何区别。

该页面可见：[http ://dev.zomis.net/talat/scen](http://dev.zomis.net/talat/scen)

它的外观图像和我不理解的部分标有文字“为什么这个黄色部分突出到右边？”：![为什么这个黄色部分突出到右边？](../Images/4c022d865c8f63bf354f69c55f9e5efa.png)

删除`margin-right`属性时，问题变为“为什么这里没有图像？”： ![为什么标记区域没有图像？](../Images/768c92a6998558c89862ec968a5f0851.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:14:57.217

发生这种情况的原因是图像的宽度设置为 15%。它们总共只占容器宽度的 60%。当您添加手动设置的边距时，它仍然低于 100%。所以#access div 只是添加了那个空间。

我认为将图像的宽度设置为百分比不是一个好主意。我建议编辑图像以适合您希望它们占据的实际空间，然后不在您的 css 中设置图像的宽度和高度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:17:40.173

为什么图像太小会占据整个空间？

只需从 中删除该`margin-right: -133`属性`id='access'` `nav`并更改照片的大小。更改尺寸属性`#access img`（当前为 15%，但您可以将其设置为 22%）。

图像会缩放并变得更高，因此您可能想要调整标题元素的大小或可能裁剪图像。

您还可以在 上再添加一张图像，`nav`并使用左/右边距和填充`#access img`。

# r - 计算数据在R中另一个数据帧中的次数

> ID：10721517
> 
> 赞同：2
> 
> 时间：2012-05-23T13:58:27.987
> 
> 标签：r, count, row, dataframe, data.table

我有三个数据帧，我想在第一个数据帧中添加一些列，它计算第一个数据帧中的前两列出现在其他数据帧中的次数，例如

数据框 - x
ab
1 1
1 2
2 1
2 2

数据框 - y
ab
1 1
1 1
1 2
2 2
2 2

数据框 - z
ab
1 2
2 1
2 1
2 2

所以第一个数据帧会变成
abyz
1 1 2 0
1 2 1 1
2 1 0 2
2 2 2 1

我有办法做到这一点，例如我目前正在做

```
x$y<- sapply(1:nrow(x), function(i){
    sum(y$a == x$a[i] & y$b == x$b[i])
  }

x$z<- sapply(1:nrow(x), function(i){
    sum(z$a == x$a[i] & z$b == x$b[i])
  } 
```

但是我的数据框非常大，我的方法需要一段时间才能完成，所以我想知道最快的方法来做到这一点。

请询问是否有任何不清楚的地方。

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T14:39:24.450

为了避免双重循环，我将使用函数 match，该函数针对在另一个列表中查找元素进行了优化。要计算有多少元素，我建议先将变量制成表格，然后与表格进行匹配。

我的猜测是它会显着降低时间复杂度，因为您提出的方法是二次的（一个循环遍历 x 行，每个内部循环遍历 y 行）而函数 match 和 table 基于排序（我认为) 是 n*log(n)。

我们首先使用粘贴将数据帧转换为向量，取自 Josh 的回答：

```
# Recreate your data
x <- data.frame(a=c(1,1,2,2), b=c(1,2,1,2))
y <- data.frame(a=c(1,1,1,2,2), b=c(1,1,2,2,2))
z <- data.frame(a=c(1,2,2,2), b=c(2,1,1,2))

# Use paste to combine the two columns
X <- do.call(paste, c(x, sep="_"))
Y <- do.call(paste, c(y, sep="_"))
Z <- do.call(paste, c(z, sep="_")) 
```

然后我们制表并与制表相匹配。

```
x$y <- table(Y)[match(X, names(table(Y)))]
x$y[is.na(x$y)] <- 0

x$z <- table(Z)[match(X, names(table(Z)))]
x$z[is.na(x$z)] <- 0

x  
a b y z
1 1 1 2 0
2 1 2 1 1
3 2 1 0 2
4 2 2 2 1 
```

如果要避免两次制表，可以将 table(Y) 放在中间变量中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-25T11:50:39.883

你说你的数据框非常大，所以这是[`data.table`](http://datatable.r-forge.r-project.org/)这样的：

```
> require(data.table)
> x <- data.table(a=c(1,1,2,2), b=c(1,2,1,2))
> y <- data.table(a=c(1,1,1,2,2), b=c(1,1,2,2,2))
> z <- data.table(a=c(1,2,2,2), b=c(2,1,1,2)) 
> 
> setkey(x,a,b)    # sort and mark as sorted by a,b
> setkey(y,a,b)    # same for y
> setkey(z,a,b)    # same for z
> x[,y:=y[x,.N][[3]]]  
       # join to y from x, using the key.
       # .N = number of matching rows
       # := means assign by reference back to column y in x, no copy at all
       # [[3]] can be understood by running `y[x,.N]` on its own
     a b y
[1,] 1 1 2
[2,] 1 2 1
[3,] 2 1 0
[4,] 2 2 2
> x[,z:=z[x,.N][[3]]]   # same for z
     a b y z
[1,] 1 1 2 0     # bug in v1.8.0 gave z=1 on this row, fixed in v1.8.1
[2,] 1 2 1 1
[3,] 2 1 0 2
[4,] 2 2 2 1 
```

这根本不会复制大对象，即使是一次。它们越大，可能就越重要。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T14:11:15.033

这可能会更快：

```
# Recreate your data
x <- data.frame(a=c(1,1,2,2), b=c(1,2,1,2))
y <- data.frame(a=c(1,1,1,2,2), b=c(1,1,2,2,2))
z <- data.frame(a=c(1,2,2,2), b=c(2,1,1,2))

# Use paste to combine the two columns in each data.frame
X <- do.call(paste, c(x, sep="-"))
Y <- do.call(paste, c(y, sep="-"))
Z <- do.call(paste, c(z, sep="-"))

# Count number of times each element of X appears in Y and Z
x$y <- sapply(X, function(string) sum(string==Y))
x$z <- sapply(X, function(string) sum(string==Z))
x
#   a b y z
# 1 1 1 2 0
# 2 1 2 1 1
# 3 2 1 0 2
# 4 2 2 2 1 
```

# javascript - 如何检测参数 jQuery 对象

> ID：10721518
> 
> 赞同：10
> 
> 时间：2012-05-23T13:58:30.287
> 
> 标签：javascript, jquery

我想创建可以与 Id 或通过传递 jQuery 对象一起使用的函数。

```
var $myVar = $('#myId');

myFunc($myVar);
myFunc('myId');

function myFunc(value)
{
    // check if value is jQuery or string
} 
```

如何检测传递给函数的参数类型？

**笔记！** [这个](https://stackoverflow.com/questions/6283255/detect-if-an-argument-is-a-jquery-selector)问题不一样。我不想传递选择器字符串，例如`#id.myClass`. 我想像示例中一样传递 jQuery 对象。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-23T14:03:09.177

使用`typeof`运算符

```
if ( typeof value === 'string' ) {
  // it's a string
} else {
  // it's something else
} 
```

或者确保它是 jQuery 对象的一个​​实例

```
if ( typeof value === 'string' ) {
  // it's a string
} else if ( value instanceof $) {
  // it's a jQuery object
} else {
  // something unwanted
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T14:06:21.253

每个 jquery 对象都有一个属性`jquery`。当然，如果您的对象具有`jquery`属性，这将失败......但如果您愿意，您可以进行更严格的检查......

```
function(o) {
    if(typeof o == 'object' && o.jquery) // it's jquery object.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T14:04:08.273

```
function myFunc(value)
{
   if (typeof value == "string") {
      //it's a string
   }
   else if (value != null && typeof value == "object"} {
      //it's an object (presumably jQuery object)
   }
   else {
      //it's null or something else
   }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T14:03:37.737

检查参数的类型还不够吗？

```
function myfunc(arg)
{
    if(typeof arg == 'string')
    {

    }
    else if(typeof arg == 'object')
    {

    }  
} 
```

检查这个[小提琴](http://jsfiddle.net/AkjzT/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-23T14:04:28.733

尝试这个：

```
function myFunc(value)
{
   if(typeof value === 'object') {
   }
   else{
   }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-23T14:04:31.993

```
function myFunc(value)
{
  if(typeof(value) == 'string')
    //this is a string
  else if (value === jQuery)
    //this is jQuery
  else if (typeof(value) == 'object')
    //this is an object
} 
```

注意：在控制台中执行此操作：

```
> jQuery
function (a,b){return new e.fn.init(a,b,h)}
> var value = jQuery
undefined
> value
function (a,b){return new e.fn.init(a,b,h)}
> value === jQuery
true 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-23T14:06:38.183

尝试使用 typeof，例如：

```
var $myVar = $('#myId');

myFunc($myVar);
myFunc('myId');

function myFunc( value ){
    // check if value is jQuery or string
    switch( typeof value ) {
        case 'object':
        // is object
        break;

        case 'string':
        // is string
        break;

        // etc etc.
    }
} 
```

# intellij-idea - 如何更改从 Intellij Idea 中的错误跟踪器上传的任务数量

> ID：10721519
> 
> 赞同：0
> 
> 时间：2012-05-23T13:58:31.353
> 
> 标签：intellij-idea, task-management

有没有可能设置从redmine上传到idea的任务管理系统的任务数量？

我的问题是，在我按下`Ctrl+Space`“*打开任务”*对话框后，idea 默认只上传 25 个最新问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:48:02.790

现在不可能，请在 YouTrack 中[为开放请求投票。](http://youtrack.jetbrains.com/issue/IDEA-82058)

# java - 如何使用 hudson 或 jenkins Websphere deploy 插件在 Websphere Cluster 环境中部署 EAR 应用程序

> ID：10721523
> 
> 赞同：3
> 
> 时间：2012-05-23T13:58:43.333
> 
> 标签：java, hudson, websphere, jenkins

我的要求是使用 jenkin 的 Websphere deploy 插件在 Websphere Cluster 环境中部署 EAR 应用程序。

所以我需要在哪里指定服务器或单元或节点或集群等详细信息。

我知道我们在 hudson websphere-plugin [http://wiki.hudson-ci.org/display/HUDSON/Deploy+WebSphere+Plugin] 1.0 版中使用了 WAS61Adapter.properties 文件，我们是否需要在此属性文件中提及 [ WAS61Adapter.properties] 。若有，详情为何？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-15T01:46:27.807

我创建了一个新的 jenkins 插件，它可能适合您的需求。

[https://wiki.jenkins-ci.org/display/JENKINS/WebSphere+Deployer+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/WebSphere+Deployer+Plugin)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-02T22:16:12.113

尝试使用 Websphere ant

检查这个[http://pic.dhe.ibm.com/infocenter/wasinfo/v6r1/index.jsp?topic=%2Fcom.ibm.websphere.javadoc.doc%2Fpublic_html%2Fapi%2Fcom%2Fibm%2Fwebsphere%2Fant%2Ftasks %2Fpackage-summary.html](http://pic.dhe.ibm.com/infocenter/wasinfo/v6r1/index.jsp?topic=%2Fcom.ibm.websphere.javadoc.doc%2Fpublic_html%2Fapi%2Fcom%2Fibm%2Fwebsphere%2Fant%2Ftasks%2Fpackage-summary.html)

# php - Zend_lucene，索引文本内容

> ID：10721535
> 
> 赞同：0
> 
> 时间：2012-05-23T13:59:13.103
> 
> 标签：php, zend-framework, lucene

我使用 Zend_Lucene 搜索文本文件。

```
$index = Zend_Search_Lucene::create ('cachedir');
$doc = Zend_Search_Lucene_Document_Html::loadHTML (file_get_content('source.html'), false, 'UTF-8');
$index->addDocument($doc);
$hit = $index->find(findmeeeh); 
```

这确实有效，但似乎没有使用索引。我想要什么：如果我搜索一个单词，它应该被索引并更快地找到。我不明白他们在这里写了什么[http://framework.zend.com/manual/en/zend.search.lucene.index-creation.html](http://framework.zend.com/manual/en/zend.search.lucene.index-creation.html) ...

# java - 使用 Java 和 STAX 编写 RSS 提要 - 如何使其动态化？

> ID：10721544
> 
> 赞同：0
> 
> 时间：2012-05-23T13:59:52.140
> 
> 标签：java, rss

我编写了一个 java 程序，它将生成一个 rss 提要。我无法弄清楚的是如何以按需生成提要的方式将其提供给我的用户？数据会不断变化，我希望他们在打开提要时看到最新的。我可能遗漏了一些明显的东西。这将位于 Spring Web 应用程序中的 Tomcat 7 服务器上。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T01:15:44.167

大概你想编写一个 servlet，它在每个请求上生成 rss 提要。你的问题还有更多吗？

# php - Yii相同模型保存两次，AJAX验证

> ID：10721545
> 
> 赞同：0
> 
> 时间：2012-05-23T13:59:57.453
> 
> 标签：php, ajax, validation, yii

我需要用不同的数据保存模型两次：

**控制器：**

```
 $modelClient = new Client;

 if(Yii::app()->getRequest()->getIsAjaxRequest()) {
    echo CActiveForm::validateTabular( array( $modelClient));
    Yii::app()->end();
 } 
```

**查看（仅相关部分）**

```
<?php echo $form->textFieldRow($modelClient, '[0]name'); ?>
<?php echo $form->textFieldRow($modelClient, '[0]street'); ?>

<?php echo $form->textFieldRow($modelClient, '[1]name'); ?>
<?php echo $form->textFieldRow($modelClient, '[1]street'); ?> 
```

**JSON 输出**

```
{"Client_0_name":["field is empty"],"Client_0_street":["field is empty"]} 
```

所以第二个模型被忽略了。

**我试过**

```
if(Yii::app()->getRequest()->getIsAjaxRequest()) {
   foreach ($_POST[Client] as $client) {
    $temp = new Client;
    $temp->setAttributes($client);
    echo CActiveForm::validate( array( $modelClient));
   }
   Yii::app()->end();
} 
```

但它返回没有正确 id 的 JSON 输出，例如：

```
 {"Client_name":["field is empty"],"Client_street":["field is empty"]} 
```

结果它只是不验证任何字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:41:33.283

在您的控制器中，您应该将模型声明为数组。

```
 $modelClients=array();
 $modelClients[] = new Client;
 $modelClients[] = new Client;

 if(Yii::app()->getRequest()->getIsAjaxRequest()) {
    echo CActiveForm::validateTabular(  $modelClients);
    Yii::app()->end();
 } 
```

你的第一个模型去`$modelClients[0]`，第二个模型去`$modelClients[1]`

# android - 使用 eclipse 开发一个水平方向的 android 应用程序

> ID：10721547
> 
> 赞同：0
> 
> 时间：2012-05-23T14:00:11.680
> 
> 标签：android, orientation

我想在设备水平方向时开发一个布局。在 xml 文件的图形布局中提供横向视图显示它在那里但不在模拟器中..有人请帮助..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:16:00.043

要将模拟器从横向更改为纵向，反之亦然，请使用 CTRL+F11。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:03:24.617

用于`android:screenOrientation="landscape"`您`activity`的 AndroidManifest.xml

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T14:05:12.800

你有没有改变模拟器的方向？手机默认是纵向的，如果你把布局放在layout-land，它就不会在纵向模式下使用。

`Ctrl-f11`并将`ctrl-f12`在 Windows 机器上切换模拟器的方向（当模拟器在前台时）。

# jquery - jquery - 如何显示隐藏的 div

> ID：10721552
> 
> 赞同：15
> 
> 时间：2012-05-23T14:00:23.437
> 
> 标签：jquery, html

我的页面中嵌入了一个谷歌地图，其可见性设置为隐藏。使用一个按钮，我想在页面上显示地图。应该使用jquery来完成。

我的代码 - （不工作）

```
<div id="map" style="height: 350px; border: 1px solid #979797;visibility="hidden";></div> 
```

任何人都可以帮助我处理相关的 jquery 代码吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-05-23T14:03:43.310

尝试

```
$('#map').css('visibility','visible'); 
```

实际上，如果 style 有`display:none`，你可以使用 jquery 函数

```
$('#map').show(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-23T14:04:49.580

您的 style="" 标签也不正确。你应该有这个：可见性：隐藏；

试试这个：

```
<div id="map" style="height: 350px; border: 1px solid #979797; display: none";></div>

$("#map").show(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:04:25.840

这是一个jsfiddle：http: [//jsfiddle.net/lucuma/GhMbU/](http://jsfiddle.net/lucuma/GhMbU/)

`$('div#map').css('visibility', 'visible')`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-08T06:11:36.370

但`visibility:hidden`总比`display:none`你想用 jQuery 隐藏它好。因为jQuery的`.show()`功能覆盖了一些页面元素比如锚标签，防止点击事件。

# php - Wordpress 嵌套循环

> ID：10721555
> 
> 赞同：1
> 
> 时间：2012-05-23T14:00:40.403
> 
> 标签：php, nested-loops, wordpress

这是我拥有的标准 HTML 代码，我正在尝试将其合并到一个 Wordpress 循环中，该循环基本上以两种不同的方式显示帖子。我正在使用更多字段插件供用户选择显示帖子的两种方式之一。1) 如果他们选择大，则帖子将使用 div 类“大链接”进行包装 2) 如果用户选择“小”，则会创建一个具有“groupOflinks”类的 div，并将帖子使用 div 类“smallLink”包装'。一个 'groupOflinks' div 中只能保存 4 个 'smallLink' div's/posts。如果有超过 4 个小帖子，则会创建一个新的 'groupOflinks' div 并重复该过程。

这是我试图合并的 HTML 代码（大量评论）：

```
<!-- Display one post within this container only & if there are more posts that have been chosen as Large, wrap them in the 'largeLink' div -->

<div class="largeLink">
    <!-- post 1 content here -->
</div>

<div class="largeLink">
    <!-- post 2 content here -->
</div>

<!-- If a post is defined as small within the admin panel (using more fields plugin) 
     display them within this 'groupoflinks' container 
     If 4 posts are already in this 'groupoflinks' container create a new container and populate with another 4 posts 
     Repeat -->

<div class="groupOfLinks">
    <!-- This is a container that holds 4 posts only & if there are more posts that have been assigned as 'Small' create a new 'groupOflinks' container and populate with the next 4 -->
    <div class="smallLink">
        <!-- Post 4 content here -->
    </div>
    <div class="smallLink">
        <!-- Post 5 content here -->
    </div>
    <div class="smallLink">
        <!-- Post 6 content here -->
    </div>
    <div class="smallLink">
        <!-- Post 7 content here -->
    </div>
</div>

<div class="largeLink">
    <!-- post 3 content here -->
</div>

<div class="largeLink">
    <!-- post 8 content here -->
</div> 
```

到目前为止，这是我的 WP 循环，它不太工作：

```
<?php if (have_posts()) : while (have_posts()) : the_post(); ?>

<?php // Take the value defined with the 'Layout' field and change style accordingly
$layouttype = get_post_meta($post->ID, 'layout-type', true) ?>
<?php if ($layouttype == 'Small') { ?>

<div class="groupOfLinks">

    <!--LOOP STYLE 1 GOES HERE-->
    <?php $temp_query = $wp_query;  // store it
        $args = array(
        'paged' => $paged, // paginates
        'post_type'=>'post',
        'order' => 'DESC'
        );
        $wp_query = new WP_Query($args);
        while ($wp_query->have_posts()) : $wp_query->the_post();?>

        <div class="smallLink">
                        <!-- Post content here -->
                        <h1><?php the_title(); ?></h1>
            <?php the_content(''); ?>
                    </div>

        <?php if (isset($wp_query)) {$wp_query = $temp_query;} // restore loop
              endwhile; ?>

</div>

<?php } else { ?>

<!--LOOP STYLE 2 GOES HERE-->

<div class="largeLink">
        <!-- post 1 content here -->
        <h1><?php the_title(); ?></h1>
        <?php the_content(''); ?>
    </div>

<?php } ?>

<?php endwhile; ?>

<div>
<div><?php next_posts_link('&laquo; Older Entries') ?></div>
<div><?php previous_posts_link('Newer Entries &raquo;') ?></div>
</div>

<?php else : ?>

<h2>Not Found</h2>
<p>Sorry, but you are looking for something that isn’t here.</p>

<?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:17:33.650

几分钟后我要开会，所以为了时间的缘故，我打算让你朝着正确的方向开始，你可能需要做一些调整，因为我写这篇文章很匆忙。让我们从您的循环开始并进行一些快速更改。

```
<?php
//Set a counter to determine if small post has been used
$small_posts = 0;
if(have_posts()) :
    while(have_posts()): the_post();
    $layouttype = get_post_meta(get_the_ID(), 'layout-type', true);
    if($layouttype == 'Small') :
        if(($small_posts % 4) == 0) :
            $tmp_query = clone $wp_query; ?>//this line was edited
            <div class="groupOfLinks">
                <div class="smallLink">
                    <h1><?php the_title(); ?></h1>
                    <?php the_content(); ?>
                </div>
                <?php $i = 1;
                while(have_posts() && $i <=4) : the_post(); 
                    $layouttype = get_post_meta(get_the_ID(), 'layout-type', true);
                    if($layouttype == 'Small') : ?>
                        <div class="smallLink">
                            <h1><?php the_title(); ?></h1>
                            <?php the_content(); ?>
                        </div>
                        <?php $i++; 
                   endif;
               endwhile; ?>
               </div>
               <?php $wp_query = clone $tmp_query;//this line was edited
        endif;//End counter check
        //Whether we needed to enter the subloop or not, the counter is incremented
        $small_posts++;
    else: //Else for if($layouttype == 'Small') ?>
        <div class="largeLink">
            <h1><?php the_title(); ?></h1>
            <?php the_content(); ?>
        </div>
   <?php endif;
   endwhile; ?>
<div>
    <div><?php next_posts_link('&laquo; Older Entries') ?></div>
    <div><?php previous_posts_link('Newer Entries &raquo;') ?></div>
</div>
<?php else : ?>
    <h2>Not Found</h2>
    <p>Sorry, but you are looking for something that isn’t here.</p>
<?php endif; ?> 
```

# html - HTML5 AppCache：浏览器刷新不起作用

> ID：10721557
> 
> 赞同：0
> 
> 时间：2012-05-23T14:00:43.933
> 
> 标签：html, html5-appcache

我正在努力让脱机文件在 Chrome 中工作。离线页面的第一个视图效果很好，但如果我刷新浏览器，就没有那么多了。

这是清单文件（作为内容类型“text/cache-manifest”提供）：

```
CACHE MANIFEST
CACHE:
../CSS/test.css 
```

这是我想离线运行的页面的 HTML：

```
<!DOCTYPE html>
<html manifest="/appname/Resources/manifest.appcache">
<head>
<link rel="stylesheet" href="../CSS/test.css" />
</head>
<body>foo</body>
</html> 
```

当离线页面第一次加载时，我在 Chrome 开发人员工具控制台中看到清单中的文件被加载到 appcache 中，没有任何错误，这很好。但是，当我尝试刷新浏览器时，我在控制台中看到一个 HTTP GET 错误，并且该页面没有应用来自 test.css 的样式。

我究竟做错了什么？如果我查看开发人员工具中的 Resources 选项卡，我会看到清单文件、html 文件和 test.css 文件出现在 appcache 中。当我刷新时，Fiddler 显示清单文件正在返回一个 HTTP 代码 304，我猜这是预期的吗？

谢谢，

安迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T20:06:14.323

修复方法是将清单的引用从 /appname/Resources/manifest.appcache 更改为 ../Resources/manifest.appcache。我不知道为什么对清单的初始调用会成功，而后一个路径会失败，但后一个路径似乎有效。

# visual-studio-2010 - Visual Studio 2010 C# 注释/文档生成器

> ID：10721558
> 
> 赞同：3
> 
> 时间：2012-05-23T14:00:45.097
> 
> 标签：visual-studio-2010, visual-studio, documentation-generation, xml-documentation, visual-studio-extensions

有谁知道一个 Visual Studio 2010 C# 插件，它将：

1.  允许我轻松修改（或创建新的）xml 注释模板。我需要在模板中添加一些用户特定的标签。例如，当我评论一个方法时，我希望在我键入 /// 时自动插入标签以及 Summary 和 Param。

2.  允许我修改将评论提取到漂亮的 html 文档时使用的 html 样式模板。我希望通过上面 1) 添加的文档显示在 HTML 中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-25T13:20:11.880

从[Atomineer Pro Documentation](http://www.atomineerutils.com/)开始创建/更新您的文档（作为代码中的注释），然后通过[Sandcastle](http://shfb.codeplex.com/)（用于 XML-doc 注释格式）或[Doxygen](http://www.doxygen.org/)（用于 XML、JavaDoc 或 Qt 注释格式）生成外部 html（等）文件。

（注意：我是 Atomineer Pro 文档的作者。另请参阅 GhostDoc、VSDocMan、DocumentX 以了解其他可能也适合您需求的系统）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:08:44.190

我为这项工作尝试了很多工具，而[GhostDoc](http://submain.com/products/ghostdoc.aspx)是我见过的最棒的工具。它有免费和付费版本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T14:55:02.870

你可以试试我们的[VSdocman](http://www.helixoft.com/vsdocman/overview.html)。这是一个商业应用程序，它可以同时执行 1\. 和 2。

# javascript - 如何在未“查看”时卸载图像以节省内存？

> ID：10721565
> 
> 赞同：13
> 
> 时间：2012-05-23T14:01:10.217
> 
> 标签：javascript, jquery, jquery-plugins

我有一个很长的图片库，我希望能够在移动设备上显示而不会导致浏览器崩溃或导致滚动不顺畅。周围有大量插件可以延迟加载图像，但是有什么可以在不在视图时卸载图像以节省内存吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-16T13:00:12.620

[这是LinkedIn工程团队博客文章LinkedIn for iPad](http://engineering.linkedin.com/linkedin-ipad-5-techniques-smooth-infinite-scrolling-html5)的引述：与此问题相关的HTML5中平滑无限滚动的5种技术：

> UIWebView/Mobile Safari[对图像有严格的限制](http://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariWebContent/CreatingContentforSafarioniPhone/CreatingContentforSafarioniPhone.html#//apple_ref/doc/uid/TP40006482-SW15)。我们的流中充满了大图像，因此我们很快就达到了极限。一种选择是使用 HTML5 Canvas 元素绘制图像[而不会遇到内存问题](http://roblaplaca.com/blog/2010/05/05/ipad-safari-image-limit-workaround/)。然而，我们发现在画布上绘制非常大的图像很慢，因此我们不得不采取另一种方法：每当图像被充分滑出屏幕时，我们将 img 标签的“src”属性替换为非常小的图像。这确保了用于渲染大图像的内存被定期释放。此外，我们确保没有引入[空图像 src 属性错误](http://www.nczonline.net/blog/2009/11/30/empty-image-src-can-destroy-your-site/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:22:59.727

我认为没有任何方法可以做到这一点。JavaScript 只保存对 DOM 对象的引用，而这些对象又由浏览器管理。因此，完全取决于浏览器缓存引擎来确定何时释放资源。并且这些决定不是基于是否存在对该对象的 JavaScript 引用，而是基于加载资源的页面是否仍然处于活动状态。在任何情况下，浏览器都会自动进行缓存管理，您无法通过 JavaScript 对其进行影响，因为这意味着与用户文件系统的一种交互，在 JavaScript 中，出于安全考虑，只有在显式授权的极少数情况下才允许这种交互.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-26T12:32:55.577

这是一篇较旧的文章，但仍然有帮助：[http ://www.vargatron.com/2010/08/ipad-html5-js-memory-management/](http://www.vargatron.com/2010/08/ipad-html5-js-memory-management/)

为了在图像元素进入和离开视口时附加事件处理程序以将其`src`属性替换为实际的 img url（在视口中）或占位符 url（在视口外），有以下插件：

[http://static.pixeltango.com/jQuery/Bullseye/](http://static.pixeltango.com/jQuery/Bullseye/) [http://imakewebthings.com/jquery-waypoints/](http://imakewebthings.com/jquery-waypoints/)

替换`src`属性值仍然不能保证浏览器会释放内存，但它是垃圾收集器的一个强有力的提示。无论如何，如果图像没有立即释放，那么如果用户决定滚动回它，它仍然在缓存中。

# c++ - OpenCV - 运行嵌入到 C++ 中的 python 代码时获取不正确的 SURF 描述符

> ID：10721567
> 
> 赞同：0
> 
> 时间：2012-05-23T14:01:16.640
> 
> 标签：c++, python, opencv, computer-vision, python-embedding

我正在开发一个利用 Kinect 深度信息的图像匹配器。我已经编写了很多代码，使用 OpenCV 在 Python 中进行标准图像匹配，但是为了使用 Kinect，我使用的是 OpenFrameworks(C++)。我没有重写我的 Python 代码，而是通过将它们嵌入到 C++ 代码中来运行我的脚本。

我有一个脚本，可以从一组图像中提取 SURF 特征并进行一些处理（聚类等）。当我使用 Python2.7 从命令行运行此脚本时，它工作正常。但是，当我通过我的 C++ 应用程序运行（嵌入）它时，所有 SURF 功能都有 90 度方向。

[结果应该是这样的] [http://i.stack.imgur.com/0fGf8.png](http://i.stack.imgur.com/0fGf8.png)

【这是通过C++运行时的结果】 [http://i.stack.imgur.com/ECPev.png](http://i.stack.imgur.com/ECPev.png)

我认为可能是我包含的 Python.h 来自不同版本的 Python，但它肯定使用了正确的版本。

我将如何解决/调查这个问题？

# javascript - 有人可以对socket.io“helloworld”等价物给出具体的评论和解释吗？

> ID：10721582
> 
> 赞同：1
> 
> 时间：2012-05-23T14:02:27.157
> 
> 标签：javascript, html, node.js, socket.io

我正在探索 socket.io 并试图了解客户端和服务器端之间基本交互的细节。有人可以给我下面这个基本 socket.io 程序的具体评论和解释。感谢您的帮助，当然，如果您给我一个好的答案，我会给您打分！

**服务器端**

```
var io = require('socket.io').listen(80);

io.sockets.on('connection', function (socket) {
  socket.emit('news', { hello: 'world' });
  socket.on('my other event', function (data) {
    console.log(data);
  });
}); 
```

**客户端**

```
<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io.connect('http://localhost');
  socket.on('news', function (data) {
    console.log(data);
    socket.emit('my other event', { my: 'data' });
  });
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:20:20.080

服务器端：

第一行首先在端口 80 上绑定 socket.io。

然后为每个连接编写处理程序`io.sockets.on('connection', function (socket) {`。在该处理程序`socket`中包含有关已连接客户端的信息。使用 JSON 对象`socket.emit`向通道上的前端发送实时响应。 正在侦听从该客户端接收到的在“我的其他事件”通道上传输的所有消息。`news``{ hello: 'world' }``socket.on`

客户端：

您首先包含 socket.io JavaScript 源并将客户端连接到 localhost 端口 80 上的 socket.io 服务器。然后客户端侦听在频道“新闻”上广播的消息，然后记录该消息并广播回一条消息将“我的”属性设置为“数据”的对象发送到服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T20:09:44.510

这是我帮助您弄湿脚的最佳方法...

**首先是第一件事..必须设置您的服务器端文件...**

```
var http = require('http');
var app = http.createServer(function(req, res) {
    res.writeHead(200, {'Content-Type': 'text/html'});
    res.end();
});

var io = require('socket.io').listen(app);
io.set('log level', 1); // keep logging to only the essentials
io.set('transports', ['websocket']); // this will only allow clients that support web sockets

io.sockets.on('connection', function(socket) { // when a socket connects and publishes a "connection" message Think of this like pub/sub here.. The connection event happens any time a client connects.
    socket.on('GetSession', function(){
        socket.emit('SessionID', {
            SessionID : socket.id //socket.id = the socket ID that is auto generated. So what we are doing here is when a client connects we will send back to them their session ID. I use this as a simple way to verify that the connection is successful on the client side.
        });
    socket.on('SendMessage', function(msg){ // So here is an example of that pub/sub I am talking about. We are going to publish to anything listening on "CreateRoom" a message.
        socket.emit('Message', msg); // Here we take anyone listening on the message channel and send them whatever was emitted.
    });
});

app.listen(3000); 
```

**接下来让我们看看客户...**

```
var socket = io.connect('http://localhost:3000');
function GetInfo(){
    socket.emit('GetSession', ''); // The client is now initiating the request we setup earlier to get its socket.id from the server.
}
socket.on('SessionID', function(msg) {
    socket.emit('SendMessage', msg + ' Has Connected'); // When the server returns the socket.id the client will emit a message to the server for anyone else who is subscribed to the "message" channel. My terminology for these explanations is not accurate but I think that this way of stating things is a lot easier to wrap your head around...
});
    socket.on('message', function(msg) {
    console.log(msg); // here the client is listening on the "message" channel. Whenever the server sends a message to this channel the client will write the data to the console.
}); 
```

希望这可以帮助你看到。如果您将 socket.io 视为一个发布/订阅应用程序，我认为它很容易上手（起初，因为有更多功能）。

# algorithm - 如何根据深度优先级索引计算完美二叉树中节点的级别？

> ID：10721583
> 
> 赞同：7
> 
> 时间：2012-05-23T14:02:31.203
> 
> 标签：algorithm, binary-tree, depth-first-search

我有一棵完美的二叉树，即树中的每个节点要么是叶节点，要么有两个孩子，并且*所有*叶节点都在同一级别。每个节点都有一个深度优先顺序的索引。

（例如，在具有 3 层的树中，根节点的索引为 0，第一个孩子有 1，第一个孩子的第一个孩子有 2，第一个孩子的第二个孩子有 3，第二个孩子有 4，第一个孩子第二个孩子的有 5，第二个孩子的第二个孩子有索引 6。

```
 0
    /   \
  1      4
 / \    / \
2   3  5   6 
```

)

我知道树的大小（节点数/最大级别），但只知道特定节点的索引，我需要计算它的级别（即它到根节点的距离）。我怎样才能最有效地做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-06-30T20:04:35.083

这是另一个建议，可以更轻松地解决这个问题：

如果以广度优先顺序使用索引标记节点，则无需在 O(1) 时间内进行任何遍历即可计算级别。因此，如果您正在执行多个查询，则可以执行 O(N) BFT 并在 O(1) 时间内回答每个查询。

等级公式为：

```
level = floor(log(index + 1)) 
```

日志以 2 为底

在这棵树上试一试：

```
 0
     /    \
    /      \
   1        2
  / \      / \
 /   \    /   \
3     4  5     6 
```

干杯。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-23T14:19:38.443

让`i`成为您要查找的索引并`n`成为节点总数。

这个算法做你想做的事：

```
level = 0
while i != 0 do
    i--
    n = (n-1)/2
    i = i%n
    level++
done 
```

0 是根的索引，如果`i = 0`那么你处于良好的水平，否则你可以删除根并获得两个子树`n = (n-1)/2`更新节点的数量是新树（它是旧树的子树）并且`i = i%n`只选择好的子树。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T14:13:10.420

似乎直接在树上行走应该足够高效。

在算法的每一步，请记住您所在节点的子树上的索引范围。范围的第一个值是根节点，之后的前半部分是左侧子树的范围，后半部分应该是右子树的范围。然后，您可以递归地向下移动，直到找到您的节点。

例如，让我们在具有 15 个元素的 4 级树中搜索

```
 (root node)(left elements)(right elements)
Starting range:  (0)(1 2 3 4 5 6 7)(8 9 10 11 12 13 14)
Go left       :  (1)(2 3 4)(5 6 7)
Go right      :  (5)(6)(7)
Found node, total depth 2 
```

您应该能够通过一个简单的循环来做到这一点，只使用几个变量来存储范围的开始和结束。如果您进行一些小的更改，例如使用 post/pre/in-order 遍历或从 1 而不是 0 开始索引，您也应该能够轻松地适应这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-23T14:17:20.340

未经测试：

```
int LevelFromIndex( int index, int count)
{
    if (index == 0)
        return 0;
    if (index > (count - 1)/ 2)
        index -= (count - 1) / 2;
    return 1 + LevelFromIndex( index - 1, (count - 1) / 2);
} 
```

这`count`是树中的节点总数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-23T14:15:53.287

如果你只有索引，你就找不到深度。

假设你有一棵这样的树：

```
 1
   / \
  2   5
 / \
3   4 
```

索引为 3 的节点的深度为 2。

假设你有一棵这样的树：

```
 1
 / \
2   3
   / \
  4   5 
```

索引为 3 的节点的深度为 1。

你不能仅仅通过知道它们的索引来区分这两种树。仅通过知道索引就无法找到与根的距离。

编辑：如果你的意思是一个完美的二叉树，所有的叶子都在相同的深度，并且每个父母都有两个孩子，那么你仍然找不到深度。

比较这两棵树：

```
 1
 / \
2   3

      1
   /     \
  2       5
 / \     / \
3   4   6   7 
```

节点 3 的深度根据树的高度而变化。

编辑2：如果你知道总树的高度，你可以使用这个递归算法：

```
def distanceFromRoot(index, rootIndex, treeHeight):
    if index == rootIndex:
        return 0
    leftIndex = rootIndex+1
    rightIndex = rootIndex + 2**treeHeight
    if index >= rightIndex:
        return 1 + distanceFromRoot(index, rightIndex, treeHeight-1)
    else:
        return 1 + distanceFromRoot(index, leftIndex, treeHeight-1) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-23T14:09:47.640

编辑：尝试号 1... 仅适用于 BFS。

如果完美二叉树是指具有堆状结构的二叉树，则可以使用以下公式计算节点的父索引：

```
parentIndex = (index-1)/2 
```

因此，您可以重复该公式，直到达到 <=0，每次循环时，您基本上都会在树中上升一个级别。

编辑：尝试编号 2..

我能想到的最好方法是采用 O(index + log n)，即 O(n)。执行 DFS 直到达到所需的索引，然后使用父指针继续向上树，直到到达根，跟踪你向上的次数。这假设每个节点上都存在一个父指针。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-23T14:41:45.423

所以，我们有这样的树，有 4 个级别：

```
 0             - 0th level
      /       \         
     1          8       - 1th level
   /  \       /  \      
  2    5     9    12    - 2th level
 / \   /\   / \   / \
3   4 6  7 10 11 13 14  - 3th level 
```

如您所见，每个左子节点的根索引都增加了一个（left = root + 1），因为在 DFS 中，左子节点总是首先访问。第二个节点的左节点索引增加了左子树的大小（右=左+左大小）。如果我们知道树的深度，我们可以计算它的大小（大小 = 2^depth - 1）。只要左子树的深度等于父级的深度减一，其大小 = 2^(parentDepth - 1) - 1。

所以现在我们有一个算法——计算左节点的索引，计算右节点的索引。如果节点索引位于它之间，则转到左侧节点，否则 - 转到右侧节点。

代码：

```
static int level(int index, int root, int treeDepth) {
        if (index == root)
            return 0;

        if (treeDepth <= 0 /* no tree */ || treeDepth == 1 /* tree contains only root */)
            throw new Exception("Unable to find node");

        int left = root + 1;
        int right = left + (int)Math.Pow(2, treeDepth - 1) - 1;

        if (index == left || index == right)
            return 1;

        if (left < index && index < right)
            return 1 + level(index, left, treeDepth - 1);
        else
            return 1 + level(index, right, treeDepth - 1);
    } 
```

# jquery - 使用 class 而不是 id 的 keyup 事件

> ID：10721584
> 
> 赞同：4
> 
> 时间：2012-05-23T14:02:45.370
> 
> 标签：jquery, jquery-selectors

如果我有 2 个文本框，但不使用 id，如何确定哪个文本框触发了“keyup”事件？

由于各种原因，我需要使用类而不是 id，其中两个文本框的类名相同。

事实上，我可以在屏幕上多次使用相同的类名来显示相同​​的文本框。

HTML 看起来像这样

```
<div class="outer_div">
   <input type="text" class="mytextbox" />
   <div class="inner_div"></div>
</div>

<div class="outer_div">
   <input type="text" class="mytextbox" />
   <div class="inner_div"></div>
</div>

<div class="outer_div">
   <input type="text" class="mytextbox" />
   <div class="inner_div"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-23T14:07:59.153

```
$('.mytextbox').keyup(function(event){
 // play with event
 // use $(this) to determine which element triggers this event
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:05:38.067

使用与点一起使用的类选择器，例如：

```
$('.foo').keyup(function(){
     $(this).attr('id');
}); 
```

并确定`$(this).attr('id')`在您的事件处理程序中使用哪个文本框来获取当前文本框的 ID。本教程也可以帮助您使用选择器[可以帮助您使用选择器](http://www.tvidesign.co.uk/blog/improve-your-jquery-25-excellent-tips.aspx#tip10)

**更新**

为您的标记调整代码

```
$('input.mytextbox').keyup(function(){
     $(this).attr('id');
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T14:06:24.883

您可以使用 data- 属性来分配一个 id 例如..

```
<input data-id="x" /> 
```

然后做类似的事情。

```
console.log($(this).data('id')); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T14:07:45.397

由于您没有任何 id，因此您可以在 keyup 函数中使用此关键字

```
$('.txtboxClass').keyup(function(event) {
   $(this) <== "This is the current textfield"
}) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-23T14:08:06.973

利用 `$(".<classname>").keyUp(function (){` `$(this).<whatever u do here>` `});`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-23T14:08:38.957

您可以使用 $(this)：

```
<input type="text" class="thisClass" />
<input type="text" class="thisClass" />

$(".thisClass").keyup(function() {
    alert($(this).val());
}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-23T14:09:08.577

您可以使用假装 ID 将其附加到元素上`data()`

```
$('.foo').each(function(i,e) {
    $(e).data('fakeid', 'fakeid'+i);
}); 
```

`keyup`然后在事件中读回来

```
$('.foo').keyup(function(){
    var fakeid = $(this).data('fakeid');
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-01-13T06:11:23.817

你可以试试这个...:)

```
<table class="table_border">
    <tbody class="container-items_items">
        <tr>
        <th width="10%" class="text-right">Cost</th>
        <th width="5%" class="text-right">Quantity</th>
        <th width="10%" class="text-right">Total</th>
        </tr> 
     <tr class="item_items">
      <td class="text-right">
        <input type="text" name="qty" class="cost_text">
      </td>
        <td class="text-right">
          <input type="text" name="qty" class="qty_text">
      </td> 
     <td class="total_cost"></td>
    </tr>          
    </tbody>
</table>

<script type="text/javascript">
    $(document).ready(function()
         {
           $('.cost_text').on('keyup',function(e)
            {
                var cost_value = $(this).val();
                var qty_value = $(this).parents('.item_items').find('.qty_text').val();
                $(this).parents('.item_items').find('.total_cost').html(cost_value*qty_value).prepend('$');
            });

            $('.qty_text').on('keyup',function(e)
            {
                var qty_value = $(this).val();
                var cost_value = $(this).parents('.item_items').find('.cost_text').val();
                $(this).parents('.item_items').find('.total_cost').html(cost_value*qty_value).prepend('$');
            });
        })
</script> 
```

# regex - 在 unix bash 中搜索和替换字符串

> ID：10721585
> 
> 赞同：0
> 
> 时间：2012-05-23T14:02:47.060
> 
> 标签：regex, bash, replace

我对正则表达式不是很好，我需要搜索

`<`任何单词`/>` 并替换为`<anyword></anyword>`

喜欢`<book/>`_`<book></book>`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T14:11:03.973

听起来您正在尝试使用正则表达式解析 XML，这通常是个坏主意 — XML 比最初看起来要复杂得多（当您需要替换时会发生什么`<a b="c"/>`？`<a b="c"></a>`非 ASCII 元素名称呢？）—但如果你确定你所描述的正是你所需要的，那么你可以写：

```
perl -pe 's{<(\w+)/>}{<$1></$1>}g' < input_file > output_file 
```

或者：

```
sed 's|<\([^[:space:]][^[:space:]]*\)/>|<\1></\1>|g' < input_file > output_file 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:54:28.997

利用

```
sed -i 's|<\([[:alpha:]][[:alpha:]]*\)/>|<\1></\1>|g' $input_file 
```

在线更改文件（这就是它的`-i`用途）。小心：这`-i`是一个 GNU 扩展。

要符合 POSIX 并内联编辑文件（在任何 *IX 系统上），请使用以下命令：

```
echo '/<[[:alpha:]][[:alpha:]]*\/>/g\
s/<\([[:alpha:]][[:alpha:]]*\)\/>/<\1><\/\1>/g
wq' | ed $input_file 
```

[请参阅关于sed](http://pubs.opengroup.org/onlinepubs/007904875/utilities/sed.html)、[ed](http://pubs.opengroup.org/onlinepubs/009604499/utilities/ed.html)和[正则表达式](http://pubs.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap09.html)的 POSIX 标准。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:09:21.107

匹配您的标签的正则表达式将是：

```
<(\w+)/> 
```

通过使用捕获组，您可以像这样创建新标签：

```
<\1></\1> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T14:43:49.870

这可能对您有用：

```
echo '<book/>' | sed 's|<\([^/]*\)/>|<\1></\1>|'
<book></book> 
```

# matlab - 用于选择矩阵的连续滚动行的循环

> ID：10721587
> 
> 赞同：0
> 
> 时间：2012-05-23T14:02:47.327
> 
> 标签：matlab, loops, for-loop, matrix

我是 MATLAB 的初学者。我需要创建一个循环，该循环将从矩阵中选择多个滚动连续行并生成一个新矩阵，该矩阵将在列中显示所选行的元素。例如：

一个=

```
 1     2     3
 4     5     6
 7     8     9
10    11    12 
```

loop = 2 ，意思是选择连续2行的滚动，第1行&2行2&3第3&4行，）

预期结果将是以下矩阵： b =

```
 1     4     7
 2     5     8
 3     6     9
 4     7    10
 5     8    11
 6     9    12 
```

所选行的元素应放置在新矩阵的列中。

无论如何我可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T16:25:23.913

这取决于您想要使其具有多通用性。您的问题中有很多不言而喻的假设，而“滚动”是一个模棱两可的术语。对于您的具体情况，对于输入矩阵 A，“循环”= n：

```
function B = rollup(A,n)
B = [];
for i = 1:n
   Btemp = transpose(A(i:i+2,:));
   B = [B;Btemp];
end 
```

请注意，这仅适用于您具有三列的非常具体的情况，并且您不能有 n > l-2 其中 l 是行数。

# facebook - facebook自动发布到用户墙

> ID：10721588
> 
> 赞同：-1
> 
> 时间：2012-05-23T14:02:48.067
> 
> 标签：facebook, facebook-wall

您是否注意到当您访问某些网站时，您访问的任何内容都会自动发布在您的 Facebook 墙上。youtube、myspace、yahoo、socialcam、viddy 等网站都使用了这种脚本或应用程序。

他们是怎么做到的，我也怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:07:05.137

它被称为[Facebook 开放图谱](https://developers.facebook.com/docs/opengraph/)。首先阅读它。您如何完成它取决于您的应用程序的软件堆栈，但大多数平台都有大量可用的库和工具。

# php - 添加超链接和字体大小以在 PHP 中回显

> ID：10721592
> 
> 赞同：-1
> 
> 时间：2012-05-23T14:03:03.137
> 
> 标签：php

我有与标题相呼应的 PHP 代码。我想为其添加一个超链接（例如 www.google.com），并更改其字体大小和字体系列。我该怎么做 ？

```
<?php echo $lang['community_header2'];?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:06:21.283

```
<?php echo '<h1><a href="http://thinkWithYourBrain.com">'. $lang['community_header2'] . '</a></h1>';?> 
```

然后使用 CSS 更改字体大小和字体系列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:06:30.077

```
<a href="<?php echo $url; ?>" class="community_header"><?php echo $lang['community_header2'];?></a> 
```

然后添加你的 CSS 文件：

```
.community_header {
    font-family: XXX;
    font-size: 1.Xem;
} 
```

（将 Xs 替换为您想要的值）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-23T14:11:01.747

```
<?php echo $lang['community_header2'] . '<a href="domain_name" style="font-size:10px; font-family:somefamily">Link</a>';?> 
```

# wpf - 使用 ImageBrush 的网格背景图像

> ID：10721603
> 
> 赞同：6
> 
> 时间：2012-05-23T14:04:06.813
> 
> 标签：wpf, image, xaml, background, imagebrush

我希望`ImageBrush`在 XAML 中使用 将背景应用于`Grid`.

我给了画笔 a`x:Key`并想在我的网格中引用它。

可悲的是，它根本没有将图像作为背景。

```
<Window.Resources>
    <ImageBrush ImageSource="/MAQButtonTest;component/images/bird_text_bg.jpg" x:Key="BackgroundSponge" />
    <Style TargetType="TextBlock">
        <Setter Property="OverridesDefaultStyle" Value="True"/>
    </Style>
    <ControlTemplate TargetType="Button" x:Key="ButtonTemplate">
        <Grid Width="444" ShowGridLines="False" SnapsToDevicePixels="True" Background="{DynamicResource BackgroundSponge}">
            <Grid.RowDefinitions>
                <RowDefinition Height="51" />
                <RowDefinition Height="36" />
            </Grid.RowDefinitions>
            <Grid Grid.Row="0" Background="#286c97">

            </Grid>
            <Grid Grid.Row="1" Background="#5898c0">
                <ContentPresenter Grid.Row="0" />
            </Grid>
        </Grid>
    </ControlTemplate>
</Window.Resources> 
```

我想我可能以错误的方式指代它，我已经尝试过`DynamicResource`并且`StaticResource`.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-23T14:19:35.117

我常用这个。如果图像作为资源添加到项目中，则相对像这样引用它们。

```
<ImageBrush x:Key="play" ImageSource="../Images/Buttons/Play.png" /> 
```

然后引用图像画笔：

```
<Border Background="{StaticResource play}"/> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T14:17:37.797

我总是这样做；

```
<Grid>
   <Grid.Background>
      <ImageBrush ImageSource="/Resources/Images/BG_BlankOptimized.png"/>
   </Grid.Background>
</Grid> 
```

或者，如果使用图像路径通过图像刷资源调用它，更像是保罗建议使用 StaticResource 来调用该样式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T15:10:36.500

在您的主网格中，您有内部子节点，它们覆盖了外部网格的所有可用空间，这就是您无法看到背景的原因。

```
 <Grid Width="444"
          Height="500" 
          Background="{DynamicResource BackgroundSponge}"
          ShowGridLines="False"
          SnapsToDevicePixels="True">
        <Grid.RowDefinitions>
            <RowDefinition Height="51" />
            <RowDefinition Height="36" />
        </Grid.RowDefinitions>
        <Grid Grid.Row="0" Background="#286c97"  Opacity="0.2" Margin="5"/>
        <Grid Grid.Row="1" Background="#5898c0" Opacity="0.2" Margin="5">
            <ContentPresenter Grid.Row="0" />
        </Grid>
    </Grid> 
```

只有宽度还可以，但高度呢？如果您只是使高度变大，那么您的子项目就会显示出来。

或者更好地在内部儿童中留有余量。

边距=“5”

或者让内心的孩子像透明一样

不透明度=“0.2”

# jquery - 循环通过 Json 对象

> ID：10721604
> 
> 赞同：0
> 
> 时间：2012-05-23T14:04:06.860
> 
> 标签：jquery, json

我试图通过在循环结束时进行比较来仅打印“sum”的唯一值，但我看到每次进行比较时它已经移动到下一个元素，因此在比较时这两个值总是相同的。还有另一种方法可以做到这一点吗？

```
 $(document).ready(function(){
    $.getJSON('XML.php', function(data) {
        JSON.stringify(data);
        var prevCardCode = '';

        $.each( data, function(index, element){
            var prevCardCode = element['CardCode'];

            if (!(element['CardCode'] == prevCardCode)) {

                var sum = element['payment_sum'] + '<br/>';
                $('#showdata').append(sum);
                }
                alert(element['CardCode'] + 'compare' + prevCardCode);
        });

    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:11:32.227

您需要将`prevCharCode`分配移动到循环的末尾并删除`var`它前面的：

```
var prevCardCode = '';
$.each( data, function(index, element) {
    if (!(element['CardCode'] == prevCardCode)) {
        // your code...
    }

    prevCardCode = element['CardCode'];
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:11:54.860

在这种`var`情况下，关键字不属于 each ，您需要在比较之后将其移动到。

```
var prevCardCode = '';
$.each(data, function(index, element) {
    if (!(element['CardCode'] == prevCardCode)) {
        var sum = element['payment_sum'] + '<br/>';
        $('#showdata').append(sum);
    }
    alert(element['CardCode'] + 'compare' + prevCardCode);
    prevCardCode = element['CardCode'];
});​ 
```

如果`var`之前保留了`prevCardCode`，它将永远不会设置在 之外定义的那个`$.each`，并且不会延续到 的下一次迭代`$.each`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:10:12.813

`prevCardCode`不是先例元素，而是当前元素...然后将当前元素与当前元素进行比较...

如果你想比较先例元素和当前元素，你应该使用 while 或 do while。

```
var i = 1;
var precedentEl = array[0];

while (i < array.length) {

   // Do some stuff like compare current and precedent

   precedentEl = array[i];
   i++;
} 
```

其次，你调用`XML.php`which return json ......听起来很奇怪......

# jquery - 如何显示活动和非活动子菜单

> ID：10721608
> 
> 赞同：0
> 
> 时间：2012-05-23T14:04:18.337
> 
> 标签：jquery, jquery-ui, jquery-selectors

嘿，我是 jquery 的新手，我试图在单击菜单后显示子菜单。-例如，当我选择顶部菜单时，它会显示其所有子菜单。但是当我单击其中一个子菜单时，其他子菜单就会消失。例如，我点击“家具”，它打开了两个子菜单，即“Deko”和“Fancy”。当我点击“Deko”时，其他子菜单消失，只显示 deko 的内容

如何解决这个问题。请帮助这是我的代码

```
 <ul id="application-menu">
      <li class="dropdown">Furniture
        <ul>
          <li><a href="" />Deko</li>
          <li><a href="" />Fancy</li>
        </ul>
      </li>

      <li class="dropdown">Tables
        <ul>
          <li><a href="" />Table1</li>
          <li><a href="" />Table2</li>

      </li>
    </ul>

<style type="text/css">

  li.dropdown ul
  {
    display: none;
  }

</style>

<script type="text/javascript">
    $('li.dropdown').click(function ()
    {
      $('li.dropdown').find('ul').hide();
      $(this).find('ul').show();
    });

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:18:34.947

您将需要获取与您单击的元素类似的所有 li 元素，但不包括当前单击的元素，并将它们隐藏。

```
$(".dropdown a").not(this).hide(); 
```

我在 JsFiddle 中创建了一个片段，请检查一下，如果这是您想要的，请告诉我：

[http://jsfiddle.net/V45Ux/](http://jsfiddle.net/V45Ux/)

# r - 基准 data.frame (base), data.frame(package dataframe) 和 data.table

> ID：10721615
> 
> 赞同：2
> 
> 时间：2012-05-23T14:04:31.987
> 
> 标签：r, benchmarking, dataframe, data.table

随着最近推出的包`dataframe`，我认为是时候正确地对各种数据结构进行基准测试并突出每种数据结构的优势了。我不是每个人的不同优势的专家，所以我的问题是，我们应该如何对它们进行基准测试。

我尝试过的一些（相当粗糙的）事情：

```
library(microbenchmark)
library(data.table)
mat <- matrix(rnorm(10000), nrow = 100)
mat2df.base <- data.frame(mat)
library(dataframe)
mat2df.dataframe <- data.frame(mat)
mat2dt <- data.table(mat)
bm <- microbenchmark(t(mat), t(mat2df.base), t(mat2df.dataframe), t(mat2dt), times = 1000) 
```

结果：

```
Unit: microseconds
                 expr      min       lq   median       uq       max
1              t(mat)   20.927   23.210   31.201   36.908   951.591
2      t(mat2df.base)  929.903  974.039  997.439 1040.814 28270.717
3 t(mat2df.dataframe)  924.957  969.093  992.683 1025.404 27255.205
4           t(mat2dt) 1749.465 1817.382 1857.903 1909.649  5347.321 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T14:14:56.827

我不是 data.table 专家，但据我了解，它的主要优势在于索引。因此，请尝试使用各种包进行子集化以比较速度。

```
library(microbenchmark)
library(data.table)
mat <- matrix(rnorm(1e7), ncol = 10) 
key <- as.character(sample(1:10,1e6,replace=TRUE))
mat2df.base <- data.frame(mat)
mat2df.base$key <- key

bm.before <- microbenchmark( 
  mat2df.base[mat2df.base$key==2,] 
)

library(dataframe)
mat2df.dataframe <- data.frame(mat)
mat2df.dataframe$key <- key
mat2dt <- data.table(mat)
mat2dt$key <- key
setkey(mat2dt,key)

bm.subset <- microbenchmark( 
  mat2df.base[mat2df.base$key==2,], 
  mat2df.dataframe[mat2df.dataframe$key==2,],
  mat2dt["2",]
  )

                                       expr       min        lq    median   

    uq       max
1           mat2df.base[mat2df.base$key == 2, ] 153.99596 154.98602 155.91621 157.0894 194.24456
2 mat2df.dataframe[mat2df.dataframe$key == 2, ] 153.63907 154.66295 155.68553 156.9827 173.76913
3                                 mat2dt["2", ]  15.51085  15.66742  15.72899  15.8463  22.53044 
```

如果矩阵足够大， data.table 会使用其他选项擦除表格。

*另外，我怀疑@RJ- 尝试将 base data.frame 的性能与 package`dataframe`的 data.frames 的性能进行比较是行不通的。性能太相似了，我怀疑结果是加载的库而不是基础库的结果。*

**编辑：**经过测试。似乎没有太大区别。bm.after 与上面的 bm.subset 代码相同，只需与 bm.before 同时运行即可提供准确的比较。

```
bm.before <- microbenchmark( 
  mat2df.base[mat2df.base$key==2,] 
)

> bm.after
Unit: milliseconds
                                           expr       min        lq    median        uq       max
1           mat2df.base[mat2df.base$key == 2, ] 160.62708 166.25787 167.52325 169.18710 173.47864
2 mat2df.dataframe[mat2df.dataframe$key == 2, ] 163.30259 166.00588 167.80138 169.24647 174.05713
3                                 mat2dt["2", ]  16.16117  16.89627  17.09047  17.37057  62.01954

> bm.before
Unit: milliseconds
                                 expr     min       lq   median       uq      max
1 mat2df.base[mat2df.base$key == 2, ] 159.178 160.9867 162.1149 164.0046 195.9501 
```

# drupal-7 - 如何在 Drupal 7 中使用“Masked Input”模块

> ID：10721616
> 
> 赞同：0
> 
> 时间：2012-05-23T14:04:33.117
> 
> 标签：drupal-7, maskedinput

我正在尝试在**Drupal 7中构建一个****表单**，其中一个字段需要有一个**输入掩码**。我发现插件[屏蔽输入](http://drupal.org/project/masked_input)看起来就像我正在搜索的内容。只有没有关于如何实现它的文档（我读过有关货币和这个插件的信息，但这里只是关于让它工作）。

 ****我是 Drupal 的新手，但在论坛上搜索我想出了以下代码：

```
function report_expenses_form($form, &$form_submit) {
  libraries_get_path('maskedinput') . '/misc/ui/jquery.maskedinput-1.3.js';
...
     $form['cash_advance']['amount'] = array(
        '#title' => t('Cash Advance : '),
        '#type' => 'textfield',
        '#default_value' => t('$ 00,00'),
        '#required' => TRUE,
        '#mask' => '$?999.999.999,99',
      );
.... 
```

我在 Drupal 中安装了“库”和“屏蔽输入”插件并刷新了我的缓存。

我下载了[jquery.maskedinput-1.3.js](http://digitalbush.com/projects/masked-input-plugin/)并将其放入我的 {DRUPAL_HOME}/misc/ui/

有任何想法吗？

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-19T16:46:28.127

这有点令人困惑。这是您需要做的：

1.  [从这里](http://digitalbush.com/projects/masked-input-plugin/)下载文件
2.  在您的站点/所有/库文件夹中，创建一个名为“masked_input”的文件夹
3.  将文件上传到您的 sites/all/libraries/masked_input 文件夹
4.  将文件重命名为 jquery.maskedinput-1.3.js 或 jquery.maskedinput-1.3.min.js，以便文件的最终路径是 {DRUPAL HOME}/sites/all/libraries/masked_input/jquery.maskedinput-1.3。 js 或 {DRUPAL HOME}/sites/all/libraries/masked_input/jquery.maskedinput-1.3.min.js
5.  现在您可以启用该模块。
6.  利润！

注意：这是一种临时解决方法，不需要您修补模块或更改任何代码。需要修复模块以解决[此处记录的这些问题](http://drupal.org/node/1772580)

注意 2：安装后，您可能需要将 {DRUPAL HOME}/sites/all/libraries/masked_input 重命名为 {DRUPAL HOME}/sites/all/libraries/maskedinput 以使其加载和工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-13T15:30:44.387

[肖恩的](https://stackoverflow.com/questions/10721616/how-to-use-the-masked-input-module-in-drupal-7/14962872#14962872)方法只对我使用旧版本 1.3.1 的屏蔽输入有效，两周后几乎放弃了：

[https://github.com/digitalBush/jquery.maskedinput/releases](https://github.com/digitalBush/jquery.maskedinput/releases)

下载包，解压，然后：

```
cp jquery.maskedinput-1.3.1/dist/jquery.maskedinput.js {DRUPAL HOME}/sites/all/libraries/masked_input/jquery.maskedinput.1-3.js
cp jquery.maskedinput-1.3.1/dist/jquery.maskedinput.min.js {DRUPAL HOME}/sites/all/libraries/masked_input/jquery.maskedinput.1-3.min.js 
```

制作另一个副本，作为 maskedinput：

```
cd {DRUPAL HOME}/sites/all/libraries/
cp -a masked_input maskedinput 
```

安装库模块，安装 masked_input 就是这样。现在你可以使用它了。也许 masked_input 需要对 jquery 库 1.4 的兼容性进行一些更新，我不是 Jquery 专家，只是一个想法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-13T15:58:03.713

上面代码的问题是字段类型。它应该是：

`'#type' => 'masked_input',`代替`'#type' => 'textfield',`

模块文档显示了这一点，但我两天没有注意到它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T15:53:22.977

> 我下载了 jquery.maskedinput-1.3.js 并将其放入我的 {DRUPAL_HOME}/misc/ui/

这是系统 Drupal 路径，您无需更改其内容。
在 Drupal 库中是存储在特殊库文件夹中的外部脚本。在你的情况下`sites/all/libraries`。
所以文件`jquery.maskedinput-1.3.js`应该在`sites/all/libraries/maskedinput`文件夹中。****

# php - PHP对象数组不是线性缩放而全局数组吗？

> ID：10721618
> 
> 赞同：9
> 
> 时间：2012-05-23T14:04:35.093
> 
> 标签：php, scalability

使用对象内数组作为属性与使用全局 php 数组变量相比，存在一个主要的性能问题，为什么？

为了对这个问题进行基准测试，我创建了以下基准测试，该基准测试以 stdClass 作为节点存储越来越大的数组，运行两个测试，一个使用类中的数组属性，另一个使用全局数组。

测试代码

```
ini_set('memory_limit', '2250M');
class MyTest {
    public $storage = [];
    public function push(){
        $this->storage[] = [new stdClass()];
    }
}

echo "Testing Objects".PHP_EOL;
for($size = 1000; $size < 5000000; $size *= 2) {
    $start = milliseconds();
    for ($a=new MyTest(), $i=0;$i<$size;$i++) {
        $a->push();
    }
    $end = milliseconds();
    echo "Array Size $size".PHP_EOL;
    echo $end - $start . " milliseconds to perform".PHP_EOL;
}
echo "================".PHP_EOL;
echo "Testing Array".PHP_EOL;
for($size = 1000; $size < 5000000; $size *= 2) {
    $start = milliseconds();
    for ($a=[], $i=0;$i<$size;$i++) {
        $a[] = [new stdClass()];
    }
    $end = milliseconds();
    echo "Array Size $size".PHP_EOL;
    echo $end - $start . " milliseconds to perform".PHP_EOL;
} 
```

以及令人震惊的结果：

```
Testing Objects
Array Size 1000
2 milliseconds to perform
Array Size 2000
3 milliseconds to perform
Array Size 4000
6 milliseconds to perform
Array Size 8000
12 milliseconds to perform
Array Size 16000
35 milliseconds to perform
Array Size 32000
97 milliseconds to perform
Array Size 64000
246 milliseconds to perform
Array Size 128000
677 milliseconds to perform
Array Size 256000
2271 milliseconds to perform
Array Size 512000
9244 milliseconds to perform
Array Size 1024000
31186 milliseconds to perform
Array Size 2048000
116123 milliseconds to perform
Array Size 4096000
495588 milliseconds to perform
================
Testing Array
Array Size 1000
1 milliseconds to perform
Array Size 2000
2 milliseconds to perform
Array Size 4000
4 milliseconds to perform
Array Size 8000
8 milliseconds to perform
Array Size 16000
28 milliseconds to perform
Array Size 32000
61 milliseconds to perform
Array Size 64000
114 milliseconds to perform
Array Size 128000
245 milliseconds to perform
Array Size 256000
494 milliseconds to perform
Array Size 512000
970 milliseconds to perform
Array Size 1024000
2003 milliseconds to perform
Array Size 2048000
4241 milliseconds to perform
Array Size 4096000
14260 milliseconds to perform 
```

现在，除了对象调用自身的明显开销之外，当数组变大时，对象数组属性的缩放有时会花费 3 到 4 倍的时间，但标准全局数组变量并非如此。

关于这个问题的任何想法或答案，这是否可能是 PHP 引擎的错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-29T20:31:50.147

我在 PHP 5.3.9 上测试了您的代码。为此，我必须转换`[]`为`array()`，并且我还必须更正您的第 12 行：从`$a=new MyTest($size)`，到`$mytest=new MyTest($size)`（顺便说一句，构造函数参数被默默地忽略，有趣）。我还添加了这段代码：

```
echo "================".PHP_EOL;
echo "Testing Function".PHP_EOL;
for($size = 1000; $size < 1000000; $size *= 2) {
    $start = milliseconds();
    for ($a=array(), $i=0;$i<$size;$i++) {
        my_push($a);
    }
    $end = milliseconds();
    echo "Array Size $size".PHP_EOL;
    echo $end - $start . " milliseconds to perform".PHP_EOL;
    echo "memory usage: ".memory_get_usage()." , real: ".memory_get_usage(true).PHP_EOL;
}

function my_push(&$a)
{
   $a[] = array(new stdClass());
} 
```

我在同一点将内存使用行添加到您的循环中，`unset($mytest);`在对象案例之后添加了一个（以获得更一致的内存日志），并且还用 1000000 替换了您的 5000000，因为我只有 2GB 的 RAM。这就是我得到的：

```
Testing Objects
Array Size 1000
2 milliseconds to perform
memory usage: 1666376 , real: 1835008
Array Size 2000
5 milliseconds to perform
memory usage: 2063280 , real: 2097152
Array Size 4000
10 milliseconds to perform
memory usage: 2857008 , real: 2883584
Array Size 8000
19 milliseconds to perform
memory usage: 4444456 , real: 4718592
Array Size 16000
44 milliseconds to perform
memory usage: 7619392 , real: 8126464
Array Size 32000
103 milliseconds to perform
memory usage: 13969256 , real: 14417920
Array Size 64000
239 milliseconds to perform
memory usage: 26668936 , real: 27262976
Array Size 128000
588 milliseconds to perform
memory usage: 52068368 , real: 52690944
Array Size 256000
1714 milliseconds to perform
memory usage: 102867104 , real: 103546880
Array Size 512000
5452 milliseconds to perform
memory usage: 204464624 , real: 205258752
================
Testing Array
Array Size 1000
1 milliseconds to perform
memory usage: 18410640 , real: 20709376
Array Size 2000
4 milliseconds to perform
memory usage: 18774760 , real: 20709376
Array Size 4000
7 milliseconds to perform
memory usage: 19502976 , real: 20709376
Array Size 8000
13 milliseconds to perform
memory usage: 20959360 , real: 21233664
Array Size 16000
29 milliseconds to perform
memory usage: 23872176 , real: 24379392
Array Size 32000
61 milliseconds to perform
memory usage: 29697720 , real: 30146560
Array Size 64000
124 milliseconds to perform
memory usage: 41348856 , real: 41943040
Array Size 128000
280 milliseconds to perform
memory usage: 64651088 , real: 65273856
Array Size 256000
534 milliseconds to perform
memory usage: 111255536 , real: 111935488
Array Size 512000
1085 milliseconds to perform
memory usage: 204464464 , real: 205258752
================
Testing Function
Array Size 1000
357 milliseconds to perform
memory usage: 18410696 , real: 22544384
Array Size 2000
4 milliseconds to perform
memory usage: 18774768 , real: 22544384
Array Size 4000
9 milliseconds to perform
memory usage: 19503008 , real: 22544384
Array Size 8000
17 milliseconds to perform
memory usage: 20959392 , real: 22544384
Array Size 16000
36 milliseconds to perform
memory usage: 23872208 , real: 24379392
Array Size 32000
89 milliseconds to perform
memory usage: 29697720 , real: 30146560
Array Size 64000
224 milliseconds to perform
memory usage: 41348888 , real: 41943040
Array Size 128000
529 milliseconds to perform
memory usage: 64651088 , real: 65273856
Array Size 256000
1587 milliseconds to perform
memory usage: 111255616 , real: 111935488
Array Size 512000
5244 milliseconds to perform
memory usage: 204464512 , real: 205258752 
```

如您所见，在函数调用中附加到数组的成本几乎与在原始方法调用中执行它一样多（并且具有相同的非线性行为）。可以肯定地说一件事：

**是函数调用占用了 CPU 时间！**

关于非线性行为，只有在某个阈值以上才会变得非常明显。虽然所有三种情况都具有相同的内存行为（由于不完整的 gargabe 收集，这仅在本日志中的“普通数组”和“函数内部数组”情况下很明显），它是“方法内部数组”和“函数内的数组”具有相同执行时间行为的情况。这意味着函数调用本身会导致时间的非线性增加。在我看来，可以这样说：

**函数调用期间周围的数据量会影响其持续时间。**

为了验证这一点，我将所有 1000000 替换`$a[]`为`$a[0]`5000000（以获得相似的总执行时间）并获得以下输出：

```
Testing Objects
Array Size 1000
2 milliseconds to perform
memory usage: 1302672 , real: 1572864
Array Size 2000
4 milliseconds to perform
memory usage: 1302672 , real: 1572864
Array Size 4000
8 milliseconds to perform
memory usage: 1302672 , real: 1572864
Array Size 8000
15 milliseconds to perform
memory usage: 1302672 , real: 1572864
Array Size 16000
31 milliseconds to perform
memory usage: 1302672 , real: 1572864
Array Size 32000
62 milliseconds to perform
memory usage: 1302672 , real: 1572864
Array Size 64000
123 milliseconds to perform
memory usage: 1302672 , real: 1572864
Array Size 128000
246 milliseconds to perform
memory usage: 1302672 , real: 1572864
Array Size 256000
493 milliseconds to perform
memory usage: 1302672 , real: 1572864
Array Size 512000
985 milliseconds to perform
memory usage: 1302672 , real: 1572864
Array Size 1024000
1978 milliseconds to perform
memory usage: 1302672 , real: 1572864
Array Size 2048000
3965 milliseconds to perform
memory usage: 1302672 , real: 1572864
Array Size 4096000
7905 milliseconds to perform
memory usage: 1302672 , real: 1572864
================
Testing Array
Array Size 1000
1 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 2000
3 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 4000
5 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 8000
10 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 16000
20 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 32000
40 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 64000
80 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 128000
161 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 256000
322 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 512000
646 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 1024000
1285 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 2048000
2574 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 4096000
5142 milliseconds to perform
memory usage: 1302464 , real: 1572864
================
Testing Function
Array Size 1000
1 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 2000
4 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 4000
6 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 8000
14 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 16000
26 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 32000
53 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 64000
105 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 128000
212 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 256000
422 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 512000
844 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 1024000
1688 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 2048000
3377 milliseconds to perform
memory usage: 1302464 , real: 1572864
Array Size 4096000
6814 milliseconds to perform
memory usage: 1302464 , real: 1572864 
```

请注意，现在时间几乎是完全线性的。当然，数组大小现在固定为 1。另请注意，这三种情况的执行时间差异如何不如以前那么明显。请记住，最里面的操作在所有情况下都是相同的。

我不打算尝试完全解释所有这些（函数调用上的垃圾收集？内存碎片？...？），但我认为我仍然收集了一些有用的信息，对这里的每个人和我自己也是如此。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-28T18:31:27.113

我不能在评论中发布这一切，所以**这更像是一个观察而不是一个答案。**看起来 SplObjectStorage 相当慢。此外，array_push 比 $array[] = 'item'; 快得多。

免责声明：为草率的代码道歉:)

```
<?php

$time = microtime();
$time = explode(' ', $time);
$time = $time[1] + $time[0];
$start = $time;

$iteration = 10000;

switch ($_REQUEST['test'])
{
    case 1:
        $s = new SplObjectStorage();

        for ($i = 0; $i < $iteration; $i++) {
            $obj = new stdClass;
            $s[$obj] = 'test';
        }
        break;
    case 2:

        $s = array();
        for ($i = 0; $i < $iteration; $i++) {
            $obj = new stdClass;
            $s[$i] = $obj;
        }
        break;

    case 3:
        class Test {
            public $data = array();
        }
        $s = new Test;
        for ($i = 0; $i < $iteration; $i++) {
            $obj = new stdClass;
            $s->data[] = $obj;
        }
        break;

    case 4:
        class Test {
            public static $data = array();
        }
        $s = new Test;
        for ($i = 0; $i < $iteration; $i++) {
            $obj = new stdClass;
            $s->data[] = $obj;
        }
        break;  
    case 5:
        class Test {
            public $data = array();
        }
        $s = new Test;
        for ($i = 0; $i < $iteration; $i++) {
            $obj = new stdClass;
            array_push($s->data, $obj);
        }
        break;  
    default:
        echo 'Type in ?test=#';
}

$time = microtime();
$time = explode(' ', $time);
$time = $time[1] + $time[0];
$finish = $time;
$total_time = round(($finish - $start), 6);
echo 'Page generated in '.$total_time.' seconds.'; 
```

# css - 左右浮动div，左div需要100%，右保持右固定大小

> ID：10721619
> 
> 赞同：0
> 
> 时间：2012-05-23T14:04:35.403
> 
> 标签：css, html

我想对左 div 为 100% 且右保持固定的 div 产生影响

```
<!DOCTYPE html>
<html>
<style>
.left {
width: 100%;
float: left;
border: #ccc solid 1px;
}
.right {
width: 50px;
float:left;
border: #987 solid 1px;
}
.main {
border: #666 solid 1px;
margin: 0px auto;
}
.clear {
clear:both;
}

</style>
<body>
<div class="main">
<div class="left">
</div>
<div class="right">
</div>
<div class="clear"></div>
</div>
</body>
</html> 
```

我知道我可以使用 table 来轻松实现这一点，但是如何使用 div 实现这一点

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:09:09.173

你的意思是这个？： http: [//jsfiddle.net/JPPaf/](http://jsfiddle.net/JPPaf/)

如果您要使用边框，请在其中嵌套另一个 div 并将边框应用于该内部 div，因为它会为您节省很多问题。

```
<!DOCTYPE html>
<html>
<style>
.left {
margin-right:50px;
background:red;
}
.right {
width:50px;
float:right;
background:green;
}
.main {
border: #666 solid 1px;
margin: 0px auto;
}
.clear {
clear:both;
}

</style>
<body>
<div class="main">
<div class="right">
right
</div>
<div class="left">
left
</div>
<div class="clear"></div>
</div>
</body>
</html> 
```

# git - Xcode 4.3.2 使用 git 的问题

> ID：10721622
> 
> 赞同：1
> 
> 时间：2012-05-23T14:04:50.687
> 
> 标签：git, version-control, xcode4.3

你好 Stackoverflow 研究员，

自从我安装了 Xcode 4.3.2 以来，我在使用 git 时遇到了很多问题。File->Source Controls 命令不能正常工作，但如果我在控制台上使用 git，那么一切都会正常工作。

所以我决定不为我的新项目检查“为这个项目创建本地 go 存储库”。令我惊讶的是，Xcode 在以下情况下开始抱怨：

*   我尝试删除带有消息“致命：不是 git 存储库（或任何父目录）：.git”的文件
*   我尝试使用消息“致命：不是 git 存储库（或任何父目录）：.git”重命名文件
*   我尝试使用消息“无法将 Class.m 重命名为 Cl.m”来重构-> 重命名一个类

有人知道我在做什么错吗？

先谢谢了，

瞪羚

# shell - echo >> 样式附加，但附加到文件的开头

> ID：10721623
> 
> 赞同：8
> 
> 时间：2012-05-23T14:04:50.590
> 
> 标签：shell, unix

在 UNIX shell 中有什么技巧可以将行附加到文件的开头吗？例如类似于

```
 echo "Foobar" >> file.txt 
```

...但是新行会在现有行之前添加？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-23T14:08:57.047

分两步：

```
content=$(cat file.txt) # no cat abuse this time
echo -en "foobar\n$content" >file.txt 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-23T14:17:02.973

这是非标准的，但如果你的 sed 支持 -i 你可以这样做：

```
sed -i '1i\
Foobar' file.txt 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T14:40:23.073

我会保持简单。最简单且可能最快的解决方案很简单：

```
(echo "Foobar"; cat file.txt) >tmpfile
cp tmpfile file.txt
rm tmpfile 
```

如果 file.txt 的 inode 更改无关紧要，请将“cp”替换为“mv”。比这快得多的解决方案是不可能的，因为 Unix 文件系统语义不支持附加到文件，只支持附加。

# git - github 更改未上演提交

> ID：10721624
> 
> 赞同：60
> 
> 时间：2012-05-23T14:04:50.857
> 
> 标签：git, github

我有一个非常基本的 github 设置，其中包含一个自述文件、一个目录和另一个目录，其中包含一个 html 文件。在 github 上，我只能查看自述文件和第一个文件夹，但看不到它的内容，我收到了这条消息

```
tc349 ryntc3$ git add *
tc349 ryntc3$ git status
On branch master
Changes not staged for commit:
(use "git add <file>..." to update what will be committed)
(use "git checkout -- <file>..." to discard changes in working directory)
(commit or discard the untracked or modified content in submodules) 

modified:   week1 (modified content)

no changes added to commit (use "git add" and/or "git commit -a") 
```

我觉得如果我要添加所有要上演的内容，那应该不是问题。有什么帮助吗？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-05-23T14:24:11.557

你有没有尝试过

```
git add . 
```

这会递归到子目录中，而我认为 * 不会。

看[这里](http://gitref.org/basic/)

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-11-08T09:56:43.303

**警告！**这将删除您的子模块的整个 Git 历史记录。仅当您意外创建子模块时才这样做。在大多数情况下，当然不是您想要做的。

我认为您必须进入**week1**文件夹并删除**.git**文件夹：

```
sudo rm -Rf .git 
```

然后返回顶级文件夹并执行：

```
git add . 
```

然后提交并推送代码。

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2015-11-19T06:47:55.933

就我而言，我需要一个

```
 git add files
 git commit -am 'what I changed'
 git push 
```

需要提交上的“a”。

* * *

## 回答 #4

> 赞同：29
> 
> 时间：2012-06-10T22:03:53.307

是`week1`子模块吗？

请注意命令输出中的相关部分`git status`：

> （提交或丢弃子模块中未跟踪或修改的内容）

尝试`cd week1`发出另一个以查看您对子模块`git status`所做的更改。`week1`

有关子模块如何在 Git 中工作的更多信息，请参阅[http://git-scm.com/book/en/Git-Tools-Submodules 。](http://git-scm.com/book/en/Git-Tools-Submodules)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2016-11-29T04:28:10.897

**警告！**这将删除您的子模块的整个 Git 历史记录。仅当您意外创建子模块时才这样做。在大多数情况下，当然不是您想要做的。

在我的情况下，有一个子目录有一个`.git`目录。

我所做的只是`.git`从我的子目录中删除该目录。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-03-24T15:13:46.130

我遇到了同样的问题。我最终进入了“未准备提交”的子目录，并从那里添加、提交和推送。之后，上一级到主目录并能够正确推送。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-08-29T18:13:18.987

就我而言，问题是我要推送的子文件夹是 git 文件夹本身

所以我做了以下

1.  进入您要推送的子文件夹并运行：

```
rm -rf .git 
```

2.  然后运行这个：

```
 git rm --cached <subfolderName> 
```

3.  然后来到主项目文件夹并运行它（确保在文件夹名称后添加/）

```
 git add <folderName>/
    git commit -m "Commit message"
    git push -f origin <branchName> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-01-14T03:39:15.057

对我来说，我必须提交其中的子目录，`.git`因为父文件夹和子文件夹都有遥控器可以推送到。然后提交并推送父目录。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-04-03T01:21:17.403

此命令可能会解决问题：

**git添加-A**

所有文件和子目录都将被添加以进行跟踪。

希望能帮助到你

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2019-08-16T09:27:40.250

如果它是一个子模块，您需要 cd 进入它，然后使用`git add . && git commit -m 'Your message'`

从那里你可以 cd 出来并推送到你想要的任何分支。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-11-19T18:41:41.373

无论我做什么，我都会收到相同的消息。

为了解决这个问题，我删除了 .gitignore 并且我没有得到 Github 更改不再为提交消息暂存。在我运行 git add 时它允许我提交一次之前。然后它会带来同样的信息。

我不确定为什么 .gitignore 文件会导致问题，但我在本地机器上添加了并且很可能没有正确同步它。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-10-14T07:33:36.003

相信这是因为您有一个子存储库“子模块”，其中包含尚未暂存和提交的更改。

有一个类似的问题，我的 IDE 一直报告未提交的更改，并且运行 stage ( `git add .`) 和 commit ( `git commit -m "message"`) 命令没有效果。事后想想，这可能是因为子存储库有需要暂存和提交的更改，而不是父存储库。

### 解决问题的步骤

1.  `cd`进入子模块（有一个名为 的隐藏文件夹`.git`）并执行命令以暂存（`git add .`）和提交（`git commit -m "Update child repo"`）
2.  `cd ..`回到父仓库，执行命令stage( `git add .`)和commit( `git commit -m "Update parent repo"`)

### 没有帮助的建议

*   `sudo rm -Rf .git`== 不要使用此命令 == 它会永久删除子模块存储库历史记录（GIT 的目的）
*   `git add -A`=== 添加了未跟踪的文件，但没有解决问题

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-01-09T23:32:58.887

我尝试了整个 Stackoverflow 上的所有建议。没有任何东西，包括 -a 或 -am 或任何帮助。

如果您也一样，请执行此操作。

所以，问题是，git 认为你的一些子目录是你根项目中的子项目。至少，就我而言，它不是那样的。它只是普通的子目录。不是个别项目。

移动未在某个临时位置推送的常规子目录。

从该目录中删除隐藏的 .git 文件夹。

`cd`到根目录。

`git init`再次。

`git add .`再次。

`git commit -m "removed notPushableDirectory temporarily"`

`git push -f origin master`

我们将不得不强制它，因为 git 会看到远程 git 和您的本地结构之间的冲突。请记住，我们制造了这个冲突。所以，不要担心强迫它。

现在，它将将该子目录作为子目录推送，而不是作为根项目中的子模块或子项目。

# c# - 以编程方式检查 Http 命名空间预留

> ID：10721628
> 
> 赞同：3
> 
> 时间：2012-05-23T14:05:01.313
> 
> 标签：c#, wcf, http, namespaces

我的任务是编写一个程序，该程序将在我们的主应用程序上运行一组诊断测试。一个应用程序使用 WCF over HTTP（这是出于互操作性的原因，因此不能更改为使用 NET.TCp 或任何其他风格的 WCF 通信通道），并且由于它不应在提升的权限下运行，因此需要进行 HTTP 命名空间保留（[https://docs.microsoft.com/en-us/dotnet/framework/wcf/feature-details/configuring-http-and-https](https://docs.microsoft.com/en-us/dotnet/framework/wcf/feature-details/configuring-http-and-https)）。

我的问题是 - 是否有可能以编程方式确定命名空间保留是否以与操作系统无关的方式进行（使用 C#/.NET 3.5 或 4）？我能想到的唯一方法是创建一个小型 WCF 应用程序，该应用程序将尝试通过我感兴趣的 http 通道进行通信并捕获异常......但这似乎是解决我的问题的一种非常不优雅的方式.

我希望能够找到的原因是许多客户“忘记”进行预订，因此它一直在产生呼叫 - 诊断程序旨在检查众所周知的问题，例如这个问题并显示一个友好的警告，因为在客户端站点上调试 WCF 并不是我的乐趣所在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-02T20:07:49.260

AFAIK 除非您调用服务，否则没有编程方式可以发现它。ACL 设置在服务器端的系统级别。服务器不共享那种信息。您将能够知道是否授予访问权限的唯一答案。

# sql-server - NHibernate 使用 fetch 选择带有条件的前 N 个子项

> ID：10721633
> 
> 赞同：3
> 
> 时间：2012-05-23T14:05:16.187
> 
> 标签：sql-server, linq, nhibernate, one-to-many, top-n

我有简单的用户实体：

```
public class User
{
    public virtual int Id { get; set; }
    public virtual DateTime CreationDate { get; set; }
    public virtual DateTime ModifiedDate { get; set; }

    public virtual string Email { get; set; }
    public virtual string Name { get; set; }

    public virtual IList<Phone> Phones { get; set; }
}

public class Phone
{
    public virtual string CountryCode { get; set; }
    public virtual string Code { get; set; }
    public virtual string Number { get; set; }
    public virtual string Comment { get; set; }
} 
```

我的映射定义如下：

```
public class UserMap : ClassMap<User>
{
    public UserMap ()
    {
        this.Table ("Users");

        this.Id (x => x.Id).CustomSqlType ("bigint").GeneratedBy.HiLo ("1000");
        this.Map (x => x.CreationDate);
        this.Map (x => x.ModifiedDate).Column ("LastUpdatedDate");
        this.Map (x => x.Email).Length (255).Not.Nullable ().Unique ();
        this.Map (x => x.Name).Column ("UserName").Length (255);

        this.HasMany (x => x.Phones).Inverse ();
    }
}

public class PhoneMap : ClassMap<Phone>
{
    public PhoneMap ()
    {
        this.Table ("Phones");

        this.Id ().GeneratedBy.Identity ();
        this.Map (x => x.CountryCode).Length (5);
        this.Map (x => x.Code).Length (10);
        this.Map (x => x.Number).Length (50).Not.Nullable ();
        this.Map (x => x.Comment).Length (255);
    }
} 
```

此处的其他约定：

```
PrimaryKey.Name.Is (x => "Id"),
ForeignKey.EndsWith ("Id"),
DefaultAccess.Property (),
DefaultCascade.All () 
```

**我需要选择前 100 名使用电话且名称以“A”开头的用户。但我需要在其中加载带有电话的用户对象。**

所以我做这个查询：

```
var users =
(
    from user in session.Query<User> ()
    where
        user.Name.StartsWith ("a")
        &&
        user.Phones.Any ()
    select user
)
    .Fetch (x => x.Phones)
    .Take (100)
    .ToArray (); 
```

而我只有 72 个用户。

为什么？好吧，因为 NHibernate 使用左外连接生成单个 TOP N 选择，并且 SQL 返回同一用户实体的多条记录，因为某些用户确实拥有不止一部手机。但这都是针对 TOP N 的——所以我得到了 100 条与手机连接的用户记录，但其中只有 72 条是唯一实体。

有正确的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T07:02:17.320

您必须将查询拆分为子选择。其中内部子选择应该进行分页，外部应该进行获取：

```
var top100users =
(
    from user in session.Query<User>()
    where user.Name.StartsWith("a") &&
          user.Phones.Any()
    select user
)
.Take(100);

var users =
(
    from user in session.Query<User>()
    where top100users.Contains(user)
    select user
)
.Fetch (x => x.Phones)
.ToArray(); 
```

这将生成单个 sql 查询，其行为将如您所愿。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-25T07:13:27.110

好吧，我想出的唯一可能的解决方法是首先从查询中删除 Fetch ，所以它变成了这样：

```
var users =
    (
        from user in session.Query<User> ()
        where
            user.Name.StartsWith (prefix)
            &&
            user.Phones.Any ()
        select user
    )
    .Take (100)
    .ToList (); 
```

然后在该代码之后添加类似这样的内容，强制加载至少一个实体：

```
users.ForEach (x => x.Phones.Any ()); 
```

在映射中将批量大小设置为 100（或至少 50）：

```
public class UserMap : ClassMap<User>
{
    public UserMap ()
    {
        this.Table ("Users");

        this.Id (x => x.Id).CustomSqlType ("bigint").GeneratedBy.HiLo ("1000");
        this.Map (x => x.CreationDate);
        this.Map (x => x.ModifiedDate).Column ("LastUpdatedDate");
        this.Map (x => x.Email).Length (255).Not.Nullable ().Unique ();
        this.Map (x => x.Name).Column ("UserName").Length (255);

        this.HasMany (x => x.Phones).Inverse ().BatchSize (50);
    }
} 
```

或者通过约定（对于某些系统来说它可能不是那么优雅）：

```
PrimaryKey.Name.Is (x => "Id"),
ForeignKey.EndsWith ("Id"),
DefaultAccess.Property (),
DefaultCascade.All (),
DynamicUpdate.AlwaysTrue (),
new CollectionConventionBuilder ().Always (x => x.BatchSize (50)) 
```

顺便说一句，在纯 SQL 中，使用“for xml”可以相当简单地解决任务：

```
select top 100
    u.Id,
    u.CreationDate,
    u.LastUpdatedDate,
    u.Email,
    u.UserName,
    (
        select
            p.CountryCode,
            p.Code,
            p.Number,
            p.Comment
        from
            dbo.Phones as p
        where
            p.UserId = u.Id
        for xml path ('Phone'), root ('Phones'), type
    ) as '*'
from
    dbo.Users as u
where
    u.UserName like @0
    and
    exists (select top 1 p.Id from dbo.Phones as p where p.UserId = u.Id)
for xml path ('User'), root ('Root'), type 
```

我希望 NHibernate 可以在订购时从“for xml”查询中加载聚合根。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T16:19:53.917

您需要使用子查询（用于分页）和转换器来获得不同的用户，我不确定这在 NHibernate Linq 提供程序中是否可行，所以使用 QueryOver：

```
var sub_query = QueryOver.Of<User>() 
    .Where (Restrictions.On<User>(x => x.Name).IsLike("a%")) 
    .JoinQueryOver(x => x.Phones, JoinType.InnerJoin) 
    .Take (100)
    .Select(x => x.Id);

var users = session.QueryOver<User>() 
    .WithSubquery.WhereProperty (x => x.Id).In (sub_query) 
    .Fetch (x => x.Phones).Eager
    .TransformUsing (Transformers.DistinctRootEntity) 
    .List (); 
```

# sql-server - 在 TextBox 中获取本地时间月份名称

> ID：10721636
> 
> 赞同：0
> 
> 时间：2012-05-23T14:05:25.123
> 
> 标签：sql-server, ssrs-2008

我写了这个 SSRS 表达式来获取月份名称，它以英文给出月份名称，但我想获取 Local Time 或特定文化月份的名称。

如何在 SSRS 中解决？

```
MonthName(Month(Today())) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:08:37.267

使用`DATENAME`.

见[MSDN](http://msdn.microsoft.com/en-us/library/ms174395.aspx)：

> 返回值取决于使用 SET LANGUAGE 和登录的配置默认语言服务器配置选项设置的语言环境。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T16:12:55.417

这是我在项目中使用的示例，希望对您也有帮助 [http://www.codeproject.com/Articles/33355/Localization-of-SSRS-Reports](http://www.codeproject.com/Articles/33355/Localization-of-SSRS-Reports)

# ember.js - Ember Data 仅填充“id”属性

> ID：10721637
> 
> 赞同：3
> 
> 时间：2012-05-23T14:05:25.243
> 
> 标签：ember.js, ember-data

问题：从服务器接收到 JSON，但只有`id`属性有值。GUI 只显示字符串“2 1”，而`{{photoName}}`忽略。手动调用`MyApp.PhotoController.get('content').objectAt(0).get('photoName')`返回`undefined`，而`MyApp.PhotoController.get('content').objectAt(0).get('id')`返回正确的 ID。

有什么建议吗？

//我的模型：

```
MyApp.Photo = DS.Model.extend({
    id: DS.attr('number'),
    photoName: DS.attr('string'),
    photoDescription: DS.attr('string'),
    photoFullSizeURL: DS.attr('string'),
    photoThumbnailURL: DS.attr('string')
});

MyApp.Photo.reopenClass({
    url: 'photos.json'
}); 
```

//我的状态管理器

```
MyApp.stateManager = Ember.StateManager.create({
    rootElement: '#mainArea',
    initialState: 'showMainView',

    showMainView: Ember.ViewState.create({
        enter: function(stateManager) {
            this._super(stateManager);
            var photos = MyApp.store.findAll(MyApp.Photo);
            MyApp.PhotosController.set('content', photos);
        },

        view: Em.ContainerView.create({
            childViews: ['photoListView'],

            photoListView: Em.View.extend({
                elementId: 'photoList',
                templateName: 'photo-list-view',
                contentBinding: 'MyApp.PhotosController.content'
            })
        })
    })
}) 
```

//我的控制器：

```
MyApp.PhotosController = Ember.ArrayProxy.create({
    content: []
}); 
```

//我的模板：

```
<script type="text/x-handlebars" data-template-name="photo-list-view">
        PHOTOS:<br/>
        {{#each content}} 
            {{photoName}} {{id}}
        {{/each}}
</script> 
```

//从服务器接收的JSON：

```
[
    {
        "id": 2,
        "photoName": "Bird Photo",
        "photoDescription": "Bird Photo Description",
        "photoFullSizeUrl": "photos/bird.jpg",
        "photoThumbnailUrl": "photos/bird_thumb.png"        
    },
    {
        "id": 1,
        "photoName": "Bird Photo 2",
        "photoDescription": "Bird Photo Description 2",
        "photoFullSizeUrl": "photos/bird.jpg",
        "photoThumbnailUrl": "photos/bird_thumb.png"
    }
] 
```

该代码也作为要点发布在这里：[https ://gist.github.com/2775283](https://gist.github.com/2775283)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:30:32.877

啊..明白了..需要添加代码来对我的属性进行去骆驼化：

```
DS.Model.reopen({
    namingConvention: {
    keyToJSONKey: function(key) {
        return key;
    },

    foreignKey: function(key) {
        return key;
    }
  }
}); 
```

从以下页面找到了这个，我想我应该读过，无论如何：D [https://github.com/emberjs/data/blob/master/BREAKING_CHANGES.md](https://github.com/emberjs/data/blob/master/BREAKING_CHANGES.md)

# html - 更新软件的 RSS 提要

> ID：10721638
> 
> 赞同：0
> 
> 时间：2012-05-23T14:05:29.397
> 
> 标签：html, rss, packaging, microformats

是否有标准化类型的 RSS 提要或某种微格式，您可以在其中宣布通过您自己的网站分发的软件的更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T07:13:49.407

hatom 是用于联合的微格式，可以对其进行轮询以宣布您的更新。超级简单，html 类[http://microformats.org/wiki/hatom](http://microformats.org/wiki/hatom)

# eclipse - Maven jar 依赖和关系

> ID：10721639
> 
> 赞同：0
> 
> 时间：2012-05-23T14:05:30.163
> 
> 标签：eclipse, maven, dependencies, pom.xml, maven-jar-plugin

我试图搜索现有问题，但找不到任何问题 - 感觉我的问题很简单，但可能是因为它非常具体，我无法在任何地方找到答案。

无论如何 - 我有 2 个 Maven 项目，其中第二个项目取决于/需要第一个类的某些类。在某些情况下，我希望依赖于 JAR 而不是项目依赖。

我通过使用 maven-jar-plugin 创建一个额外的 jar 解决了这个问题，其中包含了所需的类。jar 已正确创建并在 ${project.build.directory} 中输出。但是项目 A 的 pom 位于同一目录中，这对我和项目 B 来说都是痛苦的，原因是项目 A 中使用的依赖项。（有没有办法忽略位于 ${project. build.directory} ??? 喜欢：

```
<dependency>
            <groupId>projectA.groupId</groupId>
            <artifactId>A</artifactId>
            <version>1x-SNAPSHOT</version>
            <classifier>classes</classifier>
                    ->  <ignorePom>true</ignorePom>
        </dependency> 
```

）。

现在我将系统范围用于依赖项，并在添加系统路径后正常工作。尽管在任何可能的地方都必须避免使用示波器系统。Systempath 让我很烦，因为这不是一个好习惯，而且因为绝对路径。

我知道我可以通过使用将创建的 jar 安装到存储库中

> mvn 安装：安装文件

但我想尽可能地自动化这个过程，你有什么建议？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:48:34.933

最好的解决方案是使用存储库管理器并真正发布第一个 jar 并在您需要的地方建立真正的依赖关系。

根据您写的内容，我建议创建一个单独的 maven 项目，其中包含将由其他几个模块使用的类，然后发布它并简单地使用对该模块的依赖。这将彻底解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T08:52:45.340

您是否阅读过任何有关[Maven](http://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html)的文档？如果您有使用 Maven 定义的项目，那么您无需执行任何特殊操作即可使依赖项正常工作。

根据您的需要，您有两种选择：创建两个单独的项目，其中一个依赖于另一个，或者您可以创建一个多模块项目，其中一个模块仍然依赖于另一个。

**两个独立的项目**

```
.
 |-- A
 |   `-- pom.xml
 |   `-- src
 |       `-- main
 |           `-- java
 `-- B
     `-- pom.xml
     `-- src
         `-- main
             `-- java 
```

`A/pom.xml`

```
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0  http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.company</groupId>
    <artifactId>A</artifactId>
    <version>1.0-SNAPSHOT</version>
</project> 
```

`B/pom.xml`

```
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.company</groupId>
    <artifactId>B</artifactId>
    <version>2.0-SNAPSHOT</version>

    <dependencies>
        <dependency>
            <groupId>com.company</groupId>
            <artifactId>A</artifactId>
            <version>1.0-SNAPSHOT</version>
        </dependency>
    </dependencies>
</project> 
```

而已！您依赖于 B 中的项目/模块 A。

`mvn install`您首先通过发布（并在目录 A 中）来构建项目 A。该工件将安装在您的本地存储库中（并可用于其他项目）。

然后你通过发布`mvn install`（并在目录 B 中）来构建项目 B。该工件将安装在您的本地存储库中。

**一个带有子模块的父项目**

```
.
 |-- A
 |   `-- pom.xml
 |   `-- src
 |       `-- main
 |           `-- java
 `-- B
 |   `-- pom.xml
 |   `-- src
 |       `-- main
 |           `-- java
 `-- pom.xml 
```

`pom.xml`

```
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <groupId>com.company</groupId>
    <artifactId>parent</artifactId>
    <packaging>pom</packaging>
    <version>1.0-SNAPSHOT</version>

    <modules>
        <module>A</module>
        <module>B</module>
    </modules>

    <dependencyManagement>
        <dependencies>
            <dependency>
                <groupId>com.company</groupId>
                <artifactId>A</artifactId>
                <version>${project.version}</version>
            </dependency>
        </dependencies>
    </dependencyManagement>

</project> 
```

`<depencdencyManagement/>`可以帮助子模块选择正确的版本。

`A/pom.xml`

```
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>com.company</groupId>
        <artifactId>parent</artifactId>
        <version>1.0-SNAPSHOT</version>
    </parent>

    <groupId>com.company</groupId>
    <artifactId>A</artifactId>

</project> 
```

`B/pom.xml`

```
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>com.company</groupId>
        <artifactId>parent</artifactId>
        <version>1.0-SNAPSHOT</version>
    </parent>

    <groupId>com.company</groupId>
    <artifactId>B</artifactId>

    <dependencies>
        <dependency>
            <groupId>com.company</groupId>
            <artifactId>A</artifactId>
        </dependency>
    </dependencies>
</project> 
```

使用此解决方案，您只需将自己定位在父文件夹中并运行`mvn install`（或`mvn package`类似）。您现在将以正确的顺序构建 A 和 B，并且整个项目可以导入到 Eclipse 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:15:06.577

Maven 不支持“依赖 jars”。有“系统”的范围，但非常有限，可能会导致各种麻烦。如果你需要依赖一个 Jar，你需要给它分配一个唯一的 groupId 和 artifactId。如果您不想在 Maven 中构建它，您可以将其部署到本地 repo 管理器（甚至使用 mvn install:install-file 部署到本地 repo）。

取决于带有分类器“工作”但不是很好的罐子，因为反应器不能正确地将它们包含在多模块项目中。

# shader - 如果着色器从不改变，有没有办法缓存慢速 WebGL 着色器编译？

> ID：10721641
> 
> 赞同：1
> 
> 时间：2012-05-23T14:05:30.997
> 
> 标签：shader, webgl

我有一个 WebGL 着色器，当我有这个时，它可以立即感知编译（Windows 7 上的 Chrome）：

```
void main(void) {
    if (antialias_level == 1)
        gl_FragColor = NewtonIteration((gl_FragCoord.xy + offset) / zoom);
    else if (antialias_level == 2)
        gl_FragColor = (NewtonIteration((gl_FragCoord.xy + offset + vec2(-0.25, -0.25)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.25, 0.25)) / zoom)) * 0.5;
} 
```

但是编译它需要很长时间（约 10 秒）：

```
void main(void) {
    if (antialias_level == 1)
        gl_FragColor = NewtonIteration((gl_FragCoord.xy + offset) / zoom);
    else if (antialias_level == 2)
        gl_FragColor = (NewtonIteration((gl_FragCoord.xy + offset + vec2(-0.25, -0.25)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.25, 0.25)) / zoom)) * 0.5;
    else if (antialias_level == 4)
        gl_FragColor = (NewtonIteration((gl_FragCoord.xy + offset + vec2(-0.25, -0.25)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(-0.25, 0.25)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.25, -0.25)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.25, 0.25)) / zoom)) * 0.25;
    else if (antialias_level == 9)\
        gl_FragColor = (NewtonIteration((gl_FragCoord.xy + offset + vec2(-0.33, -0.33)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.0, -0.33)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.33, -0.33)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(-0.33, 0.0)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.0, 0.0)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.33, 0.0)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(-0.33, 0.33)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.0, 0.33)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.33, 0.33)) / zoom)) * 0.111111111;
    else if (antialias_level == 16)\
        gl_FragColor = (NewtonIteration((gl_FragCoord.xy + offset + vec2(-0.375, -0.375)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(-0.125, -0.375)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.125, -0.375)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.375, -0.375)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(-0.375, -0.125)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(-0.125, -0.125)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.125, -0.125)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.375, -0.125)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(-0.375, 0.125)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(-0.125, 0.125)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.125, 0.125)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.375, 0.125)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(-0.375, 0.375)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(-0.125, 0.375)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.125, 0.375)) / zoom) + NewtonIteration((gl_FragCoord.xy + offset + vec2(0.375, 0.375)) / zoom)) * 0.0625;
} 
```

有没有办法将 WebGL 编译的结果缓存到二进制文件并加载它，或者这没有帮助？我假设长时间延迟与将着色器从 OpenGL 转换为 DirectX 有关。

（[这是一个活生生的例子](http://jnm2.com/newton/)。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T16:33:41.463

我不知道有什么方法可以为 WebGL 预编译着色器；提供这样的功能可能会有很多可移植性和安全性问题。

用户选择的参数是否`antialias_level`在整个场景中都是恒定的？为当前选择的关卡而不是所有可能的关卡编译着色器可能会更好；这可能在运行时更有效，并且编译速度更快。

自定义着色器同时仍将着色器源与 JS 代码分开的一种简单方法是`"#define ANTIALIAS_LEVEL " + level`在编译之前预先添加，并在着色器源中使用`#if`选择适当的情况。但是，由于您的`main()`代码非常系统化，因此仅通过算法生成它可能是值得的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-24T03:36:44.343

不，没有办法预编译着色器。这将是一个巨大的安全漏洞。

另一方面，两种浏览器很可能会在未来开始为你缓存着色器

这是 Chrome [http://code.google.com/p/chromium/issues/detail?id=88572的问题](http://code.google.com/p/chromium/issues/detail?id=88572)

我不确定Firefox或其他浏览器是否有类似的。

# java - 通配符（？）有效，而类型“T”在泛型中不起作用 - 为什么？

> ID：10721642
> 
> 赞同：2
> 
> 时间：2012-05-23T14:05:31.073
> 
> 标签：java, generics

我对java中的泛型很陌生。我有一个名为`RIEngine`.

我正在尝试以下示例：

```
private <T> boolean allExist(List<T extends RIEngine> resultedList, 
                             String... columnName)
{ ... } 
```

不编译。

但

```
private <T> boolean allExist(List<? extends RIEngine> resultedList, 
                            String... columnName)
{ ... } 
```

编译。

我的问题是：为什么会这样。

为什么我不能使用 type = "T" 而不是通配符？

请帮我理解。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-23T14:07:17.937

尝试这个：

```
private <T extends RIEngine> boolean allExist(List<T> resultedList, String... columnName){... 
```

您需要将类型边界放在类型*声明*中，而不是在使用它的地方。

第二个编译的原因是因为它是一个通配符（您可以使用它而无需事先声明为该方法的类型）

# axapta - 无法访问开发人员工作区

> ID：10721650
> 
> 赞同：1
> 
> 时间：2012-05-23T14:05:54.273
> 
> 标签：axapta, dynamics-ax-2012

我在 Dynamic AX 2012 上以系统管理员身份连接，启动开发人员工作区时出现错误消息：“访问开发人员工作区的权限不足”

问题是什么？

图片显示错误： ![在此处输入图像描述](../Images/51dd8b6e8b3e05f59e2f36bc5f04c9eb.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T08:03:43.890

尝试启动 AX 2012 应用程序，也许您不是 AX 管理员？

# android - Android 设置 - Settings.system.ACCELOROMETER_ROTATION 不起作用

> ID：10721654
> 
> 赞同：0
> 
> 时间：2012-05-23T14:06:02.570
> 
> 标签：android, settings, orientation

我这里好像有错误。我正在尝试更改设置中的加速度计自动旋转值。

现在，我设法锁定和解锁旋转设备。但是，每当我锁定设备时，它都会进入纵向模式，无论我在锁定它时处于什么方向。

这是我的代码：

```
 public void setAutoOrientationEnabled(boolean enabled)
{
  Settings.System.putInt(content, Settings.System.ACCELEROMETER_ROTATION, enabled ? 1 : 0);
} 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-08T09:55:28.207

此代码示例锁定/解锁屏幕旋转并在锁定时保留当前方向：

```
if (Settings.System.getInt(context.getContentResolver(), Settings.System.ACCELEROMETER_ROTATION) == 1) {
            Display defaultDisplay = ((WindowManager) context.getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay();
            Settings.System.putInt( context.getContentResolver(), Settings.System.USER_ROTATION, defaultDisplay.getRotation());
            Settings.System.putInt( context.getContentResolver(), Settings.System.ACCELEROMETER_ROTATION, 0);       
} else {
            Settings.System.putInt( context.getContentResolver(), Settings.System.ACCELEROMETER_ROTATION, 1);                
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-05T08:39:54.860

```
 int orientation = this.getRequestedOrientation();
        int rotation = ((WindowManager) this.getSystemService(
                Context.WINDOW_SERVICE)).getDefaultDisplay().getRotation();
        switch (rotation) {
            case Surface.ROTATION_0:
                Settings.System.putInt(getContentResolver(), Settings.System.USER_ROTATION, 1);
                orientation = ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE;
                break;
            case Surface.R`enter code here`OTATION_90:
                Settings.System.putInt(getContentResolver(), Settings.System.USER_ROTATION, 0);
                orientation = ActivityInfo.SCREEN_ORIENTATION_PORTRAIT;
                break;
        }

        this.setRequestedOrientation(orientation); 
```

# java - 当我直接运行帮助程序类时，代码会引发异常

> ID：10721655
> 
> 赞同：0
> 
> 时间：2012-05-23T14:06:09.450
> 
> 标签：java, jsp, servlets, netbeans, glassfish

以下代码从给定用户电子邮件的数据库中获取照片的名称。

```
package NonServletFiles;
import javax.sql.*;
import java.sql.*;
import javax.naming.*;
public class GetPhotosForTheUser {

public ResultSet getData(String email) {
    ResultSet set = null;
    try {
        String sqlQuery = "select nameofthephoto from photocaptions where useremail='" + email + "'";
        Context context = new InitialContext();
        DataSource ds = (DataSource)context.lookup("java:comp/env/jdbc/photog"); // LINE 17
        Connection connection = ds.getConnection();
        PreparedStatement statement = connection.prepareStatement(sqlQuery);
        set = statement.executeQuery();
        while(set.next()){
            System.out.println("Name Of The Photo : " + set.getString("NameOfThePhoto"));
        }
    }catch(Exception exc) {
        exc.printStackTrace();
    }

    return set;
  }
} 
```

`.jsp`如果我从文件中调用这个助手类：

```
 <% 
        GetPhotosForTheUser gpftu = new GetPhotosForTheUser();
        gpftu.getData("suhailgupta03@gmail.com");
    %> 
```

它在服务器控制台上打印正确的名称。

`main`但是如果我通过添加方法单独使用这个类

![在此处输入图像描述](../Images/ebf148e2c5257feb218a5c28dff56ca4.png)

在那个助手类中，它抛出一个异常，它是：

```
javax.naming.NamingException: Lookup failed for 'java:comp/env/jdbc/photog' in SerialContext[myEnv={java.naming.factory.initial=com.sun.enterprise.naming.impl.SerialInitContextFactory, java.naming.factory.url.pkgs=com.sun.enterprise.naming, java.naming.factory.state=com.sun.corba.ee.impl.presentation.rmi.JNDIStateFactoryImpl} [Root exception is javax.naming.NamingException: Invocation exception: Got null ComponentInvocation ]
at com.sun.enterprise.naming.impl.SerialContext.lookup(SerialContext.java:518)
at com.sun.enterprise.naming.impl.SerialContext.lookup(SerialContext.java:455)
at javax.naming.InitialContext.lookup(InitialContext.java:411)
at NonServletFiles.GetPhotosForTheUser.getData(GetPhotosForTheUser.java:17)
at NonServletFiles.GetPhotosForTheUser.main(GetPhotosForTheUser.java:32)
    Caused by: javax.naming.NamingException: Invocation exception: Got null ComponentInvocation 
at com.sun.enterprise.naming.impl.GlassfishNamingManagerImpl.getComponentId(GlassfishNamingManagerImpl.java:873)
at com.sun.enterprise.naming.impl.GlassfishNamingManagerImpl.lookup(GlassfishNamingManagerImpl.java:742)
at com.sun.enterprise.naming.impl.JavaURLContext.lookup(JavaURLContext.java:172)
at com.sun.enterprise.naming.impl.SerialContext.lookup(SerialContext.java:498)
... 4 more 
```

为什么会这样？我正在使用*glassfish 服务器和 netbeans 进行此开发*。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T14:19:51.557

当您将其作为 Web 应用程序运行时，您的 Context 将使用服务器详细信息进行初始化

```
Context context = new InitialContext(); // This is initialized when you run as web app 
```

当您通过调用 main 方法作为独立程序运行时，情况并非如此

你可以通过初始化你的上下文来摆脱这个。

```
Properties prop = new Properties();
prop.put(Context.INITIAL_CONTEXT_FACTORY, "your provider"); // like for websphere it is com.ibm.websphere.naming.WsnInitialContextFactory and weblogic weblogic.jndi.WLInitialContextFactory
prop.put(Context.PROVIDER_URL, "server path"); //
Context context = new InitialContext(prop); 
```

注意：通常你不会这样写，而是你的代码会检查它是否在 WEBMODE 或 TEST 中运行，如果测试它会初始化 Context，否则它只会使用正常的上下文。

这将初始化您的上下文，您将能够从 main 方法运行它。

编辑：Glassfish 配置取自[这里](http://glassfish.java.net/javaee5/ejb/EJB_FAQ.html)

```
 Properties props = new Properties();

  props.setProperty("java.naming.factory.initial", 
                    "com.sun.enterprise.naming.SerialInitContextFactory");

  props.setProperty("java.naming.factory.url.pkgs", 
                    "com.sun.enterprise.naming");

  props.setProperty("java.naming.factory.state",
                    "com.sun.corba.ee.impl.presentation.rmi.JNDIStateFactoryImpl");

  // optional.  Defaults to localhost.  Only needed if web server is running 
  // on a different host than the appserver    
  props.setProperty("org.omg.CORBA.ORBInitialHost", "localhost");

  // optional.  Defaults to 3700\.  Only needed if target orb port is not 3700.
  props.setProperty("org.omg.CORBA.ORBInitialPort", "3700");

  InitialContext ic = new InitialContext(props); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:17:31.980

当您使用 main 方法运行它时，您不会将其作为 Web 应用程序执行，因此您没有 Web 应用程序上下文。

# mysql - Yii框架，提交表单后，数据库中的文本字段不更新

> ID：10721661
> 
> 赞同：1
> 
> 时间：2012-05-23T14:06:29.667
> 
> 标签：mysql, yii

我对 MVC 和 Yii 框架很陌生，因此我的问题很可能很愚蠢。如果是这样，请提前接受我的道歉。

我想在网站的管理部分有一个表单，用户可以在其中发布一些内容。我按照示例博客的教程进行操作，但是似乎添加到数据库中定义为文本的字段（我的表单中的 textarea）的内容在提交表单后没有得到更新（其他一切正常）。这是我的表的 sql 语句：

```
CREATE TABLE `tbl_show` (
   `id` bigint(20) NOT NULL AUTO_INCREMENT,
   `presentation` text,
    PRIMARY KEY (`id`),
    KEY `fk_tbl_show_tbl_season1` (`tbl_season_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=2 ; 
```

我使用 Gii 制作模型和 CRUD，我只在此处添加可能相关的部分：

在我的控制器上：

```
 public function actionCreate()
{
    $model=new Show;

    if(isset($_POST['Show']))
    {
        $model->attributes=$_POST['Show'];
        if($model->save())
                    {
                        $this->redirect(array('view','id'=>$model->id));
                    }   
    }
    $this->render('create',array(
        'model'=>$model,
    )); 
```

和我的_form.php：

```
<div class="form">

 <?php $form=$this->beginWidget('CActiveForm', array(
 'id'=>'show-form',
 'enableAjaxValidation'=>false,
  )); ?>

<?php echo $form->errorSummary($model); ?>

    <div class="row">
    <?php echo $form->labelEx($model,'presentation'); ?>
    <?php echo $form->textArea($model,'presentation',array('rows'=>6, 'cols'=>50)); ?>
    <?php echo $form->error($model,'presentation'); ?>
</div>

<div class="row buttons">
    <?php echo CHtml::submitButton($model->isNewRecord ? 'Create' : 'Save'); ?>
</div>

    <?php $this->endWidget(); ?>

    </div><!-- form --> 
```

示范规则：

```
return array(
    array('id, presentation', 'safe', 'on'=>'search'),
); 
```

我不明白为什么只有文本内容没有更新，它们在数据库中显示为空。

提前谢谢你，干杯，马萨

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-23T14:45:17.057

你必须使属性安全。将此添加到您的`Show`模型验证规则中

```
array('presentation','safe') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:49:17.727

我发现表单没有正确提交的问题，我在这里添加它以防有人遇到同样的问题：

我已经覆盖了 beforeSave，但我想稍后完成它，所以它不会返回任何东西：

```
protected function beforeSave() {
        if(parent::beforeSave())
        {
            if($this->isNewRecord)
            {
               //things that should be added by the system
            }
        }

    } 
```

评论后一切正常。另外，正如你们建议的那样，我将没有验证的字段添加到安全规则中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-24T05:04:32.633

试试这个 ..

```
public function actionCreate()
{
    $model=new Show;

    if(isset($_POST['Show']))
    {
        $model->attributes=$_POST['Show'];

        $save = $model->save(false);      // write like this...
        if($save)
                    {
                        $this->redirect(array('view','id'=>$model->id));
                    }   
    }
    $this->render('create',array(
        'model'=>$model,
    )); 
```

希望它对你有用..

# java - 尝试从 MySQL 查询解析 JSON 时出现异常

> ID：10721663
> 
> 赞同：0
> 
> 时间：2012-05-23T14:06:31.773
> 
> 标签：java, php, mysql, json

我在用 Java 解析来自 MySQL 的 JSON 响应时遇到问题。

```
try {
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("http://parkfinder.zxq.net/default.php");
    httppost.setEntity(new UrlEncodedFormEntity(coordinatesToSend));
    HttpResponse response = httpclient.execute(httppost);
    Log.d("HTTP Client", "HTTP Request made");

    HttpEntity entity = response.getEntity();
    inputStream = entity.getContent();
    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(inputStream,
            "iso-8859-1"), 8);
    sb = new StringBuilder();
    sb.append(bufferedReader.readLine() + "\n");

    String line = "0";
    while ((line = bufferedReader.readLine()) != null) {
        sb.append(line + "\n");
    }
    inputStream.close();
    bufferedReader.close();
    result = sb.toString();
    Log.d("RESULT", result);
    JSONObject json_data = new JSONObject(result);
    Log.d("JSON","Finished");
    JSONArray nameArray = json_data.names();
    JSONArray valArray = json_data.toJSONArray(nameArray);
    for (int i = 0; i < nameArray.length(); i++) {
        Log.d("NAMES", nameArray.getString(i));
    }
    for (int i = 0; i < nameArray.length(); i++) {
        Log.d("NAMES", nameArray.getString(i));
    }

} catch (Exception e) {
    // TODO: handle exception
} 
```

这是 MySQL Accessing and retreiving info, and parsing it afterwars。这

```
Log.d("RESULT", result); 
```

行发布正确的结果：

```
2[{"longtitude":"32.32","latitude":"33.12"}] 
```

但是，那

```
Log.d("JSON","Finished"); 
```

永远不会被调用，所以问题似乎出在这条线上

```
JSONObject json_data = new JSONObject(result); 
```

这件事取自一个教程，我在互联网上和这个网站上看到了很多例子，有些错误，但不是这个。

任何帮助都会很棒！谢谢

编辑： printStackTrace() 输出：

```
0`5-14 21:38:18.639: WARN/System.err(665): org.json.JSONException: A JSONObject text must begin with '{' at character 1 of 2[{"longtitude":"32.32","latitude":"33.12"}]` 
```

php代码：

```
<?php
$host = "localhost";
$user = "**MASKED**";
$password = "**MASKED**";
$database = "parkfinder_zxq_coordinates";
$connection = mysql_connect($host, $user, $password) or die("couldn't connect to server");
$db = mysql_select_db($database, $connection) or die("couldn't select database.");
//$request_parked = $_REQUEST['parked'];
$request_long = $_REQUEST['longtitude'];
$request_lat = $_REQUEST['latitude'];
//if ($request_parked == 'FIND') {
$q = mysql_query("SELECT * FROM Coordinates");
while ($e = mysql_fetch_assoc($q))
    $output[] = $e;

print (json_encode($output));
//}

mysql_close();
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:13:33.170

您的 JSON 数据`2[{"longtitude":"32.32","latitude":"33.12"}]`无效（该数字`2`不是正确的 JSON 语法）。

我可以建议你的意思吗

```
[{"longtitude":"32.32","latitude":"33.12"}]` 
```

（即没有`2`开头的）

您可以使用[http://jsonlint.com/](http://jsonlint.com/)上的验证器来检查您的 JSON 代码。

# javascript - 防止 showAuthenticationDialog 在 Spotify 应用程序中自动登录

> ID：10721667
> 
> 赞同：2
> 
> 时间：2012-05-23T14:06:41.983
> 
> 标签：javascript, spotify

我正在使用[showAuthenticationDialog 和 authenticateWithFacebook](https://developer.spotify.com/technologies/apps/docs/beta/09321954e7.html)对 Twitter 和 Facebook 进行身份验证。一旦用户使用弹出窗口登录一次，它会在随后的时间自动登录，从而无法使用其他帐户登录。

有没有办法清除弹出窗口中的 cookie 或类似的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T16:58:23.437

Twitter 的 OAuth API 有一个`force_login`参数会强制你输入你的登录信息：

[https://dev.twitter.com/docs/api/1/get/oauth/authenticate](https://dev.twitter.com/docs/api/1/get/oauth/authenticate)

Facebook 提供了类似的`reauthenticate`选项：

[https://developers.facebook.com/docs/authentication/reauthentication/](https://developers.facebook.com/docs/authentication/reauthentication/)

OAuth 本身并未指定如何执行这些操作，因为它旨在提供授权服务器。OpenID Connect 指定了一个参数，“approval_prompt=force”，这有望在未来使这更容易。

# c# - 如何将段落转换为词根

> ID：10721670
> 
> 赞同：-1
> 
> 时间：2012-05-23T14:06:47.327
> 
> 标签：c#, string, text, split, words

对不起，我正在尝试制作将单词转换为单词的简单应用程序。例如

启用 = 能够付款 = 支付

我记事本上的文字是“启用付款”

我在上面使用了 2 个示例词，但我没有得到我需要的东西。我在 notepad.txt 上写了“启用”和“付款”。然后应用程序将启动并得到消息。

并且应用程序将开始修剪*切割“En”和“ment”*的单词，因此它们的结果将是“able”和“pay”

我的应用程序可以将单个单词 "enable" 修剪为 "able" 。和“支付”到“支付”，但是，如果我写了 2 个或更多字，例如“启用支付”或“启用支付”，应用程序就不能正常工作

这是用户界面[图像](http://i1085.photobucket.com/albums/j423/Nencor_Theleftbehind/1.jpg)

这是源代码，

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;

namespace KTM'
{
public partial class KTM : Form
{
    public string notepad;
    public KTM()
    {
        InitializeComponent();
        textBox1.Enabled=false;
        button2.Enabled = false;
        button3.Enabled = false;
    }

    void enable()
    {
        button2.Enabled = true;
        button3.Enabled = true;
    }
    private void button1_Click(object sender, EventArgs e)
    {

        string dir = Application.StartupPath.ToString();
        OpenFileDialog fdlg = new OpenFileDialog();
        fdlg.Title = "Open *txt files";
        fdlg.InitialDirectory = @dir;
        fdlg.Filter = "Text files (*.txt)|*.txt|Text Files (*.txt)|*.txt";
        fdlg.FilterIndex = 2;
        fdlg.RestoreDirectory = true;
        if (fdlg.ShowDialog() == DialogResult.OK)
        {
            textBox1.Text = fdlg.FileName;
        }
        else
        {

        }

      }

    private void textBox1_TextChanged(object sender, EventArgs e)
    {
        if (textBox1.Text.Equals(""))
        {

        }
        else
        {
            enable();
        }
    }

    private void button2_Click(object sender, EventArgs e)
    {
        notepad = textBox1.Text;

        StreamReader sr = new StreamReader(notepad);
        string paragraf = sr.ReadToEnd();
        sr.Close();
        string[] kata = paragraf.Split(' ');
        int i = 0;

        //MessageBox.Show(kata[0]+" "+kata[1]+" "+kata[2]);
        foreach (string ambil in kata)
        {
            if (kata[i].StartsWith("en"))
            {
                kata[i] = kata[i].Substring(2);
            }
            if(kata[i].EndsWith("ment"))
            {
                int len = kata[i].Length;
                int kepake = len - 4;
                kata[i] = kata[i].Substring(0, kepake);
            }

        }
        i++;
        StreamWriter sw = new StreamWriter(notepad);
        i = 0;
        foreach (string ambil in kata)
        {
            sw.Write(kata[i]+" ");
        }
        i++;
        sw.Flush();
        sw.Close();

        MessageBox.Show("Converted and Saved  ","KTM Stemming",MessageBoxButtons.OK,MessageBoxIcon.Information);
    }

    private void button3_Click(object sender, EventArgs e)
    {
        notepad = textBox1.Text;
        System.Diagnostics.Process.Start(notepad);
    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:13:19.017

您的 foreach 循环设计不正确。由于您要更新循环内的数组，因此最好使用迭代器进行简单的 for 循环：

```
 for (int i = 0; i < kata.Length; i++)
    {
        if (kata[i].StartsWith("en"))
        {
            kata[i] = kata[i].Substring(2);
        }
        if(kata[i].EndsWith("ment"))
        {
            int len = kata[i].Length;
            int kepake = len - 4;
            kata[i] = kata[i].Substring(0, kepake);
        }
    } 
```

但是，在第二个循环中，foreach 是有意义的。但是，您需要使用 ambil 变量：

```
 foreach (string ambil in kata)
    {
        sw.Write(ambil + " ");
    } 
```

编辑：

你说上面的不起作用，但它对我有用。也许您的问题与表单中的其他一些代码有关。由于在同一方法中混合不同种类的逻辑并不是一个好习惯，我建议将根词解析逻辑分解为自己的方法，例如：

```
 private string getRootWords(string paragraf)
    {
        string[] kata = paragraf.Split(' ');
        for (int i = 0; i < kata.Length; i++)
        {
            if (kata[i].StartsWith("en"))
            {
                kata[i] = kata[i].Substring(2);
            }
            if (kata[i].EndsWith("ment"))
            {
                int len = kata[i].Length;
                int kepake = len - 4;
                kata[i] = kata[i].Substring(0, kepake);
            }
        }

        StringBuilder builder = new StringBuilder();
        foreach (string ambil in kata)
        {
            builder.Append(ambil + " ");
        }
        return builder.ToString();
    } 
```

这种方法对我有用。当我打电话时`getRootWords("Enable payment")`，它会返回 `able pay'，据我所知，这是您想要的输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:11:36.980

你在循环外增加索引变量`i`，你应该在里面增加它：

```
 foreach (string ambil in kata) 
    { 
        if (kata[i].StartsWith("en")) 
        { 
            kata[i] = kata[i].Substring(2); 
        } 
        if(kata[i].EndsWith("ment")) 
        { 
            int len = kata[i].Length; 
            int kepake = len - 4; 
            kata[i] = kata[i].Substring(0, kepake); 
        } 
        i++; 
    } 
```

最好还是直接使用`for`循环（你没有使用`ambil`变量）：

```
 for (i=0; i<kata.Lenght; i++) 
    { 
        if (kata[i].StartsWith("en")) 
        { 
            kata[i] = kata[i].Substring(2); 
        } 
        if(kata[i].EndsWith("ment")) 
        { 
            int len = kata[i].Length; 
            int kepake = len - 4; 
            kata[i] = kata[i].Substring(0, kepake); 
        } 
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T14:19:53.150

```
 foreach (string ambil in kata)
    {
        if (kata[i].StartsWith("en"))
        {
            kata[i] = kata[i].Substring(2);
        }
        if(kata[i].EndsWith("ment"))
        {
            int len = kata[i].Length;
            int kepake = len - 4;
            kata[i] = kata[i].Substring(0, kepake);
        }

    } 
```

这是你的问题的一部分，因为它是一个 foreach，但你使用它就像一个 for 循环。您可能`for (int i=0; i<kata.Length; i++)`还希望在 for 循环之外写入文件，因此您需要将写入内容放入该 for 循环中，或者制作另一个 for 循环。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-25T13:22:16.093

谢谢你们的帮助！:) 我真的很感激，虽然我不明白一些答案 :D 至少你们帮我构建逻辑，我这样解决我的问题

```
 private void button2_Click(object sender, EventArgs e)
    {
        notepad = textBox1.Text;

        StreamReader sr = new StreamReader(notepad);
        string paragraf = sr.ReadToEnd();
        sr.Close();
        StreamWriter sw = new StreamWriter(notepad);
        string[] kata = paragraf.Split(' ');

        for (int i = 0; i < kata.Length; i++)
        {
            if (kata[i].StartsWith("en"))
            {
                kata[i] = kata[i].Substring(2);
                //cutting the EN*
            }

            if (kata[i].EndsWith("ment"))
            {
                int panjang = kata[i].Length;
                int sisa = panjang - 4;
                kata[i] = kata[i].Substring(0, sisa);
                //cutting the *Ment
            }

            if(kata[i].EndsWith("ous"))
            {
                int panjang = kata[i].Length;
                int sisa = panjang - 3;
                kata[i] = kata[i].Substring(0, sisa);
                //cutting the ous, tremendous, hazardous
            }

            if (kata[i].EndsWith("ied"))
            {
                int panjang = kata[i].Length;
                int sisa = panjang -1;
                kata[i] = kata[i].Substring(0, sisa);
                //cutting ied
            }

            if (kata[i].EndsWith("ly"))
            {
                int panjang = kata[i].Length;
                int sisa = panjang - 2;
                kata[i] = kata[i].Substring(0, sisa);
                //cutting fluently, diligently
            }
            sw.Write(kata[i] + " ");
        }

        sw.Flush();
        sw.Close();
        MessageBox.Show("Converted and Saved  ", "KTM Stemming", MessageBoxButtons.OK, MessageBoxIcon.Information);
    } 
```

# actionscript-3 - 1136：参数数量不正确。预期 1 行 27 但第 27 行没有错误？

> ID：10721673
> 
> 赞同：0
> 
> 时间：2012-05-23T14:06:58.397
> 
> 标签：actionscript-3, apache-flex, adobe, flash-builder

我看到很多关于这个问题的答案，但我的有点不同。我正在使用 flash 4.5 PHP 和 adobe CS Extension builder SDK。我刚开始收到此错误：

```
'1136: Incorrect number of arguments.  Expected 1\. 27 Flex Problem' 
```

但是，我双击错误并没有给我带来任何错误？我浏览了所有 *.as 文件，但在我的任何代码中都找不到标记错误？我不确定如何修复我找不到的东西？还有其他人遇到这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T06:08:49.080

有时，当您将奇怪的连接设置为绑定时，Flex 会产生错误。您可以做的是将命令行参数 -keep-generated-actionscript 设置为 true。编译器现在在您的源文件夹中生成一个生成文件夹，其中所有生成为您的 mxml 文件中的类。然后，您可以尝试单独编译它们。Mybe你会发现错误。由于生成的 mxml/as 代码中的错误，我这样做了几次。

# actionscript-3 - 如何使用相同的先决条件数据来测试大型应用程序的多个模块？

> ID：10721681
> 
> 赞同：0
> 
> 时间：2012-05-23T14:07:37.543
> 
> 标签：actionscript-3, unit-testing, flexunit, flexunit4

我正在使用 actionscript 开发自定义游戏。该应用程序有几个模块。该应用程序是数据密集型的。为了启动应用程序，您需要加载许多其他 swf、JSON 等。我不想测试 UI 位（暂时）。我要测试的是：

*   没有模块崩溃
*   我得到理智的答案

我不关心 UI 和视觉异常。

我想为模块和单独的测试类编写单独的测试套件。更有条理。

**问题：**

为了测试最简单的函数，我需要加载 X、Y、Z 数据。X,Y,Z 数据对所有模块都是通用的。

我如何编写不同的测试类和套件并只预加载一次数据并在整个测试中使用该数据副本。大多数数据在测试过程中不会改变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T01:12:32.447

我通常为我需要的每个数据对象类创建一个或多个测试版本，它是数据对象的子类，并填写了所有属性。

所以在 [Before] 方法中，我可能会这样设置：

```
testVO = new TestMyVO(); 
```

在测试用例中：

```
myObjectThatNeedsAVO.myVO = testVO; 
```

所以所有需要 MyVO 的测试用例，我都可以重用那个 TestMyVO。如果我需要多个，我可能会创建一个可以创建多个之一的工厂，然后调用我特别需要锻炼的那个来锻炼我正在锻炼的东西。

# javascript - 如何在 javascript 中使用 Raphael 创建 3D 效果？

> ID：10721691
> 
> 赞同：0
> 
> 时间：2012-05-23T14:08:29.037
> 
> 标签：javascript, raphael

我知道 Raphael.js 是一个矢量图形 javascript 引擎。但是，我需要在 javascript 中创建圆柱体，并在圆柱体的圆形部分写上文字。文字需要跟随圆柱体的表面，形成类似3D的效果。

有谁知道如何用 Raphael 做到这一点？否则，我应该使用哪个其他库来实现我的目标？

提前谢谢各位！史蒂夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:16:18.220

我认为最好的 3d javascript 库是：

[杜布先生的 Three.js](https://github.com/mrdoob/three.js/)

前往并查看那里的示例并查看源代码。如果您确实喜欢使用 three.js，请查看 aerotwist 的教程：

[aerotwist 教程](http://aerotwist.com/tutorials/getting-started-with-three-js/)

**编辑**

Three.js 也有一个`SVG Renderer`I found this [example on fiddle](http://jsfiddle.net/mNq2a/1/)

# database - How do I create a copy of my application in Windows Azure?

> ID：10721697
> 
> 赞同：0
> 
> 时间：2012-05-23T14:08:46.847
> 
> 标签：database, azure, azure-configuration

I have made a small application in Windows Azure. For research purposes they asked me to research this scenario, and I can't seem to find any good information on it.

In short scenario (not real): The application works fine for 1 company but because we are an IT firm we want to expand this application and make it available for other companies. It's like making a copy of the application that would use another database for storage and this for each company we want to offer it to.

What is the best way to approach this in Windows Azure?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:29:51.427

You can either:

*   deploy your app to multiple hosted services (e.g. myapp1.cloudapp.net, myapp2.cloudapp.net, etc.) and have each deployment use different settings in the service configuration (such as database connection and storage account)
*   Make changes to your app to support multiple tenants

Deploying to multiple hosted services is simple, as you have a single deployment package. Just upload it to blob storage, then use it as the basis for your deployment to each hosted service. You'll just need to specify a different configuration file for each. This is why the configuration file is kept separate from the deployment package, as it allows you to update things like database connection strings without having to re-package your app.

# sql - 两个相似的 SQL 查询返回不同的结果

> ID：10721703
> 
> 赞同：-1
> 
> 时间：2012-05-23T14:09:01.430
> 
> 标签：sql

大家好，我有问题。

我有两个返回不同结果的 SQL 查询：

```
SELECT name, capacity, $price, licensed, cost 
FROM venue, catering WHERE venue.venue_id = catering.venue_id 
AND grade=$grade 
AND capacity >= $minCapacity
AND capacity <= $maxCapacity
AND venue.venue_id 
NOT IN (SELECT venue_id FROM venue_booking WHERE date_booked = $us_date) 
```

也

```
SELECT venue.venue_id,name,capacity,licensed,$price,cost
FROM venue
JOIN catering ON venue.venue_id = catering.venue_id
WHERE capacity BETWEEN '$minCapacity' AND '$maxCapacity' 
AND venue.venue_id NOT IN 
(SELECT venue_id
FROM venue_booking
WHERE date_booked = '$us_date')
AND catering.grade = '$grade' ORDER BY venue.capacity 
```

这里有什么区别？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T14:15:19.200

我的感觉..主要区别是-

在第一个查询中，您正在使用条件检查容量 -

```
AND capacity >= $minCapacity
AND capacity <= $maxCapacity 
```

这将作为数字 ..

但在第二个查询中，此条件在两个字符串值的范围内..

# spring-security - Websphere 7 - 通用匹配模式（'/**'）在其他模式之前定义

> ID：10721705
> 
> 赞同：2
> 
> 时间：2012-05-23T14:09:02.617
> 
> 标签：spring-security, spring-roo, websphere-7

我使用 Roo 生成了一个 spring 项目，并使用安全设置插件添加了 spring security。安全性在 Tomcat 7 上运行良好，但在尝试部署到 Websphere 7.0.0.19 时遇到以下问题。我目前正在使用 Spring Security 3.1.0.RELEASE。我已经看到其他项目在 Websphere 中使用 Spring DelegatingFilterProxy 就好了。有人有什么想法吗？

来自 StackTrace 的错误：

```
E org.springframework.web.context.ContextLoader initWebApplicationContext Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.security.filterChainProxy': Invocation of init method failed; nested exception is java.lang.IllegalArgumentException: A universal match pattern ('/**') is defined  before other patterns in the filter chain, causing them to be ignored. Please check the ordering in your <security:http> namespace or FilterChainProxy bean configuration 
```

applicationContext-security.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security" 
    xmlns:beans="http://www.springframework.org/schema/beans" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.1.xsd"> 

    <!-- HTTP security configurations -->
    <http auto-config="true" use-expressions="true" >
        <form-login login-processing-url="/resources/j_spring_security_check" login-page="/login" authentication-failure-url="/login?login_error=t" />
        <logout logout-url="/resources/j_spring_security_logout" />
        <!-- Configure these elements to secure URIs in your application -->
        <intercept-url pattern="/login" access="permitAll" />
        <intercept-url pattern="/admin/**" access="hasRole('ROLE_ADMIN')" />
        <intercept-url pattern="/jobtypes/**" access="isAuthenticated()" />
        <intercept-url pattern="/tests/**" access="permitAll" />
        <!-- Websphere Problem: IllegalArgumentException: A universal match pattern ('/**') is defined  before other patterns in the filter chain -->
        <intercept-url pattern="/resources/**" access="permitAll" />
        <intercept-url pattern="/**" access="hasRole('ROLE_USER')" />
    </http>

    <!-- Configure Authentication mechanism -->
    <beans:bean name="myCompanyAuthenticationProvider" class="edu.mycompany.project.security.MyCompanyAuthenticationProvider" />
    <authentication-manager alias="authenticationManager">
        <authentication-provider ref="myCompanyAuthenticationProvider" />
    </authentication-manager>   
</beans:beans> 
```

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T16:32:54.117

对于阅读本文（并寻找答案）的其他人，该问题被记录为[SEC-2034](https://jira.springsource.org/browse/SEC-2034)并被确定为无效。由于配置被拾取两次，因此出现此问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-15T12:37:16.390

有趣...我正在使用 Spring Security 3.1.0.RELEASE 并部署到 WAS 7，但我的任何应用程序都没有遇到问题。你和我之间唯一的细微差别是我不使用表达式。这是我的样子：-

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:security="http://www.springframework.org/schema/security"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                        http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd">

    <security:http auto-config="true">
        <security:form-login login-page="/" authentication-failure-url="/?login_error=1" default-target-url="/"
                             always-use-default-target="true"/>
        <security:logout logout-success-url="/" />
        <security:intercept-url pattern="/secure/**" access="ROLE_ADMIN,ROLE_USER"/>
        <security:intercept-url pattern="/**" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
    </security:http>

    ...

</beans> 
```

另一个关键区别是我的`/**`包罗万象是为匿名访问打开的，而你的仅限于 ROLE_USER。

# javascript - jQuery 切换 div

> ID：10721712
> 
> 赞同：1
> 
> 时间：2012-05-23T14:09:15.907
> 
> 标签：javascript, jquery

我在将一些 jQuery 实现到我正在做的页面中时遇到了一点问题。

我已经完成了我想要做的事情的一半，但我无法理解最后一部分。虽然我使用 jQuery 的片段已经有一段时间了，但在编写自己的代码时我还是很陌生。

基本上我希望通过单击相关链接打开默认隐藏的 4 个 Div，但任何时候都应该只显示一个 Div，因此如果 Div1 已打开，单击 Div2 按钮将关闭 Div1 并打开 Div2。

还有一个第 5 个按钮，打开 Div1 是没有打开的 Div，或者如果打开了任何 Div，则关闭该打开的 Div。

我一直在查看这些页面寻求帮助，但没有什么是我所追求的：

[http://css-tricks.com/forums/discussion/16451/.slidetoggle-one-div-a-time-problems-please-help/p1](http://css-tricks.com/forums/discussion/16451/.slidetoggle-one-div-a-time-problems-please-help/p1)

www.randomsnippets.com/2011/04/10/how-to-hide-show-or-toggle-your-div-with-jquery/

webdesignerwall.com/tutorials/jquery-tutorials-for-designers

目前我已经做到了，以便在单击按钮时显示 Div，但仅此而已，我无法使这些示例中的切换逻辑在我的代码上工作。

我在这里设置了一个 JSFiddle：http: [//jsfiddle.net/vx6qu/2/](http://jsfiddle.net/vx6qu/2/)

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:14:20.117

解决方案非常简单：

*   关闭一切，不管哪一个是打开的
*   只打开你需要的那个

```
var current = null;
var all = $(".togglediv");

function onClickOne() {
    all.hide();
    current = $("#one").show();
}
function onClickTwo() {
    all.hide();
    current = $("#two").show();
}
...

function onClickSpecial() {
    if (current) {
        all.hide();
        current = null;
    } else
        current = $("#one").show();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:15:25.043

我认为您正在寻找的是“隐藏”选择器，例如：

```
if( jqueryObject.is(':hidden') ) {
    // it's hidden
} else {
    // it's not
} 
```

这也适用于 is(':visible')

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:17:04.693

```
<div id='div1' style='display:none;'>Div 1</div>
<div id='div2' style='display:none;'>Div 2</div>
<div id='div3' style='display:none;'>Div 3</div>
<div id='div4' style='display:none;'>Div 4</div>

<a href='showDiv(1);'>Show Div 1</a>
<a href='showDiv(2);'>Show Div 2</a>
<a href='showDiv(3);'>Show Div 3</a>
<a href='showDiv(4);'>Show Div 4</a>

<script>
var showDiv = function(n) {
    var i;
    for (i = 1; i < 5; i++) {
        if (i == n)
            $('#div' + i).show();
        else
            $('#div' + i).hide();
    }    
}
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T14:25:38.790

你很接近，但有一种更清洁的方法：

[http://jsfiddle.net/jbabey/vx6qu/3/](http://jsfiddle.net/jbabey/vx6qu/3/)

```
$('#toggle-image').on('click', function () {
    if ($('.toggled').length === 0) {
        // none are open, open the first
        $('.toggle-content').eq(0).slideToggle().addClass('toggled');
    } else {
        // one is open, hide it
        $('.toggled').slideToggle().removeClass('toggled');
    }
});

$('li > a').on('click', function () {
    // extract the number
    var num = parseInt(this.id.replace('toggle-', ''), 10);

    // cancel the event if they clicked the link that is already open
    if ($('.toggle-content').eq(num - 1).hasClass('toggled')) {
        return false;    
    }

    // hide the old one
    $('.toggled').slideToggle().removeClass('toggled');

    // show the new one
    $('.toggle-content').eq(num - 1).slideToggle().addClass('toggled'); 
}); 
```

# javascript - 冲突的jquery 影响我的网站？

> ID：10721715
> 
> 赞同：0
> 
> 时间：2012-05-23T14:09:22.243
> 
> 标签：javascript, jquery, drop-down-menu

该站点是[VelocityMicro.com](http://www.velocitymicro.com)。我知道我今天早些时候尝试过发布，但在我记得输入代码之前我不小心点击了“提交”。所以如果这是你第二次看到这个问题，我保证我会更具体。

我的主要问题是下拉菜单适用于除三个页面之外的每个页面。 [Cruz.php](http://www.velocitymicro.com) /PC.php /velocityHPC.php

使这些页面与站点其他部分不同的唯一原因是它们是产品类别页面，并且在页面的中间，有类别细分选项卡。

我担心的是编码中的某个地方存在重叠，我必须使这些类别细分选项卡工作，从而使下拉菜单无法工作。

**JQUERY.JCAROUSEL.JS**

```
(function($) {
$.fn.jcarousel = function(o) {
    if (typeof o == 'string') {
        var instance = $(this).data('jcarousel'), args = Array.prototype.slice.call(arguments, 1);
        return instance[o].apply(instance, args);
    } else
        return this.each(function() {
            $(this).data('jcarousel', new $jc(this, o));
        });
};

// Default configuration properties.
var defaults = {
    vertical: false,
    rtl: false,
    start: 1,
    offset: 1,
    size: null,
    scroll: 3,
    visible: null,
    animation: 'normal',
    easing: 'swing',
    auto: 0,
    wrap: null,
    initCallback: null,
    reloadCallback: null,
    itemLoadCallback: null,
    itemFirstInCallback: null,
    itemFirstOutCallback: null,
    itemLastInCallback: null,
    itemLastOutCallback: null,
    itemVisibleInCallback: null,
    itemVisibleOutCallback: null,
    buttonNextHTML: '<div></div>',
    buttonPrevHTML: '<div></div>',
    buttonNextEvent: 'click',
    buttonPrevEvent: 'click',
    buttonNextCallback: null,
    buttonPrevCallback: null,
    itemFallbackDimension: null
}, windowLoaded = false;

$(window).bind('load.jcarousel', function() { windowLoaded = true; })

$.jcarousel = function(e, o) {
    this.options    = $.extend({}, defaults, o || {});

    this.locked     = false;

    this.container  = null;
    this.clip       = null;
    this.list       = null;
    this.buttonNext = null;
    this.buttonPrev = null;

    if (!o || o.rtl === undefined)
        this.options.rtl = ($(e).attr('dir') || $('html').attr('dir') || '').toLowerCase() == 'rtl';

    this.wh = !this.options.vertical ? 'width' : 'height';
    this.lt = !this.options.vertical ? (this.options.rtl ? 'right' : 'left') : 'top';

    var skin = '', split = e.className.split(' ');

    for (var i = 0; i < split.length; i++) {
        if (split[i].indexOf('jcarousel-skin') != -1) {
            $(e).removeClass(split[i]);
            skin = split[i];
            break;
        }
    }

    if (e.nodeName.toUpperCase() == 'UL' || e.nodeName.toUpperCase() == 'OL') {
        this.list = $(e);
        this.container = this.list.parent();

        if (this.container.hasClass('jcarousel-clip')) {
            if (!this.container.parent().hasClass('jcarousel-container'))
                this.container = this.container.wrap('<div></div>');

            this.container = this.container.parent();
        } else if (!this.container.hasClass('jcarousel-container'))
            this.container = this.list.wrap('<div></div>').parent();
    } else {
        this.container = $(e);
        this.list = this.container.find('ul,ol').eq(0);
    }

    if (skin != '' && this.container.parent()[0].className.indexOf('jcarousel-skin') == -1)
        this.container.wrap('<div class=" '+ skin + '"></div>');

    this.clip = this.list.parent();

    if (!this.clip.length || !this.clip.hasClass('jcarousel-clip'))
        this.clip = this.list.wrap('<div></div>').parent();

    this.buttonNext = $('.jcarousel-next', this.container);

    if (this.buttonNext.size() == 0 && this.options.buttonNextHTML != null)
        this.buttonNext = this.clip.after(this.options.buttonNextHTML).next();

    this.buttonNext.addClass(this.className('jcarousel-next'));

    this.buttonPrev = $('.jcarousel-prev', this.container);

    if (this.buttonPrev.size() == 0 && this.options.buttonPrevHTML != null)
        this.buttonPrev = this.clip.after(this.options.buttonPrevHTML).next();

    this.buttonPrev.addClass(this.className('jcarousel-prev'));

    this.clip.addClass(this.className('jcarousel-clip')).css({
        overflow: 'hidden',
        position: 'relative'
    });
    this.list.addClass(this.className('jcarousel-list')).css({
        overflow: 'hidden',
        position: 'relative',
        top: 0,
        margin: 0,
        padding: 0
    }).css((this.options.rtl ? 'right' : 'left'), 0);
    this.container.addClass(this.className('jcarousel-container')).css({
        position: 'relative'
    });
    if (!this.options.vertical && this.options.rtl)
        this.container.addClass('jcarousel-direction-rtl').attr('dir', 'rtl');

    var di = this.options.visible != null ? Math.ceil(this.clipping() / this.options.visible) : null;
    var li = this.list.children('li');

    var self = this;

    if (li.size() > 0) {
        var wh = 0, i = this.options.offset;
        li.each(function() {
            self.format(this, i++);
            wh += self.dimension(this, di);
        });

        this.list.css(this.wh, (wh + 100) + 'px');

        if (!o || o.size === undefined)
            this.options.size = li.size();
    }

    // For whatever reason, .show() does not work in Safari...
    this.container.css('display', 'block');
    this.buttonNext.css('display', 'block');
    this.buttonPrev.css('display', 'block');

    this.funcNext   = function() { self.next(); };
    this.funcPrev   = function() { self.prev(); };
    this.funcResize = function() { self.reload(); };

    if (this.options.initCallback != null)
        this.options.initCallback(this, 'init');

    if (!windowLoaded && $.browser.safari) {
        this.buttons(false, false);
        $(window).bind('load.jcarousel', function() { self.setup(); });
    } else
        this.setup();
};

var $jc = $.jcarousel;

$jc.fn = $jc.prototype = {
    jcarousel: '0.2.5'
};

$jc.fn.extend = $jc.extend = $.extend;

$jc.fn.extend({

    setup: function() {
        this.first     = null;
        this.last      = null;
        this.prevFirst = null;
        this.prevLast  = null;
        this.animating = false;
        this.timer     = null;
        this.tail      = null;
        this.inTail    = false;

        if (this.locked)
            return;

        this.list.css(this.lt, this.pos(this.options.offset) + 'px');
        var p = this.pos(this.options.start);
        this.prevFirst = this.prevLast = null;
        this.animate(p, false);

        $(window).unbind('resize.jcarousel', this.funcResize).bind('resize.jcarousel', this.funcResize);
    },

    reset: function() {
        this.list.empty();

        this.list.css(this.lt, '0px');
        this.list.css(this.wh, '10px');

        if (this.options.initCallback != null)
            this.options.initCallback(this, 'reset');

        this.setup();
    },

    reload: function() {
        if (this.tail != null && this.inTail)
            this.list.css(this.lt, $jc.intval(this.list.css(this.lt)) + this.tail);

        this.tail   = null;
        this.inTail = false;

        if (this.options.reloadCallback != null)
            this.options.reloadCallback(this);

        if (this.options.visible != null) {
            var self = this;
            var di = Math.ceil(this.clipping() / this.options.visible), wh = 0, lt = 0;
            this.list.children('li').each(function(i) {
                wh += self.dimension(this, di);
                if (i + 1 < self.first)
                    lt = wh;
            });

            this.list.css(this.wh, wh + 'px');
            this.list.css(this.lt, -lt + 'px');
        }

        this.scroll(this.first, false);
    },

    lock: function() {
        this.locked = true;
        this.buttons();
    },

    unlock: function() {
        this.locked = false;
        this.buttons();
    },

    size: function(s) {
        if (s != undefined) {
            this.options.size = s;
            if (!this.locked)
                this.buttons();
        }

        return this.options.size;
    },

    has: function(i, i2) {
        if (i2 == undefined || !i2)
            i2 = i;

        if (this.options.size !== null && i2 > this.options.size)
            i2 = this.options.size;

        for (var j = i; j <= i2; j++) {
            var e = this.get(j);
            if (!e.length || e.hasClass('jcarousel-item-placeholder'))
                return false;
        }

        return true;
    },

    get: function(i) {
        return $('.jcarousel-item-' + i, this.list);
    },

    add: function(i, s) {
        var e = this.get(i), old = 0, n = $(s);

        if (e.length == 0) {
            var c, e = this.create(i), j = $jc.intval(i);
            while (c = this.get(--j)) {
                if (j <= 0 || c.length) {
                    j <= 0 ? this.list.prepend(e) : c.after(e);
                    break;
                }
            }
        } else
            old = this.dimension(e);

        if (n.get(0).nodeName.toUpperCase() == 'LI') {
            e.replaceWith(n);
            e = n;
        } else
            e.empty().append(s);

        this.format(e.removeClass(this.className('jcarousel-item-placeholder')), i);

        var di = this.options.visible != null ? Math.ceil(this.clipping() / this.options.visible) : null;
        var wh = this.dimension(e, di) - old;

        if (i > 0 && i < this.first)
            this.list.css(this.lt, $jc.intval(this.list.css(this.lt)) - wh + 'px');

        this.list.css(this.wh, $jc.intval(this.list.css(this.wh)) + wh + 'px');

        return e;
    },

    remove: function(i) {
        var e = this.get(i);

        // Check if item exists and is not currently visible
        if (!e.length || (i >= this.first && i <= this.last))
            return;

        var d = this.dimension(e);

        if (i < this.first)
            this.list.css(this.lt, $jc.intval(this.list.css(this.lt)) + d + 'px');

        e.remove();

        this.list.css(this.wh, $jc.intval(this.list.css(this.wh)) - d + 'px');
    },

    next: function() {
        this.stopAuto();

        if (this.tail != null && !this.inTail)
            this.scrollTail(false);
        else
            this.scroll(((this.options.wrap == 'both' || this.options.wrap == 'last') && this.options.size != null && this.last == this.options.size) ? 1 : this.first + this.options.scroll);
    },

    prev: function() {
        this.stopAuto();

        if (this.tail != null && this.inTail)
            this.scrollTail(true);
        else
            this.scroll(((this.options.wrap == 'both' || this.options.wrap == 'first') && this.options.size != null && this.first == 1) ? this.options.size : this.first - this.options.scroll);
    },

    scrollTail: function(b) {
        if (this.locked || this.animating || !this.tail)
            return;

        var pos  = $jc.intval(this.list.css(this.lt));

        !b ? pos -= this.tail : pos += this.tail;
        this.inTail = !b;

        this.prevFirst = this.first;
        this.prevLast  = this.last;

        this.animate(pos);
    },

    scroll: function(i, a) {
        if (this.locked || this.animating)
            return;

        this.animate(this.pos(i), a);
    },

    pos: function(i) {
        var pos  = $jc.intval(this.list.css(this.lt));

        if (this.locked || this.animating)
            return pos;

        if (this.options.wrap != 'circular')
            i = i < 1 ? 1 : (this.options.size && i > this.options.size ? this.options.size : i);

        var back = this.first > i;

        var f = this.options.wrap != 'circular' && this.first <= 1 ? 1 : this.first;
        var c = back ? this.get(f) : this.get(this.last);
        var j = back ? f : f - 1;
        var e = null, l = 0, p = false, d = 0, g;

        while (back ? --j >= i : ++j < i) {
            e = this.get(j);
            p = !e.length;
            if (e.length == 0) {
                e = this.create(j).addClass(this.className('jcarousel-item-placeholder'));
                c[back ? 'before' : 'after' ](e);

                if (this.first != null && this.options.wrap == 'circular' && this.options.size !== null && (j <= 0 || j > this.options.size)) {
                    g = this.get(this.index(j));
                    if (g.length)
                        e = this.add(j, g.clone(true));
                }
            }

            c = e;
            d = this.dimension(e);

            if (p)
                l += d;

            if (this.first != null && (this.options.wrap == 'circular' || (j >= 1 && (this.options.size == null || j <= this.options.size))))
                pos = back ? pos + d : pos - d;
        }

        var clipping = this.clipping();
        var cache = [];
        var visible = 0, j = i, v = 0;
        var c = this.get(i - 1);

        while (++visible) {
            e = this.get(j);
            p = !e.length;
            if (e.length == 0) {
                e = this.create(j).addClass(this.className('jcarousel-item-placeholder'));

                c.length == 0 ? this.list.prepend(e) : c[back ? 'before' : 'after' ](e);

                if (this.first != null && this.options.wrap == 'circular' && this.options.size !== null && (j <= 0 || j > this.options.size)) {
                    g = this.get(this.index(j));
                    if (g.length)
                        e = this.add(j, g.clone(true));
                }
            }

            c = e;
            var d = this.dimension(e);
            if (d == 0) {
                throw new Error('jCarousel: No width/height set for items. This will cause an infinite loop. Aborting...');
            }

            if (this.options.wrap != 'circular' && this.options.size !== null && j > this.options.size)
                cache.push(e);
            else if (p)
                l += d;

            v += d;

            if (v >= clipping)
                break;

            j++;
        }

        for (var x = 0; x < cache.length; x++)
            cache[x].remove();

        if (l > 0) {
            this.list.css(this.wh, this.dimension(this.list) + l + 'px');

            if (back) {
                pos -= l;
                this.list.css(this.lt, $jc.intval(this.list.css(this.lt)) - l + 'px');
            }
        }

        var last = i + visible - 1;
        if (this.options.wrap != 'circular' && this.options.size && last > this.options.size)
            last = this.options.size;

        if (j > last) {
            visible = 0, j = last, v = 0;
            while (++visible) {
                var e = this.get(j--);
                if (!e.length)
                    break;
                v += this.dimension(e);
                if (v >= clipping)
                    break;
            }
        }

        var first = last - visible + 1;
        if (this.options.wrap != 'circular' && first < 1)
            first = 1;

        if (this.inTail && back) {
            pos += this.tail;
            this.inTail = false;
        }

        this.tail = null;
        if (this.options.wrap != 'circular' && last == this.options.size && (last - visible + 1) >= 1) {
            var m = $jc.margin(this.get(last), !this.options.vertical ? 'marginRight' : 'marginBottom');
            if ((v - m) > clipping)
                this.tail = v - clipping - m;
        }

        // Adjust position
        while (i-- > first)
            pos += this.dimension(this.get(i));

        // Save visible item range
        this.prevFirst = this.first;
        this.prevLast  = this.last;
        this.first     = first;
        this.last      = last;

        return pos;
    },

    animate: function(p, a) {
        if (this.locked || this.animating)
            return;

        this.animating = true;

        var self = this;
        var scrolled = function() {
            self.animating = false;

            if (p == 0)
                self.list.css(self.lt,  0);

            if (self.options.wrap == 'circular' || self.options.wrap == 'both' || self.options.wrap == 'last' || self.options.size == null || self.last < self.options.size)
                self.startAuto();

            self.buttons();
            self.notify('onAfterAnimation');

            if (self.options.wrap == 'circular' && self.options.size !== null)
                for (var i = self.prevFirst; i <= self.prevLast; i++)
                    if (i !== null && !(i >= self.first && i <= self.last) && (i < 1 || i > self.options.size))
                        self.remove(i);
        };

        this.notify('onBeforeAnimation');

        // Animate
        if (!this.options.animation || a == false) {
            this.list.css(this.lt, p + 'px');
            scrolled();
        } else {
            var o = !this.options.vertical ? (this.options.rtl ? {'right': p} : {'left': p}) : {'top': p};
            this.list.animate(o, this.options.animation, this.options.easing, scrolled);
        }
    },

    startAuto: function(s) {
        if (s != undefined)
            this.options.auto = s;

        if (this.options.auto == 0)
            return this.stopAuto();

        if (this.timer != null)
            return;

        var self = this;
        this.timer = setTimeout(function() { self.next(); }, this.options.auto * 2000);
    },

    stopAuto: function() {
        if (this.timer == null)
            return;

        clearTimeout(this.timer);
        this.timer = null;
    },

    buttons: function(n, p) {
        if (n == undefined || n == null) {
            var n = !this.locked && this.options.size !== 0 && ((this.options.wrap && this.options.wrap != 'first') || this.options.size == null || this.last < this.options.size);
            if (!this.locked && (!this.options.wrap || this.options.wrap == 'first') && this.options.size != null && this.last >= this.options.size)
                n = this.tail != null && !this.inTail;
        }

        if (p == undefined || p == null) {
            var p = !this.locked && this.options.size !== 0 && ((this.options.wrap && this.options.wrap != 'last') || this.first > 1);
            if (!this.locked && (!this.options.wrap || this.options.wrap == 'last') && this.options.size != null && this.first == 1)
                p = this.tail != null && this.inTail;
        }

        var self = this;

        this.buttonNext[n ? 'bind' : 'unbind'](this.options.buttonNextEvent + '.jcarousel', this.funcNext)[n ? 'removeClass' : 'addClass'](this.className('jcarousel-next-disabled')).attr('disabled', n ? false : true);
        this.buttonPrev[p ? 'bind' : 'unbind'](this.options.buttonPrevEvent + '.jcarousel', this.funcPrev)[p ? 'removeClass' : 'addClass'](this.className('jcarousel-prev-disabled')).attr('disabled', p ? false : true);

        if (this.options.buttonNextCallback != null && this.buttonNext.data('jcarouselstate') != n) {
            this.buttonNext.each(function() { self.options.buttonNextCallback(self, this, n); }).data('jcarouselstate', n);
        }

        if (this.options.buttonPrevCallback != null && (this.buttonPrev.data('jcarouselstate') != p)) {
            this.buttonPrev.each(function() { self.options.buttonPrevCallback(self, this, p); }).data('jcarouselstate', p);
        }
    },

    notify: function(evt) {
        var state = this.prevFirst == null ? 'init' : (this.prevFirst < this.first ? 'next' : 'prev');

        // Load items
        this.callback('itemLoadCallback', evt, state);

        if (this.prevFirst !== this.first) {
            this.callback('itemFirstInCallback', evt, state, this.first);
            this.callback('itemFirstOutCallback', evt, state, this.prevFirst);
        }

        if (this.prevLast !== this.last) {
            this.callback('itemLastInCallback', evt, state, this.last);
            this.callback('itemLastOutCallback', evt, state, this.prevLast);
        }

        this.callback('itemVisibleInCallback', evt, state, this.first, this.last, this.prevFirst, this.prevLast);
        this.callback('itemVisibleOutCallback', evt, state, this.prevFirst, this.prevLast, this.first, this.last);
    },

    callback: function(cb, evt, state, i1, i2, i3, i4) {
        if (this.options[cb] == undefined || (typeof this.options[cb] != 'object' && evt != 'onAfterAnimation'))
            return;

        var callback = typeof this.options[cb] == 'object' ? this.options[cb][evt] : this.options[cb];

        if (!$.isFunction(callback))
            return;

        var self = this;

        if (i1 === undefined)
            callback(self, state, evt);
        else if (i2 === undefined)
            this.get(i1).each(function() { callback(self, this, i1, state, evt); });
        else {
            for (var i = i1; i <= i2; i++)
                if (i !== null && !(i >= i3 && i <= i4))
                    this.get(i).each(function() { callback(self, this, i, state, evt); });
        }
    },

    create: function(i) {
        return this.format('<li></li>', i);
    },

    format: function(e, i) {
        var e = $(e), split = e.get(0).className.split(' ');
        for (var j = 0; j < split.length; j++) {
            if (split[j].indexOf('jcarousel-') != -1) {
                e.removeClass(split[j]);
            }
        }
        e.addClass(this.className('jcarousel-item')).addClass(this.className('jcarousel-item-' + i)).css({
            'float': (this.options.rtl ? 'right' : 'left'),
            'list-style': 'none'
        }).attr('jcarouselindex', i);
        return e;
    },

    className: function(c) {
        return c + ' ' + c + (!this.options.vertical ? '-horizontal' : '-vertical');
    },

    dimension: function(e, d) {
        var el = e.jquery != undefined ? e[0] : e;

        var old = !this.options.vertical ?
            (el.offsetWidth || $jc.intval(this.options.itemFallbackDimension)) + $jc.margin(el, 'marginLeft') + $jc.margin(el, 'marginRight') :
            (el.offsetHeight || $jc.intval(this.options.itemFallbackDimension)) + $jc.margin(el, 'marginTop') + $jc.margin(el, 'marginBottom');

        if (d == undefined || old == d)
            return old;

        var w = !this.options.vertical ?
            d - $jc.margin(el, 'marginLeft') - $jc.margin(el, 'marginRight') :
            d - $jc.margin(el, 'marginTop') - $jc.margin(el, 'marginBottom');

        $(el).css(this.wh, w + 'px');

        return this.dimension(el);
    },

    clipping: function() {
        return !this.options.vertical ?
            this.clip[0].offsetWidth - $jc.intval(this.clip.css('borderLeftWidth')) - $jc.intval(this.clip.css('borderRightWidth')) :
            this.clip[0].offsetHeight - $jc.intval(this.clip.css('borderTopWidth')) - $jc.intval(this.clip.css('borderBottomWidth'));
    },

    index: function(i, s) {
        if (s == undefined)
            s = this.options.size;

        return Math.round((((i-1) / s) - Math.floor((i-1) / s)) * s) + 1;
    }
});

$jc.extend({
    /**
     * Gets/Sets the global default configuration properties.
     *
     * @method defaults
     * @return {Object}
     * @param d {Object} A set of key/value pairs to set as configuration properties.
     */
    defaults: function(d) {
        return $.extend(defaults, d || {});
    },

    margin: function(e, p) {
        if (!e)
            return 0;

        var el = e.jquery != undefined ? e[0] : e;

        if (p == 'marginRight' && $.browser.safari) {
            var old = {'display': 'block', 'float': 'none', 'width': 'auto'}, oWidth, oWidth2;

            $.swap(el, old, function() { oWidth = el.offsetWidth; });

            old['marginRight'] = 0;
            $.swap(el, old, function() { oWidth2 = el.offsetWidth; });

            return oWidth2 - oWidth;
        }

        return $jc.intval($.css(el, p));
    },

    intval: function(v) {
        v = parseInt(v);
        return isNaN(v) ? 0 : v;
    }
});

})(jQuery); 
```

**JQUERY.SLIDE.JS**

```
(function($) {

$.fn.slide = function(settings){
    var _link = $(this);
    var _parent = _link.parent();
    var _slide_selector = settings.slide_selector;
    var _auto = settings.auto || false;
    var _time = settings.time || 5000;

    var _index = 0;
    var _max_index = $(this).length;
    var _interval;

    _link.click(function(){
        _index = _link.parent().find('a').index(this);

        if( _auto ) {
            _clear_interval();
            _set_interval();
        }

        _set_index();

        return false;
    });

    function _set_index(){
        _link.removeClass('active');
        _link.eq(_index).addClass('active');

        $(_slide_selector).hide();
        $(_slide_selector).eq(_index).fadeIn();

    }

    function _set_interval() {
        _interval = window.setInterval(_next, _time);
    }

    function _clear_interval(){
        window.clearInterval(_interval);
    }

    function _next(){
        _index++;
        if( _index == _max_index ) {
            _index = 0;
        }

        _set_index();
    }

    _set_index();

    if( _auto ) {
        _set_interval();
    }
}

})(jQuery); 
```

**EASYSLIDER1.5.JS**

```
(function($) {
easySlider = function(options){
    var defaults = {
        speed:          10,
        pause:          10,
        continuous:     true
    };

    var options = $.extend(defaults, options);        
    var s;
    var w ;       
    var ts;
    var t = 0;

    $(".arrow-right").click(function(){            
        animateClick("next");
        return false;
    });
    $(".arrow-left").click(function(){
        animateClick("prev");
        return false;
    });

    function animateClick(dir){
         var src= $('.project .main-image-holder, .project-item.active .image-holder');
        s = $("li", src).length;
        ts = s-1;
        w = $("li", src).width();

        src.find('li').removeClass('active');

        var ot = t;
        switch(dir){
            case "next":
                t = (ot>=ts) ? (options.continuous ? 0 : ts) : t+1;
                break;
            case "prev":
                t = (t<=0) ? (options.continuous ? ts : 0) : t-1;
                break;
            default:
                break;
        };
        src.find('li').eq(t).addClass('active');
        var diff = Math.abs(ot-t);
        var speed = diff*options.speed;

        if(!options.vertical) {
            p = (t*w*-1);
            src.find("ul").animate(
            {
                marginLeft: p
            }, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:43:36.407

这三个页面不包括`js-func.js`用于初始化下拉菜单的 your 。

我不知道你对 Javascript 的精通程度；如果您只需要一个有效的快速解决方案，请尝试以下操作：

1.  编辑文件`jquery-func.js`
2.  将以下内容粘贴到第 2 行，紧随其后`$( document ).ready( function(){`：

    ```
    $('#navigation ul li').hover(function(){ 
      $(this).find('a:eq(0)').addClass('hover');
      $(this).find('.dd-holder:eq(0)').show();
    },function(){ 
      $(this).find('a:eq(0)').removeClass('hover');
      $(this).find('.dd-holder:eq(0)').hide();
    }); 
    ```

    并再次从三个页面中删除 js_func.js。

# scrollview - 索尼平板电脑键盘弹出问题

> ID：10721716
> 
> 赞同：1
> 
> 时间：2012-05-23T14:09:30.093
> 
> 标签：scrollview, android-activity, android, sony

有没有人知道如何解决索尼平板电脑 S 上一个非常烦人的问题。

我有一个垂直的 ScrollView 和一个带有很多 TextViews 和一些 EditTexts 的线性布局。当我向下滚动屏幕并看到 EditText 时，设备决定赋予 EditText 焦点并弹出键盘。

这不会发生在其他设备上，例如 Asus Transformer Prime、HTC One X、Samsung Galaxy Tab 和 HP TouchPad (cyanogenmod)。

我做过的事情。

*   Windows 软输入模式在活动的清单中设置为“stateHidden”。
*   堆栈顶部有一个 LinearLayout，它的可聚焦和可聚焦触摸设置为 true。
*   该代码还将将此布局重点放在创建上。

这绝对似乎是索尼平板电脑特有的问题！

其他人有这个问题和解决方案吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-31T14:56:39.567

我刚刚安装了 ICS 更新。现在问题已经消失了！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T14:31:05.520

在 EditText 上添加一个 eventListener，当它获得焦点然后隐藏键盘

通过使用这个：

```
InputMethodManager mgr = (InputMethodManager) getSystemService(
    Context.INPUT_METHOD_SERVICE);
mgr.hideSoftInputFromWindow(editText.getWindowToken(), 0); 
```

* * *

要获得焦点增益事件，请使用此功能

```
imageView.setOnFocusChangeListener(
    new OnFocusChangeListener() {
        public void onFocusChange(View arg0, boolean arg1) {
            // hide the keyboard using above code
            InputMethodManager mgr = (InputMethodManager) getSystemService(
                Context.INPUT_METHOD_SERVICE);
            mgr.hideSoftInputFromWindow(editText.getWindowToken(), 0);
        }
    }); 
```

希望它会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-07T18:51:02.447

尝试在视图上发布可运行文件。

```
editText.post(new Runnable() {
   @Override
   public void run() {
      InputMethodManager mgr = (InputMethodManager) getSystemService(
            Context.INPUT_METHOD_SERVICE);
        mgr.hideSoftInputFromWindow(editText.getWindowToken(), 0);
   }
}); 
```

# android - Android：从作为参数传入的 Context 实例调用 startActivity

> ID：10721718
> 
> 赞同：0
> 
> 时间：2012-05-23T14:09:38.287
> 
> 标签：android, service, android-activity

我有一个服务，它的一个实例作为参数传递给另一个对象的构造函数。然后我调用该上下文实例的 startActivity。这样做时，我的应用程序由于异常而关闭。它不会被我的 try catch 块捕获。

```
public class TestService extends Service{
    public int onStartCommand(Intent intent, int flags, int startId){
       TestClass test = new Test(this);
    }

}

public class TestClass{
    private TestService testService;

    public TestClass(TestService testService){
      this.testService = testService;
    }

    public void startAct(){
      Intent i = new Intent(Settings.ATION_WIFI_SETTINGS);
      i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
      testService.startActivity(i);
    }
} 
```

log ca 的输出如下...

```
05-23 19:35:17.570: E/AndroidRuntime(15877): FATAL EXCEPTION: main
05-23 19:35:17.570: E/AndroidRuntime(15877): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com/com.facade.ServicesFacade$ShuntActivity}: java.lang.InstantiationException: com.facade.ServicesFacade$ShuntActivity
05-23 19:35:17.570: E/AndroidRuntime(15877):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2709)
05-23 19:35:17.570: E/AndroidRuntime(15877):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2803)
05-23 19:35:17.570: E/AndroidRuntime(15877):    at android.app.ActivityThread.access$2300(ActivityThread.java:135)
05-23 19:35:17.570: E/AndroidRuntime(15877):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2136)
05-23 19:35:17.570: E/AndroidRuntime(15877):    at android.os.Handler.dispatchMessage(Handler.java:99)
05-23 19:35:17.570: E/AndroidRuntime(15877):    at android.os.Looper.loop(Looper.java:144)
05-23 19:35:17.570: E/AndroidRuntime(15877):    at android.app.ActivityThread.main(ActivityThread.java:4937)
05-23 19:35:17.570: E/AndroidRuntime(15877):    at java.lang.reflect.Method.invokeNative(Native Method)
05-23 19:35:17.570: E/AndroidRuntime(15877):    at java.lang.reflect.Method.invoke(Method.java:521)
05-23 19:35:17.570: E/AndroidRuntime(15877):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
05-23 19:35:17.570: E/AndroidRuntime(15877):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
05-23 19:35:17.570: E/AndroidRuntime(15877):    at dalvik.system.NativeStart.main(Native Method)
05-23 19:35:17.570: E/AndroidRuntime(15877): Caused by: java.lang.InstantiationException: com.facade.ServicesFacade$ShuntActivity
05-23 19:35:17.570: E/AndroidRuntime(15877):    at java.lang.Class.newInstanceImpl(Native Method)
05-23 19:35:17.570: E/AndroidRuntime(15877):    at java.lang.Class.newInstance(Class.java:1429)
05-23 19:35:17.570: E/AndroidRuntime(15877):    at android.app.Instrumentation.newActivity(Instrumentation.java:1036)
05-23 19:35:17.570: E/AndroidRuntime(15877):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2701)
05-23 19:35:17.570: E/AndroidRuntime(15877):    ... 11 more 
```

我究竟做错了什么 ？

# jquery - 由于 paddingRight 和 parseInt() 导致的 IE8 jQuery 无效参数

> ID：10721722
> 
> 赞同：0
> 
> 时间：2012-05-23T14:09:54.780
> 
> 标签：jquery, internet-explorer, cross-browser

## 问题：

调试我的站点时出现无效参数错误。该错误仅在将鼠标悬停在手风琴菜单项上时发生。经过进一步检查，我发现了可能导致此问题的代码，这在我下面的问题中。（见更新#2）。

我不知道具体是什么导致了错误，或者如何解决它.. HALPS

**它突出显示的代码行是：** `a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now`

我想不通..我讨厌 IE8 :)

* * *

## 更新#1

我将我的问题追溯到使用我从 ThemeForest 下载的这个管理模板预先构建的可折叠导航。

**我在“Accordian Menu”的代码中发现了一些东西：**

[https://gist.github.com/48d7ffcc654ce24040c5](https://gist.github.com/48d7ffcc654ce24040c5)

**以及用于初始化菜单的这段代码：**

```
/*
 * Accordion Menu
 */
$('.menu').initMenu(); 
```

## 更新#2

进一步检查显示 IE8 开发工具将其置于**Locals**下：

`Prop "PaddingRight" String`

然后我偶然发现了要点的第二个函数中的一行：

```
 $(this).hover(
            function() {
                $(this).animate({
                    paddingLeft:parseInt(padding_left) + parseInt(5) + "px",
                    paddingRight: parseInt(padding_right) - parseInt(5) + "px"
                }, 130);
            },
            function() {
                bc_hover = $(this).css("background-color");
                $(this).animate({
                    paddingLeft: padding_left,
                    paddingRight: padding_right
                }, 130);
            } 
```

## 更新#3

这是我尝试过的代码的jsfiddle，在jsfiddle中我无法复制问题。[http://jsfiddle.net/7Y68Y/6/](http://jsfiddle.net/7Y68Y/6/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-29T02:20:31.247

这种错误在干预 CSS 时很常见。如果一个 CSS 属性被赋予了错误的值，IE 会抱怨它。

**更新**

OP忘记提及`padding_left`之前宣布为`$(this).css('padding-left')`

在这种情况下，您应该注意空字符串；例如：

```
$('<div />').css('padding-left') == ''
parseInt('') == NaN 
```

有了这些知识，让我们更改分配：

```
var padding_left = $(this).css("padding-left");
var padding_right = $(this).css("padding-right"); 
```

要将它们转换为正确的整数：

```
var padding_left = parseInt($(this).css('padding-left') || 0);
var padding_right = parseInt($(this).css("padding-right") || 0); 
```

那么让我们回到动画代码：

```
$(this).animate({
    paddingLeft: parseInt(padding_left) + parseInt(5) + "px",
    paddingRight: parseInt(padding_right) - parseInt(5) + "px"
}, 130); 
```

假设原始填充也是`px`单位。在这种情况下，我们可以将语句简化为：

```
$(this).animate({
    paddingLeft: (padding_left + 5) + "px",
    paddingRight: (padding_right - 5) + "px"
}, 130); 
```

和另外一个：

```
$(this).animate({
    paddingLeft: padding_left + "px",
    paddingRight: padding_right + "px"
}, 130); 
```

# javascript - 在 Jquery 中切换时如何更改前置文本？

> ID：10721723
> 
> 赞同：0
> 
> 时间：2012-05-23T14:09:58.697
> 
> 标签：javascript, jquery, toggle, prepend

我有一些使用 Jquery 切换功能显示/隐藏的内容。

我为每个标题添加了一个箭头，并希望在切换内容时将前置箭头更改为向下箭头。

到目前为止的代码：

```
$(document).ready(function(){
    $('.show-hide-list h3 a').prepend('&gt;&nbsp;');//Prepend arrow
    $('.show-hide-list li .show-hide-list-content').hide();//Hide content
    $('.show-hide-list h3').click(function() {//Perform toggle when clicked
        $(this).next('.show-hide-list-content').toggle();
        //Need to change orientation of prepended arrow when toggled
        return false;
    });
}); 
```

html如下：

```
<ul class="show-hide-list">
<li>
       <h3><a href="#">Heading</a></h3>
   <div class="show-hide-list-content">
           Content to be toggled here.
       </div>
    </li>
 </ul> 
```

切换后如何更改箭头方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:21:34.873

将箭头包裹在 span 标签中，以便您轻松选择它。

```
$(document).ready(function(){
    $('.show-hide-list h3 a').prepend('<span>&gt;&nbsp;</span>');//Prepend arrow
    $('.show-hide-list li .show-hide-list-content').hide();//Hide content
    $('.show-hide-list h3').click(function() {//Perform toggle when clicked
        $(this).next('.show-hide-list-content').toggle();
        var arrow = $(this).find('span');

        if (arrow.text().indexOf('V') >= 0) {
            arrow.html('&gt;&nbsp;');  
        } else {
            arrow.html('V&nbsp;');
        }
        //Need to change orientation of prepended arrow when toggled
        return false;
    });
}); ​ 
```

[http://jsfiddle.net/6DB7t/1/](http://jsfiddle.net/6DB7t/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:22:49.173

假设您的用户的浏览器支持它，您可以将一个类应用于该箭头。从一些这样的 CSS 开始：

```
-webkit-transform: rotate(-270deg); 
-moz-transform: rotate(-270deg); 
```

或者只是切换向下箭头图像的可见性，这适用于任何现代浏览器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:21:13.903

只需将箭头放在 a 中`<span>`并给它一个适当的类，以便您以后可以再次找到它：例如：

```
$(document).ready(function(){

$('.show-hide-list h3 a').prepend('<span class="togglearrow">&gt;&nbsp;</span>');
//Prepend arrow
$('.show-hide-list li .show-hide-list-content').hide();//Hide content
$('.show-hide-list h3').click(function() {//Perform toggle when clicked
    $(this).next('.show-hide-list-content').toggle();

    $(this).parent().find('.togglearrow').html('V ');
    //V represents downward arrow

    //Need to change orientation of prepended arrow when toggled
    return false;
});

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T14:22:24.500

`prepend`我建议不要使用`:before`pseduo 选择器或 a`background-image`来创建箭头。这是一个展示性的东西，所以它真的应该由 CSS 来处理。

**使用`:before`pseduo 选择器的**实时功能示例-** [http://jsfiddle.net/Nfw7y/](http://jsfiddle.net/Nfw7y/)**

 **如果您需要更多地控制箭头的外观，我建议您使用 a`background-image`或[icon font](http://css-tricks.com/using-fonts-for-icons/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-23T14:26:24.967

你可以简单地拥有

```
$('.show-hide-list h3 a').html( $('.show-hide-list h3 a').html().replace('&gt;', 'V') ); 
```**

# sql-server-2008 - SQL 函数 - 日志记录

> ID：10721726
> 
> 赞同：4
> 
> 时间：2012-05-23T14:10:03.220
> 
> 标签：sql-server-2008, debugging, function

> **可能重复：**
> [TSQL 如何在用户定义的函数中输出 PRINT？](https://stackoverflow.com/questions/586642/tsql-how-do-you-output-print-in-a-user-defined-function)

这真让我抓狂。

我有一个正在尝试调试的函数，但我无法插入表、执行打印语句，甚至无法从中引发错误。

SQL 返回消息

> 在函数中无效使用具有副作用的运算符“PRINT”。

我该如何调试这个，我只想知道一个变量在运行时的值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T14:23:50.337

尝试：

```
DECLARE @ExecuteString   varchar(500)
       ,@Yourtext        varchar(500)

@ExecuteString = 'echo  '+@Yourtext+' > yourfile.txt)

exec master..xp_cmdshell @ExecuteString, no_output 
```

使用：“>”创建/覆盖文件，“>>”创建/附加到文件。你可能需要用来`REPLACE(@Yourtext,'&','^&')`转义`&`字符

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T14:20:59.657

如果你的函数返回一个字符串，你总是可以插入一个返回，例如

```
ALTER FUNCTION dbo.whatever()
RETURNS NVARCHAR(128)
AS
BEGIN
  DECLARE @foo VARCHAR(128);

  SELECT TOP (1) @foo = name FROM sys.objects ORDER BY NEWID();

  -- temporary debug:
  RETURN (@foo);

  ... continue with function
END
GO 
```

如果变量是数字或日期，您可以先使用 RTRIM() 或 CONVERT() 将其安全地转换为字符串。

您可以使用表值函数执行类似的操作，只需添加一列，您可以在其中放置要输出的任何调试消息或变量。

# javascript - “你接受条款和条件吗？” 关于登录表单身份验证 MVC3

> ID：10721727
> 
> 赞同：2
> 
> 时间：2012-05-23T14:10:07.893
> 
> 标签：javascript, jquery, asp.net-mvc-3, login, dialog

我正在努力在登录时出现登录对话框。我需要做的是当用户使用内置的 MVC3 身份验证控件登录时，我需要它弹出一个对话框，吐出一些条款和协议，并说“如果你点击接受，你同意上述内容”。我目前有，但是当我点击取消时，该网站仍然会登录。这是我的代码：

```
<fieldset>
    <legend>Login</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.userName)
        </div>
        <div class="focus">
            <div class="editor-field">
                @Html.EditorFor(model => model.userName)
            </div>
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.passWord)
        </div>
        <div class="editor-field">
            @Html.PasswordFor(model => model.passWord)
        </div>

        <p>
            <input type="submit" value="Login" name="btnLogin" id="btnLogin" />
        </p>
        @Html.ValidationSummary(true)

</fieldset> 
```

还有我拥有的Javascript：

```
 <script type="text/javascript">
        $(function () {
            $("#btnLogin").click(function () {
                var answer = confirm("Unauthorized access or use of the web content is prohibited.\n" + "By clicking 'OK', you have agreed to the above conditions");
                if (answer) {
                }
                else {
                    $(this).dialog("close");
                }
            });
        });
    </script> 
```

当用户点击对话框上的取消并在他们点击确定时继续登录时，我将如何让它在登录时取消 HttpPost？

非常感激！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T14:15:12.867

在你的事件处理程序中添加这个

```
 $("#btnLogin").click(function (event) {
     var answer = confirm("Unauthorized access or use of the web content is prohibited.\n" + "By clicking 'OK', you have agreed to the above conditions");
     if (answer) {

     }
     else{
          $(this).dialog("close");
          event.preventDefault();
     }
 }); 
```

添加 `event.preventDefault();`您确保防止表单的默认行为

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:15:32.280

为确保这是经过验证的服务器端以及客户端使用此技术，工作完美。如果您只依赖 javascript，那么其他人仍然可以通过绕过它来登录您。

为您的模型添加一个`bool`名为的新属性`AcceptTerms`

```
[Display(Name = "Accept Terms and Conditions")]
[IsTrue]
public bool AcceptTerms { get; set; } 
```

在你看来

```
@Html.LabelFor(model => model.AcceptTerms) </br>
@Html.CheckBoxFor(model => model.AcceptTerms) </br>
@Html.ValidationFor(model => model.AcceptTerms) 
```

创建一个新属性，以便您可以验证它是否已被选中

```
public class IsTrueAttribute : ValidationAttribute
{
    public override bool IsValid(object value)
    {
        if (value == null) return false;
        if (value.GetType() != typeof(bool)) throw new InvalidOperationException("can only be used on boolean properties.");

        return (bool) value == true;
    }
} 
```

# java - 是否可以检测访客 DNS 服务器？

> ID：10721731
> 
> 赞同：9
> 
> 时间：2012-05-23T14:10:15.263
> 
> 标签：java, php, javascript, jquery, dns

检测访问者 IP 很容易。但是如何检测访问者的 DNS 服务器 ips 呢？

![](../Images/e73de3f80d612732203a3a318111103f.png)

我找到了这个 PHP 函数，但是它只找到域名的 DNS。

```
dns_get_record("website.com", DNS_ANY); 
```

是否可以检测访客 DNS 服务器？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-12-17T00:14:51.683

是的，您可以，例如检测访问者的页面分辨率。

您需要自己的 DNS 服务器并强制用户解析唯一的 dns 名称。如果用户试图解决它，那么他们将泄漏到您的 DNS 服务器自己的 DNS 服务器地址。在 DNS 服务器旁边必须分享谁询问了您的网络应用程序的唯一 dns 名称的信息。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-01-09T12:36:16.623

这并不容易，但可以做到。Adam Dobrawy 在[http://ipleak.net/的单独回答中展示了该方法的演示](http://ipleak.net/)

要添加一些细节，您可以实现这样的方式是：

第 1 部分 - 在 myspecialdomain.com 上设置您自己的 DNS 服务器

此 DNS 服务器需要自定义写入以记录和存储传入请求和源 IP 地址。这种存储只需要很短的时间，所以像 memcache 这样的东西可能会很好地工作。DNS 响应应该是 NXDOMAIN。

第 2 部分 - 您的客户端代码

在您的 Javscript 中制作并存储一个大的随机数。让浏览器查找 .myspecialdomain.com。通过带有错误处理程序的 JS img 标签加载它。在该错误处理程序中，现在对传递随机数的服务器端代码进行查询。

第 3 部分 - 您的 Web 应用程序（服务器端）

您需要实现一些服务器端逻辑来获取随机字符串，在数据存储中查找它，并检索 DNS 服务器的 IP 地址。请注意，此处的 IP 地址将是特定服务器的 IP 单播地址，而不是像 8.8.8.8 这样的 IP 任播地址。在这里，您可以使用 GeoIP 或 Whois 数据库来确定该 IP 地址的所有者（OpenDNS、Google 等）。然后，您可以生成响应以发送到客户端逻辑。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T14:13:54.017

DNS 解析不是请求本身的一部分，这意味着请求的接收者无法知道客户端（浏览器）使用了哪个 DNS。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-23T14:17:53.257

DNS 请求首先发生，因为需要将主机名解析为 IP 地址。完成后，将对相关地址执行单独的请求。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-05-23T14:23:16.117

答案是不。服务器得到的只是与访问者的 TCP 连接，即 [IP, Port] 对。DNS 解析取决于访问者的本地配置，可以通过代理完成。

# php - CodeIgniter form_multiselect

> ID：10721733
> 
> 赞同：4
> 
> 时间：2012-05-23T14:10:25.203
> 
> 标签：php, codeigniter

我有一个填充的 CodeIgniter form_multiselect。里面有价值观

代码如下：

```
<select multiple="multiple" name="EMPLOYEES_id[]">
 <option value="8">Employee 8</option>
 <option value="1">Employee 1</option>
 <option value="12">Employee 12</option>
</select> 
```

这在您可以向多个用户发送消息的系统上运行。所以我想做的是说用户选择值 1 和值 8。我想运行两个具有相同数据的插入，但唯一的区别是数据库中的 EMPLOYEES_id 字段每次都不同。

我的模型如下：

```
function create()
{
    $this->template->set('title', 'Create Message');

    // Validate the form input
    $this->form_validation->set_error_delimiters('<span class="help-inline">', '</span>');
    $this->form_validation->set_rules('MESSAGE_summary', 'Message Summary', 'trim|required|xss_clean');
    $this->form_validation->set_rules('MESSAGE_body', 'Message Body', 'trim|required|xss_clean');

    if($this->form_validation->run() == FALSE)
    {

        // Get all users in same company as logged in user
        $comapny_contacts = $this->Employees_model->read_company_contacts($this->viewinguser->BUSINESSES_id);
        $comapny_contacts = $comapny_contacts->result();

        foreach($comapny_contacts as $contacts)
        {
            $comapny_contacts_options[$contacts->EMPLOYEES_id] = $contacts->EMPLOYEES_firstname . ' ' . $contacts->EMPLOYEES_surname;
        }

        $this->template->set('comapny_contacts_options', $comapny_contacts_options);

        // form has not been run or there are validation errors
        $this->template->build('messages/create');
    }
    else
    {

        /*
         * Lets create the new message in the database
         */
        $insert_data = new stdClass();
        $insert_data->MESSAGES_summary = $this->input->post('MESSAGE_summary');
        $insert_data->MESSAGES_body = $this->input->post('MESSAGE_body');
        $insert_data->MESSAGES_level = $this->input->post('MESSAGES_level');
        $insert_data->MESSAGES_type = $this->input->post('MESSAGES_type');
        $insert_data->MESSAGES_createdby = $this->activeuser->EMPLOYEES_id;
        //$insert_data->EMPLOYEES_id = $this->input->post('EMPLOYEES_id');
        foreach($this->input->post('EMPLOYEES_id') as $employee_id)
        {
            $insert_data->EMPLOYEES_id = $employee_id;

            // Save to new message in the database
            $this->Messages_model->create($insert_data);
        }

        /*
         * Now lets save a notification email in the database to be sent to the user
        */
        $notification_body = '
        <p>A new message has been added for you  by ' . $this->session->userdata('activeuser')->EMPLOYEES_firstname . '<br />
        ------------------------------</p>
        <p><strong>Summary:</strong> ' . $this->input->post('MESSAGE_summary') . '</p>
        <p>------------------------------<br />
        <a class="btn" href="' . base_url('messages') . '">Click to view full messages</a>';

        // Get the info for the user who the notification is for
        $notify_user_info = $this->Employees_model->read_single_switch($this->input->post('EMPLOYEES_id'));
        $notify_user_info = $notify_user_info->result();

        // Set all the data
        $insert_data = new stdClass();
        $insert_data->NOTIFICATIONS_toname = $notify_user_info[0]->EMPLOYEES_firstname . ' ' . $notify_user_info[0]->EMPLOYEES_surname;
        $insert_data->NOTIFICATIONS_toemail = $notify_user_info[0]->EMPLOYEES_email;
        $insert_data->NOTIFICATIONS_subject = 'A new message has been added for you';
        $insert_data->NOTIFICATIONS_htmlbody = $notification_body;
        //$insert_data->EMPLOYEES_id = $this->input->post('EMPLOYEES_id');
        foreach($this->input->post('EMPLOYEES_id') as $employee_id)
        {
            $insert_data->EMPLOYEES_id = $employee_id;

            // Save to new notification to the database
            $this->Notifications_model->create($insert_data);
        }

        // show user confirmation
        $this->session->set_flashdata('success_message', 'New message created successfully.');
        redirect('messages');
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:25:16.010

最简单的方法是设置所有常用参数，然后`foreach`在`$this->input->post('EMPLOYEES_id')`.

```
 foreach($this->input->post('EMPLOYEES_id') as $eid){
      // insert data using $uid as the employer id here
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:19:50.670

```
$employees = $this->input->post('EMPLOYEES_id') 
```

`$employees`实际上是一个 ID 数组，因此您必须对其进行迭代（使用 foreach）。自己做一个`var_dump($employees)`检查它的结构。

最终代码应如下所示：

```
// Set all the data
$insert_data = new stdClass();
$insert_data->NOTIFICATIONS_toname = $notify_user_info[0]->EMPLOYEES_firstname . ' ' . $notify_user_info[0]->EMPLOYEES_surname;
$insert_data->NOTIFICATIONS_toemail = $notify_user_info[0]->EMPLOYEES_email;
$insert_data->NOTIFICATIONS_subject = 'A new message has been added for you';
$insert_data->NOTIFICATIONS_htmlbody = $notification_body;
foreach($this->input->post('EMPLOYEES_id') as $employee_id)
{
  $insert_data->EMPLOYEES_id = $employee_id;

  // Save to new notification to the database
  $this->Notifications_model->create($insert_data);
} 
```

# php - 重写 php 应用程序以获得 seo 友好的 url

> ID：10721738
> 
> 赞同：3
> 
> 时间：2012-05-23T14:10:49.383
> 
> 标签：php, .htaccess, seo

我有 php 应用程序，由于客户要求有 SEO 友好的 url，因此必须部分重写。

我的链接如下：

www.mysite.com/articles_en.php?artid=89，我将不得不在其中更改网址：

www.mysite.com/articleTitle

然后我有这个网址：

www.mysite.com/halls.php?fairid=65 应该变成

www.mysite.com/fairname

而 www.mysite.com/companies.php?fairid=65&hallid=23 应该变成

www.mysite.com/fairname/hallname

你明白了。

我需要有关方法的帮助。在展览会、大厅和文章的表格中创建一个名为例如别名的字段然后尝试重写 url 是否是个好主意？任何人都可以帮助我完成如何创建这个脚本的步骤，或者给我指出更好的方法？

我擅长 php，但不擅长正则表达式，所以我会迷失在 .htaccess 部分。

任何帮助将不胜感激。

问候，佐兰

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T14:20:17.877

.htaccess 类似：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^?]*) /url_rewrite.php?path=$1 [L,QSA] 
```

数据库表类似于：

```
+------+--------+
| path | url    |
+------+--------+ 
```

以路径作为主键。

还有一个 PHP 脚本`url_rewrite.php`，它从 URL 中获取路径参数，在数据库中查找真正的 url 并执行 HTTP 301 重定向。

url_rewite.php 页面可能看起来像这样（这几乎是样板代码，需要根据您的要求进行调整 - 实际上我们不应该再使用 mysql_query() - PDO 或 MySQLi 更好但不是很好，已弃用）。

```
<?php
// -- database connection and any intialisation stuff you may have might go here ...

//get the path
$sPath = !empty($_GET['path']);

// -> error trapping for empty paths here

//retrieve the "real" url from the database
$dbQry = mysql_query("SELECT `url` FROM `seourls` WHERE `path` = '" . mysql_real_escape_string($sPath) . "' LIMIT 0, 1");

// -> error trapping here for query errors here

$dbResponse = mysql_fetch_row($dbQuery);

// -> error trapping here for empty recordsets here

$sRealPath = $dbResponse[0]; # which might be "/articles_en.php?artid=89"

//redirect
header("HTTP/1.1 302 Found");
header("Status: 302 Found"); # for Chrome/FastCGI implementation
header("Location: {$sRealPath}");
die();

?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T21:16:50.343

我建议您仔细查看 SO 上这个问题的漂亮 URL 并获得一些想法。不用说，SO 问题在 Google 搜索结果中的排名非常高。因此，从 SO URL 约定中获取线索，我建议您使用以下 3 种漂亮的 URL 格式：

1.  **/articles/89/mytitle**为`/articles_en.php?artid=89`
2.  **/halls/65/sometitle** for`/halls.php?fairid=65`
3.  **/companies/65-23/company**为`/companies.php?fairid=65&hallid=23`

现在创建 3个查找表`articles`，如下所示：`halls``companies`

**表：文章：**

```
+-------+-------+
| artid | title |
+-------+-------+ 
```

**桌厅：**

```
+--------+-------+
| fairid | title |
+--------+-------+ 
```

**表公司：**

```
+--------+--------+------+
| fairid | hallid | name |
+--------+--------+------+ 
```

现在对于以上 3 个漂亮的 URL 处理，将此代码添加到您的 .htaccess 下`$DOCUMENT_ROOT`：

```
RewriteCond %{QUERY_STRING} ^artid=\d+$ [NC]
RewriteRule ^articles_en\.php/?$ router.php?handler=article [L,NC,QSA]
RewriteRule ^articles/(\d+)/?(.*)$ router.php?handler=article&artid=$1&title=$2 [L,NC,QSA]

RewriteCond %{QUERY_STRING} ^fairid=\d+$ [NC]
RewriteRule ^halls\.php/?$ router.php?handler=hall [L,NC,QSA]
RewriteRule ^halls/(\d+)/?(.*)$ router.php?handler=hall&fairid=$1&title=$2 [L,NC,QSA]

RewriteCond %{QUERY_STRING} ^fairid=\d+&hallid=\d+$ [NC]
RewriteRule ^companies\.php/?$ router.php?handler=company [L,NC,QSA]
RewriteRule ^companies/(\d+)-(\d+)/?(.*)$ router.php?handler=company&fairid=$1&hallid=$2&name=$3 [L,NC,QSA] 
```

最后有你的`router.php`代码是这样的：（示例代码）

```
<?php
// TODO: Add sanitization checks for presence of required parameters e.g. handler and lookup failures
$handler = mysql_real_escape_string($_GET['handler']);
switch ($handler) {
   case 'article':
      $artid = mysql_real_escape_string($_GET['artid']);
      $title = mysql_real_escape_string($_GET['title']);
      if (empty($title)) {
          #header("HTTP/1.1 301 Moved Permanently");
          header("Location: /articles/$artid/" . lookupArticle($artid));
          exit;
      }
      else
         require_once("articles_en.php");
   break;
   case 'hall':
      $fairid = mysql_real_escape_string($_GET['fairid']);
      $title = mysql_real_escape_string($_GET['title']);
      if (empty($title)) {
          #header("HTTP/1.1 301 Moved Permanently");
          header("Location: /halls/$fairid/" . lookupHall($fairid));
          exit;
      }
      else
         require_once("halls.php");
   break;
   case 'company':
      $fairid = mysql_real_escape_string($_GET['fairid']);
      $hallid = mysql_real_escape_string($_GET['hallid']);
      $name = mysql_real_escape_string($_GET['name']);
      if (empty($name)) {
          #header("HTTP/1.1 301 Moved Permanently");
          header("Location: /companies/$fairid-$hallid/" . lookupCompany($fairid, $hallid));
          exit;
      }
      else
         require_once("companies.php");
   break;
}
function lookupArticle($artid) {
   // $title = mysql_result(mysql_query("SELECT title FROM articles WHERE artid=$artid"), 0, "title");
   static $articles = array(89 => 'Title\'s A', 90 => 'Title, 1B', 91 => '@Article= C');
   return normalize($articles[$artid]);
}
function lookupHall($fairid) {
   // $title = mysql_result(mysql_query("SELECT title FROM halls WHERE fairid=$fairid"), 0, "title");
   static $halls = array(65 => 'Hall+ A', 66 => 'Hall B', 67=> 'Hall C');
   return normalize($halls[$fairid]);
}
function lookupCompany($fairid, $hallid) {
   // $title = mysql_result(mysql_query("SELECT name FROM companies WHERE fairid=$fairid and hallid=$hallid"), 0, "name");
   static $companies = array('65-23' => 'Company% A', '66-24' => 'Company B', '67-25' => '(Company) C');
   return normalize($companies[$fairid .'-'. $hallid]);
}
function normalize($str) {
   return  preg_replace(array('#[^\pL\d\s]+#', '#\s+#'), array('', '-'), strtolower($str));
}
?> 
```

一旦您确认它工作正常，取消注释`301 Moved Permanently`行以获得更好的 SEO 结果。

**PS：**我使用`normalize`PHP 函数来获取所有小写的 URL 文本，清除特殊字符并将所有空格转换为连字符。

# ruby - 为什么 6.84 - 3.6 == 3.2399999999999998

> ID：10721739
> 
> 赞同：1
> 
> 时间：2012-05-23T14:10:58.893
> 
> 标签：ruby, floating-point

我只是遇到了这个问题，无法弄清楚为什么 Ruby 会这样。

有人可以解释为什么在 Ruby 中：

```
6.84 - 3.6 == 3.2399999999999998 
```

而不仅仅是3.24？我知道它与这些数字的二进制表示有关

```
(Decimal('6.84') - Decimal('3.6')) 
```

将返回预期的结果。我只是对 Float 行为的详细解释感到好奇。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T14:12:43.920

请参阅“[为什么 100*0.07 等于 6.9999....？](https://stackoverflow.com/questions/10711068/why-is-the-1000-07-equal-to-6-9999) ”（以及许多其他地方）中关于浮点数学的答案。

[为什么 100*0.07 等于 6.9999....？](https://stackoverflow.com/questions/10711068/why-is-the-1000-07-equal-to-6-9999)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T14:12:48.337

因为 double/float 使用 base-2 表示法和十进制 base-10 表示法。

这是一个有用的链接：[http ://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T14:24:03.377

在大多数情况下，浮点数/双精度数不是那么精确（因为浮点数用 base2 插入数字）。浮点运算的结果可能在不同的 CPU 上有所不同。接近 0.01 的区域比接近 0.99 的区域更精确

如果您需要比较使用浮点运算计算的值，请使用 epsilon 值（非常小的值）以消除舍入误差。

伪代码：

```
boolean equals(float x, float y) {
float result = x - y;
if(result*result < epsilon)
  return true;
else 
  false;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-23T14:32:46.747

这是一个二进制浮点问题。

读[这个](http://www.lahey.com/float.htm)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-23T14:14:55.003

基数表示法 2 和十进制基数由 double 和 float 使用

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-23T14:20:59.577

0.01 或 0.07 无法以二进制浮点数精确表示。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-23T15:06:42.227

浮点使用本质上不精确的内部表示。出于显示目的，您应该始终将答案四舍五入：

```
'%.4f' % (6.84 - 3.6)
# => "3.2400" 
```

留给自己的设备，Ruby 和许多其他语言一样，将浮点数表达到荒谬的精度。

# ios - 如何使用 iOS SDK 调用“动作”

> ID：10721741
> 
> 赞同：0
> 
> 时间：2012-05-23T14:11:02.600
> 
> 标签：ios, facebook, action

我正在使用 iOS SDK 将操作发布到用户的墙上。我刚刚使用 facebook 的开发人员仪表板创建了一个操作。Action 仅包含一个名为“Quake”的对象。这就是代码： [这是我从 Facebook 收到的代码](http://pastebin.com/KGzWJybn) 它包含应用程序 ID、URL 和所有其他字段。

这是我在我的应用程序中使用的代码：

```
Facebook *fb = (Facebook*)([SHKFacebook facebook]);
NSMutableDictionary *earthquake = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                            [quake.URLToInfo absoluteString],@"url",
                            [quake mainLocationForZone:zone],@"title",
                            @"[LINK]",@"image",
                            text,@"description", nil];
[fb requestWithGraphPath:@"me/shakeearthquakes:check?access_token=[ACCESSTOKEN]" 
               andParams: [NSMutableDictionary dictionaryWithObjectsAndKeys:earthquake,@"quake", nil]
           andHttpMethod: @"POST" 
             andDelegate: self]; 
```

（我已经授权我的应用使用“publish_actions”发布操作）。

使用这些设置（将字典作为我的对象的“地震”对象参数传递）它会崩溃。-[__NSCFDictionary length]: unrecognized selector sent to instance 0xa05b3f0 所以很有可能这不是为对象传递参数的正确方法。什么是正确的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T14:31:58.253

您将 NSMutableDictionary(earthquake) 对象放在另一个 NSMutableDictionary(autoreleased) 对象中。你确定这是你想要的吗？为什么不为“andParams”参数传递地震？

# outlook - 如何使用 C# 获取当前用户的寻呼机号码作为 MS Outlook 加载项的一部分？

> ID：10721743
> 
> 赞同：1
> 
> 时间：2012-05-23T14:11:14.360
> 
> 标签：outlook, add-in

目前我正在使用 VS2010 中的 C# 为 MS Outlook 2010 开发插件。当我们单击电子邮件 ID 时，这将在 ContextMenu 中创建一个额外的菜单。单击该菜单时，它将显示相应用户的寻呼机号码。

我已按照这些说明[在 Outlook 2010 中扩展用户界面](http://msdn.microsoft.com/en-us/library/ee692172%28office.14%29.aspx#OfficeOLExtendingUI_SampleAddin)

我可以检索所有用户详细信息，例如地址、名字或电话号码等。但我无法检索寻呼机号码。

请参见下面的代码：

```
 public void OnGetEmpIdClick(Office.IRibbonControl control)
    {
        try
        {
            Office.IMsoContactCard card = control.Context as Office.IMsoContactCard;

            if (card != null)
            {
                MessageBox.Show(GetEmpId(card), "Employee Id", MessageBoxButtons.OK);
            }
            else
            {
                MessageBox.Show("Unable to access contact card");
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
    }

    private string GetEmpId(Office.IMsoContactCard card)
    {
        if (card.AddressType == Office.MsoContactCardAddressType.msoContactCardAddressTypeOutlook)
        {
            Outlook.Application host = Globals.ThisAddIn.Application;
            Outlook.AddressEntry ae = host.Session.GetAddressEntryFromID(card.Address);

            if ((ae.AddressEntryUserType == Outlook.OlAddressEntryUserType.olExchangeUserAddressEntry || 
                ae.AddressEntryUserType == Outlook.OlAddressEntryUserType.olExchangeRemoteUserAddressEntry))
            {
                Outlook.ExchangeUser ex = ae.GetExchangeUser();
                return ex.BusinessTelephoneNumber;
            }
            else
            {
                throw new Exception("Valid address entry not found.");
            }
        }

        else
        {
            return card.Address;
        }
    } 
```

但寻呼机号码属性不可用。请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-09T13:25:37.707

我刚试过：

```
Outlook.ExchangeUser ex = ae.GetExchangeUser();
return ex.PropertyAccessor.GetProperty("http://schemas.microsoft.com/mapi/proptag/0x3A21001F"); 
```

它对我有用。

有关其他邮件用户属性，请参阅[https://msdn.microsoft.com/en-us/library/bb446002.aspx](https://msdn.microsoft.com/en-us/library/bb446002.aspx)。

# c# - <% %> <--这叫什么？如何在其中编写 C# 代码

> ID：10721746
> 
> 赞同：2
> 
> 时间：2012-05-23T14:11:21.763
> 
> 标签：c#, html, asp.net-mvc

~~我正在使用 asp.net mvc，并且我有一个有价值的表。当客户支付的价值 = 0。我希望它在单元格中显示没有付款。客户付款时 = 1。我希望它显示。待办的。当它 = 2 时，我希望它显示付费。~~

我正在尝试编写一个内联代码块，以根据`Paid`我的`Customer`班级属性的值显示付款状态。如果值为“0”，我需要显示一个空单元格。如果值为“1”，我需要在单元格中打印“Pending”，如果值为“2”，我需要打印“Paid”。

我已经有了以下内容，但我不确定如何将值输入单元格。

```
<%foreach (var Customer in CustomerList)  {%>
  <tr>
    <td><input type="radio" value="<%= Customer.ThirdPartyCustomerId %>" /></td>
    <td><%=Customer.FirstName%></td>
    <td><%= if(Customer.Paid==0)
            {
                Customer.Paid== "No Payment";
            };%>
    </td>        
 </tr>
<%}%> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T14:15:49.357

它们被称为代码分隔符。

`<%=Customer.FirstName%>`输出一个值

```
<%= if(Customer.Paid==0)
            {
                Customer.Paid== "No Payment";
};%> 
```

上面，您没有输出值，因此不需要`=`符号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T14:16:20.653

我不是 ASPX 专家，但这不可行吗？

```
<td>
    <% if(Customer.Paid==0) { %>No payment<% } %>
    <% else if(Customer.Paid==1) { %>Pending<% } %>
    <% else { %>Paid<% } %>
</td> 
```

或者，如果你想要它在一行中

```
<td>
    <%= Customer.Paid == 0 ? "No payment" : (Customer.Paid == 1 ? "Pending" : "Payed") %>
</td> 
```

# ios - 如何使用 Graph API 下载上传到私人 Facebook 群组的文件

> ID：10721747
> 
> 赞同：3
> 
> 时间：2012-05-23T14:11:23.967
> 
> 标签：ios, facebook, security, download, access-token

Facebook 现在允许我们将任意类型的文件上传到 Facebook 群组，这很棒。我正在编写一个单点登录 iOS 应用程序，它可以访问用户所属的私有组，并下载这些文件。

我能够使用 Graph API 获取这些文件的 URL，如下所示：

[http://www.facebook.com/download/444555666777888/foo.bar](http://www.facebook.com/download/444555666777888/foo.bar)

（如果我在浏览器中键入此 URL，只要我从该浏览器以我的身份登录 Facebook，浏览器就会下载它，否则会失败——Facebook 具有良好的安全功能）。

我无法将此 URL 传递给图形 API，因为它不是图形的一部分（始终以[https://graph.facebook.com/](https://graph.facebook.com/)开头），但由于缺乏访问权限，我无法使用常规 NSURLConnection 下载它令牌。

有没有合适的方法来下载这些文件？或者，在使用 NSURLConnection 下载此类文件时，我需要设置任何特定的 HTTP 标头吗？

# ios - 在 iOS Google Analytics 中跟踪“返回”按钮事件

> ID：10721748
> 
> 赞同：0
> 
> 时间：2012-05-23T14:11:24.353
> 
> 标签：ios, events, google-analytics, analytics

我使用[Google 的 Analytics iOS 框架](https://developers.google.com/analytics/devguides/collection/ios/)来跟踪我的 iOS 应用程序中的事件。我正在尝试确定当用户单击特定视图的后退按钮时创建跟踪事件是否是一种好习惯。我的想法是，这将使我能够在我的应用程序流程中看到特定用户的“下降”点。

**当用户单击特定视图的“返回”按钮时创建跟踪事件是否有价值？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:17:03.073

跟踪页面（视图控制器）何时打开更为常见。你知道如果用户从一个页面转到下一个页面，他们会点击返回，这需要他们返回。如果您有多种导航方式可以返回，那么也许它很有用，但我会说这是糟糕的用户界面设计。

# andengine - 在andengine中重新加载多个游戏后，精灵扭曲或不存在

> ID：10721751
> 
> 赞同：2
> 
> 时间：2012-05-23T14:11:37.233
> 
> 标签：andengine

在 AndEngine 如果我多次重新加载（超过 2 次或 3 次）游戏中的某些精灵会出现扭曲或不出现。起初我遇到的问题比较频繁，似乎 reloadTextures() 和 reloadFonts() 降低了错误的频率，但问题仍然没有解决。可能是什么问题？

# android - 如何在 android 中以编程方式在 MMS 中附加图像

> ID：10721757
> 
> 赞同：3
> 
> 时间：2012-05-23T14:12:04.807
> 
> 标签：android, image, sms, mms

我尝试了以下方法，但没有一个达到我的目标。

以下代码显示了一个选择器。

```
 Intent mmsIntent = new Intent(Intent.ACTION_SEND); 
            mmsIntent.putExtra("sms_body", "some text"); 
            mmsIntent.putExtra(Intent.EXTRA_STREAM, Uri.fromFile(file));
            mmsIntent.setType("image/png");
            startActivity(mmsIntent); 
```

以下代码显示撰写消息视图，但未附加图像。

```
Intent smsIntent = new Intent(Intent.ACTION_SENDTO);
        smsIntent.addCategory(Intent.CATEGORY_DEFAULT);
        smsIntent.setType("vnd.android-dir/mms-sms");
        smsIntent.putExtra(Intent.EXTRA_STREAM, Uri.fromFile(file));//Uri.parse(url));
        smsIntent.setData(Uri.parse("sms:" + "89565656"));
        startActivity(smsIntent); 
```

但是，我需要使用来自 sd 卡的图像的消息撰写视图。如何实现这一点。

先感谢您...！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T14:42:04.173

尝试这个

```
Intent mmsIntent = new Intent(Intent.ACTION_SEND);
//file is the file on the SD Card
mmsIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse(file.toURL().toString()));
mmsIntent.setType("image/png");//mmsIntent.setType("image/*"); Maybe?
startActivity(mmsIntent); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-31T14:52:11.607

如果不想打开选择器并直接附加图像，请尝试此代码

```
 PackageManager pm = getPackageManager();
    Intent sendIntent = new Intent(Intent.ACTION_SEND);     

    List<ResolveInfo> resInfo = pm.queryIntentActivities(sendIntent, 0);
    for (int i = 0; i < resInfo.size(); i++) {
         ResolveInfo ri = resInfo.get(i);
         String packageName = ri.activityInfo.packageName;

         if(packageName.contains("mms")) {
             Log.d("TAG", packageName + " : " + ri.activityInfo.name);
             sendIntent.setComponent(new ComponentName(packageName, ri.activityInfo.name));
         }
    } 

    sendIntent.putExtra("address", "1234567890");
    sendIntent.putExtra("sms_body", "some text");
    sendIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("/sdcard/DCIM/Camera/image.jpg"));
    sendIntent.setType("image/*"); 
    startActivity(sendIntent); 
```

# ios - 如何在锁定屏幕的情况下使用 SBAlertItem？

> ID：10721768
> 
> 赞同：2
> 
> 时间：2012-05-23T14:12:53.653
> 
> 标签：ios, objective-c, jailbreak, springboard

我想用来`SBAlertItem`在锁定的屏幕上显示一些东西。

有谁知道如何使用这个类？

# asp.net - 文本框货币格式

> ID：10721773
> 
> 赞同：0
> 
> 时间：2012-05-23T14:13:08.300
> 
> 标签：asp.net, gridview, formatting, currency, templatefield

我正在格式化一个与 {0:c} 数据绑定的 gridview 模板字段，它显示货币如下：

```
$790.00 
```

有没有办法调整它，使美元符号不显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:36:11.083

您只需将格式说明符更改为“f”。这是一个例子：

```
 double foo = 790f;
    string bar = string.Format("{0:f}", foo); 
```

**输出**

> 790.00

为您不查找此内容而感到羞耻：D

有关数字格式的详细信息，请参阅本文： [标准数字格式字符串](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-24T05:11:13.467

```
string foo="$790"
string blahblah=foo.replace("$","");
TextBox1.Text=blahblah; 
```

输出=790

:)

# regex - 将点星正则表达式转换为 NFA

> ID：10721776
> 
> 赞同：2
> 
> 时间：2012-05-23T14:13:14.313
> 
> 标签：regex, algorithm, dfa, nfa, kleene-star

我正在将一组给定的正则表达式转换为一个 NFA，但我遇到了一些问题。我应该如何转换诸如“ab.*c”之类的正则表达式（表示匹配一个'a'、一个'b'、任意数量的字符，然后是一个'c'）？

我的最终目标是将单个 NFA 转换为 DFA（为此我使用了子集构造算法）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:18:51.917

正则表达式中的A`.*`对应于 NFA 中每个字母的循环状态。

该状态也将转换为`c`接受状态。

`c`在循环转换和接受转换两者中都可以，这就是为什么它是不确定的。

# api - Foursquare API - checkin.createdAt

> ID：10721778
> 
> 赞同：1
> 
> 时间：2012-05-23T14:13:22.530
> 
> 标签：api, foursquare, checkin

我正在为 4sq 开发应用程序，它可以监控用户的签到并建立航班统计数据（JetLovers.com）。有时我会在 checkin 的 createdAt 中看到非常奇怪的数据，例如：

2012-05-03 04:22:37 38.769611 -9.131699 里斯本机场 (LIS) 2012-05-03 04:23:00 40.644569 -73.783493 约翰·F·肯尼迪国际机场 (JFK)

我怀疑这个人找到了传送机，并在 3 秒内行驶了 3000 英里。

我的问题是这些数据是如何生成的以及我们如何依赖它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T09:53:02.223

我认为 checkins createdAt 数据带有时间值（从 1970 年开始计算），没有毫秒和 timeZoneOffset，我在两个地方签入，相差 1 秒。

```
{
    "id":"4fc88864e4b04ec64af27a3c",
    "createdAt":1338542180,
    "type":"checkin",
    "shout":"He he",
    "timeZone":"America\/New_York",
    "timeZoneOffset":-240,
    "venue":{
            "id":"4eb1386282317685624c2e18",
            "name":"11220 Brooklyn, NY",
            "contact":{},
            "location":{
                    "lat":40.65082835341778,
                    "lng":-74.00814735447314,
                    "country":"United States"
             }
     }
}

{
    "id":"4fc88863e4b005dcbe793e44",
    "createdAt":1338542179,
    "type":"checkin",
    "shout":"Original place",
    "timeZone":"Asia\/Kolkata",
    "timeZoneOffset":330,
    "venue":{
        "id":"4f45d635e4b035f2e5635241",
        "name":"Prernathirth Derasar",
        "contact":{},
        "location":{
            "lat":23.020828247070312,
            "lng":72.52046966552734,
            "country":"India"
        }
    }
} 
```

在这里，我在 1 秒的时间跨度内在两个不同的地方签到，您可以看到 timeZoneOffset 用于区分时区。

# javascript - 在 2 个不同的网站中使用 cookie

> ID：10721784
> 
> 赞同：0
> 
> 时间：2012-05-23T14:13:44.993
> 
> 标签：javascript, security, cookies

我有 2 个网站，我想为这两个网站使用相同的 cookie。问题是它们不在同一个域中。

我能怎么做 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:17:31.820

您可以为两个域设置两个 cookie，例如 PHP 代码：

```
setcookie("TestCookie", "value", $path, "domain1.com");
setcookie("TestCookie", "value", $path, "domain2.com"); 
```

关联：

[http://php.net/manual/en/function.setcookie.php](http://php.net/manual/en/function.setcookie.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:17:04.113

我想你不能。Cookie 仅发送到它们所属的域。您最常为两个不同的域创建不同的 cookie。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:17:08.873

你不能用cookies做到这一点。

您必须将 cookie 的数据保存在您的服务器上。您可以使用数据库来执行此操作。

# ruby-on-rails - Rails / Active Record 查找加入、限制和偏移

> ID：10721787
> 
> 赞同：0
> 
> 时间：2012-05-23T14:13:50.693
> 
> 标签：ruby-on-rails, activerecord, deprecated

我整理了以下查询，它按我的预期工作：

```
 stuff = @thing.children.find(
    :all,
    :joins => :other,
    :conditions => {:others => {:another_id => some_id}},
    :limit => my_limit,
    :offset => my_offset,
  ) 
```

但是，`find(:all)`不推荐使用表单查询。我尝试将查询更改为以下形式：

```
 stuff = @thing.children.find(
    :joins => :other,
    :conditions => {:others => {:another_id => some_id}},
    :limit => my_limit,
    :offset => my_offset,
  ).all 
```

但这会引发数据库错误。编写此查询的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T15:15:18.830

如果不将其重写为 Arel，您可以简单地将 .find 更改为 .all，然后删除 :all 符号，如下所示：

```
stuff = @thing.children.all(
  :joins => :other,
  :conditions => {:others => {:another_id => some_id}},
  :limit => my_limit,
  :offset => my_offset,
) 
```

# android - 每次导出前使用 proguard 清理项目

> ID：10721792
> 
> 赞同：3
> 
> 时间：2012-05-23T14:14:07.530
> 
> 标签：android, proguard

我在使用 proguard 时有一些非常奇怪的行为。这是情况。

在 Eclipse 中，如果我只运行导出命令，则会出现以下错误。伴随着许多`can't find referenced class`错误。下面的数字 241 似乎也跳来跳去，有时是 179、290 等。

```
[2012-05-22 15:54:33 - x] Warning: there were 241 unresolved references to classes or interfaces.
[2012-05-22 15:54:33 - x]          You may need to specify additional library jars (using '-libraryjars').
[2012-05-22 15:54:33 - x] Warning: there were 36 unresolved references to program class members.
[2012-05-22 15:54:33 - x]          Your input classes appear to be inconsistent.
[2012-05-22 15:54:33 - x]          You may need to recompile them and try again.
[2012-05-22 15:54:33 - x]          Alternatively, you may have to specify the option 
[2012-05-22 15:54:33 - x]          '-dontskipnonpubliclibraryclassmembers'.
[2012-05-22 15:54:33 - x] java.io.IOException: Please correct the above warnings first.
[2012-05-22 15:54:33 - x]   at proguard.Initializer.execute(Initializer.java:321)
[2012-05-22 15:54:33 - x]   at proguard.ProGuard.initialize(ProGuard.java:211)
[2012-05-22 15:54:33 - x]   at proguard.ProGuard.execute(ProGuard.java:86)
[2012-05-22 15:54:33 - x]   at proguard.ProGuard.main(ProGuard.java:492) 
```

但是如果我做一个干净然后导出它不会显示错误，也不会显示任何控制台输出。清理后的第一次导出将生成一个运行的文件。如果我在上次导出后立即尝试进行导出，它将再次失败并出现上述错误。

附加信息 -

> 我的工作区路径和 git repo 路径都没有空格。
> 
> 我的 proguard.cfg 文件主要是 android/eclipse 提供的默认文件，只添加了一些额外的“keep”
> 
> 我的项目有一个旧的工作区设置，我可以使用 proguard 成功导出（这个项目通过 OS X 上的 subclipse 使用 SVN）。
> 
> 我将项目复制到当前工作区并使用 egit 将其连接到 GIT。Egit 将文件从我的工作区移到了 git repo 的位置。

TL;博士; 是什么让 proguard 在清理后成功运行但每次运行时都失败而没有先清理？

# wpf - 使用 Caliburn.Micro 在 DataGrid 中选择多条记录

> ID：10721794
> 
> 赞同：4
> 
> 时间：2012-05-23T14:14:14.150
> 
> 标签：wpf, caliburn.micro

我有一个使用 Caliburn.Micro 的 WPF 应用程序。

DataGrid 有一个属性 SelectedItem="{Binding Path=SelectedUsageRecord}"

如您所见，SelectedItem 绑定到 SelectedUsageRecord 属性。但我需要能够处理选择多个记录。这可以将多个记录绑定到集合属性吗？我没有看到像“SelectedItems”这样的东西......谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-01T02:04:42.010

这是我在遇到与您相同的情况后所做的事情。简而言之，直接处理选择更改事件并从事件参数中提取选定的行。假设“Rows”的源集合每个都是 RowViewModel，以及“_selectedRows”的集合。

```
<DataGrid RowsSource="{Binding Rows}" x:Name="Rows"                  
          SelectionMode="Extended" SelectionUnit="FullRow">
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="SelectionChanged">
            <cal:ActionMessage MethodName="SelectedRowsChangeEvent">
                <cal:Parameter Value="$eventArgs" />
            </cal:ActionMessage>
        </i:EventTrigger>
    </i:Interaction.Triggers>
</DataGrid> 
```

```
public void SelectedRowsChangeEvent(SelectionChangedEventArgs e)
{
    foreach (var addedRow in e.AddedRows)
    {
        _selectedRows.Add(addedRow as RowViewModel);
    }

    foreach (var removedRow in e.RemovedRows)
    {
        _selectedRows.Remove(removedRow as RowViewModel);
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-01-10T07:24:55.300

我只是想发布我的解决方案。在 Caliburn micro 中，只要您遵守命名约定，就无需设置源。

Xaml

```
<DataGrid x:Name="Rows" SelectionMode="Extended" cal:Message.Attach="[Event SelectionChanged] = [Row_SelectionChanged($eventArgs)]"> 
```

C＃

```
public List<MyObject> Rows { get; set; }

public MyObject SelectedRow { get; set; } //Will be set by Caliburn Micro. No need to use "SelectedItem={...}"

List<MyObject> _selectedObjects = new List<MyObject>();    

public void Row_SelectionChanged(SelectionChangedEventArgs obj)
{
  _selectedObjects.AddRange(obj.AddedItems.Cast<MyObject>());
  obj.RemovedItems.Cast<MyObject>().ToList().ForEach(w => _selectedObjects.Remove(w));
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-11-20T04:30:13.620

此处发布的两种解决方案都可以正常工作，但由于“SelectionChangedEventArgs”属性，它们依赖于在您的视图模型中添加视图 (wpf) 程序集。如果您打算在不同平台上重用视图模型，我认为这对跨平台解决方案不利。

所以，我发布了我的解决方案，它更符合 MVVM 模式。我在这个例子中使用了syncfusion SfDataGrid，但这应该适用于普通的DataGrid：

首先我们需要扩展 DataGrid 类，所以我们创建了一个类。我将其命名为“CustomSfDataGrid.cs”。请注意，我还订阅了 SelectionChanged 事件，并且只是直接从“SelectedItems”属性获取数据。

```
using System.Windows;
using Caliburn.Micro;
using Syncfusion.UI.Xaml.Grid;

namespace DesktopClient.WPF.Controls
{
    public class CustomSfDataGrid : SfDataGrid
    {
        ///Bindable collection of objects property linked to the DependencyProperty called: "CustomSelectedItems"
        ///We can use "CustomSelectedItems" as a Binding Property in WPF
        public BindableCollection<object> CustomSelectedItems
        {
            get
            {
                return (BindableCollection<object>)GetValue(CustomSelectedItemsProperty);
            }
            set
            {
                SetValue(CustomSelectedItemsProperty, value);
            }
        }

        // Using a DependencyProperty as the backing store for SelectedItem.  This enables animation, styling, binding, etc...
        public static readonly DependencyProperty CustomSelectedItemsProperty = DependencyProperty.Register("CustomSelectedItems", typeof(BindableCollection<object>), typeof(CustomSfDataGrid), new PropertyMetadata(null));

        public CustomSfDataGrid()
        {
            SelectionChanged += CustomSfDataGrid_SelectionChanged;
        }

        private void CustomSfDataGrid_SelectionChanged(object sender, GridSelectionChangedEventArgs e)
        {
            this.CustomSelectedItems = new BindableCollection<object>(this.SelectedItems);
        }
    }
} 
```

在 .xaml 文件中，我添加了一个名为“custom”的标头，它指向我的“CustomSfDataGrid.cs”的命名空间。然后，我将新的“CustomSelectedItems”属性绑定到“MyViewModelProperty”。最后，我正在使用“SelectionChanged”事件。

```
<UserControl
    xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
    xmlns:cal="http://www.caliburnproject.org"
    xmlns:custom="clr-namespace:DesktopClient.WPF.Controls">
    <Grid>
        <custom:CustomSfDataGrid x:Name="dataGrid" ItemsSource="{Binding Models}" 
                                    SelectionMode="Extended" SelectionChanged="OnSelectionChanged"
                                    CustomSelectedItems="{Binding MyViewModelProperty, Mode=OneWayToSource}">
            <syncfusion:SfDataGrid.Columns>
                <!-- Column Schema -->
            </syncfusion:SfDataGrid.Columns>
        </custom:CustomSfDataGrid>
    </Grid> 
```

最后，在 ViewModel 中我有一个“BindableCollection”属性。

```
using using System.Linq;
//
//...
        private BindableCollection<object> _myViewModelProperty;

        public BindableCollection<object> MyViewModelProperty
        {
            get
            {
                return _myViewModelProperty;
            }
            set
            {
                _myViewModelProperty = value;
            }
        }

        //
        public void UsingMyViewModel()
        {
            //cast the collection of objects to a different type using linq
            BindableCollection<MyCastedType> x = new BindableCollection<BrandModel>(MyViewModelProperty.OfType<BrandModel>());

            //alternative casting method
            BindableCollection<MyCastedType> y = new BindableCollection<MyCastedType>();
            foreach (var item in MyViewModelProperty)
            {
                y.Add(item as MyCastedType);
            }
        } 
```

# svn - 我如何知道每个用户为 SVN 存储库贡献了多少？

> ID：10721799
> 
> 赞同：-1
> 
> 时间：2012-05-23T14:14:39.650
> 
> 标签：svn

我正在尝试与我的一个朋友一起弄清楚，他对我们都提交更改的 SVN 存储库贡献最大。是否有工具或 svn 命令可以知道每个用户提交的代码总行数的百分比？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:18:31.610

尝试这样的事情：

```
svn 责备 SVN_FILE_PATH | gawk '{打印 $2}' | 排序 | 唯一的-c 

```

# c# - 使用 finally 而不是 catch

> ID：10721807
> 
> 赞同：11
> 
> 时间：2012-05-23T14:15:07.567
> 
> 标签：c#, transactions, try-catch, try-finally

我现在已经多次看到这种模式：

```
 bool success = false;
        try
        {
            DoSomething();
            success = true;
        }
        finally
        {
            if (!success)
                Rollback();
        } 
```

我一直在想：为什么这比使用 catch 进行回滚更好？

```
 try
        {
            DoSomething();
        }
        catch
        {
            Rollback();
            throw;
        } 
```

确保更改在失败时回滚的两种方法之间有什么区别？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T14:29:13.297

我在这里发布了一些代码，即使它与问题并不真正相关（稍后将删除）。

有了这个程序：

```
using System;

namespace testcs
{
    class Program
    {
        static void Main(string[] args)
        {
            try
            {
                try
                {
                    foo();
                    foo();
                    foo();
                }
                catch
                {
                    throw;
                }
            }
            catch (Exception e)
            {
                Console.WriteLine(e.ToString());
            }
        }

        private static void foo()
        {
            throw new Exception("oops");
        }
    }
} 
```

堆栈跟踪（查看行号！）被保留，但在`main`函数内部您将看到“第 19 行”，该行`throw`是调用的*真正*行`foo()`（第 13 行）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T14:19:11.457

该`finally`语句通常用于清理资源。`Rollback()`如果异常不是回滚事务的唯一原因，则该方法可能可以在那里使用。`Close()`或`Dispose()`方法是最终出现在 finally 块中的主要候选者。

但是，您不想在那里执行任何可能引发异常的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-23T14:30:08.187

我不确定这是否不仅仅是[轶事证据](http://en.wikipedia.org/wiki/Anecdotal_evidence)，但我个人出于一个非常实际的原因使用了这种模式：当`DoSomething`抛出异常时，Visual Studio 调试器将`DoSomething`在第一个版本中发生异常的地方中断，而它会`throw;`在第二个版本中打破。`Rollback`这允许在清理所有内容之前检查应用程序状态。

![截屏](../Images/76e3a93ca08cf34577ea9040f4026a7e.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-23T14:31:12.533

如果您不关心此特定代码中使用的是什么类型的异常：

```
try
{
   DoSomething();
   ok = true;
}
finally
{
    if(!ok)Rollback();
} 
```

这将 100% 保留原始形式的调用堆栈。此外，如果您使用这样的异常处理：

```
try
{
   DoSomething();
   ok = true;
}
catch(FirstExcetionType e1)
{
    //do something
}
catch(SecondExcetionType e2)
{
    //do something
}
catch(Exception e3)
{
    //do something
}
finally
{
    if(!ok)Rollback();
} 
```

最后使用 finally 可以使您的代码比从每个单独的 catch 语句调用回滚更具可读性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-23T14:16:58.293

`finally`总是被执行，不仅在捕获异常时。

当然，在这种特定情况下，只有在出现错误时才需要回滚，但作为一般模式，这`try-finally`可能对资源管理更有用（在这种情况下，您通常需要确保您始终`Close()`或`Dispose()`正确地使用您的资源）。特别是如果代码的作者来自 Java 背景，这个习语更普遍。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-23T14:29:34.990

这里的明确目标是`Rollback`在发生任何错误时调用。两个代码片段都实现了这一目标。第一个使用 finally，它总是运行，它验证`try`块的最后一行是否已成功到达。第二个捕获任何错误，回滚事务，然后重新抛出捕获的异常。任何一个片段的结果都是抛出的任何异常都将导致回滚，同时仍然冒泡到下一个级别。

您提到该项目是从 Java 移植的。在 Java 中，您**可以** [重新抛出异常](https://stackoverflow.com/questions/1097527/rethrowing-exceptions-in-java/1097539)，类似于在 C# 中使用`throw;`. 您还可以[抛出一个](https://stackoverflow.com/questions/1097527/rethrowing-exceptions-in-java/1097591#1097591)仍将维护调用堆栈的新异常（等）。第二个在 C# 中更清晰/更简单（虽然不是很多），第一个具有实际使用 Java 编写的优点。

# php - 包含至少 8 个字符和至少 1 个非字母数字字符的密码的正则表达式

> ID：10721811
> 
> 赞同：4
> 
> 时间：2012-05-23T14:15:21.097
> 
> 标签：php, regex, passwords, non-alphanumeric

如果用户更改密码，我正在尝试检查 PHP，他们的新密码必须是 8 个或更多字符并且至少有 1 个非字母数字密码。我应该如何检查这个以及正则表达式是什么？

检查长度是容易的部分`strlen >= 8`。我的问题是正则表达式。即使经过多年的计算机科学学习，我仍然对正则表达式一无所知。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T14:21:00.263

尝试这样的事情来检查他们是否使用了非字母数字字符：

```
if( !preg_match( '/[^A-Za-z0-9]+/', $password) || strlen( $password) < 8)
{
    echo "Invalid password!";
} 
```

如果不包含至少一个不在列表中的字符（字母数字字符），则该`if`语句将评估为。`true``$password`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:19:28.297

这应该有效（未经测试）

```
if (preg_match('/^(?=.*[\W])(?=[a-z0-9])[\w\W]{8,}$/i', '123abc!$'))
{
    //error
} 
```

它确保密码长度为 8 个字符，并且至少包含一个特殊字符

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:20:50.017

如果您使用 strlen/mb_strlen 检查字符串长度，您可以简单地编写一个正则表达式来匹配任何非字母数字字符。如果它匹配一个（或多个），你很好。例如：

```
$password = 'asdf123!';

if(mb_strlen($password) >= 8 and preg_match('/[^0-9A-Za-z]/', $password))
{
    // password is valid
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T14:22:26.677

据我所知，您无法做到这一点，因为它是一个复合条件场景。

您需要做的是分三步进行：

```
$has8characters = (mb_strlen($_REQUEST['password']) >= 8);
$hasAlphaNum = preg_match('b[a-z0-9]+bi', $_REQUEST['password']);
$hasNonAlphaNum = preg_match('b[\!\@#$%\?&\*\(\)_\-\+=]+bi', $_REQUEST['password']); 
```

这没有经过测试，但你非常接近你想要达到的目标......

祝你好运

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-23T14:44:29.390

试试这个。

```
~^(.*[\W]+.*){8,}$~ 
```

*   .* 查找任何字符 0 次或更多次
*   [\W]+ 匹配至少一个非单词字符
*   {8,} 仅当长度为 8 个或更多字符时才匹配括号中的值
*   ^ $ 匹配字符串的开头和结尾

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-02T15:07:10.083

这解决了它。试试！

```
if(!preg_match('/^(?=.*\d)(?=.*[A-Za-z])[0-9A-Za-z!@#$%]{8,}$/', $pass)) {
  echo "Password does not meet the requirements! It must be alphanumeric and atleast 8 characters long";
} 
```

# windows - 将 Oracle (dbstart/oratab) 指令从 Linux 转换为 Windows

> ID：10721812
> 
> 赞同：0
> 
> 时间：2012-05-23T14:15:21.790
> 
> 标签：windows, linux, oracle

我尝试遵循以下 Linux 方向，并正在寻找 Windows 等价物。任何帮助，将不胜感激。

1.  编辑 $ORACLE_HOME_LISTENER/bin/dbstart 和 $ORACLE_HOME_LISTENER/bin/dbshut 脚本。

    ```
    # Add/modify the following
    ORACLE_HOME_LISTENER=/apps/oracle/product/11.1.0
    ORATAB=/etc/oratab 
    ```

2.  编辑 /etc/oratab 并为将在本地计算机上创建的每个数据库添加一个 SID 条目。

    ```
    # Add an entry for blah
    blah:/apps/oracle/product/11.1.0:Y 
    ```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:07:22.337

列表中的这两项确实没有 Windows 等效项。侦听器和数据库实例作为单独的 Windows 服务实现。您将在 oratab 文件中列出的每个数据库实例都有自己的服务。oratab 文件中的启动标志替换为服务属性中的启动类型。环境变量在 Windows 注册表中进行管理，并在您使用数据库配置助手 (DBCA) 创建数据库时设置。查看[Windows 安装指南](http://docs.oracle.com/cd/B28359_01/install.111/b32006/toc.htm)。

# facebook - 页面选项卡重定向到页面选项卡 URL，但仅适用于某些用户

> ID：10721816
> 
> 赞同：1
> 
> 时间：2012-05-23T14:15:29.497
> 
> 标签：facebook, redirect

我有一个 PageTab 配置为从我自己的 Web 服务器（在 iframe 内）提供内容。

我的 Web 服务器上的脚本只获取 signed_request 变量（从 Facebook 传递），并检查用户是否喜欢该页面，并相应地显示内容。这适用于大多数用户，但一些用户报告说 Facebook 正在将他们的浏览器直接重定向到页面选项卡指向的 URL（我的 Web 服务器上的 URL）。

我已经进行了调试，果然，用户正在直接访问 URL。不酷。

这纯粹是一个 PageTab，和 Canvas 一点关系都没有。任何人都知道为什么会发生这种情况？

# javascript - 在科尔多瓦中以独立于平台的方式访问数据目录

> ID：10721819
> 
> 赞同：1
> 
> 时间：2012-05-23T14:15:42.517
> 
> 标签：javascript, android, ios, cordova

我正在开发一个 corodva (phonegap) 应用程序，并将一些下载的文件保存到数据目录中。目前，如果我通过以下方式访问目标文件的文件系统条目：

```
function gotFS(fileSystem) {
    fileSystem.root.getFile("<filename>", {create: true}, gotFileEntry, fail);
}

window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, gotFS, fail); 
```

我试过了，`LocalFileSystem.APPLICATION`但它给出了一个javascript错误。

在 iOS 中，文件被保存`/Documents/<filename>`到`/mnt/sdcard/<filename>`.

我想将这些文件存储`/data/data/<app>/<filename>`在 Android 和 iOS 中的等效文件中（我猜是`/Application Support/<filename>`）。

现在的问题是：

有没有办法以独立于平台的方式访问这些，所以我不需要添加 ifs 来检查我在哪个平台？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:30:31.913

我写了一篇小博客文章来展示如何将依赖于平台的路径移到您在启动时加载的 json 文件中。这样您就不必针对您所在的平台进行繁琐的测试。

[http://simonmacdonald.blogspot.com/2012/01/on-eleventh-day-of-phonegapping.html](http://simonmacdonald.blogspot.com/2012/01/on-eleventh-day-of-phonegapping.html)

# autotools - 使用 Automake 在固定位置安装任意数据文件？

> ID：10721826
> 
> 赞同：7
> 
> 时间：2012-05-23T14:16:10.930
> 
> 标签：autotools, automake, datadirectory

我怎么知道`automake`在我想要的地方安装任意数据文件？

我有一些文件需要放在特定的地方，例如“ `datafile1`”，在我的项目中，需要复制到“ `/usr/MyProduct/flash_memory`”。

*   “ `/usr/MyProduct/flash_memory`”是我无法改变的绝对路径。
*   " `datafile1`" 是一个二进制数据文件，它不是由 构建的`make`，而只是需要由`make install`.
*   我受不了了`make dist`。它需要被复制`make install`（它的解释很长，所以，请考虑到这一点）。
*   我宁愿不使用`install-hook`，但更喜欢使用更优雅的方法（如果可能的话）。

真的感谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-05-23T14:33:10.863

不要在 Makefile.am 中使用完整路径。曾经。您可以告诉 automake将扩展为 的文件放入其中`datafile1`，或者您可以定义扩展为并将文件放在那里，但必须允许最终用户设置为其他内容。你想在 Makefile.am 中做的是：`$(datadir)``$(prefix)/share/MyProduct``flash_DIR``$(prefix)/MyProduct/flash_memory``$(prefix)``/usr`

```
flashdir = $(prefix)/$(PACKAGE)/flash_memory
flash_DATA = datafile1 
```

（使用 可能更合适`$(prefix)/@PACKAGE@/flash_memory`，因为 PACKAGE 可能不应该在制作时修改，但我认为这不是非常重要。）

然后，当您是用户时，将`make install`前缀设置为`/usr`. 如果您尝试在 Makefile.am 中使用绝对路径，它将不允许分阶段安装（即设置 DESTDIR），会限制用户的灵活性，并且是*错误*的做法。要点是包维护者无法选择最终位置；这是用户的决定。

# java - 在 Bouncy 城堡中使用 SHA256 的 ECDSA 不会引发此类算法异常

> ID：10721831
> 
> 赞同：3
> 
> 时间：2012-05-23T14:16:31.290
> 
> 标签：java, bouncycastle, sha256, elliptic-curve

我正在尝试使用`ECDSA`with `SHA256`in生成签名`Bouncy Castle`，如下所示，

1.  我在一开始就添加了提供者
2.  我已经建立了 ECPrivatekey
3.  ```
    Signature s_oSignature = Signature.getInstance("SHA256withECDSA",     
    BouncyCastleProvider.PROVIDER_NAME); 
    ```

但第 3 步抛出`"java.security.NoSuchAlgorithmException: no such algorithm: SHA256withECDSA for provider BC"`。

但是同样`"SHA256withECDSA"`的事情，当用`"SHA1withECDSA"`prceeds 替换时，没有任何例外。

这怎么可能？我正在使用`"bcprov-jdk14-121.jar"`.

由于我已经挣扎了很长时间，任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T03:22:50.753

我从来没有遇到过这个问题，但这里有一些你可以尝试的事情。

1.  确保您已安装和配置 Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy Files（在页面底部[下载）](http://www.oracle.com/technetwork/java/javase/downloads/index.html)
2.  尝试使用[最新版本的 BouncyCastle](http://www.bouncycastle.org/latest_releases.html)并将其作为提供程序安装在运行时中，而不是在程序中即时安装

这个问题非常奇怪，因为 SHA256withECDSA 明确列在规范中，所以它只留下尝试所有可能选项的选项，无论它们多么不可能提供帮助。

# c#-2.0 - 在 StringBuilder 中添加 String.Format 时出现“对象引用错误”

> ID：10721832
> 
> 赞同：1
> 
> 时间：2012-05-23T14:16:32.857
> 
> 标签：c#-2.0, stringbuilder, string.format

将 string.format 放入 stringbuilder 时出现“对象引用错误”。我在 C#2.0 中有以下代码

```
public const string PageLinkGoogleMarkup = "<link rel=\"alternate\" hreflang=\"{0}\" href=\"{1}www.mysite.com{2}{3}\" />\r\n"; 
```

现在，当我将它添加到 HtmlTextWriter 时，它工作正常，如下所示：

```
HtmlTextWriter writer (Object);
writer.write(string.format(PageLinkGoogleMarkup,str[1],header,links,querystr)); //This works perfect 
```

当我尝试将上面的代码添加到 StringBuilder 而不是 HtmlTextWriter 时，它会给出错误：

由于存在大循环，所以我决定先将所有内容附加到 StringBuilder，最后使用 writer.Write 渲染（一堆中的整个 html），请在下面的代码

```
StringBuilder sb = new StringBuilder();
sb.Append(string.format(PageLinkGoogleMarkup,str[1],header,links,querystr)); //here i get object reference error

writer.Write(sb.ToString()); 
```

请推荐！！

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:47:12.010

当您在 StringBuilder 代码中使用它时，以下变量之一为空（但在工作代码中使用它时不为空）：

```
str (or the item in index [1])
header
links
querystr 
```

使用调试器找出哪个是空的，修复它，代码应该可以正常工作。

# php - PHP中的关键字分析

> ID：10721836
> 
> 赞同：24
> 
> 时间：2012-05-23T14:16:56.163
> 
> 标签：php, full-text-search, analytics, keyword, pagerank

对于我正在构建的 Web 应用程序，我需要分析网站，检索并排列最重要的关键字并显示这些关键字。

获取所有单词，它们的密度并显示它们相对简单，但这会产生非常倾斜的结果（例如，停用词排名非常高）。

基本上，我的问题是：如何在 PHP 中创建一个关键字分析工具，以生成按单词重要性正确排序的列表？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-05-23T14:16:56.367

最近，我自己一直在做这个，我会尽量解释我做了什么。

## 脚步

1.  过滤文本
2.  拆分成单词
3.  删除 2 个字符的单词和停用词
4.  确定词频+密度
5.  确定单词突出度
6.  确定单词容器
    1.  标题
    2.  元描述
    3.  网址
    4.  标题
    5.  元关键字
7.  计算关键字值

### 1.过滤文本

您需要做的第一件事是过滤确保编码正确，因此转换为 UTF-8：

```
iconv ($encoding, "utf-8", $file); // where $encoding is the current encoding 
```

之后，您需要去除所有 html 标记、标点符号、符号和数字。在 Google 上查找有关如何执行此操作的功能！

### 2\. 分词

```
$words = mb_split( ' +', $text ); 
```

### 3.删除2个字符的词和停用词

任何由 1 或 2 个字符组成的单词都没有任何意义，因此我们将它们全部删除。

要删除停用词，我们首先需要检测语言。有几种方法可以做到这一点： - 检查 Content-Language HTTP 标头 - 检查 lang="" 或 xml:lang="" 属性 - 检查 Language 和 Content-Language 元数据标签 如果这些都没有设置，您可以使用像[AlchemyAPI](http://www.alchemyapi.com/api/lang/)这样的外部 API 。

您将需要每种语言的停用词列表，可以在网络上轻松找到。我一直在使用这个：[http ://www.ranks.nl/resources/stopwords.html](http://www.ranks.nl/resources/stopwords.html)

### 4.确定词频+密度

要计算每个单词的出现次数，请使用以下命令：

```
$uniqueWords = array_unique ($keywords); // $keywords is the $words array after being filtered as mentioned in step 3
$uniqueWordCounts = array_count_values ( $words ); 
```

现在遍历 $uniqueWords 数组并计算每个单词的密度，如下所示：

```
$density = $frequency / count ($words) * 100; 
```

### 5.确定单词突出度

单词突出度由单词在文本中的位置定义。例如，第一句中的第二个词可能比第 83 句中的第 6 个词更重要。

要计算它，请在上一步的同一循环中添加此代码：'

```
$keys = array_keys ($words, $word); // $word is the word we're currently at in the loop
$positionSum = array_sum ($keys) + count ($keys);
$prominence = (count ($words) - (($positionSum - 1) / count ($keys))) * (100 /   count ($words)); 
```

### 6.确定词容器

一个非常重要的部分是确定一个词的位置——在标题、描述等中。

首先，您需要使用 DOMDocument 或 PHPQuery 之类的东西来获取标题、所有元数据标签和所有标题（**不要**尝试使用正则表达式！）然后您需要在同一个循环中检查这些是否包含单词。

### 7.计算关键字值

最后一步是计算关键字值。为此，您需要权衡每个因素 - 密度、突出度和容器。例如：

```
$value = (double) ((1 + $density) * ($prominence / 10)) * (1 + (0.5 * count ($containers))); 
```

这个计算远非完美，但它应该会给你不错的结果。

## 结论

我没有提到我在工具中使用的每一个细节，但我希望它可以为关键字分析提供一个很好的视角。

^(*注意：是的，这是受今天关于回答您自己问题的博文的启发！*)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-31T20:03:20.420

您的算法中缺少的一件事是面向文档的分析（如果您出于某种原因没有故意省略它）。

每个站点都建立在一个文档集上。计算所有文档的词频将为您提供有关词覆盖率的信息。大多数文档中出现的词都是停用词。特定于有限数量文档的词可以形成关于特定主题的文档集群。与特定主题相关的文档数量可以提高该主题单词的整体重要性，或者至少提供一个额外的因素来计算在您的公式中。

也许，您可以从包含类别/主题和每个主题的关键字的预配置分类器中受益（此任务可以通过索引现有的公共类别层次结构部分自动化，直至 Wikipedia，但这本身并不是一项简单的任务）。然后，您可以将类别纳入 analisys。

此外，您可以通过对句子级别的分析来改进统计数据。也就是说，具有单词在同一个句子或短语中出现的频率，您可以发现陈词滥调和重复，并从统计数据中消除它们。但是，恐怕这在纯 PHP 中不容易实现。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-01T14:28:03.520

这可能是一个很小的贡献，但我还是会提到它。

## 上下文评分

在某种程度上，您已经通过使用单词的位置来查看单词的上下文。您可以通过将出现在标题（H1、H2 等）中的单词排名高于段落内的单词、可能高于项目符号列表中的单词等来添加另一个因素。

## 频率净化

根据一种语言检测停用词可能会起作用，但也许您可以考虑使用钟形曲线来确定哪些词频率/密度过于奢侈（例如，去除下 5% 和上 95%）。然后将评分应用于剩余的单词。它不仅可以防止停用词，还可以防止关键词滥用，至少在理论上是这样的:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-02T11:56:22.343

@提炼'步骤'

关于执行这些许多步骤，我会采用一些“增强”解决方案，将您的一些步骤缝合在一起。

不确定，如果你完全设计一个完整的[词法分析器](http://en.wikipedia.org/wiki/Lexical_analysis)来满足你的需求，例如只在 hX 等中寻找文本，那么它是否更好。但是你必须是认真的，因为它可能是一个令人头疼的实现。虽然我会指出我的观点并说另一种语言的[Flex / Bison](http://aquamentus.com/flex_bison.html)解决方案（PHP 提供的支持很差，因为它是一种高级语言）将是一个“疯狂”的速度提升。

但是，幸运的是，`libxml`它提供了出色的功能，如下所示，您最终将拥有多个步骤。在分析内容之前，设置语言（停用词），**缩小 NodeList 集**并从那里开始工作。

1.  加载整页
2.  检测语言
3.  仅提取`<body>`到单独的字段中
4.  从和其他人那里释放一点记忆`<head>`，例如。`unset($fullpage);`
5.  触发你的算法（如果 pcntl - linux 主机 - 可用，分叉和发布浏览器是一个不错的功能）

在使用 DOM 解析器时，应该意识到设置可能会引入对属性 href 和 src 的进一步验证，具体取决于库（例如 parse_url 和 likes）

解决超时/内存消耗问题的另一种方法是调用 php-cli（也适用于 Windows 主机）并“继续工作”并开始下一个文档。有关更多信息，请参阅[此问题](https://stackoverflow.com/questions/2458005/forking-in-php-on-windows)。

如果您向下滚动一点，请查看建议的架构 - 初始抓取只会将 body 放入数据库（在您的情况下另外还有 lang），然后运行 ​​cron 脚本，在使用以下函数的同时填写 ft_index

```
 function analyse() {
        ob_start(); // dont care about warnings, clean ob contents after parse
        $doc->loadHTML("<html><head><meta http-equiv=\"Content-Type\" content=\"text/html;charset=UTF-8\"/></head><body><pre>" . $this->html_entity_decode("UTF-8") . "</pre></body>");
        ob_end_clean();
        $weighted_ft = array('0'=>"",'5'=>"",'15'=>"");

        $includes = $doc->getElementsByTagName('h1');
        // relevance wieght 0
        foreach ($includes as $h) {

                $text = $h->textContent;
                // check/filter stopwords and uniqueness
                // do so with other weights as well, basically narrow it down before counting
                $weighted_ft['0'] .= " " . $text;

        }
        // relevance wieght 5
        $includes = $doc->getElementsByTagName('h2');
        foreach ($includes as $h) {
            $weighted_ft['5'] .= " " . $h->textContent;
        }
        // relevance wieght 15
        $includes = $doc->getElementsByTagName('p');
        foreach ($includes as $p) {
            $weighted_ft['15'] .= " " . $p->textContent;
        }
            // pseudo; start counting frequencies and stuff
            // foreach weighted_ft sz do 
            //   foreach word in sz do 
            //      freqency / prominence
 }

    function html_entity_decode($toEncoding) {
        $encoding = mb_detect_encoding($this->body, "ASCII,JIS,UTF-8,ISO-8859-1,ISO-8859-15,EUC-JP,SJIS");
        $body = mb_convert_encoding($this->body, $toEncoding, ($encoding != "" ? $encoding : "auto"));
        return html_entity_decode($body, ENT_QUOTES, $toEncoding);
    } 
```

以上是一个类，类似于您的数据库，其中预先加载了页面“body”字段。

同样，就数据库处理而言，我最终将上述解析结果插入到带有**全文标记的表格列**中，以便将来的查找顺利进行。这**对 db 引擎来说是一个巨大的优势**。

全文索引注意事项：

在处理少量文档时，全文搜索引擎可以在每次查询时直接扫描文档的内容，这种策略称为串行扫描。这是一些基本工具（例如 grep）在搜索时所做的事情。

您的索引算法会过滤掉一些单词，好的。但是这些是通过它们承载的权重来枚举的——这里有一个策略需要考虑，因为全文字符串不会继承给定的权重。这就是为什么在示例中，给出了将字符串拆分为 3 个不同字符串的基本策略。

一旦放入数据库，列应该类似于这个，所以模式可能是这样的，我们将在其中维护权重 - 并且仍然提供超快速查询方法

```
CREATE TABLE IF NOT EXISTS `oo_pages` (
  `id` smallint(5) unsigned NOT NULL AUTO_INCREMENT,
  `body` mediumtext COLLATE utf8_danish_ci NOT NULL COMMENT 'PageBody entity encoded html',
  `title` varchar(31) COLLATE utf8_danish_ci NOT NULL,
  `ft_index5` mediumtext COLLATE utf8_danish_ci NOT NULL COMMENT 'Regenerated cron-wise, weighted highest',
  `ft_index10` mediumtext COLLATE utf8_danish_ci NOT NULL COMMENT 'Regenerated cron-wise, weighted medium',
  `ft_index15` mediumtext COLLATE utf8_danish_ci NOT NULL COMMENT 'Regenerated cron-wise, weighted lesser',
  `ft_lastmodified` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' COMMENT 'last cron run',
  PRIMARY KEY (`id`),
  UNIQUE KEY `alias` (`alias`),
  FULLTEXT KEY `ft_index5` (`ft_index5`),
  FULLTEXT KEY `ft_index10` (`ft_index10`),
  FULLTEXT KEY `ft_index15` (`ft_index15`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 COLLATE=utf8_danish_ci; 
```

可以像这样添加索引：

```
ALTER TABLE `oo_pages` ADD FULLTEXT (
`named_column`
) 
```

关于检测语言然后从那时起选择你的停用词数据库的事情是我自己遗漏的一个功能，但它很漂亮 - 而且按书本！所以感谢你的努力和这个答案:)

另外，请记住，不仅有 title 标签，还有 anchor / img title 属性。如果由于某种原因您的分析进入类似*蜘蛛的状态*，我建议将参考链接 ( `<a>`)*标题*和*textContent*与目标页面结合起来`<title>`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-31T13:09:12.037

我建议您使用 Apache SoIr 进行搜索和分析，而不是重新发明轮子。它几乎拥有您可能需要的一切，包括 30 多种语言的停用词检测 [据我所知，可能更多] 并使用存储在其中的数据进行大量工作。

# algorithm - 如何在不丢失连通性的情况下平滑连接的多边形？

> ID：10721850
> 
> 赞同：1
> 
> 时间：2012-05-23T14:17:21.573
> 
> 标签：algorithm, polygon, smooth, polyline, contour

我有许多覆盖一些矩形的多边形。

每个多边形都与某种类型相关联（在可通过下面的链接访问的图像上以颜色显示）。

我需要**平滑多边形并保存拓扑**。

（即我们应该考虑以下约束：

1.  多边形的并集等于某个矩形
2.  任何两个不同多边形的交集都是空的

（它**是集合分区**的定义））

**添加**

egdes 不应该是直的，相反我需要**得到平滑**的多边形边缘。但边缘应保持连接在一起（即**没有间隙和重叠**）

[示例图片](http://i.stack.imgur.com/stJE9.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T06:17:21.473

这是答案的片段。

确保多边形之间不出现间隙的一种方法是设计数据结构，使具有公共边的多边形实际上共享一条边——也就是说，您的数据结构包含一条与两个多边形相关联的边。这也将实现共享边的多边形之间的拓扑关系。

我希望这个答案是不充分的，但请接受您已经获得的提示并澄清您的问题，更详细地解释您拥有什么以及您想要什么。

# c# - 收银程序，在一个发票号中添加两个或多个商品

> ID：10721853
> 
> 赞同：-1
> 
> 时间：2012-05-23T14:17:26.953
> 
> 标签：c#, mysql, database, datagridview

我对c#很陌生..我试图制作一个收银程序，但我坚持，使程序可以在一个发票号中添加两个或多个商品....

这是我的数据库设计，tsiswa 展示客户数据库，tbukux 展示书籍数据库，tpinjam 展示购买和 tdetpinjam 展示购买详细信息

![在此处输入图像描述](../Images/21b47915582d99f9bcc68fab4e165aa5.png)

我真的不知道该怎么做..请帮助我..我真的很感激

对不起我的英语不好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:20:15.680

有什么代码可以给我们看吗？这将帮助我们了解您当前正在尝试执行的操作。

[字典](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)在这里会有很长的路要走。例如：`Key = invoice`和`Value = item`

假设您有发票`#000001`和两个项目`oatmeal`和`cereal`。您要添加`oatmeal`并`cereal`关联到 invoice `#000001`。

# ruby - Ruby 应用程序超时（使用 Phusion Passenger 部署在 Amazon EC2 上）

> ID：10721858
> 
> 赞同：3
> 
> 时间：2012-05-23T14:17:34.800
> 
> 标签：ruby, amazon-ec2, passenger

我正在尝试在 Amazon EC2（Ubuntu + Apache + Passenger）上部署 SequenceServer，但它“挂起”： http: [//ncwebguru.com/sequenceserver](http://ncwebguru.com/sequenceserver)。

“helloworld”应用程序也会发生同样的事情：http: [//ncwebguru.com/sequenceserver1](http://ncwebguru.com/sequenceserver1)

它在我的物理 linux 服务器（不是 EC2）上运行良好。

它不会将任何内容记录到 apache 日志文件中，因此我不确定如何对其进行故障排除。非常感谢有关如何解决或解决问题的任何帮助。

**阿帕奇配置：**

```
<VirtualHost *:80>
    DocumentRoot /var/www
    <Directory /var/www>
        Allow from all
    </Directory>

    RackBaseURI /sequenceserver
    RackBaseURI /sequneceserver1

    <Directory /var/www/sequenceserver>
        Options -MultiViews
    </Directory>
</VirtualHost> 
```

**/var/www 目录：**

```
sequenceserver # sym link to /path/to/actual/sequenceserver/public
sequenceserver1 # sym link to /path/to/helloworld/public 
```

**/path/to/helloworld 目录：**

```
tmp/ # empty
public/ # empty
config.ru # helloworld ruby rack app 
```

**配置.ru**

```
app = proc do |env|
    return [200, { "Content-Type" => "text/html" }, "hello world"]
end
run app 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T05:26:55.147

看起来您需要`TimeOut`在 Apache 的配置文件中设置指令。超时以秒为单位。例如，以下将超时设置为 5 分钟：

```
TimeOut 300 
```

# facebook-javascript-sdk - 如何使用提要对话框在朋友的墙上发帖？

> ID：10721859
> 
> 赞同：1
> 
> 时间：2012-05-23T14:17:34.960
> 
> 标签：facebook-javascript-sdk, feed

我将 FB.ui 与 feed 方法一起使用，以便在用户的墙上发布消息。

```
 // calling the API ...
    var obj = {
      method: 'feed',
      link: 'https://developers.facebook.com/docs/reference/dialogs/',
      picture: 'http://fbrell.com/f8.jpg',
      to: 123457895,
      name: 'Facebook Dialogs',
      caption: 'Reference Documentation',
      description: 'Using Dialogs to interact with users.'
    }; 
```

但是，是否可以使用feed dialog方法一次在几个朋友的墙上发帖？

我测试了将几个 ID 放入元素中，但它似乎不起作用。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-13T14:16:31.727

我讨厌与 superscral 所说的相矛盾，但您可以使用“to：”参数作为 feed 方法。在此处查看当前支持的参数列表：

[https://developers.facebook.com/docs/reference/dialogs/feed/](https://developers.facebook.com/docs/reference/dialogs/feed/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-03T10:56:02.637

Feed Dialog 允许用户仅将消息发布到他们自己的时间线，然后这些消息会出现在他们朋友的 News Feeds/Stream 上。

# oracle - 如何访问oracle数据库（VB.NET）

> ID：10721861
> 
> 赞同：1
> 
> 时间：2012-05-23T14:17:35.707
> 
> 标签：oracle, vb.net-2010, system.data.oracleclient

我是使用 oracle 的新手，在 mvc 控制器中访问它时遇到问题。

这是我在 web.config 文件中定义的连接字符串

```
<connectionStrings>
<add name="DBConnectionString" connectionString="Data Source=abc;Persist Security Info=True;password=123; User Id=user1;"
           providerName="System.Data.OracleClient=" />
</connectionStrings> 
```

如何在控制器中访问此数据库？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:25:12.950

这实际上取决于您用于数据访问的框架。

但是，如果您使用的是纯 ADO.NET，则可以查看该教程：[Advanced Data Access with ADO.NET and Oracle](http://msdn.microsoft.com/en-us/library/ms971488.aspx)

# php - 到达 .php 页面的正确命令是什么？

> ID：10721866
> 
> 赞同：-2
> 
> 时间：2012-05-23T14:17:57.973
> 
> 标签：php

我希望代码上的第 4 行转到页面 index.php ...正确的命令是什么？？？

```
if($count==1){
    echo "Welcome...";
    #LINE 4
}
else {
    echo "Wrong Username or Password";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:28:01.177

我猜你想要这样的重定向：

```
<?php 

if($count==1){
    echo "Welcome...";
    $golink = 'index.php';
   ?>

<html>
<head>
<title>A web page that points a browser to a different page after 2 seconds</title>
<meta http-equiv="refresh" content="2; URL=<?php  echo $golink; ?>">
<meta name="keywords" content="automatic redirection">
</head>
<body>
If your browser doesn't automatically go there within a few seconds, 
you may want to go to 
<a href="<?php echo $golink ?>">the destination</a> 
manually.
</body>
</html>

<?php
    } else {
echo "Wrong Username or Password";
?> 
```

希望这可以帮助 ！

# php - php mysql 特殊字符

> ID：10721867
> 
> 赞同：3
> 
> 时间：2012-05-23T14:18:10.450
> 
> 标签：php, mysql, html

我的桌子是这样的——

```
province_id int(11)                  
province_title char(200) utf8_general_ci 
parent int(8) int(2) 
```

我直接从 phpMyadmin 插入了很多数据（不是从 php 页面）。但是当我检索这些数据并在 php 页面中显示它们时，特殊字符就会出现问题。

像-

```
Québec shows -  Qu�bec. 
```

我的 html 标头看起来像 -

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

我认为问题可能是在插入数据时发生的。如何在 phpmyadmin 中转换这些数据？有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T14:22:33.057

似乎您并没有在*任何地方*使用 utf-8，因此您的数据在某些时候会变得混乱。根据您的具体操作，您必须更改/添加以下一项或多项（很可能是您忘记的`SET CHARSET`/ ）：`mysql_set_charset`

*   告诉 MySQL 使用 utf-8。为此，请将其添加到您的 my.cnf：

    > ```
    > collation_server = utf8_unicode_ci
    > character_set_server = utf8 
    > ```

*   在与 mysql 交互之前，发送这两个查询：

    > ```
    > SET NAMES 'utf8';
    > CHARSET 'utf8'; 
    > ```

    或者，或者，让 php 在打开连接后执行此操作：

    > ```
    > mysql_set_charset('utf8', $conn); // when using the mysql_-functions
    > mysqli::set_charset('utf8') // when using mysqli 
    > ```

*   将 UTF-8 设置为数据库的默认字符集

    > ```
    > CREATE DATABASE `my_db` DEFAULT CHARACTER SET 'utf8'; 
    > ```

*   对表格执行相同的操作：

    > ```
    > CREATE TABLE `my_table` (
    >   -- ...
    > ) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
    > ```

*   假设客户端是浏览器，将您的内容作为 utf-8 和正确的标头提供：

    > ```
    > header('Content-type: text/html; charset=utf-8'); 
    > ```

    为了确保浏览器能够理解，添加一个元标记：

    > ```
    > <meta http-equiv="Content-type" content="text/html; charset=utf-8" /> 
    > ```

*   最后但同样重要的是，告诉浏览器使用 utf-8 提交表单

    > ```
    > <form accept-charset="utf-8" ...> 
    > ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:21:49.560

问题可能是您连接到 MySQL 的字符集。见[mysql_set_charset](http://php.net/manual/en/function.mysql-set-charset.php)或[mysqli::set_charset](http://php.net/manual/en/mysqli.set-charset.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:22:13.387

MySQL 服务器未配置为默认来自客户端的 UTF-8 编码。

所以你必须使用打开连接

```
mysql_query("SET NAMES utf8"); 
```

如果您使用的是 PDO，

```
$options = array(
    PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES utf8',
); 

$dbh = new PDO($dsn, $username, $password, $options); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T14:22:54.467

如果在 phpmyadmin 中看到数据时它看起来没问题，则问题可能出在文件本身的文本编码上。

使用 Eclipse（编辑 » 设置编码）或 Notepad++（编码）来确认您在文件中具有正确的编码。

# xamarin.ios - monotouch 不再将 xib 与 .cs 和 .designer.cs 文件结合使用

> ID：10721869
> 
> 赞同：1
> 
> 时间：2012-05-23T14:18:12.417
> 
> 标签：xamarin.ios, monodevelop

在升级到 Mono 2.10.9、XCode 4.2 和 Monotouch 5.2.11 之前，我以前只看到 myfile.xib 文件和“underneath”（在扩展模式下），我会看到相应的 myfile.xib.cs 和 myfile.xib。设计师.cs 文件。

现在我看到了 myfile.xib 本身和一个单独的 myfile.cs，下面有 myfile.designer.cs。

谁能告诉我这是为什么以及如何回到以前的状态？（即只有一个 xib，下面有 cs 和设计器文件）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T18:50:35.693

这是设计使然。不再有 foo.xib.designer.cs 文件，因为 Xcode 4 中的 xib 没有定义类，因此无法从它们生成类。相反，*类*具有设计器部分，并且设计器直接修改类的设计器部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T15:31:28.687

这就是自 MonoDevelop 2.6 以来的情况。当独立的 Interface Builder “死”时，有些东西发生了变化，这就是其中之一。

据我了解，除非您不介意拥有过时的东西，否则您无法回到过去。

**编辑：** 我认为这样更好，因为我以前经常不小心打开 XIB 文件，而不是我想用旧版本打开的源文件。

# ios - 如何为 iOS 应用创建自定义容器视图？

> ID：10721870
> 
> 赞同：0
> 
> 时间：2012-05-23T14:18:14.620
> 
> 标签：ios, ipad, uiviewcontroller

我开始开发一个 iPad 应用程序，我希望顶部有一个工具栏，它将在其下方显示不同的视图，如下图所示： ![基本布局](../Images/30a553ef8953c51932f65e9b9a2fdb97.png)

因此，当按下每个按钮时，工具栏应保持在原位，并且不同的视图控制器应在该空间中显示其视图。我通读了 Apples ViewController 编程指南，这似乎是可能的，但我只是不知何故没有获得让视图控制器在底部矩形内显示其视图所需的实际方法。

拥有一个管理工具栏的容器视图，然后创建一个视图控制器以在该下部矩形内显示子视图是否合理？

编辑：

我想按照以下方式做一些事情：

```
-(IBAction)hitMapButton{
    MapViewController *mapView = [[MapViewController alloc] initWithNibName:@"MapView" bundle:nil];
    [self addChildViewController:mapView];
    [mapView release];
} 
```

但我不知道如何实际绘制视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:36:01.383

使用“创建标签栏”搜索 Apple 文档。您会找到几个文档：以编程方式创建、使用 segue 进行创建等。您还可以根据该搜索查看许多示例项目，例如“Tabster”（一个有点过时但肯定会的 iPhone 应用程序）帮助您 - 将目标编辑为“iPad”）。

您可以通过创建一个新的 Xcode 项目并选择“选项卡式应用程序”来获得一个工作起点

请注意，UITabBarController 将标签栏放在底部 - 如果您正在考虑将其放在顶部，您还应该阅读“用户体验指南”

# imagemap - 使用 fadeToggle() 单击事件 - 我的代码有什么问题？

> ID：10721873
> 
> 赞同：0
> 
> 时间：2012-05-23T14:18:24.230
> 
> 标签：imagemap, jquery

`<map>`我使用定义了 15 个标签的标签创建了伦敦的交互式地图`<area>`。在点击 15 个区域中的任何一个后，地图的来源将根据点击的区域被另一个替换。所有区域都有一个单独的 ID，并且源根据该 ID 更改。

再次单击该区域会将地图图像恢复为其原始来源。

简化的 HTML 有点像这样：

```
<IMG id="londonmap" SRC="images/londonmap.png" USEMAP="#london">
<map name="london">
<area id="dalston" href="#" shape="rect" coords="364,75,500,200"
      alt="Dalston Tube Stop" title="Dalston Area">
</map> 
```

我用于单击和取消单击的 jQuery 如下所示：

```
$(document).ready(function()
{
    $('#dalston').click(function()
    {
        // select the image and determine what the next src will be
        var londonMap = $('#londonmap');
        var newImageSrc = londonMap.attr('src') != 'images/dalstonmap.png' ? 'images/dalstonmap.png' : 'images/londonmap.png';

        // re-bind the src attribute
        londonMap.attr('src', newImageSrc);
    });
 }); 
```

到这里为止的一切都很好。现在，我认为这会很好，只需一点额外的效果就可以`.fadeToggle()`在单击时更改图像以获得更平滑的过渡，因此将代码更改为：

```
$(document).ready(function()
{
$('#dalston').click(function() {
    $('#londonmap').fadeToggle('slow', function()
    {
        // select the image and determine what the next src will be
        var londonMap = $('#londonmap');
        var newImageSrc = londonMap.attr('src') != 'images/dalstonmap.png' ? 'images/dalstonmap.png' : 'images/londonmap.png';

        // re-bind the src attribute
        londonMap.attr('src', newImageSrc);
    });
     });
 }); 
```

现在的问题是只有一半的代码像我预期的那样做出反应——原始图像淡出，但第二个永远不会取代它的位置。我猜这与事件发生的顺序有关，但作为 jQuery 中的一个菜鸟，我真的无法判断出了什么问题。

任何帮助将不胜感激，因为这是阻止我完成地图的最后一件事！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:28:38.210

一旦使用该`fadeToggle`函数消失，您就永远不会真正显示元素。交换图像后，您需要将其显示回来。

* * *

更新

```
$(document).ready(function()
{
$('#dalston').click(function() {
    $('#londonmap').fadeOut('slow', function() {
        // select the image and determine what the next src will be
        var londonMap = $('#londonmap');
        var newImageSrc = londonMap.attr('src') != 'images/dalstonmap.png' ? 'images/dalstonmap.png' : 'images/londonmap.png';

        // re-bind the src attribute
        londonMap.attr('src', newImageSrc);
        $('#londonmap').fadeIn('slow');
        });
    });
}); 
```

或者在[这里查看](http://jsfiddle.net/934n7/1/)工作示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:25:52.683

尝试：

```
$(document).ready(function()
{
$('#dalston').click(function() {
    $('#londonmap').fadeToggle('slow', function()
    {
        // select the image and determine what the next src will be
        var londonMap = $('#londonmap');
        var newImageSrc = londonMap.attr('src') != 'images/dalstonmap.png' ? 'images/dalstonmap.png' : 'images/londonmap.png';

        // re-bind the src attribute
        londonMap.attr('src', newImageSrc);
        //show the image
        $('#londonmap').fadeToggle('slow');
    });
     });
 }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:33:56.017

你还没有告诉它反转切换，试试这个

```
$(document).ready(function() {

    $('#dalston').click(function() {

        $('#londonmap').fadeToggle('slow', function() {

            // select the image and determine what the next src will be
            var newImageSrc = $(this).attr('src') != 'images/dalstonmap.png' ? 'images/dalstonmap.png' : 'images/londonmap.png';

            // re-bind the src attribute and fade back in
            $(this).attr('src', newImageSrc).fadeToggle('slow');
        });
    });
}); 
```

# php - 一旦我尝试在文件夹中包含文件，我的相对路径就会中断？

> ID：10721874
> 
> 赞同：1
> 
> 时间：2012-05-23T14:18:28.563
> 
> 标签：php, ubuntu, include, include-path

只是想知道我在这里做错了什么。我一直在设置一个linux开发环境。如果我做这样的事情：

```
include 'test.php'; 
```

它工作得很好。

如果我然后将我的 test.php 文件移动到一个名为 test 的文件夹中并执行以下操作：

```
include 'test/test.php'; 
```

它失败。到底是怎么回事？

我也试过：

```
include '/var/www/site/test/test.php';
include '/test/test.php';
include '../test/test.php'; 
```

等等，没有运气。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:33:14.797

你试过了`require('test/test.php');`吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:35:08.447

包含您包含文件的文件夹（以及您要求 php 引擎访问的任何其他嵌套文件夹）应该设置其可执行标志。

在 linux 终端中：

```
chmod a+x /var/www/site/test 
```

检查权限：

```
ls -l /var/www/site | grep "test" 
```

# wpf - wpf datagridcheckbox列样式

> ID：10721880
> 
> 赞同：5
> 
> 时间：2012-05-23T14:18:38.780
> 
> 标签：wpf, xaml, wpfdatagrid

想象一下，我有一个名为“MyCheckBoxStyle”的 CheckBox 自定义样式。

如何根据我的 MyCheckBoxStyle 制作嵌入自定义 DataGridCheckBoxColumn 样式的 Datagrid 样式？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-10T19:11:39.783

您可以简单地将定义的样式与**ElementStyle**属性一起使用。

资源中定义的样式：

```
<Style x:Key="MyCheckBoxStyle" TargetType="{x:Type CheckBox}"> ... </Style> 
```

我的数据网格复选框列：

```
<DataGridCheckBoxColumn ElementStyle="{StaticResource MyCheckBoxStyle}" Binding="{Binding someValue}" /> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-23T15:02:21.277

尝试这个

```
<DataGridCheckBoxColumn MinWidth="100"
               Binding="{Binding Path=BoolValue}"
               Header="Bool Column"
               IsThreeState="True">
                <DataGridCheckBoxColumn.ElementStyle>
                    <Style TargetType="CheckBox">
                        <Setter Property="Background" Value="{Binding BoolValueColour, Converter={StaticResource MyConverter}}" />    
                    </Style>
                </DataGridCheckBoxColumn.ElementStyle>
 </DataGridCheckBoxColumn> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-23T14:27:05.287

您可以使用 DataGridTemplateColumn 创建自定义复选框列

```
 <Custom:DataGridTemplateColumn x:Name="gdchk" Header="Test" MaxWidth="50">
                                <Custom:DataGridTemplateColumn.CellTemplate >
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding Path = classname}" HorizontalAlignment="Center" Style="{DynamicResource myCheckBoxStyle}"/>
                                    </DataTemplate>
                                </Custom:DataGridTemplateColumn.CellTemplate>
                            </Custom:DataGridTemplateColumn> 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-25T19:34:30.517

在我找到以下解决方法之前，我没有工作：

```
<DataGridTemplateColumn
    Header="Skip" Width="18" 
    IsReadOnly="False" CanUserResize="False">
    <DataGridTemplateColumn.CellTemplate >
        <DataTemplate DataType="gfxModule:BatchPairItemModel">
            <CheckBox

                Tag="{Binding}"
                IsChecked="{Binding Tag.Skip, Mode=TwoWay, 
                    RelativeSource={RelativeSource Self}}" 

                Template="{DynamicResource CheckBoxCircleXTemplate}"
                ToolTip="Skip"
             />
        </DataTemplate>
    </DataGridTemplateColumn.CellTemplate>
</DataGridTemplateColumn> 
```

# ios - 我的堆栈跟踪到哪里去了？

> ID：10721882
> 
> 赞同：6
> 
> 时间：2012-05-23T14:18:45.210
> 
> 标签：ios, xcode, exception, stack-trace

我不确定我做了什么，这样已经多久了（因为我已经忍受了一段时间）......但是我在 Xcode 的调试器中丢失了堆栈跟踪......有点。下面是我的应用程序崩溃时看到的屏幕截图：

![在此处输入图像描述](../Images/a4e028f40edc1c17f239cc4589e639f2.png)

在控制台中我看到了这个：

![在此处输入图像描述](../Images/ded3222dba2b9dde237371e1135d09ac.png)

所以我可以从控制台找出问题所在，但是我错过了可以单击类文件并跳转到崩溃源的堆栈跟踪。

会不会是LLDB？最新的 Xcode？还有什么东西吞噬了我的例外？有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T17:52:35.887

问题是当异常发生时调试器没有停止，当程序崩溃时它正在停止。这发生在异常展开堆栈之后，这意味着源不再存在。如果希望调试器在堆栈展开之前停止，则需要在抛出异常时设置断点。Xcode 让这一切变得简单。转到项目窗口中的断点部分。

![在此处输入图像描述](../Images/88956acacb077fbfd3502dacf7dc0a93.png)

然后，单击左下角的`+`按钮并选择“添加异常断点...”。确保新断点设置为在 throw 时触发，否则在堆栈展开后仍会发生。

![在此处输入图像描述](../Images/b7e1d1ca6b49bd50600e91ef5ccc6bc5.png)

# javascript - 将 HTML 渲染为图像

> ID：10721884
> 
> 赞同：243
> 
> 时间：2012-05-23T14:19:05.633
> 
> 标签：javascript, html, css, image, render

有没有办法将html呈现为像PNG这样的图像？我知道画布是可能的，但我想渲染标准的 html 元素，例如 div 。

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2017-09-15T15:44:30.127

有很多选择，它们都有自己的优点和缺点。

# 选项 1：使用 API

*   [ApiFlash](https://apiflash.com/)（基于 chrome）
*   [EvoPDF](http://www.evopdf.com)（有 html 选项）
*   [格拉布齐特](https://grabz.it/html-to-pdf-image-api.aspx)
*   [HTML/CSS 到图像 API](https://htmlcsstoimage.com)
*   ...

**优点**

*   执行 Javascript
*   近乎完美的渲染
*   正确使用缓存选项时速度快
*   规模由 API 处理
*   精确的时间，视口，...
*   大多数时候他们提供免费计划

**缺点**

*   如果您打算大量使用它们，则不是免费的

# 选项 2：使用众多可用库之一

*   [域到图像](https://github.com/tsayen/dom-to-image)
*   [wkhtmltoimage](https://github.com/wkhtmltopdf/wkhtmltopdf)（包含在 wkhtmltopdf 工具中）
*   [IMGKit](https://github.com/csquared/IMGKit)（用于 ruby​​ 并基于 wkhtmltoimage）
*   [imgkit](https://github.com/jarrekk/imgkit)（用于 python 并基于 wkhtmltoimage）
*   [python-webkit2png](https://github.com/adamn/python-webkit2png)
*   ...

**优点**

*   大多数时候转换非常快

**缺点**

*   渲染不良
*   不执行 javascript
*   不支持最近的 Web 功能（FlexBox、高级选择器、Webfonts、Box Sizing、媒体查询......）
*   有时不那么容易安装
*   规模复杂

# 选项 3：使用 PhantomJs 和包装库

*   [幻影](http://phantomjs.org/)
*   [node-webshot](https://github.com/brenden/node-webshot)（PhantomJs 的 javascript 包装库）
*   ...

**优点**

*   执行 Javascript
*   蛮快

**缺点**

*   渲染不良
*   不支持最近的 Web 功能（FlexBox、高级选择器、Webfonts、Box Sizing、媒体查询......）
*   规模复杂
*   如果要加载图像，要让它工作就不是那么容易了……

# 选项 4：使用 Chrome Headless 和包装库

*   [无头镀铬](https://developers.google.com/web/updates/2017/04/headless-chrome)
*   [chrome-devtools-协议](https://chromedevtools.github.io/devtools-protocol/)
*   [Puppeteer](https://github.com/GoogleChrome/puppeteer)（Chrome 无头的 javascript 包装库）
*   ...

**优点**

*   执行 Javascript
*   近乎完美的渲染

**缺点**

*   获得关于以下方面的确切结果并不容易：
    *   页面加载时间
    *   视口尺寸
*   规模复杂
*   如果 html 包含外部链接，则相当慢甚至更慢

*披露：我是 ApiFlash 的创始人。我尽我所能提供一个诚实和有用的答案。*

* * *

## 回答 #2

> 赞同：112
> 
> 时间：2012-05-23T14:26:00.623

是的。[HTML2Canvas 的](http://html2canvas.hertzen.com/)存在是为了将 HTML 渲染到上面`<canvas>`（然后您可以将其用作图像）。

注意：有一个已知问题，这不适用于 SVG

* * *

## 回答 #3

> 赞同：108
> 
> 时间：2015-09-25T07:20:01.193

我可以推荐[dom-to-image](https://github.com/tsayen/dom-to-image)库，它是专门为解决这个问题而编写的（我是维护者）。
这是你如何使用它（更多[在这里](https://github.com/tsayen/dom-to-image#usage)）：

```
var node = document.getElementById('my-node');

domtoimage.toPng(node)
    .then (function (dataUrl) {
        var img = new Image();
        img.src = dataUrl;
        document.appendChild(img);
    })
    .catch(function (error) {
        console.error('oops, something went wrong!', error);
    }); 
```

* * *

## 回答 #4

> 赞同：71
> 
> 时间：2018-10-30T15:03:06.340

这里的所有答案都使用第三方库，而将 HTML 渲染到图像在纯 Javascript 中可能相对简单。在MDN 的画布部分~~甚至~~有[一篇关于它的文章。](https://web.archive.org/web/20181006205840/https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Drawing_DOM_objects_into_a_canvas)

诀窍是这样的：

*   使用包含您的 XHTML 的 foreignObject 节点创建一个 SVG
*   将图像的 src 设置为该 SVG 的数据 url
*   `drawImage`到画布上
*   将画布数据设置为目标 image.src

```
const {body} = document

const canvas = document.createElement('canvas')
const ctx = canvas.getContext('2d')
canvas.width = canvas.height = 100

const tempImg = document.createElement('img')
tempImg.addEventListener('load', onTempImageLoad)
tempImg.src = 'data:image/svg+xml,' + encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100"><foreignObject width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml"><style>em{color:red;}</style><em>I</em> lick <span>cheese</span></div></foreignObject></svg>')

const targetImg = document.createElement('img')
body.appendChild(targetImg)

function onTempImageLoad(e){
  ctx.drawImage(e.target, 0, 0)
  targetImg.src = canvas.toDataURL()
}
```

一些注意事项

*   SVG 中的 HTML 必须是 XHTML
*   出于安全原因，SVG 作为图像的数据 url 充当 HTML 的隔离 CSS 范围，因为无法加载外部源。因此，例如必须使用像[这样](https://amio.github.io/embedded-google-fonts/)的工具内联 Google 字体。
*   即使 SVG 中的 HTML 超过了图像的大小，它也会正确地绘制到画布上。但是无法从该图像中测量实际高度。固定高度解决方案可以正常工作，但动态高度需要更多工作。最好的办法是将 SVG 数据渲染到 iframe 中（用于隔离 CSS 范围），并将结果大小用于画布。

* * *

## 回答 #5

> 赞同：56
> 
> 时间：2019-05-17T22:25:43.133

我知道这是一个相当古老的问题，已经有很多答案，但我仍然花了几个小时试图真正做我想做的事：

*   给定一个 html 文件，从命令行生成一个具有**透明背景的 (png) 图像**

使用 Chrome 无头（本响应版本为 74.0.3729.157），实际上很容易：

```
"/Applications/Google Chrome.app/Contents/MacOS/Google Chrome" --headless --screenshot --window-size=256,256 --default-background-color=0 button.html 
```

命令解释：

*   您从命令行运行 Chrome（此处显示的是 Mac，但假设在 Windows 或 Linux 上类似）
*   `--headless`运行 Chrome 而不打开它并在命令完成后退出
*   `--screenshot``screenshot.png`将捕获屏幕截图（请注意，它会在运行命令的文件夹中生成一个名为的文件）
*   `--window-size`只允许捕获屏幕的一部分（格式为`--window-size=width,height`）
*   `--default-background-color=0`是告诉 Chrome 使用**透明**背景而不是默认白色的魔术技巧
*   最后你提供 html 文件（作为本地或远程的 url...）

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2013-10-16T23:25:02.557

您可以使用[PhantomJS](http://phantomjs.org)，它是一个无头 webkit（safari 中的渲染引擎和（直到最近）chrome）驱动程序。[您可以在此处](http://phantomjs.org/screen-capture.html)了解如何对页面进行屏幕截图。希望有帮助！

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2016-11-22T23:05:56.093

我为 Chrome、Firefox 和 MS Edge 工作的唯一库是[rasterizeHTML](https://github.com/cburgmer/rasterizeHTML.js)。它输出比 HTML2Canvas 更好的质量，并且与 HTML2Canvas 不同的是仍然受支持。

**获取元素并下载为 PNG**

```
var node= document.getElementById("elementId");
var canvas = document.createElement("canvas");
canvas.height = node.offsetHeight;
canvas.width = node.offsetWidth;
var name = "test.png"

rasterizeHTML.drawHTML(node.outerHTML, canvas)
     .then(function (renderResult) {
            if (navigator.msSaveBlob) {
                window.navigator.msSaveBlob(canvas.msToBlob(), name);
            } else {
                const a = document.createElement("a");
                document.body.appendChild(a);
                a.style = "display: none";
                a.href = canvas.toDataURL();
                a.download = name;
                a.click();
                document.body.removeChild(a);
            }
     }); 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2012-05-23T14:23:01.747

您可以使用 HTML 转 PDF 工具，例如 wkhtmltopdf。然后你可以使用像 imagemagick 这样的 PDF 图像工具。诚然，这是服务器端和一个非常复杂的过程......

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2020-08-24T11:57:56.343

我阅读了 Sjeiti 的答案，我发现它非常有趣，您只需几行纯 JavaScript 行就可以在图像中呈现 HTML。

我们当然必须意识到这种方法的局限性（请在他的回答中阅读其中的一些）。

在这里，我将他的代码更进一步。

SVG 图像原则上具有无限分辨率，因为它是矢量图形。但是您可能已经注意到，Sjeiti 的代码生成的图像没有高分辨率。这可以通过在将 SVG 图像传输到画布元素之前对其进行缩放来解决，我在下面给出的两个（可运行）示例代码中的最后一个中完成了这一点。我在该代码中实现的另一件事是最后一步，即将其保存为 PNG 文件。只是为了完成整个事情。

所以，我给出了两个可运行的代码片段：

第一个演示了 SVG 的无限分辨率。运行它并使用浏览器放大，以查看放大时分辨率不会降低。

在您可以运行的代码段中，我使用了反引号来指定带有换行符的所谓模板字符串，以便您可以更清楚地看到呈现的 HTML。但否则，如果该 HTML 在一行之内，那么代码将非常短，就像这样。

```
const body = document.getElementsByTagName('BODY')[0];
const img = document.createElement('img')
img.src = 'data:image/svg+xml,' + encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200"><foreignObject width="100%" height="100%"><div xmlns="http://www.w3.org/1999/xhtml" style="border:1px solid red;padding:20px;"><style>em {color:red;}.test {color:blue;}</style>What you see here is only an image, nothing else.<br /><br /><em>I</em> really like <span class="test">cheese.</span><br /><br />Zoom in to check the resolution!</div></foreignObject></svg>`);        
body.appendChild(img); 
```

这里它是一个可运行的片段。

```
const body = document.getElementsByTagName('BODY')[0];
const img = document.createElement('img')
img.src = 'data:image/svg+xml,' + encodeURIComponent(`
  <svg xmlns="http://www.w3.org/2000/svg" width="200" height="200">
    <foreignObject width="100%" height="100%">
      <div xmlns="http://www.w3.org/1999/xhtml" style="border:1px solid red;padding:20px;">
        <style>
          em {
            color:red;
          }
          .test {
            color:blue;
          }
        </style>
        What you see here is only an image, nothing
        else.<br />
        <br />
        <em>I</em> really like <span class="test">cheese.</span><br />
        <br />
        Zoom in to check the resolution!
      </div>
    </foreignObject>
  </svg>
`);
body.appendChild(img);
```

放大并检查 SVG 的无限分辨率。

下面的下一个可运行文件实现了我上面提到的两个额外步骤，即通过首先缩放 SVG 来提高分辨率，然后将其保存为 PNG 图像。

```
window.addEventListener("load", doit, false)
var canvas;
var ctx;
var tempImg;
function doit() {
    const body = document.getElementsByTagName('BODY')[0];
    const scale = document.getElementById('scale').value;
    let trans = document.getElementById('trans').checked;
  if (trans) {
    trans = '';
  } else {
    trans = 'background-color:white;';
  }
    let source = `
        <div xmlns="http://www.w3.org/1999/xhtml" style="border:1px solid red;padding:20px;${trans}">
            <style>
                em {
                    color:red;
                }
                .test {
                    color:blue;
                }
            </style>
            What you see here is only an image, nothing
            else.<br />
            <br />
            <em>I</em> really like <span class="test">cheese.</span><br />
            <br />
            <div style="text-align:center;">
                Scaling:
                <br />
                ${scale} times!
            </div>
        </div>`
    document.getElementById('source').innerHTML = source;
    canvas = document.createElement('canvas');
    ctx = canvas.getContext('2d');
    canvas.width = 200*scale;
    canvas.height = 200*scale;
    tempImg = document.createElement('img');
    tempImg.src = 'data:image/svg+xml,' + encodeURIComponent(`
        <svg xmlns="http://www.w3.org/2000/svg" width="${200*scale}" height="${200*scale}">
            <foreignObject 
                style="
                    width:200px;
                    height:200px;
                    transform:scale(${scale});
                "
            >` + source + `
            </foreignObject>
        </svg>
    `);
}
function saveAsPng(){
    ctx.drawImage(tempImg, 0, 0);
    var a  = document.createElement('a');
    a.href = canvas.toDataURL('image/png');
    a.download = 'image.png';
    a.click();
}
```

```
<table border="0">
    <tr>
        <td colspan="2">
            The claims in the HTML-text is only true for the image created when you click the button.
        </td>
    </tr>
    <tr>
        <td width="250">
            <div id="source" style="width:200px;height:200px;">
            </div>
        </td>
        <td valign="top">
            <div>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In this example the PNG-image will be squarish even if the HTML here on the left is not exactly squarish. That can be fixed.<br>
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To increase the resolution of the image you can change the scaling with this slider.
                <div style="text-align:right;margin:5px 0px;">
                    <label style="background-color:#FDD;border:1px solid #F77;padding:0px 10px;"><input id="trans" type="checkbox" onchange="doit();" />&nbsp;&nbsp;Make it transparent</label>
                </div>
                <span style="white-space:nowrap;">1<input id="scale" type="range" min="1" max="10" step="0.25" value="2" oninput="doit();" style="width:150px;vertical-align:-8px;" />10&nbsp;&nbsp;<button onclick="saveAsPng();">Save as PNG-image</button></span>
            </div>

        </td>
    </tr>
</table>
```

尝试不同的缩放比例。例如，如果您将缩放设置为 10，那么您会在生成的 PNG 图像中获得非常好的分辨率。**我添加了一个额外的功能**：一个复选框，以便您可以根据需要使 PNG 图像透明。

# *注意：*

*当此脚本在 Stack Overflow 上运行时，保存按钮在 Chrome 和 Edge 中不起作用。原因是这个[https://www.chromestatus.com/feature/5706745674465280](https://www.chromestatus.com/feature/5706745674465280)。*

*因此，我还将此代码段放在了适用于这些浏览器的[https://jsfiddle.net/7gozdq5v/上。](https://jsfiddle.net/7gozdq5v/)*

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2018-07-05T04:59:10.583

使用此代码，它肯定会起作用：

```
<script type="text/javascript">
 $(document).ready(function () {
	 setTimeout(function(){
		 downloadImage();
	 },1000)
 });

 function downloadImage(){
	 html2canvas(document.querySelector("#dvContainer")).then(canvas => {
		a = document.createElement('a'); 
		document.body.appendChild(a); 
		a.download = "test.png"; 
		a.href =  canvas.toDataURL();
		a.click();
	});	 
 }
</script>
```

只是不要忘记在您的程序中包含 Html2CanvasJS 文件。 [https://html2canvas.hertzen.com/dist/html2canvas.js](https://html2canvas.hertzen.com/dist/html2canvas.js)

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2018-06-08T09:37:31.573

使用**html2canvas**只需包含插件和调用方法将 HTML 转换为 Canvas 然后下载为图像 PNG

```
 html2canvas(document.getElementById("image-wrap")).then(function(canvas) {
            var link = document.createElement("a");
            document.body.appendChild(link);
            link.download = "manpower_efficiency.jpg";
            link.href = canvas.toDataURL();
            link.target = '_blank';
            link.click();
        }); 
```

**来源**：[http ://www.freakyjolly.com/convert-html-document-into-image-jpg-png-from-canvas/](http://www.freakyjolly.com/convert-html-document-into-image-jpg-png-from-canvas/)

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2012-06-09T19:46:46.140

仅使用 JavaScript 无法 100% 准确地做到这一点。

那里有一个 Qt Webkit[工具](http://code.google.com/p/cutewebshot/)和一个[python 版本](https://github.com/AdamN/python-webkit2png)。如果你想自己做，我在 Cocoa 上取得了成功：

```
[self startTraverse:pagesArray performBlock:^(int collectionIndex, int pageIndex) {

    NSString *locale = [self selectedLocale];

    NSRect offscreenRect = NSMakeRect(0.0, 0.0, webView.frame.size.width, webView.frame.size.height);
    NSBitmapImageRep* offscreenRep = nil;      

    offscreenRep = [[NSBitmapImageRep alloc] initWithBitmapDataPlanes:nil
                                             pixelsWide:offscreenRect.size.width
                                             pixelsHigh:offscreenRect.size.height
                                             bitsPerSample:8
                                             samplesPerPixel:4
                                             hasAlpha:YES
                                             isPlanar:NO
                                             colorSpaceName:NSCalibratedRGBColorSpace
                                             bitmapFormat:0
                                             bytesPerRow:(4 * offscreenRect.size.width)
                                             bitsPerPixel:32];

    [NSGraphicsContext saveGraphicsState];

    NSGraphicsContext *bitmapContext = [NSGraphicsContext graphicsContextWithBitmapImageRep:offscreenRep];
    [NSGraphicsContext setCurrentContext:bitmapContext];
    [webView displayRectIgnoringOpacity:offscreenRect inContext:bitmapContext];
    [NSGraphicsContext restoreGraphicsState];

    // Create a small + large thumbs
    NSImage *smallThumbImage = [[NSImage alloc] initWithSize:thumbSizeSmall];  
    NSImage *largeThumbImage = [[NSImage alloc] initWithSize:thumbSizeLarge];

    [smallThumbImage lockFocus];
    [[NSGraphicsContext currentContext] setImageInterpolation:NSImageInterpolationHigh];  
    [offscreenRep drawInRect:CGRectMake(0, 0, thumbSizeSmall.width, thumbSizeSmall.height)];  
    NSBitmapImageRep *smallThumbOutput = [[NSBitmapImageRep alloc] initWithFocusedViewRect:CGRectMake(0, 0, thumbSizeSmall.width, thumbSizeSmall.height)];  
    [smallThumbImage unlockFocus];  

    [largeThumbImage lockFocus];  
    [[NSGraphicsContext currentContext] setImageInterpolation:NSImageInterpolationHigh];  
    [offscreenRep drawInRect:CGRectMake(0, 0, thumbSizeLarge.width, thumbSizeLarge.height)];  
    NSBitmapImageRep *largeThumbOutput = [[NSBitmapImageRep alloc] initWithFocusedViewRect:CGRectMake(0, 0, thumbSizeLarge.width, thumbSizeLarge.height)];  
    [largeThumbImage unlockFocus];  

    // Write out small
    NSString *writePathSmall = [issueProvider.imageDestinationPath stringByAppendingPathComponent:[NSString stringWithFormat:@"/%@-collection-%03d-page-%03d_small.png", locale, collectionIndex, pageIndex]];
    NSData *dataSmall = [smallThumbOutput representationUsingType:NSPNGFileType properties: nil];
    [dataSmall writeToFile:writePathSmall atomically: NO];

    // Write out lage
    NSString *writePathLarge = [issueProvider.imageDestinationPath stringByAppendingPathComponent:[NSString stringWithFormat:@"/%@-collection-%03d-page-%03d_large.png", locale, collectionIndex, pageIndex]];
    NSData *dataLarge = [largeThumbOutput representationUsingType:NSPNGFileType properties: nil];
    [dataLarge writeToFile:writePathLarge atomically: NO];
}]; 
```

希望这可以帮助！

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2012-05-23T14:25:06.090

我不认为这是最好的答案，但它似乎很有趣，可以发布。

编写一个应用程序，将您最喜欢的浏览器打开到所需的 HTML 文档、适当调整窗口大小并截屏。然后，删除图像的边框。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2020-11-09T12:10:14.287

这就是我所做的。

注意：请检查 App.js 的代码。

[链接到源代码](https://github.com/Vijay-Gaikwad/html-to-image)

喜欢的话可以给个star哦✌️

**更新**：

```
import * as htmlToImage from 'html-to-image';
import download from 'downloadjs';

import logo from './logo.svg';
import './App.css';

const App = () => {
  const onButtonClick = () => {
    var domElement = document.getElementById('my-node');
    htmlToImage.toJpeg(domElement)
      .then(function (dataUrl) {
        console.log(dataUrl);
        download(dataUrl, 'image.jpeg');
      })
      .catch(function (error) {
        console.error('oops, something went wrong!', error);
      });
  };
  return (
    <div className="App" id="my-node">
      <header className="App-header">
        <img src={logo} className="App-logo" alt="logo" />
        <p>
          Edit <code>src/App.js</code> and save to reload.
        </p>
        <a
          className="App-link"
          href="https://reactjs.org"
          target="_blank"
          rel="noopener noreferrer"
        >
          Learn React
        </a><br></br>
        <button onClick={onButtonClick}>Download as JPEG</button>
      </header>
    </div>
  );
}

export default App; 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2021-06-08T08:16:59.030

我也关注这个问题。我发现这是解决您问题的最佳方法

我们可以使用`html-to-image`javascript 库将 HTML 代码转换为图像

> npm install html-to-image

HTML 代码

```
<div>
<div id="capture">
 <p>
    <span>Heading Of Image</span><br></br>
    <span>This is color Image</span><br></br>
    <img src="Your/ImagePath/ifany.jpg" width="100%" />
    <span>Footer Of the Image</span>
 </p>
</div>
<h2>Generated Image</h2>
<div id="real">
</div></div> 
```

Javascript代码

```
var htmlToImage = require('html-to-image');
var node = document.getElementById('capture');
htmlToImage.toJpeg(node, { quality: 1, backgroundColor: "#FFFFFF", height: node.clientHeight, width: node.clientWidth })
    .then(function (dataUrl) {
        var img = new Image();
        img.src = dataUrl;
        var div = document.getElementById("real")
        div.appendChild(img)
    })
    .catch(function (error) {
        console.error('oops, something went wrong!', error);
    }); 
```

通过这个示例，您现在可以在`<div>`标签 where 中看到您的图像`id = 'real'`。您现在可以在代码中添加保存和下载或上传图像选项。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-08-31T20:24:51.930

安装 phantomjs

```
$ npm install phantomjs 
```

使用以下代码创建文件 github.js

```
var page = require('webpage').create();
//viewportSize being the actual size of the headless browser
page.viewportSize = { width: 1024, height: 768 };
page.open('http://github.com/', function() {
    page.render('github.png');
    phantom.exit();
}); 
```

将文件作为参数传递给 phantomjs

```
$ phantomjs github.js 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-07-08T10:27:35.870

HtmlToImage.jar 是将 html 转换为图像的最简单方法

[使用java将HTML转换为图像](https://stackoverflow.com/questions/36933054/converting-html-to-image-using-java)

* * *

## 回答 #18

> 赞同：-4
> 
> 时间：2015-11-11T06:47:44.683

您可以**将引用** [HtmlRenderer](http://htmlrenderer.codeplex.com/documentation)添加到您的项目并执行以下操作，

```
string htmlCode ="<p>This is a sample html.</p>";
Image image = HtmlRender.RenderToImage(htmlCode ,new Size(500,300)); 
```

# web-services - 如何从谷歌图书 API 获取超大封面图片？

> ID：10721886
> 
> 赞同：14
> 
> 时间：2012-05-23T14:19:15.270
> 
> 标签：web-services, google-books

根据谷歌文档，使用这个链接可以获得超大的一本书的 URL

[谷歌文档](https://developers.google.com/books/docs/v1/using#RetrievingVolume)

但是，当我单击[https://www.googleapis.com/books/v1/volumes/zyTCAlFPjgYC](https://www.googleapis.com/books/v1/volumes/zyTCAlFPjgYC)时，只有 2 个缩略图（小型和中型）。那么我是否需要获取 Google API 密钥才能获取有关一本书的完整信息？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-16T23:08:49.793

我发现您可以将`&zoom=1`URL 的一部分替换`&zoom=0`为更大的图像，但仅在某些情况下。

例如，这是福尔摩斯的小缩略图：

[http://bks5.books.google.com/books?id=buc0AAAAMAAJ&printsec=frontcover&img=1&zoom=1&edge=curl&source=gbs_api](http://bks5.books.google.com/books?id=buc0AAAAMAAJ&printsec=frontcover&img=1&zoom=1&edge=curl&source=gbs_api)

现在，通过设置`zoom`为`0`，我得到一个大缩略图：

[http://bks5.books.google.com/books?id=buc0AAAAMAAJ&printsec=frontcover&img=1&zoom=0&edge=curl&source=gbs_api](http://bks5.books.google.com/books?id=buc0AAAAMAAJ&printsec=frontcover&img=1&zoom=0&edge=curl&source=gbs_api)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T19:13:02.320

实际上，有些书，谷歌提供了大图，但有些没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-08T09:16:56.740

只需更改 url 中的缩放大小。

```
let img = "https://books.google.com/books/content?id=XfFvDwAAQBAJ&printsec=frontcover&img=1&zoom=1&edge=curl&source=gbs_api"

let imgZoom = img.replace('zoom=1', 'zoom=10')
newImg.src= imgZoom;
```

```
<img src="" id="newImg"> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-23T11:11:00.787

将缩放设置为 3 而不是 0 或 1，它应该可以工作

# javascript - 如何从托管在其他域的 iframe 中删除谷歌广告

> ID：10721895
> 
> 赞同：1
> 
> 时间：2012-05-23T14:19:36.507
> 
> 标签：javascript, jquery, iframe, ads

我正在寻找一些 javascript 或 jquery 脚本来从 iframe 文档中删除谷歌广告，该文档托管在不同的域中。

可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:23:02.780

看不到[获取跨域 iframe 的 DOM 内容](https://stackoverflow.com/questions/6170925/get-dom-content-of-cross-domain-iframe)

除非您可以控制该框架中的某些脚本，在这种情况下，您可以做一些花哨的 postMessage 内容，但如果您有控制权，则删除那里的广告 :)

# java - 如何获取 Spring 上下文

> ID：10721896
> 
> 赞同：0
> 
> 时间：2012-05-23T14:19:38.007
> 
> 标签：java, spring, callback

我有一个第三方库，可以启动我的应用程序，加载 spring 上下文并将其保存在私有静态文件中，而无需任何访问器。

我需要在我的应用程序中获取这个上下文。spring 是否提供了一些回调，例如 afterContextLoaded 方法或任何其他获取方法？

反射不是我的解决方案！

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T14:36:24.683

您有几种存档方法：

1.  使用 ApplicationListerner 和 ApplicinEvent
2.  使用 ApplicationContextAware

它们都可以在[http://static.springsource.org/spring/docs/3.0.0.M4/reference/html/ch03s13.html](http://static.springsource.org/spring/docs/3.0.0.M4/reference/html/ch03s13.html)找到 （抱歉链接不是最新版本）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T00:13:23.367

只需在 Spring bean 中实现[ApplicationContextAware即可。](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/context/ApplicationContextAware.html)

如果您想在启动时访问 AppContext，那么还要实现[InitializingBean](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/beans/factory/InitializingBean.html)并将您的代码放入[afterPropertiesSet()](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/beans/factory/InitializingBean.html#afterPropertiesSet%28%29) - ApplicationContext 实例将被填充并准备好在那时使用。

# dhtmlx - 在 dhtmlx 的列表视图中添加复选框

> ID：10721899
> 
> 赞同：-1
> 
> 时间：2012-05-23T14:19:44.013
> 
> 标签：dhtmlx

如何在网格视图的组合框中添加复选框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T10:20:39.513

据我所知 - 这是不可能的，但他们有类似的编辑器类型 - “clist”，检查 [http://www.dhtmlx.com/docs/products/dhtmlxGrid/samples/01_cell_types/09_pro_excell_extra.html](http://www.dhtmlx.com/docs/products/dhtmlxGrid/samples/01_cell_types/09_pro_excell_extra.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-29T15:29:11.850

您可以在网格视图之外，[如此链接](http://dhtmlx.com/docs/products/dhtmlxForm/samples/09_extra/02_combo_with_checkboxes.html)建议（来自官方 dhtmlx 论坛）。

但在网格内**你不能**。

我在官方 dhtmlx 论坛上找到的[最接近的答案是：](http://forum.dhtmlx.com/viewtopic.php?f=14&t=8322)

> 组合与复选框和 dhtmlxgrid 没有特殊的集成。“组合”列类型仅用于普通组合框模式。从技术上讲可以更改它，因此它将呈现为带有复选框的列表，但无法通过网格的 API 访问选中的值

我希望这个答案可以帮助你。如果没有，您应该直接询问 dhtmlx 团队，因为如果没有不完善的解决方法，这似乎是不可能的。

# android - java.lang.IllegalArgumentException：参数必须是此视图的后代错误

> ID：10721907
> 
> 赞同：5
> 
> 时间：2012-05-23T14:19:59.297
> 
> 标签：android, viewgroup

我对 ViewGroup 有一个奇怪的错误。对于我的主视图，我在此链接[ViewFlow 项目中使用类](https://github.com/pakerfeldt/android-viewflow)

```
 java.lang.IllegalArgumentException: parameter must be a descendant of this view
        at android.view.ViewGroup.offsetRectBetweenParentAndChild(ViewGroup.java:4153)
        at android.view.ViewGroup.offsetDescendantRectToMyCoords(ViewGroup.java:4090)
at android.view.ViewRootImpl.scrollToRectOrFocus(ViewRootImpl.java:2129)
at android.view.ViewRootImpl.draw(ViewRootImpl.java:1849)
at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1641)
at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2449)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4424)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
at dalvik.system.NativeStart.main(Native Method) 
```

当我尝试使用 Intent 或 finish() 返回此视图时会发生此错误；另一个视图中的方法。当我使用后退按钮时，这不是问题。

所以我不知道为什么我有这个错误。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-03-25T10:54:01.797

有同样的问题。我使用 ViewFlow 作为父视图，使用几个 GridView 作为子视图。当我按下 Home 键并在左右滚动这些子视图后再次重新启动活动时会发生此错误。

这是我的解决方案：

```
mViewFlow.setDescendantFocusability(ViewGroup.FOCUS_BLOCK_DESCENDANTS); 
```

当然，您可以在 layout.xml 中进行配置。

希望能帮到你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-07-22T18:17:04.250

从包含 EditText 的回收站视图中删除项目时，我遇到了同样的问题。就在通知适配器该项目已删除之前，我使用了

```
(requireContext() as Activity).currentFocus?.clearFocus() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-04T13:11:22.250

解决了我添加滚动监听器的问题。

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {

    View currentFocus = ((Activity)mContext).getCurrentFocus();
    if (currentFocus != null) {
        currentFocus.clearFocus();
    }  
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-28T07:12:39.697

这对我有用。

```
convertView = mInflater.inflate(R.layout.row_stat_header,
                    parent, false); 
```

这里，`parent`就是getView中的ViewGroup参数。

# activemq - 重新启动后 ActiveMQ 故障转移协议未重新连接到主服务器

> ID：10721912
> 
> 赞同：0
> 
> 时间：2012-05-23T14:20:16.803
> 
> 标签：activemq

我正在使用 ActiveMQ 5.4 版，并且我有一个 [纯主从配置](http://activemq.apache.org/pure-master-slave.html)。我的从站配置为在发生故障时启动其网络传输连接器。我的客户端是使用故障转移协议配置的，就像文档说的那样：

```
failover://(tcp://masterhost:61616,tcp://slavehost:61616)?randomize=false 
```

当我的主人去世时，客户端成功地完美地故障转移到奴隶。问题是，在我恢复后（即停止从站，复制数据，重新启动主站，然后重新启动从站），客户端仍在尝试连接到从站（当时没有任何开放的网络连接器观点）。因此，客户端在重新启动后永远不会重新连接到主服务器。这是它应该如何工作的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-24T15:53:40.983

我也见过这个。如果您使用的是[PooledConnectionFactory ，请通过](http://activemq.apache.org/maven/5.4.0/activemq-pool/apidocs/org/apache/activemq/pool/PooledConnectionFactory.html)[setExpiryTimeout](http://activemq.apache.org/maven/5.4.0/activemq-pool/apidocs/org/apache/activemq/pool/PooledConnectionFactory.html#setExpiryTimeout%28long%29)为池连接设置过期超时。这里的 API 文档建议这将强制重新连接到主代理：

> 允许连接过期，无论负载或空闲时间如何。这对于故障转移以强制从池重新连接、重新建立负载平衡或使用主恢复后很有用

# python - 多处理中的共享内存对象

> ID：10721915
> 
> 赞同：148
> 
> 时间：2012-05-23T14:20:21.190
> 
> 标签：python, numpy, parallel-processing, multiprocessing, shared-memory

假设我有一个大内存 numpy 数组，我有一个函数`func`将这个巨大的数组作为输入（连同其他一些参数）。`func`可以并行运行不同的参数。例如：

```
def func(arr, param):
    # do stuff to arr, param

# build array arr

pool = Pool(processes = 6)
results = [pool.apply_async(func, [arr, param]) for param in all_params]
output = [res.get() for res in results] 
```

如果我使用多处理库，那么那个巨大的数组将被多次复制到不同的进程中。

有没有办法让不同的进程共享同一个数组？这个数组对象是只读的，永远不会被修改。

更复杂的是，如果arr不是一个数组，而是一个任意的python对象，有没有办法共享呢？

[编辑]

我读了答案，但我仍然有点困惑。由于 fork() 是写时复制，因此在 python 多处理库中生成新进程时，我们不应该调用任何额外的成本。但是以下代码表明存在巨大的开销：

```
from multiprocessing import Pool, Manager
import numpy as np; 
import time

def f(arr):
    return len(arr)

t = time.time()
arr = np.arange(10000000)
print "construct array = ", time.time() - t;

pool = Pool(processes = 6)

t = time.time()
res = pool.apply_async(f, [arr,])
res.get()
print "multiprocessing overhead = ", time.time() - t; 
```

输出（顺便说一句，随着数组大小的增加，成本也会增加，所以我怀疑仍然存在与内存复制相关的开销）：

```
construct array =  0.0178790092468
multiprocessing overhead =  0.252444982529 
```

如果我们不复制数组，为什么会有这么大的开销？共享内存为我节省了哪些部分？

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2012-05-23T16:42:54.677

如果您使用使用写时复制语义的操作系统`fork()`（如任何常见的 unix），那么只要您从不更改数据结构，它将可供所有子进程使用，而不会占用额外的内存。您不必做任何特别的事情（除非绝对确保您不更改对象）。

***您*可以为您的问题做的最有效的事情**是将您的数组打包成一个有效的数组结构（使用`numpy`or [`array`](http://docs.python.org/library/array.html)），将其放在共享内存中，用 包装它`multiprocessing.Array`，然后将其传递给您的函数。[这个答案显示了如何做到这一点](https://stackoverflow.com/a/5550156/1002469)。

如果你想要一个*可写*的共享对象，那么你需要用某种同步或锁定来包装它。`multiprocessing`提供了[两种方法](http://docs.python.org/library/multiprocessing.html#sharing-state-between-processes)：一种使用共享内存（适用于简单的值、数组或 ctypes）或`Manager`代理，其中一个进程持有内存，管理器仲裁其他进程（甚至通过网络）对它的访问。

该`Manager`方法可用于任意 Python 对象，但比使用共享内存的等效方法要慢，因为对象需要序列化/反序列化并在进程之间发送。

Python中有[大量可用的并行处理库和方法](http://wiki.python.org/moin/ParallelProcessing)。`multiprocessing`是一个优秀且全面的库，但如果您有特殊需求，也许其他方法之一可能会更好。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-05-15T10:55:52.997

我遇到了同样的问题并编写了一个小的共享内存实用程序类来解决它。

我正在使用`multiprocessing.RawArray`（lockfree），而且对数组的访问根本不同步（lockfree），注意不要自欺欺人。

通过该解决方案，我在四核 i7 上获得了大约 3 倍的加速。

这是代码：随意使用和改进它，请报告任何错误。

```
'''
Created on 14.05.2013

@author: martin
'''

import multiprocessing
import ctypes
import numpy as np

class SharedNumpyMemManagerError(Exception):
    pass

'''
Singleton Pattern
'''
class SharedNumpyMemManager:    

    _initSize = 1024

    _instance = None

    def __new__(cls, *args, **kwargs):
        if not cls._instance:
            cls._instance = super(SharedNumpyMemManager, cls).__new__(
                                cls, *args, **kwargs)
        return cls._instance        

    def __init__(self):
        self.lock = multiprocessing.Lock()
        self.cur = 0
        self.cnt = 0
        self.shared_arrays = [None] * SharedNumpyMemManager._initSize

    def __createArray(self, dimensions, ctype=ctypes.c_double):

        self.lock.acquire()

        # double size if necessary
        if (self.cnt >= len(self.shared_arrays)):
            self.shared_arrays = self.shared_arrays + [None] * len(self.shared_arrays)

        # next handle
        self.__getNextFreeHdl()        

        # create array in shared memory segment
        shared_array_base = multiprocessing.RawArray(ctype, np.prod(dimensions))

        # convert to numpy array vie ctypeslib
        self.shared_arrays[self.cur] = np.ctypeslib.as_array(shared_array_base)

        # do a reshape for correct dimensions            
        # Returns a masked array containing the same data, but with a new shape.
        # The result is a view on the original array
        self.shared_arrays[self.cur] = self.shared_arrays[self.cnt].reshape(dimensions)

        # update cnt
        self.cnt += 1

        self.lock.release()

        # return handle to the shared memory numpy array
        return self.cur

    def __getNextFreeHdl(self):
        orgCur = self.cur
        while self.shared_arrays[self.cur] is not None:
            self.cur = (self.cur + 1) % len(self.shared_arrays)
            if orgCur == self.cur:
                raise SharedNumpyMemManagerError('Max Number of Shared Numpy Arrays Exceeded!')

    def __freeArray(self, hdl):
        self.lock.acquire()
        # set reference to None
        if self.shared_arrays[hdl] is not None: # consider multiple calls to free
            self.shared_arrays[hdl] = None
            self.cnt -= 1
        self.lock.release()

    def __getArray(self, i):
        return self.shared_arrays[i]

    @staticmethod
    def getInstance():
        if not SharedNumpyMemManager._instance:
            SharedNumpyMemManager._instance = SharedNumpyMemManager()
        return SharedNumpyMemManager._instance

    @staticmethod
    def createArray(*args, **kwargs):
        return SharedNumpyMemManager.getInstance().__createArray(*args, **kwargs)

    @staticmethod
    def getArray(*args, **kwargs):
        return SharedNumpyMemManager.getInstance().__getArray(*args, **kwargs)

    @staticmethod    
    def freeArray(*args, **kwargs):
        return SharedNumpyMemManager.getInstance().__freeArray(*args, **kwargs)

# Init Singleton on module load
SharedNumpyMemManager.getInstance()

if __name__ == '__main__':

    import timeit

    N_PROC = 8
    INNER_LOOP = 10000
    N = 1000

    def propagate(t):
        i, shm_hdl, evidence = t
        a = SharedNumpyMemManager.getArray(shm_hdl)
        for j in range(INNER_LOOP):
            a[i] = i

    class Parallel_Dummy_PF:

        def __init__(self, N):
            self.N = N
            self.arrayHdl = SharedNumpyMemManager.createArray(self.N, ctype=ctypes.c_double)            
            self.pool = multiprocessing.Pool(processes=N_PROC)

        def update_par(self, evidence):
            self.pool.map(propagate, zip(range(self.N), [self.arrayHdl] * self.N, [evidence] * self.N))

        def update_seq(self, evidence):
            for i in range(self.N):
                propagate((i, self.arrayHdl, evidence))

        def getArray(self):
            return SharedNumpyMemManager.getArray(self.arrayHdl)

    def parallelExec():
        pf = Parallel_Dummy_PF(N)
        print(pf.getArray())
        pf.update_par(5)
        print(pf.getArray())

    def sequentialExec():
        pf = Parallel_Dummy_PF(N)
        print(pf.getArray())
        pf.update_seq(5)
        print(pf.getArray())

    t1 = timeit.Timer("sequentialExec()", "from __main__ import sequentialExec")
    t2 = timeit.Timer("parallelExec()", "from __main__ import parallelExec")

    print("Sequential: ", t1.timeit(number=1))    
    print("Parallel: ", t2.timeit(number=1)) 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2019-02-06T21:44:48.343

这是[Ray](https://github.com/ray-project/ray)的预期用例，它是一个用于并行和分布式 Python 的库。在底层，它使用[Apache Arrow](https://arrow.apache.org/)数据布局（零拷贝格式）序列化对象，并将它们存储在[共享内存对象存储](https://arrow.apache.org/docs/python/plasma.html)中，以便多个进程可以访问它们而无需创建副本。

代码如下所示。

```
import numpy as np
import ray

ray.init()

@ray.remote
def func(array, param):
    # Do stuff.
    return 1

array = np.ones(10**6)
# Store the array in the shared memory object store once
# so it is not copied multiple times.
array_id = ray.put(array)

result_ids = [func.remote(array_id, i) for i in range(4)]
output = ray.get(result_ids) 
```

如果您不调用`ray.put`，则该数组仍将存储在共享内存中，但每次调用时都会执行一次`func`，这不是您想要的。

请注意，这不仅适用于数组，**也适用于包含数组的对象**，例如将整数映射到数组的字典，如下所示。

您可以通过在 IPython 中运行以下命令来比较 Ray 和 pickle 中的序列化性能。

```
import numpy as np
import pickle
import ray

ray.init()

x = {i: np.ones(10**7) for i in range(20)}

# Time Ray.
%time x_id = ray.put(x)  # 2.4s
%time new_x = ray.get(x_id)  # 0.00073s

# Time pickle.
%time serialized = pickle.dumps(x)  # 2.6s
%time deserialized = pickle.loads(serialized)  # 1.9s 
```

使用 Ray 进行序列化仅比 pickle 快一点，但由于使用共享内存，反序列化速度要快 1000 倍（这个数字当然取决于对象）。

请参阅[Ray 文档](https://ray.readthedocs.io/en/latest/?badge=latest)。您可以阅读更多关于[使用 Ray 和 Arrow 进行快速序列化的](https://ray-project.github.io/2017/10/15/fast-python-serialization-with-ray-and-arrow.html)信息。请注意，我是 Ray 开发人员之一。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-05-22T20:41:37.430

就像 Robert Nishihara 提到的那样，Apache Arrow 使这变得简单，特别是使用 Plasma 内存对象存储，这是 Ray 所构建的。

为此，我专门制作了[脑等离子体](https://github.com/russellromney/brain-plasma)——在 Flask 应用程序中快速加载和重新加载大对象。它是 Apache Arrow 可序列化对象的共享内存对象命名空间，包括`pickle`由`pickle.dumps(...)`.

Apache Ray 和 Plasma 的主要区别在于它会为您跟踪对象 ID。在本地运行的任何进程或线程或程序都可以通过从任何`Brain`对象调用名称来共享变量的值。

```
$ pip install brain-plasma 
```

```
$ plasma_store -m 10000000 -s /tmp/plasma

from brain_plasma import Brain
brain = Brain(path='/tmp/plasma/')

brain['a'] = [1]*10000

brain['a']
# >>> [1,1,1,1,...] 
```

# jquery - jQuery Flot - plothover 事件代码在缩放重新绘制（和重新绑定）后停止工作

> ID：10721919
> 
> 赞同：2
> 
> 时间：2012-05-23T14:20:29.157
> 
> 标签：jquery, events, zooming, flot

我正在创建一个非常类似于 StackOverflow 信誉图的浮动图。有一个小图表显示数据的鸟瞰水平，允许您选择一个范围并在更大的图表上显示，缩放。当任一图表悬停时，图例文本将更新以反映该 x 位置的值。

我遇到了两个问题，并且在我的控制台中绝对没有错误，等等......

1：当我在“缩放器”图上选择一个范围时，较大的“细节”图会正确放大，但是当 x 值悬停时导致图例文本更新的代码停止工作。点项鼠标悬停（导致工具提示）仍然有效，并且这两个代码位在同一个事件中。奇怪的。

2：一旦我放大，日期格式就会失控。尽管我`timeformat`被指定了，但日期会恢复为时间戳（它实际上适用于第一个图，在缩放发生之前）。

* * *

**我录制了一个简短的截屏视频，以展示实际存在的问题：**

[http://www.screenr.com/KUX8](http://www.screenr.com/KUX8)

* * *

**我已经设置了一个显示日期/时间格式问题的 JSFiddle**。出于某种原因，在那种环境中，没有任何悬停事件按预期工作。

[http://jsfiddle.net/Kzg3r/2/](http://jsfiddle.net/Kzg3r/2/)

* * *

我错过了会导致这两个问题的东西吗？

* * *

```
//doPlot is originally called where ranges=null. This plots the entire universe
//of data on both charts. Once a range is selected, this is called again with
//ranges

var plot=null;
var plot2=null;
var updateLegendTimeout = null;
var latestPosition = null;   
var datasets=null;
var currRange=null;

function doPlot(ranges){
    currRange=ranges;

    clearTimeout(updateLegendTimeout);
    updateLegendTimeout = null;

    var options = { //Options for large graph
        lines: { show: true },
        points: { show: true },
        grid: { hoverable: true, clickable: false, autoHighlight: false, backgroundColor: { colors: ["#fff", "#eee"] }, markings: weekendAreas   },
        xaxis: {mode: 'time', timeformat: "%m/%d", minTickSize: [1, "day"]},
        crosshair: { mode: "x" },
        legend: {
            show: true,
            container: $('#legend'),
            noColumns: 2
        }
    };

    var options2 = {  //options for small zoomer graph
        lines: { show: true },
        points: { show: false },
        grid: { hoverable: true, clickable: true, autoHighlight: false, backgroundColor: { colors: ["#fff", "#eee"] }, markings: weekendAreas   },
        xaxis: {mode: 'time', timeformat: "%m/%d", minTickSize: [1, "month"]},
        crosshair: { mode: "x" },
        selection: { mode: "x" },
        legend: { show: false }
    };    

    if (currRange){ //if there is a range specified, extend options to include it.
        options = $.extend(options, {
            xaxis: { 
                min: currRange.xaxis.from, 
                max: currRange.xaxis.to 
            }
        });

    }

    //Plot Large Graph with (or without) given range
    plot = $.plot($("#placeholder"), datasets,options);

    //plot the zoomer graph, only if it is null (it is set to null before ajax request for new chart)
    if (!plot2) { 
        plot2 = $.plot($("#zoomer"), datasets, options2);

        $("#zoomer").unbind("plotselected").bind("plotselected", function (event, ranges) {

            //unbind/re-bind plotselected event to zoom in when a range is selected
            doPlot(ranges);

        }).unbind("plothover").bind("plothover",  function (event, pos, item) {

            //unbind/re-bind plothover event to to show tooltips and to change legend values
            latestPosition = pos;
            if (!updateLegendTimeout)
                updateLegendTimeout = setTimeout(function(){
                    updateLegend(plot2);
                }, 50);

            if (item) {
                if (previousPoint != item.dataIndex) {
                    previousPoint = item.dataIndex;

                    $("#tooltip").remove();
                    var x = item.datapoint[0].toFixed(2),
                        y = item.datapoint[1].toFixed(2);
                    var text = item.series.label.split(' = ');

                    showTooltip(item.pageX, item.pageY,
                                text[0] + ' ('+y+')');
                }
            }
            else {
                $("#tooltip").remove();
                previousPoint = null;            
            }
        });         
    }

    doBinds();          
}

function doBinds(){
    $("#placeholder").unbind("plothover").bind("plothover",  function (event, pos, item) {
        latestPosition = pos;
        if (!updateLegendTimeout)
            updateLegendTimeout = setTimeout(function(){
                updateLegend(plot);
            }, 50);

        if (item) {
            if (previousPoint != item.dataIndex) {
                previousPoint = item.dataIndex;

                $("#tooltip").remove();
                var x = item.datapoint[0].toFixed(2),
                    y = item.datapoint[1].toFixed(2);
                var text = item.series.label.split(' = ');

                showTooltip(item.pageX, item.pageY,
                            text[0] + ' ('+y+')');
            }
        }
        else {
            $("#tooltip").remove();
            previousPoint = null;            
        }    
    });  
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-25T20:20:07.967

如果选择了范围，则 x 轴上的刻度问题与您在 doPlot 函数中扩展绘图选项的方式有关。您需要使用 `true 作为第一个参数调用 jQuery.extend，以便它执行深层复制。否则，当您使用 x 轴最小值和最大值扩展选项对象时，它会覆盖模式设置为时间的 x 轴对象。用这个替换那个位，它将解决这个问题。

```
 if (currRange){ //if there is a range specified, extend options to include it.
        options = $.extend(true, options, {
            xaxis: { 
                min: currRange.xaxis.from, 
                max: currRange.xaxis.to 
            }
        });

    } 
```

编辑：

因此，出现第一个问题是因为在重绘图表时删除了图例项并添加了新项。您将原始图例标签的引用存储在准备好的文档中，但是当图表重绘时，这些不再附加到 DOM。您正在更新这些分离元素上的标签，而不是新创建的图例标签。当您像这样更新图例时，尝试重新初始化图例集合：

```
//THIS IS MOST LIKELY WHERE THE PROBLEM IS OCCURRING!!!!
function updateLegend(thePlot) {
    legends = $('.legendLabel');   
    clearTimeout(updateLegendTimeout);
    updateLegendTimeout = null;

    var pos = latestPosition;

    var axes = thePlot.getAxes();
    if (pos.x < axes.xaxis.min || pos.x > axes.xaxis.max ||
        pos.y < axes.yaxis.min || pos.y > axes.yaxis.max)
        return;

    var i, j, dataset = thePlot.getData();
    for (i = 0; i < dataset.length; ++i) {
        var series = dataset[i];

        // find the nearest points, x-wise
        for (j = 0; j < series.data.length; ++j)
            if (series.data[j][0] > pos.x)
                break;

        // now interpolate
        var y, p1 = series.data[j - 1], p2 = series.data[j];
        if (p1 == null)
            y = p2[1];
        else if (p2 == null)
            y = p1[1];
        else
            y = p1[1] + (p2[1] - p1[1]) * (pos.x - p1[0]) / (p2[0] - p1[0]);

        legends.eq(i).text(series.label.replace(/=.*/, "= " + y.toFixed(2)));
    }
} 
```

# java - 简单 Scala TCP 服务器中的套接字问题

> ID：10721922
> 
> 赞同：6
> 
> 时间：2012-05-23T14:20:51.437
> 
> 标签：java, sockets, scala, tcp

我是 Scala 的新手，所以这个问题可能很简单，尽管我花了一些时间试图解决它。我有一个简单的 Scala TCP 服务器（没有演员，单线程）：

```
import java.io._
import java.net._

object Application {
  def readSocket(socket: Socket): String = {
    val bufferedReader = new BufferedReader(new InputStreamReader(socket.getInputStream))
    var request = ""
    var line = ""
    do {
      line = bufferedReader.readLine()
      if (line == null) {
        println("Stream terminated")
        return request
      }
      request += line + "\n"
    } while (line != "")
    request
  }

  def writeSocket(socket: Socket, string: String) {
    val out: PrintWriter = new PrintWriter(new OutputStreamWriter(socket.getOutputStream))
    out.println(string)
    out.flush()
  }

  def main(args: Array[String]) {
    val port = 8000
    val serverSocket = new ServerSocket(port)
    while (true) {
      val socket = serverSocket.accept()
      readSocket(socket)
      writeSocket(socket, "HTTP/1.1 200 OK\r\n\r\nOK")
      socket.close()
    }
  }
} 
```

服务器侦听`localhost:8000`传入的请求并`OK`在正文中发送带有单个单词的 HTTP 响应。然后我像这样运行 Apache Benchmark：

```
ab -c 1000 -n 10000 http://localhost:8000/ 
```

这是第一次很好地工作。我第二次启动`ab`它时挂起，在中产生以下输出`netstat -a | grep 8000`：

```
....
tcp        0      0 localhost.localdo:43709 localhost.localdom:8000 FIN_WAIT2  
tcp        0      0 localhost.localdo:43711 localhost.localdom:8000 FIN_WAIT2  
tcp        0      0 localhost.localdo:43717 localhost.localdom:8000 FIN_WAIT2  
tcp        0      0 localhost.localdo:43777 localhost.localdom:8000 FIN_WAIT2  
tcp        0      0 localhost.localdo:43722 localhost.localdom:8000 FIN_WAIT2  
tcp        0      0 localhost.localdo:43725 localhost.localdom:8000 FIN_WAIT2  
tcp6       0      0 [::]:8000               [::]:*                  LISTEN     
tcp6      83      0 localhost.localdom:8000 localhost.localdo:43724 CLOSE_WAIT 
tcp6      83      0 localhost.localdom:8000 localhost.localdo:43786 CLOSE_WAIT 
tcp6       1      0 localhost.localdom:8000 localhost.localdo:43679 CLOSE_WAIT 
tcp6      83      0 localhost.localdom:8000 localhost.localdo:43735 CLOSE_WAIT 
tcp6      83      0 localhost.localdom:8000 localhost.localdo:43757 CLOSE_WAIT 
tcp6      83      0 localhost.localdom:8000 localhost.localdo:43754 CLOSE_WAIT 
tcp6      83      0 localhost.localdom:8000 localhost.localdo:43723 CLOSE_WAIT
.... 
```

由于服务器不再处理请求。更多细节：`ab`具有相同参数的相同脚本可以在同一台机器上顺利测试简单的 Node.js 服务器。所以这个问题与我设置为可重用的许多打开的 TCP 连接无关

```
sudo sysctl -w net.ipv4.tcp_tw_recycle=1
sudo sysctl -w net.ipv4.tcp_tw_reuse=1 
```

谁能给我一个关于我缺少什么的线索？

**编辑**：流处理的终止已添加到上面的代码中：

```
 if (line == null) {
      println("Stream terminated")
      return request
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-30T06:07:38.130

我正在为那些有一天会偶然发现同一问题的人发布我自己问题的（部分）答案。首先，问题的本质不在于源代码，而在于限制了众多连接的系统本身。问题是`socket`传递给`readSocket`函数在某些情况下似乎已损坏，即它无法读取并且在第一次调用`bufferedReader.readLine()`时返回`null`或无限期挂起。以下两个步骤使代码在某些机器上工作：

1.  增加与套接字的并发连接数

    ```
    sysctl -w net.core.somaxconn=65535 
    ```

2.  向构造函数提供第二个参数`ServerSocket`，它将显式设置连接队列的长度：

    ```
    val maxQueue = 50000
    val serverSocket = new ServerSocket(port, maxQueue) 
    ```

上述步骤解决了 EC2 m1.large 实例上的问题，但是我的本地机器上仍然出现问题。更好的方法是使用[Akka](http://akka.io/)来处理这类东西：

```
import akka.actor._
import java.net.InetSocketAddress
import akka.util.ByteString

class TCPServer(port: Int) extends Actor {

  override def preStart {
    IOManager(context.system).listen(new InetSocketAddress(port))
  }

  def receive = {
    case IO.NewClient(server) =>
      server.accept()
    case IO.Read(rHandle, bytes) => {
      val byteString = ByteString("HTTP/1.1 200 OK\r\n\r\nOK")
      rHandle.asSocket.write(byteString)
      rHandle.close()
    }
  }
}

object Application {
  def main(args: Array[String]) {
    val port = 8000
    ActorSystem().actorOf(Props(new TCPServer(port)))
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-26T23:31:36.533

首先，我建议在没有`ab`. 您可以执行以下操作：

```
echo "I'm\nHappy\n" | nc -vv localhost 8000 
```

其次，我建议处理流尾。这是`BufferedReader.readLine()`返回 null 的地方。上面的代码只检查空字符串。解决这个问题后，我会再试一次。然后用 ab 测试，一切看起来都很好。让我们知道问题是否仍然存在。

# jquery - JQuery JSONP回调错误

> ID：10721923
> 
> 赞同：0
> 
> 时间：2012-05-23T14:20:53.810
> 
> 标签：jquery, json, callback, jsonp

我有一个简单的 JQuery Stockwatcher 应用程序，它发出 JSONP 请求，但没有调用回调函数。我有这个应用程序的 JSON 调用，但在某些时候它将是跨域的，因此我必须使用 JSONP。

我究竟做错了什么？当我运行此代码时，会调用 Error 函数。

```
function loadData(data) {
    alert("Load Data");
    $.each(data.stocks,function(i,item){
        $("#results").append('Title:'+item.symbol+' ==  Price:'+item.price+'</p>');
    });
}   

$(document).ready(function(){
var url='http://localhost:8080/StockWatcherServer/stockwatcher/stockPrices?q=';
var query;
    $('button').click(function(){
        query=$("#query").val();
        // Assign handlers immediately after making the request,
        // and remember the jqxhr object for this request

        //$.ajaxSetup({ crossDomain: true, scriptCharset: "utf-8" , contentType: "jsonp; charset=utf-8"});
        $.ajax({
            url : url+query,
            type: "GET",
            dataType: "jsonp",
            jsonp : "callback",
            jsonpCallback: "loadData",
            success: function(data) {alert("Success");},
            error: function(data) { alert("Error"); },

            });        
       });
}); 
```

这是我的 JSON 输出，我可以在 Firebug 中看到

```
{"stocks": [
  {
    "symbol": "IPOD",
    "price": 20.2182603350167,
    "change": 0.3128265006354697
  }
]} 
```

谢谢拉杰什

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:22:15.093

那是 JSON，而不是 JSONP。如果是跨域 JSON 请求，必须是 JSONP 而不是 JSON。不同的端口是跨域的。

这是您的请求应根据您的代码返回的 JSONP。此外，您的 loadData 方法将被 jquery IIRC 覆盖。

```
loadData({"stocks": [
  {
    "symbol": "IPOD",
    "price": 20.2182603350167,
    "change": 0.3128265006354697
  }
]}) 
```

# symfony - 如何在 symfony2 中使用 apc

> ID：10721924
> 
> 赞同：2
> 
> 时间：2012-05-23T14:20:56.837
> 
> 标签：symfony

我刚刚安装并配置了 Symfony2 框架的干净副本，并在 php.ini 中包含扩展 php_apc_319_php54_vc9_win7-2008.dll 重新启动 apache 并运行 url “http://localhost/Symfony/web/app_dev.php/” 它是一切正常，直到刷新页面并出现错误：

> 致命错误：在第 10 行的 E:\phpWorkspace\www\Symfony\app\autoload.php 中调用未定义的方法 Symfony\Component\ClassLoader\ApcUniversalClassLoader::registerNamespaces()。

我已经读过[关于性能的这一章，](http://symfony.com/doc/current/book/performance.html) 但也许​​我没有很好地使用它

我是 symfony 的新手，所以我很乐意获得一步一步的教程

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T10:42:57.823

你需要在php中安装Apc

[安装apc link1](http://7php.com/linux-mint-how-to-install-apc-and-configure-apc-on-xampp-apc-caching-extension/)

[安装apc link2](http://www.samclarke.com/2011/10/install-apc-with-xampp-on-linux/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T22:17:13.173

我从您正在使用的文件 (php_apc_319_php54_vc9_win7-2008.dll) 中猜测该 dll 旨在提供 APC 3.1.9 以与 PHP 5.4 一起使用。直到 3.1.10 才向 APC 添加对 PHP 5.4 的支持，即使现在也只是正式的 beta 版本。

在撰写本文时，最新版本是 3.1.13。在调查其他任何事情之前，我会安装它。

# vb.net - 在 vb.net 中打印函数的输出

> ID：10721928
> 
> 赞同：0
> 
> 时间：2012-05-23T14:21:05.010
> 
> 标签：vb.net, function, printing

```
Public Function random_key(ByVal lenght As Integer) As String
    Randomize()
    Dim s As New System.Text.StringBuilder("")
    Dim b() As Char = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".ToCharArray()
    For i As Integer = 1 To lenght
        Randomize()
        Dim z As Integer = Int(((b.Length - 2) - 0 + 1) * Rnd()) + 1
        s.Append(b(z))
    Next
    Return s.ToString
    Console.WriteLine(s.ToString)

End Function 
```

我想像 s=textbox1.text 或其他东西一样打印它...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:23:58.490

使用有什么问题[`Console.WriteLine`](http://msdn.microsoft.com/en-us/library/system.console.writeline.aspx)？

请注意，您不应将其放在方法中的[`return`语句](http://msdn.microsoft.com/en-us/library/2e34641s%28v=vs.100%29.aspx)后面，因为 return 后面的代码是[unreachable](http://msdn.microsoft.com/en-us/library/c26da40e%28v=vs.100%29.aspx)。

```
Dim random As String = random_key(10)
Console.WriteLine(random) 
```

# iphone - 打开某个项目时Xcode不断崩溃

> ID：10721929
> 
> 赞同：0
> 
> 时间：2012-05-23T14:21:08.083
> 
> 标签：iphone, xcode

我一打开项目，Xcode 就会崩溃。更有趣的是 XCode 不会在其他项目上崩溃。关于这可能是什么的任何想法？

![在此处输入图像描述](../Images/afbc329e0905be1c1fc1de95128e94f4.png)

更新 1：我在 Snow Leopard 机器上使用 XCode 4.2。

更新 2：我有一种偷偷摸摸的感觉，只有当我单击项目导航器按钮时才会发生崩溃

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T14:33:08.100

通常，当这种情况发生时，从项目中删除所有用户文件将修复崩溃。

`Project.xcodeproj/`从您的目录/包中删除以下文件：

*   `project.xcworkspace`
*   `xcuserdata`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T14:28:07.533

在绘制您的一个文件的 SCM 状态（Git、Subversion）时，崩溃似乎有问题。就个人而言，我没有这个问题，所以我无法提供具体的修复。也许您的存储库状态存在一些非典型的情况，您可以进行更正。

您可能还想尝试（暂时）删除您的 xcuser 状态数据（在黑暗中拍摄）。

# c++ - QGraphicsPixmapItem

> ID：10721935
> 
> 赞同：0
> 
> 时间：2012-05-23T14:21:25.950
> 
> 标签：c++, qt, qimage, qpixmap

QGraphicsPixmapItem 和 QGraphicsItem 一样，有一个方法 update(x0, y0, width, height)，以便仅在 QGraphicsScene 上重绘一个像素图。调用它会在 QGraphicsItem 上安排一个 paint()（在 Qt 的事件循环中），并且在执行这个 paint() 之后，边界框 (x,y,width,height) 将被重绘到 QGraphcisScene。

不幸的是，没有办法用边界框来安排绘制事件，这意味着 QGraphicsPixmapItem::paint() 被迫重新绘制整个 QPixmap，因此在子类中重新实现这个 paint() 方法无法仅部分更新 QPixmap，因此对 QPixmap 进行小（本地）更新的速度令人无法接受。

这样的子类看起来像这样：

```
class LocallyUdatablePixmapItem : public QGraphicsPixmapItem {
private:
    QImage &image;
public:
    LocallyUdatablePixmapItem(QImage &img) : QGraphicsPixmapItem(), image(img) {}

    paint(QPainter *painter, const QStyleOptionGraphicsItem *option, QStyle *widget) {
         //locall update, unfortunately without a boundig box :( therefore -> slow
    }
}; 
```

另一种选择是保留 QGraphicsPixmapItem 的“内部 QPixmap”，并将 QImage 部分绘制到它，如下所示：

```
//some initialization of variables
QGraphicsScene scene = ...;
QImage img = ...; //some image data that I wish to manipulate from time to time
QPixmap pixmap  = QPixmap::fromImage(this->shown);
QPainter painter = new QPainter(&this->pixmap);
QGraphicsPixmapItem item = this->addPixmap(this->pixmap);
item->setPixmap(this->pixmap);
//this should not matter, but actually it does, as I will explain shortly
//delete painter;
//painter = new QPainter(item->pixmap());

//For some reason I decide to update (manimulate) img within a small boundigbox
int x0, y0, width, height; //bounding box, assume they are set to whatever is appropriate for the previous update
painter->drawImage (x0, y0, img, x0, y0, width, height);
//now the pixmap is updated, unfortunately the item is not. This does not affect it:
item->update(x0, y0, width, height);
//nor does this:
item->update();
//but this, which makes the whole thing slow, does:
item.setPixmap(&pixmap); 
```

鉴于我需要设置像素图来修复它，我假设它在初始化时没有设置，因此取消之前提到的行似乎是个好主意。不幸的是，drawImage() 调用随后会出现段错误：

QPaintDevice：无法销毁正在绘制的绘制设备

我想有一个“item.setPixmap(&pixmap);”的替代品，它不会重绘整个东西，但效果很好。任何输入都非常感谢:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T16:49:58.620

在我提出解决方案之前，有几点想法：

首先，Graphics View 框架旨在成为显示许多图形对象的解决方案，因此一张大图像并不那么合适。当然，我意识到你的例子可能只是一个人为的例子，所以这一点可能并不适用。其次，由于该框架非常以变换为中心，因此仅重绘 QGraphicsItem 的一部分可能没有意义，除非所有变换都是相同的，没有滚动等。

无论如何，如果您只想绘制 QGraphicsItem 的一部分，您可以简单地存储需要更新的矩形，并从您的`paint()`方法内部访问它。例如：

```
CustomItem::setPaintRect(const QRectF &rect)
{
    paintRect = rect;
    update();
}

CustomItem::paint(QPainter *painter /* etc. */)
{
    painter->fillRect(paintRect, brush);
} 
```

# android - 同时启用 3G 和 WiFi

> ID：10721937
> 
> 赞同：0
> 
> 时间：2012-05-23T14:21:32.127
> 
> 标签：android, networking, wifi, vpn, 3g

有谁知道是否可以（以编程方式）同时使用 3G 和 WiFi，接收和发送数据包？

我在这里看到了各种其他问题，但是现在有了 Android 内部的网络共享功能，我想知道这是否可能？这必须在标准/库存设备上，并且不能通过 root 对操作系统进行修改。

谢谢

亚当

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-15T00:52:05.873

```
public void shutup(){
    SuDroid cmd = new SuDroid();
    cmd.sh.runWaitFor("svc wifi enable");
    cmd.sh.runWaitFor("svc data enable");
    cmd.sh.runWaitFor("svc data prefer");
} 
```

使用[SuDroido](https://github.com/LuizCarvalho/SuDroid)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T15:08:06.947

实现此目的的唯一方法是将 APN 名称与`HttpConnection`. 这在 Java ME 中是可能的，请访问这个[答案](https://stackoverflow.com/a/8183599/996493)，但是我从未尝试过。

您需要检查活动连接，如果第一个不活动，则切换到下一个连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:42:53.493

我不信，只要打开wifi，3g就会自动断开。据我所知，没有办法绕过它。

# java - getTopLinkTemplate 在 Spring 中为空

> ID：10721939
> 
> 赞同：0
> 
> 时间：2012-05-23T14:21:36.600
> 
> 标签：java, spring, templates, toplink

我正在尝试将 TopLink 与 Spring 一起使用，但我遇到了问题。我在网络服务（CXF）中使用它。当我使用 getTopLinkTemplate() 时，结果为空。这是我的 applicationContext.xml ：

```
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource"
    destroy-method="close">
    <property name="driverClassName" value="oracle.jdbc.OracleDriver" />
    <property name="url" value="jdbc:oracle:thin:@*************" />
    <property name="username" value="*****" />
    <property name="password" value="*****" />
</bean>

<bean id="mySessionFactory"
    class="org.springframework.orm.toplink.LocalSessionFactoryBean">
    <property name="configLocation" value="toplink-sessions.xml" />
    <property name="dataSource" ref="dataSource" />
</bean>

<bean id="myProductDao" class="ToplinkExecPS.ExecPS">
    <property name="sessionFactory">
        <ref local="mySessionFactory" />
    </property>
</bean> 
```

我的代码是：

```
public class ExecPS extends TopLinkDaoSupport{

public Vector Exec(String test) 
{
    TopLinkTemplate t;
    t = getTopLinkTemplate();
    if (t == null)
        System.out.println("template is null");
} 
```

}

因此，当我执行此代码时，控制台中出现“模板为空”，而当我尝试使用变量“t”时出现 nullPointerException。

有关信息，使用 TopLink 连接到数据库是成功的。

> [TopLink - Infos] : 2012.05.23 03:45:22.113--ServerSession(4812898)--Thread(Thread[main,5,main])--Session - connexion réussie

我已经测试了很多东西，但我仍然卡住了。我希望你能帮助我。

[编辑]

好吧，我真的是个菜鸟。我只是忘记在调用该方法之前获取我的 bean ......如果有人进入这个线程，有代码：

```
ClassPathXmlApplicationContext context = 
            new ClassPathXmlApplicationContext(new String[]{"ToplinkContext.xml"} );
    ExecPS exec = (ExecPS)context.getBean("myProductDao"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T22:17:22.653

这不是 100%，但我会怀疑这条线：

```
<property name="configLocation" value="toplink-sessions.xml" /> 
```

不确定 toplink-sessions.xml 是否在您的类路径中并尝试以下操作：

```
 <property name="configLocation" value="classpath:toplink-sessions.xml" /> 
```

# java - 如何走出条件IF语句？退货无法正常工作

> ID：10721940
> 
> 赞同：0
> 
> 时间：2012-05-23T14:21:37.370
> 
> 标签：java, return, control-flow

我有一个班级的例子。它创建一张新卡并将其放入数组中。如果卡数超过54，我想控制卡数并离开流程：

```
public class Card {
    private final String rank; 
    private final String suit;
    private String[][] cards;
    private static int NoC = 0;

    public Card(String suit, String rank) {
        if (NoC >= 54) {
        System.out.println("You cannot create any more cards");

        // and this "return" doesn't work correctly. NetBeans says "variable rank might not have been initialized"
        return;   
    }

    this.suit = suit;
    this.rank = rank;

    cards = new String[54][2];
    cards[NoC][0] = this.suit;
    cards[NoC][1] = this.rank;
    NoC = NoC + 1;
} 
```

程序编译无误。并且按我的预期工作：如果正在创建第 55 张卡片，它会转到`IF`子句并打印通知“您不能再创建更多卡片”，但它也会引发警告*“无法编译的源代码 - 变量等级可能尚未初始化”*。

如何让它正确运行？我是否必须使用 smth else 而不是`return`命令？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-23T14:24:31.253

如果您想阻止创建第 53 张卡片，您不能只`return`从构造函数中 - 这会导致在客户端没有注意到任何内容的情况下构造不正确的对象（构造函数的直接调用者应该如何知道打印到标准输出的内容？） . 相反，您需要抛出*异常*：

```
public Card(String suit, String rank) {
    if (NoC >= 52) {
        throw new IllegalStateException("You cannot create any more cards");
    }

    this.suit = suit;
    this.rank = rank;

    cards = new String[54][2];
    cards[NoC][0] = this.suit;
    cards[NoC][1] = this.rank;
    NoC = NoC + 1;
} 
```

`IllegalStateException`这里只是一个例子——一个现有的运行时异常，您可以为此目的重用它。或者您可能更喜欢定义和使用您自己的（已检查）异常。

### 更好的解决方案

通常，最好使用`enum`. 这避免了上面的整个问题，因为不可能`enum`动态地构造新值，所以不需要检查任何东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-23T14:24:35.403

在你的构造函数中抛出一个`IllegalArgumentException`而不是 Sysout & return。
由于这是一个例外情况，即构造函数无法创建具有这样值的类实例，因此简单地从构造函数中正常返回会使程序正常继续，这在这种情况下是您不希望的，因此抛出异常是最合适的在这里做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-23T14:27:04.013

您不能从构造函数返回。你应该做的是防止创建是从构造函数中抛出一个异常：

```
 public Card(String suit, String rank) {
    if (NoC >= 52) {
        throw new IllegalStateException("The limit has been reached");
    }
    ...
 } 
```

# asp.net - 如何在 .aspx 页面中编写元标记？

> ID：10721941
> 
> 赞同：2
> 
> 时间：2012-05-23T14:21:37.473
> 
> 标签：asp.net, meta-tags

我有以下代码：

```
<%@ page title="בחירת מועמדי הליכוד" language="C#"
masterpagefile="~/Site.master" autoeventwireup="true" %> <asp:Content
ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
</asp:Content> <asp:Content ID="BodyContent" runat="server"
ContentPlaceHolderID="MainContent"> <center> <div class="endMsg"> תודה
רבה על השתתפותך ! </div> </center> </asp:Content> 
```

我想添加元标记：

```
<meta http-equiv="Refresh" content="60; url=http://your.new/url/here" /> 
```

如何编写被解释为该元标记的代码？

编辑：根据评论，我编写了以下代码：

```
public partial class Thanks : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        int _refresh_In_Seconds = 5;
        HtmlMeta metaKey = new HtmlMeta();
        metaKey.Name = "Refresh";
        metaKey.Content = _refresh_In_Seconds + "; url=Default.aspx";
        Page.Header.Controls.Add(metaKey);  
    }

} 
```

重定向不起作用。谁能解释为什么？

编辑2：

这是该问题的另一种解决方案：

```
<asp:Content ID="HeaderContent" runat="server" ContentPlaceHolderID="HeadContent">
<meta http-equiv="Refresh" content="10; URL=Default.aspx">
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:57:46.440

尝试这个

```
 HtmlMeta metaKey = new HtmlMeta();
             meta.Name = "Refresh";
             meta.Content = _refresh_In_Seconds + "; url=whatEver.aspx"; 
             Page.Header.Controls.Add(metaKey); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T20:22:36.740

您必须使用 HtmlMeta 的 HttpEquiv 属性，而不是：

```
metaKey.Name = "Refresh"; 
```

放：

```
metaKey.HttpEquiv = "Refresh"; 
```

# performance - 代理/存根和 typelib 编组性能如何比较？

> ID：10721944
> 
> 赞同：2
> 
> 时间：2012-05-23T14:21:43.980
> 
> 标签：performance, com, interop, marshalling

假设我需要实现一个 out-proc COM 服务器并且所有的 COM 接口都是自动化兼容的。我可以创建和注册代理/存根组合，也可以创建和注册类型库并依赖自动化编组器。

我很清楚这两种方法的所有维护方面。这个问题仅与运行时性能有关。

我找不到任何硬数据——只有像这样的*声明*

1.  “自动化编组器是通用的，所以它更慢”我不会马上相信，因为只有几种自动化兼容类型，所以在它们之间切换并不难

2.  “自动化编组器将必须加载类型库”这是公平的，但这只需执行一次，如果我之后有十万个 COM 调用，我不太关心一次性开销

从长远来看，是否有任何测量数据（代理/存根编组或类型库编组）更快？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-08T09:20:14.123

*根据 Don Box 在Essential Com* (p. 228) 和[他的 Microsoft Systems Journal 文章 (Jan 1999)](http://www.microsoft.com/msj/0199/com/com0199.aspx)中的说法，一旦创建了代理，PSOAInterface 的性能应该与 /Oicf 代理/存根库的性能相同。

但从 Windows 8.1 开始，PSOAInterface 代理的**创建可能不是最理想的。**Don Box 在上面的文章中声称combase!CreateProxyFromTypeInfo 和类型库封送器执行缓存。但是，在我的测试中，每次发布所有接口后，都会从文件中重新加载类型库。这是 UIAutomation 库的一个重大问题，它广泛使用 IGlobalInterfaceTable，导致大量额外的系统调用。

这是我的测试。一个公寓实例化一个 coclass，然后另一个公寓将其解组为代理 10000 次。使用 PSOAInterface 大约需要 5s。如果我改为创建和注册 MIDL 代理/存根，只需要大约 100 毫秒。

```
#include <stdio.h>
#include <tchar.h>
#include <Windows.h>
#include <comdef.h>

// RemoteProxyFactory32 from oleacc.dll {53362c64-a296-4f2d-a2f8-fd984d08340b}
static IID CLSID_RemoteProxyFactory32 = GUID{ 0x53362c64, 0xa296, 0x4f2d, { 0xa2, 0xf8, 0xfd, 0x98, 0x4d, 0x08, 0x34, 0x0b } };
// IRemoteProxyFactory from oleacc.dll {8628f27d-64a2-4ed6-906b-e6155314c16a}
static IID IID_IRemoteProxyFactory = GUID{ 0x8628f27d, 0x64a2, 0x4ed6, { 0x90, 0x6b, 0xe6, 0x15, 0x53, 0x14, 0xc1, 0x6a } };

struct register_interface_thread {
    HANDLE hInterfaceRegistered;
    DWORD dwCookie;
    HANDLE hShouldClose;
};
DWORD WINAPI RegisterInterfaceThread(_In_  LPVOID lpParameter) {
    struct register_interface_thread& state = *(struct register_interface_thread*)(lpParameter);
    HRESULT hr;
    if (FAILED(hr = CoInitializeEx(NULL, COINIT_MULTITHREADED))) {
        fprintf(stderr, "Error CoInitializeEx: 0x%08x\n", hr);
    }
    else {
        IUnknown *pv;
        if (FAILED(hr = CoCreateInstance(CLSID_RemoteProxyFactory32, NULL, CLSCTX_LOCAL_SERVER, IID_IRemoteProxyFactory, (LPVOID*)&pv))) {
            fprintf(stderr, "CocCreateInstance(RemoteProxyFactory32 of oleacc.dll) failed with hresult 0x%x\n", hr);
        }
        else {
            IGlobalInterfaceTable *pIGlobalInterfaceTable;
            if (FAILED(hr = CoCreateInstance
                (
                CLSID_StdGlobalInterfaceTable,
                NULL,
                CLSCTX_INPROC_SERVER,
                IID_IGlobalInterfaceTable,
                (void **)&pIGlobalInterfaceTable
                ))) {
                fprintf(stderr, "CocCreateInstance(StdGlobalInterfaceTable) failed with hresult 0x%x\n", hr);
            }
            else {
                DWORD dwCookie;
                if (FAILED(hr = pIGlobalInterfaceTable->RegisterInterfaceInGlobal(pv, IID_IRemoteProxyFactory, &dwCookie))) {
                    fprintf(stderr, "RegisterInterfaceInGlobal failed with hresult 0x%x\n", hr);
                }
                else {
                    fprintf(stdout, "Successfully registered interface; cookie=0x%x\n", dwCookie);
                    state.dwCookie = dwCookie;
                    if (!SetEvent(state.hInterfaceRegistered)) {
                        DWORD err = GetLastError();
                        fprintf(stderr, "Error SetEvent(hInterfaceRegistered): 0x%x\n", err);
                    }
                    else {
                        DWORD waitResult;
                        if (WAIT_OBJECT_0 != (waitResult = WaitForSingleObject(state.hShouldClose, INFINITE))) {
                            DWORD err = GetLastError();
                            fprintf(stderr, "Error WaitForSingleObject: returned 0x%x; error=0x%08x\n", waitResult, err);
                            hr = err;
                        }
                        else {
                            fprintf(stdout, "Successfully joined thread; dwCookie=0x%x\n", state.dwCookie);
                        }
                    }
                }
                pIGlobalInterfaceTable->Release();
            }
            if (pv != NULL)
                pv->Release();
        }
        CoUninitialize();
        fprintf(stdout, "Thread going away\n");
    }
    return 0;
}

int main(int argc, char* argv[]) {
    HRESULT hr;
    if (FAILED(hr = CoInitializeEx(NULL, COINIT_APARTMENTTHREADED))) {
        fprintf(stderr, "Error CoInitializeEx: 0x%08x\n", hr);
    }
    else {
        struct register_interface_thread state;
        state.dwCookie = 0;
        state.hInterfaceRegistered = CreateEventEx(NULL, TEXT("hInterfaceRegistered"), CREATE_EVENT_MANUAL_RESET, EVENT_ALL_ACCESS);
        state.hShouldClose = CreateEventEx(NULL, TEXT("hShouldClose"), CREATE_EVENT_MANUAL_RESET, EVENT_ALL_ACCESS);

        HANDLE hThread = CreateThread(NULL, 0, RegisterInterfaceThread, &state, 0, NULL);
        if (hThread == NULL) {
            DWORD err = GetLastError();
            fprintf(stderr, "Error CreateThread: 0x%08x\n", err);
            hr = err;
        }
        else {
            DWORD waitResult;
            if (WAIT_OBJECT_0 != (waitResult = WaitForSingleObject(state.hInterfaceRegistered, INFINITE))) {
                DWORD err = GetLastError();
                fprintf(stderr, "Error WaitForSingleObject: returned 0x%x; error=0x%08x\n", waitResult, err);
                hr = err;
            }
            else {
                fprintf(stdout, "Successfully waited for hInterfaceRegistered; dwCookie=0x%x\n", state.dwCookie);
                IGlobalInterfaceTable *pIGlobalInterfaceTable;
                if (FAILED(hr = CoCreateInstance
                    (
                    CLSID_StdGlobalInterfaceTable,
                    NULL,
                    CLSCTX_INPROC_SERVER,
                    IID_IGlobalInterfaceTable,
                    (void **)&pIGlobalInterfaceTable
                    ))) {
                    fprintf(stderr, "CoCreateInstance(StdGlobalInterfaceTable) failed with hresult 0x%x\n", hr);
                }
                else {
                    IUnknown *pv = NULL;
                    DWORD start_time = GetTickCount();
                    DWORD i;
                    for (i = 0; i != 10000; i++) {
                        if (FAILED(hr = pIGlobalInterfaceTable->GetInterfaceFromGlobal(state.dwCookie, IID_IRemoteProxyFactory, (LPVOID*)&pv))) {
                            fprintf(stderr, "GetInterfaceFromGlobal failed with hresult 0x%x\n", hr);
                            break;
                        }
                        else {
                            pv->Release();
                        }
                    }
                    DWORD end_time = GetTickCount();
                    DWORD difference = end_time - start_time;
                    fprintf(stdout, "%u iterations completed in %ums\n", i, difference);
                    pIGlobalInterfaceTable->Release();
                }
                if (!SetEvent(state.hShouldClose)) {
                    DWORD err = GetLastError();
                    fprintf(stderr, "SetEvent(hShouldClose) failed; err=0x%x\n", err);
                    hr = err;
                }
                else {
                    if (WAIT_OBJECT_0 != (waitResult = WaitForSingleObject(hThread, INFINITE))) {
                        DWORD err = GetLastError();
                        fprintf(stderr, "Error WaitForSingleObject(hThread): returned 0x%x; error=0x%08x\n", waitResult, err);
                        hr = err;
                    }
                    else {
                        printf("successfully joined thread.\n");
                    }
                }
            }
        }
    }
    return hr;
} 
```

在 windbg 中运行它确认它会重新加载类型库 10000 次。

```
bp KERNELBASE!CreateFileW "r $t0 = @$t0 + 1; g"
bp OLEAUT32!LoadTypeLibEx "r $t1 = @$t1 + 1; g"
g
r $t0, $t1
$t0=000000000000c35c $t1=0000000000002712 
```

# c++ - 模板宏的链接器错误：未解析的外部符号

> ID：10721946
> 
> 赞同：0
> 
> 时间：2012-05-23T14:21:46.990
> 
> 标签：c++, boost, linker-errors, unresolved-external

我正在尝试在 VS2010 中构建别人的代码。它在 VS2005 中构建良好，但我需要升级它。

他们在标题中定义了如下宏：

```
#include <boost/scoped_ptr.hpp>
#include <boost/utility.hpp>
#include <boost/thread/once.hpp>

#define DEFINE_SINGLETON(name) boost::scoped_ptr<name> Singleton<name>::_instance

template<class T> class Singleton : private boost::noncopyable
{
    public:
        static T& instance() 
        {
            boost::call_once(init, flag);        
            return *_instance;
        }

        static void init()  
        {
            _instance.reset(new T());
        }

    protected:
        Singleton() {}
        ~Singleton() {}

    private:
        static boost::scoped_ptr<T> _instance;
        static boost::once_flag flag;
};

template<class T> boost::once_flag Singleton<T>::flag = BOOST_ONCE_INIT; 
```

我现在已经设法构建代码，但是我收到了很多关于这个宏的链接器错误：

```
project1.lib(file1.obj) : error LNK2001: unresolved external symbol "private: static class boost::scoped_ptr<class ClassABC> Singleton<class ClassABC>::_instance" (?_instance@?$Singleton@VClassABC@@@@0V?$scoped_ptr@VClassABC@@@boost@@A) 
```

正在使用的宏示例（在源文件中）：

```
#include "singleton.h"
DEFINE_SINGLETON(ClassABC); 
```

我对 Boost 和模板都很陌生（对不起），所以我无法理解为什么在 VS2005 中所有链接都很好时会出现这些错误。值得注意的是，为了进行升级，我们还必须升级我们的 Boost 版本，所以这可能是一个因素 - 已经执行了一些检查：

*   头文件包含在源文件中
*   添加了 Boost 目录以包含目录（在 VC++ 目录下的属性页面下）
*   将 boost lib 目录添加到 Linker -> General -> Additional library dependencies

有关信息，我正在 Win32 上编译一个多线程调试 dll。

我花了一天的大部分时间谷歌搜索无济于事，所以非常感谢任何帮助！

非常感谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:28:10.090

我没有看到您在发布的代码中的任何地方都使用了宏。

您需要将其用作：

```
//add this line after BOOST_ONCE_INIT or before it, or wherever you see fit.
template<class T> DEFINE_SINGLETON(T); 
```

我个人更喜欢这个：

```
template<class T> boost::scoped_ptr<T> Singleton<T>::_instance; 
```

# visual-c++ - opengl c ++中的昼夜效果

> ID：10721949
> 
> 赞同：0
> 
> 时间：2012-05-23T14:21:50.453
> 
> 标签：visual-c++, opengl, graphics

好吧，我正在尝试在使用 opengl 和 c++ 的场景中制作白天/黑夜循环。我试过 glutTimerFunc。虽然我将时间片限制为 10000 ms = 10 s，但它给了我一个非常快速的翻转效果。

这是我所做的。

```
void turn (int value){
    if(night)
    {
        glDisable(GL_LIGHT0);
        glEnable(GL_LIGHT1);
        night=!night;
    }
    else
    {
        glDisable(GL_LIGHT1);
        glEnable(GL_LIGHT0);
        night=!night;
    }
    //glutPostRedisplay();
    glutTimerFunc(10000,&turn,2);
} 
```

在`DrawGLScene`函数中，我调用了该函数。这是 WinMain 函数：

```
int WINAPI WinMain( HINSTANCE   hInstance,          // Instance
    HINSTANCE   hPrevInstance,      // Previous Instance
    LPSTR       lpCmdLine,          // Command Line Parameters
    int         nCmdShow)           // Window Show State
{
    MSG     msg;                                    // Windows Message Structure
    BOOL    done=FALSE;                             // Bool Variable To Exit Loop

    // Ask The User Which Screen Mode They Prefer
    //if (MessageBox(NULL,"Would You Like To Run In Fullscreen Mode?", "Start FullScreen?",MB_YESNO|MB_ICONQUESTION)==IDNO)
    //{
    fullscreen=FALSE;                           // Windowed Mode
    //}

    // Create Our OpenGL Window
    if (!CreateGLWindow("day night",700,500,16,fullscreen))
    {
        return 0;                                   // Quit If Window Was Not Created
    }
    glutTimerFunc(10000,&turn,2);
    //turn(1);
    while(!done)                                    // Loop That Runs While done=FALSE
    {

        if (PeekMessage(&msg,NULL,0,0,PM_REMOVE))   // Is There A Message Waiting?
        {
            if (msg.message==WM_QUIT)               // Have We Received A Quit Message?
            {
                done=TRUE;                          // If So done=TRUE
            }
            else                                    // If Not, Deal With Window Messages
            {
                TranslateMessage(&msg);             // Translate The Message
                DispatchMessage(&msg);              // Dispatch The Message
            }
        }
        else                                        // If There Are No Messages
        {
            // Draw The Scene.  Watch For ESC Key And Quit Messages From DrawGLScene()
            if (active)                             // Program Active?
            {
                if (keys[VK_ESCAPE])                // Was ESC Pressed?
                {
                    done=TRUE;                      // ESC Signalled A Quit
                }
                else                                // Not Time To Quit, Update Screen
                {
                    DrawGLScene();                  // Draw The Scene
                    SwapBuffers(hDC);               // Swap Buffers (Double Buffering)
                }
            }
            if (keys[VK_F1])                        // Is F1 Being Pressed?
            {
                keys[VK_F1]=FALSE;                  // If So Make Key FALSE
                KillGLWindow();                     // Kill Our Current Window
                fullscreen=!fullscreen;             // Toggle Fullscreen / Windowed Mode
                // Recreate Our OpenGL Window
                if (!CreateGLWindow("day night",700,500,16,fullscreen))
                {
                    return 0;                       // Quit If Window Was Not Created
                }

            }
        }
    }

    // Shutdown
    KillGLWindow();                                 // Kill The Window
    return (msg.wParam);                            // Exit The Program
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:30:04.547

如果您`DrawGLScene`已使用注册`glutDisplayFunc`并因此被调用以绘制每一帧，那么您还将在*每次*重绘帧时（即每次调用`glutPostRedisplay()`.

要启动计时器序列，您应该在调用*之前*调用`glutTimerFunc`一次，而不是调用它。*`glutMainLoop``DrawGLScene`*

 *仍然需要`glutTimerFunc` *在*计时器函数中调用以启动下一次翻转。

* * *

**编辑** 我看到你甚至没有使用`glutMainLoop`. 这意味着您的呼叫`glutTimerFunc`没有做任何事情。基于 GLUT 的处理程序*仅*在由函数调度时才`glutMainLoop`起作用。

您的代码做任何事情的唯一原因是因为您在`DrawGLScene`Windows*事件*循环中调用，然后在每次通过 Windows 事件循环时直接调用您的计时器函数。这就是意外高频的来源。

如果您打算坚持使用 Windows 事件模型，那么您最好只使用标准 Windows 计时器事件（即`SetTimer`）来处理翻转。

或者重写您的代码以使用`glutMainLoop`并让 GLUT 处理所有按键和其他事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:22:56.570

这是因为真正的昼夜不是布尔值，而是昼夜之间的渐变。此外，只有 10 秒是一个非常短的白天/黑夜循环——您通常至少需要几分钟。*

# javascript - jQuery 将 data-* 属性转换为小驼峰式属性

> ID：10721951
> 
> 赞同：3
> 
> 时间：2012-05-23T14:22:04.350
> 
> 标签：javascript, jquery, html

我有以下 jQuery 脚本来初始化一个名为 poshytips 的 jQuery 插件。我想使用 Html5 数据属性配置插件。我重复了很多次，任何人都可以想出一个更好的方法来做到这一点？

```
$('.poshytip-trigger').each(function (index) {
    var $this = $(this);
    var data = $this.data();

    var options = {};

    if (data['class-name']) {
        options.className = data['class-name'];
    }

    if (data['align-x']) {
        options.alignX = data['align-x'];
    }

    if (data['align-y']) {
        options.alignY = data['align-y'];
    }

    if (data['offset-y']) {
        options.offsetY = data['offset-y'];
    }

    if (data['offset-x']) {
        options.offsetX = data['offset-x'];
    }

    $this.poshytip(options);
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T14:29:14.617

我会使用 for..in 循环来读取 data-* 标签。你也不需要驼峰式，因为 jQuery 在内部将它转换为驼峰式...[源代码参考](https://github.com/jquery/jquery/blob/master/src/data.js#L102)。

```
$('.poshytip-trigger').each(function (index) {
    var $this = $(this);
    var data = $this.data();
    var options = {};

    for (var keys in data) {
        options[keys] = data[keys];            
    }

    // For older versions of jQuery you can use $.camelCase function
    for (var keys in data) {
        options[$.camelCase(keys)] = data[keys];
    }

}); 
```

[**演示**](http://jsfiddle.net/3eeqV/)

对于 jQuery 1.4.4，

```
$('.poshytip-trigger').each(function(index) {
    var $this = $(this);
    var data = $this.data();
    var options = {};

    for (var keys in data) {
        options[camelCase(keys)] = data[keys];
    }
});

//copied from http://james.padolsey.com/jquery/#v=git&fn=jQuery.camelCase
function camelCase(str) {
    return str.replace(/^-ms-/, "ms-").replace(/-([a-z]|[0-9])/ig, function(all, letter) {
        return (letter + "").toUpperCase();
    });
} 
```

[**1.4.4 的演示**](http://jsfiddle.net/3eeqV/3/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T14:28:12.057

像这样的东西 -**它确实转换`offset-x`为`offsetX`：**

[http://jsfiddle.net/8C4rZ/1/](http://jsfiddle.net/8C4rZ/1/)

HTML：

```
<p data-test="sdsd" data-test2="4434"></p>​ 
```

JavaScript：

```
$(document).ready(function() {
    var options = {};

    for (var key in $("p").data()) {
       options[key] = $("p").data(key);
    }

    console.log(options);
});​ 
```

但我认为 Daniel 的方法更好，因为他明确控制设置哪些属性。这将采用*所有* `data-`属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:26:28.907

尝试使用 for in 循环。

```
var array = ['class-name', 'align-x', 'align-y', 'offset-y', 'offset-x'];
for (x in array) {
    if(data[array[x]]) {
        options[array[x]] = data[array[x]];
    }
} 
```

**更新：**为了回应 OP 的澄清，他可以这样写：

```
var Pair = function(hyphenated, camcelCased) {
    this.hyphenated = hyphenated;
    this.camelCased = camelCased;
}
var array = [
    new Pair('class-name', 'ClassName'),
    new Pair('align-x', 'alignX'),
    new Pair('align-y', 'alignY'),
    new Pair('offset-x', 'offsetX'),
    new Pair('offset-y', 'offsetY')];
var i, optionNameHyphenated, optionNameCamelCased;
for(i = 0; i < array.length; i++) {
    optionNameHyphenated = array[i]['hyphenated'];
    optionNameCamelCased = array[i]['camelCased'];
    if (data[optionNameHyphenated]);
        options[optionNameCamelCased] = data[optionNameHyphenated];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-23T14:31:47.173

```
var names = ["className", "alignY", ...];
$(names).each(function(ind, name){
    var dataName = name.replace(/[A-Z]/, function(letter){
        return letter.toLowerCase();
    });
    if(data[dataName]){
        options[name] = data[dataName];
    }
}); 
```

这行得通吗？与其他答案不同，这段代码都只转换显式设置的属性并保留选项对象属性名称 camelCase。

# visio - Visio：在与形状相交处强制箭头的方法？

> ID：10721952
> 
> 赞同：0
> 
> 时间：2012-05-23T14:22:09.867
> 
> 标签：visio

有没有办法强制 Visio 在线条与连接形状相交的点处绘制箭头？

即自定义连接点非常不方便，因为它们似乎永远不会出现在您需要它们的地方，特别是如果您仍在四处移动形状以尝试获得正确的排列。相反，我想使用连接到每个形状的中心点的线来连接形状，并让 Visio 绘制线条与连接形状相交的箭头。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T12:05:01.367

您使用的是哪个版本的 Visio？

您描述的是 Visio 的标准行为。Visio 连接到边缘周围的连接点。连接将以红色突出显示以指示其连接位置。如果整个形状突出显示红色，则连接点将是另一个形状方向上最近的点。因此，该点不会连接到固定点，而是会根据其他形状的位置移动。

# java - 为什么 CDI 不能代理 final 类？

> ID：10721959
> 
> 赞同：2
> 
> 时间：2012-05-23T14:22:28.447
> 
> 标签：java, dependency-injection, cdi, jboss-weld

[CDI 规范](http://docs.jboss.org/cdi/spec/1.0/html/injectionelresolution.html)的第 5.4.1 节规定，如果声明，否则有效的 bean 是不可代理的（因此无法注入）`final`。该规范没有给出任何理由，我想不出这个决定的原因。

我试图遵守设计规则，即没有明确设计用于继承的类应该禁止它。因此，CDI 规范似乎强制执行糟糕的设计（并使 CheckStyle 哭泣）。

为什么会这样，可以做些什么呢？

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-23T14:31:14.177

因为当你为一个类创建代理时，你从它继承（或实现一个接口，如果可能的话）所以如果你的类是最终的，它不能被继承，也不能为它创建代理。

如果你想使用 CDI，你**需要**有一个 non-final 类。另一种选择是完全不使用 CDI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T14:38:33.670

在最终类上使用方法拦截技术的唯一方法是更改​​类本身。这过去是通过称为“增强”的过程来完成的，其中类文件将在磁盘上进行更改；今天我们可以使用一种叫做*load-time weaving 的*东西。这是一种在加载类时更改类的技术。AspectJ 使用这种技术。

# html - 支持 VAST 的移动视频播放器（android 和 iphone）

> ID：10721961
> 
> 赞同：1
> 
> 时间：2012-05-23T14:22:29.703
> 
> 标签：html, html5-video

我正在寻找可以在 iPhone/iPad 和 Android 手机上运行的视频播放器。

主要问题是处理 VAST（视频广告标签）的能力

欢迎任何建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T18:14:31.387

经过大量搜索，我发现唯一的解决方案是 Kaltura 的玩家。

（他们也有一个开源播放器）

[关联](https://github.com/kaltura/player-sdk-native-android)

# java - 跨域 cookie 和签名小程序

> ID：10721962
> 
> 赞同：1
> 
> 时间：2012-05-23T14:22:32.307
> 
> 标签：java, cookies, applet, signed-applet

已签名的 Java 小程序能否操纵来自其他域的 cookie？（例如，使用 JSObject）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T15:02:10.007

已签名的小程序不会在浏览器中获得提升的权限，因此它无法访问 cookie。但是，如果您知道在哪里查找，它可以从磁盘中读取它们。

# java - URLClassLoader、“热交换”jar 文件和 ClassFormatError - 奇怪的行为

> ID：10721967
> 
> 赞同：0
> 
> 时间：2012-05-23T14:22:39.423
> 
> 标签：java, jar, urlclassloader

**从头开始重写@ 5 月 25 日星期五，格林威治标准时间 16:00 左右**

*（现在代码更干净了，bug可以重现，问题更清楚了）*

**原始问题：**我正在编写一个服务器应用程序，它需要通过网络接受来自客户端的文件并使用某些类处理它们，这些类是通过 URLClassLoader 从本地存储的 .jar 文件加载的。几乎一切正常，但是这些 jar 文件会不时地热交换（无需重新启动服务器应用程序）以应用修补程序，如果我们不幸同时更新 .jar 文件，则来自它的类是正在加载，`ClassFormatError`被抛出，并带有关于“截断类”或“末尾多余字节”的注释。这是意料之中的，但是整个应用程序变得不稳定并且在那之后开始表现得很奇怪——这些`ClassFormatError`异常*一直在发生*当我们尝试从更新的同一个 jar 再次加载类时，即使我们使用 URLClassLoader 的新实例并且它发生在不同的应用程序线程中。

该应用程序在 Debian Squeeze 6.0.3/Java 1.4.2 上运行和编译，迁移不在我的能力范围内。

这是一个模仿应用程序行为并粗略描述问题的简单代码：

1) 主应用程序和每个客户端线程的类：

```
package BugTest;

public class BugTest 
{
  //This is a stub of "client" class, which is created upon every connection in real app
  public static class clientThread extends Thread
    {
    private JarLoader j = null;
    public void run()
      {
        try 
          {
          j = new JarLoader("1.jar","SamplePlugin.MyMyPlugin","SampleFileName");
          j.start();
          }
        catch(Exception e)
          {
          e.printStackTrace();
          }
      }
    }

  //Main server thread; for test purposes we'll simply spawn new clients twice a second.
  public static void main(String[] args)
    {
    BugTest bugTest = new BugTest();
    long counter = 0;        
    while(counter < 500)
        {
        clientThread My = null;
        try
            {
            System.out.print(counter+") "); counter++;
            My = new clientThread();
            My.start();
            Thread.currentThread().sleep(500);
            }
        catch(Exception e)
            {
            e.printStackTrace();
            }
        }
    }
} 
```

2) JarLoader - 用于从 .jar 加载类的包装器，扩展了 Thread。这里我们加载一个实现某个接口a的类：

```
package BugTest;

import JarPlugin.IJarPlugin;
import java.io.File;
import java.io.FileNotFoundException;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLClassLoader;

public class JarLoader extends Thread
{
  private String jarDirectory = "jar/";
  private IJarPlugin Jar;
  private String incomingFile = null;

  public JarLoader(String JarFile, String JarClass, String File) 
         throws FileNotFoundException, MalformedURLException, ClassNotFoundException, InstantiationException, IllegalAccessException
    {
    File myjarfile = new File(jarDirectory);
    myjarfile=new File(myjarfile,JarFile);
    if (!myjarfile.exists())
      throw new FileNotFoundException("Jar File Not Found!");
    URLClassLoader ucl = new URLClassLoader(new URL[]{myjarfile.toURL()});
    Class JarLoadedClass =ucl.loadClass(JarClass);
    // ^^ The aforementioned ClassFormatError happens at that line ^^
    Jar = (IJarPlugin) JarLoadedClass.newInstance();
    this.setDaemon(false);
    incomingFile = File
    }

  public void run()
    {
    Jar.SetLogFile("log-plug.txt");
    Jar.StartPlugin("123",incomingFile);
    }
} 
```

3) IJarPlugin - 可插入 .jar 的简单接口：

```
package JarPlugin;

public interface IJarPlugin 
{
  public void StartPlugin(String Id, String File);
  public void SetLogFile(String LogFile);
} 
```

4）实际插件：

```
package SamplePlugin;
import JarPlugin.IJarPlugin;

public class MyMyPlugin implements IJarPlugin
{
   public void SetLogFile(String File)
    {
    System.out.print("This is the first plugin: ");
    }
  public void StartPlugin(String Id, String File)
    {
    System.out.println("SUCCESS!!! Id: "+Id+",File: "+File);
    }
} 
```

为了重现该错误，我们需要使用相同的类名编译几个不同的 .jar，它们的唯一区别是“这是第 N 个插件：”中的数字。然后启动主应用程序，然后将加载的名为“1.jar”的插件文件快速替换为其他.jar，然后返回，模仿热插拔。同样，`ClassFormatError`在某些时候是可以预料的，但即使 jar 被完全复制（并且没有以任何方式损坏），它也会继续发生，有效地杀死任何试图加载该文件的客户端线程；摆脱这个循环的唯一方法是用另一个插件替换插件。看起来真的很奇怪。

**实际原因：**

一旦我进一步简化了我的代码并摆脱了`clientThread`类，这一切都变得清晰起来，只需实例化并`JarLoader`在. 当被抛出时，它不仅将堆栈跟踪打印出来，而且实际上使整个 JVM 崩溃（以代码 1 退出）。原因并不像现在看起来那么明显（至少不适合我）：extends ， not . 因此它通过并且JVM由于未捕获的异常/错误而退出，但是因为我产生了导致另一个产生的（客户端）线程出错的线程，只有那个线程崩溃了。我想这是因为 Linux 处理 Java 线程的方式，但我不确定。`while``main``ClassFormatError``ClassFormatError``Error``Exception``catch(Exception E)`

**（临时）解决方案：**

一旦未捕获的错误原因变得清晰，我试图在“clientThread”中捕获它。它有点工作（我删除了堆栈跟踪打印输出并打印了我自己的消息），但主要问题仍然存在：`ClassFormatError`即使正确捕获，在我替换或删除有问题的 .jar 之前一直发生。所以我大胆猜测某种缓存可能是罪魁祸首，并通过将其添加到 clientThread`try`块来强制 URLClassLoader 引用失效和垃圾收集：

```
catch(Error e)
  {
  System.out.println("Aw, an error happened.");
  j=null;
  System.gc();
  } 
```

令人惊讶的是，它似乎有效！现在错误只发生一次，然后文件类正常加载，因为它应该。但是由于我只是做了一个假设，但没有理解真正的原因，我仍然担心 - 它现在可以工作，但不能保证它以后会在更复杂的代码中工作。

那么，对Java有更深入了解的人能否告诉我真正的原因是什么，或者至少尝试给出一个方向？也许这是一些已知的错误，甚至是预期的行为，但它已经太复杂了，我自己无法理解——我还是个新手。我真的可以依靠强制GC吗？

# javascript - 单击时取消滚动到顶部操作

> ID：10721979
> 
> 赞同：0
> 
> 时间：2012-05-23T14:23:10.700
> 
> 标签：javascript, jquery, html, mobile

我目前正在使用以下代码在滑动检测脚本的回调中自动滚动到顶部。我想添加在动画期间用户单击屏幕时取消动画的功能。

```
$('body,html').animate({
    scrollTop: 0
}, 300); 
```

我将如何完成此取消？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:32:04.203

使用`stop`方法停止动画。确保传递参数`false`，`jumpToEnd`这样用户就不会被自动带到屏幕顶部。

```
$(function() {
    //Substitute with whatever kicks off this scroll in your app.
    $('button').on('click', function(evt) {
        $('body,html').animate({
            scrollTop: 0
        }, 3000);

        evt.stopPropagation();
    });

    $(window).on('click', function(evt) {
        $('body,html').stop();
    });
}); 
```

**现场示例**- [http://jsfiddle.net/FcLbH/2/](http://jsfiddle.net/FcLbH/2/)

**编辑**`stop`-根据@AvL 的评论删除了参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T14:26:41.650

也许是这样的：

```
$('body,html').animate({
    scrollTop: 0
}, 3000).click(function() {
    $('body,html').stop();
}); 
```

示例：http: [//jsfiddle.net/DJ8Re/1/](http://jsfiddle.net/DJ8Re/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:59:37.090

我不太确定点击检测，无论如何，这将在 3 秒后停止动画：

```
$('body,html').animate({
    scrollTop: 0
}, 6000);

setTimeout(function() { $('html,body').stop(); }, 3000); 
```

有关 stop() 的所有信息：http: [//api.jquery.com/stop/](http://api.jquery.com/stop/)

# ios - 当应用程序从后台返回时如何隐藏飞溅？

> ID：10721981
> 
> 赞同：1
> 
> 时间：2012-05-23T14:23:26.420
> 
> 标签：ios, multitasking

我只是将我的 ios 应用程序的“应用程序不在后台运行”参数设置为 NO，然后我在 applicationDidBecomeActive: 中添加了相关的刷新：在我的应用程序委托中它工作得很好。但是当我切换回我的应用程序时，启动画面仍然会在一秒钟内出现。如何删除它并直接显示应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-23T15:17:51.363

我虽然不可能，但它让我想起了这个话题：[防止从后台返回后显示启动画面](https://stackoverflow.com/questions/8143151/prevent-splash-screen-from-showing-after-returning-from-background)

它似乎包含对您问题的答案......另外，不要忘记在设备上尝试，有时模拟器会做一些奇怪的事情。

# php - 如何从动态表中插入？，从 .xml 文件 PHP 中读取

> ID：10721987
> 
> 赞同：0
> 
> 时间：2012-05-23T14:23:52.587
> 
> 标签：php, mysql, xml, insert

我需要帮助在我的数据库（mysql）中插入一个表。该表是通过读取 .xml 文件创建的，行数取决于 .xml 文件具有的营地数，下面的代码对应于我打印结果的方式。

几个人问我代码我在这里使用读取.xml，我希望能帮助我弄清楚如何进行插入

```
 <?php require_once('Connections/conection_siipo.php'); ?>
  <?php

  $data = array();

  function add_person( $operation, $description, $zone, $workshop )
  {
  global $data;

  $data []= array(
  'operation' => $operation,
  'description' => $description,
  'zone' => $zone,
  'workshop' => $workshop 
  );
  }

  if ( $_FILES['file']['tmp_name'] )
  {
  $dom = DOMDocument::load( $_FILES['file']['tmp_name'] );
  $rows = $dom->getElementsByTagName( 'Row' );
  $first_row = true;
  foreach ($rows as $row)
  {
  if ( !$first_row )
  {
  $operation = "";
  $description = "";
  $zone = "";
  $workshop = "";

  $index = 1;
  $cells = $row->getElementsByTagName( 'Cell' );
  foreach( $cells as $cell )
  { 
  $ind = $cell->getAttribute( 'ss:Index' );
  if ( $ind != null ) $index = $ind;

  if ( $index == 1 ) $operation = $cell->nodeValue;
  if ( $index == 2 ) $description = $cell->nodeValue;
  if ( $index == 3 ) $zone = $cell->nodeValue;
  if ( $index == 4 ) $workshop = $cell->nodeValue;

  $index += 1;
  }
  add_person( $operation, $description, $zone, $workshop );
  }
  $first_row = false;
      }
      }

?> 
```

HTML

```
<table>
    <tr>
        <th>Operation</th>
        <th>Description</th>
        <th>Zone</th>
        <th>Workshop</th>
    </tr>

    <?php foreach( $data as $row ) { ?>
    <tr>
        <td><?php echo( $row['operation'] ); ?></td>
        <td><?php echo( $row['description'] ); ?></td>
        <td><?php echo( $row['zone'] ); ?></td>
        <td><?php echo( $row['workshop'] ); ?></td>
    </tr>
    <?php } ?>
</table> 
```

这段代码是数据的结果，所以我需要帮助来在我的数据库中构建一个插入：

```
<table>
  <tr>
     <th>Operation</th>
     <th>Description</th>
     <th>Zone</th>
     <th>Workshop</th>
  </tr>
  <tr>
     <td>LAN_CQM_CHK_T001BE1N_2</td>
     <td>200002-01-1-REINS(JIC) (GENERAL VISUAL INSPECTION OF ELEMENTS FITTED ON THE FOLLOWING HARNESSES: 400VB, 401VB, 402VB, 403VB, 404VB, 405VB, 406VB, 407VB, 408VB, 409VB)</td>
     <td>300</td>
     <td>40</td>
  </tr>
  <tr>
     <td>LAN_CQM_CHK_T001BE1M_3</td>
     <td>200002-01-1-REM(JIC) (GENERAL VISUAL INSPECTION OF ELEMENTS FITTED ON THE FOLLOWING HARNESSES: 400VB, 401VB, 402VB, 403VB, 404VB, 405VB, 406VB, 407VB, 408VB, 409VB)</td>
     <td>300</td>
     <td>40</td>
  </tr>
  <tr>
     <td>LAN_CQM_CHK_T001BK4W_4</td>
     <td>200315-01-1-INSP(JIC) (GENERAL VISUAL INSPECTION OF G AND P ROUTE WIRING INSTALLED IN THE TAIL CONE AND APU ACCESSORY COMPARTMENT)</td>
     <td>300</td>
     <td>34</td>
  </tr>
  <tr>
     <td>LAN_CQM_CHK_T001BK56_5</td>
     <td>200413-01-1-ENG2-INSP(JIC) (DETAILED INSPECTION OF ALL WIRING INSTALLED IN THE UPPER FORWARD PYLON)</td>
     <td>400</td>
     <td>34</td>
  </tr>
  <tr>
     <td>LAN_CQM_CHK_T001FX2Z_6</td>
     <td>200413-03-1-ENG1-INSP(JIC) (DETAILED INSPECTION OF EWIS INSTALLED IN THE UPPER FORWARD PYLON (EWIS))</td>
     <td>400</td>
     <td>40</td>
  </tr>
  <tr>
     <td>chong</td>
     <td>200413-03-1-ENG2-INSP(JIC) (DETAILED INSPECTION OF EWIS INSTALLED IN THE UPPER FORWARD PYLON (EWIS))</td>
     <td>400</td>
     <td>40</td>
  </tr> 
```

如何保存表格的内容，因为有时 .xml 文件有超过 100 行？

如何从动态表中插入？，从 .xml 文件 PHP 中读取

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:40:34.220

您可以尝试[序列化](http://php.net/manual/ru/function.serialize.phphttp://php.net/manual/ru/function.serialize.php)您的数据并将其保存在任何地方，或者将其保存在键值表中，每个“动态”表具有唯一的 ID。

# ios - 将视频保存到相机胶卷中的自定义相册

> ID：10721988
> 
> 赞同：0
> 
> 时间：2012-05-23T14:23:57.067
> 
> 标签：ios, ios5, video, alassetslibrary

我可以将图像保存到 iPhone 相机胶卷中的自定义相册中。例如，相册名称可以是“Fun”，我拍摄的所有图像都会进入该文件夹。[我在这里](http://www.touch-code-magazine.com/ios5-saving-photos-in-custom-photo-album-category-for-download/)遇到了一个帮助类，它可以很好地完成我想要的。

但是，我使用的方法不会将视频保存到自定义文件夹中，而是创建了该文件夹 - 它只是没有我尝试保存在那里的任何视频。我尝试调试它没有任何进展。该方法在这里：

```
-(void)addAssetURL:(NSURL*)assetURL toAlbum:(NSString*)albumName withCompletionBlock:(SaveImageCompletion)completionBlock
{
__block BOOL albumWasFound = NO;

    //search all photo albums in the library
[self enumerateGroupsWithTypes:ALAssetsGroupAlbum 
                    usingBlock:^(ALAssetsGroup *group, BOOL *stop) {
                        //compare the names of the albums
                        if ([albumName compare: [group valueForProperty:ALAssetsGroupPropertyName]]==NSOrderedSame) {
                            //target album is found
                            albumWasFound = YES;

                            NSData *data = [NSData dataWithContentsOfURL:assetURL];
                            if ([data length] > 0) {
                                //get a hold of the photo's asset instance
                                [self assetForURL: assetURL 
                                      resultBlock:^(ALAsset *asset) {

                                          [group addAsset: asset];

                                          //run the completion block
                                          completionBlock(nil);

                                      } failureBlock: completionBlock];
                            }

                            //album was found, bail out of the method
                            return;
                        }

                        if (group==nil && albumWasFound==NO) {
                            //photo albums are over, target album does not exist, thus create it

                            __weak ALAssetsLibrary* weakSelf = self;

                            //create new assets album
                            [self addAssetsGroupAlbumWithName:albumName 
                                                  resultBlock:^(ALAssetsGroup *group) {

                                                      //get the photo's instance
                                                      [weakSelf assetForURL: assetURL 
                                                                    resultBlock:^(ALAsset *asset) {
                                                                        NSLog(@"asset: %@",asset);
                                                                        //add photo to the newly created album
                                                                        [group addAsset: asset];

                                                                        //call the completion block
                                                                        completionBlock(nil);

                                                                    } failureBlock: completionBlock];

                                                  } failureBlock: completionBlock];

                            //should be the last iteration anyway, but just in case
                            return;
                        }

                    } failureBlock: completionBlock];

} 
```

有谁知道将视频保存到照片库中的自定义相册的正确方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T08:38:59.257

试试这个，它对我有用。

```
-(void)saveVideo:(NSURL *)videoUrl toAlbum:(NSString*)albumName withCompletionBlock:  (SaveImageCompletion)completionBlock
{
    //write the image data to the assets library (camera roll)
    [self writeVideoAtPathToSavedPhotosAlbum:videoUrl completionBlock:^(NSURL* assetURL, NSError* error) {

                       //error handling
                       if (error!=nil) {
                           completionBlock(error);
                           return;
                       }

                       //add the asset to the custom photo album
                       [self addAssetURL: assetURL
                                 toAlbum:albumName
                     withCompletionBlock:completionBlock];

                   }]; 
```

}

# codeigniter - codeigniter php 原生会话，不使用 cookie 或 URL 会话 ID，但匹配数据库中的浏览器指纹

> ID：10721989
> 
> 赞同：2
> 
> 时间：2012-05-23T14:23:57.167
> 
> 标签：codeigniter, cookies, native, session-cookies, overwrite

由于欧洲隐私法在荷兰被严格应用，并且为了保持我公司的网站用户友好，而不会唠叨用户是否可以在他们的计算机上存储允许我访问他们客户数据的 cookie 的问题。

我需要的是一种“覆盖”本机 php 会话类的方法，以便在本机类请求存储 phpsessid 的 cookie 时，我可以将自己的代码放在那里检查浏览器指纹并将其与我可以使用它来返回本机类的正常工作的会话 ID。

我的想法是：

表 sess_fingerprints 字段：指纹 - phpsessid

```
function getsessionid()
    {
    $result = $this->db->query("SELECT phpsessid 
                    FROM `sessiondatabase`.`sess_fingerprints` 
                    WHERE `sess_fingerprints`.`fingerprint` = '$userfingerprint'");
    if($result->num_rows() != 0)
        {
        return $result->row->phpsessid;
        }
    } 
```

那时，本机 php 会话代码就像通常那样工作。

所以，我的问题是：是否可以只覆盖 phpsession 类的“cookie”部分？如果是这样，如何？因为我还没有找到。

我知道能够通过 url 等传递会话变量，但这对于我的 Web 应用程序来说不够安全。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-23T14:30:08.370

PHP 提供对自定义会话处理程序的支持：

[http://php.net/manual/en/session.customhandler.php](http://php.net/manual/en/session.customhandler.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-25T09:31:48.777

我想我已经找到了解决问题的方法。我将使用[http://php.net/manual/en/function.override-function.php覆盖与 cookie 相关的函数](http://php.net/manual/en/function.override-function.php)

谢谢大家一起思考。

# asp.net - mvc3 映射路线

> ID：10721992
> 
> 赞同：1
> 
> 时间：2012-05-23T14:24:04.583
> 
> 标签：asp.net, asp.net-mvc-3, routes

我希望使用以下网址并相应地映射一些路线

```
<domain>/Home/About
<domain>/Home/SiteList
<domain>/Site/<id>/ (this one is defaulted to the details view)
<domain>/Site/<id>/section1/ (this one goes to section1 route in the Site controller)
<domain>/Site/<id>/section2/ (this one goes to section2 route in the Site controller)

e.g.
<domain>/Site/london/siteinfo 
```

以上内容涵盖

```
routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Home", action = "Index", id = UrlParameter.Optional } //     Parameter defaults
        ); 
```

但是，我也想使用以下路线

```
<domain>/Site/<siteid>/section1/controller/action (where controller gets data linked to the <siteid> and action is optional) 
```

一个示例链接是：

```
<domain>/Site/london/siteinfo/manager (manager is a controller and will list managers for the site) 
```

如果尝试了各种路线并阅读了各种帖子，但找不到任何适用于我的东西。

任何人都可以提供一些帮助吗？

谢谢鲁迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T14:34:33.097

在“默认”下方再添加一条路线：

```
routes.MapRoute(
            "MyRouteName",                                              // Route name
            "{controller}/{action}/{id}/{section}/{subsection}",                           // URL with parameters
            new { controller = "Home", action = "Index", id= "", section= "", subsection = "" }  // Parameter defaults
        ); 
```

# c# - DataGridViewCheckBoxColumn 上未显示工具提示

> ID：10721993
> 
> 赞同：1
> 
> 时间：2012-05-23T14:24:05.343
> 
> 标签：c#, winforms

我正在动态添加一个`DataGridViewCheckBoxColumn`到我的`DataGridView`.

但是，我似乎无法将工具提示添加到复选框：

```
// Method to Populate the DataGrid
    private void PopulateDataGrid(objPatient patient)
    {
        this.uiDocumentDataGrid.DataSource = DataManager.GetDocumentData(patient);
        // Hide unnecessary columns
        this.uiDocumentDataGrid.Columns["Forename"].Visible = false;
        this.uiDocumentDataGrid.Columns["Surname"].Visible = false;

        // Add column for selection
        DataGridViewCheckBoxColumn selectedColumn = new DataGridViewCheckBoxColumn();
        selectedColumn.Name = "Selected";
        selectedColumn.HeaderText = "Attach";
        selectedColumn.ReadOnly = false;
        this.uiDocumentDataGrid.Columns.Insert(0,selectedColumn);

        // Set columns except checkbox to readonly
        foreach(DataGridViewColumn c in this.uiDocumentDataGrid.Columns)
        {
            if (c.Index > 0)
            {
                c.ReadOnly = true;
            }
        }

        // Refresh the view in case of draw issues
        this.uiDocumentDataGrid.Refresh();

        // Add tooltip to each checkbox
        foreach (DataGridViewRow r in uiDocumentDataGrid.Rows)
        {
            r.Cells["Selected"].ToolTipText = "Check this box to select this document.";
        }

        // Disable the functionality button if no rows.
        if (this.uiDocumentDataGrid.RowCount == 0)
        {
            this.uiSendButton.Enabled = false;
        }

    } 
```

此方法不显示任何工具提示。我错过了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-23T15:33:44.157

不要尝试在表单的构造函数中设置单元格的 ToolTip 值。尝试在 Load 或 Shown 事件中设置它们：

```
protected override void OnLoad(EventArgs e) {
  foreach (DataGridViewRow r in uiDocumentDataGrid.Rows)
  {
    r.Cells["Selected"].ToolTipText = "Check this box to select this document.";
  } 
  base.OnLoad(e);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-23T15:41:47.867

将此代码添加到`CellFormatting`事件中为我排序。我正在为后代添加这个答案，但也会接受 LarsTech 的答案作为他的作品，正是他将我指向这个事件。

```
private void uiDocumentDataGrid_CellFormatting(object sender, DataGridViewCellFormattingEventArgs e)
    {
        if(e.ColumnIndex == 0)
        {
            DataGridViewCell cell = this.uiDocumentDataGrid.Rows[e.RowIndex].Cells[e.ColumnIndex];
            cell.ToolTipText = "Check this box to select this document.";
        }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T15:09:39.020

尝试这个

```
 DataGridViewCheckBoxColumn selectedColumn = new DataGridViewCheckBoxColumn();
   selectedColumn.Name = "Selected";
   selectedColumn.HeaderText = "Attach";
   selectedColumn.ReadOnly = false;
   this.uiDocumentDataGrid.Columns.Insert(0,selectedColumn);
   uiDocumentDataGrid.CellToolTipTextNeeded += new DataGridViewCellToolTipTextNeededEventHandler(uiDocumentDataGrid_CellToolTipTextNeeded); 
```

并在事件处理程序中

```
 void uiDocumentDataGrid_CellToolTipTextNeeded(object sender, DataGridViewCellToolTipTextNeededEventArgs e)
    {
        if (e.ColumnIndex == 0)
            e.ToolTipText = "Check this box to select this document.";
    } 
```

# sql - 将 0 插入具有相同字段值的连续行中

> ID：10721994
> 
> 赞同：0
> 
> 时间：2012-05-23T14:24:07.253
> 
> 标签：sql, sql-server, sql-server-2008, tsql, sql-server-2005

我有一个包含以下行的表：

![在此处输入图像描述](../Images/6293f0089cf7000b55152210a267ebfc.png)

我想创建一个显示以下结果的视图（不更改我的原始表）：

![在此处输入图像描述](../Images/58ae9c2ee58daf87efdf16f86e9414bf.png)

对于具有相同 id、日、月和年的每一行，我想留下一行包含成本和计数，并在其他行中插入 0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-23T14:30:24.257

你可以这样做：

```
SELECT id, day, month, year,
  CASE WHEN nNum = 1 then cost else 0 end as cost,
  CASE WHEN nNum = 1 then "Count" else 0 end as "Count",
  datetimeIN, datetimeOUT
FROM (
  SELECT id, day, month, year,
    cost, "Count", datetimeIN, datetimeOUT,
    row_number() OVER (PARTITION BY id, day, month, year
                       ORDER BY datetimeIN) as nNum
  FROM TableName
) A 
```

它用于`row_number()`对行进行编号，然后使用一个`CASE`语句来挑出第一个并使其行为不同。

**[在这里查看它在 SQL Fiddle 上的工作。](http://sqlfiddle.com/#!3/f6fc8/5)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T14:31:08.117

这是一种不需要`PARTITION`. 我假设您在一组中不会有`datetimeIN`超过一行的相同值：

```
select t.id, t.day, t.month, t.year,
    case when tm.id is null then 0 else t.cost end as cost,
    case when tm.id is null then 0 else t.Count end as Count,
    t.datetimeIN, t.datetimeOUT
from MyTable t
left outer join (
    select id, day, month, year, min(datetimeIN) as minIN
    from MyTable
    group by id, day, month, year
) tm on t.id = tm.id
    and t.day = tm.day
    and t.month = tm.month
    and t.year = tm.year
    and t.datetimeIN = tm.minIN 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-23T14:35:26.980

或者，使用公用表表达式：

```
 with    commonTableExp ([day], [month], [year], minDate) as (
            select  [day], [month], [year], min(datetimeIn)
            from    #temp
            group by [day], [month], [year])
    select  id,
            dt.[day],
            dt.[month],
            dt.[year],
            case when datetimein = minDate then [cost] else 0 end,
            case when datetimein = minDate then [count] else 0 end,
            dateTimeIn
    from    #temp dt join commonTableExp cte on 
                dt.[day] = cte.[day] and
                dt.[month] = cte.[month] and
                dt.[year] = cte.[year]
    order by dateTimeIn 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-05-23T16:58:32.193

## 询问

```
Select id, [day], [month], [year], Case When K.RowID = 1 Then [cost] Else 0 End as Cost, Case When K.RowID = 1 Then [count] Else 0 End as [count], [DateTimeIN], [DateTimeOut] From
(
    select ROW_NUMBER() Over(Partition by id, [day], [month], [year] Order by ID ) as RowID, * From Testing
)K

Drop table Testing 
```

## **[单击此处查看 Red Filter 查询的 SQL Profiler 详细信息](http://i.stack.imgur.com/9MnSN.png)**

## **[单击此处查看我的查询的 SQL Profiler 详细信息](http://i.stack.imgur.com/mcUfD.png)**

**[有关更多信息，您可以查看 SQL Fiddle](http://sqlfiddle.com/#!3/6772b/1)**

# redirect - URL 中的 Paypal 多个项目

> ID：10721997
> 
> 赞同：0
> 
> 时间：2012-05-23T14:24:14.237
> 
> 标签：redirect, paypal

我必须`Redirect`将买家带到 Paypal 购物车。将它们转发到的 URL 是（为便于阅读而格式化）：

```
https://www.paypal.com/cgi-bin/webscr?cmd=_xclick
&business=email@domain.com
&pal=BGUR9WCWZAL7G
&button_subtype=services
&no_note=1
&no_shipping=1
&rm=1
&return=http://127.0.0.1/store/thank-you
&cancel_return=http://127.0.0.1/store/payment-cancelled
&shipping=0.00
&custom=LoggedInUser|45
&currency_code=EUR
&item_name_1=Store 9 Item
&amount_1=12.00
&item_name_2=Something else
&amount_2=24.00 
```

出于设计原因，我不能使用 Post 数据。

如果我通过传递`&amount=1&item_name=5 Store Items`它作为单个项目它工作正常，但如果可能的话我需要将它分解为单个项目。

这是可行的吗？我看到了这个问题： [通过贝宝支付多个项目（一次）](https://stackoverflow.com/questions/3308898/paying-for-multiple-items-at-once-via-paypal)

但它是用于发布，而不是网址

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-24T19:02:28.533

您可能想尝试购物车上传方法。请参阅[此页面](https://cms.paypal.com/us/cgi-bin/?cmd=_render-content&content_ID=developer/e_howto_html_cart_upload)了解更多信息。

它基本上会变成这样：

```
https://www.paypal.com/cgi-bin/webscr?cmd=_cart
&business=email@domain.com
&pal=BGUR9WCWZAL7G
&button_subtype=services
&upload=1
&no_note=1
&rm=1
&return=http://127.0.0.1/store/thank-you
&cancel_return=http://127.0.0.1/store/payment-cancelled
&currency_code=EUR
&item_name_1=Store 9 Item
&amount_1=12.00
&quantity_1=1
&shipping_1=0.00
&item_name_2=Something else
&amount_2=24.00
&quantity_2=1
&shipping_2=0.00 
```