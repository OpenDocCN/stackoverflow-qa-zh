# StackOverflow 问答 000218000-000218999

# c++ - 在 C++ 中搜索 CStrings

> ID：218003
> 
> 赞同：1
> 
> 时间：2008-10-20T10:24:53.083
> 
> 标签：c++, mfc, string, search, cstring

我想知道是否有一个本地 C++（或 STL/Boost）函数可以在 CString 中搜索指定的字符串？

例如

```
CString strIn = "Test number 1";
CString strQuery = "num";

bool fRet = SomeFn(strIn, StrQuery);

if( fRet == true )
{
  // Ok strQuery was found in strIn
 ... 
```

我发现了少数函数，如 CompareNoCase IndexOf 等......但到目前为止，他们并没有真正做我想让他们做的事情（或使用 CLR/.Net）

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-20T10:29:06.400

[CString::Find()](http://msdn.microsoft.com/ja-jp/library/ms928981.aspx)是您想要的，其中一个重载进行子字符串搜索。

```
CString strIn = "test number 1";
int index = strIn.Find("num");
if (index != -1)
    // ok, found 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-20T10:28:23.873

[字符串::查找](http://www.cplusplus.com/reference/string/string/find.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-20T10:29:03.857

你试过[CString::Find](http://msdn.microsoft.com/en-us/library/aa314323(VS.60).aspx)吗？

它不是 STL 或 boost，但由于您有两个 CString，它似乎是最合理的使用方法。

# git - 在 Git 中回滚

> ID：218023
> 
> 赞同：25
> 
> 时间：2008-10-20T10:40:12.307
> 
> 标签：git

我已经提交并推送了几个补丁：A1-->A2-->A3-->A4 (HEAD)

每个人都将这些变更集拉到他们的本地副本中。

现在我们想“回滚”到 A2，并从那里继续开发 - 基本上丢弃 A3 和 A4。最好的方法是什么？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-10-21T08:18:18.783

从工作副本的根目录中执行

```
git checkout A2 -- .  
git commit -m 'going back to A2' 
```

* * *

用于[`git revert`](http://www.kernel.org/pub/software/scm/git/docs/git-revert.html)此目的会很麻烦，因为您想摆脱一系列提交并`revert`一次撤消它们。

你也不想要[`git reset`](http://www.kernel.org/pub/software/scm/git/docs/git-revert.html)。那只会改变你的`master`分支指针：你没有错误方向的记录。协调起来也很痛苦：由于您更改的提交`master`不是远程存储库`master`分支指针的子项，因此推送将失败 - 除非您首先在远程存储库中添加`-f`（强制）或删除`master`分支并通过推送重新创建它。但是每个尝试拉取的人仍然会在他们的本地`master`分支中保留旧的历史记录，因此一旦出现`origin/master`分歧，`git pull`就会尝试执行合并。这不是世界末日：他们可以通过这样做来摆脱这种情况`git rebase --onto origin/master $old_origin_master_commit master`（即，将他们在旧版本之上的本地提交重新定位`origin/master`到新版本之上`origin/master`）。但 Git 不会自动执行此操作，因此您必须与每个合作者协调。简而言之，不要那样做。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-20T13:50:48.800

丢弃这些提交可能会对从您的存储库中提取的任何人产生一些负面影响。作为另一种选择，您可能需要考虑从 A2 开始创建备用开发分支：

```
A1-->A2-->A3-->A4 (master/HEAD)
      \
       -->B1-->B2（新主/HEAD）

```

这样做很简单

```
git branch new-master master~2

```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-20T10:57:24.783

您想要`git-revert` ~~并且`git-reset`取决于您想要如何对待 A3 和 A4。要删除 A3 和 A4 的所有痕迹，请使用`git-reset --hard`.~~ 要保留 A3 和 A4 并记录您正在还原的事实，请使用`git-revert`.

**编辑**： 亚里士多德 Pagaltzis 的`git-checkout`解决方案是优越的，虽然对于小的还原我不认为`git-revert`. 尽管如此，我要求将来对[亚里士多德 Pagaltzis 的回答给予支持](https://stackoverflow.com/questions/218023/rolling-back-in-git#221137)

我发现[git magic](http://www-cs-students.stanford.edu/~blynn/gitmagic/)是 git 的一个很好的资源。

# c# - C#中的流利接口

> ID：218024
> 
> 赞同：8
> 
> 时间：2008-10-20T10:40:59.573
> 
> 标签：c#, fluent-interface

我对流畅的界面有疑问。

我们有一些对象用作 SQL 接口的参数对象，下面是一个示例：

```
using (DatabaseCommand cmd = conn.CreateCommand(
    "SELECT A, B, C FROM tablename WHERE ID = :ID",
    SqlParameter.Int32(":ID", 1234)))
{
    ...
} 
```

对于其中一些参数，我想启用一些专门的选项，但不是向 Int32 方法添加更多属性（这只是其中之一），我想我会研究流利的接口。

这是我添加了我正在研究的内容的示例：

```
SqlParameter.Int32(":ID", 1234).With(SqlParameterOption
    .Substitute
    .Precision(15)
) 
```

我知道这两个选项对于这种类型的参数没有意义，但这不是问题所在。

在上述情况下，Substitute 必须是 SqlParameterOption 类上的静态属性（或方法，如果我只是添加一些括号），而 Precision 必须是实例方法。

如果我重新排序它们会怎样？

```
SqlParameter.Int32(":ID", 1234).With(SqlParameterOption
    .Precision(15)
    .Substitute
) 
```

那么 Substitute 必须是实例属性，Precision 是静态方法。这当然不会编译，我不能同时拥有同名的静态和非静态属性或方法。

我该怎么做呢？我在这里完全走错了吗？

在重新阅读问题时，我有一个想法，下面这种不同的语法会更有意义吗？

```
SqlParameter.Int32(":ID", 1234).With
    .Precision(15)
    .Substitute 
```

在这种情况下，两者都将是任何 With 返回的实例方法，这将是此类 SqlParameter 选项的专用类或接口。我不确定我是否想转储*.With*部分，因为这会暴露对象的所有方法，而不仅仅是*流利*的方法。

建议和一些好的 url 将是最受欢迎的，我已经搜索了很多例子，但他们倾向于展示这样的例子：

```
order
    .AddFreeShipping()
    .IncludeItem(15)
        .SuppressTax(); 
```

[（从此页面](http://blog.troyd.net/PermaLink,guid,5cdd4862-857a-488d-a577-c6d21b548f19.aspx)解除）

* * *

**编辑**：[@marxidad](https://stackoverflow.com/users/1659/marxidad)回复后的跟进：

```
class SqlParameterOption
{
    public SqlParameterOption Precision(int p) {/* ... */; return this;}
    public SqlParameterOption Substitute() {/* ... */; return this;}
    /* ... */       
}

/* ... */
SqlParameter.Int32(":ID", 1234).With(new SqlParameterOption()
                                           .Precision(15)
                                           .Substitute()); 
```

使用这种方法，With 必须获取对象，并将其应用于参数。我很好。

如果我使用我添加的语法作为示例，它将是这样的：

```
SqlParameter.Int32(":ID", 1234).With
                               .Precision(15)
                               .Substitute()); 
```

在这种情况下，With 不知道链何时结束，因此每个选项都必须直接应用其效果。

什么是首选？选项会构建一个稍后必须应用的效果对象，还是每个效果都直接应用其效果？

**我的决定**：正如[@marxidad](https://stackoverflow.com/users/1659/marxidad)所说，如果更改是不可逆转的，并且可能会发生逆转，那么建立状态并在某个时候出现异常失败是我要走的路。

但是，在这种情况下，我将采用一种更简单的方法，直接修改 SqlParameter 对象。

在这种情况下，我的代码将如下所示：

```
SqlParameter.Int32(":ID", 1234).With
                               .Precision(15)
                               .Substitute()); 
```

**编辑：**啊，当我只专注于一件事时，情况就是这样。

我不能使用该语法，我将按照[@marxidad](https://stackoverflow.com/users/1659/marxidad)的建议使用以下内容：

```
SqlParameter.Int32(":ID", 1234).With(new SqlParameterOption()
                                           .Precision(15)
                                           .Substitute()); 
```

原因当然是把SqlParameter对象作为参数的方法无法处理With返回的对象，所以虽然SqlParameter对象的构造和设置得当，但还是与预期的用法不兼容。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-20T10:51:37.617

`SqlParameterOption's`方法都可以是返回相同对象的实例方法：

```
class SqlParameterOption
 {
    public SqlParameterOption Precision(int p) {/* ... */; return this;}
    public SqlParameterOption Substitute() {/* ... */; return this;}
    /* ... */       
 }

/* ... */
SqlParameter.Int32(":ID", 1234).With(new SqlParameterOption()
                                           .Precision(15)
                                           .Substitute()); 
```

**回复：建立稍后应用的状态与每次调用直接应用**，如果在任何一种情况下都没有真正不可逆转的副作用，那么没关系，这取决于您的个人喜好。如果每个方法调用都提交了选项，并且您可能希望撤消该选项，那么您可能希望先建立状态，然后再应用它。如果参数对象在您应用它们时为您在属性之间进行验证，那么直接应用可能会更好，这样您就可以正确地获得验证反馈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T10:52:23.637

你可以有重载的*方法*。例如，如果它是 Substitute()。您通常不能同时拥有方法的静态版本和实例版本，但扩展方法可能会有一些用处......但是如果 Substitute 的两个版本具有不同的含义，那么简单地返回不同的类型会更清晰，所以Substitute() 的两个变体不能冲突。

# language-agnostic - 柯里化和部分应用有什么区别？

> ID：218025
> 
> 赞同：473
> 
> 时间：2008-10-20T10:41:12.083
> 
> 标签：language-agnostic, terminology, definition, currying, partial-application

我经常在网上看到各种各样的抱怨，说别人的柯里化例子不是柯里化，实际上只是部分应用。

对于什么是部分应用程序，或者它与柯里化有何不同，我还没有找到一个体面的解释。似乎存在一种普遍的混淆，等效的例子在某些地方被描述为柯里化，而在其他地方则被描述为部分应用。

有人可以为我提供这两个术语的定义，以及它们之间的区别细节吗？

* * *

## 回答 #1

> 赞同：277
> 
> 时间：2008-10-20T11:02:57.453

柯里化是将 n 个参数的单个函数转换*为*n*个*函数，每个函数都有一个参数。给定以下功能：

```
function f(x,y,z) { z(x(y));} 
```

当咖喱，变成：

```
function f(x) { lambda(y) { lambda(z) { z(x(y)); } } } 
```

为了得到 f(x,y,z) 的完整应用，你需要这样做：

```
f(x)(y)(z); 
```

许多函数式语言让您编写`f x y z`. 如果你只调用`f x y`or *f(x)(y)*那么你会得到一个部分应用的函数——返回值是一个闭包，`lambda(z){z(x(y))}`其中传入了 x 和 y 的值`f(x,y)`。

使用部分应用的一种方法是将函数定义为广义函数的部分应用，例如**fold**：

```
function fold(combineFunction, accumulator, list) {/* ... */}
function sum     = curry(fold)(lambda(accum,e){e+accum}))(0);
function length  = curry(fold)(lambda(accum,_){1+accum})(empty-list);
function reverse = curry(fold)(lambda(accum,e){concat(e,accum)})(empty-list);

/* ... */
@list = [1, 2, 3, 4]
sum(list) //returns 10
@f = fold(lambda(accum,e){e+accum}) //f = lambda(accumulator,list) {/*...*/}
f(0,list) //returns 10
@g = f(0) //same as sum
g(list)  //returns 10 
```

* * *

## 回答 #2

> 赞同：176
> 
> 时间：2014-05-02T23:26:31.313

了解它们有何不同的最简单方法是考虑一个**真实的例子**。假设我们有一个函数`Add`，它以 2 个数字作为输入并返回一个数字作为输出，例如，`Add(7, 5)`returns `12`。在这种情况下：

*   **部分应用**`Add`具有值的函数`7`将为我们提供一个新函数作为输出。该函数本身将 1 个数字作为输入并输出一个数字。像这样：

    ```
    Partial(Add, 7); // returns a function f2 as output

                     // f2 takes 1 number as input and returns a number as output 
    ```

    所以我们可以这样做：

    ```
    f2 = Partial(Add, 7);
    f2(5); // returns 12;
           // f2(7)(5) is just a syntactic shortcut 
    ```

*   **对函数进行**柯里**`Add`化将为我们提供一个新函数作为输出。该函数本身将 1 个数字作为输入并输出*另一个*新函数。然后，第三个函数将 1 个数字作为输入并返回一个数字作为输出。像这样：**

     **```
    Curry(Add); // returns a function f2 as output

                // f2 takes 1 number as input and returns a function f3 as output
                // i.e. f2(number) = f3

                // f3 takes 1 number as input and returns a number as output
                // i.e. f3(number) = number 
    ```

    所以我们可以这样做：

    ```
    f2 = Curry(Add);
    f3 = f2(7);
    f3(5); // returns 12 
    ```** 

 **换句话说，“currying”和“partial application”是两个完全不同的功能。**柯里化只需要 1 个输入，而部分应用需要 2 个（或更多）输入。**

尽管它们都返回一个函数作为输出，但返回的函数具有完全不同的形式，如上所示。

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2012-05-04T05:18:33.213

注意：这取自[F# Basics](http://msdn.microsoft.com/en-us/magazine/ee336127.aspx)一篇优秀的介绍性文章，供 .NET 开发人员进入函数式编程。

> 柯里化意味着将具有许多参数的函数分解为一系列函数，每个函数接受一个参数并最终产生与原始函数相同的结果。对于刚接触函数式编程的开发人员来说，柯里化可能是最具挑战性的话题，特别是因为它经常与部分应用程序混淆。您可以在此示例中看到两者都在起作用：
> 
> ```
> let multiply x y = x * y    
> let double = multiply 2
> let ten = double 5 
> ```
> 
> 马上，您应该会看到与大多数命令式语言不同的行为。第二条语句通过将一个参数传递给一个接受两个参数的函数来创建一个名为 double 的新函数。结果是一个函数，它接受一个 int 参数并产生相同的输出，就像您调用了 x 等于 2 和 y 等于该参数的乘法一样。在行为方面，它与此代码相同：
> 
> ```
> let double2 z = multiply 2 z 
> ```
> 
> 通常，人们错误地说乘法被柯里化以形成双精度。但这只是有点真实。乘法函数是柯里化的，但在定义它时会发生这种情况，因为 F# 中的函数默认是柯里化的。创建 double 函数时，更准确地说是部分应用了 multiply 函数。
> 
> 乘法函数实际上是一系列两个函数。第一个函数接受一个 int 参数并返回另一个函数，有效地将 x 绑定到特定值。此函数还接受一个 int 参数，您可以将其视为绑定到 y 的值。调用第二个函数后，x 和 y 都绑定了，因此结果是 double 的主体中定义的 x 和 y 的乘积。
> 
> 为了创建双精度，乘法函数链中的第一个函数被评估为部分应用乘法。生成的函数被命名为 double。当 double 被评估时，它使用它的参数以及部分应用的值来创建结果。

* * *

## 回答 #4

> 赞同：37
> 
> 时间：2008-10-20T11:02:06.737

有趣的问题。经过一番搜索，[“Partial Function Application is not currying”](https://web.archive.org/web/20161023205431/http://www.uncarved.com/articles/not_currying)给出了我找到的最好的解释。我不能说*实际*差异对我来说特别明显，但我不是FP专家......

另一个看起来很有用的页面（我承认我还没有完全阅读）是[“Currying and Partial Application with Java Closures”](http://markmahieu.blogspot.com/2007/12/currying-and-partial-application-with.html)。

请注意，这看起来确实是一对被广泛混淆的术语。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2012-10-11T19:40:41.990

我已经在另一个线程[https://stackoverflow.com/a/12846865/1685865](https://stackoverflow.com/a/12846865/1685865)中回答了这个问题。简而言之，偏函数应用是关于固定给定多变量函数的一些参数以产生另一个具有更少参数的函数，而 Currying 是将 N 个参数的函数转换为返回一元函数的一元函数...... [An example of柯里化显示在这篇文章的末尾。]

柯里化主要是理论上的兴趣：人们可以只使用一元函数来表达计算（即*每个*函数都是一元的）。在实践中，作为一种副产品，如果语言具有柯里化函数，它可以使许多有用的（但不是全部）部分功能应用程序变得微不足道。同样，它不是实现部分应用程序的唯一方法。因此，您可能会遇到以其他方式完成部分应用程序的情况，但人们将其误认为是 Currying。

*（咖喱的例子）*

在实践中，一个人不会只写

```
lambda x: lambda y: lambda z: x + y + z 
```

或等效的 javascript

```
function (x) { return function (y){ return function (z){ return x + y + z }}} 
```

代替

```
lambda x, y, z: x + y + z 
```

为了咖喱。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2017-08-30T07:52:22.830

柯里化是**一个**参数的函数，它接受一个函数`f`并返回一个新函数`h`。请注意，它`h`接受一个参数`X`并返回一个映射到的*函数*：`Y``Z`

```
curry(f) = h 
f: (X x Y) -> Z 
h: X -> (Y -> Z) 
```

部分应用是**两个（或多个）**参数的函数，它接受一个函数`f`和一个或多个附加参数`f`并返回一个新函数`g`：

```
part(f, 2) = g
f: (X x Y) -> Z 
g: Y -> Z 
```

之所以会产生混淆，是因为对于两个参数的函数，以下等式成立：

```
partial(f, a) = curry(f)(a) 
```

双方将产生相同的单参数函数。

对于更高元数的函数，等式不成立，因为在这种情况下，currying 将返回一个单参数函数，而部分应用程序将返回一个多参数函数。

不同之处还在于行为，而柯里化递归地转换整个原始函数（每个参数一次），部分应用只是一步替换。

资料来源：[维基百科咖喱](https://en.wikipedia.org/wiki/Currying)。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2018-07-09T20:13:38.190

# 简单的答案

**Curry：**允许您调用一个函数，将其拆分为多个调用，每次调用提供*一个*参数。

**部分：**允许您调用一个函数，将其拆分为多个调用，每次调用提供*多个参数。*

* * *

# 简单提示

两者都允许您调用提供更少参数的函数（或者更好的是，累积提供它们）。实际上，它们都（在每次调用时）将特定值绑定到函数的特定参数。

当函数有超过 2 个参数时，可以看到真正的区别。

* * *

# 简单的 e(c)（样本）

*（在 Javascript 中）*

我们想`process`在不同的 s 上运行以下函数`subject`（例如，假设我们的主题是`"subject1"`和`"foobar"`字符串）：

```
function process(context, successCallback, errorCallback, subject) {...} 
```

为什么总是传递参数，比如上下文和回调，如果它们总是相同的？

只需为函数绑定一些值：

```
processSubject = _.partial(process, my_context, my_success, my_error)
// assign fixed values to the first 3 arguments of the `process` function 
```

*并在subject1*和*foobar*上调用它，省略前 3 个参数的重复，其中：

```
processSubject('subject1');
processSubject('foobar'); 
```

舒服，不是吗？

* * *

使用*currying*，您需要每次传递一个参数

```
curriedProcess = _.curry(process);   // make the function curry-able
processWithBoundedContext = curriedProcess(my_context);
processWithCallbacks = processWithBoundedContext(my_success)(my_error); // note: these are two sequential calls

result1 = processWithCallbacks('subject1');
// same as: process(my_context, my_success, my_error, 'subject1');

result2 = processWithCallbacks('foobar'); 
// same as: process(my_context, my_success, my_error, 'foobar'); 
```

### 免责声明

我跳过了所有的学术/数学解释。因为我不知道。也许它有帮助

* * *

**编辑：**

正如***@basickarl***所补充的，这两个函数的进一步细微差别（参见*Lodash*示例）是：

*   `partial`返回一个预编译函数，**可以使用缺少的参数调用一次**并返回最终结果；
*   while`curry` **被多次调用（每个参数一个）**，每次返回一个预先准备好的函数；除了使用最后一个参数调用的情况外，这将返回处理*所有*参数的实际结果。

* * *

# 使用 ES6：

这是 ECMAScript 6 中即时柯里化和部分应用程序的[快速示例。](https://medium.com/javascript-in-plain-english/functional-programming-higher-order-function-hof-aaa46bb444bb#0760)

```
const curriedSum = math => eng => geo => math + eng + geo;
const partialSum = math => (eng, geo) => math + eng + geo; 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2013-05-27T03:51:08.067

通过以下 JavaScript 示例可以最好地说明 curry 和部分应用程序之间的区别：

```
function f(x, y, z) {
    return x + y + z;
}

var partial = f.bind(null, 1);

6 === partial(2, 3); 
```

部分应用导致较小的arity函数；在上面的示例中， `f`arity 为 3 而`partial`只有 arity 2。更重要的是，部分应用的函数将**在被调用时立即返回结果**，而不是沿着柯里化链的另一个函数。因此，如果您看到类似`partial(2)(3)`的内容，实际上它并不是部分应用。

进一步阅读：

*   [5 分钟内的函数式编程](http://slid.es/gsklee/functional-programming-in-5-minutes)
*   [柯里化：与偏函数应用的对比](http://en.wikipedia.org/wiki/Currying#Contrast_with_partial_function_application)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2017-11-13T02:30:17.730

我在学习的过程中经常遇到这个问题，并且被问过很多次。我可以描述差异的最简单方法是两者都是相同的:) 让我解释一下……显然存在差异。

部分应用和柯里化都涉及为函数提供参数，可能不是一次全部。一个相当典型的例子是添加两个数字。在伪代码（实际上是没有关键字的JS）中，基函数可能如下：

```
add = (x, y) => x + y 
```

如果我想要一个“addOne”函数，我可以部分应用它或咖喱它：

```
addOneC = curry(add, 1)
addOneP = partial(add, 1) 
```

现在使用它们很清楚：

```
addOneC(2) #=> 3
addOneP(2) #=> 3 
```

那么有什么区别呢？好吧，这很微妙，但部分应用程序涉及提供一些参数，然后返回的函数将*在下一次调用时执行主函数，*而柯里化将继续等待，直到它拥有所有必要的参数：

```
curriedAdd = curry(add) # notice, no args are provided
addOne = curriedAdd(1) # returns a function that can be used to provide the last argument
addOne(2) #=> returns 3, as we want

partialAdd = partial(add) # no args provided, but this still returns a function
addOne = partialAdd(1) # oops! can only use a partially applied function once, so now we're trying to add one to an undefined value (no second argument), and we get an error 
```

简而言之，使用部分应用预填充一些值，知道下次调用该方法时，它会执行，留下 undefined 所有未提供的参数；当您想要根据需要多次返回部分应用的函数以完成函数签名时，请使用柯里化。最后一个人为的例子：

```
curriedAdd = curry(add)
curriedAdd()()()()()(1)(2) # ugly and dumb, but it works

partialAdd = partial(add)
partialAdd()()()()()(1)(2) # second invocation of those 7 calls fires it off with undefined parameters 
```

希望这可以帮助！

更新：某些语言或lib实现将允许您将arity（最终评估中的参数总数）传递给部分应用程序实现，这可能会将我的两个描述混为一谈......但在这一点上，这两种技术是很大程度上可以互换。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2013-05-13T10:03:40.747

对我来说，部分应用程序必须创建一个新函数，其中使用的参数完全集成到结果函数中。

大多数函数式语言通过返回闭包来实现柯里化：部分应用时不要在 lambda 下进行评估。因此，为了让部分应用变得有趣，我们需要区分柯里化和部分应用，并将部分应用视为 lambda 下的柯里化加求值。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2015-12-07T05:00:23.313

我在这里可能错了，因为我在理论数学或函数式编程方面没有很强的背景，但是从我对 FP 的短暂尝试来看，似乎柯里化倾向于将 N 个参数的函数转换为一个参数的 N 个函数，而偏应用 [在实践中] 更适用于具有不确定数量参数的可变参数函数。我知道以前答案中的一些示例不符合这种解释，但它对我区分概念的帮助最大。考虑这个例子（为简洁起见，用 CoffeeScript 编写，如果进一步混淆，我深表歉意，但如果需要，请要求澄清）：

```
# partial application
partial_apply = (func) ->
  args = [].slice.call arguments, 1
  -> func.apply null, args.concat [].slice.call arguments

sum_variadic = -> [].reduce.call arguments, (acc, num) -> acc + num

add_to_7_and_5 = partial_apply sum_variadic, 7, 5

add_to_7_and_5 10 # returns 22
add_to_7_and_5 10, 11, 12 # returns 45

# currying
curry = (func) ->
  num_args = func.length
  helper = (prev) ->
    ->
      args = prev.concat [].slice.call arguments
      return if args.length < num_args then helper args else func.apply null, args
  helper []

sum_of_three = (x, y, z) -> x + y + z
curried_sum_of_three = curry sum_of_three
curried_sum_of_three 4 # returns a function expecting more arguments
curried_sum_of_three(4)(5) # still returns a function expecting more arguments
curried_sum_of_three(4)(5)(6) # returns 15
curried_sum_of_three 4, 5, 6 # returns 15 
```

这显然是一个人为的例子，但请注意，部分应用一个接受任意数量参数的函数允许我们执行一个函数，但需要一些初步数据。对函数进行柯里化是类似的，但它允许我们分段执行 N 参数函数，直到但仅在所有 N 个参数都被考虑在内。

同样，这是我从我读过的东西中得到的。如果有人不同意，我会很感激评论为什么而不是立即投反对票。此外，如果 CoffeeScript 难以阅读，请访问 coffeescript.org，单击“try coffeescript”并粘贴我的代码以查看编译后的版本，这可能（希望）更有意义。谢谢！

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2019-05-12T19:11:29.637

我假设大多数问这个问题的人已经熟悉基本概念，所以他们没有必要谈论这个。令人困惑的是重叠部分。

您可能能够充分使用这些概念，但您将它们一起理解为这种伪原子无定形概念模糊。缺少的是知道它们之间的边界在哪里。

与其定义每一个是什么，更容易突出它们的差异——边界。

*柯里*化是你**定义**函数的时候。

*部分应用程序*是在您**调用**该函数时。

*应用程序*是调用函数的数学语言。

**部分**应用程序需要调用一个柯里化函数并获取一个函数作为返回类型。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2017-02-27T21:19:31.123

这里还有其他很好的答案，但我相信这个 Java 示例（根据我的理解）可能对某些人有益：

```
public static <A,B,X> Function< B, X > partiallyApply( BiFunction< A, B, X > aBiFunction, A aValue ){
    return b -> aBiFunction.apply( aValue, b );
}

public static <A,X> Supplier< X > partiallyApply( Function< A, X > aFunction, A aValue ){
    return () -> aFunction.apply( aValue );
}

public static <A,B,X> Function<  A, Function< B, X >  > curry( BiFunction< A, B, X > bif ){
    return a -> partiallyApply( bif, a );
} 
```

**因此，柯里化为您提供了一个单参数函数来创建函数，其中部分应用程序创建一个包装函数，该函数对一个或多个参数进行硬编码。**

如果您想复制和粘贴，以下内容更嘈杂但更友好，因为类型更宽松：

```
public static <A,B,X> Function< ? super B, ? extends X > partiallyApply( final BiFunction< ? super A, ? super B, X > aBiFunction, final A aValue ){
    return b -> aBiFunction.apply( aValue, b );
}

public static <A,X> Supplier< ? extends X > partiallyApply( final Function< ? super A, X > aFunction, final A aValue ){
    return () -> aFunction.apply( aValue );
}

public static <A,B,X> Function<  ? super A,  Function< ? super B, ? extends X >  > curry( final BiFunction< ? super A, ? super B, ? extends X > bif ){
    return a -> partiallyApply( bif, a );
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2020-10-21T16:17:44.807

这里的很多人都没有正确解决这个问题，也没有人谈论过重叠。

## 简单的答案

**Currying：**让您调用一个函数，将其拆分为多个调用，每次调用提供一个参数。

**部分应用程序：**允许您调用一个函数，将其拆分为多个调用，每次调用提供多个参数。

> 两者之间的显着差异之一是调用部分应用的函数会立即返回结果，而不是柯里化链中的另一个函数。对于元数大于二的函数，可以清楚地说明这种区别。

这意味着什么？这意味着最多有两次调用偏函数。柯里化的参数数量与数量一样多。如果柯里化函数只有两个参数，那么它本质上与偏函数相同。

## 例子

**部分应用和柯里化**

```
function bothPartialAndCurry(firstArgument) {
    return function(secondArgument) {
        return firstArgument + secondArgument;
    }
}

const partialAndCurry = bothPartialAndCurry(1);
const result = partialAndCurry(2); 
```

**部分申请**

```
function partialOnly(firstArgument, secondArgument) {
    return function(thirdArgument, fourthArgument, fifthArgument) {
        return firstArgument + secondArgument + thirdArgument + fourthArgument + fifthArgument;
    }
}

const partial = partialOnly(1, 2);
const result = partial(3, 4, 5); 
```

**咖喱**

```
function curryOnly(firstArgument) {
    return function(secondArgument) {
        return function(thirdArgument) {
            return function(fourthArgument ) {
                return function(fifthArgument) {
                    return firstArgument + secondArgument + thirdArgument + fourthArgument + fifthArgument;
                }
            }
        }
    }
}

const curryFirst = curryOnly(1);
const currySecond = curryFirst(2);
const curryThird = currySecond(3);
const curryFourth = curryThird(4);
const result = curryFourth(5);

// or...

const result = curryOnly(1)(2)(3)(4)(5); 
```

## 命名约定

*有时间我会写这个，很快。*

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-04-09T03:29:17.213

在写这篇文章时，我混淆了 currying 和 uncurrying。它们是函数的逆变换。只要你得到变换及其逆表示的内容，你称之为什么并不重要。

Uncurrying 的定义不是很清楚（或者更确切地说，有一些“冲突”的定义都抓住了这个想法的精神）。基本上，这意味着将一个接受多个参数的函数转换为一个接受单个参数的函数。例如，

```
(+) :: Int -> Int -> Int 
```

现在，你如何把它变成一个接受单个参数的函数？你作弊，当然！

```
plus :: (Int, Int) -> Int 
```

请注意， plus 现在接受一个参数（由两件事组成）。极好的！

这有什么意义？好吧，如果您有一个带有两个参数的函数，并且您有一对参数，那么很高兴知道您可以将函数应用于参数，并且仍然可以得到您期望的结果。而且，事实上，实现它的管道已经存在，因此您不必执行诸如显式模式匹配之类的事情。你所要做的就是：

```
(uncurry (+)) (1,2) 
```

那么什么是偏函数应用呢？将具有两个参数的函数转换为具有一个参数的函数是另一种方法。但它的工作方式不同。同样，让我们​​以（+）为例。我们如何将它变成一个以单个 Int 作为参数的函数？我们作弊！

```
((+) 0) :: Int -> Int 
```

这就是将零添加到任何 Int 的函数。

```
((+) 1) :: Int -> Int 
```

任何 Int 加 1。等等。在每种情况下，(+) 都是“部分应用”。

# visual-studio - VS2005/8 中用于“退出当前方法”的键盘快捷键

> ID：218027
> 
> 赞同：1
> 
> 时间：2008-10-20T10:41:28.793
> 
> 标签：visual-studio, debugging, keyboard, shortcuts

调试时，每当我想退出当前方法而不运行它的任何语句时，我都会做一个技巧，我将当前执行指针移动到方法的末尾，然后单击 F10/11。

是否有键盘快捷键（或者我可以编写一个）来完成此操作？

（我的意思不是 shift-F11（跳出）——它会运行所有代码直到方法结束，这是我不想要的）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T02:00:15.100

以下击键序列对我有用（在 Visual Studio 2008 中测试）；我能够将它们记录为临时宏并成功播放：

1.  `Ctrl+M, Ctrl+M`（Edit.ToggleOutliningExpansion：折叠当前方法）
2.  `Right arrow`（跳过折叠的参数列表）
3.  `Ctrl+]`（Edit.GotoBrace：转到左大括号）
4.  `Ctrl+]`（Edit.GotoBrace：转到右大括号）
5.  `Ctrl+Shift+F10`（Debug.SetNextStatement：将下一条语句设置为函数末尾的右大括号）
6.  `F10`（Debug.StepOver：离开方法）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T10:53:33.230

AFAIK 这是唯一的方法。

# java - Javac 调试打开和关闭之间是否存在性能差异？

> ID：218033
> 
> 赞同：61
> 
> 时间：2008-10-20T10:49:14.033
> 
> 标签：java, performance, debugging, javac

如果我打开使用 Javac 生成调试信息，那么类文件会大 20-25%。这对运行 Java 程序有任何性能影响吗？如果是，在哪些条件和多少条件下。我希望对加载类有一点影响，因为文件更大，但这应该是最小的。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2008-10-20T12:03:36.520

在任何语言中，调试信息都是元信息。它本质上会增加目标文件的大小，从而增加加载时间。在调试器外部执行期间，此信息实际上被完全忽略。正如[JVM 规范](http://java.sun.com/docs/books/jvms/second_edition/html/ClassFile.doc.html#1546)中概述的（虽然不是很清楚），调试信息存储在字节码流之外。这意味着在执行时类文件没有区别。如果您想确定，请尝试一下:-)。

附言。通常对于调试来说，关闭优化是有价值的。这*确实*会对性能产生影响。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-22T00:58:39.967

单独关闭调试不应该有任何区别。但是一旦关闭调试并打开优化，您应该会看到不同之处，因为这会在编译时进行一些静态优化。这样，即使您的热点优化代码在运行时也会变得更快。

但到目前为止，在获得有意义的完整堆栈跟踪或拥有更多用户性能之间的权衡，我总是投票支持堆栈跟踪。毕竟，用户愿意每年花费 1000 美元来获得更快的机器，但不愿意花 15 分钟给你有意义的错误信息来解决他们的问题。

多年后，我更愿意把我的 15 分钟看重，而不是用户的 1000 美元。:)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-25T11:07:49.253

请注意，由于 JDK1.3 javac 忽略任何优化标志，“编译时优化是不必要的”

# visual-c++ - MFC：更改 CEdit 的颜色

> ID：218035
> 
> 赞同：6
> 
> 时间：2008-10-20T10:50:53.390
> 
> 标签：visual-c++, mfc, colors, cedit

伙计们，有人能给我简要介绍一下如何在运行时更改 CEdit 控件的背景颜色吗？如果字段长度为零，我希望能够将背景更改为红色，否则为正常的白色。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-20T10:59:39.973

你不能用一个普通的 CEdit 来做，你需要覆盖一些位。

实现您自己的 ON_WM_CTLCOLOR_REFLECT 处理程序，然后在处理程序中返回您的彩色 CBrush：

（粗略地说，你需要把通常的资源管理放在那里，记住在析构函数中删除你的画笔）

```
class CColorEdit : public CEdit
{
  ....
  CBrush   m_brBkgnd;
  afx_msg HBRUSH CtlColor(CDC* pDC, UINT nCtlColor)
  {
    m_brBkgnd.DeleteObject();
    m_brBkgnd.CreateSolidBrush(nCtlColor);
  }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-30T09:14:46.040

这也可以在不从 CEdit 派生的情况下完成：

1.  添加`ON_WM_CTLCOLOR()`到对话框的`BEGIN_MESSAGE_MAP()`代码块。
2.  添加`OnCltColor()`到您的对话框类：

    ```
    afx_msg HBRUSH OnCtlColor(CDC* pDC, CWnd* pWnd, UINT nCtlColor); 
    ```

3.  `OnCtlColor()`像这样实现：

    ```
    HBRUSH CMyDialog::OnCtlColor(CDC* pDC, CWnd* pWnd, UINT nCtlColor)
    {
        if ((CTLCOLOR_EDIT == nCtlColor) &&
            (IDC_MY_EDIT == pWnd->GetDlgCtrlID()))
        {
            return m_brMyEditBk; //Create this brush in OnInitDialog() and destroy in destructor
        }
        return CDialog::OnCtlColor(pDC, pWnd, nCtlColor);
    } 
    ```

# .net - 使用单击一次部署时，是否有可用的“发布日期”属性

> ID：218042
> 
> 赞同：2
> 
> 时间：2008-10-20T10:54:10.873
> 
> 标签：.net, deployment, clickonce

我想在“关于”对话框中显示发布日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T11:20:56.577

很不幸的是，不行。ApplicationDeployment 类仅公开[CurrentVersion](http://msdn.microsoft.com/en-us/library/system.deployment.application.applicationdeployment.currentversion(VS.80).aspx)属性，而不公开发布时间。

您可以使用修订字段来存储构建日期以显示在“关于”对话框中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T11:35:26.890

据我所知，Click-Once 没有直接的方法可以做到这一点。

这是一种**解决方法**：您必须将有问题的文件（DLL 或 EXE）加载到 FileInfo 对象中并从中获取修改日期。

```
FileInfo oMyFile = new
   FileInfo(Assembly.GetExecutingAssembly().Location);

DateTime oBuildDate = oMyFile.LastWriteTime // or LastWriteTimeUtc - don't use "CreationTime" 
```

*注意：从技术上讲，它不是发布日期，而是客户端磁盘上的组装日期。您必须检查 Click-Once 是否不会更改该日期*

# javascript - IE 选择和范围问题

> ID：218043
> 
> 赞同：2
> 
> 时间：2008-10-20T10:55:04.427
> 
> 标签：javascript, internet-explorer, selection-object

我正在尝试获取选择的开始元素和结束元素以及每个选择的偏移量，我在 Firefox 中执行以下操作：

```
var delselection = window.getSelection();

var startOffset = delselection.anchorOffset;

var endOffset = delselection.focusOffset;

var startNode = delselection.anchorNode.parentNode;

var endNode = delselection.focusNode.parentNode; 
```

但是我不知道如何在 IE6 中执行此操作，任何人都可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-20T11:33:50.560

文件选择。

但是 IE 返回的 TextRange 对象与 Firefox/WebKit/W3 的不匹配，并且确定起点和终点的确切位置非常令人沮丧。根据您对范围所做的具体操作，您可以使用 range.parentElement()、range.inRange() 或 range.compareEndPoints() 获得某个位置。对于富文本编辑器，您通常最终会使用丑陋的 range.execCommand() 接口。

IE Range 实现与 Mozilla/Webkit/W3 模型是如此奇怪和不同，以至于您通常会以完全不同的代码路径结束与两者之间的选择有关的所有事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T11:22:02.190

您应该查看 IE BOM 的[ControlRange](http://msdn.microsoft.com/en-us/library/ms537447(VS.85).aspx#)和[TextRange](http://msdn.microsoft.com/en-us/library/ms535872(VS.85).aspx)对象。

我相信 IE6/7 不支持 AnchorOffset、focusOffset 和 window.getSelection()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-12-22T11:47:26.340

如果您知道选择所在的对象（例如，它是用户正在输入的输入字段，您希望在他们输入时更改），则此代码可以解决问题：

```
var selObj = null;
var selSave = null;
var selSaveEnd = null;

function SaveSelection(obj) {
    if (obj.selectionStart) {
        selObj = obj;
        selSave = obj.selectionStart;
        selSaveEnd = obj.selectionEnd;
    }
    else {
        // Internet Explorer case
        selSave = document.selection.createRange();
    }
}

function RestoreSelection() {
    if (selObj) {
        selObj.focus();
        selObj.selectionStart = selSave;
        selObj.selectionEnd = selSaveEnd;
    }
    else {
        // Internet Explorer case
        selSave.select();
    }
} 
```

# open-source - 开源登录系统，有什么好？

> ID：218051
> 
> 赞同：11
> 
> 时间：2008-10-20T10:57:30.007
> 
> 标签：open-source, login, authentication

我正在开始一个新的 Web 开发项目，我厌倦了编写登录系统。这种事情以前肯定做过几十次。我真的很想使用别人的代码，因为它比我自己的代码更容易，而且可能会更好。出于所有常见的原因，我更喜欢开源，但如果我不喜欢某些东西，我主要希望能够更改它，并且错误修复比设计整个东西更容易。

我只需要一个登录系统，它可以管理用户名/密码和用户注册。我不需要整个 CMS。

我已经在查看 openid.net，但是您使用过哪些开源登录系统？您听说过哪些其他登录系统？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-20T11:07:49.877

OpenID 工作得非常好。鉴于最近的采用浪潮，我认为 OpenID 是最好的选择。它是跨平台的，并拥有适用于所有主要开发平台（php、python、perl、ruby、.net、java、c++）的库。我已经为 DotNetNuke 实现了它，发现它相对轻松。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-20T11:05:30.443

OpenID 绝对是最好的解决方案，那里有大量适用于各种语言的开源库。哈瓦看看[openidenabled.com](http://openidenabled.com/)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-20T11:05:42.177

我不知道您喜欢或有哪些技术（语言和平台）作为要求，但我们已经在我的工作场所实施了[CAS](http://www.jasig.org/cas)，并且效果很好。

CAS 本身是用 Java 实现的，但正如首页所说，它具有客户端库以及与许多其他技术和平台的集成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T03:42:05.753

我最终选择了 mod_auth_openid。它非常简单，可以防止其他级别的不必要的复杂化。但代码并不完美，我可能需要稍后调整它。

# svn - SVN 合并工具

> ID：218053
> 
> 赞同：20
> 
> 时间：2008-10-20T11:00:49.767
> 
> 标签：svn, merge

SVN 合并非常耗时（尤其是在大型代码库上）并且容易出错。Eclipse 和 Netbeans 插件不能很好地为我服务。目前我正在使用手动“svn merge”和图形差异[Meld](http://meld.sourceforge.net/)的组合。有没有更好的选择（非win32）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-20T11:20:23.457

Meld 可以说是非 win32 最好的工具之一，也是最常用的工具之一。在 Windows 或 Wine [WinMerge](http://winmerge.org/)上胜出。Linux 的一些替代方案：

*   [孔帕雷](http://www.caffeinated.me.uk/kompare/)
*   [KDiff3](http://kdiff3.sourceforge.net/)
*   [差异](http://freshmeat.net/projects/dirdiff/)

PS 实际上在 Windows 上，TortoiseSVN 合并工具也提供了很好的结果:)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-20T20:00:11.037

I have recently started using the new [Beyond Compare 3](http://scootersoftware.com) (for Windows and Linux). It seems to consistently make better automated merge decisions then TortoiseSVN or KDiff3\. Particularly on whitespace, I believe this is due to BC3s better file type configuration.

I also think its merge interface is cleaner and easier to understand then KDiff.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-20T11:19:28.200

我想出了如何使用 SvnMerge，它是一个 Python 脚本，并取得了相当大的成功。你可以用谷歌搜索我在博客上的说明，或者给我留言，我会发布虚荣链接。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-20T12:01:11.643

实际上，有报道称人们使用 git-svn 或 hg-svn 网桥下载树，执行合并，然后上传合并。不能解决混乱的部分，但合并速度的提高使它不那么乏味。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-20T12:39:14.030

我真的很喜欢 Sourcegear Diffmerge。 [http://www.sourcegear.com/diffmerge/](http://www.sourcegear.com/diffmerge/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-20T12:39:33.640

我们一直在我的工作中使用 TortoiseSVN。合并从来没有任何问题，所以我也可以推荐它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-20T20:04:18.063

I've used [svnmerge](http://www.orcaware.com/svn/wiki/Svnmerge.py) and it helps a lot. It's a command line utility, so it may not be the best tool for everyone, but it's good for me.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-20T12:37:31.210

你在哪个平台上运行？在 Windows 上，我使用**TortoiseSVN**很容易地执行大多数差异和合并。UltraCompare 仅执行一些更复杂的差异链。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-08-06T13:47:22.330

Best tool I've currently found for Linux is submerge from subcommander package. [Here](http://lifeinide.com/post/2011-08-06-edit-conflicts-in-eclipse-using-submerge/) is how to use this and integrate with eclipse.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-03-18T11:09:53.157

I have created open source console tool to automate merging process. I think it can helpful for other peoples: [Merger](https://merger.codeplex.com/)
It can:
- Switch subfolders in the folder to the new branch
- Calculate difficulty of the future merge (number of commits/changed files/ commits to the same files, by project)
- Merge revision by revision in auto mode, until no conflicts
- Bulk merge of the groups of projects.
In theory it should be able to work with mono.

# visual-studio - Visual Studio 调试器提示和技巧（适用于 C/C++ 项目）

> ID：218056
> 
> 赞同：14
> 
> 时间：2008-10-20T11:03:14.507
> 
> 标签：visual-studio, debugging

我对有关在 Visual Studio 的调试器中调试 C/C++ 项目的提示和技巧感兴趣。我最近发现，如果你有一个指向某种数据类型的指针，比如说 char* ptr，那么你可以在监视窗口中使用如下语法将它视为一个数组：

```
点，10

```

这将显示 ptr 地址中的前 10 个元素，其显示方式与定义为：

```
字符指针[10]；

```

关于 Visual Studio 调试器，您还知道哪些其他提示和技巧？

PS：我希望这个话题还没有被讨论过。如果你找到类似的帖子，请告诉我。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-20T11:25:22.637

我真的很喜欢通过**AutoExp.dat**调整类型和结构的调试器显示的可能性。该文件位于

> ..\Microsoft Visual Studio 9.0\Common7\Packages\Debugger\autoexp.dat

并允许定义自己的模板以在调试期间显示数据：

> 调试时，Watch 和 Variable 窗口中的数据提示和项目会自动展开以显示它们最重要的元素。扩展遵循此文件中的规则给出的格式。您可以为您的类型添加规则或更改预定义的规则。

The file is full of good examples and you can easily adapt certain templates to your own needs or add new ones for your own classes.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-20T11:12:17.793

您可以使用一段有点尴尬的代码来设置线程的名称。请参阅[MSDN 上的这篇文章](http://msdn.microsoft.com/en-us/library/xcb2z8hs.aspx)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-20T12:21:41.447

Probably the most important tip you can use is DebugBreak. Put DebugBreak() in your code, and when it executes it's like hitting a break point.

The real nice thing is that you can then put conditionals on it that might ber hard to set on a regular breakpoint. Learn to use this!

For example, your program is crashing when it digests a certain data file. You discover that it crashes in a certain function, but only after it's called a million times+. You also have figured out that it is crashing because a certain variable call it x has the value 1001, but x is supposed to be between 0 and 1000\. So instead of hoping to luckily catch the place where x becomes to big, you find every place that x changes. Right after that you put the statement: if(x>1000) DebugBreak();

Yes you can do this with conditional breakpoints, but I've seen a program that takes 1 second to execute slow down to 15 minutes with three coniditional breakpoints, but execute in 1.5 seconds with the DebugBreak.

Having said that here are a couple of useful suggestions. Mathematically prove to yourself that the reason you think a bug is happening accounts for the actual bug happening at least part of the time ( not likely to have two bugs create the same problem, but it happens ). I've seen some of the most stupid fixes put in place because people "feel" that's the reson for the bug. Make sure your logic is as sound as any proof in a geometry class.

The second suggestion if you put in an experimental fix, and it doesn't do anything. Take it out.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-20T11:19:01.603

有些人实际上并没有意识到您可以更改变量值并移动执行点。如果您在感兴趣的代码行之后遇到断点，并且您想使用不同的值再次尝试，这将非常有用。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-20T17:59:27.880

Some other tips&tricks I found in this article:

```
ptr,su -> display ptr as if it was a string of unicode chars.
val,hr -> view val as a hresult data
val,wc -> view val as a window class
val,wm -> view val as a window message

```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-20T11:36:58.273

SaraFord's blog is brilliant for visual studio hints and tips - [Sara Ford's Weblog](http://blogs.msdn.com/saraford/)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-20T12:52:24.473

*   Some debugging / watch related tips:

    Use the following in the Watch window to find out what GetLastError() would return:

    @ERR,hr

*   If you use Visual Studio 2003 or earlier, use this watch expression to find out the length of your std::vector v:

    v._Mylast-v._Myfirst

    You can also list the e.g. first 5 entries with this expression:

    v._Myfirst,5

    This doesn't work when using STLport, and the method obsoleted in VS >= 2005 with the new expression visualizers.

*   If you want to see the return value of a function, look at the eax register (just enter eax in the watch window). You can even change the returned value. If it's a pointer to a string or array, you can also enter eax in the Memory window to see the underlying string.

# c# - 路由请求时 HttpContext.Current.Session 为空

> ID：218057
> 
> 赞同：48
> 
> 时间：2008-10-20T11:03:28.310
> 
> 标签：c#, asp.net, routing, session-variables

没有路由，`HttpContext.Current.Session`是否存在所以我知道它`StateServer`正在工作。当我路由我的请求时，`HttpContext.Current.Session`在`null`路由页面中。我在 IIS 7.0 上使用 .NET 3.5 sp1，没有 MVC 预览。使用路由时似乎`AcquireRequestState`永远不会触发，因此会话变量不会被实例化/填充。

当我尝试访问 Session 变量时，我收到此错误：

`base {System.Runtime.InteropServices.ExternalException} = {"Session state can only be used when enableSessionState is set to true, either in a configuration file or in the Page directive. Please also make sure that System.Web.SessionStateModule or a custom session state module is included in the <configuration>.`

在调试时，我还收到`HttpContext.Current.Session`在该上下文中无法访问的错误。

--

我的`web.config`样子是这样的：

```
<configuration>
  ...
  <system.web>
    <pages enableSessionState="true">
      <controls>
        ...
      </controls>
    </pages>
    ...
  </system.web>
  <sessionState cookieless="AutoDetect" mode="StateServer" timeout="22" />
  ...
</configuration> 
```

这是 IRouteHandler 的实现：

```
public class WebPageRouteHandler : IRouteHandler, IRequiresSessionState
{
    public string m_VirtualPath { get; private set; }
    public bool m_CheckPhysicalUrlAccess { get; set; }

    public WebPageRouteHandler(string virtualPath) : this(virtualPath, false)
    {
    }
    public WebPageRouteHandler(string virtualPath, bool checkPhysicalUrlAccess)
    {
        m_VirtualPath = virtualPath;
        m_CheckPhysicalUrlAccess = checkPhysicalUrlAccess;
    }

    public IHttpHandler GetHttpHandler(RequestContext requestContext)
    {
        if (m_CheckPhysicalUrlAccess
            && !UrlAuthorizationModule.CheckUrlAccessForPrincipal(
                   m_VirtualPath,
                   requestContext.HttpContext.User,
                   requestContext.HttpContext.Request.HttpMethod))
        {
            throw new SecurityException();
        }

        string var = String.Empty;
        foreach (var value in requestContext.RouteData.Values)
        {
            requestContext.HttpContext.Items[value.Key] = value.Value;
        }

        Page page = BuildManager.CreateInstanceFromVirtualPath(
                        m_VirtualPath, 
                        typeof(Page)) as Page;// IHttpHandler;

        if (page != null)
        {
            return page;
        }
        return page;
    }
} 
```

我也尝试过放在`EnableSessionState="True"`aspx 页面的顶部，但仍然没有。

Any insights? Should I write another `HttpRequestHandler` that implements `IRequiresSessionState`?

Thanks.

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-10-21T09:01:32.333

Got it. Quite stupid, actually. It worked after I removed & added the SessionStateModule like so:

```
<configuration>
  ...
  <system.webServer>
    ...
    <modules>
      <remove name="Session" />
      <add name="Session" type="System.Web.SessionState.SessionStateModule"/>
      ...
    </modules>
  </system.webServer>
</configuration> 
```

Simply adding it won't work since "Session" should have already been defined in the `machine.config`.

Now, I wonder if that is the usual thing to do. It surely doesn't seem so since it seems so crude...

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-12-19T15:46:56.837

Just add attribute `runAllManagedModulesForAllRequests="true"` to `system.webServer\modules` in web.config.

This attribute is enabled by default in MVC and Dynamic Data projects.

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2011-06-21T17:00:04.393

`runAllManagedModulesForAllRequests=true` is actually a real bad solution. This increased the load time of my application by 200%. The better solution is to manually remove and add the session object and to avoid the run all managed modules attribute all together.

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-09-22T14:50:02.217

None of these solutions worked for me. I added the following method into `global.asax.cs` then Session was not null:

```
protected void Application_PostAuthorizeRequest()
{
    HttpContext.Current.SetSessionStateBehavior(SessionStateBehavior.Required);
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-20T11:30:28.240

What @Bogdan Maxim said. Or change to use InProc if you're not using an external sesssion state server.

```
<sessionState mode="InProc" timeout="20" cookieless="AutoDetect" /> 
```

Look [here](http://msdn.microsoft.com/en-us/library/h6bb9cz9.aspx) for more info on the SessionState directive.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-13T02:44:27.800

Nice job! I've been having the exact same problem. Adding and removing the Session module worked perfectly for me too. It didn't however bring back by HttpContext.Current.User so I tried your little trick with the FormsAuth module and sure enough, that did it.

```
<remove name="FormsAuthentication" />
<add name="FormsAuthentication" type="System.Web.Security.FormsAuthenticationModule"/> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-20T11:10:19.547

It seems that you have forgotten to add your state server address in the [config](http://msdn.microsoft.com/en-us/library/ms972429.aspx) file.

```
 <sessionstate mode="StateServer" timeout="20" server="127.0.0.1" port="42424" /> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-20T11:29:02.330

The config section seems sound as it works if when pages are accessed normally. I've tried the other configurations suggested but the problem is still there.

I doubt the problem is in the Session provider since it works without the routing.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-20T13:59:04.103

I think this part of code make changes to the context.

```
 Page page = BuildManager.CreateInstanceFromVirtualPath(
                        m_VirtualPath, 
                        typeof(Page)) as Page;// IHttpHandler; 
```

Also this part of code is useless:

```
 if (page != null)
 {
     return page;
 }
 return page; 
```

It will always return the page wither it's null or not.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-10-07T20:27:58.723

I was missing a reference to System.web.mvc dll in the session adapter, and adding the same fixed the issue.

Hopefully it will help someone else going through same scenario.

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-10-28T17:55:50.533

a better solution is

runAllManagedModulesForAllRequest is a clever thing to do respect removing and resinserting session module.

alk.

# c# - 随机高斯变量

> ID：218060
> 
> 赞同：135
> 
> 时间：2008-10-20T11:06:09.133
> 
> 标签：c#, .net

.NET 标准库中是否有一个类可以让我创建遵循高斯分布的随机变量？

* * *

## 回答 #1

> 赞同：197
> 
> 时间：2008-10-20T14:16:12.213

Jarrett 关于使用 Box-Muller 变换的建议非常适合快速而简单的解决方案。一个简单的实现：

```
Random rand = new Random(); //reuse this if you are generating many
double u1 = 1.0-rand.NextDouble(); //uniform(0,1] random doubles
double u2 = 1.0-rand.NextDouble();
double randStdNormal = Math.Sqrt(-2.0 * Math.Log(u1)) *
             Math.Sin(2.0 * Math.PI * u2); //random normal(0,1)
double randNormal =
             mean + stdDev * randStdNormal; //random normal(mean,stdDev^2) 
```

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2013-03-21T19:30:18.117

This question appears to have moved on top of Google for .NET Gaussian generation, so I figured I'd post an answer.

I've made some [extension methods for the .NET Random class](https://bitbucket.org/Superbest/superbest-random), including an implementation of the Box-Muller transform. Since they're extensions, so long as the project is included (or you reference the compiled DLL), you can still do

```
var r = new Random();
var x = r.NextGaussian(); 
```

Hope nobody minds the shameless plug.

Sample histogram of results (a demo app for drawing this is included):

![enter image description here](https://i.stack.imgur.com/Np1ed.png)

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2012-10-16T22:11:33.243

[Math.NET](http://www.mathdotnet.com/) provides this functionality. Here's how:

```
double mean = 100;
double stdDev = 10;

MathNet.Numerics.Distributions.Normal normalDist = new Normal(mean, stdDev);
double randomGaussianValue=   normalDist.Sample(); 
```

You can find documentation here: [http://numerics.mathdotnet.com/api/MathNet.Numerics.Distributions/Normal.htm](http://numerics.mathdotnet.com/api/MathNet.Numerics.Distributions/Normal.htm)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-01-04T14:50:55.640

我在 Microsoft Connect 上创建了对此类功能的请求。如果这是您正在寻找的东西，请为它投票并提高其知名度。

[https://connect.microsoft.com/VisualStudio/feedback/details/634346/guassian-normal-distribution-random-numbers](https://connect.microsoft.com/VisualStudio/feedback/details/634346/guassian-normal-distribution-random-numbers)

此功能包含在 Java SDK 中。它的实现[作为文档的一部分提供，](http://download.oracle.com/javase/1.4.2/docs/api/java/util/Random.html#nextGaussian())并且很容易移植到 C# 或其他 .NET 语言。

如果您正在寻找纯粹的速度，那么[Zigorat 算法](http://en.wikipedia.org/wiki/Ziggurat_algorithm)通常被认为是最快的方法。

虽然我不是这个主题的专家——我在为我的[RoboCup 3D 模拟机器人足球库实现](http://code.google.com/p/tin-man/)[粒子过滤器](http://en.wikipedia.org/wiki/Particle_filter)时遇到了这个需求，当框架中没有包含它时我感到很惊讶。

* * *

同时，这里有一个包装器，`Random`它提供了 Box Muller 极坐标方法的有效实现：

```
public sealed class GaussianRandom
{
    private bool _hasDeviate;
    private double _storedDeviate;
    private readonly Random _random;

    public GaussianRandom(Random random = null)
    {
        _random = random ?? new Random();
    }

    /// <summary>
    /// Obtains normally (Gaussian) distributed random numbers, using the Box-Muller
    /// transformation.  This transformation takes two uniformly distributed deviates
    /// within the unit circle, and transforms them into two independently
    /// distributed normal deviates.
    /// </summary>
    /// <param name="mu">The mean of the distribution.  Default is zero.</param>
    /// <param name="sigma">The standard deviation of the distribution.  Default is one.</param>
    /// <returns></returns>
    public double NextGaussian(double mu = 0, double sigma = 1)
    {
        if (sigma <= 0)
            throw new ArgumentOutOfRangeException("sigma", "Must be greater than zero.");

        if (_hasDeviate)
        {
            _hasDeviate = false;
            return _storedDeviate*sigma + mu;
        }

        double v1, v2, rSquared;
        do
        {
            // two random values between -1.0 and 1.0
            v1 = 2*_random.NextDouble() - 1;
            v2 = 2*_random.NextDouble() - 1;
            rSquared = v1*v1 + v2*v2;
            // ensure within the unit circle
        } while (rSquared >= 1 || rSquared == 0);

        // calculate polar tranformation for each deviate
        var polar = Math.Sqrt(-2*Math.Log(rSquared)/rSquared);
        // store first deviate
        _storedDeviate = v2*polar;
        _hasDeviate = true;
        // return second deviate
        return v1*polar*sigma + mu;
    }
} 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-03-13T17:23:53.950

Here is another quick and dirty solution for generating random variables that are [normal distributed](https://en.wikipedia.org/wiki/Normal_distribution). It draws some random point (x,y) and checks if this point lies under the curve of your probability density function, otherwise repeat.

Bonus: You can generate random variables for any other distribution (e.g. the [exponential distribution](https://en.wikipedia.org/wiki/Exponential_distribution) or [poisson distribution](https://en.wikipedia.org/wiki/Poisson_distribution)) just by replacing the density function.

```
 static Random _rand = new Random();

    public static double Draw()
    {
        while (true)
        {
            // Get random values from interval [0,1]
            var x = _rand.NextDouble(); 
            var y = _rand.NextDouble(); 

            // Is the point (x,y) below the graph of the density function?
            if (y < f(x)) 
                return x;
        }
    }

    // Probability density function of the normal "Gaussian" distribution
    public static double f(double x, double μ = 0.5, double σ = 0.5)
    {
        return 1d / Math.Sqrt(2 * σ * σ * Math.PI) * Math.Exp(-((x - μ) * (x - μ)) / (2 * σ * σ));
    } 
```

Important: Select the interval of *y* and the parameters *σ* and *μ* so that the curve of the function is not cutoff at it's maximum/minimum points (e.g. at x=mean). Think of the intervals of *x* and *y* as a bounding box, in which the curve must fit in.

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-10-20T21:34:49.817

[Math.NET Iridium](http://iridium.mathdotnet.com)还声称实现“非均匀随机生成器（正常、泊松、二项式……）”。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2018-01-11T03:27:23.217

Expanding off of @Noakes and @Hameer's answers, I have also implemented a 'Gaussian' class, but to simplify memory space, I made it a child of the Random class so that you can also call the basic Next(), NextDouble(), etc from the Gaussian class as well without having to create an additional Random object to handle it. I also eliminated the _available, and _nextgauss global class properties, as I didn't see them as necessary since this class is instance based, it should be thread-safe, if you give each thread its own Gaussian object. I also moved all of the run-time allocated variables out of the function and made them class properties, this will reduce the number of calls to the memory manager since the 4 doubles should theoretically never be de-allocated until the object is destroyed.

```
public class Gaussian : Random
{

    private double u1;
    private double u2;
    private double temp1;
    private double temp2;

    public Gaussian(int seed):base(seed)
    {
    }

    public Gaussian() : base()
    {
    }

    /// <summary>
    /// Obtains normally (Gaussian) distrubuted random numbers, using the Box-Muller
    /// transformation.  This transformation takes two uniformly distributed deviates
    /// within the unit circle, and transforms them into two independently distributed normal deviates.
    /// </summary>
    /// <param name="mu">The mean of the distribution.  Default is zero</param>
    /// <param name="sigma">The standard deviation of the distribution.  Default is one.</param>
    /// <returns></returns>

    public double RandomGauss(double mu = 0, double sigma = 1)
    {
        if (sigma <= 0)
            throw new ArgumentOutOfRangeException("sigma", "Must be greater than zero.");

        u1 = base.NextDouble();
        u2 = base.NextDouble();
        temp1 = Math.Sqrt(-2 * Math.Log(u1));
        temp2 = 2 * Math.PI * u2;

        return mu + sigma*(temp1 * Math.Cos(temp2));
    }
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-08-27T08:26:39.940

I'd like to expand upon @yoyoyoyosef's answer by making it even faster, and writing a wrapper class. The overhead incurred may not mean twice as fast, but I think it should be *almost* twice as fast. It isn't thread-safe, though.

```
public class Gaussian
{
     private bool _available;
     private double _nextGauss;
     private Random _rng;

     public Gaussian()
     {
         _rng = new Random();
     }

     public double RandomGauss()
     {
        if (_available)
        {
            _available = false;
            return _nextGauss;
        }

        double u1 = _rng.NextDouble();
        double u2 = _rng.NextDouble();
        double temp1 = Math.Sqrt(-2.0*Math.Log(u1));
        double temp2 = 2.0*Math.PI*u2;

        _nextGauss = temp1 * Math.Sin(temp2);
        _available = true;
        return temp1*Math.Cos(temp2);
     }

    public double RandomGauss(double mu, double sigma)
    {
        return mu + sigma*RandomGauss();
    }

    public double RandomGauss(double sigma)
    {
        return sigma*RandomGauss();
    }
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-01-28T04:15:47.953

Expanding on Drew Noakes's answer, if you need better performance than Box-Muller (around 50-75% faster), Colin Green has shared an implementation of the Ziggurat algorithm in C#, which you can find here:

[http://heliosphan.org/zigguratalgorithm/zigguratalgorithm.html](http://heliosphan.org/zigguratalgorithm/zigguratalgorithm.html)

Ziggurat uses a lookup table to handle values that fall sufficiently far from the curve, which it will quickly accept or reject. Around 2.5% of the time, it has to do further calculations to determine which side of the curve a number is on.

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-11-12T13:12:43.230

The other implementations are a little too heady for me. My implementation relies on the fact that throwing three six sided dice (D6) and recording the sum of the dice will creates a normal distribution. Just replace the three D6 with three calls to your your language's "rand()" function and you're just about there. In the implementation below, I subtract by two divided by the number of "dice," so 1.5 in this case.

```
using System;

public class CustomMath
{
    private static readonly Random _random = new Random();
    public static double GaussianRandom() =>
        _random.NextDouble() + _random.NextDouble() + _random.NextDouble() - 1.5;
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-01-15T02:14:00.763

You could try Infer.NET. It's not commercial licensed yet though. Here is there [link](http://research.microsoft.com/en-us/um/cambridge/projects/infernet/)

It is a probabilistic framework for .NET developed my Microsoft research. They have .NET types for distributions of Bernoulli, Beta, Gamma, Gaussian, Poisson, and probably some more I left out.

It may accomplish what you want. Thanks.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-08-20T04:27:01.077

This is my simple Box Muller inspired implementation. You can increase the resolution to fit your needs. Although this works great for me, this is a limited range approximation, so keep in mind the tails are closed and finite, but certainly you can expand them as needed.

```
 //
    // by Dan
    // islandTraderFX
    // copyright 2015
    // Siesta Key, FL
    //    
// 0.0  3231 ********************************
// 0.1  1981 *******************
// 0.2  1411 **************
// 0.3  1048 **********
// 0.4  810 ********
// 0.5  573 *****
// 0.6  464 ****
// 0.7  262 **
// 0.8  161 *
// 0.9  59 
//Total: 10000

double g()
{
   double res = 1000000;
   return random.Next(0, (int)(res * random.NextDouble()) + 1) / res;
}

public static class RandomProvider
{
   public static int seed = Environment.TickCount;

   private static ThreadLocal<Random> randomWrapper = new ThreadLocal<Random>(() =>
       new Random(Interlocked.Increment(ref seed))
   );

   public static Random GetThreadRandom()
   {
       return randomWrapper.Value;
   }
} 
```

# language-agnostic - 获取应用的路径

> ID：218061
> 
> 赞同：80
> 
> 时间：2008-10-20T11:07:34.810
> 
> 标签：language-agnostic, path

我最近搜索了如何在 Java 中获取应用程序的目录。我终于找到了答案，但我需要的时间出奇的长，因为搜索这样一个通用术语并不容易。我认为编制一份如何用多种语言实现这一目标的列表是个好主意。

如果您（不）喜欢这个想法，请随意赞成/反对，如果您喜欢，**请贡献**。

## 澄清：

*包含可执行文件*的目录和*当前工作目录*（`pwd`在 Unix 下给出）之间有一个很好的区别。我最初对前者感兴趣，但也可以随意发布确定后者的方法（澄清你的意思）。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-03-24T07:17:06.977

In **Java** the calls

```
System.getProperty("user.dir") 
```

and

```
new java.io.File(".").getAbsolutePath(); 
```

return the current working directory.

The call to

```
getClass().getProtectionDomain().getCodeSource().getLocation().getPath(); 
```

returns the path to the JAR file containing the current class, or the CLASSPATH element (path) that yielded the current class if you're running directly from the filesystem.

Example:

1.  Your application is located at

    ```
     C:\MyJar.jar 
    ```

2.  Open the shell (cmd.exe) and `cd` to C:\test\subdirectory.

3.  Start the application using the command `java -jar C:\MyJar.jar`.

4.  The first two calls return 'C:\test\subdirectory'; the third call returns 'C:\MyJar.jar'.

When running from a filesystem rather than a JAR file, the result will be the path to the root of the generated class files, for instance

```
c:\eclipse\workspaces\YourProject\bin\ 
```

The path does not include the package directories for the generated class files.

A complete example to get the application directory without .jar file name, or the corresponding path to the class files if running directly from the filesystem (e.g. when debugging):

```
String applicationDir = getClass().getProtectionDomain().getCodeSource().getLocation().getPath(); 

if (applicationDir.endsWith(".jar"))
{
    applicationDir = new File(applicationDir).getParent();
}
// else we already have the correct answer 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-10-20T11:07:58.880

在**.NET (C#, VB, ...)**中，您可以查询当前`Assembly`实例的`Location`. 但是，这会附加可执行文件的文件名。以下代码清理路径（`using System.IO`和`using System.Reflection`）：

```
Directory.GetParent(Assembly.GetExecutingAssembly().Location) 
```

或者，您可以使用提供的信息`AppDomain`来搜索引用的程序集：

```
System.AppDomain.CurrentDomain.BaseDirectory 
```

VB 允许通过`My`命名空间使用另一个快捷方式：

```
My.Application.Info.DirectoryPath 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-20T12:24:31.627

在**Windows**中，使用 WinAPI 函数[GetModuleFileName()](http://msdn.microsoft.com/en-us/library/ms683197(VS.85).aspx)。为模块句柄传入 NULL 以获取当前模块的路径。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-20T11:27:46.000

**Python**

```
path = os.path.dirname(__file__) 
```

这将获取当前模块的路径。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-24T15:43:00.020

**Objective-C Cocoa**（Mac OS X，我不知道 iPhone 的特性）：

```
NSString * applicationPath = [[NSBundle mainBundle] bundlePath]; 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-20T11:07:42.420

在**Java**中，有两种方法可以找到应用程序的路径。一是雇用`System.getProperty`：

```
System.getProperty("user.dir"); 
```

另一种可能性是使用`java.io.File`：

```
new java.io.File("").getAbsolutePath(); 
```

还有一种可能使用反射：

```
getClass().getProtectionDomain().getCodeSource().getLocation().getPath(); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-07-31T10:34:42.500

在 VB6 中，您可以使用该[`App.Path`](http://msdn.microsoft.com/en-us/library/aa268072%28v=vs.60%29.aspx)属性获取应用程序路径。

`\`请注意，当应用程序位于驱动器的根目录中时，这不会有尾随EXCEPT。

在 IDE 中：

```
?App.Path
C:\Program Files\Microsoft Visual Studio\VB98 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-10-28T17:38:56.390

在**.Net**中你可以使用

`System.IO.Directory.GetCurrentDirectory`

获取应用程序的当前工作目录，特别是在 VB.NET 中，您可以使用

`My.Application.Info.DirectoryPath`

获取exe的目录。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-10-20T12:25:06.820

**Libc**
在 *nix 类型环境中（在 Windows 中也是 Cygwin）：

```
 #include <unistd.h>

   char *getcwd(char *buf, size_t size);

   char *getwd(char *buf); //deprecated

   char *get_current_dir_name(void); 
```

[见手册页](http://www.kernel.org/doc/man-pages/online/pages/man3/getcwd.3.html)

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-10-20T11:23:19.643

**德尔福**

在 Windows 应用程序中：

```
Unit Forms;
path := ExtractFilePath(Application.ExeName); 
```

在控制台应用程序中：

与语言无关，第一个命令行参数是完全限定的可执行文件名：

```
Unit System;
path := ExtractFilePath(ParamStr(0)); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-10-20T11:15:53.077

在**bash**中，'pwd' 命令返回当前工作目录。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-12-14T04:30:56.767

在**PHP**中：

```
<?php
  echo __DIR__; //same as dirname(__FILE__). will return the directory of the running script
  echo $_SERVER["DOCUMENT_ROOT"]; // will return the document root directory under which the current script is executing, as defined in the server's configuration file.
  echo getcwd(); //will return the current working directory (it may differ from the current script location).
?> 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-20T12:15:57.837

**Unix**

在 unix 中，可以找到使用环境变量启动的可执行文件的路径。它**不一定**是绝对路径，因此您需要将当前工作目录（在 shell: 中`pwd`）和/或 PATH 变量与环境的第 0 个元素的值结合起来。

但是，该值在 unix 中是有限的，因为例如可以通过符号链接调用可执行文件，并且只有初始链接用于环境变量。一般来说，如果 unix 上的应用程序将其用于任何有趣的事情（例如加载资源），它们就不是很健壮。在 unix 上，通常对事物使用硬编码的位置，例如`/etc`指定资源位置的配置文件。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2010-08-11T16:09:42.397

在**Tcl中**

当前脚本的路径：

```
set path [info script] 
```

Tcl 外壳路径：

```
set path [info nameofexecutable] 
```

如果您需要其中任何一个的目录，请执行以下操作：

```
set dir [file dirname $path] 
```

获取当前（工作）目录：

```
set dir [pwd] 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2012-02-20T20:08:19.823

在**Android**中

```
getApplicationInfo().dataDir; 
```

要获得 SD 卡，我使用

```
Environment.getExternalStorageDirectory();
Environment.getExternalStoragePublicDirectory(String type); 
```

后者用于存储特定类型的文件（音频/电影等）。您在 Environment 类中有这些字符串的常量。

基本上，对于与应用程序相关的任何事情，使用 ApplicationInfo 类，对于与 SD 卡/外部目录中的数据相关的事情，使用 Environment 类。

文档： [ApplicationInfo](http://developer.android.com/reference/android/content/pm/ApplicationInfo.html)， [环境](http://developer.android.com/reference/android/os/Environment.html)

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2016-09-06T11:41:06.103

**爪哇：**

在所有系统（Windows、Linux、Mac OS X）上只对我有用：

```
public static File getApplicationDir() 
{
    URL url = ClassLoader.getSystemClassLoader().getResource(".");
    File applicationDir = null;
    try {
        applicationDir = new File(url.toURI());
    } catch(URISyntaxException e) {
        applicationDir = new File(url.getPath());
    }

    return applicationDir;
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-10-20T11:37:40.287

在**Ruby**中，以下代码段返回当前源文件的路径：

```
path = File.dirname(__FILE__) 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-12-14T22:33:48.550

在**CFML**中有两个函数用于访问脚本的路径：

```
getBaseTemplatePath()
getCurrentTemplatePath() 
```

调用 getBaseTemplatePath 会返回“base”脚本的路径——即 Web 服务器请求的路径。
调用 getCurrentTemplatePath 返回当前脚本的路径 - 即当前正在执行的脚本。

两个路径都是绝对的，并且包含脚本的完整目录+文件名。

要确定只是目录，请使用`getDirectoryFromPath( ... )`结果上的函数。

因此，要确定应用程序的目录位置，您可以执行以下操作：

```
<cfset Application.Paths.Root = getDirectoryFromPath( getCurrentTemplatePath() ) /> 
```

在`onApplicationStart`活动内部为您`Application.cfc`

* * *

要确定运行 CFML 引擎的应用服务器所在的路径，您可以使用 cfexecute 访问 shell 命令，因此（请记住上面关于 pwd/etc 的讨论）您可以执行以下操作：

Unix：

```
<cfexecute name="pwd"/> 
```

对于 Windows，创建一个`pwd.bat`包含 text `@cd`，然后：

```
<cfexecute name="C:\docume~1\myuser\pwd.bat"/> 
```

（使用 的`variable`属性`cfexecute`来存储值而不是输出到屏幕。）

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2015-01-28T16:54:52.807

我发布了[https://github.com/gpakosz/whereami](https://github.com/gpakosz/whereami)，它解决了 C 中的问题并为您提供：

*   当前可执行文件的路径
*   当前模块的路径（从共享库调用时与可执行文件的路径不同）。

它在 Windows 上使用，在 Linux 和 Android`GetModuleFileNameW`上解析并在 Mac 和 iOS 上使用。`/proc/self/maps``_NSGetExecutablePath``dladdr`

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2012-07-03T09:40:34.000

在 cmd（Microsoft 命令行 shell）中

您可以使用 %* 获取脚本的名称（可能与 pwd 相关）

这将获取脚本目录：

```
set oldpwd=%cd%
cd %0\..
set app_dir=%pwd%
cd %oldpwd% 
```

如果你发现任何错误，你会的。然后请修复或评论。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2012-01-31T12:25:20.247

注意回答上面关于 Mac OSX 的“20”：如果 JAR 可执行文件通过 OSX JAR BUNDLER 转换为“应用程序”，那么 getClass().getProtectionDomain().getCodeSource().getLocation(); 将不会返回应用程序的当前目录，但会将应用程序的内部目录结构添加到响应中。这个应用程序的内部结构是/theCurrentFolderWhereTheAppReside/Contents/Resources/Java/yourfile

也许这是Java中的一个小错误。无论如何，必须使用方法一或二来获得正确答案，即使应用程序已启动，例如通过位于不同文件夹或桌面上的快捷方式，两者都会提供正确答案。

卡尔

SoundPimp.com

# css - 向左溢出而不是向右溢出

> ID：218065
> 
> 赞同：122
> 
> 时间：2008-10-20T11:09:17.253
> 
> 标签：css, html, overflow

我有一个带有 的 div `overflow:hidden`，在用户键入电话号码时，我会在其中显示电话号码。div 内的文本向右对齐，并且随着文本向左增长，传入的字符被添加到右侧。

但是一旦文本大到不适合 div，数字的最后一个字符会自动裁剪，用户无法看到她键入的新字符。

我想要做的是裁剪左侧字符，就像 div 显示其内容的最右侧并溢出到左侧。我怎样才能创造这种效果？

![电话号码向左溢出](https://i.imgur.com/CRbCCPm.jpg)

* * *

## 回答 #1

> 赞同：171
> 
> 时间：2008-10-20T11:11:43.817

您是否尝试过使用以下内容：

```
direction: rtl; 
```

有关详细信息，请参阅
[http://www.w3schools.com/cssref/pr_text_direction.asp](http://www.w3schools.com/cssref/pr_text_direction.asp)

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2012-09-28T20:02:57.177

我有同样的问题并使用两个 div 解决了它。外部 div 在左侧进行剪辑，内部 div 进行右侧浮动。

```
.outer-div {
  width:70%;
  margin-left:auto;
  margin-right:auto;
  text-align:right;
  overflow:hidden;
  white-space: nowrap;
}

.inner-div {
  float:right;
}

:

<div class="outer-div">
  <div class="inner-div">     
    <p>A very long line that should be trimmed on the left</p>
  </div>
</div> 
```

您应该能够将任何内容放入内部 div 并将其溢出到左侧。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-24T18:02:50.573

很容易做到，`<span>`数字和跨度绝对位置位于元素内的右侧，并隐藏了溢出。

```
<div style="width: 65px; height: 20px;
            overflow: hidden; position: relative; background: #66FF66;">
    <span style="position: absolute; right: 0;">05451234567</span>
</div> 
```

:)

rgrds 杰克

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-10-05T12:53:12.067

这就像一个魅力：

```
<div style="direction: rtl;">
  <span style="white-space: nowrap; direction: ltr; display: inline-block;">your short or long comment<span>
</div> 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-04-22T16:57:56.783

你可以这样做`float:right`，它会溢出到左边，但在我的情况下，如果窗口大于元素，我需要将 div 居中，但如果窗口较小，则溢出到左边。对此有什么想法吗？

我试着玩弄，`direction:rtl`但这似乎并没有改变块元素的溢出。

我认为唯一的答案是让它向右浮动，它右侧的 div 也向右浮动，然后使用 jquery 将右侧的 div 的宽度设置为剩余窗口空间的一半。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2021-09-01T09:02:11.060

这是使用 flexbox 的一种更简单的解决方案。它也适用于伪元素。

```
p {
  display: flex;
  justify-content: flex-end;
  white-space: nowrap;
  overflow: hidden;

  font-size: 2em;
  width: 120px;
  background: yellow;
}
```

```
<p>156189789123</p>
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-17T03:44:46.023

修改了 HTML 标记并在 WebWanderer 的 jsFiddle 解决方案中添加了一些 javascript。

[https://jsfiddle.net/urulai/bfzqgreo/3/](https://jsfiddle.net/urulai/bfzqgreo/3/)

HTML：

```
<div id="outer-div">

    <p>ipsum dolor amet bacon venison porchetta spare ribs, tongue turducken alcatra doner leberkas t-bone rump ball tip hamburger drumstick. Shoulder strip steak ribeye, kielbasa fatback pig kevin drumstick biltong pork short loin rump. Biltong doner ribeye, alcatra landjaeger tenderloin drumstick t-bone pastrami andouille. Sirloin spare ribs fatback, bresaola strip steak alcatra landjaeger kielbasa cupim doner. </p>

</div> 
```

CSS：

```
#outer-div {
  width:100%;
  margin-left:auto;
  margin-right:auto;
  text-align:right;
  overflow:hidden;
  white-space: nowrap;
  border:1px solid black;
} 
```

JS：

```
let outer = document.getElementById("outer-div");
outer.scrollLeft += outer.scrollWidth; 
```

# xsd - JAXB - XJC - 影响生成的类型安全枚举类和成员

> ID：218067
> 
> 赞同：1
> 
> 时间：2008-10-20T11:10:12.167
> 
> 标签：xsd, enums, jaxb, type-safety, xjc

使用 XJC 编译器（来自 JAXB 包）编译以下 simpleType 时...

```
<xs:simpleType name="test">
    <xs:annotation>
        <xs:appinfo>
            <jaxb:typesafeEnumClass/>
        </xs:appinfo>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:enumeration value="4">
        <xs:annotation>
          <xs:appinfo>
            <jaxb:typesafeEnumMember name="FOUR"/>
          </xs:appinfo>
        </xs:annotation>
      </xs:enumeration>      
      <xs:enumeration value="6">
        <xs:annotation>
          <xs:appinfo>
            <jaxb:typesafeEnumMember name="SIX"/>
          </xs:appinfo>
        </xs:annotation>
      </xs:enumeration>
     </xs:restriction>
</xs:simpleType> 
```

我最终在 Java 中得到了以下枚举（删除了导入语句和注释）

```
@XmlEnum
public enum Test {

    @XmlEnumValue("4")
    FOUR("4"),
    @XmlEnumValue("6")
    SIX("6");
    private final String value;

    Test(String v) {
        value = v;
    }

    public String value() {
        return value;
    }

    public static Test fromValue(String v) {
        for (Test c: Test.values()) {
            if (c.value.equals(v)) {
                return c;
            }
        }
        throw new IllegalArgumentException(v.toString());
    }

} 
```

这正是我想要的......除了`public String value()`方法。我希望`public String getValue()`根据 Sun 的命名约定调用该方法。这样我就可以轻松地在使用 EL 的 JSP 页面中使用它。现在我必须解决它。

`getValue()`有没有人有任何经验将 XJC 编译进一步调整为使用方法而不是方法的更有用的枚举`value()`？或者我可以添加一个方法或什么？

PS 这发生在 JAXB 的 v2.0.3 中。我下载了最新版本v2.1.8 和那里一样...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T16:44:59.610

There's nothing in the JAXB spec that seems to allow this change. I think the only way to do this would be to write a JAXB Plugin.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-06T21:51:30.587

you could create a small variant of the generated class that only differs from the generated one for the name of this method. then at runtime, you have to make sure your variant is loaded instead of the generated one, playing the classloader game.

Of course, this can only work is the original XSD doesn't change often.

# macos - 在 OS X 上使用 ColdFusion 的最佳数据库

> ID：218070
> 
> 赞同：2
> 
> 时间：2008-10-20T11:11:23.490
> 
> 标签：macos, coldfusion

OS X Leopard 上的 ColdFusion 8 标准版。

开发一个新的网站。

与 ColdFusion 结合使用的最佳数据库是什么？

将为一家独立软件公司存储简单的信用卡操作、注册信息、CRM 信息

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-20T13:32:57.730

我会研究 MySQL 和/或 PostgreSQL。

我更熟悉MySQL。我比较喜欢。它是可靠的，具有良好的管理工具。我在 OSX 服务器上（几年前）用 PHP 使用过它，它提供的性能足以满足我们的小型操作。绝对值得一看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-21T01:20:50.280

我建议使用 MySQL，因为它已经安装在 OS X 上。

它也受到托管公司的广泛支持，因此您应该可以毫无问题地找到一个好的主机（包括我在 stackoverflow 右下角看到的 CrystalTech 徽标）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-20T13:02:54.780

简单的回答：Access 和 CF 的内置解决方案都不是。两者都适用于开发，但不适用于真实的实时系统。

更好的答案是：无论您的数据库服务器上运行什么。将 Web 服务器和 DB 服务器分开是一个好主意。

直播网站真的要在 Leopard 上运行吗？那么答案将是 CF 可以使用驱动程序在 Leopard 下运行的任何东西。MySQL是一种选择吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-22T17:55:57.137

答案取决于许多因素：

你期望多少负载？如果这是一个不经常被 4 或 5 人使用的 Intranet 解决方案，那么内置的 SQLLite 可能就足够了。如果这是一个面向公众的 Web 应用程序，预计每天会收到数百个订单，那么您可能希望在同一台服务器上同时运行 MySQL 或 PostgreSQL 服务器。如果您正在查看数十万个订单，您很可能希望 MySQL 或 PostgreSQL 在单独的服务器上运行。

如果您的程序员在 Oracle、Sybase 等方面具有开发专业知识，那么对这些进行投资可能是值得的。如果您有所有刚开始的编码人员，或者有使用 MySQL 或 PostgreSQL 的经验，那么显然这更有意义。

还要考虑是否有任何其他系统与应用程序接口。如果您要使用需要 Oracle 的订单履行系统，那么您可能需要 Oracle。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-24T21:56:28.947

PostgreSQL 和 MySql 都是不错的选择，特别是如果您可以在生产环境中使用它们。话虽如此，Derby（完整版，而不是 cf 附带的嵌入式版本）是针对企业的。我真的很想听听有人在有或没有 CF 的情况下突破了德比的一些限制。整个用 java 编写的东西非常吸引人，但似乎它可能存在性能问题，因为它不是用较低级别的语言编写的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-21T23:37:02.363

如果您使用 MySQL，请查看适用于您的开发环境的**MAMP**。它将在您的机器上安装 Apache、MySQL 和 PHP。然后，您可以轻松地将 Coldfusion 添加到顶部。我在我的 Macbook 上做到了这一点，它就像一个魅力。我猜你也可以在 PostgreSQL 中链接来工作。

**MAMP 网站**： http: [//www.mamp.info/](http://www.mamp.info/)

有关让 CF8 在 WAMP 上工作的非常有用的视频，请查看以下链接： http: [//flashalisious.com/2007/12/14/installing-coldfusion8-on-leopard-using-mamp/](http://flashalisious.com/2007/12/14/installing-coldfusion8-on-leopard-using-mamp/)

*（如果您使用 Windows，请单击以下链接：[http:](http://www.wampserver.com/)
//www.wampserver.com/ 仅供参考，我从未尝试在 WAMP 上安装 Coldfusion，但我相信它会起作用）*

# c++ - 简单的 C++ MIME 解析器

> ID：218089
> 
> 赞同：5
> 
> 时间：2008-10-20T11:23:19.427
> 
> 标签：c++, mime, parsing

我想消化从 PHP 脚本发回的 C++ 中的多部分响应。任何人都知道可以为我做到这一点的非常轻量级的 MIME 解析器吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-01T03:08:41.043

我知道这可能太少、太晚了，但我也有类似的需求。我想要一个 MIME 解析器，它只对 MIME 进行编码和解码。为了完整性和谷歌的能力，我认为我应该把我的发现放在这里。请记住，我对发送和接收邮件不感兴趣，只是对 MIME 进行编码和解码。以下是我为 C++ MIME 研究的库：

[http://www.vmime.org/](http://www.vmime.org) - 看起来太多了。包含pop、SMTP、tls、IMAP，可以去掉这个。Posix 和窗口。

[http://codesink.org/mimetic_mime_library.html](http://codesink.org/mimetic_mime_library.html) - 看起来很有希望。用于读取和创建消息的非常好的 api。和这个一起去了。不太重。必须“修复”两件事。首先对于多部分，代码只是检查字符串“multipart”并且没有识别“multipart/mixed”并且没有写出这些部分。其次，我不得不破解 mimeentity 编写代码。它只是写出 std::deque 字段，由于这些是字符串，它似乎是按字母顺序执行的。这是个问题，因为 MIME 版本必须是第一个写出的字段。所以我解决了这个问题。我还必须添加对 Content-Length 的支持。

[http://www.mozilla.org/mailnews/arch/libmime-description.html](http://www.mozilla.org/mailnews/arch/libmime-description.html) - 很难找到这个。不得不下载整个包。邮件新闻\mime\src

[http://www.example-code.com/vcpp/smime.asp](http://www.example-code.com/vcpp/smime.asp) - 没有考虑，因为它没有源代码并且是特定于 Windows 的。

[http://httpd.apache.org/docs/2.2/mod/mod_mime.html](http://httpd.apache.org/docs/2.2/mod/mod_mime.html) - 找不到这个 C 实现。

我选择 Mimetic 是为了满足我的需要，尽管我必须添加一些东西。我发现没有一个解析器能很好地处理可选字段（Content-Length 等）。我还需要它来支持多个平台（Windows、Linux 等）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-04T17:37:25.267

不要在这里自吹自擂，但[GMime](http://spruce.sourceforge.net/gmime)是一个非常完整的 MIME 解析器，用 C 编写，可以处理 Content-Length 标头。它还可以轻松处理 DOS 和 UNIX 行尾，处理损坏的标头字符集编码，不需要您将整个消息读入 RAM，支持 PGP/MIME 等。它还有一套非常全面的单元测试，我用于防止任何回归。

人们已经在 Windows 上构建它已经有一段时间了（在 cygwin 和/或 mingw32 afaik 下），但在过去一周左右，我一直在花时间通过设置 Visual C++ 项目/解决方案文件来使 Windows 成为一流的优先事项并确保一切都建立起来。

即使您已经找到了 MIME 解析器，我想我也会发布，这样如果上述解决方案不适合他们的需求，可能有类似问题的其他人可能会看到另一种选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-27T08:32:03.400

到目前为止，我一直在成功使用来自 cpp-netlib的[mime 代码。](https://github.com/cpp-netlib/cpp-netlib/blob/master/mime/example/basic_parsing.cpp)它对语法[有点挑剔](https://github.com/cpp-netlib/cpp-netlib/issues/332)，但效果很好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-04T13:16:42.677

使用正则表达式从 mime 多部分数据中更好地减少您需要的内容。并且不需要学习新的库。有简单的 php 解析器[https://github.com/breakermind/PhpMimeParser/blob/master/PhpMimeParser_class.php](https://github.com/breakermind/PhpMimeParser/blob/master/PhpMimeParser_class.php)但使用正则表达式，您可以非常简单地用 C++ 编写它。只有 357 行。

# c# - 如何避免文件阻塞

> ID：218096
> 
> 赞同：1
> 
> 时间：2008-10-20T11:25:45.083
> 
> 标签：c#, .net, multithreading, file-io

我们正在监视写入 XML 清单的自定义应用程序（其源不受我们控制）的进度。有时，应用程序由于无法写入 Manifest 文件而被卡住。尽管我们通过使用 File.Close 显式关闭文件句柄并在 Using Blocks 中创建文件变量来覆盖我们的跟踪。但不知何故，它一直在发生。（我们的应用程序是多线程的，最多三个线程可能正在访问该文件。）另一个有趣的事情是，他们的应用程序在三个不同的事件（添加项目、删除项目、完成项目）更新此清单，但我们只遇到一个事件（完成项目）。我的代码在这里列出

```
using (var st = new FileStream(MenifestPath, FileMode.Open, FileAccess.Read))
{
    using (TextReader r = new StreamReader(st))
    {
       var xml = r.ReadToEnd();
           r.Close();
           st.Close();
          //................ Rest of our operations
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T12:29:41.180

如果您只是从文件中读取，那么您应该能够传递一个标志来指定共享模式。我不知道你如何在 .NET 中指定它，但在 WinAPI 中你会传递`FILE_SHARE_READ | FILE_SHARE_WRITE`给`CreateFile()`.

我建议你检查你的文件 API 文档，看看它在哪里提到了共享模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T12:50:30.577

两件事情：

1.  `using`您应该在语句范围之外执行其余操作。这样，您就不会冒险使用封闭的流和阅读器。此外，您不必使用`Close`方法，因为当您退出`using`语句的范围时，`Dispose`会调用它，这是等效的。
2.  您应该使用具有`FileShare`枚举的重载。锁定本质上是偏执的，因此文件可能会自动锁定以保护您自己。:)

HTH。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T11:54:28.613

问题是不同的，因为该人对所有进程的文件访问具有完全控制权，而正如我所提到的，一个进程是没有源访问权限的第三方。我们的应用程序运行良好。但是，如果他们无法控制文件，他们的应用程序似乎会卡住。所以我愿意找到一种不会干扰他们运行的文件访问方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T21:12:44.977

如果一个线程试图从文件中读取而另一个线程正在写入，则可能会发生这种情况。要避免这种情况，您需要多个读取器，但一次只需要一个写入器，请使用 ReaderWriterLock 或在 .NET 2.0 中 System.Threading 命名空间中的 ReaderWriterLockSlim 类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T23:56:16.957

此外，如果您使用的是 .NET 2.0+，您可以将代码简化为：

```
string xmlText = File.ReadAllText(ManifestFile); 
```

另请参阅：[MSDN 上的 File.ReadAllText](http://msdn.microsoft.com/en-us/library/system.io.file.readalltext.aspx)。

# .net - ORM 对复合主键的支持

> ID：218100
> 
> 赞同：1
> 
> 时间：2008-10-20T11:28:28.590
> 
> 标签：.net, sql, orm, primary-key, compound-key

我读过复合主键会[混淆典型的 ORM 代码生成器](https://stackoverflow.com/questions/107404/what-are-the-down-sides-of-using-a-compositecompound-primary-key#108337)。哪些 ORM 最适合复合 PK，哪些应该避免？（我对 .NET 特别感兴趣）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-20T11:34:46.050

我用复合键成功地使用了 NHibernate。

```
<class name="UserProfileField" table="UserProfileFields">
    <composite-id>
        <key-many-to-one name="Parent" column="UserId" lazy="false"/>
        <key-property name="FieldName"/>
    </composite-id>
... 
```

# c# - C# 和 VB.NET 运算符优先级

> ID：218107
> 
> 赞同：1
> 
> 时间：2008-10-20T11:31:53.213
> 
> 标签：c#, vb.net

查看 C# 和 VB.NET 语言规范，我认为它表明逻辑 Xor/Or/And 操作在两种语言中具有不同的优先级。我读对了吗？我期待他们有同样的优先权。

例如在 C# 中

```
100 | 200 ^ 300 & 400 
```

是相同的...

```
100 | (200 ^ (300 & 400)) 
```

但等效的 VB.NET

```
100 Or 200 Xor 300 And 400 
```

据我所知是一样的...

```
(100 Or 200) Xor (300 And 400) 
```

我读对了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-20T11:37:35.043

就个人而言，我不喜欢记住优先规则。如果有*任何*歧义，我只是添加括号。即使我做对了，其他人可能必须阅读它，我不知道他们会有什么背景......

但我认为你没有看错。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-20T11:36:00.680

> 我读对了吗？

是的。就那么简单。

# java - 在 Java 中记录 PreparedStatements

> ID：218113
> 
> 赞同：15
> 
> 时间：2008-10-20T11:34:54.067
> 
> 标签：java, logging, jdbc, prepared-statement

一直很痛苦的一件事是当您拥有 PreparedStatement 而不是查询本身时记录 SQL (JDBC) 错误。

您总是会收到以下消息：

```
2008-10-20 09:19:48,114 ERROR LoggingQueueConsumer-52 [Logger.error:168] Error 
executing SQL: [INSERT INTO private_rooms_bans (room_id, name, user_id, msisdn, 
nickname) VALUES (?, ?, ?, ?, ?) ON DUPLICATE KEY UPDATE room_id = ?, name = ?, 
user_id = ?, msisdn = ?, nickname = ?] 
```

当然，我可以编写一个辅助方法来检索值并用实际值解析/替换问号（如果我没有得到这个问题的结果，可能会走这条路），但我只是想知道是否这个问题之前已经被其他人解决了，和/或是否有任何通用的日志记录助手可以自动为我解决这个问题。

**在几个答案后编辑：**

到目前为止提供的库似乎适合记录调试语句，这无疑是有用的。但是，我正在寻找一种方法来获取 PreparedStatement 本身（不是某个子类）并在发生错误时记录其 SQL 语句。我不想使用 PreparedStatement 的替代实现来部署生产应用程序。

我想我正在寻找实用程序类，而不是 PreparedStatement 专业化。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-08-12T14:49:16.613

我尝试[了 log4jdbc](http://code.google.com/p/log4jdbc/)，它为我完成了这项工作。

*安全注意事项：截至 2011 年 8 月的今天，log4jdbc 准备好的语句的记录结果不能安全执行。它们可用于分析，但绝不应反馈到 DBMS。*

**logjdbc 生成的日志示例**：****

 **> 2010/08/12 16:30:56 jdbc.sqlonly org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:105) 8\. INSERT INTO A_TABLE (ID_FILE,CODE1,ID_G,ID_SEQUENCE,REF,NAME,BAR ,DRINK_ID,AMOUNT,DESCRIPTION,STATUS,CODE2,REJECT_DESCR,ID_CUST_REJ) 值 (2,'123',1,'2','aa','awe',null,'0123',4317.95,'Rccc',' 0'，空，空，空）

该库非常易于设置：

* * *

我的**HSQLDB**配置：

```
jdbc.url=jdbc:log4jdbc:hsqldb:mem:sample 
```

使用**甲骨文**：

```
jdbc.url=jdbc:log4jdbc:oracle:thin:@mybdd:1521:smt
jdbc.driverClass=net.sf.log4jdbc.DriverSpy 
```

logback.xml：

```
<logger name="jdbc.sqlonly" level="DEBUG"/> 
```

太糟糕了，它不在 Maven 存储库中，但仍然有用。
根据我的尝试，如果你设置

你只会得到错误的语句，但是，我不知道这个库是否对性能有影响。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-19T17:01:35.593

这是非常依赖数据库的。例如，我知道一些 JDBC 驱动程序（例如 sybase，可能是 ms-sql）通过在服务器上创建一个临时存储过程，然后使用提供的参数调用该过程来处理准备好的语句。因此，完整的 SQL 从未真正从客户端传递。

因此，JDBC API 不会公开您需要的信息。您可能能够将您的语句对象转换为内部驱动程序实现，但可能不会 - 您的应用服务器可能会将语句包装在它自己的实现中。

我认为您可能只需要硬着头皮编写自己的类，将参数插入到占位符 SQL 中。这会很尴尬，因为您不能向 PreparedStatement 询问已设置的参数，因此在将它们传递给语句之前，您必须在帮助对象中记住它们。

在我看来，包装驱动程序实现对象的实用程序库之一是实现您想要实现的目标的最实用方法，但无论哪种方式都会令人不快。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-08-13T20:49:34.307

使用[P6Spy](https://github.com/p6spy/p6spy)：它对 Oracle、Mysql、JNDI、JMX、**Spring**和**Maven**友好。高度可配置。简单和低级集成 可以打印**堆栈跟踪**。只能打印**繁重的呼叫**- 基于时间阈值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-19T15:43:16.060

1.  如果您使用的是 MySQL，MySQL 连接器的 PreparedStatement.toString()[确实包含绑定参数](http://bugs.mysql.com/bug.php?id=5133)。尽管第三方连接池可能会破坏这一点。

2.  子类 PreparedStatement 用于在添加参数时构建查询字符串。无法从 PreparedStatement 中提取 SQL，因为它使用已编译的二进制形式。

[LoggedPreparedStatement](http://lsdis.cs.uga.edu/~vasquez/wstx/javadoc/edu/uga/cs/lsdis/meteors/wstx/dbms/LoggedPreparedStatement.html)看起来很有希望，尽管我还没有尝试过。

与记录所有查询的代理驱动程序相比，它们的一个优点是您可以在记录查询字符串之前对其进行修改。例如，在 PCI 环境中，您可能想要屏蔽卡号。

# c - 高速缓存如何工作？

> ID：218117
> 
> 赞同：9
> 
> 时间：2008-10-20T11:36:51.537
> 
> 标签：c, caching, optimization, computer-architecture

今天在上计算机组织课的时候，老师讲了一件我很感兴趣的事情。当谈到为什么缓存内存起作用时，他说：

```
for (i=0; i<M; i++)
   for(j=0; j<N; j++)
      X[i][j] = X[i][j] + K; //X is double(8 bytes) 
```

用第二行改变第一行是不好的。您对此有何看法？为什么会这样？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-20T14:22:41.247

Red Hat 的 Ulrich Drepper 和 glibc 的名气有一篇非常好的论文，[What Every Programmer Should Know About Memory](http://people.redhat.com/drepper/cpumemory.pdf)。一节非常详细地讨论了缓存。例如，在 SMP 系统中存在缓存效应，其中 CPU 最终可能会来回颠倒修改过的缓存行的所有权，从而极大地损害性能。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-20T11:44:09.493

参考地点。因为数据是按行存储的，所以对于每一行，j 列都在相邻的内存地址中。操作系统通常会将整个页面从内存加载到缓存中，并且相邻的地址引用可能会引用同一页面。如果您在内部循环中增加行索引，则这些行可能位于不同的页面上（因为它们被 j 分开）并且缓存可能必须不断地引入和丢弃内存页面，因为它引用数据。这称为抖动，对性能不利。

在实践中，对于更大的现代缓存，行/列的大小需要相当大才能发挥作用，但这仍然是一种很好的做法。

[编辑] 上面的答案是特定于 C 的，可能因其他语言而异。我知道唯一不同的是 FORTRAN。FORTRAN 以列主要顺序存储事物（上面是行主要），在 FORTRAN 中更改语句的顺序是正确的。如果您想要/需要效率，了解您的语言如何实现数据存储非常重要。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-20T11:40:12.560

之所以如此，是因为缓存就像局部性一样。访问的相同数量的内存，但间隔更远，将命中不同的缓存“行”，甚至可能完全错过缓存。因此，只要您有选择，最好组织数据，以便可能在时间上彼此接近的访问也在空间中进行。这增加了缓存命中的机会，并为您提供了更高的性能。

当然，有很多关于这个主题的信息可用，例如参见[这个关于参考位置的维基百科条目](http://en.wikipedia.org/wiki/Locality_of_reference)。或者，我猜，你自己的课程教科书。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-20T11:52:55.340

在 C 中，n 维矩阵是行主要的，这意味着矩阵的最后一个索引代表内存中的相邻空间。这与其他一些语言不同，例如 FORTRAN，它们是列专业的。在 FORTRAN 中，像这样遍历 2D 矩阵更有效：

```
do jj = 1,N
  do ii = 1,M
    x(ii,jj) = x(ii,jj) + K;
  enddo
enddo 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-20T12:42:11.060

高速缓存是非常快且非常昂贵的内存，靠近 CPU。CPU 不是每次从 RAM 中获取一小块数据，而是获取一大块数据并将其存储在缓存中。赌注是，如果您只读取一个字节，那么您读取的下一个字节很可能就在它之后。如果是这种情况，那么它可以来自缓存。

通过按原样布置循环，您可以按照它们存储在内存中的顺序读取字节。这意味着它们在缓存中，并且可以被 CPU 快速读取。如果您在第 1 行和第 2 行进行交换，那么您每次在循环中都会读取每“N”个字节。您正在读取的字节在内存中不再连续，因此它们可能不在缓存中。CPU 必须从（较慢的）RAM 中获取它们，因此您的性能会降低。

# xaml - Xaml 不是 WPF

> ID：218120
> 
> 赞同：4
> 
> 时间：2008-10-20T11:37:39.927
> 
> 标签：xaml, expression-blend

我有兴趣将 Xaml 与表达式混合一起用于在应用程序中创建用户界面。但是，由于目标架构的限制，我无法使用 WPF 或 C#。

因此，我感兴趣的是任何示例/现有项目或任何有此技术经验的人提出的关于将 Xaml 以“纯”形式作为与 WPF 无关的规范语言的使用经验。

具体问题：

1) 是否可以在没有 WPF 元素或没有 C# 支持类的情况下使用 Blend + Xaml？

2) Xaml 解析器等的其他实现是否使用不同的体系结构，它们是否可以与混合或类似工具一起使用。

3) 在这种情况下是否有替代的编辑器/设计器工具可以提供帮助？

我知道 MyXaml 和 MycroXaml 项目，并且在网上找到了很多关于 Xaml 的资源，但其中 99% 与 WPF 直接相关。这对于理解 Xaml 的概念很好，但对我需要的实现没有帮助。

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-21T21:30:34.753

Silverlight 是否对您有所帮助？现在有一个 Eclipse 插件可供您将 Silverlight 与 eclispe 一起使用。所以你将能够使用 Expression blend 来设计你的 UI 并使用 Java 进行后端编码（我认为未来的计划）。查看此链接了解更多详情。[http://www.eclipse4sl.org/](http://www.eclipse4sl.org/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-01T05:05:47.123

您是否检查过 XAML 规范。 [http://download.microsoft.com/download/0/A/6/0A6F7755-9AF5-448B-907D-13985ACCF53E/[MS-XAML].pdf](http://download.microsoft.com/download/0/A/6/0A6F7755-9AF5-448B-907D-13985ACCF53E/[MS-XAML].pdf)

如果您可以等待，XAML 2009 和 clr 4.0 中的 system.xaml.dll 可能会成为您的天赐之物。

这是关于它的 PDC 演示文稿。 [http://channel9.msdn.com/pdc2008/TL36/](http://channel9.msdn.com/pdc2008/TL36/)

现在既然你说你不能使用 C#，我猜你不能使用 .net 框架？或使用单声道。据我所知，没有计划在 Mono 中实现 XAML 支持。因此，要么您必须编写自己的 XAML 解析器和对象图。

当然，如果您愿意这样做，您可能需要等待 XAML 2009 规范，因为它对 xaml 语言进行了重大改进。

道格拉斯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-23T01:16:53.883

我使用基于 XAML 的 XML 文档作为新 AppMaker v3 的核心。我目前正在用 Ruby 解析它以生成各种输出，包括纯 XAML/C# WPF 应用程序。

XAML 非常容易解析，尤其是在您采用 XPath 方法时：

```
windows = []
REXML::XPath.each(doc, "//Window") do |xml|
  windows << Window.new(xml)
end

#... invoking ...

@items = []
xml.each_element("Canvas/*") do |itemXML|
  @items << WindowItem.makeItem(itemXML)
end 
```

我们需要更多信息的真正问题是您要生成什么样的 GUI。XAML 中的 Canvas 显式位置布局易于解析并生成一些简单的 Win32 控件和绘图。如果您进入像 StackPanel 这样的基于约束的布局，那么您将不得不重新创建许多 WPF 行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-14T23:16:04.247

如果您不使用 WPF，那么作为其核心的 Xaml 并不比 XML 好。Xaml 有几种风格，但它们本质上是库形式的附加功能。您可以使用 Vanilla Xaml 作为基础，但实际上您必须构建一个读取它的解析器，然后构建一个它本质上映射到的代码框架。Xaml 不知道 StackPanel 是什么，它本质上将文本数据发送出去，以便由任何知道它是什么的东西编译，这是您将缺少的部分，它是一个相当大的部分。

# asp.net-mvc - 使用 MVC 动态分配母版页

> ID：218122
> 
> 赞同：3
> 
> 时间：2008-10-20T11:37:52.313
> 
> 标签：asp.net-mvc

使用网络表单时，将母版页动态分配给页面的适当位置似乎是页面 PreInit 事件：

```
this.Master.MasterPageFile = "~/leaf.Master" 
```

如果需要，也可以在此处设置嵌套母版页层次结构中的母版页：

```
this.Master.MasterPageFile = "~/leaf.Master"
this.Master.Master.MasterPageFile = "~/root.Master" 
```

*使用 MVC 框架，您可以使用控制器 View 方法通过传递masterName*动态设置单个母版页名称，但是如何设置层次结构中更高的其他母版页？

**更新**
对不起，我不清楚。

层次结构是指嵌套母版页链，那么如何在嵌套母版页链中设置最顶层的母版页？

例如，我们有一个设置，不同的客户类型有不同的母版页，并且嵌套在该母版页中的是特定用户角色的附加母版页。我们需要动态设置根客户主控以及角色主控。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-20T13:07:32.680

您所说的“在层次结构中较高”的意思并不完全清楚，但如果您的意思是“在一个地方，而不是在我创建的每个控制器中”，我可以想到两个选项：

1.  创建一个抽象控制器超类型并从中继承您的具体控制器。

2.  [创建控制器工厂](http://weblogs.asp.net/fredriknormen/archive/2007/11/17/asp-net-mvc-framework-create-your-own-icontrollerfactory-and-use-spring-net.aspx)（子类 DefaultControllerFactory），并覆盖 CreateController 以设置自定义 MasterPage 属性。

如果选择后一种方案，则需要在 Global.asax 中这样做：

```
 ControllerBuilder.Current.SetControllerFactory(new MyControllerFactory()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T15:54:02.953

今天在 MVC 中没有这方面的功能。

# coding-style - 您被迫遵循的最奇怪的编码标准规则是什么？

> ID：218123
> 
> 赞同：173
> 
> 时间：2008-10-20T11:38:15.183
> 
> 标签：coding-style

当我问[这个问题](https://stackoverflow.com/questions/167575/should-a-project-manager-enforce-coding-standards)时，我几乎总是肯定的，你应该有编码标准。

你曾经被迫遵循的最奇怪的编码标准规则是什么？

最奇怪的意思是最有趣，最糟糕，或者只是很奇怪。

在每个答案中，请提及哪种语言，您的团队规模是多少，以及它对您和您的团队造成了哪些不良影响。

* * *

## 回答 #1

> 赞同：433
> 
> 时间：2008-10-20T11:43:35.547

当禁止使用多个返回时，我*讨厌它。*

* * *

## 回答 #2

> 赞同：333
> 
> 时间：2008-10-20T20:48:53.620

反向缩进。例如：

```
 for(int i = 0; i < 10; i++)
        {
myFunc();
        } 
```

和：

```
 if(something)
        {
// do A
        }
    else
        {
// do B
    } 
```

* * *

## 回答 #3

> 赞同：326
> 
> 时间：2008-10-20T11:41:46.160

也许不是你会得到的最古怪的一个，但**我真的很讨厌我必须在数据库表名前加上“tbl”**

* * *

## 回答 #4

> 赞同：248
> 
> 时间：2008-10-20T11:45:43.733

几乎任何一种匈牙利符号。

匈牙利符号的问题在于它经常被误解。最初的想法是给变量加上前缀，这样含义就很清楚了。例如：

```
int appCount = 0; // Number of apples.
int pearCount = 0; // Number of pears. 
```

但大多数人用它来确定类型。

```
int iAppleCount = 0; // Number of apples.
int iPearCount = 0;  // Number of pears. 
```

这很令人困惑，因为虽然这两个数字都是整数，但每个人都知道，你不能将苹果与梨进行比较。

* * *

## 回答 #5

> 赞同：240
> 
> 时间：2008-10-20T12:07:26.730

我目前工作的地方不允许使用三元运算符：

```
int value = (a < b) ? a : b; 
```

...因为不是每个人都“明白”。如果您告诉我，“不要使用它，因为当结构变得过于复杂时我们不得不重写它们”（嵌套三元运算符，有人吗？），那么我会理解的。但是当你告诉我一些开发人员不理解他们时……嗯……当然。

* * *

## 回答 #6

> 赞同：239
> 
> 时间：2008-10-20T14:53:39.050

进行更改时切勿删除任何代码。我们被告知要评论所有更改。请记住，我们使用源代码控制。这项政策并没有持续多久，因为开发人员对此以及它如何使代码不可读引起了轩然大波。

* * *

## 回答 #7

> 赞同：204
> 
> 时间：2008-10-20T21:58:03.530

我曾经在*强大的 VB King*的暴政下工作。

*VB King*是 MS Excel 和 VBA 以及数据库的纯粹大师（因此*他的姓氏：他使用 Excel，而开发人员使用编译器，并且在数据库方面挑战他可能会对您的职业生涯产生不利影响......*）。

当然，他*的高超*技能使他对开发问题和项目管理解决方案有*独特的*见解：虽然不完全是严格意义上的编码标准，但*VB King*经常对他尝试的“编码标准”和“最佳实践”有新的想法（以及经常成功）强加给我们。例如：

*   所有 C/C++ 数组都应从索引 1 开始，而不是 0。事实上，使用 0 作为数组的第一个索引已经过时，并且已被 Visual Basic 6 富有洞察力的数组索引管理所取代。

*   所有函数都应返回错误代码：VB6 中没有异常，那么我们为什么需要它们呢？（*即在 C++ 中*）

*   由于“所有函数都应返回错误代码”对于返回有意义类型的函数不实用，因此所有函数都应将错误代码作为第一个 [in/out] 参数。

*   我们所有的代码都会检查错误代码（*这导致了我职业生涯中见过的最糟糕的 VBScript if-indentation 情况......当然，由于从未处理过“else”子句，直到为时已晚才真正发现错误*）。

*   由于我们正在使用 C++/COM，因此从今天开始，我们将在 Visual Basic 中编写所有 DOM 实用程序函数。

*   ASP 115 错误是邪恶的。出于这个原因，我们将在我们的 VBScript/ASP 代码中使用 On Error Resume Next 来避免它们。

*   XSL-T 是一种面向对象的语言。使用继承来解决您的问题（*这一天愚蠢的惊喜差点让我大开眼界*）。

*   不使用异常，因此应该删除。出于这个原因，我们将取消选中在异常展开时要求调用析构函数的复选框（*专家花了几天时间才找到所有这些内存泄漏的原因，当他发现他们自愿忽略时他几乎发疯了（并且隐藏）他关于再次检查选项的技术说明，在几周前发送*）。

*   捕获我们 COM 模块的 COM 接口中的所有异常，并静默处理它们（*这样，模块不会崩溃，只会显得更快......闪亮！......因为我们使用了上面描述的 über 错误处理，我们甚至花了一些时间来了解真正发生的事情......你不能同时拥有速度和正确的结果，对吗？*）。

*   从今天开始，我们的代码库将分为四个分支。我们将管理它们的同步并手动集成所有错误更正/演变。

尽管我们提出了抗议，但除了*C/C++ 数组*、*VB DOM 实用函数*和*作为 OOP 语言的 XSL-T之外的所有东西都被实现了。*当然，随着时间的推移，有些人被发现了，*咳咳*，坏了，完全被抛弃了。

当然，*VB King*的公信力从来没有因此而受到影响：在高层管理人员中，他仍然是“顶级枪手”的技术专家……

这产生了一些有趣的副作用，您可以通过以下链接看到~~[您曾经遇到过的源代码中最好的注释是什么？](https://stackoverflow.com/questions/184618/what-is-the-best-comment-in-source-code-you-have-ever-encountered/216744#216744)~~

* * *

## 回答 #8

> 赞同：131
> 
> 时间：2008-10-20T11:50:53.083

早在 80 年代/90 年代，我曾在一家使用 FORTRAN 的飞机模拟器公司工作。我们的 FORTRAN 编译器的变量名限制为 8 个字符。该公司的编码标准将前三个保留用于匈牙利符号样式信息。所以我们必须尝试用 5 个字符创建有意义的变量名！

* * *

## 回答 #9

> 赞同：107
> 
> 时间：2008-10-20T12:34:34.320

我在一家两家公司合并的地方工作。“占主导地位”的服务器有一个用 K&R C（即 pre-ANSI）编写的主要服务器。他们强迫 Java 团队（来自两个办公室——总共可能有 20 名开发人员）使用这种格式，这种格式兴高采烈地忽略了“支撑辩论”的两个支柱并直接发疯：

```
if ( x == y ) 
    {
    System.out.println("this is painful");
    x = 0;
    y++;
    } 
```

* * *

## 回答 #10

> 赞同：104
> 
> 时间：2008-10-20T20:52:56.453

禁止：

```
while (true) { 
```

允许：

```
for (;;) { 
```

* * *

## 回答 #11

> 赞同：101
> 
> 时间：2008-11-16T05:49:13.753

我的一个朋友——我们称他为 CodeMonkey——他在大学毕业后的第一份工作 [*多年前*] 在 COBOL 进行内部开发。他的第一个程序因“不符合我们的标准”而被拒绝，因为它使用了……[颤抖！]嵌套的 IF 语句

**编码标准禁止使用嵌套的 IF 语句**

现在，CodeMonkey 并不害羞，并且确信自己的能力，所以他坚持询问链上和过道上的每个人，为什么会有这条规则。大多数人声称他们不知道，有些人编造了关于“可读性”的东西，最后一个人记住了最初的原因：他们使用的第一个版本的 COBOL 编译器有一个错误，并且没有正确处理嵌套的 IF 语句。

当然，这个编译器错误已经修复了至少十年，但*没有人挑战标准*。[呸！]

CodeMonkey 成功地改变了标准——最终！

* * *

## 回答 #12

> 赞同：97
> 
> 时间：2008-10-20T12:02:58.533

曾经在一个禁止下划线的项目上工作。我的意思是完全禁止。因此，在 ac# winforms 应用程序中，每当我们添加新的事件处理程序（例如按钮）时，我们都必须将默认方法名称从 buttonName_Click() 重命名为其他名称，以满足编写代码的人的自尊心标准。直到今天我都不知道他对卑微的下划线有什么看法

* * *

## 回答 #13

> 赞同：92
> 
> 时间：2008-10-20T16:52:00.213

完全无用的数据库命名约定。每个表名都必须以数字开头。数字显示表中的数据类型。

*   0：无处不在的数据
*   1：仅由某个模块使用的数据
*   2：查找表
*   3：日历、聊天和邮件
*   4：记录

如果您只知道其名称的第一个字母，则很难找到一个表。此外 - 因为这是一个 mssql 数据库 - 我们必须在任何地方用方括号括起表名。

```
-- doesn't work
select * from 0examples;

-- does work
select * from [0examples]; 
```

* * *

## 回答 #14

> 赞同：90
> 
> 时间：2008-10-20T23:24:34.977

我们正在做一个 C++ 项目，团队负责人是一个 Pascal 人。

所以我们有一个编码标准包含文件来重新定义所有讨厌的 C 和 C++ 语法：

```
#define BEGIN {
#define END } 
```

但等等还有更多！

```
#define ENDIF }
#define CASE switch 
```

等等。经过这么长时间，很难记住。

这采用了完全可读的 C++ 代码，并使其对除团队负责人之外的任何人都难以辨认。

我们还必须使用反向匈牙利符号，即

```
MyClass *class_pt  // pt = pointer to type

UINT32 maxHops_u   // u = uint32 
```

虽然奇怪的是我越来越喜欢这个。

* * *

## 回答 #15

> 赞同：88
> 
> 时间：2008-10-20T15:35:52.223

在以前的工作中：

*   “普通”表以 T_ 开头
*   “系统”表（通常是查找）以 TS_ 开头（除非他们不这样做，因为那天有人不喜欢它）
*   交叉引用表以 TSX_ 开头
*   所有字段名称都以 F_ 开头

是的，这是正确的。每个表中的所有字段。这样我们就可以知道它是一个字段。

* * *

## 回答 #16

> 赞同：84
> 
> 时间：2008-10-20T13:01:50.787

我的一个朋友在政府工作时遇到了这个规则。++（前或后）的使用被完全禁止。原因：不同的编译器可能会以不同的方式解释它。

* * *

## 回答 #17

> 赞同：81
> 
> 时间：2008-10-20T17:06:23.367

一半的团队支持四格缩进；另一半倾向于两格缩进。

您可以猜到，编码标准规定了三个，以便“平等地冒犯所有人”（直接引用）。

* * *

## 回答 #18

> 赞同：74
> 
> 时间：2008-10-20T11:49:58.513

由于经理声称它涉及太多“魔法”，因此无法使用反射。

* * *

## 回答 #19

> 赞同：71
> 
> 时间：2008-10-22T08:48:11.657

我遇到的最奇怪的一次，也是我花了很长时间才推翻的一次，是我们公司的老板要求我们的新产品只能是 IE。如果它可以在 FireFox 上运行，那没关系，但它只能是 IE。

这听起来可能不太奇怪，除了一个小缺陷。所有软件都用于定制的服务器软件包，在 Linux 上运行，我们客户购买的所有客户端都是 Linux。没有试图弄清楚如何让 Wine（在那些日子里，非常不可靠）在所有这些机器上启动并运行，看看我们是否可以让 IE 运行并培训他们的管理员如何调试 Wine 问题，这根本是不可能的以满足业主的要求。问题是他正在做网页设计，根本不知道如何使网站与 FireFox 兼容。

知道我们公司破产了，你可能不会感到震惊。

* * *

## 回答 #20

> 赞同：54
> 
> 时间：2008-10-21T11:24:17.787

## 使用通用编号标识符名称

在我目前的工作中，我们有两条非常重要的规则：

**规则 1：**每次我们在数据库表中创建一个新字段时，我们都必须添加额外的保留字段以供将来使用。这些保留字段被编号（因为没有人知道他们有一天会保存哪些数据）下次我们需要一个新字段时，我们首先寻找一个未使用的保留字段。

所以我们最终`customer.reserve_field_14`包含了客户的电子邮件地址。

有一天，我们的老板考虑引入*保留桌*，但幸运的是我们可以说服他不要这样做。

**规则 2：**我们的一个产品是用 VB6 编写的，而 VB6 对不同标识符名称的总数有一个限制，由于代码非常大，我们经常遇到这个限制。作为“解决方案”，所有局部变量名称都被编号：

*   `Lvarlong1`
*   `Lvarlong2`
*   `Lvarstr1`
*   ...

尽管这有效地规避了标识符限制，但这两个规则结合在一起会产生如下漂亮的代码：

> ```
> ...
> 
> If Lvarbool1 Then
>   Lvarbool2 = True
> End If
> 
> If Lvarbool2 Or Lvarstr1 <> Lvarstr5 Then
>   db.Execute("DELETE FROM customer WHERE " _ 
>       & "reserve_field_12 = '" & Lvarstr1 & "'")
> End If
> 
> ... 
> ```

您可以想象修复旧代码或其他人的代码是多么困难......

**最新更新：**现在我们也对私人会员使用“保留程序”：

```
Private Sub LSub1(Lvarlong1 As Long, Lvarstr1 As String)
  If Lvarlong1 >= 0 Then 
    Lvarbool1 = LFunc1(Lvarstr1)
  Else
    Lvarbool1 = LFunc6()
  End If
  If Lvarbool1 Then
    LSub4 Lvarstr1
  End If
End Sub 
```

**编辑：**似乎这种代码模式变得越来越流行。请参阅此[每日 WTF](http://thedailywtf.com/)帖子以了解更多信息：**[散光](http://thedailywtf.com/Articles/Astigmatism.aspx)**:)

* * *

## 回答 #21

> 赞同：53
> 
> 时间：2008-10-20T21:12:30.237

回到我的 C++ 时代，我们不允许使用 ==、>=、<=、&& 等。有用于此的宏...

```
if (bob EQ 7 AND alice LEQ 10)
{
   // blah
} 
```

这显然是为了处理“条件错误中的旧意外赋值”，但是我们*也*有“将常量放在变量之前”的规则，所以

```
if (NULL EQ ptr); //ok
if (ptr EQ NULL); //not ok 
```

刚刚记得，我听过的最简单的编码标准是“编写代码，就好像下一个维护者是一个知道你住在哪里的恶性精神病患者一样”。

* * *

## 回答 #22

> 赞同：45
> 
> 时间：2008-10-20T11:46:02.767

匈牙利符号一般。

* * *

## 回答 #23

> 赞同：43
> 
> 时间：2008-10-20T15:29:30.443

我有很多*愚蠢*的规则，但我认为完全奇怪的并不多。

最愚蠢的是我在 90 年代初工作的 NASA 工作。这是一项艰巨的工作，有超过 100 名开发人员参与其中。编写编码标准的经验丰富的开发人员决定每个源文件都应该以四个字母的首字母缩写词开头，第一个字母必须代表负责该文件的组。对于他们习惯的旧 FORTRAN 77 项目来说，这可能是一个好主意。

然而，这是一个**Ada**项目，有一个很好的层次库结构，所以它根本没有意义。每个目录都充满了以相同字母开头的文件，然后是另外 3 个无意义的字母，一个下划线，然后是重要的文件名的一部分。所有的 Ada 包都必须以同样的五个字符疣开头。也不允许使用 Ada“使用”子句（在正常情况下可以说是一件好事），因此这意味着对非该源文件本地的任何标识符的任何引用*也*必须包含这个无用的疣。可能应该对此进行反抗，但整个项目的工作人员都是初级程序员和刚从大学招聘的新员工（我自己就是后者）。

一个典型的赋值语句（在 Ada 中已经很冗长）最终看起来像这样：

```
NABC_The_Package_Name.X := NABC_The_Package_Name.X + 
  CXYZ_Some_Other_Package_Name.Delta_X; 
```

幸运的是，他们至少足够开明，可以让我们超过 80 列！尽管如此，设施疣还是被讨厌到了，以至于它成为每个人源文件顶部的样板代码，以使用 Ada “重命名”来摆脱疣。每个导入的（“withed”）包都会有一个重命名。像这样：

```
package Package_Name renames NABC_Package_Name;
package Some_Other_Package_Name renames CXYZ_Some_Other_Package_Name;
--// Repeated in this vein for an average of 10 lines or so 
```

我们当中更有创意的做法是尝试*使用*疣来制作一个非常明智（或愚蠢）的包名称。（我知道你在想什么，但不允许说脏话，这让你感到羞耻！太恶心了）。例如，我在通用代码组**中**，我需要制作一个包来与**Workstation**组进行交互。在与 Workstation 人员进行头脑风暴后，我们决定为我们的包命名，以便需要两者的人必须写：

```
with CANT_Interface_Package;
with WONT_Interface_Package; 
```

* * *

## 回答 #24

> 赞同：41
> 
> 时间：2009-10-21T14:40:32.403

当我开始在一个地方工作，并开始将我的代码输入源代码控制时，我的老板突然来找我，让我停止提交这么多的代码。他告诉我，不鼓励开发人员每天进行 1 次以上的提交，因为它会乱扔源代码控制。我只是对他目瞪口呆……

后来我明白了，他甚至来找我的原因是因为 SVN 服务器会为他（以及另外 10 名高级管理人员）发送一封邮件，用于某人的每一次提交。通过乱扔源代码控制，我猜他更换了他的邮箱。

* * *

## 回答 #25

> 赞同：34
> 
> 时间：2008-10-20T12:18:09.267

通过 Sql Server 2000 中的存储过程执行所有数据库查询。从复杂的多表查询到简单的查询，例如：

`select id, name from people`

支持程序的论据是：

*   表现
*   安全
*   可维护性

我知道程序主题很有争议，所以请随意给我的答案打负分；）

* * *

## 回答 #26

> 赞同：33
> 
> 时间：2008-10-20T13:01:09.540

每 1000 行代码必须有 165 个单元测试（不一定是自动化的）。大约每 8 行测试一次即可。

不用说，有些代码行很长，函数返回*this*指针以允许链接。

* * *

## 回答 #27

> 赞同：30
> 
> 时间：2008-10-21T02:47:59.060

我们必须按字母顺序对类中的所有函数进行排序，以使它们“更容易找到”。没关系ide有一个下拉菜单。那是太多的点击。

（同一位技术主管编写了一个应用程序来删除我们源代码中的所有评论）。

* * *

## 回答 #28

> 赞同：29
> 
> 时间：2009-03-16T02:06:20.143

1987 年左右，我在一家雇用我的公司找到了一份工作，因为我是少数知道如何使用 Revelation 的人之一。Revelation，如果你从未听说过，它本质上是 Pick 操作系统的基于 PC 的实现——如果你从未听说过，它的名字来自它的发明者，名字叫 Dick Pick。关于 Pick OS 可以说很多，其中大部分都很好。许多超小型供应商（至少是 Prime 和 MIPS）使用 Pick 或他们自己的自定义实现。

这家公司是一家 Prime 商店，他们在内部系统中使用了 Information。（不，这确实是它的名字：它是 Prime 对 Pick 的实施。）他们与国家签订了构建基于 PC 的系统的合同，并且在那个人完成所有工作之前，他们已经在他们的 Revelation 项目中投入了大约一年的时间，他也是他们的 MIS 主管，他决定不能再同时做这两项工作并雇用了我。

无论如何，他已经为他们基于 Prime 的软件建立了许多编码标准，其中许多源自两个基本条件：1）使用 80 列的哑终端，以及 2）自从 Prime 没有“没有可视化编辑器，他自己写的。由于 Pick 代码的神奇可移植性，他将他的编辑器引入了 Revelation，并使用它在 PC 上构建了整个项目。

当然，Revelation 是基于 PC 的，有一个非常好的全屏编辑器，当你超过第 80 栏时并没有反对。然而，在我在那里的头几个月里，他坚持让我使用他的编辑器，并且他的标准。

因此，第一个标准是必须对每一行代码进行注释。每一行。没有例外。他这样做的理由是，即使您的评论准确地说明了您刚刚在代码中编写的内容，但必须发表评论意味着您至少考虑了该行两次。此外，正如他兴高采烈地指出的那样，他在编辑器中添加了一个命令，用于格式化每一行代码，以便您可以添加行尾注释。

哦是的。当您注释每一行代码时，它是带有*行尾*注释的。简而言之，每行的前 64 个字符是代码，然后是一个分号，然后你有 15 个字符来描述你的 64 个字符的作用。简而言之，我们使用汇编语言约定来格式化我们的 Pick/Basic 代码。这导致了看起来像这样的事情：

```
EVENT.LIST[DATE.INDEX][-1] = _         ;ADD THE MOST RECENT EVENT
   EVENTS[LEN(EVENTS)]                 ;TO THE END OF EVENT LIST 
```

（实际上，20 年后我终于忘记了 R/Basic 的续行语法，所以看起来可能有所不同。但你明白了。）

此外，每当您必须插入多行注释时，规则是您使用花盒：

```
************************************************************************
**  IN CASE YOU NEVER HEARD OF ONE, OR COULDN'T GUESS FROM ITS NAME,  **
**  THIS IS A FLOWER BOX.                                             **
************************************************************************ 
```

是的，每行上的那些结束星号是必需的。毕竟，如果你使用他的编辑器，插入花盒只是一个简单的编辑器命令。

让他放松，让我使用 Revelation 的内置编辑器是一场战斗。起初他很坚持，只是因为那是规则。当我反对 a) 我已经知道 Revelation 编辑器 b) 它比他的编辑器更实用，c) 其他 Revelation 开发人员会有相同的观点时，他反驳说，如果我不训练他的编辑器，我就不会永远能够在 Prime 代码库上工作，正如我们都知道的那样，只要地狱仍未解冻，这种情况就不会发生。最后他屈服了。

但编码标准是最后一个。尤其是花盒评论是一种愚蠢的浪费时间，他与​​我争执不下，说如果我只使用合适的编辑器，维护它们会非常容易。（整个事情变得相当被动-攻击性。）最后我悄悄地让步了，从那时起，我带到代码审查的所有代码都有他宝贵的花盒评论。

工作几个月后的一天，当我几乎证明自己胜任能力强时（尤其是与我在那里工作时经过那间办公室的其他程序员的非凡游行相比），他正看着我的肩膀，当我工作，他注意到我没有使用花盒评论。哦，我说过，我写了一个源代码格式化程序，当我打印出来时，它会将我的评论转换成你的风格。这比在编辑器中维护它们更容易。他张了张嘴，想了想，又闭上了，走开了，我们再也没有谈论过编码标准。在那之后，我们的两个工作都变得轻松了。

* * *

## 回答 #29

> 赞同：26
> 
> 时间：2009-02-27T21:55:51.210

在我的第一份工作中，所有的 C 程序，无论多么简单或复杂，都只有四个函数。你有 main，它依次调用其他三个函数。我不记得它们的名字了，但它们是类似于 begin()、middle() 和 end() 的东西。begin() 打开文件和数据库连接，end() 关闭它们，middle() 完成*其他所有*操作。不用说，middle() 是一个*很*长的函数。

为了让事情变得更好，所有变量都必须是全局的。

我对那份工作最自豪的回忆之一就是参与了导致这些标准遭到破坏的普遍反抗。

* * *

## 回答 #30

> 赞同：26
> 
> 时间：2009-08-31T14:49:54.837

一个外部编写的 C 编码标准，其规则是“不要依赖内置的运算符优先级，始终使用括号”

很公平，明显的意图是禁止：

```
a = 3 + 6 * 2; 
```

赞成：

```
a = 3 + (6 * 2); 
```

问题是，这是由遵循 C 语法规则的工具强制执行的，即 '='、'=='、'.' 和数组访问是运算符。所以代码如下：

```
a[i].x += b[i].y + d - 7; 
```

必须写成：

```
((a[i]).x) += (((b[i]).y + d) - 7); 
```

* * *

## 回答 #31

> 赞同：25
> 
> 时间：2008-10-20T13:26:25.450

我最奇怪的是几年前的合同。@ZombieSheep 的怪异是其中的一部分，但不是该公司中最怪异的。

不，那家公司最奇怪的是数据库命名方案。每张表都用大写字母命名，单词之间有下划线。每个表都有一个前缀（通常为 1 - 6 个字符），通常是主表名称的首字母缩写词或缩写。表的每个字段也都带有相同的前缀。所以，假设你有一个简单的模式，人们可以拥有猫或狗。它看起来像这样：

```
PER_PERSON
    PER_ID
    PER_NameFirst
    PER_NameLast
    ...
CAT_CAT
    CAT_ID
    CAT_Name
    CAT_Breed
    ...
DOG_DOG
    DOG_ID
    DOG_Name
    DOG_Breed
    ...
PERCD_PERSON_CAT_DOG (for the join data)
    PERCD_ID
    PERCD_PER_ID
    PERCD_CAT_ID
    PERCD_DOG_ID 
```

也就是说，就像最初感觉一样奇怪......它在我身上成长。它背后的原因是有道理的（在你把你的大脑包裹起来之后），因为在构建连接时，前缀是为了提醒“推荐”（和强制！）表别名。前缀使大多数连接查询更容易编写，因为您很少需要在字段之前显式引用表。

哎呀，过了一会儿，我们团队中的所有人（我们项目中的 6 人）都能够开始在对话中通过前缀来引用表格。可以肯定的是，一种后天习得的味道……但一种在我身上成长的味道。如此之多，以至于当我有这种自由时，我仍然使用它。

* * *

## 回答 #32

> 赞同：25
> 
> 时间：2008-10-23T02:10:11.227

使用 dbo_ 为表添加前缀

是的，就像在 dbo.dbo_tablename 中一样。

* * *

## 回答 #33

> 赞同：22
> 
> 时间：2008-10-20T15:43:12.380

2002 - 2004 年在一家 VB6 商店里有几个 WTF（我不骄傲，我饿了，需要吃饭）。

最烦人的恕我直言，在子/函数的末尾将所有对象引用设置为空。这是为了“帮助”编译器引用计数。不管我为 TA 做了多少测试来证明它是没有必要的，哦不，它仍然必须做，*即使他完全没有证据支持他*。最终我放弃了，大约一年后发现了一篇解释为什么是裤子的文章。我把这个带给 TA，想着“知道了！”。他说：“是的，我已经知道很多年了，但是如果你开始改变标准的羊”，意思是其他开发人员，他每天一起工作的人“会搞砸”。采空区。

其他人在同一家店。

*   永远不要删除代码，总是注释掉它（即使我们使用了源代码控制）。
*   当我到达那里时，表名上的前缀毫无意义，但必须在新表上强制执行。
*   使用 o_ 为所有对象添加前缀（lo_ 用于过程级引用，mo_ 用于模块，go_ 用于全局）。在所有其他变量都是对象引用的项目中，这完全没有意义。

主要是我在那里写c++（只有c++开发人员，所以制定了自己的标准，并严格执行！）偶尔使用vb，否则我不会坚持下去。

* * *

## 回答 #34

> 赞同：20
> 
> 时间：2008-10-20T16:21:29.683

每个开始和结束大括号都*需要*有注释：

```
公共无效HelloWorld（字符串名称）
{

  如果（名称 == “乔”）
  {
    Console.WriteLine("嘿，乔！");
  } //if(name == "乔")
  别的
  {
    Console.WriteLine("你好，" + 姓名);
  } //if(name == "乔")
} //public void HelloWorld(字符串名称)

```

这就是促使我编写我的第一个 Visual Studio 插件来实现自动化的原因。

* * *

## 回答 #35

> 赞同：14
> 
> 时间：2009-06-04T23:38:07.377

哇——这让我想起了我工作过的一个地方：亚利桑那州交通部。

那里有一个项目经理不了解基于对象的编程（并且不想了解它）。 **她坚信基于对象的编程是一种时尚，并拒绝让任何人签入使用任何类型的基于对象的编程的代码。**

（说真的——她实际上花了很多时间来审查我们签入到 Visual SourceSafe 的代码，以确保我们没有违反规则）。

考虑到 Visual Basic 4 刚刚发布（大约是 12 年前），并且考虑到我们在 VB4 中构建的 Windows 窗体应用程序*使用对象来描述窗体*，这使得开发......变得复杂。

我的一个朋友实际上试图通过将他的“目标代码”封装在虚拟“表单”中来解决这个问题，她最终发现他只是（**喘气**）隐藏他的对象！

不用说，我在那里只呆了大约 3 个月。

天哪，我不喜欢那个女人的想法。

* * *

## 回答 #36

> 赞同：13
> 
> 时间：2008-10-20T13:36:08.550

让我抓狂的是人们在表的 ID 字段后面加上表的名称。只有身份证有什么问题？无论如何，您将不得不给它起别名……为了对所有神圣事物的爱！

想象一下，当您拥有名为 IDSEWEBLASTCUSTOMERACTION 和 IDSEEVENTLOGGER 的 id 字段时，您的 SQL 语句会是什么样子。

* * *

## 回答 #37

> 赞同：12
> 
> 时间：2008-10-20T12:01:33.810

您只能使用五个字母的表名，最后两个字符保留给`IO`.

* * *

## 回答 #38

> 赞同：11
> 
> 时间：2008-10-20T11:50:45.983

我看到的最奇怪的是数据库表命名，其中表以功能区域的 TLA 开头，例如会计 ACC，然后是 3 位数字（覆盖默认排序），然后是表名。

另外，这也扩展到列名。

ACC100_AccountCode

阅读查询是一场噩梦，它们是如此难以理解。

* * *

## 回答 #39

> 赞同：11
> 
> 时间：2008-10-20T12:08:07.463

将 s_ 应用于对于作为控制系统一部分的软件而言被视为“安全关键”的变量和方法。再加上另一条关于将 m_ 放在成员变量前面的规则，你会得到像“s_m_blah()”这样可笑的东西，在我看来，这写起来很烦人，而且可读性也不好。最后，一些“安全专家”应该通过查看代码并通过使用那些“s_”从中确定一些东西来获得洞察力——实际上，他们不太了解 c++，所以除了报告我们标记为“安全关键”的标识符的数量。胡说八道...

* * *

## 回答 #40

> 赞同：11
> 
> 时间：2008-10-21T02:18:31.100

团队规模大约有十几个。对于 C# 方法，我们必须在每个函数之前放置一个巨大的 XML 格式函数。我不记得确切的格式，但它涉及嵌套大约三到五层深度的 XML 标记。这是评论记忆中的草图。

```
/// <comment>
/// </comment>
/// <table>
///    <thead>
///       <tcolumns>
///          <column>Date</column>
///          <column>Modified By</column>
///          <column>Comment</column>
///       </tcolumns>
///    </thead>
///    <rows>
///       <row>
///          <column>10/10/2006</column>
///          <column>Fred</column>
///          <column>Created function</column>
///       </row>
///    </rows>
/// <parameters> 
```

我必须停在那里......

缺点很多。

*   文件主要由评论组成。
*   我们没有使用我们的版本控制系统来跟踪文件的更改。
*   编写许多小函数会损害可读性。
*   大量滚动。
*   有些人没有更新评论。

我使用代码片段（Emacs YAS）将此代码添加到我的方法中。

* * *

## 回答 #41

> 赞同：11
> 
> 时间：2009-02-13T14:53:48.150

（可能只在英国有趣）

我工作的一家保险公司希望在所有财产上使用“P”或“L”的组合来表示范围，并用匈牙利语表示类型。

优点是我们有一个名为 pintMaster 的属性！让我们都想喝一杯。

* * *

## 回答 #42

> 赞同：10
> 
> 时间：2008-10-20T11:58:34.613

这是我自己没有遵循的编码标准（在其他事情上遇到了麻烦，但从来没有）。我们有三个 19" 显示器，所以我们可以让两个编辑器全屏打开，并且仍然可以访问桌面。其他人都没有使用评论，而是使用有意义的名称。非常长的有意义的名称。我记得最长的是 80字符范围，平均在40~50左右。

你猜怎么着，他们没有准确地描述整个事情。

* * *

## 回答 #43

> 赞同：10
> 
> 时间：2008-10-20T12:26:29.017

如果我没记错的话，delphi IDE 做了两个空格的默认缩进。公司的大部分遗留代码都有三个空格，由 IT 副总裁和 CEO 编写。有一天，所有的程序员都在谈论我们应该做些什么来让我们的生活更轻松，一位非常了解 Delphi 的承包商说：“嘿，ide 默认为两个空格，是否有人对我们为新代码执行此操作有问题？ ？” 我们所有人都面面相觑，几乎认为这是理所当然的，并说我们同意了。

两天后，副总裁兼 CEO 发现我们将做出如此危险的更改，可能会“导致问题”，并指示我们将对所有内容使用三个缩进，直到他们两人能够准确评估此类更改的影响. 现在我完全支持遵循标准，但是这些人认为 oo 编程正在创建一个具有一个函数的对象，该函数具有执行操作所需的**所有**逻辑，并且源代码控制正在将代码文件移动到不同的目录.

* * *

## 回答 #44

> 赞同：10
> 
> 时间：2008-12-16T14:21:10.697

不完全是一个编码标准，但在 1998 年，我在一家禁止 C++ 的公司工作，支持 C。这是因为 OO 被认为过于复杂，软件工程师无法掌握。

在我们的 C 代码中，我们需要在所有分号前面加上一个空格

```
int someInt = 5 ; 
```

我永远找不到原因，但过了一段时间它确实在我身上长大。

* * *

## 回答 #45

> 赞同：9
> 
> 时间：2008-10-21T02:08:16.550

没有人提到的是被迫为无脑的 getter 和 setter 类编写单元测试。

* * *

## 回答 #46

> 赞同：9
> 
> 时间：2009-04-19T22:39:44.433

在 Java 中，当在某个应保持无名的地方签约时，*接口*被禁止。逻辑？负责人找不到用 Eclipse 实现的类...

也被禁止 - 匿名内部类，理由是负责人不知道它们是什么。这使得实现一个 Swing GUI 变得很有趣。

* * *

## 回答 #47

> 赞同：8
> 
> 时间：2008-10-20T13:33:06.153

吸引我的那个类似于另一张海报的 SQL 表名的“tbl”前缀。

在这种情况下，所有存储过程的前缀都是“sp_”，尽管“sp_”是 Microsoft 用于 SQL Server 中系统级存储过程的前缀。好吧，他们的标准来自旧的非 MS 数据库，并且不会因为他们的标准可能导致存储过程与系统存储过程发生冲突并产生不可预测的结果而改变。不，那是不合适的。

* * *

## 回答 #48

> 赞同：8
> 
> 时间：2008-10-20T17:27:56.040

有人告诉我旧代码应该被注释掉而不是被删除；如果我们需要参考旧代码（是的，代码在源代码管理中......）。在进行重大更改之前，这似乎并没有那么糟糕。然后它变成了一场噩梦，整个代码都被删除了。

* * *

## 回答 #49

> 赞同：8
> 
> 时间：2008-10-21T03:20:40.477

我曾经不得不拼出所有的首字母缩写词，甚至是行业标准的缩写词，例如 OpenGL。glu 之类的变量名不好用，但我们不得不使用 graphicsLibraryUtility。

* * *

## 回答 #50

> 赞同：8
> 
> 时间：2010-01-19T14:25:30.407

我曾经参与过一个 VB.NET 项目，其中每个方法主体都包装在以下`Try...Catch`块中：

```
Public Sub MyMethod()
    Try
        ' Whatever
    Catch Ex As Exception
        Throw New Exception("MyClass::MyMethod::" + Ex.ToString())
    End Try
End Sub 
```

那些不理解`Exception.StackTrace`的人注定要重新发明它，非常糟糕。

* * *

## 回答 #51

> 赞同：8
> 
> 时间：2010-02-01T21:09:54.637

一旦我不得不从我的团队中做一个小 DLL，当它完成后，我不得不重做这项工作，因为我不应该在代码中使用“else”。当我问为什么我被指示不要问为什么时，但另一个团队的领导只是“没有得到其他东西”。

* * *

## 回答 #52

> 赞同：8
> 
> 时间：2010-10-12T16:20:55.793

在 Java 中，我目前不鼓励在测试中使用布尔函数作为谓词：

```
    如果（列表.isEmpty（））...

```

必须重写

```
    如果（list.isEmpty（）==真）...

```

和

```
    如果（！list.isEmpty（））...

```

必须重写

```
    如果（list.isEmpty（）==假）...

```

因为“这样更清楚”。

对我来说，“list.isEmpty() == true”有两个动词，“is”和“equals”，在一个短语中没有连接词。我不能让它感觉对。

* * *

## 回答 #53

> 赞同：7
> 
> 时间：2008-10-20T12:40:47.850

我在一个编码标准是一个巨大的 WTF 的地方工作：奇怪的匈牙利符号，用“g”作为全局前缀，用“m”作为成员前缀（所以有像 gsSomeVariable 这样的宝石），在每个函数中添加“ref string sError”，而不是抛出异常（这是一个很大的诺诺！）。

然而，杀手在函数参数前加上 I_ 作为输入参数， O_ 作为输出参数。

我现在在一个更好的地方工作:)

* * *

## 回答 #54

> 赞同：7
> 
> 时间：2008-10-20T16:04:41.107

没有单个字符变量名——即使对于像 i 这样的简单迭代器也是如此。不得不使用 ii 什么的。我认为这很愚蠢。

另一个——也许是最疯狂的，但也许不是编码标准……

不允许使用 STL。这是在 2007/2008 年。在我发现那件废话后不久我就离开了那里。显然有些白痴认为没有“标准”（就像 15 年前一样......）我猜他们错过了关于 stl 在 C++ 标准中的备忘录......

使用愚蠢的 COM HRESULT 作为几乎所有方法的返回类型——即使它们不是 COM。这太可笑了。所以现在不是返回一些枚举类型或指示结果的有用值等，我们必须查找 S_OK 或 E_FAIL 或每个方法的上下文中的任何含义。再一次，我在那之后不久就离开了那里。

* * *

## 回答 #55

> 赞同：7
> 
> 时间：2008-10-22T08:24:21.703

插入换行符
(//-------------------------------------------------------- ------------------------------------)
ac# 项目中的方法之间。

* * *

## 回答 #56

> 赞同：7
> 
> 时间：2008-10-22T10:50:55.933

被迫在方法末尾只有 1 个 return 语句，并使代码下降到那个位置。

也无法在 switch 中重用 case 语句并让它通过；我必须编写一个复杂的脚本来执行某种开关循环，以正确的顺序处理这两种情况。

最后，当我开始使用 C 时，我发现在方法的顶部声明变量非常奇怪，并且非常讨厌它。我在 C++ 中度过了好几年，只是在我想要的任何地方声明它们；除非出于优化原因，我现在在方法的顶部声明所有方法变量，并详细说明它们的作用 - 使维护变得更加容易。

* * *

## 回答 #57

> 赞同：7
> 
> 时间：2009-01-15T16:38:38.383

在每个方法的末尾添加一个 80 字符的注释，以便轻松找到方法的结尾。像这样：

```
void doSomething()
{
}
//---------------------------------------------------------------------------- 
```

理由是：

*   一些用户不使用具有代码折叠功能的 IDE（好吧，我会给他们）。
*   方法之间的空间不清楚，因为人们可能不遵循其他关于缩进和大括号放置的编码标准，因此很难找到函数的结尾。（不相关；如果你需要添加这个是因为人们不遵循你的编码标准，那么他们为什么要遵循这个？）

* * *

## 回答 #58

> 赞同：7
> 
> 时间：2010-06-16T16:09:17.777

在使用 SQL Server 时，表名长度有很大的限制，我从来没有亲自碰到过它们，我们被迫使用旧大型机系统的命名约定，即使新系统从未与大型机数据库交互。

由于表名的微小限制，约定是给所有表代号，而不是有意义的描述。

因此，在一个可以很高兴拥有名为“ThisIsTheCustomerTable”的“客户”表的系统上，它被称为“TBRC03AA”。下一个表称为“TBRC03AB”，下一个称为“TBRC03AC”，以此类推。

这使得 SQL*非常*容易理解，尤其是在您编写它一个月之后。

* * *

## 回答 #59

> 赞同：6
> 
> 时间：2008-10-20T11:49:22.040

在**德尔福**，我们不得不改变

```
if something then
begin
  ...
end
else
begin
 ...
end; 
```

到

```
if something then begin
  ...
end else begin
 ...
end; 
```

在一个有 150 万行代码的项目中。想象一下这在源代码控制、差异和合并上是多么容易！当编译器宣布一个多余的结束时，它还导致忘记开始并且没有立即注意到它。

* * *

## 回答 #60

> 赞同：6
> 
> 时间：2008-10-20T13:24:41.770

我们必须在每条 sql 语句上方添加注释。所以，你可能有一个这样的sql语句

从用户中选择 USER_ID，其中 NAME = :NAME;

而且您仍然必须在其上方发表评论：

从 USERS 表中选择 USER_ID，其中 name 等于输入的名称。

现在，当实际的评论比代码长，而代码又简单到可以让二年级的学生阅读时，我真的不明白评论的意义……但是，唉，我不得不回去补充对这样的陈述的评论。

这是在大型机上，用 cobol 编码。团队规模通常在 4 或 5 人左右，但这个规则时不时地咬住这里的每个人。

* * *

## 回答 #61

> 赞同：6
> 
> 时间：2008-10-21T14:31:06.877

我经历过的最糟糕的事情是代码检查。出于某种原因，即使我们已经使用了 vcs 的 diff 工具来查看发生了什么变化，但当您想要检查代码时，您必须在文件/函数中使用一些注释块来包围您的更改，如下所示：

```
/*********...80charswide...***
 * START INSPECT
 */

 some changed code...

 /*
  * END INSPECT
  *********...80charswide...****/ 
```

检查后，您必须返回并在提交之前删除所有这些评论块。啊。

* * *

## 回答 #62

> 赞同：6
> 
> 时间：2009-06-29T20:01:04.190

与我在这里看到的一些令人发指的东西相比，我对编码标准的抱怨相当温和，但这里有：

我在一个项目中，一些开发人员坚持使用我见过的最奇特的缩进形式：

```
如果（条件）
   {
      x++;
      printf("您好！\n");
   }
别的
   {
      是++；
   }

```

我们正在开发一个带有非常糟糕的调试器的嵌入式环境。事实上，printf()、hexdump() 和 mapfile 是首选的调试方法。这当然意味着`static`禁止使用，所有全局变量和函数都必须是`modulename_variablename`.

禁止签入带有警告的代码（这不是一件坏事），但编译器会警告任何恒定的条件。因此，旧的宏/语句技巧`do { something(); } while(0)`被禁止了。

最后，在枚举器列表或初始化器上留下逗号被认为是惰性的，因此被禁止：

```
枚举调试级别
   {
      没有任何，
      致命的，
      警告，
      VERBOSE, // 淘气，淘气！
   };

```

正如我所说，相当温顺。但作为《C 程序员十诫》的追随者，我发现这种非常规的支撑风格绝对令人抓狂。

* * *

## 回答 #63

> 赞同：6
> 
> 时间：2009-11-11T05:30:05.703

我工作的最后一个地方主要是一家 C++ 商店，在我被录用之前，我的老板（他是研发总监）曾发布过“不允许动态内存分配”的法令。没有“new”，甚至没有“malloc”——因为“如果开发人员忘记了相应的删除/释放操作，这些可能会导致内存泄漏”。作为这个特定规则的推论，“指针也是不允许的”（尽管*引用*是完全可以接受的，既棒又安全）。

我废除了这些规则（而不是用其他语言重写我们所有的软件），但我确实必须添加一些我自己的很棒的规则，比如“未经有资格的人的书面批准，您不得启动新线程那种事情”基于一系列不幸的代码审查（叹息）。

* * *

## 回答 #64

> 赞同：5
> 
> 时间：2008-10-20T16:36:41.697

因为我一直是个体户/自由职业者/项目负责人，我从来没有进入过别人的标准，所有的标准都是我的决定。但是，我最近在 15 岁时发现了一篇有趣的“编码标准文档”：

**所有函数都必须命名为 "ProjectName_FunctionName"**。

那么，程序PHP，有人吗？那时还不是 PHP OOP 的艰难时期，但仍然如此。如果我想将一个项目的代码用于另一个项目，我将不得不重写所有引用等。

我本可以使用“package_FunctionName”之类的东西。

 ** * *

## 回答 #65

> 赞同：5
> 
> 时间：2008-10-21T14:07:25.367

也许我遇到的更令人沮丧的情况之一是人们坚持在存储过程前加上前缀“sp_”。

如果您不知道为什么这是一件坏事，请[在此处查看此博客条目！](http://www.sqlmag.com/articles/index.cfm?articleid=23011&)

简而言之，如果 SQL Server 正在寻找带有 sp_ 前缀的存储过程，它将首先检查 master 数据库（除非 SP 实际上在 master 数据库中，否则它不会找到它）。假设它不在主数据库中，SQL Server 假定 SP 不在缓存中，因此重新编译它。

这听起来像是一件小事，但它在高容量或繁忙的数据库服务器环境中加起来！

* * *

## 回答 #66

> 赞同：5
> 
> 时间：2008-10-21T14:31:45.317

在我公司的一个大团队中，我们几乎完全使用 C++。禁止通过非常量引用传递。

如果要将参数修改为函数，则必须通过指针传递。

对于优点（更容易识别可以修改变量的函数调用）和缺点（荒谬；当您需要一个参数时必须处理可能的 NULL 指针），我们每年大约会发生一次内部激烈的争论。

* * *

## 回答 #67

> 赞同：5
> 
> 时间：2008-11-10T21:05:05.363

当有人不使用命名约定时，我绝对讨厌它。在我工作的地方，首席开发人员（我取代了他）无法确定他是想使用 camelCase 还是 way_over_used_underscores。就个人而言，我讨厌下划线，骆驼式的情况更容易阅读，但只要你保持一个标准，这并不重要。

PHP 在这方面尤其糟糕，看看 mysql_numrows 它将两者合并而没有大写。

* * *

## 回答 #68

> 赞同：5
> 
> 时间：2009-02-13T12:56:45.063

SCORM 是肯定的。（[http://en.wikipedia.org/wiki/SCORM](http://en.wikipedia.org/wiki/SCORM)）

* * *

## 回答 #69

> 赞同：5
> 
> 时间：2009-06-10T16:17:26.197

这不是一个编码标准问题，但肯定是一个限制性思维的故事。我们在不少于 7 周内完成了一个为期 4 周的短项目。时间表大致基于对功能列表的猜测。开发过程包括疯狂编码。在事后分析期间，我建议使用里程碑并将功能请求分解为任务。令人难以置信的是，我的主管驳回了我的想法，说因为这是一个如此短的项目，我们不需要使用里程碑或任务，并要求提供其他建议。房间里鸦雀无声。

语言：Java、C++、HTML 团队规模：两个团队，总共 10 名工程师 它对您和您的团队造成的不良影响：我觉得我陷入了呆伯特卡通片中。

* * *

## 回答 #70

> 赞同：5
> 
> 时间：2009-09-12T03:40:31.410

用 _ 标记私有变量只是为了确保我们知道我们正在处理类中的私有变量。然后使用 php 的魔术方法 __get 和 __set 提供对每个变量的访问，就好像它们是公共的一样......

* * *

## 回答 #71

> 赞同：5
> 
> 时间：2010-08-23T04:36:32.453

我们的 Oracle DBA 坚持我们将模式名称添加到表名之前，即如果您的模式是`hr_admin`，那么您的员工表就是`hr_admin_staff`，这意味着跨模式查询中的表的全名是`hr_admin.hr_admin_staff`。

* * *

## 回答 #72

> 赞同：5
> 
> 时间：2010-09-24T09:01:37.710

我的第一份编程工作是在 Microsoft QuickBASIC 4.5 商店工作。首席开发人员几乎一直在 BASIC 中工作，因此 QuickBASIC 的大多数高级（！）功能都是禁止使用的，因为它们是新的并且他不​​理解它们。所以：

*   没有 Sub/End Sub 程序。一切都由 GOSUB 完成
*   我们被允许不对不是 GOTO 或 GOSUB 目标的行进行编号。但 GOTO 目标必须是数字标签，而不是名称。
*   GOSUB 的目标可以命名，但名称必须以“S”和四位数字为前缀。所有子例程都必须在源文件中按顺序排列四位数字。所以一个典型的例程可能是 S1135InitializePrinter。你必须去找到正确的例程来获得这个数字，有足够的你不能希望记住它们。
*   没有块 IF/END IF。所有 IF 都必须有一个 GOTO 或 GOSUB 作为条件语句。

那是一个非常有趣的工作。不，认真的。

* * *

## 回答 #73

> 赞同：4
> 
> 时间：2008-10-20T15:52:59.617

我完全不同意这一点，但我不得不遵循它：

“所有 HTML 链接都将始终带下划线。”

不久前，我解释了为什么我不同意我的[博客](http://dotnetbob.blogspot.com/2007/11/links-and-usability.html)。

**注意：当您将鼠标移到链接上时，即使是 Stackoverflow 也只会在链接上加下划线。**

* * *

## 回答 #74

> 赞同：4
> 
> 时间：2008-10-21T13:42:17.243

在 C++ 中，我们必须为每个类显式地编写编译器应该为我们编写的所有内容（默认构造函数、析构函数、复制构造函数、复制赋值运算符）。看起来编写标准的人对语言不是很有信心。

* * *

## 回答 #75

> 赞同：4
> 
> 时间：2008-10-24T16:13:44.893

三年前，我在一家 VB .NET 商店工作，那里的“技术领导”规定所有接受引用类型参数（即对象）的方法都必须使用**ByRef**而不是**ByVal**。我发现这特别奇怪，因为他们在我的采访中问了我 ByVal/ByRef-what's-the-difference 的问题，我解释了它如何用于值类型和引用类型。

他对这种做法的解释是：“一些新的、经验不足的开发人员会感到困惑。”

当时，我是最近被聘用的，这是我的第一份永久性 .NET 工作。我并**没有**被它弄糊涂。

* * *

## 回答 #76

> 赞同：4
> 
> 时间：2009-02-13T13:04:00.910

我一直在为在 mysql 关键字之后命名表列而烦恼。它需要在您编写的每个查询中转义愚蠢的列名。

```
SELECT this, that, `key` FROM sometable WHERE such AND suchmore; 
```

太可怕了。

* * *

## 回答 #77

> 赞同：4
> 
> 时间：2009-03-15T13:11:24.907

我必须拼写和语法检查我的评论。它们必须是完整的句子，正确大写并以句号结尾。

* * *

## 回答 #78

> 赞同：4
> 
> 时间：2009-06-10T16:59:12.243

给我们的桌子编号，比如 tbl47_[some name]

* * *

## 回答 #79

> 赞同：4
> 
> 时间：2009-09-20T12:35:33.097

在为 VB 项目编码时，我被要求为每种方法添加以下注释部分

```
'Module Name
'Module Description
'Parameters and description of each parameter
'Called by
'Calls 
```

虽然我发现其余的都很好，但我反对最后两个，我争论的原因是随着项目变得越来越大，它会变得难以维护。如果我们正在创建库函数，那么我们将永远无法维护 Called by。我们是 6 人的小团队，所以经理提出的论点是，既然你要调用函数，就应该维护它。无论如何，我不得不放弃这个论点，因为经理很固执。结果正如预期的那样，随着项目变得越来越大，没有人关心维护 Called by 和 Calls。

* * *

## 回答 #80

> 赞同：4
> 
> 时间：2009-11-11T05:44:58.003

在我的第一份工作中，老板说我们应该始终在 C# 中使用完全限定的类型名称并禁止使用，因为我们应该始终知道在声明变量、参数等时我们使用的是哪种类型。

* * *

## 回答 #81

> 赞同：4
> 
> 时间：2010-04-15T19:30:55.057

我为硬编码工作的项目是一个严格的 NO..所以我们被迫散列定义如下

#define 1 个

* * *

## 回答 #82

> 赞同：4
> 
> 时间：2010-09-22T05:09:32.613

我们按照 MISRA 标准进行编码。规则集包含“必须”和“可以”部分，我们花了数小时讨论我们不想应用哪些规则以及为什么，当有一天高层管理人员说“我们想告诉我们的客户我们 100% 合规。明天，我们全部应用。”

其中一条规则是：**对签名数据不进行位操作。** 试图找出规则的用途，给出了解释：没有关于签名数据的位表示的保证。世界上只有2s补码，但标准不保证！

无论如何，这听起来不是什么大事——谁想将位编码的变量声明为有符号的？

然而，神圣规则检查器将“整数提升”解释为“提升到已签名”，C 标准大师说它必须如此。并且每个位操作都会进行整数提升。所以而不是：

```
a &= ~(1 << i) 
```

你必须写：

```
a = (unsigned int)(a & (unsigned int)~(unsigned int)(1 << i)) 
```

这显然更具可读性和便携性。幸运的是，我发现移位的 1u 保持无符号。因此，您可以将其简化为：

```
a = (unsigned int)(a & (unsigned int)~(1u << i)) 
```

有趣的是，有一条规则没有被激活：禁止在#include 中使用“\”之类的有趣字符。DOS 损坏的人不会相信编写 #include "bla/foo.h" 确实适用于每个 Windows 编译器并且更便携。

* * *

## 回答 #83

> 赞同：3
> 
> 时间：2008-10-20T11:47:24.370

任何与格式有关的事情（尤其是 '{' 和其他块字符的位置）总是很难执行。

即使在每个源文件检查时都有自动格式，您也不能确定每个开发人员将*始终*使用相同的格式化程序，具有相同的格式化规则集......

然后您必须将这些文件合并回主干。你自杀了；）

* * *

## 回答 #84

> 赞同：3
> 
> 时间：2008-10-20T12:04:13.603

最奇怪的是Java中必须使用类型限定的变量命名，以及数据库中列的类型。所以必须将 java.sql.ResultSet 称为 tblClient 等。

* * *

## 回答 #85

> 赞同：3
> 
> 时间：2008-10-20T12:14:53.237

我们的 C++ 开发团队中存在争议的第 80 个字符列之后的无代码。一些人强制执行喜欢和代码审查；被别人鄙视。

另外，我们有一个非常有争议的 C++ throw(), throw(...) 规范标准。被一些人宗教使用，被其他人妖魔化。两个阵营都引用了讨论和专家来执行各自的立场。

* * *

## 回答 #86

> 赞同：3
> 
> 时间：2008-10-20T15:50:45.547

文件的创建者（不必放入任何代码）必须将他们的名字放入文件中。因此，如果您创建存根或占位符，您将永远“拥有”它们。

实际编写代码的人没有添加他的名字；我们有源代码控制，以便我们知道，总是该怪谁。

* * *

## 回答 #87

> 赞同：3
> 
> 时间：2008-10-20T17:19:34.137

我实现并修改了一个开源的 asp 经典购物车（主要是一长串dailyWTF 候选者），它以小写 p 开头每个变量。如 pTax_Amount 或 pFirst_Name。

对此没有任何解释，尽管我在他们的一个论坛上的某个地方读到它是为了避免使用像 State 这样的保留字 - 你会用 pState 代替。他们还随机地将 temp 附加到事物上。像 rsTemp 和 connTemp。我猜与永久记录集和数据库连接相反。

* * *

## 回答 #88

> 赞同：3
> 
> 时间：2008-10-20T21:14:43.990

用几乎所有方法的无意义信息编写方法注释。

不允许一个方法有多个退出点。

所有变量、枚举、结构甚至类的匈牙利符号，例如 iMyInt、tagMySturcture、eMyEnum 和 CMyClass。

* * *

## 回答 #89

> 赞同：3
> 
> 时间：2008-11-10T20:46:07.977

几年前，我在 C 工作中遇到了两条我非常讨厌的规则：

1.  “每个文件一个模块”，其中“模块”被定义为 C 函数。

2.  函数局部变量只允许在函数的顶部，所以这种事情是非法的：

> ```
> if (test)
> {
>    int i;
>    ...
> } 
> ```

* * *

## 回答 #90

> 赞同：3
> 
> 时间：2009-02-13T13:52:00.903

在我目前工作的地方，官方编码标准规定最大行长为 80 个字符。理由是使代码的硬拷贝能够被格式化。不用说，这导致了非常奇怪的代码布局。我一直在努力消除这个标准，主要是通过“你最后一次制作硬拷贝代码是什么时候？”的论点。现在的可读性与在 80 列 DMP 上制作硬拷贝的机会？

斯基兹

* * *

## 回答 #91

> 赞同：3
> 
> 时间：2009-02-13T13:52:11.387

虽然这不是一份工作，但我们在大学里有一个大型项目。其中一个要求是注释我们应用程序中的*每一*行代码——不管它做了什么......并且每一行都必须是具体的，例如

```
int x=0; //declare variable x and assign it to 0 
```

我们不允许这样做：

```
int x, y, z = 0; //declare and assign to 0 
```

因为不够详细。这甚至没有遵循强加给我们的命名约定。

不用说我们花了几个小时回顾代码......

* * *

## 回答 #92

> 赞同：3
> 
> 时间：2009-02-13T15:11:35.707

在一家大型英国银行，我被聘为新 .NET 系统的设计权威。

他们的规则规定数据库表的长度不得超过 8 个字符，并以项目代码（5 位代码）作为前缀。

他们在 Windows 项目上强制执行旧的 DB2*规则*

* * *

## 回答 #93

> 赞同：3
> 
> 时间：2009-03-15T13:01:20.513

一点匈牙利语都没有。

好吧，你觉得这很糟糕，为什么？好吧，因为他们认为这是匈牙利语：

```
整数富；
诠释 *pFoo;
int **hFoo;
```

现在，任何老派的 Mac 程序员都会记得处理 Handles 和 Ptrs。以上是区分它们的最简单方法 - Apple 示例代码充满了它，Apple 几乎不是匈牙利主义的温床。因此，当我不得不编写一些老式的 Mac 代码时，我自然而然地这样做了，并因为它是匈牙利语而被否决。

但是没有人能提出一个替代命名方案来保持三个变量以不同方式引用相同数据的清晰度，所以我按原样检查它。

* * *

## 回答 #94

> 赞同：3
> 
> 时间：2010-06-08T02:59:19.890

不允许使用指针或 GOTO！（在 C 语言中，不过如此！）谢天谢地，这只是一个“软件工程”课程，我能够毕业然后进入“现实世界”。

* * *

## 回答 #95

> 赞同：3
> 
> 时间：2010-10-29T17:18:59.807

在我之前的工作中，我很高兴在 3 个月前辞职：

数据库：

*   表名必须是大写的。
*   表名必须以 TBL_ 为前缀
*   字段必须加上前缀： DS_（对于 varchar，这没有意义） NU_ 用于数字 CD_ 用于（“位字段”）DT_ 用于日期
*   数据库字段也必须是大写 [CD_ENABLED]
*   与 sp 名称 [SP_INFINITY_USER_GROUPS_QRY] 和数据库名称 [INFINITY] 相同
*   我有没有提到sp名称实际上是那样的？SP_ 前缀，然后是数据库名 SP_INFINITY_ 然后是表名，SP_INFINITY_USER_GROUPS 然后是 sp 实际预期要做的事情（QRY，UPD，DEL，INS），耶稣，甚至不要让我开始处理不仅仅是 CRUD 查询的查询。
*   毫无疑问，所有文本字段都必须是 varchar(MAX)。
*   numbers 要么是 int 要么是 double，即使你可以使用其他类型。
*   “布尔”字段（位）是 int，没有理由。
*   存储过程必须以 sp_productname_ 为前缀

asp.net / c# / javascript

*   每一个函数都必须包含在 try{}catch{} 中，因此应用程序不会“爆炸”（至少这是官方原因），即使这会导致事情无法正常工作并且不知道原因。
*   参数必须以 p 为前缀，例如 pCount、pPage
*   范围变量必须以 w 为前缀（如在“工作”中，这到底是什么意思？）
*   带 g 的静力学等。
*   框架 1.1 之后的所有内容都是禁止的，就像您对 linq 和泛型有任何实际用途一样。（我强调强制他们让我使用 jquery，但至少我成功了）。

* * *

## 回答 #96

> 赞同：2
> 
> 时间：2008-10-20T13:21:01.187

*所有*文件名必须小写...

* * *

## 回答 #97

> 赞同：2
> 
> 时间：2008-10-21T02:40:36.813

我不允许`this->`在我们的 C++ 代码中使用引用局部变量...

* * *

## 回答 #98

> 赞同：2
> 
> 时间：2008-10-22T13:15:47.263

我公司的所有文件都是版本控制的。到现在为止还挺好。

但是对于每一个文件，在第一次提交到 CVS 时，您必须立即添加两个标签：**CRE**（用于 CREation）和**DEV001**（用于第一个开发周期）。好像它是文件本身的第一个版本还不够。

幸运的是，在那之后，这个过程变得更加合理。

* * *

## 回答 #99

> 赞同：2
> 
> 时间：2009-02-21T22:28:25.643

每个逻辑行只能声明一个变量。[基本原理：每行多个声明导致代码行计数不准确。]

* * *

## 回答 #100

> 赞同：2
> 
> 时间：2009-06-04T23:21:16.210

最糟糕的是一个我仍然赚钱的无名之地，没有标准。每个节目都是新的冒险。

幸运的是，我和另一个承包商正在慢慢地培训真正的员工，并在混乱中强加一些结构。

* * *

## 回答 #101

> 赞同：2
> 
> 时间：2009-11-11T05:18:41.263

必须在 java 实例变量上加上 m_ 前缀，在 java 静态变量上加上 g_ 前缀，这是我曾经不得不处理的**大多数非 Java**白痴，由不知道如何使用记事本以外的任何东西的 C 和 C++ 开发人员长期存在开发Java！

除了没有人真正遵循这一点，除了把 m_ 放在所有东西上，甚至是静态的，甚至是方法名......

* * *

## 回答 #102

> 赞同：2
> 
> 时间：2010-06-13T02:42:38.920

我们旧的 c# 编码标准要求我们使用巨大的、丑陋的注释块。你知道在 Code Complete 中，[Steve McConnell](http://www.stevemcconnell.com/)给出了一个丑陋的注释宏的典型例子吗？那。几乎完全匹配。

最糟糕的是，c# 是一种已经具有良好（且相对不显眼）注释支持的语言。

你会得到这样的东西：

```
/// <summary>
/// Add an item to the collection
/// </summary>
/// <parameter name="item">The item to add</parameter>
/// <returns>Whether the addition succeeded</returns>
public bool Add(int item) { ... } 
```

它会变成这样：

```
// ########################################################## //
/// <summary>
///     Add an item to the collection
/// </summary>
///     IN:  <parameter name="item">The item to add</parameter>
///     OUT: <returns>Whether the addition succeeded</returns>
// ########################################################## // 
```

请注意，StackOverflow 的语法突出显示并不正确，与默认的 VS 文本方案一样，# 符号是亮绿色，导致对视网膜的过度侵犯。

我只能假设作者真的非常喜欢它，因为之前的 C/C++ 努力。问题是，即使您只有几个自动属性，它也会占用您大约 50% 的屏幕空间并增加显着的噪音。额外的 // 行也破坏了 R# 的重构支持。

在我们放弃了注释宏之后，我们最终用一个脚本来处理整个代码库，该脚本将我们带回了 Visual Studio 的默认 c# 注释样式。

* * *

## 回答 #103

> 赞同：1
> 
> 时间：2008-10-20T11:46:50.737

当您可以简单地使用关键字 this 时，在全局变量前面使用 _ 或 m_。当您需要访问全局变量时...

* * *

## 回答 #104

> 赞同：1
> 
> 时间：2008-10-20T16:59:01.417

回到我的 COBOL 时代，我们不得不使用三个星号来表示评论（COBOL 在第 7 列中只需要一个星号）。我们甚至有一个预编译器来检查这个，如果你使用三个星号以外的任何东西，它就不会编译你的程序。

* * *

## 回答 #105

> 赞同：1
> 
> 时间：2008-11-09T01:34:20.173

我专业使用的第一种语言是 4D。它支持以 <> 为前缀的进程间变量、不带前缀的进程变量和以 $ 开头的局部变量。编译器/解释器使用所有这些前缀（或缺少前缀）来确定变量的范围。

实际奇怪的编码标准是某种匈牙利符号。问题在于，不是根据变量的类型命名变量，而是必须根据它们的作用域为它们加上前缀。

范围由前缀决定的变量必须以冗余信息作为前缀！

我不敢问负责标准的人为什么必须这样......

* * *

## 回答 #106

> 赞同：1
> 
> 时间：2009-06-10T17:09:24.407

在我上一份工作中，我的主管总是执行墨菲定律：

“任何可能出错的事情都会出错。”

我想这是因为我们没有松懈地在代码中进行一些快速修复或类似的事情。现在，我的脑海中不断出现这句话。

* * *

## 回答 #107

> 赞同：1
> 
> 时间：2009-08-31T17:52:50.530

我的老老板坚持我们使用常量而不是枚举，但从未给出理由，在所有使用这些的场景中，枚举更有意义。

更好的方法是坚持所有表名都是单数，然后也使代码中的类也单数。但它们不仅代表对象，例如用户或组，还代表表并包含该表的所有 CRUD 和许多其他操作。但是等等，还有更多！它们还必须包含一个公开可见的名称/值集合，以便您可以使用索引器按列名称获取属性，以防万一您添加了新列但不想添加新属性。还有许多其他“必须做的事情”不仅没有意义，而且对代码的性能也造成了很大影响。我可以尝试将它们全部指出，但代码不言自明，遗憾的是，这几乎是我刚刚从旧存档文件夹中拉出的 User 类的精确副本：

```
public class Record
{
    private string tablename;
    private Database database;

    public NameValueCollection Fields;

    public Record(string TableName) : this(TableName, null) { }
    public Record(string TableName, Database db)
    {
        tablename = TableName;
        database = db;
    }

    public string TableName
    {
        get { return tablename; }
    }

    public ulong ID
    {
        get { return GetULong("ID"); }
        set { Fields["ID"] = value.ToString(); }

    }

    public virtual ulong GetULong(string field)
    {
        try { return ulong.Parse(this[field]); }
        catch(Exception) { return 0; }
    }

    public virtual bool Change()
    {
        InitializeDB(); // opens the connection
        // loop over the Fields object and build an update query
        DisposeDB(); // closes the connection
        // return the status
    }

    public virtual bool Create()
    {
        // works almost just like the Change method
    }

    public virtual bool Read()
    {
        InitializeDB(); // opens the connection
        // use the value of the ID property to build a select query
        // populate the Fields collection with the columns/values if the read was successful
        DisposeDB(); // closes the connection
        // return the status    
    }
}

public class User
{
    public User() : base("User") { }
    public User(Database db) : base("User", db) { }

    public string Username
    {
        get { return Fields["Username"]; }
        set
        {
            Fields["Username"] = value.ToString(); // yes, there really is a redundant ToString call
        }
    }
} 
```

抱歉，如果这个双重帖子，第一次我可能不是人类，或者该网站可能只是限制了可以发布的糟糕代码

* * *

## 回答 #108

> 赞同：1
> 
> 时间：2009-11-11T05:09:44.033

## 首字母大写

**务必**将双字符首字母缩写词的两个字符大写，但驼峰式标识符的第一个单词除外。

```
System.IO
public void StartIO(Stream ioStream) 
```

**除了驼峰**式标识符的第一个单词之外，只有三个或更多字符的首字母缩写词的第一个字符大写。

```
System.Xml
public void ProcessHtmlTag(string htmlTag) 
```

**不要**在驼峰式标识符的开头大写任何首字母缩略词的任何字符，无论其长度如何。

* * *

## 回答 #109

> 赞同：1
> 
> 时间：2010-06-13T01:48:52.007

最奇怪的是“这必须用 C++ 编码”。大概我是因为我的专业知识而被录用的。如果我的专家意见说另一种语言会做得更好，那么应该使用另一种语言。告诉我应该使用哪种工具，就像告诉汽车修理工他只能使用公制扳手一样。而且只有扳手。

* * *

## 回答 #110

> 赞同：1
> 
> 时间：2011-01-11T13:07:36.860

我曾经不得不忍受的最糟糕的编码标准是疯狂的缩进。

该代码最初是在使用 60x80 字符绿屏终端的大型机上编写的（这是很久以前的事了）。这些东西的默认标签大小是 8 个字符，但当时的程序员认为这太大了——屏幕本身只显示 80 个字符，所以 8 个字符的标签浪费了很多空间。

因此他们决定将代码的意图大小设置为 4 个字符。

你说，这很公平。除了他们没有通过更改标签大小来做到这一点。他们通过将第一个缩进设为 4 个空格，将第二个缩进设为单个制表符，依此类推，交替添加 4 个空格和一个制表符。

当他们坚持使用绿屏终端时，这很好。很奇怪，但很好。

当开发团队获得闪亮的新 Windows PC 时，真正的混乱开始了。

他们选择的 PC 编辑器的选项卡大小设置为 4 个字符，因此当加载代码时，缩进简直是无处不在。

我们无法修复缩进，因为一些开发人员仍在使用绿屏，所以在一年左右的时间里让整个团队过渡到 PC，我们在尝试使用几乎不可读的代码时遇到了一场噩梦一种环境或另一种环境（或更频繁地，两者兼有）。

* * *

## 回答 #111

> 赞同：0
> 
> 时间：2008-10-21T01:25:35.233

后缀 _ 到成员变量。例如

```
int numberofCycles_; 
```

这是在一个开源项目的 C++ 中，有几个开发人员。主要的副作用是直到到达名称的末尾才知道变量具有类范围。不是我以前想太多的事情，但显然倒退了。

* * *

## 回答 #112

> 赞同：0
> 
> 时间：2008-10-22T07:44:18.570

“编写编译器的人可能比你聪明得多，所以不要尝试聪明的事情”是一份指南文档所说的（不是字面意思）。

# c# - C# BinaryFormatter - 如何找出二进制数据的类？

> ID：218133
> 
> 赞同：2
> 
> 时间：2008-10-20T11:45:03.297
> 
> 标签：c#, serialization, binary

我想反序列化一个对象，但不知道前面的类。所以，考虑下面的代码......

```
IFormatter formatter = new BinaryFormatter();
Stream stream = new FileStream("MyFile.bin", FileMode.Open, FileAccess.Read, FileShare.Read);
MyObject obj = (MyObject)formatter.Deserialize(stream); 
```

如果我不知道前面的课程，我该怎么办？比如说，例如“MyFile.bin”是一个 MyObject 或一个 MyFoo。如何确定要实例化哪个对象？

就像是...

```
if (magic happens here == typeof(MyObject))  
    MyObject obj = (MyObject) formatter.Deserialize(stream);   
else if (more magic happens here == typeof(MyFoo))  
    MyFoo foo = (MyFoo)formatter.Deserialize(stream); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-20T11:48:59.093

做就是了：

```
object result = formatter.Deserialize(stream); 
Type t = result.GetType(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T11:53:30.393

主要如leppie所说...

如果你想测试几个已知的类型，你可以使用“is”/“as”：

```
MyFoo foo = result As MyFoo;
if(foo != null) { // it was one of those
  // special code
} 
```

但总的来说，您会让序列化程序担心这些细节......

当然，这与基于 xml 的序列化程序非常不同，因为您需要告诉序列化程序预期什么，而不是序列化程序告诉您它得到了什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T11:52:11.397

几点建议，

1.  如果您反序列化对象而不强制转换 object myObject = formatter.Deserialize(stream); 然后使用“as”运算符检查与已知类型的类型兼容性，那么这可能会起作用。

2.  看一下 SerializationBinder 类型的 BinaryFormatter.Binder 属性，我们之前使用它来向后兼容旧版本的文件格式，效果很好。基本上允许您完全控制反序列化的内容。

# javascript - 检票口 + Javascript

> ID：218144
> 
> 赞同：4
> 
> 时间：2008-10-20T11:49:38.373
> 
> 标签：javascript, java, ajax, xml, wicket

我正在将一个`Javascript`小部件包装在一个`Wicket`组件中。我想让 JS 方面与组件对话。到目前为止我得到了什么：

有问题的组件就像

```
talker = new GridAjaxBehavior();
this.add(talker); 
```

在构造函数中

然后，稍后，放一些类似的东西

```
"var MyGridTalker = new talker(" + this.talker.getCallbackUrl() + ");"; 
```

进入JS。

在哪里`GridAjaxBehavior`延伸`AbstractDefaultAjaxBehavior`。我希望 GridAjaxBehavior 在 JS 调用它时吐回一些 XML。

我这样做对吗？GridAjaxBehaviour 应该怎么做才能吐回 XML？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-04T17:29:27.067

吐出一些 XML 做什么？大概是为了更新模型或视图，是吗？

Wicket 的优势在于您不必担心呈现的 HTML。在模型-视图-控制器术语中，您设置控制器以正确修改模型，而 Wicket 负责视图。

分离并不*完全*清楚：实际上您可以显示/隐藏视图组件，或者然后更改，这可以看作是更改视图。

但是您通常不必做的是直接管理浏览器或javascript。如果您注意在 Java 代码中进行更改，Wicket 会处理这些。

在 Wicket 中，Ajax 将使用 AjaxRequestTarget 目标调用 AjaxBehavior 上的方法。

在该方法（或从它调用的方法中）中，您可以做任何您需要做的事情，更新模型或视图，然后将任何已更改的视图组件添加到目标中。Wicket 负责更新浏览器。

* * *

这是一个例子。它取自我做的一些代码，但为了使解释更清楚而进行**了大量修改。**这个想法很简单：“链式”下拉选择，当父项中的选择选项发生变化时，子项中的选项会发生变化，如 [州] [县] [区] 的系列。

（在实际的类中，模型更改被传递给孩子，孩子自己决定是否发生了变化，如果有，则将自己添加到目标中，然后将目标传递给它的孩子。我已经删除了大部分举个更清楚的例子。）

这是 ctor，它只是给自己添加了一个 AjaxBehavior 的匿名子类：

```
public AjaxChildNotifyingDropDownChoice(...code elided for clarity...) {
    this.child = child;

    // Ajax won't work without this:
    setOutputMarkupId(true);
    // 
    add( new OnChangeAjaxBehavior() {
        @Override
        public void onUpdate(final AjaxRequestTarget target) {

            // tell child to update its list
            // based on newly selected value

            // when the Ajax is called, 
            // my owning component's model
            // is already updated

            // note we could just type getModel()
            // I'm making explicit that we're calling it
            // on the enclosing class 
            // (which a non-static inner class has a hidden ref to) 
            child.setNewModelBasedOnSelectionOf( 
               AjaxChildNotifyingDropDownChoice.this.getModel());

            // now add the child to the target
            // Wicket javascript will receive the new 
            // options and re-render the child dropdown
            target.add(child);

        }
    });
} 
```

我们还可以隐藏或取消隐藏组件，或添加 CSS 样式等行为，甚至将一个面板换成另一个面板。只要对于每个更改的组件，我们： 1) 调用 setOutputMarkupId(true); 以便 javascript 可以找到它，并且 2) 将其添加到 AjaxRequestTarget

请注意，Ajax 行为的不同类型（子类）具有不同的回调函数，因此请确保您覆盖了正确的回调函数（添加一个 @Override 注释，以便编译器在名称错误时会抱怨）。

但同样，基本的 wicket 想法是，不是将原始数据发送给客户端进行解析和操作，而是更新模型和视图，并告诉 Wicket 重新渲染您所做的更改，方法是将已更改的组件添加到目标。

我能想到直接发送 XML 的唯一原因是将其提供给非 Wicket javascript。让我知道这是否是你的目标，我完全错过了重点。;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-03T11:23:46.127

我真的不知道 Wicket 是什么或它做了什么，但您的代码中有一个小错误（如它所显示的那样）。

这个：

`"var MyGridTalker = new talker(" + this.talker.getCallbackUrl();`

你似乎错过了你的结束括号：

`"var MyGridTalker = new talker(" + this.talker.getCallbackUrl() + ")";`

反正没什么大不了的，但不知道是不是故意的。

# c# - 我可以从我的应用程序中抛出哪些内置 .NET 异常？

> ID：218150
> 
> 赞同：71
> 
> 时间：2008-10-20T11:51:38.603
> 
> 标签：c#, .net, exception

如果我需要在我的应用程序中引发异常，我可以使用哪个内置的 .NET 异常类？他们都是公平的游戏吗？我什么时候应该得到自己的？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2008-10-20T12:00:54.357

请参阅[创建和引发异常](http://msdn.microsoft.com/en-us/library/ms173163.aspx)。

在抛出内置异常时，它说：

> 不要故意从您自己的源代码中抛出 System.Exception、System.SystemException、System.NullReferenceException 或 System.IndexOutOfRangeException。

和

> 不要抛出一般异常
> 
> 如果您在库或框架中抛出一般异常类型，例如 Exception 或 SystemException，它会强制消费者捕获所有异常，包括他们不知道如何处理的未知异常。
> 
> 相反，要么抛出框架中已经存在的更多派生类型，要么创建自己的派生自 Exception 的类型。”

此[博客条目](http://blogs.msdn.com/fxcop/archive/2007/01/22/faq-what-exception-should-i-throw-instead-of-the-reserved-exceptions-found-by-donotraisereservedexceptiontypes.aspx)也有一些有用的指南。

此外，FxCop 代码分析定义了一个“不引发异常”列表，如此处[所述](http://msdn.microsoft.com/en-us/library/ms182338.aspx)。它建议：

> 以下异常类型过于笼统，无法为用户提供足够的信息：
> 
> *   系统异常
> *   System.ApplicationException
> *   System.SystemException
> 
> 以下异常类型是保留的，只能由公共语言运行时引发：
> 
> *   System.ExecutionEngineException
> *   System.IndexOutOfRangeException
> *   System.NullReferenceException
> *   System.OutOfMemoryException

因此，理论上您可以引发任何其他框架异常类型，前提是您清楚地了解 Microsoft 描述的异常的意图（请参阅 MSDN 文档）。

请注意，这些是“指南”，正如其他人所说，围绕 System.IndexOutOfRangeException 存在争议（即许多开发人员抛出此异常）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-20T12:14:36.827

关于`System.Exception`and `System.ApplicationException`：后者旨在用作所有自定义异常的基类。然而，这并没有从一开始就一直执行。因此，是否应该使用这个类而不是`System.Exception`作为所有异常的基类存在争议。

无论您决定采用哪种方式，都*不要*直接抛出这两个类的实例。可惜他们不是`abstact`。对于它的价值，请始终尝试使用最具体的异常。如果没有满足您的要求，请随意创建自己的。但是，在这种情况下，请确保您的异常比现有异常具有优势。特别是，它应该完美地传达其含义，并提供以有意义的方式处理情况所需的所有信息。

避免创建没有任何意义的存根异常。同样，避免创建巨大的异常类层次结构，它们很少有用（尽管我可以想象我会使用它们的一两种情况……解析器就是其中之一）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-20T11:57:33.553

我[`ArgumentException`](http://msdn.microsoft.com/en-us/library/system.argumentexception%28v=vs.110%29.aspx)经常使用（及其“朋友”）。

[`NotSupportedException`](http://msdn.microsoft.com/en-us/library/system.notsupportedexception%28v=vs.110%29.aspx)并且[`NotImplementedException`](http://msdn.microsoft.com/en-us/library/system.notimplementedexception%28v=vs.110%29.aspx)也很常见。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-20T12:37:55.860

我的建议是专注于两件事：

1.  场景
2.  用户期望

换句话说，我会坐下来确定：

1.  你想在什么场景下抛出异常。
2.  在这些情况下，您的 API 的用户会期望什么

当然，#1 的答案是特定于应用程序的。＃2的答案是“他们已经熟悉的任何类似代码”。

由此产生的行为是：

1.  在您的程序中出现的也到达框架内部的情况下，例如参数为空、超出范围、无效、方法未实现或不支持，那么您应该使用框架使用的相同异常。使用您的 API 的人会期望他们以这种方式行事（因为这就是其他一切的行为方式），因此能够更好地从“开始”使用您的 API。

    2.  对于框架中不存在的新场景，您应该继续发明自己的异常类。我会说你应该更喜欢 Exception 作为你的基类，除非它们是提供你需要的服务的其他基本异常。一般来说，我认为“ApplicationException”之类的东西不会对您有太大帮助。当您开始定义自己的异常时，您应该记住以下几点：

    一种。异常的主要目的是用于人类交流。它们传达了关于发生的不应该发生的事情的信息。他们应该提供足够的信息来确定问题的原因并找出解决方法。

    湾。内部一致性非常重要。使您的应用程序在类似情况下尽可能通用，这将使您的 API 用户更有效率。

至于你应该做什么和不应该做什么有严格的规定......我不会担心那些东西。相反，我只会专注于识别场景，找到适合这些场景的现有异常，然后在现有异常不存在时仔细设计自己的异常。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-20T12:08:06.060

您几乎可以创建和抛出其中任何一个，但通常不应该这样做。例如，各种参数验证异常（ArgumentException、ArgumentNullException、ArgumentOutOfRangeException 等）都适合在应用程序代码中使用，但 AccessViolationException 不适合。ApplicationException 作为您可能需要的任何自定义异常类的合适基类提供。

有关最佳实践的列表，请参阅此[MSDN 文章](http://msdn.microsoft.com/en-us/library/seyhszts.aspx)- 它指的是处理异常，但也包含有关创建它们的好建议...

# java - 如何动态更改 JFrame 内的 JPanel？

> ID：218155
> 
> 赞同：43
> 
> 时间：2008-10-20T11:53:41.517
> 
> 标签：java, swing, jpanel, layout-manager, cardlayout

简单地说，有一个简单的 java swing 应用程序，它由 JFrame 和一些组件组成。其中一个组件是一个 JPanel，它旨在在用户操作时被另一个 JPanel 替换。

那么，做这种事情的正确方法是什么？我试过了

```
panel = new CustomJPanelWithComponentsOnIt();
parentFrameJPanelBelongsTo.pack(); 
```

但这行不通。你有什么建议？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-10-20T14:00:58.233

您的用例似乎非常适合[CardLayout](http://java.sun.com/docs/books/tutorial/uiswing/layout/card.html)。

在卡片布局中，您可以在同一位置添加多个面板，然后一次显示或隐藏一个面板。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-10-20T13:10:03.343

1）设置第一个面板：

```
JFrame frame=new JFrame();
frame.getContentPane().add(new JPanel()); 
```

2）更换面板：

```
frame.getContentPane().removeAll();
frame.getContentPane().add(new JPanel()); 
```

另请注意，您必须在事件的线程中执行此操作，以确保使用[SwingUtilities.invokeLater](http://java.sun.com/javase/6/docs/api/javax/swing/SwingUtilities.html#invokeLater(java.lang.Runnable))或[SwingWorker](http://java.sun.com/javase/6/docs/api/javax/swing/SwingWorker.html)

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-10-20T12:31:26.590

```
frame.setContentPane(newContents());
frame.revalidate(); // frame.pack() if you want to resize. 
```

请记住，Java 使用“按值复制引用”参数传递。因此，更改变量不会更改传递给其他方法的引用副本。

另请注意`JFrame`，可用性的名称非常令人困惑。添加组件或设置布局（通常）在内容窗格上执行操作。奇怪的是，获取布局确实为您提供了框架的布局管理器。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-22T05:16:23.143

希望这段代码能让您了解在 JFrame 中更改 jPanel。

```
public class PanelTest extends JFrame {

        Container contentPane;

        public PanelTest()  {
           super("Changing JPanel inside a JFrame");
           contentPane=getContentPane();
        }

        public void createChangePanel() {
           contentPane.removeAll();
           JPanel newPanel=new JPanel();
           contentPane.add(newPanel);
           System.out.println("new panel created");//for debugging purposes
           validate();
           setVisible(true);
        }
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-21T15:12:16.017

关于用户操作：

// 你必须按照以下方式做一些事情

```
myJFrame.getContentPane().removeAll()
myJFrame.getContentPane().invalidate()

myJFrame.getContentPane().add(newContentPanel)
myJFrame.getContentPane().revalidate() 
```

然后您可以根据需要调整窗口大小。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-20T15:06:37.807

这一切都取决于如何使用它。如果您想在这两个面板之间来回切换，请使用 CardLayout。如果您只是从第一个切换到第二个并且（而不是返回），那么我会使用[telcontar](https://stackoverflow.com/users/518/telcontar)的建议并替换它。虽然如果 JPanel 不是您框架中唯一的东西，我会使用 [remove(java.awt.Component)](http://java.sun.com/javase/6/docs/api/java/awt/Container.html#remove(java.awt.Component))而不是 removeAll。

如果您介于这两种情况之间，则基本上是时空权衡。CardLayout 将节省您的时间，但由于必须始终将整个其他面板保留在内存中而占用更多内存。但是，如果您只是在需要时更换面板并按需构建，则不必保留这些记忆，但切换需要更多时间。

您也可以尝试使用 JTabbedPane 来使用选项卡（它比 CardLayout 更容易，因为它会自动处理显示/隐藏）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-20T13:11:19.893

其他人回答了这个问题。我想建议您使用 JTabbedPane 而不是替换内容。作为一般规则，让应用程序的视觉元素消失或被其他内容替换是不好的。当然，每条规则都有例外，只有您和您的用户社区才能决定最佳方法。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-05-20T07:47:56.717

我遇到了完全相同的问题！不可思议！！我找到的解决方案是：

1.  将所有组件（JPanels）添加到容器中；
2.  对所有这些都使用 setVisible(false) 方法；
3.  在用户操作时，将 setVisible(true) 设置为我想要显示的面板。

```
// Hiding all components (JPanels) added to a container (ex: another JPanel)
for (Component component : this.container.getComponents()) {
      component.setVisible(false);
}
```

```
// Showing only the selected JPanel, the one user wants to see
panel.setVisible(true); 
```

不需要 revalidate()，不需要 validate()，不需要 CardLayout。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-04-23T10:11:57.413

**问题**：我的组件添加到容器后没有出现。

**添加**组件后，您需要调用[revalidate](http://docs.oracle.com/javase/7/docs/api/javax/swing/JComponent.html#revalidate%28%29)和[repaint ，](http://docs.oracle.com/javase/7/docs/api/java/awt/Component.html#repaint%28%29) **然后它才会显示**在您的容器中。

 ****来源：[http ://docs.oracle.com/javase/tutorial/uiswing/layout/problems.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/problems.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-09-11T02:59:12.137

layout.replace() 答案仅在 GroupLayout 管理器上存在/有效。

其他 LayoutManagers（CardLayout、BoxLayout 等）不支持此功能，但需要您先 RemoveLayoutComponent( 然后 AddLayoutComponent( 再次返回。:-) [只是设置记录]

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-06-30T15:31:48.503

```
Game game =  new Game();
getContentPane().removeAll(); 
setContentPane(game);  
getContentPane().revalidate(); //IMPORTANT
getContentPane().repaint();    //IMPORTANT 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-20T13:09:15.873

我建议您在创建框架时添加两个面板，然后通过在两者上调用 setVisible(true/false) 来更改可见面板。调用 setVisible 时，将通知父级并要求重新绘制自己。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-02-26T15:54:26.270

```
class Frame1 extends javax.swing.JFrame {

    remove(previouspanel); //or getContentPane().removeAll();

    add(newpanel); //or setContentPane(newpanel);

    invalidate(); validate(); // or ((JComponent) getContentPane()).revalidate();

    repaint(); //DO NOT FORGET REPAINT

} 
```

有时您可以在不使用重新验证的情况下完成工作，有时不使用重新绘制。我的建议是两者都使用。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-08-09T04:27:00.923

只需在设置, ( ，可能更旧)之后调用方法**pack() ，如下所示：**`ContentPane``java 1.7`

```
JFrame frame = new JFrame();  
JPanel panel1 = new JPanel(); 
JPanel panel2 = new JPanel(); 
....
frame.setContentPane(panel1);
frame.pack();
...

frame.setContentPane(panel2);
frame.pack();
... 
```

# regex - bash 正则表达式带引号？

> ID：218156
> 
> 赞同：79
> 
> 时间：2008-10-20T11:53:59.503
> 
> 标签：regex, bash, quotes

以下代码

```
number=1
if [[ $number =~ [0-9] ]]
then
  echo matched
fi 
```

作品。但是，如果我尝试在正则表达式中使用引号，它会停止：

```
number=1
if [[ $number =~ "[0-9]" ]]
then
  echo matched
fi 
```

我也试过`"\[0-9\]"`了。我错过了什么？

有趣的是，[bash 高级脚本指南](http://www.tldp.org/LDP/abs/html/abs-guide.html#REGEXMATCHREF)建议这应该可行。

重击版本 3.2.39。

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2008-10-20T12:15:12.737

它[在 3.1 和 3.2 之间](http://tiswww.case.edu/php/chet/bash/NEWS)更改。猜猜高级指南需要更新。

> 这是对自 bash-3.1 发布以来添加到 bash-3.2 的新功能的简要描述。与往常一样，手册页 (doc/bash.1) 是查找完整描述的地方。
> 
> 1.  Bash 中的新功能
> 
> 剪断
> 
> F。将字符串参数引用到 [[ 命令的 =~ 运算符现在强制字符串匹配，与其他模式匹配运算符一样。

Sadly this'll break existing quote using scripts unless you had the insight to store patterns in variables and use them instead of the regexes directly. Example below.

```
$ bash --version
GNU bash, version 3.2.39(1)-release (i486-pc-linux-gnu)
Copyright (C) 2007 Free Software Foundation, Inc.
$ number=2
$ if [[ $number =~ "[0-9]" ]]; then echo match; fi
$ if [[ $number =~ [0-9] ]]; then echo match; fi
match
$ re="[0-9]"
$ if [[ $number =~ $re ]]; then echo MATCH; fi
MATCH

$ bash --version
GNU bash, version 3.00.0(1)-release (i586-suse-linux)
Copyright (C) 2004 Free Software Foundation, Inc.
$ number=2
$ if [[ $number =~ "[0-9]" ]]; then echo match; fi
match
$ if [[ "$number" =~ [0-9] ]]; then echo match; fi
match 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2011-06-27T19:00:09.320

Bash 3.2 introduced a compatibility option compat31 which reverts bash regular expression quoting behavior back to 3.1

**Without compat31:**

```
$ shopt -u compat31
$ shopt compat31
compat31        off
$ set -x
$ if [[ "9" =~ "[0-9]" ]]; then echo match; else echo no match; fi
+ [[ 9 =~ \[0-9] ]]
+ echo no match
no match 
```

**With compat31:**

```
$ shopt -s compat31
+ shopt -s compat31
$ if [[ "9" =~ "[0-9]" ]]; then echo match; else echo no match; fi
+ [[ 9 =~ [0-9] ]]
+ echo match
match 
```

Link to patch: [http://ftp.gnu.org/gnu/bash/bash-3.2-patches/bash32-039](http://ftp.gnu.org/gnu/bash/bash-3.2-patches/bash32-039)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-09-10T20:33:17.717

GNU bash, version 4.2.25(1)-release (x86_64-pc-linux-gnu)

Some examples of string match and regex match

```
 $ if [[ 234 =~ "[0-9]" ]]; then echo matches;  fi # string match
    $ 

    $ if [[ 234 =~ [0-9] ]]; then echo matches;  fi # regex natch 
    matches

    $ var="[0-9]"

    $ if [[ 234 =~ $var ]]; then echo matches;  fi # regex match
    matches

    $ if [[ 234 =~ "$var" ]]; then echo matches;  fi # string match after substituting $var as [0-9]

    $ if [[ 'rss$var919' =~ "$var" ]]; then echo matches;  fi   # string match after substituting $var as [0-9]

    $ if [[ 'rss$var919' =~ $var ]]; then echo matches;  fi # regex match after substituting $var as [0-9]
    matches

    $ if [[ "rss\$var919" =~ "$var" ]]; then echo matches;  fi # string match won't work

    $ if [[ "rss\\$var919" =~ "$var" ]]; then echo matches;  fi # string match won't work

    $ if [[ "rss'$var'""919" =~ "$var" ]]; then echo matches;  fi # $var is substituted on LHS & RHS and then string match happens 
    matches

    $ if [[ 'rss$var919' =~ "\$var" ]]; then echo matches;  fi # string match !
    matches

    $ if [[ 'rss$var919' =~ "$var" ]]; then echo matches;  fi # string match failed
    $ 

    $ if [[ 'rss$var919' =~ '$var' ]]; then echo matches;  fi # string match
    matches

    $ echo $var
    [0-9]

    $ 

    $ if [[ abc123def =~ "[0-9]" ]]; then echo matches;  fi

    $ if [[ abc123def =~ [0-9] ]]; then echo matches;  fi
    matches

    $ if [[ 'rss$var919' =~ '$var' ]]; then echo matches;  fi # string match due to single quotes on RHS $var matches $var
    matches

    $ if [[ 'rss$var919' =~ $var ]]; then echo matches;  fi # Regex match 
    matches
    $ if [[ 'rss$var' =~ $var ]]; then echo matches;  fi # Above e.g. really is regex match and not string match
    $

    $ if [[ 'rss$var919[0-9]' =~ "$var" ]]; then echo matches;  fi # string match RHS substituted and then matched
    matches

    $ if [[ 'rss$var919' =~ "'$var'" ]]; then echo matches;  fi # trying to string match '$var' fails

    $ if [[ '$var' =~ "'$var'" ]]; then echo matches;  fi # string match still fails as single quotes are omitted on RHS 

    $ if [[ \'$var\' =~ "'$var'" ]]; then echo matches;  fi # this string match works as single quotes are included now on RHS
    matches 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-02-13T18:34:43.660

As mentioned in other answers, putting the regular expression in a variable is a general way to achieve compatibility over different [bash](/questions/tagged/bash "show questions tagged 'bash'") versions. You may also use this workaround to achieve the same thing, while keeping your regular expression within the conditional expression:

```
$ number=1
$ if [[ $number =~ $(echo "[0-9]") ]]; then echo matched; fi
matched
$ 
```

# html - 样式化水平规则

> ID：218158
> 
> 赞同：4
> 
> 时间：2008-10-20T11:54:26.133
> 
> 标签：html, css

有没有更好的方式`<hr />`使用 CSS 来设置标签样式，即跨浏览器一致并且不涉及环绕`div`它？我正在努力寻找一个。

我发现的最好方法如下：

**CSS**

```
.hr {  
    height:20px;  
    background: #fff url(nice-image.gif) no-repeat scroll center;  
}  
hr {  
    display:none;  
} 
```

**HTML**

```
<div class="hr"><hr /></div> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-20T12:18:01.173

执行此操作的经典方法是在 <hr> 周围创建一个包装器并对其进行样式设置。但是我想出了一个 CSS 技巧来替换元素而不需要额外的标记：

对于非 MSIE 浏览器：

```
hr {
   border : 0;
   height : 15px;
   background : url(hr.gif) 0 0 no-repeat;
   margin : 1em 0;
 } 
```

另外对于 MSIE：

```
hr {
   display : list-item;
   list-style : url(hr.gif) inside;
   filter : alpha(opacity=0);
   width : 0;
} 
```

See [entry on my blog](http://borgar.undraland.com/s/2007/01/style-hr-elements/) for further info and an example of the trick in action.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T11:55:49.157

如果将 display 设置为`block`它应该更像一个`<div>`.

您的答案应该完全删除 hr 并使用`div`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-20T12:10:43.933

您可以将背景图像应用到前一个元素的底部，可能还需要一些额外的填充。这样你就可以摆脱任何多余的/非语义标记。

# css - 你会如何推荐新手开始使用 CSS？

> ID：218161
> 
> 赞同：12
> 
> 时间：2008-10-20T11:55:01.123
> 
> 标签：css

作为使用表格设计网站但从未使用 css 的 web 设计师，新手如何开始使用 css？

* * *

**相关的 SO 帖子**

[SO - CSS 书籍和 CSS 网站](https://stackoverflow.com/questions/2084/can-you-recommend-a-good-css-online-resource-or-book)

[所以 - Css 博客](https://stackoverflow.com/questions/132587/the-best-css-tutorialsiteblogbook)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-20T11:56:45.503

首先阅读教程网站开始。这样，他将看到如何创建简单的 CSS 并看到好处。

*   [http://www.w3schools.com/css/](http://www.w3schools.com/css/)
*   [http://www.echocho.com/css.htm](http://www.echoecho.com/css.htm)
*   [http://www.csstutorial.net/](http://www.csstutorial.net/)
*   [http://www.w3.org/Style/Examples/011/firstcss](http://www.w3.org/Style/Examples/011/firstcss)
*   [http://www.westciv.com/style_master/academy/css_tutorial/](http://www.westciv.com/style_master/academy/css_tutorial/)

比，我建议因为他知道如何设计网站来检查其他网站源并查看他们的 CSS 文件。[禅园](http://www.csszengarden.com/)是一个好的开始。

如果他需要更多信息，他总是可以得到一本书（我认为没有必要，但如果他想要一本书），他可以尝试[Core-Css](http://www.amazon.ca/Core-CSS-Keith-Schengili-Roberts/dp/0130092789)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-20T12:29:11.977

绝对获得 Firefox 的 Firebug 插件。转到您喜欢的网站并查看其 CSS。关闭和打开一些东西，改变一些东西，感受一下它们是如何结合在一起的。很棒的学习工具。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-20T11:58:47.123

阅读Eric A. Meyer[的 CSS：权威指南，第三版](http://oreilly.com/catalog/9780596527334/)。这是我读过的最好的技术书籍之一。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-22T04:29:22.553

我推荐Andy Clarke[的 Transcending CSS: The Fine Art of Web Design](http://www.transcendingcss.com/)。它不是关于 CSS 的技术方面，而是更多关于从基于表格的设计转移到将内容与设计分离时需要发生的思维方式转换。

当我开始学习 CSS 时，我发现自己的编码方式几乎相同。我使用的是 div 和 span，而不是表和 td。仍然从外部（设计）向内（朝向内容）工作，并围绕页面外观设计我的标记和内容，将其锁定在设计中。超越 CSS 进入从内部（内容和标记）到外部（设计）的过程，使网站的外观保持灵活。

技术信息很容易找到。我倾向于经常去 W3Schools。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-20T12:09:08.553

对于所有其他建议，我将添加[Smashing Magazine](http://www.smashingmagazine.com/category/css/)的 CSS 文章列表。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-20T12:12:52.587

我是阅读技术书籍的忠实粉丝，所以我[从《CSS Web 开发入门：从新手到专业人士》中学习](https://rads.stackoverflow.com/amzn/click/com/1590596897)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-20T12:13:10.230

我从[Eric Meyer 的 CSS](http://www.ericmeyeroncss.com/)和[Eric Meyer 的](http://more.ericmeyeroncss.com/)CSS 中学到了很多。这些书将逐步引导您完成几个示例，从无样式的页面开始，并在此过程中解释每个步骤的目的。不过，它们只是一个起点，因为它们有点过时了。[A List Apart](http://www.alistapart.com/)之类的网站将为您提供最新信息。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-20T11:57:06.940

从简单开始。阅读一些网站，例如[A List Apart](http://www.alistapart.com)和[Position Is Everything](http://www.positioniseverything.net)。

不要试图一次更换整个网站 - 一次更换一个。

继续在不同的浏览器中测试它——越早发现它在一个（或全部！）中看起来不同越好。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-20T13:45:27.563

让我开始的书是[Web Standards Solutions: The Markup and Style Handbook。](https://rads.stackoverflow.com/amzn/click/com/1590593812)作者：[Dan Cederholm](http://simplebits.com/)这不是参考，但可以让您从真实世界的示例中开始。丹在握住你的手方面做得很好，慢慢来，不会让你厌烦。几年前我买了它，偶尔还会提到它。

这是我唯一拥有的 CSS 书籍。我使用网络作为我的 CSS 参考。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-22T05:09:49.117

我发现在创建新页面时，首先使用 DreamWeaver 模板是一个很好的起点。他们制作了一些非常简单的模板，可让您添加所需的任何格式，您只需要知道 2 或 3 列或弹性或固定等内容。在我开始这样做之前，我一直在试图弄清楚如何定位东西，但这有很大帮助，至少给了我一个开始。

还可以考虑重置 CSS 文件。它确实有助于处理浏览器的差异。

除此之外，当然还要阅读教程和搜索网络。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-20T22:15:10.670

[http://www.w3.org/Style/CSS/#specs](http://www.w3.org/Style/CSS/#specs)

有人已经列出了 w3c 链接。此链接指向规范，这是我了解我对 CSS 的了解的方式。无论如何，从第 1 级开始，然后进入其他级别。好吧，第 1 级应该可以让您了解您将要使用的大部分内容，因此您可能只想学习第 1 级，然后根据需要搜索您想做的其他事情。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-20T13:16:01.523

对于法语，有一个很好的网站：[http](http://www.alsacreations.com/) ://www.alsacreations.com/有关于 HTML、xHTML 和 CSS 的教程以及许多示例（如何创建“漂亮”菜单等......）

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-20T21:36:13.027

我是蛮力方法的粉丝。学习一些基础知识，然后开始尝试使用纯 CSS 重新编码您的 HTML。每次你需要一种新技术时，谷歌一下。您可能想订阅 CSS 讨论邮件列表或[阅读 wiki](http://css-discuss.incutio.com/)。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-22T05:18:34.047

大多数引用缺少的一个重要概念是 CSS 属性不是独立的或累积的。最重要的属性“显示”和“位置”相互反应，甚至改变其他属性的行为。他们以这样一种方式相互作用，任何试图独立教授这些属性的指南都是失败的。

大多数做 HTML/CSS 的人不理解这一点，并且在没有真正线索的情况下被困在摆弄。

我发现与这些属性完全相关的唯一一本书是“Pro CSS and HTML Design Patterns”。Eric Meyers 的书可能...我个人讨厌“Pro CSS 和 HTML 设计模式”的风格，但它仍然是我发现的最有效的 CSS 指南。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-20T12:03:42.700

SitePoint 有大量的教程和参考资料。他们甚至有一本书听起来可以直接回答你的问题！

HTML Utopia：使用 CSS 进行无表格设计，第 2 版

[http://www.sitepoint.com/books/css2/](http://www.sitepoint.com/books/css2/)

免费提供 4 章

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-20T13:44:39.063

[通过从http://www.oswd.org/](http://www.oswd.org/)下载免费网站设计并尝试自己实现相同的效果，我学到了很多 CSS 。它还让我对 CSS 中的站点范围设计模式的想法有了一些见解。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-22T13:36:30.030

看看[从零开始的网页设计](http://webdesignfromscratch.com/)网站。它对我真的很有用。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-10-27T15:59:11.520

我写了一个[全面的介绍指南，包括其他地方的一些很好的 CSS 链接](https://stackoverflow.com/questions/1612398/what-css-tools-framework-grids-system-ide-do-i-need-for-starting-web-design/1613179#1613179)（也请参阅评论）......可能会有用。

# css - 使用 noscript 嵌入额外的样式

> ID：218162
> 
> 赞同：27
> 
> 时间：2008-10-20T11:55:06.477
> 
> 标签：css, xhtml

我有一个 XHTML 严格页面，它有一个由 Javascript 控制的不可见 div。div 被脚本和 mouseover 事件设置为透明和可见，以使 div 在悬停时不透明。

当有人在没有 javascript 的情况下使用浏览器（或带有 noscript 的 firefox）时，div 将保持不可见。这样做的问题是我不希望内容无法访问。我也不想让 div 可见，然后使用脚本使其透明，因为 div 位于文档的底部，并且每当页面加载时都会导致明显的闪烁。

我曾尝试使用 noscript 标签嵌入一个额外的样式表，该样式表只为没有 Javascript 的奢侈的人加载，但这未通过 XHTML 严格验证。有没有其他方法可以在 XHTML 有效的 noscript 块中包含额外的样式信息？

**编辑：**

通过一个简单的测试用例，我得到一个验证错误：**文档类型不允许元素“样式”在这里。** 这是一个空的 XHTML Strict 文档，在 noscript 元素内有一个 style 元素。noscript 在体内。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-08-26T02:23:15.727

头中的 noscript 是有效的 HTML5。之前是无效的。我刚刚对其进行了测试，它适用于当前的 Firefox、Safari、Chrome、Opera 和 IE。

```
<!doctype html>
<html>
    <head>
        <noscript>
            <style>body{background:red}</style>
        </noscript>
    </head>
    <body>
        <p>is this red? it should <script>document.writeln("not");</script> be. <noscript>indeed.</noscript></p>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-20T15:53:11.800

清除验证问题：`noscript`只允许在`body`元素中，`style`只允许在`head`. 因此，后者不允许在前者之内。

在一般问题上：您希望`div`默认情况下使元素可见，然后通过 CSS + javascript 将其隐藏。这是“渐进增强”模型。我注意到您说您“因为闪烁而不想这样做”，但我不确定是什么原因造成的 - 您可能可以修复它，所以也许您应该将*其*作为问题发布。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-11-21T05:02:23.567

# Note about my answer

I wrote this post after realizing it was dating from 2008

Since I had a similar problem, I thought continuing answering with a current answer.

# My actual answer

Like Boby Jack said, `style` tag is not allowed in body. I myself did the exact thing as you (Joshua) about it. But Jack's "progressive enhancement" made me without non-abstract solution but then I realized a solution that I did not find answers on this thread.

It all depends of your styling structure.

My suggestion is to plainly use something like `modernizr` in the very begining of the head and use Paul Irish's HTML5Boilerplate recommendations.

# Long story short

1.  Html tag has a `class` attributes with `no-js`
2.  Head tag includes a first modernizr javascript as the first
3.  CSS has the element (`.hide-me`) with `display:none` on its proper place
4.  Then `.no-js .hide-me { display:block }`

# In detail

See Paul Irish's HTML5boilerplate, and adapt it to XHTML if you want :)

## 1\. Html has a class attributes with `.no-js`

```
<!doctype html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]--> 
```

quoting from `html5boilerplate.com`

## 2\. Head tag includes a first modernizr javascript as the first

Modernizr execution will build `html` attributes with what's supported.

Will build something similar to this:

```
<html class=" js flexbox canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths" lang="en"> 
```

**Note** this is from Google Chrome `modernizr` tests.

The first is `js` but if Modernizr did not run (no javascript) the `no-js` would stay there.

## 3\. CSS has the element (`.hide-me`) with `display:none` on its proper place

... you know the rest :)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-12-03T16:59:54.283

在 中使用`script`块`head`添加`style`元素`document.write`：

```
<head>
...
 <script type="text/javascript">
 //<![CDATA[
  document.write('<style type="text/css">.noscript{display:none}</style>');
 //]]>
 </script>
...
</head> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-07-15T12:04:34.753

**UPDATE** for **2016**:

From [w3school](http://www.w3schools.com/tags/tag_noscript.asp):

> **Differences Between HTML 4.01 and HTML5**
> 
> In HTML 4.01, `<noscript>` tag can only be used inside the `<body>` element.
> 
> In HTML5, the `<noscript>` tag can be used both inside `<head>` and `<body>`.
> 
> **Differences Between HTML and XHTML**
> 
> In XHTML, the `<noscript>` tag is not supported.

**My solution for having expanded menus (lists, etc..)**

I've put in the header like this

```
<header>
    <noscript>
        <link rel="stylesheet" href="assets/css/x_no_script.css">
    </noscript>
</header> 
```

In the `x_no_script.css` I set the selectors that I wanted to

```
max-height: 9999px;
overflow: visible; 
```

In this way, I have expanded menus when **JavaScript** is **disabled** or not exists.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-20T11:59:38.387

你得到什么验证错误？ `<noscript>`在 XHTML 中应该允许，但它是块级的，所以请确保它不在 a `<p>`,`<span>`等中

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-19T19:41:19.967

In case XHTML is used, the trick is to use two CSS files. One global one and one js-one tweaking the global one for JavaScript-enabled browsers.

style.css:

```
.hidden {
  visibility:hidden;
} 
```

style-js.css:

```
.hidden {
  visibility:visible;
} 
```

test.html:

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" />
  <title>Test page</title>
  <link href='css/style.css' rel='stylesheet' type='text/css' />
  <script type="text/javascript">
  //<![CDATA[
    //document.write("<link href='css/style-js.css' rel='styleSheet' type='text/css' />"); 
    //is not legal in XHTML, we do the long way:
    var l=document.createElementNS("http://www.w3.org/1999/xhtml","link");
    l.setAttribute("rel", "stylesheet");
    l.setAttribute("type", "text/css");
    l.setAttribute("href", "/css/style-js.css");
    document.getElementsByTagName("head")[0].appendChild(l);
  //]]>
  </script>
</head>
<body>
  <div class="hidden">
    <p>Only displayed at JavaScript enabled browsers</p>
  </div>
</body>
</html> 
```

Main idea by [tutorials.de](http://www.tutorials.de/html-xhtml/252863-style-im-noscript-tag-nicht-valide.html). XHTML validity tip by [Estelle Weyl's Blog](http://www.evotech.net/blog/2007/05/including-javascript-in-xhtml/). createElementNS tip by [CodingForums](http://www.codingforums.com/showpost.php?s=41fd8825d2f084665736b5c71967ca5f&p=67618&postcount=7).

# php - 组合php数组

> ID：218174
> 
> 赞同：4
> 
> 时间：2008-10-20T11:59:14.597
> 
> 标签：php, arrays

我在 PHP 中有以下数组（好吧，它们有点大，但想法很重要）。

```
$array1 = array(1 => 'a', 2 => 'b');
$array2 = array(3 => 'c', 4 => 'd'); 
```

本质上我想组合这两个数组，就好像它是这样的

```
$array3 = array(1 => 'a', 2 => 'b', 3 => 'c', 4 => 'd'); 
```

谢谢

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-10-20T12:04:43.040

采用

```
$array3 = $array1 + $array2; 
```

请参阅[数组运算符](http://de3.php.net/manual/en/language.operators.array.php)

顺便说一句：[array_merge()](http://de3.php.net/array_merge)与示例中给出的数组不同：

```
$a1=array(1 => 'a', 2 => 'b');
$a2=array(3 => 'c', 4 => 'd');
print_r($a1+$a2);
Array
(
    [1] => a
    [2] => b
    [3] => c
    [4] => d
)
print_r(array_merge($a1, $a2));
Array
(
    [0] => a
    [1] => b
    [2] => c
    [3] => d
) 
```

注意不同的索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-15T13:39:16.373

您可以检查 array_combine 功能。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2008-10-20T15:25:40.683

array_merge 只保留 STRING 键。您必须为此编写函数

# rhino-mocks - Rhino Mocks 可以为我编写期望语句吗？

> ID：218180
> 
> 赞同：0
> 
> 时间：2008-10-20T12:00:25.857
> 
> 标签：rhino-mocks

我有一组与远程数据库对话的 Visual Studio Team System 单元（真正的集成）测试。测试变得太慢和笨重。我想用模拟版本替换整个测试集。问题是编写所有模仿整个数据库的期望语句是很痛苦的。

有谁知道将运行现有测试的工具或附加组件，找出非模拟版本实际返回的内容并写出 Expect.Call 以复制功能？我知道这是一个很长的机会，但我觉得这应该是可能的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-26T20:55:12.453

好的，最后我自己写了。这是博客文章概述：

[写我的犀牛模拟期望声明](http://rapidapplicationdevelopment.blogspot.com/2008/11/write-my-rhino-mocks-expect-statement.html)

这是 CodePlex 项目：

[写我的期望语句](http://www.codeplex.com/WriteMyExpect)

希望这可以帮助某个地方的人。

# excel - 如何在 Excel VBA 中对字符串进行 URL 编码？

> ID：218181
> 
> 赞同：78
> 
> 时间：2008-10-20T12:00:42.190
> 
> 标签：excel, vba, url, encoding, urlencode

是否有内置方法可以在 Excel VBA 中对字符串进行 URL 编码，还是我需要手动滚动此功能？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2008-10-20T12:05:13.867

不，没有任何内置功能（*直到 Excel 2013 -[请参阅此答案](https://stackoverflow.com/a/24301379/18771)*）。

这个答案有三个版本`URLEncode()`。

*   支持 UTF-8 的函数。为了与现代需求兼容，**您可能应该使用这个**（或Tom[的替代实现）。](https://stackoverflow.com/a/3812363/18771)
*   出于参考和教育目的，不支持 UTF-8 的两个函数：
    *   在第三方网站上找到的，按原样包含在内。（这是答案的第一个版本）
    *   一个优化版本，由我编写

* * *

支持 UTF-8 编码并基于`ADODB.Stream`（包括对项目中最新版本的“Microsoft ActiveX 数据对象”库的引用）的变体：

```
Public Function URLEncode( _
   ByVal StringVal As String, _
   Optional SpaceAsPlus As Boolean = False _
) As String
  Dim bytes() As Byte, b As Byte, i As Integer, space As String

  If SpaceAsPlus Then space = "+" Else space = "%20"

  If Len(StringVal) > 0 Then
    With New ADODB.Stream
      .Mode = adModeReadWrite
      .Type = adTypeText
      .Charset = "UTF-8"
      .Open
      .WriteText StringVal
      .Position = 0
      .Type = adTypeBinary
      .Position = 3 ' skip BOM
      bytes = .Read
    End With

    ReDim result(UBound(bytes)) As String

    For i = UBound(bytes) To 0 Step -1
      b = bytes(i)
      Select Case b
        Case 97 To 122, 65 To 90, 48 To 57, 45, 46, 95, 126
          result(i) = Chr(b)
        Case 32
          result(i) = space
        Case 0 To 15
          result(i) = "%0" & Hex(b)
        Case Else
          result(i) = "%" & Hex(b)
      End Select
    Next i

    URLEncode = Join(result, "")
  End If
End Function 
```

* * *

这个函数是[在 freevbcode.com 上找到的](http://www.freevbcode.com/ShowCode.asp?ID=1512)：

```
Public Function URLEncode( _
   StringToEncode As String, _
   Optional UsePlusRatherThanHexForSpace As Boolean = False _
) As String

  Dim TempAns As String
  Dim CurChr As Integer
  CurChr = 1

  Do Until CurChr - 1 = Len(StringToEncode)
    Select Case Asc(Mid(StringToEncode, CurChr, 1))
      Case 48 To 57, 65 To 90, 97 To 122
        TempAns = TempAns & Mid(StringToEncode, CurChr, 1)
      Case 32
        If UsePlusRatherThanHexForSpace = True Then
          TempAns = TempAns & "+"
        Else
          TempAns = TempAns & "%" & Hex(32)
        End If
      Case Else
        TempAns = TempAns & "%" & _
          Right("0" & Hex(Asc(Mid(StringToEncode, _
          CurChr, 1))), 2)
    End Select

    CurChr = CurChr + 1
  Loop

  URLEncode = TempAns
End Function 
```

*我已经纠正了那里的一个小错误。*

* * *

我会使用上述更高效（约 2 倍）的版本：

```
Public Function URLEncode( _
   StringVal As String, _
   Optional SpaceAsPlus As Boolean = False _
) As String

  Dim StringLen As Long: StringLen = Len(StringVal)

  If StringLen > 0 Then
    ReDim result(StringLen) As String
    Dim i As Long, CharCode As Integer
    Dim Char As String, Space As String

    If SpaceAsPlus Then Space = "+" Else Space = "%20"

    For i = 1 To StringLen
      Char = Mid$(StringVal, i, 1)
      CharCode = Asc(Char)
      Select Case CharCode
        Case 97 To 122, 65 To 90, 48 To 57, 45, 46, 95, 126
          result(i) = Char
        Case 32
          result(i) = Space
        Case 0 To 15
          result(i) = "%0" & Hex(CharCode)
        Case Else
          result(i) = "%" & Hex(CharCode)
      End Select
    Next i
    URLEncode = Join(result, "")
  End If
End Function 
```

请注意，这两个函数都不支持 UTF-8 编码。

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2014-06-19T07:47:55.113

为了更新这一点，从 Excel 2013 开始，现在有一种使用工作表函数对 URL 进行编码的内置方法`ENCODEURL`。

要在您的 VBA 代码中使用它，您只需调用

```
EncodedUrl = WorksheetFunction.EncodeUrl(InputString) 
```

[文档](https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.encodeurl)

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2010-09-28T11:48:45.427

以上支持UTF8的版本：

```
Private Const CP_UTF8 = 65001

#If VBA7 Then
  Private Declare PtrSafe Function WideCharToMultiByte Lib "kernel32" ( _
    ByVal CodePage As Long, _
    ByVal dwFlags As Long, _
    ByVal lpWideCharStr As LongPtr, _
    ByVal cchWideChar As Long, _
    ByVal lpMultiByteStr As LongPtr, _
    ByVal cbMultiByte As Long, _
    ByVal lpDefaultChar As Long, _
    ByVal lpUsedDefaultChar As Long _
    ) As Long
#Else
  Private Declare Function WideCharToMultiByte Lib "kernel32" ( _
    ByVal CodePage As Long, _
    ByVal dwFlags As Long, _
    ByVal lpWideCharStr As Long, _
    ByVal cchWideChar As Long, _
    ByVal lpMultiByteStr As Long, _
    ByVal cbMultiByte As Long, _
    ByVal lpDefaultChar As Long, _
    ByVal lpUsedDefaultChar As Long _
    ) As Long
#End If

Public Function UTF16To8(ByVal UTF16 As String) As String
Dim sBuffer As String
Dim lLength As Long
If UTF16 <> "" Then
    #If VBA7 Then
        lLength = WideCharToMultiByte(CP_UTF8, 0, CLngPtr(StrPtr(UTF16)), -1, 0, 0, 0, 0)
    #Else
        lLength = WideCharToMultiByte(CP_UTF8, 0, StrPtr(UTF16), -1, 0, 0, 0, 0)
    #End If
    sBuffer = Space$(lLength)
    #If VBA7 Then
        lLength = WideCharToMultiByte(CP_UTF8, 0, CLngPtr(StrPtr(UTF16)), -1, CLngPtr(StrPtr(sBuffer)), LenB(sBuffer), 0, 0)
    #Else
        lLength = WideCharToMultiByte(CP_UTF8, 0, StrPtr(UTF16), -1, StrPtr(sBuffer), LenB(sBuffer), 0, 0)
    #End If
    sBuffer = StrConv(sBuffer, vbUnicode)
    UTF16To8 = Left$(sBuffer, lLength - 1)
Else
    UTF16To8 = ""
End If
End Function

Public Function URLEncode( _
   StringVal As String, _
   Optional SpaceAsPlus As Boolean = False, _
   Optional UTF8Encode As Boolean = True _
) As String

Dim StringValCopy As String: StringValCopy = IIf(UTF8Encode, UTF16To8(StringVal), StringVal)
Dim StringLen As Long: StringLen = Len(StringValCopy)

If StringLen > 0 Then
    ReDim Result(StringLen) As String
    Dim I As Long, CharCode As Integer
    Dim Char As String, Space As String

  If SpaceAsPlus Then Space = "+" Else Space = "%20"

  For I = 1 To StringLen
    Char = Mid$(StringValCopy, I, 1)
    CharCode = Asc(Char)
    Select Case CharCode
      Case 97 To 122, 65 To 90, 48 To 57, 45, 46, 95, 126
        Result(I) = Char
      Case 32
        Result(I) = Space
      Case 0 To 15
        Result(I) = "%0" & Hex(CharCode)
      Case Else
        Result(I) = "%" & Hex(CharCode)
    End Select
  Next I
  URLEncode = Join(Result, "")

End If
End Function 
```

享受！

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2012-08-28T11:13:07.090

虽然，这个很老了。我提出了一个基于[此](https://stackoverflow.com/a/7300926/696632)答案的解决方案：

```
Dim ScriptEngine As ScriptControl
Set ScriptEngine = New ScriptControl
ScriptEngine.Language = "JScript"

ScriptEngine.AddCode "function encode(str) {return encodeURIComponent(str);}"
Dim encoded As String
encoded = ScriptEngine.Run("encode", "€ömE.sdfds") 
```

添加 Microsoft Script Control 作为参考，您就完成了。

顺便说一句，由于 JS 部分，这是完全兼容 UTF-8 的。VB 将正确地从 UTF-16 转换为 UTF-8。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2015-03-08T07:10:03.267

类似于 Michael-O 的代码，只是不需要引用（后期绑定），并且少了一行。
* 我读到，在 excel 2013 中它可以更容易地完成，如下所示：WorksheetFunction.EncodeUrl(InputString)

```
Public Function encodeURL(str As String)
    Dim ScriptEngine As Object
    Dim encoded As String

    Set ScriptEngine = CreateObject("scriptcontrol")
    ScriptEngine.Language = "JScript"

    encoded = ScriptEngine.Run("encodeURIComponent", str)

    encodeURL = encoded
End Function 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2013-01-24T07:22:38.420

由于 office 2013[在这里](https://stackoverflow.com/a/24301379/334106)使用此内置功能。

如果在办公室 2013 之前

```
Function encodeURL(str As String)
Dim ScriptEngine As ScriptControl
Set ScriptEngine = New ScriptControl
ScriptEngine.Language = "JScript"

ScriptEngine.AddCode "function encode(str) {return encodeURIComponent(str);}"
Dim encoded As String

encoded = ScriptEngine.Run("encode", str)
encodeURL = encoded
End Function 
```

添加 Microsoft Script Control 作为参考，您就完成了。

与上一篇文章相同，只是完成了功能..有效！

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-01-04T22:28:43.123

通过`htmlfile`ActiveX 的另一种解决方案：

```
Function EncodeUriComponent(strText)
    Static objHtmlfile As Object
    If objHtmlfile Is Nothing Then
        Set objHtmlfile = CreateObject("htmlfile")
        objHtmlfile.parentWindow.execScript "function encode(s) {return encodeURIComponent(s)}", "jscript"
    End If
    EncodeUriComponent = objHtmlfile.parentWindow.encode(strText)
End Function 
```

将 DOM 文档对象声明`htmlfile`为静态变量会在第一次调用时由于 init 而产生唯一的小延迟，并使此函数对于许多调用来说非常快，例如，对我来说，它在大约 2 秒内将 100 个字符长度的字符串转换 100000 次。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-06-11T20:49:10.877

（碰到一个旧线程）。只是为了好玩，这是一个使用指针组合结果字符串的版本。它大约是接受答案中更快的第二个版本的 2 倍 - 4 倍。

```
Public Declare PtrSafe Sub Mem_Copy Lib "kernel32" _
    Alias "RtlMoveMemory" (ByRef Destination As Any, ByRef Source As Any, ByVal Length As Long)

Public Declare PtrSafe Sub Mem_Read2 Lib "msvbvm60" _
    Alias "GetMem2" (ByRef Source As Any, ByRef Destination As Any)

Public Function URLEncodePart(ByRef RawURL As String) As String

    Dim pChar As LongPtr, iChar As Integer, i As Long
    Dim strHex As String, pHex As LongPtr
    Dim strOut As String, pOut As LongPtr
    Dim pOutStart As LongPtr, pLo As LongPtr, pHi As LongPtr
    Dim lngLength As Long
    Dim cpyLength As Long
    Dim iStart As Long

    pChar = StrPtr(RawURL)
    If pChar = 0 Then Exit Function

    lngLength = Len(RawURL)
    strOut = Space(lngLength * 3)
    pOut = StrPtr(strOut)
    pOutStart = pOut
    strHex = "0123456789ABCDEF"
    pHex = StrPtr(strHex)

    iStart = 1
    For i = 1 To lngLength
        Mem_Read2 ByVal pChar, iChar
        Select Case iChar
            Case 97 To 122, 65 To 90, 48 To 57, 45, 46, 95, 126
              ' Ok
            Case Else
                If iStart < i Then
                    cpyLength = (i - iStart) * 2
                    Mem_Copy ByVal pOut, ByVal pChar - cpyLength, cpyLength
                    pOut = pOut + cpyLength
                End If

                pHi = pHex + ((iChar And &HF0) / 8)
                pLo = pHex + 2 * (iChar And &HF)

                Mem_Read2 37, ByVal pOut
                Mem_Read2 ByVal pHi, ByVal pOut + 2
                Mem_Read2 ByVal pLo, ByVal pOut + 4
                pOut = pOut + 6

                iStart = i + 1
        End Select
        pChar = pChar + 2
    Next

    If iStart <= lngLength Then
        cpyLength = (lngLength - iStart + 1) * 2
        Mem_Copy ByVal pOut, ByVal pChar - cpyLength, cpyLength
        pOut = pOut + cpyLength
    End If

    URLEncodePart = Left$(strOut, (pOut - pOutStart) / 2)

End Function 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-03-27T00:06:42.730

`WorksheetFunction.EncodeUrl`与 UTF-8 支持相同：

```
Public Function EncodeURL(url As String) As String
  Dim buffer As String, i As Long, c As Long, n As Long
  buffer = String$(Len(url) * 12, "%")

  For i = 1 To Len(url)
    c = AscW(Mid$(url, i, 1)) And 65535

    Select Case c
      Case 48 To 57, 65 To 90, 97 To 122, 45, 46, 95  ' Unescaped 0-9A-Za-z-._ '
        n = n + 1
        Mid$(buffer, n) = ChrW(c)
      Case Is <= 127            ' Escaped UTF-8 1 bytes U+0000 to U+007F '
        n = n + 3
        Mid$(buffer, n - 1) = Right$(Hex$(256 + c), 2)
      Case Is <= 2047           ' Escaped UTF-8 2 bytes U+0080 to U+07FF '
        n = n + 6
        Mid$(buffer, n - 4) = Hex$(192 + (c \ 64))
        Mid$(buffer, n - 1) = Hex$(128 + (c Mod 64))
      Case 55296 To 57343       ' Escaped UTF-8 4 bytes U+010000 to U+10FFFF '
        i = i + 1
        c = 65536 + (c Mod 1024) * 1024 + (AscW(Mid$(url, i, 1)) And 1023)
        n = n + 12
        Mid$(buffer, n - 10) = Hex$(240 + (c \ 262144))
        Mid$(buffer, n - 7) = Hex$(128 + ((c \ 4096) Mod 64))
        Mid$(buffer, n - 4) = Hex$(128 + ((c \ 64) Mod 64))
        Mid$(buffer, n - 1) = Hex$(128 + (c Mod 64))
      Case Else                 ' Escaped UTF-8 3 bytes U+0800 to U+FFFF '
        n = n + 9
        Mid$(buffer, n - 7) = Hex$(224 + (c \ 4096))
        Mid$(buffer, n - 4) = Hex$(128 + ((c \ 64) Mod 64))
        Mid$(buffer, n - 1) = Hex$(128 + (c Mod 64))
    End Select
  Next

  EncodeURL = Left$(buffer, n)
End Function 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2020-03-02T13:42:04.827

接受的答案的代码因 Access 2013 中的 Unicode 错误而停止，因此我为自己编写了一个具有高可读性的函数，根据[Davis Peixoto应该遵循](https://www.php.net/manual/en/function.urlencode.php#97969)[RFC 3986](https://datatracker.ietf.org/doc/rfc3986/)，并在各种环境中造成最小的麻烦。

注意：必须先替换百分号本身，否则它将对任何先前编码的字符进行双重编码。添加了用 + 替换空格，不是为了符合 RFC 3986，而是为了提供不会因格式化而中断的链接。它是可选的。

```
Public Function URLEncode(str As Variant) As String
    Dim i As Integer, sChar() As String, sPerc() As String
    sChar = Split("%|!|*|'|(|)|;|:|@|&|=|+|$|,|/|?|#|[|]| ", "|")
    sPerc = Split("%25 %21 %2A %27 %28 %29 %3B %3A %40 %26 %3D %2B %24 %2C %2F %3F %23 %5B %5D +", " ")
    URLEncode = Nz(str)
    For i = 0 To 19
        URLEncode = Replace(URLEncode, sChar(i), sPerc(i))
    Next i
End Function 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-03-06T11:26:03.437

如果您还希望它在 MacO 上工作，请创建一个单独的函数

```
Function macUriEncode(value As String) As String

    Dim script As String
    script = "do shell script " & """/usr/bin/python -c 'import sys, urllib; print urllib.quote(sys.argv[1])' """ & Chr(38) & " quoted form of """ & value & """"

    macUriEncode = MacScript(script)

End Function 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-09-16T14:36:11.840

我在将西里尔字母编码为 URF-8 时遇到问题。

我修改了上述脚本之一以匹配西里尔字符映射。实施的是西里尔字母部分

[https://en.wikipedia.org/wiki/UTF-8](https://en.wikipedia.org/wiki/UTF-8) 和 [http://www.utf8-chartable.de/unicode-utf8-table.pl?start=1024](http://www.utf8-chartable.de/unicode-utf8-table.pl?start=1024)

其他部分开发是示例，需要使用真实数据进行验证并计算字符图偏移量

这是脚本：

```
Public Function UTF8Encode( _
   StringToEncode As String, _
   Optional UsePlusRatherThanHexForSpace As Boolean = False _
) As String

  Dim TempAns As String
  Dim TempChr As Long
  Dim CurChr As Long
  Dim Offset As Long
  Dim TempHex As String
  Dim CharToEncode As Long
  Dim TempAnsShort As String

  CurChr = 1

  Do Until CurChr - 1 = Len(StringToEncode)
    CharToEncode = Asc(Mid(StringToEncode, CurChr, 1))
' http://www.utf8-chartable.de/unicode-utf8-table.pl?start=1024
' as per https://en.wikipedia.org/wiki/UTF-8 specification the engoding is as follows

    Select Case CharToEncode
'   7   U+0000 U+007F 1 0xxxxxxx
      Case 48 To 57, 65 To 90, 97 To 122
        TempAns = TempAns & Mid(StringToEncode, CurChr, 1)
      Case 32
        If UsePlusRatherThanHexForSpace = True Then
          TempAns = TempAns & "+"
        Else
          TempAns = TempAns & "%" & Hex(32)
        End If
      Case 0 To &H7F
            TempAns = TempAns + "%" + Hex(CharToEncode And &H7F)
      Case &H80 To &H7FF
'   11  U+0080 U+07FF 2 110xxxxx 10xxxxxx
' The magic is in offset calculation... there are different offsets between UTF-8 and Windows character maps
' offset 192 = &HC0 = 1100 0000 b  added to start of UTF-8 cyrillic char map at &H410
          CharToEncode = CharToEncode - 192 + &H410
          TempAnsShort = "%" & Right("0" & Hex((CharToEncode And &H3F) Or &H80), 2)
          TempAnsShort = "%" & Right("0" & Hex(((CharToEncode \ &H40) And &H1F) Or &HC0), 2) & TempAnsShort
          TempAns = TempAns + TempAnsShort

'' debug and development version
''          CharToEncode = CharToEncode - 192 + &H410
''          TempChr = (CharToEncode And &H3F) Or &H80
''          TempHex = Hex(TempChr)
''          TempAnsShort = "%" & Right("0" & TempHex, 2)
''          TempChr = ((CharToEncode And &H7C0) / &H40) Or &HC0
''          TempChr = ((CharToEncode \ &H40) And &H1F) Or &HC0
''          TempHex = Hex(TempChr)
''          TempAnsShort = "%" & Right("0" & TempHex, 2) & TempAnsShort
''          TempAns = TempAns + TempAnsShort

      Case &H800 To &HFFFF
'   16 U+0800 U+FFFF 3 1110xxxx 10xxxxxx 10xxxxxx
' not tested . Doesnot match Case condition... very strange
        MsgBox ("Char to encode  matched U+0800 U+FFFF: " & CharToEncode & " = &H" & Hex(CharToEncode))
''          CharToEncode = CharToEncode - 192 + &H410
          TempAnsShort = "%" & Right("0" & Hex((CharToEncode And &H3F) Or &H80), 2)
          TempAnsShort = "%" & Right("0" & Hex(((CharToEncode \ &H40) And &H3F) Or &H80), 2) & TempAnsShort
          TempAnsShort = "%" & Right("0" & Hex(((CharToEncode \ &H1000) And &HF) Or &HE0), 2) & TempAnsShort
          TempAns = TempAns + TempAnsShort

      Case &H10000 To &H1FFFFF
'   21 U+10000 U+1FFFFF 4 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx
''        MsgBox ("Char to encode  matched &H10000 &H1FFFFF: " & CharToEncode & " = &H" & Hex(CharToEncode))
' sample offset. tobe verified
          CharToEncode = CharToEncode - 192 + &H410
          TempAnsShort = "%" & Right("0" & Hex((CharToEncode And &H3F) Or &H80), 2)
          TempAnsShort = "%" & Right("0" & Hex(((CharToEncode \ &H40) And &H3F) Or &H80), 2) & TempAnsShort
          TempAnsShort = "%" & Right("0" & Hex(((CharToEncode \ &H1000) And &H3F) Or &H80), 2) & TempAnsShort
          TempAnsShort = "%" & Right("0" & Hex(((CharToEncode \ &H40000) And &H7) Or &HF0), 2) & TempAnsShort
          TempAns = TempAns + TempAnsShort

      Case &H200000 To &H3FFFFFF
'   26  U+200000 U+3FFFFFF 5 111110xx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx
''        MsgBox ("Char to encode  matched U+200000 U+3FFFFFF: " & CharToEncode & " = &H" & Hex(CharToEncode))
' sample offset. tobe verified
          CharToEncode = CharToEncode - 192 + &H410
          TempAnsShort = "%" & Right("0" & Hex((CharToEncode And &H3F) Or &H80), 2)
          TempAnsShort = "%" & Right("0" & Hex(((CharToEncode \ &H40) And &H3F) Or &H80), 2) & TempAnsShort
          TempAnsShort = "%" & Right("0" & Hex(((CharToEncode \ &H1000) And &H3F) Or &H80), 2) & TempAnsShort
          TempAnsShort = "%" & Right("0" & Hex(((CharToEncode \ &H40000) And &H3F) Or &H80), 2) & TempAnsShort
          TempAnsShort = "%" & Right("0" & Hex(((CharToEncode \ &H1000000) And &H3) Or &HF8), 2) & TempAnsShort
          TempAns = TempAns + TempAnsShort

      Case &H4000000 To &H7FFFFFFF
'   31  U+4000000 U+7FFFFFFF 6 1111110x 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx 10xxxxxx
''        MsgBox ("Char to encode  matched U+4000000 U+7FFFFFFF: " & CharToEncode & " = &H" & Hex(CharToEncode))
' sample offset. tobe verified
          CharToEncode = CharToEncode - 192 + &H410
          TempAnsShort = "%" & Right("0" & Hex((CharToEncode And &H3F) Or &H80), 2)
          TempAnsShort = "%" & Right("0" & Hex(((CharToEncode \ &H40) And &H3F) Or &H80), 2) & TempAnsShort
          TempAnsShort = "%" & Right("0" & Hex(((CharToEncode \ &H1000) And &H3F) Or &H80), 2) & TempAnsShort
          TempAnsShort = "%" & Right("0" & Hex(((CharToEncode \ &H40000) And &H3F) Or &H80), 2) & TempAnsShort
          TempAnsShort = "%" & Right("0" & Hex(((CharToEncode \ &H1000000) And &H3F) Or &H80), 2) & TempAnsShort
          TempAnsShort = "%" & Right("0" & Hex(((CharToEncode \ &H40000000) And &H1) Or &HFC), 2) & TempAnsShort
          TempAns = TempAns + TempAnsShort

      Case Else
' somethig else
' to be developped
        MsgBox ("Char to encode not matched: " & CharToEncode & " = &H" & Hex(CharToEncode))

    End Select

    CurChr = CurChr + 1
  Loop

  UTF8Encode = TempAns
End Function 
```

祝你好运！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-11-05T05:48:52.747

我在我的应用程序中使用了这个片段来对 URL 进行编码，所以这可以帮助你做同样的事情。

```
Function URLEncode(ByVal str As String) As String
        Dim intLen As Integer
        Dim x As Integer
        Dim curChar As Long
        Dim newStr As String
        intLen = Len(str)
        newStr = ""

        For x = 1 To intLen
            curChar = Asc(Mid$(str, x, 1))

            If (curChar < 48 Or curChar > 57) And _
                (curChar < 65 Or curChar > 90) And _
                (curChar < 97 Or curChar > 122) Then
                                newStr = newStr & "%" & Hex(curChar)
            Else
                newStr = newStr & Chr(curChar)
            End If
        Next x

        URLEncode = newStr
    End Function 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-07-14T23:30:16.233

这里没有一个解决方案对我有用，但这很可能是由于我缺乏 VBA 经验。也可能是因为我只是复制并粘贴了上面的一些函数，不知道使它们在 VBA 应用程序环境中工作可能需要的细节。

我的需要只是使用包含一些挪威语言特殊字符的 url 发送 xmlhttp 请求。上面的一些解决方案甚至对冒号进行了编码，这使得网址不适合我需要的内容。

然后我决定编写自己的 URLEncode 函数。它不使用更聪明的编程，例如来自@ndd 和@Tom 的编程。我不是一个非常有经验的程序员，但我必须尽快完成这项工作。

我意识到问题在于我的服务器不接受 UTF-16 编码，所以我必须编写一个将 UTF-16 转换为 UTF-8 的函数。[在这里](http://scripts.sil.org/cms/scripts/page.php?site_id=nrsi&id=iws-appendixa)和[这里](https://stackoverflow.com/questions/6240055/manually-converting-unicode-codepoints-into-utf-8-and-utf-16)找到了一个很好的信息来源。

我没有对它进行广泛的测试以检查它是否适用于具有更高 unicode 值的字符的 url，并且会产生超过 2 个字节的 utf-8 字符。我并不是说它会解码所有需要解码的东西（但很容易修改以在`select case`语句中包含/排除字符），也不是说它可以处理更高的字符，因为我还没有完全测试过。但我分享代码是因为它可能会帮助那些试图理解这个问题的人。

欢迎任何意见。

```
Public Function URL_Encode(ByVal st As String) As String

    Dim eachbyte() As Byte
    Dim i, j As Integer 
    Dim encodeurl As String
    encodeurl = "" 

    eachbyte() = StrConv(st, vbFromUnicode)

    For i = 0 To UBound(eachbyte)

        Select Case eachbyte(i)
        Case 0
        Case 32
            encodeurl = encodeurl & "%20"

        ' I am not encoding the lower parts, not necessary for me
        Case 1 To 127
            encodeurl = encodeurl & Chr(eachbyte(i))
        Case Else

            Dim myarr() As Byte
            myarr = utf16toutf8(eachbyte(i))
            For j = LBound(myarr) To UBound(myarr) - 1
                encodeurl = encodeurl & "%" & Hex(myarr(j))
            Next j
        End Select
    Next i
    URL_Encode = encodeurl 
End Function

Public Function utf16toutf8(ByVal thechars As Variant) As Variant
    Dim numbytes As Integer
    Dim byte1 As Byte
    Dim byte2 As Byte
    Dim byte3 As Byte
    Dim byte4 As Byte
    Dim byte5 As Byte 
    Dim i As Integer  
    Dim temp As Variant
    Dim stri As String

    byte1 = 0
    byte2 = byte3 = byte4 = byte5 = 128

    ' Test to see how many bytes the utf-8 char will need
    Select Case thechars
        Case 0 To 127
            numbytes = 1
        Case 128 To 2047
            numbytes = 2
        Case 2048 To 65535
            numbytes = 3
        Case 65536 To 2097152
            numbytes = 4
        Case Else
            numbytes = 5
    End Select

    Dim returnbytes() As Byte
    ReDim returnbytes(numbytes)

    If numbytes = 1 Then
        returnbytes(0) = thechars
        GoTo finish
    End If

    ' prepare the first byte
    byte1 = 192

    If numbytes > 2 Then
        For i = 3 To numbytes
            byte1 = byte1 / 2
            byte1 = byte1 + 128
        Next i
    End If
    temp = 0
    stri = ""
    If numbytes = 5 Then
        temp = thechars And 63

        byte5 = temp + 128
        returnbytes(4) = byte5
        thechars = thechars / 12
        stri = byte5
    End If

    If numbytes >= 4 Then

        temp = 0
        temp = thechars And 63
        byte4 = temp + 128
        returnbytes(3) = byte4
        thechars = thechars / 12
        stri = byte4 & stri
    End If

    If numbytes >= 3 Then

        temp = 0
        temp = thechars And 63
        byte3 = temp + 128
        returnbytes(2) = byte3
        thechars = thechars / 12
        stri = byte3 & stri
    End If

    If numbytes >= 2 Then

        temp = 0
        temp = thechars And 63
        byte2 = temp Or 128
        returnbytes(1) = byte2
        thechars = Int(thechars / (2 ^ 6))
        stri = byte2 & stri
    End If

    byte1 = thechars Or byte1
    returnbytes(0) = byte1

    stri = byte1 & stri

    finish:
       utf16toutf8 = returnbytes()
End Function 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-11-13T23:49:46.770

VBA-tools 库有一个功能：

[http://vba-tools.github.io/VBA-Web/docs/#/WebHelpers/UrlEncode](http://vba-tools.github.io/VBA-Web/docs/#/WebHelpers/UrlEncode)

它似乎与`encodeURIComponent()`JavaScript 类似。

# eclipse - 如何在 eclipse diff 中忽略 CVS 关键字标签

> ID：218189
> 
> 赞同：10
> 
> 时间：2008-10-20T12:02:54.870
> 
> 标签：eclipse, cvs

尽管我很喜欢 eclipse diff/merge 视角，但在处理大型项目和需要偶尔合并的多个分支时，会缺少一个功能：

有什么方法可以设置 Eclipse 差异以忽略 CVS 标签，如*$Author:$*、*$Revision:$*等？

由于这些标签在所有分支中都是不同的，因此“与另一个分支比较”总是会导致数百个文件显示出不同的标签，但代码中没有明显的差异。（当然，标签只有在修复了分支和头部的几百个文件中的错误之后才会有所不同。但是在我工作的地方经常发生这种情况。请不要对此发表评论。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-20T21:16:29.650

这似乎是一个[已知的错误](https://bugs.eclipse.org/bugs/show_bug.cgi?id=36436)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-14T13:13:20.903

另一方面，在您的 SCM 中使用关键字扩展可能被认为是过时的过程。[这里](http://wordaligned.org/articles/keyword-substitution-just-say-no)有一些令人信服的论点。

# database - 函数到关系映射比对象到关系更容易吗？

> ID：218190
> 
> 赞同：20
> 
> 时间：2008-10-20T12:02:55.523
> 
> 标签：database, orm, functional-programming, rdbms

对象关系映射已得到很好的讨论，包括在这里。我有一些方法以及陷阱和妥协的经验。真正的解决似乎需要对 OO 或关系模型本身进行更改。

如果使用函数式语言，是否会出现同样的问题？在我看来，这两种范式应该比 OO 和 RDBMS 更好地结合在一起。在 RDBMS 中以集合方式思考的想法似乎与函数式方法所承诺的自动并行性相吻合。

有没有人有任何有趣的意见或见解？行业现状如何？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2018-10-09T09:32:35.567

### ORM 的目的是什么？

使用 ORM 的主要目的是在网络模型（面向对象、图等）和关系模型之间架起一座桥梁。两种模型之间的主要区别非常简单。是父母指向孩子（网络模型）还是孩子指向父母（关系模型）。

考虑到这种简单性，我相信两个模型之间[不存在“阻抗不匹配”之类的东西。](https://blog.jooq.org/2015/08/26/there-is-no-such-thing-as-object-relational-impedance-mismatch/)人们通常遇到的问题纯粹是特定于实现的，如果在客户端和服务器之间有更好的数据传输协议，应该是可以解决的。

### SQL 如何解决我们在使用 ORM 时遇到的问题？

特别是，[第三个宣言](https://en.wikipedia.org/wiki/The_Third_Manifesto)试图通过允许嵌套集合来解决 SQL 语言和关系代数的缺点，这些集合已在各种数据库中实现，包括：

*   Oracle（可能是最复杂的实现）
*   PostgreSQL（在某种程度上）
*   Informix
*   SQL Server、MySQL 等（通过 XML 或 JSON “模拟”）

在我看来，如果所有数据库都实现了 SQL 标准`MULTISET()`运算符（例如 Oracle 实现），人们将不再使用 ORM 进行映射（也许仍然用于对象图持久性），因为他们可以直接从数据库中实现嵌套集合，例如这个查询：

```
SELECT actor_id, first_name, last_name,
  MULTISET (
    SELECT film_id, title
    FROM film AS f
    JOIN film_actor AS fa USING (film_id)
    WHERE fa.actor_id = a.actor_id
  ) AS films
FROM actor AS a 
```

将所有演员及其电影作为嵌套集合产生，而不是非规范化的连接结果（每部电影重复演员）。

### 客户端的功能范式

客户端的函数式编程语言是否更适合数据库交互的问题实际上是正交的。ORM 有助于对象图的持久性，因此如果您的客户端模型是一个图，并且您希望它是一个图，那么您将需要一个 ORM，无论您是否使用函数式编程语言来操作该图。

但是，由于面向对象在函数式编程语言中的惯用性较低，因此您不太可能将每个数据项硬塞到一个对象中。对于编写 SQL 的人来说，投影任意*元组*是很自然的。SQL 包含结构类型。每个 SQL 查询都定义了自己的行类型，而无需事先为其分配名称。这与函数式程序员产生了很好的共鸣，尤其是在类型推断很复杂的情况下，在这种情况下，您永远不会想到将您的 SQL 结果映射到某个先前定义的对象/类。

[使用此博客文章中的](https://blog.jooq.org/2017/01/16/a-functional-programming-approach-to-dynamic-sql-with-jooq/)[jOOQ](https://www.jooq.org) 的 Java 示例可能是：

```
// Higher order, SQL query producing function:
public static ResultQuery<Record2<String, String>> actors(Function<Actor, Condition> p) {
    return ctx.select(ACTOR.FIRST_NAME, ACTOR.LAST_NAME)
              .from(ACTOR)
              .where(p.apply(ACTOR)));
} 
```

与 SQL 语言由一些 ORM 抽象或使用 SQL 的自然“基于字符串”特性相比，这种方法导致 SQL 语句的组合性好得多。现在可以使用上面的函数，例如：

```
// Get only actors whose first name starts with "A"
for (Record rec : actors(a -> a.FIRST_NAME.like("A%")))
    System.out.println(rec); 
```

### 基于 SQL 的 FRM 抽象

一些 FRM 尝试对 SQL 语言进行抽象，通常是出于以下原因：

*   他们声称 SQL 不够可组合（jOOQ 反驳了这一点，很难做到正确）。
*   他们声称 API 用户更习惯于“本机”集合 API，因此例如`JOIN`被翻译成`flatMap()`和`WHERE`被翻译成`filter()`等。

## 回答你的问题

FRM 并不比 ORM“更容易”，它解决了一个不同的问题。事实上，FRM 并没有真正解决任何问题，因为 SQL 作为一种声明式编程语言本身（与函数式编程没有太大区别），与其他函数式客户端编程语言非常匹配。因此，如果有的话，FRM 只是在 SQL、外部 DSL 和您的客户端语言之间架起了一座桥梁。

（我在[jOOQ](https://www.jooq.org)背后的公司工作，所以这个答案是有偏见的）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-20T13:14:13.273

扩展关系数据库的难题是扩展事务、数据类型不匹配、自动查询翻译以及诸如[N+1 Select](http://ayende.com/Blog/archive/2006/05/02/CombatingTheSelectN1ProblemInNHibernate.aspx)之类的事情，这些都是离开关系系统的基本问题，而且——在我看来——不要通过改变接收编程范式。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-07-01T10:03:46.367

这取决于您的需求

1.  如果您想专注于数据结构，请使用 JPA/Hibernate 之类的 ORM
2.  如果您想了解治疗方法，请查看 FRM 库：QueryDSL 或 Jooq
3.  如果您需要针对特定​​数据库调整 SQL 请求，请使用 JDBC 和本机 SQL 请求

各种“关系映射”技术的优势在于可移植性：您确保您的应用程序将在大多数 ACID 数据库上运行。否则，您将在手动编写 SQL 请求时应对各种 SQL 方言之间的差异。

当然，您可以限制自己使用 SQL92 标准（然后进行一些函数式编程），或者您可以使用 ORM 框架重用函数式编程的一些概念

ORM 的优势是建立在一个会话对象之上的，它可以作为一个瓶颈：

1.  只要底层数据库事务正在运行，它就会管理对象的生命周期。
2.  它维护您的 java 对象和数据库行之间的一对一映射（并使用内部缓存来避免重复对象）。
3.  它会自动检测关联更新和要删除的孤立对象
4.  它使用乐观或悲观锁处理并发问题。

然而，它的优点也是它的缺点：

1.  会话必须能够比较对象，因此您需要实现 equals/hashCode 方法。但是对象相等性必须植根于“业务密钥”而不是数据库 ID（新的瞬态对象没有数据库 ID！）。但是，一些具体化的概念没有业务平等（例如操作）。一个常见的解决方法依赖于 GUID，这往往会让数据库管理员感到不安。

2.  会话必须监视关系更改，但其映射规则会推动使用不适合业务算法的集合。有时您想使用 HashMap 但 ORM 将要求键是另一个“富域对象”而不是另一个轻量级对象...然后您必须在作为键的富域对象上实现对象相等...但是你不能，因为这个对象在商业世界中没有对应物。因此，您退回到一个必须迭代的简单列表（并导致性能问题）。

3.  ORM API 有时不适合实际使用。例如，现实世界的 Web 应用程序尝试通过在您获取数据时添加一些“WHERE”子句来强制会话隔离......然后“Session.get(id)”就不够了，您需要转向更复杂的 DSL（ HSQL、Criteria API）或返回原生 SQL

4.  数据库对象与专用于其他框架的其他对象冲突（例如 OXM 框架 = 对象/XML 映射）。例如，如果您的 REST 服务使用 jackson 库来序列化业务对象。但是这个杰克逊正好映射到一个冬眠者。然后要么合并两者，你的 API 和数据库之间出现强耦合，要么你必须实现翻译，你从 ORM 保存的所有代码都在那里丢失......

另一方面，FRM 是“对象关系映射”（ORM）和原生 SQL 查询（使用 JDBC）之间的权衡

解释 FRM 和 ORM 之间差异的最佳方法是采用 DDD 方法。

*   对象关系映射允许使用“富域对象”，它们是 Java 类，其状态在数据库事务期间是可变的
*   函数关系映射依赖于不可变的“不良域对象”（以至于每次要更改其内容时都必须克隆一个新对象）

它释放了对 ORM 会话的约束，并且大部分时间都依赖于 SQL 上的 DSL（因此可移植性并不重要）但另一方面，您必须查看事务细节，并发问题

```
List<Person> persons = queryFactory.selectFrom(person)
  .where(
    person.firstName.eq("John"),
    person.lastName.eq("Doe"))
  .fetch(); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-20T12:09:43.170

我猜函数到关系映射应该比 OO 到 RDBMS 更容易创建和使用。只要你只查询数据库，就是这样。我还没有真正看到（尚未）如何以一种不错的方式进行没有副作用的数据库更新。

我看到的主要问题是性能。今天的 RDMS 并非设计用于功能查询，并且在很多情况下可能表现不佳。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-20T12:27:50.840

我认为，正如 Sam 所提到的，如果应该更新数据库，则必须面对与 OO 世界相同的并发问题。由于 RDBMS 的数据、事务等状态，程序的功能性质可能比对象性质更成问题。

但是对于阅读，函数式语言对于某些问题域可能更自然（因为它似乎与 DB 无关）

功能<->RDBMS 映射与OO<->RDMBS 映射应该没有太大区别。但我认为这在很大程度上取决于您想要使用什么样的数据类型，如果您想开发一个具有全新 DB 模式的程序或对遗留 DB 模式做一些事情等等。

例如，关联的延迟获取等可能可以通过一些与延迟评估相关的概念很好地实现。（即使它们也可以用 OO 很好地完成）

编辑：通过谷歌搜索，我找到[了 HaskellDB](http://hackage.haskell.org/package/haskelldb "HaskellDB")（Haskell 的 SQL 库）——这值得一试吗？

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-20T18:46:34.210

*我本身*没有做过函数关系映射，但我使用函数式编程技术来加速对 RDBMS 的访问。

例如，从数据集开始，对其进行一些复杂的计算并存储结果是很常见的，其中结果是原始数据的子集以及附加值。命令式方法要求您使用额外的 NULL 列存储初始数据集，进行计算，然后使用计算值更新记录。

似乎有道理。但问题是它会变得非常缓慢。如果您的计算除了更新查询本身之外还需要另一个 SQL 语句，或者甚至需要在应用程序代码中完成，那么您实际上必须（重新）搜索您在计算后更改的记录以将结果存储在正确的行中.

您可以通过简单地为结果创建一个新表来解决此问题。这样，您总是可以插入而不是更新。您最终拥有另一个表，复制了键，但您不再需要在存储 NULL 的列上浪费空间 - 您只存储您拥有的内容。然后，您将结果加入您的最终选择。

我（ab）以这种方式使用 RDBMS 并最终编写了看起来像这样的 SQL 语句......

```
create table temp_foo_1 as select ...;
create table temp_foo_2 as select ...;
...
create table foo_results as
  select * from temp_foo_n inner join temp_foo_1 ... inner join temp_foo_2 ...; 
```

这本质上是在创建一堆不可变的绑定。不过，好消息是您可以同时处理整个场景。有点让您想起可以使用矩阵的语言，例如 Matlab。

我想这也将使并行性更容易。

一个额外的好处是不必指定以这种方式创建的表的列类型，因为它们是从它们从中选择的列中推断出来的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-05-12T08:30:06.290

数据库和函数式编程可以融合。

例如：

Clojure 是一种基于关系数据库理论的函数式编程语言。

```
 Clojure -> DBMS, Super Foxpro
                   STM -> Transaction，MVCC
Persistent Collections -> db, table, col
              hash-map -> indexed data
                 Watch -> trigger, log
                  Spec -> constraint
              Core API -> SQL, Built-in function
              function -> Stored Procedure
             Meta Data -> System Table 
```

注意：在最新的 spec2 中，spec 更像是 RMDB。请参阅：[spec-alpha2 wiki：模式和选择](https://github.com/clojure/spec-alpha2/wiki/Schema-and-select)

我提倡：在hash-map之上构建关系数据模型，实现NoSQL和RMDB优势的结合。这实际上是 posgtresql 的反向实现。

Duck Typing：如果它看起来像鸭子，叫起来像鸭子，那它一定是鸭子。

**如果 clojure 的数据模型像 RMDB，clojure 的工具像 RMDB，clojure 的数据操作像 RMDB，那么 clojure 必须是 RMDB。**

[Clojure 是一种基于关系数据库理论的函数式编程语言](https://github.com/linpengcheng/PurefunctionPipelineDataflow/blob/master/doc/Clojure_is_FP_based_on_RMDB.md)

[一切都是 RMDB](https://github.com/linpengcheng/PurefunctionPipelineDataflow/blob/master/doc/Everything_is_RMDB.md)

[基于hash-map（NoSQL）实现关系数据模型和编程](https://github.com/linpengcheng/PurefunctionPipelineDataflow/blob/master/doc/relational_model_on_hashmap.md)

# vbscript - IIS 7 - IIS 6 问题

> ID：218193
> 
> 赞同：1
> 
> 时间：2008-10-20T12:03:15.710
> 
> 标签：vbscript, iis-6

我正在尝试运行此脚本以将应用程序池分配给在 IIS 6 下运行的网站

```
Set oWebAdmin = GetObject("winmgmts:root\WebAdministration")
Set oSite = oWebAdmin.Get("Site.Name='Site'")
oSite.ApplicationDefaults.ApplicationPool = "NewAppPool"
oSite.Put_ 
```

此脚本无法在 IIS 6 下运行... 有什么问题吗？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T12:29:00.527

```
Set objVirtualDirectory = GetObject( "IIS://localhost/" + strSitePath + "/ROOT" )

' Assign the Pool to the Site
objVirtualDirectory.AppPoolID = strAppPool
objVirtualDirectory.AppFriendlyName = "me app"
objVirtualDirectory.Put_() 
```

# makefile - 安静地在错误时回显命令行

> ID：218208
> 
> 赞同：5
> 
> 时间：2008-10-20T12:10:07.100
> 
> 标签：makefile, suppress

我有一个 Makefile 用很长的命令行构建许多 C 文件，我们已经通过以下规则清理了输出：

```
.c${MT}.doj:

        @echo "Compiling $<";\
         $(COMPILER) $(COPTS) -c -o $@ $< 
```

现在这很好，因为 @ 抑制了正在发出的编译行。但是当我们得到一个错误时，我们得到的只是错误信息，没有命令行。谁能想到一种“简洁”的方式来发出命令行？我能想到的就是将它回显到一个文件中，并让更高级别的 make 捕获错误并 cat 文件。哈基我知道。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-20T12:42:26.147

经过测试并且可以正常工作（Linux中的GNU make）：

```
.c${MT}.doj:
     @echo "Compiling $<";\
          $(COMPILER) $(COPTS) -c -o $@ $<  \
          || echo "Error in command: $(COMPILER) $(COPTS) -c -o $@ $<" \
          && false 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-22T04:46:49.160

这个问题已经很老了，但是对于那些在谷歌上搜索的人来说，我认为在这种情况下我要做的就是在我的 shell 中`make`使用`make -s`(silent mode) 的别名，并且只将`@`前缀放在`echo`正在调用其他诊断命令的行之前。当我想要完整的输出时`make`，我将通过调用它来覆盖我的别名`\make`。

另请注意，在这种情况下，您需要做典型的事情并将 放在`@echo`单独的行上，实际的规则命令放在单独的行上并且不带`@`'s。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T12:43:02.790

一个简单的解决方案是使用`abc`如下的简单脚本：

```
#!/bin/bash

$@
code=$?
if (( code )); then
  echo error running $@
fi
exit $code 
```

然后你可以写`abc $(COMPILER) $(COPTS) -c -o $@ $<`在你的`Makefile`. 请注意，当您有管道或重定向时，这不起作用（因为它们将被应用于`abc`而不是您要运行的命令）。

您也可以直接将类似的代码放入`Makefile`if that's优选。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T12:44:10.340

我最近使用了一个名为[logtext](http://www.logtext.de/index_en.html)的实用程序来跟踪 bat 文件执行过程中发生的输出。检查一下，如果您想知道发生了什么错误，您可能会发现这非常有用。

# asp.net - Asp.net 树视图

> ID：218216
> 
> 赞同：1
> 
> 时间：2008-10-20T12:14:57.123
> 
> 标签：asp.net, asp.net-ajax, treeview, updatepanel

我已将 TreeView 放置在更新面板中，并且 HoverNodeStyle-Font-Underline="true" 将显示鼠标悬停下划线。但是回发后鼠标悬停时没有下划线

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T12:24:04.327

让标准 TreeView 控件与 ASP.NET Ajax 协作可能有点棘手 - 请查看 Matt Berseth 的[这篇](http://mattberseth.com/blog/2007/07/hwo_to_create_an_aspnet_ajax_s.html)文章。

# javascript - 如何更改在 Firefox 中输入的字符

> ID：218219
> 
> 赞同：6
> 
> 时间：2008-10-20T12:16:11.363
> 
> 标签：javascript, javascript-events

我需要在文本输入中更改字符“。” 键入时到“，”。在 IE 中，我更改了 keypress 事件中的 keyCode 事件属性，如下所示

```
document.getElementById('mytext').onkeypress = 
 function (evt) {
  var e = evt || window.event;
  if (e.keyCode && e.keyCode==46)
   e.keyCode = 44;
  else if (e.which && e.which==46) {
   e.which = 44;
  }
 }; 
```

但似乎在 Firefox 中无法更改在关键事件中键入的字符。有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-20T12:20:05.100

尝试这个。它适用于所有浏览器：

```
window.onload = function () {
    var input = document.getElementById("mytext");

    input.onkeypress = function () {
        var evt = arguments[0] || event;
        var char = String.fromCharCode(evt.which || evt.keyCode);

        // Is it a period?
        if (char == ".") {
            // Replace it with a comma
            input.value += ",";

            // Cancel the original event
            evt.cancelBubble = true;
            return false;
        }
    }
}; 
```

**更新：** **Pier Luigi**指出了上述问题。它不会处理不在文本末尾的插入符号位置。即使您在值中插入一些文本，它也会将命令附加到末尾。

解决方案是模拟逗号键的按键事件，而不是附加逗号。不幸的是，在不同浏览器中分发合成事件的方式似乎多种多样，而且并非易事。我会看看我是否能找到一个很好的通用方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-20T14:51:46.773

假设 Event 对象中的所有属性都是不可变的。DOM 规范没有解决手动更改这些值时发生的情况。

这是您需要的逻辑：监听所有关键事件。如果是句号，则*取消*事件，并在光标位置手动添加逗号。（这是在光标位置插入任意文本[的代码片段](http://alexking.org/blog/2003/06/02/inserting-at-the-cursor-using-javascript)。）

您可以通过调用`event.preventDefault()`;来抑制 Firefox 中的事件。这告诉浏览器不要继续执行与此事件关联的默认操作（在这种情况下，键入字符）。您可以通过设置`event.returnValue`来抑制 IE 中的事件`false`。

如果不是期间，请尽早从您的处理程序返回。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-20T13:25:21.677

从技术上讲，您只想用逗号替换所有点。

```
document.getElementById('mytext').onkeyup = function(){
    this.value = this.value.replace('.', ',');
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-20T15:12:47.123

如果我查看官方[Document Object Model Events](http://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-eventgroupings-mouseevents "Dom 2 级事件")文档，鼠标事件字段被定义为只读。那里没有定义键盘事件，我想 Mozilla 为他们遵循了这个政策。

所以基本上，除非有一些聪明的技巧，否则你不能以你想要的方式改变一个事件。您可能必须截取密钥并在插入符号所在的位置插入字符（原始或翻译），就像 JS HTML 编辑器所做的那样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T15:00:00.673

这真的需要即时完成吗？如果您正在收集要发布到表单或提交到数据库的信息，那么在提交后修改数据不是更好吗？这样用户就永远不会看到令人困惑的变化。

# c++ - Visual C++ 2008 'Release' 版本包含调试信息

> ID：218226
> 
> 赞同：17
> 
> 时间：2008-10-20T12:20:13.133
> 
> 标签：c++, visual-studio, debugging

我注意到在使用 MS Visual Studio 2008 生成新的 C++ 项目时，**发布**版本包含调试符号 - 特别是启用了以下设置：

*   C++/General/Debug Information Format 设置为**Program Database**。
*   Linker/Debugging/Generate Debug Info 设置设置为**Yes**。

我从未在 Visual Studio 的早期版本中注意到这一点。

那么，除了生成更大的 EXE 文件之外，启用这些设置是否有任何不利之处？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-10-20T12:29:03.863

多年来，我们已经在商业版本中启用了这些设置，没有明显的缺点。不过，好处是巨大的。

我们集成了一个故障转储打包程序，它将转储与一些其他信息一起打包，并通过电子邮件（在用户同意的情况下）发送到公司收件箱。这帮助我们找到了需要我们*永远*重现和发现的问题。

虽然有点偏离主题，但这里有一个链接指向某人所做的出色贡献，它为您提供了一种将崩溃报告器包含到 C++/Windows 应用程序的简单方法：http: [//www.codeproject.com/KB/debug/crash_report.aspx](http://www.codeproject.com/KB/debug/crash_report.aspx)

注意：不过，最好不要在您的版本中包含 PDB 文件。也就是说，您必须保留与您发布的版本相匹配的 PDB 文件，以便将来可以正确调试问题。如果使用的 PDB 文件不是使用构建 exe 的相同代码构建的，那么当您尝试调试 dmp 时看到的堆栈将是错误的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-26T14:13:17.047

默认情况下它们是打开的，因为：

1.  如果您现在不创建它们，则以后无法创建它们。
2.  你需要它们。

在 Visual C++ 中启用调试信息会导致向二进制标头添加一个小条目，以标识此二进制文件的 PDB。它太小了，没有任何大小问题，并且不包含您可能担心共享的任何有用的秘密。

（标题条目标记为 RSDS：谁能猜到为什么？）

当然，这些 PDB 将在您的构建机器/备份中使用更多磁盘空间。处理它。当需要调试某些东西时，您需要这些 PDB。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-20T12:26:12.060

好吧，您可能会提供此调试信息，并且有人可能会使用它来反汇编您的代码。对于一些害怕的人来说，仅此一点可能就是不离开这种方式的理由。

就个人而言，我认为有时为发布版本提供调试信息是有帮助的——这样分析崩溃转储要容易得多，Watson 博士将在应用程序崩溃的情况下将其存储起来。
我确实以这种方式发现了一些非常晦涩的错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-20T12:28:23.960

启用这些选项并不一定会使您的可执行文件更大。调试信息存储在一个单独的文件中，扩展名为 PDB。提供调试信息绝不是一个坏主意，除非您真的非常缺乏可用存储空间。

也许这就是它们默认开启的原因：它们不会损害您的可执行文件。发布版本确实使用了诸如函数内联和生成优化代码之类的优化，这使得单步执行变得更加困难，而调试版本则关闭了这些选项。

这里没有缺点。

戴夫

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-26T01:12:52.363

除了 PDB 之外，添加 /Zi 开关确实会生成更大的 .exe 文件。但是，您可以单独链接 /OPT:REF 以将 .exe 文件大小保持在最低限度。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-21T16:59:17.203

由于对 .pdb 文件的引用（即额外的路径），.exe 会稍大一些。就是这样。

# java - Sun Java System Portal Server 7.1

> ID：218235
> 
> 赞同：1
> 
> 时间：2008-10-20T12:24:14.950
> 
> 标签：java, system, sun, portal-server

我想我可以扩展基本提供程序来操作基本布局等。有没有什么地方可以获取默认提供程序的 java 源代码？这些默认提供程序的类复制到哪里？我可以通过扩展基本容器来操作哪些内容？是否有关于我可以覆盖的方法的综合文档？

非常感谢您的时间！！

问候， 维维克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-15T02:48:27.673

您可以在此处找到的开发人员指南应回答您有关默认提供程序的问题：

[http://docs.sun.com/app/docs/coll/1483.1](http://docs.sun.com/app/docs/coll/1483.1)

门户项目/源代码的开源版本可以在这里找到：

[https://portal.dev.java.net/](https://portal.dev.java.net/)

# ruby - Ruby 支持逐字字符串吗？

> ID：218245
> 
> 赞同：5
> 
> 时间：2008-10-20T12:27:08.017
> 
> 标签：ruby, string, syntax

Ruby 中是否支持（因为缺少更好的词）非转义（逐字）字符串？

就像在 C# 中一样：

```
@"c:\Program Files\" 
```

...或在 Tcl 中：

```
{c:\Program Files\} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-20T12:30:59.600

是的，你需要在你的字符串前面加上`%`一个字符来描述它的类型。

你想要的是`%q{c:\program files\}`.

镐书[在这里很好地介绍了这一点，](http://www.rubycentral.org/pickaxe/language.html)部分是通用分隔输入。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-20T21:58:12.937

您可以只使用单引号字符串。

```
>> puts "a\tb"
a    b
=> nil
>> puts 'a\tb'
a\tb
=> nil 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-20T12:35:27.330

除了 %q{string}，您还可以执行以下操作：

```
string =<<SQL
  SELECT * 
  FROM Book
  WHERE price > 100.00
  ORDER BY title;
SQL 
```

分隔符是任意字符串，通常为大写。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T12:36:41.603

```
mystring = %q["'\t blahblahblah] 
```

或者，如果您想解释`\t`为制表符：

```
mystring = %Q["'\t blahblahblah] 
```

# iphone - 有没有办法使用 openURL 将图钉放置到谷歌地图 iphone 应用程序中？

> ID：218252
> 
> 赞同：10
> 
> 时间：2008-10-20T12:29:25.860
> 
> 标签：iphone, google-maps

我想创建一个可以打开谷歌地图应用程序并在地图上放置图钉的 iPhone 应用程序。

我有别针的确切位置，由其经度和纬度指定。我还有一个引脚的名称，例如应该与引脚一起显示的“位置 1”。

我知道 UIApplication:openURL 可以用于此，但我不知道确切的 url 格式。

那么，有没有办法做我上面描述的事情？如果是，那么正确的 url 格式是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-20T13:00:04.753

您可以使用以下格式的 URL：[http ://maps.google.com/maps?q=Your+Location+name@latitude,longitude](http://maps.google.com/maps?q=Your+Location+name@latitude,longitude)

[http://maps.google.com/maps?q=This+is+near+Lake+Shore+Drive@41.9288,-87.6315](http://maps.google.com/maps?q=This+is+near+Lake+Shore+Drive@41.9288,-87.6315)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T20:20:29.450

使用 KML，您最多可以删除 100 个图钉。[在http://appsamuck.com](http://appsamuck.com)上有一个示例，请查看第 8 天的示例 ( [http://appsamuck.com/day8.html](http://appsamuck.com/day8.html) )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-07T00:06:43.937

为什么您的用户必须退出您的应用才能查看地图。您可以轻松地将 Google 地图嵌入到您的应用程序中。您甚至可以删除多个具有经纬度信息的图钉。

事实上，在我看来，您的用户永远不必离开您的应用程序来查看谷歌地图。

[https://sourceforge.net/projects/quickconnect/](https://sourceforge.net/projects/quickconnect/)上的示例应用程序包含了如何执行此操作的示例。

下载 QuickConnectiPhone zip 文件，您将在示例目录中找到它。

# ruby - 有哪些“糊状”替代品？（可安装）

> ID：218254
> 
> 赞同：2
> 
> 时间：2008-10-20T12:30:17.870
> 
> 标签：ruby, ramaze, pastie, rapaste

我想在我们的本地 Intranet 中安装一个“pastie”。**[RaPaste](http://p.ramaze.net)**和[paste.org](http://pastie.org)的替代品是什么？（后者甚至不能在本地安装 b/c 它似乎不是开源的？）

**编辑**：不一定是 Ruby 顺便说一句。

**编辑**：我所说的 paste 是一个应用程序，您可以在其中共享源代码粘贴，而不是将其粘贴到 irc 聊天中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T12:43:53.507

例如[Pocoo](http://dev.pocoo.org/projects/lodgeit/)人的 LodgeIt。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T13:13:28.550

你的要求不是很清楚。首先在您的脑海中定义什么是“馅饼”可能会有所帮助（我从 deviantART 知道馅饼，它们是非常不同的野兽......）。我不得不去指定的网站有一个想法。
是否必须仅是 Ruby 也不清楚（我只看到一个标签，没有明确的要求）。

我知道旧的和著名的 pastebin.org，[它的 (PHP) 源](http://blog.dixo.net/downloads/ "pastebin.org 源代码")是可用的。

# shell - 在多台机器上保持 shell 配置同步

> ID：218255
> 
> 赞同：11
> 
> 时间：2008-10-20T12:30:18.777
> 
> 标签：shell, synchronization, development-environment, dotfiles

我是一个非常活跃的命令行用户，我到处都有 shell 帐户。MacBook、Linux 台式机、Linux 服务器、XP 上的 Cygwin，应有尽有。

如何使用所有平台上可用的有限工具使我的 shell 配置（`.bashrc`等）在所有这些机器上保持同步？`.vimrc`

我一直`rsync`在以非常有限的方式使用，包括在需要时手动复制一些文件，但我想要一种标准方法来在我的所有机器上设置相同的基本 shell 环境。告诉我你的 shell 账户管理策略。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2011-07-29T16:18:08.943

我在 Dropbox 上有具有全局、每个操作系统和每个机器外壳配置的文件夹：

```
$ ls ~/Dropbox/shell/bash
bashbootstrap  bashrc
bashrc-Darwin  bashrc-Darwin-laptopname  bashrc-Darwin-mininame
bashrc-Linux  bashrc-Linux-machineone  bashrc-Linux-machinetwo 
```

`bashrc`在每台机器上加载，`bashrc-Linux`，`bashrc-Darwin`在它们各自的操作系统上加载，并且几个配置特定于各个机器。（顺便说一下，Darwin 是 OS X 的类似 BSD 的内核的名称。）

将这一切联系在一起的是`bashbootstrap`文件。它以增加特定性的顺序加载每个适用的配置文件，这允许每个操作系统和每个机器覆盖具有更高的优先级。此外，我们默默地跳过丢失的配置文件；你不需要为每台机器创建空配置文件来保持脚本的运行。

在一台新机器上，在安装 Dropbox 之后`~/Dropbox`，我移除了默认设置`.bashrc`，而是将引导文件符号链接到其位置：

```
$ mv ~/.bashrc ~/.bashrc.bak
$ ln -s ~/Dropbox/shell/bash/bashbootstrap  ~/.bashrc 
```

哦，这是`bashbootstrap`文件的内容：

```
if [ -z "$PS1" ]; then
   return
fi

dropboxshelldir=~/Dropbox/shell
dropboxdir=$dropboxshelldir/bash
masterbashrc=$dropboxdir/bashrc
osbashrc=$masterbashrc-`uname`
localbashrc=$osbashrc-`hostname | cut -d. -f1`

echo -n "Applicable shell configs: "
for bashfile in "$masterbashrc" "$osbashrc" "$localbashrc"; do
  if [ -r $bashfile ]; then
    . $bashfile
    echo -n "`basename $bashfile` "
  fi
done
echo

# Set convenience aliases
myed=${VISUAL:-${EDITOR:-vim}}
alias editbashrc="$myed $masterbashrc"
alias editosbashrc="$myed $osbashrc"
alias editlocalbashrc="$myed $localbashrc" 
```

最后一点，这个脚本还提供了三个方便的别名来编辑你的 Bash 配置文件，而不必记住它们的存储位置。

*   **`editbashrc`：**编辑全局配置文件。
*   **`editosbashrc`：**编辑特定于操作系统的配置文件。
*   **`editlocalbashrc`：**编辑机器特定的配置文件。

我只在 Bash 上对此进行了测试，但它可以在其他 Bash 等 shell 上运行。但是，正如他们所说，您的里程可能会有所不同。

[我在这里](http://paksoy.net/post/159917345/how-dropbox-saved-my-command-line)发表了一篇关于此的博客文章。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-20T12:41:22.683

我过去曾为此使用过版本控制（[svn](http://subversion.tigris.org/)、[mercurial](http://www.selenic.com/mercurial/wiki/)等...）。您可以设置自己的服务器，也可以使用托管服务器。 [Dropbox](http://www.getdropbox.com)也可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T12:42:17.287

如果您有权访问源代码控制，我只需将它们签入。这样您就可以在多台机器上同步它们，并且可以在需要时进行比较/回滚。如果您在工作中没有 CVS/SVN，则可以使用免费选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-14T23:33:13.740

我更喜欢不同机器上的 Vim、Fish、Sway 等配置文件略有不同，所以我制作了一个程序（filetailor）来处理这个问题，然后将结果与 Git 同步。

[filetailor](https://github.com/k4j8/filetailor)是一个开源 Python 程序，它可以使用特定于设备的变量或使用文件中特定于设备的注释对文件进行小幅更改。

例如，除了带有 hostname 的设备之外，每台设备上都将注释掉以下行`device1`。

```
alias MYHOME='/home/dev1home/' #{filetailor device1} 
```

# c# - 带有asp.net mvc beta的强类型actionlink？

> ID：218256
> 
> 赞同：5
> 
> 时间：2008-10-20T12:30:59.290
> 
> 标签：c#, asp.net, asp.net-mvc, routing

我曾经能够在 Preview 3 中执行以下操作

```
<%=Html.BuildUrlFromExpression<AController>(c => c.AnAction(par1, par2)%> 
```

我应该如何使用 MVC Beta 以强类型的方式创建 url？到目前为止我唯一发现的是

```
<%= Html.ActionLink("aName", "ActionName", "ControllerName")%> 
```

当然，这不是强类型的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-20T12:37:16.687

您需要单独下载的 ASP.NET MVC Beta Futures

[ASP.NET MVC 测试版期货](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=18459)

那么您的原始代码将像以前一样工作。

请参阅此帖子以使其正常工作： [SO post on missing extensions](https://stackoverflow.com/questions/211493/aspnet-mvc-beta-1-where-is-htmlrenderpartial#211524)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-20T12:39:00.817

该[`Microsoft.Web.Mvc`](http://www.codeplex.com/aspnet/Release/ProjectReleases.aspx?ReleaseId=18459 "ASP.NET MVC 测试版期货")程序集提供了扩展方法`HtmlHelper`，允许类似

```
<%= Html.ActionLink<SomeController>(c => c.Index()) %> 
```

# coding-style - 我在哪里可以找到一个好的软件应用程序用户指南模板？

> ID：218261
> 
> 赞同：0
> 
> 时间：2008-10-20T12:32:54.853
> 
> 标签：coding-style, user-guide

寻找可以帮助我编写软件应用程序用户指南的资源链接。我正在寻找可以帮助我构建指南的内容，为其提供适当的写作风格，并确保它始终具有出色的外观和感觉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T12:37:53.550

这个链接有一些优点。每个点都以清晰的语言和内嵌的理由呈现。

> 编写程序时，使用主动语态（例如单击此）并直接称呼用户（写“你”而不是“用户”）。
> 
> 解释动作时，使用动词的“命令”形式：
> 
> “从菜单中选择一个选项，然后按 [ENTER]。”

[http://www.klariti.com/technical-writing/User-Guides-Tutorial.shtml](http://www.klariti.com/technical-writing/User-Guides-Tutorial.shtml)

以下是上述文章所涵盖主题的完整列表：

*   头版（封面）
*   封面和标题页
*   免责声明
*   前言
*   内容
*   指南主体
*   程序
*   编写程序
*   分块文本
*   编号你的步骤
*   使用如果-那么方法
*   参考资料
*   返回事项
*   词汇表
*   指数
*   建立标准
*   文件格式
*   结构风格
*   技术语言
*   解决用户
*   展示你的材料
*   特殊要求

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T17:08:56.390

对于结构和外观，请考虑使用 DocBook 等框架。

DocBook 使用 XML 标记模式，让您考虑应该如何排列文档。有 XSL 转换可将其转换为 HTML 和 PDF 等常见格式，并带有大量配置选项，使其看起来像您想要的那样。它是开源的（免费）。当然也有缺点：模式非常大，如果没有好的 XML 编辑器，编辑可能会很困难。

示例：[http ://wiki.docbook.org/topic/WhoUsesDocBook](http://wiki.docbook.org/topic/WhoUsesDocBook)

# php - 我怎样才能发现并在“Slashdotted”中幸存下来？

> ID：218264
> 
> 赞同：47
> 
> 时间：2008-10-20T12:33:38.643
> 
> 标签：php, apache, bandwidth, slashdot

在异常高的流量高峰中生存的好方法是什么？

我的想法是，在某些情况下，我的网站应该暂时切换到“低带宽”模式：切换到基本的 HTML 页面、最小的图形、禁用可能会给数据库带来不必要负载的小部件，等等。

我的想法是：

*   监控 CPU 使用率
*   监控带宽
*   监控请求/分钟

我熟悉缓存、切换到静态内容或内容交付网络等选项作为生存的手段，所以也许问题应该更多地关注如何检测网站何时将变得超载。（尽管其他生存方法的答案当然仍然非常受欢迎。）假设该网站在 Linux 和 PHP 上运行 Apache。这可能是最常见的配置，应该允许最大数量的人从答案中获得帮助。让我们还假设购买另一台服务器和负载平衡等昂贵的选项不可用 - 至少对我们大多数人来说，在 Slashdot 上的提及将是千载难逢的事情，而不是我们可以花钱准备的事情.

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-10-20T13:40:49.040

1.  安装 munin 以监控负载/内存消耗等并通知过载。
2.  如果崩溃，安装monit以重新启动apache2
3.  将 nginx 安装为 apache2 前端，它将在重负载下大量减少内存需求

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-10-20T13:51:46.473

值得一提的是，如果您的连接没有足够的带宽，那么巧妙的缓存和低带宽模式将毫无用处，因此请确保与服务器的连接足够宽。例如，不要将其托管在您的家庭 DSL 连接上。

我是根据被slashdotted的经验说话的。当您根本无法访问 Internet 时，这并不有趣，因为成千上万的人同时试图下载您的室友安装在 George Foreman 烤架内的计算机的照片。再多的防火墙也救不了你。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-16T20:44:02.200

基础知识：

1.  *除非您是真正*的Windows 专家，否则不要尝试在 Windows 上托管大量网站。这是可以做到的，但这是一个时间与成本的问题。
2.  尽可能使用静态内容（即无数据库查询）。
3.  了解缓存控制标头并将它们正确用于图像和其他静态资产。
4.  至少，使用 Apache，但如果可以，使用 lighttpd 或其他高性能网络服务器。

真实答案：

1.  真正了解您的 SQL，并花时间分析慢查询。大多数页面加载不需要超过一秒钟的直接查询。
2.  确定你的负载到底在哪里。如果它是一个媒体密集型网站，请考虑在其他地方托管内容（如 Akamai 或其他一些服务）。如果它是一个数据库密集型站点，请考虑复制。
3.  知道什么样的复制对你有用。如果你有一个重读的站点，标准的 MySQL 主/从复制应该没问题。如果您有大量写入操作，您将需要某种多主机设置，例如 MySQL 集群（或研究“级联”或“瀑布式”复制）。
4.  如果可以，请避免调用 PHP - 即拥有页面的缓存静态 (HTML) 副本（这是大多数 Wordpress 缓存插件所做的）。Apache 提供静态文件的速度甚至比最简单的 hello world PHP 脚本还要快。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-10-20T14:21:52.590

[这是](http://www.usenix.org/events/usenix08/tech/full_papers/elson/elson_html/index.html)一篇相当冗长但内容丰富的文章，关于幸存的“闪电人群”。

这是他们提出的解决方案所针对的情况的场景：

> 在本文中，我们通过我们称为车库创新者的角色的眼睛来考虑缩放问题。车库创新者富有创造力、精通技术和雄心勃勃。她对网络上的 Next Big Thing 有一个好主意，并使用车库中的一些备用服务器来实现它。该服务已启动并运行，不时吸引新访问者，并从广告和订阅中获得微薄的收入。也许有一天，她的网站会中大奖。**或许会登上 Slashdot 或 Digg 的首页；也许 Valleywag 或纽约时报会提到它。**
> 
> **我们的创新者可能只会在广泛宣传中获得一枪。**如果发生这种情况，成千上万的人将访问她的网站。由于她的想法如此新颖，许多人将成为创收客户并推荐朋友。但众所周知，闪电般的人群是善变的。如果站点在其负载下崩溃，结果将不会那么理想。如果网站第一次不工作，很多人都不会费心返回。尽管如此，如果网站突然出现负载高峰，就很难证明为资源支付数万美元是合理的。快闪人群既是车库创新者的祸根，也是她的目标。
> 
> 当代效用计算已经启用了解决这个难题的一种方法。

文章随后提出了车库创新者可以采取的一些步骤，例如使用存储交付网络和实施高度可扩展的数据库。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-09-17T13:17:02.123

我重写了几个流行站点引用的所有 URL，以通过珊瑚 CDN 重定向。

阿帕奇的一个例子：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_USER_AGENT} !^Googlebot
RewriteCond %{HTTP_USER_AGENT} !^CoralWebPrx
RewriteCond %{QUERY_STRING} !(^|&)coral-no-serve$
RewriteCond %{HTTP_REFERER} ^http://([^/]+\.)?digg\.com [OR]
RewriteCond %{HTTP_REFERER} ^http://([^/]+\.)?slashdot\.org [OR]
RewriteCond %{HTTP_REFERER} ^http://([^/]+\.)?slashdot\.com [OR]
RewriteCond %{HTTP_REFERER} ^http://([^/]+\.)?fark\.com [OR]
RewriteCond %{HTTP_REFERER} ^http://([^/]+\.)?somethingawful\.com [OR]
RewriteCond %{HTTP_REFERER} ^http://([^/]+\.)?kuro5hin\.org [OR]
RewriteCond %{HTTP_REFERER} ^http://([^/]+\.)?engadget\.com [OR]
RewriteCond %{HTTP_REFERER} ^http://([^/]+\.)?boingboing\.net [OR]
RewriteCond %{HTTP_REFERER} ^http://([^/]+\.)?del\.icio\.us [OR]
RewriteCond %{HTTP_REFERER} ^http://([^/]+\.)?delicious\.com
RewriteRule ^(.*)?$ http://example.com.nyud.net/$1 [R,L]
</IfModule> 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-20T13:31:04.800

除非您对其进行压力测试，否则根本无法知道您的网站是否能够承受重负载。[使用siege 之](http://www.joedog.org/JoeDog/Siege)类的东西，看看你的性能问题在哪里。它在内存中增长太快了吗？它会随着一堆并发连接而开始变慢吗？是否开始永远访问数据库？

一旦你知道性能问题在哪里，那么就变成了摆脱它们的问题。不幸的是，如果不了解您的具体情况，很难更详细地介绍，但请记住，您在这里谈论的是优化。因此，只有在知道存在性能问题时才应该采取行动。

而且我认为你不一定只是为一生一次的事件做准备。DOS 攻击仍然会发生，因此即使您的网站没有受到攻击，也最好做好准备。

我能想到的唯一能在几乎所有情况下都对你有帮助的事情是，如果你对你的内容进行 gzip 压缩。这将节省大量带宽，并且所有现代浏览器都将支持它而不会出现太多性能问题。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-09-16T20:31:55.270

我认为这个前提是错误的：你*真的很想*得到点点滴滴，否则你一开始就没有网站。一个更好的问题是您如何处理额外的流量？甚至这实际上是两个问题：

1.  您如何从技术上管理额外的服务器负载？
2.  你如何迎接新用户，这样你才能有希望让他们中的一些人留下来？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-20T12:52:40.680

放到云端！

这可能与个人博客等无关，但对于更大的站点，云托管将解决这个问题。以 Amazon EC2 为例，关于这个策略的事情是它会花费你很多钱。

在较小的规模上，对所有图像/静态内容使用 CDN 也可能会有所帮助，再次评估价格很重要。Amazon S3 是我听到最多的 CDN。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-20T13:44:58.267

对于流量高的站点，[Akamai](http://www.akamai.com/)是一个很好的解决方案，可以使站点快速、可扩展且可靠，尽管您拥有自己的基础架构。Akamai 是一项服务（不是免费的），可将您的站点缓存在世界各地的位置。在我上一份工作中，我们的电子商务目录是通过它们缓存的，我们的服务器可能会宕机，除非他们尝试添加到购物车，否则没人会知道。此外，我们的图像服务器关闭了一次，而 Akamai 的缓存再次拯救了我们。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-16T20:31:56.800

永远不要流行。

虽然这会起作用，但它并没有真正的帮助。您需要可以在很短的时间内扩展的基础架构。像 Google Gears 或 Amazon 的网络服务这样的东西似乎很适合这一点，因为即使是 Slashdot 也不会压倒 Google 或 Amazon。如果您想要自己的服务器，请确保您的网络提供商不会在任何预设的带宽限制下切断您的连接。购买足够的硬件，这样您就不会仅仅为了承载正常流量而紧张，而不会有任何松弛来处理突然的峰值。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-20T12:40:49.627

使用缓存！

如果您使用的是 WordPress（例如），您可以使用类似[WP-Super-Cache 的](http://wordpress.org/extend/plugins/wp-super-cache/)东西。如果您使用的是常规 PHP，您仍然可以使用许多选项，包括[memcache](http://www.php.net/memcache)。或者您可以只使用常规的 squid 代理样式缓存。

您使用的任何缓存都将有助于您的网站的防弹（或 slashdot/digg-proof）:-)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-20T12:42:06.223

提高数据库的缓存级别，以便内容可能会稍微过时但访问速度更快。当然，这仅适用于内容不必 100% 一致的情况。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-20T16:20:40.793

您还可以使用[Nagios](http://www.nagios.org/)监控服务器运行状况。根据您的要求，在某些条件下，您可以触发现有的 SQL 文件为您的网站切换模式。

例如，添加“UPDATE settings_table SET bandwidth = 'low';” 进入该 SQL 文件并在 mysql 中运行它，并在条件恢复正常时执行相反的操作。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-16T20:38:36.020

缓存...很难。记录命中，如果出现峰值，写出被命中页面的完全静态副本，然后提供。使用良好的缓存系统将 DB 查询从 100 减少到 2 可以在弱斜线点中幸存下来，但是完全有任何 DB 查询仍然会导致您没有准备好在严重负载下的死站。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-01-02T17:06:25.270

`netstat -plant | awk '$4 ~ /:80\>/ {print}' | wc -l`

这将显示到 Apache 服务器的所有连接。您可以创建一个 cgi 脚本，该脚本将计算与 Apache 服务的连接总数，并在达到某个阈值时发出警告。那个时候该怎么做是另一个问题。

希望您的服务器已准备好。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-09-16T20:32:59.730

有很多方法可以做到这一点，或者至少有帮助。在 Google 上搜索“slashdot-proof”，您会发现其中的一些：

*   使用 FreeCache 对您的服务器进行 Slashdot 验证 - Boing Boing
*   简单的想法博客现在是 Slashdot 证明

等等

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-16T20:33:51.927

确保您构建的所有页面都是静态的，没有数据库，并且不使用图像。

实际上，这个地方并没有那么糟糕。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-10-20T12:41:09.910

关于幸存你是对的：将斜线点链接切换或重定向到没有图形的静态 html 页面。您甚至可能希望将此页面放在其他网络服务器上，这样您的原始服务器就不会占用太多负载。

我会为此使用临时重定向，并在流量消失时删除重定向。

但是如何检测这个，这个我也想知道！仅计算最后几秒钟的点击数可能还不够？

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-10-20T13:20:44.853

确保您的页面支持 Last-Modified & If-Modified-Since 和/或 ETag & If-None-Match 标头。有了这些，您可以完全避免许多计算和传输。

搜索 HTTP 条件 GET 以获取更多信息。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-16T20:36:37.163

缓存数据。

不必要的访问数据库以显示每次负载都显示相同的内容是杀死服务器的原因。将其输出写入文件并改用它。大多数 CMS 和框架都内置了缓存（但您必须打开它），但自己滚动并不是最具挑战性的任务。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-16T20:46:38.887

自动重定向到珊瑚 CDN，除非请求来自珊瑚 CDN。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-09-16T20:59:09.963

.ht 访问：

```
RewriteEngine on
RewriteCond %{HTTP_REFERER} slashdot\.org [NC]
RewriteRule .* - [F] 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-10-21T06:48:25.207

Nearfreespeech.net 可以说是一个半云，在这种情况下可以提供很多帮助。正如上面提到的其他人，分层缓存有很大帮助。从 memcached 而不是数据库中提取大量信息，在您面前有一个反向代理（或分布式反向代理，即 CDN，Panther Networks 很便宜）。

* * *

## 回答 #24

> 赞同：-1
> 
> 时间：2008-09-16T21:49:28.907

没有人提到负载平衡... haproxy 等。优化、缓存和负载平衡几乎可以生存。话虽这么说，我不确定stackoverflow是否在负载均衡器后面；）

# php - FogBugz、WebSVN 和 Cygwin - 未生成差异

> ID：218266
> 
> 赞同：0
> 
> 时间：2008-10-20T12:34:12.887
> 
> 标签：php, svn, cygwin, fogbugz, websvn

我可以理解我要问的内容有点具体和小众，但如果你能提供一些帮助，你实际上可能会让我保留一些头发！

我最初在[FogBugz 技术支持页面](http://support.fogcreek.com/default.asp?fogbugz.4.29301.4)上发布了查询，但并没有太多的乐趣。

基本上，我使用 webSVN 作为存储库浏览器来为 FogBugz 提供日志和差异功能。WebSVN 允许我查看日志但不显示任何差异信息。我已经用细齿梳检查了 webSVN 的 PHP，并确定 websvn 在哪里调用 svn 实用程序，以获取文件内容并使用 sed 和 enscript 对其进行格式化，最终生成的文件是空白的。

我已将实用程序调用分解为更小的语句，并使用命令行手动测试，在我合并 sed 语句之前一切似乎都很好。有没有其他人遇到过这个问题，或者知道解决方案？下面的语句是从 PHP 中调用的，是生成空白文件的地方。

```
""c:\program files\subversion\bin\svn" --non-interactive --config-dir /tmp cat "file:///E:/svn/Users/mwo/test-4.txt"@36 | "c:\cygwin\bin\enscript" --language=html -o - | "c:\cygwin\bin\sed" -n "1,/^<\/PRE.$/,/^ C:\Inetpub\wwwroot\websvn\temp\150.tmp" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T14:37:32.280

嘿伙计们，对于任何坚持这个问题的人，我已经在[这里](http://support.fogcreek.com/default.asp?fogbugz.4.29301.5)发布了答案。

以防万一这被从fogbugz的支持论坛中删除，我基本上不得不让每个人都完全访问C：\ Inetpub \ wwwroot \ websvn \ Temp \，现在一切都很好！

# .net - 从 .NET 中的网络适配器读取 MAC 地址

> ID：218284
> 
> 赞同：17
> 
> 时间：2008-10-20T12:40:17.243
> 
> 标签：.net, ethernet, mac-address

我希望能够使用 VB.net 或 C#（使用 .NET 3.5 SP1）从第一个活动网络适配器读取 mac 地址，用于 winform 应用程序

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-20T13:00:36.703

自 .Net 2.0 以来，System.Net.NetworkInformation 命名空间中有一个 NetworkInterface 类，可以为您提供此信息。尝试这个：

```
 foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces())
        {
            if (nic.OperationalStatus == OperationalStatus.Up)
            {
                Console.WriteLine(nic.GetPhysicalAddress().ToString());
                break;
            }
        } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-20T12:50:14.400

来自[http://www.dotnetjunkies.com/WebLog/jkirwan/archive/2004/02/10/6943.aspx](http://www.dotnetjunkies.com/WebLog/jkirwan/archive/2004/02/10/6943.aspx)

```
 Dim mc As System.Management.ManagementClass
  Dim mo As ManagementObject
  mc = New ManagementClass("Win32_NetworkAdapterConfiguration")
  Dim moc As ManagementObjectCollection = mc.GetInstances()
  For Each mo In moc
     If mo.Item("IPEnabled") = True Then
        ListBox1.Items.Add("MAC address " & mo.Item("MacAddress").ToString())
     End If
  Next 
```

如果您需要，我相信您可以轻松将此代码移植到 C#

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-04-27T11:05:50.580

```
using Linq..

using System.Net.NetworkInformation;
..

NetworkInterface nic =
    NetworkInterface.GetAllNetworkInterfaces()
    .Where(n => n.OperationalStatus == OperationalStatus.Up).FirstOrDefault();

if (nic != null)
    return nic.GetPhysicalAddress().ToString(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-20T13:33:36.667

这是一个可以做到这一点的课程：

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Runtime.InteropServices;

namespace MacAddress
{
    class MacAddress
    {
        byte[] _address;

        public MacAddress(byte[] b)
        {
            if (b == null)
                throw new ArgumentNullException("b");
            if (b.Length != 8)
                throw new ArgumentOutOfRangeException("b");
            _address = new byte[b.Length];
            Array.Copy(b, _address, b.Length);
        }

        public byte[] Address { get { return _address; } }

        public override string ToString()
        {
            return Address[0].ToString("X2", System.Globalization.CultureInfo.InvariantCulture) + ":" +
                    Address[1].ToString("X2", System.Globalization.CultureInfo.InvariantCulture) + ":" +
                    Address[2].ToString("X2", System.Globalization.CultureInfo.InvariantCulture) + ":" +
                    Address[3].ToString("X2", System.Globalization.CultureInfo.InvariantCulture) + ":" +
                    Address[4].ToString("X2", System.Globalization.CultureInfo.InvariantCulture) + ":" +
                    Address[5].ToString("X2", System.Globalization.CultureInfo.InvariantCulture);
        }

        public static List<MacAddress> GetMacAddresses()
        {
            int size = 0;
            // this chunk of code teases out the first adapter info
            int r = GetAdaptersInfo(null, ref size);
            if ((r != IPConfigConst.ERROR_SUCCESS) && (r != IPConfigConst.ERROR_BUFFER_OVERFLOW))
            {
                return null;
            }
            Byte[] buffer = new Byte[size];
            r = GetAdaptersInfo(buffer, ref size);
            if (r != IPConfigConst.ERROR_SUCCESS)
            {
                return null;
            }
            AdapterInfo Adapter = new AdapterInfo();
            ByteArray_To_IPAdapterInfo(ref Adapter, buffer, Marshal.SizeOf(Adapter));

            List<MacAddress> addresses = new List<MacAddress>();
            do
            {
                addresses.Add(new MacAddress(Adapter.Address));
                IntPtr p = Adapter.NextPointer;
                if (p != IntPtr.Zero)
                {
                    IntPtr_To_IPAdapterInfo(ref Adapter, p, Marshal.SizeOf(Adapter));
                }
                else
                {
                    break;
                }
            } while (true);
            return addresses;
        }

        // glue definitions into windows
        [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
        private struct IPAddrString
        {
            public IntPtr NextPointer;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 4 * 4)]
            public String IPAddressString;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 4 * 4)]
            public String IPMaskString;
            public int Context;
        }

        private class IPConfigConst
        {
            public const int MAX_ADAPTER_DESCRIPTION_LENGTH = 128;
            public const int MAX_ADAPTER_NAME_LENGTH = 256;
            public const int MAX_ADAPTER_ADDRESS_LENGTH = 8;
            public const int ERROR_BUFFER_OVERFLOW = 111;
            public const int ERROR_SUCCESS = 0;
        }

        [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
        private struct AdapterInfo
        {
            public IntPtr NextPointer;
            public int ComboIndex;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = IPConfigConst.MAX_ADAPTER_NAME_LENGTH + 4)]
            public string AdapterName;
            [MarshalAs(UnmanagedType.ByValTStr, SizeConst = IPConfigConst.MAX_ADAPTER_DESCRIPTION_LENGTH + 4)]
            public string Description;
            public int AddressLength;
            [MarshalAs(UnmanagedType.ByValArray, SizeConst = IPConfigConst.MAX_ADAPTER_ADDRESS_LENGTH)]
            public Byte[] Address;
            public int Index;
            public int Type;
            public int DhcpEnabled;
            public IntPtr CurrentIPAddress;
            public IPAddrString IPAddressList;
            public IPAddrString GatewayList;
            public IPAddrString DhcpServer;
            public Boolean HaveWins;
            public IPAddrString PrimaryWinsServer;
            public IPAddrString SecondaryWinsServer;
            public int LeaseObtained;
            public int LeaseExpires;
        }
        [DllImport("Iphlpapi.dll", CharSet = CharSet.Auto)]
        private static extern int GetAdaptersInfo(Byte[] PAdapterInfoBuffer, ref int size);
        [DllImport("Kernel32.dll", EntryPoint = "CopyMemory")]
        private static extern void ByteArray_To_IPAdapterInfo(ref AdapterInfo dst, Byte[] src, int size);
        [DllImport("Kernel32.dll", EntryPoint = "CopyMemory")]
        private static extern void IntPtr_To_IPAdapterInfo(ref AdapterInfo dst, IntPtr src, int size);
    }
} 
```

这是一些测试代码：

```
 List<MacAddress> addresses = MacAddress.GetMacAddresses();
        foreach (MacAddress address in addresses)
        {
            Console.WriteLine(address);
        } 
```

我确信 ToString 方法可能会更好，但它确实有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T12:45:23.020

您需要 DllImport GetAdaptersInfo - 这是一些 C# 代码

[http://www.codeguru.com/cpp/in/network/networkinformation/comments.php/c5451/?thread=60212](http://www.codeguru.com/cpp/i-n/network/networkinformation/comments.php/c5451/?thread=60212)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-18T04:11:00.530

看起来这是一篇旧帖子，但我知道你会遇到这个线程寻求帮助，所以这就是我今天所做的，以获取笔记本电脑中所有网络接口的 MAC 地址。

首先，您必须导入以下内容

```
Imports System.Net.NetworkInformation 
```

这是返回字符串数组中所有 MAC 地址的函数

```
Private Function GetMAC() As String()
    Dim MACAddresses(0) As String
    Dim i As Integer = 0
    Dim NIC As NetworkInterface

    For Each NIC In NetworkInterface.GetAllNetworkInterfaces
        ReDim Preserve MACAddresses(i)
        MACAddresses(i) = String.Format("{0}", NIC.GetPhysicalAddress())
        i += 1
    Next
    Return MACAddresses
End Function 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-24T15:03:58.917

对于使用更有限的 Compact Framework (.NET v2.0 CF) 的任何人，以下代码都适用于 Windows CE 5.0 和 CE 6.0（仅读取适配器名称，但在 MSDN 上搜索“typedef struct _IP_ADAPTER_INFO”以获得完整定义返回的结构）：

```
private const int MAX_ADAPTER_NAME_LENGTH = 256;
[DllImport ("iphlpapi.dll", SetLastError = true)]
private static extern int GetAdaptersInfo(byte[] abyAdaptor, ref int nSize);

// ...
private static string m_szAdaptorName = "DM9CE1";

// ...
private void GetNetworkAdaptorName()
{
    // The initial call is to determine the size of the memory required. This will fail
    // with the error code "111" which is defined by MSDN to be "ERROR_BUFFER_OVERFLOW".
    // The structure size should be 640 bytes per adaptor.
    int nSize = 0;
    int nReturn = GetAdaptersInfo(null, ref nSize);

    // Allocate memory and get data
    byte[] abyAdapatorInfo = new byte[nSize];
    nReturn = GetAdaptersInfo(abyAdapatorInfo, ref nSize);
    if (nReturn == 0)
    {
        // Find the start and end bytes of the name in the returned structure
        int nStartNamePos = 8;
        int nEndNamePos = 8;
        while ((abyAdapatorInfo[nEndNamePos] != 0) &&
                    ((nEndNamePos - nStartNamePos) < MAX_ADAPTER_NAME_LENGTH))
        {
            // Another character in the name
            nEndNamePos++;
        }

        // Convert the name from a byte array into a string
        m_szAdaptorName = Encoding.UTF8.GetString(
            abyAdapatorInfo, nStartNamePos, (nEndNamePos - nStartNamePos));
    }
    else
    {
        // Failed? Use a hard-coded network adaptor name.
        m_szAdaptorName = "DM9CE1";
    }
} 
```

# java - 哪个是 Java 中最简单且依赖最少的 AOP 框架？

> ID：218285
> 
> 赞同：5
> 
> 时间：2008-10-20T12:40:27.507
> 
> 标签：java, jakarta-ee, aop

我想使用 AOP 框架，但我有两个限制。

我选择的任何框架

1.  必须相当独立。我计划在遗留代码库中使用它，因此无法将诸如 commons-logging-XXX.jar 之类的预期依赖项升级到 commons-logging-newest.jar。

2.  必须有很好的文档记录，不应该太复杂而无法理解和集成。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-20T12:50:34.663

[据我所知， AspectJ](http://www.eclipse.org/aspectj/)只是一个编译器，除了包含 AspectJ 运行时 jar 之外，对已编译的程序没有任何依赖关系。

它也被积极维护，是 Eclipse 项目的一部分，并且有一个很好的开发环境（[AJDT](http://www.eclipse.org/ajdt/)，一个 Eclipse 插件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T13:13:32.417

我喜欢 Spring + AspectJ。**如果您愿意**，您可以在 xml 中完成所有切入点定义，并且您不需要更改遗留内容上的一行代码。如果您已经了解 Spring 和 AOP 的概念，则无需学习太多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T12:50:55.177

好的，这个不符合您的所有要求，但我认为，值得一看： [http ://dynamicaspects.sourceforge.net/](http://dynamicaspects.sourceforge.net/)

正面的

*   由于使用 JavaAgent，除了需要 java 1.5 之外没有依赖项
*   不需要 XML 标记，只适用于 POJO 类
*   自己试过，发现它很容易使用（不是很复杂）

负面的

*   不再积极维护 afaik
*   糟糕的文档
*   你不能做一个成熟的 AOP 框架允许你做的所有事情

前段时间我对其进行了测试，印象深刻，但发现了一些我现在不记得的故障。虽然你可以试一试。

格瑞兹，GHad

# c# - SSRS Sharepoint 集成模式：我的递归参数在哪里？

> ID：218309
> 
> 赞同：1
> 
> 时间：2008-10-20T12:46:47.977
> 
> 标签：c#, web-services, sharepoint, reporting-services

有人可以告诉我为什么 SSRS Web 服务 ReportService2005.asmx 在 ListChildren 上有一个递归参数，而 Sharepoint 集成模式版本 ReportService2006.asmx 没有？

**报告服务 2005：**

```
public CatalogItem[] ListChildren (
    string Item,
    bool Recursive
) 
```

***参考：****[http ://technet.microsoft.com/en-us/library/reportservice2005.reportingservice2005.listchildren.aspx](http://technet.microsoft.com/en-us/library/reportservice2005.reportingservice2005.listchildren.aspx)*

**报告服务2006：**

```
public CatalogItem[] ListChildren (
    string Item
) 
```

***参考：****[http ://technet.microsoft.com/en-us/library/reportservice2006.reportingservice2006.listchildren.aspx](http://technet.microsoft.com/en-us/library/reportservice2006.reportingservice2006.listchildren.aspx)*

如果我想在 sharepoint 集成模式下 ListChildren，我假设我必须自己递归？

删除此参数的原因是什么？

谷歌什么也没显示...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-28T12:13:20.517

我已经通过编写自己的代码来递归地检索我需要的目录来解决这个问题。

# c# - C# 自定义事件处理程序

> ID：218322
> 
> 赞同：7
> 
> 时间：2008-10-20T12:52:34.410
> 
> 标签：c#, properties, event-handling

如果我有财产：

```
public list<String> names { get; set; } 
```

每当将名称添加到列表中时，如何为名为“onNamesChanged”的参数生成和处理自定义事件？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-20T13:06:42.807

BindingList 可能是您的最佳选择，因为它具有内置的更改跟踪和您可以使用的各种现有事件。下面是一个为 Add 公开自定义事件的示例，该事件转发到 BindingList 事件。

```
 class Example
    {
        private BindingList<string> m_names = new BindingList<string>();
        public IEnumerable<string> Names { get { return m_names; } }
        public event AddingNewEventHandler NamesAdded
        {
            add { m_names.AddingNew += value; }
            remove { m_names.AddingNew -= value; }
        }
        public void Add(string name)
        {
            m_names.Add(name);
        }
    } 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-20T12:57:41.077

您应该检查[System.ComponentModel.BindingList](http://msdn.microsoft.com/en-us/library/ms132680.aspx)，特别是[ListChanged 事件](http://msdn.microsoft.com/en-us/library/ms132742.aspx)。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-20T13:08:47.043

BindingList 的一种替代方法是[ObservableCollection](http://msdn.microsoft.com/en-us/library/ms668604.aspx) - 在这种情况下，您希望将自己的事件处理程序订阅到[CollectionChanged](http://msdn.microsoft.com/en-us/library/ms653375.aspx)事件并根据操作触发您的事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T13:06:33.040

David Mohundro 展示了一种方法；另一种选择是从 Collection<T> 继承并覆盖各种方法：

```
class Foo {}
class FooCollection : Collection<Foo>
{
    protected override void InsertItem(int index, Foo item)
    {
        // your code...
        base.InsertItem(index, item);
    }
    protected override void SetItem(int index, Foo item)
    {
        // your code...
        base.SetItem(index, item);
    }
    // etc
} 
```

最后，您可以根据第一原则创建自己的列表 (IList, IList<T>) - 工作量大，收益少。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T13:33:28.603

一种非正统的方法可能是使用诸如 PostSharp 之类的 AOP 框架在调用访问器之前/之后“编织”一个处理程序，这会触发一个事件。

您创建一个外部类，其中包含访问属性时的 pre 和/或 post 处理代码，检查属性的值是否在 pre 和 post 之间发生变化，并引发事件。

请记住，在获取值进行比较时（在您的处理程序代码中），您可能会进入一个无限循环（您调用属性访问器，它调用 AOP 处理程序，它调用访问器等等），所以您可能需要反映到包含此属性的类中以获取支持字段。

# c# - 将字符串集放入表示层

> ID：218325
> 
> 赞同：0
> 
> 时间：2008-10-20T12:52:45.860
> 
> 标签：c#, nhibernate, oop, mapping, domain-driven-design

我们正在开发一个使用 C# 编写并使用 NHibernate 将对象映射到数据库的医院信息系统。MVC 模式用于将业务逻辑与 UI 分离。问题来了，

如何将可变大小的不同字符串集传递给 UI？

例如，一个`Contact`对象有一个名为的属性，该属性`City`保存了哪个城市联系人居住。在编写应用程序的国家/地区有 80 多个城市。你怎么能把这些城市写到一个组合框中？（或数据网格、表格……）在此示例中，城市编号是固定的。很长一段时间没有必要添加另一个城市。（如果城市列表发生变化，重新编译不是问题）

例如，一个`Contact`对象有另一个名为的属性`FooBar`，它将保存 1000 个不同的字符串值，这些值将从该属性的组合框中选择。如果用户愿意，这个集合可以增长。您如何使用这些值加载组合框？（如果字符串列表静态写入组合框对象，重新编译是有问题的）

我有不同的解决方案如下

1.  在代码或设计器中静态写入组合框的所有字符串值
2.  从资源文件中获取值
3.  将这些值写入 XML 文件（实际上与上面相同，但无需重新编译）
4.  使用 NHibernate创建一个`City`对象并将值从表中获取到列表中`CITY`
5.  创建一个`StringHolder`具有`Type`and`Value`属性的类。所有字符串值（包括`City`和`FooBar`）都将写入一个名为 的表中`STRINGHOLDER`。并通过 NHibernate 使用“CITY”或“FOOBAR”等键获取这些值。

你会选哪一个？或者你能给我推荐一个吗？

谢谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T13:01:47.323

我会投票支持解决方案#4。这就是我在类似情况下一直这样做的方式。这似乎是一个更清洁的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T13:16:52.783

如果这些位置实际上要用于任何事情，请将它们放入数据库中。如果数据“没有真正使用”，但提供了城市查询以使用户界面更好，那么 XML 文件选项也不是一个坏方法。

通过使用，我的意思是*列出纽约的所有员工之*类的东西。如果它是“死数据”，只是为了显示，请选择需要最少工作量和最小风险的解决方案 - 这可能是文件选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T17:54:18.997

您对使用 List<string> 获取城市列表有何感受？在 DAL 或 BL 中加载此字符串列表，然后将其传递给 UI。

同样的解决方案也应该适用于 FooBar 值。

如果您有与 City 或 FooBar 相关联的 ID，例如 NY，并且它在 DB 中的数字 ID 为 1，那么您可以使用 KeyValuePair<TKey, TValue>。使用泛型，您可以指定此 KeyValuePair 中的数据。城市名称或 FooBar 的字符串值可以是键，数字 ID 可以是值。

只需2美分。

# oracle - 使用 Oracle ODBC 的准备语句与直接语句的差异

> ID：218332
> 
> 赞同：1
> 
> 时间：2008-10-20T12:57:40.047
> 
> 标签：oracle, odbc, prepared-statement, collation

我正在使用与我的操作系统语言不同的排序规则的 Oracle 数据库。我正在使用 ODBC 驱动程序访问数据库。当我准备一个语句（例如“select * from x where=?”）时，它涉及数据库排序规则支持的特殊非 ASCII 字符，我正在查找带有字符的数据行。当我直接使用sql字符串中的参数执行选择时，找不到数据行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T13:11:12.843

纯粹是我的猜测，但这可能是因为您的客户端计算机没有使用正确写入的参数对 sql 字符串进行编码。我认为，如果您的客户端设置为与 DB 排序规则不同的区域设置，则包含发送到 Oracle 的选择语句的字符数组将包含原始时髦字符所在的“不正确”字节 - Oracle 会将这些解释为一些不是您最初发送的字符（导致找不到该行）。

有什么理由不能只使用参数化方法（因为它工作正常）？

# sql-server - 是否可以编写 MS SQL Server 插件？

> ID：218335
> 
> 赞同：0
> 
> 时间：2008-10-20T12:58:46.923
> 
> 标签：sql-server, database, add-in

是否可以编写 MS SQL Server 插件？我正在考虑一些与 SQL Server Enterprise Manager 可用的数据库服务器集成的应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T13:37:09.623

您是否考虑过使用扩展存储过程来提供类似插件的功能？

唯一的问题是在企业管理器中查看它，但您可能可以使用 Martin 的帖子作为一种方法。

[http://support.microsoft.com/kb/190987](http://support.microsoft.com/kb/190987)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-23T04:45:24.017

我不确定这是否为时已晚，但这里有一些我用来开始编写 SSMS 插件的链接。

[http://jcooney.net/archive/2007/11/26/55358.aspx](http://jcooney.net/archive/2007/11/26/55358.aspx)

[http://www.karpach.com/ViewArticle.aspx?ArticleFileName=SQL-Server-Managment-Studio-Object-Explorer-Search-Add-In.htm](http://www.karpach.com/ViewArticle.aspx?ArticleFileName=SQL-Server-Managment-Studio-Object-Explorer-Search-Add-In.htm)

[http://sqlblogcasts.com/blogs/jonsayce/archive/2008/01/15/building-a-sql-server-management-studio-addin.aspx](http://sqlblogcasts.com/blogs/jonsayce/archive/2008/01/15/building-a-sql-server-management-studio-addin.aspx)

[http://aspalliance.com/1374_Extend_Functionality_in_SQL_Server_2005_Management_Studio_with_Addins.all](http://aspalliance.com/1374_Extend_Functionality_in_SQL_Server_2005_Management_Studio_with_Addins.all)

我希望这有帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-20T13:44:04.087

您可能会考虑研究扩展存储过程。它们是将 C++ 逻辑集成到 SQLServer 中的一种方式。似乎它们正在逐步淘汰以支持 CLR 集成，但可能会发现一些非常好的想法，即看看人们对它们做了什么。

总是让我害怕扩展存储过程的一件事是，如果您的代码崩溃，整个数据库就会崩溃。它们在 SQL Server 进程中运行，并且保护有限。

MSDN 链接： [数据库引擎扩展存储过程编程](http://msdn.microsoft.com/en-us/library/ms164716.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T13:09:15.717

您可以在 MS SQL Server 2005 和 2008 数据库中包含很多内容。包括 .Net 代码。但是没有真正的方法来扩展（创建插件）管理工作室。（以前的企业经理。）

但是有 Visual Studio 的数据库管理插件（尤其是在 Team System 中）。也许你可以在那里实现你所需要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T13:11:52.483

我没有直接知道。在 SQL Server Management Studio（适用于 2005 年及更高版本）中，至少有一个非常简单的系统可以将外部工具添加到菜单中。企业管理器可能有类似的东西。因此，您可以构建一个应用程序来执行您想要的任何操作并将其添加到您的菜单中。

诀窍是部署。几乎可以肯定有一种方法可以将您的应用程序作为安装包的一部分添加到菜单中，但我不必自己搞砸它。此外，听起来您真正想做的是将系统部署到数据库中，并让企业管理器自动检测它。我很确定你不能那样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-20T13:34:02.780

SQL Server 企业管理器只是 Microsoft 管理控制台的一个实例。如果您查看快捷方式，它的命令行是这样的：

```
C:\WINDOWS\system32\mmc.exe /32 "C:\WINDOWS\system32\SQLServerManager.msc" 
```

您应该能够在树层次结构中创建位于 SQL Server 旁边的新 Snap In。

看看[http://msdn.microsoft.com/en-us/library/ms692755(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms692755(VS.85).aspx)看看这是如何完成的。

# nhibernate - 在 NHibernate 中将多个值映射到值对象

> ID：218337
> 
> 赞同：-1
> 
> 时间：2008-10-20T13:00:06.297
> 
> 标签：nhibernate, orm, mapping

我对 NHibernate 还很陌生，虽然我在网上找到了大量关于 NHibernate 映射的信息，但我太傻了，找不到这条信息。

所以问题是，我有以下模型：

![数据模型](https://i.stack.imgur.com/DihaU.jpg)

这就是我希望它看起来的样子。一个有两个地址属性的干净的人。

在数据库中，我想将其保存在一个表中。所以 Person 行会有一个 ShippingStreetname 和一个 Streetname 列，一个映射到 ShippingAddress.Streetname，另一个映射到 Address.StreetName

我找到了[一篇关于 fluent interfaces](http://nhforge.org/blogs/nhibernate/archive/2008/09/06/a-fluent-interface-to-nhibernate-part-2-value-objects.aspx)的文章，但还没有弄清楚如何通过 XML 配置来做到这一点。

提前致谢！

更新：我自己找到了解决方案。这可以通过节点来完成，而且工作相当简单。

为了实现 Address 和 ShippingAddress 的映射，我只需将以下内容添加到

```
<component name="Address" class="Address">
  <property name="Streetname"></property>
  <property name="Zip"></property>
  <property name="City"></property>
  <property name="Country"></property>
</component>

<component name="ShippingAddress" class="Address">
  <property name="Streetname" column="ShippingStreetname" />
  <property name="Zip" column="ShippingZip" />
  <property name="City" column="ShippingCity" />
  <property name="Country" column="ShippingCountry" />
</component> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T14:18:02.270

行。我自己找到了解决方案。关键是 XML 配置中的构造，它工作得相当好。

这是如何完成的：

```
<component name="Address" class="Address">
  <property name="Streetname"></property>
  <property name="Zip"></property>
  <property name="City"></property>
  <property name="Country"></property>
</component>

<component name="ShippingAddress" class="Address">
  <property name="Streetname" column="ShippingStreetname" />
  <property name="Zip" column="ShippingZip" />
  <property name="City" column="ShippingCity" />
  <property name="Country" column="ShippingCountry" />
</component> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T13:11:03.420

您可以将其配置为两个关系。例如

```
<many-to-one name="ShippingAddress" class="Yournamespace.Address"/>
<many-to-one name="Address" class="Yournamespace.Address"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-07T20:53:33.427

您甚至不需要地址的 ID。想想维护一个 ID 是多么昂贵。你有并发问题，你需要唯一性，等等。这是 ValueObjects 的目标（不要与 System.ValueObject 混淆，请参阅 DDD 的 ValueObject 定义）。在这种情况下，Address 是一个 ValueObject，因此它不需要 Id。如果您需要一个地址集合，您可以将其映射为“”，请参见[http://www.nhforge.org/doc/nh/en/index.html#collections-ofvalues](http://www.nhforge.org/doc/nh/en/index.html#collections-ofvalues)。

# asp.net - 在 CMS 中快速/轻松地生成 CRUD 页面和数据访问层

> ID：218343
> 
> 赞同：1
> 
> 时间：2008-10-20T13:02:58.290
> 
> 标签：asp.net, subsonic, data-access-layer

我有一个我想要从中生成类文件的数据库，以及一个生成的 .aspx 页面，其中包含一个列表视图，用于与类文件交互以进行创建/读取/更新/删除。我已经开始使用 Subsonic，但不确定脚手架控制有多灵活。此外，LINQ 似乎是一种选择，但如果生成它会很好。

理想情况下，我会有一个 DAL，它是一组数据库类，因此我可以微调我想要的任何东西，并且它还会为带有 listview/datagrid 的 Web 界面输出一个 Web 表单，我可以将其合并到后端但会生成输出，所以如果我愿意，我可以自己微调它。

提前致谢。我问的原因是因为我正在独立从事一个项目，而数据访问操作始终是其中最耗时的部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T13:31:10.430

**[ASP.NET 动态数据](http://en.wikipedia.org/wiki/ASP.NET_Dynamic_Data)**非常棒！大约一个月前在 MSDN Live 上看到了一个非常酷的演示。在 1 分钟内从数据库创建一个完整的 .net 3.5 网站！！！与 Ruby on Rails 的想法相同，有点。

然后您可以增强、配置和修改您想要的站点部分。基本上你会得到一个 LINQ 2 SQL 层 + 一些脚手架，然后你可以根据自己的喜好进行修改。任何以数据为中心的 Web 项目的快速入门。

并且脚手架部分可能会被引入 .net 框架的其他部分——比如 WPF 和 silverlight——所以这项技术是人们应该知道的。

而且由于它是 .net 框架的一部分，它基本上是免费的，这也不是一件坏事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T13:17:22.923

您应该查看[LLBLGen](http://www.llblgen.com) - 这是一款很棒的产品！不确定它在 ASPX 方面的表现如何，但我知道它确实包含该功能，并且至少在将 DAL 生成为可以包含在解决方案中的 .net 项目方面做得非常好。

希望有帮助:)

# java - Java Connection.close 是否回滚？

> ID：218350
> 
> 赞同：17
> 
> 时间：2008-10-20T13:07:05.643
> 
> 标签：java, transactions, database-connection

Java Connection.close 是否回滚到 finally 块？

我知道 .Net SqlConnection.close 做到了。

有了这个，我可以在没有捕获的情况下进行 try/finally 块......

例子：

```
try {
    conn.setAutoCommit(false);
    ResultSet rs = executeQuery(conn, ...);
    ....
    executeNonQuery(conn, ...);
    ....

    conn.commit();
} finally {
   conn.close();
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-10-20T13:49:35.900

根据[javadoc](http://java.sun.com/javase/6/docs/api/java/sql/Connection.html#close())，您应该在调用 close 方法之前尝试提交或回滚。否则结果是实现定义的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-21T19:23:05.493

在我使用过的任何数据库系统中，在提交后立即进行回滚是没有害处的，因此，如果您在 try 块中提交并在 finally 中回滚，事情就会被提交，而如果异常或提前返回导致错过的提交，回滚将回滚事务。所以安全的做法是

```
try {
    conn.setAutoCommit(false);
    ResultSet rs = executeQuery(conn, ...);
    ....
    executeNonQuery(conn, ...);
    ....

    conn.commit();
} finally {
   conn.rollback();
   conn.close();
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-20T14:29:52.403

[默认情况下，Oracle 的 JDBC 驱动程序在 close() 上提交。](http://swik.net/Hibernate/Hibernate+GroupBlog/Pop+Quiz:+Does+Connection.close()+result+in+commit+or+rollback+%3F) 如果您打算编写多平台 JDBC 代码，则不应依赖此行为。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-02-28T12:15:13.997

不同数据库之间的行为完全不同。例子：

### 甲骨文

当关闭与打开事务的连接时，事务被提交（正如@Mr. Shiny 和 New 安宇所说。

### SQL 服务器

> 在事务中间调用 close 方法会导致事务回滚。

[关闭方法（SQLServerConnection）](http://msdn.microsoft.com/en-us/library/ms378993.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-02T00:45:06.137

For MySQL JDBC, the implementation rolls back the connection if closed without a call to commit or rollback methods.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-02-08T16:49:28.710

在 finally 块中回滚是没有用的。提交之后，并且提交成功，为什么要回滚？所以如果我是你，我会在 catch 块中回滚。

# c# - 如何获取通用列表中的比较项目

> ID：218359
> 
> 赞同：3
> 
> 时间：2008-10-20T13:11:02.937
> 
> 标签：c#

我有一个实现该 IComparable 的自定义类。此类存储在通用列表中。我现在需要与列表进行比较，以查看哪些对象在列表 A 中但不在列表 B 中。

我认为最简单的方法是遍历列表 B 并执行 A.contains()。

我不知道如何让它使用我的 CompareTo() （或我可以覆盖的另一种方法，以便我可以说它是否包含某个对象）。我可能是错的，但据我了解，包含检查对象是否实际上相同（即指向内存中的同一位置）。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-20T13:13:46.300

你为什么不直接重写`Equals`你的类的方法以使其含义一致`CompareTo(other) == 0`？这是最简单的方法，也是最惯用的方法，因为正如您所注意到的，`Contains`比较相等而不是使用`CompareTo`. 但是，此检查是通过`Equals`. 它不*检查*对象是否指向相同的内存位置。

/编辑：此外，如果您使用的是 .NET 3.5，则可以使用[`Contains`](http://msdn.microsoft.com/en-us/library/bb339118.aspx)接受`IEqualityComparer`参数的重载。您可以使用它来提供一个为您的类类型实现自定义相等关系的类。但是，我认为第一种方法更适合您的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T13:30:19.170

此外，如果您使用的是 framework 3.5，您可以进行如下查询：

list notInB = 从 listA 中的项目 where (listB.find(function(x) x.property = item.property) = nothing) 选择项目

这将返回 listA 中所有不在 listB 中的项目。

The linq function find returns the item that matches de condition that you write in the lambda function. There you can add more conditions using and (&&)or or (||)

If you use this, there is no need to implement IComparable.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T13:22:42.010

感谢康拉德提供如此快速而有帮助的回复。工作了一个款待！我最初使用 IComparable 是因为我需要根据某些标准对它们进行排序，但覆盖 equals 对 .contains 非常有效。

:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T13:25:32.517

> 它包含检查对象是否实际上相同（即指向内存中的同一位置）

请注意，即使它们不指向内存中的同一位置，对象也可以相等。这取决于如何实现 EqualsTo 方法。

我同意鲁道夫的观点，即您首先尝试重载 EqualsTo()。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T13:32:00.540

There is also IEquatable and if your object implements that interface, then it is automatically used by all the generic collections if its implemented. Though I never quite understood why it existed in the first place, since the docs say that if you implement IEquatable, then you should also override Equals to match. Also remember if you are going to override Equals, that you need to also override GetHashCode as well.

# java - 什么是 NullPointerException，我该如何解决？

> ID：218384
> 
> 赞同：209
> 
> 时间：2008-10-20T13:18:09.913
> 
> 标签：java, nullpointerexception

什么是空指针异常 ( `java.lang.NullPointerException`) 以及导致它们的原因？

可以使用哪些方法/工具来确定原因，以便阻止异常导致程序过早终止？

* * *

## 回答 #1

> 赞同：4074
> 
> 时间：2008-10-20T13:54:24.253

当您声明一个引用变量（即一个对象）时，您实际上是在创建一个指向对象的指针。考虑以下代码，您在其中声明了一个原始类型的变量`int`：

```
int x;
x = 10; 
```

在这个例子中，变量`x`是一个`int`，Java 会`0`为你初始化它。当您`10`在第二行分配 的值时，您的值将`10`写入 引用的内存位置`x`。

但是，当您尝试声明引用*类型*时，会发生不同的事情。采取以下代码：

```
Integer num;
num = new Integer(10); 
```

第一行声明了一个名为 的变量`num`，但它实际上还没有包含原始值。相反，它包含一个指针（因为类型是`Integer`引用类型）。由于您还没有说要指向什么，Java 将它设置为`null`，这意味着“**我没有指向*任何东西***”。

在第二行中，`new`关键字用于实例化（或创建）类型的对象`Integer`，并将指针变量`num`分配给该`Integer`对象。

( `NullPointerException`NPE) 发生在您声明一个变量但没有创建对象并将其分配给变量之前尝试使用变量的内容（称为*解引用*）。所以你指向的东西实际上并不存在。

解引用通常发生在`.`用于访问方法或字段，或`[`用于索引数组时。

如果您在创建对象`num` *之前*尝试取消引用，则会得到一个`NullPointerException`. 在最琐碎的情况下，编译器会发现问题并让您知道“” `num may not have been initialized`，但有时您可能会编写不直接创建对象的代码。

例如，您可能有如下方法：

```
public void doSomething(SomeObject obj) {
   // Do something to obj, assumes obj is not null
   obj.myMethod();
} 
```

在这种情况下，您不是在创建 object `obj`，而是假设它是在`doSomething()`调用方法之前创建的。请注意，可以像这样调用该方法：

```
doSomething(null); 
```

在这种情况下，`obj`is `null`，并且该语句`obj.myMethod()`将抛出`NullPointerException`。

如果该方法打算像上面的方法那样对传入的对象执行某些操作，则抛出 是合适的，`NullPointerException`因为这是程序员错误，程序员将需要该信息进行调试。

除了`NullPointerException`作为方法逻辑的结果抛出 s 之外，您还可以通过在方法`null`开头附近添加类似以下内容来检查方法参数的值并显式抛出 NPE：

```
// Throws an NPE with a custom error message if obj is null
Objects.requireNonNull(obj, "obj must not be null"); 
```

请注意，在错误消息中清楚地说明*哪个*对象不能是很有帮助的`null`。验证这一点的好处是 1) 您可以返回自己更清晰的错误消息，以及 2) 对于您知道的其余方法，除非`obj`重新分配，否则它不为 null 并且可以安全地取消引用。

或者，可能存在方法的目的不仅仅是对传入的对象进行操作的情况，因此可以接受空参数。在这种情况下，您需要检查**空参数**并采取不同的行为。您还应该在文档中解释这一点。例如，`doSomething()`可以写成：

```
/**
  * @param obj An optional foo for ____. May be null, in which case
  *  the result will be ____.
  */
public void doSomething(SomeObject obj) {
    if(obj == null) {
       // Do something
    } else {
       // Do something else
    }
} 
```

最后，[如何使用 Stack Trace 查明异常和原因](https://stackoverflow.com/q/3988788/2775450)

> 可以使用哪些方法/工具来确定原因，以便阻止异常导致程序过早终止？

带有查找错误的声纳可以检测 NPE。 [sonar能否动态捕捉JVM引起的空指针异常](https://stackoverflow.com/questions/20899931/can-sonar-catch-null-pointer-exceptions-caused-by-jvm-dynamically)

现在 Java 14 添加了一个新的语言特性来显示 NullPointerException 的根本原因。自 2006 年以来，此语言功能已成为 SAP 商业 JVM 的一部分。

在 Java 14 中，以下是示例 NullPointerException 异常消息：

> 在线程“main”中 java.lang.NullPointerException：无法调用“java.util.List.size()”，因为“list”为空

* * *

## 回答 #2

> 赞同：932
> 
> 时间：2008-10-20T13:20:44.260

`NullPointerException`s 是当您尝试使用指向内存中没有位置 (null) 的引用时发生的异常，就好像它正在引用一个对象一样。在空引用上调用方法或尝试访问空引用的字段将触发`NullPointerException`. [`NullPointerException`](http://docs.oracle.com/javase/7/docs/api/java/lang/NullPointerException.html)这些是最常见的，但其他方法在javadoc 页面上列出。

可能我能想出的最快的示例代码来说明 a`NullPointerException`将是：

```
public class Example {

    public static void main(String[] args) {
        Object obj = null;
        obj.hashCode();
    }

} 
```

在里面的第一行`main`，我明确地将`Object`引用设置`obj`为`null`。这意味着我有一个引用，但它没有指向任何对象。之后，我尝试通过调用一个方法来将引用视为指向一个对象。这会导致 a `NullPointerException`，因为在引用指向的位置没有要执行的代码。

（这是一个技术性问题，但我认为值得一提：指向 null 的引用与指向无效内存位置的 C 指针不同。空指针实际上并不指向*任何地方*，这与指向一个碰巧无效的位置。）

* * *

## 回答 #3

> 赞同：729
> 
> 时间：2014-06-07T19:22:14.450

# 什么是 NullPointerException？

[JavaDocs](http://docs.oracle.com/javase/8/docs/api/java/lang/NullPointerException.html)是一个很好的起点。他们涵盖了以下内容：

> 当应用程序在需要对象的情况下尝试使用 null 时引发。这些包括：
> 
> *   调用空对象的实例方法。
> *   访问或修改空对象的字段。
> *   将 null 的长度视为一个数组。
> *   访问或修改 null 的槽，就像它是一个数组一样。
> *   把 null 当作一个 Throwable 值来抛出。
> 
> 应用程序应抛出此类的实例以指示空对象的其他非法使用。

[根据 JLS](https://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.19)，如果您尝试使用 null 引用`synchronized`，也会引发此异常：

> ```
> SynchronizedStatement:
>     synchronized ( Expression ) Block 
> ```
> 
> *   否则，如果 Expression 的值为 null，`NullPointerException`则抛出 a。

# 我如何解决它？

所以你有一个`NullPointerException`. 你如何解决它？让我们举一个简单的例子，它抛出一个`NullPointerException`：

```
public class Printer {
    private String name;

    public void setName(String name) {
        this.name = name;
    }

    public void print() {
        printString(name);
    }

    private void printString(String s) {
        System.out.println(s + " (" + s.length() + ")");
    }

    public static void main(String[] args) {
        Printer printer = new Printer();
        printer.print();
    }
} 
```

**识别空值**

第一步是准确识别*导致异常的值*。为此，我们需要进行一些调试。学习阅读*堆栈跟踪*很重要。这将向您显示引发异常的位置：

```
Exception in thread "main" java.lang.NullPointerException
    at Printer.printString(Printer.java:13)
    at Printer.print(Printer.java:9)
    at Printer.main(Printer.java:19) 
```

在这里，我们看到在第 13 行（在`printString`方法中）抛出了异常。*查看该行并通过添加日志记录语句*或使用*调试器*检查哪些值为空。我们发现它`s`是空的，调用它的`length`方法会抛出异常。我们可以看到，当`s.length()`从方法中删除时，程序停止抛出异常。

**跟踪这些值的来源**

接下来检查该值的来源。通过跟踪方法的调用者，我们看到在方法`s`中传入了with ，并且为null。`printString(name)``print()``this.name`

**跟踪应该设置这些值的位置**

在哪里`this.name`设置？在`setName(String)`方法中。通过更多的调试，我们可以看到这个方法根本没有被调用。如果调用了该方法，请务必检查这些方法的调用*顺序*，并且 set 方法不会在print 方法*之后调用。*

这足以给我们一个解决方案：在调用`printer.setName()`之前添加一个调用`printer.print()`。

# 其他修复

该变量可以有一个*默认值*（并且`setName`可以防止它被设置为空）：

```
private String name = ""; 
```

or`print`方法`printString`可以*检查 null*，例如：

```
printString((name == null) ? "" : name); 
```

或者您可以设计该类，使其`name` *始终具有非空值*：

```
public class Printer {
    private final String name;

    public Printer(String name) {
        this.name = Objects.requireNonNull(name);
    }

    public void print() {
        printString(name);
    }

    private void printString(String s) {
        System.out.println(s + " (" + s.length() + ")");
    }

    public static void main(String[] args) {
        Printer printer = new Printer("123");
        printer.print();
    }
} 
```

**也可以看看：**

*   [在 Java 中避免“！= null”语句？](https://stackoverflow.com/questions/271526/avoiding-null-statements-in-java)

# 我还是找不到问题

如果您尝试调试问题但仍然没有解决方案，您可以发布问题以获得更多帮助，但请确保包含您迄今为止尝试过的内容。至少，在问题中**包含堆栈跟踪，并在代码中****标记重要的行号**。另外，请先尝试简化代码（请参阅[SSCCE](http://sscce.org/)）。

* * *

## 回答 #4

> 赞同：537
> 
> 时间：2014-06-22T02:16:56.530

## 问题：是什么导致`NullPointerException`（NPE）？

如您所知，Java 类型分为*原始类型*（`boolean`、`int`等）和*引用类型*。Java 中的引用类型允许您使用特殊值`null`，这是 Java 表示“无对象”的方式。

`NullPointerException`每当您的程序尝试使用 a 时，就会在运行时抛出A `null`，就好像它是一个真正的引用一样。例如，如果你这样写：

```
public class Test {
    public static void main(String[] args) {
        String foo = null;
        int length = foo.length();   // HERE
    }
} 
```

标记为“HERE”的语句将尝试`length()`在引用上运行该方法`null`，这将抛出一个`NullPointerException`.

您可以通过多种方式使用`null`会产生`NullPointerException`. 事实上，你*可以*用 a`null`而不会导致 NPE 的唯一事情是：

*   将其分配给参考变量或从参考变量中读取，
*   将其分配给数组元素或从数组元素中读取（前提是数组引用本身不为空！），
*   将其作为参数传递或将其作为结果返回，或者
*   使用`==`or`!=`运算符或`instanceof`.

## 问题：如何阅读 NPE 堆栈跟踪？

假设我编译并运行上面的程序：

```
$ javac Test.java 
$ java Test
Exception in thread "main" java.lang.NullPointerException
    at Test.main(Test.java:4)
$ 
```

第一次观察：编译成功！程序中的问题不是编译错误。这是一个*运行时*错误。（某些 IDE 可能会警告您的程序总是会抛出异常……但标准`javac`编译器不会。）

第二个观察：当我运行程序时，它输出两行“gobbledy-gook”。**错误的！！**那不是狼吞虎咽。它是一个堆栈跟踪……它提供了*重要的信息*，如果您花时间仔细阅读，可以帮助您追踪代码中的错误。

那么让我们看看它是怎么说的：

```
Exception in thread "main" java.lang.NullPointerException 
```

堆栈跟踪的第一行告诉你一些事情：

*   它告诉您抛出异常的 Java 线程的名称。对于一个有一个线程的简单程序（比如这个），它将是“main”。让我们继续前进 ...
*   它告诉你抛出的异常的全名；即`java.lang.NullPointerException`。
*   如果异常有关联的错误消息，则会在异常名称之后输出。`NullPointerException`在这方面是不寻常的，因为它很少有错误消息。

第二行是诊断 NPE 中最重要的一行。

```
at Test.main(Test.java:4) 
```

这告诉我们很多事情：

*   “at Test.main”表示我们在类的`main`方法中`Test`。
*   “Test.java:4”给出了类的源文件名，它告诉我们发生这种情况的语句在文件的第 4 行。

如果您计算上面文件中的行数，第 4 行是我用“HERE”注释标记的行。

请注意，在更复杂的示例中，NPE 堆栈跟踪中会有很多行。但是您可以确定第二行（第一行“at”行）会告诉您 NPE 被抛出的位置¹。

简而言之，堆栈跟踪将明确地告诉我们程序的哪个语句抛出了 NPE。

另请参阅：[什么是堆栈跟踪，以及如何使用它来调试我的应用程序错误？](https://stackoverflow.com/q/3988788/2775450)

^(1 - 不完全正确。有些东西叫做嵌套异常......)

## 问题：如何在我的代码中追踪 NPE 异常的原因？

这是困难的部分。简短的回答是将逻辑推理应用于堆栈跟踪、源代码和相关 API 文档提供的证据。

让我们先用简单的例子（上面）来说明。我们首先查看堆栈跟踪告诉我们发生 NPE 的位置：

```
int length = foo.length(); // HERE 
```

那怎么能抛出NPE？

事实上，只有一种方法：只有当它`foo`具有 value时才会发生`null`。然后我们尝试运行该`length()`方法，`null`然后……砰！

但是（我听到你说）如果在`length()`方法调用中抛出 NPE 怎么办？

好吧，如果发生这种情况，堆栈跟踪看起来会有所不同。第一个“at”行表示异常是在`java.lang.String`类中的某行中引发的，第 4`Test.java`行将是第二个“at”行。

那么它是`null`从哪里来的呢？在这种情况下，很明显，很明显我们需要做些什么来修复它。（为 分配一个非空值`foo`。）

好的，让我们尝试一个稍微复杂一点的例子。这将需要一些*逻辑推论*。

```
public class Test {

    private static String[] foo = new String[2];

    private static int test(String[] bar, int pos) {
        return bar[pos].length();
    }

    public static void main(String[] args) {
        int length = test(foo, 1);
    }
}

$ javac Test.java 
$ java Test
Exception in thread "main" java.lang.NullPointerException
    at Test.test(Test.java:6)
    at Test.main(Test.java:10)
$ 
```

所以现在我们有两条“at”行。第一个是针对这一行的：

```
return args[pos].length(); 
```

第二个是针对这一行的：

```
int length = test(foo, 1); 
```

看看第一行，那怎么会抛出 NPE？有两种方法：

*   如果值为`bar`is `null`then`bar[pos]`将抛出 NPE。
*   如果 的值为`bar[pos]`然后`null`调用`length()`它将抛出 NPE。

接下来，我们需要弄清楚哪些场景可以解释实际发生的事情。我们将从探索第一个开始：

从哪里来`bar`？它是`test`方法调用的一个参数，如果我们看看是如何`test`调用的，我们可以看到它来自`foo`静态变量。此外，我们可以清楚地看到，我们初始化`foo`为一个非空值。这足以暂时否定这种解释。（理论上，其他东西可能会*变成* `foo`……`null`但这里不会发生这种情况。）

那么我们的第二种情况呢？好吧，我们可以看到`pos`是`1`，所以这意味着`foo[1]`一定是`null`。这可能吗？

它的确是！这就是问题所在。当我们这样初始化时：

```
private static String[] foo = new String[2]; 
```

我们为 a 分配了两个*初始化为*`String[]`的元素。在那之后，我们没有改变...的内容，所以仍然是。*`null`*`foo``foo[1]``null`

## 在安卓上呢？

在 Android 上，追踪 NPE 的直接原因要简单一些。异常消息通常会告诉您正在使用的空引用的（编译时）类型以及*您*在抛出 NPE 时尝试调用的方法。这简化了查明直接原因的过程。

但另一方面，Android 对 NPE 有一些常见的特定于平台的原因。一个很常见的情况是`getViewById`意外返回一个`null`. `null`我的建议是搜索有关意外返回值原因的问答。

* * *

## 回答 #5

> 赞同：444
> 
> 时间：2008-10-20T13:21:21.590

这就像你试图访问一个对象，它是`null`. 考虑下面的例子：

```
TypeA objA; 
```

此时您刚刚**声明**了该对象，但尚未**初始化或实例化**。并且每当您尝试访问其中的任何属性或方法时，它都会抛出 `NullPointerException`这是有道理的。

请参见下面的示例：

```
String a = null;
System.out.println(a.toString()); // NullPointerException will be thrown 
```

* * *

## 回答 #6

> 赞同：374
> 
> 时间：2013-04-17T02:57:16.383

当应用程序在需要对象的情况下尝试使用 null 时，将引发空指针异常。这些包括：

1.  调用`null`对象的实例方法。
2.  访问或修改`null`对象的字段。
3.  `null`就好像它是一个数组一样的长度。
4.  访问或修改 的插槽，`null`就好像它是一个数组一样。
5.  `null`像 Throwable 值一样进行投掷。

应用程序应抛出此类的实例以指示`null`对象的其他非法用途。

参考：[http ://docs.oracle.com/javase/8/docs/api/java/lang/NullPointerException.html](http://docs.oracle.com/javase/8/docs/api/java/lang/NullPointerException.html)

* * *

## 回答 #7

> 赞同：351
> 
> 时间：2008-10-20T13:25:08.277

`null`指针是不指向任何地方的指针。当您取消引用指针`p`时，您说“给我存储在“p”中的位置的数据。当`p`是`null`指针时，存储在的位置`p`是`nowhere`，您说的是“给我在'无处'位置的数据”。显然，它不能这样做，所以它抛出一个`null pointer exception`.

一般来说，这是因为一些东西没有被正确初始化。

* * *

## 回答 #8

> 赞同：339
> 
> 时间：2014-06-25T11:17:08.903

已经有很多解释来解释它是如何发生的以及如何修复它，但你也应该遵循**最佳实践**来完全避免[`NullPointerException`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/NullPointerException.html)s。

另请参阅： [最佳实践的良好列表](http://javarevisited.blogspot.com/2013/05/ava-tips-and-best-practices-to-avoid-nullpointerexception-program-application.html)

我要补充一点，非常重要的是，善用`final`修饰符。 [在 Java 中适用时使用“final”修饰符](https://stackoverflow.com/questions/137868/using-final-modifier-whenever-applicable-in-java)

**概括：**

1.  使用`final`修饰符来强制执行良好的初始化。
2.  避免在方法中返回 null，例如在适用时返回空集合。
3.  使用注释[`@NotNull`](https://javaee.github.io/javaee-spec/javadocs/javax/validation/constraints/NotNull.html)和[`@Nullable`](https://javadoc.io/static/com.github.spotbugs/spotbugs-annotations/3.1.12/edu/umd/cs/findbugs/annotations/Nullable.html)
4.  快速失败并使用断言来避免在整个应用程序中传播不应该为空的空对象。
5.  首先对已知对象使用 equals：`if("knownObject".equals(unknownObject)`
6.  更喜欢`valueOf()`.`toString()`
7.  使用空安全[`StringUtils`](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/StringUtils.html)方法`StringUtils.isEmpty(null)`。
8.  在方法中使用 Java 8 Optional 作为返回值，Optional 类提供了一种表示可选值而不是 null 引用的解决方案。

* * *

## 回答 #9

> 赞同：333
> 
> 时间：2012-01-28T06:45:54.253

在 Java 中，一切（不包括原始类型）都是类的形式。

如果你想使用任何对象，那么你有两个阶段：

1.  宣布
2.  初始化

例子：

*   宣言：`Object object;`
*   初始化：`object = new Object();`

数组概念也一样：

*   宣言：`Item item[] = new Item[5];`
*   初始化：`item[0] = new Item();`

如果你没有给出初始化部分，那么`NullPointerException`就会出现。

* * *

## 回答 #10

> 赞同：333
> 
> 时间：2013-09-24T06:01:46.620

空指针异常表明您正在使用对象但未对其进行初始化。

例如，下面是一个将在我们的代码中使用它的学生类。

```
public class Student {

    private int id;

    public int getId() {
        return this.id;
    }

    public setId(int newId) {
        this.id = newId;
    }
} 
```

下面的代码给你一个空指针异常。

```
public class School {

    Student student;

    public School() {
        try {
            student.getId();
        }
        catch(Exception e) {
            System.out.println("Null pointer exception");
        }
    }
} 
```

因为您正在使用`student`，但您忘记像下面显示的正确代码一样对其进行初始化：

```
public class School {

    Student student;

    public School() {
        try {
            student = new Student();
            student.setId(12);
            student.getId();
        }
        catch(Exception e) {
            System.out.println("Null pointer exception");
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：324
> 
> 时间：2008-10-20T20:05:30.790

在[Java](http://en.wikipedia.org/wiki/Java_%28programming_language%29)中，您声明的所有变量实际上都是对对象（或原语）的“引用”，而不是对象本身。

当您尝试执行一个对象方法时，引用会要求活动对象执行该方法。但是，如果引用引用的是 NULL（无、零、无效、nada），则该方法无法执行。然后运行时通过抛出 NullPointerException 让您知道这一点。

您的参考是“指向”null，因此是“Null -> Pointer”。

该对象位于 VM 内存空间中，访问它的唯一方法是使用`this`引用。举个例子：

```
public class Some {
    private int id;
    public int getId(){
        return this.id;
    }
    public setId( int newId ) {
        this.id = newId;
    }
} 
```

在你的代码的另一个地方：

```
Some reference = new Some();    // Point to a new object of type Some()
Some otherReference = null;     // Initiallly this points to NULL

reference.setId( 1 );           // Execute setId method, now private var id is 1

System.out.println( reference.getId() ); // Prints 1 to the console

otherReference = reference      // Now they both point to the only object.

reference = null;               // "reference" now point to null.

// But "otherReference" still point to the "real" object so this print 1 too...
System.out.println( otherReference.getId() );

// Guess what will happen
System.out.println( reference.getId() ); // :S Throws NullPointerException because "reference" is pointing to NULL remember... 
```

这是一件重要的事情 - 当不再有对对象的引用时（在上面的示例中，当`reference`两者`otherReference`都指向 null 时），那么该对象是“不可访问的”。我们无法使用它，因此该对象已准备好进行垃圾收集，并且在某个时候，VM 将释放该对象使用的内存并分配另一个。

* * *

## 回答 #12

> 赞同：297
> 
> 时间：2014-05-25T06:11:58.740

`NullPointerException`当声明一个对象数组，然后立即尝试取消引用其中的元素时，会发生另一种情况。

```
String[] phrases = new String[10];
String keyPhrase = "Bird";
for(String phrase : phrases) {
    System.out.println(phrase.equals(keyPhrase));
} 
```

^(如果颠倒比较顺序，则可以避免这种特殊的 NPE；即，`.equals`在保证的非空对象上使用。)

数组内的所有元素[都被初始化为其共同的初始值](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.5)；对于任何类型的对象数组，这意味着所有元素都是`null`.

您*必须*在访问或取消引用*之前*初始化数组中的元素。

```
String[] phrases = new String[] {"The bird", "A bird", "My bird", "Bird"};
String keyPhrase = "Bird";
for(String phrase : phrases) {
    System.out.println(phrase.equals(keyPhrase));
} 
```

# iphone - 在iphone中缝合图片

> ID：218388
> 
> 赞同：2
> 
> 时间：2008-10-20T13:20:15.897
> 
> 标签：iphone, cocoa-touch

我想并排缝合2张png。在 Cocoa 中，我会使用 [NSImage initWithSize]，然后只使用 drawInRect。

但是 UIImage 没有 initWithSize 类，我现在该怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-20T13:36:35.570

使用`UIGraphicsBeginImageContext()`，在其中绘制，然后使用`UIGraphicsGetImageFromCurrentImageContext()`。记得在`UIGraphicsEndImageContext()`之后弹出上下文。

如果您只想在屏幕上显示两个图像，则应避免创建额外的图像，因为设备上的可用内存有限。相反，使用适当`drawInRect:`的调用显示它们以避免复制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T13:39:46.453

如果您尝试创建包含两个组件图像的新图像，请尝试使用 UIGraphicsBeginImageContext(size) 和 UIGraphicsGetImageFromCurrentImageContext()。一起，这些应该可以让您创建一个您想要使用的大小的新图像，在其中绘制，并拉出一个新的 UIImage 对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-30T23:27:31.067

Apple 的 TheElements 演示 (AtomicElementViewController) 有一个很好的例子来说明如何做到这一点。以及如何创建反射和斜面外观。

# javascript - Ajax GET 请求：使用参数还是将数据放入 URL？

> ID：218399
> 
> 赞同：10
> 
> 时间：2008-10-20T13:22:42.133
> 
> 标签：javascript, ajax, prototypejs

在 Ajax GET 请求中将数据作为参数传递与 URL 的一部分相比有什么优势？

使用参数：

```
var ajax = new Ajax.Request('server.php',{
    parameters: 'store=11200&product=Meat',
    onSuccess: function(myData){whatever}
}); 
```

使用网址：

```
var ajax = new Ajax.Request('server.php?store=11200&product=Meat',{
    onSuccess: function(myData){whatever}
}); 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-20T13:27:27.583

使用该`parameters`参数的一个优点是您可以将它传递给类似`Hash`对象而不是字符串。（但是，如果您这样做，请确保将`method`参数设置为`"GET"`，因为 Prototype Ajax 请求的默认方法是 POST；有关更多详细信息，请参阅[Prototype Introduction to Ajax](http://www.prototypejs.org/learn/introduction-to-ajax)。）

另一个更符合您提供的示例的优点是您可以将请求 URL 与发送给它的选项分开。例如，如果您需要向几个不同的 URL 发送一堆类似的请求，这可能会很有用。（在这种情况下，为每个请求修改一个公共参数`Hash`可能比使用参数字符串更有用。）

有关详细信息，请参阅[Ajax 选项的原型文档](http://www.prototypejs.org/api/ajax/options)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-20T13:55:19.930

One of my favorite uses of **parameters** is to pass in all fields of a form without explicitly listing them:

```
new Ajax.Request('/myurl.php', {
  method:  'get',
  parameters:  $('myForm').serialize(),
  onSuccess:  successFunc(),
  onFailure:  failFunc()
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-20T13:32:37.293

*   易读性
*   易于使用对象并将其序列化 ( `{store: 11200, product: "Meat"}`)
*   易读性

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-20T14:25:29.683

To answer this, you should know the way the parameters work. HTTP basically (I know, there are more) has two methods to request data: GET and POST.

For GET, *parameters* are appended to the resource you request, like you did in your code above: /my/resource/name?para1=bla. Here, there is no difference if you append if directly to the resource name or use the parameters option. GET is normally used to request data (Its GET ;)

For POST, the *parameters* are written seperate from the resource in the HTTP body. For this, you must use the parameters option. POST is used to send (huge) data.

To specify which request method to use, use the *method* option.

Note: The GET resource has (depending from server to server) a hard limit on the length. So NEVER send much data using GET.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-20T17:26:15.183

You can also use the format:

```
var ajax = new Ajax.Request('server.php',{
  parameters: {
     store: 11200,
     product: "Meat"
  }
  onSuccess: function(myData){whatever}
}); 
```

On advantage of doing it this way is that you can change from a GET to a POST without changing the URL.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-20T13:35:12.937

除了格式和偏好之外，从技术角度来看，这并不重要，因为获取请求总是在 URL 中包含数据。参数只是构建 GET 请求的一种便捷方式。

# vb.net - COM 类工厂错误

> ID：218405
> 
> 赞同：1
> 
> 时间：2008-10-20T13:24:27.683
> 
> 标签：vb.net, com, visual-studio-2005

我一直在测试使用我的机器作为服务器的应用程序，一切正常，但是当我尝试将其设置为在测试服务器上运行时，我收到此错误：

> 由于以下错误，检索具有 CLSID {XXXX} 的组件的 COM 类工厂失败：80040154。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T13:29:07.613

首先：请在您的测试服务器上检查您的 com 对象的注册情况。

```
HKEY_CLASSES_ROOT\CLSID\{xxxx} 
```

检查您的 dll 或 exe 文件是否位于硬盘驱动器上的正确位置。

第二：此链接可能有帮助： http: [//support.software602.com/kb/view.aspx ?articleID=987](http://support.software602.com/kb/view.aspx?articleID=987)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T14:45:56.380

错误代码转换为“类未注册”。

当它是 DLL 时，注册通常使用“regsvr32”或通过“/RegServer”完成。

为避免上述错误信息，请在客户端和服务器上注册。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-20T10:08:55.333

我们有时会在使用 MSXML 4 时遇到此错误，尤其是在进行安装测试时。

**解决方法：**卸载并重新安装 MSXML。

# java - 如何在自组织网络中广播？

> ID：218421
> 
> 赞同：0
> 
> 时间：2008-10-20T13:28:34.947
> 
> 标签：java, ms-access

如何从单个源向所有节点广播消息，以及从多个源向所有节点广播消息？

java中是否有任何可能有帮助的库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-20T13:54:12.583

您可以查看分布式消息传递框架，例如 JMS。该协议的一种开源实现是 Active MQ：[http ://activemq.apache.org/](http://activemq.apache.org/)

# sharepoint - 监视 SharePoint 文档库

> ID：218426
> 
> 赞同：4
> 
> 时间：2008-10-20T13:29:46.317
> 
> 标签：sharepoint, document-library

我想知道是否有一种好方法可以监视 SharePoint 上的文档库的更改（添加的新文件、更改/签入的文件、删除的文件等）

基本上，`System.IO.FileSystemWatcher`对本地/网络目录有什么作用。

将文档上传到文档库时是否会触发事件？

也许在触发 onCreate / onModify 的文档库上创建工作流会更好？

欢迎任何建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-20T14:43:05.420

查看列表/文档库的事件接收器。对象模型中内置了同步和异步选项。（ItemAdded、ItemAdding、ItemUpdated、ItemUpdating ... 等等。）

以下网站应该会给您一个良好的开端： [http ://www.davehunter.co.uk/Blog/Lists/Posts/Post.aspx?List=f0e16a1a%2D6fa9%2D4130%2Dbcab%2Dbaeb97ccc4ff&ID=69](http://www.davehunter.co.uk/Blog/Lists/Posts/Post.aspx?List=f0e16a1a%2D6fa9%2D4130%2Dbcab%2Dbaeb97ccc4ff&ID=69)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-31T01:19:06.023

这取决于您是否需要立即对这些事件做出反应，或者您是否可以稍后收集它们。对于即时操作，事件接收器将是最佳选择，但您必须为要处理的每种操作类型准备它们。对于后者，您可以使用审计日志。这是 sharepoint 中的一项功能，可收集有关用户操作的信息。这将需要在站点上启用一些功能，并且可能需要一些配置，您可以在其中指定应记录哪些操作）。

查看： https: [//support.office.com/en-us/article/view-audit-log-reports-b37c5869-1b47-4a82-a30d-ea20070fe527](https://support.office.com/en-us/article/view-audit-log-reports-b37c5869-1b47-4a82-a30d-ea20070fe527) 配置： https: [//support.office.com/en-us /article/configure-audit-settings-for-a-site-collection-a9920c97-38c0-44f2-8bcb-4cf1e2ae22d2](https://support.office.com/en-us/article/configure-audit-settings-for-a-site-collection-a9920c97-38c0-44f2-8bcb-4cf1e2ae22d2)

不幸的是，我不确定是否可以使用 CSOM 获取这些数据 - 根据下面链接的答案，您必须使用服务器解决方案： [https ://social.msdn.microsoft.com/Forums/office/en -US/fd628034-9d6d-4f98-afb8-1d0bd6926bd0/accessing-audit-logs-using-csom-in-sharepoint-2013?forum=sharepointdevelopment](https://social.msdn.microsoft.com/Forums/office/en-US/fd628034-9d6d-4f98-afb8-1d0bd6926bd0/accessing-audit-logs-using-csom-in-sharepoint-2013?forum=sharepointdevelopment)

# c# - 如何获取表达式的值 > 行动迅速？

> ID：218439
> 
> 赞同：1
> 
> 时间：2008-10-20T13:33:06.123
> 
> 标签：c#, linq, expression

假设我们有以下代码：

```
ExpressionHelper.GetRouteValuesFromExpression<AccountController>(ax => ax.MyAction("a", "b")); 
```

（来自 ASP.NET MVC 期货程序集）。方法相当快 - 它在 150 毫秒内执行 10k 次迭代。

现在，我们将代码更改为：

```
string a = "a";
string b = "b";
ExpressionHelper.GetRouteValuesFromExpression<AccountController>(ax => ax.MyAction(a, b)); 
```

**此代码将在 15秒内**执行 10k 次迭代

 **问题是以下代码：

```
Expression<Func<object>> lambdaExpression = Expression.Lambda<Func<object>>(Expression.Convert(arg, typeof (object)));

Func<object> func = lambdaExpression.Compile();

value = func() 
```

有没有比每次都编译表达式更好的方法来从表达式中获取价值？这会极大地影响 ASP.NET MVC 链接生成速度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T13:37:32.760

如果这是一个瓶颈，为什么不直接在本地缓存表达式的值及其编译值呢？我想一个简单的字典可以做到这一点：

```
Dictionary<Expression<Action<T>>, Action<T>> m_Cache =
    new Dictionary<Expression<Action<T>>, Action<T>>();

public void GetRouteValuesFromExpression<T>(Expression<Action<T>> expr) {
    Action<T> compiled = null;
    if (!m_Cache.TryGetValue(expr, ref compiled)) {
        compiled = expr.Compile();
        m_Cached.Add(expr, compiled);
    }
    // execute …
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T14:11:40.723

它必须是一个`Func<object>`吗？您可能可以手动制作“捕获” - 即具有声明 a & b; 的类型。有`Func<Whatever, object>`, 并将其编译为委托。那么你在运行时所做的就是：

```
Foo foo = new Foo {A = a, B = b};
return cachedFunc(foo); 
```

我不太确定 Convert(blah, typeof(object)) 正在做什么 - 你能澄清一下吗？我对表情有相当多的经验，但这似乎……不寻常……

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T14:38:18.753

我摆弄了一下，想出了以下几点：

```
var body = (MethodCallExpression)expr.Body;
var arg1 = (MemberExpression)body.Arguments[0];
var contextType = arg1.Member.DeclaringType;
var field = contextType.GetField(arg1.Member.Name);
Console.WriteLine(field.GetValue(…)); 
```

假设这`expr`是您的`Expression<Action<T>>`论点，这将为您提供反射字段，该字段作为第一个参数传递给您的调用（`a`在您的情况下）。但是，我无法提取评估该字段所需的上下文（最后一行，位置标记为“...”）。我相信如果不编译表达式，就无法访​​问此上下文。结果，你想要的东西是不可能的。

*请*证明我错了。;-)

（实际上，我不太确定，因为即使使用反射器我也无法找到执行上下文的存储位置，所以我可能会忽略一些东西。）

# c# - 确定 .NET Windows 服务是否未挂起的最佳方法？

> ID：218447
> 
> 赞同：4
> 
> 时间：2008-10-20T13:34:37.850
> 
> 标签：c#, .net

主动监控 .NET Windows 服务是否仍在运行（例如未挂起）的最佳方法是什么？该服务需要定期响应计时器引发的事件。

谢谢

乔恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T13:40:24.080

“未挂起”始终是一个很难确定的条件，并且取决于您的服务细节。

通常可以使用任何形式的进程间通信。一种简单的方法是创建一个**命名**的共享内存映射，并简单地从您的服务定期向其中写入信息。另一个进程可以监视共享内存并查看其状态是否停止更改。

这种方法的优点是您可以扩展共享内存块以包含其他可能有助于诊断任何问题的诊断。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-20T13:41:19.273

一种方法是您可以在 .NET 中创建自己的性能计数器：

[http://msdn.microsoft.com/en-us/library/5e3s61wf(VS.71).aspx](http://msdn.microsoft.com/en-us/library/5e3s61wf(VS.71).aspx)

然后使用计时器将计数器绑定到“激活的秒数”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T13:41:19.273

显而易见的解决方案似乎是，检查它是否仍在响应。所以加了一个低频看门狗定时器。我不知道你想在哪里监控活力，但在大多数地方你应该能够从命名管道中读取。然后将看门狗定时器事件转换为对命名管道的写入。如果您没有观察到读取，您就知道您的服务无法响应至少一个计时器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T13:50:57.927

您可以创建一个命名事件或互斥体，然后在代码执行时切换它。然后外部程序可以将此脉冲视为程序正在运行的指示。

我还使用了在另一个线程中运行的内部看门狗系统。该线程查看主线程的活动，如日志输出或切换事件。如果未看到该活动，则认为该服务已挂起，我将关闭该服务。在这种情况下，您可以将 Windows 配置为自动重新启动已停止的服务，这可能会清除问题（只要它不是内部逻辑错误）。

我使用的服务也有写入日志的文本日志。除了即将“睡一会儿”的服务外，我还会记录下一次醒来的时间。我使用[MTAIL](http://ophilipp.free.fr/op_tail.htm)来观察输出日志。

# iphone - 在 iPhone 中加载自定义框架

> ID：218450
> 
> 赞同：1
> 
> 时间：2008-10-20T13:35:32.497
> 
> 标签：iphone, cocoa-touch

我正在尝试使用[外部框架](http://www.cybergarage.org/net/upnp/c/index.html)在 iPhone 上进行 UPnP 浏览。该框架在 Mac 上完美运行，但是当我将其复制到 iPhone 应用程序时，即使还没有使用该框架的代码，它也不会运行。

它给出了我无法理解的奇怪错误。

```
[Session started at 2008-10-20 15:32:34 +0200.]
objc[2701]: Class CAAnimationGroup is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class CATransition is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class CAKeyframeAnimation is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class CABasicAnimation is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class CAPropertyAnimation is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class CAAnimation is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class CASlotProxy is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class CAContextImpl is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class CAContext is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class CAFilter is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class CALayer is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class CAMediaTimingFunction is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class CAScrollLayer is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class CATransaction is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class CATransformLayer is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class CATiledLayer is implemented in both /System/Library/Frameworks/QuartzCore.framework/Versions/A/QuartzCore and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/Frameworks/QuartzCore.framework/QuartzCore.
objc[2701]: Class NSCursor is implemented in both /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit and /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/PrivateFrameworks/WebCore.framework/WebCore. Using implementation from /Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator2.0.sdk/System/Library/PrivateFrameworks/WebCore.framework/WebCore.

[Session started at 2008-10-20 15:32:37 +0200.]
Loading program into debugger…
GNU gdb 6.3.50-20050815 (Apple version gdb-962) (Sat Jul 26 08:14:40 UTC 2008)
Copyright 2004 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "i386-apple-darwin".warning: Unable to read symbols for "/System/Library/Frameworks/UIKit.framework/UIKit" (file not found).
warning: Unable to read symbols from "UIKit" (not yet mapped into memory).
warning: Unable to read symbols for "/System/Library/Frameworks/CoreGraphics.framework/CoreGraphics" (file not found).
warning: Unable to read symbols from "CoreGraphics" (not yet mapped into memory).
Program loaded.
sharedlibrary apply-load-rules all
Attaching to program: `/Users/danielchong/Library/Application Support/iPhone Simulator/User/Applications/305F04A8-840D-4A1A-ADD8-59CEC674152E/uPnP Browser2.app/uPnP Browser2', process 2701.
(gdb) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-20T13:39:54.157

iPhone 不支持任何类型的动态链接。我认为您尝试进行动态链接的事实混淆了模拟器仔细加载thingamagig 的库（如果我没记错的话，它是上述错误的根源）。

如果许可证允许这样做，请将外部 UPnP 代码静态链接到您的应用程序中。

# php - 在 PHP 中锁定 NFS 文件

> ID：218451
> 
> 赞同：9
> 
> 时间：2008-10-20T13:36:04.430
> 
> 标签：php, concurrency

我最新的 web 应用程序的一部分需要写入文件作为其日志记录的一部分。我注意到的一个问题是，如果有几个并发用户，写入*可以*相互覆盖（而不是附加到文件）。我认为这是因为目标文件可以同时在多个地方打开。

`flock(...)`通常很棒，但它似乎不适用于 NFS ......这对我来说是一个大问题，因为生产服务器使用 NFS 阵列。

我见过的最接近实际解决方案的事情是尝试创建一个锁目录并等待它被创建。说这缺乏优雅是对今年，可能是十年的轻描淡写。

有更好的想法吗？

编辑：我应该补充一点，我在服务器上没有 root，并且以另一种方式进行存储在短期内并不可行，尤其是在我的最后期限内。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-09T10:27:55.883

Directory operations are *NOT* atomic under NFSv2 and NFSv3 (please refer to the book 'NFS Illustrated' by Brent Callaghan, ISBN 0-201-32570-5; Brent is a NFS-veteran at Sun).

NFSv2 has two atomic operations:

*   symlink
*   rename

With NFSv3 the create call is also atomic.

Knowing this, you can implement spin-locks for files and directories (in shell, not PHP):

lock current dir:

```
while ! ln -s . lock; do :; done 
```

lock a file:

```
while ! ln -s ${f} ${f}.lock; do :; done 
```

unlock (assumption, the running process really acquired the lock):

unlock current dir:

```
mv lock deleteme && rm deleteme 
```

unlock a file:

```
mv ${f}.lock ${f}.deleteme && rm ${f}.deleteme 
```

Remove is also not atomic, therefore first the rename (which is atomic) and then the remove.

For the symlink and rename calls, both filenames have to reside on the same filesystem. My proposal: use only simple filenames and put file and lock into the same directory.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-20T13:39:11.773

另一个肮脏的黑客攻击将是`flock()`“本地”文件，并且只有在您持有本地文件的锁定时才打开/写入 NFS 文件。

编辑：从`flock()`页面：

> flock() 不适用于 NFS 和许多其他网络文件系统。查看您的操作系统文档以获取更多详细信息。

编辑2：

当然，总是使用数据库来同步访问（我假设您的应用程序使用数据库）。但是，如果您要进行大量日志记录，这将对性能造成很大影响。

如果只是为了记录，你真的需要一个集中的日志文件吗？您可以在本地登录（如果需要，甚至在一天结束时轮换日志时合并日志）？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-20T14:00:44.273

一种方法是设置一个[Memcache](http://www.danga.com/memcached/)实例，在每个虚拟服务器之间共享。您可以`flock()`在启动本地文件操作时将文件名条目放入缓存中，并在完成后擦除它。

每个服务器都可以在文件操作之前访问这个池，并查看这个“锁”是否存在，例如

```
// Check for lock, using $filename as key
$lock = $memcache->get($filename);

if(!$lock) {
    // Set lock in memcache for $filename
    $memcache->set($filename, 1);

    // Do file operations...

    // Blow away "lock"
    $memcache->delete($filename);
} 
```

不是最优雅的解决方案，但应该使您能够相对轻松地控制设置中所有服务器的锁。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-05-21T01:55:12.230

You can also use dio_fcntl() to lock files on NFS volumes. It requires the dio package, which may not be part of your php installation by default.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-20T18:18:16.250

Even though you cannot flock() files on NFS and I/O can be asynchroneous, directory operations on NFS *are* atomic. That means that at at any given time, a directory does, or does not exist.

To implement your own NFS locking feature, check or create a directory when you want to have it locked and remove it when you're done.

Unfortunately, it's probably not compatible with any other application you didn't write yourself.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-20T15:17:37.067

应该只使用 memcache add 并避免竞争条件。

```
if ($memcache->add($filename, 1, 1))
{
   $memcache->delete($filename);
} 
```

# c# - 在 C# 中内联或在静态构造函数中初始化静态变量的区别

> ID：218461
> 
> 赞同：18
> 
> 时间：2008-10-20T13:39:18.293
> 
> 标签：c#, .net, static, constructor, initialization

我想知道初始化静态成员内联有什么区别：

```
class Foo
{
    private static Bar bar_ = new Bar();
} 
```

或在静态构造函数中初始化它，如下所示：

```
class Foo
{
    static Foo()
    {
        bar_ = new Bar();
    }
    private static Bar bar_;
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-20T13:44:48.360

如果您的类型中有静态构造函数，它会更改类型初始化，因为不再应用[beforefieldinit标志。](http://pobox.com/~skeet/csharp/beforefieldinit.html)

它还影响初始化顺序 - 变量初始化器都在静态构造函数之前执行。

据我所知，这就是它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-20T13:43:17.850

在这种情况下，我认为没有任何实际区别。如果您在初始化静态变量时需要一些逻辑 - 例如，如果您想在给定不同条件的情况下使用不同的具体接口类型 - 您将使用静态构造函数。否则，内联初始化在我的书中很好。

```
class Foo
{
    private static IBar _bar;

    static Foo()
    {
        if(something)
        {
            _bar = new BarA();
        }
        else
        {
            _bar = new BarB();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-10-20T14:54:31.760

暮光之城答案：内联初始化程序和 ctor 分配之间**的执行顺序**有所不同......当您混合实例和静态成员以及继承启动时。

```
For static members, static initializers 
Static ctors (execute bottom up)
Base static initializer
Base static ctor and so on

For instance members, initializers in current class execute first
Then initializers in base class execute ( up the chain)
Then top-most base ctor is executed (and we walk down now. Instance ctors execute top-down)
Finally current type's ctor is executed. 
```

例子 ：）

```
public class CBase
    {
        static Talkative m_Baseob1 = new Talkative("Base Static Initializer-");
        static Talkative m_Baseob2;
        Talkative m_Baseob3 = new Talkative("Base Inst Initializer");
        Talkative m_Baseob4;
        static CBase()
        {
            Console.WriteLine("***MethodBegin: Static Base Ctor");
            m_Baseob2 = new Talkative("Base Static Ctor");
            Console.WriteLine("***MethodEnd: Static Base Ctor");
        }
        public CBase()
        {
            Console.WriteLine("***MethodBegin: Instance Base Ctor");
            m_Baseob4 = new Talkative("Base Instance Ctor");
            Console.WriteLine("***MethodEnd: Instance Base Ctor");
        }
    }
    public class CDerived : CBase
    {
        static Talkative m_ob1 = new Talkative("Derived Static Initializer");
        static Talkative m_ob2;
        Talkative m_ob3 = new Talkative("Derived Inst Initializer");
        Talkative m_ob4;
        static CDerived()
        {
            Console.WriteLine("***MethodBegin: Derived Static Ctor");
            m_ob2 = new Talkative("Derived Static Ctor");
            Console.WriteLine("***MethodEnd: Derived Static Ctor");
        }
        public CDerived()
        {
            Console.WriteLine("***MethodBegin: Derived Instance Ctor");
            m_ob4 = new Talkative("Derived Instance Ctor");
            Console.WriteLine("***MethodEnd: Derived Instance Ctor");
        }
    }
    internal class Talkative
    {
        public Talkative(string sID)
        {
            Console.WriteLine(sID + " - Talkative created" );
        }
    }

    # Main function somewhere
    CDerived s = new CDerived(); 
```

输出：

```
Derived Static Initializer - Talkative created

***MethodBegin: Derived Static Ctor
Derived Static Ctor - Talkative created
***MethodEnd: Derived Static Ctor

Derived Inst Initializer - Talkative created

Base Static Initializer- - Talkative created

***MethodBegin: Static Base Ctor
Base Static Ctor - Talkative created
***MethodEnd: Static Base Ctor

Base Inst Initializer - Talkative created

***MethodBegin: Instance Base Ctor
Base Instance Ctor - Talkative created
***MethodEnd: Instance Base Ctor

***MethodBegin: Derived Instance Ctor
Derived Instance Ctor - Talkative created
***MethodEnd: Derived Instance Ctor 
```

# firefox - 在 Firefox 扩展中，如何将富文本/链接复制到剪贴板？

> ID：218462
> 
> 赞同：1
> 
> 时间：2008-10-20T13:39:39.277
> 
> 标签：firefox, firefox-addon, xul

具体来说，我想复制一个链接（带有文本和位置），然后能够将其粘贴到例如 Word 中作为链接。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-20T17:26:09.333

这是实际的代码：

```
var richText = "<a href=\"" + gContextMenu.linkURL + "\">" + gContextMenu.linkText() + "</a>";
var xfer = Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);
xfer.addDataFlavor("text/html");

var htmlString = Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);
htmlString.data = richText;
xfer.setTransferData("text/html", htmlString, richText.length * 2);

var clipboard = Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard);
clipboard.setData(xfer, null, Components.interfaces.nsIClipboard.kGlobalClipboard); 
```

也建议再创建一个`Components.interfaces.nsISupportsString`，数据为纯文本的，添加到相同`xfer`的`text/unicode`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T15:34:43.317

深入[了解每日下载：AutoCopy Firefox 扩展](http://lifehacker.com/software/firefox/download-of-the-day-autocopy-firefox-extension-177806.php)或[剪贴板-另存为 1.0.4](https://addons.mozilla.org/en-US/firefox/addon/1478)

# visual-studio - 能够在 Visual Studio 中将字体设置为斜体

> ID：218463
> 
> 赞同：1
> 
> 时间：2008-10-20T13:39:42.693
> 
> 标签：visual-studio, visual-studio-2008

有谁知道如何在 Visual Studio 2005 或 2008 中将代码文本编辑器字体样式设置为斜体？请注意，我说的是代码编辑器，而不是代码本身。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-20T13:53:17.267

您不能通过标准 IDE 选项，编辑器只允许您更改字体或将其设置为粗体。

您最好的选择是使用只有斜体字符的字体（确保所有字符占用相同的空间）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-20T14:14:58.003

不幸的是，除非有一些未记录的注册表设置，否则唯一的方法是通过环境自动化模块。我知道如果以这种方式设置， [Visual Assist X](http://www.wholetomato.com/)会将某些内容变为斜体，所以它一定是可能的。

我将从 Microsoft 的[自动化示例](http://msdn.microsoft.com/en-us/vs2005/aa718337.aspx)开始，看看你能找到什么。（我已将此作为社区答案，因此如果有人想进一步调查，他们可以。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-01T21:00:02.533

示例：将常规 consolas 字体更改为斜体字体。

关闭所有应用程序和视觉工作室。转到 C:\windows\fonts\consolas\ 并删除常规字体。

重新启动 Visual Studio，您将看到文本编辑器斜体字体。

# c - C %[] 转换说明符和字符串函数

> ID：218466
> 
> 赞同：1
> 
> 时间：2008-10-20T13:40:06.560
> 
> 标签：c

我很难理解说明符和字符串函数的格式。

我的目标是用来`%[]`读取所有字符和空格，然后使用 strcpy 函数，然后使用 strcat 函数。

到目前为止，我已经设法输入单个字符并将它们打印出来，不包括空格。

这是到目前为止的代码；

```
int main(int argc, char** argv)  {
    char words[30];
    int loops;
    printf("How many letters would you like to enter? - ");
    scanf("%d",&loops);
    for(int i=0;i<loops;i++){
      printf("Provide some text as input:");
      scanf("%s", &words[i]);
    }
    printf("%d", strlen(words));

    printf("%s",&words);
    return (EXIT_SUCCESS);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-20T14:18:44.393

我假设您想从标准输入到 ENTER 键读取最大长度为 29 个字符的字符串。

为此，您可以使用以下代码：

```
char phrase[30];
printf("Enter a phrase: ");
scanf("%29[^\n]", phrase);
printf("You just entered: '%s'\n", phrase); 
```

表示从`%29[^\n]`开头到 ENTER 键最多读取 29 个字符（为零终止符保存一个字符）。这包括用户可能输入的任何空格字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T13:44:32.353

words[i] 是字符串 words 中的单个字符，您试图在其中存储字符串 's'。
要读取单个字符，请使用 %c。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T13:56:24.250

如果你想获得一个角色，你会使用：

```
scanf("%c", &words[i]); 
```

完成后，您还需要终止字符串：

```
words[loops]='\0'; 
```

当您打印最终字符串时，您需要传递指针（而不是指针的地址）：

```
printf("%s",words); 
```

您的代码还需要处理取消或想要输入超过 29 个字符的用户。

# java - 管理 Rails 和 Java 项目之间的数据库更改

> ID：218472
> 
> 赞同：1
> 
> 时间：2008-10-20T13:41:36.400
> 
> 标签：java, ruby-on-rails, ruby, database, migration

在我开始的一项新工作中，我们有一个 Java 应用程序来处理核心业务逻辑中的大部分繁重工作，我们还有一个 Rails 应用程序当然可以处理该服务器的 Web 界面。两者都访问同一个数据库。

到目前为止，大部分重点都放在了 Java 应用程序上，因此，Rails 项目中没有迁移。用于更新共享数据库的 sql 在诸如 changes.sql 之类的文件中进行管理。

可以想象，这使得开发有些困难。

我最初的想法是结合 Java 项目和 Rails 应用程序的代码库，因为那里存在依赖关系，并在源代码中管理那个 SQL 文件。但是，我想我会在这里询问是否有其他人在一定程度上成功地解决了这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T13:49:16.447

一种方法是使用 rails 迁移工具，为数据库生成 DDL 文件并使用 Hibernate 更新与特定数据库实体相关的 Java 对象。您并没有真正说明如何在 Java 端管理数据库更改或是否使用 ORM，但您当然可以通过一些工作使两者同步。

或者您可以反过来，让 Java 定义控制 Rails 端的更改。

我认为成功做到这一点的关键是选择两个平台之一作为您的“主要数据库建模器”，并开发将该模型迁移到另一个平台的过程。试图允许两者都进行更改只会让人头疼。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T17:40:58.650

We have a similar project structure: shared database with both java and rails applications as clients. I advocated and got buy-in to use the rails migration mechanism for handling database changes. It takes a bit of rails advocacy, and some willingness to help but the java team is also writing their own migrations.

We have some cases where we use stored procedures and database specific column types, so we changed the rails environment.rb to use sql for creating the test database.

```
 # Use SQL instead of Active Record's schema dumper when creating the test database.
  # This is necessary if your schema can't be completely dumped by the schema dumper,
  # like if you have constraints or database-specific column types
  config.active_record.schema_format = :sql 
```

On the plus side managing the sql with migrations makes rails testing and setup clean for you. The downside is that some of the migration files are just not that pretty (e.g., you can't use the migration DSL to generate stored procedures so you have these execute %{blah } in your migrations).

Just remember to keep communication lines open beteen the teams. I like the fact that "cap production deploy:migrations" makes updating the production database dead simple.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T14:33:23.223

谢谢史蒂夫

在 Java 方面，他们使用的是 Hibernate，但有一个手动 SQL 更新过程。

我同意，它应该是一个或另一个。我越想，添加另一个应用程序/模块/代码库来管理数据库绝对是错误的想法。

谢谢

# c++ - 在已排序的 STL 容器中查找给定键的“最佳匹配键”

> ID：218488
> 
> 赞同：7
> 
> 时间：2008-10-20T13:45:32.430
> 
> 标签：c++, sorting, stl, containers

## 问题

我有时间戳数据，我需要根据时间戳进行搜索，以便获得与我的输入时间戳最接近的一个现有时间戳。
最好用 STL 解决这个问题。boost::* 或 stl::tr1::* （来自带有 Featurepack 的 VS9）也是可能的。
时间戳数据示例：

```
struct STimestampedData
{
 time_t m_timestamp; // Sorting criterion
 CData m_data;       // Payload
} 
```

## 使用`stl::vector`,`sort()`和`equal_range()`

由于 a `map`or`set`只允许我找到完全匹配，因此我不再使用其中一个。所以现在我有一个`vector`我在数据进入时追加数据的地方。在搜索之前，我使用`<algorithm>`'s`sort()`并为其提供自定义比较功能。
之后，我使用`<algorithm>`'s`equal_range()`查找指定值的两个邻居`x`。从这两个值中，我检查哪一个最接近`x`，然后我有我的最佳匹配。

虽然这不是太复杂，但我想知道是否有更优雅的解决方案。
也许 STL 已经有一个算法可以做到这一点，所以我不会在这里重新发明一些东西？

## 更新：线性与二进制搜索

我忘了提到我有很多数据要处理，所以我不想线性搜索。
我对向量进行排序的原因`sort()`是它具有随机访问迭代器，而`map`. 使用 a`map`不允许`equal_range()`进行具有两倍对数复杂度的搜索。
我对么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-20T14:10:13.723

对于这样的事情，我也会使用 equal_range 。

如果您每次都在向量上使用 sort()，最好使用映射（或集合），因为它总是自动排序，并使用成员 equal_range

但这取决于插入/查询/数据量的数量。（虽然对于查询时总是需要排序的东西，地图将是我的首选，如果有充分的理由，我只会使用矢量）

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-20T14:55:18.203

我会使用 set::lower_bound 来查找匹配或更大的值，然后递减迭代器以检查下一个较低的值。您应该使用 std::set 而不是 std::map 因为您的密钥嵌入在对象中 - 您需要提供一个比较时间戳成员的函子。

```
struct TimestampCompare
{
    bool operator()(const STimestampedData & left, const STimestampedData & right) const
    {
        return left.m_timestamp < right.m_timestamp;
    }
};
typedef std::set<STimestampedData,TimestampCompare> TimestampedDataSet;

TimestampedDataSet::iterator FindClosest(TimestampedDataSet & data, STimestampedData & searchkey)
{
    if (data.empty())
        return data.end();
    TimestampedDataSet::iterator upper = data.lower_bound(searchkey);
    if (upper == data.end())
        return --upper;
    if (upper == data.begin() || upper->m_timestamp == searchkey.m_timestamp)
        return upper;
    TimestampedDataSet::iterator lower = upper;
    --lower;
    if ((searchkey.m_timestamp - lower->m_timestamp) < (upper->m_timestamp - searchkey.m_timestamp))
        return lower;
    return upper;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T14:08:55.177

根据您的用途，您可以进行简单的线性搜索而不是排序。想出一个“距离”函数，循环跟踪迄今为止的最佳匹配及其距离。当你找到更好的匹配时，忘记前一个，保持新的和它的距离。当您遍历所有内容时，您就有了比赛。

结果为 O(N*S)，其中 N 是向量中的项目数，S 是搜索次数。

您当前的方式是 O((N+S)*LogN) 如果搜索次数少且有界则更大。否则排序/二进制搜索会更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-06-28T14:26:57.890

```
//the function should return the element from iArr which has the least distance from input
double nearestValue(vector<double> iArr, double input)
{
    double pivot(0),temp(0),index(0);
    pivot = abs(iArr[0]-input);
    for(int m=1;m<iArr.size();m++)
    {           
        temp = abs(iArr[m]-input);

        if(temp<pivot)
        {
            pivot = temp;
            index = m;
        }
    }

    return iArr[index];
}

void main()
{
    vector<double> iArr;

    srand(time(NULL));
    for(int m=0;m<10;m++)
    {
        iArr.push_back(rand()%20);
        cout<<iArr[m]<<" ";
    }

    cout<<"\nnearest value is: "<<lib.nearestValue(iArr,16)<<"\n";
} 
```

# windows - Windows Server 2003 服务器到服务器代理避免配置

> ID：218491
> 
> 赞同：1
> 
> 时间：2008-10-20T13:47:28.260
> 
> 标签：windows, web-services, proxy, iis-6

是否可以配置驻留在同一域中的 Windows 服务器，以便当使用 IP 地址从 Web 应用程序进行 Web 服务调用时，请求不通过代理服务器？

Web 服务正在域中的其中一台服务器上运行。

我想在托管 Web 服务的服务器上配置基于 IP 的安全性，以便它只允许来自特定服务器的连接。目前，所有请求都通过代理服务器，呈现 IPSec 问题。

在浏览器中，我可以指定遵循特定模式的请求应该绕过代理服务器。本质上，我想用服务器复制这种行为。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-27T23:48:44.293

我认为 proxycfg.exe 有你需要的。它是一个控制台应用程序，是标准 Windows 安装的一部分。看着：

[http://msdn.microsoft.com/en-us/library/aa384069.aspx](http://msdn.microsoft.com/en-us/library/aa384069.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T23:25:51.277

使用 ASMX，可以在 Proxy 属性上设置代理：

[http://johnwsaundersiii.spaces.live.com/blog/cns!600A2BE4A82EA0A6!435.entry](http://johnwsaundersiii.spaces.live.com/blog/cns!600A2BE4A82EA0A6!435.entry)

使用 WCF，这是绑定配置的一部分：

[http://blogs.infosupport.com/porint/archive/2007/08/14/Configuring-a-proxy_2D00_server-for-WCF.aspx](http://blogs.infosupport.com/porint/archive/2007/08/14/Configuring-a-proxy_2D00_server-for-WCF.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-13T14:15:34.950

Proxycfg 看起来很有希望，但是我需要以编程方式执行以下代码：-

```
Set xmlhttp = Server.CreateObject("Msxml2.ServerXMLHTTP.4.0") 

xmlhttp.SetProxy 2,"proxyname:port", "addresses that should bypass the proxy" 
```

这允许我指定应该绕过指定代理的地址，现在效果很好

谢谢你的帮助

# asp.net - Asp.net 页面管理

> ID：218503
> 
> 赞同：2
> 
> 时间：2008-10-20T13:53:19.247
> 
> 标签：asp.net, ajax, asp.net-ajax

当您在浏览器中打开页面时，会在服务器上创建该页面的一个实例。但是，当您使用 AJAX 时，是否有人知道整个页面对象是否是在服务器上回发时创建的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T13:57:42.220

当您使用 ASP.NET Ajax 时，AJAX 请求仍将处理所有代码隐藏代码，但是，唯一的呈现更新将是更新面板内的项目。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-20T13:59:10.047

依靠。使用 UpdatePanel，页面被实例化并经历正常的生命周期，但只有您包装的控件被更新。如果您使用 PageMethods，它们是静态的，不需要对象实例化。

假设 ASP.NET AJAX，如果您使用另一个框架，答案无疑会有所不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-20T14:04:23.797

这还取决于使用术语 AJAX 是指真正的 AJAX 还是 AJAX .NET 工具包，后者主要是一组 javascript 函数，其中 90% 左右并不是真正的 ajax。在大多数后来的控件中，整个页面都被调用，并且仅解析输出以获取所需的特定信息或部分。如果有异步 javascript 调用页面并对其进行解析，asp.net 页面将无法区分此调用和常规浏览器视图之间的区别（除非您对其进行编程以了解区别），所以在这种情况下，页面对象也将被创建。唯一不会处理整个页面的情况是调用 Web 方法或脚本方法时。

# java - JPA 关系中列的自定义命名

> ID：218504
> 
> 赞同：1
> 
> 时间：2008-10-20T13:53:49.077
> 
> 标签：java, hibernate, jpa, entity-relationship

当我使用 hibernate 与 JPA 建立关系时，会生成一些可怕的长且 ackward 的列名。
例如。我有以下内容`actionPlan_actionPlanPK`，这意味着该列`actionPlan`是指向的 FK `actionPlanPK`。
为了使它在数据库中看起来更整洁一点，我希望我可以自己给它一个名称，最好只是它在拥有关系的实体类中的名称。

JPA可以做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-20T14:03:20.600

是的。如果您对默认名称不满意，可以为列指定您自己的名称。例如，在引用 ActionPlan 的类中，您可以指定：

```
@ManyToOne
@JoinColumn(name="actionplanId")
public ActionPlan getActionPlan(){

} 
```

因此，列名将是“actionplanid”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-20T14:47:28.110

此功能是 JPA 规范的一部分，允许在注释中命名许多数据库结构。这些包括：

如下命名您的表：

```
@Entity
@Table(name="better_table_name")
public class MyConvolutedClassName {
} 
```

将列命名如下：

```
@Column(name="better_column_name")
private Date myConvolutedDateColumn; 
```

命名属于关系的列：

```
@ManyToOne
@JoinColumn(name="better_join_column_name")
private ClassName otherModelClass; 
```

[在http://www.fnogol.de/media/ejb3.0-anno-cheat-1.2.pdf](http://www.fnogol.de/media/ejb3.0-anno-cheat-1.2.pdf)上有一个很棒的（虽然不是最新的）EJB 3.0 注释（包括 JPA）备忘单。

# html - 创建表单时，字段集是否不再是可行的选择？

> ID：218505
> 
> 赞同：2
> 
> 时间：2008-10-20T13:54:01.867
> 
> 标签：html, asp.net-mvc, styling

我正在创建一些具有区域的 Web 表单。

字段集是分割表单的可行选项吗？

我应该只使用样式相似的 div 吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-20T14:02:41.583

字段集在语义上更有意义。不过，不同的浏览器对它们的渲染略有不同，但可以实现一些相当不错的[跨浏览器效果](http://www.456bereastreet.com/lab/styling-form-controls-revisited/fieldset/)。我想这归结为你需要你的设计有多完美。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-20T13:56:36.293

fieldset 标签仍然是一个可以接受的控件，我自己有时也会使用它。但是，我个人发现，由于它在我更喜欢使用样式 div 的浏览器中呈现略有不同，所以我可以放心显示格式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T04:52:37.793

在以可访问的方式构建表单时，字段集肯定会更好 - 屏幕阅读器等可以选择快速浏览您的表单。在一个非常简短的形式上 - 例如搜索或类似的，你并不真正需要它。

# version-control - 请对家庭版本控制系统提出建议

> ID：218507
> 
> 赞同：8
> 
> 时间：2008-10-20T13:54:07.530
> 
> 标签：version-control

我有一个真正需要在源代码管理中的家庭项目。我尝试安装我有一些经验的 Subversion，但无法使其正常工作。我不是特别想使用 SourceSafe。我有点担心 Git/Mercury 有点神秘，尽管这只是基于意见而不是我的经验。

主要要求是：

1.  必须是开源的（好吧，它必须是免费的，但听起来有点便宜！）
2.  必须在 Win32 上运行
3.  如果有可用的 GUI 界面，我会更喜欢

提前谢谢了！

**编辑：**只是为了让大家知道，我安装了 VisualSVN 并让它立即工作。感谢您的宝贵意见。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-20T13:58:37.163

I know you mentioned you already tried Subversion and had some issues but you really can't beat the easy install & configuration of

### [VisualSVN Server](http://www.visualsvn.com/server/)

Insanely easy to setup & maintain.

* * *

Use VisualSVN for the back-end and [TortoiseSVN](http://tortoisesvn.tigris.org/) for the client and you'll be up and running in no time.

Plus you can always do an svndump of the VisualSVN repository if you want to switch to something else down the road.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-20T13:56:49.647

也可以看看

[独立开发人员的最佳版本控制](https://stackoverflow.com/questions/138621/best-version-control-for-lone-developer)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-20T13:58:41.267

Perforce has a free two user version. Excellent product. [http://www.perforce.com/](http://www.perforce.com/)

2012 Update: There now a free 20 user version, still excellent, with new features.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-20T13:58:33.340

我认为SVN真的是你最好的选择。[在此处查看](http://svnbook.red-bean.com/nightly/en/svn.reposadmin.create.html)有关如何设置的文档。

I've set up a couple SVN repos on a windows box and never really had a problem especially when you use [TortoiseSVN](http://tortoisesvn.tigris.org/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-26T10:09:05.697

Don't be scared of by `git`. It has gotten *far* easier to use than it used to be!

It fits all your requirements (open source/free/run on Win32/have a GUI, which is included), and there are lots of good resources available.

As a really basic guide, using the command line (the ["Git GUI"](http://www.spearce.org/2007/01/git-gui-screenshots.html) should be pretty self explanatory):

1.  `mkdir myrepo` - make a new directory, this could be an existing dir with your code in it
    *   `git init` - makes the directory into a git repository. this basically adds a `.git/` folder to the current directory. This is like using VisualSVN, creating a new repository then checking it out to a working directory (just without the server
    *   `vim myfile.txt` - make a new file, if you have existing files, you obviously can skip this
    *   `git add myfile.txt` - start tracking the new file (similar to `svn add`'ing a file)
    *   `git commit` - commits whatever you have run `git add` on.

..and that's it. You have a version tracked file! When you change the file, you do `git add myfile.txt` again to "stage" the changes, then commit to add all the staged files into a commit.

It's slightly different to how SVN works. With SVN, you commit a file, and it gets sent to the server. With git, you stage a file (or multiple files, or even bits of a file, which is very useful), then commit them.

You can do all of the above easily (including creating repositories, staging specific lines in a file) in Git GUI.

On Windows, install [msysgit](http://code.google.com/p/msysgit/).

Then, if you don't mind spending $9, watch the [Peepcode GIT episode](http://peepcode.com/products/git) for a comprehensive overview of what git is, how it works, and how to use it.

Alternatively, [GitCasts](http://www.gitcasts.com/) are also a very good (free) set of screencasts, which cover most of the basic stuff. Watch the ones you think would be useful to you, I would recommend watching the [setting up](http://www.gitcasts.com/posts/setup-initialization-and-cloning), then [normal workflow](http://www.gitcasts.com/posts/normal-workflow), then [GIT on windows](http://www.gitcasts.com/posts/git-on-windows)

Finally, [GIT Magic](http://www-cs-students.stanford.edu/~blynn/gitmagic/) is a great guide to doing everything with git. I use it a lot, despite having used git a lot over the last year or so (it's useful for answering "how do I..." things you forget. Say "how do I recover a lost commit", "how do I reset the repository to 4 revisions back")

I would also recommend playing around with [GitHub](http://github.com). It's a *very* nice to use git-hosting site. When you create a new repository, it gives you the list of commands to make a new repository, and push your changes to to github (something I didn't really cover - the [distributed workflow gitcasts](http://www.gitcasts.com/posts/distributed-workflow), the [peepcode episode](http://peepcode.com/products/git) and [git magic](http://www-cs-students.stanford.edu/~blynn/gitmagic/) all cover this really well)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-20T13:55:21.553

我个人使用 SourceGear 的 Vault 产品，它对单用户访问是免费的，而且设置起来很容易，它有一个 GUI 管理客户端以及 VS 集成。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-20T14:27:05.577

I can't believe nobody has mentioned [GIT](http://git.or.cz/).

It's ideal for what you are looking for. Each working directory becomes a repository. It's a simple case of changing to your project dir. Init'ing and Committing then start working. Has some neat features for branching and merging.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-20T14:35:54.747

You can use Subversion without the hassle of a server installation.

Just download TortoiseSVN and create a local repository in a folder that you prefer. Use the same client to do updates, commits...

More info: [link1](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-repository.html) / [link2](http://www.fredshack.com/docs/tortoisesvn.html)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-26T07:48:05.513

Someone mentioned Git; I'll mention Mercurial with [TortoiseHg](http://tortoisehg.sourceforge.net/).

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-20T14:01:00.667

It's not really in vogue anymore but I've had great success using CVS for version control. I keep a 'code' folder with all my code snippets in various languages, as well as all my personal home projects in a CVS repository. CVS is older and doesn't work as well as other systems with renaming or restructuring the folders/files. On the flip side, the fact that it's been around so long means there are many ports and GUI applications for it, as well as integration packages for IDEs, etc. I've been very happy with it for the past several years that I've been using it, despite any shortcomings.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-20T14:02:30.900

I've used both cvs and svn, to great effect, for home projects. Personally, I sound svn slightly harder to set up initially - defining the directory structure and using those URLs for everything seemed to be give more hassle than it should've. Although svn is generally seeing greater use throughout the industry, if you don't have any problems with cvs, I would worry too much about the distinction. The concepts surrounding source control (which mainly overlap between the two) are more important.

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-26T07:20:12.730

You should at least look at the open source fossil VCS [www.fossil-scm.org](http://www.fossil-scm.org/) it can work as both DVCS and a client server VCS.

*   Simple to install, a single executable.
*   Simple to backup, it is a single SQLLITE repository.
*   Simple to take your repository with you anywhere, I run fossil from a thumb drive and can now take my personal code anywhere my thumb drive goes.

Right now it does not have a GUI interface, but I am sure there will be one sometime in the future.

If you play around with fossil you will find that using command line VCS is not as complicated as it might seem.

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-20T13:58:15.650

我知道满足您要求的唯一选项是 CVS 和 SVN。在这 2 个中，我会推荐 SVN。我知道您已经尝试过但没有成功，所以也许您应该尝试发布另一个问题来准确描述问题所在。

我们光荣的领导发布了一个分步指南，描述[了如何在 windows 上设置 SVN](https://blog.codinghorror.com/setting-up-subversion-on-windows/)，这可能会解决您的问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-20T14:08:57.610

Well, frankly, I'd suggest sucking it up and doing SVN. It can be a rough start, but it will pay off.

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-20T14:20:17.057

Another vote for Subversion+TortoiseSVN, although it doesn't play nicely on domestic NAS based on FAT32.

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-10-20T21:39:46.343

I've been pondering this exact question, and have been seriously considering [Bazaar](http://bazaar-vcs.org/). I can't tell you how good it is, not having used it, but you might want to check it out, as it looks promising. Similar to Git and Mercurial, but they claim it's much easier to set up and use.

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-10-26T07:41:36.883

I use [Buildix](http://buildix.thoughtworks.com/) from Thoughtworks. You can install it on a dedicated server or use it as a VM. Though it's more than just SVN: It also includes trac, Cruisecontrol and Mingle.

# emacs - 使用 ispell 时如何更改 Emacs 中的语言？

> ID：218512
> 
> 赞同：53
> 
> 时间：2008-10-20T13:55:07.013
> 
> 标签：emacs, ispell

我想在 Emacs 中使用 ispell-buffer 命令。它默认使用英语。有没有一种简单的方法可以切换到另一个字典（例如，另一种语言）？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2008-10-20T14:25:50.353

以下命令建议使用已安装字典的列表：

```
M-x ispell-change-dictionary 
```

通常，`M-x isp-c-d`也扩展到上述内容。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-10-20T14:10:27.293

您可以从文件 ispell.el 中为`ispell`命令指定一些选项。这可以通过在文件末尾添加一个部分来实现，如下所示：

```
;; Local Variables:
;; ispell-check-comments: exclusive
;; ispell-local-dictionary: "american"
;; End: 
```

请注意，双分号表示当前模式下注释的开始。可能应该更改它以反映您的文件（编程语言）引入注释的方式，例如`//`Java。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-10-23T17:03:04.677

在 LaTeX 文件的末尾，您可以使用：

```
%%% Local Variables:
%%% ispell-local-dictionary: "british"
%%% End: 
```

这会将字典设置为仅用于该文件。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2014-11-20T16:41:48.177

使用`M-x ispell-change-dictionary`并点击`TAB`查看有哪些词典可供您使用。

然后在你的 中写下默认字典的设置`.emacs`，并添加一个钩子来为你的特定模式自动启动 ispell（如果你想要的话）。

例如，在 AUCTeX 中使用英式英语自动启动 ispell（默认英语词典是美式英语）

```
(add-hook 'LaTeX-mode-hook 'flyspell-mode) ;start flyspell-mode
(setq ispell-dictionary "british")    ;set the default dictionary
(add-hook 'LaTeX-mode-hook 'ispell)   ;start ispell 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-06-15T21:14:06.873

如果要按目录更改语言，可以将其添加到`.dir-locals.el`文件中：

```
(ispell-local-dictionary . "american") 
```

如果您还没有`.dir-locals.el`文件，它将如下所示：

```
((nil .
   ((ispell-local-dictionary . "american")))
) 
```

有关更多信息，请参阅[有关目录变量的 emacs wiki 页面](http://www.emacswiki.org/emacs/DirectoryVariables)。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-08-14T17:08:14.587

为方便起见 (f7)，我在 .emacs 中添加了以下内容：

```
(global-set-key [f7] 'spell-checker)

(require 'ispell)
(require 'flyspell)

(defun spell-checker ()
  "spell checker (on/off) with selectable dictionary"
  (interactive)
  (if flyspell-mode
      (flyspell-mode-off)
    (progn
      (flyspell-mode)
      (ispell-change-dictionary
       (completing-read
        "Use new dictionary (RET for *default*): "
        (and (fboundp 'ispell-valid-dictionary-list)
         (mapcar 'list (ispell-valid-dictionary-list)))
        nil t))
      ))) 
```

顺便说一句：不要忘记安装所需的字典。例如在 debian/ubuntu 上，用于德语和英语词典：

```
sudo apt install aspell-de aspell-en 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-14T22:07:26.227

这是一些重新映射 C-\ 键以在多种语言之间自动切换*并将*输入法更改为相应语言的代码。（源自这篇文章：[https](https://stackoverflow.com/a/45891514/17936582) ://stackoverflow.com/a/45891514/17936582 ）

```
;; Toggle both distionary and input method with C-\
(let ((languages '("en" "it" "de")))
  (setq ispell-languages-ring (make-ring (length languages)))
  (dolist (elem languages) (ring-insert ispell-languages-ring elem)))

(defun ispell-cycle-languages ()
  (interactive)
  (let ((language (ring-ref ispell-languages-ring -1)))
    (ring-insert ispell-languages-ring language)    
    (ispell-change-dictionary language)
    (cond
     ((string-match "it" language) (activate-input-method "italian-postfix"))
     ((string-match "de" language) (activate-input-method "german-postfix"))
     ((string-match "en" language) (deactivate-input-method)))))
(define-key (current-global-map) [remap toggle-input-method] 'ispell-cycle-languages) 
```

# xml - 用于调试 xslt 的工具

> ID：218522
> 
> 赞同：35
> 
> 时间：2008-10-20T13:57:18.803
> 
> 标签：xml, debugging, xslt

我有一个 Java servlet，它生成 xml，使用 xslt 样式表对其进行翻译，然后显示生成的 HTML。这是我第一次使用 xslt。什么是调试 xslt 的好方法？我也有（或可以获得）一些示例 XML 文件来应用转换。但我什至不确定语法，所以会给我语法警告的东西会很棒。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2010-02-23T16:14:32.250

如果您想做“printf-style”调试并且不想在输出中乱扔调试数据，请`<xsl:message>`在处理样式表时使用标签生成调试输出。使用该`terminate="yes"`属性，您甚至可以停止样式表的处理。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-20T15:15:20.563

当您尝试使用无效的 XSLT 时，Xalan 应该会为您提供有用的错误。如果您想要更强大的东西，调试 XSLT 的一个选项是[Oxygen XML Editor](http://www.oxygenxml.com/)。它与 Xalan 和 Saxon 变换引擎集成。它的调试模式允许您设置断点、监视变量并提供其他此类基本调试功能。你想要的可能有点矫枉过正，但它非常好。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-20T14:08:35.643

我曾经不得不编写和调试一些复杂的 XSLT 文档。当时我通过输出大量中间值来使用调试的“printf-style”。后来我发现有一种更简单的方法可以做到这一点 - [Altova XMLSpy](https://www.altova.com/xmlspy-xml-editor)。它允许您单步执行样式应用程序，查看中间输出等。

VS8 还具有 XSLT 调试支持。见这里： http: [//msdn.microsoft.com/en-us/library/ms255605 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms255605(VS.80).aspx)

我还应该提到 XMLSpy 和 VS8 都具有语法高亮功能。如果您在 XML 中指定 XSD，VS8 甚至会为您提供智能感知！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-20T20:39:34.903

我几乎每天都在使用 XSLT，并且已经使用了六七年。

我发现 XSLT 的“printf 风格”调试非常有效，以至于我从来没有从使用任何其他调试机制中获益（我已经尝试过 XMLSpy 和 Visual Studio）。有时确实会发生我希望能够检查变量的值并构建输出它的逻辑是一件麻烦事。但这非常罕见。

拥有调试器可能会使*学习*XSLT 变得更容易。（任何东西都会有。）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-03-18T12:10:28.003

[PHPStorm](https://www.jetbrains.com/phpstorm/)和其他 IntelliJ IDE（商业）支持[调试 XSLT](https://www.jetbrains.com/phpstorm/help/run-debug-configuration-xslt.html)。您可以逐步浏览文档并查看逐步生成的输出。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-20T14:02:45.547

学习时，语法高亮编辑器通常对我来说就足够了（当然，在另一个窗口上打开 ref doc。

Kate 是一位出色的 XML 和 XSLT 编辑器。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-22T11:13:27.633

[Xselerator](http://www.marrowsoft.co.uk/)是一个很棒的 XSL 调试工具，它将：

*   让您逐步了解您的 XSLT dom
*   创建监视语句
*   针对您的 XML DOM 评估 XPath 语句
*   带有 Intellisense 的 IDE

我已经使用了多年，它是一个很棒的工具。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2018-02-23T13:28:19.127

Microsoft Visual Studio 也是 xslt 调试器的绝佳工具。但是你必须安装

# perl - 如何创建数据结构的可重复签名？

> ID：218531
> 
> 赞同：12
> 
> 时间：2008-10-20T13:59:03.527
> 
> 标签：perl, data-structures, signature

我有一种情况，我想创建数据结构的签名：

```
my $signature = ds_to_sig(
  { foo   => 'bar',
    baz   => 'bundy',
    boing => undef,
    number => 1_234_567,
  }
); 
```

目标应该是，如果数据结构发生变化，那么签名也应该如此。

有没有既定的方法来做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-20T14:05:46.337

我认为您正在寻找的是哈希函数。我会推荐这样的方法：

```
use Storable;
$Storable::canonical = 1;
sub ds_to_sig {
    my $structure = shift;
    return hash(freeze $structure);
} 
```

函数哈希可以是任何哈希函数，例如来自[Digest::MD5的函数 md5](http://search.cpan.org/~gaas/Digest-MD5/MD5.pm)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-20T14:15:53.820

最好的方法是使用像[Storable](http://search.cpan.org/~ams/Storable-2.18/Storable.pm)这样的深度结构序列化系统。具有相同数据的两个结构将产生相同的可存储输出 blob，因此可以对它们进行比较。

```
#!/usr/bin/perl

use strict;
use warnings;

use Storable ('freeze');

$Storable::canonical = 1;

my $one = { foo => 42, bar => [ 1, 2, 3 ] };
my $two = { foo => 42, bar => [ 1, 2, 3 ] };

my $one_s = freeze $one;
my $two_s = freeze $two;

print "match\n" if $one_s eq $two_s; 
```

...并证明相反的：

```
$one = [ 4, 5, 6 ];
$one_s = freeze $one;

print "no match" if $one_s ne $two_s; 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-20T14:13:30.673

使用[Storable](http://search.cpan.org/perldoc?Storable) ::nstore 将其转换为二进制表示，然后计算校验和（例如使用 Digest 模块）。

这两个模块都是核心模块。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-20T14:26:37.480

```
Digest::MD5->new->add(
  Data::Dumper->new([$structure])
   ->Purity(0)
   ->Terse(1)
   ->Indent(0)
   ->Useqq(1)
   ->Sortkeys(1)
   ->Dump()
)->b64digest(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T14:03:34.627

我认为您正在寻找的词是[“散列”](http://en.wikipedia.org/wiki/Hash_function)。

基本上，您将数据结构放置在一个从中生成相当独特值的函数中。该值将是您的签名。

* * *

## 回答 #6

> 赞同：-5
> 
> 时间：2008-10-20T14:07:07.287

你不能使用对象而不是结构吗？这样您就可以查看对象是否是类型的实例，而无需比较哈希等。

# java - 如何以编程方式检查 HTML 文档

> ID：218535
> 
> 赞同：7
> 
> 时间：2008-10-20T13:59:18.830
> 
> 标签：java, html, parsing

我有一个充满小型 HTML 文档的数据库，我需要以编程方式将几个插入到，例如，带有*iText*的 PDF 文档或带有*Aspose.Words*的 Word 文档中。我需要保留 HTML 文档中的任何格式（在合理的范围内，尊重 <b> 标签是必须的，像 <span style="blah"> 这样的 CSS 是一个不错的选择）。

iText 和 Aspose 都（大致）按照以下方式工作：

```
Document document = new Document( Size.A4, Aspect.PORTRAIT );

document.setFont( "Helvetica", 20, Font.BOLD );
document.insert( "some string" )
document.setBold( true );
document.insert( "A bold string" ); 
```

因此（我认为）我需要某种 HTML 解析器，我可以检查字符串和样式以插入到我的文档中。

任何人都可以建议一个好的图书馆或解决这个问题的明智方法吗？平台是 Java

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T20:26:47.130

[HTMLparser](http://htmlparser.sourceforge.net/)是一个很好的 HTML 解析器。

我用它来解析我的一个项目中的 HTML。

您可以编写自己的过滤器来解析您想要的 HTML，因此 `<br>`标签应该不难解析

[你可以使用CssSelectorNodeFilter](http://htmlparser.sourceforge.net/javadoc/org/htmlparser/filters/CssSelectorNodeFilter.html)解析出 CSS

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T15:31:53.993

如果 HTML 是“格式良好的 XML”（XHTML），为什么不使用 XML 解析器（例如 Xerces）然后以编程方式检查 DOM 树。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T14:51:03.780

Adobe Acrobat Pro 允许您通过 HTTP 抓取网站，并且在保留样式和布局方面做得非常出色。我没有从 API 方面使用它，但它可能值得研究。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T20:36:44.567

You'd probably be better off getting a component that goes directly from HTML to PDF, or Word, then to try to parse the HTML document and duplicate the formatting yourself based on the HTML. If you want to convert HTML to PDF, and you use .Net, [Winnovative](http://www.winnovative-software.com/) provides a good solution.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-21T01:36:03.213

Check out the [flying saucer xhtml renderer](http://code.google.com/p/flying-saucer//)- they render well-formed XHTML files to PDF, and let you control the output using CSS.

# objective-c - 在 Cocoa 应用程序中使用 XML-RPC 的最佳方式？

> ID：218538
> 
> 赞同：13
> 
> 时间：2008-10-20T14:00:20.997
> 
> 标签：objective-c, cocoa, xml-rpc

我想为一个使用 XML-RPC 的应用程序编写一个 GUI 包装器，并想知道是否有任何可用于 Cocoa 的 XML-RPC 框架，如果有，什么是最好的？

提前致谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-25T09:38:34.193

非常感谢您的回答。

昨天我就这个主题进行了一次广泛的 Google 会议，并提出了一些用于 Cocoa 的专用 XML-RPC 框架。

1.  来自 Eric Czarny 的“可可 XML-RPC 框架”，可在[http://github.com/eczarny/xmlrpc/tree/master找到](http://github.com/eczarny/xmlrpc/tree/master)
2.  来自 Brent Simmons 的“用于 Cocoa 的开源 XML-RPC 类”可以在[http://ranchero.com/cocoa/xmlrpc/找到](http://ranchero.com/cocoa/xmlrpc/)
3.  Marcus Müller 的“XMLRPC 框架”似乎有点过时，可以在[http://www.mulle-kybernetik.com/software/XMLRPC/找到](http://www.mulle-kybernetik.com/software/XMLRPC/)

我想知道是否有人对其中任何一个有任何经验或推荐使用哪一个。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-20T14:31:01.747

Denton 提到的框架是 Apple 的[Web Services Core](http://developer.apple.com/documentation/Networking/Conceptual/UsingWebservices/1_intro_folder/chapter_1_section_1.html)，它声称支持 XML-RPC 和 SOAP。我个人尝试将它用于 SOAP，但发现支持非常缺乏（以至于我最终通过 CFHTTPRequest 和 libxml2 推出了自己的支持）。各种邮件列表使我相信它可能对 XML-RPC 更好一些。

请注意，此 API 最初包含在 10.2 (Jaguar) 中，我很确定从那以后它就没有被触及过。该文档还包含许多从未更正的遗漏和错误。而且它是一个 Carbon API，所以你不会得到我们都知道和喜爱的所有有趣的 Objective-C 优点。

话虽这么说，它是由操作系统提供的，因此您不必担心运送和链接到第三方库。所以这不是一个糟糕的起点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-01-17T20:09:07.810

我认为最好的可用和积极维护的框架是 Eric Czarny 的“Cocoa XML-RPC 框架”。最后，XML-RPC 并没有什么神奇之处，您应该也对 Apple 的 Web Services Core 感到相当满意（就像 James 已经提到的那样）。如果你想摆脱 C 风格的语法，我真的推荐 Eric 的框架，因为它不是那么冗长而且相对来说比较好用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T14:13:04.857

我相信从 MacOS X 的早期版本开始就存在一个 Web 服务框架。我在[Late Night Cocoa 播客 #3](http://www.mac-developer-network.com/podcasts/latenightcocoa/episode3/index.html)上听说过它，它是关于 SOAP、XML-RPC 和 REST for Cocoa 的。我从未亲自使用过该框架。

# mysql - MySQL以异常方式中断SP执行

> ID：218547
> 
> 赞同：0
> 
> 时间：2008-10-20T14:02:49.137
> 
> 标签：mysql

如何在 MySQL 中以异常方式中断 SP 执行？

当传递非法参数时，我需要中断 SP 执行，因此不执行 UPDATE/INSERT。

我的老师实际上是通过创建一个名为“raise_error”的 SP 来做到这一点的，它除了执行一个不存在的表之外什么也没做。我认为这是一个WTF ......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T14:15:37.237

简短的回答，不。它也不会在不久的将来实施。

请参阅[http://bugs.mysql.com/bug.php?id=16999](http://bugs.mysql.com/bug.php?id=16999)

可悲的是，您的老师几乎是正确的（尽管，是的，在几乎任何其他 SQL 方言中，这将是一种 WTFy 的做事方式！）。

# visual-studio-2008 - 在 VS2008 中将 doxygen 作为自定义构建步骤运行

> ID：218551
> 
> 赞同：4
> 
> 时间：2008-10-20T14:04:17.493
> 
> 标签：visual-studio-2008, doxygen, custom-build-step

我正在为每个构建的（相当小的）项目生成 doxygen 文档。我做了以下事情来做到这一点：

1.  在项目中添加了`index.html`doxygen 生成的 .
2.  为此文件指定了一个自定义构建步骤（不是整个项目）
    *   命令行：`doxygen ../doc/Doxyfile`
    *   输出：`..doc/html/index.html`
    *   附加依赖项：'../bin/foo.exe'

问题是，我需要构建两次，直到 VS 停止告诉我我的项目已过时。
我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-21T14:56:15.500

在确定是否构建任何内容时，Visual Studio 会查看输出文件是否比输入文件旧。

您将 index.html 添加为输入文件，而它实际上是一个输出文件。添加 Doxyfile 也不起作用，因为它不会经常更改。这就是重建项目有效的原因（因为它忽略了文件的年龄并且无论如何都会进行构建）。

这是您想要捕获的 C++ 文件中的更改。如果（我怀疑）doxygen 无论如何都会进行增量构建，那么最好将 doxygen 步骤简单地添加为 Post-build 事件。

# c# - 如何停止 UrlRewriter 剥离我的 + 符号

> ID：218554
> 
> 赞同：1
> 
> 时间：2008-10-20T14:04:41.130
> 
> 标签：c#, asp.net, regex, urlrewriter

我在我的应用程序中使用了 Intelligencia 的 UrlRewriter，我遇到了一个问题，我设置的规则似乎正在从我的 url 中删除 + 符号。

例如，我想拥有这些网址`/category/catname/+tag+tag`，但在我看来它是`/category/catname/ tag tag`

有没有人有任何想法，这取决于我的正则表达式吗？我已经在调节器中尝试过，它匹配得很好。

```
<rewriter>
  <rewrite url="^/content/(.+)$" to="~/page.aspx?name=$1" />
  <rewrite url="^/category/(.+)$" to="~/catalog.aspx?category=$1" />
  <rewrite url="^/product/(.+)$" to="~/catalog.aspx?product=$1" />
  <rewrite url="~/login/" to="~/login.aspx"/>
</rewriter> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-20T14:08:28.437

这样做的原因是因为“+”在你的重写器实际得到它之前被网络服务器解析为一个空格。文字 + 是您不能在实际 URL 中使用的东西。如果要使用 +，则需要将其引用为 %2B：“/category/catname/%2Btag1%2Btag2”。

编辑： [这是一个 URL 编码的例子](http://www.permadi.com/tutorial/urlEncoding/)这说明了一些你不能使用的字符，以及如何对它们进行编码。如果您正在为 URL 寻找更具视觉吸引力的字符，您可以尝试“-”和“_”，它们都是有效的，我建议使用“-”。该 url 的示例将是“/category/catname/-tag1-tag2”。

# c# - 如何区分.Net中的单击和双击？

> ID：218555
> 
> 赞同：9
> 
> 时间：2008-10-20T14:04:41.813
> 
> 标签：c#, .net, user-interface, click

我想覆盖 OnMouseClick 和 OnMouseDoubleClick 并根据使用的单击样式执行不同的操作。

问题是 OnMouseClick 在单击和双击时都会发生，并且在 OnMouseDoubleClick 之前被调用。

我确定这一定是一个常见的要求，所以我想我错过了一些非常明显的东西。有人可以填我吗？

编辑添加： MouseEventArgs.Clicks 计数没有帮助。在双击的情况下，第一次单击在 OnMouseClick 中被处理为单击 MouseEventArgs.Clicks == 1。

编辑添加：对象是图像缩略图。单击应打开和关闭选择以进行导出。双击应该使缩略图全屏。选择和“激活”动作是正交的。这可能表明这两个操作存在潜在问题...

干杯，罗伯

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-20T14:09:07.033

这在整个 Windows 中都会发生。我不认为他们在.Net 中添加了任何特别的东西来处理它。

处理这个的正常方法是

*   a) 只需单击您希望在双击之前发生的事情，例如选择。
*   b）如果这不是一个选项，那么在点击事件上，启动一个计时器。在计时器滴答声中，执行单击操作。如果先发生双击事件，则终止计时器，然后执行双击动作。

您设置的时间量应该等于系统的双击时间（用户可以在控制面板中指定）。它可从 System.Windows.Forms.SystemInformation.DoubleClickTime 获得。完整的详细信息在 MSDN 中，[这里](http://msdn.microsoft.com/en-us/library/ms172533.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T14:11:07.777

问题是大多数对象都没有同时实现。可以合理地对单击和双击具有不同操作的少数对象通常可以在双击操作之前运行单击操作（突出显示然后打开文件夹，在选择它之前在地址栏上输入焦点等）。确定的方法可能是等待单击一段时间，如果检测到双击，则取消单击操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T14:27:41.893

Another possible solution is to have the OnMouseDoubleClick function call OnMouseClick. Since the action in OnMouseClick is a binary toggle, calling it twice resets it to the same state.

So when the user double clicks, windows calls OnMouseClick, then OnMouseDoubleClick. OnMouseDoubleClick calls OnMouseClick (again) to restore the state, then handles the double click.

This feels unsatisfying as a solution, but it works.

Using a timer (to swallow the first click of the double click) is equally unsatisfying, and has the added complication of handling user's double click rate preferences.

Cheers, Rob

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-10-20T14:13:25.137

您可以在 OnMouseClick 事件处理程序中启动一个计时器。

*   If the timer times out (say 300ms) then a single click is intended.

*Else*

*   If another OnMouseClick event was generated before the time times out you could examine the x&y position of the click and if its within a particular radius of the first click then action the double click functionality.

*Otherwise*

*   Handle first click and re-initialise timer for second click

NB: This implementation has the advantage of the fact that both the timeoput and the 'double-click' radius can be configured independantly of the system configuration allowing the s/w to be imported onto multiple machines/

# c# - 使用 C# 将文档发送到打印机

> ID：218556
> 
> 赞同：8
> 
> 时间：2008-10-20T14:05:36.273
> 
> 标签：c#, printing

我被要求使用内部 Web 应用程序将文档透明地发送到打印机。这个想法是用户可以选择离他们最近的打印机，Web 应用程序会将他们的打印作业发送到他们选择的打印机。

我们必须推出的第一台打印机是佳能，所以我的问题是：我将如何发送文档以通过网络打印到特定的佳能？Cannon的类型问题是iR5570，将要说的文件主要是Word和PDF

我目前正在通过糟糕的、仅限 IE 的佳能开发者网站工作，但我有点希望有人能指出我正确的方向或将我指向第 3 方集会:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-20T14:40:55.063

该问题的关键词是“网络应用程序”。

在仅通过 HTTP 使用 HTML+Javascript 的普通 Web 应用程序中，您*不能*直接将文档发送到打印机。这就是 Web 浏览器存在的原因之一，如果没有该功能，每个人的打印机都会像公共传真机一样收集相同类型的垃圾。

So you need some kind of work-around. One option is to build on a common plug-in, like flash, silverlight, java applet, or even something like greasemonkey. Another is a custom plug-in, like a hosted winforms control or custom browser extension.

You are very fortunate, in that it looks like you have complete control (or knowlege of) the deployment environment, and that this environment if fairly homogenous. This means you have an additional option that others have started to explore. If you can install all of the printers in your environment to the web server, then it's fairly easy using the built-in .Net printer classes (in the `System.Drawing.Printing` namespace) to list out those printer, either show them to the user so they can pick or keep some kind of IP to Printer mapping table, and then print directly to that printer from your web app. Note that this scheme may require your app to run at a higher level of trust than would otherwise be required.

Now it comes to actually printing your PDF's and word documents. For acrobat, check this link:
[http://support.adobe.com/devsup/devsup.nsf/docs/52080.htm](http://web.archive.org/web/20090206162133/http://support.adobe.com/devsup/devsup.nsf/docs/52080.htm) (Wayback machine)
Note that it's a little dated, but I believe the concept is still valid. You'll have to experiment some to make sure it works as expected.

For Word, I'm not normally a fan of Office interop/automation in a web app. But in this case you're not editing any documents: just loading it up long enough to print. And the fact that you're relying on another scarce resource (the printers) should keep this from scaling beyond what your web server could cope with. So you may have a rare case where Office automation in a web project makes sense.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-21T13:10:23.063

Many printers and multifunction devices today support the printing of PDFs directly, this may solve one of your problems. Simply have the PDF sent to the printer. In fact, some even support the sending of a URL and the printer will then go get the document and print it. Lexmark for sure does this and I think a few other vendors do as well. This still mean you have to deal with the Word document. Word 2007 supports PDF (with the [add-in installed from Microsoft](http://www.microsoft.com/downloads/details.aspx?FamilyId=4D951911-3E7E-4AE6-B059-A2E79ED87041&displaylang=en)) and I've used this function programatically with great success in C#.

Here's the code for that:

```
Microsoft.Office.Interop.Word.ApplicationClass msWord = new Microsoft.Office.Interop.Word.ApplicationClass();

object paramUnknown = Type.Missing;
object missing = Type.Missing;
object paramSaveChangesNo = Microsoft.Office.Interop.Word.WdSaveOptions.wdDoNotSaveChanges;
//object paramFonts = Microsoft.Office.Interop.Word.wde
object paramFormatPDF = Microsoft.Office.Interop.Word.WdSaveFormat.wdFormatPDF;
object paramTrue = true;
object paramReadOnly = true;  
object sourceDoc = @"c:\input.doc"                              
object target = @"c:\output.pdf";

msWord.Visible = false;

//open .doc
msWord.Documents.Open(ref sourceDoc, ref paramUnknown, ref paramReadOnly, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown);

//so it won't show on the taskbar
msWord.Application.Visible = false;
msWord.WindowState = Microsoft.Office.Interop.Word.WdWindowState.wdWindowStateMinimize;

//save .doc to new target name and format
msWord.ActiveDocument.SaveAs(ref targetDoc, ref paramFormatPDF, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramTrue, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown, ref paramUnknown);

msWord.ActiveDocument.Close(ref missing, ref missing, ref missing);

msWord.Quit(ref paramSaveChangesNo, ref paramUnknown, ref paramUnknown); 
```

Lastly, if your device doesn't support PDF printing then you could use Ghostscript or other tools to convert your PDF to PS or even PCL. Not the greatest as this mean running a little unmanaged code or worst case, shelling out and executing the GS command line, that being said, we currently do this in one of our web apps and it works well. As an aside, we don't do it for print but rather the joining of a number of PDFs togheter, but in the end it will work the same.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-20T14:21:19.520

[PrintDocument](http://msdn.microsoft.com/en-us/library/system.drawing.printing.printdocument(VS.71).aspx)文档包含从*C#*打印的详细示例。打印机名称应指向本地打印机或打印机共享。请参阅[以编程方式打印到 PDF 打印机](https://stackoverflow.com/questions/163420/printing-to-a-pdf-printer-programatically)以打印 PDF 文档。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-20T14:23:04.087

有些东西必须将您的 Word 和 PDF 文档翻译成打印机可以理解的东西。通常，前者是 Word 本身，后者是某种 PDF 查看器。然后需要指示这些程序将输出发送到哪台打印机。

一种可能的方法是将文档保存为 Postscript 文件。然后它们可以直接从 C# 应用程序发送到支持 Postscript 的打印机。这可能是最简单的方法。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-20T14:39:58.920

检查 sql 报告服务的功能可能值得 5 分钟。我过去曾使用它来直接渲染 pdf 以进行打印。

[http://blogs.msdn.com/bryanke/articles/71491.aspx](http://blogs.msdn.com/bryanke/articles/71491.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-20T14:16:52.430

如果有问题的文档类型是 Windows 已知的（DOC 和 PDF 应该是），你可以使用 windows 动词来做到这一点吗？

[Codeproject PDF 示例：使用 PDF995 和 FreePDF_XP 软件打印机自动转换 PDF](http://www.codeproject.com/KB/files/anyfiletopdf.aspx?display=Print) [MSDN：动词和文件关联](http://msdn.microsoft.com/en-us/library/cc144175(VS.85).aspx)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-07-04T09:09:43.503

This code works perfectly It uses Adobe reader itself to print

Hints to use 1- don't forget to provide your own install path to adobe reader 2- Get printer name from Properties of the Printer you want to print with

use the class like this:

```
PdfFilePrinter p = new PdfFilePrinter();

p.PdfFileName = @"c:\1.pdf";
p.Print();
p.PdfFileName = @"c:\2.pdf";
p.Print(); 
```

and the class is :

```
public class PdfFilePrinter
{
    /// <summary>
    /// Initializes a new instance of the <see cref="PdfFilePrinter"/> class.
    /// </summary>
    public PdfFilePrinter()
    {
        adobeReaderPath = @"C:\Program Files\Adobe\Reader 9.0\Reader\AcroRd32.exe";
        printerName = "HP LaserJet P2055 Series PCL6";
    }

    /// <summary>
    /// Initializes a new instance of the <see cref="PdfFilePrinter"/> class.
    /// </summary>
    /// <param name="pdfFileName">Name of the PDF file.</param>
    public PdfFilePrinter(string pdfFileName)
    {
        this.PdfFileName = pdfFileName;
    }

    /// <summary>
    /// Initializes a new instance of the <see cref="PdfFilePrinter"/> class.
    /// </summary>
    /// <param name="pdfFileName">Name of the PDF file.</param>
    /// <param name="printerName">Name of the printer.</param>
    public PdfFilePrinter(string pdfFileName, string printerName)
    {
        this.pdfFileName = pdfFileName;
        this.printerName = printerName;
    }

    /// <summary>
    /// Gets or sets the name of the PDF file to print.
    /// </summary>
    public string PdfFileName
    {
        get { return this.pdfFileName; }
        set { this.pdfFileName = value; }
    }
    string pdfFileName;

    /// <summary>
    /// Gets or sets the name of the printer. A typical name looks like '\\myserver\HP LaserJet PCL5'.
    /// </summary>
    /// <value>The name of the printer.</value>
    public string PrinterName
    {
        get { return this.printerName; }
        set { this.printerName = value; }
    }
    string printerName;

    /// <summary>
    /// Gets or sets the working directory.
    /// </summary>
    public string WorkingDirectory
    {
        get { return this.workingDirectory; }
        set { this.workingDirectory = value; }
    }
    string workingDirectory;

    /// <summary>
    /// Prints the PDF file.
    /// </summary>
    public void Print()
    {
        Print(-1);
    }

    /// <summary>
    /// Prints the PDF file.
    /// </summary>
    /// <param name="milliseconds">The number of milliseconds to wait for completing the print job.</param>
    public void Print(int milliseconds)
    {
        if (this.printerName == null || this.printerName.Length == 0)
            this.printerName = PdfFilePrinter.defaultPrinterName;

        if (PdfFilePrinter.adobeReaderPath == null || PdfFilePrinter.adobeReaderPath.Length == 0)
            throw new InvalidOperationException("No full qualified path to AcroRd32.exe or Acrobat.exe is set.");

        if (this.printerName == null || this.printerName.Length == 0)
            throw new InvalidOperationException("No printer name set.");

        // Check whether file exists.
        string fqName = String.Empty;
        if (this.workingDirectory != null && this.workingDirectory.Length != 0)
            fqName = Path.Combine(this.workingDirectory, this.pdfFileName);
        else
            fqName = Path.Combine(Directory.GetCurrentDirectory(), this.pdfFileName);
        if (!File.Exists(fqName))
            throw new InvalidOperationException(String.Format("The file {0} does not exist.", fqName));

        // TODO: Check whether printer exists.

        try
        {
            DoSomeVeryDirtyHacksToMakeItWork();

            //acrord32.exe /t          <- seems to work best
            //acrord32.exe /h /p       <- some swear by this version
            ProcessStartInfo startInfo = new ProcessStartInfo();
            startInfo.FileName = PdfFilePrinter.adobeReaderPath;
            string args = String.Format("/t \"{0}\" \"{1}\"", this.pdfFileName, this.printerName);
            //Debug.WriteLine(args);
            startInfo.Arguments = args;
            startInfo.CreateNoWindow = true;
            startInfo.ErrorDialog = false;
            startInfo.UseShellExecute = false;
            if (this.workingDirectory != null && this.workingDirectory.Length != 0)
                startInfo.WorkingDirectory = this.workingDirectory;

            Process process = Process.Start(startInfo);
            if (!process.WaitForExit(milliseconds))
            {
                // Kill Adobe Reader/Acrobat
                process.Kill();
            }
        }
        catch (Exception ex)
        {
            throw ex;
        }
    }

    /// <summary>
    /// For reasons only Adobe knows the Reader seams to open and shows the document instead of printing it
    /// when it was not already running.
    /// If you use PDFsharp and have any suggestions to circumvent this function, please let us know.
    /// </summary>
    void DoSomeVeryDirtyHacksToMakeItWork()
    {
        if (PdfFilePrinter.runningAcro != null)
        {
            if (!PdfFilePrinter.runningAcro.HasExited)
                return;
            PdfFilePrinter.runningAcro.Dispose();
            PdfFilePrinter.runningAcro = null;
        }
        // Is any Adobe Reader/Acrobat running?
        Process[] processes = Process.GetProcesses();
        int count = processes.Length;
        for (int idx = 0; idx < count; idx++)
        {
            try
            {
                Process process = processes[idx];
                ProcessModule module = process.MainModule;

                if (String.Compare(Path.GetFileName(module.FileName), Path.GetFileName(PdfFilePrinter.adobeReaderPath), true) == 0)
                {
                    // Yes: Fine, we can print.
                    PdfFilePrinter.runningAcro = process;
                    break;
                }
            }
            catch { }
        }
        if (PdfFilePrinter.runningAcro == null)
        {
            // No: Start an Adobe Reader/Acrobat.
            // If you are within ASP.NET, good luck...
            PdfFilePrinter.runningAcro = Process.Start(PdfFilePrinter.adobeReaderPath);
            PdfFilePrinter.runningAcro.WaitForInputIdle();
        }
    }
    static Process runningAcro;

    /// <summary>
    /// Gets or sets the Adobe Reader or Adobe Acrobat path.
    /// A typical name looks like 'C:\Program Files\Adobe\Adobe Reader 7.0\AcroRd32.exe'.
    /// </summary>
    static public string AdobeReaderPath
    {
        get { return PdfFilePrinter.adobeReaderPath; }
        set { PdfFilePrinter.adobeReaderPath = value; }
    }
    static string adobeReaderPath;

    /// <summary>
    /// Gets or sets the name of the default printer. A typical name looks like '\\myserver\HP LaserJet PCL5'.
    /// </summary>
    static public string DefaultPrinterName
    {
        get { return PdfFilePrinter.defaultPrinterName; }
        set { PdfFilePrinter.defaultPrinterName = value; }
    }
    static string defaultPrinterName;
} 
```

# oracle - 如何从 SQL Server 2000 查询 Oracle 表？

> ID：218561
> 
> 赞同：3
> 
> 时间：2008-10-20T14:07:23.697
> 
> 标签：oracle, sql-server-2000

一位同事想使用 SQL Server 2000 企业管理器查询 Oracle 数据库中的表。

他知道如何做整个 DTS 事情，但不想沿着这条路线进行添加 hoc 查询。

还有其他方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T14:15:57.643

这是一个分步指南：[设置 Oracle 链接服务器](http://www.sqlmag.com/Article/ArticleID/49687/sql_server_49687.html)

请注意，Oracle RDBMS 的默认 Microsoft 驱动程序不起作用，因此您需要安装 Oracle 客户端（或即时客户端）

另一个微软链接：[MSDN](http://support.microsoft.com/kb/280106)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T14:14:31.890

您应该能够将其添加为链接服务器（在企业管理器的安全性下）。然后您可以通过以下方式查询它：

从 OracleServer.Database.dbo.Table 中选择 *

- 实际上从未使用过 Oracle，所以不确定“dbo”位是否正确，或者这是否只是 SQL Server 的事情。

# mfc - 如何在 MFC CListCtrl 中实现“点击并按住”行为？

> ID：218563
> 
> 赞同：1
> 
> 时间：2008-10-20T14:07:28.643
> 
> 标签：mfc, listview, mouse, click, tapandhold

如何在 MFC CListCtrl 中实现“点击并按住”行为？

我在 CDialog 中有一个 MFC CListCtrl，我需要向 CListCtrl 添加“点击并按住”行为。

这就是我所说的“点击并按住”：

如果用户在 CListCtrl 项上单击（用鼠标左键进行“标准”单击），则将调用函数 A。

如果用户单击 CListCtrl 项目并按住鼠标左键超过一秒钟，则将调用函数 B。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T15:26:06.113

继承 CListCtrl 并实现 OnLButtonDown 和 OnLButtonUp。在 OnLButtonDown 中设置一个计时器，以设置在执行“制表符并按住”之前要等待的时间。

在您的计时器处理程序中，执行“点击并按住”操作。

如果在定时器到期前得到 OnLButtonUp，取消定时器并执行“点击”动作（如果 OnLButtonUp 的 CPoint 参数在列表项上方。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-21T14:51:08.070

除了 ajryans 的建议之外，您可能还需要对您的 CListBox 派生类进行子类化，以便它从您的对话框中获取鼠标消息。就像是;

```
BOOL CMyDialog::OnInitDialog() 
{
  MyListboxCtrl.SubclassDlgItem(ID_MYLISTBOX,this);
  CDialog::OnInitDialog();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-09T16:48:57.603

这是另一种没有计时器的方法[http://www.codeproject.com/KB/mobile/tapandhold.aspx](http://www.codeproject.com/KB/mobile/tapandhold.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-05T14:10:28.433

可以通过pinvoking来完成

[http://www.ceveni.com/2009/10/sample-code-for-context-menu-in-c.html](http://www.ceveni.com/2009/10/sample-code-for-context-menu-in-c.html)

我想这就是你要找的东西？

# java - 实例变量声明的放置

> ID：218573
> 
> 赞同：11
> 
> 时间：2008-10-20T14:10:13.707
> 
> 标签：java, variables, coding-style

我见过一些开发人员将实例变量声明放在类的末尾，尽管我大多看到它们放在顶部。我能想到这样做的唯一原因是风格偏好，或者也许它以某种方式使它们更容易在 IDE 中使用。选择这种风格有更正当的理由吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-20T14:31:48.797

因为“编程到‘接口’，而不是‘实现’。” （Gang of Four 1995:18）（[http://en.wikipedia.org/wiki/Design_Patterns#Introduction.2C_Chapter_1](http://en.wikipedia.org/wiki/Design_Patterns#Introduction.2C_Chapter_1)），有些人喜欢在类的底部声明实例变量。理论是类的用户更感兴趣的是他们可以用类（方法）做什么，而不是如何完成某事（变量）。将方法放在类的顶部会在用户查看代码时首先将它们公开给用户。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-20T14:14:19.143

以一种或另一种方式做这件事没有特别“好的”理由。唯一真正重要的是同一个项目中的每个人都以同样的方式做事。

但是，根据我的经验，将它们放在顶部更为常见，并且是[Java 样式指南](http://java.sun.com/docs/codeconv/html/CodeConventions.doc2.html#1852)推荐的做法，所以我会这样做。

[您可以使用Jalopy](http://jalopy.sourceforge.net/)等自动源代码格式化程序或 Eclipse 附带的程序来强制执行您选择的约定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-20T14:13:46.150

这主要是（如果不是完全）个人喜好。我喜欢他们在顶部，但我真的无法给出更好的理由，那就是这是我习惯的方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-11T15:56:57.160

大多数实例变量是`private`，所以我倾向于将它们放在底部，因为我声明成员的顺序是降低可见性。如果我按照*增加*可见度的顺序声明它们，它们将位于顶部，这也是合理的。

我不喜欢有私有字段，然后是公共字段，然后是私有方法。如果我正在开发一个客户端类，我希望将所有公共部分放在一起（因为这就是我感兴趣的全部。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-01T21:34:27.513

我一直认为如果你有一个私有类级别的变量，那么你要么硬编码了配置，要么以一种或另一种方式跟踪状态。如果您正在跟踪状态，那么 1) 从打开文件的那一刻起，对于要在文件中编写代码的每个人来说，这应该是显而易见的，并且 2) 跟踪大量状态是一种巨大的代码气味，如果我的开发人员正在这样做，那么我希望它是显而易见的。所以把它放在顶部，恕我直言，让糟糕的代码更加明显，并作为对未来编辑该类的人的警告。

Definitely separate your public/protected vs private fields and members though, because people interested in one, likely aren't interested in the other.

# asp.net - jQuery 1.2.6 的 Visual Studio jscript 智能感知错误？

> ID：218578
> 
> 赞同：2
> 
> 时间：2008-10-20T14:10:47.373
> 
> 标签：asp.net, jquery, intellisense

我收到带有不同行号的警告“childNodes 为空或不是对象”，具体取决于我引用的库版本（我尝试了大约三个不同版本的 1.2.6）。因此，我得到了 jQuery 智能感知的插孔.

我可以破解它以使其工作，但我宁愿不这样做，因为我不了解更改以下行的全部含义：

```
elem = jQuery.makeArray(div.childNodes); 
```

对此：

```
//HACK:  VS intellisense fix
if(div && div.childNodes)
  elem = jQuery.makeArray(div.childNodes); 
```

（更改的行仅在源中出现一次）。是什么赋予了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T13:21:58.440

我不久前遇到了同样的问题。你也在使用 jQuery UI 文件吗？我是，结果发现 jquery ui javascript 文件以某种方式弄乱了智能感知。所以我为 jquery ui 文件创建了一个空的 vsdoc.js 文件，然后智能感知开始工作。我的 jquery ui 文件名为 jquery-ui-personalized-1.6rc2.min.js。创建一个名为 jquery-ui-personalized-1.6rc2.min-vsdoc.js 的文件解决了这个问题。

我也在使用 jquery-jtemplates.js 但这似乎没有引起问题。我认为这只是 jquery-ui 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T14:40:56.750

您是否尝试过添加对此处可用的仅文档文件的引用？ [Visual Studio 2008 中的 jQuery IntelliSense](http://blogs.ipona.com/james/archive/2008/02/15/JQuery-IntelliSense-in-Visual-Studio-2008.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-15T15:27:09.750

它对我有用；不知道为什么这对我来说是一个错误以及为什么需要修复？

# networking - 从网络位数转换为网络掩码的最佳方法是什么？

> ID：218604
> 
> 赞同：8
> 
> 时间：2008-10-20T14:17:32.227
> 
> 标签：networking, bit-manipulation

例如，如果我有一个像 172.20.10.0/24 这样的网络规范，“24”就是比特数。将其转换为像 0xffffff00 这样的网络掩码的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-20T14:30:58.737

假设 32 位掩码和 32 位 int。

```
int keepBits = 24;  /* actually get it from somewhere else? */

int mask = (0xffffffff >> (32 - keepBits )) << (32 - keepBits); 
```

注意：这不一定是“获取接口的网络掩码的最佳方法是什么？”问题的答案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-20T15:06:17.993

我总是这样做（在你的情况下 cidr = 24）：

```
uint32_t ipv4Netmask;

ipv4Netmask = 0xFFFFFFFF;
ipv4Netmask <<= 32 - cidr;
ipv4Netmask = htonl(ipv4Netmask); 
```

这仅适用于 ipv4Netmask 实际上是 uint32_t，不要将其设为 int，因为 int 不必在每个系统上都是 32 位。结果被转换为网络字节顺序，这是大多数系统函数所期望的。

请注意，如果`cidr`为零，则此代码将失败，因为该代码会将 32 位变量移动 32 位，不管你信不信，这是 C 中未定义的行为。人们期望结果始终为零，但 C 标准说这不是一开始就定义的。如果您的 CIDR 可以为零（仅允许在任何 IP 地址占位符 0.0.0.0/0 中使用），则代码必须捕获特殊情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-20T14:23:16.473

这不是一个编程问题，但在 linux 中你可以使用 whatmask。

```
whatmask 72.20.10.0/24 
```

返回

```
IP Entered = ..................: 72.20.10.0
CIDR = ........................: /24
Netmask = .....................: 255.255.255.0
Netmask (hex) = ...............: 0xffffff00
Wildcard Bits = ...............: 0.0.0.255
------------------------------------------------
Network Address = .............: 72.20.10.0
Broadcast Address = ...........: 72.20.10.255
Usable IP Addresses = .........: 254
First Usable IP Address = .....: 72.20.10.1
Last Usable IP Address = ......: 72.20.10.254 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-20T14:33:57.527

```
int keepbits = 24;
int mask = keepbits > 0 ? 0x00 - (1<<(32 - keepbits)) : 0xFFFFFFFF; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-24T20:19:45.863

为什么要在减法或三元语句上浪费时间？

```
int suffix = 24;
int mask = 0xffffffff ^ 0xffffffff >> suffix; 
```

如果您知道您的整数正好是 32 位长，那么您只需要输入 0xffffffff 一次。

```
int32_t mask = ~(0xffffffff >> suffix); 
```

两者都编译成完全相同的汇编代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-20T15:30:41.750

这是VBScript，FWIW中的解决方案

```
option explicit

'whatmask 72.20.10.0/24
If WScript.Arguments.Unnamed.Count < 1 Then
    WScript.Echo "WhatMask xxx.xxx.xxx.xxx/xx"
    Wscript.Quit
End If

Dim sToFind
Dim aParts
Dim nSubnet

sToFind = WScript.Arguments(0)
aParts = Split( sToFind, "/", 2 )
nSubnet = aParts(1)

if nSubnet < 1 or nSubnet > 32 then
  WScript.echo "Subnet out of range [1..32]"
  Wscript.quit
end if

Dim sBinary
sBinary = String( nSubnet, "1")
sBinary = sBinary & String( 32 - nSubnet, "0" )

wscript.echo "0x" & lcase( binary2hexadecimal( sBinary ) )

function binary2hexadecimal( sBin )
  dim sSlice
  dim sResult
  dim i
  for i = 1 to len( sBin ) step 4
    sSlice = mid( sBin, i, 4 )
    sResult = sResult & hex( binary2decimal( sSlice ) )
  next
  binary2hexadecimal = sResult
end function

function binary2decimal( sFourbits )
  dim i
  dim bit
  dim nResult
  nResult = 0
  for i = 4 to 1 step -1
    bit = mid(sFourbits, i, 1 )
    nResult = nResult * 2 + bit
  next
  binary2decimal = nResult
end function 
```

从命令行

```
>whatmask.vbs 123.12.123.17/23
 0xfffff700 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-12-16T15:01:51.417

将先前的答案与以下代码一起使用时要小心：

```
0xFFFFFFFF << 32 - cidr 
```

或者

```
-1 << 32 - cidr 
```

至少在 C# 中，它将首先用 0x1F 屏蔽移位计数。因此，对于前缀为 0 的 cidr（即整个 IPv4 地址范围）：

```
int cidr=0;
0xFFFFFFFF << (32 - cidr) == 0xFFFFFFFF 
```

这不是你想要的。相反，您应该使用：

```
int cidr=0;
(int)(0xFFFFFFFFL << (32 - cidr)) == 0 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-20T14:23:26.630

您可以尝试一些简单的方法，例如获取位数并除以 4。这会给您掩码中的前导 F。然后取余数并从 0 位切换到 3 位。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2010-04-14T22:22:28.520

```
/* C# version merging some of the other contributions and corrected for byte order. */

int cidr = 24;

var ipv4Netmask = 0xFFFFFFFF;

ipv4Netmask <<= 32 - cidr;

byte[] bytes = BitConverter.GetBytes(ipv4Netmask);

Array.Reverse(bytes);

ipv4Netmask = BitConverter.ToUInt32(bytes, 0);    

// mask is now ready for use such as:

var netmask = new IPAddress(ipv4Netmask); 
```

# java - 一个在 Java 中进行 URL 查询字符串操作的好库

> ID：218608
> 
> 赞同：40
> 
> 时间：2008-10-20T14:19:29.133
> 
> 标签：java, url

我需要在 Java 中进行一些非常简单的 URL 操作。就像在查询中获取参数的值，或者更新它，......我期待在 commons-lang 包中找到一个简单的实用程序类，但没有。我知道这是一个简单的问题，但是如果已经写了一些东西，为什么还要再写一次呢？你知道吗？

我希望至少具备以下能力：

```
String myUrl = "http://www.example.com/test.html?toto=1&titi=2";

// get the value of a parameter
String parameterValue = UrlUtils.getParameterValue(myUrl, "toto");
Assert.equals(parameterValue, "1");

// update a parameter
String newUrl = UrlUtils.updateParameter(myUrl, "toto", 3);
parameterValue = UrlUtils.getParameterValue(myUrl, "toto");
Assert.equals(parameterValue, "3"); 
```

理想情况下，它将处理所有与编码相关的问题，并与 java.net.Url 以及字符串一起使用。

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-20T14:39:51.557

我认为你想要的是一个查询字符串解析器而不是一个 url 操纵器，这是一个： http: [//ostermiller.org/utils/CGIParser.java.html](http://ostermiller.org/utils/CGIParser.java.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-02-10T19:21:22.703

Apache 的 httpcomponents 库有一个 URL 解码器：http: [//hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/client/utils/URLEncodedUtils.html](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/client/utils/URLEncodedUtils.html)

Httpcomponents 是 commons http 客户端的继承者。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-23T21:09:16.173

Indeed 发布了一个用于查询字符串和数字解析的高效 Java 库：

[http://engineering.indeed.com/blog/2014/02/efficient-query-string-parsing-util-urlparsing/](http://engineering.indeed.com/blog/2014/02/efficient-query-string-parsing-util-urlparsing/)

[https://github.com/indeedeng/util/tree/master/urlparsing](https://github.com/indeedeng/util/tree/master/urlparsing)

（免责声明：我是 Indeed 的工程总监。）

# sharepoint - 正确处置 SharePoint 对象？

> ID：218613
> 
> 赞同：2
> 
> 时间：2008-10-20T14:21:18.070
> 
> 标签：sharepoint, memory-leaks, utilization, log-analysis

我希望这里有一个关于 SO 的 SharePoint 专家可以提供帮助。

这就是问题所在。我的 SharePoint 日志多次包含此行：

`An SPRequest object was not disposed before the end of this thread. To avoid wasting system resources, dispose of this object or its parent (such as an SPSite or SPWeb) as soon as you are done using it. This object will now be disposed. Allocation Id: {8D090AD2-5D55-42C2-9873-2D5486FE257C} To determine where this object was allocated, create a registry key at HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Shared Tools\Web Server Extensions\HeapSettings. Then create a new DWORD named SPRequestStackTrace with the value 1 under this key.`

我编辑了注册表并添加了密钥，但找不到堆栈跟踪。它不在 SharePoint 日志或事件查看器中。

我真的需要找到这些 SPSite/SPWeb 泄漏的来源并修复它们，但我不能只是开始编辑可能是也可能不是问题根源的代码。有没有人有什么建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T16:04:50.527

到目前为止，检查处置警告的最佳位置是：

[http://blogs.msdn.com/rogerla/archive/2008/02/12/sharepoint-2007-and-wss-3-0-dispose-patterns-by-example.aspx](http://blogs.msdn.com/rogerla/archive/2008/02/12/sharepoint-2007-and-wss-3-0-dispose-patterns-by-example.aspx)

在您的情况下， OpenWeb() 将需要包装在 using 中。如果您将它放在您的 fianlly 块中，那么我建议您显示更多代码以查看您是否正在调用任何其他“gotcha”实例。此外，如果某些 SPSite 和 SPWeb 对象是从 SPContext 类中获得的，则无需处置它们。

如果您想跟踪对象的处置，您可以继承它们并覆盖 onload 和 ondispose 方法以以详细的消息传递方式记录它们。

阅读您的代码表明 SPWeb 对象是在 RunWithElevatedPriviledges 委托之外声明的。这可能会影响 SharePoint 处理它们的方式。一般建议对委托内的对象做你需要做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T17:06:24.600

从前面提到的[http://msdn.microsoft.com/en-us/library/aa973248.aspx链接：](http://msdn.microsoft.com/en-us/library/aa973248.aspx)

> 调用**Response.Redirect 不会执行 finally 块**。因此，在任何重定向或处理转移发生之前，您必须处置对象。

鉴于您的示例代码，您仍然可以生成不会被释放的对象，因为 Dispose() 调用位于 finally 块中。

我的建议是将您的代码重新配置为以下内容：

```
try 
{
    //instantiate the SPSite and SPWeb with elevated privileges:    
    SPSecurity.RunWithElevatedPrivileges(delegate() 
    {
        using (SPSite mySite = new SPSite(url)) 
        {
            using (myWeb = mySite.OpenWeb()) 
            {
                //do stuff here
            }
        }
    });
} 
```

如果您有多层 Using 语句，您可以像这样“堆叠”它们并减少代码缩进的数量（类似于 if 语句执行下一行或块的方式）：

```
try 
{
    //instantiate the SPSite and SPWeb with elevated privileges:    
    SPSecurity.RunWithElevatedPrivileges(delegate() 
    {
        using (SPSite mySite = new SPSite(url)) 
        using (myWeb = mySite.OpenWeb()) 
        {
            //do stuff here
        }
    });
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-22T13:37:23.693

您需要重新启动受影响的进程（如果是 w3wp.exe 重新启动 IIS）以捕捉注册表更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T14:30:14.057

我建议您阅读以下内容：

*   ~~**MSDN**：[最佳实践：使用 SharePoint 对象模型时的常见编码问题](http://msdn.microsoft.com/en-us/library/bb687949.aspx)~~

*   ~~**MSDN**：[最佳实践：使用一次性 Windows SharePoint Services 对象](http://msdn.microsoft.com/en-us/library/aa973248.aspx)~~

*   **Chris O'Brien**：[处理 SharePoint 对象 - 他们没有告诉您的内容](http://www.sharepointnutsandbolts.com/2008/06/disposing-sharepoint-objects-what-they.html)

如果这些建议都不起作用。查看[WSS v3 和 MOSS 2007 中的 SPSite/SPWeb 泄漏故障排除](http://blogs.technet.com/stefan_gossner/archive/2008/05/07/troubleshooting-spsite-spweb-leaks-in-wss-v3-and-moss-2007.aspx)。

**编辑**：您应该处置 SPSite 对象。因为它会[自动处理他所有的 SPWeb 对象](http://blah.winsmarts.com/2008-9-To_dispose,_or_not_to_dispose_-_That_is_the_question.aspx)。

# python - 如何获取方法参数名称？

> ID：218616
> 
> 赞同：299
> 
> 时间：2008-10-20T14:22:02.810
> 
> 标签：python, decorator, introspection, python-datamodel

给定 Python 函数：

```
def a_method(arg1, arg2):
    pass 
```

如何提取参数的数量和名称。即，鉴于我有一个参考`func`，我想要`func.[something]`返回`("arg1", "arg2")`。

使用场景是我有一个装饰器，并且我希望按照它们作为键出现在实际函数中的相同顺序使用方法参数。即，`"a,b"`当我打电话时，装饰器会如何打印`a_method("a", "b")`？

* * *

## 回答 #1

> 赞同：429
> 
> 时间：2008-10-20T14:52:19.863

看看这个[`inspect`](http://docs.python.org/library/inspect.html)模块 - 这将为您检查各种代码对象属性。

```
>>> inspect.getfullargspec(a_method)
(['arg1', 'arg2'], None, None, None) 
```

其他结果是 *args 和 **kwargs 变量的名称，以及提供的默认值。IE。

```
>>> def foo(a, b, c=4, *arglist, **keywords): pass
>>> inspect.getfullargspec(foo)
(['a', 'b', 'c'], 'arglist', 'keywords', (4,)) 
```

请注意，某些可调用对象在 Python 的某些实现中可能是不可自省的。例如，在 CPython 中，C 中定义的一些内置函数不提供有关其参数的元数据。结果，`ValueError`如果您`inspect.getfullargspec()`在内置函数上使用，您将得到一个。

从 Python 3.3 开始，您可以使用[`inspect.signature()`](https://docs.python.org/library/inspect.html#introspecting-callables-with-the-signature-object)查看可调用对象的调用签名：

```
>>> inspect.signature(foo)
<Signature (a, b, c=4, *arglist, **keywords)> 
```

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2008-10-20T14:24:48.593

在 CPython 中，参数的数量是

```
a_method.func_code.co_argcount 
```

他们的名字在开头

```
a_method.func_code.co_varnames 
```

这些是 CPython 的实现细节，因此这可能不适用于 Python 的其他实现，例如 IronPython 和 Jython。

承认“传递”参数的一种可移植方法是使用签名定义您的函数`func(*args, **kwargs)`。[这在例如matplotlib](https://matplotlib.org/)中被大量使用，其中外部 API 层将大量关键字参数传递给较低级别​​的 API。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2016-11-01T15:45:21.897

Python 3 版本是：

```
def _get_args_dict(fn, args, kwargs):
    args_names = fn.__code__.co_varnames[:fn.__code__.co_argcount]
    return {**dict(zip(args_names, args)), **kwargs} 
```

该方法返回一个包含 args 和 kwargs 的字典。

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2013-05-14T11:36:45.127

在装饰器方法中，您可以通过以下方式列出原始方法的参数：

```
import inspect, itertools 

def my_decorator():

        def decorator(f):

            def wrapper(*args, **kwargs):

                # if you want arguments names as a list:
                args_name = inspect.getargspec(f)[0]
                print(args_name)

                # if you want names and values as a dictionary:
                args_dict = dict(itertools.izip(args_name, args))
                print(args_dict)

                # if you want values as a list:
                args_values = args_dict.values()
                print(args_values) 
```

如果这`**kwargs`对您很重要，那么它会有点复杂：

```
 def wrapper(*args, **kwargs):

            args_name = list(OrderedDict.fromkeys(inspect.getargspec(f)[0] + kwargs.keys()))
            args_dict = OrderedDict(list(itertools.izip(args_name, args)) + list(kwargs.iteritems()))
            args_values = args_dict.values() 
```

例子：

```
@my_decorator()
def my_function(x, y, z=3):
    pass

my_function(1, y=2, z=3, w=0)
# prints:
# ['x', 'y', 'z', 'w']
# {'y': 2, 'x': 1, 'z': 3, 'w': 0}
# [1, 2, 3, 0] 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2010-06-07T16:37:20.100

我认为您正在寻找的是本地方法-

```
 In [6]: def test(a, b):print locals()
   ...: 

In [7]: test(1,2)              
{'a': 1, 'b': 2} 
```

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2017-07-26T16:10:58.227

Python 3.5+：

> 弃用警告：inspect.getargspec() 自 Python 3.0 起已弃用，请使用 inspect.signature() 或 inspect.getfullargspec()

所以之前：

```
func_args = inspect.getargspec(function).args 
```

现在：

```
func_args = list(inspect.signature(function).parameters.keys()) 
```

去测试：

```
'arg' in list(inspect.signature(function).parameters.keys()) 
```

鉴于我们有函数“function”，它接受参数“arg”，这将评估为 True，否则为 False。

Python 控制台中的示例：

```
Python 3.6.0 (v3.6.0:41df79263a11, Dec 23 2016, 07:18:10) [MSC v.1900 32 bit (Intel)] on win32
>>> import inspect
>>> 'iterable' in list(inspect.signature(sum).parameters.keys())
True 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2008-10-21T00:02:19.207

我认为使用装饰器可以满足您的需求。

```
class LogWrappedFunction(object):
    def __init__(self, function):
        self.function = function

    def logAndCall(self, *arguments, **namedArguments):
        print "Calling %s with arguments %s and named arguments %s" %\
                      (self.function.func_name, arguments, namedArguments)
        self.function.__call__(*arguments, **namedArguments)

def logwrap(function):
    return LogWrappedFunction(function).logAndCall

@logwrap
def doSomething(spam, eggs, foo, bar):
    print "Doing something totally awesome with %s and %s." % (spam, eggs)

doSomething("beans","rice", foo="wiggity", bar="wack") 
```

运行它，它将产生以下输出：

```
C:\scripts>python decoratorExample.py
Calling doSomething with arguments ('beans', 'rice') and named arguments {'foo':
 'wiggity', 'bar': 'wack'}
Doing something totally awesome with beans and rice. 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2017-08-20T12:09:00.590

在 Python 3.+ 中，使用`Signature`手头的对象，获取参数名称到值之间的映射的一种简单方法是使用 Signature 的`bind()`方法！

例如，这是一个用于打印这样的地图的装饰器：

```
import inspect

def decorator(f):
    def wrapper(*args, **kwargs):
        bound_args = inspect.signature(f).bind(*args, **kwargs)
        bound_args.apply_defaults()
        print(dict(bound_args.arguments))

        return f(*args, **kwargs)

    return wrapper

@decorator
def foo(x, y, param_with_default="bars", **kwargs):
    pass

foo(1, 2, extra="baz")
# This will print: {'kwargs': {'extra': 'baz'}, 'param_with_default': 'bars', 'y': 2, 'x': 1} 
```

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2019-08-06T10:12:52.310

这是另一种在不使用任何模块的情况下获取函数参数的方法。

```
def get_parameters(func):
    keys = func.__code__.co_varnames[:func.__code__.co_argcount][::-1]
    sorter = {j: i for i, j in enumerate(keys[::-1])} 
    values = func.__defaults__[::-1]
    kwargs = {i: j for i, j in zip(keys, values)}
    sorted_args = tuple(
        sorted([i for i in keys if i not in kwargs], key=sorter.get)
    )
    sorted_kwargs = {
        i: kwargs[i] for i in sorted(kwargs.keys(), key=sorter.get)
    }   
    return sorted_args, sorted_kwargs

def f(a, b, c="hello", d="world"): var = a

print(get_parameters(f)) 
```

**输出：**

```
(('a', 'b'), {'c': 'hello', 'd': 'world'}) 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2019-08-21T18:29:17.310

`inspect.signature`很慢。最快的方法是

```
def f(a, b=1, *args, c, d=1, **kwargs):
   pass

f_code = f.__code__
f_code.co_varnames[:f_code.co_argcount + f_code.co_kwonlyargcount]  # ('a', 'b', 'c', 'd') 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2017-03-22T10:45:19.623

更新[布莱恩的回答](https://stackoverflow.com/questions/218616/getting-method-parameter-names-in-python/218709#218709)：

如果 Python 3 中的函数只有关键字参数，那么您需要使用`inspect.getfullargspec`：

```
def yay(a, b=10, *, c=20, d=30):
    pass
inspect.getfullargspec(yay) 
```

产生这个：

```
FullArgSpec(args=['a', 'b'], varargs=None, varkw=None, defaults=(10,), kwonlyargs=['c', 'd'], kwonlydefaults={'c': 20, 'd': 30}, annotations={}) 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-05-30T11:52:53.600

返回参数名称列表，处理部分和常规函数：

```
def get_func_args(f):
    if hasattr(f, 'args'):
        return f.args
    else:
        return list(inspect.signature(f).parameters) 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-12-11T00:56:44.273

在python 3中，下面是make `*args`and `**kwargs`into a `dict`（`OrderedDict`用于python < 3.6来维护`dict`命令）：

```
from functools import wraps

def display_param(func):
    @wraps(func)
    def wrapper(*args, **kwargs):

        param = inspect.signature(func).parameters
        all_param = {
            k: args[n] if n < len(args) else v.default
            for n, (k, v) in enumerate(param.items()) if k != 'kwargs'
        }
        all_param .update(kwargs)
        print(all_param)

        return func(**all_param)
    return wrapper 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-03-14T10:49:29.187

为了更新一点[布赖恩的回答](https://stackoverflow.com/a/218709/7262247)，现在有一个不错的反向移植`inspect.signature`，您可以在较旧的 python 版本中使用它：[`funcsigs`](https://github.com/testing-cabal/funcsigs). 所以我个人的偏好是

```
try:  # python 3.3+
    from inspect import signature
except ImportError:
    from funcsigs import signature

def aMethod(arg1, arg2):
    pass

sig = signature(aMethod)
print(sig) 
```

为了好玩，如果您对玩`Signature`对象感兴趣，甚至对动态创建具有随机签名的函数感兴趣，您可以查看我的[`makefun`](https://smarie.github.io/python-makefun/)项目。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2021-09-08T17:29:46.760

我在谷歌上搜索如何打印函数名称和为分配提供的参数我必须创建一个装饰器来打印它们，我使用了这个：

```
def print_func_name_and_args(func):

    def wrapper(*args, **kwargs):
    print(f"Function name: '{func.__name__}' supplied args: '{args}'")
    func(args[0], args[1], args[2])
    return wrapper

@print_func_name_and_args
def my_function(n1, n2, n3):
    print(n1 * n2 * n3)

my_function(1, 2, 3)

#Function name: 'my_function' supplied args: '(1, 2, 3)' 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2021-10-29T01:09:42.573

是否可以在下面的代码中使用API从 lambda func中`inspect`读取常量参数值？`-1``fun`

```
def my_func(v, axis):
  pass

fun = lambda v: my_func(v, axis=-1) 
```

* * *

## 回答 #17

> 赞同：-3
> 
> 时间：2017-01-07T21:34:51.573

`dir()`现在呢`vars()`？

似乎在做超级简单的事情……</p>

**必须从函数范围内调用。**

但要小心它会返回*所有*局部变量，因此如果需要，请务必在函数的最开始执行此操作。

另请注意，正如评论中所指出的，这不允许从范围之外完成。所以不完全是 OP 的场景，但仍然与问题标题相匹配。因此我的回答。

# ide - 为什么在 IDE 中使用等宽字体？

> ID：218623
> 
> 赞同：85
> 
> 时间：2008-10-20T14:24:03.710
> 
> 标签：ide, fonts, text-editor

我在 SO 上看到了几个字体主题，似乎大多数人使用等宽字体进行编程任务。几年来我一直在使用 Verdana 进行编程，我真的很喜欢增强的可读性，并且不会错过任何与等宽相关的内容。

为什么要使用等宽字体？

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2008-10-20T14:30:13.900

在等宽字体中：

*   等长字符串文字看起来相等。
*   更容易看到细小的标点符号，例如 : () {}
*   相似的字符看起来更不同：Il 0O vs`Il 0O`
*   您知道一行是否会在窗口 X 字符宽上换行。这意味着您的团队可以将 100 个字符行标准化，并且一行总是看起来像一行

* * *

## 回答 #2

> 赞同：107
> 
> 时间：2008-10-20T15:06:25.777

我以前从未考虑过使用比例字体进行编码。所以为了科学的利益，我只是换了我的编辑来试一试。

以下是修复几张简单票后的一些观察结果：

*   代码似乎非常密集。我的大部分代码大约有 80 列，很少超过 100 列。比例字体将其压缩到编辑器左侧的一个小条上。如果你的屏幕空间很短，也许很有用，但它似乎不必要地紧凑。
*   代码的“纹理”丢失了。很难说出我在看什么样的结构——它只是一大块文本，需要几乎逐个字符地阅读。
*   很容易错过. **_** （如果（！foo），看！）`!``if (!foo)`
*   标点符号的定义非常糟糕。许多很难区分（`{}[]()`vs {}[]()）
*   一些标点符号比其他标点符号大得多，从而推断出不打算强调的地方（`$@%`与 $@% 相比）
*   有些字符*很*窄，很难识别（`'"!;:,.`vs '"!;:,.)
*   一些数字和字母非常相似（`0Oo iIl`vs 0Oo iIl）
*   我*非常*依赖语法高亮，没有它几乎不可能做诸如确认引号是平衡的等事情。
*   对齐（除了简单的缩进）完全被破坏了。您可以通过添加额外的空格来调整它，但由于字体的比例特性，线条可能不会完全对齐 -**代码看起来更混乱**。
*   正则表达式是……有趣！

不过，也**有**一些积极的方面。诚然，我只使用了一段时间，但肯定有一些方面在使用比例字体时效果更好：

*   “单词”更容易阅读——拼写错误（例如，变量拼写错误）会突然出现。
*   我对使用更长、更具描述性的变量名感觉更好（也许是因为它们扫描得更好，也许是因为文本的水平大小被压缩了）
*   **阅读**这样的代码似乎稍微容易一些。我的大脑更容易“标记”每个单词并理解其含义。虽然因为标点符号更难阅读，但它仍然很难 - 但如果有一点时间习惯它，可能会改变

明天我会再次更新这个答案（假设我能像这样度过一整天！）

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-10-20T14:30:41.777

我喜欢排列相关的条件句，试图让它们更明显地被分组。例如：

```
if ((var1 == FOO) && ((var2 == BAR) ||
                      (var2 == FOOBAR))) 
```

可变宽度字体使这变得更加困难。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2010-07-30T22:57:55.530

我在这里一直看到的一件事是关于“排列代码”和缩进的讨论。我想指出以下几点：

*   在任何字体中，八个空格的长度始终是四个空格的两倍。
*   在任何字体中，两个选项卡的长度总是一个选项卡的两倍。
*   一行上的任何标识符在下一行上总是相同的宽度......在任何字体中！
*   当然，如果你的队友使用的是等宽空间，而你没有，它看起来会有所不同……但你应该对某些东西进行标准化——不管它是什么——如果这是真的，那么每个人看起来都是一样的。 ..任何字体！对于笑声，您还可以尝试让每个人都在等宽屏幕上，并给其中一半人提供宽屏显示器……看看情况如何。
*   如果您所做的任何事情都依赖于根据屏幕上这些字符的列位置而不是您使用的标识符的范围来排列代码，那么我认为您正在做的事情是一种黑客行为。标识符永远不应该以牺牲名称质量为代价限制在一定数量的字符上。除此之外……您还没有在代码中绘制带有星号的 ASCII 框来表示注释，是吗？

所以把所有这些画在一起，如果你在同一个地方开始每一行，并且一致的间距是相同的宽度，并且标识符不会自发地改变每行的宽度，那么你的代码实际上会排成一行！...直到有什么不同。

例如：

```
identifier.Method().Property.ToString();
identifier.Method().OtherGuy.ToString(); //how lined up and pretty!
identifier.Method().Sumthing.YouGetThePoint; 
```

*   标识符.Method().Property.ToString();
*   标识符.Method().OtherGuy.ToString(); //不好了！错位！
*   identifier.Method().Sumthing.YouGetThePoint; //...但谁在乎？它们是不同的属性！

我要承认的一点是，非字母数字字符通常不是很宽。这些包括 )(][}{,:|";',`! 和 。然而，这可以在字体编辑器中修复......只需使它们更宽。这不是非等宽固有的问题；只是没有对它的需求不是很多，所以它还没有完成。

总之，个人偏好很好，但我认为没有什么实际理由更喜欢等宽而不是非等宽。你喜欢它的外观吗？当然，做等宽。你想要更多的东西适合你的屏幕吗？去非单声道。但是人们将非等空间视为异端的方式有点夸大其词。

* * *

## 回答 #5

> 赞同：16
> 
> 时间：2008-10-20T15:07:11.113

我对这个线程感到好奇，因为等宽字体的许多论点确实可以通过一些调整轻松地反驳。所以我将我的 IDE 切换到了 Calibri（因为它有一个漂亮的圆脸，并且针对 UI 屏幕的可读性进行了优化——完美）。现在我显然必须使用制表符而不是空格来缩进（忽略所有问题），并且 4 个空格宽度显然不够，所以我切换到 10 个。

现在看起来相当不错。但是，我可以发现一些明显的问题。在我测试此设置一段时间后，以后可能会出现更多。

*   如前所述，某些字符（尤其是括号、分号）看起来太细了。我希望这是一个连续的文本，而不是源代码。我认为这将是最大的问题。
*   符号不能很好地对齐。例如，考虑以下 C# 代码：

    ```
    var expr = x => x + 1; 
    ```

    箭头 ( `=>`) 看起来像任何等宽字体中的一个单位。它看起来像其他字体中的两个相邻字符。`>>`对于诸如etc之类的运算符也是如此。

*   空间看起来很小。我大力间隔我的源代码以提高可读性。当切换到比例字体时，这毫无意义。如果我可以控制空间的宽度，这肯定会有所帮助。
*   上下文相关的缩进完全被破坏了：在某些情况下，缩进固定数量的制表符是不够的。采用可能以下列方式缩进的 LINQ 表达式：

    ```
    var r = from c in "This, apparently, is a test!"
            where !char.IsPunctuation(c)
            select char.ToUpper(c); 
    ```

    您根本无法使用比例字体来做到这一点。

总而言之，字太窄了。同样，额外的字母间距可能会有所帮助，并且在标点符号的情况下绝对是必要的。然而，我感觉所有这些使比例字体更易读的调整只会自然地模仿等宽字体。到目前为止提到的所有观点都是正确的。

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2008-10-20T14:39:58.017

我使用Comic Sans MS，它看起来非常合理，因为它的小点大小（它只是开始在标题大小上看起来“开玩笑”）。它看起来很容易，但仍然保持文本足够小，以便在文本窗口中显示合理数量的代码，同时打开几个 VS 的停靠面板。

您可以打开解决方案资源管理器面板，并且无需水平滚动即可阅读 100 列文本。此外，我可以让 DXCore Documentor 面板（显示格式化的 XMLDOC）打开得足够宽以供阅读，同时仍然能够看到足够的文本来记录 XMLdocs。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2008-10-20T16:17:37.880

只需要几个小时试图弄清楚为什么搜索没有找到某些东西，因为您的文字中有 2 个空格而不是 1 个空格，以意识到您应该使用等宽字体。我曾经在尝试修复 Lotus Notes 代理时遇到过这种情况，当时设计师没有使用等宽字体。直到我将代码粘贴到 CodeWright 中打印出来之后，问题才很明显。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2009-10-30T17:04:22.710

等宽字体使排列代码更容易。

与团队合作时尤其如此；团队中的每个人都可以使用不同的字体，只要它们都是等宽的，一切都会排成一行。同样，如果一个人使用许多不同的开发工具，那么如果它们都是等宽的，那么一切都会排成一行。如果它们不是全等宽的，你必须确保它们都使用相同的字体，如果你在两个平台上开发，那可能会很困难。

事实上，一些开发工具只支持等宽字体。

另一个原因是等宽字体往往具有更多不同的字符。比较 lIiO0`lIiO0`和 ，你就会明白我的意思了。它们还使计算空格变得更加容易。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2008-10-20T14:37:02.063

如果你在一个团队中工作，那么等距字体可以确保每个人的代码清晰且布局正确，无论他们喜欢使用哪种等距字体。

使用可变宽度字体时，您的代码可能看起来很清晰，但如果使用等宽字体用户打开它，则看起来不太可能相同。

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2008-10-20T14:30:53.010

我怀疑等宽字体是程序员的偏好，作为基于文本的 DOS 时代的遗留物。

另一方面，我自己尝试过 Verdana 和其他一些推荐的比例字体，但我无法应对这种变化。我的眼睛训练得太好了，不适合等宽。重符号的语言，例如：C/C++、C#、Perl 等，对我来说看起来太不一样了。符号的位置使代码看起来完全不同。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2008-10-20T14:36:05.667

由于代码的性质而不是常规语言，最好将其正确排列。此外，在代码编辑中，有时您希望阻止选择、阻止复制和阻止粘贴。在 Visual Studio 中，您可以在进行鼠标选择时使用 ALT 键进行块选择。在不同的编辑器中可能会有所不同，但我一直发现编辑器中的该选项在某些情况下非常重要，而且它不会很好地工作，除非您使用的是等距字体。

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2008-10-20T14:30:33.790

我个人发现等宽字体在代码编辑器中更容易阅读。当然，我几乎是瞎子。那可能会有所作为。我目前在 15 点处使用带有高对比度字母的深色背景运行 consolas 字体。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-10-20T14:30:17.270

一旦你比一层更深，使用空格进行缩进将是一个问题。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2008-10-20T14:49:48.073

主要用于对齐目的（例如当函数参数声明跨越多行并且您想要将它们对齐或对齐注释等时）。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-10-20T14:32:16.160

我认为，就像制表符的问题一样，复杂的因素是为了对齐而缩进某些东西，而其他人有不同的偏好。事情变得错位了。

# version-control - 如何在 ClearCase 查找命令中按名称排除文件？

> ID：218638
> 
> 赞同：5
> 
> 时间：2008-10-20T14:30:03.963
> 
> 标签：version-control, clearcase

使用 ClearCase 查找命令，我如何查找目录中不具有名称 pom.xml 的所有文件？

我想将其他选择选项传递给 ClearCase 查找命令，因此我不想执行另一个命令。

我正在使用 ClearCase 的 RedHat linux 版本。我试过“cleartool find！-name pom.xml -print”，但它不起作用。

PS：我不选择使用 ClearCase，它是我项目的强制要求。这是我讨厌它的原因之一。我已经多次阅读手册页，但没有明确的方法可以做到这一点！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-20T16:06:06.500

ClearCase 通配符没有反转（AFAIR），但您可以为此使用 grep -

```
cleartool ls -short -nxname | grep -v pom.xml 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-11-03T03:48:53.460

还有另一种解决方案可能对您有用。尝试

[申请任务](http://clearantlib.sourceforge.net/ccapply.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-22T07:35:12.600

您似乎忘记了cleartool find 命令的***-exec***选项。

它实际上允许您执行 cleartool 以外的其他命令，包括系统命令（如 sh 或 DOS 脚本）。

我知道您会“不希望执行另一个命令”，但是如果该其他系统脚本是 find 命令的 exec 选项的一部分……可以说它仍然是*一个*命令；）

所以创建一个简单的脚本，如：

（Unix'print.sh'）

```
#!/bin/sh
if [ $1 != $2 ] ; then
  echo $1
fi 
```

（Windows 'print.bat'）

```
@echo off
if not "%1"=="%2" echo "%1" 
```

将该脚本放在您的搜索目录中，或者将脚本路径添加到您的 %PATH% 或 $PATH 环境中。

最后，使用 find 命令（以及有关日期过滤、分支过滤等的所有[其他选项）](http://www.samecs.com/commands/cleartool%20commands/find/find.htm)

(Unix)

```
cleartool find . -nrec -type f -exec './print.sh $CLEARCASE_PN ./pom.xml' 
```

（视窗）

```
cleartool find . -nrec -type f -exec "print.bat %CLEARCASE_PN% .\pom.xml" 
```

在这里你去：“目录中没有名称 pom.xml 的所有文件”。

注意：find 命令的“-type f”选项允许您将搜索限制为仅文件名（而不是目录名）。

# c#-3.0 - win形式的ocx控制

> ID：218650
> 
> 赞同：1
> 
> 时间：2008-10-20T14:31:30.840
> 
> 标签：c#-3.0, activex

如何创建 AxHost 抽象类的实例

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T14:52:47.567

[您不能创建抽象类的实例。](http://msdn.microsoft.com/en-us/library/sf985hc5(VS.71).aspx)

*您通常不直接使用 AxHost 类。您可以使用 Windows 窗体 ActiveX 控件导入器 (Aximp.exe) 生成扩展 AxHost 的包装器。*

有关示例，请参见[http://msdn.microsoft.com/en-us/library/system.windows.forms.axhost.aspx 。](http://msdn.microsoft.com/en-us/library/system.windows.forms.axhost.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T14:58:21.003

[在托管代码中动态添加 ActiveX 控件](http://www.codeproject.com/KB/dotnet/AxForms.aspx)——可能与[如何创建在 .Net 类库中定义的类的实例而不设置引用有关](http://forums.devx.com/showthread.php?t=56748)

# performance - 对于那些使用 SubSonic 的人，您在大型应用程序中看到了什么样的性能？

> ID：218659
> 
> 赞同：3
> 
> 时间：2008-10-20T14:33:43.253
> 
> 标签：performance, data-binding, subsonic, code-generation

我在几个 POC 项目中使用过 SubSonic，但没什么大不了的。它非常易于使用，并且可以抽象出它使用活动记录模式的事实（可以将其移向更多领域驱动的方法）。

这里有没有人在更大的应用程序中使用过 SubSonic，你目睹了什么样的性能？总体而言，您的经历值得吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T16:35:56.033

我们不能害怕goog：

[http://blog.wekeroad.com/blog/subsonic-scaling/](http://blog.wekeroad.com/blog/subsonic-scaling/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T15:01:08.377

我只使用了一点 SubSonic，但是一段时间后我正在开发的应用程序开始出现性能下降，最后我们被迫开始迁移到使用特定优化的存储过程进行一些数据调用，如SubSonic 生成的自动项目不能满足需求。然而，最后一切都运作良好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-20T16:29:31.727

我使用 Subsonic 和 .NET 2.0 制作了一个电子商务网络应用程序。我会说它非常好。该应用程序不是很大（10k 行代码）。那时我做这个项目的时候有点天真，在我准备好之前就跳入了深渊，所以任何性能问题都可能取决于我，而不是软件。

虽然它是一个很好的工具。强大的支持，功能强大，节省时间等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-24T16:29:35.457

SubSonic 是一种工具，您必须明智地使用它。当你有一个大型应用程序时，你已经放入了缓存，如果你使用它们，你必须确保关闭 IDataReader。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-08T17:20:00.173

我在我的一些项目中使用了 SubSonic，并且认为 SubSonic 的扩展性非常好。像大多数技术一样，SubSonic 可以用于善或恶......例如，假设您在页面上有一些表格，其中包含无数列和大量行。您可以编写一个存储过程来获取数据（SubSonic 围绕所有存储过程创建包装器），您可以在数据库中创建一个视图，以便如果您的数据库很智能，它可以优化视图性能（SubSonic 为每个您的视图和表格）。

假设您使用视图并且不想要任何对象集合的开销，使用 Subsonic 您可以为您的视图获取 IDataReader（如果这对您来说不够快，我不知道是什么） .

另一方面，假设在同一个应用程序中，您还有 5 个左右的表，其中只有 3-4 列和 10 个左右的行用于管理和配置。您现在可以使用其中一个 SubSonics 漂亮的控件（即 Scaffold 控件），只需将其拖放到页面上，即可为表格创建一个具有内置编辑/添加/删除/排序功能的 GridView。

SubSonic 内置了很多节省时间的功能，当您想按照自己的方式进行操作时（不时我们都会说我的方式或高级方式！），SubSonic 将允许您按照自己的方式进行操作。

# ms-access - 赶上粘贴事件？

> ID：218663
> 
> 赞同：3
> 
> 时间：2008-10-20T14:34:49.523
> 
> 标签：ms-access, event-handling, vba

我为一家定制橱柜制造商工作，我们为我们的产品编写了自己的定价程序。我有一个带有弹出框的表单，因此用户可以选择铰链将在哪一侧用于该柜子上的模棱两可的门。到目前为止，我已经完成了这项工作，但是当他们复制一个项目并将其粘贴到底部时，我不希望弹出框出现。Access VBA中有什么方法可以知道是粘贴还是手动输入新记录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-20T15:16:20.377

也许这样的东西会适合。

```
Option Compare Database
Public gvarPasted As Boolean

Private Sub txtText_AfterUpdate()
If Not gvarPasted Then
    'Open pop-up here
Else
    gvarPasted = False
End If
End Sub

Private Sub txtText_KeyDown(KeyCode As Integer, Shift As Integer)
'Detect ctrl-V combination
If Shift = acCtrlMask And KeyCode = vbKeyV Then
    gvarPasted = True
End If
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T16:01:47.757

您可以自定义菜单，例如，如果您将这样的代码添加到标准模块：

```
Public gvarPasted As Boolean

Function AssignVar()
    gvarPasted = True
    DoCmd.RunCommand acCmdPaste
End Function 
```

您可以使用工具栏菜单的自定义选项将菜单上粘贴的 Action 属性设置为此功能。您还需要创建自己的快捷菜单（右键菜单）来代替内置菜单。快捷菜单既可以分配给所有表格，也可以只分配给需要它的表格。也可以关闭所有表单的快捷菜单。

# c# - 我可以测试正则表达式在 C# 中是否有效而不抛出异常吗

> ID：218680
> 
> 赞同：59
> 
> 时间：2008-10-20T14:41:46.060
> 
> 标签：c#, regex

我允许用户输入正则表达式来匹配 IP 地址，以便在相关系统中进行 IP 过滤。我想验证输入的正则表达式是否有效，因为很多用户会搞砸操作，尽管是出于好意。

我当然可以在 try/catch 中执行 Regex.IsMatch() ，看看它是否会以这种方式爆炸，但是有没有更聪明的方法呢？速度本身不是问题，我只是更喜欢避免无缘无故抛出异常。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-11-21T09:22:57.537

我认为在这种情况下例外是可以的。

只要确保短路并消除您可以的异常：

```
private static bool IsValidRegex(string pattern)
{
    if (string.IsNullOrWhiteSpace(pattern)) return false;

    try
    {
        Regex.Match("", pattern);
    }
    catch (ArgumentException)
    {
        return false;
    }

    return true;
} 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-10-20T14:51:17.760

只要您捕获到非常具体的异常，只需执行 try/catch。

如果使用得当，异常并不邪恶。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-20T14:53:58.283

不是没有很多工作。正则表达式解析可能非常复杂，并且框架中没有任何公开的内容来验证表达式。

`System.Text.RegularExpressions.RegexNode.ScanRegex()`看起来是负责解析表达式的主要函数，但它是内部的（并且无论如何都会抛出任何无效语法的异常）。因此，您需要重新实现解析功能——这无疑会在边缘情况或框架更新时失败。

我认为在这种情况下捕获 ArgumentException 是一个好主意。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-01-30T07:39:27.520

我曾经使用过以下功能，对此没有任何问题。它同时使用异常和超时，但它是功能性的。当然，它适用于 .Net Framework >= 4.5。

```
 public static bool IsValidRegexPattern(string pattern, string testText = "", int maxSecondTimeOut = 20)
    {
        if (string.IsNullOrEmpty(pattern)) return false;
        Regex re = new Regex(pattern, RegexOptions.None, new TimeSpan(0, 0, maxSecondTimeOut));
        try { re.IsMatch(testText); }
        catch{ return false; } //ArgumentException or RegexMatchTimeoutException
        return true;
    } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-20T14:52:01.797

格式错误的正则表达式并不是异常的最坏原因。

除非您接受*非常*有限的正则表达式语法子集-然后为此编写正则表达式（或解析器）-我认为您没有其他方法可以测试它是否有效，只能尝试从中构建状态机并制作它匹配的东西。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-20T20:25:43.090

根据目标是谁，我会非常小心。构建可以自行回溯并占用大量 CPU 和内存的正则表达式并不难——它们可以成为有效的拒绝服务向量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-20T14:56:18.170

在 .NET 中，除非您编写自己的正则表达式解析器（我强烈建议不要这样做），否则您几乎可以肯定需要使用 try/catch 来包装新 Regex 对象的创建。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2013-11-22T08:12:23.517

通过使用以下方法，您可以检查您的正则表达式是否有效。这里 testPattern 是你必须检查的模式。

```
public static bool VerifyRegEx(string testPattern)
{
    bool isValid = true;
    if ((testPattern != null) && (testPattern.Trim().Length > 0))
    {
        try
        {
            Regex.Match("", testPattern);
        }
        catch (ArgumentException)
        {
            // BAD PATTERN: Syntax error
            isValid = false;
        }
    }
    else
    {
        //BAD PATTERN: Pattern is null or blank
        isValid = false;
    }
    return (isValid);
} 
```

# .net - 在 .Net 中打开 XPS 文档会导致内存泄漏

> ID：218681
> 
> 赞同：6
> 
> 时间：2008-10-20T14:42:12.583
> 
> 标签：.net, memory, memory-leaks, xps

以下代码片段说明了打开 XPS 文件时的内存泄漏。如果你运行它并观察任务管理器，它会增长并且在应用程序退出之前不会释放内存。

'****** 控制台应用程序开始。

```
Module Main

    Const DefaultTestFilePath As String = "D:\Test.xps"
    Const DefaultLoopRuns As Integer = 1000

    Public Sub Main(ByVal Args As String())
        Dim PathToTestXps As String = DefaultTestFilePath
        Dim NumberOfLoops As Integer = DefaultLoopRuns

        If (Args.Count >= 1) Then PathToTestXps = Args(0)
        If (Args.Count >= 2) Then NumberOfLoops = CInt(Args(1))

        Console.Clear()
        Console.WriteLine("Start - {0}", GC.GetTotalMemory(True))
        For LoopCount As Integer = 1 To NumberOfLoops

            Console.CursorLeft = 0
            Console.Write("Loop {0:d5}", LoopCount)

            ' The more complex the XPS document and the more loops, the more memory is lost.
            Using XPSItem As New Windows.Xps.Packaging.XpsDocument(PathToTestXps, System.IO.FileAccess.Read)
                Dim FixedDocSequence As Windows.Documents.FixedDocumentSequence

                ' This line leaks a chunk of memory each time, when commented out it does not.
                FixedDocSequence = XPSItem.GetFixedDocumentSequence
            End Using
        Next
        Console.WriteLine()
        GC.Collect() ' This line has no effect, I think the memory that has leaked is unmanaged (C++ XPS internals).
        Console.WriteLine("Complete - {0}", GC.GetTotalMemory(True))

        Console.WriteLine("Loop complete but memory not released, will release when app exits (press a key to exit).")
        Console.ReadKey()

    End Sub

End Module 
```

'****** 控制台应用程序结束。

它循环一千次的原因是因为我的代码处理了大量文件并快速泄漏内存，从而导致 OutOfMemoryException。强制垃圾收集不起作用（我怀疑它是 XPS 内部的一块非托管内存）。

该代码最初位于另一个线程和类中，但已简化为此。

非常感谢任何帮助。

瑞安

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-20T17:03:08.053

嗯，我找到了。这是框架中的一个错误，要解决它，您需要添加对 UpdateLayout 的调用。可以将 using 语句更改为以下内容以提供修复；

```
 Using XPSItem As New Windows.Xps.Packaging.XpsDocument(PathToTestXps, System.IO.FileAccess.Read)
            Dim FixedDocSequence As Windows.Documents.FixedDocumentSequence
            Dim DocPager As Windows.Documents.DocumentPaginator

            FixedDocSequence = XPSItem.GetFixedDocumentSequence
            DocPager = FixedDocSequence.DocumentPaginator
            DocPager.ComputePageCount()

            ' This is the fix, each page must be laid out otherwise resources are never released.'
            For PageIndex As Integer = 0 To DocPager.PageCount - 1
                DirectCast(DocPager.GetPage(PageIndex).Visual, Windows.Documents.FixedPage).UpdateLayout()
            Next
            FixedDocSequence = Nothing
        End Using 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-03-09T16:23:39.477

今天碰到这个。有趣的是，当我使用 Reflector.NET 观察事物时，我发现修复涉及在与当前 Dispatcher 关联的 ContextLayoutManager 上调用 UpdateLayout()。（阅读：无需遍历页面）。

基本上，要调用的代码（这里使用反射）是：

```
ContextLayoutManager.From(Dispatcher.CurrentDispatcher).UpdateLayout(); 
```

绝对感觉像是 MS 的一个小疏忽。

对于懒惰或不熟悉的人，此代码有效：

```
Assembly presentationCoreAssembly = Assembly.GetAssembly(typeof (System.Windows.UIElement));
Type contextLayoutManagerType = presentationCoreAssembly.GetType("System.Windows.ContextLayoutManager");
object contextLayoutManager = contextLayoutManagerType.InvokeMember("From",
BindingFlags.InvokeMethod | BindingFlags.Static | BindingFlags.NonPublic, null, null, new[] {dispatcher});
contextLayoutManagerType.InvokeMember("UpdateLayout", BindingFlags.InvokeMethod | BindingFlags.NonPublic | BindingFlags.Instance, null, contextLayoutManager, null); 
```

FxCop 会抱怨，但可能会在下一个框架版本中修复。如果您不想使用反射，作者发布的代码似乎“更安全”。

！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T15:14:19.583

我不能给你任何权威的建议，但我确实有几个想法：

*   如果你想在循环内观察你的内存，你也需要在循环内收集内存。否则，您*似乎*会故意泄漏内存，因为减少收集较大块的频率（根据需要）而不是不断收集少量块更有效。在这种情况下，创建 using 语句的范围块*应该*足够了，但是您对 GC.Collect 的使用表明可能正在发生其他事情。
*   甚至 GC.Collect 也只是一个建议（好吧，非常*强烈*的建议，但仍然是一个建议）：它不能保证收集所有未完成的内存。
*   如果内部 XPS 代码确实在泄漏内存，那么强制操作系统收集它的唯一方法是欺骗操作系统认为应用程序已经结束。为此，您也许可以创建一个虚拟应用程序来处理您的 xps 代码并从主应用程序调用，或者将 xps 代码移动到您的主代码内它自己的 AppDomain 中也可能就足够了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-08T02:59:59.520

添加 UpdateLayout 无法解决问题。根据[http://support.microsoft.com/kb/942443](http://support.microsoft.com/kb/942443)，需要“在主应用程序域中预加载 PresentationCore.dll 文件或 PresentationFramework.dll 文件”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-18T05:39:30.567

有趣的。.net framework 4.0 中仍然存在该问题。我的代码泄漏得很厉害。

建议的修复——在创建 FixedDocumentSequence 后立即在循环中调用 UpdateLayout 并没有为我解决 400 页测试文档上的问题。

但是，以下解决方案确实为我解决了这个问题。与之前的修复一样，我将调用 GetFixedDocumentSequence() 移到了 for-each-page 循环之外。“使用”子句......公平的警告，我仍然不确定它是否正确。但这并不痛苦。该文档随后被重新用于在屏幕上生成页面预览。所以好像不疼。

```
DocumentPaginator paginator 
     =  document.GetFixedDocumentSequence().DocumentPaginator;
int numberOfPages = paginator.ComputePageCount();

for (int i = 0; i < NumberOfPages; ++i)
{
    DocumentPage docPage = paginator.GetPage(nPage);
    using (docPage)   // using is *probably* correct.
    {
        //  VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV

        ((FixedPage)(docPage.Visual)).UpdateLayout();

        //  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        //  Adding THAT line cured my leak.

        RenderTargetBitmap bitmap = GetXpsPageAsBitmap(docPage, dpi);

        .... etc...
    }

} 
```

实际上，修复行位于我的 GetXpsPageAsBitmap 例程中（为清楚起见省略了），这与之前发布的代码几乎相同。

感谢所有做出贡献的人。

# .net - 是否有任何适用于 Windows Mobile 的控件库支持 iPhone 风格的触摸屏行为？

> ID：218686
> 
> 赞同：4
> 
> 时间：2008-10-20T14:43:50.240
> 
> 标签：.net, windows-mobile, compact-framework

iPhone 使用触摸屏实现放大、缩小和滚动等功能的方式非常酷，我想知道是否有任何适用于 Windows Mobile 的东西可以提供类似的用户体验。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-20T15:48:49.203

放大/缩小是多点触控硬件的产物。Pocket PC 使用电阻式触摸面板，它只提供一个接触点（触摸 2 个位置是两个点的平均值，而不是两个点），因此 WinMo 硬件根本不支持它。我见过一个模仿这种行为的黑客，但它只是 - 一个黑客，它比有用更令人沮丧。

另一个大问题是 CE 和 WinMo 没有鼠标同时位于两个位置的概念，这使得像多点触控这样的东西需要上层翻译器来处理硬件并将消息发送到监听的应用程序对于这些双倍积分。这当然是可能的，但它在今天的任何 WinMo 设备中都依赖于 OEM。

滚动和手势并不是什么新鲜事，所以肯定有几个第三方参与其中。我手头没有任何链接，但我肯定见过使用类似外观和感觉的应用程序。通常，它将在 List、ListView 或 Grid 类型的控件中实现，这些控件挂钩鼠标消息并将它们转换为底层控件的手势。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T15:52:55.917

在 v.6.1 之前，Windows Mobile 已创建用于与管心针一起使用。所有设计为类似于 iphone 的 UI 只是放在 WM（在 Windows 上运行的基本应用程序）之上的一个软件层，结果通常很慢而且有问题，尽管有些人确实努力隐藏 Microsoft 的非天才 UI设计师的作品。（HTC 用它的 Diamond 做了一个漂亮的尝试，它可能是我在 Windows Mobile 上看到的最好的 UI）。到今天为止，没有任何 dll 可以让您像 Apple 使用其 SDK 那样处理触摸屏。您会找到模拟多点触控的技巧，但这不会让您走得太远。

手指导航将是 Windows Mobile 7 的最大功能（操作系统核心的很大一部分正在改变），希望微软的 SDK 能让我们像苹果一样使用触摸屏功能。

请记住，Windows Mobile 必须在不同类型的硬件（诺基亚、HTC 等）上运行，并且通常很难拥有优化的通用操作系统。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-20T16:00:27.963

它不是一个控件库，但[PointUI](http://www.pointui.com/ "PointUI")是一个试图为 Windows Mobile 设备带来更像 iPhone 的界面的项目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-19T04:13:43.440

CTacke 的回答一针见血。多点触控需要硬件支持。有一家名为 Stantum 的公司已经在电阻屏上实现了多点触控。他们有可用的 Windows Mobile 驱动程序和跨操作系统的用于屏幕技术的一致 API。然而，要使用该技术，手机制造商将不得不从该公司购买屏幕技术和驱动程序。您可以在此处观看该技术的视频：http: [//www.stantum.com/spip.php?page= video](http://www.stantum.com/spip.php?page=video)

迄今为止，我知道没有实施该技术的 Windows Mobile 手机。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T14:45:04.930

据我所知，Apple 为这些手势申请了专利。所以那里“不应该”有任何合法的东西。

例如见[这里](http://www.wired.com/gadgets/miscellaneous/news/2008/02/multitouch_patents)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-30T23:54:55.810

[在http://www.resco.net/developer/mobileformstoolkit/overview.aspx](http://www.resco.net/developer/mobileformstoolkit/overview.aspx)查看 Resco Mobile Forms Toolkit

您可以找到以非常吸引人的方式处理图片的控件，以及启用触摸滚动的控件。

# apache-flex - 交换主 Flex 应用程序

> ID：218691
> 
> 赞同：3
> 
> 时间：2008-10-20T14:45:44.027
> 
> 标签：apache-flex

有没有办法将 Flex 的主应用程序临时交换到另一个然后切换回来。场景：主应用程序启动，显示登录框 - 然后继续主应用程序。登录框也是一个应用程序。

Application.application 是只读属性，该尝试失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-21T13:51:53.493

我在一个模块化应用程序上取得了巨大的成功，其中主应用程序基本上由一个模块加载器组成，它最初加载一个登录模块。

一旦登录模块完成了它的工作（在我的例子中是经过验证的输入，称为登录服务并检索了一个令牌），它就会调度一个包含主应用程序所需详细信息的事件（想象中称为“LogonEvent”）。我应该指出，登录模块本身只是完成所有实际工作的登录组件的包装器（因此登录组件可以在模块或 ViewStack 等中使用）。拥有一个 LogonEvent 会让一切变得不同。

包装应用程序通过卸载登录模块、加载包含应用程序核心的主模块来处理登录事件，然后在加载的模块上设置所需的登录详细信息。

注销按钮位于包装应用程序中，以便它可以卸载主模块并重新加载登录模块以再次登录。

这种布局的好处是相对较小的登录模块加载速度非常快。并且在用户登录时，主模块已经被预加载，因此登录后通常无需等待主模块加载。如果你有一个大型的单体应用程序，那么初始加载时间可能会很慢。

一些可能有帮助的代码......

```
private var mainModuleLogOnEventDispatcher:*;

[Bindable]
private var _logOnDetails:LogOnDetails = new LogOnDetails();

private function onCreationComplete(event:Event):void
{
    // Load log on module.
    loadMainModule("LogOnModule.swf");

    // Pre-load main module while user is logging on.
    var mm:IModuleInfo = ModuleManager.getModule("MainModule.swf");
    mm.load();
}

[Bindable]
private function set logOnDetails(value:LogOnDetails):void
{
    _logOnDetails = value;
}

private function get logOnDetails():LogOnDetails
{
    return _logOnDetails;
}           

private function loadMainModule(moduleName:String):void
{
    // Unload anything already loaded.
    if (mainModule.url.length > 0)
    {
        mainModule.unloadModule();
        mainModule.url = "";
    }
    mainModule.addEventListener(ModuleEvent.READY, handleMainModuleReadyEvent);
    mainModule.url = moduleName;
}

private function handleMainModuleReadyEvent(event:ModuleEvent):void
{
    // Remove listener, we've caught the event now.
    mainModule.removeEventListener(ModuleEvent.READY, handleMainModuleReadyEvent);

    // Add listeners to other events or apply data.
    if (mainModule.url == "LogOnModule.swf")
    {
        mainModuleLogOnEventDispatcher = mainModule.child;
        if (mainModule.child != null) {
            mainModuleLogOnEventDispatcher.addEventListener("logOnEvent", handleLogOnEvent);
        }
    }
    if (mainModule.url == "MainModule.swf")
    {
        var mm:* = mainModule.child;
        if (mainModule.child != null)
        {
            mm.logOnDetails = logOnDetails;
        }
    }                                           
}

private function handleLogOnEvent(logOnEvent:LogOnEvent):void
{
    mainModuleLogOnEventDispatcher.removeEventListener("logOnEvent", handleLogOnEvent);

    logOnDetails = logOnEvent.logOnDetails;

    // Now get person's details and swap in main module if successful.
    var parameters:Object = new Object();
    parameters.cmd = "viewPerson";
    parameters.token = logOnDetails.logOnToken;
    viewPersonRequest.send(parameters);
}

private function handleViewPersonRequestResult(event:ResultEvent):void
{

    //*** Loads of setting logonDetails and error handling removed!!! ***//
    loadMainModule("MainModule.swf");
    currentState = "LoggedOn";
    return;
}

private function onLogOff(event:MouseEvent):void
{
    // Make sure we don't auto-logon when we log off.
    var logOnPrefs:SharedObject = SharedObject.getLocal("LogOn", "/");
    logOnPrefs.data.loggedOff = true;

    var parameters:Object = new Object();
    parameters.cmd = "logoff";
    parameters.token = logOnDetails.logOnToken;
    logoffRequest.send(parameters);
    loadMainModule("LogOnModule.swf");
    currentState = "";
}

<!-- *** Loads of view state related mxml removed *** -->
<mx:VBox width="100%" height="100%" horizontalAlign="center" verticalAlign="middle" id="mainModuleVBox">
    <basic:IJModuleLoader id="mainModule" url="" width="100%" height="100%" horizontalAlign="center" verticalAlign="middle"/>
</mx:VBox> 
```

我还应该注意，这个包装应用程序实际上并不是一个应用程序！这实际上是一个模块本身，由 Flex 或 AIR 应用程序加载。这样我就可以拥有独立的 Flex 和 AIR 项目，它们引用一个核心库项目，该项目包含应用程序模块、登录模块、主（登录后）模块以及应用程序使用的基本上所有其他组件和类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T18:34:13.613

您是否有理由不能将登录框设为组件，然后可能使用 ViewStack 来控制可查看的组件？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T19:37:24.310

这很有趣，这正是我试图找出目前最好的方法。我曾想过使用 ViewStack，但由于我已经使用了很多其他嵌套的 ViewStack，所以我也在研究 State 标记。如果有人知道“正确的事情”，我也会很感兴趣！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-21T03:46:18.740

我已经在 Application 组件上将其实现为 ViewStack；似乎工作正常。使用 ViewStack 上的 selectedIndex 或 selectedChild 属性来控制是否显示登录或应用程序 UI。

```
<mx:Application>
  <mx:ViewStack>
    <mx:Box> <!-- or whatever for login-->
    </mx:Box>
    <mx:Box> <!-- application UI widgets here -->
    </mx:Box>
  </mx:ViewStack>
</mx:Application> 
```

# vba - 在 VBA 中克隆对象？

> ID：218696
> 
> 赞同：12
> 
> 时间：2008-10-20T14:47:31.493
> 
> 标签：vba, clone

有没有一种通用的方法来克隆 VBA 中的对象？这样我就可以将 x 复制到 y 而不是仅复制指针？

```
 Dim x As New Class1
  Dim y As Class1

  x.Color = 1
  x.Height = 1

  Set y = x
  y.Color = 2

  Debug.Print "x.Color=" & x.Color & ", x.Height=" & x.Height 
```

通过泛型，我的意思是`Set y = CloneObject(x)`不必为类创建自己的方法来逐一复制其属性。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-20T21:42:35.760

好的，这是说明它的开始：

创建一个类，叫它，哦，“Class1”：

```
Option Explicit

Public prop1 As Long
Private DontCloneThis As Variant

Public Property Get PrivateThing()
    PrivateThing = DontCloneThis
End Property

Public Property Let PrivateThing(value)
    DontCloneThis = value
End Property 
```

现在我们需要给它一个克隆功能。在另一个模块中，试试这个：

选项显式

```
Public Sub makeCloneable()

Dim idx As Long
Dim line As String
Dim words As Variant
Dim cloneproc As String

' start building the text of our new function
    cloneproc = "Public Function Clone() As Class1" & vbCrLf
    cloneproc = cloneproc & "Set Clone = New Class1" & vbCrLf

    ' get the code for the class and start examining it    
    With ThisWorkbook.VBProject.VBComponents("Class1").CodeModule

        For idx = 1 To .CountOfLines

            line = Trim(.lines(idx, 1)) ' get the next line
            If Len(line) > 0 Then
                line = Replace(line, "(", " ") ' to make words clearly delimited by spaces
                words = Split(line, " ") ' so we get split on a space
                If words(0) = "Public" Then ' can't set things declared Private
                    ' several combinations of words possible
                    If words(1) = "Property" And words(2) = "Get" Then
                        cloneproc = cloneproc & "Clone." & words(3) & "=" & words(3) & vbCrLf
                    ElseIf words(1) = "Property" And words(2) = "Set" Then
                        cloneproc = cloneproc & "Set Clone." & words(3) & "=" & words(3) & vbCrLf
                    ElseIf words(1) <> "Sub" And words(1) <> "Function" And words(1) <> "Property" Then
                        cloneproc = cloneproc & "Clone." & words(1) & "=" & words(1) & vbCrLf
                    End If
                End If
            End If
        Next

        cloneproc = cloneproc & "End Function"

        ' put the code into the class
        .AddFromString cloneproc

    End With

End Sub 
```

运行它，并将以下内容添加到 Class1

```
Public Function Clone() As Class1
Set Clone = New Class1
Clone.prop1 = prop1
Clone.PrivateThing = PrivateThing
End Function 
```

...这看起来像一个开始。我会清理很多东西（并且可能会 - 这很有趣）。一个很好的正则表达式，用于查找 gettable/lettable/settable 属性，重构为几个小函数，删除旧“克隆”函数的代码（并将新函数放在最后），有点 Stringbuilder-ish to DRY (Don' t 重复你自己）向上串联，诸如此类。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-01-27T12:43:06.593

Scott Whitlock在另一个问题上发布了一个[很棒的答案。](https://stackoverflow.com/questions/4805475/assignment-of-objects-in-vb6/4805812#4805812)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-20T16:49:09.220

我不认为有任何内置的东西，虽然它会很好。

我认为至少应该有一种方法可以使用 VBA 编辑器自动创建克隆方法。等我让孩子们上床睡觉后，我会看看能不能看看...

# javascript - 您选择的跨浏览器 javascript GUI

> ID：218699
> 
> 赞同：43
> 
> 时间：2008-10-20T14:48:12.350
> 
> 标签：javascript, user-interface, frameworks, cross-browser, widget

**更新**- 可在此处找到截至 2015 年 2 月更新的全面比较：

# [Ext JS 的替代品](https://stackoverflow.com/questions/200284/what-are-alternatives-to-extjs/2144878#2144878)

* * *

*2008年问题*：

有许多很棒的和不太好的 Javascript GUI 框架。我看过一些（只是表面上）。我对他们中的任何一个都想不通

**滚动到此问题的末尾，看看其他人怎么说**

*   [Ext.js](http://www.sencha.com/)是许多人的明显选择，因为它是最知名的框架之一。
    *优点：*看起来[很棒](http://extjs.com/products/extjs/)，社区很大，有很多扩展/插件，GPL'ed
    *缺点：*无法使用具有商业许可的第三方扩展（其中一些扩展具有杀手级功能）

*   [Backbase](http://backbase.com/)相对鲜为人知。XML 和 Javascript 的奇妙组合，让人联想到 XUL。但是，它已经是跨浏览器的
    *优点：*看起来[不错](http://demo.backbase.com/explorer/index.html#%7Cexamples/welcome.xml)，非常可扩展，可以轻松集成[一些非常简洁的东西](http://bdn.backbase.com/blog/rus/advanced-3d-animations-and-transitions)
    *缺点：*定价过高且受 CPU 限制（尽管最多可在 2 个 CPU 上免费使用），论坛响应缓慢（虽然商业支持据说很快）

*   [qooxdoo](http://qooxdoo.org/)也很受欢迎。
    *优点：* *请填写*
    *缺点：*代码略杂（根据道听途说）

*   [YUI](http://developer.yahoo.com/yui) *填写描述*
    *优点：*组织良好的代码 *缺点：* *许多小部件仍处于测试阶段*

*   [Dojo](http://dojotoolkit.org/) *填写描述*
    *优点：*类的增量加载
    *缺点：*可能会觉得臃肿

*   [jQuery UI](http://ui.jquery.com/)
    *优点：*小部件不相互依赖
    *缺点：*在早期开发阶段，小部件很少
    *可能被更广泛接受的趋势：* jQuery 与 ASP.NET MVC 一起发布

* * *

你说什么？你用什么，为什么？您更愿意使用什么，为什么？在任何类型的项目中

* * *

要更新您的输入...

> 请参阅 Sergey Ilinsky 的这篇[精彩评论](https://stackoverflow.com/questions/218699/your-choice-of-cross-browser-javascript-gui#218764)，它很好地解释了当您只想拉动您的页面时应该选择哪个框架，构建一个具有丰富前端的应用程序（有多种选择，不少于）
> 
> 另一个线程中的一个有趣评论比较了 jQuery、Dojo、Prototype、Mootools、[Sproutcore](http://www.sproutcore.com/)和[Cappuccino](http://cappuccino.org/) *（问题已删除）*。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-10-20T15:10:58.110

在考虑使用 JavaScript 库/框架时，您应该首先定义您的目标。我曾经将所有 JavaScript 库/框架按用途和架构分为三类：

1.  我想用一些非常“酷”的功能来**修饰我的页面。**去*JavaScript 库*。

    *   jQuery
    *   ZenoUI
    *   旧：原型，Mootools
2.  我想**构建一个**具有丰富前端的应用程序。我喜欢用 JavaScript 定义 UI，我不介意使用这些库的自定义 API 来编写我的应用程序逻辑。去 JavaScript *post-library/pre-framework*。

    *   [extjs](/questions/tagged/extjs "显示标记为“extjs”的问题")
    *   [剑道](/questions/tagged/kendo "显示标记为“剑道”的问题")
    *   DHTMLX
    *   道场
    *   小唯
    *   酷狗
    *   jQuery 用户界面
    *   [Bindows](http://www.bindows.net/) - 生成 Windows 的精确外观
    *   Spry（原始，遭受严重的内存泄漏）
3.  我想**构建一个**具有丰富前端的应用程序。我喜欢在 XML 中定义 UI，我想针对标准 API 编写我的应用程序逻辑，并利用其他面向开发人员的基于标准的技术。去*JavaScript 框架*。

    *   [芽核](http://sproutcore.com/about/)
    *   后台
    *   丰富的 SDK

### 有关更详细的比较，请参阅[ExtJS 的替代方案](https://stackoverflow.com/a/2144878/1269037)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-01T21:28:56.457

相反，我发现 qooxdoo 的语法和代码组织非常清晰。它很像swing 或gtk。我也尝试过 Dojo，但没有多大成功。我对 RIA 的第一选择是 qooxdoo。它内容丰富、对编码人员友好、免费且有据可查。

我对任何其他（基于浏览器的）JavaScript 工作的选择是 jQuery。尽管其他库（原型、mochikit 等）都很有用，但 jQuery 现在是炒作。拥有一个活跃的（和大的）社区很重要。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-20T14:50:52.377

StackOverflow 上的很多人都使用 jQuery，所以答案可能会偏向那个方向。此外，jQuery 将与 ASP.Net MVC 一起提供，使其成为使用 Microsoft 平台的开发人员的自然选择。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-20T15:26:40.090

YUI 代码组织良好，注释良好且易于阅读。与大多数这些项目一样，人们往往会觉得从事这些项目的工程师手头有太多时间。

在一个大项目中，简单、易读、扁平且易于适应的代码比 gee whizbang 小部件强大得多。我可以根据需要为自己找出糖果。调试 JS 已经够难了，无需费力地编写大量聪明的代码。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-20T14:56:27.297

我认为可以肯定地说 jQuery 已经成为最近最流行的 javascript 框架（查看[jQuery '08 演示文稿](http://www.slideshare.net/jeresig/state-of-jquery-08-presentation/)的第 4 张幻灯片）。

我的公司使用我喜欢的[mootools](http://mootools.net/)，它看起来与原型和 jQuery（我没有使用过）非常相似，UI 元素也很整洁。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-20T20:29:06.703

Dojo 的优点是 IMO 如下： 1\. 提供简单的 DOM 查询功能，例如 jQuery，例如：

[dojo.query(".disableAble").style("backgroundColor","gray");](http://dojotoolkit.org/book/dojo-book-0-9/part-3-programmatic-dijit-and-dojo/selecting-dom-nodes-dojo-query/things-make-and)

2.  [拥有真正智能的加载器，它可以一次拉入所有类，增量式或您自己选择。还与您选择菜单并压缩、内联等的构建系统相关联。](http://tagneto.blogspot.com/2008/10/dojo-12-loader-and-build-system.html)

3.  在我看来，最重要的是；[一个完整的客户端分层小部件系统，非常易于扩展，](http://dojotoolkit.org/book/dojo-book-0-9/part-3-programmatic-dijit-and-dojo/manipulating-widgets-through-code/writing-your)支持 DTL 客户端模板。强制您模块化您的代码，并利用 Dojo 自己的构建和加载系统来定制小部件。

4.  人们为 Dojo 编写的几乎所有内容都成为“官方”构建的一部分，位于 dojox（实验）文件夹下。许多其他工具包具有相同小部件的许多变体，使得用户很难选择正确的一个。

干杯，PS [http://unclescript.blogspot.com](http://unclescript.blogspot.com)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-02-01T08:49:12.960

Dojo CON，恕我直言，文档的状态令人震惊。大多数已过时，通常会告诉您功能已被纠正后无法使用，或者无法提醒您功能无法使用。

我不得不在现实世界的项目中使用它，在飞行中学习，这确实是一场噩梦。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-01T16:43:01.263

[Rialto](http://rialto.improve-technologies.com) (Rich Internet Application Toolkit) 是基于 ajax 的跨浏览器 javascript 小部件库。因为它与技术无关，所以它可以封装在 JSP、JSF、.Net、Python 或 PHP 图形组件中。Rialto 的目的是让企业开发人员更容易获得丰富的互联网应用程序开发。理想情况下，Rialto 开发人员不需要编写或理解 DHTML、Ajax 或 DOM 代码。

Rialto 的目标是企业网络应用程序，而不是互联网网站。

# python - 什么是 Python 或 Perl 中好的开源 pastebin？

> ID：218717
> 
> 赞同：9
> 
> 时间：2008-10-20T14:54:02.357
> 
> 标签：python, perl, open-source, pastebin

我正在寻找一个用 Python 或 Perl 编写的开源 pastebin Web 应用程序。我需要它来实现一个基于 Web 的专业编辑器以满足我自己的需要，并且我想从 pastebin 中借用代码/想法，因为我在 Web 编程方面没有太多经验。

你能指出一个（或几个）吗？

提前致谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-20T15:12:30.850

我喜欢[pastebot](http://sourceforge.net/projects/pastebot/)，它为[http://paste.pocoo.org/](http://paste.pocoo.org/)提供动力（例如）。它是 Perl 并使用 POE。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-20T15:41:29.623

[Lodgeit](http://dev.pocoo.org/projects/lodgeit/)是用 Python 编写的，是一个不错的 pastebin

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-20T18:30:44.633

[Stickum是使用 TurboGears 编写的，由于使用了](http://code.google.com/p/stickum/)[Pygments](http://pygments.org/)，它支持大量语言的语法高亮显示。你可以在[Fedora Pastebin](http://fpaste.org/)上看到它的运行情况。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-22T23:16:43.790

[http://dpaste.com/](http://dpaste.com/)是用 Python 和 Django 编写的。来自[http://dpaste.com/about/](http://dpaste.com/about/)：

> 这个网站开始作为一个练习。Django 编码人员没有用 Django 编写的 pastebin 应用程序似乎很愚蠢，因为编写 pastebin 应用程序的复杂性仅比“Hello, World”高出几步。最初它都是[通用视图](http://www.djangoproject.com/documentation/generic_views/)——换句话说，它是一些配置信息加上几个模板——效果很好，但是随着我添加了一些功能，需要一些实际的编程。该站点的“纯通用”版本的源代码仍然可以[在此处](http://dpaste.com/static/pastebin.tgz)获得。在某个时候，我可能会发布最新的源代码，但这取决于是否有时间在我的列表中进行清理和增强。

《[Python Web Development with Django](http://withdjango.com/) 》一书（由dpaste 的创建者[Paul Bissex](http://e-scribe.com/)合着）包含有关创建 pastebin 的一章。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-12-14T06:48:51.883

Pastebot 可能是原始的 pastebin 之一，并且分布在[CPAN](http://search.cpan.org/dist/Bot-Pastebot/)上，并且这些天在 github 和/或 gitorious 中开发。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-12-14T06:51:57.873

您是否考虑过来自 github 的 Gist？

[http://gist.github.com/](http://gist.github.com/)

> Gist 是一种与他人共享片段和粘贴的简单方法。所有 Gist 都是 git 存储库，因此它们会自动进行版本控制、可分叉和可用作 git 存储库。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-10-01T22:12:29.717

膏体不错。带有 pln txt 和 python 突出显示（pygments），但你可以更容易地添加。n 如果您需要帮助，您可以联系作者 (patx@patx.me)。[粘贴维基](http://bitbucket.org/patx/hpaste)。也可以在纯 python 中运行，重量轻且易于设置（上传到您的网站）。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-11-19T20:17:41.793

[Codepad.org](http://codepad.org/)非常适合小型示例，因为它会编译和运行您的代码。这对于确保您和其他任何人在同一页面上是非常宝贵的。它不是完全开源的，但[它使用](http://www.xs4all.nl/~weegen/eelis/geordi/)的一些部分是开源的，这是一个值得考虑的好特性。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2009-10-08T00:34:39.237

[http://pastebin.im](http://pastebin.im)能够调试超过 50 种编程语言。

它在 pastebin.com 的开源应用程序上运行。

* * *

## 回答 #10

> 赞同：-3
> 
> 时间：2011-06-23T16:46:02.237

我对开源 PHP Stikked 的体验非常好：[http ://code.google.com/p/stikked](http://code.google.com/p/stikked)

它是用 CodeIgniter 编写的，安装起来比较轻松。

# mysql - 我应该如何审计 MySQL 表中的更改（使用 MySQL 4）？

> ID：218722
> 
> 赞同：6
> 
> 时间：2008-10-20T14:55:32.320
> 
> 标签：mysql, audit

我被要求审核 MySQL 表中的任何/所有更改。有谁知道那里有任何工具可以帮助我做到这一点，还是我需要编写自己的解决方案？

如果我编写自己的审计，我最初的想法是制作一个单独的表并在 PHP 代码中构建一串更改。类似于“fieldname1 -> oldvalue | fieldname2 -> oldvalue, ...”。如果您发现此方法存在重大问题，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-20T15:09:39.453

使用[触发器](http://dev.mysql.com/doc/refman/5.0/en/triggers.html)来检测更改并将之前/之后的值写入日志表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-20T15:32:29.860

捕获对数据库表的所有更改的唯一可靠方法是在服务器上使用触发器。修改您自己的代码以审核更改的风险是不会捕获来自另一个应用程序/用户等的更改。

话虽如此，我不确定 MySQL 4 是否支持触发器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-20T21:25:10.320

如果由于缺乏触发器支持而最终手动滚动解决方案，我强烈建议您不要只将更改转储到字符串 blob 中。有一天，您将被要求查询该数据，最终您将不得不进行一堆字符串解析才能将数据取回。（我在这里根据经验说话。）

最简单的方法是创建一个影子审计表，该表具有与原始表相同的所有列，以及一个更改日期列和一个顺序 ID。然后，您可以将整个历史记录以您需要的任何格式重建，并且您可以随意查询它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T16:07:12.317

SoftTree DB Audit 支持 MySQL，可能会满足您的需求：

[http://www.softtreetech.com/idbaudit.htm](http://www.softtreetech.com/idbaudit.htm)

# vb.net - VB.NET COMException 错误

> ID：218731
> 
> 赞同：1
> 
> 时间：2008-10-20T14:58:56.743
> 
> 标签：vb.net, comexception

我使用 MS Visual Studio 2005 在 VB.NET 中编写了一个应用程序。我使用的是 .NET 版本“2.0.50727”。直到最近，该应用程序一直在正常运行。使用一段时间后，它开始产生`System.Runtime.InteropServices.COMException error (80080005)`. 当我调用生成另一个外部应用程序的实例时会发生错误。一旦发生此错误，它就永远不会消失，每次打开我的应用程序时都会发生。此错误破坏了我的程序的功能，因为它依赖于它正在调用的第二个应用程序。

我不确定是什么导致了这个错误的发生，但我知道它是用户特定的，而不是应用程序。它似乎发生在用户的 Windows 配置文件中。我可以在同一台机器上使用不同的用户，或者为有问题的用户创建一个新的配置文件，程序将在一段时间内正常工作。最终（几周内）错误将返回并一直存在，直到我再次解决它。我正在尝试调试 COM 错误以了解为什么会发生这种情况，但这是一种奇怪的行为，我不知道从哪里开始。我从未见过将自身连接到配置文件并导致其持久存在的错误。

我没有很多 .NET 经验，但我做过很多 VB 6 应用程序编程。请提出您的任何建议。非常感谢您的帮助。

这是发生错误的代码块：

```
Public Class frmMain

Public btApp As BarTender.Application

Private Sub frmMain_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

Try

    btApp = New BarTender.Application

Catch COMex As Runtime.InteropServices.COMException

    MessageBox.Show("Error " + COMex.ErrorCode.ToString() + ": " + COMex.Message)

End Try 
```

我在我的 frmMain.vb 表单（要加载的第一个表单）的顶部声明了变量。我在第一个表单加载时加载 COM 对象。我让它保持活动状态，直到应用程序关闭，因为我对它进行了很多调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T15:22:30.270

听起来错误与安全相关。它在一段时间后神奇地发生在新用户身上，我会看看你的用户策略定义。密码会在一段时间后过期吗？新用户是否有根据您的应用程序使用情况而填满的小型临时目录（因此导致被屏蔽为 COM 异常的磁盘错误）？这个第三方应用程序是什么？我们在这里有点缺乏细节。但这些都是开始研究的事情。

# c# - 表单加载后如何执行代码？

> ID：218732
> 
> 赞同：144
> 
> 时间：2008-10-20T14:58:58.820
> 
> 标签：c#, .net, winforms, events

在 .NET 中，Windows 窗体有一个在窗体加载之前触发的事件 (Form.Load)，但在窗体加载之后没有相应的事件触发。我想在表单加载后执行一些逻辑。

任何人都可以就解决方案提出建议吗？

* * *

## 回答 #1

> 赞同：213
> 
> 时间：2008-10-20T16:59:27.080

您可以使用“显示”事件：[MSDN - Form.Shown](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.shown.aspx)

“Shown 事件仅在第一次显示表单时引发；随后最小化、最大化、恢复、隐藏、显示或无效和重新绘制不会引发此事件。”

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2008-10-20T15:02:54.117

我有时使用（在加载中）

```
this.BeginInvoke((MethodInvoker) delegate {
  // some code
}); 
```

或者

```
this.BeginInvoke((MethodInvoker) this.SomeMethod); 
```

（如果您正在处理“this”以外的实例上的事件，请将“this”更改为您的表单变量）。

这会将调用推送到 windows-forms 循环中，因此在表单处理消息队列时会对其进行处理。

[应要求更新]

Control.Invoke/Control.BeginInvoke 方法旨在与线程一起使用，并且是一种将工作推送到 UI 线程的机制。通常这由工作线程等使用。 Control.Invoke 执行同步调用，而 Control.BeginInvoke 执行异步调用。

通常，这些将用作：

```
SomeCodeOrEventHandlerOnAWorkerThread()
{
  // this code running on a worker thread...
  string newText = ExpensiveMethod(); // perhaps a DB/web call

  // now ask the UI thread to update itself
  this.Invoke((MethodInvoker) delegate {
      // this code runs on the UI thread!
      this.Text = newText;
  });
} 
```

它通过将消息推送到 Windows 消息队列来做到这一点；UI 线程（在某些时候）使消息出队，处理委托，并向工作人员发出它完成的信号……到目前为止一切顺利；-p

好的; 那么如果我们在 UI 线程上使用 Control.Invoke / Control.BeginInvoke 会发生什么？它可以应付...如果您调用 Control.Invoke，很明智地知道消息队列上的阻塞会导致立即死锁-因此，如果您已经在 UI 线程上，它只会立即运行代码...这样对我们没有帮助...

但是 Control.BeginInvoke 的工作方式不同：它*总是*将工作推入队列，即使我们已经在 UI 线程上。这是一种非常简单的说“一会儿”的方式，但没有计时器等的不便（无论如何，它仍然必须做同样的事情！）。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-09-20T15:58:39.667

第一次它不会启动“AfterLoading”，
它只会注册它以启动 NEXT Load。

```
private void Main_Load(object sender, System.EventArgs e)
{
    //Register it to Start in Load 
    //Starting from the Next time.
    this.Activated += AfterLoading;
}

private void AfterLoading(object sender, EventArgs e)
{
    this.Activated -= AfterLoading;
    //Write your code here.
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-09-30T04:55:02.997

我有同样的问题，并解决如下：

实际上我想显示消息并在 2 秒后自动关闭它。为此，我必须生成（动态）简单的表单和一个显示消息的标签，停止消息 1500 毫秒，以便用户阅读它。并关闭动态创建的表单。显示的事件发生在加载事件之后。所以代码是

```
Form MessageForm = new Form();
MessageForm.Shown += (s, e1) => { 
    Thread t = new Thread(() => Thread.Sleep(1500)); 
    t.Start(); 
    t.Join(); 
    MessageForm.Close(); 
}; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-20T15:47:22.090

如果您希望它在表单被激活时发生，您也可以尝试将您的代码放在表单的 Activated 事件中。您需要输入一个布尔“已执行”检查，但它是否应该只在第一次激活时运行。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-03-09T05:31:55.543

这是一个老问题，更多地取决于您何时需要开始您的例程。由于没有人想要空引用异常，因此最好先检查空值，然后根据需要使用；仅此一项就可以为您节省很多悲伤。

此类问题的最常见原因是当容器或自定义控件类型尝试访问在自定义类之外初始化的属性时，这些属性尚未初始化，因此可能导致填充空值，甚至可能导致空引用异常关于对象类型。这意味着您的类在完全初始化之前正在运行 - 在您完成设置属性等之前。此类问题的另一个可能原因是何时执行自定义图形。

为了最好地回答表单加载事件之后何时开始执行代码的问题是监视 WM_Paint 消息或直接挂钩到绘制事件本身。为什么？只有当所有模块都已完全加载到您的表单加载事件时，才会触发绘制事件。注意：当 this.visible == true 设置为 true 时，它​​并不总是 true，因此它根本不用于此目的，除了隐藏表单。

以下是如何在表单加载事件之后开始执行代码的完整示例。建议您不要不必要地占用绘制消息循环，因此我们将创建一个事件，该事件将在该循环之外开始执行您的代码。

```
using System.Windows.Forms; 
```

命名空间 MyProgramStartingPlaceExample {

```
/// <summary>
/// Main UI form object
/// </summary>
public class Form1 : Form
{

    /// <summary>
    /// Main form load event handler
    /// </summary>
    public Form1()
    {
        // Initialize ONLY. Setup your controls and form parameters here. Custom controls should wait for "FormReady" before starting up too.
        this.Text = "My Program title before form loaded";
        // Size need to see text. lol
        this.Width = 420;

        // Setup the sub or fucntion that will handle your "start up" routine
        this.StartUpEvent += StartUPRoutine;

        // Optional: Custom control simulation startup sequence:
        // Define your class or control in variable. ie. var MyControlClass new CustomControl;
        // Setup your parameters only. ie. CustomControl.size = new size(420, 966); Do not validate during initialization wait until "FormReady" is set to avoid possible null values etc. 
        // Inside your control or class have a property and assign it as bool FormReady - do not validate anything until it is true and you'll be good! 
    }

    /// <summary>
    /// The main entry point for the application which sets security permissions when set.
    /// </summary>
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Form1());
    }

    #region "WM_Paint event hooking with StartUpEvent"            
    //
    // Create a delegate for our "StartUpEvent"
    public delegate void StartUpHandler();
    //
    // Create our event handle "StartUpEvent"
    public event StartUpHandler StartUpEvent;
    //
    // Our FormReady will only be set once just he way we intendded
    // Since it is a global variable we can poll it else where as well to determine if we should begin code execution !!
    bool FormReady;
    //
    // The WM_Paint message handler: Used mostly to paint nice things to controls and screen
    protected override void OnPaint(PaintEventArgs e)
    {
        // Check if Form is ready for our code ?
        if (FormReady == false) // Place a break point here to see the initialized version of the title on the form window
        {
            // We only want this to occur once for our purpose here.
            FormReady = true;
            //
            // Fire the start up event which then will call our "StartUPRoutine" below.
            StartUpEvent();
        }
        //
        // Always call base methods unless overriding the entire fucntion
        base.OnPaint(e);
    }
    #endregion

    #region "Your StartUp event Entry point"
    //
    // Begin executuing your code here to validate properties etc. and to run your program. Enjoy!
    // Entry point is just following the very first WM_Paint message - an ideal starting place following form load
    void StartUPRoutine()
    {
        // Replace the initialized text with the following
        this.Text = "Your Code has executed after the form's load event";
        //
        // Anyway this is the momment when the form is fully loaded and ready to go - you can also use these methods for your classes to synchronize excecution using easy modifications yet here is a good starting point. 
        // Option: Set FormReady to your controls manulaly ie. CustomControl.FormReady = true; or subscribe to the StartUpEvent event inside your class and use that as your entry point for validating and unleashing its code.
        //
        // Many options: The rest is up to you!
    }
    #endregion

} 
```

}

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-07T15:25:21.537

我知道这是一个旧帖子。但这是我的做法：

```
 public Form1(string myFile)
    {
        InitializeComponent();
        this.Show();
        if (myFile != null)
        {
            OpenFile(myFile);
        }
    }

    private void OpenFile(string myFile = null)
    {
            MessageBox.Show(myFile);
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-05-08T20:36:54.290

以下是在之前的正确答案中添加的一些细节，尤其是 Matthias Schappling 的答案。

在 Form1_Load 中添加一个事件处理程序，如下所示：

```
 private void Form1_Load(object sender, EventArgs e)
  {
   this.Shown += new EventHandler(Form1_Shown);
  } 
```

接下来，添加将对代码执行某些操作的方法

```
 private void Form1_Shown(Object sender, EventArgs e)
  {
   draw_on_my_form_or_some_other_action();
  } 
```

* * *

## 回答 #9

> 赞同：-9
> 
> 时间：2015-05-08T02:36:23.157

您可以在执行一些操作后关闭您的表单..

//YourForm.ActiveForm.Close();

```
 LoadingForm.ActiveForm.Close(); 
```

# asp.net - asp之前的Javascript：ButtonField点击

> ID：218733
> 
> 赞同：25
> 
> 时间：2008-10-20T14:59:41.703
> 
> 标签：asp.net, javascript, gridview

我`GridView`在一个 Asp.net 应用程序中有一个控件，它有一个`<asp:buttonField>`of`type="image"`和`CommandName="Delete"`.

`OnRowDelete`有没有办法在到达事件之前执行一段 javascript ？

在删除该行之前，我只想简单确认一下。

谢谢！

**编辑**：请注意，标签`<asp:ButtonField>`没有**属性**`OnClientClick`。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-10-20T15:16:37.100

我会改用 TemplateField，并使用常规的 asp:Button 或 asp:ImageButton 填充 ItemTemplate，这取决于需要什么。然后，您可以执行与 RowCommand 事件在拦截 Delete 命令时要执行的逻辑相同的逻辑。

然后，在其中任何一个按钮上，我将使用 OnClientClick 属性在此之前执行 JavaScript 确认对话框。

```
<script type="text/javascript">
   function confirmDelete()
   {
       return confirm("Are you sure you want to delete this?");
   }
</script>

...

<asp:TemplateField>
  <ItemTemplate>
     <asp:ImageButton ID="DeleteButton" runat="server"
        ImageUrl="..." AlternateText="Delete" ToolTip="Delete"
        CommandName="Delete" CommandArgument='<%# Eval("ID") %>'
        OnClientClick="return confirmDelete();" />
  </ItemTemplate>
</asp:TemplateField> 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2010-03-01T20:18:13.203

我发现最优雅的方法是使用 jQuery 连接 onClick 事件：

```
<script type="text/javascript"> 
    $(".deleteLink").click(function() {
      return confirm('Are you sure you wish to delete this record?');
    });
</script>

...

<asp:ButtonField ButtonType="Link" Text="Delete"
    CommandName="Delete" ItemStyle-CssClass="deleteLink" /> 
```

请注意，我使用任意 CSS 类来标识链接按钮。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-20T16:42:42.387

在`GridView`的`RowCreated`事件处理程序中，使用`FindControl`找到命名按钮，并添加到 Attributes 集合中：

```
btn.Attributes.Add("onclick", "return confirm('delete this record?');"); 
```

只有当confirm() 为真时，您的ASP.Net 代码才会被执行，即已经ok'd。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T16:27:37.127

所以我有一个javascript函数：

```
function confirmDeleteContact() {
  if (confirm("Are you sure you want to delete this contact?")) {
    document.all.answer.value="yes";
  } else {
    document.all.answer.value="no";
  }
} 
```

我将它连接到一个网格项目，如下所示：

```
Sub dgbind(ByVal sender As Object, ByVal e As DataGridItemEventArgs) Handles dgcontacts.ItemDataBound
    Select Case e.Item.ItemType
        Case ListItemType.Item, ListItemType.AlternatingItem
            CType(e.Item.Cells(9).Controls(0), System.Web.UI.WebControls.LinkButton).Attributes.Add("onclick", "javascript:confirmDeleteContact();")
    End Select
End Sub 
```

这是一些旧代码，所以我看到了一些我可以改变的东西，但道德是这样的：如果一切都失败了，请在行绑定期间添加 javascript“onClick”。“document.all.answer.value”是一个隐藏字段，`runat=server`因此我可以在回发时读取该值。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-02-10T13:56:45.940

如果您使用按钮字段，则添加参考 System.Windows.Forms 对您更好...它始终在所有 .net 框架中可用并支持 asp.net..

如果按钮字段是您的最佳选择，这是您的选择.. 示例：

```
using System.Windows.Forms;

protected void BorrowItem_RowCommand(object sender, GridViewCommandEventArgs e)
{

    if (e.CommandName == "Delete")
    {

        if (System.Windows.Forms.MessageBox.Show("Do you want to delete", "Delete",MessageBoxButtons.OKCancel, MessageBoxIcon.Question, MessageBoxDefaultButton.Button1, MessageBoxOptions.ServiceNotification) != System.Windows.Forms.DialogResult.OK)
        {
            return;
         }
     }
//Continue execution...
}

//drimaster 
```

# jira - JIRA 问题解决程序

> ID：218743
> 
> 赞同：8
> 
> 时间：2008-10-20T15:04:22.367
> 
> 标签：jira

我使用的是标准版的 JIRA，总的来说，我喜欢它。但是，JIRA 似乎没有记录谁解决了问题、当前的受让人是谁以及谁报告了问题，这是一个常见的恼人来源。

因为没有记录“解决程序”，所以无法找到我解决的问题，或者我没有解决的问题（例如，在寻找要测试的问题时）。

某处是否有“打开”解析器跟踪的配置选项？

干杯，唐

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-29T13:05:35.667

[JIRA 增强器插件](http://confluence.atlassian.com/display/JIRAEXT/JIRA+Enhancer+Plugin)添加了一个“最后解析的用户”自定义字段。如果您将此添加到您的问题和问题屏幕中，您可以看到最后一个解决问题的用户是谁。

我怀疑它只能搜索添加插件后解决的问题。

我们遇到了完全相同的问题，因此引入了规则，即关闭问题的测试人员将问题重新分配给解决问题的人。这是一个非常好的解决方法，现在我已经安装了我们希望不需要的插件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-20T17:18:27.010

通常，分配问题的人是解决问题的人。也许您的工作流程需要改变，这样才能做到这一点。但是，变更日志确实记录了执行特定转换的人员。这是不可查询的。

# java - 在 Java 中禁止继承的充分理由？

> ID：218744
> 
> 赞同：190
> 
> 时间：2008-10-20T15:05:00.303
> 
> 标签：java, inheritance, final

在 Java 中禁止继承的充分理由是什么，例如使用最终类或使用单个私有无参数构造函数的类？使方法成为最终方法的充分理由是什么？

* * *

## 回答 #1

> 赞同：196
> 
> 时间：2008-10-20T15:10:49.263

您最好的参考是 Joshua Bloch 的优秀著作“Effective Java”的第 19 项，名为“Design and document for inheritance or else improment it”。（这是第二版的第 17 项和第一版的第 15 项。）你真的应该阅读它，但我会总结一下。

如果祖先不是被设计为从其继承的，那么继承类与其父类的交互可能会令人惊讶且不可预测。

因此，类应该有两种：

1.  *设计为可**扩展***的类，并且有足够的文档来描述它应该如何完成

2.  课程*标记为**最终***

如果您正在编写纯粹的内部代码，这可能有点矫枉过正。然而，在类文件中添加五个字符所涉及的额外工作量非常小。如果您只是为内部消费而编写，那么未来的编码员总是可以删除“final”——您可以将其视为警告说“此类在设计时没有考虑到继承”。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-10-20T15:10:05.380

您可能希望将方法设为最终方法，以便覆盖类无法更改其他方法中依赖的行为。构造函数中调用的方法通常被声明为 final，因此您在创建对象时不会遇到任何令人不快的意外。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-10-20T15:11:54.427

将类设为 final 的一个原因是，如果您想强制组合而不是继承。这在避免类之间的紧密耦合方面通常是可取的。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-12-13T04:28:55.100

**您可以在 3 个用例中使用最终方法。**

1.  避免派生类覆盖特定的基类功能。
2.  这是出于安全目的，其中基类提供了框架的一些重要核心功能，而派生类不应该更改它。
3.  最终方法比实例方法更快，因为最终方法和私有方法没有使用虚拟表概念。因此，只要有可能，请尝试使用 final 方法。

**使班级决赛的目的：**

这样没有人可以扩展这些类并改变它们的行为。

例如：包装类 Integer 是最终类。如果该类不是最终类，那么任何人都可以将 Integer 扩展到他自己的类中并改变整数类的基本行为。为了避免这种情况，java 将所有包装类都作为最终类。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-10-20T15:21:05.857

您可能想要制作不可变对象（[http://en.wikipedia.org/wiki/Immutable_object](http://en.wikipedia.org/wiki/Immutable_object)），您可能想要创建单例（[http://en.wikipedia.org/wiki/Singleton_pattern](http://en.wikipedia.org/wiki/Singleton_pattern)），或者您可能想要以防止有人出于效率、安全或安保的原因覆盖该方法。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-10-20T15:12:07.200

继承就像一把电锯——非常强大，但在坏人手中却很糟糕。您要么设计一个要继承的类（这可能会限制灵活性并花费更长的时间），要么应该禁止它。

请参阅 Effective Java 第 2 版第 16 和 17 项，或我的博文[“继承税”](http://codeblog.jonskeet.uk/2006/03/04/inheritancetax.aspx)。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-20T15:13:05.187

嗯...我可以想到两件事：

您可能有一个处理某些安全问题的类。通过对其进行子类化并将其子类化版本提供给您的系统，攻击者可以规避安全限制。例如，您的应用程序可能支持插件，如果插件可以子类化您的安全相关类，它可以使用此技巧以某种方式将其子类化版本走私到位。但是，这是 Sun 必须处理的有关 applet 之类的事情，也许不是这样一个现实的情况。

一个更现实的方法是避免对象变得可变。例如，由于字符串是不可变的，您的代码可以安全地保留对它的引用

```
 String blah = someOtherString; 
```

而不是先复制字符串。但是，如果您可以子类化 String，则可以向其添加允许修改字符串值的方法，现在没有代码可以再依赖于字符串将保持不变，如果它只是像上面那样复制字符串，而是必须复制细绳。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-20T15:12:21.133

阻止人们做可能混淆自己和他人的事情。想象一个物理库，其中有一些已定义的常数或计算。在不使用 final 关键字的情况下，有人可能会出现并重新定义不应更改的基本计算或常量。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-20T15:51:01.537

此外，如果您正在编写一个商业封闭源代码类，您可能不希望人们能够更改功能，特别是如果您需要支持它并且人们已经覆盖了您的方法并抱怨调用它会给意想不到的结果。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-10-20T17:35:31.890

如果将类和方法标记为 final，您可能会注意到性能的小幅提升，因为运行时不必查找正确的类方法来调用给定对象。非最终方法被标记为虚拟，以便在需要时可以适当地扩展它们，最终方法可以直接链接或在类中内联编译。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-11-10T21:29:14.887

You want to make a method final so that overriding classes does not change its behavior. When you want to be able to change the behavior make the method public. When you override a public method it can be changed.

# iphone - 如何更改文本旋转轴

> ID：218746
> 
> 赞同：0
> 
> 时间：2008-10-20T15:05:21.850
> 
> 标签：iphone, cocoa-touch, core-graphics

我`CGContextShowText`用来显示文本，但是当使用 旋转它时`CGAffineTransformation`，旋转轴位于左侧，而不是绘制文本的中心，我使用的代码是这样的：

```
CGContextSaveGState(context);

CGContextSelectFont(context, "Helvetica", 20, kCGEncodingMacRoman);
CGContextSetCharacterSpacing (context, 1);
CGContextSetRGBFillColor (context, 0, 0, 0, 1);
CGAffineTransform xform = CGAffineTransformMake(
    sin(DegreesToRadians(angle)), cos(DegreesToRadians(angle)),
    cos(DegreesToRadians(angle)), -sin(DegreesToRadians(angle)),
    0,  0);

CGContextSetTextDrawingMode (context, kCGTextFill); 

CGPoint degreeDisplayPoint = CGPointMake(100,100);
CGContextShowTextAtPoint(context, degreeDisplayPoint.x, degreeDisplayPoint.y, [angleStringWithDegree cStringUsingEncoding:NSMacOSRomanStringEncoding], [angleStringWithDegree length]); 

CGContextRestoreGState(context); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-20T15:10:52.413

平移您的对象，使其中心位于 (0, 0)，然后旋转它，然后将其平移回您想要的位置。

# c++ - 在 Visual C++ 2008 的调试模式下找不到 MSVCR90D.dll

> ID：218747
> 
> 赞同：17
> 
> 时间：2008-10-20T15:05:22.800
> 
> 标签：c++, visual-studio-2008, debugging, winsxs, msvcr90d.dll

我在使用 Visual C++ 2008 时遇到问题。我已经安装了 opencv，并且创建了一个新程序，并且我构建它时没有出现任何错误。但是，它抱怨调试时找不到 MSVCR90D.dll。在发布模式下完全没有问题。

我确实在 Winsxs 文件夹之一中有 MSVCR90D.dll。有谁知道解决这个问题？这是一个已知的错误？

杰拉德

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-20T15:16:52.917

[此论坛帖子](http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/8f08777b-1c4d-4e10-89a2-f7bc95cf5e98/)中描述了几种潜在的解决方案。看看这些是否有帮助。

来自那里的一个提示：

> 转到 %System Drive%\Windows\WinSxS 并查找目录 x86_Microsoft.VC90.DebugCRT_1fc8b3b9a1e18e3b_9.0.21022.8_x-ww_597c3456
> 
> 如果这不存在，请转到 VS 设置并确保您已在 VC++ 下安装了所有库。

还有一个：

> 我遇到了同样的问题，但通过关闭增量链接来修复它（项目属性...链接器...常规...启用增量链接：否）。

确认最后一个：

> 在安装了软件的驱动器上构建的项目抱怨缺少 MSVCR90D.dll。如果您关闭增量链接（当然要全部重建），问题就会消失。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-29T02:13:29.770

遇到同样的问题，我发现一篇文章引导我在 VS9.0 安装中调试 DLL。对于默认安装，它们位于：`C:\Program Files\Microsoft Visual Studio 9.0\VC\redist\Debug_NonRedist\x86\Microsoft.VC90.DebugCRT`.

有三个 DLL 和一个清单文件。您可以将这些添加到您的`System32`目录，将目录添加到您的`PATH`环境变量或在调试时将文件复制到与可执行文件相同的目录。

增量链接加快了您的构建（链接器仅重新链接已更改的库，而不是重新链接整个项目）。否则它对构建输出没有影响。对于大型项目，我不建议关闭增量链接。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-01-13T16:18:31.300

有同样的问题，虽然另一个 VC9.0 项目做得很好。所以我比较了两个项目设置。关键的区别在于“项目属性”->“配置属性”->“清单工具”->“输入和输出”->“嵌入清单”。此选项必须设置为 YES。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-21T09:05:02.170

使用 Dependency Walker 解决 DLL 问题要容易得多。它允许您分析您的应用程序，捕获启动时加载的 DLL 和稍后加载的 DLL。它会吐出很多与DLL加载或加载失败有关的消息。它还理解 DLL 的 SxS 加载。

您可以将 EXE 作为参数传递给 Depends.EXE，它将分析该应用程序。这可以与大多数 IDE 结合使用。例如，在 Visual Studio 中，您可以设置“调试命令”。默认情况下，这是您自己的 EXE。将其更改为depends.EXE，并将命令参数设置为（至少）`/pb your.debug.exe`。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-07-11T08:09:57.837

使用函数 File->New->Project From Existing Code 在 VC++ 2008 中重新编译您的项目。它帮助了我自己，也许它会帮助你。问候。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-08-05T06:47:26.830

我已经解决了同样的问题，如下所示：

1.  选择项目，右键单击并打开属性页。
2.  选择配置属性。
3.  从树列表中选择 C/C++。
4.  选择代码生成。
5.  查看左侧的属性列表并查看**运行时库**属性。
6.  选择**多线程调试**，而不是关闭多线程 DLL。

当你这样做时，你的项目嵌入了依赖的 dll，因此它避免了依赖问题。

注意：我在一个 dll 项目上工作并遇到了这个问题。完成上述步骤后，它适用于我的情况。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-07-01T13:00:11.733

我尝试了所有建议的解决方案，但没有任何运气。我终于发现该`"C:\WINDOWS\WinSxS\Manifests"`文件夹中缺少清单。

`C:\WINDOWS\WinSxS`找到您的 dll 所在的文件夹。检查是否有`C:\WINDOWS\WinSxS\Manifests`与您的 dll 文件夹名称匹配的清单。如果清单丢失，请从另一台计算机复制正确的清单并将其粘贴到清单文件夹中。清单文件名是：

> “x86_Microsoft.VC90.DebugCRT_1fc8b3b9a1e18e3b_9.0.21022.8_x-ww_597c3456.cat”
> 
> “x86_Microsoft.VC90.DebugCRT_1fc8b3b9a1e18e3b_9.0.21022.8_x-ww_597c3456.manifest”

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-20T15:22:31.580

这是我静态链接的原因之一；更大的 EXE，但我以前从未遇到过这样的依赖问题。可能本身就值得一个问题......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-22T00:03:33.270

我遇到了问题：

无法加载文件或程序集“AudioInterface，Version=1.0.3548.29920，Culture=neutral，PublicKeyToken=null”或其依赖项之一。此应用程序无法启动，因为应用程序配置不正确。重新安装应用程序可能会解决此问题。（来自 HRESULT 的异常：0x800736B1）

AudioInterface 是我的 C++ 项目的名称。

切换到“发布”配置，一切正常。

我跟踪到它在我的 DLL 旁边缺少清单文件，我进一步跟踪到有一个程序集标识集。（属性 > 清单工具 > 常规 > 装配标识）

我删除了这个设置，清单放在正确的位置，一切正常。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-07-19T18:29:59.247

我无法给出明确的解决方案，但这里有一些有用的链接：

*   [David Lenihan 在 WinSxS 上的博客](http://davidlenihan.com/2007/07/winsxs.html)
*   [并排组件](http://msdn.microsoft.com/en-us/library/aa376307(VS.85).aspx)
*   [对 C/C++ 隔离应用程序和并行程序集进行故障排除](http://msdn.microsoft.com/en-us/library/ms235342(VS.80).aspx)
*   [装配搜索序列](http://msdn.microsoft.com/en-us/library/aa374224(VS.85).aspx)

当然，如果您点击链接，MSDN 上还有更多内容。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-03-02T13:01:45.197

我遇到了类似的问题，但所描述的解决方案都不适合我。

最后我做了以下来解决我的问题：

Step-1：按照@user176861给出的建议

步骤2：在VC++项目属性->配置属性->链接器->清单文件中：在“附加清单依赖项”中添加以下内容：

```
type='win32' name='Microsoft.VC90.CRT' version='9.0.21022.8' processorArchitecture='x86' publicKeyToken='1fc8b3b9a1e18e3b' 
```

进行上述更改后，我能够调试。

# html - 你如何防止浮动元素的父母崩溃？

> ID：218760
> 
> 赞同：1055
> 
> 时间：2008-10-20T15:10:25.130
> 
> 标签：html, css, layout, css-float, clearfix

尽管像`<div>`s 这样的元素通常会增长以适应其内容，但使用该`float`属性可能会给 CSS 新手带来一个令人吃惊的问题：**如果浮动元素有非浮动的父元素，则父元素会崩溃。**

例如：

```
<div>
  <div style="float: left;">Div 1</div>
  <div style="float: left;">Div 2</div>
</div>
```

此示例中的父 div**不会扩展**以包含其浮动子级 - 它似乎具有`height: 0`.

# 你怎么解决这个问题？

*我想在这里创建一个详尽的解决方案列表。如果您知道跨浏览器兼容性问题，请指出。*

## 解决方案 1

浮动父级。

```
<div style="float: left;">
  <div style="float: left;">Div 1</div>
  <div style="float: left;">Div 2</div>
</div>
```

**优点**：语义代码。
**缺点**：您可能并不总是希望父级浮动。即使你这样做了，你会浮动父母的父母，等等吗？你必须浮动每个祖先元素吗？

## 解决方案 2

给父母一个明确的高度。

```
<div style="height: 300px;">
  <div style="float: left;">Div 1</div>
  <div style="float: left;">Div 2</div>
</div>
```

**优点**：语义代码。
**缺点**：不灵活 - 如果内容更改或浏览器调整大小，布局将中断。

## 解决方案 3

在父元素内附加一个“spacer”元素，如下所示：

```
<div>
  <div style="float: left;">Div 1</div>
  <div style="float: left;">Div 2</div>
  <div class="spacer" style="clear: both;"></div>
</div>
```

**优点**：代码简单。
**缺点**：不是语义；间隔 div 仅作为布局技巧存在。

## 解决方案 4

将父级设置为`overflow: auto`。

```
<div style="overflow: auto;">
  <div style="float: left;">Div 1</div>
  <div style="float: left;">Div 2</div>
</div>
```

**优点**：不需要额外的 div。
**缺点**：似乎是一种黑客行为 - 这不是该`overflow`物业的既定目的。

# 注释？其他建议？

* * *

## 回答 #1

> 赞同：552
> 
> 时间：2012-07-22T04:48:22.187

## 解决方案1：

最可靠和不引人注目的方法似乎是这样的：

演示：http: [//jsfiddle.net/SO_AMK/wXaEH/](http://jsfiddle.net/SO_AMK/wXaEH/)

**HTML**：

```
<div class="clearfix">
    <div style="float: left;">Div 1</div>
    <div style="float: left;">Div 2</div>
</div>​ 
```

**CSS**：

```
.clearfix::after { 
   content: " ";
   display: block; 
   height: 0; 
   clear: both;
} 
```

​使用一点 CSS 定位，您甚至不需要向 parent 添加一个类`DIV`。

此解决方案向后兼容 IE8，因此您无需担心旧版浏览器会出现故障。

## 解决方案2：

已建议对解决方案 1 进行修改，如下所示：

演示：http: [//jsfiddle.net/wXaEH/162/](http://jsfiddle.net/wXaEH/162/)

**HTML**：

```
<div class="clearfix">
    <div style="float: left;">Div 1</div>
    <div style="float: left;">Div 2</div>
</div>​ 
```

**CSS**：

```
.clearfix::after { 
   content: " ";
   display: block; 
   height: 0; 
   clear: both;
   *zoom: expression( this.runtimeStyle['zoom'] = '1', this.innerHTML += '<div class="ie7-clear"></div>' );
}

.ie7-clear {
    display: block;
    clear: both;
} 
```

此解决方案似乎向后兼容 IE5.5，但未经测试。

## 解决方案3：

也可以在不折叠的情况下设置`display: inline-block;`和`width: 100%;`模拟普通块元素。

演示：http: [//jsfiddle.net/SO_AMK/ae5ey/](http://jsfiddle.net/SO_AMK/ae5ey/)

**CSS**：

```
.clearfix {
    display: inline-block;
    width: 100%;
} 
```

此解决方案应该向后兼容 IE5.5，但仅在 IE6 中进行了测试。

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2008-10-20T15:20:24.143

我通常使用这个`overflow: auto`技巧；虽然严格来说，这不是溢出的预期用途，但它*有点*相关 - 足以让它很容易记住，当然。其本身的含义`float: left`已扩展到各种用途，比在此示例中的溢出更显着，IMO。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2010-03-03T17:25:10.660

`overflow:auto`与其放在父母身上，不如放在`overflow:hidden`

我为任何网页编写的第一个 CSS 总是：

```
div {
  overflow:hidden;
} 
```

那我就不用担心了。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2010-03-03T17:33:17.943

当浮动元素位于容器框内时会出现问题，该元素不会自动强制容器的高度调整为浮动元素。当一个元素浮动时，其父元素不再包含它，因为浮动已从流中移除。您可以使用 2 种方法来修复它：

*   `{ clear: both; }`
*   `clearfix`

一旦你了解发生了什么，使用下面的方法来“清除”它。

```
.clearfix:after {
    content: ".";
    display: block;
    clear: both;
    visibility: hidden;
    line-height: 0;
    height: 0;
}

.clearfix {
    display: inline-block;
}

html[xmlns] .clearfix {
    display: block;
}

* html .clearfix {
    height: 1%;
} 
```

**[示范:)](http://www.webtoolkit.info/demo/css-clearfix)**

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2014-11-29T18:40:42.097

There are several versions of the clearfix, with **[Nicolas Gallagher](https://github.com/necolas)** and **[Thierry Koblentz](https://twitter.com/thierrykoblentz)** as key authors.

If you want support for older browsers, it's best to use this clearfix :

```
.clearfix:before, .clearfix:after {
    content: "";
    display: table;
}

.clearfix:after {
    clear: both;
}

.clearfix {
    *zoom: 1;
} 
```

In SCSS, you should use the following technique :

```
%clearfix {
  &:before, &:after {
    content:" ";
    display:table;
  }

  &:after {
    clear:both;
  }

  & {
    *zoom:1;
  }
}

#clearfixedelement {
    @extend %clearfix;
} 
```

If you don't care about support for older browsers, there's a shorter version :

```
.clearfix:after {
    content:"";
    display:table;
    clear:both;
} 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-03-05T23:41:20.610

理想的解决方案是使用`inline-block`列而不是浮动。`inline-block`如果您遵循 (a)仅适用于通常内联的元素（例如），我认为浏览器支持非常好`span`；(b)`-moz-inline-box`为 Firefox 添加。

在 FF2 中也检查您的页面，因为在嵌套某些元素时我遇到了很多问题（令人惊讶的是，这是 IE 性能比 FF 好得多的一种情况）。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2008-10-20T18:57:43.767

尽管代码不是完全语义化的，但我认为在每个带有浮动的容器底部放置一个我称之为“清除 div”的东西会更直接。事实上，我在每个项目的重置块中都包含了以下样式规则：

```
.clear 
{
   clear: both;
} 
```

如果您正在为 IE6 设计样式（上帝帮助您），您可能还想给这个规则一个 0px 的行高和高度。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2012-10-17T13:38:07.867

奇怪的是，还没有人对此提出完整的答案，嗯，就是这样。

## 解决方案一：*明确：两者*

添加样式为 clear:both 的块元素；到它上面将清除经过该点的浮动并阻止该元素的父元素折叠。[http://jsfiddle.net/TVD2X/1/](http://jsfiddle.net/TVD2X/1/)

优点：允许你清除一个元素，你在下面添加的元素不会受到上面的浮动元素和有效的 css 的影响。

缺点：需要另一个标签来清除浮动、膨胀标记。

注意：要回退到 IE6 并让它在禁欲的父母（即输入元素）上工作，您不能使用 :after。

## 解决方案二：*显示：表格*

添加显示：表格；给父母以使其摆脱浮动并以正确的高度显示。[http://jsfiddle.net/h9GAZ/1/](http://jsfiddle.net/h9GAZ/1/)

优点：没有额外的标记，而且更整洁。适用于 IE6+

缺点：需要无效的 css 以确保在 IE6 和 7 中一切正常。

注意：IE6 和 7 的宽度自动用于防止宽度为 100%+padding，在较新的浏览器中并非如此。

## 关于其他“解决方案”的说明

这些修复可以回溯到支持最低的浏览器，全球使用率超过 1% (IE6)，这意味着使用 :after 不会削减它。

隐藏溢出确实会显示内容，但不会阻止元素折叠，因此不会回答问题。使用内联块可能会产生错误的结果，孩子有奇怪的边距等等，表格要好得多。

设置高度确实“防止”了崩溃，但这不是一个正确的解决方法。

## 无效的 CSS

无效的 css 永远不会伤害任何人，事实上，它现在已成为常态。使用浏览器前缀与使用特定于浏览器的 hack 一样无效，并且不会影响最终用户。

## 综上所述

我使用上述两种解决方案来使元素正确反应并相互配合，我恳请您也这样做。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2008-10-20T15:24:31.357

我在适用的情况下使用 2 和 4（即当我知道内容的高度或溢出不会造成伤害时）。在其他任何地方，我都会使用解决方案 3。顺便说一下，您的第一个解决方案与 3 相比（我可以发现）没有任何优势，因为它不再具有语义，因为它使用了相同的虚拟元素。

顺便说一句，我不会担心第四个解决方案是黑客。CSS 中的黑客攻击只有在其潜在行为受到重新解释或其他更改时才会有害。这样，您的 hack 将无法保证有效。但是在这种情况下，您的 hack 依赖于本`overflow: auto`应具有的确切行为。搭便车没有坏处。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2013-10-15T10:35:10.480

我最喜欢的方法是为父元素使用 clearfix 类

```
.clearfix:after {
    content: ".";
    display: block;
    height: 0;
    clear: both;
    visibility: hidden;
}

.clearfix {
    display: inline-block;
}

* html .clearfix {
    height: 1%;
}

.clearfix {
    display: block;
} 
```

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-07-21T18:05:52.123

最著名的解决方案之一是解决方案编号 3 的变体，它使用伪元素而不是非语义 html 元素。

它是这样的......

```
.cf:after {
    content: " ";
    display: block;
    visibility: hidden;
    height: 0;
    clear: both;
} 
```

你把它放在你的样式表中，你所需要的只是将类'cf'添加到包含浮动的元素中。

我使用的是来自 Nicolas Gallagher 的另一种变体。

它做同样的事情，但它更短，看起来更整洁，并且可能用于完成另一件非常有用的事情 - 防止子元素的边距与其父元素崩溃（但为此你确实需要其他东西 - 阅读更多关于它这里[http://nicolasgallagher.com/micro-clearfix-hack/](http://nicolasgallagher.com/micro-clearfix-hack/)）。

```
.cf:after {
    content: " ";
    display: table;
    clear: float;
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-07-01T18:06:25.680

在底部的父 div 中添加它

```
 <div style="clear:both"></div> 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-03-29T16:09:32.223

我认为在语义上更正确的另一种可能的解决方案是将浮动的内部元素更改为“显示：内联”。这个例子和当我遇到这个页面时我正在做的事情都使用浮动 div 的方式与使用 span 的方式几乎完全相同。不要使用 div，而是切换到 span，或者如果您使用的是默认情况下为 'display: block' 而不是 'display: inline' 的另一个元素，则将其更改为 'display: inline'。我相信这是 100% 语义正确的解决方案。

解决方案1，浮动父级，本质上是将整个文档更改为浮动。

解决方案2，设置一个明确的高度，就像画一个盒子说我想在这里放一张图片，即如果你正在做一个img标签就使用这个。

解决方案 3，添加一个间隔来清除浮动，就像在您的内容下方添加一个额外的行，并且也会与周围的元素混淆。如果您使用这种方法，您可能希望将 div 设置为高度：0px。

解决方案 4，溢出：自动，是承认您不知道如何布置文档并且您承认您不知道该做什么。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2012-09-23T17:21:27.150

将溢出更改为`auto`or可能会发现的主要问题`hidden`是，所有内容都可以通过鼠标中键滚动，并且用户可能会弄​​乱整个站点布局。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-08-05T14:54:26.110

我相信最好的方法是设置`clear:both`即将到来的元素。

原因如下：

1) `:after`IE6/7 不支持选择器，FF3 不支持选择器，但是，
     如果您只关心 IE8+ 和 FF3.5+ 清除 :after 可能最适合您...

2）`overflow`应该做其他事情，所以这个黑客不够可靠。

作者注意：清除没有什么技巧......清除意味着跳过浮动字段。自 HTML3 以来，CLEAR 就在我们身边（谁知道，可能更长）[http://www.w3.org/MarkUp/html3/deflists.html](http://www.w3.org/MarkUp/html3/deflists.html)，也许他们应该选择一个有点不同的名称，例如 page: new，但这只是一个细节...

# visual-studio - WCF 应用程序在 IIS 下工作的 Visual Studio 项目类型？

> ID：218765
> 
> 赞同：1
> 
> 时间：2008-10-20T15:11:19.713
> 
> 标签：visual-studio, wcf, iis

是否有用于创建要在 IIS 中托管的 WCF 的特殊项目类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-20T16:22:22.160

您不需要使用特殊的项目类型在 IIS 中进行冲洗。只要您将 dll 放入 bin 文件夹并创建一个 .svc 文件，它就可以工作。一个标准的网站项目就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T15:53:05.060

我假设你在谈论 VS 2008。

我看不到让 WCF 服务库模板使用 IIS 进行托管的方法。我的建议是创建一个 ASP.NET Web 应用程序，将其配置为 IIS 托管，删除 Default.aspx 文件，然后将 WCF 服务添加到项目中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-10T17:39:42.437

如果您愿意，可以使用“WCF 服务应用程序”模板，但正如前面所说，您并不需要任何特别的东西。

# coding-style - 何时使用私有常量？

> ID：218777
> 
> 赞同：3
> 
> 时间：2008-10-20T15:14:21.330
> 
> 标签：coding-style, constants, private

在以下情况下使用私有常量是否正确：

假设我有一个带有生命变量和起始生命变量的游戏。在游戏开始时，我将lives 变量设置为与startingLives 变量相等。这就是我通常会这样做的方式：

```
private var lives:int = 0;
private var startingLives:int = 3;

private function startGame():void
{
   lives = startingLives;
} 
```

（示例代码是 ActionScript 顺便说一句）

我的问题是 - 这真的应该是：

```
private var lives:int = 0;
private const STARTING_LIVES:int = 3;

private function startGame():void
{
  lives = STARTING_LIVES;
} 
```

StartingLives 似乎不太可能在运行时改变，所以我应该使用 const，如果它不是恒定的，则改回变量？

更新：大家一致认为这是对常量的一种很好的使用，但是 amdfan 建议您可能希望从配置文件中加载值呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-20T15:16:32.857

是的，这是一个很好的使用 const。作为一般经验法则，任何其值在运行时不会改变的“变量”都应设为常量。这使编译器能够通过将这些值放入单独的 (ROM) 内存区域来优化这些值。（注意：这并不能保证你的编译器会优化，它只是让它成为*可能*。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-20T15:16:01.173

把它放在一个名为 的常量中`DEFAULT_STARTING_LIVES`，还有一个名为startingLives 的变量。现在，设置startingLives = `DEFAULT_STARTING_LIVES`。稍后，您可以根据配置文件中的值设置startingLives。如果该文件尚未创建或未找到，则您有一个备份。

（感谢 Plinth 扩展了我的原始答案。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-20T15:16:56.770

我认为私有常量在该上下文之外没有用处的情况下是合适的，并且如果公开会导致混乱。

当然，在您的情况下使用常量比使用幻数更好 - 特别是如果您需要在多个地方使用它。

# c# - 仅仅“投掷”一次接球有什么好处吗？

> ID：218781
> 
> 赞同：17
> 
> 时间：2008-10-20T15:16:01.030
> 
> 标签：c#, .net, vb.net

与一位同事就他将大部分功能包装在 try/catch 中的做法进行了“激烈的辩论”，但 catch 中只有一个“抛出”，例如

```
Private sub foo()
    try
        'Do something'
    catch
        throw 'And nothing else!'
    End Try
End Sub 
```

我的想法是不要打扰（假设您此时不需要做任何事情） - 异常会冒泡到父成员中的下一个异常处理程序。

唯一听起来合理的论点是有时没有捕获异常并且您的代码停止（在调试模式下），当前行以绿色突出显示......这可能与多个线程有关？最佳实践确实声明了“每个线程的异常处理程序”，但大多数情况下我们都是单线程工作的。

好消息可能是在调试模式下不会突然弹出给父成员（是的，乔尔！）可能很有用 - 您将转到“抛出”语句并能够检查您的本地人。但是你的代码会“到处都是 try/catch/throws”（在这里引用另一个线程）？

如果没有发生异常（即您是否应该避免在紧密循环中尝试/捕获），那么到处添加 try/catch/throws 会涉及什么样的开销？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-20T15:55:39.343

当您唯一要做的就是立即重新抛出异常时，Microsoft 建议不要捕获异常（我现在不记得来源了）。您的代码应该只捕获您想要处理以进行清理或类似操作的异常。

因此，通常捕获并重新抛出异常并不是一个好习惯。

捕获并用另一个异常替换它的原因可能是

*   日志记录
*   向调用者隐藏敏感信息（Stacktrace，异常详细信息）

对于调试，您可能希望更改“异常时中断：”-处理程序（按 Ctrl+Alt+e）在选定的 CLR 异常上“抛出”值。

您可能想查看 entlib 异常处理程序块 (EHB)，您可以使用它建立关于如何处理代码中的异常的模式。

关于您关于性能的问题，我认为在您的代码中包含许多 try/catch 块并不是一个问题，但是当您的代码引发并捕获许多异常时，您会受到性能影响。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-20T15:17:50.373

您在 catch 中单独抛出而不是抛出新异常的原因是因为这会导致原始堆栈跟踪/异常数据被保留。您可能会这样做的一个原因是因为您现在可以在那里设置一个断点进行调试。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-20T15:18:31.557

我只会在调试问题时这样做 - 我会在签入之前再次删除代码。如果抛出异常，有时可以很方便地设置断点以在特定堆栈级别停止。除此之外 - 不。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-20T15:19:38.963

在实践中，我的想法是，如果您不打算处理错误，请不要抓住它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-09T20:42:07.600

使用 catch 和立即重新抛出的一个效果是，任何内部的“Finally”块都将在“Catch”发生之前运行（这又将在异常传播之前）。这与两种情况有关：

1.  如果异常最终未处理，则未处理异常陷阱可能会在不运行任何“finally”块的情况下退出应用程序。执行 catch 并立即重新抛出将确保 catch 中的所有“finally”块都将执行，即使异常最终未处理也是如此。
2.  vb.net 和其他语言中的代码有可能在运行任何 finally 块之前对异常采取行动。使用带有 catch-and-immediate-rethrow 的“try”块将导致该 catch 块中的“finally”块在任何外部“try”块第一次查看异常之前运行。

另一个关于 catch-and-immediate-rethrow 的警告：由于某种原因，catch and immediate rethrow 将丢弃导致异常的函数调用的堆栈跟踪行号。我不知道为什么在这种情况下不能单独留下堆栈跟踪中的当前函数条目，但事实并非如此。如果不使用 .pdb 文件来获取行号信息，这不是问题，但如果想使用此类信息，可能会很烦人。

一般来说，上面提到的效果是不可取的，但在某些情况下，前两种效果中的一种或两种可能有用，而第三种效果可以忍受。在这些情况下，立即重新投掷的捕获物可能是合适的，但应记录其原因。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-20T15:19:19.700

默认情况下总是这样做看起来像糟糕的设计。但是捕获和抛出可能是有原因的，例如你想抛出一个不同的异常。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-20T16:07:36.637

是的，在 catch 中设置断点很方便。

另**一种更简洁的方法**是在您要抛出的对象的构造函数中设置断点。您在更接近错误源的位置看到程序状态。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-20T17:29:43.180

**在 Visual Studio 调试器中**不需要catch 子句来捕获异常。选择“调试”>“异常”，然后选择要捕获的异常，如有必要，请选择所有异常。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-20T18:07:43.230

如果您捕获一个异常并将其替换为另一个异常，您通常应该将原始异常包装在新异常中。这通常通过将旧异常传递给新异常的构造函数来完成。这样你就可以尽可能多地挖掘，找出发生了什么。不这样做的主要情况是出于安全原因需要隐藏数据。在这些情况下，您应该在清除异常数据之前尝试记录它。

我看到用新异常包装异常而不是让它们在堆栈中冒泡的基本原理是异常应该与它们来自的方法处于相同的语义级别。如果我调用 AuthenticateUser，我不想看到 SQL 异常。相反，我应该看到一些异常，其名称告诉我身份验证任务无法完成。如果我深入研究这个异常的内部异常，我就可以找到 SQL 异常。就个人而言，我仍在权衡这样做的利弊。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-20T19:14:29.350

由于零错误处理，这个捕获是无用的。如果确实进行了日志记录或某些清理工作，但在这种情况下，我会摆脱 try/catch。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-22T15:42:49.930

如果您需要检查有关异常的某些内容，并为一种情况做某事或在其他情况下抛出它，这也很有用。例如，如果您需要检查 SQLException 中的错误号。如果错误编号是您准备处理的错误编号，您可以执行特定操作。对于其他人，您可以简单地“抛出”它，以便保留堆栈跟踪，如上所述。

# c++ - 并发编程C++？

> ID：218786
> 
> 赞同：47
> 
> 时间：2008-10-20T15:16:45.523
> 
> 标签：c++, concurrency, c++11

我不断听到有关并发编程的消息。你们能否阐明它是什么以及 c++ 新标准如何促进做同样的事情？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2008-10-20T15:27:16.127

并发是关于您的代码同时执行多项操作。这通常通过显式“线程”完成，但还有其他可能性。例如，如果您在代码中使用 OpenMP 指令，那么支持 OpenMP 的编译器将自动为您生成线程。

线程是“执行线程”的缩写。在单线程 C++ 程序中，执行从 main() 开始，然后按顺序进行。在多线程程序中，第一个线程从 main 开始，但其他线程可能由应用程序启动，这些线程从用户指定的函数开始。然后这些线程同时运行，或与原始线程并行运行。

在 C++0x 中，线程是使用`std::thread`类启动的：

```
void my_function()
{
    // do stuff
}
std::thread my_thread(my_function); // run my_function in its own thread 
```

新的 C++0x 标准还支持：

*   `std::atomic<>`类模板的原子值和操作，
*   用于数据保护的互斥锁（`std::mutex`,`std::recursive_mutex`等）
*   用于轻松管理锁生命周期的锁类 ( `std::lock_guard<>`, `std::unique_lock<>`)
*   `std::lock`以及`std::try_lock`管理同时获取多个锁而不会出现死锁风险的功能
*   用于缓解等待事件的条件变量 ( `std::condition_variable`, `std::condition_variable_any`)
*   futures、promise 和打包任务来简化线程之间的数据传递，并等待一个值准备好。这解决了经典的“我如何从线程返回值”问题。
*   本地静态对象的线程安全初始化
*   `thread_local`声明线程本地数据的关键字

我在 devx.com 上的文章中对新的 C++0x 线程库进行了更详细的概述：C++0x 中的[更简单的多线程](http://www.devx.com/SpecialReports/Article/38883)

[我在我的博客](http://www.justsoftwaresolutions.co.uk/blog)上写了关于 C++ 中的多线程和并发的文章。我也在写一本关于这个主题的书：[C++ Concurrency in Action](http://www.manning.com/williams)。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-10-20T15:38:29.677

当您说“c++ 新标准如何促进”并发编程时，我假设您正在谈论即将发布的（？）C++09 标准。

目前处于草案形式的新标准支持以下有助于并发编程的项目：

*   原子类型和地址
*   一个线程类
*   thread_local 存储（几个月前刚刚添加到标准草案中）
*   互斥（互斥类）
*   条件变量——这对 Windows 来说特别好，因为条件变量很难在 Win32 中正确实现。这意味着最终微软至少应该在 MSVC++ 运行时提供对条件变量的支持，这样在 WIn32 上就很容易获得正确的条件变量语义。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-20T15:18:28.827

也许这个视频可能会为你带来一些启发:-)
[http://channel9.msdn.com/posts/Charles/The-Concurrency-Runtime-Fine-Grained-Parallelism-for-C/](http://channel9.msdn.com/posts/Charles/The-Concurrency-Runtime-Fine-Grained-Parallelism-for-C/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-20T15:19:43.880

并发性是给定进程有多个执行线程。截至今天，C++ 不直接支持它。但是，存在几个库，它们会将给定函数绑定到新的执行线程。Unix 标准是 pthreads 库。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-20T16:21:30.150

C++CSP2 - C++ 的简单并发

[http://www.cs.kent.ac.uk/projects/ofa/c++csp/](http://www.cs.kent.ac.uk/projects/ofa/c++csp/)

CSP 基于适当的并发范例，而不是线程和锁以及所有其他事后才添加的东西。

（有关并发编程语言（也基于 CSP），请参阅 Occam-Pi）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-20T16:15:48.260

我的看法略有不同，具体到编程范式的未来方向：

并发性是关于编写程序，以便在硬件支持的情况下它可以一次执行多项操作。目前，大多数语言都有相当繁重和复杂的机制来允许程序员指定这一点（例如：具有手动同步的线程、OpenMP 预处理器指令等）。

随着硬件的改进，它将水平改进（更多内核）而不是垂直改进（更快的单核）。这意味着应用程序需要具有“潜在并发性”才能使用“更快”的硬件进行扩展。语言目前正在努力发展以最好地支持这一点，以成为未来发展的最佳语言。

C++0x 正在为“旧”的并发编程方法添加更多内置支持。各种编译器供应商正在添加“新”方法，这些方法抽象线程模型并允许在运行时决定线程数量等（基于机器的硬件）；特别是对于 Microsoft，请参阅 F#、并发运行时、并行扩展等。

希望有帮助。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-07-19T02:59:33.160

这是了解并发编程的最佳文章：[并发编程](http://www.nondot.org/sabre/Mirrored/AdvProgLangDesign/finkel07.pdf)

读完之后，您将全面了解并发编程和 C++。

作为一个快速的总结，我们可以说并发编程就是做多任务处理。当一个程序被阻塞时，它可以做其他事情。通常我们在等待网络连接和处理 I/O 时会被阻塞。我们可以使用`fork()`线程库来促进并发编程。

# jquery - 有没有办法使用 jQuery 的序列化表单字段并修剪字段中的值？

> ID：218794
> 
> 赞同：4
> 
> 时间：2008-10-20T15:18:53.850
> 
> 标签：jquery, forms, serialization, trim

我有一个使用 jQuery 提交 ajax 帖子的表单，它序列化发送的表单。代码如下所示：

```
var form = $("form");
var action = form.attr("action");
var serializedForm = form.serialize();
$.post(action, serializedForm, function(data)
{
  ...
}); 
```

这里的问题是，如果一个字段有尾随空格，则序列化函数会将这些空格转换为加号 (+)，此时它们应该被剥离。

有没有办法在**不**执行以下操作的情况下修剪字段：

```
$("#name").val( jQuery.trim( $("#name") ) ); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-20T18:07:36.957

您可以尝试遍历对象并修剪所有内容。

```
//Serialize form as array
var serializedForm = form.serializeArray();
//trim values
for(var i =0, len = serializedForm.length;i<len;i++){
  serializedForm[i] = $.trim(serializedForm[i]);
}
//turn it into a string if you wish
serializedForm = $.param(serializedForm); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-20T16:16:28.460

修剪 DOM 中的所有**<input>**和**<textarea></textarea>**元素值：

```
$('input, textarea').each(function(){
    $(this).val(jQuery.trim($(this).val()));
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-03T16:58:15.710

有点晚了，但这可能是你想要的：

```
var form = $("form");
var action = form.attr("action");
var formArr = form. serializeArray();
$.each(formArr , function(i, field) {
  formArr[i].value = $.trim(field.value);
});
var serializedForm = $.param(formArr);
$.post(action, serializedForm, function(data)
{
  ...
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-20T16:17:49.487

您可以在提交之前遍历所有输入并修剪。

```
$("input, textarea").each(function(){
   $(this).val(jQuery.trim($(this).val()));
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T16:53:56.887

这些解决方案都不起作用，因为它们实际上更改了页面上的表单字段。我只想修改字段的值，而不更改用户输入的内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-20T18:40:47.407

您可以做的一件事是拥有一个带有隐藏值的单独表单，并在用户提交时将实际的、修剪过的表单值存储在隐藏值中，然后您可以序列化“隐藏”表单并发布它。只是一个想法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-12T16:26:49.953

如果您使用的 ASP.NET 每页只能有一个表单，则只能提交给定 DIV 的值，如下所示：

```
var dataString = "source=contactDiv";
dataString += getDataString(divId, "input"); // add inputs
dataString += getDataString(divId, "select"); //add select elements 
```

然后发布更新如下：

```
$.post("UpdateContact.aspx",
        dataString,
        afterUpdate,
        "json"); 
```

辅助函数

```
function afterUpdate(data){
//add some post-update info
}

function getDataString(divId, tagName) {
    var data = "";
    var elements = $("#" + divId + " " + tagName);
    for (var i = 0; i < elements.length; i++) {
        var el = elements[i];
        var name = el.name;
        var value = $(el).val();
        if (value != null && value != "undefined")
            value = $.trim(value + ""); //added "" to fix IE 6 bug for empty select     
        if (el.type == "checkbox")
            value = el.checked;
        else if (el.type == "radio" && !el.checked)
            value = "";
        if (!(value == "" || value == "undefined" || name == "" || name == "undefined"))
            data += "&" + name + "=" + escape(value);
    }

    return data;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-10-10T06:00:59.530

如果您已经包含 jquery 文件，则使用此脚本

```
var formFilters = $('input, textarea');
        formFilters.each(function(){
            $(this).val($(this).val().trim());
        }); 
```

# javascript - 在javascript中，我们如何识别对象是哈希还是数组？

> ID：218798
> 
> 赞同：83
> 
> 时间：2008-10-20T15:20:15.423
> 
> 标签：javascript

我的 JSON 调用的输出可以是 Array 或 Hash。我如何区分这两者？

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2008-10-20T15:32:16.210

**现代浏览器支持该`Array.isArray(obj)`方法。**

[有关文档和 polyfill，请参阅 MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray)。

= *2008 年的原始答案*=

您可以使用输出的构造函数属性：

```
if(output.constructor == Array){
}
else if(output.constructor == Object){
} 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2008-10-20T15:32:08.690

是对象：

```
function isObject ( obj ) {
   return obj && (typeof obj  === "object");
} 
```

是数组：

```
function isArray ( obj ) { 
  return isObject(obj) && (obj instanceof Array);
} 
```

因为数组是对象，所以您需要先测试变量是否为数组，然后再测试它是否为对象：

```
if (isArray(myObject)) {
   // do stuff for arrays
}
else if (isObject(myObject)) {
   // do stuff for objects
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-20T15:33:46.377

您的意思是“对象”而不是“哈希”吗？

```
>>> var a = [];
>>> var o = {};
>>> a instanceof Array
true
>>> o instanceof Array
false 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-05-17T21:58:21.017

我做了一个函数来确定它是否是字典。

```
exports.is_dictionary = function (obj) {
    if(!obj) return false;
    if(Array.isArray(obj)) return false;
    if(obj.constructor != Object) return false;
    return true;
};

// return true
test.equal(nsa_utils.is_dictionary({}), true);
test.equal(nsa_utils.is_dictionary({abc:123, def:456}), true);

// returns false
test.equal(nsa_utils.is_dictionary([]), false);
test.equal(nsa_utils.is_dictionary([123, 456]), false);
test.equal(nsa_utils.is_dictionary(null), false);
test.equal(nsa_utils.is_dictionary(NaN), false);
test.equal(nsa_utils.is_dictionary('hello'), false);
test.equal(nsa_utils.is_dictionary(0), false);
test.equal(nsa_utils.is_dictionary(123), false); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-20T15:32:45.430

检查对象上的“构造函数”属性。它是 Array - 它是一个数组对象。

```
变种 = {
 'b'：{长度：0}，
 'c':[1,2]
}

if (acconstructor == 数组)
   for (var i = 0; i < aclength; i++)
      警报（ac[i]）；
别的
   for (var s in ab);
      警报（ab [s]）；

```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-08-02T11:29:19.940

对于解析 json 可以派上用场:)

```
isArrayHashs = (attr) ->
  !!attr && attr.constructor == Array && isHash(attr[0])

isHash = (attr) ->
  !!attr && !$.isNumeric(attr) && attr.constructor == Object 
```

attr[0].constructor 必须是：

*   细绳
*   数字
*   大批
*   目的
*   不明确的

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-25T14:05:12.877

比对象或哈希或字典更实用和精确的术语可能是**关联数组**。对象可以应用于许多不受欢迎的对象，例如`typeof null === 'object'`或`[1,2,3] instanceof Object`。以下两个函数从 ES3 开始工作并且互斥。

```
function is_array(z) {
    return Object(z) instanceof Array;
}

console.assert(true === is_array([]));
console.assert(true === is_array([1,2,3]));
console.assert(true === is_array(new Array));
console.assert(true === is_array(Array(1,2,3)));

console.assert(false === is_array({a:1, b:2}));
console.assert(false === is_array(42));
console.assert(false === is_array("etc"));
console.assert(false === is_array(null));
console.assert(false === is_array(undefined));
console.assert(false === is_array(true));
console.assert(false === is_array(function () {})); 
```

```
function is_associative_array(z) {
    return String(z) === '[object Object]';
}

console.assert(true === is_associative_array({a:1, b:2}));
console.assert(true === is_associative_array(new function Legacy_Class(){}));
console.assert(true === is_associative_array(new class ES2015_Class{}));

console.assert(false === is_associative_array(window));
console.assert(false === is_associative_array(new Date()));
console.assert(false === is_associative_array([]));
console.assert(false === is_associative_array([1,2,3]));
console.assert(false === is_associative_array(Array(1,2,3)));
console.assert(false === is_associative_array(42));
console.assert(false === is_associative_array("etc"));
console.assert(false === is_associative_array(null));
console.assert(false === is_associative_array(undefined));
console.assert(false === is_associative_array(true));
console.assert(false === is_associative_array(function () {})); 
```

请注意这将如何将**类的实例**视为关联数组。（但不是内置类的实例，例如 Date。）

# asp.net-mvc - 缓存的正确信息是什么？什么是好的页面加载时间？

> ID：218801
> 
> 赞同：6
> 
> 时间：2008-10-20T15:20:39.103
> 
> 标签：asp.net-mvc, caching, social-networking

我正在开发一个社交网站。

从项目的第一天开始，我就一直在考虑可扩展性，我已经尽我所能对网站和查询进行了微调。

然而; 某些页面的数据量很大，我不太确定它们是否加载得尽可能快，所以我正在考虑实现一个分布式缓存解决方案。

但不太确定我应该缓存什么而不是缓存。或者，如果当前页面加载时间为 1 秒是好是坏。

最繁重的查询是获取会员信息 此查询获取所有会员的信息以及与他们相关的任何信息，例如在本网站的情况下他们的目标、博客类型条目、鼓励、照片、状态更新（如 twitter）、博客信息（用于交叉发布他们的条目) 等等等等。

无论如何，我应该缓存这些信息吗？你认为 1 秒的页面加载时间相当快吗？有些页面在 4-6 十分之一秒之间不到一秒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T15:27:57.483

典型的答案是：

*   缓存很少更新的信息。
*   不要缓存经常更改的内容。

在您的情况下，您可以将所有内容缓存在平面文件中（例如每个用户一个文件），并在相应内容更新时销毁用户缓存文件。如果缓存文件不存在，则在显示相关内容之前创建它。

现在关于加载时间（根据用户位置可能会有很大不同），这里有一些来自游戏网站 PHP 论坛的信息数字：

*   JS 加载时间：0.274
*   查询数：15
*   PHP 加载时间：0.0524
*   内存使用：1.013 MB

这被社区认为是一种很好的体验。但这是非常主观的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-20T15:28:19.477

如果可能的话，我会在应用程序的每一层实现缓存。

您可以在最高级别缓存页面，在代码级别缓存对象，并确保您的数据库在最低级别正确缓存查询和关键数据。

就您需要缓存的内容而言，任何将被重复访问的对象都应该被缓存，尤其是那些不太可能经常更改的对象。然后，您可以仅在编辑该对象时重置该对象的缓存。（注意缓存频繁更新的对象，因为在几乎每次加载时更换缓存的恒定循环会降低性能而不是提高性能）

为了衡量性能，我不会查看加载单个页面需要多长时间，而是使用谷歌搜索一些性能测量工具，因为您确实需要测试每个页面在压力下的执行速度。例如，如果您的用户信息页面很少被访问，它可能不是最大的缓存目标。您应该专注于使用最频繁的页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-20T15:25:01.107

页面加载问题已经被问到：

**对于动态的、个性化的 Web 应用程序，什么被认为是好的响应时间？**

在缓存方面，您必须衡量每次加载数据与从缓存加载所花费的时间。缓存越大，它的效率就越低。因此，您不想将太多数据加载到缓存中。我们在这里使用的是滚动缓存，一旦达到缓存大小限制，最近最少使用的数据就会被丢弃。然后根据实际性能结果调整限制。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-20T15:26:17.250

对于用户配置文件的特定数据，尽可能多地存储在 FormsAuth 票证/cookie 中。缓存（HttpContext.Current.Cache）用户特定的项目将需要每个用户在服务器上的 X 资源，与会话相同（但不那么令人头疼）。如果您可以将尽可能多的负载卸载到用户 Ticket 或 cookie（类似于 4K）中，那么您将真正帮助您的服务器在扩展时提高性能。

您应该只检索页面需要的信息位。例如，如果您正在加载博客数据，请不要加载照片。是的，它的工作量更大，但是如果您想扩展，则必须分析每个页面的需求。

确保您了解数据库查询缓存（执行计划重用）、对象缓存（Httpcontext.Cache）和页面缓存（Response.Headers[Expires]）之间的区别。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T15:31:52.730

网页设计大师文森特·弗兰德斯 ( [Vincent Flanders](http://www.webpagesthatsuck.com/) ) 建议，任何超过 4 秒的内容对于网页加载来说都太长了。我认为这是一个很好的经验法则。

就缓存或其他性能优化而言，我建议您进行一些性能测试。市场上有许多性能测试套件。测试将显示问题区域在哪里。将缓存逻辑添加到已经表现良好的东西是没有意义的。另一方面，性能问题可能会出现在您可能没有预料到的地方，涉及您可能没有考虑过缓存的数据。

我在性能测试中还发现，它可以在代码中找到发生死锁的地方，或者简单的数据库优化会有所帮助的地方。也许向表添加索引会加快页面速度，而不是添加一堆缓存逻辑。

我会保持简单，只在你需要的地方重构性能。

此外，尽早测试并经常测试。我知道很多人说要最后考虑性能，但是如果您至少在开发生命周期的早期就开始考虑它，那么您真的可以将自己编码到一个角落。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-20T16:10:49.643

一些研究表明，交互式应用程序必须在 250 毫秒内提供反馈，以免用户认为它被卡住或操作失败。不过，网络上的接受程度要高一些，并且通常由网络浏览器提供正在加载新页面的反馈。使用 AJAX，您必须注意提供某种反馈，因为浏览器不会显示正在发生的事情。

# jboss - JBoss 中的 ExceptionSorter 类是如何工作的？

> ID：218806
> 
> 赞同：3
> 
> 时间：2008-10-20T15:23:02.030
> 
> 标签：jboss, database-connection

我想知道 JBoss ExceptionSorter 类如何能够检查数据库错误。

应用程序（EJB 或持久性框架）持有对数据库 Connection 的引用，因此 SQLExceptions 会被应用程序捕获。JBoss 如何能够看到异常的内容？

JBoss 是否包装连接并拦截这些消息或类似的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-11T16:48:44.440

JBoss 为其数据源（org.jboss.resource.adapter.jdbc.local.LocalTxDataSource）使用连接池。ExceptionSorter 将 SQLException 作为参数，然后仅检查映射到某些错误的某些字符串。如果错误代表物理连接问题，那么它们看起来有点像“Socket error”或“broken pipe”。

然后，此异常排序器将返回一个表示连接状态的布尔值返回到连接池，然后连接池将无效并删除任何返回 false 的连接。

对于 Oracle 数据库：

```
<property name="exceptionSorterClassName"><value>org.jboss.resource.adapter.jdbc.vendor.OracleExceptionSorter</value></property> 
```

这适用于 Oracle 数据库。这是 ExceptionSorter 实现的代码：

[http://kickjava.com/src/org/jboss/resource/adapter/jdbc/vendor/OracleExceptionSorter.java.htm](http://kickjava.com/src/org/jboss/resource/adapter/jdbc/vendor/OracleExceptionSorter.java.htm)

我不知道连接池在何处或如何检查连接的内部编程方式。检查 JBoss 源代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T21:47:47.867

如果您曾经针对在 JBoss 中运行的代码运行调试器，而该代码具有打开的数据库连接，您会注意到该连接实际上是一个封装了真实数据库连接的 JBoss 特定类。

在某些情况下，当数据库抛出异常（例如 SQL 语法异常）时，您可以将此包装器视为堆栈跟踪中的一行。请参见下面示例中的最后一行：

```
java.sql.SQLException: ORA-00942: table or view does not exist
    at oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java:112)
    at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:331)
    at oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:288)
    at oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:745)
    at oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:216)
    at oracle.jdbc.driver.T4CPreparedStatement.executeForDescribe(T4CPreparedStatement.java:810)
    at oracle.jdbc.driver.OracleStatement.executeMaybeDescribe(OracleStatement.java:1039)
    at oracle.jdbc.driver.T4CPreparedStatement.executeMaybeDescribe(T4CPreparedStatement.java:850)
    at oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1134)
    at oracle.jdbc.driver.OraclePreparedStatement.executeInternal(OraclePreparedStatement.java:3339)
    at oracle.jdbc.driver.OraclePreparedStatement.executeQuery(OraclePreparedStatement.java:3384)
    at org.jboss.resource.adapter.jdbc.WrappedPreparedStatement.executeQuery(WrappedPreparedStatement.java:342) 
```

我想这个包装器可能会提供您建议的异常检查。

# c# - C# ADO.NET：null 和 DbNull——有更高效的语法吗？

> ID：218808
> 
> 赞同：48
> 
> 时间：2008-10-20T15:23:55.103
> 
> 标签：c#, ado.net, null, nullable, dbnull

我有一个`DateTime?`我正在尝试使用`DbParameter`. 我正在像这样创建参数：

```
DbParameter datePrm = updateStmt.CreateParameter();
datePrm.ParameterName = "@change_date"; 
```

然后我想把 s 的值`DateTime?`放入`dataPrm.Value`while 占`null`s。

起初我以为我会很聪明：

```
datePrm.Value = nullableDate ?? DBNull.Value; 
```

但这因错误而失败

> 操作员 '？？' 不能应用于“System.DateTime？”类型的操作数？和'System.DBNull'

所以我猜这只有在第二个参数是第一个参数的不可空版本时才有效。所以我去了：

```
datePrm.Value = nullableDate.HasValue ? nullableDate.Value : DBNull.Value; 
```

但这也不起作用：

> 无法确定条件表达式的类型，因为 'System.DateTime' 和 'System.DBNull' 之间没有隐式转换

但我不想在这些类型之间进行转换！

到目前为止，我唯一可以开始工作的是：

```
if (nullableDate.HasValue)
  datePrm.Value = nullableDate.Value;
else
  datePrm.Value = DBNull.Value; 
```

这真的是我写这篇文章的唯一方法吗？有没有办法让使用三元运算符的单线工作？

**更新：**我真的不明白为什么？版本不起作用。MSDN 说：

> 这 ？？运算符如果不为空则返回左操作数，否则返回右操作数。

这正是我想要的！

**Update2：**嗯，最后很明显：

```
datePrm.Value = nullableDate ?? (object)DBNull.Value; 
```

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2008-10-20T15:49:20.123

啊哈！我找到了比@Trebz 更有效的解决方案！

```
datePrm.Value = nullableDate ?? (object)DBNull.Value; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-03-25T14:23:14.227

如果您使用 SQLServer，`System.Data.SqlTypes`命名空间包含一些实用程序类，可以避免烦人的类型转换。例如，而不是这个：

```
var val = (object) "abc" ?? DBNull.Value; 
```

你可以这样写：

```
var val = "abc" ?? SqlString.Null; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-20T15:36:09.430

如果你使用它会起作用

```
datePrm.Value = nullableDate.HasValue ? (object)nullableDate.Value : DBNull.Value; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-20T15:40:04.057

如果您使用的是 C# 3.0，您可以创建一个扩展方法来轻松完成此操作：

```
public static class DBNullableExtensions
{
    public static object ToDBValue<T>(this Nullable<T> value) where T:struct
    { 
        return value.HasValue ? (object)value.Value : DBNull.Value;
    }
}

class Program
{
    static void Main(string[] args)
    {
        int? x = null;

        Console.WriteLine(  x.ToDBValue() == DBNull.Value );
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-20T15:36:13.033

我认为您第二次尝试的错误是由于 nullableDate.Value 和 DBNull.Value 是不同的类型，并且三元运算符需要在两种情况下都选择一种类型来返回。我没有测试这个的环境，但我认为这应该适合你：

```
datePrm.Value = nullableDate.HasValue ? (object)nullableDate.Value : (object)DBNull.Value; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-20T15:38:11.393

我这样做的方式是，我有一个静态实用程序类，它只是通过并检查参数值是否为空，然后我将值设置为执行 DBNull。我只是在调用 Execute 之前这样做。

# java - jmock 模拟静态方法

> ID：218813
> 
> 赞同：11
> 
> 时间：2008-10-20T15:26:04.070
> 
> 标签：java, mocking, jmock

我的代码中有一个静态方法，我想以某种方式模拟。

我正在使用 jmock。

我想我可以做到这一点的一种方法是在静态方法周围有“包装类”并模拟它，但我希望有一个更好的解决方案。

我会以错误的方式解决这个问题吗？

回馈：

我将有一个接口和类，它有一个调用静态方法的方法。它允许我通过模拟对这个包装类的调用来模拟逻辑。（即使谈论它我也觉得很脏:)）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-21T12:51:20.410

我们不支持在 jMock 中模拟静态方法，因为它不适合我们的设计方法。对于可能影响系统状态的重要功能，我们不喜欢使用静态方法。我们倾向于使用它们只是为了支持 OO 代码并使其更具可读性。这就是为什么我们将模拟静态方法视为存在问题的暗示。一个例外是它位于第三方库中，但无论如何我们可能会将其包装在更面向对象的东西中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-27T17:35:49.500

[JMockit](http://code.google.com/p/jmockit)是另一个允许模拟静态方法（以及最终方法、构造函数等）的工具包。

*在设计其他 OO 解决方案时，我认为明智地*使用静态方法没有任何问题。

例如，我喜欢使用的一种模式/习惯用法是*静态外观*，特别是为业务应用程序中的持久性子系统提供更简单易用的 API。在我看来，没有其他解决方案比以下解决方案更优雅：

```
 List<Person> peopleAboveAge = 
        find("select p from Person p where p.age >= ?", age); 
```

其中`find`方法是从仅定义静态方法的类中静态导入的`PersistenceFacade`，并封装了如何获取正确的 Session/EntityManager 实例。该解决方案对单元测试友好且灵活。我在一个使用 Hibernate 的具有 500 多个持久实体的业务应用程序中使用了它。当我们从 Hibernate 2 迁移到 Hibernate 3、从 Oracle 迁移到 Sybase 再回到 Oracle 时，以及当我们开始使用 JPA 注释而不是“hbm.xml”文件进行 ORM 映射时，静态外观会有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-04T03:53:16.337

[Powermock](http://code.google.com/p/powermock/)是 EasyMock 的扩展，允许模拟静态方法。

# .net - dropdownextender Ajax 工具包

> ID：218822
> 
> 赞同：1
> 
> 时间：2008-10-20T15:28:42.020
> 
> 标签：.net, asp.net, ajax

**当我在键盘上按“A”时，如何在 dropdownextender 中实现通过键盘转到所选项目或转到以“A”开头的项目，我需要它作为正常的下拉控件工作。** 很好的参考我从中得到了很好的想法： *[http ://www.dotnetcurry.com/ShowArticle.aspx?ID=167](http://www.dotnetcurry.com/ShowArticle.aspx?ID=167)*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-22T18:11:50.253

在下一页上，下拉菜单似乎具有我认为您正在寻找的功能。

[http://www.asp.net/AJAX/AjaxControlToolkit/Samples/ListSearch/ListSearch.aspx](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/ListSearch/ListSearch.aspx)

像这样的东西应该工作：

```
<asp:DropDownList ID="DropDownList1" runat="server" Width="100px" />

<ajaxToolkit:ListSearchExtender ID="ListSearchExtender2" runat="server"
     TargetControlID="DropDownList1" PromptCssClass="ListSearchExtenderPrompt"
     QueryPattern="Contains" QueryTimeout="2000">
</ajaxToolkit:ListSearchExtender> 
```

# java - 如何减少GridLayout中JCheckboxes之间的空间

> ID：218825
> 
> 赞同：5
> 
> 时间：2008-10-20T15:30:10.783
> 
> 标签：java, swing, layout, checkbox

我`JCheckboxes`在一列中有三个 Java，通过将容器的布局设置`JPanel`为`GridLayout(3, 1, 1, 1)`. 当我运行程序时，JCheckBoxes 之间的垂直空间太大；它看起来超过 1 个像素。由于我已经将布局中 JCheckbox 之间的垂直间距设置为 1 像素，我还能如何减少这些 JCheckbox 之间的垂直间距？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-20T17:11:37.850

`GridLayout`我使用、`BorderLayout`和进行了探索，`GridBagLayout`并且我相信应用程序中存在的任何额外垂直空间都是由于 JCheckBox 组件的大小，与布局管理器无关。下面的所有示例在布局管理器中的组件之间都没有空格。

**网格布局**

```
//Changing to 3,1,1,0 makes slightly smaller (1 pixel) gap vertically 
GridLayout layout = new GridLayout( 3, 1, 1, 0 );
JPanel main = new JPanel( layout );
main.add( new JCheckBox( "box 1" ) );
main.add( new JCheckBox( "box 2" ) );
main.add( new JCheckBox( "box 3" ) ); 
```

**网格包布局**

```
GridBagConstraints gbc = new GridBagConstraints();
JPanel main = new JPanel( new GridBagLayout() );
gbc.gridx=0;
gbc.gridy=0;
gbc.ipady=0;
main.add( new JCheckBox( "box 1" ), gbc );
gbc.gridy=1;
main.add( new JCheckBox( "box 2" ), gbc );
gbc.gridy=2;
main.add( new JCheckBox( "box 3" ), gbc ); 
```

**边框布局**

```
JPanel main = new JPanel( new BorderLayout() );
main.add( new JCheckBox( "box 1" ), BorderLayout.NORTH );
main.add( new JCheckBox( "box 2" ), BorderLayout.CENTER );
main.add( new JCheckBox( "box 3" ), BorderLayout.SOUTH ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-21T11:26:15.020

如果您设置复选框的边框有帮助吗？

```
JCheckBox checkBox = new JCheckBox();
checkBox.setBorder(BorderFactory.createEmptyBorder()); 
```

这也可能是由于 Look & Feel 的 UI 委托的渲染。您通常对此几乎没有控制权。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-21T14:50:05.357

谢谢史蒂夫和亚历克斯。你的两个回答都是正确的。通过将边框设置为空边框，我可以将复选框移近一些。

# c# - 如何检查我的 .NET 程序集是否新鲜？

> ID：218827
> 
> 赞同：3
> 
> 时间：2008-10-20T15:31:04.557
> 
> 标签：c#, .net, sharepoint, clr

全部，

我正在处理一个 SharePoint 项目，但这本身并不是一个特定于 SharePoint 的问题。我有一个已部署到 SharePoint 场的程序集，我想验证我的“最新版本”是否位于 GAC 中，或者是否存在昨天晚些时候的旧版本。这是一个测试场，所以是的，我们一直在更新版本。

无需做任何疯狂的事情，例如每次编译时更改程序集版本本身*，是否有一些程序集属性我可以检查（或在编译时设置）？

*我应该澄清一下，在 SharePoint 项目中，我们在多个位置（包括 XML 文件）对程序集的全名进行硬编码，因此更改程序集版本比您想象的要少。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-20T15:38:25.073

程序集版本是为此的预期机制，但您可以通过将 GAC 程序集的 MD5 哈希与最新版本的 MD5 进行比较来滚动自己的机制。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-20T15:47:53.043

您可以使用 AssemblyFileVersion 属性。从文档中，AssemblyFileVersion

*指示编译器为 Win32 文件版本资源使用特定版本号。Win32 文件版本不需要与程序集的版本号相同。*

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-20T16:08:22.393

您可能还想查看程序集绑定重定向。基本上，您可以在 web.config 或 app.config 中放置一些设置来告诉您的应用程序（在本例中为 SharePoint）使用特定的版本号：

更多信息： http: [//msdn.microsoft.com/en-us/library/7wd6ex19 (VS.71).aspx](http://msdn.microsoft.com/en-us/library/7wd6ex19(VS.71).aspx)

它可能不是这种情况的解决方案，但它可能在未来证明是有用的。在处理自定义 SharePoint 解决方案时，我发现它特别有用。

# ide - VS2005 IDE：自动接受代码更改建议？

> ID：218832
> 
> 赞同：0
> 
> 时间：2008-10-20T15:32:08.223
> 
> 标签：ide, visual-studio-2005

我正在将 SQL 结果中的测试数据粘贴到我的代码中。我正在使用 SQL 结果手动填充强类型数据集。但是，需要将数据类型转换为正确的数据类型。VS2005 告诉我，我需要将每个字段转换为 int、decimal、date 等，但我宁愿不必单击数百次或每次手动编写转换。

是否有一个快捷方式来做一些事情，比如导航到下一个错误，然后是另一个接受代码建议的快捷方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-20T15:44:50.163

如果我理解正确，ReSharper 可以使用 Alt+PgDn、Alt+Enter、Enter、冲洗和重复来执行此操作。我敢说其他 VS 插件也有类似的功能。

# tcp - 分配 TCP/IP 端口以供内部应用程序使用

> ID：218839
> 
> 赞同：53
> 
> 时间：2008-10-20T15:34:05.287
> 
> 标签：tcp

我编写了一个由 Windows 服务托管的 WCF 服务，它需要侦听已知的 TCP/IP 端口。我可以从什么范围内安全地分配一个端口以供我的组织内部使用？该端口将嵌入服务和使用服务的客户端的配置文件中。

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2016-07-01T09:04:23.150

端口 0-1023 是众所周知的端口，由 IANA 分配。这些只能用于公共网络上的分配协议。

端口 1024-65535 曾经被称为注册端口号（请参阅[rfc1700](http://www.rfc-editor.org/info/rfc1700 "RFC1700")），但现在分为两个区域（请参阅[rfc6335](http://www.rfc-editor.org/info/rfc6335)）。

端口 1024-49151 是用户端口，用于您自己的协议。

端口 49152-65535 是动态端口，不应指定给协议。

用户端口可用于任何协议，但数量有限，因此您的使用将与其他人在某处网络上的使用发生冲突。IANA 会记录已注册的端口号 (0-49151)。如果您的协议将在公共网络上使用，那么您需要考虑向 IANA 注册它。如果您只在自己的网络中使用它，那么请在该区域 (1024-49151) 内选择一个端口，并根据[IANA 注册](http://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml)检查该端口，以确保它没有被可以在您的网络上使用的协议使用。对于私人用途，最好选择一个分配给您知道不会使用的协议的数字，而不是选择一个未分配的数字，以便将来分配。

**不要使用动态范围内的端口号。**这些端口由操作系统动态分配，而且有些随机。如果您打开客户端连接（使用端口 = 0 的 bind()），您将从动态范围中分配一个未使用的端口。无法保证此范围内的端口对于您的协议始终是空闲的。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-10-20T15:39:30.953

从 49152 到 65535 中选择一个端口号。

IANA 发布当前分配的端口列表。

[http://www.iana.org/assignments/port-numbers](http://www.iana.org/assignments/port-numbers)

动态和/或专用端口是从 49152 到 65535 的端口。这是您应该为内部应用程序选择端口的范围。当然，可以使用属于已发布列表中未分配范围之一的任何端口。但请注意，通过从那些未分配的范围中选择端口号，并不能保证您选择的端口将来不会是保留端口。

> 不应使用未分配的端口号。在您的申请获得批准后，IANA 将为港口分配号码。

并确保您选择的端口号是可配置的，如您所说：

> 该端口将嵌入服务和使用服务的客户端的配置文件中。

如果其他一些您无法触摸的软件正在使用您的端口号，这将避免令人头疼的问题。如果发生这种情况，您只需继续在配置文件上进行更改，它就可以正常工作。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-10-20T15:59:47.683

简短的回答：避免任何高达 1023 或超过 49152 的端口，并针对您网络上的服务测试所选端口。

如果您已经采取了合理的预防措施（将端口号放在配置文件中），那么如果您以后发现冲突，它应该不会造成巨大的破坏。

但是（这样我就可以在我打字时弹出的其他建议中添加一些内容）确保您可以轻松更改！如果它在配置文件中，请使其显而易见。记录它，并在故障排除时指出它。这是一种可能出错的事情，因此如果需要更改，请使其易于调试。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-20T15:48:58.360

除了有关选择通用应用程序端口的其他建议外，我建议您在应用程序中使端口可配置。硬编码端口号是个坏主意，尤其是当您后来发现与另一个应用程序的端口冲突并需要更改您的应用程序时。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-27T01:05:29.443

请注意，请记住通过 netstat /a /n 检查这些端口，以查看其是否被其他应用程序使用。我发现 vista 使用 49152 .... 出于某些应用程序级别的原因。基本上，因为大多数系统级监听器没有实现端口共享，所以使用那些根本不使用的端口是非常安全的。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-20T15:37:17.337

这是一个很好[的常见应用程序端口列表](http://www.iss.net/security_center/advice/Exploits/Ports/)。在空槽中做出自己的选择。也许您还应该扫描您的网络以查找任何内部特殊应用程序。

通常有大量端口可用，我建议使用它们，但它们可能会被防火墙阻止。

# asp.net-mvc - 如何为 ASP.NET MVC 站点定义包罗万象的路由？

> ID：218845
> 
> 赞同：8
> 
> 时间：2008-10-20T15:36:56.467
> 
> 标签：asp.net-mvc, routes

我有一个新闻网站，其中包含按类别标记的文章。

我的控制器称为“类别”，此 URL：

> `http://mysite.com/Category/Sport`

传递`Sport`给`Index`控制器​​中的操作`Category`。

我想允许以下 URL：

> `http://mysite.com/Sport/Hockey`
> `http://mysite.com/Sport/Football`
> `http://mysite.com/Science/Evolution`

它将所有类别信息传递给`Index`控制器​​中的操作`Category`。

如何创建一个包罗万象的路线来处理所有这些并将它们分类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T15:39:57.177

[在这里](https://stackoverflow.com/questions/19941/aspnet-mvc-catch-exception-when-non-existant-controller-is-requested)，我的问题得到了很好的回应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-17T05:07:55.720

你可以这样做：

```
routes.MapRoute("Default", "{category}/{subcategory}",
    new { controller = "CategoryController", action = "Display", id = "" }
); 
```

然后在你的控制器中：

```
public class CategoryController : Controller
{
    public ActionResult Display(string category, string subcategory)
    {
        // do something here.
    }
} 
```

不要将上述任何路线用于所有路线（除非您在上述路线之前指定明确的路线，否则您不能有关于页面等）。

但是，您可以包含自定义约束以将路由限制为仅现有类别。就像是：

```
public class OnlyExistingCategoriesConstraint : IRouteConstraint
{
    public bool Match
        (
            HttpContextBase httpContext,
            Route route,
            string parameterName,
            RouteValueDictionary values,
            RouteDirection routeDirection
        )
    {
        var category = route.DataTokens["category"];
        //TODO: Look it up in your database etc

        // fake that the category exists
        return true;
    }
} 
```

您在路线中使用的是这样的：

```
routes.MapRoute("Default", 
    "{category}/{subcategory}",
    new { controller = "CategoryController", action = "Display", id = "" },
    new { categoryExists = new OnlyExistingCategoriesConstraint() }
); 
```

这样它就不会干扰您定义的其他路线。

# ruby-on-rails - 设计决策：动态添加数据问题

> ID：218848
> 
> 赞同：3
> 
> 时间：2008-10-20T15:37:21.067
> 
> 标签：ruby-on-rails

我需要让用户能够有选择地将元数据添加到文档中。另一种表述方式是，用户需要向文档中添加至少 5 个类别。

基本上我想要做的是在临时基础上动态地将元数据（或类别）添加到文档中。以下是我想到的选项：

**选项 1：** 我应该通过在数据库中动态创建新表列来做到这一点吗？

**选项 2：** 我是否应该定义 5 个名为 attirbute1、attirbute2、attirbute3、attirbute4、attirbute5 的列，然后仅在用户需要属性时使用并显示它们。

**选项 3：** 我是否应该创建一个元数据表来跟踪列以及与其关联的数据？

您认为实现这一目标的最佳方法是什么？您能想到任何其他方法来轻松添加此功能吗？问题是功能需要非常通用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-20T15:43:29.307

每个文档都有一个唯一的 DocumentID。

只需添加另一个包含三列的表：

```
文档编号
元名称
元数据
```

然后他们可以将尽可能多的元数据添加到给定的文档中。如果他们所有的文档都使用相同的元名称，那么搜索元数据就很简单了。

-亚当

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T15:45:23.530

这听起来很像标记。您可能可以修改[作为可标记](http://rubyforge.org/projects/taggable/)的行为来做您需要的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-20T16:10:59.313

您不清楚的一件事是属性的数量和/或名称是否可以更改，或者所有文档是否都相同。这会稍微改变我的建议。

假设您有一个唯一描述给定文档的对象句柄，我建议使用一个表来管理元数据。如果您有未知数量的属性和这些属性的未知名称，我建议您这样做：

```
create table DocMetaData
(
   DocumentHandle        varchar NOT NULL,
   MetaDataName          varchar NOT NULL,
   MetaDataText          varchar NOT NULL
); 
```

然后，当您拥有使用最合适名称的元数据时，您可以将其插入到此表中。如果没有行，就没有元数据。如果有元数据，您显然有该元数据的名称，以及数据本身。如果需要，您可以在元数据本身上包含可空性，尽管我可能只是将其设为空文本（例如，`default ''`），而不是空值，因为如果您选择，您会遇到奇怪的行为（不要得到您的行！）一列，它不存在，并且您没有明确要求空值行。记住，这个设计没有说明，`unique`所以你有选择权，只有当你有数据时才存储......

当然，如果所有可能的元数据属性都已知，您可以将它们拼写出来！

动态表创建是一种皇家的痛苦——我不会在这里做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T15:43:54.877

所有这些选项都是可行的，并且没有一个正确的答案。您应该权衡各种选择，并根据您的情况选择最佳解决方案。

选项 1：可行，但随着用户数量的增加，可能真的会失控。也可能对存储成本产生影响。

选项 2：可能是实施最快的解决方案，但最不可靠的解决方案和更高的维护成本。如果您需要转到 6 列，则必须添加另一列，等等。

选项 3：可能最强大的解决方案是拥有一个捕获此信息的元数据表，然后基于此元数据动态构建您的表\列。这个解决方案也可能需要最长的时间并且成本最高。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T15:46:10.363

我当然会选择选项 3：有一个名为 DocumentCategories 的表，它存储每个文档所属的类别。它不仅“更具关联性”，而且如果您的需求发生变化，它也会有所帮助：如果您决定明天想要 6 个类别怎么办？

此外，它还为您提供了更多查询选项：如果您想查看每个类别被使用了多少次，或者按类别选择文档怎么办？使用选项 3，这只是一个连接，它既快速又易于编写。选项 1 和 2 使做这样简单的事情变得非常复杂。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-20T15:46:30.393

我会选择选项3。

动态更改数据结构将变得非常难以维护，并且可能会引入一些*有趣*的错误。

拥有许多可能需要也可能不需要的列仍然会增加复杂性，因为您需要检查是否使用了每一列。另外，您仍将被限制为 5 列。

选项 3 非常灵活，并且允许增长。只需有一个引用文档的外键、一个名称列和一个值列。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-20T16:02:56.413

我会选择三张桌子。

文件（文件）

类别（定义的类别）

DocumentCategory（将文档连接到类别的链接表）

唯一的缺点是您的 dbms 可能不支持将这种设计限制为每个 Document 至少需要五个 DocumentCategories 条目的好方法，但您可以在应用程序级别强制执行此操作。

# winapi - 安全/稳健地使用 AdjustTokenPrivileges？

> ID：218854
> 
> 赞同：2
> 
> 时间：2008-10-20T15:38:15.230
> 
> 标签：winapi

我只是在编写一些代码，使用 AdjustTokenPrivileges 在 Windows 中启用 SeDebug 权限。令牌来自 OpenProcessToken；OpenThreadToken 仅在模拟时返回令牌。

我想到了几件事：

*   令牌的范围是什么？它是每个进程还是每个线程？如果我启用了一个权限，该权限是只为这个线程启用，还是为整个进程（或整个会话）启用？
*   如果范围比线程更宽，在启用或禁用它时如何避免竞争条件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T16:07:25.530

线程和进程都有自己的访问令牌 - 请参阅 MSDN 中的 OpenThreadToken 和 OpenProcessToken - 所以答案真的取决于您传递给 AdjustTokenPrileges 的令牌句柄来自哪里？

# c# - C#：使用 myObj.ToString() 时强制编译器错误

> ID：218857
> 
> 赞同：6
> 
> 时间：2008-10-20T15:38:51.517
> 
> 标签：c#, .net, inheritance, oop

我有一个包含一堆属性的类。如果程序员在该类型的对象上调用 ToString() 是错误的。以这个示例代码为例：

```
using System;

public class Foo
{
    public int ID = 123;
    public string Name = "SomeName";

    private string ToString() { return null; }
}

public class MyClass
{
    public static void Main()
    {
        Foo myObj = new Foo();
        WL("I want this to be a compiler error: {0}", myObj.ToString());
        RL();
    }

    #region Helper methods

    private static void WL(object text, params object[] args)
    {
        Console.WriteLine(text.ToString(), args);   
    }

    private static void RL()
    {
        Console.ReadLine(); 
    }

    #endregion
} 
```

您可以推断，如果大多数人希望将 ID 写为字符串，那么我应该实现 ToString 以便它返回 ID。但是，我认为这是一种不好的做法，因为程序员会“意外”获得工作代码。使用我的类的程序员应该指定他们想要什么。

相反，我想要的是如果有人调用 myObj.ToString() 以使其显示为编译时错误。我想我可以通过创建一个私有的 ToString() 函数来做到这一点，但这不起作用。

我提出这个问题的原因是我们最终得到了一个包含完全限定类名而不是 ID 的查询字符串。

所以问题是：**有没有办法“隐藏” ToString() 函数，以便在我的类的对象上调用它会导致编译器错误？**

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-10-20T15:47:10.250

**我怎么强调这个设计是多么糟糕的想法都不为过。**

`ToString()`是 .Net 中对象合同的一部分。如果您不想实现它，请不要覆盖它，而让它返回类型信息。这可能造成什么危害？

我不是故意这么消极，但我绝对是有人想要摆脱的`ToString()`。

**一些额外的点：**

1.  为什么使用这个类的程序员假定它`ToString()`会返回一个 ID？你的生态系统中的其他类是否也在这样做？可以说`ToString()`应该返回一些有意义的数据。但是你真的不应该针对`ToString()`调用的结果进行编程。 `ToString()`用于类的字符串表示，句点。这听起来像是程序员或部门之间的教育或沟通问题。

2.  以任何方式削弱`ToString()`，无论您是否可以在编译时弄清楚如何在运行时抛出异常，都会产生涟漪。我*从未*见过这样做，也不希望我使用的任何课程都会表现出这种行为。我想大多数程序员都会有同样的期望。未来使用你的课程的程序员会期待这个吗？你在路上造成了哪些错误和维护噩梦？

3.  这对依赖 IDE 或调试器有什么影响`ToString()`？

4.  当使用不绑定特定类型但在运行时使用反射提取值的数据绑定技术时，这会产生什么影响？`ToString()`如果未指定使用成员，大多数数据绑定将回退到调用对象。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-10-20T15:42:35.470

Obsolete 属性允许您执行此操作。

```
[Obsolete("Use the XYZ properties instead of .ToString() on Foobar", true)] 
```

最后的布尔值是编译器是否应该考虑使用这个成员的错误。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-20T16:11:46.240

出于几个原因，我完全不同意使用 Obsolete 属性。

首先，您现在将收到一个警告，警告您覆盖并使用 Obsolete 属性标记的 ToString() 方法：

```
 [Obsolete("dont' use", true)]
    public override string ToString()
    {
        throw new Exception("don't use");
    } 
```

产生此警告：警告 1 过时成员 'ClassLibrary1.Foo.ToString()' 覆盖非过时成员 'object.ToString()' d:\source\ClassLibrary1\ClassLibrary1\Class1.cs 11 32 ClassLibrary1

所以现在你在代码中遇到了永久警告。最重要的是，它并不能完全解决您的问题。当框架中的某些内容现在隐式调用 ToString() 时会发生什么？下面代码的结果是，ToString() 体中的代码仍然被调用：

```
 Foo myObj = new Foo();

        Console.WriteLine(myObj); 
```

所以现在你的代码中有一个警告，它实际上并没有阻止开发人员重新做同样的事情。我认为正确的做法是尝试找到一种在运行时抛出适当异常的方法，而不是试图弄乱 .net 对象契约。

在编译时发现问题的建议：我意识到我以前没有提出过解决这个问题的建议。我真的不知道你的 id 是什么格式，所以我只是猜测它是一个 int，但为什么不用查询字符串保护任何创建 url 并将 id 作为 int 传递。这样，开发人员就不会在没有编译错误的情况下意外传入一些无意义的字符串。比如这样：

```
public string CreateItemUrl(int itemId)
{
   return string.Format("someurl.aspx?id={0}", itemId);
} 
```

现在，调用这个：

```
CreateItemUrl(myObj.Id); 
```

变得比以下强类型和更不容易出错：

```
string theUrl = string.Format("someurl.aspx?id={0}", myObj); 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-20T20:37:13.833

我会采用混合方法。（嘿，不是要梳理其他答案吗？:)）

首先，创建一个返回 void 的新 ToString。没有返回值意味着他们不能使用它来获得任何意外的好代码：

```
public new void ToString() { } 
```

接下来，添加 Obsolete 属性，这样当人们调用它时，他们会收到一个警告，告诉他们 ToString 是错误的。

您不需要以这种方式覆盖 ToString，只需用无用的东西隐藏它即可。它没有返回的事实将破坏所有代码，从而在过时的消息之上导致编译器错误。

如果我直接理解您的问题，则投射到 Object 的人不是您关心的问题。您不想阻止人们调用 ToString 并获取类型信息，而是要防止他们意外地认为 ToString 提供了有用的结果。

编辑：请不要抛出异常或覆盖 ToString。当您的对象被视为对象时，这将导致“坏事”。只需使用“新”即可获得您所要求的好处，而不会破坏其他框架。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-20T15:43:25.377

使用带有公共 ToString() 函数的 override 关键字来覆盖 System.Object ToString() 方法。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-20T15:52:09.320

覆盖 ToString 以返回 string.Empty，那么您将不会有任何附加到查询字符串。默认情况下，如果您不覆盖 ToString，您将获得返回 this.GetType() 的 Object 版本，这将为您提供命名空间和类名之类的信息。

调用 ToString 似乎是一件非常合理的事情，我不想为这样做的人引发编译器错误。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-20T16:20:04.460

请考虑更改您的设计/意见:)

首先，Foo.ToString 的定义并没有为 Object.ToString() 定义一个覆盖，而是一个新的，并且应该以“new”关键字为前缀，以防止对语义的误解。或明确声明“覆盖”。恕我直言，编译器发出相应的警告。

即使你会找到一种方法来禁止调用 Foo.ToString，它也会在编译时被禁止，只有当“this”的类型已知是 Foo 或后代，但是 ((object) foo).ToString()将是一个*正确*的解决方法，因为 ToString 是 Object 接口的一种方法。

此外，阻止调用 ToString 是不可取的，因为 Debugger 使用它来呈现一个值。SY，杰克

# visual-studio-2008 - 如果我对我自己的函数使用 Javadoc 样式的注释，MS Visual Studio 2008 会显示帮助吗？

> ID：218859
> 
> 赞同：0
> 
> 时间：2008-10-20T15:39:29.987
> 
> 标签：visual-studio-2008, comments, javadoc

例如在 C# 或 JavaScript 文档中。
如果没有，在 ASP.NET 编程中使用[Javadoc注释是否有意义？](http://en.wikipedia.org/wiki/Javadoc)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-20T15:44:38.180

我很确定答案是否定的，它不会。为什么要使用 Javadoc 样式的注释而不是 XML 注释？XML 注释将由 Intellisense 引擎自动显示，还允许您通过 SandCastle 等工具创建外部文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T15:49:38.327

Scott 是正确的，您应该使用本机 XML 注释来获得您正在寻找的智能感知。就 Javascript 智能感知而言，我认为您需要为此创建一个带有 xml 注释的特殊 .js 文件（手动或动态），然后在您的 .js 文件中引用它。大多数 .js 库都包含这些特殊的 .js 注释文件，您可以参考这些文件作为示例。

# php - 如何使用 PHP 在行跨度中显示 mysql 数据？

> ID：218866
> 
> 赞同：1
> 
> 时间：2008-10-20T15:41:45.240
> 
> 标签：php, mysql, html

我有来自 MySQL 的数据，显示客户获得的所有组织，以及每个组织中员工的所有详细信息。我只想列出每个组织名称一次，即在单个单元格（行跨度）中以及该组织中的所有员工都针对此名称，例如：

```
Org1     Emp1 Name, Emp1 Phone, Emp1 Address
         Emp2 Name, Emp2 Phone, Emp2 Address

Org2     Emp1 Name, Emp1 Phone, Emp1 Address
         Emp2 Name, Emp2 Phone, Emp2 Address 
```

我如何显示这些数据，因为每个组织的雇员人数在高级是未知的，所以我不设置行跨度的值。同样，我如何为其他组织开始一行？我必须写两个查询吗？

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-20T15:50:22.897

经典的。

解决方法：仅在与前一个不同时显示名称。您甚至可以不用担心行跨度（您保留一个空单元格）。

```
$currentOrg = '';
while ($row = mysql_fetch_object($query)) {
   if ($row->org != $currentOrg) {
      echo "$row->org".
   }
   $currentorg = $row->org;
} 
```

不是最漂亮的，但很简单。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-20T15:53:21.550

```
// Get the data
$data = mysql_query('SELECT org, emp_name, emp_phone, emp_address FROM x');

// Store it all in a 2D array, keyed by org
$rows = array();
while ($row = mysql_fetch_assoc($data))
{
    // Initialise each org to an empty array (not really needed in PHP but I prefer it)
    if (empty($rows[$row['org']]))
        $rows[$row['org']] = array();

    $rows[$row['org']][] = $row;
}

// Print it out
foreach ($rows as $org => $employees)
{
    print('<tr><td rowspan="' . count($employees) . '">' . htmlentities($org) . '</td>');

    foreach ($employees as $i => $employee)
    {
        // If $i == 0, we've already printed the <tr> before the loop
        if ($i)
            print('<tr>');

        print('<td>......</td></tr>');
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T15:54:19.660

要做出正确`rowspan`的数字，您需要提前知道数字。

这给你留下了：

*   迭代查询结果两次，计算值直到它们改变
*   向数据库服务器询问计数

就个人而言，我会选择方法二。数据库服务器在计算行数方面非常有效，当有很多行要显示时，这可能会快很多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T15:54:45.650

为每个组织进行查询可能更容易（但效率较低）（加上一个查询以查找大概有多少组织）。

更好的方法是事先循环遍历数组。例如：

```
$sql = $mysqli->query('SELECT * FROM `organisation_members` ORDER BY `organisation` DESC');

if (!$sql || $sql->num_rows) {
    // No data
} else {
    $data = array();
    while ($row = $sql->fetch_assoc()) {}
        if (!array_key_exists($row['organisation'], $data)) {
            $data[$row['organisation']] = array();
        }
        $data[$row['organisation']][]['name'] = $row['name'];
        // ...
    }
    $sql->close();
    echo '<table>';
    foreach ($data as $org => $people) {
        $people_in_org = count($data[$org]) - 1;
        $counter = 0;

        echo '<tr>';
        echo '<td rowspan="' . $people_in_org + 1 . '">' . $org . '</td>';

        while ($counter < $people_in_org) {
            if (counter > 0) {
                echo '<tr>';
            }
            echo '<td>' . $people[$counter]['name'] . '</td>';
            // etc
            echo '</tr>';
        }
    }
    echo '</table>';
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T15:56:29.047

为了节省内存，您可以在 org 相同缓冲行时迭代结果集，当 org 更改时，打印当前批次并开始缓冲下一批。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-20T16:21:04.270

它不会帮助您处理行跨度，但请查看[`WITH ROLLUP`](http://dev.mysql.com/doc/refman/4.1/en/group-by-modifiers.html)修饰符。它以类似于您想要的格式返回数据。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-08T17:28:46.213

在下面的例子中使用 pear 的 HTML_Table 包怎么样，通过我也喜欢 Jrgns 的 ROLLUP 版本

```
 <?php

    require_once "HTML/Table.php";

    $table = new HTML_Table(array('border'=>'1'));
    $bo=array(
        array('6','a2','a3','a4'),
        array('1','b2','b3','b4'),
        array('1','c2','c3','c4') ,
        array('2','c2','c3','c4') ,
        array('2','c2','c3','c4') ,
        array('4','c2','c3','c4') );

    foreach ($bo as $r => $borow)
        $table->addRow($borow);

    $rsFirst=0;
    $rsLen=0; 
    foreach ($bo as $r => $borow) {
        if ($r!=0 and $borow[0]!=$prevrow[0] ) {
            //jump in values
            $table->setCellAttributes ( $rsFirst,0, array('rowspan'=>$rsLen));
            $rsFirst=$r;
            $rsLen=0;
        }
        $prevrow=$borow;
        $rsLen++; 
        if ($r==sizeof($bo) - 1) {
            $table->setCellAttributes ( $rsFirst,0, array('rowspan'=>$rsLen));
        }
    }

    echo $table->toHTML();

    ?> 
```

servas, boerl

# html - HTML 链接和可用性

> ID：218883
> 
> 赞同：5
> 
> 时间：2008-10-20T15:46:13.373
> 
> 标签：html, css, usability

网页上的链接是否应该始终加下划线？
我不认为这应该是一个硬性规定！不久前，在另一位开发人员抱怨我没有遵循 Web 标准之后，我
在我的[博客上写了一篇评论。](http://dotnetbob.blogspot.com/2007/11/links-and-usability.html)它又来了，我想知道你的想法。她的论点是，为了一致性和可用性，所有链接都必须始终加下划线。我的经理同意了，所以我在 CSS 中更改了两行，然后就完成了。我不介意做这项工作，但我认为该网站的可用性现在有所下降。有太多的事情需要你的注意力。

我应该提一下，这是一个包含许多数据输入页面的网站。有问题的链接是页面左侧标题为“菜单”的框中的导航链接。当您已经将鼠标悬停在链接上时确实会出现下划线，并且当用户将鼠标悬停在链接上时背景颜色会发生变化。我真的不敢相信我什至在讨论。当我的经理同意时，我更加震惊。

我错了吗？我还应该提出哪些其他论点？谢谢！:)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-20T15:48:21.013

我认为所有链接都需要与普通文本*区分开*来，但不一定要加下划线。菜单和导航栏在网站上是相当标准的，通常可以这样识别，所以我认为它们有点太教条了。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-20T16:54:29.227

问 Jakob Nielsen，他会说*是的，**所有**链接都必须加下划线并用蓝色*表示。不过，看看他的网站。毫无疑问，它是完全可用的，但是（他假设）它走极端来证明他的观点。

我支持这里的人，因为您首先必须清楚地区分链接和整个页面中的其他文本，但是将它们**都**加下划线可能是过度的。

我的建议：在正文中为链接加下划线，因为这些需要更多的努力才能脱颖而出。如果在悬停时带下划线，导航链接应该没问题，或者根据情况（以及您的整体设计是否足够好和一致）甚至考虑根本不给它们下划线。

最后，这一切都归结为***依赖***。你的老板刚刚就最可能的、无风险的路径达成了一致。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-20T15:48:44.273

我不认为所有链接都必须始终加下划线，但它们应该与周围的文字分开。通常，蓝色和/或下划线表示链接，但这取决于您网站的布局。

不过，我会警告您在强调非链接的内容时要非常小心。这可能会误导用户。

@Brad Wilson 提出了一个关于色差和色盲用户的好观点。我可能是错的，但我相信大多数（全部？）色盲人只能看到某些颜色之间的区别，但不是全部。也许您可以选择始终显示对比的颜色？当然，我认为使用屏幕阅读器的用户也会丢失颜色差异（可能还有其他格式属性，例如下划线）。

至少可以说，可访问性带来了许多有趣的挑战。无障碍倡导团体对这些问题有何建议？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-20T15:50:57.310

我认为你需要一个很好的理由不让链接以某种方式脱颖而出。也许不是下划线，但一眼就能看出某个东西是一个链接。没有什么比去一个新站点并在整个页面上移动鼠标试图找出应该点击什么更糟糕的了。

另见[神秘肉导航](http://www.webpagesthatsuck.com/mysterymeatnavigation.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-20T20:51:18.563

你是对的，我想。如果有一个“硬性规定”，那就是：*网页上的链接应该始终具有可供性*。

换句话说，如果用户明白他是要点击它，那么它就是可用的，即使它没有下划线。它可以看起来像一个按钮，或者一个标签（就像这个网站每个页面上的标签），或者一个带有箭头的方形菜单，或者用户从经验中识别为点击的任何其他东西。

（请记住，仅在悬停时显示可供性是*不够*的。这只是部分功劳。用户不应该将鼠标悬停在页面上并查看悬停时哪些文本“做了某事”。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-20T15:49:59.793

一般来说，链接应该加下划线（和蓝色！）。如果您不想在它们下划线，那很好，只要它们是可识别的。

给不是链接的文本加下划线比*不*给链接加下划线*要*糟糕得多。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-20T16:14:37.747

我同意，我认为下划线不应该用于任何不是链接的东西。

有些事情不需要强调。页面导航、菜单中的项目、上一个/下一个链接，特别是如果它们有箭头只是一些例子。我仍然建议在悬停时给他们下划线是强制性的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-20T16:30:41.973

最好的选择是从蓝色开始，并为链接加下划线，并且只有在你有理由这样做时才会偏离。人们期望蓝色/下划线，所以显然这将是“最好的”，特别是就正文中的链接而言。但是，建议链接*必须*是这种方式是荒谬的。我会说下划线比蓝色更重要，因为与常规文本的对比才是最重要的（对比指的是形状和重量以及颜色。

只要它看起来相当链接，人们就会认为它*是*一个链接，所以不要太担心严格遵循默认值，但是如果有疑问，使用熟悉的方法肯定是最好的方法。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-20T18:13:07.133

可用性最困难的方面是每个站点/项目都是不同的，每个元素都有不同的用途。我同意带下划线的链接促进一个可用网站的观点，但是我不认为没有下划线的链接会导致任何可用性问题，只要它们的样式能够将它们与文本或其他内容区分开来围绕它们的元素。这些是应该在设计时做出的决定；当您等到实施决定链接颜色时，您将可用性置于危险之中。设计应该经过深思熟虑并精心制作，以使导航方案对用户来说是清晰的。这是否意味着您必须在链接下划线？好吧，这取决于您的用户或观众。如果您的目标受众是精通互联网的类型，我认为在链接外观方面你有更多的灵活性。对于公共信息和/或政府网站，我倾向于使用“标准”外观。

在你的情况下，我认为你有一个非常有力的论据；有问题的链接位于一个名为“菜单”的框中，因此如果用户点击了该框中的某个项目，他们就已经预料到会发生一些事情。您可以提出的一个论点是，它为了可用性而牺牲了网站的外观和感觉，从而降低了整体用户体验。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-20T18:24:00.980

我对此的一般看法：为链接选择一种突出的颜色，使其在所有站点中保持一致。悬停时下划线仅适用于菜单、选项卡等。并且（可选）始终在段落内的链接上加下划线。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-20T18:39:25.567

链接，就像任何指定某种交互的东西一样，应该在页面的其他内容中脱颖而出。这并不一定意味着链接应该加下划线。严格遵守标准（下划线和蓝色）通过定义绝对界限来限制创新。如果您从 HCI 设计的角度来考虑它，那么用户会在视觉上被那些看起来与周围的事物不同的元素所吸引。根据您如何将不同的视觉元素布局在一起，您可以实现相同级别的功能自动感知，而无需依赖那些标准样式定义。当然，尝试重塑标准的挑战是，如果你失败了，那么你最终只会让用户感到困惑。

# c# - C# 泛型：我可以限制为一组不实现接口的类吗？

> ID：218888
> 
> 赞同：5
> 
> 时间：2008-10-20T15:47:26.867
> 
> 标签：c#, .net, generics

我有 3 个基本相同但没有实现接口的类，因为它们都来自不同的 Web 服务。

例如

*   服务1.对象1
*   服务2.对象1
*   服务 3.Object1

它们都具有相同的属性，我正在编写一些代码以使用实现我自己的接口 IObject1 的中间对象将它们相互映射

我已经使用泛型做到了这一点

```
public static T[] CreateObject1<T>(IObject1[] properties)
  where T : class, new()
{
   //Check the type is allowed
   CheckObject1Types("CreateObject1<T>(IObject1[])", typeof(T));
   return CreateObjectArray<T>(properties);
}

private static void CheckObject1Types(string method, Type type)
{
  if (type == typeof(Service1.Object1)
  || type == typeof(Service2.Object1)
  || type == typeof(Service3.Object1)
  || type == typeof(Service1.Object1[])
  || type == typeof(Service2.Object1[])
  || type == typeof(Service3.Object1[]))
  {
     return;
  }

  throw new ArgumentException("Incorrect type passed to ServiceObjectFactory::" + method + ". Type:" + type.ToString());
} 
```

我的客户端代码如下所示：

```
//properties is an array of my intermediary objects
Object1[] props = ServiceObjectFactory.CreateObject1<Object1>(properties); 
```

我想要做的是摆脱 CheckObject1Types 方法并改用约束，这样如果类型无效，我会收到构建错误，因为目前我可以使用任何类型调用此方法，并且 ArgumentException 由CheckObject1Types 方法。

所以我想做类似的事情：

```
public static T[] CreateObject1<T>(IObject1[] properties)
  where T : class, new(), Service1.Object1|Service2.Object1|Service3.Object1
{
   return CreateObjectArray<T>(properties);
} 
```

有任何想法吗？

**编辑：**我不想更改每个 Web 服务的 Reference.cs 文件，因为只需要一个队友来更新 Web 引用和 BAM！损坏的代码。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-20T16:13:16.377

假设生成的类是部分的，您可以创建一个接口，然后添加另一个部分源文件以使您生成的类实现该接口。然后你可以像往常一样通过接口进行约束。无需更改实际生成的代码:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T15:55:39.780

在 C# 中不可能像您想要的那样以“或”方式限制类列表。（事实上​​，我什至不确定它在 IL 中是否直接合法。）

您唯一的选择是继续使用 checktypes 样式函数。如果您拥有不同 Web 服务的代码，您还可以实现一个“哨兵”接口并将其用作您的约束。我知道根据框架设计指南不推荐使用哨兵接口，但它们偶尔会有它们的用途（这是其中之一）。

正如 Jon 所指出的，您可以使用 prtial 类来实现一个通用接口。如果您的 References.cs 实现了一个类：

```
namespace TestServices
{
   internal partial class Service1SoapClient : System.ServiceModel.ClientBase<T>, K
   {
   }
} 
```

然后，您将在同一命名空间中创建另一个分部类（称为 References.CommonInterface.cs），它可以存在于您的项目中的任何位置，具有以下内容：

```
namespace TestServices
{
   internal interface ICommon
   {
   }

   internal partial class Service1SoapClient : ICommonInterface
   {
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T20:34:43.790

我会编写一个转换器类，将您的三个对象中的任何一个转换为支持您想要的接口的新对象。此外，我会使用反射，因此您不必手动键入所有分配（除非它是一个小对象并且预计不会发生太大变化）。

使用反射还可以保证您希望确保对象实现新接口对象实现的任何属性，否则当您期望的属性未实现时，您可能会引发错误。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-10-20T15:58:08.187

如果您从 Web 服务中提取这些对象，您绝对可以控制所使用的类定义。它们不会凭空出现（即使您最初确实有代码生成器或视觉工作室创建它们）。仍然有一个类文件，它们必须与应用程序一起编译，您应该能够将公共接口添加到这些类定义中。

# multithreading - 当 Apache 工作者启动自己的工作者线程或进程时会发生什么？

> ID：218902
> 
> 赞同：2
> 
> 时间：2008-10-20T15:50:46.483
> 
> 标签：multithreading, apache, process

如果我将 Apache 与一组工作进程一起使用，并且其中一个启动了自己的长时间运行的进程，那么该工作进程会发生什么？Apache最终会杀死它，杀死子进程吗？那个工人会永远不可用，但继续运行吗？如果它启动一个线程而不是一个进程，它有什么不同？它在各种 Web 应用程序部署方案中有何不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-28T13:38:02.310

长期运行的进程是如何启动的？一个cgi？如果是这样，apache 工作进程将等待您的进程完成，无论需要多长时间，它都不会再提供任何请求。如果您停止 apache，工作进程将被终止。你的进程会发生什么取决于它在接收到 TERM 信号时会做什么。

# svn - 我如何自动化保持我的 TortoiseSVN 项目是最新的？

> ID：218904
> 
> 赞同：4
> 
> 时间：2008-10-20T15:50:59.760
> 
> 标签：svn, version-control, tortoisesvn, autorun

我将 TortoiseSVN 用于保存在 USB 驱动器上的 Subversion 存储库。当我从一台 PC 移动到另一台 PC 时，有没有办法自动识别文件已过期（不使用检查修改菜单）。如果能够看到我硬盘上的文件夹与存储库的文件夹不匹配，而不是看到绿色勾号，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-20T16:21:22.943

尝试在 USB 密钥的根目录中创建一个名为[“autorun.inf”的文件。](http://dailycupoftech.com/usb-drive-autoruninf-tweaking/)然后用以下几行填充它：

```
[autorun]
open=CheckForMods.bat 
```

`CheckForMods.bat`然后在根目录中创建一个批处理文件，该文件执行`svn status -u`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T15:52:47.213

创建一个批处理文件，在连接 USB 密钥时自动更新您的本地工作副本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-02-19T00:32:52.630

[http://code.google.com/p/commitmonitor/](http://code.google.com/p/commitmonitor/)

提交监视器，它有一个便携式版本，您可以将其粘贴在 USB 驱动器上

# server-side - 如何在服务器端处理多个提交

> ID：218907
> 
> 赞同：36
> 
> 时间：2008-10-20T15:51:21.053
> 
> 标签：server-side

我们都知道古老的“禁用提交按钮”技巧，但处理多个提交服务器端的最佳方法是什么？我有一个应用程序，其中只发送一次表格是绝对*关键*的 - 它处理信用卡。我现在没有写它是怎么回事，但作为一种快速修复，我使用了提交时禁用技术，但是一些禁用了 javascript 的不耐烦的用户仍然会被收取两次费用。

那么，有什么方法可以避免这种情况呢？我能想到一些——我过去使用过一些——但我想看看是否有任何“最佳实践”来解决这个问题。我正在使用 PHP，但我对概念更感兴趣。

**编辑：**我知道令牌技术，这是我过去使用过的，这个问题或多或少是看我的方法是否符合你们其他优秀程序员使用的方法。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-10-20T15:53:37.837

一种真正有效的方法是随请求一起提交令牌，并保留已使用令牌的列表。如果令牌无效，或者令牌已被处理，则中止。

令牌可以像递增的整数一样简单，存储在隐藏的文本字段中，或者您可以对其进行加密以提高安全性。通过在创建页面时生成令牌，对其进行加密，然后确认令牌已生成且尚未处理，可以使此功能更加强大。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-20T15:55:08.097

在隐藏的表单字段中包含一个随机的唯一标记。然后在后端，你可以检查它是否之前提交过。

这通常是一个好主意，因为它还可以帮助您防御 XSS 攻击。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-10-20T16:11:11.233

您也可以简单地测试是否在最后一分钟（或第二秒，取决于您的服务器的延迟）内进行了相同的事务。大多数人不会在一分钟内使用同一张卡购买两本相同的书（或其他书）。如果您在最后一分钟保留信用卡付款的缓存，并检查您将要付款的付款是否与您刚刚付款的付款相同（相同的卡号，相同的金额），您很可能会发现重复付款.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-20T16:05:00.450

我不会为此依赖任何客户端。为什么不在向客户端显示提交按钮之前为此事务服务器端生成一个唯一 ID？然后客户端必须提交这个令牌，然后你检查服务器端每个令牌都提交一次。

正如其他人所说，令牌可以是递增整数（+ 用户名）或 GUID。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-01T20:20:20.473

I am having a similar problem. After reading this, I am thinking a token might be the way to go. [This post](https://stackoverflow.com/questions/4614052/how-to-prevent-multiple-form-submission-on-multiple-clicks-in-php) shows a good example of implementation.

* * *

## 回答 #6

> 赞同：-6
> 
> 时间：2011-09-07T15:03:38.750

无需生成独特的令牌和所有爵士乐。表单验证通过后，只需将访问者重定向到另一个页面，上面写着“您的信用卡正在处理中”。如果访问者重新加载页面，他们正在重新加载重定向页面，而不是 POST 提交。

# .net - 在 c# 中将整数转换为月份名称的最佳方法？

> ID：218908
> 
> 赞同：125
> 
> 时间：2008-10-20T15:51:48.493
> 
> 标签：.net, parsing, date

有没有最好的方法将整数转换为.net 中的月份名称？

显然，我可以启动一个日期时间来对其进行字符串化并从中解析月份名称。这似乎是对时间的巨大浪费。

* * *

## 回答 #1

> 赞同：275
> 
> 时间：2008-10-20T16:01:42.563

从 DateTimeFormatInfo 尝试 GetMonthName

[http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.getmonthname.aspx](http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.getmonthname.aspx)

你可以这样做：

```
CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName(1); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-10-20T15:55:08.643

为什么不直接使用`somedatetime.ToString("MMMM")`？

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-10-20T16:00:15.653

使用正确的命名空间和对象更新：

```
//This was wrong
//CultureInfo.DateTimeFormat.MonthNames[index];

//Correct but keep in mind CurrentInfo could be null
DateTimeFormatInfo.CurrentInfo.MonthNames[index]; 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-10-20T16:00:04.470

您可以使用`Microsoft.VisualBasic`命名空间中的静态方法：

```
string monthName = Microsoft.VisualBasic.DateAndTime.MonthName(monthInt, false); 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-09-04T06:19:50.133

```
DateTime dt = new DateTime(year, month, day);
Response.Write(day + "-" + dt.ToString("MMMM") + "-" + year); 
```

这样，您的月份将按其名称而不是整数显示。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-09-18T00:21:58.733

要获得缩写的月份值，您可以使用`Enum.Parse();`

```
Enum.Parse(typeof(Month), "0"); 
```

这将产生“Jan”作为结果。

请记住，这是从零开始的索引。

# java - 将 PDF 文件从 Java Bean 返回到 JSP

> ID：218909
> 
> 赞同：1
> 
> 时间：2008-10-20T15:51:53.347
> 
> 标签：java, jsp, pdf, xsl-fo, apache-fop

**编辑：**在下面的答案中查看[我的工作代码](https://stackoverflow.com/questions/218909/returning-a-pdf-file-from-a-java-bean-to-a-jsp#221252)。

* * *

**简而言之：**我有一个 JSP 文件，它调用 Java Bean 中的方法。此方法创建一个 PDF 文件，理论上，将其返回给 JSP，以便用户可以下载它。但是，在加载 PDF 时，Adobe Reader 会出现错误：*文件不以 '%PDF-' 开头*。

**详细说明：**至此，JSP 成功调用了该方法，创建了 PDF，然后出现了 JSP，将完成的 PDF 文件提供给用户。但是，只要 Adob​​e Reader 尝试打开 PDF 文件，就会出现错误：*文件不以 '%PDF-' 开头*。只是为了更好地衡量，我有在我的桌面上创建 PDF 的方法，以便我可以检查它；当我在 Windows 中正常打开它时，它看起来很好。那么为什么 JSP 的输出不同呢？

要创建 PDF，我使用的是[Apache FOP](http://xmlgraphics.apache.org/fop)。我正在关注他们最基本的示例之一，除了将生成的 PDF 传递给 JSP 而不是简单地将其保存到本地机器。我一直在关注他们的[基本使用模式](http://xmlgraphics.apache.org/fop/0.95/embedding.html#basics)和[这个示例代码](http://svn.apache.org/viewvc/xmlgraphics/fop/trunk/examples/embedding/java/embedding/ExampleFO2PDF.java?view=markup)。

这是我的 JSP 文件：

```
<%@ taglib uri="utilTLD" prefix="util" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/xml" prefix="x" %>
<%@ page language="java" session="false" %>
<%@ page contentType="application/pdf" %>

<%-- Construct and initialise the PrintReportsBean --%>
<jsp:useBean id="printReportsBean" scope="request" class="some.package.printreports.PrintReportsBean" />
<jsp:setProperty name="printReportsBean" property="*"/>

<c:set scope="page" var="xml" value="${printReportsBean.download}"/> 
```

这是我的 Java Bean 方法：

```
//earlier in the class...
private static FopFactory fopFactory = FopFactory.newInstance();

public File getDownload() throws UtilException {

    OutputStream out = null;
    File pdf = new File("C:\\documents and settings\\me\\Desktop\\HelloWorld.pdf");
    File fo  = new File("C:\\somedirectory", "HelloWorld.fo");

    try {

        FOUserAgent foUserAgent = fopFactory.newFOUserAgent();

        out = new FileOutputStream(pdf);
        out = new BufferedOutputStream(out);

        Fop fop = fopFactory.newFop(MimeConstants.MIME_PDF, foUserAgent, out);

        TransformerFactory factory = TransformerFactory.newInstance();
        Transformer transformer = factory.newTransformer(); //identity transformer

        Source src = new StreamSource(fo);

        Result res = new SAXResult(fop.getDefaultHandler());

        transformer.transform(src, res);

        return pdf;

    } catch (Exception e) {

         throw new UtilException("Could not get download. Msg = "+e.getMessage());

    } finally {

         try {
             out.close();
         } catch (IOException io) {
             throw new UtilException("Could not close OutputStream. Msg = "+io.getMessage());
         }
    }
} 
```

我意识到这是一个非常具体的问题，但任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-20T16:02:52.373

我过去实现此类功能的方式是让 servlet 将 PDF 文件的内容作为流写入响应。我已经没有源代码了（而且我做任何 servlet/jsp 工作至少已经一年了），但这里是你可能想要尝试的：

在 servlet 中，获取响应输出流的句柄。将响应的 mime 类型更改为“application/pdf”，并让 servlet 执行示例中的文件处理。只是，不是返回 File 对象，而是让 servlet 将文件写入输出流。查看文件 i/o 的示例，只需将任何 outfile.write(...) 行替换为 responseStream.write(...) 即可。一旦刷新并关闭输出流并返回，如果我没记错的话，浏览器应该能够从响应中获取 pdf。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-21T09:08:10.213

好的，我得到了这个工作。我是这样做的：

JSP：

```
<%@ taglib uri="utilTLD" prefix="util" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/xml" prefix="x" %>
<%@ page language="java" session="false" %>
<%@ page contentType="application/pdf" %>

<%-- Construct and initialise the PrintReportsBean --%>
<jsp:useBean id="printReportsBean" scope="request" class="some.package.PrintReportsBean" />
<jsp:setProperty name="printReportsBean" property="*"/>

<%
    // get report format as input parameter     
    ServletOutputStream servletOutputStream = response.getOutputStream();

    // reset buffer to remove any initial spaces
    response.resetBuffer(); 

    response.setHeader("Content-disposition", "attachment; filename=HelloWorld.pdf");

    // check that user is authorised to download product
    printReportsBean.getDownload(servletOutputStream);
%> 
```

Java Bean 方法：

```
//earlier in the class...
private static FopFactory fopFactory = FopFactory.newInstance();

public void getDownload(ServletOutputStream servletOutputStream) throws UtilException {

    OutputStream outputStream = null;

    File fo  = new File("C:\\some\\path", "HelloWorld.fo");

    try {

        FOUserAgent foUserAgent = fopFactory.newFOUserAgent();

        outputStream = new BufferedOutputStream(servletOutputStream);

        Fop fop = fopFactory.newFop(MimeConstants.MIME_PDF, foUserAgent, outputStream);

        TransformerFactory factory = TransformerFactory.newInstance();
        Transformer transformer = factory.newTransformer(); //identity transformer

        Source src = new StreamSource(fo);

        Result res = new SAXResult(fop.getDefaultHandler());

        transformer.transform(src, res);

    } catch (Exception e) {

        throw new UtilException("Could not get download. Msg = "+e.getMessage());

    } finally {

        try {
            outputStream.close();
        } catch (IOException io) {
            throw new UtilException("Could not close OutputStream. Msg = "+io.getMessage());
        }
     }
 } 
```

感谢大家的意见！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-20T15:59:19.650

只是猜测，但是您检查过您的 JSP 页面返回的 MIME 类型吗？

编辑：如果我真的阅读了您发布的代码，我会看到您确实设置了它，所以没关系:)

编辑2：您的JSP 代码中的JSP 标记之间的换行符不会最终出现在输出流中吗？这会抛出服务器返回的响应吗？我对 PDF 的格式一无所知，但它是否取决于文件中某些位置的某些“标记”字符？（返回的错误消息听起来确实如此）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T16:42:22.260

我同意[matt b](https://stackoverflow.com/questions/218909/returning-a-pdf-file-from-a-java-bean-to-a-jsp#218942)，也许它是 JSP 标记之间的空格。尝试放置指令

```
<%@ page trimDirectiveWhitespaces="true" %> 
```

# javascript - 让 jQuery tablesorter 处理隐藏/分组的表行

> ID：218911
> 
> 赞同：12
> 
> 时间：2008-10-20T15:52:14.687
> 
> 标签：javascript, jquery, tablesorter

我有带有可扩展和可折叠记录的经典表，如果扩展显示多个子记录（作为同一个父表中的新记录，而不是某些子 div/子表）。我也在使用 tablesorter 并且非常喜欢它。

问题是 tablesorter 没有在父记录旁边保留扩展的子记录。它对它们进行排序，就好像它们是顶级的一样。因此，每次表格按列排序时，子行最终都会遍布整个地方，而不是我想要的地方。

有谁知道 tablesorter 的一个很好的扩展或特定配置，即使在排序之后，tablesorter 也可以将子行与父行分组在一起？还是我必须放弃 tablesorter 以支持其他一些 API，或者开始编写自己的小部件的丑陋过程？我是否应该避免使用基于 css 的方法来隐藏表格的单个行来表示折叠行？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-21T14:23:51.650

如果你想保留 tablesorter，这里有一个我用于此目的的**[mod](http://www.pengoworks.com/workshop/jquery/tablesorter/tablesorter.htm)**

包含它之后，您使您的第二个（可扩展子）行具有“扩展子”类，并且 tablesorter 将知道将该行与其父行（前一行）保持配对。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-02T12:28:58.837

实际上， @AdamBellare 提到[的 tablesorter](http://www.pengoworks.com/workshop/jquery/tablesorter/tablesorter.htm)模块已添加到[tablesorter v2.0.5](http://tablesorter.com/docs/)中。我已经在我的博客上记录[了如何使用该`ccsChildRow`选项。](http://wowmotty.blogspot.com/2011/06/jquery-tablesorter-missing-docs.html#cssChildRow)

另外，如果您有兴趣，我在[github上有一个](https://github.com/Mottie/tablesorter)[tablesorter 的分支，](http://mottie.github.com/tablesorter/docs/)它有很多增强功能和有用的小部件:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-21T16:41:53.540

丑陋的修复而不是使用上面的方法涉及为父行和子行指定 parentId css 类和 childId css 类，然后使用小部件重新调整。以防万一其他人遇到这个问题。这显然不是最好的代码，但它对我有用！

```
$("tbody tr[class^='parent']", table).each(function() {
 $(this).after($("tbody tr[class^='child"+$(this).attr("class").substring(6)+"']", table));
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-13T16:01:01.190

我能够通过将子 rel 属性分配给子级并将父级 rel 属性分配给父级来克服这个问题。然后我在开始时遍历表并隐藏所有子项并在排序完成后重新附加它们。我还使用切换功能来显示孩子。这是我的解决方案：

```
function lfDisplayProductInformation(id){

    if($(`[rel="child-${id}"]`).attr("hidden") === 'hidden'){
        $(`[rel="child-${id}"]`).removeAttr('hidden')
    }
    else if(!$(`[rel="child-${id}`).attr("hidden")){
        $(`[rel="child-${id}"]`).attr("hidden", true)
    }

}

$(".tablesort")
.tablesorter({
  theme: 'blue',
  showProcessing : true
})

// assign the sortStart event
.bind("sortStart",function(e, t) {
    $("tr[rel^='parent']").each(function() {
            var parentRow = $(this); 
            var tag = (parentRow.attr('rel')).split("-")[1];
            var childRow = $(`tr[rel="child-${tag}"]`)
            if(!childRow.attr("hidden")){
                childRow.attr("hidden", true)
            }
    });

})

.bind("sortEnd",function(e, t) {
    $("tr[rel^='parent']").each(function() {
            var parentRow = $(this); 
            var tag = (parentRow.attr('rel')).split("-")[1];
            var childRow = $(`tr[rel="child-${tag}"]`)
            childRow
            parentRow.after(childRow);
    });
}) 
```

# linux - Linux 命令（如 cat）读取指定数量的字符

> ID：218912
> 
> 赞同：130
> 
> 时间：2008-10-20T15:52:26.467
> 
> 标签：linux, command-line

有没有像`cat`linux这样的命令可以从文件中返回指定数量的字符？

例如，我有一个文本文件，例如：

```
Hello world
this is the second line
this is the third line 
```

我想要一些能返回前 5 个字符的东西，那就是“你好”。

谢谢

* * *

## 回答 #1

> 赞同：214
> 
> 时间：2008-10-20T15:59:09.307

`head` works too:

```
head -c 100 file  # returns the first 100 bytes in the file 
```

..will extract the first 100 bytes and return them.

What's nice about using `head` for this is that the syntax for `tail` matches:

```
tail -c 100 file  # returns the last 100 bytes in the file 
```

You can combine these to get ranges of bytes. For example, to get the *second* 100 bytes from a file, read the first 200 with `head` and use tail to get the last 100:

```
head -c 200 file | tail -c 100 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2008-10-20T17:08:39.150

You can use dd to extract arbitrary chunks of bytes.

For example,

```
dd skip=1234 count=5 bs=1 
```

would copy bytes 1235 to 1239 from its input to its output, and discard the rest.

To just get the first five bytes from standard input, do:

```
dd count=5 bs=1 
```

Note that, if you want to specify the input file name, dd has old-fashioned argument parsing, so you would do:

```
dd count=5 bs=1 if=filename 
```

Note also that dd verbosely announces what it did, so to toss that away, do:

```
dd count=5 bs=1 2>&- 
```

or

```
dd count=5 bs=1 2>/dev/null 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-10-20T15:55:37.100

[头](http://linux.die.net/man/1/head)：

## 姓名

head - 输出文件的第一部分

## 概要

**头**[*选项*]... [*文件*]...

## 描述

将每个 FILE 的前 10 行打印到标准输出。对于多个 FILE，在每个文件前面加上一个给出文件名的标题。没有 FILE，或者当 FILE 为 - 时，读取标准输入。

Mandatory arguments to long options are mandatory for short options too.
**-c**, **--bytes**=*[-]N* print the first N bytes of each file; with the leading '-', print all but the last N bytes of each file

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-20T15:58:48.277

head or tail can do it as well:

> head -c X

Prints the first X bytes (not necessarily characters if it's a UTF-16 file) of the file. tail will do the same, except for the last X bytes.

This (and cut) are portable.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-07-05T11:35:53.563

```
head -Line_number file_name | tail -1 |cut -c Num_of_chars 
```

this script gives the exact number of characters from the specific line and location, e.g.:

```
head -5 tst.txt | tail -1 |cut -c 5-8 
```

gives the chars in line 5 and chars 5 to 8 of line 5,

**Note**: `tail -1` is used to select the last line displayed by the head.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-10-23T09:22:10.993

I know the answer is in reply to a question asked 6 years ago ...

But I was looking for something similar for a few hours and then found out that: **cut -c** does exactly that, with an added bonus that you could also specify an offset.

**cut -c 1-5** will return **Hello** and **cut -c 7-11** will return **world**. No need for any other command

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-20T15:59:38.150

you could also grep the line out and then cut it like for instance:

grep 'text' filename | cut -c 1-5

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-07-01T11:47:32.077

Even though this was answered/accepted years ago, the presently accepted answer is only correct for one-byte-per-character encodings like iso-8859-1, or for the single-byte subsets of variable-byte character sets (like Latin characters within UTF-8). Even using multiple-byte splices instead would still only work for fixed-multibyte encodings like UTF-16\. Given that now UTF-8 is well on its way to being a universal standard, and when looking at [this list of languages by number of native speakers](https://en.wikipedia.org/wiki/List_of_languages_by_number_of_native_speakers#Nationalencyklopedin) and [this list of top 30 languages by native/secondary usage](http://www.vistawide.com/languages/top_30_languages.htm), it is important to point out a simple variable-byte character-friendly (not byte-based) technique, using `cut -c` and `tr`/`sed` with character-classes.

Compare the following which doubly fails due to two common Latin-centric mistakes/presumptions regarding the bytes vs. characters issue (one is `head` vs. `cut`, the other is `[a-z][A-Z]` vs. `[:upper:][:lower:]`):

```
$ printf 'Πού μπορώ να μάθω σανσκριτικά;\n' | \
$     head -c 1 | \
$     sed -e 's/[A-Z]/[a-z]/g'
[[unreadable binary mess, or nothing if the terminal filtered it]] 
```

to this (note: this worked fine on FreeBSD, but both `cut` & `tr` on GNU/Linux still mangled Greek in UTF-8 for me though):

```
$ printf 'Πού μπορώ να μάθω σανσκριτικά;\n' | \
$     cut -c 1 | \
$     tr '[:upper:]' '[:lower:]'
π 
```

> Another more recent answer had already proposed "cut", but only because of the side issue that it can be used to specify arbitrary offsets, not because of the directly relevant character vs. bytes issue.

If your `cut` doesn't handle `-c` with variable-byte encodings correctly, for "the first `X` characters" (replace `X` with your number) you could try:

*   `sed -E -e '1 s/^(.{X}).*$/\1/' -e q` - which is limited to the first line though
*   `head -n 1 | grep -E -o '^.{X}'` - which is limited to the first line and chains two commands though
*   `dd` - which has already been suggested in other answers, but is really cumbersome
*   A complicated `sed` script with sliding window buffer to handle characters spread over multiple lines, but that is probably more cumbersome/fragile than just using something like `dd`

If your `tr` doesn't handle character-classes with variable-byte encodings correctly you could try:

*   `sed -E -e 's/[[:upper:]]/\L&/g` (GNU-specific)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-09-08T17:02:39.617

Here's a simple script that wraps up using the `dd` approach mentioned here:

# extract_chars.sh

```
#!/usr/bin/env bash

function show_help()
{
  IT="
extracts characters X to Y from stdin or FILE
usage: X Y {FILE}

e.g. 

2 10 /tmp/it     => extract chars 2-10 from /tmp/it
EOF
  "
  echo "$IT"
  exit
}

if [ "$1" == "help" ]
then
  show_help
fi
if [ -z "$1" ]
then
  show_help
fi

FROM=$1
TO=$2
COUNT=`expr $TO - $FROM + 1`

if [ -z "$3" ]
then
  dd skip=$FROM count=$COUNT bs=1 2>/dev/null
else
  dd skip=$FROM count=$COUNT bs=1 if=$3 2>/dev/null 
fi 
```

# linux - 如何在 iptables 中打开一个端口以进行 RMI 访问

> ID：218920
> 
> 赞同：2
> 
> 时间：2008-10-20T15:53:38.303
> 
> 标签：linux, rmi, iptables

我正在尝试从我的 Java 应用程序连接到关闭了用于 RMI 的端口 8088 的开发服务器。我感谢有关如何打开该端口的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-28T07:28:36.550

假设

*   你想允许从任何地方访问
*   您想允许通过第一个以太网设备 (eth0) 进行访问
*   您想允许使用 tcp 访问端口 8088

那么你可以尝试运行

> iptables -I INPUT -i eth0 -p tcp --dport 8088 -j ACCEPT

作为根。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-20T16:01:01.300

Slicehost 有一些关于在 Ubuntu 上设置 iptables 的很​​好的文档：

*   [http://articles.slicehost.com/2008/4/25/ubuntu-hardy-setup-page-1](http://articles.slicehost.com/2008/4/25/ubuntu-hardy-setup-page-1)
*   [http://articles.slicehost.com/2008/9/2/mail-server-opening-ports-in-the-firewall](http://articles.slicehost.com/2008/9/2/mail-server-opening-ports-in-the-firewall)

# python - 如何在 Python 中的父进程和分叉子进程之间共享数据？

> ID：218935
> 
> 赞同：12
> 
> 时间：2008-10-20T15:57:05.957
> 
> 标签：python, fork, share

我很确定有人会使用 os.plock(op) 函数来做到这一点，但我不知道怎么做。另外，如果有更好的方法，我将不胜感激。代码片段非常受欢迎。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-20T16:26:05.163

[Subprocess](http://docs.python.org/library/subprocess)替换 os.popen、os.system、os.spawn、popen2 和 commands。[管道](http://docs.python.org/library/subprocess#replacing-shell-pipe-line)的一个简单示例是：

```
p1 = Popen(["dmesg"], stdout=PIPE)
p2 = Popen(["grep", "hda"], stdin=p1.stdout, stdout=PIPE)
output = p2.communicate()[0] 
```

您还可以使用带有 flag=MAP_SHARED 的[内存映射文件](http://docs.python.org/library/mmap.html)在进程之间共享内存。

[多处理](http://docs.python.org/library/multiprocessing.html)抽象了[管道](http://docs.python.org/library/multiprocessing.html#exchanging-objects-between-processes)和[共享内存](http://docs.python.org/library/multiprocessing.html#sharing-state-between-processes)，并提供了更高级别的接口。取自处理文档：

```
from multiprocessing import Process, Pipe

def f(conn):
    conn.send([42, None, 'hello'])
    conn.close()

if __name__ == '__main__':
    parent_conn, child_conn = Pipe()
    p = Process(target=f, args=(child_conn,))
    p.start()
    print parent_conn.recv()   # prints "[42, None, 'hello']"
    p.join() 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-20T16:30:34.250

查看 python 2.6 中新增的[多处理](http://docs.python.org/dev/library/multiprocessing.html)模块（也可用于早期版本的[pyprocessing](http://pyprocessing.berlios.de/)

这是文档中的一个示例，该示例说明了使用管道传递信息的示例：

```
from multiprocessing import Process, Pipe

def f(conn):
    conn.send([42, None, 'hello'])
    conn.close()

if __name__ == '__main__':
    parent_conn, child_conn = Pipe()
    p = Process(target=f, args=(child_conn,))
    p.start()
    print parent_conn.recv()   # prints "[42, None, 'hello']"
    p.join() 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-20T15:59:25.343

这几乎与 Python 无关！这是 Unix 进程间通信的经典示例。一个不错的选择是使用`popen()`在父进程和子进程之间打开管道，并沿着管道来回传递数据/消息。

看看这个[`subprocess`模块](http://www.python.org/doc/2.5.2/lib/module-subprocess.html)，它可以在产生子进程的同时自动设置必要的管道。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-20T16:03:59.127

你有两个选择：`os.popen*`在`os`模块中，或者你可以使用`subprocess`模块达到同样的效果。Python 手册有关于[popen](http://www.python.org/doc/2.5.2/lib/module-popen2.html "爆破")和[subprocess](http://www.python.org/doc/2.5.2/lib/module-subprocess.html "子进程")的漂亮文档和示例。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-06-14T10:02:08.640

如果您正在执行低级操作系统分叉并且真的想避免使用管道，那么也可以使用共享内存映射文件。这不像使用`subprocess`或`popen`管道那么好，但包括完整性的答案......

这里有一个[完整的例子](https://blog.schmichael.com/2011/05/15/sharing-python-data-between-processes-using-mmap/)，但基本上你可以结合[os](https://docs.python.org/2/library/os.html)文件处理和[mmap](https://docs.python.org/2/library/mmap.html)模块：

```
import mmap, os, tempfile
fd, tmpfile = tempfile.mkstemp()
os.write(fd, '\x00' * mmap.PAGESIZE)
os.lseek(fd, 0, os.SEEK_SET)
child_pid = os.fork()
if child_pid:
    buf = mmap.mmap(fd, mmap.PAGESIZE, mmap.MAP_SHARED, mmap.PROT_READ)
    os.waitpid(child_pid, 0)
    child_message = buf.readline()
    print(child_message)
    os.close(fd)
else:
    buf = mmap.mmap(fd, mmap.PAGESIZE, mmap.MAP_SHARED, mmap.PROT_WRITE)
    buf.write('testing\n')
    os.close(fd) 
```

# c++ - 简单的模型检查工具

> ID：218951
> 
> 赞同：2
> 
> 时间：2008-10-20T16:00:55.963
> 
> 标签：c++, model

是否有一个简单的模型检查工具。我计划实现一个模型检查器工具，它将分析一些预定义属性的代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-21T10:34:49.117

一个重要的工具是使用 Promela 语言的[SPIN 。](http://spinroot.com)如果你使用 LaTeX，还有[TLA+](http://research.microsoft.com/users/lamport/tla/tla.html)。

这些不会分析您的代码，但会让您为您的假设和状态转换表达一个模型，然后分析无效状态。换句话说，他们将检测模型中的问题，而不是模型的实现。

我看过[Goanna](http://ertos.nicta.com.au/publications/papers/Fehnker_HJLR_06.pdf)的演示，但我不知道它是否可用（商业或其他）；这具有实际分析您的源代码的优势。

看看你的问题，再看看你问题中的评论，听起来你真的应该先阅读一些文献。也许，[旋转模型检查器](https://rads.stackoverflow.com/amzn/click/com/0321228626)，或[指定系统](https://rads.stackoverflow.com/amzn/click/com/032114306X) （可从[Leslie Lamport 的网站](http://research.microsoft.com/users/lamport/tla/book.html)下载）。你需要重新定义你的问题，这样你就不会试图解决停机问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-20T16:17:03.873

[CBMC](http://www.cs.cmu.edu/~modelcheck/cbmc/)是我知道的一种简单的工具，它实际上在代码上运行。一般来说，模型检查是一个经过大量研究的领域，但正如人们已经评论的那样，这种广度使得很难用所提供的信息提出建议。有数以千计的 SAT 求解器、用于 HDL/状态机验证的正式工具以及大量商业静态源分析器。

无论如何，CBMC 是一个很好的工具，但不要相信我的话；这项工作的主要教员 Ed Clarke 今年获得了图灵奖 ;-)

# sql - 表连接是否会破坏访问查询中的 Order By 子句？

> ID：218969
> 
> 赞同：2
> 
> 时间：2008-10-20T16:03:58.627
> 
> 标签：sql, database, ms-access

我有一个问题让我无所适从。当我对访问数据库运行以下查询时：

```
SELECT *
FROM PreferredSpacer INNER JOIN SpacerThickness ON  PreferredSpacer.SpacerTypeID = SpacerThickness.SpacerTypeID
ORDER BY PreferredSpacer.UnitTypeID DESC 
```

（UnitTypeID 字段为文本类型）

结果并没有像正常人所期望的那样排序。就 UnitTypeID 字段而言，它们无处不在（在以“C”和“M”开头的条目之间存在以“W”开头的条目）。如果我删除连接并尝试对 PreferredSpacer 表（包含 UnitTypeID 字段）中的记录进行排序，我会得到预期的结果，所以我必须假设连接与它有关。

然而，与此同时，老实说，我无法想象像访问这样无处不在的工具会在一个相当基本的查询中出现如此明显的问题。如果我做错了什么——但是——我无法看到它可能是什么。

任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T17:07:26.033

我想到了。我们的客户用来生成有问题的访问数据库的工具错误地将 SQL 中的 varchar 字段转换为访问中的备忘录字段（而不是文本，就像我们的工具所做的那样），并且备忘录字段没有正确排序。对我来说，Access 只是默默地接受它，而不是试图表明某种备忘录不会按预期工作，这对我来说似乎很奇怪，但这就是生活。

感谢大家的回复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T16:32:41.063

是 COTR 还是 CzeroTR？否则，它看起来按要求降序排列。是不是？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-20T16:45:20.117

致 Remou：它在 O 而不是零，但即使在完整的结果集中到处都有更多的条目（我只是在这里粘贴了一部分来说明，整个东西大约有 1,000 行） .

To dummy：Sql 具有 varchar 类型，这是用于此类数据的类型。然而，访问只有文本数据类型来涵盖长字符串和短字符串。此外，order by 确实有效如果我只在 PreferredSpacer 表（包含 UnitTypeID 字段的表）上执行它，那么只有当我执行连接时它才会分崩离析。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-20T16:11:15.647

SpacerThickness 是否有 UnitTypeID 列？如果是这样，则选择中的“*”可能意味着它在 PreferredSpacer.UnitTypeID 上排序，但选择的是 SpacerThickness.UnitTypeID。尝试直接选择 PreferredSpacer.UnitTypeID。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-20T16:14:15.203

不幸的是 UnitTypeID 字段仅存在于 PreferredSpacer 表中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-20T16:29:06.000

我看不出该查询有什么问题。

连接表的大小是否可能大于访问愿意处理的大小？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-20T16:29:20.760

我试着按照你说的重写它：[编辑：这是对已删除帖子的回复，但内容仍然有效]

```
SELECT PreferredSpacer.UnitTypeID
FROM PreferredSpacer, SpacerThickness
WHERE PreferredSpacer.SpacerTypeID = SpacerThickness.SpacerTypeID
ORDER BY PreferredSpacer.UnitTypeID DESC 
```

我仍然得到相同的结果。如果这可能对任何人有帮助，这里是一些结果的 C&P。

```
CPATA
CPATA
CFRSA
CFRSA
CFRSA
CFRSA
CFRSA
CFDOT
CFDOT
CFDOT
CFDOT
CFDOT
CFDOAVSL
CFDOAVSL
CFDOAVSL
CFDOAVSL
CFDOAVSL
CFDOA
CFDOA
CFDOA
CFDOA
CFDOA
CFDIAVSL
CFDIAVSL
CFDIAVSL
CFDIAVSL
CFDIAVSL
CFDIA
CFDIA
CFDIA
CFDIA
CFDIA
CFDAT
CFDAT
CFDAT
CFDAT
CFDAT
CBPATA
CBPATA
CBPATA
CBPATA
CBPATA
CBFRSA
CBFRSA
CBFRSA
CBFRSA
CBFRSA
CAPURE
CAPURE
CAPURE
CAPURE
CAPURE
CADGU
CADGU
CADGU
CADGU
CADGU
CADGS
CADGS
CADGS
CADGS
CADGS
COTR
COTR
COTR
COTR 
```

如您所见，结果似乎没有遵循任何有意义的整体顺序。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-10-20T16:35:26.753

[谷歌](http://support.jodohost.com/showpost.php?s=c5de8ca4a52b460e8c78b60c68f84f88&p=14985&postcount=3)说：

> 您不能对 text、ntext 或 image 字段（这些字段实际上是指针）执行 ORDER BY。

它是关于 MSSQL 的，但我想这对于 Access 来说是一样的。

# sql - SQL Server 2000/2005 标识列 + 复制

> ID：218986
> 
> 赞同：1
> 
> 时间：2008-10-20T16:09:31.890
> 
> 标签：sql, sql-server-2005, sql-server-2000, replication

我已经查看了一些资源，只是想澄清并获得意见。

首先，为了完全避免任何问题，我们可以不费心将标识列用作主键，而是让它们自己生成，并以两种方式复制这些值，假设它们在创建的任何时候都是唯一的。

出于这个问题的目的，我正在谈论 2 种或更多方式复制来解决全局访问问题，并且我们确实有标识列。

现在我们正在设置事务复制，两个数据库应该相互复制。

据我了解，您为每个数据库服务器分配了一系列种子值，它将使用这些值，您知道有唯一原因您给出了不交叉的范围。那么这是否意味着在复制过程中这些值被插入到种子列中？

因此，如果您在每个服务器插入 10 行后将范围 1-10 和 11-20 分配给 2 个服务器，您将在两个数据库中都有种子 1-20？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-21T18:43:25.200

有一个选项“ [NOT FOR REPLICATION](http://msdn.microsoft.com/en-us/library/ms152529(SQL.90).aspx) ”可以应用于标识列（以及触发器和其他约束）。

在您的示例中，server1 将播种 1-10，但仅接受复制的 11-20。

设置种子的几种方法：

要么：像这样使用 NOT FOR REPLICATION 设置你的种子/增量

*   种子 1，增量 2
*   种子 2，增量 2
*   种子 -1，增量 -2
*   种子 -2，增量 -2
*   种子 1000000001，增量 2
*   种子 1000000002，增量 2
*   种子 -1000000002，增量 -2
*   种子 -1000000001，增量 -2

这为您提供 500,000,000 每台服务器的 8 台服务器

或者：添加第二个名为 ServerID 的列以提供复合键，对 ID 列使用 NOT FOR REPLICATION

对于 tinyint，这可以扩展到 256 台服务器，每台服务器 2^32 行

无论哪种方式都有效...

# python - 我如何使用来自 python 的共享点（通过肥皂？）？

> ID：218987
> 
> 赞同：10
> 
> 时间：2008-10-20T16:09:36.603
> 
> 标签：python, sharepoint, soap, ntlm, suds

我想将 Sharepoint 与 python (C-Python) 一起使用

有没有人试过这个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-03-23T09:36:12.983

我怀疑自从回答了这个问题以来，SUDS 库已经更新以处理所需的身份验证本身。在跳过各种箍之后，我发现这样做可以解决问题：

```
 from suds import WebFault
from suds.client import *
from suds.transport.https import WindowsHttpAuthenticated

user = r'SERVER\user'
password = "yourpassword"
url = "http://sharepointserver/_vti_bin/SiteData.asmx?WSDL"

ntlm = WindowsHttpAuthenticated(username = user, password = password)
client = Client(url, transport=ntlm) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-21T15:13:46.963

获取 wsdl ：

```
import sys

# we use suds -> https://fedorahosted.org/suds
from suds import WebFault
from suds.client import *
import urllib2

# my 2 url conf
# url_sharepoint,url_NTLM_authproxy 
import myconfig as my 

# build url
wsdl = '_vti_bin/SiteData.asmx?WSDL'
url = '/'.join([my.url_sharepoint,wsdl])

# we need a NTLM_auth_Proxy -> http://ntlmaps.sourceforge.net/
# follow instruction and get proxy running
proxy_handler = urllib2.ProxyHandler({'http': my.url_NTLM_authproxy })
opener = urllib2.build_opener(proxy_handler)

client = SoapClient(url, {'opener' : opener})

print client.wsdl 
```

主要（平均）问题：sharepoint-server 使用 NTLM-Auth [ :-( ] 所以我不得不使用 NTLM-Auth-Proxy

致 Rob 和 Enzondio：感谢您的提示！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-20T17:29:52.727

带有 Python 的 SOAP 非常简单。[这是 Dive Into Python 的教程](http://www.diveintopython.net/soap_web_services/index.html)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-20T17:05:58.017

SharePoint 公开了几个可用于查询和更新数据的 Web 服务。

我不确定 Python 有哪些 Web 服务工具包，但它们应该能够为这些服务构建代理而不会出现任何问题。

本文应该为您提供足够的信息以帮助您入门。

[http://www.developer.com/tech/article.php/3104621](http://www.developer.com/tech/article.php/3104621)

# sharepoint - SPWorkflowTaskProperties.ExtendedProperties 没有填充我的任务中的字段

> ID：218988
> 
> 赞同：2
> 
> 时间：2008-10-20T16:09:42.203
> 
> 标签：sharepoint, workflow, wss

我正在尝试将信息从工作流中创建的任务传递到其相应的任务表单。在 CreateTask 活动之前，我创建了一个 SPWorkflowTaskProperties 并用通常的信息（标题、分配给等）填充它。我还向 ExtendedProperties 属性添加了一些元素。但是，这些自定义属性永远不会进入任务。

我尝试将属性键设置为：

*   我的任务内容类型字段之一的 Guid；
*   我的任务内容类型字段之一的内部名称；
*   一个不相关的名称（希望将信息放入任务的属性而不是其字段）。

没有任何效果。该任务一旦创建，就只包含我设置的内置字段值。我明确添加到扩展属性的值都没有显示。

我的活动（简化）顺序如下：

*   准备任务。这是一个包含 SPWorkflowTaskProperties 的自定义活动
*   创建任务。任务属性绑定到 PrepareTask 活动中的属性。
*   OnTaskCreated。任务属性绑定到 PrepareTask 活动中的属性。
*   虽然（任务未完成）
    *   OnTaskChanged

我正在使用 WSS 3.0 SP1 和 ASPX（不是 InfoPath）任务表单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-28T01:53:01.407

我仍然不知道为什么我的原始解决方案不起作用。但我找到了一种解决方法。我现在的活动顺序是：

*   创建任务
*   OnTaskCreated
*   复制任务项。这是一个自定义活动，它将值放入我的自定义任务的字段中，然后更新任务。
*   虽然（任务未完成）
    *   OnTaskChanged

So I have to create the task, then immediately poke values into it and update.

I hope this will help some future reader of this question.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-24T03:29:59.300

You should be using a ItemMetadata.xml document as a secondary datasource that contains the definition of the fields that you want to pass to your task form. Something like:

```
<z:row xmlns:z="#RowsetSchema" 
    ows_Instructions="" 
    ows_Body=""
    ows_Comments=""
    ows_ApprovalStatus=""
/> 
```

The File name is important btw.

Notice the `ows_` (as it used the webservices all fields in the list will be prefixed with `ows`.)

Then in you infopath form, set the default value of each control you want to display this information in. Hit the fx button and insert a field or group from the secondary datasource.

A good resource: [http://weblog.vb-tech.com/nick/archive/2007/02/25/2207.aspx](http://weblog.vb-tech.com/nick/archive/2007/02/25/2207.aspx)

# java - 如何用 ant 确定构建架构（32bit / 64bit）？

> ID：218989
> 
> 赞同：18
> 
> 时间：2008-10-20T16:09:57.367
> 
> 标签：java, ant, build, 64-bit

我们继承了一个 ant 构建文件，但现在需要部署到 32 位和 64 位系统。

非 Java 位使用 GNUMakefiles 完成，我们只需调用“uname”来获取信息。有没有类似甚至更简单的方法来用蚂蚁模仿这个？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2011-01-17T02:22:45.237

Late to the party, but what the heck...

${os.arch} only tells you if the JVM is 32/64bit. You may be running the 32bit JVM on a 64bit OS. Try this:

```
<var name ="os.bitness" value ="unknown"/>
<if>
<os family="windows"/>
<then>
    <exec dir="." executable="cmd" outputproperty="command.ouput">
        <arg line="/c SET ProgramFiles(x86)"/>
    </exec>
    <if>
        <contains string="${command.ouput}" substring="Program Files (x86)"/>
        <then>
            <var name ="os.bitness" value ="64"/>
        </then>
        <else>
            <var name ="os.bitness" value ="32"/>
        </else>
    </if>
</then>
<elseif>
    <os family="unix"/>
    <then>
        <exec dir="." executable="/bin/sh" outputproperty="command.ouput">
        <arg line="/c uname -m"/>
        </exec>
        <if>
            <contains string="${command.ouput}" substring="_64"/>
            <then>
                <var name ="os.bitness" value ="64"/>
            </then>
            <else>
                <var name ="os.bitness" value ="32"/>
            </else>
        </if>
    </then>
</elseif>
</if>

<echo>OS bitness: ${os.bitness}</echo> 
```

**EDIT:** As @GreenieMeanie pointed out, this requires the ant-contrib library from ant-contrib.sourceforge.net

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-20T16:35:40.450

you can get at the java system properties ([http://java.sun.com/javase/6/docs/api/java/lang/System.html#getProperties()](http://java.sun.com/javase/6/docs/api/java/lang/System.html#getProperties())) from ant with ${os.arch}. other properties of interest might be os.name, os.version, sun.cpu.endian, and sun.arch.data.model.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-01-23T17:04:55.710

Here is an answer that works (I tested on Kubuntu 64, Debian 32, Windows 2000 and Windows XP) **without** the need of external or optional ANT dependencies. It was based on @phatypus's answer.

```
<project name="FindArchitecture" default="check-architecture" basedir=".">

    <!-- Properties set: unix-like (if it is unix or linux), x64 (if it is 64-bits),
         register- size (32 or 64) -->
    <target name="check-architecture" depends="check-family,check-register" >
        <echo>Register size: ${register-size}</echo>
        <echo>OS Family: ${os-family}</echo>
    </target>

    <target name="check-family" >
        <condition property="os-family" value="unix" else="windows">
            <os family="unix" />
        </condition>

        <condition property="unix">
            <os family="unix" />
        </condition>
    </target>

    <target name="check-register" depends="reg-unix,reg-windows">
    </target>

    <!-- Test under GNU/Linux -->
    <target name="reg-unix" if="unix">
        <exec dir="." executable="uname" outputproperty="result">
            <arg line="-m"/>
        </exec>

        <!-- String ends in 64 -->
        <condition property="x64">
            <matches string="${result}" pattern="^.*64$"/>
        </condition>

        <condition property="register-size" value="64" else="32">
            <isset property="x64"/>
        </condition>
    </target>

    <!-- Test under MS/Windows-->
    <target name="reg-windows" unless="unix">
        <!-- 64 bit Windows versions have the variable "ProgramFiles(x86)" -->
        <exec dir="." executable="cmd" outputproperty="result">
            <arg line="/c SET ProgramFiles(x86)"/>
        </exec>

    <!-- String ends in "Program Files (x86)" -->
        <condition property="x64">
            <matches string="${result}" pattern="^.*=.*Program Files \(x86\)"/>
        </condition>

        <condition property="register-size" value="64" else="32">
            <isset property="x64"/>
        </condition>
    </target> 
</project> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-20T16:21:04.393

您可以使用所需的值将参数传递到构建文件中。例如，如果您的目标是`dist`：

```
ant -Dbuild.target=32 dist 
```

或者

```
ant -Dbuild.target=64 dist 
```

然后在您的 Ant 构建脚本中，根据`${build.target}`属性的值采取不同的操作（如果未设置，您也可以使用[条件](http://ant.apache.org/manual/Tasks/condition.html)为属性设置默认值）。

或者，您可以检查[内置](http://ant.apache.org/manual/using.html#built-in-props) [系统属性](http://java.sun.com/j2se/1.3/docs/api/java/lang/System.html#getProperties())的值，例如`${os.arch}`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-20T16:25:43.933

os.arch 不太好用，另一种方法是询问JVM，例如：

```
    ~$ java -d32 测试
    2007 年 6 月 4 日星期一 07:05:00 CEST
    ~$ 回声 $?
    0
    ~$ java -d64 测试
    此平台不支持运行 64 位 JVM。
    ~$ 回声 $?
    1

```

那必须在脚本或包装器中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-02-17T01:10:18.690

BTW, the os.arch (arch property of the os tag) I got for 64-bit Linux was amd64.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-20T16:26:39.970

假设您使用 ANT 构建 Java 应用程序，为什么需要知道它是 32 位架构还是 64 位？我们总是可以将参数传递给 ant 任务。一种更简洁的方法是在调用实际构建之前以编程方式发出 Ant 使用的系统属性文件。有这个有趣的帖子[http://forums.sun.com/thread.jspa?threadID=5306174](http://forums.sun.com/thread.jspa?threadID=5306174)。

# java - 检测病毒扫描程序

> ID：218990
> 
> 赞同：0
> 
> 时间：2008-10-20T16:09:58.113
> 
> 标签：java, antivirus, h2

我们遇到了病毒扫描程序通过减慢对[H2 db](http://en.wikipedia.org/wiki/H2_(DBMS))的写入来破坏我们应用程序性能的问题。所以我们希望能够检测到任何病毒扫描程序的存在，并提醒用户注意潜在的问题。这将是问题检测结果的一部分，可以提醒用户注意特定于其系统的已知性能因素。

当前的建议是写入测试，如果磁盘写入花费了不合理的时间，则会显示警告。这确实解决了实际问题，但没有解决原因。那么，是否有任何可靠且直接的方法来检测病毒防护，而不依赖于间接影响？我们最终可能会同时做这两件事，但最好是在我们的“建议”中有所作为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-20T16:14:34.377

在 Windows Vista 上，MS 添加了一些 API 调用，以允许您查询 Windows 安全中心的状态，这应该会告诉您是否安装了 A/V 软件。显然，这不是一个特别通用的解决方案，也不是基于 Java 的解决方案，但这是我能想到的唯一方法，没有尝试安装病毒。嗯 - 不要那样做！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-20T16:14:47.200

您不能告诉病毒扫描程序不要扫描 H2 DB 文件或至少以不同方式扫描它们吗？

听起来您要解决可能更直接可修复的问题会遇到很多麻烦。（相信我……当我开始调试时，Mc Afee 过去常常将我的工作站置于锁定状态。我改为 AVG 并且效果更好。）***********