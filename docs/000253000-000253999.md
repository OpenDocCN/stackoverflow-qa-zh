# StackOverflow 问答 000253000-000253999

# .net - 了解 .NET 代码访问安全性的最佳在线阅读？

> ID：253002
> 
> 赞同：2
> 
> 时间：2008-10-31T10:00:43.700
> 
> 标签：.net, security, code-access-security

我正在考虑学习 CAS，但我需要快速掌握基本架构、性能影响以及它是否完全适合我的需求。我应该读什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T10:07:53.480

MSDN 本身在[此处](http://msdn.microsoft.com/en-us/library/930b76w0(VS.71).aspx)提供信息。

您还可以参考Microsoft 提倡的[模式和实践。](http://msdn.microsoft.com/en-us/library/aa302424.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T11:17:29.520

使用 CAS 时要记住一件非常重要的事情：很多代码（太多代码）在完全信任的情况下运行。并且在完全信任的情况下，CAS 的大部分内容都会被默默地忽略。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T11:27:55.380

基思布朗的书非常好，而且是在线的。我建议也买一本。IMO 这是每个 .NET 开发人员的必读书籍：

[.NET 开发人员的 Windows 安全指南](http://alt.pluralsight.com/wiki/default.aspx/Keith.GuideBook/HomePage.html)

# c - 如何在没有继承的情况下模拟对象（在 C 中）？

> ID：253013
> 
> 赞同：6
> 
> 时间：2008-10-31T10:06:25.263
> 
> 标签：c, unit-testing, mocking

我们在工作中为我们的低级网络代码使用一个简单的对象模型，其中结构指针被传递给伪装成方法的函数。我继承了大部分代码，这些代码充其量是由具有合格 C/C++ 经验的顾问编写的，并且我花了很多个深夜试图将代码重构为类似于合理结构的东西。

现在我想对代码进行单元测试，但考虑到我们选择的对象模型，我不知道如何模拟对象。请参见下面的示例：

示例标题（foo.h）：

```
#ifndef FOO_H_
#define FOO_H_

typedef struct Foo_s* Foo;
Foo foo_create(TcpSocket tcp_socket);
void foo_destroy(Foo foo);
int foo_transmit_command(Foo foo, enum Command command);

#endif /* FOO_H_ */ 
```

示例源（foo.c）：

```
struct Foo_s {
    TcpSocket tcp_socket;
};

Foo foo_create(TcpSocket tcp_socket)
{   
    Foo foo = NULL;

    assert(tcp_socket != NULL);

    foo = malloc(sizeof(struct Foo_s));
    if (foo == NULL) {
        goto fail;
    }
    memset(foo, 0UL, sizeof(struct Foo_s));

    foo->tcp_socket = tcp_socket;

    return foo;

fail:
    foo_destroy(foo);
    return NULL;
}

void foo_destroy(Foo foo)
{
    if (foo != NULL) {
            tcp_socket_destroy(foo->tcp_socket);
            memset(foo, 0UL, sizeof(struct Foo_s));
            free(foo);
    }
}

int foo_transmit_command(Foo foo, enum Command command)
{
    size_t len = 0;
    struct FooCommandPacket foo_command_packet = {0};

    assert(foo != NULL);
    assert((Command_MIN <= command) && (command <= Command_MAX));

    /* Serialize command into foo_command_packet struct */
    ...

    len = tcp_socket_send(foo->tcp_socket, &foo_command_packet, sizeof(foo_command_packet));
    if (len < sizeof(foo_command_packet)) {
            return -1;
    }
    return 0;
} 
```

在上面的示例中，我想模拟*TcpSocket*对象，以便我可以将*“foo_transmit_command”*带入单元测试，但我不确定如何在没有继承的情况下进行此操作。我真的不想重新设计代码以使用 vtables，除非我真的必须这样做。也许有比嘲笑更好的方法？

我的测试经验主要来自C++，我有点害怕我可能会把自己画到这里来。我将非常感谢更有经验的测试人员的任何建议。

编辑：
就像 Richard Quirk 指出的那样，我想要覆盖的实际上是对*“tcp_socket_send”*的调用，我更愿意在链接测试时不从库中删除真正的 tcp_socket_send 符号，因为它是由其他测试调用的相同的二进制。

我开始认为这个问题没有明显的解决方案..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T12:02:44.633

您可以使用宏重新定义并链接`tcp_socket_send`到. 您需要仔细选择合适的位置：`tcp_socket_send_moc``tcp_socket_send``tcp_socket_send_moc`

```
#define tcp_socket_send tcp_socket_send_moc 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-10T14:31:45.367

看看TestDept： [http ://code.google.com/p/test-dept/](http://code.google.com/p/test-dept/)

这是一个开源项目，旨在提供具有替代实现的可能性，例如函数的存根，并能够在运行时更改要使用的所述函数的实现。

这一切都是通过修改项目主页上很好地描述的目标文件来完成的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-01T17:55:44.360

或者，您可以[对嵌入式软件使用 TestApe TestApe 单元测试](http://testape.com)- 它可以做到，但请注意它仅限于 C 语言。它会像这样-->

```
int mock_foo_transmit_command(Foo foo, enum Command command) {
  VALIDATE(foo, a);
  VALIDATE(command, b);
}

void test(void) {
  EXPECT_VALIDATE(foo_transmit_command, mock_foo_transmit_command);
  foo_transmit_command(a, b);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T10:42:40.337

不确定你想达到什么目标。

您可以将所有 foo_* 函数添加为函数指针成员，`struct Foo_s`但您仍然需要显式地将指针传递给您的对象，因为`this`C 中没有隐式。但它会给您封装和多态性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T11:39:39.630

您使用的是什么操作系统？我相信您可以在 GNU/Linux 上使用 LD_PRELOAD 进行覆盖：[这张幻灯片看起来很有用。](http://uberhip.com/people/godber/interception/html/slide_5.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-09T09:54:59.957

使用宏来细化 tcp_socket_send 是好的。但是模拟只返回一种行为。或者您需要在模拟函数中实现一些变量，并在每个测试用例之前进行不同的设置。另一种方法是将 tcp_socket_send 更改为功能点。并针对不同的测试用例将其指向不同的模拟函数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-03T00:22:51.867

添加到伊利亚的答案。你可以这样做。

```
#define tcp_socket_send tcp_socket_send_moc
#include "your_source_code.c"

int tcp_socket_send_moc(...)
{ ... } 
```

我使用将源文件包含到单元测试模块中的技术，以在创建单元测试时尽量减少对源文件的修改。

# python - 如何在 Visual Studio IronPython 项目中配置导入路径

> ID：253018
> 
> 赞同：3
> 
> 时间：2008-10-31T10:08:50.623
> 
> 标签：python, visual-studio, ironpython, ironpython-studio

我已经构建了 Visual Studio 2005 SDK 附带的 IronPythonIntegration 解决方案（如[http://www.izume.com/2007/10/13/integrating-ironpython-with-visual-studio-2005](http://www.izume.com/2007/10/13/integrating-ironpython-with-visual-studio-2005)中所述），我可以现在在 Visual Studio 2005 中使用 IronPython 项目。但是，要让 Python 文件从标准库导入，我需要首先包含这两行：

```
import sys
sys.path.append('c:\Python24\lib') 
```

同样对于我希望能够从中导入的任何其他文件夹。

有谁知道设置导入路径以便所有 IronPython 项目自动选择它们的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T12:06:12.193

将操作系统中的环境变量 IRONPYTHONPATH 设置为 'c:\Python24\lib'。（或您需要的任何其他地方）。

# mfc - 即使我在 MeasureItem() 方法中指定了大小，当更改列表框的大小时，CListBox 的项目大小也会发生变化？

> ID：253026
> 
> 赞同：1
> 
> 时间：2008-10-31T10:14:06.637
> 
> 标签：mfc, ownerdrawn, clistbox

我使用了一个派生自 的类`CListBox`，并使用以下方法创建它：

```
style:WS_CHILD|WS_VISIBLE |LBS_OWNERDRAWFIXED | WS_VSCROLL | WS_HSCROLL 
```

我希望 ListBox 的项目具有固定大小，不受列表框大小的影响。所以我重写了 MeasureItem() 方法，在该方法中我指定了项目的大小，如下所示：

```
void CMyListBox::MeasureItem(LPMEASUREITEMSTRUCT lpMIS)
{
    lpMIS->itemHeight = ALBUM_ITEM_HEIGHT;
    lpMIS->itemWidth = ALBUM_ITEM_WIDTH;
} 
```

但是项目的大小会随着列表框大小的变化而变化。我的方法有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-14T14:46:18.567

参考资料中没有提到的是*每次*调整控件大小时`WM_MEASUREITEM`都会调用它。*`*_OWNERDRAWFIXED`*

 *然而，我不知道这种行为有多正式以及是否应该依赖它，但它已经在[CodeGuru](http://www.codeguru.com/Cpp/controls/listview/advanced/article.php/c1013)和谷歌上的几个论坛帖子中得到验证。

如果您不想处理该消息，则只需在第一次`OnMeasureItem()`调用中的某处设置一个私有标志，并在您下次检查它是否已设置时立即返回。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T11:19:36.473

如果您查看该`MSDN`条目，[`CListBox::MeasureItem`](http://msdn.microsoft.com/en-us/library/t7tccyw7(VS.80).aspx)您会发现它只被调用一次，除非设置了`LBS_OWNERDRAWVARIABLE`(not `LBS_OWNERDRAWFIXED`) 样式。如果我理解正确，那么这将解释您所看到的行为，因为`MeasureItem`每次控件的大小更改时都需要调用它。

另外，您是否考虑过[MFC 技术说明 14：自定义控件](http://msdn.microsoft.com/en-us/library/bk2h3c6w(VS.80).aspx)中提出的要点？

# if-statement - 格式化具有多个条件的 if 语句的最佳方法

> ID：253030
> 
> 赞同：92
> 
> 时间：2008-10-31T10:15:17.880
> 
> 标签：if-statement, formatting, language-agnostic

如果您想根据两个或多个条件执行某些代码，这是格式化该 if 语句的最佳方法？

第一个例子：-

```
if(ConditionOne && ConditionTwo && ConditionThree)
{
   Code to execute
} 
```

第二个例子：-

```
if(ConditionOne)
{
   if(ConditionTwo )
   {
     if(ConditionThree)
     {
       Code to execute
     }
   }
} 
```

这是最容易理解和阅读的，记住每个条件可能是一个长函数名或其他东西。

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2008-10-31T10:20:49.320

我更喜欢选项A

```
bool a, b, c;

if( a && b && c )
{
   //This is neat & readable
} 
```

如果您确实有特别长的变量/方法条件，则可以将它们换行

```
if( VeryLongConditionMethod(a) &&
    VeryLongConditionMethod(b) &&
    VeryLongConditionMethod(c))
{
   //This is still readable
} 
```

如果它们更复杂，那么我会考虑在 if 语句之外单独执行条件方法

```
bool aa = FirstVeryLongConditionMethod(a) && SecondVeryLongConditionMethod(a);
bool bb = FirstVeryLongConditionMethod(b) && SecondVeryLongConditionMethod(b);
bool cc = FirstVeryLongConditionMethod(c) && SecondVeryLongConditionMethod(c);

if( aa && bb && cc)
{
   //This is again neat & readable
   //although you probably need to sanity check your method names ;)
} 
```

恕我直言，选择“B”的唯一原因是，如果您`else`为每个条件运行单独的函数。

例如

```
if( a )
{
    if( b )
    {
    }
    else
    {
        //Do Something Else B
    }
}
else
{
   //Do Something Else A
} 
```

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2008-10-31T10:20:12.863

其他答案解释了为什么第一个选项通常是最好的。但是，如果您有多个条件，请考虑创建一个单独的函数（或属性）来执行选项 1 中的条件检查。这使代码更易于阅读，至少在您使用好的方法名称时是这样。

```
if(MyChecksAreOk()) { Code to execute }

...

private bool MyChecksAreOk()
{ 
    return ConditionOne && ConditionTwo && ConditionThree;
} 
```

如果条件仅依赖于局部范围变量，您可以将新函数设为静态并传入您需要的所有内容。如果有混合，请传入当地的东西。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2017-04-19T22:01:21.807

```
if (   ( single conditional expression A )
    && ( single conditional expression B )
    && ( single conditional expression C )
   )
{
   opAllABC();
}
else
{
   opNoneABC();
} 
```

以这种方式在 if-else 语句中格式化多个条件表达式：

1.  允许增强
    的可读性：首先显示的表达式中的所有二进制逻辑运算 {&&, ||}
    b．每个二元运算的两个条件操作数都很明显，因为它们垂直对齐
    c。使用缩进使嵌套的逻辑表达式操作变得明显，就像在子句中嵌套语句一样
2.  需要显式括号（不依赖于运算符优先规则
    ）这避免了常见的静态分析错误
3.  允许更轻松
    的调试
    仅使用 a // b禁用单个单一条件测试。
    在任何单个测试ceg之前或之后设置一个断点...

```
// disable any single conditional test with just a pre-pended '//'
// set a break point before any individual test
// syntax '(1 &&' and '(0 ||' usually never creates any real code
if (   1
    && ( single conditional expression A )
    && ( single conditional expression B )
    && (   0
        || ( single conditional expression C )
        || ( single conditional expression D )
       )
   )
{
   ... ;
}

else
{
   ... ;
} 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-10-31T10:23:16.697

第一个示例更“易于阅读”。

实际上，在我看来，当你必须添加一些“其他逻辑”时，你应该只使用第二个，但是对于一个简单的条件，使用第一个风格。如果您担心条件太长，您总是可以使用以下语法：

```
if(ConditionOneThatIsTooLongAndProbablyWillUseAlmostOneLine
                 && ConditionTwoThatIsLongAsWell
                 && ConditionThreeThatAlsoIsLong) { 
     //Code to execute 
} 
```

祝你好运！

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-10-31T11:07:34.500

这个问题被问到并且到目前为止已经得到了回答，好像该决定应该纯粹基于“句法”理由做出。

我想说，如何在 if 中布置多个条件的正确答案也*应该*取决于“语义”。因此，应根据“概念上”的组合情况对条件进行分解和分组。

如果两个测试真的是同一枚硬币的两个方面，例如。if (x>0) && (x<=100) 然后将它们放在同一行。如果另一个条件在概念上更遥远，例如。user.hasPermission(Admin()) 然后把它放在自己的行上

例如。

```
if user.hasPermission(Admin()) {
   if (x >= 0) && (x < 100) {
      // do something
   }
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-31T10:46:17.803

第二个是[箭头反模式](http://www.codinghorror.com/blog/archives/000486.html)的经典示例所以我会避免它......

如果您的条件太长，请将它们提取到方法/属性中。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-31T10:16:41.590

第一个更容易，因为如果您从左到右阅读，您会得到：“If something AND somethingelse AND somethingelse THEN”，这是一个易于理解的句子。第二个例子是“If something THEN if somethingelse THEN if something else THEN”，这很笨拙。

另外，考虑一下如果你想在你的子句中使用一些 OR - 你会如何在第二种风格中做到这一点？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-31T23:14:58.520

## 在 Perl 中，你可以这样做：

```
{
  ( VeryLongCondition_1 ) or last;
  ( VeryLongCondition_2 ) or last;
  ( VeryLongCondition_3 ) or last;
  ( VeryLongCondition_4 ) or last;
  ( VeryLongCondition_5 ) or last;
  ( VeryLongCondition_6 ) or last;

  # Guarded code goes here
} 
```

如果任何条件失败，它将在块之后继续。如果要在块之后定义要保留的任何变量，则需要在块之前定义它们。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2018-08-17T16:09:03.980

我已经面临这个困境很长时间了，我仍然找不到合适的解决方案。在我看来，唯一的好方法是首先尝试摆脱之前的条件，这样你就不会突然比较其中的 5 个。

如果没有其他选择，那么就像其他人建议的那样 - 将其分解为单独的名称并缩短名称或将它们分组，例如，如果所有内容都必须为真，则使用类似“如果 x 数组中没有假则运行”之类的东西。

如果一切都失败了，@Eoin Campbell 给出了很好的想法。

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2015-02-21T10:57:10.187

当条件非常复杂时，我使用以下样式（PHP 实际示例）：

```
if( $format_bool &&
    (
        ( isset( $column_info['native_type'] )
            && stripos( $column_info['native_type'], 'bool' ) !== false
        )
        || ( isset( $column_info['driver:decl_type'] )
            && stripos( $column_info['driver:decl_type'], 'bool' ) !== false
        )
        || ( isset( $column_info['pdo_type'] )
            && $column_info['pdo_type'] == PDO::PARAM_BOOL
        )
    )
) 
```

我相信它比嵌套多个级别的`if()`. 在某些情况下，您根本无法将复杂的条件分解为多个部分，否则您将不得不在`if() {...}`块中多次重复相同的语句。

我也相信在代码中添加一些“空气”总是一个好主意。它大大提高了可读性。

# php - 在 JSON 响应中转义文本的正确方法是什么？

> ID：253031
> 
> 赞同：3
> 
> 时间：2008-10-31T10:15:59.970
> 
> 标签：php, json

我正在从 PHP 生成 json。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-10-31T10:16:44.023

正确的方法是使用[json_encode()](http://www.php.net/json_encode)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T10:26:44.300

JSON 只是 Javascript 的一个子集，因此您所知道的关于在 Javascript 中转义字符串的所有内容都适用于 JSON。

是的，正确的答案是使用其中一个库函数，其中有很多：请参阅[A fully fair and balance comparison of php json library](http://gggeek.altervista.org/sw/article_20061113.html)。

# windows-mobile - 适用于 Windows Mobile 的运动传感器编程

> ID：253033
> 
> 赞同：1
> 
> 时间：2008-10-31T10:16:38.300
> 
> 标签：windows-mobile

我刚拿到一个带有嵌入式运动传感器（加速度计）的 PDA（Samsung Omnia i900），并想编写一些可以利用此功能的代码。任何指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T10:30:26.680

虽然这可能与您的设备不匹配，但这是[一篇](http://blog.enterprisemobile.com/2008/07/using-htc-diamonds-sensor-sdk-from-managed-code/)在托管代码中使用 HTC 加速度计的文章...

编辑：此 API 已[更新](http://wmpoweruser.com/?p=1232)以支持三星 Omnia。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-18T18:22:59.890

您可能想查看适用于 Windows Mobile 设备的 Samsung Accelerometer API [http://innovator.samsungmobile.com/cms/cnts/knowledge.detail.view.do?platformId=2&cntsId=4600](http://innovator.samsungmobile.com/cms/cnts/knowledge.detail.view.do?platformId=2&cntsId=4600)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T19:42:04.193

目前没有用于具有加速度计的 WM 设备的通用公共 API。

如果 WM5 或 WM6 设备具有加速度计，则任何 API 都将是设备制造商特定的，例如 HTC API。

我相信（并且不相信我的话），Mircosoft 正在为 WM7 计划一个通用的加速度计 API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T10:20:49.570

只是一个建议。也许你可以设计一个游戏，你可以通过以不同角度倾斜 PDA 将小球带到迷宫的中心。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T12:12:15.473

而不是游戏，为什么不开发沙漏？？？你也可以用它来娱乐和跟踪时间:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T12:33:23.823

如果您的设备中有 GPS 接收器，您可以参考微定位来做一些事情。例如，您可以为必须在公寓中完成的房间设置任务，然后当您走进房间时，您会收到一条消息（例如“打扫房间”）。这样的概念对公司以及任务管理都有好处。在这样做之前，您应该编写一个算法来通过读取 GPS 数据和加速度计数据来减少位置错误，这也很有趣。

# wpf - 强制数据绑定 WPF ListBox 更新的更好方法？

> ID：253036
> 
> 赞同：33
> 
> 时间：2008-10-31T10:16:52.917
> 
> 标签：wpf, data-binding, listbox, observablecollection

我有绑定到 ObservableCollection 的 WPF ListBox，当集合更改时，所有项目都会更新它们的位置。

新位置存储在集合中，但 UI 不会更新。所以我添加了以下内容：

```
 void scenarioItems_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
    {
        ToolboxListItem.UpdatePositions();
        lstScenario.ItemsSource = null;
        lstScenario.ItemsSource = ToolboxListItem.ScenarioItems;
        this.lstScenario.SelectedIndex = e.NewStartingIndex;
    } 
```

通过将 ItemsSource 设置为 null 然后再次绑定，UI 被更新，

但这可能是非常糟糕的编码：p

建议？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2008-10-31T12:15:24.623

我有一个绑定到类型对象属性的列表框，`List<MyCustomType>()`并且我验证了以下代码在更新列表时更新了列表框。

```
void On_MyObjProperty_PropertyChanged(object sender, System.ComponentModel.PropertyChangedEventArgs e)
{
   MyListBox.Items.Refresh();
} 
```

如果您仍然遇到问题，请扫描 VS IDE 输出窗口（Ctrl+W、O）并查看是否可以发现任何报告的绑定错误。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-12-05T10:33:47.477

WPF 将项目列表/集合绑定到 ListBox，但在项目更新后 UI 不刷新，已**解决**。

我只是愚蠢。虽然我已经阅读了很多关于 using`ObservableCollection<>`而不是`List<>`，但我只是继续忽略这个建议并遵循其他建议，但无济于事。回到我的书，重读。很好地解释了这`ObservableCollection<>`是必须使用的，因为当集合中的项目发生更改时，`List<>`它不提供更新其显示`INotifyCollectionChange`所需的接口。`ListBox`

这是更新的代码：

```
private ObservableCollection<StringWrapper> m_AppLog;
ObservableCollection<StringWrapper> Log { get { return m_AppLog; } } 
```

非常简单，不需要任何其他东西（例如 Refresh()）。因为 ObservableCollection 自己负责触发更改事件，所以我能够删除不必要的调用：

```
// notify bound objects
OnPropertyChanged("Log"); 
```

`ObservableCollection`不支持由未创建它的线程进行的更新。因为我的列表（显示最近错误/信息消息的可视日志）可以从不同的线程更新，所以我添加以这种方式调整我的代码，以确保使用列表自己的调度程序完成更新：

```
public void AddToLog(string message) {
    if (Thread.CurrentThread != Dispatcher.Thread) {
        // Need for invoke if called from a different thread
        Dispatcher.Invoke(
            DispatcherPriority.Normal, (ThreadStart)delegate() { AddToLog(message); });
    }
    else {
        // add this line at the top of the log
        m_AppLog.Insert(0, new StringWrapper(message));
        // ... 
```

另请注意，`ObservableCollection<>`不支持`RemoveRange()`与`List<>`. 这是从 List 切换到 ObservableCollection 时可能需要进行的调整的一部分。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-11-09T21:55:01.127

我可能遇到与您遇到的问题类似的问题，但我不确定。

我有一个`ObservableCollection<MyEntity>`和`ListBox`它的界限。但是由于某些*奇怪的原因*，当我更改列表中对象的属性时，我`ListBox`没有被更新。`MyEntity`

搜索了一段时间后，我找到了以下页面，我只需要让您知道：

[http://www.wblum.org/listbind/net3/index.html](https://web.archive.org/web/20160609072341/http://wblum.org:80/listbind/net3/index.html)

它很好地描述了`ListBox`当列表或其中的对象发生更改时您必须做什么才能更新。希望您能从中受益。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-31T10:32:35.287

昨天我遇到了同样的问题，这完全是废话:) ...不过，我不再将我的设置为 null 了。在我的场景中，我将其设置为 MyList.ToArray() （每次添加到列表之后）。

我见过多个“哦，你需要使用 ObservableList”<-- 完全是废话。

我见过多个“哦，叫‘刷新’”<——完全是废话。

请原谅我的不安，但我也希望这能奏效:)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-11-26T02:34:45.173

我知道它已经有点老了，但今天我遇到了同样的问题。我更新了 ObservableCollection 中对象的属性，但视图没有更新，但后来我发现[了这篇](https://nishantrana.me/2012/04/12/refresh-observablecollection-in-wpf/)很棒的文章。

I think it's a very clean solution to manually trigger the update of an ObservableCollection:

```
CollectionViewSource.GetDefaultView(this.myObservableCollection).Refresh(); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-04-13T15:14:48.960

这是旧东西，但是使用 ObservableCollection。如果您希望 UI 看到 ObservableCollection 的对象中属性的更新，则需要在该对象的类定义中实现 INotifyPropertyChanged。然后在每个属性的设置器中引发属性更改事件。

```
Public Class Session
Implements INotifyPropertyChanged

Public Event PropertyChanged As PropertyChangedEventHandler _
   Implements INotifyPropertyChanged.PropertyChanged

Private Sub NotifyPropertyChanged(ByVal info As String)
    RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(info))
End Sub

Private _name As String = "No name"
''' <summary>
''' Name of Session
''' </summary>
''' <value></value>
''' <returns></returns>
''' <remarks></remarks>
Public Property Name() As String
    Get
        Return _name
    End Get
    Set(ByVal value As String)
        _name = value
        NotifyPropertyChanged("Name")
    End Set
End Property 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-26T02:12:45.843

如果您有一个 ObservableList 对象，并且您正在更改这些对象内的属性，则通知不适用，因为集合没有直接更改。在更改对象属性后，我一直在强制通知，方法是使用 Insert() 将更改的对象重新添加到集合中，然后使用 RemoveAt() 删除旧副本。它不漂亮，但它有效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-10T16:05:49.410

对我来说，它看起来更像是 ListBox 和 ListView 中的错误。我绑定到 ObservableCollection，集合中的项目实现 INotifyPropertyChanged。当我动态按下“添加项目”按钮时，UI 没有显示添加的项目，但是我有一个绑定到 MyCollection.Count 的计数器控件。每次按下“添加项目”按钮时，此计数器控件都会增加。如果我调整视图大小，列表框会显示我添加的所有项目。因此，ListBox 控件上的 ItemSource 绑定已损坏。我还注意不要在任何时候创建新的 MyCollection，这会破坏绑定。嘘。

# windows - Windows 窗体，从父窗体获取属性

> ID：253038
> 
> 赞同：7
> 
> 时间：2008-10-31T10:17:55.847
> 
> 标签：windows, forms, parent, mdi, children

我有点问题。我在父表单中有一个数据表。我打开一个对话框表单，它获取数据表属性并创建一个复选框列表。这将用于导出这些列。但是当我运行应用程序时， parentform 属性为空。我已经尝试在父窗体和对话框窗体中设置它（我假设如果调用 ShowDialog() 会自动完成）。

有人可以看看我哪里出错了吗？从对话框中：

```
frmParent MyParentForm = (frmParent)this.ParentForm;
for (int i=0; i<MyParentForm.DataGridTable.Count; i++)
{
   chkListExportItems.Add(MyParentForm.DataGrid.Columns[i].Name,true);
} 
```

从父窗体：

```
frmExports MyForm = new frmExports();
MyForm.MdiParent = this;
if (MyForm.ShowDialog == DialogResult.OK)
{
   MyForm.SelectedItems // Do something
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T10:23:53.167

为您的对话框窗体提供对 DataGridTable 的引用。您可以在构造函数中传递它。您应该避免使用 Parent/ParentForm 并避免强制转换。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-31T10:41:54.800

1) "MdiParent" 是使用错误的属性。

2) 调用 MyForm.ShowDialog(this);

3）在模态表单中使用“this.Owner”。

# objective-c - #import 和@class 之间有什么区别，什么时候应该使用其中一个？

> ID：253051
> 
> 赞同：30
> 
> 时间：2008-10-31T10:21:04.093
> 
> 标签：objective-c, cocoa-touch

在过去一个月左右的时间里，我一直在自学 Objective-C（我是一名 Java 负责人），现在我的大脑已经掌握了大部分内容。目前让我感到困惑的一件事是：通过@class 导入类与执行#import 有什么区别？

一种比另一种更好，还是在某些情况下我需要使用一种而不是另一种？到目前为止，我一直在使用#import。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2008-10-31T10:58:14.627

`#import`将有问题的整个头文件带入当前文件；`#import`还包括THAT file 的任何文件。另一方面，@class（当在一行上单独使用某些类名时）只是告诉编译器“嘿，你很快就会看到一个新的标记；它是一个类，所以这样对待它）。

当您有“循环包含”的潜力时，这非常有用；即，Object1.h 引用Object2，Object2.h 引用Object1。如果您`#import`将两个文件都放入另一个文件，编译器会在尝试`#import`Object1.h 时感到困惑，查看它并看到 Object2.h；它尝试`#import`Object2.h，并看到 Object1.h 等。

另一方面，如果这些文件中的每一个都有`@class Object1;`or `@class Object2;`，那么就没有循环引用。只需确保`#import`将所需的标头实际放入您的实现 (.m) 文件中。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2008-10-31T13:53:50.480

`@class`称为*前向声明*。您基本上是在告诉编译器该类存在，但与该类无关。因此，它不知道它的超类和它声明的方法之类的东西。

作为一般规则，如果可能，请在`@class`.h 和.m 中使用。`#import`就像 Louis 说的，这将有助于加快编译时间。不过，有时您需要`#import`在标题中添加一个类。我现在能想到的案例有：

*   您正在继承另一个类
*   您正在实施一个协议

在这些情况下，您必须`#import`使用声明类或协议的头文件，因为编译器需要知道其父类和实现协议的完整类层次结构。

FWIW，您也可以转发声明协议，只要您不实现它们：

```
@protocol SomeProtocol;

@interface ...

- (id<SomeProtocol>)someMethod;

@end 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-31T13:17:48.040

您要记住的另一件事是#imports 会减慢您的编译时间，因为这意味着编译器需要提取并处理更多的头文件。这主要被预编译头文件的使用所掩盖，但我偶尔会收到一些项目，这些项目会交叉导入每个头文件，而不是在适当的情况下使用@class，并且修复它们可以提高编译时间。系统以一种微妙的方式强化了这样一个事实，即如果你只使用你真正需要的东西，事情就会变得更快。

作为一般规则，我总是在我的头文件中使用@class 声明，并且只使用#import 超类。这符合 Ben 的建议，但我认为值得注意的是，即使您不担心循环引用，如果可以的话，最好在头文件中限制 #imports。

# git - 如何将修改后的提交推送到远程 Git 存储库？

> ID：253055
> 
> 赞同：770
> 
> 时间：2008-10-31T10:23:14.497
> 
> 标签：git, git-commit, git-amend

当我对我的源代码做了一些工作后，我做了我通常的事情提交，然后我推送到一个远程存储库。但后来我注意到我忘记在源代码中组织我的导入。所以我执行了修改命令来替换之前的提交：

```
> git commit --amend 
```

不幸的是，提交不能被推回存储库。它被这样拒绝：

```
> git push origin
To //my.remote.repo.com/stuff.git/
 ! [rejected]        master -> master (non-fast forward)
error: failed to push some refs to '//my.remote.repo.com/stuff.git/' 
```

我该怎么办？（我可以访问远程存储库。）

* * *

## 回答 #1

> 赞同：576
> 
> 时间：2009-01-11T07:36:32.787

实际上，我曾经推送`--force`和`.git`存储库并被 Linus **BIG TIME**责骂。一般来说，这会给其他人带来很多问题。一个简单的答案是“不要这样做”。

无论如何，我看到其他人给出了这样做的秘诀，所以我不会在这里重复。但是，在您使用--force（或+master）推出修改后的提交*后*，这里有一个提示可以从这种情况中恢复过来。

1.  用于`git reflog`查找您修改的旧提交（调用它`old`，我们将调用您通过 amending 创建的新提交`new`）。
2.  `old`在和之间创建一个合并`new`，记录 的树`new`，就像`git checkout new && git merge -s ours old`。
3.  将它与你的主人合并`git merge master`
4.  用结果更新你的主人`git push . HEAD:master`
5.  将结果推出。

然后那些不幸的人将他们的工作建立在你通过修改和强制推送而抹杀的提交上，他们会看到结果合并会看到你更`new`喜欢`old`. 他们后来的合并不会看到你的修改导致的`old`和之间的冲突`new`，所以他们不必受苦。

* * *

## 回答 #2

> 赞同：305
> 
> 时间：2008-10-31T21:58:00.533

您正在看到 Git 安全功能。Git 拒绝使用您的分支更新远程分支，因为您的分支的头部提交不是您要推送到的分支的当前头部提交的直接后代。

如果不是这种情况，那么两个人几乎同时推送到同一个存储库将不知道有一个新的提交同时进入，最后推送的人将失去前一个推送者的工作，而没有任何一个他们意识到这一点。

如果您知道您是唯一推送的人，并且您想要推送修改后的提交或推送回滚分支的提交，您可以使用`-f`开关“强制”Git 更新远程分支。

```
git push -f origin master 
```

即使这也可能不起作用，因为 Git 允许远程存储库通过使用配置变量在远端拒绝非快进推送`receive.denynonfastforwards`。如果是这种情况，拒绝原因将如下所示（注意“远程拒绝”部分）：

```
 ! [remote rejected] master -> master (non-fast forward) 
```

为了解决这个问题，您要么需要更改远程存储库的配置，要么作为一个肮脏的黑客，您可以删除并重新创建分支：

```
git push origin :master
git push origin master 
```

通常，最后一个参数`git push`使用 format `<local_ref>:<remote_ref>`，其中`local_ref`是本地存储库上`remote_ref`的分支名称，是远程存储库上的分支名称。此命令对使用两个速记。`:master`有一个空的local_ref，这意味着将一个空分支推送到远程端`master`，即删除远程分支。没有的分支名称`:`意味着将具有给定名称的本地分支推送到具有相同名称的远程分支。`master`在这种情况下是`master:master`.

* * *

## 回答 #3

> 赞同：234
> 
> 时间：2009-09-22T10:46:04.907

快速咆哮：没有人在这里发布简单的答案这一事实表明 Git CLI 表现出绝望的用户敌意。

无论如何，假设您没有尝试强制推动，那么执行此操作的“明显”方法是先拉动。这会拉动您修改（因此不再拥有）的更改，以便您再次拥有它。

解决任何冲突后，您可以再次推送。

所以：

```
git pull 
```

如果您在拉取时遇到错误，则可能是您的本地存储库配置有问题（我在 .git/config 分支部分有错误的引用）。

之后

```
git push 
```

也许你会得到一个额外的提交，主题是关于“琐碎合并”。

* * *

## 回答 #4

> 赞同：121
> 
> 时间：2008-10-31T14:35:12.097

简短的回答：不要将修改后的提交推送到公共回购。

长答案：一些 Git 命令，比如`git commit --amend`and `git rebase`，实际上重写了历史图。只要你没有发布你的更改就可以了，但是一旦你这样做了，你真的不应该在历史上乱七八糟，因为如果有人已经得到了你的更改，那么当他们再次尝试拉取时，它可能会失败. 而不是修改提交，您应该只对更改进行新的提交。

然而，如果你真的，真的想要推送一个修改过的提交，你可以这样做：

```
$ git push origin +master:master 
```

前导`+`符号将强制推送发生，即使它不会导致“快进”提交。（当您推送的更改是公共存储库中已有更改的*直接后代时，就会发生快进提交。）*

* * *

## 回答 #5

> 赞同：67
> 
> 时间：2015-06-21T14:41:57.227

这是一种非常简单且干净的方法来在您已经做出更改后推送您的更改`commit --amend`：

```
git reset --soft HEAD^
git stash
git push -f origin master
git stash pop
git commit -a
git push origin master 
```

执行以下操作：

*   将分支头重置为父提交。
*   存储最后一次提交。
*   强制推送到远程。遥控器现在没有最后一次提交。
*   弹出你的藏匿处。
*   干净地提交。
*   推送到远程。

记住要更改`origin`，`master`如果将其应用于不同的分支或远程。

* * *

## 回答 #6

> 赞同：33
> 
> 时间：2012-09-24T15:46:14.803

我已经通过丢弃我的本地修改提交并在顶部添加新更改来解决它：

```
# Rewind to commit before conflicting
git reset --soft HEAD~1

# Pull the remote version
git pull

# Add the new commit on top
git add ...
git commit
git push 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2014-02-20T10:24:49.413

我有同样的问题。

*   不小心修改了已经推送的最后一次提交
*   在本地做了很多更改，提交了大约五次
*   尝试推送、出错、恐慌、合并远程、获取大量非我的文件、推送、失败等。

作为一个 Git 新手，我认为它是完整的[FUBAR](https://en.wiktionary.org/wiki/FUBAR#Adjective)。

解决方案：有点像@bara 建议的 + 创建了一个本地备份分支

```
# Rewind to commit just before the pushed-and-amended one.
# Replace <hash> with the needed hash.
# --soft means: leave all the changes there, so nothing is lost.
git reset --soft <hash>

# Create new branch, just for a backup, still having all changes in it.
# The branch was feature/1234, new one - feature/1234-gone-bad
git checkout -b feature/1234-gone-bad

# Commit all the changes (all the mess) not to lose it & not to carry around
git commit -a -m "feature/1234 backup"

# Switch back to the original branch
git checkout feature/1234

# Pull the from remote (named 'origin'), thus 'repairing' our main problem
git pull origin/feature/1234

# Now you have a clean-and-non-diverged branch and a backup of the local changes.
# Check the needed files from the backup branch
git checkout feature/1234-gone-bad -- the/path/to/file.php 
```

也许这不是一个快速而干净的解决方案，而且我丢失了我的历史记录（1 次提交而不是 5 次），但它节省了一天的工作。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2015-01-13T07:20:05.867

如果您还没有将代码推送到远程分支（GitHub/Bitbucket），您可以在命令行上更改提交消息，如下所示。

```
 git commit --amend -m "Your new message" 
```

如果您正在处理特定分支，请执行以下操作：

```
git commit --amend -m "BRANCH-NAME: new message" 
```

如果您已经推送了带有错误消息的代码，那么您在更改消息时需要小心。即，在您更改提交消息并尝试再次推送它之后，您最终会遇到问题。为了使其顺利，请按照以下步骤操作。

**请在做之前阅读整个答案**

```
git commit --amend -m "BRANCH-NAME : your new message"

git push -f origin BRANCH-NAME                # Not a best practice. Read below why? 
```

**重要提示：**当您直接使用强制推送时，您可能会遇到其他开发人员在同一分支上工作的代码问题。因此，为避免这些冲突，您需要在**强制推送**之前从分支中提取代码：

```
 git commit --amend -m "BRANCH-NAME : your new message"
 git pull origin BRANCH-NAME
 git push -f origin BRANCH-NAME 
```

如果已推送，这是更改提交消息时的最佳实践。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2016-01-21T06:35:29.630

您收到此错误是因为 Git 远程已经有这些提交文件。您必须强制推送分支才能使其正常工作：

```
git push -f origin branch_name 
```

还要确保您从远程提取代码，因为您团队中的其他人可能已经推送到同一个分支。

```
git pull origin branch_name 
```

这是我们必须强制将提交推送到远程的情况之一。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2020-03-06T09:12:36.220

如果您使用的是 Visual Studio Code，您可以尝试使用此扩展程序以使其更容易。

[https://marketplace.visualstudio.com/items?itemName=cimdalli.git-commit-amend-push-force](https://marketplace.visualstudio.com/items?itemName=cimdalli.git-commit-amend-push-force)

从它的名字就可以理解，它是连续执行命令的

*   `git commit --amend`
*   `git push --force`

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2016-06-07T00:03:57.953

如果您知道没有人取消您未修改的提交，请`--force-with-lease`使用`git push`.

在 TortoiseGit 中，您可以在“推送...”选项“强制：可能丢弃”并检查“已知更改”下执行相同的操作。

> [强制（可能丢弃已知更改）](https://tortoisegit.org/docs/tortoisegit/tgit-dug-push.html)允许远程存储库接受更安全的非快进推送。这可能会导致远程存储库丢失提交；小心使用它。这可以防止丢失遥控器上其他人的未知更改。它检查服务器分支是否指向与远程跟踪分支相同的提交（已知更改）。如果是，将执行强制推送。否则会被拒绝。由于 git 没有远程跟踪标签，因此无法使用此选项覆盖标签。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-01-18T08:29:59.733

这是一个非常简单和干净的方法来在你已经做了一个`git add "your files"`and之后推送你的更改`git commit --amend`：

```
git push origin master -f 
```

或者：

```
git push origin master --force 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-31T11:39:28.587

我必须通过从远程仓库中提取并处理出现的合并冲突、提交然后推送来解决这个问题。但我觉得有更好的方法。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2016-12-02T16:29:18.070

我只是继续做 Git 让我做的事情。所以：

*   由于修改了提交，无法推送。
*   我按照建议进行拉动。
*   合并失败。所以我手动修复它。
*   创建一个新的提交（标记为“合并”）并推送它。
*   它似乎工作！

注意：修改后的提交是最新的。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-02-03T03:36:44.593

在更改提交的作者和提交者时，以下内容对我有用。

`git push -f origin master`

Git 足够聪明，可以确定这些是相同增量的提交，仅在元信息部分有所不同。

本地和远程负责人都指向有问题的提交。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-03-13T06:34:12.030

在这里，我如何修复先前提交中的编辑：

1.  保存到目前为止的工作。

2.  如果进行了更改，请暂时隐藏您的更改：`git stash`现在您的工作副本在您上次提交的状态下是干净的。

3.  进行编辑和修复。

4.  **在“修改”**模式下提交更改：`git commit --all --amend`

5.  您的编辑器会出现询问日志消息（默认情况下，旧日志消息）。满意后保存并退出编辑器。

    新的更改被添加到旧的提交中。自己看`git log`和`git diff HEAD^`

6.  重新应用您隐藏的更改（如果进行了）：`git stash apply`

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-02-28T00:42:44.640

为避免强制推送，请在远程裸存储库中使用以下命令删除最后一次提交（要修改的提交）：

```
git update-ref HEAD HEAD^ 
```

然后推送修改后的提交，没有冲突。

注意：这假设在此期间没有人拉过错误的提交。如果他们有，他们将不得不再次倒带并再次拉动，可能会合并他们自己的更改。

# c# - 为什么 AC# 类可以隐式和显式地从一个接口继承？

> ID：253058
> 
> 赞同：16
> 
> 时间：2008-10-31T10:23:20.173
> 
> 标签：c#, inheritance, implicit, explicit

今天碰巧发现一个C#类可以隐式和显式地继承一个接口。这让我很惊讶。如果 C# 以这种方式工作，那么一个实例在以不同方式引用时可能表现不同。

```
interface IFoo
{
    void DoSomething();
}

class Foo : IFoo
{
    #region IFoo Members
    public void DoSomething()
    {
        Console.WriteLine("do something implicitly");
    }
    #endregion

    #region IFoo Members
    void IFoo.DoSomething()
    {
        Console.WriteLine("do something explicitly");
    }
    #endregion
}

        Foo f = new Foo();
        f.DoSomething();

        ((IFoo)f).DoSomething(); 
```

上面的代码运行并输出

```
do something implicitly
do something explicitly 
```

我相信 C# 的这种设计会使行为不一致。一个 C# 类可能必须以隐式或显式方式从一个接口继承，但不能同时继承。

为什么 C# 以这种方式设计有什么原因吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-10-31T10:28:49.693

每个实现接口的类在该类的成员和接口的成员之间都有一个*映射。*如果类*显式*实现了接口成员，则显式实现将**始终**映射到接口。如果没有显式实现，则需要隐式实现，并且该实现将映射到接口。

当一个类具有与接口相同的成员名称和关联类型**但**它也显式实现了接口的相应成员时，则该类的“隐式”实现*根本不*被视为接口的实现*（*除非显式实现调用它）。

除了在类实现具有相同成员名称/类型的多个接口的每种情况下的不同含义之外，即使只有一个接口，*该类本身*也被认为具有一个隐式接口，该接口可能具有与唯一接口相同的成员/类型但仍然意味着不同的东西。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-10-31T10:33:37.937

您的示例没有**隐**式和显式地实现 IFoo 。您只显式地实现 IFoo.DoSometing() 。您的类上有一个名为 DoSomething() 的新方法。它与 IFoo.DoSomething 无关，只是它具有相同的名称和参数。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-31T10:30:33.310

这使得它在发生碰撞时更加灵活。特别是看[`IEnumerator`](http://msdn.microsoft.com/en-us/library/system.collections.ienumerator.aspx)和[`IEnumerator<T>`](http://msdn.microsoft.com/en-us/library/78dfe2yb.aspx)- 它们都有一个`Current`属性，但类型不同。您*必须*使用显式接口实现才能实现两者（并且泛型形式扩展了非泛型形式）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-31T10:29:48.273

多重继承：如果您从两个定义相同方法的接口派生用于不同目的怎么办？

```
 interface IMoveable
  {
    public void Act();
  }

  interface IRollable
  {
    public void Act();
  }

  class Thing : IMoveable, IRollable
  {
    //TODO Roll/Move code here

    void IRollable.Act()
    {
      Roll();
    }

    void IMoveable.Act()
    {
      Move();
    }
  } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T11:19:34.927

伙计们，谢谢你的回答。

事实证明，“C#类可以同时以隐式和显式方式继承一个接口”实际上是一种错觉。实际上，一个类可以继承一个接口一次。

在原始问题中，“DoSomething”方法似乎“隐式实现”接口IFoo（该方法实际上是由VS2008生成的），但实际上并非如此。通过接口 IFoo 的显式实现，“DoSomething”方法变成了与 IFoo 无关的普通方法，除了具有相同的签名。

我仍然认为它是 C# 的一个棘手的设计，而且很容易被误用。说，我有一些这样的代码

```
 Foo f = new Foo();
        f.DoSomething(); 
```

现在，我想将其重构为以下代码。看起来完全OK，但是执行结果不一样。

```
 Action<IFoo> func = foo => foo.DoSomething();
        func(f); 
```

# visual-studio - 禁用但不卸载 Resharper 4.x 及更高版本

> ID：253063
> 
> 赞同：131
> 
> 时间：2008-10-31T10:24:34.947
> 
> 标签：visual-studio, resharper, add-in

关于如何禁用但不卸载 Resharper 4.x 或更高版本的任何想法？

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2009-12-14T13:28:33.597

从 resharper 5 开始，接受的答案不起作用。您应该从工具 > 选项 > Resharper 暂停 ReSharper

![替代文字](https://i.stack.imgur.com/gjv8Z.png)

* * *

## 回答 #2

> 赞同：153
> 
> 时间：2008-10-31T11:07:18.150

您可以使用 Visual Studio 加载项管理器禁用 ReSharper 4 及更低版本（从左侧的复选框中取消选中）。

在 ReSharper 5 及更高版本（测试至版本 7.0.1）中，[您可以](https://stackoverflow.com/questions/253063/disable-but-not-uninstall-resharper-4-x/1900927#1900927)通过以下方式从工具 > 选项 > Resharper 暂停 ReSharper ![替代文字](https://i.stack.imgur.com/eT81q.png)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2011-03-04T23:55:12.370

如果您想在不单击太多的情况下执行此操作，请打开**命令行窗口**( `Ctrl`+ `W`, `A`) 并键入：

`ReSharper_Suspend`或者`ReSharper_Resume`取决于你想要什么。

或者您可以为此目的设置键盘快捷键。在**VS**中，转到**工具 > 选项 > 环境 > 键盘**。

`ReSharper_Suspend`在那里，您可以为和分配键盘快捷键`ReSharper_Resume`。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-12-05T16:43:18.073

这对我不起作用。启动列中的复选框已选中和禁用。

**但！**我在网上的其他地方找到了修复程序。

您需要做的是使以下文件可写：

> `C:\Program Files\JetBrains\ReSharper\v4.0\Bin\Product.VisualStudio.80.AddIn`
> 
> `C:\Program Files\JetBrains\ReSharper\v4.0\Bin\Product.VisualStudio.90.AddIn`

因为这些文件是只读的，VS200x 无法修改它们来设置 Resharper 插件的启动启用。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-11-29T19:14:43.633

对于 Visual Studio 2012 和 Resharper 7+，为 Visual Studio 创建一个快捷方式并添加以下开关：

```
"C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\devenv.exe" /Resharper.Suspend 
```

现在，您可以在禁用 Resharper 的情况下打开 Visual Studio。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2010-04-05T19:52:48.910

在 ReSharper 5.0 中，临时启用/禁用当前文件的代码分析的键盘快捷键是`Ctrl`+ `Shift`+ `Alt`+ `8`。在以前的版本中是`Ctrl`+ 。`8`

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-04-16T15:24:07.290

ReSharper 6.1.1 不再包括 ReSharper_Resume 或 ReSharper_Suspend（或者至少我找不到它们以将它们添加到工具栏）。前面提到的键盘快捷键（Ctrl+8 或 Ctrl+Shift+Alt+8 也不起作用）。

作为一种解决方法，您可以使用 Tools/Option/ReSharper 并单击 Suspend 按钮。在暂停 ReSharper 6.1.1 后，您必须返回该位置才能恢复它。

暂停 ReSharper 6.1.1 的主要原因是它保证在编辑 nAnt 文件（大或小，没有区别）时导致 Visual Studio 2008 SP1 崩溃。这些文件通常具有 .build 的文件扩展名。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-11-04T00:46:40.137

您也可以按 Ctrl+8。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-06-16T23:44:13.260

在 Win7 上，以管理员身份打开 VS，.AddIn 文件将是可写的。（复选框将处于活动状态）

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-04-19T18:39:37.290

我只需要在编辑 Nant 文件时禁用 ReSharper。它最近在 6.1 中得到了“增强”，并打破了 Visual Studio 提供的现有智能感知。我决定创建一个批处理文件来加载我的 Nant 解决方案，但在安全模式下加载 VS，而不是担心启用和禁用。似乎工作得很好，因为当谈到 Nant 时，我使用 VS 只不过是一个花哨的文本编辑器。

示例：将以下内容放入保存为 bat 或 cmd 的文本文件中。

我的文件：“nantbuild.cmd”

```
devenv psbuild.sln /safemode 
```

# c# - .NET 拼写检查控件？

> ID：253064
> 
> 赞同：24
> 
> 时间：2008-10-31T10:25:05.787
> 
> 标签：c#, winforms, spell-checking

是否有任何具有拼写检查功能的 .NET 库（最好是自包含的文本编辑控件）。我想在我的应用程序的编辑区域中为拼写错误的单词添加典型的红色下划线。

编辑：澄清一下，这是针对 WinForms

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2010-02-08T21:49:55.647

Aspell.Net 看起来不错，但似乎不再维护。我无法让它在我的机器上工作。

After searching around SourceForge, I found [NHunspell](http://nhunspell.sourceforge.net/), which is a .Net port of the spell checker from OpenOffice.org. It provides methods to spell check, find synonyms, and hyphenate. Its actively maintained at this time, and comes with easy to understand sample code.

In the project's own words:

> Spell Checker, Hypenation and Thesaurus: NHunspell
> 
> NHunspell is a free open source spell checker for the .NET Framework. C# and Visual Basic sample code is available for spell checking, hyphenation and synonym lookup via thesaurus.
> 
> NHunspell is based on Hunspell and brings the Open Office spell checking, hyphenation and thesaurus to the Microsoft® .NET Framework. NHunspell is a .NET (C#, VB) library and wraps the native libraries Hunspell, Hyphen and MyThes.
> 
> The integrated libraries are used in OpenOffice and work with the dictionaries published on OpenOffice.org. License
> 
> NHunspell is licensed under: GPL/LGPL/MPL. Free use in commercial applications is permitted according to the LGPL and MPL licenses. Your commercial application can link against the NHunspell DLLs.

[NHunspell](http://nhunspell.sourceforge.net/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-10-31T10:32:40.310

不是红线控制，而是：[Aspell.Net](http://aspell-net.sourceforge.net/)是一个免费和开源的 .Net 拼写检查组件。Aspell.Net 基于 GNU Aspell 项目，是可用的最强大的多语言拼写引擎之一。API 是用 C# 编写的，并通过围绕 Aspell 的 C API 的 Win32 端口的 C++ 包装器进行通信。

[sourceforge](http://aspell-net.cvs.sourceforge.net/viewvc/aspell-net/)的源代码库，2010 年 2 月检查（Tahnks，@magnifico）。

2012 年 5 月，源不再可访问...对不起。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2010-02-26T16:59:02.923

NHunspellTextBoxExtender, created by William Winner works. Once added to your project, can be used to extend textboxes and rich textboxes (any control that inherits TextBoxBase). Source code is included as well.

[http://www.codeproject.com/KB/recipes/NHunspellExtenderProvider.aspx](http://www.codeproject.com/KB/recipes/NHunspellExtenderProvider.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-31T10:29:18.070

你没有提到这是用于基于网络的使用还是桌面应用程序，但我过去使用[过 netSpell](http://sourceforge.net/projects/netspell/)并取得了很好的成功。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-31T10:31:56.520

[Telerik](http://www.telerik.com/products/aspnet-ajax/controls/spell/overview.aspx)有一个针对 ASP.NET 的控件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-13T20:47:59.313

RapidSpell 对我很有效[http://keyoti.com](http://keyoti.com)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-10-12T02:42:20.760

****** Windows App-You can customize your own textbox Control, No Third Party Software Needed******

1-First open your application "Properties" in solution explorer, under the "Application" tab make sure "target framework" is set to ".Net Framework 4", NOT ".Net Framework 4 Client Profile".

2-Second right click your application in solution explorer and select "Add Reference...". Select the ".NET" tab then hold the control key and select the "WindowsFormsIntegration", "System.Design", "PresentationCore"," PresentationFramework", "WindowsBase","System.Xaml" and click "OK".

3-Third right click your application in solution explorer and select "Add"->"Class". Make a new class you can name it anything you like. Open the code for the class you just made and delete the code, not the file.

4-Forth copy and paste the following code into the class file you just made.

```
using System;
using System.ComponentModel;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Forms.Integration;
using System.Windows.Forms.Design;

[Designer(typeof(ControlDesigner))]
class SpellCheckTextbox: ElementHost
{
    private TextBox box;

    public SpellCheckTextbox()
    {
        box = new TextBox();
        base.Child = box;
        box.TextChanged += (sender, e) => OnTextChanged(EventArgs.Empty);
        box.SpellCheck.IsEnabled = true;
        box.VerticalScrollBarVisibility = ScrollBarVisibility.Hidden;
        this.Size = new System.Drawing.Size(100, 200);
    }
    public override string Text
    {
        get { return box.Text; }
        set { box.Text = value; }
    }

    [DefaultValue(true)]
    public bool Multiline
    {
        get { return box.AcceptsReturn; }
        set { box.AcceptsReturn = value; }
    }

    [DefaultValue(false)]
    public bool ScrollBars
    {
        get 
        {
            if (box.VerticalScrollBarVisibility == ScrollBarVisibility.Visible ||
                box.HorizontalScrollBarVisibility == ScrollBarVisibility.Visible)
            {
                return true;
            }
            else 
            {
                return false;
            }

        }
        set 
        {
            if (value)
            {
                box.VerticalScrollBarVisibility = ScrollBarVisibility.Visible;
                box.HorizontalScrollBarVisibility = ScrollBarVisibility.Visible;
            }
            else
            {
                box.VerticalScrollBarVisibility = ScrollBarVisibility.Hidden;
                box.HorizontalScrollBarVisibility = ScrollBarVisibility.Hidden;
            }

        }
    }

    [DefaultValue(false)]
    public bool WordWrap
    {
        get { return box.TextWrapping != TextWrapping.NoWrap; }
        set { box.TextWrapping = value ? TextWrapping.Wrap : TextWrapping.NoWrap; }
    }

    [DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
    public new System.Windows.UIElement Child
    {
        get { return base.Child; }
        set { /* Do nothing to solve a problem with the serializer !! */ }
    }

} 
```

5- Fifth, finally last step, compile the code, then drag and drop the new control "SpellCheckTextbox", that is located at the top of the "Toolbox" in design view onto your form.

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-08-01T04:04:25.747

Free .NET spell checker based around a WPF text box that can be used client or server side can be seen [here](https://github.com/aranm/SpellChecker)

Full disclosure...written by yours truly with some help from stack overflow of course :)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-31T10:29:19.537

[Infragistics](http://www.infragistics.com)有一个[拼写检查控件](http://www.infragistics.com/dotnet/netadvantage/winforms/winspellchecker.aspx#Overview)，可以对任何控件进行拼写检查。我自己没用过，你可以免费下载试用版。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-31T10:32:00.233

组件一提供了一个执行此操作但仅在您键入时执行的组件。我使用它，它非常快。

请参阅[此处](http://www.componentone.com/SuperProducts/SpellCheckerWinForms/)了解更多信息

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2008-10-31T10:31:46.617

FCKEditor 是一个不错的文本编辑器（基于网络）。它具有拼写检查功能。

# java - 调试 getResource*

> ID：253066
> 
> 赞同：17
> 
> 时间：2008-10-31T10:25:54.117
> 
> 标签：java

您如何调试失败的[getResource](http://java.sun.com/javase/6/docs/api/java/lang/ClassLoader.html#getResource(java.lang.String))样式方法，返回 null？

我确定它正在寻找的文件在那里，但它返回 NULL。我怎么知道它在寻找什么来尝试发现任何不匹配？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-31T13:27:22.717

由于搜索类路径（正如其他人所提到的），在有问题的调用`getResource()`之前转储正在搜索的实际类路径可能会有所帮助：`getResource()`

```
log.debug("classpath is: " + System.getProperty("java.class.path"));

//the line that is returning null
... = Thread.currentThread().getContextClassLoader().getResource("foobar"); 
```

可能发生的情况是您认为在类路径上的文件/目录实际上不是（可能在途中某处设置了无效路径）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-31T10:31:50.017

您可以使用 Eclipse-debug-mode 并在失败的方法上设置断点。从那里你可以在调用树中一步一步地往下走，直到你看到失败的地方。

最常见的是该文件不存在，因为它没有被复制到那里或不在类路径中等等......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T10:32:27.660

getResource 调用正在寻找与类文件相关的文件。

我的第一个猜测是，当您编译时，您忘记将资源文件放入编译文件夹中。这就是我经常运行的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-02T00:53:31.380

我认为您应该告诉 Eclipse 或您最喜欢的 IDE 哪里可以找到 JDK (JRE) 源文件。然后您也可以单步执行 Java Runtime 类的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T11:14:01.430

每当 ClassLoader 发生变化时，我通常都会遇到这种情况。

根据应用程序运行的确切上下文，类加载器对资源文件何时存在有不同的规则。例如，在 netbeans 中 getResource 是不区分大小写的，但在 Sun 的 JRE 中却是。

尽管没有直接回答您的问题，但我认为您应该知道这一点（如果您还没有的话）。

# dos - 如何使用 csh 从 linux 中查找带有 ^M 的文件

> ID：253075
> 
> 赞同：3
> 
> 时间：2008-10-31T10:29:03.423
> 
> 标签：dos, line-endings

是否有一个 csh 脚本/命令来列出源代码树中的所有文件，这些文件的行尾在 emacs 中显示为“^M”（在 linux 下）。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-31T10:45:39.113

根据我对[另一个问题](https://stackoverflow.com/questions/204765/elegant-way-to-search-for-utf-8-files-with-bom#211855)的回答：

```
fgrep -rl `echo -ne '\r'` . 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T10:30:35.883

```
find . -type f -exec grep $'\r' {} + 
```

`$'\r'`可能需要 bash 才能正常运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T10:39:12.980

```
find . -type f -print | xargs grep 'cntl-M$' 
```

其中 cntl-M 已通过首先输入 cntl-V 输入

# c++ - 如何在 GDB 中打印 C++ 向量的元素？

> ID：253099
> 
> 赞同：226
> 
> 时间：2008-10-31T10:33:14.180
> 
> 标签：c++, debugging, stl, vector, gdb

我想检查`std::vector`GDB 中 a 的内容，我该怎么做？`std::vector<int>`为了简单起见，假设它是一个。

* * *

## 回答 #1

> 赞同：279
> 
> 时间：2008-10-31T10:33:23.477

使用 GCC 4.1.2，要打印名为 myVector 的整个 std::vector<int>，请执行以下操作：

```
print *(myVector._M_impl._M_start)@myVector.size() 
```

要仅打印前 N 个元素，请执行以下操作：

```
print *(myVector._M_impl._M_start)@N 
```

**解释**

这可能很大程度上取决于您的编译器版本，但对于 GCC 4.1.2，指向内部数组的指针是：

```
myVector._M_impl._M_start 
```

从指针 P 开始打印数组的 N 个元素的 GDB 命令是：

```
print P@N 
```

或者，以简短的形式（对于标准 .gdbinit）：

```
p P@N 
```

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2010-01-23T13:23:51.787

要查看向量 std::vector myVector 内容，只需输入 GDB：

```
(gdb) print myVector 
```

这将产生类似于以下内容的输出：

```
$1 = std::vector of length 3, capacity 4 = {10, 20, 30} 
```

要实现上述目标，您需要拥有 gdb 7（我在 gdb 7.01 上对其进行了测试）和一些 python 漂亮的打印机。这些安装过程在[gdb wiki](https://sourceware.org/gdb/wiki/STLSupport)上进行了描述。

更重要的是，在上面安装之后，它适用于**Eclipse** C++ 调试器 GUI（以及我认为的任何其他使用 GDB 的 IDE）。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-08-26T06:57:03.180

将以下内容放入 ~/.gdbinit

```
define print_vector
    if $argc == 2
        set $elem = $arg0.size()
        if $arg1 >= $arg0.size()
            printf "Error, %s.size() = %d, printing last element:\n", "$arg0", $arg0.size()
            set $elem = $arg1 -1
        end
        print *($arg0._M_impl._M_start + $elem)@1
    else
        print *($arg0._M_impl._M_start)@$arg0.size()
    end
end

document print_vector
Display vector contents
Usage: print_vector VECTOR_NAME INDEX
VECTOR_NAME is the name of the vector
INDEX is an optional argument specifying the element to display
end 
```

重新启动 gdb（或采购 ~/.gdbinit）后，显示相关帮助，如下所示

```
gdb) help print_vector
Display vector contents
Usage: print_vector VECTOR_NAME INDEX
VECTOR_NAME is the name of the vector
INDEX is an optional argument specifying the element to display 
```

示例用法：

```
(gdb) print_vector videoconfig_.entries 0
$32 = {{subChannelId = 177 '\261', sourceId = 0 '\000', hasH264PayloadInfo = false, bitrate = 0,     payloadType = 68 'D', maxFs = 0, maxMbps = 0, maxFps = 134, encoder = 0 '\000', temporalLayers = 0 '\000'}} 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2009-03-01T14:53:31.020

在调试时“观察”STL 容器有些问题。这是我过去使用过的 3 种不同的解决方案，它们都不是完美的。

[1) 使用来自http://clith.com/gdb_stl_utils/](http://clith.com/gdb_stl_utils/)的GDB 脚本这些脚本允许您打印几乎所有 STL 容器的内容。问题是这不适用于嵌套容器，如一堆集合。

2) Visual Studio 2005 对观看 STL 容器提供了极好的支持。这适用于嵌套容器，但这仅适用于 STL 的实现，如果您将 STL 容器放入 Boost 容器中则不起作用。

3) 在调试时为要打印的特定项目编写自己的“打印”函数（或方法），并在 GDB 中使用“调用”来打印项目。请注意，如果您的 print 函数没有在代码中的任何位置调用，g++ 将执行死代码消除，并且 GDB 将找不到“print”函数（您将收到一条消息，指出该函数已内联）。所以用 -fkeep-inline-functions 编译

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-15T16:04:59.850

聚会有点晚了，所以下次我做这个搜索时主要是提醒我！

我已经能够使用：

```
p/x *(&vec[2])@4 
```

`vec`从 .开始打印 4 个元素（作为十六进制）`vec[2]`。

# asp.net-mvc - NUnit 和 Visual Web Developer 2008SP1 - 集成问题

> ID：253116
> 
> 赞同：0
> 
> 时间：2008-10-31T10:42:10.387
> 
> 标签：asp.net-mvc, visual-studio-2008, unit-testing, nunit

我决定将 NUnit 与 VWD2008 集成。

我做了以下 - 1）安装的 NUnit - 运行一个包含在安装中的示例项目，所有测试都很好。2) 安装 TestDriven.Net 2.0 - 个人发行版。3）我在 MVC 项目上编写了一个测试，当我尝试右键单击上下文并运行测试时它失败了。此外，我必须添加对 NUnit.framework dll 的引用才能编写测试。

我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T13:19:33.373

Testdriven.Net 不适用于 Visual Studio 的速成版。以前版本的 Testdriven.Net 确实可以与 Visual Studio Express 版本一起使用，但微软不喜欢这样，并聘请了他们的律师。 [http://weblogs.asp.net/nunitaddin/archive/2007/07/06/microsoft-amp-testdriven-net.aspx](http://weblogs.asp.net/nunitaddin/archive/2007/07/06/microsoft-amp-testdriven-net.aspx)

如果您想要一个带有单元测试支持的免费 ide，您可以尝试使用 sharpdevelop。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T15:34:06.923

正如 Mendelt 所说，TestDriven.Net 不适用于快速版本。我有 VS2008 标准版，所以我不得不使用 NUnit 的“长路”。您已打开 NUnit GUI 并加载您的 dll。然后你从 VS2008 的 Debug 菜单附加到那个进程并运行你的代码。

尽管如此，我不确定MVC是否相同。我知道在我读过的几篇博客中，都有模拟 MVC 的例子。也许你应该调查一下。

# html - 是否可以模拟表格单元格之间的间距，使垂直和水平间距不同？

> ID：253121
> 
> 赞同：3
> 
> 时间：2008-10-31T10:43:19.963
> 
> 标签：html, css, css-tables

在 CSS 中，您可以使用表格的边框间距属性指定表格单元格之间的间距。

但是，这会导致列和行之间的间距一致，并且我发现更多情况下，我使用的设计需要行之间的间隙，而不是列之间的间隙，反之亦然。

如果我有纯色背景，我可以使用与背景颜色相同颜色的边框来模拟间距。

我还可以将 div（例如）作为每个表格单元格的第一个子元素，并使用填充或边距来获得所需的结果，但这只是为了适应样式而需要大量额外的标记。

鉴于我显示的数据是表格数据，有没有一种明智的方法来使用表格来实现这种风格？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-10-31T10:44:42.800

您*可以*`border-spacing`为或相关属性的水平和垂直边缘指定不同的间距。只需指定多个测量值。例如，

```
border-spacing: 1px 2px; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-31T11:38:17.777

在***一般情况下***，您可以指定可以全局或单独应用于属性的计算（例如，“填充”），请遵循简单的模式。

*   如果您指定单个值（例如 padding:2px; ），则该值将应用于对象的顶部、底部、左侧和右侧。

*   如果您指定两个值（例如 padding:2px 7px; ），第一个值应用于顶部和底部，第二个值应用于左侧和右侧。

*   如果指定三个值，则第一个值应用于顶部，第二个值应用于左右*，* 最后一个值应用于底部。

*   如果您指定四个值（例如 padding:1px,2px,3px,4px; ），这些值将按该顺序应用于上、右、下、左（记住使用单词 TRouBLe 的顺序）。

# asp.net-mvc - 使用 Html.RouteLink 添加一个 css 类

> ID：253125
> 
> 赞同：18
> 
> 时间：2008-10-31T10:43:51.990
> 
> 标签：asp.net-mvc

有谁知道我如何在 ASP.Net MVC 中使用 Html.RouteLink 辅助方法渲染的链接中添加一个类，它具有 htmlAttributes 对象作为我认为我可以使用的最后一个参数，但是因为类显然是保留字，我不能将其作为对象的属性之一提供。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2008-10-31T12:47:33.670

试试这个：

```
<%= Html.RouteLink("Default", "Default",null, new { @class="css_class"}) %> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-31T11:12:00.247

只需对 html 属性使用大写字母，如下所示：

```
<%= Html.RouteLink("Default", "Default",null, new { Class="css_class"}) %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T16:32:07.453

请注意，在 c# 规范中，@ 特殊字符用于变量名前面，以允许使用关键字作为变量名。所以 @class = "css_class" 意味着将名为 "class" 的属性的值设置为 css_class

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-17T11:06:26.890

谢谢罗伯特，在我的案例（ASP.NET MVC）中，我使用了剃刀语法，我以另一种方式使用它。

@Html.RouteLink("Default", "Default",null, new { @class="css_class"})

# c# - 如何在 LINQ 中建立多对多关系？

> ID：253135
> 
> 赞同：1
> 
> 时间：2008-10-31T10:47:26.600
> 
> 标签：c#, .net, linq-to-sql

我有两个表，t1 和 t2 有 t1.t1_id 和 t2.t2_id 作为主键。它们分别通过表 t3 与列 t3.t1_id 和 t3.t2_id 相关联。使用 LINQ，我在 t1 和 t2 类上得到一个 EntitySet<t3>，但我想要的是在 t1 类上得到一个 EntitySet<t2>，在 t2 类上得到一个 EntitySet<t1>。我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-31T11:12:04.240

试试这个：

[来自 Mitsu 在 MSDN 上的博客](http://blogs.msdn.com/mitsu/archive/2007/06/21/how-to-implement-a-many-to-many-relationship-using-linq-to-sql.aspx)

更新：我忘记链接博客条目的第 2 部分： [第二部分](http://blogs.msdn.com/mitsu/archive/2008/03/19/how-to-implement-a-many-to-many-relationship-using-linq-to-sql-part-ii-add-remove-support.aspx)

# svn - 有没有办法用 Subversion 进行反向更新？

> ID：253136
> 
> 赞同：3
> 
> 时间：2008-10-31T10:48:21.200
> 
> 标签：svn, vendor-branch

我在 SVN 树中有一个分支，其中包含第三方产品的源代码。我需要使用最新版本更新该分支。如果我检查它并将新源复制到旧源上，我可以轻松添加新文件并进行提交。但是，我还想确保删除旧版本但不是新版本的所有文件。

有没有办法告诉 SVN 从目录更新存储库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T10:58:56.450

有一个工具可以做到这一点。它记录在[Subversion Book](http://svnbook.org)中，更准确地说是在有关[供应商分支](http://svnbook.red-bean.com/en/1.5/svn.advanced.vendorbr.html#svn.advanced.vendorbr.svn_load_dirs)的部分中。

# c# - Invoke 调用中的匿名方法

> ID：253138
> 
> 赞同：135
> 
> 时间：2008-10-31T10:49:09.233
> 
> 标签：c#, .net, compiler-errors, anonymous-methods

我们想在 Control.Invoke 中匿名调用委托的语法有点麻烦。

我们尝试了许多不同的方法，但都无济于事。

例如：

```
myControl.Invoke(delegate() { MyMethod(this, new MyEventArgs(someParameter)); }); 
```

其中 someParameter 是此方法的本地参数

以上将导致编译器错误：

> 无法将匿名方法转换为类型“System.Delegate”，因为它不是委托类型

* * *

## 回答 #1

> 赞同：228
> 
> 时间：2008-10-31T10:56:33.820

因为`Invoke`/`BeginInvoke`接受`Delegate`（而不是类型化的委托），所以您需要告诉编译器要创建什么类型的委托；`MethodInvoker`(2.0) 或`Action`(3.5) 是常见的选择（注意它们具有相同的签名）；像这样：

```
control.Invoke((MethodInvoker) delegate {this.Text = "Hi";}); 
```

如果需要传入参数，那么“捕获的变量”就是这样：

```
string message = "Hi";
control.Invoke((MethodInvoker) delegate {this.Text = message;}); 
```

*（警告：如果使用 captures async* ，你需要小心一点，但是*sync*很好 - 即上面的很好）

另一种选择是编写扩展方法：

```
public static void Invoke(this Control control, Action action)
{
    control.Invoke((Delegate)action);
} 
```

然后：

```
this.Invoke(delegate { this.Text = "hi"; });
// or since we are using C# 3.0
this.Invoke(() => { this.Text = "hi"; }); 
```

当然你也可以这样做`BeginInvoke`：

```
public static void BeginInvoke(this Control control, Action action)
{
    control.BeginInvoke((Delegate)action);
} 
```

如果您不能使用 C# 3.0，您可以使用常规实例方法（大概在`Form`基类中）执行相同操作。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2008-10-31T11:00:53.920

实际上，您不需要使用委托关键字。只需将 lambda 作为参数传递：

```
control.Invoke((MethodInvoker)(() => {this.Text = "Hi"; })); 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2008-10-31T10:55:45.210

```
myControl.Invoke(new MethodInvoker(delegate() {...})) 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2008-10-31T10:56:02.010

您需要创建一个委托类型。匿名方法创建中的关键字“委托”有点误导。您不是在创建匿名委托，而是创建匿名方法。您创建的方法可以在委托中使用。像这样：

```
myControl.Invoke(new MethodInvoker(delegate() { (MyMethod(this, new MyEventArgs(someParameter)); })); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2010-12-20T22:16:32.787

为了完整起见，这也可以通过 Action 方法/匿名方法组合来完成：

```
//Process is a method, invoked as a method group
Dispatcher.Current.BeginInvoke((Action) Process);
//or use an anonymous method
Dispatcher.Current.BeginInvoke((Action)delegate => {
  SomeFunc();
  SomeOtherFunc();
}); 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-11-12T22:22:50.417

我对其他建议有疑问，因为我有时想从我的方法中返回值。如果您尝试使用带有返回值的 MethodInvoker，它似乎不喜欢它。所以我使用的解决方案是这样的（很高兴听到一种使这个更简洁的方法 - 我使用的是 c#.net 2.0）：

```
 // Create delegates for the different return types needed.
    private delegate void VoidDelegate();
    private delegate Boolean ReturnBooleanDelegate();
    private delegate Hashtable ReturnHashtableDelegate();

    // Now use the delegates and the delegate() keyword to create 
    // an anonymous method as required

    // Here a case where there's no value returned:
    public void SetTitle(string title)
    {
        myWindow.Invoke(new VoidDelegate(delegate()
        {
            myWindow.Text = title;
        }));
    }

    // Here's an example of a value being returned
    public Hashtable CurrentlyLoadedDocs()
    {
        return (Hashtable)myWindow.Invoke(new ReturnHashtableDelegate(delegate()
        {
            return myWindow.CurrentlyLoadedDocs;
        }));
    } 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-04-11T14:07:27.020

我喜欢用 Action 代替 MethodInvoker，它更短，看起来更干净。

```
Invoke((Action)(() => {
    DoSomething();
}));

// OR

Invoke((Action)delegate {
    DoSomething();
}); 
```

例如。

```
// Thread-safe update on a form control
public void DisplayResult(string text){
    if (txtResult.InvokeRequired){
        txtResult.Invoke((Action)delegate {
            DisplayResult(text);
        });
        return;
    }

    txtResult.Text += text + "\r\n";
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-09-12T09:23:17.470

我从来不明白为什么这会对编译器产生影响，但这已经足够了。

```
public static class ControlExtensions
{
    public static void Invoke(this Control control, Action action)
    {
        control.Invoke(action);
    }
} 
```

奖励：添加一些错误处理，因为很可能，如果您`Control.Invoke`从后台线程使用，您正在更新控件的文本/进度/启用状态，而不关心控件是否已被释放。

```
public static class ControlExtensions
{
    public static void Invoke(this Control control, Action action)
    {
        try
        {
            if (!control.IsDisposed) control.Invoke(action);
        }
        catch (ObjectDisposedException) { }
    }
} 
```

# asp.net - 如何将页面从 asp.net 发布到经典 ASP

> ID：253142
> 
> 赞同：5
> 
> 时间：2008-10-31T10:53:54.323
> 
> 标签：asp.net, forms, post, asp-classic, get

我想将一些表单变量发布到经典的 ASP 页面中。我不想更改经典的 ASP 页面，因为需要完成的工作量以及消耗它们的页面量。

经典的 ASP 页面需要将表单变量 Username 和 Userpassword 提交给它们。

```
username = Request.Form("UserName")
userpassword = Request.Form("Userpassword") 
```

然后它执行各种操作并设置会话，进入一个 ASP 应用程序。

我想将这些变量从 ASP.NET 提交到页面中，但是登录控件嵌套在用户控件和模板中，因此我无法将表单元素的名称设为“用户名”和“用户密码”。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-01T21:30:19.997

你不能真正“转发”一个 POST，就像你想做的那样（在你的 OP 中）。客户端必须启动 POST 到您的 ASP 页面（您的第二篇文章中的代码正在执行该操作）。

* * *

这是您自己回复中的自我发布代码，因此您可以按照您的建议标记答案：

```
public class  RemotePost{
     private  System.Collections.Specialized.NameValueCollection Inputs 
     = new  System.Collections.Specialized.NameValueCollection() ;

    public string  Url  =  "" ;
    public string  Method  =  "post" ;
    public string  FormName  =  "form1" ;

    public void  Add( string  name, string value ){
        Inputs.Add(name, value ) ;
     }

     public void  Post(){
        System.Web.HttpContext.Current.Response.Clear() ;

         System.Web.HttpContext.Current.Response.Write( "<html><head>" ) ;

         System.Web.HttpContext.Current.Response.Write( string .Format( "</head><body onload=\"document.{0}.submit()\">" ,FormName)) ;

         System.Web.HttpContext.Current.Response.Write( string .Format( "<form name=\"{0}\" method=\"{1}\" action=\"{2}\" >" ,

        FormName,Method,Url)) ;
            for ( int  i = 0 ; i< Inputs.Keys.Count ; i++){
            System.Web.HttpContext.Current.Response.Write( string .Format( "<input name=\"{0}\" type=\"hidden\" value=\"{1}\">" ,Inputs.Keys[i],Inputs[Inputs.Keys[i]])) ;
         }
        System.Web.HttpContext.Current.Response.Write( "</form>" ) ;
         System.Web.HttpContext.Current.Response.Write( "</body></html>" ) ;
         System.Web.HttpContext.Current.Response.End() ;
     }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T13:31:37.997

不要使用 asp.net 登录控件（如果你是的话）。

对用户控件中的用户名/密码文本框使用简单的 html，***而不使用***runat="server"：

```
<input type="text" name="UserName" />

<input type="password" name="Userpassword" />

<asp:Button ID="btnLogin" runat="server" PostBackUrl="Destination.asp" /> 
```

将按钮上的 PostBackUrl 属性设置为您的经典 asp url，一切都应该没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T11:17:37.710

我在[另一个网站](http://www.jigar.net/articles/viewhtmlcontent78.aspx)上找到了这个。

我将使用您想要的变量构建一个小表单，并将其输出到客户端并自行提交。它非常简洁，但它带来了破坏后退按钮的问题，并将密码以未加密的形式发送回客户端。

```
public class  RemotePost{
     private  System.Collections.Specialized.NameValueCollection Inputs 
     = new  System.Collections.Specialized.NameValueCollection() ;

    public string  Url  =  "" ;
    public string  Method  =  "post" ;
    public string  FormName  =  "form1" ;

    public void  Add( string  name, string value ){
        Inputs.Add(name, value ) ;
     }

     public void  Post(){
        System.Web.HttpContext.Current.Response.Clear() ;

         System.Web.HttpContext.Current.Response.Write( "<html><head>" ) ;

         System.Web.HttpContext.Current.Response.Write( string .Format( "</head><body onload=\"document.{0}.submit()\">" ,FormName)) ;

         System.Web.HttpContext.Current.Response.Write( string .Format( "<form name=\"{0}\" method=\"{1}\" action=\"{2}\" >" ,

        FormName,Method,Url)) ;
            for ( int  i = 0 ; i< Inputs.Keys.Count ; i++){
            System.Web.HttpContext.Current.Response.Write( string .Format( "<input name=\"{0}\" type=\"hidden\" value=\"{1}\">" ,Inputs.Keys[i],Inputs[Inputs.Keys[i]])) ;
         }
        System.Web.HttpContext.Current.Response.Write( "</form>" ) ;
         System.Web.HttpContext.Current.Response.Write( "</body></html>" ) ;
         System.Web.HttpContext.Current.Response.End() ;
     }
} 
```

# c# - 在 .net 中测试批量电子邮件的最佳工具？

> ID：253143
> 
> 赞同：1
> 
> 时间：2008-10-31T10:53:54.510
> 
> 标签：c#, email, .net-2.0, smtp, windows-server-2003

场景是我们通过 SMTP 服务器发送了数千封电子邮件。内容是预先创建的，并在发送时被拾取。

问题是我们想找到生产环境中的瓶颈在哪里以及需要在哪里完成工作。目标是能够在十分钟内发送 50 万封电子邮件*。

我们应该创建虚拟电子邮件帐户吗？我听说能够发送到仅将它们保留在本地的 SMTP 服务器，但这真的测试了所有瓶颈吗？有没有人对此有一些战略方法？

*这适用于想要推广票价交易的航空公司，根据法律，他们必须在一定时限内向所有人发送电子邮件，否则交易会产生法律影响。以防有人担心这是垃圾邮件生成器。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T11:03:20.093

一家航空公司宣传票价交易？10 分钟内收到 50 万封电子邮件？对我来说当然听起来像是垃圾邮件。

在任何情况下，如果您确实设置了虚拟帐户并将它们托管在几个提供商上，您最终将浪费这些提供商的带宽（并且可能会占用它们）。

如果您设置一个内部虚拟服务器并托管您自己的帐户，您将不确定您的传出带宽是否可以处理生产中的负载。

一种方法可能是设置您自己的外部 smtp 服务器，在那里创建一个或多个帐户，然后在那里转储垃圾邮件，呃，促销电子邮件。

更新：只是想知道，为什么有 10 分钟的限制？如果允许您以小批量的方式流出电子邮件，而不是一次性使管道全部饱和，这肯定会更好地扩展。

# c++ - 如何缩小 std::vector 的大小？

> ID：253157
> 
> 赞同：34
> 
> 时间：2008-10-31T11:00:51.627
> 
> 标签：c++, stl, vector

`std::vector`当我不再需要以前保留的空间时，有没有办法将 a 调整为更低的容量？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2008-10-31T11:09:37.600

有效的 STL，Scott Meyers，第 17 条：使用`swap`技巧来削减过剩产能。

```
vector<Person>(persons).swap(persons); 
```

之后，`persons`就是“缩小以适应”。

这依赖于这样一个事实，即`vector`的复制构造函数只为被复制的元素分配所需的内存。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-03-01T23:32:38.960

如果您使用的是 C++11，则可以使用`vec.shrink_to_fit()`. 至少在 VS2010 中，这对你来说是交换技巧。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-10-31T11:09:58.317

从现有向量创建一个新的临时向量，然后在现有向量上调用 swap 方法，将临时向量传入。让临时向量（现在使用旧的、过大的缓冲区）超出范围。

嘿 presto，您的矢量具有完全适合其内容的大小。

如果这听起来像很多复制和分配 - 请记住，这就是向量每次必须重新分配超过其当前保留限制时所做的事情。

[编辑] 是的，我只是用更多的话和塞巴斯蒂安说了同样的话。stackoverflow竞争条件的另一种情况;-)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-11-20T10:05:59.330

交换技巧是减少对象容量的一种有效方法，它通过复制构造将我的向量的内容与新创建的向量交换：

```
vector<Person>(persons).swap(persons); 
```

请注意，不能保证 person.capacity(); 在交换技巧等于大小之后：vector(persons) 的容量是库实现为大小为 person.size() 的向量保留的容量。

C++11 引入了[shrink_to_fit()](http://www.cplusplus.com/reference/vector/vector/shrink_to_fit/)。

shrink_to_fit() 以及交换技巧并不能保证容量大小有效地减小到向量的大小。

无论如何， shrink_to_fit() 可以使您的迭代器无效（如果发生重新分配）或不能：这取决于库的实际实现。

请记住，交换技巧需要 Person.size() 复制构造 Person 和 person.size() 破坏。shrink_to_fit() 可以避免所有这些复制，并使您的迭代器保持有效。可以。但是有时会发生 shrink_to_fit() 是根据交换技巧实现的......

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-10-31T11:12:37.907

您正在寻找[QVector::squeeze](http://doc.qt.io/qt-4.8/qvector.html#squeeze)的等价物，恐怕它在 STL 中并不明确存在。如果您的 STL 实现正确，请寻求 Sébastien 的答案。

# apache-flex - 我将如何开始学习如何在 Flex 中编程？

> ID：253159
> 
> 赞同：34
> 
> 时间：2008-10-31T11:01:56.897
> 
> 标签：apache-flex

谁能给我指点教如何进行 Flex 编程的好书或网站？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-31T11:04:36.487

查看[学习 Flex 的十大好方法](http://joshblog.net/2007/04/05/ten-ways-beginners-can-learn-adobe-flex/)，但我认为第一个应该是使用[Adob​​e 网站上的快速入门](http://www.adobe.com/devnet/flex/?tab:quickstart=1)。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-10-31T11:08:01.083

**[Adobe 网站上的Flex in a Week](http://www.adobe.com/devnet/flex/videotraining/)视频培训**。

*“通过这个视频培训课程在一周内学习 Flex。为了最大限度地学习，我们建议您查看视频并按照列出的顺序完成练习。如果您遇到问题和有疑问，可以提问Flex in a Week 论坛上的一个问题。”*

*   第 1 天：Flex 基础知识
*   第 2 天：组件开发
*   第 3 天：将所有内容放在一起
*   第 4 天：增加视觉吸引力
*   第 5 天：架构和高级主题

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-10T09:46:11.077

没有人提到[FlexExamples](http://blog.flexexamples.com/)

当我在做第一个弹性项目时，这个资源帮助我理解了很多事情。不同之处在于，它有一些示例，在您开发应用程序时更需要这些示例。它肯定会在很多方面帮助你。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-02-03T18:43:26.623

我们在课堂上使用的一本书，可从 adobe 免费下载：http: [//www.adobe.com/devnet/flex/pdfs/getting_started_with_Flex3.pdf](http://www.adobe.com/devnet/flex/pdfs/getting_started_with_Flex3.pdf)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-31T13:54:09.387

lynda.com 有[一组 Flex 视频](http://movielibrary.lynda.com/html/modListing.asp?pid=205)，包括[基本的 Flex 3](http://movielibrary.lynda.com/html/modPage.asp?ID=438)、[高级主题](http://movielibrary.lynda.com/html/modPage.asp?ID=437)和[AIR Essentials](http://movielibrary.lynda.com/html/modPage.asp?ID=542)。

这是一个订阅网站，但如果您使用其他 Adob​​e 产品，如[ColdFusion 8](http://movielibrary.lynda.com/html/modListing.asp?pid=274)或新的[CS 4](http://movielibrary.lynda.com/html/modListing.asp?pid=362)（它们也有大量 CS 3 视频），每年 250 美元，这很值得。

# java - 将 Vim 用作 Java IDE 的技巧？

> ID：253170
> 
> 赞同：200
> 
> 时间：2008-10-31T11:08:21.270
> 
> 标签：java, vim, ide

我沉迷于 Vim，它现在是我编辑文本文件的实际方式。

因为它主要是一个文本编辑器而不是一个 IDE，有没有人有技巧让我在开发 Java 应用程序时更容易？

我有一些问题：

*   如何在不离开 vi 的情况下调用 maven 任务？
*   我可以完成代码吗？
*   语法高亮如何？

还有什么我应该知道的（除了“不要这样做！”）吗？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2008-10-31T11:17:36.337

一些技巧：

*   确保使用 vim（改进了 vi）。Linux 和某些版本的 UNIX 符号链接 vi 到 vim。
*   [您可以使用eclim](http://eclim.sourceforge.net/)完成代码
*   [或者您可以使用viPlugin](http://viplugin.com/)在 Eclipse 中获得 vi 功能
*   vim 的语法高亮非常棒
*   Vim 对编写小宏有很好的支持，比如运行 ant/ [maven](http://vim.wikia.com/wiki/Use_maven_with_quickfix)构建

玩得开心 ：-）

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-05-07T19:43:31.137

多年来，我一直是 Vim 用户。我开始发现自己偶尔会启动 Eclipse（使用 vi 插件，我不得不说，它有很多问题）。主要原因是 Java 构建需要相当长的时间……而且随着高度组件化的构建框架（如 maven）的添加，它们变得越来越慢。因此，验证您的更改往往需要相当长的时间，这对我来说似乎经常导致堆积一堆我必须稍后解决的编译问题，并且过滤提交消息需要一段时间。

当我得到太多的编译问题队列时，我启动了 Eclipse。它让我可以轻松应对这些变化。它使用起来很慢、很残酷，而且不像 Vim 那样好用编辑器（我使用 Vim 已经近十年了，所以它对我来说是第二天性）。我找到了精确编辑——需要修复一个特定的错误，需要重构一些特定的逻辑，或者其他什么……我在 Eclipse 中的编辑效率不如在 Vim 中那样高效。

还有一个提示：

```
:set path=**
:chdir your/project/root 
```

这使得`^wf`类名成为导航大型项目的一个非常好的功能。

所以不管怎样，最重要的是，当我需要添加大量新代码时，Vim 似乎让我放慢了速度，这仅仅是因为我花时间寻找编译问题和类似的东西。但是，当我需要查找和编辑特定源时，Eclipse 就像一把大锤。我还在等待 Vim 的神奇 IDE。据我所知，有过三种主要的尝试。有一个纯 viml IDE 类型的插件，它增加了很多功能，但似乎无法使用。有eclim，我遇到了很多麻烦。还有一个实际上嵌入了 Vim 的 Eclipse 插件。最后一个似乎最有希望用于真正的 Java EE 工作，但它似乎不能很好地工作或真正将 Eclipse 的所有功能与嵌入式 Vim 集成。

在处理大型 Java 项目时，使用击键添加缺少的导入、使用键入问题突出显示代码等似乎在您的 IDE 中是无价的。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-11-02T19:56:19.357

*   *如何在不离开 vi 的情况下调用 maven 任务？*

    Maven 与任何其他 shell 命令没有什么不同：

    `:!mvn`

    如果您`:set makeprg=mvn`已经有一个最喜欢的`:make`.

*   *我可以完成代码吗？*

    是的，[eclim](http://eclim.sourceforge.net/)很棒，是 vim 的编辑效率和 Eclipse 的 Java 特定语言意识之间的桥梁。

    `<C-n>`并且`<C-p>`不是那么好，但非常有帮助。

*   语法高亮如何？

    对于一个基于正则表达式的高度器来说已经绰绰有余了。

您可能需要考虑用于其他 vim+java 用途的工具，例如代码模板（[snippetEmu——](http://vim.sourceforge.net/scripts/script.php?script_id=1318)默认代码片段很烂，但可定制性很出色）、搜索用法和进入声明（eclim、grep、ctags）、生成 getter 和 setter（[java_getset](http://www.vim.org/scripts/script.php?script_id=490)、或 eclim），自动导入（eclim）。您可能还需要一个 java shell 来进行快速实验（[BeanShell](http://www.beanshell.org/)，又名`bsh`）。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-06-08T03:25:23.420

我刚刚上传了这个用于开发 Java Maven 项目的[Vim 插件。](http://www.vim.org/scripts/script.php?script_id=4096)

如果您还没有设置突出显示，请不要忘记：

![在此处输入图像描述](https://i.stack.imgur.com/ndrro.png) [https://github.com/sentientmachine/erics_vim_syntax_and_color_highlighting](https://github.com/sentientmachine/erics_vim_syntax_and_color_highlighting)

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-05-25T19:21:47.113

我发现以下摘要非常有用：[http](http://www.techrepublic.com/article/configure-vi-for-java-application-development/5054618) ://www.techrepublic.com/article/configure-vi-for-java-application-development/5054618 。:make 的描述是针对 ant 而不是 maven，但除此之外是一个很好的总结。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-03-01T03:31:58.180

我知道这是几年后的事了，但这里有一些有趣的插件。我还没有尝试过这些，所以YMMV。

[https://github.com/mikelue/vim-maven-plugin](https://github.com/mikelue/vim-maven-plugin)

[https://github.com/vim-scripts/maven-ide](https://github.com/vim-scripts/maven-ide)

编辑：哦，顺便说一句，我已经尝试过 eclim 关闭和打开，但我喜欢 vim 的原因是它的轻盈。即使在无头模式下执行 eclipse 对我来说也太过分了。

EDIT2：我最近一直在使用 playframework，这可能也适用于 maven 构建：

*   对于编译，您可以将 VIM 的 make 配置为运行 maven，或者在我的情况下，运行构建脚本，将其放入文件中。

    ```
    autocmd Filetype java setl makeprg=play_compile
    autocmd Filetype java setl efm=%A\ %#[error]\ %f:%l:\ %m,%-Z\ %#[error]\ %p^,%-C%.%# 
    ```

“play_compile”只是一个编译脚本。它使用 SBT，所以 Maven 在这里应该可以正常工作。即使直接 javac 也可以。这样，您可以使用 VIM 的快速修复缓冲区（:cnext、:clist: cprev 等）。

*   为了在课堂上跳来跳去，我使用[ctrl-p](http://www.vim.org/scripts/script.php?script_id=3736)。很美丽。用它。在跳转文件方面比 eclipse 更快。

*   对于跳转方法，我使用带有丰富 c-tags 的 tagsearch。使用 ctrl-] 跳转到方法声明。使用 Ctrl-o 返回。效果不如 Eclipse，但效果足够好。

*   我使用[supertab](http://www.vim.org/scripts/script.php?script_id=1643)来完成代码。Javacomplete 很慢，所以我坚持使用omni-complete。再一次，不如 Eclipse 准确，但它的速度很快，对我来说足够好。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-10-31T11:13:57.967

使用 vim。^-^（准确地说是gVim）

您将拥有一切（带有一些插件）。

顺便说一句，[snippetsEmu](http://vim.sourceforge.net/scripts/script.php?script_id=1318)是一个很好的工具，用于使用有用的片段进行编码（如在 TextMate 中）。您可以使用（或修改）预制包或自己制作。

# java - Jython 和 Java 嵌套类

> ID：253171
> 
> 赞同：3
> 
> 时间：2008-10-31T11:08:35.357
> 
> 标签：java, class, nested, jython

我正在使用 Jython 为 Java 项目编写测试。它运作良好，但我不知道如何访问 java 公共嵌套类。

```
package mypackage;

public class NyClass {
    public class MyNestedClass {
         ...
    }
} 
```

有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T11:30:57.150

我不完全确定您所说的访问是什么意思，但是如果您在创建 MyNestedClass 的实例之后，在 jython 中就没有问题了。

在这种情况下，由于 MyNestedClass 是一个非静态嵌套类，它的每个实例都需要一个对 MyClass 实例的引用。要在 jython 中执行此操作：

```
import mypackage.MyClass
import mypackage.MyClass.MyNestedClass

outer = mypackage.MyClass()
inner = mypackage.MyClass.MyNestedClass(outer) 
```

# c# - VSTO：为什么 OfficeRibbon.Context 为空？

> ID：253178
> 
> 赞同：3
> 
> 时间：2008-10-31T11:10:50.203
> 
> 标签：c#, ms-word, ms-office, vsto, ribbon

我正在开发我的第一个 Word 2007 插件，并在我的项目中添加了一个 OfficeRibbon。在按钮单击处理程序中，我希望引用当前`Word.Document`或`Word.Application`.

我正在尝试通过`OfficeRibbon.Context`属性获取引用，文档说它应该引用当前`Application`对象。然而，它总是`null`。

有没有人知道

a）如果我需要做一些事情来使`OfficeRibbon.Context`显示正确填充？
b) 如果有其他方式我可以获得对 Word 应用程序或活动 Word 文档的引用？

笔记：

*   我正在使用 VS2008 SP1

*   功能区看起来初始化正常：功能区在 Word 中正确呈现；我可以通过构造函数和 OnLoad 成员单步调试调试器；按钮单击处理程序正确执行。

*   这是[此属性的在线帮助](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.ribbon.officeribbon.context.aspx?ppud=4)；

> **OfficeRibbon.Context 属性**
> 
> `C#`
> `public Object Context { get; internal set; }`
> 
> 表示与此 OfficeRibbon 对象关联的 Inspector 窗口或应用程序实例的 Object。
> 
> **评论**
> 
> 在 Outlook 中，此属性是指显示此 OfficeRibbon 的 Inspector 窗口。
> 
> 在 Excel、Word 和 PowerPoint 中，此属性返回显示此 OfficeRibbon 的应用程序实例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-21T22:05:39.340

我在使用 VS2008 SP1 创建 Excel 2007 插件时也遇到了这个问题。我使用的解决方法是将应用程序存储在`internal static`主 AddIn 类的属性中，然后在功能区的事件处理程序中引用它：

```
public partial class ThisAddIn
{
    internal static Application Context { get; private set; }

    private void ThisAddIn_Startup(object sender, System.EventArgs e)
    {
        Context = Application;
    }
    ...
}

public partial class MyRibbon : OfficeRibbon
{
    private void button1_Click(object sender, RibbonControlEventArgs e)
    {
        DoStuffWithApplication(ThisAddIn.Context);
    }
    ...
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T06:41:14.480

尝试通过以下方式引用文档：

```
Globals.ThisDocument.[some item] 
```

[MSDN 参考](http://msdn.microsoft.com/en-us/library/bhczd18c.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-13T21:21:49.690

从以下位置获取：

`Globals.ThisAddIn.Application`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-02T04:32:51.687

虽然我对 Office 2007 字对象模型的变化了解不多，但这里是我使用 VBA 知识的解释。

应用程序是一个全局可用的对象。此外，Application.ActiveDocument 应该让您处理当前文档。

推测：您如何尝试添加功能区？

# sql-server - Linq to SQL 的最佳主键数据类型

> ID：253179
> 
> 赞同：1
> 
> 时间：2008-10-31T11:11:34.007
> 
> 标签：sql-server, linq, linq-to-sql

我正在使用 SqlServer 和 Linq to Sql 开始新项目。哪种数据类型更适合表中的代理键：`identity`或`uniqueidentifier`？

据我了解，`identity`在插入时自动生成，而`uniqueidentifier`应该在代码（GUID）中生成。

是否存在显着的性能差异？例如`identity`，插入后必须读取值，因此插入后会有额外的数据库行程。

**编辑：**
我在另一个问题中找到了非常详细的答案：[没有主键的表](https://stackoverflow.com/questions/5600/tables-with-no-primary-key)。阅读选定的答案。

**编辑2：**
*关于代理键的答案：我更喜欢代理键而不是自然键。该决定已完成，因此请不要建议重新考虑数据库设计。另外，请不要讨论自然键和代理键的优缺点。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T12:17:41.437

我同意这里的评论，即您应该独立于数据访问方法设计数据库结构。无论是 LINQ2SQL 还是 ADO.NET 或 NHibernate，无论您的 PK 是自动增量身份还是 GUID，您都将获得相同的好处/问题。

实际上，我只能想到一个使用 GUID 来支持 INT 作为 PK 的目的 - 在具有多个数据库的高度分布式应用程序中，数据需要与主服务器等同步。即使那样，您也可以使用具有不同增量的 IDENTITY，例如 IDENTITY (1,2) 用于一台数据库服务器，IDENTITY (2, 2) 用于下一台等[当然仅适用于固定数量的数据库服务器。]

GUID 的主要“问题”是它占用更多空间（16 字节与 4/8 相比），不仅作为 PK，而且作为该表中任何索引的一部分，因为每个索引都隐式存储 PK 值。比较 16 个字节也会更慢（多少？你应该测量它，这取决于）

此外，由于 GUID 是随机的，因此在向表中插入行（尽管我相信 SQL Server 2005 或 2008 中有一个新函数可以生成连续的 GUID）时，您可以获得很多页面拆分。在具有大量插入的环境中，仅此一项就可能非常昂贵。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T11:24:36.540

任何一个都可以。这取决于您的设计。当您需要在客户端创建 ID 时，UNIQUEIDENTIFIER 将起作用，当您构建需要在客户端上添加/删除/修改然后发送到数据库的对象列表时，这有时会很好。如果您必须合并在不同系统上创建的数据，那也更好。

INT 更小，因此它们可能会更快，并且当您使用数据调试某些内容时，它们更容易使用，因为它们更容易讨论。

简而言之，这里没有“最佳”答案。这是一个设计决定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T11:44:40.973

我认为根据您使用 LINQ-to-SQL 的事实来选择表的主键不是一个好主意。在我看来，将主键用于其预期目的会更好 - 通过唯一标识特定行来确保数据完整性。整数或 GUID PK 不能保护您免受表中重复行的影响（当然，除了自动生成的列）。再说一次，关于自动生成密钥的优缺点一直存在激烈的争论:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T11:16:36.837

我根据预期的表大小使用标识和 int 或 bigint。我希望 LINQ 执行一个结合插入和键读取的单一查询。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T13:28:27.707

好的，我刚刚写了[一篇关于这个](http://vistadb.net/blog/news/microsoft-killing-linq-to-sql/)的博客。为了他人的利益，我在下面重新发布。

基本要点似乎是在 ado.net 博客上发表的评论，其中指出 Entity Framework 是 Visual Studio 2010 和 Dot Net 4 的唯一主要开发人员时间。

**我们已经知道这一点**

我的回答是——呃。我们都知道这一点。微软在 PDC 2007 上公开表示，LINQ to SQL 是 SQL Server 的短期版本，因为 SQL Server 没有其他 LINQ 故事。它仅适用于 SQL Server。您不能编写 LINQ to SQL 提供程序 - 它没有模型。这是一种一次性技术，不可扩展。

**实体框架 = 提供者**

实体框架是 Microsoft 构建 LINQ 提供程序的唯一方法。实体框架被证明是相当有争议的，但我认为这部分是因为 LINQ to SQL 今天有更好的程序员体验。Entity Framework 将赶上并超越 LINQ to SQL，因为它是 Microsoft 未来的 ORM/Mapping 工具。

我认为微软与我们、IBM、Oracle 等第三方供应商在实体框架方面进行了巨额投资。如果他们希望第三方开发人员和数据库支持 LINQ，他们必须有一个模型可以写入。实体框架就是答案。

去年当他们使用 VS 2008 而不是 EF 发布 LINQ to SQL 时，我看到了这一点。他们不应该发布具有如此多重叠的东西的封闭实现。我知道他们想要一个关系数据库的故事，但我认为他们说错了。现在有很多非常困惑的开发人员来向我们询问我们的 LINQ to SQL 提供程序。没有一个，因为你不能写一个。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T11:19:28.610

`uniqueidentifier`也可以自动插入，通过将数据库中的默认值设置为`NEWID()`.

# asp.net - 如何在 sql 和 asp:repeater 中编写用于自定义分页和自定义排序的 vb 代码

> ID：253190
> 
> 赞同：0
> 
> 时间：2008-10-31T11:16:46.837
> 
> 标签：asp.net

pl 使用存储过程在 asp:repeater 中提供用于自定义分页和排序的 vb 代码

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T11:46:24.917

这是 4guys 的第一步[和](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)第二步[，](http://aspnet.4guysfromrolla.com/articles/032206-1.aspx)它给出了非常清晰的解释，以及 VB 中所有代码的 zip 下载和示例 t-sql。

它处理 ObjectDataSource ，然后它应该足够简单以将您的转发器绑定到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T11:48:30.047

您将需要提供更多信息。如果您使用的是 ASP.NET 1.x，那么代码将与 ASP.NET 2.0 或更高版本的代码大不相同。确实，“自定义”分页和排序是什么意思？您可以使用 VS 创建一个调用存储过程并为您进行分页和排序的 DataSource，然后将数据源控件绑定到转发器。

# java - 内存少的jboss

> ID：253192
> 
> 赞同：7
> 
> 时间：2008-10-31T11:17:25.057
> 
> 标签：java, memory, jakarta-ee, jboss

我现在有 1gb 的内存在工作（我希望很快就会改变）而 jboss 占用了几乎一半的内存，这太多了，我关闭了日志记录到文件，我还能做些什么来减少内存使用量？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-31T11:44:00.087

您可以使用 -Xmx 参数限制使用的最大内存，就像在任何 java 进程中一样。编辑 $JBOSS_HOME/bin/run.conf 并将此参数设置为您想要分配给 JBoss 的所需最大内存。

此外，您可以从您正在使用的服务器配置的部署目录中删除您未使用的服务。要确定必须删除哪些文件才能删除未使用的服务，请查看[文档](http://www.jboss.org/file-access/default/members/jbossas/freezone/docs/Server_Configuration_Guide/beta500/html/index.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-31T11:42:09.310

您使用的是哪种配置？JBoss 带有 3 种[标准服务器配置](http://www.jboss.org/file-access/default/members/jbossas/freezone/docs/Server_Configuration_Guide/beta500/html/ch03s02.html)

*   ***最小***配置在没有任何企业服务的情况下启动核心服务器容器。如果您想构建一个只包含您需要的服务的定制版本的 JBoss AS，这是一个很好的起点。
*   ***默认***配置是应用程序开发人员最常用的配置。它支持标准 J2EE 1.4 和大多数 Java EE 5.0 编程 API（例如，JSF 和 EJB3）。
*   ***all***配置是具有集群支持和其他企业扩展的默认配置。

如果您只想要 JBoss 服务的特定子集，那么从最小的开始？

或者你可以[配置你自己的](http://www.jboss.org/file-access/default/members/jbossas/freezone/docs/Server_Configuration_Guide/beta500/html/ch04s02.html)？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-02T20:00:36.757

通过遵循 JBoss 社区 wiki 中的一些步骤，我能够将**默认配置文件的 JBoss 初始内存占用减少 100MB 以上。**
详细信息包括每个步骤可以节省多少内存：http: [//www.clickonchris.com/2011/06/tuning-reducing-jboss-memory-footprint/](http://www.clickonchris.com/2011/06/tuning-reducing-jboss-memory-footprint/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-06-02T23:27:06.747

您可以尝试使用最新版本的 JBoss（版本 6）。我认为它使用的内存更少，尽管我可能是错的。

# sharepoint - 除了配置文件之外，在 Sharepoint 中存储用户设置的地方

> ID：253196
> 
> 赞同：5
> 
> 时间：2008-10-31T11:18:21.047
> 
> 标签：sharepoint, profiles, settings

用户配置文件是否适合在用户选择的自定义网格中存储每页项目数等内容？（我可以将其存储在视图中，但不会以这种方式针对每个用户）。

我的第一个想法是将这些设置存储在用户配置文件中，但是以编程方式创建用户配置文件属性的访问权限存在问题，这归结为您必须在 SSP 中授予每个用户“管理用户配置文件”权限，或者您[必须运行应用程序域用户下的池，而不是 NETWORK SERVICE](https://stackoverflow.com/questions/82788/sharepoint-userprofilemanager-without-manage-user-profiles-right)。这两种情况对我来说都是不现实的，所以我现在正在寻找另一种方式来存储这种“每个用户”设置。

谢谢！

编辑：我现在正在考虑 ASP.NET 配置文件机制和一个额外的数据库来存储用户属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T20:13:37.543

Given that the information is not sensitive a simple database with values stored against AD login should suffice.

And as you have the ASP.Net user database already, storing the information there would be the best option.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T13:29:45.270

也许是一个全局列表，它只能由 SHAREPOINT\SYSTEM 用户访问，然后您可以在 SPSecurity.RunWithElevatedPrivileges 函数中进行查询。

缺点：您需要自定义代码才能读取/写入该列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T20:05:13.333

曲奇饼？

当然它们有限制，但是创建控件以运行 javascript 来添加/编辑值是相当容易的

# email - Outlook Express - 从命令行发送电子邮件

> ID：253198
> 
> 赞同：2
> 
> 时间：2008-10-31T11:18:52.993
> 
> 标签：email, command-line, outlook

从命令行使用 Outlook Express 发送电子邮件的最佳方式是什么？它必须是没有用户交互的自动化操作。附件中会有一些 .jpg 文件。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T11:20:36.423

也许[这篇文章](https://stackoverflow.com/questions/248569/starting-outlook-and-having-an-email-pre-populated-from-command-line)很有帮助。它会预先填充新的电子邮件消息并包含文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T11:33:14.340

是否真的需要使用 Outlook Express 发送电子邮件？

您不能使用第三方命令行电子邮件工具，还是需要它来使用 Outlook Express 的设置并让邮件最终出现在“已发送”文件夹中？

如果您可以使用第三方工具，[absoluteTools SendMail CMD](http://www.abspdf.com/products_toolsendmailcmd.html)之类的工具可能会完成这项工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T14:18:19.027

这个线程：我认为，[从 Windows 脚本发送邮件可能会对您有所帮助。](https://stackoverflow.com/questions/152323/send-mail-from-a-windows-script#152411 "从 Windows 脚本发送邮件")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T20:27:41.590

Quick'n 肮脏的[AutoIt](http://www.autoitscript.com/)脚本，您可以修改它以接受来自命令行的参数：

```
; Send a mail vía outlook "automation"

$sRcpt = "test@test.com"
$sSubj = "Test subject"
$sBody = "This is a test"
$sAttach = "g:\AutoIt\AnHoras.PRG"

If Not WinActivate ("[REGEXPTITLE:.*\- Outlook Express]") Then
    RunWait ("d:\Archivos de programa\Outlook Express\msimn.exe")   ; Set your path to the Outlook .exe
Endif

Send ("!anm")   ; Archivo->Nuevo->Mensaje (in spanish, sorry, I suppose that in english it will be File->New->Message)
Send ($sRcpt & "{Tab 3}")
Send ($sSubj & "{Tab}")
Send ($sBody)

If $sAttach <> "" Then
    Send ("!i{Enter}" & $sAttach & "{Enter}")      ; Insertar adjunto (Insert->Attachment)
EndIf

Send ("!a{Down}{Enter}")        ; Archivo->Enviar mensaje (File->Send message) 
```

# orm - Windows CE\Mobile 上的 Subsonic\ORM

> ID：253208
> 
> 赞同：2
> 
> 时间：2008-10-31T11:26:52.480
> 
> 标签：orm, windows-mobile, subsonic

有没有人设法让亚音速或变体在 Windows Mobile 上运行？我们无法让它工作，因为它依赖于 System.Configuration。

关于可在 Windows 移动设备上运行的备用 ORM 的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T13:52:08.050

System.Configuration 依赖是唯一的问题吗？如果是这样，您总是可以尝试通过添加该功能来解决它​​。例如， [OpenNETCF 的 SDF](http://opennetcf.com/Products/SmartDeviceFramework/tabid/65/Default.aspx)有一个 OpenNETCF.Configuration 命名空间，它反映了很多 System.Configuration 命名空间。您可能能够修改 subsonic 以使用该命名空间，或者修改并重新编译 SDF 的程序集以使用 System.Configuration 作为命名空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T18:31:17.160

我的一位同事在 Windows Mobile 项目中使用了[EntitySpaces](http://www.entityspaces.net)，并且对它非常满意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T13:53:37.173

你可以看看像[LLBLGEN](http://www.llblgen.com/pages/features.aspx)这样的东西，它显示了对紧凑框架的支持。

# c# - 如何阻塞直到异步作业完成

> ID：253211
> 
> 赞同：2
> 
> 时间：2008-10-31T11:28:25.130
> 
> 标签：c#, asynchronous, cuda, gpgpu

我正在开发一个 C# 库，它使用 NVIDIA 的 CUDA 将某些工作任务卸载到 GPU。一个例子是使用扩展方法将两个数组相加：

```
float[] a = new float[]{ ... }
float[] b = new float[]{ ... }
float[] c = a.Add(b); 
```

这段代码中的工作是在 GPU 上完成的。但是，我希望它异步完成，这样只有在需要结果时才会在 CPU 块上运行代码（如果结果尚未在 GPU 上完成）。为此，我创建了一个隐藏异步执行的 ExecutionResult 类。在使用中，它看起来如下：

```
float[] a = new float[]{ ... }
float[] b = new float[]{ ... }
ExecutionResult res = a.Add(b);
float[] c = res; //Implicit converter 
```

在最后一行，如果数据已经准备好，程序会阻塞。我不确定在 ExecutionResult 类中实现这种阻塞行为的最佳方法，因为我对同步线程和这类事情不是很有经验。

```
public class ExecutionResult<T>
{
    private T[] result;
    private long computed = 0;

    internal ExecutionResult(T[] a, T[] b, Action<T[], T[], Action<T[]>> f)
    {
        f(a, b, UpdateData); //Asych call - 'UpdateData' is the callback method
    }

    internal void UpdateData(T[] data)
    {
        if (Interlocked.Read(ref computed) == 0)
        {
            result = data;
            Interlocked.Exchange(ref computed, 1);
        }
    }

    public static implicit operator T[](ExecutionResult<T> r)
    {
        //This is obviously a stupid way to do it
        while (Interlocked.Read(ref r.computed) == 0)
        {
            Thread.Sleep(1);
        }

        return result;
    }
} 
```

传递给构造函数的 Action 是在 GPU 上执行实际工作的异步方法。嵌套的 Action 是异步回调方法。

我主要关心的是如何最好/最优雅地处理转换器中完成的等待，以及是否有更合适的方法来解决整个问题。如果我需要详细说明或进一步解释，请发表评论。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-31T11:30:54.173

我不清楚你正在实现多少框架以及调用其他代码多少，但我会尽可能遵循 .NET 中的[“正常”异步模式。](http://msdn.microsoft.com/en-us/library/ms228975.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T10:25:16.623

我发现该问题的解决方案是将一个函数传递给执行两件事的 ExecutionResult 构造函数。运行时，它开始异步工作，此外，它返回另一个返回所需结果的函数：

```
private Func<T[]> getResult;

internal ExecutionResult(T[] a, T[] b, Func<T[], T[], Func<T[]>> asynchBinaryFunction)
{
   getResult = asynchUnaryFunction(a);
}

public static implicit operator T[](ExecutionResult<T> r)
{
    return r.getResult();
} 
```

'getResult' 函数会阻塞，直到数据被计算并从 GPU 获取。这适用于 CUDA 驱动程序 API 的结构。

这是一个非常干净和简单的解决方案。由于 C# 允许通过访问本地范围创建匿名函数，因此只需替换传递给 ExecutionResult 构造函数的方法的阻塞部分，这样......

```
 ...

    status = LaunchGrid(func, length);

    //Fetch result
    float[] c = new float[length];
    status = CUDADriver.cuMemcpyDtoH(c, ptrA, byteSize);
    status = Free(ptrA, ptrB);

    return c;
} 
```

变成……

```
 ...

    status = LaunchGrid(func, length);

    return delegate
    {
        float[] c = new float[length];
        CUDADriver.cuMemcpyDtoH(c, ptrA, byteSize); //Blocks until work is done
        Free(ptrA, ptrB);
        return c;
    };
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T11:30:23.597

我想知道您是否不能在这里使用常规`Delegate.BeginInvoke`/ `Delegate.EndInvoke`？如果不是，那么等待句柄（例如 a `ManualResetEvent`）可能是一个选项：

```
using System.Threading;
static class Program {
    static void Main()
    {
        ThreadPool.QueueUserWorkItem(DoWork);

        System.Console.WriteLine("Main: waiting");
        wait.WaitOne();
        System.Console.WriteLine("Main: done");
    }
    static void DoWork(object state)
    {
        System.Console.WriteLine("DoWork: working");
        Thread.Sleep(5000); // simulate work
        System.Console.WriteLine("DoWork: done");
        wait.Set();
    }
    static readonly ManualResetEvent wait = new ManualResetEvent(false);

} 
```

请注意，如果你真的想要，你可以只使用 object 来做到这一点：

```
using System.Threading;
static class Program {
    static void Main()
    {
        object syncObj = new object();
        lock (syncObj)
        {
            ThreadPool.QueueUserWorkItem(DoWork, syncObj);

            System.Console.WriteLine("Main: waiting");
            Monitor.Wait(syncObj);
            System.Console.WriteLine("Main: done");
        }
    }
    static void DoWork(object syncObj)
    {

        System.Console.WriteLine("DoWork: working");
        Thread.Sleep(5000); // simulate work
        System.Console.WriteLine("DoWork: done");
        lock (syncObj)
        {
            Monitor.Pulse(syncObj);
        }
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-19T23:44:44.130

使用 cudaThreadSyncronize() 或 memcpy() 您可以执行同步操作 - 适用于 Invoke()。

CUDA 还允许您使用 callAsync() / sync() 请求异步内存传输 - 适用于使用 callAsync() 的 Begin/EndInvoke()。

# c++ - 什么是断言？你为什么要使用它们？

> ID：253212
> 
> 赞同：15
> 
> 时间：2008-10-31T11:28:32.883
> 
> 标签：c++, assert

c++中的断言是如何实现的？示例代码表示赞赏。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-10-31T11:34:30.013

断言是一种明确检查代码所做假设的方法，它可以帮助您通过缩小可能出现的问题来跟踪大量错误。它们通常只在应用程序的特殊“调试”版本中进行评估，因此它们不会减慢最终发布版本的速度。

假设您编写了一个将指针作为参数的函数。您的代码很有可能会假定指针为非 NULL，那么为什么不使用断言显式检查呢？就是这样：

```
#include <assert.h>

void function(int* pointer_arg)
{
    assert(pointer_arg != NULL);

    ...
} 
```

需要注意的重要一点是，您断言的表达式绝不能有副作用，因为它们不会出现在发布版本中。所以永远不要做这样的事情：

```
assert(a++ == 5); 
```

有些人还喜欢在他们的断言中添加一些小信息来帮助赋予它们意义。由于字符串总是评估为真，你可以这样写：

```
assert((a == 5) && "a has the wrong value!!"); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-31T11:33:25.103

断言是布尔表达式，通常应该始终为真。

它们用于确保您所期望的也会发生。

```
void some_function(int age)
{
     assert(age > 0);
} 
```

你编写了处理年龄的函数，你也“知道”你总是在传递合理的参数，然后你使用断言。这就像说“我知道这永远不会出错，但如果真的出错了，我想知道”，因为，嗯，每个人都会犯错。

因此，不要检查合理的用户输入，如果有可能出现问题的场景，请不要使用断言。进行真正的检查并处理错误。

断言通常仅用于调试构建，因此不要将具有副作用的代码放在断言中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-31T11:38:01.193

断言用于验证设计假设，通常根据输入参数和返回结果。例如

```
// Given customer and product details for a sale, generate an invoice

Invoice ProcessOrder(Customer Cust,Product Prod)
{
  assert(IsValid(Cust));
  assert(IsValid(Prod);
'
'
'
  assert(IsValid(RetInvoice))
   return(RetInvoice);

} 
```

代码运行不需要断言语句，但它们检查输入和输出的有效性。如果输入无效，则调用函数中存在错误。如果输入有效而输出无效，则此代码存在错误。有关断言的这种使用的更多详细信息，请参见[按合同设计。](http://en.wikipedia.org/wiki/Design_by_contract)

编辑：正如其他帖子中所指出的，assert 的默认实现不包含在发布运行时中。许多人（包括我自己）会使用的一种常见做法是将其替换为发布版本中包含的版本，但仅在诊断模式下调用。这可以通过完整的断言检查对发布版本进行适当的回归测试。我的版本如下；

```
extern  void _my_assert(void *, void *, unsigned);

#define myassert(exp)                               \
{                                                   \
    if (InDiagnostics)                              \
        if ( !(exp) )                               \
            _my_assert(#exp, __FILE__, __LINE__);   \
}                                                   \ 
```

这种技术的运行时开销很小，但它可以更轻松地跟踪任何使其进入该领域的错误。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-31T12:07:52.953

使用断言来检查“不可能发生”的情况。

典型用法：检查函数顶部的无效/不可能参数。

很少见到，但仍然有用：循环不变量和后置条件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-31T11:34:59.437

断言是允许您测试程序中可能存在的任何假设的语句。这对于记录程序逻辑（前置条件和后置条件）特别有用。失败的断言通常会引发运行时错误，并且表明您的程序存在严重错误 - 您的断言失败是因为您认为正确的事情不是。通常的原因是：你的函数逻辑有缺陷，或者你的函数的调用者传递了错误的数据。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-31T11:34:21.280

断言是您添加到程序中的东西，如果满足条件，它会导致程序立即停止，并显示错误消息。您通常将它们用于您认为在您的代码中永远不会发生的事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-31T16:24:04.140

这并没有解决从早期 C 时代就传给我们的*断言*工具，但是如果您的项目可以使用 Boost，您还应该了解[Boost StaticAssert](http://www.boost.org/doc/libs/1_36_0/doc/html/boost_staticassert.html)功能。

标准 C/C++ 断言在运行时工作。Boost StaticAssert 工具使您能够在编译时创建某些类的断言，甚至更早地捕获逻辑错误等。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-31T11:34:46.847

这是断言是什么的[定义，](http://en.wikipedia.org/wiki/Assert)[这里](http://www.cplusplus.com/reference/clibrary/cassert/assert.html)是一些示例代码。简而言之，断言是开发人员在任何给定点测试他（或她）关于代码状态的假设的一种方式。例如，如果您正在执行以下代码：

```
mypointer->myfunct(); 
```

您可能想要断言 mypointer 不为 NULL，因为这是您的假设—— mypointer 在调用之前永远不会为 NULL。

# java - 嵌套的 Java 枚举定义 - 声明为静态有什么不同吗？

> ID：253226
> 
> 赞同：55
> 
> 时间：2008-10-31T11:36:48.217
> 
> 标签：java, enums, class-design

我有一个界面 - 这是一个精心设计的版本作为示例：

```
public interface Particle {

    enum Charge {
        POSITIVE, NEGATIVE
    }

    Charge getCharge();

    double getMass();

    etc...
} 
```

`Charge`如果我将枚举定义为静态，那么它的实现方式会有什么不同- 即这是否有任何影响：

```
public interface Particle {

    static enum Charge {
        POSITIVE, NEGATIVE
    }

    Charge getCharge();

    double getMass();

    etc...
} 
```

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2008-10-31T12:08:17.697

不，没有区别。然而，正如 Jon 所说，原因并不是因为它是接口内的成员声明。真正的原因是根据语言规范（**8.9**）

> 嵌套枚举类型是隐式静态的。可以将嵌套枚举类型显式声明为静态。

在以下示例中，静态也没有任何区别（即使我们没有接口）：

```
public class A {
  enum E {A,B};
}

public class A {
  static enum E {A,B};
} 
```

另一个嵌套**私有**枚举的例子（不是隐式公开的）。

```
public class A {
  private static enum E {A,B}
} 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-10-31T11:45:26.400

不，没有区别。从[语言规范，第 9.5 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-9.html#jls-9.5)：

> 接口可能包含成员类型声明（[§8.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.5)）。接口中的成员类型声明是隐式的`static`and `public`。

# sql-server-2005 - SSRS05 预览中的单页报告在打印布局中显示只有页脚的第二页

> ID：253231
> 
> 赞同：1
> 
> 时间：2008-10-31T11:40:46.427
> 
> 标签：sql-server-2005, reporting-services

我有一个用户注销报告，其中显示了用户对系统的权限/访问权限，当我点击预览时，这一切都很好地适合一个页面。但是，当我然后去打印布局时，它显示了两页，第二页只包含页脚。

请问有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-17T06:37:56.120

设计时的报表大小加上边距必须小于纸张大小。有时您的报告可能太宽，实际上是在“右侧”而不是在第一页下方生成空白页。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T12:02:07.973

您确定页面尺寸与纸张尺寸匹配吗？

如果是这样，您是否尝试将页脚的 PrintOnLastPage 属性设置为 false？再说一次，如果你真的需要那个页脚（看到只有一页），你可能不得不尝试摆弄页边距以使其适合第一页。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T09:04:05.053

Yes I have scrunched it all up so that it is WELL within the page size and I have tried all combinations of Footers (and headers).

It is a slightly wierd report in that it has fields that need to grow to show all the information and a small table too, but even at full growth the data looks like it fits on one page (in preview in Visual Studio) but as soon as it goes to print preview and printing it reverts to two pages.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T08:41:29.463

你确定你也在属性表中调整了报表的显示大小吗？

希望这可以帮助，

账单

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T19:47:01.617

确保报告最后一个字段的右侧没有多余的区域。

# sql-server - 从安全/身份验证的角度来看，用户表应该包含哪些字段？

> ID：253238
> 
> 赞同：0
> 
> 时间：2008-10-31T11:44:47.947
> 
> 标签：sql-server, database, security, authentication

在设计用户表时，从基于 Web 的应用程序（.NET 和 SqlServer 2005）的安全/用户身份验证的角度来看，必须具有哪些字段

我附带了以下字段：

```
userID
username -- preferably email
passwordHash 
onceUsePassword -- to indicate that the password should be changed after login
alternativeContactEmail 
userStatusID -- FK to a lookup table with statuses like: active, diabled etc 
dateCreated
dateUpdated
lastPasswordUpdate
lastLogon
-- and then the rest like :forename, surname etc which are not of the interest in this question 
```

我错过了什么吗？

标准身份 (INT) 是否足以满足用户 ID 的要求，还是应该使用 GUID（用户 ID 不会在任何地方公开）？

**编辑：**

*   我仅限于使用 .NET 1.1（不要问...）
*   盐信息将与密码哈希合并
*   该帐户将通过向用户电子邮件地址发送一个临时的一次性系统生成的密码来解锁（因此为 onceUsePassword 字段）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T11:47:45.727

如果您仍然使用 SQL Server，为什么不直接使用内置的 SQL Membership Provider？它比自己滚动要好得多，因为它已经过很多人的测试。

在任何情况下，您都应该考虑在表中添加盐域。

[盐](http://en.wikipedia.org/wiki/Salt_(cryptography))

更新：.NET 1.1？我想这回答了我的问题。你的申请是面向大众消费的吗？如果是这样，您可能希望为他们添加一种通过秘密问题解锁帐户的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T12:24:30.503

> onceUsePassword -- 表示登录后应更改密码

如果你必须解释那么多，你应该重命名它。类似“forceChangePasswordOnLogin”的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T12:27:53.447

如果您的数据库遭到破坏，您应该添加一个“salt”字段来使用[密码](http://en.wikipedia.org/wiki/Password_salting)加盐以避免使用[彩虹表进行字典攻击。](http://en.wikipedia.org/wiki/Rainbow_table)

我不确定“盐信息将与密码哈希合并”是什么意思。这是否意味着所有密码哈希都使用相同的盐？为每个哈希生成随机盐并将其存储在单独的字段中会更有意义。

# sql-server - 如何拆分日期列并总结

> ID：253242
> 
> 赞同：1
> 
> 时间：2008-10-31T11:47:45.850
> 
> 标签：sql-server, tsql

我有一个查询，我有一个日期列（时间），它通过这一列告诉人们出席的“IN”和“OUT”时间

我的查询是：-

1）如何获取每个员工的每日出勤情况 2）如何知道员工在场时间是否少于 5 小时

请让我知道 SQL Server 中的查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T12:23:20.163

您需要按用户和特定日期的项目对查询进行分组，然后比较最大值和最小值，例如

```
declare @users table (
    UserId int, 
    DateColumn datetime
)

insert into @users values (1, '2008-10-31 15:15') 
insert into @users values (1, '2008-10-31 10:30') 
insert into @users values (1, '2008-10-30 16:15') 
insert into @users values (1, '2008-10-30 10:30') 

select
  UserID
  , cast(dt as datetime) dt
  , [in]
  , [out]
  , case when datepart(hour, [out]-[in]) >= 5 then 'yes' else 'no' end [5Hours?], 
  ,  cast(datediff(minute, [in], [out]) as float)/60 [hours] 
from (
  select
    UserID
    , convert(varchar, DateColumn, 112) dt
    , min(DateColumn) [in]
    , max(DateColumn) [out] 
  from @users 
  group by 
    UserID, convert(varchar, DateColumn, 112) 
    ) a 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T11:52:45.077

```
 select 
      datediff(minute, TimeFrom, TimeTo) as AttendedTimeInMinutes,
      case when datediff(minute, sTimeFrom, sTimeTo) < 5 * 60 
         then 
          'less than 5 hours' 
         else '5 hours or more' 
      end
   from YourTable 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T11:53:47.163

要查找两个日期时间之间的差异，您可以使用以下命令：

```
SELECT Datepart(hour, dateTimeEnd - dateTimeStart) 
```

DatePart 函数返回日期时间变量的一部分，dateTimeEnd - dateTimeStart 将两个日期之间的差作为新的 DateTime 返回

# iphone - 如何暂停 UIImageView 动画

> ID：253247
> 
> 赞同：3
> 
> 时间：2008-10-31T11:49:19.450
> 
> 标签：iphone, cocoa-touch, animation, uiimageview

我有一个使用 UIImageView 显示的动画：

```
imageView.animationImages = myImages;
imageView.animationDuration = 3;
[imageView startAnimating]; 
```

我知道我可以使用 stopAnimating 来停止它，但我想要的是能够暂停它。原因是当您调用停止时，您的动画图像都不会显示，而我希望在我按下按钮时显示的最后一个动画图像保持不变。

我尝试将持续时间设置为更大的数字，但这也会导致所有图像消失。必须有一个非常基本的方法来做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-09T04:08:46.493

此代码将在动画过程中将动画对象暂停在其当前位置。如果您记录其他变量，例如时间或进度或您需要的任何内容，再次恢复动画应该是相当简单的。

```
UIView *viewBeingAnimated = //your view that is being animated
viewBeingAnimated.frame = [[viewBeingAnimated.layer presentationLayer] frame];
[viewBeingAnimated.layer removeAllAnimations];
//when user unpauses, create new animation from current position. 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-31T22:14:46.850

嗯......因为似乎没有人知道我想这是不可能的。

我继续写了我自己`UIView`的 ,`UIImageView` `subview`使用 ,`NSTimer`来在图像之间切换。这样做的好处是我可以在闲暇时暂停和恢复计时器，性能似乎不是问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-02-11T14:51:09.497

@oddmeter 只是一点点编辑：

```
 animatedView.animationImages = images; //images is your array
    [animatedView startAnimating];

    //Then when you need to pause;

[animatedView stopAnimating]; //Important!!
    animatedView.image = [images objectAtIndex: 0]; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-03-20T20:02:38.270

这应该可以解决问题：[https ://developer.apple.com/library/ios/#qa/qa2009/qa1673.html](https://developer.apple.com/library/ios/#qa/qa2009/qa1673.html)

它基本上告诉您暂停/恢复任何`CALayer`基于动画所需的操作。

如果您对使用受控动画的`CALayer`方法感到不舒服，您总是可以自己制作基于数组的动画。所需的代码很短，您可以从这里获取：[http ://rssv2.blogspot.com/2011/04/animating-series-of-images-with-calayer.html](http://rssv2.blogspot.com/2011/04/animating-series-of-images-with-calayer.html)`UIImageView``UIImage`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-27T03:06:57.820

另一种选择是设置图像属性以及`animationImages`属性。这样做将在`UIImageView`其动画停止时显示静态图像。

假设您的类是图像的子类`UIImageView`并具有`NSMutableArray`图像，请执行以下操作：

```
self.animationImages = images;
//yes, I'm skipping the step to check and make sure you have at least one
//element in your array
self.image = [images objectAtIndex: 0]; 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-10-31T12:39:51.020

也许您可以截取最后一张动画图像并显示它？

# asp.net - 选项卡导航 - 框架还是 AJAX？

> ID：253248
> 
> 赞同：3
> 
> 时间：2008-10-31T11:52:33.750
> 
> 标签：asp.net, ajax, navigation, frames

我有我想像的非常标准的网络界面。

有 4 种不同的 ListViews（网格控件）可以通过顶部的一系列选项卡访问。

我已经实现了如下：

[替代文字 http://img402.imageshack.us/img402/1530/pagedu8.jpg](http://img402.imageshack.us/img402/1530/pagedu8.jpg)

Tab 1 会将包含 Grid 1 的 Page 1 加载到 Frame 2 中，Tab 2 会将包含 Grid 2 的 Page 2 加载到 Frame 2 中，依此类推。

但是，这意味着如果您单击网格中的某个项目，并且我将 DetailsPage1.aspx 加载到第 2 帧中，则第 1 帧和选项卡仍然可见且处于活动状态。

我被告知我应该只有一个框架，并使用 HttpRequest（或 asp.net 中的 WebRequest）根据选项卡单击动态加载页面。

这是正确的方法吗？如果您手头有任何资源或提示，将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T13:36:02.310

框架是绝对禁止的。使用其他技术无法实现的帧没有任何好处。

这是否意味着您必须使用 AJAX？不必要。如果您觉得需要提供丰富、无缝的界面，AJAX 是一个非常好的解决方案，但这并不是绝对必要的。

您可以使用服务器端包含将您的选项卡分隔到另一个（常见）子页面中，但是由于您提到了 ASP.NET，（假设您在框架 v2 或更高版本上运行）您可能想要使用母版页，您的选项卡位于一个内容部分或 Master 本身中，您的网格/详细信息位于另一个内容部分。

这两种技术之间的主要区别在于，使用 AJAX，从选项卡到选项卡的转换将是流畅和无缝的，但是 a）它需要一些额外的工作（特别是如果你不熟悉任何给定的 AJAX 框架）和 b）因为你基本上将 4 个页面合二为一，这些页面“更重”并且维护起来更复杂。如果您选择非 AJAX 路由，关键区别在于，当您单击每个选项卡时（因为它每次都会加载一个新页面），会有一个小而明显的刷新效果。

当然，无论如何，母版页对于保持一致的站点样式和结构很有用，因此没有理由不能将 AJAX 与母版页系统一起使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T11:55:37.957

框架是蹩脚的：如果用户想要设置书签并且用户通过谷歌访问您的网站，您会遇到问题：那么您的导航框架不可见。所以你需要很多肮脏的javascript。检查这一点。如果您需要 javascript，请从一开始就使用 AJAX

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-31T11:59:22.380

阿贾克斯是最佳选择。但请记住，通过后退/前进使其可浏览。最好的选择是更改页面哈希。我用过这样的东西：

domain.com/#tab1 用于第一个选项卡 domain.com/#tab2 用于第二个选项卡

等等。

如果您使用 jQuery，[这](http://stilbuero.de/jquery/history/)可能是一个好的开始（我使用它并且我没有问题）。我确信所有流行的框架都有解决方案:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-31T12:00:45.607

而不是使用框架，您应该只在所有其他页面中包含您的导航页面。浏览器将看到您在所有页面中都包含相同的文档并将其缓存。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T11:58:44.753

您是否尝试过[TabContainer](http://www.asp.net/Ajax/Ajaxcontroltoolkit/samples/Tabs/Tabs.aspx)或加载所有 4 个详细信息窗格并仅在选项卡选择更改时显示/隐藏面板？

根据您的用户将看到的屏幕，如果您动态加载详细视图（Ajax 或回发），您可能无法持久保存用户输入的任何信息，并且您将需要等待（用户不喜欢等待）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-31T12:01:36.790

我会推荐使用 jQuery 和 jQuery UI 插件。不需要框架，只需要 div 容器。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-31T12:07:24.687

与 StingyJack 一样，我建议您查看[TabContainer](http://www.asp.net/Ajax/Ajaxcontroltoolkit/samples/Tabs/Tabs.aspx)控件，但您可能需要注意，如果这样做，您的 ViewState 不会变得太大。

因此，例如，在查看该选项卡之前不要将任何内容加载到 GridView 中，如果不是，则删除它的内容（如果需要，当然保存回数据库。使用 TabContainer 的 ActiveTabChanged 事件将是此策略的关键。你为网格禁用 ViewState，但为容器保留它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-20T09:08:30.027

您使用的是 ASP.NET，因此只需将所有 4 个控件加载到一个多视图中，然后在回发时将可见的控件设置为已单击的按钮。

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.multiview.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.multiview.aspx)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-11-20T09:00:20.103

不要使用框架（或 iframe），除非你*绝对*必须......

我能想到使用 (i)frames 的唯一有效原因实际上是文件上传控件，我也不确定它在那里是否有效......

# c# - 您可以调用 Page.ClientScript.RegisterClientScriptBlock 的绝对最新时间是什么时候？

> ID：253267
> 
> 赞同：4
> 
> 时间：2008-10-31T12:04:15.037
> 
> 标签：c#, asp.net, javascript, web-controls

我需要根据消费者可以设置的一些处理和一些属性在 WebControl 中输出一些 JavaScript，在页面加载时执行此操作会为时过早。

我可以调用 RegisterClientScriptBlock 并且仍然在页面上输出的最新时间是什么时候？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-29T22:10:13.437

老问题，但我最近处理了这个问题，所以让蒂姆的回答更清楚一点，并清除一些错误信息：

如果您按照您的要求使用 RegisterClientScriptBlock，那么您的脚本将在 ClientScriptManager.RenderClientScriptBlocks 期间输出，这在 Page.BeginFormRender 期间调用 - 但它实际上是由 Form 调用的，而不是由 Page 本身调用的。

这是顺序：

*   Page.ProcessRequestMain（当它到达渲染部分时）调用
*   （页面的基类）Control.RenderControl 调用
*   Control.RenderChildren 循环遍历所有子控件并最终调用
*   HtmlForm.RenderControl 调用
*   HtmlForm.RenderChildren 这是我们关心的

从反射器：

```
protected internal override void RenderChildren(HtmlTextWriter writer)
{
    Page page = this.Page;
    if (page != null)
    {
        page.OnFormRender();
        page.BeginFormRender(writer, this.UniqueID);
    }
    base.RenderChildren(writer);
    if (page != null)
    {
        page.EndFormRender(writer, this.UniqueID);
        page.OnFormPostRender();
    }
} 
```

注意对 page.BeginFormRender 和 page.EndFormRender 的调用。在它们之间，表单调用它的 base.RenderChildren 最终将调用自定义用户控件上的 Render 方法。因此，对于您的原始问题，您不能在任何子控件的渲染序列期间随时与脚本的 ClientScriptBlocks 部分进行交互，因为它们已经输出到响应流。如果您在调用 base.Render 之前处于 Page 的 Render 方法中，则*可以*在 Render 序列期间将脚本添加到此块，正如 Tim 所提到的，但这在任何类型的子控件中都不起作用。

如果渲染序列是您必须使用的全部（这是我所处的情况），那么您可以在控件的渲染期间使用 ClientScript.RegisterStartupScript，因为在 page.EndFormRender 期间调用 RenderClientStartupScripts，这发生**在**您的控件被告知之后渲染，如您在上面的代码中所见。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T12:07:54.593

预渲染

或者，如果您在调用“base.Render”之前覆盖 Render....

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T12:12:22.617

从逻辑上讲，您的启动脚本需要在页面上进行渲染和注册，因此 Page_PreRender 事件似乎是一个不错的选择。之后，页面的 HTML 和脚本被“锁定”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T12:17:23.247

即使在主页上，您也可以在 PreRender 期间调用它。每个控件的 Render 函数在主页面的 PreRender 之后调用，因此 Render 函数将是一个安全的地方。

# c++ - 如何从不同头文件中的类继承？

> ID：253284
> 
> 赞同：5
> 
> 时间：2008-10-31T12:08:23.033
> 
> 标签：c++, inheritance, organization

我有依赖问题。我有两个班级：`Graphic`和`Image`。每个都有自己的 .cpp 和 .h 文件。我将它们声明如下：

`Graphic.h`：

```
 #include "Image.h"
    class Image;
    class Graphic {
      ...
    }; 
```

`Image.h`：

```
 #include "Graphic.h"
    class Graphic;
    class Image : public Graphic {
      ...
    };
```

当我尝试编译时，出现以下错误：

```
    Image.h:12：错误：“{”标记之前的预期类名

```

如果我删除`Graphic`from的前向声明，`Image.h`则会收到以下错误：

```
    Image.h:13：错误：不完整类型“结构图形”的无效使用
    Image.h:10：错误：“结构图形”的前向声明

```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-31T12:27:37.127

这对我有用：

图片.h：

```
#ifndef IMAGE_H
#define IMAGE_H

#include "Graphic.h"
class Image : public Graphic {

};

#endif 
```

图形.h：

```
#ifndef GRAPHIC_H
#define GRAPHIC_H

#include "Image.h"

class Graphic {
};

#endif 
```

以下代码编译没有错误：

```
#include "Graphic.h"

int main()
{
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-31T12:14:02.427

您不需要在 Graphic.h 中包含 Image.h 或转发声明 Image - 这是一个循环依赖。如果 Graphic.h 依赖于 Image.h 中的任何内容，则需要将其拆分为第三个标头。（如果 Graphic 有一个 Image 成员，那就行不通了。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-31T12:31:28.320

Graphic.h 不需要包含 image.h，也不需要转发声明 Image 类。此外， Image.h 不需要转发声明 Graphic 类，因为您 #include 定义该类的文件（您必须这样做）。

`Graphic.h:`

```
class Graphic {
  ...
}; 
```

`Image.h`：

```
#include "Graphic.h"
class Image : public Graphic {
  ...
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T12:14:37.013

由于 Image 扩展了 Graphic，因此请删除 Graphic.h 文件中包含的 Image。

`Graphic.h`

```
class Graphic {
  ...
}; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T12:15:18.963

首先删除它，您必须始终拥有完整的类定义才能从类继承：

```
class Graphic; 
```

其次，从 Graphic.h 中删除所有对 Image 的引用。父母通常不需要知道它的孩子。

# django - 为django设计模型结构

> ID：253286
> 
> 赞同：3
> 
> 时间：2008-10-31T12:08:55.993
> 
> 标签：django, database-design, django-models

我正在尝试为一个应用程序设计一个模型，允许 2 人互相下注（我知道，听起来很愚蠢......）。我想知道的是如何将赌注与用户联系起来。结构是这样的

```
|-------------|       |----------|
|    Bet      |       | User     |
| BetUser1    |       |----------|
| BetUser2    |
| Winner      |
| ...         |
|-------------| 
```

所以我们有 2 个人互相下注（都`Users`来自 django auth 系统），然后，在其中一个获胜后，就有一个赢家。现在所有这 3 个字段都是 type `User`，但是：

*   我应该让 BetUser1 和 BetUser2 分开字段，还是在这里设计一些多对二的关系？（多对二是多对多，并且通过某种外部方式确保`Users`每个赌注不能分配超过 2 个？
*   获胜者只能是用户 1 或用户 2，当然不能是其他人。我应该如何创建这个字段，另一个`ForeignKey(User)`，或者其他一些？

只是寻找一些新的观点，因为在这种愚蠢的情况下，我似乎被 django 模型系统困住了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T12:32:13.810

我可能会添加第三个模型来代表某人下的特定赌注，因为可以想象有两个以上的人可以下注。它看起来像这样：

```
USER        WAGER              BET
             User (FK(User))    Description
             Bet  (FK(Bet))     Winner (FK (Wager), null=True)
             Amount 
```

Django 会自动生成`user.wager_set`并`bet.wager_set`基于外键。这使您可以轻松地迭代和显示投注的投注，以及每个用户的投注。您还可以在 Wager 表中添加`unique_together`约束，`User`以便`Bet`每个用户只能下一个赌注。

当投注全部完成并选出获胜者后，您只需设置`bet.winner`.

万一你遇到它，你可能会看到一个关于`related_name`通过`Bet`指向`Wager`和`Wager`指向的警告`Bet`。要修复，只需添加`related_name=wagers`到`Wager.bet`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T13:33:54.637

您需要的是具有额外数​​据的多对多关系（例如，投注金额、输入时间……）

在关于编写模型的优秀 Django 文档中有一个[章节。](http://docs.djangoproject.com/en/dev/topics/db/models/#extra-fields-on-many-to-many-relationships)

Tyler 已经为此概述了适当的模式。

# php - 解决“意外的 $end”错误

> ID：253289
> 
> 赞同：0
> 
> 时间：2008-10-31T12:10:20.220
> 
> 标签：php

我是 PHP 新手，并试图让以下代码工作：

```
<?php
include 'config.php';
include 'opendb.php';

$query = "SELECT name, subject, message FROM contact";
$result = mysql_query($query);

while($row = mysql_fetch_array($result, MYSQL_ASSOC))
{
    echo "Name :{$row['name']} <br>" .
         "Subject : {$row['subject']} <br>" . 
         "Message : {$row['message']} <br><br>";
"ARTICLE_NO :{$row['ARTICLE_NO']} <br>" .
"ARTICLE_NAME :{$row['ARTICLE_NAME']} <br>" .
"SUBTITLE :{$row['SUBTITLE']} <br>" .
"CURRENT_BID :{$row['CURRENT_BID']} <br>" .
"START_PRICE :{$row['START_PRICE']} <br>" .
"BID_COUNT :{$row['BID_COUNT']} <br>" .
"QUANT_TOTAL :{$row['QUANT_TOTAL']} <br>" .
"QUANT_SOLD :{$row['QUANT_SOLD']} <br>" .
"STARTS :{$row['STARTS']} <br>" .
"ENDS :{$row['ENDS']} <br>" .
"ORIGIN_END :{$row['ORIGIN_END']} <br>" .
"SELLER_ID :{$row['SELLER_ID']} <br>" .
"BEST_BIDDER_ID :{$row['BEST_BIDDER_ID']} <br>" .
"FINISHED :{$row['FINISHED']} <br>" .
"WATCH :{$row['WATCH']} <br>" .
"BUYITNOW_PRICE :{$row['BUYITNOW_PRICE']} <br>" .
"PIC_URL :{$row['PIC_URL']} <br>" .
"PRIVATE_AUCTION :{$row['PRIVATE_AUCTION']} <br>" .
"AUCTION_TYPE :{$row['AUCTION_TYPE']} <br>" .
"INSERT_DATE :{$row['INSERT_DATE']} <br>" .
"UPDATE_DATE :{$row['UPDATE_DATE']} <br>" .
"CAT_1_ID :{$row['CAT_1_ID']} <br>" .
"CAT_2_ID :{$row['CAT_2_ID']} <br>" .
"ARTICLE_DESC :{$row['ARTICLE_DESC']} <br>" .
"DESC_TEXTONLY :{$row['DESC_TEXTONLY']} <br>" .
"COUNTRYCODE :{$row['COUNTRYCODE']} <br>" .
"LOCATION :{$row['LOCATION']} <br>" .
"CONDITIONS :{$row['CONDITIONS']} <br>" .
"REVISED :{$row['REVISED']} <br>" .
"PAYPAL_ACCEPT :{$row['PAYPAL_ACCEPT']} <br>" .
"PRE_TERMINATED :{$row['PRE_TERMINATED']} <br>" .
"SHIPPING_TO :{$row['SHIPPING_TO']} <br>" .
"FEE_INSERTION :{$row['FEE_INSERTION']} <br>" .
"FEE_FINAL :{$row['FEE_FINAL']} <br>" .
"FEE_LISTING :{$row['FEE_LISTING']} <br>" .
"PIC_XXL :{$row['PIC_XXL']} <br>" .
"PIC_DIASHOW :{$row['PIC_DIASHOW']} <br>" .
"PIC_COUNT :{$row['PIC_COUNT']} <br>" .
"ITEM_SITE_ID :{$row['ITEM_SITE_ID']};
 }

include 'closedb.php';

?> 
```

但是我收到此错误：

```
Parse error: syntax error, unexpected $end in C:\Programme\EasyPHP 2.0b1\www\test.php on line 56 
```

我还想知道是否有一种更简单的方法来获取 mysql 记录而不是手动输入？

编辑：

我修复了分号和引号问题，现在得到：

```
Parse error: syntax error, unexpected T_STRING in C:\Programme\EasyPHP 2.0b1\www\test.php on line 51 
```

对不起，我不知道如何在代码中制作颜色。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-31T12:15:25.857

**编辑**

你说你仍然得到一个错误。你记得添加一个**.** 当你删除了那个多余的分号？

* * *

你的字符串中间有一个分号，在回声之后两行。

![](https://farm4.static.flickr.com/3049/2989189590_754c627f5d.jpg?v=0)

此外，字符串的末尾缺少双引号。

![](https://farm4.static.flickr.com/3151/2988333441_7e6705715d.jpg?v=0)

* * *

至于输出所有值的更简洁的方法，您可以像这样遍历结果数组：

```
while($row = mysql_fetch_array($result, MYSQL_ASSOC))
{
  foreach($row as $field=>$value)
  {
    echo "$field: {$value} <br />";
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T12:18:14.680

对于您问题的第二部分，如果字段名称都是合乎逻辑的，您可以这样做：

```
while($row = mysql_fetch_array($result, MYSQL_ASSOC))
{
  foreach($row as $key => $value)
  {
    echo "$key: $value\n";
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T12:20:04.943

**编辑：** 您的 SQL 查询仅返回 3 个字段。但是您尝试访问的内容远不止这些。如果要返回表的所有字段，请尝试“SELECT *”。否则，请确保您选择了您尝试阅读的字段（可能不是您收到错误的原因，只是一个观察结果）。

语法着色

```
include 'closedb.php';

?> 
```

表示字符串缺少右引号。线

```
"ITEM_SITE_ID :{$row['ITEM_SITE_ID']}; 
```

证实了这一点。

还有线

```
"Message : {$row['message']} <br><br>"; 
```

结束字符串连接。分号应该是句号。

# internet-explorer-6 - Windows server 2003 上 IE6 Standalone 上的 Cookie？

> ID：253296
> 
> 赞同：1
> 
> 时间：2008-10-31T12:14:37.933
> 
> 标签：internet-explorer-6, internet-explorer-7, compatibility

我似乎无法让 IE6 和 IE7 在我的 Windows Server 2003 VPC 上同时运行。

我已经尝试过：[http](http://browsers.evolt.org/?ie/32bit/standalone) ://browsers.evolt.org/?ie/32bit/standalone 和： http: [//tredosoft.com/Multiple_IE](http://tredosoft.com/Multiple_IE)，是的，我尝试将 Wininet.dll 放在我的独立路径中。

浏览器可以工作，但 cookie 不能！任何帮助将不胜感激。

此外，我知道 Microsoft 提供的 VPC，但我也试图避免该解决方案，因为我正在另一个 VPC 上开发（这不会改变，一个原因是这些 VPC 是时间-有限），并且我想保持在我正在测试的同一台机器上开发的好处，即：我不想每次我想检查我的更新时都重新部署我的整个解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-10-31T12:55:21.190

所有这些方法都是黑客，不能保证有效。由于未知的副作用，您可能会在测试中遗漏一些东西。为什么不直接使用本文中解释的 VPC：[IE6 和 IE7 在单台机器上运行](http://www.testingreflections.com/node/view/4673)。

# validation - 为什么这个 XHTML 表单不验证？

> ID：253312
> 
> 赞同：2
> 
> 时间：2008-10-31T12:24:24.717
> 
> 标签：validation, xhtml, xhtml-1.0-strict

任何想法为什么这不会在这里验证：

[http://validator.w3.org/#validate_by_input](http://validator.w3.org/#validate_by_input)

似乎表单输入标签是错误的，但通过 XHTML 规范阅读它们应该可以很好地验证。有任何想法吗？

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <title>Test</title>
 </head>

 <body>
    <div class="Header">
        <table class="HeaderTable">
            <tr>
                <td>
                    <div class="Heading">Test <span class="Standard">Test</span>
                    </div>
                </td>
                <td>
                    <div class="Controls">
                        <form id="ControlForm" method="get" action="Edit.php">
                            <input type="submit" name="action" id="Edit" value="Edit" />
                            <input type="submit" name="action" id="New" value="New" />
                        </form>
                    </div>
                </td>
            </tr>
        </table>
    </div>
 </body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T12:35:24.117

尝试在输入周围放置`fieldset`标签。我认为 XHTML 中表单的想法是它们不能有不是 div、fieldset 等的直接后代。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T12:39:43.220

正如其他人所说：

[quote] 验证器告诉您隐藏的输入元素不能立即跟随表单标签 - 它需要具有某种容器元素。[/引用]

（[来源](http://www.webmasterworld.com/forum21/9223.htm)）

我想一个字段集可能会有所帮助；请参阅[XHTML DTD](http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd)：

```
<!ELEMENT form %form.content;>

<!ENTITY % form.content "(%block; | %misc;)*">

<!ENTITY % misc "noscript | %misc.inline;">
<!ENTITY % misc.inline "ins | del | script">

<!ENTITY % block "p | %heading; | div | %lists; | %blocktext; | fieldset | table">

<!ENTITY % heading "h1|h2|h3|h4|h5|h6">
<!ENTITY % lists "ul | ol | dl">
<!ENTITY % blocktext "pre | hr | blockquote | address"> 
```

你没有输入:(

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T12:40:50.533

你需要搬家

```
<div class="Controls"> 
```

这样它就**在****<form**标签内

* * *

这很好地验证了

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Test</title>
</head>

<body>
    <div class="Header">
        <table class="HeaderTable">
        <tr>
            <td>
                <div class="Heading">Test <span class="Standard">Test</span></div>
            </td>
            <td>
                <form id="ControlForm" method="get" action="Edit.php">
                    <div class="Controls">
                        <input type="submit" name="action" id="Edit" value="Edit" />
                        <input type="submit" name="action" id="New" value="New" />
                    </div>
                </form>
            </td>
        </tr>
        </table>
    </div>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-13T13:24:32.133

我遇到了同样的问题，我花了一些时间才弄清楚。这是 w3c 验证器的最新变化吗？只是我确定我的一些页面过去验证过表单，但现在它们似乎都因同一个问题而出现错误。

我以前总是做类似的事情：

```
<div>
<form>
    <label></label>
    <input />
    <label></label>
    <input />
    <label></label>
    <input />
</form> 
```

并得到验证错误，所以现在我只需在所有标签和输入周围添加字段集或 div 以使其验证，如下所示：

```
<div>
<form>
    <fieldset>or<div>
        <label></label>
        <input />
        <label></label>
        <input />
        <label></label>
        <input />
    </fieldset>or</div>
</form> 
```

似乎工作，但我确定我过去不必这样做......嗯？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T12:45:04.160

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <title>Test</title>
 </head>

 <body>
    <div class="Header">
        <table class="HeaderTable">
                <tr>
                        <td>
                                <div class="Heading">Test <span class="Standard">Test</span>
                                </div>
                        </td>
                        <td>

                            <form id="ControlForm" method="get" action="Edit.php">
                                <div class="Controls">
                                                <input type="submit" name="action" id="Edit" value="Edit" />
                                                <input type="submit" name="action" id="New" value="New" />
                                </div>
                            </form>

                        </td>
                </tr>
        </table>
    </div>
 </body>
</html> 
```

将您的 div 放入表单中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T12:53:57.823

您的输入元素应该在一个字段集中。这验证并具有使非可视用户代理更容易访问文档的额外好处。

顺便说一句，您的标记有点受到*divitis的影响。*您可以将类直接放在表格单元格上，而不是在其中嵌套 div 元素（我不打算评论使用表格进行布局）。此外，您可以直接设置表单元素的样式，而不是将其嵌套在 div 中。

无论如何，这是您添加了字段集的示例，因此可以验证：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Test</title>
  </head>
  <body>
    <div class="Header">
      <table class="HeaderTable">
        <tr>
          <td>
            <div class="Heading">Test <span class="Standard">Test</span></div>
          </td>
          <td>
            <div class="Controls">
              <form id="ControlForm" method="get" action="Edit.php">
                <fieldset>
                  <input type="submit" name="action" id="Edit" value="Edit" />
                  <input type="submit" name="action" id="New" value="New" />
                </fieldset>
              </form>
            </div>
          </td>
        </tr>
      </table>
    </div>
  </body>
</html> 
```

# language-agnostic - 异常或错误代码的约定

> ID：253314
> 
> 赞同：133
> 
> 时间：2008-10-31T12:24:57.663
> 
> 标签：language-agnostic, language-design

昨天，我与一位同事就首选的错误报告方法进行了激烈的辩论。我们主要讨论了在应用层或模块之间报告错误时使用异常或错误代码。

**您使用什么规则来决定是抛出异常还是返回错误代码以进行错误报告？**

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2008-10-31T13:03:17.837

在高级别的东西中，例外；在低级的东西中，错误代码。

异常的默认行为是展开堆栈并停止程序，如果我正在编写一个脚本并且我去寻找一个不在字典中的键，这可能是一个错误，我希望程序停止并让我知道这一切。

但是，如果我正在编写一段代码，我*必须知道*在所有可能的情况下的行为，那么我需要错误代码。否则，我必须知道函数中的每一行可能引发的每个异常，才能知道它会做什么（阅读[The Exception That Grounded an Airline](https://rads.stackoverflow.com/amzn/click/com/0978739213)以了解这是多么棘手）。编写对每种情况（包括不愉快的情况）做出适当反应的代码既乏味又困难，但这是因为编写无错误代码既乏味又困难，而不是因为您传递了错误代码。

[Raymond Chen](http://blogs.msdn.com/oldnewthing/archive/2005/01/14/352949.aspx) [和](http://www.joelonsoftware.com/items/2003/10/13.html) [Joel](http://www.joelonsoftware.com/articles/Wrong.html)都提出了一些雄辩的论点，反对对所有事情都使用异常。

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2008-10-31T12:25:55.273

我通常更喜欢异常，因为它们有更多的上下文信息，并且可以（在正确使用时）以更清晰的方式将错误传达给程序员。

另一方面，错误代码比异常更轻量级，但更难维护。错误检查可能会无意中被忽略。错误代码更难维护，因为您必须保留包含所有错误代码的目录，然后打开结果以查看引发了什么错误。错误范围在这里可能会有所帮助，因为如果我们唯一感兴趣的是我们是否存在错误，则检查起来更简单（例如，大于或等于 0 的 HRESULT 错误代码是成功的，并且小于零为失败）。它们可能会无意中被忽略，因为没有编程强制开发人员检查错误代码。另一方面，您不能忽略异常。

总而言之，在几乎所有情况下，我更喜欢异常而不是错误代码。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2008-10-31T12:30:10.867

我更喜欢例外，因为

*   他们打断了逻辑流程
*   他们受益于提供更多特性/功能的类层次结构
*   如果使用得当，可以表示范围广泛的错误（例如，InvalidMethodCallException 也是 LogicException，因为两者都发生在您的代码中存在应该在运行前检测到的错误时），并且
*   它们可用于增强错误（即 FileReadException 类定义可以包含检查文件是否存在或被锁定等的代码）

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2008-10-31T12:39:41.783

函数的调用者可以忽略错误代码（而且通常是！）。异常至少迫使他们以某种方式处理错误。即使他们处理它的版本是有一个空的 catch 处理程序（叹气）。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-10-31T12:48:51.407

错误代码的异常，毫无疑问。您可以从异常中获得许多与使用错误代码相同的好处，但还可以获得更多好处，而没有错误代码的缺点。唯一的例外是它的开销略大。但在当今时代，几乎所有应用程序的开销都可以忽略不计。

以下是一些讨论、比较和对比这两种技术的文章：

*   [Perl 中的面向对象异常处理](http://www.perl.com/pub/a/2002/11/14/exception.html)
*   [异常与状态返回](http://nedbatchelder.com/text/exceptions-vs-status.html)

有一些很好的链接可以让你进一步阅读。

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2008-10-31T16:16:40.410

我永远不会混合这两种模型......当您从堆栈的一个使用错误代码的部分移动到使用异常的更高部分时，从一个模型转换到另一个模型太难了。

例外情况是“任何停止或禁止方法或子例程执行您要求它执行的操作”...不要将有关异常情况或异常情况或系统状态等的消息传回。使用返回值或参考（或输出）参数。

异常允许使用依赖于方法函数的语义来编写（和使用）方法，即可以键入返回员工对象或员工列表的方法来执行此操作，并且您可以通过调用来使用它。

```
Employee EmpOfMonth = GetEmployeeOfTheMonth(); 
```

对于错误代码，所有方法都返回一个错误代码，因此，对于那些需要返回其他内容以供调用代码使用的方法，您必须传递一个引用变量以填充该数据，并测试返回值错误代码，并在每个函数或方法调用上处理它。

```
Employee EmpOfMonth; 
if (getEmployeeOfTheMonth(ref EmpOfMonth) == ERROR)
    // code to Handle the error here 
```

如果您的编码使每个方法只做一件简单的事情，那么只要该方法无法实现该方法的预期目标，您就应该抛出异常。以这种方式，异常比错误代码更丰富、更易于使用。您的代码更清晰 - “正常”代码路径的标准流程可以严格用于方法能够完成您想要它做的事情的情况......然后清理代码或处理当发生阻止方法成功完成的不良情况时，可以将“异常”情况与正常代码隔离开来。此外，如果您无法处理发生的异常，并且必须将其通过堆栈传递到 UI，（或​​者更糟糕的是，从中间层组件到 UI），那么使用异常模型，

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2017-10-19T06:28:32.020

**你应该同时使用两者。事情是决定何时使用每一个**。

在某些**情况下，例外是显而易见的选择**：

1.  在某些情况下**，你不能对错误代码做任何事情**，你只**需要在调用堆栈的上层处理它**，通常只是记录错误，向用户显示一些内容或关闭程序。在这些情况下，错误代码将要求您手动逐级冒泡错误代码，这显然更容易处理异常。关键是这是针对**意外和无法处理**的情况。

2.  然而，关于情况 1（发生意外和无法处理的事情，您只是不想记录它），异常可能会有所帮助，因为您可能会**添加上下文信息**。例如，如果我在较低级别的数据帮助程序中遇到 SqlException，我将希望在低级别（我知道导致错误的 SQL 命令）中捕获该错误，以便我可以捕获该信息**并重新抛出**附加信息. 请注意这里的神奇词：**重新投掷，而不是吞下**。 [异常处理的第一条规则：**不要吞下异常**](http://mikehadlow.blogspot.com/2009/08/first-rule-of-exception-handling-do-not.html)。另外，请注意，我的内部捕获不需要记录任何内容，因为外部捕获将具有整个堆栈跟踪并可能会记录它。

3.  在某些情况下，您有一系列命令，**如果其中任何一个命令失败**，您应该**清理/处置资源**(*)，无论这是不可恢复的情况（应该抛出）还是可恢复的情况（在这种情况下，您可以在本地或在调用者代码中处理，但您不需要异常）。显然，将所有这些命令放在一次尝试中要容易得多，而不是在每个方法之后测试错误代码，然后在 finally 块中进行清理/处置。请注意，**如果您希望错误冒泡（这可能是您想要的），您甚至不需要捕获它 - 您只需使用 finally 进行清理/处置**- 如果您愿意，您应该只使用 catch/retrow添加上下文信息（参见项目符号 2）。

    一个示例是事务块内的一系列 SQL 语句。同样，这也是一个“无法处理”的情况，即使您决定及早发现它（在本地处理而不是冒泡到顶部），它仍然是一个**致命的情况**，最好的结果是中止一切或至少中止一个大过程的一部分。
    (*) 这就像`on error goto`我们在旧的 Visual Basic 中使用的那样

4.  在构造函数中，您只能抛出异常。

话虽如此，在所有其他情况下，如果您返回一些信息，**调用者可以/应该采取一些行动**，使用返回码可能是更好的选择。这包括所有**预期的“错误”**，因为它们可能应该由直接调用者处理，并且几乎不需要在堆栈中向上冒泡太多级别。

当然，总是可以将预期的错误视为异常，然后立即捕获上一层，也可以在 try catch 中包含每一行代码，并对每个可能的错误采取措施。IMO，这是一个糟糕的设计，不仅因为它更加冗长，而且特别是因为如果不阅读源代码，可能引发的异常并不明显 - 并且可以从任何深层方法引发异常，从而创建[**不可见的 gotos**](https://www.joelonsoftware.com/2005/05/11/making-wrong-code-look-wrong/)。它们通过创建多个使代码难以阅读和检查的不可见退出点来破坏代码结构。换句话说，你永远不应该使用**异常作为[流控制](https://softwareengineering.stackexchange.com/questions/189222/are-exceptions-as-control-flow-considered-a-serious-antipattern-if-so-why)**，因为这对于其他人来说很难理解和维护。甚至很难理解所有可能的测试代码流。
再次：**为了正确清理/处置，您可以使用 try-finally 而不捕获任何东西**。

最流行的关于返回码的批评是“有人可以忽略错误代码，但在同样的意义上，有人也可以吞下异常。[**糟糕的异常处理**在这两种方法中都很容易。但是**编写好的基于错误代码的程序仍然容易得多而不是编写一个基于异常的程序**](https://blogs.msdn.microsoft.com/oldnewthing/20050114-00/?p=36693/)。如果一个人出于任何原因决定忽略所有错误（旧的`on error resume next`），你可以很容易地用返回码做到这一点，如果没有大量的 try-catchs 样板，你就无法做到这一点。

关于返回码的第二个最受欢迎的批评是“很难冒泡”——但这是因为人们不明白异常是针对不可恢复的情况，而错误码不是。

在异常和错误代码之间做出决定是一个灰色区域。您甚至可能需要从一些可重用的业务方法中获取错误代码，然后您决定将其包装到异常中（可能添加信息）并让它冒泡。但是假设所有错误都应该作为异常抛出是一个设计错误。

把它们加起来：

*   当我遇到意外情况时，我喜欢使用异常，在这种情况下没什么可做的，通常我们想中止一大块代码甚至整个操作或程序。这就像旧的“on error goto”。

*   当我预期调用者代码可以/应该采取一些行动时，我喜欢使用返回码。这包括大多数业务方法、API、验证等。

异常和错误代码之间的这种区别是 GO 语言的设计原则之一，它对致命的意外情况使用“恐慌”，而将常规预期情况作为错误返回。

然而，关于 GO，它还允许[多个返回值](https://gobyexample.com/multiple-return-values)，这对使用返回码有很大帮助，因为您可以同时返回错误和其他内容。在 C#/Java 上，我们可以通过 out 参数、元组或（我最喜欢的）泛型来实现，它们与枚举结合可以为调用者提供清晰的错误代码：

```
public MethodResult<CreateOrderResultCodeEnum, Order> CreateOrder(CreateOrderOptions options)
{
    ....
    return MethodResult<CreateOrderResultCodeEnum>.CreateError(CreateOrderResultCodeEnum.NO_DELIVERY_AVAILABLE, "There is no delivery service in your area");

    ...
    return MethodResult<CreateOrderResultCodeEnum>.CreateSuccess(CreateOrderResultCodeEnum.SUCCESS, order);
}

var result = CreateOrder(options);
if (result.ResultCode == CreateOrderResultCodeEnum.OUT_OF_STOCK)
    // do something
else if (result.ResultCode == CreateOrderResultCodeEnum.SUCCESS)
    order = result.Entity; // etc... 
```

如果我在我的方法中添加一个新的可能返回值，我什至可以检查所有调用者是否在 switch 语句中覆盖了该新值。除了例外，你真的不能这样做。当您使用返回码时，您通常会提前知道所有可能的错误，并对其进行测试。除了例外，您通常不知道会发生什么。将枚举包装在异常中（而不是泛型）是一种替代方法（只要清楚每种方法将抛出的异常类型），但 IMO 它仍然是糟糕的设计。

**编辑 2020-10-11**：

由于 C# 7.0（2017 年 3 月）而不是泛型，我更喜欢使用允许多个返回值的[新元组语法](https://stackoverflow.com/a/36436255/3606250)（因此我们可以使用类似 GO 的语法，其中方法返回结果或错误）。

```
 public enum CreateUserResultCodeEnum
{
    [Description("Username not available")]
    NOT_AVAILABLE,
}

public (User user, CreateUserResultCodeEnum? error) CreateUser(string userName)
    // (try to create user, check if not available...)
    if (notAvailable)
        return (null, CreateUserResultCodeEnum.NOT_AVAILABLE);
    return (user, null);
}

// How to call and deconstruct tuple:
(var user, var error) = CreateUser("john.doe");
if (user != null) ...
if (error == CreateUserResultCodeEnum.NOT_AVAILABLE) ...

// Or returning a single object (named tuple):
var result = CreateUser("john.doe");
if (result.user != null) ...
if (result.error == CreateUserResultCodeEnum.NOT_AVAILABLE) ... 
```

**编辑 2021-01-09**：

几天前，[我写了这篇博客文章](https://drizin.io/using-multiple-return-values-instead-of-exceptions/)，介绍我们如何（在某些情况下！）使用多个返回而不是异常（就像上面解释的 golang 约定，不应该替换所有异常，但应该让你决定何时使用异常以及何时使用返回码）。在这篇文章的最后，我混合了两个模型——基本上我使用的是**ValueTuple 语法（非常简洁和优雅），但仍然使用泛型**作为底层结构。基本上我使用**隐式转换运算符**和**类型解构函数**`ValueTuple`在and之间来回转换`CommandResult<TEntity, TError>`。

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2008-10-31T12:30:16.217

过去我加入了错误代码阵营（做过太多的 C 编程）。但现在我看到了曙光。

是的，异常对系统来说有点负担。但是它们简化了代码，减少了错误（和 WTF）的数量。

所以使用异常，但要明智地使用它们。他们将成为你的朋友。

作为旁注。我已经学会记录哪种方法可以抛出哪个异常。不幸的是，大多数语言都不需要这样做。但它增加了在正确级别处理正确异常的机会。

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2015-02-21T17:17:11.287

在某些情况下，以干净、清晰、正确的方式使用异常可能很麻烦，但绝大多数情况下，异常是显而易见的选择。异常处理相对于错误代码的最大好处是它改变了执行流程，这很重要有两个原因。

发生异常时，应用程序不再遵循其“正常”执行路径。这一点如此重要的第一个原因是，除非代码的作者运行良好并且真正避免做坏事，否则程序将停止并且不会继续做不可预测的事情。如果错误代码没有得到检查，并且没有采取适当的措施来响应错误的错误代码，程序将继续做它正在做的事情，谁知道该操作的结果将是什么。在很多情况下，让程序做“任何事情”最终可能会非常昂贵。考虑一个程序，该程序检索公司销售的各种金融工具的绩效信息，并将该信息传递给经纪人/批发商。如果出现问题并且程序继续运行，它可能会向经纪人和批发商发送错误的绩效数据。我不了解其他人，但我不想成为坐在副总裁办公室解释为什么我的代码导致公司受到 7 位数监管罚款的人。向客户提供错误消息通常比提供可能看起来“真实”的错误数据更可取，而后一种情况更容易使用错误代码等激进得多的方法遇到。

我喜欢异常及其破坏正常执行的第二个原因是，它将“正常的事情正在发生”逻辑与“出现问题的逻辑”分开变得非常容易。对我来说，这：

```
try {
    // Normal things are happening logic
catch (// A problem) {
    // Something went wrong logic
} 
```

...比这更可取：

```
// Some normal stuff logic
if (errorCode means error) {
    // Some stuff went wrong logic
}
// Some normal stuff logic
if (errorCode means error) {
    // Some stuff went wrong logic
}
// Some normal stuff logic
if (errorCode means error) {
    // Some stuff went wrong logic
} 
```

还有其他一些关于异常的小事也很好。有一堆条件逻辑来跟踪函数中调用的任何方法是否返回了错误代码，并返回更高的错误代码是很多样板。事实上，很多样板都会出错。我对大多数语言的异常系统有更多的信心，而不是“刚从大学毕业” Fred 写的一堆 if-else-if-else 语句，而且我还有很多更好的事情要做用我的时间比代码审查说鼠窝。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-10-31T13:03:58.427

我的理由是，如果您正在编写一个真正需要性能的低级驱动程序，那么请使用错误代码。但是，如果您在更高级别的应用程序中使用该代码并且它可以处理一些开销，那么使用一个接口包装该代码，该接口检查这些错误代码并引发异常。

在所有其他情况下，例外可能是要走的路。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2008-10-31T13:50:21.657

我的方法是我们可以同时使用两者，即异常和错误代码。

我习惯于定义几种类型的异常（例如：DataValidationException 或 ProcessInterruptExcepion），并在每个异常内部定义每个问题的更详细描述。

Java中的一个简单示例：

```
public class DataValidationException extends Exception {

    private DataValidation error;

    /**
     * 
     */
    DataValidationException(DataValidation dataValidation) {
        super();
        this.error = dataValidation;
    }

}

enum DataValidation{

    TOO_SMALL(1,"The input is too small"),

    TOO_LARGE(2,"The input is too large");

    private DataValidation(int code, String input) {
        this.input = input;
        this.code = code;
    }

    private String input;

    private int code;

} 
```

通过这种方式，我使用异常来定义类别错误，并使用错误代码来定义有关问题的更详细信息。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2008-10-31T14:38:48.033

我可能坐在这里的栅栏上，但是...

1.  这取决于语言。
2.  无论您选择哪种型号，都要始终如一地使用它。

在 Python 中，使用异常是标准做法，我很乐意定义自己的异常。在 C 中，你根本没有例外。

在 C++ 中（至少在 STL 中），异常通常只针对真正的异常错误引发（我自己几乎从未见过它们）。我认为没有理由在我自己的代码中做任何不同的事情。是的，忽略返回值很容易，但 C++ 也不会强迫您捕获异常。我认为你只需要养成这样做的习惯。

我工作的代码库主要是 C++，我们几乎在所有地方都使用错误代码，但是有一个模块会针对任何错误引发异常，包括非常普通的错误，并且使用该模块的所有代码都非常糟糕。但这可能只是因为我们混合了异常和错误代码。始终使用错误代码的代码更容易使用。如果我们的代码始终使用异常，也许它不会那么糟糕。将两者混合似乎效果不佳。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2008-10-31T19:42:58.760

因为我使用 C++，并且有 RAII 来保证它们使用安全，所以我几乎只使用异常。它将错误处理从正常的程序流程中拉出来，并使意图更加清晰。

不过，我确实为特殊情况留下了例外。如果我预计某个错误会发生很多，我会在执行之前检查操作是否成功，或者调用使用错误代码的函数版本（如`TryParse()`）

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2008-10-31T12:37:26.530

方法签名应该向您传达该方法的作用。类似 long errorCode = getErrorCode(); 可能没问题，但是 long errorCode = fetchRecord(); 令人困惑。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2008-10-31T14:47:02.540

异常是针对*特殊*情况的——即，当它们不是正常代码流的一部分时。

将异常和错误代码混合使用是非常合理的，其中错误代码代表某事的状态，而不是代码本身运行中的错误（例如检查子进程的返回代码）。

但是当异常情况发生时，我相信异常是最有表现力的模型。

在某些情况下，您可能更喜欢或不得不使用错误代码来代替异常，并且已经充分涵盖了这些情况（除了编译器支持等其他明显的约束）。

但从另一个方向来看，使用异常可以让您为错误处理构建更高级别的抽象，这可以使您的代码更具表现力和自然。我强烈建议阅读 C++ 专家 Andrei Alexandrescu 撰写的这篇出色但被低估的文章，主题是他所谓的“强制执行”：[http](http://www.ddj.com/cpp/184403864) ://www.ddj.com/cpp/184403864 。虽然这是一篇 C++ 文章，但原则是普遍适用的，而且我已经非常成功地将强制概念转换为 C#。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-03-27T19:25:59.463

首先，我同意 Tom 的[回答](https://stackoverflow.com/a/253393/450913)，即对于高级的东西使用异常，而对于低级的东西使用错误代码，只要它不是面向服务的体系结构 (SOA)。

在 SOA 中，可以跨不同机器调用方法，异常可能不会通过网络传递，相反，我们使用具有如下结构的成功/失败响应 (C#)：

```
public class ServiceResponse
{
    public bool IsSuccess => string.IsNullOrEmpty(this.ErrorMessage);

    public string ErrorMessage { get; set; }
}

public class ServiceResponse<TResult> : ServiceResponse
{
    public TResult Result { get; set; }
} 
```

并像这样使用：

```
public async Task<ServiceResponse<string>> GetUserName(Guid userId)
{
    var response = await this.GetUser(userId);
    if (!response.IsSuccess) return new ServiceResponse<string>
    {
        ErrorMessage = $"Failed to get user."
    };
    return new ServiceResponse<string>
    {
        Result = user.Name
    };
} 
```

当这些在您的服务响应中始终如一地使用时，它会创建一个非常好的模式来处理应用程序中的成功/失败。这允许在服务内以及跨服务的异步调用中更轻松地处理错误。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2013-10-14T15:11:36.810

我更喜欢所有错误情况的异常，除非失败是返回原始数据类型的函数的预期无错误结果。例如，在较大的字符串中查找子字符串的索引如果未找到，通常会返回 -1，而不是引发 NotFoundException。

返回可能被取消引用的无效指针（例如，在 Java 中导致 NullPointerException）是不可接受的。

使用多个不同的数字错误代码（-1，-2）作为同一函数的返回值通常是不好的风格，因为客户端可能会执行“== -1”检查而不是“< 0”。

这里要记住的一件事是随着时间的推移 API 的演变。一个好的 API 允许在不破坏客户端的情况下以多种方式更改和扩展故障行为。例如，如果客户端错误句柄检查了 4 个错误情况，并且您向函数添加了第五个错误值，则客户端处理程序可能不会对此进行测试并中断。如果您提出异常，这通常会使客户更容易迁移到更新版本的库。

要考虑的另一件事是，在团队中工作时，在哪里为所有开发人员做出这样的决定划清界限。例如，“高级事物的例外，低级事物的错误代码”是非常主观的。

在任何情况下，如果可能出现不止一种微不足道的错误，源代码不应该使用数字文字来返回错误代码或处理它（返回 -7，如果 x == -7 ...），但是总是一个命名常量（返回 NO_SUCH_FOO，如果 x == NO_SUCH_FOO）。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2014-03-22T12:31:02.467

如果你在大项目下工作，你不能只使用异常或只使用错误代码。在不同的情况下，您应该使用不同的方法。

例如，您决定只使用例外。但是一旦你决定使用异步事件处理。在这种情况下使用异常进行错误处理是个坏主意。但是在应用程序中到处使用错误代码是乏味的。

所以我认为同时使用异常和错误代码是正常的。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-10-31T12:46:02.987

对于大多数应用程序，例外情况更好。例外情况是软件必须与其他设备通信。我工作的领域是工业控制。这里错误代码是首选和预期的。所以我的回答是视情况而定。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-03-03T09:03:39.840

我认为这还取决于您是否真的需要结果中的堆栈跟踪等信息。如果是的话，你肯定会选择 Exception ，它为对象提供了很多关于问题的信息。但是，如果您只对结果感兴趣并且不在乎为什么会出现该结果，那么请使用错误代码。

例如，当您在处理文件并遇到 IOException 时，客户端可能有兴趣知道从何处触发、打开文件或解析文件等。所以最好返回 IOException 或其特定的子类。但是，如果您有登录方法并且您想知道它是否成功，那么您只需返回布尔值或显示正确的消息，返回错误代码。在这里，客户端对知道哪个逻辑部分导致了该错误代码不感兴趣。他只知道它的凭据是否无效或帐户锁定等。

我能想到的另一个用例是数据在网络上传输时。您的远程方法可以只返回错误代码而不是异常，以最大限度地减少数据传输。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2017-05-15T13:46:51.207

我的一般规则是：

*   函数中只能出现一个错误：使用错误代码（作为函数的参数）
*   可能会出现多个特定错误：抛出异常

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2008-10-31T12:40:53.730

当您的方法返回数值以外的任何值时，错误代码也不起作用......

# sql-server - 如何获取带有括号和所有内容的 SQL Server 列定义？

> ID：253324
> 
> 赞同：4
> 
> 时间：2008-10-31T12:30:09.383
> 
> 标签：sql-server, types, information-schema

我需要一种聪明的方法，以一种可以在 CREATE TABLE 语句中使用的方式从 INFORMATION_SCHEMA.COLUMNS 中获取数据类型。问题是需要理解的“额外”字段，例如 NUMERIC `_`PRECISION 和 NUMERIC `_`SCALE。

显然，我可以忽略 INTEGER 的列（精度为 10，小数位数为 0），但还有其他类型我会感兴趣，例如 NUMERIC。因此，无需编写大量代码来解析表，关于如何从列定义中获得一种字段速记的任何想法？

我希望能够得到类似：int、datetime、money、numeric**(10,2)**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-31T12:50:16.893

```
select column_type = data_type + 
    case
        when data_type like '%text' then ''
        when data_type like '%char' and character_maximum_length = -1 then '(max)'
        when character_maximum_length is not null then '(' + convert(varchar(10), character_maximum_length) + ')'
        when data_type = 'numeric' then '(' + convert(varchar(10), isnull(numeric_precision, 18)) + ', ' + 
            convert(varchar(10), isnull(numeric_scale, 0)) + ')'
        else ''
    end
,*
from information_schema.columns 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-27T20:03:41.633

这是[GalacticCowboy 的答案](https://stackoverflow.com/a/253374/880904)的更新（盗版！），用于修复一些问题并更新所有（我认为）SQL Server 2008R2 数据类型：

```
select data_type + 
    case
        when data_type like '%text' or data_type in ('image', 'sql_variant' ,'xml')
            then ''
        when data_type in ('float')
            then '(' + cast(coalesce(numeric_precision, 18) as varchar(11)) + ')'
        when data_type in ('datetime2', 'datetimeoffset', 'time')
            then '(' + cast(coalesce(datetime_precision, 7) as varchar(11)) + ')'
        when data_type in ('decimal', 'numeric')
            then '(' + cast(coalesce(numeric_precision, 18) as varchar(11)) + ',' + cast(coalesce(numeric_scale, 0) as varchar(11)) + ')'
        when (data_type like '%binary' or data_type like '%char') and character_maximum_length = -1
            then '(max)'
        when character_maximum_length is not null
            then '(' + cast(character_maximum_length as varchar(11)) + ')'
        else ''
    end as CONDENSED_TYPE
    , *
from information_schema.columns
order by table_schema, table_name, ordinal_position 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T12:31:27.290

SMO 脚本应该负责脚本生成。我相信这就是 MS 在 SQL Management Studio 中用于脚本生成的东西。

[http://msdn.microsoft.com/en-us/library/ms162153.aspx](http://msdn.microsoft.com/en-us/library/ms162153.aspx)

@你的评论 -`I need a smart way to get the data types out of INFORMATION_SCHEMA.COLUMNS in a way that could be used in a CREATE TABLE statement`

这就是你所要求的。除此之外，您将不得不解析信息架构视图结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-19T10:19:21.460

如果您使用的是 smo，则可以通过访问[Column 对象的 Properties 集合来获得精度和比例](http://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.column_properties.aspx)

Column.Property["NumericScale"].Value

Column.Property["NumericPrecision"].Value

# ruby-on-rails - RESTful 应用程序中的 XSRF

> ID：253327
> 
> 赞同：3
> 
> 时间：2008-10-31T12:30:23.377
> 
> 标签：ruby-on-rails, rest, csrf

我是一名尝试学习 Rails 和 RESTful 方法的 ASP.NET 开发人员。为了理解，我打算编写一个电子邮件客户端，它会对服务器进行 RESTful GET 调用以获取电子邮件并通过 POST 发送电子邮件。

要遵循哪些最佳实践（通用和/或特定于 Rails），以便上述应用程序不会暴露任何 XSRF 漏洞。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T15:54:27.973

[Ruby on Rails 安全项目](http://www.rorsecurity.info/2008/05/05/csrf-an-underestimated-attack-method/)对此有一篇很好的文章。

本质上，Rails 2.0 及更高版本具有针对 XSRF 攻击的内置保护。通过表单助手创建的每个表单都包含一个带有特殊标记的隐藏字段。每次收到 POST（或非 GET）时，都会根据服务器上的机密检查令牌。如果它们不匹配，则会引发安全异常并忽略请求。

阅读文章。他们在解释方面做得更好。

# javascript - Visual Studio for Javascript 中的大括号突出显示？

> ID：253338
> 
> 赞同：23
> 
> 时间：2008-10-31T12:35:05.677
> 
> 标签：javascript, visual-studio-2008, ide, resharper

有没有办法让 Visual Studio 2008 为 Javascript 进行匹配的大括号突出显示？

如果在 Studio 中没有办法，可以使用 ReSharper 完成吗？

谢谢！！

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-19T18:11:14.183

请注意，Visual Studio 仍将通过 Ctrl + ] 在 JavaScript 中找到匹配的大括号。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2011-01-27T18:58:35.110

这是 VS2010 的扩展，可以满足您的需求。而且它是免费的！

[http://visualstudiogallery.msdn.microsoft.com/872d27ee-38c7-4a97-98dc-0d8a431cc2ed](http://visualstudiogallery.msdn.microsoft.com/872d27ee-38c7-4a97-98dc-0d8a431cc2ed)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-03T13:29:13.263

你可以试试 Visual Assist X： http: [//www.wholetomato.com/](http://www.wholetomato.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T22:08:43.270

对于它的价值，我使用了最优秀的 ViEmu 插件 for Visual Studio，它提供了 Vi(m) paren/brace/bracket 匹配。

ViEmu 来[了](http://www.viemu.com)

当然，如果你不是 Vi 爱好者，匹配括号的价格可能太高了。;)

# java - Java - 改变对按键的关注

> ID：253351
> 
> 赞同：1
> 
> 时间：2008-10-31T12:40:42.810
> 
> 标签：java, eclipse, focus, swt, traversal

我正在使用 Eclipse 和 SWT 编写用于数据输入的 Java 应用程序。自然，它有很多 Text 对象。

我想要发生的是，当用户在一个字段中输入某些内容时，焦点会自动更改为下一个字段。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T16:03:31.357

```
final Text textBox = new Text(shell, SWT.NONE);
textBox.addKeyListener(new KeyAdapter() {
    public void keyPressed(KeyEvent e) {
        if (x.getText().length() == 1); {
            x.traverse(SWT.TRAVERSE_TAB_NEXT);
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-01T19:30:07.040

您可能还想看看 VerifyListener 接口。请参阅这篇有趣的博客文章以获取警告：http: [//eclipsenuggets.blogspot.com/2008/10/eclipse-bug-patterns-selfish-validation.html](http://eclipsenuggets.blogspot.com/2008/10/eclipse-bug-patterns-selfish-validation.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T16:10:44.977

```
final Text textBox = new Text(shell, SWT.NONE);
textBox.addKeyListener(new KeyAdapter() {

    public void keyPressed(KeyEvent arg0) {
        if (textBox.getText().equals("") == false) {
            textBox.traverse(SWT.TRAVERSE_TAB_NEXT);
        }
    }}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-01T18:59:01.080

我假设您想在填充字段*后更改焦点。*我建议使用 DocumentListener（或任何 SWT 调用它）来通知字段内容的更改：如果它具有正确数量的字符，则跳转到下一个字段。

# java - Eclipse 问题视图不再显示错误

> ID：253357
> 
> 赞同：76
> 
> 时间：2008-10-31T12:42:41.323
> 
> 标签：java, eclipse

由于某种原因，Eclipse 不再在问题视图中向我显示 Java 编译错误。

它仍然显示警告。

这突然发生了，我想不出我所做的任何改变会影响到这一点。

我正在使用“Maven Integration for Eclipse”插件，但我已经使用了一段时间 - 不确定这是否会影响它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-01-04T21:03:24.867

我有同样的问题，随机做了（几次）这样的事情：

1) Project->Clean...,
2) 关闭并再次打开 Eclipse,
3) Run As...

它再次开始工作，无需更改配置。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-09-17T11:03:31.633

右键单击您的项目并转到属性 > Java 构建路径 > 源。

确保您的源目录（例如 MyProject/src）列为 Source 文件夹。否则你不会得到任何红色标记。

* * *

## 回答 #3

> 赞同：41
> 
> 时间：2011-07-22T16:04:11.593

如果谷歌给你带来这个问题，我想在这里发布我的故事。

不知何故，“项目->自动构建”被关闭了。

重新打开它会生成正确的错误列表。

就我而言，它与 m2e 1.0 无关。这是任何 Java 项目的默认行为，可以追溯到 Ganymede（在撰写本文时，我正在运行 Indigo）

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2014-04-02T01:58:29.583

This is not totally an answer to your question, but is related. I thought eclipse stopped showing red/yellow flags next to files in my project. The solution was very simple - I was looking at the **Navigator** tab (which doesn't show error/warning flags) instead of the **Package Explorer** tab.

![enter image description here](https://i.stack.imgur.com/MFsL7.png)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2012-03-06T15:17:11.757

我安装并卸载了 ajdt-plugin 并遇到了同样的问题。

检查`<Project><Properties><Builders>`。它应该有一个“Java Builder”。

此代码应位于 .project 文件中（文件位于项目的根目录中）：

```
<buildSpec>
        <buildCommand>
                <name>org.eclipse.jdt.core.javabuilder</name>
                <arguments>
                </arguments>
        </buildCommand>
</buildSpec>
<natures>
        <nature>org.eclipse.jdt.core.javanature</nature>
</natures> 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2014-05-28T06:54:18.260

1.  检查您的**源目录**是否列在项目的源文件夹中

    *   **`Right-click your project > Build Path > Configure Build Path > Source`**.
2.  如果您正在使用多个项目（作为依赖项）

    *   **`Project->Clean`**...,

        ![在此处输入图像描述](https://i.stack.imgur.com/cHa72.jpg)
3.  检查“**自动构建**”是否启用。

    *   **`project > Build Automatically`**

        ![在此处输入图像描述](https://i.stack.imgur.com/inII9.png)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2011-08-31T14:20:51.930

我今天也遇到了这个问题。此处介绍的其他解决方案（例如清理项目和重新启动 Eclipse）不起作用或不适用于我的设置。对我有用的是右键单击 Package Explorer 中的项目并选择 Maven->Update Project Configuration。显然，我前一天所做的一些源文件夹重组导致 Maven 失去了对事物的跟踪，并且发出这个命令修复了一切。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-10-31T12:47:11.923

在问题窗口的右上角（最小化旁边）有一个小箭头图标。单击它并选择“配置过滤器”。有一个可能已激活的严重性过滤器。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-10-29T12:11:19.823

我在略有不同的情况下也有同样的问题。我有一个父 POM 和它下面的多个模块。项目已经存在，我将它导入到 eclipse 中。我只能将“依赖管理”更改为父项目，但不能更改其下的项目。他们没有显示任何编译警告。

接下来我将尝试将它们全部更改为单独的项目......这不是我想要的，但我无法解决这个问题......

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-03-30T07:43:15.137

我也面临同样的问题。

安装 m2eclipse 插件后，我没有收到任何 Java 编译错误。

我的解决方案是通过选择项目->右键单击（获取上下文菜单）-> m2 Maven->启用依赖项管理来启用依赖项管理。

现在我可以查看 Java 编译错误。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-01-05T12:26:06.913

尝试以下操作：

1.  打开**问题**窗口（**Windows -> 显示视图 -> 问题**）

2.  右键单击错误，然后**快速修复**

这个过程帮助我解决了同样的问题。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-06-29T03:59:12.633

这是正常问题。在 wich order 和 export 功能有时会被关闭。

右键单击项目<properties< 有选项构建路径< 并有ORDER AND EXPORT< 单击所有选项...。​​所有的东西都回来了。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-10-31T12:45:27.683

在 Ganymede 上，检查问题视图的配置：

（'配置内容'）它可以设置在'同一项目中的任何元素'上，您当前可能会从项目中选择一个元素。

或者它可能设置在一个工作集上，并且这个工作集已经被修改过

确保选择了“匹配任何配置”。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2012-05-16T07:51:35.207

就我而言，Eclipse 没有正确选择当前项目所依赖的 Java 项目。

您可以转到 Project > BuildPath > Configure BuildPath，然后删除并重新添加项目。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-02-28T23:37:05.390

这可能发生的原因显然有几个，我想我会为我的问题添加解决方案。（我有一个 java 项目，我在其中导入了带有虚拟链接的文件）

如果您有像我这样的情况，您将拥有另一个与您的“src”文件夹处于同一级别的文件夹。如果这样做，请右键单击该其他文件夹，然后选择“构建路径”>“添加到构建路径”（如果您看到“构建路径”>“从构建路径中删除”，则它已被添加。）

要进一步配置构建路径，请右键单击顶层项目目录，然后选择“构建路径”>“配置构建路径”。您的文件夹应显示在“源”选项卡中。

要配置您看到的错误，请单击 Java 编译器 > 错误/警告，然后单击“配置工作区设置”。这与转到 Window > Preferences > Java > Compiler > Errors/Warnings 相同。如果您不希望 Eclipse 忽略某些内容，那么只需将其更改为警告。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-11-26T22:02:37.130

对我有用的是创建一个`New Problems View`（可以从三点视图选项中访问此选项）：

[![显示“新问题视图”选项的屏幕截图](https://i.stack.imgur.com/aUzLD.png)](https://i.stack.imgur.com/aUzLD.png)

新视图确实显示了检测到的所有警告和错误：

[![在此处输入图像描述](https://i.stack.imgur.com/vIqGe.png)](https://i.stack.imgur.com/vIqGe.png)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-07-23T08:54:51.723

如果您已到达此处，则意味着所有其他解决方案都不适合您。一个原因可能是您的源文件夹不是 java 项目。

解决方案是在源文件夹上运行以下命令

```
mvn eclipse:eclipse 
```

这对我有用。

如果这也不起作用，请尝试删除 .classpath 和 .project 文件并再次运行上述命令

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-02T21:01:58.430

我可以通过使用非静态成员类和枚举其值的静态块创建枚举来重现此问题：

```
public enum Foo {
Dummy(new Bar [] {new Bar()});
static {
    for (Foo foo: Foo.values());
}
private Foo(Bar [] params) {}
public class Bar {}
 } 
```

此类破坏了 Ganymede 编译器。如果您删除静态初始化程序块中的行，代码将再次正确编译，并且您会得到错误，即没有新的 Bar() 调用的封闭实例，正如预期的那样。

-- 更正：仅当项目具有来自 Google Appengine 的 gaeNature 时，上述内容才成立。但是，如果您收到与原始问题中提到的类似的错误，您可能会遇到另一个 java 编译器错误...

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2011-02-25T13:54:50.557

我对 Eclipse Helios 和 m2eclipse 插件有同样的问题。他们似乎无法让这个东西与 WTP 或 WPT 或任何该死的首字母缩写词一起工作。

如果我对项目进行清理并观察 Maven 控制台，那么我可以在控制台中看到编译问题，但 eclipse 不会触及它。似乎 eclipse 或 WTP/WPT 和 m2eclipse 都在忙着打耳光。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-07-18T16:22:01.710

检查您的过滤器，有时问题视图可能仅限于您当前未在其中工作的工作集。此外，您可以检查问题视图的其他配置。

[![在此处输入图像描述](https://i.stack.imgur.com/fvK8v.png)](https://i.stack.imgur.com/fvK8v.png)

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-02-09T21:29:32.823

我在 MapReduce 项目中遇到了这个问题。我关闭了错误窗口，并且在按照其他答案的建议进行操作后再也没有回来。

点击左下角 ->*其他 -> 问题*

[![在此处输入图像描述](https://i.stack.imgur.com/WSjAP.png)](https://i.stack.imgur.com/WSjAP.png)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-09-14T16:11:49.063

Kepler SP2, Java Project (Web Driver), 我们使用 Gradle 而不是 Maven

以上都没有帮助，对我来说解决问题的是选择我的项目（r-Click）> Gradle > Refresh All

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-12-28T04:03:15.020

将源（src）文件夹指向构建路径将很容易解决这个问题，因此右键单击项目>构建路径>配置构建路径> java构建路径>源>添加文件夹，然后单击应用

[![在此处输入图像描述](https://i.stack.imgur.com/smyFy.png)](https://i.stack.imgur.com/smyFy.png)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2019-04-27T17:26:30.457

我的错误是我在资源包中创建类......

在 src/main/java 中创建类解决了这个问题。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2022-01-24T16:37:31.487

# 构建路径中的重复项

在我的情况下，问题视图或包资源管理器视图中没有显示错误，因为我的构建路径有 src 和测试目录的重复条目：

[![在此处输入图像描述](https://i.stack.imgur.com/EoQ1V.png)](https://i.stack.imgur.com/EoQ1V.png)

***从Project -> Properties -> Build Path中***删除**这些（并且只留下一个）就可以了。**

 *** * *

## 回答 #26

> 赞同：0
> 
> 时间：2021-12-13T17:02:55.073

.classpath 中的问题我做了“用 HEAD 修订版替换”来取回我在存储库 Git 中拥有的版本，并且错误再次出现。

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2015-03-17T09:39:54.807

就我而言，我设置了一个旧工作区，这就是问题所在。

尝试为工作区设置一个新文件夹

* * *

## 回答 #28

> 赞同：-2
> 
> 时间：2014-05-08T19:31:55.530

如果最近激活了“调试”，则检查程序的右上角（在“最小化”按钮下），然后单击返回 Java。

# javascript - webservice.htc、moz-behaviors 和 Firefox 3

> ID：253360
> 
> 赞同：1
> 
> 时间：2008-10-31T12:44:26.343
> 
> 标签：javascript, web-services, firefox, cross-browser, html-components

在尝试让我们的应用程序在 Firefox 中运行时（我是 X-Browser 支持的大力支持者，但我们的首席开发人员拒绝我说 IE 已经足够好）。所以我正在做一个小项目，看看要转换多少工作。

我马上就遇到了问题。

main.aspx 页面使用仅 IE 方法通过 htc 文件添加行为的方法绑定到 Web 服务，该方法由 VS 我相信自动生成。

Firefox 不支持此功能，但有一个 xml 绑定文件可用于启用 htc 支持（请参阅此处：[http](http://dean.edwards.name/moz-behaviors/overview/) ://dean.edwards.name/moz-behaviors/overview/ ）。这些示例在 FF3 中有效，但是当我像往常一样使用 webservice.htc 时，例如：

```
//Main.aspx
/*SNIP*/
<style type="text/css" media="all">
    #webservice
    {
        behavior:url(webservice.htc);
        -moz-binding:url(bindings.xml#webservice.htc);
    }
</style>
</head>
<body>
<div id="webservice"></div> <!-- we use this div to load the webservice stuff -->
/*SNIP*/

//Main.js
webservice.useService(url + asmpath + "/WebServiceWrapper.asmx?WSDL","WebServiceWrapper"); 
```

我得到 webservice 未定义（在 IE 中工作正常），我显然尝试过

```
var webservice = document.getElementById("webservice") 
```

和

```
$("#webservice").useService(url + asmpath + "/WebServiceWrapper.asmx?WSDL","WebServiceWrapper"); 
```

同样，这只是在 Firebug 中给了我“未定义 useService”。这让我相信绑定不起作用。但是，我可以在 Firebug 控制台窗口中看到 Firefox 正在加载 webservice.htc。

有人有这方面的经验吗？

我是否必须重写 web 服务的调用方式？

干杯，罗伯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T17:28:01.030

我不认为你在实现真正的跨浏览器兼容性方面是正确的。为 Firefox 添加对 IE 特定功能的支持绝对**不是**要走的路。Opera、Safari、Chrome……呢？如果您正在开发的应用程序严格在 Intranet 上使用，那么支持 Firefox 可能就足够了……

恕我直言，代码应该被重构，但以另一种方式。如果您正在使用 ASP.NET 2.0（在这种情况下您需要 ASP.NET Ajax）或更新版本，您可以在 Ajax 和 SOAP Web 服务之间创建代理。在这种情况下，您需要将所有行为重写为 JavaScript 代码，这可能不是一件小事。

附带说明：AFAIK VS.NET 不会生成行为。

对不起，如果这不是太有帮助:(

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T19:18:34.130

您的 jQuery 片段有一个错误：因为`useService`是在节点本身上定义的方法，而不是 jQuery 对象，您必须这样做：

```
$("#webservice")[0].useService(url + asmpath +
  "/WebServiceWrapper.asmx?WSDL","WebServiceWrapper"); 
```

# project-management - Redmine 或 Tracd 用于项目管理？

> ID：253372
> 
> 赞同：12
> 
> 时间：2008-10-31T12:49:04.433
> 
> 标签：project-management, bug-tracking, redmine, tracd

谁能建议 Redmine 或 Tracd 中的哪一个更适合项目管理？目前我计划将它部署在一个项目设置中，但计划在未来的多个项目中使用它。两者哪个更容易部署？我用窗户。任何其他基于 Web 并带有自己的 Web 服务器的软件？

谢谢...

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-31T13:29:10.543

如果你将来打算做多项目管理，选择redmine。使用 trac 您也可以进行多项目设置（每个项目都有一个单独的环境），但最终它是一种解决方法。Redmine 内置了对多项目环境的支持。

我以前使用 trac 来管理我的项目，但我改用 redmine。我没有找到任何有效的方法来导入我的所有票证和 wiki 页面。Redmine 使用纺织标记，但 trac 使用降价，所以我在那里遇到了一些麻烦。

最后，我听说redmine在windows上有一些问题。我还没有尝试在那个平台上运行 redmine，所以你最好试一试或谷歌搜索。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-31T13:54:46.047

我们在生产服务器上使用 Redmine，到目前为止我们没有任何问题。我不得不说Redmine真的很容易使用/维护。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-05T04:45:13.637

使用 redmine，在 WINDOWS 上工作，没有任何问题......一切都按预期开箱即用......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-19T11:41:18.470

我会像其他海报一样推荐[Redmine](http://redmine.org/)，因为它比 Trac 更完整。另请参阅[关于 SO 的这个问题](https://stackoverflow.com/questions/349605/what-is-a-good-project-management-software-for-many-small-projects)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-19T11:38:31.803

TRAC 没有时间管理支持，而 redmine 有。所以我认为Redmine会是项目管理的更好选择。Redmine 允许您使用估计的工作量、完成百分比来注释工单，并且您可以判断一个问题取决于另一个要解决的问题。然后您可以使用 Redmine 创建甘特图。

出于这些原因，在我的公司，我们正在考虑从 TRAC 切换到 Redmine。

两者都只需部署即可。

# python - CVS 或 SVN 有哪些 Python 绑定？

> ID：253375
> 
> 赞同：13
> 
> 时间：2008-10-31T12:51:14.787
> 
> 标签：python, svn, version-control, cvs

我曾经粗略地搜索了一下，发现没有很好的 Python 的 CVS 绑定。我希望能够编写帮助脚本来对存储库和其中的项目进行一些细粒度的操作。我不得不求助于使用`popen`和检查`stdout`，`stderr`然后解析它们。它很混乱而且容易出错。

是否有用于 Python 的 CVS 集成的优质模块？你更喜欢哪个模块，为什么？

当我在做的时候，有没有一个很好的 Python 的 Subversion 集成模块？我的理解是 Subversion 有一个很好的 API 来处理这些事情。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-31T13:01:31.473

对于 cvs，[pyCVS](http://pycvs.sourceforge.net/)可能值得一看。

对于 svn，有[pysvn](http://pysvn.tigris.org/)，非常好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T16:23:37.527

[Tailor](http://progetti.arstecnica.it/tailor)是一个 Python 程序，它允许不同的版本控制系统互操作，只需调用外部程序`cvs`并`svn`在使用这些格式的存储库时。这看起来很丑陋，但将 Tailor 的依赖关系从“需要____绑定”减少到“需要工作系统”。

# php - mysql_fetch_array() 返回“提供的参数不是有效的 MySQL 结果资源”

> ID：253378
> 
> 赞同：0
> 
> 时间：2008-10-31T12:53:56.387
> 
> 标签：php, mysql

我正在尝试以下代码：

```
<?php

    $link = mysql_connect('localhost', 'root', 'geheim');
    if (!$link) {
        die('Could not connect: ' . mysql_error());
    }
    echo 'Connected successfully';

    $query = "SELECT * FROM Auctions";
    $result = mysql_query($query);

    while($row = mysql_fetch_array($result, MYSQL_ASSOC))
    {
        foreach($row as $field=>$value)
        {
            echo "$field: {$value} <br />";
        }
    }
    mysql_close($link);

?> 
```

并得到这个错误：

```
Warning: mysql_fetch_array(): supplied argument is not a
    valid MySQL result resource in
    C:\Programme\EasyPHP 2.0b1\www\test.php on line 14 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-31T13:01:16.530

您尚未选择数据库 - 使用[`mysql_select_db()`](http://www.php.net/mysql_select_db)

那将是这样的：

```
<?php
    $link = mysql_connect('localhost', 'root', 'geheim');
    if (!$link) {
        die('Could not connect: ' . mysql_error());
    }
    echo 'Connected successfully';

    $db_selected = mysql_select_db('foo', $link);
    if (!$db_selected) {
        die ('Error selecting database: '. mysql_error());
    }
    echo 'Using database successfully';

    $query = "SELECT * FROM Auctions";
    $result = mysql_query($query);
    while($row = mysql_fetch_array($result, MYSQL_ASSOC)) {
        foreach($row as $field=>$value) {
            echo "$field: {$value} <br />";
        }
    }
    mysql_close($link);
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T12:57:39.267

您的 MySQL 查询可能与数据库中的任何行都不匹配。

检查[mysql_query()](http://nl2.php.net/mysql_query)的返回值，成功时返回“resource”，失败时返回“false”。

```
$query = "SELECT * FROM Auctions"; 
$result = mysql_query($query);

if ($result !== false) {
    while ($row = mysql_fetch_array($result, MYSQL_ASSOC)) { 
        foreach ($row as $field=>$value) { 
            echo $field . ':' . $value
        }
    }
} else {
    // query returned 0 rows
} 
```

正如其他人还建议的那样，您可以使用[mysql_error()](http://nl3.php.net/manual/en/function.mysql-error.php)查看查询是否返回任何 mySQL 错误

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T12:57:34.617

$query = "SELECT * FROM Auctions";

$result = mysql_query($query) 或 die(mysql_error());

所以你会看到错误

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T12:56:28.630

你有东西退回吗？如果没有找到结果，mysql_query 返回 FALSE。

在运行 fetch_array 之前检查。

# vim - 如何在 vi/Vim 中的多行选择的开头插入文本

> ID：253380
> 
> 赞同：469
> 
> 时间：2008-10-31T12:55:19.427
> 
> 标签：vim, editing, viemu

在[Vim](http://en.wikipedia.org/wiki/Vim_%28text_editor%29)中，如何在所选内容的每行开头插入字符？

例如，`//`假设我的语言的注释系统不允许像`/* */`. 我该怎么做？

* * *

## 回答 #1

> 赞同：839
> 
> 时间：2008-10-31T13:02:10.193

*   按下`Esc`进入“命令模式”
*   使用`Ctrl`+`V`进入可视块模式
*   移动`Up`/`Down`以选择要评论的行中的文本列。
*   然后点击`Shift`+`i`并键入要插入的文本。
*   然后点击`Esc`，等待 1 秒，插入的文本将出现在每一行。

如需更多信息和阅读，请查看Vim Tips Wiki 中的“[在多行中插入文本”。](https://vim.wikia.com/wiki/Inserting_text_in_multiple_lines)

* * *

## 回答 #2

> 赞同：198
> 
> 时间：2008-10-31T12:59:17.017

*这将每行*的开头替换为“//”：

```
:%s!^!//! 
```

*这将每个选定行*的开头（使用可视模式进行选择）替换为“//”：

```
:'<,'>s!^!//! 
```

**请注意**（`gv`在正常模式下）恢复最后的视觉选择，这有时会派上用场。

* * *

## 回答 #3

> 赞同：91
> 
> 时间：2010-10-06T18:05:09.630

搜索和替换的一般模式是：

```
:s/search/replace/ 
```

*用 'replace' 替换当前行的第一次出现的 'search'*

```
:s/search/replace/g 
```

*将所有出现的 'search' 替换为当前行的 'replace'，'g' 是 'global' 的缩写*

此命令将仅针对当前行将每次出现的 'search' 替换为 'replace'。% 用于搜索整个文件。要以交互方式确认每个替换，请附加一个“c”以进行确认：

```
:%s/search/replace/c 
```

*交互式确认将整个文件的“搜索”替换为“替换”*

您可以使用行号范围代替 % 字符**（请注意，'^' 字符是行首的特殊搜索字符）**：

```
:14,20s/^/#/ 
```

*在第 14-20 行的开头插入一个“#”字符*

如果您想使用另一个注释字符（例如 //），请更改您的命令分隔符：

```
:14,20s!^!//! 
```

*在第 14-20 行的开头插入一个 '//' 字符序列*

或者您可以随时转义 // 字符，例如：

```
:14,20s/^/\/\// 
```

*在第 14-20 行的开头插入一个 '//' 字符序列*

如果您没有在编辑器中看到行号，只需键入以下内容

```
:set nu 
```

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2009-04-08T20:15:53.653

对新手来说可能更容易的另一种方法：

```
 some█
 code
 here 
```

将光标放在第一行，例如通过

`g``g`

并键入以下内容以进入插入模式并添加您的文本：

`I` `/` `/` `Space`

```
 // █some
 code
 here 
```

按`Esc`返回命令模式并使用有向图：

`j` `.` `j` `.`

```
 // some
 // code
 //█here 
```

`j`是一个向下一行的运动命令，并`.`重复您所做的最后一个编辑命令。

* * *

## 回答 #5

> 赞同：28
> 
> 时间：2008-11-20T19:51:29.197

还有另一种方式：

*   移动到行首
*   进入可视块模式 ( `CTRL`- `v`)
*   `j`选择您想要的行（使用/向上/向下移动`k`，或使用 [line] 跳转到一行`G`）
*   按`I`（大写 i）
*   输入评论字符
*   按`ESC`

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2010-01-08T21:00:34.903

这会`#`在每一行的开头添加：

```
:%s/^/#/ 
```

人们将不再抱怨您缺乏正确的评论脚本。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2008-10-31T13:31:55.767

如果你想对它超级感兴趣，把它放在你的 .vimrc 中：

```
vmap \c :s!^!//!<CR>
vmap \u :s!^//!!<CR> 
```

然后，无论何时在可视模式下，您都可以点击`\c`以**评论**该块并`\u`取消**评论**它。当然，您可以将这些快捷键更改为任何内容。

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2008-11-02T00:00:24.687

还有一种方式：

```
:'<,'>g/^/norm I// 
```

`/^/`只是一个匹配每一行的虚拟模式。 `norm`允许您运行随后的正常模式命令。 `I//`表示在将光标跳转到行首的同时进入插入模式，然后插入以下文本（两个斜杠）。

`:g`对于在多行上执行复杂的操作通常很方便，您可能希望在多个模式之间跳转、删除或添加行、移动光标、运行一堆宏等。您可以告诉它只在以下行上操作匹配一个模式。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2018-12-11T02:48:08.957

在每行的开头插入“ABC”：

1.  进入命令模式

2.  `% norm I ABC`

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-08-29T18:27:56.070

对于注释代码块，我喜欢[NERD Commenter](http://www.vim.org/scripts/script.php?script_id=1218)插件。

选择一些文本：

```
Shift-V
...select the lines of text you want to comment.... 
```

评论：

```
,cc 
```

取消注释：

```
,cu 
```

或者只是切换行或块的注释状态：

```
,c<space> 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-02T00:12:44.193

我可以推荐[EnhCommentify](http://www.vim.org/scripts/script.php?script_id=23)插件。

例如。把它放到你的 vimrc 中：

```
let maplocalleader=','
vmap <silent> <LocalLeader>c <Plug>VisualTraditional
nmap <silent> <LocalLeader>c <Plug>Traditional
let g:EnhCommentifyBindInInsert = 'No'
let g:EnhCommentifyMultiPartBlocks = 'Yes'
let g:EnhCommentifyPretty = 'Yes'
let g:EnhCommentifyRespectIndent = 'Yes'
let g:EnhCommentifyUseBlockIndent = 'Yes' 
```

然后，您可以使用 ',c' 注释/取消注释（选定的）行

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-09-29T11:39:58.233

将要评论的区域标记为可视块 ( `<C-V`)

做`c#<ESC>p`

1.  `c`把它挂到“#”
2.  放回去

`\q`如果你经常这样做，在你的 .vimrc 中定义一个快捷方式（example ）

```
:vmap \q c#<ESC>p 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-07-19T13:14:00.387

如果某人的多行选择实际上是一个段落，则无需手动选择行。vim 可以为你做到这一点：

1.  `vip`：选择并标记整个段落
2.  `shift-i`: 在行首插入文本
3.  `escape`: 离开插入模式/进入正常模式[仍然选择行开头]
4.  `escape`: 取消选择行首

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-03-20T21:34:07.380

投票最多的答案的映射：

第一个视觉选择所需的行，然后执行`<leader>zzz`，其值：

```
vnoremap <leader>zzz <C-V>^I-<Space><Esc> 
```

*   `<C-V>`进入视觉模式
*   `^`转到行首（或使用 ' `0`' 到第一个非空白）
*   `I`以块模式插入
*   `-<Space>`插入“-”（例如，根据需要进行编辑）
*   `<Esc>`对所有可视块行应用相同的插入

或从正常模式的最后一次视觉选择：

```
nnoremap <leader>zzz gv<C-V>^I-<Space><Esc> 
```

# debugging - 使用 RealView Debug (RVDebug) 进行调试

> ID：253384
> 
> 赞同：1
> 
> 时间：2008-10-31T12:57:12.357
> 
> 标签：debugging, realview

我有一些用于 ARM926 目标的 C 代码。我正在尝试使用“Arm Xtended Debugger”（AXD）对其进行调试。这段代码采用`main()`了 14 个命令行参数，这些参数在代码战士项目设置中的正确位置和代码的行为符合预期。

但是当我尝试使用相同的 AXF（Arm eXecutable Format 文件）文件并尝试通过更改 Codewarrior 项目的设置使用 RVDEBUG 进行源代码级调试并开始调试时，argc 值为 1。然后的行为代码是意外的。

当我在代码战士设置中选择 RVDEBUG 时，我给出的选项与我在 AXD 调试会话期间使用的选项相同。

所以我的问题是：

我在调试会话（AXD 和 RVDEBUG）中使用相同的 AXD，为什么它们的行为不同？它们的行为应该相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-11T12:42:35.473

我不使用 CodeWarrior，但我知道 AXD 和 RVD：我记得 Code Warrior 可以使用图像的合适参数调用 AXD，等等。我不知道 Code Warrior 是否也可以调用 RVD。所以我想你自己运行 RVD，在任何 Code Warrior 菜单之外，不是吗？然后，您只需在“加载图像”菜单底部的专用输入框中添加参数。

如果这仍然不起作用，我建议您查看半主机选项（它们在 RVD 的连接选项中而不是在 Code Warrior 中）。

祝你好运！

# excel - 如何使用 VBScript 修改没有 Excel 的 Excel 电子表格？

> ID：253394
> 
> 赞同：5
> 
> 时间：2008-10-31T13:03:26.900
> 
> 标签：excel, vbscript

我需要在未安装 Microsoft Office 的 PC 上使用 VBScript 向电子表格中添加一行。

我试过 [ `Set objExcel = CreateObject("Excel.Application")`]

由于 PC 上不存在 Excel，我无法创建此对象。

有没有办法在没有 Excel 的情况下修改电子表格？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-31T16:57:45.117

要使用下面的代码，请在与 vbscript 文件相同的文件夹中创建一个名为“Test.xls”的 Excel 工作簿。

在 Test.xls 中，在单元格 A1 到 B4 中输入以下数据：

```
First   Last
Joe     Smith
Mary    Jones
Sam     Nelson 
```

将下面的 vbscript 代码粘贴到 .vbs 文件中：

```
Const adOpenStatic = 3
Const adLockOptimistic = 3

filename = "Test.xls"
Set cn = CreateObject("ADODB.Connection")
cn.Open "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & filename & _
        ";Extended Properties=Excel 8.0"

query = "Select * from [Sheet1$A1:B65535]"
Set rs = CreateObject("ADODB.Recordset")
rs.Open query, cn, adOpenStatic, adLockOptimistic

rs.AddNew
rs("First") = "George"
rs("Last") = "Washington"
rs.Update

rs.MoveFirst
Do Until rs.EOF
  WScript.Echo rs.Fields("First") & " " & rs.Fields("Last")
  rs.MoveNext
Loop 
```

在命令提示符处，键入：

```
CSCRIPT Yourfile.vbs 
```

它将在电子表格中添加一个名称，然后写出所有名称。

```
Joe Smith
Mary Jones
Sam Nelson
George Washington 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T13:10:35.513

您可以尝试使用 Microsoft Jet Driver：

有关 vbscript 示例，请参见[此处](http://www.simongibson.com/intranet/adooledb/#excel)。有关更多链接和插入行的方法，请参见[此处](https://stackoverflow.com/questions/151005/create-excel-xls-and-xlsx-file-from-c#151048)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T19:14:38.740

这是我使用的脚本的最终版本，谢谢大家的帮助。

```
Dim arrValue
arrValue = Array("Test","20","","I","2.25","3.9761","20","60","12","1","","1","1","1")
AddXLSRow "C:\Test.xls", "A1:N109", arrValue

Sub AddXLSRow(strSource, strRange, arrValues)
'This routine uses the data from an array to fill fields in the specified spreadsheet.
'Input strSource (String) = The Full path and filename of the spreadsheet to be used.
'Input arrValues (Array) = An array of values to be added to the spreadsheet.
Dim strConnection, conn, rs, strSQL, index

strConnection = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & strSource & ";Extended Properties=""Excel 8.0;HDR=Yes;"";"

Set conn = CreateObject("ADODB.Connection")
conn.Open strConnection
Set rs = CreateObject("ADODB.recordset")
strSQL = "SELECT * FROM " & strRange
rs.open strSQL, conn, 3,3
rs.AddNew 
index = 0
For Each field In rs.Fields
         If field.Type = 202 Then
                   field.value = arrValues(index)
         ElseIffield.Type = 5 And arrValues(index) <> "" Then
                   field.value = CDbl(arrValues(index))
         End If
         If NOT index >= UBound(arrValues) Then
                   index = index + 1
         End If
Next
rs.Update
rs.Close
Set rs = Nothing
conn.Close
Set conn = Nothing
End Sub 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T13:09:17.700

并非没有极大的困难。Microsoft 已在此处发布了他们的文件格式规范[Excel](http://download.microsoft.com/download/0/B/E/0BE8BDD7-E5E8-422A-ABFD-4342ED7AD886/Excel97-2007BinaryFileFormat(xls)Specification.pdf)，但这些都不能掉以轻心，我认为您将很难使用 VBScript。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-23T16:55:48.633

我知道......几年后，但今天我需要弄清楚如何使用 vbScript 访问 Excel 电子表格，而无需在我的服务器上加载 Excel。我在网上搜索，发现你的信息很有帮助，但我还需要更多，所以我一直在搜索。我终于找到了我需要的解决方案，并想在这里分享它，以防其他人遇到和我一样的问题。

我试图在 Windows 2008 服务器上使用 vbScript 访问（读/写）一个 Excel 电子表格，但我不想在我的服务器上安装 Excel。我的解决方案在这里（它使用 PowerShell，但很容易解密为 VBS）：

[使用 vbScript 读取未安装 Excel 的 Excel 电子表格](http://blogs.technet.com/b/heyscriptingguy/archive/2008/09/11/how-can-i-read-from-excel-without-using-excel.aspx)

[在未安装 Excel 的情况下使用 vbScript 写入 Excel 电子表格](http://blogs.technet.com/b/heyscriptingguy/archive/2008/09/15/how-can-i-write-to-excel-without-using-excel.aspx)

我希望这对将来需要相同解决方案的人有所帮助。

L8R...

UCG

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T13:08:07.857

如果没有安装 Excel，我看不到您将如何更改 Excel 文档。

但是，如果您使用的是 Excel 2007 电子表格 (xslx)，那么您应该能够使用 .NET Framework 的 OpenXML 功能来更新内容，而无需实际安装 Excel。

[在此处](http://www.microsoft.com/uk/msdn/screencasts/screencast/239/Intro-to-the-Office-Open-XML-File-Format.aspx)查看有关 Office OpenXML 的更多信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-31T19:57:59.980

很抱歉迟到了。[没有人提到VSTO](http://msdn.microsoft.com/en-us/office/aa905533.aspx)的事实可能意味着我误解了这个问题。无论如何，我从使用它的人那里听到了褒贬不一的评价。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-31T13:57:31.783

你可能想看看[这个问题](https://stackoverflow.com/questions/151005/create-excel-xls-and-xlsx-file-from-c#151048)。它基于 C#，但应该让您深入了解访问电子表格的技术。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-10-31T17:02:57.320

我相信您的问题的简单答案是否定的，因为您需要仅在安装 Excel 时安装的 Excel COM 对象。这曾经是编写 Office 应用程序的真正缺点之一——需要整个应用程序（Excel、Word 或其他）才能让最终用户使用它。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2012-12-13T11:08:42.027

使用 EPPlus。epplus.codeplex.com

你可以做大多数你可以用 VSTO 做的事情，而无需安装 excel。

# wcf - AJAX 到 WCF 在 FireFox 中不起作用

> ID：253397
> 
> 赞同：0
> 
> 时间：2008-10-31T13:04:06.290
> 
> 标签：wcf, asp.net-ajax

我正在尝试使用以下代码让 AJAX 到 WCF 工作的[这个示例。](http://dotnetslackers.com/articles/ajax/JSON-EnabledWCFServicesInASPNET35.aspx)在FF中查看时，什么都不显示，在IE中查看时，显示时间。
我正在使用 IIS 7，顺便说一句。

```
 function getTime() {            
        TimeService.TimeService.GetTimeFormatted("dd-mm-yyyy [hh:mm:ss]", onMethodCompleted, onMethodFailed);
    }

    function onMethodCompleted(results) {
        $get("currentTimeLabel").innerText = results;        
    } 
```

...

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T13:11:27.710

我没有使用过 MS AJAX，但据我所知，

```
function getTime() {            
    TimeService.TimeService.GetTimeFormatted("dd-mm-yyyy [hh:mm:ss]", onMethodCompleted, onMethodFailed);
} 
```

那里似乎会在 GetTimeFormatted 上运行 aync 调用，并将结果传递给“onMethodCompleted”..

```
function onMethodCompleted(results) {
    $get("currentTimeLabel").innerText = getTime();        
} 
```

每次调用它时，都会重新调用 getTime 方法。所以你正在做的是开始一个异步调用循环。

在我**看来**（注意到我没有使用过 ms ajax ..）你可能应该有更多类似的东西。

```
function getTime()
{      
    var onComplete = function(results) { $get("currentTimeLabel").innerText = results; }
    TimeService.TimeService.GetTimeFormatted("dd-mm-yyyy [hh:mm:ss]", onComplete , onMethodFailed);
} 
```

然后在您希望更新结果时调用 getTime 方法。

# delphi - 类助手有什么好的用途？

> ID：253399
> 
> 赞同：37
> 
> 时间：2008-10-31T13:07:06.453
> 
> 标签：delphi, class, helper

Delphi（可能还有很多其他语言）有类助手。这些提供了一种向现有类添加额外方法的方法。无需创建子类。

那么，类助手有什么用处呢？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-10-31T13:30:44.677

我正在使用它们：

*   将[枚举](http://17slon.com/blogs/gabr/2007/03/fun-with-enumerators-part-5-class.html "类助手枚举器")器插入到不实现它们的 VCL 类中。
*   [增强](http://gp.17slon.com/gp/gpstreams.htm "GpStreams")VCL 类。
*   将方法添加到 TStrings 类，以便我可以在[派生列表](http://gp.17slon.com/gp/gplists.htm "全局列表")和 TStringList 中使用相同的方法。

    ```
    TGpStringListHelper = class helper for TStringList
    public
      function  Last: string;
      function  Contains(const s: string): boolean;
      function  FetchObject(const s: string): TObject;
      procedure Sort;
      procedure Remove(const s: string);
    end; { TGpStringListHelper } 
    ```

*   简化对记录字段的访问并[删除强制转换](http://17slon.com/blogs/gabr/2008/03/walking-key-value-container.html "遍历键值容器")。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-31T13:07:22.867

起初，我对班级助手持怀疑态度。但后来我读了一篇有趣的[博客文章](http://blogs.conceptfirst.com/blog/2006/05/08/class-helpers-good-or-bad/)，现在我确信它们确实很有用。

例如，如果您想要现有实例类的额外功能并且由于某种原因您无法更改现有源。您可以创建一个类助手来添加此功能。

**例子：**

```
type
  TStringsHelper = class helper for TStrings
  public
    function IsEmpty: Boolean;
  end;

function TStringsHelper.IsEmpty: Boolean;
begin
  Result := Count = 0;
end; 
```

每次，我们现在都使用 TStrings（的子类）的实例，并且 TStringsHelper 在范围内。我们可以访问方法 IsEmpty。

**例子：**

```
procedure TForm1.Button1Click(Sender: TObject);
begin
  if Memo1.Lines.IsEmpty then
    Button1.Caption := 'Empty'
  else
    Button1.Caption := 'Filled';
end; 
```

**笔记：**

*   类助手可以存储在一个单独的单元中，因此您可以添加自己的漂亮类助手。确保为这些单元起一个易于记忆的名称，例如 ClassesHelpers 用于 Classes 单元的助手。
*   还有记录助手。
*   如果范围内有多个类助手，预计会出现一些问题，只能使用一个助手。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-10-31T13:18:30.160

这听起来很像 C#3（和 VB9）中的扩展方法。我为它们看到的最好的用途是对`IEnumerable<T>`(and `IQueryable<T>`) 的扩展，它允许 LINQ 针对任意序列工作：

```
var query = someOriginalSequence.Where(person => person.Age > 18)
                                .OrderBy(person => person.Name)
                                .Select(person => person.Job); 
```

（或其他，当然）。所有这些都是可行的，因为扩展方法允许您有效地将对静态方法的调用链接在一起，这些静态方法在返回时采用相同的类型。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-10-31T20:37:49.713

它们对于插件非常有用。例如，假设您的项目定义了某种数据结构，并以某种方式保存到磁盘。但是其他一些程序做了非常相似的事情，但是数据文件不同。但是你不想用一堆导入代码来让你的 EXE 膨胀，因为你的很多用户都不需要使用这个功能。您可以使用插件框架并将导入器放入一个可以像这样工作的插件中：

```
type
   TCompetitionToMyClass = class helper for TMyClass
   public
      constructor Convert(base: TCompetition);
   end; 
```

然后定义转换器。一个警告：班级*助手*不是班级*朋友*。这种技术只有在可以通过其公共方法和属性完全设置一个新的 TMyClass 对象时才有效。但是，如果可以，它会非常有效。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-10-31T14:10:26.873

我记得第一次遇到您所说的“类助手”是在学习 Objective C 时。Cocoa（Apple 的 Objective C 框架）使用所谓的“类别”。

类别允许您通过添加自己的方法而无需子类化来扩展现有类。事实上，Cocoa 鼓励你尽可能避免子类化。子类化通常是有意义的，但通常可以避免使用类别。

在 Cocoa 中使用类别的一个很好的例子是所谓的“键值代码 (KVC)”和“键值观察 (KVO)”。

该系统使用两个类别（NSKeyValueCoding 和 NSKeyValueObserving）实现。这些类别定义并实现了可以添加到您想要的任何类的方法。例如 Cocoa 通过使用这些类别向 NSArray 添加方法来向 KVC/KVO 添加“一致性”，例如：

```
- (id)valueForKey:(NSString *)key 
```

NSArray 类既没有声明也没有此方法的实现。但是，通过使用类。您可以在任何 NSArray 类上调用该方法。你不需要继承 NSArray 来获得 KVC/KVO 的一致性。

```
NSArray *myArray = [NSArray array]; // Make a new empty array
id myValue = [myArray valueForKey:@"name"]; // Call a method defined in the category 
```

使用这种技术可以轻松地将 KVC/KVO 支持添加到您自己的类中。Java 接口允许您添加方法声明，但类别还允许您将实际实现添加到现有类。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-10-31T14:27:36.230

正如 GameCat 所示，TStrings 是避免打字的好选择：

```
type
  TMyObject = class
  public
    procedure DoSomething;
  end;

  TMyObjectStringsHelper = class helper for TStrings
  private
    function GetMyObject(const Name: string): TMyObject;
    procedure SetMyObject(const Name: string; const Value: TMyObject);
  public
    property MyObject[const Name: string]: TMyObject read GetMyObject write SetMyObject; default;
  end;

function TMyObjectStringsHelper.GetMyObject(const Name: string): TMyObject;
var
  idx: Integer;
begin
  idx := IndexOf(Name);
  if idx < 0 then
    result := nil
  else
    result := Objects[idx] as TMyObject;
end;

procedure TMyObjectStringsHelper.SetMyObject(const Name: string; const Value:
    TMyObject);
var
  idx: Integer;
begin
  idx := IndexOf(Name);
  if idx < 0 then
    AddObject(Name, Value)
  else
    Objects[idx] := Value;
end;

var
  lst: TStrings;
begin
  ...
  lst['MyName'] := TMyObject.Create; 
  ...
  lst['MyName'].DoSomething;
  ...
end; 
```

* * *

您是否曾经需要访问注册表中的多行字符串？

```
type
  TRegistryHelper = class helper for TRegistry
  public
    function ReadStrings(const ValueName: string): TStringDynArray;
  end;

function TRegistryHelper.ReadStrings(const ValueName: string): TStringDynArray;
var
  DataType: DWord;
  DataSize: DWord;
  Buf: PChar;
  P: PChar;
  Len: Integer;
  I: Integer;
begin
  result := nil;
  if RegQueryValueEx(CurrentKey, PChar(ValueName), nil, @DataType, nil, @DataSize) = ERROR_SUCCESS then begin
    if DataType = REG_MULTI_SZ then begin
      GetMem(Buf, DataSize + 2);
      try
        if RegQueryValueEx(CurrentKey, PChar(ValueName), nil, @DataType, PByte(Buf), @DataSize) = ERROR_SUCCESS then begin
          for I := 0 to 1 do begin
            if Buf[DataSize - 2] <> #0 then begin
              Buf[DataSize] := #0;
              Inc(DataSize);
            end;
          end;

          Len := 0;
          for I := 0 to DataSize - 1 do
            if Buf[I] = #0 then
              Inc(Len);
          Dec(Len);
          if Len > 0 then begin
            SetLength(result, Len);
            P := Buf;
            for I := 0 to Len - 1 do begin
              result[I] := StrPas(P);
              Inc(P, Length(P) + 1);
            end;
          end;
        end;
      finally
        FreeMem(Buf, DataSize);
      end;
    end;
  end;
end; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-07-04T05:57:25.870

我不建议使用它们，因为我阅读了以下评论：

> “类助手的最大问题，从在你自己的应用程序中使用它们的观点来看，是一个给定类的唯一类助手可能在任何时候都在范围内。” ... “也就是说，如果你在范围内有两个助手，编译器只会识别一个。你不会收到任何警告，甚至不会提示任何其他可能隐藏的助手。”

[http://davidglassborow.blogspot.com/2006/05/class-helpers-good-or-bad.html](http://davidglassborow.blogspot.com/2006/05/class-helpers-good-or-bad.html)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-27T11:32:59.347

我已经看到它们用于使可用的类方法在类之间保持一致：将 Open/Close 和 Show/Hide 添加到给定“类型”的所有类，而不仅仅是 Active 和 Visible 属性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-11-03T15:26:39.730

*如果*Dephi 支持扩展方法，我想要的一种用途是：

```
TGuidHelper = class
public
   class function IsEmpty(this Value: TGUID): Boolean;
end;

class function TGuidHelper(this Value: TGUID): Boolean;
begin
   Result := (Value = TGuid.Empty);
end; 
```

所以我可以打电话`if customerGuid.IsEmpty then ...`。

另一个很好的例子是能够使用`IDataRecord`范式（我喜欢）从 XML 文档（或者 JSON，如果你喜欢那种东西）中读取值：

```
orderGuid := xmlDocument.GetGuid('/Order/OrderID'); 
```

这比：

```
var
   node: IXMLDOMNode;

   node := xmlDocument.selectSingleNode('/Order/OrderID');
   if Assigned(node) then
      orderID := StrToGuid(node.Text) //throw convert error on empty or invalid
   else
      orderID := TGuid.Empty; // "DBNull" becomes the null guid 
```

# java - 如何通过点击“返回”按钮来防止用户查看以前用户的信息

> ID：253403
> 
> 赞同：9
> 
> 时间：2008-10-31T13:08:52.770
> 
> 标签：java, javascript, servlets

我正在使用 servlet 开发一个 java web 应用程序，为了防止用户点击后退按钮查看以前用户的信息，我有以下代码：

```
 protected void processRequest(HttpServletRequest request,HttpServletResponse response) throws ServletException, IOException
      {        
        HttpSession session=request.getSession(true);

        response.setContentType("text/html");
        response.setHeader("Cache-Control","no-cache,no-store");
        response.setDateHeader("Expires",0);
        response.setHeader("Pragma","no-cache");

        ......

        //    if (!User_Logged_In)
        session.invalidate();
      } 
```

此外，我在文件中还有以下代码：web/WEB-INF/web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">
......
<filter>
  <filter-name>ResponseHeaderFilter</filter-name>
  <filter-class>ResponseHeaderFilter</filter-class>
  <init-param>
    <param-name>Cache-Control</param-name>
    <param-value>private,no-cache,no-store</param-value>
   </init-param>
  <init-param>
    <param-name>Pragma</param-name>
    <param-value>no-cache</param-value>
   </init-param>
  <init-param>
    <param-name>Expires</param-name>
    <param-value>0</param-value>
   </init-param>
</filter>

</web-app> 
```

ResponseHeaderFilter.java 看起来像这样：

```
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import java.util.*;

public class ResponseHeaderFilter implements Filter
{
  FilterConfig fc;

  public void doFilter(ServletRequest req,ServletResponse res,FilterChain chain) throws IOException,ServletException
  {
    HttpServletResponse response=(HttpServletResponse)res;

    for (Enumeration e=fc.getInitParameterNames();e.hasMoreElements();)        // Set the provided HTTP response parameters
    {
      String headerName=(String)e.nextElement();
      response.addHeader(headerName,fc.getInitParameter(headerName));
    }
    chain.doFilter(req,response);                                              // Pass the request/response on
  }

  public void init(FilterConfig filterConfig)
  {
    this.fc=filterConfig;
  }

  public void destroy()
  {
    this.fc=null;
  }
} 
```

到目前为止，它仍然无法正常工作。后退按钮会弹出一个警告窗口，提示数据已过期，询问用户是否要重新发布。如果您选择是，它仍然会显示以前的页面信息。我究竟做错了什么？有什么解决办法？

坦率

* * *

是的，我正在为公共场所的 PC 开发 Web 应用程序，如果用户 B 点击后退按钮，他可能会看到用户 A 的私人信息。

我试图将会话 ID 与 servlet 一起使用，但是如何做到这一点，任何示例代码？

我还尝试了以下方法：

```
<Html>
<Head>...</Head>
<Body onLoad=document.execCommand("ClearAuthenticationCache","false")>
......
<script type="text/javascript">
  // Clear current credentials : Requires IE6 SP1 or later
  // document.execCommand("ClearAuthenticationCache");
    document.execCommand("ClearAuthenticationCache","false");
  </script>
......
</Html> 
```

它适用于 IE，但适用于 Firefox。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-31T13:24:12.893

点击后退按钮将如何导致用户看到*另一个*用户的数据？你的用例是什么？它是为公共终端设计的，每个用户提交数据然后离开？在这种情况下，将每个输入与唯一的会话 ID 相关联。跟踪服务器中的有效会话 ID。提交输入后，从有效 ID 中删除该会话 ID。如果再次出现，则不要显示该信息。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-10-31T13:29:22.447

您的问题是您试图阻止客户看到他或她自己的计算机上的内容。您不能阻止他们查看浏览器缓存。你不能阻止他们禁用 JavaScript（以及你的脚本代码）。您不能阻止他们使用不遵守您提到的“转发”约定的浏览器。

这不是一个可以用 JavaScript 或服务器端解决方案解决的问题。为什么“打破后退按钮”不受欢迎的部分原因是：它实际上并没有解决任何问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T13:16:43.907

破坏后退按钮是 Web 开发的一大罪过。

但是您可以在 onload 中尝试一些 java 脚本，根据当前登录的会话刷新详细信息。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-31T13:36:06.537

听起来您真正的问题是重新发布有效。那可能是因为你：

1.  信任来自浏览器而不是当前会话的凭据，或者
2.  不检查当前会话是否允许访问由浏览器发送的键/标识符值表示的数据

我建议在用户登录后，您永远不要相信浏览器提交的用户名。[理想情况下使用像Spring Security](http://static.springframework.org/spring-security/site/)这样的框架的安全服务，但如果没有它们，您可以依赖[HttpServletRequest.getUserPrincipal()](http://java.sun.com/j2ee/1.4/docs/api/javax/servlet/http/HttpServletRequest.html#getUserPrincipal())。

为了确保允许当前会话访问数据，您可以使用由 Spring Security 等框架提供的访问控制列表机制，或者`WHERE OWNER=?`在数据库查询中包含一个子句。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T13:21:43.803

我不确定我是否完全理解你的问题。您是否担心人员 A 注销，人员 B 从同一 PC 和浏览器实例登录，然后您想阻止人员 B 看到 A 正在查看的任何内容？

如果是这样，在每次页面加载时检查用户的凭据就足够了。检查当前用户是否有权查看所请求的数据。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-31T15:58:40.883

我不确定我是否正确理解了您的问题，但听起来您允许重新发布。

防止重新提交的一种方法是使用令牌。在表单和会话中放置一个随机令牌。提交时检查提交的令牌是否与会话中的令牌匹配

*   如果是，则将会话中的令牌替换为新令牌并处理请求
*   否则停止处理请求）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-31T21:04:24.930

当涉及到历史与缓存的关系以及可用于控制它的各种标头时，所有不同的浏览器都有不同的行为和怪癖。Firefox 3 的工作方式与 Firefox 2 不同，尽管使用缓存指令来阻止它，但当用户单击后退按钮时会重新显示潜在的敏感数据。最好的解决方案是使用不持久化的会话 cookie，并在注销后通知用户需要关闭浏览器窗口。特别是如果他们在公共终端。我知道这很痛苦，但是当前的浏览器产品和 HTTP 规范没有提供任何处理浏览器历史记录的机制。根据 HTTP 规范，历史可能与用户代理缓存不同。请参阅[13.13 历史列表](https://www.rfc-editor.org/rfc/rfc2616#section-13.13 "13.13 历史列表")如 RFC 2616 超文本传输​​协议 - HTTP/1.1 中定义的问题和基本原理。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-04T15:58:51.410

如果这可能会有所帮助。这适用于 ASP，对其他语言使用等效的解决方案。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-31T14:33:05.440

[Jeff Atwood在这里](https://blog.codinghorror.com/preventing-csrf-and-xsrf-attacks/)描述了一种防止 CSRF 和 XSRF 攻击的方法。

您可以使用此技术来解决“*用户看到他们不应该看到*的内容”的问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-31T14:10:48.743

我不能 100% 确定这是否可以解决您的问题，因为我不完全了解您将如何使用其他用户的数据。但是，我知道对于我开发的 Web 应用程序，我尝试专门使用[Redirect After Post](http://en.wikipedia.org/wiki/Post/Redirect/Get)以避免返回按钮和刷新重复的表单提交。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-21T15:10:11.217

我认为这既是一个用户界面挑战，也是一个编码问题。除了您使用的任何反缓存技术之外，您还需要让用户清楚地知道他们在完成后必须点击一个大而明显的“注销”按钮（或等效按钮）。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-31T13:49:06.497

如果您担心有人看到前一页表单中的内容，您可以为“真实”帖子使用隐藏表单，并使用仅用于向用户显示的表单。当用户提交显示表单时，您将所有字段复制到隐藏表单，清除显示表单，然后提交隐藏表单。

我同意其他所有人的观点——摆弄后退按钮，这是处理保护信息的不好方法。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2008-10-31T13:31:54.517

我在.Net中遇到了类似的问题。我将以下 javascript 添加到我的注销页面：

document.execCommand("ClearAuthenticationCache","false");

现在，如果您按下后退按钮，您需要再次进行身份验证。

# html - 字段集和图例

> ID：253410
> 
> 赞同：5
> 
> 时间：2008-10-31T13:12:37.333
> 
> 标签：html, fieldset

好吧，我知道`fieldset`/`legend`在 HTML 中是如何工作的。假设您有一个包含一些字段的表单：

```
<form>
    <fieldset>
        <legend>legend</legend>
        <input name="input1" />
    </fieldset>
</form> 
```

我应该使用什么`legend`？它被显示为**标题**，但图例在语义上不是对内容的解释吗？在我看来，最好你会做这样的事情：

```
<form>
    <fieldset>
        <legend>* = required</legend>
        <label for="input1">input 1 *</label><input id="input1" name="input1" />
    </fieldset>
</form> 
```

但这并不能真正解决字段集的渲染方式。这只是HTML中的一个模棱两可的命名，还是我对英文单词'legend'的误解？

* * *

编辑：修复了一些错误；-)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-31T13:15:33.553

是的，命名是模棱两可的。最好将其视为字段集的标题。

如果您还没有，请参阅[HTML 规范`FIELDSET`和`LEGEND`元素：](http://www.w3.org/TR/html401/interact/forms.html#h-17.10)

> 该[`LEGEND`](http://www.w3.org/TR/html401/interact/forms.html#edef-LEGEND)元素允许作者将标题分配给[`FIELDSET`](http://www.w3.org/TR/html401/interact/forms.html#edef-FIELDSET). [`FIELDSET`](http://www.w3.org/TR/html401/interact/forms.html#edef-FIELDSET)当以非可视方式呈现时，图例可提高可访问性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T13:17:35.763

我猜你是想写

```
<form>
    <fieldset>
        <legend>legend</legend>
        <input name="input1" />
    </fieldset>
</form> 
```

但你有一部分是对的。传说这个词有几个含义，包括

*   附有插图的说明性标题。
*   出现在地图或图表上的符号说明表或列表。

所以它实际上可以同时表示两者。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T13:19:08.380

当您说图例“它被显示为标题”时......显然它取决于所涉及的 CSS。当您自己不指定 CSS 时，每个浏览器都会使用自己的内置样式，这可能是最好的，也可能不是。

我同意图例与标题不同......我不一定认为图例是“* = 必需”之类的正确位置（这似乎只是用户的警示信息，而不是真正的字段集本身的解释）。

毕竟，图例可以定义为标题，或附有插图的简要说明（通常；在这种情况下，不是图像）。

至于它是如何显示的，CSS 让你有能力让它出现（或不显示）你认为合适的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T13:20:38.613

将图例视为组框的标题。您可以使用它将相似的表单元素组合在一起。您可以将送货地址的所有输入字段放在一个带有“送货地址”图例的字段集中，并将帐单地址的所有输入字段的集合放在另一个带有“帐单地址”图例的字段集中。

这是一个例子：

[Skiviez Checkout 中的字段集 http://piasecki.name/fieldset-legend-example.jpg](http://piasecki.name/fieldset-legend-example.jpg)

通过 CSS 设置它们的样式可能很棘手（因为 Internet Explorer 不正确地显示字段集的背景。[我们的 IE 样式表](http://www.skiviez.com/Styles/Skiviez-InternetExplorer7.css)有一些很好的示例；请查看“#content form fieldset”部分。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T13:27:23.667

该`<legend>` 元素是由[`<fieldset>`](http://www.w3.org/TR/html401/interact/forms.html#h-17.10).

> FIELDSET 元素允许作者对与主题相关的控件进行分组

这意味着`fieldset`s 应该将*多个*表单控件组合在一起——而不仅仅是一对`<input>`and `<legend>`。

事实上`<div>`s、`<p>`s 或`<li>`s 是非常适合`<input>`+`<legend>`对的容器。

# java - 在 JSP 中没有获得正确大小的 ArrayList

> ID：253415
> 
> 赞同：0
> 
> 时间：2008-10-31T13:15:54.533
> 
> 标签：java, jsp, arraylist

我无法在`alt`下面的 JSP 页面的 ArrayList 中获取正确数量的元素。当我查看 JSP 时，它显示大小是 1 ( `<%=alt.size()%>`)，而它应该是 3；我想我正在将该方法添加到生成器类中的数组中，所以我不明白为什么它显示为 1。

这是我的jsp页面：

```
<%
   ArrayList<Alert> a = AlertGenerator.getAlert();
   pageContext.setAttribute("alt", a);
%>
   <c:forEach var="alert" items="${alt}" varStatus="status" >
      <p>You have <%=alt.size()%> Active Alert(s)</p>
      <ul>
      <li><a href="#" class="linkthree">${alert.alert1}</a></li>
      <li><a href="#" class="linkthree">${alert.alert2}</a></li>
      <li><a href="#" class="linkthree">${alert.alert3}</a></li>
      </ul>
  </c:forEach> 
```

这是生成警报的类：

```
package com.cg.mock;

import java.util.ArrayList;

public class AlertGenerator {

    public static ArrayList<Alert> getAlert() {

        ArrayList<Alert> alt = new ArrayList<Alert>();

        alt.add(new Alert("alert1","alert2","alert3"));

        return alt;
    }

} 
```

这是我的豆类：

```
package com.cg.mock;

public class Alert {
    String alert1;
    String alert2;
    String alert3;
    public Alert(String alert1, String alert2,String alert3) {
        super();
        this.alert1 = alert1;
        this.alert2 = alert2;
        this.alert3 = alert3;
    }
    public String getAlert1() {
        return alert1;
    }
    public void setAlert1(String alert1) {
        this.alert1 = alert1;
    }
    public String getAlert2() {
        return alert2;
    }
    public void setAlert2(String alert2) {
        this.alert2 = alert2;
    }
    public String getAlert3() {
        return alert3;
    }
    public void setAlert3(String alert3) {
        this.alert3 = alert3;
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T13:21:29.560

问题是您的 ArrayList 中只有一个 Alert 实例，但该单个 Alert 具有 3 个属性：alert1、alert2 和 alert3。

看一下这条线：

```
alt.add(new Alert("alert1","alert2","alert3")); 
```

您只有一个添加行，并且它不在循环中。

一个可能的解决方案：

```
public class Alert {
    private String description;
    private String status;
    private Date raisedOn;
    public Alert(String description, String status) {
        this.description = description;
        this.status = status;
        this.raisedOn = new Date();
    }
    public String getDescription() { return description; }
    public String getStatus() { return status; }
    public Date getRaisedOn() { return raisedOn; }
}

....
alt.add(new Alert("Disk Almost Full", "Warning"));
alt.add(new Alert("Disk Full", "Severe"));
...

...
<table>
    <tr><th>Description</th><th>Status</th><th>Raised</th></td>
    <c:forEach var="alert" items="${alt}">
        <tr>
            <td><c:out value="${alert.description}"/></td>
            <td><c:out value="${alert.status}"/></td>
            <td><c:out value="${alert.raisedOn}"/></td>
        </tr>
    </c:forEach>
</table> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T13:20:59.640

`3`当您只`add`编辑了一项时，您为什么期望它返回`List`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T13:22:09.403

ArrayList 仅包含一个元素 Alert（元素 Alert 包含三个字符串警报。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T14:04:03.640

要获得 3 个警报，您可以重新设计如下。请注意，警报类只有一个属性。您可以为每个警报创建一个新的警报实例。

```
package com.cg.mock;

public class Alert {
  String alert1;
  public Alert(String alert1) {
    super();
    this.alert1 = alert1;       
  }
  public String getAlert1() {
    return alert1;
  }
  public void setAlert1(String alert1) {
    this.alert1 = alert1;
  }
} 
```

在警报生成器中：

```
ArrayList<Alert> alt = new ArrayList<Alert>();

alt.add(new Alert("alert1");
alt.add(new Alert("alert2");
alt.add(new Alert("alert3");

return alt; 
```

在 JSP 上：

```
<p>You have <%=alt.size()%> Active Alert(s)</p>
<ul>
<c:forEach var="alert" items="${alt}" varStatus="status" >    

     <li><a href="#" class="linkthree">${alert.alert1}</a></li>

  </c:forEach>
 </ul> 
```

注意 ul 在 forEach 循环之外。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T14:07:11.403

将您的 JSP 更改为：

```
<%
    ArrayList<Alert> a = AlertGenerator.getAlert();
    pageContext.setAttribute("alt", a);
%>
<p>You have <%=alt.size()%> Active Alert(s)</p>
<ul>
    <c:forEach var="alert" items="${alt}" varStatus="status" >
        <li><a href="#" class="linkthree">${alert.alert}</a></li>
    </c:forEach>
</ul> 
```

将 AlertGenerator.java 更改为：

```
package com.cg.mock;

import java.util.ArrayList;

public class AlertGenerator {

    public static ArrayList<Alert> getAlert() {

        ArrayList<Alert> alt = new ArrayList<Alert>();

        alt.add(new Alert("alert2"));
        alt.add(new Alert("alert2"));
        alt.add(new Alert("alert3"));

        return alt;
    }
} 
```

将 Alert.java 更改为：

```
package com.cg.mock;

public class Alert {
    String alert;
    public Alert(String alert) {
        this.alert = alert;
    }
    public String getAlert() {
        return alert;
    }
    public void setAlert(String alert) {
        this.alert = alert;
    }
} 
```

# design-patterns - TCL有函数指针的概念吗？

> ID：253426
> 
> 赞同：3
> 
> 时间：2008-10-31T13:19:33.560
> 
> 标签：design-patterns, function-pointers, tcl

与 TCL 合作，我想实现类似[Strategy Pattern](http://en.wikipedia.org/wiki/Strategy_pattern)的东西。我想在 TCL 函数中传递用于打印输出的“策略”，这样我就可以轻松地在打印到屏幕和打印到日志文件之间切换。在 TCL 中执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-10-31T19:20:12.427

TCL 允许您将过程的名称存储在一个变量中，然后使用该变量调用该过程；所以

```
proc A { x } {
   puts $x
}

set strat A
$strat Hello 
```

将调用 proc A 并打印出 Hello

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-08T06:11:54.717

除了显示如何将过程分配给变量的答案之外，您还可以将过程的名称作为参数传递给另一个过程。这是一个简单的例子：

```
 proc foo { a } {
   puts "a = $a"
}

proc bar { b } {
   puts "b = $b"
}

proc foobar { c } {
   $c 1
}

foobar foo
foobar bar 
```

这将打印 a = 1 和 b = 1

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-01T02:54:00.903

上面列出的稍微扩展的示例可以更清楚地说明策略模式：

```
proc PrintToPDF {document} {
<snip logic>
}

proc PrintToScreen {document} {
<snip logic>
}

proc PrintToPrinter {document} {
<snip logic>
}

set document "my cool formatted document here"

set printMethod "printer"

switch -- $printMethod {
    "printer" {
        set pMethodName "PrintToPrinter"
    }
    "pdf" {
        set pMethodName "PrintToScreen"
    }
    "screen" {
        set pMethodName "PrintToPDF"
    }
}

$pMethodName $document 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-25T04:27:54.580

除了使用 proc，您实际上还可以使用代码块。这有一些变化。首先是最明显的，只是`eval`ing它。

```
set strategy {
    puts $x
}

set x "Hello"
eval $strategy
unset x 
```

这可行，但有一些缺点。首先很明显，两段代码必须共同使用参数的通用命名。这用另一种（locals）替换了一个令人头疼的命名空间（procs），这可以说实际上*更糟*。

不太明显的是 eval 故意在不编译字节码的情况下解释其参数。这是因为假设 eval 将使用动态生成的、通常是唯一的参数调用，并且如果字节码只使用一次，相对于立即解释块，编译为字节码的效率会很低。这更容易解决，所以这是成语：

```
set x "Hello"
if 1 $strategy
unset x 
```

`if`与 不同`eval`，它会编译和缓存它的代码块。如果`$strategy`块只是一个或只是几个不同的可能值，那么这非常有效。

这对于将参数传递给带有局部变量的块的讨厌没有任何帮助。有很多方法可以解决这个问题，例如以与 tk 用's对命令参数进行[替换相同的方式进行替换。](http://www.tcl.tk/man/tcl8.5/TclCmd/string.htm#M39)`%`您可以尝试使用 up`uplevel`或`upvar`. 例如，您可以这样做：

```
set strategy {
    puts %x
}

if 1 [string map [list %% % %x Hello] $strategy] 
```

如果传递的参数变化不大，这在字节码编译方面效果很好。另一方面，如果参数经常更改，则应使用`eval`而不是`if 1`. 就论点而言，这无论如何也好不了多少。由于您使用的是特殊语法，因此不太可能混淆已通过和未通过的内容。如果您想在返回代码块之前使用变量替换，这也很有帮助：如`set strategy "$localvar %x"`.

幸运的是，tcl 8.5 有[真正的匿名函数](http://www.tcl.tk/man/tcl8.5/TclCmd/apply.htm)，使用`apply`命令。apply 命令的第一个词将是参数和正文的列表，就好像这些参数`proc`已被取出一样。其余参数立即作为参数传递给匿名命令。

```
set strategy [list {x} {
    puts $x
}]

apply $strategy "Hello" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-18T08:18:48.803

```
% set val 4444
4444

% set pointer val
val

% eval puts $$pointer
4444

% puts [ set $pointer ]
4444

% set tmp [ set $pointer ]
4444 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T13:28:28.720

如何使用变量函数？我不记得太多 TCL（已经有一段时间了......）但也许其中一个可以满足您的需要：

*   [$var 参数 1 参数 2]
*   [$var] 参数 1 参数 2
*   $var 参数 1 参数 2

如果我错了，任何人都可以自由纠正我。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-18T17:23:01.417

为了澄清杰克逊的方法为什么有效，请记住在 TCL 中，*一切*都是字符串。无论您使用的是文字字符串、函数、变量还是其他任何东西，*一切*都是字符串。您可以像传递“数据指针”一样传递“函数指针”：只需使用不带前导“$”的对象名称。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-05-31T11:06:22.993

上述所有内容，尽管在从命名空间移动到命名空间时，您可能希望将其用作传递`[namespace current ]::proc_name`，以确保不会出现任何中断。
对于 OO 方法，您需要遵循此线程中的内容：在 Tcl Godspeed[中将特定对象的方法作为输入参数传递。](https://stackoverflow.com/questions/41737116/pass-a-method-of-a-specific-object-as-an-input-argument-in-tcl)

# wpf - 在 Windows 窗体或 WPF 应用程序中使用“Wingdings”字体是否合适？

> ID：253431
> 
> 赞同：8
> 
> 时间：2008-10-31T13:20:41.140
> 
> 标签：wpf, winforms, fonts, compatibility

我有一个 WPF 控件，它有一个“投资者”列表，在列表的右栏中，有一个“删除”按钮。

我可以浪费一些时间在 Photoshop 中制作“x”的图像。或者，我可以只使用 Wingdings 字体并将内容设置为“Õ”（这是一个看起来很酷的删除按钮）。

这合适吗？我的想法是……虽然不是每个字体系列都在每台计算机上，但我很确定可以肯定地说，如果您正在运行我的 WPF Windows 窗体程序，那么您就有 Wingdings。

你怎么看？请尝试就此事提供统计数据（不仅仅是感觉）。我应该担心字体大小吗？等等

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-31T13:25:08.370

老实说，如果您使用的是 WPF，那么使用路径来制作“x”形状可能同样容易：

```
 <Style x:Key="DeleteButtonStyle" TargetType="{x:Type Button}">
        <Setter Property="HorizontalAlignment" Value="Stretch"/>
        <Setter Property="HorizontalContentAlignment" Value="Center"/>
        <Setter Property="VerticalAlignment" Value="Stretch"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <Setter Property="Cursor" Value="Hand"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Path Name="Circle" Data="F1 M 0 7.5 A 7.5 7.5 0 1 1 15 7.5 A 7.5 7.5 0 1 1 0 7.5"/>
                        <Path Fill="White" Data="F1 M 7.5 6 L 10.5,3 12,4.5 9,7.5 12,10.5 10.5,12 7.5,9 4.5,12 3,10.5 6,7.5 3,4.5 4.5,3 Z"/>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Fill" TargetName="Circle" Value="SlateGray"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="False">
                            <Setter Property="Fill" TargetName="Circle" Value="DarkGray"/>
                        </Trigger>
                        <DataTrigger Binding="{Binding}" Value="{x:Null}">
                            <Setter Property="Visibility" Value="Hidden"/>
                        </DataTrigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Setter Property="ToolTip" Value="Delete This Item"/>
    </Style> 
```

只需将此样式应用于按钮，您就会得到一个即时的“删除”按钮！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-31T13:34:03.843

我认为你应该没问题，尤其是使用 WPF。我不知道 Wingdings 字体是否在每台 Windows 机器上（可能是），但我知道 Marlett 字体中的字符在 Win XP UI 中使用。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T13:27:57.147

假设您可以显示 Unicode，许多字体中有大量字形用于您尝试执行的操作。

例如，这是（可能）Arial 中的 Unicode 字符：✖</p>

我从[http://www1.tip.nl/~t876506/UnicodeDisplay.html 获取](http://www1.tip.nl/~t876506/UnicodeDisplay.html)了字符参考，但我相信还有比这更好的地方可以找到

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-31T13:28:27.317

抱歉，但我想不出有什么比使用翼形字符进行控制更能让应用程序看起来更业余的了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-12T12:20:32.107

我认为不错的解决方案是从 Wingdings 中获取您喜欢的字形，并将它们转换为 WPF 形状，作为您应用程序的资源。这只会为您的应用程序增加几 kB，并且您不会依赖 Wingdings。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-30T19:28:08.787

大多数问题是忘记添加字节大小。

在 C#（Winform）中，我使用：

```
static Font wingdings2 = new Font("Wingdings 2", 10F, System.Drawing.FontStyle.Bold, System.Drawing.GraphicsUnit.Point, ((byte)(2))); 
```

所以我可以：

```
myTextBoxt.Font = wingdings2; 
```

# c# - 使用 GDI+ 将修改后的图像保存到原始文件

> ID：253435
> 
> 赞同：4
> 
> 时间：2008-10-31T13:22:02.913
> 
> 标签：c#, gdi+, image-manipulation

我正在从文件加载位图图像。当我尝试将图像保存到另一个文件时，出现以下错误“GDI+ 中发生一般错误”。我相信这是因为文件被图像对象锁定。

好的，所以尝试调用 Image.Clone 函数。这仍然会锁定文件。

唔。接下来我尝试从 FileStream 加载位图图像并将图像加载到内存中，这样 GDI+ 就不会锁定文件。这很好用，除非我需要使用 Image.GetThumbnailImage 方法生成缩略图，它会引发内存不足异常。显然我需要保持流打开以停止此异常，但如果我保持流打开，则文件保持锁定状态。

所以这种方法不好。最后，我创建了该文件的副本。所以现在我有两个版本的文件。1 我可以在我的 c# 程序中锁定和操作。这个其他原始文件保持解锁状态，我可以将修改保存到其中。这样做的好处是即使在保存更改后也可以恢复更改，因为我正在操作无法更改的文件副本。

当然有更好的方法来实现这一点，而不必拥有 2 个版本的图像文件。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T13:37:11.900

好吧，如果您正在寻找其他方法来做您所要求的事情，我认为它应该可以创建一个 MemoryStream，并将 FileStream 读出到它，并从该流中加载图像......

```
var stream = new FileStream("original-image", FileMode.Open);
var bufr = new byte[stream.Length];
stream.Read(bufr, 0, (int)stream.Length);
stream.Dispose();

var memstream = new MemoryStream(bufr);
var image = Image.FromStream(memstream); 
```

或者更漂亮的东西。

我不知道这是否是您解决该问题的方法。:) 我遇到了类似的问题，最后像这样修复它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-04T14:20:58.300

从那以后，我找到了一种替代方法来克隆图像而不锁定文件。[Bob Powell 拥有这一切以及更多的 GDI 资源](https://web.archive.org/web/20120419185819/http://www.bobpowell.net/imagefileconvert.htm)。

```
 //open the file
      Image i = Image.FromFile(path);

      //create temporary
      Image t=new Bitmap(i.Width,i.Height);

      //get graphics
      Graphics g=Graphics.FromImage(t);

      //copy original
      g.DrawImage(i,0,0);

      //close original
      i.Dispose();

      //Can now save
      t.Save(path) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-11T10:21:32.827

我有一个类似的问题。但我知道，我会将图像保存为位图文件。所以我这样做了：

```
 public void SaveHeightmap(string path)
    {
        if (File.Exists(path))
        {
            Bitmap bitmap = new Bitmap(image); //create bitmap from image
            image.Dispose(); //delete image, so the file

            bitmap.Save(path); //save bitmap

            image = (Image) bitmap; //recreate image from bitmap
        }
        else
            //...
    } 
```

当然，这不是最好的方法，但它的工作原理:-)

# c# - Directory.GetFiles 保持上次访问时间

> ID：253437
> 
> 赞同：3
> 
> 时间：2008-10-31T13:22:12.807
> 
> 标签：c#, lastaccesstime

C# 中的 Directory.GetFiles() 似乎修改了文件的最后访问日期。我已经用谷歌搜索了几个小时，似乎找不到解决这个问题的方法。无论如何要保留文件的所有 MAC（已修改、已访问、已创建）属性？我正在使用 Directory.GetDirectories()、Directory.GetFiles() 和 FileInfo。

此外，fi.LastAccessTime 给出了奇怪的结果——日期是正确的，但是时间相差 2 分钟或几个小时。

```
Time of function execution: 10/31/2008 8:35 AM

Program Shows As              Last Access Time
0_PDFIndex.html               - 10/31/2008 8:17:24 AM
AdvancedArithmetic.pdf        - 10/31/2008 8:31:05 AM
AdvancedControlStructures.pdf - 10/30/2008 1:18:00 PM
AoAIX.pdf                     - 10/30/2008 1:18:00 PM
AoATOC.pdf                    - 10/30/2008 12:29:51 PM
AoATOC2.pdf                   - 10/30/2008 1:18:00 PM

Actual                        Last Access Time
0_PDFIndex.html               - 10/31/2008 8:17 AM
AdvancedArithmetic.pdf        - 10/30/2008 12:29 PM
AdvancedControlStructures.pdf - 10/30/2008 12:29 PM
AoAIX.pdf                     - 10/30/2008 12:29 PM
AoATOC.pdf                    - 10/30/2008 12:29 PM
AoATOC2.pdf                   - 10/30/2008 12:29 PM 
```

下面是我正在使用的方法。如果您需要更多信息，请告诉我。

谢谢！

```
public void PopulateTreeView(string directoryValue, ref TreeNode parentNode)
        {
            string[] directoryArray = Directory.GetDirectories(directoryValue);
            string[] fileArray = Directory.GetFiles(directoryValue, "*.*", SearchOption.AllDirectories);

            try
            {
                #region Directories
                if (directoryArray.Length != 0)
                {
                    foreach (string directory in directoryArray)
                    {
                        DirectoryInfo di = new DirectoryInfo(directory);

                        TreeNode dirNode = parentNode.Nodes.Add(di.Name);

                        FileNode fn = new FileNode();
                        fn.bIsDir = true;
                        fn.dir = di;

                        dirNode.Tag = fn;
                        PopulateTreeView(directory, ref dirNode);
                        Application.DoEvents();

                    }
                }
                #endregion

                #region Files
                if (fileArray.Length != 0)
                {
                    foreach (string file in fileArray)
                    {
                        FileInfo fi = new FileInfo(file);

                        TreeNode fileNode = parentNode.Nodes.Add(fi.Name);
                        FileNode fn = new FileNode();
                        fn.bIsDir = false;
                        fn.file = fi;

                        fileNode.Tag = fn;

                        fileNode.ImageIndex = 1;

                        Console.WriteLine(fi.Name + " - " + fi.LastAccessTime);

                    }
                }
                #endregion

            }
            catch (UnauthorizedAccessException)
            {
                parentNode.Nodes.Add("Access denied");
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.ToString());
            }
            finally
            {
                Application.DoEvents();
            }
        } 
```

* * *

我知道属性之间的区别。我需要的是文件保持完全相同的所有属性和元数据，就好像我的程序从未接触过文件一样；这包括最后访问日期。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T13:28:37.363

我知道这远非理想，但您可以使用 fsutil（随 Windows 提供）来禁用上次访问时间写入：

```
fsutil behavior set disablelastaccess 1 
```

据推测，一旦完成，您会将其设置回 0。您可以使用 C# 中的 Process.Start 调用它，但必须有更好的编程方式（调用 Windows API）。

```
Process.Start("fsutil", "behavior set disablelastaccess 1").WaitForExit(); 
```

请注意，这是一个全局 Windows 设置，也会影响应用程序外部的磁盘访问...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T13:52:23.820

访问时间与上次写入时间不同。如果您使用 fi.LastWriteTime 我想您会发现在资源管理器或 cmd 窗口中显示的时间相同。

当然，最后一次访问和最后一次写入可以相同，但它们不一定相同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T14:14:08.253

（将其重新发布为回复而不是评论......）

我刚刚在这里运行了这段代码，它只留下了最后一次访问时间——我无法重现你看到的问题，所以 Directory.GetFiles 没有 100% 的时间被破坏。

Filemon 可以检查其他应用程序是否正在执行此操作：[http ://technet.microsoft.com/en-us/sysinternals/bb896642.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896642.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T15:39:51.670

如果您正在取证并且不想修改驱动器，为什么要以可写模式安装它？您应该以只读方式访问它，以确保您不会意外更改某些内容。另外，我希望您不要在您正在检查的磁盘的人的操作系统中运行您的程序……您刚刚将磁盘添加到您控制的机器上，对吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T13:54:49.603

不确定这是否相关，但来自 MSDN：

> 首次调用时，FileSystemInfo 调用 Refresh 并返回 API 上的缓存信息以获取属性等。在随后的调用中，您必须调用 Refresh 以获取信息的最新副本。

顺便说一句，“LastAccessTime”基本上会告诉您上次“查看”文件的时间。在没有陈旧数据的情况下，这将始终是“现在”……恕我直言，不是特别有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T14:02:36.313

访问时间将显示一个只读标记，最后一次写入将显示正在修改的文件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-31T14:22:41.967

我没有尝试过，但谷歌建议：

[禁用 NTFS 上次访问时间戳](http://www.pctools.com/guides/registry/detail/50/)

这是一个系统范围的变化，所以请注意...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-31T14:31:25.957

如果您出于取证目的访问磁盘，那么您确实应该在硬件级别对整个硬盘进行写保护（因此这不是一个真正的编程问题）。

谷歌搜索`hdd "write protect"`将揭示大量潜在的解决方案。

# ms-access - 您如何评论 MS-access 查询？

> ID：253446
> 
> 赞同：32
> 
> 时间：2008-10-31T13:26:04.780
> 
> 标签：ms-access, ms-office

如何向 MS Access 查询添加评论，以提供对其功能的描述？

添加后，如何以编程方式检索此类评论？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2015-01-22T18:41:13.377

我决定在`Where`条款中添加一个条件，该条件始终评估为真，但允许编码人员找到您的评论。

```
Select
   ...
From
   ...
Where
   ....
   And "Comment: FYI, Access doesn't support normal comments!"<>"" 
```

最后一行总是评估为 true，因此它不会影响返回的数据，但允许您为下一个人留下评论。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2008-10-31T14:32:33.130

无法向“普通”Access 查询（即 mdb 中的 QueryDef）添加注释，这就是为什么许多人建议将查询的 sql 存储在表中的原因。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-10-31T14:48:38.870

**注意：**使用 Access 2003 确认，不知道早期版本。

对于 MDB 中的查询，您可以右键单击查询设计器（在表所在的空白处），从上下文菜单中选择属性，然后在*描述*属性中输入文本。

您限制为 256 个字符，但总比没有好。

您可以通过以下方式以编程方式获取描述：

```
Dim db As Database
Dim qry As QueryDef

Set db = Application.CurrentDb
Set qry = db.QueryDefs("myQuery")

Debug.Print qry.Properties("Description") 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-03-22T12:49:08.937

我知道这个问题很老了，但我想补充几点，奇怪地省略了：

1.  您可以右键单击容器中的查询，然后单击属性，然后填写您的描述。您以这种方式输入的文本也可以在设计视图中的 Descrption 属性中访问
2.  每个字段也可以记录在案。只需确保打开属性窗口，然后单击要记录的查询字段，并填写描述（就在鲜为人知的格式属性上方）

没有产品（我知道）记录这些查询字段的描述和表达式，这有点令人遗憾。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-01-21T20:14:00.177

您可以向 MSAccess 查询添加注释，如下所示： 在查询中创建一个虚拟字段。不优雅，但可以自我记录并包含在查询中，这使得将其检查到源代码控制中更加可行！杰尔就是一个例子。进入 SQL 视图并添加虚拟字段（您也可以从设计视图中执行）：

```
SELECT  "2011-01-21;JTR;Added FIELD02;;2011-01-20;JTR;Added qryHISTORY;;" as qryHISTORY,  ...rest of query here... 
```

运行查询：

```
qryHISTORY                           FIELD01 FIELD02 ...
2011-01-21;JTR;Added FIELD02;;2011-01-20;JTR;Added qryHISTORY;;"  0000001  ABCDEF ... 
```

注意使用“;” 作为 qryHISTORY 字段中的字段分隔符，以及“;;” 作为评论的结尾，并使用 ISO 日期格式和缩写，以及评论。已在 qryHISTORY 字段中使用最多 646 个字符对此进行了测试。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-07T03:06:48.937

第一个答案提到了如何以编程方式获取描述属性。如果您无论如何都要打扰程序，因为查询中的注释太笨拙了，而不是试图将注释放在查询中，也许最好将它们放在一个程序中并使用该程序来进行所有查询

```
Dim dbs As DAO.Database
Dim qry As DAO.QueryDef

Set dbs = CurrentDb
'put your comments wherever in your program makes the most sense
dbs.QueryDefs("qryName").SQL = "SELECT whatever.fields FROM whatever_table;"
DoCmd.OpenQuery "qryname" 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-16T16:17:36.743

如果您有一个包含很多条件的查询，那么记住每个条件的作用可能会很棘手。我在原始表格中添加了一个文本字段——称之为“评论”或“文档”。然后我将它包含在查询中，并为每个条件添加注释。

需要像这样编写注释，以便返回所有相关行。不幸的是，由于我是新海报，我无法添加截图！

所以这里没有

```
Field:   | Comment              |ContractStatus     | ProblemDealtWith | ...... |

Table:   | ElecContracts        |ElecContracts      | ElecContracts    | ...... |

Sort:  

Show:  

Criteria | <> "all problems are | "objection" Or |

         | picked up with this  | "rejected" Or  |

         | criteria" OR Is Null | "rolled"       |

         | OR "" 
```

`<>`告诉查询选择不等于您输入的文本的行，否则它只会选择文本等于您的评论的字段，即没有！

" " 用引号将您的评论括起来

OR Is Null OR "" 告诉您的查询在评论字段中包含任何没有数据的行，否则它不会返回任何内容！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-03-22T13:46:02.103

五年来，我一直在使用上面@Dan 的答案中的方法，现在意识到有一种类似的方法允许与相关代码相邻的注释，而不是在一个`WHERE`子句中分开：

可以使用 . 在域代码中添加注释`iif()`。例如，如果域代码是：

```
A / B 
```

然后可以这样评论：

```
iif("Comment: B is never 0." = "", "", A / B) 
```

或者

```
iif(false, "Comment: B is never 0.", A / B) 
```

或者

```
iif(0, "Comment: B is never 0.", A / B) 
```

就像 Dan 的解决方案一样，它很笨拙，但这是 SQL 的错。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-05-31T11:20:39.490

如果您尝试向整个对象（查询或表等）添加一般注释

Access 2016 转到导航窗格，突出显示对象，右键单击，选择对象/表属性，在描述窗口中添加注释，即库存“表上次更新时间 05/31/17”

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-01-05T15:06:54.137

在查询设计中：

*   添加一列
*   在字段中输入您的评论（用引号引起来）
*   取消选中**显示**
*   排序。

**笔记：**

如果您不排序，该字段将被访问删除。因此，请确保您已取消选中显示并对列进行排序。

# c# - C# 4.0 中“动态”变量的实际用途是什么？

> ID：253460
> 
> 赞同：14
> 
> 时间：2008-10-31T13:28:34.010
> 
> 标签：c#, .net, c#-4.0

如果当您调用该方法时，它可能不存在，它们有什么用？

这是否意味着您可以在动态对象上动态创建方法？

这有什么实际用途？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-31T13:31:19.743

您将无法真正动态地创建该方法 - 但您可以获得`IDynamicMetaObject`（通常通过扩展`DynamicObject`）的实现来响应*，就好像该方法存在一样*。

用途：

*   使用弱 API 对 COM 对象进行编程（例如办公室）
*   调用动态语言，例如 Ruby/Python
*   潜在地制作“可探索”的对象 - 想象一个类似 XPath 的查询，但通过方法/属性调用，例如`document.RootElement.Person[5].Name["Attribute"]`
*   毫无疑问，我们还没有想到更多:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T13:32:06.747

首先，你现在不能使用它。它是 C#4 的一部分，将在未来某个时间发布。

基本上，它是针对一个对象，其属性要到运行时才能知道。也许它来自一个 COM 对象。正如您所描述的那样，也许它是“动态定义的对象”（尽管我认为尚无创建或计划创建这些对象的设施）。

它很像 System.Object，除了允许您调用编译器不知道的方法，并且运行时会计算出如何调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T13:40:37.637

我能想到的两个大问题是鸭式打字和**在应用程序中使用 C# 作为脚本语言的能力，类似于 javascript 和 Python**。最后一个让我有点泪目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-21T01:45:35.567

将其视为反射的简化形式。而不是这个：

```
object value = GetSomeObject();
Method method = value.GetType().GetMethod("DoSomething");
method.Invoke(value, new object[] { 1, 2, 3 }); 
```

你得到这个：

```
IDynamicObject value = GetSomeObject();
value.DoSomething(1, 2, 3); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-21T00:39:07.667

我看到正在编写几个动态 ORM 框架。或者自己写一个。

我同意 Jon Skeet 的观点，你可能会看到一些探索物体的有趣方式。也许使用像 jQuery 这样的选择器。

调用 COM 和调用动态语言。

我期待着看看是否有办法做一个类似 Ruby 的missing_method。

# .net - 获取正在执行程序集的目录的最佳方法是什么

> ID：253468
> 
> 赞同：21
> 
> 时间：2008-10-31T13:29:57.487
> 
> 标签：.net, directory

对于我的应用程序，我将一些配置文件与程序集（exe）一起存储在 xml 中，以及用于处理目的的其他临时文件。

`".\\"`我发现and有一些怪癖`Application.StartupPath`。

我一直在使用

```
String configPath = ".\\config.xml"; 
```

它工作正常，直到我打电话`OpenFIleDialog`打开其他文件夹中的一些文件，上面的语句失败了。显然“.\”指的是“CurrentDirectory”，每次我们浏览到另一个文件夹时它都会改变。

在某些时候，我正在使用

```
String configPath = Path.Combine(Application.StartupPath + "config.xml"); 
```

在某些时候，当我需要通过使用从另一个文件夹执行这个程序集时`Process.Start()`，事情开始分崩离析。显然工作目录设置不正确，`Application.StartupPath`实际上是指工作目录，而不是我假设的程序集正在执行的目录。所以我不得不求助于使用 ProcessInfo 将工作目录设置为程序集的目录。我在写 VSTO 时也遇到了这个问题。

所以，我的问题是，在没有我刚才提到的那些怪癖（或误解）的情况下，获取程序集正在执行的当前目录的最佳、最简单和最可靠的方法是什么？

编辑：我的意思是获取程序集所在的目录

编辑：根据[AppDomain.BaseDirectory](http://msdn.microsoft.com/en-us/library/system.appdomain.basedirectory.aspx)上的 MSDN ，它似乎可以在运行时更改，这是我不想要的（只是为了澄清，不是我不想允许更改 BaseDirectory，而是当我在不确定是否已更改的情况下检索它）

编辑：我注意到一个相关问题发布得更早。[什么会导致正在执行的应用程序的当前目录发生变化？](https://stackoverflow.com/questions/158219/what-would-cause-the-current-directory-of-an-executing-app-to-change)

谢谢大家的回答。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-10-31T13:40:04.703

```
System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location)) 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-11-12T16:10:08.670

试试下面的实现。CodeBase 属性是获取位置的最可靠方法，然后其余代码将其转换为标准 Windows 格式（而不是 URI）。

```
static public string AssemblyLoadDirectory
{
    get
    {
        string codeBase = Assembly.GetCallingAssembly().CodeBase;
        UriBuilder uri = new UriBuilder(codeBase);
        string path = Uri.UnescapeDataString(uri.Path);
        return Path.GetDirectoryName(path);
    }
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-31T13:34:56.587

你想要实际的工作目录，还是包含程序集的目录？这并不完全清楚。

如果[`Environment.CurrentDirectory`](http://msdn.microsoft.com/en-us/library/system.environment.currentdirectory.aspx)您想要工作目录，或者`Path.GetDirectoryName(typeof(Foo).Assembly.ManifestModule.FullyQualifiedName)`查找程序集的位置（或者至少是它的清单模块，这在几乎所有情况下都是一样的）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-31T13:39:00.557

还有，

```
System.Reflection.Assembly.GetExecutingAssembly().CodeBase 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-31T13:44:59.390

短一点：

```
AppDomain.Current.BaseDirectory 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-10-31T13:40:05.967

我会从以下[链接](http://msdn.microsoft.com/en-us/library/aa457089.aspx)尝试这样的事情：

```
string path;
path = System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().GetName().CodeBase );
MessageBox.Show( path ); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-31T13:39:36.670

怎么样

```
string currentAssemblyFile = System.Reflection.Assembly.GetExecutingAssembly().Location; 
```

然后从那里弄清楚...

# c++ - 如何在状态栏中显示 CMFCRibbonButton 的工具提示？

> ID：253469
> 
> 赞同：1
> 
> 时间：2008-10-31T13:30:31.837
> 
> 标签：c++, visual-studio-2008, ribbon, tooltip, mfc-feature-pack

我`CMFCRibbonStatusBar`在我的大型机中有一个，我向其中添加了一个`CMFCRibbonButtonsGroup`再次具有`CMFCRibbonButton`. 此按钮与菜单条目具有相同的 ID。

创建按钮的过程如下：

```
CMFCRibbonButtonsGroup* pBGroup = new CMFCRibbonButtonsGroup();

CMFCToolBarImages images;
images.SetImageSize(CSize(32, 16)); // Non-square bitmaps
if(images.Load(IDB_STATUSBAR_IMAGES))
{
    pBGroup->SetImages(&images, NULL, NULL);
}

m_pStatusButton = new CMFCRibbonButton(ID_STATUS_SHOWSTATUS,
                                       _T(""),
                                       IMAGEINDEX_DEFAULTSTATUS);

pBGroup->AddButton(m_pStatusButton);

m_wndStatusBar.AddExtendedElement(pBGroup, _T("")); 
```

我想将此按钮用作状态指示器。

我想在以下两种情况下显示工具提示：

*   当状态改变和
*   当用户将鼠标移到按钮上时。

我不知道如何首先开始。我查看了`ToolTipDemo`示例`DlgToolTips`项目，但无法弄清楚如何去做，因为它们所做的只是显示工具栏项或对话框按钮的工具提示（`CWnd`-derived 而不是`CMFCRibbonButton`）。

如果您熟悉`ToolTipDemo`示例项目：由于似乎有多种处理方式，我希望工具提示看起来像[此屏幕截图中所示](http://img394.imageshack.us/my.php?image=tooltiptm7.png)的“基于扩展可视化管理器”的工具提示。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T00:05:36.637

我认为没有鼠标光标在控件上方就不可能显示工具提示。这一切都是自动完成的。

但是，如果您想在屏幕截图中获得漂亮的工具提示，则需要调用`SetToolTipText`and `SetDescription`，如下所示：

```
CMFCRibbonButton* pBtn = new CMFCRibbonButton(12345, _T(""), 1);
pBtn->SetToolTipText("This is the bold Title");
pBtn->SetDescription("This is the not-so-bold Description");
pGroup->AddButton(pBtn); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-05T23:20:29.047

我`CMFCRibbonButton`在 a 中使用控件`CMFCRibbonButtonGroup`，它被添加到`CMFCRibbonStatusBar`. 注意`CMFCRibbonButton()`构造函数中的第 4 个参数`bAlwaysShowDescription`，因为这似乎会根据是否`SetDescription()`被调用来影响行为。

具体来说，如果`SetDescription()`没有被调用，那么是 TRUE 还是 FALSE 都无关紧要`bAlwaysShowDescription`- 显示工具提示（如我所料）。如果`SetDescription()`设置`bAlwaysShowDescription`为 FALSE，则当将鼠标悬停在按钮上时，将显示工具提示及其下方的说明。

鉴于此`bAlwaysShowDescription`参数的名称，似乎违反直觉的是，当它为 TRUE 并`SetDescription()`设置时，**工具**提示和描述都不会出现。我想知道这是否与这篇文章有关： [https ://connect.microsoft.com/VisualStudio/feedback/details/399646/cmfcribbonbutton-wont-show-tooltip-if-balwaysshowdescription-1](https://connect.microsoft.com/VisualStudio/feedback/details/399646/cmfcribbonbutton-wont-show-tooltip-if-balwaysshowdescription-1)

`bAlwaysShowDescription`希望这会有所帮助，您可以通过参数的不同组合以及是否`SetDescription()`设置来实现您所需要的。

# c++ - 为什么没有人用高级功能升级他们的 C 编译器？

> ID：253475
> 
> 赞同：1
> 
> 时间：2008-10-31T13:31:41.413
> 
> 标签：c++, c, visual-studio, compiler-construction

```
struct elem
{
 int i;
 char k;
};
elem user; // compile error!
struct elem user; // this is correct 
```

在上面的代码中，我们得到了第一个声明的错误。但是 C++ 编译器不会发生此错误。在 C++ 中，我们不需要一次又一次地使用关键字 struct。

那么为什么没有人更新他们的 C 编译器，以便我们可以像在 C++ 中那样使用没有关键字的结构呢？

为什么 C 编译器开发人员不消除 C 的一些故障，比如上面的那个，并在不破坏 C 原始概念的情况下更新一些高级特性？

为什么它是 1970 年代没有更新的旧编译器？

看看 Visual Studio 等。它经常更新新版本，对于每个新版本，我们都必须学习一些新功能的用法（即使这是一个我们可以解决的问题）。如果有的话，我们还将使用新的编译器进行更新。

不要把这当作一个愚蠢的问题。为什么不可能？它可以在没有任何不兼容问题的情况下开发（不影响在当前/旧编译器上开发的代码）

好的，让我们开发新的 C 语言 C+，它介于 C 和 C++ 之间，它消除了 C 的所有故障并添加了 C++ 的一些高级功能，同时保持它对特定应用程序（如系统级应用程序、嵌入式系统等）有用。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-10-31T13:46:50.663

因为新标准的发展需要数年时间。他们正在制定新的 C++ 标准 ( [C++0x](http://en.wikipedia.org/wiki/C%2B%2B0x) ) 和新的 C 标准 (C1x)，但如果您记得每次迭代通常需要 5 到 10 年，我不希望看到它在 2010 年左右之前。

此外，就像任何民主国家一样，标准也存在妥协。强硬派说“如果你想要所有花哨的语法糖，那就选择 Java 或 C# 之类的玩具语言，它可以让你手把手，甚至给你买一根棒棒糖”，而其他人则说“语言需要更简单，更在这些日子里更不容易出错或快速缩短开发周期”。

双方都部分正确，因此标准化是一场漫长的战斗，需要数年时间，并会导致许多妥协。这适用于涉及多个大方的所有事情，它不仅限于 C/C++。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-31T13:53:03.833

```
typedef struct
{
 int i;
 char k;
} elem;

elem user; 
```

会很好地工作。正如其他人所说，它是关于标准的——当你在 VS2008 中实现它时，你不能在 GCC 中使用它，当你在 GCC 中实现它时，你肯定不会在其他东西中编译。上述方法适用于任何地方。

另一方面——当我们有 bool 类型的 C99 标准时，在 for() 循环和块中间声明——为什么不也有这个特性呢？

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-31T14:57:27.310

首先，编译器需要支持该标准。即使事后看来标准看起来很尴尬，这也是事实。其次，编译器供应商确实添加了扩展。例如，许多编译器支持这一点：

```
(char *) p += 100; 
```

将指针移动 100 个字节，而不是指针所指向的任何类型的 100 个字节`p`。严格来说，这是非标准的，因为强制转换消除了`p`.

非标准扩展的问题在于你不能指望它们。如果您想切换编译器、使代码可移植或使用第三方工具，那将是一个大问题。

C 在很大程度上是其自身成功的受害者。使用 C 的主要原因之一是可移植性。几乎所有现有的硬件平台和操作系统都有 C 编译器。如果您希望能够在*任何*用 C 语言编写的代码中运行代码。这会产生巨大的惯性。在不牺牲一开始就使用该语言的最好的事情之一的情况下，几乎不可能改变任何东西。

软件开发人员的结果是您可能需要写入最低公分母，通常是 ANSI C (C89)。例如：将运行 Perl 下一版本的虚拟机 Parrot 是用 ANSI C 编写的。Perl6 将拥有极其强大且富有表现力的语法，其中一些令人费解的概念直接融入了该语言。但是，该实现是使用几乎完全相反的语言构建的。原因是这将使 perl 可以在任何地方运行：PC、Mac、Windows、Linux、Unix、VAX、BSD...

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-11-01T03:53:04.170

这个“特性”将**永远不会**被未来的 C 标准采用，原因只有一个：它会严重破坏向后兼容性。在 C 中，结构标记具有与普通标识符分开的命名空间，这可能被认为是也可能不被认为是一个特性。因此，这个片段：

```
struct elem
{
    int foo;
};

int elem; 
```

在 C 中非常好，因为这两个元素位于不同的名称空间中。如果未来的标准允许您在没有结构限定符或适当的 typedef 的情况下声明 struct elem，则上述程序将失败，因为 elem 被用作 int 的标识符。

未来的 C 标准确实破坏了向后兼容性的一个例子是 C99 不允许没有明确返回类型的函数，即：

```
foo(void); /* declare a function foo that takes no parameters and returns an int */ 
```

这在 C99 中是非法的。然而，仅仅通过添加一个 int 返回类型来使这个 C99 兼容是微不足道的。如果突然 struct 标签没有单独的命名空间，那么“修复”C 程序就不是那么简单了。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-11-04T06:20:08.037

我发现当我对 C 和 C++ 实现非标准扩展时，即使人们请求它们，它们也不会被使用。C 和 C++ 世界肯定围绕着严格的标准合规性展开。许多这些扩展和改进已经在 D 编程语言中找到了肥沃的土壤。

沃尔特·布莱特，数字火星

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-10-31T14:02:50.990

大多数仍在使用 C 的人使用它，因为他们要么是：

*   针对一个非常特定的平台（即嵌入式），因此必须使用该平台供应商提供的编译器
*   担心可移植性，在这种情况下，非标准编译器会破坏目的
*   对纯 C 非常满意，并且认为没有理由改变，在这种情况下，他们只是不想改变。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-10-31T13:39:04.673

如前所述，C 有一个需要遵守的标准。但是你不能只使用稍微修改的 C 语法编写代码，而是使用 C++ 编译器，这样就可以了

```
struct elem
{
 int i;
 char k;
};
elem user; 
```

会编译吗？

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-31T13:43:48.300

为此目的，我们有一个 typedef。并且请不要更改标准我们已经有足够的兼容性问题......

@ Manoj Doubts 评论
我对你或其他人定义 C+ 或 C- 或 Cwhatever 没有问题，除非你不接触 C :)
我仍然需要一种能够完成我的任务的语言 - 拥有**相同**的代码（不是一个小的）能够在由大量不同编译器编译的数十个操作系统上运行，并且能够在数十个不同的硬件平台上运行目前只有一种语言可以让我完成我的任务，我不喜欢试验这种能力:) 特别是因为你提供的原因。你真的认为写作能力

```
foo test; 
```

反而

```
struct foo test; 
```

从任何角度来看，会让你的代码变得更好吗？

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-31T17:28:10.173

实际上，许多 C 编译器确实添加了特性——不是每个 C 编译器都支持 C++ 样式`//` 注释吗？

添加到 C 标准更新（C99 是最新的）中的大多数功能都来自“流行”的扩展。

例如，即使我现在在嵌入式平台上使用的编译器并没有声称符合 C99 标准（并且它缺少很多），它确实添加了以下扩展（所有这些都是借用的）从 C++ 或 C99) 到它的“C90”支持：

*   声明与声明混合
*   匿名结构和联合
*   排队
*   for循环初始化表达式中的声明
*   当然，还有 C++ 风格的`//`注释

我遇到的问题是，当我尝试使用 MSVC 编译这些文件时（用于测试或因为代码不仅在嵌入式平台上很有用），它们中的大多数都会窒息（老实说不确定匿名结构/联合）。

因此，扩展确实会添加到 C 编译器中，只是它们以不同的速率和不同的方式完成（因此使用它们的代码变得更难以移植），并且将它们移动到标准的过程几乎是缓慢的.

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-11-03T13:41:09.787

以下程序在编译为标准 C 或其他内容时输出“1”，当编译为 C++ 或您建议的语法时，可能输出“1”。这就是 C 语言不能做出这种改变的原因，它会给现有代码赋予新的意义。这很糟糕！

```
#include <stdio.h>

typedef struct
{
    int a;
    int b;
} X;

int main(void)
{
    union X
    {
        int a;
        int b;
    };

    X x;
    x.a = 1;
    x.b = 2;

    printf("%d\n", x.a);

    return 0;
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-10-31T13:34:29.910

因为C是标准化的。编译器可以提供该功能，有些提供，但使用它意味着源代码不遵循标准，只能在该供应商的编译器上编译。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-10-31T14:00:23.507

好，

1 - 今天使用的编译器都不是 70 年代的......

2 - C 和 C++ 语言都有标准，编译器是根据这些标准开发的。他们不能只是改变一些行为！

3 - 如果你在 VS2008 上开发，然后尝试用另一个 10 年前发布的最新版本的编译器编译该代码，会发生什么？

4 - 当您使用 C/C++ / 语言选项卡上的选项时会发生什么？

5 - 为什么微软编译器不针对所有可能的处理器？他们只针对 x86、x86_64 和 Itanium，仅此而已……

6 - 相信我，这甚至不被认为是一个问题！

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-10-31T14:09:59.527

如果您想将 C 与 C++ 类型定义等（但没有类、模板等）一起使用，则无需开发新语言。

只需编写类似 C 的代码并使用 C++ 编译器。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-31T20:29:24.363

就新版本中的新功能而言，Visual C++ 并不完全符合标准（请参阅[http://msdn.microsoft.com/en-us/library/x84h5b78.aspx](http://msdn.microsoft.com/en-us/library/x84h5b78.aspx)），当 Visual Studio 2010 发布时，下一个 C++ 标准很可能已经获得批准，从而为 VC++ 团队提供更多可更改的功能。

Microsoft 库（与标准几乎没有关系）以及编译器输出的内容（C++/CLI）也有变化。在不试图偏离标准的情况下，有很大的改变空间。

你也不需要像 C+ 这样的东西。只需用 C 编写，使用您喜欢的任何 C++ 功能，然后编译为 C++。Bjarne Stroustrup 对 C++ 的最初设计目标之一是无需在 C 中编写任何东西。如果您限制使用的 C++ 功能，它应该可以完美高效地编译（即使这样编译也会非常高效；现代 C++ 编译器做得很好工作）。

还有一个悬而未决的问题：当你可以编写标准 C 或标准 C++ 时，你为什么要使用非标准 C？

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-10-31T20:38:45.497

这听起来像是[拥抱和扩展](http://en.wikipedia.org/wiki/Embrace_extend_and_extinguish)的概念。在你的情景下生活。

1.  我使用删除了 C“故障”的 C 编译器开发代码。
2.  我使用另一个 C 编译器移至另一个平台，该编译器删除了 C“故障”，但方式略有不同。
3.  我的代码在新平台上没有编译或运行不同，我浪费时间将我的代码“移植”到新平台。

一些供应商实际上喜欢修复“故障”，因为这往往会将人们锁定在一个平台上。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-11-03T13:54:39.103

如果您想用标准 C 编写，请遵循标准。就是这样。

如果您想要更多自由，请使用 C# 或 C++.NET 或您的硬件支持的任何其他内容。

# hidden - Firefox 上隐藏的 FreeTextBox 错误

> ID：253490
> 
> 赞同：3
> 
> 时间：2008-10-31T13:36:10.250
> 
> 标签：hidden, freetextbox

[我的 ASP.NET 站点中的FreeTextBox](http://freetextbox.com/)富文本编辑器有问题。当我使用 firefox 访问该站点时会出现问题，并且我在隐藏的 div 中有一个 freetextbox 实例。隐藏的 div 也可能是 AJAX 选项卡面板。实际的问题是，当页面加载时它会抛出一个未捕获的异常（萤火虫显示 StoreHtml() 函数）并停止回发！

是否有任何问题和解决方案？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T09:31:21.023

我最近在 jQuery UI 选项卡上遇到了类似的问题。您需要做的是将隐藏选项卡的 CSS 更改为：

```
.hiddentab
{
     position: absolute;
     left: -99999999999999;
} 
```

这会将隐藏的选项卡放在最左侧，并且在绝对位置模式下，这不会导致出现水平滚动条。显示选项卡时，只需从选项卡元素中删除 hiddentab 类。

如果问题与 Firefox 的 display: none 奇怪行为有关，这将起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-06T14:05:04.540

如果有人正在寻找它，我已经找到了解决问题的另一种方法。我所做的是使用 javascript 覆盖表单的 OnSubmit 函数，从而捕获导致问题的异常并继续执行其余代码。

然而，该解决方案是一种“黑客”，因为它并不涵盖所有情况。我在[FreeTextBox 论坛](http://freetextbox.com/forums/permalink/3933/8604/ShowThread.aspx#8604)中找到了解决方案并尝试了它并且它有效。我的代码中唯一的区别是我在覆盖函数的末尾返回 true：

```
function OvrdSubmit()
{
    var ftbSubmit=document.forms[0].onsubmit;
    if (typeof(ftbSubmit) == 'function')
    {
        document.forms[0].onsubmit = function()
        {
            try{ftbSubmit();}
            catch(ex){}
        }
    }

    // We are ok
    return true;
} 
```

由于我的站点是一个 ASP.NET 站点，我还必须在 Page_Load() 中添加这一行：

```
ClientScript.RegisterOnSubmitStatement(this.GetType(), String.Concat(this.ClientID, "_OnSubmit"), "javascript: return OvrdSubmit();"); 
```

希望它可以帮助任何有同样问题的人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T16:13:29.993

Firefox 在任何具有 display:none 样式的内容中存在问题。我所做的是使用带有 zIndex 的 div 来隐藏 div，直到我需要它显示。我会从那里开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T08:37:38.760

感谢您的回答，但是我目前的问题是 FreeTextBox 在 AJAX 选项卡面板内，因此我必须重建整个选项卡功能才能这样做，而且我没有足够的时间！

对于它的价值，我接近解决方案（我认为），将 FTB 的 .ReadOnly 属性设置为 true，然后在 controlo .PreRender 上将其设置回 false。它在页面第一次加载时工作，所以现在我必须弄清楚如何为每个回发正确实现它。

如果我找到它，我会发布解决方案！

不管怎么说，还是要谢谢你！

# java - Java中的静态嵌套类，为什么？

> ID：253492
> 
> 赞同：226
> 
> 时间：2008-10-31T13:36:51.153
> 
> 标签：java, class, static, member

我正在查看 Java 代码`LinkedList`并注意到它使用了静态嵌套类`Entry`.

```
public class LinkedList<E> ... {
...

 private static class Entry<E> { ... }

} 
```

使用静态嵌套类而不是普通内部类的原因是什么？

我能想到的唯一原因是，Entry 无法访问实例变量，因此从 OOP 的角度来看，它具有更好的封装性。

但我认为可能还有其他原因，也许是性能。可能是什么？

笔记。我希望我的术语是正确的，我会称它为静态内部类，但我认为这是错误的：http: [//java.sun.com/docs/books/tutorial/java/javaOO/nested.html](http://java.sun.com/docs/books/tutorial/java/javaOO/nested.html)

* * *

## 回答 #1

> 赞同：281
> 
> 时间：2008-10-31T13:47:43.830

您链接到的 Sun 页面在两者之间有一些关键区别：

> 嵌套类是其封闭类的成员。非静态嵌套类（内部类）可以访问封闭类的其他成员，即使它们被声明为私有。静态嵌套类无权访问封闭类的其他成员。
> ...
> 
> 注意：静态嵌套类与其外部类（和其他类）的实例成员交互，就像任何其他顶级类一样。**实际上，静态嵌套类在行为上是一个顶级类，为了方便打包，它已经嵌套在另一个顶级类中。**

不需要`LinkedList.Entry`是顶级类，因为它*仅*由使用`LinkedList`（还有一些其他接口也具有名为的静态嵌套类`Entry`，例如`Map.Entry`- 相同的概念）。而且由于它不需要访问 LinkedList 的成员，因此它是静态的是有意义的——这是一种更简洁的方法。

正如[Jon Skeet 指出的那样](https://stackoverflow.com/a/253507/4249)，我认为如果您使用嵌套类，最好从静态开始，然后根据您的使用情况决定它是否真的需要是非静态的。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2008-10-31T13:40:38.697

在我看来，每当你看到一个内部类时，问题应该是相反的——它*真的*需要是一个内部类吗，具有额外的复杂性和对实例的隐式（而不是显式和更清晰，IMO）引用包含类的？

请注意，我偏向于 C# 粉丝 - C# 没有内部类的等价物，尽管它确实有嵌套类型。我不能说我已经错过了内部课程:)

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2008-10-31T14:25:02.367

这里需要考虑一些不明显的内存保留问题。由于非静态内部类维护对其“外部”类的隐式引用，因此如果内部类的实例被强引用，则外部实例也被强引用。当外部类没有被垃圾回收时，这可能会导致一些令人头疼的问题，即使*看起来*没有任何东西引用它。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2016-10-26T16:25:59.667

静态内部类用于构建器模式。静态内部类可以实例化它的外部类，它只有私有构造函数。**您不能对内部类做同样的事情，因为您需要在访问内部类之前创建外部类的对象。**

```
class OuterClass {
    private OuterClass(int x) {
        System.out.println("x: " + x);
    }

    static class InnerClass {
        public static void test() {
            OuterClass outer = new OuterClass(1);
        }
    }
}

public class Test {
    public static void main(String[] args) {
        OuterClass.InnerClass.test();
        // OuterClass outer = new OuterClass(1); // It is not possible to create outer instance from outside.
    }
} 
```

这将输出 x: 1

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-12-16T10:31:19.713

静态嵌套类就像任何其他外部类一样，因为它无法访问外部类成员。

只是为了包装方便，我们可以将静态嵌套类合并到一个外部类中以提高可读性。除此之外，没有其他静态嵌套类的用例。

这种用法的示例，您可以在 Android R.java (resources) 文件中找到。android 的 res 文件夹包含 layouts（包含屏幕设计）、drawable 文件夹（包含用于项目的图像）、values 文件夹（包含字符串常量）等。

由于所有文件夹都是 Res 文件夹的一部分，android 工具会生成一个 R.java（资源）文件，该文件内部包含许多静态嵌套类，用于它们的每个内部文件夹。

**这是在 android 中生成的 R.java 文件的外观和感觉：** 这里它们仅用于打包方便。

```
/* AUTO-GENERATED FILE.  DO NOT MODIFY.
 *
 * This class was automatically generated by the
 * aapt tool from the resource data it found.  It
 * should not be modified by hand.
 */

package com.techpalle.b17_testthird;

public final class R {
    public static final class drawable {
        public static final int ic_launcher=0x7f020000;
    }
    public static final class layout {
        public static final int activity_main=0x7f030000;
    }
    public static final class menu {
        public static final int main=0x7f070000;
    }
    public static final class string {
        public static final int action_settings=0x7f050001;
        public static final int app_name=0x7f050000;
        public static final int hello_world=0x7f050002;
    }
} 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-10-31T13:52:51.667

好吧，一方面，非静态内部类有一个额外的隐藏字段，它指向外部类的实例。因此，如果 Entry 类不是静态的，那么除了具有不需要的访问权限外，它还会携带四个指针而不是三个指针。

作为一项规则，我会说，如果您定义一个基本上用作数据成员集合的类，例如 C 中的“结构”，请考虑将其设为静态。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-11-21T19:09:03.753

从[http://docs.oracle.com/javase/tutorial/java/javaOO/whentouse.html](http://docs.oracle.com/javase/tutorial/java/javaOO/whentouse.html)：

> 如果您需要访问封闭实例的非公共字段和方法，请使用非静态嵌套类（或内部类）。如果您不需要此访问权限，请使用静态嵌套类。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-10-31T13:58:25.587

简单的例子：

```
package test;

public class UpperClass {
public static class StaticInnerClass {}

public class InnerClass {}

public static void main(String[] args) {
    // works
    StaticInnerClass stat = new StaticInnerClass();
    // doesn't compile
    InnerClass inner = new InnerClass();
}
} 
```

如果是非静态类，则无法在上层类的实例中实例化该类（因此在 main 是静态函数的示例中除外）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-10-31T13:46:06.737

静态与正常的原因之一与类加载有关。您不能在其父级的构造函数中实例化内部类。

PS：我一直认为“嵌套”和“内部”是可以互换的。术语中可能存在细微差别，但大多数 Java 开发人员都会理解。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-11-24T13:26:18.803

非静态内部类可能导致内存泄漏，而静态内部类将防止它们。如果外部类拥有大量数据，它会降低应用程序的性能。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-09-18T05:53:38.803

1.  JVM 不知道嵌套类。嵌套只是语法糖。

    下图显示了 Java 文件：

    [![在此处输入图像描述](https://i.stack.imgur.com/ql56F.png)](https://i.stack.imgur.com/ql56F.png)

    下图显示了 java 文件的类文件表示：

    [![在此处输入图像描述](https://i.stack.imgur.com/YztK8.png)](https://i.stack.imgur.com/YztK8.png)

    请注意，生成了 2 个类文件，一个用于父类，另一个用于嵌套类。

2.  非静态嵌套类的对象可以访问封闭范围。通过在嵌套对象中保存封闭范围对象的隐式引用来维护对封闭范围的访问

3.  嵌套类是一种表示嵌套类类型表示父类组件的意图的方式。

    ```
    public class Message {

    private MessageType messageType; // component of parent class

    public enum MessageType {
        SENT, RECEIVE;
    }
    }

    class Otherclass {

    public boolean isSent(Message message) {
        if (message.getMessageType() == MessageType.SENT) { // accessible at other places as well
            return true;
        }
        return false;
    }
    } 
    ```

4.  私有静态嵌套类代表Point#3&嵌套类型只能是父类的子组件的事实。不能单独使用。

    ```
    public class Message {

     private Content content; // Component of message class

     private static class Content { // can only be a component of message class

      private String body;
      private int sentBy;

      public String getBody() {
         return body;
      }

      public int getSentBy() {
         return sentBy;
      }

    }
    }

    class Message2 {
      private Message.Content content; // Not possible
    } 
    ```

5.  更多细节[在这里](https://blog.jooq.org/2015/02/02/top-5-use-cases-for-nested-types/)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-10-31T13:46:27.700

我不知道性能差异，但正如你所说，静态嵌套类不是封闭类实例的一部分。除非您确实需要将其作为内部类，否则创建静态嵌套类似乎更简单。

这有点像为什么我总是在 Java 中使我的变量成为最终变量——如果它们不是最终的，我知道它们会发生一些有趣的事情。如果您使用内部类而不是静态嵌套类，那么应该有充分的理由。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-10-22T13:13:37.187

在某些情况下，使用静态嵌套类而不是非静态类可以节省空间。例如：`Comparator`在一个类中实现一个，比如 Student。

```
public class Student {
  public static final Comparator<Student> BY_NAME = new ByName();
  private final String name;
  ...
  private static class ByName implements Comparator<Student> {
    public int compare() {...}
  }
} 
```

然后`static`确保 Student 类只有一个 Comparator，而不是每次创建新的学生实例时都实例化一个新的。

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2016-03-01T07:10:09.810

内部阶级的优势——

1.  一次性使用
2.  支持和改进封装
3.  可读性
4.  私有字段访问

没有外部类的存在，内部类将不存在。

```
class car{
    class wheel{

    }
} 
```

有四种类型的内部类。

1.  普通内部类
2.  方法本地内部类
3.  匿名内部类
4.  静态内部类

观点 - -

1.  从静态内部类，我们只能访问外部类的静态成员。
2.  在内部类中，我们不能声明静态成员。
3.  为了在外部类的静态区域调用正常的内部类。

    `Outer 0=new Outer(); Outer.Inner i= O.new Inner();`

4.  为了在外部类的实例区域调用普通的内部类。

    `Inner i=new Inner();`

5.  为了在外部类之外调用正常的内部类。

    `Outer 0=new Outer(); Outer.Inner i= O.new Inner();`

6.  inside Inner class 这个指向内部类的指针。

    `this.member-current inner class outerclassname.this--outer class`

7.  对于内部类适用的修饰符是 --public,default,

    `final,abstract,strictfp,+private,protected,static`

8.  outer$inner 是内部类名的名称。

9.  实例方法内部的内部类，然后我们可以访问外部类的静态和实例字段。

10.inner class inside static method 然后我们只能访问静态字段

外层。

```
class outer{

    int x=10;
    static int y-20;

    public void m1() {
        int i=30;
        final j=40;

        class inner{

            public void m2() {
                // have accees x,y and j
            }
        }
    }
} 
```

# asp.net - 在后面的 asp.net 代码中使用 web 服务的最佳方法

> ID：253503
> 
> 赞同：5
> 
> 时间：2008-10-31T13:39:58.493
> 
> 标签：asp.net, sql-server, vb.net, web-services, asmx

我正在尝试将数据源绑定到转发器，例如，在页面加载时绑定到 Web 服务（来自不同网站的 .asmx）。Web 服务从 sql 调用返回一个 DataSet。这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T15:27:22.677

因为您正在呼叫另一个网站，所以您必须解决两个问题（特别是如果此 Web 服务位于其他人的网站上或通过公共互联网）。首先，从其他网站检索数据可能会有延迟。其次，其他网站可能会超时。

至少您应该考虑[异步页面](http://msdn.microsoft.com/en-us/magazine/cc163725.aspx)请求。正如这篇 MSDN 文章所述：

> 如果同步请求成为 I/O 绑定的——例如，如果它调用远程 Web 服务或查询远程数据库并等待调用返回——那么分配给请求的线程会卡住，直到调用返回。这阻碍了可伸缩性，因为线程池具有有限数量的可用线程。如果所有请求处理线程都被阻塞以等待 I/O 操作完成，则其他请求将排队等待线程空闲。充其量，吞吐量会降低，因为请求等待处理的时间更长。在最坏的情况下，队列已满，并且 ASP.NET 使后续请求失败，并出现 503“服务器不可用”错误。

但最好的解决方案可能是使用 AJAX。加载页面然后发出 ajax 请求来填充中继器。这样，您可以在等待 Web 服务时获得漂亮的“旋转”图形或发生其他事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T14:13:33.950

调用 web 服务，获取结果，并将其绑定到您的转发器。

如果可以，您也可以尝试将信息缓存一段时间，以帮助提高整体性能。

# windows-mobile - Windows Mobile 上的扩展相机控制

> ID：253508
> 
> 赞同：2
> 
> 时间：2008-10-31T13:41:45.887
> 
> 标签：windows-mobile, camera

我知道如何使用 SHCameraCapture 在 Windows Mobile 5.0/6 上捕获相机快照。但是有没有更广泛的东西可以让我更好地控制？即获得可用的缩放级别并以编程方式设置缩放级别，例如不同的 ISO 模式/感光度和微距模式的设置（如果可用）。（即类似于[JSR 234](http://developer.sonyericsson.com/docs/DOC-1674)提供的）。

我的项目可能会用 C++ 编写。

更新：它应该在所有可用的 WM 5.0 和 6 设备上运行。我正在寻找不特定于特定模型的通用解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T13:57:47.523

对于 ISO 模式、感光度和其他高级控制等。从我所看到的一切来看，它通常是特定于设备的。我知道不同的制造商会通过他们的 SDK 公开他们的成像器库。您使用的是哪种移动设备？与制造商核实通过其 SDK 公开的 API。

对于简单的东西，您可能已经看过以下类：

[CameraCaptureDialog 类](http://msdn.microsoft.com/en-us/library/microsoft.windowsmobile.forms.cameracapturedialog.aspx)

对于图像质量之类的东西：

[CameraCaptureStillQuality 枚举](http://msdn.microsoft.com/en-us/library/microsoft.windowsmobile.forms.cameracapturestillquality.aspx)

** 注意：这些适用于 Windows Mobile 6。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T07:31:25.243

通过关于 SO 的其他一些问题，我发现[http://blogs.msdn.com/marcpe/archive/2006/03/03/542941.aspx](http://blogs.msdn.com/marcpe/archive/2006/03/03/542941.aspx)它提供了另一种（通用）访问相机的方式。我还没有弄清楚我可以设置什么以及如何设置缩放等选项，但我想这就是要走的路。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-20T21:51:05.027

我已经修改并使用了您链接到的示例中的代码（代码基本上包含 DirectShow）。它不会让您控制您想要控制的相机方面（变焦、感光度等）。如果相机甚至具有这些功能并且完全暴露了这些功能，那么它只是通过它们的 API 来实现的，因此是特定于设备的。

您可以使用代码以编程方式设置分辨率（虽然这很棘手）并启动相机，并将图片作为位图获取，然后您可以做任何您想做的事情，这样您就可以实现自己的缩放功能、颜色过滤器等. 顺便说一句，如果你成功地做到了这一点，我认为你最终会得到一个商业上可行的产品，因为在 Windows Mobile 世界中绝对没有这样做（希望我被另一个答案证明是错误的）。

我还从该代码中了解到为什么（便宜的）数码相机在将屏幕用作取景器时总是拍得很晚（这就是为什么你的照片永远不会像你想要的那样），以及为什么这是一个根本无法解决的问题（在至少在便宜的数码相机中）。

# c# - 如何创建可以像 UserControl 一样编辑的 TabPage 的子类？

> ID：253517
> 
> 赞同：4
> 
> 时间：2008-10-31T13:46:42.960
> 
> 标签：c#, .net, winforms, custom-controls

我想创建一个包含一些控件的 TabPage 的子类，并且我想通过设计器来控制这些控件的布局和属性。但是，如果我在设计器中打开我的子类，我不能像在 UserControl 上那样定位它们。我不想创建一个带有 UserControl 实例的 TabPage，我想直接设计 TabPage。

我怎么做？我尝试更改 Designer 和 DesignerCategory 属性，但没有找到任何有用的值。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-31T16:58:23.087

我过去也遇到过类似的问题。

我首先做的是像这样从继承用户控件切换到标签页

class UserInterface : UserControl // 做设计器位，然后将其更改为

类用户界面：标签页

其次，我只是将我所有的控件和东西放在用户控件中并将其停靠在一个标签页中。

第三，我创建了一个通用类，它接受任何用户控件并自动进行对接。

因此您可以使用“UserInterface”类并获得可以添加到 System.Windows.Forms.TabControl 的类型

```
public class UserTabControl<T> : TabPage
    where T : UserControl, new ()
{
    private T _userControl;
    public T UserControl 
    { 
        get{ return _userControl;}
        set
        {          
            _userControl = value;
            OnUserControlChanged(EventArgs.Empty);
        }
    }
    public event EventHandler UserControlChanged;
    protected virtual void OnUserControlChanged(EventArgs e)
    {
        //add user control docked to tabpage
        this.Controls.Clear();      
        UserControl.Dock = DockStyle.Fill;
        this.Controls.Add(UserControl);

        if (UserControlChanged != null)
        {
            UserControlChanged(this, e);
        }
    }

    public UserTabControl() : this("UserTabControl")
    {
    }

    public UserTabControl(string text) 
        : this( new T(),text )
    {
    }

    public UserTabControl(T userControl) 
        : this(userControl, userControl.Name)
    {
    }

    public UserTabControl(T userControl, string tabtext)
        : base(tabtext)
    {
        InitializeComponent();
        UserControl = userControl;  
    }

    private void InitializeComponent()
    {
        this.SuspendLayout();
        // 
        // UserTabControl
        // 

        this.BackColor = System.Drawing.Color.Transparent;
        this.Padding = new System.Windows.Forms.Padding(3);
        this.UseVisualStyleBackColor = true;
        this.ResumeLayout(false);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T19:32:06.473

我通过将页面本身设计为单独的表单来处理这个问题，然后在运行时托管在标签页中。

你如何把一个表格放在一个里面`TabPage`？

```
form.TopLevel = false;
form.Parent = tabPage;
form.FormBorderStyle = FormBorderStyle.None; // otherwise you get a form with a 
                                             //  title bar inside the tab page, 
                                             //  which is a little odd 
```

# mysql - 数据库中已删除记录的数字主键是否会被重用于未来的新记录？

> ID：253522
> 
> 赞同：5
> 
> 时间：2008-10-31T13:47:47.667
> 
> 标签：mysql, sql-server, database, primary-key, rdbms

例如，如果我有一个自动编号的字段，我会添加新记录而不指定此字段，并让数据库引擎为我选择它。
那么，它会选择删除记录的编号吗？如果是，什么时候？

// SQL 服务器，MySQL。//

后续问题：[当数据库引擎用完用于主键的数字时会发生什么？](https://stackoverflow.com/questions/253616/what-happens-when-db-engine-runs-out-of-numbers-to-use-for-primary-keys)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-10-31T13:48:52.843

不。数字主键不会被重用，除非你手动指定它们（你真的应该避免这种情况！）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-10-31T14:02:43.970

AFAIK，这*可能*发生在 MySQL 中：

[AUTO_INCREMENT 处理如何在 InnoDB 中工作](http://dev.mysql.com/doc/refman/5.0/en/innodb-auto-increment-handling.html)：

> 只要服务器运行，InnoDB 就会使用内存中的自动增量计数器。当服务器停止并重新启动时，InnoDB 重新初始化每个表的计数器，以便第一次插入到表中，如前所述。

[重启服务器后。Innodb 重用以前生成的 auto_increment 值。](http://bugs.mysql.com/bug.php?id=8402) ：

> 建议修复：重新启动后，innodb 表不应丢失 auto_increment 列的下一个数字的跟踪。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-31T13:49:21.330

取决于自动编号系统。如果您使用任何类型的序列，则已删除记录的数量将不会被重用，因为序列不知道它们。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-31T13:51:24.133

一般来说，不，数字不会被重复使用。

但是，您可以——在像 Oracle 这样的产品中——指定一个循环生成器并重复使用数字。

这些是否是已删除记录的数量是您的应用程序的问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T13:52:51.167

不具体。如果键是从序列或自动递增标识列中读取的，则序列将插入并产生下一个值。但是，您可以停用此功能（`set identity_insert on`在 SQL Server 上）并在列中放置您想要的任何数字，只要它不违反唯一性约束即可。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-31T13:53:16.330

这个问题需要更精确：

...“使用 Oracle 序列”

...“使用 MySQL 自动编号列”

... ETC...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-31T13:54:47.903

只要您正确创建表格，您就不会重复使用数字。但是，您可以使用以下命令重新设置标识列（无论如何在 MSSQL 中）：

-- 输入表格中最后一个有效条目的编号，而不是下一个要使用的编号

DBCC CHECKIDENT ([TableName], RESEED, [NumberYouWantToStartAt])

这当然是疯狂的......永远不应该这样做:)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-31T13:59:19.003

MySQL 不会重用 ID，除非您`truncate`使用表或`delete from`没有`where`子句的表（在这种情况下，MySQL 在内部只是简单地执行 a `truncate`）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-31T20:18:04.307

是的，这实际上取决于您生成 id 的方式。

例如，如果您使用 GUID 作为主键，大多数获取随机新 Guid 的实现不太可能再次选择另一个 guid，但它会给予足够的时间，如果 Guid 不在表中，则插入语句将执行很好，但是如果那里已经有一个 guid，那么您将违反主键约束。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-30T16:17:39.437

我认为重用 id 的 MySQL“功能”是一个错误。

考虑像处理文件上传这样的事情。使用数据库 id 作为文件名是一个很好的做法：简单，没有用户提供的文件名等漏洞的风险。

当涉及文件系统时，您不能真正使所有事务都具有事务性...您必须提交数据库事务然后写入文件，或者写入文件并提交数据库事务，但是如果一个或两个都失败，或者您有崩溃，或者你的网络文件系统有问题，你可能在数据库中有一个有效的记录而没有文件，或者一个没有数据库记录的文件，因为它不是原子的。

如果发生这样的问题，并且服务器返回时做的第一件事就是覆盖 ids，从而覆盖回滚事务的文件，那就糟透了。这些文件可能很有用。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-09-10T12:25:16.450

不，想象一下如果您的银行决定重新使用您的 account_id - 啊！

# mobile - 移动 Web 功能的演示？

> ID：253523
> 
> 赞同：3
> 
> 时间：2008-10-31T13:48:19.943
> 
> 标签：mobile, mobile-website

我正在尝试确定移动网站可以处理哪些类型的交互。例如，我显然无法跟踪页面级拖动操作，因为它会在移动浏览器上滚动。因此，我正在寻找可以告诉我哪些交互有效、效果如何的演示，并希望了解有关跨移动设备的一致性的信息。例如，我想知道如果我有一个适合屏幕的页面，当我拖动手指时，我的页面元素会接收鼠标移动事件吗？我可以自己测试，但我认为可能有很多东西可以测试，所以我希望有类似 ACID 测试的东西，但用于移动 UI 交互。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T13:57:47.710

我认为我从未见过这样的事情，但要记住的是，浏览器只是应用程序与用户之间交互的一个关键因素。设备本身的功能是您能做什么和不能做什么的很大一部分。一方面，iPhone 具有完整的 JavaScript 堆栈和 CSS 渲染能力以及“点击”能力。但是，在 BlackBerry 上，您将失去很多 CSS 和 JavaScript 功能。此外，使用诺基亚手机，您将面对不同的野兽。进行此类开发的最佳方法是使用框架/设备模板（如[ASP.NET Mobile 平台](http://www.asp.net/mobile/)），或者尽可能接近基本 HTML。

没有灵丹妙药，你只需要尽可能多地占据市场份额。我可以分享的一件事是，您的标记越符合标准和语义，它在设备上呈现的效果就越好。有时，如果在 CSS 和 JS 不可用时，您的网站会很好地降级，您甚至可以只对网站进行编码。

# cocoa - 在没有页面设置的情况下打印 - 对纸张尺寸和方向变化做出反应？

> ID：253529
> 
> 赞同：0
> 
> 时间：2008-10-31T13:49:10.443
> 
> 标签：cocoa, macos, printing

Leopard 的 AppKit 发行说明说：

> 在许多应用程序中，向用户显示页面设置面板是不合适的，甚至在文件菜单中包含页面设置...项目是不合适的，但是没有其他简单的方法可以让用户指定要使用的页面设置参数打印时。（新的 UI 建议：如果您的应用程序没有在每个文档的基础上持久存储页面设置参数，或者有某种机制将它们与您的应用程序可能处理的任何其他类型的大型对象相关联，它可能不应该有一个页面设置面板。）

我有相当简单的打印需求，想从我的应用程序中删除“页面设置...”命令。

我之前打印文本的方法是为当前纸张大小和方向创建一个合适大小的屏幕外文本视图，然后为该视图启动打印操作。

但是，如果允许用户在打印面板中更改纸张大小和方向，我需要对该更改做出反应并重新配置我的打印文本视图。

处理这种情况的正确方法是什么？

我当前破解的示例应用程序通过子类化 NSTextView 并重新配置`-[MyTextView knowsPageRange:]`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-02T22:56:36.873

One approach that's slightly hacky but works really well is to run two NSPrintOperations.

We use this in our app's printing code, to detect if the user selected a regular printer or a receipt printer in the print panel. The app prints an entirely different document for each kind of printer.

So in PyObjC, untested code:

```
def smartlyPrintView_(self, theViewToPrint):
    # set up and run an initial NSPrintOperation to get printInfo
    fakePrintOperation = NSPrintOperation.printOperationWithView_(theViewToPrint)
    NSPrintOperation.setCurrentOperation_(fakePrintOperation)

    if NSPrintPanel.printPanel().runModal() == True:
        # get the printInfo so we can do stuff with it
        printInfo = fakePrintOperation.printInfo()
        # get rid of our fakePrintOperation
        NSPrintOperation.currentOperation().cleanUpOperation()

        # do stuff

        # run a real NSPrintOperation without a printPanel
        realPrintOperation = NSPrintOperation.printOperationWithView_printInfo_(theViewToPrint, printInfo)
        realPrintOperation.setShowsPrintPanel_(False)
        realPrintOperation.runOperation()

    else:
        NSPrintOperation.currentOperation().cleanUpOperation() 
```

Recipe to translate this to Obj-C:

Add some variable declarations, replace the underscores with colons, and interleave the arguments with the method's clauses. Mix in half a cup of flour and a handful of semi-colons. Simmer at low heat for thirthy minutes and serve hot. Good luck :)

# jquery - 如何在 MVC Ajax 中使用 jQuery blockui 插件？

> ID：253544
> 
> 赞同：0
> 
> 时间：2008-10-31T13:53:17.547
> 
> 标签：jquery, asp.net-mvc, ajax

我一直在这里阅读这篇文章：

[http://encosia.com/2008/10/04/using-jquery-to-enhance-aspnet-ajax-progress-indication/](http://encosia.com/2008/10/04/using-jquery-to-enhance-aspnet-ajax-progress-indication/)

但它想使用以下对象：

```
Sys.WebForms.PageRequestManager.getInstance() 
```

使用 MVC AJAX 代码时不存在。当回发从 MVC AJAX 结束时，有没有人尝试过挂钩以了解何时解除对 UI 的阻塞？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-27T19:36:12.970

没有真正的方法可以按预期使用 blockUI 并与服务器进行完整的往返。

如果您使用 jQuery 的 $.ajax() 或 $.getJSON 函数异步处理服务器，您可以在调用之前阻塞，然后在“成功”处理程序中解除阻塞。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T14:22:38.463

Dave 是对的，没有“MVC”方法可以做到这一点，但您当然可以访问 jQuery 中的 ajax 事件。如果 AJAX 调用在 250 毫秒内返回，“setTimeout”调用允许我们隐藏 blockUI。

```
$().ajaxSend(function() {
  doLoad = setTimeout(function() { 
   $("#divtoblock").block({ message: "Loading..." }); }, 250);
});

$().ajaxComplete(function() {
  clearTimeout(doLoad);
  $("#divtoblock").unblock();
}); 
```

# security - 有没有检查网站/服务器漏洞的好服务

> ID：253545
> 
> 赞同：2
> 
> 时间：2008-10-31T13:53:31.917
> 
> 标签：security

我被要求提供有关评估我们当前和任何未来网站是否存在安全问题的可用技术的信息。请求的形式为

> 您知道任何可以检查安全漏洞的免费软件吗？

我认为我们的数据安全性可能值得少量的前期支出，因此任何非免费方法也会受到赞赏。

我们的系统是 mySQL、Oracle、SQLServer、PHP、ASP.NET 等系统的混合体，尽管我认为这无关紧要。所有系统都受到保护，因为它们已打补丁，并且防火墙设置合理，因此外部人员无法直接进入数据库盒等。

我们希望阻止的是 XSS 和类似的攻击。

你用什么让你对你的系统充满信心？');DROP TABLE 答案;

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T13:55:09.573

[owasp](http://www.owasp.org/index.php/Main_Page)将是一个很好的起点。这里要涵盖的内容太多了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T14:04:51.563

如果您网站的安全性对您的公司毫无价值，那么这就是您应该支付的费用。对我公司而言，我们的数据安全和品牌形象具有相当高的价值。

我们为定期扫描支付了一大笔钱，我们已经对开发人员进行了基本黑客/应用程序安全性方面的培训，我们的代码审查包括安全审查，现在我们正在研究 IBM 的 AppScan（价格昂贵但长期运行可能比我们支付的所有笔测试便宜）。

你得到你所付出的。不过，确保您了解 owasp 问题将是一个好的开始。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T16:57:26.287

就个人而言，我选择对我们系统的安全性不自信。我坚信总会有一些我错过的东西，因此我一直在寻找它。

你似乎在寻找能让别人感到自信的东西（即使这种自信是一种幻觉）。渗透测试可能是正确的选择。根据工具的不同，它会在一个不错的报告中显示潜在的漏洞，然后您可以报告您是如何缓解它们的。

我们使用 IBM AppScan，它是一个很好的工具。与任何此类测试人员一样，您会发现自己跟踪了很多不良线索。它们中的大多数本身并不是虚假的，更多的是可能是问题或看起来是问题的事情，您必须调查并确定它们是否真的存在。

我不会对这种测试充满信心。如果您的应用程序扫描干净，这并不意味着您的应用程序是干净的。并不意味着它一文不值，但不要让它超过它。

接下来我要研究的是各种语言的静态分析工具。其中很多都是免费的。与之齐头并进的是开发人员教育。这通常是一个非常便宜的解决方案，只要确保他们了解风险是什么。

没有灵丹妙药，没有简单的答案，您需要将安全定义为每个人的问题，并确保它被赋予优先级和承诺。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T17:15:05.113

查看 dotDefender - 他们有 IIS/Apache/ISA 的版本。我使用这个应用程序来防止 SQL 注入/XSS/DDOS/探测/编码攻击。没有任何软件是完美的，但就我而言，我运行的系统是用 .NET、PHP 和经典 ASP 开发的网站，我们的一些网站是新的，而另一些网站已有 5 年以上的历史。

[http://www.applicure.com/?page=dotDefender](http://www.applicure.com/?page=dotDefender)

我也确实有一家公司每年都进行渗透测试/社会工程，但是对于 dotDefender，我至少很高兴我有一个基线安全毯来保护我的网站。

我特别感兴趣的是他们的应用程序完全兼容 x64 - 因为我使用的是 x64 Web 服务器，所以这是必要的。

# 3d - 3D 几何：将一对点转换为与另一个点平行对齐

> ID：253546
> 
> 赞同：1
> 
> 时间：2008-10-31T13:53:33.053
> 
> 标签：3d, geometry, transform, direct3d

我有一条从 (x1,y1,z1) 到 (x2,y2,z2) 的线（实际上是一个立方体）。我想旋转它，使其沿着从（x3，y3，z3）到（x4，y4，z4）的另一条线对齐。目前我正在`Math::Atan2`与`Matrix::RotateYawPitchRoll`. 有没有更好的方法来做到这一点？

编辑：我认为我对这篇文章的措辞非常糟糕。我实际上正在寻找的是来自两个向量的旋转矩阵。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T14:19:47.977

是的，你可以做到这一点，根本不需要考虑角度。

由于您有一个立方体，假设您选择一个角，然后将从它向外辐射的 3 个边定义为向量 f0、f1、f2（这些是方向向量，相对于您选择的角）。将它们归一化并将它们写为矩阵 F 中的列

```
(f0x f1x f2x)
(f0y f1y f2y)
(f0z f1z f2z) 
```

现在对要旋转到的立方体的向量 t0、t1、t2 执行相同的操作，并将其称为矩阵 T。

现在矩阵 R = T * Inverse(F) 是从第一个立方体的方向旋转到第二个立方体的方向的矩阵（因为逆 F 映射例如 f0 到 (1 0 0)'，然后 T 映射 (1 0 0)' 到 t0)。

如果您想知道为什么会这样，请考虑坐标系基向量：如果您想将 XY 和 Z 轴旋转到新的坐标系，那么旋转矩阵的列就是您想要的向量 (1 0 0)', (0 1 0)' & (0 0 1)' 被映射到。T*Inverse(F) 有效地将立方体从其原始方向旋转到轴对齐，然后再旋转到所需的方向。

（抱歉，上面是左侧的列向量和变换，OpenGL 风格。我似乎记得 Direct3D 是右侧的行向量和变换，但应该很明显如何切换它）。

它也同样适用于带有翻译组件的 4x4 矩阵。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-11T06:45:31.730

您可能想要添加如何实际插值矩阵。源矩阵和目标矩阵在您的答案中很好，但计算逆矩阵是没有意义的。四元数将为您提供最短的旋转路径，因此在两个矩阵上取旋转 3x3 矩阵，转换为四元数并调整它们。为翻译和重组做一个单独的 lerp。Google for quaternion - 矩阵和反向转换以及四元数 lerp。

编辑：来自前向和向上向量的旋转矩阵是微不足道的。缺失的列是其他两个向量的叉积。（不要忘记规范化列）。

# c# - 如何将 HttpWebRequest 与 GET 方法一起使用

> ID：253549
> 
> 赞同：29
> 
> 时间：2008-10-31T13:53:47.267
> 
> 标签：c#, .net, silverlight, web-services, http

当方法为“POST”时，我有以下代码可以正常工作，但更改为“GET”不起作用：

```
HttpWebRequest request = null;
request = HttpWebRequest.Create(uri) as HttpWebRequest;
request.ContentType = "application/x-www-form-urlencoded; charset=UTF-8";
request.Method = "POST"; // Doesn't work with "GET"

request.BeginGetRequestStream(this.RequestCallback, null); 
```

`ProtocolViolationException`“GET”方法出现异常。

**编辑：**使用反射器查看后，似乎对“GET”方法进行了显式检查，如果它设置为它会引发异常。

**Edit2：**我已将代码更新为以下内容，但是当我调用 EndGetResponse() 时它仍然引发异常

```
if (request.Method == "GET")
{
    request.BeginGetResponse(this.ResponseCallback, state);
}
else
{
    request.BeginGetRequestStream(this.RequestCallback, state);
} 
```

在我的函数 ResponseCallback 中，我有这个：

```
HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(asyncResult); 
```

这也会引发异常。

**回答**

上面的代码现在可以工作了，我忘记取出导致最后抛出异常的 Content-Type 行。+1 调整并回答乔恩。

工作代码现在如下：

```
HttpWebRequest request = null;
request = HttpWebRequest.Create(uri) as HttpWebRequest;
request.Method = "GET";// Supports POST too

if (request.Method == "GET")
{
    request.BeginGetResponse(this.ResponseCallback, state);
}
else
{
    request.BeginGetRequestStream(this.RequestCallback, state);
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-31T14:06:52.107

这是[在文档中指定的](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.begingetrequeststream.aspx)。基本上 GET 请求并不意味着包含正文，因此没有合理的理由调用`BeginGetRequestStream`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-31T13:55:19.790

GET 请求发送 Content-Type 是否有意义？您是否尝试删除第三行？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T14:10:54.813

BeginGetRequestStream 用于获取专门用于将数据写入请求的流。这不适用于 GET 请求。

BeginGetRequestStream 方法的文档明确指出，如果方法是 GET 或 HEAD，该方法将引发 ProtocolViolationException。

士气：阅读文档 ;-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-08-23T16:47:02.823

GetRequestStream 的文档中指定，如果方法是 GET，它将抛出 ProtocolViolationException。[但是，我在HTTP 规范](http://www.w3.org/Protocols/rfc2616/rfc2616.html)中找不到任何表明这实际上是 HTTP 协议违规的内容。认为这是一个挑战。

# c++ - C++ 有哪些参数解析器库？

> ID：253556
> 
> 赞同：76
> 
> 时间：2008-10-31T13:54:50.697
> 
> 标签：c++, command-line-arguments

我想通过以下方式将命令行上的参数传递给我的 C++ 程序：

```
./myprog --setting=value 
```

有没有图书馆可以帮助我轻松做到这一点？

# oracle - Oracle 侦听器状态被阻止

> ID：253563
> 
> 赞同：4
> 
> 时间：2008-10-31T13:56:07.637
> 
> 标签：oracle, ora-12519

我有一个在轻负载下工作正常的 webpp。但是，当我们运行很多线程时，每个线程都有自己的数据库连接，然后我们开始收到错误

```
ORA-12519: TNS:no appropriate service handler found 
```

在网上看了之后发现跑步`lsnrctl services`是一个很好的诊断步骤，所以我就这样做了。我们服务的结果是

```
Service "orcl" has 1 instance(s).
  Instance "orcl", status READY, has 1 handler(s) for this service...
    Handler(s):
      "DEDICATED" established:130 refused:0 state:blocked
         LOCAL SERVER 
```

建立的连接数与线程数一致。但是，这`state:blocked`似乎是此问题的原因和/或症状。

那么我的下一步是什么？最大打开会话数为 1024，绰绰有余，每个用户的会话数没有限制。我在重新启动机器后运行了这个测试，并且没有连接其他程序。我真的不确定接下来要尝试什么，所以任何帮助将不胜感激。

编辑：增加`processes`and`sessions`参数似乎可以解决问题。除了发现 Matthew 的建议有帮助之外，[这封电子邮件](http://srv.cyf-kr.edu.pl/pipermail/ploug/2006-August/000648.html)还完美地描述了我的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-31T14:10:15.533

您是否检查过警报日志，如果 oracle 资源不足，它应该会告诉您出了什么问题？听起来你可能没有进程，

跑进去`sqlplus`，

```
SQL> show parameter processes 
```

它将向您显示 oracle 将允许多少个进程。您可能需要增加一点。

如果您有 metalink 帐户，请查看文章**240710.1**了解更多详细信息。

# asp.net - 如何在 ASP.NET MVC 中测试自定义模型绑定器？

> ID：253574
> 
> 赞同：21
> 
> 时间：2008-10-31T13:58:24.510
> 
> 标签：asp.net, asp.net-mvc, unit-testing, model-binders

我在我们的 ASP.NET MVC 应用程序中编写了一些自定义模型绑定器（实现 IModelBinder）。我想知道对它们（活页夹）进行单元测试的好方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-31T18:27:13.907

我是这样做的：

```
var formElements = new NameValueCollection() { {"FirstName","Bubba"}, {"MiddleName", ""}, {"LastName", "Gump"} };         
var fakeController = GetControllerContext(formElements);
var valueProvider = new Mock<IValueProvider>();           

var bindingContext = new ModelBindingContext(fakeController, valueProvider.Object, typeof(Guid), null, null, null, null);

private static ControllerContext GetControllerContext(NameValueCollection form) {
    Mock<HttpRequestBase> mockRequest = new Mock<HttpRequestBase>();
    mockRequest.Expect(r => r.Form).Returns(form);

    Mock<HttpContextBase> mockHttpContext = new Mock<HttpContextBase>();
    mockHttpContext.Expect(c => c.Request).Returns(mockRequest.Object);

    return new ControllerContext(mockHttpContext.Object, new RouteData(), new Mock<ControllerBase>().Object);
} 
```

然后我只是将 bindingContext 变量传递给实现 IModelBinder 接口的对象的 BindModel 方法。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-26T05:43:49.837

这是我在博客上为您写的一个简单的非模拟方式，假设您使用 ValueProvider 而不是 HttpContext：[http ://www.hanselman.com/blog/SplittingDateTimeUnitTestingASPNETMVCCustomModelBinders.aspx](http://www.hanselman.com/blog/SplittingDateTimeUnitTestingASPNETMVCCustomModelBinders.aspx)

```
[TestMethod]  
public void DateTime_Can_Be_Pulled_Via_Provided_Month_Day_Year_Hour_Minute_Second_Alternate_Names()  
{  
    var dict = new ValueProviderDictionary(null) {   
            { "foo.month1", new ValueProviderResult("2","2",null) },  
            { "foo.day1", new ValueProviderResult("12", "12", null) },  
            { "foo.year1", new ValueProviderResult("1964", "1964", null) },  
            { "foo.hour1", new ValueProviderResult("13","13",null) },  
            { "foo.minute1", new ValueProviderResult("44", "44", null) },  
            { "foo.second1", new ValueProviderResult("01", "01", null) }  
        };  

    var bindingContext = new ModelBindingContext() { ModelName = "foo", ValueProvider = dict };  

    DateAndTimeModelBinder b = new DateAndTimeModelBinder() { Month = "month1", Day = "day1", Year = "year1", Hour = "hour1", Minute = "minute1", Second = "second1" };  

    DateTime result = (DateTime)b.BindModel(null, bindingContext);  
    Assert.AreEqual(DateTime.Parse("1964-02-12 13:44:01"), result);  
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-09T05:22:52.167

dict 可以像这样重构

```
 FormCollection form = new FormCollection
                                  {
                                      { "month1", "2" },
                                      { "day1", "12" },
                                      { "year1", "1964" },
                                      { "hour1", "13" },
                                      { "minute1", "44" },
                                      { "second1", "01" }
                                  };

            var bindingContext = new ModelBindingContext() { ModelName = "foo", ValueProvider = form.ToValueProvider() }; 
```

# java - 你的代码覆盖率有多远？

> ID：253587
> 
> 赞同：8
> 
> 时间：2008-10-31T14:01:10.947
> 
> 标签：java, tdd, code-coverage, emma

我最近开始使用代码覆盖工具（特别是 Emma 和 EclEmma），我真的很喜欢它给我的单元测试完整性的观点——以及查看单元测试的代码区域的能力。根本不打。我目前在一个不做大量单元测试的组织工作，我计划真正推动每个人进行单元测试和代码覆盖率和 TDD，并希望转换组织。

对于这个主题，我不确定的一个问题是我应该将代码覆盖率到底有多远。例如，如果我有这样的课程：

```
//this class is meant as a pseudo-enum - I'm stuck on Java 1.4 for time being
public final class BillingUnit {

    public final static BillingUnit MONTH = new BillingUnit("month");
    public final static BillingUnit YEAR = new BillingUnit("year");

    private String value;

    private BillingUnit(String value) {
        this.value = value;
    }

    public String getValue() {
        return this.value;
    }

    public boolean equals(Object obj) {
        return value.equals(((BillingUnit) obj).getValue());

    }

    public int hashCode() {
        return value.hashCode();
    }
} 
```

我编写了一些简单的单元测试以确保它`equals()`正常工作，`getValue()`返回我所期望的等等。但是由于 EclEmma 的视觉特性，该`hashcode()`方法显示为“未测试”的鲜红色。

`hashCode()`在这个例子中，考虑到实现有多简单，是否值得费心去测试？我觉得我会为这个方法添加一个单元测试，只是为了提高代码覆盖率，并摆脱 EclEmma 在这些行中添加的刺眼的红色突出显示。

也许我是神经质和强迫症，但我发现使用像 EclEmma 这样的东西可以很容易地看到未经测试的内容 - 该插件以红色突出显示源代码，并以绿色突出显示代码 - 真的让我想要尽可能多地获得 100% 绿色的课程——即使它不会增加太多好处。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-10-31T14:06:43.730

我使用代码覆盖率来提示我可能有不完整的测试集的地方。例如，我可能会为某些给定功能编写测试，然后开发满足该功能的代码，但这样做实际上编写的代码比预期的要多——比如说它可能会在另一种情况下捕获异常测试不锻炼。当我使用覆盖分析器时，我可以看到我引入了没有关联测试的代码。它可以帮助我知道我什么时候没有写足够的测试。

另一方面，覆盖分析可能导致错误的安全性。覆盖所有代码并不意味着您有足够的测试。您需要从代码应该做什么的角度考虑测试，并编写测试以确保它可以做到。最好先写测试。仅仅因为你的代码被完全覆盖并不意味着代码做了它应该做的事情。

在您的示例中，在编写代码之前，我会编写 hashCode 测试来定义该方法的功能。因此，我会覆盖它。这并不意味着我总是有 100% 的覆盖率。例如，我并不太热衷于为简单的访问器编写测试。我也可能不会测试从框架继承的父类的方法，因为我觉得不需要测试其他人的代码。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-10-31T14:07:25.087

我认为使用可以选择忽略某些类型的语句的库是值得的。例如，如果您有很多：

```
if(logger.isDebugEnabled()) {
    logger.debug("something");
} 
```

如果您可以关闭这些行的覆盖率计算，这将很有用。关闭普通 getter 和 setter（那些简单地设置或返回没有其他检查或副作用的成员变量）的覆盖率计算也可以（可以说）有效。但是，我确实认为，如果您覆盖了 equals 和 hashcode，则应该对其进行测试。您添加了重要的功能，应该对其进行测试。

需要明确的是，我认为上述情况应排除在覆盖范围之外的原因是：

*   不测试该功能是可以的。您不必将整个测试套件运行 5 次，将日志库设置为每个日志记录级别，以确保您的所有语句都被命中。
*   如果您执行上述操作，则会以另一种方式扭曲您的覆盖范围。如果您的 90% 的分支是`if(log.isDebugEnabled())`，并且您对它们都进行了测试，但没有其他分支，那么看起来您有 90% 的分支覆盖率（好），而实际上，您有 0% 的非平凡分支覆盖率（坏！！） .

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-10-31T14:32:07.593

代码覆盖率和测试覆盖率是有区别的。您应该尝试确保您的代码经过充分测试，而不是 100% 的代码覆盖率。

考虑以下代码：

```
public float reciprocal (float ex)
{
    return (1.0 / ex) ;
} 
```

如果您运行了一个通过值 1.0 的测试，那么您将获得 100% 的代码覆盖率（分支和语句），所有通过。代码显然有缺陷。

衡量测试覆盖率更加困难，而且需要成为更好的开发人员和测试人员。

具体就 hashCode 而言，老实说，您应该对该方法进行单独的单元测试。我个人会确保它至少包含在一个单元集成测试中，并且不会直接测试每个访问器/修改器。您的投资回报率通常太低，不足以证明您的努力是合理的。这当然是假设您有一个单元测试来确保您生成正确的哈希码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-31T14:37:09.423

*通过有意义的*测试达到 100% 的代码覆盖率可能不值得攀登，而且，如前所述，100% 的代码覆盖率并不一定意味着应用程序中的所有可能条件都已经过测试。

至于 testing`equals`和`hashCode`其他一些***基于契约的***接口，比如`Comparable`and `Serializable`，我确实包含了这些测试。`equals/hashCode`正确执行合同很重要，同样与`equals/Comparable`.

请参阅[JUnit-Addons](http://junit-addons.sourceforge.net/)，尤其是

*   [EqualsHashCodeTestCase](http://junit-addons.sourceforge.net/junitx/extensions/EqualsHashCodeTestCase.html)
*   [可比性测试用例](http://junit-addons.sourceforge.net/junitx/extensions/ComparabilityTestCase.html)
*   [可序列化测试用例](http://junit-addons.sourceforge.net/junitx/extensions/SerializabilityTestCase.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-31T14:06:26.803

现在它可能并不太复杂，但是如果以后修改方法，一个简单的检查来验证它是否仍然按预期工作可能会非常有用。

既然检查应该真的很容易写，为什么不这样做呢？它有助于统计数据，还有助于稍后检查以防万一。

此外，对于 TDD，您需要 100% 的覆盖率，因为这样您就可以确定（或非常接近）重构时不会破坏任何内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-31T14:12:22.470

一个和我一样的程序员在旧的 Java1.4 中卡住了；）

正如我[之前的回答](https://stackoverflow.com/questions/170751/what-techniques-have-you-actually-used-successfully-to-improve-code-coverage#170768)中所说，所涵盖的代码未经代码测试。结论是：从某个角度来看，提高代码覆盖率的唯一方法是……删除代码！

现在，关于 hashCode，将它包含在单元测试设计中以检查预期的排序机制是否得到尊重（而不是为了覆盖更多功能）是很有趣的

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-31T14:07:46.037

正如我在其他地方所说，低代码覆盖率是一个问题，但高代码覆盖率并不意味着你正在编写纯金。

如果您不关心代码覆盖率，那么我建议您需要测试`equals()`和`getValue()`- 取决于使用的方式和位置`hashCode()`（对不起，我是 C# 开发人员），那么您*可能*想要测试那。

最重要的部分是您的测试让您确信您编写了正确的代码并且代码按预期工作。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-31T16:20:29.263

在这种特殊情况下，我想说，由于您正在测试 equals 方法，您还可以测试 equals 对象是否具有相等的哈希码：只需在所有 equals 预期返回 true 的情况下添加一个额外的测试。

这将为您提供代码覆盖率，并且在讨价还价中，它将使您对 hashCode 确实满足其合同有信心:-)

考虑到您显然可以信任 String 的 hashCode 方法，并且您不希望更改此类，这只是微不足道的价值。但是如果你对你的 equals 方法有足够的怀疑来测试它，那么你应该对它有足够的怀疑来测试它和 hashCode 是否保持一致。而且，您应该始终怀疑您将来不想弄乱您以前所做的事情的假设。例如，如果有人出现并决定通过添加指针相等检查来“优化”，那么您可能还需要一整套测试来让他们运行修改后的代码。否则他们会浪费时间在你做的同样的担心上——我没有代码覆盖率可以吗？

# client - 作为开发人员，您在处理非错误客户端请求时会做什么，以及 UI 中的小修复？

> ID：253596
> 
> 赞同：2
> 
> 时间：2008-10-31T14:03:23.953
> 
> 标签：client, time-management

我只是一个从事项目的人 - 所以我是没有 PM 的开发人员。我完成了门户，但是客户端不时用诸如“使字体更大”或更改css中的边距或制作“xxx和yyy”的按钮之类的请求攻击我。有简单的任务，有时只需点击几下，但这需要我的时间，我讨厌做这样的任务。另一方面，我理解那些人，虽然有时小修复对他们的工作有很大帮助。他们在通讯器上说什么 - 很难忽视他们。禁用通信器是最好的解决方案 - 但我需要它与我的同事沟通。在这种情况下你会怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T14:06:57.787

创建一个既定队列，您的用户可以在其中提交请求，并且不会中断您的日常工作流程。

从这个声音来看，您通过定期检查的通信渠道收到请求，您可能会尝试将其移到一边。

切断通信从来都不是一个好的解决方案。此外，我会正式确定您何时收到这些类型的请求的流程和时间表。我发现这种简单的方法取得了巨大的成功。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T14:08:40.323

如果您是为自己工作，那么您的客户就是您来这里的唯一最重要的原因。他们是你的事！因此，让他们开心总是好的做法。

话虽如此...

在为客户处理任何类型的软件项目时，您应该始终拥有明确定义的合同。您需要确保向您和您的客户清楚地表达和定义您的可交付成果。处理完这些问题后，您还需要确保有一个部分涵盖“未来的维护请求”，然后您可以与您的客户合作，以​​确保您的期望在频谱的两端都是可接受的，并且您花费在它们既被考虑在内，也是原计划向前发展的一部分。

开放端越少越好。

之后，实施一个系统来管理/处理您实施的每个项目/网站的客户请求也可以提供很大帮助。[来自该网站创始人之一的FogBugz](http://www.fogcreek.com/FogBugz/)等工具在处理客户交互和错误/功能请求方面做得很好。看看这个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T14:07:44.570

虽然不是技术“错误”，但客户端的可用性对用户来说是最重要的错误。如果您想继续与客户开展业务，则需要处理小事。

修复小错误 == 客户幸福 == 更多工作 == 更多 $$

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T14:13:31.093

部署一个系统来跟踪错误和跟踪更改请求（在我的办公室，我们使用 MKS，它也用于源完整性）。然后，当用户有请求时，他们会进入跟踪系统并将请求输入为适当的类型。理想情况下，他们还应该能够附加一个严重性/优先级指标，以便可以对未完成的请求进行排名。然后，您可以进入并查看所有未完成的请求，并确定它们的优先级。由于它们不是直接发送给您的，因此您不会感到被请求淹没，并且用户会发现他们可以更轻松地跟踪请求的状态，而不是打电话给您并询问“我的修复何时完成？”

对于你自己，你可以每天检查几次列表，看看是否有任何高优先级的问题需要处理。然后定期安排一些时间（一周一天，或一天一小时，任何感觉合理的）来处理较低优先级的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T18:12:33.360

我认为您必须考虑与客户的持续关系。如果客户偶尔会花费您几分钟的时间，您可能会认为您的成本是最低的，并且联系的好处可能会超过成本。

如果请求来得很快，您可能需要与您的客户讨论每小时的更改费率，或者在收费的支持合同中涵盖它们。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-03T19:07:04.503

不要在收到的每个功能请求上更改您的路径。收集一段时间的功能请求，然后对请求进行优先级排序，然后选择有意义的请求，然后在下一个版本上工作。

在我看来，遵循一些固定的发布时间表是好的：它使开发过程更加可控，提高了软件质量，并且您的客户知道会发生什么。

# netbeans - 我可以在不破解 Makefile 的情况下使一个 Netbeans 项目依赖于另一个项目吗？

> ID：253598
> 
> 赞同：0
> 
> 时间：2008-10-31T14:03:27.887
> 
> 标签：netbeans, build-process, netbeans6.5

在 Netbeans 6.5 中，我有两个不同的 C++ 应用程序项目——我的应用程序和单元测试。我想设置它，以便如果我的主应用程序被重建，单元测试也会被重建（反之亦然）。

Netbeans 擅长解决库项目的依赖关系，并在必要时重新构建它们，但我看不到任何使一个*应用程序*项目依赖于另一个应用程序项目的方法。

我*可以*通过手动编辑 Makefile 中的 .build-post 规则来做到这一点，但这有点难看。

我怀疑在 Project Properties -> Build -> Debug -> Additional Dependencies 对话框中添加一些魔术宏会做我想要的，但我找不到任何文档。

我想这可能表明我应该切换到 Cruise Control 来自动化构建和运行测试的过程......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-26T11:15:43.550

Netbeans 6.7 中添加了对此的支持。

项目属性 -> 所需项目 -> 选择项目并勾选“构建”。

请注意，它不会让您通过让两个项目相互要求来创建循环依赖项，但您可以通过创建一个虚拟主项目来解决此问题，该项目需要您想要一起构建的所有项目。

# java - 使用 EMMA 获取 ClassFormatError？

> ID：253614
> 
> 赞同：2
> 
> 时间：2008-10-31T14:06:28.427
> 
> 标签：java, unit-testing, code-coverage, jmockit, emma

我正在尝试使用[EMMA](http://emma.sourceforge.net/)生成代码覆盖率报告，其中一些测试使用[JMockit](http://jmockit.dev.java.net)作为模拟框架。在大多数情况下，它可以工作，但我的一些测试因 ClassFormatError 而崩溃，如下所示：

```
java.lang.ClassFormatError
    at sun.instrument.InstrumentationImpl.redefineClasses0(Native Method)
    at sun.instrument.InstrumentationImpl.redefineClasses(InstrumentationImpl.java:79)
    at mockit.internal.RedefinitionEngine.redefineMethods(RedefinitionEngine.java:138)
    at mockit.internal.RedefinitionEngine.redefineMethods(RedefinitionEngine.java:73)
    at mockit.Mockit.setUpMocks(Mockit.java:177)
    at test.my.UnitTest.setUpBeforeClass(UnitTest.java:21) 
```

知道发生了什么，我是否可以解决问题？或者 EMMA 和 JMockit 是互斥的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T14:20:59.380

似乎是 JMockit 中的一个错误：在类已经被 EMMA 检测之后，JMockit 似乎在创建“reentry=true”模拟方法时遇到了问题。

删除“reentry=true”“解决了”这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T11:06:27.883

从何处以及如何删除此“reentry = true”

# database - 当数据库引擎用完用于主键的数字时会发生什么？

> ID：253616
> 
> 赞同：8
> 
> 时间：2008-10-31T14:06:36.803
> 
> 标签：database, primary-key

由于[数据库不重用已删除记录](https://stackoverflow.com/questions/253522/do-numerical-primary-keys-of-deleted-records-in-a-database-get-reused-for-futur)的数量，因此可能会用完数字，特别是如果您为此列选择的不是真正的大整数类型。
如果情况不好，会发生什么以及如何预防？

// SQL 服务器，MySQL //

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-31T14:14:03.653

你最终会有 3 小时以上的停机时间，就像[Slashdot](http://slashdot.org/articles/06/11/09/1534204.shtml)在他们的评论功能上所做的那样。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-31T14:10:59.617

我认为究竟会发生什么将取决于您使用的数据库引擎（MySQL 中的 INNODB 和 MyISAM 之间甚至可能存在差异）。不管发生什么，它都不会很漂亮。

您只需将列类型更改为更大的整数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-31T14:10:25.907

[对于 MySQL，据记载：](http://dev.mysql.com/doc/refman/6.0/en/innodb-auto-increment-handling.html)

> 如果用户为列分配负值或者该值变得大于指定整数类型中可以存储的最大整数，则不会定义自动增量机制的行为。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-31T20:10:07.147

大多数数据库系统都有一个比 32 位更宽的数字数据类型。如果您预计超过 2^32 条记录，则应使用适当的键宽。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T14:12:51.830

是的，这是可能的：如果您只允许 2 位数字，则您的 ID 最多只能为 99，依此类推。一旦达到限制，插入就会失败。选择合适的尺寸是常识。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-31T14:18:36.733

在 Postgres 中，"serial" 类型等价于使用 NO CYCLE 选项创建 SEQUENCE，并将字段的默认值设置为 nextval。用尽这样的序列会产生错误：

[http://www.postgresql.org/docs/8.3/interactive/sql-createsequence.html](http://www.postgresql.org/docs/8.3/interactive/sql-createsequence.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-10-31T20:10:17.613

这取决于您的数据库，我相信 MS SqlServer，在解决问题之前您根本无法插入任何新行。上次我遇到它时，我们通过将标识列重新设置为 1 来解决问题。这显然不是一个通用的解决方法，但我们的情况没问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-31T20:31:34.513

Oracle 不支持自动递增 ID 列，标准做法是使用序列生成器。一个序列生成最多 28 位的整数，所以如果你用完了这些整数，那么......我猜你有一个很大的表。但是行为将取决于序列生成器的配置——要么是错误，要么会循环回到起始值，并且您将在下一次插入时违反 PK 约束。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-31T20:49:18.457

我前段时间在 SQL 2000 中尝试过这个。Integer.MaxValue 之后的下一个标识值是 Integer.MinValue。然后它会像您期望的那样继续计数。只要曾经存在于 1,2,3 等处的记录在到达那里时已经消失，就不会发生任何不好的事情。如果它遇到重复项（并且该字段是主键），则插入会因键冲突而失败。我还没有尝试过不受唯一值限制的标识列。我猜它会对重复项感到满意。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-10-30T16:18:02.507

通常你会得到一个错误。如果您偏执，请使用 BIGINT。

# c# - 重构 traceListener 代码，使其可以进行单元测试

> ID：253621
> 
> 赞同：1
> 
> 时间：2008-10-31T14:06:58.907
> 
> 标签：c#, unit-testing, refactoring

我有以下代码：

```
private static void WriteStartupInfo()
    {
        Settings settings = Settings.Default;
        TimeSpan interval = settings.CleanupInterval;
        TimeSpan span = settings.ExpiryTimeSpan;
        string url = settings.TeamFoundationServerUrl; 
        StringBuilder sb = new StringBuilder();
        sb.Append(String.Format("CleanupInterval:{0}{1}", interval,Environment.NewLine));
        sb.Append(String.Format("ExpiryTimeSpan:{0}{1}", span,Environment.NewLine));
        sb.Append(String.Format("TeamFoundationServerUrl:{0}{1}", url,Environment.NewLine));
        Trace.TraceInformation(sb.ToString());
    } 
```

这需要测试。我如何对此进行单元测试？

是否像删除跟踪侦听器并添加单元测试跟踪侦听器一样简单？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T14:13:14.513

这取决于您要测试的内容。您可以将方法分解为几个方法，以便您可以测试重要的功能。例如，如果您想测试构建的字符串，请将其拉​​入单独的函数中！

```
private static void WriteStartupInfo()
{
    Trace.TraceInformation(GetStartupInfoString());
}

private static String GetStartupInfoString() {
    Settings settings = Settings.Default;
    TimeSpan interval = settings.CleanupInterval;
    TimeSpan span = settings.ExpiryTimeSpan;
    string url = settings.TeamFoundationServerUrl; 
    StringBuilder sb = new StringBuilder();
    sb.Append(String.Format("CleanupInterval:{0}{1}", interval,Environment.NewLine));
    sb.Append(String.Format("ExpiryTimeSpan:{0}{1}", span,Environment.NewLine));
    sb.Append(String.Format("TeamFoundationServerUrl:{0}{1}", url,Environment.NewLine));
    return sb.ToString();
} 
```

现在可以独立测试字符串 - 我认为 WriteStartupInfo() 函数在这一点上是微不足道的，您不需要测试 Trace 功能。

请注意，您可能需要摆弄方法的范围——我没有测试私有方法，所以我无能为力。

# tcp - 用于服务器监控的开源工具/服务

> ID：253628
> 
> 赞同：2
> 
> 时间：2008-10-31T14:08:39.077
> 
> 标签：tcp, service, health-monitoring

我正在寻找一个开源服务器监控工具，它允许以下内容：

*   监控 TCP、UDP 上的各种服务。
*   支持自定义端口号。
*   支持一些基本的响应检查（除了初始连接检查）。
*   健康状态的基本仪表板概述。
*   通过电子邮件发出警报通知。

我可以自己动手，但如果有一个完整的套件可以满足我的需求（也许更多！），我想确保我不会重新发明轮子。

**编辑**：最好是在 Windows 上运行的软件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T14:10:33.270

我推荐“mon”包（[http://www.kernel.org/software/mon](http://www.kernel.org/software/mon)）。它是大多数 Linux 发行版中的预包，并且相当可定制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T14:21:51.640

[Nagios](http://www.nagios.org/)是要走的路。非常强大和可定制。具有仪表板、历史记录、警报、图表等。

我想要一些更花哨的东西，有基于 nagios 和其他各种零碎构建的 Groundwork，但在玩了一会儿之后我不太喜欢它。除了社区版之外，它也需要任何费用。

# xml - 定义 Web 服务 - 使命名空间定义可访问的要求是什么？

> ID：253632
> 
> 赞同：2
> 
> 时间：2008-10-31T14:09:57.810
> 
> 标签：xml, web-services, xsd

我正在坐下来定义我的第一个 Web 服务，并且有一个关于命名空间定义的可访问性要求的基本问题？

当这些 Web 服务的消费者将消息元素识别为属于我的命名空间时，在发送消息时该命名空间的 URI 引用是否必须可用？

我想知道是否在消息传递时对命名空间定义进行了任何消息验证。我猜不是，因为 URI 引用主机的故障不应阻止消息的发生。

任何人都可以在这里分享有关要求的任何想法，或者提供一个良好信息来源的方向吗？

谢谢，M。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T14:21:03.373

不，命名空间 URI 不打算被取消引用。在命名空间 URI 中放置人类可读的内容是有礼貌的，但没有技术原因必须这样做。

消息验证与命名空间 URI 没有直接关系，命名空间 URI 在实践中只不过是不透明的字符串。您可以开始使用 XSI 将它们绑定在一起，但在这种情况下，将取消引用的是 XSD 文件 URI，而不是命名空间 URI。

# c# - 你能推荐 asp.net-mvc 的替代 FileUpload 控件吗？

> ID：253642
> 
> 赞同：7
> 
> 时间：2008-10-31T14:11:32.707
> 
> 标签：c#, asp.net-mvc, file-upload, web-controls

目前使用 System.Web.UI.WebControls.FileUpload 包裹在我们自己的控件中。

我们有 Telerik 的许可证。我想知道是否有人有这方面的经验或者可以推荐一个更好的？

一些衡量标准

*   验证
*   性能
*   多个文件
*   本地化（[浏览](https://stackoverflow.com/questions/94316/how-to-change-the-text-of-the-browse-button-in-the-fileupload-control-systemweb)困难）
*   安全

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T14:16:55.673

就个人而言，如果你有 Telerik 控件，我会给他们一个机会。我发现它们非常有帮助，用户体验也很好。他们的上传控制非常好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T20:30:39.040

我刚刚[在另一个问题中](https://stackoverflow.com/questions/254419/aspnet-image-uploading-with-resizing#254812)发布了这个问题，但是如果您使用此 ActiveX 控件，您将能够快速有效地处理图像。该组件实际上会在发送图像之前调整客户端计算机上的图像大小。这减少了不必要的带宽并一次传输多个图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T14:31:21.870

我们扩展了 FileUploadControl 以添加一些验证。我们还编写了自己的控件，允许一次上传多个文件。我们目前正在评估两者。希望我们决定一个，我不想维护 2 个不同的上传控件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-23T22:56:40.643

查看 Dean Brettle 的[NeatUpload](http://www.brettle.com)。它基本上是一个自定义的 HttpHandler，可以将文件流式传输到磁盘，并具有大量额外的可配置性。它是开源的，Dean 绝对是支持他的用户的明星。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-11-09T10:10:24.170

# 看看这个：

[Html-5-上传器](http://www.igloolab.com/jquery-html5-uploader/)

## 在您的网页上拖放多个文件！

链接并不总是有效，所以这里又是：[http ://www.igloolab.com/jquery-html5-uploader/](http://www.igloolab.com/jquery-html5-uploader/)

## .

控制器：（根据我的原始代码修改，希望我没有忘记一些东西，但很清楚）

```
 <HttpPost()> _
     Public Function Upload(uploadedFile As System.Web.HttpPostedFileBase) As ActionResult
        If uploadedFile IsNot Nothing Then 
            If uploadedFile.ContentLength > 0 Then

               Dim mimeType As String = Nothing 
                'Upload
                Dim PathFileName As String =   System.IO.Path.GetFileName(uploadedFile.FileName)

                 Dim path =  System.IO.Path.Combine(Server.MapPath("~/App_Data/Uploads"), PathFileName)

                If Not System.IO.Directory.Exists(Path) Then
                    System.IO.Directory.CreateDirectory(Path)
                End If

                Dim firstLoop As Boolean = True
                uploadedFile.SaveAs(path)                  
             Next
        End If
        Return Nothing
    End Function 
```

这是视图（不要忘记指向 css 和 js 的链接；））

```
 <h1>
            @SharedStrings.Upload</h1>
        <h2>
            @SharedStrings.UploadInformation</h2>
        <div id="dropbox">
        </div>
        <div id="upload">
        </div>
        <script type="text/javascript">

            $(function () {

                var fileTemplate = "<div id=\"{{id}}\">"; fileTemplate += "<div class=\"progressbar\"></div>"; fileTemplate += "<div class=\"preview\"></div>"; fileTemplate += "<div class=\"filename\">{{filename}}</div>"; fileTemplate += "</div>"; function slugify(text) { text = text.replace(/[^-a-zA-Z0-9,&\s]+/ig, ''); text = text.replace(/-/gi, "_"); text = text.replace(/\s/gi, "-"); return text; }
                $("#dropbox").html5Uploader({ onClientLoadStart: function (e, file) {
                    var upload = $("#upload"); if (upload.is(":hidden")) { upload.show(); }
                    upload.append(fileTemplate.replace(/{{id}}/g, slugify(file.name)).replace(/{{filename}}/g, file.name));
                }, onClientLoad: function (e, file) { /*$("#" + slugify(file.name)).find(".preview").append("<img src=\"" + e.target.result + "\" alt=\"\">");*/ }, onServerLoadStart: function (e, file) { $("#" + slugify(file.name)).find(".progressbar").progressbar({ value: 0 }); }, onServerProgress: function (e, file) { if (e.lengthComputable) { var percentComplete = (e.loaded / e.total) * 100; $("#" + slugify(file.name)).find(".progressbar").progressbar({ value: percentComplete }); } }, onServerLoad: function (e, file) { $("#" + slugify(file.name)).find(".progressbar").progressbar({ value: 100 }); } 
                }); 
            });
        </script> 
```

还有我的 CSS

```
 /*html 5 uploader*/
#dropbox 
{
/*picture where people would drag-drop their files to*/
 background-image:url(../Images/UploadToMedia.png);
 height:128px;
 margin-bottom:40px;
 margin-left:auto;
 margin-right:auto;
 background-repeat:no-repeat;
 margin-top:0;
 width:128px;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T14:22:21.967

您可以尝试基于 Flash 的解决方案，该解决方案允许您显示任何文本、文本框、按钮或其他任何内容，作为您自己的文件上传控件的一部分。这些解决方案通常会在页面上放置一个 1x1 的 flash 电影，作为 javascript 和 flash 之间的桥梁，以便 javascript 可以动态调用 flash 的文件上传框。

在最近的一个项目中，我使用[FancyUpload](http://digitarald.de/journal/54706744/fancyupload-for-flash-10/)来做到这一点。

# .net - 对 XmlDocument 中的节点进行排序的最佳方法是什么？（。网）

> ID：253644
> 
> 赞同：1
> 
> 时间：2008-10-31T14:12:01.613
> 
> 标签：.net, sorting, xmldocument

我使用 XSL 样式表进行排序，但它似乎很慢。有没有更有效的方法？

它是一个平面的节点列表，如果我将节点转换为对象并在 GenericList 中排序会有帮助吗？

**编辑**我不需要最终结果是 XML。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T14:15:44.583

根据我的经验，XSL 是更好的方法之一，但是，当您开始处理大型输入文件时，整体速度有点粗略。

你可以推出自己的排序，但老实说，我不认为它会更快。

我能想到的唯一其他可能的选择是加载到数据视图或其他东西中并在那里对其进行排序，然后返回到 XML，但这似乎是一种错误的方法。

**编辑**- 根据您添加的信息，是的，我很确定加载到列表中会更快......您需要尝试仔细检查，但如果您需要其他格式，您不妨。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T14:21:27.023

可能值得首先检查您没有使用低效的节点选择方式，例如 //node.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T15:43:55.157

使用 XslCompiledTransform 对 xsl 执行此操作，但请确保缓存 XslCompiledTransform，因为编译速度很慢，执行速度非常快。

所以：

1.  编写一个与您的 xml 匹配的 xsl，对它们进行排序并将排序列表作为输出
2.  从缓存中获取持有该 xsl 的 XslCompiledTransform，如果它不存在，则创建它并插入缓存
3.  通过 xsl 将 xml 转换为新的 XmlDocument

这非常快，保持你的代码干净并且在改变排序实现时你很灵活；它只是编辑一个 xsl。

我没有检查就输入了这个，所以可能有错字，但你应该这样做：

```
XslCompiledTransform xsl = (XslCompiledTransform)HttpRuntime.Cache.Get("my_xsl");
if (xsl == null)
{
  string fileName = "path/to/your/xslfile.xsl";
  xsl = new XslCompiledTransform();
  xsl.Load(fileName);  
  HttpRuntime.Cache.Insert("my_xsl", xsl, new CacheDependency(new string[]{fileName}));
} 
```

并转换使用这样的方法：

```
public static XmlNode TransformToXml(IXPathNavigable xml, XslCompiledTransform xsl, XsltArgumentList arguments, XmlWriterSettings settings)
{
  XmlDocument output = new XmlDocument();
  using (XmlWriter writer = XmlWriter.Create(output.CreateNavigator().AppendChild()))
  {
    xsl.Transform(xml, arguments, writer);
  }
  return output;
} 
```

# sql-server - 混淆 SQL Server Db 架构

> ID：253658
> 
> 赞同：0
> 
> 时间：2008-10-31T14:14:54.650
> 
> 标签：sql-server

在基于实际生产应用程序发布示例代码或提交错误报告时，有一些方法可以更改表和列名称，以免泄露有关应用程序内部的信息。在不破坏东西的情况下手工操作非常耗时。有什么自动存在的吗？理想情况下，它将使用真正的英语单词，因此它们比随机文本字符串更容易被引用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T14:22:08.783

只要您不使用真实数据，我就看不出问题出在哪里。根据要求，大多数应用程序都相当明显。即CRM系统=（客户名称，地址等......）或（客户名称，addressid等......带有一些地址表和部分地址等......）。通过了解您的架构，我不知道您如何实现您的应用程序。一般来说，如果没有存储过程/程序代码，就很难窃取任何知识产权。即使你是 NSA 什么的（InternetIP、PacketHeadingID、PacketDetailID、TimeStampID）。即使有了表格的结构，我仍然没有关于您的系统如何记录所有互联网流量的信息。我也不知道记录的任何内容。

我不知道有什么可以做你要求的事情，但我认为编写一个脚本来自己做是相当容易的。查看表列和数据类型并调用文本列“TextColumn1”、int 列“IntColumn2”等并构建替换表，然后在脚本文件中全局执行替换。我认为这是一个相当简单的 Python/Perl/PowerShell/Ruby/VbScript 程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T14:46:12.027

我同意没有真正需要这样做，但是如果您有这种感觉，请查看匿名器，通常用于保护数据而不是模式，但您也可以轻松地将这些方法应用于模式。

请参阅[本文](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.105.711&rep=rep1&type=pdf)（这是[该框架](http://flaim.ncsa.uiuc.edu/documentation.html)的描述），尤其是第 8 页及以后的不同匿名化方法，尽管用静态字符串替换列名可能就足够了。

# user-interface - 角色用户界面有未来吗？

> ID：253664
> 
> 赞同：9
> 
> 时间：2008-10-31T14:16:55.003
> 
> 标签：user-interface, chui

我们已经用 GUI 和 CHUI 构建了产品。展望未来，我们正在考虑重新设计我们的许多软件，主要是走全 GUI 的路线。我向小组提出的问题是，我们是否需要考虑让 CUI 留在身边？CUI 与 GUI 相比有什么优势？过去很多时候人们都说 CUI 更快，因为你不需要鼠标。我认为 GUI 可以与正确的键盘快捷键、热键和/或触摸屏一样快。

如果硬件不再提供约束，我们是否应该不再考虑 CUI？

另外澄清一下，当我谈到 CHUI 时，我指的是基于字符的用户界面，而且我还主要关注向最终用户有效呈现数据。

有一些很棒的回应强调了为自动化和基于脚本的任务提供基于命令行的界面的重要性，当我们开始设计时，我一定会牢记在心！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-10-31T14:20:45.417

你应该调查你的客户，而不是程序员。如果使用您的应用程序的客户想要一个 CHUI，即使您的所有开发人员都认为这是浪费时间，您也要构建它，因为客户总是正确的（除非他们错了）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-10-31T15:06:45.730

CHUI 的主要好处（即带有表单和字段的东西，不一定是命令行界面）是用于导航和一致布局的键盘。那是关键。

如果您的 GUI 可以完全有效地通过键盘导航，那么您的 CHUI 用户群应该会很高兴。这是因为及时，用户只是将他们的命令“输入”到系统中，而没有“看到界面”。他们不需要“发现”界面，这是 GUI 的主要特性。

虽然 CHUI 看起来像恐龙，但它们仍然可以正常工作和使用。大多数人一旦接受过培训（尤其是 POS/柜台工作人员，甚至是工厂或仓库等后台办公场景），使用 CHUI 都没有问题。

但关键是键盘支持，因此用户不必等待屏幕赶上他们。看到熟练的操作员精通键盘可以使应用程序飞起来。你几乎没有机会看到弹出窗口等等。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-10-31T14:20:03.953

你绝对应该考虑它。最重要的是，命令行程序可以比 GUI（通常）更容易自动化（并在脚本中链接在一起）。我无法想象使用没有命令行界面的源代码控制工具 - 尽管显然拥有 GUI 也很有用。

现在，如果不知道您的应用程序是做什么的，就很难说您是否需要特定应用程序的命令行版本。您需要自动化和脚本吗？可能有人想要 VPN 并从非常糟糕的连接中运行它，从而欣赏低带宽？

请注意，MS 当然不相信命令行已经死了——否则他们就不会创建 PowerShell。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-31T14:27:14.140

我同意 Eli 的观点，即您的客户应该拥有最终决定权，**但是**如果您可以防止程序的内容与 GUI（或 CHUI）过于交织，那么同时提供两者的生产成本应该是最低的。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-10-31T14:28:56.213

如果您为 unix 编写应用程序并且您需要处理通过 telnet / ssh 访问您的机器的用户，那么您将需要命令行界面。

我会说这取决于你的目标。您是否从其他应用程序编写代码？这将是保持交互式版本（或避免 GUI 启动的一部分）的要求。

我们通常做其中之一。但有时我们有必须通过 ftp 部署并运行 ssh 的实用程序。或者我们有我们的用户嵌入到他们的应用程序中并且不想暴露 UI（数据迁移/转换）的工具。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-10-31T15:26:59.510

时至今日，我见过的一些最高效的用户界面都是基于终端的普通字符界面。

轶事：我曾经参与过一个让 500 名客户服务代表使用的终端应用程序“现代化”的项目。我们发布了性感的 GUI 模型，包括用户在内的每个人都对它印象深刻。我们在应用程序上工作了六个月，所有的用户验收测试似乎都表明我们有一个赢家。

但是当应用程序最终启动时，它惨遭失败。事实证明，每天都会对 CSR 的绩效进行衡量，直至处理每个呼叫的平均秒数。而且无论他们如何努力，都无法在 GUI 中达到与终端界面相同的效率水平。他们可以通过标签和快捷方式接近，但不完全在那里。

惨痛的教训。现代程序员可能厌恶“恐龙”，但用户真的关心光滑的界面吗？通常他们只是想完成他们的工作。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-10-31T14:44:40.877

当我第一次读到这篇文章时，我的第一反应是，这可能是那些基本上是一系列表单但显示在终端内的应用程序之一。您经常会在收银机上看到这样的恐龙。我还记得我买车的时候看到过这样一个申请贷款的应用程序。这种类型的应用程序似乎在现代世界中没有一席之地——任何具有一点处理能力的系统现在都可以处理普通的 GUI。除非您尝试支持真正低端的旧客户，否则请摆脱此用户界面。具有良好键盘快捷键的 GUI（请，请，请考虑一下仅使用键盘的 GUI 程序......）对于来自旧 CUI 系统的用户来说同样有效，并且对那些习惯于使用的用户更友好一个图形用户界面，

我不明白为什么每个人都提出命令行应用程序。我认为大多数人都认识到命令行不会消失。对于许多任务来说，它比 GUI 快得多，主要是因为程序往往是非交互式的（因此很容易编写脚本）。一旦您的应用程序变为交互式（或者，至少没有参数使其成为非交互式），从命令行运行它就变得不那么重要了。甚至像 Vim 这样基于终端的出色程序也正在过渡到其图形对应程序 (gVim)，因为它为您提供了两全其美的优势。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-10-31T14:22:58.830

即使是像 Firefox 这样的 GUI 应用程序也可以从像[Ubiquity](http://wiki.mozilla.org/Labs/Ubiquity)这样的命令行界面中受益。如果有一种方法可以从 GUI 中提供命令行，那么为什么不能两全其美呢？

许多 CAD 程序都有命令行界面，可以向您显示刚刚执行的 GUI 交互在命令行中的含义。通过这种方式，您可以了解您经常做的事情的命令行操作，并且命令行可以更快地与惠斯特交互，同时仍然具有 GUI 界面的可发现性。

观看演示 ​​Rhino3D 命令行的[youtube 视频](http://www.youtube.com/watch?v=As0WUtBV3NQ)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-31T14:19:15.967

CHUI 的执行速度更快，而不是用户交互速度。我编写嵌入式系统（以及 GUI），因此我将始终使用命令行应用程序。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-10-31T15:44:30.677

我读过的每一项研究都表明，对于有经验的用户来说，CHUI 的速度要快得多。GUI 对于新用户和仅偶尔使用的应用程序来说更容易。同样对于给定的屏幕尺寸，您可以在 CHUI 上显示更多信息，而不是在 GUI 上。一个好的 GUI 可以让您一目了然地快速浏览。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-28T17:11:53.023

除了上面提到的其他好处之外，我经常发现另一个保留替代 UI 的理由——它让你和你的界面保持诚实。当应用程序仅使用一个用户界面构建时，让设计原则滑动变得容易得多，并且您的业务逻辑等和您的 GUI 成为一个交织在一起的意大利面条球——尽管有最好的意图。不管您的客户拥有命令行界面的重要性如何，很快就会有可能需要替代 GUI（阅读：表示层）的时候，并且您需要做好准备。这可能与您的要求无关，但我认为记住这一点很好......

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-08-07T02:38:02.650

我们遇到的一个大问题是多会话功能，这在我见过的 GUI 技术中几乎不存在。我们的用户很快指出，使用当前基于字符的界面，他们可以在他们的 PC 屏幕上同时进行十几个基于 Telnet 的终端会话，这使他们能够高效地进行多任务或任务切换。他们认为多任务处理是他们在我们快节奏的环境中受益匪浅的杀手级功能，中断频繁。能够同时访问特定 ERP 应用程序或多个不同 ERP 应用程序的多个实例，同时始终保持会话状态对我们的用户社区来说非常重要。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2010-01-04T20:20:50.840

我认为问题来自 GUI 表单中的设计实践。我们倾向于在它们上放置更多对象，尤其是具有垂直滚动条和选项卡功能的对象。这也使加载速度变慢。一旦您记住了这些序列并且不需要按住 Ctrl 键，使用键盘浏览 CHUI 菜单会更快。Windows 中的菜单栏有一些东西，其中快捷键描述位于右侧。一段时间后，基于字符的菜单似乎更容易记住。

```
A) - This Menu
B) - That Menu
C) - Some other Menu 
```

或者您可以通过箭头浏览选项，并且您似乎有一些肌肉记忆，其中该菜单是第二选择。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-10-31T15:10:28.233

一旦您提供一些数据，就会有人想要查询它。您可以将其与 gui 集成，没问题。如果您认为您的一些客户想要编写某些任务的脚本。设置它。任何与自动化有关的事情都最好从命令行完成（y harlo thar cron job！）

我喜欢吉斯。我是mac用户。但是 CLI 是有时间和地点的。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-11-15T15:40:44.720

当注册系统从使用 telnet 的基于字符的系统转变为 PeopleSoft 应用程序上的 gui 系统时，我是一所大学数学系的系统管理员。

前台的女士们讨厌新系统。现在，其中一部分是关于旧鞋更舒适的全部内容。但是当我问起这件事时，克里斯汀说，即使经过一周每天进行数百次注册，新系统也需要数倍的时间才能完成任何事情。很多事情只能用鼠标完成。旧系统可以尽可能快地接受输入。屏幕重绘不到十分之一秒。新系统有很多 3/4 到 2 秒的停顿——只是长到让人讨厌，长到不能做任何其他事情。

# oslo - Oslo 错误“M0197：‘文本’不能在类型上下文中使用”的解释？

> ID：253666
> 
> 赞同：0
> 
> 时间：2008-10-31T14:17:04.300
> 
> 标签：oslo, m

在 Microsoft Oslo SDK CTP 2008（使用 Intellipad）中，以下代码编译良好：

```
module M {
    type T {
        Text : Text;
    }
} 
```

在编译以下代码时会导致错误“M0197：'Text' cannot be used in a Type context”

```
module M {
    type T {
        Text : Text;
        Value : Text; // error
    } 
} 
```

我看不出示例之间的区别，因为在第一种情况下 Text 也用于 Type 上下文。

更新：

为了增加混乱，请考虑以下示例，该示例也可以正常编译：

```
module M {
    type X;
    type T {
      X : X;
      Y : X;
    } 
} 
```

M 语言规范指出：

> 字段声明覆盖词法范围以防止声明类型绑定到声明本身。字段声明的归属类型不能是声明本身；但是，该声明可以在约束中使用。考虑以下示例：
> 
> A型；类型 B { A : A; }
> 
> 字段声明 A 的类型归属的词法封闭范围是实体声明 B。无一例外，类型归属 A 将绑定到循环引用中的字段声明，这是一个错误。在这种情况下，异常允许词法查找跳过字段声明。

似乎用户定义的类型和内置（内在）类型不被平等对待。

更新2：

请注意，上面示例中的*Value*不是保留关键字。如果将*Value*重命名为*Y* ，则会产生相同的错误。

有任何想法吗？

问候，坦伯格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T14:41:38.590

从我所看到的你已经重新定义`Text`：

```
Text : Text 
```

然后您尝试将其用于 Value 的类型：

```
Value : Text 
```

这是不允许的。为什么使用类型名称作为属性会重新定义我不完全清楚的类型（仍在阅读 M 语言规范），但我确信这是有充分理由的。只需命名`Text`尚未定义的类型（用括号 ( `[Text]`) 转义它也不起作用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T21:01:06.840

[http://social.msdn.microsoft.com/Forums/en-US/oslo/thread/fcaf10a1-52f9-4ab7-bef5-1ad9f9112948](http://social.msdn.microsoft.com/Forums/en-US/oslo/thread/fcaf10a1-52f9-4ab7-bef5-1ad9f9112948)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-31T19:23:00.763

这就是问题所在：在 M 中，您可以执行以下操作：

```
module M
{
  type Address;
  type Person
  {
    Addresses : Address*;
    FavoriteAddress : Address where value in Addresses;
  }  
} 
```

在该示例中，“地址”指的是 Person.Addresses。那么，问题是当你写一些无害的东西时

```
module M
{
  type T
  {
    Text : Text;
    SomethingElse : Text;
  }
} 
```

...那么SomethingElse的类型描述中的“Text”不是指Language.Text，而是指T.Text。这就是问题所在。解决方法是这样写：

```
module M
{
  type T
  {
    Text : Text;
    SomethingElse : Language.Text;
  }
} 
```

（你可能想知道为什么像“Text : Text”这样的东西在上面的例子中起作用。有一个特殊的规则：字段类型归属中的标识符不能引用字段本身。典型的例子是“Address : Address”。）

# security - ASP Classic 中密码的推荐哈希值

> ID：253673
> 
> 赞同：4
> 
> 时间：2008-10-31T14:19:16.277
> 
> 标签：security, asp-classic, hash

ASP Classic 中最慢（因此最好）的密码哈希算法是什么？

编辑：对于那些不知道的人，在散列密码时，较慢的散列比更快的散列更能帮助减缓彩虹表样式的攻击。

EDIT2：是的，当然速度不是哈希选择的唯一有效问题。我的问题假设在**所有其他条件相同的情况下**，在散列密码时[首选最慢的散列方法。](http://www.securityfocus.com/blogs/262)虽然碰撞/逆向工程当然也是一个问题，但我在这个问题中优先考虑速度，因为它可以说是比较流行的哈希算法用于密码时要考虑的最关键因素。

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-31T14:37:27.287

很多人似乎都在质疑提问者，因为他正在寻找一个缓慢的哈希函数。实际上，在所有其他方面相同的情况下，较慢的散列函数比快的散列函数更安全。这是因为较慢的散列函数会导致**彩虹表的生成**速度较慢，并对**密码进行较慢的暴力破解或字典攻击**。

[来自http://www.securityfocus.com/blogs/262](http://www.securityfocus.com/blogs/262)上的Thomas Ptacek，在此[Coding Horror 文章](http://www.codinghorror.com/blog/archives/000953.html)中引用：

> 问题是**MD5 速度很快。它的现代竞争对手也是如此，例如 SHA1 和 SHA256**。速度是现代安全散列的设计目标，因为散列是几乎每个密码系统的构建块，并且通常在每个数据包或每个消息的基础上按需执行。
> 
> **速度正是您在密码哈希函数中不想要的。**
> 
> 现代密码方案受到增量密码破解程序的攻击。
> 
> 增量破解者不会预先计算所有可能的破解密码。他们单独考虑每个密码散列，并通过密码散列函数提供字典，就像您的 PHP 登录页面一样。像 Ophcrack 这样的彩虹表破解器使用空间来攻击密码；像 John the Ripper、Crack 和 LC5 这样的增量破解者使用时间：统计和计算。
> 
> 密码攻击游戏以破解密码 X 的时间计分。对于彩虹表，该时间取决于您的表需要多大以及搜索速度有多快。使用增量破解程序，时间取决于您可以使密码哈希函数运行多快。
> 
> 你可以更好地优化你的密码哈希函数，你的密码哈希函数得到的越快，你的方案就越弱。MD5 和 SHA1，甚至像 DES 这样的传统分组密码，都被设计成速度很快。MD5、SHA1 和 DES 是弱密码哈希。在现代 CPU 上，像 DES 和 MD5 这样的原始加密构建块可以进行位切片、矢量化和并行化，以使密码搜索速度快如闪电。Game-over FPGA 实施仅需数百美元。

PHP MD5 文档的一些[评论](http://php.oregonstate.edu/manual/en/function.hash.php)也讨论了对慢的偏好。

要回答您的问题，BCrypt 似乎是要走的路。但是，我还没有找到 ASP Classic 的任何实现。如果这是真的，我会坚持使用像 SHA512 这样的常规哈希函数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-10-31T14:32:13.477

我会忽略慢的部分，而是选择“好”的部分。

我建议您使用带有盐的 SHA-512 来击败字典和彩虹表攻击。我不相信 SHA-512 存在任何已知漏洞。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T14:29:15.010

如果您试图击败蛮力攻击，您最好强制执行一些失败的尝试窗口/计数，而不是依靠散列（或散列比较）机制的速度来使攻击需要更长的时间才能成功。在失败窗口内尝试一定次数的失败后锁定帐户，并且仅在经过大量时间后才允许进行新的尝试。

这可能会使您面临针对知名（管理）帐户的 DOS 攻击，但您可以将某些帐户从锁定策略中排除，或者使用另一种方法（使用安全问题/答案）登录到锁定的帐户重置期过去之前的帐户。

[编辑]为了帮助击败彩虹攻击——攻击者已经检索了你的散列密码并找到散列到相同值的合适匹配项——考虑使用每个用户的散列密码唯一的随机盐和作为一部分的固定盐算法，而不是数据。例如：

```
 testHash = computeHash( user.salt + "98hloj5674" + password );
  if (testHash == user.hashedPassword)
  {
      valid = true;
  } 
```

这应该使彩虹表无效，因为即使知道用户的盐和散列算法，攻击者彩虹表中的值也不会映射到您的散列密码，因为在算法中添加了固定盐。

使用 ASP Classic，您必须在库中而不是在页面上执行此操作，以确保用户看不到您的固定盐。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-21T00:37:36.157

```
Dim sPassword, sSalt
sPassword = "Lorem"
sSalt = "Ipsum"
With CreateObject("CAPICOM.HashedData")
  .Algorithm = 0 ' CAPICOM_HASH_ALGORITHM_SHA1
  .Hash sPassword & sSalt
  Response.Write "Here is your hash: " & .Value
End With 
```

[Capicom 文档](http://msdn.microsoft.com/en-us/library/aa382440(VS.85).aspx)

算法是以下任何一种：

```
CAPICOM_HASH_ALGORITHM_SHA1      = 0
CAPICOM_HASH_ALGORITHM_MD2       = 1
CAPICOM_HASH_ALGORITHM_MD4       = 2
CAPICOM_HASH_ALGORITHM_MD5       = 3
CAPICOM_HASH_ALGORITHM_SHA_256   = 4 - Not supported on Windows XP or 2000
CAPICOM_HASH_ALGORITHM_SHA_384   = 5 - Not supported on Windows XP or 2000
CAPICOM_HASH_ALGORITHM_SHA_512   = 6 - Not supported on Windows XP or 2000 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T22:57:20.227

我个人更喜欢[Whirlpool 算法](http://en.wikipedia.org/wiki/Whirlpool_(cryptography))来满足我所有的散列需求。它产生一个 512 位的输出，因此具有与 SHA-512 相同的空间要求。遗憾的是，我不能权威地谈论一个是否比另一个更安全，但在这个第三版的 Whirlpool 中似乎没有任何明显的弱点。

参考实现在公共领域，这很好，因为我很少发现它在各种工具和语言中默认实现。

（如果有人知道为什么 SHA 比 Whirlpool 更受青睐，请告诉我。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T14:31:56.767

实际上，最好的散列函数是不产生碰撞并且不会被彩虹表攻击怀疑的散列函数。

这意味着：添加一个 Salt（最好为每个用户使用不同的 Salt），并考虑使用 SHA2 哈希函数（或者可能是 RIPE-MD，我没看过那么多）：

SHA-256 的一种实现在这里（我喜欢他们称之为“单向加密”）：
[http ://www.freevbcode.com/ShowCode.Asp?ID=2565](http://www.freevbcode.com/ShowCode.Asp?ID=2565)

虽然还没有测试过，但是经典 ASP 肯定有 SHA2 实现。

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2008-10-31T14:27:45.433

最慢方法的伪代码：

```
function hashPassword(password)
    sleep for 10 seconds
    return password
end function 
```

这当然不是最安全的（或根本不是），但它很慢......

（我只是指出让它变慢不是答案......）

# jquery - 使用 jQuery 切换 DIV 背景图像

> ID：253689
> 
> 赞同：210
> 
> 时间：2008-10-31T14:23:37.050
> 
> 标签：jquery

我正在为我工​​作的公司制作展开/折叠通话费率表。我目前有一个表格，下面有一个按钮来展开它，按钮上写着“展开”。它是功能性的，只是我需要在单击时将按钮更改为“折叠”，然后在再次单击时返回到“展开”。按钮上的文字是背景图像。

所以基本上我只需要在单击 div 时更改它的背景图像，除了有点像切换。

* * *

## 回答 #1

> 赞同：454
> 
> 时间：2008-10-31T14:31:48.797

```
$('#divID').css("background-image", "url(/myimage.jpg)"); 
```

应该做到这一点，只需将其连接到元素上的单击事件中

```
$('#divID').click(function()
{
  // do my image switching logic here.
}); 
```

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2010-09-27T23:12:11.780

我个人只会使用 JavaScript 代码在 2 个类之间切换。

让 CSS 勾勒出您在 div 上减去背景规则所需的所有内容，然后添加两个类（例如：展开和折叠）作为规则，每个类都具有正确的背景图像（或如果使用精灵，则为背景位置）。

**具有不同图像的 CSS**

```
.div {
    /* button size etc properties */
}

.expanded {background: url(img/x.gif) no-repeat left top;}
.collapsed {background: url(img/y.gif) no-repeat left top;} 
```

或**带有图像精灵的 CSS**

```
.div {
    background: url(img/sprite.gif) no-repeat left top;
    /* Other styles */
}

.expanded {background-position: left bottom;} 
```

然后...

**带有图像的 JavaScript 代码**

```
$(function){
    $('#button').click(function(){
        if($(this).hasClass('expanded'))
        {
            $(this).addClass('collapsed').removeClass('expanded');
        }
        else
        {
            $(this).addClass('expanded').removeClass('collapsed');
        }
    });
} 
```

**带有精灵的 JavaScript**

*注意：优雅的 toggleClass 在 Internet Explorer 6 中不起作用，但下面的`addClass`/`removeClass`方法在这种情况下也可以正常工作*

*最优雅的解决方案（不幸的是，它对 Internet Explorer 6 不友好）*

```
$(function){
        $('#button').click(function(){
            $(this).toggleClass('expanded');
        });
    }

$(function){
        $('#button').click(function(){
            if($(this).hasClass('expanded'))
            {
                $(this).removeClass('expanded');
            }
            else
            {
                $(this).addClass('expanded');
            }
        });
    } 
```

据我所知，这种方法可以跨浏览器工作，而且我会觉得使用 CSS 和类比使用脚本中的 URL 更改更舒服。

* * *

## 回答 #3

> 赞同：47
> 
> 时间：2011-02-07T00:39:21.017

使用 jQuery 更改背景图像 CSS 有两种不同的方法。

1.  `$('selector').css('backgroundImage','url(images/example.jpg)');`
2.  `$('selector').css({'background-image':'url(images/example.jpg)'});`

仔细观察以注意差异。第二种，您可以使用常规 CSS 并将多个 CSS 属性串在一起。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2008-10-31T14:32:54.503

如果您对背景图像使用 CSS 精灵，则可以根据您是展开还是折叠来增加背景偏移量 +/- *n像素。*不是切换，但比切换背景图像 URL 更接近它。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2012-01-11T22:30:08.473

这是我的做法：

CSS

```
#button{
   background-image: url("initial_image.png");
}

#button.toggled{
  background-image:url("toggled_image.png");
} 
```

JS

```
$('#button').click(function(){
  $('#my_content').toggle();
  $(this).toggleClass('toggled');
}); 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-10-31T14:32:48.607

一种方法是将两个图像放在 HTML 中，在 SPAN 或 DIV 中，您可以使用 CSS 或在页面加载时使用 JS 隐藏默认值。然后你可以点击切换。这是我用来将左/下图标放在列表中的类似示例：

```
$(document).ready(function(){
    $(".button").click(function () {
        $(this).children(".arrow").toggle();
            return false;
    });
});

<a href="#" class="button">
    <span class="arrow">
        <img src="/images/icons/left.png" alt="+" />
    </span>
    <span class="arrow" style="display: none;">
        <img src="/images/down.png" alt="-" />
    </span>
</a> 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2016-07-06T09:31:08.817

我的是动画的：

```
$(this).animate({
    opacity: 0
}, 100, function() {
    // Callback
    $(this).css("background-image", "url(" + new_img + ")").promise().done(function(){
        // Callback of the callback :)
        $(this).animate({
            opacity: 1
        }, 600)
    });    
}); 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-03-28T14:15:44.090

我使用正则表达式完成了我的工作，因为我想保留相对路径而不是使用添加 addClass 函数。我只是想让它复杂，大声笑。

```
$(".travelinfo-btn").click(
            function() {
                $("html, body").animate({scrollTop: $(this).offset().top}, 200);
                var bgImg = $(this).css('background-image')
                var bgPath = bgImg.substr(0, bgImg.lastIndexOf('/')+1)
                if(bgImg.match(/collapse/)) {
                    $(this).stop().css('background-image', bgImg.replace(/collapse/,'expand'));
                    $(this).next(".travelinfo-item").stop().slideToggle(400);
                } else {
                    $(this).stop().css('background-image', bgImg.replace(/expand/,'collapse'));
                    $(this).next(".travelinfo-item").stop().slideToggle(400);
                }
            }
        ); 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-10-31T14:33:57.793

这适用于 WinXP 上的所有当前浏览器。基本上只是检查当前背景图像是什么。如果是image1，则显示image2，否则显示image1。

jsapi 只是从 Google CDN 加载 jQuery（更容易在桌面上测试 misc 文件）。

替换是为了跨浏览器的兼容性（opera 和 ie 添加引号到 url 和 firefox、chrome 和 safari 删除引号）。

```
<html>
    <head>
        <script src="http://www.google.com/jsapi"></script>
        <script>
          google.load("jquery", "1.2.6");
          google.setOnLoadCallback(function() {
            var original_image = 'url(http://stackoverflow.com/Content/img/wmd/link.png)';
            var second_image = 'url(http://stackoverflow.com/Content/img/wmd/code.png)';

            $('.mydiv').click(function() {
                if ($(this).css('background-image').replace(/"/g, '') == original_image) {
                    $(this).css('background-image', second_image);
                } else {
                    $(this).css('background-image', original_image);
                }

                return false;
            });
          });
        </script>

        <style>
            .mydiv {
                background-image: url('http://stackoverflow.com/Content/img/wmd/link.png');
                width: 100px;
                height: 100px;
            }
        </style>
    </head>
    <body>
        <div class="mydiv">&nbsp;</div>
    </body>
</html> 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-06-19T14:18:47.783

旧帖子，但这将允许您使用图像精灵并通过使用 css 属性的简写（背景、重复、左上角）来调整重复和定位。

```
$.each($('.smallPreview'), function(i){
  var $this = $(this);

  $this.mouseenter(function(){
    $this.css('background', 'url(Assets/imgs/imgBckg-Small_Over.png) no-repeat 0 0');
  });

  $this.mouseleave(function(){
    $this.css('background', 'url(Assets/imgs/imgBckg-Small.png) no-repeat 0 0');
  });

}); 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2012-03-05T19:06:50.613

CSS Sprite 效果最好。我尝试使用 jQuery 切换类并操作“背景图像”属性，但没有任何效果。我认为这是因为浏览器（至少是最新的稳定版 Chrome）无法“重新加载”已经加载的图像。

奖励：CSS Sprite 下载速度更快，显示速度更快。更少的 HTTP 请求意味着更快的页面加载。减少 HTTP 的数量是提高前端性能的**最好方法，所以我建议一直走这条路线。**

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-03-24T15:43:47.837

我在论坛*[Toggle Background Img](http://www.dynamicdrive.com/forums/showthread.php?t=5967&page=2)*中找到了解决方案。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2012-05-15T00:47:21.480

这是一个相当简单的响应，通过项目列表更改站点的背景

```
function randomToN(maxVal) {
    var randVal = Math.random() * maxVal;
    return typeof 0 == 'undefined' ? Math.round(randVal) : randVal.toFixed(0);
};
var list = [ "IMG0.EXT", "IMG2.EXT","IMG3.EXT" ], // Images
    ram = list[parseFloat(randomToN(list.length))], // Random 1 to n
    img = ram == undefined || ram == null ? list[0] : ram; // Detect null
$("div#ID").css("backgroundImage", "url(" + img + ")"); // push de background 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2019-11-25T11:12:24.523

我也总是使用时间戳来防止浏览器缓存图像。例如，如果用户正在旋转他们的头像，它通常会被缓存并且看起来不会改变。

```
var d = new Date();
var t = d.getTime();

$('#avatar').css("background-image", "url(" + iPath + "?" + t + ")"); 
```

# c# - 创建派生控件

> ID：253691
> 
> 赞同：1
> 
> 时间：2008-10-31T14:25:26.767
> 
> 标签：c#, .net-3.5, inheritance

我有一个抽象基类，它继承自然`UserControl`后用于派生许多类。

我遇到的问题是如何优雅地确保`InitializeComponent()`为每一层类调用生成的函数。

因此（抽象）基类上有许多控件，这些控件将为所有子类共享。创建子类的实例时，首先调用基构造函数，但是有什么方法可以优雅地调用派生`InitializeComponent()`，而不必为每个派生类有效地构建相同的构造函数

```
public DerivedClass() { 
  InitializeComponent();
} 
```

我想知道是否有比在每个派生类中重复自己更有效的方法？

实际上，我希望（抽象）基类能够调用

```
Derived.InitializeComponent(); 
```

毕竟，当它在基本构造函数中（在调试中）时，它知道它是一个派生实例......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T14:37:17.757

公共 DerivedClass() : base() {}

这将调用您的基本构造函数，通常没有神奇的方法来做事，如果您需要调用 InitializeComponents，您可能必须自己调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T14:42:58.477

如果您将 InitializeComponent 设为虚拟，并为所有子类覆盖它，则如果您从派生构造函数调用基构造函数，则基类将为每个子类调用正确的方法。

# java - Eclipse 中的 WebLogic 插件

> ID：253692
> 
> 赞同：4
> 
> 时间：2008-10-31T14:26:17.107
> 
> 标签：java, eclipse, eclipse-plugin, weblogic

我正在尝试在 Eclipse 中启动 WebLogic

当它启动时，它会像这样抱怨。

无法加载性能包。改为使用 Java I/O。请确保 wlntio.dll 位于：'C:\bea81\jdk142_04\bin;.;C:\WINDOWS\system32;C:\WINDOWS;C:\bea81\jdk142_04\jre\bin;C:\Program Files\ Java\jre1.6.0\bin\client;C:\Program Files\Java\jre1.6.0\bin;C:\sybase\JS-12_5\bin;C:\sybase\OCS-12_5\lib3p;C:\sybase \OCS-12_5\dll;C:\sybase\OCS-12_5\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\Program Files\Common Files\Roxio Shared \DLLShared\;C:\Program Files\Common Files\Roxio Shared\DLLShared\;C:\Program Files\Common Files\Roxio Shared\9.0\DLLShared\;C:\Program Files\cvsnt;C:\Program Files\执行软件\DiskeeperWorkstation\;'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T15:05:46.480

确保 wlintio.dll 在路径中。位置可能因 Weblogic 版本而异；在 9.2 中，它位于 $BEA_HOME/server/native/win/32

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-24T00:29:41.297

添加`$BEA_HOME/server/bin`到您的`PATH`. 这应该可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-08T17:07:13.177

性能包不是运行 WebLogic 服务器所必需的，因此您可以放心地忽略此警告。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T15:19:44.613

我在 $BEA_HOME/server 下看不到本机文件夹

我可以在 $BEA_HOME/server/bin 下看到 wlintio.dll

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-28T15:50:35.777

能够在 IDE 中运行 WebLogic 是 IntelliJ 内置的。它开箱即用 - 没有混乱，没有大惊小怪。

# asp-classic - 如何在运行时更改 asp 响应 Content-Type

> ID：253694
> 
> 赞同：0
> 
> 时间：2008-10-31T14:26:31.443
> 
> 标签：asp-classic, mime-types

我有 java web 服务，返回一个包含几个变量数据的对象，这个 web 服务在 ASP 代码中被调用，但是 asp 代码总是得到 Mime 类型是“text/plain”。即使我确实设置了下面的 Response.ContentType = "application/xml" 并且没有解析 Web 服务结果并且在 loadXML 处错误输出类型不匹配。有人可以建议如何在运行时更改 ASP 代码中的 mime 类型吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T14:32:48.543

听起来您的 Java Web 服务将 text/plain 作为内容类型返回。

更改 ASP 内容类型对此没有任何影响，因为这与 ASP 页面显示的内容类型有关。

# silverlight - Silverlight Datagrid 上 UpdateSourceTrigger LostFocus 的解决方法？

> ID：253695
> 
> 赞同：5
> 
> 时间：2008-10-31T14:27:00.380
> 
> 标签：silverlight, datagrid, updatesourcetrigger

我有一个验证数据 OnTabSelectionChanged 的​​ Silverlight 2 应用程序。我立即开始希望 UpdateSourceTrigger 允许的不仅仅是 LostFocus，因为如果您单击选项卡而不关闭控件，则 LINQ 对象在验证之前不会更新。

我通过将焦点设置到另一个控件然后返回 OnTextChanged 来解决 TextBoxes 的问题：

```
Private Sub OnTextChanged(ByVal sender As Object, ByVal e As TextChangedEventArgs)
    txtSetFocus.Focus()
    sender.Focus()
End Sub 
```

现在我正在尝试在 DataGrid 中完成相同类型的 hack。我的 DataGrid 使用在运行时为 CellTemplate 和 CellEditingTemplate 生成的 DataTemplate。我尝试将 TextChanged="OnTextChanged" 写入 DataTemplate 中的 TextBox，但它没有被触发。

有人有想法么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-07-14T23:22:11.067

[您也可以使用应用于文本框的行为来做到这一点](http://blog.mustoverride.com/2010/01/silverlight-updatesourcetrigger.html?showComment=1279149377285_AIe9_BFLaR4pbpg_swaitgIUU0PR-hQVluTHi6P3siH156dRQIYsaNKVxx_ptreNpwv-HaozS_tab7wC55uFRxgzpOU22HtkC6-Cz2DwtrHdnmZZ5dn0sOwczJ_MpPg5K5LsT24F6GdNHZyI9LYI4kQQaU0V7rtwuIkU1AsYxATywIYpt_ZIRS5lh4WjahPQqu4-c9TBPqHvJN0zQAQGAUsCeuIa0h_HR-rE7iUy4ajM3zzOACX3B9D3tQBXhLrGf0q0mG67thiUcZZqgvzr2eNENemhQpWLX_5Kky7Nj2WDwQcOxIDsYlWz6WTjVu8_UPVFuSTVJjmGajc9rEGDX7Xcq1ZwzVXhRTMCTw_IGXWYm_pp0in0V5G5LEwKViKkNLgFWL3BazgXZQjtFsnFT4Y2-K5FxMGIGmufAAo5uwMM1Q3GLbXwlhwAAcxz3Gar6Z-olH7ylmobDKmCKNedO2zb0ctdkPQZe7U2yYRg5OY-cI3PQtygpkQpjG6ap9yvUIf6Gpd6HErk8Q6OFy4AlpXqiiIriABLE-E1b-e9w44l1T_FQhGLEtiJD4bvY2VZXx5Pe1_0EISdX_PNPcN1E3a5iOmq7CppTkmY64gar1XZtWZ7xdZ18WldNXG3LDFEInWlUiSngpJdBqv0wT81_-RwxJuGY8Faq2iOATzih4274u1bJa73-HWzcepR9G5nl33NBWNCOWZbuW_Q8heTU6ea02X3D-E767OCxHTBi_NB7pRDyAq_stQiFPTD3H--g-DWrhVaI44PXBia88huy4-b1PIEyUzatDm747Hyw9ilRsQPH9RgUbuKocnTBbssmuhq8hK4vErFspeh-nEIHLVvyTxNs-YWhHKBpgY27k5bLZU1fSdyudw#c8238632009983091264)

```
// xmlns:int is System.Windows.Interactivity from System.Windows.Interactivity.DLL)
// xmlns:behavior is your namespace for the class below
<TextBox Text="{Binding Description,Mode=TwoWay,UpdateSourceTrigger=Explicit}">
    <int:Interaction.Behaviors>
       <behavior:TextBoxUpdatesTextBindingOnPropertyChanged />
    </int:Interaction.Behaviors>
</TextBox>

public class TextBoxUpdatesTextBindingOnPropertyChanged : Behavior<TextBox>
{
    protected override void OnAttached()
    {
        base.OnAttached();

        AssociatedObject.TextChanged += new TextChangedEventHandler(TextBox_TextChanged);
    }

    protected override void OnDetaching()
    {
        base.OnDetaching();

        AssociatedObject.TextChanged -= TextBox_TextChanged;
    }

    void TextBox_TextChanged(object sender, TextChangedEventArgs e)
    {
        var bindingExpression = AssociatedObject.GetBindingExpression(TextBox.TextProperty);
        bindingExpression.UpdateSource();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-05-25T20:24:00.060

这篇博文展示了如何使用附加属性显式更新文本框的源： [http ://www.thomasclaudiushuber.com/blog/2009/07/17/here-it-is-the-updatesourcetrigger-for-propertychanged-in -银光/](http://www.thomasclaudiushuber.com/blog/2009/07/17/here-it-is-the-updatesourcetrigger-for-propertychanged-in-silverlight/)

您可以轻松修改它以与其他控件一起使用......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-19T23:00:19.303

我在使用 MVVM 和 Silverlight 4 时遇到了同样的问题。问题是在文本框失去焦点之前绑定不会更新源，但是将焦点设置在另一个控件上并不能解决问题。

我找到了一个结合使用两篇不同博客文章的解决方案。我使用了 Patrick Cauldwell 的 DefaultButtonHub 概念中的代码，以及来自 SmallWorkarounds.net 的一个“SmallWorkaround”

[http://www.cauldwell.net/patrick/blog/DefaultButtonSemanticsInSilverlightRevisited.aspx](http://www.cauldwell.net/patrick/blog/DefaultButtonSemanticsInSilverlightRevisited.aspx)

www.smallworkarounds.net/2010/02/elementbindingbinding-modes.html

我的更改导致 DefaultButtonHub 类的以下代码：

```
public class DefaultButtonHub
{
    ButtonAutomationPeer peer = null;

    private void Attach(DependencyObject source)
    {
        if (source is Button)
        {
            peer = new ButtonAutomationPeer(source as Button);
        }
        else if (source is TextBox)
        {
            TextBox tb = source as TextBox;
            tb.KeyUp += OnKeyUp;
        }
        else if (source is PasswordBox)
        {
            PasswordBox pb = source as PasswordBox;
            pb.KeyUp += OnKeyUp;
        }
    }

    private void OnKeyUp(object sender, KeyEventArgs arg)
    {
        if (arg.Key == Key.Enter)
            if (peer != null)
            {
                if (sender is TextBox)
                {
                    TextBox t = (TextBox)sender;
                    BindingExpression expression = t.GetBindingExpression(TextBox.TextProperty);
                    expression.UpdateSource();
                }
                ((IInvokeProvider)peer).Invoke();
            }
    }

    public static DefaultButtonHub GetDefaultHub(DependencyObject obj)
    {
        return (DefaultButtonHub)obj.GetValue(DefaultHubProperty);
    }

    public static void SetDefaultHub(DependencyObject obj, DefaultButtonHub value)
    {
        obj.SetValue(DefaultHubProperty, value);
    }

    // Using a DependencyProperty as the backing store for DefaultHub.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty DefaultHubProperty =
        DependencyProperty.RegisterAttached("DefaultHub", typeof(DefaultButtonHub), typeof(DefaultButtonHub), new PropertyMetadata(OnHubAttach));

    private static void OnHubAttach(DependencyObject source, DependencyPropertyChangedEventArgs prop)
    {
        DefaultButtonHub hub = prop.NewValue as DefaultButtonHub;
        hub.Attach(source);
    }

} 
```

这应该包含在 Silverlight 的某种文档中:)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-10-31T17:11:28.117

我知道这是旧消息......但我通过这样做解决了这个问题：

Text="{绑定路径=newQuantity, UpdateSourceTrigger=PropertyChanged}"

# .net - 在 ASP.NET 中存储以前的搜索条件的最佳方式

> ID：253701
> 
> 赞同：0
> 
> 时间：2008-10-31T14:28:58.537
> 
> 标签：.net, asp.net, vb.net

我有一个 Web 应用程序，它允许用户根据某些条件进行搜索、选择一个对象、对其进行编辑，然后返回到之前的搜索。所有的编辑都在一个单独的页面上进行，该页面链接到返回结果的数据网格。我想知道存储先前搜索参数的最佳方法是什么，以便当它们返回网格时，它们具有与先前使用的相同的搜索。我想出的最佳选择是使用每个选定参数的 NameValue 集合，并在用户按下搜索按钮时将其存储到 Session 或 cookie 中。关于解决此问题的更好方法的任何其他想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T16:03:43.867

如果它是一个通用查询（所有用户通用），您可能希望缓存结果并在返回网格时简单地绑定到缓存的结果。它将为您节省再次拨打电话的处理和带宽费用。

如果它是特定于用户的查询并且您拥有资源，则可能需要缓存结果。

如果它是特定于用户的查询并且您没有资源，那么缓存参数（就像您提到的那样）可能是最好的选择。

提出一个健壮的缓存方案可能很棘手。查看[memcached](http://en.wikipedia.org/wiki/Memcached)以了解其他人如何解决它（注意[ASP.NET Memcached Providers](http://www.codeplex.com/memcachedproviders)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T15:05:54.703

在我们的应用程序中，我们有几十个带有搜索字段的列表。我们设计了一个简单的实用程序类，它根据当前 Page 生成一个唯一的字符串并将其存储在会话中。

```
 public static string GenerateSessionKeyFromPage(Page page)
    {
        return "__" + page.Request.Path;
    } 
```

这允许我们存储搜索字段，而不必在每次添加新页面时维护 NameValue 集合。

# sql-server - 在 SQL 2005/2008 管理工作室中，如何让“摘要”选项卡可见？

> ID：253704
> 
> 赞同：0
> 
> 时间：2008-10-31T14:29:25.587
> 
> 标签：sql-server, settings, ssms

在 SQL 2005/2008 管理工作室中，如何让“摘要”选项卡可见？

我错误地关闭它并想再次打开它......有什么办法不重新启动它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T14:41:34.517

在 SQL Server 2005 Management Studio 中：
查看菜单 -> 摘要（或 F7）

在 SQL Server 2008 Management Studio 中：
查看菜单 -> 对象资源管理器详细信息（或 F7）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T14:35:01.643

窗口菜单 --> 重置窗口布局

尽管它或多或少是一个无用的窗口。对象浏览器更有用。

# javascript - 持久化数据客户端以查找 ASP.NET 中的下拉列表

> ID：253705
> 
> 赞同：0
> 
> 时间：2008-10-31T14:30:35.787
> 
> 标签：javascript, drop-down-menu, lookup

我有一个存储名称/值对的下拉列表。下拉菜单出现在 gridview 的每一行中。

下拉列表中的值对应于下拉列表中未保留的第三个属性（数据类型）。我想创建一个客户端“查找”表，以便当用户选择下拉值时，正确的数据类型会填充在它旁边。

在 ASP.NET 应用程序中完成此任务的最佳方法是什么？价值/属性列表的范围可能从 1 到 100 个成员在列表中......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T21:31:15.547

在 snipplr.com ( [http://tinyurl.com/67rzav](http://tinyurl.com/67rzav) )找到了一个不错的解决方案

函数调用看起来像这样：

```
var profileHeaders = new AArray(); 

profileHeaders .add("k01", "hi");
profileHeaders .add("k02", "ho");

var oC = profileHeaders .get("k02");

alert(oC); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T14:32:40.150

如果您希望它全部在客户端运行，那么您唯一的选择可能是 JavaScript。

```
var oVals = new Array('1','2','3','4','5');

document.getElementById("cell1").innerHTML = oVals[document.getElementById("dropdown1").selectedIndex]; 
```

# c++ - 奇怪的#include问题

> ID：253720
> 
> 赞同：0
> 
> 时间：2008-10-31T14:33:19.777
> 
> 标签：c++, dll, include, visual-c++-6

我对一个简单的包含文件有疑问。

包含的文件位于两个 MFC 程序中 - 其中一个是 dll，它还将自身编译为非 mfc dll。

最近，当我想访问较大 dll 未公开的原始代码的某些功能时，我使用了较大的 dll，它包裹了较小 dll 的*源代码。*

由于这是一个测试，我只是将源代码添加到我的项目中并调用函数。我收到此错误：**语法错误：在 ';' 之前缺少 ')'**

该文件已正确包含，并且我在源文件夹和项目中都有 .cpp 和 .h ，但它不会编译。

我最终创建了一个非常小的测试项目，main.cpp、spooler.cpp 和 spooler.h（spooler 是 comms 的包装器）并尝试编译它。同样的问题。

因此，我删除了所有与 dll 相关的东西，以防万一出现奇怪的问题并且它仍然无法编译。

我想不出我的生活有什么问题。还有其他人有什么想法吗？

ps Jeff，您确实需要添加附加文件的功能，因为源会用数据填满太多屏幕。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-31T15:33:43.600

使用 /P 选项构建，这将创建一个预处理文件（通常带有 .i 扩展名）。

在 Visual Studio 中，该选项将位于项目的属性上，如下所示：

```
C/C++  -  Preprocessor  -   Generate Preprocessed File 
```

有了它，您可以准确地看到宏是如何被扩展的。您可能需要通过编译器运行 .i 文件以找到导致语法错误的确切行。阅读后预处理文件可能会很痛苦，但它应该显示正在发生的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T14:38:58.407

这与您包含文件的方式没有任何关系，这是您得到的语法错误，因为您没有`(`正确嵌套`)`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-31T14:49:10.697

如果没有来源，很难确定到底发生了什么。从您问题的第一部分来看，这个特定代码似乎在首次使用它的项目中正确编译，但是当您将它包含在第二个项目中时，它不再编译。如果是这种情况，您想查看在此之前包含哪些其他标题。有时，如果您的函数或变量名称与另一个头文件中定义的名称相同，尤其是 windows.h，那么您可能会从之前编译的代码中得到错误。

如果此代码*从未*正确编译，那么建议您检查打开/关闭“（”的其他答案可能是开始的地方。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T14:41:04.503

你的编译器应该告诉你错误在哪一行。尝试在该行末尾搜索前一个“（”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T15:59:49.663

你需要找出事情扩展到什么。具体来说，什么是 ID_SPOOLER_EVENT？如果它有不平衡的括号，那就是你的罪魁祸首。如果没有，那么，请听从 Mike B 的建议。这对我来说似乎是一个预处理器问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T15:01:15.197

正在使用的代码：

```
// the only two includes
#include <windows.h>
#include "spooler.h"
// in WinMain
// create window then...
ShowWindow (hwnd, iCmdShow);
UpdateWindow (hwnd);

SpoolerInitiallize( hwnd, ID_SPOOLER_EVENT ); // <-- our function
... 
```

是的，我知道它拼写错误，并且在整个文档中初始化这个词也拼写错误。不幸的是，它无法更改，因为我们也将此 dll 提供给第三方。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-31T16:09:52.997

试试[Mike B](https://stackoverflow.com/questions/253720/weird-include-problem#253923)所说的预处理器。

这个建议提醒了我为什么这个错误看起来如此熟悉。`#define`对我来说，用文字 int 或类似的东西替换变量名是很短的。讨厌。

通过预处理器运行代码是我发现发生了什么的方式。

# ruby-on-rails - 在 Rails 运行时提供参数

> ID：253724
> 
> 赞同：4
> 
> 时间：2008-10-31T14:35:00.413
> 
> 标签：ruby-on-rails, ruby, cryptography, arguments

我正在寻找一种在运行时为 ruby​​ on rails 项目提供参数的方法。本质上，我们的项目使用公钥密码术来加密一些敏感的客户端数据，我们希望能够在运行时向私钥文件提供密码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T20:31:36.760

任何 Ruby 脚本都可以通过 ENV 哈希访问本地环境变量。

```
puts ENV['PATH'] 
```

因此，对于任何 posix 系统（Linux、Unix、Mac OS），您都可以在调用脚本时简单地设置它，如下所示：

```
MY_ARG=supersecret ruby script.rb 
```

这同样适用于导轨。如果你放入`puts ENV['MY_ARG']`你的 environment.rb 并启动你的服务器：

```
$ MY_ARG=supersecret mongrel_rails start
** Starting Mongrel listening at 0.0.0.0:3000
** Starting Rails with development environment...
supersecret
** Rails loaded.
** Loading any Rails specific GemPlugins
** Signals ready.  TERM => stop.  USR2 => restart.  INT => stop (no restart).
** Rails signals registered.  HUP => reload (without restart).  It might not work well.
** Mongrel 1.1.5 available at 0.0.0.0:3000
** Use CTRL-C to stop. 
```

在我看来，环境变量是迄今为止最简单的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T15:49:05.147

将密码放入经过 chmod 修改为只能由 Web 服务器用户读取的文件有什么问题？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T19:45:08.383

一个简单的方法是创建一个 Rails 插件，在它的“init.rb”中使用“gets”来接受参数。请允许我编写一个快速代码示例：

创建一个目录：'$railsRoot/vendor/plugins/startup_args/lib'

创建一个对象以将参数数据存储在“$railsRoot/vendor/plugins/startup_args/lib/startup_args.rb”中：

```
module StartupArgs
 @@argHash = {}

 def self.setArg(key, value)
  @@argHash[key.to_sym] = value
 end

 def self.getArg(key)
  return @@argHash[key.to_sym]
 end
end 
```

将 StartupArgs 模块加载到 Rails 项目的命名空间中，并使用 '$railsRoot/vendor/plugins/startup_args/init.rb' 中的参数填充它：

```
require "startup_args"

promptString = "Enter arg name (type nothing to continue):"

puts promptString
while (newArg = gets.chomp) != ""
 puts "Enter value for '#{newArg}':"
 newVal = gets.chomp
 StartupArgs.setArg(newArg, newVal)

 puts promptString
end 
```

现在，在 Rails 项目的启动过程中，它会尝试从控制台获取键值对。这些对将存储在全局命名空间对象 StartupArgs 中以供以后访问（通过“StartupArgs.getArg()”）。

如果您预计您的 Rails 项目可能部署在守护程序在启动时无法访问控制台的情况下，您可以从命名管道而不是控制台的标准输入中读取。

更进一步，您可以删除“init.rb”的所有部分，但“require”语句除外，并将执行此设置的操作添加到控制器，该控制器将相关参数作为网络上的帖子。确保配置 Rails 以防止将潜在的敏感参数（例如密码）输入到记录访问或错误的日志文件中（特别是如果它可能用作 HTTP GET，在 URL 中带有参数）。

（如果您将其他 Rails 操作配置为忽略请求，直到设置操作将适当的参数存储到全局对象，您将获得与上述系统相同的效果。）

给 Micah 的注意事项：我没有直接对您的帖子发表评论的声誉，所以我将在此处包含我的评论。考虑一个从不需要密码在文件系统中表示的系统可能有几个原因。例如，开发人员可能正在计划一个 Rails 项目，该项目可以部署在不同的操作系统和不同的环境中。如果开发人员确定在某些情况下管理用户或 root 用户可能会受到威胁、无法信任或无法被要求签署保密和安全协议，则开发人员可能会决定添加额外的混淆，将密码放入内存中仅（为了需要稍微不那么安全的系统或更聪明的攻击来窃取密码）。

# visual-c++ - vc80.pdb - 我如何让它消失并且不再打扰我？

> ID：253727
> 
> 赞同：14
> 
> 时间：2008-10-31T14:35:16.840
> 
> 标签：visual-c++, visual-studio-2005

使用 VS2005 构建静态库时，我不断收到链接器警告，提示无法在 library.lib 中找到 VC80.pdb。显然，因此，IDE 的编辑和继续功能无法运行任何包含 library.lib 的项目

需要什么魔法来告诉 VS2005 生成一个带有编辑的静态库并继续在链接到项目时不引用或不需要 vs80.pdb 的调试信息？

--在进一步理解之后-- 所以，为了让编辑并继续使用预编译的静态库运行，我们需要将 vs80.pdb 和 vs80.pdb 文件与 .lib 一起放入 SVN，并且重命名 pdb/idb 以防止在使用多个预编译库时发生冲突。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-31T17:15:18.637

vc80.pdb 是包含您的库的调试信息的文件。在 ide Property pages:configuration properties:c\c++:output files 中，您可以将其重命名为更合适的名称，例如您的 lib 名称。当链接器将您的 lib 链接到目标 exe 时，它​​会查找此 pdb（在 lib 中有指向它的指针）并从该 pdb 中提取信息并将其放入 exe 的 pdb 中。

/Fd[name] 是重命名 pdb 的选项 /ZI 是使用包含编辑和继续信息的 pdb 进行编译的选项。

所有链接的库和最终的 exe 或 dll 都需要 /ZI，以启用编辑和继续。

我制作了一个很小的 ​​testlib.lib 并使用“dumpbin /all”来获取以下显示指向调试信息的指针（这是一小段摘录）：

```
SECTION HEADER #7
.debug$T name
       0 physical address
       0 virtual address
      48 size of raw data
     838 file pointer to raw data (00000838 to 0000087F)
       0 file pointer to relocation table
       0 file pointer to line numbers
       0 number of relocations
       0 number of line numbers
42100040 flags
         Initialized Data
         Discardable
         1 byte align
         Read Only

RAW DATA #7
  00000000: 04 00 00 00 42 00 15 15 D5 EA 1E C9 7C 10 3A 40  ....B...Õê.É|.:@
  00000010: 93 63 CE 95 77 15 49 4A 03 00 00 00 64 3A 5C 64  .cÎ.w.IJ....d:\d
  00000020: 65 76 5C 74 65 73 74 5C 74 65 73 74 6C 69 62 5C  ev\test\testlib\
  00000030: 74 65 73 74 6C 69 62 5C 64 65 62 75 67 5C 76 63  testlib\debug\vc
  00000040: 38 30 2E 70 64 62 00 F1                          80.pdb.ñ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-05-03T20:25:56.203

如果您可以在没有“编辑并继续”的情况下生活，请尝试使用[/Z7](http://msdn.microsoft.com/en-us/library/958x11bc(VS.80).aspx)。
我将它用于存储在源代码管理中的所有 .lib 文件。不创建 .pdb 文件 - 调试信息存储在 .lib 文件中。

# asp.net - 如何使用 ASP 从 Web 表单中删除字段？

> ID：253731
> 
> 赞同：0
> 
> 时间：2008-10-31T14:36:31.470
> 
> 标签：asp.net, webforms

我有一个网页，其中包含用于注册的网络表单。我想删除字段。我已经尝试从 .asp 文件中删除域代码，但显然我还需要沿这些行删除其他内容。我可以完全访问所有代码，但我需要帮助了解事物的链接位置，以使表单再次工作。我们的程序员保释了。

一步一步的指南会很好。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T14:42:35.733

如果它们只是 .ASP 文件，您应该可以删除字段标记以及对它的任何引用。

即你会删除这一行：

```
<asp:TextBox id="text1" runat="server" /> 
```

并在文件的其余部分中搜索“id”属性（在本例中为“text1”上的查找），然后删除这些行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T14:51:58.397

如果与此相关的所有内容都在同一个 ASP 页面中，那就很容易了。您可以对每个表单字段的名称和/或 ID 进行简单的文本搜索。有时它们在 javascript 块中被引用，因此您必须注释掉一些引用这些字段的表单验证代码。

如果他们为此使用了一些愚蠢的 Dreamweaver 脚本 - 祝你好运！

如果有 #include 语句或对外部 JavaScript 文件的引用，则工作量更大 - 您还必须跟踪它们，希望它们也没有自己的包含文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T15:56:23.120

删除标记的输入部分后，如果它是 .asp（假设为 asp v3 而不是 asp.net），则还值得通过页面的 <% %> 标记部分来查找对已删除输入的引用。如果是 asp.net，则检查页面中脚本 runat server 块中的 vb.net / c# 代码，或查看代码隐藏文件以获取参考并重新编译。

# reporting-services - 显示嵌入在 DLL 文件中的 .RDLC 报告

> ID：253735
> 
> 赞同：42
> 
> 时间：2008-10-31T14:36:53.013
> 
> 标签：reporting-services, rdlc, embedded-resource

我有一个 Windows 服务和表单应用程序使用的报告。因此，我想将报告嵌入到一个可供两者使用的 DLL 文件中。

问题是，如果我尝试在我的 Windows 窗体应用程序中设置 ReportViewer 控件的 ReportEmbeddedResource 属性，它将在 Windows 窗体应用程序中搜索资源，而不是 dll 文件。

例如：来自 windows 窗体应用程序的代码：

```
rv.LocalReport.ReportEmbeddedResource = "MyReportInMyDLLFile.rdlc" 
```

如何使上述命令在我的 DLL 文件中查找嵌入式资源？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-12-11T02:20:43.273

这样的事情应该这样做：

```
Assembly assembly = Assembly.LoadFrom("Reports.dll");
Stream stream = assembly.GetManifestResourceStream("Reports.MyReport.rdlc");
reportViewer.LocalReport.LoadReportDefinition(stream); 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2010-07-26T10:29:45.377

只需使用程序集的完整命名空间，然后是文件夹名称，然后是文件名：

```
rv.LocalReport.ReportEmbeddedResource = 
    "My.Assembly.Namespace.Folder1.Folder2.MyReport.rdlc"; 
```

然后确保使用属性窗格将报告文件设置为嵌入式资源。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-11-04T13:11:40.470

最好的办法可能是从另一个程序集获取到 RDLC 资源的流，然后将其传递给 Report Viewer 控件的“LoadReportDefinition”方法。

可以在此处找到有关如何从不同程序集中的嵌入式资源获取流的详细信息：[使用 ResourceManager 类检索资源](http://msdn.microsoft.com/en-us/library/aa984408(VS.71).aspx)

此外，您将需要使用它的完整命名空间路径来引用嵌入式资源。

例如，如果您有一个默认命名空间为**TheApp**的应用程序，并且您在名为“ **Reports** ”的文件夹中保存了一个名为“ **MyReport.rdlc** ”的报告，则报告引用调用将是：-

 **```
rv.LocalReport.ReportEmbeddedResource = "TheApp.Reports.MyReport.rdlc"; 
```

# oslo - Oslo 错误“M2037: SQL Generation Internal Error: Missing generator for variable”的解释？

> ID：253746
> 
> 赞同：1
> 
> 时间：2008-10-31T14:38:04.213
> 
> 标签：oslo, m

在 Microsoft Oslo SDK CTP 2008（使用 Intellipad）中，以下代码编译良好：

```
module T {

    type A {
        Id : Integer32 = AutoNumber();
    } where identity Id;

    As : A*;

    type B {
        Id : Integer32 = AutoNumber();
//        A : A;
//    } where A in As && identity Id;
    } where identity Id;

    Bs : B*;

    type C {
        Id : Integer32 = AutoNumber();
        B : B;
    } where B in Bs && identity Id;

    Cs : C*;

} 
```

并导致以下到达 SQL 输出：

```
set xact_abort on;
go

begin transaction;
go

set ansi_nulls on;
go

create schema [T];
go

create table [T].[As]
(
    [Id] int not null identity,
    constraint [PK_As] primary key clustered ([Id])
);
go

create table [T].[Bs]
(
    [Id] int not null identity,
    constraint [PK_Bs] primary key clustered ([Id])
);
go

create table [T].[Cs]
(
    [Id] int not null identity,
    [B] int not null,
    constraint [PK_Cs] primary key clustered ([Id]),
    constraint [FK_Cs_B_T_Bs] foreign key ([B]) references [T].[Bs] ([Id])
);
go

commit transaction;
go 
```

但是在将模块 T 中的注释行更改如下

```
 A : A;
    } where A in As && identity Id;
//    } where identity Id; 
```

显示错误消息“M2037: SQL Generation Internal Error: Missing generator for variable 'A'”（在 Intellipad 的 Reach SQL 窗口中）。

有任何想法吗？

问候，坦伯格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T18:37:29.457

我想你想要的是：

```
type A {
    Id : Integer32 = AutoNumber();
} where identity Id;

As : A*;

type B {
    Id : Integer32 = AutoNumber();
    A : A;
} where identity Id;

Bs : (B where value.A in As)*;

type C {
    Id : Integer32 = AutoNumber();
    B : B;
} where identity Id && B in Bs;

Cs : (C where value.B in Bs)*; 
```

请注意，约束是在外部，而不是这里的类型。当类型上的约束但不能深入一个以上的关系时，我能够获得类似的代码。将它们移动到外部似乎是正确的，并生成了预期的 Reach SQL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T21:00:05.300

[http://social.msdn.microsoft.com/Forums/en-US/oslo/thread/05103bf8-4e0f-4976-bcdd-2c724cb08738/](http://social.msdn.microsoft.com/Forums/en-US/oslo/thread/05103bf8-4e0f-4976-bcdd-2c724cb08738/)

# .net - 使用 .NET 类型化数据集管理数据预取和依赖关系

> ID：253747
> 
> 赞同：2
> 
> 时间：2008-10-31T14:38:24.727
> 
> 标签：.net, dataset

我在一个项目中使用 .NET 类型的数据集，我经常遇到这样的情况：我将多个表中的数据预取到一个数据集中，然后将该数据集传递给几个方法进行处理。让每个方法准确地决定它需要哪些数据然后加载数据本身似乎更干净。但是，有几种方法适用于相同的数据，我希望在开始时只加载一次数据的性能优势。

我的问题是我不知道用于管理依赖项的好方法或模式（我想确保我加载了将使用数据集的每个类/方法所需的所有数据）。目前，我最终只是查看了将使用数据集的各种类的代码，以确保我正确加载了所有内容。

在这种情况下使用什么好的方法或模式？我在做一些根本错误的事情吗？尽管我使用的是类型化数据集，但这似乎是使用预取数据的常见情况。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-01T21:16:33.643

我认为您正在寻找的“模式”可能只是延迟加载或延迟加载。您的类型化数据集可以具有所有方法或类都需要的结构，但是直到某些方法/类尝试访问数据的特定部分时才会填充数据。

一个很好的例子是名称和地址。您可能有一个姓名列表，每个姓名可能有多个地址。不需要访问地址的方法/类不会导致地址加载。但是，只要任何方法或类尝试访问给定名称的地址，就会加载该名称的地址。对该名称地址的任何后续使用都将找到已加载的数据。

在类型化数据集中实现这一点将是一个相当手动的过程。（每次我使用类型化的数据集时，我最终都会越来越讨厌它们。）您可能希望查看 LINQ to SQL，因为该功能是内置的。还有其他类似的框架也内置了此功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-29T14:27:59.173

您可以使用类似于复合模式的东西，您可以让每个类添加一些数据要求，然后预取数据，然后处理数据。

对于 UsedClasses 中的每个类

DataSet.AddRequirement(Class.Requirements)

数据集预取

对于 UsedClasses 中的每个类

类.进程（数据集）

# asp.net - 学习构建企业 ASP.NET v3.5 应用程序的最快途径是什么？

> ID：253751
> 
> 赞同：2
> 
> 时间：2008-10-31T14:39:42.260
> 
> 标签：asp.net, .net-3.5

从 v1.1 开始就没有做过 ASP.NET，现在快速浏览了 Wrox Pro ASP.NET v3.5 的书，还有哪些其他资源可以让我以最快的速度开发企业 ASP.NET 应用程序？

自 Beta 版以来，我一直在 DotNet 中进行开发，并且已经从事 Winform 和中间层架构/设计/开发 3.5 年（因为这是我客户的愿望）。但我发现我的落后对新客户造成了伤害。:(

我将不胜感激有关尽快前进的任何建议。我正在寻找任何与 RAD 相关的内容，甚至只是您推荐的有关该主题的好书。不过，现在，我正在享受阅读 Wrox 书的乐趣。非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T14:47:49.527

我将从[快速入门教程](http://quickstarts.asp.net/QuickStartv20/default.aspx)开始。这将使您进入代码，让您对编程、架构、控件、数据访问等有所了解。[您还可以在ASP.NET 网站上](http://www.asp.net/get-started/)观看有关如何在 ASP.NET 中完成各种任务的视频。

假设您已经拥有丰富的 VB.NET 或 C# 经验，那么您应该很快深入了解 ASP.NET。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T14:47:40.683

看看[ASP.NET Dynamic Data](http://www.asp.net/dynamicdata/) Scaffolding Framework（包含在 .NET Framework 3.5 SP1 中），它允许您构建真正快速的数据驱动的 Web 应用程序。[在这里](http://www.asp.net/learn/3.5-SP1/)，您可以找到有关此 RAD 功能的更多优质视频和资源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T15:07:27.413

没那么容易，因为“企业”这个词可以包含很多东西。首先，我建议只是了解哪些新框架可用，包括开箱即用的和非开箱即用的。自 .NET 1.1 以来已经出现了很多这样的问题。

例如，WCF。动态数据，如另一条评论中所述。ASP.NET MVC。LINQ、ADO.NET EF、WF。

我并不是建议你学习所有这些，至少不要一次全部学习。相反，至少要熟悉它们是什么以及它们带来了什么。浏览基类库参考并熟悉可用的命名空间。这将帮助您了解那里有什么以及您将要写什么。尝试你感兴趣的部分。

在您更熟悉 .NET 框架之后，是时候看看企业开发所需的其他内容了。CSLA 和 NHibernate 等框架。测试 TypeMock 之类的东西。和以前一样，即使不知道细节，只要知道那里有什么，也会有很大帮助。

写代码。如果您想快速学习，没有什么比编写代码更有趣了。选择您在 1.1 天内写回的应用程序之一，并尝试使用您可以使用的新工具编写更短、更清洁和/或更易于维护的版本。

别忘了玩得开心。如果你不喜欢你正在做的事情，你就不会真正学到很多东西。祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T15:43:29.727

您可能不应该将“企业”与“rad”混为一谈，因为两者通常在频谱的两端都有极端的含义。

企业通常会制定大型业务线应用程序、大型复杂性、大型配置的想法（有些可能与痛苦、噩梦等有关。）

RAD 通常指的是您在精彩的会议演示中看到的拖放垃圾，但随后您回到家并尝试构建*和维护*以及在您的 UI 上使用拖放控件和数据访问组件构建的应用程序，您很快就会看到它崩溃。

在工具和技术之间选择一个良好的平衡点，让您高效，但同时又不牺牲可维护性。

在 Stack Overflow 上，您会发现很多关于“您应该如何工作”的意见，但我能给您的最好建议是务实，尽可能多地阅读，以及代码-代码-代码。我在公共汽车上、在家、在工作中、在飞机上、在酒店房间等上编写代码。尝试不同的工具/框架，看看他们的社区怎么说，尝试构建一个简单的待办事项列表应用程序等。感受一下外面有什么。

通过接触社区，您走在了正确的道路上。

# c# - 为什么事件不能在派生类中与在 C# 中的基类中以相同的方式使用？

> ID：253757
> 
> 赞同：34
> 
> 时间：2008-10-31T14:41:16.513
> 
> 标签：c#, events

在下面的代码中，我想通过派生/继承类来扩展类的行为，并利用基类的事件：

```
public class A
{
    public event EventHandler SomeEvent;

    public void someMethod()
    {
        if(SomeEvent != null) SomeEvent(this, someArgs);
    }
}

public class B : A
{
    public void someOtherMethod()
    {
        if(SomeEvent != null) SomeEvent(this, someArgs); // << why is this not possible?
//Error: The event 'SomeEvent' can only appear on the left hand side of += or -= 
//(except when used from within the type 'A')
    }
} 
```

为什么不可能？

这种情况的常见解决方案是什么？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-10-31T14:55:26.393

其他人已经解释了如何解决这个问题，但没有解释为什么会出现。

当您声明一个类似公共字段的事件时，编译器会创建一个公共事件和一个私有字段。在同一个类（或*嵌套*类）中，您可以直接访问该字段，例如调用所有处理程序。从其他类，你只看到事件，它只允许订阅和取消订阅。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-10-31T14:47:12.960

这里的标准做法是在您的基类上拥有一个受保护的虚拟方法 OnSomeEvent，然后在派生类中调用该方法。此外，出于线程原因，您将希望在检查 null 并调用它之前保留对处理程序的引用。

有关为什么阅读[Jon Skeet 的](https://stackoverflow.com/questions/253757/why-events-cant-be-used-in-the-same-way-in-derived-classes-as-in-the-base-class#253803)答案或描述编译器如何自动创建私有字段的[C# 规范的解释。](http://msdn.microsoft.com/en-us/library/aa664454(VS.71).aspx)

这是一种可能的解决方法。

```
public class A
{
    public event EventHandler SomeEvent;

    public void someMethod()
    {
        OnSomeEvent();
    }

    protected void OnSomeEvent()
    {
        EventHandler handler = SomeEvent;
        if(handler != null)
            handler(this, someArgs);
    }
}

public class B : A
{
    public void someOtherMethod()
    {
        OnSomeEvent();
    }
} 
```

**编辑：**根据[框架设计指南第 5.4 节](http://msdn.microsoft.com/en-us/library/cf18x51d(VS.71).aspx)和其他人的[提醒](https://stackoverflow.com/questions/253757/why-events-cant-be-used-in-the-same-way-in-derived-classes-as-in-the-base-class#253806)更新了代码。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-10-31T14:55:45.753

托德的回答是正确的。通常，您会在 .NET 框架中将其作为`OnXXX(EventArgs)`方法实现：

```
public class Foo
{
    public event EventHandler Click;

    protected virtual void OnClick(EventArgs e)
    {
        var click = Click;
        if (click != null)
            click(this, e);
    }
} 
```

我强烈建议您在发现自己使用/来引发事件之前先考虑[`EventArgs<T>`/`EventHandler<T>`模式。](http://www.c-sharpcorner.com/UploadFile/rmcochran/customgenericeventargs05132007100456AM/customgenericeventargs.aspx)`CustomEventArgs``CustomEventHandler`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-31T14:57:22.833

原始代码不起作用的原因是您需要访问事件的委托才能引发它，而 C# 保留此委托`private`。

C# 中的事件由一对方法`add_SomeEvent`和公开表示`remove_SomeEvent`，这就是为什么您可以从类外部订阅事件但不能引发它的原因。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-10-31T15:46:07.943

我的回答是你不应该这样做。

C# 很好地强制**只有声明/发布事件的类型应该触发/引发它。** 如果基类信任派生具有引发其事件的能力，则创建者将公开受保护的方法来做到这一点。如果它们不存在，这是一个很好的暗示，您可能不应该这样做。

我人为的例子是，如果允许派生类型在其祖先中引发事件，世界会有多么不同。注意：这**不是**有效的 C# 代码..（还..）

```
public class GoodVigilante
{
  public event EventHandler LaunchMissiles;

  public void Evaluate()
  {
    Action a = DetermineCourseOfAction(); // method that evaluates every possible
// non-violent solution before resorting to 'Unleashing the fury'

    if (null != a) 
    { a.Do(); }
    else
    {  if (null != LaunchMissiles) LaunchMissiles(this, EventArgs.Empty); }
  }

  virtual protected string WhatsTheTime()
  {  return DateTime.Now.ToString();  }
  ....   
}
public class TriggerHappy : GoodVigilante
{
  protected override string WhatsTheTime()
  {
    if (null != LaunchMissiles) LaunchMissiles(this, EventArgs.Empty);
  }

}

// client code
GoodVigilante a = new GoodVigilante();
a.LaunchMissiles += new EventHandler(FireAway);
GoodVigilante b = new TriggerHappy();             // rogue/imposter
b.LaunchMissiles += new EventHandler(FireAway);

private void FireAway(object sender, EventArgs e)
{
  // nuke 'em
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-31T14:53:07.020

用受保护的虚拟 On... 方法包装它：

```
public class BaseClass
{
    public event EventHandler<MyArgs> SomeEvent;

    protected virtual void OnSomeEvent()
    {
        if(SomeEvent!= null)
            SomeEvent(this, new MyArgs(...) );
    }
} 
```

然后在派生类中覆盖它

```
public class DerivedClass : BaseClass
{
    protected override void OnSomeEvent()
    {
        //do something

        base.OnSomeEvent();
    }
} 
```

您将在整个 .Net 上设置此模式 - 所有表单和 Web 控件都遵循它。

不要使用前缀 Raise... - 这与 MS 的标准不一致，并且可能会在其他地方引起混淆。

# regex - 你在你的正则表达式中使用过 Perl 5.10 回溯控制动词吗？

> ID：253760
> 
> 赞同：12
> 
> 时间：2008-10-31T14:41:40.243
> 
> 标签：regex, perl

你在你的正则表达式中使用过 Perl 5.10 回溯控制动词吗？他们帮助你完成了哪些问题？

* * *

就像背景一样：我做了一些摆弄，但我无法得到任何真正有用的结果。

作为比较，当我开始了解`(?>`分组所做的事情时，它开始更多地出现在我的正则表达式中。我喜欢将 Perl 正则表达式世界调整为一组特定假设的想法。随着 RE 语言的功能越来越多，回溯使得 RE 的性能与它们所基于的精益和平均 FSA 大相径庭。

* * *

当有人可以告诉我REs 的*其他*实现有哪些回溯控制动词时——而 PCRE*没有*，我可以承认它属于熟悉正则表达式的人的一般专业领域。这是一个*Perl*正则表达式问题，帮助人们使用 Ruby、Python、C#、Javascript 或任何 PCRE 客户端实现的人可能无法帮助或将其视为对他们通常阅读的标签的空间浪费。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-11-18T13:18:12.473

是的，我有，虽然不是太多。我用它们来控制回溯，通常是为了迫使它做出更多的排列。这是一个[有趣的解决方案](https://stackoverflow.com/questions/4092348/how-to-generate-an-array-with-random-values-without-using-a-loop/4092746#4092746)，这是一个[实用](https://stackoverflow.com/questions/4168670/regex-that-matches-xabc-but-not-x-alone/4169358#4169358)的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-01T18:38:06.567

自从我进行任何 Perl 编程以来已经有好几年了，所以在你提到它之前我什至不知道这个特性。它看起来像是只有正则表达式专家才会使用的核心功能之一（当然，Perl 社区有很多这样的功能）。另一方面，Perl 6 Grammars 看起来会很有趣。

现在，我对原子团和所有格量词感到满意。事实上，我几乎沉迷于它们。它已经到了我反射性地尝试以它们永远不会回溯的方式编写正则表达式的地步。有时我不得不提醒自己，小剂量的回溯是可以的，完全消除它是不值得的。

ps，据我所知，所有格量词仅受 Java、PCRE（PHP、Apache、Flex 3/ActionScript 3）和 RegexBuddy、EditPad Pro 和 PowerGrep 使用的 JGSoft 正则表达式引擎支持。

更新： Oniguruma 风格（用于 Ruby 1.9+ 和 TextMate）同时支持原子组和所有格量词。当然，除了回溯控制动词之外，Perl 5.10 还支持它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T15:32:40.297

老实说，我什至还没有使用 5.10。与一些新功能一样棒的是我只在个人脚本中使用它们。对于生产，我的目标是与 5.8 兼容。对于 CPAN，我的目标是 5.6。这使我无法玩大多数新玩具。

回溯控制功能很有趣，但我看不到解析器之外的许多应用程序。我无法想象将整个解析器填充到单个正则表达式中。（即使他们现在确实支持递归！）我对 Perl6 语法更感兴趣。

# python - 寻找一个通用的 Python 脚本来添加一个字段并用条件填充该字段

> ID：253761
> 
> 赞同：0
> 
> 时间：2008-10-31T14:42:28.930
> 
> 标签：python, sql, sql-update

我正在寻找一个脚本，以允许用户将文本字段添加到 .dbf 表（例如土地利用类别）并允许他们根据他们认为应该分配的 GRIDCODE（数字类别）字段中的值输入/更新行转化为文本类别。即如果GRIDCODE值为4，则landuse/landclass对应的字段值为“forest”等。

是否存在这样的脚本？

或者，您是否有类似的东西可以自定义以创建新脚本？

该脚本将接受用户的交互式输入作为传递给脚本的参数。

真诚的，大卫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T15:03:26.407

当您说dbf table时，您指的是ESRI shape file dbf files，实际上是dbase files吗？[如果是这样，您可以使用shapelib](http://shapelib.maptools.org/)的 python 包装器轻松实现这样的事情，它也支持 dbf 文件。

# java - Java中的KDTree实现

> ID：253767
> 
> 赞同：55
> 
> 时间：2008-10-31T14:44:43.823
> 
> 标签：java, data-structures, kdtree

我正在寻找 Java 中的 KDTree 实现。
我做了一个谷歌搜索，结果似乎很随意。实际上有很多结果，但它们大多只是一次性的实现，我宁愿找到更多“生产价值”的东西。诸如 apache 集合或 .NET 的优秀 C5 集合库之类的东西。我可以看到公共错误跟踪器并检查最后一次 SVN 提交发生的时间。此外，在理想情况下，我会为空间数据结构找到一个精心设计的 API，而 KDTree 只是该库中的一个类。

对于这个项目，我只会在 2 维或 3 维中工作，而且我主要只是对一个好的最近邻实现感兴趣。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-11-06T15:26:21.647

在[Algorithms in a Nutshell](http://oreilly.com/catalog/9780596516246/)一书中，Java 中有一个 kd 树实现以及一些变体。所有代码都在[oreilly.com](http://examples.oreilly.com/9780596516246/)上，这本书本身也将引导您完成算法，以便您自己构建一个。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2011-11-14T11:15:58.740

对于未来的寻求者。Java-ml 库有一个运行良好的 kd-tree 实现。 [http://java-ml.sourceforge.net/](http://java-ml.sourceforge.net/)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2010-05-06T20:12:44.960

我在[此处](https://simondlevy.academic.wlu.edu/software/kd/)找到的 Levy 教授的实施取得了成功。我意识到您正在寻找更多经过生产认证的实施，因此这可能不太合适。

但是请注意任何路人，我已经在我的照片马赛克项目中使用它一段时间了，没有任何问题。没有保证，但总比没有好:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-06-13T12:45:29.000

我创建了一个 KD-Tree 实现作为离线反向地理编码库的一部分

[https://github.com/AReallyGoodName/OfflineReverseGeocode](https://github.com/AReallyGoodName/OfflineReverseGeocode)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-03T21:39:33.673

也许来自 Stony-Brook 算法存储库的[最近邻搜索](http://www.cs.sunysb.edu/~algorith/files/nearest-neighbor.shtml)和[KD-trees可以提供帮助。](http://www.cs.sunysb.edu/~algorith/files/kd-trees.shtml)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-03-09T21:40:53.453

这是 KD-Tree 的完整实现，我使用了一些库来存储点和矩形。这些库是免费提供的。可以使用这些类创建自己的类来存储点和矩形。请分享您的反馈。

```
import java.util.ArrayList;
import java.util.List;
import edu.princeton.cs.algs4.In;
import edu.princeton.cs.algs4.Point2D;
import edu.princeton.cs.algs4.RectHV;
import edu.princeton.cs.algs4.StdDraw;
public class KdTree {
    private static class Node {
        public Point2D point; // the point
        public RectHV rect; // the axis-aligned rectangle corresponding to this
        public Node lb; // the left/bottom subtree
        public Node rt; // the right/top subtree
        public int size;
        public double x = 0;
        public double y = 0;
        public Node(Point2D p, RectHV rect, Node lb, Node rt) {
            super();
            this.point = p;
            this.rect = rect;
            this.lb = lb;
            this.rt = rt;
            x = p.x();
            y = p.y();
        }

    }
    private Node root = null;;

    public KdTree() {
    }

    public boolean isEmpty() {
        return root == null;
    }

    public int size() {
        return rechnenSize(root);
    }

    private int rechnenSize(Node node) {
        if (node == null) {
            return 0;
        } else {
            return node.size;
        }
    }

    public void insert(Point2D p) {
        if (p == null) {
            throw new NullPointerException();
        }
        if (isEmpty()) {
            root = insertInternal(p, root, 0);
            root.rect = new RectHV(0, 0, 1, 1);
        } else {
            root = insertInternal(p, root, 1);
        }
    }

    // at odd level we will compare x coordinate, and at even level we will
    // compare y coordinate
    private Node insertInternal(Point2D pointToInsert, Node node, int level) {
        if (node == null) {
            Node newNode = new Node(pointToInsert, null, null, null);
            newNode.size = 1;
            return newNode;
        }
        if (level % 2 == 0) {//Horizontal partition line
            if (pointToInsert.y() < node.y) {//Traverse in bottom area of partition
                node.lb = insertInternal(pointToInsert, node.lb, level + 1);
                if(node.lb.rect == null){
                    node.lb.rect = new RectHV(node.rect.xmin(), node.rect.ymin(),
                            node.rect.xmax(), node.y);
                }
            } else {//Traverse in top area of partition
                if (!node.point.equals(pointToInsert)) {
                    node.rt = insertInternal(pointToInsert, node.rt, level + 1);
                    if(node.rt.rect == null){
                        node.rt.rect = new RectHV(node.rect.xmin(), node.y,
                                node.rect.xmax(), node.rect.ymax());
                    }
                }
            }

        } else if (level % 2 != 0) {//Vertical partition line
            if (pointToInsert.x() < node.x) {//Traverse in left area of partition
                node.lb = insertInternal(pointToInsert, node.lb, level + 1);
                if(node.lb.rect == null){
                    node.lb.rect = new RectHV(node.rect.xmin(), node.rect.ymin(),
                            node.x, node.rect.ymax());
                }
            } else {//Traverse in right area of partition
                if (!node.point.equals(pointToInsert)) {
                    node.rt = insertInternal(pointToInsert, node.rt, level + 1);
                    if(node.rt.rect == null){
                        node.rt.rect = new RectHV(node.x, node.rect.ymin(),
                                node.rect.xmax(), node.rect.ymax());
                    }
                }
            }
        }
        node.size = 1 + rechnenSize(node.lb) + rechnenSize(node.rt);
        return node;
    }

    public boolean contains(Point2D p) {
        return containsInternal(p, root, 1);
    }

    private boolean containsInternal(Point2D pointToSearch, Node node, int level) {
        if (node == null) {
            return false;
        }
        if (level % 2 == 0) {//Horizontal partition line
            if (pointToSearch.y() < node.y) {
                return containsInternal(pointToSearch, node.lb, level + 1);
            } else {
                if (node.point.equals(pointToSearch)) {
                    return true;
                }
                return containsInternal(pointToSearch, node.rt, level + 1);
            }
        } else {//Vertical partition line
            if (pointToSearch.x() < node.x) {
                return containsInternal(pointToSearch, node.lb, level + 1);
            } else {
                if (node.point.equals(pointToSearch)) {
                    return true;
                }
                return containsInternal(pointToSearch, node.rt, level + 1);
            }
        }

    }

    public void draw() {
        StdDraw.clear();
        drawInternal(root, 1);
    }

    private void drawInternal(Node node, int level) {
        if (node == null) {
            return;
        }
        StdDraw.setPenColor(StdDraw.BLACK);
        StdDraw.setPenRadius(0.02);
        node.point.draw();
        double sx = node.rect.xmin();
        double ex = node.rect.xmax();
        double sy = node.rect.ymin();
        double ey = node.rect.ymax();
        StdDraw.setPenRadius(0.01);
        if (level % 2 == 0) {
            StdDraw.setPenColor(StdDraw.BLUE);
            sy = ey = node.y;
        } else {
            StdDraw.setPenColor(StdDraw.RED);
            sx = ex = node.x;
        }
        StdDraw.line(sx, sy, ex, ey);
        drawInternal(node.lb, level + 1);
        drawInternal(node.rt, level + 1);
    }

    /**
     * Find the points which lies in the rectangle as parameter
     * @param rect
     * @return
     */
    public Iterable<Point2D> range(RectHV rect) {
        List<Point2D> resultList = new ArrayList<Point2D>();
        rangeInternal(root, rect, resultList);
        return resultList;
    }

    private void rangeInternal(Node node, RectHV rect, List<Point2D> resultList) {
        if (node == null) {
            return;
        }
        if (node.rect.intersects(rect)) {
            if (rect.contains(node.point)) {
                resultList.add(node.point);
            }
            rangeInternal(node.lb, rect, resultList);
            rangeInternal(node.rt, rect, resultList);
        }

    }

    public Point2D nearest(Point2D p) {
        if(root == null){
            return null;
        }
        Champion champion = new Champion(root.point,Double.MAX_VALUE);
        return nearestInternal(p, root, champion, 1).champion;
    }

    private Champion nearestInternal(Point2D targetPoint, Node node,
            Champion champion, int level) {
        if (node == null) {
            return champion;
        }
        double dist = targetPoint.distanceSquaredTo(node.point);
        int newLevel = level + 1;
        if (dist < champion.championDist) {
            champion.champion = node.point;
            champion.championDist = dist;
        }
        boolean goLeftOrBottom = false;
        //We will decide which part to be visited first, based upon in which part point lies.
        //If point is towards left or bottom part, we traverse in that area first, and later on decide
        //if we need to search in other part too.
        if(level % 2 == 0){
            if(targetPoint.y() < node.y){
                goLeftOrBottom = true;
            }
        } else {
            if(targetPoint.x() < node.x){
                goLeftOrBottom = true;
            }
        }
        if(goLeftOrBottom){
            nearestInternal(targetPoint, node.lb, champion, newLevel);
            Point2D orientationPoint = createOrientationPoint(node.x,node.y,targetPoint,level);
            double orientationDist = orientationPoint.distanceSquaredTo(targetPoint);
            //We will search on the other part only, if the point is very near to partitioned line
            //and champion point found so far is far away from the partitioned line.
            if(orientationDist < champion.championDist){
                nearestInternal(targetPoint, node.rt, champion, newLevel);
            }
        } else {
            nearestInternal(targetPoint, node.rt, champion, newLevel);
            Point2D orientationPoint = createOrientationPoint(node.x,node.y,targetPoint,level);
            //We will search on the other part only, if the point is very near to partitioned line
            //and champion point found so far is far away from the partitioned line.
            double orientationDist = orientationPoint.distanceSquaredTo(targetPoint);
            if(orientationDist < champion.championDist){
                nearestInternal(targetPoint, node.lb, champion, newLevel);
            }

        }
        return champion;
    }
    /**
     * Returns the point from a partitioned line, which can be directly used to calculate
     * distance between partitioned line and the target point for which neighbours are to be searched.
     * @param linePointX
     * @param linePointY
     * @param targetPoint
     * @param level
     * @return
     */
    private Point2D createOrientationPoint(double linePointX, double linePointY, Point2D targetPoint, int level){
        if(level % 2 == 0){
            return new Point2D(targetPoint.x(),linePointY);
        } else {
            return new Point2D(linePointX,targetPoint.y());
        }
    }

    private static class Champion{
        public Point2D champion;
        public double championDist;
        public Champion(Point2D c, double d){
            champion = c;
            championDist = d;
        }
    }

    public static void main(String[] args) {
        String filename = "/home/raman/Downloads/kdtree/circle100.txt";
        In in = new In(filename);
        KdTree kdTree = new KdTree();
        while (!in.isEmpty()) {
            double x = in.readDouble();
            double y = in.readDouble();
            Point2D p = new Point2D(x, y);
            kdTree.insert(p);
        }
        // kdTree.print();
        System.out.println(kdTree.size());
        kdTree.draw();
        System.out.println(kdTree.nearest(new Point2D(0.4, 0.5)));
        System.out.println(new Point2D(0.7, 0.4).distanceSquaredTo(new Point2D(0.9,0.5)));
        System.out.println(new Point2D(0.7, 0.4).distanceSquaredTo(new Point2D(0.9,0.4)));

    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-11-05T18:15:17.183

还有[JTS 拓扑套件](http://www.vividsolutions.com/jts/jtshome.htm "JTS 拓扑套件")

KdTree 实现只提供范围搜索（没有最近邻）。

如果最近邻居是您的事，请查看[STRtree](http://www.vividsolutions.com/jts/javadoc/com/vividsolutions/jts/index/strtree/package-summary.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-12-14T07:40:40.083

你是对的，没有多少网站有 Java 的 kd 实现！无论如何，kd 树基本上是一个二叉搜索树，通常每次都会为该维度计算中值。这是简单的 KDNode，就最近邻方法或完整实现而言，请查看此[github](https://github.com/aerlinn/traffic/blob/8395c15b9a028ec06c394f1cab1b11b18749f9ce/src/edu/brown/cs32/cjm5/stars/KDTree.java)项目。这是我能为你找到的最好的一个。希望这对您有所帮助。

```
private class KDNode {
    KDNode left;
    KDNode right;
    E val;
    int depth;
    private KDNode(E e, int depth){
    this.left = null;
    this.right = null;
    this.val = e;
    this.depth = depth;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-28T16:36:04.663

可能会引起某人的兴趣。请参阅我最近的（）（和 KD Tree 类）在 java 中的 2D 树实现：

```
import edu.princeton.cs.algs4.Point2D;
import edu.princeton.cs.algs4.RectHV;
import edu.princeton.cs.algs4.StdDraw;

import java.util.ArrayList;
import java.util.List;

public class KdTree {
    private Node root;
    private int size;

    private static class Node {
        private Point2D p;      // the point
        private RectHV rect;    // the axis-aligned rectangle corresponding to this node
        private Node lb;        // the left/bottom subtree
        private Node rt;        // the right/top subtree
        public Node(Point2D p, RectHV rect) {
            this.p = p;
            this.rect = rect;
        }
    }

    public KdTree() {
    }

    public boolean isEmpty() {
        return size == 0;
    }

    public int size() {
        return size;
    }

    public boolean contains(Point2D p) {
        if (p == null) throw new IllegalArgumentException("argument to contains() is null");
        return contains(root, p, 1);
    }

    private boolean contains(Node node, Point2D p, int level) {
        if (node == null) return false; // a base case for recursive call

        if (node.p.equals(p)) return true;

        if (level % 2 == 0) { // search by y coordinate (node with horizontal partition line)
            if (p.y() < node.p.y())
                return contains(node.lb, p, level + 1);
            else
                return contains(node.rt, p, level + 1);
        }
        else { // search by x coordinate (node with vertical partition line)
            if (p.x() < node.p.x())
                return contains(node.lb, p, level + 1);
            else
                return contains(node.rt, p, level + 1);
        }
    }

    public void insert(Point2D p) {
        if (p == null) throw new IllegalArgumentException("calls insert() with a null point");
        root = insert(root, p, 1);
    }

    private Node insert(Node x, Point2D p, int level) {
        if (x == null) {
            size++;
            return new Node(p, new RectHV(0, 0, 1, 1));
        }

        if (x.p.equals(p)) return x; // if we try to insert existed point just return its node

        if (level % 2 == 0) { // search by y coordinate (node with horizontal partition line)
            if (p.y() < x.p.y()) {
                x.lb = insert(x.lb, p, level + 1);
                if (x.lb.rect.equals(root.rect))
                    x.lb.rect = new RectHV(x.rect.xmin(), x.rect.ymin(), x.rect.xmax(), x.p.y());
            }
            else {
                x.rt = insert(x.rt, p, level + 1);
                if (x.rt.rect.equals(root.rect))
                    x.rt.rect = new RectHV(x.rect.xmin(), x.p.y(), x.rect.xmax(), x.rect.ymax());
            }
        }
        else { // search by x coordinate (node with vertical partition line)
            if (p.x() < x.p.x()) {
                x.lb = insert(x.lb, p, level + 1);
                if (x.lb.rect.equals(root.rect))
                    x.lb.rect = new RectHV(x.rect.xmin(), x.rect.ymin(), x.p.x(), x.rect.ymax());
            }
            else {
                x.rt = insert(x.rt, p, level + 1);
                if (x.rt.rect.equals(root.rect))
                    x.rt.rect = new RectHV(x.p.x(), x.rect.ymin(), x.rect.xmax(), x.rect.ymax());
            }
        }
        return x;
    }

    public void draw() {
        draw(root, 1);
    }

    private void draw(Node node, int level) {
        if (node == null) return;

        StdDraw.setPenColor(StdDraw.BLACK);
        StdDraw.setPenRadius(0.01);
        node.p.draw();
        StdDraw.setPenRadius();

        if (level % 2 == 0) {
            StdDraw.setPenColor(StdDraw.BLUE);
            StdDraw.line(node.rect.xmin(), node.p.y(), node.rect.xmax(), node.p.y());
        }
        else {
            StdDraw.setPenColor(StdDraw.RED);
            StdDraw.line(node.p.x(), node.rect.ymin(), node.p.x(), node.rect.ymax());
        }

        draw(node.lb, level + 1);
        draw(node.rt, level + 1);
    }

    public Iterable<Point2D> range(RectHV rect) {
        if (rect == null) throw new IllegalArgumentException("calls range() with a null rect");
        List<Point2D> points = new ArrayList<>(); // create an Iterable object with all points we found
        range(root, rect, points); // call helper method with rects intersects comparing

        return points; // return an Iterable object (It could be any type - Queue, LinkedList etc)
    }

    private void range(Node node, RectHV rect, List<Point2D> points) {
        if (node == null || !node.rect.intersects(rect)) return; // a base case for recursive call

        if (rect.contains(node.p))
                points.add(node.p);
        range(node.lb, rect, points);
        range(node.rt, rect, points);

    }    

    public Point2D nearest(Point2D query) {
         if (isEmpty()) return null;
        if (query == null) throw new IllegalArgumentException("calls nearest() with a null point");
        // set the start distance from root to query point
        double best = root.p.distanceSquaredTo(query);
        // StdDraw.setPenColor(StdDraw.BLACK); // just for debugging
        // StdDraw.setPenRadius(0.01);
        // query.draw();
        return nearest(root, query, root.p, best, 1); // call a helper method
    }

    private Point2D nearest(Node node, Point2D query, Point2D champ, double best, int level) {
        // a base case for the recursive call
        if (node == null || best < node.rect.distanceSquaredTo(query)) return champ;
        // we'll need to set an actual best distance when we recur
        best = champ.distanceSquaredTo(query);
        // check whether a distance from query point to the traversed node less than
        // distance from current champion to query point
        double temp = node.p.distanceSquaredTo(query);
        if (temp < best) {
            best = temp;
            champ = node.p;
        }

        if (level % 2 == 0) { // search by y coordinate (node with horizontal partition line)
            // we compare y coordinate and decide go up or down
            if (node.p.y() < query.y()) { // if true go up
                champ = nearest(node.rt, query, champ, best, level + 1);
                // important case - when we traverse node and go back up through the tree
                // we need to decide whether we need to go down(left) in this node or not
                // we just check our bottom (left) node on null && compare distance
                // from query point to the nearest point of the node's rectangle and
                // the distance from current champ point to thr query point
                if (node.lb != null && node.lb.rect.distanceSquaredTo(query) < champ.distanceSquaredTo(query)) {
                    champ = nearest(node.lb, query, champ, best, level + 1);
                }

            }
            else { // if false go down
                champ = nearest(node.lb, query, champ, best, level + 1);
                if (node.rt != null && node.rt.rect.distanceSquaredTo(query) < champ.distanceSquaredTo(query))
                    // when we traverse node and go back up through the tree
                    // we need to decide whether we need to go up(right) in this node or not
                    // we just check our top (right) node on null && compare distance
                    // from query point to the nearest point of the node's rectangle and
                    // the distance from current champ point to thr query point
                    champ = nearest(node.rt, query, champ, best, level + 1);

            }

        }
        else {
            // search by x coordinate (node with vertical partition line)
            if (node.p.x() < query.x()) { // if true go right
                champ = nearest(node.rt, query, champ, best, level + 1);
                // the same check as mentioned above when we search by y coordinate
                if (node.lb != null && node.lb.rect.distanceSquaredTo(query) < champ.distanceSquaredTo(query))
                    champ = nearest(node.lb, query, champ, best, level + 1);
            }
            else { // if false go left
                champ = nearest(node.lb, query, champ, best, level + 1);
                  if (node.rt != null && node.rt.rect.distanceSquaredTo(query) < champ.distanceSquaredTo(query))
                     champ = nearest(node.rt, query, champ, best, level + 1);
            }
        }
        return champ;
    }

    public static void main(String[] args) {
        // unit tests
        KdTree kd = new KdTree();
        Point2D p1 = new Point2D(0.7, 0.2);
        Point2D p2 = new Point2D(0.5, 0.4);
        Point2D p3 = new Point2D(0.2, 0.3);
        Point2D p4 = new Point2D(0.4, 0.7);
        Point2D p5 = new Point2D(0.9, 0.6);
        // Point2D query = new Point2D(0.676, 0.736);
        Point2D query1 = new Point2D(0.972, 0.887);
        // RectHV test = new RectHV(0, 0, 0.7, 0.4);
        // Point2D query = new Point2D(0.331, 0.762);

        // Point2D p6 = new Point2D(0.4, 0.4);
        // Point2D p7 = new Point2D(0.1, 0.6);
        // RectHV rect = new RectHV(0.05, 0.1, 0.15, 0.6);

        kd.insert(p1);
        kd.insert(p2);
        kd.insert(p3);
        kd.insert(p4);
        kd.insert(p5);
        System.out.println(kd.nearest(query1));
        // System.out.println("Dist query to 0.4,0.7= " + query.distanceSquaredTo(p4));
        // System.out.println("Dist query to RectHV 0.2,0,3= " + test.distanceSquaredTo(p4));
        // kd.insert(p6);
        // kd.insert(p7);
        // System.out.println(kd.size);
        // System.out.println(kd.contains(p3));
        // // System.out.println(kd.range(rect));

        kd.draw();

    }
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-12-31T17:25:09.840

```
package kdtree;

class KDNode{
    KDNode left;
    KDNode right;
    int []data;

    public KDNode(){
        left=null;
        right=null;
    }

    public KDNode(int []x){
        left=null;
        right=null;
        data = new int[2];
        for (int k = 0; k < 2; k++)
            data[k]=x[k];
    }
}
class KDTreeImpl{
    KDNode root;
    int cd=0;
    int DIM=2;

    public KDTreeImpl() {
        root=null;
    }

    public boolean isEmpty(){
        return root == null;
    }

    public void insert(int []x){
        root = insert(x,root,cd);
    }
    private KDNode insert(int []x,KDNode t,int cd){
        if (t == null)
            t = new KDNode(x);
        else if (x[cd] < t.data[cd])
            t.left = insert(x, t.left, (cd+1)%DIM);
        else
            t.right = insert(x, t.right, (cd+1)%DIM);
        return t;
    }

    public boolean search(int []data){
        return search(data,root,0);
    }

    private boolean search(int []x,KDNode t,int cd){
        boolean found=false;
        if(t==null){
            return false;
        }
        else {
            if(x[cd]==t.data[cd]){
                if(x[0]==t.data[0] && x[1]==t.data[1]) 
                return true;
            }else if(x[cd]<t.data[cd]){
                found = search(x,t.left,(cd+1)%DIM);
            }else if(x[cd]>t.data[cd]){
                found = search(x,t.right,(cd+1)%DIM);
            }
            return found;
        }
    }

    public void inorder(){
        inorder(root);
    }
    private void inorder(KDNode r){
        if (r != null){
            inorder(r.left);
            System.out.print("("+r.data[0]+","+r.data[1] +") ");
            inorder(r.right);
        }
    }
    public void preorder() {
        preorder(root);
    }
    private void preorder(KDNode r){
        if (r != null){
            System.out.print("("+r.data[0]+","+r.data[1] +") ");
            preorder(r.left);             
            preorder(r.right);
        }
    }
    /* Function for postorder traversal */
    public void postorder() {
        postorder(root);
    }
    private void postorder(KDNode r) {
        if (r != null){
            postorder(r.left);             
            postorder(r.right);
            System.out.print("("+r.data[0]+","+r.data[1] +") ");
        }
    }
}
public class KDTree {

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        // TODO code application logic here
        KDTreeImpl kdt = new KDTreeImpl();
        int x[] = new int[2];
        x[0] = 30;
        x[1] = 40;
        kdt.insert(x);

        x[0] = 5;
        x[1] = 25;
        kdt.insert(x);

        x[0] = 10;
        x[1] = 12;
        kdt.insert(x);

        x[0] = 70;
        x[1] = 70;
        kdt.insert(x);

        x[0] = 50;
        x[1] = 30;
        kdt.insert(x);
        System.out.println("Input Elements");
        System.out.println("(30,40) (5,25) (10,12) (70,70) (50,30)\n\n");
        System.out.println("Printing KD Tree in Inorder");
        kdt.inorder();
        System.out.println("\nPrinting KD Tree in PreOder");
        kdt.preorder();
        System.out.println("\nPrinting KD Tree in PostOrder");
        kdt.postorder();
        System.out.println("\nsearching...............");
        x[0]=40;x[1]=40;
        System.out.println(kdt.search(x));
    }
} 
```

# c++ - 将 C++ 代码从 Windows 移植到 Mac

> ID：253768
> 
> 赞同：4
> 
> 时间：2008-10-31T14:45:07.740
> 
> 标签：c++, macos, cross-platform

我是一名长期的 Windows 开发人员，看起来我将参与将 Windows 应用程序移植到 Mac 上。

我们决定使用 Flex/Air 作为双方的 gui，顺便说一句，这看起来真的很漂亮。

我的 Windows 应用程序有一个控制网络适配器（有线和无线）的 C++ DLL。这是使用标准库和 Boost 编写的，所以大部分应该跨平台工作。

在 Mac 上，如果大多数人想编写 C++，他们会使用什么 IDE/编译器？此外，有人可以提供指向 Mac 拥有的任何可以控制 WiFi 适配器（关联、扫描、断开连接等）的 API 的指针吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-02T21:02:08.663

Xcode 是 Mac OS X 的 IDE，您可以通过免费在线会员加入 Apple Developer Connection 下载最新版本。

我不相信有任何受支持的 API 可用于控制无线网络适配器。最接近的是系统配置框架，但我不知道它是否能让你做你想做的一切。

此外，我强烈建议**不要**尝试使用 Flex/Air 来提升应用程序的用户体验。作为 Windows 开发人员，它在 Windows 上可能看起来很漂亮，但在提供完整的 Macintosh 用户体验时，此类技术并不总是一个不错的选择。

例如，我认为 Air 应用程序不支持所有 Mac OS X 文本编辑击键。虽然并非所有 Mac 用户都会使用所有击键，但对于那些习惯于尝试在不处理（例如）control-A 和 control-E 的文本字段中键入到字段的开头和结尾的人来说，就像游泳一样通过糖浆。

对于需要跨平台的新应用程序，我强烈考虑在 C++ 中构建核心逻辑，同时在 Mac 上使用 Cocoa 并在 Windows 上使用 WPF，以便在每个平台上获得最佳用户体验。Mac OS X 和 Windows 都拥有各自用户已经习惯的现代本机用户体验技术，并且还有 C++ 代码与这些技术互操作的好方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T14:46:38.983

事实上的 OS X IDE 和编译器是[Xcode](http://developer.apple.com/tools/xcode/)。它随每台 Mac 一起提供，您只需从 OS X 安装 CD 安装它。

[Apple 的开发者网站](http://developer.apple.com/mac/)是获取有关 OS X API 的更多信息的地方

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T14:47:15.113

我相信 Xcode 和自定义 GCC...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T15:00:47.800

Xcode 被大量使用，据我所知组合编辑器（例如[Textmate](http://macromates.com/)），命令行 gcc 也被大量使用。（这就是我在 OS X 上所做的）

对于所有 API 需求，请访问[Apple 的开发者网站](http://developer.apple.com)，例如[网络](http://developer.apple.com/referencelibrary/Networking/)API 的

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T15:13:10.583

正如人们已经指出的那样，xcode 是热点。

过去维护了一个 windows/mac 代码库，看看[MVC](http://en.wikipedia.org/wiki/Model_view_controller)。

只要您将后台逻辑与 UI 和特定于平台的内容（如文件处理、网络、绘制到屏幕等）区分开来。这样，当你将来想去 Linux 时，你只需要编写那些特定于平台的组件。

至于mac网络，你是在连接等层面吗？为什么不让操作系统来处理它，然后你就看看有哪些可用的连接？为什么要关心连接是有线的还是无线的？因为操作系统已经内置了很多这些工具，并且用户习惯于确保连接在那里工作，所以有一个额外的程序想要操纵网络似乎很奇怪。

# c# - 如何将连接表作为 linq to sql 中匿名返回类型的可枚举返回？

> ID：253780
> 
> 赞同：1
> 
> 时间：2008-10-31T14:48:11.103
> 
> 标签：c#, linq-to-sql

我想返回一个带有以下签名的对象

```
class AnonClass{
    string Name {get;}
    IEnumerable<Group> Groups {get;}
} 
```

我尝试了以下查询，但 g 只返回一个实体，而不是所有连接的实体

```
var q = from t in dc.Themes
join g in dc.Groups on t.K equals g.ThemeK 
select new {t.Name, Groups = g};
return q.ToArray(); 
```

但这会返回

```
class AnonClass{
   string Name {get;}
   Group Groups{get;}
} 
```

要使用的正确 linq 查询是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T14:53:35.477

我认为您想要“加入”而不仅仅是“加入”：

```
var q = from t in dc.Themes
        join g in dc.Groups on t.K equals g.ThemeK into groups
        select new { t.Name, Groups=groups }; 
```

（然而，这完全未经测试 - 值得一试，但请仔细验证！）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T14:54:54.083

如果您正确设置了外键，那么它应该是：

```
var q = from t in dc.Themes
select new {t.Name, Groups = t.Groups}; 
```

# debugging - 调试崩溃和内存泄漏

> ID：253782
> 
> 赞同：0
> 
> 时间：2008-10-31T14:48:18.327
> 
> 标签：debugging

我们正在为 Visual Basic 6.0 中的 Outlook 开发一个插件。我们一直面临诸如 Outlook 崩溃之类的问题（由于某些对象没有被破坏或其他原因）。我们解决这个问题的一种方法是阅读代码、注释代码（观察影响）、记录等。还有其他调试方法吗？是否有工具可以帮助我们了解内存中保存了哪些对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T14:57:09.087

您可以查看[适用于 Windows 的调试工具](http://www.microsoft.com/whdc/devtools/debugging/installx86.mspx#a)。

他们需要一点时间来适应，但故障转储可能非常有帮助......

# agile - SDLC 的敏捷与螺旋模型

> ID：253789
> 
> 赞同：26
> 
> 时间：2008-10-31T14:51:48.850
> 
> 标签：agile, methodology, sdlc

我相信敏捷不过是螺旋模型的另一种实现。我是 Spiral 的大力支持者（螺旋模型是一个软件开发过程，结合了设计和原型设计阶段的元素，努力结合自上而下和自下而上概念的优势），并且已经看到许多项目在不知道它们在螺旋世界中运行的情况下实施螺旋。从敏捷开始流行的那一天起，螺旋的概念就开始被忽视了。我确信对于复杂的项目螺旋仍然是最好的选择，但我想更好地了解敏捷和螺旋技术之间的异同。谁能解释他们的差异/相似之处？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-10-31T15:02:45.270

敏捷**是**螺旋式的。完全。部分原因是出于营销目的而更改了名称。

问题是螺旋往往意味着“预先设计大”——你计划出许多螺旋，每个螺旋都按风险顺序排列。然而，Spiral 并不是敏捷——它只是按风险顺序执行的增量执行。

敏捷增加的一大区别是“不要过度计划你还不知道的事情”。敏捷*是螺旋式的，但您一次只为**一个*增量创建详细计划。

敏捷还增加了很多其他的东西。螺旋是一种非常技术性的方法。然而，敏捷认识到技术是由人构建的。[敏捷宣言](http://agilemanifesto.org/)有四个原则，超越了 Boehm 的简单风险管理方法。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2008-10-31T15:07:24.933

在我看来，基本的区别在于，大多数 Spiral 开发模型仍然坚持大型的预先设计。重点是尽可能多地了解系统的使用方式；发现所有用例。一旦您了解了这些，您就可以设计系统并将其分解为遵循迭代的详细设计、实施、测试、重构设计循环的阶段。在敏捷中，他们是一些预先计划——也许是收集大粒度的理解（故事标题）——以便可以描述合理的发布，但是每个发布都是独立计划的，我们会延迟发现细节，直到我们准备好开始该版本的实施。我们期待改变，不要试图先了解一切。

另一个不同的是，大多数敏捷哲学都涉及“测试优先”的方法。这与螺旋式不同，螺旋式测试通常是一项自身的活动，并且测试不是在代码之前开发的。大多数情况下，它们是提前计划好的，但同时或在编码之后开发。许多敏捷方法坚持首先开发测试作为代码的规范。

它们的相似之处在于它们是迭代的。它们在迭代的实现和理解上有所不同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-31T15:47:26.163

我不是螺旋模型的专家，但从维基百科的定义来看，在我看来存在一些显着差异。

例如，在敏捷项目中，迭代结束时不会有原型，而是功能齐全、经过充分测试、潜在可部署 (1) 的系统，其中包含功能列表中优先级最高的功能。

在项目开始时收集的需求只是勉强可以开始（采取下一步），并且意味着在它们实际实施之前不久就被充实。欢迎更改要求。

此外，敏捷不仅仅是进行迭代开发——专注于面对面的对话而不是书面交流，专注于在日常工作中将业务人员和技术人员结合在一起。专注于协作最大化价值，而不是定义然后履行合同。

如果您还没有看到它，请查看[敏捷宣言](http://agilemanifesto.org)，它基本上是敏捷软件开发的定义。

(1) 这并不意味着部署系统必须具有*商业意义*，“只是”它在技术上是可行的。是否在迭代结束时部署系统应该是一个纯粹的业务决策。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-13T11:26:37.007

我相信敏捷是迭代 SDLC 的类型，而螺旋是增量 SDLC 的类型。Scrum 是敏捷的一种类型，其他是 DSDM/FDD/XP 等。瀑布之后的所有 SDLC 在一些不同的组合中遵循相同的一组行为（需求分析、设计、编码和测试）。所以顺序或迭代或增量中的基本动作集是相同的。

就敏捷和螺旋而言，两者都有共同的优势 1.更改需求处理 2.短期发布 3.由于 SDLC 的持续时间更短，风险管理很容易 4.跨团队帮助产品和项目顺利进行

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T15:03:16.253

首先，敏捷实际上是许多遵循相似理念的不同过程。使其与众不同的哲学之一是每次迭代都会产生一个工作产品。它可以被描述为迭代和增量。很多重点都放在工作产品和测试上。在许多敏捷模型中，测试先于编码。

在螺旋模型中，迭代次数是固定的，而敏捷模型的每个阶段可能包含任意次数的迭代。

你是对的，有相似之处，但潜在的哲学却有所不同。本页更详细[地](http://en.wikipedia.org/wiki/Agile_software_development)解释了敏捷与其他方法的比较。

你可以说敏捷过程是用例驱动的……非常强调人，最终用户。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-02-09T23:11:55.623

我想说螺旋和敏捷是相似的。然而，最近敏捷似乎经常成为为牛仔编码开脱的宣传系统。IE

*   极低的要求
*   最少的技术分析
*   最少的文档
*   没有代码注释
*   特别奖励——滥用领域驱动设计使对象模型过于复杂

这从来不是螺旋式的想法。我会争辩说这也不是敏捷的真正意义，尽管你会惊讶于我最近看到了多少次。 *越来越多有经验的开发人员/PM 开始看到在瀑布式和“敏捷”之间采用更平衡的方法的智慧——也许这只会让我们回到螺旋式。*

尽管在敏捷思维空间中有一些有用的想法，但它通常似乎来自那些拥有特别繁重/无用的软件设计方法的组织中的人，并且是对此的反应/过度反应。

# legacy - 您将如何维护遗留应用程序

> ID：253796
> 
> 赞同：6
> 
> 时间：2008-10-31T14:54:01.030
> 
> 标签：legacy

您将如何维护以下遗留应用程序：

1.  没有单元测试有大方法

2.  有很多重复的逻辑

3.  没有关注点分离
4.  有很多快速破解和硬编码字符串
5.  有过时和错误的文件
6.  **要求没有正确记录**！这实际上导致了过去测试人员、开发人员和客户之间的纠纷。当然还有一些非功能性的需求，比如不应该慢，不冲突以及其他应用程序用户知道的业务逻辑。但除了最常识性的场景和最常识性的业务工作流程之外，几乎没有关于应该（或不）做什么的指导。

？？？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-31T14:56:37.700

您需要[Michael C. Feathers 所著的《有效处理遗留代码》](https://rads.stackoverflow.com/amzn/click/com/0131177052)一书。

![替代文字](https://i.stack.imgur.com/hVs5x.jpg)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-10-31T14:56:12.320

尽快编写测试。最好根据要求（如果存在）。从功能测试开始。小块重构。每当你接触代码时，让它比刚开始时更干净、更好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T14:56:28.763

两件事情。

1.  有机会就编写单元测试。
2.  一旦你有足够的单元测试有信心，就开始重构。

您完成此操作的速度可能很慢......通常，您应该“只是维护它”而不是修复它。

但是，在“学习如何维护它”阶段，您可以编写大量单元测试。

然后，当发现错误并请求改进时，您可以添加更多测试。

它是敏捷的，适用于遗留问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-31T15:18:06.177

我已经看到，工作并且正在使用满足问题中提到的所有条件的代码库:-)

维护这个代码库的方法是**不破坏任何东西**。FWIW，代码**有效**，最终用户很高兴。没有人会听开发人员说存在重复代码、硬编码字符串等问题。我们只是抽出一些时间来修复任何可能的问题，并尽最大努力不引入新的错误。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T14:58:02.550

我想我会创建一小组最新信息：什么动作调用了哪些函数等。

从那里，我会考虑重构。Duplicated Logic 似乎是可以重构的东西，但请记住

*   当您意识到在多少个地方调用了逻辑时，这可能是一项艰巨的任务
*   看起来相似的两个函数可能有细微的差别，即 a - 而不是 +

我认为最大的抵制冲动是“重建整个该死的东西！” 并首先对系统进行概述，以揭开野兽的神秘面纱。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-10-31T15:01:31.543

须藤 rm -rf /

但更严重的是，我认为必须对其进行评估。如果代码一直是更改请求的来源，并且更改很困难，那么不久之后您就必须考虑是否值得尝试将系统重构/重新设计为更现代的东西。当然，这并不总是可行的，因此您通常最终会在团队中只有少数人负责维护遗留部分。尽可能让团队中的每个人都能够维护系统的所有部分......

我认为重要的另一件事是跟踪团队花费在遗留系统上进行维护/功能请求的时间和精力。在评估替换旧系统/组件的新工作计划时，这些指标可能令人信服。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-31T14:59:06.167

我基本上同意 Paul C 所说的一切。我不是 TDD 牧师，但无论何时你接触到遗留代码库——尤其是你不太熟悉的代码库——你需要有一个可靠的方法来重新测试并确保你遵循了 Hippocrates：首先， 不要伤害。测试，特别是好的单元测试和回归测试，是实现这一目标的唯一方法。

如果您不熟悉的代码库，我强烈建议您阅读[*Reversing: Secrets of Reverse Engineering Software 。*](https://rads.stackoverflow.com/amzn/click/com/0764574817)尽管这本书的深度超出了您当前的需求（以及我的需求），但它教会了我很多关于如何安全和理智地使用其他人的代码的知识。

# database - 有没有办法让 Documentum 使用基于字符的 Unicode 存储

> ID：253797
> 
> 赞同：1
> 
> 时间：2008-10-31T14:54:03.400
> 
> 标签：database, unicode, documentum

任何对 EMC Documentum 和 Oracle 有足够知识的人都知道是否可以在 oracle 之上设置一个 documentum 存储库，以便它使用基于字符的字段长度而不是基于字节的长度。

默认情况下，Documentum 似乎使用基于字节的字段，因此如果字段是 string(32)，它可以包含 32 个字节而不是字符。在这种情况下，一组由 32 个字符组成的 unicode 字符将被截断，因为它们超过 32 个字节。

有谁知道是否可以通过设置 Oracle 和 Documentum 设置来改变这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T00:45:51.550

不，这是不可能的。我对此进行了大量研究，因为在将 docbase 从 5.2.5 迁移到 5.3 后遇到了几个问题，并且有几个查询停止工作，并且我们在 webtop 中遇到截断错误，因为我们使用的是不受支持的字符集.

# language-agnostic - 在评估设计时，您如何评估复杂性？

> ID：253807
> 
> 赞同：6
> 
> 时间：2008-10-31T14:55:47.920
> 
> 标签：language-agnostic, architecture, complexity-theory

我们都知道要保持简单，对吧？

我已经看到复杂性被衡量为系统之间的交互次数，我想这是一个很好的起点。除了直觉之外，还有哪些其他（最好是更客观的）方法可以用来确定特定设计或软件的复杂程度？

您最喜欢的规则或启发式方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T15:03:50.230

这是我的：

1) 向了解问题但尚未考虑解决方案的人解释有多难？如果我向大厅里的某个人解释问题（如果他们在大厅里，他们可能已经理解了问题）并且可以解释解决方案，那么它不会太复杂。如果需要一个多小时，则很有可能解决方案过度设计。

2) 你必须在嵌套函数中走多远？如果我有一个对象需要由另一个对象持有的对象持有的属性，那么很有可能我正在尝试做的事情与对象本身相距太远。当试图使对象成为线程安全的时，这些情况会成为问题，因为从您当前的位置锁定许多不同深度的对象。

3）您是否正在尝试解决以前已经解决的问题？并非每个问题都是新问题（有些人会争辩说实际上没有）。您可以使用现有的模式或模式组吗？如果你不能，为什么不呢？制作自己的新解决方案很好，我完全赞成，但有时人们已经回答了这个问题。我不打算重写 STL（尽管我曾经尝试过），因为解决方案已经存在并且是一个很好的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T15:04:17.343

当我参加新英格兰复杂系统研究所 ( [http://necsi.org/](http://necsi.org/) ) 的复杂系统建模研讨会时，他们使用的衡量标准之一是系统状态的数量。

例如，如果您有两个交互的节点 A 和 B，并且每个节点都可以是 0 或 1，那么您可能的状态是：

```
A B
0 0
1 0
0 1
1 1 
```

因此，二进制组件之间只有 1 次交互的系统实际上可以导致 4 种不同的状态。关键是系统的复杂性不一定会随着交互次数的增加而线性增加。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-10-31T15:07:14.700

**可以通过耦合**以及所有对象的内**聚**性来估计复杂性。如果某些东西有太多的耦合或不够内聚，那么设计将开始变得更加复杂。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T15:11:55.347

好的措施也可以是文件的数量、配置存储位置的数量、某些语言的编译顺序。

例子：

.- 属性文件、数据库配置、保存相关信息的 xml 文件。

.- 数以万计的具有接口和数据库映射的类

.- 一个非常长且复杂的构建文件（build.xml、Makefile、其他..

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T19:08:02.233

最后，LOC 可以真正帮助测量的东西吗？:)

我认为复杂性最好被视为需要交互的事物的数量。

复杂的设计有 n 层，而简单的设计只有两层。

需要复杂性*来*解决简单性无法克服的问题，因此它并不总是一个问题。

通常定义复杂性存在问题，因为复杂性通常具有与之相关的任务。有些东西可能理解起来很复杂，但看起来很简单（例如非常简洁的代码） 将此网页从服务器获取到您的计算机的交互次数非常复杂，但 http 协议的抽象非常简单。

因此，在选择测量之前考虑一项任务（例如维护）可能会使其更有用。（即添加一个配置文件并将日志记录到应用程序会增加其客观复杂性[是的，只是有点确定]，但简化了维护）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T15:00:56.677

如果您的应用程序已构建，您可以根据时间（执行特定任务需要多长时间）或计算量（每次运行任务时执行多少代码）来衡量它。

如果您只有设计，那么您可以查看运行给定任务或运行普通任务需要多少设计组件。例如，如果您使用 MVC 作为您的设计模式，那么您至少需要 3 个组件来处理大多数任务，但根据您的设计实现，您最终可能会使用几十个组件（除了例如 3 层）。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-10-31T15:29:27.650

有正式的指标。例如，阅读[Cyclomatic Complexity](http://en.wikipedia.org/wiki/Cyclomatic_complexity)。

* * *

编辑。

另外，请查看[功能点](http://www.functionpoints.com/)。它们为您提供系统复杂性的非直觉定量测量。

# installation - MSI 引导：外部 URL

> ID：253810
> 
> 赞同：2
> 
> 时间：2008-10-31T14:56:34.050
> 
> 标签：installation, wix, windows-installer, bootstrapping

经过大量搜索，我找到了一些关于如何创建引导 msi 的描述，但这些解决方案都假定 msi 是本地的或标准的 Windows 组件。有没有办法制作一个使用普通 MSI 或 Wix 代码下载安装程序（这也是一个 msi）的 msi，而不是让引导程序执行一些非本地程序来这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T17:39:40.057

我将创建一个在 InstallUISequence 中运行的自定义操作。如有必要，这将下载 MSI（到源文件夹），然后尝试将其作为嵌套安装启动。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T15:12:46.857

我对 msi 的经验是不可能同时运行 2 个。（虽然可能是错的）

我最终做的是使用 Inno Setup ( [http://www.jrsoftware.org](http://www.jrsoftware.org) ) 和 ISTool ( [http://www.istool.org](http://www.istool.org) ) 制作一个安装程序 exe，下载并安装各种 msi。使用 ISTool 很容易做到。

我知道它不像 Wix 那样时尚或性感，但它对我很有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T03:04:40.303

Windows 会阻止两个安装`InstallExecuteSequence`同时进行，因此，如果您正在寻找带有引导程序的静默安装解决方案，那么您就是 SOL。

但是，您*可以*从 UI 序列开始另一个安装，这可能是一个不错的解决方案，只要您建议您的客户，如果他们要通过组策略或其他一些“静默”方法进行部署，则必须首先安装某些其他依赖项。

如果有帮助，我很确定您也可以使用 URL 调用 MSIEXEC，例如。`msiexec.exe /i http://some.domain/blah.msi /passive`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-18T22:34:44.610

我建议您编写一个本机应用程序并让它运行第一个 msi，然后运行 ​​seccons msi。我写了一篇关于如何做到这一点的博客。这是一个[链接](http://blog.foldertrack.com/?p=45)（[http://blog.foldertrack.com/?p=45](http://blog.foldertrack.com/?p=45)）

# keyboard - 带有 Emacs 或 VIM 的 Colemak 键盘

> ID：253820
> 
> 赞同：28
> 
> 时间：2008-10-31T14:58:22.347
> 
> 标签：keyboard, editor, keymapping, colemak

我一直在我的 TODO 清单上划掉一些东西。我最近拿起了Colemak。接下来我想学习 Vim 或 Emacs。我倾向于 Vim，但它的好处之一是坚持本垒打。有了Colemak，主排已经改变。我意识到我可以重新映射键，但是将功能分配给不同的字母对我来说并不是很有吸引力（如果字母与其功能之间存在任何关系。我知道运动不相关，但我不确定其余的.)

我不想开始一篇关于文本编辑器的争论文章，而是希望收到来自 Colemak（或 Dvorak）用户关于替代键映射和这两个编辑器的评论。

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2011-04-11T13:33:12.743

[我正在使用与Graham](https://stackoverflow.com/a/2190106/383793)类似的设置（上、下、左、右，是 hkjl (Qwerty hnyu)），但不是使用 noremap，而是在我的 .vimrc 中使用 langmap 重新映射：

```
set langmap=hk,jh,kj 
```

这具有改变使用这些移动键的其他命令（例如 g、z 和 Cw）的额外优势，而无需手动重新定义所有这些命令，即 C-wh 向上移动一个窗口，C-wk 向下移动一个窗口等。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-12-11T02:05:27.623

我最近切换到 Colemak，我也使用 Vim 作为我的主要编辑器。

我可以告诉你，没有必要重新映射移动键 - 或任何其他 Vim 键。你的大脑会很快学会移动键的新位置。对于助记键，**绝对**不需要重新映射 - 您希望将助记词的含义保留在键后面。

如果您重新映射 Vim 移动键，您将处于无法以任何实际效率操作普通 Vim 的不幸位置 - 例如，如果您需要通过 SSH 连接到服务器。我认为，对于大多数人来说，这比使用没有 Colemak 的计算机要普遍得多。

同样，有一天你可能会得到一些 Vim 插件，这些插件会与你的重新映射发生冲突，或者你有一天会阅读 Vim 提示，了解一项你现在无法使用的功能，因为你已经重新映射了一些东西。

这对你来说将是一个真正的痛苦，所以我不会为任何重新映射而烦恼。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-03T08:41:52.853

很高兴看到另一个 Colemak 用户 :)

对于 Emacs，真的不需要重新映射，因为最初的“快捷方式”并不是为了彼此靠近而设计的。如果有的话，在 Colemak 上使用 Emacs 会比在 Qwerty 上更舒服（至少我是这样）。

在 Vim 中，这要复杂得多，因为 hjkl 会完全搞砸。话又说回来，我一直觉得 hlkl 坏了，应该是 jkj；或ijkl，所以重新映射可能是一件好事。以下是 Colemak 论坛上有关 Colemak+Vim 的更广泛讨论：http: [//forum.colemak.com/viewtopic.php? id=50](http://forum.colemak.com/viewtopic.php?id=50)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-02-03T06:27:14.637

这在你的 .vimrc 中会改变 Colemak 的光标移动而不影响其他 vim 映射，因为它只影响 h/j/k 字母。

*   up = h（在键盘上标记为“h”）
*   down = k（在键盘上标记为“n”）
*   left = j（在键盘上标记为“y”）
*   right = l（在键盘上标记为“u”）

这是映射：

```
noremap h k
noremap j h
noremap k j 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-04T00:07:52.033

我已经和 Dvorak 一起跑了很多年了（大概 4 年左右）。我还使用 vim 的所有标准原因，您必须使用 vim 之类的东西（更少，具有自己的编辑器（visudo 等）的配置编辑等）。Emacs 实际上是我学习的第一个 Unix 程序（我是 Apple 世界的本地人），在被 Yegge 漫无边际地批评它有多棒之后，我现在把它捡回来了。

从严格的键盘布局立场来看，我会说 Emacs 可能是这里的赢家，因为不需要重新映射。除了将 Caps-Lock 键换成 Control 键（实际上应该这样做，Caps-Lock 键就像每个键盘的高中吻痕一样），我想说每个键绑定都更适合与 Dvorak 一起使用而不是与QWERTY。我特别发现经常使用的 Cx 和 Mx 绑定输入起来*非常*舒服。

不过，vim 真的没什么大不了的。“j”和“k”仍然紧挨着。'h' 和 'l' 至少一方面很方便，并且在主行之上。除此之外，它只是重新映射您脑海中的键，以便在编辑器中执行您希望发生的事情。我个人认为没有任何理由重新映射任何东西，而且我对 RSI 的风险很高（因此转向 Dvorak）。对于像 vim 和 emacs 这样的以键盘为中心的应用程序，我可以舒适地原封不动地使用它们这一事实应该是相当令人印象深刻的。:)

祝你好运！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-06-09T16:01:18.567

我正在使用 Ryan Heise 的 Vim 解决方案：

> 我想出了“NEST”导航绑定，它保留了上/下导航键的物理位置（左/右不同但仍在主行）：
> 
> N = 下 E = 上 S = 左 T = 右
> 
> 设置此命令的命令位于底部的 Colemak 页面上：
> 
> [http://www.ryanheise.com/colemak/](http://www.ryanheise.com/colemak/)
> 
> 大多数情况下，这些绑定允许您使用常规的 vim 备忘单来学习命令，当然导航除外。
> 
> 在 NEST 中分配的 4 个键中，“N”（“n”ext 搜索结果）和“E”（移动当前单词的“e”nd）频繁但被吞噬了。我将它们重新映射回原来的 QWERTY 位置，因此它们是仅有的两个没有原来的逻辑名称的命令。

取自[https://forum.colemak.com/topic/50-colemak-vim/p2/#p2514](https://forum.colemak.com/topic/50-colemak-vim/p2/#p2514)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-02T09:54:43.207

我是 vim+qwerty 用户（我尝试学习 dvorak，但事实证明打字速度不是我的速率限制因素，而且我没有 RSI 问题）。只有 vi(m) 中的 hjkl 光标移动键是位置相关的，其他的都是助记符。我在 Colemak 布局上看到，h/l 模糊地向左/向右，但 j/k 向下/向上。尽管如此，我怀疑这将是一个重大的绊脚石。您可以改用箭头键，或者继续使用 hjkl 并处理有趣的位置。

我不会倾向于尝试根据键盘布局重新映射 vim 功能。这对我来说似乎太多潜在的混乱。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-31T15:08:15.197

这是[以前的帖子](https://stackoverflow.com/questions/165231/vim-dvorak-keybindings-rebindings)，应该对您有所帮助。那里有一些讨论，一些用户不重新映射。有些人会。

实际上，我打算在周末重新映射。在过去的一年里，我一直使用默认映射，使用 Dvorak。

# delphi - 如何克服糟糕的 SSIS 调试性能？

> ID：253823
> 
> 赞同：3
> 
> 时间：2008-10-31T14:59:22.047
> 
> 标签：delphi, debugging, ssis

我正在使用 SSIS 在两个数据库之间同步数据。我过去使用过 SSIS 和 DTS，但我通常会为这种性质的事物编写应用程序（我是编码员，这对我来说更容易）。

在我的包中，我使用了一个返回大约 15,000 行的 SQL 任务。我已经将它连接到一个 Foreach 容器，并在其中将结果集列值分配给变量，然后将这些变量映射到提供给另一个 SQL 任务的参数。

我遇到的问题是调试，而不仅仅是更复杂的调试，如断点和运行时评估值。我的意思是，如果我在调试而不是不调试的情况下运行它，则需要数小时才能完成。我最终在 Delphi 中重写了该过程，以下是我想出的：

**完全推送数据：**
这会拉取 15,000 行，为每一行更新一个目标表，然后拉取 11,000 行并为每一行更新一个目标表。

*调试：*
Delphi App：139s
SSIS：4小时46分钟

*未调试：*
Delphi App：132s
SSIS： 384s

**数据更新：**
这会提取 3,000 行，但不需要或对目标表进行更新。然后它会提取 11,000 行，但同样不需要或对目标表进行更新。

*调试：*
Delphi App：42s
SSIS：1小时10分钟

*不调试：*
Delphi App：
34s SSIS：205s

奇怪的是，我感觉大部分时间都花在调试上，只是更新 Visual Studio 中的 UI 元素。如果我查看进度选项卡，每次迭代（总共数千个）都会将一个节点添加到树中，并且随着过程的进行，这会变得越来越慢。尝试停止调试通常不起作用，因为 Visual Studio 似乎陷入了更新 UI 的循环中。如果我检查 SQL Server 的探查器，则没有实际工作正在完成。我不确定这台机器是否重要，但它应该能胜任工作（四核、4 gig 内存、512 mb 视频卡）。

这种行为正常吗？正如我所说，我是一名编码员，所以我为这类事情编写应用程序没有问题（事实上，我编写应用程序所需的时间比在 SSIS 中“绘制”它要少得多，但我认为随着在 SSIS 中完成更多工作，边距会缩小），但我试图找出像 SSIS 和 DTS 这样的东西适合我的工具箱的位置。到目前为止，没有什么让我真正印象深刻。也许我以某种方式滥用或滥用 SSIS？

任何帮助将不胜感激，在此先感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T16:14:34.797

SSIS 控制流和循环的性能不是很高，并且不是为处理这些数据量而设计的。尤其是在调试期间 - 在每个任务执行之前和之后，调试器都会向设计进程发送通知，该进程会更新形状的颜色，这可能会很慢。

您可以使用数据流获得更好的性能。数据流不适用于单行，它与行缓冲区一起工作 - 速度更快，并且调试器只被通知缓冲区的开始/结束 - 所以它的影响不太明显。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-01T01:41:20.003

SSIS 的设计目的不是为了做这样的 foreach。如果您正在为每一行做一些事情，您可能希望将它们读入数据流，然后使用查找或合并连接，确定是执行 INSERT（这些是批量发生）还是执行多个 SQL UPDATE 的数据库命令对象命令（更好的执行选项是将这些批处理到临时表中并执行单个更新）。

在另一种典型的同步情况下，您将所有数据读入临时表，并对现有行执行 SQL Server UPDATE (INNER JOIN) 并在新行上执行 INSERT (LEFT JOIN, rhs IS NULL)。也有可能使用链接服务器，但连接可能会很慢，因为所有（或很多）数据可能必须通过网络传输。

我有定期导入 2400 万行的 SSIS 包，包括使用 TableDifference 组件处理数据转换和验证以及缓慢更改维度，与单独的客户端程序相比，它对于大量数据的执行速度相对较快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T15:09:44.977

我注意到这是一种行为，我有一个用于移动的 SSIS 包，它在大约 300 万个条目附近的某个地方进行了调试，因为它会运行大约 3-4 天。

SSIS 仍然是我这样做的方式，我只是不使用 SSIS“调试”，而是在使用完整数据集时运行它们。如果我必须调试，我会使用非常小的数据集。

# database - 什么是“普遍数据库”？

> ID：253824
> 
> 赞同：5
> 
> 时间：2008-10-31T14:59:31.720
> 
> 标签：database, definition, pervasive

对不起，但这个关键字对我没有任何意义......有人可以给我一个定义吗？

提前致谢...

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-10-31T15:02:21.700

这是一个品牌。 [http://pervasive.com/](http://www.pervasive.com/)这里是他们的数据库产品的链接[http://www.pervasivedb.com/Pages/PDBProducts.aspx](http://www.pervasivedb.com/Pages/PDBProducts.aspx)包括 Pervasive PSQL

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T15:03:19.653

你是说[Pervasive PSQL](http://ww2.pervasive.com/Database/Products/PSQLv10/Pages/PSQLOverview.aspx)吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T15:17:12.293

[eDeveloper](http://www.magicsoftware.com/)和以前的 Magic (4GL) 版本默认使用此数据库。

# sql - 基本 SQL 查询帮助

> ID：253832
> 
> 赞同：1
> 
> 时间：2008-10-31T15:02:37.890
> 
> 标签：sql, sql-server

我有一个有列的表

> 身份证、日期戳

并且 ID 不必是唯一的。

如何编写一个查询，它会给我一个具有最小 DateStamp 和最大 DateStamp 的 ID 列表？

因此，例如，对于给定的 ID，输出可能如下所示：

> 938423，2000 年 1 月 1 日，2003 年 12 月 13 日

[我正在运行 SQL Server 2000。]

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-10-31T15:04:04.207

以下应该做到这一点：

```
SELECT ID, MIN(DateStamp), MAX(DateStamp)
FROM TableName
GROUP BY ID 
```

**编辑**为清楚起见添加了 from 子句，请务必将 TableName 更改为实际的表名

# php - 在 php 中将 .doc 转换为 html

> ID：253834
> 
> 赞同：10
> 
> 时间：2008-10-31T15:02:59.497
> 
> 标签：php, html, ms-word

有没有人找到一个好的类，或者其他可以将 .doc 文件转换为 html 或我可以阅读并转换为 html 的文件？

我已经环顾了几个小时，只找到了需要在服务器上使用 msword 才能转换文件的文件。我很确定这不是一个选择，但我实际上并没有与我的托管服务提供商谈过这件事。

目标是让用户能够将文件上传到我的服务器，服务器处理转换，然后将其显示为 html，就像 google 将视图视为 html 功能一样。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-06-03T17:07:56.943

安装并使用 abiword，如下所示：

```
AbiWord --to=html archivo.doc 
```

您可以从 php.ini 调用此命令。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T11:33:31.987

一个名为 phpLiveDocx 的项目可以满足您的需求。它是基于 SOAP 的服务，但可以免费使用。基本介绍见： [http ://www.phplivedocx.org/articles/brief-introduction-to-phplivedocx/](http://www.phplivedocx.org/articles/brief-introduction-to-phplivedocx/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-27T11:01:55.620

在您的系统上安装 open office 并在命令行上运行它：

/usr/bin/soffice -headless "macro:///Standard.Convert.SaveAsHtml(test.doc)"

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-26T00:15:11.683

你可以通过 openoffice 使用 unoconv [http://dag.wieers.com/home-made/unoconv/](http://dag.wieers.com/home-made/unoconv/) 非常棒的工具。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-04T19:33:16.597

此 PHP 将您的 *.DOC 文件上传到上传文件夹并以 HTML 格式打开它。

```
<?php
function content($file){
$data_array = explode(chr(0x0D),fread(fopen($file, "r"), filesize($file)));
$data_text = "";
foreach($data_array as $data_line){
if (strpos($data_line, chr(0x00) !== false)||(strlen($data_line)==0))
{} else {if(chr(0)) {$data_text .= "<br>";
                      $data_text .= preg_replace("/[^a-zA-Z0-9\s\,\.\-\n\r\t@\/\_\(\)]/","",$data_line); 
       } 
   }        
}
return $data_text;}
$destination = str_replace('index.php', '', $_SERVER['SCRIPT_FILENAME']);
$destination.= "upload/";
$maxsize = 5120000;
if (isset($_GET['upload'])) {
      if($_FILES['userfile']['name'] && $_FILES['userfile']['size'] < $maxsize) {
      if(move_uploaded_file($_FILES['userfile']['tmp_name'], "$destination/".$_FILES['userfile']['name'])){
      $file = $destination."/".$_FILES['userfile']['name'];
      $data = content($file);
      echo $data;
        }   
         }
}else{
      echo "<form  enctype='multipart/form-data' method='post' action='index.php?upload'>
            <input name='userfile' type='file'>
            <input value='Upload' name='submit' type='submit'>
            </form>";
      }
?> 
```

# c# - 更新数据源时刷新 DataGridView

> ID：253843
> 
> 赞同：67
> 
> 时间：2008-10-31T15:05:17.463
> 
> 标签：c#, .net, winforms, datagridview

`DataGridView`更新基础数据源时刷新 a 的最佳方法是什么？

我经常更新数据源，并希望在结果发生时向用户显示结果。

我有这样的东西（并且它有效），但设置`DataGridView.DataSource`to`null`似乎不是正确的方法。

```
List<ItemState> itemStates = new List<ItemState>();
dataGridView1.DataSource = itemStates;

for (int i = 0; i < 10; i++) { 
    itemStates.Add(new ItemState { Id = i.ToString() });
    dataGridView1.DataSource = null;
    dataGridView1.DataSource = itemStates;
    System.Threading.Thread.Sleep(500);
} 
```

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-07-13T11:42:37.950

我自己遇到了这个。我的建议：如果您拥有数据源的所有权，请不要使用[List](https://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)。使用[BindingList](https://msdn.microsoft.com/en-us/library/ms132679(v=vs.110).aspx)。[BindingList](https://msdn.microsoft.com/en-us/library/ms132679(v=vs.110).aspx)具有在添加或更改项目时触发的事件，并且DataGridView[将](https://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.aspx)在触发这些事件时自动更新自身。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2008-10-31T15:40:20.937

好吧，没有比这更好的了。正式地，你应该使用

```
dataGridView1.DataSource = typeof(List); 
dataGridView1.DataSource = itemStates; 
```

它仍然是一种“清除/重置源”的解决方案，但我还没有找到任何可以可靠地刷新 DGV 数据源的东西。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2016-12-03T23:54:04.770

在这种情况下，最干净、最有效和范式友好的解决方案是使用 a`System.Windows.Forms.BindingSource`作为您的项目列表（数据源）和您的`DataGridView`:

```
var itemStates = new List<ItemState>();
var bindingSource1 = new System.Windows.Forms.BindingSource { DataSource = itemStates };
dataGridView1.DataSource = bindingSource1; 
```

然后，在添加项目时，使用`Add()`方法`BindingSource`而不是列表的`Add()`方法：

```
for (var i = 0; i < 10; i++)
{
    bindingSource1.Add(new ItemState { Id = i.ToString() });
    System.Threading.Thread.Sleep(500);
} 
```

通过这种方式，您可以将项目添加到列表中，并`DataGridView`使用同一行代码通知这些添加。每次更改列表时都`DataGridView`无需重新设置。`DataSource`

还值得一提的是，您可以`BindingSource`直接在 Visual Studio 的表单设计器中将 a 拖放到表单上，并将其作为数据源附加到您的表单中`DataGridView`，这样可以在上面的示例中为您节省一行代码，我正在手动执行此操作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-05-11T18:55:59.603

**Observablecollection**：表示一个动态数据集合，它在添加、删除项目或刷新整个列表时提供通知。您可以枚举实现 IEnumerable 接口的任何集合。但是，要设置动态绑定以便集合中的插入或删除自动更新 UI，集合必须实现 INotifyCollectionChanged 接口。此接口公开 CollectionChanged 事件，该事件应在基础集合更改时引发。

```
Observablecollection<ItemState> itemStates = new Observablecollection<ItemState>();

for (int i = 0; i < 10; i++) { 
    itemStates.Add(new ItemState { Id = i.ToString() });
  }
 dataGridView1.DataSource = itemStates; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-11T18:23:02.890

[这是从这个](https://stackoverflow.com/questions/21299016/how-to-refresh-or-show-immediately-in-datagridview-after-inserting/30174907)地方复制我的答案。

只需要像这样再次填充数据网格：

```
this.XXXTableAdapter.Fill(this.DataSet.XXX); 
```

如果您使用从 dataGridView 自动连接此代码在 Form_Load() 中自动创建

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-14T20:24:15.863

您在循环内设置数据源并在每次添加后休眠 500。为什么不直接添加到 itemstates 中，然后在添加完所有内容后设置数据源。如果你想让线程在那之后休眠。这里的第一块代码是你的，我修改的第二块。

```
for (int i = 0; i < 10; i++) { 
    itemStates.Add(new ItemState { Id = i.ToString() });
    dataGridView1.DataSource = null;
    dataGridView1.DataSource = itemStates;
    System.Threading.Thread.Sleep(500);
} 
```

**更改您的代码如下：**这要快得多。

```
for (int i = 0; i < 10; i++) { 
    itemStates.Add(new ItemState { Id = i.ToString() });

}
    dataGridView1.DataSource = typeof(List); 
    dataGridView1.DataSource = itemStates;
    System.Threading.Thread.Sleep(500); 
```

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2008-10-31T15:10:40.747

试试这个代码

```
List itemStates = new List();

for (int i = 0; i < 10; i++)
{ 
    itemStates.Add(new ItemState { Id = i.ToString() });
    dataGridView1.DataSource = itemStates;
    dataGridView1.DataBind();
    System.Threading.Thread.Sleep(500);
} 
```

# sql-server - 无法截断表，因为它被 FOREIGN KEY 约束引用？

> ID：253849
> 
> 赞同：537
> 
> 时间：2008-10-31T15:06:41.080
> 
> 标签：sql-server, sql-server-2005, tsql, truncate, foreign-keys

使用MSSQL2005，如果我先截断子表（具有FK关系的主键的表），是否可以截断具有外键约束的表？

我知道我可以

*   使用`DELETE`不带 where 子句的 a，然后`RESEED`使用标识（或）
*   删除 FK，截断表，然后重新创建 FK。

我认为只要我在父表之前截断子表，我就可以不执行上述任何一个选项，但是我收到了这个错误：

> 无法截断表“TableName”，因为它被 FOREIGN KEY 约束引用。

* * *

## 回答 #1

> 赞同：432
> 
> 时间：2008-10-31T15:08:47.490

正确的; 您不能截断具有 FK 约束的表。

通常我的过程是：

1.  放弃约束
2.  截断桌子
3.  重新创建约束。

（当然，一切都在交易中。）

当然，这只适用于*孩子已经被截断的情况。*否则我会走一条不同的路线，完全取决于我的数据是什么样的。（这里的变量太多了。）

原始发布者确定了为什么会这样；有关更多详细信息，请参阅[此答案](https://stackoverflow.com/questions/253849/cannot-truncate-table-because-it-is-being-referenced-by-a-foreign-key-constraint#253931)。

* * *

## 回答 #2

> 赞同：431
> 
> 时间：2012-08-02T20:01:43.857

```
DELETE FROM TABLENAME
DBCC CHECKIDENT ('DATABASENAME.dbo.TABLENAME', RESEED, 0) 
```

请注意，如果您有数百万条以上的记录，这可能不是您想要的，因为它非常慢。

* * *

## 回答 #3

> 赞同：237
> 
> 时间：2008-10-31T15:36:23.970

因为`TRUNCATE TABLE`是[DDL 命令](http://en.wikipedia.org/wiki/Data_definition_language "数据定义语言")，所以无法检查表中的记录是否被子表中的记录引用。

这就是为什么`DELETE`有效而`TRUNCATE TABLE`无效的原因：因为数据库能够确保它没有被另一条记录引用。

* * *

## 回答 #4

> 赞同：114
> 
> 时间：2014-07-11T20:41:07.913

没有`ALTER TABLE`

```
-- Delete all records
DELETE FROM [TableName]
-- Set current ID to "1"
-- If table already contains data, use "0"
-- If table is empty and never insert data, use "1"
-- Use SP https://github.com/reduardo7/TableTruncate
DBCC CHECKIDENT ([TableName], RESEED, 0) 
```

# 作为存储过程

[https://github.com/reduardo7/TableTruncate](https://github.com/reduardo7/TableTruncate)

**请注意**，如果您有数百万条以上的记录，这可能不是您想要的，因为它非常慢。

* * *

## 回答 #5

> 赞同：83
> 
> 时间：2012-11-06T10:37:11.370

上面提供的解决方案@denver_citizen 对我不起作用，但我喜欢它的精神，所以我修改了一些东西：

*   使它成为一个存储过程
*   改变了外键的填充和重新创建方式
*   原始脚本会截断所有引用的表，当被引用的表有其他外键引用时，这可能会导致外键冲突错误。此脚本仅截断指定为参数的表。由用户以正确的顺序在所有表上多次调用此存储过程

为了公众的利益，这里是更新的脚本：

```
CREATE PROCEDURE [dbo].[truncate_non_empty_table]

  @TableToTruncate                 VARCHAR(64)

AS 

BEGIN

SET NOCOUNT ON

-- GLOBAL VARIABLES
DECLARE @i int
DECLARE @Debug bit
DECLARE @Recycle bit
DECLARE @Verbose bit
DECLARE @TableName varchar(80)
DECLARE @ColumnName varchar(80)
DECLARE @ReferencedTableName varchar(80)
DECLARE @ReferencedColumnName varchar(80)
DECLARE @ConstraintName varchar(250)

DECLARE @CreateStatement varchar(max)
DECLARE @DropStatement varchar(max)   
DECLARE @TruncateStatement varchar(max)
DECLARE @CreateStatementTemp varchar(max)
DECLARE @DropStatementTemp varchar(max)
DECLARE @TruncateStatementTemp varchar(max)
DECLARE @Statement varchar(max)

        -- 1 = Will not execute statements 
 SET @Debug = 0
        -- 0 = Will not create or truncate storage table
        -- 1 = Will create or truncate storage table
 SET @Recycle = 0
        -- 1 = Will print a message on every step
 set @Verbose = 1

 SET @i = 1
    SET @CreateStatement = 'ALTER TABLE [dbo].[<tablename>]  WITH NOCHECK ADD  CONSTRAINT [<constraintname>] FOREIGN KEY([<column>]) REFERENCES [dbo].[<reftable>] ([<refcolumn>])'
    SET @DropStatement = 'ALTER TABLE [dbo].[<tablename>] DROP CONSTRAINT [<constraintname>]'
    SET @TruncateStatement = 'TRUNCATE TABLE [<tablename>]'

-- Drop Temporary tables

IF OBJECT_ID('tempdb..#FKs') IS NOT NULL
    DROP TABLE #FKs

-- GET FKs
SELECT ROW_NUMBER() OVER (ORDER BY OBJECT_NAME(parent_object_id), clm1.name) as ID,
       OBJECT_NAME(constraint_object_id) as ConstraintName,
       OBJECT_NAME(parent_object_id) as TableName,
       clm1.name as ColumnName, 
       OBJECT_NAME(referenced_object_id) as ReferencedTableName,
       clm2.name as ReferencedColumnName
  INTO #FKs
  FROM sys.foreign_key_columns fk
       JOIN sys.columns clm1 
         ON fk.parent_column_id = clm1.column_id 
            AND fk.parent_object_id = clm1.object_id
       JOIN sys.columns clm2
         ON fk.referenced_column_id = clm2.column_id 
            AND fk.referenced_object_id= clm2.object_id
 --WHERE OBJECT_NAME(parent_object_id) not in ('//tables that you do not wont to be truncated')
 WHERE OBJECT_NAME(referenced_object_id) = @TableToTruncate
 ORDER BY OBJECT_NAME(parent_object_id)

-- Prepare Storage Table
IF Not EXISTS(SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'Internal_FK_Definition_Storage')
   BEGIN
        IF @Verbose = 1
     PRINT '1\. Creating Process Specific Tables...'

  -- CREATE STORAGE TABLE IF IT DOES NOT EXISTS
  CREATE TABLE [Internal_FK_Definition_Storage] 
  (
   ID int not null identity(1,1) primary key,
   FK_Name varchar(250) not null,
   FK_CreationStatement varchar(max) not null,
   FK_DestructionStatement varchar(max) not null,
   Table_TruncationStatement varchar(max) not null
  ) 
   END 
ELSE
   BEGIN
        IF @Recycle = 0
            BEGIN
                IF @Verbose = 1
       PRINT '1\. Truncating Process Specific Tables...'

    -- TRUNCATE TABLE IF IT ALREADY EXISTS
    TRUNCATE TABLE [Internal_FK_Definition_Storage]    
      END
      ELSE
         PRINT '1\. Process specific table will be recycled from previous execution...'
   END

IF @Recycle = 0
   BEGIN

  IF @Verbose = 1
     PRINT '2\. Backing up Foreign Key Definitions...'

  -- Fetch and persist FKs             
  WHILE (@i <= (SELECT MAX(ID) FROM #FKs))
   BEGIN
    SET @ConstraintName = (SELECT ConstraintName FROM #FKs WHERE ID = @i)
    SET @TableName = (SELECT TableName FROM #FKs WHERE ID = @i)
    SET @ColumnName = (SELECT ColumnName FROM #FKs WHERE ID = @i)
    SET @ReferencedTableName = (SELECT ReferencedTableName FROM #FKs WHERE ID = @i)
    SET @ReferencedColumnName = (SELECT ReferencedColumnName FROM #FKs WHERE ID = @i)

    SET @DropStatementTemp = REPLACE(REPLACE(@DropStatement,'<tablename>',@TableName),'<constraintname>',@ConstraintName)
    SET @CreateStatementTemp = REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(@CreateStatement,'<tablename>',@TableName),'<column>',@ColumnName),'<constraintname>',@ConstraintName),'<reftable>',@ReferencedTableName),'<refcolumn>',@ReferencedColumnName)
    SET @TruncateStatementTemp = REPLACE(@TruncateStatement,'<tablename>',@TableName) 

    INSERT INTO [Internal_FK_Definition_Storage]
                        SELECT @ConstraintName, @CreateStatementTemp, @DropStatementTemp, @TruncateStatementTemp

    SET @i = @i + 1

    IF @Verbose = 1
       PRINT '  > Backing up [' + @ConstraintName + '] from [' + @TableName + ']'

    END   
    END   
    ELSE 
       PRINT '2\. Backup up was recycled from previous execution...'

       IF @Verbose = 1
     PRINT '3\. Dropping Foreign Keys...'

    -- DROP FOREING KEYS
    SET @i = 1
    WHILE (@i <= (SELECT MAX(ID) FROM [Internal_FK_Definition_Storage]))
          BEGIN
             SET @ConstraintName = (SELECT FK_Name FROM [Internal_FK_Definition_Storage] WHERE ID = @i)
    SET @Statement = (SELECT FK_DestructionStatement FROM [Internal_FK_Definition_Storage] WITH (NOLOCK) WHERE ID = @i)

    IF @Debug = 1 
       PRINT @Statement
    ELSE
       EXEC(@Statement)

    SET @i = @i + 1

    IF @Verbose = 1
       PRINT '  > Dropping [' + @ConstraintName + ']'

             END     

    IF @Verbose = 1
       PRINT '4\. Truncating Tables...'

    -- TRUNCATE TABLES
-- SzP: commented out as the tables to be truncated might also contain tables that has foreign keys
-- to resolve this the stored procedure should be called recursively, but I dont have the time to do it...          
 /*
    SET @i = 1
    WHILE (@i <= (SELECT MAX(ID) FROM [Internal_FK_Definition_Storage]))
          BEGIN

    SET @Statement = (SELECT Table_TruncationStatement FROM [Internal_FK_Definition_Storage] WHERE ID = @i)

    IF @Debug = 1 
       PRINT @Statement
    ELSE
       EXEC(@Statement)

    SET @i = @i + 1

    IF @Verbose = 1
       PRINT '  > ' + @Statement
          END
*/          

    IF @Verbose = 1
       PRINT '  > TRUNCATE TABLE [' + @TableToTruncate + ']'

    IF @Debug = 1 
        PRINT 'TRUNCATE TABLE [' + @TableToTruncate + ']'
    ELSE
        EXEC('TRUNCATE TABLE [' + @TableToTruncate + ']')

    IF @Verbose = 1
       PRINT '5\. Re-creating Foreign Keys...'

    -- CREATE FOREING KEYS
    SET @i = 1
    WHILE (@i <= (SELECT MAX(ID) FROM [Internal_FK_Definition_Storage]))
          BEGIN
             SET @ConstraintName = (SELECT FK_Name FROM [Internal_FK_Definition_Storage] WHERE ID = @i)
    SET @Statement = (SELECT FK_CreationStatement FROM [Internal_FK_Definition_Storage] WHERE ID = @i)

    IF @Debug = 1 
       PRINT @Statement
    ELSE
       EXEC(@Statement)

    SET @i = @i + 1

    IF @Verbose = 1
       PRINT '  > Re-creating [' + @ConstraintName + ']'

          END

    IF @Verbose = 1
       PRINT '6\. Process Completed'

END 
```

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2013-08-10T20:15:57.480

使用 delete 语句删除该表中的所有行后使用以下命令

```
delete from tablename

DBCC CHECKIDENT ('tablename', RESEED, 0) 
```

编辑：更正 SQL Server 的语法

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2014-01-29T16:37:55.167

好吧，因为我没有找到我使用的**非常简单的解决方案的***示例*，即：

 **1.  删除外键；
2.  截断表
3.  重新创建外键

它是这样的：

1) 查找导致失败的外键名称（例如：FK_PROBLEM_REASON, with field `ID`, from table `TABLE_OWNING_CONSTRAINT`） 2) 从表中删除该键：

```
ALTER TABLE TABLE_OWNING_CONSTRAINT DROP CONSTRAINT FK_PROBLEM_REASON 
```

3) 截断通缉表

```
TRUNCATE TABLE TABLE_TO_TRUNCATE 
```

4）将密钥重新添加到第一个表：

```
ALTER TABLE TABLE_OWNING_CONSTRAINT ADD CONSTRAINT FK_PROBLEM_REASON FOREIGN KEY(ID) REFERENCES TABLE_TO_TRUNCATE (ID) 
```

就是这样。

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2017-08-09T17:36:20.577

该过程是删除外键约束并截断表，然后通过以下步骤添加约束。

```
 SET FOREIGN_KEY_CHECKS = 0; 

    truncate table "yourTableName";

    SET FOREIGN_KEY_CHECKS = 1; 
```

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2013-12-09T05:25:24.567

您可以按照此步骤，通过`reseeding table`您可以删除表的数据。

```
delete from table_name
dbcc checkident('table_name',reseed,0) 
```

如果出现一些错误，那么您必须重新设置主表。

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2010-06-14T17:28:59.477

这是我为了自动化这个过程而编写的一个脚本。我希望它有所帮助。

```
SET NOCOUNT ON

-- GLOBAL VARIABLES
DECLARE @i int
DECLARE @Debug bit
DECLARE @Recycle bit
DECLARE @Verbose bit
DECLARE @TableName varchar(80)
DECLARE @ColumnName varchar(80)
DECLARE @ReferencedTableName varchar(80)
DECLARE @ReferencedColumnName varchar(80)
DECLARE @ConstraintName varchar(250)

DECLARE @CreateStatement varchar(max)
DECLARE @DropStatement varchar(max)   
DECLARE @TruncateStatement varchar(max)
DECLARE @CreateStatementTemp varchar(max)
DECLARE @DropStatementTemp varchar(max)
DECLARE @TruncateStatementTemp varchar(max)
DECLARE @Statement varchar(max)

        -- 1 = Will not execute statements 
 SET @Debug = 0
        -- 0 = Will not create or truncate storage table
        -- 1 = Will create or truncate storage table
 SET @Recycle = 0
        -- 1 = Will print a message on every step
 set @Verbose = 1

 SET @i = 1
    SET @CreateStatement = 'ALTER TABLE [dbo].[<tablename>]  WITH NOCHECK ADD  CONSTRAINT [<constraintname>] FOREIGN KEY([<column>]) REFERENCES [dbo].[<reftable>] ([<refcolumn>])'
    SET @DropStatement = 'ALTER TABLE [dbo].[<tablename>] DROP CONSTRAINT [<constraintname>]'
    SET @TruncateStatement = 'TRUNCATE TABLE [<tablename>]'

-- Drop Temporary tables
DROP TABLE #FKs

-- GET FKs
SELECT ROW_NUMBER() OVER (ORDER BY OBJECT_NAME(parent_object_id), clm1.name) as ID,
       OBJECT_NAME(constraint_object_id) as ConstraintName,
       OBJECT_NAME(parent_object_id) as TableName,
       clm1.name as ColumnName, 
       OBJECT_NAME(referenced_object_id) as ReferencedTableName,
       clm2.name as ReferencedColumnName
  INTO #FKs
  FROM sys.foreign_key_columns fk
       JOIN sys.columns clm1 
         ON fk.parent_column_id = clm1.column_id 
            AND fk.parent_object_id = clm1.object_id
       JOIN sys.columns clm2
         ON fk.referenced_column_id = clm2.column_id 
            AND fk.referenced_object_id= clm2.object_id
 WHERE OBJECT_NAME(parent_object_id) not in ('//tables that you do not wont to be truncated')
 ORDER BY OBJECT_NAME(parent_object_id)

-- Prepare Storage Table
IF Not EXISTS(SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = 'Internal_FK_Definition_Storage')
   BEGIN
        IF @Verbose = 1
     PRINT '1\. Creating Process Specific Tables...'

  -- CREATE STORAGE TABLE IF IT DOES NOT EXISTS
  CREATE TABLE [Internal_FK_Definition_Storage] 
  (
   ID int not null identity(1,1) primary key,
   FK_Name varchar(250) not null,
   FK_CreationStatement varchar(max) not null,
   FK_DestructionStatement varchar(max) not null,
   Table_TruncationStatement varchar(max) not null
  ) 
   END 
ELSE
   BEGIN
        IF @Recycle = 0
            BEGIN
                IF @Verbose = 1
       PRINT '1\. Truncating Process Specific Tables...'

    -- TRUNCATE TABLE IF IT ALREADY EXISTS
    TRUNCATE TABLE [Internal_FK_Definition_Storage]    
      END
      ELSE
         PRINT '1\. Process specific table will be recycled from previous execution...'
   END

IF @Recycle = 0
   BEGIN

  IF @Verbose = 1
     PRINT '2\. Backing up Foreign Key Definitions...'

  -- Fetch and persist FKs             
  WHILE (@i <= (SELECT MAX(ID) FROM #FKs))
   BEGIN
    SET @ConstraintName = (SELECT ConstraintName FROM #FKs WHERE ID = @i)
    SET @TableName = (SELECT TableName FROM #FKs WHERE ID = @i)
    SET @ColumnName = (SELECT ColumnName FROM #FKs WHERE ID = @i)
    SET @ReferencedTableName = (SELECT ReferencedTableName FROM #FKs WHERE ID = @i)
    SET @ReferencedColumnName = (SELECT ReferencedColumnName FROM #FKs WHERE ID = @i)

    SET @DropStatementTemp = REPLACE(REPLACE(@DropStatement,'<tablename>',@TableName),'<constraintname>',@ConstraintName)
    SET @CreateStatementTemp = REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(@CreateStatement,'<tablename>',@TableName),'<column>',@ColumnName),'<constraintname>',@ConstraintName),'<reftable>',@ReferencedTableName),'<refcolumn>',@ReferencedColumnName)
    SET @TruncateStatementTemp = REPLACE(@TruncateStatement,'<tablename>',@TableName) 

    INSERT INTO [Internal_FK_Definition_Storage]
                        SELECT @ConstraintName, @CreateStatementTemp, @DropStatementTemp, @TruncateStatementTemp

    SET @i = @i + 1

    IF @Verbose = 1
       PRINT '  > Backing up [' + @ConstraintName + '] from [' + @TableName + ']'

   END
    END   
    ELSE 
       PRINT '2\. Backup up was recycled from previous execution...'

       IF @Verbose = 1
     PRINT '3\. Dropping Foreign Keys...'

    -- DROP FOREING KEYS
    SET @i = 1
    WHILE (@i <= (SELECT MAX(ID) FROM [Internal_FK_Definition_Storage]))
          BEGIN
             SET @ConstraintName = (SELECT FK_Name FROM [Internal_FK_Definition_Storage] WHERE ID = @i)
    SET @Statement = (SELECT FK_DestructionStatement FROM [Internal_FK_Definition_Storage] WITH (NOLOCK) WHERE ID = @i)

    IF @Debug = 1 
       PRINT @Statement
    ELSE
       EXEC(@Statement)

    SET @i = @i + 1

    IF @Verbose = 1
       PRINT '  > Dropping [' + @ConstraintName + ']'
             END     

    IF @Verbose = 1
       PRINT '4\. Truncating Tables...'

    -- TRUNCATE TABLES
    SET @i = 1
    WHILE (@i <= (SELECT MAX(ID) FROM [Internal_FK_Definition_Storage]))
          BEGIN
    SET @Statement = (SELECT Table_TruncationStatement FROM [Internal_FK_Definition_Storage] WHERE ID = @i)

    IF @Debug = 1 
       PRINT @Statement
    ELSE
       EXEC(@Statement)

    SET @i = @i + 1

    IF @Verbose = 1
       PRINT '  > ' + @Statement
          END

    IF @Verbose = 1
       PRINT '5\. Re-creating Foreign Keys...'

    -- CREATE FOREING KEYS
    SET @i = 1
    WHILE (@i <= (SELECT MAX(ID) FROM [Internal_FK_Definition_Storage]))
          BEGIN
             SET @ConstraintName = (SELECT FK_Name FROM [Internal_FK_Definition_Storage] WHERE ID = @i)
    SET @Statement = (SELECT FK_CreationStatement FROM [Internal_FK_Definition_Storage] WHERE ID = @i)

    IF @Debug = 1 
       PRINT @Statement
    ELSE
       EXEC(@Statement)

    SET @i = @i + 1

    IF @Verbose = 1
       PRINT '  > Re-creating [' + @ConstraintName + ']'
          END

    IF @Verbose = 1
       PRINT '6\. Process Completed' 
```

* * *

## 回答 #11

> 赞同：10
> 
> 时间：2019-01-24T19:11:16.293

@denver_citizen 和 @Peter Szanto 的答案对我来说不太管用，但我修改了它们以说明：

1.  复合键
2.  删除和更新操作
3.  重新添加时检查索引
4.  dbo 以外的模式
5.  一次多张桌子

```
DECLARE @Debug bit = 0;

-- List of tables to truncate
select
    SchemaName, Name
into #tables
from (values 
    ('schema', 'table')
    ,('schema2', 'table2')
) as X(SchemaName, Name)

BEGIN TRANSACTION TruncateTrans;

with foreignKeys AS (
     SELECT 
        SCHEMA_NAME(fk.schema_id) as SchemaName
        ,fk.Name as ConstraintName
        ,OBJECT_NAME(fk.parent_object_id) as TableName
        ,SCHEMA_NAME(t.SCHEMA_ID) as ReferencedSchemaName
        ,OBJECT_NAME(fk.referenced_object_id) as ReferencedTableName
        ,fc.constraint_column_id
        ,COL_NAME(fk.parent_object_id, fc.parent_column_id) AS ColumnName
        ,COL_NAME(fk.referenced_object_id, fc.referenced_column_id) as ReferencedColumnName
        ,fk.delete_referential_action_desc
        ,fk.update_referential_action_desc
    FROM sys.foreign_keys AS fk
        JOIN sys.foreign_key_columns AS fc
            ON fk.object_id = fc.constraint_object_id
        JOIN #tables tbl 
            ON OBJECT_NAME(fc.referenced_object_id) = tbl.Name
        JOIN sys.tables t on OBJECT_NAME(t.object_id) = tbl.Name 
            and SCHEMA_NAME(t.schema_id) = tbl.SchemaName
            and t.OBJECT_ID = fc.referenced_object_id
)

select
    quotename(fk.ConstraintName) AS ConstraintName
    ,quotename(fk.SchemaName) + '.' + quotename(fk.TableName) AS TableName
    ,quotename(fk.ReferencedSchemaName) + '.' + quotename(fk.ReferencedTableName) AS ReferencedTableName
    ,replace(fk.delete_referential_action_desc, '_', ' ') AS DeleteAction
    ,replace(fk.update_referential_action_desc, '_', ' ') AS UpdateAction
    ,STUFF((
        SELECT ',' + quotename(fk2.ColumnName)
        FROM foreignKeys fk2 
        WHERE fk2.ConstraintName = fk.ConstraintName and fk2.SchemaName = fk.SchemaName
        ORDER BY fk2.constraint_column_id
        FOR XML PATH('')
    ),1,1,'') AS ColumnNames
    ,STUFF((
        SELECT ',' + quotename(fk2.ReferencedColumnName)
        FROM foreignKeys fk2 
        WHERE fk2.ConstraintName = fk.ConstraintName and fk2.SchemaName = fk.SchemaName
        ORDER BY fk2.constraint_column_id
        FOR XML PATH('')
    ),1,1,'') AS ReferencedColumnNames
into #FKs
from foreignKeys fk
GROUP BY fk.SchemaName, fk.ConstraintName, fk.TableName, fk.ReferencedSchemaName, fk.ReferencedTableName, fk.delete_referential_action_desc, fk.update_referential_action_desc

-- Drop FKs
select 
    identity(int,1,1) as ID,
    'ALTER TABLE ' + fk.TableName + ' DROP CONSTRAINT ' + fk.ConstraintName AS script
into #scripts
from #FKs fk

-- Truncate 
insert into #scripts
select distinct 
    'TRUNCATE TABLE ' + quotename(tbl.SchemaName) + '.' + quotename(tbl.Name) AS script
from #tables tbl

-- Recreate
insert into #scripts
select 
    'ALTER TABLE ' + fk.TableName + 
    ' WITH CHECK ADD CONSTRAINT ' + fk.ConstraintName + 
    ' FOREIGN KEY ('+ fk.ColumnNames +')' + 
    ' REFERENCES ' + fk.ReferencedTableName +' ('+ fk.ReferencedColumnNames +')' +
    ' ON DELETE ' + fk.DeleteAction COLLATE Latin1_General_CI_AS_KS_WS + ' ON UPDATE ' + fk.UpdateAction COLLATE Latin1_General_CI_AS_KS_WS AS script
from #FKs fk

DECLARE @script nvarchar(MAX);

DECLARE curScripts CURSOR FOR 
    select script
    from #scripts
    order by ID

OPEN curScripts

WHILE 1=1 BEGIN
    FETCH NEXT FROM curScripts INTO @script
    IF @@FETCH_STATUS != 0 BREAK;

    print @script;
    IF @Debug = 0
        EXEC (@script);
END
CLOSE curScripts
DEALLOCATE curScripts

drop table #scripts
drop table #FKs
drop table #tables

COMMIT TRANSACTION TruncateTrans; 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2010-05-06T06:33:34.937

如果我理解正确，您*要做*的是为涉及集成测试的数据库设置一个干净的环境。

我在这里的方法是删除整个模式并稍后重新创建它。

### 原因：

1.  您可能已经有一个“创建模式”脚本。重新使用它进行测试隔离很容易。
2.  创建模式非常快。
3.  使用这种方法，很容易设置您的脚本，让每个夹具创建一个新模式（使用临时名称），然后您可以开始并行运行测试夹具，从而使测试套件中最慢的部分更快.

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2013-07-18T18:58:58.763

如果不删除约束，则不能截断表。禁用也不起作用。你需要放弃一切。我制作了一个脚本，删除所有约束，然后重新创建。

请务必将其包装在事务中；）

```
SET NOCOUNT ON
GO

DECLARE @table TABLE(
RowId INT PRIMARY KEY IDENTITY(1, 1),
ForeignKeyConstraintName NVARCHAR(200),
ForeignKeyConstraintTableSchema NVARCHAR(200),
ForeignKeyConstraintTableName NVARCHAR(200),
ForeignKeyConstraintColumnName NVARCHAR(200),
PrimaryKeyConstraintName NVARCHAR(200),
PrimaryKeyConstraintTableSchema NVARCHAR(200),
PrimaryKeyConstraintTableName NVARCHAR(200),
PrimaryKeyConstraintColumnName NVARCHAR(200)
)

INSERT INTO @table(ForeignKeyConstraintName, ForeignKeyConstraintTableSchema, ForeignKeyConstraintTableName, ForeignKeyConstraintColumnName)
SELECT
U.CONSTRAINT_NAME,
U.TABLE_SCHEMA,
U.TABLE_NAME,
U.COLUMN_NAME
FROM
INFORMATION_SCHEMA.KEY_COLUMN_USAGE U
INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS C
ON U.CONSTRAINT_NAME = C.CONSTRAINT_NAME
WHERE
C.CONSTRAINT_TYPE = 'FOREIGN KEY'

UPDATE @table SET
PrimaryKeyConstraintName = UNIQUE_CONSTRAINT_NAME
FROM
@table T
INNER JOIN INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS R
ON T.ForeignKeyConstraintName = R.CONSTRAINT_NAME

UPDATE @table SET
PrimaryKeyConstraintTableSchema = TABLE_SCHEMA,
PrimaryKeyConstraintTableName = TABLE_NAME
FROM @table T
INNER JOIN INFORMATION_SCHEMA.TABLE_CONSTRAINTS C
ON T.PrimaryKeyConstraintName = C.CONSTRAINT_NAME

UPDATE @table SET
PrimaryKeyConstraintColumnName = COLUMN_NAME
FROM @table T
INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE U
ON T.PrimaryKeyConstraintName = U.CONSTRAINT_NAME

--DROP CONSTRAINT:

DECLARE @dynSQL varchar(MAX);

DECLARE cur CURSOR FOR
SELECT
'
ALTER TABLE [' + ForeignKeyConstraintTableSchema + '].[' + ForeignKeyConstraintTableName + ']
DROP CONSTRAINT ' + ForeignKeyConstraintName + '
'
FROM
@table

OPEN cur

FETCH cur into @dynSQL
WHILE @@FETCH_STATUS = 0 
BEGIN
    exec(@dynSQL)
    print @dynSQL

    FETCH cur into @dynSQL
END
CLOSE cur
DEALLOCATE cur
---------------------

   --HERE GOES YOUR TRUNCATES!!!!!
   --HERE GOES YOUR TRUNCATES!!!!!
   --HERE GOES YOUR TRUNCATES!!!!!

    truncate table your_table

   --HERE GOES YOUR TRUNCATES!!!!!
   --HERE GOES YOUR TRUNCATES!!!!!
   --HERE GOES YOUR TRUNCATES!!!!!

---------------------
--ADD CONSTRAINT:

DECLARE cur2 CURSOR FOR
SELECT
'
ALTER TABLE [' + ForeignKeyConstraintTableSchema + '].[' + ForeignKeyConstraintTableName + ']
ADD CONSTRAINT ' + ForeignKeyConstraintName + ' FOREIGN KEY(' + ForeignKeyConstraintColumnName + ') REFERENCES [' + PrimaryKeyConstraintTableSchema + '].[' + PrimaryKeyConstraintTableName + '](' + PrimaryKeyConstraintColumnName + ')
'
FROM
@table

OPEN cur2

FETCH cur2 into @dynSQL
WHILE @@FETCH_STATUS = 0 
BEGIN
    exec(@dynSQL)

    print @dynSQL

    FETCH cur2 into @dynSQL
END
CLOSE cur2
DEALLOCATE cur2 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2011-03-03T05:46:40.440

在网上其他地方找到

```
EXEC sp_MSForEachTable 'ALTER TABLE ? NOCHECK CONSTRAINT ALL'
EXEC sp_MSForEachTable 'ALTER TABLE ? DISABLE TRIGGER ALL'
-- EXEC sp_MSForEachTable 'DELETE FROM ?' -- Uncomment to execute
EXEC sp_MSForEachTable 'ALTER TABLE ? CHECK CONSTRAINT ALL'
EXEC sp_MSForEachTable 'ALTER TABLE ? ENABLE TRIGGER ALL' 
```

* * *

## 回答 #15

> 赞同：5
> 
> 时间：2016-03-24T19:20:01.620

truncate 对我不起作用，delete + reseed 是最好的出路。如果有些人需要迭代大量表来执行删除+重新种子，您可能会遇到一些没有标识列的表的问题，以下代码在尝试之前检查标识列是否存在重新播种

```
 EXEC ('DELETE FROM [schemaName].[tableName]')
    IF EXISTS (Select * from sys.identity_columns where object_name(object_id) = 'tableName')
    BEGIN
        EXEC ('DBCC CHECKIDENT ([schemaName.tableName], RESEED, 0)')
    END 
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2017-07-25T01:47:23.420

我编写了以下方法并尝试将它们参数化，以便**您可以****轻松地**运行它们`Query document`或**使它们变得有用`SP`**。

## A) 删除

**如果**您的表**没有数百万条记录，**这很好用并且**没有任何 Alter 命令**：

```
---------------------------------------------------------------
------------------- Just Fill Parameters Value ----------------
---------------------------------------------------------------
DECLARE @DbName AS NVARCHAR(30) = 'MyDb'         --< Db Name
DECLARE @Schema AS NVARCHAR(30) = 'dbo'          --< Schema
DECLARE @TableName AS NVARCHAR(30) = 'Book'      --< Table Name
------------------ /Just Fill Parameters Value ----------------

DECLARE @Query AS NVARCHAR(500) = 'Delete FROM ' + @TableName

EXECUTE sp_executesql @Query
SET @Query=@DbName+'.'+@Schema+'.'+@TableName
DBCC CHECKIDENT (@Query,RESEED, 0) 
```

> *   在我的上述答案中，解决问题中提到的问题的方法基于*@s15199d* [答案](https://stackoverflow.com/questions/253849/cannot-truncate-table-because-it-is-being-referenced-by-a-foreign-key-constraint#253931)。

## B) 截断

**如果**您的表**有数百万条记录，或者您的代码中的****Alter 命令**没有任何问题，请使用以下命令：

```
--   Book                               Student
--
--   |  BookId  | Field1 |              | StudentId |  BookId  |
--   ---------------------              ------------------------ 
--   |    1     |    A   |              |     2     |    1     |  
--   |    2     |    B   |              |     1     |    1     |
--   |    3     |    C   |              |     2     |    3     |  

---------------------------------------------------------------
------------------- Just Fill Parameters Value ----------------
---------------------------------------------------------------
DECLARE @DbName AS NVARCHAR(30) = 'MyDb'
DECLARE @Schema AS NVARCHAR(30) = 'dbo'
DECLARE @TableName_ToTruncate AS NVARCHAR(30) = 'Book'

DECLARE @TableName_OfOwnerOfConstraint AS NVARCHAR(30) = 'Student' --< Decelations About FK_Book_Constraint
DECLARE @Ref_ColumnName_In_TableName_ToTruncate AS NVARCHAR(30) = 'BookId' --< Decelations About FK_Book_Constraint
DECLARE @FK_ColumnName_In_TableOfOwnerOfConstraint AS NVARCHAR(30) = 'Fk_BookId' --< Decelations About FK_Book_Constraint
DECLARE @FK_ConstraintName AS NVARCHAR(30) = 'FK_Book_Constraint'                --< Decelations About FK_Book_Constraint
------------------ /Just Fill Parameters Value ----------------

DECLARE @Query AS NVARCHAR(2000)

SET @Query= 'ALTER TABLE '+@TableName_OfOwnerOfConstraint+' DROP CONSTRAINT '+@FK_ConstraintName
EXECUTE sp_executesql @Query

SET @Query= 'Truncate Table '+ @TableName_ToTruncate
EXECUTE sp_executesql @Query

SET @Query= 'ALTER TABLE '+@TableName_OfOwnerOfConstraint+' ADD CONSTRAINT '+@FK_ConstraintName+' FOREIGN KEY('+@FK_ColumnName_In_TableOfOwnerOfConstraint+') REFERENCES '+@TableName_ToTruncate+'('+@Ref_ColumnName_In_TableName_ToTruncate+')'
EXECUTE sp_executesql @Query 
```

> *   在我的上述答案中，解决问题中提到的问题的方法基于*@LauroWolffValenteSobrinho* [答案](https://stackoverflow.com/questions/253849/cannot-truncate-table-because-it-is-being-referenced-by-a-foreign-key-constraint#21437099)。
>     
>     
> *   如果你有多个 CONSTRAINT 那么你应该像我一样将它的代码附加到上面的查询中
>     
>     
> *   您还可以更改上面的代码库*@SerjSagan* [答案](https://stackoverflow.com/questions/253849/cannot-truncate-table-because-it-is-being-referenced-by-a-foreign-key-constraint#17916304)以禁用启用约束

* * *

## 回答 #17

> 赞同：4
> 
> 时间：2020-03-27T17:39:15.117

唯一的方法是在截断之前删除外键。并且在截断数据后，您必须重新创建索引。

以下脚本生成删除所有外键约束所需的 SQL。

```
DECLARE @drop NVARCHAR(MAX) = N'';

SELECT @drop += N'
ALTER TABLE ' + QUOTENAME(cs.name) + '.' + QUOTENAME(ct.name) 
    + ' DROP CONSTRAINT ' + QUOTENAME(fk.name) + ';'
FROM sys.foreign_keys AS fk
INNER JOIN sys.tables AS ct
  ON fk.parent_object_id = ct.[object_id]
INNER JOIN sys.schemas AS cs 
  ON ct.[schema_id] = cs.[schema_id];

SELECT @drop 
```

接下来，以下脚本生成重新创建外键所需的 SQL。

```
DECLARE @create NVARCHAR(MAX) = N'';

SELECT @create += N'
ALTER TABLE ' 
   + QUOTENAME(cs.name) + '.' + QUOTENAME(ct.name) 
   + ' ADD CONSTRAINT ' + QUOTENAME(fk.name) 
   + ' FOREIGN KEY (' + STUFF((SELECT ',' + QUOTENAME(c.name)
   -- get all the columns in the constraint table
    FROM sys.columns AS c 
    INNER JOIN sys.foreign_key_columns AS fkc 
    ON fkc.parent_column_id = c.column_id
    AND fkc.parent_object_id = c.[object_id]
    WHERE fkc.constraint_object_id = fk.[object_id]
    ORDER BY fkc.constraint_column_id 
    FOR XML PATH(N''), TYPE).value(N'.[1]', N'nvarchar(max)'), 1, 1, N'')
  + ') REFERENCES ' + QUOTENAME(rs.name) + '.' + QUOTENAME(rt.name)
  + '(' + STUFF((SELECT ',' + QUOTENAME(c.name)
   -- get all the referenced columns
    FROM sys.columns AS c 
    INNER JOIN sys.foreign_key_columns AS fkc 
    ON fkc.referenced_column_id = c.column_id
    AND fkc.referenced_object_id = c.[object_id]
    WHERE fkc.constraint_object_id = fk.[object_id]
    ORDER BY fkc.constraint_column_id 
    FOR XML PATH(N''), TYPE).value(N'.[1]', N'nvarchar(max)'), 1, 1, N'') + ');'
FROM sys.foreign_keys AS fk
INNER JOIN sys.tables AS rt -- referenced table
  ON fk.referenced_object_id = rt.[object_id]
INNER JOIN sys.schemas AS rs 
  ON rt.[schema_id] = rs.[schema_id]
INNER JOIN sys.tables AS ct -- constraint table
  ON fk.parent_object_id = ct.[object_id]
INNER JOIN sys.schemas AS cs 
  ON ct.[schema_id] = cs.[schema_id]
WHERE rt.is_ms_shipped = 0 AND ct.is_ms_shipped = 0;

SELECT @create 
```

运行生成的脚本以删除所有外键、截断表，然后运行生成的脚本以重新创建所有外键。

查询取自[这里](https://www.mssqltips.com/sqlservertip/3347/drop-and-recreate-all-foreign-key-constraints-in-sql-server/)。

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2012-10-03T14:29:39.277

这是我对这个问题的解决方案。我用它来改变PK，但想法相同。希望这会有用）

```
PRINT 'Script starts'

DECLARE @foreign_key_name varchar(255)
DECLARE @keycnt int
DECLARE @foreign_table varchar(255)
DECLARE @foreign_column_1 varchar(255)
DECLARE @foreign_column_2 varchar(255)
DECLARE @primary_table varchar(255)
DECLARE @primary_column_1 varchar(255)
DECLARE @primary_column_2 varchar(255)
DECLARE @TablN varchar(255)

-->> Type the primary table name
SET @TablN = ''
---------------------------------------------------------------------------------------    ------------------------------
--Here will be created the temporary table with all reference FKs
---------------------------------------------------------------------------------------------------------------------
PRINT 'Creating the temporary table'
select cast(f.name  as varchar(255)) as foreign_key_name
    , r.keycnt
    , cast(c.name as  varchar(255)) as foreign_table
    , cast(fc.name as varchar(255)) as  foreign_column_1
    , cast(fc2.name as varchar(255)) as foreign_column_2
    , cast(p.name as varchar(255)) as primary_table
    , cast(rc.name as varchar(255))  as primary_column_1
    , cast(rc2.name as varchar(255)) as  primary_column_2
    into #ConTab
    from sysobjects f
    inner join sysobjects c on  f.parent_obj = c.id 
    inner join sysreferences r on f.id =  r.constid
    inner join sysobjects p on r.rkeyid = p.id
    inner  join syscolumns rc on r.rkeyid = rc.id and r.rkey1 = rc.colid
    inner  join syscolumns fc on r.fkeyid = fc.id and r.fkey1 = fc.colid
    left join  syscolumns rc2 on r.rkeyid = rc2.id and r.rkey2 = rc.colid
    left join  syscolumns fc2 on r.fkeyid = fc2.id and r.fkey2 = fc.colid
    where f.type =  'F' and p.name = @TablN
 ORDER BY cast(p.name as varchar(255))
---------------------------------------------------------------------------------------------------------------------
--Cursor, below, will drop all reference FKs
---------------------------------------------------------------------------------------------------------------------
DECLARE @CURSOR CURSOR
/*Fill in cursor*/

PRINT 'Cursor 1 starting. All refernce FK will be droped'

SET @CURSOR  = CURSOR SCROLL
FOR
select foreign_key_name
    , keycnt
    , foreign_table
    , foreign_column_1
    , foreign_column_2
    , primary_table
    , primary_column_1
    , primary_column_2
    from #ConTab

OPEN @CURSOR

FETCH NEXT FROM @CURSOR INTO @foreign_key_name, @keycnt, @foreign_table,         @foreign_column_1, @foreign_column_2, 
                        @primary_table, @primary_column_1, @primary_column_2

WHILE @@FETCH_STATUS = 0
BEGIN

    EXEC ('ALTER TABLE ['+@foreign_table+'] DROP CONSTRAINT ['+@foreign_key_name+']')

FETCH NEXT FROM @CURSOR INTO @foreign_key_name, @keycnt, @foreign_table, @foreign_column_1, @foreign_column_2, 
                         @primary_table, @primary_column_1, @primary_column_2
END
CLOSE @CURSOR
PRINT 'Cursor 1 finished work'
---------------------------------------------------------------------------------------------------------------------
--Here you should provide the chainging script for the primary table
---------------------------------------------------------------------------------------------------------------------

PRINT 'Altering primary table begin'

TRUNCATE TABLE table_name

PRINT 'Altering finished'

---------------------------------------------------------------------------------------------------------------------
--Cursor, below, will add again all reference FKs
--------------------------------------------------------------------------------------------------------------------

PRINT 'Cursor 2 starting. All refernce FK will added'
SET @CURSOR  = CURSOR SCROLL
FOR
select foreign_key_name
    , keycnt
    , foreign_table
    , foreign_column_1
    , foreign_column_2
    , primary_table
    , primary_column_1
    , primary_column_2
    from #ConTab

OPEN @CURSOR

FETCH NEXT FROM @CURSOR INTO @foreign_key_name, @keycnt, @foreign_table, @foreign_column_1, @foreign_column_2, 
                         @primary_table, @primary_column_1, @primary_column_2

WHILE @@FETCH_STATUS = 0
BEGIN

    EXEC ('ALTER TABLE [' +@foreign_table+ '] WITH NOCHECK ADD  CONSTRAINT [' +@foreign_key_name+ '] FOREIGN KEY(['+@foreign_column_1+'])
        REFERENCES [' +@primary_table+'] (['+@primary_column_1+'])')

    EXEC ('ALTER TABLE [' +@foreign_table+ '] CHECK CONSTRAINT [' +@foreign_key_name+']')

FETCH NEXT FROM @CURSOR INTO @foreign_key_name, @keycnt, @foreign_table, @foreign_column_1, @foreign_column_2, 
                         @primary_table, @primary_column_1, @primary_column_2
END
CLOSE @CURSOR
PRINT 'Cursor 2 finished work'
---------------------------------------------------------------------------------------------------------------------
PRINT 'Temporary table droping'
drop table #ConTab
PRINT 'Finish' 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2013-07-29T04:55:33.813

对于`MS SQL`，至少在较新的版本中，您可以使用如下代码禁用约束：

```
ALTER TABLE Orders
NOCHECK CONSTRAINT [FK_dbo.Orders_dbo.Customers_Customer_Id]
GO

TRUNCATE TABLE Customers
GO

ALTER TABLE Orders
WITH CHECK CHECK CONSTRAINT [FK_dbo.Orders_dbo.Customers_Customer_Id]
GO 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2013-08-01T20:03:54.667

即使使用 FK 约束，以下内容也适用于我，并结合以下答案**仅删除指定的表**：

*   [事务自动回滚](https://stackoverflow.com/a/1749788/1037948)
*   [遍历逗号分隔的列表](https://stackoverflow.com/a/10031803/1037948)
*   [执行动态 SQL（使用变量中的表名）](https://stackoverflow.com/a/989111/1037948)
*   [DELETE 和 RESEED 表](https://stackoverflow.com/a/11784890) *（在此线程中）*

* * *

```
USE [YourDB];

DECLARE @TransactionName varchar(20) = 'stopdropandroll';

BEGIN TRAN @TransactionName;
set xact_abort on; /* automatic rollback https://stackoverflow.com/a/1749788/1037948 */
    -- ===== DO WORK // =====

    -- dynamic sql placeholder
    DECLARE @SQL varchar(300);

    -- LOOP: https://stackoverflow.com/a/10031803/1037948
    -- list of things to loop
    DECLARE @delim char = ';';
    DECLARE @foreach varchar(MAX) = 'Table;Names;Separated;By;Delimiter' + @delim + 'AnotherName' + @delim + 'Still Another';
    DECLARE @token varchar(MAX);
    WHILE len(@foreach) > 0
    BEGIN
        -- set current loop token
        SET @token = left(@foreach, charindex(@delim, @foreach+@delim)-1)
        -- ======= DO WORK // ===========

        -- dynamic sql (parentheses are required): https://stackoverflow.com/a/989111/1037948
        SET @SQL = 'DELETE FROM [' + @token + ']; DBCC CHECKIDENT (''' + @token + ''',RESEED, 0);'; -- https://stackoverflow.com/a/11784890
        PRINT @SQL;
        EXEC (@SQL);

        -- ======= // END WORK ===========
        -- continue loop, chopping off token
        SET @foreach = stuff(@foreach, 1, charindex(@delim, @foreach+@delim), '')
    END

    -- ===== // END WORK =====
-- review and commit
SELECT @@TRANCOUNT as TransactionsPerformed, @@ROWCOUNT as LastRowsChanged;
COMMIT TRAN @TransactionName; 
```

* * *

**笔记：**

我认为按照您希望它们删除的顺序声明表仍然有帮助（即首先杀死依赖项）。[如this answer](https://stackoverflow.com/a/5177130/1037948)中所见，您可以将所有表替换为，而不是循环特定名称

```
EXEC sp_MSForEachTable 'DELETE FROM ?; DBCC CHECKIDENT (''?'',RESEED, 0);'; 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2014-03-13T17:38:55.650

如果这些答案都不像我的情况那样有效，请执行以下操作：

1.  删除约束
2.  设置所有值以允许空值
3.  截断表
4.  添加已删除的约束。

祝你好运！

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2019-05-27T13:59:26.247

删除然后重置自动增量：

```
delete from tablename; 
```

然后

```
ALTER TABLE tablename AUTO_INCREMENT = 1; 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2014-07-19T01:15:36.713

在 SSMS 中，我打开了显示密钥的图表。删除密钥并截断文件后，我刷新然后将注意力重新集中在图表上，并通过清除然后恢复身份框来创建更新。保存图表会弹出一个保存对话框，而不是“在您工作时在数据库中进行了更改”对话框，单击“是”恢复了密钥，从图表中的锁定副本恢复它。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2017-07-13T17:05:23.757

如果您以任何频率执行此操作，甚至按计划进行，我**绝对不会使用 DML 语句。**写入事务日志的成本太高了，将整个数据库设置为`SIMPLE`恢复模式以截断一张表是荒谬的。

不幸的是，最好的方法是艰苦或费力的方法。那就是：

*   删除约束
*   截断表
*   重新创建约束

我这样做的过程包括以下步骤：

1.  在 SSMS 中右键单击有问题的表，然后选择*查看依赖项*
2.  记下引用的表格（如果有）
3.  返回对象资源管理器，展开*Keys*节点并记下外键（如果有）
4.  开始编写脚本（删除/截断/重新创建）

这种性质的脚本*应该*在一个`begin tran`和`commit tran`块内完成。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2021-05-08T20:14:23.150

这是使用实体框架的人的示例

*   要重置的表：`Foo`

*   另一个依赖于的表：`Bar`

*   表上的约束列`Foo`：`FooColumn`

*   表上的约束列`Bar`：`BarColumn`

    ```
     public override void Down()
     {
         DropForeignKey("dbo.Bar", "BarColumn", "dbo.Foo");
         Sql("TRUNCATE TABLE Foo");
         AddForeignKey("dbo.Bar", "BarColumn", "dbo.Foo", "FooColumn", cascadeDelete: true);
     } 
    ```

* * *

## 回答 #26

> 赞同：-4
> 
> 时间：2011-07-18T16:44:06.633

你可以试试`DELETE FROM <your table >;`。

服务器将向您显示限制的名称和表格，删除该表格您可以删除您需要的内容。

* * *

## 回答 #27

> 赞同：-4
> 
> 时间：2013-11-25T17:02:53.757

我刚刚发现，只要您首先禁用**子**表上的约束，就可以在父表上使用 TRUNCATE 表，而对子表有外键约束。例如

子表上的外键 CONSTRAINT child_par_ref，引用 PARENT_TABLE

```
ALTER TABLE CHILD_TABLE DISABLE CONSTRAINT child_par_ref;
TRUNCATE TABLE CHILD_TABLE;
TRUNCATE TABLE PARENT_TABLE;
ALTER TABLE CHILD_TABLE ENABLE CONSTRAINT child_par_ref; 
```

* * *

## 回答 #28

> 赞同：-4
> 
> 时间：2016-08-30T14:32:06.070

最简单的方法：
1 - 在 phpmyadmin 中输入
2 - 单击左列中的表名
3 - 单击操作（顶部菜单）
4 - 单击“清空表（TRUNCATE）
5 - 禁用框“启用外键检查”
6 - 完成！

图片教程链接
[教程：](http://i.stack.imgur.com/7lg2b.jpg)[http](http://www.imageno.com/wz6gv1wuqajrpic.html)
://www.imageno.com/wz6gv1wuqajrpic.html （对不起，我没有足够的声誉在这里上传图片：P）

* * *

## 回答 #29

> 赞同：-6
> 
> 时间：2012-11-06T01:52:04.080

```
SET FOREIGN_KEY_CHECKS=0;
TRUNCATE table1;
TRUNCATE table2;
SET FOREIGN_KEY_CHECKS=1; 
```

参考 -[截断外键约束表](https://stackoverflow.com/questions/5452760/truncate-foreign-key-constrained-table)

在 MYSQL 中为我工作

# wpf - 在 WPF 应用程序中，是否有可以分配给 FileSystemWatcher.SynchronizingObject 的对象？

> ID：253865
> 
> 赞同：6
> 
> 时间：2008-10-31T15:11:02.647
> 
> 标签：wpf

在 WPF 应用程序中，是否有可以分配给 FileSystemWatcher.SynchronizingObject 的对象？

我可以自己做，但如果有可用的，我想使用它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-10-31T16:32:23.217

Reflector 显示唯一实现的类`ISynchronizeInvoke`（即`FileSystemWatcher.SynchronizingObject`属性的类型）是`System.Windows.Form.Control`（及其子类）；似乎没有任何实现此接口的 WPF 对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-03-21T21:26:34.837

您需要从 Window 创建一个包装 System.Windows.Threading.Dispatcher 实例的 ISynchronizeInvoke 对象。该类是 WPF 与 ISynchronizeInvoke 对象最接近的东西。

在包装类中，只需将 BeginInvoke 调用转发给您包装的调度程序。我做了一些额外的工作，还包装了 Dispatcher.BeginInvoke 方法产生的 DispatcherOperation 以在 ISynchronizeInvoke.EndInvoke 方法中调用它的 Wait 方法。

到目前为止，一切似乎都正常工作，可惜微软认为不适合让 Dispatcher 类实现接口以便于使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-08T07:58:05.273

有一种方法。FileSystemWatcher 在您启用事件时 (EnableRaisingEvents = true) 创建它自己的线程来监视 FS 事件。例如，通过 ISynchronizeInvoke，它可以异步调用 Form 的成员（它的线程可以与主线程 - UI 线程异步交互）。

在 WPF 中没有 ISynchronizeInvoke 的实现，但可以通过 Window 的 Dispatched 属性与 UI 线程进行交互，如下所示：

```
var fsw = new FileSystemWatcher() 
{ 
    //Setting the properties: Path, Filter, NotifyFilter, etc. 
};

fsw.Created += (sender, e) => 
{ 
    Dispatcher.Invoke(new Action<params_types>((params_identifiers) => 
        { 
            //here the code wich interacts with your IU elements 
        }), here_params); 
};

//... in this way (via Dispatcher.Invoke) with the rest of events

fsw.EnableRaisingEvents = true; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2011-07-23T20:53:17.023

使用 DispatcherTimer 而不是系统计时器。这将适用于 WPF。

```
 DispatcherTimer t1 = new DispatcherTimer();

    private void Window_Loaded(object sender, RoutedEventArgs e)
    {
         t1.Interval = new TimeSpan(0,0,0,0,200);
        t1.Tick += new EventHandler(t1_Tick);
        t1.Start();
    ...
    void t1_Tick(object sender, EventArgs e)
    {

        //some work

    } 
```

# html - 3 面的 CSS 阴影

> ID：253868
> 
> 赞同：2
> 
> 时间：2008-10-31T15:12:17.153
> 
> 标签：html, css

我正在查看所有的 CSS 投影教程，它们都很棒。不幸的是，我需要在块元素的三个侧面（左、下、右）上放置阴影。所有的教程都讨论了将块元素向上和向左移动。有人对在三个甚至四个方面放置阴影有见解吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T15:14:58.710

使您的块元素更大/更高，使其超过您想要的边。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T15:31:11.033

这是一种方法：

```
<div style='position:relative;'>
    <div style='position:absolute;top:10px;left:10px;width:300px;height:100px;z-index:1;background-color:#CCCCCC'></div>
    <div style='position:absolute;top:0px;left:0px;width:300px;height:100px;z-index:2;background-color:#00CCFF'>
        <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Suspendisse at felis. Etiam ullamcorper.</p>
    </div>
</div> 
```

根据您的喜好调整和定位“z-index:1”DIV。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T15:31:38.473

伪 HTML

```
<div style="position:absolute;top:8;left:12;width:200;height:204;background-color:#888888"></div>
<div style="position:absolute;top:10;left:10;width:200;height:200;background-color:#FFFFFF">The element</div> 
```

你需要玩弄阴影的大小。在上面的例子中，阴影比元素略高，所以阴影显示在上面，它稍微向左偏移，所以阴影显示在右边，它比元素略大，所以阴影显示在下面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-16T14:45:25.050

谢谢大家。我最终这样做的方式是这样的：

```
<div id="top_margin"></div>
<div id="left_right_shadow">this div has a 5 px tall repeating background that is a bit bigger than the width of my content block, shadow on the left, white space, shadow on the right
  <div id="content">Content as normal</div>
</div>
<div id="bottom_margin">This has the bottom shadow</div> 
```

# objective-c - 图层支持的视图和闪烁控件

> ID：253873
> 
> 赞同：5
> 
> 时间：2008-10-31T15:13:28.773
> 
> 标签：objective-c, cocoa, core-animation

我有一个包含 NSBox 控件的窗口。在那个 NSBox 中还有其他几个控件，（弹出窗口、文本字段等......）

我在同一个 NIB 文件中有另外两个 NSBox，它们充满了我想在某些条件下与第一个交换的控件。我希望这会发生一个很好的交叉淡入淡出效果，所以我做了以下事情：

在 NSWindowController 的`-awakeFromNib`方法中：

```
[[self.myWindow contentView] setWantsLayer:YES]; 
```

在我切换视图的方法中，我使用以下代码：

```
[[[self.myWindow contentView] animator] replaceSubview:previousView with:newView]; 
```

这工作得很好，正如我所期望的那样，观点交叉淡化。问题是视图上的控件有时会无缘无故地消失。它并不总是相同的视图（尽管 NSPopUpButtons 似乎特别容易出现这种情况），并且它们通常在它们具有焦点时重新出现。

我是否必须同时支持所有控件层？

* * *

更新：在显式分组中包装动画没有任何区别。在 Nib 文件中打开 setWantsLayer 也没有什么不同，但有趣的是，当我这样做时，NSPopupbuttons 会消失，直到单击它们的包含视图。在 NSPopupbuttons 上手动设置图层也没有什么不同。

似乎其他人遇到了这个问题，但我找不到任何发布的解决方案：

[http://www.cocoabuilder.com/archive/message/cocoa/2008/3/30/202691](http://www.cocoabuilder.com/archive/message/cocoa/2008/3/30/202691) [http://www.cocoabuilder.com/archive/message/cocoa/2008/4/25/205134](http://www.cocoabuilder.com/archive/message/cocoa/2008/4/25/205134)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-10-31T23:13:09.883

如果一个视图是层支持的，它的所有子视图都将是层支持的，所以你不需要手动将它们设置为层支持。我不知道是否有足够的信息来查看这里发生了什么，但是如果您将动画包装在显式分组中，我会很好奇您是否会得到不同的行为：

```
[NSAnimationContext beginGrouping];
[[[self.myWindow contentView] animator] replaceSubview:previousView with:newView];
[NSAnimationContext endGrouping]; 
```

此外，您调用 setWantsLayer: 是否有原因：在 awakeFromNib 中，而不是仅在 nib 中设置它（NSView 检查器中应该有一个复选框）。

# oracle - ORA-01775: 循环同义词链但没有同义词

> ID：253881
> 
> 赞同：0
> 
> 时间：2008-10-31T15:15:49.283
> 
> 标签：oracle, stored-procedures

无法弄清楚为什么我在此存储过程的第 52 行收到“忽略 SQL 语句”和“ORA-01775：循环同义词链”。有什么想法吗？

```
CREATE OR REPLACE PACKAGE PURGE_LOG_BY_EVENT_DAYS AS

  TYPE dual_cursorType IS REF CURSOR RETURN dual%ROWTYPE;

  PROCEDURE log_master_by_event_days (event_id NUMBER, purge_recs_older_than NUMBER, result_cursor OUT dual_cursorType);

END PURGE_LOG_BY_EVENT_DAYS;

/

CREATE OR REPLACE PACKAGE BODY PURGE_LOG_BY_EVENT_DAYS
AS

  err_msg     VARCHAR2(4000);

  PROCEDURE log_master_by_event_days (event_id NUMBER, purge_recs_older_than NUMBER, result_cursor OUT dual_cursorType)
  IS

  TYPE  type_rowid IS TABLE OF ROWID INDEX BY BINARY_INTEGER;
  TYPE  type_ref_cur IS REF CURSOR;

  l_rid                   type_rowid;
  c1                      type_ref_cur;

  l_sql_stmt              VARCHAR2(4000);
  proc_start_time         DATE := sysdate;
  purge_date              DATE;

  l_bulk_collect_limit    NUMBER := 1000;
  retry                   NUMBER := 5;
  retry_count             NUMBER := 0; 
  loop_count              NUMBER := 0;

  err_code                VARCHAR2(10);

BEGIN

  purge_date := to_date(sysdate - purge_recs_older_than);

  l_sql_stmt := '';
  l_sql_stmt := l_sql_stmt ||' SELECT rowid FROM LOG_MASTER ';
  l_sql_stmt := l_sql_stmt ||'  WHERE last_changed_date < :purge_date';
  l_sql_stmt := l_sql_stmt ||'    AND event_id = :event_id';

  -- The following while loop
  -- executes the purge code
  -- 'retry' number of times in case of ORA-01555

  WHILE retry > 0 LOOP

    BEGIN

      -- START of purge code
      OPEN c1 FOR l_sql_stmt USING purge_date, event_id;
      LOOP

        FETCH c1 BULK COLLECT into l_rid LIMIT l_bulk_collect_limit;

        FORALL i IN 1..l_rid.COUNT
          DELETE from log_master
           WHERE rowid = l_rid(i);
        COMMIT;

        loop_count := loop_count + 1;
        EXIT WHEN c1%NOTFOUND;

      END LOOP;
      CLOSE c1;

      -- End of purge code
      -- if processing reached this point
      -- Process completed successfuly, set retry = 0 to exit loop
      retry := 0;

    EXCEPTION
    WHEN OTHERS THEN
      -- ====================================
      -- Get error msg
      -- ====================================

      ROLLBACK;
      err_code := sqlcode;

      dbms_output.put_line(err_code);

      -- ====================================
      -- Check if it is 01555
      -- if so retry, else exit loop
      -- ====================================

      retry := retry - 1;
      if err_code = '-1555' and retry > 0 THEN
        CLOSE c1;
        retry_count :=  retry_count + 1;
      else
        err_msg := sqlerrm;
        exit;
      end if;
    END;
  END LOOP;

  IF err_msg IS NULL THEN

    open result_cursor for select '1 - PURGE_LOG_BY_EVENT_DAYS ran successfully (event_id : '||event_id||', loop_count : '||loop_count||', bulk_limit : '||l_bulk_collect_limit||', retries : '||retry_count||') ' from dual;

  ELSE

    open result_cursor for select '2 - PURGE_LOG_BY_EVENT_DAYS After (event_id : '||event_id||', loop_count : '||loop_count||', bulk_limit : '||l_bulk_collect_limit||', retries : '||retry_count||') with Error: ' || err_msg from dual;

  END IF;

 END log_master_by_event_days;

END PURGE_LOG_BY_EVENT_DAYS; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T17:20:22.590

我不知道你为什么会收到同义词错误。但这对于应该是单个 DELETE 语句的东西来说是很多代码。我假设您已将其更改为 commit-every-n 以避免回滚错误。如果您可以让您的 DBA 增加撤消空间，这样您就可以真正做您需要做的工作，那就太好了。如果做不到这一点，我认为你仍然可以让它变得更简单：

```
LOOP
  DELETE FROM log_master
    WHERE last_changed_date < :purge_date
      AND event_id = :event_id
      AND rownum <= :batch_delete_limit
    USING purge_date, event_id, l_bulk_collect_limit;
  EXIT WHEN SQL%NOTFOUND;
END LOOP; 
```

如果你愿意，你可以抛出你的重试逻辑。

抱歉，如果我错过了一些使这与您正在做的事情不同的微妙之处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T15:27:29.573

```
SELECT table_owner, table_name, db_link
  FROM dba_synonyms 
 WHERE owner        = 'PUBLIC' and db_link is not null 
```

据我所知，返回 0 行，没有同义词......

# audio - 如何创建带有章节标记的 Kindle 和 iPod 兼容的有声读物文件？

> ID：253898
> 
> 赞同：11
> 
> 时间：2008-10-31T15:23:09.113
> 
> 标签：audio, aac, kindle

我查找了有关 Audible 格式的参考资料，似乎人们只对破解/转换*它*感兴趣。我有一组 MP3 文件，我想将它们转换为 Audible 格式，以便在我的 Kindle 和 iPod 上使用。

是否有人对 Audible 或受保护的 AAC 格式以及如何表达部分标记和元数据有很好的参考？更好的是，实用程序或代码示例？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-10-31T19:29:17.463

Audible 格式是受 DRM 保护的专有格式，仅可从 Audible 获得。他们努力保护他们的格式。据我了解，他们曾经为使用权收取高额费用。我不知道有任何公开可用的编码器会创建可听格式的文件（无论是否免费）。由于亚马逊购买了 Audible，我不确定他们是否还会再将版权出售给其他任何人。

我没有 Kindle，但据我所知，它只支持具有完整有声读物功能的 Audible 格式文件。可以播放 MP3，但它们的处理方式不同（不支持章节等）。

为 iPod 创建具有章节支持的有声读物需要创建一个带有文本轨道的 M4B 文件，并确保音轨具有对文本轨道的正确轨道引用。M4B 是使用 AAC 音频的 MP4 版本。在 MAC 上有几个程序可以做到这一点，最近一些程序已经出现在 PC 上。

我已经为现在处于 Beta 测试阶段的 PC 创建了一个带有图形用户界面 (GUI) 的免费软件软件包。它被称为“Chapter and Verse”，很快将在[lodensoftware.com](http://lodensoftware.com)上提供。GUI 的另外两个选项是：Rightword Enterprises的“ [Chapter Master ”（15 美元）和](http://www.ipodsoft.com/site/pmwiki.php?n=ChapterMaster.HomePage)[sjhaley.com的“](http://www.sjhaley.com/ipodabc/index.htm) [iPod Audio Book Converter](http://www.sjhaley.com/ipodabc/index.htm) ”（免费软件），它也在 Beta 测试中。

还存在几个命令行实用程序。一种称为幻灯片汇编器 (SSA)，可用于创建播客和有声读物。SSA 可从[jrlearnsmedia.com 获得](http://jrlearnsmedia.com/blog/articles/ssa-downloads.aspx)。另一个是用于操作 MP4 文件的命令行实用程序，称为 mp4creator。mp4creator 可以将章节添加到 MP4 文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T19:53:09.080

我在 OSX 上为 mp3 到 m4b 有声读物的问题苦苦挣扎了一段时间，并想出了我的工作流程。现在总结为一个自动完成所有工作的 ruby​​ 脚本。这是工作流程：

1.（ruby）对文件进行排序并识别章节名称（正则表达式魔术！）

2.（蹩脚）将所有mp3转换为64kbits单声道cbr（这样做是为了利用输入文件，删除可能导致合并问题的标签，最重要的是因为coreaudio aac从立体声到单声道的转换很糟糕......）

3.（mp3info ruby​​ gem）计算文件长度并生成章节xml文件（长度在mono cbr版本上计算以避免问题）

4.（猫）合并它们

5.(afconvert) 转换为aac

6.（ChapterTool）应用章节标记并重命名为m4b

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-04T05:34:46.790

供参考

Chapter and Verse 已经发布了一段时间。

最新版本 (v1.3) 现在可以使用完整的功能为 iPod、iTunes 和 quicktime 创建带有章节图像的章节有声读物。

该程序是免费软件，可在[lodensoftware.com 获得](http://lodensoftware.com)

# asp.net - ListView - 绑定到简单的标量数组时可以设置 DataKeyNames 吗？

> ID：253911
> 
> 赞同：2
> 
> 时间：2008-10-31T15:27:49.760
> 
> 标签：asp.net

我有一个案例不断出现，我使用 ListView 或带有简单数组（如 string[]）的类似控件。

绑定到简单集合时，有没有办法使用 DataKeyNames 属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-05T06:11:10.473

你可以用 Linq 做到这一点：

```
string [] files = ...;

var list = from f in files
    select new { Letter = f };

// anonymous type created with member called Letter

lv.DataKeyNames = "Letter";
lv.DataSource = list;
lv.DataBind(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T15:38:46.210

尝试使用带有对象对象的通用列表。下面的示例是 C# 3.0。假设您想要一个字母列表：

```
public class LettersInfo
{
    public String Letter { get; set; }
} 
```

然后列一个清单：

```
List<LettersInfo> list = new List<LettersInfo>();
list.add(new LettersInfo{ Letter = "A" });
list.add(new LettersInfo{ Letter = "B" });
list.add(new LettersInfo{ Letter = "C" }); 
```

然后将其绑定到列表视图

```
lv.DataKeyNames = "Letter";
lv.DataSource = list;
lv.DataBind(); 
```

# vba - Access 2007 VBA 查询在查询分析器中显示数据，但在 VBA 编码记录集中不显示

> ID：253913
> 
> 赞同：1
> 
> 时间：2008-10-31T15:29:28.320
> 
> 标签：vba, ms-access, ms-access-2007, ado

我有一个我编写的函数，最初应该采用一个字符串字段并用这些值填充一个 Excel 电子表格。这些值不断出现为空。我开始将其跟踪回记录集，发现尽管查询有效并且通过 Access 查询分析器正常运行，但记录集为空或缺少字段。

为了测试这个问题，我创建了一个子程序，在其中创建了一个查询，打开了一个记录集，然后对这些值进行了分页（将它们输出到一个消息框）。问题中最令人困惑的部分似乎围绕查询的“WHERE”子句展开。如果我不在查询中添加“WHERE”子句，则记录集总是有数据，并且“DESCRIPTION”的值是正常的。

如果我为 WHERE 子句添加任何内容，则记录集要么完全为空 ( *)*`rs.EOF = true`，要么在其他字段具有值的情况下，描述字段完全为空白。我想再次强调，如果我 debug.print 查询，我可以将其复制/粘贴到查询分析器中，并获得我期望的有效和返回值。

我肯定会很感激这方面的帮助。谢谢！

```
Private Sub NewTest()

'  Dimension Variables
'----------------------------------------------------------
Dim rsNewTest As ADODB.Recordset
Dim sqlNewTest As String
Dim Counter As Integer

'  Set variables
'----------------------------------------------------------
Set rsNewTest = New ADODB.Recordset

sqlNewTest = "SELECT dbo_partmtl.partnum as [Job/Sub], dbo_partmtl.revisionnum as Rev, " & _
                "dbo_part.partdescription as Description, dbo_partmtl.qtyper as [Qty Per] " & _
            "FROM dbo_partmtl " & _
            "LEFT JOIN dbo_part ON dbo_partmtl.partnum = dbo_part.partnum " & _
            "WHERE dbo_partmtl.mtlpartnum=" & Chr(34) & "3C16470" & Chr(34)

'  Open recordset
rsNewTest.Open sqlNewTest, CurrentProject.Connection, adOpenDynamic, adLockOptimistic

    Do Until rsNewTest.EOF

        For Counter = 0 To rsNewTest.Fields.Count - 1
            MsgBox rsNewTest.Fields(Counter).Name
        Next

        MsgBox rsNewTest.Fields("Description")

        rsNewTest.MoveNext

    Loop

'  close the recordset

rsNewTest.Close
Set rsNewTest = Nothing

End Sub 
```

编辑：有人要求我发布查询的 DEBUG.PRINT。这里是：

```
SELECT dbo_partmtl.partnum as [Job/Sub], dbo_partmtl.revisionnum as Rev, dbo_part.partdescription as [Description], dbo_partmtl.qtyper as [Qty Per] FROM dbo_partmtl LEFT JOIN dbo_part ON dbo_partmtl.partnum = dbo_part.partnum WHERE dbo_partmtl.mtlpartnum='3C16470' 
```

* * *

我已经尝试过使用 ASCII 字符和隐式的双引号和单引号。

例如：

```
"WHERE dbo_partmtl.mtlpartnum='3C16470'" 
```

我什至用 chr(39) 尝试了你的建议：

```
"WHERE dbo_partmtl.mtlpartnum=" & Chr(39) & "3C16470" & Chr(39) 
```

两者都返回空值进行描述。但是，如果我 debug.print 查询并将其粘贴到 Access 查询分析器中，它会显示得很好。同样（作为旁注），如果我在 WHERE 子句中执行 LIKE 语句，它将给我一个完全空的记录集。这里有些东西真的很奇怪。

* * *

这是一个有趣的花絮。这些表链接到一个`SQL Server`. 如果我在本地复制表（数据和结构），上面的 ADO 代码可以完美运行。如果我使用 DAO，它可以正常工作。我已经在`Windows XP`、`Access 2003`和各种版本的`ADO (2.5, 2.6, 2.8)`. `ADO`如果表已链接，则将不起作用。

ADO 中存在一些导致该问题的缺陷。

* * *

我绝对愿意。请记住，`DEBUG.PRINT`您看到的查询在查询分析器中运行良好。它返回以下内容：

```
工作/子版本描述每件数量
36511C01 主电气外壳 1
36515C0V 视觉系统 1
36529C01 主电气外壳 1

```

但是，相同的查询在通过记录集运行时返回空值的描述（其他一切都是相同的）（由于“Null”值导致的消息框错误）。

* * *

我尝试将“描述”字段重命名为“testdep”，但它仍然是空的。使其显示数据的唯一方法是删除查询的 WHERE 部分。我开始相信这是 ADO 的问题。也许我会用 DAO 重写它，看看我得到了什么结果。

编辑：我也尝试了几次压缩和修复。没有骰子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-13T23:04:32.413

使用 ADO LIKE 搜索时必须使用 % 而不是 *。我知道 * 在 Access 中有效，但由于某些愚蠢的原因，除非您改用 %，否则 ADO 将无法工作。

我遇到了同样的问题，并在尝试修复它时访问了这个论坛。用 % 替换 * 对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-31T15:34:48.887

描述是一个保留字 - 在 SELECT 语句中用一些 [] 括号括起来

编辑

尝试将列命名为描述之外的其他名称

您还确定在 where 子句中使用相同的值 - 因为它是左连接，所以如果 dbo_part 中没有相应的记录，Description 字段将为空

再次编辑

如果您得到有趣的结果 - 尝试压缩/修复数据库 - 它可能已损坏

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T16:56:10.673

好吧，我担心的就是这种情况。它适用于 DAO 但不适用于 ADO。

这是工作代码：

```
Private Sub AltTest()

'  Dimension Variables
'----------------------------------------------------------
Dim rsNewTest As DAO.Recordset
Dim dbl As DAO.Database

Dim sqlNewTest As String
Dim Counter As Integer

'  Set variables
'----------------------------------------------------------

sqlNewTest = "SELECT dbo_partmtl.partnum as [Job/Sub], dbo_partmtl.revisionnum as Rev, " & _
                "dbo_part.partdescription as [TestDep], dbo_partmtl.qtyper as [Qty Per] " & _
            "FROM dbo_partmtl " & _
            "LEFT JOIN dbo_part ON dbo_partmtl.partnum = dbo_part.partnum " & _
            "WHERE dbo_partmtl.mtlpartnum=" & Chr(39) & "3C16470" & Chr(39)

Debug.Print "sqlNewTest: " & sqlNewTest
Set dbl = CurrentDb()
Set rsNewTest = dbl.OpenRecordset(sqlNewTest, dbOpenDynaset)

' rsnewtest.OpenRecordset

    Do Until rsNewTest.EOF

        For Counter = 0 To rsNewTest.Fields.Count - 1
            MsgBox rsNewTest.Fields(Counter).Name
        Next

        MsgBox rsNewTest.Fields("TestDep")

        rsNewTest.MoveNext

    Loop

'  close the recordset

dbl.Close
Set rsNewTest = Nothing 
```

结束子

我不在此数据库中的任何地方使用 DAO，并且不想开始。我们从这里去哪里？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-06-14T19:08:18.067

我知道自从这个线程开始以来已经过去了一段时间，但如果你想知道，我发现了一些对 Access 2003 的好奇，并且该错误可能已经延续到 2007 年（如我所见）。

我在 WHERE 子句中遇到了类似的问题，因为我需要包含时间的日期字段中的记录，所以整个字段内容看起来像 #6/14/2011 11:50:25 AM#（添加了 #用于格式化目的）。

与上述相同的问题，查询与“WHERE ((tblTransactions.TransactionDate) Like '" & QueryDate & "*');" 一起工作正常 在查询设计视图中，但它不适用于使用 ADO 的 VBA 代码。

所以我求助于使用 "WHERE ((tblTransactions.TransactionDate) Like '" & QueryDate & " %%:%%:%% %M');" 在 VBA 代码中，使用 ADO，它工作得很好。显示我正在寻找的记录，诀窍是不要在 Like 子句中使用“*”；或者至少这是我的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T15:42:16.143

我在 SELECT 语句中的“描述”一词周围加上了括号，但它的行为仍然存在。只要我不在 WHERE 子句中添加任何内容，它就可以正常工作。我发现如果我在 where 子句中添加任何内容，说明是空白的（尽管出现在查询分析器中）。如果我在 WHERE 子句中使用 LIKE 语句，则整个记录集是空的，但它仍然在查询分析器中正常工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T19:20:16.343

最终我认为在 Vista 64 上运行 ADO 2.8 是个问题

就我个人而言，我一直在 Access 项目中使用 DAO。

# .net - 比较 .Net 和 VB6 应用程序的内存占用

> ID：253914
> 
> 赞同：4
> 
> 时间：2008-10-31T15:30:42.857
> 
> 标签：.net, performance, memory, vb6

我一直在尝试比较 VB6 应用程序和 .Net 应用程序之间的内存占用。试图确定两者之间的平均差异是多少。

.Net 代码大部分是 VB6 的直接翻译，并且大部分具有与在 C# 中编程相同的指令。因此，虽然这是一个苹果与橘子的比较，但它是对功能（如果不是逻辑上）等效的程序的比较。

我一直在使用[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)来帮助我确定应用程序的内存使用情况，但是有一些地方让我感到困惑：

1.  我一直在尝试确定整体内存消耗。我应该使用哪个进程内存列。到目前为止，我一直在研究工作集。
2.  为了比较应用程序中 DLL 的大小，PExplorer 显示 Size、WS Total 和其他 WS 计数器，如何解释这些？为什么 Size 与 WS Total 如此不同，这些不应该相同吗？

到目前为止，我已经收集到 WS Total 包括 WS Private 和 WS Shareable。因此，仅使用 WS Total 可能是一种欺骗性措施。我还从[.Net exe 内存占用](https://stackoverflow.com/questions/223283/net-exe-memory-footprint)等问题中了解到 .Net 工作集通常比它应该的要大。在内存匮乏的环境中实例化进程，比如 128 MB 的 VM 会将工作集大小减少到最小值吗？

任何帮助或见解将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T15:35:51.710

Mark Russinovich有[一篇很好的文章](http://blogs.technet.com/markrussinovich/archive/2005/04/16/the-coming-net-world-i-m-scared.aspx)。

您可以使用 Win32 API 调用 SetProcessWorkingSetSize(GetCurrentProcess(), -1, -1) 手动减少应用的工作集。这是 Windows 在系统内存不足时无论如何都会执行的操作，但您自己控制何时发生这种情况可以让您将 .NET 应用程序的工作集剥离到其最小大小以进行调查。

# mfc - 如何使用 CListCtrl 就地编辑列？

> ID：253919
> 
> 赞同：3
> 
> 时间：2008-10-31T15:32:24.930
> 
> 标签：mfc, clistctrl

我希望 CListCtrl.EditLabel() 用于列表的任何列。我怎样才能实现这样的功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T18:33:00.493

不要尝试使用 CListCtrl。

使用[MFC 网格控件](http://www.codeproject.com/KB/miscctrl/gridctrl.aspx)。我们成功地将其部署在现成的应用程序中。它为所有单元格提供就地编辑、复选框、旋转等，以及列和行标题、自动大小、自动扩展、颜色、拖放。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-02T23:49:58.183

这是可行的，但它确实需要通过鼠标单击和焦点事件进行大量填充。

简而言之，您捕获鼠标左键按下消息并将其转换为单元格命中详细信息（即行和列索引）。

使用这些单元格详细信息，您无法确定列表视图单元格的大小和位置以及它包含的文本值。

现在使用上一步中的大小和位置详细信息直接在此单元格上创建一个 CEdit 控件，并为其提供单元格的文本值。

最后一步是处理 CEdit 的焦点和键盘输入事件，以便可以将 CEdit 的文本详细信息放回列表视图单元格中。

它确实需要大量的编码，但如果做得好，它确实可以很好地替代网格控件。

# php - 什么是好的免费在线民意调查/调查应用程序？

> ID：253922
> 
> 赞同：4
> 
> 时间：2008-10-31T15:33:13.710
> 
> 标签：php, mysql, survey

我需要对 3 个问题进行调查：

*   第一个问题是是/否。

*   第二个将有多个答案，您可以在其中为该问题选择多个答案，以及可用于填写答案的“其他”框。

*   最后一个问题将是一个文本区域，用户可以在其中输入一般评论/建议。

我希望这个调查应用程序有一个管理端，这样我就可以将结果导出为标准格式和/或能够通过界面查看统计数据。

我确实找到的是[这个](http://www.limesurvey.org/)。还有其他这样的吗？

编辑：基于 PHP/MySQL。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T20:48:23.967

几年前我研究过这个。Surveymonkey 是一种似乎被广泛使用的网络服务，尤其是非计算机知识的用户。如果您想自己修改、服务和计数（可能免费），请参阅[此比较表](http://websurveytoolbox.org/FeatureTable.html "这个对比图")。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T13:30:11.680

我使用[eSurv.org](http://eSurv.org)是因为它不需要任何费用，而且有很多很酷的选项可用于自定义您的调查。我把我们学校的标志放在我们的身上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T15:47:16.820

[http://www.surveymonkey.com](http://www.surveymonkey.com)根据我的经验运作良好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-28T10:13:54.150

[http://docs.google.com](http://docs.google.com)创建表格并在电子表格中收集调查结果

# c# - 处理需要“长时间”完成的程序的正确方法是什么？

> ID：253925
> 
> 赞同：0
> 
> 时间：2008-10-31T15:34:27.407
> 
> 标签：c#, database, sql-server-2005, multithreading, visual-studio-2005

我有一个在 Visual Studio 2005 Pro 中创建的 Winforms 应用程序，它使用 SqlConnection / SqlCommand / SqlDataAdapter 类连接到 SQL Server 2005 数据库以提取数据。我在我的数据库中存储了过程以将数据返回给我。

处理需要“长时间”才能完成的查询的最佳方法是什么？（即足够长，用户开始认为有问题）。目前，我的应用程序会锁定，直到查询完成或查询超时。显然这是不可接受的。

我至少想要一个带有“停止”按钮的进度表。进度条甚至不需要做任何有用的事情，作为一个耐心坐下等待的提示就足够了。

更好的是一个警告，上面写着“这将返回 140,000 行数据。你想继续吗？”

我知道这可能需要线程，但是如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-10-31T15:41:23.757

确保优化查询是第一步，但之后，您必须使用线程，而 .NET 具有适用于这些情况的[BackgroundWorker 组件](http://msdn.microsoft.com/en-us/library/8xs8549b.aspx)。

这是一个[完整的例子](http://msdn.microsoft.com/en-us/library/waw3xexc.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-10-31T15:42:29.463

简单的 C# 2.0 示例：

```
 private void Form_Load(object sender, EventArgs e)
    {
        BackgroundWorker bw = new BackgroundWorker();
        bw.DoWork += new DoWorkEventHandler(bw_DoWork);
        bw.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bw_RunWorkerCompleted);
        //change UI to reflect we're doing this
        bw.RunWorkerAsync();
    }

    void bw_DoWork(object sender, DoWorkEventArgs e)
    {
        //SQL Work
    }

    void bw_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
        //Let the user know we're done
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T15:40:39.890

好的，首先，我建议尝试加快查询速度。首先要检查的是确保您有适当的索引。网上有大量关于正确使用索引的文章。

如果在这之后，您的查询仍然太慢，您可能不得不切换到使用数据库游标。

使用光标，您一次读取一个结果，然后拉出它们。这将使您有机会显示进度条。

如果您坚持当前的查询模型并简单地使用线程来绘制进度条，那么您的进度条将与正在完成的工作无关并且看起来不正确。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T19:59:58.650

创建长文件时，我使用 RunWorker 和 ProgressBar。

我使用的一个技巧是在设置 ProgressBar 时找到要使用的文件长度的代理。例如，ProgressBar 可能基于函数上次运行时文件中的行数（可能保存在一个长文件中）。ProgressBar 或类似的，不必是精确的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T15:36:42.800

要实现您的警告，您可以首先发出一个 COUNT() 查询，它不仅会返回用户将要获取的行数，而且可能会开始缓存数据。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T15:40:01.980

您可能希望创建另一个表来记录查询的执行时间。这样你就可以说“上次这个过程花了 X 时间”。这将为他们提供对需要多长时间的粗略估计。否则，您将不得不运行查询以获取可能需要很长时间的 COUNT。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-31T15:41:12.913

您将希望利用线程。当用户发出获取数据的信号时，您可以生成一个新线程来获取数据，同时在主窗体上显示一个 throbber。当线程返回时，您可以做出反应并显示结果。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-01T17:17:10.770

对于您的进度条，请查看 Marquee 样式。如果由于某种原因无法获得实际的进度报告（也就是说，如果使用 CURSOR 作为 dicroce 建议的结果是站不住脚/太慢/无论如何），您可以使用 Marquee 进度条来显示您的 UI 仍在响应，并且您没有忘记用户。

请记住 Jakob Nielsen 的规则：如果您花费超过 250 毫秒 (?) 来返回给用户，他们会担心出现问题。通常，您的按钮应该运行任何必要的验证（快速！），然后显示一些告诉用户“我正在工作”并将控制权返回给 UI 循环的内容。

# windows-vista - Vista home 中的内置 VPN 客户端“Connect to Workplace”可以连接到 Cisco 路由器吗？

> ID：253929
> 
> 赞同：0
> 
> 时间：2008-10-31T15:35:54.453
> 
> 标签：windows-vista, client, vpn

Vista home 中的内置 VPN 客户端“Connect to Workplace”可以连接到 Cisco 路由器吗？

是否还有其他与 Cisco 兼容的客户端？我喜欢 vpnc，但它只能在 Linux 或 Windows 上的 Cygrin 下运行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-06-09T15:31:54.207

As others have mentioned the built in windows VPN client will not work however the Cisco VPN Client is a bit rubbish, the main gripe is it doesn't work on 64bit windows but even on 32bit windows I used to have many troubles trying to get it to connect.

I would instead reccomend using the Shrew Soft VPN Client, its simple, free, open source and it works. [http://www.shrew.net/download](http://www.shrew.net/download)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-08T11:26:00.990

您可以使用内置的 Windows VPN 客户端（xp 和 Vista），但设置时有一些注意事项。我已经在 PIX 和 ASA 设备上使用额外的 RADIUS 服务器来处理 VPN 用户针对活动目录的身份验证。是否可能取决于您拥有的 Cisco 路由器的型号...

此外，正如 feoh 所说，思科还提供了自己的 VPN 客户端 - 当前版本 5 可用于 32 位 Windows Vista。他们提供的 AnyConnect 客户端也很不错。但是，这两个都仅适用于 Cisco 注册客户。

F。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-01T14:27:59.560

Cisco VPN设备一般都支持ipsec；虽然设置起来比较困难，但它是一个标准，因此您的客户选择应该非常广泛。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T15:50:53.597

我不相信您可以使用内置的 VPN 客户端连接到 Cisco 路由器。至少我还没有找到一种方法来做到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T15:54:33.823

不幸的是，您几乎必须运行 Cisco 的专有 VPN 客户端。值得庆幸的是，现在它一点也不坏。几年前我遇到了可怕的麻烦，但现在它在 Windows 和 MacOSX 上似乎都相当稳定。

（我说的是 Cisco PIX VPN 客户端 FWIW）

# asp.net - 使用 LINQ 进行递归控制搜索

> ID：253937
> 
> 赞同：37
> 
> 时间：2008-10-31T15:37:34.030
> 
> 标签：asp.net, .net-3.5, c#-3.0, linq-to-objects

如果我想在 ASP.NET 页面上找到选中的复选框，我可以使用以下 LINQ 查询。

```
var checkBoxes = this.Controls
                     .OfType<CheckBox>()
                     .TakeWhile<CheckBox>(cb => cb.Checked); 
```

如果复选框嵌套在当前控件集合中，那效果很好，但我想知道如何通过深入到顶级控件的控件集合来扩展搜索。

问题在这里被问到：

[在 ASP.NET 中查找使用特定接口的控件](https://stackoverflow.com/questions/28642/finding-controls-that-use-a-certain-interface-in-aspnet)

并且收到了非 LINQ 的答案，我已经有了自己的类型和 ID 递归控制搜索版本作为扩展方法，但我只是想知道这在 LINQ 中有多容易？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2008-10-31T15:43:57.823

从递归中检查类型/ID，所以只需使用“递归地给我所有控件”的方法，例如

```
public static IEnumerable<Control> GetAllControls(this Control parent)
{
    foreach (Control control in parent.Controls)
    {
        yield return control;
        foreach(Control descendant in control.GetAllControls())
        {
            yield return descendant;
        }
    }
} 
```

这有点低效（在创建大量迭代器方面），但我怀疑你会有一个*非常*深的树。

然后，您可以将原始查询编写为：

```
var checkBoxes = this.GetAllControls()
                     .OfType<CheckBox>()
                     .TakeWhile<CheckBox>(cb => cb.Checked); 
```

（编辑：将 AllControls 更改为 GetAllControls 并正确使用它作为一种方法。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-03T19:08:28.323

```
public static IEnumerable<Control> AllControls(this Control container)
{
    //Get all controls
    var controls = container.Controls.Cast<Control>();

    //Get all children
    var children = controls.Select(c => c.AllControls());

    //combine controls and children
    var firstGen = controls.Concat(children.SelectMany(b => b));

    return firstGen;
} 
```

现在基于上面的函数，我们可以做这样的事情：

```
public static Control FindControl(this Control container, string Id)
{
    var child = container.AllControls().FirstOrDefault(c => c.ID == Id);
    return child;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T16:10:53.433

我对`AllControls`递归的建议是：

```
 public static IEnumerable<Control> AllControls(this Control parent)
    {
        foreach (Control control in parent.Controls)
        {
             yield return control;
        }
        foreach (Control control in parent.Controls)
        {
            foreach (Control cc in AllControls(control)) yield return cc;
        }
    } 
```

第二个`foreach`看起来很奇怪，但这是我知道“扁平化”递归调用的唯一方法。

# c# - 我可以在执行存储过程之前获取行数吗？

> ID：253938
> 
> 赞同：5
> 
> 时间：2008-10-31T15:38:11.190
> 
> 标签：c#, sql-server-2005, stored-procedures, visual-studio-2005, count

我有一些复杂的存储过程，可能会返回数千行，并且需要很长时间才能完成。

有没有办法在查询执行和获取数据之前找出要返回的行数？

这适用于 Visual Studio 2005、Winforms 应用程序和 SQL Server 2005。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-31T15:43:03.457

您提到您的存储过程需要很长时间才能完成。在从数据库中选择行或将行返回给调用者的过程中是否占用了大部分时间？

如果是后者，也许您可​​以创建一个 SP 的镜像版本，它只获取计数而不是实际行。如果是前者，那么您实际上无能为力，因为这是查找符合条件的行的行为，速度很慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T15:42:09.810

制作一个存储过程来首先计算行数。

从表中选择计数（*）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T15:43:13.583

除非您的应用程序的业务逻辑的某些方面允许计算此值，否则不会。数据库必须执行所有 where 和 join 逻辑来确定行的行数，而这是在 SP 中花费的绝大多数时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-31T15:43:14.533

如果不执行该过程，您将无法获得该过程的行数。

您可以创建一个接受相同参数的不同过程，其目的是告诉您另一个过程应该返回多少行。但是，此过程所需的步骤通常与主过程的步骤非常相似，以至于它所花费的时间与执行主过程的时间差不多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-31T15:45:37.273

您必须编写不同版本的存储过程才能获得行数。这可能会快得多，因为您可以消除未过滤的连接表，删除排序等。例如，如果您的存储过程执行了以下 sql：

```
select firstname, lastname, email, orderdate  from 
customer inner join productorder on customer.customerid=productorder.productorderid
where orderdate>@orderdate order by lastname, firstname; 
```

您的计数版本将类似于：

```
select count(*) from productorder where orderdate>@orderdate; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-10-31T15:45:57.570

一般不会。

通过对存储过程操作的了解，您可能能够得到估计或准确的计数（例如，如果能够快速计算查询的“核心”或“基”表，但它是复杂的连接和/或摘要会推动时间向上）。

但是您必须先调用计数 SP，然后再调用数据 SP，或者您可以考虑使用多结果集 SP。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-10-31T15:51:52.893

获取行数可能需要与获取实际数据一样长的时间，因此我不建议在大多数情况下执行计数。

一些可能性：

1) SQL Server 是否以某种方式公开其查询优化器的发现？即你能解析查询然后获得行数的*估计*吗？（我不知道 SQL Server）。

2）也许根据用户给你的标准，你可以自己做一些估计。例如，如果用户在客户姓氏字段中输入“S%”来查询订单，您可以确定匹配 7%（例如）的客户记录，并推断查询*可能*返回大约 7% 的订单记录。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-10-31T15:55:24.913

解决您的问题的方法可能是重写存储过程，以便将结果集限制为某个数字，例如：

```
SELECT TOP 1000 * FROM tblWHATEVER 
```

在 SQL Server 中，或

```
SELECT * FROM tblWHATEVER WHERE ROWNUM <= 1000 
```

在甲骨文。或者实施分页解决方案，使每次调用的结果集小到可以接受。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-10-31T17:01:41.020

继续 Tony Andrews 在他的回答中所说的话，您可以通过以下方式获得对您的查询的调用的估计查询计划：

```
SET showplan_text OFF
GO
SET showplan_all on
GO
--Replace with call you your stored procedure
select * from MyTable
GO 
SET showplan_all ofF
GO 
```

这应该返回一个表或许多表，这些表将使您获得查询的估计行数。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-31T19:22:25.947

您需要分析返回的数据集，以确定返回的结果集的逻辑（有意义的）主键是什么。一般来说，这将比完整的过程快得多，因为服务器不是从每个表的每一行的所有列中的数据构造一个结果集，它只是简单地计算行数......一般来说，它甚至可能不会需要从磁盘读取实际的表行来执行此操作，它可能只需要计算索引节点...

然后编写另一个 SQL 语句，该语句仅包含生成这些键列所需的表（希望这是主 sql 查询中表的子集），以及具有相同过滤谓词值的相同 where 子句...

然后将另一个可选参数添加到名为 @CountsOnly 的存储过程中，默认值为 false (0)，因此...

```
Alter Procedure <storedProcName>
@param1 Type, 
-- Other current params
@CountsOnly TinyInt = 0
As
Set NoCount On

   If @CountsOnly = 1
       Select Count(*) 
       From TableA A 
          Join TableB B On   etc. etc...
       Where < here put all Filtering predicates >

   Else
      <Here put old SQL That returns complete resultset with all data>

  Return 0 
```

然后，您可以调用相同的存储过程并将 @CountsOnly 设置为 1 来获取记录数。调用 proc 的旧代码仍会像以前一样运行，因为如果不包含参数值，则参数值默认设置为 false (0)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-10-31T19:49:31.930

至少在技术上可以运行一个将结果集放在临时表中的过程。然后，您可以在将数据从服务器移动到应用程序之前找到行数，并且不必创建两次结果集。

但我怀疑这是否值得麻烦，除非创建结果集需要很长时间，在这种情况下，它可能足够大以至于临时表会成为问题。几乎可以肯定，通过网络移动大表所需的时间将是创建它所需时间的许多倍。

# deployment - 在 Visual Studio 2005 中找不到安装项目属性

> ID：253964
> 
> 赞同：1
> 
> 时间：2008-10-31T15:44:46.137
> 
> 标签：deployment, visual-studio-2005, setup-project

所有各种帖子，在谈到 vs2005 中的安装项目时，只需说“属性在那里”和/或“在 Studio 中，我只需单击资源管理器中的项目名称，我就会得到其他项目的典型属性窗口，它就在那里。” 但我没有！我得到了一个非常有限的属性列表（输出文件名、包文件（as）：、压缩和 URL。就是这样！你无法相信这是多么令人沮丧！我假设这只是我（不是) 做。请帮助。我如何访问设置属性的 miriad？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-31T15:52:42.783

突出显示您的项目并按 F4。那是属性窗格。右键单击并选择项目属性对话框的属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-05T16:54:48.827

如果键盘设置为 C#，则 F4 键被映射以显示“设置属性”窗格。如果您的默认键盘布局是 C++，则 F4 什么也不做。

# asp.net - 添加本地主机网络服务后，.asmx 在哪里？

> ID：253968
> 
> 赞同：0
> 
> 时间：2008-10-31T15:46:05.293
> 
> 标签：asp.net, web-services

当我添加服务-> 网络服务时。VS2008 添加了一个没有 .asmx 文件的 App_WebReferences 文件夹。我看到一个 .discomap 文件。

当我使用级联下拉 ajax 控件时，它正在服务路径中寻找 .asmx。我做错了吗？我记得 Visual Studio 的早期版本在您添加外部 Web 服务引用时添加了一个 .asmx 文件。

**编辑：**

我不认为我的问题很清楚。我有一个在 localhost/service 上设置的 ASP.net Webservice 应用程序。我想在我的 asp.net 网站中引用该服务。我首先在灵魂添加现有项目中将项目添加到服务中，然后在我的网站上我通过 localhost/service 添加了 Web 引用。它现在有一个文件夹 App_WebReferences 和 service 文件夹以及 service.discomap、service.disco 和 service.wsdl

当我尝试使用级联下拉扩展时。服务路径正在寻找 .asmx 文件，那么如何设置 ajax 扩展的服务路径？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T16:24:45.167

如果下拉菜单需要调用 Web 服务，只需为其提供 Web 服务的 URL（例如：[http://localhost/mywebservice/service1.asmx](http://localhost/mywebservice/service1.asmx)）。我相信您还需要为其指定要调用的 Web 方法的名称。

除非您打算手动调用 Web 服务，否则您不需要向项目添加 Web 引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-10-31T15:48:10.187

您添加了对外部服务的引用。您需要通过右键单击您的项目，然后添加新项目并选择 Web 服务来创建一个新的 Web 服务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-31T15:53:09.473

另请注意，如果您创建一个文件夹，例如 WebServices，并在其中添加 asmx，它会将 .cs 文件放在 App_Code 中。如果您有一个 Web 应用程序项目，我不确定它会放在哪里，因为没有 App_Code。

# oracle - 为什么在通过 Oracle DBLINK 复制时 Char(1) 会更改为 Char(3)？

> ID：253971
> 
> 赞同：3
> 
> 时间：2008-10-31T15:46:23.293
> 
> 标签：oracle, jdbc, dblink

我有 2 个数据库，**我想将包含 CHAR 列的现有表从数据库 A 传输到数据库 B。**

数据库 A 是 Oracle 9i，编码为 WE8ISO8859P1，并包含一个表“foo”，其中至少有 1 列类型为 CHAR(1 char)。我无法更改数据库 A 上的表，因为它是第三方设置的一部分。

数据库B是我自己的Oracle 10g数据库，由于各种原因使用编码AL32UTF8，我想将foo复制到这个数据库中。

我设置了从数据库 B 到数据库 A 的数据库链接。然后发出以下命令：

*从#link#.foo中选择*创建表格栏；*

数据被很好地复制了，但是当我检查列的类型时，我注意到 CHAR(1 char) 已转换为 CHAR(3 char)，并且在查询数据库 B 中的数据时，它都用空格填充.

我认为在水下某处，Oracle 混淆了它自己的字节和字符。CHAR(1 byte) 与 CHAR(1 char) 等不同。我已经阅读了所有这些内容。

**为什么数据类型变为填充的 CHAR(3 char) 以及如何阻止 Oracle 这样做？**

*编辑：这似乎与在 Oracle 9 和 10 的两个特定补丁级别之间传输 CHAR 有关。看起来这确实是一个错误。一旦我发现我会发布更新。同时：不要尝试像我描述的那样在数据库之间移动 CHAR。VARCHAR2 工作正常（经过测试）。*

*编辑 2：**我找到了答案并将其发布在这里：** [Why does Char(1) change to Char(3) when copying over an Oracle DBLINK?](https://stackoverflow.com/questions/253971/why-does-char1-change-to-char3-when-copying-over-an-oracle-dblink#263467) 太糟糕了，我不能接受自己的答案，因为我的问题已经解决了。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T21:17:57.197

此问题是由 Oracle（错误）处理基于原始列长度定义的不同字符集之间的字符转换的方式引起的。当您以字节为单位定义字符类型列的大小时，Oracle 不知道如何进行转换并拒绝它。**解决方案是始终以 characters 定义字符类型的长度**。

要更深入地解释这个问题以及我是如何解决这个问题的，请查看 [http://www.rolfje.com/2008/11/04/transporting-oracle-chars-over-a-dblink/](http://www.rolfje.com/2008/11/04/transporting-oracle-chars-over-a-dblink/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T16:20:01.370

您需要了解 WE8ISO8859P1 NLS（将字符存储在一个字节中）和 AL32UTF8 之间的区别，后者将字符存储在最多四个字节中。您将需要花一些时间阅读 Oracle 国家语言支持 (NLS)[文档](http://www.cs.umbc.edu/help/oracle8/server.815/a67789/ch2.htm#745)。Oracle 通过数据库链接自动进行转换，以提供帮助。

在 SQL 提示符下尝试以下操作：

```
ALTER SESSION NLS_NCHAR WE8ISO8859P1 
create table bar as select * from #link#.foo; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T16:55:15.497

我要尝试的第一件事是将表创建为不是 CTAS，而是使用列定义列表，并尝试执行前几千行的插入。如果那没有成功，那么原因就很清楚了……而且您很快就会确认 Thomas Low 已经死定了。

# diff - 识别热修复/补丁的文件

> ID：253981
> 
> 赞同：1
> 
> 时间：2008-10-31T15:49:22.587
> 
> 标签：diff, patch

我们（有时！）必须为我们的产品发布热修复程序，并通过直接重新发布受影响的文件而不是使用新的安装程序来做到这一点。该产品有大量的代码，一些托管代码，一些非托管。

目前，构建工件（exes、dlls）的开发标志需要在热修复中发布。我们希望能够通过将它们与之前的构建进行比较来自动识别它们。一个简单的二进制差异不起作用，因为所有文件的版本号都已更改，因为如果是构建的一部分，则使用新编号标记文件。

是否有任何工具可以进行更智能的比较并决定应包含哪些文件？我们仍然会让开发人员检查列表，这更多是为了捕获开发人员没有想到的文件，而不是相反。

（注意：更改热修复/构建过程不是一个直接的选择，我们是否应该发送单个文件是一个不同的讨论！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-31T15:58:43.987

这些是我看到的选项：

*   在您的构建机器上获取已更改文件的报告，并使用文件路径的目录结构来确定哪些 dll 真正被更新。不确定这是否违反了您的“无构建过程更改”规则。

*   如果您想等到构建完成后，我建议您使用二进制文件差异工具，例如[http://www.romeotango.com/Downloads/FileCompReadMe.txt](http://www.romeotango.com/Downloads/FileCompReadMe.txt)。使用它，您可以取回一组差异，因此您只需要获取使用该工具的脚本来忽略由于版本号而发生的差异。您可以通过使用受控场景来确定版本号的显示模式，在该场景中，您知道两个二进制文件除了版本号之外是相同的，并注意不同之处。对您的一些 dll 执行此操作，并希望出现足够的模式以便您可以编写脚本。

# ruby - Ruby 和 linux，首选设置？

> ID：253982
> 
> 赞同：24
> 
> 时间：2008-10-31T15:49:29.420
> 
> 标签：ruby, linux, editor, text-editor

Mac 有 TextMate 作为 ruby​​ 开发的首选应用程序，但 linux 的首选应用程序是什么？我需要一些可以轻松使用多个文件、项目结构和设置命令的东西来运行我的 ruby​​ 应用程序，或者如果它是我的一个 merb 应用程序。语法突出显示也是必须的。

现在我通常使用 Vim，但它不是处理多个文件或一个项目结构的最佳选择，即使使用 VTreeView 插件或多个 VIM 窗口也是如此。

那么大家有什么建议呢？

如果你有更好的插件用于 VIM，请随时提及它们，我不排除 VIM 在这里。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-01T17:14:23.147

我在 Windows 和 Linux 上都使用 Vim 在 Rails 中进行开发（我们必须在工作中使用 Windows，而我只在家里使用 Linux）。两个平台的环境几乎完全相同。对我来说特别重要的是在各种 Rails 组件之间轻松导航——从控制器到视图、部分和模型，以及快速导航到测试文件。

以下是我使用的插件：

*   [Tim Pope 的Vim Rails](http://www.vim.org/scripts/script.php?script_id=1567)。:R、:A 和 gf 命令是我主要用于导航的命令。
*   [NERDTree](http://www.vim.org/scripts/script.php?script_id=1658)用于项目/资源管理器视图。
*   [NERDCommenter](http://www.vim.org/scripts/script.php?script_id=1218)用于轻松进行多行评论。
*   [FuzzyFinder](http://www.vim.org/scripts/script.php?script_id=1984)和“ [FuzzyFinder - Textmate](https://github.com/jamis/fuzzyfinder_textmate) ” - 允许您根据文件名的端口快速查找文件。
*   [标签](http://ctags.sourceforge.net/)
*   [浏览器](http://www.vim.org/scripts/script.php?script_id=42)
*   [dbext](http://www.vim.org/scripts/script.php?script_id=356)用于执行 SQL 命令并在 Vim 缓冲区中获取结果。
*   [Ack](http://betterthangrep.com/)和[ack 插件](http://www.vim.org/scripts/script.php?script_id=2572)可在 Vim 中提供更好的 grepping 体验。
*   [VividChalk](http://www.vim.org/scripts/script.php?script_id=1891)配色方案。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-22T10:03:53.467

[JetBrains.com的](http://www.jetbrains.com/)[RubyMine](http://www.jetbrains.com/ruby/index.html)在Mac/Linux/Windows 上运行良好，价格为 99 美元，但它可能是迄今为止我测试过的最高效的 Ruby 和 Rails IDE。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-10-31T15:52:34.687

[将 Gedit 设置为几乎像 Textmate](http://grigio.org/textmate_gedit_few_steps)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-10-31T15:52:16.370

带有[Rails 插件的](http://www.aptana.com/)[Aptana](http://www.aptana.com/)非常好。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-10-31T15:56:08.203

如果您在 Ubuntu/Debian 上，带有[ruby​​-elisp](http://packages.debian.org/etch/ruby-elisp)包的普通旧 emacs 也不错。它不是 TextMate，但还不错。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-07T06:20:32.573

我更喜欢 Linux 和 Mac 上的 Netbeans

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-22T09:42:05.180

+1 用于 Rails 的 Netbeans。每个版本都变得越来越好，而在 6.7 beta 中它变得更好了。在 Windows 和 Mac 上使用它——在 Linux 下我也会使用它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-10-31T16:06:08.810

既然你是一个vimer，你看过[这个](http://rails.vim.tpope.net/)吗？我没有这方面的经验，但在[截屏视频](http://video.google.com/videoplay?docid=2139263225227275468)中看起来相当不错。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-12-21T09:52:30.690

你为什么不直接使用 Sublime Text 2 文本编辑器，它是免费的，跨平台的，比任何 IDE 都轻，然后你可以安装 SublimeCodeIntel，它会为你提供自动完成功能，你可以通过安装 Package Control 来做到这一点，然后

```
 ⌘+shift+p → “install” → ENTER → “codeintel” → ENTER → Restart ST2 
```

它与我完美配合，我完全爱上了这个聪明的编辑器。

如果您想尝试一下，您会发现这很有帮助，[http://www.rockettheme.com/magazine/1319-using-sublime-text-2-for-development](http://www.rockettheme.com/magazine/1319-using-sublime-text-2-for-development)

我将它与 zsh 终端一起使用[http://stevelosh.com/blog/2010/02/my-extravagant-zsh-prompt/](http://stevelosh.com/blog/2010/02/my-extravagant-zsh-prompt/)

无论如何，如果您正在寻找完整的 IDE，请尝试使用 netbeans [http://netbeans.org/projects/ruby/](http://netbeans.org/projects/ruby/)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-10-31T16:00:52.313

我更喜欢Mac 和 Linux 上的[Aptana/RadRails 。](http://www.aptana.com/)无论我使用什么操作系统，它都能为我提供一致的体验。

我仍然没有得到Textmate的兴奋......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-01T16:53:42.020

鉴于您使用 vim， [这篇](http://weblog.jamisbuck.org/2008/10/10/coming-home-to-vim)文章可能会很有趣。

她是帖子中提到的[Fuzzyfinder Textmate vim 插件。](http://github.com/jamis/fuzzyfinder_textmate/tree/master)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-01T16:56:27.660

Aptana Studio 确实很不错。如果您不想要一个完整的 IDE 环境并且更倾向于手动做一些事情，Gedit 也可以完成这项工作 :)。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-09-27T18:40:53.410

其他答案是关于 ruby​​ 编辑器的，所以我想我会在我的 linux 设置上添加一个答案。

我在 Windows 7 上使用带有 VM 播放器（免费）的 Ubuntu。我将 2 个核心和 2 GB 专用于 vm。在 windows 上使用 VM 的好处是我可以将 linux 仅用于开发，而将 windows 用于其他一切。Skype、webex 和团队查看器在 Windows 中工作，但我发现它们在 linux 中不稳定。我也偶尔使用office，在windows上很容易。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-10-03T00:31:33.847

我使用[GMATE](https://github.com/gmate/gmate)已经有一段时间了，我可以说我只需要 gnome-terminal 来完成我的 ruby​​/groovy/python 设置。它具有从 textmate 导入的主题并完成一些方法/属性代码完成（不太好？但它很方便）。

编辑：忘了说 GMATE 是 Gedit 的一组插件（gnome 上的默认文本编辑器）

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2011-10-03T14:33:14.830

Linux 有 3 个非常好的 IDE，而且都是免费的。你有 Eclipse、Netbeans 和 Aptana ......它们都非常好，并且每个都有一些优势，更多的是偏好问题。我建议下载所有 3 个并试一试，看看您更喜欢哪个。

# sql - 通过 MAX() 进行 SQL 搜索

> ID：253987
> 
> 赞同：4
> 
> 时间：2008-10-31T15:52:00.630
> 
> 标签：sql

`select max(DELIVERY_TIMESTAMP) from DOCUMENTS;`将返回最新文档的交付时间。如何返回最新文档**的其他列？**例如，我想要`DOC_NAME`最近交付的文档？

我不确定如何形成该`WHERE`条款。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-10-31T15:55:40.733

你有几个选择

```
SELECT DOC_NAME
FROM DOCUMENTS
WHERE DELIVERY_TIMESTAMP IN (
    SELECT MAX(DELIVERY_TIMESTAMP)
    FROM DOCUMENTS
) 
```

或使用连接

```
SELECT DOC_NAME
FROM DOCUMENTS
INNER JOIN (
    SELECT MAX(DELIVERY_TIMESTAMP) AS MAX_DELIVERY_TIMESTAMP
    FROM DOCUMENTS
) AS M
    ON M.MAX_DELIVERY_TIMESTAMP = DOCUMENTS.DELIVERY_TIMESTAMP 
```

如果时间戳中有重复项或者您的“最大”标准中需要多列（因为`MAX()`所有行只超过一列） ，情况会变得更加复杂

这是`JOIN`选项是唯一可用选项的地方，因为这样的构造不可用（例如具有相同时间戳的多个订单）：

```
SELECT DOC_NAME
FROM DOCUMENTS
WHERE (DELIVERY_TIMESTAMP, ORDERID) IN (
    SELECT TOP 1 DELIVERY_TIMESTAMP, ORDERID
    FROM DOCUMENTS
    ORDER BY DELIVERY_TIMESTAMP DESC, ORDERID DESC
) 
```

实际上，您需要执行以下操作：

```
SELECT DOC_NAME
FROM DOCUMENTS
INNER JOIN (
    SELECT TOP 1 DELIVERY_TIMESTAMP, ORDERID
    FROM DOCUMENTS
    ORDER BY DELIVERY_TIMESTAMP DESC, ORDERID DESC
) AS M
    ON M.DELIVERY_TIMESTAMP = DOCUMENTS.DELIVERY_TIMESTAMP
        AND M.ORDERID = DOCUMENTS.ORDERID 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-10-31T15:54:18.677

```
SELECT
  DELIVERY_TIMESTAMP,
  OTHER_COLUMN
FROM
  DOCUMENTS
WHERE
  DELIVERY_TIMESTAMP = (SELECT MAX(DELIVERY_TIMESTAMP) FROM DOCUMENTS) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-10-31T15:58:29.573

在 MSSQL 中，以下内容也有效：

```
SELECT TOP 1 * FROM DOCUMENTS ORDER BY DELIVERY_TIMESTAMP DESC 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-10-31T15:59:19.260

在某些版本的 SQL（即 MySQL）上，您可以这样做：

```
SELECT *
FROM DOCUMENTS
ORDER BY DELIVERY_TIMESTAMP DESC
LIMIT 1 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-10-31T15:54:16.010

```
Select Max(DELIVERY_TIMESTAMP), 
       Doc_Name
From TableName
Group By Doc_Name 
```

应该这样做，除非我错过了问题中的某些内容。

# c# - 带有属性的反射优化。

> ID：253993
> 
> 赞同：2
> 
> 时间：2008-10-31T15:53:10.550
> 
> 标签：c#, reflection, attributes

C#中有没有办法：

1.  获取具有属性的类的所有属性（而不是必须遍历所有属性然后检查属性是否存在。

2.  如果我想要所有公共、内部和受保护的属性，但不想要私有属性，我找不到这样做的方法。我只能这样做：

    PropertyInfo[] props = type.GetProperties(BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic)

有没有办法避免获得私有财产但得到其他一切。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-10-31T19:21:50.240

关于缓存：如果您通过`TypeDescriptor.GetProperties`then 访问属性，您将免费获得缓存。该类`TypeDescriptor`还有一些其他很好的实用方法，用于像这样的反射情况。它只对`public`属性进行操作（没有`protected`或`internal`成员，也没有字段）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-31T21:40:13.720

没有真正的方法可以*更快地*做到这一点- 但你可以做的是通过缓存数据来减少它的频率。通用实用程序类可能是一种方便的方法，例如：

```
static class PropertyCache<T>
{
    private static SomeCacheType cache;
    public static SomeCacheType Cache
    {
        get
        {
            if (cache == null) Build();
            return cache;
        }
    }
    static void Build()
    {
        /// populate "cache"
    }
} 
```

Then your PropertyCache.Cache has the data just for Foo, etc - with lazy population. You could also use a static constructor if you prefer.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-31T15:57:20.137

我不相信有办法做到这些。

但是，您必须反思多少种类型？真的是瓶颈吗？您是否能够缓存结果以避免每种类型多次执行此操作？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-31T19:19:27.310

回应（2）：如果您不在所讨论的班级/程序集中，`internal`并且`protected`与`private`.

如果您想访问这些，您需要询问所有属性，就像您已经完成的那样，并自己过滤列表。*******