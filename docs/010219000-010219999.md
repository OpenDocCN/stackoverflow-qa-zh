# StackOverflow 问答 10219000-10219999

# jquery - FB.login 生成新窗口并且无法获取访问令牌

> ID：10219003
> 
> 赞同：0
> 
> 时间：2012-04-18T22:26:53.437
> 
> 标签：jquery, facebook, facebook-javascript-sdk, facebook-login

环顾谷歌和 StackOverflow，每个人实际上都有相同的建议：

```
FB.login(function(response) {
    if (response.authResponse) {
        var accessToken = response.authResponse.accessToken;
    }
}); 
```

我在页面上有一个“分享”按钮，当点击时我只想在用户的个人资料上发布一个帖子，并使用[https://graph.facebook.com/me/feed](https://graph.facebook.com/me/feed)调用来做到这一点。为了能够做到这一点，我需要来自 facebook 的 access_token，所以我所做的是：

（在调用 FB.init() 以及添加 all.js 之后）

```
 FB.login(function (response) {
    console.log('response.authResponse: ' + response.authResponse);
     if (response.authResponse) {
                var access_token = FB.getAuthResponse()['accessToken'];
                console.log('Access Token = ' + access_token);
                FB.api('/me', function (response) {
                    console.log('Good to see you, ' + response.name + '.');
                });
     } else {
                console.log('User cancelled login or did not fully authorize.');
     }
  }, { scope: 'user_about_me' }); 
```

我期望发生的是它会为用户打开一个登录对话框到 facebook，一旦他们登录，对话框就会关闭，它会返回到我的页面并且我得到访问令牌。

但是发生的情况是，它会使用登录对话框向 facebook 生成一个新的浏览器窗口，一旦用户登录，页面就会进入用户的新闻提要页面，并且我上面的回调永远不会被调用。所以基本上控制已经消失并转移到新的浏览器窗口，作为用户的正常 facebook 浏览。但是，当我关闭该新窗口时，它会在我的日志记录中执行“用户取消登录”。

我在这里想念什么？所有资源都只是建议调用 FB.login ，这就是我已经在做的事情，但我似乎无法为用户获取访问令牌。

提前致谢！

**编辑：完整代码和更多评论**

```
<script type="text/javascript" language="javascript">
    window.fbAsyncInit = function ()
    {
        FB.init(
        {
            appId: '<%= this.ApplicationId %>', // App ID
            channelURL: '<%= this.ChannelFileUrl %>', // Channel File
            status: true, // check login status
            cookie: true, // enable cookies to allow the server to access the session
            oauth: true, // enable OAuth 2.0
            xfbml: true  // parse XFBML
        });

        // Additional initialization code here
    };

    // Load the SDK Asynchronously
    (function (d)
    {
        var js, id = 'facebook-jssdk'; if (d.getElementById(id)) { return; }
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/<%= this.LocaleCode %>/all.js";
        d.getElementsByTagName('head')[0].appendChild(js);
    } (document));
</script> 
```

然后在一些js文件中调用这个函数（参数还没有被使用，因为还没有真正发帖）

```
function postToFacebook(name, caption, description, link, picture, id) {

var accessToken = "";

console.log('fb event subscribe');
FB.Event.subscribe('auth.login', function () {
    console.log('facebook event auth.login');
});

console.log('fb login');

FB.login(function (response) {
        console.log('response.authResponse: ' + response.authResponse);
        if (response.authResponse) {
            var access_token = FB.getAuthResponse()['accessToken'];
            console.log('Access Token = ' + access_token);
        } else {
            console.log('User cancelled login or did not fully authorize.');
        }
}, {}); 
```

}

发生的顺序是：

1.  打印 'fb 事件订阅'
2.  打印'fb登录'
3.  代码命中 FB.login -> 向 facebook 打开一个新的浏览器窗口，用户登录后焦点停留在该新窗口中，它永远不会进入 FB.login 中的回调函数
4.  如果我关闭上面第 3 步中生成的窗口，则会调用回调函数并“用户取消登录或未完全授权”。被打印（'response.authResponse:' 给出空值）

第 1 步和第 2 步是预期的，第 3 步是问题所在，打开的窗口也有 url [https://www.facebook.com/home.php?_rdr](https://www.facebook.com/home.php?_rdr)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T22:29:54.930

在*[FB.login](http://developers.facebook.com/docs/reference/javascript/FB.login/)*方法的文档中，它清楚地说明了：

> 调用 FB.login 会导致 JS SDK 尝试打开一个弹出窗口。因此，该方法只能在用户点击事件后调用，否则弹出窗口将被大多数浏览器阻止。

如果您想坚持使用客户端流程，那么本教程中提到了可用的选项：[客户端身份验证](http://developers.facebook.com/docs/authentication/client-side/)。

**tsOverflow 编辑：** 基于与 Nitzan Tomer 的聊天讨论，发现了我上面工作的问题：

1.  使用的 AppId 在 facebook 上注册到不同的站点 URL，因此即使您在本地进行测试，也需要确保 AppId 具有相同的域 url
2.  channel.html 丢失了

# asp.net - POST 上缺少请求参数

> ID：10219011
> 
> 赞同：1
> 
> 时间：2012-04-18T22:27:44.487
> 
> 标签：asp.net

我正在重新编写一个 ASP.NET 应用程序并注意到行为上的不同......

在我的 Page_Load 事件中，我有一些代码，例如：

```
string id = Request["id"] 
```

它从 URL 中获取 id 参数。在页面加载（即 HTTP GET）时，这在两个版本中都按预期工作。我还有一个按钮 onclick 事件处理程序。显然，这对服务器执行 POST，并且还调用 Page_Load 处理程序。不同的是，在应用程序的原始版本中，id 是从请求中成功加载的。在新版本的应用程序中，id 返回为 null。我发现我需要使用 Request.Params["id"] 代替，但我完全不明白为什么 Request["id"] 在一个应用程序中适用于 POST 请求而不适用于另一个。

应用程序之间的唯一区别是第一个创建为文件 -> 新网站，第二个创建为文件 -> 新 Web 应用程序。我认为这是导致行为差异的原因，但我想知道为什么会出现这种细微的差异，以及两者之间是否还有其他我应该注意的地方。

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:01:04.377

我总是使用 Web 应用程序项目，但不同之处在于编译。网站有动态编译，这意味着第一次请求会比较慢，并且 web 应用程序有预编译的发布 dll。

检查这个的赞成和反对：http: [//maordavid.blogspot.ca/2007/06/aspnet-20-web-site-vs-web-application.html](http://maordavid.blogspot.ca/2007/06/aspnet-20-web-site-vs-web-application.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:23:59.873

正如您所提到的，您有两次 id 参数。这是因为您在查询字符串参数中有一个，在表单参数中有一个。我不确定为什么会在一个 Web 应用程序中而不是另一个 Web 应用程序中发生这种情况，但是您可以对代码进行更改以以更正确的方式解决它。

如果您在浏览器中查看 HTML 的源代码，您将看到`action`表单的值将是当前页面 URL，包括查询字符串。这就是发送第一个 id 的原因。显然，第二个 id 是通过表单本身传递的：

**基本网页表单的 HTML 源代码**

```
<form method="post" action="Default.aspx?id=3" id="ctl01">
    <input type="text" name="id">
</div> 
```

您可以在这里做几件事：

1.  首先，我不会为此使用[Request.Params](http://msdn.microsoft.com/en-us/library/system.web.httprequest.params.aspx) ["id"]，因为它将查询字符串、表单、cookie 和服务器变量组合到一个集合中。您应该使用[Request.Querystring](http://msdn.microsoft.com/en-us/library/system.web.httprequest.querystring.aspx)和[Request.Form](http://msdn.microsoft.com/en-us/library/system.web.httprequest.form.aspx)属性，根据您的需要和时间
2.  在您的 Page_Load 处理程序中，使用[Page.IsPostBack](http://msdn.microsoft.com/en-us/library/system.web.ui.page.ispostback.aspx)属性来确定页面是为 GET 还是 POST 加载，并使用上述的 Request 属性。

Page.IsPostBack 用法示例：

```
protected void Page_Load(object sender, EventArgs e)
{
    string id = string.Empty;
    if (Page.IsPostBack)
    {
        id = Request.Form["id"];
    }
    else
    {
        id = Request.QueryString["id"];
    }
} 
```

# c# - 为什么 Java 用于低延迟，而 C# 却不是？

> ID：10219014
> 
> 赞同：4
> 
> 时间：2012-04-18T22:27:52.010
> 
> 标签：c#, java, .net

Java 和 C# 几乎相同，都有垃圾收集器、类似的内存模型（嗯，至少与 C++ 相比）、类似的内存分配（我认为）但 Java 经常用于低延迟应用程序（不如 C++ 多）而 C# 并不是真的..

为什么 C# 与 Java 非常相似，但没有在这些环境中使用，是否有任何技术原因？内存模型等有区别吗？是因为 Java 有不同的 JVM/垃圾收集器吗？更好的调整参数？

编辑：在下面的评论之一之后，我相信这个（封闭的）问题的答案是 C# 将系统限制为基于 Windows。Linux 允许将服务器调整到更少的上下文切换，因此提供了更大的低延迟机会，而不是与 C# 语言本身有关。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:35:31.233

问：你怎么可能期待一个错误前提的有效答案？

相关链接：

*   [http://msdn.microsoft.com/en-us/magazine/gg232761.aspx](http://msdn.microsoft.com/en-us/magazine/gg232761.aspx)

*   [http://www.elitetrader.com/vb/printthread.php?threadid=204368](http://www.elitetrader.com/vb/printthread.php?threadid=204368)

# parameters - 如何通过 YouTube 的 URL 参数更改缩略图/海报图像？

> ID：10219017
> 
> 赞同：2
> 
> 时间：2012-04-18T22:28:03.550
> 
> 标签：parameters, youtube, youtube-api

我已经用谷歌搜索了这个。我从谷歌搜索中得到的只是查看/下载 YouTube 在用户上传视频时为用户创建的三张图片 (0-2) 的方法。这里的例子：[http ://www.reelseo.com/youtube-thumbnail-image/](http://www.reelseo.com/youtube-thumbnail-image/)

我想知道是否有人知道在嵌入视频时选择三个图像中的哪一个用作海报图像的方法。示例：[http ://www.youtube.com/embed/_z-hEyVQDRA?rel=0&showinfo=0&thumbnailVersion=2](http://www.youtube.com/embed/_z-hEyVQDRA?rel=0&showinfo=0&thumbnailVersion=2)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T19:26:53.340

我不知道这样做的方法（我以前看过），所以我的解决方案本质上是在容器中显示缩略图，并在单击拇指/容器时添加/显示嵌入。就像是

[http://jsfiddle.net/brysmi/RnN7R/](http://jsfiddle.net/brysmi/RnN7R/)

我会把缩略图制作成播放器 div 背景或类似的东西。此外，如果您想要更大的播放器/拇指，您将不得不查看您已经找到的东西，以找出[http://img.youtube.com/vi/sftuxbvGwiU/2.jpg](http://img.youtube.com/vi/sftuxbvGwiU/2.jpg)的 hq 大小版本的网址。 .

在那之后，祝你好运。

另请参阅[如何从 YouTube API 获取 YouTube 视频缩略图？](https://stackoverflow.com/questions/2068344/how-to-get-thumbnail-of-youtube-video-link-using-youtube-api), [Youtube JSAPI, 示例不工作](https://stackoverflow.com/questions/9993061/youtube-jsapi-examples-not-working), [YouTube iframe API：如何控制已经在 HTML 中的 iframe 播放器？](https://stackoverflow.com/questions/7443578/youtube-iframe-api-how-do-i-control-a-iframe-player-thats-already-in-the-html)

等等。干杯。

# php - 在 CakePHP 中更新和删除唯一的连接关系

> ID：10219020
> 
> 赞同：2
> 
> 时间：2012-04-18T22:28:36.990
> 
> 标签：php, mysql, cakephp

**编辑：我需要帮助的是删除 topic_posts 表中主题和帖子之间的所有关系，以便清理关系并删除旧的关系。然后其余代码应该可以正常工作，因为所有问题都将得到解决，因为我们在添加它们之前删除了关系。**

在我的 CakePHP 应用程序中，我有 Posts 和 Topics（主题是唯一的并且有一个 id），它们通过处理帖子和主题之间关系的 Topic_Posts 相互链接。

但是，如果用户编辑具有关系的帖子并保存它，而不是仅仅修改关系，它将在 Topic_posts 表中复制它们，并且如果用户从帖子中删除主题，也不会删除它们！

处理这个问题的最佳方法是什么？我听说过关于删除该帖子的所有关系然后重新添加它们的讨论是处理所述场景的最干净和最好的方法，但是我该怎么做呢？

这是处理主题保存的代码（它确实检查主题是否重复）但不检查它们是否是重复的关系，也不会删除关系。

```
public function savePostTopics($postId, $topics)
    {
        // Explode the topics by comma, so we have an array to run through
        $topics = explode(',', $topics);
        // Array for collecting all the data
        $collection = array();

        foreach($topics as $topic)
        {
            // Trim it so remove unwanted white spaces in the beginning and the end.
            $topic = trim($topic);

            // Make it all lowercase for consistency of tag names
            $topic = strtolower($topic);

            // Check if we already have a topic like this
            $controlFind = $this->find(
                'first',
                array(
                    'conditions' => array(
                        'title' => $topic
                    ),
                    'recursive' => -1
                )
            );

            // No record found
            if(!$controlFind)
            {
                $this->create();
                if(
                    !$this->save(
                        array(
                            'title' => $topic
                        )
                    )
                )
                {
                    // If only one saving fails we stop the whole loop and method.
                    return false;
                }
                else
                {
                    $temp = array(
                        'TopicPost' => array(
                            'topic_id' => $this->id,
                            'post_id' => $postId
                        )
                    );
                }
            }
            else
            {
                $temp = array(
                    'TopicPost' => array(
                        'topic_id' => $controlFind['Topic']['id'],
                        'post_id' => $postId
                    )
                );
            }

            $collection[] = $temp;
        }

        return $this->TopicPost->saveMany($collection, array('validate' => false));
    } 
```

以下是关联：

```
Post.php
class Post extends AppModel
{
    public $name = 'Post';

    public $belongsTo = 'User';

    public $hasMany = array('Answer');

    // Has many topics that belong to topic post join table... jazz
    public $hasAndBelongsToMany = array(
        'Topic' => array('with' => 'TopicPost')
    );
}

Topic.php
class Topic extends AppModel
{
    public $hasMany = array(
        'TopicPost'
    );
}

TopicPost.php
class TopicPost extends AppModel {
    public $belongsTo = array(
        'Topic', 'Post'
    );
} 
```

编辑：我已完成以下操作以使两列彼此唯一：

```
`id` int(11) unsigned NOT NULL auto_increment,
  `topic_id` int(11) NOT NULL,
  `post_id` int(11) NOT NULL,
  PRIMARY KEY  (`id`),
  UNIQUE KEY `unique_row` (`topic_id`,`post_id`) 
```

但是当我进行更新时，我得到一个 SQL 错误，所以基本上 Cake 没有正确处理这个问题......我该如何解决这个问题，因为它只是通过防止数据重复来部分解决问题！另外，当我希望从 topic_posts 中删除关系但不知道该怎么做时，我该如何处理？

```
Database Error
Error: SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry '2-107' for key 2

SQL Query: INSERT INTO `db52704_favorr`.`topic_posts` (`topic_id`, `post_id`) VALUES (2, 107) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T23:27:21.440

首先，您不需要`id`Topic_Posts 中的列。您应该删除它，而是使用它：

```
 `topic_id` int(11) NOT NULL,
  `post_id` int(11) NOT NULL,
  PRIMARY KEY  (`topic_id`, `post_id`) 
```

这意味着添加到帖子中的每个主题只能添加一次（这实际上是您现在所拥有的，只是更加整洁）。

更新帖子时出现 SQL 错误的原因是因为您将每个主题添加到 Topic_Posts 中的帖子中，无论它们之前是否存在。

你的代码片段说：

*   对于用户添加到帖子中的每个主题，请执行以下操作：
    *   如果主题不存在，则将其添加到 Topic 表中（您似乎忘记在此处将其添加到 Topic_Posts 表中）
    *   如果主题确实存在，将其添加到 Topic_Posts 表中（不检查它是否已经存在）

相反，您希望它这样说：

*   对于用户添加到帖子中的每个主题，请执行以下操作：
    *   如果topic不存在，先添加到Topic表中，再添加到Topic_Posts表中（由于是Topic_Posts中的外键，所以必须先在Topic表中创建）
    *   如果主题确实存在...
    *   如果该帖子在 Topic_Posts 表中不存在，则添加它，否则忽略它

**处理删除主题的另一种方法可能是：**

*   从当前帖子的 Topic_Posts 中删除所有行
*   对于用户添加到帖子中的每个主题，请执行以下操作：
    *   如果topic不存在，先添加到Topic表中，再添加到Topic_Posts表中（由于是Topic_Posts中的外键，所以必须先在Topic表中创建）
    *   如果主题确实存在，则将其添加到 Topic_Posts 表

您无需担心以这种方式检查 Topic_Posts 中该帖子是否存在主题，因为第一步是删除该帖子的所有主题。

希望有帮助。

# iphone - iPhone 应用程序以 20（左右）像素高的窗口开始

> ID：10219021
> 
> 赞同：0
> 
> 时间：2012-04-18T22:28:38.287
> 
> 标签：iphone, viewcontroller

每次我开始构建应用程序时，主屏幕都会从屏幕底部的白条开始。它仅在主视图控制器上，如果我切换到另一个视图然后返回视图，白条不存在......为什么会发生这种情况？我认为这与我如何在 appDelegate 中实现视图有关......这是我实现它的方式：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {    

// Override point for customization after application launch.
StartUpScreen *main = [[StartUpScreen alloc] initWithNibName:@"StartUpScreen" bundle:nil];
self.viewController = main;
[window addSubview:main.view];
[main release];
[window makeKeyAndVisible];

return YES; 
```

如果您需要更多详细信息，请告诉我。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:47:11.150

我不确定这是否会解决您所描述的问题，但您应该这样做：

```
window.rootViewController = main; 
```

代替：

```
[window addSubview:main.view]; 
```

# android - ADK 闪烁教程：板载 LED 常亮

> ID：10219034
> 
> 赞同：1
> 
> 时间：2012-04-18T22:29:12.060
> 
> 标签：android, arduino, adk

我有一个[Duemilanove](https://rads.stackoverflow.com/amzn/click/com/B001VK18HC)和[ADK](http://www.elechouse.com/elechouse/index.php?main_page=product_info&cPath=74&products_id=2149)，我遵循[了这个](http://allaboutee.com/2011/12/31/arduino-adk-board-blink-an-led-with-your-phone-code-and-explanation/)，除了一些 SDK 更新之外，我完全遵循了它。

问题：板载 LED 不闪烁但一直亮着。

问题：

*   字节数组正在从手机成功发送到ADK，通过监控arduino板的串口验证
*   在 arduino 代码中正确处理了高和低信号（相同的验证）。
*   没有 ADK 的闪烁教程正确闪烁板载 LED。

那么，有什么问题呢？ADK 板是否可能总是向板载 LED 发送高电平信号，而我需要使用“外部”LED 进行测试？我见过的很多教程都是这样做的，这可能是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T16:10:39.610

The onboard Arduino LED is on initially. It looks like it is never being turned off.

In the [linked instructions](http://allaboutee.com/2011/12/31/arduino-adk-board-blink-an-led-with-your-phone-code-and-explanation/), under the section *How To Receive Data From The Android Device* , the first line of the `loop()` function is:

```
byte msg[0]; 
```

Then to receieve data in the call to `AndroidAccessory.read()` the value `sizeof(msg)` is used to determine how many bytes to read.

However, because `msg` was defined to be 0 bytes long, no bytes will be read, `len` will be zero and the LED will not be updated.

Instead, try changing the line to:

```
byte msg[1]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-30T02:26:46.693

我没有使用您正在使用的屏蔽，但它看起来像使用 SPI 进行通信。SPI 使用引脚 13 作为串行时钟信号 (SCK)。鉴于此，我预计 SCK 信号可能会干扰您尝试控制 LED。

我建议尝试将 LED 连接到不同的数字引脚，例如引脚 8，并更新 Arduino 草图以使用引脚 8。这将消除冲突的可能性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T14:22:43.040

尝试编写一个小闪烁程序，以检查您的 ADK 板上的一切是否正常。

# jquery - 在 jquery 上发送 $.post 后启用链接

> ID：10219035
> 
> 赞同：0
> 
> 时间：2012-04-18T22:29:23.373
> 
> 标签：jquery, click

我正在尝试在启用点击之前发送一些 ajax POST。

我试过这个：

```
$('.unread a').click(function(){
    ele = $(this);
    $.post('ajax/notification.php', {
    info : ele.attr('title')
    }, 
    function(data) {
        if(data != 'frack') {
            ele.addClass("read");
            ele.removeClass("unread");
            window.location = ele.attr("href");
        }
    });
    return false;
}); 
```

但是当我点击链接时，它直接进入页面而没有时间发送 $.post。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:31:19.613

这应该可以防止链接将您发送到某个地方

```
$('.unread a').click(function(e){
       e.preventDefault(); 
```

[http://api.jquery.com/event.preventDefault/](http://api.jquery.com/event.preventDefault/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:32:05.560

这可以防止链接执行它的默认操作

```
 preventDefault(); 
```

所以

```
$('.unread a').click(function(e){
    e.preventDefault();
    ele = $(this);
    $.post('ajax/notification.php',
                 { info : ele.attr('title')
                    }, 
        function(data) {
        if(data != 'frack'){
                ele.addClass("read");
                ele.removeClass("unread");
                window.location = ele.attr("href");
            }
        });
    return false;
}); 
```

# linux - linux重启详细流程

> ID：10219037
> 
> 赞同：0
> 
> 时间：2012-04-18T22:29:29.940
> 
> 标签：linux, linux-kernel, system-calls, reboot

我对如何在 Linux 中实现重启很感兴趣。当我按 ctrl-alt-del 或单击菜单栏中的“重新启动”时，接下来会发生什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:36:23.390

以安全的方式关闭系统。所有登录的用户都会收到系统正在关闭的通知，并且 login(1) 被阻止。可以立即关闭系统或在指定的延迟后关闭系统。SIGTERM 信号首先通知所有进程系统正在关闭。它通过向 init 进程发出信号，要求它更改运行级别来完成其工作。运行级别 0 用于停止系统，运行级别 6 用于重新启动系统，运行级别 1 用于使系统进入可以执行管理任务的状态；所以基本上重新启动称为“关机”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:48:08.320

快速回答是 /etc/rc6.d 中的所有脚本都已执行。

以“K”开头的脚本使用“stop”参数执行。以“S”开头的脚本使用“start”参数执行。

有关更多信息，您可以在此处开始阅读有关运行级别的信息：[http ://en.wikipedia.org/wiki/Runlevel](http://en.wikipedia.org/wiki/Runlevel)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-16T16:13:50.957

Linux 上有不同的 init 系统，它们还控制重新启动/关闭时发生的情况。请参阅[https://unix.stackexchange.com/questions/18209/detect-init-system-using-the-shell](https://unix.stackexchange.com/questions/18209/detect-init-system-using-the-shell)以了解您正在使用哪个。

如果您使用的是 SysVinit，则存在与整个系统状态相关联的[运行级别。](https://en.wikipedia.org/wiki/Runlevel)init 系统将首先运行与当前运行级别相关的所有终止脚本，然后运行与运行级别 6 相关的启动脚本。如果当前运行级别为 5，它将运行 /etc/rc5.d/K* 然后 /etc/rc6 .d/S*。它们可能位于另一个目录中，例如 /etc/init.d/rc5.d/k*，具体取决于您的 Linux 发行版。

如果您使用的是 systemd，那么将有一个已定义目标和服务的列表，而不是一个整体的“运行级别”。目标列表本质上是一个运行级别。这些在 /etc/systemd 下的 .service 和 .target 文件中定义。那里可能会定义一个“rebo​​ot.target”，其他依赖于它的服务将在重新启动时运行。有关示例，请参阅[systemd 主页](https://www.freedesktop.org/wiki/Software/systemd/)或此[stackexchange 问题](https://unix.stackexchange.com/questions/39226/how-to-run-a-script-with-systemd-right-before-shutdown)。

一些 Ubuntu 版本也使用 upstart，但我认为在最近的版本中它已被 systemd 取代。如果您使用的是新贵，请参阅[本指南](http://upstart.ubuntu.com/cookbook/)或[此 askubuntu 问题](https://askubuntu.com/questions/78298/how-do-i-configure-upstart-to-run-a-script-on-shutdown-when-the-process-takes-lo)。

需要注意的一件事是，无论您使用哪个初始化系统，您都可能使用通常与另一个相关联的初始化脚本。因此，您可能正在使用 sysVinit，但某些 rc*.d 脚本可能是指向调用 systemd 脚本的事物的链接。或相反亦然。

# sql - Oracle SQL 查询计数，通过内部连接分组？

> ID：10219041
> 
> 赞同：1
> 
> 时间：2012-04-18T22:30:01.017
> 
> 标签：sql, oracle, count

基本上我有一堆属于经销商的汽车，经销商有一个小组。经销商表具有 GROUP.ID，组表具有组名。一个集团有多个经销商

所以我想计算每组有多少辆车。

我正在使用这个自动取款机

```
select  
  (select GROUP_NAME from "GROUP" where "GROUP".GROUP_ID = "DEALER"."GROUP_ID" ),
  "DEALER"."GROUP_ID" as "DEALER GROUP ID",
  "DEALER"."DEALER_NAME" as "DEALER DEALER NAME",
  "CAR"."CAR_DEALER" as "CAR DEALER"         
from 
  "CAR"
INNER JOIN 
  DEALER
ON 
  "DEALER"."DEALER_NAME" ="CAR"."CAR_DEALER" 
```

我试过使用`group_by`，`count`但我似乎无法让它工作

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T22:46:25.953

```
select
  g.GROUP_NAME,
  g.GROUP_ID,
  count(*) as CAR_COUNT
from
  GROUP g
  inner join DEALER d on d.GROUP_ID = g.GROUP_ID
  inner join CAR c on c.DEALER_ID = d.DEALERID
group by
  /* Also add here all field you want to select from GROUP */
  g.GROUP_NAME,
  g.GROUPID 
```

# django - Django在点击时添加文本字段

> ID：10219043
> 
> 赞同：0
> 
> 时间：2012-04-18T22:30:09.870
> 
> 标签：django, json, forms, simplejson

我正在写一个 django 食谱网站，并且对 JSON 字段和表单有疑问

我正在尝试为该站点编写创建配方功能，并想做两件事：

1.  我想在鼠标单击时添加文本字段，类似于添加电子邮件附件。我想使用 JSONField 这样做（除非 picklefield 更好）

2.  我希望用户能够在一个文本字段中编辑食谱。我希望我可以将所有步骤打包到一个文本字段中，并允许他们编辑该字段，然后将它们解压缩到步骤中。否则用户可能会因为必须编辑每个单独的步骤而感到困惑。

这是我来自 django 项目的模型：

```
class Cookbook(models.Model):
    def __unicode__(self):
        return self.name
    name = models.CharField(max_length=50)
    pub_date = models.DateTimeField('date published')
    user = models.ForeignKey(User, related_name='cookbooks')
    recipes = models.ManyToManyField('Recipe', related_name = 'cookbooks')

class Recipe(models.Model):
    def __unicode__(self):
        return self.name
    original_cookbook = models.ForeignKey(Cookbook)
    name = models.CharField(max_length=200)
    author = models.CharField(max_length= 100)
    picture = models.ImageField(upload_to = 'Downloads', blank=True)
    pub_date = models.DateTimeField('date published', auto_now_add=True, blank=True)
    ingredients = JSONField()
    steps = JSONField()
    prep_time = models.IntegerField() 
```

这是我创建新配方的视图。现在我不确定如何在我的视图中使用 JSONField。

我找到了这个[链接](http://djangosnippets.org/snippets/377/)，但它说“最后，我还不确定如何与表单交互，所以这个领域有点模糊。” 看到我用的是表格，这个问题解决了吗？

```
def createrecipe(request):
    if not request.user.is_authenticated():
        return HttpResponseRedirect('/index/')
    else:
        if request.method == 'POST':
            form = RecipeForm(request.POST)
            if form.is_valid():
                recipe = form.save(commit=False)
                recipe.original_cookbook = request.user.cookbooks.all()[0]
                recipe.pub_date = datetime.datetime.now()
                recipe.save()
                user = request.user
                cookbooks = user.cookbooks
                cookbook = cookbooks.all()[0]
                cookbook.recipes.add(recipe)
                return HttpResponseRedirect('/account')
        else:
            form = RecipeForm()

        return render_to_response('cookbook/createrecipe.html',
                                    {'form':form},
                              context_instance=RequestContext(request)) 
```

这是 createrecpe.html 块内容：

```
{% block content %}
    <form action="." method="POST">
        <table>
            {% csrf_token %}
            {{ form.as_table }}
        </table>
        <p><input type="submit" value="Submit"></p>
    </form>
{% endblock %} 
```

我很难弥合 JSONField 模型和视图之间的差距，以便在 JSON 字段中显示/输入文本。我也很困惑如何在模板中显示 jsonfield。

谢谢你的帮助，这真的让我很沮丧，

零食鱼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T05:12:28.127

您可以在此处使用[表单集](https://docs.djangoproject.com/en/1.4/topics/forms/formsets/)。在您的情况下 - 使用[django-jsonfield](https://github.com/bradjasper/django-jsonfield)或[django-picklefield](http://pypi.python.org/pypi/django-picklefield)以避免手动转换对象保存和检索的数据，并创建一个在 init 上提供空列表的表单集。

您可以使用 js 在客户端对其进行操作，但不要忘记在 TOTAL_FORMS 隐藏输入中增加表单计数。在发布表单并清理数据后`formset.cleaned_data()`，您可以将其放入 PickleField 中而无需任何额外处理（`initial`如果您需要编辑配方，则可以将来自该字段的数据放入表单集）。

# php - 无法在页面之间存储会话数据

> ID：10219049
> 
> 赞同：0
> 
> 时间：2012-04-18T22:31:17.670
> 
> 标签：php, session, header

我在所有 php 项目中都面临一个问题，因为我使用了 OOP，如果有用户提交表单

当它去处理它并且如果它有错误我在会话中保存一条消息并将它们重定向到同一页面

这是一个示例，当然，当它重定向时，它会擦除​​那里的所有字段

比如说我有一个注册表单

```
<?php if(!empty($message)) { echo $message } ?>
<form action ="forms/register.php">
first name: <input type="text" name="first_name" />
username:<input type="text" name="username" />
<input type="submit" value = "submit" />
</form> 
```

这就是 forms/register.php 中的代码

```
 if(isset($_POST['submit'])) {
    $first_name = $_POST['first_name'];
    $username = $_POST['username'];

 if(empty($first_name) || empty($username) {
    $session -> message("please fill in all the fields");
    redirect("../register.php");
 } else {
    // do something else like insert query
 }

 } 
```

我的问题是如果 first_name 或 user_name 为空，它会重定向到 register.php

它回显了错误消息，没有问题

但字段为空 first_name 和 user_name 为空

所以用户必须再次填写

所以我的一位朋友建议将其保存在会话中或其他内容中

所以我想知道这是否可能，那么我的意思是如何以及我的意思是什么，所以没有人会弄错，我的意思是不是复制它并粘贴它的代码的方式

提前致谢

很抱歉又长又烦

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:37:46.307

您可以在页面重定向后在会话变量中存储您希望保留在表单中的任何值，然后在表单页面上检索这些值并在`value`表单元素的属性中回显它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:33:35.087

```
session_start(); $_SESSION['nick'] = $_GET['nick']; 
```

更多/更好的例子：

[http://php.net/manual/en/function.session-start.php](http://php.net/manual/en/function.session-start.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T22:37:02.687

不确定您到底面临什么问题（以及您的工作流程中的 $session 是什么？）。但是，我建议使用 PHP 内置会话支持。 [http://php.net/manual/en/features.sessions.php](http://php.net/manual/en/features.sessions.php)

从上面的链接本身：

```
<?php
session_start();

if(isset($_SESSION['views']))
{
    $_SESSION['views']=$_SESSION['views']+1;
}
else
{
    $_SESSION['views']=1;
    echo "Views=". $_SESSION['views'];
}
?> 
```

上面的代码只是跟踪页面浏览量。$_SESSION 变量在页面加载之间持续存在，您应该对所有会话要求使用相同的变量。

# erlang - 中断 Erlang 中的进程

> ID：10219058
> 
> 赞同：0
> 
> 时间：2012-04-18T22:32:07.350
> 
> 标签：erlang

我是二郎的新手。我想知道是否可以在 erlang 中中断处理器。假设我们有处理器 x 执行一个需要很长时间才能执行的函数 f1()。我想找到一种有效的方法来中断处理器 x 以执行函数 f2() 并在执行 f2() 之后返回执行 f1() 从它被中断。

这样做的一种方法（虽然不完全是我想要的）是让 f1() 由处理器（命名为 f1_proc）执行，而 f1_proc 的创建者等待诸如 [interrupt, f1_terminated, etc ..] 之类的消息如果收到中断，则执行 f2()。

然而，这并不是我想要的。如果 f2() 取决于 f1() 怎么办？在这种情况下，f1() 被暂停，f2() 被执行，然后 f1() 应该从它停止开始。我知道我们可以终止一个进程，但我们可以暂停它们吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T18:55:44.820

你的问题的答案是否定的，这是不可能的。如果进程内部没有任何钩子（例如`receive`子句），就无法从“外部”暂停进程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:53:13.220

考虑到您正在尝试使用 erlang 进程，我认为您的问题标题（处理器）有点误导。

您应该尝试使用 erlang [hibernate command](http://www.erlang.org/doc/man/erlang.html#hibernate-3)。直接来自上面的文档链接：

```
Puts the calling process into a wait state where its memory allocation 
has been reduced as much as possible, which is useful if the process 
does not expect to receive any messages in the near future. 
```

使用计时器和进程之间的消息传递，您可以强制您的工作流程。即，如果需要太多时间，则暂停一个，而另一个则继续工作。

* * *

尽管您的用例在问题中不是很清楚，但您也可以让两个（实际上更多）进程并行工作，而不必相互等待，并且在进程完成工作后也会收到通知。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T10:56:33.263

一种方法是简单地在不同的进程中启动这两个函数。当 f2() 依赖于 f1() 的结果时，它`receive`是带有所需数据的消息。当 f1() 计算完该数据后，它会将其发送到 f2() 进程。

如果 f2() 过早到达接收子句，它将自动暂停并等待消息到达（因此让 f1() 继续工作）。但是，如果 f1() 先完成，它将继续执行其他任务，直到 Erlang 进程调度程序自动抢占。

您也可以通过让 f1() 等待来自 f2() 的消息来暂停 f1()。在这种情况下，请确保 f1() 在发送消息后等待以避免死锁。

例子：

```
f1(F2Pid) ->
   Data = ...,
   F2Pid ! {f1data, Data},
   ... continue other tasks ....

f2() ->
   ... do some work ...,
   Data = receive
             {f1data, F1Data} -> F1Data
          end,
   ... do some work with Data ....

main() ->
   F2Pid = spawn_link(?MODULE, f2, []),
   f1(F2Pid). 
```

这种消息传递是 Erlang 编程模型的基础。你不需要发明同步或锁。只需收到一条消息，Erlang 就会确保您收到该消息（并且仅该消息）。

我不知道您是如何学习 Erlang 的，但我推荐Cesarini & Thompson (O'Reilly)的*Erlang Programming一书。*这本书非常详细地和很好的例子涵盖了你需要知道的关于消息传递和并发的所有内容。

# nosql - 强制在 cassandra 中进行轻微压缩？

> ID：10219067
> 
> 赞同：2
> 
> 时间：2012-04-18T22:33:43.283
> 
> 标签：nosql, cassandra

有没有办法在 cassandra 中强制进行轻微压缩？

我尝试在有待处理任务的节点上使用 nodetool 将压缩阈值设置为 4 4，但没有任何反应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-22T23:07:37.930

为什么你想要一个小压缩而不是一个大压缩？

当您将压缩阈值设置为 4 4 时，有多少个 SSTable？如果少于 4 个，则不会触发次要压缩，因为它不符合压缩阈值。

您可以通过查看其中一个键空间中的文件来检查您的 SSTable 及其大小。它应该看起来像这样：

```
andrew@spite:/var/lib/cassandra/data/test_ks $ du -ch *
4.0K    Users-hc-1-Data.db
4.0K    Users-hc-1-Digest.sha1
4.0K    Users-hc-1-Filter.db
4.0K    Users-hc-1-Index.db
8.0K    Users-hc-1-Statistics.db
4.0K    Users.Users_name_idx-hc-1-Data.db
4.0K    Users.Users_name_idx-hc-1-Digest.sha1
4.0K    Users.Users_name_idx-hc-1-Filter.db
4.0K    Users.Users_name_idx-hc-1-Index.db
8.0K    Users.Users_name_idx-hc-1-Statistics.db
48K total
andrew@spite:/var/lib/cassandra/data/test_ks $ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T20:47:55.517

不，只能手动触发主要压缩。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-16T14:40:26.497

0.7 版的[Datastax 文档](http://www.datastax.com/docs/0.7/operations/scheduled_tasks)说，次要压缩“定期自动执行”，这表明您不能强制进行次要压缩，而必须等待发生。据推测，如果有必要，您只需等待足够长的时间。

# php - 文章中的 Joomla 动态内容

> ID：10219070
> 
> 赞同：1
> 
> 时间：2012-04-18T22:33:55.383
> 
> 标签：php, joomla, joomla1.7, joomla-template

我是 Joomla 的新手，我目前正在尝试为一所大学建立一个信息门户，其中将包含有关所有教职员工的信息。要显示的信息将包括他们教授的科目、总经验、电话号码、电子邮件 ID、地址等信息。

处理这个问题的正常方法是写一篇关于每个教员的新文章。但我希望这更有活力。我不喜欢为每个教师创建一篇新文章的想法。我正在寻找一种将所有信息（主题、电子邮件、电话等）存储在数据库中的方式，并且在显示所有信息时应该从数据库本身获取并以预先格式化的方式显示。

如果有人对此有任何想法，请告诉我。非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:56:25.123

我会使用像[K2](http://getk2.org/)这样的 CCK 插件并添加额外的字段组，[像这样](http://www.joomtraining.com.au/tutorials/k2/using-extra-fields)......这样就可以在管理员中添加它。以这种方式完成您对多种类型的内容所做的事情。

## 更新：刚刚想起[了这个很棒的小组件](http://extensions.joomla.org/extensions/extension/core-enhancements/coding-a-scripts-integration/joodatabase)，叫做 joodatabase

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:54:30.137

您可以在您的文章中包含一个外部 PHP 脚本，并让 php 脚本根据查询字符串参数（可能像教师 ID 或其他东西）来处理数据。为此，您需要安装一个模块。`http://extensions.joomla.org/extensions/edition/custom-code-in-content/60`. 使用这个模块，您应该能够在文章中包含一个 php 脚本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T22:37:28.707

您可以创建一个模块，或者使用 Joomla 扩展目录中的一个（您正在寻找一个目录模块）。Joomla 中的一个模块将允许您访问存储在数据库中的数据。

[http://extensions.joomla.org/search?q=directory](http://extensions.joomla.org/search?q=directory)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-19T18:17:46.000

旧线程但仍然是一个热门话题我认为带有 TinyButStrong 的动态文章可以解决这个问题 [https://www.tinybutstrong.com/plugins/joomla/tinybutstrong_help.html](https://www.tinybutstrong.com/plugins/joomla/tinybutstrong_help.html)

例如，如果不存在文章，则将标签或搜索参数添加到内容中。更多幻想的地方

# javascript - html - 如何防止浏览器打开 href 中指定的链接？

> ID：10219073
> 
> 赞同：14
> 
> 时间：2012-04-18T22:34:15.417
> 
> 标签：javascript, html, href

我目前正在制作一个文件浏览器。如果用户单击文件的链接，则会打开一个小窗口并询问选项（如下载和查看）。我已经使用 onclick 属性完成了这项工作。如果我单击该链接，则会执行 javascript，但此后会打开 href 中指定的 url。我想做的是：如果您单击链接 javascript 将被执行并最终转发给您。但是，如果链接被右键单击，“复制链接位置”应该仍然可用。我正在考虑通过阻止转发脚本来解决这个问题。因此，如果链接被右键单击，则不会执行任何 javascript，您可以复制链接位置。但是，如果您左键单击该链接，则会执行 javascript 并且不会打开该链接。javascript可以做到这一点，还是有其他方法可以实现这种行为？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-18T22:36:53.577

为了防止链接执行，一种方法是让“onclick”方法返回`false`。

例如：

```
<a href="http://..." onclick="return clickfunc()">...</a> 
```

如果`clickfunc()`返回`false`，点击链接不会指向“http://...”

尽管您可能更像是处理它

```
<a href="http://..." id="somebutton">...</a>
<script>
document.getElementById('somebutton').onclick = function() { 
      ... 
      else { return false; }
};
</script> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-04-18T22:37:27.610

您必须防止默认点击功能：

```
function stopDefAction(evt) {  
  evt.preventDefault();  
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T22:36:19.513

是的，您需要[阻止](https://developer.mozilla.org/en-US/docs/Web/API/event.preventDefault)事件的默认操作。您可以通过返回`false`onclick 属性来执行此操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-05T16:48:07.723

您可以用文本“javascript:void(0)”替换 href 属性，例如：

```
<a href="http://..." id="somebutton">...</a>
<script>
document.getElementById('somebutton').href="javascript:void(0)"
</script> 
```

# php - 将 pdf 转换为 php 中的文本文件（注意：shell_exec 已禁用）

> ID：10219076
> 
> 赞同：0
> 
> 时间：2012-04-18T22:34:43.713
> 
> 标签：php, pdf, text, text-files

解决此问题的最佳方法是使用“xpdf”包中的“pdftotext”，但在我用谷歌搜索的所有共享主机中，shell_exec 已禁用。我找到了仅使用 php 的替代方法，例如一个名为 pdf2string() 的函数（在 php.net 上），但这些函数都没有按预期工作（对于一些 pdf 文件，它们只是没有输出正确的文本和其他一些 pdf他们没有输出任何内容，并且此功能的其他一些版本根本不起作用，因此我排除了此选项）。有什么方法可以将该开源 pdftotext 转换为 php 脚本？（我认为源代码在 c++ 中，可以在这里找到：[http](http://www.foolabs.com/xpdf/download.html) ://www.foolabs.com/xpdf/download.html ）。只要它给我pdf的文本输出（正确的），任何其他解决方案都将被接受

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:45:07.260

由于您的环境受到限制，因此您可能需要查看此内容。 [http://webcheatsheet.com/php/reading_clean_text_from_pdf.php](http://webcheatsheet.com/php/reading_clean_text_from_pdf.php)

这不使用外部库将 pdf 解析为文本格式。但是，由于这个解析文本是原始 pdf 格式的，我不确定它有多稳定。

# java - 客户端可以在没有请求的情况下获得 servlet 的响应吗？

> ID：10219078
> 
> 赞同：1
> 
> 时间：2012-04-18T22:35:32.453
> 
> 标签：java, servlets

以传统方式，对于每个客户端请求，我都会得到 servlet 响应。
像这样的东西：

```
HttpResponse response = client.execute(request) 
```

现在我想在每个时间间隔从我的 servlet 获取更新。
我怎样才能捕捉到服务器的响应？

为了比较，当我使用套接字时，代码看起来像这样：

```
public void run()
{
    while(true)
    {            
        Object serverMessage = inStream.readObject();               
        // Do somthing with serverMessage
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:50:43.427

不，客户端将不得不发出更多请求，然后服务器-> servlet 会响应这些请求。

但是，您可以（例如通过 Javascript）尝试让客户端定期发送请求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T00:37:30.283

您可以使用称为长轮询的方法模拟服务器到客户端的推送，在此处解决： [长轮询示例](https://stackoverflow.com/questions/333664/simple-long-polling-example-code)
HTTP 是请求驱动的协议。您可以根据自己的工作探索其他消息传递协议。从 Web Sockets 到基本 TCP，再到在 tcp 之上构建表面上更丰富的 api 的各种框架，应有尽有。你想达到什么目的？

# regex - Perl 正则表达式 - 动态匹配

> ID：10219083
> 
> 赞同：0
> 
> 时间：2012-04-18T22:36:06.520
> 
> 标签：regex, perl

假设我想匹配并捕获由一个或多个空格分隔的 5 个整数 - 示例输入：

> 1111 234 3333 456 7890

我可以这样做：

```
my $input = '1111        234            3333          456    7890';
if($input =~ /^\s*([0-9]+)\s+([0-9]+)\s+([0-9]+)\s+([0-9]+)\s+([0-9]+)/)
{
  #$1 = '1111', $2 = '234', $3 = '3333', $4= '456', $5 = '7890'
} 
```

但我想做这样的事情来保持正则表达式更简单，而不是明确地重复每个 int 5次：

```
my $input = '1111        234            3333          456    7890';
if($input =~ /^((\s*[0-9]+){5})/)
{
  #$1 = '1111        234            3333          456    7890';
  #$2 = ' 7890'
  #all other capture variables are undefined
} 
```

但是，捕获似乎没有成功。

**有没有办法我可以做到这一点并且仍然可以访问我的 5 个捕获？**

更好的是未知数量的捕获：

```
my $input = '1111        234            3333          456    7890';
if($input =~ /^((\s*[0-9]+)+)/)
{
   #foreach capture 1..N do something...
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T22:48:36.313

```
my @numbers = $input =~ /\d+/g; 
```

全局标志将返回列表上下文中的所有匹配项，这些匹配项将存储在您的数组中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:39:54.307

如果您知道分隔符是什么（在本例中为一个或多个空格），那么您不需要正则表达式来捕获您想要的内容。您可以使用[`split`](http://perldoc.perl.org/functions/split.html).

```
use strict;
use warnings;

my $input = "1111        234            3333          456    7890";
my @ints=split /\s+/,$input;
print "$_\n" foreach(@ints); 
```

产生输出：

```
1111
234
3333
456
7890 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T22:40:34.933

行的模式是否总是由空格分隔的数字组？如果是这样，而不是正则表达式，为什么不根据空格拆分为数组

```
@outArray = split (/ +/,$input); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-18T22:57:26.730

以下将捕获前 5 个整数，如果这就是您所追求的，则忽略之后的任何整数。我可能并不完全清楚。

```
#!/usr/bin/perl
use strict;
use warnings;

my $in = '1111        234            3333          456    7890 12 13';

my @ints = (split ' ', $in)[0 .. 4];

print "@ints\n"; 
```

印刷：

```
1111 234 3333 456 7890 
```

克里斯

# jquery - 缩放页面时如何阻止元素换行？

> ID：10219084
> 
> 赞同：3
> 
> 时间：2012-04-18T22:36:08.003
> 
> 标签：jquery, html, css, xhtml

我一直在做一个网站。问题是当我使用浏览器更改页面的分辨率时（CTRL - / + OR CTRL ZOOM），最后一个按钮向下溢出。我尝试了溢出：隐藏但我无法解决它。而且我还意识到，在某些计算机中，根据分辨率，即使我不缩放按钮，按钮也会向下溢出。

**没有缩放** ![输入图片描述df](../Images/ce9a7d54dcf205e34d1f5ec76a1f41e4.png)

**带变焦** ![在此处输入图像描述](../Images/7586c6e85e1eebe775756bf1b13166e5.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T22:53:25.450

尝试添加`white-space: nowrap;`到包含菜单项的元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:39:32.530

如果你明确定义容器的宽度，它不会缩小，元素也不会换行。

# java - java移动一个旋转的形状

> ID：10219088
> 
> 赞同：1
> 
> 时间：2012-04-18T22:36:31.060
> 
> 标签：java, swing, transform

我正在实现一个 java swing 应用程序，它有一个用作绘图表面的 JPanel。表面呈现（活动）不同的元素。每个元素都有自己的形状和用于渲染和碰撞检测的仿射变换（每个元素都是用局部坐标绘制的，然后用仿射变换进行变换——比如 opengl）。

元素可以在表面上移动和旋转（这是通过变换完成的）。每次应用变换时，都会使用形状和变换创建一个 Area 对象（用于准确的碰撞检测）。

问题是当我旋转元素（45 度）然后将其移动 10 像素时。当我移动它时，元素会沿我不想要的旋转方向移动。

有什么简单的方法可以克服这个问题吗？
（如果我的描述不够，我会发布一些示例代码）。

编辑：

```
 class Element
 {
     private AffineTransform transform = new AffineTransform();
     private Shape shape = new Rectangle(0,0,100,100);       
     private Area boundingBox;       

     public void onMouseDrag(MouseEvent e)
     {
        translate(dx,dy); // dx,dy are calculated from event
     }

     public void onMouseMove(MouseEvent e)
     {
        rotate(Math.atan2(dx/dy); // dx,dy are calculated from event
     }

     public void translate(int dx,int dy)
     {
        transform.translate(dx,dy);
        boundingBox = new Area(shape);
        boundingBox.transform(transform);
     }

     public void rotate(double angle)
     {
         transform.rotate(Math.toRadians(angle));
         boundingBox = new Area(shape);
         boundingBox.transform(transform);
     }

     public void draw(Graphics2D g2d)
     {
         g2d.setTransform(transform); 

         g2d.draw(shape); 
        ...
      }

 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:44:39.420

颠倒您应用转换的顺序。或者取消旋转对象，移动它，然后重新旋转对象。我们真的需要查看您的代码（甚至是伪代码）才能为您提供比这更好的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T23:48:53.433

我已经通过提供`Element` `position`和`orientation`字段修改了您的代码，您可能希望通过 getter/setter 公开这些代码（可能`Point`在返回/设置之前防御性地复制实例）。只需根据的当前和`updateTransform()`重新构建。`AffineTransform``Element``position``orientation`

```
public class Element {

    private Point position = new Point();
    private float orientation;

    private AffineTransform transform = new AffineTransform();
    private Shape shape = new Rectangle(0, 0, 100, 100);
    private Area boundingBox;

    public void onMouseDrag(MouseEvent e) {
        translate(dx, dy);
    }

    public void onMouseMove(MouseEvent e) {
        rotate(Math.atan2(dx / dy));
    }

    public void translate(int dx, int dy) {
        position.translate(dx, dy);
        updateTransform();
    }

    public void rotate(double angle) {
        orientation += Math.toRadians(angle);
        updateTransform();
    }

    private void updateTransform() {
        transform.setToIdentity();
        transform.translate(position.x, position.y);
        transform.rotate(orientation);
        // ... update bounding box here ...
    }

    public void draw(Graphics2D g2d) {
        g2d.setTransform(transform);
        g2d.draw(shape);
    }

} 
```

另外，请考虑以下方法：

*   更改`draw(Graphics2D)`为`draw(Graphics2D, AffineTransform transform)`
*   创建`AffineTransform Element.getCompositeTransform()`哪个构建当前`AffineTransform`并返回它（如`updateTransform()`）。
*   从 中删除该`transform`字段`Element`。
*   在您的渲染方法中，执行以下操作：

.

```
for (Element element : elements) {
    AffineTransform transform = element.getCompositeTransform();
    element.draw(graphics, transform);
} 
```

为什么？这使您可以灵活地从`Element`外部控制 的绘图变换。如果您要构建一个节点图（例如当一个`Element`可以有`Element`孩子时）并且您将递归地渲染该图，连接变换，这将非常有用。顺便说一句，这种方法在 3D 编程中几乎是标准的。

# ios - CALayer 并显示其部分内容

> ID：10219098
> 
> 赞同：0
> 
> 时间：2012-04-18T22:37:59.207
> 
> 标签：ios, calayer

有没有办法只显示 CALayer 的部分内容？我试过使用 contentRect；但是，我不太确定它是否能按我的需要工作。假设我有一张图片，我只需要在用户将手指拖过图片时显示部分图片。contentRect 是要走的路吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T08:27:42.413

你应该使用`bounds`财产

```
imageView.layer.bounds = CGRectMake(20, 20, 200, 200); 
```

# javascript - Javascript“对象”不保留css值

> ID：10219102
> 
> 赞同：2
> 
> 时间：2012-04-18T22:38:13.920
> 
> 标签：javascript, jquery, css

我正在通过以下函数定义一个 javascript“对象”：

```
function Window(vars) {
    this.div = $("<div/>", {
        id: vars.id,
        class: vars.styles + " box text",
        css: {
            top: vars.top,
            left: vars.left
        }
    });
    this.div.appendTo( $("body") );
    // more stuff happens.. 
```

如您所见，`Window`有一个`div`属性，它是一个 jQuery 对象。在它的实例化中，我声明了 CSS 类**box**和**text**。**文字**并不重要，它只是字体的东西。**然而，这里是box**的 CSS 。

```
.box {
 z-index: 1;
 position: absolute;
 background: #222222;
 min-width: 10%;
 text-align: center;
 padding: 5px;
}
.nav-extension {
 z-index: 3;
 padding: 8px;
 background: #000000;
 position: absolute;
 -moz-border-radius-bottomright: 5px;
 -moz-border-radius-topright: 5px;
 border-bottom-right-radius: 5px;
 border-top-right-radius: 5px;
} 
```

**box**在 z-index 1 处是绝对的，另一个带有**nav-extension**的 div 在页面上的其他位置，也是绝对的并且在 z-index 3 处。但是，当我将`Window`对象添加到我的页面时，它会出现*在*任何带有**nav-扩展名**。所有其他 CSS 属性，如背景，仍然有效。

我已经尝试更改我已经`div`在使用的“css”部分中实例化的z-index，但这也不起作用。是什么赋予了？

## 编辑

另外，我用 Firefox 检查了带有**box**的 div和带有**nav-extension**的 div ，并且“样式”选项卡表明它们仍然具有预期的 z-index（未覆盖）。

**#2**：更改`vars.class`为`vars.styles`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:46:27.233

请给我们一些DOM，好吗？看来您的框和 nav-extension-div 处于不同的上下文中。一个非静态的位置建立了一个新的上下文，相对于它`z-index`里面的所有 es 被处理。一个简单的小提琴演示：http: [//jsfiddle.net/3KTyz/](http://jsfiddle.net/3KTyz/)

```
<body>
    <style>
        .box { z-index:1; }
        .nav-extension { z-index:3; }
    </style>
    ...
        <div id="context" style="position:relative"><!-- or absolute or fixed -->
             ...
                 <div class="nav-extension"><!--
                 will be positioned +3 relatively to other elements in #context
                 -->...</div>
        </div>
    <div class="box"><!--
    will be above #context, which has (implicit) z-index:0
    -->...</div>
</body> 
```

要使导航扩展出现在框上方，您可以

*   将 #context （或其父级之一）设置为高于 box 或
*   将 nav-extension-div 移到任何上下文之外

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:43:59.623

`class`是 JavaScript 中的保留字，不能用作属性或变量名，也许这就是罪魁祸首。

# jquery - 表格行上的 jQuery 对话框不起作用

> ID：10219110
> 
> 赞同：0
> 
> 时间：2012-04-18T22:39:08.810
> 
> 标签：jquery, ruby-on-rails, dialog

我（有点）重新发布这个问题，这是基于上一个问题：

[在rails 3中的表行上多次出现jquery对话框 - 我该怎么做？](https://stackoverflow.com/questions/10128160/multiple-occurences-of-jquery-dialog-boxes-on-table-rows-in-rails-3-how-do-i-d)

我提供上一个链接仅供参考。

经过数小时的努力，我决定退后一步，从基础开始。我的背景是我相当精通 Rails 编程，而不是 Javascript（a la jQuery）。

我有一个表，希望能够使用 jquery 对话框更新每行中的两个字段，以提供部分来更新它们。

我设法让对话框弹出部分内容，但**仅在第一行**。**单击后续行上的字段的链接不会产生任何结果（它们只是死了）。**

这是.js：

```
$(document).ready(function() {
$('div#status-chg-form').dialog({ autoOpen: false });
$('#statuslink').click(function(){ $('div#status-chg-form').dialog('open'); });
});

$(document).ready(function() {
$('div#eta-chg-form').dialog({ autoOpen: false });
$('#etalink').click(function(){ $('div#eta-chg-form').dialog('open'); });
}); 
```

在我的索引页面上，是 div 在各自的对话框中提供部分内容：

```
<div id="status-chg-form" title="CHANGE WORK ORDER STATUS" style="display:none"><%= render :partial => 'statusform' %></div>
<div id="eta-chg-form" title="CHANGE TECHNICIAN ETA" style="display:none"><%= render :partial => 'etaform' %></div> 
```

最后，这里是链接，对表格的每一行重复：

```
 <%= link_to work_order.soft_completion_datetime.strftime('%m/%d/%Y %I:%M %p'), "#", :id => "etalink" %>
        <%= link_to status_display, "#", :id => "statuslink" %> 
```

我知道我的问题是一个补救问题，因为关于 .js，我只是没有掌握一些东西。如果有人能在这里为我指明正确的方向，以最有效的方式让这些对话框为表格的每一行工作，我将永远欠你的债。

这几天我一直在愚蠢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:44:06.253

1-如果您在页面上使用多个项目，请使用类而不是 id 来选择要应用绑定的项目；
2-您可以将2个`document ready`活动块合二为一；
3-要在行中选择带有对话框的 div，您可以使用它使用`closest()`您指定的选择器获取最近的父级。

通过此更改，您的代码将如下所示：

```
$(document).ready(function() { 
    $('div.status-chg-form').dialog({ autoOpen: false }); 
    $('.statuslink').click(function(){ $(this).closest('div.status-chg-form').dialog('open'); }); 

    $('div.eta-chg-form').dialog({ autoOpen: false }); 
    $('.etalink').click(function(){ $(this).closest('div.eta-chg-form').dialog('open'); }); 
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T22:44:38.163

我猜你的问题是你所有的链接似乎都有`id=statuslink`，而且你不能有重复的 ID。如果您只是设置`:id`为`:class`，然后将 jQuery 更改为使用`.statuslink`而不是`#statuslink`，它应该可以修复它。对于共享相同属性的任何其他元素也是如此。

# playframework - 我在哪里可以指定我需要与 Play 1.2 框架一起使用的 MySQL 适配器？

> ID：10219121
> 
> 赞同：0
> 
> 时间：2012-04-18T22:39:56.383
> 
> 标签：playframework, playframework-1.x

我知道如何通过在 application.conf 中指定这些来在 Play 2.0 中配置 MySQL 数据库：

```
db.default.driver=com.mysql.jdbc.Driver
db.default.url="jdbc:mysql://localhost/test"
db.default.user="root" 
db.default.password="" 
```

并将其放入 val appDependencies = Seq("mysql" % "mysql-connector-java" % "5.1.18")

```
in Build.scala file. 
```

但是如何在 Play 1.2 框架中实现相同的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T04:48:33.947

要连接到本地 MySQL 数据库，请将设置`application.conf`按以下格式放入文件中：

```
db=mysql:user:pwd@database_name 
```

（所以在你的情况下它会是`db=mysql:root:@test`）

无需添加任何依赖项 - MySQL 已包含在内。

较长的配置格式如下：

```
db.driver=com.mysql.jdbc.Driver
db.url=jdbc:mysql://localhost/test
db.user=root
db.pass= 
```

请参阅[Play Framework 文档](http://www.playframework.org/documentation/1.2.4/configuration#dbconf)以获取更多信息。

# jsf-2 - 单击标题部分中的 commandLink 后重新加载数据表

> ID：10219122
> 
> 赞同：0
> 
> 时间：2012-04-18T22:40:03.357
> 
> 标签：jsf-2

我对 JSF 有点陌生。我对数据表和事件处理有疑问。这是我想要做的场景。我有优先级、id、地址和电话号码的数据表，支持 bean 是人员。我必须根据 3 个值关键、警告、低对优先级列进行排序。我已经使用 Comparator 的东西对优先级列进行了排序。它工作正常。现在，我面临的挑战是，一旦在托管 bean 中对记录进行了排序，我想用更新的排序结果填充数据表。记录是 ArrayList。

```
<p:column>
                <f:facet name="header" >
                     <h:commandLink action="#{personManagedBean.sortByPriority}">
                        Pririty
                   </h:commandLink>
                </f:facet>
                #{person.priority}
</p:column> 
```

在托管 bean 中，

```
public class PersonManagedBean{

private ArrayList<Person> personList;

//getters and setters for personList.

public String sortByPriority(){
    Collections.sort(personList, new PersonComparator());
    return null;
}
} 
```

执行 Collections.sort 行后，我想用排序后的 personList 记录填充数据表。

你们能帮我吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T05:05:13.977

尽管我认为您仍然可以通过添加`<f:ajax render="@form"/>`到您的`<h:commandLink`

像这样

```
 <h:commandLink action="#{personManagedBean.sortByPriority}">
     <f:ajax render="@form"/>
     Priority
  </h:commandLink> 
```

你最好使用p:column的`sortBy`and`sortFunction`

这就是它的样子（注意额外使用`<h:outputText value="`它比简单的文本更好）

```
<p:column sortBy="#{person.priority}" sortFunction="#{personManagedBean.sortByPriority}">
    <f:facet name="header" >
        <h:outputText value="Priority">
    </f:facet>
       <h:outputText value="#{person.priority}"/>
</p:column> 
```

这就是`sortByPriority`应该的样子（或多或少）

```
public int sortByPriority(Object Obj1, Object Obj2) {

    if (Obj1 != null && Obj2 != null) {

        //turn the Objects into Strings or some other objects

        return newObj1.compareTo(newObj2);

    } else {
        return 0;
    }
} 
```

看一下展示示例[DataTable - 排序](http://www.primefaces.org/showcase/ui/datatableSorting.jsf)

# php - 给定两张图像，确定一张是否是从另一张编辑的（哪个是原始图像）

> ID：10219126
> 
> 赞同：1
> 
> 时间：2012-04-18T22:40:38.190
> 
> 标签：php, image

假设网络上有一张没有水印的图片。有人下载它并对其进行一些编辑，例如添加水印等。是否可以在 php 中编写脚本来比较这两个图像。就像我将这两个图像提交给脚本时，它应该能够输出原始图像和处理后的图像。

我读了谷歌的网站管理员页面，上面写着

> 谷歌经常在网上找到同一张图片的多个副本。我们使用许多不同的信号来识别图像的原始来源 Blockquote

这是我的问题的主要关注点

还有一个疑问是图像中是否有任何元标记。如果在所有如何阅读它们。是否可以编辑它们。图像中是否有任何信息（非视觉信息）无法编辑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:52:40.193

图像中的任何东西都可以被编辑（毕竟，它只是字节的集合），而且对于某人来说，给图像添加水印，或者只是稍微改变对比度，使其成为与原始文件非常不同。还有一些其他的非破坏性更改会使图像文件看起来与简单的比较算法完全不同（例如，缩放、更改文件类型和压缩、更改亮度、旋转等）。

然而，高级图像处理算法通常仍然可以识别以上述方式处理的图像之间的相似性。有很多算法可以做到这一点，老实说，你可能会花费数千小时尝试自己推出这样的算法。这些类型的算法被称为“基于内容的图像检索”。

您最好调用已经开发用于执行此操作的引擎。以下是一些可能性：

*   [TinEye](http://www.tineye.com)有一个可供您使用的 RESTful API，[在此处](http://www.tineye.com/commercial_api)进行了描述。
*   [您可以使用此技术](http://blog.hussulinux.com/2011/09/google-search-by-image-api/)从 Google 的 Search by Image 结果中抓取响应。
*   您可以使用[这个稍旧的 StackOverflow 帖子](https://stackoverflow.com/questions/7081634/are-there-any-apis-thatll-let-me-search-by-image)中的任何建议数量。

祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T22:53:57.687

数码相机拍摄的照片通常嵌入了 exif 数据。

您可以使用[PHP 中的 exif_read_data 函数](http://php.net/manual/en/function.exif-read-data.php)获取数据。

至于识别相似图像，这里有一些有用的资源：

*   [天眼](http://www.tineye.com/)
*   [关于图像相似度的 SO Q](https://stackoverflow.com/questions/2838775/good-way-to-identify-similar-images)
*   [对 Resig 文章的评论](http://ejohn.org/blog/image-similarity-search-wanted/#postcomment)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T08:39:58.327

您可以将两张图片都提交到[ImageEdited](http://imageedited.com)并查看哪一张已被编辑。即使 exif 数据丢失，它也会告诉您何时使用程序创建了图像。

# iphone - 使用 Core Motion 构建计步器

> ID：10219132
> 
> 赞同：1
> 
> 时间：2012-04-18T22:41:55.090
> 
> 标签：iphone, ios, ios5, accelerometer, core-motion

我想构建一个在 iOS5 设备的后台运行的计步器。我知道 Core Motion 框架可以用来实现这一点，就像 Nike+ 正在使用他们的计步器应用程序一样。

我还听说 Core Motion 何时可以在后台使用是有限制的，特别是 OReilly 的 iOS 5 书中说：“在 iOS5 中，当您的应用程序在后台运行时，Core Motion 是合法的。要利用这一点，您的由于某些其他原因，应用程序需要在后台运行。”

这对我来说似乎很奇怪。这是否意味着我必须有一个“借口”才能在后台使用 Core Motion？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:44:52.850

是的，为了在后台运行您的应用程序，您的应用程序必须属于以下几个类别之一：音乐、位置、VOIP。

编辑：

您可以在此处找到文档：[https ://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreData/Articles/cdRelationships.html](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/CoreData/Articles/cdRelationships.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-25T23:01:24.687

只要让它知道位置。记录计步器活动和 GPS 位置。

# jquery - mixpanel track_links 没有正确跟踪

> ID：10219134
> 
> 赞同：2
> 
> 时间：2012-04-18T22:42:07.703
> 
> 标签：jquery, mixpanel

我正在使用 mixpanel 的 javascript api 使用如下代码：

```
$(function() {
mixpanel.track_links("a[href~='/posts/more']", "Show more posts.",
      { "topic_id": "<%= @topic.id.to_guid %>" });
}); 
```

它似乎不起作用。我尝试了没有单引号的变体，但无济于事。

```
$(function() {
    mixpanel.track_links("a[href~=/posts/more]", "Show more posts.",
          { "topic_id": "<%= @topic.id.to_guid %>" });
}); 
```

上面的代码有问题吗？

以下链接在页面上：

```
<a href="/posts/more?i=20&id=0a5cb302-859e-11e1-8851-24c603d12b60&type=Topic" data-remote="true">Show More...</a> 
```

当我单击它时，不会触发任何事件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-16T21:53:53.750

我认为您可能拥有的原因是`a[href~=/posts/more]`mixpanel 轻量级选择器引擎不支持更丰富的选择器。

通过一些快速测试，我认为只有类、id 和元素有效。

我已经给他们发了电子邮件，例如，我真的需要将 jQuery 对象作为选择器传递的能力，但到目前为止这根本不可能。（显然曾经有支持，也许会回来）。

如果您在临时修复后添加一个类，然后将其传递给 track_links 函数，但我知道，这远非理想。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-09T07:28:36.477

Matt Vagni 是正确的，Mixpanel JS 库包含它自己的基本 CSS 选择器引擎的实现，这是极其有限的。

您可能无法进行属性选择，或者至少不能进行子字符串匹配属性选择，而且我通过调试自己的问题知道子选择器和类（例如“p a.foo”）不起作用。

更好的方法是使用 jQuery（或页面上已有的任何内容，Rails 将为您提供 jqlite）来监视您感兴趣的点击并手动跟踪 Mixpanel 事件。

```
$('body').on('click', 'a[href~=/posts/more]', function() { 
    mixpanel.track("Show more posts.", { "topic_id": "<%= @topic.id.to_guid %>" });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-18T22:39:37.993

Mixpanel（和 Google Analytics）使用 AJAX 调用将事件发送到他们的服务器，您不能在 AJAX 调用正在进行时重定向页面，否则它将被取消。信息根本不会到达他们的服务器，并且不会跟踪事件。

Mixpanel 建议您在重定向之前添加一个小超时，以便可以完成 AJAX 调用。

我找到了一种解决方法，它使用 cookie 而不添加超时，但它不会实时工作。您可以在以下链接[http://tech.matchfwd.com/tag/mixpanel/](http://tech.matchfwd.com/tag/mixpanel/)中查看。

**更新：**我刚刚在 Mixpanel 官方文档中发现该方法`track_links`会为您执行此操作。它将在执行重定向之前等待 300 毫秒。

[https://mixpanel.com/docs/integration-libraries/javascript-full-api#track_links](https://mixpanel.com/docs/integration-libraries/javascript-full-api#track_links)

# java - 在eclipse下的android项目中包含另一个（非android）项目的最佳方法是什么

> ID：10219136
> 
> 赞同：2
> 
> 时间：2012-04-18T22:42:08.893
> 
> 标签：java, android, eclipse, adt

我是android编程的新手。我正在尝试在 android 应用程序中包含来自非 android 项目的代码。这包含我的许多其他非安卓应用程序使用的共享代码。

我想知道从代码维护的角度来看，最好的方法是什么。我想要包含的共享代码确实会不时修改，我希望更新我编写的任何应用程序的过程尽可能简单（如果可能，自动更新）。

我最好构建一个包含共享代码的 .jar 文件并将其复制到我的应用程序（例如：使用 ant 脚本）还是有更简化的方法。

我特别想避免将我的共享代码项目变成任何类型的 android 项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:45:58.577

一旦你有了你的 .jar，你只需要将它添加到你的项目中（或者如果这个库得到更新，则使用新的 .jar 文件进行更新）。

一旦它在您的项目中（假设在 /lib 文件夹下， **右键单击 lib 文件夹 -> 选择构建 -> 添加到构建路径。**

不幸的是，我很确定没有办法进行自动更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:52:59.540

制作一个 jar 并将其添加到 android 项目的构建路径中。每当 jar 有更新时，您需要在项目中更新它并更新（增加）应用程序的版本，以自动允许用户下载和更新更新（android 市场会为您处理）。

它是最广泛和可维护的方式。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T23:34:29.707

在项目的属性中，转到“项目参考”。它应该你其他打开的项目，你可以点击任何你想要的。

我没有尝试过，但是如果您更改非Android代码并运行Android项目，我希望非Android项目会自动重新编译。

# google-app-engine - 如何仅查询直系后代？

> ID：10219137
> 
> 赞同：6
> 
> 时间：2012-04-18T22:42:19.797
> 
> 标签：google-app-engine, google-cloud-datastore

假设我有相同类型的实体 a、b 和 c，情况是这样的：

实体 a 是实体 b 的父级 实体 b 是实体 c 的父级

现在，如果我执行以下查询

```
query = ndb.Query(ancestor=a.key)
result = query.fetch() 
```

结果将包含 b 和 c 实体。有没有办法可以过滤掉 c 以便只保留直接后代的实体？除了我检查结果并删除它们之外的任何方式，我的意思是。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T03:36:56.237

这样做的唯一方法是修改您的架构，添加一个`KeyProperty`引用实体的直接父级的“父级”，然后对其进行过滤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T10:48:39.410

实际上，这根本不受支持。尼克的回答确实有效，但前提是您可以在查询中指定 OP 未指定的实体类型：

“Kindless 查询不能包含属性过滤器。但是，它们可以通过传递 Entity.KEY_RESERVED_PROPERTY 作为过滤器的属性名称来按实体键进行过滤。还支持对 Entity.KEY_RESERVED_PROPERTY 进行升序排序。”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-14T02:44:55.450

这有点晚了，但它会帮助任何有同样问题的人。

解决方案是首先进行仅键查询并获取直接后代的键子集。

使用该键子集，您可以批量获取所需的实体。

我对python不熟悉，所以这里有一个例子：

```
directDescKeys := make([]*datastore.Key, 0)

q := datastore.NewQuery("A").Ancestor(parentKey).KeysOnly()
for it := q.Run(ctx);; {
    key, err := it.Next(nil)
    if err == datastore.Done {
        break
    } else if err != nil {
        // handle error
    }

    if reflect.DeepEquals(key.Parent(), parentKey) {
        directDescKeys = append(directDescKeys, key)
    }
}

entities := make([]*A, len(directDescKeys))
if err := datastore.GetMulti(ctx, directDescKeys, entities); err != nil {
    // handle error
} 
```

# git - TortoiseGit 1.7.8：“同步”或“拉动”时“无法加载此密钥”？

> ID：10219138
> 
> 赞同：12
> 
> 时间：2012-04-18T22:42:25.647
> 
> 标签：git, tortoisegit

当我尝试使用“Git Sync”然后“Pull”时出现错误：

> 无法加载此密钥（无法打开文件）

然后它尝试继续拉，我得到这个错误：

> 断开连接：不支持可用的身份验证方法（服务器发送：公钥）

自从我升级到 1.7.8.0 后才发生这种情况。之前一切正常。我可以使用 gitbash 成功拉取，所以我知道我可以连接。

我不确定发生了什么变化，或者我可以做些什么来修复它。请帮忙！

**其他步骤**

我去了 GIT 文件夹并使用 gitbash 检查 git remote -v 并收到：
.puttykeyfile
origin git@github.com:{name}/{repository}.git (fetch)
origin git@github.com:{name} /{repository}.git（推送）

我认为这是正确的。

我检查了 tortoisegit 中的腻子键设置。我有两个条目：

1.  .puttykeyfile - 在 Remote 中只有 .puttykeyfile
2.  origin - 这似乎在 Remote、URL 和 Putty Key 中包含所有正确的信息

当我在 PuTTYGen 中加载密钥时，它具有 ssh-rsa 1024... 密钥指纹。

pageant.exe 正在运行，但现在没有，但它仍然无法正常工作

当它之前工作时，我的 git 文件夹与我的密钥位于同一文件夹中。现在我有 3 个，但它们都不起作用，如果我用一个存储库和密钥创建一个新的 git 文件夹，它似乎不起作用。我不知道它是否会影响结果，但想分享一下以防万一。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-19T09:17:15.537

当您无法对远程服务器进行身份验证时会发生这种情况，由于某种原因找不到您的密钥。你安装了新版本的 tortoiseGit。你的钥匙在那个文件夹里吗？也许它们在您安装新版本时已被删除。

检查您的 Git 存储库中是否配置了遥控器

```
git remote -v 
```

如果它们是正确的，并且您仍然拥有您的钥匙，请尝试再次将它们添加到乌龟设置中

TortoiseGit 设置 - Git - 远程 - 腻子键

如果您需要帮助将您的 rsa 密钥（用于进行身份验证）转换为 putty 格式：

[http://www.electrictoolbox.com/putty-rsa-dsa-keys/](http://www.electrictoolbox.com/putty-rsa-dsa-keys/)

还要检查 pageant.exe 是否正在运行（您可以在系统中检查），如果找不到加载的密钥，可能会导致问题

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-03-23T03:38:42.140

重新安装我的系统时发生了这种情况。在我部署了 tortoisGit 之后，它向我展示了当我使用“Git pull”或其他代码时的提示。 [错误提示](http://i.stack.imgur.com/uq9P2.png)

然后我搜索了这个问题，但它并没有解决我的问题。幸好我认出来了，是不是旧配置的问题？因此，我打开了项目的“配置”文件，删除了“puttykeyfile”行。

……！

解决！

希望能帮到你！

ps: 项目字典 -> .git -> config -> puttykeyfile

# matlab - 如何将两个文件合并为一个文本文件？

> ID：10219140
> 
> 赞同：0
> 
> 时间：2012-04-18T22:42:37.390
> 
> 标签：matlab, matlab-guide

我正在尝试将两个文本输出文件合并到一个文本文件中。

文件 1：

```
fin=fopen('d://box1.txt','wt');
fprintf(fin,'   Hello \n'); 
```

文件 2：

```
fin=fopen('d://box2.txt','wt');
fprintf(fin,'welcome \n'); 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T22:51:14.280

我认为没有一种 matlab 方法可以轻松做到这一点。但是你可以使用系统命令：

视窗：

```
system(type a.txt b.txt >ab.txt) 
```

Linux：

```
system(cat a.txt b.txt >ab.txt) 
```

如果文件不在您的当前目录中，请不要忘记将路径放在文件中！这有效：

```
fin=fopen('D:\box1.txt','wt');
fprintf(fin,'   Hello \n');
fclose(fin)

fin=fopen('D:\box2.txt','wt');
fprintf(fin,'welcome \n');
fclose(fin)

system('type D:\box1.txt D:\box2.txt >E:\box12.txt') 
```

# linux - 如何在重启阶段访问 fstab

> ID：10219142
> 
> 赞同：0
> 
> 时间：2012-04-18T22:43:03.670
> 
> 标签：linux, recovery

如何在重新启动期间访问和修改 /etc/fstab（可能访问恢复模式）？

为什么这个问题：我已经更新了回溯 5 中的虚拟机来宾添加（作为 Virtualbox VM）。我已经临时修改了 fstab 文件来执行此操作，但忘记将其恢复为初始状态，例如：

```
mount /dev/cdrom /cdrom
echo "/dev/cdrom    /cdrom0 udf,iso9660 defaults,exec   0   0" >> /etc/fstab 
```

因此，在安装来宾添加后，重新启动会在安装这个不存在的点时被阻止。

谢谢

编辑：也许要转移到 serverfault ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:13:50.423

我看到您的问题有两种可能的解决方案：

1.  使用恢复模式（如果您在 grub 列表中没有看到，请编辑默认条目并在内核行末尾添加不带引号的单词“single”）
2.  临时挂载一个随机的 .iso 文件

然后删除有问题的 fstab 行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T14:56:48.983

另一种选择是启动 Live OS 并从那里挂载根文件系统。然后您将能够编辑 fstab 文件。

一旦你启动了实时操作系统
fdisk -l
- 找到你的根分区（通常格式为 sda1、sdc1、sda2 等）
mkdir /mnt/rootfs
mount /dev/sda2 /mnt/rootfs <--sda2 = root partition found在 fdisk
cd /mnt/rootfs/etc
-Fstab 文件应该在那里。

# c# - 通过对象的引用创建对象

> ID：10219143
> 
> 赞同：1
> 
> 时间：2012-04-18T22:43:08.997
> 
> 标签：c#

我正在用 C# 做作业，其中我正在实现 Account 的抽象类，然后我从 Account 派生了两个类，分别命名为 Saving Account 和 Checking Account，并覆盖了派生类中的一些方法。现在我的问题陈述说

仅通过 Account 的引用实例化 SavingAccount 和 CheckingAccount

现在我无法编写此代码，因为我知道简单的对象创建，但我不知道如何通过对象的引用来创建对象。请告诉我一些语法。谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T22:45:01.920

这个想法是标识符可以是基本类型：

```
SomeBaseType identifier; 
```

但是当你实例化它（或新建一个实例）时，你可以使用任何派生类型

例如

```
Account account = new SavingsAccount(); 
```

**编辑**我想补充一点，这就是 OOP 变得生动的地方（阅读：“变得非常有趣！”）。现在您可以设计一个`interface`或合同（例如与一个`Account`类） - 并针对一个设计进行编程。但是您可能*实际*使用了不同的帐户类型。使用我给出的示例，`account`将继续看起来像一个`Account`. 使用您的变量进行编码时，任何“新”方法或功能`SavingsAccount`都不会立即可见。`account`不过没关系！您不希望您的代码专门针对`SavingsAccount`（在大多数情况下）量身定制，而是希望设计一个灵活`Account`的，可以代表任何`Account`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:52:36.187

如果您想从已有的 Account 实例创建 SavingAccount 或 CheckingAccount，则可以将其转换`as`为这些帐户之一。像这样——

```
int _accountID = 356;
Account _account = new SavingsAccount(_accountID);

// now to create a SavingAccount or CheckingAccount from _account

SavingAccount _savingAccount = _account as SavingAccount; 
```

# android - 查找窗口失败 - 来自 2 个 Galaxy Nexus 上的同一应用程序的不同行为

> ID：10219146
> 
> 赞同：9
> 
> 时间：2012-04-18T22:43:37.877
> 
> 标签：android, android-activity, android-4.0-ice-cream-sandwich

我有两部 Galaxy Nexus 手机。这些手机是相同的固件版本 4.0.2、相同的内部版本号、相同的内核版本。当我使用 Eclipse 将相同的应用程序部署到两部手机时，我看到每部手机都有不同的行为。

在一部手机上，一切都按预期工作。在另一部手机上，当切换到另一个活动并返回主活动时，主活动崩溃，无论是通过后退按钮还是其他活动完成并返回创建它的活动。我对这个问题的唯一线索是这个错误：

```
04-18 17:43:30.811: I/ActivityManager(207): Displayed org.mitre.Mobile/.Activities.QueryActivity: +430ms
04-18 17:43:30.819: I/n*.w*.w*.ZoomButtonsCo*(4962): invoke: onVisibilityChanged listener: org.osmdroid.views.MapView$MapViewZoomListener@4181ecd8
04-18 17:43:30.843: E/InputQueue-JNI(4962): channel '41d66628 Panel:org.mitre.Mobile/org.mitre.Mobile.Activities.MobileActivity (client)' ~ Publisher closed input channel or an error occurred.  events=0x8
04-18 17:43:30.843: W/WindowManager(207): Force-removing child win Window{41d66628 Panel:org.mitre.Mobile/org.mitre.Mobile.Activities.MobileActivity paused=false} from container Window{420815c8 org.mitre.Mobile/org.mitre.Mobile.Activities.MobileActivity paused=false}
04-18 17:43:30.850: W/WindowManager(207): Failed looking up window
04-18 17:43:30.850: W/WindowManager(207): java.lang.IllegalArgumentException: Requested window android.os.BinderProxy@41f9e658 does not exist
04-18 17:43:30.850: W/WindowManager(207):   at com.android.server.wm.WindowManagerService.windowForClientLocked(WindowManagerService.java:7029)
04-18 17:43:30.850: W/WindowManager(207):   at com.android.server.wm.WindowManagerService.windowForClientLocked(WindowManagerService.java:7020)
04-18 17:43:30.850: W/WindowManager(207):   at com.android.server.wm.WindowManagerService.removeWindow(WindowManagerService.java:2180)
04-18 17:43:30.850: W/WindowManager(207):   at com.android.server.wm.Session.remove(Session.java:149)
04-18 17:43:30.850: W/WindowManager(207):   at android.view.IWindowSession$Stub.onTransact(IWindowSession.java:124)
04-18 17:43:30.850: W/WindowManager(207):   at com.android.server.wm.Session.onTransact(Session.java:111)
04-18 17:43:30.850: W/WindowManager(207):   at android.os.Binder.execTransact(Binder.java:338)
04-18 17:43:30.850: W/WindowManager(207):   at dalvik.system.NativeStart.run(Native Method) 
```

我在互联网上没有真正找到与此错误消息相关的任何有用信息。我对android有一些经验，但是这个真的难倒我。我最初认为这是一个 nova 启动器问题（有问题的手机有），但我在另一部手机上安装了 nova，仍然看到相同的行为。

应用程序无法正常工作的手机是我的私人手机，另一个是工作手机。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-11-13T20:25:47.353

切换构建变体后，这个问题发生在我身上。您的构建可能会出现问题。尝试重新启动 Android Studio，清理并重建。这为我解决了这个问题。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-13T18:38:50.497

刚刚发现为什么每项活动都会死亡。在设置 > 开发人员选项中，有一个名为“不保留活动”的复选框“用户离开后立即销毁每个活动”。该框已选中。我只是取消选中它。这解释了一切。

# version-control - 如何使用 Cruise Control Net 部署/版本控制数据库？

> ID：10219147
> 
> 赞同：0
> 
> 时间：2012-04-18T22:43:44.257
> 
> 标签：version-control, continuous-integration, cruisecontrol.net

嗨，我已经配置了巡航控制的基础知识以发布版本，并仅使用 MSBuild 进行自动化 nunit 测试。现在我想知道是否可以用这个来部署/版本控制数据库？

我是 CCNet 的初学者。所以如果可能的话，可以提供一些建议或教程（如果有的话）。另外，如果有人知道用于数据库部署/版本控制的免费工具，请告诉我.. 我将不胜感激。

提前感谢休

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T10:53:40.677

它不是免费的，但[RedGate 的 SQL Source Control 可以满足](http://www.red-gate.com/supportcenter/Content/SQL_Source_Control/help/3.0/SSC_deploying)您的需求，前提是它是一个 SQL Server 数据库。它有一个命令行界面，您可以在 CCNet 任务中使用。向上迁移的简单方法是......简单，更改将应用​​于您的数据库架构/数据。该工具的 v2x 存在一个问题，他们已经用 3 解决了这个问题，即如果您要重命名表列，那么它将删除该列并创建一个具有正确名称的新列。显然，如果您有想要保留的数据，这是一个相当大的问题，因此在 v3 中存在迁移的概念，这允许您指定更改脚本，因此您可以非破坏性地编写更改脚本，而不是删除列。

据我所知，目前他们没有任何东西可以让你回滚你的版本。

否则你可以看看[数据库迁移工具](http://benscheirman.com/2008/06/net-database-migration-tool-roundup)，至少在 .Net 中似乎有一些承诺。还有[这篇文章](https://stackoverflow.com/questions/3437346/net-database-migration-tool)有一些其他工具（同样适用于 .net），然后是这个[https://stackoverflow.com/search?q=database+migration+tool](https://stackoverflow.com/search?q=database%20migration%20tool)，它不限于任何语言，而是一般的数据库迁移

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-04T15:27:42.227

如果您仍在寻找版本和迁移数据库的方法，那么[dbdeploy.net](https://github.com/brunomlopes/dbdeploy.net)就是这样一种工具。在分叉并做了一些工作之后，我将它托管在 github 上。最新版本完全是最新的，并且具有一些有趣的功能（由也使用它并发送拉取请求的人完成）。

# java - 多个 GUI 对象的最佳实践

> ID：10219157
> 
> 赞同：2
> 
> 时间：2012-04-18T22:45:01.030
> 
> 标签：java, swing

这是我在这个论坛的第一篇文章，所以如果我搞砸了，请告诉我。

几个月来，我一直在使用本网站提供的信息来帮助我解决各种问题，所以我感谢大家的帮助！

无论如何，足够的绒毛和问题：我目前正在用 Java 语言编写我的第一个公司使用程序，并且我遇到了一些直到上周我还没有考虑过的事情。

目前，我创建了一个程序，它使用两个独立的摇摆式 GUI——一个用于登录用户，一个我称之为“主 GUI”。与任何语言一样，有多种方法可以实现这一点，经过深思熟虑最好的方法是什么，我想知道是否有经验的人对实现多个 GUI 的最佳实践有任何见解。

现在，我让登录 GUI 的动作侦听器创建了主 GUI 对象，但我认为这不是最好的方法（我敢肯定，一些经验更丰富的 Java 程序员可能一想到创建来自动作侦听器的 GUI 对象 - 就像我能感觉到他们想要打我的后脑勺！）。

所以，直截了当 - 我已经想到了大约 3 种不同的方法来实现目标，从回收 JFrame 到在 main 中创建 GUI 对象和设置可见性，我想知道最佳实践（行业标准）是什么。谁能指出我正确的方向？

我已将此问题发布到另一个小组，但完全被忽略了。我开始认为这个问题可能没有真正的答案，但我想在我放弃之前尝试一下 Stack Overflow 的专家。你觉得呢？你有没有什么想法？您过去是如何实施它们的？最好在 main 中实例化它们并操纵可见性？虽然我发现了有关创建 GUI 的最佳实践的帖子，但我还没有看到很多关于同一程序中的多个 GUI 的文章。谢谢你的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T23:29:24.653

考虑到出现的第一件事是登录屏幕，我相信您所做的`actionListener`总体上是可以的。我和你在同一个地方，我做了两件不同的事情：

1）我创建了它们，只是改变了可见性。我将这些框架链接到我的主框架，因此我可以从所有其他框架中获取数据。因此，如果您想使用 main 上登录屏幕中的数据，可以使用此方法`JFrame`。

2）我使用actionListener等待用户成功登录，然后继续创建主GUI。

我的意见：我会采用方法 1。它允许您使用任何一种方法`JFrames`来收集任何必要的数据。此外，它将为用户提供 GUI 的设计目的，快速轻松地访问项目（或产品）的创建目的。人们不想花时间等待`JFrame`他们想要访问的每个新负载。最好一次加载所有程序，这样看起来它们的 GUI 正在快速运行，并且几乎可以立即提供结果。

# ruby - 返回数组中的项目列表时，我得到 Errno::EINVAL: Invalid argument in Textmate - 但不是 IRB

> ID：10219162
> 
> 赞同：1
> 
> 时间：2012-04-18T22:45:25.300
> 
> 标签：ruby, nokogiri, textmate

***请参阅下面的更新***

所以这是我的代码：

```
def add_category(new_url)
    new_url + '/web/'
end

url = 'http://www.someurl.com'

def modify_my_list(list)
    puts "The number of links in this list are: #{list.count}"
    list.each do |i, k|
          k = add_category(k)
              puts k
    end
end

modify_my_list(list) 
```

基本上我正在做的是浏览特定 URL 上的链接列表并处理它们。

但是我看到的输出（即链接列表）比我知道我应该看到的要少。

换句话说，在我的屏幕上打印的链接数量少于从 打印的数量`list.count`。

这是我得到的错误：

```
Errno::EINVAL: Invalid argument

method write    in my-search.rb at line 83   =>     puts k
method puts in my-search.rb at line 83
method modify_my_list   in my-search.rb at line 83
method each in my-search.rb at line 81   =>     list.each do |i, k|
method modify_my_list   in my-search.rb at line 81
at top level    in my-search.rb at line 87 => modify_city_list(list) 
```

想法？

**更新**

当我执行 a`puts list.inspect`时，它会输出整个数组并且不会引发错误。一旦我开始遍历数组，错误似乎就会出现。

**更新 2**

所以我在 Textmate 中运行它时遇到了这个错误。但是，我从 IRB 中获取了输出`list.inspect`并进行了操作。然后我修改了 IRB 中的列表元素，它可以正常工作而不会给我一个错误。可能是 Textmate 抛出了这个错误，而不是 Ruby 或我的脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:23:13.067

你作为列表传递了什么？

我认为应该是

```
list.each do |k| 
```

或者

```
list.each_with_index do |k, i| 
```

如果 list 是二维数组，则代码的简化版本将是：

```
b = [['a1','b1'], ['a2','b2']]

b.each do |k, v|
    v = v + 'xz'
    puts v
end 
```

你能在 irb 上试试这个，看看它是否适合你？

编辑：

你试过这个吗？

```
list.each do |k|
   k[1] = add_category(k[1])
   puts k[1]
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:29:54.097

也许这样做更有意义：

```
urls = list.map{|url| url + '/web/'} 
```

# php - 尝试将 span 元素的值输入数据库

> ID：10219163
> 
> 赞同：1
> 
> 时间：2012-04-18T22:45:30.010
> 
> 标签：php, javascript, html, forms

我有一个 javaScript 函数，它产生一个值并将其输入到 span 元素中。我现在想使用 PHP 将此值（以及用户输入的其他值）输入到我的数据库中，但是我似乎无法从跨度中提取值。我想知道是否有人能告诉我我哪里出错了或者我将如何解决这个问题？谢谢

javascript函数：

```
 function updateTotalDistance() {
   var total = 0;
   $(".distance").each(function(){
       if(!isNaN(this.value) && this.value.length != 0) {
           total += Math.round(parseFloat(this.value));
       }
   });
   $("#totalDistance").text(total);
}; 
```

跨度元素：

```
<strong>Total Distance</strong><span id="totalDistance"</span> 
```

我的表格：

```
<script type="text/javascript">
function SubmitAll(params) {
    var form = [ '<form method="POST" action="createclaim_process.php">' ];

    form.push('<input type="hidden" name="manager" value="<? echo $manager; ?>', document.getElementById("manager").value, '"/>');
    form.push('<input type="hidden" name="totalDistance" value="<? echo $totalDistance; ?>', document.getElementById("totalDistance").value, '"/>'); form.push('</form>');
    jQuery(form.join('')).appendTo('body')[0].submit();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T22:48:13.163

试试这个：

```
<strong>Total Distance</strong><span id="totalDistance"></span> 
```

你错过了`>`你的`<span>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:09:28.327

尝试`$('#totalDistance').text()`代替`document.getElementById("totalDistance").value`

# html - 将所有选中的项目放在数组中的复选框中

> ID：10219164
> 
> 赞同：0
> 
> 时间：2012-04-18T22:45:31.373
> 
> 标签：html, ruby-on-rails-3

我需要在一个 html 页面中获取所有选中的项目并将它们放在一个数组中以对其执行特定操作。我不明白复选框的字段（名称，值，...）。我在rails上使用带有ruby的html！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T22:53:06.387

如果您需要使用 javascript 在客户端执行此操作，您可以像这样使用 jQuery：

```
var arr = $('[type=checkbox]:checked'); 
```

如果您需要在服务器端使用 ruby​​ on rails 执行此操作，我无法帮助您。但是我知道只有选中的复选框才会通过 GET 或 POST 发送回服务器，所以如果您知道这些复选框的名称，您可以从请求对象中获取它们并将它们放入数组中。未选中的复选框永远不会到达服务器，因此您不必显式忽略它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:29:12.223

如果你做这样的事情：

```
<input type='checkbox' name='User[]' VALUE='someVal'>Visible Text</option> 
```

用户选中然后提交的任何复选框都将位于名为 User 的 POST 数组中。

提交时将 [ ] 添加到名称中会创建一个数组。

不确定在 ruby​​ on rails 中但在 php 中这样做很热。当提交表单但用户将一个数组传递给服务器时。我们将复选框命名为 User，因此我们发布的数组称为 User。在 php 中，我检索发布的数组，如下所示：

```
print_r($HTTP_POST_VARS["User"]); 
```

然后这会像这样输出数组：

```
Array ( [0] => Me [1] => You [2] => SomeoneElse ) 
```

数组中的所有数据都是复选框。你可以做一个

```
foreach (​​​​​​​ $HTTP_POST_VARS["User"] as $key => $value) { $key is 0, $value is Me. and so on } 
```

希望这会有所帮助——</p>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T23:37:45.243

`$_POST` is already an array of everything within the `form` set. Use this to do your *"certain action"* on the checkboxes. If for whatever reason you need the information in a different variable, then just loop through the `$_POST` and put it into a different variable like so:

```
while ($row = $_POST) {
   $new_var[] = $row[0];
} 
```

That should work for you to put into a new/different array but frankly, I don't see the point of that since it's already an array.

As far as understanding the way the array of $_POST looks like, then `var_dump()` it and see. The name of the checkbox will be that in `[]` and the value will display after the `=>`. So if your input is named `name=box1` and the value is `value=1` then the array, from the `$_POST` standpoint, would look like `[box1] => 1` so you can then use this section by calling it specifically like `$foo = $_POST['box1']` and the value of `$foo` would be the value of `box1` or you can do whatever else you want with that (rather than put into a new variable) by calling it.

# javascript - 是否可以从 JQuery 函数中访问常规 javascript 变量？

> ID：10219165
> 
> 赞同：0
> 
> 时间：2012-04-18T22:45:33.690
> 
> 标签：javascript, jquery

我有一个导入两个文件的 HTML 文件：

graph.js 和 main.js

主文件包含访问手机加速度计/记录加速度的逻辑，它是一个纯 JavaScript 文件。Graph.js 文件包含一个 JQuery 函数 $(.....)

是否可以从 graph.js 访问 main.js 中的变量？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T22:47:32.553

是的，jQuery**是**用 JavaScript 编写的，它可以通过导入其他 JavaScript 文件来访问该页面中声明的任何变量。当您尝试访问`onload`文档中的变量时，我没有看到任何问题，因为在此之前应该已经加载了其他脚本。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T22:47:13.550

是的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T22:47:44.410

如果它在全球范围内，是的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T22:47:22.367

应该是，只要 main.js 首先加载并且将其设置为全局变量。

您可以通过在函数外部创建全局变量来创建它。如果需要，您可以在函数外部创建它，然后将其设置在 main.js 文件中的函数内部。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-18T22:53:52.180

您可以通过几种不同的方式在不同的 JS 文件（一个 jQuery 文件只是一个 JS 文件）之间自由地共享变量：

1.  在全局范围内定义变量，然后可以在任何地方访问它们。
2.  在窗口对象上定义变量。即使定义变量的代码不在全局范围内，这也使它们可以全局访问。
3.  将变量定义为可以从代码中获取的任何对象的属性。因此，如果您有一个名为 的全局配置对象`myConfig`，您可以在其上定义属性，`myConfig.count = 0;`然后您可以`myConfig.count`从任何地方访问。这通常被称为命名空间，并且只创建一个全局对象，然后您可以将多个属性添加到该对象中。
4.  定义一个可全局访问的函数，该函数返回您可以从任何地方调用的数据。

在设计其工作方式时，请记住，通常最好引入尽可能少的全局可访问符号，因为每个符号都有可能与页面中的其他代码发生冲突。

# model-view-controller - CFWheels - 如何验证模型中的表单然后进行查找并输出不同的消息？

> ID：10219168
> 
> 赞同：1
> 
> 时间：2012-04-18T22:45:47.337
> 
> 标签：model-view-controller, coldfusion, railo, cfwheels

在我的“链接”模型中，我进行了一些基本验证，其中之一是检查用户提交的链接是否已经在数据库中。

如果链接已经提交到数据库，我想让他们知道并将他们转发到之前提交的链接（基本上是一个 URL）。

我怎样才能做到这一点？到目前为止，我的模型看起来像这样：

```
<cfcomponent extends="Model" output="true">

    <cffunction name="init">

        <cfset validatesPresenceOf( property='linkURL') />
        <cfset validatesFormatOf( property='linkURL', type='url', message="Your link isn't a valid URL.") />
        <cfset validatesUniquenessOf( property='linkURL') />

    </cffunction>

</cfcomponent> 
```

很基础。validatesUniquenessOf() 效果很好，但我想在我的验证逻辑中做更多的事情。如果我在没有框架的情况下这样做......我当然会做一些标准逻辑，但我想按照轮子需要我的方式工作。

再次感谢 CFWHEELS！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T22:07:46.703

这不属于 的一般用例`validatesUniquenessOf()`，但有一些方法可以使用`addError`and `errorsOn`。

我会在模型中这样做：

```
<cfcomponent extends="Model">

    <cffunction name="init">
        <cfset validatesPresenceOf( property='linkURL') />
        <cfset validatesFormatOf( property='linkURL', type='url', message="Your link isn't a valid URL.") />
        <cfset validate("validateUniqueUrl") />
    </cffunction>

    <cffunction name="validateUniqueUrl" access="private">
        <cfscript>
            if (this.exists(where="linkURL='#this.linkURL#'")) {
                this.addError(property="linkURL", name="linkExists", message="The link you entered already exists.");
            }
        </cfscript>
    </cffunction>

</cfcomponent> 
```

我这样做的原因是您将在控制器中检查一个命名错误（称为`linkExists`）。

然后在你的控制器中：

```
<cfcomponent extends="Controller">

    <cffunction name="create">
        <cfscript>
            link = model("link").new(params.link);

            local.linkExistsErrors = link.errorsOn(property="linkURL", name="linkExists");

            if (link.save()) {
                // Whatever you want to do on success
            }
            else if (ArrayLen(local.linkExistsErrors)) {
                flashInsert(error=local.linkExistsErrors[1].message);
                Location(url=link.linkURL, addToken=false); // Need to use Location or cflocation for hard-coded URLs
            }
            else {
                // Whatever you want to do on other types of validation failures
            }
        </cfscript>
    </cffunction>

</cfcomponent> 
```

## API 资源

*   `errorsOn`：[http ://cfwheels.org/docs/function/errorson](http://cfwheels.org/docs/function/errorson)
*   `validate`：[http ://cfwheels.org/docs/function/validate](http://cfwheels.org/docs/function/validate)
*   `addError`：[http ://cfwheels.org/docs/function/adderror](http://cfwheels.org/docs/function/adderror)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T17:51:46.370

您不能在 validatesUniquenessOf() 的消息属性中提供提交的 url 作为链接吗？这样，用户将收到错误消息，并能够访问消息中的链接。否则，如果 validatesUniquenessOf() 函数返回 false，我认为您将需要使用 cflocation 将用户发送到 linUrl 值。

# iis - 更改 IIS Express 上的会话超时？

> ID：10219169
> 
> 赞同：9
> 
> 时间：2012-04-18T22:45:52.143
> 
> 标签：iis, session-timeout, iis-express

我想在使用 IIS Express 时测试会话超时问题，但我不知道如何修改会话状态设置，以便更改 Cookie 设置的超时。这是可修改的设置吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-19T05:58:16.403

尝试关注

1.在 web 应用程序的 web.config 文件中设置 sessionState timeout 如下所示（以分钟为单位）

> `<sessionState timeout="30" />`

2.确保您的应用程序的应用程序池空闲超时大于或等于上面指定的超时时间（您可以从iisexpress安装文件夹运行以下命令）

> ```
> appcmd set config /section:applicationPools /[name='YourAppPoolName'].processModel.idleTimeout:0.00:30:00 
> ```

# fortran - 类型和类之间数据存储的区别

> ID：10219173
> 
> 赞同：1
> 
> 时间：2012-04-18T22:46:14.737
> 
> 标签：fortran

在以下示例中，内在函数`transfer()`适用于“b”。

但它不适用于多态对象`a`（即不能返回正确大小的 char 数组）。

谁能解释一下这个原因？

任何人都可以提供任何关于序列化/打包任意类型的数据（用于 MPI）的想法吗？

谢谢。

```
module mm
  type::typeA
    integer dat(10)
  end type
end module

program test
  use mm
  class(typeA),allocatable::a
  type(typeA)::b
  allocate(a)
  write(*,*),size(transfer(a,['c']))
  write(*,*),size(transfer(b,['c']))
end program 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T07:32:32.640

多态对象很可能包含额外的隐藏字段，例如指向类 vtable 和/或 RTTI 表的指针。此外，由于您已使多态对象可分配，因此可能会有额外的隐藏字段。

由于不保证 vtable 地址在不同的 MPI 等级上相同，因此传输这些指针值不太可能有用。相反，对于多态类型，您必须创建自定义序列化/反序列化例程，在其中序列化每个数据字段，将其传输到另一个 MPI 等级，并在接收端创建一个空对象并用接收到的数据填充它。

# css - 具有 z-index 的 div 拒绝放置在另一个 div 之上

> ID：10219179
> 
> 赞同：0
> 
> 时间：2012-04-18T22:46:41.100
> 
> 标签：css, html, z-index

我有 3 个 div。一个蓝色的，一个黑色的，一个黄色的。现在我希望将黄色 div 放在黑色 div 的顶部（两者的大小相同）。一些 CSS 和使用 z-index 应该可以解决问题，但它不起作用。

也许有人知道为什么，因为我有点坚持这一点。请参阅我的小提琴与完整的 html 和 css 代码：http: [//jsfiddle.net/mauricederegt/xQVYu/](http://jsfiddle.net/mauricederegt/xQVYu/)

亲切的问候，莫里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:51:13.737

指定这些元素的位置，使它们重叠：

```
#s2, #s3 { top: 0; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T04:49:10.183

嘿，我想你想要这个

您定义您的 s0 div 相对位置，#s3 定义绝对位置并根据您的布局左侧和顶部进行调整

```
#s0{
position:relative;
}

#s3{
background: none repeat scroll 0 0 pink;
    left: 125px;
    position: absolute;
    top: 102px;
} 
```

现场演示[http://jsfiddle.net/rohitazad/xQVYu/4/](http://jsfiddle.net/rohitazad/xQVYu/4/)

# xml - 尝试在 YouTube XML 上做一些 XSLT 魔术，遇到一些命名空间问题

> ID：10219180
> 
> 赞同：0
> 
> 时间：2012-04-18T22:46:46.717
> 
> 标签：xml, xslt, youtube-api, xml-namespaces

因此，我正在尝试编写一个 XSLT 脚本，它将 YouTube 播放列表的默认 RSS 提要转换为视觉上更令人愉悦的格式。我想我的代码或多或少已经被关闭了，但我遇到了我认为命名空间的问题。

基本上，我的 XSLT 解析器似乎卡住了一个`<yt:videoid>`和一个`<media:description>`标记，我不确定如何修复它（原始文档中从未定义过命名空间）。我的代码如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:template match="/">
<xsl:for-each select="feed/entry">
    <item>
        <title><xsl:value-of select="title" /></title>
        <description>
        <![CDATA[<img src="http://i.ytimg.com/vi/{yt:videoid}/hqdefault.jpg">
        <br />
        <br />
        <xsl:value-of select="media:description">
        <br />
        <br />          
        <iframe width="560" height="315" src="http://www.youtube.com/embed/{yt:videoid}" frameborder="0" allowfullscreen></iframe>]]>
        </description>
        <link>http://www.youtube.com/watch?v={yt:videoid}</link>
        <guid isPermaLink="false">http://www.youtube.com/watch?v={yt:videoid}</guid>
        <pubDate><xsl:value-of select="updated" /></pubDate>
    </item> 
```

当我运行它时，它编译时会出现一堆“未定义 Y 上的命名空间前缀 X”错误，并且在我包含`{yt:videoid}`或`media:description`显示为纯文本而不是适当值的任何地方。

另一个更小的问题是 XML 文档是用

```
<feed xmlns='http://www.w3.org/2005/Atom' xmlns:media='http://search.yahoo.com/mrss/' xmlns:openSearch='http://a9.com/-/spec/opensearch/1.1/' xmlns:gd='http://schemas.google.com/g/2005' xmlns:yt='http://gdata.youtube.com/schemas/2007' gd:etag='W/&quot;Ak8EQX47eCp7I2A9WhdSEkQ.&quot;'> 
```

它甚至不会解析，除非我手动将其削减为`<feed>`. 同样，这是一个小得多的问题，我更愿意解决第一个问题。如果有人有任何建议，我将不胜感激！

亚当

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T01:24:53.217

总而言之，XSLT 缺少 XML 中存在的名称空间。因此，如果 XML 包含以下命名空间：

```
xmlns='http://www.w3.org/2005/Atom' xmlns:media='http://search.yahoo.com/mrss/' 
xmlns:openSearch='http://a9.com/-/spec/opensearch/1.1/' 
xmlns:gd='http://schemas.google.com/g/2005'    
xmlns:yt='http://gdata.youtube.com/schemas/2007' 
```

您还需要将其添加到元素中。下面有一个很好的阅读理解下面的 XML 命名空间：

[http://msdn.microsoft.com/en-us/magazine/cc302166.aspx](http://msdn.microsoft.com/en-us/magazine/cc302166.aspx)

# javascript - 从 Backbone.Collection.remove(n) 中检索元素

> ID：10219182
> 
> 赞同：1
> 
> 时间：2012-04-18T22:47:04.517
> 
> 标签：javascript, collections, backbone.js

我正在使用 Backbone.js 迈出第一步，其中之一涉及能够从集合中删除一个项目，更重要的是，检索该项目。Backbone.Collection.remove 方法只是返回删除项目的原始集合，所以目前我在删除之前获得对所需项目的引用：

```
var Collection = Backbone.Collection.extend(...array of Backbone.Models...),
    removedItem = Collection.get(3);
console.log(Collection.remove(3));//same collection sans #3 
```

我的问题是是否有检索删除项目的速记方法？

编辑：JFTR，我已经阅读了相当多的源代码，并且知道原始方法返回对集合的引用-

```
remove: function(models, options) {
  // <snip for brevity>
  // chain pattern incoming
  return this;
}, 
```

它没有返回删除的项目对我来说似乎很奇怪。所以我只是想知道是否还有另一种我缺少的方法，或者实现这种模式的常用方法。这不是我第一次使用长时间的解决方法，因为 API 有一些秘密 doohickey 在它的袖子里……因为我可能会扩展这个类。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T07:37:48.447

您可以向 Backbone.Collection 'type' 添加一个函数，并在您创建的每个集合上使用 removeModel 。

```
Backbone.Collection.prototype.removeModel(model) {
    var _model = this.get(model);
    this.remove(item);
    return _model;
}

var removedModel = collection.removeModel(model); 
```

# ravendb - RavenDB 多图索引

> ID：10219183
> 
> 赞同：5
> 
> 时间：2012-04-18T22:47:05.813
> 
> 标签：ravendb

我是 RavenDB 的新手。我正在尝试使用多地图索引功能，但我不确定它是否是解决我的问题的最佳方法。所以我有三个文件：Unit、Car、People。

汽车文件如下所示：

```
{
 Id: "cars/123",
 PersonId: "people/1235",
 UnitId: "units/4321",
 Make: "Toyota",
 Model: "Prius"
} 
```

人员文档如下所示：

```
{
   Id: "people/1235",
   FirstName: "test",
   LastName: "test"
} 
```

和单位文档：

```
{
   Id: "units/4321",
   Address: "blah blah"
} 
```

这是一个缩略的例子，在我的真实应用程序中有更多的字段，所以数据反规范化将是我最后的手段。

我需要创建和索引将所有这三个文档加入一个文档。像这样的东西：

```
{
   CarId: "cars/123",
   PersonId: "people/1235",
   UnitId: "units/4321",
   Make: "Toyota",
   Model: "Prius"
   FirstName: "test",
   LastName: "test"
   Address: "blah blah"
}

// same unit different person owns a different car

{
   CarId: "cars/122",
   PersonId: "people/1236",
   UnitId: "units/4321",
   Make: "Toyota",
   Model: "4runner"
   FirstName: "test",
   LastName: "test"
   Address: "blah blah"
} 
```

在关系数据库中，我只需通过 id 对 People 和 Unit 表使用两个连接，而我的 car 表将是一个聚合实体。

这是我拥有的索引定义：

```
 public class MyMultiIndex : AbstractMultiMapIndexCreationTask<JoinedDocument>
 {
    public MyMultiIndex()
    {
        // creating maps
        AddMap<Car>(cars => cars.Select(e => new { e.CarId, e.Make, e.Model, PersonId = e.PersonId, UnitId = e.UnitId, FirstName = (null)string, LastName = (null)string, Address = (nul)string }));
        AddMap<People>(people => people.Select(e => new { CarId = (string)null, Make = (string)null, Model = (string)null, PersonId = e.Id, UnitId = (null)string, FirstName = e.FirstName, LastName = e.LastName, Address = (nul)string }));
        AddMap<Unit>(people => people.Select(e => new { CarId = (string)null, Make = (string)null, Model = (string)null, PersonId = (null)string, UnitId = e.null, FirstName = (nul)string , LastName = (nul)string , Address = e.Address }));

        Reduce = results => from result in results
                            group result by result.CarId
                            into g
                            select new JoinedDocument
                            {
                                CarId = g.Key,
                                PersonId = g.First(e => e.CarId == g.Key).PersonId,
                                UnitId = g.First(e => e.CarId == g.Key).UnitId,
                                Model = g.First(e => e.CarId == g.Key).Model,
                                Make = g.First(e => e.CarId == g.Key).Make,

                                **// this never works. It is like result set does not contain anything with this personId. It looks like AddMap for people document did not work.**

                                FirstName = results.First(e => e.PersonId == g.First(ie => ie.CarId == g.Key).PersonId).FirstName,

                                **// this never works. It is like result set does not contain anything with this personId. It looks like AddMap for people document did not work.**

                                LastName = results.First(e => e.PersonId == g.First(ie => ie.CarId == g.Key).PersonId).LastName,

                                **// this never works. It is like result set does not contain anything with this personId. It looks like AddMap for unit document did not work.**

                                UnitAddress = results.First(e => e.UnitId == g.First(ie => ie.CarId == g.Key).UnitId).LastName,
                           };
        Index(map => map.Model, FieldIndexing.Analyzed);
        Index(map => map.Make, FieldIndexing.Analyzed);
        Index(map => map.LastName, FieldIndexing.Analyzed);
        Index(map => map.FirstName, FieldIndexing.Analyzed);
        Index(map => map.Make, FieldIndexing.Analyzed);
        Index(map => map.UnitAddress, FieldIndexing.Analyzed);
    }
 } 
```

当 RavenDb 运行此索引时，我在尝试运行我提供的 Reduce 函数时看到错误。当我尝试匹配存在人名和姓氏的记录时，它会引发错误，单位也会发生同样的情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T07:38:20.297

你能有一辆没有车主的车吗？还是没有居民的地址？如果在这两种情况下都是错误的，我会将汽车和单元建模为嵌入人体内。所以这个人成为你的总根，要到达汽车或单位，你必须经过一个人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:42:00.837

看起来您正在尝试使用具有关系的对象模型来拟合文档数据库。这个博客可以帮助你：

[使用 RavenDB 保持领域模型纯净](http://inaspiralarray.blogspot.com/2012/03/keeping-domain-model-pure-with-ravendb.html)

请记住，这不是 RavenDB 的推荐使用，但有时它是必要的，这是处理它的好方法。

# c# - 为什么 C# 编译器会产生方法调用来调用 IL 中的 BaseClass 方法

> ID：10219188
> 
> 赞同：12
> 
> 时间：2012-04-18T22:47:20.820
> 
> 标签：c#, .net, il

假设我们在 C# 中有以下示例代码：

```
class BaseClass
  {
    public virtual void HelloWorld()
    {
      Console.WriteLine("Hello Tarik");
    }
  }

  class DerivedClass : BaseClass
  {
    public override void HelloWorld()
    {
      base.HelloWorld();
    }
  }

  class Program
  {
    static void Main(string[] args)
    {
      DerivedClass derived = new DerivedClass();
      derived.HelloWorld();
    }
  } 
```

当我 ildasmed 以下代码时：

```
.method private hidebysig static void  Main(string[] args) cil managed
{
  .entrypoint
  // Code size       15 (0xf)
  .maxstack  1
  .locals init ([0] class EnumReflection.DerivedClass derived)
  IL_0000:  nop
  IL_0001:  newobj     instance void EnumReflection.DerivedClass::.ctor()
  IL_0006:  stloc.0
  IL_0007:  ldloc.0
  IL_0008:  callvirt   instance void EnumReflection.BaseClass::HelloWorld()
  IL_000d:  nop
  IL_000e:  ret
} // end of method Program::Main 
```

但是， csc.exe 转换为`derived.HelloWorld();`--> `callvirt instance void EnumReflection.BaseClass::HelloWorld()`。这是为什么？我没有在`Main`方法中的任何地方提到 BaseClass 。

而且，如果它正在调用，`BaseClass::HelloWorld()`那么我会期望`call`而不是`callvirt`因为它看起来直接调用`BaseClass::HelloWorld()`方法。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-18T23:08:39.853

调用转到 BaseClass::HelloWorld 因为 BaseClass 是定义方法的类。虚拟调度在 C# 中的工作方式是在基类上调用该方法，并且虚拟调度系统负责确保调用该方法的最派生覆盖。

Eric Lippert 的这个答案非常有用：[https ://stackoverflow.com/a/5308369/385844](https://stackoverflow.com/a/5308369/385844)

正如他关于该主题的博客系列一样：http: [//blogs.msdn.com/b/ericlippert/archive/tags/virtual+dispatch/](http://blogs.msdn.com/b/ericlippert/archive/tags/virtual+dispatch/)

> 您知道为什么要以这种方式实施吗？如果直接调用派生类的 ToString 方法会发生什么？乍一看，这种方式对我来说并没有太大意义……

它是这样实现的，因为编译器不跟踪对象的运行时类型，只跟踪它们引用的编译时类型。通过您发布的代码，很容易看出调用将转到该方法的 DerivedClass 实现。但是假设`derived`变量是这样初始化的：

```
Derived derived = GetDerived(); 
```

有可能`GetDerived()`返回`StillMoreDerived`. 如果（或继承链之间的`StillMoreDerived`任何类）覆盖该方法，则调用该方法的实现是不正确的。`Derived``StillMoreDerived``Derived`

通过静态分析找到一个变量可以包含的所有可能值就是解决停机问题。对于 .NET 程序集，问题会更严重，因为程序集可能不是一个完整的程序。因此，编译器可以合理地证明`derived`不包含对更多派生对象（或空引用）的引用的情况很少。

添加此逻辑以便它可以发出指令`call`而不是`callvirt`指令需要多少成本？毫无疑问，成本将远远高于所获得的微小收益。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-19T04:34:42.557

考虑这一点的方法是，虚拟方法定义了一个“槽”，您可以在运行时将方法放入其中。当我们发出 callvirt 指令时，我们是在说“在运行时，查看此插槽中的内容并调用它”。

*插槽由关于声明*虚拟方法的类型的方法信息标识，而不是*覆盖*它的类型。

向派生方法发出 callvirt 是完全合法的；运行时会意识到派生方法与基方法是相同的槽，结果将完全相同。但从来没有任何*理由*这样做。如果我们通过识别声明该槽的类型来识别槽，则更清楚。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-09T22:38:20.090

请注意，即使您声明`DerivedClass`为，也会发生这种情况`sealed`。

C# 使用`callvirt`运算符调用任何实例方法（`virtual`或不调用）以自动对对象引用进行空检查 - 在调用方法时引发 a `NullReferenceException`。否则，`NullReferenceException`只会在方法内第一次实际使用类的任何实例成员时引发，这可能会令人惊讶。如果没有使用实例成员，则该方法实际上可以成功完成而不会引发异常。

您还应该记住，IL 不是直接执行的。它首先由 JIT 编译器编译为本机指令 - 并根据您是否正在调试进程执行许多优化。我发现 CLR 2.0 的 x86 JIT 内联了一个非虚拟方法，但称为虚拟方法 - 它也内联了`Console.WriteLine`！

# asp.net-mvc - 强大的自托管服务器的最佳选择：WCF 与 ASP.NET Web Api

> ID：10219204
> 
> 赞同：5
> 
> 时间：2012-04-18T22:49:31.710
> 
> 标签：asp.net-mvc, wcf, asp.net-mvc-3, asp.net-web-api

我们目前有一个 .NET 4 应用程序，它由在后台运行的 Windows 服务和本地或远程客户端（通常只有 1-3 个）组成。

客户端有一个 WPF GUI，需要一些来自 Windows 服务的数据。因此，我们将 WCF 与 NamedPipe 绑定用于本地客户端，将 NetTcp 绑定用于远程客户端。这可行，但我们经常遇到无法访问的端点（通道故障或未找到等）的问题。我们已经尝试重建故障连接，但它似乎非常脆弱......

现在进入 Web Api：看起来基于 HTTP 的堆栈可能更健壮（没有通道，没有端点，也可以在 Windows 服务中自托管）。通道中断似乎没有问题，因为每个请求都是单独处理的。因此，如果某些事情失败了，您只需重复请求即可。（而且我们有其他应用程序使用 ASP.NET MVC 的经验，所以这对我们来说并不新鲜）。

现在我们正在考虑什么可能是我们最好的选择。是“强化”我们现有的 WCF 服务（一个服务接口，大约 15 个操作）还是将接口移动到 Web Api 并作为 HTTP 请求（使用 JSON 数据）运行它更好？性能不是我们这里的主要问题......

有任何想法吗？哈特穆特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T01:14:56.507

我建议您坚持为您的 WPF 应用程序使用 WCF (SOAP) 服务，而不是迁移到 Web API。有许多的原因。首先，我认为我们需要考虑新的 Web API 试图解决的问题——即提供一个支持 RESTful/HTTP/超媒体服务的框架。这可能非常适合构建大量使用 HTTP 的应用程序，例如 Web、移动和 JavaScript 应用程序，您希望在这些应用程序中最大化服务的“覆盖范围”或互操作性（无论平台如何）。这并不是说您不能将它用于 WPF 客户端，但是在您的情况下，所有流量都在您的域中，因此坚持当前的实现更有意义。

您为您的服务/客户所做的绑定选择对我来说听起来不错。我将专注于您的渠道出现故障的原因并解决这些问题。您可能还想考虑通过 IIS 托管您的服务并使用 WAS 来公开您的非 HTTP 端点。过去我在这方面取得了很大的成功，而且大部分情况下都相当稳定。它还消除了管理您自己的主机的一些麻烦。如果您担心 TCP 绑定错误，那么只需创建一个新的 HTTP 或 wsHTTP 端点并使用它。这将为您提供与 web api 使用的完全相同的传输，而无需更改您的编程模型。

# multithreading - 双重嵌套并行 for 循环及其跨度

> ID：10219207
> 
> 赞同：1
> 
> 时间：2012-04-18T22:49:44.097
> 
> 标签：multithreading, for-loop, parallel-processing, parallel-for

我试图围绕并行循环如何工作的想法来思考，这对我来说都是新的，并且已经阅读了这个 stackoverflow 线程，在这里找到了[span 和 parallel loop](https://stackoverflow.com/questions/5918477/span-and-parallel-loop)，并发现那里的最佳答案真的很有帮助。

我想知道的是，如果我有一个内部有一个parallel-for-lop的parallel-for-lop，它们是否会以以下方式运行（为方便起见，我将让n = 5并且'to'表示向上包括（<=））：

这是我脑海中的代码：

```
parallel for j=1 to n{
    parallel for i=1 to j-1{
       Do-something
    }
} 
```

这是我倾向于的线程的行为，但希望有人确认是否正确：

```
Time           Action
 0       Thread0 creates Thread1
 1       Thread0 creates Thread2, T1 -> T3
 2       T0 -> T4, T1 -> T5 
```

好的，外观的所有线程都已创建。现在是内在。这里 subXY 表示线程 x 的线程编号 y：

```
time           Action
 3       T0 -> SubT0t0, T1 -> subT1t0, T2-> SubT2t0....  

             //All threads have created a subthread t0 so 5 more threads created.

 4       T0 -> subT1t1, subT0t0 -> subT2t1, T1->subT2t2, subT1t0->subT3t1...

             //All the subthreads created more threads AND the 'Older' threads 
             //created subthreads under other 'Older' threads. 11 more created.

 5       T0 -> subT5t2, subT0t0 -> subT5t3, T1 -> subT5t4, subT5t5

             //All threads have been created.
 6       Execute command Do-something 
```

我知道这可能不是对我所想的最好的描述，但它是我能想到的最好的。

这个对吗？或者外循环线程只会使线程连接到他自己？例如 T1 只会制作 subT1XX 线程？

在时间 5 什么也不做的线程也会在那段时间执行它们的命令吗？

如果有人可以帮助我，那将极大地帮助我。

# javascript - jquery的鼠标事件问题

> ID：10219209
> 
> 赞同：3
> 
> 时间：2012-04-18T22:49:57.840
> 
> 标签：javascript, mouseevent, jquery

我创建了一个菜单并尝试使用 mouseover (mouseenter) 和 mouseout(mouseleave) 但不幸的是，如果您将鼠标移动得太快，则不会触发某些事件并且悬停图像不会更改回原始图像。

我需要使用 mouseover 和 mouseout 事件而不是悬停，因为如果单击图像，我需要显示原始图像。

请在以下位置查看演示： [演示链接](http://jsfiddle.net/3YBe4/9/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T22:58:48.367

我不认为每个图标使用两个不同的图像元素是一个好主意。

## 单个图像元素

您应该为每个图标使用一个元素，并在触发 mouseover 和 mouseout 时切换类和图像 src。

像这样（最小的例子）：

```
 $(".side_left").mouseover(function() {
    $(this).prop("src", "http://www.spiritualawakeningradio.com/yaha.jpg");
 }).mouseout(function(){
    $(this).prop("src", "http://img.creativemark.co.uk/uploads/images/461/13461/smallImg.png");
 }); 
```

**工作小提琴：[DEMO](http://jsfiddle.net/pmjw8/)**

## 使用 CSS 精灵更新

这是一个更好的 CSS sprite 示例。不需要 JavaScript 和大部分标记，只需要一些 CSS：

```
.side_left {
    width: 60px;
    height: 60px;
    background: url('http://i.imm.io/mvRL.png');
}
.side_left:hover {
    background-position: 60px;
} 
```

**工作小提琴：[DEMO](http://jsfiddle.net/VB9pD/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:53:55.017

您可以尝试使用悬停进行初始更改，然后单击更改类或图像源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T23:04:30.797

发生这种情况是因为您在隐藏的项目上使用鼠标事件，因此当您移动得足够快时，该项目不会触发 mouseout 事件。

我稍微修改了您的原始代码以使其工作，但是，您应该考虑废弃两个图像标签并使用 jQuery 在两个图像 src 属性值或 CSS 之间进行交换，或者使用纯 CSS 和 :hover 选择器。

[http://jsfiddle.net/MATMD/](http://jsfiddle.net/MATMD/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T23:08:49.187

您可以只使用 css 并为每个 JavaScript 添加 css-classes 来执行此操作。

我更新了您的小提琴以向您展示，这将显着减少所需的 JavaScript 代码。我保留了您现有的标记，尽管我认为这也可以用更少的标记来完成：

[http://jsfiddle.net/3YBe4/12/](http://jsfiddle.net/3YBe4/12/ "jsFiddle 演示")

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-18T23:13:54.930

如果您快速移动鼠标，则您没有给 .side_left_hover 元素足够的时间来开始监听鼠标。

那么如何解决呢？我会将所有鼠标侦听器放在 .side_left/.side_left_hover 容器 div 中。这也将使您的代码更简单、更清晰。

这是小提琴：http: [//jsfiddle.net/rJK3R/1/](http://jsfiddle.net/rJK3R/1/)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-18T23:39:53.530

## *[jsFiddle 演示](http://jsfiddle.net/rUwuA/)*

*   我使用了 .on() 方法并列出了所需的鼠标事件。
*   您可以附加一个事件处理程序`(e)`并检查它在函数内的类型。

.

```
$('img.side_left').parent('div').on('mouseenter mouseleave click', function(e){
    if(e.type === 'mouseenter' || e.type==='mouseleave'){
        $(this).find('img:not(.active)').toggle();
    }else{ // IS CLICK
        $('img.active').toggle().removeClass('active');                
        $(this).find('img').addClass('active');
    }
}); 
```

# tridion - 无法将客户端连接到 Tridion 2011 SP1 上的 Tridion Content Porter 2009 SP1

> ID：10219211
> 
> 赞同：7
> 
> 时间：2012-04-18T22:50:17.360
> 
> 标签：tridion

我正在尝试将 Content Porter 2009 SP1 客户端连接到 Tridion 2011 SP1 Content Manager，但在测试连接时出现错误。

我刚刚在 Content Manager 上安装了 Content Porter Server，并从 Content Manager 下载/安装了 Content Porter Client。在客户端中配置 Content Manager 的地址并尝试进行身份验证以执行导出后，我收到一条错误消息，提示“在 SDL Tridion Content Manager 服务器上找不到 SDL Content Porter 2009 SP1 服务器”。

客户端日志具有以下条目：

> 2012 年 4 月 18 日晚上 10:06:15 [严重] 测试连接返回错误调用目标已引发异常。无法从程序集“Tridion.Common，Version=6.1.0.25，Culture=neutral，PublicKeyToken=349a39f202fa9b53”加载类型“Tridion.Licensing.LicenseManager”。在 System.Web.Services.Protocols.SoapHttpClientProtocol.ReadResponse（SoapClientMessage 消息，WebResponse 响应，流 responseStream，布尔 asyncCall）在 System.Web.Services.Protocols.SoapHttpClientProtocol.InvokeAsyncCallback（IAsyncResult 结果）

我已验证 cp_license.xml 和 license.xml 都存在于内容管理器上。我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T23:34:26.760

您缺少一个修补程序。登录 SDLTridionWorld.com，转到下载 -> 修补程序 -> Content Porter 2009 SP1，然后下载（并安装）修补程序 CP_3.1.0.75326。

这应该让你继续前进。

# iphone - iPhone在打开时放大了页面

> ID：10219212
> 
> 赞同：6
> 
> 时间：2012-04-18T22:50:25.593
> 
> 标签：iphone, zooming, viewport

我一直在研究我的第一个响应式设计，但在我的 iPhone 上查看它时遇到了一些问题。当我在 iPhone 上打开一个页面时，它向左放大了一点——刚好错过了最右边的文本。

[您可以在此处](http://www.andersnoren.se)找到该网站。viewport-meta 标签如下所示：

```
<meta name="viewport" content="width=device-width; initial-scale=1.0;" /> 
```

在我的电脑和 iPad 上看起来都不错。任何和所有的帮助表示赞赏。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-18T22:54:55.857

试试这个视口，它在我的网站上效果很好：

```
<meta name="viewport" content="initial-scale=1, maximum-scale=1"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T11:49:58.877

找到了。我在 .wrapper 元素下放置了`width:100%;`and 。将其更改为and ，它就像一个魅力。`padding:0 10px;``@media only screen and (max-width: 600px)``width:96%``padding: 0 2%;`

谢谢您的帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-03-02T15:23:34.927

看看你是否`100vh`在任何地方使用你的 CSS。如果您使用`100vh`它，则将菜单栏和底部工具栏视为`100vh`. 见[https://chanind.github.io/javascript/2019/09/28/avoid-100vh-on-mobile-web.html](https://chanind.github.io/javascript/2019/09/28/avoid-100vh-on-mobile-web.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-03T12:18:52.630

尝试同时添加`width:100%; overflow:hidden;`和`body`元素`html`。如果您的页面加载不同，那肯定是 CSS 问题。

# mysql - 每个条目只请求一次列条目的 SQL 语句是什么

> ID：10219213
> 
> 赞同：1
> 
> 时间：2012-04-18T22:50:28.230
> 
> 标签：mysql

即使有许多相同的类型，每个条目只请求一次列条目的 SQL 语句是什么？

我正在使用 MySQL（最新版本）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:53:47.310

你的意思是像DISTINCT这样的东西吗？

它只显示每个条目一次

[http://dev.mysql.com/doc/refman/5.5/en/distinct-optimization.html](http://dev.mysql.com/doc/refman/5.5/en/distinct-optimization.html)

另一种可能性是 GROUP BY 根据条目名称创建组

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T22:55:29.677

也许您正在寻找`SELECT DISTINCT`？它使得如果您的表包含条目：

```
word
----
hi
hi
hello
orange
hi
banana 
```

查询`select distinct word from tablename`将为您提供：

```
word
----
hi
hello
orange
banana 
```

这是一个[快速教程](http://www.w3schools.com/sql/sql_distinct.asp)和[文档](http://dev.mysql.com/doc/refman/5.5/en/select.html)。

# php - 图像/文件上传到 mysql 数据库不起作用

> ID：10219221
> 
> 赞同：0
> 
> 时间：2012-04-18T22:51:02.617
> 
> 标签：php

我目前在将图像上传到我的数据库时遇到了一些困难。我目前从一个表单上传了多个变量/输入 - 如果这些输入是图像文件上传，则为一个。该文件似乎使它成为数据库，但是当我尝试通过 PHP 脚本检索图像时，它只是返回“数组”，而不是图像。有什么帮助吗？谢谢！

这是上传代码：

```
 // if the form's submit button is clicked, we need to process the form
            if (isset($_POST['submit']))
            {
                    // get the form data
                            $projectname = htmlentities($_POST['projectname'], ENT_QUOTES);
                            $item = htmlentities($_POST['item'], ENT_QUOTES);
                            $description = htmlentities($_POST['description'], ENT_QUOTES);
                            $neededby = htmlentities($_POST['neededby'], ENT_QUOTES);
                            $shipping= htmlentities($_POST['shipping'], ENT_QUOTES);
                            $revisions = htmlentities($_POST['revisions'], ENT_QUOTES);
                            $price = htmlentities($_POST['price'], ENT_QUOTES);
                            $paid = htmlentities($_POST['paid'], ENT_QUOTES);
                            $ordered1 = htmlentities($_POST['ordered1'], ENT_QUOTES);
                            $ordered2 = htmlentities($_POST['ordered2'], ENT_QUOTES);
                            $ordered3 = htmlentities($_POST['ordered3'], ENT_QUOTES);
                            $received1 = htmlentities($_POST['received1'], ENT_QUOTES);
                            $received2 = htmlentities($_POST['received2'], ENT_QUOTES);
                            $received3 = htmlentities($_POST['received3'], ENT_QUOTES);
                            $shipped1 = htmlentities($_POST['shipped1'], ENT_QUOTES);
                            $shipped2 = htmlentities($_POST['shipped2'], ENT_QUOTES);
                            $shipped3 = htmlentities($_POST['shipped3'], ENT_QUOTES);
                            $tracking = htmlentities($_POST['tracking'], ENT_QUOTES);
                            $delivered = htmlentities($_POST['delivered'], ENT_QUOTES);
                            $thestatus = htmlentities($_POST['thestatus'], ENT_QUOTES);
                            $photo=($_FILES['photo']); 

                   if ($projectname == '')
                            {
                                    // if they are empty, show an error message and display the form
                                    $error = 'ERROR: Please fill in project name!';
                                    renderForm($projectname, $item, $description, $neededby, $shipping, $revisions, $price, $paid, $ordered1, $ordered2, $ordered3, $received1, $received2, $received3, $shipped1, $shipped2, $shipped3, $tracking, $delivered, $thestatus, $photo, $error, $id);
                            }

                            else
                            {
                            // insert the new record into the database
                            if ($stmt = $mysqli->prepare("INSERT todo (projectname, item, description, neededby, shipping, revisions, price, paid, ordered1, ordered2, ordered3, received1, received2, received3, shipped1, shipped2, shipped3, tracking, delivered, photo, thestatus) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"))
                            {
                                    $stmt->bind_param("sssssssssssssssssssss", $projectname, $item, $description, $neededby, $shipping, $revisions, $price, $paid, $ordered1, $ordered2, $ordered3, $received1, $received2, $received3, $shipped1, $shipped2, $shipped3, $tracking, $delivered, $photo, $thestatus);
                                    $stmt->execute();
                                    $stmt->close();
                            }

                            // show an error if the query has an error
                            else
                            {
                                    echo "ERROR: Could not prepare SQL statement.";
                            }

                            // redirec the user
                            header("Location: main.php");
                    }

            } 
```

文件检索代码：

```
<?php 
mysql_connect("localhost","MYUSER","MYPASS"); 
mysql_select_db("MYDB"); 
$query = "SELECT photo FROM todo where id=$id"; 
$result = MYSQL_QUERY($query); 
$data = MYSQL_RESULT($result,0,"photo"); 
Header( "Content-type: $type"); 
print $data; 
?> 
```

mysql 列是 BLOB 类型。

这是一张图片，因此您可以了解我所说的内容：http: [//i.imgur.com/DYHHx.png](http://i.imgur.com/DYHHx.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T22:59:39.173

```
$fileName = $_FILES['image']['name'];
$tmpName  = $_FILES['image']['tmp_name'];
$fileSize = $_FILES['image']['size'];
$fileType = $_FILES['image']['type'];

$fp      = fopen($tmpName, 'r');
$photo = fread($fp, filesize($tmpName));
$photo = addslashes($photo);
fclose($fp);

if(!get_magic_quotes_gpc())
{
    $fileName = addslashes($fileName);
}

//and here your insert query as i remember you can try it

HTML CODE:

   <input type=\"file\" name=\"image\" />

and here is how you retrive it

echo '<img src="data:image/jpeg;base64,' . base64_encode( $row['imageContent'] ) . '" />'; 
```

但我不建议您这样做，因为它会使您的数据库无法快速加载，因此将图像保存到文件夹中，并且只保存数据库中的名称

请注意，我从论坛获得了此代码，但不记得它的名称抱歉

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:42:04.600

试试这个教程

[http://www.tizag.com/phpT/fileupload.php](http://www.tizag.com/phpT/fileupload.php)

将文件名放在变量上，然后将其插入数据库（我希望您知道如何从数据库中检索数据）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T05:31:22.620

将图像直接上传到数据库通常是一个非常糟糕的主意。原因是一段时间后，从数据库中读取和上传文件会使数据库过载。

更好的解决方案是将图像上传到服务器上的文件夹，然后将文件名和位置保存在数据库中。

# bash - 替换取决于其他列的值

> ID：10219224
> 
> 赞同：0
> 
> 时间：2012-04-18T22:51:18.700
> 
> 标签：bash, substitution

我想在几个大文本文件中执行条件替换。结构是

```
1 ad sd bg we we A.2 890 3434 DATA
2 gf nh ok wa we A.1 890 3434 DATA
3 gf nh ok wa we A.1 890 3434 
...
... 
```

我想做，当第10列中存在值“DATA”时（并不总是发生），检查第7列的元素是否为A.1。在这种情况下，将其替换为 B.2

我尝试了混合的 see plus awk 方法，但无法完成，在 bash 中执行此操作的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T23:38:22.073

```
awk '$10=="DATA"&&$7=="A.1"{$7="B.1"}1' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:41:33.953

下面将找到同时包含“DATA”和“A.1”的行，并将“A.1”替换为“B.2”，并为您提供新的输出。

注意：以下命令不区分特定字段。只要“DATA”和“A.1”出现在同一行中，“A.1”就会更改为“B.2”。

```
sed -e '/A\.1.*DATA/!d;s/A\.1/B\.2/' /yourfile 
```

要编辑文件并保留其他行，您可能需要尝试以下 bash 脚本。以下包含内联编辑。在测试任何东西之前，请备份您的文件。

```
#!/bin/bash

ORIG=$(sed -e '/A\.1.*DATA/!d' /yourfile)
NEW=$(sed -e '/A\.1.*DATA/!d;s/A\.1/B\.2/' /yourfile)

sed -i "s/${ORIG}/${NEW}/g" /yourfile 
```

注意：对于 OS X 用户，您可能需要尝试以下操作。-i 开关在 OS X 上有所不同。（脚本确实包含内联编辑，因此在测试之前请备份您的文件。）

```
#!/bin/bash

ORIG=$(sed -e '/A\.1.*DATA/!d' /yourfile)
NEW=$(sed -e '/A\.1.*DATA/!d;s/A\.1/B\.2/' /yourfile)

sed -i '' "s/${ORIG}/${NEW}/g" /yourfile 
```

# c++ - C++ 创建文本和变量的字符串

> ID：10219225
> 
> 赞同：57
> 
> 时间：2012-04-18T22:51:26.047
> 
> 标签：c++, string, variables, std

我正在尝试做一些非常简单的事情，但是，经过一个小时的搜索，我找不到合适的答案，所以我必须遗漏一些相当明显的东西。

我正在尝试动态创建用于 ifstream 的文件名。虽然我知道有多种方法可以做到这一点，但我决定创建一个 std::string，并使用 stringname.c_str 转换为 const。

然而，问题是我需要使用混合变量和预定义文本值来创建字符串。我收到编译器错误，所以这一定是语法问题。

伪

```
std::string var = "sometext" + somevar + "sometext" + somevar; 
```

谢谢！

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-04-18T22:54:36.013

您是否考虑过使用字符串流？

```
#include <string>
#include <sstream>

std::ostringstream oss;
oss << "sometext" << somevar << "sometext" << somevar;
std::string var = oss.str(); 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2014-09-17T16:26:49.083

在 C++11 中，您可以使用[std::to_string](http://www.cplusplus.com/reference/string/to_string/)：

```
std::string var = "sometext" + std::to_string(somevar) + "sometext" + std::to_string(somevar); 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2012-04-18T23:02:34.610

```
std::string var = "sometext" + somevar + "sometext" + somevar; 
```

这不起作用，因为添加是从左到右执行的，并且`"sometext"`（第一个）只是一个`const char *`. 它`operator+`无话可说。最简单的解决方法是：

```
std::string var = std::string("sometext") + somevar + "sometext" + somevar; 
```

现在，从左到右的`+`操作列表中的第一个参数是 a `std::string`，它有一个`operator+(const char *)`。该运算符产生一个字符串，使链的其余部分工作。

您还可以将所有操作设置为 on `var`，这是 a `std::string`，因此具有所有必要的运算符：

```
var = "sometext";
var += somevar;
var += "sometext";
var += somevar; 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2019-12-04T09:39:57.430

使用 c++20 的新方法是使用[format](http://eel.is/c++draft/format)。

```
#include <format>

auto var = std::format("sometext {} sometext {}", somevar, somevar); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-12-17T09:45:59.570

另请参阅[boost::format](http://www.boost.org/doc/libs/1_54_0/libs/format/doc/format.html)：

```
#include <boost/format.hpp>

std::string var = (boost::format("somtext %s sometext %s") % somevar % somevar).str(); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-04-18T22:57:21.193

您还可以使用 sprintf：

```
char str[1024];
sprintf(str, "somtext %s sometext %s", somevar, somevar); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-21T12:50:43.367

你可以有类似的东西：

```
#define Compose(...) ComposeFn({ __VA_ARGS__ })

std::string ComposeFn(std::initializer_list<std::string> strList) {
    std::ostringstream ss;
    for(std::string str : strList) {
        ss << str;
    }
    return ss.str();
} 
```

然后像这样使用它：

```
int errcode = 404;
std::cout << Compose("[ERROR]: (", errcode, ") doesn't exist") << std::endl; 
```

该`Compose`宏只是为了避免使用大括号。你也可以使用可变参数函数，但是嗯

# guice - Guice，注入类型Literal 使用@AssistedInject 时

> ID：10219227
> 
> 赞同：2
> 
> 时间：2012-04-18T22:51:35.707
> 
> 标签：guice, guice-3

这有效：

```
public static class SomeGenericType<T> {
    private TypeLiteral<T> type; 

    @Inject
    public SomeGenericType(TypeLiteral<T> type) {
        this.type = type; 
    }

    public Class<? super T> getType() {
        return type.getRawType();
    }
} 
```

当我这样做时，Guice 会自动注入表示 String 的 TypeLiteral：

```
@Inject SomeGenericType<String> foo; 
```

但是当使用辅助注入尝试同样的事情时：

```
public static interface FooFactory<T> {
    Foo<T> create(String name);
}

public static class Foo<T> {

    @AssistedInject
    public Foo(TypeLiteral<T> type, @Assisted String name) {
        .... 
```

我的模块看起来像这样：

```
public static class TestMod extends AbstractModule {
    @Override
    protected void configure() {
        install(new FactoryModuleBuilder().build(new TypeLiteral<FooFactory<String>>(){}));
    }   
} 
```

安装模块时出现异常：

```
TypeLiteral<T> cannot be used as a Key, it is not fully specified. 
```

这当然是我试图注入的 TypeLiteral 问题，因为当我删除它时，通用工厂确实可以正常工作。

所以，我现在可能只是建立自己的工厂，但我很好奇这是否可行？使用 FactoryModuleBuilder 是否略有不同？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T16:21:07.247

您如何访问 FooFactory 的实例？我在下面的代码上构建了变体，它对我有用：

```
public class AnotherGuiceTest {
    public static void main( String[] args ) {
        Injector i = Guice.createInjector( new TestMod() );
        FooFactory<String> ff = i.getInstance( Key.get( new TypeLiteral<FooFactory<String>>() {} ) );
        ff.create( "myname" );
    }
}

interface FooFactory<T> {
    Foo<T> create( String name );
}

class Foo<T> {

    @Inject
    public Foo( TypeLiteral<T> type, @Assisted String name ) {
        System.out.println( type.getRawType() );
        System.out.println( name );
    }
}

class TestMod extends AbstractModule {
    @Override
    protected void configure() {
        install( new FactoryModuleBuilder().build( new TypeLiteral<FooFactory<String>>() {} ) );
    }
} 
```

输出：

```
class java.lang.String
myname 
```

请注意，我使用了常规`@Inject`注释，而不是`@AssistedInject`我*认为*用于工厂中的多个构造函数的注释。如果您直接注入实例，这也有效：

```
public class AnotherGuiceTest {
    public static void main( String[] args ) {
        Injector i = Guice.createInjector( new TestMod() );
        AppClass ac = i.getInstance( AppClass.class );
    }
}

class AppClass {
    @Inject
    public AppClass( FooFactory<String> fooFactory ) {
        fooFactory.create( "test" );
    }
} 
```

输出：

```
class java.lang.String
test 
```

# php - 我如何知道用户对我的 MediaWiki 扩展有多少编辑？

> ID：10219229
> 
> 赞同：-1
> 
> 时间：2012-04-18T22:51:47.637
> 
> 标签：php, mediawiki

我正在编写一个扩展程序，允许我添加神奇的单词：`CURRENTUSER`, `CURRENTUSERREALNAME`, `CURRENTUSERLANGABBR`, `CURRENTUSERGROUPS`，现在我想添加`CURRENTUSEREDITCOUNT`and `CURRENTUSEREDITCOUNTALL`。

我的代码的那部分目前是：

```
function wfGetCustomVariable(&$parser,&$cache,&$index,&$ret) {
switch ($index) {
    case MAG_CURRENTUSER:
        $parser->disableCache(); # Mark this content as uncacheable
        $ret = $GLOBALS['wgUser']->getName();
        break; 
    case MAG_CURRENTUSERREALNAME:
        $parser->disableCache(); # Mark this content as uncacheable
        $ret = $GLOBALS['wgUser']->getRealName();
        break;
    case MAG_CURRENTUSERLANGABBR
        $parser->disableCache(); # Mark this content as uncacheable
        $ret = $GLOBALS['wgLang']->getCode();
        break;
    case MAG_CURRENTUSERGROUPS
        $parser->disableCache(); # Mark this content as uncacheable
        $array = $GLOBALS['wgUser']->getEffectiveGroups();
        $ret = implode(",", $array);
        break;
}
return true;
} 
```

但是，我似乎找不到用于编辑计数的 $GLOBAL。我基于其他因不同原因使用不同编辑计数的扩展进行了一些研究，并发现：

对于[CURRENTUSEREDITCOUNT](http://svn.wikimedia.org/viewvc/mediawiki/trunk/extensions/Contributionseditcount/Contributionseditcount.php?view=markup#l27)：

```
function wfContributionseditcount( $uid ) {
if ( $uid != 0 ) {
        global $wgOut, $wgLang;
        $wgOut->addWikiText( wfMsgExt( 'contributionseditcount', array( 'parsemag' ),
        $wgLang->formatNum( User::edits( $uid ) ),
        User::whoIs( $uid ) ) );
    }
    return true;
} 
```

对于[CURRENTUSEREDITCOUNTALL](http://svn.wikimedia.org/viewvc/mediawiki/trunk/extensions/CountEdits/CountEdits.page.php?view=markup#l21)：

```
public function execute( $params ) {
    global $wgOut, $wgUser;
    $skin = $wgUser->getSkin();
    $this->setHeaders();
    $this->loadRequest( $params );
    $wgOut->addHTML( $this->makeForm() );
    if( $this->target ) {
        if( User::isIP( $this->target ) ) {
            $this->showResults( $this->countEditsReal( 0, $this->target ) );
        } else {
            $id = User::idFromName( $this->target );
            if( $id ) {
                $this->showResults( $this->countEditsReal( $id, false ), $id );
            } else {
                $wgOut->addHTML( '<p>' . wfMsgHtml( 'countedits-nosuchuser', htmlspecialchars( $this->target ) ) . '</p>' );
            }
        }
    }
    $this->showTopTen( $wgOut );
    return true;
} 
```

我过去曾尝试自学 PHP，但一直在努力。我在当地社区大学报名参加了 PHP 课程，但直到 12 年秋季才开始。我是在找对地方，还是有一个更简单的地方可以找到用户的编辑计数？也许作为[/trunk/phase3/includes/User.php](http://svn.wikimedia.org/viewvc/mediawiki/trunk/phase3/includes/User.php?view=markup)某个地方的一部分？我应该提到这需要在运行 MW 1.17.1 的 wiki 上运行，因此[classUser](http://svn.wikimedia.org/doc/classUser.html)无法在 MW 1.18+ 的地方工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T21:15:52.537

如果您想要更改编辑计数的定义，也许您应该直接更改代码，在删除页面后减少用户的编辑计数。

# c# - 如何在后面的代码中访问 TemplateField

> ID：10219230
> 
> 赞同：1
> 
> 时间：2012-04-18T22:51:51.863
> 
> 标签：c#, asp.net, .net, templatefield, detailview

```
<asp:DetailsView...
    <asp:TemplateField HeaderText="My CheckBox" SortExpression="DataID" >
         <InsertItemTemplate>
                <asp:CheckBox ID="T01cbx" runat="server" Visible ="false" Checked='<%# Bind("DataID") %>' AutoPostBack="True" " />
         </InsertItemTemplate>
    </asp:TemplateField> 
```

我想为上面的 TemplateField 提供一个 ID 或名称，并从后面的代码中访问它。无论如何通过提供 ID 或名称来找到 TemplateField？这是在 DetailView 中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T23:03:46.263

您可以使用 LINQ 来获得`TemplateField`它`HeaderText`：

```
TemplateField cbField = DetailsView1.Fields.OfType<TemplateField>()
                       .Where(f => f.HeaderText == "My CheckBox")
                       .FirstOrDefault(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:54:55.700

我过去曾尝试过这样做，但从来没有找到比编写一个循环所有列并找到我想通过它的 SortExpression 修改的函数更好的方法。

这是我用来通过它们的 SortExpression 隐藏/显示列的函数：

```
public void ShowHideGridColumnBySortExpression(string sortExpression, bool show)
{
    for (int i = 0; i < gvProducts.Columns.Count; i++)
    {
        if (gvProducts.Columns[i].SortExpression != null && gvProducts.Columns[i].SortExpression == sortExpression)
        {
            gvProducts.Columns[i].Visible = show;
            break;
        }
    }
} 
```

# bash - 如何在shell脚本中垂直解析数据？

> ID：10219235
> 
> 赞同：1
> 
> 时间：2012-04-18T22:52:23.160
> 
> 标签：bash, shell

我在控制台中打印出这样的数据：

```
A B C D E
1 2 3 4 5 
```

我想操纵它，所以`A:1 B:2 C:3 D:4 E:5`打印出来。

最好的方法是什么？我应该标记这两行然后使用数组打印出来吗？

我如何在 bash 中处理它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T23:29:47.070

awk 对此有好处。

```
awk 'NR==1{for(i=0;i<NF;i++){row[i]=$i}} NR==2{for(i=0;i<NF;i++){printf "%s:%s",row[i],$i}}' oldfile > newfile 
```

一个更易读的脚本版本：

```
#!/usr/bin/awk -f

NR == 1 {
    for(i = 0; i < NF; i++) {
        first_row[i] = $i
    }
}
NR == 2 {
    for(i = 0; i < NF; i++) {
        printf "%s:%s", first_row[i], $i
    }
    print ""
} 
```

如果你想让它垂直缩放，你必须说如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:15:41.120

对于具有任意数量元素的两行：

```
(read LINE;
 LINE_ONE=($LINE);
 read LINE;
 LINE_TWO=($LINE);
 for i in `seq 0 $((${#LINE_ONE[@]} - 1))`;
 do
     echo ${LINE_ONE[$i]}:${LINE_TWO[$i]};
 done) 
```

要做成对的行只需将其包装在一个循环中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T00:29:48.380

这可能对您有用：

```
echo -e "A B C D E FFF GGG\n1 2 3 4 5 666 7" |
sed 's/ \|$/:/g;N;:a;s/\([^:]*:\)\([^\n]*\)\n\([^: ]\+ *\)/\2\1\3\n/;ta;s/\n//'
A:1 B:2 C:3 D:4 E:5 FFF:666 GGG:7 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T01:15:18.143

Perl 单行：

```
perl -lane 'if($.%2){@k=@F}else{print join" ",map{"$k[$_]:$F[$_]"}0..$#F}' 
```

更清晰的版本：

```
#!/usr/bin/perl 
my @keys;
while (<>) {
  chomp;
  if ($. % 2) {  # odd lines are keys
     @keys = split ' ', $_;
  } else { # even lines are values
     my @values = split ' ', $_;
     print join ' ', map { "$keys[$_]:$values[$_]" } 0..$#values;
  }
} 
```

# c++ - 旧版 C++ Win32 DLL 中的空终止字符串 - 有没有更好的方法？

> ID：10219238
> 
> 赞同：1
> 
> 时间：2012-04-18T22:52:42.283
> 
> 标签：c++, string, winapi, dll

在十多年没有使用 C++ 编程之后，我正在尝试向旧版 C++ Win32 DLL 添加正确的错误报告。

这有力地提醒了在 C/C++ 中使用空终止字符串令人难以置信的乏味——更不用说潜在的缓冲区溢出和安全问题了。

我正在考虑使用更高级的字符串库——可能是 MFC CString 或 STL 库。

**编辑**

我们软件的两个旧版本都使用 DLL - 用 C++ 编写；和更新的版本 - 用 C# 编写。

编译器是VS2008。

对于第一遍，我将记录到标准 Windows 事件日志，因为将错误消息传递回 DLL 客户端将是一个重大的架构变化（当前架构很糟糕，多个故障模式被折叠成一个布尔通过/失败返回值一直传递到调用堆栈。不用说，这使得问题诊断成为一场噩梦）。但我想在以后改进这一点。

**字符串库问题**

既然这是一个 DLL，这甚至是一个好主意吗？

DLL 是否有任何特殊注意事项？

我应该注意的问题？

为此目的，一个图书馆是否比另一个图书馆更好？

**空字符串问题**

如果我遇到空终止，我应该使用哪组字符串函数？MS 帮助文档不鼓励使用旧的 C 函数（例如 strcat 等）。但是现在似乎有很多很多其他选项可用（例如_tcscat、_mbscat、wcscat 等）。我应该使用哪个，为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T23:01:00.517

这实际上取决于您要添加哪种类型的错误报告，以及该报告是否只是在 DLL 内部，或者它是否跨越 DLLL 边界进入调用 EXE。您可以在 DLL 的内部代码中使用您想要的任何字符串类/库，但对于导出的 DLL 函数和回调的参数，您应该继续使用以空字符结尾的字符指针，以便与多种编译器和语言兼容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T23:06:49.467

从 DLL 共享任何类型的模板类都是危险的。由于模板位于头文件中，因此您无法控制程序是否使用与您的 DLL 相同版本的头文件 - 不匹配会导致致命的错误。

至于 _tcscat、_mbscat 和 wcscat 之间的区别，您需要确定 API 的字符集。这些`_mb`函数使用大部分过时的多字节字符集，并且这些`wc`函数使用 wchar_t Unicode。`_t`根据您设置项目定义的方式，这些功能将解析为一个或另一个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T23:00:07.670

如果你小心，你总是可以使用`std::string`构造函数转换任何传入的内容，并使用`str.c_str()`.

# arduino - 使用 Arduino 进行液晶 LCD 编程？

> ID：10219239
> 
> 赞同：1
> 
> 时间：2012-04-18T22:52:50.603
> 
> 标签：arduino, i2c, lcd

我希望我的 LCD 显示“Voltage =（sensorValue）”，但现在我可以让程序在我转动电位器时识别该值的唯一方法是，如果我把它放在一个循环中。但是当我把它放在一个循环中时，整个屏幕会充满 1s、2s、3s、4s 或 5s，具体取决于电位器的设置位置。

如果我没有将它放在一个循环中，那么无论电位器的设置是什么，都会在屏幕上弹出，并且如果电位器转动则不会改变。

如何将循环的结果放在循环之外，以便我可以拥有“（Voltage = sensoreValue）”？

这是我的程序：

```
#include <Wire.h> 
#include <LiquidCrystal_I2C.h>

LiquidCrystal_I2C lcd(0x27,16,2);  

void setup()
{
    lcd.init();                      
    lcd.backlight();
    int sensorPin = A0;
    int sensorValue = 0;
    sensorValue = 0.004882812 * analogRead(sensorPin) + 1;
    lcd.print("Voltage=");
}

void loop()
{
    int sensorPin = A0;
    int sensorValue = 0;
    sensorValue = 0.004882812 * analogRead(sensorPin) + 1;
    lcd.print(sensorValue);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T16:02:09.870

这是我上周想出的。感谢所有提供意见的人！

```
#include <Wire.h> 
#include <LiquidCrystal_I2C.h>
LiquidCrystal_I2C lcd(0x27,16,2);  

void setup() {}

void loop()
{ lcd.init();                      
lcd.backlight();

int VoltsInput = A0;
int VoltsRange = 0;
int VoltsPercent = 0;

VoltsRange = (5.0/1023.0) * analogRead(VoltsInput);
VoltsPercent = (((5.0/1023.0) * analogRead(VoltsInput)) / 5) * 100;

lcd.print(VoltsRange);
lcd.print("V    ");

lcd.print(VoltsPercent);
lcd.print("%");} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T14:20:33.963

将其放入 loop() 并使用 delay() 函数，以便您的程序每隔几秒而不是每毫秒从 pot 中读取一次值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-21T13:17:07.187

听起来`print()`每次调用时都会清除先前数据的屏幕（尽管[此处](http://hmario.home.xs4all.nl/arduino/LiquidCrystal_I2C/)和[此处](http://www.arduino.cc/playground/Code/LCDAPI)可用的相关文档和库代码尚不清楚）。

如果是这种情况，您需要`Voltage=`在循环中打印字符串以及传感器值。尝试将您的代码更改为：

```
#include <Wire.h> 
#include <LiquidCrystal_I2C.h>

LiquidCrystal_I2C lcd(0x27,16,2);  
int sensorPin = A0;

void setup()
{
    lcd.init();                      
    lcd.backlight();
}

void loop()
{
    int sensorValue = 0.004882812 * analogRead(sensorPin) + 1;
    String display = "Voltage=";
    display += sensorValue;
    lcd.print(display);
} 
```

# javascript - 使用 jQuery 修改表格结构（合并单元格）

> ID：10219242
> 
> 赞同：2
> 
> 时间：2012-04-18T22:52:59.820
> 
> 标签：javascript, jquery, html-table

我有一张桌子

```
<table>
<tr><td>9:00</td><td id='ts9'>task1</td></tr>
<tr><td>10:00</td><td id='ts10'></td></tr>
<tr><td>11:00</td><td id='ts11'>task2</td></tr>
<tr><td>12:00</td><td id='ts12'>task3</td></tr>
</table> 
```

我需要将 id 为 10 和 11 的单元格合并为一个，因为该任务需要 2 小时。我正在使用 jQuery。

我想过：

```
$("#ts9").attr('colSpan', 2); 
```

但它不会工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T22:59:13.717

如果你必须使用 jQuery，那么这可行：

```
$('#ts10')
    .text($('#ts11').text())
    .attr('rowspan','2')
    .closest('tbody')
    .find('#ts11')
    .remove();​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/cBeTz/1/)。

或者，更简洁一些：

```
$('#ts10')
    .text($('#ts11').remove().text())
    .attr('rowspan','2');​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/cBeTz/2/)。

还有一种更...有用的方法，它将相邻行的单元格与 of`class`合并`two`：

```
$('tr td.two').each(
    function(){
        var that = $(this),
            next = that.parent().next().find('.two');
        if (next.length){
            that
                .text(next.remove().text())
                .attr('rowspan','2');
        }
    }); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/cBeTz/3/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-31T21:11:55.417

这对我有用。合并具有相同文本的单元格：逻辑：对于每个单元格，如果下一个单元格相同的文本，则删除下一个单元格，增加 colSpan。（注意“colSpan”，而不是“colspan” - 显然是浏览器兼容性问题）

```
$('#tblData tbody tr:first-child td').each(function(){
 var colSpan=1;
 while( $(this).text() == $(this).next().text() ){
  $(this).next().remove();
  colSpan++;
 }
$(this).attr('colSpan',colSpan);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T22:57:25.667

您实际上需要将**rowspan 添加**到 ds10 ，然后从此处的第二行**中删除**ts11 。将代码从 colspan 更改为 rowspan，添加以下内容

```
$("#ts11").remove(); 
```

你应该得到你需要的结果。但我个人并没有尝试通过 jquery 更改 rowspan/colspan 属性，我只是假设它运行良好。希望能帮助到你。

ps：更正的数字，认为你需要先合并 9 和 10 :)

# ruby - 与上帝定制“行动”？

> ID：10219248
> 
> 赞同：2
> 
> 时间：2012-04-18T22:53:18.650
> 
> 标签：ruby, unicorn, god

我们实际上在我们的开发环境和生产环境中都使用了 God，仅仅是因为它使管理 unicorn/resque 等变得更简单。

我刚刚将我们的默认独角兽配置缩减为 dev 中的单个工作人员，因为*大多数*情况下这已经足够了。但是，我添加了包装命令的 shell 脚本：

```
# Add an extra unicorn worker
kill -TTIN `cat /path/to/unicorn.pid`

# Remove a unicorn worker
kill -TTOU `cat /path/to/unicorn.pid` 
```

不是用上帝启动/停止/重新启动独角兽，而是通过一个特别的 shell 脚本添加新的工人，有没有办法让上帝支持几个自定义命令，比如：

```
god incr unicorn

god decr unicorn 
```

我查看了文档并没有发现任何东西，但感觉就像它可能“非正式地”能够做到的事情。

# java - 什么可能导致此异常？

> ID：10219249
> 
> 赞同：2
> 
> 时间：2012-04-18T22:53:20.973
> 
> 标签：java, android, exception, arraylist

我偶尔会遇到一个非常奇怪的异常：

> 04-18 18:08:08.121：E/AndroidRuntime(3031)：未捕获的处理程序：线程主因未捕获的异常而退出
> 04-18 18:08:08.141：E/AndroidRuntime(3031)：java.lang.ArrayIndexOutOfBoundsException
> 04-18 18:08:08.141: E/AndroidRuntime(3031): at java.util.ArrayList.addAll(ArrayList.java:257)
> 04-18 18:08:08.141: E/AndroidRuntime(3031): at com.zigzagworld.text .formatter.FormatManager.formatIfNeeded(FormatManager.java:185)
> 等

这发生在 1.6 模拟器上。我的代码中调用的行`addAll`是：

```
mTasksAbove.addAll(schedule.above); 
```

我唯一能想象的是某种并发访问`mTasksAbove`. 但是，我一直非常小心地确保所有访问都在同一个对象上同步。我唯一想到的另一件事是如果`schedule.above`在执行期间被修改`addAll`，但我相信这会生成一个`ConcurrentModificationException`（另外，我认为我的代码不会这样做）。有谁知道我应该寻找的其他东西？

**编辑**

根据 Raykud 的回答，我做了一点挖掘并找到了确切的错误。在 Android 1.6 源代码中，该`addAll`方法调用了一个内部方法，`growAtEnd`这是有缺陷的。这是源本身：

```
private void growAtEnd(int required) {
    int size = size();
    if (firstIndex >= required - (array.length - lastIndex)) {
        int newLast = lastIndex - firstIndex;
        if (size > 0) {
            System.arraycopy(array, firstIndex, array, 0, size);
            int start = newLast < firstIndex ? firstIndex : newLast;
            Arrays.fill(array, start, array.length, null);
        }
        firstIndex = 0;
        lastIndex = newLast;
    } else {
        int increment = size / 2;
        if (required > increment) {
            increment = required;
        }
        if (increment < 12) {
            increment = 12;
        }
        E[] newArray = newElementArray(size + increment);
        if (size > 0) {
            System.arraycopy(array, firstIndex, newArray, 0, size);
            /********************************************************\
            * BUG! The next 2 lines of code should be outside the if *
            \********************************************************/
            firstIndex = 0;
            lastIndex = size;
        }
        array = newArray;
    }
} 
```

当列表先前已填充然后清空时，该错误抬起了丑陋的头，离开`size == 0`并且`firstIndex == lastIndex > 0`您尝试添加足够大的集合以使其不适合`lastIndex`当前数组大小。

从 2.2 开始，当该`addAll`方法被重写并`growAtEnd`从类中消失时，该错误就消失了。

谢谢雷库德的指点！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T23:17:42.083

从 1.5 开始，arraylist 中的方法 addAll 有问题，它应该在未来的发布中得到修复，但是我不确定是哪一个。要解决此问题，您可以为您的集合创建一个[迭代器](http://developer.android.com/reference/java/util/Collection.html#iterator%28%29)并逐个添加元素。这里有一个小代码可以提供帮助：

```
Iterator<MyTypeofObjectToAdd> e = myArrayListToCopyFrom.iterator();
    while (e.hasNext()) {
      arrayListToAdd(e.next());
    } 
```

并且[IndexOutOfBounds](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/IndexOutOfBoundsException.html)异常是因为您试图从没有任何内容的位置检索项目而引起的。

# sql - 在 sql 中重新排序 cte 之后的列

> ID：10219250
> 
> 赞同：0
> 
> 时间：2012-04-18T22:53:21.613
> 
> 标签：sql, common-table-expression

我需要此结果保持不变，但我希望它将列重新排序为特定顺序。我想要的订单是逾期到期、星期一到期、明天到期、今天到期、逾期

有人能帮忙吗

```
with cte AS (SELECT cl.Name,

SUM(CASE WHEN dbo.TruncateDate(CURRENT_TIMESTAMP) = dbo.TruncateDate(oi.RequiredByDate) THEN 1 Else 0 END) as DueToday
,SUM(CASE WHEN CURRENT_TIMESTAMP > oi.RequiredByDate THEN 1 ELSE 0 END) as PastDue
,SUM(CASE WHEN DATEADD(dd, DATEDIFF(dd, 0, oi.RequiredByDate), 0) = dateadd(day, datediff(day, '19000101',CURRENT_TIMESTAMP),'19000102') then 1 ELSE 0 END) as DueTomorrow
,SUM(CASE WHEN DateDiff(day, getdate(), RequiredByDate) BETWEEN 2 and 7 AND DateName(weekday, RequiredByDate) = 'Monday' Then 1 ELSE 0 END) as DueMonday
,SUM(CASE WHEN dbo.TruncateDate(CURRENT_TIMESTAMP) <= dbo.TruncateDate(oi.RequiredByDate) THEN 1 ELSE 0 END) as DueBeyond

FROM OrderItems oi
JOIN Orders o ON o.OrderID = oi.OrderID
JOIN Counties c ON c.FIPS = o.FIPS
JOIN Clients cl ON cl.ClientID = o.ClientID
JOIN Milestones m ON m.MilestoneID = oi.LastMilestoneID
JOIN Products p ON p.ProductID = oi.ProductID
JOIN Vendors v ON v.VendorID = oi.VendorID
LEFT JOIN ClientBranches clb ON clb.ClientID = o.ClientID
WHERE QueueID > 0 AND cl.Name NOT LIKE 'TES%'
AND cl.NAME LIKE 'HLC%'
GROUP BY cl.Name 

)

Select * FROM cte 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:57:07.930

替换`Select * FROM cte`为

```
Select DueBeyond, DueMonday, DueTomorrow, DueToday, PastDue
 from cte 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T22:57:05.853

在您的选择中：

`SELECT DueBeyond, DueMonday, DueTomorrow, DueToday, PastDue FROM cte`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T22:56:44.363

我改变了`SELECT`条款的顺序。

```
with cte AS (SELECT cl.Name

,SUM(CASE WHEN dbo.TruncateDate(CURRENT_TIMESTAMP) <= dbo.TruncateDate(oi.RequiredByDate) THEN 1 ELSE 0 END)
as DueBeyond
,SUM(CASE WHEN DateDiff(day, getdate(), RequiredByDate) BETWEEN 2 and 7 AND DateName(weekday, RequiredByDate) = 'Monday' Then 1 ELSE 0 END) 
as DueMonday
,SUM(CASE WHEN DATEADD(dd, DATEDIFF(dd, 0, oi.RequiredByDate), 0) = dateadd(day, datediff(day, '19000101',CURRENT_TIMESTAMP),'19000102') then 1 ELSE 0 END)
as DueTomorrow
,SUM(CASE WHEN dbo.TruncateDate(CURRENT_TIMESTAMP) = dbo.TruncateDate(oi.RequiredByDate) THEN 1 Else 0 END) 
as DueToday
,SUM(CASE WHEN CURRENT_TIMESTAMP > oi.RequiredByDate THEN 1 ELSE 0 END) 
as PastDue

FROM OrderItems oi
JOIN Orders o ON o.OrderID = oi.OrderID
JOIN Counties c ON c.FIPS = o.FIPS
JOIN Clients cl ON cl.ClientID = o.ClientID
JOIN Milestones m ON m.MilestoneID = oi.LastMilestoneID
JOIN Products p ON p.ProductID = oi.ProductID
JOIN Vendors v ON v.VendorID = oi.VendorID
LEFT JOIN ClientBranches clb ON clb.ClientID = o.ClientID
WHERE QueueID > 0 AND cl.Name NOT LIKE 'TES%'
AND cl.NAME LIKE 'HLC%'
GROUP BY cl.Name 

)

Select * FROM cte 
```

# java - MyBatis 枚举使用

> ID：10219253
> 
> 赞同：17
> 
> 时间：2012-04-18T22:53:26.643
> 
> 标签：java, mysql, enums, mybatis

我知道以前有人问过这个问题，但我无法根据我目前找到的信息实施解决方案。所以也许有人可以向我解释。

我有一个表“状态”。它有两列：id 和 name。id是一个PK。

我不想使用 POJO 状态，而是使用枚举。我创建了这样一个枚举，如下所示：

```
public enum Status {
    NEW(1), READY(2), CLOSED(3);

    private int id;

    public void setId(int id) {
        this.id = id;
    }

    public int getId() {
        return this.id;
    }

    Status(int id) {
        this.id = id;
    }
} 
```

这是我的映射器

```
 <select id="getStatusByName" resultType="Status" parameterType="String">       
        SELECT  ls.id, ls.name
        FROM status AS ls
        WHERE ls.name = #{name}
    </select> 
```

但由于某种原因，当我尝试检索枚举时，有些东西会中断，但不会引发异常。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-08T00:53:03.370

我从几个角度研究了这个问题，这是我的发现。警告：我使用 MyBatis-3.1.1 进行了所有这些调查，所以在早期版本中可能会有不同的表现。

首先，MyBatis 有一个内置的`EnumTypeHandler`. 默认情况下，只要将 Java 枚举指定为 resultType 或 parameterType，就会处理该类型。对于查询，当尝试将数据库记录转换为 Java 枚举时，EnumTypeHandler 只接受一个参数并尝试查找与该值对应的 Java 枚举值。

一个例子将更好地说明。假设您上面的查询返回`2`并且`"Ready"`当我传入“Ready”作为参数时。在这种情况下，我收到错误消息`No enum constant com.foo.Status.2`。如果我将您的 SELECT 语句的顺序颠倒为

```
SELECT ls.name, ls.id 
```

那么错误信息是`No enum constant com.foo.Status.Ready`。我假设你可以推断出 MyBatis 在做什么。请注意，EnumTypeHandler 忽略了从查询返回的第二个值。

将您的查询更改为

```
SELECT UPPER(ls.name) 
```

使其工作：返回 Status.READY 枚举。

所以接下来我尝试为 Status 枚举定义我自己的 TypeHandler。不幸的是，与 default 一样`EnumTypeHandler`，我只能获取其中一个值（id 或 name）来引用正确的 Enum，而不是两者。因此，如果数据库 id 与您在上面硬编码的值不匹配，那么您将不匹配。如果您确保数据库 id 始终与您在枚举中指定的 id 匹配，那么您只需要数据库中的名称（转换为大写）。

然后我想我会变得聪明并实现一个 MyBatis ObjectFactory，同时获取 int id 和 String 名称，并确保它们在我传回的 Java 枚举中匹配，但这不起作用，因为 MyBatis 不调用 ObjectFactory Java 枚举类型（至少我无法让它工作）。

所以我的结论是，MyBatis 中的 Java 枚举很容易，只要您只需要将数据库中的名称与枚举常量名称匹配——要么使用内置的 EnumTypeHandler，要么在执行 UPPER(name) 时定义自己的SQL 不足以匹配 Java 枚举名称。在许多情况下，这就足够了，因为枚举值可能只是对列的检查约束，并且它只有单个值，也没有 id。如果您还需要匹配 int id 和名称，则在设置 Java 枚举和/或数据库条目时手动匹配 ID。

最后，如果您想查看一个工作示例，请在此处查看我的 MyBatis koans 的 koan 23：[https](https://github.com/midpeter444/mybatis-koans) ://github.com/midpeter444/mybatis-koans 。如果您只想查看我的解决方案，请查看已完成的 koans/koan23 目录。我还有一个通过 Java 枚举将记录插入数据库的示例。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-09-03T16:20:33.907

您可以使用自定义类型处理程序将结果直接转换为 ENUM，这样您就不需要将数据库中的所有值作为大写 ENUM 名称。

这就是您的状态枚举自定义处理程序的样子

```
public class StatusTypeHandler implements TypeHandler<Status> {

public Status getResult(ResultSet rs, String param) throws SQLException {
    return Status.getEnum(rs.getInt(param));
}

public Status getResult(CallableStatement cs, int col) throws SQLException {
    return Status.getEnum(cs.getInt(col));
}

public void setParameter(PreparedStatement ps, int paramInt, Status paramType, JdbcType jdbctype)
        throws SQLException {
    ps.setInt(paramInt, paramType.getId());
}
} 
```

通过添加此代码，在 mybatis-config.xml 中定义您的 TypeHandler 以默认处理状态。

```
 <typeHandlers> 
            <typeHandler javaType='Status' handler='StatusTypeHandler' /> 
    </typeHandlers> 
```

现在让我们考虑一个示例，您的 Dao 中有以下两个函数，

```
Status getStatusById(int code);
Status getStatusByName(String name); 
```

你的映射器看起来像

```
<select id="getStatusById" resultType="Status" parameterType="int">       
    SELECT  ls.id
    FROM status AS ls
    WHERE ls.id = #{id}
</select>

<select id="getStatusByName" resultType="Status" parameterType="String">       
    SELECT  ls.id
    FROM status AS ls
    WHERE ls.name = #{name}
</select> 
```

现在由于两个映射器的 resultType 都是 Status，myBatis 将使用 CustomTypeHandler 来处理这种类型，即 StatusTypeHandler 而不是它默认用于处理枚举的 EnumTypeHandler，因此不需要在数据库中维护正确的 Enum 名称。

# salesforce - SAML 重定向到特定 IDP（Salesforce 与 Arcot + PING + Siteminder）

> ID：10219254
> 
> 赞同：1
> 
> 时间：2012-04-18T22:53:38.480
> 
> 标签：salesforce, saml-2.0, siteminder, pingfederate

我们需要支持以下身份验证流程

*   用户 1 使用 Salesforce 凭据登录 Salesforce

*   用户 2 使用 Arcot +Ping + Siteminder 凭据登录 Salesforce

*   用户 2 使用 Arcot + Ping + Siteminder 凭据登录自定义应用程序

由于上述所有身份验证方法都是 SAML，因此我需要找到一种方法来解决家庭领域发现问题，这是身份验证流程的一个不寻常的“网格”。

**问题**

我应该如何设置 IDP 和 RP 来处理这种情况？

家庭领域发现如何运作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T23:14:36.273

我将假设您的组织中有 My Domains 设置和 SAML 2.0 设置，并且您正在尝试将未经身份验证的页面请求路由到其适当的身份验证源。

由于您无法在原始未经身份验证的请求中区分用户 1 和 2，因此您需要一个要求用户输入的插页式页面，即“让我使用用户名/密码登录”或“我使用单点登录”。在您的 SAML 设置的“身份提供商登录 URL”部分中指向此页面。如果用户选择用户名/密码，将用户重定向到 My Domains 登录页面，他们将使用 un/pw 登录。如果他们选择 SSO，则将它们发送到您的 IDP 并传播 SAML 请求和中继状态以启动 SAML 协议。

同样，对自定义应用程序的未经身份验证的请求需要重定向到 IDP，以便它们启动 SAML。自定义应用程序是在 salesforce 内部（作为不同的选项卡集），还是在 salesforce 外部托管？如果自定义应用程序与 salesforce 分离，您需要设置身份提供程序，使其具有 2 个 RP：一个用于 salesforce，一个用于此自定义应用程序。如果定制应用程序在 salesforce 中，用户将如何表达访问 salesforce 与定制应用程序的意图？

# php - 正则表达式返回真，但一本书的作者说它不应该

> ID：10219262
> 
> 赞同：3
> 
> 时间：2012-04-18T22:54:11.073
> 
> 标签：php, regex

阅读有关 Regexp(TuxRadar) 的 PHP 在线资源。根据作者的说法，以下不应将“aaa1”与模式匹配，因此返回 false(0)，但我得到 true(1)。

```
<?php

$str = "aaa1";
print preg_match("/[a-z]+[0-9]?[a-z]{1}/", $str);

?> 
```

为什么？

[常用表达](http://www.tuxradar.com/practicalphp/4/8/3)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T22:56:45.433

你确定那里不应该有尾随`$`吗？没有它，返回 true 很有意义 - 第一个`[a-z]`块匹配前 2 个`a`字符，不`[0-9]`匹配任何内容，最后一个`[a-z]`匹配 3rd `a`。尾随`1`被忽略。

查看该书的链接，那里似乎确实存在错误：

> 必须以小写字母结尾

仅当正则表达式使用 . 锚定到字符串的末尾时才适用`$`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T22:56:45.463

它匹配是因为`[0-9]?`匹配一个数字**零**次或一次。

```
<?php
$str = "aaa1";
print preg_match("/[a-z]+[0-9]+[a-z]{1}/", $str);
?> 
```

不会导致匹配。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T22:59:23.653

让我们分解正则表达式

1.  [az]+ 表示一个或多个字母，表示匹配 a、aa 或 aaa
2.  [0-9]？表示可选 - 所以可以匹配一个数字
3.  [az] 表示匹配一个字母，可能是 a

因此，由于 [0-9] 是可选的，1 将匹配 aa，2 将不匹配任何内容，3 将匹配 a

# objective-c - IOS 自定义单元格，其标签在单元格重用时显示错误文本

> ID：10219268
> 
> 赞同：0
> 
> 时间：2012-04-18T22:54:40.427
> 
> 标签：objective-c, ios

我一直试图弄清楚这一点。我在自己的 xib 文件中创建了一个自定义单元格。在我的视图控制器中，我设置了一个带有部分的表视图控制器。被拉入表视图的数据是基于我拥有的一些核心数据的获取请求控制器。我在 cellForRowAtIndexPath 函数中设置了自定义单元格。我正在为该函数中的每个单元格创建一个标签，并使用来自托管对象的一些数据填充标签。当我第一次运行时，一切似乎都很好。但是，当我尝试上下滚动并重新使用新单元格时，标签中的数据被放置在错误的单元格中。我已经看到并听说这与细胞的重复使用有关。但是，还没有看到很多关于纠正这个问题的例子。下面是我在 cellForRowAtIndexPath 函数中的一些代码。让我知道是否需要任何其他输入。谢谢你的帮助。

```
-(UITableViewCell *)tableView:(UITableView *)aTableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    UITableViewCell *cell = [aTableView dequeueReusableCellWithIdentifier:@"CustomCell"];

    /* do this to get unique value per cell due to sections. */
    NSInteger indexForCell = indexPath.section * 1000 + indexPath.row + 1;

    NSManagedObject *managedObject = [fetchedResultsController objectAtIndexPath:indexPath];

    NSString *lastSession = nil;
    UILabel *lastSessionLabel = nil;
    if(cell == nil) {

        lastSession = [managedObject valueForKey:@"last_session"];

        [self.tableView registerNib:[UINib nibWithNibName:@"CustomCell" 
                                                   bundle:[NSBundle mainBundle]] 
             forCellReuseIdentifier:@"CustomCell"];

        self.tableView.backgroundColor = [UIColor clearColor];
        cell = [aTableView dequeueReusableCellWithIdentifier:@"CustomCell"];

        lastSessionLabel = [[UILabel alloc]initWithFrame:CGRectMake(410,55, 89, 35)];
        lastSessionLabel.textAlignment = UITextAlignmentLeft;
        lastSessionLabel.tag = indexForCell;
        lastSessionLabel.font = [UIFont systemFontOfSize:17];
        lastSessionLabel.highlighted = NO;
        lastSessionLabel.backgroundColor = [UIColor clearColor];

        cell.contentView.tag = indexForCell;
        [cell.contentView addSubview:lastSessionLabel];
    } else {
        lastSessionLabel = (UILabel *)[cell viewWithTag:indexForCell];
    }

        if (lastSession && lastSession.length) {        
            lastSessionLabel.text = lastSession;
        } 

    cell.textLabel.text = [NSString stringWithFormat:@"%@%@%@%@", @"Dr. ",
                           [managedObject valueForKey:@"first_name"], 
                           @" " , 
                           [managedObject valueForKey:@"last_name"]];

    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    cell.editingAccessoryType = UITableViewCellAccessoryNone;

    return cell;
} 
```

** 修改后的代码 **

以下是对代码的更改：在 viewDidLoad 中如下：

```
 - (void)viewDidLoad
{
    [super viewDidLoad];
   [self.tableView registerNib:[UINib nibWithNibName:@"CustomCell" 
                                           bundle:[NSBundle mainBundle]] 
         forCellReuseIdentifier:@"CustomCell"];

       self.tableView.backgroundColor = [UIColor clearColor];
  }     

 in -(UITableViewCell *)tableView:(UITableView *)aTableView cellForRowAtIndexPath:  (NSIndexPath *)indexPath {
  UITableViewCell *cell = [aTableView dequeueReusableCellWithIdentifier:@"CustomCell"];
    NSInteger indexForCell = indexPath.section * 1000 + indexPath.row + 1;
    NSLog(@"index for cell: %d",indexForCell);

    NSManagedObject *managedObject = [fetchedResultsController objectAtIndexPath:indexPath];

    NSString *lastSession = [managedObject valueForKey:@"last_session"];
 UILabel *lastSessionLabel = nil;
    if(cell == nil) {
        NSLog(@"Cell is nil! %@", [managedObject valueForKey:@"first_name"]);

         cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"CustomCell"];

        self.tableView.backgroundColor = [UIColor clearColor];
   }    
        lastSessionLabel = [[UILabel alloc]initWithFrame:CGRectMake(410,55, 89, 35)];
        lastSessionLabel.textAlignment = UITextAlignmentLeft;
        lastSessionLabel.tag = indexForCell;
        lastSessionLabel.font = [UIFont systemFontOfSize:17];
        lastSessionLabel.highlighted = NO;
        lastSessionLabel.backgroundColor = [UIColor clearColor];

        [cell.contentView addSubview:lastSessionLabel];
        /* Appropriate verbiage for nil last session. */
       if (lastSession && lastSession.length) {        
            lastSessionLabel.text = lastSession;
        }   
 return cell;  
}

 I am still having issues again with the label cell text changing when I scroll for different cells. I read some where about maybe having to use the prepareForReuse function for this. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T23:03:23.880

您仅`lastSession`在创建新单元格时才获取。尝试将此行放在`if(cell == nil)`语句之前。

```
lastSession = [managedObject valueForKey:@"last_session"]; 
```

即：

```
NSString *lastSession = [managedObject valueForKey:@"last_session"]; 
```

而不是这个：

```
NSString *lastSession = nil; 
```

**更新**

您还为两个视图设置了相同的标签：

```
lastSessionLabel.tag = indexForCell;
...
cell.contentView.tag = indexForCell; 
```

根据您的代码示例，您应该只使用第一行，即为`lastSessionLabel`

**第二次更新**

您还应该只`registerNib:`在视图生命周期中调用一次，例如 in `viewDidLoad`，而不是每次需要新单元格时调用。此外，您应该创建一个新单元格`cell == nil`而不是使用`dequeueReusableCellWithIdentifier:`. 例如

```
cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"CustomCell"]; 
```

# c# - 正则表达式匹配，级联标签

> ID：10219274
> 
> 赞同：0
> 
> 时间：2012-04-18T22:55:20.753
> 
> 标签：c#, regex, windows-phone-7

嗨，我正在尝试从下面的标签中获取结果，我需要实现的是在标签中获得第一个匹配，然后是第五个匹配，然后是第九个匹配，所以是第一个，然后是每第五个匹配。所以我的结果是，注意我意识到这不是解析 HTML 的最佳方式，但我真的只需要它

我正在使用的正则表达式是

```
<td class="stat">(.*?)<\/td> 
```

我正在使用的代码是

```
private static ObservableCollection<Top> top = new ObservableCollection<Top>();

public void twit_topusers_DownloadStringCompleted(Object sender, DownloadStringCompletedEventArgs e)
    {
            string str;
            // Size the control to fill the form with a margin
            str = (string)e.Result;

            Regex r = new Regex("<td class=\"stat\">(.*?)</td>");
            // Find a single match in the string.
            Match m = r.Match(str);

            while (m.Success)
            {

                testMatch = "";

                //
                testMatch += System.Text.RegularExpressions.Regex.Unescape(m.Groups[0].ToString()).Trim();

                top.Add(new Top(testMatch));
                m = m.NextMatch();

            }

            listBox.ItemsSource = top;

    }

    } 
```

标签是

```
<td class="stat">14307149</td>//FIRST
<td class="stat">679761</td>
<td class="stat">3508</td>
<td class="stat">62 months ago</td>
<td class="stat">1430700</td>//FIFTH
<td class="stat">679761</td>
<td class="stat">3508</td>
<td class="stat">72 months ago</td>
<td class="stat">1430600</td>//NINTH
<td class="stat">679761</td>
<td class="stat">3508</td>
<td class="stat">82 months ago</td> 
```

但我得到的结果是

> 匹配 1 14307149
> 
> 比赛 2 679761
> 
> 第 3 场比赛 3508
> 
> 第 4 场比赛 62 个月前
> 
> 匹配 5 1430700
> 
> 比赛 6 679761
> 
> 比赛 7 3508
> 
> 第 8 场比赛 72 个月前
> 
> 比赛 9 14307149
> 
> 比赛 10 679761
> 
> 比赛 11 3508
> 
> 第 12 场比赛 62 个月前

我需要的结果是

> 匹配 1 14307149
> 
> 匹配 2 1430700
> 
> 匹配 3 1430600

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:06:43.973

看起来您根本没有检查行号。如果您只是添加一个计数器，然后检查其 4 的 mod 是否为零，您会很好。

```
counter = 0;
while (m.Success)
{
        if( counter % 4 == 0 )
        {
            testMatch = "";

            //
            testMatch += System.Text.RegularExpressions.Regex.Unescape(m.Groups[0].ToString()).Trim();

            top.Add(new Top(testMatch));
            m = m.NextMatch();

        }
        counter++;
} 
```

注意：我不是 WP7 开发人员，因此根据 WP7 编码系统的工作方式，此代码可能会略有偏差。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:02:25.977

将其更改如下以仅匹配数字：

```
 <td class="stat">(\d+)<\/td> 
```

如果我理解正确，您必须先拆分字符串`months ago`，然后通过上述正则表达式匹配拆分操作的结果。

# windows - Powershell 通配符用于编写 powershell 脚本

> ID：10219276
> 
> 赞同：0
> 
> 时间：2012-04-18T22:55:24.970
> 
> 标签：windows, powershell, scripting, wildcard

.ps1（powershell 脚本）文件中的以下表达式是什么意思？

```
$row=".+\\(.+\.exe)"; 
```

据我了解，“\”用于转义并使进行的字符按字面意思理解。但是我对“。”的用法感到困惑。这里。有人可以帮我弄这个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T22:59:58.120

这看起来像是匹配文件路径的正则表达式的一部分。分解这个正则表达式：

```
.+        matches one or more characters (of anything)
\\        matches the '\' character (needs the \ to escape the \ character)
(    
   .+     matches one or more characters (of anything)
   \.     matches the '.' character (needs the \ to escape the . character)
   exe    matches exe
) 
```

这 。是一个特殊字符，表示匹配任何字符。

# php - PHP 按顺序显示错误消息并重新显示正确的字段

> ID：10219278
> 
> 赞同：2
> 
> 时间：2012-04-18T22:55:47.930
> 
> 标签：php, forms

我有一个电子邮件表单，它检查三个字段：姓名、有效电子邮件和评论。但是它现在的设置方式，由于名称和评论在一个函数中，即使电子邮件无效，它也会首先检查名称和评论，我如何重新编写它以便它按顺序检查字段。另外，我想重新显示没有错误的字段，这样用户就不必再次输入。请帮忙。谢谢

```
<?php
$myemail = "comments@myemail.com";
$yourname = check_input($_POST['yourname'], "Enter your name!");
$email = check_input($_POST['email']);
$phone = check_input($_POST['phone']);
$subject = check_input($_POST['subject']);
$comments = check_input($_POST['comments'], "Write your comments!");

if (!preg_match("/([\w\-]+\@[\w\-]+\.[\w\-]+)/", $email))
  {
    show_error("Enter a valid E-mail address!");
  }

exit();

function check_input($data, $problem='')
 {
$data = trim($data);
$data = stripslashes($data);
$data = htmlspecialchars($data);
if ($problem && strlen($data) == 0)
{
    show_error($problem);
}
return $data;
}

function show_error($myError)
{
?>
<!doctype html>
<html>
<body>
<form action="myform.php" method="post">
 <p style="color: red;"><b>Please correct the following error:</b><br />
 <?php echo $myError; ?></p>
 <p>Name: <input type="text" name="yourname" /></P>
 <P>Email: <input type="text" name="email" /></p>
 <P>Phone: <input type="text" name="phone" /></p><br />
 <P>Subject: <input type="text" style="width:75%;" name="subject" /></p>
 <p>Comments:<br />
 <textarea name="comments" rows="10" cols="50" style="width: 100%;"></textarea></p>
 <p><input type="submit" value="Submit"></p>
</form>
</body>
</html>
<?php
exit();
}
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T23:32:26.960

首先，我建议您一次验证所有字段，并在表单上显示所有适当的错误消息。主要原因是如果他们必须一次提交你的表单，因为他们必须一次解决一个错误，这可能是糟糕的用户体验。我宁愿一次尝试更正我的电子邮件地址、密码、评论和选择，而不是一次修复一个，只是为了揭示下一个错误是什么。

也就是说，这里有一些关于验证表单的提示。这通常是我处理表单做你想做的事情的方式。这假设您的表单 HTML 和表单处理器 (PHP) 在同一个文件中（这就是您现在所拥有的）。您可以将两者分开，但这样做的方法可能会有所不同。

*   拥有一个输出表单的函数或代码块，并且知道您的错误消息并可以访问之前的表单输入（如果有）。通常，这可以留在函数之外，并且可以是 PHP 脚本中的最后一个代码块。
*   为错误消息设置一个数组（例如`$errors = array()`）。当此数组为空时，您知道提交没有错误
*   在表单输出之前，检查表单是否在脚本顶部附近提交。
*   如果表单已提交，则一次验证每个字段，如果某个字段包含错误，则将错误消息添加到`$errors`数组中（例如`$errors['password'] = 'Passwords must be at least 8 characters long';`）
*   要使用以前的值重新填充表单输入，您必须将输入的值存储在某处（您可以只使用`$_POST`数组，也可以清理并将`$_POST`值分配给单个变量或数组。
*   完成所有处理后，您可以检查是否有任何错误，以决定此时是否可以处理表单，或者需要用户的新输入。
*   为此，我通常会做类似的事情`if (sizeof($errors) > 0) { // show messages } else { // process form }`
*   如果您要重新显示表单，您只需`value=""`为每个表单元素添加一个属性并回显用户提交的值。 **使用 htmlspecialchars() 或类似函数转义输出非常重要**

有了这些东西，这里是你的表单的一些修改来做到这一点：

```
<?php
$myemail = "comments@myemail.com";
$errors  = array();
$values  = array();
$errmsg  = '';

if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    foreach($_POST as $key => $value) {
        $values[$key] = trim(stripslashes($value)); // basic input filter
    }

    if (check_input($values['yourname']) == false) { 
        $errors['yourname'] = 'Enter your name!';
    }

    if (check_input($values['email']) == false) {
        $errors['email'] = 'Please enter your email address.';
    } else if (!preg_match('/([\w\-]+\@[\w\-]+\.[\w\-]+)/', $values['email'])) {
        $errors['email'] = 'Invalid email address format.';
    }

    if (check_input($values['comments']) == false) {
        $errors['comments'] = 'Write your comments!';
    }

    if (sizeof($errors) == 0) {
        // you can process your for here and redirect or show a success message
        $values = array(); // empty values array
        echo "Form was OK!  Good to process...<br />";
    } else {
        // one or more errors
        foreach($errors as $error) {
            $errmsg .= $error . '<br />';
        }
    }
}

function check_input($input) {
    if (strlen($input) == 0) {
        return false;
    } else {
        // TODO: other checks?

        return true;
    }
}
?>
<!doctype html>
<html>
<body>
<form action="<?php echo $_SERVER['PHP_SELF'] ?>" method="post">
 <?php if ($errmsg != ''): ?>
 <p style="color: red;"><b>Please correct the following errors:</b><br />
 <?php echo $errmsg; ?>
 </p>
 <?php endif; ?>

 <p>Name: <input type="text" name="yourname" value="<?php echo htmlspecialchars(@$values['yourname']) ?>" /></P>
 <P>Email: <input type="text" name="email" value="<?php echo htmlspecialchars(@$values['email']) ?>" /></p>
 <P>Phone: <input type="text" name="phone" value="<?php echo htmlspecialchars(@$values['phone']) ?>"/></p><br />
 <P>Subject: <input type="text" style="width:75%;" name="subject" value="<?php echo htmlspecialchars(@$values['subject']) ?>" /></p>
 <p>Comments:<br />
 <textarea name="comments" rows="10" cols="50" style="width: 100%;"><?php echo htmlspecialchars(@$values['comments']) ?></textarea></p>
 <p><input type="submit" value="Submit"></p>
</form>
</body>
</html> 
```

我有一个更高级的例子，你可以[在这里](https://github.com/dapphp/securimage/blob/master/example_form.php)看到它也可以给你一些指导。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:18:22.513

使用这种脚本结构：

```
<?php
$errors = array();

if (isset($_POST['send'])) {
    // check data validity
    if (!mailValid($_POST['email']))
        $errors[] = 'Mail is not valid';
    ...

    // send data by email
    if (!$errors) {
        // send mail and redirect
    }
}
?>
<html>
    ...
    <?php
    if ($errors) {
        // display errors
        foreach ($errors as $error) {
            echo "$error<br />";
        }
    }
    ?>
    <form ...>
        ...
        Email: <input type="text" name="email" value="<?php echo isset($_POST['email']) ? htmlspecialchars($_POST['email']) : '' ?>" />
        ...
    </form>
    ...
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T23:27:23.207

最简单的选择是使用[表单验证库](https://stackoverflow.com/q/737385/90527)。例如， PHP 的[过滤器](http://php.net/filter)扩展为某些类型提供验证和清理，尽管它不是一个完整的解决方案。

如果您坚持自己实现它，那么您必须考虑的一个问题是什么才是顺序：表单中元素的顺序或用户输入的顺序`$_POST`。在大多数浏览器上，这些应该是相同的，但没有强制执行此的标准。如果您想脱离表单顺序，您需要在一个地方定义表单结构，并使用该信息来执行诸如生成或验证表单之类的事情（[不重复自己](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)(DRY) 原则的结果） ）。迭代适当的结构会给你你想要的顺序：循环表单给你表单顺序，而循环`$_POST`给你用户输入顺序。

看起来您想要的不仅仅是验证数据；您还想准备使用它，这个过程称为“消毒”。

在消毒方面，定义不同种类的消毒剂，而不是单一`check_input`功能。特定的消毒剂可以是函数，也可以是带有[`__invoke`](http://www.php.net/manual/en/language.oop5.magic.php#object.invoke)方法的对象。创建表单字段到 sanitizer 的映射（例如，输入名称数组到 sanitizer 回调）。映射中元素的顺序决定了清理的顺序；如果您使用单个结构来定义表单信息，则显示顺序和清理顺序将因此相同。

这是一个非常广泛的大纲：

```
# $fields could be form structure or user input
foreach ($fields as $name => $data) {
    # sanitize dispatches to the appropriate sanitizer for the given field name
    $form->sanitize($name, $data);
    # or:
    //sanitize($name, $data);
    # or however you choose to structure your sanitization dispatch mechanism
} 
```

至于将输入的值设置为用户提供的数据，只需在输出元素时输出元素值即可。与所有用户输入（实际上，所有格式化输出）一样，在输出数据时正确转义数据。对于 HTML 属性，这意味着使用 (eg) [`htmlspecialchars`](http://php.net/htmlspecialchars)。请注意，您应该只转义传出数据。这意味着您的清理功能不应调用`htmlspecialchars`.

您可以通过将每个错误放在相应的输入旁边、向元素添加“错误”类并设置“错误”类的样式以使其突出来提高可用性。[`<label>`](http://www.w3.org/wiki/HTML/Elements/label)通过在标签文本周围环绕元素来提高可访问性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T23:58:07.190

你总是可以这样做，使用[filter_var](http://php.net/manual/en/function.filter-var.php)和[in_array](http://php.net/manual/en/function.in-array.php)检查：

```
<?php
$myemail = "comments@myemail.com";

//Pre made errors array
$errors=array('name'=>'Enter Your name',
              'email'=>'Please enter valid email',
              'phone'=>'Please enter valid phone number',
              'subject'=>'Please enter valid subject, more then 10 chars',
              'comment'=>'Please enter valid comment, more then 10 chars');

//Allowed post params and its validation type
$types = array('name'=>'string',
               'email'=>'email',
               'phone'=>'phone',
               'subject'=>'string',
               'comment'=>'string');

//A simple validation function using filter_var
function validate($value,$type){
    switch ($type){
        case "email":
            return ((filter_var($value, FILTER_VALIDATE_EMAIL))?true:false);
            break;
        case "phone":
            return ((preg_match("/^[0-9]{3}-[0-9]{4}-[0-9]{4}$/", $value))?true:false);
            break;
        case "string":
            return ((strlen($value) >=10 )?true:false);
            break;

        default:
            return false;
            break;
    }
}

//If forms been posted
if(!empty($_POST) && $_SERVER['REQUEST_METHOD'] == 'POST'){
    //Assign true, if all is good then this will still be true
    $cont=true;
    $error=array();
    foreach($_POST as $key=>$value){
      //if key is in $types array
      if(in_array($key,$types)){
        //If validation true
        if(validate($value, $types[$key])==true){
            $$key=filter_var($value, FILTER_SANITIZE_STRING);
        }else{
            //Validation failed assign error and swithc cont to false
            $error[$key]=$errors[$key];
            $cont=false;
        }
      }
    }
}

if($cont==true && empty($error)){
    //Send mail / do insert ect
}else{
    //Default to form
?>
<!doctype html>
<html>
<body>
<form action="" method="post">
 <p>Name: <input type="text" name="name" value="<?=@htmlentities($name);?>"/> <?=@$error['name'];?></P>
 <P>Email: <input type="text" name="email" value="<?=@htmlentities($email);?>" /> <?=@$error['email'];?></p>
 <P>Phone: <input type="text" name="phone" value="<?=@htmlentities($phone);?>"/> <?=@$error['phone'];?></p><br />
 <P>Subject: <input type="text" style="width:75%;" name="subject" /> <?=@$error['subject'];?></p>
 <p>Comments: <?=@$error['comment'];?><br />
 <textarea name="comment" rows="10" cols="50" style="width: 100%;"><?=@htmlentities($comment);?></textarea></p>
 <p><input type="submit" value="Submit"></p>
</form>
</body>
</html>
<?php
}?> 
```

# hbase - HBase 模式行键设计 - 增量计数器？

> ID：10219279
> 
> 赞同：0
> 
> 时间：2012-04-18T22:55:52.110
> 
> 标签：hbase, counter, bigtable

我正在努力寻找有关 HBase 中增量计数器的任何文档。有人知道吗？

我正在为我的应用程序设计一个 Hbase 表架构。我的 row_key 不能保证 100% 的唯一性。所以问题是，当我的 row_key 开始重复时，我希望有一个增量计数器作为行键的一部分来区分它们。想法？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-04-19T10:21:23.493

你可以做一件事，只需用你的行键添加时间戳，这样它就永远是唯一的

作为

```
info:aaa#timestamp
info:bbb#timestamp
info:ccc#timestamp
info:aaa#timestamp
info:bbb#timestamp
info:ccc#timestamp
info:aaa#timestamp
info:bbb#timestamp
info:ccc#timestamp 
```

操作系统，如果你这样做，行键将始终是唯一的

你可以尝试的另一件事

伊根

它通常位于 /usr/bin/

nyancat ~ #uuidgen 488bc393-a4f5-4a83-8df8-8c15e737dcc5

如果您使用的是 java 那么

```
public class GenerateUUID {

  public static final void main(String... aArgs){
    UUID idOne = UUID.randomUUID();
    UUID idTwo = UUID.randomUUID();
    log("UUID One: " + idOne);
    log("UUID Two: " + idTwo);
  }

  private static void log(Object aObject){
    System.out.println( String.valueOf(aObject) );
  }
} 
```

然后你可以把它作为你的钥匙

# r - R - 根据因子的箱线图颜色

> ID：10219288
> 
> 赞同：4
> 
> 时间：2012-04-18T22:57:22.703
> 
> 标签：r, lattice

我有一个与此类似的数据，然后使用格子生成箱线图：

```
mydata <- data.frame(Y = rnorm(3*1000),
                  INDFACT =rep(c("A", "B", "C"), each=1000),
                  CLUSFACT=factor(rep(c("M","F"), 1500)))
library(lattice)
bwplot(Y ~ INDFACT | CLUSFACT, data=mydata, layout=c(2,1)) 
```

我的问题是我想为每个因素 A、B 和 C 设置不同的颜色。我试过这个：

```
bwplot(Y ~ INDFACT | CLUSFACT, data=mydata, layout=c(2,1), col=c("red","blue","green")) 
```

但它只是改变了点的颜色。我想要的是改变整个颜色（点，盒子和伞）。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-18T23:22:05.037

```
names(trellis.par.get())
 [1] "grid.pars"         "fontsize"          "background"        "panel.background"  "clip"             
 [6] "add.line"          "add.text"          "plot.polygon"      "box.dot"           "box.rectangle"    
[11] "box.umbrella"      "dot.line"          "dot.symbol"        "plot.line"         "plot.symbol"      
[16] "reference.line"    "strip.background"  "strip.shingle"     "strip.border"      "superpose.line"   
[21] "superpose.symbol"  "superpose.polygon" "regions"           "shade.colors"      "axis.line"        
[26] "axis.text"         "axis.components"   "layout.heights"    "layout.widths"     "box.3d"           
[31] "par.xlab.text"     "par.ylab.text"     "par.zlab.text"     "par.main.text"     "par.sub.text" 
```

所以你想改变伞和点和盒子，但没有说是不是矩形的填充。我猜它是矩形线，因为同时填充和点是没有意义的。

```
bwp <- bwplot(Y ~ INDFACT | CLUSFACT, data=mydata, layout=c(2,1), 
               par.settings = list( box.umbrella=list(col= c("red", "green", "blue")), 
                                    box.dot=list(col= c("red", "green", "blue")), 
                                    box.rectangle = list(col= c("red", "green", "blue")) 
              )                    )
bwp 
```

![在此处输入图像描述](../Images/c100cd2956a45ff84f112b34ef30f9f0.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T23:06:08.907

尝试设置`box.rectangle`参数：

```
bwplot(Y ~ INDFACT | CLUSFACT, data=mydata, layout=c(2,1),
        par.settings = list(box.rectangle = list(fill= rep(c('red','blue','green'),2))) 
```

![在此处输入图像描述](../Images/976bc72391a17270f0228cc3a5f9f45d.png)

同样，我认为有些`box.dot`参数`box.umbrella`可以满足您的期望。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T23:20:55.063

只是因为它很有趣，这样做`ggplot2`看起来像：

```
library(ggplot2)
ggplot(mydata, aes(x=INDFACT, y=Y, fill=INDFACT))+ 
  geom_boxplot()+
  facet_wrap(~CLUSFACT) 
```

# iphone - 有没有办法查看我的应用程序在模拟器中会占用多少内存？

> ID：10219292
> 
> 赞同：0
> 
> 时间：2012-04-18T22:57:27.420
> 
> 标签：iphone, objective-c, memory, ios-simulator

我正在设计一个 iPhone 应用程序并在上面写一篇论文。我想知道如何查看我的应用程序将在 iPhone 中占用多少虚拟/真实内存。我目前正在模拟器中运行它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:13:39.590

不，这不能准确地完成。*您可以使用 Allocations 工具为您使用的大多数*API获得始终如一的良好值，但是执行环境存在差异，这使得*精确的*数字变得不可能。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-18T23:05:32.610

是的，您想对您的应用进行概要分析。在 Xcode 中，按住“运行”按钮并选择配置文件。应该会弹出一个窗口，要求您选择一种仪器来分析您的应用程序。对于内存使用情况，您可以使用分配或泄漏来分析您的应用程序。我会在谷歌上搜索有关如何使用这两种工具的说明。

# java - 在 java 中，如何在 JButton 的工具提示中添加换行符？

> ID：10219297
> 
> 赞同：1
> 
> 时间：2012-04-18T22:58:24.407
> 
> 标签：java, string, jbutton, jcomponent

我有一个`JButton`使用`setToolTipText(String str)`，我在工具提示中有几行文字需要用换行符分隔。在我想要换行符之前，我尝试在每行文本的末尾连接 +“/n”，但它没有做任何事情。`JToolTip`text 没有带有 a 的构造函数，`JTextArea`我看不到任何`JTextArea`允许它转换为 a 的内容`String`。有人有想法么？另外，如何让 a`JToolTip`持续时间超过默认的 3 秒？感谢您的时间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T23:07:03.073

使用 HTML。

将工具提示设置为`"<html>My multi-line<br>tooltip.</html>"`

# android - 初学者Android为什么“id”是R.id的“未知成员”？

> ID：10219298
> 
> 赞同：1
> 
> 时间：2012-04-18T22:58:34.390
> 
> 标签：android

我确信这很简单，因为它是我的第一个带有代码的 android 应用程序（我所做的 hello world 示例只是为 XML 中的字符串分配一个值）。我的问题是当试图在我的变量中获取我的按钮的引用时，没有定义 R.id 中的 id？

编译器错误出现在下面代码的注释中：

```
package com.geeksonhugs.simplecalc;

import android.app.*;
import android.os.*;
import android.view.*;
import android.widget.*;

public class MainActivity extends Activity
{
    private Button AddButton;
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        AddButton = (Button)findViewById(R.id.btnAdd);
//"Unknown member 'id' of 'com.geeksonhugs.simplecalc.R'"

        //AddButton.setOnClickListener(this);

    }   

} 
```

XML 布局文件：

```
<?xml version='1.0' encoding='utf-8' ?>
<LinearLayout 
        xmlns:android="http://schemas.android.com/apk/res/android" 
    android:id="@+id/LayoutRoot" 
    android:layout_height="match_parent" 
    android:layout_width="match_parent" 
    android:orientation="vertical">

<TextView 
    android:id="@+id/txtFirstNum" 
    android:layout_height="wrap_content" 
    android:layout_width="match_parent" 
    android:text="@string/strFirstNum" />

<EditText 
    android:id="@+id/edtFirstNum" 
    android:layout_height="wrap_content" 
    android:layout_width="match_parent" 
    android:text="" />

<TextView 
    android:id="@+id/txtSecondNum" 
    android:layout_height="wrap_content" 
    android:layout_width="match_parent" 
    android:text="@string/strSecondNum" />

<EditText 
    android:id="@+id/edtSecondNum" 
    android:layout_height="wrap_content" 
    android:layout_width="match_parent" 
    android:text="" />

<Button 
    android:id="@+id/btnAdd" 
    android:layout_height="wrap_content" 
    android:layout_width="match_parent" 
    android:text="@string/strAdd" 
    android:gravity="center" />

<TextView 
    android:id="@+id/txtResult" 
    android:layout_height="wrap_content" 
    android:layout_width="match_parent" 
    android:text="" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-28T06:30:49.927

I resolved the issue by deleting the bin folder and recompiling using the AIDE App.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:04:40.323

该类`R`是在您构建项目时由 Android 构建工具为您生成的代码。这意味着有四种可能性：

1.  您还没有尝试构建项目，在这种情况下，请尝试。

2.  由于某种原因，Eclipse 认为它不需要构建项目——尝试从 Eclipse 菜单中的 Project > Clean （当然，只有在使用 Eclipse 时才相关）。

3.  您的清单或您的资源之一中存在一些阻止`R`构建的错误。应该有 Eclipse 错误指示器。

4.  您的布局中没有`android:id`属性，因此没有`R.id`可用的属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T23:16:40.887

请确保您粘贴的 xml 文件名为 main.xml 并位于 layout 文件夹下。并尝试再次生成 R 文件。这可能会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-16T11:50:29.210

对于那些使用 AIDE 引用 Id 时遇到问题的用户，请尝试删除 bin 文件夹中的“gen 文件夹”并重新编译。问题是 R.java 类没有创建一个名为 Id 的构造函数。所以删除包含 R.java 类的 gen 文件夹并重新编译解决了这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-01T16:06:16.510

您必须将**id**添加到 XML 文件中的组件。像这样：

```
android:id="@+id/buton1" 
```

现在您可以单击 mainActivity.java 并编写代码“R.id”。你看到提示写“button1”并且没有“id”错误

# java - Android 中 HttpGet 的 URL 中的“非法字符”被双重编码

> ID：10219299
> 
> 赞同：3
> 
> 时间：2012-04-18T22:58:34.753
> 
> 标签：java, android, url, httpclient, http-get

我整个晚上都在努力寻找解决方案......

我编写了一个从 Web 服务器请求数据的应用程序。服务器以 JSON 格式回答。一切正常，除非我在我的应用程序中输入像 ä 这样的变音符号。

在下面我假设请求 URL 是[http://example.com/?q=](http://example.com/?q=)并且我正在搜索“Jäger”

正确的调用将是 h++p://example.com/?q=J%C3%A4ger （抱歉加号，但垃圾邮件保护不允许我正确发布。）

所以我现在的问题是：

当我将编码或未编码的 URL 字符串提供给 HttpGet 时，它总是会产生一个双重编码的 URL。

然后对我的服务器的请求是[http://example.com/?q=J%25C3%25A4ger](http://example.com/?q=J%25C3%25A4ger)（它对百分号进行编码），这导致服务器在数据库中搜索 J%C3%A4ger 这显然是错误的。

所以我的问题是，如果用户输入“Jäger”，我的应用程序如何调用正确编码的 URL？

谢谢你的帮助！

这是当前使用的代码...这可能是我有过的最糟糕的想法...

```
URI url = new URI("http", "//example.com/?q=" + ((EditText)findViewById(R.id.input)).getText().toString(), null);
Log.v("MyLogTag", "API Request: " +  url);
HttpGet httpGetRequest = new HttpGet(url);

// Execute the request in the client
HttpResponse httpResponse;
httpResponse = defaultClient.execute(httpGetRequest); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:12:06.553

更新：对不起，`HttpParams`不是用于请求参数，而是用于*配置* `HttpClient`.

在 Android 上，您可能想要使用[`Uri.Builder`](http://developer.android.com/reference/android/net/Uri.Builder.html)，就像[其他 SO 答案](https://stackoverflow.com/a/3974567/180740)中所建议的那样：

```
Uri uri = new Uri.Builder()
    .scheme("http")
    .authority("example.com")
    .path("someservlet")
    .appendQueryParameter("param1", foo)
    .appendQueryParameter("param2", bar)
    .build();

HttpGet request = new HttpGet(uri.toString());

// This looks very tempting but does NOT set request parameters
// but just HttpClient configuration parameters:
// HttpParams params = new BasicHttpParams();
// params.setParameter("q", query);
// request.setParams(params);

HttpResponse response = defaultClient.execute(request);
String json = EntityUtils.toString(response.getEntity()); 
```

在 Android 之外，您最好的选择是手动构建查询字符串（包含所有编码麻烦）或找到类似于 Android 的`Uri.Builder`.

* * *

# visual-c++ - 将 DLL 中的 Pantheios 日志连接到主应用程序的日志记录

> ID：10219300
> 
> 赞同：2
> 
> 时间：2012-04-18T22:58:36.450
> 
> 标签：visual-c++, mfc, pantheios

情况如下：我正在开发一个 MFC 应用程序，并希望将一些日志记录功能集成到其中。我做了一些研究并选择了 Pantheios，因为它似乎被认为是最好的日志 API。我可以轻松地启动和运行简单的日志记录 - 我什至投入了一些回调的东西来更改输出的格式。

我的应用程序将使用几个 DLL。这些是我正在积极开发并希望将日志记录集成到其中的 DLL。理想情况下，来自这些 DLL 的所有日志都将被路由到主应用程序日志中——但我不知道如何使用 Pantheios 来做到这一点。我可以让他们记录到自己的文件中，但我不知道如何将它们附加到主应用程序日志中。

有任何想法吗？

# java - 估计 64 位 Java 中的最大安全 JVM 堆大小

> ID：10219301
> 
> 赞同：8
> 
> 时间：2012-04-18T22:58:38.053
> 
> 标签：java, memory-management, jvm

在分析存在一些问题的 64 位 Java 应用程序的过程中，我注意到分析器本身 (YourKit) 正在使用真正巨大的内存量。我在 YourKit 启动脚本中得到的是：

```
JAVA_HEAP_LIMIT="-Xmx3072m -XX:PermSize=256m -XX:MaxPermSize=768m" 
```

天真地，假设有一些开销，这会让我猜测 YourKit 将使用最大可能超过 4 GB 的东西。但是，我在 PS 中实际看到的是：

```
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
dmoles   31379  4.4 68.2 14440032 8321396 ?    Sl   11:47  10:42 java -Xmx3072m -XX:PermSize=256m -XX:MaxPermSize=768m -XX:+HeapDumpOnOutOfMemoryError -Dyjp.probe.table.length.limit=20000 -Xbootclasspath/a:/home/dmoles/Applications/yjp-9.5.6/bin/../lib/tools.jar -jar /home/dmoles/Applications/yjp-9.5.6/bin/../lib/yjp.jar 
```

这是近 14 GB 的虚拟大小和近 8 GB 的常驻大小——几乎是 Java 堆的 3 倍。

现在，我的开发盒上有足够的内存来运行它，但是回到我试图诊断的原始内存问题：我怎么知道我必须使用多少 Java 堆？

显然，如果客户拥有 16 GB 的物理 RAM，我告诉他们设置`-Xmx`为 16 GB 并不是一个好主意。

那么什么*是*合理的数字呢？12GB？8GB？

我如何估计它？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-19T00:07:39.623

> 显然，如果客户拥有 16 GB 的物理 RAM，我告诉他们将 -Xmx 设置为 16 GB 并不是一个好主意。

如果客户在他/她的机器上没有运行其他重要的东西，那么将堆大小设置为 16G*不一定*是一个坏主意。这取决于应用程序在做什么。

> 那么什么是合理的数字呢？12GB？8GB？

理想的数字是“JVM 最大堆 + JVM 非堆开销 + 操作系统 + 其他活动应用程序的工作集 + 缓冲区缓存工作集”加起来就是物理内存量。但问题是，如果没有在客户机器上进行详细测量，这些组件（除了最大堆大小）都无法确定……而应用程序正在针对实际问题运行。

> 我如何估计它？

底线是你不能。你能做的最好的就是猜测......并且保守一点。

另一种方法是估计应用程序实际需要多少堆来解决它试图解决的问题。然后再增加 50% 或 100%，让 GC 有足够的空间高效工作。（然后调...）

# php - 数组中的未知变量

> ID：10219302
> 
> 赞同：-1
> 
> 时间：2012-04-18T22:58:42.687
> 
> 标签：php

有没有办法将某种参数添加到数组（但未知变量）？正如您在此处看到的，我事先不知道用户 ID（在 mysql 获取之前），因此我无法正确形成指向编辑页面的链接。

```
<?php

$box = array ('1'=>"<a href='edit.php?id=/PROBLEM??/'>edit</a>",'2'=>'Cannot edit');

while ($row = mysql_fetch_array($something)) {

?>

<tr>
<td><?php echo $row["Name"]; ?></td>
<td><?php echo $box[$row["editable"]]; ?></td>
</tr>

<?php

}

?> 
```

> $row["editable"] 返回 1 或 2，取决于用户是否可编辑时返回的数据库记录。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T23:02:52.297

您可以使用`sprintf()`：

```
$box = array ('1'=>"<a href='edit.php?id=%d'>edit</a>",'2'=>'Cannot edit');

echo sprintf($box[$row["editable"]], ID_HERE) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:03:26.747

就这样搞...

```
<?php while ($row = mysql_fetch_array($something)) : ?>

<tr>

<td><?php echo $row["Name"]; ?></td>

<?php if( $row["editable"] === 1 ) : ?>
   <td><a href='edit.php?id=<?php echo $row["Id"]; ?>'>edit</a></td>
<?php else : ?>
    <td>Cannot edit</td>
<?php endif; ?>

</tr>

<?php endif; ?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T23:03:43.200

尝试[str_replace()](http://www.php.net/manual/en/function.str-replace.php)：

```
$box = array ('1'=>"<a href='edit.php?id=%ID%'>edit</a>",'2'=>'Cannot edit');
$link = str_replace('%ID%', $row["id"], $box[$row["editable"]]); 
```

# vim - vim :gsearch (greplace 插件) 转义字符

> ID：10219303
> 
> 赞同：1
> 
> 时间：2012-04-18T22:58:44.300
> 
> 标签：vim, grep, macvim

我正在为 vim 使用 greplace 插件，但不确定如何在搜索中转义括号。

我想搜索 cookies[:parent] 并尝试过：

```
:Gsearch cookies[:parent] # returns nothing
:Gsearch cookies\[:parent\] # returns nothing 
```

我应该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T21:12:42.037

尝试

```
Gsearch cookies\\\[:parent\\\] 
```

或者

```
Gsearch 'cookies\[:parent\]' 
```

. 如果我理解正确，`:grep!`则由`:Gsearch`获取字符串调用的 shell 调用`grep -n cookies\[:parent\] /dev/null`（假设 grepprg 选项具有默认值），因此您的转义由认为它们用于转义`[`以防止全局扩展的 shell 解释。但是在 shell grep 完成 globbing 之后，将参数作为一种模式，所以你也需要为 grep 转义它，这就是为什么我在这里有三个反斜杠：两个是让 grep 得到一个反斜杠，第三个是为了防止 glob 扩展。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T21:55:21.833

`:Gsearch cookies\\\[:parent]`为我工作。

请记住 :Gsearch 除了模式之外还需要一个文件掩码，因此实际上，您可能希望输入类似`:Gsearch \\\[:parent] *.php`或其他内容来指定要搜索的文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T07:36:33.280

```
:Gsearch cookies\[:parent] 
```

[ 是字符类的开始，因此需要转义。] 不是特别特殊，因此不需要转义。

# c# - 错误：System.Windows.Style' 不是属性 'ContextMenu' 的有效值

> ID：10219309
> 
> 赞同：0
> 
> 时间：2012-04-18T22:59:26.467
> 
> 标签：c#, wpf, xaml, listview, contextmenu

我正在尝试使用上下文菜单，一旦按下鼠标右键，就会出现以下错误：

System.Windows.Style' 不是属性 'ContextMenu' 的有效值。

XAML 代码：

```
<UserControl ...>
    <UserControl.Resources>
        <ContextMenu x:Key="SharedInstanceContextMenu">
            <MenuItem Header="Edit" Command="{Binding Path=EditSelectedItemCommand}"/>
        </ContextMenu>

        <Style x:Key="MyItemContainerStyle" TargetType="{x:Type ListViewItem}">
            <Setter Property="ContextMenu" Value="{StaticResource SharedInstanceContextMenu}" />
        </Style>
    </UserControl.Resources>

    ...

    <ListView ...
        <ListView.ItemContainerStyle>
            <Style TargetType="ListViewItem">
                <Setter Property="ListBoxItem.IsSelected" Value="{Binding Path=IsSelected}" />
                <Setter Property="ContextMenu" Value="{StaticResource MyItemContainerStyle}"/> 
```

（我用点来删除不相关的代码）。

有人知道如何防止错误（并查看上下文菜单）吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:05:11.733

```
<Setter Property="ContextMenu" Value="{StaticResource MyItemContainerStyle}"/> 
```

`MyItemContainerStyle`是 a `Style`，而不是 a `ContextMenu`... 你应该改为这样写：

```
<Setter Property="ContextMenu" Value="{StaticResource SharedInstanceContextMenu}"/> 
```

# javascript - jQuery 数据属性正在削减前导零

> ID：10219310
> 
> 赞同：10
> 
> 时间：2012-04-18T22:59:38.463
> 
> 标签：javascript, jquery

我正在尝试使用 jQuery 获取数据-*。我的问题是 jQuery 将我的数字字符串作为数字读取，因此会丢弃前导零。

**HTML**

```
<tr data-string-number="0123456789">... (website layout, jk) ...</tr> 
```

**jQuery 1.7.2**

```
var string_number = $('#selector').data('string-number');
// string_number == 123456789
// string_number != '0123456789' 
```

看起来很简单，但这总是会丢弃前导零。

`data-string-number`总是一个数字，可能有也可能没有前导零。目前它有一个标准长度，但我现在不能说这是否会保持不变。

目前唯一的想法是在它前面加上一个非数字并立即将其删除。这感觉很hacky，让我很难过。

任何想法表示赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-18T23:01:46.917

用这个：

```
$('#selector').attr('data-string-number') 
```

该`.data()`方法*通过设计*进行数据转换。该`.attr()`方法只是按原样（作为字符串）返回属性。请注意，使用`.attr()`时需要提供属性的全名，包括`"data-"`前缀。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-04T09:16:03.803

我知道这很旧，但我有 2 种替代方法可以使用 .attr() 将数据作为字符串访问。

```
<!-- Force a String by breaking the parser Remove Quotes later
or Use Object Below -->
<li data-tmp='"0123456789"'>Data as a String: </li>
<li data-tmp='{"num":123456789,"str":"0123456789"}'>Data as a Object: </li> 
```

现在您可以使用 jQuery .data() 方法访问它们。

请参阅此小提琴以说明[http://jsfiddle.net/KUrJ2/](http://jsfiddle.net/KUrJ2/)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T23:02:15.430

使用标准访问器获取属性`attr()`。

jQuery 尝试*猜测*类型并在使用属性时`data()`对其进行转换。`data-*`正如我们所知，领先`0`的在 a 中微不足道，但在 a 中`Number`却不是`String`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T23:03:45.467

使用 jquery attr()

[http://jsfiddle.net/duerq/](http://jsfiddle.net/duerq/)

# java - 将简单的 Ruby 正则表达式转换为 Java

> ID：10219317
> 
> 赞同：0
> 
> 时间：2012-04-18T23:00:15.627
> 
> 标签：java, ruby, regex

在与 Ruby 中断几年后，我将返回 Java。我正在寻找能够完成以下 Ruby 语句的惯用且简短的 Java 代码：

```
some_string.scan(/[\w|\']+/) 
```

上面的表达式从字符串创建一个数组。数组中的元素`some_string`是由字母字符 ( `\w`) 或撇号组成的所有部分（`\'`因此“John's”不会分成两个单词。）

例如：

`"(The farmer's daughter) went to the market".scan(/[\w|\']+/)`

=>

`["The", "farmer's", "daughter", ...]`

# 更新

我知道解决方案将使用如下内容：

`String[] words = sentence.split(" ");`

我只需要进入的正则表达式部分`split()`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T01:02:52.230

Java 没有可以在函数调用中执行此操作的内置`scan`方法，因此您需要自己滚动循环。`Matcher`使用 Java 的 regex类可以很容易地做到这一点。

```
import java.util.regex.*;

String yourString = "(The farmer's daughter) went to the supermarket";

/* The regex syntax is basically identical to Ruby, except that you need
 * to specify your regex as a normal string literal, and therefore you need to 
 * double up on your backslashes. The other differences between my regex and 
 * yours are all things that I think you need to change about the Ruby version
 * as well. */
Pattern p = Pattern.compile("[\\w']+");
Matcher m = p.matcher(yourString);
List<String> words = new Vector<String>();
while (m.find()) {
   words.add(m.group());
} 
```

我不确定在这种情况下使用`Matcher`与使用的相对优点是什么`Scanner`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T23:19:15.973

即使跨语言，正则表达式的行为也应该或多或少相同。在这种情况下，唯一的区别是您必须转义反斜杠和单引号。

如果我们用 Ruby 编写`/[\w']+/`，那么我们会用 Java 编写`Pattern.compile("[\\w\']+")`。

* * *

哦，[`Scanner`s也可以扫描`String`s](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html#Scanner%28java.lang.String%29)！

```
final String s = "The farmer's daughter went to the market";
Scanner sc = new Scanner(s);
Pattern p = Pattern.compile("[\\w\\']+");
while (sc.hasNext(p)) { System.out.println(sc.next(p)); } 
```

* * *

这不完全一样，但为什么不是[`split`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String%29)空格上的字符串，即单词边界？

```
"The farmer's daughter went to the market".split("\s"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T00:48:34.853

怎么样

```
String[] words = test.split("[^a-zA-Z0-9']+"); 
```

或者

```
words = test.split("[^\\w']+"); 
```

这些模式与您的 Ruby 示例的不同之处在于您使用的是 Ruby 的 String#scan - 您在其中提供与单词匹配的模式。Java 的 String#split 就像 Ruby 的同名方法 - 您提供与您的单词分隔符匹配的模式。

# java - 是否可以缩短检查单个变量的一堆不同值的条件语句

> ID：10219318
> 
> 赞同：2
> 
> 时间：2012-04-18T23:00:29.617
> 
> 标签：java

```
if (hello == 50 || hello == 60 || hello == 70) { 
```

是否有可能将其缩短为类似的东西？

```
if (hello == (50,60,70)); 
```

或类似的东西，只是为了避免不得不不断地重写同一个变量。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T23:05:52.997

一种可能的方法是使用集合。

```
Set<Integer> specialNumbers = new HashSet<Integer>();

specialNumbers.add(50);
specialNumbers.add(60);
specialNumbers.add(70);

if(specialNumbers.contains(hello)) { 
//do stuff 
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-18T23:04:12.180

不可能。你可以更喜欢写开关。

```
switch(hello)
{
   case 50:
   case 60:
   case 70: // Do some thing
            break;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T23:11:00.887

怎么样

```
if ( 0 == ( ( ( hello / 10 ) - 5 ) / 3 ) ) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T16:20:16.017

另一种解决方案：

```
if (Arrays.asList (new Integer [] {50, 60, 70}).contains (hello))
    System.out.println ("contains!"); 
```

您必须在 Array 声明中使用 Intger，而不是 int。许多样板代码，但在增长时，它可能很有用。

最初的昂贵方式是将参数作为对象椭圆的方法：

```
public static boolean contains (Object sample, Object... os) {
    for (Object o: os) 
        if (o.equals (sample))
            return true;
    return false;
} 
```

使用便宜：

```
 if (ArrayCheck.contains (hello, 50, 60, 70)) 
        System.out.println ("contains!"); 
```

采用 an 的类型安全方法会更好，但使用成本更高 - 您必须首先为您的类型生成 ArrayCheck 的实例：

```
public class ArrayCheck <T>
{
    public boolean contains (T sample, T... ts) {
        for (T t: ts) 
            if (t == sample) 
                return true;
        return false;
    }
 // ...
    ArrayCheck <Integer> ac = new ArrayCheck <Integer> ();
    if (ac.contains (hello, 50, 60, 70)) 
```

但可以接受，如果您有多个具有相同类型的此类调用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T15:52:05.810

你没有节省太多，但如果你碰巧有超过 3 个整数，比如说 10 或 20 ...

```
if (Arrays.binarySearch (new int [] {50, 60, 70}, hello) >=0)
    System.out.println ("contains!"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-18T23:10:00.607

有多种方法可以做到这一点。

你可以建立一个新的方法

```
if(checkValue(hello, 50, 60, 70))
{
   // something
}

private boolean checkValue(data, Integer a, Integer b, Integer c)
{
   return (hello == a || hello == b || hello == c) 
} 
```

或者你可以建立一个集合

但你不能真正绕过必须在某个地方进行检查。

并且 java 不支持运算符重载，所以在 C++ 中是这样的

```
if( hello == (50, 60, 70)) 
```

将是有效的（如果你重载 == ）但不是 java

# git - git子模块内部的变化

> ID：10219319
> 
> 赞同：0
> 
> 时间：2012-04-18T23:00:32.117
> 
> 标签：git, git-submodules

可能以前有人问过这个问题，但很难说，因为子模块似乎会导致很多问题。这就是我正在做的事情。

```
# cd to parent repo
git submodule add git://example.com/myrepo
cd myrepo
# make some changes
git commit -am "made changes"
cd ..
git commit -am "modified submodule"
git clone --recursive . <path to cloned repo> 
```

当我这样做时，我会收到错误

> 致命：参考不是树：96fa64c0dd64684f86d17841f7c515446885eb33

其次是

> 无法在子模块路径“myrepo”中签出“96fa64c0dd64684f86d17841f7c515446885eb33”

我在这里做错了什么？我只想添加一个子模块，然后对其进行一些更改，然后将整个父源代码树（包括子模块）克隆到一个新的 repo。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:16:17.813

你应该打电话

```
git submodule init 
```

添加子模块后。 `git submodule add`克隆存储库并将条目添加到 .gitmodules。 `git submodule init`初始化子模块并将 .gitmodules 中的条目复制到 .git/config

# 编辑

我怀疑你错过了使用子模块的一些重要步骤。以下是我用来处理子模块的步骤。

如果适用，首先克隆父 repo

```
git clone git@github.com:test/test.git 
```

切换到克隆目录并添加您的子模块

```
#change to the parent repo directory
cd test

#add the submodule to test/submodules/mysubmodule
git add submodule git@github.com/test/mysubmodule.git submodules/mysubmodule 
```

初始化所有子模块并更新所有子模块，包括嵌套子模块

```
git submodule update --init --recursive 
```

添加所有更改并提交并推送到遥控器（如果适用）

```
git add .
git commit 
```

最后一部分非常重要，因为在您提交更改之前，repo 并不真正了解您的子模块。

# mysql - mysql不允许我从两个单独的表中提取并比较它们

> ID：10219325
> 
> 赞同：0
> 
> 时间：2012-04-18T23:01:15.147
> 
> 标签：mysql

在屏幕截图和项目中，projectId 是连接器。运行以下 sql 代码时出现以下错误：

SQL 代码：

```
SELECT * FROM screenshots s, projects p WHERE s.projectId == p.projectId ORDER BY s.idscreenshot DESC 
```

错误：

> 发生数据库错误
> 
> 错误号：1064
> 
> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '== p.projectId ORDER BY s.idscreenshot DESC' 附近使用正确的语法
> 
> SELECT * FROM screenshots, projects p WHERE s.projectId == p.projectId ORDER BY s.idscreenshot DESC
> 
> 文件名：C:\Workspace\htdocs\Jan-2012\nurbell\system\database\DB_driver.php
> 
> 行号：330

有谁知道为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T23:03:56.620

发生这种情况是因为[SQL 相等运算符](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#operator_equal)是`=`，而不是`==`。

还强烈建议使用显式 JOIN 语法来关联表，而不是您使用的隐式连接语法。因此，例如，而不是：

```
SELECT * 
FROM screenshots s, projects p 
WHERE s.projectId = p.projectId 
ORDER BY s.idscreenshot DESC 
```

你应该使用这个：

```
SELECT * 
FROM screenshots s
JOIN projects p ON s.projectId = p.projectId 
ORDER BY s.idscreenshot DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:04:04.743

使用单个`=`符号而不是`==`

# ruby-on-rails - 如何使用包含进行急切加载，但限制使用包含参数的范围加载的内容

> ID：10219327
> 
> 赞同：1
> 
> 时间：2012-04-18T23:01:31.733
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

好的所以我有以下型号

```
Class Company < ActiveRecord::Base 
has_many customers
active?

Class Customers < ActiveRecord::Base
belongs_to :Company
has_one :account

Class Account < ActiveRecord::Base
belongs_to :Customer
has_many :invoices

Class Invoice < ActiveRecord::Base
belongs_to :account
has_many :line_items
invoice_date

Class LineItem < ActiveRecord::Base
belongs_to:Invoice 
```

我需要做的是检索：拥有客户的所有活跃公司以及这些客户的一些发票

问题是：由于每个客户都可以拥有大量发票，我只想退回 2012 年 4 月 1 日的发票。

我想要做的是使用包括结合模型上设置的范围或方法来限制返回的发票数量。

我的模型将包含范围：

```
Class Invoice < ActiveRecord::Base
belongs_to :account
scope :for_the_day_of, lambda{|invoice_date|where('invoices.invoice_date',invoice_date } 
```

所以现在我可以写这样的东西：

```
invoice = Invoice.for_the_day_of(Date.today).first 
```

我真正想做的是：

```
comapanies = Company.where(:active => true)
.includes(:merchants => [:billing_account => 
[:invoices => for_the_day_of(Date.today) => :invoice_line_items]]) 
```

我不知道这在活动记录中是否可行，或者我只是想错了问题

任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T07:23:19.973

如果我正确理解，您需要可以从另一个模型和一些子查询功能访问的范围。我正在使用 gem [Squeel](https://github.com/ernie/squeel)来提出这个建议。这是一个很棒的宝石，它扩展了 Active Records 的功能。

# android - 如何在我的应用程序被卸载之前显示活动（Android）

> ID：10219328
> 
> 赞同：22
> 
> 时间：2012-04-18T23:01:39.377
> 
> 标签：android, android-activity, uninstallation

我虽然不可能，但我注意到 NQ Mobile Security 能够在我单击卸载后和调用 PackageUninstaller 之前显示一条消息。我想在我的应用程序中复制这种行为。

我尝试了一个监听“android.intent.action.DELETE”意图的活动，如下所示： [如何知道我的应用程序已从设备上卸载...？](https://stackoverflow.com/questions/8686673/how-to-know-my-app-is-uninstalled-from-the-device)

但是当我要卸载我的应用程序时，会弹出选择器，要求选择我的应用程序或包卸载程序。我怎样才能避免这种情况？

是否有不同的方法来拦截您的应用程序 UNINSTALL 事件？（在回答不可能之前，请尝试卸载 NQ Mobile Security 看看会发生什么。在我的 Android 2.3.4 上，它显示一个漂亮的屏幕，说没有安全应用程序不安全）。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-04-18T23:07:36.470

> 我注意到 NQ Mobile Security 能够在我单击卸载后和调用 PackageUninstaller 之前显示一条消息

他们一定是在利用 Android 中的一些安全漏洞。我会研究它，看看我能不能把它修好。应用程序不应该在卸载时获得控制权。

感谢您指出了这一点！

> 是否有不同的方法来拦截您的应用程序 UNINSTALL 事件？

我当然希望不会。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-11-09T15:44:42.463

Opera Max 是一个执行类似操作的应用程序 - 卸载后会打开一个网页。

他们怎么做到的？

通过使用本地代码中的 libevent，他们观察 /data/data/com.opera.max 目录被删除，然后发布好的旧 action.VIEW 广播，当它发生时。

安装他们的应用程序，运行它，然后在根设备上从 adb shell 删除 /data/data/com.opera.max 目录

更新：我创建了一个示例应用程序来展示它是如何工作的。顺便说一句，它不适用于最近的（我认为是 KitKat+）Android 版本：[https ://github.com/pelotasplus/ActionAfterUninstall](https://github.com/pelotasplus/ActionAfterUninstall)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-06-20T19:56:28.873

我很确定他们正在监视 LogCat 以在活动管理器调用 PackageUninstaller 时进行拦截。我认为他们终止了任务并开始了自己的活动。它非常聪明，但肯定是在利用 Android 中的安全漏洞。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-15T18:38:59.200

他们可能会要求用户在不知不觉中授予他们非常关键的权限。查看此应用的“权限”标签（截至 2012 年 6 月 15 日）：[https](https://play.google.com/store/apps/details?id=com.nqmobile.antivirus20&hl=en) ://play.google.com/store/apps/details?id=com.nqmobile.antivirus20&hl=en 。

这个应用程序获得的权限列表令人不寒而栗。除其他事项外：

> 系统工具检索正在运行的应用程序 允许该应用程序检索有关当前和最近运行的任务的信息。恶意应用可能会发现有关其他应用的私人信息。
> 
> 更改/拦截网络设置和流量 允许应用更改网络设置并拦截和检查所有网络流量，例如更改任何 APN 的代理和端口。恶意应用程序可能会在您不知情的情况下监控、重定向或修改网络数据包。
> 
> 阻止平板电脑休眠 阻止手机休眠 允许该应用阻止平板电脑进入休眠状态。允许该应用阻止手机进入睡眠状态。
> 
> 更改您的 UI 设置 允许应用更改当前配置，例如区域设置或整体字体大小。修改全局系统设置 允许应用修改系统的设置数据。恶意应用程序可能会破坏您的系统配置。
> 
> 显示系统级警报 允许应用显示系统警报窗口。恶意应用程序可能会占据整个屏幕。
> 
> 装载和卸载文件系统 允许应用装载和卸载可移动存储的文件系统。
> 
> 更改网络连接 允许应用更改网络连接状态。
> 
> 更改 WI-FI 状态 允许应用连接和断开 Wi-Fi 接入点，并更改配置的 Wi-Fi 网络。

- 更新 -

我还发现，如果要求 Android 包管理器删除一个包，它几乎只会删除它。在这样做之前它执行的*唯一*检查是正在删除的包当前是否已注册为具有活动的设备管理员：

```
 try {
        if (dpm != null && dpm.packageHasActiveAdmins(packageName)) {
            Slog.w(TAG, "Not removing package " + packageName + ": has active device admin");
            return PackageManager.DELETE_FAILED_DEVICE_POLICY_MANAGER;
        }
    } catch (RemoteException e) {
    } 
```

[请参阅此处](http://androidxref.com/source/xref/frameworks/base/services/java/com/android/server/pm/PackageManagerService.java#6890)AOSP 源中 PackageManagerService 中的第 6900 行。

为此，应用程序必须由用户显式注册为设备管理员。请参阅此处有关设备管理的说明：http: [//developer.android.com/training/enterprise/device-management-policy.html](http://developer.android.com/training/enterprise/device-management-policy.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-30T01:03:14.457

根据[https://stackoverflow.com/a/26829978/1317564](https://stackoverflow.com/a/26829978/1317564)，这里有一些示例代码：[https ://github.com/zzljob/android-uninstall-feedback/blob/master/library/jni/feedback -卸载.c](https://github.com/zzljob/android-uninstall-feedback/blob/master/library/jni/feedback-uninstall.c)。这实际上不会阻止卸载的发生，但确实提供了一种捕获它并采取一些措施的方法。老实说，我很惊讶这在 Android 中有效，并且团队可能在最近的版本中填补了空白。

# javascript - 存储可共享的嵌入式 javascript 以供以后使用

> ID：10219331
> 
> 赞同：0
> 
> 时间：2012-04-18T23:02:00.877
> 
> 标签：javascript, embed

我遇到了一些嵌入的javascript，例如

```
<script src="http://player.ooyala.com/player.js?embedCode=5oZDBoMzreLfI78xe1sCSLDmQQFyhXym&deepLinkEmbedCode=5oZDBoMzreLfI78xe1sCSLDmQQFyhXym"></script> 
```

我想知道如何动态执行此操作。原因是，我希望能够将代码保存在数据库中，然后稍后即时执行。

我已经尝试过使用带有 url 的 $.get 并对响应进行 eval 没有运气。

如果这有助于解决问题，我会使用 jQuery。

我该怎么办？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:07:12.850

你正在寻找`$.getScript("http://player.ooyala.com/player.js?embedCode=5oZDBoMzreLfI78xe1sCSLDmQQFyhXym&deepLinkEmbedCode=5oZDBoMzreLfI78xe1sCSLDmQQFyhXym")`.

请注意，如果脚本使用`document.write`，这是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T00:00:35.347

您可以使用：`$.getScript("http://player.ooyala.com/player.js?embedCode=5oZDBoMzreLfI78xe1sCSLDmQQFyhXym&deepLinkEmbedCode=5oZDBoMzreLfI78xe1sCSLDmQQFyhXym&playerContainerId=myplayer")`

注意`playerContainerId=myplayer`部分。

如果您想将播放器添加为 div 的 innerHtml 而不是 document.write()，Ooyala 有一个 playerContainerId 参数。

[http://support.ooyala.com/developers/documentation/api/player_examples_qpass.html](http://support.ooyala.com/developers/documentation/api/player_examples_qpass.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T23:06:26.200

您可以使用 jquery 将整个字符串附加到正文

编辑：必须转义一些字符

```
$("body").append('\<script src="http://player.ooyala.com/player.js?embedCode=5oZDBoMzreLfI78xe1sCSLDmQQFyhXym&deepLinkEmbedCode=5oZDBoMzreLfI78xe1sCSLDmQQFyhXym"\>\<\/script\>');​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-18T23:05:46.490

如果它支持 CORS，您可以请求它，然后使用 jQuery`$.globalEval()`来评估响应 - 它在`script`元素内（从内存中）执行。

或者，在加载时删除`script`元素，然后在您想再次使用它时注入它。

# ios5 - 如何在 StoryBoard 上的自定义 UITableViewCell 中添加 UITextView

> ID：10219335
> 
> 赞同：1
> 
> 时间：2012-04-18T23:02:17.080
> 
> 标签：ios5, storyboard

当我将 UITextView 添加到 StoryBoard 上的自定义 UITableViewCell 时，我总是收到错误消息：

bool _WebTryThreadLock(bool), 0x7c523c0: 试图从主线程或web线程以外的线程获取web lock。这可能是从辅助线程调用 UIKit 的结果。现在崩溃...

# c - 在 C 中使用带有 select() 的标准输入

> ID：10219340
> 
> 赞同：5
> 
> 时间：2012-04-18T23:02:46.337
> 
> 标签：c, linux, sockets, file-descriptor

我有以下程序：

```
 #include <stdio.h>
 #define STDIN 0

 int main()
 {

    fd_set fds;
    int maxfd;
    // sd is a UDP socket

    maxfd = (sd > STDIN)?sd:STDIN;

    while(1){

        FD_ZERO(&fds);
        FD_SET(sd, &fds); 
        FD_SET(STDIN, &fds); 

        select(maxfd+1, &fds, NULL, NULL, NULL); 

        if (FD_ISSET(STDIN, &fds)){
              printf("\nUser input - stdin");
        }
        if (FD_ISSET(sd, &fds)){
              // socket code
        }
     }
 } 
```

我面临的问题是，一旦在 STDIN 上检测到输入，“用户输入 - 标准输入”消息就会继续打印......为什么它不只打印一次，然后在下一个 while 循环检查哪个描述符有输入？

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-18T23:05:38.223

该`select`功能仅在有可用输入时告诉您。如果您实际上不使用它，则 select 将继续直接下降。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T23:04:49.170

因为您没有阅读 STDIN，所以下次在循环中仍有一些内容要阅读。

您需要阅读 STDIN 以防止这种情况发生。

# nagios - Nagios Check_nrpe 没有从 Nagios 中的插件返回的输出，但在终端中工作

> ID：10219341
> 
> 赞同：2
> 
> 时间：2012-04-18T23:02:50.040
> 
> 标签：nagios, nrpe

我正在为 NRPE 配置 NAGIOS 寻求一点帮助。我是 Linux 的新手，似乎在让它工作时遇到了一些麻烦。我正在运行带有 Nagios 3.3.1 核心的 Ubuntu 11.10 和运行 nrpe2.13 的 Nagios 插件 1.4.15
目前我正在尝试让 Nagios Exchange 插件`check_be.exe`与 Nagios 一起使用。我按照`check_be.txt`我的 nagios 服务器和 windows 备份执行服务器上的设置进行了设置。

目前，如果我跑步

```
root@PERSES:/usr/local/nagios/libexec# ./check_nrpe -H 192.168.1.10 -t200 -c check_be 
```

我会得到

```
Job: Daily Backup, Success, Date:17/4/2012 
```

从 Nagios 我得到的只是插件没有返回任何输出。

`Windows.cfg`有以下条目

```
# Service for Backup Exec agent
define service {
  use                 template-backupexec
  service_description BackupExec - Daily DAT backup   ; specific display name, if you need
  host_name           cmbssrv.cmbs.local
  } 
```

`Templates.cfg`有这个条目——我试图修改它以避免套接字超时

```
define service{
 name                  template-backupexec
  use                   generic-service
 service_description   BackupExec Job Check    ; default display name in Nagios
  check_command         check_nrpe! -t 240 -c check_be  ; same name as in the nsclient++ nsc.ini     command defini$
  normal_check_interval 60                      ; your check intervals here
   retry_check_interval  60
 register 0                                    ; this is a template
  } 
```

`Commands.cfg`：

```
# 'check_nrpe' command definition
  define command{
          command_name    check_nrpe
          command_line    $USER1$/check_nrpe -H $HOSTADDESS$ -p 5666 -v $ARG1$
          } 
```

任何想法将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T05:49:51.900

这看起来不对

```
 check_command check_nrpe! -t 240 -c check_be 
```

我认为那些额外的参数需要在定义命令块中。

还要更改 check_command 的名称。您可能会将 check_nrpe 可执行命令（在终端中运行）与同名的 check_command（终端 shell 不知道）混淆。

这是一个与您正在做的事情非常相似的工作示例。

在主要的 nagios 机器上：

```
define command {
  command_name  check_nrpe_cart
  command_line  /usr/lib/nagios/plugins/check_nrpe -H $HOSTADDRESS$ -p 6565 -c $ARG1$
}
define service{
  use                    clientcritical
  host_name              cartbox
  service_description    email
  normal_check_interval  15
  check_command          check_nrpe_cart!check_postfix
} 
```

在 /etc/nagios/nrpe_local.cfg 的购物车上

```
command[check_postfix]=/usr/lib/nagios/plugins/check_procs -w 1:1 -c 1:1 -C master 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-23T11:25:10.833

您应该从以下链接阅读 pdf，您将获得 NRPE NAGIOS 通信问题的最大可能答案。

[http://assets.nagios.com/downloads/nagiosxi/docs/NRPE_Troubleshooting_and_Common_Solutions.pdf](http://assets.nagios.com/downloads/nagiosxi/docs/NRPE_Troubleshooting_and_Common_Solutions.pdf)

# ajax - 未调用侦听器

> ID：10219345
> 
> 赞同：0
> 
> 时间：2012-04-18T23:02:55.087
> 
> 标签：ajax, jsf-2, selectonemenu

我在下面的 selectOneMenu 中没有调用侦听器的问题

```
<h:selectOneMenu id="Country" value="#{bean.country}">
   <f:ajax render="inputId" listener="#{backingBean.clearMethod}" />
     <f:selectItem itemLabel="-Select One-" itemValue="_" noSelectionOption="true"/>
     <f:selectItems value="#{optionValues['countryList']}" />
</h:selectOneMenu>
<h:inputText id="inputId" value="#{bean.city}"/> 
```

optionValues 解析器用于从 xml 文件中解析国家列表选项。它有美国、加拿大和墨西哥。我的问题是，当我将选项从 USA 更改为 Canada 或 Select One 更改为 USA 时，`clearMethod`会调用 。但是当我将选项从 USA 更改为 Select One 时，`clearMethod`不会调用。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T06:34:10.863

我认为问题出`itemValue`在`noSelectionOption`. 它可能会导致验证错误，因此不会调用侦听器。

尝试删除该`itemValue`属性。

（顺便说一句：在您的代码中，`value`属性`selectOneMenu`未绑定到支持 bean 字段。或者它是一个错字？）

# java - 有什么简单的方法可以在 JPanel 上画一个圆圈吗？

> ID：10219349
> 
> 赞同：1
> 
> 时间：2012-04-18T23:03:09.857
> 
> 标签：java, graphics

我在使用 drawOval(x,y,width,height) 方法时遇到问题，该方法假定 x 和 y 值表示“要绘制的椭圆的左上角”( [javadoc](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/Graphics.html#drawOval%28int,%20int,%20int,%20int%29) )的坐标

我希望 x 和 y 值代表圆的**中心点**。我该怎么做呢？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:09:24.557

一个简单的解决方案，如果您事先声明了宽度/高度，则使用`drawOval`如下方法：

```
drawOval( x - (width/2), y - (height/2), width, height); 
```

这将确保 (x, y) 位于椭圆的中心。

为什么？

假设 (x, y) 是 (10, 10) 并且您想要绘制 (height, width) = (10, 10) 的椭圆。

```
drawOval(x, y, height width); 
```

**然后将在(10, 10)**处绘制椭圆的右上角，左下角将在 (10 + 10, 10 + 10) = **(20, 20)**处。

另一方面，如果您使用

```
drawOval( x - (width/2), y - (height/2), height, width); 
```

椭圆的右上角将在 ( 10 - (10/2), 10 - (10/2) ) = **(5, 5)**处绘制，底部将在 (5 + 10, 5 + 10) 处绘制= **(15, 15)**。然后中心将是**(10, 10)** :)

# c - “n * (rand() / RAND_MAX)” 是否会产生偏斜的随机数分布？

> ID：10219355
> 
> 赞同：10
> 
> 时间：2012-04-18T23:03:27.393
> 
> 标签：c, random, numbers, skew

我想找到一种在 C 中获取随机数的不偏不倚的方法（尽管我最多将它用于 0-20 的值，更有可能只有 0-8）。我已经看过这个公式，但是在运行了一些测试之后，我不确定它是否有偏差。有什么帮助吗？

这是使用的完整功能：

```
int randNum() 
{ 
    return 1 + (int) (10.0 * (rand() / (RAND_MAX + 1.0)));
} 
```

我使用以下方法播种：

```
unsigned int iseed = (unsigned int)time(NULL);
srand (iseed); 
```

下面建议的一个拒绝为我工作我试过

```
int greek; 
for (j=0; j<50000; j++) 
{ 
greek =rand_lim(5); 
printf("%d, " greek); 
greek =(int) (NUM * (rand() / (RAND_MAX + 1.0))); 
int togo=number[greek]; 
number[greek]=togo+1; 
} 
```

当我注释掉 printf 时，它停止工作并给我相同的数字 50000 次。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-18T23:11:19.330

是的，它是倾斜的，除非您的 RAND_MAX 恰好是 10 的倍数。

如果你取从 0 到 RAND_MAX 的数字，并尝试将它们分成 10 堆，你真的只有三种可能：

1.  RAND_MAX 是 10 的倍数，堆出来的都是偶数。
2.  RAND_MAX 不是 10 的倍数，而且堆出来的东西不均匀。
3.  你把它分成不均匀的组开始，但扔掉所有会使其不均匀的“额外”。

你很少能控制 RAND_MAX，而且它通常是一个素数。那真的只剩下 2 和 3 的可能性。

第三个选项大致如下： [编辑：经过一番思考，我修改了它以产生范围 0...(limit-1) 内的数字，以适应 C 和 C++ 中大多数事物的工作方式。这也简化了代码（一点点）。

```
int rand_lim(int limit) {
/* return a random number in the range [0..limit)
 */

    int divisor = RAND_MAX/limit;
    int retval;

    do { 
        retval = rand() / divisor;
    } while (retval == limit);

    return retval;
} 
```

对于任何质疑这种方法是否会留下一些偏差的人，我还写了一个完全不同的版本，纯粹是为了测试。这个使用了一个范围非常有限的绝对非随机生成器，因此我们可以简单地遍历范围内的*每个*数字。它看起来像这样：

```
#include <stdlib.h>
#include <stdio.h>

#define MAX 1009

int next_val() {
    // just return consecutive numbers
    static int v=0;

    return v++;
}

int lim(int limit) {
    int divisor = MAX/limit;
    int retval;

    do {
        retval = next_val() / divisor;
    } while (retval == limit);

    return retval;
}

#define LIMIT 10

int main() {

    // we'll allocate extra space at the end of the array:
    int buckets[LIMIT+2] = {0};
    int i;

    for (i=0; i<MAX; i++)
        ++buckets[lim(LIMIT)];

    // and print one beyond what *should* be generated
    for (i=0; i<LIMIT+1; i++)
        printf("%2d: %d\n", i, buckets[i]);
} 
```

所以，我们从 0 到 1009 的数字开始（1009 是素数，所以它不会是我们选择的任何范围的精确倍数）。因此，我们从 1009 个数字开始，并将其分成 10 个桶。这应该在每个桶中提供 100 个，并且 9 个剩菜（可以这么说）被`do`/`while`循环“吃掉”。正如它现在所写的那样，它分配并打印出一个额外的桶。当我运行它时，我在每个存储桶 0..9 中得到正好 100，在存储桶 10 中得到 0。如果我注释掉`do`/`while`循环，我在每个存储桶 0..9 中看到 100，在存储桶 10 中看到 9。

可以肯定的是，我已经针对产生的范围（主要使用素数）和存储桶的数量使用各种其他数字重新运行了测试。到目前为止，我还不能让它为任何范围产生偏斜的结果（当然，只要启用了`do`/`while`循环）。

另一个细节：我在这个算法中使用除法而不是余数是有原因的。一个好的（甚至是体面的）实现是`rand()`无关紧要的，*但是*当你使用除法将数字限制在一个范围内时，你会保留输入的*高位*。当您使用余数执行此操作时，您将保留输入的*低位*。碰巧的是，对于典型的线性同余伪随机数生成器，低位的随机性往往低于高位。一个合理的实现会丢弃一些最低有效位，从而使这无关紧要。另一方面，`rand`周围有一些非常糟糕的实现，并且*大多数*其中，您最终通过使用除法而不是余数来获得更好的输出质量。

我还应该指出，有些*生成*器的作用大致相反——低位比高位更随机。至少在我的经验中，这些是相当少见的。高位更随机的那个*更*常见。

# iis - 在所有站点上禁用日志记录时返回启用日志记录

> ID：10219357
> 
> 赞同：2
> 
> 时间：2012-04-18T23:03:42.900
> 
> 标签：iis, powershell, logging

使用此代码进行远程处理：

```
$pssessIIS = New-PSSession -ComputerName <servername>
Invoke-Command -session $pssessIIS -ScriptBlock {
if ([System.Version] (Get-ItemProperty -path \"HKLM:\\Software\\Microsoft\\Windows     NT\\CurrentVersion\").CurrentVersion -ge [System.Version] \"6.1\") { 
Import-Module WebAdministration 
} else { Add-PSSnapin WebAdministration }
Invoke-Command -scriptblock { 
IIS:
Get-ItemProperty IIS:\\Sites\\'Default Web Site' -Name LogFile | select-object enabled }
}
Remove-PSSession -Session $pssessIIS
exit 
```

它返回“启用”远程和 TS'ing 到服务器并在本地运行 ps 命令，但是，从 IIS mmc 所有网站都禁用了日志记录，并且当前没有写入。

所以问题是为什么我在禁用所有日志记录时从 powershell IIS “启用”？它只是报告它找到了一个日志文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T07:37:50.643

你用这个得到正确的值吗？

```
(Get-WebConfiguration -Filter system.webServer/httpLogging -PSPath 'IIS:\sites\Default Web Site').dontLog 
```

# objective-c - iOS - NSRangeException 仅当断点被禁用时

> ID：10219362
> 
> 赞同：0
> 
> 时间：2012-04-18T23:03:55.523
> 
> 标签：objective-c, ios5, uitableview, nsrangeexception

最近开始开发应用程序，所以请原谅我的无知。我有一个tableView，当点击表格视图中的一个单元格时，我想在它的正下方插入一个新行。这目前在我的代码中有效。但是，我还希望在再次单击单元格后删除已插入的行。这给了我 NSRangeException 说我超出了我的数组范围。

我认为这可能与我的 tableView 委托/数据方法有关，所以我在每个方法上都设置了断点。启用断点后，单元格被完美删除。但是，当我禁用断点并让应用程序自行运行时，它会崩溃。断点怎么可能影响到这一点？

以下是相关代码：

```
- (NSInteger) numberOfSectionsInTableView:(UITableView *)songTableView{
    return 1;
}

- (NSInteger)tableView:(UITableView *)songTableView
 numberOfRowsInSection:(NSInteger)section{
    bool debug = false;

    if (debug) NSLog(@"--TableView: rankings");
    if (expandedRow == -1) 
        return [self.songs count];
    else //one row is expanded, so there is +1
        return ([self.songs count]+1);

}

- (UITableViewCell *)tableView:(UITableView *)songTableView
         cellForRowAtIndexPath:(NSIndexPath *)indexPath{

        bool debug = false;
        if (debug) NSLog(@"--tableView: tableView");

        NSUInteger row = [indexPath row];
        if (row == expandedRow){ //the expanded row, return the custom cell
            UITableViewCell *temp = [[UITableViewCell alloc] 
                                     initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"test"];
            return temp;
        }
        UITableViewCell *cell = [tableViewCells objectAtIndex:row];
        return cell;
    } 
}

- (NSString *)tableView:(UITableView *)songTableView
titleForHeaderInSection:(NSInteger)section{
        //todo: call refresh title
        return @"The Fresh List";
}

- (CGFloat)tableView:(UITableView *)songTableView
heightForRowAtIndexPath:(NSIndexPath *)indexPath{
        return 44.0; //same as SongCell.xib

}

- (void)tableView: (UITableView *)songTableView 
didSelectRowAtIndexPath: (NSIndexPath *)indexPath {
    bool debug = true;
    //todo: if the user selects expanded cell, doesn't do anything
        SongCell *cell = (SongCell *)[songTableView cellForRowAtIndexPath:indexPath];
        if (cell->expanded == NO){
            //change cell image
            cell.bgImage.image = [UIImage imageNamed:@"tablecellbg_click.png"];
            cell->expanded = YES;

            //add new cell below

            NSInteger atRow = [indexPath row] + 1;
            NSIndexPath *insertAt = [NSIndexPath indexPathForRow:atRow inSection:0];
            NSArray *rowArray = [[NSArray alloc] initWithObjects:insertAt, nil];

            if (debug) NSLog(@"Expanded row: %d", atRow);
            expandedRow = atRow;

            [tableView insertRowsAtIndexPaths:rowArray withRowAnimation:UITableViewRowAnimationTop];

        }else { //cell is already open, so close it
            //change cell image
            cell.bgImage.image = [UIImage imageNamed:@"tablecellbg.png"];
            cell->expanded = NO;

            NSIndexPath *removeAt = [NSIndexPath indexPathForRow:expandedRow inSection:0];
            NSArray *rowArray = [[NSArray alloc] initWithObjects:removeAt, nil];
            if(debug) NSLog(@"--about to delete row: %d", expandedRow);

            expandedRow = -1;
            [tableView deleteRowsAtIndexPaths:rowArray withRowAnimation:UITableViewRowAnimationTop];

            //remove expaned cell below
        }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:33:59.323

这只是一个猜测，但在调用中包装更改表结构的代码是个好主意

```
[tableView beginUpdates];
[tableView endUpdates]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:46:19.150

我敢打赌这会返回 null: [NSIndexPath indexPathForRow:expandedRow inSection:0]; 如果它吹了......

hth

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T08:50:41.493

我讨厌回答自己的问题，但我想通了。

我正在从一组对象中加载我的 tableView。当我添加单元格时，该数组仍然只包含 30 个对象，而我的表包含 31 个对象。我正确地返回了 numberOfRowsInSection 方法。

这是我所做的修改。如果出现以下情况，请注意额外的 else：

```
NSUInteger row = [indexPath row];
        if (row == expandedRow){ //the expanded row, return the custom cell
            if(debug) NSLog(@"row == expandedRow");
            UITableViewCell *temp = [[UITableViewCell alloc] 
                                     initWithStyle:UITableViewCellStyleDefault reuseIdentifier:@"test"];
            return temp;
        }
        else if (expandedRow != -1 && row > expandedRow)
            row--; 
```

我的对象数组和 UITableViewCells 假设匹配 1-1。在扩展行之后，indexPath 的行因为偏移 1。这是我对这个问题的快速修复，尽管我确信有更好的方法来解决这个问题。

# python - PyQt4 麻烦创建一个简单的 GUI 应用程序

> ID：10219367
> 
> 赞同：11
> 
> 时间：2012-04-18T23:04:18.777
> 
> 标签：python, qt, pyqt4

所以我正在使用 Python 和 PyQt4 创建一个简单的 Windows 应用程序。我在 QtCreator 中按照我想要的方式设计了我的 UI，并且我已经从 .ui 文件创建了必要的 .py 文件。当我尝试实际打开窗口的一个实例时，我收到以下错误：

```
AttributeError: 'Window' object has no attribute 'setCentralWidget' 
```

所以我回到 ui_mainwindow.py 文件并注释掉以下行：

```
MainWindow.setCentralWidget(self.centralWidget) 
```

现在，当我运行 main.py 时，它会生成一个窗口实例，但它会丢失它的网格布局，并且 UI 元素只是在那里浮动。知道我做错了什么吗？

我的 main.py 文件：

```
import sys
from PyQt4.QtGui import QApplication
from window import Window

if __name__ == "__main__":

    app = QApplication(sys.argv)
    window = Window()
    window.show()
    sys.exit(app.exec_()) 
```

和我的 window.py 文件：

```
from PyQt4.QtCore import Qt, SIGNAL
from PyQt4.QtGui import *

from ui_mainwindow import Ui_MainWindow

class Window(QWidget, Ui_MainWindow):

    def __init__(self, parent = None):

        QWidget.__init__(self, parent)
        self.setupUi(self) 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-18T23:16:56.563

您需要继承自`QMainWindow`，而不是`QWidget`。`setCentralWidget`是一种方法`QMainWindow`。

```
from PyQt4.QtCore import Qt, SIGNAL
from PyQt4.QtGui import *

from ui_mainwindow import Ui_MainWindow

class Window(QMainWindow, Ui_MainWindow):
    def __init__(self, parent = None):

        QMainWindow.__init__(self, parent)
        # or better
        # super(Window, self).__init__(parent)

        self.setupUi(self) 
```

# css - CSS：保持孩子（img）在背景（img）上正确对齐

> ID：10219370
> 
> 赞同：0
> 
> 时间：2012-04-18T23:04:34.263
> 
> 标签：css, image, alignment, scaling

假设我有一个小的透明 gif，我想对齐和缩放可以随着浏览器改变大小而缩放的图像。你可能已经猜到了，是的，我想要一个无缝的小动画在照片上，这样照片的一小部分似乎是动画的。

这对于纯 CSS 来说太难了吗？我已经开始用 js 做这件事了，只是用 CSS 看起来很复杂。所以当我继续用代码来做的时候，有没有人碰巧有一个时髦的 CSS 方法？

尝试过这样的事情，但由于某种原因，浮动图像随浏览器（可见）百分比缩放，而不是包含 bg 图像的父 div。

```
 <div id="bg-image">
        <div class="bg-container">
            <img class="photo" src="../images/bg_artist.jpg" alt=""/>
            <img class="floater" src="../images/twitter.png"  alt="" />
        </div>
    </div> 
```

只是假装我希望子图像显示在右下角：

```
#bg-image .container 
{
    width:102%;
    margin-left:-10px;
}

#bg-image .photo 
{
    width:102%;
    margin-left:-10px;
}

#bg-image .floater {
    position:fixed; 
    left:90%;
    top:90%;
} 
```

好吧，经过一番折腾，js的解决方案非常简单：

```
var floater = document.getElementById("floater");
var photo = document.getElementById("bg-photo");

floater.style.left = photo.width * .9 +"px";
floater.style.top = photo.height * .5 + "px"; 
```

抱歉，我会把它放在一个 jsfiddle 中，但这很难，因为它处理整个浏览器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T01:01:14.170

我有点不清楚您希望最终的行为是什么，但这[会使图像缩放并保持相对于彼此的位置](http://jsfiddle.net/p8nkp/3/)。

**HTML**

```
<div id="bg-image">
   <img class="photo" src="path/bkgimage.png" alt=""/>
   <img class="floater" src="path/floatimage.png"  alt="" />
</div> 
```

**CSS**

```
#bg-image {
    position: absolute;
    width:100%;
    left: 0;
    top: 0;
}

#bg-image .photo {
    width:100%;
}

#bg-image .floater {
    position:absolute;
    width: 10%;
    height: 10%;
    bottom: 0;
    right: 0;
} 
```

# gradle - 在 Gradle 插件任务中访问项目配置 -> 无法确定任务的依赖关系

> ID：10219374
> 
> 赞同：1
> 
> 时间：2012-04-18T23:04:50.197
> 
> 标签：gradle

我正在尝试编写一个插件来将所有依赖项（解压缩）填充到同一个 jar 中。这是我尝试过的：

```
apply plugin: CustomZipPlugin   
class CustomZipPlugin implements Plugin<Project>{
  void apply(Project project) {
    project.configurations.add('include');
    project.tasks.add(
      name:'customZipTask', type: Zip)
      {
        from {project.configurations.include.collect{zipTree(it)}}
      };    
  }
}
repositories{mavenCentral()}
dependencies{
  include 'net.sourceforge.cobertura:cobertura:1.9.4.1'
} 
```

这导致：**无法确定任务'：customZipTask'的依赖关系**

我也试过：

```
..
from project.configurations.include.collect{zipTree(it)}
.. 
```

这导致了：**您无法更改未处于未解决状态的配置！**

但是......直接在我的构建脚本（而不是构建脚本）中编写自定义任务是可行的......即：

```
task customZipTask(type: Zip){
  from {project.configurations.include.collect{zipTree(it)}}
} 
```

关于如何在插件中实现此邮政编码的任何建议？（最好是一个非hacky的解决方案）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T23:27:09.690

啊哈！！我需要在 zipTree 前面加上 'project' .. 这解决了这个问题。上面列出的错误消息有点误导。

```
..
from project.configurations.include.collect{project.zipTree(it)}
.. 
```

打印所有配置怎么样？

我将如何解决以下问题？（得到一个**无法更改的配置，它没有解决异常**）

```
..
project.configurations.include.each {println it}
.. 
```

# actionscript-3 - 我的 ActionScript3 游戏中出现奇怪的声音错误

> ID：10219388
> 
> 赞同：0
> 
> 时间：2012-04-18T23:06:32.513
> 
> 标签：actionscript-3, audio

有时我在玩游戏时会遇到这个奇怪的错误：

```
TypeError: Error #1009: Cannot access a property or method of a null object reference.
at com.efg.framework_mod::SoundManager/playSound()[/Users/xxx/Documents/Developer/AS3_Flex/game_development/projects/xxx/SpaceGame/libs/src/com/efg/framework_mod/SoundManager.as:106]
at com.xxx.games.spacegame::Main/soundEventListener()[/Users/xxx/Documents/Developer/AS3_Flex/game_development/projects/xxx/SpaceGame/src/com/xxx/games/spacegame/Main.as:1407]
at flash.events::EventDispatcher/dispatchEventFunction()
at flash.events::EventDispatcher/dispatchEvent()
at com.xxx.games.spacegame::SpaceGame/createEnemyProj()[/Users/xxx/Documents/Developer/AS3_Flex/game_development/projects/xxx/SpaceGame/src/com/xxx/games/spacegame/SpaceGame.as:3708] 
```

我仍然不知道是什么导致了错误。我发现的唯一一件事是有时我的 SoundManager 中的对象为空。但我不知道为什么。如果那里缺少某些东西，我已经检查了所有适当的数组，但那里似乎一切正常。

这是 SoundManager 中发生错误的部分：

```
public function playSound(soundName:String, isSoundTrack:Boolean = false, loops:int = 1, offset:Number = 0, _volume:Number = 1, fadeIn:Boolean = false,
                                _duration:Number = 1):void {

    tempSoundTransform.volume = _volume;

    tempSound = sounds[soundName];//sometimes null (still don't know why)

    if (!fadeIn) {
        if (isSoundTrack) {
            if (soundTrackChannel != null) {
                soundTrackChannel.stop();
            }
            soundTrackChannel = tempSound.play(offset, loops);                              
            soundTrackChannel.soundTransform = tempSoundTransform;  
        } else {

            soundChannels[soundName] = tempSound.play(offset, loops);//sometimes null but still don't know why

            soundChannels[soundName].soundTransform = tempSoundTransform;//line 106 (see errors above)

        }
    } else {

        fadeInSoundTransform = new SoundTransform(0, 0);

        if (isSoundTrack) {
            if (soundTrackChannel != null) {
                soundTrackChannel.stop();
            }
            soundTrackChannel = tempSound.play(offset, loops, fadeInSoundTransform);
        } else {
            soundChannels[soundName] = tempSound.play(offset, loops, fadeInSoundTransform);

        }

        TweenLite.to(fadeInSoundTransform, _duration, {volume:_volume, onUpdate:updateFadeIn, onUpdateParams:[soundName, isSoundTrack]});
    }
} 
```

这是第 3708 行（请参阅上面的错误）：

```
dispatchEvent(new CustomEventSound(CustomEventSound.PLAY_SOUND, enemyProjSounds[tempEnemyProj._type], false, 0, 8, setSoundVolume, false, false, 0)); 
```

这是 CustomEventSound 类：

```
public function CustomEventSound(type:String, name:String, isSoundTrack:Boolean = false, loops:int = 0,
            offset:Number = 0, _volume:Number = 1, fadeIn:Boolean = false, fadeOut:Boolean = false,
        _duration:Number = 2, startVol:Number = 1, bubbles:Boolean = false, cancelable:Boolean = false)
{
    super(type, bubbles, cancelable);
    this.name = name;
    this.loops = loops;
    this.offset = offset;
    this._volume = _volume;
    this.isSoundTrack = isSoundTrack;
    this.fadeIn = fadeIn;
    this.fadeOut = fadeOut;
    this._duration = _duration;
    this.startVol = startVol;

}

public override function clone():Event {
    return new CustomEventSound(type, name, isSoundTrack, loops, offset, _volume, fadeIn, fadeOut, _duration, startVol, bubbles, cancelable)
}

public override function toString():String {
    return formatToString(type, "type", "bubbles", "cancelable", "eventPhase", name, isSoundTrack, loops, offset, _volume, fadeIn,
                fadeOut, _duration, startVol);
} 
```

CustomEventSounds-Events 的监听器函数

```
override public function soundEventListener(e:CustomEventSound):void {

if (e.type == CustomEventSound.PLAY_SOUND) {

soundManager.playSound(e.name, e.isSoundTrack, e.loops, e.offset, e._volume, e.fadeIn, e._duration);
} else {
    soundManager.stopSound(e.name, e.isSoundTrack, e.fadeOut, e._duration, e.startVol);
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:15:18.347

一次最多有 32 个活动声道。当你调用`tempSound.play(offset, loops)`它时，它会`null`在当前已经有 32 个声音播放时返回。

因此，您应该跟踪播放的声音数量，并且当您有 32 个时`stop()`最旧`SoundChannel`的声音必须播放，或者如果`Sound.play()`返回则忽略新声音`null`。

# c++ - 如何从 ltrace 获取 C++ 堆分配的虚拟方法名称？

> ID：10219394
> 
> 赞同：2
> 
> 时间：2012-04-18T23:07:09.840
> 
> 标签：c++, linux, ltrace

我已经为此苦苦挣扎了大约一天。

我能够构建一个简单的共享库和测试程序，当我在 ltrace 控制下运行它时，我可以获得静态、虚拟和纯虚拟方法的方法名称。

我使用 cmake 构建我的共享库。我有纯虚拟父类，有些方法会抛出异常。

当我在测试程序上运行 ltrace 时，我得到的唯一方法名来自静态方法。

相反，我看到很多这样的行：

```
__gxx_personality_v0(1, 2, 0x474e5543432b2b00, 0x256c800, 0x7fff8d763170) 
```

使 VERBOSE=1 显示：

```
...
cd /home/chchr/src/build/csp-api/platform_services_lib_dynamic && /usr/bin/c++   -Dplatform_services_EXPORTS -DVERSION=10717 -DMAJOR_PACKAGE_VERSION=0 -DMINOR_PACKAGE_VERSION=9 -D__STDC_LIMIT_MACROS -D__STDC_FORMAT_MACROS -DRMOF_BIN=\"/usr/share/rmof.bin\" -shared -g -fPIC -I/home/chchr/src/csp-api/shared/inc -I/home/chchr/src/csp-api/enclosure-lib/inc -I/home/chchr/src/csp-api/compute-lib/inc -I/home/chchr/src/csp-api/storage-lib/inc -I/home/chchr/src/csp-api/RCIM/librcimcli -I/home/chchr/src/csp-api/RCIM/libRCIM    -g -Wall -o CMakeFiles/platform_services.dir/__/shared/src/System.cpp.o -c /home/chchr/src/csp-api/shared/src/System.cpp
...
/usr/bin/c++  -fPIC  -shared -g   -shared -Wl,-soname,libplatform_services.so -o libplatform_services.so CMakeFiles/platform_services.dir/__/shared/src/System.cpp.o CMakeFiles/platform_services.dir/__/shared/src/System_Impl.cpp.o ../RCIM/librcim.so -lssl -lssh2 -lgcrypt -lslp -lcurl -lboost_system-mt -lboost_filesystem-mt -lboost_thread-mt -lpthread -Wl,-rpath,/home/chchr/src/build/csp-api/RCIM: 
```

任何想法在哪里看？谢谢！

好的，这是交易。如果在堆上分配了一个对象，我看不到虚拟/纯虚拟方法。如果它在堆栈上，我会这样做：

```
#include "foo.hpp"

int main()
{
    foo::static_foo();

    foo_child* f = new foo_child;
    f->real_foo();

    // ltrace doesn't report this one?
    f->virtual_foo();
    // ltrace doesn't report this one?
    f->pure_virtual_foo();

    foo_child g;
    g.real_foo();

    // ltrace does report this one!
    g.virtual_foo();
    // ltrace does report this one!
    g.pure_virtual_foo();

    return 0;
}

$ ltrace -C ./f
(0, 0, 0x23c300, -1, 0x1f25bc2)                                                                       = 0x3715a21160
__libc_start_main(0x4008e4, 1, 0x7fff1d54aa68, 0x400a40, 0x400a30 <unfinished ...>
foo::static_foo()(1, 0x7fff1d54aa68, 0x7fff1d54aa78, 4, 0x3715f8b300)                                 = 0x3715f8cf60
operator new(unsigned long)(8, 0x7fff1d54aa68, 0x7fff1d54aa78, 4, 0x3715f8b300)                       = 0xfc4010
foo::real_foo()(0xfc4010, 0xfc4020, 33, 0, 135168)                                                    = 0xfc4010
foo::real_foo()(0x7fff1d54a960, 0xfc4020, 0x7fc684611a86, 0, 135168)                                  = 0x7fff1d54a960
foo::virtual_foo()(0x7fff1d54a960, 0xfc4020, 0x7fc684611a86, 0, 135168)                               = 0x7fff1d54a960
foo_child::pure_virtual_foo()(0x7fff1d54a960, 0xfc4020, 0x7fc684611a86, 0, 135168)                    = 0x7fff1d54a960
+++ exited (status 0) +++ 
```

有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T14:18:55.710

使用 ltrace 添加“-C”选项以支持跟踪 C++ 方法名称

ltrace "-C" 选项的手册页描述是：

**-C, --demangle 将低级符号名称解码（demangle）为用户级名称。除了删除系统前面的任何初始下划线外，这使得 C++ 函数名称可读。**

ltrace -C 程序

输出应该是这样的：

*std::basic_string, std::allocator >::basic_string(std::string const&)(0x8fb940, 0x7fff6fc680b0, 0x7fff6fc680b0, 0x50535f4444415f46, 0x4c4941465f455241) = 0x1970be8*

虽然有时还是有点难以理解，但享受吧^_^

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-24T14:54:37.083

这是 ltrace 中的一个错误。正式报告： [http ://bugs.debian.org/cgi-bin/bugreport.cgi?bug=669416](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=669416)

# jquery - jQuery 更新元素 id

> ID：10219396
> 
> 赞同：15
> 
> 时间：2012-04-18T23:07:12.913
> 
> 标签：jquery

我是 jQuery 新手，想更新元素的 id。我的做法是：

1.  通过它的 id 选择这个元素

2.  用新值覆盖这个 id。

你介意告诉我我的错误在哪里吗？

谢谢！

下面是 HTML 代码：

```
<tr><th><label for="id_aerial_size_dist">Aerial size dist:</label></th><td><select name="aerial_size_dist" id="id_aerial_size_dist">
<option value="a">Very Fine to Fine</option>
<option value="b">Fine to Medium (EFED Default)</option>
<option value="c">Medium to Coarse</option>
<option value="d">Coarse to Very Coarse</option>
</select></td></tr> 
```

jQuery

```
<script type="text/javascript" src=" ../stylesheets/jQuery-1.7.2.js"></script> 

<script>
$(document).ready(function() {

    $('#id_aerial_size_dist').attr('id', 'id_a');

    });
</script> 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-04-18T23:18:09.250

是的，有一种方法可以更改任何属性。

```
$('#your_element').attr('id','the_new_id'); 
```

再说一次，这绝对不推荐，这也是一个非常糟糕的做法。但是，您可以将类用于相同的功能。

```
$('.my_class').removeClass('my_class').addClass('normal_element'); 
```

如果你告诉我你需要做什么，我会帮你解决。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T23:11:29.707

就我个人而言，我觉得 jQuery 没有针对 Id 的特定 setter 方法是非常有意的，因为您不应该更改 Id。你有什么理由不使用课程吗？jQuery 有很多有用的函数和选择器来管理与元素相关的那些，它们可以用作唯一标识符和组标识符。

# jquery - IE 中的“JSON”是未定义的问题，但不是 chrome

> ID：10219398
> 
> 赞同：5
> 
> 时间：2012-04-18T23:07:17.617
> 
> 标签：jquery, ajax, json, internet-explorer

我在 IE9 中使用 jquery ajax 调用时遇到以下错误，我在其中使用 Json.stringify()。

Microsoft JScript 运行时错误：“JSON”未定义

直到昨天，同样的功能还在为我工作，并且仍然在我同事的机器和我机器上的 chrome 上工作。但是今天没有明显的原因停止在我的机器上工作。

请您帮我理解一下，是什么原因造成的？

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-11T03:31:34.457

我的解决方案是通过单击地址栏右侧的“破损页面”图标来关闭兼容模式。

谁知道它最初是如何打开的！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-18T23:15:40.877

您需要让您的文档以标准模式呈现。请参阅此[http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/fc41127c-0243-4d2e-8e7c-2b311f12e390](http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/fc41127c-0243-4d2e-8e7c-2b311f12e390)。

# jms - WSO2 ESB：如何在响应中的 SOAP 错误时执行 JMS 回滚？

> ID：10219399
> 
> 赞同：1
> 
> 时间：2012-04-18T23:07:29.220
> 
> 标签：jms, wso2, wso2esb, esb

使用版本 4.0.3，我目前有一个参与 JMS 到 HTTP 代理的 IN 和 OUT 序列，该代理使用错误处理程序定义，如果出现异常，该处理程序将成功回滚 JMS 本地事务，但是不会引发错误在响应中返回 SOAPFault 的情况（仅来自 ClientHandler 的 WARN 消息），因此我丢失了原始 JMS 消息（已提交）。我应该注意，如果我解析 OUT 序列中的响应并在那里发现故障，则执行回滚没有任何效果，因为当它到达 OUT 序列时，JMS 事务已提交。

我找到了下一个 WSO2 ESB 版本的“已解决的固定”Jira 票证，这*似乎*可以解决我的问题，但没有等待这个版本让它工作的奢侈： [https ://wso2.org/jira /浏览/ESBJAVA-906](https://wso2.org/jira/browse/ESBJAVA-906)

我的问题是，我可以在 4.0.3 中实施任何解决方法吗？有没有办法阻止执行提交的线程，直到我可以确定结果等？如果没有，您能否参考新版本的源代码，以便我可以根据 Jira 票证中实施的修复将必要的故障自己提供到突触 ClientHandler（或类似）中？

这是我收到的警告（我需要成为错误）以及一些额外的调试信息：

> ```
> TID: [] [WSO2 ESB] [2012-04-18 17:18:23,786] INFO {org.apache.synapse.core.axis2.TimeoutHandler} - 此引擎将在 : 86400 秒后过期所有回调，与超时无关动作，在指定或可选超时 {org.apache.synapse.core.axis2.TimeoutHandler}
> TID：[] [WSO2 ESB] [2012-04-18 17:18:23,790] 调试 {org.apache.synapse.core.axis2.SynapseCallbackReceiver} - 添加了回调。等待的回调总数：1 {org.apache.synapse.core.axis2.SynapseCallbackReceiver}
> TID：[] [WSO2 ESB] [2012-04-18 17:18:24,006] WARN {org.apache.synapse.transport.nhttp.ClientHandler} - 收到内部服务器错误：内部服务器错误：127.0.0.1： 8080 请求：Axis2Request [消息 ID：urn:uuid:6322ced4-801f-40fe-a3a7-bb4019b02cdb] [状态已完成：真] [状态发送完成：真] {org.apache.synapse.transport.nhttp.ClientHandler}
> TID：[] [WSO2 ESB] [2012-04-18 17:18:24,015] 调试 {org.apache.synapse.core.axis2.SynapseCallbackReceiver} - 为请求消息 ID 移除回调：urn:uuid:6322ced4-801f- 40fe-a3a7-bb4019b02cdb。待处理的回调计数：0 {org.apache.synapse.core.axis2.SynapseCallbackReceiver}
> TID: [] [WSO2 ESB] [2012-04-18 17:18:24,016] DEBUG {org.apache.synapse.core.axis2.SynapseCallbackReceiver} - Synapse 收到异步响应消息 {org.apache.synapse.core. axis2.SynapseCallbackReceiver}
> TID：[] [WSO2 ESB] [2012-04-18 17:18:24,016] 调试 {org.apache.synapse.core.axis2.SynapseCallbackReceiver} - 接收到：null {org.apache.synapse.core.axis2.突触回调接收器}
> TID：[] [WSO2 ESB] [2012-04-18 17:18:24,017] 调试 {org.apache.synapse.core.axis2.SynapseCallbackReceiver} - SOAPAction：{org.apache.synapse.core.axis2.SynapseCallbackReceiver}
> TID：[] [WSO2 ESB] [2012-04-18 17:18:24,017] 调试 {org.apache.synapse.core.axis2.SynapseCallbackReceiver} - WSA 操作：{org.apache.synapse.core.axis2.突触回调接收器}
> TID：[] [WSO2 ESB] [2012-04-18 17:18:24,021] 调试 {org.apache.synapse.core.axis2.SynapseCallbackReceiver} - 正文：
> 
> ```
> 
> ```
> <?xml version='1.0' encoding='utf-8'?>
> <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
>   <soap:Body>
>     <soap:Fault>
>       <faultcode>soap:Server</faultcode>       
>       <faultstring>org.apache.cxf.service.factory.ServiceConstructionException: Failed to create service.</faultstring>
>     </soap:Fault>
>   </soap:Body>
> </soap:Envelope> 
> ```
> 
> {org.apache.synapse.core.axis2.SynapseCallbackReceiver}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T19:39:11.490

我能够解决，虽然不是按照我希望的方式；试图避免修改 Synapse 行为：

更改 org.apache.synapse.transport.nhttp.ClientHandler 允许我为这种类型的条件（SOAP 错误）抛出错误，该错误在将请求标记为已完成之前执行执行回滚的错误序列。（我也希望我可以捕获传输异常，例如连接失败以类似的方式执行回滚，因为这是 Synapse 允许事务处理消息传递的能力中的另一个令人惊讶的漏洞）。我开始怀疑是否有人真的在企业中将它用于这种类型的 JMS-to-HTTP 模式，因为随着它的实现，消息泄漏的机会很大，例如，如果端点关闭或抛出SOAP 错误。我看过备用的“存储和转发” 模式，但这是异步的，并且要求消息存储队列可以在中断或故障的情况下跨分布式 ESB 恢复和可用 - 我的主消息队列系统已经具备了这一点。出于这个原因，我觉得事务 JMS 是要走的路。我错过了什么吗？Synapse/WSO2 是否有更好的模式我应该考虑（了解我需要以接近零的消息丢失进行同步 JMS-to-HTTP/SOAP 代理）？我错过了什么吗？Synapse/WSO2 是否有更好的模式我应该考虑（了解我需要以接近零的消息丢失进行同步 JMS-to-HTTP/SOAP 代理）？我错过了什么吗？Synapse/WSO2 是否有更好的模式我应该考虑（了解我需要以接近零的消息丢失进行同步 JMS-to-HTTP/SOAP 代理）？

# ruby-on-rails - 在 ActiveSupport 时区中找不到 EST

> ID：10219403
> 
> 赞同：2
> 
> 时间：2012-04-18T23:07:59.157
> 
> 标签：ruby-on-rails, timezone, activesupport

我不知道如何开始......我不知道为什么 ActiveSupport::TimeZone 甚至是必要的，因为 TZInfo::Timezone 似乎工作得很好，而且更完整......但我们一直在使用 ActiveSupport出于某种原因，我无法在可用时区中找到 EST 时区。我错过了什么吗？有什么不包括在内的原因吗？

有什么理由不使用 TZInfo 吗？每个人都应该只使用 TZInfo 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-07-25T07:14:14.827

TimeZone 类用作 TZInfo::Timezone 实例的包装器。它允许 Rails 执行以下操作：

*   将 TZInfo 提供的区域集限制为 142 个区域的有意义子集
*   检索并显示具有更友好名称的区域（例如，“东部时间（美国和加拿大）”而不是“美国/纽约”）
*   仅在需要时才延迟加载 TZInfo::Timezone 实例
*   通过 TimeZone 的 local、parse、at 和 now 方法创建 ActiveSupport::TimeWithZone 实例。

资料来源：Rails 3 Way - 第 2 版

EST 在 ActiveSupport::TimeZone 中提供，它被命名为“东部时间（美国和加拿大）”。您可以通过调用 TimeZone.all 来查看 ActiveSupport::TimeZone 提供的所有时区（前提是包含 ActiveSupport）。EST 也包含在美国时区中，您可以通过调用 TimeZone.us_zones 返回一个较小的仅限美国时区的集合。访问 TimeZone 集合将提供一个 TimeZone，前面是它的偏移量，例如。TimeZone("东部时间（美国和加拿大）"] => (GMT-05:00) 东部时间（美国和加拿大）。

# asp.net - 自定义 ASP.NET 成员资格提供程序：我可以将它放在另一个项目中吗？

> ID：10219404
> 
> 赞同：1
> 
> 时间：2012-04-18T23:08:28.000
> 
> 标签：asp.net, asp.net-membership, membership-provider

我正在构建一个自定义 ASP.NET 成员资格提供程序，因为我想使用我自己的“用户”表来创建成员和类似的东西。情况如下：

1.  我有一个 MVC 4 项目，它引用了一个包含服务层的“服务”项目。
2.  我围绕自定义 MembershipProvider 构建了一个包装器，它有助于单元测试。此包装器引用自定义 MembershipProvider。
3.  我从我的服务层引用包装器。
4.  我将自定义 MembershipProvider 放在 MVC4 项目中（在 App_Data 文件夹中），因为据我所知这是必需的……至少：Visual Studio 抱怨说，如果我把它放在其他地方，它就找不到成员资格提供程序。

所以现在我有了一个循环依赖：MVC4 -> 服务层 -> Wrapper -> MVC4。我的问题：我该如何摆脱它？理想情况下，我想将会员提供者放在一个单独的项目中，但我就是无法让它发挥作用。对此有什么建议吗？恐怕谷歌并没有真正的帮助。

奖励问题 1：我应该扩展 SqlMembershipProvider 而不是 MembershipProvider？

奖励问题 2：没有更好的选择吗？整个 ASP.NET 成员感觉真的过时了，并且有许多缺点恕我直言（例如：它不是为可测试而构建的）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T00:17:30.640

您绝对可以将您的自定义会员提供程序放在另一个项目中。我有两个作为单独的 DLL 构建，然后在 Web 项目中添加了一个引用。

您没有提及为什么在服务层中添加引用，但如果有必要，您应该将它们视为两个不同的范围，因此需要两个单独的解决方案。我有一个成员提供程序需要调用 WCF 服务来验证成员身份，但这是两个独立的部分，您不应该在两者之间共享代码。

您无需将代码放在 App_Data 文件夹中，只需在网站项目中添加对 Membership Provider 项目或 DLL 的引用即可。对

奖金问题1：不。

额外问题 2：会员提供者早于整个 TDD 运动（就微软而言），所以是的，它们不利于测试。但是，如果您从基类继承，您将连接到一个经过良好测试且过时的框架，因此您实际上只需要测试您的自定义位。

# c# - log4net 通过异常参数将完整堆栈跟踪添加到数据库表

> ID：10219407
> 
> 赞同：3
> 
> 时间：2012-04-18T23:08:43.843
> 
> 标签：c#, asp.net, stored-procedures, log4net, adonetappender

对于 log4net 配置.. 这是我的参数设置

```
 <parameter>
      <parameterName value="@exception"/>
      <dbType value="String"/>
      <size value="8000"/>
      <layout type="log4net.Layout.ExceptionLayout"/>
    </parameter>
  </appender> 
```

我在 ADONetAppender 中的存储过程设置如下：

```
<commandText value="dbo.MyInsertProcName"/>
<commandType value="StoredProcedure"/> 
```

在proc内部，@exception的输入参数如下：

```
ALTER PROCEDURE [dbo].[MyInsertProcName]        
(    
    @log_date               DATETIME        
    , @log_level            VARCHAR(50)        
    , @logger               VARCHAR(255)        
    , @message              VARCHAR(4000)        
    , @exception            VARCHAR(MAX) 
.... 
```

存储的过程写入表“MYTable”，其“异常”列长度为 VARCHAR 8000。

我可以在“MYTable”中创建条目，但在创建条目后，该条目不包含整个异常堆栈跟踪。看起来堆栈跟踪被截断，最多只包含 1700 个字符。

在 log4net 中将完整堆栈跟踪记录到数据库的最佳方法是什么？

我错过了什么？

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T07:41:59.833

我通常使用这个（我有一个 nvarchar(max) 字段）：

```
<parameter>
  <parameterName value="@exception"/>
  <dbType value="String"/>
  <layout type="log4net.Layout.PatternLayout">
    <conversionPattern value="%exception" />
  </layout>
</parameter> 
```

但是，我假设如果您删除 size 参数或将其设置为 -1，它也应该适用于您的配置。

# vim - 区分 Vim 中的隐藏缓冲区和活动缓冲区

> ID：10219419
> 
> 赞同：4
> 
> 时间：2012-04-18T23:10:55.207
> 
> 标签：vim

有没有办法区分 Vim 中的隐藏缓冲区和活动缓冲区？

我需要确定一个缓冲区是否在窗口中处于活动状态，以便我可以切换它。
试过了`bufloaded`，但它们都为活动缓冲区和隐藏缓冲区返回 1 `bufexists`。`buflisted`

（我有`set hidden`并且`set bufhidden=hide`在我的vimrc中）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-18T23:47:39.763

用于`bufwinnr()`检查缓冲区是否在窗口中打开。结果是`-1`如果不是。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T04:53:14.560

您可以使用 :ls 查看所有缓冲区的列表。缓冲区编号旁边带有“h”的缓冲区被隐藏。'a' 表示活动缓冲区。

# testng - 在 Gradle 中使用 Selenium、TestNG 和 ReportNG

> ID：10219436
> 
> 赞同：2
> 
> 时间：2012-04-18T23:13:04.537
> 
> 标签：testng, gradle, reportng

这里有人成功配置了 gradle 1.0-milestone-9 的报告吗？

我下载了一个 Selenium 2，使用 Gradle 开发的 TestNG 示例（来自[https://github.com/iainrose/page-objects](https://github.com/iainrose/page-objects)）。它工作得很好（在将系统属性添加到 build.gradle 以切换浏览器之后），现在我想将 ReportNG 添加到组合中。我尝试了以下方法：

```
dependencies {
compile "org.seleniumhq.selenium:selenium-java:2.15.0"
compile "org.testng:testng:6.3.1"
compile "org.uncommons:reportng:1.1.2"
} 
```

它产生以下错误：

```
Could not resolve all dependencies for configuration ':compile'.
> Artifact 'org.testng:testng:6.3.1:jdk15@jar' not found. 
```

[我在http://issues.gradle.org/browse/GRADLE-2042](http://issues.gradle.org/browse/GRADLE-2042)发现了一个类似的问题，并在那里添加了评论，但是，还没有后续行动。唯一的建议是从依赖项中删除报告...我希望这里有人知道一种让报告与 gradle 一起工作的方法。

**添加以下 Szpak 建议的代码后：**

在按照 Szpak 的建议将代码添加到 build.gradle 之后，我终于可以运行测试了——仍然没有报告监听器，但存在依赖关系。但是，一旦我插入侦听器，如下所示：

```
 useTestNG() {
    options {
        listeners << 'org.uncommons.reportng.HTMLReporter'
        listeners << 'org.uncommons.reportng.JUnitXMLReporter'
    } 
```

我得到了 java.lang.StackOverflowError：

```
A problem occurred evaluating root project 'console-bg1'.
> java.lang.StackOverflowError (no error message)

* Exception is:
org.gradle.api.GradleScriptException: A problem occurred evaluating root project 'console-bg1'.
at org.gradle.groovy.scripts.internal.DefaultScriptRunnerFactory$ScriptRunnerImpl.run(DefaultScriptRunnerFactory.java:54)

(...)

Caused by: java.lang.StackOverflowError
at sun.reflect.GeneratedMethodAccessor12.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:90)
at groovy.lang.MetaClassImpl.invokeMissingMethod(MetaClassImpl.java:804)
at groovy.lang.MetaClassImpl.invokePropertyOrMissing(MetaClassImpl.java:1096)
at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1049)
at org.codehaus.groovy.runtime.ScriptBytecodeAdapter.invokeMethodOnSuperN(ScriptBytecodeAdapter.java:128)
at org.gradle.api.tasks.testing.testng.TestNGOptions.methodMissing(TestNGOptions.groovy:204) 
```

从我的在线研究来看，依赖项似乎有问题。我仍然无法将报告与 gradle 一起使用...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T23:16:43.223

作为一种解决方法，您可以从 reportng 包中排除 testng-5.0-jdk15 传递依赖项。

```
dependencies {
    compile "org.seleniumhq.selenium:selenium-java:2.15.0"
    compile "org.testng:testng:6.3.1"
    compile("org.uncommons:reportng:1.1.2") {
        exclude group: "org.testng", module: "testng"
    }
    compile "com.google.inject:guice:3.0"
} 
```

顺便说一句，testCompile 通常是测试依赖项的更好选择。

**更新**：添加了 guice 依赖项以避免“ClassNotFoundException：com.google.inject.Module”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-09T20:26:42.950

这是有效的代码，包括 Szpak 的贡献：

```
dependencies {
compile "org.seleniumhq.selenium:selenium-java:2.21.0"
compile "org.testng:testng:6.3.1"
compile group: 'com.google.inject', name: 'guice', version: '3.0'
compile("org.uncommons:reportng:1.1.2") {
    exclude group: "org.testng", module: "testng"
    }
} 
```

# regex - 删除bash中每一行的最后一个单词

> ID：10219438
> 
> 赞同：5
> 
> 时间：2012-04-18T23:13:34.880
> 
> 标签：regex, bash, sed

我正在尝试浏览一个文件，并删除每行中的最后一个单词。目前，我正在使用命令

```
sed 's/^*\n//' old.txt > new.txt 
```

但结果表明 old.txt 与 new.txt 相同。感谢您的帮助，如果我能澄清这个问题，请告诉我。另外，为了定义“单词”，我只是使用空格。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-18T23:15:36.053

试试下面的。`\w*`匹配文件中的最后一个单词`$`并将搜索锚定到行尾。

```
sed s/'\w*$'// old.txt > new.txt 
```

old.txt 以 new.txt 出现的原因可能是因为您的正则表达式`^*\n`与 old.txt 中的任何行都不匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T00:57:04.363

以下是内联编辑。在运行任何东西之前，请备份您的文件。

```
sed -i 's/[[:alnum:]]*$//' /yourfile 
```

如果您正在使用 OS X，您可能需要尝试以下操作

```
sed -i '' 's/[[:alnum:]]*$//' /yourfile 
```

如果您对直接写回原始文件不感兴趣，但希望打印输出。

```
sed 's/[[:alnum:]]*$//' /yourfile 
```

# search - Eclipse 的搜索插件

> ID：10219441
> 
> 赞同：0
> 
> 时间：2012-04-18T23:13:45.947
> 
> 标签：search, eclipse-plugin, eclipse-rcp, search-engine, mask

我已经编写了 Eclipse 插件，现在需要使用搜索功能对其进行扩展。我知道 Eclipse 有一个搜索功能，但它只搜索工作区，我需要的是在我自己的插件中查找匹配项，而不是在树结构中显示结果。是否有 Eclipse 的搜索插件示例？我会很感激一些提示的链接：D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T17:16:26.723

查看[org.eclipse.search.searchPages](http://help.eclipse.org/helios/topic/org.eclipse.platform.doc.isv/guide/search_page.htm)扩展。

# android - 在 Android 中创建自定义对话框时出现 NullPointerException

> ID：10219444
> 
> 赞同：1
> 
> 时间：2012-04-18T23:14:05.947
> 
> 标签：android, android-layout, android-custom-view, android-dialog

我有一个主要布局，其中有一个搜索按钮。结果显示在另一个名为 layout1 的布局中的 tablelayout 中。现在，当我单击一行时，我想在自定义对话框中显示有关该行的详细信息。我有名为 info 的布局，其中有一个 textview 需要在运行时填充。但是当我尝试设置文本时，应用程序会因 NullPointerException 而崩溃

知道为什么会这样吗？

谢谢。

# android - 用 android drawLines 画很多线

> ID：10219445
> 
> 赞同：2
> 
> 时间：2012-04-18T23:14:08.547
> 
> 标签：android, canvas, points

当我画很多线时，应用程序需要很长时间才能完成绘图。我的目标是连接 a1[] 中的点以形成一条线。有没有更快的方法来做到这一点？请帮忙！

```
 > $ for (int i = 0; i < x.length - 1; i++) {
       >        _canvas.drawLine(a1[i].x, a1[i].y, a1[i + 1].x, a1[i + 1].y,_paint);} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-09-10T09:39:59.633

使用画线。将这些点打包到一个 float[] 中，该行中的每个点都有 2 个点，然后执行以下操作：

```
if (count >= 4) {
    if ((count & 2) != 0) {
        canvas.drawLines(pointlist, 0, count-2, linePaint);
        canvas.drawLines(pointlist, 2, count-2, linePaint);
    }
    else {
        canvas.drawLines(pointlist, 0, count, linePaint);
        canvas.drawLines(pointlist, 2, count - 4, linePaint);
    }
} 
```

其中 count 是点的 float[] 中的可用长度数。画线每段有 4 个浮点数，但如果你像这样错开它们，你会得到你想要的结果，而不需要浪费 2 倍的内存，如果需要的话，你可以有效地移动这些点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-03-11T09:22:01.810

采用`Canvas.drawLines(float[] pts, Paint paint);`

使用`Canvas.drawLines`而不是`Canvas.drawLine`我将绘图时间减半。

我必须绘制 12 条线，每条线有 5000 个点，使用此代码绘制的时间是 2393 毫秒，而不是使用`Canvas.drawLine()`方法的 6000 毫秒。

```
 int lineIndex = 0;
            float[] lines = new float[a1.length * 4];
            for (int i = 0; i < a1.length-1; i++) // -1 to deal with last point
            {
                    lines[lineIndex++] = a1[i].x;
                    lines[lineIndex++] = a1[i].y;
                    lines[lineIndex++] = a1[i + 1].x
                    lines[lineIndex++] = a1[i + 1].y;
            }
            _canvas.drawLines(lines, _paint); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-18T23:16:30.327

尝试先创建一个路径，然后调用 _canvas.drawPath()：

```
Path p = new Path();
p.moveTo(a1[0].x, a1[0].y);
for (int i = 1; i < x.length; i++) {
    p.lineTo(a1[i].x, a1[i].y);
}
_canvas.drawPath(p, _paint); 
```

# c# - 多选项搜索的语法

> ID：10219446
> 
> 赞同：1
> 
> 时间：2012-04-18T23:14:13.667
> 
> 标签：c#, asp.net, sql, syntax

ASP.NET 4.0、Web 表单、C#、SQL

我几乎有一些类似于你在约会网站上看到的搜索表单。多个下拉框，每个 ddbox 都有特定的值以及“任何”值。我想不出一种简单的方法来在下面的示例之外创建此语法，并在按钮单击事件后面的 c# 代码中使用大量 else if 语句：

```
if
= && = && =
else if<br/>
= && = && !=
else if<br/>
= && != && != 
else if<br/>
!= && = && != 
```

...这是具有选定值的相同序列

```
if
Any && Any && Any
else if
Any && Any && Not Any
else if
Any && Not Any && Not Any
else if
Not Any && Any && Not Any 
```

这种情况一直持续到我遍历所有场景。在按钮上单击后面的代码将采用选定的值并决定执行哪个查询。似乎导致头痛的是 ddbox 中的值“any”。有没有一种首选的方法来构造 c# 或 sql 语法以减少 else if 的数量？

让我知道这是否有意义或您是否需要更多信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:24:35.160

我会写这样的东西：

```
create procedure usp_search (
    @param1 varchar(50) = null
   ,@param2 carchar(50) = null
) as
begin
    select field1
          ,field2
          ,field3
          ,fieldN
      from table t with(nolock)
     where ((@param1 is null) or (t.fieldX == @param1))
       and ((@param2 is null) or (t.fieldY == @param2))
end 
```

然后在你的客户上你喜欢

```
//code
var connection = new SqlConnection("connection_string");
var command = new SqlCommand();
command.Connection = connection;
command.CommandText = "usp_Search";
command.CommandType = CommandType.StoredProcedure;
if((string.IsNullOrEmpty(stringVariable1)) || (stringVariable2.ToLower().Equals("any"))) {
    command.Parameters.Add("@param1", SqlType.VarChar, 50).Value = DBNull.Value;
} else {
    command.Parameters.Add("@param1", SqlType.VarChar, 50).Value = stringVariable1;
}
if((string.IsNullOrEmpty(stringVariable2)) || (stringVariable2.ToLower().Equals("any"))) {
    command.Parameters.Add("@param2", SqlType.VarChar, 50).Value = DBNull.Value;
} else {
    command.Parameters.Add("@param2", SqlType.VarChar, 50).Value = stringVariable2;
}
// code 
```

沿着这些思路......这样您的搜索查询可以检索过滤或未过滤的结果......当然，您必须注意此类查询的一些陷阱

**编辑：**仅在 C# 代码中完成的相同操作将是这样的：

```
var sb = new StringBuilder();
sb.Append("select field1 ,field2, field3, fieldN ");
sb.Append("from table t with(nolock) ");
sb.Append("where ((@param1 is null) or (t.fieldX == @param1))");
sb.Append("and ((@param2 is null) or (t.fieldY == @param2))");

var connection = new SqlConnection("connection_string");
var command = new SqlCommand();
command.Connection = connection;
command.CommandText = sb.ToString();
command.CommandType = CommandType.Text;
if((string.IsNullOrEmpty(stringVariable1)) || (stringVariable2.ToLower().Equals("any"))) {
    command.Parameters.Add("@param1", SqlType.VarChar, 50).Value = DBNull.Value;
} else {
    command.Parameters.Add("@param1", SqlType.VarChar, 50).Value = stringVariable1;
}
if((string.IsNullOrEmpty(stringVariable2)) || (stringVariable2.ToLower().Equals("any"))) {
    command.Parameters.Add("@param2", SqlType.VarChar, 50).Value = DBNull.Value;
} else {
    command.Parameters.Add("@param2", SqlType.VarChar, 50).Value = stringVariable2;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:23:39.873

首先，我建议在您的下一个项目中考虑使用 ORM，因为动态 sql 在应用程序设计方面有很多此类警告。

也就是说，我处理这个问题的方式是将任何可选的搜索词放在括号内，这样我就可以这样做：

（SomeField = 'Blah' OR 1=1）

请记住，我并不是说这是一个好的解决方案，但它确实允许您减少嵌套语句的数量，因为您可以按顺序构造 SQL 语句。

考虑以下代码：

```
SQL = "SELECT CompanyName, CompanyState FROM Companies WHERE ";
SQL += "(CompanyName = '" & CompanyName & "' " + (CompanyName == "AnyKey" ? " OR 1=1" : "") + ") ";
SQL += "(CompanyState = '" & CompanyState & "' " + (CompanyState == "AnyKey" ? " OR 1=1" : "") + ") "; 
```

再次，我强调这不应该被认为是好的。我已经转向 ORM，所以我不再有这个问题了。和往常一样，一定要清理你的用户输入。

希望这可以帮助。

# winforms - 在运行时更改 App.config 中的连接字符串

> ID：10219447
> 
> 赞同：-2
> 
> 时间：2012-04-18T23:14:17.860
> 
> 标签：winforms, sql-server-2008, c#-4.0, connection-string, dataadapter

[下面的代码用于在运行时更改 App.config 中的连接字符串，我在这里](http://www.c-sharpcorner.com/uploadfile/1a81c5/configuring-connection-string-in-app-config-file-during-runt/?login=true&user=66f1ec)找到了它，但这段代码在 Visual Studio 2010 和 SQL Server 2008 上对我不起作用，我无法打开与 Northwind 数据库的连接。

```
using System;
using System.Configuration;
using System.Data;
using System.Data.SqlClient;
using System.Text;
using System.Windows.Forms;
using System.Xml;

namespace MyNameSpace
{
    public partial class FrmConnectionTest : Form
    {
        public FrmConnectionTest()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            try
            {
                //Constructing connection string from the inputs
                StringBuilder Con = new StringBuilder("Data Source=");
                Con.Append(TxtServer.Text);
                Con.Append(";Initial Catalog=");
                Con.Append(TxtDatabase.Text);
                Con.Append(";Integrated Security=SSPI;");
                string strCon = Con.ToString();
                updateConfigFile(strCon);
                //Create new sql connection
                SqlConnection Db = new SqlConnection();
                //to refresh connection string each time else it will use             previous connection string
                ConfigurationManager.RefreshSection("connectionStrings");
                Db.ConnectionString = ConfigurationManager.ConnectionStrings["con"].ToString();
                //To check new connection string is working or not
                SqlDataAdapter da = new SqlDataAdapter("select * from employee");
                DataTable dt = new DataTable();
                da.Fill(dt);
                CmbTestValue.DataSource = dt;
                CmbTestValue.DisplayMember = "EmployeeID";
            }
            catch (Exception E)
            {
                MessageBox.Show(ConfigurationManager.ConnectionStrings["con"].ToString() + ".This is invalid connection", "Incorrect server/Database");
            }
        }
        public void updateConfigFile(string con)
        {
            //updating config file
            XmlDocument XmlDoc = new XmlDocument();
            //Loading the Config file
            XmlDoc.Load(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile);
            foreach (XmlElement xElement in XmlDoc.DocumentElement)
            {
                if (xElement.Name == "connectionStrings")
                {
                    //setting the coonection string
                    xElement.FirstChild.Attributes[2].Value = con;
                }
            }
            //writing the connection string in config file
            XmlDoc.Save(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile);
        }
    }
} 
```

使用 Visual Studio 2010 和 SQL Server2008，下一行出现 2 个错误：

```
 SqlDataAdapter da = new SqlDataAdapter("select * from employee"); 
```

*   错误 1 ​​'System.Data.SqlClient.SqlDataAdapter.SqlDataAdapter(System.Data.SqlClient.SqlCommand)' 的最佳重载方法匹配有一些无效参数

*   错误 2 参数 1：无法从 'string' 转换为 'System.Data.SqlClient.SqlCommand'

这个问题有什么解决办法吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T23:20:33.130

该错误告诉您您将不正确的参数传递给您的[SqlDataAdapter](http://msdn.microsoft.com/en-us/library/kx703tc9.aspx)。我认为正确的调用是：

```
SqlDataAdapter da = new SqlDataAdapter("select * from employee", Db); 
```

**编辑**

看起来您正在从程序中创建连接字符串，将其保存到配置文件中，然后在创建 SqlDataAdapter 之前从我们的配置文件中读取它。因此，当您调试此行时：

```
Db.ConnectionString = ConfigurationManager.ConnectionStrings["con"].ToString(); 
```

仔细检查`Db.ConnectionString`实际包含连接字符串。

另一件事是打开您的 SQL Server Management Studio 并确认您可以从那里连接到 Northwind 数据库。包括/或者，在 Visual Studio 中，打开您的“服务器资源管理器”窗口并确认您可以通过单击添加连接然后将连接属性窗口设置为您的服务器并下拉组合框以查看它是否填充来创建到 Northwind 的数据连接你的数据库：

![在此处输入图像描述](../Images/6d39f6a96b03145422d16d5d95940a2b.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:20:43.520

看看[类](http://msdn.microsoft.com/de-de/library/system.data.sqlclient.sqldataadapter%28v=vs.100%29.aspx)[的可用构造函数`SqlDataAdapter`](http://msdn.microsoft.com/de-de/library/system.data.sqlclient.sqldataadapter%28v=vs.100%29.aspx)。

没有只接受 SQL 字符串的构造函数重载。
您需要使用其他重载之一。
例如，[有一个需要一个 SQL 字符串和一个 SqlConnection 对象](http://msdn.microsoft.com/de-de/library/kx703tc9.aspx)。要使用它，请像这样更改您的代码：

```
SqlDataAdapter da = new SqlDataAdapter("select * from employee", Db); 
```

* * *

**编辑：**

正如 BradRem 在他的评论中已经提到的那样，尝试不同的连接字符串。
如果他的示例不适合您，您可以在[http://connectionstrings.com/sql-server-2008](http://connectionstrings.com/sql-server-2008)找到更多可能的示例。

`Northwind`你的服务器上真的有一个数据库吗？
您当前机器上的 Windows 用户是否有权访问服务器上的数据库？（这就是`Integrated Security=SSPI`意思 - 您当前的 Windows 用户用于访问数据库！）

# ios - 可达性通知。我的应用程序的正确位置在哪里？

> ID：10219451
> 
> 赞同：0
> 
> 时间：2012-04-18T23:14:27.313
> 
> 标签：ios, reachability

我开发了一个应用程序，某些区域通常需要连接到互联网。不重要如何：3G，Wifi。

所以，我的问题是我是否必须在主视图上使用可达性，或者我只能在需要互联网连接的特定区域实现它？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:16:49.560

我很确定它可以在您需要的任何地方实施。

所有你需要做的：

1.  [从这里](https://developer.apple.com/iphone/library/samplecode/Reachability/index.html)下载课程
2.  将 Reachability.h 和 Reachability.m 添加到您的项目中
3.  添加 SystemConfiguration 框架

然后，随心所欲...

包括它：

```
#import "Reachability.h" 
```

编写一个方法来调用：

```
-(BOOL)reachable {
    Reachability *r = [Reachability reachabilityWithHostName:@"enbr.co.cc"];
    NetworkStatus internetStatus = [r currentReachabilityStatus];
    if(internetStatus == NotReachable) {
        return NO;
    }
    return YES;
} 
```

称它为：

```
if ([self reachable]) {
    NSLog(@"Reachable");
}
else {
    NSLog(@"Not Reachable");
} 
```

# delphi - FireMonkey：如何抑制默认弹出菜单

> ID：10219453
> 
> 赞同：0
> 
> 时间：2012-04-18T23:14:44.077
> 
> 标签：delphi, popup, firemonkey

我在 FireMonkey 表单上有一个带有关联 TPopupMenu 的 TMemo。

当我右键单击备忘录时，我会得到自己的弹出菜单，但在弹出菜单消失后，我仍然会得到默认弹出菜单（即剪切、复制、粘贴、全选）。

如何禁用默认菜单，或者我可以将自己的项目添加到默认菜单中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T23:50:47.830

我无法重现这种行为。这是我尝试过的：

*   `File->New->FireMonkey HD Application`
*   在表格上放一个`TMemo`和`TPopupMenu`
*   在对象检查器中分配`PopupMenu`给`Memo1.PopupMenu`
*   在 中创建两个菜单项`PopupMenu`，并为它们分配相同的`OnClick`事件（在 Object Inspector 中生成）。我在这两个项目中都`MenuItem1`保留了默认标题 。`MenuItem2``Caption`
*   写了一个简单的，在处理程序`MessageDlg`中显示`TMenuItem(Sender).Caption`一个`Ok`按钮`OnClick`。
*   运行应用程序，右键单击`Memo1`，然后选择任一菜单项

我得到一个菜单，其中显示了我的两个项目（`MenuItem1`和`MenuItem2`）。选择任一项目会在消息对话框中显示相应的项目`Caption`，然后在该对话框中单击`Ok`。没有显示默认的弹出菜单。

**编辑**：为您找到它。这是更新 3 中修复的错误 - 请参阅更新 3[中的错误修复列表](http://edn.embarcadero.com/article/41831/)，然后搜索`98705`或滚动直到您到达上部分`FireMonkey\Components`（它是该部分下的第二个或第三个条目）。

# jquery - 在具有数组格式名称的文本框中放置值

> ID：10219454
> 
> 赞同：0
> 
> 时间：2012-04-18T23:15:03.413
> 
> 标签：jquery

在一个页面中，我有许多名称为数组格式的文本框。当执行函数或发生事件时，我想在其中一个中放置一个值“测试”。但是我的 jquery 代码将值放在所有文本框中。我也不能在生成框架时将 ID 放入文本框。

```
<input type="text" maxlength="255" name="School[school_name]">
<input type="text" maxlength="255" name="School[contact_person]">
<input type="text" maxlength="255" name="School[test]">

$('input:text[name=School[school_name]]').val('test'); 
```

谢谢抗体

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T23:18:13.900

在名称周围加上引号：

```
$('input:text[name="School[school_name]"]').val('test'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:20:17.487

这是一个 jsfiddle，它展示了如何做到这一点：http: [//jsfiddle.net/2eYwQ/11/](http://jsfiddle.net/2eYwQ/11/)

将实际名称放在引号中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T23:21:07.160

```
$('input[name="School[school_name]"]').val('test'); 
```

​会为你施展魔法。语法是：`$('tag[attribute="value"]')`

# .net - .NET 中验证最佳实践的异常处理

> ID：10219458
> 
> 赞同：1
> 
> 时间：2012-04-18T23:15:33.683
> 
> 标签：.net, asp.net-mvc-3, exception-handling

我只是想知道在验证和逻辑上抛出错误是否是一种最佳实践，如下所示。我在我的控制器中的 OnException 方法中捕获这些，并通过 Ajax 作为 JSON 将其发送回客户端。抛出这样的异常可以吗？

```
public void Update(EditTeacherModel model)
        {
            var entity = _teachersRepository.FindBy(model.Id);

            if(entity == null)
                throw new NatGeoNotFoundException("Teacher");

        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T00:21:01.323

只要你有一个特殊的、干净的异常类型，我看不出这会是一个问题的原因。异常是跳出多个嵌套调用堆栈帧的便捷方式。

但是请注意，CLR 上的异常*非常*慢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T07:13:47.473

例外是昂贵的。我相信它们适用于您的应用程序的意外行为。

我认为，验证错误永远不应该抛出异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T00:25:46.293

例外是有**代价**的。处理自定义/业务错误的最佳实践是返回正确的错误代码。

此处讨论异常处理最佳实践：http: [//www.codeproject.com/Articles/9538/Exception-Handling-Best-Practices-in-NET](http://www.codeproject.com/Articles/9538/Exception-Handling-Best-Practices-in-NET)

这里也讨论过：[.NET Throwing Custom Exceptions](https://stackoverflow.com/questions/1573130/net-throwing-custom-exceptions)

# php - 带有基本身份验证的 WSDL 到 PHP

> ID：10219463
> 
> 赞同：18
> 
> 时间：2012-04-18T23:15:43.493
> 
> 标签：php, soap, wsdl, basic-authentication

我需要从基本身份验证后面的 WSDL 构建 php 类。

它有大量的命名空间，因此手动执行此操作看起来很麻烦。

我尝试了一些工具，但看起来身份验证会话并不存在。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2014-03-31T17:52:37.973

```
$options = array(
     'login' => $username,
     'password' => $password,
);
$client = new SoapClient($wsdl, $options); 
```

是的，它有效！我尝试了我正在构建的解决方案，它连接到我的客户 WS，它使用 HTTP Basic Auth。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-13T09:05:13.590

HTTP Auth 与 SOAP 客户端一起使用，但是您无法访问受密码保护的 WSDL 文件

见[https://bugs.php.net/bug.php?id=27777](https://bugs.php.net/bug.php?id=27777)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-20T06:20:16.583

使用内置的 SOAP 客户端，你应该有这样的东西：

```
$options = array(
    'login' => $username,
    'password' => $password,
);
$client = new SoapClient($wsdl, $options); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-02-02T19:40:36.750

我通过使用 lib [nusoap](http://sourceforge.net/projects/nusoap/)解决了这个问题。看看有没有帮助

```
$params = array(
  "param" => "value"
);

$soap_client = new nusoap_client($wsdl_url, true);
$soap_client->setCredentials(USER_SERVICE, PASS_SERVICE, 'basic');
$soap_client->soap_defencoding = 'UTF-8'; //Fix encode erro, if you need
$soap_return = $soap_client->call("method_name", $params); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-10-19T10:06:49.260

这个解决方案怎么样：

1.  下载 WSDL 并保存到本地文件中
2.  使用本地文件创建 SoapClient

像这样的东西（简化版）：

```
class MySoap {

    private $WSDL = 'https://secure-wsdl.url?wsdl';

    private $USERNAME = 'dummy';
    private $PASSWORD = 'dummy';

    private $soapclient;

    private function localWSDL()
    {
        $local_file_name = 'local.wsdl';
        $local_file_path = 'path/to/file/'.$local_file_name;

        // Cache local file for 1 day
        if (filemtime($local_file_path) < time() - 86400) {

            // Modify URL to format http://[username]:[password]@[wsdl_url]
            $WSDL_URL = preg_replace('/^https:\/\//', "https://{$this->USERNAME}:{$this->PASSWORD}@", $this->WSDL);

            $wsdl_content = file_get_contents($WSDL_URL);
            if ($wsdl_content === FALSE) {

                throw new Exception("Download error");
            }

            if (file_put_contents($local_file_path, $wsdl_content) === false) {

                throw new Exception("Write error");
            }
        }

        return $local_file_path;
    }

    private function getSoap()
    {
        if ( ! $this->soapclient )
        {
            $this->soapclient = new SoapClient($this->localWSDL(), array(
                'login'    => $this->USERNAME,
                'password' => $this->PASSWORD,
            ));
        }

        return $this->soapclient;
    }

    public function callWs() {

        $this->getSoap()->wsMethod();
    }
} 
```

这个对我有用 ：）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-08T06:37:08.190

**这是使用soapClient 对webservice 进行身份验证的简单示例**

```
$apiauth =array('UserName'=>'abcusername','Password'=>'xyzpassword','UserCode'=>'1991');
$wsdl = 'http://sitename.com/service.asmx?WSDL';
$header = new SoapHeader('http://tempuri.org/', 'AuthHeader', $apiauth);
$soap = new SoapClient($wsdl); 
$soap->__setSoapHeaders($header);       
$data = $soap->methodname($header); 
```

此代码在内部解析标头如下

```
<soap:Header>
    <AuthHeader xmlns="http://tempuri.org/">
      <UserName>abcusername</UserName>
      <Password>xyzpassword</Password>
      <UserCode>1991</UserCode>
    </AuthHeader>
</soap:Header> 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-03-29T21:25:49.250

我一直在尝试解决这个问题，但据我了解，soap 客户端与 ssl+httpauth Web 服务的连接更痛苦。我已经用谷歌搜索了，据我了解，随着我的问题得到解决，您也可以使用下面的示例来解决您的问题（通过在 url 和 soapClient 设置中使用 HttpAuth 信息）。

```
$username="test";
$password="test";
$url = "https://".urlencode($username).":".urlencode($password)."@example.com/service.asmx?WSDL";

$context = stream_context_create([
'ssl' => [
// set some SSL/TLS specific options
'verify_peer' => false,
'verify_peer_name' => false,
'allow_self_signed' => true,
]]);

$client = new SoapClient($url, [
'location' => $url,
'uri' => $url,
'stream_context' => $context,
'login' => $username,
'password' => $password
]);

$params=array(
'operation'=>’arguments',
'and’=>'other bull',
'goes’=>'here'
);

$response = $client->__soapCall('OperationName', array($params)); 
```

# listview - 是否可以在 KendoUI ListView 中分别为每个字段进行编辑？

> ID：10219466
> 
> 赞同：0
> 
> 时间：2012-04-18T23:16:11.623
> 
> 标签：listview, telerik, kendo-ui, edit-in-place

例如，如果我有一个带有标题和描述的项目的 ListView，是否可以使用 KendoUI 分别编辑每个字段？

如果是这样，是否可以使用 KendoUI MVVM 来实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:17:50.293

哟伙计

我不确定，但这不是[您](http://demos.kendoui.com/web/listview/editing.html)要找的吗？

# configuration - 如何针对远程集群运行 HBase shell

> ID：10219469
> 
> 赞同：10
> 
> 时间：2012-04-18T23:16:31.840
> 
> 标签：configuration, hadoop, hbase, apache-zookeeper, cloudera

我在我的工作站上以伪分布式模式运行 HBase。我们还在集群上运行 HBase。使用 HBase shell，我想从我的工作站访问在集群上运行的 HBase 实例。我想在不登录其中一台集群机器的情况下执行此操作。

使用 Hadoop，您可以通过指定 -conf 参数并提供 hadoop-site.xml 的备用版本在远程集群上运行作业。HBase shell 是否有等价物？

我在我的工作站和集群机器上运行 cloudera cdh3u3。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T00:48:52.810

更改以下 conf 文件。

*   对于 hadoop：core-site.xml、mapred-site.xml。
*   对于 hbase：hbase-site.xml。

您可以创建这些文件的多个版本并根据需要在它们之间切换。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-06-21T15:22:37.550

我正在使用以下命令：

```
hbase --config "path to folder with config files" shell 
```

具有配置的文件夹应至少包含 hbase-site.xml 内容：

```
<configuration>
  <property>
   <name>hbase.cluster.distributed</name>
   <value>true</value>
 </property>
  <property>
    <name>hbase.zookeeper.quorum</name>
 <value>zk1,zk2,zk3</value>
  </property>
   <property>
        <name>zookeeper.znode.parent</name>
<!--or /hbase-->
        <value>/hbase-unsecure</value>
    </property>
</configuration> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-12-16T03:11:18.973

更改 hbase-site.xml 将 zookeeper 主机端口添加到 hbase 服务器。

```
<configuration>
<property>
  <name>hbase.zookeeper.quorum</name>
  <value>zk.hostname</value>
</property>
</configuration> 
```

# ruby-on-rails - RefineryCMS - 删除默认页面部分

> ID：10219476
> 
> 赞同：3
> 
> 时间：2012-04-18T23:17:04.393
> 
> 标签：ruby-on-rails, refinerycms

我想删除 RefineryCMS 中每个页面上的**side_body**部分。

该指南建议您可以通过进入并更改设置来[更改页面部分：](http://refinerycms.com/guides/changing-page-parts)`config/initializers/refinery/pages.rb`

所以我改变了：

```
config.default_parts = [“Body”, “Side Body”] 
```

至：

```
config.default_parts = [“Body”] 
```

我已经重新启动了我的服务器，但我的 side_body 部分仍然出现。side_body 可以去掉吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T00:38:31.577

这只是一个猜测，但我相信它只出现在已经存在的页面上。如果您创建一个新页面，您应该只看到`Body`-tag。至少这是 Refinery 1.0.8 中的行为。

要从`Side Body`现有页面中删除，您必须使页面部分可编辑。我认为你可以通过设置来实现这一点`config.new_page_parts => true`。之后，当您编辑页面时，您应该能够在编辑器正上方看到一个 (+)、一个 (-) 和一个 (reorder) 符号。

# php - 用于 TDD 的 PHP 框架

> ID：10219478
> 
> 赞同：2
> 
> 时间：2012-04-18T23:17:14.307
> 
> 标签：php, tdd, lithium

我正在开始一个个人项目，该项目应该（希望）发展成为一家初创公司，该项目需要很好地扩展，我更愿意现在将时间投入到 TDD 上。

我是锂的忠实粉丝，我知道锂有自己的内置测试套件，但我找不到任何可靠的文档，而且我以前从未做过任何真正的 TDD。

有没有更好的方法让我去？还是我应该坚持使用锂并磨练学习过程？

编辑：只是为了澄清。我说的是 PHP 框架，而不是测试框架。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T00:46:33.913

好吧，如果你**确实**计划在 Lithium 中开发它，那么我肯定会坚持使用 Lithium 中内置的集成测试框架。

在这里找到它：http:
[//li3.me/docs/manual/quality-code/testing.wiki](http://li3.me/docs/manual/quality-code/testing.wiki)

如果您想弄清楚如何将 tdd 集成到您的正常开发中，我建议您选择 Steve Sanderson 的一本 .net mvc 书籍（因为您似乎已经做了一些 .net 工作）。

阅读那本书应该只需要几天的时间，你就会对如何将 tdd 集成到你的开发例程中有一个深刻的理解，因为那本书非常强调开发中的单元测试。

祝你创业顺利。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T06:11:44.267

如果您认为您的项目实际上可能会变得很大，那么您应该在不使用框架的情况下编写它。一般来说，框架的问题在于它们是用“一切和厨房水槽”的方法制成的。

[如果你从头开始构建它（也许从 Lithium 借用一些你喜欢的部分）并使用PHPUnit](http://www.phpunit.de/manual/3.6/en/)作为你的测试套件/框架，你会好得多。

另外，我强烈建议观看[本讲座](http://www.youtube.com/watch?v=wEhu57pih5w)（也许还有同一系列的其他讲座），以获得一些一般性的指导。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T08:02:53.237

看看[Zend 框架](http://framework.zend.com/)。它是目前最大、最全面的框架之一。它还默认包含 MVC。

它还使用[Zend_Test](http://framework.zend.com/manual/en/zend.test.html)内置了对 PHPUnit 的支持。

# javascript - 向 scrollTop 添加锚点

> ID：10219479
> 
> 赞同：0
> 
> 时间：2012-04-18T23:17:19.080
> 
> 标签：javascript, jquery, scrolltop

是否可以在此脚本中添加锚点？我不想一直滚动到顶部，而是想滚动到页面中的特定锚点。

这是当前脚本：

```
if (isError) {
$('html, body').animate({
    scrollTop: 700
}, 2500);
$("#error-div").show();
} else {
$("#error-div").hide();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T23:30:13.980

对于这个简单的任务，实际上不需要包含一个巨大的插件。

使用 jQuerys `position()`- 函数 ( [jQuery Doc](http://api.jquery.com/position/ "jQuery 文档") )，您可以获得元素在 DOM 中的位置（只要它是可见的）。*它返回一个相*对于父对象具有`top`和`left`- 值的对象。如果您想要相对于文档的值，请使用- 函数，用法保持不变。*`offset()`*

 *我创建了一个小小提琴来向您展示基本用法：

[http://jsfiddle.net/DtADS/](http://jsfiddle.net/DtADS/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:19:56.457

使用 scrollto 插件，您可以将整个页面滚动到任何元素，甚至可以滚动到元素内部。 [http://demos.flesler.com/jquery/scrollTo/](http://demos.flesler.com/jquery/scrollTo/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T23:27:54.650

如果我理解您的问题，您需要在页面中要滚动的位置`<div id="scrollHere"></div>`和 jquery 中放置类似的内容：

```
window.location.href = "#scrollHere"; 
```

如果是这种情况，此方法会转到#scrollHere 所在的页面。*

# c++ - 命令模式队列按时间排序？

> ID：10219480
> 
> 赞同：2
> 
> 时间：2012-04-18T23:17:20.877
> 
> 标签：c++, queue, command-pattern

我正在更改一些代码以使用命令模式并将命令对象存储在队列中。这些命令需要在特定时间执行，因此我将每秒遍历列表一次以查找要执行的命令。

每个命令对象都会有一个时间，我将根据当前时间检查这个时间（在一个小阈值内）。因此，如果时间匹配，我需要从列表中删除命令对象，然后执行它。通常在任何给定时间都会有不到 10 个命令。我应该使用什么集合数据结构以及如何在迭代列表时删除命令对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T23:20:27.840

我想你想使用一个[优先队列](http://en.wikipedia.org/wiki/Priority_queue)。这是一个容器，可让您拉取最高优先级的项目。在您的情况下，“更高优先级”是“首先发生”。

C++ 将优先级队列建模为[`priority_queue`](http://www.cplusplus.com/reference/stl/priority_queue/)容器适配器。这意味着它内部还有一些其他容器可以进行实际存储。这个容器通常是`vector`或`deque`。（需要随机访问迭代器。）默认为`vector`. 所以你可以声明：

```
std::priority_queue<T, vector<T>, Compare> queue; 
```

where`T`是你的元素，`Compare`是一个比较两个元素的函数，如果第一个元素的优先级低于第二个`T`元素，则返回。`true`如果你已经`operator <`为你的 type 定义了`T`，它会变得更简单：

```
std::priority_queue<T> queue; 
```

*   要将项目放入队列：`queue.push(item);`
*   要获得最高优先级的元素：`queue.top()`
*   要删除队列的顶部项目：`queue.pop();`

注意`pop()`不返回被移除的元素；它只是删除和破坏它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:36:52.140

Mike 解决方案的替代方案是使用有序映射，在 STL 的情况下它只是一个`map`. 您可以将时间作为键，将命令作为值。根据您的情况，它可能比排队更方便。

如果允许同时执行两个命令，则应使用`multimap`.

```
multimap<time_t, Command> schedule;

schedule.insert(pair<time_t, Command>(123456, formatHDDCommand)); 
```

# python - Flask POST 请求导致服务器崩溃

> ID：10219486
> 
> 赞同：28
> 
> 时间：2012-04-18T23:17:55.693
> 
> 标签：python, json, api, rest, flask

我正在尝试在 Flask 中制作一个简单的 api，第一步是获取 POST json 数据。（我现在只想打印它）这是我的代码，当我使用 json 数据请求 /api 时，它返回 500 错误。关于为什么会发生这种情况的任何想法？

```
from flask import Flask, request, Response
app = Flask(__name__)

@app.route('/')
def root_response():
    return "Hello World."

@app.route('/api', methods=['POST', 'GET'])
def api_response():
    if request.method == 'POST':
        return request.json

if __name__ == '__main__':
    app.run() 
```

卷曲命令：

```
$ curl -H "Content-Type: application/json" --data @body.json http://127.0.0.1:5000/api
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<title>500 Internal Server Error</title>
<h1>Internal Server Error</h1>
<p>The server encountered an internal error and was unable to complete your request.  Either the server is overloaded or there is an error in the application.</p> 
```

身体.json：

```
{
"please": "print",
"me": "now"
} 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-04-18T23:33:39.990

首先你要做的是启用调试模式，这样 Flask 就会告诉你错误是什么。（每次修改代码时，您都会获得重新加载烧瓶的额外好处！）

```
if __name__ == '__main__':
    app.debug = True
    app.run() 
```

然后我们发现我们的错误：

```
TypeError: 'dict' object is not callable 
```

您正在返回 request.json，它是一个字典。您需要先将其转换为字符串。这很容易做到：

```
def api_response():
    from flask import jsonify
    if request.method == 'POST':
        return jsonify(**request.json) 
```

你在这！:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-07-16T14:01:31.777

服务器过载是因为默认端口（5000）或用户明确提到的端口（例如：app.run（port=7000））可能正在后台使用其他一些进程，所以我们需要杀死正在运行的进程由该端口使用。

您可以使用以下命令查看正在使用该端口的进程 ID（PIDS）： **netstat -o -a** in command prompt [![在此处输入图像描述](../Images/e762272bc9350ce5c6c9ebb8c1e83fd7.png)](https://i.stack.imgur.com/Pvcyi.png) *查看端口的相应 PID

然后使用以下命令杀死您要使用的端口的所有进程（PIDS）： **Taskkill /PID 30832 /F** 在这里，我将 PID 30832 用于端口 127.0.0.1:7000，这会导致过载错误。在那个问题解决之后。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-01-10T13:36:31.267

服务器在您使用的端口上过载。如果你有一个 linux 服务器，打印绑定到你的端口的进程，如下所示：

```
fuser 5000/tcp 
```

这将杀死绑定到它的进程：

```
fuser -k 5000/tcp 
```

你可以走了

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-05-20T08:36:36.670

1.**首先**你设置：

```
if __name__ == '__main__':
app.run(debug=TRUE) 
```

2.服务器（默认）忙于进程，首先你终止该服务器上的进程：

您可以使用以下命令查看正在使用该端口的进程 ID（PIDS）：**netstat -o -a** in command prompt。 [在此处输入以查看示例](https://i.stack.imgur.com/iurB2.png) 查看端口的相应 PID。

然后使用以下命令杀死您要使用的端口的所有进程（PIDS）：`Taskkill /PID 10324 /F`这里我使用了端口**127.0.0.1:5000的****PID 10324** ，这给出了过载错误。**那个问题解决之后**。

# linux - ALSA MIDI SysEx 交换上的双向嗅探/窥探

> ID：10219487
> 
> 赞同：5
> 
> 时间：2012-04-18T23:17:57.377
> 
> 标签：linux, midi, alsa, wine, sniffing

有谁知道在 Linux 上双向转储 MIDI SysEx 数据的好方法？（在 Yamaha PSR-E413 MIDI 键盘和在 Wine 中运行的 Yamaha [MusicSoft Downloader](http://www.yamahamusicsoft.com/en/page/10)副本之间）

我想对用于将 MIDI 文件复制到我的键盘内部存储器和从我的键盘内部存储器复制的协议进行逆向工程，为此，我需要对两者之间的有效交换进行一些记录。

该实用程序确实可以在 Wine 中工作（[稍微轻推](http://appdb.winehq.org/objectManager.php?sClass=application&iId=13564)），但是当我可以使用 FUSE 文件系统时，我不想在 Wine 中依赖廉价的、不可编写脚本的应用程序。

这是目前的情况：

*   我的键盘通过内置的 USB-MIDI 桥接器连接到我的 PC。USB dumpers/snoopers 是可能的，但如果可能的话，我宁愿避免它们。在我开始之前，我不想再解码另一层协议编码。
*   我只运行 Linux。但是，如果除了基于 Windows 的 dumper/snooper 之外别无选择，我可以尝试让 USB 1.1 直通在我的 WinXP VirtualBox VM 上工作。
*   我为我的音频系统运行裸 ALSA，并使用 dmix 进行波形音频混合。
    *   如果需要声音服务器，我愿意尝试 JACK。
    *   请不要使用PulseAudio。从我的系统中删除它花了足够长的时间。
*   如果该过程涉及 ALSA MIDI 路由：
    *   我可以从下载器中选择一个虚拟的直通设备是首选，因为它通常只在开始与键盘通信之前的瞬间出现在[ALSA补丁托架 GUI 中，如补丁。](http://drobilla.net/software/patchage/)
    *   [据我所知， KMIDIMon](http://kmidimon.sourceforge.net/)和[GMIDIMonitor](http://home.gna.org/gmidimonitor/)都不支持双向监听。
    *   virmidi[不相关](http://www.linuxmusicians.com/viewtopic.php?f=4&t=7313)，我还没有设法开始`snd-seq-dummy`工作。
*   我想如果我真的必须的话，我可以修补 ALSA 以获得转储，但这确实是最后的选择。
    *   我的绝大多数编程经验是 Python、PHP、Javascript 和 shell 脚本。
    *   我几乎没有 C 编程经验。
    *   我什至从未见过内核模式代码的一瞥。
    *   我更愿意保持我的系统稳定和我的正常运行时间高。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T00:34:16.427

这个问题已经有一段时间没有答案了，虽然我对你的问题没有确切的答案，但我可能有一些东西可以把你推向正确的方向（或者其他有类似问题的人）。

当我想嗅探用于在 Akai LPK25 MIDI 键盘上设置和读取预设的数据时，我遇到了一个类似但不太复杂的问题。与您的设置类似，设置键盘的软件可以在 Wine 中运行，但我也没有找到适用于 Linux 的嗅探器设置。

由于缺乏现有的解决方案，我使用 ALSA MIDI 路由通过 virmidi 端口推出了自己的解决方案。我理解为什么您认为它们无用，因为如果没有额外的软件，它们无法帮助嗅探 MIDI 流量。

我的解决方案是用 Java 编写一个 MIDI 中继/桥接器，在其中我从 virmidi 端口读取输入，显示数据并将其进一步发送到键盘。来自键盘的答案（如果有的话）也会被读取、显示并最终传输回 virmidi 端口。Wine 中的应用程序可以设置为使用 virmidi 端口进行通信，理论上这个过程是完全透明的（除了潜在的延迟问题）。该应用程序是以通用方式编写的，没有硬编码到我的问题。

我只处理大约 20 字节长度的 SysEx 消息，所以我不确定该软件在嗅探大量数据传输方面的效果如何。但是也许您可以按照示例修改它/编写自己的程序。

此处提供的来源：[https ://github.com/hiben/MIDISpy](https://github.com/hiben/MIDISpy)

（Java 1.6，包括 ant 构建文件，源代码在 BSD 许可下）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-27T17:43:07.517

我喜欢用`aseqdump`它。

[http://www.linuxcommand.org/man_pages/aseqdump1.html](http://www.linuxcommand.org/man_pages/aseqdump1.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-28T16:15:33.027

为此，您可以使用虚拟 MIDI 设备。所以你必须加载`snd_seq_dummy`以便它创建至少两个端口：

```
 $ sudo modprobe -r snd_seq_dummy
    $ sudo modprobe snd_seq_dummy ports=1 duplex=1 
```

然后你应该有一个名为的设备`Midi through`：

```
 $ aconnect -i -o -l
    client 0: 'System' [type=kernel]
        0 'Timer           '
        1 'Announce        '
    client 14: 'Midi Through' [type=kernel]
        0 'Midi Through Port-0:A'
        1 'Midi Through Port-0:B'
    client 131: 'VMPK Input' [type=user,pid=50369]
        0 'in              '
    client 132: 'VMPK Output' [type=user,pid=50369]
        0 'out             ' 
```

我将从这个例子中获取端口和设备号。您必须根据您的设置自行检查它们。

现在您将您喜欢的 MIDI 设备插入`Midi Through`端口：

```
 $ aconnect 132:0 14:0
    $ aconnect 14:0 131:0 
```

此时你有一个连接，你可以同时监视两个设备。你可以`aseqdump`用来监视 MIDI 对话。有不同的可能性。我建议监视环回设备和真实设备之间的连接。这允许您将 rawmidi 连接到环回设备。

```
 $ aseqdump -p 14:0,132:0 | tee dump.log 
```

现在一切都准备好使用了。您只需要注意 MIDI 应用程序中的端口名称。它应该读取 MIDI 数据`Midi Through Port-0:B`并将数据写入`Midi Through Port-0:B`.

一些额外的提示：您可以使用图形前端`patchage`通过拖放来连接和检查 MIDI 连接。如果您这样做，您将看到每个`Midi Through`端口出现两次，一次作为输入，一次作为输出。两者都必须连接才能使此设置正常工作。

如果您想使用 GMidiMonitor 或其他一些应用程序，您可以使用假设端口监视​​混合的两个流（不显示方向`aconnect`）：`129:0``Midi Monitor`

```
 $ aconnect 14:0 129:0
    $ aconnect 132:0 129:0 
```

如果您想获得准确的方向信息，您可以添加另一个仅连接到其中一个端口的 GMidiMonitor 实例。丢失的消息来自另一个端口。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-29T22:47:12.903

使用 gmidimonitor 怎么样？见[http://home.gna.org/gmidimonitor/](http://home.gna.org/gmidimonitor/)

# django - Django admin：如何从 GET 变量中填充新对象？

> ID：10219494
> 
> 赞同：2
> 
> 时间：2012-04-18T23:18:15.383
> 
> 标签：django, django-admin

在 Django 的管理员中，我看到了如何使用 GET 变量设置“添加对象”表单的字段（例如`/admin/app/model/add?title=lol`，将“标题”字段设置为“大声笑”）。

但是，我希望能够做一些事情，`/admin/app/model/add?key=18`并从另一个模型的实例中为我的字段加载默认数据。理想情况下，我还希望能够对填充表单的值进行一些处理。我该怎么做呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-23T16:44:58.667

我设法弄清楚了。值得庆幸的是，Django 允许您替换 a`request`的`GET`dict（它用于预填充管理表单）。以下对我有用：

```
class ArticleAdmin(admin.ModelAdmin):
    # ...

    def add_view(self, request, form_url='', extra_context=None):
        source_id = request.GET.get('source', None)
        if source_id is not None:
            source = FeedPost.objects.get(id=source_id)
            # any extra processing can go here...
            g = request.GET.copy()
            g.update({
                'title': source.title,
                'contents': source.description + u"... \n\n[" + source.url + "]",
            })
            request.GET = g

        return super(ArticleAdmin, self).add_view(request, form_url, extra_context) 
```

这样，我从[URL 参数](https://en.wikipedia.org/wiki/Query_string)`source`中获取对象，对它们做我想做的事，然后预填充表单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T05:05:03.733

您可以覆盖实例的方法`add_view`。`ModelAdmin`添加在此处获取对象，将对象设置`pk`为`None`并将该对象作为`instance`表单提供。带有的对象`pk == None`将始终作为新对象插入到表单的数据库中`save()`

# linux - TCP 的初始重传超时是多少？

> ID：10219496
> 
> 赞同：0
> 
> 时间：2012-04-18T23:18:43.697
> 
> 标签：linux, networking, tcp

我对 Linux 很感兴趣。我有一个客户端和一个服务器。假设客户端正在尝试连接到服务器（服务器已关闭）。什么是初始重传超时值？它会以指数方式退缩吗？

假设服务器现在正在尝试连接到客户端。服务器收到 SYN 数据包并发送一个 SYN ACK。但是客户死了。这种情况下的重传策略是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T02:40:32.463

> 什么是初始重传超时值？

它既依赖于平台，也依赖于配置。

> 它会以指数方式退缩吗？

TCP 中的所有重传都是这样做的。

> 这种情况下的重传策略是什么？

往上看。

# php - 什么事情会使 php 脚本变慢？

> ID：10219497
> 
> 赞同：-5
> 
> 时间：2012-04-18T23:18:52.367
> 
> 标签：php

我需要知道什么样的事情会使 php 脚本变慢。

像：

```
function test()
{
$out = 'cont';
$out .= 'cont2';
$out .= 'cont3';
return $out;
}
echo test(); 
```

或者

```
function test($t)
{
$out = ($t)?'v1':'v2';
return $out;
}
echo test(1); 
```

有什么链接可以找到吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:24:59.540

您的问题含糊不清，但您可以自己对它们进行基准测试：

```
$start = microtime(true);
// code you want to benchmark here
$diff = microtime(true) - $start;
echo "Code execution lasted $diff seconds"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:27:45.360

鉴于其通用性，回答这个问题并不简单，但让我试一试。

虽然您可以担心将双引号更改为单引号，不使用字符串连接等以及对其中的很多进行微优化，但通常长轮询是 DB 或 HTTP 请求（Web 服务等）

因此，您需要考虑缓存等（服务器端 PHP）。但这也会对如何破坏缓存等产生影响，这完全是一个不同的问题。

为了通常加速 PHP，您可以使用其中一种操作码缓存引擎，例如 APC。许多流行的网站，包括 Facebook、Yahoo！用它。

您可以使用 APD 或 Xdebug 来确定您的脚本在哪里花费时间。

如果您仍然担心 PHP 的性能并且不满意，您可以看看 Hip-Hop，或者通过扩展等将您的一些关键业务操作迁移到 C/C++。

如果您担心页面性能，80% 的问题出在前端，因此请尝试通过针对 YSlow、Google PageSpeed 等检查您的页面来优化您的 HTML、CSS 和 JavaScript。

希望有帮助。

# gwt - Ext-GWT 文本旋转在 Internet Explorer 8 中不起作用

> ID：10219501
> 
> 赞同：1
> 
> 时间：2012-04-18T23:19:23.433
> 
> 标签：gwt, extjs, gxt

我正在使用 Ext-GWT 3.0 版（特别是 3.0.0-rc），并试图通过 TextSprite 旋转一些文本。它在 Google Chrome 中运行良好，但在 Internet Explorer 8 中运行良好。

Java源码：

```
import com.google.gwt.core.client.EntryPoint;
import com.google.gwt.user.client.ui.RootPanel;
import com.sencha.gxt.chart.client.draw.DrawComponent;
import com.sencha.gxt.chart.client.draw.sprite.TextSprite;
import com.sencha.gxt.widget.core.client.container.Viewport;

public class TextRotation implements EntryPoint {
    public void onModuleLoad() {
        TextSprite sprite = new TextSprite("Some text");
        sprite.setRotation(270);
        DrawComponent component = new DrawComponent();
        component.setViewBox(true);
        component.addSprite(sprite);
        Viewport vp = new Viewport();
        vp.add(component);
        RootPanel.get().add(vp);
    }
} 
```

使用 IE 开发人员工具导出生成的源代码会产生以下结果。正在创建文本组件，但似乎放置在可见区域之外：

```
<DIV style="WIDTH: 1268px; HEIGHT: 785px" class=GAOO-TBDNN>  <DIV style="WIDTH: 1268px; HEIGHT: 785px" __eventBits="100">
    <DIV style="WIDTH: 1268px; HEIGHT: 785px" class=x-vml-base>
      <?xml:namespace prefix = vml />
      <vml:shape style="Z-INDEX: 0" class="vml x-vml-sprite" coordsize = "21600,21600" filled = "t" fillcolor = "white" stroked = "f" path = " m0,0 l27388800,0,27388800,16956000,0,16956000 xe">
        <vml:skew class=vml on = "t" matrix = "935375f,0,0,935375f,0,0" offset = "34468954f,52315599f"></vml:skew>
        <vml:fill></vml:fill>
      </vml:shape>
      <vml:shape style="Z-INDEX: 10" class="vml x-vml-sprite" coordsize = "21600,21600" filled = "t" fillcolor = "black" stroked = "f" path = " m0,0 l1,0 e">
        <vml:skew class=vml on = "t" matrix = "0,935375f,-935376f,0,0,0" offset = "52315599f,-34468954f"></vml:skew>
        <vml:textpath style="LINE-HEIGHT: normal; FONT-VARIANT: normal; FONT-FAMILY: ; FONT-SIZE: 12px; v-text-align: left" class=vml on = "t" string = "Some text"></vml:textpath>
        <vml:path class=vml textpathok = "t"></vml:path>
        <vml:fill></vml:fill>
      </vml:shape>
    </DIV>
  </DIV>
</DIV>
<DIV style="POSITION: absolute; LINE-HEIGHT: normal; TEXT-TRANSFORM: none; FONT-STYLE: normal; FONT-FAMILY: null; LETTER-SPACING: normal; VISIBILITY: hidden; FONT-SIZE: 12px; TOP: -10000px; FONT-WEIGHT: 400; LEFT: -10000px"></DIV> 
```

如果我然后注释掉“sprite.setRotation(270);”行 非旋转文本显示正常。生成的 HTML 与上面完全相同，除了“skew”条目的值。区别如下：

```
10c10
<         <vml:skew class=vml on = "t" matrix = "935375f,0,0,935375f,0,0" offset = "34468954f,52315599f"></vml:skew>
---
>         <vml:skew class=vml on = "t" matrix = "1510899f,0,0,1510899f,0,0" offset = "1445363f,14325573f"></vml:skew>
14c14
<         <vml:skew class=vml on = "t" matrix = "0,935375f,-935376f,0,0,0" offset = "52315599f,-34468954f"></vml:skew>
---
>         <vml:skew class=vml on = "t" matrix = "1510899f,0,0,1510899f,0,0" offset = "1445363f,14325573f"></vml:skew> 
```

谷歌搜索，在 Sencha 论坛上检查过去的问题，这里没有给我任何线索。

谢谢。

# ruby-on-rails - 模型链接没有设置ID，这正常吗？

> ID：10219508
> 
> 赞同：0
> 
> 时间：2012-04-18T23:20:16.143
> 
> 标签：ruby-on-rails

我有三个模型：`User`, `Song`,`Album`

一个`User` `has_many :songs, :albums`

一个`Song` `belongs_to :user, :album`

一个`Album` `belongs_to :user, has_many :songs`

当我执行以下操作时：

```
user = User.find(:first)
album = user.albums.find(:first)
album.songs.create(params) 
```

它可以正常工作并使用正确设置`Song`的外键创建一个新的`album_id`，但它不会将`user_id`歌曲设置为`User`创建它的人。这是正常的吗？我怎样才能创建一个新的`Song`并确保它同时应用`album_id`和`user_id`？

我想我可以让一个用户创建一个`Song`然后选择一个`Album`来添加它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T02:01:13.990

那里没有与用户的链接。您实例化了一个为该用户设置了 user_id 的专辑对象，但这并不意味着 ActiveRecord 会自动将确切的 user_id 设置为为该专辑创建的歌曲。对于大多数应用程序来说，这确实是出乎意料的行为。

在您的情况下，您可以将用户传递给 create 方法

就像是：

```
album.songs.create(params.merge({:user => user})) 
```

无论如何，这听起来应该重构。您在哪里调用该代码，是在歌曲创建操作中吗？您从请求中获得的确切参数是哪些，为什么不使用 params[:song] 创建属性？

# java - 安装tomcat和java并在浏览器中运行jsp

> ID：10219510
> 
> 赞同：2
> 
> 时间：2012-04-18T23:20:20.823
> 
> 标签：java, jsp, tomcat, servlets

很长一段时间以来，我一直在 LAMP 堆栈中工作。但是现在我需要在 java、jsp 和 servlets（Tomcat 服务器）中工作，我以前从未在 java、jsp 中工作过。所以我需要一些帮助来设置我的笔记本电脑中的东西，以便我可以在我的浏览器中执行 java 和 jsp 脚本。我知道网络上有许多提供教程的链接。但是有人可以指出我的一个很好的地方，它显示了所有的步骤：例如：

安装 Tomcat

安装java

在浏览器中编译、构建、测试 java、jsp、servlet

或其他任何可以帮助我开始学习并学习开发 Web 应用程序的正确方法的方法

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T23:30:11.427

我认为[Lars Vogel 的这篇教程](http://www.vogella.com/articles/EclipseWTP/article.html)是一个全面的教程，并且是最新的。

唯一没有涉及的是“安装java”，这应该是你的第一步。本文可以帮助您[熟悉](http://javarevisited.blogspot.com.es/2011/12/jre-jvm-jdk-jit-in-java-programming.html)JDK、JRE、JVM 等。

# java - 将我所有的 JComponents 转换为 AWT 组件是否值得？

> ID：10219515
> 
> 赞同：0
> 
> 时间：2012-04-18T23:20:47.483
> 
> 标签：java, swing, awt, jpanel, jcomponent

我有一个相对较大的程序，我正在处理它大约完成了一半。到目前为止，我用于图形的只是 JFrame、JPanel 和无数的 JComponent。将来，我会在屏幕上绘制真正的 2D 或 3D 图像，但现在我所做的只是 GUI 和标题/游戏屏幕。我刚刚意识到有两个图形类别称为 SWING 和 AWT，我查看了一些 AWT 代码，它看起来与我一直使用的有点不同。您认为，我应该尝试将所有代码转换为 AWT 格式还是保持原样？感谢您的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T00:16:20.687

AWT 实际上是有点过时的原生依赖 GUI。它有很多问题（包括性能），并且在所有各种平台上都表现不佳。

最好的方法是使用[Swing](http://docs.oracle.com/javase/tutorial/uiswing/)、[JavaFX](http://javafx.com/)或[SWT](http://www.eclipse.org/swt/)在 Java 上创建丰富的桌面应用程序。每个都有很多优点和缺点 - 需要一年的时间来讲述所有这些。最好的方法是观看一些示例和演示，然后确定最适合您的方式。

我已经为自己决定 Swing 是目前最好和最稳定的 GUI 平台。在您的情况下，Swing 或 JavaFX 可能是最好的，因为有很多可能使用 2D/3D 图形。

# android - 下载完成时大小错误 - eclipse 和 android

> ID：10219519
> 
> 赞同：1
> 
> 时间：2012-04-18T23:21:17.690
> 
> 标签：android, eclipse

下载 XOOM2ME，Android API 13，修订版 2 下载完成时大小错误。预期 122780710 字节，得到 974 字节。

下载适用于平板电脑的 OpenSense SDK，Android API 12，修订版 2 下载完成但大小错误。预期 3789731 字节，得到 94 字节。

下载适用于手机的 OpenSense SDK，Android API 10，修订版 2 下载完成但大小错误。预期 7170813 字节，得到 93 字节

我得到了这三个错误。没有网络断开。

面向 Java 开发人员的 Eclipse IDE

版本：Indigo Service Release 2

Java SE 6

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:40:54.987

没必要刻薄。如果您无法下载完成工作所需的工具，这显然与编程有关。

该线程表明您可能有用户名/密码问题，因为 93 字节的结果似乎意味着用户名/密码错误。[http://code.google.com/p/android/issues/detail?id=25294](http://code.google.com/p/android/issues/detail?id=25294)

因此，请确保您的帐户已设置，并且您已输入登录信息以在下载过程中使用。应该会弹出一个对话框供您在下载过程中输入信息。

仍在试图弄清楚我的 91 和 92 字节结果意味着什么……祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-06T02:16:14.817

这意味着您的互联网连接速度不快或数据丢失。

尝试使用下载管理器直接下载。

下载来自谷歌的平台和api。

1.  打开 SDK 管理器

将第一个状态栏地址复制到浏览器 [https://dl-ssl.google.com/android/repository/repository-7.xml](https://dl-ssl.google.com/android/repository/repository-7.xml)或 http

1.  下载其他厂家的api

SDK 管理器 > 工具 > 管理附加站点

将需要的地址复制到浏览器

并找到您的软件包下载地址。

1.  如果地址只是一个文件名 Like(android-3.0-windows.zip) 将文件名替换为地址栏中 apis 的 xml 文件 Like (dl-ssl.google.com/android/repository/repository-7.xml) 到[http ://dl-ssl.google.com/android/repository/android-3.0-windows.zip](http://dl-ssl.google.com/android/repository/android-3.0-windows.zip)

2.  **确保协议不是 https**

下载文件。

接下来在 android 安装目录 (C:\Program Files (x86)\Android\android-sdk) 中创建一个文件夹并将其重命名为“temp”。将下载的 zip 文件放入 temp 文件夹并尝试使用 SDK Manager 安装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T13:40:01.687

正如 amac123 发布的那样，每个人都有问题：[http ://code.google.com/p/android/issues/detail?id=25294](http://code.google.com/p/android/issues/detail?id=25294)

我在推特上发布了@HTCDev，并一直在向他们提供更多信息： [https ://twitter.com/#!/JaredBanyard/status/192717262912892928](https://twitter.com/#!/JaredBanyard/status/192717262912892928)

我在等着回音..会让你们更新。你可以在@JaredBanyard 关注我

[编辑] 好的，您现在应该可以访问 SDK。它会要求您输入用户名和密码。[只需使用来自http://www.htcdev.com](http://www.htcdev.com)的用户名/密码.. 如果您没有，请注册！

享受！[/编辑]

# ios - CSS3 下拉菜单和 iOS 问题

> ID：10219524
> 
> 赞同：1
> 
> 时间：2012-04-18T23:21:49.620
> 
> 标签：ios, css, css-transitions

我正在尝试使用一些 CSS3 过渡制作下拉导航菜单。但是，当使用可见性隐藏/可见时，iOS 不会显示下拉菜单（它只是转到链接）。如果我使用 display none/block，iOS 将在第一次单击父元素时显示下拉菜单，但转换在任何浏览器中都不起作用。

有没有办法让这些转换在浏览器中正常运行，并且下拉菜单在 iOS 中工作而不使用 javascript？

下拉在 iOS 中不起作用：

```
nav ul li ul {
    position: absolute; visibility: hidden; opacity: 0; left: 0; top: 50px; z-index: 99;
    -webkit-transition: all .35s ease-in-out;
    -moz-transition: all .25s ease-in-out;
    -o-transition: all .35s ease-in-out;
    -ms-transition: all .35s ease-in-out;
    transition: all .35s ease-in-out;
}
nav ul li:hover > ul { visibility: visible; opacity: 1; top: 40px; } 
```

转换在浏览器中不起作用：

```
nav ul li ul {
    position: absolute; display: none; opacity: 0; left: 0; top: 50px; z-index: 99;
    -webkit-transition: opacity .35s ease-in-out, top .35s ease-in-out;
    -moz-transition: opacity .35s ease-in-out, top .35s ease-in-out;
    -o-transition: opacity .35s ease-in-out, top .35s ease-in-out;
    -ms-transition: opacity .35s ease-in-out, top .35s ease-in-out;
    transition: opacity .35s ease-in-out, top .35s ease-in-out;
}
nav ul li:hover > ul { display: block; opacity: 1; top: 40px; } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:51:02.333

在考虑了更多之后，我发现了我以前从未见过的文档-您遇到的一些奇怪之处可能是因为您将行为附加到默认情况下不具有交互性的伪元素上（仅锚点和表单元素是可点击的）。

[http://sitr.us/2011/07/28/how-mobile-safari-emulates-mouse-events.html](https://sitr.us/2011/07/28/how-mobile-safari-emulates-mouse-events.html)

（忽略我对 event.preventDefault 的原始评论...我忘记了您使用的是列表项而不是锚点。）

但是，我仍然认为 JS 是最好的方法，因为您可以非常具体地了解附加到任何类型元素的事件。您可以只应用一个 CSS 类，它将使用您已经指定的过渡属性。

像这样：

```
// CSS
nav ul li > ul.visible { display: block; opacity: 1; top: 40px; }

// JS
// you could bind mouseover/out here too if you want it to work on both desktop & mobile
$('nav ul li').bind('click', function(){
    $(this).children('ul').toggleClass('visible');
}); 
```

如果您想变得更加出色，可以通过添加`tabIndex="0"`到列表项来使其键盘可访问:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-25T04:22:46.797

我找到了解决方案。本质上，ios不会将点击绑定到任何显示：块/无或可见性：隐藏/可见的悬停。因此，您只需使用“左”“隐藏”下拉菜单来补偿不支持不透明度的 <=ie8。

所以基本上使用你的第二个例子做一个小的调整：

```
nav ul li ul {
    position: absolute; opacity: 0; left: -888em; top: 50px; z-index: 99;
    -webkit-transition: opacity .35s ease-in-out, top .35s ease-in-out;
    -moz-transition: opacity .35s ease-in-out, top .35s ease-in-out;
    -o-transition: opacity .35s ease-in-out, top .35s ease-in-out;
    -ms-transition: opacity .35s ease-in-out, top .35s ease-in-out;
    transition: opacity .35s ease-in-out, top .35s ease-in-out;
}
nav ul li:hover > ul {opacity: 1; top: 40px; left:0;} 
```

然后确保不要在过渡中使用“全部”，否则它也会为 left 属性设置动画:) 这种方法的唯一问题是你的过渡只会在途中而不是出路中起作用。

# php - php 模板文件使用另一个 php 配置？

> ID：10219525
> 
> 赞同：2
> 
> 时间：2012-04-18T23:21:49.953
> 
> 标签：php, template-engine

我使用 php 已有 10 多年了，有时（主要是在早期）我也将它用作模板引擎。现在我想知道我是否可以再次这样做，但我有一个条件：

我需要加载一个非常不同的 php.ini，然后为这些模板文件使用尽可能少的功能。也许像 ini_set_all(file) 这样的函数可以做到，但可能很慢。为 *.phpt 左右使用不同的 php ini 也不应该那么容易。对此有什么想法吗？

是的，我知道并使用过 smarty、twig 等引擎，但目标是使用普通的 php 和它提供的语言元素，也许还有更多，但不使用 php 解析模板文件以生成自动机，数组、php 文件或其他任何内容。

更新：我的想法可能是使用不同的 ini 设置打开/关闭 php 模板模式，这可能会扩展以下 rfc：[https ://wiki.php.net/rfc/nophptags](https://wiki.php.net/rfc/nophptags)

谢谢你的想法:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-22T19:25:51.317

这完全没有意义。

哦，是的，这也是不可能的。

事实上，你只有两个选择：

如果模板打算由不允许使用代码的站点用户编辑 - 使用一些模板引擎，如 Smarty 或 Twig（无论如何都需要进行一些调整，因为这些模板实际上由两部分组成 - 模板部分和模板处理程序代码部分 - 它仍然是可行的）。
否则使用一般设置的 PHP，它会很顺利。

# java - 转换数组列表类型

> ID：10219527
> 
> 赞同：-1
> 
> 时间：2012-04-18T23:22:03.730
> 
> 标签：java, arraylist

我有一个`Line`包含内部的类`ArrayList<Double>`。在我的程序中，我有一个`ArrayList<Line>`包含许多对象的`Line`对象。

在我的程序中，我希望能够创建一个新的`ArrayList<Double>`，其中包含my 中`ArrayList<Double>`所有`Line`s的内容`ArrayList<Line>`。是否有捷径可寻？

这是我的代码...

```
class Line {
    ArrayList<Double> values;

    line() {
        values = new ArrayList<Double>();
    }

public class Calucating{
    ArrayList<Line> lineY = new ArrayList<Line>();

    // Adding lines in here...

    // Now I want to add the contents of each Line into a single ArrayList<Double>
    ArrayList<Double> lineNewY=new ArrayList<Double>;
} 
```

我怎样才能轻松地将我所有的内容`Line`合并到一个单一的 s中`ArrayList<Double>`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:41:24.903

因此，您有一个行数组，每行包含一个双精度数组，并且您希望获得一个大型双精度数组，其中包含行中所有数组中的所有双精度数。

```
class Line {
    ArrayList<Double> values = new ArrayList<Double>();
}

public class Calculating {
    ArrayList<Line> lineY = new ArrayList<Line>();

    void someMethod() {
        ArrayList<Double> lineNewY = new ArrayList<Double>;
        for( Line line : lineY )
            lineNewY.addAll( line.values );

        // lineNewY now has all the doubles
    }
} 
```

# ruby-on-rails - 使用 rails 时仅在某些页面中使用 emberjs 是个好主意吗？

> ID：10219529
> 
> 赞同：0
> 
> 时间：2012-04-18T23:22:08.797
> 
> 标签：ruby-on-rails, ember.js

我有一个 Rails 应用程序，除了需要大量 JS 的两个页面外，它有相当标准的东西。

我想知道将 ember*仅*用于这两个页面同时保持 Rails 标准用于其他所有页面是否是一个不错的选择？或者我应该将 emberjs + rails 中的所有内容重写为 API 后端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T13:30:54.313

这确实是个案情况。为什么这两个页面需要大量的JS？答案可能是“因为您做出了实施决定”。添加 Ember 可能会促使您重新审视许多实施决策，以重新考虑哪些工具适合在哪些地方使用。

# scala - 在 SBT 中处理多个运行目标的最佳方法是什么？

> ID：10219530
> 
> 赞同：3
> 
> 时间：2012-04-18T23:22:52.380
> 
> 标签：scala, sbt

我正在尝试创建一个 Build.scala，它有多个项目/目标用于运行操作。我已经开始尝试将其定义为一个子项目，例如：

```
val this_one = Project(
    id = "Main",
    base = file(".")
    settings = ...
) 
```

我的第一个猜测是我的设置错误，或者配置不属于这样的项目定义。

详细说明一下，我有多个 main() 我想在单个源代码树中运行。主项目本身有几个工具，我希望能够从 sbt 控制台有选择地执行它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T23:08:22.980

事实证明，SBT 足够聪明，可以自己解决！如果您有多个带有 main() 的类，当您在 SBT 提示符下键入“run”时，它会给您一个选择！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-06T04:18:09.453

您可以使用 run-main 指定主类。就像是：

sbt“运行-main com.company.project.Main1”

sbt "运行-main com.company.project.Main2"

# python - 为什么我的 django 表单多对多字段给了我这个错误？

> ID：10219533
> 
> 赞同：0
> 
> 时间：2012-04-18T23:23:28.043
> 
> 标签：python, django

我强烈怀疑这归结为我需要更好地理解一些语言结构，但我不知道从哪里开始，所以我只需要扔掉一些代码。

楷模：

```
class BlogTag(models.Model):
    tag = models.CharField(max_length=255)

    def __unicode__(self):
        return self.tag

class BlogEntry(models.Model):
    title = models.CharField(max_length=255)
    body = models.TextField()
    date = models.DateTimeField()
    tags = models.ManyToManyField(BlogTag)

    def __unicode__(self):
        return self.title 
```

形式：

```
class BlogForm(ModelForm):
    class Meta:
        model = BlogEntry 
```

看法：

```
title='New Blog Entry'
if request.method=='POST':
    form=BlogForm(request.POST)
    if form.is_valid():
        cd=form.cleaned_data
        blogEntry=BlogEntry(**cd)
        blogEntry.save()
else:
    form=BlogForm();
return render_to_response('blog_add.html', locals()) 
```

通过使用**cd，我能够将清理后的数据直接放入我的对象中，这显然是可取的，因为这样视图与其他对象松散耦合——我可以更改模型，而其他一切都随着它而改变，而无需我不得不做一件事。

不幸的是，我收到一个错误：

```
'tags' is an invalid keyword argument for this function 
```

我总是可以分解 CD 并构建 blogEntry=BlogEntry(title=cd['title']...) 的手动字典方法，然后一个一个添加标签，但是...我应该有更好的选择除此之外，我只是不知道它们是什么:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:21:18.450

我认为归结为`**cd`将参数作为字典传递。`BlogEntry`期待一个`BlogTag`类型，`tags`而不是您将字典参数传递给它，该参数不是正确的类型。首先创建一个`BlogTag`对象，然后将其传递给`BlogEntry`

这可能会有所帮助[http://anubis.blasux.ru/books/Python/www.djangoproject.com/documentation/0.96/models/many_to_many/](http://anubis.blasux.ru/books/Python/www.djangoproject.com/documentation/0.96/models/many_to_many/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T00:49:08.067

[https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#the-save-method](https://docs.djangoproject.com/en/dev/topics/forms/modelforms/#the-save-method)

```
if request.method == 'POST':
    form = BlogForm(request.POST)

    if form.is_valid():
        blogEntry = form.save()
        # redirect ..

else:
    form = BlogForm()

context = {
    "form": form,
    # ...
}
return render_to_response('blog_add.html', context) 
```

PS，`locals()`是不好的形式和[http://www.python.org/dev/peps/pep-0008/](http://www.python.org/dev/peps/pep-0008/)

# django - 具有多个模型的 Django ListView

> ID：10219539
> 
> 赞同：1
> 
> 时间：2012-04-18T23:23:56.107
> 
> 标签：django, django-models, django-views

**如何创建从我的 model.py 文件调用多个类/模型的列表视图？**

我已经创建了我的项目、应用程序和模型。这些模型使用一对多的关系。

我能够基于调用单个模型创建一个列表视图，但不能使用多个模型（在本场景中为 7 个模型）。

这是我要调用的模型，我希望在列表视图中显示的所需模型值用 ** 表示：

```
class TypeAchievement(models.Model):
  typeAchievementID = models.AutoField(primary_key=True, db_column="TypeAchievementID")
  languageCodeID = models.ForeignKey(LanguageCode, db_column="LanguageCodeID")
  **typeAchievementDescriptionIntl = models.CharField(max_length=255, db_column="TypeAchievementDescriptionIntl")**
  typeAchievementDescriptionEng = models.CharField(max_length=255, db_column="TypeAchievementDescriptionEng")
  typeAchievementAltID = models.IntegerField(db_column="TypeAchievementAltID")
  class Meta:
    db_table="TypeAchievement"

class RIAchievement(models.Model):
  riAchievementID = models.AutoField(primary_key=True, db_column="RIAchievementID")
  userLanguageVersionID = models.ForeignKey(UserLanguageVersion, db_column="UserLanguageVersionID")
  typeAchievementID = models.ForeignKey(TypeAchievement, db_column="TypeAchievementID")
  **riAchievementTypeUserDescription = models.CharField(max_length=255, blank=True, null=True, db_column="RIAchievementTypeUserDescription")**
  **riAchievementDescription = models.TextField(max_length=2000, db_column="RIAchievementDescription")**
  auth_user_id = models.ForeignKey(auth_user, db_column="auth_user_id")
  class Meta:
    db_table="RIAchievement"

class UserLanguageVersion(models.Model):
  userLanguageVersionID = models.AutoField(primary_key=True, db_column="UserLanguageVersionID")
  auth_user_id = models.ForeignKey(auth_user, db_column="auth_user_id")
  languageCodeID = models.ForeignKey(LanguageCode, db_column="LanguageCodeID")
  class Meta:
    db_table="UserLanguageVersion"

class auth_user(models.Model):
  **auth_user_id = models.AutoField(primary_key=True, db_column="id")**
  username = models.CharField(max_length=30, unique=True, db_column="username")
  first_name = models.CharField(max_length=30, db_column="first_name")
  last_name = models.CharField(max_length=30, db_column="last_name")
  email = models.CharField(max_length=75, db_column="email")
  password = models.CharField(max_length=128, db_column="password")
  is_staff = models.BooleanField(db_column="is_staff")
  is_active = models.BooleanField(db_column="is_active")
  is_supervisor = models.BooleanField(db_column="is_supervisor")
  last_login = models.DateTimeField(db_column="last_login")
  date_joined = models.DateTimeField(db_column="date_joined")
  class Meta:
    db_table="auth_user"

class LanguageCode(models.Model):
  languagecodeID = models.AutoField(primary_key=True, db_column="LanguageCodeID")
  **languageCodeDescription = models.CharField(max_length=10, db_column="LanguageCodeDescription")**
  baseLanguageCode = models.CharField(max_length=10, db_column="BaseLanguageCode")
  languageNameEng = models.CharField(max_length=255, db_column="LanguageNameEng")
  altLanguageNameEng = models.CharField(max_length=255, blank=True, null=True, db_column="AltLanguageNameEng")
  **languageNameNative = models.CharField(max_length=255, db_column="LanguageNameNative")**
  altLanguageNameNative = models.CharField(max_length=255, blank=True, null=True, db_column="AltLanguageNameNative")
  **iso639_1 = models.CharField(max_length=10, blank=True, null=True, db_column="ISO639_1")**
  iso639_2T = models.CharField(max_length=10, db_column="ISO639_2T")
  iso639_2B = models.CharField(max_length=10, db_column="ISO639_2B")
  iso639_X = models.CharField(max_length=10, db_column="ISO639_X")
  languageDirectionID = models.ForeignKey(LanguageDirection, default=1, db_column="LanguageDirectionID")
  class Meta:
    db_table="LanguageCode"

class LanguageDirection(models.Model):
  languageDirectionID = models.AutoField(primary_key=True, db_column="LanguageDirectionID")
  **languageDirectionDescription = models.CharField(max_length=20, db_column="LanguageDirectionDescription")**
  **languageDirDescription = models.CharField(max_length=20, db_column="LanguageDirDescription")**
  **textAlign = models.CharField(max_length=20, db_column="TextAlign")**
  **oppositeLanguageDirectionDescription = models.CharField(max_length=20, db_column="OppositeLanguageDirectionDescription")**
  **oppositeLanguageDirDescription = models.CharField(max_length=20, db_column="OppositeLanguageDirDescription")**
  **oppositeTextAlign = models.CharField(max_length=20, db_column="OppositeTextAlign")**
  class Meta:
    db_table="LanguageDirection"

class Flag(models.Model):
  flagID = models.AutoField(primary_key=True, db_column="FlagID")
  languageCodeID = models.ForeignKey(LanguageCode, db_column="LanguageCodeID")
  **flagIconPath = models.CharField(max_length=255, db_column="FlagIconPath")**
  flagDescription = models.CharField(max_length=255, db_column="FlagDescription")
  flagInformation = models.CharField(max_length=255, db_column="FlagInformation")
  class Meta:
    db_table="Flag" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T05:02:13.407

您可以从主对象获取链接对象。在您的情况下 - 遍历列表`RIAchievement`并获取其他数据`{{ riachievement.userLanguageVersionID.languageCodeID.languageDirectionID.textAlign }}`

PS 另外，请[根据 pep8](http://www.python.org/dev/peps/pep-0008/)格式化代码，即使它是从数据库自动生成的。

# sql - 1部分案例条款无法正常工作

> ID：10219540
> 
> 赞同：-1
> 
> 时间：2012-04-18T23:23:57.340
> 
> 标签：sql, tsql, date, time, case

我在使用案例条款时遇到了一些麻烦。问题出在以 DueBeyond 结尾的最后一部分，我需要这个来返回我们系统中明天之后到期的任何订单，如从今天起 2 天。抱歉太明显了。

```
SUM(CASE WHEN CURRENT_TIMESTAMP > oi.RequiredByDate THEN 1 ELSE 0 END) as PastDue
,SUM(CASE WHEN DATEADD(dd, DATEDIFF(dd, 0, oi.RequiredByDate), 0) = dateadd(day,     datediff(day, '19000101',CURRENT_TIMESTAMP),'19000102') then 1 ELSE 0 END) as DueTomorrow
,SUM(CASE WHEN dbo.TruncateDate(CURRENT_TIMESTAMP) = dbo.TruncateDate(oi.RequiredByDate) THEN 1 Else 0 END) as DueToday
,SUM(CASE WHEN DateDiff(day, getdate(), RequiredByDate) BETWEEN 2 and 7 AND DateName(weekday, RequiredByDate) = 'Monday' Then 1 ELSE 0 END) as DueMonday
,SUM(CASE WHEN dbo.TruncateDate(CURRENT_TIMESTAMP) <= dbo.TruncateDate(oi.RequiredByDate) THEN 1 ELSE 0 END) as DueBeyond 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:45:26.490

如果您在当前日期上加上两天，然后查看该日期是否仍小于或等于您要求的日期，则它必须不早于未来两天。

```
,SUM(CASE WHEN DATEADD(DAY, 2,dbo.TruncateDate(CURRENT_TIMESTAMP)) <= 
     dbo.TruncateDate(oi.RequiredByDate) THEN 1 ELSE 0 END) as DueBeyond 
```

# alfresco - 是否可以在 Alfresco Share 中隐藏 Mime 类型和标签？

> ID：10219543
> 
> 赞同：0
> 
> 时间：2012-04-18T23:24:22.153
> 
> 标签：alfresco

我们不希望我们的用户在更改文档属性时编辑 Mime 类型和标签。有没有办法在 Alfresco Share 中隐藏它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T05:48:08.790

`share-config-custom.xml`您可以通过具有适当[`field-visibility`设置](http://docs.alfresco.com/3.4/index.jsp?topic=/com.alfresco.Enterprise_3_4_0.doc/tasks/forms-type-display.html)的文件来配置元数据属性的可见性。就像是：

```
<config evaluator="node-type" condition="cm:content">
   <forms>
      <form>
         <field-visibility>
            <hide id="mimetype" for-mode="edit" />
            <hide id="cm:taggable" for-mode="edit" />
         </field-visibility>
      </form>
   </forms>
</config> 
```

# jquery - 一键点击两个链接

> ID：10219544
> 
> 赞同：0
> 
> 时间：2012-04-18T23:24:33.100
> 
> 标签：jquery, bind

我正在尝试编写一些 jquery 来允许我同时单击两个链接。我想同时点击#campaign 和#link32。到目前为止，我有这个代码......

```
$('#campaign').bind('click', function() {
    #link32);
}); 
```

它似乎不起作用。我确定我只是在搞砸一些简单的事情。任何人都可以帮忙。

谢谢，

内特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T23:27:57.467

您可以使用 trigger() 方法：>
[http://api.jquery.com/trigger/](http://api.jquery.com/trigger/)

```
 $('#campaign').click( function() {
        $("#link32").trigger("click");
    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:27:19.263

```
$("#campaign").click(function() {
  $("#link32").click();
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T23:27:58.683

这将是理论上的答案：

```
$('#campaign').bind('click', function() {
    $('#link32').click();
}); 
```

尽管大多数浏览器有意阻止此类活动作为安全预防措施。link32 是做什么的？让它的函数作为#campaign 函数的一部分作为 JS 运行。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-19T00:20:52.523

如果您想一次打开 2 个 URL，我会构建一个打开 2 个 URL 的函数，而不是尝试单击它们。

# python - 如何在对用户进行身份验证时指定 django 应该使用的数据库？

> ID：10219548
> 
> 赞同：0
> 
> 时间：2012-04-18T23:24:39.993
> 
> 标签：python, database, django

我想出了如何在辅助数据库中创建用户，但我不知道应该使用什么来让数据库在查看用户是否存在时使用辅助数据库而不是默认数据库，然后可以认证。

说我有：

```
user = authenticate(username=username, password=password) 
```

我如何告诉 django 使用名为 secondary 的数据库而不是使用默认数据库？

此外，我假设这些遵循相同的方法，但我将如何通过使用辅助数据库来使用 login() 或 logout()。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:15:59.343

authenticate 只需要凭据，并且是在您获得用户之前在后端调用身份验证的快捷方式：

[https://github.com/django/django/blob/master/django/contrib/auth/init **.py** #L39](https://github.com/django/django/blob/master/django/contrib/auth/__init__.py#L39)

假设您使用的是默认后端（[https://github.com/django/django/blob/master/django/contrib/auth/backends.py#L4](https://github.com/django/django/blob/master/django/contrib/auth/backends.py#L4)），则无法使用此后端并选择非我认为默认数据库。

```
from django.contrib.auth.backends import ModelBackend

class NonDefaultModelBackend(ModelBackend):
    """
    Authenticates against django.contrib.auth.models.User.
    Using SOMEOTHER db rather than the default
    """
    supports_inactive_user = True

    def authenticate(self, username=None, password=None):
        try:
            user = User.objects.using("SOMEOTHER").get(username=username)
            if user.check_password(password):
                return user
        except User.DoesNotExist:
            return None

    def get_user(self, user_id):
        try:
            return User.objects.using("SOMEOTHER").get(pk=user_id)
        except User.DoesNotExist:
            return None 
```

我认为这将为您提供与默认后端相同的行为，但使用非默认数据库。然后，您可以将后端添加到设置中或直接替换默认后端。

```
AUTHENTICATION_BACKENDS = (
    'path.to.mybackends.NonDefaultModelBackend', 
    'django.contrib.auth.backends.ModelBackend',) 
```

或者。

# c# - 为什么同一个函数做两件不同的事情？

> ID：10219549
> 
> 赞同：0
> 
> 时间：2012-04-18T23:24:48.327
> 
> 标签：c#, .net, winforms, .net-3.5

我是 C# 的业余爱好者，我不明白这里发生了什么。这不是一个真正的问题，因为我可以为它做一个快速修复，但我仍然想知道**为什么**。

*免责声明*：我知道这可能不是设计这个程序的最佳方式，但我得到了非常短的时间来开发它，我只是想在截止日期前发布它。

我的程序中有一个主窗体。当按下 2 个按钮中的 1 个时，此表单会调用第二个表单。这些按钮使用相同的功能打开第二种形式：

```
private void setupShow(int show)
    {
        fSetup setup = new fSetup(show);
        setup.Show();
        setup.FormClosed += new FormClosedEventHandler(setup_FormClosed);
    } 
```

当 button1 调用该函数时，它会隐藏主窗体并打开下一个窗体。但是，当第二个按钮调用该函数时，它会保持主窗体打开，但仍会打开第二个窗体。

那么可能是什么原因造成的呢？

*Button1 比 button2 有更多的代码，如果需要这些功能，我可以在这里发布它们，但它会填满大部分屏幕。*

编辑：

```
int show; 
```

只是我用于以第二种形式执行的函数的变量。就窗户关闭而言，它与任何事情都没有关系。

按钮 1：仅调用此功能。该函数插入数据库，然后获取该行的插入 ID 并将其传递给第二种形式

```
private void CheckFields()
    {
        OleDbCommand insertParty;
        OleDbDataAdapter partyAdapt = new OleDbDataAdapter();
        int nameL = PName.Text.Length;
        int newPartyID = 0;

        if (nameL > 0)
        {
            String test = "INSERT INTO Parties (PartyName, BackgroundImg) VALUES (?, ?)";

            insertParty = new OleDbCommand(test, Parties);
            insertParty.Parameters.AddWithValue("PartyName", PName.Text);
            insertParty.Parameters.AddWithValue("BackgroundImg", tBrowse.Text);

            Parties.Open();
            insertParty.ExecuteNonQuery();

            NewPartyForm.ActiveForm.Visible = false;

            OleDbCommand selectnewParty;
            OleDbDataAdapter newpartyAdaptr = new OleDbDataAdapter();
            String selectNew = "SELECT TOP 1 PartyID, PartyName FROM Parties ORDER BY PartyID DESC";
            selectnewParty = new OleDbCommand(selectNew, Parties);
            OleDbDataReader newReader = selectnewParty.ExecuteReader();

            while (newReader.Read())
            {
                newPartyID = newReader.GetInt32(0);
            }

            setupShow(newPartyID);
        }
        else
            MessageBox.Show("Please Create a Party Name");
    } 
```

按钮 2：从组合框中的字符串中截取整数并将其传递给第二种形式

```
private void bLoad_Click(object sender, EventArgs e)
    {
        Object selectedParty = cLoadP.SelectedItem;
        String sP = selectedParty.ToString();
        String d1 = " - ";
        char[] delim = d1.ToCharArray();
        String[]  numS = sP.Split(delim);

        setupShow(Convert.ToInt32(numS[0]));
    } 
```

就像我说的，这个代码是由一个业余爱好者开发的，而且速度非常快。这不是我通常做事的方式，但我没有太多时间去真正思考。哈哈

第二种形式的初始函数：

```
public fSetup(int partyID)
    {
        InitializeComponent();
        pID = partyID;
        lpID.Text += " " + pID.ToString();
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T23:53:01.670

我怀疑不同行为的原因是按钮 1 的代码中的这一行：

```
NewPartyForm.ActiveForm.Visible = false; 
```

按钮 2 的代码中没有类似的行。

# security - Solr 是否存储索引后文档的原始内容？

> ID：10219554
> 
> 赞同：2
> 
> 时间：2012-04-18T23:25:14.693
> 
> 标签：security, solr

如果我将一个字段标记为“不存储”，Solr 会在任何地方保留该字段的原始内容，还是只保留它为索引本身剔除的“词袋”？

我是从文件安全的角度来问的。如果有人破解了运行我们的 Solr 索引的机器，他们是否可以将原始文本传递给 Solr 的“不存储”字段？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T01:00:43.133

不，Solr 索引不会以任何可检索或可查看的方式存储设置为的字段的原始值`stored="false"`。[Solr wiki 上的Common Field 选项](http://wiki.apache.org/solr/SchemaXml#Common_field_options)说明了设置存储选项的以下行为。

> 如果字段的值在搜索期间应该是可检索的，则为真

如果有人侵入运行 Solr 索引的机器并根据上述内容运行 Solr 查询，他们将无法看到该字段的内容，因为 Solr 不会返回该字段。但是，如果他们可以访问磁盘以及 Lucene 编写的实际索引文件夹和分段文件，他们可以使用[Luke - Lucene Index Toolbox](http://code.google.com/p/luke/)检查索引文件夹来查看 Solr 为该字段中的每个文档存储的术语。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T15:18:07.710

当一个字段是 Storable.No 时，只存储足够的信息供 Lucene 执行搜索。

但是，如果在构造每个字段时指定 WITH_POSITIONS_OFFSETS，通常有足够的信息可以检索：

```
lowercase(EXACTSTRINGINDEXED) - LUCENEDELIMITERS - STOPWORDS 
```

例如，如果您索引：

```
Jerry&Mary's Live Bait and Yellow Cab 
```

使用将“&”和“'”视为分隔符、不索引单个字母并将“和”视为停用词的分析器，您会在索引中看到如下内容：

```
jerry mary live bait [null word] yellow cab 
```

*（如上所述，您可以通过 Luke 验证这一点。）*

# linux - 获取服务器运行状况的 Bash 脚本

> ID：10219555
> 
> 赞同：2
> 
> 时间：2012-04-18T23:25:39.163
> 
> 标签：linux, bash

我希望监视在服务器上运行的应用程序所必需的服务器场的某些方面。

基本上，我希望在每台机器上都有一个文件，当通过 http（在 vlan 上）使用 curl 访问该文件时，它将吐出我正在寻找的信息，我可以使用位于循环中的 dameon 登录数据库并一一检查所有服务器的健康状况。

我想要得到的信息是

```
<load>server load</load>
<free>md0 free space in MB</free>
<total>md0 total space in MB</total>
<processes># of nginx processes</processes>
<time>timestamp</time> 
```

最好的方法是什么？

编辑：我们正在使用 cacti 和 opennms，但是我在这里寻找的是在这些服务器上运行的应用程序所必需的数据。我不想让它依赖任何 3rd 方软件来获取这些可以通过一些 linux 命令获得的基本数据来使其复杂化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T03:32:40.950

创建一个 cron 条目：

*   每隔几分钟（或您想要的任何频率）执行一个 shell 脚本
*   将输出保存在 Web 服务器发布的目录中

假设您的文本确实是您想要的，这将使您达到 90% 的目标：

```
#!/usr/bin/env bash

LOAD=$(uptime | cut -d: -f5 | cut -d, -f1)
FREE=$(df -m / | tail -1 | awk '{ print $4 }')
TOTAL=$(df -m / | tail -1 | awk '{ print $2 }')
PROCESSES=$(ps aux | grep [n]ginx | wc -l)
TIME=$(date)

cat <<-EOF
<load>$LOAD</load>
<free>$FREE</free>
<total>$TOTAL</total>
<processes>$PROCESSES</processes>
<time>$TIME</time>
EOF 
```

样本输出：

```
<load> 0.05</load>
<free>9988</free>
<total>13845</total>
<processes>6</processes>
<time>Wed Apr 18 22:14:35 CDT 2012</time> 
```

# alfresco - 当 Alfresco 中的内容发生变化时，如何发送 JMS 消息？

> ID：10219556
> 
> 赞同：0
> 
> 时间：2012-04-18T23:25:41.407
> 
> 标签：alfresco

因此，当一条内容发生更改（添加、编辑或删除）时，我需要向 JMS 服务器发送一条带有文档 ID 的消息。

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T05:08:42.157

自定义行为应该可以解决问题。以 Alfresco中日​​历事件的 [电子邮件通知](https://stackoverflow.com/questions/9906592/email-notifications-on-calendar-events-in-alfresco/9907448)`onCreateNode`为例。更新和删除的工作方式类似。

假设 JNDI 设置正确，查找 JMS 队列/主题并创建/发送消息。

# php - 带有必填字段的 html 表单

> ID：10219557
> 
> 赞同：3
> 
> 时间：2012-04-18T23:25:58.363
> 
> 标签：php, forms

我有一个当前正在工作的表单，但想将 php 代码添加到“发布”文件中，因此需要 html 表单中的某些字段，否则会显示一条消息。

继承人我的 html 代码此刻。

```
<form action="contact.php" method="post">
      <input type="text" class="main" name="cf_name" value="Name (Required)" size="31" />
      <br />
      <br />
      <input type="text" class="main" name="cf_company" value="Company" size="31" />
      <br />
      <br />
      <input type="text" class="main" name="cf_phone" value="Phone (Required)" size="31" />
      <br />
      <br />
      <input type="text" class="main" name="cf_email" value="Email (Required)" size="31" />
      <br />
      <br />
    <textarea type="text" name="cf_text0" cols="34" rows="3" class="main">Message</textarea>
      <br />
      <input type="image" src="images/send.jpg" height="16" width="41" border="0"
      alt="Submit Form" />
</form> 
```

这是我的php代码

```
<?php
$field_name = $_POST['cf_name'];
$field_company = $_POST['cf_company'];
$field_phone = $_POST['cf_phone'];
$field_email = $_POST['cf_email'];
$field_message = array($_POST["cf_text0"],);

$mail_to = 'callum@colmandesigns.co.nz';
$subject = 'A & J Print - Contact Form '.$field_name;

$field_message="From: {$field_name}
Company: {$field_company}
Phone: {$field_phone}
Email: {$field_email}
Message: {$field_message[0]}";

$headers = 'From: '.$field_email."\r\n";
$headers .= 'Reply-To: '.$field_email."\r\n";

$mail_status = mail($mail_to, $subject, $field_message, $headers);

if ($mail_status) { ?>
    <script language="javascript" type="text/javascript">
        alert('Thank you for the message. We will contact you shortly.');
        window.location = 'index.html';
    </script>
<?php
}
else { ?>
    <script language="javascript" type="text/javascript">
        alert('Message failed. Please, send an email to craig@colmandesigns.co.nz');
        window.location = 'index.html';
    </script>
<?php
}
?> 
```

我想要填写姓名、电话和电子邮件字段。

谢谢，卡勒姆

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T05:09:29.703

在 HTML 中，您只需添加“必需”属性即可使输入标签成为必需！例如

```
<input type="text" id="someId" name="IP" placeholder="IP" required tabindex="1"> 
```

或者

```
<input type="text" id="someId" name="IP" placeholder="IP" required="true" tabindex="1"> 
```

但是考虑到，IE 和 Safari 直到现在才支持这个标签！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T23:32:09.117

**使用 PHP：**

```
//Form Processor Code

$filled = true;
$required = array("cf_name", "cf_email", "cf_phone"); //all the required fields

//Cycle through each field and make sure its filled
foreach ($required as &$value) {
    if(!isset($_POST[$value])){$filled=false;}
}

//If there are any fields not filled out, send the user back to the form
if (!$filled){
    header("Location: http://mysite.com/form.php?error=true");
}

//Form Code

//Notify the user that the form needs to be filled completely
if(isset($_GET['error'])){
    echo "Sorry, but the form was not properly filled out.";
} 
```

这样做的问题是您需要在返回之前将表单值存储在会话中，否则用户将不得不重新输入整个表单。如果您使用 Javascript，对用户来说会更好，但要注意禁用 JS 的浏览器。

**使用 Javascript：**

要么使用

```
onBlur 
```

当用户完成输入字段或使用

```
onClick 
```

当用户尝试提交表单时。

可以在[这里](http://www.developertutorials.com/tutorials/javascript/javascript-form-validation-correction-050412-1290/)找到一个很好的教程。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T01:24:13.650

//contact.php

```
<?php
    $filled = true;
    $required = array("cf_name", "cf_email", "cf_phone"); //all the required fields

    //Cycle through each field and make sure its filled

    foreach ($required as &$value) {

        if($_POST[$value]==""){
            $filled = false;
        }
    }

    //If there are any fields not filled out, send the user back to the form
    if (!$filled){
        header("Location: http://ajprint.co.nz/index.php?error=true"); 
    }

    else{
        $field_name = $_POST['cf_name'];
        $field_company = $_POST['cf_company'];
        $field_phone = $_POST['cf_phone'];
        $field_email = $_POST['cf_email'];
        $field_message = array($_POST["cf_text0"],);

        $mail_to = ''; //put your email
        $subject = 'A & J Print - Contact Form '.$field_name;

        $field_message="From: {$field_name}
        Company: {$field_company}
        Phone: {$field_phone}
        Email: {$field_email}
        Message: {$field_message[0]}";

        $headers = 'From: '.$field_email."\r\n";
        $headers .= 'Reply-To: '.$field_email."\r\n";

        $mail_status = mail($mail_to, $subject, $field_message, $headers);

        if ($mail_status) { 
            echo "
                <script language=\"javascript\" type=\"text/javascript\">
                    alert('Thank you for the message. We will contact you shortly.');
                    window.location = 'index.html';
                </script>";    
        }

        else {
            echo "
                <script language=\"javascript\" type=\"text/javascript\">
                    alert('Message failed. Please, send an email to craig@colmandesigns.co.nz');
                    window.location = 'index.html';
                </script>";
        }
    }

?> 
```

//index.php

```
<form action="handler.php" method="post">
    <input type="text" class="main" name="cf_name" placeholder="Name (Required)" size="31" />
        <br />
        <br />
    <input type="text" class="main" name="cf_company" placeholder="Company" size="31" />
        <br />
        <br />
    <input type="text" class="main" name="cf_phone" placeholder="Phone (Required)" size="31" />
        <br />
        <br />
    <input type="text" class="main" name="cf_email" placeholder="Email (Required)" size="31" />
        <br />
        <br />
    <textarea type="text" name="cf_text0" cols="34" rows="3" class="main">Message</textarea>
        <br />
    <input type="image" src="images/send.jpg" height="16" width="41" border="0" alt="Submit Form" />
</form> 
```

我用“占位符”替换了所有“值”标签，这样即使用户没有清除该字段，它也不会被标记为已填充

# mysql - 比较mysql中的时间戳

> ID：10219559
> 
> 赞同：0
> 
> 时间：2012-04-18T23:26:03.840
> 
> 标签：mysql

我以这种格式 2012-04-16 08:58:55 在我的数据库中保存时间戳。我读取了我的数据库的时间戳，然后我想在另一个查询中使用这个时间戳，并从数据库中请求返回时间戳大于这个时间戳的记录。我正在使用 ">=" 但它不起作用。

我正在尝试这个：

```
$query="SELECT DISTINCT timestamp,text FROM array WHERE id='$theID' AND timestamp>='$thisTimestamp'"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:37:23.883

What exactly does "not working" mean? It's not clear whether you want to compare datetime stamps or simply the time porition.

For the former, check this thread [Mysql Compare two datetime fields](https://stackoverflow.com/questions/1058031/mysql-compare-two-datetime-fields), for the latter, simply use the [TIME()](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_time) function in your query e.g. `SELECT * FROM table WHERE TIME(datetime) >= '08:58:55';`

Clarify your question if you are in search of something else.

EDIT: Have you not read my first link? That is exactly what you need given the problem you have provided so far. What **results** are you looking for? Give an example and then give an example of how your query is performing incorrectly. Without this information, no one will be able to give you complete help!

# ios - 关于如何将 UIView 屏蔽为 UITableViewCell selectedBackgroundView 的明确答案

> ID：10219560
> 
> 赞同：8
> 
> 时间：2012-04-18T23:26:16.047
> 
> 标签：ios, uiview, uitableview

我已经阅读并尝试了一些在 StackOverflow 上找到的答案。我也从博客中阅读并尝试了一些东西，但似乎没有什么能完成我正在寻找的东西。

我创建一个`UIView`并将其背景颜色设置为我想要的`UITableViewCell`选择颜色*（而不是标准的蓝色或灰色选择颜色）*。我将它添加`UIView`到我的单元格中`selectedBackgroundView`，这工作正常，我的单元格在用户选择时更改为所需的颜色。

这种方法在 Plain 上效果很好`UITableViews`；分组不太好。在分组`UITableView`上，第一个和最后一个单元格不符合剪辑/蒙版边界，如下面的屏幕截图所示。

我知道没有办法只舍入左上角和右上角。

我想严格通过代码来做到这一点，没有图像。

## 问题

**有谁知道一个很好的小工作来改变一个只使用而不是图像的`selectedBackgroundView`颜色并使第一个和最后一个单元格符合圆角边界？`UITableViewCell``UIView`**

# 例子

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString * CellIdentifier = @"Cell";
    WCSBadgedCell   * cell = [[WCSBadgedCell alloc] initWithStyle:UITableViewCellStyleSubtitle andBadgeStyle:0 reuseIdentifier:CellIdentifier]; 
    if (cell == nil) {
        cell = [[WCSBadgedCell alloc] initWithStyle:UITableViewCellStyleDefault andBadgeStyle:0 reuseIdentifier:CellIdentifier];
    }

    UIView *bgColorView = [[UIView alloc] init];
    [bgColorView setBackgroundColor:DARKBROWN];
    [bgColorView setClipsToBounds: YES];
    [cell.layer setMasksToBounds:YES];
    [cell setSelectedBackgroundView:bgColorView];

    [cell.textLabel setText: @"Testing a Cell"];

    return cell;
} 
```

## 截图

![在此处输入图像描述](../Images/dc5d552ba0c344de64b97e98b1116821.png)

![在此处输入图像描述](../Images/f39baee01d00f4bda4f14cb9a91047fa.png)

![在此处输入图像描述](../Images/8d14806b5f9c45f9365ef938511b5ea5.png)

## 解决方案

我接受[了 CodaFis 的回答](https://stackoverflow.com/a/10219699/171206)，因为他添加了一条评论，指出了一个非常好的*（但冗长的）*解决方案。我不得不做很多修改，但最后，我现在有了我需要的 selectedBackgroundView，它位于第一个和最后一个单元格的拐角处，再次感谢！

[这是我如何实现这一目标的一个例子。](http://pastie.org/3814006)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T23:43:13.780

由于单元格的复杂性，我假设您正在使用 UITableViewCell 子类。这就是我一直在做的事情：

```
- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    if ((self = [super initWithStyle:style reuseIdentifier:reuseIdentifier]))
    {
        self.clipsToBounds = YES;

        UIView* bgView = [[UIView alloc] init];
        bgView.backgroundColor = [UIColor colorWithWhite:0.f alpha:0.25f];
        self.selectedBackgroundView = bgView;
                //other code

    }
    return self;
} 
```

这会在单元格上产生一种深灰色的覆盖，而不是所需的图像！

在您的情况下，您选择的单元格的确切颜色（感谢方便的花花公子数字色度计）将是

```
[UIColor colorWithRed:106.0f/255.0f green:51.0f/255.0f blue:6.0f/255.0f alpha:1.0f]; 
```

白色的文字是

```
- (void)setSelected:(BOOL)sel animated:(BOOL)animated
{
    [super setSelected:sel animated:animated];

    if (sel)
    {
        self.textLabel.textColor = [UIColor whiteColor];

        }
    else
    {
        self.textLabel.textColor = [UIColor colorWithRed:(105.f/255.f) green:(50.f/255.f) blue:(6.f/255.f) alpha:1.f];  

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-12T18:50:29.093

我有同样的问题，并通过在我的 UITableViewCell 子类中覆盖`-(void)setHighlighted:(BOOL)highlighted animated:(BOOL)animated`并在创建单元格时设置不选择样式来修复它

```
//set no selection style in the cell
...
[self setSelectionStyle:UITableViewCellSelectionStyleNone];
...

//override setHighlighted to manually set the regular/highlighted background colors
-(void)setHighlighted:(BOOL)highlighted animated:(BOOL)animated {
    [super setHighlighted:highlighted animated:animated];
    if(highlighted){
        self.backgroundColor = [UIColor greenColor];
    }
    else {
        self.backgroundColor = [UIColor redColor];
    }
} 
```

# javascript - 如何使用指定元素作为根来执行 dojo.query()？

> ID：10219561
> 
> 赞同：2
> 
> 时间：2012-04-18T23:26:21.057
> 
> 标签：javascript, dom, dojo

在 dojo 中，如何将 dojo.query() 的搜索范围限制为元素的子元素？此（根）元素没有 ID 或名称，并且在文档中不是唯一可识别的。换句话说，根也是另一个dojo.query() 的结果。谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T23:55:35.147

```
dojo.query('.query', rootedNode); 
```

[http://dojotoolkit.org/reference-guide/1.7/dojo/query.html#queries-rooted-at-a-given-element](http://dojotoolkit.org/reference-guide/1.7/dojo/query.html#queries-rooted-at-a-given-element)

# prism - 具有最小起订量的复杂属性

> ID：10219563
> 
> 赞同：0
> 
> 时间：2012-04-18T23:26:26.767
> 
> 标签：prism, moq

我有类似的东西：

```
UserControl view = _regionManager.Regions[Constants.FormDisplayerRegion].Views.FirstOrDefault() as UserControl; 
```

我嘲笑了区域经理。Regions 是一个 IRegionCollection，View 是一个 IViewCollection。

处理这种事情的最佳方法是什么。

1.  我需要为区域和视图创建模拟吗？
2.  还是我最好跳过起订量并创建自己的存根？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T18:18:14.490

由于您提供的信息很少，很难给出明智的回应。不过，根据您的描述，我想说您只需要设置您的区域管理器模拟，以便它返回一组视图。可以伪造视图集合。

# php - 返回具有多个元键的 wpdb 并按元值排序

> ID：10219566
> 
> 赞同：1
> 
> 时间：2012-04-18T23:26:49.837
> 
> 标签：php, sql, sql-order-by, wordpress

我正在尝试使用 wordpress wpdb 类返回具有元键的两个值之一的自定义帖子，然后按第三个元值对这些帖子进行排序。我可以得到我想要的帖子，但我似乎无法弄清楚如何按照我想要的方式对它们进行排序。

我到目前为止的功能是：

```
function artists_search_country($country_alt){
    global $wpdb;
    $querystr = "
        SELECT wposts.*
        FROM $wpdb->posts wposts, $wpdb->postmeta wpostmeta
        WHERE wposts.ID = wpostmeta.post_id
        AND ((wpostmeta.meta_key = '_artist_country' AND wpostmeta.meta_value = '$country_alt')
        OR (wpostmeta.meta_key = '_artist_country_sub' AND wpostmeta.meta_value = '$country_alt'))
        AND wposts.post_type = 'artists'
        AND wposts.post_status = 'publish'
    ";
    $myposts = $wpdb->get_results($querystr, OBJECT);
    return $myposts;
} 
```

我想做类似的事情：

```
function artists_search_country($country_alt){
    global $wpdb;
    $querystr = "
        SELECT wposts.*
        FROM $wpdb->posts wposts, $wpdb->postmeta wpostmeta
        WHERE wposts.ID = wpostmeta.post_id
        AND ((wpostmeta.meta_key = '_artist_country' AND wpostmeta.meta_value = '$country_alt')
        OR (wpostmeta.meta_key = '_artist_country_sub' AND wpostmeta.meta_value = '$country_alt'))
        AND wposts.post_type = 'artists'
        AND wposts.post_status = 'publish'
        ORDER BY (wpostmeta.meta_key = '_artist_artist_last_name' AND wpostmeta.value) ASC
    ";
    $myposts = $wpdb->get_results($querystr, OBJECT);
    return $myposts;
} 
```

请原谅`ORDER BY`在线上糟糕的语法，但我只是不知道如何处理这个，我尝试的一切都会破坏查询。任何帮助将不胜感激，因为我对 SQL 查询没有太多经验。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T21:01:08.193

试试这个 SQL 语句：

```
SELECT wposts.*, l.meta_value as artist_last_name
FROM $wpdb->posts wposts
    join $wpdb->postmeta wpostmeta
    on wposts.ID = wpostmeta.post_id
    join $wpdn->postmeta l
    on wposts.ID = l.post_id
    and l.meta_key = '_artist_artist_last_name'
WHERE
(( wpostmeta.meta_key = '_artist_country' AND wpostmeta.meta_value = '$country_alt')
OR (wpostmeta.meta_key = '_artist_country_sub' AND wpostmeta.meta_value = '$country_alt') )
AND wposts.post_type = 'artists'
AND wposts.post_status = 'publish'
ORDER BY l.meta_value ASC 
```

您需要为艺术家的姓氏进行第二次加入。

另一个建议是利用 Wordpress 的[$wpdb->prepare](http://codex.wordpress.org/Class_Reference/wpdb#Protect_Queries_Against_SQL_Injection_Attacks)，如下所示：

```
$querystr = "
SELECT wposts.*, l.meta_value as artist_last_name
FROM $wpdb->posts wposts
    join $wpdb->postmeta wpostmeta
    on wposts.ID = wpostmeta.post_id
    join $wpdn->postmeta l
    on wposts.ID = l.post_id
    and l.meta_key = '_artist_artist_last_name'
WHERE
(( wpostmeta.meta_key = '_artist_country' AND wpostmeta.meta_value = %s)
OR (wpostmeta.meta_key = '_artist_country_sub' AND wpostmeta.meta_value = %s) )
AND wposts.post_type = 'artists'
AND wposts.post_status = 'publish'
ORDER BY l.meta_value ASC
";
$myposts = $wpdb->get_results($wpdb->prepare( $querystr, $country_alt, $country_alt ), OBJECT); 
```

希望这可以帮助。

# jquery - 如何使用 jquery 插件调用特权方法。样板 jquery 设计模式

> ID：10219567
> 
> 赞同：1
> 
> 时间：2012-04-18T23:26:57.723
> 
> 标签：jquery, html, jquery-plugins

我为样板 jquery 插件遵循了这种常见的设计模式，但我无法从原型中的任何位置调用构造函数内的特权方法 this.service()。如何从原型内部调用 this.service() ，而不仅仅是在原型的 init 中？

总的来说，我想要做的是能够访问这个插件中的一个变量，这个变量只会在这个插件的实例中受到影响和改变。这个变量应该放在其他地方吗？该变量在我的代码中被命名为 variableToAccess。也许我在这一切都错了。谢谢。

插件调用如下

```
$('article').comment(); 
```

这是插件

```
;(function ( $, window, document, undefined ) {
    // Create the defaults once
    var pluginName = 'defaultPluginName',
        defaults = {
        propertyName: "value"
    };

    // The actual plugin constructor
    function Plugin( element, options ) {
        this.element = element;
        this.options = $.extend( {}, defaults, options) ;
        this._defaults = defaults;
        this._name = pluginName;
        var variableToAccess = false;//<----should this be somewhere else?
        this.service = function() {
            variableToAccess = true;
        };
        this.init();
    }

    Plugin.prototype = {
        init: function() {
            Plugin.prototype.doSomething();
        },
        doSomething: function() {
            this.service()//<----doesn't work
        }
    }

    $.fn["comment"] = function ( options ) {
        return this.each(function () {
            if (!$.data(this, 'plugin_' + pluginName)) {
                $.data(this, 'plugin_' + pluginName,
                new Plugin( this, options ));
            }
        });
    }

})( jQuery, window, document ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T17:09:56.953

我在这里可能不正确，但我认为您不应该通过 Plugin.prototype.doSomething() 调用 doSomething()。

this.doSomething(); 应该调用该方法。请看下面：

```
function Plugin( element, options ) {
    this.element = element;
    this.options = $.extend( {}, defaults, options) ;
    this._defaults = defaults;
    this._name = pluginName;
    var variableToAccess = false;
    this.service = function() {
        variableToAccess = true;
    };
    this.init();
}

Plugin.prototype = {
    init: function() {
        this.doSomething();
    },
    doSomething: function() {
        this.service();
    }
};

$.fn.comment = function ( options ) {
    return this.each(function () {
        if ( !$.data(this, 'plugin_' + pluginName) ) {
            $.data(this, 'plugin_' + pluginName,
            new Plugin( this, options ));
        }
    });
 }; 
```

# php - 试图通过从数据库中获取 url 来为谷歌日历设置用户

> ID：10219570
> 
> 赞同：0
> 
> 时间：2012-04-18T23:27:17.103
> 
> 标签：php, mysql, zend-framework, session, google-calendar-api

下面的代码显示了我的谷歌日历的链接：

```
 $query = $gcal->newEventQuery();
        $query->setUser('*********c@group.calendar.google.com');
        $query->setVisibility('private');
        $query->setProjection('basic'); 
```

但是我试图通过从我的数据库中获取日历 url 来设置用户，因为希望会话为用户显示特定的日历，使用下面的代码：

```
 if(isset($_SESSION["SESS_CALENDAR"]))
    $val = $_SESSION["SESS_CALENDAR"];
    else
    $val = ""; 
```

然后将 $val 插入：

```
 $query->setUser($val); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T22:48:01.307

我从头开始再次尝试它工作正常，我唯一更改的是在将新列添加到 mySQL 数据库时包含 NOT NULL。

# ios - 如何测量 iOS 的 Objective-C 中两行代码之间的时间？

> ID：10219571
> 
> 赞同：8
> 
> 时间：2012-04-18T23:27:18.460
> 
> 标签：ios, objective-c, xcode, cocoa-touch

我有以下代码需要一段时间来处理：

```
self.itemsArray = [Helper changeTheA:self.itemsArray];
self.itemsArray = [Helper convertDates:self.itemsArray]; 
```

有没有一种方法，在仪器或其他地方，我可以测量从第一行代码到第二行代码所花费的时间......以滴答声或毫秒或其他方式？

我想做一些调整，但我需要能够测量以查看我是否对以前的代码进行了改进。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-18T23:30:51.410

最快，最脏，可能不是很精确的方式

```
NSDate *startDate = [NSDate date];

self.itemsArray = [Helper changeTheA:self.itemsArray];

NSLog(@"changeTheA time taken: %f", -[startDate timeIntervalSinceNow]); 
```

一个稍微复杂但可能更有用的解决方案，如果你正在做一些基本的分析可以在[这里](http://weblog.bignerdranch.com/?p=316)看到，它使用一个 C 函数来执行你提供的一个块。

* * *

# 大边注

正如贾斯汀指出的那样，创建一个`NSDate`然后将其注销的实际行为会对您的测量造成干扰，因此这种技术对于获取球场数据确实有好处，即使这样，您也应该在其中运行大量的代码迭代计时块。如果您需要准确的测量值，请跳至贾斯汀的回答

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-18T23:47:25.410

是的。为此，您将使用 Instruments 的 Sampler。

运行应用程序，运行程序一段时间，然后在 Instruments 中找到包含以下内容的符号：

```
self.itemsArray = [Helper changeTheA:self.itemsArray];
self.itemsArray = [Helper convertDates:self.itemsArray]; 
```

它应该逐行显示权重。另请注意，Instruments 允许您指定采样频率，低至 40 微秒。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-19T20:40:11.397

我会使用以下代码：

```
NSTimeInterval start = CACurrentMediaTime();

// your code goes here

NSTimeInterval end = CACurrentMediaTime();
NSTimeInterval delta = end - start;
NSLog(@"Execution took %f seconds.", delta); 
```

它比 精确得多`NSDate`。

# iphone - 从 UILabel 中添加和减去数字 - Xcode

> ID：10219588
> 
> 赞同：0
> 
> 时间：2012-04-18T23:29:15.033
> 
> 标签：iphone, xcode, nsstring, uilabel, ibaction

我正在尝试制作一个计算获胜者百分比等的分析应用程序。请参见附图：

![在此处输入图像描述](../Images/8b5032998ed1a01e64b315dae2ca03f6.png)

因此，当有粉碎获胜者时，用户单击`UIStepper`，它应该在粉碎获胜者总数和集会数量上“加 1”，并更新获胜者除以集会数量的百分比。如果之后有掉线获胜者，则掉线获胜者总数会随着集会的数量以及粉碎和掉线获胜者的百分比而更新。

希望我已经解释得足够好让你们理解：/

我正在使用这段代码来更新一个通用的赢家：

```
- (IBAction)netChanged:(id)sender {

self.netLabel.text = [NSString stringWithFormat:@"%d",
                      [[NSNumber numberWithDouble:[(UIStepper *)sender value]] intValue]];

float net = [self.netLabel.text floatValue];
float rally = [self.rallyLabel.text floatValue];
float netPercentage = (rally == 0.0) ? 0 : net / rally * 100;
self.netPercentageLabel.text = [NSString stringWithFormat:@"%.2f%%", netPercentage];
} 
```

我的问题是，当有赢家时，我需要在代码方面做些什么来更新其他百分比和拉力赛？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T23:33:03.233

您应该将该数据保存在其他地方，而*不是*保存在`text`a 的属性中`UILabel`。更新值，然后更新标签以反映更新后的值。

我强烈建议重新阅读有关[Model-View-Controller](http://developer.apple.com/library/ios/#documentation/general/conceptual/DevPedia-CocoaCore/MVC.html)的文档。

# networking - 网络系统帮助：如何通过主机名将外部请求路由到内部 ip？

> ID：10219597
> 
> 赞同：4
> 
> 时间：2012-04-18T23:30:17.583
> 
> 标签：networking, routing, dns, port

欢迎来到我关于堆栈溢出的第一个问题。

我环顾四周，我还没有发现这个问题。但是，这可能是因为我不知道如何提出我需要回答的问题。

**信息：**

我是一名程序员，离开了公共部门，令人惊讶的是，管理良好的 IT 部门让所有这些废话都为我工作。我现在为一家需要一些网络系统帮助的私人公司工作。

我们有：

*   一个 SQL 服务器
*   应用服务器
*   文件服务器
*   网络服务器
    *   多个网络服务
    *   团队基础服务器
    *   共享积分服务
*   5 个桌面

都在我们的内部网络上。

我们还有： - 没有域控制器 - 没有内部 DNS / NAT / DHCP 服务器。

我们目前正在使用路由器进行 DHCP 和端口转发。我们今天分配了一个静态 IP。

**问题：**

为了将我们的外部域/子域指向我们的新静态 IP 并让这些请求（通过使用的主机名）路由到特定服务器，我需要设置什么？

当前配置（端口转发）

```
ourdomain.com:1234 -> router/port-forwarding -> SQL Server:1433
ourdomain.com:1235 -> router/port-forwarding ->  Web Service 1:8081
ourdomain.com:1236 -> router/port-forwarding ->  Web Service 2:8082
ourdomain.com:1237 -> router/port-forwarding ->  Application Server:5410 
```

我想我想要什么：

```
sql.ourdomain.com:80  -> ??? -> SQL Server:1433
svc1.ourdomain.com:80 -> ??? -> Web Service 1:80 (host: svc1.ourdomain.com)
svc2.ourdomain.com:80 -> ??? -> Web Service 2:80 (host: svc2.ourdomain.com)
app.ourdomain.com:80  -> ??? -> Application Server:5410 
```

(host: xxx) 是我在 IIS 网站配置中指定主机的位置。

在某些情况下，端口转发是必要的，但并非对每个实例都是理想的。我想记住有意义的名称，而不是任意的端口号。

如果我在这里问的是完全荒谬的，那么，谢谢你的阅读。我只是在寻找一些方向。

谢谢！

<编辑>

**太平洋夏令时间 2012 年 4 月 19 日上午 12:01**

对不起，让我澄清一些事情。

1.  我们只有一个静态公共 IP 地址。
2.  假设我们可以获取/设置必要的硬件/软件来实现这一点。

如果归根结底是我们需要购买一些企业级路由硬件，那就是它所需要的。我知道这必须是可能的，因为在我上一份工作中，我们有 40 或 50 个域都指向同一个 IP，一旦进入内部网络，它们就会路由到不同的服务器。:/ 或者至少据我所知，这就是发生的事情。

我今天实际上打电话给他们并问他们，但是设置这一切的主要家伙退出了。

我真的在推动我们把垃圾放到云端，因为没有人愿意聘请网络工程师或系统分析师，更不用说建立数据中心了。

</编辑>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:44:45.417

如果每个子域解析为不同的公共 IP 地址（例如，如果您的 DNS 配置为`sql.ourdomain.com`解析为 1.1.1.1 并`svc1.ourdomain.com`解析为 1.1.1.2），这是一种简单的方法。

```
sql.ourdomain.com  IN A 1.1.1.1
svc1.ourdomain.com IN A 1.1.1.2 
```

您的路由器只能根据 ip 数据包中包含的有限信息做出决定。通常，路由器可以查看 ip 或端口信息。在您的路由器配置了端口转发的情况下，路由器会查看端口号并使用该端口做出地址转换决策。

```
rule: incoming port 1000, forward to 192.168.1.100:1433
rule: incoming port 1001, forward to 192.168.1.101:80 
```

但是，如果端口相同，路由器需要其他信息来决定如何执行转换。大多数低端路由器（例如 Cisco ASA 系列、Juniper SRX 系列）都可以使用 ip 来做出此地址转换决策。缺点是您需要从您的 ISP 购买多个 IP 地址。

```
rule: incoming ip 1.1.1.1, forward to 192.168.1.100:1443
rule: incoming ip 1.1.1.2, forward to 192.168.1.101:80 
```

IIS 在网络堆栈的更高层上运行，可以通过查看 HTTP 标头来做出这种区分。这适用于将单个 ip 和单个端口多路复用到多个网站。在这种情况下，由于 SQL 和您的 Web 服务器使用不同的协议，您将无法利用它。

如果您的设备支持 IPsec 直通，您可能需要考虑的另一项技术是 IPsec 隧道 (VPN)。缺点是你的同事（我假设他们正在使用它）需要执行额外的配置。

# python - 如何在 Google App Engine 上使用 Python 发送 JSON 格式的 cookie 数据？

> ID：10219600
> 
> 赞同：8
> 
> 时间：2012-04-18T23:30:34.417
> 
> 标签：python, json, google-app-engine, webapp2

我正在尝试在 Python 脚本中编码一个对象并将其设置为 cookie，以便我可以使用客户端 JavaScript 读取它。

我尝试这样做的每一种方式都遇到了问题。通常，cookie 的格式会导致 JSON.parse() 中断。

我当前的脚本：

```
cookie = Cookie.SimpleCookie()
data = {"name": "Janet", "if_nasty": "Ms. Jackson"}
cookie['test'] = json.dumps(data)
self.response.headers.add_header("Set-Cookie", cookie.output(header='')) 
```

...这导致

```
test="{\"name\": \"janet\"\054 \"if_nasty\": \"Ms. Jackson\"}" 
```

在客户端。

我真的不想引入一个 hack-y 解决方案来替换逗号出现时的实例。任何想法如何使用 Python 传递复杂的数据结构（通过设置**和**读取 cookie）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-25T04:32:50.020

我还想在客户端读取一个 cookie（已在服务器上设置）。我通过对 JSON 字符串进行 base64 编码解决了这个问题，但是这种方法也涉及到一些小问题。

1：Base64 字符串以 0-2 等号结尾，这些被转换为字符串 \075。我的方法是将这些字符还原为客户端上的相等字符。

2：base64 字符串在 cookie 中被双引号括起来。我在客户端上删除了这些。

服务器：

```
nav_json = json.dumps(nav_data)
nav_b64=base64.b64encode(nav_json)
self.response.set_cookie('nav_data', nav_b64) 
```

客户：

```
var user_data_base64= $.cookie('nav_data');
// remove quotes from around the string
user_data_base64 = user_data_base64.replace(/"/g,"");
// replace \075 with =
user_data_base64 = user_data_base64.replace(/\\075/g,"=");
var user_data_encoded=$.base64.decode( user_data_base64 );
var user_data = $.parseJSON(user_data_encoded); 
```

我在这里使用 2 个 jquery 插件： [https](https://github.com/carlo/jquery-base64) ://github.com/carlo/jquery-base64 和 [https://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

注意：我认为这是一个 hack：最好重新实现在 javascript 中编码 cookie 的 python 代码，但这也有缺点，您需要注意并移植和更改该代码。

我现在已经转移到一个解决方案，我使用一个小的 html 文件在客户端设置 cookie，然后重定向到请求的实际页面。这是我正在使用的 JINJA2 模板的一个片段：

```
<script type="text/javascript">
var nav_data='{% autoescape false %}{{nav_data}}{% endautoescape %}';
$.cookie('nav_data', nav_data, { path: '/' });
window.location.replace("{{next}}")
</script> 
```

注意 2：Cookie 不适合我的用例，我可能会转向 Session 或 Local Storage 以减少网络开销（尽管我的 nav_data 非常小 - 十几个字符左右。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-14T01:51:31.247

在*Python*方面：

1.  `json.dumps`字符串
2.  逃生空间 - 只需调用`.replace(' ', '%20')`
3.  调用`urllib.parse.quote_plus()`然后将字符串写入cookie

在*JavaScript*方面：

1.  读取 cookie
2.  通过它`decodeURIComponent()`
3.  `JSON.parse`它

这似乎是我找到的最干净的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T00:58:00.623

不确定 cookie 是不是最好的方法？有关向客户端呈现数据的信息，请参阅[入门指南](https://developers.google.com/appengine/docs/python/gettingstarted/)

# php - CURL、cPanel 和'curl_exec 抛出错误“无法连接到主机”'

> ID：10219603
> 
> 赞同：0
> 
> 时间：2012-04-18T23:31:09.527
> 
> 标签：php, curl, cpanel

所以我正在尝试使用 cPanel API(XML) 登录界面并运行完整备份，

但是我总是得到相同的错误堆栈

```
> Fatal error:  Uncaught exception 'Exception' with message 'curl_exec threw error "couldn't connect to host" for
> https://37.111.11.1:2083/xml-api/cpanel?<all of the vars>' in
> /home/liamb/public_html/whmcs/backup_class.php:839 Stack trace:
> #0 /home/liamb/public_html/whmcs/backup_class.php(763): xmlapi->curl_query('https://37.26.1...', 'cpanel_xmlapi_u...',
> 'Authorization: ...')
> #1 /home/liamb/public_html/whmcs/backup_class.php(938): xmlapi->xmlapi_query('cpanel', Array)
> #2 /home/liamb/public_html/whmcs/backup_class.php(83): xmlapi->api1_query('a123', 'Fileman', 'fullbackup', Array)
> #3 /home/liamb/public_html/whmcs/backup.php(32): backup->add_cPanel()
> #4 {main}   thrown in /home/liamb/public_html/whmcs/backup_class.php on line 839 
```

我不知道为什么会这样，我可以通过浏览器访问它，但是它强制使用 SSL，CURL 设置为处理未经验证的证书，但我认为这是它中断的地方，这是 CURL 代码

```
$curl = curl_init();

    // Set the URL
    curl_setopt($curl, CURLOPT_URL, $url);
    // Increase buffer size to avoid "funny output" exception
    curl_setopt($curl, CURLOPT_BUFFERSIZE, 131072);
    curl_setopt( $curl , CURLOPT_SSL_VERIFYHOST , 0 ); 
    curl_setopt( $curl , CURLOPT_SSL_VERIFYPEER , 0 );
    curl_setopt( $curl, CURLOPT_RETURNTRANSFER , 1 );

    // Pass authentication header
    $header[0] =$authstr .
        "Content-Type: application/x-www-form-urlencoded\r\n" .
        "Content-Length: " . strlen($postdata) . "\r\n" . "\r\n" . $postdata;

    curl_setopt( $curl, CURLOPT_HTTPHEADER , $header );

    $result = curl_exec($curl);
    echo "<pre>".print_r(curl_getinfo($curl),1)."</pre>";
    if ($result == false) {
        throw new Exception("curl_exec threw error \"" . curl_error($curl) . "\" for " . $url . "?" . $postdata );
    }
    curl_close($curl);
    return $result; 
```

卷曲信息产生以下

```
 Array
(
    [url] => https://37.111.11.1:2083/xml-api/cpanel
    [content_type] => 
    [http_code] => 0
    [header_size] => 0
    [request_size] => 0
    [filetime] => -1
    [ssl_verify_result] => 0
    [redirect_count] => 0
    [total_time] => 189.000809
    [namelookup_time] => 0.000163
    [connect_time] => 0
    [pretransfer_time] => 0
    [size_upload] => 0
    [size_download] => 0
    [speed_download] => 0
    [speed_upload] => 0
    [download_content_length] => -1
    [upload_content_length] => -1
    [starttransfer_time] => 0
    [redirect_time] => 0
    [certinfo] => Array
        (
        )

    [redirect_url] => 
) 
```

任何人都可以帮忙吗？卡在这上面好几天了！

更新：如果我尝试连接到 127.0.0.1 它可以工作！好吧，至少它带回了 XML 输出！

# android - 平板电脑的 Android 清单文件属性

> ID：10219611
> 
> 赞同：0
> 
> 时间：2012-04-18T23:32:29.643
> 
> 标签：android

我有一个针对姜饼的应用程序。我需要在清单文件中更改/添加哪些属性才能使其在平板电脑上运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:51:22.693

您无需添加任何内容。如果您不希望您的应用仅在平板电脑上运行，您应该根据屏幕尺寸过滤允许的设备，将以下代码添加到您的清单中：

```
<supports-screens 
 android:smallScreens="false"
 android:normalScreens="false"
 android:largeScreens="true"
 android:xLargeScreens="true"
 android:requiresSmallestWidthDp="600" 
              /> 
```

# php - 如何实现使用 mySQL 和 PHP 描述的这种排序？

> ID：10219612
> 
> 赞同：4
> 
> 时间：2012-04-18T23:32:36.960
> 
> 标签：php, mysql

我有这个名为*“类别”*的表，其中包含以下三个字段

```
cat     | order | id
--------|-------|----
News    |  3    | 23
Hi-Tech |  2    | 15
Biz     |  5    | 8
Health  |  1    | 3 
```

另外，我还有另一个名为*“链接”*的表，如下所示

```
link    | order | cat-id
--------|-------|-------
link1   |  2    | 23
link2   |  8    | 15
link3   |  5    | 8
link4   |  6    | 15
link5   |  2    | 15
link6   |  4    | 23
link7   |  1    | 3
link8   |  1    | 8 
```

我想要实现的是对类别进行排序*，*并在每个类别下方对该类别*cat-id / id的**链接*进行排序，如下所示：

 ***健康**
链接7

**高科技**
链接
5 链接4 链接
2

**新闻**
链接1
链接6

**商务**
链接
8 链接3

我成功地显示了*分类*的类别，但在它之后我失去了它。

**我的目标是在页面上显示这个，所以我想我必须使用 PHP 和 mySQL。**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-29T00:31:30.330

查询很简单：

```
SELECT c.cat, l.link, c.id
FROM links l INNER JOIN categories c
ON l.cat-id = c.id
ORDER BY c.`order`, l.`order` 
```

[它在这里](http://sqlfiddle.com/#!2/d73c1/2)起作用。

为了在页面上显示它，它看起来像这样：

```
mysql_connect(<host>, <username>, <password>);

$q = mysql_query("<query from above>");
$last_cat = 0;
while($row = mysql_fetch_assoc($q)) {
    if($row['id'] != $last_cat) {
        print '<h3>' . $row['cat'] . '</h3>';
        $last_cat = $row['id'];
    }
    print $row['link'] . '<br>';
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-29T00:46:37.757

我在脑海中写了这个，所以没有测试它，但它有点像这样：

```
$q = mysql_query("select * from categories c 
      left join links l 
      on l.cat-id=c.id 
      order by c.order,l.order");

$last_cat = -1;

while($row=mysql_fetch_assoc($q)){
    if($last_cat!=$row["cat"]){
        echo "<br><b>".$row["cat"]."</b><br>";
        $last_cat=$row["cat"];
    }
    echo $row["link"]."<br>";
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-05T11:37:11.440

This will print exactly as you have described in the example:

```
<?php
$categories = mysql_query("SELECT * FROM categories order by 'order'");
$links = mysql_query("SELECT * FROM links order by 'order'"); 
?>

<?php foreach ($categories as $key => $category): ?>
 <b><?php echo $category['cat'];?>"</b>
    <?php foreach ($links as $key => $link): ?>
      <?php if($category['id'] === $link['cat-id']): ?>
         <?php echo $link['link'];?>
      <?php endif;?>
    <?php endforeach;?>
   <br />
<?php endforeach;?> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-05T13:40:26.230

```
<?php
// This query gets all the needed data with one shot. No need to do multiple
// queries. You can run this query in phpMyAdmin to see the result.
$query = mysql_query("
    SELECT links.link as link, categories.cat as cat FROM links
    LEFT JOIN categories ON categories.id = links.cat_id
    ORDER BY categories.order, links.order ASC");

// With this we are getting all links with correct order to an array.
$categories = array();
while ($row = mysql_fetch_array($query)) {
    $categories[$row['cat']][] = $row['link'];
}

// To see how we stored the links in the array uncomment the below line
// var_dump($categories);

// To print out the data:
foreach ($categories as $category => $links) {
    echo "<strong>".$category."</strong><br />\n";

    // implode is a built-in function that makes a string from an array.
    // You can put something between the array elements with the first parameter.
    // If you want to make some changes or print the links, use a foreach loop.
    echo implode("<br />\n", $links)."<br /><br />\n";
}
?> 
```

This should write the links exactly what you want.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-29T00:32:36.653

```
ORDER BY categories.order ASC, links.order ASC 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-29T00:36:09.647

```
select cat, link
from categories, links
where link.cat-id = categories.id
order by cat asc, link asc; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-02T21:12:01.870

根据您的查询，如果我们需要考虑优化，我们将考虑一些情况

**案例 1：** 正如您所提到的，您将拥有 60（链接）* 5（类别），这些从 mysql 端本身很容易处理。我们可以很好地使用我们的 SQL 技术本身并从中获得优势。

您总是可以混合使用 php 处理 + SQL。PHP的处理速度比mysql快。所以，抓住它。

Your query can also be solved by SQl alone and the query mentioned by paolo can be used simply.

**case 2:** There are situation where either or both one of the table participating tables have too high number of records. when there is a join between them it results into high number of combinations i.e join size eg: links(100000) * categories(10) = 1 million In these cases, u can try to avoid joins.

You can take advantage of indexes. Indexes are used to find rows with specific column values quickly. Without an index, MySQL must begin with the first row and then read through the entire table to find the relevant rows.

There are techniques like flat files i.e schema free databases like MongoDB which dont use concept of joins but if you plan on it running it on a huge site (huge, meaning that you need many many servers to host it)

MySQl scales well and you have to think something out of it when you are in a huuuuuuuge environment.

**Here,I have solved your query without using joins and any dependent query. I have just fetch results and just used array mapping techniques only which is faster.**

```
 $query = mysql_query("SELECT * FROM category order by `order` asc");
 while($row = mysql_fetch_assoc($query) ) {
     $categories[$row['id']]['cat']  = $row['cat'];
     $categories[$row['id']]['order'] = $row['order'];

 } 

 $query = mysql_query("SELECT * FROM links ORDER BY `order` ASC ");
 $count =0; 
 while($row = mysql_fetch_assoc($query) ) {
     $links[$row['cat-id']][$count]['link']  = $row['link'];
     $links[$row['cat-id']][$count]['order']  = $row['order'];
     $links[$row['cat-id']][$count]['cat-id']  = $row['cat-id'];
     $count++; 
 } 

foreach ($categories as $id=$value) {
     foreach ($links[$id] as $link_info) {

         if ($last_cat != $link_info['cat-id'])
             print '<h3' . $categories[$link_info['cat-id']]['cat'] . '</h3';

         print $link_info['link'] . '<br';
         $last_cat = $link_info['cat-id'];
     } } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-03T15:08:43.307

1st the query as a lot of people says its:

```
SELECT c.cat,c.order as catorder,c.id,l.* FROM categories as c 
INNER JOIN links as l ON (c.id = l.id-cat )
ORDER BY c.order, l.order 
```

so u have a result ordered like this:

```
cat     | catorder | id  |  link   | order | cat-id
--------|----------|-----|---------|-------|-------
Health  |  1       | 3   |  link7  |  1    |  3
Hi-Tech |  2       | 15  |  link5  |  2    |  15
Hi-Tech |  2       | 15  |  link4  |  6    |  15
Hi-Tech |  2       | 15  |  link2  |  8    |  15
News    |  3       | 23  |  link1  |  2    |  23
News    |  3       | 23  |  link6  |  4    |  23
Biz     |  5       | 8   |  link8  |  1    |  8
Biz     |  5       | 8   |  link3  |  1    |  8 
```

So .. you need to make a "cutting control"

```
$max = sizeof($arrayOfResults)
$i = 0;
while ($i < $max) {
    $current = $arrayOfResults[$i]["id"];
    print_r($arrayOfResults[$current]["cat"]);
    while ($i < $max && $arrayOfResults[$i]["id"] == $current) {
        print_r($arrayOfResults[$current]["link"]);
        $i++;
    }
} 
```

If u copy and paste this code u going to have the output that u r searching.

If u need a explanation ask me.

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-04-29T14:23:09.390

代码可能是这样的。

```
<?php
$result_catg = mysql_query("select * from categories order by order asc");
?>
<ul>
<?php
while($row_catg = mysql_fetch_array($result_catg))
{
$catg_id = $row_catg['id'];
$result_link = mysql_query("select * from links where cat_id = '$catg_id' order by order asc");
while($row_link = mysql_fetch_array($result_link))
{
?>
<li class="down"><?php echo $row_link['link']; ?></li>
<?php
}
}
?>
</ul> 
```

**只需在li down**的 CSS 属性中使用“float:none”

 **希望这可以帮助。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2012-05-03T05:57:26.377

This will give you the required result.

```
$ds = mysql_query("select cat, id from categories order by  'order' asc");
while($rs = mysql_fetch_row($ds))
{
    echo"<b>".$rs[0]."<b><br/>";
    $dsLinks = mysql_query("select link from links where cat_id = '".$rs[1]."' order by 'order' asc");
    while($rsLink = mysql_fetch_row($ds))
    {
        echo"<b>".$rsLink [0]."<b><br/>";
    }
    echo"<br/>";
} 
```***

# java - 类编辑pdf Android

> ID：10219614
> 
> 赞同：1
> 
> 时间：2012-04-18T23:32:45.230
> 
> 标签：java, android, pdf

我需要在我的 Android 应用程序中编辑现有的 pdf 文件。我在互联网上搜索，但我只找到了显示/编辑它的应用程序。我需要一个类来从 java 编辑它。我在哪里可以找到它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T08:19:54.820

使用 IText ( [www.itextpdf.com](http://www.itextpdf.com) ) 有什么问题？

# java - Slick2d 出错

> ID：10219617
> 
> 赞同：3
> 
> 时间：2012-04-18T23:33:10.930
> 
> 标签：java, eclipse, compiler-errors, noclassdeffounderror, slick2d

我正在尝试按照[本](http://www.youtube.com/watch?v=zNpKylu6TSU&feature=autoplay&list=UL7qlvFIlt-hg&lf=channel&playnext=1)教程在 Eclipse 中启动并运行 Slick2d。当我尝试编译[测试应用程序](http://www.cs.bsu.edu/homepages/pvg/misc/slick_eclipse_tutorial.php)时，出现错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/newdawn/slick/BasicGame
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
    at java.net.URLClassLoader.access$000(URLClassLoader.java:58)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247) 
```

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T13:31:17.773

该错误基本上表明它找不到 Slick 中包含的至少一个类。听起来您没有将 Slick .JAR 文件添加到正确的位置，或者您的类路径设置不正确。仔细检查在项目中包含 Slick .JAR 文件的设置，并确保它位于正确的位置并正确设置。

[官方Slick Wiki](http://slick.cokeandcode.com/wiki/doku.php?id=getting_started_and_setup)中有更详细的设置指南版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-05T23:36:11.203

上述评论中的链接不再有用。尝试点击它，它消失了。这就是为什么最好在 Stack Overflow 的网站内逐步解释事情的原因。

您的构建路径设置不正确。你需要做的是

1) 确保你已经从这里下载了 SLick2D jars：

[Slick - 忍者洞窟](http://slick.ninjacave.com/)

2) 确保你已经从这里下载了 LWJGL jars 和 native：

[LWJGL - 所需文件下载页面](http://lwjgl.org/download.php)

3）右键单击您的项目，然后转到`Build Path`->`Configure Build Path`

4) 在 Source 选项卡下，展开菜单并转到 Native Library 部分。这需要设置为 LWJGL 包中适当的 natives 文件。它在一个名为 natives 的文件中。选择您的操作系统，然后继续。

5) 转到库选项卡，如果您还没有这样做，请添加适当的 LWJGL 罐子和 Slick 罐子。如果您很聪明，您将为 LWJGL 和 Slick2D 创建用户库，以便于将来重用。要创建用户库，只需单击添加库 -> 用户库 -> 从外部位置添加该库所需的 jars，即在 jars 文件中下载您拥有的 LWJGL，然后您就可以开始了。

现在，如果你已经配置好一切，你的项目应该运行。如果不是，则不是构建路径，而是您的代码。

希望这可以帮助！

# javascript - JavaScript 中的 Smarty 变量

> ID：10219622
> 
> 赞同：-1
> 
> 时间：2012-04-18T23:33:45.463
> 
> 标签：javascript, smarty

我正在尝试更新某人使用 Smarty 创建的网站。该页面是一个会员目录，当您点击会员姓名时，会显示会员的详细信息。但是，创建页面的人使用内联`onClick`事件来实现这一点。有几百个成员，似乎有很多代码要重复：

```
<a href="#" class="expand"
onClick="document.getElementById('detailsbox-{$member.member_id}').innerHTML = 
document.getElementById('details_'+{$member.member_id}).innerHTML;
document.getElementById('divStayTopLeft-{$member.member_id}').style.display='block';
document.getElementById('summary-{$member.member_id}').style.display='none';return false;
"> 
```

我尝试将它放入一个函数中，并用 调用它`onClick`，但当然`{member_id}`在输出页面时只返回一个数字。因此，所有链接都只针对该成员 ID 打开和关闭。

我想我需要将 Smarty 变量更改为 JavaScript 变量，然后让 onClick 事件使用正确的成员 ID 设置 JavaScript 变量，但我对 JavaScript 的理解不够好，无法弄清楚。任何提示（或彻底的解决方案）？

谢谢，斯科特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:51:53.650

您可能希望将 javascript 函数放入对象或其他构造中，以将其从全局命名空间中取出，并尽可能将事件绑定从标记中取出，但我会将这些作为作业问题。

javascript:

```
function foo(member_id) {
    document.getElementById('detailsbox-' + member_id).innerHTML = 
        document.getElementById('details_' + member_id).innerHTML;
    document.getElementById('divStayTopLeft-' + member_id).style.display = 'block';
    document.getElementById('summary-' + member_id).style.display = 'none';
    return false;
} 
```

html/tpl:

```
<a href="#" class="expand" onClick="return foo({$member.member_id});"> 
```

# php - 使用这种精确格式的 PHP 时间比较

> ID：10219624
> 
> 赞同：1
> 
> 时间：2012-04-18T23:33:53.233
> 
> 标签：php, time

如何以这种格式写入的时间与当前时间进行比较，以查看该确切时刻是否已经发生（用于倒数计时器），但时间必须采用以下格式：

`12/31/2012 5:00 AM UTC-0500`

最后我想说如果当前时间小于那个日期，显示这个，否则，显示这个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T23:36:15.433

strtotime can convert string dates to unix timestamp which you can easily use later for comparisons/etc

```
$timestamp = strtotime("12/31/2012 5:00 AM UTC-0500");
if (time() > $timestamp)
... 
```

# python - Python继承

> ID：10219625
> 
> 赞同：-1
> 
> 时间：2012-04-18T23:34:04.497
> 
> 标签：python, class, inheritance, methods

我的基本代码如下所示：

```
class C1(object):
    def f(self):
    return 2*self.g()

    def g(self):
    return 2

class C2(C1):
    def f(self):
    return 3*self.g()

class C3(C1):
    def g(self):
        return 5

class C4(C3):
    def f(self):
    return 7*self.g()

obj1 = C1()
obj2 = C2()
obj3 = C3()
obj4 = C4() 
```

现在我的问题如下：我需要编写三个赋值语句来执行以下操作：

*   将**调用列表**分配给`obj2.f()`变量`obj2_calls`
*   将**调用列表**分配给`obj3.f()`变量`obj3_calls`
*   将**调用列表**分配给`obj4.f()`变量`obj4_calls`

调用列表例如，当`obj1.f()`被调用时，调用的`f`方法`C1`调用的`g`方法`C1`。这可以表示为表单的**调用列表**`['C1.f', 'C1.g']`

我不太清楚写作业陈述的正确方法，我非常想帮助我的朋友处理她的事情。

如果你能告诉我如何正确地纠正第一个赋值语句，我相信我能弄清楚其余的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T00:26:38.650

关键的见解是，如果没有为类定义方法，它将默认使用该类继承的类的方法。

因此，问问自己 'obj2.f()' 会做什么。

*   **什么课`obj2`？**它是`C2`。
*   **是否`f`为类定义了方法`C2`？**就在这里。所以方法`C2.f`被调用。
*   `C2.f`方法调用，这`self.g`意味着它寻找`C2.g`. **有“C2.g”方法吗？**不，所以我们必须去`C2`继承自的类。该行`class C2(C1)`告诉我们它是从类继承的`C1`，所以它会调用该方法`C1.g`。

这些是获取第一个呼叫列表的步骤；其余的由你决定。

# ivy - 如何在 Gradle 中指定本地 Ivy 存储库的相对路径？

> ID：10219627
> 
> 赞同：9
> 
> 时间：2012-04-18T23:34:18.180
> 
> 标签：ivy, gradle

我正在从 Ant/Ivy 迁移到 Gradle，并试图了解您如何指定本地 Ivy 存储库的相对路径。独立 Ivy`${ivy.default.ivy.user.dir}`默认将变量设置`.ivy2`在用户主目录中，并将本地 repo 放在那里。

我可以模拟如下：

```
repositories {
    ivy {
        url "C:/Users/RYAN/.ivy2/local"
        layout 'pattern', {
            artifact "[organisation]/[module]/[revision]/[artifact](-[classifier])-[revision](.[ext])"
            ivy "[organisation]/[module]/[revision]/[artifact](-[classifier])-[revision](.[ext])"
    } 
} 
```

但我不想指定绝对路径。我看到有一个 GRADLE_USER_HOME 环境变量，但 Gradle 默认没有设置它——我必须在命令行中指定它。

Gradle 是否提供了访问默认本地 Ivy 存储库的方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-04-19T23:55:27.910

如何使用：

```
url "${System.properties['user.home']}/.ivy2/local" 
```

# python - reStructuredText / Sphinx 中的图像网格

> ID：10219634
> 
> 赞同：20
> 
> 时间：2012-04-18T23:34:33.063
> 
> 标签：python, python-sphinx, restructuredtext

我正在使用 Sphinx 为我正在处理的 Python 项目创建文档。我想在 1x3 网格中显示三张图像（即全部在同一行），我试图弄清楚如何在 reStructuredText 中执行此操作。现在我有

```
.. image:: _images/report_title.png

.. image:: _images/report_slide1.png

.. image:: _images/report_slide2.png 
```

我曾想过尝试在一行中围绕它们构建一个 reST 表，但这似乎有点荒谬。如何网格化这些图像？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-19T13:43:46.867

您可以将`width`每个图像的选项（请参阅[reStructuredText 图像指令文档](http://docutils.sourceforge.net/docs/ref/rst/directives.html#images)）指定为页面宽度的大约三分之一或更小。

试试，例如

```
.. image:: _images/report_title.png
   :width: 30%
.. image:: _images/report_slide1.png
   :width: 30%
.. image:: _images/report_slide2.png
   :width: 30% 
```

[这里](http://docutils.sourceforge.net/docs/ref/rst/restructuredtext.html#length-units)讨论了宽度（和高度）选项中允许的长度（它们基本上对应于[CSS](http://www.w3.org/TR/CSS2/syndata.html#length-units)文档中的长度单位）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-02-09T18:52:48.767

另一个答案是使用指令作为图像的别名。

```
.. |logo| image:: ../iamges/wiki_logo_openalea.png
   :width: 20pt
   :height: 20pt 
```

然后在表中使用别名：

```
 +---------+-----------+
 | |logo|  +  |logo2|  +
 +---------+-----------+ 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-05-27T07:49:42.570

对于混叠，我有更好的运气：

```
.. |logo1| image:: logo1.png    
   :scale: 100%
   :align: middle
.. |logo2| image:: logo2.png
   :scale: 50%
   :align: top

+---------+---------+
| |logo1| | |logo2| |
+---------+---------+ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-11T02:34:27.820

我提供另一个参考。如果你想放置**puml**你可以试试

```
 +---------------------+----------------------+
    | .. uml:: class.puml | .. uml:: class.puml  +
    |    :scale: 100%     |     :scale: 100%     +
    +---------------------+----------------------+ 
```

# android - 如何将动态 URL 传递给多选项卡中的每个 Webview Activity，每个选项卡中有 1 个 Web 视图 - Android 应用

> ID：10219635
> 
> 赞同：1
> 
> 时间：2012-04-18T23:34:40.640
> 
> 标签：android, android-intent, android-webview, android-tabactivity

我的应用程序是一个新闻应用程序。由 5 个或更多选项卡组成（这将是基于每个用户要求的设置）。

当应用程序启动时，我动态创建 5 个选项卡并创建一个 web 视图作为每个选项卡的意图，我只需将每个选项卡的 URL 传递给意图，这是我的代码。

**这是主要活动**

```
package news.mobile;

import android.app.Activity;
import android.os.Bundle;
import android.app.TabActivity;
import android.widget.TabWidget;
import android.widget.TabHost;
import android.widget.TabHost.TabSpec;
import android.content.Intent;

public class NewsMobile extends TabActivity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        TabHost tabHost = getTabHost();
        // Here I create the tabs dynamically.
        for(int i=0;i<5;i++){
        tabHost.addTab(
                tabHost.newTabSpec("tab"+i)
                .setIndicator("Politics")
                    // I need to pass an argument to the WebviewActivity to open a
                    // specific URL assume it is "http://mysite.com/?category="+i
                .setContent( new Intent(this, WebviewActivity.class)));
        }
        tabHost.setCurrentTab(0);
    }
} 
```

**这是我的 Webview Creator 活动**

```
package news.mobile;

import android.app.Activity;
import android.os.Bundle;
import android.webkit.WebView;

public class WebviewActivity extends Activity {
    WebView browse;
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        browse=new WebView(this);
        setContentView(browse);
                // I need the following line to read an argument and add it to the url
        browse.loadUrl("http://mysite.com/?category=");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-26T20:59:27.143

如果它对任何人有帮助，这里是@Shehabix 要求的额外信息：

所以开始 webview 活动，如接受的答案所示

```
Bundle bundle = new Bundle();
String url = "http://www.google.com";
bundle.putString("urlString", url);
Intent intent = new Intent(ThisActivity.this, NewActivity.class);
intent.putExtras(bundle);
startActivity(intent); 
```

以下是如何在 webview 活动中截取此信息

```
public class MyWebView extends Activity {

    private WebView webView;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.asset_web_view);
        //get url stored in intent
        String url = super.getIntent().getExtras().getString("urlString");
        loadUrlInWebView(url);
    }

    private void loadUrlInWebView(String url){
        webView = (WebView) findViewById(R.id.mywebview);
        webView.setWebViewClient(new WebViewClient());
        webView.loadUrl(url);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:41:38.410

你可以像这样使用Bundle

```
Bundle bundle = new Bundle();
String url = "http://www.google.com";
bundle.putString("urlString", url);
Intent intent = new Intent(ThisActivity.this, NewActivity.class);
intent.putExtras(bundle);
startActivity(intent); 
```

# java - Create Custom TestNG Report - WebDriver

> ID：10219640
> 
> 赞同：1
> 
> 时间：2012-04-18T23:35:24.463
> 
> 标签：java, selenium, report, webdriver, testng

I'm trying to implement org.testng IReporter Interface. My Java is not that great, base on some example I found online I was able to create a Reporter class. The problem I'm having is how to use it and where do I call it and how and which parameters to pass to it?

public class Reporter implements IReporter {

```
public void generateReport(List<XmlSuite> xmlSuites, List<ISuite> suites, String outputDirectory){
      ISuiteResult results =suites.get(0).getResults().get("Sanity Suite");
      ITestContext context = results.getTestContext();

      IResultMap passedTests = context.getPassedTests();
      IResultMap failedTests = context.getFailedTests();

      // Print all test exceptions...
      for( ITestResult r: failedTests.getAllResults()) {
          System.out.println( r.getThrowable());
      }
} 
```

}

For example I have this WebDriver Selenium TestNG test:

public class VerifyTest extends TestBase {

```
@Test
public void test1() {
    verifyTrue(false);
    verifyEquals("pass", "fail");
    verifyFalse(true);
}

@Test
public void test2() {
    verifyTrue(false);
    assertEquals("pass", "fail");
    verifyFalse(true);
} 
```

How would I use my Reporter to get a customize report at the end of the run???

Thank You!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T05:05:14.033

大卫，您可以将自定义报告器添加到您的 testng.xml 中，以防您通过套件部分中的 xml 调用测试。

```
<listeners>
<listener class-name="yourpackage.Reporter"/> </listeners> 
```

如果您以编程方式调用它们，那么您需要通过您的代码添加它，如[@Running TestNG programmatically所记录的那样](http://testng.org/doc/documentation-main.html#running-testng-programmatically)

如果您从命令行调用测试，请参阅[此](http://testng.org/doc/documentation-main.html#logging-listeners)

如果您以上述任何一种方式指定，TestNG 将在所有运行结束时调用此报告器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:50:45.370

只需在上面扩展您的骨架即可在您想要的位置生成结果，.xml、.html、文本文件等...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-21T05:43:43.290

我[创建了一个项目，它是生成自定义报告的示例](https://github.com/djangofan/selenium-framework-concept2)。

基本思想是创建一个Listener类并在testing.xml文件中引用它。

```
<listeners>
    <listener class-name="qa.hs.framework.CustomReportListener"/>
  </listeners> 
```

然后创建类：

```
 public class CustomReportListener implements IReporter {

    @Override
    public void generateReport( List<XmlSuite> xmlSuites, List<ISuite> suites, 
           String outputDirectory ) {
       System.out.println();
       //Iterating over each suite included in the test
       for (ISuite suite : suites) {
       //Following code gets the suite name
       String suiteName = suite.getName();
       //Getting the results for the said suite
       Map<String, ISuiteResult> suiteResults = suite.getResults();
       for ( ISuiteResult sr : suiteResults.values() ) {
          ITestContext tc = sr.getTestContext();
          System.out.println("Passed tests for suite '" + suiteName + "' is:" +
               tc.getPassedTests().getAllResults().size());
        }
        CustomReport cr = new CustomReport();
        cr.generateReport( xmlSuites, suites, outputDirectory );
        ... 
```

然后，从该 Listener 类中，您可以创建一个“报告编写器”类，该类可以使用以下内容创建任意 HTML 输出：

```
public class CustomReport extends CustomReportListener
{
        private static final Logger LOG = Logger.getLogger( CustomReport.class );
        private static final SimpleDateFormat dateFormatter = new SimpleDateFormat(" MMM d 'at' hh:mm a");

        private String reportFileName = Constants.reportFileName;
        private PrintWriter m_out;
        private int m_row;
        private Integer m_testIndex;
        private int m_methodIndex;
        private Scanner scanner;

        @Override
        public void generateReport( List<XmlSuite> xml, List<ISuite> suites, String outdir ) {
                try {
                        m_out = createWriter( outdir );
                }
                catch ( IOException e ) {
                        LOG.error("output file", e);
                        return;
                }
                startHtml(m_out);
                generateSuiteSummaryReport(suites);
                generateMethodSummaryReport(suites);
                generateMethodDetailReport(suites);
                endHtml(m_out);
                m_out.flush();
                m_out.close();
        } 
```

最后，从“CustomReport”类中，您的“生成报告”方法都可以访问报告中的所有数据，例如：

```
testContext.getPassedTests()
Map<String, ISuiteResult> r = suite.getResults()
method.getDescription()
method.getTestClass().getName()
ITestResult.SUCCESS
tests.getAllMethods()
overview.getStartDate().getTime()
overview.getIncludedGroups()
etc. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-08T17:38:53.790

使用实时报告插件可以实时报告任何正在运行的测试的漂亮报告。非常易于使用，无需修改现有代码，详情请访问此 github url [RealTimeReport](https://github.com/startingwithseleniumwebdriver/RealTimeReport)

您可以找到不同 TestNg 报告接口的详细实现

[![在此处输入图像描述](../Images/f11c18b6cc600b1d38a3066076f4a15c.png)](https://i.stack.imgur.com/b3Vhl.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-12-16T08:11:37.307

您可以使用

```
@Listeners(ReporterClassName.class) 
```

例如：@Listeners(Reporter.class)

公共类 VerifyTest 扩展了 TestBase

# c++ - std::vector::size() 是否比手动跟踪大小慢？

> ID：10219641
> 
> 赞同：2
> 
> 时间：2012-04-18T23:35:29.320
> 
> 标签：c++, vector

`std::vector::size()`每次调用向量时都会重新计算向量的大小，还是维护一个仅在向量被修改时才被修改的计数器？例如，如果我与`std::vector<double>`成员一起上课，在单独的柜台中跟踪其大小是否有任何速度优势？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-18T23:37:49.943

`size()`保证具有恒定的时间复杂度，并且在任何理智的实现中都将尽可能快地进行操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-18T23:47:17.933

```
this->_Mylast - this->_myFirst 
```

通常涉及两次内存提取。如果您在寄存器中维护计数，它*可能*会更快。我说*可能*，因为在一个小循环中，被减去的两个值将在缓存中，这并不总是比寄存器慢很多 - 取决于机器。一个聪明的编译器，与一个紧密的循环一起工作，无论如何都可以在寄存器中维护它们，如果它的数据流分析正确的话。在一个不那么小的循环中，您永远不会注意到差异。将其保存在寄存器中意味着每次迭代都需要额外的操作来更新寄存器，如果可以与其他操作并行完成，这可能是免费的，或者可能会花费一个指令周期。所以很难衡量差异。

无论如何，您的里程**会**因处理器而异，即使 STL 的每个实现都有相同的代码`size()`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T02:27:23.527

无需在单独的计数器中跟踪其大小，因为它是在矢量内部完成的。这个函数的代码是这样的：

```
iterator begin() {return start;}
iterator end() {return finish;}
size_type size() const { return size_type(end() - begin());}

iterator start;
iterator finish; 
```

一旦你 push 或 pop 元素，变量“start”、“finish”就会改变，所以函数 size() 只需要减的时间。如果使用单独的计数器，当你推送或弹出元素时，你也会有一个加号或减号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T23:38:18.203

不 - 只需使用`std::vector::size()`

在 MSVC 上，它被实现为`this->_Mylast - this->_Myfirst`- 你无法击败它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-19T08:43:51.817

正如其他人所说，它很难变得更快。只有在您的向量大小不变的情况下，您确实可以通过使用这个事实来节省一些 CPU 周期。实际上，您可以完全跳过查询大小。这对于渲染循环等中经常重复的可笑迭代可能很重要。想象一下以下之间的区别：

```
// reset vector of size=3 to value 10

for( size_t i=0; i < myvec.size(); ++i )
{
   myvec[i] = 10.0;
} 
```

相对

```
 myvec[0] = myvec[1] = myvec[2] = 10.0; 
```

一个典型的用例是一个 3d 坐标向量、一个 IP 地址等。但是要准备好用你自己的替换一些在内部查询 size() 的 std::vector 例程。所以要点是，为了节省 cpu 周期，size 运算符不是目标，寻找其他合乎逻辑的地方。当你的向量没有改变它的大小时，即使是暂时的，你有一只脚可以挤出一些 cpu 周期。

PS：[Valgrind](http://valgrind.org/)是您的朋友，可以告诉您首先优化哪里。事实上，尺寸运算符经常作为最佳候选者出现。至少对于某些算法。

祝你好运！

# regex - Regex for htaccess to match pattern unless directory exists

> ID：10219642
> 
> 赞同：0
> 
> 时间：2012-04-18T23:35:31.297
> 
> 标签：regex, .htaccess, redirect

I'm using regex in a htaccess file to catch /[username] and re-direct this to a username page, for example, mywebsite.com/john will forward to mywebsite.com/username?u=john. This works, but I now want to exclude anything that matches a directory which exists. So, if someone goes to mywebsite.com/sign-up, this is EXCLUDED for the re-direction, because that directory (/sign-up) exists. Is that possible, and is it normal practice? Thank you.

Edit: Ideally I don't want to have to exclude every existing directory manually. I'd like it to be automatic for all existing directories.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T17:06:14.797

在它之前使用重写条件。!-f 表示不存在的文件，!-d 表示不存在的目录。

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([a-z]+)$ username?u=$1 [L] 
```

# email - How to find whether image is blocked in Outlook recipients

> ID：10219643
> 
> 赞同：-1
> 
> 时间：2012-04-18T23:35:31.530
> 
> 标签：email, outlook, google-analytics

Is there a way to check whether the Outlook recipients are receiving emails with block image security settings? (Perhaps using Google Analytics?)

I need to track how many of them are blocking and whom they are so I can send appropriate emails.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T03:03:01.390

不，不可能跟踪这种事情。跟踪电子邮件中任何内容的唯一方法是通过像素请求，如果图像被阻止，您将永远无法获得它们。

# python - 将 Long Int 时间戳转换为日期/时间

> ID：10219645
> 
> 赞同：2
> 
> 时间：2012-04-18T23:36:13.620
> 
> 标签：python, sqlite, datetime, time, timestamp

我使用连接 chrome 'History' 文件的 sqlite3 进行分析。但是有last_visit_time的数据，也就是时间戳，但是不知道怎么改成实时的。我这样测试：

```
2012-04-18 23:22:11.084300 (utctime)

2012-04-19 01:22:11.084300 (myPC time)

12,979,264,931,952,304 (the time stamp in the data) 
```

我几乎同时打印了 utctime 并点击了一个网站。所以我得到了上面的统计数据。12,979,264,931,952,304 是 long int，因此无法正常转换。

如何将时间戳转换为日期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:55:04.770

它存储的时间戳是自 1601 年 1 月 1 日午夜 UTC 以来的微秒数。要将其转换为当前时间，您可以在[此答案](https://stackoverflow.com/a/3174614/624900)的帮助下将您拥有的微秒数添加到纪元日期，如下所示：

```
>>> import datetime
>>> epoch_start = datetime.datetime(1601, 1, 1)
>>> delta = datetime.timedelta(microseconds=12979264931952304)
>>> epoch_start + delta
datetime.datetime(2012, 4, 18, 23, 22, 11, 952304) 
```

要转换为您的本地时区，您可以使用[此方法](https://stackoverflow.com/a/4771733/624900)（请注意，我目前是 UTC - 4，而看起来您是 UTC + 2）：

```
>>> from dateutil import tz
>>> from_zone = tz.tzutc()
>>> to_zone = tz.tzlocal()
>>> utc_time = (epoch_start + delta).replace(tzinfo=from_zone)
>>> utc_time.astimezone(to_zone)
datetime.datetime(2012, 4, 18, 19, 22, 11, 952304, tzinfo=tzlocal()) 
```

# multilingual - Setting up multilingual site with sitefinity in the form of mysite.com/us/home, mysite.com/fr/home

> ID：10219647
> 
> 赞同：0
> 
> 时间：2012-04-18T23:36:15.413
> 
> 标签：multilingual, sitefinity

Trying to set up a multilingual site with sitefinity.

The structure is

```
mysite.com/us/ - all US content
mysite.com/fr/ - all French content 
```

So, the home page for the US would be at

```
mysite.com/us/home 
```

and the home page for France would be at

```
mysite.com/fr/home 
```

How can I do that?

Site search should be limited to the currently selected locale (/fr/ or /us/ in this example).

What happens by default is that the US home page ends up in the root of the site, and the French under /fr/:

```
mysite.com/home     #US version, should appear under mysite.com/us/home
mysite.com/fr/home  #French version 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-29T05:05:11.140

您可以通过转到管理->设置来管理您想要支持的语言，然后从左侧菜单中选择“语言”。

这是一个更详细的视频。 [启用和创建多语言 Sitefinity 页面和内容](http://www.youtube.com/watch?v=k0qHyc0RwGk)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-17T17:32:17.383

您可以设置一个“虚拟”默认语言，该语言将路由到 mysite.com/home，然后将美国和法国添加为辅助语言。然后在 mysite.com/home 中，您可以添加一些逻辑来决定路由到哪个语言文件夹主页，或者只是在页面 html 中添加类似这样的内容以自动重定向到美国主页：

```
<script>
    window.location.replace('mysite.com/us/home');
</script> 
```

# javascript - Continuous animation on hover (performance)

> ID：10219649
> 
> 赞同：7
> 
> 时间：2012-04-18T23:36:23.463
> 
> 标签：javascript, jquery

I've created a jQuery function that scrolls a DIV by decreasing the left-margin of the element. It works, but it's incredibly slow. It eats up 100% CPU in no time :s

```
$(".scroll").hover(
    function () {
        var scroll_offset = parseInt($('#content').css('margin-left'));
        sliderInt = self.setInterval(function(){
            $content.css({'margin-left':scroll_offset+'px'});
            scroll_offset--;
        },8);
    }, 
    function () {
        clearInterval(sliderInt);
    }
); 
```

Obviously I am running this function every 8ms, which is asking a lot. I'm already cacheing my selectors, so I don't know what I can do to improve performance. Am I just going about it the wrong way?

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-19T00:35:07.983

```
function play () {
  $('#ball').animate({left: '+=20'}, 100, 'linear', play);
}

function pause () {
  $('#ball').stop();
}

$("#bar").hover( play, pause );
```

```
#bar {
  margin-top: 20px;
  background: #444;
  height: 20px;
}
#bar:hover #ball {
  background: lightgreen;
}

#ball {
  position: relative;
  left: 0;
  width: 20px;
  height: 20px;
  background: red;
  border-radius: 50%;
}
```

```
<div id="bar">
  <div id="ball"></div>
</div>

<script src="//code.jquery.com/jquery-3.1.0.js"></script>
```

如果没有 setInterval 甚至 setTimeout，这真的很**简单。**

*   唯一重要的是要知道`.animate()`接受函数回调，非常适合我们创建循环函数的目的。确保使用`linear`缓动而不是默认的“摆动”来使我们的循环保持不变。
*   要停止我们的动画，我们可以使用它`stop()`来防止动画堆积。
*   只需创建 2 个函数并在您的`hover`方法中使用它们。

* * *

# 使用 CSS3

并使用 jQuery 切换播放/暂停类：

```
function play() {
  $('#ball').addClass("play").removeClass("pause");
}

function pause() {
  $('#ball').addClass("pause"); // don't remove .play here
}

$("#bar").hover(play, pause);
```

```
#bar {
  margin-top: 20px;
  background: #444;
  height: 20px;
}
#bar:hover #ball {
  background: lightgreen;
}
#ball {
  position: relative;
  left: 0;
  width: 20px;
  height: 20px;
  background: red;
  border-radius: 50%;
}

.play {
  animation: ball-anim 5s infinite linear;
}
.pause {
  animation-play-state: paused;
}
@keyframes ball-anim {
  0%   { left: 0; }
  50%  { left: calc(100% - 20px); }
  100% { left: 0; }
}
```

```
<div id="bar">
  <div id="ball"></div>
</div>

<script src="//code.jquery.com/jquery-3.1.0.js"></script>
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:44:28.470

[.animate()](http://api.jquery.com/animate/)是一个很好的方法。例子：

```
$(".scroll").hover(function(){
  $("#content").animate({
    marginLeft: "100px",
  }, 1500 );
});​ 
```

[工作演示](http://jsfiddle.net/pFPjN/)

阅读文档以了解如何使用它。

# php - "trying to get property of non object" exception?

> ID：10219651
> 
> 赞同：0
> 
> 时间：2012-04-18T23:36:57.990
> 
> 标签：php

I'm trying to figure out I keept getting "trying to get property of non object in my view file. It says its an object in the print r function I ran on the $messages variable but yet it still says that error message.

```
Array ( 
[0] => stdClass Object ( 
    [id] => 1 [subject] => Testing Message 1 
    [firstName] => Jeffrey 
    [lastName] => Davidson 
    [dateSent] => April 1st, 2012 
    [messageRead] => 0 )
[1] => stdClass Object ( 
    [id] => 1 [subject] => Testing Message 1 
    [firstName] => Jeffrey 
    [lastName] => Davidson 
    [dateSent] => April 1st, 2012 
    [messageRead] => 0 ) ) 

<?php if (!is_null($messages[0])) { 
                    foreach ($messages[0] AS $message) { 
                        echo '<tr>'; echo '<td style="text-align: center">'; switch ($message->
                    messageRead) { case 0: echo '
                    <img src='.base_url().'assets/img/icons/packs/fugue/16x16/mail.png />
                    '; break; case 1: echo '
                    <img src='.base_url().'assets/img/icons/packs/fugue/16x16/mail-open.png />
                    '; break; case 2: echo '
                    <img src='.base_url().'assets/img/icons/packs/fugue/16x16/mail-reply.png />
                    '; break; case 3: echo '
                    <img src='.base_url().'assets/img/icons/packs/fugue/16x16/mail-forward.png />
                    '; break; } echo '
                    </td>
                    '; echo '
                    <td>
                        '.$message->dateSent.'
                    </td>
                    '; echo '
                    <td>
                        <a href='.base_url().'pmsystem/viewmessage/ '.$message->id.'>'.$message->subject.'</a>
                    </td>
                    '; echo '
                    <td>
                        '.$message->firstName.' '.$message->lastName.'
                    </td>
                    '; echo '
                    <td style="text-align: center">
                        '; $data = array('name' => 'message_id', 'class' => 'messages', 'value' => $message->id); echo form_checkbox($data); echo '
                    </td>
                    '; echo '
                    </tr>
                    '; } } ?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T23:40:37.927

假设`$messages`是对象数组，则需要在`$messages`变量上运行 foreach，而不是在第一个索引 ( `$messages[0]`)中的对象上

```
<?php
if (!is_null($messages))
{ 
   foreach ($messages AS $message) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:46:41.657

```
if (is_array($messages)) {
  foreach ($messages as $message) {
    echo $message->id . "\n";
  }
} 
```

# c# - Firing context menu from user control does not work

> ID：10219652
> 
> 赞同：0
> 
> 时间：2012-04-18T23:37:01.660
> 
> 标签：c#, wpf, xaml, listview, contextmenu

I try to use a context menu from a user control's list view but the command is not firing (neither enabling/disabling when needed).

Code:

```
<UserControl ....
    <UserControl.Resources>
        <ContextMenu x:Key="SharedInstanceContextMenu">
            <MenuItem Header="Edit" Command="{Binding ElementName=UC, Path=DataContext.EditSelectedItemCommand}" CommandParameter="{Binding}"/>
        </ContextMenu>

<Grid ...>
    <ListView ....>
        <ListView.ItemContainerStyle>
            <Style TargetType="ListViewItem">
                <Setter Property="IsSelected" Value="{Binding Path=IsSelected}"/>
                <Setter Property="ContextMenu" Value="{StaticResource SharedInstanceContextMenu}"/>
            </Style>
        </ListView.ItemContainerStyle> 
```

How can I make the command firing (and enabling/disabling, part of the command behavior)?

(btw, this questions seems similar to [Treeview context menu command not firing](https://stackoverflow.com/questions/9463589/treeview-context-menu-command-not-firing) but after trying all solutions there it still does not work.)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T01:11:49.690

您的输出窗口是否包含绑定错误，抱怨您的视图模型上不存在该命令？如果是这样，则可能意味着您的 ContextMenu 的 DataContext 设置不正确。上下文菜单不是可视化树的一部分，因为它们需要在元素顶部弹出，这意味着它们不会像其他控件那样继承其 DataContext。一种解决方案是使用 PlacementTarget 访问您的视图模型 - 请参阅[这篇文章](https://stackoverflow.com/questions/6914867/why-cant-i-use-datacontext-binding-for-my-context-menu)了解更多信息。

# android - Android - Change seekbar bar size

> ID：10219653
> 
> 赞同：0
> 
> 时间：2012-04-18T23:37:16.817
> 
> 标签：android, size, seekbar

I'm playing a bit with Android developing some sample applications and came across issue I can't get over with. I'd like to change width of "bar" of SeekBar view.

What I want could be better seen on screenshot provided

[http://i.stack.imgur.com/XczAf.png](http://i.stack.imgur.com/XczAf.png)

Could some please be so kind and help me out?

Thanks a lot in advance

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-23T07:12:36.800

您可以使用 thumb drawable 来更改高度和拇指图像 在 seekbar xml 文件中使用下面的行

```
android:thumb="@drawable/seekbar_thumb_draw"

<SeekBar
android:id="@+id/seekBar1"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:thumb="@drawable/seekbar_thumb_draw" /> 
```

//seekbar_thumb_draw.xml

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<item>
    <shape>
        <size
            android:height="40dp"
            android:width="40dp" />

        <solid android:color="@android:color/transparent" />
    </shape>
</item>
<item android:drawable="@drawable/seekbar_thumb_image"/> 
```

seekbar_thumb_image 是您想要的拇指图像

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:54:17.187

您想要的确切尺寸。然后将其保存在您的drawables文件夹中。然后在您的搜索栏的 xml 代码中引用它。

```
<SeekBar
        android:id="@+id/seekBar1"
        android:layout_width="wrap_contentt"
        android:layout_height="wrap_content"
        android:thumb="@drawable/seek_thumb_verywidebar" /> 
```

# c - Host Windows Media ActiveX Control pure C

> ID：10219662
> 
> 赞同：2
> 
> 时间：2012-04-18T23:38:23.713
> 
> 标签：c, winapi, activex, mingw, windows-media-player

Good day, I know, it's too hard to do, but i need know how to embed activex control (especially WMPlayer) in native window, using only win32 api (and no MS things such ATL, etc). I know how to deal with winapi, but don't know how to deal with com/activex. Need the simpliest way to embed activex.

# php - Twitter API Rate Limit for Multiple Users

> ID：10219664
> 
> 赞同：1
> 
> 时间：2012-04-18T23:38:40.053
> 
> 标签：php, api, twitter, twitter-oauth

I am writing a PHP-based application using the Twitter API. Up until now I've been using the REST API via a GET request on a PHP page. However, as my app scales, I can easily see it going over the 150 requests-per-hour limit. Here's why:

I have categories of topics, each which periodically poll the Twitter API for tweets around a topic. For example, I have: mysite.com/cars, mysite.com/trucks, etc. A user can go to either page. When he is on the page, live, refreshing updates are pulled from Twitter by making an AJAX call to a PHP page I've set up. The PHP page determines which category the user is coming from (cars, trucks), polls Twitter for search results, then returns the JSON to the category page. This sounds confusing, but there are a number of unrelated reasons I need to have the intermediate PHP page.

The problem is that since the PHP page is making the requests, it will eat up the rate limit very quickly (imagine if there were 20 categories instead of just cars and trucks). I can't make a single call with multiple parameters because it would combine multiple categories of tweets and I'd have no way to separate them. I can cache results, but if I did, the more categories I add, the longer each would have to go between API calls.

So how can I approach this problem? I looked at the streaming API, but it's only for oAuth'd users and I don't want my users to have to log in to anything. Can I use the stream on the PHP page and then just make continuous requests each time the category page polls the PHP page? Thanks for any help!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T08:15:31.433

a) 您不必在流式 API 中使用您网站用户的 oAuth 凭据 - 只需您的：将它们放在 dev.twitter.com 的某个位置并对其进行硬编码。您的用户不会知道后台有任何 oAuth。

b) 不要使用匿名请求（每个 IP 每小时 150 个）使用 oAuth 请求（每个 oAuth 每小时 350 个）。您不必要求您的用户登录 - 只需登录几个（1 次即可开始）您的私人 Twitter 帐户。如果您不喜欢创建 twitter 登录功能，您可以在 dev.twitter.com 中为您的 twitter 应用程序获取您的 twitter 帐户的凭据。

c）正如@Cheeso 提到的 - 缓存！不要让每个页面加载都发出 twitter 请求。

# c - Function with if statement

> ID：10219668
> 
> 赞同：0
> 
> 时间：2012-04-18T23:39:22.547
> 
> 标签：c

Hi I am new in the programming. I know how a function works and if statement, so I want to know how would I be able to write an if & else statement in a function and would display the answer to the user. there may not be any goto statements

The code is as follows:

```
 if(year < 1583) //considers if a year input is less than 1583 which is the starting year for this calendar
  {
       printf("\n\nPlease select a year after 1583 \n\n");
       goto YEAR;
       system("cls");
  }
  if(Leap_year(year))//if statement calls Leap Year function
  {
       printf("\t =======================  \n");
       printf("\t*  THIS IS A LEAP YEAR  *\n");      
       printf("\t =======================  \n\n"); 
  }
  else {
       printf("\t   =======================  \n");
       printf("\t*  THIS IS NOT A LEAP YEAR  *\n");
       printf("\t   =======================  \n\n"); 
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:45:05.663

无论是 C 还是 C#，您都可以使用`while`循环来解决这个问题。

```
do
{     
      // You need to prompt for year here.  Your code doesn't show how you do that.
      if (year < 1583)
      {
          printf("\n\nPlease select a year after 1583 \n\n");
          // Note: The user will never see the printf above if you clear the screen right after
          system("cls");
      }
} while (year < 1583); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:50:47.427

您正在寻找的解决方案是使用更多功能。

考虑：

```
// year == -1 means there was an error
int year = -1;
while (year != -1)
{
  PromptForYear();
  year = GetYear();
} 
```

此代码适用于 GetYear，如下所示：

```
int GetYear()
{
  int year;
  cin >> year;

  // check for bad year values
  if (year < 1583)
    return -1;

  return year;
} 
```

PromptForYear 可能是

```
void PromptForYear()
{
  cout << "\n\nPlease select a year after 1583 \n\n";
} 
```

我个人更喜欢 TryGetYear 方法：

```
while (true)
{
  PromptForYear();
  if (TryGetYear(&year))
  {
    break;
  }
}

// code for TryGetYear

bool TryGetYear(int* year)
{
  if (year == null)
    return false;

  cin >> *year;
  if (*year < 1583)
    return false;

  return true;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-18T23:46:24.297

删除`goto`- 添加一个 else

IE

```
 if(year < 1583) //considers if a year input is less than 1583 which is the starting year for this calendar 
  { 
          printf("\n\nPlease select a year after 1583 \n\n"); 
          system("cls"); 
  } 
  else
  { 
.... 
```

# javascript - 显示/隐藏 div，“一个接一个”和“一次全部”

> ID：10219669
> 
> 赞同：1
> 
> 时间：2012-04-18T23:39:32.340
> 
> 标签：javascript, toggle, togglebutton

我用它来显示/隐藏一些 div，最后我有一个按钮来一个一个地显示 div。

我怎样才能有第二个按钮来一次显示/隐藏所有这些按钮而不会过多地弄乱 HTML？

基本上每个 div 都包含一个输入字段，因此用户单击“再添加一个”按钮来获得一个额外的字段。默认情况下，所有字段都是隐藏的，所以我需要一个按钮来一次显示它们（我有 14 个 div 要显示/隐藏）。

任何帮助将不胜感激。

**Javascript**

```
var counter = 0;
var numBoxes = 3;
function toggle4(showHideDiv) {
       var ele = document.getElementById(showHideDiv + counter);
       if(ele.style.display == "block") {
              ele.style.display = "none";
       }
       else {
              ele.style.display = "block";
       }
       if(counter == numBoxes) {
                document.getElementById("toggleButton").style.display = "none";
       }
} 
```

**HTML**

```
<table>
   <tr>
      <td style="width: 150px;">
         <div id="box1" style="display: none;">First</div>
      </td>
      <td style="width: 150px;">
         <div id="box2" style="display: none;">Second</div
      </td>
      <td style="width: 150px;">
         <div id="box3" style="display: none;">Third</div
      </td>
   </tr>
</table>
<input id="toggleButton" type="button" value="Add one more!" onclick="counter++; toggle4('box');"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T23:53:39.493

这是基本功能，但需要一些改进：

```
var d = document,
    table = d.getElementsByTagName('table')[0],
    divs = table.getElementsByTagName('div'),
    toggle = d.getElementById('toggleButton'),
    allToggle = d.getElementById('allToggle'),
    count = 0;

function toggles(){    
    var elem = divs[count];
    elem.style.display = 'block';

    count++;
}

toggle.onclick = function(){
    toggles();
};

allToggle.onclick = function(){
    if (allToggle.getAttribute('data-show') == 1){
        for(var i=0,len=divs.length;i<len;i++){
            divs[i].style.display = 'none';
            allToggle.setAttribute('data-show',0);
            allToggle.value = 'Show all';
        }
    }
    else {
        for(var i=0,len=divs.length;i<len;i++){
            divs[i].style.display = 'block';
            allToggle.setAttribute('data-show',1);
            allToggle.value = 'Hide all';
        }
    }
}
​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/ABnUS/2/)。

以上基于以下HTML：

```
<table>
   <tr>
      <td style="width: 150px;">
         <div id="box1" style="display: none;">First</div>
      </td>
      <td style="width: 150px;">
         <div id="box2" style="display: none;">Second</div>
      </td>
      <td style="width: 150px;">
         <div id="box3" style="display: none;">Third</div>
      </td>
   </tr>
</table>
<input id="toggleButton" type="button" value="Add one more!" />
<input id="allToggle" type="button" value="Show all" />​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:40:27.673

有一个按钮，其功能是按类选择所有 div（您必须添加）并隐藏/显示它们。如果您只想要一个按钮，则必须记住您的状态，在下面的示例中，我使用全局按钮进行操作。

```
<button id="showhideall">

$(document).ready(function(){

var allshowing = true;

$("#showhideall").click(function(){
    alert(allshowing);
    if(allshowing){
        $(".foo").hide();
        allshowing=false;            
    } else {
        $(".foo").show();
    }
});
}​);​ 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-19T09:57:12.310

```
var counter = 0;
var numBoxes = 3;
function toggle4(showHideDiv) {
       var ele = document.getElementById(showHideDiv + counter);
       if(ele.style.display == "block") {
              ele.style.display = "none";
       }
       else {
              ele.style.display = "block";
       }
       if(counter == numBoxes) {
                document.getElementById("toggleButton").style.display = "none";
       }
}

function toggle3(contentDiv) {
        if (contentDiv.constructor == Array) {
                for(i=0; i < contentDiv.length; i++) {
                     toggle2(contentDiv[i]);
                }
        }
        else {
               toggle2(contentDiv);
        }
}

function toggle2(showHideDiv) {
    var ele = document.getElementById(showHideDiv);

    if(ele.style.display == "block") {
            ele.style.display = "none";

      }
    else {
        ele.style.display = "block";

    }
}

<input id="toggleButton" type="button" value="Show me the money!" onclick="counter++; toggle4('box');">

<input type="button" value="Press me to toggle all 3 DIVs" onClick="toggle3(['box1', 'box2', 'box3']);"> 
```

# ruby - Rails：Date.today 是 UTC 吗？

> ID：10219670
> 
> 赞同：45
> 
> 时间：2012-04-18T23:39:38.517
> 
> 标签：ruby, date, timezone

在 Ruby 中调用`Date.today`会返回当前日期。但是，它在哪个时区？我假设UTC，但我想确定。该[文档](http://ruby-doc.org/stdlib-1.9.3/libdoc/date/rdoc/Date.html#method-c-today)没有说明任何一种方式。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-06-01T06:40:59.137

你可以通过使用逃脱

`Time.now.utc.to_date`

在红宝石中

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2012-04-19T00:06:48.610

**TL;DR：** `Date.today`使用系统的本地时区。如果您要求它采用 UTC，请改为从 UTC 时间获取日期，例如`Time.now.utc.to_date`.

* * *

日期没有时区，因为它们不代表时间。

也就是说，至于它*如何*计算当天，让我们看一下[代码中的`Date.today`](https://github.com/ruby/ruby/blob/v1_9_3_125/ext/date/date_core.c#L3609)这段摘录：

```
time_t t;
struct tm tm;
// ...
if (time(&t) == -1)
  rb_sys_fail("time");
if (!localtime_r(&t, &tm))
  rb_sys_fail("localtime"); 
```

然后它继续使用 use`tm`来创建`Date`对象。由于`tm`使用 包含系统的本地时间[`localtime()`](http://linux.die.net/man/3/localtime)，`Date.today`因此使用系统的本地时间，而不是 UTC。

* * *

您始终可以使用[`Time#utc`](http://ruby-doc.org/core/Time.html#method-i-utc)任何`Time`将其就地转换为 UTC，或[`Time#getutc`](http://ruby-doc.org/core/Time.html#method-i-getutc)以 UTC 返回新的等效`Time`对象。然后，您可以调用[`Time#to_date`](http://ruby-doc.org/stdlib/libdoc/date/rdoc/Time.html#method-i-to_date)它来获取`Date`. 所以：`some_time.getutc.to_date`。

如果您使用[ActiveSupport 的时区支持](http://api.rubyonrails.org/classes/ActiveSupport/TimeWithZone.html)（Rails 中包含），请注意它与 Ruby 的时间构造函数完全分开，并且不会影响它们（即它不会改变方式`Time.now`或`Date.today`工作方式）。另请参阅[ActiveSupport 对`Time`](http://guides.rubyonrails.org/active_support_core_extensions.html#extensions-to-time).

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-04-19T00:07:25.527

Date 的实例表示为天文儒略日数；它没有一天的小数部分。虽然儒略日是相对于格林威治标准时间的——所以从技术上讲，一个日期的实例应该被认为是格林威治标准时间——在大多数情况下，你可以忽略它并将其视为没有时区。如果您将其转换为日期时间或时间，您只会关心时区。

ActiveSupport 的日期转换工具可让您指定您需要本地时间还是 UTC。

例如：

```
>> t = Date.today.to_time
=> Wed Apr 18 00:00:00 -0400 2012
>> t.zone
=> "EDT"
>> t = Date.today.to_time(:utc)
=> Wed Apr 18 00:00:00 UTC 2012
>> t.zone
=> "UTC" 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-10-14T04:55:31.890

您可以使用

```
Date.current 
```

获取配置时区的当前日期。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-08-24T14:09:16.263

如果您的 Rails 应用程序配置为在 UTC 时区运行，则只需使用`Time.zone.today`，否则通过使用强制它`Time.now.utc.to_date`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-12-22T00:15:37.213

## 红宝石

```
# Using local timezone
Date.today 
```

## Ruby on Rails

```
# Using UTC
Date.yesterday
Date.current
Date.tomorrow 
```

这特别令人讨厌，因为当使用 eg`Date.today`和`Date.yesterday`结合使用时，它可能会根据时区和当前时间产生非常意想不到的结果。

例如，欧洲中部时间 (UTC+1) 时区的 00:30`Date.yesterday`将比`Date.today`. 在其他情况下，`Date.today`和`Date.yesterday`可以具有相同的值。

# youtube - 使用 Fancybox 防止 YouTube 自动播放？

> ID：10219671
> 
> 赞同：1
> 
> 时间：2012-04-18T23:39:41.083
> 
> 标签：youtube, fancybox

如果我将 youtube 链接 Fancybox （而不是像通常没有 fancybox 那样嵌入代码），我如何避免在页面加载时自动播放？

我希望能够单击图像以开始播放。

[http://www.estherwarda.com/wci/homepage/](http://www.estherwarda.com/wci/homepage/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-11T17:51:31.477

如果您使用的是最新版本的 Fancybox (2+)，YouTube 和 Vimeo 现在可以很好地识别和处理。

然而，由于大多数文档都在 Fancybox 1 上，因此需要进行一些挖掘才能找到这一点。

Fancybox 会去除您的 YouTube 网址并添加一些默认参数：

*   **autoplay=1**（视频将自动播放）
*   **autohide=1**（播放视频后控件将隐藏）
*   **fs=1**（启用全屏）
*   **rel=0**（相关视频被隐藏）
*   **hd=1**（启用高清播放）
*   **wmode=opaque**（使用 YouTube 和灯箱修复 z-index）
*   **enablejsapi=1**（启用 Javascript API）

这意味着通常您可以在 URL 中传递这些参数并应用它们，但 Fancybox 2 会忽略这些参数并使用预设值。

不要沮丧！您可以覆盖脚本中的那些。几种方式。

**普通媒体嵌入：**

```
 $(".fancybox").fancybox({
      helpers : {
          media: true
      }
  }); 
```

**自定义 URL 参数方法一：**

```
 $(".fancybox").fancybox({
      helpers : {
          media: {
              youtube : {
                  params : {
                      autoplay : 0
                  }
              }
          }
      }
  }); 
```

**自定义 URL 参数方法二：**

```
 $(".fancybox").fancybox({,
       helpers : {
          media: true
      },
      youtube : {
          autoplay: 0
      }
  }); 
```

查看 helpers > jquery.fancybox-media.js 文件以获取更多详细信息（查看评论）。Fancybox 2 还支持多种 URL 格式，因此您无需担心应该使用哪个 URL 版本（即*youtube.com/watch?v=###*与*youtu.be/###*）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T23:55:39.977

这是关于你的嵌入代码。Youtube 的旧默认嵌入代码如下所示：`http://www.youtube.com/v/bla?version=3`. 可以采用自动播放参数来控制加载时的播放。你可以推`&autoplay=0`回`http://www.youtube.com/v/bla`

```
http://www.youtube.com/v/bla?version=3&autoplay=0 
```

# python - 为什么某些引用 `xy` 的表达式会更改 `id(xy)`？

> ID：10219672
> 
> 赞同：6
> 
> 时间：2012-04-18T23:39:49.780
> 
> 标签：python, cpython

这个问题与（至少）CPython 2.7.2 和 3.2.2 相关。

假设我们定义`Class`和`obj`如下。

```
class Class(object):

    def m(self):
        pass

    @property
    def p(self):
        return None

    @staticmethod
    def s():
        pass

obj = Class() 
```

# 简洁版本

为什么`False`每个都输出以下代码`print()`？

```
print(Class.__dict__ is Class.__dict__)
print(Class.__subclasshook__ is Class.__subclasshook__)
print(Class.m is Class.m)

print(obj.__delattr__ is obj.__delattr__)
print(obj.__format__ is obj.__format__)
print(obj.__getattribute__ is obj.__getattribute__)
print(obj.__hash__ is obj.__hash__)
print(obj.__init__ is obj.__init__)
print(obj.__reduce__ is obj.__reduce__)
print(obj.__reduce_ex__ is obj.__reduce_ex__)
print(obj.__repr__ is obj.__repr__)
print(obj.__setattr__ is obj.__setattr__)
print(obj.__sizeof__ is obj.__sizeof__)
print(obj.__str__ is obj.__str__)
print(obj.__subclasshook__ is obj.__subclasshook__)
print(obj.m is obj.m) 
```

（这适用于 Python 2；对于 Python 3，省略`print()`for并为、、、、和`Class.m`添加类似`print()`的 s ）`obj.__eq__``obj.__ge__``obj.__gt__``obj.__le__``obj.__lt__``obj.__ne__`

另一方面，为什么会`True`为每个输出以下代码`print()`？

```
print(Class.__class__ is Class.__class__)
print(Class.__delattr__ is Class.__delattr__)
print(Class.__doc__ is Class.__doc__)
print(Class.__format__ is Class.__format__)
print(Class.__getattribute__ is Class.__getattribute__)
print(Class.__hash__ is Class.__hash__)
print(Class.__init__ is Class.__init__)
print(Class.__module__ is Class.__module__)
print(Class.__new__ is Class.__new__)
print(Class.__reduce__ is Class.__reduce__)
print(Class.__reduce_ex__ is Class.__reduce_ex__)
print(Class.__repr__ is Class.__repr__)
print(Class.__setattr__ is Class.__setattr__)
print(Class.__sizeof__ is Class.__sizeof__)
print(Class.__str__ is Class.__str__)
print(Class.__weakref__ is Class.__weakref__)
print(Class.p is Class.p)
print(Class.s is Class.s)

print(obj.__class__ is obj.__class__)
print(obj.__dict__ is obj.__dict__)
print(obj.__doc__ is obj.__doc__)
print(obj.__module__ is obj.__module__)
print(obj.__new__ is obj.__new__)
print(obj.__weakref__ is obj.__weakref__)
print(obj.p is obj.p)
print(obj.s is obj.s) 
```

（这适用于 Python 2；对于 Python 3，为, , , , , 和, and添加类似`print()`的 s ）`Class.__eq__``Class.__ge__``Class.__gt__``Class.__le__``Class.__lt__``Class.__ne__``Class.m`

# 长版

如果我们连续请求`id(obj.m)`两次，我们（不出所料）会两次获得相同的对象 ID。

```
>>> id(obj.m)
139675714789856
>>> id(obj.m)
139675714789856 
```

但是，如果我们请求`id(obj.m)`，然后评估一些引用 的表达式`obj.m`，然后再次请求`id(obj.m)`，我们有时（但并非总是）发现对象 ID 已更改。在它发生变化的情况中，在某些情况下，再次请求`id(obj.m)`会导致 ID 变回原始值。在没有变回的情况下，在`id(obj.m)`调用之间重复表达式显然会导致 ID 在两个观察值之间交替。

以下是对象 ID 不变的一些示例：

```
>>> print(obj.m); id(obj.m)
<bound method Class.m of <__main__.Class object at 0x7f08c96058d0>>
139675714789856
>>> obj.m is None; id(obj.m)
False
139675714789856
>>> obj.m.__func__.__name__; id(obj.m)
'm'
139675714789856
>>> obj.m(); id(obj.m)
139675714789856 
```

这是一个对象 ID 更改然后又变回的示例：

```
>>> obj.m; id(obj.m); id(obj.m)
<bound method Class.m of <__main__.Class object at 0x7f08c96058d0>>
139675715407536
139675714789856 
```

这是一个对象 ID 发生变化，然后不会变回的示例：

```
>>> obj.m is obj.m; id(obj.m); id(obj.m)
False
139675715407536
139675715407536 
```

这是相同的示例，操作表达式重复了几次以演示交替行为：

```
>>> obj.m is obj.m; id(obj.m); id(obj.m)
False
139675714789856
139675714789856
>>> obj.m is obj.m; id(obj.m); id(obj.m)
False
139675715407536
139675715407536
>>> obj.m is obj.m; id(obj.m); id(obj.m)
False
139675714789856
139675714789856 
```

因此，整个问题由以下部分组成：

*   作为不修改这些属性的表达式的副作用，哪些类型的属性可能会改变它们的身份？

*   什么样的表达方式会触发这种变化？

*   导致这种变化的机制是什么？

*   过去的身份在什么条件下被回收？

*   为什么不无限期地回收第一个身份，这样可以避免所有这些复杂性？

*   有这些记录吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T23:59:27.703

> 作为不修改这些属性的表达式的副作用，哪些类型的属性可能会改变它们的身份？

属性，或更准确地说是实现[描述符协议](http://docs.python.org/howto/descriptor.html)的对象。例如，`Class.__dict__`is not a `dict`but a `dictproxy`。显然，每次请求时都会重新生成该对象。为什么？可能是为了减少创建对象的开销，直到有必要这样做。然而，这是一个实现细节。重要的是，它的`__dict__`工作方式与文档一致。

即使是普通的实例方法也使用描述符来处理，这就解释了为什么`obj.m is not obj.m`。有趣的是，如果您`obj.m = obj.m`将方法包装器*永久*存储在实例上，然后`obj.m is obj.m`. :-)

> 什么样的表达方式会触发这种变化？

任何对属性的访问都可以触发`__get__()`一个描述符的方法，而这个方法总是可以返回相同的对象或者每次都返回不同的对象。

> 导致这种变化的机制是什么？

属性/描述符。

> 过去的身份在什么条件下被回收？

不知道你所说的“回收”是什么意思。您的意思是“丢弃”或“重复使用”？在 CPython 中，`id`对象的 是它的内存位置。如果两个对象在不同时间最终位于相同的内存位置，它们将具有相同的`id`. `id` *因此，在不同时间*（甚至在单个语句中）相同的两个引用不一定是同一个对象。其他 Python 实现使用不同的规则来生成`id`s。例如，我相信 Jython 使用递增整数，这可以更清楚地了解对象标识。

> 为什么不无限期地回收第一个身份，这样可以避免所有这些复杂情况？

据推测，使用描述符有一些优势。Python解释器的源代码可用；如果您想了解更多详细信息，请查看。

> 有这些记录吗？

不，这些是 CPython 解释器的特定于实现的细节，不应依赖这些细节。其他 Python 实现（包括 CPython 的未来版本）可能并且很可能会有不同的行为。例如，2.x 和 3.x CPython 之间存在显着差异。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T03:07:06.670

当您编写 xy 时，会创建一个绑定或未绑定的方法。这是一个新对象。它可以去内存中的任何地方。如果你写 xy 并且不使用结果，它的 refcnt 可以归零被收集。这意味着内存可用并且可以被下一个 xy 使用，可能在同一位置，但不一定。

请注意，CPython 对对象身份的保证很少（即保证只有一个*None*实例）；否则，您所看到的大部分内容都是可能会改变的任意实现选择。

# php - MySQL复杂查询没有返回正确的结果

> ID：10219676
> 
> 赞同：1
> 
> 时间：2012-04-18T23:40:36.133
> 
> 标签：php, mysql, null

我有以下查询：

```
'SELECT * FROM posts LEFT JOIN taxi ON taxi.taxiID = posts.postID
    WHERE (taxi.value = 1 AND taxi.userID ='.$userID.') 
    AND ??????????????
    ORDER BY taxi.ID DESC
    LIMIT 10' 
```

该网站的工作方式是用户可以将帖子标记为“喜欢”。当一个帖子被点赞时，出租车表会被赋予一个新的行，taxiID 与 postID 相同，userID 用于存储喜欢该帖子的用户，并将`value`其设置为 1。不喜欢帖子设置`value`为 0。

我想显示所有`value`为 1 且`userID`为`$userID`- 检查的帖子。但是，我还希望查询显示用户尚未喜欢帖子的所有帖子。问题是，如果用户还没有喜欢过帖子，`userID`则`NULL`对应`value`的`NULL`. 如果我对此进行查询，我将跳过其他用户喜欢但用户没有喜欢的那些帖子。

这是`taxi`表格：

```
ID    taxiID    userID    value
1     1         1         1
2     1         6         1
3     1         4         0
4     2         1         0
5     2         6         1
6     2         4         0
7     3         6         1
8     3         4         0 
```

假设`$userID`是 1，我的查询应该显示`taxiID`1 和 3（因为用户 1 喜欢`ID`1 并且没有喜欢或不喜欢`taxiID`3。

我发布的代码只会显示`taxiID`1。

问题是，我的查询中缺少的行应该是上面给出的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T23:55:31.473

似乎您想找到`taxiID`该用户不喜欢的所有内容：

```
SELECT taxiID 
FROM taxi
GROUP BY taxiID
HAVING taxiID NOT IN 
      ( SELECT taxiID
        FROM taxi 
        WHERE userID = '.$userID.'
          AND value = 0
      )
ORDER BY taxiID DESC
LIMIT 10 
```

在[SQL-Fiddle中测试](http://sqlfiddle.com/#!2/c2f17/2)

* * *

你可能有一张`post`桌子，所以最好使用：

```
SELECT *                               --- whatever columns from `post` table
FROM post
WHERE postID NOT IN                     
      ( SELECT taxiID
        FROM taxi 
        WHERE userID = '.$userID.'
          AND value = 0
      )
ORDER BY postID 
LIMIT 10 
```

* * *

如果这`taxi.taxiID`意味着`postID`，那么您应该将其重命名为`taxi.postID`. 这是非常令人困惑的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T00:37:08.557

我将此作为评论，但我认为这是我的最终答案：

```
SELECT * FROM posts 
LEFT JOIN taxi ON taxi.taxiID = posts.postID
WHERE (taxi.value != 0 AND taxi.userID ='.$userID.') 
OR taxi.value is null
ORDER BY taxi.ID DESC
LIMIT 10 
```

好的，这就是上述查询应该发生的情况：

1.  获取所有帖子
2.  添加出租车表中的信息，并通过 postID 将出租车数据与邮政数据相关联
3.  仅显示 tax.value 是否不为 0（意味着它可以为 null 或 1）并且 userID 是否与我们的变量相同

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T00:01:32.377

假设 tax.taxiID 与 post.ID 相同，并且您希望选择所有尚未被用户标记的帖子，请尝试：

```
SELECT * FROM post WHERE ID NOT IN
(SELECT taxiID FROM taxi WHERE userID = 1) 
```

这当然适用于 ID=1 的用户。

# c# - 如何将初始表单上选择的值传递给主表单？

> ID：10219678
> 
> 赞同：0
> 
> 时间：2012-04-18T23:40:48.353
> 
> 标签：c#, winforms, modal-dialog

我想在这里做类似答案的事情：

[如何在不关闭应用程序的情况下关闭登录表单并显示主表单？](https://stackoverflow.com/questions/4759334/how-can-i-close-a-login-form-and-show-the-main-form-without-my-application-closi)

...但我想将初始表单上选择的值传递给下一个（主）表单。如果我在主窗体上调用重写的构造函数，同时我应该在哪里存储值（在初始窗体被解除和主窗体被调用之间）？

OTOH，如果我不使用 program.cs 文件来执行此操作，而是在主窗体的 Load() 事件中创建“初始窗体”（有没有更好的地方），我可以做这样的事情，但不可否认它似乎相当笨拙：

0) 将主窗体的大小设置为 0,0 以将其隐藏 1) 显示“初始”窗体/模式对话框，并将用户选择的值（在按钮单击事件中）存储在窗体全局变量中 2) 一旦初始窗体/模态对话框关闭，将主窗体的大小设置回应有的大小（除非模态结果 <> OK，在这种情况下我关闭主窗体和应用程序）

我知道有更好的方法来做到这一点......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:55:21.543

您不必将值传递给主窗体。就像您的链接解释的那样，首先打开您的主表单。然后你的主窗体可以打开另一个窗体。这种另一种形式可以将信息放在主窗体可以访问的公共属性中。由于主窗体控制另一个窗体的生命周期，因此主窗体获取保存在另一个窗体的公共属性中的信息，然后关闭另一个窗体。

```
string myVariable;

using (OtherForm otherForm = new OtherForm())
{
  otherForm.ShowDialog();
  myVariable = otherForm.OtherVariable;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T00:01:41.940

尝试使用 ApplicationContext (System.Windows.Forms.ApplicationContext)。您可以显示多个表单，如以下 MSDN 线程中的示例所示。关于数据，您可以拥有一个创建一次的通用数据对象，并在显示之前使用传递给它们的数据对象对表单进行实例化。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.applicationcontext%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.applicationcontext%28v=vs.100%29.aspx)

# javascript - 为什么奇数/偶数不适用于附加元素？

> ID：10219679
> 
> 赞同：0
> 
> 时间：2012-04-18T23:40:55.087
> 
> 标签：javascript, jquery

在以下 JQuery/JS 代码中——

```
$("a#go-to-videos").click(function(event){
    var hello = 'hello'
    event.preventDefault();
    if ($(this).text().length <= 30) {
    $(this).parent().parent().append($('<li>hello</li>'));
}   else {
    return
}

});

$("ul#odd-even li:odd").addClass("odd") 
```

当我点击添加一个新项目时，`$("ul#odd-even li:odd").addClass("odd")`它不适用吗？为什么会这样，最好的解决方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-18T23:42:32.970

看起来 addClass 实际上并没有发生 onClick。您应该`$("ul#odd-even li:odd").not('.odd').addClass("odd")`在 click 函数中添加。

# ruby-on-rails - 在不中断用户会话的情况下将 Rails 非 www 重定向到 www？

> ID：10219680
> 
> 赞同：2
> 
> 时间：2012-04-18T23:40:56.520
> 
> 标签：ruby-on-rails, cookies

好的，所以我想将所有非 www 域请求重定向到 www.mydomain.com 只是为了谷歌/搜索引擎的一致性（我知道所有关于规范标签/谷歌网站管理员工具的知识，让我们忽略它）

我知道通过 Nginx（或 Apache 的 htaccess）执行此操作的标准方法。

但是，问题是这可能会破坏用户会话，对吗？例如，如果有人通过 domain.com 登录，他们的 cookie 将仅对 domain.com 有效，而不是 www.domain.com，因此通过重定向我会让所有用户都必须再次登录。

有没有办法在不中断用户会话的情况下进行重定向？

也许我可以做一些检查cookies的事情？如果它不存在，则进行重定向。如果是，则不要重定向。

```
def index #controller method for requests from domain.com or www.domain.com
   @user = @requestManager.authorizedUser(cookies, params, logger) //check for cookies

   #if no cookies (Google bot or new visitor) 
   #and request is from domain.com, redirect to www.domain.com

   if(@user == nil and request.host =~ /^domain.com/)
            logger.info("Redirecting")
            redirect_to "http://www.domain.com", :status => 301
            return
    end
end 
```

这是否可以将非 www 重定向到 www.domain.com，并且不会中断当前用户会话？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T02:22:02.363

如果没有明确设置 cookie 的域，它将被限制为设置它的站点的主机名。

如果您的用户有您真正重视的长期会话，那么这可能会实现您的目标：

1.  修改您的网站以使用所有 cookie 设置域。
2.  当用户访问站点时，使用 firebug 检查 cookie 是否与新域一起重新发布
3.  等待一段时间，直到您的大多数用户都访问过该站点
4.  启用重定向

会话将丢失的用户是在等待期间未访问该站点的用户。

# java - 每个控制器的 Spring 3 属性文件

> ID：10219681
> 
> 赞同：1
> 
> 时间：2012-04-18T23:40:59.047
> 
> 标签：java, spring, spring-mvc

我想知道 Spring 是否具有类似于 Struts2 的属性文件机制，它首先在与控制器相同的包中查找属性文件，然后向上移动包结构，直到找到属性文件或属性。

我想为每个控制器定义一个属性文件，但如果可能的话，我宁愿不必将它们连接在一起。是否有一些可以遵循的约定将属性文件与控制器相关联？解析语言环境时，属性文件解析也应该正常工作。

例如，如果我在几个 prop 文件中定义了一个名为“title”的属性，我希望根据处理请求的控制器在 JSP 中解析正确的属性。

```
ControllerA RETURNS ViewA USES PropA.title

ControllerB RETURNS ViewB USES PropB.title 
```

我成功地将属性文件自动连接到控制器的模型属性并在 JSP 中显示值。我还能够在配置中指定 ResourceBundleMessageSource，然后在 JSP 中显示其中的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-20T03:40:25.640

开箱即用，不是我所知道的......但你可以很容易地写一个，如果那是你真正想要的！

Spring 有像 BeanFactoryPostProcessor 这样的东西，它可以让你用你的 BeanFactory/ApplicationContext 做这样的事情。我认为 BeanFactoryPostProcessor 适合这里的账单 - 您可以通过在类路径上查找属性文件、获取属性并将它们应用到 bean 来“后处理”一个 bean。

不过我会这么说——春天通常意味着相当无创。如果你想让这样的东西成为你设计的一部分，你可能想想办法在纯 Java 中做到这一点，而不是使用 Spring。例如，创建自己的工厂并分别实现和单元测试。要求您的应用程序使用此工厂来获取您的业务对象。

换句话说，您可能可以在 Spring 中做到这一点——但这并不总是最好的方法。在您的情况下，这听起来确实是最方便的，但我还没有看到您正在设置的内容和位置的详细信息。只是思想的食物..

# file-io - 在lisp中将字符串写入文件

> ID：10219682
> 
> 赞同：1
> 
> 时间：2012-04-18T23:41:04.567
> 
> 标签：file-io, lisp, common-lisp

我运行了一些这样的代码

```
(defun writeFile (name content)
    (with-open-file (stream name
        :direction :output
        :if-exists :overwrite
        :if-does-not-exist :create)
    (format stream content)))
(writeFile "C:\Users\Peter\test.txt" "Test...") 
```

但后来我检查了我的`C:\Users\Peter`目录，它不包含创建一个名为`test.txt`. 我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T23:48:25.763

`\`是 Common Lisp 中字符串中的转义字符。

`(length "\\")`是`1`。

`(length "\U")`是`1`。

`"\U"`是`"U"`。

`"C:\Users\Peter\test.txt"`是`"C:UsersPetertest.txt"`。

因此，您正在编写一个名为`"C:UsersPetertest.txt"`.

三种可能的解决方案：

*   用反斜杠转义反斜杠
*   我不确定这是否有效：使用正斜杠
*   使用 PATHNAME 函数之一来构造路径名

高级：使用逻辑路径名

# java-ee-6 - 有状态会话 Bean 的钝化问题

> ID：10219685
> 
> 赞同：3
> 
> 时间：2012-04-18T23:41:38.607
> 
> 标签：java-ee-6, jboss6.x, jboss-weld

我正在使用 JBoss 6.1 Final，并在我的 Web 应用程序运行一段时间后收到以下错误消息（注意应用程序不会崩溃），然后是很长的堆栈跟踪。我注意到只有在有状态会话 bean 中注入了其他有状态会话 bean 时才会出现此问题。

> 16:10:59,769 错误 [org.jboss.ejb3.cache.simple.SimpleStatefulCache.UutSerialNumberServiceBean] 问题钝化线程：javax.ejb.EJBException：无法钝化；未能保存状态

这是有问题的有状态会话 bean...

```
package com.ray.TEI.ejb;

import java.io.Serializable;

import javax.ejb.Stateful;
import javax.inject.Inject;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.PersistenceContextType;

import com.ray.TEI.model.TestProcedure;
import com.ray.TEI.model.Uut;
import com.ray.TEI.model.UutSerialNumber;

@Stateful
public class UutSerialNumberServiceBean implements Serializable {
  private static final long serialVersionUID = 1L;
  @PersistenceContext(unitName="jasoni", type=PersistenceContextType.EXTENDED)
  protected EntityManager em;
  @Inject private ExecProcedureServiceBean execProcedureServiceBean;

  public boolean isDuplicateSerialNumber(Uut uut, String serialNumber) {
    return ((Number)em.createNamedQuery("UutSerialNumber.getCountByUutIdAndSerialNumber")
             .setParameter("uut", uut)
             .setParameter("serialNumber", serialNumber)
             .getSingleResult()).intValue() > 0;
  }

  public UutSerialNumber findUutSerialNumberByUutSerialNumberId(Integer uutSerialNumberId) {
    return em.find(UutSerialNumber.class, uutSerialNumberId);
  }

  public UutSerialNumber editSerialNumber(Integer uutSerialNumberId, String serialNumber) {
    UutSerialNumber uutSerialNumber = findUutSerialNumberByUutSerialNumberId(uutSerialNumberId);
    uutSerialNumber.setSerialNumber(serialNumber);
    return uutSerialNumber;
  }

  public UutSerialNumber createSerialNumber(Uut uut, String serialNumber) {
    UutSerialNumber uutSerialNumber = new UutSerialNumber();
    uutSerialNumber.setSerialNumber(serialNumber);
    uutSerialNumber.setUut(uut);
    uut.getSerialNumbers().add(uutSerialNumber);
    em.persist(uutSerialNumber);
    for (TestProcedure testProcedure : uut.getTestProcedures()) {
      execProcedureServiceBean.createExecProcedure(uutSerialNumber, testProcedure);
    }
    return uutSerialNumber;
  }
} 
```

这是注入的有状态会话 bean...

```
package com.ray.TEI.ejb;

import java.io.Serializable;

import javax.ejb.Stateful;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;
import javax.persistence.PersistenceContextType;

import com.ray.TEI.model.ExecProcedure;
import com.ray.TEI.model.TestProcedure;
import com.ray.TEI.model.UutSerialNumber;

@Stateful
public class ExecProcedureServiceBean implements Serializable {
  private static final long serialVersionUID = 1L;
  @PersistenceContext(unitName="jasoni", type=PersistenceContextType.EXTENDED)
  protected EntityManager em;

  public ExecProcedure createExecProcedure(UutSerialNumber uutSerialNumber, TestProcedure testProcedure) {
    ExecProcedure execProcedure = new ExecProcedure();
    execProcedure.setUutSerialNumber(uutSerialNumber);
    execProcedure.setTestProcedure(testProcedure);
    execProcedure.setIterationCount(0);
    em.persist(execProcedure);
    return execProcedure;
  }
} 
```

有人知道这有什么问题吗？

谢谢，杰森

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T11:23:40.223

`EntityManager` [不可序列化](http://docs.oracle.com/javaee/6/api/javax/persistence/EntityManager.html)，我想这就是它失败的原因。

从这里有几个选择：

*   停用钝化（如果您不需要该机制，最简单的选择）
*   从 SFSB 中删除持久性上下文（这很可能会杀死您的扩展模式）
*   *用可*序列化的 Hibernate-Session 替换 EntityManager （考虑到实验性，我自己从未尝试过）

# java - IntelliJ IDEA 不会在调试时将应用服务器描述符和静态 Web 文件复制到其临时文件夹

> ID：10219686
> 
> 赞同：3
> 
> 时间：2012-04-18T23:41:53.670
> 
> 标签：java, google-app-engine, gwt, intellij-idea

你们知道为什么 IntelliJ IDEA 不会在调试时将应用服务器描述符文件复制到临时文件夹吗？

我有 gae+gwt 项目。我创建了使用 dev google app 服务器作为服务器的 gwt 调试配置。

当我启动调试会话时，它失败并出现以下错误：

```
Connected to the target VM, address: '127.0.0.1:44527', transport: 'socket'
Initializing App Engine server
Apr 18, 2012 11:35:20 PM com.google.apphosting.utils.jetty.JettyLogger info
INFO: Logging to JettyLogger(null) via com.google.apphosting.utils.jetty.JettyLogger
Apr 18, 2012 11:35:20 PM com.google.apphosting.utils.config.AppEngineWebXmlReader readAppEngineWebXml
SEVERE: Received exception processing C:\Users\root\.IntelliJIdea11\system\gwt\courierapp.courierapp23c0d1f4\Server.3565aa46\run\www\WEB-INF/appengine-web.xml
com.google.apphosting.utils.config.AppEngineConfigException: Could not locate C:\Users\root\.IntelliJIdea11\system\gwt\courierapp.courierapp23c0d1f4\Server.3565aa46\run\www\WEB-INF\appengine-web.xml
    at com.google.apphosting.utils.config.AppEngineWebXmlReader.getInputStream(AppEngineWebXmlReader.java:108)
    at com.google.apphosting.utils.config.AppEngineWebXmlReader.readAppEngineWebXml(AppEngineWebXmlReader.java:66) 
```

并且确实既不`appengine-web.xml`也不`web.xml`存在于`C:\Users\root\.IntelliJIdea11\system\gwt\courierapp.courierapp23c0d1f4\Server.3565aa46\run\www\WEB-INF`. 我的 htmls 或其他统计文件也没有被复制。

如果我手动复制它们一切正常。

所以基本上IDEA只复制java类和依赖的jar。

这是我的调试配置的样子：[i39.tinypic.com/nwzuvc.jpg](http://i39.tinypic.com/nwzuvc.jpg)

我使用 IDEA 117.216

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T01:37:44.927

我想通了 :) 这个谜团困扰了我好几个月！

在我从源代码重新创建所有模块和项目后，我注意到这个问题出现了。

问题是没有在 GWT 模块中设置 Target Web Faced。

![在此处输入图像描述](../Images/e1026bc67baaf746671d51804bc2f77a.png)

**不需要工件就可以使其工作。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:14:21.270

1.  请向我们展示您的工件的屏幕截图。打开“项目结构”窗口，然后从左侧窗格中选择“工件”。

2.  有时删除缓存并重建项目可以解决 IDEA 的怪异行为。尝试清除缓存然后构建和调试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-04T17:16:24.003

感谢@bjenkins01 对另一个答案的评论，我通过选中*Project Structure/Artifacts*选项卡中的**Build on make**复选框解决了这个问题。

# php - PHP 仅回显一次以仅显示一张图像

> ID：10219694
> 
> 赞同：0
> 
> 时间：2012-04-18T23:42:44.093
> 
> 标签：php, for-loop, wordpress

我试图弄清楚如何编写代码以仅在循环内显示一次图像。

例如在 Wordpress 中

```
<?php if (have_posts()) : while (have_posts()) : the_post(); ?> 
```

在那个循环中，我只想在第一个帖子上放置一个图像。

我只知道如何在 C 和 C++ 中做到这一点，但我不知道这在 PHP 上是如何工作的？

这是我为实现这一目标所做的。感谢@Jack。

首先，我在 Wordpress 后循环开始之前声明了一个变量。

```
<?php

$displayed = false;

?> 
```

然后我有@Jack 建议的代码，稍作修改。

```
<?php

$image = 'your image URL';

    if (!$displayed)
    {
         echo $image;
         $displayed = true;

    }

    ?> 
```

就是这样，现在我只能进行一次图片展示！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-18T23:48:07.807

在循环中放置一个条件。

```
$displayed = false;
while ($someVariable)
{
    if (!$displayed)
    {
         echo $image;
         $displayed = true;
    }
} 
```

# javascript - 用数据计算输入和文本区域的数量

> ID：10219703
> 
> 赞同：2
> 
> 时间：2012-04-18T23:43:51.227
> 
> 标签：javascript, jquery, count

我有一个仅适用于 jquery 1.7.2 的脚本。我也与这个脚本发生了很多冲突。

这种方法有替代方法吗？我正在尝试计算其中输入数据的输入和文本区域的数量。我只需要一个号码。

这是我当前的脚本：

```
$('#form_register').on('keyup', function() {
var number = $('#form_register').find('input, textarea')
// filter out every empty input/textarea
.filter(function() {
    return $(this).val() != '';
}).length;
$('.inputCount').val('There are ' + number + ' empty input fields');
console.log('test');
});​ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:01:34.737

我也会使用`change`处理程序，以防止有人将文本粘贴到字段中。

**编辑：**
按照您在评论中的要求向上计数：

## *[jsBin 演示](http://jsbin.com/oguzaj/edit#javascript,html,live)*

```
$('#form_register').on('keyup change', function() {
    var number = 0;
    $(this).find('input, textarea').each(function(){
       if( this.value !== ''){
          $('.input_count').val(number++);
       }
    });       
}); 
```

要重做向下计数（[演示](http://jsbin.com/oguzaj/2/edit)） ，只需使用`===`并排除*打印*：`each function`

```
 if( this.value === ''){
          number++;
       }
       $('.input_count').val(number); 
```

如果您有更多问题，请尝试将代码包装到：

```
(function($){ // remap '$' to jQuery

    // CODE HERE

})(jQuery); 
```

# python - 如何复制多行？

> ID：10219705
> 
> 赞同：0
> 
> 时间：2012-04-18T23:44:00.310
> 
> 标签：python, regex

我有以下文件：

```
this is the first line
and this is the second line
now it is the third line
wow, the fourth line
but now it's the fifth line
etc...
etc...
etc... 
```

从“现在是第三行”到“但现在是第五行”，我如何复制这三行（不知道这些行的行号）？在 perl 中，您将执行以下操作：

```
/^now it is/../^but now/ 
```

python中的等价物是什么？

我有（显然只抓住了 1 行）：

```
regex = re.compile("now it is")
for line in content:
    if regex.match(line):
        print line 
```

编辑：

```
reg = re.compile(r"now it is.*but now it.*", re.MULTILINE | re.DOTALL)

matches = reg.search(urllib2.urlopen(url).read())
for match in matches.group():
    print match 
```

这打印：

```
n
o
w

i
t

i
s

.
.
. 
```

即它返回字符而不是完整的行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:57:32.783

我想你只需要看看[`re.MULTILINE`flag](http://docs.python.org/library/re.html#re.MULTILINE)。多亏了它，您可以执行类似的匹配并从您想要的行中获取组合的文本。

**编辑：**

完整的解决方案包括使用`re.MULTILINE`和`re.DOTALL`标志，以及非贪婪的正则表达式：

```
>>> text = """this is the first line
and this is the second line
now it is the third line
wow, the fourth line
but now it's the fifth line
etc...
etc...
etc..."""
>>> import re
>>> match = re.search('^(now it is.*?but now.*?)$', text, flags=re.MULTILINE|re.DOTALL)
>>> print match.group()
now it is the third line
wow, the fourth line
but now it's the fifth line 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T00:07:27.120

你可以很容易地制作一个发电机来做到这一点

```
def re_range(f, re_start, re_end):
    for line in f:
        if re_start.match(line):
            yield line
            break
    for line in f:
        yield line
        if re_end.match(line):
            break 
```

你可以这样称呼它

```
import re

re_start = re.compile("now it is")
re_end = re.compile("but now")
with open('in.txt') as f:
    for line in re_range(f, re_start, re_end):
        print line, 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-18T23:46:52.387

```
f = open("yourfile") #that is, the name of your file with extension in quotes
f = f.readlines() 
```

现在 f 将是文件中每一行的列表。f[0] 将是第一行， f[1] 第二行，依此类推。要获取第三到第五行，您可以使用 f[2:5]

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-18T23:51:26.953

类似的东西？

```
import re
valid = False
for line in open("/path/to/file.txt", "r"):
    if re.compile("now it is").match(line):
        valid = True
    if re.compile("but now").match(line):
        valid = False
    if valid:
        print line 
```

像这样一次只缓存一行，与使用`readlines()`将整个文件缓存在内存中的位置相反。

这是假设正则表达式模式在您的文本块中是唯一的，如果不是这种情况，请提供有关您如何准确匹配开始行和结束行的更多信息。

如果您只需要检查行首是否匹配，则更容易：

```
valid = False
for line in open("/path/to/file.txt", "r"):
    if line.startswith("now it is"):
        valid = True
    if line.startswith("but now"):
        valid = False
    if valid:
        print line 
```

# c++ - 将 void 指针类型转换为 unsigned short

> ID：10219707
> 
> 赞同：-1
> 
> 时间：2012-04-18T23:44:09.577
> 
> 标签：c++

嗨，我正在尝试使用来自[http://blog.firetree.net/2006/08/23/nasa-srtm-elevation-data/](http://blog.firetree.net/2006/08/23/nasa-srtm-elevation-data/)的代码，但没有成功，经过多次追逐，我发现它失败的地方，但不知道如何解决它，请帮忙，这已经让我头疼了大约 6 个小时。这是失败的线路。data 是指向内存映射文件的空指针。

```
unsigned short datum=((unsigned short*)data)[i]; 
```

我在 OpenSuse 上使用 gcc 编译器。我在64位系统上。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T02:15:37.273

我认为这可能是由内存对齐引起的。在某些平台指针值不能转换为某些类型。

例如，一个平台需要 int* 应该与 4 对齐，所以 0x12345 可以是 void* 或 char*，但是如果你将它分配给 int*，就会发生崩溃。

对于您的情况，您可以先将 void 指针转换为 unsigned char*，然后将 2 个 unsigned char 转换为 unsigned short：

```
unsigned char a =((unsigned char*)data)[i];
unsigned char b =((unsigned char*)data)[i+1]; 
if (platform_is_little_endian()) {
    unsigned short datatum = (b << sizeof(unsigned char)) | a;
}
else {
    // platform is big endian
    unsigned short datatum = (a << sizeof(unsigned char)) | b;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:53:42.197

如果你说它在那一点崩溃，那么我想你是在数组之外阅读。但是至少可以说，将指向 unsigned short 的指针存储为 unsigned short 很有趣，这甚至可以编译吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T16:39:49.287

通过结合 Donald Tangs 方法和程序在数组外读取的实现来解决。对于其他潜在用户，当找到 num_rows num_cols 的值时会出现问题，因为作者的平方根函数不是平方根。

# asp.net - 使用 Jenkins 将 ASP.NET 网站部署到远程 VPS

> ID：10219708
> 
> 赞同：2
> 
> 时间：2012-04-18T23:44:10.283
> 
> 标签：asp.net, iis, automation, continuous-integration, jenkins

我刚刚开始考虑使用 Jenkins 进行持续部署，但我遇到了一些障碍，而且我还没有真正找到很多关于 ASP.NET 应用程序的好的、明确的资源。

我已经设置了一个本地构建服务器，而不是成功地从 SVN 存储库中提取代码，并使用 MSBuild 构建它。到目前为止效果很好，但现在我想自动将此编译后的代码推送到开发服务器。

我的问题是——根据我所读到的内容（这可能是一个错误的假设......），登台服务器通常与构建服务器位于同一网络内，这意味着您可以共享网络资源、服务器、等等

就我而言，我想在远程 VPS 上运行 Jenkins 服务器，然后部署到其他远程 VPS（因此，基本上是各个独立的机器相互通信）。

我见过很多术语，但我对系统管理员/DevOps 类型的技能非常陌生。

所以，我的问题是：

1.  是否有可能在 VPS 上使用 Jenkins，然后部署到我选择的任何特定服务器？（我对所有这些都具有完全访问权限，所以如果它是一个安全问题，我可以修复它......但它们不在同一个网络/域中）

2.  实现这一目标的方法是什么？我见过提到的 xcopy、Web 部署包 (msdeploy)、批处理脚本等，但并没有真正指导在什么情况下使用什么。这些方法中的任何一种对实现我的目标有用吗？

感谢您的任何帮助或指导！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:08:50.513

你的 Powershell 怎么样？;) 你应该看看[psake](https://github.com/JamesKovacs/psake)。

> psake 是用 PowerShell 编写的构建自动化工具。通过在构建脚本中利用 PowerShell 语法，它避免了与可执行 XML 相关的尖括号税。psake 的语法灵感来自 rake（在 Ruby 中又称为 make）和 bake（在 Boo 中又称为 make），但更容易编写脚本，因为它利用了您现有的命令行知识。
> 
> psake 发音为清酒——就像在日本米酒中一样。它不与 make、bake 或 rake 押韵。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-17T10:54:01.813

您可以通过 SSH 将文件部署到目标服务器。Jenkins 确实支持通过 SSH 传输。您需要做的就是设置一个 SSH 服务器，例如：[CopSSH](https://www.itefix.net/content/copssh-free-edition)和一个具有管理员权限的用户帐户。并将 Jenkins 配置为通过 SSH 传输。

*   在主 Jenkins 配置中创建主机配置
*   添加 SSH 服务器
*   将公钥添加到远程服务器（构建服务器）
*   点击“测试配置”
*   节省
*   将作业配置为通过 SSH 发布（构建后操作）
*   添加传输集。

有关更多详细信息，请参阅[通过 SSH 发布](https://wiki.jenkins-ci.org/display/JENKINS/Publish+Over+SSH+Plugin)

# sql - 有人可以帮助解释这段代码吗？它是一个用于创建校验和列表的 shell 脚本

> ID：10219711
> 
> 赞同：0
> 
> 时间：2012-04-18T23:44:18.127
> 
> 标签：sql, oracle, bash, shell

```
#!/bin/bash
# create a list of checksums
cat /dev/null > MD5SUM
for i in */*/*.sql ; do test -e $i && md5sum $i >>MD5SUM ; done 
```

然后此命令用于检查是否有任何更改：

```
md5sum -c MD5SUM 
```

它工作正常，一切正常。我只是不明白怎么做。假设我想为我的主目录中的所有文件制作一个校验和列表，我`$HOME`该怎么做？`*/*/*.sql`for 循环的部分是什么意思？我假设这只是显示 SQL 文件，但我该如何修改呢？假设我想要目录中的所有文件？为什么不只是`*.sql`？在这种情况下，for 循环的其余部分会做什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T01:56:52.663

让我们按部分：

```
cat /dev/null > MD5SUM 
```

这只会“擦除”之前创建的先前 MD5SUM 文件/列表。

```
for i in */*/*.sql; 
```

这将遍历距当前文件夹深 2 个目录的文件。如果你有文件夹

```
~/a/b
~/c/d
~/e/f 
```

并且您在主文件夹 (~) 中运行脚本，目录 b、d、f 中的所有“*.sql”都将计算校验和并将其传送到当前目录中的文件 MD5SUM：

```
do test -e $i && md5sum $i >>MD5SUM ; done 
```

现在回答你的问题：

> 1.  假设我想为我的主目录 $HOME 中的所有文件创建一个校验和列表，我该怎么做？

我会使用带有 exec 选项的 find 命令

```
find $HOME -maxdepth 1 -name \*.sql -exec md5sum {} \; 
```

> 1.  *for 循环的/* /*.sql 部分是什么意思？

我在上面回答了它，无论如何在获取文件之前只深入 2 个目录。

> 1.  我假设这只是显示 SQL 文件，但我该如何修改呢？假设我想要目录中的所有文件？

改变

```
for i in */*/*.sql; 
```

至

```
for i in */*/*; 
```

或当前目录

```
find $HOME -maxdepth 1 -name \* -exec md5sum {} \; 
```

> 1.  为什么不只是 *.sql ？在这种情况下，for 循环的其余部分会做什么？

前面解释过了。

希望它有帮助=)

# swing - 如何在 JFrame 运行时更新 JLayeredPane？爪哇

> ID：10219712
> 
> 赞同：0
> 
> 时间：2012-04-18T23:44:19.013
> 
> 标签：swing, jframe, jpanel

阅读了许多教程、文章和问题后，我仍然对更新 GUI 感到困惑。另外，这个网站上有很多相关的问题，但仍然没有运气——尽管我认为我的问题很简单。

基本上，我有一个 JFrame，它有一个 JLayeredPane 作为它的根容器。我里面有几层JPanels。

主要问题是更新此 JLayeredPane 中的特定 JPanel。对于这个特定的面板，我实现了一个更新方法来更改其中的内容。

```
updatePanel(int para)
//doesn't remove this panel
//removes some existing labels and replaces it with new ones 
```

一旦我创建了整个框架，显然只是调用此方法不会显示显示框架的任何更改。

```
private void static main (String[] args){
    WindowFrame frame = new WindowFrame()//WindowFrame extends JFrame
    frame.updatePanel(2);
    .....
    .....
} 
```

这就是我卡住的地方。我想在显示框架时更新内容。

我看到人们提到的这些方法，但由于问题的性质，我无法完全掌握这些概念。另外，关于这些方法的文档并没有真正的帮助——至少对我来说是这样。

```
revalidate()
validate()
repaint() 
```

应该如何/何时调用这些方法？或者，考虑到这些方法和我要解决的问题，这不是我应该做的正确方法吗？

感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T00:04:52.470

基本上你需要两种方法：

**重新验证（）**

此方法与 invalidate() 的作用相同，但在 AWT 事件调度线程中（稍后我将称之为 Swing 线程））。它更新容器及其所有祖先（放置此容器的父容器）布局。

基本上，如果您在此容器内移动某些东西或在其中放置/删除组件，您应该调用此方法（或者如果您在 Swing 线程中执行它，例如在任何 Mouse/Action 侦听器主体内或只是在内部，则使其无效）。

**重绘（）**

此方法强制组件、其所有子组件（如果有的话）和父容器（基本上如果此组件不是不透明的）更新它们正在“绘制”的内容。

通常你不需要这个方法，因为所有标准的 Swing 组件都知道何时重绘自己并且它们自己来做（这当然取决于组件的 UI 和其他一些东西）。如果您有自己的特定组件和一些独特的绘画方式（例如对组件进行一些自定义选择），并且在一些罕见的标准组件有问题的情况下，此方法可能很有用。

此外，此方法的作用方式取决于组件的放置（由于一些 Swing 绘画优化） - 如果您有一些大规模的重绘滚动，您最好优化它们以仅重绘您实际需要重绘的那些部分（矩形）。例如，如果您更改任何容器内的组件边界，最好的选择是重新绘制其旧边界 rect 和新边界 rect 或重新绘制包含这两个边界的矩形，但不是整个容器，以避免重新绘制未参与的动作组件。

因此，基本上在您的情况下，在面板进行一些更改后，您应该在其容器上调用重新验证（或无效），然后再次为容器重新绘制（以防重新验证留下一些视觉伪影）。

猜猜我没有错过任何东西，我希望现在您知道这些方法的基本含义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-18T23:55:12.243

像这样在更新方法结束时重新验证。

```
updatePanel(int para){
 .....
 .....
 this.revalidate();  //of course this refer to the panel
 parent.revalidate(); // parent refer to the window

 } 
```

# java - 以编程方式查找 Android 系统信息

> ID：10219717
> 
> 赞同：6
> 
> 时间：2012-04-18T23:44:58.323
> 
> 标签：java, android

我正在尝试以编程方式查找 Android 设备的系统信息，特别是：

*   内存
*   中央处理器速度
*   # 核心、架构等

是否有任何指定此信息的 Android 类。我一直在使用 android.board 库，但它似乎没有我想要的一切。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-19T01:33:02.753

让我告诉你我做了什么，所以访问这个线程的其他人可以知道这些步骤：

1) 解析 /proc/meminfo 命令。您可以在此处找到参考代码： [Get Memory Usage in Android](https://stackoverflow.com/questions/3118234/how-to-get-memory-usage-and-cpu-usage-in-android) 2) 使用以下代码并获取当前 RAM：

```
MemoryInfo mi = new MemoryInfo();
ActivityManager activityManager = (ActivityManager) getSystemService(ACTIVITY_SERVICE);
activityManager.getMemoryInfo(mi);
long availableMegs = mi.availMem / 1048576L; 
```

注意：请注意 - 我们只需要计算一次总内存。所以在你的代码中只调用点 1 一次，然后你可以重复调用点 2 的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T23:52:16.057

您可以从`/proc/cpuinfo`文件中获取大部分所需信息。这是有关如何加载和解析该文件的教程：[http ://www.roman10.net/how-to-get-cpu-information-on-android/](http://www.roman10.net/how-to-get-cpu-information-on-android/)

此外，可以从`/proc/meminfo`文件中获取有关 RAM 的信息

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-09-16T08:44:44.960

这是获取当前设备 RAM 大小的代码片段。

```
ActivityManager actManager = (ActivityManager) getSystemService(ACTIVITY_SERVICE);
MemoryInfo memInfo = new ActivityManager.MemoryInfo();
actManager.getMemoryInfo(memInfo);
long totalMemory = memInfo.totalMem; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-25T06:34:25.990

Agarwal 的回答非常有帮助。不得不对其进行一些修改，因为我不是在计算活动中的可用内存，而是将应用程序上下文传递给系统实用程序文件：

从主要活动：

```
public class MyActivity extends Activity {
    ...
    public void onCreate(Bundle savedInstanceState) {
        ...
        MySystemUtils systemUtils = new MySystemUtils(this); // initializations
        ...
     }
} 
```

在 SystemUtils 文件中：

```
 MySystemUtils (Context appContext) { // called once from within onCreate
        MemoryInfo mi = new MemoryInfo();
        ActivityManager activityManager = ActivityManager)appContext.getSystemService(Activity.ACTIVITY_SERVICE);
        activityManager.getMemoryInfo(mi);
        long availableMegs = mi.availMem / 1048576L;
    } 
```

# mongodb - mongodb - 不使用日期索引

> ID：10219721
> 
> 赞同：8
> 
> 时间：2012-04-18T23:45:22.230
> 
> 标签：mongodb

集合事件有 userId 和一个事件数组——数组中的每个元素都是一个嵌入的文档。例子：

```
{
    "_id" : ObjectId("4f8f48cf5f0d23945a4068ca"),
    "events" : [
            {
                    "eventType" : "profile-updated",
                    "eventId" : "247266",
                    "eventDate" : ISODate("1938-04-27T23:05:51.451Z"),
            },
           {
                   "eventType" : "login",
                   "eventId" : "64531",
                   "eventDate" : ISODate("1948-05-15T23:11:37.413Z"),
           }
    ],
    "userId" : "junit-19568842", 
```

}

使用如下查询来查找过去 30 天内生成的事件：

```
db.events.find( { events : { $elemMatch: { "eventId" : 201, 
"eventDate" : {$gt : new Date(1231657163876) } } } }  ).explain() 
```

查询计划显示，当测试数据包含较少的事件（大约 20 个）时，使用“events.eventDate”上的索引：

```
{
    "cursor" : "BtreeCursor events.eventDate_1",
    "nscanned" : 0,
    "nscannedObjects" : 0,
    "n" : 0,
    "millis" : 0,
    "nYields" : 0,
    "nChunkSkips" : 0,
    "isMultiKey" : true,
    "indexOnly" : false,
    "indexBounds" : {
            "events.eventDate" : [
                    [
                            ISODate("2009-01-11T06:59:23.876Z"),
                            ISODate("292278995-01--2147483647T07:12:56.808Z")
                    ]
            ]
    } 
```

}

但是，当有大量事件（大约 500 个）时，不使用索引：

```
{
    "cursor" : "BasicCursor",
    "nscanned" : 4,
    "nscannedObjects" : 4,
    "n" : 0,
    "millis" : 0,
    "nYields" : 0,
    "nChunkSkips" : 0,
    "isMultiKey" : false,
    "indexOnly" : false,
    "indexBounds" : {

    } 
```

}

为什么在有很多事件时不使用索引？可能是当有大量事件时，MongoDB 发现只扫描所有项目比使用索引更有效？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-04-18T23:50:22.570

MongoDB 的查询优化器以一种特殊的方式工作。它不计算某些查询计划的成本，而是启动所有可用计划。无论哪个先返回，都被认为是最优的，并将在未来使用。

应用程序增长，数据增长和变化，最佳计划可能在某些时候变得不是最佳的。因此，mongo 每隔一段时间就会重复该查询选择过程。

在这种具体情况下，基本扫描似乎是最有效的。

链接：[http ://www.mongodb.org/display/DOCS/Query+Optimizer](http://www.mongodb.org/display/DOCS/Query+Optimizer)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T20:29:13.607

使用 $hint 强制使用索引“events.eventDate”，nscannedObjects 不仅仅是没有索引。

使用索引时的伪代码：

```
for(all entries in index matching the criteria) {
  get user object and scan to see if the eventId criteria is met
} 
```

索引中与条件匹配的所有条目 --> 每个事件都是索引中的一个条目。所以索引中的条目数会多于用户数。假设有 4 个用户对象和总共 7 个符合条件的事件，用户对象被扫描 7 次（for 循环执行 7 次）。未扫描索引时，所有 4 个用户对象仅检查一次。所以使用索引，用户对象被扫描的次数比不使用索引的时候要多。这种理解对吗？

```
db.events.find( { events : { $elemMatch: { "eventId" : 201, 
"eventDate" : {$gt : new Date(1231657163876) } } } }  )
._addSpecial("$hint",{"events.eventDate":1}).explain()

{
    "cursor" : "BasicCursor",
    "nscanned" : 7,
    "nscannedObjects" : 7,
    "n" : 0,
    "millis" : 0,
    "nYields" : 0,
    "nChunkSkips" : 0,
    "isMultiKey" : false,
    "indexOnly" : false,
    "indexBounds" : {

} 
```

# java - java.util.HashMap 中的无限循环

> ID：10219724
> 
> 赞同：10
> 
> 时间：2012-04-18T23:45:53.727
> 
> 标签：java, hashmap, vaadin, infinite-loop

我在这里经常遇到一些 Vaadin 代码阻塞，我不知道问题可能是什么：

```
Thread 7892: (state = IN_JAVA)
 - java.util.HashMap.getEntry(java.lang.Object) @bci=61, line=349 (Compiled frame; information may be imprecise)
 - java.util.HashMap.containsKey(java.lang.Object) @bci=2, line=335 (Compiled frame)
 - java.util.HashSet.contains(java.lang.Object) @bci=5, line=184 (Compiled frame)
 - com.vaadin.ui.Table.unregisterPropertiesAndComponents(java.util.HashSet, java.util.HashSet) @bci=85, line=1693 (Compiled frame)
 - com.vaadin.ui.Table.refreshRenderedCells() @bci=992, line=1641 (Compiled frame)
 - com.vaadin.ui.Table.valueChange(com.vaadin.data.Property$ValueChangeEvent) @bci=23, line=2897 (Compiled frame)
 - com.vaadin.data.util.IndexedContainer.firePropertyValueChange(com.vaadin.data.util.IndexedContainer$IndexedContainerProperty) @bci=140, line=553 (Compiled frame)
 - com.vaadin.data.util.IndexedContainer.access$1000(com.vaadin.data.util.IndexedContainer, com.vaadin.data.util.IndexedContainer$IndexedContainerProperty) @bci=2, line=64 (Compiled frame)
 - com.vaadin.data.util.IndexedContainer$IndexedContainerProperty.setValue(java.lang.Object) @bci=202, line=915 (Compiled frame)
 - com.aimprosoft.wavilon.backgroundthreads.ChangeCdrThread.insertNewPersonIntoTable(com.aimprosoft.wavilon.model.Person, com.vaadin.ui.HorizontalLayout, com.aimprosoft.wavilon.ui.menuitems.CallContent, com.vaadin.ui.Table) @bci=924, line=208 (Interpreted frame)
 - com.aimprosoft.wavilon.backgroundthreads.ChangeCdrThread$RepaintTableThread.run() @bci=622, line=446 (Compiled frame) 
```

有人可以建议任何方法来进一步调试这个问题吗？这个问题很少发生，而且很难重现。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-18T23:53:24.987

根据它在代码中的位置，我能想到的唯一解释是有多个线程在`HashMap`没有正确同步的情况下访问和更新它。这可能会导致地图的数据结构损坏，并可能导致无限循环。

我想不出任何其他原因`java.util.HashMap.getEntry`会阻止。它不进行任何同步或任何 I/O。

* * *

罗兰·伊利格评论：

> 行号确实表明代码挂在其中一个`e = e.next`循环中。

这支持了我的假设。由两个（或更多）线程对哈希表执行的特定操作序列导致在其中一个哈希链中创建循环/循环。发生这种损坏是因为执行操作的线程之间没有充分的同步。这是一种很少发生的事情，但一旦发生，腐败就不会消失。

如果不深入研究 Vaadin 源代码，我无法准确告诉您这是 Vaadin 错误，还是您*使用*Vaadin 的方式中的错误。任何一种解释都是合理的。

**更新**

根据[这篇文章](https://web.archive.org/web/20130416031027/http://njbartlett.name/2011/05/25/concurrent-vaadin.html)（在下面的评论中提供），我想说这很可能是您的应用程序同步（或不同步）方式的问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-04-19T20:51:41.483

所以你在这里实际看到的是一个线程进入一个无限循环评估`e = e.next`

在本质上

`e.next == e`

当您在表重组期间由多个线程放入 HashMap 时，会发生这种情况。

查看此链接以获取更多信息

[美丽的比赛条件](http://mailinator.blogspot.com/2009/06/beautiful-race-condition.html)

要解决此问题，请使用 a`Collections.synchronizedMap`或`ConcurrentHashMap`. 我建议后者。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T20:37:34.270

修改组件时，你的后台线程是否在应用实例上同步？如果不是，那是你的问题。

# javascript - 对于文档中的变量（Javascript）

> ID：10219728
> 
> 赞同：0
> 
> 时间：2012-04-18T23:46:25.957
> 
> 标签：javascript, html, iteration

这段代码还没有完全完成。我正在尝试遍历页面中的所有“m”变量，直到页面中没有更多的“m”。现在我有'for（m in document）'，我知道这是错误的。谁能指出我正确的语法方向？

```
var m = document.getElementsByClassName('project')
  var n = document.getElementsByClassName('web')
  var o = document.getElementsByClassName('print')
  var p = document.getElementsByClassName('illustration')

function projectFilter(type){
     if (type === 'print'){
      for (m in document){
        if (getElementsByClassName('print') != null){
          m.style(opacity=0.3)
          console.log("Whatshappening")
      }
   }
   if (type === 'web'){
      console.log('webbyshit')
   }
   if (type === 'illustration'){
      console.log('illustrating')
   }
   if (type === 'project'){
      console.log('EVERYTHING')
   }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-18T23:49:46.657

您已经`m`在脚本的顶部进行了定义，因此您不必查找它`in document`。就像循环数组一样循环它（`m`是一个`NodeList`对象，但它有一个`length`像数组一样的属性）：

```
for(var i=0; i<m.length; i++) {
    // do something with each m[i]
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T00:07:13.827

三个问题

*   你迭代不正确
*   您的样式分配不正确：
*   `getElementsByClassName`将始终返回一个对象，即使它是一个空集。检查它的长度属性，看看你是否得到任何元素。

```
for (var i = 0, len = m.length; i<len; i++) {
    if (m[i].getElementsByClassName('print').length > 0 ){
        m.style.opacity=0.3;
    }
} 
```

# c++ - 是否可以在不知道类型的情况下调用析构函数？

> ID：10219738
> 
> 赞同：2
> 
> 时间：2012-04-18T23:47:28.760
> 
> 标签：c++, memory-management

是否可以在不知道类类型而不使用的情况下调用对象的析构函数`delete`？我问是因为我正在研究分配器（为了好玩/练习）并且我正在使用`malloc`/放置`new`来构造对象但是当我去破坏对象时，我很好奇是否有办法在不知道的情况下这样做类型。如果不可能，为什么不呢？唯一的方法是我在示例代码中显示的方式（被注释掉）吗？

```
#include <stdio.h>
#include <new>

void* SomeAllocationFunction(size_t size) {
    return malloc(size);
}

class SomeClass{
public:
    SomeClass() {
        printf("Constructed\n");
    }

    ~SomeClass() {
        printf("Destructed\n");
    }
};

int main(void){
    void* mem = SomeAllocationFunction(sizeof(SomeClass));
    SomeClass* t = new(mem)SomeClass;

    free(t);
    //t->~SomeClass(); // This will call the destructor, is it possible to do this without knowing the class?

    return 0;
} 
```

（我知道我可以直接调用 delete，但请暂时忽略它。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:52:29.103

不，你不能在不知道类的情况下调用析构函数，因为编译器不知道要调用哪个析构函数。您可以：

*   使所有对象都从具有虚拟析构函数的某个基础对象继承，并使用该基础对象指针而不是 void 指针
*   使用模板
*   让分配器本身不管理构造函数/析构函数的调用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-18T23:52:37.007

在无类型的内存上调用析构函数与调用没有类型的构造函数（即：placement new）一样不可能。构造函数和析构函数都是对象的一部分，编译器需要一个类型来知道要调用什么。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-18T23:52:40.107

不，如果不知道类型（或知道具有虚拟析构函数的对象的基类型之一），这是不可能的。

通常来说，自定义分配器既不构造也不破坏对象，尽管有些分配器围绕执行放置 new 或直接析构函数调用的分配器进行模板化包装。

(Technically, you could associate with every allocation a function pointer that ends up calling the type's destructor. But that's fairly sketchy, and I wouldn't recommend it.)

# qt - 将颜色设置为 QTableView 行

> ID：10219739
> 
> 赞同：12
> 
> 时间：2012-04-18T23:47:30.720
> 
> 标签：qt, qt4, qtableview, qsqltablemodel

```
void MyWindow::initializeModelBySQL(QSqlQueryModel *model,QTableView *table,QString sql){
        model = new QSqlQueryModel(this);
        model->setQuery(sql);
} 
```

使用这种方法，我可以为我的 QTableviews 设置一个 QSQlQueryModels。

但是我如何根据单元格值将颜色设置为一行？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-19T00:44:09.797

`Qt::BackgroundRole`视图根据单元格的角色绘制背景，该角色是该角色`QBrush`返回的值`QAbstractItemModel::data(index, role)`。

您可以子类化`QSqlQueryModel`以重新定义`data()`以返回您计算的颜色，或者如果您的 Qt > 4.8，您可以使用[`QIdentityProxyModel`](http://qt-project.org/doc/qt-4.8/qidentityproxymodel.html)：

```
class MyModel : public QIdentityProxyModel
{
    QColor calculateColorForRow(int row) const {
        ...
    }

    QVariant data(const QModelIndex &index, int role)
    {
        if (role == Qt::BackgroundRole) {
           int row = index.row();
           QColor color = calculateColorForRow(row);           
           return QBrush(color);
        }
        return QIdentityProxyModel::data(index, role);
    }
}; 
```

并在视图中使用该模型，并将 sql 模型设置为带有`QIdentityProxyModel::setSourceModel`.

# 或者

您可以保持模型不变，并使用在视图上设置的委托修改背景`QAbstractItemView::setItemDelegate`：

```
class BackgroundColorDelegate : public QStyledItemDelegate {

public:
    BackgroundColorDelegate(QObject *parent = 0)
        : QStyledItemDelegate(parent)
    {
    }
    QColor calculateColorForRow(int row) const;

    void initStyleOption(QStyleOptionViewItem *option,
                         const QModelIndex &index) const
    {
        QStyledItemDelegate::initStyleOption(option, index);

        QStyleOptionViewItemV4 *optionV4 =
                qstyleoption_cast<QStyleOptionViewItemV4*>(option);

        optionV4->backgroundBrush = QBrush(calculateColorForRow(index.row()));
    }
}; 
```

由于从 C++ 代码转换最后一种方法并不总是显而易见的，因此这里是 python 中的等效方法：

```
def initStyleOption(self, option, index):
    super(BackgroundColorDelegate,self).initStyleOption(option, index)
    option.backgroundBrush = calculateColorForRow(index.row()) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-19T00:13:08.097

您最好的选择是定义一个自定义模型（`QAbstractTableModel`子类）。您可能希望`QSqlQueryModel`在这个自定义类中有一个成员。

如果是只读模型，则至少需要实现以下方法：

```
 int rowCount(const QModelIndex &parent) const;
 int columnCount(const QModelIndex &parent) const;
 QVariant data(const QModelIndex &index, int role) const; 
```

对于表现良好的模型也

```
 QVariant headerData(int section, Qt::Orientation orientation, int role) const; 
```

如果您需要模型能够编辑/提交数据，事情会涉及更多，您还需要实现这些方法：

```
 Qt::ItemFlags flags(const QModelIndex &index) const;
 bool setData(const QModelIndex &index, const QVariant &value, int role=Qt::EditRole);
 bool insertRows(int position, int rows, const QModelIndex &index=QModelIndex());
 bool removeRows(int position, int rows, const QModelIndex &index=QModelIndex()); 
```

实际上会改变行外观的在于此方法的返回值：

```
 QVariant data(const QModelIndex &index, int role) const; 
```

一个愚蠢的例子：

```
 QVariant MyCustomModel::data(const QModelIndex &index, int role) const
 {
     if ( !index.isValid() )
         return QVariant();

     int row = index.row();
     int col = index.column();

     switch ( role )
     {

        case Qt::BackgroundRole:
        {
            if(somecondition){
               // background for this row,col is blue
               return QVariant(QBrush (QColor(Qt::blue)));
            }
            // otherwise background is white
            return QVariant(QBrush (QColor(Qt::white)));
        }

        case Qt::DisplayRole:
        {
           // return actual content for row,col here, ie. text, numbers

        }

        case Qt::TextAlignmentRole:
        {

           if (1==col)
              return QVariant ( Qt::AlignVCenter | Qt::AlignLeft );

           if (2==col)
              return QVariant ( Qt::AlignVCenter | Qt::AlignTrailing );

           return QVariant ( Qt::AlignVCenter | Qt::AlignHCenter );

        }
     }

  } 
```

# php - PHP：请求数据的函数参数参考

> ID：10219741
> 
> 赞同：1
> 
> 时间：2012-04-18T23:47:40.430
> 
> 标签：php, function, post, pass-by-reference

我知道在 PHP 中，当您希望函数参数引用目标变量时，我们使用 &`&`符号。但我无法弄清楚它在以下场景中是否仍然有效和可靠（从请求中收集变量）。

```
$v1 = $_POST['v1'];

function filled(&$var) {
    return isset($var) && !empty($var);
}

if (!filled($v1)) // etc. 
```

甚至在这种情况下：

```
$v1 = $_POST['v1'];
$v2 = $_POST['v2'];

function filled() {
    $args = &func_get_args(); // does this even take the references and not the values?
    foreach ($args as &$arg) {
        if (empty($arg) || !isset($arg)) return false;
    }
    return true;
}

if (!filled($v1, $v2)) // etc. 
```

提前感谢您的澄清。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T00:05:11.017

它仍然有效，因为引用不关心变量是用户定义的还是来自 PHP 超全局变量，但是您的第一个示例存在一些问题。

首先，当你`$v1 = $_POST['v1'];` `$v1`现在做的是独立的`$_POST['v1']`变量。由于您制作了副本`$v1`，因此不会反映任何更改。`$_POST['v1']`

您可以这样做：`$v1 = &$_POST['v1'];`创建对它的引用。

其次，您`isset`在函数中的调用将始终返回 true。 `isset`是一种特殊的语言结构，而不是函数。如果`$_POST['v1']`未设置，则在分配to`$v1`后仍将设置（但将为空）。`$_POST['v1']``$v1`

另外，据我所知，`func_get_args()`不支持引用，它返回的所有值都是原始值的副本。

这是否解决了您的一些问题？如果没有，请随时询问您想要澄清的任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T00:08:38.867

场景1：它不会做你想做的事，因为它`$var`总是被设置为函数参数。但是，如果您想检查此参数是否不包含空值（null、false 等），您可以执行`empty($var)`. 不需要在`&`那里使用。你想要的可以做为`!empty($_POST['v1')`. 如果您将某些东西传递给函数，它必须具有值，因此`isset()`在函数中使用不会做任何事情。使用`array_key_exists`或`isset()`或`empty()`外部。

场景 2：`func_get_args()`不需要`&`，丢弃它。`$arg`也不需要它并且将始终设置，因此`isset()`检查是无用的，尽管只有`empty()`有用。如上，如果要查看数组键是否存在，请使用`isset($_POST['v1'])`or `!empty($_POST['v1'])`。

# tree - graphviz，如何粘贴节点在图像上的位置

> ID：10219742
> 
> 赞同：2
> 
> 时间：2012-04-18T23:47:53.163
> 
> 标签：tree, visualization, graphviz, dot

我对如何可视化树木有疑问。现在我使用[graphviz](http://www.graphviz.org/)或[点语言](http://en.wikipedia.org/wiki/DOT_language)并且有一些问题。

简要介绍一下我的背景。我有一系列的树。步骤 T 上的树是通过添加一些边从步骤 T-1 上的树获得的。我想为每棵树创建图像。在图像查看器中查看这些图像时，我正在单击下一步按钮，并希望轻松查看从步骤 T-1 到步骤 T 的树变化。

我现在在做什么。我编写了创建“点”代码的脚本，用于为每个图形创建图像。在图像查看器中单击“下一步”按钮时，我看到节点如何跳跃。但我不喜欢它。我希望节点在每张图片上都保持在同一个位置，我想看到的唯一变化是新边和**新**节点是如何出现的。

有没有办法将节点固定在它们的位置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T08:51:31.870

有可能的。`pos`您必须使用节点和边 的属性（包含坐标）。

要获得一些值的示例，`pos`您可以简单地调用`dot`而无需任何指定的输出格式。这将为您提供一个`.dot`带有附加坐标的文件。
所以文件`minimal.dot`

```
digraph G {
  a [label="Node A"];
  b [label="Node B"];
  a -> b;
} 
```

处理的`dot minimal.dot`将导致：

```
digraph G {
  node [label="\N"];
  graph [bb="0,0,82,108"];
  a [label="Node A", pos="41,90", width="1.14", height="0.50"];
  b [label="Node B", pos="41,18", width="1.14", height="0.50"];
  a -> b [pos="e,41,36 41,72 41,64 41,55 41,46"];
} 
```

边和每个节点现在都有一个`pos`属性。这应该让你开始。

# python - 为什么我的 sweetpie 缓存没有被调用？

> ID：10219743
> 
> 赞同：3
> 
> 时间：2012-04-18T23:47:55.427
> 
> 标签：python, django, tastypie

我正在查看[美味的缓存文档](http://django-tastypie.readthedocs.org/en/latest/caching.html)并尝试设置我自己的简单缓存，但缓存似乎没有被调用。当我访问[http://localhost:8000/api/poll/?format=json](http://localhost:8000/api/poll/?format=json)时，我得到了我的 sweetpie 生成的 json，但我没有从缓存类中得到输出。

```
from tastypie.resources import ModelResource
from tastypie.cache import NoCache
from .models import Poll

class JSONCache(NoCache):
    def _load(self):
        print 'loading cache'
        data_file = open(settings.TASTYPIE_JSON_CACHE, 'r')
        return json.load(data_file)

    def _save(self, data):
        print 'saving to cache'
        data_file = open(settings.TASTYPIE_JSON_CACHE, 'w')
        return json.dump(data, data_file)

    def get(self, key):
        print 'jsoncache.get'
        data = self._load()
        return data.get(key, None)

    def set(self, key, value, timeout=60):
        print 'jsoncache.set'
        data = self._load()
        data[key] = value
        self._save(data)

class PollResource(ModelResource):
    class Meta:
        queryset = Poll.objects.all()
        resource_name = 'poll'
        cache = JSONCache() 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-19T07:41:43.850

似乎 Tastypie 不会自动缓存列表，`tastypie.resources`围绕行`1027`：

```
def get_list(self, request, **kwargs):

    # ...

    # TODO: Uncached for now. Invalidation that works for everyone may be
    #       impossible.
    objects = self.obj_get_list(
        request=request, **self.remove_api_resource_names(kwargs))

    # ... 
```

，而有细节（围绕线`1050`）：

```
def get_detail(self, request, **kwargs):

   # ...

   try:
       obj = self.cached_obj_get(
           request=request, **self.remove_api_resource_names(kwargs))

   # ... 
```

...请注意，在前一个片段`obj_get_list`中调用而不是`cached_obj_get_list`. 也许覆盖`get_list`和使用`cached_obj_get_list`也可以让您在这里使用缓存？

现在，默认情况下，您可能会从您的类中获得`http://localhost:8000/api/poll/<pk>/?format=json`（详细视图）而不是`http://localhost:8000/api/poll/?format=json`（列表视图）的输出。

# ios - 在 NSMutableString 中查找随机字符串

> ID：10219745
> 
> 赞同：0
> 
> 时间：2012-04-18T23:48:09.280
> 
> 标签：ios, nsmutablearray, nsmutablestring

我看过很多关于如何生成随机字符串的问答。但是，如果我有一个字符串数组（可能是数千个）并且我想抓取一个随机字符串以便每次都向用户呈现不同的字符串，那该怎么办？提前致谢。

```
wordsArray= [[NSMutableArray alloc] init]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-18T23:49:54.487

你可以试试：

```
[wordsArray objectAtIndex:arc4random_uniform([wordsArray count])]; 
```

前提是数组不为空。

**更新：**使用`arc4random_uniform()`以获得更好的稳定性。（感谢理查德）

# jquery - getJSON 静默错误？

> ID：10219750
> 
> 赞同：0
> 
> 时间：2012-04-18T23:48:50.057
> 
> 标签：jquery, google-custom-search

我正在使用 getJSON 向 Google 自定义搜索发出请求。FireBug 显示它正在返回 200 OK。但是，我的回调函数永远不会发生。

jQuery 文档提到了一个静默错误，我认为这是有道理的，是吗？我对 Google 会出现格式错误并不感到惊讶。

[http://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)

怎么能解决这个问题？有解决方法吗？我看到了一些关于使用 AJAX 的信息，但我似乎无法确定必要的细节。

顺便说一句，如果我从 Firebug 中复制 GET 请求 URL 并将其粘贴到浏览器中，我会得到结果。但在 Firebug 中，结果是空白/空。我难住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:04:27.200

我要检查的第一件事是您的请求使用的是 JSONP 协议。你的 URL 应该有“callback=?” 包含的参数。所有跨域 JSON 请求都需要 JSONP。

如果您仍然遇到问题，我会查看调试器中的返回数据并将其发布在这里供其他人查看。

**查看这篇文章以获得您的解决方案：** [Access-Control-Allow-Origin 错误将 jQuery Post 发送到 Google API 的](https://stackoverflow.com/questions/6114436/access-control-allow-origin-error-sending-a-jquery-post-to-google-apis)

# asp.net-mvc - 有什么可以帮助处理 ASP.NET MVC3 的“字段级”授权吗？

> ID：10219753
> 
> 赞同：2
> 
> 时间：2012-04-18T23:49:52.333
> 
> 标签：asp.net-mvc

我知道您可以使用 Authorize 属性来控制对 Controller 或 ActionMethod 的访问......但是更细粒度的控制呢？例如，根据用户的角色允许/禁止特定字段似乎很常见。也许在员工档案上，员工可以编辑他的档案信息，但只有主管才能更改他的职位......

理想情况下，我希望能够正常开发视图、模型和控制器，并在网站上有一个配置页面，然后站点管理员可以使用该页面来配置所需的任何粒度的授权。换句话说，程序员不应该担心它（编写/集成系统特定部分的人除外。）

我可以设想 DisplayFor 和 EditorFor 检查属性以将字段呈现为只读、隐藏等......并且可能在运行时从某种授权提供程序添加属性。

问题是：是否有框架或其他东西已经做到了这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-27T20:39:08.910

编写一个自定义 ModelMetaDataProvider，它允许您在每个模型及其属性进入视图之前更改它们的元数据。如果字段的元数据值 ShowForEdit = false 或 ShowForDisplay = false，则内置帮助器将不会呈现字段。

您可以利用规则引擎或其他一些 ACL 来操作每个模型和属性上的元数据，以便在不触及内置帮助程序的情况下立即获得您要寻找的大部分行为。在需要更多控制的边缘情况下，您可以编写自己的帮助程序并在 metadata.AdditionalValues 字典中传递更复杂的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T01:14:52.130

您可以使用 HtmlHelper 在字段级别实现安全性。在下面的例子中，他们只使用了文本框实现，但它可以很容易地扩展到所有类型的控件：

[http://bartreyserhove.blogspot.ca/2008/12/field-level-security-using-aspnet-mvc.html](http://bartreyserhove.blogspot.ca/2008/12/field-level-security-using-aspnet-mvc.html)

# ios - 从 plist/dictionary 转换为 NSNumber 时出错

> ID：10219755
> 
> 赞同：0
> 
> 时间：2012-04-18T23:49:54.603
> 
> 标签：ios, plist, nsdictionary, nsnumber

我有一个包含一些默认值的 plist 文件，

我的目标是在运行时将这些值复制到对象中，

一半的值没问题，其他的设置为废话^^

列表：

```
<dict>
...
<key>averageCostDevelopPerApp</key>
<integer>50000</integer>
...
</dict> 
```

调试器中字典的打印输出：

> averageCostDevelopPerApp = 50000;

在调试器中打印我的对象：

> averageCostDevelopPerApp = "-15536​​";

averageCostDevelopPerApp 声明如下：

```
@property (nonatomic, retain) NSNumber * averageCostDevelopPerApp; 
```

这是我在对象中设置数据的地方：

```
[self setAverageCostDevelopPerApp: [dictionary objectForKey:@"averageCostDevelopPerApp"]]; 
```

我做了一些挖掘以及 objectforKey 在“__NSCFNumber”中返回的内容。

我猜我必须做一些转换，但我无法弄清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:53:32.947

对不起那些家伙，

在凌晨 1 点编码 12 小时后，突然间发现如此普遍，以至于在数据模型中，属性设置为 intger16 ...

# python - 如何从 Windows 上的 Gstreamer 子进程读取二进制数据？

> ID：10219759
> 
> 赞同：2
> 
> 时间：2012-04-18T23:50:32.957
> 
> 标签：python, windows, binary, pipe, gstreamer

```
f = os.popen("gst-launch -q whateversrc ! ... ! fdsink")
f.read(1024); 
```

在 GNU/Linux 上工作得很好，但会导致 \x0d\x0a 而不是 Windows 的每个 \x0a。怎么修？

我也试过只是`gst-launch -q ..... ! matroskamux streamable=true ! fdsink > qqq3.mkv`在控制台和qqq3.mkv也乱码。`gst-launch -q filesrc location=file ! fdsink > file2`也转换为 CRLF。

该怎么办？适用于 Windows 的 Gstreamer 构建没有 tcp{server,client}sink...

可能有一种方法可以在 Windows（或给定的应用程序）中全局关闭 LF->CRLF 转换？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T01:41:28.060

我想也许你不应该使用`shell=True`with `subprocess.Popen()`。

使用 Windows 7 64 位，在 Cygwin 中运行 Python，我编写了这个简单的测试程序：

```
import subprocess as sp

p = sp.Popen(['cat', 'junk.bin'], stdin=sp.PIPE, stdout=sp.PIPE, stderr=sp.
PIPE)
stdin, stdout = p.communicate()

with open('junk1.bin', "wb") as f:
    f.write(stdin) 
```

对我来说，`junk1.bin`是 的字节完美副本`junk.bin`，所以我没有看到发生在你身上的`"\n"`->转换。`"\r\n"`

编辑：我发现一个看起来很有用的网页：

[http://blog.rubypdf.com/2009/11/03/how-to-let-python-send-binary-data-to-stdout-under-windows/](http://blog.rubypdf.com/2009/11/03/how-to-let-python-send-binary-data-to-stdout-under-windows/)

```
import sys

if sys.platform == "win32":
    import os, msvcrt
    msvcrt.setmode(sys.stdout.fileno(), os.O_BINARY) 
```

如果子进程继承了父进程的标准输入和标准输出文件句柄的二进制模式设置，那么在您的 Python 父进程中运行上述代码可能会有所帮助？

如果没有，则尝试相同的技巧，但在返回的对象中的`stdin`和`stdout`句柄上`subprocess.Popen()`。在我上面的代码中，我将该对象绑定到名称`p`，因此它们将是`p.stdin`and `p.stdout`：

```
msvcrt.setmode(p.stdin.fileno(), os.O_BINARY)
msvcrt.setmode(p.stdout.fileno(), os.O_BINARY) 
```

我希望这有帮助。

# forum - 帖子中的主题标题

> ID：10219764
> 
> 赞同：0
> 
> 时间：2012-04-18T23:51:15.817
> 
> 标签：forum, vbulletin

任何人都知道如何将线程标题变量（也就是调用什么钩子）添加到广告位置模板>>ad_showthread_firstpost_start。我试过用 {vb:raw threadinfo.title} 调用它，但它不起作用。Vbulletin 4\. 感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T20:16:15.090

解决方案很简单，它将是： `$thread['title'];`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-31T20:46:43.503

如果您想在模板中进行修改，请尝试 {vb:raw threadinfo.title}...

# model-view-controller - 为列表选择备用 EditorFor 模板

> ID：10219769
> 
> 赞同：2
> 
> 时间：2012-04-18T23:52:21.297
> 
> 标签：model-view-controller, editorfor, editortemplates

我有一个代表要在餐厅订购的食物的对象。该对象有一个修饰符组列表（面、烹饪说明、披萨配料等），每个列表都有一个修饰符列表。

某些修饰符选项需要以不同方式显示（例如，浇头需要指定左/右/全部），即使它们是相同的数据类型。

我正在尝试使用 @Html.EditorFor 并在需要时指定备用 EditorTemplate。

在 /Views/Shared/EditorTemplates 我有 ModifierSelection.cshtml 和 ToppingSelection.cshtml。我在以下视图中调用它们：

```
@model MyApp.ViewModels.ModifierSelectionList

<div class="menugroup">
    <h3 class="menuname">@Model.ModifierListName: (Select @Model.MaximumSelections)</h3>
    <div class="modcountvalidation">@Model.ValidationResults</div>
    @Html.HiddenFor(model => Model.ModifierListId)

    <table class="menu">
    @if (Model.IsToppingsList)
    {
        @Html.EditorFor(model => Model.ModifierSelections, "ToppingSelection")
    }
    else
    { 
        @Html.EditorFor(model => Model.ModifierSelections)
    }
    </table>
</div> 
```

当我尝试显示需要“ToppingSelection”EditorTemplate 而不是默认值的项目时，我收到以下错误：

```
System.InvalidOperationException was unhandled by user code
  Message=The model item passed into the dictionary is of type 'System.Collections.Generic.List`1[MyApp.ViewModels.ModifierSelection]', but this dictionary requires a model item of type 'MyApp.ViewModels.ModifierSelection'.
  Source=System.Web.Mvc 
```

所以 - 我有一组用于数据类型的 EditorTemplates。我正在尝试使用它们来显示项目列表，并且我需要能够选择要使用的项目。

我究竟做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T16:56:07.813

好的，这是真正的解决方案。我不得不使用 for 循环来迭代，而不是使用 foreach 遍历列表。

```
@for (int i = 0; i < Model.ModifierSelections.Count; i++ )
{
    if (Model.IsToppingsList)
    {
        @Html.EditorFor(m => Model.ModifierSelections[i], "ToppingSelection")
    }
    else
    { 
        @Html.EditorFor(m => Model.ModifierSelections[i])
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T20:57:59.617

解决了！

显然，如果您将列表类型发送到 Html.EditorFor 并且不指定模板，它将遍历列表并使用它为项目类型找到的模板显示每个项目。如果您确实指定了模板，它不会遍历列表并将每个项目发送到该模板，它会尝试将整个列表发送到您的模板，这不是正确的数据类型。

我通过手动遍历列表来修复它：

```
@foreach (var modifierSelection in Model.ModifierSelections)
{
    if (Model.IsToppingsList)
    {
        @Html.EditorFor(m => modifierSelection, "ToppingSelection")
    }
    else
    { 
        @Html.EditorFor(m => modifierSelection)
    }
} 
```

# jquery - jQuery Mobile – 如何滚动列表与绑定到 vmouseup 的项目

> ID：10219773
> 
> 赞同：0
> 
> 时间：2012-04-18T23:52:35.443
> 
> 标签：jquery, listview, jquery-mobile, event-handling

我有一组列表项绑定到“vmouseup”而不是“click”，因为事件的触发时间滞后 300 毫秒。

我的问题是当我使用“vmouseup”或“vmousedown”绑定每个列表项时，我显然无法通过一些调整来滚动列表。

我的列表元素看起来是这样的：

```
 $(liElem).bind('vmouseup', function () {
      scrollToTop();
      showDetails();
 }); 
```

1.  如何在不触发列表元素上的 vmouseup 事件的情况下滚动列表？
2.  我记得在 SOFlow 的某个地方读到 vmouseup 不一定总是触发，所以我应该使用 vmousedown 代替吗？

我想我知道#1 的答案与`unbind()`/`die()`有轻微的可能性`stopPropagation()`和`preventDefault()`

**更新的答案**

在 iOS 4.2.1 (iPod Touch) 中，阈值方法似乎有问题。如果向上滚动（从上到下滑动），一切正常，但是当向下滚动（从下到上滑动）时，pageY 通常会给出错误值并触发事件。例如，如果将阈值设置为 30 像素并且我从手机的最底部滑动到顶部，它仍然可以触发事件。使用 jQueryMobile 1.1.0 RC1 和 jQuery 1.7.1。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-18T23:56:04.817

```
var did_user_swipe = false;
$(liElem).bind('vmousedown', function () {
    did_user_swipe = false;
}).bind('vmouseup', function () {
    if (!did_user_swipe) {
        scrollToTop();
        showDetails();
    }
}).bind('vmousemove', function () {
    did_user_swipe = true;
}); 
```

这会设置一个`false`默认标志。`true`当用户以滑动动作拖动他们的手指时，该标志设置为。当标志设置为`true`时，`vmouseup`事件处理程序将不会运行。

这是一个演示：http: [//jsfiddle.net/RB6mp/](http://jsfiddle.net/RB6mp/)

# 更新

您还可以为滑动/单击行为设置阈值，从而减少绑定到`vmousemove`事件的需要：

```
var coords    = [0, 0],
    threshold = 100;//in pixels
$(liElem).bind('vmousedown', function (event) {

    //when the mouse is clicked, set the coordinates of that event
    coords = [event.pageX, event.pageY];
}).bind('vmouseup', function (e) {

    //when the mouse is released, calculate the distance from the start of the click to the end
    var distance = Math.sqrt(Math.pow(coords[0] - e.pageX, 2) + Math.pow(coords[1] - e.pageY, 2));

    //if the distance of the "swipe" is longer than the `threshold` set
    if (distance > threshold) {
        alert('Swipe (' + Math.floor(distance) + 'px)');
    } else {
        alert('Click (' + Math.floor(distance) + 'px)');
    }
});​ 
```

这是一个演示：http: [//jsfiddle.net/RB6mp/4/](http://jsfiddle.net/RB6mp/4/)

# c# - 识别“在对象实例上工作”的类

> ID：10219776
> 
> 赞同：-2
> 
> 时间：2012-04-18T23:52:40.810
> 
> 标签：c#, static

静态类不应该在对象的实例上工作。那么，如何识别正在“处理”的对象的实例？这会是任何具体的东西吗（即，将 new ObjectA() 传递给 aa 方法的参数）。因此，如果这是我所看到的，则该类不应该是静态的。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:25:12.977

~~静态类仅仅意味着该对象只有一个实例。~~一个静态类的行为就像它只有一个实例一样。将其视为全球性的；您不能实例化静态类的任何对象。类的成员变量的值将全局保留其值，您可以使用成员函数对它们进行“处理”。

与静态类相反，使用非静态类，您可以创建新对象并使用成员函数在这些对象上“工作”：

```
vehicle honda = new vehicle();
honda.fuelup(10);
honda.value.ToString(); 
```

如果这是一个静态类：

```
vehicle.fuelup(10);
vehicle.value.ToString(); 
```

在上面的示例中，我们创建了一个对象 honda，类型为车辆。然后我们用函数对对象进行“工作”。对于静态类，我们~~不需要~~不能创建对象，我们只需调用类名而不是对象名（如本田）。

回顾一下：

*   ~~静态 = 全局，一个实例~~
*   静态 = 全局，**如果**它只是一个实例（程序 itelf？）
*   非静态 = 本地范围，许多实例

如果这不能回答或解决问题，请用明确的问题重新表述。

# javascript - 检查数组中“存在”的数据？

> ID：10219777
> 
> 赞同：-1
> 
> 时间：2012-04-18T23:53:00.820
> 
> 标签：javascript

我有一小部分数据，我想检查我正在检查的值是否一起存在于数组中。

这就是我的 console.log(astar); 中数据的样子；

[http://i.imgur.com/PqzG7.jpg](http://i.imgur.com/PqzG7.jpg)

我的尝试是：

```
 console.log(astar); // display array info
     for (i=0; i < 50; i++){    
        for (j=0; j < 50; j++){ 
        if( i in astar && j in astar[i] ){
               abposx = getx(i);
               abposy = gety(j);
        ctx.fillStyle = "#000";
        ctx.fillRect (abposx,abposy,10,10);             
    } 
```

这个想法是具有[0] [1]位置的“内部数组”，我试图查看它们中的“任何”是否具有[0] == i和[1] == j，如果so = true。

我应该如何改变它以正确和最有效地工作 - 以便在数组中找到它时会绘制

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T00:01:45.590

你目前正在做的相当于

```
for (i=0; i < astar.length; i++)
    for (j=0; j < astar[i].length; j++) {
        abposx = getx(i);
        abposy = gety(j);
        ctx.fillStyle = "#000";
        ctx.fillRect(abposx,abposy,10,10);
    } 
```

您可能想要：

```
for (i=0; i < astar.length; i++) {
    if (astar[i][0] > 50 || astar[i][1] > 50)
        continue;
    abposx = getx(astar[i][0]);
    abposy = gety(astar[i][1]);
    ctx.fillStyle = "#000";
    ctx.fillRect(abposx,abposy,10,10);
} 
```

循环遍历所有坐标非常低效，需要第三个循环才能在 astar 中搜索。更好地循环通过 astar 并绘制你能得到的东西。

正确的三循环代码应该是：

```
for (i=0; i < 50; i++)
    for (j=0; j < 50; j++)
        if (astar.some(function(item) {
            return item[0] == i && item[1] == j;
        }) {
            abposx = getx(i);
            abposy = gety(j);
            ctx.fillStyle = "#000";
            ctx.fillRect(abposx,abposy,10,10);
        } 
```

（[some()](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/some)循环遍历数组，如果项目与条件函数匹配则返回 true。它等于[bfavaretto 发布的扩展版本](https://stackoverflow.com/a/10219818/1048572)）。导致 O(n^2.5) 的性能......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:59:13.797

目前尚不清楚您要与数组值比较什么。你所拥有的是一个包含其他数组的数组，每个数组里面只有两个项目。你可以像这样循环它：

```
for(var i=0; i<astar.length; i++) {
    console.log("Array " + i + " contains values " + astar[i][0] + " and " + astar[i][1]);
} 
```

**更新**

我仍然不确定我明白了，但你可能正在寻找这个：

```
for (i=0; i < 50; i++){    
    for (j=0; j < 50; j++){ 
         for(var k=0; k<astar.length; k++) {
              if(astar[k][0] == i && astar[k][1] == j) {
                    abposx = getx(i);
                    abposy = gety(j);
                    ctx.fillStyle = "#000";
                    ctx.fillRect (abposx,abposy,10,10);
                }
          }
     }
} 
```

# asp.net - REST 请求的自定义 HTTP 处理程序

> ID：10219779
> 
> 赞同：0
> 
> 时间：2012-04-18T23:53:09.330
> 
> 标签：asp.net, rest, httphandler

我确信这是一个简单的解决方法 - 但经过数小时的谷歌搜索后，我无法找到答案。

我想要做的是设置一个自定义处理程序，它将处理所有具有 {domain}/services/* 路径的请求。

我有一个包含大量 javascript 和 ajax 调用的 Web 应用程序。我想实现一个处理程序，它将促进对其他服务（谷歌地图、一些自定义服务等）的所有请求。这将允许我利用客户端上的缓存和简单配置。

我的问题是处理程序的实现。我无法让 IIS Express（或内置的 VS 2010 Web 服务器）来捕获带有上述路径信息的任何请求。

我希望 JavaScript 客户端能够进行 RESTful 调用，让处理程序接收该调用并相应地进行处理。

这是我到目前为止所做的：

1.  实现了一个继承 IHTTPHandler 接口的类（该类在 App_Code 文件夹中）。
2.  配置了 Web.Config：system.webServer 模块 runAllManagedModulesForAllRequests="true" handlers add name="SeviceHandler" verb=" *" path="* /services/*" type="MyWeb.UI.ServiceHandler, MyWeb.UI" resourceType ="未指定的“处理程序 system.webServer

我很感激这里的一些帮助。这让我发疯了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-04T07:51:58.887

在 .Net 中，微软在 WCF 应用程序中提供了其余架构构建 API，通过 webHttpBinding 协议管理请求和响应。

实现一个简单的自定义 HttpHandler 比调用与 ASP.NET Web 服务相关的所有管道和开销可能更有益/更有效。使用自定义 HttpHandler，您可以只发送您需要的参数并准确返回您希望看到的结果，而无需使用 XML Web 服务时创建的任何支持 SOAP xml。

Bellow 是自定义处理程序（我们也可以使用 .ashx 文件，但不支持自定义处理程序提供的虚拟路径或虚拟扩展名）

```
<system.web>
 <httpHandlers>
   <add verb="*" path="Services.fck" type="restHandler"/>
</httpHandlers> 
```

......

```
if (Request.RequestType == "GET")
{

  //RawUrl=http://localhost/Services.fck/?Vivek/Gupta
  string RawUrl = Request.RawUrl;
  string splitter = "/?";
  string SubRawUrl = RawUrl.Substring(RawUrl.IndexOf(splitter) + splitter.Length);

  string[] Parameters = SubRawUrl.Split('/');
  if (Parameters.Length >= 2)
  {
   string name = Parameters[0];
   string surname = Parameters[1];
   string res = string.Format("Welcome {0} {1}", name, surname);
   JavaScriptSerializer jc = new JavaScriptSerializer();
   StringBuilder sb=new StringBuilder ();
   jc.Serialize(res, sb);
   Response.Write(sb.ToString());
   Response.ContentType = "application/json";
  }
} 
```

有关如何使用 http 处理程序创建基于 json、xml、纯文本（GET、Post）的 rest 服务以及如何从 jquery、asp.net、javascript 调用它们，请参见下文：

## ***[使用 httphandler 在 asp.net 中创建 Rest 服务](http://www.dotnetbull.com/2012/08/rest-services-in-net-with-httphandler.html)***

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-04-19T02:49:01.067

您可能想查看[.Net Web API](http://www.asp.net/web-api)。

# java - Java 游戏、弹跳和动作

> ID：10219780
> 
> 赞同：1
> 
> 时间：2012-04-18T23:53:21.147
> 
> 标签：java, geometry, 2d, trigonometry

我正在尝试创建一个简单的游戏库，主要是为了自学。我在这里和网络上阅读了一些帖子。但我认为我的问题有点不同，因为我使用的是我的“自己的逻辑”。

**基础：**

我在屏幕上的所有对象都称为“实体”，它们能够实现一个名为“EntityActionListener”的接口，允许与鼠标、键盘交互、在屏幕上移动等。

**如何以最佳方式移动实体？**

*主意：*

首先，我想实现运动，然后是实体的弹跳和碰撞。

对于运动和弹跳，这是我遇到问题的地方，我想要以下变量和函数：

```
protected float posx = 0, posy = 0;
protected float v = 0, vx = 0, vy = 0;
protected int direction = 0; 
```

我使用该`setVelocity(float arg1)`函数将速度 (v) 设置为 arg1 并更新轴上的速度 (vx, vy)：

```
/**
 * Set the velocity on both axis according to the direction given
 *
 * @param arg1 the direction in degrees
 * @param arg2 the velocity
 */
private void setVelocityOnAxis(int arg1, float arg2)
{
    // Check for speed set to 0
    if (arg2 == 0) {
        vx = 0;
        vy = 0;
        return;
    }

    // Set velocity on axis
    vx = (float) (Math.cos(arg1 * Math.PI / 180) * arg2);
    vy = (float) (Math.sin(arg1 * Math.PI / 180) * arg2);
} 
```

例如，速度 (v) 可能会在触发事件内更新。=> 这一步似乎工作正常。

但是我在方向上遇到了一些麻烦，应该按如下方式处理：

```
/**
 * Set the entity direction
 *
 * @param arg1 the direction in degrees
 */
protected final void setDir(int arg1)
{
    // Update direction
    direction = arg1;

    // Update velocity on axis
    setVelocityOnAxis(direction, v);
}

/**
 * Get the enity direction based on the axis
 *
 * @param arg1 the x velocity
 * @param arg2 the y velocity
 */
protected final int getPointDir(float arg1, float arg2)
{
    // Set the direction based on the axis
    return (int) (360 - Math.abs(Math.toDegrees(Math.atan2(arg1, arg2)) % 360));
} 
```

我想在框架的边界上有一个弹跳，所以我通过比较 x 和 y 坐标来检查 4 个方向，并根据侧面将 vx 或 vy 设置为其加法倒数（如 1 到 -1）。但这确实失败了。

如果我只是更新每一侧的 vx 或 vy，它会像预期的那样反弹，但由于这个原因，方向没有更新。

这是我使用的代码：

```
// ...
// Hit bounds on x axis
direction = -vx; // works.
setDir(getPointDir(-vx, vy)); // does not work. 
```

我的几何学和三角学不太好。问题是我不能说为什么在 360 方向上水平速度为 1 的碰撞会导致 45 度或我从调试打印中得到的其他奇怪的东西......

我真的希望有人可以帮助我。我只是无法修复它。

**编辑：**

我的问题是：为什么这不起作用。setDir() 或 getPointDir() 中的某些代码一定是错误的。

**编辑 2**

所以，我终于让它工作了。问题是实体的方向是 45 并且向下移动而不是向上移动，所以我对 v 速度进行加法逆运算 - 这会导致这个愚蠢的错误，因为减号和减号是正数，而当我弹跳时，它总是改变两个速度，vx和vy。我只需要更改学位计算中的某些内容。感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T03:41:29.577

我在猜测，`getPointDir()`应该`setVelocity()`从 x,y 和 x,y 以度为单位计算方向（分别）。在这种情况下，下面是正确的 getPointDir() 行：

```
return (int) (360 + Math.toDegrees(Math.atan2(arg2, arg1))) % 360; 
```

一个简单的测试：

```
public static void main(String[] args) {
    Test t = new Test();

    for (int i = 0; i < 360; i++) {
        t.setVelocityOnAxis(i, 10);
        System.out.println("Angle: " + i + " vx: " + t.vx + " vy: " + t.vy);
        System.out.println("getPointDir: " + t.getPointDir(t.vx, t.vy));
    }

} 
```

**对于错误进行**编辑**`atan2()`，总是`y,x`- 使用 arg1、arg2 以外的变量名称更容易发现。另一个错误出现在 Math.abs 逻辑中。**

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:07:32.907

检查[这个答案](https://stackoverflow.com/questions/573084/how-to-calculate-bounce-angle)。它正确地在轴上反弹。您必须认为入射角与出射角一样大，正好相反。帖子中的图片描述了这一点。祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T01:15:55.310

*也许*这就是你正在寻找的......（仍然不确定我是否得到你的代码）。

在`getPointDir()`：

```
double deg = Math.toDegrees(Math.atan2(arg1, arg2));
if (deg < 0) deg += 360;
return (int) deg; 
```

然后`setDir(getPointDir(-vx, vy))`在你原来的帖子中使用。**

# javascript - Javascript在mailto正文中添加换行符

> ID：10219781
> 
> 赞同：24
> 
> 时间：2012-04-18T23:53:24.657
> 
> 标签：javascript, html

我正在使用表单中的值设置电子邮件的正文

```
 firstname = bob
  lastname = dole

   ebody = 'First Name: ' + firstname + '\r\n' + 'Last Name: ' + lastname

  window.location.href = 'mailto:myemail@mycompany.com?subject=test
  email&body=' + ebody; 
```

如果我做一个“警报（ebody）；” 我得到名字和姓氏之间的换行符，但是当它打开 Outlook 时，整个 ebody 字符串出现在电子邮件正文中没有换行符。

我也试过 \n 。有什么可以换行的吗？

提前致谢

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-04-19T02:42:25.237

[RFC 2368](https://www.rfc-editor.org/rfc/rfc2368)规定 mailto 正文内容必须是 URL 编码的，对通常在 URL 中编码的字符使用 % 转义形式。这些字符包括空格和（在 2368 的第 5 节中明确指出）CR 和 LF。

你可以通过写来做到这一点

```
ebody = 'First%20Name:%20' + firstname + '%0D%0A' + 'Last%20Name:%20' + lastname; 
```

但是让 JavaScript 为您进行转义会更容易更好，如下所示：

```
ebody = 'First Name: ' + firstname + '\r\n' + 'Last Name: ' + lastname;
ebody = encodeURIComponent(ebody); 
```

这不仅可以让您不必识别和查找需要在固定文本中编码的字符的十六进制值，它还可以在`firstname`和`lastname`变量中编码任何愚蠢的字符。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-07T07:10:21.907

您可以只使用编码 `%0D%0A`换行。

```
firstname = 'Aung ';
lastname = 'Kyaw Zaw';

ebody = 'First Name: ' + firstname + '%0D%0A' + 'Last Name: ' + lastname;

window.location.href = 'mailto:myemail@mycompany.com?subject=testemail&body=' + ebody; 
```

[http://www.w3schools.com/tags/ref_urlencode.asp](http://www.w3schools.com/tags/ref_urlencode.asp)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T00:08:45.913

我希望 Outlook 尝试将其输出为 html/富文本，因此在这种情况下，您需要类似以下内容（包括 urlencoded br 标签）：

```
 firstname = bob
  lastname = dole

   ebody = 'First Name: ' + firstname + '%3C%2Fbr%3E' + 'Last Name: ' + lastname

  window.location.href = 'mailto:myemail@mycompany.com?subject=test
  email&body=' + ebody; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-05T10:37:10.347

有时，当您使用 HTML/JavaScript 从 SharePoint 内容编辑器 Web 部件打开 Outlook 时。那么您还需要考虑以下选项。

使用代码 -

> %0D%0A%0D%0A

换一条新线。

```
<a href="mailto:jegan.baskaran@domain.de?subject=Hello%20there%20Mr%20Jegan&amp;body=Hello%20Jegan,%0D%0A%0DHowr%20are%20you%20boss.">E-Mail to Jegan</a>
```

# mp3 - 使用 html5 的 audo 标签下载时是否播放音频 (mp3)

> ID：10219784
> 
> 赞同：2
> 
> 时间：2012-04-18T23:53:33.783
> 
> 标签：mp3, html5-audio

当网页通过 HTML5 标签下载 MP3 文件时：

```
<audio autoplay="autoplay">
   <source src="../blah" type="audio/mp3"/>
</audio> 
```

下载 MP3 时（同时）是否播放音频？或者，是否先下载文件然后播放声音？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T00:57:00.993

毫无疑问，答案可能因设备和网络浏览器而异，但如果您询问是否可以在完成下载之前播放 html5 音频标签，那么可以。（在 Firefox/Chrome 中测试）

声音在缓冲时播放，本质上是流式传输的。

# blackberry-playbook - BlackBerry PlayBook 上的“锁定”应用程序以防止导航离开？

> ID：10219793
> 
> 赞同：3
> 
> 时间：2012-04-18T23:55:22.973
> 
> 标签：blackberry-playbook

我想知道是否可以锁定应用程序，以便用户无法选择任何硬件按钮来退出应用程序。

该应用程序将在会议上用于显示目的，并希望不断显示视频。完成后，可以通过输入密码从应用程序内关闭应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-23T05:48:06.207

根您的剧本，然后进入 ssh 控制台并删除底部边框滑动手势的系统事件侦听器。我想这会很有趣

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T21:12:47.700

目前没有可供第三方开发人员执行此操作的 API。

RIM 似乎最终会提供一个，但他们并没有公开表示任何方式。我建议与他们联系，以确保他们了解您对此和特定用例的渴望，以便他们可以将其纳入优先事项。

编辑：实际上有一个“功能请求”票为此开放，您可以对其进行投票以表达您的支持，或者如果您有其他用例，请添加评论：[https ://www.blackberry.com/jira/browse /平板电脑-432](https://www.blackberry.com/jira/browse/TABLET-432)

# http - jQuery.ajax 在响应结束之前获取服务器刷新的数据的开头

> ID：10219799
> 
> 赞同：2
> 
> 时间：2012-04-18T23:55:51.070
> 
> 标签：http, jquery

当对服务器的 HTTP 请求需要很长时间才能完成时，服务器可以发送部分响应，浏览器通常会显示这些部分，即使响应尚未完成。

现在，如果我使用`jQuery.ajax`而不是普通的浏览器请求，我是否有办法在完成之前获取响应数据的第一部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-18T23:58:05.280

您可能只需要添加：

```
async: false, 
```

您要求强制ajax 请求在继续之前等待响应？

# jquery - Gist / Github API - 获取私有和公共 Gist

> ID：10219804
> 
> 赞同：3
> 
> 时间：2012-04-18T23:56:07.650
> 
> 标签：jquery, github-api, gist

我正在尝试使用 github api 列出一组用户的所有要点。这工作得很好，但我似乎无法让它为我自己或任何其他用户返回私人要点。

我知道您可以在请求中设置范围，但我不知道如何在我的 JQuery 请求中设置它以及我应该使用什么范围来获取私有要点？

我的一些代码如下：

```
var the_url = 'https://api.github.com/users/'+ encodeURIComponent(user) +'/gists';

      $.oauth ({
        consumerKey: 'xxxxxxxxxxxxxxxxx', 
        consumerSecret: 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx', 
        type: "GET",
        url: the_url,
        data: {},
        dataType: 'json',
        async: false, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T03:06:36.377

您需要用户通过 oAuth 授予访问权限。

> 您可以阅读公共要点并为无需令牌的匿名用户创建它们；但是，要代表用户读取或写入要点，则需要要点 oAuth 范围。

[http://developer.github.com/v3/oauth/#scopes](http://developer.github.com/v3/oauth/#scopes)

# c++ - C++ cout 不断重复

> ID：10219805
> 
> 赞同：1
> 
> 时间：2012-04-18T23:56:23.813
> 
> 标签：c++, repeat

if (!(cin.good())) cout << "No letters" << endl; 如果我输入字母，我会不停地重复，但其他字母工作得很好。说不出为什么。

```
#include <iostream>
#include <cstdlib>
#include <time.h>
#include <cstdio>
using namespace std;

int main()
{
    int x;
    cout << "Please enter a number\n";

    srand(time(0));
    int y = rand();

    while (x != y)
    {
        cin >> x;
        if (!(cin.good()))
           cout << "No letters" << endl;
        else if (x < y)
           cout << "Go higher" << endl;
        else if (x > y)
           cout << "Go lower" << endl;
        else
           cout << "You win!!" << endl;
    }
cin.get();
getchar();
return 0;

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T00:01:19.960

您的无效输入位于输入缓冲区中。如果你只是想把它全部扔掉，你可以这样做：

```
...
if (!cin.good()) 
{
    cout << "No letters" << endl;
    cin.clear(); // clear error flags
    cin.sync();  // synchronize stream with input source
}
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-18T23:59:01.837

您需要消耗错误的输入，因为它只会保留在缓冲区中。

# c# - 为 RequestToken 调用 Google API 时出现签名无效错误

> ID：10219816
> 
> 赞同：0
> 
> 时间：2012-04-18T23:58:26.923
> 
> 标签：c#, oauth, google-api

我正在为 RequestToken 调用 Google API，并且正在使用 OAuhtBase 生成我的签名。我的代码如下所示：

```
 public Uri BaseURL
        {
            get { return new Uri("https://www.google.com/accounts/OAuthGetRequestToken");  }
            set { }
        }
        public string ConsumerKey
        {
            get { return "anonymous"; }
        }
        public string Nonce
        {
            get { return oAuthBase.GenerateNonce(); }
        }
        public string SignatureMethod
        {
            get { return "HMAC-SHA1"; }
        }
        public string Signature { get
        {
            string url;
            string requestParams;
            return HttpUtility.UrlEncode(oAuthBase.GenerateSignature(BaseURL, ConsumerKey, ConsumerSecret, string.Empty, string.Empty,
                                               "GET", Timestamp, Nonce, out url, out requestParams));
        }
        }
        public string Timestamp
        {
            get { return oAuthBase.GenerateTimeStamp(); }
        }
        public string Scope
        {
            get { return "https://www.googleapis.com/auth/userinfo.profile"; }
        }
        public string Callback
        {
            get { return "www.contestfactory.com"; }
        }

          public string GenerateURL()
          {

             var returnURL = new StringBuilder(BaseURL.ToString());

             returnURL.Append("?");
             returnURL.Append("oauth_consumer_key=" + ConsumerKey);
             returnURL.Append("&oauth_signature_method=" + SignatureMethod);
             returnURL.Append("&oauth_signature=" + Signature);
             returnURL.Append("&oauth_timestamp=" + Timestamp);
             returnURL.Append("&oauth_nonce=" + Nonce);
             returnURL.Append("&oauth_callback=" + Callback);
             returnURL.Append("&scope=" + Scope);

              return returnURL.ToString();

          } 
```

现在，当我的 javascript 尝试浏览到此代码生成的 URL 时。它在浏览器上返回以下错误：

> signature_invalid base_string:GET&https%3A%2F%2Fwww.google.com%2Faccounts%2FOAuthGetRequestToken&oauth_callback%3Dwww.contestfactory.com%26oauth_consumer_key%3Danonymous%26oauth_nonce%3D400857%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1334790691%26scope%3Dhttps%253A%252F %252Fwww.googleapis.com%252Fauth%252Fuserinfo.profile

我不确定签名的哪一部分可能是错误的，因为我向它传递了所有必需的参数，它们都是基本字符串。任何想法？

# php - Else If 语句的问题

> ID：10219827
> 
> 赞同：0
> 
> 时间：2012-04-19T00:01:05.520
> 
> 标签：php, if-statement

好的，所以我想要发生的是当用户注销时，我的脚本应该检查代码 2 的 url 并向用户显示他们已注销。如果 1 密码或用户名错误， 3 不确定他们是如何到达那里的。它提取正确的数字，但只会显示 1 的消息。我不知道出了什么问题：/

```
<?php
$err = $_GET['err'];
echo $err;//Proof the code is getting number
if ($err = "1") {
echo '<center><span class="error-box">'; echo "Whoops! Wrong Username or Password. Please try again.</span></center>";
} 
elseif ($err = '2') {
echo '<center><span class="info-box">'; echo "You Have Been Succesfully Logged Out.</span></center>";
} 
else {
echo '<center><span class="info-box">'; echo "Whoops! Somthing funny happened and were not quite sure what your trying to do. Please try again.</span></center>";
}
?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T00:02:10.150

因为比较运算符是`==`，不是`=`。

所以你需要有

```
if ($err == "1") { 
```

# objective-c - iOS：使用相机时放大到部分屏幕

> ID：10219828
> 
> 赞同：0
> 
> 时间：2012-04-19T00:01:08.163
> 
> 标签：objective-c, ios, cocoa-touch, uiimagepickercontroller

我正在使用 a`UIImagePickerController`在屏幕上显示视频。有没有办法缩放实时视频的一部分？例如视频的正方形部分？

如果这是可能的，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T01:28:29.890

UIImagePickerController 类有一个属性：

```
@property (nonatomic) CGAffineTransform cameraViewTransform 
```

CGAffineTransform 记录[在此页面上](http://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CGAffineTransform/Reference/reference.html)

请记住，这只会改变相机输入在屏幕上的呈现方式。裁剪输出图像是另一回事，但 cameraTransform 属性也可以帮助您。

# .htaccess - 重写 .htacces 第一个目录

> ID：10219831
> 
> 赞同：0
> 
> 时间：2012-04-19T00:01:23.797
> 
> 标签：.htaccess, mod-rewrite, directory

这是我想使用的地址：

**http://mydomain.com/cars**

我想重定向 ** [http://mydomain.com/category/product.php?code=cars](http://mydomain.com/category/product.php?code=cars) **

但我很困惑......因为只有当我的汽车在子目录中时我才能做到这一点

所以这是有效的：

```
Options +FollowSymlinks
RewriteEngine on

RewriteRule ^product/([^/\.]+)/?$ /category/product.php?url=$1 [L] 
```

我如何将规则更改为：

```
RewriteRule ^([^/\.]+)/?$ /category/product.php?url=$1 [L]  ?? 
```

谢谢你的帮助。我正在寻找解决方案，但我没有找到它......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T05:59:29.053

```
Options +FollowSymlinks
RewriteEngine on
RewriteRule ^([^/]+)/?$ /category/product.php?code=$1 [L] 
```

# javascript - CSS 下拉菜单未正确对齐

> ID：10219841
> 
> 赞同：0
> 
> 时间：2012-04-19T00:02:24.623
> 
> 标签：javascript, html, css, xhtml, wordpress-theming

我为一个客户端开发了[http://pizzli.com/millington](http://pizzli.com/millington)，并且只使用 CSS 作为下拉菜单。结果很好，但是由于某种原因它们向右对齐。看看下面的图片。任何援助将不胜感激。

![在此处输入图像描述](../Images/75466a6075c02df8a65d81fa712f1fab.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T04:34:43.107

嘿，我希望你的下拉导航从左开始，而不是你给你的 li 位置相对和 sub ul 给左和绝对属性，就像这样

**对您的 css 文件进行一些更改**

```
#navigation li {
    float: left;
    list-style: none outside none;
    position: relative;
} 
```

和这个

```
#navigation li:hover ul {
    display: block;
    left: -16px;
    margin: 0;
    padding: 0;
    position: absolute;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-04T22:01:28.910

尝试制作`left: inherit;`然后做`margin-left: xyz;`相对于父元素定位的元素。
请注意，您可能必须将 and 更改`left:`为`margin-left:`and `right:`，`margin-right:`但这对我来说效果很好，我花了很长时间才弄清楚。

# forms - symfony2 表单声明中的致命错误

> ID：10219842
> 
> 赞同：0
> 
> 时间：2012-04-19T00:02:38.773
> 
> 标签：forms, symfony

当我访问我的浏览器时，这是我得到的：

```
Fatal error: Declaration of Ecs\CrmBundle\Form\Parts\DepartmentSelectionType::getDefaultOptions() must be compatible with Symfony\Component\Form\FormTypeInterface::getDefaultOptions() in C:\wamp\www\crm\src\Ecs\CrmBundle\Form\Parts\DepartmentSelectionType.php on line 41 
```

它在那里引用的文件在下面找到：

```
<?php

namespace Ecs\CrmBundle\Form\Parts;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilder;

class DepartmentSelectionType extends AbstractType {
    private $canSeeAll = false;

    public function __construct($canSeeAll = false)
    {
        $this->canSeeAll = $canSeeAll;
    }

    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
            ->add('department', 'entity',
                array(
                    'class' => "EcsAgentManagerBundle:EmployeeDepartment",
                    'required' => false,
                    'multiple' => true,
                    'expanded' => true,
                    'label' => "Department"))
        ;
    }

    public function getDefaultOptions(array $options)
    {
        return array(
            'data_class' => 'Ecs\AgentManagerBundle\Entity\EmployeeDepartment',
        );
    }

    public function getName()
    {
        return 'ecs_crmbundle_departmentselectiontype';
    }
} 
```

是它引用的文件...关于问题可能是什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:24:07.190

我相信 FormTypeInterface 在 Symfony 2.1 中发生了变化。

[`getDefaultOptions`](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Form/FormTypeInterface.php#L80)不再需要争论。

从[UPGRADE-2.1 文档](https://github.com/symfony/symfony/blob/master/UPGRADE-2.1.md)：

* * *

> 表单类型的 getDefaultOptions() 和 getAllowedOptionValues() 方法不再接收选项数组。
> 
> 您可以使用闭包指定依赖于其他选项的选项。

**之前**：

```
public function getDefaultOptions(array $options)
{
    $defaultOptions = array();

    if ($options['multiple']) {
        $defaultOptions['empty_data'] = array();
    }

    return $defaultOptions;
} 
```

**之后**：

```
public function getDefaultOptions()
{
    return array(
        'empty_data' => function (Options $options, $previousValue) {
            return $options['multiple'] ? array() : $previousValue;
        }
    );
} 
```

# entity-framework-4 - 使用实体框架迁移播种和分支项目

> ID：10219846
> 
> 赞同：2
> 
> 时间：2012-04-19T00:03:41.663
> 
> 标签：entity-framework-4, entity-framework-4.3, entity-framework-migrations

我正在使用实体框架代码首先使用迁移 4.3 进行项目。在本地运行时，我的 web.config 配置为以数据库初始化器为目标，该初始化器实现`CreateDatabaseIfNotExists<DataContext>`了用测试数据为我的开发数据库提供种子，但还在第一次运行时填充各种“静态”可查找数据。

创建开发数据库后，对数据库的任何后续更改都已完成，将迁移添加到项目并使用“updata-database”PS 命令更新数据库。

当我对项目感到满意时，我使用 webdeploy 部署代码，但手动复制数据库，因为 webdeploy 不包含迁移表。部署时，我使用 web.config 转换来设置一个新的数据库初始化程序，该初始化程序实现`MigrateDatabaseToLatestVersion<DataContext>`. 然后，这将应用之后部署的新的基于代码的迁移。这一切都运行良好，但我担心这是否是初始化我的数据库的最佳方法，不仅使用测试数据而且还使用运行应用程序所需的数据。我正在寻找的是一种创建初始种子数据的好方法，而无需将其挂接到迁移中`CreateDatabaseIfNotExists<DataContext>`，而是将其挂接到迁移中。我意识到配置类上有一个种子方法，但是看到它在每次迁移时都更新数据库，这不是理想的解决方案。

该项目在 TFS 中，有时我需要创建该项目的一个新分支，它本质上是第一个的克隆。第一次在本地运行时，数据库尚不存在，但将如前所述创建和播种。现在最大的问题是，以前通过迁移处理的模式更改现在将在第一次创建数据库时应用。如果我然后尝试添加一个新的迁移文件并运行“更新数据库”，我会碰壁，因为它无法运行以前的迁移，因为在创建数据库时已经应用了这些更改。我只能想象我在这里做错了什么，或者只是错过了一个技巧。

总之，我正在寻找有关

1.  首次使用迁移创建数据库时，播种初始测试数据和所需应用程序数据的最佳方式。
2.  分支包含代码迁移的项目并且必须第一次创建数据库时克服问题的最佳方法。

谢谢阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T09:55:20.077

> 首次使用迁移创建数据库时，播种初始测试数据和所需应用程序数据的最佳方式。

迁移配置有`Seed`正好解决这个问题的方法。在这种方法中，您可以使用`AddOrUpdate`扩展方法来初始化您的核心数据。扩展方法将首先检查数据库中是否已存在记录，然后更新它或插入新记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-12T07:40:46.350

我觉得使用 Seed 方法初始化数据库对于非常小的和简单的数据集来说是一个错误。原因是正如您所说，它只是过于频繁地运行。我们已将数据初始化从应用程序中移出并移至安装过程中。我们刚刚构建了一组使用普通实体框架代码创建所需数据的方法。这样，我们就不必担心性能，并且可以更轻松地编写验证数据创建代码的测试。

为了在开发期间初始化数据库，我们有一组单元测试将运行与安装程序相同的代码。开发人员只需运行单元测试，他们的数据库就会被正确初始化。

# ruby-on-rails - Rails 3 - 控制器中方法“新”的 NoMethodError

> ID：10219847
> 
> 赞同：1
> 
> 时间：2012-04-19T00:04:02.827
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我是 Rails 的新手，我想在没有脚手架的情况下做到这一点，所以我真的会学习它。我查看了 railstutorial.org，但它与我的项目正在做的不同，所以我在另一个 rails 项目中生成了脚手架并复制编辑过的代码。

环境：Ubuntu Lucid，ruby 1.9.3p125，rails 3.2.1

转到应用程序的根目录[http://localhost:3000/时出现此错误](http://localhost:3000/)

```
NoMethodError in DreamController#new

undefined method `new' for Dream:Module
Rails.root: /vagrant/dream

Application Trace | Framework Trace | Full Trace
app/controllers/dream_controller.rb:5:in `new' 
```

这是我的路线.rb

```
Dream::Application.routes.draw do
  resources :dreams do
    resources :interpretations
  end
  root :to => 'dream#new'
end 
```

这是我的控制器：

```
class DreamController < ApplicationController
  def new
    @dream = Dream.new

    respond_to do |format|
      format.html # new.html.erb
    end
  end

  def create
    @dream = Dream.new(params[:dream])

    respond_to do |format|
      if @dream.save
        format.html { redirect_to @dream, notice: 'Dream was successfully created.' }
      else
        format.html { render action: "new" }
      end
    end
  end
end 
```

app/views/dream/new.html.erb 只是：

```
<%= render 'form' %> 
```

应用程序/视图/梦想/_form.html.erb：

```
<%= form_for(@dream) do |f| %>
  <% if @dream.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@dream.errors.count, "error") %> prohibited this dream from being saved:</h2>

      <ul>
      <% @dream.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :text %><br />
    <%= f.text_area :text %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

这是我的模型（在 2 个单独的文件中）：

```
class Dream < ActiveRecord::Base
  validates :text, :presence => true
  has_many :interpretations
end

class Interpretation < ActiveRecord::Base
  validates :text, :presence => true
  belongs_to :dream
end 
```

我已经用谷歌搜索了几个小时，但无法弄清楚。我会很感激任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-25T01:09:57.397

我发现了问题：我创建了我的 rails 项目，`rails new dream`并且也有一个模型“Dream”。Rails 关注的是应用程序类而不是模型类。当我创建模型并手动破解它时，我得到了一个关于 Dream 已经存在的错误（回想起来，这是一个可怕的想法）。这非常令人沮丧，但我学到了很多东西！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:12:58.913

尝试使控制器名称复数：

```
root :to => 'dreams#new' 
```

并且记得在更改路由配置文件时重启服务器。

# php - 是否有另一种方法可以通过 PHP 的 URL 传递值？

> ID：10219848
> 
> 赞同：0
> 
> 时间：2012-04-19T00:04:11.573
> 
> 标签：php, url

我正在开发一个带有用户帐户的网站。每个的 URL 大致如下：

```
www.site.com/profile.php?user=ChanceM 
```

但是，**我想知道是否有另一种方法可以通过 URL 发送值并使用 PHP 获取它们，**其 URL 更像这样：

```
www.site.com/ChanceM 
```

或者：

```
www.site.com/profile.php/ChanceM 
```

我只是想知道这是否可能，因为记住第一个 URL 对用户不是很友好。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:07:50.097

对于 Apache 是 - 您需要查看手册页以了解[重写](http://www.addedbytes.com/for-beginners/url-rewriting-for-beginners/)规则。该链接将告诉您如何执行此操作。还可以查看 Apache 文档。

至于其他服务器我不知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:07:39.177

当然有办法做到这一点，但可能不像 $_GET 数组那样直接内置到 php 中。您可以做的一件事是在 apache 配置中，用 php 脚本替换 404 页面，该脚本将 url 定位并重定向到 www.site.com/profile.php?user=ChanceM 之类的版本（我认为在 mod_rewrite 你也可以这样做）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T00:08:19.190

是的，您可以按照您说明的任何方式进行操作。

在第一个示例的情况下，您必须使用[mod_rewrite](http://httpd.apache.org/docs/current/rewrite/)之类的东西，它可以透明地将友好 URL (site.com/Username) 重写为 PHP 脚本 (site.com/profile.php?user=Username)

使用第二种方法，您必须使用`$_SERVER['REQUEST_URI']`从 URL 访问数据，并手动将其解析为可用变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T00:09:10.003

如果您想发送“更干净的 URL”（不进行某种类型的 URL 重写），您可以使用 implode 和 parse url 之类的东西：

```
http://us2.php.net/manual/en/function.parse-url.php
http://us2.php.net/manual/en/function.implode.php 
```

这些方法允许您提取 URL 的各个部分并使用它们

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-19T00:10:16.643

你想`mod_rewite`在 Apache 中使用。

这是重写规则的示例`RewriteRule ^(.*)$ profile.php?user=$1`

你可以在这里测试它：[http ://martinmelin.se/rewrite-rule-tester/](http://martinmelin.se/rewrite-rule-tester/)

# java - Android 计时器在取消时崩溃

> ID：10219849
> 
> 赞同：0
> 
> 时间：2012-04-19T00:04:16.060
> 
> 标签：java, android

我有一个正在运行的计时器，然后它会关闭并执行一些操作，并且计时器可以正常启动。

然后我想做的是单击一个按钮，然后让它创建一封电子邮件。一切正常，除了在计时器运行时单击按钮时，应用程序正在崩溃。当按下按钮时试图取消计时器时，这也会导致应用程序崩溃。

任何帮助，将不胜感激。

这是代码片段：

```
public class myApplication extends Activity {
    StringBuilder str;
    Timer t;
    Button mailbutton;

    public void onCreate(Bundle savedInstanceState) {

        final StringBuilder str = new StringBuilder(1000);
        super.onCreate(savedInstanceState);

        setContentView(R.layout.main);

        addListenerOnButton();

        TimerTask task = new TimerTask() {

            @Override
            public void run() 
            {
            /// do stuff here
            }
        }

        t = new Timer();
        t.schedule(task,2000,2000);

    } 

    public void addListenerOnButton() {

        mailbutton = (Button) findViewById(R.id.emailbutton);

        mailbutton.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View arg0) {

                t.cancel();

                Intent i = new Intent(Intent.ACTION_SEND);
                i.setType("text/plain");
                i.putExtra(Intent.EXTRA_EMAIL  , new String[]{"email@domain.com"});
                i.putExtra(Intent.EXTRA_SUBJECT, "subject");
                i.putExtra(Intent.EXTRA_TEXT   , str.toString());
                try {
                    startActivity(Intent.createChooser(i, "Send mail"));
                } catch (android.content.ActivityNotFoundException ex) {
                }
            }
        });
    }
} 
```

LogCat 输出：

```
04-19 09:13:11.143: W/dalvikvm(12613): threadid=1: thread exiting with uncaught exception (group=0x40c421f8)
04-19 09:13:11.148: E/AndroidRuntime(12613): FATAL EXCEPTION: main
04-19 09:13:11.148: E/AndroidRuntime(12613): java.lang.NullPointerException
04-19 09:13:11.148: E/AndroidRuntime(12613):    at uk.co.application.applicationActivity$2.onClick(applicationActivity.java:94)
04-19 09:13:11.148: E/AndroidRuntime(12613):    at android.view.View.performClick(View.java:3591)
04-19 09:13:11.148: E/AndroidRuntime(12613):    at android.view.View$PerformClick.run(View.java:14263)
04-19 09:13:11.148: E/AndroidRuntime(12613):    at android.os.Handler.handleCallback(Handler.java:605)
04-19 09:13:11.148: E/AndroidRuntime(12613):    at android.os.Handler.dispatchMessage(Handler.java:92)
04-19 09:13:11.148: E/AndroidRuntime(12613):    at android.os.Looper.loop(Looper.java:137)
04-19 09:13:11.148: E/AndroidRuntime(12613):    at android.app.ActivityThread.main(ActivityThread.java:4507)
04-19 09:13:11.148: E/AndroidRuntime(12613):    at java.lang.reflect.Method.invokeNative(Native Method)
04-19 09:13:11.148: E/AndroidRuntime(12613):    at java.lang.reflect.Method.invoke(Method.java:511)
04-19 09:13:11.148: E/AndroidRuntime(12613):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
04-19 09:13:11.148: E/AndroidRuntime(12613):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
04-19 09:13:11.148: E/AndroidRuntime(12613):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T02:14:47.010

这个计时器的具体用途是什么？我无法想象你会用它来做什么，它会不断重复每 2 秒运行一次。您可能会遇到的一件事是 Android 的线程问题。该计时器任务在与 Android UI 使用的主线程不同的线程上运行。如果您正在触摸 android 小部件或其他实例变量，那么您最终会遇到线程安全问题，如果您尝试这样做，Android 经常会抛出异常。因此，归结为您尝试使用该线程完成的工作，以及比创建这样的另一个线程更好的方法。通常我们会使用 Handler 在主线程上定期运行任务，而不是像这样使用 Timer，因为它引入了线程问题。

**更新：**

您刚刚确认了您刚才描述的一个严重的线程安全问题。我所说的线程安全的意思是你有可能让两个线程同时读/写同一个内存位置。这是一个大问题。事实上，您自己承认，您的 StringBuilder 实例在计时器线程和按钮回调之间共享，这意味着您肯定会在读取该 StringBuilder 时遇到线程安全问题。

这样做你会经常遇到不可预知的问题，并且你的代码在用户操作时永远不会稳定。首先，没有理由从另一个线程读取 GPS，因为 LocationManager 会在它更改时定期调用您。只需在调用时将其附加到 StringBuilder 或 ArrayList 即可。GPS 回调在主线程上运行，因此读取该变量的按钮逻辑不可能在修改该变量的同时发生。

您需要从代码中删除该计时器，并使用主线程来完成所有工作。或者您必须同步对数据结构的访问。Android 中发生的大多数回调都在主线程上运行。因此，如果您只是将记录历史值的逻辑移动到那里的数据结构中，而不是在您的计时器中，那么您会没事的。您可能必须将 GPS 与您尝试记录的任何其他内容分开记录，但您可以在按钮单击处理程序中将它们格式化为您的字符串。

Your NPE is on line 94 of your file. Without knowing line numbers to source code we can't help you. But these are the types of problems you'll encounter when you have Thread safety issues. And they'll drive you crazy so it makes sense to head my warning, and learn more about threading and controlling it safely.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T02:01:19.353

```
 mailbutton = (Button) findViewById(R.id.emailbutton);

        mailbutton.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View arg0) {

                t.cancel();

                Intent i = new Intent(Intent.ACTION_SEND);
                i.setType("text/plain");
                i.putExtra(Intent.EXTRA_EMAIL  , new String[]{"email@domain.com"});
                i.putExtra(Intent.EXTRA_SUBJECT, "subject");
                i.putExtra(Intent.EXTRA_TEXT   , str.toString());
                try {
                    startActivity(Intent.createChooser(i, "Send mail"));
                } catch (android.content.ActivityNotFoundException ex) {
                }
            }
        }); 
```

上面的行必须在 oncreate() 中，因为您在 oncreate 中设置了 view(R.layout.main) 并且您的函数 addListenerOnButton() 不知道主布局。

# testing - 网格点测试：处理有问题的案例？

> ID：10219852
> 
> 赞同：2
> 
> 时间：2012-04-19T00:04:33.280
> 
> 标签：testing, polygon, point

我需要检查一个点是否在由 tris 组成的任意凹面网格内。

我正在使用“向任意方向发射光线并检查三交叉点的数量......偶数表示点在外面，奇数表示在里面”方法来测试这一点。

如果光线总是击中 tri 的内部，则没有问题。但是，如果光线击中边缘或顶点，则可能会导致问题。

例如，假设 4 个 tris 都共享一个公共顶点。如果光线通过该顶点，所有 4 个 tris 都将报告命中。在这种情况下，即使起点在网格内，它也会报告 4 个交点并考虑网格外的点。当一条光线穿过一个由多个 tri 共享的边时，也会出现类似的问题。

有什么好的方法可以解决这个问题吗？我的第一个想法是简单地排除与其他已经测试过的 tris 共享顶点的 tris……但这只会产生更多问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-14T08:04:16.137

我想在这种情况下，您可以简单地在一个数组中收集所有命中点信息，然后遍历该数组以获得不同的点并且不计入重复点，然后检查减少的数组的偶数或奇数长度。

# mono - Phantom 构建系统可以在 Mono 下工作吗？

> ID：10219853
> 
> 赞同：0
> 
> 时间：2012-04-19T00:04:51.100
> 
> 标签：mono, boo, build-script, build-system

我正在研究 .Net 项目的跨平台构建系统。 [Phantom](https://github.com/JeremySkinner/Phantom)看起来很有趣，但是我想知道它是否可以在带有 Mono 的 Linux 上正常工作。它建立在 Boo 之上。似乎 Boo 在 Mono (http://www.mono-project.com/Boo) 中有一些支持，但我对此不太了解。

我可以在 Mono/Linux 设置上使用 Phantom 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T11:47:14.207

我刚刚测试过了。虽然它是一个很好的候选者，但它在（至少我的）Linux 机器上并不能 100% 开箱即用。我能够用 xbuild 编译它（你不能用库中的 phantom.exe 来编译它，因为它太旧了，无法从 Mono 的角度进行[重要的检查）。](https://github.com/JeremySkinner/Phantom/blob/master/src/Phantom.Core/Builtins/MSBuild.cs#L41)Phantom 的许多单元测试都通过了，但不是全部，并不能真正判断它们是否是核心功能。大小写也有一些问题，主要是 NuGet.exe，可以使用 MONO_IOMAP 解决这些问题。所以总的来说，如果你正在寻找经过测试并且已经可以工作的东西，我不会推荐它（但是！-从 github 可以看到至少尝试支持 Linux）。

我可以向您提出两种替代解决方案：

*   xbuild
*   [南安特](http://nant.sourceforge.net/)

xbuild 是 Mono 的 MSBuild 等价物。尽管并非 MSBuild 中存在的所有功能都已实现，但它在大多数情况下都运行良好。sln/proj 格式也用于 MonoDevelop 和 Visual Studio。它对于许多项目来说已经足够好了，例如这是[Mooege](https://github.com/mooege/mooege)项目使用的，也是我大部分时间都在使用的。

NAnt 是相当成熟、积极开发的构建系统，采用类似 Ant 的方法，因此当需要更复杂的构建时，它可能会适合您。

# ruby - 扩展 Octopress 以使用自动分部

> ID：10219855
> 
> 赞同：0
> 
> 时间：2012-04-19T00:04:58.057
> 
> 标签：ruby, jekyll, liquid

所以在 Octopress 中，我希望有一个充满部分的文件夹，我可以很容易地在网站上以不同的方式显示。我想要一个链接到包含所有部分的文档中的部分标题列表。

这是我想使用的逻辑，但我不知道如何在 Octopress 中实际实现它。

```
class Collection
  attr_accessor :directory, :files

  def new(dir)
    self.files = []
    self.directory = dir
    load_files
  end

  def list(options={})
    # Handle options here
    files
  end

private

  def load_files
    files_in(@directory).each do |file| # Psuedo-code
      f = Jekyll::FileObject.new(file.read) # Also fictional, but I imagine something similar exists
      f.text # Would return the actual content
      f.yaml # Would return a hash of options from the YAML front matter

      files << f
    end
  end
end 
```

然后我想加载部分集合：

```
api_methods = Collection.new("api_methods").list(:alphabetical => true, :method_type => "public") 
```

在液体中，列出目录：

```
<ul>
{% for partial in api_methods %}
  <li><a href="{% partial.yaml.url %}">{% partial.yaml.name %}</a></li>
{% endfor %}
</ul> 
```

在液体中，列出全文：

```
{% for partial in api_methods %}
  <h2>{% partial.yaml.name %}</h2>

  {% partial.text %}
{% endfor %} 
```

因此，这应该有望让您对我正在尝试做的事情有一个基本的了解，但我不知道如何实际实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T21:57:05.393

好的，这就是我完成我打算做的事情的方式。

首先，我必须认真阅读 Jekyll 的源代码。一旦我对它的工作原理有了基本的了解，我就可以进去修补某些东西。

基本上，Liquid 是一个非常简单的模板系统，您不能使用它转换任何数据。您必须以“有效负载”的形式将数据发送到 Liquid，这只是一个大哈希。因此，如果我想转换一些数据，我必须在将其发送到 Liquid 之前在 Ruby 中进行。

所以我做了一个东西叫`PayloadExtension`：

**插件/site.rb**

```
module Jekyll
  class Site
    alias :old_site_payload :site_payload

    def site_payload
      PayloadExtension.payload(old_site_payload)
    end
  end
end 
```

**插件/payload_extension.rb**

```
module Jekyll
  class PayloadExtension
    extend OctopressFilters

    def self.payload(payload)
      pages = payload['site']['pages']

      # Filter pages by Public API methods category and sort by title

      public_api_methods = category_filter(pages, "Public API methods")
      public_api_methods.sort! {|a, b| a.data['title'] <=> b.data['title'] }
      public_api_methods = pre_render(public_api_methods)

      payload['site']['public_api_methods'] = public_api_methods

      payload
    end

  private

    def self.category_filter(pages, category)
      pages.reject do |page|
        cat = page.data['category']

        !cat || cat.empty? || cat != category || ( cat.is_a?(Array) && !cat.include?(category) )
      end
    end

    def self.pre_render(pages)
      pages.collect do |page|
        content = pre_filter(page.content)
        page.data['rendered'] = Liquid::Template.parse(content).render
        page
      end
    end

  end
end 
```

不幸的是，我无法搞砸`Convertible#do_layout`，所以我在这个阶段可以访问的数据不是最终的东西，但这没关系，因为它很容易解决。

我还必须自己手动渲染页面的内容，因为只是 put`{{ page.content }}`会吐出尚未完全解析的文本。

现在在实际的 Liquid 模板中，我可以这样做：

```
{% for page in site.public_api_methods %}
  <h2>{{ page.title }} / {{ page.http_method | upcase }}</h2>
  {{ page.rendered }}
{% endfor %}

<h3>Public methods</h3>
<ul>
  {% for page in site.public_api_methods %}
    <li><a href="/api/public-methods/#{{ page.title | slugify }}-{{ page.http_method }}">{{ page.title }}</a></li>
  {% endfor %}
</ul> 
```

# java - Java“e”无法解析为 keyPressed 函数中的变量

> ID：10219857
> 
> 赞同：0
> 
> 时间：2012-04-19T00:04:59.197
> 
> 标签：java, function, keypress

我正在尝试编写一个 Java 应用程序来监听用户的键输入。这是我的代码...

```
import java.awt.event.KeyEvent;

public class DashExplorerMain {
    public static void main(String[] args) {
        DashExplorerMain dashExplorer = new DashExplorerMain();
        dashExplorer.keyPressed(e);
    }

    public void keyPressed(KeyEvent e) {
        int keyCode = e.getKeyCode();
        switch( keyCode ) { 
            case KeyEvent.VK_UP:
                // handle up 
                break;
            case KeyEvent.VK_DOWN:
                // handle down 
                break;
            case KeyEvent.VK_LEFT:
                // handle left
                break;
            case KeyEvent.VK_RIGHT :
                // handle right
                System.out.println("-");
                break;
            }
        } 
    }
} 
```

当我尝试编译我的代码时，我收到以下错误...

```
Exception in thread "main" java.lang.Error: Unresolved compilation problem: e cannot be resolved to a variable
    at DashExplorerMain.main(DashExplorerMain.java:11) 
```

你能帮我理解这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T00:14:18.907

您需要有一个 Key Listener 来实际侦听关键事件并调用适当的方法。通常，您会使用该方法将它附加到组件（例如 JTextField、JPanel 等）`addKeyListener()`。

```
DashExplorer.keyPressed(e); 
```

正在使用尚未声明的变量。

从 oracle 中查看有关实现键侦听器的[本教程。](http://docs.oracle.com/javase/tutorial/uiswing/events/keylistener.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T00:12:43.713

问题是这一行：

```
DashExplorer.keyPressed(e); 
```

尝试引用不在范围内/未声明的变量。

`main`我不明白您在该方法中要做什么。（它是一个测试工具吗？）

显而易见的“修复”将是用于`new KeyEvent(...)`在此时创建一​​个关键事件，但这需要您了解构造函数参数。除非这是一个测试工具，否则这样做没有多大意义。

# ios - 如何在 Windows 上获得真正的 iOS 浏览器模拟？

> ID：10219863
> 
> 赞同：1
> 
> 时间：2012-04-19T00:05:26.260
> 
> 标签：ios, flash, webkit, simulator

我正在寻找一种在 Windows 上运行真实 iOS 浏览器模拟环境的方法。

到目前为止，我看过的所有模拟器（在线模拟器和 Adob​​e Air）都模拟了 WebKit，但没有与 iOS 上的 MobileSafari 相同的限制，特别是无法播放 Flash。

例如，如果我在其中一个模拟器中将 YouTube 视频共享到 Facebook，它会将共享对象显示为 Flash 对象。在 MobileSafari 中，它使用 HTML5 视频。这就是我试图模拟的那种事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T00:51:12.273

抱歉，我无法提供链接，但我最近看到了一个视频，其中一位 Yahoo/Flicker 工程师发表了关于 HTML5 化他们的网站、针对移动设备进行优化的演讲。他说，为 iOS 测试网站的唯一真正方法是在 iP* 硬件上运行它。您不知道它将如何通过真实连接做出反应，并且网站可能会使浏览器崩溃（尤其是在内存不足错误的旧 iPhone 中。）

我在同一条船上:(我想我会先使用远程浏览器测试器，然后再获取硬件，或者至少偶尔借用朋友的。例如： http: [//www.compuware.com/application-performance -management/cross-browser-testing.html](http://www.compuware.com/application-performance-management/cross-browser-testing.html) http://www.addictivetips.com/mobile/adobe-shadow-remotely-browse-inspect-debug-websites-android-ios/ [http://www.mobilexweb.com/模拟器](http://www.mobilexweb.com/emulators)

我并不是说不要在虚假环境中进行测试。但我强烈建议使用真正的硬件进行最终测试。

# asp.net-mvc-3 - EF 代码优先：如何从 nuget 包控制台查看“EntityValidationErrors”属性？

> ID：10219864
> 
> 赞同：128
> 
> 时间：2012-04-19T00:05:37.167
> 
> 标签：asp.net-mvc-3, entity-framework, entity-framework-4, nuget

我为此不知所措：

我已经为实体框架（4.1.3）代码优先方法定义了我的类。一切都很好（我正在创建表格等），直到我开始播种。

现在当我做

```
Add-Migration "remigrate" ; Update-Database; 
```

我在包控制台上收到错误消息“一个或多个实体的验证失败。有关详细信息，请参阅 'EntityValidationErrors' 属性。”

我的 Seed() 方法中有一个断点，但是因为我在项目未运行时在控制台上运行它，所以我不知道如何获取详细信息（PS - 我已经看到线程[验证失败对于一个或多个实体，同时使用实体框架保存对 SQL Server 数据库的更改，](https://stackoverflow.com/questions/5400530/validation-failed-for-one-or-more-entities-while-saving-changes-to-sql-server-da)该框架显示了我如何查看该属性。）

我知道我的 Seed() 方法有问题，因为如果我在方法调用之后立即返回，错误就会消失。那么如何设置断点以便查看验证错误是什么？有点输了 还是有其他方法可以在 nuget 控制台中跟踪它？

* * *

## 回答 #1

> 赞同：218
> 
> 时间：2012-05-20T19:32:59.223

我最近也被这个惹恼了。我通过在 Seed 方法的 Configuration 类中放置一个包装函数来修复它，并将调用替换为`SaveChanges`对我的函数的调用。此函数将简单地枚举`EntityValidationErrors`集合中的错误，并在 Exception 消息列出各个问题时重新引发异常。这使得输出显示在 NuGet 包管理器控制台中。

代码如下：

```
/// <summary>
/// Wrapper for SaveChanges adding the Validation Messages to the generated exception
/// </summary>
/// <param name="context">The context.</param>
private void SaveChanges(DbContext context) {
    try {
        context.SaveChanges();
    } catch (DbEntityValidationException ex) {
        StringBuilder sb = new StringBuilder();

        foreach (var failure in ex.EntityValidationErrors) {
            sb.AppendFormat("{0} failed validation\n", failure.Entry.Entity.GetType());
            foreach (var error in failure.ValidationErrors) {
                sb.AppendFormat("- {0} : {1}", error.PropertyName, error.ErrorMessage);
                sb.AppendLine();
            }
        }

        throw new DbEntityValidationException(
            "Entity Validation Failed - errors follow:\n" + 
            sb.ToString(), ex
        ); // Add the original exception as the innerException
    }
} 
```

只需在您的种子方法中`context.SaveChanges()`替换对的调用即可。`SaveChanges(context)`

* * *

## 回答 #2

> 赞同：118
> 
> 时间：2013-03-31T06:18:55.080

**已经使用部分类定义扩展您的 DBContext 类！**

如果您查看 DbContext 的类定义，它将类似于以下内容：

```
// DatabaseContext.cs   -- This file is auto generated and thus shouldn't be changed. 
public partial class [DatabaseContextName] : DbContext { ... } 
```

因此，在另一个文件中，您可以创建相同的定义并覆盖您想要的部分。

```
// partialDatabaseContext.cs  -- you can safely make changes 
// that will not be overwritten in here.
public partial class [DatabaseContextName] : DbContext { // Override defaults here } 
```

部分类的整个想法*——你是否注意到**DbContext**是一个部分类——*是你可以扩展一个已经生成的类（或将类组织到多个文件中），在我们的例子中，我们还想**覆盖****SaveChanges**方法从添加到**DbContext**的部分类中。

通过这种方式，我们可以从所有现有的 DbContext/SaveChanges 调用中获取错误调试信息，而无需更改您的种子代码或开发代码。

这就是我要做的（**注意**区别在于我只是在我们自己编写的**DbContext**部分类中覆盖 SaveChanges 方法，而*不是生成*的方法）。此外，请确保您的部分类使用**正确的命名空间**，否则您将撞到墙上。

```
public partial class Database : DbContext
{
    public override int SaveChanges()
    {
        try
        {
            return base.SaveChanges();
        }
        catch (DbEntityValidationException ex)
        {
            var sb = new StringBuilder();

            foreach (var failure in ex.EntityValidationErrors)
            {
                sb.AppendFormat("{0} failed validation\n", failure.Entry.Entity.GetType());
                foreach (var error in failure.ValidationErrors)
                {
                    sb.AppendFormat("- {0} : {1}", error.PropertyName, error.ErrorMessage);
                    sb.AppendLine();
                }
            }

            throw new DbEntityValidationException(
                "Entity Validation Failed - errors follow:\n" +
                sb.ToString(), ex
                ); // Add the original exception as the innerException
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2013-03-12T21:46:02.530

我将理查兹的答案转换为扩展方法：

```
 public static int SaveChangesWithErrors(this DbContext context)
    {
        try
        {
            return context.SaveChanges();
        }
        catch (DbEntityValidationException ex)
        {
            StringBuilder sb = new StringBuilder();

            foreach (var failure in ex.EntityValidationErrors)
            {
                sb.AppendFormat("{0} failed validation\n", failure.Entry.Entity.GetType());
                foreach (var error in failure.ValidationErrors)
                {
                    sb.AppendFormat("- {0} : {1}", error.PropertyName, error.ErrorMessage);
                    sb.AppendLine();
                }
            }

            throw new DbEntityValidationException(
                "Entity Validation Failed - errors follow:\n" +
                sb.ToString(), ex
            ); // Add the original exception as the innerException
        }
    } 
```

像这样调用：

```
context.SaveChangesWithErrors(); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-26T16:52:39.523

我将 craigvl 的版本转换为 C# 我必须添加 context.SaveChanges(); 为了让它为我工作，如下所示。

```
try
{
    byte[] bytes = System.IO.File.ReadAllBytes(@"C:\Users\sheph_000\Desktop\Rawr.png");
    Console.WriteLine(bytes);

    context.BeverageTypes.AddOrUpdate(
        x => x.Name,
        new AATPos.DAL.Entities.BeverageType { ID = 1, Name = "Sodas" }
        );

    context.Beverages.AddOrUpdate(
        x => x.Name,
        new AATPos.DAL.Entities.Beverage { ID = 1, Name = "Coke", BeverageTypeID = 1, ImageData = bytes, IsStocked = true, StockLevel = 10, Price = 10.00M, ImageMimeType = "test" },
        new AATPos.DAL.Entities.Beverage { ID = 2, Name = "Fanta", BeverageTypeID = 1, ImageData = bytes, IsStocked = true, StockLevel = 10, Price = 10.00M, ImageMimeType = "test" },
        new AATPos.DAL.Entities.Beverage { ID = 3, Name = "Sprite", BeverageTypeID = 1, ImageData = bytes, IsStocked = true, StockLevel = 10, Price = 10.00M, ImageMimeType = "test" },
        new AATPos.DAL.Entities.Beverage { ID = 4, Name = "Cream Soda", BeverageTypeID = 1, ImageData = bytes, IsStocked = true, StockLevel = 10, Price = 10.00M, ImageMimeType = "test" },
        new AATPos.DAL.Entities.Beverage { ID = 5, Name = "Pepsi", BeverageTypeID = 1, ImageData = bytes, IsStocked = true, StockLevel = 10, Price = 10.00M, ImageMimeType = "test" }
        );

    context.SaveChanges();
}
catch (System.Data.Entity.Validation.DbEntityValidationException ex)
{
    var sb = new System.Text.StringBuilder();
    foreach (var failure in ex.EntityValidationErrors)
            {
                sb.AppendFormat("{0} failed validation", failure.Entry.Entity.GetType());
        foreach (var error in failure.ValidationErrors)
                {
            sb.AppendFormat("- {0} : {1}", error.PropertyName, error.ErrorMessage);
            sb.AppendLine();
                }
            }

    throw new Exception(sb.ToString());
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-26T00:56:30.943

理查德感谢您让我走上正确的道路（有同样的问题），下面是一个没有包装器的替代方案，这在迁移配置种子方法中对我有用：

```
 Protected Overrides Sub Seed(context As NotificationContext)

        Try
            context.System.AddOrUpdate(
               Function(c) c.SystemName,
                New E_NotificationSystem() With {.SystemName = "System1"},
                New E_NotificationSystem() With {.SystemName = "System2"},
                New E_NotificationSystem() With {.SystemName = "System3"})

            context.SaveChanges()

        Catch ex As DbEntityValidationException

            Dim sb As New StringBuilder

            For Each failure In ex.EntityValidationErrors

                sb.AppendFormat("{0} failed validation" & vbLf, failure.Entry.Entity.[GetType]())

                For Each [error] In failure.ValidationErrors
                    sb.AppendFormat("- {0} : {1}", [error].PropertyName, [error].ErrorMessage)
                    sb.AppendLine()
                Next
            Next

            Throw New Exception(sb.ToString())

        End Try
End Sub 
```

然后能够在包管理器控制台中看到异常。希望这可以帮助某人。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-09-28T17:35:03.677

```
I Also had same model validation problem but successfully catch by myself after lot of thinking;

I use reverse engineering method to catch the problem out of Over 80 + Model Classes;

1> Made copy of dbcontext, changing the name (I add "1" at end and make respective changes in class constructor and initialization etc.

Old:

>public class AppDb : IdentityDbContext<ApplicationUser>
>     
> {
> public AppDb(): base("DefaultConnection", throwIfV1Schema: false)
> {
> 
> }
>     
> public static AppDb Create()
>{
>return new AppDb();
>} 

**New:**

>public class AppDb1 : IdentityDbContext<ApplicationUser>
>{
>public AppDb1()
>: base("DefaultConnection", throwIfV1Schema: false)
>{
>}
> 
>public static AppDb1 Create()
> {
> return new AppDb1();
>  }`

...
2> Make changes to Codefirst Migration Configuration from Old DbContext to my new Context.

> internal sealed class Configuration :
> DbMigrationsConfiguration<DAL.AppDb1> { public Configuration() {
> AutomaticMigrationsEnabled = false; }    protected override void
> Seed(DAL.AppDb1 context) {`

3> Comment the Dbsets in new DbContext which was doubt.
4> Apply update migration if succeeded the probelm lye in Commented section.
5> if not then commented section is clear of bug clear.
6> repeat the (4) until found the right place of bug.
7> Happy Codding
```

# video - HTML5 视频标签 - 使用的最佳视频格式

> ID：10219866
> 
> 赞同：4
> 
> 时间：2012-04-19T00:05:49.240
> 
> 标签：video

为了在 HTML5 视频标签中使用，我最近从以下格式转换了一些视频：

```
Duration: 4:40
Video: H264 640x360 16:9 4982Kbps 23.98fps
Audio: AAC 44 KHz 255 Kbps Stereo 
```

到以下三种格式（以增加所有设备的兼容性）：

```
Type: MP4 (56,018 KB)
Video: H264 640x360 16:9 1481 Kbps 23.98 fps
Audio: AAC 44 KHz 152 Kbps Stereo

Type: OGG (58,025 KB)
Video: THEORA 640x360 16:9 1398 Kbps 23.98 fps
Audio: VORBIS 44 KHz 240 Kbps Stereo

Type: WEBM (57,471 KB)
Video: VP8 640x360 16:9 840 Kbps 23.98 fps
Audio: VORBIS 44 KHz 840 Kbps Stereo 
```

我遇到了很多问题，它需要很长时间来缓冲，即使它确实播放，它也会跳动或似乎跳帧。在移动设备上，它更加痛苦。

如果我做错了什么，那么了解最佳视频格式的人可以告诉我，如果是这样，我应该怎么做才能解决它？只是它们太大了吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T00:25:29.587

没有“最佳”视频格式，因为并非所有浏览器都兼容所有平台上的所有视频格式。

编辑 2013-12：似乎 MPEG-4/H.264 击败了竞争对手；唯一的主要障碍是 Firefox 在 OSX 和一些 Linux、Opera 和 Android 上[低于 v4.4 只有当你以某种方式格式化它时才能工作](http://www.broken-links.com/2010/07/30/encoding-video-for-android/) [http://caniuse.com/#feat=mpeg4](http://caniuse.com/#feat=mpeg4)

另外： [http](http://caniuse.com/#feat=ogv) ://caniuse.com/#feat=ogv | [http://caniuse.com/#feat=webm](http://caniuse.com/#feat=webm) | 我的另一篇文章有​​更好的后备

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T08:29:44.347

刚刚发现MP4 H264的默认创建方式是文件末尾的索引数据，所以基本上需要处理相当多的数据才能开始播放视频。Safari 似乎对此特别挑剔，而其他浏览器似乎对此没有任何问题。

我发现有人创建的 Adob​​e AIR 软件将索引数据移动到文件的开头，这样视频在 Safari 中的加载速度与在 Chrome 中一样快。

[http://renaun.com/blog/2010/06/qtindexswapper-2/](http://renaun.com/blog/2010/06/qtindexswapper-2/)

真希望我在几天前就发现了这个，花了这么多时间试图弄清楚为什么 Safari 遇到了这么多麻烦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-01T15:57:17.480

可能是在浏览器中呈现视频/音频的最佳方式，而不必担心兼容性： http: [//mediaelementjs.com/](http://mediaelementjs.com/)

# javascript - XMLHttpRequest 无法连接到 Google App Enging

> ID：10219867
> 
> 赞同：1
> 
> 时间：2012-04-19T00:05:58.493
> 
> 标签：javascript, google-app-engine, xmlhttprequest

客户端：Chrome 浏览器上的 javascript 服务器：Google App Enging，java servlet 我正在尝试从服务器端获取令牌，这是我的 js 代码：

```
var httpRequest;
if (window.XMLHttpRequest) {
  // Mozilla, Safari, Chrome,...
  httpRequest = new XMLHttpRequest();
} else if (window.ActiveXObject) {
  // ...
}
if (!httpRequest) {
  alert('Giving up :( Cannot create an XMLHTTP instance');
  return false;
}
httpRequest.open('POST', 'http://myapp.appspot.com/gettoken?userid=ethan', true); 
```

和我的 servlet 服务器代码：

```
protected void doPost(HttpServletRequest request, HttpServletResponse response)
  throws ServletException, IOException {
String userId = request.getParameter("userid");
if (userId != null && !"".equals(userId)) {
  String token = createChannel(userId);
  writeIntoChannel(response,token);
}
} 
```

与 GAE 的 CodeLabEx4 基本相同，只是我将它的 js 代码移动到客户端。它的原始代码是

```
httpRequest.open('POST', '/gettoken?userid=ethan', true); 
```

那行得通，但是在我添加完整的网址后怎么会不起作用？状态 = 0，而不是 200

```
httpRequest.open('POST', 'http://myapp.appspot.com/gettoken?userid=ethan', true); 
```

///////////////////////////////////////// /////////////////

经过一番研究，我已经更新为使用 ajax() 进行查询：

```
$.ajax({
    url : 'http://myapp.appspot.com/gettoken?userid=xxx',
                            type : "POST",
                            data:null,
                            success : function(data) {                                  
                                alert('ok!');
                            },
                            error: function(data) {
                                alert(data.statusText);
                            },
                            complete : function() { 
                                //alert("always"); 
                            },

                        }); 
```

但返回的 data.statusText 是“错误”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T04:01:51.487

如果您的页面托管在，那么由于[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)`localhost`，您的浏览器不会向应用引擎发送有效请求。它可能会发送一个请求，或者其他一些不会给你带来真正响应的废话。`OPT`

SOP 是问题的另一个线索是响应代码是`0`. （参见：[http](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes) ://en.wikipedia.org/wiki/List_of_HTTP_status_codes ）。`0`不是真正的 HTTP 响应代码。

在应用引擎上托管此页面或在浏览器中禁用 SOP。

# html - 灵活页面的定位菜单

> ID：10219868
> 
> 赞同：1
> 
> 时间：2012-04-19T00:06:02.237
> 
> 标签：html, css, menu, positioning, footer

我正在设计一个居中的页面，但我的菜单并不完全居中。它有点靠近右侧。我不明白为什么会这样。你能帮忙吗？

谢谢你的帮助。

CSS

```
body {

         margin-left: auto;
         margin-right: auto;
         text-align:center;
         background: #ffffff }

div.wrap {
         max-width:800px;
         min-width:400px;
         margin: 0px auto;
         border: 1px dashed red; }

div.inner-wrap {
         overflow: auto;        
         margin: 30px;
         border: 1px dashed #222; }
div.header {
        padding-top: 1pc;
        text-align:center;
        width:100%;
        color: #000000;}

     div.menu { 
        list-style:none; 
        margin:0; 
        padding:0; 
        width:100%;
        text-align:center;
        background:#FBB117;} 
     div.menu ul{ 
        margin-left: auto;
        margin-right: auto; 
        margin-top: 3px;
        margin-bottom: 3px;
        width: 100px 
        padding:0;
        display:inline-block;} 
     div.menu li{ 
        display:inline; } 
     div.menu li a{ 
        text-decoration:none; 
        padding:7px 0; 
        width:100px; 
        background:#FBB117; 
        color:#4C4646; 
        float:left; 
        text-align:center; }  
     div.menu li a:hover{ 
        background:#a2b3a1; 
        color:#000 } 

div.content {
         padding-top: 2pc;
         text-align:left;
         margin-left: 50px;
         margin-right: 50px;
         color: #000000 }

div.content p {
    color: #493831;
    padding-bottom: 30px;
    margin: 0;}

     div.sidebar {
         margin-right: 15%;
         padding-top: 2pc;
         text-align:center;
         float: right;
         width: 200px;
         color: #000000;
         list-style:none; }
     div.sidebar ul{
         margin-left: auto;
         margin-right: auto; 
         margin-top: 3px;
         margin-bottom: 3px;
         padding:0;
         list-style: none;
         display:inline-block;  }
     div.sidebar li{
         display:inline; }
     div.sidebar li a{ 
        text-decoration:none; 
        padding:10px 0; 
        width:100%; 
        background:#FBB117; 
        color:#4C4646; 
        float:right; 
        text-align:center; 
        border-bottom:1px solid #fff;}  
     div.sidebar li a:hover{ 
        background:#a2b3a1; 
        color:#000 } 
```

HTML代码在这里：

```
<body>
      <div class="wrap">
      <div class="inner wrap">
      <div class="header">
           <img src="realimg1.jpg" class="real" alt="king">
           <h1>xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</h1>
      </div>
      <div class="menu">
           <ul>

              <li><a href="link1.html">xx</a></li>
              <li><a href="link1.html">xxxx</a></li>
              <li><a href="link1.html">xxxxxxx</a></li>
              <li><a href="link1.html">xxxxxxxxx</a></li>
              <li><a href="link1.html">xx</a></li>
              <li><a href="link1.html">xxxxxx</a></li>

           </ul>
      </div>
      <div class="content">
          <p>
          <img src="img1.jpg" class="bw" alt="king">
          The CC is one of the oldest continually operating chess club in
          the Southern Hemisphere.We can proudly boast that we have been open daily since 1990 and we inted to
          maintain that tradition. On any night, you will find members of the club playing casual games or
          participating in one of our manly regulary scheduled tournaments. We are family club, and offer competition and
          instruction suitable for chess players of all skill levels and age groups.</p>
          <p>No other club in texas can boast a history so rich. Winning the club champion championships is your
          chance to get amongst these greats, and be immortalized foreve on the honow boards.</p>
          <p>Throughout the year,  Chess Club 'traditional time control' FIDE rated events form, whereby
          a player's scores from all 9 events will add up to form a grand prix score at the end of the year.The tournaments included are:
          Australia Day Weekender, Chess Club Championship,ANZAC Day Weekender, City Of Brisbane Open, Edwin Malitis Memorial, Chess Club Open , Chess Club Cup Weekender

      </div>
      <div class="sidebar">
           <ul>
           <li><a href="link1.html">xxx</a></li>
           <li><a href="link1.html">xxxxxxxxx</a></li>
           <li><a href="link1.html">xxxxxxx</a></li>
           <li><a href="link1.html">xxxxxx</a></li>
           <li><a href="link1.html">xxxxxxxxx</a></li>
           <li><a href="link1.html">xxxxxxxxxx</a></li>
           <li><a href="link1.html">xxxxxxxx</a></li>
           <li><a href="link1.html">xxxxx</a></li>
           <li><a href="link1.html">xxxx</a></li>
           <li><a href="link1.html">xxxxxxxxxxxx</a></li>
           <li><a href="link1.html">xxxxxxxx</a></li>
           </ul>
       </div>

      </div>
      </div>

   </body>​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T04:28:57.057

侧边栏边距 0 或 auto 并删除浮动，因为你想要这个中心

像这样

```
div.sidebar {

         padding-top: 2pc;
         text-align:center;

         width: 200px;
         color: #000000;
             list-style:none;
margin:0 auto;        
} 
```

现场演示[http://jsfiddle.net/rohitazad/wFQdj/](http://jsfiddle.net/rohitazad/wFQdj/)

# java - Java 中不受信任的 Groovy 脚本安全性

> ID：10219870
> 
> 赞同：15
> 
> 时间：2012-04-19T00:06:18.023
> 
> 标签：java, groovy

我们正在尝试在“企业”产品中提供可编写脚本的元素。我们想使用 groovy，但我们很难确保非常基本的东西。

例如，我们想阻止一个客户简单地去

```
Class.forName("my.company.internal.SecruityTools").runAsAwesome(...) 
```

我们已经安装了一个安全管理器，它的策略只允许`accesDeclaredMembers`并覆盖了该`checkPackageAccess`方法，并且只允许列入白名单的包。不幸的是，默认的类加载器链似乎只是绕过了这一点，并以任何方式加载类。

这似乎是一个相当普遍/讨论过的问题，但我一生都找不到一个库，甚至找不到一篇关于如何在更大的应用程序的上下文中锁定不受信任的脚本的好的博客文章。

有没有人成功地做到了这一点？我错过了一些相当明显的帖子/概念吗？是否已经有一个可靠的库来解决这个问题？也许`Groovy.tinFoilHatMode(true)`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-12T20:22:23.940

看看[Groovy 沙盒](http://groovy-sandbox.kohsuke.org/)。您可以使用它来停止诸如`System.exit(0)`或之类的事情`new File(“/etc/passwd”)`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-14T13:45:18.527

看看[java-sandbox](http://blog.datenwerke.net/p/the-java-sandbox.html)。还有一个如何使用 groovy 的教程：[http ://blog.datenwerke.net/2013/06/sandboxing-groovy-with-java-sandbox.html](http://blog.datenwerke.net/2013/06/sandboxing-groovy-with-java-sandbox.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-29T02:08:04.383

你看过使用[GroovyCodeSource](http://groovy.codehaus.org/api/groovy/lang/GroovyCodeSource.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-18T19:46:44.430

我们最终做的是上述事情的组合，但真正的魔力是实现[这个 AST 转换](https://gist.github.com/sskrla/757b2192dbbd0ae7bc5f)器，它将任何表达式（包括`this`，或隐式`this`）包装在访问检查中。

# regex - 在自动博客中使用正则表达式更改日期格式

> ID：10219877
> 
> 赞同：1
> 
> 时间：2012-04-19T00:07:14.010
> 
> 标签：regex, wordpress, autoblogged

我有一个提要，其日期的格式类似于“D, d MYG:i:s e”

Autoblogger 有一个 reg 表达式引擎。

将'D，d MYG：i：s e'转换为'F j，Y'的正则表达式是什么？

我想再次将“2012 年 4 月 20 日星期五 12:00:00 EST”转换为“2012 年 4 月 20 日”，其中日期存储在变量 %:pubDate% 中。我正在为 Wordpress 使用 Autoblogger。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-05T22:40:43.647

正则表达式不能*转换*字符串，但它可以找到并解析它们。
这个正则表达式会做你想做的事。

将其放在“搜索”字段中（假设日期的格式与*完全相同*`Fri, 20 Apr 2012 12:00:00 EST`）：

```
[a-zA-Z]{3}, ([0-9]{1,2}) ([a-zA-Z]{3}) ([0-9]{4}) [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,2} [a-zA-Z]{3} 
```

这在“替换为”字段中：

```
$2 $1, $3 
```

请参阅此演示：[http ://regex101.com/r/tP6hU7](http://regex101.com/r/tP6hU7)

然后你可以更换

*   `Jan(?:uary)?`与`January`,
*   `Feb(?:ruary)?`与`February`,
*   等等

输入：`Fri, 20 Apr 2012 12:00:00 EST`
输出：`April 20, 2012`

# android - eclipse android项目：添加菜单选项时R消失

> ID：10219883
> 
> 赞同：0
> 
> 时间：2012-04-19T00:07:35.307
> 
> 标签：android, android-layout, android-camera, android-menu

嗨，在我的 Eclipse android 项目中，每当我尝试添加一个名为 options.xml 的 xml 文件时，R 就会消失。这就是我所做的，在 res 文件夹下，我通过 eclipse 添加选项创建了一个菜单文件夹。我在那个名为 options.xml 的文件下创建了一个 xml 文件，它的内容是，

```
<menu xmlns:android="http://schemas.android.com/apk/res/android">

<item android:title="Take Picture" android:id="@+id/camera" android:icon="@drawable/ic_menu_camera" android:showAsAction="ifRoom"></item>
</menu> 
```

但是每当我尝试添加时，R.java 就会从自动生成中消失。我不明白这个。我关闭并重新打开了eclipse，尝试了新的项目但没有运气。

我的布局 main.xml，

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"

android:layout_width="fill_parent" android:layout_height="fill_parent"

android:orientation="horizontal">
<SurfaceView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/preview"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    />

</LinearLayout> 
```

如果我删除菜单文件夹 R 出现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:36:50.510

由于您正在为 API 10 编程，因此您无法使用`android:showAsAction`API 11 中引入的 . 抱歉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:15:50.920

如果您的资源文件中有错误，R.java 文件将会消失。可能是由于名称冲突、找不到资源或其他原因。

检查 Eclipse 中的“问题”视图，它会通知您问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T00:20:39.063

正如 VoidMain 已经说过的，您的 XML 有问题。XML看起来不错..所以问题只能由

```
android:icon="@drawable/ic_menu_camera" 
```

我想您想要来自android资源的默认相机图标，因此您必须将上面的行替换为

```
android:icon="@android:drawable/ic_menu_camera" 
```

# javascript - 仅使用 show("slow") 为附加文本设置动画

> ID：10219887
> 
> 赞同：1
> 
> 时间：2012-04-19T00:07:52.423
> 
> 标签：javascript, jquery, html, jquery-ui

在此代码中：[http://jsfiddle.net/GeAwB/](http://jsfiddle.net/GeAwB/)，例如，我想使用 jquery show("slow") 为最后附加的内容设置动画。

我把新内容放在一些 div new_div 中：

```
<div id="new_div" ></div> 
```

并将其添加到主 div“shanon”-div 中：

```
 <div id="shanon" style="height: 300px;"></div> 
```

问题是，整个主 div“shanon”-div 将被动画化，我只希望最后添加的行被动画化。

任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T00:19:46.890

试试这个...

[http://jsfiddle.net/GeAwB/6/](http://jsfiddle.net/GeAwB/6/)

你应该用一个元素包裹每一行，就像我的例子一样，我用一个包裹每一行 `div`

然后在你的 javascript.. 中找到最后一个 div 元素。然后动画它....

```
$("#shanon").append($("#new_div").html()).find("div").last().hide().show("slow"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T00:25:00.627

这是另一种不会影响行距的可能性：http: [//jsfiddle.net/GeAwB/18/](http://jsfiddle.net/GeAwB/18/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-19T00:42:21.177

每次单击按钮时，创建一个新的 div 而不是尝试重用`<div id="new_div"></div>`

代码将大大简化并且变得更容易遵循

```
$(document).ready(function() {
    var $new_div, $shanon = $("#shanon"),
        $weiter = $("#weiter"),
        $zeile = $(".zeile");
    $weiter.removeAttr("disabled").click(function() {
        if (i < array.length) {
            if (i > 0) {
                $zeile.removeClass("zeile");
            }
            $new_div = $("<div/>").html(array[i]).hide().appendTo($shanon).show("slow");
            i = i + 1;
        }
        else {
            $zeile.removeClass("zeile");
            $weiter.attr("disabled", "disabled");

        }
    });
}); 
```

查看[小提琴的更新](http://jsfiddle.net/GeAwB/19/)

*编辑：删除`zeile`类是不太正确的。`$('.zeile')`需要放回点击处理程序中。我不会费心进行更改，因为另一个答案已被接受，尽管效率低下。*

# php - 如何修复下面这个无效的正则表达式标志 w？

> ID：10219888
> 
> 赞同：-2
> 
> 时间：2012-04-19T00:07:55.510
> 
> 标签：php, javascript, jquery, ajax

我正在尝试从一个页面中的 php 脚本接收文件的名称，并将其附加到单独页面上的 javascript 函数中。问题是我在我的错误控制台中收到一个无效的正则表达式标志 w 错误，该错误声明未定义变量：'fileimagename for the line below:

```
 var nameimagefile = <?php echo $fileimagename; ?>; 
```

我该如何解决这个错误？

下面是javascript函数（QandATable.php）：

```
function stopImageUpload(success){

     var nameimagefile = <?php echo $fileimagename; ?>;
      var result = '';
      if (success == 1){
         result = '<span class="msg">The file was uploaded successfully!</span><br/><br/>';
         $('.listImage').append(nameimagefile + '<br/>');
      }
      else {
         result = '<span class="emsg">There was an error during file upload!</span><br/><br/>';
      }

return true;

} 
```

以下是位于文件名的单独页面（imageupload.php）上的php代码：

```
<?php

session_start();

if (isset($_POST['fileimagename'])) {

$_SESSION['fileimagename'] =  $_SESSION[' $_FILES['fileImage']['name']'];

}

if( file_exists("ImageFiles/".$_FILES['fileImage']['name'])) {
    $parts = explode(".",$_FILES['fileImage']['name']);
    $ext = array_pop($parts);
    $base = implode(".",$parts);
    $n = 2;

    while( file_exists("ImageFiles/".$base."_".$n.".".$ext)) $n++;
    $_FILES['fileImage']['name'] = $base."_".$n.".".$ext;

    move_uploaded_file($_FILES["fileImage"]["tmp_name"],
    "ImageFiles/" . $_FILES["fileImage"]["name"]);
    $result = 1;

}
    else
      {
      move_uploaded_file($_FILES["fileImage"]["tmp_name"],
      "ImageFiles/" . $_FILES["fileImage"]["name"]);
      $result = 1;

      }

?>

<script language="javascript" type="text/javascript">window.top.window.stopImageUpload(<?php echo $result;?>);</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T00:15:40.470

看起来错误是说`$fileimagename`未设置。

```
var nameimagefile = <?php echo $fileimagename; ?>; 
```

你需要定义`$fileimagename`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:16:20.123

在某处`QandATable.php`，您应该有一个`$fileimagename = $_SESSION['fileimagename']`, 或设置该 var 的东西。

# android - 无法实例化活动：ClassNotFound 异常

> ID：10219892
> 
> 赞同：1
> 
> 时间：2012-04-19T00:08:29.470
> 
> 标签：android, eclipse

由于这个错误，我突然无法运行我的应用程序，其中 ClassNotFound 指的是我的主要活动类。它发生在我的手机和模拟器中。这是一个已经存在了很长一段时间的现有稳定应用程序，自从几周前它上一次运行以来，我没有对代码进行任何更改。

我最近所做的唯一更改是我在同一个工作空间中启动了一个新项目，并将 Eclipse 组件更新为 SDK Tools V19 和 SDK Platform Tools V11，并按照指示更新了 Eclipse 插件。

对这里突然发生的事情有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T04:55:58.943

在项目中创建新文件夹“libs”并将所有外部Jar文件文件复制到该文件夹​​中。然后右键单击项目->属性->Java构建路径->在这里将Jar文件的路径更改为“Libs”文件夹并删除您从计算机路径中提供的外部 jar 文件的路径。之后它将起作用。

注意：如果您的项目中已经存在文件夹“lib”，则只需将文件夹名称“lib”更改为“libs”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:16:27.843

尝试清理项目：`Project->Clean`

# fbml - 回复：FBML 逐步淘汰

> ID：10219900
> 
> 赞同：0
> 
> 时间：2012-04-19T00:09:14.730
> 
> 标签：fbml, out, phase

我在 fbml 中有应用程序

刚收到一封电子邮件，说他们将在 6 月 1 日不再工作

我该怎么办？

他们说我必须在 html 中创建新的应用程序

当然还有另一种更简单的方法来转换应用程序

任何帮助/建议都是最好的方式来做到这一点

谢谢

托尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T03:27:40.780

自 2011 年 3 月以来一直无法创建 FBML 应用程序，并且完全删除已在 6 月 6 日的路线图上并在 2011 年[9 月](https://developers.facebook.com/blog/post/568/)被标记 没有“过渡”指南可以这么说，只需重新实现应用程序的内容iframe，如果您需要交互式内容，请遵循当前支持的 API 的文档

如果它只是您想在页面选项卡等上显示的静态内容，那么您可以使用以下一些 3rd 方应用程序，而不是重新实现您自己的应用程序：

*   WildFire iFrame 应用程序
*   静态 iFrame 选项卡
*   静态 HTML 加
*   参与人 iFrame 应用程序
*   制表机

# ruby - 机架刷新页面/清除缓存（全部在 config.ru 中）

> ID：10219901
> 
> 赞同：2
> 
> 时间：2012-04-19T00:09:17.363
> 
> 标签：ruby, caching, rack

如果您愿意，请更改标题...

我使用[toto](https://github.com/cloudhead/toto)作为我网站的博客引擎。所以它使用 Rack、Heroku 并且所有设置都可以很好地放在文件`config.ru`中，这就是我喜欢它的原因，因为它让一切对我来说都很简单。

我使用 Rack 插件：[mobile detect](https://github.com/talison/rack-mobile-detect)来检测移动设备，然后重定向到不同的站点。

这就是问题所在。我测试了重定向请求，部署后一段时间，重定向只有在我刷新页面后才有效，这意味着我在 iPhone 上输入我网站的 URL，第一次尝试会给我原始网站，而不是那个对于移动设备，在我点击刷新后它会被重定向。

我认为这是因为服务器上的缓存（因为即使我清除了手机上的所有缓存，它仍然会发生）。所以这引出了我的问题：什么 Rack 功能/插件可以让我自动清除服务器上的缓存，或者在检测到移动设备时强制浏览器刷新。

我已经用谷歌搜索了很多次这个解决方案，其中大部分是针对 Rails 应用程序的，这并不适合我。我怎样才能让它在所有工作中发挥作用`config.ru`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T08:34:25.780

可能没有那么简单。Toto 强制缓存其所有页面，而 Heroku 运行 Varnish。这意味着第一个请求不太可能会命中您的应用程序。

但是当您在浏览器上点击刷新时，请求可能包含`no-cache`或类似的内容，这会使 Varnish 访问您的应用程序，这会触发*移动检测*，然后返回重定向。

Toto 中设置缓存的代码在这里：
[https ://github.com/cloudhead/toto/blob/master/lib/toto.rb#L345](https://github.com/cloudhead/toto/blob/master/lib/toto.rb#L345)

您可以看到，如果您在开发模式下运行应用程序，则不会使用缓存。这应该是一个简单的测试，看看缓存是否确实是问题所在。

[https://devcenter.heroku.com/articles/config-vars#production_and_development_modes](https://devcenter.heroku.com/articles/config-vars#production_and_development_modes)

如果可行，那么您就有了一个简单的解决方案，尽管不是最有效的解决方案。

无论如何，我认为您不能缓存页面并同时提供动态重定向。因此，页面需要保持未缓存状态，移动检测才能正常工作。

# c - OPENCL 添加矩阵

> ID：10219902
> 
> 赞同：1
> 
> 时间：2012-04-19T00:09:34.243
> 
> 标签：c, opencl

我正在尝试添加 2 个矩阵，每个矩阵包含 100 个单元格。我需要在并行任务中完成它。没有数据并行。我得到以下代码，在同一个矩阵中添加、乘法、减法、除法，但是当我运行它时它只返回 0，或者有时返回 2、-0、-2 等...

我需要在 MAC 中使用 OpenCL 来做这件事有什么想法吗？

```
#include <stdio.h>
#include <stdlib.h>

#include <OpenCL/opencl.h>

#define MAX_SOURCE_SIZE (0x100000)

const char *_kernel = "\n" \
"__kernel void taskParallelAdd(__global float* A, __global float* B, __global float* C) \n" \
"{ \n" \
"    int base = 0; \n" \
"     \n" \
"    C[base+0]  = A[base+0]  + B[base+0]; \n" \
"    C[base+4]  = A[base+4]  + B[base+4]; \n" \
"    C[base+8]  = A[base+8]  + B[base+8]; \n" \
"    C[base+12] = A[base+12] + B[base+12]; \n" \
"} \n" \
" \n" \
"__kernel void taskParallelSub(__global float* A, __global float* B, __global float* C) \n" \
"{ \n" \
"    int base = 1; \n" \
"     \n" \
"    C[base+0]  = A[base+0]  - B[base+0]; \n" \
"    C[base+4]  = A[base+4]  - B[base+4]; \n" \
"    C[base+8]  = A[base+8]  - B[base+8]; \n" \
"    C[base+12] = A[base+12] - B[base+12]; \n" \
"} \n" \
" \n" \
"__kernel void taskParallelMul(__global float* A, __global float* B, __global float* C) \n" \
"{ \n" \
"    int base = 2; \n" \
"     \n" \
"    C[base+0]  = A[base+0]  * B[base+0]; \n" \
"    C[base+4]  = A[base+4]  * B[base+4]; \n" \
"    C[base+8]  = A[base+8]  * B[base+8]; \n" \
"    C[base+12] = A[base+12] * B[base+12]; \n" \
"} \n" \
" \n" \
"__kernel void taskParallelDiv(__global float* A, __global float* B, __global float* C) \n" \
"{ \n" \
"    int base = 3; \n" \
"     \n" \
"    C[base+0]  = A[base+0]  / B[base+0]; \n" \
"    C[base+4]  = A[base+4]  / B[base+4]; \n" \
"    C[base+8]  = A[base+8]  / B[base+8]; \n" \
"    C[base+12] = A[base+12] / B[base+12]; \n" \
"} \n" \
" \n";

int main()
{
    cl_platform_id platform_id = NULL;
    cl_device_id device_id = NULL;
    cl_context context = NULL;
    cl_command_queue command_queue = NULL;
    cl_mem Amobj = NULL;
    cl_mem Bmobj = NULL;
    cl_mem Cmobj = NULL;
    cl_program program = NULL;
    cl_kernel kernel[4] = {NULL, NULL, NULL, NULL};
    cl_uint ret_num_devices;
    cl_uint ret_num_platforms;
    cl_int ret;

    int i, j;
    float* A;
    float* B;
    float* C;

    A = (float*)malloc(4*4*sizeof(float));
    B = (float*)malloc(4*4*sizeof(float));
    C = (float*)malloc(4*4*sizeof(float));

    /* Initialize input data */
    for (i=0; i<4; i++) {
        for (j=0; j<4; j++) {
            A[i*4+j] = i*4+j+1;
            B[i*4+j] = j*4+i+1;
        }
    }

    /* Get platform/device information */
    ret = clGetPlatformIDs(1, &platform_id, &ret_num_platforms);
    ret = clGetDeviceIDs( platform_id, CL_DEVICE_TYPE_DEFAULT, 1, &device_id, &ret_num_devices);

    /* Create OpenCL Context */
    context = clCreateContext( NULL, 1, &device_id, NULL, NULL, &ret);

    /* Create command queue */
    command_queue = clCreateCommandQueue(context, device_id, CL_QUEUE_OUT_OF_ORDER_EXEC_MODE_ENABLE, &ret);

    /* Create buffer object */
    Amobj = clCreateBuffer(context, CL_MEM_READ_WRITE, 4*4*sizeof(float), NULL, &ret);
    Bmobj = clCreateBuffer(context, CL_MEM_READ_WRITE, 4*4*sizeof(float), NULL, &ret);
    Cmobj = clCreateBuffer(context, CL_MEM_READ_WRITE, 4*4*sizeof(float), NULL, &ret);

    /* Copy input data to memory buffer */
    ret = clEnqueueWriteBuffer(command_queue, Amobj, CL_TRUE, 0, 4*4*sizeof(float), A, 0, NULL, NULL);
    ret = clEnqueueWriteBuffer(command_queue, Bmobj, CL_TRUE, 0, 4*4*sizeof(float), B, 0, NULL, NULL);

    /* Create kernel from source */
    program = clCreateProgramWithSource(context, 1, (const char **)&_kernel, NULL, &ret);
    ret     = clBuildProgram(program, 1, &device_id, NULL, NULL, NULL);

    /* Create task parallel OpenCL kernel */
    kernel[0] = clCreateKernel(program, "taskParallelAdd", &ret);
    kernel[1] = clCreateKernel(program, "taskParallelSub", &ret);
    kernel[2] = clCreateKernel(program, "taskParallelMul", &ret);
    kernel[3] = clCreateKernel(program, "taskParallelDiv", &ret);

    /* Set OpenCL kernel arguments */
    for (i=0; i<4; i++) {
        ret = clSetKernelArg(kernel[i], 0, sizeof(cl_mem), (void *)&Amobj);
        ret = clSetKernelArg(kernel[i], 1, sizeof(cl_mem), (void *)&Bmobj);
        ret = clSetKernelArg(kernel[i], 2, sizeof(cl_mem), (void *)&Cmobj);
    }

    /* Execute OpenCL kernel as task parallel */
    for (i=0; i<4; i++) {
        ret = clEnqueueTask(command_queue, kernel[i], 0, NULL, NULL);
    }

    /* Copy result to host */
    ret = clEnqueueReadBuffer(command_queue, Cmobj, CL_TRUE, 0, 4*4*sizeof(float), C, 0, NULL, NULL);

    /* Display result */
    for (i=0; i<4; i++) {
        for (j=0; j<4; j++) {
            printf("%7.2f ", C[i*4+j]);
        }
        printf("\n");
    }

    /* Finalization */
    ret = clFlush(command_queue);
    ret = clFinish(command_queue);
    ret = clReleaseKernel(kernel[0]);
    ret = clReleaseKernel(kernel[1]);
    ret = clReleaseKernel(kernel[2]);
    ret = clReleaseKernel(kernel[3]);
    ret = clReleaseProgram(program);
    ret = clReleaseMemObject(Amobj);
    ret = clReleaseMemObject(Bmobj);
    ret = clReleaseMemObject(Cmobj);
    ret = clReleaseCommandQueue(command_queue);
    ret = clReleaseContext(context);

    free(A);
    free(B);
    free(C);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-20T05:09:44.320

command_queue 没有像`clCreateCommandQueue`返回一样被创建`-35: CL_INVALID_QUEUE_PROPERTIES`，因此基本上没有任何工作超出此范围（甚至没有内核可以运行）。您只是打印出`C`矩阵内存映射到的任何随机内存值（因为它未初始化）。您确实需要检查所有 API 调用的返回值是否存在错误，这会立即突出显示。

该错误与您对`CL_QUEUE_OUT_OF_ORDER_EXEC_MODE_ENABLE`标志的使用有关。这显然不受支持，并且无论如何它并没有真正做到你想要的。*该标志告诉 OpenCL 运行时，对于给定的 queue*，内核不需要按照它们入队的相同顺序执行。但是操作的本质仍然是具有数据并行性的顺序内核执行。这与同时运行内核不同，这是您想要的任务并行执行。

您需要做的是创建四个命令队列，每个内核一个。然后，您可以等待所有队列完成的事件。但是，如果您共享相同的输出矩阵，则需要小心，以确保您不会意外引入竞争条件。

任务并行模型在 OpenCL 1.2 参考手册的第 3.4.2 节中进行了描述。当像这样运行多个队列时，您可能希望使用事件来跟踪每个队列的执行和完成状态。有关详细信息，请参阅参考资料的第 5.9 节。

这是您的测试代码，更新了多个队列并并行运行任务。我快速验证了结果是否正确。

```
#include <stdio.h>
#include <stdlib.h>

#include <OpenCL/opencl.h>

#define MAX_SOURCE_SIZE (0x100000)

const char *_kernel = "\n" \
"__kernel void taskParallelAdd(__global float* A, __global float* B, __global float* C) \n" \
"{ \n" \
"    int base = 0; \n" \
"     \n" \
"    C[base+0]  = A[base+0]  + B[base+0]; \n" \
"    C[base+4]  = A[base+4]  + B[base+4]; \n" \
"    C[base+8]  = A[base+8]  + B[base+8]; \n" \
"    C[base+12] = A[base+12] + B[base+12]; \n" \
"} \n" \
" \n" \
"__kernel void taskParallelSub(__global float* A, __global float* B, __global float* C) \n" \
"{ \n" \
"    int base = 1; \n" \
"     \n" \
"    C[base+0]  = A[base+0]  - B[base+0]; \n" \
"    C[base+4]  = A[base+4]  - B[base+4]; \n" \
"    C[base+8]  = A[base+8]  - B[base+8]; \n" \
"    C[base+12] = A[base+12] - B[base+12]; \n" \
"} \n" \
" \n" \
"__kernel void taskParallelMul(__global float* A, __global float* B, __global float* C) \n" \
"{ \n" \
"    int base = 2; \n" \
"     \n" \
"    C[base+0]  = A[base+0]  * B[base+0]; \n" \
"    C[base+4]  = A[base+4]  * B[base+4]; \n" \
"    C[base+8]  = A[base+8]  * B[base+8]; \n" \
"    C[base+12] = A[base+12] * B[base+12]; \n" \
"} \n" \
" \n" \
"__kernel void taskParallelDiv(__global float* A, __global float* B, __global float* C) \n" \
"{ \n" \
"    int base = 3; \n" \
"     \n" \
"    C[base+0]  = A[base+0]  / B[base+0]; \n" \
"    C[base+4]  = A[base+4]  / B[base+4]; \n" \
"    C[base+8]  = A[base+8]  / B[base+8]; \n" \
"    C[base+12] = A[base+12] / B[base+12]; \n" \
"} \n" \
" \n";

int main()
{
    cl_platform_id platform_id = NULL;
    cl_device_id device_id = NULL;
    cl_context context = NULL;
    cl_command_queue command_queue[4] = {NULL, NULL, NULL, NULL};
    cl_mem Amobj = NULL;
    cl_mem Bmobj = NULL;
    cl_mem Cmobj = NULL;
    cl_program program = NULL;
    cl_kernel kernel[4] = {NULL, NULL, NULL, NULL};
    cl_uint ret_num_devices;
    cl_uint ret_num_platforms;
    cl_int ret;

    int i, j;
    float* A;
    float* B;
    float* C;

    A = (float*)malloc(4*4*sizeof(float));
    B = (float*)malloc(4*4*sizeof(float));
    C = (float*)malloc(4*4*sizeof(float));

    /* Initialize input data */
    for (i=0; i<4; i++) {
        for (j=0; j<4; j++) {
            A[i*4+j] = i*4+j+1;
            printf("A[%u] = %u\n", i*4+j, i*4+j+1);
            B[i*4+j] = j*4+i+1;
            printf("B[%u] = %u\n", i*4+j, j*4+i+1);
        }
    }

    /* Get platform/device information */
    ret = clGetPlatformIDs(1, &platform_id, &ret_num_platforms);
    ret = clGetDeviceIDs( platform_id, CL_DEVICE_TYPE_DEFAULT, 1, &device_id, &ret_num_devices);

    /* Create OpenCL Context */
    context = clCreateContext( NULL, 1, &device_id, NULL, NULL, &ret);

    /* Create buffer object */
    Amobj = clCreateBuffer(context, CL_MEM_READ_WRITE, 4*4*sizeof(float), NULL, &ret);
    Bmobj = clCreateBuffer(context, CL_MEM_READ_WRITE, 4*4*sizeof(float), NULL, &ret);
    Cmobj = clCreateBuffer(context, CL_MEM_READ_WRITE, 4*4*sizeof(float), NULL, &ret);

    /* Set up each queue */
    for (i = 0; i < 4; i++)
    {
        command_queue[i] = clCreateCommandQueue(context, device_id, 0, &ret);

        /* Copy input data to memory buffer */
        ret = clEnqueueWriteBuffer(command_queue[i], Amobj, CL_TRUE, 0, 4*4*sizeof(float), A, 0, NULL, NULL);
        ret = clEnqueueWriteBuffer(command_queue[i], Bmobj, CL_TRUE, 0, 4*4*sizeof(float), B, 0, NULL, NULL);
    }

    /* Create kernel from source */
    program = clCreateProgramWithSource(context, 1, (const char **)&_kernel, NULL, &ret);
    ret     = clBuildProgram(program, 1, &device_id, NULL, NULL, NULL);

    /* Create task parallel OpenCL kernel */
    kernel[0] = clCreateKernel(program, "taskParallelAdd", &ret);
    kernel[1] = clCreateKernel(program, "taskParallelSub", &ret);
    kernel[2] = clCreateKernel(program, "taskParallelMul", &ret);
    kernel[3] = clCreateKernel(program, "taskParallelDiv", &ret);

    /* Set OpenCL kernel arguments */
    for (i=0; i<4; i++) {
        ret = clSetKernelArg(kernel[i], 0, sizeof(cl_mem), (void *)&Amobj);
        ret = clSetKernelArg(kernel[i], 1, sizeof(cl_mem), (void *)&Bmobj);
        ret = clSetKernelArg(kernel[i], 2, sizeof(cl_mem), (void *)&Cmobj);
    }

    /* Execute OpenCL kernel as task parallel */
    for (i=0; i<4; i++) {
        ret = clEnqueueTask(command_queue[i], kernel[i], 0, NULL, NULL);
    }

    /* Wait for each queue to finish */
    for (i=0; i<4; i++) {
        printf("Waiting for %u to finish...\n", i);
        ret = clFinish(command_queue[i]);
    }

    ret = clEnqueueReadBuffer(command_queue[0], Cmobj, CL_TRUE, 0, 4*4*sizeof(float), C, 0, NULL, NULL);

    /* Display result */
    for (i=0; i<4; i++) {
        for (j=0; j<4; j++) {
            printf("%7.2f ", C[i*4+j]);
        }
        printf("\n");
    }

    /* Finalization */
    ret = clReleaseKernel(kernel[0]);
    ret = clReleaseKernel(kernel[1]);
    ret = clReleaseKernel(kernel[2]);
    ret = clReleaseKernel(kernel[3]);
    ret = clReleaseProgram(program);
    ret = clReleaseMemObject(Amobj);
    ret = clReleaseMemObject(Bmobj);
    ret = clReleaseMemObject(Cmobj);
    ret = clReleaseCommandQueue(command_queue[0]);
    ret = clReleaseCommandQueue(command_queue[1]);
    ret = clReleaseCommandQueue(command_queue[2]);
    ret = clReleaseCommandQueue(command_queue[3]);
    ret = clReleaseContext(context);

    free(A);
    free(B);
    free(C);

    return 0;
} 
```

# javascript - Django Forms - 构建一个表单，显示来自多个不同模型的字段，但按外键排序

> ID：10219903
> 
> 赞同：1
> 
> 时间：2012-04-19T00:09:34.477
> 
> 标签：javascript, python, django, django-forms, django-templates

我不知道如何解决这个问题 - 我已经尝试了很多东西，但结果是在提交表单后我收到“太多值无法解包”错误。

这是正在运行的模型的简单演示：

```
class Supplier(models.Model):
    name = models.CharField(max_length=100)

class SupplierLocation(models.Model):
    supplier = models.ForeignKey(Supplier)
    location = models.CharField(max_length=100)

class Product(models.Model):
    supplier = models.ForeignKey(Supplier)
    name = models.CharField(max_length=100)
    price = models.DecimalField(decimal_places=2,max_digits=10) 
```

我想要做的是生成一个有 2 多个单选按钮的表单。SupplierLocation.location 是标签，SupplierLocation.id 是单选按钮的值。同样，Product.name 将是标签，Product.id 将是单选按钮的值。这个想法是我想将它们分组到按 Supplier.id 排序的块中，以便 html 看起来像这样：

```
<div>
    <table>
        <tr class="{{ Supplier.name }} hidden">
            <td>{{ location.name }}</td>
            <td><input type="radio" name="location_id" value="{{ location.id }}" /></td>
        </tr>
    </table>
    <table>
        <tr class="{{ Supplier.name }} hidden">
            <td>{{ product.name }}</td>
            <td>{{ product.price }}</td>
            <td><input type="radio" name="product_id" value="{{ product.id }}" /></td>
        </tr>
    </table>
</div> 
```

显然，两个表中都会有多行，我很确定我应该能够使用小部件来代替硬编码的输入字段，但是我很困惑如何实现自定义表单。这个想法是，当页面加载时所有字段都被隐藏，当从页面上的链接中选择供应商时，这些字段在 JS 中可见。

我不确定表格应该是什么样子，以及我应该使用模型表格还是标准表格。在我当前的测试中，我有一个如下所示的表单：

表格.py

```
class ProductLocationForm(forms.Form):
    PRODUCT_CHOICES = [(p.id, p.name) for p in Product.objects.all()]
    LOCATION_CHOICES = [(l.id, l.name) for l in SupplierLocation.objects.all()]
    product = forms.ChoiceField(widget=forms.RadioSelect, choices=PRODUCT_CHOICES)
    location = forms.ChoiceField(widget=forms.RadioSelect, choices=LOCATION_CHOICES) 
```

这给了我产品和位置，但缺少供应商分组或任何隔离供应商的方式，因此我可以使用 JS 隐藏/显示它们。

任何帮助都是极好的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T04:57:23.797

您可以使用而不是手动`ModelChoiceField`构建。`choices`然后，您将拥有`queryset`该字段的属性，并且能够在模板中进行类似的操作：

```
{% regroup form.fields.product.queryset by supplier as grouped_products %}
{% for gp in grouped_products %}
    Supplier: {{ gp.grouper }} 
    {% for choice in gp.list %}
        <input type="radio" name="product" value="{{ choice.pk }}" /> {{ choice }}
    {% endfor %}
{% endfor %} 
```

# jquery - jQuery UI 父函数的位置 jQuery-object

> ID：10219904
> 
> 赞同：0
> 
> 时间：2012-04-19T00:09:34.647
> 
> 标签：jquery, jquery-ui, position, positioning, this

我有一个弹出窗口，我想在点击链接的位置显示 - 我希望重用相同的弹出窗口。因此，如果在弹出窗口已经显示时按下另一个链接，我希望它在更改位置并执行新的 slideDown 之前淡出。这意味着使用子函数 - 但位置函数似乎不接受引用的 Jquery 对象。没有错误，只是不显示 div。有什么建议么？？谢谢！

代码：

```
 $('.txtTd').click(function() {
            var selector=$(this);

            if ( $("#popupHelpTxt").is(':visible') ) {
                $("#popupHelpTxt").fadeOut(200, function() {
                    $("#popupHelpTxt").slideDown(200).position({
                        my:        "left top",
                        at:        "left bottom",
                        of:        selector, 
                        offset:     "0, 0",
                        collision: "fit"
                     });
                 });
            } else {
                $("#popupHelpTxt").slideDown(200).position({
                    my:        "left top",
                    at:        "left bottom",
                    of:        this,
                    offset:     "0, 0",
                    collision: "fit"
                });
            }
      }); 
```

如果我用位置参数中的其他东西替换“选择器”，它确实有效（带有错误定位的弹出窗口）。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T12:08:37.540

来自 jQuery UI 位置文档：

> 用于相对于窗口、文档、特定元素或光标/鼠标定位任何小部件的实用程序脚本。
> 
> **注意：jQuery UI 不支持定位隐藏元素。**
> 
> 不需要 ui.core.js 或 effects.core.js。

[http://jqueryui.com/demos/position/](http://jqueryui.com/demos/position/)

我的建议是坚持使用淡入淡出，并使用 手动编写淡入淡出函数`animate`，并且只调整`opacity`因子，而不是`display`

# opencv - 简单 cvLoadImage 上的 ctypes_opencv TypeError

> ID：10219905
> 
> 赞同：0
> 
> 时间：2012-04-19T00:09:39.397
> 
> 标签：opencv, python-3.x, ctypes

我有一个曾经可以工作的应用程序。我最近完全重新安装并试图让应用程序再次运行，但我遇到了标题中的问题。对于下一步调查或尝试使其正常工作的任何建议，我将不胜感激。

怎么了：

```
ctypes_opencv.cvLoadImage('tmp.bmp', 1) #or a fully specified path

Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "C:\python32_32bit\lib\site-packages\ctypes_opencv\highgui.py", line 289, in cvLoadImage
    z = pointee(_cvLoadImage(filename, iscolor))
ctypes.ArgumentError: argument 1: <class 'TypeError'>: wrong type 
```

我尝试直接使用 highgui.py 的 _cvLoadImage 并得到同样的错误。我认为它没有到达 pointee() 函数。

我找不到任何可以传递给函数以使其不给我 TypeError 的东西。希望我遗漏了一些明显的东西，但我没有更改以前工作的代码。

本系统的设置：

*   Windows 7的
*   python 3.2.3 32bit（之前的安装是3.1.x 32bit，但这次找不到安装程序）
*   opencv 1.0（我从来没有遇到过 ctypes_opencv 和 opencv > 1.0 的运气）
*   ctypes_opencv 0.8.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-20T06:24:45.680

啊。我想到了。ctypes_opencv 显然不接受 unicode 字符串。所以使用[字节文字](https://stackoverflow.com/questions/2592764/what-does-a-b-prefix-before-a-python-string-means)是有效的。

```
ctypes_opencv.cvLoadImage(b'tmp.bmp', 1) 
```

我并不担心尝试这样做，因为它曾经与我的 3.1.x 安装一起使用。从 3.x 开始，不是所有的字符串都已经是 unicode 了吗？我自己编写了代码，所以我确信自从我上次使用它以来它没有改变过。

# c++ - 为什么我的cmd消失了？我使用 cin.ignore() 但它没有效果！C++

> ID：10219909
> 
> 赞同：-1
> 
> 时间：2012-04-19T00:10:28.270
> 
> 标签：c++

**我正在测试我的轮盘赌类，但由于cin.ignore()**不起作用，Visual Studio 不让我看到输出，而且我不知道这里发生了什么，

你能解释为什么我的命令行窗口消失以及为什么这段代码中的**cin.ignore()**永远不会被调用吗？

太感谢了！

```
#include "Bet.h"
#include "Table.h"
#include <iostream>

using namespace std;
using namespace Roulette;

int main()
{
    cout << "Enter numbers for Split bet:" << endl;
    short answer;
    vector<short>* Selection = new vector<short>;
    for (short i = 0; i < 2; ++i)
    {
        cin >> answer;
        Selection->push_back(answer);
    }

    cout << "Enter how many chips and chip worth:" << endl;
    short chips, worth;
    cin >> chips >> worth;

    Bet* MyBet = new Bet(TableLayout::European, BetName::Split, chips, worth, Selection);

    Bet* Complex = new Bet(TableLayout::European, BetName::VoisinsDeZero, 1, 1);

    Complex->PrintProperties();

    cin.ignore(); // THIS IS IGNORED!!! WHY??? please...

    delete Selection;
    Selection = nullptr;
    delete Complex;
    delete MyBet;
    return 0;
} 
```

编辑：

我按 F5 运行程序，然后输入如下数字：

1 进入 2 进入 1 进入 1 进入

在这里 cmd 消失了，无论它不起作用，程序都会跳过 cin.get() （或 cin.ignore() ）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:25:23.100

> cin >> 芯片 >> 价值;

例如，在这一行上，如果您键入最后一个`1`并按回车，A`\n`仍留在流中未读。

当你这样做时`cin.ignore();`，它会提取剩余的字符并且程序完成。更改`cin.ignore();`为`cin.ignore(2);`它应该可以工作。

# database - MVC3 LINQ 数据库用户定义

> ID：10219913
> 
> 赞同：0
> 
> 时间：2012-04-19T00:11:04.873
> 
> 标签：database, asp.net-mvc-3, linq

如何区分使用 Visual Studio 为 MVC3 模板中的用户创建的内置数据库的用户？我正在为我的应用程序数据使用单独的数据库。

我已将代码添加到 Account Controller，以便在新用户注册的任何地方，用户的数据也都存储在 Users 表中。

这是我的数据库结构：

用户表
-UserID
-UserName
-JoinDate
-Password
-Email

电影表
-MovieID
-Title
-ReleaseYear
-Genre

评论表
-ReviewID
-MovieID
-UserID
-Rating
-Description

我需要一种方法来查找哪个用户正在添加基于 UserID 的评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T14:22:08.733

你不需要两个数据库，你所要做的就是在 MVC 创建的 aspnet.mdf 中创建你的表，或者在你的数据库上运行 asp.net 成员资格并将 MVC 指向你的数据库。

这样您就可以将它放在同一个数据库中，并且可以通过外键引用它。LINQ-SQL 应该很容易。

# java - 如何比较Javaflow中的两个延续？

> ID：10219914
> 
> 赞同：1
> 
> 时间：2012-04-19T00:11:09.237
> 
> 标签：java

我是javaflow的新手。考虑以下基本示例：

```
class MyRunnable implements Runnable {

     public void run() {

      System.out.println("started!");
      for( int i=0; i<10; i++ )
      echo(i);
      }

      private void echo(int x) {

      System.out.println(x);
      Continuation.suspend();
     }

    }

    Continuation c = Continuation.startWith(new MyRunnable()); 
    Continuation d = Continuation.continueWith(c);
    Continuation e = Continuation.continueWith(d);
    Continuation f = Continuation.continueWith(d);

    if (e.equals(f)) System.out.println("They are equal!");
    else System.out.println("They are not equal!"); 
```

延续 e 和 f 都从相同的检查点 (d) 开始并捕获相同的堆栈，并且它们都打印 1。那么为什么“它们不相等！”？（程序给出这个输出）。有人可以向我解释一下吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T00:27:03.923

JavaFlow 中的延续实现了默认`.equals()`语义。也就是说，它们不会重载类的`.equals()`方法`Object`。

[您可以在SVN 存储库](http://svn.apache.org/viewvc/commons/sandbox/javaflow/trunk/src/main/java/org/apache/commons/javaflow/Continuation.java?revision=958247&view=markup)中的实现中亲自看到它。

这就是说，即使你将Continuations设置为对应相同的堆栈状态，按照它们的`.equals()`工作方式，它也会返回false。

# java - 使用 Robolectric + Roboguice 时将日志输出写入哪里？

> ID：10219915
> 
> 赞同：49
> 
> 时间：2012-04-19T00:11:15.180
> 
> 标签：java, android, maven-2, roboguice, robolectric

我正在使用 Robolectric 来测试 Android。我正在通过 Maven 运行我的测试，例如

```
mvn -Dtest=LogTest test 
```

如果我有写入日志的代码，例如

```
Log.d("TAG", "blah"); 
```

或使用 Roboguice 的`Ln`

```
Ln.d("blah"); 
```

我在 Maven 的安全日志（文本文件）中看不到任何输出。

理想情况下，我实际上想要简单的日志语句进入控制台。我可以使用 写入控制台`System.out.println("blah")`，但当然我更愿意使用受支持的日志记录 API。

所以我的问题是，为什么我根本看不到日志输出，我怎样才能将日志消息写入控制台？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2013-05-04T16:09:09.123

我正在运行**robolectric-2.0-alpha-3**。

对我有用的是在我的**测试**的 setUp 方法中将流设置为`stdout`

就像是：

```
@Before
public void setUp() throws Exception {
  ShadowLog.stream = System.out;
  //you other setup here
} 
```

`ShadowLog.stream = System.out`使用这个版本的 robolectric，我在自定义 TestRunner 或我的 TestLifeycleApplication 中没有成功地做同样的事情（ ）。

设置系统属性`System.setProperty("robolectric.logging","stdout");`也没有效果，但它可能在以前的版本中有效。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-10-10T13:20:36.393

我正在使用 robolectric 2.3。如何为我工作：

进入我的@Before：

```
ShadowLog.stream = System.out; 
```

在我可以使用的测试函数中（ShadowLog。还有其他选项）：

```
ShadowLog.v("tag", "message"); 
```

在我测试过的课程中，我可以在日志中添加一些消息：

```
System.out.println("message"); 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-04-20T09:08:23.177

默认情况下，使用[RobolectricTestRunner](https://github.com/pivotal/robolectric/blob/master/src/main/java/org/robolectric/RobolectricTestRunner.java)时的日志输出会消失。您可以通过查看该类的[setupLogging()](https://github.com/pivotal/robolectric/blob/master/src/main/java/org/robolectric/RobolectricTestRunner.java#L695)方法来配置它的去向。

总而言之，您需要将`robolectric.logging`系统属性设置为`stdout`、`stderr`或应写入日志的文件路径。我在`RobolectricTestRunner`用于所有测试的子类的构造函数中执行此操作，以便始终将日志写入标准输出。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-04-12T05:40:14.700

在测试运行之前将以下内容添加到测试设置中：

```
ShadowLog.stream = System.out;
Robolectric.bindShadowClass(ShadowLog.class); 
```

[https://groups.google.com/forum/?fromgroups=#!msg/robolectric/PK-9cQQQROw/svuQzM5h_vsJ](https://groups.google.com/forum/?fromgroups=#!msg/robolectric/PK-9cQQQROw/svuQzM5h_vsJ)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-12-11T00:18:56.883

使用 maven 运行测试时，您需要的只是这样的：

```
 <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-surefire-plugin</artifactId>
                    <version>2.17</version>
                    <configuration>
                        <systemPropertyVariables>
                          <robolectric.logging>stdout</robolectric.logging>
                        </systemPropertyVariables>
                    </configuration>
                 </plugin> 
```

当在本地运行测试时，例如在 intellij 中，那么您只需要一个环境变量：只需（对于 intellij）运行/调试配置 --> 默认值 --> Junit --> VM 选项并添加

```
-Drobolectric.logging=stdout 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-21T19:35:44.137

对我（或根本）最有效的解决方案是初始化 RoboGuice 的 Ln.Print 类的替换注入实现（仅在测试期间）以进行 System.out 打印而不是 Android 的日志打印，因为我实际上使用 Robolectric避免首先依赖 Android 子系统来运行我的测试。

从[Ln.java](http://code.google.com/p/roboguice/source/browse/roboguice/src/main/java/roboguice/util/Ln.java?r=a4ed698b0c851772e7c148deccced53c24c6ec40#68)：

```
public class Ln  {
...

/**
 * print is initially set to Print(), then replaced by guice during
 * static injection pass.  This allows overriding where the log message is delivered to.
 */
@Inject protected static Print print = new Print(); 
```

所以基本上：

```
public class TestModule extends AbstractModule {

    @Override
    protected void configure() {
        bind(Ln.Print.class).to(TestLogPrint.class);
    }

} 
```

和：

```
public class TestLogPrint extends Print {

    public int println(int priority, String msg ) {

        System.out.println(
            String.format(
                "%s%s", 
                getScope(4), 
                msg
            )
        );

        return 0;
    }

    protected static String getScope(int skipDepth) {
        final StackTraceElement trace = Thread.currentThread().getStackTrace()[skipDepth];
        return String.format("%s | %s.%s | ", new Date(), trace.getFileName().replace(".java", ""), trace.getMethodName());
    }
} 
```

当然，假设标准 Robolectric init 将模块与 RoboGuice 挂钩：

```
@Before
public void setUp() throws Exception {

    Module roboGuiceModule = RoboGuice.newDefaultRoboModule(Robolectric.application);
    Module productionModule = Modules.override(roboGuiceModule).with(new CustomRoboModule());
    Module testModule = Modules.override(productionModule).with(new TestModule());

    RoboGuice.setBaseApplicationInjector(Robolectric.application, RoboGuice.DEFAULT_STAGE, testModule);
    RoboGuice.injectMembers(Robolectric.application, this);

} 
```

# asp.net - 缺少 asp.net ScriptManager 和 UpdatePanel 控件

> ID：10219916
> 
> 赞同：1
> 
> 时间：2012-04-19T00:11:26.823
> 
> 标签：asp.net

我创建了一个新的 ASP.NET Web 应用程序，但是缺少 ScriptManager 和 UpdatePanel 的控件。经过一番谷歌搜索并弄乱了 web.config，我无法正确安装它们。

我有另一个项目在其中安装并运行它们，并且我已经从 web.config 复制了所有代码，但仍然没有运气。

也许 Visual Studio 有一个自动安装它的工具？！还是那是一厢情愿？！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-21T12:35:42.477

我通过将以下内容添加到我的 web.config 文件中解决了这个问题......

```
 <system.web>    
    <pages>
      <controls>
        <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
      </controls>
    </pages>
  </system.web> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:36:27.907

我认为与其从另一个项目复制，不如从头开始，它可能会节省时间:)

这是一篇让您入门的文章：[http ://www.asp.net/web-forms/tutorials/aspnet-ajax/understanding-partial-page-updates-with-asp-net-ajax](http://www.asp.net/web-forms/tutorials/aspnet-ajax/understanding-partial-page-updates-with-asp-net-ajax)

# r - geom_map 所有子区域的颜色相同

> ID：10219919
> 
> 赞同：3
> 
> 时间：2012-04-19T00:11:49.440
> 
> 标签：r, ggplot2, choropleth

由于 ggplot2 具有 geom_map，我正在尝试从旧的映射数据方式转移到等值线。示例见第 10-11 页（[此处](http://cloud.github.com/downloads/hadley/ggplot2/guide-col.pdf)）。

我正在尝试使用我过去创建的 choropleth 的数据集来执行此操作，而不是使用 ggplot 的新 geom_map。这是我的尝试，我认为它就像哈德利的例子，但一切都是相同的颜色。

数据集和代码：

```
#loads 2 data frames: ny and cad from my drop box
load(url("http://dl.dropbox.com/u/61803503/MAPPING.RData"))
library(ggplot2)

ggplot(cad, aes(map_id = subregion)) +
    geom_map(aes(fill = Math_Pass_Rate), map = ny) +
    expand_limits(x = ny$long, y = ny$lat) +
    guides(fill = guide_colorbar(colours = topo.colors(10))) +
    opts(legend.position = "top") 
```

为什么它显示为相同的颜色？

* * *

来自@PaulHiemstra 的附加信息

我对此有点困惑，并没有得到好的结果。但是，我也想知道为什么您链接到的 ggplot2 pdf 中的示例有效。

此代码生成正确的等值线图。

```
crimes <- data.frame(state = tolower(rownames(USArrests)), USArrests)
states_map <- map_data("state")
ggplot(crimes, aes(map_id = state)) +
   geom_map(aes(fill = Murder), map = states_map) +
   expand_limits(x = states_map$long, y = states_map$lat) +
   guides(fill = guide_colorbar(colours = topo.colors(10))) +
   opts(legend.position = "top") 
```

人们会期望通过使用，在（多边形）中的列和( ) 中的`map_id = state`列之间建立了链接。包含一列：`states_map``crimes``Murder``crimes``state`

```
> head(crimes)
                state Murder Assault UrbanPop Rape
Alabama       alabama   13.2     236       58 21.2
Alaska         alaska   10.0     263       48 44.5
Arizona       arizona    8.1     294       80 31.0
Arkansas     arkansas    8.8     190       50 19.5
California california    9.0     276       91 40.6
Colorado     colorado    7.9     204       78 38.7 
```

但`states_map`没有：

```
> head(states_map)
       long      lat group order  region subregion
1 -87.46201 30.38968     1     1 alabama      <NA>
2 -87.48493 30.37249     1     2 alabama      <NA>
3 -87.52503 30.37249     1     3 alabama      <NA>
4 -87.53076 30.33239     1     4 alabama      <NA>
5 -87.57087 30.32665     1     5 alabama      <NA>
6 -87.58806 30.32665     1     6 alabama      <NA> 
```

所以在多边形和数据之间的链接中，一些黑魔法似乎正在发生。这也可以解释@TylerRinker 的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T08:09:29.300

这是记录在案的`geom_map`. `geom_map`总是从. `region`_ 这由以下证实。跑步：`id``states_map`

```
ny$region = ny$subregion 
```

将`subregion`名称放入`region`列中。现在绘图导致正确的图像：

![在此处输入图像描述](../Images/5f4a45ae0c1a8295ee57300e550a5704.png)

因此，`geom_map`使用`region`or `id`。

# c++ - 在 C 或 C++ 中为多个输入执行 while 循环

> ID：10219920
> 
> 赞同：1
> 
> 时间：2012-04-19T00:11:51.700
> 
> 标签：c++

以下是我正在工作的代码片段，虽然我的输入需要 4 个值，但在用户输入正确的值之前，它应该不断询问，任何输入都相同提前谢谢

```
#include<stdio.h>
#include<math.h>

int
main(int argc, char *argv[])
{
        int days;
        float peny;

        do{
                printf("Enter Number of days: ");
                scanf("%d", &days);
        }
        while ((days != 28) || (days != 29) ||(days != 30) ||(days != 31));
        printf("Number of days are %d", days);

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T00:15:37.427

想想你的循环条件在说什么。它将继续循环，而这些单独的条件中的任何一个仍然为真，或者换句话说，循环*直到*所有这些条件同时为假。那可能吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T00:19:18.280

而((天<28)||(天>31)); // IE。而天数是非法的，因为太低或太高

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T00:33:16.597

条件

```
(((days != 28) || (days != 29) ||(days != 30) ||(days != 31))) 
```

在您的`do-while`循环中将始终为真，因为天数的值不能同时为 28、29、30、31。or 运算符可以更改为 and：

```
while ((days != 28) && (days != 29) && (days != 30) && (days != 31)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-19T00:15:37.303

始终从`scanf()`;测试返回状态 如果它没有告诉你 1，它就失败了，可能是因为用户键入`a`而不是`31`.

考虑计算连续失败的次数（如果计数过高则退出），这样用户就不会感到沮丧。

考虑使用`fgets()`读取输入并`sscanf()`解析它；它通常更容易管理。

考虑将 C++ 用于 C++，将 C 用于 C；您展示的是 C 程序而不是 C++ 程序（尽管它确实可以用 C++ 编译，除非我的眼睛在欺骗我）。一般来说，语言是非常不同的。

在 final 末尾添加一个换行符`printf()`。

# java - SWT ToolBar：如何删除第一个 ToolItem 上的蓝色突出显示？

> ID：10219921
> 
> 赞同：2
> 
> 时间：2012-04-19T00:12:02.043
> 
> 标签：java, swt, toolbar

我创建了一个 ToolBar，其中填充了包含图像的 ToolItems，并且第一个启用的图像得到一个蓝色光环。我怎么能删除它？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T10:05:09.577

您可以将焦点设置到不同的控件，也可以尝试使用该`SWT.NO_FOCUS`样式创建 ToolBar。

# javascript - AJAX - 在 DIV 中保留可链接的内容

> ID：10219922
> 
> 赞同：0
> 
> 时间：2012-04-19T00:12:09.957
> 
> 标签：javascript, asp.net, html, ajax, flash

我目前负责维护我公司的内部知识库。该站点使用 Flash 导航和 ASP 将内容拉入页面中间的 div 中。我正在重新设计网站并取消使用 Flash 和 ASP，原因有很多，其中一个是我们需要此资源可脱机使用。所以我创建了静态导航，并使用 AJAX 将内容强制放入 DIV。我意识到这不是最佳实践，但我们需要在每个页面上进行某种导航，并且修改数百甚至数千个单独的页面不是一种选择。到目前为止，我所做的每一件事都做得很好！

问题来了，

在 DIV 中打开的页面本身就有大量链接。这些链接正在新页面中打开，而这不会。每个其他页面都必须在该 DIV 内打开。我什至不知道这是否可能，但即使这不是最佳实践，我也很想得到答案。

提前感谢您的回复，

马蒂

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:17:19.497

在不付出很多努力的情况下做到这一点的唯一方法是在 iframe 中打开该页面。您将添加 iframe 并完成。话虽如此，我必须告诉您，这被认为是一种不好的做法。

您的另一个选择是对所有这些页面进行更改，以便它们所引用的链接被加载到该 div 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:16:56.443

利用

```
<base target="name-of-the-div-where-you-want-the-link-to=open"> 
```

在头部，你应该很高兴

# spring - 为什么我的 Spring @autowired DAO 没有自动装配？

> ID：10219923
> 
> 赞同：2
> 
> 时间：2012-04-19T00:12:27.383
> 
> 标签：spring, autowired

我第一次尝试@autowired，但失败了。我已经阅读了很多示例，而且我似乎做的一切都是正确的，但是当我的代码命中我的 getLeagueDAO() 方法时，实例变量被设置为 null。

我有以下代码：

```
package com.example.app.service;

@Service
public class LeagueService {

    // also tried @Autowired here, and that didn't work
    private LeagueDAO leagueDao; // = new LeagueHibernateDAO();

    public LeagueDAO getLeagueDAO() {
        return this.leagueDao;
    }

    @Autowired
    public void setLeagueDAO( LeagueDAO dao ) {
        this.leagueDao = dao;
    }

    [ ... ] 
```

联盟HibernateDAO：

```
package com.example.app.dao.impl.hibernate;

import ...

public class LeagueHibernateDAO implements LeagueDAO {

    public LeagueHibernateDAO() {
        super();
    }

    [ ... ] 
```

我的 *-servlet.xml 文件：

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:p="http://www.springframework.org/schema/p" 
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xsi:schemaLocation="
        http://www.springframework.org/schema/mvc
        http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd

        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd

        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context-3.0.xsd
">

    <context:annotation-config/>

    <context:component-scan base-package="com.example"/>

    <mvc:annotation-driven />

    <bean id="LeagueDAO" class="com.example.app.dao.impl.hibernate.LeagueHibernateDAO" />

    <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/>
        <property name="prefix" value="/jsp/"/>
        <property name="suffix" value=".jsp"/>
    </bean>
</beans> 
```

我的 Spring 依赖项是：

```
 ... <org.springframework.version>3.0.6.RELEASE</org.springframework.version> ...

    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-core</artifactId>
        <version>${org.springframework.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-web</artifactId>
        <version>${org.springframework.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>${org.springframework.version}</version>
    </dependency> 
```

我的单元测试没有运行。我的应用程序没有运行。都是因为 LeagueDao 没有在 LeagueService 中设置。为什么不接线？

**我的完整解决方案**

为了任何遇到类似问题的人的利益...

1) 很明显，我不知道如何编写自动装配代码的测试。接受的答案提供了如何执行此操作的工作示例。

2) 似乎通过自动装配，它基本上是全有或全无。我已经创建了一个应用程序并想返回并自动装配它。所以我想我会从小处着手，将 LeagueDAO 自动连接到 LeagueService。然而，因为 LeagueServiceTest 没有自动连接 LeagueService，它不会连接到 LeagueDAO 的引用。一旦我正确地自动连接了链中的每个步骤，一切都正常了。

因此，当我尝试运行我的应用程序时，即使我的测试现在可以正常工作，我的应用程序再次没有自动装配。为了解决问题，我终于意识到我必须完全自动连接另一条链。在这种情况下，我已经将 LeagueDAO 插入到 LeagueService。问题是 LeagueService 是由控制器调用的，控制器只是通过调用构造函数来实例化 LeagueService 类。当我将 LeagueService 自动连接到控制器中时，一切都开始工作了。

我已经阅读了很多关于此的内容，如果在任何地方都对此进行了解释，那么它并没有以我清楚的方式进行解释。啊。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T04:05:10.253

以下作品

**单元测试**

```
package com.example.app.service;

import static org.junit.Assert.*;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.*;

    @RunWith(SpringJUnit4ClassRunner.class)
    @ContextConfiguration(locations={"/springcontext.xml"})
    public class TestLeagueService {

        @Autowired
        LeagueService service;

        @Test
        public void test() {
            assertNotNull(service.getLeagueDAO()); 
        }

    } 
```

**道**

```
package com.example.app.dao.impl.hibernate;

public interface LeagueDAO {

} 
```

**道实现**

```
package com.example.app.dao.impl.hibernate;

public class LeagueHibernateDAO implements LeagueDAO {

    public LeagueHibernateDAO() {
        super();
    }
} 
```

**弹簧上下文**

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
        xmlns:context="http://www.springframework.org/schema/context"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"       
       xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/context
         http://www.springframework.org/schema/context/spring-context-3.0.xsd">

     <context:annotation-config/>

    <context:component-scan base-package="com.example"/>

    <bean id="LeagueDAO" class="com.example.app.dao.impl.hibernate.LeagueHibernateDAO" />
    <bean id="LeagueService" class="com.example.app.service.LeagueService" />

</beans> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T20:26:48.927

您是否在启动应用程序时检查过 Spring 容器是否正在启动？可能是您的`web.xml`配置有问题。

# java - 尝试在 CentOS 上的 4450 端口打开/侦听时出现 Java BindException

> ID：10219924
> 
> 赞同：0
> 
> 时间：2012-04-19T00:12:28.253
> 
> 标签：java, centos, port, serversocket

我正在尝试打开一个端口来监听我的 CentOS VPS。我正在使用 Java。我正在使用的代码在这里：

[http://pastebin.com/GKgaxeaD](http://pastebin.com/GKgaxeaD)

我运行它时遇到的错误在这里：

```
at CommandListener.run(CommandListener.java:27)
at java.net.ServerSocket.(Unknown Source)
at java.net.ServerSocket.(Unknown Source)
at java.net.ServerSocket.bind(Unknown Source)
at java.net.AbstractPlainSocketImpl.bind(Unknown Source)
at java.net.PlainSocketImpl.socketBind(Native Method)
java.net.BindException: Address already in use 
```

为什么我会收到此错误？没有使用端口 (4450)。似乎也没有防火墙或任何阻塞端口的东西，但我对此不是 100% 确定的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T00:16:32.983

请在终端（控制台）中运行 lsof -i:4450 以检查谁使用了此端口

# xml - 使用 XSLT 样式表的奇怪 XML 格式

> ID：10219930
> 
> 赞同：3
> 
> 时间：2012-04-19T00:13:28.913
> 
> 标签：xml, xslt

我正在寻找一些可以处理我的 xml 文档的正确缩进的 XSLT 样式表，并在[http://www.printk.net/~bds/indent.html](http://www.printk.net/~bds/indent.html)找到了一个非常好的样式表。

希望作者不要因为这样的引用而责怪我：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" encoding="ISO-8859-1"/>
  <xsl:param name="indent-increment" select="'   '"/>

  <xsl:template name="newline">
    <xsl:text disable-output-escaping="yes">
</xsl:text>
  </xsl:template>

  <xsl:template match="comment() | processing-instruction()">
    <xsl:param name="indent" select="''"/>
    <xsl:call-template name="newline"/>    
    <xsl:value-of select="$indent"/>
    <xsl:copy />
  </xsl:template>

  <xsl:template match="text()">
    <xsl:param name="indent" select="''"/>
    <xsl:call-template name="newline"/>    
    <xsl:value-of select="$indent"/>
    <xsl:value-of select="normalize-space(.)"/>
  </xsl:template>

  <xsl:template match="text()[normalize-space(.)='']"/>

  <xsl:template match="*">
    <xsl:param name="indent" select="''"/>
    <xsl:call-template name="newline"/>    
    <xsl:value-of select="$indent"/>
      <xsl:choose>
       <xsl:when test="count(child::*) > 0">
        <xsl:copy>
         <xsl:copy-of select="@*"/>
         <xsl:apply-templates select="*|text()">
           <xsl:with-param name="indent" select="concat ($indent, $indent-increment)"/>
         </xsl:apply-templates>
         <xsl:call-template name="newline"/>
         <xsl:value-of select="$indent"/>
        </xsl:copy>
       </xsl:when>       
       <xsl:otherwise>
        <xsl:copy-of select="."/>
       </xsl:otherwise>
     </xsl:choose>
  </xsl:template>    
</xsl:stylesheet> 
```

除了一件讨厌的事情之外，它几乎完成了我想要的所有事情：它使我的文档的根元素（但不是 XML 声明）缩进了奇怪的 8 个空格。结果看起来像那段标记：

```
<?xml version="1.0" encoding="UTF-8"?>
        <database>
           <books>
              <book id="0">
                 <ISBN value="0123456789"/>
                 <title>Some book title Language</title>
                 <hardcover value="false"/>
                 <price value="40.46"/>
                 <in_stock value="100"/>
                 <annotation>Some annotation</annotation>
              </book>
           </books>
        </database>` 
```

我对 XSLT 技术相当陌生，花了很多时间试图了解如何修复它，但到目前为止还没有成功。我正在使用标准 javax.xml.transform.Transformer 类进行 XSLT 转换。你知道为什么会发生这种情况吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-19T01:38:21.737

**您不需要任何特殊的 XSLT 代码来进行缩进**。

**仅使用标准身份模板，其中** `<xsl:output indent="yes"/>`：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于任何 XML 文档（例如此）时：**

```
<database>            <books>
<book id="0">
<ISBN value="0123456789"/>
<title>Some book title Language</title>
              <hardcover value="false"/>
 <price value="40.46"/>
   <in_stock value="100"/>
    <annotation>Some annotation</annotation>
   </book></books> </database> 
```

**它输出相同的 XML 文档，但缩进**：

```
<database>
   <books>
      <book id="0">
         <ISBN value="0123456789"/>
         <title>Some book title Language</title>
         <hardcover value="false"/>
         <price value="40.46"/>
         <in_stock value="100"/>
         <annotation>Some annotation</annotation>
      </book>
   </books>
</database> 
```

# php - 制作一个允许用户编辑 html 模板并将这些模板保存在服务器上的 Web 应用程序

> ID：10219931
> 
> 赞同：0
> 
> 时间：2012-04-19T00:13:35.303
> 
> 标签：php, javascript, ajax, jquery, wysiwyg

我正在创建一个 Web 应用程序，它允许您从模板列表中选择一个模板，然后用户可以通过拖放和普通的所见即所得编辑器在我的网站上编辑该模板。现在我的问题是，

最好的做法是什么？

1.  在 php 中创建基本模板并通过 ajax 调用不断更改组件的值。或者...
2.  在客户端操作整个模板（仅使用 javascript）并在保存时获取模板的当前状态并将其发送到服务器以进行持久性。（我不确定这是一个可行的想法）

帮助将不胜感激。目前我正在构建所有的编辑工具，比如调色板并添加 NicEdit 轻量级文本编辑器。大多数情况下，一切都在使用 Jquery lib，所以如果你知道通过 Jquery 解决这个问题的方法，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T00:29:25.700

该解决方案可能会根据您尝试实现的确切要求（包括此应用程序的流量）而有所不同。

如果我要从头开始创建它，我可能会选择混合解决方案：

1.  在客户端缓存模板状态
2.  在各种用户事件上添加处理程序，例如“在文本框中键入/暂停”、“单击所见即所得的编辑器菜单”
3.  当用户被检测为空闲（在模板状态的上下文中）例如他刚刚按下上传图像按钮时，您可以通过 ajax 发送以在后端同步模板状态

PS：确保在页面卸载和其他相关事件上添加事件，以便确保在用户离开页面之前已将客户端模板状态与后端同步。

# fonts - 字体可以在 TTF 中指定强制背景颜色吗？

> ID：10219933
> 
> 赞同：2
> 
> 时间：2012-04-19T00:13:41.810
> 
> 标签：fonts, truetype

我正在尝试研究创建自己的自定义字体。我已经阅读了一些内容，但由于我对字体一无所知，所以我有一个问题我无法找到答案。

你能定义一个字体颜色是静态的字体吗？例如，我想创建一个字体，其中每个 A 都有蓝色背景，B 有黄色背景等。我所做的阅读似乎表明您需要将字体转换为黑色或白色。我的理解是否正确，并且不支持在字体中强制使用特定颜色，尤其是背景颜色？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-26T04:42:02.813

支持取决于您的操作系统/浏览器版本，但 OpenType 1.7 支持多色字体，并且有多种选择。

*   COLR/CPAL 表：这是一种多层可缩放矢量方法，其中单个字形可以具有多个颜色层，类似于早期使用多个单独字体的多层字体方法。轮廓是标准的“glyf”表格轮廓，如单色字体。它在 Windows 8.1 和 FireFox 40.0.3 上的 IE 中受支持（尝试 Segoe UI Emoji）。[http://www.microsoft.com/typography/otspec/colr.htm](http://www.microsoft.com/typography/otspec/colr.htm) [https://www.microsoft.com/typography/otspec/cpal.htm](https://www.microsoft.com/typography/otspec/cpal.htm) **请注意，我实际上在这个提案上做了一些工作，所以这是我知道的最关于。*
*   OpenType 内的 SVG：这也是一种可扩展的矢量方法，将 SVG 轮廓存储在 OpenType 容器内。FireFox 26 支持它。[http://lists.w3.org/Archives/Public/public-svgopentype/2013Jul/0003.html](http://lists.w3.org/Archives/Public/public-svgopentype/2013Jul/0003.html)
*   CBDT/CBLC 表：它存储彩色嵌入位图，类似于旧的 EBDT 表，它只是单色的。[http://www.microsoft.com/typography/otspec/cblc.htm](http://www.microsoft.com/typography/otspec/cblc.htm) [http://www.microsoft.com/typography/otspec/cbdt.htm](http://www.microsoft.com/typography/otspec/cbdt.htm)
*   SBIX：将图像 (PNG/JPG/TIFF) 存储在 TrueType 中，支持 iOS4+ 和 OSX 10.7+。[https://developer.apple.com/fonts/TrueType-Reference-Manual/RM06/Chap6sbix.html](https://developer.apple.com/fonts/TrueType-Reference-Manual/RM06/Chap6sbix.html)。

前两个具有与设备无关的可扩展性优势，但它们缺乏精细的像素级细节。最后两个的优点是可以在图像中提供精细的细节，但是当以不同于预期尺寸的尺寸使用时，它们看起来会像素化或模糊。

Roel Nieskens 在这里写得很好，包括一个测试页面，显示您当前的浏览器对不同方法的支持：http: [//pixelambacht.nl/2014/multicolor-fonts/](http://pixelambacht.nl/2014/multicolor-fonts/)

OpenType 1.6 规范不直接支持多色字体，但您仍然可以选择...

*   创建所有字形的图集纹理（基本上是与 CSS 精灵结合使用的大位图）。游戏使用这种方法，但需要注意的是它们不可扩展——无论如何都不是没有像素化。
*   覆盖多个 OpenType 字体的文本。多层 OpenType 是图形设计师使用的一种方法（例如在 In-Design 中）。创建多种字体，每种颜色一个字体有点奇怪，但它确实有效。您可以将浮动跨度半透明地叠加在一起。
*   通过 InkScape 使用 SVG 字体（在支持它的浏览器子集中）。SVG 字体是可扩展的并且支持多种颜色（实际上几乎是 SVG 所做的任何事情），但它们的支持有限：Opera 9+ 或 Chrome 4+，但不支持 IE10 或 FF。
*   直接使用 SVG 组件。它不是真正的“SVG 字体”，但您仍然可以通过编程将每个字符与其对应的 SVG 部分相关联（假设我们在 ASCII 范围内，而不是整个 Unicode 中的任何字符）。当前所有浏览器都支持 SVG：Opera9、IE10、FF3、Chrome4、Safari3.2。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-19T12:47:31.597

you can with layered color fonts: [https://www.glyphsapp.com/tutorials/creating-a-layered-color-font](https://www.glyphsapp.com/tutorials/creating-a-layered-color-font)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-27T19:17:12.843

字体没有颜色，所以你是对的，你不能在字体文件中强制使用特定的颜色。但是，您可以在使用字体时应用所需的任何颜色。

# python - 没有顶级父级的djutils自动发现导入命令，queue_consumer不喜欢它

> ID：10219934
> 
> 赞同：0
> 
> 时间：2012-04-19T00:13:46.757
> 
> 标签：python, django, queue

当 djutils 在*init*中通过 autodiscover 时，它会导入我的任务“app.commands.task1”并将其作为日志输出的一部分。

但是当我运行 webserver 并尝试将命令排队时，queue_consumer 日志表明它找不到密钥“ **project** .app.commands.queuecmd_task1”

> QueueException：在 CommandRegistry 中找不到 project.app.commands.queuecmd_task1

我认为它试图找到的字符串前面带有“项目”的事实是它找不到任务的原因。

为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T00:22:06.393

看起来我的项目中的重复导入导致了问题。

# c# - AutoMapper 的 AssertConfigurationIsValid 仅在首次加载时失败？

> ID：10219935
> 
> 赞同：2
> 
> 时间：2012-04-19T00:13:51.000
> 
> 标签：c#, asp.net-mvc-3, automapper

在 X/WebSiteMVC3/Core/DependencyResolution/XProfile.cs 中，我有一个看起来有点像这样的现有映射：

```
 CreateMap<DomainObjects.Entities.Thing1, Models.Thing1>();
 CreateMap<Models.Thing1, DomainObjects.Entities.Thing1>()
     .ForMember(a => a.Thing2, opt => opt.Ignore())
     .ForMember(a => a.ModifiedBy, opt => opt.Ignore())
     .ForMember(a => a.ModifiedDate, opt => opt.Ignore())
     .ForMember(a => a.CreatedBy, opt => opt.Ignore())
     .ForMember(a => a.CreatedDate, opt => opt.Ignore()); 
```

我需要为其子对象添加一个映射，所以我输入了这个：

```
 CreateMap<DomainObjects.Entities.Thing2, Models.Thing2>();
 CreateMap<Models.Thing2, DomainObjects.Entities.Thing2>()
     .ForMember(a => a.ModifiedBy, opt => opt.Ignore())
     .ForMember(a => a.ModifiedDate, opt => opt.Ignore())
     .ForMember(a => a.CreatedBy, opt => opt.Ignore())
     .ForMember(a => a.CreatedDate, opt => opt.Ignore()); 
```

它可以工作，除了在第一页加载时，我得到了这个：

> 未映射的成员被发现。查看下面的类型和成员。添加自定义映射表达式、忽略、添加自定义解析器或修改源/目标类型
> 
> Thing2 -> Thing2（目标成员列表）
> 
> XXWebSiteMVC3.Models.Thing2 -> XXDomainObjects.Entities.Thing2（目标成员列表）
> 
> 东西1

堆栈跟踪：

> AutoMapper.ConfigurationStore.AssertConfigurationIsValid(IEnumerable`1 typeMaps) +684 AutoMapper.ConfigurationStore.AssertConfigurationIsValid() +12 AutoMapper.Mapper.AssertConfigurationIsValid() +23 XXWebSiteMVC3.Core.DependencyResolution.AutomapperRegistry.Configure() 在 C:\Source\XXWebSiteMVC3\ Core\DependencyResolution\AutomapperRegistry.cs:13 XXWebSiteMVC3.MvcApplication.Application_Start() 在 C:\Source\XXWebSiteMVC3\Global.asax.cs:96

但是在随后的*所有*其他加载中，它都按预期工作！？

那么......为什么 Thing2 失败了，当它的实现与 Thing1 匹配时（它一直都在工作）？为什么在 Thing2 的错误中提到了 Thing1（我觉得这是原因，但如果我能在这个空闲的星期四上午 10 点看到它，那该死的）？

穆乔斯·丹克！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-22T23:45:57.133

最后，这是由 Thing2 对 Thing1 的交叉引用引起的……所以我不得不这样做……

```
 CreateMap<DomainObjects.Entities.Thing2, Models.Thing2>();
 CreateMap<Models.Thing2, DomainObjects.Entities.Thing2>()
 !-> .ForMember(a => a.Thing1, opt => opt.Ignore())
     .ForMember(a => a.ModifiedBy, opt => opt.Ignore())
     .ForMember(a => a.ModifiedDate, opt => opt.Ignore())
     .ForMember(a => a.CreatedBy, opt => opt.Ignore())
     .ForMember(a => a.CreatedDate, opt => opt.Ignore()); 
```

真正让我感到奇怪的是，我收到的错误消息（“发现未映射的成员......”）并没有出现在 Google 上！？通常，当这种情况发生时，我已经设法做一些非常奇怪/奇怪的事情，因此我快速触发在这里提出问题。在这种情况下，问题有点微不足道。

所以......对于可能通过谷歌到达这里的其他人：这可能与您的模型本身有关，而不是 AutoMapper 的一些奇怪之处。虽然我仍然不知道为什么映射在第二次通过时“起作用”！？这太奇怪了！

# php - .NET 中 PHP 的 InfiniteIterator 等价物是什么？

> ID：10219939
> 
> 赞同：5
> 
> 时间：2012-04-19T00:14:22.370
> 
> 标签：php, .net, equivalent

我和朋友讨论了 PHP 的[InfiniteIterator](http://php.net/manual/en/class.infiniteiterator.php)。

在 .NET 世界中是否有它的等价物？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T00:23:50.293

不是内置但易于编写：

```
public static IEnumerable<T> RepeatInfinitely<T>(this IEnumerable<T> sequence)
{
 while(true) {
  foreach(var item in sequence)
   yield return item;
 }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T00:28:36.683

你可以自己滚动。

```
public class InfiniteEnumerator: System.Collections.IEnumerator
{
    private System.Collections.IEnumerator  _m_enumerator;
    public InfiniteEnumerator(System.Collections.IEnumerator enumerator)
    {
        _m_enumerator = enumerator;
    }

    public object Current
    {
        get { return _m_enumerator.Current; }
    }

    public bool MoveNext()
    {
        if (!_m_enumerator.MoveNext())
        {
            _m_enumerator.Reset();
            return _m_enumerator.MoveNext();
        }
        else
        {
            return true;
        }
    }

    public void Reset()
    {
        _m_enumerator.Reset();
    }
} 
```

# php - Hudson - 测试框架的插件

> ID：10219940
> 
> 赞同：0
> 
> 时间：2012-04-19T00:14:42.360
> 
> 标签：php, unit-testing, hudson

我是 Hudson 的新手，我需要运行几个 PHP 插件的单元测试，这些插件是为不同的框架（例如 Wordpress、Drupal 等）编写的。为了工作，这些插件需要安装到框架中，并且必须首先加载一个 boostrap 文件。

我想知道我应该如何继续配置 Hudson 以告诉它从框架的子目录中的源代码管理中导出插件，然后运行测试。我在想这个框架可以连同它的标准数据库一起安装一次，并且永远不会被触及（我会针对不同的框架版本运行单独的测试）。最终，可以在每次运行时恢复数据库，以确保以前的问题不会干扰测试。

我的问题是：是否可以执行上述操作？总结： - 在系统上安装每个框架，在 Hudson 专用文件夹和标准数据库中。- 在每次运行时，让 Hudson 恢复标准数据库（以防止之前运行的“污染”）。- 让 Hudson 从 SVN 获取插件文件并将它们存储在适当的文件夹中，具体取决于框架。- 运行测试。

提前感谢所有建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T00:20:47.803

您可以为 cms 本身使用主作业 + ant 配置文件，如果它正在重建，其他作业可以从它开始并使用主作业创建的目录。

我已经这样做了一个cms并且它有效，但是我使用了jenkins而不是hudson，不知道现在的差异有多大。

例如，您可以检查主要作业中的源代码控制更改。只要重建主要作业，您就可以告诉其他作业开始。

# .net - 混合模式 C++/CLI 应用程序未正确关闭 CLR

> ID：10219942
> 
> 赞同：1
> 
> 时间：2012-04-19T00:15:28.223
> 
> 标签：.net, mfc, c++-cli, mixed-mode

我的混合模式 MFC 应用程序正在创建错误的内存泄漏，因为在 MFC dll 关闭之前 CRT 没有时间关闭。

我有一个非常简单的小应用程序可以显示问题：

```
#include <windows.h>
#include <iostream>

struct LongTimeToDestroy
{
  ~LongTimeToDestroy()
  {
    std::cout << "Will get called!" << std::endl;
    Sleep(3000);
    std::cout << "Won't get called!" << std::endl;
  }
};

LongTimeToDestroy gJamsUpTheCRT;

int main()
{
} 
```

用 编译`cl.exe /clr test.cpp`。运行时，您会得到：

```
Will get called! 
```

问题的症结在于：之前声明的任何静态/全局变量`gJamsUpTheCRT`都不会被释放。例如，在我的例子中，MFC CWinApp 派生类没有被清理。

这是预期的行为吗？我想让我的应用程序完全关闭。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T00:31:17.230

> 这是预期的行为吗？

是的，尽管您必须阅读 CLI 规范中的细则。它承诺在程序终止时调用托管对象的终结器。但需要注意的是，执行此操作的终结器线程需要两秒钟才能完成工作。如果需要更长的时间，则 CLR 会假定存在严重错误。就像在不会收到信号的同步对象上阻塞代码的常见诅咒一样。它通过*中止*终结器线程并允许程序终止来处理它。没有诊断。

您必须解决此限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T00:26:52.723

我相信[这回答了你的问题](https://stackoverflow.com/a/9941751/10311)。

相关文字：

> 虽然可配置，但默认情况下，CLR 会让终结器运行 2 秒，然后变得不耐烦；如果超过此超时，终结器线程将停止，并继续关闭而不耗尽终结器队列的其余部分。

所以你真的不应该让任何析构函数执行需要时间的任务。

编辑：实际上，这不是 CLR 类，所以它不应该在终结队列中？这可能具有误导性。

# c++ - 二维指针数组c ++

> ID：10219949
> 
> 赞同：0
> 
> 时间：2012-04-19T00:16:04.537
> 
> 标签：c++, pointers

为什么这段代码不能在 C++ 中制作二维数组指针？编译器抱怨第二行不是可修改的左值。

```
 int* g[2][2];
  g[0] = new (int*)[2]; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-19T00:18:59.703

的类型`g[0]`是`int* [2]`，即它是一个数组。您不能分配给数组。

目前尚不清楚您要达到的目标，因此我无法提供解决方案。如果你澄清你的问题，我可能会做得更好。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-19T00:20:21.523

第一行就是创建一个包含 2 个指针数组的数组`int`。

您不能为其分配新值的原因`g[0]`是因为`g[0]`它本身是一个数组，并且您不能为数组分配新值，只能为其元素分配新值。

# objective-c - Obj-C 抱怨字段是“未使用的表达式结果”

> ID：10219950
> 
> 赞同：0
> 
> 时间：2012-04-19T00:16:04.617
> 
> 标签：objective-c, sqlite, fmdb

我正在尝试使用以下代码进行 FMDB 插入：

```
dbCmd = @"INSERT INTO SiteData (SITE_ID, INITIAL_STA, ELEV, SITE_DESC, LOOP_COUNT, DATE) VALUES(?,?,?,?,?,?)",
txtSiteID.text, 
[txtSTA.text floatValue],
[txtElev.text floatValue],
txtSiteDesc.text, 
[NSNumber numberWithInt:0], 
currentDate; 
```

“浮点值”方法调用未修改的 3 个文本字段中的每一个都收到错误消息：“未使用表达式结果”，这导致参数计数关闭，进而导致 FMDB 崩溃。

我认为编写的代码没有任何问题......有人可以告诉我我需要改变什么才能让它工作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T00:22:18.487

我认为你非常困惑。编码

```
dbCmd = @"INSERT INTO SiteData (SITE_ID, INITIAL_STA, ELEV, SITE_DESC, LOOP_COUNT, DATE) VALUES(?,?,?,?,?,?)",
txtSiteID.text, 
[txtSTA.text floatValue],
[txtElev.text floatValue],
txtSiteDesc.text, 
[NSNumber numberWithInt:0], 
currentDate; 
```

并没有像您想象的那样创建带有占位符的语句。它运行着一大堆用[逗号](http://en.wikipedia.org/wiki/Comma_operator)分隔的表达式。变量`dbCmd`以 的值结束`currentDate`，所有其他表达式的值都被丢弃。编译器警告您正在编写未使用的表达式。

我认为你需要做的是

```
[db executeUpdate:@"INSERT INTO SiteData (SITE_ID, INITIAL_STA, ELEV, SITE_DESC, LOOP_COUNT, DATE) VALUES(?,?,?,?,?,?)",
    txtSiteID.text, 
    [txtSTA.text floatValue],
    [txtElev.text floatValue],
    txtSiteDesc.text, 
    [NSNumber numberWithInt:0], 
    currentDate]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T16:41:52.573

这是答案：

```
dbCmd = [NSString stringWithFormat: @"INSERT INTO SiteData (SITE_ID, INITIAL_STA, ELEV, SITE_DESC, LOOP_COUNT, DATE) VALUES(%@, %f, %f, %@, %d, %@)",
    txtSiteID.text,
    [txtSTA.text floatValue],
    [txtElev.text floatValue],
    txtSiteDesc.text, 
    [NSNumber numberWithInt:0], 
    currentDate]; 
```

像冠军一样工作！谢谢大家的意见。我很感激！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T00:21:21.230

dbCmd 是什么类型的对象？如果是字符串，则需要使用`[NSString stringWithFormat:]`正确的字符串百分比编码。您不能只在`NSString`常量 ( `@""`) 上添加参数。

编辑：见凯文的回答。

# javascript - 如何从javascript错误行号获取实际行

> ID：10219959
> 
> 赞同：0
> 
> 时间：2012-04-19T00:17:04.927
> 
> 标签：javascript, html, error-handling

当您的页面是动态生成的时，# 行并不是那么有用。我真正想要的是实际的违规行。

有没有办法做到这一点？也许

```
document.getElementsByTagName('html')[0].innerHTML.Split('\n')[lineNumber-1];

// OR

document.body.innerHTML.Split('\n')[lineNumber-1]; 
```

但是，当我在 中对其进行测试时`Firefox 10`，我发现上面的内容是不准确的，除非`html`and`body`标记在同一行。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T18:04:00.000

对于任何好奇的人，我的答案是使第一个`head`或`body`元素上方的行数在所有页面中保持一致。

对我来说，这个神奇的#是三。

应该注意的是，如果错误发生在 js 文件中，那么我不知道如何获取实际的客户端行。但是，由于这样做的全部目的是将行记录到服务器（使用 ajax），我可以简单地读取服务器上 js 文件的行。因此，这意味着您必须对错误的 url 进行额外检查，以查看它是否是 javascript 文件。

# bash - 我需要编辑 bash 脚本以选择一个字母来执行单独的命令

> ID：10219964
> 
> 赞同：2
> 
> 时间：2012-04-19T00:18:14.183
> 
> 标签：bash

我不确定在这个过程中下一步是什么让命令做我想做的事。我想选择一个字母来执行命令。现在它可以让你使用任何字母。

```
#!/bin/bash
echo "Please select l to list files of a directory, b to backup a file or directory, u to edit a user's password, and x to exit the script"

read $answer

if [ $answer="l" ]; then

printf "Please select folder:\n"
select d in */; do test -n "$d" && break; echo ">>> Invalid Selection"; done
cd "$d" && pwd

ls

fi 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T00:25:48.803

使用案例陈述

```
case expression in
    pattern1 )
        statements ;;
    pattern2 )
        statements ;;
    ...
esac 
```

例如：

```
case $arg in
    l)
        printf "Please select folder:\n"
        select d in */; do test -n "$d" && break; echo ">>> Invalid Selection"; done
        cd "$d" && pwd
        ls
        ;;
    cmd1)
        echo "Some other cmds line 1"
        echo "Some other cmds line 2"
        ;;
    -q) exit;;
    *) echo "I'm the fall thru default";;
esac 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T14:27:36.223

您可以`select`为此使用内置函数，它可以让您对每个选项使用数字而不是字母，但会负责读取和验证输入：

```
select cmd in \
  "List files of a directory" \
  "Backup a file or directory" \
  "Edit a user's password" \
  "Exit";
do
  case $cmd in
  1) do_list_files ;;
  2) do_backup_files ;;
  3) do_edit_password ;;
  4) exit 0 ;;
  esac
done 
```

`PS3`您可以通过设置变量来更改提示（例如`PS3="Your choice? "`）

# imagemagick - 使用 RMagick 裁剪图像会消除抗锯齿

> ID：10219969
> 
> 赞同：2
> 
> 时间：2012-04-19T00:19:48.677
> 
> 标签：imagemagick, rmagick

我正在使用 RMagick 将一个大的 PNG 文件裁剪成图块。原始PNG文件是具有透明背景的线条艺术；线条边缘经过 alpha 混合以减少锯齿。瓷砖（也是 PNG 文件）不是 alpha 混合的，它们看起来很难看。如何在图块中保留 Alpha 通道？

这是代码：

```
big_image = Image.read(png_file)[0]

0.upto(tileset['width'] - 1) do |x|
  0.upto(tileset['height'] - 1) do |y|
    # Snip the code that sets tile_filename

    # Find the region to crop
    left = x * 256
    # The Y axis goes bottom to top
    bottom = tileset['height'] * 256
    top = bottom - ((1 + y) * 256)

    tile = big_image.crop(left, top, 256, 256)
    tile.write(tile_filename)
  end
end 
```

我检查了该`.alpha?`方法——它对`big_image`和都返回 true `tile`。我也尝试过调用`.alpha(ActivateAlphaChannel)`这两个对象；它没有帮助。

# ssh - 将端口放入远程服务器 SSH 隧道

> ID：10219970
> 
> 赞同：0
> 
> 时间：2012-04-19T00:20:09.050
> 
> 标签：ssh, tunneling

我需要知道是否可以通过 ssh 隧道将本地端口放入远程机器

例子

```
Machine A: port 80 
Machine B: Nothing 
```

机器 A 内部（**重要，因为 A 可以看到 B，但 B 看不到 A**）

```
A>  ssh -f -N -? 80:B:8585 user@B 
```

结果

```
Machine A: port 80 
Machine B: port 8585 (really A:80) 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T05:52:14.020

你需要`-R`开关

```
ssh -f -N -R 8585:localhost:80 user@B 
```

`localhost`是从 A 的角度来看的，所以就是将 B 的 8585 端口转发到 A 的 80 端口。

另请`RemoteForward`参阅`~/.ssh/config`.

# silverlight - Windows Phone 导航代码错误

> ID：10219971
> 
> 赞同：0
> 
> 时间：2012-04-19T00:20:13.617
> 
> 标签：silverlight, windows-phone-7, navigation

我在哪里错了？

```
private void lstCars_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    string currCar = (sender as ListBox).SelectedItem as string;
    NavigationService.Navigate(new Uri("/ViewCarDetails.xaml?info=" + currCar, UriKind.Relative));
} 
```

这是我试图导航到的页面

```
 public ViewCarDetails(string registrationNum)
    {
         //stuff
    } 
```

这是我收到错误时程序跳转到的代码（在 App.xaml.cs 中）

```
 private void RootFrame_NavigationFailed(object sender, NavigationFailedEventArgs e)
    {
        if (System.Diagnostics.Debugger.IsAttached)
        {
            // A navigation has failed; break into the debugger
            System.Diagnostics.Debugger.Break();
        }
    } 
```

我检查了 URI 但没有拼写错误 谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T06:49:38.627

问题是您正在通过 NavigationService 传递一个参数，而 ViewCarDetails 类构造函数需要一个您没有传递的参数。

要解决它，您必须创建一个不带参数的构造函数，并从 NavigatedTo 事件中获取您通过导航服务传递的参数，如下所示：

```
public ViewCarDetails() 
    { 
         //stuff 
    } 
```

和

```
protected override void OnNavigatedTo(NavigationEventArgs e)
    {
        string registrationNum = string.Empty;
        if (NavigationContext.QueryString.TryGetValue("index", out registrationNum))
        {
                         //do stuff
        }
    } 
```

试试看，让我们知道，

添加：

```
public class ViewCarDetails : PhoneApplicationPage
{
    private string registrationNum;

    public ViewCarDetails() 
        { 
             //stuff 
        } 
    protected override void OnNavigatedTo(NavigationEventArgs e)
        {
            registrationNum = string.Empty;
            if (NavigationContext.QueryString.TryGetValue("index", out registrationNum))
            {
                             //do stuff
            }
        }
    //other methods and properties
} 
```

问候，

# javascript - 如果在尝试隐藏除一个以外的每个 div 时循环

> ID：10219975
> 
> 赞同：1
> 
> 时间：2012-04-19T00:20:42.163
> 
> 标签：javascript, jquery, facebook

我正在创建一个 facebook 风格的活动邀请脚本。我已经让朋友们在我的模态等中显示，我遇到的问题是，当您选择一个类别时，类别按钮调用的脚本应该隐藏 group_friends 容器中的所有 div，但当前 id 的 div 除外被查询。这是我正在处理的功能：

```
function get_group_friends(element){
var group_id=($(element).attr("id")); 

console.log((($("div[id^="+group_id+"]")).children()).length);

if(((($(".div[id^="+group_id+"]").children()).length)) == 0)
     {

      $("#container_group_friends").children().not($("div[id^="+group_id+"]")).hide();
       $("#container_all_friends").hide();

  var query = "SELECT uid, name, pic_square FROM user WHERE uid IN(SELECT uid FROM group_member WHERE gid = "+($(element).attr("id"))+" AND uid IN(SELECT uid2 FROM friend WHERE uid1=me()))"; 
FB.api({access_token: accessToken, method:'fql.query', query: query}, function(response_group_friend)
{
   var i=0;
   var result_group_friend="";
   for(i=0; i<response_group_friend.length; i++)
   {
      result_group_friend+="<div class='fbfriends' id='"+response_group_friend[i].uid+"' ><div class='user float_left'><img src='"+response_group_friend[i].pic_square+"'/><div class='tick'></div></div><div class='friend_name float_left'>"+response_group_friend[i].name+"</div></div>";

   }   $("div[id^="+group_id+"]").append(result_group_friend);

  //    $("#container_group_friends").append($("div[id^="+group_id+"]"));
 });

}
 else
{
        ($("#container_group_friends").children().not($("div[id^="+group_id+"]"))).hide();
      $("#container_all_friends").hide();
 }

} 
```

问题是，当我单击另一个类别时，容器中的所有内容都是不可见的，即使是正在查询具有特定 id 的 div。我可能没有按照我应该的逻辑来看待这个问题。任何帮助都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-19T02:15:23.967

有几个假设，代码应该简化如下：

```
function get_group_friends(element) {
    var group_id = $(element).attr("id");
    var $groupContainer = $("div[id^=" + group_id + "]");
    $("#container_group_friends").children().not($groupContainer).hide();
    $("#container_all_friends").hide();
    //console.log($groupContainer.children().length);
    if( $groupContainer.children().length == 0 ) {
        var query = "SELECT uid, name, pic_square FROM user WHERE uid IN(SELECT uid FROM group_member WHERE gid = " + group_id + " AND uid IN(SELECT uid2 FROM friend WHERE uid1=me()))";
        FB.api({access_token: accessToken, method:'fql.query', query: query}, function(response_group_friend) {
            $.each(response_group_friend, function(i, f) {
                $groupContainer.append("<div class='fbfriends' id='" + f.uid + "' ><div class='user float_left'><img src='" + f.pic_square + "'/><div class='tick'></div></div><div class='friend_name float_left'>" + f.name + "</div></div>");
            });
        });
    }
} 
```

除非我犯了错误，否则什么都不会改变。

问题似乎是没有显示当前组容器的语句，因此如果先前选择了另一个组（即类别），它将保持隐藏状态。

尝试将上面代码的第 3 行更改为：

```
var $groupContainer = $("div[id^=" + group_id + "]").show(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-19T01:24:49.903

首先，第 4 行代码中有不需要的点。选择器内“div”之前的一个。你确定，`div`你在那里使用的文字是类名吗？

`if(((($(".div[id^="+group_id+"]").children()).length)) == 0) if($("div[id^="+group_id+"]").children().length == 0)`

其次，但我不是 100% 确定。您可能在这里错过了双重`not`声明：

> $("#container_group_friends").children(). ***不是***($("div[ ***id^=** "+group_id+"]")).hide();

我会将此表达式转换为单个选择器：

> $("#container_group_friends > div:not(#" + group_id + ")").hide()

# mysql - 以主键顺序插入行是否更快？

> ID：10219980
> 
> 赞同：2
> 
> 时间：2012-04-19T00:21:04.103
> 
> 标签：mysql

我有一张这样的桌子：

```
create table stream_last
(
        symbol_id       integer,
        high            decimal(8,2),
        low             decimal(8,2),
        last            decimal(8,2),
        volume          integer,
        last_updated    datetime,
        INDEX USING BTREE(symbol_id)
) ENGINE=MEMORY; 
```

我需要每 5 秒进行大约 4,000 次插入（由读取流并在 symbol_id 上聚合的 C 程序爆破）。但是，我可以先对数据进行排序，然后按 symbol_id ASCENDING 顺序插入。这会让这个批量插入更快吗？

第二个问题是，BTREE 是索引的最佳选择吗？从文档中，我本可以使用 HASH 但不确定哪个是最好的......

大学教师

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T00:28:02.263

不要认为您可能会通过您提出的优化获得任何显着差异，但此处列出的建议

[http://dev.mysql.com/doc/refman/5.0/en/insert-speed.html](http://dev.mysql.com/doc/refman/5.0/en/insert-speed.html)

当然可以帮助您更好地了解您的需求。

这句话可能有道理

> 假设 B-tree 索引，表的大小会减慢 log N 的索引插入速度。
> 
> 您可以使用以下方法来加快插入速度：
> 
> 如果您同时从同一个客户端插入多行，请使用带有多个 VALUES 列表的 INSERT 语句一次插入多行。这比使用单独的单行 INSERT 语句要快得多（在某些情况下快很多倍）。如果要向非空表添加数据，则可以调整 bulk_insert_buffer_size 变量以使数据插入更快。请参见第 5.1.3 节，“服务器系统变量”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-24T00:26:05.413

这些文档建议按主键顺序插入可以提高性能：

> 执行批量插入时，以 PRIMARY KEY 顺序插入行会更快。InnoDB 表使用聚集索引，这使得按 PRIMARY KEY 顺序使用数据相对较快。以 PRIMARY KEY 顺序执行批量插入对于不完全适合缓冲池的表尤其重要。

资料来源：[https ://dev.mysql.com/doc/refman/5.7/en/optimizing-innodb-bulk-data-loading.html](https://dev.mysql.com/doc/refman/5.7/en/optimizing-innodb-bulk-data-loading.html)

最好将此优化与@Igor 的答案中引用的批量插入语句结合起来。

# vb.net - 将多个文件读入列表视图 VB.Net

> ID：10219983
> 
> 赞同：0
> 
> 时间：2012-04-19T00:21:26.610
> 
> 标签：vb.net

我需要要求该程序的用户从任何目录中选择两个文本文件。然后我需要在我构建的列表视图中显示它们。文件 1 需要加载到第一列，文件 2 需要加载到第二列。它们将相互对应。

我目前有以下允许多选

```
OpenFileDialog.Multiselect = True 
```

我遇到的麻烦是将这些唯​​一文件分成相应的列。例如，以下代码非常有效地将第一个文件的内容加载到第一列：

```
 Dim fileName As String = OpenFileDialog.FileName

        fileReader = New StreamReader(fileName)

        Do While fileReader.Peek() <> -1
        firstFile = fileReader.ReadLine & vbNewLine
        ListView1.Items.Add(firstFile)

        Loop 
```

当我选择第二个文件时，第一个文件的内容在同一列中被第二个文件的内容替换。

我看过使用数组，但不确定如何将唯一文件加载到每个索引中。

我真的不知道从这里去哪里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T01:42:23.140

当你使用

```
OpenFileDialog1.Multiselect = true 
```

所有选定的文件都已作为集合存储在 中`OpenFileDialog1.FileNames`，只需遍历所有值并将它们放入列表视图中

```
ListView1.Items.Clear
Dim file as string
For Each file in OpenFileDialog1.FileNames
    ListView1.Item.Add(file)
Next 
```

如果您想在不同的列中显示文件内容，那么您可能需要更改一些代码

```
 Dim fileName As String = OpenFileDialog.FileName

    fileReader = New StreamReader(fileName)

    Dim FileItem As New ListViewItem
    Do While fileReader.Peek() <> -1
        firstFile = fileReader.ReadLine & vbNewLine

        FileItem .SubItem.Add(firstFile)

    Loop
    ListView1.item.add(Item) 
```

但是，您可能需要在添加任何项目之前声明 ListView1 中的列。如果您的 ListView1 中没有定义列，那么即使您已将文件内容放入 subItem，也无法显示列

# ios - UIImageView 显示速度比 CG 或 CALayer 快得多。有谁知道为什么？

> ID：10219984
> 
> 赞同：8
> 
> 时间：2012-04-19T00:21:46.530
> 
> 标签：ios, uiimageview, core-animation, core-graphics, calayer

我编写了一个应用程序来测试 iOS 上的图像性能。我尝试了 3 种不同的视图，都显示相同的大 PNG。第一个是使用 CGContextDrawImage() 绘制的视图。第二个设置 self.layer.content。第三个是一个普通的 UIImageView。

使用的图像使用 -[UIImage initWithContentsOfData:] 创建并缓存在 viewController 中。每个测试重复分配一个视图，将其添加到视图层次结构中，然后将其删除并释放它。从 loadView 开始到 viewDidAppear 的时间以 fps 的形式给出（实际上是每秒视图绘制）。

以下是运行 5.1 的 iPad 1 使用 912 x 634 未缩放图像的结果：

```
CGContext:    11 fps
CALayer:      10 fps
UIImageView: 430 fps (!) 
```

我产生幻觉了吗？UIImageView 几乎不可能画得那么快，但我实际上可以看到图像闪烁。我尝试在两个相似的视图之间交换以阻止可能的缓存，但帧速率甚至更高。

我一直认为 UIImageView 只是 -[CALayer setContent] 的包装器。但是，分析 UIImageView 显示几乎没有时间花在我可以识别的任何绘图方法上。

我很想了解发生了什么。非常感激任何的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-19T06:06:32.533

这是我的想法。

当您通过添加、删除或修改某些视图来修改 UIView 层次结构时，还没有执行实际的绘制。相反，视图被标记为“setNeedsDisplay”，并在下次运行循环可以自由绘制时重新绘制。

事实上，如果您的测试代码看起来像这样（我只能猜测）：

```
for (int i=0; i<10000; i++) {
     UIImageView* imageView = [[UIImageView alloc] initWithFrame:frame];
     [mainView addSubview: imageView];
     [imageView setImage: image];
     [mainView removeSubview: imageView];
} 
```

在这个 for 循环完成之前，runloop 会被阻塞。视图层次结构只绘制一次，测量的性能是分配和初始化对象的性能。

另一方面，我认为 CGContextDrawImage() 可以立即自由绘制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T13:01:31.030

UIImageView 的高 FpS 是因为这实际上并没有重绘，而只是在将来 UIKit 想做的时候标记内容以供重绘。

注意：奇怪的是，CGContext 方法比 CALayer 方法快。我还在我的一个项目中尝试了这些方法，使用 CALayer 是最快的方法（当然使用 OpenGL ES 除外）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T13:57:09.747

UIImageView 使用一种不同的方式来渲染图像，这种方式效率更高。您应该观看 WWDC 2011 的此会话视频，该视频解释了渲染过程的工作原理：[https ://developer.apple.com/videos/wwdc/2011/?id=121](https://developer.apple.com/videos/wwdc/2011/?id=121)

# git - 在对 master 进行更改后创建一个 git 分支

> ID：10219990
> 
> 赞同：5
> 
> 时间：2012-04-19T00:22:19.207
> 
> 标签：git, version-control

我开始在 master 中工作 - 后来进行了许多更改（没有提交）我意识到这项工作应该在单独的分支中完成。

我可以使用当前更改创建一个新分支，然后将 master 中的更改丢弃回其原始状态吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-19T00:27:01.657

我想到了。

在主上时：

```
git branch [new-branch]
git checkout [new-branch] 
```

...继续编辑-在我的情况下，我提交了它们...

```
git add .
git commit -am 'updates' 
```

切换回主人

```
git checkout master 
```

在我开始进行所有更改之前，分支处于原始状态......

希望这对其他人有帮助！

# sql - SQL 函数错误：1064

> ID：10219991
> 
> 赞同：0
> 
> 时间：2012-04-19T00:22:22.287
> 
> 标签：sql

我在 SQL 中创建自己的函数时遇到问题。我收到错误 #1064 - 第 10 行的语法错误（带有“创建函数”的行），我不知道我做错了什么？

```
create table students (
id int primary key,
name varchar(30),
surname varchar(30),
class char(4),
born datetime,
grade varchar(10)
)

create function returnGrade
(@class char(4))
return varchar(10)
AS
BEGIN
declare @return varcahr(10)
@class = SUBSTRING(@class, 2, 1)
  SELECT @return = CASE @class
  WHEN '1' then 'first'
  WHEN '2' then 'second'
  WHEN '3' then 'third'
  WHEN '4' then 'fourth'
  ELSE 'unknown'
  END
return @return
END 
```

PS 变量类如下所示：'T3.A'、'T4.A'、'T4.B' 等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T01:34:43.237

由于您没有提到我假设它为 SQL Server 的数据库。

您的代码中有几个拼写错误。

这是更正

```
create function returnGrade
(@class char(4))
returns varchar(10) -- returns not return
AS
BEGIN
declare @return varchar(10)   -- varchar not varcahr
set @class = SUBSTRING(@class, 2, 1)  -- set was missing
  SELECT @return = CASE @class
  WHEN '1' then 'first'
  WHEN '2' then 'second'
  WHEN '3' then 'third'
  WHEN '4' then 'fourth'
  ELSE 'unknown'
  END
return @return
END 
```

上面的代码编译得很好并且也返回了值。

```
select dbo.returngrade('A2') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T03:24:49.883

以下对我有用。

```
CREATE TABLE students
    (
      id INT PRIMARY KEY ,
      name VARCHAR(30) ,
      surname VARCHAR(30) ,
      class CHAR(4) ,
      born DATETIME ,
      grade VARCHAR(10)
    )

GO -- Added GO

CREATE FUNCTION returnGrade ( @class CHAR(4) )
RETURNS VARCHAR(10) -- Changed to RETURNS from RETURN
AS 
    BEGIN
        DECLARE @return VARCHAR(10) -- Corrected the typo varcahr
        SET @class = SUBSTRING(@class, 2, 1) -- Added SET
        SELECT  @return = CASE @class
                            WHEN '1' THEN 'first'
                            WHEN '2' THEN 'second'
                            WHEN '3' THEN 'third'
                            WHEN '4' THEN 'fourth'
                            ELSE 'unknown'
                          END
        RETURN @return
    END

GO 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-19T00:29:11.073

请尝试如下，在您的声明中返回（s）丢失。

```
create function returnGrade
(
    @class char(4)
)
returns varchar(10)
AS
BEGIN
    declare @return varchar(10)
    set @class = SUBSTRING(@class, 2, 1)
      SELECT @return = CASE @class
      WHEN '1' then 'first'
      WHEN '2' then 'second'
      WHEN '3' then 'third'
      WHEN '4' then 'fourth'
      ELSE 'unknown'
    END

    return @return
END 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-19T00:25:16.993

你的代码： `declare @return varcahr(10)`

拼写错误和使用保留字。

`declare @ret varchar(10)`

# php - 尝试通过 php 获取当前和下一个时间表

> ID：10219993
> 
> 赞同：0
> 
> 时间：2012-04-19T00:22:38.403
> 
> 标签：php, mysql

我做了一个php程序

该节目显示频道时间表

在频道页面中，我想显示当前节目和下一个节目，

在时间表表中，我在名为“when”的单元格中插入程序的时间

```
select when from Schedules where channel_id = 13 
```

这将在时间戳中显示所有程序的时间

我只想输出当前程序，只输出下一个程序

* * *

抱歉英语不好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T00:32:42.690

假设`when`列是`DATETIME`类型：

```
( SELECT * FROM Schedules where channel_id = 13 AND when <= NOW() ORDER BY when DESC LIMIT 1 )
UNION
( SELECT * FROM Schedules where channel_id = 13 AND when > NOW() ORDER BY when ASC LIMIT 1 ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-19T00:37:56.263

我没有什么可以测试的，但是这个查询将获得频道 id 13 的所有时间表，这些时间表是在 $time 之后或之后安排的，我们按时间按 asc 顺序对所有这些结果进行排序，最后选择其中的前两个（这将是 $time 时的程序，之后的下一个程序）

```
SELECT field1,field2,when FROM Schedules where channel_id = 13 AND 
when >= $time ORDER BY when ASC LIMIT 2 
```

根据需要填写 field1、field2 和 $time 变量。

# c# - 设置wp7点击事件的振动长度

> ID：10219995
> 
> 赞同：0
> 
> 时间：2012-04-19T00:23:27.827
> 
> 标签：c#, windows-phone-7, xaml

我正在尝试根据点击事件设置振动。该代码有效，但是我试图将按钮单击事件的振动长度与实际手机硬件按钮的振动长度相匹配。这就是我现在正在使用的，它似乎匹配得很好。

```
VibrateController.Default.Start(TimeSpan.FromMilliseconds(40)); 
```

这是正确的长度吗？如果没有，有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-19T07:28:00.570

您可能会对以下博客文章感兴趣：-

[http://blog.xyzzer.me/2012/01/09/vibration-behaviors-for-windows-phone-part-1/](http://blog.xyzzer.me/2012/01/09/vibration-behaviors-for-windows-phone-part-1/)

似乎作者已经解决了 20ms 的持续时间。

# sql-server - 异常块未捕获的不存在列上的选择语句

> ID：10219997
> 
> 赞同：3
> 
> 时间：2012-04-19T00:23:28.763
> 
> 标签：sql-server

由于 X_TEST 列不存在，我预计会出现错误。但是错误没有被异常块捕获。

```
BEGIN TRY
   SELECT X_TEST FROM ACCOUNTS 
END TRY
BEGIN CATCH
   PRINT 'There was an error! ' + ERROR_MESSAGE()
END CATCH 
```

为什么 ？是因为错误的严重性吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-19T01:25:15.643

不，TRY 只能处理其自身范围内的某些类型的错误。现在，你说你有一个看起来像这样的存储过程（在`non_existent_column`被删除之后）：

```
CREATE PROCEDURE dbo.blat
AS
BEGIN
  BEGIN TRY
    SELECT non_existent_column FROM dbo.table_that_exists;
  END TRY
  BEGIN CATCH
    PRINT ERROR_MESSAGE();
  END CATCH
END
GO 
```

如果你只是这样做......

```
EXEC dbo.blat; 
```

...您将因编译错误而受到重创，因为该 TRY 范围内的语句无法解析：

```
Msg 207, Level 16, State 1, Procedure fooblat, Line 5
Invalid column name 'non_existent_column'. 
```

但是，您可以在外部范围内捕获此错误（无论过程是否`TRY/CATCH`存在）：

```
BEGIN TRY
  EXEC dbo.fooblat;
END TRY
BEGIN CATCH
  PRINT 'There was an error:';
  PRINT ERROR_MESSAGE();
END CATCH 
```

结果（注意这不是例外，文本不再是红色）：

```
There was an error:
Invalid column name 'non_existent_column'. 
```

您也可以使用动态 SQL 来避免这种情况，但似乎您已经将其击落，所以这是我能想到的下一个最佳建议 - 在外部范围内捕获错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-19T00:28:12.490

使用不存在的列是语法错误。您的批处理甚至从未开始执行。

考虑这段代码：

```
BEGIN TRY
   sdgedtju§$%&/()= 
END TRY
BEGIN CATCH
   PRINT 'There was an error! ' + ERROR_MESSAGE()
END CATCH 
```

你不会期望它甚至开始，对吧？它不编译。使用不存在的列是一样的

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-19T00:36:18.760

这段代码会给你你期望看到的行为......

```
BEGIN TRY
   exec('SELECT X_TEST FROM ACCOUNTS')
END TRY
BEGIN CATCH
   PRINT 'There was an error! ' + ERROR_MESSAGE()
END CATCH 
```