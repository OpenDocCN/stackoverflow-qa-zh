# StackOverflow 问答 000736000-000736999

# vim - 在 PuTTY 中创建 ctrl+tab 键绑定

> ID：736004
> 
> 赞同：18
> 
> 时间：2009-04-09T21:34:26.690
> 
> 标签：vim, terminal, putty

我希望能够分别映射 vim 命令`:tabnext`和`:tabprev`到`CTRL+TAB`和`CTRL+SHIFT+TAB`。不幸的是，我似乎遇到了 PuTTY 吃掉这些字符组合的问题。

我已经尝试搜索信息，但无济于事。我很确定这是一个 PuTTY 的东西，但似乎没有任何类型的应用程序帮助/参考区域。

我很好奇这里是否有人有任何经验或建议来解决这个问题。

*@rmeador：尝试在 vim 中映射组合键。*
我试图这样做，但似乎 vim 并没有得到组合。我不确定这是否与术语设置或 PuTTY 问题有关。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-25T19:46:24.057

`Ctrl`当您按+时，PuTTY 不会发送任何内容`Tab`。

您可以按照此处所述修补 PuTTY：[在 PuTTY 上的 GNU Screen 中](http://scnr.net/blog/index.php/archives/61)[使用`Ctrl`+`Tab`](http://scnr.net/blog/index.php/archives/61)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T06:43:06.153

我相信此时，在 PuTTY 中使用`Ctrl`+`Tab`是不可能的，因为 PuTTY 不允许您为键配置特定的翻译。这是一篇不错的文章，展示了如果 PuTTY 确实支持此功能，您将如何进行设置：

[http://www.staldal.nu/tech/2009/01/10/how-to-use-ctrl-tab-in-gnu-screen/](http://www.staldal.nu/tech/2009/01/10/how-to-use-ctrl-tab-in-gnu-screen/)

如果您使用（或考虑使用）像 Autohotkey 这样的热键/宏程序，您可以自己模拟这种行为。例如，这个 Autohotkey 配置脚本会做你想要的：

```
#IfWinActive PuTTY
^Tab::Send :tabnext
^+Tab::Send :tabprev
#IfWinActive 
```

（请注意，此示例只是查找以 PuTTY 开头的任何窗口标题，因此您必须根据标题配置进行调整。）

# c# - 扩展此正则表达式以删除所有特殊字符

> ID：736010
> 
> 赞同：-1
> 
> 时间：2009-04-09T21:36:37.323
> 
> 标签：c#, regex

如何扩展它以删除任何特殊字符，例如`:` `;` `,`等，但仍然执行它现在所做的删除`<div>`标签：

```
string BBCSplit = Regex.Replace(BBC, @"<(.|\n)*?>", string.Empty); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T21:42:34.440

```
string BBCSplit = Regex.Replace(BBC, @"<(.|\n)*?>|[:;]", string.Empty); 
```

如果您要删除的“特殊”字符包括“”、“]”等，请小心——您需要在它们之前放置一个“\”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T21:38:23.280

您可以使用交替字符（竖线或 |）添加更多内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T22:16:35.013

在 RegEx 中有很多方法可以做到这一点，Markus 删除引号、括号、换行符和标点符号的答案是：（请记住在 @ 字符串中加倍双引号）

```
@"<(.|\n)*?>|[:;,!@#$%^&*()-_+='""[\]]" 
```

另一种方法是删除任何非空格和非字母数字字符。

```
@"<(.|\n)*?>|[^\s\w]" 
```

我建议对您的 RegEx 更加严格。如果您只想删除标签，请使用：

```
@"</?\w*(.|\s)*?>|[^ \w]" 
```

# java - 查询兵马俑

> ID：736016
> 
> 赞同：2
> 
> 时间：2009-04-09T21:43:21.753
> 
> 标签：java, caching, jakarta-ee, terracotta

有什么方法可以查询 Terracotta 实例存储的对象吗？

我正在寻找类似 SQL 的查询或任何基于字段过滤对象的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T23:29:45.540

最近有一篇关于这个主题的好博客：[Querying Java Objects stored in Terracotta's NAM](http://tusharkhairnar.blogspot.com/2009/04/querying-java-objects-stored-in.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-09T08:31:21.823

JOSQL 是对所有集合的迭代，因此如果对象数量很大，它可能会更慢。

您可以阅读帖子[http://tusharkhairnar.blogspot.com/2009/05/querying-java-objects-stored-in.html](http://tusharkhairnar.blogspot.com/2009/05/querying-java-objects-stored-in.html)以实现索引，以便快速查询。

Forge 网站上发布了 tim-searchable，它具有更多功能并使用 Lucene 框架。

问候图沙尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-23T16:42:24.747

至少企业版有自己的搜索API：

[http://www.terracotta.org/documentation/enterprise-ehcache/api-guide#enterprise-ehcache-search-api-for-clustered-caches](http://www.terracotta.org/documentation/enterprise-ehcache/api-guide#enterprise-ehcache-search-api-for-clustered-caches)

> ID：736021
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# javascript - jQuery UI 可排序，每个可排序的 div 包含一个 iFrame 在 FF3 中刷新，但在 IE7 中不刷新

> ID：736023
> 
> 赞同：3
> 
> 时间：2009-04-09T21:46:39.407
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-sortable

我在包含 DIV 标签的 DIV 上使用 jQuery UI Sortable。每个可排序的 DIV 内部都有一个 iFrame，其 src= 指向不同的站点。

在 IE7 中，排序按预期工作。如果您在 iFrame 中导航，则 iFrame 将保留当前状态。

但是，在 FF3 中，当排序停止并使用指定的原始 url 重新加载 iFrame 时。这不是我想要的。

我尝试过同时使用 DIV/DIV 和 UL/LI，它们的行为相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T22:51:39.563

这是 FF 中的一个错误（显然是 Safari 3.5/Win 和 Opera 9.5/Win）：如果在 DOM 树中移动，iframe 会重新加载。（当你删除它时，jQuery sortable 会移动 DOM 树中的节点）。

请参阅[https://bugzilla.mozilla.org/show_bug.cgi?id=254144](https://bugzilla.mozilla.org/show_bug.cgi?id=254144)。

我之前解决这个问题的方法是指定一些附加到 iframe 父级的区域作为 jQuery 可排序操作的“句柄”。例如：

```
+-----------------------+
| Drag Me | iframe here |
+---------+             |
          |             |
          +-------------+ 
```

您拖动“句柄”，而不是实际的 iframe 容器。在 Drop 时，您重新排列句柄，将 iframe 留在 DOM 中的位置。这在我的情况下效果很好，但 YMMV。

# asp.net-mvc - 基于请求uri主机的路由

> ID：736024
> 
> 赞同：3
> 
> 时间：2009-04-09T21:46:43.527
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

所以这个问题的基本前提是我有一个带有两个域名的托管网络空间。我不确定如何在 asp.net mvc 中配置路由，这样我首先要检查的是请求对象中的这个主机，这样我就可以将更多的用户流量传输到我网站的两个不同部分。

例如：

```
http://www.mywebsite1.com/products/14

http://www.mywebsite2.com/products/14 
```

您如何路由以使上面的这两个 url 最终根据请求中使用的主机的上下文返回两个不同的页面？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T07:42:32.600

您需要实现一个自定义视图引擎，该引擎将查看 URL 后控制器执行并选择正确的视图。

查看更多信息：[Asp.Net 主题](http://pietschsoft.com/post/2009/03/ASPNET-MVC-Implement-Theme-Folders-using-a-Custom-ViewEngine.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-10T21:48:35.857

您还可以在 IIS7 或您使用的任何东西中使用某种 URL 重写，因为它也可以访问域名部分。例如，您可以创建一个将域名注入 url 的重写方法，例如：

http//www.example1.org/Something/1 --> http//www.example1.org/example1/Something/1 http//www.example2.org/Something/1 --> http//www.example2 .org/example2/Something/1

而且因为现在域名在 URL 字符串中，您可以使用默认路由引擎将此信息发送到控制器或执行其他操作。

# wix - 使用 WiX，如何根据安装时可用的内容将单个文件安装到（可能）多个子目录？

> ID：736041
> 
> 赞同：4
> 
> 时间：2009-04-09T21:51:50.610
> 
> 标签：wix, windows-installer

我正在使用 WiX，并且想知道获取文件并将其安装到特定位置的每个可用子目录所需的 .wxs。这可能意味着 0 个或多个最终安装位置，在安装时根据当前存在的目录结构确定。例如，如果我开始安装：

```
\target
 \subdir-1
 \subdir-2 
```

然后在安装结束时，我的文件将位于 \subdir-1 和 \subdir-2 中。另一方面，如果在开始安装时系统上不存在这些目录，则根本不会安装我的文件，也不会创建子目录。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T21:56:32.393

Afaik 这对于 WiX 是不可能的（因为将组件安装到多个位置基本上违反了 MSI 的性质）。

你也可以

*   为每个子文件夹创建不同的组件，或
*   使用自定义操作将组件复制到所有子文件夹。

在后一种情况下，您还应该为卸载提供相应的 CA，从而再次从子文件夹中删除所有文件。

编辑：似乎我上面的答案并不完全正确。MSI 支持使用[DuplicateFile](http://msdn.microsoft.com/en-us/library/aa368335.aspx)表复制文件，并且 WiX 3.0 还提供了一种称为[“smart cabbing”](http://robmensching.com/blog/posts/2007/6/1/quotSmart-cabbingquot-added-to-WiX-toolset)的机制。两者都在Aaron Stebner的[博客文章中提到。](http://blogs.msdn.com/astebner/archive/2008/01/07/7022536.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T04:02:28.020

如果您的目标是 Vista（或 Win2k8，不确定 Win2k3），您可以使用`mklink`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-11T18:33:12.507

并非没有自定义操作，您需要编写一个自定义操作来执行此操作。
最新最好的自定义操作是Wix3 附带的[DTF](http://robmensching.com/blog/posts/2008/5/16/Deployment-Tools-Foundation-joins-the-WiX-toolset)（[和此处）框架。](http://blog.torresdal.net/2008/09/03/WiXAndDTFIntroduction.aspx)

# jms - 使用 JMeter 对 JMS 消息队列进行功能测试

> ID：736042
> 
> 赞同：2
> 
> 时间：2009-04-09T21:51:54.433
> 
> 标签：jms, jmeter

我有一个 REST 服务，可以响应请求，在 JMS 队列上发布消息。所有主要的 http 功能测试都是使用 JMeter 完成的，所以我想知道是否有人成功地将 JMS 消息从 JMeter 中的现有队列中拉出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T23:45:31.010

JMeter 不会做这样的事情，但是您编写的用于扩展 MessageListener、向队列注册并让 JMeter 在 JUnit 测试中实例化的类当然可以。我建议您将消费和测试分开。编写 MessageListener，让它工作，然后弄清楚如何将它连接到 JMeter。

# python - 检查字符串是否可以在 Python 中转换为浮点数

> ID：736043
> 
> 赞同：254
> 
> 时间：2009-04-09T21:52:33.463
> 
> 标签：python, string, type-conversion

我有一些 Python 代码，它们通过字符串列表运行，并尽可能将它们转换为整数或浮点数。对整数执行此操作非常容易

```
if element.isdigit():
  newelement = int(element) 
```

浮点数更难。现在我正在使用`partition('.')`拆分字符串并检查以确保一侧或两侧都是数字。

```
partition = element.partition('.')
if (partition[0].isdigit() and partition[1] == '.' and partition[2].isdigit()) 
    or (partition[0] == '' and partition[1] == '.' and partition[2].isdigit()) 
    or (partition[0].isdigit() and partition[1] == '.' and partition[2] == ''):
  newelement = float(element) 
```

这行得通，但显然 if 语句有点熊。我考虑的另一个解决方案是将转换包装在 try/catch 块中，看看它是否成功，如[本问题](https://stackoverflow.com/questions/354038/checking-if-string-is-a-number-python)所述。

有人有其他想法吗？关于分区和 try/catch 方法的相对优点的意见？

* * *

## 回答 #1

> 赞同：381
> 
> 时间：2009-04-09T21:55:39.307

我只会用..

```
try:
    float(element)
except ValueError:
    print "Not a float" 
```

..这很简单，而且有效。请注意，如果元素是例如 1<<1024，它仍然会抛出 OverflowError。

另一种选择是正则表达式：

```
import re
if re.match(r'^-?\d+(?:\.\d+)$', element) is None:
    print "Not float" 
```

* * *

## 回答 #2

> 赞同：266
> 
> 时间：2014-01-05T03:56:52.983

## 检查浮点数的 Python 方法：

```
def is_float(element: Any) -> bool:
    try:
        float(element)
        return True
    except ValueError:
        return False 
```

始终进行单元测试。什么是浮动，什么不是浮动可能会让您感到惊讶：

```
Command to parse                        Is it a float?  Comment
--------------------------------------  --------------- ------------
print(isfloat(""))                      False
print(isfloat("1234567"))               True 
print(isfloat("NaN"))                   True            nan is also float
print(isfloat("NaNananana BATMAN"))     False
print(isfloat("123.456"))               True
print(isfloat("123.E4"))                True
print(isfloat(".1"))                    True
print(isfloat("1,234"))                 False
print(isfloat("NULL"))                  False           case insensitive
print(isfloat(",1"))                    False           
print(isfloat("123.EE4"))               False           
print(isfloat("6.523537535629999e-07")) True
print(isfloat("6e777777"))              True            This is same as Inf
print(isfloat("-iNF"))                  True
print(isfloat("1.797693e+308"))         True
print(isfloat("infinity"))              True
print(isfloat("infinity and BEYOND"))   False
print(isfloat("12.34.56"))              False           Two dots not allowed.
print(isfloat("#56"))                   False
print(isfloat("56%"))                   False
print(isfloat("0E0"))                   True
print(isfloat("x86E0"))                 False
print(isfloat("86-5"))                  False
print(isfloat("True"))                  False           Boolean is not a float.   
print(isfloat(True))                    True            Boolean is a float
print(isfloat("+1e1^5"))                False
print(isfloat("+1e1"))                  True
print(isfloat("+1e1.3"))                False
print(isfloat("+1.3P1"))                False
print(isfloat("-+1"))                   False
print(isfloat("(1)"))                   False           brackets not interpreted 
```

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2016-07-12T12:52:46.200

```
'1.43'.replace('.','',1).isdigit() 
```

`true`只有当有一个或没有'。'时才会返回。在数字串中。

```
'1.4.3'.replace('.','',1).isdigit() 
```

将返回`false`

```
'1.ww'.replace('.','',1).isdigit() 
```

将返回`false`

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-08-14T03:13:05.940

**TL;博士**：

*   如果您的输入主要是*可以*转换为浮点数的字符串，则该`try: except:`方法是最好的原生 Python 方法。
*   如果您的输入主要是*无法*转换为浮点数的字符串，则正则表达式或分区方法会更好。
*   如果您 1) 不确定您的输入或需要更快的速度，并且 2) 不介意并且可以安装第三方 C 扩展，[那么 fastnumbers](https://pypi.org/project/fastnumbers)可以很好地工作。

* * *

[通过名为fastnumbers](https://pypi.org/project/fastnumbers)的第三方模块还有另一种方法可用（披露，我是作者）；它提供了一个名为[isfloat](http://fastnumbers.readthedocs.io/en/master/api.html#fastnumbers.isfloat)的函数。我在[这个答案](https://stackoverflow.com/a/736179/1399279)中采用了 Jacob Gabrielson 概述的 unittest 示例，但添加了该`fastnumbers.isfloat`方法。我还应该注意到，Jacob 的示例对 regex 选项不公平，因为该示例中的大部分时间都用于全局查找，因为点运算符...我已经修改了该函数以提供更公平的比较`try: except:`.

* * *

```
def is_float_try(str):
    try:
        float(str)
        return True
    except ValueError:
        return False

import re
_float_regexp = re.compile(r"^[-+]?(?:\b[0-9]+(?:\.[0-9]*)?|\.[0-9]+\b)(?:[eE][-+]?[0-9]+\b)?$").match
def is_float_re(str):
    return True if _float_regexp(str) else False

def is_float_partition(element):
    partition=element.partition('.')
    if (partition[0].isdigit() and partition[1]=='.' and partition[2].isdigit()) or (partition[0]=='' and partition[1]=='.' and partition[2].isdigit()) or (partition[0].isdigit() and partition[1]=='.' and partition[2]==''):
        return True
    else:
        return False

from fastnumbers import isfloat

if __name__ == '__main__':
    import unittest
    import timeit

    class ConvertTests(unittest.TestCase):

        def test_re_perf(self):
            print
            print 're sad:', timeit.Timer('ttest.is_float_re("12.2x")', "import ttest").timeit()
            print 're happy:', timeit.Timer('ttest.is_float_re("12.2")', "import ttest").timeit()

        def test_try_perf(self):
            print
            print 'try sad:', timeit.Timer('ttest.is_float_try("12.2x")', "import ttest").timeit()
            print 'try happy:', timeit.Timer('ttest.is_float_try("12.2")', "import ttest").timeit()

        def test_fn_perf(self):
            print
            print 'fn sad:', timeit.Timer('ttest.isfloat("12.2x")', "import ttest").timeit()
            print 'fn happy:', timeit.Timer('ttest.isfloat("12.2")', "import ttest").timeit()

        def test_part_perf(self):
            print
            print 'part sad:', timeit.Timer('ttest.is_float_partition("12.2x")', "import ttest").timeit()
            print 'part happy:', timeit.Timer('ttest.is_float_partition("12.2")', "import ttest").timeit()

    unittest.main() 
```

* * *

在我的机器上，输出是：

```
fn sad: 0.220988988876
fn happy: 0.212214946747
.
part sad: 1.2219619751
part happy: 0.754667043686
.
re sad: 1.50515985489
re happy: 1.01107215881
.
try sad: 2.40243887901
try happy: 0.425730228424
.
----------------------------------------------------------------------
Ran 4 tests in 7.761s

OK 
```

如您所见，正则表达式实际上并不像最初看起来那么糟糕，如果您真的需要速度，那么该`fastnumbers`方法非常好。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2018-05-23T17:47:37.697

只是为了多样化，这是另一种方法。

```
>>> all([i.isnumeric() for i in '1.2'.split('.',1)])
True
>>> all([i.isnumeric() for i in '2'.split('.',1)])
True
>>> all([i.isnumeric() for i in '2.f'.split('.',1)])
False 
```

编辑：我确信它不会支持所有的浮动情况，尤其是当有指数时。为了解决这个问题，它看起来像这样。这将返回 True，只有 val 是浮点数，而 False 表示 int，但性能可能不如正则表达式。

```
>>> def isfloat(val):
...     return all([ [any([i.isnumeric(), i in ['.','e']]) for i in val],  len(val.split('.')) == 2] )
...
>>> isfloat('1')
False
>>> isfloat('1.2')
True
>>> isfloat('1.2e3')
True
>>> isfloat('12e3')
False 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-09T22:56:46.650

如果您关心性能（我不建议您这样做），那么基于尝试的方法显然是赢家（与基于分区的方法或正则表达式方法相比），只要您不期望很多无效字符串，在这种情况下它可能会变慢（可能是由于异常处理的成本）。

再说一次，我不是建议你关心性能，只是给你数据，以防你每秒执行 100 亿次，或者其他什么。此外，基于分区的代码不处理至少一个有效字符串。

```
$ ./floatstr.py
F..
分区伤心：3.1102449894
分区快乐：2.09208488464
..
再伤心：7.76906108856
重新开心：7.09421992302
..
尝试悲伤：12.1525540352
尝试快乐：1.44165301323
.
==================================================== =====================
失败：test_partition (__main__.ConvertTests)
-------------------------------------------------- --------------------
回溯（最近一次通话最后）：
  文件“./floatstr.py”，第 48 行，在 test_partition
    self.failUnless(is_float_partition("20e2"))
断言错误

-------------------------------------------------- --------------------
在 33.670 秒内运行 8 次测试

失败（失败=1）

```

这是代码（Python 2.6，正则表达式取自 John Gietzen 的[答案](https://stackoverflow.com/questions/736043/checking-if-a-string-can-be-converted-to-float-in-python/736117#736117)）：

```
def is_float_try(str):
    try:
        float(str)
        return True
    except ValueError:
        return False

import re
_float_regexp = re.compile(r"^[-+]?(?:\b[0-9]+(?:\.[0-9]*)?|\.[0-9]+\b)(?:[eE][-+]?[0-9]+\b)?$")
def is_float_re(str):
    return re.match(_float_regexp, str)

def is_float_partition(element):
    partition=element.partition('.')
    if (partition[0].isdigit() and partition[1]=='.' and partition[2].isdigit()) or (partition[0]=='' and partition[1]=='.' and pa\
rtition[2].isdigit()) or (partition[0].isdigit() and partition[1]=='.' and partition[2]==''):
        return True

if __name__ == '__main__':
    import unittest
    import timeit

    class ConvertTests(unittest.TestCase):
        def test_re(self):
            self.failUnless(is_float_re("20e2"))

        def test_try(self):
            self.failUnless(is_float_try("20e2"))

        def test_re_perf(self):
            print
            print 're sad:', timeit.Timer('floatstr.is_float_re("12.2x")', "import floatstr").timeit()
            print 're happy:', timeit.Timer('floatstr.is_float_re("12.2")', "import floatstr").timeit()

        def test_try_perf(self):
            print
            print 'try sad:', timeit.Timer('floatstr.is_float_try("12.2x")', "import floatstr").timeit()
            print 'try happy:', timeit.Timer('floatstr.is_float_try("12.2")', "import floatstr").timeit()

        def test_partition_perf(self):
            print
            print 'partition sad:', timeit.Timer('floatstr.is_float_partition("12.2x")', "import floatstr").timeit()
            print 'partition happy:', timeit.Timer('floatstr.is_float_partition("12.2")', "import floatstr").timeit()

        def test_partition(self):
            self.failUnless(is_float_partition("20e2"))

        def test_partition2(self):
            self.failUnless(is_float_partition(".2"))

        def test_partition3(self):
            self.failIf(is_float_partition("1234x.2"))

    unittest.main() 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2018-09-15T18:04:01.520

**函数的简化版本，** `is_digit(str)`在大多数情况下就足够了（不考虑*指数符号*和*“NaN”*值）：

```
def is_digit(str):
    return str.lstrip('-').replace('.', '').isdigit() 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-09T22:30:52.780

此正则表达式将检查科学浮点数：

```
^[-+]?(?:\b[0-9]+(?:\.[0-9]*)?|\.[0-9]+\b)(?:[eE][-+]?[0-9]+\b)?$ 
```

但是，我相信您最好的选择是尝试使用解析器。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-10-08T09:50:32.530

如果您不需要担心数字的科学或其他表达式，并且只使用可能是带句点或不带句点的数字的字符串：

**功能**

```
def is_float(s):
    result = False
    if s.count(".") == 1:
        if s.replace(".", "").isdigit():
            result = True
    return result 
```

**Lambda 版本**

```
is_float = lambda x: x.replace('.','',1).isdigit() and "." in x 
```

**例子**

```
if is_float(some_string):
    some_string = float(some_string)
elif some_string.isdigit():
    some_string = int(some_string)
else:
    print "Does not convert to int or float." 
```

这样您就不会意外地将应该是 int 的内容转换为 float。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-10-15T21:15:58.467

我使用了已经提到的函数，但很快我注意到字符串为“Nan”、“Inf”及其变体被视为数字。因此，我建议您改进该函数的版本，该版本将在这些类型的输入上返回 false 并且不会使“1e3”变体失败：

```
def is_float(text):
    # check for nan/infinity etc.
    if text.isalpha():
        return False
    try:
        float(text)
        return True
    except ValueError:
        return False 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-02-19T13:20:51.980

您可以使用`try`- `except`-`else`子句，这将捕获当传递的值无法转换为浮点数时引发的任何转换/值错误

* * *

```
 def try_parse_float(item):
      result = None
      try:
        float(item)
      except:
        pass
      else:
        result = float(item)
      return result 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-03-18T08:18:50.070

我一直在寻找一些类似的代码，但看起来使用 try/excepts 是最好的方法。这是我正在使用的代码。如果输入无效，它包括重试功能。我需要检查输入是否大于 0，如果是，则将其转换为浮点数。

```
def cleanInput(question,retry=False): 
    inputValue = input("\n\nOnly positive numbers can be entered, please re-enter the value.\n\n{}".format(question)) if retry else input(question)
    try:
        if float(inputValue) <= 0 : raise ValueError()
        else : return(float(inputValue))
    except ValueError : return(cleanInput(question,retry=True))

willbefloat = cleanInput("Give me the number: ") 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-12-31T15:44:10.130

尝试转换为浮动。如果有错误，打印 ValueError 异常。

```
try:
    x = float('1.23')
    print('val=',x)
    y = float('abc')
    print('val=',y)
except ValueError as err:
    print('floatErr;',err) 
```

输出：

```
val= 1.23
floatErr: could not convert string to float: 'abc' 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-09-13T11:15:29.100

将字典作为参数传递，它将转换可以转换为浮点数的字符串并保留其他字符串

```
def covertDict_float(data):
        for i in data:
            if data[i].split(".")[0].isdigit():
                try:
                    data[i] = float(data[i])
                except:
                    continue
        return data 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-04-03T22:09:04.743

我尝试了上面一些简单的选项，围绕转换为浮点数进行了尝试测试，发现大多数回复都存在问题。

简单测试（按照上述答案）：

```
entry = ttk.Entry(self, validate='key')
entry['validatecommand'] = (entry.register(_test_num), '%P')

def _test_num(P):
    try: 
        float(P)
        return True
    except ValueError:
        return False 
```

问题出现在：

*   您输入“-”以开始一个负数：

然后你正在尝试`float('-')`失败

*   您输入一个数字，然后尝试删除所有数字

然后你正在尝试`float('')`同样也失败了

我的快速解决方案是：

```
def _test_num(P):
    if P == '' or P == '-': return True
    try: 
        float(P)
        return True
    except ValueError:
        return False 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2021-02-26T03:19:08.557

似乎很多正则表达式都会错过一件事或另一件事。到目前为止，这一直对我有用：

```
(?i)^\s*[+-]?(?:inf(inity)?|nan|(?:\d+\.?\d*|\.\d+)(?:e[+-]?\d+)?)\s*$ 
```

它允许带有符号、nan、小数点前没有数字和前导/尾随空格（如果需要）的无穷大（或 inf）。`^`需要and`$`来避免部分匹配`1.2f-2`as之类的东西`1.2`。

如果您需要解析一些用于双精度科学记数法的文件，您可以使用`[ed]`而不是。您可能想在之后替换它，或者在检查之前替换它们，因为该功能不允许这样做。`e``D``float()`

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-04-30T04:43:51.437

我找到了一种可行的方法。需要验证这一点。第一次在这里放东西。

```
def isfloat(a_str):
    try:
        x=float(a_str)
        if x%1 == 0:
            return False
        elif x%1 != 0: #an else also do
            return True
    except Exception as error:
            return False 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-04-30T16:56:29.060

这就像一个魅力：

```
[dict([a,int(x) if isinstance(x, str)
 and x.isnumeric() else float(x) if isinstance(x, str)
 and x.replace('.', '', 1).isdigit() else x] for a, x in json_data.items())][0] 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-10-25T08:43:03.447

我已经编写了自己的函数。我使用 floatN() 或 floatZ() 而不是 float(value)。如果不能将值转换为浮点数，则返回 None 或 0.0。我将它们保存在我称为 safeCast 的模块中。

```
def floatN(value):
    try:
        if value is not None:
            fvalue = float(value)
        else:
            fvalue = None
    except ValueError:
        fvalue = None

    return fvalue

def floatZ(value):
    try:
        if value is not None:
            fvalue = float(value)
        else:
            fvalue = 0.0
    except ValueError:
        fvalue = 0.0

    return fvalue 
```

在其他模块中，我导入它们

```
from safeCasts import floatN, floatZ 
```

然后使用 floatN(value) 或 floatZ(value) 而不是 float()。显然，您可以将此技术用于您需要的任何强制转换功能。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2022-01-30T22:23:21.093

这是一个简单但有趣的问题。下面提出的解决方案对我来说很好：

```
import re

val = "25,000.93$"

regex = r"\D"

splitted = re.split(regex, val)
splitted = list(filter(str.isdecimal, splitted))

if splitted:
    if len(splitted) > 1:
        splitted.insert(-1, ".")

    try:
        f = float("".join(splitted))
        print(f, "is float.")

    except ValueError:
        print("Not a float.")

else:
    print("Not a float.") 
```

**重要说明**`splitted`：此解决方案基于最后一个值包含小数位的假设。

* * *

## 回答 #21

> 赞同：-2
> 
> 时间：2020-12-20T13:02:00.923

我们可以将正则表达式用作： `import re if re.match('[0-9]*.?[0-9]+', <your_string>): print("Its a float/int") else: print("Its something alien")` 让我用英语解释正则表达式，

*   * -> 0 次或多次出现
*   + -> 1 次或多次出现
*   ? -> 0/1 出现

现在，让我们转换

*   '[0-9]* -> 让 0-9 之间出现 0 个或多个数字
*   \.? -> 后跟一个 0 或一个 '.'（如果您需要检查它是否可以是 int/float 否则我们也可以使用代替 ?，使用 {1}）
*   [0-9]+ -> 后跟 0-9 之间出现 0 个或多个数字

* * *

## 回答 #22

> 赞同：-3
> 
> 时间：2016-09-24T02:20:47.410

```
str(strval).isdigit() 
```

似乎很简单。

处理存储为字符串或 int 或 float 的值

# wpf - Silverlight：层次结构树视图的自定义模板

> ID：736045
> 
> 赞同：3
> 
> 时间：2009-04-09T21:52:57.410
> 
> 标签：wpf, silverlight, xaml, controls

我正在使用 silverlight 并希望以以下格式动态生成层次结构树：

[层次结构树视图 http://img21.imageshack.us/img21/4889/treeview.jpg](http://img21.imageshack.us/img21/4889/treeview.jpg)

由于 Silverlight 控件是无外观的，我如何构建最终看起来像图像的模板？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T21:05:04.740

我已经在 WPF 中做到了这一点，但不是 Silverlight。现在手头没有代码，但我使用的两个资源是：

*   [WPF 中的自定义 TreeView 布局](http://www.codeproject.com/KB/WPF/CustomTreeViewLayout.aspx)
*   [将树视图转换为组织结构图（使用连接器！）](http://wpfblog.info/2008/05/26/turning-a-treeview-into-an-org-chart-with-connectors/)

布局位并不难。连接器有点困难，尤其是在东西四处移动的情况下。

# iphone - 以编程方式打开设置应用程序 (iPhone)

> ID：736047
> 
> 赞同：20
> 
> 时间：2009-04-09T21:53:56.473
> 
> 标签：iphone, cocoa-touch

目前是否可以从第三方 iPhone 应用程序访问 Apple 的设置应用程序？目前可以打开邮件、safari 等。设置呢？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2011-10-12T00:38:38.257

从 iOS 5.0 开始，您可以使用`"prefs://"`URL 方案打开设置应用程序。您对早期版本不走运。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-26T16:09:38.463

Yatheesha 的建议是正确的，但在 Xcode 7.0/swift 2 下失败。

利用：

```
UIApplication.sharedApplication().openURL(NSURL(string: UIApplicationOpenSettingsURLString)!) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T02:54:28.200

我不相信。这将是一个受欢迎的补充，您应该提出请求。有邮件、短信等的 url 方案，但没有设置。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-04-10T02:59:30.420

抱歉，当前版本的 API 无法做到这一点。

也就是说，您当然可以与特定应用程序的设置进行交互。理论上，如果必须，您可以重新创建与设置应用程序相同的视觉体验。

# asp.net - 使用 jQuery Ajax 将参数传递给 WebMethod

> ID：736058
> 
> 赞同：13
> 
> 时间：2009-04-09T21:57:12.877
> 
> 标签：asp.net, jquery, web-services, json, parameters

我有一个简单的 web 方法和 ajax 调用，并继续收到一个错误，说它不能将字符串转换为 IDictionary 对象？？？

这是ajax调用：

```
var params = '{"ID":"' + rowid + '"}';
$.ajax({
  url: 'EDI.asmx/GetPartnerDetails',
  type: "POST",
  contentType: "application/json; charset=utf-8",
  data: JSON.stringify(params),
  dataType: "json", //not json . let me try to parse
  success: function(msg, st) { . . . . 
```

这是网络方法：

```
<WebMethod()> _
Public Function GetPartnerDetails(ByVal ID As String) As String

    'Dim objParam As IDictionary = CType(JsonConvert.DeserializeObject(ID), IDictionary)
    'Dim rowID As String = objParam("ID")

    Dim objController As New HealthComp.BLL.X12Partners.TradingPartnersController
    Dim objInfo As TradingPartnersInfo = objController.FetchByPartnerID(Int32.Parse(ID))

    Return JsonConvert.SerializeObject(objInfo)
End Function 
```

这是我从 FireBug 看到的：

响应标头
服务器：Microsoft-IIS/5.1
日期：2009 年 4 月 9 日星期四 21:43:59 GMT
jsonerror:true
Cache-Control:private
Content-Type:application/json; charset=utf-8
内容长度：1331

POST: "{\"ID\":\"4\"}"

回复：

{"Message":"无法将类型 \u0027System.String\u0027 的对象转换为类型 \u0027System.Collections .Generic.IDictionary`2[System.String,System.Object]\u0027","StackTrace":" 在 System. Web.Script.Serialization .ObjectConverter.ConvertObjectToTypeInternal(Object o, Type type, JavaScriptSerializer serializer, Boolean throwOnError, Object& convertObject)\r\n at System.Web.Script.Serialization.ObjectConverter.ConvertObjectToTypeMain (Object o, Type type, JavaScriptSerializer 序列化程序, Boolean throwOnError, Object& convertObject )\r\n 在 System.Web.Script.Serialization.ObjectConverter.ConvertObjectToType(Object o, Type type, JavaScriptSerializer 序列化程序)\r\n 在 System.Web.Script.Serialization.JavaScriptSerializer.Deserialize( JavaScriptSerializer 序列化器，String 输入，Type 类型，Int32 depthLimit)\r\n 在 System.Web.Script.Serialization.JavaScriptSerializer .Deserialize[T]（字符串输入）\r\n 在 System.Web.Script.Services.RestHandler.GetRawParamsFromPostRequest（HttpContext 上下文，JavaScriptSerializer 序列化程序）\ r\n 在 System.Web.Script.Services.RestHandler .GetRawParams(WebServiceMethodData methodData, HttpContext context)\r\n 在 System.Web.Script.Services .RestHandler.ExecuteWebServiceCall(HttpContext context, WebServiceMethodData methodData)","ExceptionType" ：“System.InvalidOperationException”}GetRawParams(WebServiceMethodData methodData, HttpContext context)\r\n at System.Web.Script.Services .RestHandler.ExecuteWebServiceCall(HttpContext context, WebServiceMethodData methodData)","ExceptionType" :"System.InvalidOperationException"}GetRawParams(WebServiceMethodData methodData, HttpContext context)\r\n at System.Web.Script.Services .RestHandler.ExecuteWebServiceCall(HttpContext context, WebServiceMethodData methodData)","ExceptionType" :"System.InvalidOperationException"}

有人对此有任何想法吗？谢谢！！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-09T22:04:14.263

快速项目：

你的变量 params `var params = '{ID:' + rowid + '}';` 是一个字符串。

所以行： `data: JSON.stringify(params),`是多余的（或者应该是）。刚设置`data: params,`

接下来，在您的 Web 方法中，将结果转换为 JSON 字符串并将其作为字符串返回。如果您的 Web 方法类具有 ScriptMethod 属性，则不需要这样做。只需将数据作为本机类型返回，Asp.Net 就会为您转换为 JSON。

您可能会阅读以下文章： [http ://elegantcode.com/2009/02/21/javascript-arrays-via-jquery-ajax-to-an-aspnet-webmethod/](http://elegantcode.com/2009/02/21/javascript-arrays-via-jquery-ajax-to-an-aspnet-webmethod/)

[http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/](http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-08T00:15:03.903

除了上述之外，值得检查以确保您没有多次“字符串化”JSON 数组。

我不小心在已经序列化的数组上调用了 JSON.stringify()，这引发了与 OP 收到的类似的问题。

IE

```
var arr = JSON.stringify({ id: elementID, name: Name });
....
$.ajax({
...
data: JSON.stringify(arr),
...
}); 
```

在这种情况下，将*arr*变量初始化更改为

```
var arr = { id: elementID, name: Name }; 
```

解决了我的问题。:)

# c++ - C/C++ 模式到 USE_HEAP 或 USE_STACK

> ID：736061
> 
> 赞同：3
> 
> 时间：2009-04-09T21:59:09.313
> 
> 标签：c++, c, memory-management, stack, heap-memory

有没有办法定义一个宏（或类似的东西），允许对象在堆栈或堆上干净地分配？

例如。当前代码：

```
A a;
a.someFunc(); 
```

最简单的建议可能如下，但正如您在下面看到的，维护 2 组代码并不是很干净。

```
#ifdef USE_STACK
  A a;
  a.someFunc();
#elseif USE_HEAP
  A* a = new A();
  a->someFunc();
#endif 
```

我正在寻找可用于编译代码的设计模式/代理类，具体取决于客户的需求。

编辑：该代码用于为嵌入式设备/（嵌入式）Linux / Windows Mobile 构建库。大多数客户只想要基于堆栈的分配。其他一些人要求用堆栈换堆。

谢谢，查尔斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T22:25:40.000

**编辑**：改进以允许通过调用包装的成员函数`operator->`

扩展 Manuel 的答案以使其更完整，试试这个：

```
#include <iostream>

#define USE_STACK

template <class T>
class HeapWrapper {
#ifdef USE_STACK
    T obj_;
#else
    T *obj_;
#endif
public:
#ifdef USE_STACK
    HeapWrapper() : obj_() {}

    template <class A1>
    HeapWrapper(const A1 &a1) : obj_(a1) {}

    template <class A1, class A2>
    HeapWrapper(const A1 &a1, const A2 &a2) : obj_(a1, a2) {}

    // etc

#else
    HeapWrapper() : obj_(new T()) {}
    ~HeapWrapper() { delete obj_; }

    template <class A1>
    HeapWrapper(const A1 &a1) : obj_(new T(a1)) {}

    template <class A1, class A2>
    HeapWrapper(const A1 &a1, const A2 &a2) : obj_(new T(a1, a2)) {}

    // etc
#endif

#ifdef USE_STACK
    operator const T &() const    { return obj_; }
    operator T &()                { return obj_; }
    T *operator->()               { return &obj_; }
    T& operator*()                { return obj_; }
#else
    operator const T &() const    { return *obj_; }
    operator T &()                { return *obj_; }
    T *operator->()               { return obj_; }
    T& operator*()                { return *obj_; }
#endif

    // cast operators makes this work nicely
    HeapWrapper &operator=(const T &rhs) { *obj_ = rhs; return *this;}
};

class A {
public:
    void member(int x) {
        std::cout << x << std::endl;
    }
};

int main() {
    HeapWrapper<int> x1(5);
    HeapWrapper<int> x2;
    HeapWrapper<int> x3 = x1;
    HeapWrapper<int> x4 = 3;

    std::cout << x1 << " " << x2 << " " << x3 << " " << x4 << std::endl;

    // example using a custom class's members..
    HeapWrapper<A> a1;
    a1->member(5);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T22:06:40.093

这样的事情可能会有所帮助：

```
template <typename T>
class HeapWrapper
{
#ifdef USE_STACK
  T obj_;
#else
  T *obj_;
#endif
public:
#ifdef USE_STACK
  HeapWrapper() : obj_() {}
#else
  HeapWrapper() : obj_(new T()) {}
#endif

#ifdef USE_STACK
  const T& obj() const
  { return obj_; }

  T& obj() const
  { return obj_; }
#else
  const T& obj() const
  { return *obj_; }

  T& obj() const
  { return *obj_; }
#endif
}; 
```

但是，请注意，这要么将您限制为仅具有默认构造函数的对象。包装类可以提供一个函数，该函数可以由包装类的[可变参数模板函数](http://www.osl.iu.edu/~dgregor/cpp/variadic-templates.html)`Init(...)`转发（或者只需为您需要的每个参数添加一个）：`template <typename T1, template T2, [etc]> Init(const T1 &x1, cons tT2 &x2)`

```
template <typename T1>
void Init(const T1& x1)
{
#ifdef USE_STACK
  obj_.Init(x1);
#else
  obj_->Init(x1);
#endif
}

template <typename T1, typename T2>
void Init(const T1& x1, const T2& x2)
{
#ifdef USE_STACK
  obj_.Init(x1, x2);
#else
  obj_->Init(x1, x2);
#endif
} 
```

如果您的编译器已经有[可变参数模板](http://www.osl.iu.edu/~dgregor/cpp/variadic-templates.html)，则加分：

```
template<typename... T>
void foo(const T&... values) {
#ifdef USE_STACK
  obj_.Init(values...);
#else
  obj_->Init(values...);
#endif
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T22:17:06.480

如果您问这个问题，我认为您应该开始研究自定义分配器。对于初学者，如果您分配一大块内存，您可以通过更改分配器内部结构来使用它，就像堆栈或堆一样。您将使用智能指针分配所有对象（以防止内存泄漏），并且所有内存都将从您的自定义堆中分发给您。

这允许您根据客户的需求调整分配实现，同时如果以这种方式调整，还可以为您提供基于堆栈的分配器的性能。

您的代码将始终使用“堆”样式的对象创建，因此您只需要一种编码方式，并且不需要条件宏。检查块分配器（创建几个固定大小的块堆，将下一个大小的第一个空闲块提供给调用者（例如块的大小为 16 字节、32 字节、64 字节等），它的速度非常快allocate 和 free，尽管它在内存使用方面效率低下）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T22:06:18.627

通常堆栈的大小是有限的，因此无论如何都需要在堆上分配任何大对象。

所有实现 RAII 保护习语的实例（例如，获取和释放互斥锁）都需要放在堆栈上，以便在您离开上下文（例如通过返回或异常）时清理它们

让您切换的习语通常不是很有用，因为需要谨慎决定是否将对象放置在堆栈或堆上。通常，其中一个会更好地解决问题，然后切换就没有意义了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T22:17:34.217

不是最终答案，但我希望它可以提供帮助：

```
#ifdef USE_STACK
  A a;
#elseif USE_HEAP
  auto_ptr<A> CAUTION_USE_OF_AUTOPTR_a( new A() );
  A& a = CAUTION_USE_OF_AUTOPTR_a.get();
#endif
a.someFunc(); 
```

# php - 寻找一种干净、有效的方法来将一组数据与已知模式进行匹配

> ID：736063
> 
> 赞同：4
> 
> 时间：2009-04-09T21:59:29.173
> 
> 标签：php, mysql, pattern-matching

使用 php5.2 和 MySQL 4.1.22

我遇到过一些事情，起初看起来很简单，但后来就一个简单、干净的解决方案避开了我。

我们有预定义的产品“包”。包装 1 中可能包含产品 A、B 和 C。包2可能有A、C、D和G等。包的大小从3到5个产品不等。

现在，客户可以选择任何 10 种可用产品并制作“定制”包装。由于我们已经有某些预定义的包，我们希望尽可能使用更小的现有包（为了便于运输）来构建自定义包。

因此，例如，客户选择创建产品 A、B、C、D、E 和 F 的“自定义包”。我们已经有一个包含 A、B 和 C 的预定义包，称为 Foo。因此，顺序将是 Foo、D、E 和 F。

问题在于拥有最少数量的单个物品，其次是最少数量的包裹。例如：

定制包装：A、B、C、D、E、F、G、H、I、J。

预定义包 (1)：A、B、C、D、E

预定义包 (2)：A、B、C

预定义包 (3)：D、E、F

如果我只是选择最大的匹配项，那么我有 1 个（5 件）包裹和 5 个单独的物品。包 (2) 和 (3) 都不能用剩余的项目构建。

如果我更深入地研究，我发现通过不构建包 (1)，我可以构建包 (2) 和包 (3)。这意味着我有 2 个包裹和 4 个单独的物品（在这个商业规则中是一个更好的选择）。

当我使用 MySQL 时，我受限于只有一层子选择可用（据我所知）。所以这种排序需要在 php.ini 中执行。我已经研究过使用 array_intersect() 来确定匹配项，但是随着预定义包的数量线性增长，我发现的每种方式在处理方面都呈指数增长。

我和其他几个程序员朋友一起运行了这个，虽然看起来应该有一个简单的答案，但我们都发现它并不像看起来那么简单。所以，我想我会把它贴在这里作为一个很好的面条担架。非常感谢您抽出宝贵时间！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T22:14:23.193

这个问题通常是一个“困难”的问题（就计算复杂性而言）。事实上，它在我的脑后敲响了一些警钟，它可能会简化为像[背包问题](http://en.wikipedia.org/wiki/Backpack_problem#Further_reading)这样的经典算法问题之一，但我无法为其命名。

但是，由于问题空间如此之小（他们只能选择 10 种产品），因此暴力破解应该很快。当有人提交自定义构建时，只需使用所有可能性递归攻击它，看看哪个是最好的。

也就是说，拿他们选择的组件，首先尝试从中删除“包1”的组件。如果可能，请取出剩余的组件并尝试从中取出“包 2”的组件，等等。跟踪到目前为止您找到的最佳解决方案。

如果它仍然不够快（但我认为它可能会，这取决于你有多少预先构建的包），你可以应用一些[动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)方法来加速它。

* * *

**编辑添加：**

根据可能性的数量和实际运行所需的时间，您可能想要编写我上面描述的代码，然后继续为每个可能的组合预先计算所有解决方案。然后，当有人提交自定义构建时，您只需要获取答案，而不是每次都从头开始计算。

即使您不想全部预先计算，我建议每次有人进行自定义构建时都存储结果，然后将来如果其他人进行相同的自定义构建，您不必重新计算解决方案.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T22:07:15.067

我建议你让客户帮忙。在产品选择屏幕中，显示可用的包装套装，并让他们进行组合（适当定价，以便连体衣的总和足以涵盖特殊处理）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T23:42:12.093

对不起，让你的问题更复杂了。:-)

尽管您可能喜欢预先计算可能的解决方案，或者让消费者自己从预定义的包中进行选择：如果预定义的包不再有库存怎么办？

如果此时不存在完成订单的解决方案怎么办？然后您会运送部分订单吗？如果是：即使您知道以后可以选择预定义的包裹，您是否会包含单个商品？

你真的确定预定义的包不会分配一些“偏好”吗？喜欢订购“ABCD”时选择哪个预定义包，预定义包“ABC”和“BCD”存在？例如，如果您知道预定义的包“ABC”经常缺货，那么这可能会使“BCD”尽可能成为首选。

所以：也许您需要使用一些建模，您可以在其中轻松更改一些硬编码规则，而不是试图找到一个自动化的解决方案。这当然可以是 PHP 本身。

# active-directory - 什么 ldap 查询返回现在从活动目录中删除的用户对象？

> ID：736064
> 
> 赞同：3
> 
> 时间：2009-04-09T21:59:52.527
> 
> 标签：active-directory, ldap, exchange-server

是否有一个 ldap 查询将返回或列出已从活动目录系统中删除的用户对象？您是否必须跟踪当前在活动目录中的所有用户对象，并保持“最后一次看到”的标记才能知道用户对象何时已从活动目录中删除？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-13T18:01:00.023

我真的不相信这些信息是可以获得的。在操作系统的下一个版本（Windows 2008 R2）中，Microsoft 引入了通过为 Active Directory 对象实现类似回收站的功能来实现此目的的能力。请参阅这些文章了解更多信息：http: [//blogs.technet.com/niraj_kumar/archive/2009/02/03/new-feature-active-directory-recycle-bin-in-windows-2008-r2.aspx](http://blogs.technet.com/niraj_kumar/archive/2009/02/03/new-feature-active-directory-recycle-bin-in-windows-2008-r2.aspx) [http://technet.microsoft.com/en-us/library/dd392261.aspx](http://technet.microsoft.com/en-us/library/dd392261.aspx)

但是您可能会看到，这涉及到对象本身的删除，并且它不提供有关对象属性何时更改的任何信息。您可以查看最后修改的属性，但即便如此，您也无法知道哪个属性已更改（更有可能是最后一次登录），因此您再次离开，没有任何帮助。如果您尝试跟踪可以重新创建的正在发生的问题，我建议您创建某种脚本/代码，以给定的时间间隔记录特定用户的属性，然后在您从一个步骤开始时继续运行它对另一个我来说，这个问题的娱乐。

# asp.net - 如何在 ASP.NET 中加载图像服务器端？

> ID：736070
> 
> 赞同：2
> 
> 时间：2009-04-09T22:04:14.060
> 
> 标签：asp.net, vb.net, graphics

我正在尝试加载项目根目录中的图像：

```
Dim b As Bitmap = New Bitmap("img.bmp") 
```

但它似乎没有找到该文件。

我尝试了各种组合，如 ~img.gif、/img.gif、\img.gif、~/img.gif 等，但似乎没有一个有效。如何在 ASP.NET 中访问“服务器上的当前目录”？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-09T22:10:09.413

你有没有尝试过：

```
Dim b As Bitmap = New Bitmap(HttpContext.Current.Server.MapPath("~/img.bmp")) 
```

# java - 这是使用 java 关键字“interface”的正确位置吗？

> ID：736081
> 
> 赞同：3
> 
> 时间：2009-04-09T22:13:36.707
> 
> 标签：java, interface, keyword

我对 Java 比较陌生。在阅读了一些有关寻路的信息后，我阅读了有关使用空类作为“ `interface`”的信息，用于未知对象类型。

我正在开发基于医院主题的 Java 游戏。到目前为止，用户可以建立一个接待处和一个全科医生的办公室。它们是两种不同类型的对象，一种是 a `Building`，一种是 a `ReceptionDesk`。（在我的班级结构中。）

我的班级结构是这样的：

```
GridObject-->Building
GridObject-->Item-->usableItem-->ReceptionDesk. 
```

当可用物品可以旋转而建筑物不能旋转时，问题就出现了。鼠标单击事件在网格上，因此调用相同的方法。GP的办公室是a `Building`，接待处是a `ReceptionDesk`。唯有`ReceptionDesk`方法`rotate`。右键单击网格时，如果处于构建模式，我必须使用此“if”语句：

```
if (currentBuilding.getClass.equals(ReceptionDesk.getClass) 
```

然后我必须创建一个新的`ReceptionDesk`，使用该`rotate`方法，并将那个接待台放回`currentBuilding GridObject`.

我不确定我是否用这个问题很好地解释了自己。对不起。我对 Java 还是很陌生。我将尝试回答任何问题，如果需要，我可以发布更多代码片段。我不知道可能有办法解决不知道对象类别的问题，但是我也可能以错误的方式解决它。

直到我看到这个网站上的回复如此快速和有帮助时，我才打算研究这个！:)

提前致谢。

相对

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-09T22:18:10.593

您不想在对您的情况进行某些操作之前检查对象的类。你应该使用[polymorphism](http://www.uweb.ucsb.edu/~cdecuir/Polymorphism.html)。你想让接口定义一些方法。每个类都实现这些方法。通过接口引用对象，并让这些对象的各个实现将它们的值返回给调用者。

如果您再描述一些您认为需要的物品，这里的人们会对您应该如何布置它们有意见。但是根据您提供的内容，您可能需要一个定义一些通用方法的“Building”接口。您可能还想要一个“UsableItem”接口或更通用的东西。医院可以是一个实现构建的类。ReceptionDesk 可以实现 UsableItem。建筑内部可以有一个 UsableItem 网格。

如果 rotate() 是所有实际工作的家具的通用方法，您可以考虑创建一个 AbstractUsableItem 类，该类是实现 UsableItem 的抽象类并提供 rotate() 方法。如果每个实现类中的rotate 不同，那么接口中就会有该方法，但是每个类（如ReceptionDesk）都会使用rotate() 方法做自己的事情。您的代码将执行以下操作：

```
UsableItem desk = new ReceptionDesk();
desk.rotate() 
```

在您的示例中，如果您在屏幕上单击鼠标旋转了它下面的对象，并且您确实需要在执行类似操作之前检查对象是否可以旋转，您会这样做

```
if (clickedObject instanceOf UsableItem) {
  ((UsableItem) clickedObject).rotate();
} 
```

其中 UsableItem 是接口或抽象类。有些人觉得所有的设计都应该通过接口契约来完成，并为每种类型的类建议一个接口，但我不知道你是否必须走那么远。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-09T22:46:06.347

您可能会考虑朝着完全不同的方向前进，让对象自己决定采取什么样的行动。例如，GridObject 接口可能会为 handleRightClick()、handleLeftClick() 等指定函数声明。在这种情况下，您要说的是“任何自称为 GridObject 的类都需要指定当它们被右键单击时会发生什么”。

因此，在 Building 类中，您可以实现 handleRightClick 以不执行任何操作（或返回错误）。在 ReceptionDesk 类中，您将实现 handleRightClick 来旋转桌子。

您的代码片段将变为：

```
currentBuilding.handleRightClick(... any necessary parameters ...); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T22:57:47.753

你担心是对的。面向对象设计的一个好的经验法则是，每当您使用类似`if(x instanceof Y)`or的构造时`if(x.getClass().equals(Y.class))`，您应该开始考虑向上或向下移动方法，或提取新方法。

Elliot 和 John 都提出了关于你可以去的非常不同的方向的好主意，但他们都对，你肯定应该朝着某个方向前进。面向对象的设计通过使不同种类的行为的分支更加隐含来帮助您的代码变得更加清晰。检查您正在查看的对象类型并据此确定要执行的操作可能会破坏使用面向对象设计的目的。

我还应该警告您，接口并不完全是一个空类。具有抽象方法和接口的空抽象类之间存在一些显着差异。与其将接口视为空类，不如将接口视为契约。通过实现接口，您的类承诺提供接口中列出的每个方法。

# com - IAudioSessionManager2 通知未发送

> ID：736084
> 
> 赞同：7
> 
> 时间：2009-04-09T22:15:28.073
> 
> 标签：com, windows-7, audio

我正在尝试通过 Windows 7 的 IAudioSessionManager2 COM 接口（与 IAudioSessionNotification 结合）监视新的音频会话。目前， IAudioSessionNotification::OnSessionCreated() 从未被调用过，我已经想不出为什么了。

注册自定义 IAudioSessionNotification 的代码：

```
#define SAFE_RELEASE(comObj) \
if(comObj != NULL) \
    { (comObj)->Release(); comObj = NULL; }

BOOL success = false;

HRESULT res;
IClassFactory* pFactory;
IMMDevice* pDevice;
IMMDeviceEnumerator* pEnumerator;

SESSION_LISTENER = NULL;
SESSION = NULL;

res = CoInitialize(NULL);

if(res != S_OK && res != S_FALSE)
    return false;

res = CoGetClassObject(CLSID_CustomAudioFactory, CLSCTX_ALL, NULL, __uuidof(IClassFactory), (void**)&pFactory);
if(res != S_OK)  goto Exit;

res = pFactory->CreateInstance(NULL, CLSID_CustomAudioNotifications, (void**)&SESSION_LISTENER);
if(res != S_OK)  goto Exit;

res = CoCreateInstance(__uuidof(MMDeviceEnumerator), NULL, CLSCTX_ALL, __uuidof(IMMDeviceEnumerator), (void**)&pEnumerator);
if(res != S_OK)  goto Exit;

res = pEnumerator->GetDefaultAudioEndpoint(eRender, eMultimedia, &pDevice);
if(res != S_OK)  goto Exit;

res = pDevice->Activate(__uuidof(IAudioSessionManager2), CLSCTX_ALL, NULL, (void**)&SESSION);
if(res != S_OK)  goto Exit;

res = SESSION->RegisterSessionNotification(SESSION_LISTENER);
if(res != S_OK)  goto Exit;

success = true;

Exit:
SAFE_RELEASE(pFactory);
SAFE_RELEASE(pEnumerator);
SAFE_RELEASE(pDevice);
if(!success)
{
    SAFE_RELEASE(SESSION_LISTENER);
    SAFE_RELEASE(SESSION);
} 
```

CustomAudioNotifications 声明：

```
class CustomAudioNotifications : public IAudioSessionNotification
{
public:
//Constructors
CustomAudioNotifications()  { InterlockedIncrement(&g_notifyCount); m_listener = NULL; }
~CustomAudioNotifications() { InterlockedDecrement(&g_notifyCount); SAFE_RELEASE(m_listener); }

//IUnknown interface
HRESULT __stdcall QueryInterface(
                            REFIID riid ,
                            void **ppObj);
ULONG   __stdcall AddRef();
ULONG   __stdcall Release();

//Notification
HRESULT __stdcall OnSessionCreated(IAudioSessionControl *NewSession);

private:
LONG m_nRefCount;
}; 
```

OnSessionCreated 只是暂时在创建会话时向窗口发布消息；这永远不会发生。以防万一我的假设完全不成立，我希望在尚未播放音频的应用程序开始播放时收到通知；因此启动带有视频文件的 VLC 应该会立即产生通知，而通过 Web 浏览器访问 Pandora 也会触发这样的通知。

调试显示所有返回值都是 S_OK。

我的 COM 经验非常有限，所以指出一般的“WTF”？也将不胜感激。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-11T14:56:09.033

这比您需要做的工作多 TON。

您只需要编写一个派生自 IAudioSessionNotifications 的类 - 您不需要实际编写整个 COM 对象并注册它。

您还应该使用 eConsole 角色而不是 eMultimedia 角色。这实际上并不重要（如果您只有一个音频设备），但它更正确。

CustomAudioNotification 类的析构函数应该是私有的——这样可以防止意外破坏。所以我会写：

> `CustomAudioNotification *customNotification = new CustomAudioNotification(); SESSION->RegisterSessionNotification(customNotification);`

我还假设您已经在代码片段之前初始化了 COM。

更新：Kevin 向我发送了他的应用程序，他的应用程序还有一些其他更基本的问题（我正在努力改进 API 的文档以防止将来出现任何混淆）

首先是他的应用程序没有检索到当前的会话列表。这是关于会话枚举 API 的真正微妙之处之一。为了防止在使用会话 API 的应用程序启动时会话通知到达时可能发生的竞争条件，会话枚举 API 会丢弃新的会话通知，直到应用程序首先检索到现有会话的列表。

预期的使用模式是：

应用程序激活会话管理器2。应用程序注册会话通知。应用程序检索端点的当前会话列表并将会话控制对象存储到列表中（不要忘记添加会话）。

创建新会话时，应用程序获取对新创建的会话控制对象的引用，如果它不存在，则将其插入到列表中。请注意，当会话通知返回时，传递到通知中的会话控制对象将被销毁 - 如果此时调用 GetSessionEnumerator 它可能不会保留新创建的会话（它可能，这完全取决于时间）。

应用程序根据自己的标准管理会话的生命周期——只要应用程序引用了会话控制，会话控制对象就有效。音频会话控制对象没有过期机制。

此外，会话 API 要求初始化 MTA - 这很不幸，但是因为我们在工作线程上创建 COM 对象（实现 IAudioSessionControl），所以 API 要求在收到通知之前创建 MTA。

# c# - 重命名独立存储中的文件

> ID：736085
> 
> 赞同：8
> 
> 时间：2009-04-09T22:15:49.930
> 
> 标签：c#, isolatedstorage

我需要重命名隔离存储中的文件。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-09T22:36:33.267

无论如何，在本机 C# 中似乎没有这样做（可能在本机 Win32 中，但我不知道）。

您可以做的是打开现有文件并将其复制到新文件并删除旧文件。与移动相比，它会很慢，但这可能是唯一的方式。

```
var oldName = "file.old"; var newName = "file.new";

using (var store = IsolatedStorageFile.GetUserStoreForApplication())
using (var readStream = new IsolatedStorageFileStream(oldName, FileMode.Open, store))
using (var writeStream = new IsolatedStorageFileStream(newName, FileMode.Create, store))
using (var reader = new StreamReader(readStream))
using (var writer = new StreamWriter(writeStream))
{
  writer.Write(reader.ReadToEnd());
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-02-12T02:56:54.363

除了复制到新文件，然后删除旧文件方法，从 Silverlight 4 和 .NET Framework v4 开始，IsolatedStorageFile 公开了 MoveFile 和 MoveDirectory 方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-15T11:25:32.360

完美执行这段代码

```
string oldName="oldName";
string newName="newName";
var file = await ApplicationData.Current.LocalFolder.GetFileAsync(oldName);
await file.RenameAsync(newName); 
```

# java - 使用 Java 中的 Axis2 库构造对 WebService 的 SOAP 请求？

> ID：736092
> 
> 赞同：1
> 
> 时间：2009-04-09T22:17:22.187
> 
> 标签：java, soap, axis2

我需要能够使用 Apache Axis2 构造一个 SOAP 请求，并将 SOAP 标头中的 IP 地址和用户代理提供给 Web 服务。是否有描述如何执行此操作的代码示例？

在此先感谢您的帮助！

最好的祝愿鲁奇考尔。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T16:57:21.393

最好的方法是获取您尝试调用的服务的 WSDL，然后使用[wsdl2java 工具](http://ws.apache.org/axis2/1_3/userguide-creatingclients.html#generating)为您生成客户端。

如果您想自己编写代码，可以使用 Axis2 API...可以在[此问题](https://stackoverflow.com/questions/205240/axis2-web-service-client-generation-types-without-modifying-the-client/206188)中找到示例。

# asp.net - 在 .NET 中实时创建 csssprite

> ID：736098
> 
> 赞同：1
> 
> 时间：2009-04-09T22:19:40.187
> 
> 标签：asp.net, css-sprites

有没有人为 .NET 创建了一个“实时”csssprite 生成器？

我想要一个或多个在运行时加载的图像目录，并自动生成 css。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-08-14T00:26:39.613

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T23:23:14.557

[这是你想要的？](http://weblogs.asp.net/zowens/archive/2008/03/05/css-sprite-for-asp-net.aspx) 这是我发现的最接近烘焙解决方案的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-02-23T21:32:20.360

好的，终于有官方的了...

目前尚不清楚它是否会成为核心 ASP.NET 框架，但这里有一个用于 csssprites 的 Microsoft codeplex 项目：

[http://aspnet.codeplex.com/releases/view/50869](http://aspnet.codeplex.com/releases/view/50869)

如果你喜欢它 - 使用它 - 或者只是喜欢这个想法然后添加评论。我认为这将是 ASP.NET 框架中的一件好事。没有亲自使用它（我不得不自己发明轮子），但它得到了很好的评价。

* * *

它包括以下组件：

*   用于自动生成精灵和内联图像的 API
*   提供调用 API 的便捷方式的控件和助手

第二版中添加的功能：

*   Web 窗体的 CSS 链接控件（为用户的浏览器选择正确的 CSS 文件，但不显示图像）
*   使用 App_Sprites 以外的自定义文件夹路径
*   更改精灵图像的平铺方向
*   将生成的 CSS 与用户自己的 CSS 合并

未来版本正在考虑的功能：

*   自动选择最有效的精灵背景颜色
*   自动缩小呈现的 CSS
*   针对 .NET 3.5 编译

# django - 我应该为此使用字段集吗？

> ID：736105
> 
> 赞同：0
> 
> 时间：2009-04-09T22:22:34.530
> 
> 标签：django, forms, django-templates

我有一个查询集。我正在尝试为查询集中的每个项目显示一个反馈表。解决这个问题的好方法是什么？将模型附加到字段集中，然后遍历字段集中的表单，显示模型信息？或者在模板中分别循环遍历查询集和字段集？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T17:18:09.247

你是说formset吗？如果您在同一页面上有多个相同的表单，那么 Django 表单集会很有帮助。

模型表单集听起来像是根据您的描述工作。

链接到文档： [http ://docs.djangoproject.com/en/dev/topics/forms/formsets/](http://docs.djangoproject.com/en/dev/topics/forms/formsets/)

# asp.net - Asp.Net 将 PDF 发送到浏览器

> ID：736106
> 
> 赞同：2
> 
> 时间：2009-04-09T22:23:55.247
> 
> 标签：asp.net, internet-explorer, download, pdf-generation

我一直试图让这个 aspx 页面提供一个 pdf。它在 Firefox 中正常工作，但 IE 提供

> Internet Explorer 无法从 SERVER_NAME 下载 getform.aspx
> Internet Explorer 无法打开此 Internet 站点。请求的站点不可用或找不到。

这是我的代码的一般功能。它分布在多个函数中（这就是我们不使用 WriteFile 的原因 - 有时我们会即时生成 pdf），但通常是这样的：

```
FileStream fs = File.Open(Path.Combine(PdfBasePath, "form.pdf"), FileMode.Open, FileAccess.Read);
Stream output = Response.OutputStream;

byte[] buffer = new byte[BUFFER_SIZE];
int read_count = fs.Read(buffer, 0, BUFFER_SIZE);
while (read_count > 0)
{
    output.Write(buffer, 0, read_count);
    read_count = fs.Read(buffer, 0, BUFFER_SIZE);
}

fs.Close();

Response.Clear();
Response.ContentType = System.Net.Mime.MediaTypeNames.Application.Pdf;
Response.AddHeader("Content-Disposition", "attachment; filename=form.pdf");
Response.Output.Flush();
Response.End(); 
```

查看 Fiddler，正在使用以下方法获取页面：

> GET /getform.aspx?Failure=Y&r=someencryptedstring HTTP/1.1

它因此被返回到浏览器：

> HTTP/1.1 200 OK
> 日期：2009 年 4 月 9 日星期四 22:08:33 GMT
> 服务器：Microsoft-IIS/6.0
> X-Powered-By：ASP.NET
> X-AspNet-Version：2.0.50727
> Pragma：no-cache
> Content-处置：附件；filename=form.pdf
> Cache-Control: no-cache, no-store
> Pragma: no-cache
> Expires: -1
> Content-Type: application/pdf
> Content-Length: 628548

这真的让我很烦。我没有使用 SSL，否则[这篇知识库文章](http://support.microsoft.com/default.aspx?scid=KB;EN-US;q316431&)似乎适用。有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T23:14:18.697

标头中返回的 Content-Length 对于您发送的文件是否真的正确？我只是将它与我​​们在这里使用的一些生产代码进行比较，看起来我们明确设置了 Content-Length 标头。如果我没记错的话，如果标题和实际文件大小不匹配，某些浏览器会出现问题。

**编辑** 问题作者发现将 Content-Disposition 标头更改为 application/download 而不是 application/pdf 似乎可以解决该问题。

# .net - 环境配置

> ID：736112
> 
> 赞同：0
> 
> 时间：2009-04-09T22:26:22.120
> 
> 标签：.net, asp.net

修改 web.configs（和其他基于 XML 的配置）的最佳方法是什么？我需要根据环境自动应用某些设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T23:27:20.087

我通常将我的环境配置与单独的配置文件一起存储在他们自己的文件夹中，并在主 web.config 中的 appsettings 标记的文件属性中引用它

```
 /config/dev.config 
          systest.config
          uat.config
          prod.config

  <appsettings file="config/dev.config"> 
```

这意味着我们可以部署所有配置，只需切换一个值即可更改环境。唯一的缺点是这会破坏一些配置编辑器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T22:38:31.340

如果你的意思是编程，有一些类允许你这样做，例如[WebConfigurationManager](http://msdn.microsoft.com/en-us/library/system.web.configuration.webconfigurationmanager.aspx)和[ConfigurationManager](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T22:46:10.077

您也可以在构建脚本中执行此操作。Nant 和 MSBuild 都有 Xml Peek 和 Poke 的概念。

一般来说，我反对以编程方式编辑 web.config 的想法（它会导致您的网站重新加载）。

# ruby - 为什么 Ruby 文档中的方法前面有一个井号？

> ID：736120
> 
> 赞同：64
> 
> 时间：2009-04-09T22:31:41.623
> 
> 标签：ruby, documentation

当我看到任何以文本形式打印的 Ruby 方法时，它通常显示为：

```
Class#method 
```

或者

```
#method 
```

现在，我会使用：

```
Class.method 
```

为什么所有 Ruby 方法前面都有一个井号？有什么理由吗？

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-04-09T22:40:01.697

请注意，约定是：

```
Class#method 
```

而不是

```
object#method 
```

在代码中`object.method`，如果`object`是`class`. 该`#`约定未在代码中使用。

从[RDoc 文档](http://ruby-doc.org/documentation-guidelines.html)：

> 使用 :: 描述类方法，# 描述实例方法，使用 . 例如代码。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-04-11T15:04:09.590

# 表示法用于引用规范`instance`方法，例如`String#upcase`. 这 。表示法用于指代特定实例的方法，例如`mystring.upcase`. 区别并不意味着存在类方法“upcase”。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-08-22T21:36:24.977

我刚刚意识到，其他答案都没有触及问题最微不足道的方面：为什么是这个`#`标志？

我有两个理论：

1.  它可能来自 Smalltalk，其中符号被写入`#sym`（而不是`:sym`），就像它们在 Ruby 中一样。所以，如果你想*引用*一个 Method*对象*（而不是*调用*一个方法），那么你会调用类似的东西`Array >> #new.`（The`>>`本身就是一个返回传递给它的方法的方法。所以，在 Ruby 中这将是`Array.method :new`。）在Smalltalk 文档中，方法通常被称为`Class>>method`，但在 Ruby 中`Class:method`会更有意义，只是它很容易与`Class::method`. 因此，`Class#method`被选中。
2.  我的另一个理论是选择它只是因为它`#`是 Ruby 中的注释字符。

只有发明该约定的人才能给出明确的答案。如果它是为《*Ruby 编程*》一书发明的，那将是 Dave Thomas 或 Andy Hunt，但我有点怀疑。这本书是 2001 年出版的，Ruby 是 1993 年开始的，在那之前他们是怎么提到方法的？

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2009-04-09T22:41:57.543

来自[rdoc 文档](http://www.ruby-doc.org/stdlib/libdoc/rdoc/rdoc/index.html)（强调我的）：

> 类名、源文件名和任何包含下划线或**前面有井号字符**的方法名都会自动从注释文本超链接到它们的描述。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-04-11T15:03:39.797

你上面列出的所有答案都是正确的。我要补充的一件事是你说你会喜欢的文档风格

> 类.方法

很容易与类方法混淆。由于您可以使用上述语法在 ruby​​ 中调用类方法：

```
class Foo
  def self.say_hi
    puts "hi"
  end
end

Foo.say_hi    # => prints "hi" 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-10-26T21:28:50.943

哈希符号是在 2000 年 12 月首次发布的“Programming Ruby - The Pragmatic Programmer's Guide”中引入的。

“前言”包含[“符号约定”](https://ruby-doc.com/docs/ProgrammingRuby/html/preface.html#S10)：

> 在文本中，`Fred#doIt`是对 的实例方法 ( `doIt`) 的引用`class Fred`，而`Fred.new`[在其他一些 Ruby 文档中，您可能会看到类方法写为`Fred::new`. 这是完全有效的 Ruby 语法；我们只是碰巧觉得`Fred.new`阅读起来不那么分散注意力。] 是一个类方法，并且`Fred::EOF`是一个类常量。

这在 2004 年 10 月出版的第 2 版中得到了澄清：

> 在文本中，`Fred#do_something`是对 的实例方法（在本例中`do_something`）的引用`class Fred`，`Fred.new`是类方法，并且`Fred::EOF`是类常量。使用哈希字符表示实例方法的决定是一个艰难的决定：它不是有效的 Ruby 语法，但我们认为区分特定类的实例方法和类方法很重要。当你看到我们写的时候`File.read`，你就知道我们在谈论类方法`read`。相反，当我们编写`File#read`时，我们指的是实例方法`read`。

Ruby 本身使用这种表示法：

```
> rvm use 1.9.3
Using ruby-1.9.3-p551

> Object.instance_method(:initialize)
=> #<UnboundMethod: Object(BasicObject)#initialize> 
```

它由[Matz 于 2002 年 2 月](https://github.com/ruby/ruby/commit/8210c254bee19294af67bcee0e8f5e02ebb39a60#diff-49b101b7fe030279d27d70ddc47b9210R6919-R6947)引入并正式化：

```
commit 8210c254bee19294af67bcee0e8f5e02ebb39a60
Author: matz <matz@b2dd03c8-39d4-4d8f-98ff-823fe69b080e>
Date:   Tue Feb 5 07:56:31 2002 +0000

    * io.c (fptr_finalize): should raise error when fclose fails.

    * eval.c (method_inspect): proper output format to distinguish
      methods and singleton methods.

    git-svn-id: svn+ssh://ci.ruby-lang.org/ruby/trunk@2046 b2dd03c8-39d4-4d8f-98ff-823fe69b080e 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-08-29T21:46:17.677

[这个问题的 JS 版本中](https://stackoverflow.com/questions/2587896/refering-to-javascript-instance-methods-with-a-pound-hash-sign#2587971)提到了这一点，但这个命名法似乎[来自 JavaDoc](http://docs.oracle.com/javase/7/docs/technotes/tools/windows/javadoc.html#link)，其中哈希标记直接翻译成页面参考，例如`href="Component.html#getComponentAt(int, int)"`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-02-19T09:24:33.670

heff 的回答（由于缺乏声誉，我无法评论），Ruby 遵循 JavaDoc 的例子，在我看来是最好的猜测。JavaDoc 设计者需要或想要一种方法来区分包限定符（他们使用点来表示）和类限定符（他们使用哈希来表示）。JavaDoc 的 @see 和 @link 标记语法如下所示：

```
@see   package.class#member [optional label]
{@link package.class#member [optional label]} 
```

请参阅[@see 标记的 JavaDoc 的 package.class 变体的](http://docs.oracle.com/javase/7/docs/technotes/tools/windows/javadoc.html#package.class)文档以及 heff 已经指出的 JavaDoc 的 @link 标记的文档。

在 JavaDoc 中，包名通常可以省略，因此只保留 Class#member 部分，这看起来和 Ruby 中一样奇怪，因为 Java 代码使用 Class.member 语法，就像 Ruby 一样。

找出为什么 JavaDoc 设计者需要不同的语法会很有趣，而 Java 编译器在这两个目的上都可以使用点。

# nhibernate - 处理 NHibernate 异常

> ID：736121
> 
> 赞同：6
> 
> 时间：2009-04-09T22:33:55.237
> 
> 标签：nhibernate, exception, exception-handling, unique-constraint

在 NHibernate 中处理异常的最佳实践是什么？

我有一个包含以下内容的 SubjectRepository：

```
 public void Add(Subject subject)
    {
        using (ISession session = HibernateUtil.CurrentSession)
        using (ITransaction transaction = session.BeginTransaction())
        {

            session.Save(subject);
            transaction.Commit();
        }
    } 
```

和一个单元测试如下：

```
 [Test]
    public void TestSaveDuplicate()
    {
        var subject = new Subject
        {
            Code = "En",
            Name = "English"
        };

        _subjectRepository.Add(subject);

        var duplicateSubject = new Subject
        {
            Code = "En",
            Name = "English1"
        };

        _subjectRepository.Add(duplicateSubject);
    } 
```

我到了处理单元测试产生的错误的地步，有点卡住了。这如预期的那样失败，虽然有一个 GenericADOException，但我期待一个 ConstraintViolationException 或类似的东西（数据库级别的主题代码存在唯一性约束）。

ADOException 包装了一个带有合理错误消息的 MySQL 异常，但我不想通过抛出内部异常来开始破坏封装。特别是 MySQL 尚未最终确定为该项目的后端。

理想情况下，我希望此时能够捕获异常并向用户返回一个合理的错误。是否有任何记录在案的最佳实践方法来处理 NHibernate 异常并向用户报告出了什么问题以及为什么？

谢谢，

马特

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-09T23:52:21.990

我会在 Add 方法中这样处理它：

```
public void Add(Subject subject)
{
    using (ISession session = HibernateUtil.CurrentSession)
    using (ITransaction transaction = session.BeginTransaction())
    {
        try
        {
            session.Save(subject);
            transaction.Commit();
        }
        catch (Exception ex)
        {
            transaction.Rollback();
            // log exception
            throw;
        }
    }
} 
```

在 catch 块中，您应该首先回滚事务并记录异常。那么你的选择是：

1.  重新抛出相同的异常，这是我的版本所做的
2.  将它包装在您自己的异常中并抛出它
3.  什么都不做就吞掉异常，这很少是个好主意

您没有任何实际选项来处理此方法中的异常。假设 UI 调用了这个方法，它应该在自己的 try..catch 中调用它，并通过向用户显示一个有意义的错误消息来处理它。您可以使用 ExpectedException(type) 属性使您的单元测试通过。

要直接回答您的问题，您应该通过扩展 Exception 创建自己的“合理错误”，并将原始异常作为其 InnerException 抛出。这就是我在 (2) 中列出的异常包装技术。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T00:12:34.500

所有 Nhibernate 异常都是不可恢复的，如果您试图从 nhibernate 异常中恢复，您可以重新审视应用程序/数据层的设计。您还可以查看 spring.net 的[异常翻译实现](http://www.springframework.net/doc-latest/reference/html/orm.html#orm-hibernate-straight-ex) 此外，您手动处理异常事务是乏味且容易出错的，请查看[nhibernate 的上下文会话](http://www.hibernate.org/hib_docs/nhibernate/1.2/reference/en/html/architecture.html)。Spring.net 也有一些关于 nhibernate 的好帮手。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T23:29:38.223

一般的问题是，你想告诉用户什么，用户是谁？

如果用户有时会是另一台计算机（即，这是一个 Web 服务），那么您会希望使用适当的机制来返回 SOAP 错误或 HTTP 错误。

如果用户有时会是某种 UI，那么您可能希望向用户显示一条消息，但是您会告诉用户什么让他可以对此做些什么呢？例如，不管是什么原因，大多数网站都会说“抱歉，我们遇到了意外错误”。那是因为用户通常对错误无能为力。

但无论哪种情况，如何告诉“用户”的选择是表示层（UI 层）的问题，而不是 DAL 的问题。您可能应该将 DAL 中的异常包装在另一种异常类型中，但前提是您要更改消息。你不需要你自己的异常类，除非你的调用者会做一些不同的事情，如果它是一个数据访问异常而不是其他类型的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-19T23:39:03.720

我可能会在保存对象之前验证输入；这样你就可以实现你喜欢的任何验证（例如检查主题代码的长度以及没有任何重复的事实），并将有意义的验证错误传回给用户。

逻辑如下；exceptions 用于表示您的程序无法满足的特殊情况。在上面的示例中输入重复主题代码的用户是您的程序应该满足的；因此，与其因为违反了 DB 约束而处理异常（这是一个异常事件，不应该发生），不如先处理该场景，并且仅在您知道您的数据时才尝试保存数据'正在保存是正确的。

在 DAL 中实施所有验证规则的优势在于，您可以确保进入数据库的数据以一致的方式按照您的业务流程有效，而不是依赖数据库中的约束来为您捕获这些数据。

# php - 无法让内存缓存返回值

> ID：736123
> 
> 赞同：0
> 
> 时间：2009-04-09T22:34:30.853
> 
> 标签：php, memcached

我已经使用了一些我以前使用过的 memcache 脚本，但是在新页面上，我没有得到任何响应。

内存缓存位于另一个页面中包含的函数中。我所做的是将 md5 散列到 mysql 查询并将其存储为 memcached 数据的键。如果密钥不在 memcache 中，那么我去创建数据，将其放入 memcache 并返回。

我认为代码相当简单。这是重要的部分（这是一个创建输出的大页面，因此您不需要所有这些，尽管我认为“返回”很重要，因为我担心这可能是我搞砸的地方。

我用

```
$outList.= outData($getList); 
```

其中 $getList 是一个 mysql 查询

$outList 函数是

```
<?php

@$memcache = new Memcache;
@$memcache->connect("localhost",11211);

function outData($getList)
{
    $memVal = @$memcache->get(MD5($getList));
    if($memVal=='')
    {
        $results=mysql_query($getList)or die(mysql_error());

        // then I do a bunch of stuff with the data
        @$memcache->set(MD5($getList), $memVal, false, 60000);
    } 
    return $memVal;
} 
```

我可以显示创建 $memVal 的所有内容，但我怀疑错误在 if 行中，但在另一个页面上使用相同的代码没有问题。

这看起来有什么问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T22:51:34.710

由于所有这些 @ 的抑制错误，没有办法知道什么是失败的。

我运行了它-没有@的，但答案突然出现了-就行了：

```
$memVal = @$memcache->get(MD5($getList));
#Notice: Undefined variable: memcache in /home/topbit/736160.php on line 9 
```

它从哪里获得变量 $memcache ？它没有传递到函数中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T00:31:59.400

问题是范围。在函数中，全局范围内的变量不会自动传递，您必须将它们作为参数添加到函数中。

```
function outData($memcache, $getList) 
```

# performance - 存储过程的性能问题 - 关闭连接太慢

> ID：736126
> 
> 赞同：0
> 
> 时间：2009-04-09T22:36:15.840
> 
> 标签：performance, sql-server-2005, connection

我之前曾问过一个关于在 sql server 机器上执行太慢的存储过程的问题，但是，如果我在查询分析器中运行存储过程，它会在一秒钟内返回[。](https://stackoverflow.com/questions/735306/sql-server-2005-stored-procedure-performance-problem)客户端是一个 .NET 1.1 winforms 应用程序。

我能够将 VNC 输入到用户的盒子中，当然，他们没有安装 SQL 工具，所以我启动了 Excel，进入 VBA 并编写了一个快速函数来调用具有完全相同参数的存储过程。

事实证明，存储过程确实返回亚秒级，我可以立即遍历所有行。但是，关闭连接需要很长时间，从 5 秒到 30 秒不等。

为什么关闭连接需要这么长时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T14:52:50.733

连接池？

那，或者我会检查客户端库的任何服务包或知识库文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T01:47:42.963

您描述的症状几乎总是由于“不正确”的缓存查询计划。虽然这是一个很大的话题（参见SO 上的[参数嗅探](https://stackoverflow.com/questions/211355/parameter-sniffing-or-spoofing-in-sql-server)），但您通常（但不总是）可以通过重建数据库的索引并确保所有统计信息都是最新的来缓解问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T02:18:54.777

如果您使用的是 SqlDataReader，您可以尝试的一件事是，一旦您拥有所需的所有数据，请先在 SqlCommand 上调用 Cancel，然后再在 SqkDataReader 上调用 Close。这将防止填写输出参数和返回值，这可能是关闭连接缓慢的原因。在 try catch 块中执行此操作，因为它可能会引发用户取消的异常。

# iphone - 如何在图像上创建热链接？

> ID：736127
> 
> 赞同：1
> 
> 时间：2009-04-09T22:36:30.783
> 
> 标签：iphone, cocoa-touch, uiscrollview, uiimage

我不确定 iPhone 版本的名称是什么，但在 HTML 中它是一个图像映射。地图的某些区域会将您引导至不同的页面。我想使用一个图像，主要是在滚动视图中，我可以让某些区域执行不同的操作。例如，Chemical Touch， http: [//itunes.apple.com/WebObjects/MZStore.woa/wa/viewSoftware](http://itunes.apple.com/WebObjects/MZStore.woa/wa/viewSoftware?id=288060442&mt=8) ?id=288060442&mt=8就是这样做的。单击一个元素，它会变大以显示更多细节。这种技术叫什么？它是如何创建的？

我想与用户进行更多的互动，我该怎么做：

*   将地图图钉拖放到此图像上
*   根据我在该区域中是否有文本显示 UITextField
*   根据用户操作覆盖文本

非常感谢这里的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T23:18:31.707

您基本上需要做的是覆盖以下任何或全部：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event;
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event;
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event;
- (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event; 
```

在您的 UIView 子类（或实际上是 UIResponder 的任何子类）中。然后，您可以随心所欲地处理该事件，例如执行您在问题中提到的任何事情。

例如，下面是 Apple 的简单事件处理程序示例代码：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    UITouch* touch = [touches anyObject];
    NSUInteger numTaps = [touch tapCount];
    if (numTaps < 2) {
        [self.nextResponder touchesBegan:touches withEvent:event];
   } else {
        [self handleDoubleTap:touch];
   }
} 
```

iPhone 应用程序编程指南中的[事件处理](http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/EventHandling/EventHandling.html#//apple_ref/doc/uid/TP40007072-CH9)部分应该为您提供入门所需的所有信息。

# c# - 是否可以将 .NET WinForm 的父级设置为本机应用程序？

> ID：736132
> 
> 赞同：2
> 
> 时间：2009-04-09T22:37:44.963
> 
> 标签：c#, .net, winapi

是否可以将 .NET WinForm 的父级设置为本机应用程序？

所以它就像它的子窗口一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T22:45:32.260

似乎没有官方支持的方式来做到这一点。在下面的文章中进行了讨论：

[在 VB 6 中指定父窗体的父窗体](http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework.windowsforms/topic44925.aspx)

# php - 这是电子商务网站的健全的面向对象的设计吗？

> ID：736148
> 
> 赞同：0
> 
> 时间：2009-04-09T22:46:55.330
> 
> 标签：php, oop, cakephp

我对 OOP/OOD 很陌生，我意识到我有很多东西要学，所以我想请教 SO 社区的意见。

基本上，我使用的是 CakePHP 的 MVC 框架，而我正在构建的在线商店只使用 2 个模型，Category 和 Product，由以下 CREATE 语句描述：

```
CREATE TABLE `categories` (
    `id` int(11) unsigned NOT NULL auto_increment,
    `name` varchar(255) default NULL,
    `parent_id` int(11) default NULL REFERENCES categories(`id`),
    `lft` int(11) default NULL,
    `rght` int(11) default NULL,
    PRIMARY KEY (`id`)
);
CREATE TABLE `products` (
    `id` int(11) unsigned NOT NULL auto_increment,
    `name` varchar(255) default NULL,
    `artist_id` int(11) default NULL REFERENCES artists(`id`),
    `description` text default NULL,
    `category_id` int(11) default NULL REFERENCES categories(`id`),
    `status` enum('in stock', 'pre-order', 'out of stock') NOT NULL,
    `price` decimal(6,2) default NULL,
    `picture` varchar(255) default NULL,
    `picture2` varchar(255) default NULL,
    PRIMARY KEY (`id`)
); 
```

在线商店将包括：

*   音乐
    *   光盘
    *   DVD
*   服饰
    *   连帽衫
    *   T 恤
        *   长袖 T 恤
        *   娃娃装
    *   帽子
*   其他商品
    *   贴纸
    *   海报
    *   手包
*   下载
    *   铃声
    *   MP3

基本上，这就是类别树的结构，尽管我们将来可能会添加新的类别。现在，所有产品都被视为 Product 类对象，它们的 category_id 是区分不同类型产品的唯一方法。在线商店也只是该网站的一部分。该网站的其余部分包含艺术家简历和唱片等信息；因此，我也有以下模型/表格：**Artist**、**Album**、**Track**。

这是一个好方法吗？或者我应该为从 Product 类继承的 CD/T-shirts/MP3s/... 创建单独的子类？我想将商店中的每张音乐 CD 链接到唱片条目，以自动生成曲目列表和产品描述的其他信息。

如果这不是处理事情的好方法，你会怎么做呢？另外，我的类别/产品类中应该包含哪些方法/属性？我应该只在类别树的叶节点中列出产品吗？

编辑：
显然这个设计是不完整的。正如 Cyril 指出的那样，缺少 Product.price 字段，并且仍然没有关于销售的规定。实际上，我仍在努力研究如何最好地设计和实施商店的这些方面。最有可能的是，我将只使用另一个名为**Orders**的模型，但实际上处理订单变得更加复杂，因为我们根据运输目的地和订单包含的内容应用不同的运费。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T02:51:08.363

我更喜欢配置+行为方法而不是子类。

这可能是类别级别的一些行为。根据场景的不同，某些行为可能与单独的产品类型相关联，例如适用于某些产品的某些行为，而不管类别如何。对于最后一块吸烟建议也很有意义，因为您可以将这些额外的行为与其他类别相关联。这样，只要您正在处理已经编码的行为，您就可以添加新的类别来指示它将支持哪些行为。

一个小的变化是与类别而不是位相关联的行为列表。

额外的类将用于行为，而不是必须将它们全部混合在产品类下。如果您需要为这些额外的东西关联一个 UI，您可以将它与行为相关联，而不管产品类型如何。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T00:37:19.573

是的，您可能应该为不同类型的产品创建单独的子类，特别是如果它们具有特定于类型的功能。就像您提到的自动生成曲目列表一样。

但即使没有这些，通过使用单独命名的产品类，您将在处理产品类型特定代码时使代码更具可读性和逻辑性。

您可能还想创建一个更具体的数据库模型。像

表：产品
prod_id
...常见的东西..

product_clothes
prod_id
...衣服特定的东西...

product_music
prod_id
...音乐特定的东西...

product_merch
prod_id
...商品特定的东西..

因为音乐没有以英寸为单位的尺寸，而衣服也没有比特率。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T01:26:37.303

您应该跳过 category_id 列并将关系建模为更像标签云。您将希望将每个产品与一个或多个类别相关联。

您应该跳过 Artist_id 列并将关系建模为更像标签云。您最终会希望将某些产品与多个艺术家相关联。

类别已过时，您必须使用标签云。作为一条规则，您永远不应该使用引用语句创建表；除非表中的每一列都有引用语句。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T13:42:37.953

[如果您使用多态行为](http://bakery.cakephp.org/articles/view/polymorphic-behavior)，您仍然可以保留 products 表并制作不同的“产品子类别” 。这是将所有*通用*数据保存在一个地方（价格等）的简单方法。

*或者，您可以在表属性*上使用相同的多态行为，并将任何特定于产品的内容添加为属性（名称=> 值对）。这完全取决于您的想法和数据量。

如果您计划拥有一个大型数据库，第一个解决方案可能会更好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T00:57:24.270

不，

您绝对不应该创建单独的子类，除非您需要一些无法通过简单的类别划分来实现的巨型魔术（例如自定义 T 恤徽标等）。即使在这种情况下，您也可以安全地在类别类中放置一个额外的标志字段（例如 HasLogo）。

但是这个设计还没有给我留下深刻印象。什么样的商店没有销售准备金？价格领域呢？

为了灵活起见，您还可以将图片放在单独的表格中。

你用 lft/rght 做什么？您可以使用简单的 Inde 属性来存储类别在树中的位置，但请记住，每次删除/添加类别时都需要更新。

# google-app-engine - 如果我有一个对谷歌应用引擎属性对象的直接引用，我该如何获取（）或设置（）呢？

> ID：736150
> 
> 赞同：1
> 
> 时间：2009-04-09T22:47:08.997
> 
> 标签：google-app-engine

假设我有一个名为 Bird 的模型类和一个名为 pigeon 的 Bird 实例。我知道我可以使用获得鸽子（或鸟）的所有属性

```
properties = pigeon.properties() #Note, Bird.properties() would also work 
```

这将返回一个字典，其中的键是与我在鸟类中给出的所述属性的名称相匹配的字符串，而值是实际的 Property 对象。我的问题是，如何使用所述属性对象获取或设置值。我希望这样做，因为我想允许客户端动态指定为字符串：

1) 模型对象的键

2) 所述模型对象的属性

3) 以及所述模型对象的上述属性可能具有的值

所以很明显，我需要先获取Model对象，然后判断是否存在所述Property，最后以某种方式获取或设置它？这可能吗？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-03T11:40:59.850

我玩过[App Engine Console](http://con.appspot.com)，它非常适合测试和试验。在我看来你想使用`__set__`，第一个参数是你的模型实例，第二个是新值。接下来，您需要`put()`像往常一样访问该实例。

这是控制台会话，以使其更清晰。（我有没有提到 App Engine 控制台很棒？）

```
>>> from google.appengine.ext import db
>>> class Bird(db.Model):
...   name = db.StringProperty()
...   can_fly = db.BooleanProperty()
... 
>>> def summarize():
...   for name in ('Pesto', 'Bobby'):
...     count = Bird.all().filter('name =', name).count()
...     print 'I found %d birds named %s' % (count, name)
...
>>> summarize()
I found 0 birds named Pesto
I found 0 birds named Bobby
>>> pigeon = Bird(name='Pesto', can_fly=True)
>>> pigeon.put()
datastore_types.Key.from_path('Bird', 41015L, _app=u'con')
>>> summarize()
I found 1 birds named Pesto
I found 0 birds named Bobby
>>> props = pigeon.properties()
>>> props
{'can_fly': <google.appengine.ext.db.BooleanProperty object at 0x46ddd1cc3ddb2268>, 'name': <google.appengine.ext.db.StringProperty object at 0x46ddd1cc3ddb2fe8>}
>>> prop = props['name']
>>> prop
<google.appengine.ext.db.StringProperty object at 0x46ddd1cc3ddb2a68>
>>> prop.__set__(pigeon, 'Bobby')
>>> pigeon.name
'Bobby'
>>> pigeon.put()
datastore_types.Key.from_path('Bird', 41015L, _app=u'con')
>>> summarize()
I found 0 birds named Pesto
I found 1 birds named Bobby
>>> bobby = Bird.all().filter('name =', 'Bobby').fetch(1)[0]
>>> bobby.name
u'Bobby' 
```

如果您自己尝试在线控制台演示，请务必先删除我的旧实例，因为我们都共享同一个数据存储。

# sql-server - SQL Server：显示第一行分组记录

> ID：736151
> 
> 赞同：1
> 
> 时间：2009-04-09T22:47:49.040
> 
> 标签：sql-server, sql-server-2005, sql-server-2008

我正在尝试编写一个查询，该查询将输出类似于下面最后一批记录的内容。当然，它可以在 Reporting Services 和 Crystal Reports 中使用，但只是把它扔在这里看看是否可以在 SSMS/QA 中使用：

```
桌子：
身份证姓名金额
-- ---- ------
 1 抢 23.00
 2 抢 34.00
 3 旦 45.00
 4 段 56.00

从 t1 中选择名称、金额
查询结果：
名额
---- ------
抢劫 23.00
抢 34.00
丹 45.00
旦 56.00

期望的结果：
名额
---- ------
抢劫 23.00
      34.00
丹 45.00
      56.00

```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-09T23:15:08.773

尝试这个：

```
SELECT CASE WHEN _rank = 1 THEN name ELSE '' END AS name, amount
FROM (
    SELECT name, amount,
        ROW_NUMBER() OVER (PARTITION BY name ORDER BY amount ASC) AS _rank
    FROM t1
) q 
```

# wpf - 在 WPF 中启用滚动条

> ID：736153
> 
> 赞同：40
> 
> 时间：2009-04-09T22:49:55.510
> 
> 标签：wpf, xaml, wpf-controls

我现在遇到一个问题，当窗口垂直太小时，我的 WPF 应用程序会隐藏折叠下方的任何内容。如何使用 XAML 为整个应用程序显示垂直滚动条，以便用户可以滚动查看其余内容？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-04-09T22:55:19.397

在 Window 中放置一个 ScrollViewer：

```
<Window x:Class="WpfApplication2.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300">

    <ScrollViewer >
        <!-- Window content here -->
    </ScrollViewer>
</Window> 
```

# html - 将字符串修剪为忽略 HTML 的长度

> ID：736155
> 
> 赞同：9
> 
> 时间：2009-04-09T22:50:14.700
> 
> 标签：html, string, truncate, tokenize

这个问题是一个具有挑战性的问题。我们的应用程序允许用户在主页上发布新闻。该新闻是通过允许 HTML 的富文本编辑器输入的。在主页上，我们只想显示新闻项目的截断摘要。

> 例如，这里是我们显示的全文，包括 HTML
> 
> 为了在办公室和厨房里腾出更多空间，我把所有随机的杯子都拿出来放在午餐室的桌子上。**除非您对 1992 年的 Cheyenne Courier 马克杯或 1997 年的 BC Tel Advanced Communications 马克杯的所有权有强烈的感觉，否则它们将被放入一个盒子并捐赠给比我们更需要马克杯的办公室。**

我们希望将新闻项修剪为 250 个字符，但不包括 HTML。

我们目前用于修剪的方法包括 HTML，这会导致一些 HTML 重的新闻帖子被大大截断。

例如，如果上面的示例包含大量 HTML，它可能看起来像这样：

> 为了在办公室、厨房里腾出更多空间，我拉...

这不是我们想要的。

有没有人有办法标记 HTML 标签以保持字符串中的位置，对字符串执行长度检查和/或修剪，并在其旧位置恢复字符串内的 HTML？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-09T23:02:16.057

从帖子的第一个字符开始，遍历每个字符。每次你越过一个角色，增加一个计数器。当你找到一个 '<' 字符时，停止增加计数器直到你碰到一个 '>' 字符。当计数器到达 250 时，您的位置是您实际想要切断的位置。

请注意，当 HTML 标记在截止之前打开但未关闭时，您将不得不处理另一个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-02T17:58:58.123

根据 2-state 有限机器的建议，我刚刚为此目的开发了一个简单的 HTML 解析器，用 Java 编写：

[http://pastebin.com/jCRqiwNH](http://pastebin.com/jCRqiwNH)

这里有一个测试用例：

[http://pastebin.com/37gCS4tV](http://pastebin.com/37gCS4tV)

这里是Java代码：

```
import java.util.Collections;
import java.util.LinkedList;
import java.util.List;

public class HtmlShortener {

    private static final String TAGS_TO_SKIP = "br,hr,img,link";
    private static final String[] tagsToSkip = TAGS_TO_SKIP.split(",");
    private static final int STATUS_READY = 0;

        private int cutPoint = -1;
    private String htmlString = "";

    final List<String> tags = new LinkedList<String>();

    StringBuilder sb = new StringBuilder("");
    StringBuilder tagSb = new StringBuilder("");

    int charCount = 0;
    int status = STATUS_READY;

    public HtmlShortener(String htmlString, int cutPoint){
        this.cutPoint = cutPoint;
        this.htmlString = htmlString;
    }

    public String cut(){

        // reset 
        tags.clear();
        sb = new StringBuilder("");
        tagSb = new StringBuilder("");
        charCount = 0;
        status = STATUS_READY;

        String tag = "";

        if (cutPoint < 0){
            return htmlString;
        }

        if (null != htmlString){

            if (cutPoint == 0){
                return "";
            }

            for (int i = 0; i < htmlString.length(); i++){

                String strC = htmlString.substring(i, i+1);

                if (strC.equals("<")){

                    // new tag or tag closure

                    // previous tag reset
                    tagSb = new StringBuilder("");
                    tag = "";

                    // find tag type and name
                    for (int k = i; k < htmlString.length(); k++){

                        String tagC = htmlString.substring(k, k+1);
                        tagSb.append(tagC);

                        if (tagC.equals(">")){
                            tag = getTag(tagSb.toString());
                            if (tag.startsWith("/")){

                                // closure
                                if (!isToSkip(tag)){
                                    sb.append("</").append(tags.get(tags.size() - 1)).append(">");
                                    tags.remove((tags.size() - 1));
                                }

                            } else {

                                // new tag
                                sb.append(tagSb.toString());

                                if (!isToSkip(tag)){
                                    tags.add(tag);  
                                }

                            }

                            i = k;
                            break;
                        }

                    }

                } else {

                    sb.append(strC);
                    charCount++;

                }

                // cut check
                if (charCount >= cutPoint){

                    // close previously open tags
                    Collections.reverse(tags);
                    for (String t : tags){
                        sb.append("</").append(t).append(">");
                    }
                    break;
                } 

            }

            return sb.toString();

        } else {
            return null;
        }

    }

    private boolean isToSkip(String tag) {

        if (tag.startsWith("/")){
            tag = tag.substring(1, tag.length());
        }

        for (String tagToSkip : tagsToSkip){
            if (tagToSkip.equals(tag)){
                return true;
            }
        }

        return false;
    }

    private String getTag(String tagString) {

        if (tagString.contains(" ")){
            // tag with attributes
            return tagString.substring(tagString.indexOf("<") + 1, tagString.indexOf(" "));
        } else {
            // simple tag
            return tagString.substring(tagString.indexOf("<") + 1, tagString.indexOf(">"));
        }

    } 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T16:30:57.050

这是我在 C# 中提出的实现：

```
public static string TrimToLength(string input, int length)
{
  if (string.IsNullOrEmpty(input))
    return string.Empty;

  if (input.Length <= length)
    return input;

  bool inTag = false;
  int targetLength = 0;

  for (int i = 0; i < input.Length; i++)
  {
    char c = input[i];

    if (c == '>')
    {
      inTag = false;
      continue;
    }

    if (c == '<')
    {
      inTag = true;
      continue;
    }

    if (inTag || char.IsWhiteSpace(c))
    {
      continue;
    }

    targetLength++;

    if (targetLength == length)
    {
      return ConvertToXhtml(input.Substring(0, i + 1));
    }
  }

  return input;
} 
```

还有一些我通过 TDD 使用的单元测试：

```
[Test]
public void Html_TrimReturnsEmptyStringWhenNullPassed()
{
  Assert.That(Html.TrimToLength(null, 1000), Is.Empty);
}

[Test]
public void Html_TrimReturnsEmptyStringWhenEmptyPassed()
{
  Assert.That(Html.TrimToLength(string.Empty, 1000), Is.Empty);
}

[Test]
public void Html_TrimReturnsUnmodifiedStringWhenSameAsLength()
{
  string source = "<div lang=\"en\" class=\"textBody localizable\" id=\"pageBody_en\">" +
                  "<img photoid=\"4041\" src=\"http://xxxxxxxx/imagethumb/562103830000/4041/300x300/False/mugs.jpg\" style=\"float: right;\" class=\"photoRight\" alt=\"\"/>" +
                  "<br/>" +
                  "In an attempt to make a bit more space in the office, kitchen, I";

  Assert.That(Html.TrimToLength(source, 250), Is.EqualTo(source));
}

[Test]
public void Html_TrimWellFormedHtml()
{
  string source = "<div lang=\"en\" class=\"textBody localizable\" id=\"pageBody_en\">" +
             "<img photoid=\"4041\" src=\"http://xxxxxxxx/imagethumb/562103830000/4041/300x300/False/mugs.jpg\" style=\"float: right;\" class=\"photoRight\" alt=\"\"/>" +
             "<br/>" +
             "In an attempt to make a bit more space in the office, kitchen, I've pulled out all of the random mugs and put them onto the lunch room table. Unless you feel strongly about the ownership of that Cheyenne Courier mug from 1992 or perhaps that BC Tel Advanced Communications mug from 1997, they will be put in a box and donated to an office in more need of mugs than us. <br/><br/>" +
             "In the meantime we have a nice selection of white Ikea mugs, some random Starbucks mugs, and others that have made their way into the office over the years. Hopefully that will suffice. <br/><br/>" +
             "</div>";

  string expected = "<div lang=\"en\" class=\"textBody localizable\" id=\"pageBody_en\">" +
                    "<img photoid=\"4041\" src=\"http://xxxxxxxx/imagethumb/562103830000/4041/300x300/False/mugs.jpg\" style=\"float: right;\" class=\"photoRight\" alt=\"\"/>" +
                    "<br/>" +
                    "In an attempt to make a bit more space in the office, kitchen, I've pulled out all of the random mugs and put them onto the lunch room table. Unless you feel strongly about the ownership of that Cheyenne Courier mug from 1992 or perhaps that BC Tel Advanced Communications mug from 1997, they will be put in";

  Assert.That(Html.TrimToLength(source, 250), Is.EqualTo(expected));
}

[Test]
public void Html_TrimMalformedHtml()
{
  string malformedHtml = "<div lang=\"en\" class=\"textBody localizable\" id=\"pageBody_en\">" +
                         "<img photoid=\"4041\" src=\"http://xxxxxxxx/imagethumb/562103830000/4041/300x300/False/mugs.jpg\" style=\"float: right;\" class=\"photoRight\" alt=\"\"/>" +
                         "<br/>" +
                         "In an attempt to make a bit more space in the office, kitchen, I've pulled out all of the random mugs and put them onto the lunch room table. Unless you feel strongly about the ownership of that Cheyenne Courier mug from 1992 or perhaps that BC Tel Advanced Communications mug from 1997, they will be put in a box and donated to an office in more need of mugs than us. <br/><br/>" +
                         "In the meantime we have a nice selection of white Ikea mugs, some random Starbucks mugs, and others that have made their way into the office over the years. Hopefully that will suffice. <br/><br/>";

  string expected = "<div lang=\"en\" class=\"textBody localizable\" id=\"pageBody_en\">" +
              "<img photoid=\"4041\" src=\"http://xxxxxxxx/imagethumb/562103830000/4041/300x300/False/mugs.jpg\" style=\"float: right;\" class=\"photoRight\" alt=\"\"/>" +
              "<br/>" +
              "In an attempt to make a bit more space in the office, kitchen, I've pulled out all of the random mugs and put them onto the lunch room table. Unless you feel strongly about the ownership of that Cheyenne Courier mug from 1992 or perhaps that BC Tel Advanced Communications mug from 1997, they will be put in";

  Assert.That(Html.TrimToLength(malformedHtml, 250), Is.EqualTo(expected));
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T22:59:09.670

如果我正确理解了这个问题，您希望保留 HTML 格式，但您不想将其计为您保留的字符串长度的一部分。

您可以使用实现简单[有限状态机](http://en.wikipedia.org/wiki/Finite_state_machine)的代码来完成此操作。

> 2 种状态：InTag、OutOfTag
> InTag：
> - 如果`>`遇到字符，则转到 OutOfTag - 遇到
> 任何其他字符时转到自身
> OutOfTag：
> - 如果`<`遇到字符，则转到 InTag - 遇到
> 任何其他字符时转到自身

您的起始状态将是 OutOfTag。

您通过一次处理 1 个字符来实现有限状态机。每个角色的处理都将您带到一个新的状态。

当您通过有限状态机运行文本时，您还希望保留一个输出缓冲区和到目前为止遇到的长度变量（这样您就知道何时停止）。

1.  每次您处于 OutOfTag 状态并处理另一个字符时，增加您的 Length 变量。如果您有空格字符，您可以选择不增加此变量。
2.  当您没有更多字符或您具有＃1中提到的所需长度时，您将结束算法。
3.  在您的输出缓冲区中，包括您遇到的字符，直到 #1 中提到的长度。
4.  保留一堆未封闭的标签。当您达到长度时，为堆栈中的每个元素添加一个结束标记。在运行算法时，您可以通过保留 current_tag 变量来知道何时遇到标签。此 current_tag 变量在您进入 InTag 状态时启动，并在您进入 OutOfTag 状态时结束（或在 InTag 状态下遇到白色字符时）。如果您有开始标签，则将其放入堆栈中。如果您有结束标签，则将其从堆栈中弹出。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-04T15:47:30.703

我知道这比发布日期晚了很多，但我有一个类似的问题，这就是我最终解决它的方式。我担心的是正则表达式与通过数组交互的速度。

此外，如果您在 html 标记之前有一个空格，并且在此之后不能解决该问题

```
private string HtmlTrimmer(string input, int len)
{
    if (string.IsNullOrEmpty(input))
        return string.Empty;
    if (input.Length <= len)
        return input;

    // this is necissary because regex "^"  applies to the start of the string, not where you tell it to start from
    string inputCopy;
    string tag;

    string result = "";
    int strLen = 0;
    int strMarker = 0;
    int inputLength = input.Length;     

    Stack stack = new Stack(10);
    Regex text = new Regex("^[^<&]+");                
    Regex singleUseTag = new Regex("^<[^>]*?/>");            
    Regex specChar = new Regex("^&[^;]*?;");
    Regex htmlTag = new Regex("^<.*?>");

    while (strLen < len)
    {
        inputCopy = input.Substring(strMarker);
        //If the marker is at the end of the string OR 
        //the sum of the remaining characters and those analyzed is less then the maxlength
        if (strMarker >= inputLength || (inputLength - strMarker) + strLen < len)
            break;

        //Match regular text
        result += text.Match(inputCopy,0,len-strLen);
        strLen += result.Length - strMarker;
        strMarker = result.Length;

        inputCopy = input.Substring(strMarker);
        if (singleUseTag.IsMatch(inputCopy))
            result += singleUseTag.Match(inputCopy);
        else if (specChar.IsMatch(inputCopy))
        {
            //think of &nbsp; as 1 character instead of 5
            result += specChar.Match(inputCopy);
            ++strLen;
        }
        else if (htmlTag.IsMatch(inputCopy))
        {
            tag = htmlTag.Match(inputCopy).ToString();
            //This only works if this is valid Markup...
            if(tag[1]=='/')         //Closing tag
                stack.Pop();
            else                    //not a closing tag
                stack.Push(tag);
            result += tag;
        }
        else    //Bad syntax
            result += input[strMarker];

        strMarker = result.Length;
    }

    while (stack.Count > 0)
    {
        tag = stack.Pop().ToString();
        result += tag.Insert(1, "/");
    }
    if (strLen == len)
        result += "...";
    return result;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-04T17:32:51.243

你可以试试下面的 npm 包

[修剪-html](https://github.com/brankosekulic/trimHtml)

它切断了 html 标签内的足够文本，保存原始 html 限制，达到限制后删除 html 标签并关闭打开的标签。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-04-09T22:58:31.340

最快的方法不是使用jQuery的`text()`方法吗？

例如：

```
<ul>
  <li>One</li>
  <li>Two</li>
  <li>Three</li>
</ul>

var text = $('ul').text(); 
```

将在变量中给出值 OneTwoThree `text`。这将允许您在不包含 HTML 的情况下获得文本的实际长度。

# html - HTML 文本框，自动突出显示文本

> ID：736158
> 
> 赞同：5
> 
> 时间：2009-04-09T22:50:54.167
> 
> 标签：html, text, highlight

我将如何制作一个包含预先存在的文本的文本框，当用户在其中单击时，其中的所有文本都会突出显示。例如，YouTube 为其视频中的嵌入代码处理文本框的方式相同。谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-09T22:56:09.147

如果我正确理解了您的问题，您可以使用一些 javascript（未经测试的代码）：

```
<script language="JavaScript">
  function selectText(textField) 
  {
    textField.focus();
    textField.select();
  }
</script>

<input type="text" name="sometext" size="100" value="The Text" onClick='selectText(this);'> 
```

您可以将脚本放在 <head> 和 </head> 标记之间。

# sql-server - 以最小的争用将大量数据上传到生产 sql server

> ID：736162
> 
> 赞同：0
> 
> 时间：2009-04-09T22:52:36.893
> 
> 标签：sql-server, upload

我正在运行一个网站，帮助管理医疗诊所的大量信息。部分应用程序需要从 Excel 电子表格上传患者文件。患者表大约有 100 万条记录，一次 excel 导入需要一次插入或更新 10k、20k、30k 条患者记录。与此同时，其他顾客都在敲桌子。处理时间不如减少数据库争用重要。你会推荐什么策略？

我知道其他网站有效地做到了这一点。Salesforce 允许您一次上传大量数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T02:53:04.163

首先将 Excel 工作表加载到临时表，然后决定是更新/插入单个批次中的行还是什么。

通常，将一百万行从一个表插入到另一个表应该足够快，以便在服务器负载时运行。在插入过程中您将有一个锁定，但这应该是几秒钟的事情。除非您每分钟加载数十亿条记录，或者您的 upsert 操作非常密集，否则我认为这不是问题。

如果你的 upsert 非常复杂，有很多方法可以做到。您可以在单个批次中插入，但将生产记录标记为不完整，因为它们的从属记录已更新。您可以将暂存行标记为未处理并批量处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T00:15:41.577

如果每个行更新都是独立的，则运行一个循环来获取一行，更新表，获取另一行，...

然后，您可以在循环中放置一个延迟以减慢它的速度，以避免影响主站点（可以使用某种负载度量来动态调整它）。某种令牌环（如 setup）可用于一起制作多个更新节流阀。

# .net - Linq：获取 DataContext 中所有表的列表

> ID：736174
> 
> 赞同：8
> 
> 时间：2009-04-09T22:55:55.107
> 
> 标签：.net, linq, asp.net-3.5, datacontext

我有一个包含 100 多个表的 DataContext（Linq to Sql），是否可以获取所有这些表的列表，然后将它们打印到控制台？这可能是一个愚蠢的问题。

谢谢。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-10T00:22:19.640

它比上面容易得多，不需要反射。Linq to SQL 有一个 Mapping 属性，您可以使用它来获取所有表的枚举。

```
context.Mapping.GetTables(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T23:04:42.823

你可以通过反射来做到这一点。本质上，您遍历[DataContext](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.aspx)类中的属性。对于每个属性，检查该属性的通用参数类型是否具有[TableAttribute](http://msdn.microsoft.com/en-us/library/system.data.linq.mapping.tableattribute.aspx)特性。如果是这样，该属性表示一个表：

```
using System.Reflection;
using System.Data.Linq.Mappings;

PropertyInfo[] properties = typeof(MyDataContext).GetProperties();
foreach (PropertyInfo property in properties)
{
    if(property.PropertyType.IsGenericType)
    {
        object[] attribs = property.PropertyType.GetGenericArguments()[0].GetCustomAttributes(typeof(TableAttribute), false);
        if(attribs.Length > 0)
        {
            Console.WriteLine(property.Name);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-12-19T04:31:57.023

```
dc= new myDataContext();
var listaTablas = (from tables in dc.Mapping.GetTables() select tables.TableName).ToList(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-09T09:18:30.123

```
using System.Reflection;
using System.Data.Linq.Mappings;

PropertyInfo[] properties = typeof(MyDataContext).GetProperties();
foreach (PropertyInfo property in properties)
{
    if(property.PropertyType.IsGenericType)
    {
        object[] attribs = property.PropertyType.GetGenericArguments()[0].GetCustomAttributes(typeof(TableAttribute), false);
        if(attribs.Length > 0)
        {
            Console.WriteLine(property.Name);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-04-25T19:26:35.160

为 SP

```
foreach (var sp in Mapping.ContextType.GetMembers().Where(w=> w.Name.ToLower().Contains("push")).GroupBy(g=>g.Name).Select(s=>s.First()))
{
    sp.Name.Dump();
    sp.ToString().Replace("LINQPad.Return", "").Replace("System.Data.Linq.", "").Dump();
} 
```

对于表

```
foreach (var table in Mapping.GetTables().Where(t => t.TableName.ToLower().Contains("push")))
{
    table.TableName.Dump();
} 
```

# javascript - Javascript 火狐问题

> ID：736177
> 
> 赞同：0
> 
> 时间：2009-04-09T22:56:27.523
> 
> 标签：javascript, firefox

我正在尝试从 Firefox 扩展执行以下代码，但它不工作。else 部分中的实际代码是不同的，但即使是这个简单的 for 循环也没有被执行。没有 for 循环的警报框正在工作。有人可以知道为什么这不起作用。谢谢

```
window.addEventListener("pageshow",function(e)
    {
        if((document.title.trim()=="Mozilla Firefox") ||
           (document.title.trim()=="New Tab"))
        {
        }
        else
        {
            for(i=0;i<3;i++)
            {
                alert("hi");
            }
        }
    },true); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T23:03:02.670

如果它在 Firefox 扩展中，请尝试使用 content.document 而不是仅使用文档。

**编辑**：

```
var metaTags = content.document.getElementsByTagName("meta");

for(var i = 0; i < metaTags.length; i++) {
    // do something with metaTags[i]
} 
```

此外，如果有帮助，请随意查看[我编写的任何扩展](https://addons.mozilla.org/en-US/firefox/user/1014082)的源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T23:22:01.673

> 文档.title.trim()

你确定那是你想要的吗？String->trim() 是一种非标准的 JavaScript 方法，目前仅在 Firefox 3.1 中可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T00:14:11.720

我更改了 for 循环 for...in 循环，它起作用了:)

# java - Hibernate Validator 可以用作 Hibernate 之外的组件吗？

> ID：736178
> 
> 赞同：4
> 
> 时间：2009-04-09T22:56:45.370
> 
> 标签：java, hibernate, hibernate-validator, bean-validation

我正在尝试为消息有效负载（即 json）添加验证。我正在使用[Jackson](http://jackson.codehaus.org) Json 处理器进行数据绑定，这对我来说效果很好，使用 bean 方法和偶尔的一两个注释。

但除了数据绑定之外，我想以声明方式验证实际值：特别是我更喜欢注释而不是任何外部模式（DRY 原则，保持代码和约束完全同步）。所以我正在寻找一个简单的验证库来做到这一点。

看起来 JSR-303 几乎定义了声明部分所需的注释。看起来[Hibernate Validator](http://www.hibernate.org/412.html)是使用这些注释的实际验证器的实现。但是文档涵盖了与 Hibernate 一起使用的用例，所以我不确定它是否可以在 Hibernate 本身之外使用。由于我不对相关服务进行任何数据库访问，因此我宁愿不包括 Hibernate 的其他部分。

有没有人这样做或对样本有很好的指导？

或者，如果有人知道另一个很好的 JSR-303 实现也可以。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T12:52:14.237

Hibernate Validator 可以在任何层使用。但是，在您的情况下不会发生自动验证。所以你必须以编程方式触发验证。

# java - Spring 表单命令可以是 Map 吗？

> ID：736186
> 
> 赞同：10
> 
> 时间：2009-04-09T23:02:22.877
> 
> 标签：java, spring, spring-mvc

Spring 表单命令可以是 Map 吗？我通过扩展 HashMap 使我的命令成为 Map 并使用`['property']`符号引用属性，但它不起作用。

命令：

```
public class MyCommand extends HashMap<String, Object> {
} 
```

HTML 表单：

```
Name: <form:input path="['name']" /> 
```

导致错误：

```
org.springframework.beans.NotReadablePropertyException: Invalid property '[name]' of bean class [com.me.MyCommand]: Bean property '[name]' is not readable or has an invalid getter method: Does the return type of the getter match the parameter type of the setter? 
```

这是不允许的还是我的语法不正确？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-09T23:08:39.630

Springn MVC 命令需要使用 JavaBeans 命名约定（即 getXXX() 和 setXXX()），所以不，您不能为此使用映射。

一种替代方法是使用具有单个 Map 属性的 bean，即：

```
public class MyCommand {
  private final Map<String, Object> properties = new HashMap<String, Object>();

  public Map<String, Object> getProperties() { return properties; }
  // setter optional
} 
```

然后你可以做这样的事情（不是 100% 确定语法，但它是可能的）：

```
Name: <form:input path="properties['name']" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-07-18T11:10:01.357

结合 cletus 和 dbell 的答案，我实际上可以使它工作并希望与您分享解决方案（包括提交表单时的值绑定，cletus 解决方案报告的一个缺陷）

您不能直接使用地图作为命令，但是有另一个需要包装惰性地图的域对象

```
public class SettingsInformation {

    private Map<String, SettingsValue> settingsMap= MapUtils.lazyMap(new HashMap<String, SettingsValue>(),FactoryUtils.instantiateFactory(SettingsValue.class));

    public Map<String, SettingsValue> getSettingsMap() {
        return settingsMap;
    }

    public void setSettingsMap(Map<String, SettingsValue > settingsMap) {
        this.settingsMap = settingsMap;
    }

} 
```

SettingsValue 是一个实际包装值的类。

```
public class SettingsValue {

private String value;

public SettingsValue(String value) {
    this.value = value;
}

public SettingsValue() {

}

public String getValue() {

    return value;
}

public void setValue(String propertyValue) {

    this.value = propertyValue;
} 
```

提供模型的控制器方法如下所示：

```
 @RequestMapping(value="/settings", method=RequestMethod.GET)
public ModelAndView showSettings() {

    ModelAndView modelAndView = new ModelAndView("settings");

    SettingsDTO settingsDTO = settingsService.getSettings();
    Map<String, String> settings = settingsDTO.getSettings();

    SettingsInformation settingsInformation = new SettingsInformation();

    for (Entry<String, String> settingsEntry : settings.entrySet()) {
        SettingsValue settingsValue = new SettingsValue(settingsEntry.getValue());
        settingsInformation.getSettingsMap().put(settingsEntry.getKey(), settingsValue);
    }

    modelAndView.addObject("settings", settingsInformation);

    return modelAndView;
} 
```

你的表格应该是这样的

```
<form:form action="${actionUrl}" commandName="settings">
        <form:input path="settingsMap['exampleKey'].value"/>
        <input type="submit" value="<fmt:message key="settings.save"/>"/>
</form:form> 
```

处理表单提交的控制器方法照常工作

```
@RequestMapping(value="/settings", method=RequestMethod.POST)
public ModelAndView updateSettings(@ModelAttribute(value="settings") SettingsInformation settings) {
[...]
} 
```

我验证了 SettingsInformation bean 实际上填充了表单中的值。

谢谢你帮我做这个；如果您有任何问题随时问。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-07T20:56:35.353

好的，我有一个适合我的解决方案我使用 MapUtils.lazyMap

//我的根域

```
 public class StandardDomain {

        private Map<String, AnotherDomainObj> templateMap= MapUtils.lazyMap(new HashMap<String, AnotherDomainObj>(),FactoryUtils.instantiateFactory(AnotherDomainObj.class));

        public Map<String, AnotherDomainObj> getTemplateContentMap() {
            return templateMap;
        }

        public void setTemplateContentMap(Map<String, AnotherDomainObj > templateMap) {
            templateMap = templateMap;
        }

    } 
```

//我的第二个域

```
public class AnotherDomainObj  {

    String propertyValue="";

        public String getPropertyValue() {
           return propertyValue;
        }

        public void setPropertyValue(String propertyValue) {
           this.propertyValue = propertyValue;
     }

} 
```

//在我的JSP中

```
<input type="text" value="testthis" name="templateMap['keyName'].propertyValue"/> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-09T23:21:17.183

是的，它可以，但是......您需要将其引用为`<form:input path="name[index].key|value"/>` 例如

`<form:input path="name[0].value"/>`

# c++ - 从套接字迭代 read()

> ID：736188
> 
> 赞同：3
> 
> 时间：2009-04-09T23:03:46.227
> 
> 标签：c++, c, sockets, tcp

`read`这是在套接字上迭代 a 的正确方法吗？我很难让它正常工作。`data.size`也是`unsigned int`从套接字填充的。它是正确的。`data.data`是一个`unsigned char *`。

```
if ( data.size > 0 ) {
    data.data = (unsigned char*)malloc(data.size);
    memset(&data.data, 0, data.size);
    int remainingSize = data.size;
    unsigned char *iter = data.data;
    int count = 0;
    do {
        count = read(connect_fd, iter, remainingSize);
        iter += count;
        remainingSize -= count;
    } while (count > 0 && remainingSize > 0);
}
else {
    data.data = 0;
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-09T23:11:46.037

在开始将其添加到其他值之前，您需要检查读取的返回值。

当套接字报告 EOF 时你会得到一个零，错误时你会得到 -1。请记住，对于套接字，EOF 与已关闭不同。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T07:15:47.757

请记住，read() 调用是系统调用，因此可能是阻塞的来源，即使您使用非阻塞 I/O，它们本质上也是重量级的。我建议尽量减少它们。

在使用 C 语言进行 BSD 套接字编程十多年的过程中，一个一直为我服务的好方法是使用非阻塞 I/O 并发出 FIONREAD ioctl() 以获取在给定轮询间隔等待的数据总量（假设您正在使用某种同步 I/O 多路复用器，例如 select()），然后只需 read() 所需的次数即可捕获所有数据，然后暂时返回该函数，直到下一个计时器打钩。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-09T23:51:15.300

低级套接字编程非常繁琐且容易出错。如果您使用 C++，您应该尝试使用更高级别的库，例如[Boost](http://www.boost.org)或[ACE](http://www.cs.wustl.edu/~schmidt/ACE.html)。

我还建议阅读[C++ Network Programming: Mastering Complexity Using ACE and Patterns](http://www.cs.wustl.edu/~schmidt/ACE/book1/)和[C++ Network Programming: Systematic Reuse with ACE and Frameworks](http://www.cs.wustl.edu/~schmidt/ACE/book2/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-10T01:09:54.440

将读取作为 while 条件的一部分。

```
while((remainingSize > 0) && (count = read(connect_fd, iter, remainingSize)) > 0)
{
    iter += count;
    remainingSize -= count;
} 
```

这样，如果失败，您将立即停止循环。
将读取用作循环条件的一部分是非常常见的模式，否则您需要检查循环内的状态，这会使代码变得更丑陋。

就个人而言：
我会将上述整个测试移到一个单独的函数中以提高可读性，但您的里程可能会非常大。

同样使用 malloc （和公司）将导致一整条内存管理问题。我会使用 std::vector。当您修改代码以开始抛出异常时，这也将在未来证明代码，现在它也将是异常安全的。

因此，假设您将 data.data 更改为 std::vector<unsigned char> 类型，那么

```
if ( data.size > 0 )
{
    std::vector<unsigned char>   buffer(data.size);

    unsigned char *iter = &buffer[0];
    while(...  read(connect_fd, iter, remainingSize) )
    {
        .....
    }

    ... handle error as required

    buffer.resize(buffer.size() - remainingSize);
    data.data.swap(buffer);
} 
```

# sql - 此查询中的 IF 是什么

> ID：736191
> 
> 赞同：0
> 
> 时间：2009-04-09T23:05:17.113
> 
> 标签：sql

这是我的查询

```
update b
set b.col1 =   if(1) <= 0
             begin
              select 1 as bal
                end
             else 
              select 0 as bal

from 
dbo.table1 b
inner join  dbo.table1 a
on b.id = a.id
and b.date = a.date 
```

“IF”部分本身就很好用。把它放在这个查询表单中会抛出

关键字“if”附近的语法不正确。

我是否错过了除了睡眠之外的其他东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-09T23:08:09.710

您需要在查询中使用 CASE WHEN 语句

```
update b
set b.col1 = CASE WHEN 1 <= 0 THEN 1 ELSE 0 END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-09T23:20:49.837

“if”是一个语句，所以你不能将它用作表达式。您可以改用“案例”：

```
update b
set b.col1 = case when 1 <= 0 then 1 else 0 end
from  dbo.table1 b
inner join dbo.table1 a on b.id = a.id and b.date = a.date 
```

（尽管 if 中的表达式没有多大意义，因为条件总是具有相同的值。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-09T23:11:26.800

如何使用

```
set b.col1 = case when if(1) <=0 then 1 else 0 end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T23:24:48.797

是的。

在某些 SQL 方言中，有一个`if`that's 函数。如果（表达式 1，表达式 2，表达式 3）

在某些 SQL 方言中，存在一种`if ...then .. endif`控制流结构。

一些 SQL 方言两者兼有。

后一种形式通常只能在存储过程/函数中使用；前者在任何可以使用功能的地方。

# php - 使数组值变量（PHP）

> ID：736201
> 
> 赞同：3
> 
> 时间：2009-04-09T23:08:47.977
> 
> 标签：php, arrays, variables

假设我想回显一个数组，但我想让数组中的值回显变量，我该怎么做？

下面是对我不会做的事情的解释，但这不是正确的语法。

```
$number = 0;
echo myArray[$number]; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-09T23:11:02.357

我不确定你是什么意思。你所拥有的东西不起作用，因为你缺少一个`$`in `myArray`：

```
$myArray = array('hi','hiya','hello','gday');
$index = 2;
echo $myArray[$index]; // prints hello
$index = 0;
echo $myArray[$index]; // prints hi 
```

与其他语言不同，[所有 PHP 变量类型都以美元符号开头](http://us.php.net/manual/en/language.variables.basics.php)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-09T23:22:32.000

只是为了添加更多。另一种类型的数组是关联数组，其中元素是使用一些标识符确定的，通常是字符串。

```
$arrayStates = array('NY' => 'New York', 'CA' => 'California'); 
```

要显示这些值，您可以使用：

```
echo $arrayStates['NY']; //prints New York 
```

或者，您也可以使用其数字索引

```
echo $arrayStates[1]; //prints California 
```

要迭代数组的所有值，请使用 foreach 或 for。

```
foreach($arrayStates as $state) {
        echo $state;
} 
```

请记住，如果在非数组上使用 foreach，则会产生警告。所以你可能想做：

```
if(is_array($arrayStates)) {
    foreach($arrayStates as $state) {
            echo $state;
    }
} 
```

希望有帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T23:11:40.093

你快到了：

```
$number = 0;
$myArray = array('a', 'b')
echo $myArray[$number];   // outputs 'a' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-09T23:18:16.863

```
$myArray = array("one","two","three","four");
$arrSize=sizeof($myArray);

for ($number = 0; $number < $arrSize; $number++) {
echo "$myArray[$number] ";
}

// Output: one two three four 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-05T08:18:44.280

```
$myArray = array('hi','hiya','hello','gday');

for($count=0;$count<count($myArray);$count++)
{
  $SingleValue = $myArray[$count];
  $AllTogether = $AllTogether.",".$SingleValue;
} 
```

# .net - 帮助我为 mssql 数据库生成 xml 架构的工具？

> ID：736204
> 
> 赞同：0
> 
> 时间：2009-04-09T23:10:08.597
> 
> 标签：.net, sql-server, xsd

我希望能够生成我的 MSSQL 数据库结构的 xsd。是否有任何工具或库可以帮助我做到这一点？

用于类型化数据集的 VS 设计器已接近尾声，但我正在寻找一种编程方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T23:51:57.560

由于没有标准方法可用于将关系数据导出到 XML 文档中，因此也没有一种方法可以为该数据生成 XSD。

但是......我通过使用 Access 创建一个小型数据库模型，然后从 Access 导出到 XML 数据和 XSD 模式文件，从而克服了类似的障碍。（我不记得确切的菜单命令；它们并不明显，但它们确实存在。）生成的 XML 和 XSD 不适合我的应用程序，但只需使用该示例就足以获得我开始了。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T00:13:07.230

Altova 最新版本的 XMLSpy 可以做到这一点。选项位于转换|从 DB 结构创建 XML 模式。它不是很好（生成的模式并不是一个它实际上接受为有效的模式，因为它包含了一些杂乱无章的东西——这很奇怪），但它包括主键和外键。这并不完全是一种编程方法，但它可能会让您入门。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-28T18:12:52.783

迪诺，你试过这个吗？

```
SELECT col1, col2 from YourTable for xml AUTO, ELEMENTS 
```

这是另一个不错的例子： [http ://codingsense.wordpress.com/2008/12/31/mssql-output-in-xml-using-for-xml/](http://codingsense.wordpress.com/2008/12/31/mssql-output-in-xml-using-for-xml/)

# ruby-on-rails - 没有要加载的文件 -- openid/extensions/sreg

> ID：736217
> 
> 赞同：0
> 
> 时间：2009-04-09T23:18:08.687
> 
> 标签：ruby-on-rails, ruby, openid

我在 Mac OS X 10.5.6 上运行 ruby​​ 1.8.6 和 rails 2.3.2。

我正在尝试让 ruby​​ 脚本/服务器工作......

我已经完成了 mysql 和 imagemagick 的安装，现在我遇到了以下错误：

```
=> Booting Mongrel
=> Rails 2.3.2 application starting on http://0.0.0.0:3000
/Library/Ruby/Site/1.8/rubygems/custom_require.rb:31:in `gem_original_require': no such file to load -- openid/extensions/sreg (MissingSourceFile) 
```

就在收到此错误之前，我已在 openid 相关文件中将“gem”替换为“require_gem”......

有什么建议么？

谢谢，

迪恩理查森

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T06:57:56.930

宝石安装openid

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T03:36:54.230

是否安装了 open id gem？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-11-12T20:48:36.507

只需安装 gem **oa-openid**

来源：[https ://github.com/intridea/omniauth/wiki/OpenID-and-Google-Apps](https://github.com/intridea/omniauth/wiki/OpenID-and-Google-Apps)

# javascript - 为双网站 + AIR 桌面应用程序设计代码

> ID：736221
> 
> 赞同：0
> 
> 时间：2009-04-09T23:19:52.473
> 
> 标签：javascript, air, offline, offline-mode

我想使用 AIR 创建“webapp”类网站的离线版本（大量 ajax、前端代码）。

没有比 HelloWorld 示例更进一步，我一直想知道：您如何设计代码，以最大限度地在网站（例如 php 或 Java 或 .Net）和 AIR 应用程序之间重用代码？

你真的可以 100% 重用前端代码吗，前提是它是为 AIR 应用程序设计的？你会怎么做呢？

例如，该网站进行了许多具有延迟的 Ajax 调用，并使用了侦听器。AIR 应用程序不需要侦听器，它可以同步运行数据库请求，也不需要运行 ajax 调用，对吧？你会为此写一个抽象层吗？因此，AIR 应用程序上的相同调用不会执行 xmlhttp，而是使用 AIR 实现服务器端代码；并打电话给听众？所以你不必重写前端代码模式？

这有意义吗？在谷歌上搜索真的很难。我在想一定有一篇关于某人经历过的好文章，也许还有一个框架来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-04-27T14:21:28.953

我已经编写了一些 Adob​​e Air 应用程序。我对您的建议是，您可以根据 Air 或 Web 服务提供的服务来考虑您的应用程序。那是您的代码中必须复制的部分。

因此，您应该隔离所有 Adob​​e air 特定代码，并为 Web 服务提供一种方法来执行相同的操作：例如，存储首选项、读取文件、查询数据库。

部署应用程序时，您可以选择加载连接到空中“服务”或 Web 服务的代码。

# apache-flex - 在 Flex 中禁用 WindowedApplication 调整大小

> ID：736223
> 
> 赞同：3
> 
> 时间：2009-04-09T23:21:05.047
> 
> 标签：apache-flex, flex3, air

我正在尝试使 Flex 中的 WindowedApplication 无法调整大小。但是，可调整大小是该类的只读公共变量。

如何使用户无法调整 Flex 应用程序（在 Adob​​e Air 中运行）的大小？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-10T02:48:17.747

如果你的项目被调用`foo`，`foo-app.xml`也会自动生成。这是一个应用程序配置文件。编辑此文件，特别是更改：

```
<!-- Whether the user can resize the window. Optional. Default true. -->
<!-- <resizable></resizable> --> 
```

到：

```
<!-- Whether the user can resize the window. Optional. Default true. -->
<resizable>false</resizable> 
```

（注：该属性一般会被注释掉，默认值为true。）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-07-31T16:39:05.710

要使主窗口应用程序既不能调整大小也不能最大化，请转到 Flash Builder 中应用程序的 src 文件夹并打开**your-application-name-app.xml**文件。（这是您项目的应用程序配置文件。）现在对该文件中的 maximizable 和 resizable 属性进行以下调整：

```
<maximizable>false</maximizable>
<resizable>false</resizable> 
```

# bash - 如何让 CURL 保存到不同的目录？

> ID：736225
> 
> 赞同：6
> 
> 时间：2009-04-09T23:21:17.510
> 
> 标签：bash, curl

我需要能够传入文件下载的 URL，以及要保存文件的路径。

我认为这与 CURL 上的 -O 和 -o 有关，但我似乎无法弄清楚。

例如，这就是我现在在 bash 脚本中使用的内容：

```
#!/bin/sh

getsrc(){
    curl -O $1
}

getsrc http://www.apache.org/dist/ant/binaries/apache-ant-1.7.1-bin.tar.gz 
```

如何更改 curl 语句以便我可以做到

```
getsrc http://www.apache.org/dist/ant/binaries/apache-ant-1.7.1-bin.tar.gz /usr/local 
```

并让它将文件保存到/usr/local？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-10T06:17:10.897

如果这是一个脚本，您应该确保您已准备好应对任何意外情况：

```
getsrc() {
    ( cd "$2" && curl -O "$1" )
} 
```

这意味着*引用*您的参数，以防它们包含 shell 元字符，例如问号、星号、空格、制表符、换行符等。

这也意味着在目标目录不存在的情况下使用and命令`&&`之间的运算符（如果不使用它，curl 仍然会下载而不会出错，但将文件放在错误的位置！）`cd``curl`

该函数有两个参数：

*   应下载的数据的 URL。
*   应存储数据的本地 PATH（使用基于 URL 的文件名）

要指定本地文件名而不是路径，请使用更简单的：

```
getsrc() {
    curl "$1" > "$2"
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-09T23:29:38.957

嗯...你可能想要做的是

```
getsrc(){
    ( cd $2 > /dev/null ; curl -O $1 ; ) 
} 
```

-O（*大写*O）表示存储在本地命名为远程文件，但忽略远程路径组件。为了能够存储在特定目录中，最简单的方法是 cd 到它...我在子 shell 中执行此操作，因此目录更改不会传播

# c# - P/Invoke 教程？

> ID：736227
> 
> 赞同：5
> 
> 时间：2009-04-09T23:22:18.427
> 
> 标签：c#, interop, pinvoke, uac

有谁知道深入 System.Runtime.InteropServices 命名空间的好教程/电子书？我刚刚阅读[了](http://www.blackwasp.co.uk/ElevatedButton.aspx)有关如何使 UAC 盾牌出现在按钮中的教程，现在我真的很想学习这个。

PS如何在Windows系统文件中查看是否存在在按钮中显示UAC屏蔽的方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-09T23:28:57.057

[http://pinvoke.net](http://pinvoke.net)上有很多实际示例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T00:10:59.577

也可以查看[P/Invoke Interop Assistant](http://clrinterop.codeplex.com/)。那里有一些很棒的代码，还有一个非常有用的工具。它使学习变得容易得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T01:02:27.393

至于你的ps，你需要的代码在你提供的信息里。您使用 SendMessage 方法将 BCM_SETSHIELD 消息发送到应该显示它的句柄（在本例中为按钮的句柄）。

## 编辑

pinvoke.net 是获取原生函数原型的好地方，但如果您不知道自己在寻找什么，那么它并不是最好的。我会建议[MSDN 的 Windows API 参考部分](http://msdn.microsoft.com/en-us/library/aa383749(VS.85).aspx)。您可以按字母顺序、按类别和按 Windows 版本浏览函数，所有函数都包含它们的功能、返回的内容以及控制其操作的标志选项的描述。

# c# - 接口暴露类型 A，但实现需要类型 B（A 的子类）

> ID：736230
> 
> 赞同：0
> 
> 时间：2009-04-09T23:23:12.543
> 
> 标签：c#, generics, arguments

我有一个我一直在努力的系统。本质上，它使用大量抽象来处理以后的扩展不仅是预期的，而且是必要的。需要这样做的一个地方是数据访问。该系统通常处理封装一些观察（在观察值或一组值的意义上）并使用它们的管理对象。为此，我有一些大意：

```
public interface Observation 
{
    /** UniqueKey is used to access/identify an observation */
    UniqueKey Key
    {
        get;
    }
}

public interface ObservationDataSource
{
    /** 
      * Retrieves an Observation from the actual data source.
      * performs any necessary operations to encapsulate values in object
      */
    Observation GetObservationByUniqueKey(UniqueKey key);
} 
```

这些接口的特定实现会出现问题。最终，`Observation`and`ObservationDataSource`类是用特定的运行时类实现的。但是，`UniqueKey`也可以扩展以处理用于数据源中观察的任何唯一标识值集（可能是 id，可能是时间等）。所以任何实现`GetObservationByUniqueKey`都会暴露一个`UniqueKey`参数，但需要一个特定的子类。我希望在`UniqueKey`传入后将其转换为特定类型。

这似乎是一个糟糕的设计选择，因为实现对参数要求撒谎——但我看不到另一种方法。我希望其他人使用这些接口，所以我不能说我会记住这个约定。

有什么想法可以修复它或更优雅地处理它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T15:09:16.420

你说

> 所以 GetObservationByUniqueKey 的任何实现都会暴露一个 UniqueKey 参数，

然而，这是不正确的。它不会暴露参数 - 它会收到一个。正如您所说，调用者可能会传递任意唯一键，这没有任何问题。

对于特定的数据源，只有特定的唯一键才会有相关的观察 - 而不仅仅是特定的 wrt。类型，但也是具体的。为实际值。如果该值没有关联的观察，则返回 null （我想）。如果 uniqueid 的类型不正确，请执行相同的操作 - 如果有人在预期 ID 的时间过去了，则在该数据源中没有与该键关联的观察。

OTOH，如果调用者可以自由选择唯一的 id，并且数据源应该返回一个空的观察值以由调用者填充，那么您有两种选择：

1.  首先不要使用接口。显然，您不能用一种实现替代另一种，调用者必须知道他们使用的是什么实现。
2.  或者，确保所有实现都支持各种唯一键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T23:45:28.933

我不确定这是否是您想要的，但在我看来，您可以尝试使用泛型：

```
public interface Observation<T> where T : UniqueKey
{
    T Key { get; }
}

public interface ObservationDataSource<T> where T : UniqueKey
{
    Observation<T> GetObservationByUniqueKey(T key);
} 
```

现在，该接口使用您的类所需的 UniqueKey 的特定子类进行强类型化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T00:29:32.307

我不认为这是一个问题，只需修改您的以下声明：

> 因此，GetObservationByUniqueKey 的任何实现都将公开一个 UniqueKey 参数，但当**且仅当该 UniqueKey 是由此 ObservationDataSource 生成时才需要**一个特定的子类。

如果 UniqueKey 不是预期的类型，那只是一个微不足道的拒绝案例，可以通过以下两种方式之一处理：

(1) 通过在 ObservationDataSource 接口中暴露 UniqueKeyType 属性，GetObservationByUniqueKey 的调用者可以先验地检查 UniqueKey 的实例类型。

(2) 每个 GetObservationByUniqueKey 实现者的合同责任是处理其未生成 UniqueKey 的情况。（这对我来说似乎完全合理）

但是，您的整个问题都引出了一个问题-当您已经定义了查找函数来获取数据对象时，为什么要首先允许 UniqueKey 是多态的？

# silverlight - 如何使用 MediaStreamSource 播放来自 matroska 文件的 h264 帧？

> ID：736235
> 
> 赞同：2
> 
> 时间：2009-04-09T23:25:21.777
> 
> 标签：silverlight, silverlight-3.0, h.264

我正在尝试使用 MediaStreamSource 渲染来自 silverlight 3 中的 mkv h264 文件的帧。解析 mkv 文件很好，但我正在努力处理 SL 中 CodecPrivateData 的预期值，它必须是一个字符串，而来自 mkv 的 PrivateData 信息是一个二进制元素。另外，我不确定帧应该以哪种形式提供给 SL（即，它们存储在 mkv / mp4 中的方式，或转码为 NALU） 有人知道这方面的信息吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-05-01T13:01:37.883

在我自己的类似问题和令人头疼的问题之后，我能够回答这个问题。

*   在 ReportOpenMediaCompleted() 中，当设置您的视频流描述时，您可以忽略 CodecPrivateData 属性字符串，尽管文档说明了什么。这不是必需的。（假设您的 NAL 单元流包括 SPS 和 PPS 单元）

*   对于每个 GetSampleAsync() 请求，您应该将一个 NAL 单元发送回 MediaElement。这包括非图片 NAL 单元，例如 SPS/PPS 单元。

*   当您发送 NAL 单元时，请确保每个单元的开头都有 3 字节的起始码 (0x00 0x00 0x01)。（这类似于“附件 B”格式，但不完全相同）

*   在 ReportGetSampleCompleted() 中，将“Offset”的值设置为 NAL 起始代码的开头，而不是实际数据。（在大多数情况下，这将是零，假设您使用每个 NAL 单元的新流）

我在[博客上写了一些关于这里的经历，](http://nonsenseinbasic.blogspot.com/2011/05/silverlights-mediastreamsource-some.html)并希望写更多的博客。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T14:11:54.110

CodecPrivateData 是“avcC”原子的内容，它是 MP4 文件中“stsd”原子的子元素。您必须将二进制数据转换为字符串。它看起来像这样：“014D401FFFE10017674D401F925402802DD0800000030080000018478C195001000468EE32C8”

您还必须将 mkv/mp4 长度替换为 NALU。我已经写了一些关于这个（让平滑流处理 H.264 文件）。

问候，

请参阅：[平滑流式传输 H264](http://h264.code-shop.com/trac/wiki/Smooth-Streaming-H264)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-24T10:13:20.897

根据文档，编解码器私有数据应设置为 00000001 + sps + 00000001 + pps。但是**文档是错误**的， CodecPrivateData 的值似乎被完全忽略了。相反，您需要将 SPS 和 PPS NALS（当然带有附件 b 标头）作为`GetSampleAsync`.

对于常规媒体样本，正常的 4 字节附件 b 标头标头可以正常工作

# javascript - 将 JavaScript 放在页面末尾会产生错误

> ID：736243
> 
> 赞同：3
> 
> 时间：2009-04-09T23:31:16.143
> 
> 标签：javascript

我最近读到，为了更快的网页加载，将 JavaScript 链接放在末尾是一个好习惯。我做了，但现在引用文件的功能不起作用。如果我把链接放在页面的开头，一切都很好。

这种将 JavaScript 放在最后的事情是否仅在某些情况下才有效？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-09T23:56:01.733

我也对此进行了一些测试。如果您正在加载 Javascript 文件，则将其放在末尾会更快，但它确实带有一些重要的警告。

首先是这样做通常会使我的一些视觉效果引人注目。例如，如果我使用 jQuery 来格式化表格，表格会出现未格式化的情况，然后代码会运行以重新格式化它。我认为这不是一个好的用户体验，我宁愿页面完整。

其次，把它放在最后使得在你的页面中放置代码变得很困难，因为通常函数还不存在。如果您的页面中有此内容：

```
$(function() {
  // ...
}); 
```

好吧，在定义 jQuery 对象之前，这将不起作用。如果它是在页面末尾定义的，则上述将产生错误。

现在您可能会争辩说，所有样式代码都可以放在外部文件中，但出于性能原因，这将是一个错误。我开始在一个项目上这样做，然后发现我的页面花了一秒钟时间来运行所有集中的 Javascript。所以我为相关行为创建了函数，然后在每个页面中调用适当的函数，将 Javascript 加载运行时间减少到 50-200 毫秒。

最后，您可以（并且应该）通过对 Javascript 文件进行版本控制，然后使用远期的 Expires 标头来最小化 Javascript 的加载时间，因此它们只加载一次（每次更改时），此时它们所在的位置该文件在很大程度上无关紧要。

所以总而言之，我发现将 Javascript 文件放在文件末尾很麻烦并且最终没有必要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T23:38:30.043

您确实必须注意排序，但是像 JQuery 这样的库可以很容易地做到这一点。在页面的末尾，包含您需要的所有 .JS 文件，然后，在单独的文件或页面本身中，放置 Jquery 调用以对页面内容进行操作。

因为 JQ 处理 css 样式的选择器，所以很容易避免在页面主体中使用任何 Javascript - 而是将它们附加到 ID 和类。这被称为[不显眼的 Javascript](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T23:52:38.573

我记得的每一个 Yahoo YUI 示例文件最后都包含*几乎*所有的 JavaScript。例如，

*   [简单的事件处理](http://developer.yahoo.com/yui/examples/event/eventsimple.html)
*   [基本拖放](http://developer.yahoo.com/yui/examples/dragdrop/dd-basic.html)
*   [JSON：在解析期间添加新对象成员](http://developer.yahoo.com/yui/examples/json/json_convert_values.html)

看起来 Yahoo Practice 大致是“<body> 开头的库代码，<body> 末尾的活动代码”。

但请注意，这可能会导致[Flash of Unstyled Content](http://bluerobot.com/web/css/fouc.asp/)综合症。

# c# - C#变量标签？

> ID：736244
> 
> 赞同：0
> 
> 时间：2009-04-09T23:31:19.873
> 
> 标签：c#, .net

假设我有一个显示启用或禁用的框。如何使文本因州而异？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-09T23:38:01.620

```
public void CheckBox1CheckedChanged(object sender, EventArgs e)
{
    if (checkBox1.Checked) {
        checkBox1.Text = "Enabled";
    }
    else {
        checkBox1.Text = "Disabled";
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-09T23:32:32.973

```
box.Text = (box.Enabled ? "ENABLED" : "DISABLED"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-09T23:35:36.743

如果我理解正确，您是在问如何让标签或其他一些 UI 文本自动更新以反映“状态变量”。这只是完成您所描述的内容的一种方法：

我会通过一个实现[INotifyPropertyChanging](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanging.aspx)和[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)的​​中央状态对象来做到这一点。当您的应用程序初始化时，将事件处理程序附加到这些接口公开的事件，并且这些事件处理程序之一可以在属性 (Foo) 更改时更改标签的文本。

```
public class State : INotifyPropertyChanging, INotifyPropertyChanged
{
    public event PropertyChangingEventHandler PropertyChanging;

    public event PropertyChangedEventHandler PropertyChanged;

    protected void OnPropertyChanging(PropertyChangingEventArgs e)
    {
        if (this.PropertyChanging != null)
        {
            this.PropertyChanging(this, e);
        }
    }

    protected void OnPropertyChanged(PropertyChangedEventArgs e)
    {
        if (this.PropertyChanged != null)
        {
            this.PropertyChanged(this, e);
        }
    }

    public bool Foo
    {
        get
        {
            return foo;
        }
        set
        {
            if (value != foo)
            {
                this.OnPropertyChanging(new PropertyChangingEventArgs("Foo"));
                foo = value;
                this.OnPropertyChanged(new PropertyChangedEventArgs("Foo"));
            }
        }
    }

    private bool foo = false;
}

protected void HandleStateChanged(object sender, PropertyChangedEventArgs e)
{
    if(e.PropertyName == "Foo")
    {
        box.Text = state.Foo ? "Enabled" : "Disabled";
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-09T23:39:18.543

jeffamaphone 说了什么，但我应该补充一点，只要状态发生变化，您就必须确保运行相同的代码。确保发生这种情况的最简单方法是将 box.Text 属性绑定到您感兴趣的状态对象。这样，对对象所做的任何更改都会立即反映在文本中。

[这篇博文](http://blogs.msdn.com/wpfsdk/archive/2006/10/19/wpf-basic-data-binding-faq.aspx) 帮助我开始使用数据绑定......因为我喜欢常见问题解答。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T23:57:15.363

在过去的几个月里，我一直在使用比实现整个类来管理状态的更轻量级的解决方案。我通常定义一个枚举来指示 UI 中可用的状态类型，然后我有一个函数可以根据所选状态对 UI 进行更改。这种方法非常成功，并且在需要编写的代码量方面并不算太重。

如果我想知道 UI 中有哪些可用状态，我可以检查枚举的值。

```
public enum SystemState
{
    /// <summary>
    /// System is under the control of a remote logging application.  
    /// </summary>
    RemoteMode,

    /// <summary>
    /// System is not under the control of a remote logging application.
    /// </summary>
    LocalMode
}

public interface IView
{
    void SetState(SystemState state);
}

//method on the UI to modify UI
    private void SetState(SystemState state)
    {
        switch (state)
        {
            case SystemState.LocalMode:

                //for now, just unlock the ui
                break;
            case SystemState.RemoteMode:

                //for now, just lock the ui
                break;
            default:
                throw new Exception("Unknown State requested:" + state);
        }
    }

    //now when you change state, you can take advantage of intellisense and compile time checking:
    public void Connect()
    {
            SetState(SystemState.RemoteMode);
    } 
```

# c# - 如何从弹出窗口返回值

> ID：736245
> 
> 赞同：2
> 
> 时间：2009-04-09T23:31:35.007
> 
> 标签：c#, asp.net, javascript, webforms

我正在使用 asp.net webforms 2.0，c#。

我需要的是一种简单、优雅的方式来执行以下操作：

用户单击 webform A 中的元素；弹出Webform B；用户与网络表单 B 交互；在关闭 webform B 时，可能通过提交按钮，webform aa 中的源元素将使用来自 webform B 的值进行更新。

这里将涉及哪些技术？当然，除了 Javascript 和 c#。我可以在没有 Ajax 的情况下做到这一点吗？

编辑：

澄清一下，WEBform B 会保存输入数据库的数据，比如客户信息，然后它会返回客户 ID（保存后），这个客户 ID 需要传递给父窗口，之后应该刷新。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T23:39:31.430

您可以使用 JavaScript：

```
<script language="javascript">
window.opener.location.reload();
self.close();
</script> 
```

上面的代码显示了如何关闭“opener”窗口，但它应该给你一个大致的想法。（此代码在弹出窗口中）。您可以使用相同的方法通过调用其中的 JavaScript 函数将值传递给“打开器”窗口。

```
<script language="javascript">
window.opener.functionA('ABC123');    
</script> 
```

如果要将变量从 ASP 传递到 JavaScript 函数，请使用：

```
window.opener.functionA('<%=userId%>'); 
```

或者

```
var userId = '<%=userId%>';
window.opener.functionA( userId ); 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T00:34:53.777

如果您使用的是 ASP.NET 2.0，则可以将第二页回发到第一页，然后使用 IsCrossPagePostBack 检测它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-10T00:25:37.323

``function webFormAClick(){ var theReturnValue = window.showModalDialog("webFormB.html", myArguments, ''); }` `# sql-server-2005 - 为什么模式会使 XML 列变慢？

> ID：736248
> 
> 赞同：0
> 
> 时间：2009-04-09T23:32:41.790
> 
> 标签：sql-server-2005, performance, xsd, sqlxml

我有一个带有 XML 列的表。这些文档非常庞大且数量众多，我一直在尝试各种方法来提高基本查询的性能。

因为文档表明将 XML Schema 应用于列可以帮助 SQL Server 优化查询 - 并且因为有可用的查询 - 我创建了一个模式集合并将类型应用于我的 XML 列。

查询性能一落千丈。

我的意思是，最简单的测试变得非常缓慢。我删除了列类型，查询的执行和以前一样。这有发生在其他人身上吗？

我应该注意到，模式本身相当大而且很复杂。尽管如此，这个结果对我来说似乎违反直觉。

**编辑：**我只关心 SELECT 语句——事实上，这些文档永远不会被编辑，只会被浏览。因此，一旦插入并验证了记录，我看不出除了可能的优化之外，为什么还需要模式。

另外，我知道[这个问题](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=116943)，XML 列上的*索引*会对性能产生不利影响。这不是我的问题——索引对我正在运行的查询没有明显的影响，无论是正面的还是负面的，并且我已经尝试了使用和不使用索引的上述场景。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-09T23:48:34.590

我想你已经得到了答案：

> *我应该注意到架构本身相当大而且很复杂*

复杂的模式可能是计算密集型的。如果您在更新方面做了很多工作，则必须多次验证模式。

# ruby - 以小时为单位的时差

> ID：736253
> 
> 赞同：70
> 
> 时间：2009-04-09T23:37:42.697
> 
> 标签：ruby, time

我试图获得两个不同时间实例的小时差异。我从数据库中获取这些值作为 :datetime 列

我怎样才能做到这一点，以便它在计算中包括月份和年份，同时忽略或四舍五入分钟？这只能手动完成还是有功能可以做到这一点？

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2009-04-09T23:56:57.423

```
((date_2 - date_1) / 3600).round 
```

或者

```
((date_2 - date_1) / 1.hour).round 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-04-18T14:37:30.040

[在https://rubygems.org/gems/time_difference](https://rubygems.org/gems/time_difference)尝试 Ruby 的 Time Difference gem

```
start_time = Time.new(2013,1)
end_time = Time.new(2014,1)
TimeDifference.between(start_time, end_time).in_years 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2011-08-28T13:56:05.707

这很好用，例如自用户创建帐户以来的小时数

```
(Time.parse(DateTime.now.to_s) - Time.parse(current_user.created_at.to_s))/3600 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2011-03-09T16:27:09.633

您可以使用名为[time_diff](https://rubygems.org/gems/time_diff)的 gem以非常有用的格式获取时差

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-06-12T17:15:36.820

您可以使用 Rails 的方法`distance_of_time_in_words`

```
distance_of_time_in_words(starting_time, ending_time, options = {include_seconds: true }) 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-08-08T11:01:56.640

在 Rails 中，现在有一种**更自然的方式**来实现这一点：

```
> past = Time.now.beginning_of_year
2018-01-01 00:00:00 +0100

> (Time.now - past) / 1.day
219.50031326506948 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-10-19T00:46:15.067

## in_hours (Rails 6.1+)

Rails 6.1 引入了新的[ActiveSupport::Duration](https://edgeapi.rubyonrails.org/classes/ActiveSupport/Duration.html)转换方法，例如[in_seconds](https://edgeapi.rubyonrails.org/classes/ActiveSupport/Duration.html#method-i-in_seconds)、[in_minutes](https://edgeapi.rubyonrails.org/classes/ActiveSupport/Duration.html#method-i-in_minutes)、[in_hours](https://edgeapi.rubyonrails.org/classes/ActiveSupport/Duration.html#method-i-in_hours)、[in_days](https://edgeapi.rubyonrails.org/classes/ActiveSupport/Duration.html#method-i-in_days)、[in_weeks](https://edgeapi.rubyonrails.org/classes/ActiveSupport/Duration.html#method-i-in_weeks)、[in_months](https://edgeapi.rubyonrails.org/classes/ActiveSupport/Duration.html#method-i-in_months)和[in_years](https://edgeapi.rubyonrails.org/classes/ActiveSupport/Duration.html#method-i-in_years)。

结果，现在，您的问题可以解决为：

```
date_1 = Time.parse('2020-10-19 00:00:00 UTC')
date_2 = Time.parse('2020-10-19 03:35:38 UTC') 

(date_2 - date_1).seconds.in_hours.to_i
# => 3 
```

这是[相应 PR 的链接](https://github.com/rails/rails/pull/38699)。

# c# - 填充嵌套中继器下拉列表

> ID：736257
> 
> 赞同：1
> 
> 时间：2009-04-09T23:38:34.333
> 
> 标签：c#, .net, linq, drop-down-menu, repeater

我有嵌套的中继器，它们创建一个表格，每个单元格由 3 个下拉列表组成。我通过循环遍历中继器并将它们分配给 LINQ 语句的结果来设置下拉列表的选定值。

数字和特征下拉菜单工作正常，但 make 下拉菜单都设置为最后分配的值。有谁知道为什么会这样？

```
<table border="1">
        <tr>
            <th>Priority</th>
            <th>Monday</th>
            <th>Tuesday</th>
            <th>Wednesday</th>
            <th>Thursday</th>
            <th>Friday</th>
            <th>Saturday</th>
            <th>Sunday</th>
        </tr>
    <asp:Repeater id="PriorityRepeater" runat="server" OnItemDataBound="PriorityBound">
        <ItemTemplate>
            <tr>
                <td>
                    <asp:HiddenField ID="Priority" runat="server" Value='<%# Eval("Priority") %>' />
                    <%# Eval("Priority") %>
                </td>
                <asp:Repeater ID="DayRepeater" runat="server">
                    <ItemTemplate>
                        <td>
                            <asp:HiddenField ID="Day" runat="server" Value='<%# Eval("Day") %>' />
                            <!--%# Eval("Day") %-->
                            <label>Vehicles</label>
                            <asp:DropDownList id="dailyNumber_dd" runat="server">
                                <asp:ListItem Text="5" />
                                <asp:ListItem Text="10" />
                                <asp:ListItem Text="15" />
                                <asp:ListItem Text="25" />
                                <asp:ListItem Text="30" />
                                <asp:ListItem Text="35" />
                                <asp:ListItem Text="40" />
                                <asp:ListItem Text="45" />
                            </asp:DropDownList>
                            <br /><br />
                            <asp:DropDownList runat="server" id="dailyCharacteristic_dd" style="font-size:small">
                                <asp:ListItem Text="New Inventory" Value="newest" />
                                <asp:ListItem Text="Old Inventory" Value="oldest" />
                                <asp:ListItem Text="Lowest Price" Value="cheap" />
                                <asp:ListItem Text="Highest Price" Value="expensive" />
                                <asp:ListItem Text="Oldest Year" Value="oldyear"/>
                                <asp:ListItem Text="Newest Year" Value="newyear" Selected="True"/>
                            </asp:DropDownList>
                            <br /><br />
                            <asp:DropDownList runat="server" id="dailyMake_dd" Width="108" style="font-size:small"></asp:DropDownList>
                        </td>
                    </ItemTemplate>
                </asp:Repeater>
            </tr>
        </ItemTemplate>
    </asp:Repeater>
    </table>

foreach (RepeaterItem row in PriorityRepeater.Items)
            {
                HiddenField myPriority = (HiddenField)row.FindControl("Priority");
                Repeater DayRepeater = (Repeater)row.FindControl("DayRepeater");
                foreach (RepeaterItem col in DayRepeater.Items)
                {
                    DropDownList dailyMake_dd = (DropDownList)col.FindControl("dailyMake_dd");
                    DropDownList dailyNumber_dd = (DropDownList)col.FindControl("dailyNumber_dd");
                    DropDownList dailyCharacteristic_dd = (DropDownList)col.FindControl("dailyCharacteristic_dd");
                    HiddenField myDay = (HiddenField)col.FindControl("Day");
                    string thisDay = myDay.Value.ToString().ToLower();
                    string thisPriority = myPriority.Value.ToString();

                    tAutoSelection thisSelection = (from a in theSelections where a.day == thisDay select a).Single<tAutoSelection>();
                    if (thisPriority == "1")
                    {
                        //dailyMake_dd.SelectedValue = thisSelection.makes1;
                        dailyMake_dd.SelectedIndex = 5;
                        dailyNumber_dd.SelectedValue = thisSelection.num1.ToString();
                        dailyCharacteristic_dd.SelectedValue = thisSelection.char1;
                    }
                    else if (thisPriority == "2")
                    {
                        dailyMake_dd.SelectedIndex = 3;
                       // dailyMake_dd.SelectedValue = thisSelection.makes2;
                        dailyNumber_dd.SelectedValue = thisSelection.num2.ToString();
                        dailyCharacteristic_dd.SelectedValue = thisSelection.char2;
                    }
                    else if (thisPriority == "3")
                    {
                        dailyMake_dd.SelectedIndex = 9;
                       // dailyMake_dd.SelectedValue = thisSelection.makes3;
                        dailyNumber_dd.SelectedValue = thisSelection.num3.ToString();
                        dailyCharacteristic_dd.SelectedValue = thisSelection.char3;
                    }
                }
            } 
```

# perl - 如何使用 mod_perl 导出只读变量？

> ID：736260
> 
> 赞同：4
> 
> 时间：2009-04-09T23:40:59.163
> 
> 标签：perl, readonly, mod-perl, exporter

我试图通过创建一个导出本书中使用的几个标量的模块来更容易地遵循一些[Perl 最佳实践。](http://oreilly.com/catalog/9780596001735/)`Constants`特别是`$EMPTY_STRING`，我几乎可以在我编写的每个 Perl 脚本中使用它。我想要的是自动导出这些标量，这样我就可以使用它们而无需在每个脚本中明确定义它们。

```
#!perl
package Example::Constants;

use Exporter qw( import );
use Readonly;

Readonly my $EMPTY_STRING => q{};
our @EXPORT = qw( $EMPTY_STRING ); 
```

一个示例用法：

```
#!perl
use Example::Constants;
print $EMPTY_STRING . 'foo' . $EMPTY_STRING; 
```

使用上面的代码会产生错误：

```
Global symbol "$EMPTY_STRING" requires explicit package name 
```

如果我将`Readonly`声明更改为：

```
Readonly our $EMPTY_STRING => q{}; # 'our' instead of 'my' 
```

错误变为：

```
Attempt to reassign a readonly scalar 
```

这对 mod_perl 来说是不可能的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-13T21:59:24.850

我是 Readonly 模块的作者。下一个版本的 Readonly 将提供对 mod_perl 的支持，特别是因为这个问题。

*我知道这现在*不能解决你的问题，但是......好吧，我正在努力:-)

——埃里克

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T00:57:41.787

你有4个问题：

1.  你没有包括`strict`and `warnings`pragmas
2.  最好通过`base`编译指示包含出口商（因为它`@ISA`为您设置）
3.  `our`只能导出包变量（即变量）
4.  模块必须以真值结尾

这是更正后的模块。

```
package Example::Constants;

use strict;
use warnings;
use base 'Exporter';
use Readonly;

Readonly our $EMPTY_STRING => q{};
our @EXPORT = qw( $EMPTY_STRING );

1; 
```

嗯，我错过了尝试分配给只读的一点，听起来模块不止一次被加载。我相信 mod_perl 有一种[机制](http://perl.apache.org/docs/1.0/guide/config.html#PerlModule_and_PerlRequire_Directives)来加载与脚本本身分开的模块。此加载仅发生一次，因此您应该使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-12T06:43:49.410

我没有方便测试的 mod_perl 实例，所以我无法测试这些建议。我希望他们能成功。

尝试使用`Scalar::Util::readonly`检查变量是否已被标记为只读。

```
#!perl
package Example::Constants;

use Exporter qw( import );
use Readonly;
use Scalar::Util qw(readonly);

our $EMPTY_STRING;
our @EXPORT = qw( $EMPTY_STRING );

if ( !readonly( $EMPTY_STRING ) ) {
    Readonly $EMPTY_STRING => q{};
} 
```

您也可以尝试`use vars`：

```
#!perl
package Example::Constants;

use Exporter qw( import );
use Readonly;
use vars qw( $EMPTY_STRING );

Readonly $EMPTY_STRING => q{};
our @EXPORT = qw( $EMPTY_STRING ); 
```

您还可以使用 typeglob 常量：

```
#!perl
package Example::Constants;

use Exporter qw( import );
use Readonly;

our $EMPTY_STRING;
*EMPTY_STRING = \q{};
our @EXPORT = qw( $EMPTY_STRING ); 
```

使用 typeglob 常量似乎很完美，因为该技术的巨大限制（它需要一个全局包）在这里不是问题。

# seo - 以不同名称闻名的产品的 SEO

> ID：736264
> 
> 赞同：3
> 
> 时间：2009-04-09T23:43:58.097
> 
> 标签：seo, semantic-web, taxonomy

如果您销售小部件，我们都知道在标题和 H1 中包含“Bob's Widgets”可以让您在人们搜索“小部件”时在 Google 中获得更好的排名。

但是，如果正如前几天有人向我解释的那样，他们的产品在世界不同地区有不同的名字怎么办？

在美国，它被称为小部件。在加拿大，它被称为 Flidget。在澳大利亚，它被称为 Zidget。它实际上没有正式名称，只有非正式名称。

元标签没有问题，但除此之外，应对这种情况的最佳方法是什么？只是制作单独的页面？页面上不能有 3 个 H1。一个 H1，上面写着“小部件，（又名 Flidgets，Zidgets）”？

还是我只是相信谷歌足够聪明并且一些神奇的分类数据库将这三个词组合在一起作为同一个东西？

**编辑：**这个问题仅仅因为它是关于 SEO 而被否决的？多么奇怪。如果您甚至费心阅读该问题，您会发现我并没有试图玩弄系统或逃避任何事情。我有一个真正有趣的问题和一个有效的客户需求。

另请注意，我总是使用语义 HTML，我非常了解搜索引擎排名的工作原理，并且我不会试图逃避任何阴暗的事情。

如果我的客户销售啤酒，我会简单地使用语义 HTML 将“啤酒”这个词放在首位。如果我向法国人卖啤酒，我会用法语制作另一页，并用“biere”做同样的事情。但是想象一下，啤酒在其他英语国家不被称为“啤酒”。想象一下它被称为“reeb”。当不同的英语用户将使用不同的字符串进行搜索但搜索相同的内容时，我如何正确地对英语页面进行语义编码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T01:30:05.827

HTML 元标记*最初*是为了将此类元数据准确嵌入网页而创建的。但由于 SEO 行业和网络的商业化，主要搜索引擎不再使用“关键字”等元标记。

随着多年来页面排名算法和智能搜索机器人的所有进步，在合法网站的*主动*“搜索引擎优化”方面确实没有太多工作要做。在当今的搜索环境中，您所要做的就是**为访问者优化您的网站**，它会自动针对搜索进行优化。

因此，您可以通过执行以下任何（或全部）操作来被动优化您网站的排名：

*   使用良好的拼写和写作礼仪（比如不要用大写字母或文字信息来书写整个网站）
*   使用适当的标记格式化您的页面。（标题你的文档，用 H1/H2/等标记你的标题，分隔你的段落，等等。）
*   遵守既定的网络标准并编写格式良好的代码。
*   清除损坏的链接并确保您的网站正常运行。
*   不要使用弹出窗口、用横幅广告覆盖您的网站或以其他方式用广告轰炸访问者
*   不要链接到信誉不佳的网站

简而言之，让您的网站尽可能方便用户访问和访问。如果您的网站对访问者有用并提供有价值的内容，那么大多数主要搜索引擎，如 Google 或 Yahoo! 足够聪明，可以*公平地*对其进行排名。一开始您的排名可能并不高。但是，如果您真正提供高质量的内容，那么随着您的网站在网络上建立得更好，其他网站将开始链接到您，从而提高您的搜索排名。

如果链接到您网站的其他网页使用您的产品所引用的各种名称和昵称，那么您的网站也将与这些名称/关键字相关联（这就是 Google Bombing 的工作方式）。谷歌还跟踪同义搜索词，在某些情况下甚至足够聪明地推荐相关/替代搜索词。

另一方面，如果您正在创建一个垃圾邮件网站或第*1000 万个*会员营销网站，其产品和内容与其他 9,999,999 个相同性质的网站完全相同，那么您的搜索引擎排名会相当差。

通常只有没有原创内容的网站，并且没有为需要主动（黑帽）SEO技术才能获得体面排名的访问者提供合法价值的网站——在此过程中污染了搜索结果。否则，如果您实际上是在构建一个有用的网站，那么只需为您的访问者优化它并让 Google/Yahoo！做他们的工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T21:46:01.147

入站链接的锚文本比您使用的标签重要得多。因此，请尝试使用“beer”和“reeb”获取指向您页面的链接。只要你能获得足够的两个术语的链接，无论你在其中使用什么关键字，你都会在 SERP 中做得很好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T00:12:47.980

一种选择是为您感兴趣的不同目标区域本地化页面。

如果您使用本地域，谷歌将优先考虑该国家/地区的默认搜索。当我点击 www.google.com 时，它会将我重定向到 www.google.com.mx，并且我所做的任何搜索都倾向于显示来自墨西哥域的高结果。当我不想要这种行为时，我实际上必须选择几个选项。

我还认为谷歌可以选择将网站的一部分映射到一个区域，这样你就可以保留单个域。

**更新：**关于啤酒示例，您可以按国家/地区进行本地化（这就是我上面提到的）。其实这不是一个特殊的需要，因为英语英国和英语美国有它们的差异。

该演讲与语言无关，但请考虑 .net 如何处理资源。假设当前正在为 en-GB 处理请求，并且您正在寻找资源（即文本、图像等）。它将首先尝试查找特定文化的资源：en-GB，如果找不到，它将在更通用的 en 下查找（然后在默认资源文件中）。

前一个允许您有选择地在更具体的资源文件上本地化您真正需要的内容。如果您只需要使用键 beerName 对资源进行本地化，则只需在特定语言上进行配置，其余的保留。

# cron - 有没有办法安排一个不在每月第三个周末运行的 cron 作业？

> ID：736268
> 
> 赞同：1
> 
> 时间：2009-04-09T23:45:57.217
> 
> 标签：cron, posix

任何想法，任何人？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-12T19:39:29.093

将以下内容另存为`/usr/local/bin/is_third_week_in_month.sh`或某个地方

```
#!/bin/bash

if [ $# != 3 ]
then
    echo "Usage: $0 <yyyy> <mm> <dd>" 1>&2
    exit 127
fi

YEAR=$1
MONTH=$2
DAY=$3

FIRST_WEEK_IN_MONTH=`date +%V -d $YEAR-$MONTH-01`
WEEK_FOR_DAY=`date +%V -d $YEAR-$MONTH-$DAY`

DIFF=$(($WEEK_FOR_DAY - $FIRST_WEEK_IN_MONTH))

if [ $DIFF = 2 ]
then
    # this is the third week
    exit 0
else
    exit 1
fi 
```

然后添加到 crontab

```
12 00 * * 1,2,3,4,5  your_command
12 00 * * 6,7  test ! /usr/local/bin/is_third_week_in_month.sh `date "+%Y %m %d"` && your_command 
```

或者，如果您只想在 crontab 中包含一行，您也可以修改脚本以检查日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T00:03:25.567

在第 1、第 2、第 4 个（也许第 5 个，可能会发生）周末运行它。

```
# m h dom      mon dow   command
  * * 1-20,28-31 *   0     echo #test 
```

我不知道它是每天运行，还是只在周日（第 0 天）运行，但它不会在 21 日到 27 日（第三周）运行。如果是第三周（或者不是星期天），在脚本中进行检查可能很简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T00:05:21.773

如果您希望它在除第三个星期六之外的任何可能的星期六运行（尝试＃3）：

```
GREP=/usr/local/bin/grep
TODAY=/bin/date "+%d"
THIRD_SAT=/bin/date -v1d -v+1m -v-7d -v-sat "+%d"
#min hr day month weekday script
0    0  *   *     6       ($THIRD_SAT | $GREP $TODAY) || /bin/echo doit 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T00:07:47.633

1.  在需要时创建一个运行给定脚本的 cron 作业，忽略第三个周末部分
2.  制作一个在 21 上运行的 cron 作业，另一个在 28 上运行，以将脚本切换出和切换回另一个无操作脚本。

哈克但它会工作

# linq - 你将如何在 linq 中查询这个？

> ID：736275
> 
> 赞同：0
> 
> 时间：2009-04-09T23:51:27.110
> 
> 标签：linq

假设我有 2 个表：产品（只是产品 ID 和名称）和销售（销售 ID、产品 ID、金额、日期）

现在，给定开始日期和结束日期，我想在给定的时间范围内为每种产品求和其总销售额，请注意自然有些产品的销售额为零

我应该怎么写这个查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T00:04:17.937

```
var products = 
    from p in mycontext.Products
    select new
    {
       Product = p,
       Sales = p.Sales
          .Where(s=>s.StartDate > startDate && s.EndDate < endDate)
          .Sum(s=>s.amount)
    } 
```

# c# - C#：有没有办法正确转换 Keys.Oem？正确的字符串而不进行字符串操作？

> ID：736279
> 
> 赞同：0
> 
> 时间：2009-04-09T23:55:34.057
> 
> 标签：c#, .net

C#：有没有转换 Keys.Oem 的方法？正确的字符串而不进行字符串操作？

当我执行 e.ToString() 并且如果键是 / 或 < 等时，它将转换为 OemSlash、OemQuestion。有没有一种.net 方法可以正确地将 Keys.OemSpace 转换为“Space”而不包括“OemSpace”并且没有字符串操作？如果没有内置的方法来做这样的事情，那么最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T02:15:33.770

如果您想确定您将从给定键和给定修饰符中获得什么字符，您应该使用该[`user32 ToAscii`](http://msdn.microsoft.com/en-us/library/ms646316.aspx)函数。或者[`ToAsciiEx`](http://msdn.microsoft.com/en-us/library/ms646318.aspx)，如果您想使用当前键盘布局*以外*的键盘布局。

```
using System.Runtime.InteropServices;
public static class User32Interop
{
  public static char ToAscii(Keys key, Keys modifiers)
  {
    var outputBuilder = new StringBuilder(2);
    int result = ToAscii((uint)key, 0, GetKeyState(modifiers),
                         outputBuilder, 0);
    if (result == 1)
      return outputBuilder[0];
    else
      throw new Exception("Invalid key");
  }

  private const byte HighBit = 0x80;
  private static byte[] GetKeyState(Keys modifiers)
  {
    var keyState = new byte[256];
    foreach (Keys key in Enum.GetValues(typeof(Keys)))
    {
      if ((modifiers & key) == key)
      {
        keyState[(int)key] = HighBit;
      }
    }
    return keyState;
  }

  [DllImport("user32.dll")]
  private static extern int ToAscii(uint uVirtKey, uint uScanCode,
                                    byte[] lpKeyState,
                                    [Out] StringBuilder lpChar,
                                    uint uFlags);
} 
```

您现在可以像这样使用它：

```
char c = User32Interop.ToAscii(Keys.OemQuestion, Keys.ShiftKey); // = '?' 
```

如果您需要多个修饰符，只需`or`它们即可。`Keys.ShiftKey | Keys.AltKey`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T23:57:36.033

我能想到的唯一方法是使用正则表达式。我知道这可能不是您想要的答案。希望有人知道这样做的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T00:09:40.763

您可能希望为此使用[`ToAscii`](http://pinvoke.net/default.aspx/user32/ToAscii.html)or[`ToUnicode`](http://pinvoke.net/default.aspx/user32/ToUnicode.html)函数，它是 Win32 API 的一部分。（如果你想要的话，我怀疑你会得到一个简单的纯 BCL/跨平台解决方案。）它们是相对简单的函数，可以将虚拟键码转换为字符（ASCII 或 Unicode 编码，作为名称建议）。

**编辑：**我认为您实际上可能在[`KeysConverter`](http://msdn.microsoft.com/en-us/library/system.windows.forms.keysconverter.aspx)课堂上很幸运！

# javascript - 如何在 IE 中按下鼠标左键时检测鼠标右键单击？

> ID：736281
> 
> 赞同：2
> 
> 时间：2009-04-09T23:56:52.027
> 
> 标签：javascript, jquery, html, internet-explorer

我有以下内容：

```
<html>
<body oncontextmenu="return false;">
    <script src="jquery-1.3.2.min.js"></script>
    <script>
        $(document).ready(function () {
            $(document).mousedown(function (e) {
                if (e.button == 2) //right click
                {
                    document.body.style.backgroundColor = "green";
                }
                else //left click
                {
                    document.body.style.backgroundColor = "blue";
                }
            });
        });
    </script>
</body>
</html> 
```

如果在按住鼠标左键的同时单击鼠标右键，则预期的行为是背景颜色从蓝色变为绿色。

这适用于 Firefox，但我不确定如何在 IE (7) 中使用它。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-09T23:58:56.857

鼠标右键+左键设置`e.button==3`不是2。

# ios - 在 UIView 中将标签居中

> ID：736287
> 
> 赞同：8
> 
> 时间：2009-04-09T23:58:05.613
> 
> 标签：ios, objective-c, iphone, cocoa-touch, uilabel

将标签居中的最佳方法是`UIView`什么？如果你做一些事情，比如

```
UILabel *myLabel = [[UILabel alloc] initWithFrame:CGRectMake(view.frame.origin.x / 2, view.frame.origin.y / 2, 50.0, 50.0)]; 
```

然后将标签的原点设置为视图的中心。最好的办法是使用 center 属性将视图的中心设置为该点。所以我尝试使用以下代码：

```
UIView *aView = [[[UIView alloc] initWithFrame:[[UIScreen mainScreen] applicationFrame]] autorelease];
aView.backgroundColor = [UIColor darkGrayColor];
CGRect frame = aView.frame;

UILabel *aLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 125.0f, 30.0f)];
[aLabel setCenter:CGPointMake(frame.origin.x / 2, frame.origin.y / 2)]; 
```

这会产生一个标签，该标签几乎超出了左上角视图的范围。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-10T00:31:39.197

您做错的主要事情是取一半的*原始*值，而不是一半的*大小*

但是，在这种情况下，您甚至不需要计算 - 只需执行以下操作：

```
 UIView *aView = [[[UIView alloc] initWithFrame:[[UIScreen mainScreen] applicationFrame]] autorelease];
aView.backgroundColor = [UIColor darkGrayColor];

UILabel *aLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 125, 30)];
aLabel.center = aView.center; 
```

（请注意，您不需要将这些坐标强制为浮点数 - 在这种情况下，将它们写为整数似乎更具可读性）。

此外，这是风格问题 - 但由于您已经在使用属性语法 ( `aView.backgroundColor`)，您也可以将其用于 center 属性:-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-10T00:03:36.223

要在父母中水平居中放置任何孩子，您可以像这样计算它的位置；

```
childX = (parentWidth - childWidth) / 2 
```

（这也适用于身高）。

# wix - 带有类型库的 Wix 3.0 中带有 Heat 的“坏图像”

> ID：736288
> 
> 赞同：1
> 
> 时间：2009-04-09T23:58:12.070
> 
> 标签：wix, installation, wix3, typelib, heat

当使用`heat`（来自 Wix 3.0.4805.0）从 Visual Studio 生成的类型库中生成 Wix 文档时，我遇到了一个错误。弹出一个窗口，上面写着：

> 'heat.exe - 坏图像'
> 
> 应用程序或 DLL c:\path\to\file.tlb 不是有效的 Windows 映像。请对照您的安装软盘检查。

但是当我们按下'ok'后，它会继续并成功生成

看起来[wix bugboard 上的这个错误报告说它是在我之前的版本中修复的，但似乎不是](http://sourceforge.net/tracker/index.php?func=detail&aid=1583346&group_id=105970&atid=642714). 他们说发生错误是因为它首先尝试将其作为 DLL 加载（失败），然后继续做正确的事情。

这发生在 Windows XP SP3 上。

有人知道解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-12T06:05:39.517

尝试稍后构建。自 4805 构建以来，已对热量进行了重大错误修复。

# java - java.net.URL 和 java.net.URLConnection 的奇怪问题

> ID：736290
> 
> 赞同：0
> 
> 时间：2009-04-09T23:59:19.650
> 
> 标签：java, url

我正在尝试从 url 下载图像。除了我们正在处理的一个内容提供商之外，我编写的流程适用于所有人。

当我通过 Firefox 访问他们的 JPG 时，一切看起来都很干净（快乐的逾越节，顺便说一句）。但是，当我使用我的流程时，我要么：

A) 获得 404 或

B) 在调试器中，当我在 URL 行 (URL url = new URL(str);) 处设置断点时，连接后我确实得到了一个文件，但它不是 .jpg，而是它们的一些 HTML使用通用链接和东西制作。不过，我没有看到重定向代码！它以 200 的形式返回。

这是我的代码...

```
URL url = new URL(urlString);               
URLConnection uc = url.openConnection();        
String val = uc.getHeaderField(0);
System.out.println("FOUND OBJECT OF TYPE:" + contType);
if(!val.contains("200")){                         
  //problem
}
else{
    is = uc.getInputStream();
} 
```

有没有人见过这种性质的东西？我在想也许这是一些哑剧类型的问题，但这只是一个猜测......我完全被难住了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T00:49:47.923

也许该站点只是使用某种保护来防止他人盗链他们的图像或禁止大量下载。

他们通常检查 HTTP 引荐来源网址（它必须来自他们自己的域）或用户代理（必须是浏览器，而不是下载管理器）。设置两者并重试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T00:17:59.997

您是否尝试过使用[WireShark](http://www.wireshark.org/)来准确查看来回传输的数据包？这通常是查看不同之处的最快方法。那是：

1.  使用 FireFox 获取 GIF 时先运行 WireShark，然后
2.  运行 WireShark 以使用您的代码来获取它。

然后比较和对比两个方向的数据包，我几乎可以保证您会在 HTTP 标头或可以解释问题的流量的其他部分中看到不同的内容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T00:50:25.550

```
if(!val.contains("200")) // ... 
```

首先，我建议你使用这个名为 **HttpURLConnection**的有用类，它提供了**getResponseCode()方法**

在整个数据中搜索一些“200”意味着

1.  性能问题，以及
2.  不一致（二进制文件**可能**包含一些“200”）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T18:09:58.157

所有的猜测都很好，但我认为“正确”答案奖励必须去 ivan_pertrovich_ivanovich_harkovich_rostropovitch_o'neil 因为使用 HttpURLConnection 我能够看到，事实上，在获得 404 之前，我首先获得了 301。所以，现在，只需从这些人那里找出他们对标题的期望，这将使他们不太愿意重定向我。

谢谢你的建议。

# c# - 使用 Setter 更新样式触发器中的自定义附加属性

> ID：736293
> 
> 赞同：12
> 
> 时间：2009-04-10T00:02:13.107
> 
> 标签：c#, .net, wpf, xaml, attached-properties

我正在尝试附加属性和样式触发器，希望了解更多信息。我编写了一个非常简单的带有附加属性的 WPF Windows 应用程序：

```
 public static readonly DependencyProperty SomethingProperty = 
      DependencyProperty.RegisterAttached(
          "Something", 
          typeof(int), 
          typeof(Window1),
          new UIPropertyMetadata(0));

  public int GetSomethingProperty(DependencyObject d)
  {
      return (int)d.GetValue(SomethingProperty);
  }
  public void SetSomethingProperty(DependencyObject d, int value)
  {
      d.SetValue(SomethingProperty, value);
  } 
```

我正在尝试使用按钮样式部分中定义的属性触发器来更新“某物”附加属性：

```
 <Window x:Class="TestStyleTrigger.Window1"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="clr-namespace:TestStyleTrigger;assembly=TestStyleTrigger"
      Title="Window1" Height="210" Width="190">
      <Window.Resources>
          <Style x:Key="buttonStyle" TargetType="{x:Type Button}">
              <Style.Triggers>
                  <Trigger Property="IsPressed" Value="True">
                      <Setter Property="local:Window1.Something" Value="1" />
                  </Trigger>
              </Style.Triggers>
          </Style>
      </Window.Resources>

      <Button Style="{StaticResource buttonStyle}"></Button>
  </Window> 
```

但是，我不断收到以下编译错误：

错误 MC4003：无法解析样式属性“某事”。验证所属类型是否为 Style 的 TargetType，或使用 Class.Property 语法来指定 Property。第 10 行位置 29。

我不明白为什么它会给我这个错误，因为我确实在该部分的标签中使用了“Class.Property”语法。谁能告诉我如何解决这个编译错误？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-04-10T09:18:41.083

您的依赖属性的支持方法命名不正确，并且必须是静态的：

```
public static int GetSomething(DependencyObject d)
{
    return (int)d.GetValue(SomethingProperty);
}

public static void SetSomething(DependencyObject d, int value)
{
    d.SetValue(SomethingProperty, value);
} 
```

此外，您不应在 XAML 中的本地 XML NS 映射中指定程序集，因为命名空间位于当前程序集中。改为这样做：

```
xmlns:local="clr-namespace:TestStyleTrigger" 
```

# c# - ASP.NET 如何将文件流式传输给用户

> ID：736301
> 
> 赞同：6
> 
> 时间：2009-04-10T00:06:25.263
> 
> 标签：c#, asp.net, download, httpresponse

最初我试图弄清楚 Response.Close 和 Response.End 之间的区别是什么，但是在进行了更多的谷歌搜索和研究之后，很明显我还没有看到一个 Byte[] 被发送回客户端的常见方式。我将在下面留下代码示例，但我想知道这样做的行业标准是什么。

```
Byte[] myBytes = GetReportBytes();
HttpContext.Current.Response.ClearContent();
HttpContext.Current.Response.AppendHeader("content-length", myBytes.Length.ToString());
HttpContext.Current.Response.AppendHeader("content-Disposition", "attachment;filename=" + this.ReportFileName + GetReportExtension());
HttpContext.Current.Response.ContentType = GetApplicationContentType();
HttpContext.Current.Response.BinaryWrite(myBytes);
HttpContext.Current.Response.Flush();
HttpContext.Current.Response.Close();
//CERT FIX
//HttpContext.Current.Response.End(); 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-10T01:26:42.390

我不会打电话`Response.Close()`或`Response.End()`。

`Response.End()`将在该点停止页面执行/渲染。不会运行以下代码`Response.End()`。响应在该点终止，没有进一步的输出添加到流中。

`Response.Close()`类似于`Response.End()`，但允许在调用后执行代码（但不能在页面响应中发送进一步的输出）。

`Response.Flush()`会将任何剩余的响应项发送到页面。

来自[IIS 核心团队成员](http://forums.iis.net/p/1152058/1898362.aspx)：

> Response.Close 向客户端发送一个重置数据包，并且在除错误条件之外的任何情况下使用它都会导致各种问题 - 例如，如果您正在与具有足够延迟的客户端交谈，则重置数据包可能会导致任何其他响应数据缓冲在服务器、客户端或两者之间的某个地方被删除。
> 
> 在这种特殊情况下，压缩涉及在响应中查找常见模式，并且必须通过压缩代码缓冲一定数量的响应以增加找到更长重复模式的机会 - 一旦你缓冲了这部分就不能发送给客户端做响应。关闭（）。
> 
> 简而言之，不要使用 Response.Close()。

# c# - 将域指向 IIS 站点的子文件夹

> ID：736303
> 
> 赞同：5
> 
> 时间：2009-04-10T00:07:38.070
> 
> 标签：c#, .net, iis

很抱歉这篇文章的标题可能具有误导性。目前真的想不出更好的办法。

无论如何，我建立了一个网站，允许用户搜索我们的客户数据库。我在“报告”目录下列出了该站点的一个单独部分，用于生成计费报告、订阅者计数等。显然我们的用户对必须在 url 上输入报告文件夹感到困惑：[http://主域/报告/](http://maindomain/reports/)。

我想知道是否有办法创建一个指向该特定文件夹的新域。换句话说，用户访问[http://reportsdomain/](http://reportsdomain/)，这将是[http://maindomain/reports/](http://maindomain/reports/)的别名。我考虑过的解决方案如下：

1.  在 IIS 中创建一个指向报告文件夹的新站点（这是另一个站点中的子文件夹......似乎是一种不好的做法，因为那时两个单独的 IIS 站点将为该站点进行缓存，维护会话/应用程序状态， ETC）。
2.  构建一个 IIS 模块来进行 URL 重写

在这两个选项中，我可能会在 1 之前选择 2。还有其他我没有想到的方法吗？

在此先感谢您的帮助。

尊敬，

克里斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T00:25:25.703

*   **选项 2**比拥有两个站点的额外开销更理想。

[使用 IIS 7.0 的 Microsoft URL 重写模块](http://www.15seconds.com/issue/081205.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T19:16:19.147

如果您对用户输入主 URL 然后被转发到新 URL 没问题，您只需在 IIS 中设置[http://maindomain](http://maindomain)站点，然后在“主目录”页面上，将其设置为转发到[http://maindomain/reports/](http://maindomain/reports/)。

虽然这不像 URL 重写选项那样干净，但启用它很容易，而且看起来这可能是您正在寻找的选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T00:27:41.673

也可以在 DNS 级别处理此问题。

# c - 纯 C 中的“多用途”链表实现

> ID：736307
> 
> 赞同：28
> 
> 时间：2009-04-10T00:08:23.123
> 
> 标签：c, linked-list, containers, generic-programming

这不完全是一个技术问题，因为我知道 C 足以做我需要做的事情（我的意思是，就不要'让语言妨碍你'而言），所以这个问题基本上是一个'什么方向采取'的问题。

情况是：我目前正在学习高级算法课程，为了“成长为程序员”，我被要求使用纯 C 来实现实际作业（效果很好：几乎你犯的任何小错误实际上都会强制你要完全理解你在做什么来修复它）。在实现过程中，我显然遇到了必须从头开始实现“基本”数据结构的问题：实际上不仅是链表，还有堆栈、树等。

我专注于本主题中的列表，因为它通常是我最终在程序中使用很多的结构，作为“主”结构或作为其他更大结构的“辅助”结构（例如，解析的哈希树使用链表产生冲突）。

**这要求列表存储许多不同类型的元素。**我在这里假设我不想为每种类型重新编码列表。所以，我可以想出这些替代方案：

*   制作一个 void 指针列表（有点不优雅；更难调试）
*   只制作一个列表，但有一个**联合**作为“元素类型”，包含我将在程序中使用的所有元素类型（更易于调试；如果元素大小不同，则会浪费空间）
*   [使用预处理器宏以SGLIB](http://sglib.sourceforge.net)的样式为每种类型重新生成代码，“模仿”C++ 的 STL（创造性的解决方案；不浪费空间；元素在返回时具有它们实际的显式类型；*列表中的任何更改代码真的很戏剧化*）
*   你的想法/解决方案

**把问题说清楚：以上哪一个是最好的？**

PS：由于我基本上是在学术环境中，我也对业内使用纯 C 的人的观点非常感兴趣。我知道大多数纯C程序员都在嵌入式设备领域，我认为我面临的这种问题并不常见。但是，如果有人知道它是如何“在现实世界中”完成的，我会对您的意见非常感兴趣。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-04-10T00:49:31.667

A`void *`在链表中有点麻烦，因为您必须单独管理它对链表本身的分配。我过去使用的一种方法是具有“可变大小”结构，例如：

```
typedef struct _tNode {
    struct _tNode *prev;
    struct _tNode *next;
    int payloadType;
    char payload[1];  // or use different type for alignment.
} tNode; 
```

现在我意识到这*看起来*不是可变大小，但让我们分配一个结构：

```
typedef struct {
    char Name[30];
    char Addr[50];
} tPerson;
tNode *node = malloc (sizeof (tNode) - 1 + sizeof (tPerson)); 
```

现在，您有一个节点，从所有意图和目的来看，它看起来像这样：

```
typedef struct _tNode {
    struct _tNode *prev;
    struct _tNode *next;
    int payloadType;
    char Name[30];
    char Addr[50];
} tNode; 
```

或者，以图形形式（其中`[n]`表示`n`字节）：

```
+----------------+
|    prev[4]     |
+----------------+
|    next[4]     |
+----------------+
| payloadType[4] |                
+----------------+                +----------+
|   payload[1]   | <- overlap ->  | Name[30] |
+----------------+                +----------+
                                  | Addr[50] |
                                  +----------+ 
```

也就是说，假设您知道如何正确处理有效负载。这可以按如下方式完成：

```
node->prev = NULL;
node->next = NULL;
node->payloadType = PLTYP_PERSON;
tPerson *person = &(node->payload); // cast for easy changes to payload.
strcpy (person->Name, "Bob Smith");
strcpy (person->Addr, "7 Station St"); 
```

该转换行只是将`payload`字符的地址（在`tNode`类型中）转换为实际`tPerson`有效负载类型的地址。

使用这种方法，您可以在节点中携带任何您想要的*有效负载类型，甚至每个节点中都可以携带不同的有效负载类型*，而不会浪费联合的空间。这种浪费可以通过以下方式看到：

```
union {
    int x;
    char y[100];
} u; 
```

每次在列表中存储整数类型时都会浪费 96 个字节（对于 4 字节整数）。

中的有效负载类型`tNode`允许您轻松检测此节点承载的有效负载类型，因此您的代码可以决定如何处理它。您可以使用以下内容：

```
#define PAYLOAD_UNKNOWN     0
#define PAYLOAD_MANAGER     1
#define PAYLOAD_EMPLOYEE    2
#define PAYLOAD_CONTRACTOR  3 
```

或（可能更好）：

```
typedef enum {
    PAYLOAD_UNKNOWN,
    PAYLOAD_MANAGER,
    PAYLOAD_EMPLOYEE,
    PAYLOAD_CONTRACTOR
} tPayLoad; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-10T00:22:02.857

我的 .002 美元：

*   制作一个 void 指针列表（有点不雅；更难调试）

这不是一个糟糕的选择，恕我直言，如果您必须用 C 语言编写。您可以添加 API 方法以允许应用程序提供 print() 方法以便于调试。当（例如）项目被添加到列表中或从列表中删除时，可以调用类似的方法。（对于链表，这通常不是必需的，但对于更复杂的数据结构——例如哈希表）——它有时可以成为救命稻草。）

*   只制作一个列表，但有一个联合作为“元素类型”，包含我将在程序中使用的所有元素类型（更易于调试；如果元素大小不同，则会浪费空间）

我会像避免瘟疫一样避免这种情况。（好吧，您确实问过。）从数据结构到其包含的类型的手动配置的编译时依赖性是最糟糕的。再次，恕我直言。

*   使用预处理器宏为每种类型重新生成代码，采用 SGLIB (sglib.sourceforge.net) 的样式，“模仿”C++ 的 STL（创造性的解决方案；不浪费空间；元素具有它们实际的显式类型被返回；列表代码中的任何更改都可能非常显着）

有趣的想法，但由于我不了解 SGLIB，所以我不能说更多。

*   你的想法/解决方案

我会选择第一选择。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-07T07:53:38.877

使用预处理器宏是最好的选择。[Linux 内核链表](http://isis.poly.edu/kulesh/stuff/src/klist/)是 C 中循环链表的一种出色的高效实现。非常便携且易于使用。[这里](http://www.ldc.usb.ve/~gpalma/pub/dllist.h)是 linux 内核 2.6.29 list.h 标头的独立版本。

FreeBSD/OpenBSD [sys/queue](http://fxr.watson.org/fxr/source/sys/queue.h)是基于通用宏的链表的另一个不错的选择

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-10T00:24:04.957

我过去曾在我们的代码中（后来已转换为 C++）中这样做过，当时我决定采用 void* 方法。我这样做只是为了灵活性——无论如何，我们几乎总是在列表中存储一个指针，解决方案的简单性和可用性超过了（对我而言）其他方法的缺点。

话虽如此，曾经有一次它导致了一些难以调试的讨厌的错误，所以它绝对不是一个完美的解决方案。不过，如果我现在再次这样做，我认为它仍然是我会采取的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-10T01:05:37.867

我已经很多年没有编写过 C 代码了，但[GLib](http://library.gnome.org/devel/glib/)声称提供“大量用于字符串和通用数据结构的实用函数”，其中包括链表。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-10T01:22:41.167

这是一个很好的问题。我喜欢两种解决方案：

*   Dave Hanson 的[C Interfaces and Implementations](http://www.cs.princeton.edu/software/cii/)使用了一个`void *`指针列表，这对我来说已经足够好了。

*   对于我的*学生*，我编写了一个**awk 脚本来生成特定类型的列表函数**。与预处理器宏相比，它需要额外的构建步骤，但系统的操作对于没有大量经验的程序员来说更加透明。这确实有助于为参数多态性提供理由，他们稍后会在课程中看到这一点。

    下面是一组函数的样子：

    ```
    int      lengthEL (Explist *l);
    Exp*     nthEL    (Explist *l, unsigned n);
    Explist *mkEL     (Exp *hd, Explist *tl); 
    ```

    awk 脚本是 150 行的恐怖；它在 C 代码中搜索`typedef`s 并为每个函数生成一组列表函数。它很旧；我现在可能会做得更好:-)

我不会在一天中的时间（或我的硬盘驱动器上的空间）给出工会列表。它不安全，而且不可扩展，所以你最好只使用`void *`它并完成它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-10T01:23:23.223

尽管考虑使用另一种语言的技术（例如泛型）解决此类问题很诱人，但实际上它很少能成功。可能有一些罐头解决方案在大多数情况下都能做到正确（并在他们出错时在他们的文档中告诉你），使用它可能会错过任务的重点，所以我会三思而后行。在极少数情况下，自己动手可能是可行的，但对于任何合理规模的项目，它可能不值得进行调试工作。

相反，在使用 x 语言编程时，您应该使用 x 语言的习语。使用 python 时不要编写 java。使用方案时不要写 C。使用 C99 时不要编写 C++。

我自己，我可能最终会使用类似 Pax 的建议，但实际上使用 char[1] 和 void* 和 int 的联合，以方便常见情况（以及枚举类型标志）

（我也可能最终实现一个斐波那契树，只是因为这听起来很整洁，而且你只能在它失去它的味道之前多次实现 RB 树，即使这对于它用于的常见情况来说更好.)

**编辑：** 根据您的评论，您似乎有一个很好的案例来使用罐装解决方案。如果你的教练允许，并且它提供的语法感觉很舒服，那就试一试。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-10T02:19:55.350

将其设为 void* 列表的一项改进是将其设为包含 void* 和一些有关 void* 指向的元数据的结构列表，包括其类型、大小等。

其他想法：嵌入 Perl 或 Lisp 解释器。

或者半途而废：与 Perl 库链接并使其成为 Perl SV 列表或其他东西。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-10T02:22:43.410

我自己可能会采用 void* 方法，但我想到您可以将数据存储为 XML。然后列表可以只有一个 char* 用于数据（您可以根据需要解析任何您需要的子元素）....

# c# - 为什么第二个线程在第一个线程之前被释放，当它们都调用 WaitOne() 并被 AutoResetEvent 释放时？

> ID：736310
> 
> 赞同：0
> 
> 时间：2009-04-10T00:09:45.227
> 
> 标签：c#, .net, multithreading, resetevent

假设 ThreadA 和 ThreadB 都`WaitOne()`在同一个 AutoResetEvent 上按此顺序调用。设置事件后，为什么释放 ThreadB 而不是 ThreadA？

我进行了一项测试，以了解当您设置多个线程正在等待的 AutoResetEvent 时会发生什么：

```
 private static void Test()
    {
        // two threads - waiting for the same autoreset event
        // start it unset i.e. closed i.e. anything calling WaitOne() will block
        AutoResetEvent autoEvent = new AutoResetEvent(false);

        Thread thread1 = new Thread(new ThreadStart(WriteSomeMessageToTheConsole));
        thread1.Start();  // this will now block until we set the event

        Thread thread2 = new Thread(new ThreadStart(WriteSomeOtherMessageToTheConsole));
        thread2.Start();  // this will now also block until we set the event

        // simulate some other stuff
        Console.WriteLine("Doing stuff...");
        Thread.Sleep(5000);
        Console.WriteLine("Stuff done.");

        // set the event - I thought this would mean both waiting threads are allowed to continue
        // BUT thread2 runs and thread1 stays blocked indefinitely
        // So I guess I was wrong and that Set only releases one thread in WaitOne()?
        // And why thread2 first?
        autoEvent1.Set();
    } 
```

代码当然没用；这只是一个米老鼠的例子。这并不重要/紧急。但无论如何我有兴趣了解更多...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T00:44:21.930

IIRC，未指定自动重置事件释放哪个线程。正如其他人所提到的，如果要广播条件，则需要手动重置事件。如果你想释放一个确切的数字（比如 n 中的 3 个），那么你可能想要使用信号量。

如果您真的想深入了解为什么该顺序可能与您预期的不同，请查看“Windows Internals”或 Mark Russinovich 所写的任何内容。他很有可能在某处解释了执行资源的等待命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T00:36:53.663

来自 MSDN

> MSDN on ManualResetEvent：“在 ManualResetEvent 上调用 WaitOne 的线程将阻塞，等待信号。当控制线程完成活动时，它调用 Set 以发出等待线程可以继续的信号。 **所有等待线程都被释放。**
> 
> 但是对于 AutoResetEvent，MSDN 说：“调用 Set 向 AutoResetEvent 发出信号以释放等待线程。AutoResetEvent 保持信号状态，直到 **释放单个等待线程**，然后自动返回到非信号状态。如果没有线程在等待，则状态无限期地保持信号状态。

"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T00:17:35.767

在[AutoResetEvent](http://msdn.microsoft.com/en-us/library/system.threading.eventwaithandle.set.aspx)上，Set 只释放一个线程。您应该使用[ManualResetEvent](http://msdn.microsoft.com/en-us/library/system.threading.manualresetevent.aspx)来释放多个等待线程。

# sql - SQL 将行对转换为 MS ACCESS 数据库中的列

> ID：736317
> 
> 赞同：6
> 
> 时间：2009-04-10T00:13:11.160
> 
> 标签：sql, ms-access, rows, transpose

我有一个 MS Access 数据库，其中包含源-目标对中的翻译句子（CAT 工具的其他用户的翻译记忆库）。有点烦人的是，源和目标不是存储在单独的列中，而是存储在由 ID 链接的行中，如下所示：

```
+---+----+--------------+
|id |lang|    text      |
+---+----+--------------+
  1   a     lang a text
  1   b     lang b text 
  2   a     more a text...
  2   b     more b text...
+---+----+--------------+ 
```

我可以使用什么 SQL 将其转换为表，例如：

```
+---+--------------+--------------+
|id | lang A       | lang B       |
+---+--------------+--------------+
 1   lang a text    lang b text
 2   more a text... more b text... 
```

性能在这里并不重要，因为我只需要偶尔执行一次，而且数据库并不大（只有几千行）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-10T00:26:09.007

交叉表查询应该适合。

```
TRANSFORM First([Text]) AS LangText
SELECT ID, First([Text])
FROM Table 
GROUP BY ID
PIVOT lang 
```

更多信息：[http ://allenbrowne.com/ser-67.html](http://allenbrowne.com/ser-67.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T00:25:52.877

你需要一个自加入：

```
SELECT
    t1.id, t1.text AS lang_a, t2.text AS lang_b
FROM
    lang_table AS t1
INNER JOIN
    lang_table AS t2
ON
    (t1.id = t2.id)
WHERE
    t1.lang = 'a'
AND
    t2.lang = 'b' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-09T21:08:59.037

```
SELECT a.id,
MAX(CASE WHEN a.lang LIKE 'a' THEN a.text) AS Lang A,
MAX(CASE WHEN a.lang LIKE 'a' THEN a.text) AS Lang A
FROM table a
GROUP BY a.id 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T00:26:23.500

```
select a.id, a.text as 'lang A', b.text as 'lang B'
from table a join table b on (a.id = b.id)
where a.lang = 'a' and b.lang = 'b'; 
```

其中“table”是它们所在的任何表格。

# iphone - Quartz2D and Clipping - 优化这个绘图程序？

> ID：736327
> 
> 赞同：2
> 
> 时间：2009-04-10T00:18:46.857
> 
> 标签：iphone

我是 Quartz2d 的新手，所以我希望这是一个容易回答的问题。

我有一个内容框架为 1024x768 的滚动视图。在此我推送了一个自定义视图（帧 1024x768），它使用 Quartz2d 进行一些绘图。这个想法是，我有一个很大的区域，用户可以滚动查看不同的部分。

我遇到的问题是，当我在设备上滚动时，我会收到内存警告错误或糟糕的滚动性能。毫无疑问，因为我正在重新绘制整个 1024x768 字段。我认为将剪辑路径设置为 UIScrollView 偏移量会有所帮助.. 它确实.. 直到我滚动.. 在这种情况下，视图不会重绘，直到滚动停止。在 scrollViewDidScroll 期间告诉视图绘制也会导致性能不佳

谁能告诉我如何优化我的绘图程序？

我有两个图像..其中一个被蒙版，并且都被绘制到屏幕上（一个在另一个之上）

`- (void)drawRect:(CGRect)dirtyRect {`

 ````
CGContextRef myContext = UIGraphicsGetCurrentContext();

// get our offset (where we've scrolled to)
CGPoint offset = scrollView.contentOffset;

    // clip to our offset.. uncomment for good performance but terrible scrolling
//CGContextClipToRect(myContext, CGRectMake(offset.x, offset.y, 480, 320));

// make an image from the mask context
CGImageRef aMaskImage = CGBitmapContextCreateImage (myMaskContext);

// mask the first image
CGImageRef aImage = CGImageCreateWithMask(myImageRef1, aMaskImage);

CGContextDrawImage(myContext, CGRectMake(0, 0, self.frame.size.width, self.frame.size.height), myImageRef1);
CGContextDrawImage(myContext, CGRectMake(0, 0, self.frame.size.width, self.frame.size.height), aImage);

CGImageRelease(aImage);
CGImageRelease(aMaskImage); 
```

}`  `提前感谢您提供的任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-06-22T19:58:46.400

一般来说，为了优化滚动大的东西，你会研究 CATiledLayer。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-16T17:52:55.260

我假设你打电话的地方`setNeedsDisplay`。你需要打电话`setNeedsDisplayInRect`。确保只通过改变的矩形。

# php - Validate PEAR 包准备好投入生产了吗？

> ID：736329
> 
> 赞同：1
> 
> 时间：2009-04-10T00:20:04.903
> 
> 标签：php, validation, pear

Pear 中似乎有一个 Validate 包，我有兴趣在生产中使用它。我们的网站在 10 种语言中拥有大约 2000 万个唯一身份，因此作为尽职调查的一部分，我想我在这里问过。

有人对这个 PEAR 包有任何经验吗？

准备好生产了吗？

这是有问题的验证包：http: [//pear.php.net/package/Validate](http://pear.php.net/package/Validate)

简介： http: [//pear.php.net/manual/en/package.validate.validate.php](http://pear.php.net/manual/en/package.validate.validate.php)

错误（仅提交了 78 个...） [http://pear.php.net/bugs/search.php?cmd=display&package_name[]=Validate&status=All](http://pear.php.net/bugs/search.php?cmd=display&package_name[]=Validate&status=All)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-10-13T12:44:51.670

我强烈建议不要将您使用的 PEAR 代码集成到您自己的代码库中。如果您使用的其中一个 PEAR 软件包的新版本发布以修复安全问题，并且该软件包对其他软件包存在多个依赖关系，那么会发生什么情况？您是否下载了新版本并检查一切正常，并且您自己没有因遗漏某些内容而添加错误？

如果您对系统范围的 PEAR 安装受到损害感到偏执，那么最好的办法是进行自己的 PEAR 安装。[http://pear.php.net/manual/en/installation.shared.php](http://pear.php.net/manual/en/installation.shared.php)将是执行此操作的起点。

那么这只是做 $pear upgrade [Package] 而不是复制大量文件的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T00:32:55.293

验证功能已经存在了很长时间——有些是从 2003 年开始的。我不会太担心 beta 标签，但我仍然对代码偏执——所以自己编写测试，不要升级你的 PEAR 库未经测试的系统。

更好 - 考虑将您使用的 PEAR 代码集成到您自己的代码库中，而不是依赖于可以单独升级的系统 PEAR 库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-16T21:49:19.173

您可以进行自己的 pear 安装（即不是系统范围的安装） - 因此在升级时您不必担心任何相互依赖关系 - 让 pear 安装程序为您解决这个问题。

这比简单地将 pear 包的代码复制到您自己的 repo 中要好 - 如果您错过了在将您正在使用的那些 pear 包插入到您的修订控制系统后发布的关键错误修复，您会怎么做？

老实说，验证包应该从测试版中取出——它已经稳定了很长时间，而不是名义上的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T00:25:30.413

从修订号和修订标题判断。（0.8.2（Beta））我会说不。就我个人而言，我建议不要在生产中使用任何 Beta 产品，尽管在很多情况下效果很好（例如 stackoverflow）。尽管您总是冒着发生某些事情的风险。

# asp.net-mvc - 控制器和视图中的子文件夹

> ID：736332
> 
> 赞同：2
> 
> 时间：2009-04-10T00:22:00.983
> 
> 标签：asp.net-mvc, model-view-controller

我想在 asp.net mvc 中为相同的对象/模型拥有多个控制器和视图，但结果比我预期的要复杂一些。

基本上我想做的是这样的：

```
site.com/product
    -> 将向访问者显示产品详细信息。

site.com/admin/product
    -> 将显示一些额外的信息以及产品详细信息。
        以及一些命令，如删除、编辑等。

```

目标是将访问者和管理员的网址分开。

我的第一种方法是在控制器和视图文件夹中创建一个子文件夹，所以事情看起来是这样的：

```
> 控制器
    > 管理员
        产品控制器.cs
    产品控制器.cs
> 意见
    > 管理员
        > 产品
            索引.aspx
    > 产品
        索引.aspx

```

我可以毫无问题地将 url 映射到正确的控制器（前提是我指定了它们的命名空间，因为类名相同）。但是，当我从 admin 文件夹下的 Controller 返回视图时，它不会显示 Views/Admin/Product 文件夹下的 Index 视图，而是 Views/Product 下的一个。

我知道我可以说`return View("Full path here")`返回我想要的视图。但这显然不是一个好的解决方案，我不想这样做。

我的问题是，处理这种情况的最佳方法是什么，而 url 的条件必须是这样的？

*   创建一个自定义控制器类来覆盖视图方法（或为此目的需要覆盖的任何其他方法）并确保返回正确的视图？

    *   这是一个丑陋的黑客，但会工作。
*   Create a custom view engine that also takes folders into consideration?

    *   I don't exactly know how I can do this, but as far as I understand, this should also solve the problem
*   Use [Areas Prototype](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx) of [Phil Haack](http://haacked.com)?

    *   This one actually uses a different layout for folders, but in theory this should also work. But I am still not sure if this is the best way to do this, because having different Controller & View folders under the different parts of the site is not exactly what I want.

I'm leaning towards the custom view engine idea, that takes the folders into consideration when returns the views, but like I said, I don't know how to do that.

Any suggestions?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T02:35:30.727

Try out Phil Haack's /Areas/ for your MVC project: [http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx](http://haacked.com/archive/2008/11/04/areas-in-aspnetmvc.aspx)

You'd have your normal Root for normal content, and a special /Areas/Admin/ section for all of your admin stuff (and the url will be /admin/).

[![alt text](https://i.stack.imgur.com/hlN3b.png)](https://i.stack.imgur.com/hlN3b.png)
[(source: [haacked.com](http://haacked.com/images/haacked_com/WindowsLiveWriter/36ef165d4ea4_ED92/areas-folder-structure_6.png))]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-21T20:27:59.013

ASP.Net MVC uses a flat Views folder structure by default. Areas can help to a certain extent, although they only give your one more level!

This can make the views for a deeply nested hierarchy of controllers difficult to manage. What you really want here is for your Views folder hierarchy to match the namespace hierarchy of your controllers.

The good news is that you can write a custom ViewEngine to do this with surprisingly little effort - see my [ControllerPathViewEngine project on GitHub](https://github.com/danmalcolm/ControllerPathViewEngine) for details.

I've included a snippet of the ControllerPathRazorViewEngine class to outline how it works. By intercepting the FindView / FindPartialView methods and replacing the controller name with a folder path (based on controller namespace and name), we can get it to load views from nested folders within the main Views folder.

```
 public class ControllerPathRazorViewEngine : RazorViewEngine
    {
        //... constructors etc.

        public override ViewEngineResult FindView(ControllerContext controllerContext, string viewName, string masterName, bool useCache)
        {
            return FindUsingControllerPath(controllerContext, () => base.FindView(controllerContext, viewName, masterName, useCache));
        }

        public override ViewEngineResult FindPartialView(ControllerContext controllerContext, string partialViewName, bool useCache)
        {
            return FindUsingControllerPath(controllerContext, () => base.FindPartialView(controllerContext, partialViewName, useCache));
        }

        private ViewEngineResult FindUsingControllerPath(ControllerContext controllerContext, Func<ViewEngineResult> func)
        {
            string controllerName = controllerContext.RouteData.GetRequiredString("controller");
            string controllerPath = controllerPathResolver.GetPath(controllerContext.Controller.GetType());
            controllerContext.RouteData.Values["controller"] = controllerPath;
            var result = func();
            controllerContext.RouteData.Values["controller"] = controllerName;
            return result;
        }
    } 
```

# python - Python 超全球？

> ID：736335
> 
> 赞同：4
> 
> 时间：2009-04-10T00:22:48.877
> 
> 标签：python, python-3.x

Python中是否有超级全局（如PHP）？我有一些变量我想在我的整个项目中在单独的文件、类和函数中使用，我不想在每个文件中一直声明它。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-10T00:35:38.160

理论上是的，你可以开始向 __builtin__ 注入杂乱无章的东西：

```
>>> import __builtin__
>>> __builtin__.rubbish= 3
>>> rubbish
3 
```

但是，不要这样做；这是可怕的邪恶，会给你的应用程序编程癌症。

> 类和函数，我不想一直声明

将它们放入模块中，并在需要使用它们时“导入”它们。

> 我想在整个项目中使用某些变量

如果您必须有不合格的值，只需将它们放在一个名为“mypackage/constants.py”之类的文件中，然后：

```
from mypackage.constants import * 
```

如果它们真的是“变量”，因为您在应用程序执行期间更改了它们，那么您需要开始将它们封装在对象中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T00:41:45.413

即使有，你也不应该使用这样的构造。考虑使用博格模式来保存这种东西。

```
class Config:
    """
    Borg singlton config object
    """
    __we_are_one = {}
    __myvalue = ""

    def __init__(self):
        #implement the borg patter (we are one)
        self.__dict__ = self.__we_are_one

    def myvalue(self, value=None):
        if value:
           self.__myvalue = value
        return self.__myvalue

conf = Config()
conf.myvalue("Hello")
conf2 = Config()
print conf2.myvalue() 
```

这里我们使用 borg 模式来创建一个单例对象。无论您在代码中的什么位置使用它，“myvalue”都将是相同的，无论您在哪个模块或类中实例化 Config。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-10T11:40:21.773

创建空的 superglobal.py 模块。
在您的文件中执行以下操作：

```
import superglobal
superglobal.whatever = loacalWhatever
other = superglobal.other 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-02-04T16:14:51.440

在多年的实践中，我对 python 的导入系统感到非常失望：它复杂且难以正确处理。此外，我必须在我编写的每个模块中维护大量导入，这是一个皮塔饼。

命名空间是一个非常好的主意，它们是必不可少的——php没有适当的命名空间，而且一团糟。

从概念上讲，编写应用程序的一部分在于定义合适的词汇表，即您将用来做您想做的事情的词。然而在经典的方式中，正是这些词并不容易，因为你必须先导入这个，导入那个才能获得访问权限。

当命名空间成为 javascript 社区的焦点时，jquery 成名的 john resig 决定在全局命名空间中提供单个`$`变量是可行的方法：它只会最小地影响全局命名空间，并提供对 jquery 一切的轻松访问。

同样，我尝试了一个全局变量`g`，它在一定程度上起作用。基本上，你有两个选择：要么有一个启动模块，它必须在你的应用程序中的任何其他模块之前运行，它定义了应该在 中可用的东西`g`，所以它可以在需要时准备好。我尝试的另一种方法是变得`g`懒惰并在需要新名称时对自定义导入做出反应；因此，每当您第一次需要`g.foo.frob(42)`时，该机制都会尝试`import foo; g.foo = foo`在幕后进行。要正确地做到这一点要困难得多。

这些天来，除了标准库和站点包之外，我几乎完全放弃了导入系统。大多数时候我为软管库编写包装器，因为无论如何，其中 90% 的接口都非常复杂。然后我在全局命名空间中发布这些包装器，使用拼写约定将冲突风险降至最低。

我这样说只是为了减轻这样一种印象，即修改全局命名空间本质上是邪恶的，其他答案似乎也说明了这一点。不是这样。邪恶的是轻率地做它，或者被语言或包装设计强迫这样做。

让我补充一句，因为我几乎肯定会在这里受到一些抨击：99% 由虔诚地捍卫命名空间纯度的人所做的所有导入都是*错误*的。证明？`foo.py`你会在任何需要做三角函数的模块的开头读到`from math import sin`. 现在，当您正确`import foo`查看该名称空间时，您会找到什么？东西叫`foo.sin`. 但这`sin`不是接口的一部分`foo`，它只是一个助手，它不应该使命名空间混乱——因此，`from math import sin as _sin`或者某些这样的东西是正确的。然而，几乎没有人这样做。

我肯定会用这些观点引起一些激烈的评论，所以继续吧。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-04T13:43:41.853

它对您来说并不明显的原因是 Python 故意不尝试支持这样的事情。命名空间是一项*功能*，使用它们对您有利。如果您想要在另一个文件中定义的内容，请导入它。这意味着通过阅读您的源代码，您可以找出所有内容的来源，并且还可以使您的代码更容易测试和修改。

# css - 使用 CSS 的 HTML 表单布局

> ID：736336
> 
> 赞同：15
> 
> 时间：2009-04-10T00:23:24.367
> 
> 标签：css, forms, xhtml

我需要为数据输入构建一个表单，比如说名字和姓氏。我知道如何用桌子做到这一点。在第一个中`<td>`我会放置一个标签标签，在第二个中我会使用一个带有`type="text"`属性的输入标签。这样标签和文本框将排成两列。

有没有办法用 CSS 做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-10T00:27:08.740

[这是一个教程。](http://www.cssdrive.com/index.php/examples/exampleitem/tableless_forms/)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-11T00:53:18.140

您不需要表格来制作出色的 HTML 表单。事实上，你不想要它们！在家里试试这个代码，看看你的想法..

```
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Contact info</title>

<LINK href="main2.css" type="text/css" rel="stylesheet">

<!--[if IE]>
<style>
    fieldset.nested 
    {
        position: relative;
        margin-top: 15px;        
    }

    fieldset.nested legend 
    {
        position: absolute; top: -8px; left: 1em;
    }
</style>
<![endif]-->

</head>

<body>

<div>    
    <form>

    <fieldset class="main">
        <legend>Contact info</legend>

        <fieldset class="nested">
            <legend>Name</legend>    
            <ol>
                <li>
                    <label for="textboxName">Name</label>
                    <input id="textboxName" name="textboxName" type="text" style="width: 15em;"/>
                </li>
                <li>
                    <label for="textboxName" >Title</label>
                    <input id="textboxName" name="textboxTitle" type="text" style="width: 15em;"/>
                </li>
                <li>
                    <label for="textboxCompany">Company</label>
                    <input id="textboxCompany" name="textboxCompany" type="text" style="width: 15em;"/>
                </li>
            </ol>
        </fieldset>        

        <fieldset class="nested">
            <legend>Address</legend>    
            <ol>
                <li>
                    <label for="textboxAddress1" >Street address</label>
                    <input id="textboxAddress1" name="textboxAddress1" type="text" style="width: 15em;"/>
                </li>
                <li>
                    <label for="textboxAddress2" >Street address</label> 
                    <input id="textboxAddress2" name="textboxAddress2" type="text" style="width: 15em;"/>
                </li>
                <li>
                    <label for="textboxCity" >City</label>
                    <input id="textboxCity" name="textboxCity" type="text" style="width: 15em;"/>
                </li>
                <li>
                    <label for="textboxRegion" >City/Region</label>
                    <input id="textboxRegion" name="textboxRegion" type="text" style="width: 15em;"/>
                </li>
                <li>
                    <label for="textboxPostalCode" >Postal code</label>
                    <input id="textboxPostalCode" name="textboxPostalCode" type="text" style="width: 15em;"/>
                </li>
                <li>
                    <label for="textboxCountry" >Country</label>
                    <input id="textboxCountry" name="textboxCountry" type="text" style="width: 15em;"/>
                </li>
            </ol>
        </fieldset>        

        <fieldset class="nested">
            <legend>Phone numbers</legend>
            <ol>
                <li style="display:none">
                    <label for="textboxName" >Name</label>
                    <input id="text1" name="textboxName" type="text" style="width: 15em;"/>
                </li>
                <li style="display:none">
                    <label for="textboxAddress1" >Address</label>
                    <input id="text2" name="textboxAddress1" type="text" style="width: 15em;" />
                </li>
                <li>
                    <label for="textboxAddress2" >Phone</label> 
                    <input id="text3" name="textboxAddress2" type="text" style="width: 15em;"/>
                </li>
            </ol>    
        </fieldset>        

        <div class="buttonsContainer">
            <input class="button" type="submit" value="OK" /> 
            <input class="button" type="button" value="Cancel" /> 
        </div>

    </fieldset>

    </form>
</div>    

</body>

</html> 
```

CSS：

```
body 
{   
    margin: 0;
    padding: 0; 
    font-family: Verdana, Tahoma, Arial, sans-serif;
}

fieldset.main 
{  
    margin: 1.5em 0 0 1.5em;  
    padding: 1em 0 0 0;
    width: 400px;
    font-size: .9em;    
}

fieldset.main legend
{  
    margin-left: 1em;  
    color: #000000;  
    font-weight: bold;    
}

fieldset.main ol 
{  
    padding: 1em 1em 0 1em;  
    list-style: none;
}

fieldset.main li 
{  
    padding-bottom: .5em;
}

fieldset.main ol li label 
{  
    float: left;
    width: 10em;        
    margin-right: 1em;
}

/* ----------------------------------------- */

fieldset.nested 
{  
    margin: 0 0 1em 1em;  
    padding: 0;
    width: 93%;
    font-size: .8em;
    border: 1px solid gray;
    background: #B0C4DE;    

}

fieldset.nested legend
{  
    margin-left: 1em;      
    font-weight: normal;
    font-size: .9em; 
    color: black;
    background-color: white;
    padding: 0 1em 0 1em;
    border: 1px solid black;
}

fieldset.nested ol 
{  
    padding: 0 1em 0 1em;  
    list-style: none;
}

fieldset.nested li 
{  
    /* Control leading between rows. */
    padding-bottom: .7em;
}

fieldset.nested ol li label 
{  
    float: left;
    width: 10em;        
    margin-right: 1em;
}

/* ----------------------------------------- */

input.button
{                                  
    /* border-style: none; */
    width: 6em;
    height: 2.5em;
}

div.buttonsContainer
{
    float: right;
    margin: 1em 1em 1em 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T00:36:43.927

CSS 可以正常工作——如果你可以为事物输入像素宽度但遗憾的是当你需要本地化你的字符串并发现标签不合适时会失败。对于地址输入表单，我会坚持使用表格，因为它们可以正确调整大小和包装行为，并且几乎可以在所有浏览器上工作而不会出现问题。

**编辑**：我有点想知道是否有任何投票者检查了这些 SO 页面的布局

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T21:32:05.080

自己做这件事的一个很好的方法是在 firefox 上安装 firebug 并检查网站上实现这一点的元素。

[注册表单上](http://www.smashingmagazine.com/2008/07/04/web-form-design-patterns-sign-up-forms/)有一本很棒的杂志。可以看到 CSS 中的几种方法，其中有一些非常棒的例子。

# sql - 在 Delphi 中读取 MS Access mdb 文件（免费）？

> ID：736339
> 
> 赞同：5
> 
> 时间：2009-04-10T00:24:15.643
> 
> 标签：sql, delphi, ms-access, components, ms-jet-ace

我正在寻找一个 Delphi 组件/库来打开并从 mdb (MS Access) 数据库中读取。我不会写入数据库或显示数据；只需要使用 sql Access 支持的任何内容来读取数据库。

这是针对个人的副项目（编程不是我的付费工作），所以我需要一个免费或非常便宜的解决方案，它可以与 Delphi 6、Delphi 2007 或 Delphi 2009（所有专业版）中的任何一个一起使用。性能无关紧要，简单才是:)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-10T05:51:07.573

[http://www.teachitza.com/delphi/databasehowto.htm](http://www.teachitza.com/delphi/databasehowto.htm) 使用 5-10 行代码非常简单易行。当我需要从 ms 访问文件中读取一些数据时，这对我非常有用。

开始你可以使用像这样的简单连接字符串

```
 DataSource := 'Provider=Microsoft.Jet.OLEDB.4.0;Data Source=' + Filename +
    ';Persist Security Info=False';

  ADOConnection1.ConnectionString := DataSource;
  ADOConnection1.LoginPrompt := False;
  ADOConnection1.Connected := true;

  // ADOConnection1.GetTableNames(listbox1.items);

  AdoTable1.Connection := ADOConnection1;
  AdoTable1.ReadOnly := false; //if u want to make changes
  ADOTable1.active := false;
  ADOTable1.TableName := 'B2777'; //table name
  ADOTable1.active := true; 
```

filnename 是您的 mdb 文件路径+名称。这就是我用于非常简单的任务的方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-10T05:45:29.257

为此，我使用 Delphi 附带的 ADO 组件（“Microsoft Jet 4.0 OLE Provider”）。它需要在客户端上安装 MDAC，它已经包含在 XP 和更新的系统中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T00:27:41.593

您是否考虑过只使用 ODBC 来连接它？

# java - 使用开源 api 将 java 对象转换为 xml 的最佳方法是什么

> ID：736343
> 
> 赞同：38
> 
> 时间：2009-04-10T00:25:52.830
> 
> 标签：java, xml, serialization

我想知道将 java 对象转换为 xml 的最佳或最广泛使用的 api 是什么。我对这个主题相当陌生。是否可以进行某种 api 调用来传入对象并返回 xml？还是因为您需要通过提取对象值手动构建文档而更加乏味？

我一直在阅读有关 xerces、sax 和 jaxb 的信息。我想继续沿着这条开源路线前进。

谢谢！

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-04-10T01:01:00.797

**JAXB**绝对**是**解决方案。

为什么？嗯，它**在 JDK 6 里面**，所以你永远不会发现它没有维护。

它使用 Java 注释为类、方法和字段声明与 XML 相关的属性。

[**教程 1**](http://java.sun.com/webservices/docs/1.6/tutorial/doc/JAXBWorks.html)

[**教程 2**](http://jaxb.java.net/guide/)

注意：JAXB 还使您能够轻松地将 XML 数据（以前从 Java 对象实例编组）“解组”回对象实例。

JAXB 的另一大优点是：它受到其他 Java 相关技术的支持，例如**JAX-RS**（一种 Java RESTful API，作为**Java EE 6**的一部分提供）。JAX-RS 可以**即时**服务和接收 JAXB 对象，而无需编组/解组它们。您可能想查看[Netbeans](http://netbeans.org)，它包含对 JAX-RS 的开箱即用支持。阅读[本教程](http://www.netbeans.org/kb/60/websvc/rest.html)以开始使用。

**编辑：**

为了编组/解组“随机”（或外来）Java 对象，JAXB 提供了相当简单的可能性：可以声明一个**XmlAdapter** 并“包装”现有的 Java 类以与 JAXB 兼容。此类 XmlAdapter 的使用是通过使用**@XmlJavaTypeAdapter** -annotation 完成的。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-10T00:27:18.537

你可能想看看 XStream：http: [//x-stream.github.io](http://x-stream.github.io)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-09-24T18:53:04.043

Java 6 提供了一个将带注释的 Java 对象转换为 XML 的 API。以下代码显示如何将带​​注释的对象转换为 XML 字符串

```
final JAXBElement<Type> o = new ObjectFactory().createElement(new Type());

final Marshaller m = JAXBContext.newInstance(Type.class).createMarshaller();

// 如果您希望结果更易于阅读，请执行此操作。
m.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
m.marshal(o, System.out);
```

您可以通过添加模式验证来进一步扩展它（注意非常慢，但对调试很有用）

```
final JAXBElement<Type> o = new ObjectFactory().createElement(new Type());

final Marshaller m = JAXBContext.newInstance(Type.class).createMarshaller();
最终架构架构 = SchemaFactory.newInstance(
  "http://www.w3.org/2001/XMLSchema").newSchema(
  getClass().getResource("/META-INF/wsdl/schema.xsd"));
m.setSchema（模式）；
m.marshal(o, System.out);
```

如果 Type 是已定义的元素，则不需要对 JAXBElement 进行类型转换。（即有注解@XmlRootElement）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-10T01:23:05.377

java.beans.XMLEncoder 和 java.beans.XMLDecoder 呢？

[http://www.rgagnon.com/javadetails/java-0470.html](http://www.rgagnon.com/javadetails/java-0470.html)上的示例

再见。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-11T16:32:16.517

对于决定使用 JAXB 的任何人，请确保缓存 JAXBContext。众所周知，JAXBContext.newInstance 非常昂贵。我记录了一个在日志记录中使用到 xml 的转换并且没有缓存 JAXBContext.newInstance 的案例，当 20 个并发用户调用时，它会导致高达 5 秒的性能开销。

[http://app-inf.blogspot.com/2012/10/performance-tuning-logging-right-way.html](http://app-inf.blogspot.com/2012/10/performance-tuning-logging-right-way.html)

这并不是要阻止任何使用 JAXB 的人。缓存 JAXBContext 后，性能非常好，如上面的链接中所述。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-10T02:10:33.047

[XMLBeans](http://xmlbeans.apache.org/)是另一种，类似于 JAXB。我有一段时间没有看 JAXB，当我这样做时，它与 XMLBeans 相比相当糟糕，但那是几年前的事了（我更喜欢使用 JDK 中的东西而不是 3rd 方的东西，但我仍然使用XMLBeans 直到今天）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-12T17:47:15.073

这个领域有很多开源框架。然而，[Simple](http://simple.sourceforge.net/)顾名思义，是迄今为止执行序列化的最简单方法。看看[教程](http://simple.sourceforge.net/download/stream/doc/tutorial/tutorial.php)。另一个特点是它可以执行多态序列化，这意味着它不像 JAXB 那样受限制。

# c++ - 处理 Xlib/Xt 中的“新顶层窗口”事件

> ID：736345
> 
> 赞同：4
> 
> 时间：2009-04-10T00:25:55.547
> 
> 标签：c++, xlib, xt

所以我处于需要知道何时创建顶级窗口的情况。我在 Xlib/Xt 级别和不支持 EWMH 规范的窗口管理器上工作。我的想法是挂钩根窗口的 SubstructureNotify 事件。但事情并没有那么简单。

问题是并非每个 CreateNotify 事件都对应于 [b] 顶级 [/b] 窗口的创建。所以我认为我需要做的是以某种方式测试我从事件中获得的窗口，以确认它是顶级窗口。我已经接近了，但一些虚假的窗户仍然可以通过我的网络。例如，在 GTK 应用程序中，如果您有一个下拉框并单击它，则会创建一个新窗口，我不知道如何捕捉和忽略它。这样的窗口与典型的顶级应用程序窗口难以区分。

这是我到目前为止所拥有的：

```
// I am omiting (tons of) cleanup code and where I set the display and toplevel variables.

Display* display;
Widget toplevel;

bool has_name(Window window)
{
    XTextProperty data = XTextProperty ();
    return (!XGetWMName (display, window, &data));
}

bool has_client_leader(Window window)
{
    unsigned long nitems = 0;
    unsigned char* data = 0;
    Atom actual_type;
    int actual_format;
    unsigned long bytes;
    // WM_CLIENT_LEADER is an interned Atom for the WM_CLIENT_LEADER property
    int status = XGetWindowProperty (display, window, WM_CLIENT_LEADER, 0L, (~0L), False,
        AnyPropertyType, &actual_type, &actual_format, &nitems, &bytes, &data);
    if (status != Success || acutal_type == None) return false;
    Window* leader = reinterpret_cast<Window*> (data);
    return (*leader != 0);
}

bool has_class(Window window)
{
    XClassHint data = XClassHint ();
    return (!GetClassHint (display, window, &data));
}

void handle_event(Widget widget, XtPointer, XEvent* event, Boolean*)
{
    if (event->type != CreateNotify) return;

    Window w = event->xcreatewindow.window;

    // confirm window has a name
    if (!has_name (w)) return;

    // confirm window is a client window
    Window client = XmuClientWindow (display, w);
    if (!client || client != w) return;

    // confirm window has a client leader that is not 0x0
    if (!has_client_leader (client)) return;

    // confirm window has a class
    if (!has_class (client)) return;

    // The window has passed all our checks!
    // Go on to do stuff with the window ...
}

int main(int argc, char* argv[])
{
    // ...

    // Setting up the event handler for SubstructureNotify on root window
    Window root_window = XDefaultRootWindow (display);
    Widget dummy = XtCreateWidget ("dummy", coreWidgetClass, toplevel, 0, 0);
    XtRegisterDrawable (display, root_window, dummy);
    XSelectInput (display, root_window, SubstructureNotifyMask);
    XtAddRawEventHandler (dummy, SubstructureNotifyMask, False, handle_event, 0);

// ...
} 
```

远射，但有没有人有任何想法我可以尝试？我想不出我还能在这里做多少其他事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-22T16:46:11.327

我假设您熟悉[ICCCM](http://tronche.com/gui/x/icccm/ "国际商会")及其[冗长的讨论](http://tronche.com/gui/x/icccm/sec-4.html "冗长的讨论")。

你检查过`WM_TRANSIENT_FOR`房产吗？

# c# - 在最小化服务器-客户端行程的同时从弹出窗口更新 TreeView 节点

> ID：736356
> 
> 赞同：2
> 
> 时间：2009-04-10T00:32:08.650
> 
> 标签：c#, asp.net, jquery, webforms, treeview

我发了好几次，但没有人会给我一个我能用简单的英语理解的答案。我是 JSON/JQuery/Ajax/所有其他很酷的库或工具的新手，你可能会建议我，所以请记住这一点。

我正在使用 c# 和 asp.net web 表单（我也有 ajax 工具包，但还没有使用它）。

这是我的场景：

*   我需要实现一个将使用 TreeView 控件的功能。

*   父页面将显示一个 TreeView，用户将能够单击该节点，这将触发一个弹出窗口，用户将在其中输入一些信息。

*   弹出窗口会将信息保存到数据库，将结果值返回给父窗口，并且父窗口应该更新以反映更改。

据我了解，这是很常见的情况。

现在，我的问题是实现这一目标的最简单方法是什么，同时记住我必须尽量减少客户端和 Web 服务器之间的行程次数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T15:18:10.780

我建议将[jQuery](http://jquery.com/ "jQuery")与[jqModal](http://dev.iceburg.net/jquery/jqModal/ "jq模态")插件一起使用，而不是使用“弹出窗口”。

不管这应该是你在 JavaScript 中寻找的东西，

```
opener.document.[parent_form_ID].[parent_input_ID].value = [value to be passed to the parent]; 
```

您可以将上述代码添加到子窗口的保存事件中，以将用户输入的数据传回父窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-20T17:06:04.337

就个人而言，您可能想要做的只是在将值返回到父页面时触发异步回发以更新树视图。

本质上，将树视图放在一个 UpdatePanel 中，然后有一个隐藏按钮来触发，并从 JS 调用它来强制更新。它将降低有效负载，并且很可能是您需要更新的最低限度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T20:54:11.387

我希望，我已经整理了一个可以满足您要求的示例。[它使用SimpleModal](http://www.ericmmartin.com/projects/simplemodal/)打开一个客户端 jQuery 弹出窗口（弹出窗口本身仍然需要一些工作）。当弹出窗口打开时，会显示一个文本框和一个提交按钮。提交时，通过 Ajax 调用 ASP.NET 页面方法。page 方法接收发布的数据并返回一个随机数（以表明它有效）。然后随机数显示在树中。

首先是`aspx.cs`文件（没有导入）和用作页面方法返回类型的类：

```
public partial class _Default : Page
{
    [WebMethod]
    public static MethodResult SaveData(string nodeId, string value,
                                        string elementId)
    {
        return new MethodResult
               { ElementId = elementId, Result = new Random().Next(42) };
    }
}
public class MethodResult
{
    public string ElementId { get; set; }
    public int Result { get; set; }
} 
```

页面方法很简单。它接收节点 ID，因此您知道要在数据库中更新什么、来自文本框的值以及返回后要更新的 UI 元素的 ID。该方法返回一个`MethodResult`类的实例，其中包含要更新的 UI 元素的 id 和实际结果（一个随机数）。

接下来我们有一个`aspx`包含更多代码行的文件。它有很多评论，所以我希望一切都清楚。

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="Default.aspx.cs" Inherits="SO_736356._Default" %>
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
<title>Test</title>
<script type="text/javascript" src="Scripts/jquery-1.3.2.js" ></script>
<script type="text/javascript" src="Scripts/jquery.simplemodal-1.2.3.js" ></script>
<script type="text/javascript">
    $(document).ready(function() {
        // Select all a elements with an id that starts with 'treet' (all
        // nodes in the tree have an id that starts with treet: treet0,
        // treet1, ...). Add an onclick handler to all these elements.
        $("a[id^='treet']").click(function() {
            // In an asp:TreeView the href element of each node contains
            // the node value so we parse the href element to obtain this
            // value.
            var href = $(this).attr("href");
            $("#hiddenNodeId").val(href.substring(href.lastIndexOf("\\\\") + 2, href.indexOf("')")));
            // We need to remember the id of the element we clicked on,
            // otherwise we don't what element to update when the page
            // method call returns.
            $("#hiddenElementId").val($(this).attr("id"));
            // Show the popup.
            $("#popup").modal();
            // Return false to cancel the onclick handler that was already
            // on the a element (view source).
            return false;
        });

        // The spanSubmit element is our postback link so when we click it
        // we perform an AJAX call to the page method (Default.aspx/SaveData).
        $("#spanSubmit").css("cursor", "hand").click(function() {
            var nodeId = $("#hiddenNodeId").val();
            var input = $("#txtInput").val();
            var elementId = $("#hiddenElementId").val();
            $.ajax({
                type: "POST",
                url: "Default.aspx/SaveData",
                // The parameter names must match exactly.
                data: "{nodeId: \"" + nodeId + "\", value: \"" +
                        input + "\", elementId: \"" + elementId + "\"}",
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function(result) {
                    // The property result.d contains our result. We select
                    // the right element and set its text to another value.
                    $("#" + result.d.ElementId).text(
                        "Random number " + result.d.Result);
                }
            });
        });
    });
</script>
</head>
<body>
<form id="form" runat="server">
<div>
    <%-- The actual tree, no fancy stuff here. --%>
    <asp:TreeView ID="tree" runat="server">
        <Nodes>
            <asp:TreeNode Value="0" Text="Node_0" >
                <asp:TreeNode Value="0_0" Text="Node_0_0">
                    <asp:TreeNode Value="0_0_0" Text="Node_0_0_0" />
                    <asp:TreeNode Value="0_0_1" Text="Node_0_0_1" />
                </asp:TreeNode>
                <asp:TreeNode Value="0_1" Text="Node_0_1">
                    <asp:TreeNode Value="0_1_0" Text="Node_0_1_0" />
                </asp:TreeNode>
                <asp:TreeNode Value="0_2" Text="Node_0_2">
                    <asp:TreeNode Value="0_2_0" Text="Node_0_2_0" />
                </asp:TreeNode>
            </asp:TreeNode>
            <asp:TreeNode Value="1" Text="Node_1">
                <asp:TreeNode Value="1_0" Text="Node_1_0">
                    <asp:TreeNode Value="1_0_0" Text="Node_1_0_0" />
                    <asp:TreeNode Value="1_0_1" Text="Node_1_0_1" />
                </asp:TreeNode>
            </asp:TreeNode>
        </Nodes>
    </asp:TreeView>
</div>

<%-- The popup with the hidden fields that are set when we click a node
     and the textbox and submit button. --%>
<div id="popup" style="display: none;">
    <input id="hiddenNodeId" type="hidden" />
    <input id="hiddenElementId" type="hidden" />
    <label id="lblInput" for="txtInput">Input:</label><input id="txtInput" type="text" />
    <br />
    <span id="spanSubmit">Save</span>
</div>
</form>
</body>
</html> 
```

# multithreading - 有没有办法可以使两次读取原子？

> ID：736365
> 
> 赞同：6
> 
> 时间：2009-04-10T00:37:29.947
> 
> 标签：multithreading, language-agnostic, atomic, lock-free

我遇到了一种情况，我需要内存中两个值的原子和。我继承的代码是这样的：

```
int a = *MemoryLocationOne;
memory_fence();
int b = *MemoryLocationTwo;
return (a + b) == 0; 
```

a 和 b 的单独读取是原子的，并且代码中其他地方对这两个内存位置的所有写入也是无锁原子的。然而，问题在于这两个位置的值可以并且确实在两次读取之间发生变化。

那么如何使这个操作原子化呢？我对 CAS 了如指掌，但它往往只涉及使读-修改-写操作原子化，而这并不是我想在这里做的。

有没有办法做到这一点，或者是重构代码的最佳选择，以便我只需要检查一个值？

编辑：谢谢，我没有提到我想在第一个修订版中无锁地执行此操作，但在我第二个修订版后有人接受了它。我知道当人们说这样的话时没有人相信，但我实际上不会使用锁。我必须用原子来模拟互斥锁，这比重构代码以跟踪一个值而不是两个值要多得多。

目前，我的调查方法涉及利用值是连续的这一事实，并通过 64 位读取原子地抓取它们，我确信这在我的目标平台上是原子的。如果有人有新的想法，请贡献！谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T00:40:28.787

您必须确保在读取或写入两个值中的任何一个的任何地方，它们都被内存屏障（锁或临界区）包围。

```
// all reads...
lock(lockProtectingAllAccessToMemoryOneAndTwo)
{
    a = *MemoryLocationOne;
    b = *MemoryLocationTwo;
} 
```

...

```
// all writes...
lock(lockProtectingAllAccessToMemoryOneAndTwo)
{
    *MemoryLocationOne = someValue;
    *MemoryLocationTwo = someOtherValue;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T00:40:54.340

如果您确实需要确保在进行此测试`a`时`b`不进行更改，那么您需要对**所有**访问`a`和`b`. 那是你唯一的选择。对这些值中的任何一个的每次读取和每次写入都需要使用相同的内存栅栏、同步器、信号量、时间片锁或使用的任何机制。

有了这个，您可以确保如果您：

```
memory_fence_start();
int a = *MemoryLocationOne;
int b = *MemoryLocationTwo;
int test = (a + b) == 0;
memory_fence_stop();

return test; 
```

然后`a`在您阅读时不会改变`b`。但同样，您必须使用相同的同步机制来*访问*和`a`访问`b`.

为了反映稍后对您正在寻找无锁方法的问题的编辑，这完全取决于您使用的处理器以及多长时间`a`以及`b`这些内存位置是否连续并正确对齐。

假设这些在内存中是连续的并且每个 32 位，并且您的处理器具有原子 64 位读取，那么您可以发出原子 64 位读取来读取两个值，从 64 位值中解析出这两个值，做数学并返回你想要返回的东西。假设您从不需要对“同时”进行`a`原子`b`更新，而只需要对“ `a`”或“ `b`”进行原子更新，那么这将在没有锁的情况下完成您想要的操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T00:58:34.670

如果您的目标是 x86，则可以使用 64 位比较/交换支持并将两个 int 打包成一个 64 位字。

在 Windows 上，您可以这样做：

```
// Skipping ensuring padding.
union Data
{
     struct members
     {
         int a;
         int b;
     };

     LONGLONG _64bitData;  
};

Data* data;

Data captured;

do
{
    captured = *data;
    int result = captured.members.a + captured.members.b;
} while (InterlockedCompareExchange64((LONGLONG*)&data->_64bitData,
                    captured._64BitData,
                    captured._64bitData) != captured._64BitData); 
```

真的很丑。我建议使用锁 - 更易于维护。

编辑：更新和阅读各个部分：

```
data->members.a = 0;
fence();

data->members.b = 0;
fence();

int captured = data->members.a;

int captured = data->members.b; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T00:44:03.257

没有锁真的没有办法做到这一点。据我所知，没有处理器具有双重原子读取。

# vim - 如何在 VIM 中从 A 到 B 重复匹配？

> ID：736376
> 
> 赞同：0
> 
> 时间：2009-04-10T00:41:28.317
> 
> 标签：vim, design-patterns, match

我需要在`<Annotation>`和之间获取所有文本`</Annotation>`，其中出现一个单词`MATCH`。我怎样才能在 VIM 中做到这一点？

```
<Annotation about="MATCH UNTIL </Annotation>   " timestamp="0x000463e92263dd4a" href="     5raS5maS90ZWh0YXZha29rb2VsbWEvbGFza2FyaS8QyrqPk5L9mAI">                                                                        
  <Label name="las" />
  <Label name="_cse_6sbbohxmd_c" />
  <AdditionalData attribute="original_url" value="MATCH UNTIL </Annotation>       " />
</Annotation>
<Annotation about="NO MATCH" href="     Cjl3aWtpLmhlbHNpbmtpLmZpL2Rpc3BsYXkvbWF0aHN0YXRLdXJzc2l0L0thaWtraStrdXJzc2l0LyoQh_HGoJH9mAI">
  <Label name="_cse_6sbbohxmd_c" />
  <Label name="courses" />
  <Label name="kurssit" />
  <AdditionalData attribute="original_url" value="NO MATCH" />
</Annotation>
<Annotation about="MATCH UNTIL </ANNOTATION>     " score="1" timestamp="0x000463e90f8eed5c" href="CiZtYXRoc3RhdC5oZWx     zaW5raS5maS90ZWh0YXZha29rb2VsbWEvKhDc2rv8kP2YAg">
  <Label name="_cse_6sbbohxmd_c" />
  <Label name="exercises_without_solutions" />
  <Label name="tehtäväkokoelma" />
  <AdditionalData attribute="original_url" value="MATCH UNTIL </ANNOTATION>" />
</Annotation> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T02:42:13.610

首先，免责声明：任何使用正则表达式对 XML 进行切片和切块的尝试都是脆弱的；真正的 XML 解析器会做得更好。

图案：

```
\(<Annotation\(\s*\w\+="[^"]\{-}"\s\{-}\)*>\)\@<=\(\(<\/Annotation\)\@!\_.\)\{-}"MATCH\_.\{-}\(<\/Annotation>\)\@= 
```

让我们分解一下...

第 1 组是`<Annotation\(\s*\w\+="[^"]\{-}"\s\{-}\)*>`。它与 Attribute 元素的开始标签匹配。组 2 嵌入在组 1 中，匹配一个属性并且可以重复 0 次或更多次。

第 2 组是`\s*\w\+="[^"]\{-}"\s\{-}`。这些作品中的大多数都是常用的；最不寻常的是`\{-}`，这意味着非贪婪重复（`*?`在 Perl 兼容的正则表达式中）。最后的非贪婪空白匹配对性能很重要；`\s*`没有它，Vim 将尝试所有可能的方法来分割第 2 组末尾的属性和`\s*`下一次第 2 组开始时的属性之间的空白。

组 1 之后是`\@<=`。这是一个零宽度的正向回顾。它防止开始标签包含在匹配的文本中（例如，对于 s///）。

第 3 组是`\(<\/Annotation\)\@!\_.`。它包括第 4 组，它与属性结束标记的开头相匹配。这`\@!`是一个零宽度的负前瞻并`\_.`匹配任何字符（包括换行符）。这些组一起匹配任何字符，除了属性结束标记开始的位置。第 3 组后面是一个非贪婪的重复标记`\{-}`，以便它匹配 MATCH 之前的最小文本块。如果您要使用`\_.`而不是第 3 组，则匹配的文本可以包括*不*包含 MATCH 的 Annotation 元素的结束标记，并继续使用 MATCH 进入下一个 Annotation 元素。（尝试一下。）

下一点很简单：在结束标记之前找到 MATCH 和最少数量的其他字符。

第 5 组很简单：它是结束标签。`\@=`是一个零宽度的正向前瞻，`\@<=`出于与起始标签相同的原因，将其包含在此处。我们必须重复`<\/Attribute`而不是使用`\4`，因为没有捕获具有零宽度修饰符的组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T01:13:33.683

它*必须*在vim中完成吗？你可以作弊，并打开第二个窗口，在其中将某些内容输入更多/更少，告诉你要在 vim 中转到哪个行号？

- 编辑 -

我从未在 vi[m] 中进行过多行匹配/搜索。但是，在另一个窗口中作弊：

```
perl -n -e 'if ( /<tag/ .. /<\/tag/)' -e '{ print "$.:$_"; }' file.xml | less 
```

将显示“标签”（或其他更长的匹配名称）的元素/块，带有行号，更少，然后您可以在每个块中搜索其他文本。

足够近？

- 编辑 -

在“少”内，输入

```
/MATCH 
```

搜索 MATCH 的出现。左边距将是该实例（在目标元素/标签内）所在的行号。

在 vi[m] 内，输入

```
:n 
```

其中“n”是所需的行号。

当然，如果您真正想做的是某种搜索/拉动/替换，那就更复杂了。那时，awk / perl / ruby​​（或符合您口味的类似东西......或 xsl？）确实是您应该用于转换的工具。

# delphi - delphi最好的免费ftp组件是什么

> ID：736388
> 
> 赞同：-3
> 
> 时间：2009-04-10T00:47:54.870
> 
> 标签：delphi, ftp, delphi-6

我用的是delphi6，我们公司不想升级，发现Tidftp缺少MLSD命令，请问你现在用的免费ftp组件是什么？

ps：我在google上搜过一个，不知道哪个稳定、标准。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T02:23:33.140

我没有使用[Synapse](http://www.ararat.cz/synapse/doku.php)，但我听到了好消息，而且看起来不错。[Sourceforge 上](http://sourceforge.net/projects/synalist)的SVN有更新的代码。

> *   支持FTP协议（支持多种防火墙，包括自定义防火墙、上传和下载恢复、两台FTP服务器之间的传输）。也实现了目录列表解析。SSL/TLS 支持。
> *   支持 TFTP 协议（​​客户端和服务器）。

除此之外，我在[Indy 的 TidFTP 上](http://www.indyproject.org/Sockets/index.EN.aspx)运气不错，尽管我使用 Indy 9 的次数超过了 10 个。

顺便说一句，我不具体了解 MLSD 命令，但似乎有一种方法可以使用 Indy 将自定义命令发送到服务器。我知道我实际上用它来实现更详细的目录列表，所以那可能是当时的 MLSD。. ..

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T05:52:49.677

完毕！

下载最新的[Indy](http://www.indyproject.org/Sockets/Docs/index.EN.aspx)组件，TidFtp很好用！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T20:40:24.457

您还可以检查 ICS TFtpCli

[http://www.overbyte.be/frame_index.html](http://www.overbyte.be/frame_index.html)

# charts - 如何动态绘制/图表间隔数据

> ID：736390
> 
> 赞同：0
> 
> 时间：2009-04-10T00:48:20.670
> 
> 标签：charts, openoffice-calc

我有兴趣创建一个或多个间隔计量数据的电子表格图。原始数据被记录为一个不断增加的值（即总字节数、用户登录、网站点击）和日期。每个样本测量日期将发生在一个非恒定的时间间隔内。为简单起见，我想将数据记录在电子表格程序中，例如 OpenOffice Calc。

数据示例：

```
Date/Time             Value
1/1/09  12:00 PM      10
1/1/09   5:00 PM      30
1/2/09   9:00 AM      100
1/2/09   6:00 PM      150 
```

理想情况下，我希望有一个图表来绘制数据速率，并具有以下功能：

1.  收集新数据时动态选择图表日期范围。（N天到N年）
2.  数据速率显示的动态粒度。（每小时、每天、每月、每年）
3.  额外的功劳，使第二个数据图覆盖第一个图。

请评论这是多么可行，以及我可以使用哪些技术和功能在 Excel 或 OpenOffice Calc 中完成此操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-12T02:53:45.143

虽然您也许可以为此使用电子表格，但我认为最好使用专门为此类图形制作的工具来完成。如果您搜索“图表网络流量”或“图表磁盘温度”，您应该会得到大量不同解决方案的结果。

对于监控网卡/路由器， [MRTG](http://oss.oetiker.ch/mrtg/) + [rrdtool](http://oss.oetiker.ch/rrdtool)是一种常见的解决方案。对于监控其他事情，比如几个磁盘的磁盘温度，mrtg 不太适合，但 rrdtool 仍然适用，请参阅[此处](http://martybugs.net/linux/hddtemp.cgi)的示例。

您还可以在[此处](http://www.supershareware.com/info/traffic-graph.html)查看其他替代方案的列表。

# c# - LINQ to Xml 不等于运算符

> ID：736391
> 
> 赞同：0
> 
> 时间：2009-04-10T00:48:42.947
> 
> 标签：c#, xml, linq

我正在使用 LINQ to XML。我想`<>`在下面的子句中使用相当于 sql 的运算符`where`....

```
var myBooks = from book in xDoc.Descendants("BOOKOB") 
              where book.Element("AUTHOR").Value 
```

请帮忙！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-10T00:49:38.030

不是 != 工作吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T06:59:37.643

正如其他人所说，您可以非常轻松地使用 != - 不要忘记，即使您使用 LINQ，您也是在编写 C#，*而不是*SQL。

当然，您需要为它提供一个不等于的值以及一个`select`子句：

```
var myBooks = from book in xDoc.Descendants("BOOKOB") 
              where book.Element("AUTHOR").Value != "Jeff Atwood"
              select book; 
```

对于像这样的简单查询，我通常会发现“点表示法”更易于阅读：

```
var myBooks = xDoc.Descendants("BOOKOB")
                  .Where(b => b.Element("AUTHOR").Value != "Jeff Atwood"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T00:57:18.230

您应该能够使用 != 表示不等于，使用 == 表示等于。

# php - PEAR 在现实世界中有多普遍？

> ID：736397
> 
> 赞同：8
> 
> 时间：2009-04-10T00:52:16.013
> 
> 标签：php, frameworks, pear

我看过很多其他人的源代码和其他开源 PHP 软件，但在我看来，几乎没有人真正使用 PEAR。

PEAR 在现实世界中的使用有多普遍？

我在想，也许目前对框架的感觉可能会影响它的受欢迎程度。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-10T01:01:29.157

PHP 程序员文化似乎盛行“非在这里发明”综合症，每个人似乎都想自己重新发明轮子。

并不是说这适用于*所有*PHP 程序员，但他们这样做显然太正常了。

很多时候我认为这是由于缺乏教育，再加上托管服务提供商难以提供像样的 PHP 服务。

这使得获得一个可行的 PEAR 安装变得更加困难，并且由于 PHP 的设计结构不利于模块化设计而恶化。

（这可能会随着命名空间的添加而改善，但还没有看到）。

我在野外看到的绝大多数 PHP 代码仍然是用 HTML 插值的经典业余代码，而且 PHP 用户不可避免地注册的大多数廉价托管都不会为您提供 shell 访问权限。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-10T06:00:32.700

在我（有限的）经验中，每个可能有趣的 PEAR 项目都有反对它的主要观点：

*   代码面向尽可能广泛的受众。到处都有黑客来处理旧的/不受支持的 PHP 版本。如果无法在旧版本上模拟新的有用功能，则它们将被忽略，这意味着您最终会落后于核心语言的开发。
*   任何给定的项目都会不断增长，直到它用一个简单的`include`. 当您的 PHP 解释器必须在每个页面命中时处理所有源代码时（因为作者可能没有将其设计为对操作码缓存友好），处理数千行未使用的代码会产生可测量的开销。
*   风格总是不一致。从来没有觉得我在学习其他语言的通用 API。

我以前`PEAR::DB`在工作中使用。我们发现我们的大部分脚本都花时间在 PEAR 代码中，而不是我们自己的代码中。`pgsql_*`由于使用了*真正的*准备好的语句 ，用一个非常简单的函数包装器替换它显着减少了执行时间并提高了运行时安全性。`PEAR::DB`为 Postgres 使用了自己的（当时不正确的）prepared-statement 逻辑，因为本机`pgsql_`函数太新而无法在任何地方使用。

总的来说，我觉得 PEAR 在很多情况下都可以作为一个“入门库”。它可能是比任何人在短时间内生成的质量更高的代码。但我肯定不会在一个流行的面向公众的网站中使用它（至少，在没有大量手动调整的情况下……维护我自己的分叉）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T02:14:18.810

我认为 PEAR 是一个很好的项目，但缺少想要工作并*继续*工作的人，大多数包的编码实践不一致（我不是指编码风格），而且整个事情中有很多 TODO。

我发现它有时对编码我不知道的东西很有用，比如自定义国家验证函数等等，否则我最好使用任何可用的框架（比如 CodeIgnite 或 Zend 框架）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T01:00:59.283

Pear 库是那种坐在那里的东西，没有任何荣耀。如果您正在寻找它可以做的事情，并且在您使用的框架中没有更具体的目标 - 去使用它。

在过去的两年里，我一直在一个约会网站上工作——我使用过至少 65 个梨源文件，并且今天仍然存在。有些，如寻呼机或 html_Quickform 将在更新时被新代码取代，但对于其他人来说，没有必要。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T05:06:19.927

PEAR 不常见，也不流行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T05:10:40.073

我多次尝试使用 PEAR，但它缺乏提交的 umphh。

我更喜欢 Zend Framework，它采用“松散”类型的方法，只使用你想要的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-02T00:21:51.830

PEAR 不常见，也不受欢迎——但它*很好*，我会推荐给任何人。

（我确实同意 Tom 的观点，因为它感觉不像是一个单一的、统一的 API；但是，这是 PHP ......人们不希望看到它现在作为一种解释性的*hack*语言超越它的地位吗？！ )

# objective-c - 让视图控制器消失

> ID：736400
> 
> 赞同：1
> 
> 时间：2009-04-10T00:53:18.163
> 
> 标签：objective-c, uiviewcontroller

我正在尝试一个多视图应用程序，但是当我引入新的视图控制器时，我似乎无法让第一个视图控制器消失。我将第二个（即将到来的）视图控制器放置在索引 0 处，它只是将它放在后台。我认为 [going.view removeFromSuperview] 会删除原来的视图控制器，但事实并非如此......

```
UIViewController *coming = nil;
    UIViewController *going = nil;
    UIViewAnimationTransition transition;

    if (answer == YES)
    {
        coming = boyController;
        going = getInfoController;
        transition = UIViewAnimationTransitionFlipFromLeft;
    }
    else
    {
        coming = girlController;
        going = getInfoController;
        transition = UIViewAnimationTransitionFlipFromLeft;
    }
    NSLog(child);
    [UIView setAnimationTransition:transition forView: self.view cache:YES];
    [coming viewWillAppear:YES];
    [going viewWillDisappear:YES];
    [going.view removeFromSuperview];
    [self.view insertSubview:coming.view atIndex:0];
    [going viewDidDisappear:YES];
    [coming viewDidAppear:YES];

    [UIView commitAnimations]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T15:34:10.557

首先进行一点重构：

```
coming = (answer ? boyController : girlController); 
```

您可以删除`going`and `transition`，因为它们只使用一次。然后，要实际制作动画，您需要将所有内容放在动画块的上下文中。

```
[UIView beginAnimations:@"flipAnimation" context:NULL];
[UIView setAnimationTransition:transition forView:self.view cache:YES];
[getInfoController.view removeFromSuperview];
[self.view addSubview:coming.view];
[UIView commitAnimations]; 
```

`viewWillAppear:`并且`viewWillDisappear:`是委托方法。如果有的话，这些将在这些视图的委托上自动调用。他们不应该被手动调用。

# c - C函数貌似没有在任何地方定义！

> ID：736408
> 
> 赞同：4
> 
> 时间：2009-04-10T00:58:20.630
> 
> 标签：c, vim

我正在查看 vim 源代码，特别是文件[normal.c](http://svn.jansson.be/limp/vim-ecl/7.2/src/normal.c)，我看到这个函数`nv_operator`正在使用，但它没有在任何地方定义（我 grepped 了整个 src 目录）

它仅声明为：

```
static void nv_operator __ARGS((cmdarg_T *cap)); 
```

我查看了 __ARGS 的定义，但它只是......
在[vim.h](http://svn.jansson.be/limp/vim-ecl/7.2/src/vim.h)中什么都没有（几乎） ：

```
#define __ARGS(x) x 
```

那么可能会发生什么？这是某种`C`创建虚拟函数的技术还是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-10T01:09:28.997

这里有一个定义：

```
/*
 * Handle an operator command.
 * The actual work is done by do_pending_operator().
 */
    static void
nv_operator(cap)
    cmdarg_T    *cap;
.... 
```

这种定义风格是为其参数使用标识符列表。该样式已弃用（已过时），但仍可在 C 中使用。标识符在参数列表中命名，其类型在紧随函数声明符但位于函数主体之前的声明中命名。

该`__ARGS`宏用于处理不了解函数原型的编译器（声明参数的另一种形式 - 类型*和*名称直接组合在函数参数列表中）。我认为它会在声明中根本不发出任何参数。

更新：请参阅此代码`vim.h`：

```
#if defined(MACOS) && (defined(__MRC__) || defined(__SC__))
   /* Apple's Compilers support prototypes */
# define __ARGS(x) x
#endif
#ifndef __ARGS
# if defined(__STDC__) || defined(__GNUC__) || defined(WIN3264)
#  define __ARGS(x) x
# else
#  define __ARGS(x) ()
# endif
#endif 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T01:09:05.100

它只是一个[前向声明](http://en.wikipedia.org/wiki/Forward_declaration)，因此该函数在实际定义之前（在第 8247 行）对于 C 编译器是已知的（并且可以被使用（从其他函数调用））。定义的实际格式（包括换行符）使得很难用 grep 判断它的存在。

不要被 __ARGS 宏分心。它只是 K&R C 与 ANSI C 不同函数声明语法的兼容性宏。

在[ANSI C](http://en.wikipedia.org/wiki/ANSI_C)中，函数声明必须如下所示：

> int getopt(int, char * const *, const char *);

在（旧的）Kernighan 和 Ritchie C [http://en.wikipedia.org/wiki/C_(programming_language)#K.26R_C](http://en.wikipedia.org/wiki/C_(programming_language)#K.26R_C)

> int getopt();

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T01:11:24.563

很难找到，因为它是如何定义的：

nv_operator（上限）

单独出现在一行上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T01:12:08.133

我不太确定发生了什么，但这里有一些提示可以帮助您进行搜索：

首先， __ARGS 宏似乎在那里，因为可能存在 C 的版本，您不应该在函数的声明中包含 args（请注意，宏的定义因其他预处理器符号而异……注释说出来）。

其次，搜索函数 nv_operator 可能不够好。该函数可能由宏等生成，因此您无法搜索显式定义....例如，预处理器可能添加了“nv”前缀。

希望这可以帮助。

# python - Django 应用程序中的 Ping FeedBurner

> ID：736413
> 
> 赞同：4
> 
> 时间：2009-04-10T01:00:55.960
> 
> 标签：python, django, xml-rpc

我有一个 django 站点，其中一些提要是通过 FeedBurner 发布的。每当我保存特定模型的实例时，我都想 ping FeedBurner。FeedBurner 的网站说要使用 XML-RPC ping 机制，但是我找不到很多关于如何实现它的文档。

在 django/Python 中进行 XML-RPC ping 最简单的方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-10T03:14:49.650

保存模型后，您可以使用 Django 的[`signals`](http://docs.djangoproject.com/en/dev/topics/signals/)功能获取回调：

```
import xmlrpclib
from django.db.models.signals import post_save
from app.models import MyModel

def ping_handler(sender, instance=None, **kwargs):
    if instance is None:
        return
    rpc = xmlrpclib.Server('http://ping.feedburner.google.com/')
    rpc.weblogUpdates.ping(instance.title, instance.get_absolute_url())

post_save.connect(ping_handler, sender=MyModel) 
```

显然，您应该使用适用于您的应用程序的内容来更新它，并阅读信号以防万一您想要不同的事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T05:48:24.100

使用可插拔应用程序，卢克！

[http://github.com/svetlyak40wt/django-pingback/](http://github.com/svetlyak40wt/django-pingback/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T02:51:02.763

也许是这样的：

```
import xmlrpclib
j = xmlrpclib.Server('http://feedburnerrpc')
reply = j.weblogUpdates.ping('website title','http://urltothenewpost') 
```

# synchronization - linux中的iTron数据队列

> ID：736417
> 
> 赞同：1
> 
> 时间：2009-04-10T01:02:03.820
> 
> 标签：synchronization, embedded, itron

在 iTron 中有一个更轻量的消息队列版本，称为数据队列。它们非常易于用于快速消息传输。Linux中是否有任何等效的同步原语？

**data-queue的定义：单字消息的队列**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-14T14:19:13.293

在我需要实现自己的消息队列的少数情况下，我倾向于为每个队列使用 1 个信号量和 1 个互斥量（或信号量）。我只处理了线程级队列，所以如果你想要两个进程之间的队列，这可能不适用。

信号量用于统计队列中的消息数量，并为线程提供挂起/等待新消息的操作系统机制。

互斥体用于保护整个队列结构。

所以，它可能看起来有点像这样（非常伪代码）：

```
DataQueueRx( Queue*, WORD*, timeout? )
{
   WaitOnSemaphore( Queue->sema, timeout? );  //get token
   LockMutex
   {
      //manipulate your queue, and transfer the data to WORD
   } 
   ReleaseMutex
}

DataQueueTx( Queue*, WORD )
{
   LockMutex
   {
      //manipulate your queue, inserting new WORD msg

      ReleaseSemaphore(Queue->sema);  //increment semaphore count
   }
   UnlockMutex
} 
```

但是，也许这不是很“轻量级”。这也假设队列在使用时没有被破坏。另外，我怀疑只有“WORD”的队列可能会有一些优化。

如果您正在寻找“无锁代码”，那么我建议您花一两天时间阅读[Sutter 的这些文章](http://herbsutter.wordpress.com/2009/03/16/effective-concurrency-use-threads-correctly-isolation-asynchronous-messages/)。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T01:56:02.537

我不知道有任何这样的原始人。[我使用POSIX 信号量](https://stackoverflow.com/questions/355030/is-it-possible-to-avoid-a-wakeup-waiting-race-using-only-posix-semaphores-is-i)实现了一个原子队列。

# semantics - Perl 还是 perl，TIF 还是 TIFF，ant 还是 Ant，ClearCase 还是 Clear Case？

> ID：736422
> 
> 赞同：0
> 
> 时间：2009-04-10T01:07:52.560
> 
> 标签：semantics

在一句话中，我设法创造了 16 种可能的关于我如何呈现信息的变化。只要上下文清楚，这是否重要？有什么常见的错误让你恼火吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T01:10:48.043

关于 Perl：[我应该如何大写 Perl？](https://stackoverflow.com/questions/72312/how-should-i-capitalize-perl)

TIFF 代表标记图像文件格式，而使用该格式的文件的扩展名通常是“.tif”。我相信这是为了与 8.3 文件名兼容。

当用作专有名词时，我通常喜欢 Perl 的大写方式，但在指代命令本身时使用小写（假设命令以小写开头）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T01:17:06.607

尽管 Perl 最初是 Practical Extraction and Report Language 的首字母缩写词，但它是用 Perl 编写的。

这些事情并没有像它们提供对演讲者/作者知识水平的见解一样“困扰”我。你看，我们在一个需要精确度的行业工作，所以语言的精确度确实很重要，因为它会影响消费者的理解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T01:24:26.357

好吧，Perl 和 TIFF[已经回答了](https://stackoverflow.com/questions/736422/which-is-it-perl-or-perl-tif-or-tiff-ant-or-ant-clearcase-or-clear-case/736428#736428)，所以我将添加最后两个

*   Apache 基金会编写[“Apache Ant”](http://ant.apache.org/)。
*   [Rational ClearCase](http://www-01.ibm.com/software/awdtools/clearcase/)（或有时是“IBM Rational ClearCase”）在其网站上是这样编写的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T01:41:55.923

真正困扰我的是当人们完全大写 JAVA 时，就好像它是一个首字母缩略词一样。

# scala - Scala 是否有任何类似 Wicket 的 Web 框架（除了 lift ）？

> ID：736432
> 
> 赞同：1
> 
> 时间：2009-04-10T01:13:38.067
> 
> 标签：scala, web-frameworks, tapestry

我想使用 Scala 语言开始一个项目。在搜索 Web 框架时，我发现了 Lift。然而，这并不是我想要的：一个完全分离 HTML 和代码的 Web 框架。Lift 确实有一些不错的功能（和学习曲线），但我们需要将 HTML 和代码完全分离。我希望为 Scala 语言找到类似 Wicket、Tapestry 或 Barracuda 的东西。

尽管能够重用 html 模板很好，但让 HTML 模板作为“静态应用程序”模型工作对我们来说更重要。在 Tapestry 中，我们可以将链接放在静态模板中，并使用它来进行静态导航和某种应用程序原型。

那么，您是否知道任何其他易于使用 Scala 语言的 Web 框架？

谢谢，路易斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T01:30:08.357

[在这里，](http://technically.us/code/x/the-escape-hatch "是的，它叫威克特！")我可以理解为什么你可能想要它纯 Scala，但你没有说这是必要的，并且使用博客文章中定义的技术，还有另一个博客也有帮助，你应该能够接近足够你想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-02T13:59:04.387

Tapestry 5 与 Wicket 有许多相似之处，并且与 Scala 配合得非常好。[我自己没有尝试过，但 Francois Armand 已经做了一段时间了，他在他的博客](http://fanf42.blogspot.com/search/label/tapestry%205)中写到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-04-09T16:05:55.443

尝试[上下文](http://www.contextfw.net)。它是一个用 Java 编写的基于组件的框架，但我已经将它与 Scala 一起使用，没有太多困难。

Context 使用 XSL 作为模板语言，它强制将逻辑表示（DOM-tree）和实际表示（HTML/CSS/JS）严格分开。

您甚至可以通过伪造 DOM 树并尝试不同组合的单个组件来轻松创建原型和模拟视图。

# release-cycle - CTP、Alpha、Beta、Gamma、RTM 和软件发布预览之间的区别？

> ID：736433
> 
> 赞同：31
> 
> 时间：2009-04-10T01:14:37.253
> 
> 标签：release-cycle

很直观，至少 Gamma 出现在 Beta 和 Alpha 之后。

但是 CTP、RTM 和预览版呢？哪一个是第一个和最后一个？

MEF（托管可扩展性框架）目前处于[预览版 5](http://mef.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25797)版本中，但我不确定它是 Alpha 之前的版本还是 Beta、CTP 或 RTM 之后的版本。可以在生产代码中使用预览版吗？

这些版本之间有什么区别？我对了解两者之间的差异特别感兴趣

*   RTM
*   CTP
*   贝塔
*   钢筋混凝土
*   预览

发布。

似乎每个版本在任何地方都意味着不同的东西。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-04-10T01:48:52.943

我最常看到这些术语以下列方式使用

*   CTP（社区技术预览）：很像“S​​how and Tell”。功能存在不同程度，客户可以了解发布的去向
*   Beta：功能大部分已实现，但仍有粗糙的边缘。在这一点上质量是公平的。贝塔数越高，质量越高
*   RC（Release Candidate）：产品认为它已准备好发货。客户提供反馈并发现主要阻塞问题的最后一次机会
*   RTM（发布到制造）：产品已完成并准备好运送给客户

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-10T01:20:37.957

这些阶段通常是 ​​Alpha、Beta（可分为内部与外部）、候选发布 (RC)、生产发布 (RTM)。在我看来，“社区技术预览”（CTP）或简单的“预览”只是 Beta 的委婉说法（这意味着“包含大量错误”）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-10T01:21:01.483

它可能因公司而异。它们通常是这样定义的：

*   CTP - 社区技术预览 - 不是 beta 质量，没有广泛传播。不一定功能齐全。通常适用于将在产品之上构建的合作伙伴。
*   预览 - 通常类似于 CTP。
*   Beta - 广泛发布。预计大部分稳定，功能完整。
*   RTM - 发布到制造。产品的最终发布，“Gold”发布。

至于在生产代码中使用预览，这又取决于，但通常是一个坏主意。它们通常没有得到很好的支持。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-10T01:16:53.583

答案是“视情况而定”。

所有这些徽章对不同的人意味着不同的东西，像“CTP”和“Preview”之类的东西更是如此。

在相关的地方（例如框架），大多数预览版/beta/ctp 版本都会附带有关它们是否应该在交付代码中使用的信息。一般来说，如果他们需要最终使用的可再发行产品，答案是否定的。

# vb6 - 如何在 VB6 中重新启用默认错误处理

> ID：736434
> 
> 赞同：8
> 
> 时间：2009-04-10T01:15:57.377
> 
> 标签：vb6, error-handling

我在一些地方有一些带有各种“On Error Goto”错误处理程序的代码来处理一些损坏的第三方硬件。我在没有错误陷阱但被有错误陷阱的例程调用的例程中遇到溢出错误（从 Err 变量中读取）。我一直认为错误陷阱仅在声明它们的例程中有效，但看起来子例程中的错误会导致它进入调用函数的错误陷阱。

所以我关闭了调用函数的错误陷阱，发现我的溢出，一切都很好。但在我这样做之前，我花了一些时间试图找到一种编程方式让 VB 在该例程中返回其默认错误处理（因此我不必修改外部代码来调试），但我做不到。我能找到的唯一错误命令：

```
  在错误转到 [标签]
  出错时继续下一步
  出错时转到 0
  错误转到 -1
```

全部打开手动错误处理-有没有办法关闭它（回到VB6默认值）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-15T17:11:13.467

这在[错误处理层次结构](http://msdn.microsoft.com/en-us/library/aa241677(VS.60).aspx)下的 VB6 手册中有详细解释。**在当前**`On Error Goto 0`过程中禁用错误​​处理程序，而不是在调用它的过程中。

 **> 如果过程中发生错误并且该过程没有启用的错误处理程序，Visual Basic 将向后搜索调用列表中的未决过程，并执行它找到的第一个启用的错误处理程序。如果它在调用列表中的任何地方都没有遇到启用的错误处理程序，它会显示默认的意外错误消息并停止执行。

正如其他人所说，您可以转到**Tools-Options-General**选项卡并选择**Break on all errors**。这有效地禁用了所有 On Error 语句 - IDE 将在每个错误时立即中断。

如果您的 VB6 代码作为正常操作的一部分抛出错误，那可能会很烦人。例如，当您检查文件是否存在时，或者当用户在普通对话中按下取消时。您不希望 IDE 每次都在这些行上中断。但是您可能在所有事件处理过程中都有样板错误处理程序，以阻止程序因意外错误而崩溃。但是当您调试问题时它们会很麻烦，因为 IDE 不会因错误而中断。一个技巧是在 IDE 中运行时关闭这些错误处理程序，但将它们保留在构建的可执行文件中。你这样做。

将这些函数放入一个模块中。

```
Public Function InIDE() As Boolean 
  Debug.Assert Not TestIDE(InIDE) 
End Function 

Private Function TestIDE(Test As Boolean) As Boolean 
  Test = True 
End Function 
```

然后你可以像这样编写你的错误处理程序。

```
Private Sub Form_Load() 
  If Not InIDE() Then On Error Goto PreventCrashes 
  <lots of code> 
  Exit Sub 

PreventCrashes: 
  <report the error> 
End Sub 
```

从[这里](http://objectmix.com/basic-visual/166962-how-tell-if-my-vb6-program-running-under-debugger.html)捏。另一个提示 - 使用免费插件[MZTools](http://www.mztools.com/v3/mztools3.aspx)自动添加这些样板错误处理程序。对于生产质量代码，您可以更进一步，在每个例程中放置一个错误处理程序，以创建一个[ghetto 堆栈跟踪](https://stackoverflow.com/questions/116289/what-is-the-better-way-to-handle-errors-in-vb6/116498#116498)。您还可以在每个错误处理程序中立即记录错误。

编辑：Ant 正确指出这`On Error Goto -1`是一个[VB.Net 语句](http://msdn.microsoft.com/en-us/library/5hsw66as(VS.80).aspx)，在 VB6 中无效。

编辑：Arvo 和 OneNerd 写了一些有趣的讨论来模拟 VB6 错误处理中的 finally teardown 块。[这个问题](https://stackoverflow.com/questions/116289/what-is-the-better-way-to-handle-errors-in-vb6)的讨论也值得一看。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-15T21:02:12.600

重置错误状态有一种简单明了的方法 - 使用关键字 Resume。有三种可能：

```
Resume
Resume Next
Resume <Label> 
```

Resume 在出错的行继续执行，在下一行继续执行 Resume Next，在标签处继续执行最少的 Resume Label。在 VB6 中创建类似 try-catch-finally 的构造非常有用。从 OneNerd 借用和修改的答案：

```
Function MyFunction() as String

'-- start of error block
'
 On Error Goto Catch
   ' do something here that might cause an error
   MyFunction = "IT WORKED"
   Goto Finally

   Catch:
   ' error occured - do something else
   MyFunction = Err.Description
   Err.Clear
   Resume Finally          ''added to clear error status

 Finally:
   On Error Resume Next    ''added to avoid repeated errors
   ' put your finally code here

 '
 '-- end of error block

End Function 
```

如果在 finally 块中发生一些后续错误，Simple Err.Clear 将无济于事；Resume finally 确实重置了内部错误状态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T08:31:44.910

有一个方便的右键单击菜单，可让您打开和关闭错误处理。只需右键单击代码窗口并选择 Toggle，然后您可以选择“Break on all errors”。这将具有禁用所有“On Error”语句的效果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T14:01:44.523

这是我所做的：

**如果需要，首先在您的Sub Main()**或**Sub Form_Load()** Sub中打开这样的错误处理：

```
'-- turn on error handling
'
On Error GoTo 0
'
'------------------------- 
```

现在将打开错误。

接下来，将**On Error Resume Next**和**On Error GoTo {label}**命令与**Err**对象结合使用。这是一个模拟 try/catch/finally 的示例：

```
Function MyFunction() as String

'-- start of error block
'
 On Error Goto Catch
   ' do something here that might cause an error
   MyFunction = "IT WORKED"
   Goto Finally

   Catch:
   ' error occured - do something else
   MyFunction = Err.Description
   Err.Clear

 Finally:
   ' put your finally code here

 '
 '-- end of error block

End Function 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T01:19:42.047

/工具/选项/常规/错误处理

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T01:57:11.817

```
on error goto 0 
```

应该是你想要的......它应该会导致抛出错误，进而可能会展开到 RTL......

已经很久了，但我很确定这就是你想要的。

```
on error resume next 
```

将继续下一个语句，所以你需要有很多

```
if err.Number <> 0 then 
```

代码中可能发生错误的语句...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-10T08:48:20.813

必须同意 LarryF，**On Error Goto 0**应该关闭已由**On Error Resume Next**打开的显式错误处理。不过，函数和子例程确实有自己的范围。来自[Microsoft 的 Scripto 博士](http://www.microsoft.com/technet/scriptcenter/resources/scriptshop/shop1205.mspx)：

> 就像我们经常做的那样，在脚本的开头加上 On Error Resume Next，使它适用于整个脚本。但是，正如我们将在后面的示例中看到的，它的范围不包括函数或子例程。如果要处理函数或子例程中的错误，还必须在检查 Err 对象之前在每个错误中包含 On Error Resume Next。
> 
> 您可以使用 On Error GoTo 0 关闭错误处理。因此，可以在要检查 Err 对象之前使用 On Error Resume Next 打开错误处理，然后使用 On Error GoTo 0 将其关闭。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-11T13:36:32.203

没有“On Error GoTo -1”，所以我不知道你从哪里得到的。

VB6 异常处理在手册中有非常详尽的介绍。

# javascript - 如何仅突出显示悬停时的文本，而不是空白？(javascript)

> ID：736435
> 
> 赞同：0
> 
> 时间：2009-04-10T01:15:58.063
> 
> 标签：javascript, jquery

我使用 jquery 在悬停时突出显示，但它突出显示整个 div 而不仅仅是文本。我尝试使用“a 标签”，但显然不想要参考链接。我确定这很简单，但我在反复试验上浪费了太多时间。蒂亚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T01:16:35.330

您应该使用内联标签，例如`<span>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T01:17:05.330

将文本包裹在一个`span`然后突出显示。

# c# - IronPython 和 C# - 对 C# 对象的脚本访问

> ID：736443
> 
> 赞同：4
> 
> 时间：2009-04-10T01:17:56.967
> 
> 标签：c#, ironpython

考虑下面的代码：

```
ScriptRuntimeSetup setup = Python.CreateRuntimeSetup(null);
ScriptRuntime runtime = new ScriptRuntime(setup);
ScriptEngine engine = Python.GetEngine(runtime);
ScriptScope scope = engine.CreateScope();

scope.SetVariable("message", "Hello, world!");
string script = @"print message";
ScriptSource source = scope.Engine.CreateScriptSourceFromString(script, SourceCodeKind.Statements);
source.Execute(); 
```

此代码产生以下异常：

> Microsoft.Scripting.Runtime.UnboundNameException 未处理 Message="name 'message' is not defined"

我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-10T01:59:20.937

它应该是“source.Execute(scope);” 而不是“source.Execute();”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-17T10:38:46.323

找到这个：[在 C# 应用程序中嵌入 IronPython 的 3 分钟指南](http://www.secretgeek.net/host_ironpython.asp)。

# php - PHP 箭头运算符结束标记

> ID：736450
> 
> 赞同：2
> 
> 时间：2009-04-10T01:21:07.940
> 
> 标签：php, apache

我正在我家设置的网络服务器上编写一个 php 应用程序。这是一台fedora10机器，运行php5和mysql。我有这样的代码：

```
<?php echo $var->function(); ?> 
```

但由于某种原因 -> 正在关闭 php 标签，所以输出有 'function(); ？添加到它...我需要在我的 php 或网络服务器配置中进行更改吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T01:26:22.453

我不认为您在 apache 配置文件中启用了 mod_php，否则您将永远不会在输出中看到 php 代码。 这是在 apache 中设置 php 5 的[一个很好的教程。](http://dan.drydog.com/apache2php.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T01:27:47.957

尝试

```
<?php echo("foo"); ?> 
```

如果这不起作用，您没有在 Apache 中启用 PHP。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T06:17:39.973

如果你确定启用了 php，试试这个

```
<?php
$result = $var -> function();
echo $result;
?> 
```

稍微调试一下..也许会引发一些有趣的事情

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T06:33:52.027

服务器上是否启用了php？确定它的简单测试：

`<?php` `phpinfo();?>`

将上面的行放在一个 .php 文件中并访问它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T06:43:04.967

你也可以试试这个：

```
<?php phpinfo(); 
```

不需要最后的结束 php 标记。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T18:37:26.170

前几天我遇到了类似的问题，但我使用的是 bar ?> 而不是 bar; ?>

事实证明，该`short_open_tag`选项在我的 PHP 配置中被禁用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-09-03T19:36:26.563

我在安装标准 XAMPP 时遇到了同样的问题。

```
short_open_tag=On 
```

解决了。

# delphi - 第一次机会异常：系统错误8：没有足够的存储空间来执行命令

> ID：736456
> 
> 赞同：0
> 
> 时间：2009-04-10T01:23:53.473
> 
> 标签：delphi, delphi-2009

我该如何调试这样的东西？我需要调试器停止并告诉我问题出在哪里。不要只在事件日志中显示它然后挂起。

**第一次机会异常：系统错误8：没有足够的存储空间来执行命令**

我正在使用delphi 2009。这个问题不会经常发生。我不急于用 OutputDebugString 调用来跟踪我的程序！

感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T01:50:32.347

您正在查看服务器上的资源泄漏，很有可能......处理相关或内存相关......

我经常发生这种情况，而且总是如此……可能还有其他原因，但我认为资源泄漏是您的第一大原因……

您将不得不找到并修复它，或者开始对所有内存分配进行调试检查，处理分配，并在您无法获得内存或句柄时记录它们。

您的 CLIENT 机器也可能资源不足，但通常是服务器有问题......

如果做不到这一切，请让我们更多地了解您在做什么、代码是什么样子等，以帮助发现问题。仅基于错误，并没有太多要继续的事情......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T22:19:33.313

如果您的程序使用大量 Windows 资源，则可能是资源堆短缺。

有一个注册表项可以增加以增加 XP 的堆大小。对于 Vista，Microsoft 已经将默认值设置得更高。我建议将默认的 3072 更改为至少 8192。

此信息记录在知识库文章 ID 126962 中（或搜索“内存不足”）。有关参数值的其他详细信息，请参见知识库文章 ID 184802。

我建议您阅读知识库文章，但有关更改的基本信息是：

1) 运行注册表编辑器 (REGEDT32.EXE)。

2) 从 HKEY_LOCAL_MACHINE 子树中，转到以下文件夹：

```
 \System\CurrentControlSet\Control\Session Manager\SubSystem 
```

3) 在屏幕右侧双击键：

```
 windows 
```

4) 在弹出窗口中，您将看到一个很长的字段被选中。将光标移动到字符串开头附近以查找此内容（值可能会有所不同）：

```
 SharedSection=1024,3072,512 
```

5) SharedSection 使用以下格式指定系统和桌面堆： SharedSection=xxxx,yyyy,zzz 其中 xxxx 定义系统范围堆的最大大小（以千字节为单位），yyyy 定义每个桌面堆的大小，zzz定义“非交互式”窗口站的桌面堆大小。

6) 仅将 yyyy 值更改为 8192（或更大），然后按 OK。

7) 退出注册表编辑器并重新启动 PC 以使更改生效。

祝你好运

# c# - C#：如何将 null 传递给期望 ref 的函数？

> ID：736474
> 
> 赞同：43
> 
> 时间：2009-04-10T01:48:34.833
> 
> 标签：c#, null, pinvoke, parameters, ref

我有以下功能：

```
public static extern uint FILES_GetMemoryMapping(
    [MarshalAs(UnmanagedType.LPStr)] string pPathFile,
    out ushort Size,
    [MarshalAs(UnmanagedType.LPStr)] string MapName,
    out ushort PacketSize,
    ref Mapping oMapping,
    out byte PagesPerSector); 
```

我想这样称呼：

```
FILES_GetMemoryMapping(MapFile, out size, MapName,
    out PacketSize, null, out PagePerSector); 
```

不幸的是，我无法传入`null`需要类型的字段，`ref Mapping`并且我尝试过没有强制转换来解决此问题。

有什么建议么？

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-04-10T01:52:07.633

无法传递`null`的原因`ref`是 C# 编译器对参数进行了特殊处理。任何`ref`参数都必须是可以传递给您正在调用的函数的引用。由于您要通过`null`编译器，因此拒绝允许这样做，因为您没有提供函数期望的引用。

您唯一真正的选择是创建一个局部变量，将其设置为`null`，然后将其传入。编译器将不允许您做更多的事情。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-04-10T01:51:20.300

我假设 Mapping 是一个结构？如果是这样，您可以拥有`FILES_GetMemoryMapping()`具有不同签名的两个版本的原型。对于要传递的第二个重载，`null`将参数设为 an`IntPtr`并使用`IntPtr.Zero`

```
public static extern uint FILES_GetMemoryMapping(
    [MarshalAs(UnmanagedType.LPStr)] string pPathFile,
    out ushort Size,
    [MarshalAs(UnmanagedType.LPStr)] string MapName,
    out ushort PacketSize,
    IntPtr oMapping,
    out byte PagesPerSector); 
```

调用示例：

```
FILES_GetMemoryMapping(MapFile, out size, MapName,
   out PacketSize, IntPtr.Zero, out PagePerSector); 
```

如果 Mapping 实际上是一个类而不是结构，只需在传递之前将值设置为 null。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-04-10T01:50:50.990

一种方法是创建一个虚拟变量，将其赋值为 null，然后将其传入。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-10T01:50:57.243

```
Mapping oMapping = null;

FILES_GetMemoryMapping(MapFile, out size, MapName, out PacketSize, ref oMapping, out PagePerSector); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-10-22T14:43:31.037

虽然@JaredPar 的[答案](https://stackoverflow.com/a/736481/83444)无疑是*正确*答案，但还有*另一个*答案：`unsafe`代码和指针：

```
unsafe {
    Mapping* nullMapping = null;
    FILES_GetMemoryMapping(
            MapFile,
            out size,
            MapName,
            out PacketSize,
            ref *nullMapping,    // wat?
            out PagePerSector);
} 
```

*看起来*它应该在运行时失败，但事实并非如此，因为`ref`和`*`相互抵消，结果值`ref *nullMapping`是空指针，这是`FILES_GetMemoryMapping()`该参数将接收的值。

*这可能不是一个好主意*，但有*可能*。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-06-07T18:01:16.377

现在可以使用 C# 语言 7.2 或更高版本允许 Null。只需像这样替换`ref`函数参数中的...

```
void MyFunc(ref Object obj) { ... } 
```

到...

```
void MyFunc(in Object obj) { ... } 
```

这将允许您`null`在应用程序中调用函数时作为参数值传入。它对对象和本机类型的工作方式相同，并且在语法上等同于`ref readonly`.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-06-22T04:30:27.053

也许它不完全是理想的答案，但如果您需要在调用函数时将 null 作为参数传递，请考虑对该函数进行重载，以省略您尝试设置为 null 的变量的形参。

例如，假设您有一个如下所示的函数：

```
public void MyFunction(string x, int y, ref string z) {...}; 
```

您希望能够为参数 z 传递 null。尝试创建一个`MyFunction`看起来像这样的新重载：

```
public void MyFunction(string x, int y) {...}; 
```

这种方法并不适合每个人的需求，但它是另一种可能的解决方案。

# c# - 以编程方式验证电子邮件是否到达交换邮箱

> ID：736485
> 
> 赞同：1
> 
> 时间：2009-04-10T01:54:56.237
> 
> 标签：c#, exchange-server-2007, system.net.mail

我有一份正在运行的工作，它向我们的用户发送电子邮件，从而启动我们公司的工作流程。定期地，用户会上下发誓他们没有收到电子邮件 - 但是，当我们去找邮件管理员提取交换报告时，十有八九是在他们已删除的项目中。:P

我希望能够以编程方式验证通过 .net C#（我认为是 System.Net.Mail）发送的消息是否到达了用户的邮箱。

这是 Exchange 2007，所有消息都是内部消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T02:03:17.823

您不能使用 System.Net.Mail。您必须深入了解 Exchange 的 API 以确定电子邮件是否存在于某人的电子邮件帐户中。

[http://support.microsoft.com/kb/813349](http://support.microsoft.com/kb/813349)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T02:27:38.857

设置一个帐户以捕获所有反弹。通过这种方式，您将知道哪些已到达，哪些未到达。这是确保电子邮件到达的最佳方式。

或者，您可以通过邮件标题添加已读回执（通过设置 Disposition-Notification-To）。但同样，用户可以选择不阅读它......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-25T11:28:38.507

我看到两种方法可以做你想做的事：

*   发送带有“交付确认”的电子邮件（不是“已读回执”，用户可以按照 CoddeToGlory 的说法将其关闭）。然后，只需监视通过任何适合您的方式接收这些确认的邮箱：Exchange Web Services、Outlook+COM 或 VBA、MAPI，...

*   使用 powershell 接口进行 Exchange 并捕获 Get-MessageTrackingLog 的输出以查找 StoreDriver + Deliver 事件。

# language-agnostic - 您如何计算具有重复的集合中所有可能的唯一子集的总数？

> ID：736494
> 
> 赞同：6
> 
> 时间：2009-04-10T02:01:17.377
> 
> 标签：language-agnostic, math, set, combinatorics, counting

给定一个包含重复元素的集合** S，如何确定 S 的所有可能子集的总数，其中每个子集都是唯一的。

例如，假设 S = {A, B, B} 并设 K 为所有子集的集合，则 K = {{}, {A}, {B}, {A, B}, {B, B}, {A, B, B}} 因此 |K| = 6。

另一个例子是如果 S = {A, A, B, B}，那么 K = {{}, {A}, {B}, {A, B}, {A, A}, {B, B}, {A, B, B}, {A, A, B}, {A, A, B, B}} 和因此 |K| = 9

很容易看出，如果 S 是一个只有唯一元素的实集，那么 |K| = 2^|S|。

计算这个值的公式是什么|K| 给定一个“集合”S（有重复项），而不生成所有子集？

** 从技术上讲不是一套。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-10T02:39:08.533

取所有（频率 + 1）的乘积。

例如，在 {A,B,B} 中，答案是 (1+1) [As 的数量] * (2+1) [Bs 的数量] = 6。

在第二个示例中，count(A) = 2 和 count(B) = 2。因此答案是 (2+1) * (2+1) = 9。

这样做的原因是您可以将任何子集定义为计数向量 - 对于 {A,B,B}，子集可以描述为 {A=0,B=0}, {A=0,B=1 }、{0,2}、{1,0}、{1,1}、{1,2}。

对于 counts[] 中的每个数字，都有（该对象的频率 + 1）可能的值。（0..频率）

因此，可能性的总数是所有（频率+1）的乘积。

“所有唯一”的情况也可以这样解释——每个对象出现一次，所以答案是 (1+1)^|S| = 2^|S|。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T12:18:28.280

我会争辩说，如果以正确的方式来看，这个问题很容易解决。你不关心元素的顺序，只关心它们是否出现在一个子集中。

计算每个元素在集合中出现的次数。对于一个元素集{A}，有多少个子集？显然只有两套。现在假设我们添加了另一个不同于 A 的元素 B，以形成集合 {A,B}。我们可以很容易地形成所有集合的列表。取出我们仅使用 A 形成的所有集合，并添加零个或一个 B 副本。实际上，我们将集合的数量加倍。显然，我们可以使用归纳法来证明对于 N 个不同的元素，集合的总数仅为 2^N。

假设某些元素出现多次？考虑具有三个 A 副本的集合。因此 {A,A,A}。你能形成多少个子集？同样，这很简单。我们可以有 A 的 0、1、2 或 3 个副本，因此子集的总数为 4，因为顺序无关紧要。

一般来说，对于元素 A 的 N 个副本，我们最终会得到 N+1 个可能的子集。现在，通过添加一些数量 M 的 B 副本来扩展它。所以我们有 A 的 N 个副本和 B 的 M 个副本。总共有多少个子集？是的，这似乎也很清楚。对于其中只有 A 的每个可能子集（其中有 N+1 个），我们可以添加 B 的 0 到 M 个副本。

因此，当我们有 N 个 A 副本和 M 个 B 副本时，子集的总数很简单。它必须是 (N+1)*(M+1)。同样，我们可以使用归纳论证来证明子集的总数是这些项的乘积。只需计算每个不同元素的重复总数，加 1，然后取乘积。

看看集合 {A,B,B} 会发生什么。我们得到 2*3 = 6。

对于集合 {A,A,B,B}，我们得到 3*3 = 9。

# haskell - Haskell 脚本空间不足

> ID：736495
> 
> 赞同：2
> 
> 时间：2009-04-10T02:01:31.963
> 
> 标签：haskell, space, lazy-evaluation

我正在使用 Euler 项目自学 Haskell，但我在推理我的代码是如何被 Haskell 执行时遇到了一些麻烦。第二个问题让我计算所有偶数斐波那契数的总和，最高可达 400 万。我的脚本如下所示：

```
fibs :: [Integer]
fibs =  1 : 2 : [ a+b | (a,b) <- zip fibs (tail fibs)]

evens  :: Integer -> Integer -> Integer
evens x sum | (even x)   = x + sum
            | otherwise  = sum

main = do
  print (foldr evens 0 (take 4000000 fibs)) 
```

Hugs 给出错误“垃圾收集无法回收足够的空间”，我认为这意味着列表条目没有被释放，因为它们被`foldr`.

我需要做什么来解决这个问题？我尝试编写一个使用累加器的尾递归（我认为）版本，但也无法让它工作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-10T03:44:59.840

首先，你不应该使用拥抱。它只是一个用于教学目的的玩具。

然而，GHC 是一个快速、多核就绪的 Haskell 优化编译器。[在这里得到它](http://haskell.org/ghc)。特别是，它进行严格性分析，并编译为本机代码。

您的代码突出的主要内容是在非常大的列表中使用了 foldr。可能你想要一个尾递归循环。像这样：

```
import Data.List

fibs = 0 : 1 : zipWith (+) fibs (tail fibs)

evens x sum | even x    = x + sum
            | otherwise = sum

-- sum of even fibs in first 4M fibs
main = print (foldl' evens 0 (take 4000000 fibs)) 
```

除此之外，前 4M 甚至 fibs 将使用相当多的空间，因此需要一段时间。

这是[前 400k even fibs 的总和](http://galois.com/~dons/tmp/fibs-400k.txt)，为您节省一些时间（21s）。:-)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-10T02:17:22.547

一些观察/提示：

*   来自 even的`x + sum`s 直到最后才被评估
*   你拿的是前 4,000,000 个小谎言，而不是 4,000,000 个之前的小故事
*   有一种更简单的方法可以做到这一点

**编辑以回应评论**

我不会告诉你更简单的方法是什么，因为这是欧拉计划问题的乐趣所在。但我会问你一堆问题：

*   你可以连续吃多少个小谎言？
*   没有一个均匀的谎言你能坚持多久？
*   如果你把所有的偶数和奇数都加起来（用手做），你注意到这些总和是什么？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-10T04:11:18.857

你理解错了问题。[实际问题](http://projecteuler.net/index.php?section=problems&id=2)是要将所有偶数斐波那契数相加，以使斐波那契数本身不超过 400 万（恰好是前 33 个斐波那契数）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-10T02:14:42.273

您正在评估`fibs`. 这些数字呈指数增长。我不知道代表第 100 万个斐波那契数需要多少字节；只有千分之一的斐波那契数有 211 个十进制数字，所以这将需要 22 个 32 位字来保存数字，不要介意任何开销`gmp`。这些呈指数增长。

练习：计算保存四百万斐波那契数所需的内存量。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-11T05:19:33.117

查看 Prelude 函数 takeWhile、filter、even 和 sum

takeWhile (<40) [0..]
甚至过滤 $takeWhile (<40) [0..]

把它们放在一起：

ans = sum $ filter even $ takeWhile (< 4* 10^6) fibs

# c# - 如何在不创建外部对象的情况下加载 xaml 文件？

> ID：736498
> 
> 赞同：2
> 
> 时间：2009-04-10T02:04:49.550
> 
> 标签：c#, wpf

是否可以从*磁盘*（即不是从应用程序资源）加载 xaml 文件并创建对象树而不创建外部对象？换句话说，我想创建一个派生自 Window 并从磁盘加载 xaml 文件的类。看来我可以创建一个不从 Window 派生并且可以从磁盘加载的类，或者我可以创建一个从 Window 派生但从应用程序资源加载 xaml 的类。

例如，我可以这样做：

```
XmlTextReader xmlReader = new XmlTextReader("c:\\mywindow.xaml");
object obj = XamlReader.Load(xmlReader);
Window win = obj as Window; 
```

但我真正想做的是：

```
class MyWindow : Window
{
    public MyWindow()
    {
        System.Uri resourceLocater = new System.Uri("file://c:/mywindow.xaml", UriKind.Absolute);
        System.Windows.Application.LoadComponent(this, resourceLocater);
    }
}
...
MyWindow w = new MyWindow(); 
```

目前，第二段代码给出了一个例外，即 uri 不能是绝对的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-09T13:55:54.720

您可以将 XAML 文件的内容加载到字符串中，然后解析内容，如下所示：

```
 try
        {
            string strXaml = String.Empty;
            using (var reader = new System.IO.StreamReader(filePath, true))
            {
                strXaml = reader.ReadToEnd();
            }

            object xamlContent = System.Windows.Markup.XamlReader.Parse(strXaml);
        }
        catch (System.Windows.Markup.XamlParseException ex)
        {
            // You can get specific error information like LineNumber from the exception
        }
        catch (Exception ex)
        {
            // Some other error
        } 
```

然后您应该能够将 xamlContent 设置为 Window 的 Content 属性。

```
Window w = new Window();
w.content = xamlContent;
w.ShowDialog(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T07:07:09.793

我不确定您是否可以使用绝对路径加载程序集，指向文件系统上某处的文件。

几天前我遇到了类似的问题，也许我的帖子可以提供帮助（查看我的答案的编辑）：

**从程序集编辑**[中加载 ResourceDictionary](https://stackoverflow.com/questions/709087/load-a-resourcedictionary-from-an-assembly)：我刚刚看到您要加载 xaml，而不是程序集？然后检查 System.Windows.Markup.XamlReader，也许这就是你要找的。

# php - 奇怪的 http gzip 问题

> ID：736499
> 
> 赞同：2
> 
> 时间：2009-04-10T02:07:50.247
> 
> 标签：php, apache, firefox, gzip, nginx

这里有一个奇怪的：

我已经使用 mod_php 向 apache 2 发送了 nginx 反向代理请求。

一位用户（使用 firefox 3.1b3）报告说，最近他开始偶尔[出现“firefox 应该如何处理这个文件？”](http://icechewing.huddler.com/imgrepo/f/f1/Image1.jpg) 正常导航期间的[弹出窗口。](http://icechewing.huddler.com/imgrepo/f/f1/Image1.jpg)我们还没有关于这个问题的任何其他报告，也无法自己重现它。

我检查了 Nginx 和 apache 的日志。错误日志中没有任何内容，它们都显示请求的正常 HTTP 200。

我让他把下载的文件发给我，它生成了 HTML，它应该是——除了它有一些尾随和前导字节。

开头的字节序列是神奇的 gzip 头：1F8B08

以下是开头字符，为方便起见，使用 C 转义：

```
\x1F\x8B\x089608\r\n<!DOCTYPE HTML ... 
```

文件以：

```
...</html>\n\r\n0\r\n\r\n 
```

当我通过 wget 获取相同的 URL 时，它按预期开始；神秘的开始和结束字节无处可寻。

有没有人见过类似的东西？这可能是 FF 3.1b3 的错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T15:08:56.500

从来没有见过这样的问题，但是我确实遇到过一个透明代理的问题，该代理会声称它可以处理 gzip 压缩内容，而实际上它从服务器接收到 gzip 压缩的内容，剥离 gzip头文件，无需解压，并将结果发送到浏览器。我们看到的行为就是您所描述的：本应是普通网页的保存/打开文件对话框。在这种情况下，有问题的浏览器是 IE。

我不确定你的问题是否相关，但作为一个实验，你可以查看代理和 Apache 之间的请求，看看它们是否被 gzip 压缩，或者关闭 Apache 中请求的 gzip 压缩，看看是否解决了这个问题。如果是这样，那么您的代理中的 gzip 处理可能存在问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-04T11:50:04.747

wget 不请求压缩响应。尝试：

```
curl --compressed <URL> 
```

您还可以尝试添加 a`-v`以打印响应标头，并检查`Content-Type`是否返回了 sensible。

# c# - C# GUI 前端

> ID：736508
> 
> 赞同：4
> 
> 时间：2009-04-10T02:15:33.677
> 
> 标签：c#, c

可以在 C# 中制作 GUI，但在 C 或 C++ 中制作实际程序。

比如说我想做一个聊天应用程序。我希望界面在 C# 中。但我想用 C 编写所有实际代码。这可能吗？

我找到了[http://www.google.com/search?hl=en&q=P%2FInvoke&btnG=Google+Search&aq=f&oq=](http://www.google.com/search?hl=en&q=P%2FInvoke&btnG=Google+Search&aq=f&oq=)

有没有人有更好的信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T02:20:01.217

绝对！c# winform 可以调用托管的或未执行的 C 或 C++ dll。有关详细信息，请参阅 P/Invoke。

编辑：原来在首页上的[P/Invoke](https://stackoverflow.com/questions/736227/p-invoke-tutorials)上有一个很好的线程。:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T03:09:16.590

你已经在这里得到了一些肯定的答案。

一个建议：过早的优化是万恶之源（或类似的东西）。

除非您正在创建一个科学项目（做某事只是为了看看它是否可以完成），否则只需用 C# 编写整个事情。完成后，如果您发现项目的某些部分表现不佳，请重写这些部分。

基本上，应用程序中速度较慢的部分很少会出现在您想要的位置。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T02:24:02.937

增加 JP 完全正确的先前答案，您还可以通过 COM 接口公开您的 C++ 代码，然后通过 COM/Interop 在 C# 中使用它们。不过，祝你好运。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-10T02:33:47.767

这不仅是可能的，而且很可能是你**应该**做的。没有理由为 .NET 重写所有现有代码。

简而言之，有三种方法可以使用来自 C# 的现有 (C/C++) 代码：为了轻松访问一些简单的 API，P/Invoke 运行良好。C++/CLI 将为您提供最大的灵活性。您的第三个选择是使用 COM。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T02:24:14.077

您可以在 C 中执行的所有操作都可以在托管代码中完成。为什么要在 C# 中构建一个组件，而在 C 中构建另一个组件？你担心插座吗？

但是对于你的问题，你绝对可以像上面提到的JP那样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T03:08:17.277

根据您希望如何分发应用程序，您应该考虑部署要求。如果您有 C++ 模块，除了 .Net 框架之外，您还将依赖 C++ 运行时库。如果您只是 P/Invoking Win32 API，这不是问题。这对你来说可能或可能不重要，但对我来说很重要——我摆脱了我的应用程序中的 C++ 层，并直接调用 Win32。

# wpf - WPF：工具栏中的嵌套菜单项

> ID：736511
> 
> 赞同：9
> 
> 时间：2009-04-10T02:17:09.023
> 
> 标签：wpf, toolbar, menuitem

我正在为 wpf 应用程序开发一些 XAML，但在让它做我想做的事情时遇到了一些麻烦。这是我的 XAML 示例：

```
<!-- Tool Bar Tray -->
<ToolBarTray Name="toolBarTray1" DockPanel.Dock="Top">
    <!-- File And Edit Tools -->
    <ToolBar Name="toolBar1" Band="1" BandIndex="1">
        <!-- Regular Items -->
        <Button>A</Button>
        <Button>B</Button>
        <!-- Overflow Menu For Special Items -->
        <MenuItem ToolBar.OverflowMode="Always" Header="Special Items">
            <MenuItem Header="C"/>
            <MenuItem Header="D"/>
        </MenuItem>
    </ToolBar>
</ToolBarTray> 
```

当我单击工具栏的溢出按钮时，“特殊项目”MenuItem 旁边会出现一个小箭头，表示嵌套元素。但是，当我将鼠标悬停在“特殊项目”上或尝试单击它时，没有显示菜单项“C”和“D”。

我希望 MenuItem 只能在菜单之外工作，但我试图做直截了当的事情，以防万一。将这些 MenuItems 包含在一个 Menu 中，相反，为此 Menu 提供 ToolBar.OverflowMode="Always" 属性会产生一些不需要的样式。箭头不再出现，需要点击“特殊物品”条目才能激活子菜单，子菜单定位看起来有点不对劲。

有谁知道发生了什么？

编辑：在溢出中添加一个菜单正是我所要求的（大惊喜）。我所追求的是一种将顶级标题和项目转换为子菜单级别的方法。我已经转向[MSDN](http://msdn.microsoft.com/en-us/library/ms747082(VS.85).aspx)上的这个控制模板示例寻求解决方案（如下）。

编辑，编辑：@gcores（评论讨论）：真的吗？我错过了什么吗？

```
<ToolBar Name="toolBar1" Band="1" BandIndex="4"> 
    <!-- Displayed Buttons -->
    <Button>A</Button>
    <Button>B</Button>
    <!-- Special Items Menu -->
    <Menu ToolBar.OverflowMode="Always" >
        <MenuItem Style="{StaticResource MenuItemStyle}" Header="Special">
            <MenuItem Header="C"/>
            <MenuItem Header="D"/>
        </MenuItem>
    </Menu>
</ToolBar> 
```

这个片段对我不起作用。我必须单击“特殊”才能显示子菜单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-15T22:39:15.533

另一种解决方案是使用现有模板并用 SubmenuHeader 的模板覆盖 TopLevelHeader 的模板。

```
<Style x:Key="MenuItemStyle" TargetType="{x:Type MenuItem}">
  <Style.Triggers>
    <Trigger Property="Role" Value="TopLevelHeader">
      <Setter Property="Template"
              Value="{StaticResource {x:Static MenuItem.SubmenuHeaderTemplateKey}}"/>
    </Trigger>
  </Style.Triggers> 
</Style> 
```

并在您的顶级 MenuItem 中使用此样式。那应该简化您的代码。

**编辑**：你是对的，它只有在你点击它时才有效（不知道我是如何说服自己它有效的，抱歉:)）。它的功能就像一个 TopLevelMenu，即使模板另有说明，它也很混乱。

我能想到的唯一一件事是添加一个触发器来在 IsMenuOver 上显示子菜单并处理 Click 事件，所以它什么都不做，但我不知道它的效果如何。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-12T04:15:32.967

经过更多阅读，我正在使用的解决方案如下。

```
<!-- Resource Dictionary Stuff -->

<!-- Some Brushes -->
<SolidColorBrush x:Key="Brush_1"
    Color="White" />

<LinearGradientBrush x:Key="Brush_2"
    StartPoint="0 0"
    EndPoint="0 1">

    <GradientStop
        Color="White"
        Offset="0"/>

    <GradientStop 
        Color="DarkSeaGreen"
        Offset="1"/>

</LinearGradientBrush>

<SolidColorBrush x:Key="Brush_3"
    Color="DarkOliveGreen"/>

<!-- Custom MenuItem - Top Level Header - Style 1 -->
<Style x:Key="MenuItem_TLH_Style1"
    TargetType="MenuItem">

    <!--<EventSetter Event="PreviewMouseDown" Handler="DoNothing"/>-->

    <Setter Property="Template">
        <Setter.Value>

            <ControlTemplate x:Name="ControlTemplate"
                TargetType="MenuItem">

                <!-- A headered text that may display a submenu
                     on a trigger. This submenu is the host for a
                     menu item's items. -->
                <Border x:Name="BoundaryBorder"
                    Background="{StaticResource Brush_1}"
                    BorderThickness="1">

                    <Grid x:Name="ContainerGrid">

                        <ContentPresenter x:Name="HeaderContent"
                            Margin="6 3 6 3" 
                            ContentSource="Header"
                            RecognizesAccessKey="True"/>

                        <Popup x:Name="SubmenuPopup"
                            Placement="Bottom"
                            IsOpen="{TemplateBinding IsSubmenuOpen}"
                            AllowsTransparency="True"
                            Focusable="False"
                            PopupAnimation="Fade">

                            <Border x:Name="SubmenuBoundaryBorder"
                                SnapsToDevicePixels="True"
                                Background="{StaticResource Brush_1}"
                                BorderBrush="{StaticResource SolidBorderBrush}"
                                BorderThickness="1">

                                <StackPanel x:Name="ItemsStackPanel"
                                    IsItemsHost="True"
                                    KeyboardNavigation.DirectionalNavigation="Cycle"/>

                            </Border>
                        </Popup>
                    </Grid>
                </Border>

                <ControlTemplate.Triggers>

                    <!--  -->
                    <Trigger
                        Property="IsSuspendingPopupAnimation"
                        Value="true">

                        <Setter 
                            TargetName="SubmenuPopup"
                            Property="PopupAnimation"
                            Value="Fade"/>

                    </Trigger>

                    <!-- On mouse-over, show the submenu and highlight the header. -->
                    <Trigger 
                        Property="IsMouseOver"
                        Value="true">

                        <Setter 
                            TargetName="BoundaryBorder"
                            Property="Background"
                            Value="{StaticResource Brush_2}"/>

                        <Setter 
                            TargetName="BoundaryBorder"
                            Property="BorderBrush"
                            Value="{StaticResource Brush_3}"/>

                        <Setter
                            Property="IsSubmenuOpen"
                            Value="true"/>

                        <!-- sloppy? -->
                        <Setter
                            TargetName="SubmenuPopup"
                            Property="IsOpen"
                            Value="true"/>

                    </Trigger>

                    <Trigger 
                        SourceName="SubmenuPopup"
                        Property="AllowsTransparency"
                        Value="true">

                        <Setter 
                            TargetName="SubmenuBoundaryBorder"
                            Property="CornerRadius"
                            Value="0 0 4 4"/>

                        <Setter 
                            TargetName="SubmenuBoundaryBorder"
                            Property="Padding"
                            Value="0 0 0 3"/>

                    </Trigger>

                    <!-- Visually indicate an unaccessible menu item. -->
                    <Trigger
                        Property="IsEnabled"
                        Value="false">

                        <Setter 
                            Property="Foreground"
                            Value="{StaticResource DisabledForegroundBrush}"/>

                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>

<!-- ... -->

<!-- Inside a window XAML file -->

<!-- Tool Bar Tray -->
<ToolBarTray x:Name="toolBarTray1"
    DockPanel.Dock="Top">

    <!-- File And Edit Tools -->
    <ToolBar x:Name="toolBar1" 
        Band="1" BandIndex="1">

        <!-- Displayed Buttons -->
        <Button x:Name="ButtonA"
            Content="A"/>

        <Button x:Name="ButtonB"
            Content="B"/>

        <!-- Overflow Menu For Special Items -->
        <Menu x:Name="OverflowMenu"
            ToolBar.OverflowMode="Always">

            <MenuItem x:Name="SpecialsMenuItem" 
                Style="{StaticResource MyStyle}"
                Header="Special Items">

                <MenuItem x:Name="CMenuItem"
                    Header="C">

                    <MenuItem x:Name="DMenuItem"
                        Header="D"/>

                </MenuItem>
            </MenuItem>
        </Menu>
    </ToolBar>
</ToolBarTray> 
```

我在鼠标悬停时攻击“SubmenuPopup”的行为，而不是处理点击事件。我想更全面地理解这一点，所以我尝试注释掉触发器的这一部分并添加一个事件处理程序，该处理程序在“PreviewMouseDown”事件上调用“DoNothing()”方法。事实证明，我遗漏了一些东西，我认为这与聚焦和/或菜单如何处理其项目集合有关。在“DoNothing()”(routedEventArgs.Handled = true) 之后不允许事件传播似乎可以消除单击“特殊项目”菜单项时的问题。但是，如果导航离开菜单或添加另一个菜单项然后单击该菜单项，则可以关闭或打开和关闭悬停行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-12T01:48:21.087

我能找到甚至接近产生这种行为的唯一方法是在溢出中创建一个菜单，其中包含一个菜单项，其标题本身就是另一个名为“特殊项目”的菜单项并包含适当的子项。它按预期工作，但看起来很奇怪（这可以通过自定义模板来解决），而且看起来像是一个巨大的 hack。我能想到的唯一“正确”的方法是制作你自己的类似 MenuItem 的控件，当鼠标悬停在上面时会弹出一个 ContextMenu 或 Popup，因为我认为自定义 ControlTemplate 不能改变默认行为一个菜单，以便不需要单击顶级项目。

# javascript - 如何将 URL 解析为 javascript 中的主机名和路径？

> ID：736513
> 
> 赞同：449
> 
> 时间：2009-04-10T02:17:42.843
> 
> 标签：javascript, url

我想拿一根绳子

```
var a = "http://example.com/aa/bb/" 
```

并将其处理成一个对象，使得

```
a.hostname == "example.com" 
```

和

```
a.pathname == "/aa/bb" 
```

* * *

## 回答 #1

> 赞同：509
> 
> 时间：2014-06-03T02:18:08.727

现代方式：

```
new URL("http://example.com/aa/bb/") 
```

返回一个具有属性`hostname`和的对象`pathname`，以及[其他一些](https://developer.mozilla.org/en-US/docs/Web/API/URL#Properties)对象。

第一个参数是相对或绝对 URL；如果它是相对的，那么您需要指定第二个参数（基本 URL）。例如，对于相对于当前页面的 URL：

```
new URL("/aa/bb/", location) 
```

除了浏览器，[这个 API 也可以在 Node.js 中使用，](https://nodejs.org/api/url.html#url_the_whatwg_url_api)从 v7 到`require('url').URL`.

* * *

## 回答 #2

> 赞同：378
> 
> 时间：2009-04-10T07:33:31.663

```
var getLocation = function(href) {
    var l = document.createElement("a");
    l.href = href;
    return l;
};
var l = getLocation("http://example.com/path");
console.debug(l.hostname)
>> "example.com"
console.debug(l.pathname)
>> "/path" 
```

* * *

## 回答 #3

> 赞同：317
> 
> 时间：2013-04-12T19:27:56.033

在这里找到：[https ://gist.github.com/jlong​​/2428561](https://gist.github.com/jlong/2428561)

```
var parser = document.createElement('a');
parser.href = "http://example.com:3000/pathname/?search=test#hash";

parser.protocol; // => "http:"
parser.host;     // => "example.com:3000"
parser.hostname; // => "example.com"
parser.port;     // => "3000"
parser.pathname; // => "/pathname/"
parser.hash;     // => "#hash"
parser.search;   // => "?search=test"
parser.origin;   // => "http://example.com:3000" 
```

* * *

## 回答 #4

> 赞同：127
> 
> 时间：2014-02-04T13:34:04.080

`a`这是一个使用正则表达式来模仿标签行为的简单函数。

优点

*   可预测的行为（没有跨浏览器问题）
*   不需要 DOM
*   真的很短。

缺点

*   正则表达式有点难读

-

```
function getLocation(href) {
    var match = href.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);
    return match && {
        href: href,
        protocol: match[1],
        host: match[2],
        hostname: match[3],
        port: match[4],
        pathname: match[5],
        search: match[6],
        hash: match[7]
    }
} 
```

-

```
getLocation("http://example.com/");
/*
{
    "protocol": "http:",
    "host": "example.com",
    "hostname": "example.com",
    "port": undefined,
    "pathname": "/"
    "search": "",
    "hash": "",
}
*/

getLocation("http://example.com:3000/pathname/?search=test#hash");
/*
{
    "protocol": "http:",
    "host": "example.com:3000",
    "hostname": "example.com",
    "port": "3000",
    "pathname": "/pathname/",
    "search": "?search=test",
    "hash": "#hash"
}
*/ 
```

编辑：

这是正则表达式的细分

```
var reURLInformation = new RegExp([
    '^(https?:)//', // protocol
    '(([^:/?#]*)(?::([0-9]+))?)', // host (hostname and port)
    '(/{0,1}[^?#]*)', // pathname
    '(\\?[^#]*|)', // search
    '(#.*|)$' // hash
].join(''));
var match = href.match(reURLInformation); 
```

* * *

## 回答 #5

> 赞同：92
> 
> 时间：2015-07-14T19:02:46.510

```
var loc = window.location;  // => "http://example.com:3000/pathname/?search=test#hash" 
```

返回当前网址。

如果您想将自己的字符串作为 url 传递（[在 IE11 中不起作用](https://developer.mozilla.org/en-US/docs/Web/API/URL)）：

```
var loc = new URL("http://example.com:3000/pathname/?search=test#hash") 
```

然后你可以像这样解析它：

```
loc.protocol; // => "http:"
loc.host;     // => "example.com:3000"
loc.hostname; // => "example.com"
loc.port;     // => "3000"
loc.pathname; // => "/pathname/"
loc.hash;     // => "#hash"
loc.search;   // => "?search=test" 
```

* * *

## 回答 #6

> 赞同：66
> 
> 时间：2012-11-15T20:48:21.493

freddiefujiwara 的回答非常好，但我还需要在 Internet Explorer 中支持相对 URL。我想出了以下解决方案：

```
function getLocation(href) {
    var location = document.createElement("a");
    location.href = href;
    // IE doesn't populate all link properties when setting .href with a relative URL,
    // however .href will return an absolute URL which then can be used on itself
    // to populate these additional fields.
    if (location.host == "") {
      location.href = location.href;
    }
    return location;
}; 
```

现在使用它来获取所需的属性：

```
var a = getLocation('http://example.com/aa/bb/');
document.write(a.hostname);
document.write(a.pathname); 
```

例子：

```
function getLocation(href) {
  var location = document.createElement("a");
  location.href = href;
  // IE doesn't populate all link properties when setting .href with a relative URL,
  // however .href will return an absolute URL which then can be used on itself
  // to populate these additional fields.
  if (location.host == "") {
    location.href = location.href;
  }
  return location;
};
var urlToParse = 'http://example.com/aa/bb/',
  a = getLocation(urlToParse);
document.write('Absolute URL: ' + urlToParse);
document.write('<br />');
document.write('Hostname: ' + a.hostname);
document.write('<br />');
document.write('Pathname: ' + a.pathname);
```

* * *

## 回答 #7

> 赞同：18
> 
> 时间：2009-04-10T02:21:16.627

**[js-uri](http://code.google.com/p/js-uri/)**（可在 Google Code 上获得）接受一个字符串 URL 并从中解析一个 URI 对象：

```
var some_uri = new URI("http://www.example.com/foo/bar");

alert(some_uri.authority); // www.example.com
alert(some_uri);           // http://www.example.com/foo/bar

var blah      = new URI("blah");
var blah_full = blah.resolve(some_uri);
alert(blah_full);         // http://www.example.com/foo/blah 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2015-10-08T14:19:46.543

简单的正则表达式呢？

```
url = "http://www.example.com/path/to/somwhere";
urlParts = /^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(url);
hostname = urlParts[1]; // www.example.com
path = urlParts[2]; // /path/to/somwhere 
```

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2016-06-08T14:35:23.590

今天我遇到了这个问题，我发现：[URL - MDN Web APIs](https://developer.mozilla.org/en-US/docs/Web/API/URL)

```
var url = new URL("http://test.example.com/dir/subdir/file.html#hash"); 
```

这个回报：

```
{ hash:"#hash", host:"test.example.com", hostname:"test.example.com", href:"http://test.example.com/dir/subdir/file.html#hash", origin:"http://test.example.com", password:"", pathname:"/dir/subdir/file.html", port:"", protocol:"http:", search: "", username: "" } 
```

希望我的第一个贡献对您有所帮助！

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2012-03-19T20:16:52.080

这是我从[https://gist.github.com/1847816](https://gist.github.com/1847816)复制的版本，但已重写，因此更易于阅读和调试。将锚数据复制到另一个名为“结果”的变量的目的是因为锚数据很长，因此将有限数量的值复制到结果将有助于简化结果。

```
/**
 * See: https://gist.github.com/1847816
 * Parse a URI, returning an object similar to Location
 * Usage: var uri = parseUri("hello?search#hash")
 */
function parseUri(url) {

  var result = {};

  var anchor = document.createElement('a');
  anchor.href = url;

  var keys = 'protocol hostname host pathname port search hash href'.split(' ');
  for (var keyIndex in keys) {
    var currentKey = keys[keyIndex]; 
    result[currentKey] = anchor[currentKey];
  }

  result.toString = function() { return anchor.href; };
  result.requestUri = result.pathname + result.search;  
  return result;

} 
```

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2016-07-24T22:10:31.777

[跨浏览器 URL 解析](https://gist.github.com/acdcjunior/9820040)，解决IE 6、7、8 和 9的**相对路径问题：**

```
function ParsedUrl(url) {
    var parser = document.createElement("a");
    parser.href = url;

    // IE 8 and 9 dont load the attributes "protocol" and "host" in case the source URL
    // is just a pathname, that is, "/example" and not "http://domain.com/example".
    parser.href = parser.href;

    // IE 7 and 6 wont load "protocol" and "host" even with the above workaround,
    // so we take the protocol/host from window.location and place them manually
    if (parser.host === "") {
        var newProtocolAndHost = window.location.protocol + "//" + window.location.host;
        if (url.charAt(1) === "/") {
            parser.href = newProtocolAndHost + url;
        } else {
            // the regex gets everything up to the last "/"
            // /path/takesEverythingUpToAndIncludingTheLastForwardSlash/thisIsIgnored
            // "/" is inserted before because IE takes it of from pathname
            var currentFolder = ("/"+parser.pathname).match(/.*\//)[0];
            parser.href = newProtocolAndHost + currentFolder + url;
        }
    }

    // copies all the properties to this object
    var properties = ['host', 'hostname', 'hash', 'href', 'port', 'protocol', 'search'];
    for (var i = 0, n = properties.length; i < n; i++) {
      this[properties[i]] = parser[properties[i]];
    }

    // pathname is special because IE takes the "/" of the starting of pathname
    this.pathname = (parser.pathname.charAt(0) !== "/" ? "/" : "") + parser.pathname;
} 
```

用法（[此处为演示 JSFiddle](https://jsfiddle.net/acdcjunior/tjL5ta7h/)）：

```
var myUrl = new ParsedUrl("http://www.example.com:8080/path?query=123#fragment"); 
```

结果：

```
{
    hash: "#fragment"
    host: "www.example.com:8080"
    hostname: "www.example.com"
    href: "http://www.example.com:8080/path?query=123#fragment"
    pathname: "/path"
    port: "8080"
    protocol: "http:"
    search: "?query=123"
} 
```

* * *

## 回答 #12

> 赞同：7
> 
> 时间：2016-09-03T14:30:10.243

```
function parseUrl(url) {
    var m = url.match(/^((?:([^:\/?#]+:)(?:\/\/))?((?:([^\/?#:]*):([^\/?#:]*)@)?([^\/?#:]*)(?::([^\/?#:]*))?))?([^?#]*)(\?[^#]*)?(#.*)?$/),
        r = {
            hash: m[10] || "",                   // #asd
            host: m[3] || "",                    // localhost:257
            hostname: m[6] || "",                // localhost
            href: m[0] || "",                    // http://username:password@localhost:257/deploy/?asd=asd#asd
            origin: m[1] || "",                  // http://username:password@localhost:257
            pathname: m[8] || (m[1] ? "/" : ""), // /deploy/
            port: m[7] || "",                    // 257
            protocol: m[2] || "",                // http:
            search: m[9] || "",                  // ?asd=asd
            username: m[4] || "",                // username
            password: m[5] || ""                 // password
        };
    if (r.protocol.length == 2) {
        r.protocol = "file:///" + r.protocol.toUpperCase();
        r.origin = r.protocol + "//" + r.host;
    }
    r.href = r.origin + r.pathname + r.search + r.hash;
    return r;
};
parseUrl("http://username:password@localhost:257/deploy/?asd=asd#asd"); 
```

它适用于绝对和相对网址

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2013-11-06T00:20:46.010

**对于那些寻找适用于 IE、Firefox 和 Chrome 的现代解决方案的人：**

**这些使用超链接元素的解决方案都不会在 chrome 中起作用。**如果您将无效（或空白）的 url 传递给 chrome，它将始终返回调用脚本的主机。所以在 IE 中你会得到空白，而在 Chrome 中你会得到 localhost （或其他）。

如果您试图查看推荐人，这是欺骗性的。您需要确保您返回的主机位于原始 url 中以处理此问题：

```
 function getHostNameFromUrl(url) {
        // <summary>Parses the domain/host from a given url.</summary>
        var a = document.createElement("a");
        a.href = url;

        // Handle chrome which will default to domain where script is called from if invalid
        return url.indexOf(a.hostname) != -1 ? a.hostname : '';
    } 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2013-04-15T07:02:29.970

AngularJS 方式 - 在这里摆弄：http: [//jsfiddle.net/PT5BG/4/](http://jsfiddle.net/PT5BG/4/)

```
<!DOCTYPE html>
<html>
<head>
    <title>Parse URL using AngularJS</title>
</head>
<body ng-app ng-controller="AppCtrl" ng-init="init()">

<h3>Parse URL using AngularJS</h3>

url: <input type="text" ng-model="url" value="" style="width:780px;">

<ul>
    <li>href = {{parser.href}}</li>
    <li>protocol = {{parser.protocol}}</li>
    <li>host = {{parser.host}}</li>
    <li>hostname = {{parser.hostname}}</li>
    <li>port = {{parser.port}}</li>
    <li>pathname = {{parser.pathname}}</li>
    <li>hash = {{parser.hash}}</li>
    <li>search = {{parser.search}}</li>
</ul>

<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.6/angular.min.js"></script>

<script>
function AppCtrl($scope) {

    $scope.$watch('url', function() {
        $scope.parser.href = $scope.url;
    });

    $scope.init = function() {
        $scope.parser = document.createElement('a');
        $scope.url = window.location;
    }

}
</script>

</body>
</html> 
```

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2013-02-08T13:31:18.517

您还可以使用[Locutus](http://locutus.io/)项目（原 php.js）中[`parse_url()`](http://locutus.io/php/url/parse_url/)的函数。

代码：

```
parse_url('http://username:password@hostname/path?arg=value#anchor'); 
```

结果：

```
{
  scheme: 'http',
  host: 'hostname',
  user: 'username',
  pass: 'password',
  path: '/path',
  query: 'arg=value',
  fragment: 'anchor'
} 
```

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2015-01-15T13:37:22.040

使用模块模式的简单而强大的解决方案。这包括对 IE 的修复，其中 IE`pathname`并不总是具有前导正斜杠 ( `/`)。

我创建了一个[Gist](https://gist.github.com/ryankane/718566dba322a952ae9f)和一个[JSFiddle](http://jsfiddle.net/MrPolywhirl/ded7zd0a/)，它提供了一个更加动态的解析器。我建议您检查一下并提供反馈。

```
var URLParser = (function (document) {
    var PROPS = 'protocol hostname host pathname port search hash href'.split(' ');
    var self = function (url) {
        this.aEl = document.createElement('a');
        this.parse(url);
    };
    self.prototype.parse = function (url) {
        this.aEl.href = url;
        if (this.aEl.host == "") {
           this.aEl.href = this.aEl.href;
        }
        PROPS.forEach(function (prop) {
            switch (prop) {
                case 'hash':
                    this[prop] = this.aEl[prop].substr(1);
                    break;
                default:
                    this[prop] = this.aEl[prop];
            }
        }, this);
        if (this.pathname.indexOf('/') !== 0) {
            this.pathname = '/' + this.pathname;
        }
        this.requestUri = this.pathname + this.search;
    };
    self.prototype.toObj = function () {
        var obj = {};
        PROPS.forEach(function (prop) {
            obj[prop] = this[prop];
        }, this);
        obj.requestUri = this.requestUri;
        return obj;
    };
    self.prototype.toString = function () {
        return this.href;
    };
    return self;
})(document); 
```

# 演示

```
var URLParser = (function(document) {
  var PROPS = 'protocol hostname host pathname port search hash href'.split(' ');
  var self = function(url) {
    this.aEl = document.createElement('a');
    this.parse(url);
  };
  self.prototype.parse = function(url) {
    this.aEl.href = url;
    if (this.aEl.host == "") {
      this.aEl.href = this.aEl.href;
    }
    PROPS.forEach(function(prop) {
      switch (prop) {
        case 'hash':
          this[prop] = this.aEl[prop].substr(1);
          break;
        default:
          this[prop] = this.aEl[prop];
      }
    }, this);
    if (this.pathname.indexOf('/') !== 0) {
      this.pathname = '/' + this.pathname;
    }
    this.requestUri = this.pathname + this.search;
  };
  self.prototype.toObj = function() {
    var obj = {};
    PROPS.forEach(function(prop) {
      obj[prop] = this[prop];
    }, this);
    obj.requestUri = this.requestUri;
    return obj;
  };
  self.prototype.toString = function() {
    return this.href;
  };
  return self;
})(document);

/* Main */
var out = document.getElementById('out');
var urls = [
  'https://www.example.org:5887/foo/bar?a=1&b=2#section-1',
  'ftp://www.files.com:22/folder?id=7'
];
var parser = new URLParser();
urls.forEach(function(url) {
  parser.parse(url);
  println(out, JSON.stringify(parser.toObj(), undefined, ' '), 0, '#0000A7');
});

/* Utility functions */
function print(el, text, bgColor, fgColor) {
  var span = document.createElement('span');
  span.innerHTML = text;
  span.style['backgroundColor'] = bgColor || '#FFFFFF';
  span.style['color'] = fgColor || '#000000';
  el.appendChild(span);
}
function println(el, text, bgColor, fgColor) {
  print(el, text, bgColor, fgColor);
  el.appendChild(document.createElement('br'));
}
```

```
body {
  background: #444;
}
span {
  background-color: #fff;
  border: thin solid black;
  display: inline-block;
}
#out {
  display: block;
  font-family: Consolas, Menlo, Monaco, Lucida Console, Liberation Mono, DejaVu Sans Mono, Bitstream Vera Sans Mono, Courier New, monospace, serif;
  font-size: 12px;
  white-space: pre;
}
```

```
<div id="out"></div>
```

# 输出

```
{
 "protocol": "https:",
 "hostname": "www.example.org",
 "host": "www.example.org:5887",
 "pathname": "/foo/bar",
 "port": "5887",
 "search": "?a=1&b=2",
 "hash": "section-1",
 "href": "https://www.example.org:5887/foo/bar?a=1&b=2#section-1",
 "requestUri": "/foo/bar?a=1&b=2"
}
{
 "protocol": "ftp:",
 "hostname": "www.files.com",
 "host": "www.files.com:22",
 "pathname": "/folder",
 "port": "22",
 "search": "?id=7",
 "hash": "",
 "href": "ftp://www.files.com:22/folder?id=7",
 "requestUri": "/folder?id=7"
} 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2016-12-21T17:38:30.207

为此使用[https://www.npmjs.com/package/uri-parse-lib](https://www.npmjs.com/package/uri-parse-lib)

```
var t = parserURI("http://user:pass@example.com:8080/directory/file.ext?query=1&next=4&sed=5#anchor"); 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2017-06-12T06:26:05.917

为什么不使用它？

```
 $scope.get_location=function(url_str){
        var parser = document.createElement('a');
        parser.href =url_str;//"http://example.com:3000/pathname/?search=test#hash";
        var info={
            protocol:parser.protocol,   
            hostname:parser.hostname, // => "example.com"
            port:parser.port,     // => "3000"
            pathname:parser.pathname, // => "/pathname/"
            search:parser.search,   // => "?search=test"
            hash:parser.hash,     // => "#hash"
            host:parser.host, // => "example.com:3000"      
        }
        return info;
    }
    alert( JSON.stringify( $scope.get_location("http://localhost:257/index.php/deploy/?asd=asd#asd"),null,4 ) ); 
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2020-10-02T01:51:05.077

**通过添加“ searchParam** ”功能来扩展 acdcjunior 解决方案
**模仿 URL 对象**，添加“ **searchParam** ”来解析查询字符串
适用于 IE 6、7、8 9、10、11

**用法**- ( [JSFiddle 链接](https://jsfiddle.net/CodeCowboyOrg/c1agph8y/4/))

```
// USAGE:
var myUrl = new ParsedUrl("http://www.example.com/path?var1=123&var2=abc#fragment");
console.log(myUrl);
console.log(myUrl.searchParam('var1'));
console.log(myUrl.searchParam('var2')); 
```

**输出**- ( [JSFiddle 链接](https://jsfiddle.net/CodeCowboyOrg/c1agph8y/4/))

```
{
  hash: "#fragment",
  host: "www.example.com:8080",
  hostname: "www.example.com",
  href: "http://www.example.com:8080/path?var1=123&amp;var2=abc#fragment",
  pathname: "/path",
  port: "80",
  protocol: "http:",
  search: "?var1=123&amp;var2=abc"
}

"123"
"abc" 
```

**代码**- ( [JSFiddle 链接](https://jsfiddle.net/CodeCowboyOrg/c1agph8y/4/))

```
function ParsedUrl(url) {
    var parser = document.createElement("a");
    parser.href = url;

    // IE 8 and 9 dont load the attributes "protocol" and "host" in case the source URL
    // is just a pathname, that is, "/example" and not "http://www.example.com/example".
    parser.href = parser.href;

    // IE 7 and 6 wont load "protocol" and "host" even with the above workaround,
    // so we take the protocol/host from window.location and place them manually
    if (parser.host === "") {
        var newProtocolAndHost = window.location.protocol + "//" + window.location.host;
        if (url.charAt(1) === "/") {
            parser.href = newProtocolAndHost + url;
        } else {
            // the regex gets everything up to the last "/"
            // /path/takesEverythingUpToAndIncludingTheLastForwardSlash/thisIsIgnored
            // "/" is inserted before because IE takes it of from pathname
            var currentFolder = ("/"+parser.pathname).match(/.*\//)[0];
            parser.href = newProtocolAndHost + currentFolder + url;
        }
    }

    // copies all the properties to this object
    var properties = ['host', 'hostname', 'hash', 'href', 'port', 'protocol', 'search'];
    for (var i = 0, n = properties.length; i < n; i++) {
      this[properties[i]] = parser[properties[i]];
    }

    // pathname is special because IE takes the "/" of the starting of pathname
    this.pathname = (parser.pathname.charAt(0) !== "/" ? "/" : "") + parser.pathname;

  //search Params
  this.searchParam =  function(variable) {
    var query = (this.search.indexOf('?') === 0) ? this.search.substr(1) : this.search;
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split('=');
        if (decodeURIComponent(pair[0]) == variable) {
            return decodeURIComponent(pair[1]);
        }
    }
    console.log('Query variable %s not found', variable);
    return '';
    };
} 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2015-06-02T14:53:10.600

停止重新发明轮子。使用[https://github.com/medialize/URI.js/](https://github.com/medialize/URI.js/)

```
var uri = new URI("http://example.org:80/foo/hello.html");
// get host
uri.host(); // returns string "example.org:80"
// set host
uri.host("example.org:80"); 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2015-09-04T10:31:41.113

只需使用 url.js 库（用于 web 和 node.js）。

[https://github.com/websanova/js-url](https://github.com/websanova/js-url)

```
url: http://example.com?param=test#param=again

url('?param'); // test
url('#param'); // again
url('protocol'); // http
url('port'); // 80
url('domain'); // example.com
url('tld'); // com

etc... 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2019-12-20T19:11:27.090

第一个答案的简单技巧

```
var getLocation = function(href=window.location.href) {
    var l = document.createElement("a");
    l.href = href;
    return l;
}; 
```

即使没有参数也可以使用它来计算当前主机名 **getLocation().hostname**将给出当前主机名

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2021-09-27T02:09:57.173

这不会解析查询和散列，但除此之外它工作得很好。

```
const getURIParts = (url) => {
  const matches = url.match(/^(\w+?:\/\/)?([\w-\.]+(?=\/?))?:?(\d*)?([^:]*)/)
  return {
    scheme: matches ? matches[1] : undefined,
    host: matches ? matches[2] : '',
    port: matches ? matches[3] : undefined,
    pathname: matches ? matches[4] : ''
  }
}

console.log(getURIParts(""))
console.log(getURIParts("http://localhost/bla"))
console.log(getURIParts("https://api.spotify.com/"))
console.log(getURIParts("https://api.spotify.com"))
console.log(getURIParts("wss://wss.slack.com/link/?ticket=1234-5678"))
console.log(getURIParts("localhost"))
console.log(getURIParts("localhost/bla"))
console.log(getURIParts("localhost/"))
console.log(getURIParts("api.spotify.com/bla/two"))
console.log(getURIParts("api.spotify.com:8000/bla/two"))
console.log(getURIParts("https://api.spotify.com:8800/"))
console.log(getURIParts("/mp3-preview/f504e6b8e037771318656394f532dede4f9bcaea"))
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-09-01T20:44:15.900

试试这个 ：

```
function getUrlPath(str){
//fakepath when url not have a path
  var fakepath = "/FakPath";
  var url = str+fakepath;
  var reg = /.+?\:\/\/.+?(\/.+?)(?:#|\?|$)/;
  var output = reg.exec(url);
  // check "output" != null
  return (output) ? output[1].replace(fakepath,"") : fakepath;
}

var myurl = "https://stackoverflow.com/questions/736513/";
const path = getUrlPath(myurl);

console.log(   path     );
//output :  /questions/736513/
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2022-02-09T19:07:27.873

当然，在**>2016**中，正确的答案是使用[**URL API**](https://developer.mozilla.org/en-US/docs/Web/API/URL)
对于页面 URL 和[`window.location`](https://developer.mozilla.org/en-US/docs/Web/API/Window/location)
`<a href="...">` [`HTMLAnchorElement API`](https://developer.mozilla.org/en-US/docs/Web/API/HTMLAnchorElement)

也为了支持旧版浏览器，使用 polyfill：

```
<script crossorigin="anonymous" src="https://polyfill.io/v3/polyfill.min.js?features=URL"></script> 
```

但就像其他选项一样，它可以通过**RegEx 模式**轻松准确地处理：

```
function URIinfo(s) {
    s=s.match(/^(([^/]*?:)\/*((?:([^:]+):([^@]+)@)?([^/:]{2,}|\[[\w:]+])(:\d*)?(?=\/|$))?)?((.*?\/)?(([^/]*?)(\.[^/.]+?)?))(\?.*?)?(#.*)?$/);
    return {origin:s[1],protocol:s[2],host:s[3],username:s[4],password:s[5],hostname:s[6],port:s[7],path:s[8],folders:s[9],file:s[10],filename:s[11],fileext:s[12],search:s[13],hash:s[14]};
}

var sample='http://user:password@my.site.com:8080/onefolder/folder.name/file.min.js?query=http://my.site.com:8080/file.exe#hash-root:/file/1.txt';

console.log (URIinfo(sample));
/*
{
  "origin": "http://user:password@my.site.com:8080",
  "protocol": "http:",
  "host": "user:password@my.site.com:8080",
  "username": "user",
  "password": "password",
  "hostname": "my.site.com",
  "port": ":8080",
  "path": "/onefolder/folder.name/file.min.js",
  "folders": "/onefolder/folder.name/",
  "file": "file.min.js",
  "filename": "file.min",
  "fileext": ".js",
  "search": "?query=http://my.site.com:8080/file.exe",
  "hash": "#hash-root:/file/1.txt"
}
*/
```

使用[**正则表达式**](https://regexr.com/6f3hb)

任何一种都可以

*   绝对/相对路径
*   IPv4 / [IPv6](https://en.wikipedia.org/wiki/IPv6_address)
*   网络协议/本地文件
*   查询/哈希

并将返回所有 URL 选项，但不返回[searchParams](https://developer.mozilla.org/en-US/docs/Web/API/URL/searchParams)

(+) 也将返回**文件信息**，如[PHP pathInfo](https://www.php.net/manual/en/function.pathinfo.php)

# r - R随机森林变量重要性

> ID：736514
> 
> 赞同：46
> 
> 时间：2009-04-10T02:18:38.490
> 
> 标签：r, statistics, data-mining, random-forest

我正在尝试使用随机森林包在 R 中进行分类。

列出的变量重要性度量是：

*   第 0 类变量 x 的平均原始重要性得分
*   第 1 类变量 x 的平均原始重要性得分
*   `MeanDecreaseAccuracy`
*   `MeanDecreaseGini`

现在我知道这些“意味着”是什么，就像我知道它们的定义一样。我想知道的是如何使用它们。

我真正想知道的是，这些值仅在它们的准确程度、什么是好值、什么是坏值、最大值和最小值等方面意味着什么。

如果一个变量有一个高值，`MeanDecreaseAccuracy`或者`MeanDecreaseGini`这意味着它是重要的还是不重要的？此外，有关原始分数的任何信息也可能很有用。我想知道与这些数字的应用相关的所有信息。

使用“错误”、“求和”或“置换”等词的解释比不涉及任何讨论随机森林如何工作的更简单的解释更有帮助。

就像我希望有人向我解释如何使用收音机一样，我不希望解释涉及收音机如何将无线电波转换为声音。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-08T13:09:40.257

> 使用“错误”、“求和”或“置换”等词的解释比不涉及任何讨论随机森林如何工作的更简单的解释更有帮助。
> 
> 就像我希望有人向我解释如何使用收音机一样，我不希望解释涉及收音机如何将无线电波转换为声音。

您如何解释 WKRP 100.5 FM 中的数字“意味着”什么而不涉及波频率的讨厌技术细节？坦率地说，即使您了解一些技术术语，随机森林的参数和相关性能问题也很难理解。

这是我对一些答案的看法：

> -0 类变量 x 的平均原始重要性得分
> 
> - 第 1 类变量 x 的平均原始重要性分数

从 Random Forest[网页](http://www.stat.berkeley.edu/~breiman/RandomForests/cc_home.htm#varimp)简化，原始重要性分数衡量特定预测变量在成功分类数据方面比随机更有帮助。

> -MeanDecreaseAccuracy

我认为这仅在[R 模块](http://cran.r-project.org/web/packages/randomForest/index.html)中，并且我相信它可以衡量在模型中包含此预测器多少会减少分类错误。

> -MeanDecreaseGini

[当用于描述社会的收入分配时，基尼](http://en.wikipedia.org/wiki/Gini_coefficient)被定义为“不公平”，或者在基于树的分类中衡量“节点杂质”。低 Gini（即 Gini 的较高降低）意味着特定的预测变量在将数据划分为已定义的类时发挥了更大的作用。如果不谈论分类树中的数据根据​​预测变量的值在各个节点处拆分这一事实，这很难描述。我不太清楚这如何转化为更好的性能。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-07-22T06:54:54.057

对于您的直接关注：更高的值意味着变量更重要。对于您提到的所有措施，这应该是正确的。

随机森林为您提供了非常复杂的模型，因此解释重要性度量可能很棘手。如果您想轻松了解变量在做什么，请不要使用 RF。请改用线性模型或（非集成）决策树。

你说：

> 使用“错误”、“求和”或“置换”等词的解释比不涉及任何讨论随机森林如何工作的更简单的解释更有帮助。

除非您深入了解随机森林，否则要解释比上述更多的内容将非常困难。我假设您在抱怨手册或 Breiman 手册中的部分：

[http://www.stat.berkeley.edu/~breiman/RandomForests/cc_home.htm#varimp](http://www.stat.berkeley.edu/~breiman/RandomForests/cc_home.htm#varimp)

为了弄清楚一个变量有多重要，他们用随机垃圾填充它（“置换”它），然后看看预测准确性降低了多少。MeanDecreaseAccuracy 和 MeanDecreaseGini 以这种方式工作。我不确定原始重要性分数是多少。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-07-28T05:55:28.917

随机森林的可解释性有点困难。虽然 RF 是一个非常强大的分类器，但它以民主的方式进行预测。我的意思是你通过获取变量的随机子集和数据的随机子集来构建成百上千棵树，然后构建一棵树。然后对所有未选中的数据进行预测并保存预测。它很健壮，因为它可以很好地处理数据集的变幻莫测（即，它平滑随机的高/低值、偶然的图/样本、以 4 种不同的方式测量同一事物等）。但是，如果您有一些高度相关的变量，则两者似乎都很重要，因为它们并不总是包含在每个模型中。

随机森林的一种潜在方法可能是帮助减少您的预测变量，然后切换到常规 CART 或尝试使用 PARTY 包进行基于推理的树模型。但是，您必须对数据挖掘问题保持警惕，并对参数进行推断。

# apache - 我怎样才能有条件的 .htaccess 块？

> ID：736524
> 
> 赞同：18
> 
> 时间：2009-04-10T02:23:18.493
> 
> 标签：apache, .htaccess, apache2

这是您以前可能遇到过的 Apache 问题。我想要一个可以部署到我的工作站、登台服务器和生产服务器的源包，但它可以根据 URL 加载不同的 .htaccess 设置。

请注意，我正在使用带有 IfModule 调用的 kludge，但这不适用于我们的新生产服务器，因为它与我的登台服务器共享所有相同的模块。

注意我需要将 SetEnv 与这些重写捆绑在一起。目前，如果您使用 RewriteCond，它仅与以下 RewriteRule 相关联，而不与下面的 SetEnv 相关联。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-21T18:07:25.803

不使用 SetEnv，而是使用 RewriteRule 本身的环境变量设置功能：

```
RewriteCond %{HTTP_HOST} =foo.com
RewriteRule ^ - [E=VARNAME:foo]

RewriteCond %{HTTP_HOST} =bar.com
RewriteRule ^ - [E=VARNAME:bar] 
```

虽然我更喜欢通过在启动时将标志传递给 httpd 进程并使用 IfDefine 块来查找它们来做这种事情。

```
<IfDefine FOO>
SetEnv VARNAME foo
</IfDefine>

<IfDefine BAR>
SetEnv VARNAME bar
</IfDefine> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-11-22T20:08:24.330

**在 Ubuntu Linux 上**，`IfDefine`'s 变量设置在

```
/etc/apache2/envvars 
```

并且被称为`APACHE_ARGUMENTS`。因此，在该文件的底部，我必须添加：

```
export APACHE_ARGUMENTS="-D dev" 
```

...然后反弹服务器：

```
/etc/init.d/apache2 stop
/etc/init.d/apache2 start 
```

**在其他系统上：**

但是，有一篇关于这个主题的 Debian 文章在这里讨论了这个[问题](http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=475150)。在该示例中，要编辑的文件是 /etc/default/apache2 并且变量名为`APACHE_DEFINES`.

同样，在某些系统上，它是一个名为的变量`OPTIONS`，它设置在`/etc/sysconfig/httpd`.

所以，你真正需要做的是在你的 apache2ctl 文件中寻找开始部分。因此，首先执行 a`whereis apache2ctl`来查找该脚本的位置，找出它并找到其中包含 apache2 指令的起始部分，并查看它传递的变量是`OPTIONS`、`APACHE_ARGUMENTS`、`APACHE_DEFINES`还是其他内容。然后，通过使用`/etc/sysconfig/httpd`、`/etc/default/apache2`或`/etc/apache2/envvars`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-10-10T12:30:15.573

我尝试了该`IfDefine`方法，但它不起作用，即使我传递给 Apache 启动的定义变量肯定会出现`phpinfo()`在行`APACHE_ARGUMENTS`中。

我尝试了另一种方法，效果很好。在您的`.htaccess`文件中，您需要以下内容：

`# Is the domain local (i wanted to check two names)? <If "%{SERVER_NAME} != 'localhost' && %{SERVER_NAME} != 'myproject.localhost'"> # I wanted to password protect the production server only AuthType Basic AuthName "Restricted area" AuthUserFile /app/.htpasswd require valid-user </If>`

我正在使用 Apache 2.4。可能不适用于早期版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T02:39:20.093

这是一个简单的示例，应该足以让您对其进行更改以满足您的要求：

```
<IfModule mod_rewrite.c>
    RewriteEngine On

    RewriteBase /

    RewriteCond %{HTTP_HOST} !^localhost
    RewriteCond %{HTTP_HOST} !^www\.
    RewriteRule (.*) http://www.%{HTTP_HOST}/$1 [R=301,L]
</IfModule> 
```

# java - 什么时候在oracle中看起来相同的两列不一样？

> ID：736531
> 
> 赞同：0
> 
> 时间：2009-04-10T02:25:54.663
> 
> 标签：java, oracle, jdbc, toplink

我正在从事 oracle 9i 中的一个项目。我在使用 toplink 10.1.3 加载表中的特定行时遇到问题。事实证明，toplink 所依赖的 jdbc 驱动程序的行为非常有趣。也许这里有人可以帮助...

我有一个名为：crazytable 的表。它有一列：“ver_num number(19) not null default 0”。该列是几年前作为原始插入的一部分添加到表中的。当我从 crazytable 中选择任何记录（请参阅下面的 jdbc 连接代码）并尝试执行 rs.getLong(colIndex) 时，一切正常。但是，如果我执行 rs.getObject(colIndex)，我会得到一个堆栈跟踪：

```
java.lang.ArrayIndexOutOfBoundsException: 1
    at oracle.sql.NUMBER.toBigDecimal(NUMBER.java:651)
    at oracle.jdbc.dbaccess.DBConversion.NumberBytesToBigDecimal(DBConversion.java:2805)
    at oracle.jdbc.driver.OracleStatement.getBigDecimalValue(OracleStatement.java:4539)
    at oracle.jdbc.driver.OracleStatement.getObjectValue(OracleStatement.java:5666)
    at oracle.jdbc.driver.OracleStatement.getObjectValue(OracleStatement.java:5622)
    at oracle.jdbc.driver.OracleResultSetImpl.getObject(OracleResultSetImpl.java:739)
    at oracle.jdbc.driver.OracleResultSet.getObject(OracleResultSet.java:1470)
    stacktrace truncated to protect my poor code... 
```

我可以取另一个表，我们称之为：sanetable，然后对具有相同名称的列运行相同的查询并输入“ver_num number(19) not null default 0”。并且 rs.getLong(colIndex) 和 rs.getObject(colIndex) 工作得很好。

两列都不涉及约束或索引。我已经尝试过 oracle 驱动程序 9.2.0.8、9.2.0.5、9.2.0.1，甚至 10.*（不起作用）。

有人知道我可以在这里做什么吗？

这是我的基本连接代码。成功调用之间的唯一区别是有问题的特定表：

```
 Class.forName(oracle.jdbc.OracleDriver.class.getName());
    String url = "jdbc:oracle:thin:@IPADDRESS:PORT:INSTANCE";
        Connection conn = null;
        ResultSet rs = null;
        try {
            conn = DriverManager.getConnection(url, "user","pass");
            PreparedStatement prepareStatement = conn.prepareStatement(
                    "select distinct ver_num " +

                    "FROM [crazytable|sanetable] " 
                    );
            rs = prepareStatement.executeQuery();
            assertNotNull(rs);
            while (rs.next()) {
                ResultSetMetaData md = rs.getMetaData();
                for (int i = 1; i <= md.getColumnCount(); i++) {
                    String key = md.getColumnLabel(i);
                    Object value = rs.getLong(key);
                    System.out.println(key+" : "+value 
                            +" was null: "+rs.wasNull()
                            +" type: "+ rs.getType()
                            +" class: "+ md.getColumnClassName(i));
                }
            }
        } finally {
            if (rs != null) {
                rs.close();
            }
            if (conn != null) {
                conn.close();
            }
        } 
```

编辑：驱动程序可以在这个页面上找到：[http ://www.oracle.com/technology/software/tech/java/sqlj_jdbc/htdocs/jdbc9201.html](http://www.oracle.com/technology/software/tech/java/sqlj_jdbc/htdocs/jdbc9201.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T04:58:43.847

好吧，我想我明白了。我正在查看其他一些问题，并注意到还有其他 oracle type 4 驱动程序。其中之一是 DataDirect ( [http://datadirect.com](http://datadirect.com) )。我使用了他们的驱动程序的试用版，它能够返回 rs.getObject(intIndex)。

该值为：-1.6777120E-27。

所以 rs.getLong() 向下舍入为零，但 BigDecimal 看到小数部分并引发异常。

这可能是因为 oracle 的驱动程序是用 jdbc1.4 编译的，而对于 datadirect 来说是更新的。

# php - 我可以为我的 SAAS 应用程序使用哪个计费提供商？

> ID：736532
> 
> 赞同：3
> 
> 时间：2009-04-10T02:25:58.987
> 
> 标签：php, scalability, saas, billing

我正在开发一个软件即服务 (SAAS) 应用程序，该应用程序允许公司管理供应商信息。

有哪些供应商/供应商可以提供账单服务，包括管理发票、订阅、续订和提醒缴费？

我发现从头开始构建它需要很多时间。

除了计费，为了成功发布此应用程序，我还应该考虑哪些其他主要组件/注意事项？

我有以下注意事项，欢迎提出任何建议：

1) 基础设施：为了可扩展性和维护，我使用云计算，这样我就不用管理基础设施，尤其是在需求增加时扩大规模。

2) 安全：我发现如果我使用专用服务器，我必须为安全支付更多的费用，例如防火墙。因此，使用云计算将使我的应用程序能够在安全平台上“骑行”。

问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-11-16T16:53:44.093

我们刚刚遇到了这个看起来不错的 - [http://chargify.com/](http://chargify.com/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T15:56:35.287

许多计费系统面临的最大挑战是，您要么最终完成大量编码工作，要么缺少一个或多个关键功能。出于安全原因，PayPal 等系统无法处理外部驱动的定期计费；作为客户，您可以同意卖家的订阅，但 PayPal 必须处理所有事情。此外，每个必须拥有 PayPal 或 GoogleCheckout 帐户才能开展业务的人都可能不是初学者，具体取决于您的受众。AuthorizeNet 和 LinkPoint 等传统的电子商务商家系统为您提供了更大的灵活性，但您可能需要进行大量编码才能以您想要的方式推送交易，具体取决于您的平台，更不用说在设置首先是帐户。 [亚马逊灵活支付服务](http://aws.amazon.com/fps/)处于中间位置，提供比 PayPal/Google Checkout 更大的灵活性，但仍然存在第三方帐户限制。由于您正在使用一种工具来管理客户与其供应商的关系，因此您可能会受益于亚马逊促进两个外部方之间交易的能力。

我已经使用 Java 或 Ruby on Rails 在这个领域进行了开发。Ruby on Rails 有一个由 Shopify 的人构建的名为[ActiveMerchant](http://www.activemerchant.org/)的奇妙宝石，一旦您使用 AuthorizeNet/LinkPoint 类型的提供商之一打开您的商家帐户，信用卡处理就会变得非常简单。大多数商家提供商也有不错的 Java API。你可能想看看像[Blinksale](http://www.blinksale.com)这样的发票，因为它可以让你把漂亮的发票放在一起，并且有一个 API。

关于云计算：我是一个忠实的粉丝，它可以让您更轻松地管理扩展成本。但是，在许多情况下，它确实需要您更快地解决集群和故障转移问题。对于可以通过 Amazon MapReduce 之类的工具运行的批量计费等任务，这不是问题；你提出你需要的东西，把它扔进黑匣子，然后把结果拿出来。对于需要持续正常运行时间的东西，例如 Web 界面，您需要评估在云中运行 webapp 服务器集群还是在托管数据中心（例如 The Planet）运行 1 或 2 个机器更便宜或机架空间。您的正确答案部分取决于您拥有的专业知识以及您使用的语言/平台。对于持续正常运行时间方面，将在云中托管 Rails 应用程序的 [Morph 。](http://www.mor.ph)

如果我所说的任何内容需要进一步澄清，请回复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T02:38:45.523

Mosso（它是 Rackspace 的云子公司）内置了一些基本的计费功能——我正在迁移我的站点，而客户计费是我这样做的原因之一。他们只做抄送计费，至少现在是这样。

# c# - 如何在 C# 中将字符串转换为 ascii 到二进制？

> ID：736533
> 
> 赞同：7
> 
> 时间：2009-04-10T02:26:30.887
> 
> 标签：c#, c++, binary

不久前（高中一年级），我请一位非常优秀的 C++ 程序员，他是一名大三学生，他制作了一个简单的应用程序，将字符串转换为二进制。他给了我以下代码示例：

```
void ToBinary(char* str)
{
    char* tempstr;
    int k = 0;

    tempstr = new char[90];

    while (str[k] != '\0')
    {
        itoa((int)str[k], tempstr, 2);
        cout << "\n" << tempstr;
        k++;
    }

    delete[] tempstr;
} 
```

所以我想我的问题是如何获得与 C# 中的 itoa 函数等效的函数？或者如果没有，我怎么能达到同样的效果？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-10T02:37:11.207

使用 C# 很容易做到这一点。

```
var str = "Hello world";

With LINQ
foreach (string letter in str.Select(c => Convert.ToString(c, 2)))
{
  Console.WriteLine(letter);
}

Pre-LINQ
foreach (char letter in str.ToCharArray())
{
  Console.WriteLine(Convert.ToString(letter, 2));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T02:32:22.793

使用[ASCIIEncoding](http://msdn.microsoft.com/en-us/library/system.text.asciiencoding.aspx)类并调用[GetBytes](http://msdn.microsoft.com/en-us/library/ds4kkd55.aspx)传递字符串。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T02:34:31.803

目前尚不清楚您想要什么，但这是我认为您想要的：

```
return Convert.ToString(int.Parse(str), 2); // "5" --> "101" 
```

这不是 C++ 代码所做的。为此，我建议：

```
string[] binaryDigits = str.Select(c => Convert.ToString(c, 2));
foreach(string s in binaryDigits) Console.WriteLine(s); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-06T09:06:59.670

谢谢，这太棒了！！我用它来编码查询字符串......

```
protected void Page_Load(object sender, EventArgs e)
{
    string page = "";
    int counter = 0;
    foreach (string s in Request.QueryString.AllKeys)
    {
        if (s != Request.QueryString.Keys[0])
        {
            page += s;
            page += "=" + BinaryCodec.encode(Request.QueryString[counter]);
        }
        else
        {
            page += Request.QueryString[0];
        }
        if (!page.Contains('?'))
        {
            page += "?";
        }
        else
        {
            page += "&";
        }
        counter++;
    }
    page = page.TrimEnd('?');
    page = page.TrimEnd('&');
    Response.Redirect(page);
}

public class BinaryCodec
{
    public static string encode(string ascii)
    {
        if (ascii == null)
        {
            return null;
        }
        else
        {
            char[] arrChars = ascii.ToCharArray();
            string binary = "";
            string divider = ".";
            foreach (char ch in arrChars)
            {
                binary += Convert.ToString(Convert.ToInt32(ch), 2) + divider;
            }
            return binary;
        }
    }

    public static string decode(string binary)
    {
        if (binary == null)
        {
            return null;
        }
        else
        {
            try
            {
                string[] arrStrings = binary.Trim('.').Split('.');
                string ascii = "";
                foreach (string s in arrStrings)
                {
                    ascii += Convert.ToChar(Convert.ToInt32(s, 2));
                }
                return ascii;
            }
            catch (FormatException)
            {
                throw new FormatException("SECURITY ALERT! You cannot access a page by entering its URL.");
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-23T21:58:50.433

这是一个扩展功能：

```
 public static string ToBinary(this string data, bool formatBits = false)
        {
            char[] buffer = new char[(((data.Length * 8) + (formatBits ? (data.Length - 1) : 0)))];
            int index = 0;
            for (int i = 0; i < data.Length; i++)
            {
                string binary = Convert.ToString(data[i], 2).PadLeft(8, '0');
                for (int j = 0; j < 8; j++)
                {
                    buffer[index] = binary[j];
                    index++;
                }
                if (formatBits && i < (data.Length - 1))
                {
                    buffer[index] = ' ';
                    index++;
                }
            }
            return new string(buffer);
        } 
```

你可以像这样使用它：

```
Console.WriteLine("Testing".ToBinary()); 
```

输出：

```
01010100011001010111001101110100011010010110111001100111 
```

and if you add 'true' as a parameter, it will automatically separate each binary sequence.

# asp.net - 在开发 Web 应用程序 (ASP.NET/MVC) 时，您何时添加安全性？

> ID：736536
> 
> 赞同：2
> 
> 时间：2009-04-10T02:29:42.160
> 
> 标签：asp.net, asp.net-mvc, authentication, asp.net-membership

在开发 Web 应用程序时，在我的情况下是 ASP.NET MVC 应用程序，但这个问题不是特定于平台的，你什么时候添加成员资格、角色和身份验证的基础架构？

我实际上已经做到了这两种方式.... 1\. 开始开发应用程序，其中会员/角色/身份验证是第一个里程碑和 2\. 等到大多数主要功能和要求实现然后添加会员/角色/身份验证基础设施。

是否有最佳实践或个人偏好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T02:37:59.330

我根据我正在做的事情来混合它。

ASP.Net 允许您将安全组件抽象得如此之多，以至于我发现事后实现它们真的很容易。有时它就像让您的页面从自定义页面类继承一样简单。（或者在 MVC 的情况下，自定义控制器类）

不过，我发现当我不必担心安全措施会妨碍时，调试核心功能要容易得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T03:39:52.630

引用“Professional ASP.NET MVC 1.0”（我碰巧正在研究），

> 创建新的 ASP.NET MVC 应用程序时，ASP.NET MVC 的默认 Visual Studio 项目模板会自动启用表单身份验证。它还自动向项目添加预构建的帐户登录实现——这使得在站点中集成安全性变得非常容易。

至少对于本教程来说，它大多只是发生，并且任何显式引用似乎都很好地落在了最后——但没有太多。如果您按预期使用它，它与 PHP 会话的简单程度相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T02:33:29.840

我对 ASP.NET 不是很熟悉，但是每次我开发 Web 应用程序时，安全性几乎是我编写的第一件事，否则你可能会在进一步的开发中遗漏一些东西；要么是因为你忘记了它，要么更可能是因为在开发过程中发生了一些变化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T02:59:03.523

安全性是前期应用程序设计的一部分。除非在最微不足道的情况下，否则以后不能添加它。

示例：人力资源应用程序。薪酬经理可以编辑薪酬，招聘人员只能查看。如果你事先不知道这种区别，你就不会将它构建到你的用户界面中，你就会遇到麻烦。是的，ASP.net 中的安全性在很大程度上是可配置的，但结构/粒度必须在应用程序中到位。

# r - R中没有标题/标签的图

> ID：736541
> 
> 赞同：23
> 
> 时间：2009-04-10T02:32:21.373
> 
> 标签：r, plot, charts, statistics

在[R](http://www.r-project.org/)中，有什么方法可以生成没有标题并且使用标题本来会占用的空间的图？

在`plot()`, `main`, `sub`,`xlab`中，`ylab`所有默认为`NULL`，但这只是在它们本来应该存在的地方留下空白，同上将它们设置为 ''。如果不包括它们意味着利用整个绘图空间而不是在边缘留下额外的空白空间，那就太好了。`pdf()`这在将绘图打印到文件设备（如,`png()`等）时尤其重要。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-10T03:15:17.480

请参阅[技巧 7](https://blog.revolutionanalytics.com/2009/01/10-tips-for-making-your-r-graphics-look-their-best.html)关于调整边距。

摘抄：

要删除为标签保留的空间，请使用 par(mar=...)。例如

```
png(file="notitle.png",width=400, height=350)
par(mar=c(5,3,2,2)+0.1)
hist(rnorm(100),ylab=NULL,main=NULL)
dev.off() 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-10T03:29:02.640

如果您愿意接受替代绘图包，[ggplot2](http://had.co.nz/ggplot2/)会在您设置`xlab`/`ylab`时自动执行此操作`NULL`（并且默认情况下没有绘图标题 / `main`）。对于简单的绘图，只需`require(ggplot2)`替换`plot`为`qplot`.

真的，ggplot2 是我多年来最有趣的阴谋，我无法抗拒向我遇到的每个人宣传它的机会。:-)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-07-22T15:26:31.303

使用 lattice，只需将 xlab、ylab 和 main 参数设置为 NULL：

```
library(lattice)
bwplot(rnorm(100),xlab=NULL,ylab=NULL,main=NULL) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-08-28T20:50:59.843

```
plot(anything, main=NULL) 
```

仍然有效。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-10T03:52:48.230

我通常使用

```
par(mar=c(1,1,1,1)) 
```

当我将边界保持在最低限度时。

# asp.net-mvc - ASP.NET MVC - 带有部分视图的强类型视图（视图和部分视图也应该可以访问一些全局数据）

> ID：736547
> 
> 赞同：0
> 
> 时间：2009-04-10T02:35:15.140
> 
> 标签：asp.net-mvc

考虑以下场景：

动作 Edit() 被转发到 Edit.aspx 视图以呈现视图。

Edit.aspx 由 textbox1 和两个部分视图（也称为视图用户控件）组成：part1.ascx（具有 textbox2、textbox3）和 part2.ascx（具有 checkbox1 和 checkbox2）

您想为 Edit.aspx 提供一个强类型视图，例如，您使用 EditViewData 类。

您还需要 Edit.aspx、part1.ascx 和 part2.ascx 可以访问一些全局信息，例如 currentUserID、currentUserLanguage、currentUserTimezone。

问题：

1.  您如何构建 EditViewData 类？
2.  如何将视图数据传递给视图和部分视图，以便在提交表单并返回到 Edit() http.post 操作时自动填充对象？
3.  您将什么传递给 Edit() http.post 操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T15:32:54.197

您的视图数据应如下所示：

```
public class EditViewData
{
    public int currentUserID { get; set; }
    public string currentUserLanguage { get; set; }
    public string currentUserTimezone { get; set; }
    // ... other stuff
} 
```

在你强输入你的 aspx 之后，你还需要强输入你的 ascxs。然后在你的 aspx 中，当你调用 RenderPartial 时，像往常一样调用：

```
<% using (Html.BeginForm()) %>
<% Html.RenderPartial("part1.ascx" ); %>
<% Html.RenderPartial("part2.ascx" ); %>
<%}%> 
```

它应该自动继承控件中的模型。请记住，您的 BeginForm 应该围绕您的两个控件（ascxs）。

# java - Java中排序（内存映射？）文件中的二进制搜索

> ID：736556
> 
> 赞同：33
> 
> 时间：2009-04-10T02:39:26.957
> 
> 标签：java, nio, large-files, binary-search, memory-mapping

我正在努力将 Perl 程序移植到 Java，并在学习过程中学习 Java。原始程序的一个核心组件是一个[Perl 模块](http://search.cpan.org/~jfreeman/File-SortedSeek-0.015/lib/File/SortedSeek.pm)，它使用二进制搜索在 +500 GB 排序的文本文件中进行字符串前缀查找（本质上，“寻找”到文件中间的字节偏移量，回溯到最近的换行符，比较带有搜索字符串的行前缀，“寻找”到该字节偏移量的一半/两倍，重复直到找到......）

我已经尝试了几种数据库解决方案，但发现在这种大小的数据集的绝对查找速度上没有什么比这更好的了。您知道任何现有的实现此类功能的 Java 库吗？如果做不到这一点，您能否指出一些在文本文件中进行随机访问读取的惯用示例代码？

或者，我不熟悉新的（？）Java I/O 库，但它是否可以选择对 500 GB 文本文件进行内存映射（我在 64 位机器上，有可用内存）并执行二进制搜索内存映射的字节数组？我很想听听您分享有关此问题和类似问题的任何经验。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-10T07:03:44.467

对于这种情况，我是Java 的忠实*粉丝***[`MappedByteBuffers`](http://download.oracle.com/javase/1.5.0/docs/api/index.html?java/nio/MappedByteBuffer.html)**。它燃烧得很快。下面是我为您整理的一个片段，它将缓冲区映射到文件，寻找到中间，然后向后搜索到换行符。这应该足以让你去吧？

我在自己的应用程序中有类似的代码（查找、读取、重复直到完成）， 在生产环境中对流进行基准测试，并将结果发布在我的博客上（`java.io`Geekomatic[帖子标记为“java.nio”](http://geekomatic.ch/tags/java.nio/)），其中包含原始数据、图表和所有内容。 `MappedByteBuffer`

两秒总结？ *基于我`MappedByteBuffer`的实现快了大约 275%。* YMMV。

为了处理大于 ~2GB 的文件，这是一个问题，因为 cast 和`.position(int pos)`，我制作了由`MappedByteBuffer`s 数组支持的分页算法。您需要在 64 位系统上工作才能处理大于 2-4GB 的文件，因为 MBB 使用操作系统的虚拟内存系统来发挥它们的魔力。

```
public class StusMagicLargeFileReader  {
    private static final long PAGE_SIZE = Integer.MAX_VALUE;
    private List<MappedByteBuffer> buffers = new ArrayList<MappedByteBuffer>();
    private final byte raw[] = new byte[1];

    public static void main(String[] args) throws IOException {
        File file = new File("/Users/stu/test.txt");
        FileChannel fc = (new FileInputStream(file)).getChannel(); 
        StusMagicLargeFileReader buffer = new StusMagicLargeFileReader(fc);
        long position = file.length() / 2;
        String candidate = buffer.getString(position--);
        while (position >=0 && !candidate.equals('\n')) 
            candidate = buffer.getString(position--);
        //have newline position or start of file...do other stuff    
    }
    StusMagicLargeFileReader(FileChannel channel) throws IOException {
        long start = 0, length = 0;
        for (long index = 0; start + length < channel.size(); index++) {
            if ((channel.size() / PAGE_SIZE) == index)
                length = (channel.size() - index *  PAGE_SIZE) ;
            else
                length = PAGE_SIZE;
            start = index * PAGE_SIZE;
            buffers.add(index, channel.map(READ_ONLY, start, length));
        }    
    }
    public String getString(long bytePosition) {
        int page  = (int) (bytePosition / PAGE_SIZE);
        int index = (int) (bytePosition % PAGE_SIZE);
        raw[0] = buffers.get(page).get(index);
        return new String(raw);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-15T21:17:45.380

我也有同样的问题。我正在尝试在已排序的文件中查找以某个前缀开头的所有行。

这是我编写的一种方法，主要是在这里找到的 Python 代码端口：[http ://www.logarithmic.net/pfh/blog/01186620415](http://www.logarithmic.net/pfh/blog/01186620415)

我已经对其进行了测试，但还没有彻底测试。但是，它不使用内存映射。

```
public static List<String> binarySearch(String filename, String string) {
    List<String> result = new ArrayList<String>();
    try {
        File file = new File(filename);
        RandomAccessFile raf = new RandomAccessFile(file, "r");

        long low = 0;
        long high = file.length();

        long p = -1;
        while (low < high) {
            long mid = (low + high) / 2;
            p = mid;
            while (p >= 0) {
                raf.seek(p);

                char c = (char) raf.readByte();
                //System.out.println(p + "\t" + c);
                if (c == '\n')
                    break;
                p--;
            }
            if (p < 0)
                raf.seek(0);
            String line = raf.readLine();
            //System.out.println("-- " + mid + " " + line);
            if (line.compareTo(string) < 0)
                low = mid + 1;
            else
                high = mid;
        }

        p = low;
        while (p >= 0) {
            raf.seek(p);
            if (((char) raf.readByte()) == '\n')
                break;
            p--;
        }

        if (p < 0)
            raf.seek(0);

        while (true) {
            String line = raf.readLine();
            if (line == null || !line.startsWith(string))
                break;
            result.add(line);
        }

        raf.close();
    } catch (IOException e) {
        System.out.println("IOException:");
        e.printStackTrace();
    }
    return result;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T11:56:41.843

我不知道任何具有该功能的库。但是，Java 中外部二进制搜索的正确代码应该类似于：

```
class ExternalBinarySearch {
final RandomAccessFile file;
final Comparator<String> test; // tests the element given as search parameter with the line. Insert a PrefixComparator here
public ExternalBinarySearch(File f, Comparator<String> test) throws FileNotFoundException {
    this.file = new RandomAccessFile(f, "r");
    this.test = test;
}
public String search(String element) throws IOException {
    long l = file.length();
    return search(element, -1, l-1);
}
/**
 * Searches the given element in the range [low,high]. The low value of -1 is a special case to denote the beginning of a file.
 * In contrast to every other line, a line at the beginning of a file doesn't need a \n directly before the line
 */
private String search(String element, long low, long high) throws IOException {
    if(high - low < 1024) {
        // search directly
        long p = low;
        while(p < high) {
            String line = nextLine(p);
            int r = test.compare(line,element);
            if(r > 0) {
                return null;
            } else if (r < 0) {
                p += line.length();
            } else {
                return line;
            }
        }
        return null;
    } else {
        long m  = low + ((high - low) / 2);
        String line = nextLine(m);
        int r = test.compare(line, element);
        if(r > 0) {
            return search(element, low, m);
        } else if (r < 0) {
            return search(element, m, high);
        } else {
            return line;
        }
    }
}
private String nextLine(long low) throws IOException {
    if(low == -1) { // Beginning of file
        file.seek(0);           
    } else {
        file.seek(low);
    }
    int bufferLength = 65 * 1024;
    byte[] buffer = new byte[bufferLength];
    int r = file.read(buffer);
    int lineBeginIndex = -1;

    // search beginning of line
    if(low == -1) { //beginning of file
        lineBeginIndex = 0;
    } else {
        //normal mode
        for(int i = 0; i < 1024; i++) {
        if(buffer[i] == '\n') {
            lineBeginIndex = i + 1;
            break;
        }
        }
    }
    if(lineBeginIndex == -1) {
        // no line begins within next 1024 bytes
        return null;
    }
    int start = lineBeginIndex;
        for(int i = start; i < r; i++) {
            if(buffer[i] == '\n') {
                // Found end of line
                return new String(buffer, lineBeginIndex, i - lineBeginIndex + 1);
                return line.toString();
            }
        }
        throw new IllegalArgumentException("Line to long");
}
} 
```

请注意：我专门编写了这段代码：角落案例的测试还不够好，代码假设没有单行大于 64K，等等。

我还认为建立行开始的偏移量索引可能是一个好主意。对于 500 GB 的文件，该索引应存储在索引文件中。您应该使用该索引获得一个不那么小的常数因子，因为不需要在每个步骤中搜索下一行。

我知道这不是问题，但是构建一个前缀树数据结构，如 (Patrica) Tries（在磁盘/SSD 上）可能是进行前缀搜索的好主意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T03:06:46.593

这是您想要实现的目标的简单示例。我可能会首先索引文件，跟踪每个字符串的文件位置。我假设字符串由换行符（或回车符）分隔：

```
 RandomAccessFile file = new RandomAccessFile("filename.txt", "r");
    List<Long> indexList = new ArrayList();
    long pos = 0;
    while (file.readLine() != null)
    {
        Long linePos = new Long(pos);
        indexList.add(linePos);
        pos = file.getFilePointer();
    }
    int indexSize = indexList.size();
    Long[] indexArray = new Long[indexSize];
    indexList.toArray(indexArray); 
```

最后一步是在进行大量查找时转换为数组以稍微提高速度。我可能会将其转换`Long[]`为`long[]`也，但我没有在上面显示。最后是从给定索引位置读取字符串的代码：

```
 int i; // Initialize this appropriately for your algorithm.
    file.seek(indexArray[i]);
    String line = file.readLine();
            // At this point, line contains the string #i. 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-15T21:42:20.423

如果您正在处理一个 500GB 的文件，那么您可能希望使用比二进制搜索更快的查找方法 - 即基数排序，它本质上是散列的一种变体。执行此操作的最佳方法实际上取决于您的数据分布和查找类型，但如果您正在寻找字符串前缀，那么应该有一个很好的方法来执行此操作。

我发布了一个整数的基数排序解决方案的示例，但是您可以使用相同的想法 - 基本上是通过将数据分成桶来减少排序时间，然后使用 O(1) 查找来检索相关的数据桶.

```
Option Strict On
Option Explicit On

Module Module1

Private Const MAX_SIZE As Integer = 100000
Private m_input(MAX_SIZE) As Integer
Private m_table(MAX_SIZE) As List(Of Integer)
Private m_randomGen As New Random()
Private m_operations As Integer = 0

Private Sub generateData()
    ' fill with random numbers between 0 and MAX_SIZE - 1
    For i = 0 To MAX_SIZE - 1
        m_input(i) = m_randomGen.Next(0, MAX_SIZE - 1)
    Next

End Sub

Private Sub sortData()
    For i As Integer = 0 To MAX_SIZE - 1
        Dim x = m_input(i)
        If m_table(x) Is Nothing Then
            m_table(x) = New List(Of Integer)
        End If
        m_table(x).Add(x)
        ' clearly this is simply going to be MAX_SIZE -1
        m_operations = m_operations + 1
    Next
End Sub

 Private Sub printData(ByVal start As Integer, ByVal finish As Integer)
    If start < 0 Or start > MAX_SIZE - 1 Then
        Throw New Exception("printData - start out of range")
    End If
    If finish < 0 Or finish > MAX_SIZE - 1 Then
        Throw New Exception("printData - finish out of range")
    End If
    For i As Integer = start To finish
        If m_table(i) IsNot Nothing Then
            For Each x In m_table(i)
                Console.WriteLine(x)
            Next
        End If
    Next
End Sub

' run the entire sort, but just print out the first 100 for verification purposes
Private Sub test()
    m_operations = 0
    generateData()
    Console.WriteLine("Time started = " & Now.ToString())
    sortData()
    Console.WriteLine("Time finished = " & Now.ToString & " Number of operations = " & m_operations.ToString())
    ' print out a random 100 segment from the sorted array
    Dim start As Integer = m_randomGen.Next(0, MAX_SIZE - 101)
    printData(start, start + 100)
End Sub

Sub Main()
    test()
    Console.ReadLine()
End Sub

End Module 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-09-01T05:54:45.657

我发布了一个要点[https://gist.github.com/mikee805/c6c2e6a35032a3ab74f643a1d0f8249c](https://gist.github.com/mikee805/c6c2e6a35032a3ab74f643a1d0f8249c)

这是一个相当完整的例子，基于我在堆栈溢出和一些博客上发现的内容，希望其他人可以使用它

```
import static java.nio.file.Files.isWritable;
import static java.nio.file.StandardOpenOption.READ;
import static org.apache.commons.io.FileUtils.forceMkdir;
import static org.apache.commons.io.IOUtils.closeQuietly;
import static org.apache.commons.lang3.StringUtils.isBlank;
import static org.apache.commons.lang3.StringUtils.trimToNull;

import java.io.File;
import java.io.IOException;
import java.nio.Buffer;
import java.nio.MappedByteBuffer;
import java.nio.channels.FileChannel;
import java.nio.file.Path;

public class FileUtils {

    private FileUtils() {
    }

    private static boolean found(final String candidate, final String prefix) {
        return isBlank(candidate) || candidate.startsWith(prefix);
    }

    private static boolean before(final String candidate, final String prefix) {
        return prefix.compareTo(candidate.substring(0, prefix.length())) < 0;
    }

    public static MappedByteBuffer getMappedByteBuffer(final Path path) {
        FileChannel fileChannel = null;
        try {
            fileChannel = FileChannel.open(path, READ);
            return fileChannel.map(FileChannel.MapMode.READ_ONLY, 0, fileChannel.size()).load();
        } 
        catch (Exception e) {
            throw new RuntimeException(e);
        }
        finally {
            closeQuietly(fileChannel);
        }
    }

    public static String binarySearch(final String prefix, final MappedByteBuffer buffer) {
        if (buffer == null) {
            return null;
        }
        try {
            long low = 0;
            long high = buffer.limit();
            while (low < high) {
                int mid = (int) ((low + high) / 2);
                final String candidate = getLine(mid, buffer);
                if (found(candidate, prefix)) {
                    return trimToNull(candidate);
                } 
                else if (before(candidate, prefix)) {
                    high = mid;
                } 
                else {
                    low = mid + 1;
                }
            }
        } 
        catch (Exception e) {
            throw new RuntimeException(e);
        } 
        return null;
    }

    private static String getLine(int position, final MappedByteBuffer buffer) {
        // search backwards to the find the proceeding new line
        // then search forwards again until the next new line
        // return the string in between
        final StringBuilder stringBuilder = new StringBuilder();
        // walk it back
        char candidate = (char)buffer.get(position);
        while (position > 0 && candidate != '\n') {
            candidate = (char)buffer.get(--position);
        }
        // we either are at the beginning of the file or a new line
        if (position == 0) {
            // we are at the beginning at the first char
            candidate = (char)buffer.get(position);
            stringBuilder.append(candidate);
        }
        // there is/are char(s) after new line / first char
        if (isInBuffer(buffer, position)) {
            //first char after new line
            candidate = (char)buffer.get(++position);
            stringBuilder.append(candidate);
            //walk it forward
            while (isInBuffer(buffer, position) && candidate != ('\n')) {
                candidate = (char)buffer.get(++position);
                stringBuilder.append(candidate);
            }
        }
        return stringBuilder.toString();
    }

    private static boolean isInBuffer(final Buffer buffer, int position) {
        return position + 1 < buffer.limit();
    }

    public static File getOrCreateDirectory(final String dirName) { 
        final File directory = new File(dirName);
        try {
            forceMkdir(directory);
            isWritable(directory.toPath());
        } 
        catch (IOException e) {
            throw new RuntimeException(e);
        }
        return directory;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-12-09T18:20:30.217

我有类似的问题，所以我从这个线程中提供的解决方案创建了（Scala）库：

[https://github.com/avast/BigMap](https://github.com/avast/BigMap)

它包含用于在此排序文件中排序大文件和二进制搜索的实用程序...

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-04-10T03:09:26.650

如果你真的想尝试内存映射文件，我找到了一个[关于如何](http://www.developer.com/java/other/article.php/1548681)在 Java nio 中使用内存映射的教程。

# model-view-controller - Web 版本的 MVC 与传统的 MVC 有什么不同？

> ID：736560
> 
> 赞同：2
> 
> 时间：2009-04-10T02:41:37.200
> 
> 标签：model-view-controller, oop

我已经在 Web 上完成了大量关于 MVC 的工作，我们正在我的 OOP 课程中学习它。我看到了一些差异，我不知道这是因为 Web 版本的 MVC 模式与传统模式不同，还是我误解了它。

据我了解，模型（您的平面文件、RDBMS 等）是一个通用的数据存储对象。视图（浏览器、HTML 等）是用户与之交互的内容，控制器在用户操作和数据之间进行调解。控制器是最特定领域的部分，它管理视图，告诉模型它需要什么，并告诉视图要显示什么。

在课堂上，我们有与我刚刚描述的相匹配的视图，模型包含一个视图列表，以便它可以在数据更改时更新它们，控制器只是将用户的操作映射到对模型和特定对象的调用（这可能会要求模型更新视图）。最终发生的情况是，大部分业务逻辑都在模型中，并且与正在编写的模拟或应用程序密切相关，而控制器则被简化为命令和方法之间的映射工具。

您对此有何看法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T03:12:42.040

在非 Web 界面中，控制器处理来自键盘和鼠标之类的输入，根据这些输入选择要渲染的视图以及要在模型中进行的更改。视图和模型可以更紧密地联系起来，因为视图可以直接向模型实体注册回调以获取更改通知，从而直接根据模型的更改进行更新，而不是由控制器更新。

在网络世界中，视图必然与模型更加分离。它必须通过控制器操作进行操作，因为它无法直接访问模型（在呈现并交付给浏览器之后）。尽管控制器必须处理的唯一“输入”是浏览器请求，但控制器在此环境中扮演着更大的角色。从某种意义上说，过去与非 Web MVC 中的视图发生的耦合被转移到了代表它的控制器。由于没有来自模型的回调来响应（让我们暂时忘记“推送”技术），更多的业务代码被合并到控制器中，因为它是对业务流程进行建模的自然场所，尽管可能不是验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T02:46:29.170

在我的理解中，Web MVC 模式中的控制器只是模型和视图之间的桥梁，它们只是从模型中获取数据并将其传递给视图。Model 和 View 相互独立，从不相互交谈。

# php - 如何搜索/总结我的 PHP 结果？

> ID：736563
> 
> 赞同：0
> 
> 时间：2009-04-10T02:44:10.690
> 
> 标签：php, json, twitter

我从 Twitter API 中检索了一系列对象，我想对它们进行总结。我最熟悉分析 SQL 查询的结果，但给出了一系列这样的对象：

```
array(9) { 
    ["results"]=> array(1) { 
        [0]=> array(9) { 
            ["text"]=> string(14) "4.2 #runlogger" 
            ["to_user_id"]=> NULL 
            ["from_user"]=> string(13) "alexmcpherson" 
            ["id"]=> int(1459499489) 
            ["from_user_id"]=> int(4647988) 
            ["iso_language_code"]=> string(2) "it" 
            ["source"]=> string(59) "<a href="http://twitter.com/">web</a>" 
            ["profile_image_url"]=> string(59) "http://static.twitter.com/images/default_profile_normal.png" 
            ["created_at"]=> string(31) "Sun, 05 Apr 2009 23:10:45 +0000" 
            } } 
["since_id"]=> int(0)
["max_id"]=> int(1461841556) 
["refresh_url"]=> string(35) "?since_id=1461841556&q=%23runlogger" 
["results_per_page"]=> int(15) 
["total"]=> int(1) 
["completed_in"]=> float(0.073063) 
["page"]=> int(1) 
["query"]=> string(12) "%23runlogger" 
} 
```

是否有可能以某种方式说“对于'from_user = $ whoever'的每个对象，统计'text'字段，减去#runlogger”？一旦有了我认为的大规模想法，我就可以弄清楚代码，但不确定如何以一般方式开始。我会将“文本”字段的每个实例设置为一个变量，然后将这些变量添加到一个数组或其他东西中吗？

我是一个快速学习的人，但希望在这个问题上得到一些指导。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T02:54:00.447

假设您将其分配给数组 $array1

```
foreach($array1['results'] as $currentResult) {

     if($currentResult['from_user'] == $whoever) {

         $strippedTexts = explode(" ", $currentResult['text']);

         $strText .= $strippedTexts[0];

     }

}

echo $strText; 
```

问候

# c# - 树结构的序列化/反序列化

> ID：736568
> 
> 赞同：5
> 
> 时间：2009-04-10T02:46:45.067
> 
> 标签：c#, serialization, datacontractserializer, datacontract

我试图找出保存（序列化）然后打开（反序列化）树结构的最佳方法。我的结构由具有不同属性的各种对象类型组成，但每个对象类型都继承自一个基本的抽象“节点”类。

每个节点都有唯一的 ID (GUID)，并有一个 AddSuperNode(Node nd) 方法来设置节点的父节点。这反过来又调用了其他方法，允许父节点知道它有哪些子节点。但是，一些节点也使用**AddAuxSuperNode()**方法将次父节点添加到节点。

我使用的是二进制序列化，但现在我想我想使用一些我有更多控制权的东西，并且序列化的数据更容易访问。我还想在反序列化时保留类型信息，并能够序列化私有值。所以**DataContractSerializer**似乎是最好的方法。

我不能直接序列化根节点，因为**节点**有多个父节点。我不想创建重复的对象。所以看起来我需要将树解构为一个平面列表，然后将其序列化。然后在序列化该列表之后重建树。这听起来对吗？

就像我之前所说的，每个**节点**都有一个唯一的 GUID 标识符，但是现在节点直接引用它们的父/子，并且不存储它们的 id。除了直接引用之外，我还可以更新**AddSuperNode()**和**AddAuxSuperNode()**方法来更新要序列化的父 ID 列表。但我宁愿只在对象被序列化时更新/创建这个列表。所以我正在考虑在节点中创建一个**UpdateSuperNodeIDRefs()**方法，该方法将在序列化之前被调用。

以下是我打算为这个结构的序列化和反序列化做的事情。谁能建议一种更好/更清洁/更有效的方法来做到这一点？

**序列化**

1）提供树结构的根节点

2) 将树结构分解为一个平面**Dictionary(Guid id,Node nd)**，其中**id**是**nd**的**guid**。

 **3) 调用**UpdateSuperNodeIDRefs()**；为每个节点更新它为其父节点保存的 ID。

4)使用**DataContractSerializer**序列化节点**字典**

 ****反序列化**

1）反序列化节点**字典**

2）遍历**Dictionary中的每个****节点**，将每个节点重新连接到它们的父节点。对于存储的任何父 ID ，在**字典**中找到具有匹配 ID的相应**节点，调用****AddSuperNode()**或**AddAuxSuperNode()**以将节点重新连接到其父节点

 ******3）从字典中的任何**节点找到结构的根**

**4)返回**根节点

 *** * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-10T07:48:45.747

如果一个节点有多个父节点，那么它不是树；大概是一张*图*。但是 - 不要担心；`DataContractSerializer`可以为您处理：

```
using System;
using System.IO;
using System.Runtime.Serialization;

[DataContract]
class Node {
    [DataMember]
    public Node AnotherNode { get; set; }
}

static class Program
{
    static void Main()
    {
        Node a = new Node(), b = new Node();
        // make it a cyclic graph, to prove reference-mode
        a.AnotherNode = b;
        b.AnotherNode = a;

        // the preserveObjectReferences argument is the interesting one here...
        DataContractSerializer dcs = new DataContractSerializer(
            typeof(Node), null, int.MaxValue, false, true, null);
        using (MemoryStream ms = new MemoryStream())
        {
            dcs.WriteObject(ms, a);
            ms.Position = 0;
            Node c = (Node) dcs.ReadObject(ms);
            // so .AnotherNode.Another node should be back to "c"
            Console.WriteLine(ReferenceEquals(c, c.AnotherNode.AnotherNode));
        }

    }
} 
```

# android - 在 Android 应用程序中使用 Intent 来显示另一个活动

> ID：736571
> 
> 赞同：196
> 
> 时间：2009-04-10T02:48:27.420
> 
> 标签：android, android-intent, android-activity

在我的 Android 应用程序中，我有两个活动类。我在第一个按钮上有一个按钮，我想在单击它时显示第二个按钮，但出现错误。以下是课程：

```
public class FirstActivity extends Activity {

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    Button orderButton = (Button)findViewById(R.id.order);

    orderButton.setOnClickListener(new View.OnClickListener() {

      @Override
      public void onClick(View view) {
        Intent intent = new Intent(FirstActivity.this, OrderScreen.class);
        startActivity(intent);
      }

    });
  }
} 
```

单击按钮时应显示的第二个类，但从不显示：

```
public class OrderScreen extends Activity {

  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.order);

    Button orderButton = (Button) findViewById(R.id.end);

    orderButton.setOnClickListener(new View.OnClickListener() {

      @Override
      public void onClick(View view) {
        finish();
      }

    });
  }
} 
```

如何创建一个显示第二个活动的按钮？

* * *

## 回答 #1

> 赞同：177
> 
> 时间：2009-04-10T15:22:34.890

问题是**OrderScreen** `Activity`没有添加到[AndroidManifest.xml](http://developer.android.com/guide/topics/manifest/manifest-intro.html)中。一旦我将其添加为应用程序节点，它就可以正常工作。

```
<activity android:name=".OrderScreen" /> 
```

* * *

## 回答 #2

> 赞同：162
> 
> 时间：2009-09-12T18:19:25.420

将此行添加到您的 AndroidManifest.xml：

```
<activity android:name=".OrderScreen" /> 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-05-19T18:22:28.500

---- **FirstActivity.java** -----

```
 package com.mindscripts.eid;
    import android.app.Activity;
    import android.content.Intent;
    import android.os.Bundle;
    import android.view.View;
    import android.view.View.OnClickListener;
    import android.widget.Button;

public class FirstActivity extends Activity {

protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    Button orderButton = (Button) findViewById(R.id.order);
    orderButton.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            Intent intent = new Intent(FirstActivity.this,OrderScreen.class);
            startActivity(intent);
        }
    });

 }
} 
```

* * *

--- **OrderScreen.java** ---

```
 package com.mindscripts.eid;

    import android.app.Activity;
    import android.os.Bundle;
    import android.view.View;
    import android.view.View.OnClickListener;
    import android.widget.Button;

    public class OrderScreen extends Activity {
@Override

protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.second_class);
    Button orderButton = (Button) findViewById(R.id.end);
    orderButton.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            finish();
        }
    });

 }
} 
```

* * *

--- **AndroidManifest.xml** ----

```
 <?xml version="1.0" encoding="utf-8"?>
    <manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="com.mindscripts.eid"
  android:versionCode="1"
  android:versionName="1.0">

<application android:icon="@drawable/icon" android:label="@string/app_name">
    <activity android:name=".FirstActivity"
              android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity android:name=".OrderScreen"></activity>
</application> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-20T19:04:56.773

使用此代码：

```
Intent intent=new Intent(context,SecondActivty.class);
startActivity(intent);
finish(); 
```

上下文：引用当前活动上下文，

请确保您已在 android 清单文件中添加了活动。

以下代码用于在 android 清单文件中添加活动

```
<Activity name=".SecondActivity">
</Activity> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-02-21T10:15:43.690

```
<activity android:name="[packagename optional].ActivityClassName"></activity> 
```

只需添加我们想要切换到的活动应该放在清单文件中

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-06T10:24:38.223

当您在 android 文件中创建任何活动时，您必须在 AndroidManifest.xml 中指定它，例如

```
<uses-sdk android:minSdkVersion="8" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:name=".MyCreativityActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

     <activity android:name=".OrderScreen"></activity>

</application> 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-02-09T08:34:26.610

```
b1 = (Button) findViewById(R.id.click_me);
        b1.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {

                Intent i = new Intent(MainActivity.this, SecondActivity.class);
                startActivity(i);

            }
        }); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-04-01T06:17:45.947

在清单文件中添加活动

```
<activity android:name=".OrderScreen" /> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-09-24T06:50:35.687

在清单中

```
<activity android:name=".OrderScreen" /> 
```

在必须放置意图代码的 Java 代码中

```
startActivity(new Intent(CurrentActivity.this, OrderScreen.class); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-02-11T01:52:22.880

您可以使用执行调用的视图的上下文。例子：

```
Button orderButton = (Button)findViewById(R.id.order);

orderButton.setOnClickListener(new View.OnClickListener() {

  @Override
  public void onClick(View view) {
    Intent intent = new Intent(/*FirstActivity.this*/ view.getContext(), OrderScreen.class);
    startActivity(intent);
  }

}); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-06-09T12:46:06.630

```
Intent i = new Intent("com.Android.SubActivity");
startActivity(i); 
```

# ssh - 如何让 ssh 使用不同的 id_dsa

> ID：736572
> 
> 赞同：8
> 
> 时间：2009-04-10T02:48:32.613
> 
> 标签：ssh, key

连接到一个特定主机时，我如何说服 id_dsa 未存储在 ~/.ssh 中。

显而易见的问题是为什么。答案是这个密钥更敏感，需要密码保护，而另一个用于自动化。

虽然这不是编程问题，但得知这需要编程解决方案我不会感到惊讶。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-10T03:03:07.430

你可以使用一个方便的技巧让它变得非常简单，奇怪的是，我刚刚在 30 分钟前和一个朋友讨论过这个问题。

*~/.ssh/config*

```
身份文件 ~/.ssh/ident/%r@%h
身份文件 ~/.ssh/id_rsa
身份文件 ~/.ssh/id_dsa

```

这使得使用后备模式变得非常容易，因为选项从上到下运行。

然后为“Bob@someHost”指定一个特定的键，你只需要创建文件

```
~/.ssh/ident/Bob@someHost

```

它会在登录该主机时首先尝试。

如果找不到文件，或者key被拒绝，它会尝试下一个，在这种情况下，

```
~/.ssh/id_rsa

```

这种技术的好处是您不必每次添加另一个主机时都添加新条目，您所要做的就是在正确的位置创建密钥文件，其余的会自动完成。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-10T02:56:26.587

在你的`.ssh/config`，设置如下：

```
Host somehost
     IdentityFile /path/to/extra_secret_key 
```

我有一台主机`IdentityFile`设置为`~/.ssh/iddsa_aux`，但参数应该接受任何路径名。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T02:55:30.273

从 ssh 手册页：

```
 -i identity_file
         Selects a file from which the identity (private key) for RSA or
         DSA authentication is read.  The default is ~/.ssh/identity for
         protocol version 1, and ~/.ssh/id_rsa and ~/.ssh/id_dsa for pro-
         tocol version 2\.  Identity files may also be specified on a per-
         host basis in the configuration file.  It is possible to have
         multiple -i options (and multiple identities specified in config-
         uration files). 
```

# java - 查询 Java 数据结构

> ID：736573
> 
> 赞同：3
> 
> 时间：2009-04-10T02:48:55.607
> 
> 标签：java, sql, data-structures, collections, jakarta-ee

有什么方法可以在 Java 数据结构上执行类似 SQL 的查询或过滤？

我想通过其中包含的对象的字段过滤 ArrayList 和 HashMap 中的对象。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T08:55:07.973

您可能喜欢[Quaere](http://quaere.codehaus.org/)，它是一种相当丰富的 java 对象图查询语言：

```
Integer[] numbers={5, 4, 1, 3, 9, 8, 7, 2, 0};
Iterable<Integer> lowNumbers=
    from("n").in(numbers).
    where(lt("n",5).
    select("n"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T03:05:15.227

没有标准的类似 SQL 的语言，但 apache [commons 集合有](http://commons.apache.org/collections/api-release/)一个 [过滤器](http://commons.apache.org/collections/api-release/org/apache/commons/collections/CollectionUtils.html#filter(java.util.Collection,%20org.apache.commons.collections.Predicate))方法，可以满足您的需求。自己动手也不难，

```
public <T> Collection<T> filter (Collection<T> c, Condition<T> condition) {
  ArrayList<T> list = new ArrayList<T>():
  for (T t: c){ 
        if (condition.isSatisfied(t)) { list.add(t); } 
  } 
  return list;
 }

public interface Condition<T> {
   public boolean isSatisfied(T t);
 } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T03:03:43.140

是和不是。

不，不是使用类似 SQL 的语法。

是的，带有过滤器函子。特别是，请查看 Apache Commons Collections、CollectionsUtils.filter() 函数，该函数将 Predicate 对象应用于 Collection。

您编写谓词，Apache 类负责其余的工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-10T03:08:17.263

规范的方法是迭代数据结构并将所需的对象插入到新的对象中。不幸的是，Java 没有列表推导或一流的函数。[但是我们可以使用函数式 Java](http://functionaljava.org)之类的库来模拟它们：

```
import fj.F;
import fj.data.List;
import static fj.data.List.list;
import static fj.pre.Show.listShow;
import static fj.pre.Show.stringShow;

List<String> myList = list("one", "two", "three").filter(
  new F<String, Boolean>() {
    public Boolean f(String s) {
      return s.contains("e");
    }
  });

listShow(stringShow).print(myList); 
```

这将打印`["one", "three"]`到标准输出。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-10T03:05:17.300

有许多利用 XPath 或 XQuery 的解决方案。对于初学者来说，看看[Jaxen](http://jaxen.codehaus.org/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T21:08:54.467

一个相当极端的解决方案可能是使用某种 ORM 将您的 Java 对象映射到实际的 SQL 数据库中，然后使用实际的 SQL 或类似 SQL 的语言（如 Hibernate 的 HQL）来精确地查询您的对象。

当然，我只会认真考虑，如果我真的打算将对象持久保存在数据库中，否则就过分了。

# asp.net-mvc - 不允许强类型的用户控件视图 asp.net mvc？

> ID：736574
> 
> 赞同：1
> 
> 时间：2009-04-10T02:50:10.847
> 
> 标签：asp.net-mvc

这是设置 - 我有一个列出产品的视图。在同一页面上，我有一个列出类别的用户控件视图。

我将产品列表传递给视图，如下所示：

```
return View(myProducts); 
```

用户控件视图通过 ViewData["Category"] 获取它需要的数据

现在，如果我尝试使用这样的强类型用户控件视图：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<IEnumerable<myData.Models.Category>>" %> 
```

我收到此错误：

传入字典的模型项的类型为“System.Collections.Generic.List `1[myData.Models.Product]' but this dictionary requires a model item of type 'System.Collections.Generic.IEnumerable`1[myData.Models.Category]”。

用户控件视图似乎很困惑，因为我将“产品”列表传递给视图。因此，如果我像这样删除强类型：

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl" %> 
```

一切正常。

那么，强类型的用户控件视图是不允许的吗？还是我只是做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T02:56:41.877

A 类型的泛型列表不能分配给 B 类型的泛型列表（其中 B 派生自 A）。这是 .Net 中所有通用集合的一般规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T03:00:37.110

渲染局部视图时，使用 ViewData["Category"] 作为传递给控件的模型。

```
<% Html.RenderPartial( "MyUserControl", ViewData["Category"], ViewData ); %> 
```

# java - 超类不调用被覆盖的方法吗？

> ID：736579
> 
> 赞同：6
> 
> 时间：2009-04-10T02:53:12.540
> 
> 标签：java, oop, polymorphism, overriding

我有以下课程：

```
class foo {
    public void a() {
        print("a");
    }
    public void b() {
        a();
    }
}

class bar extends foo {
    public void a() {
        print("overwritten a");
    }
} 
```

当我现在调用 bar.b() 时，我希望它调用 foo 中的重写方法 a()。但是，它确实打印“a”。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-10T04:05:32.787

您的两个课程是否在不同的包中？您的 foo 类方法是公开的、受保护的、私有的还是包本地的？显然，如果他们是私人的，这将行不通。也许不太明显的是，如果它们是本地包（即没有公共/受保护/私有范围），那么您只能在与原始类在同一个包中时覆盖它们。

例如：

```
包装原件；
公共类 Foo {
  void a() { System.out.println("A"); }
  公共无效 b() { a(); }
}

包装另一个；
公共类酒吧扩展 original.Foo {
  void a() { System.out.println("覆盖的 A"); }
}

包装另一个；
公共类程序{
  公共静态无效主要（字符串[]参数）{
    酒吧酒吧 = 新酒吧（）；
    bar.b();
  }
}

```

在这种情况下，您仍然会得到“A”。如果你在 Foo 中声明原始的 a() 方法为 public 或 protected，你会得到你期望的结果。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-10T03:16:55.867

可能是您正在尝试使用静态方法，因为它们不会被覆盖，因此无法正常工作。

一个很好的检查方法是将 @Override 注释添加到 bar.a() 并查看编译器是否给你一个错误 a() 实际上并没有覆盖任何东西

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-10T03:03:17.600

当我运行以下命令时：

```
public class Program {
    public static void main(String[] args) {
        bar b = new bar();
        b.b();
    }
}

class foo {
    public void a() {
       System.out.printf("a");
    }
    public void b() {
        a();
    }
}

class bar extends foo {
    public void a() {
        System.out.printf("overwritten a");
    }
} 
```

我得到以下输出：

```
overwritten a 
```

这是我希望看到的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T03:16:50.080

方法是否定义为静态的？这是我能看到得到这个结果的唯一方法。我在这里找到了一个很好的解释：http: [//faq.javaranch.com/view?OverridingVsHiding](http://faq.javaranch.com/view?OverridingVsHiding)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T03:53:31.723

如果您来自 C# 或其他必须显式声明虚函数和/或覆盖函数的语言，您可能会感到困惑。

在 Java 中，所有实例函数都是虚拟的，并且可以被覆盖——除非它们被声明为私有和/或最终的。

不需要指定新的 @Override 注释来这样做，添加注释只是指定您的意图是覆盖，如果不是覆盖，将导致警告或错误。（例如，如果您不小心拼错了方法名称）。

Andrew 的示例显示了这应该如何工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-07-15T04:31:00.347

从马口中：

[http://download.oracle.com/javase/tutorial/java/IandI/override.html](http://download.oracle.com/javase/tutorial/java/IandI/override.html)

“被调用的覆盖方法的版本是子类中的版本。被调用的隐藏方法的版本取决于它是从超类调用还是从子类调用。”

因此，如果它们都是静态方法，并且您从超类调用该方法，则调用的是超类方法，而不是子类方法。所以真的，没有发生压倒一切。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-10-31T15:00:14.667

当我在开发一个 Android 程序时，我的 Java 类也遇到了同样的问题。事实证明，问题不在于类，而在于 Android 框架处理屏幕输出的方式。

例如，如果输出是在父类的 onCreate() 方法中编程的，Android 无法从第一个子类之外的子类中正确获取被覆盖方法的输出。老实说，我不了解整个方法调用顺序。

为了解决这个问题，我只是在 onResume() 中对输出进行了编程，现在它似乎工作正常。

# java - Windows 徽标 (TM) 认证应用程序是否更难用 Java 编写？

> ID：736580
> 
> 赞同：1
> 
> 时间：2009-04-10T02:53:52.633
> 
> 标签：java, windows, installation, desktop-application

使用我们的软件作为组件的第三方供应商将 Windows 徽标认证视为重要的选择标准。鉴于部署 Java 程序的灵活性，90% 的要求很容易满足。一些直接的困难出现了：

*   使用资源字符串标记 jar 文件以获取版本信息。
*   从属性文件移动到 .INI 文件
*   库不能很好地支持短路径名称/长路径名称/UNC
*   外观和感觉要求

这些将需要一些认真的重新编码来解决。我可能对规范的解释过于仔细。我发现了一个获得[Windows 2000 认证](http://cert.veritest.com/ReportFiles/Pivotal_eRelationship_sReport.pdf)的应用程序的好例子。在这种情况下，外观仅指我们提供的任何可见安装程序。甚至规范本身也暗示了描述中并未真正包含在需求标题中的内容。

1.5 [应用程序不应读取或写入 Win.ini、System.ini、Autoexec.bat 或 Config.sys](http://msdn.microsoft.com/en-us/library/aa372825(VS.85).aspx)

摘抄：

如果您的应用程序使用了您不想放入注册表的信息，请创建一个私有初始化文件并将其放置在包含应用程序可执行文件的目录中。通过使用 Windows Installer 安装应用程序，您可以轻松管理*私有 .ini 文件的安装，以及在现有 .ini 文件中添加或删除信息。*

对于任何反馈，我们都表示感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T06:23:21.897

对于外观和感觉，请在`main()`函数开始时调用它：

```
 log.info("Setting java look and feel");
    try {
        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
    } catch (Exception e) {
        log.warn("Could not set system look and feel", e);
    }
    // Make sure we have nice window decorations.
    JFrame.setDefaultLookAndFeelDecorated(true);
    JDialog.setDefaultLookAndFeelDecorated(true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T11:10:14.107

请注意，不应将 INI 文件*示例视为强制要求。*您所说的“标题”实际上是需求本身。这样做的原因是规范旨在（除其他外）防止应用程序安装相互干扰。迁移到私有配置（无论是在文件系统中还是在注册表中）支持这一点。

事实上，目前的建议不再是 INI 文件，而是注册表中的小部分配置，`%APPDATA%`如果你有很多 XML 文件的话。

# javascript - 使用 JavaScript 向 JSON 对象添加新属性（元素）

> ID：736590
> 
> 赞同：520
> 
> 时间：2009-04-10T03:00:22.820
> 
> 标签：javascript, json

如何使用 JavaScript 向 JSON 对象添加新属性（元素）？

* * *

## 回答 #1

> 赞同：698
> 
> 时间：2009-04-10T03:03:54.947

JSON 代表 JavaScript 对象表示法。JSON 对象实际上是一个尚未转换为它所代表的对象的字符串。

要将属性添加到 JS 中的现有对象，您可以执行以下操作。

```
object["property"] = value; 
```

或者

```
object.property = value; 
```

如果您提供一些额外的信息，例如您需要在上下文中做什么，您可能会得到更量身定制的答案。

* * *

## 回答 #2

> 赞同：207
> 
> 时间：2012-01-17T03:38:59.057

```
var jsonObj = {
    members: 
           {
            host: "hostName",
            viewers: 
            {
                user1: "value1",
                user2: "value2",
                user3: "value3"
            }
        }
}

var i;

for(i=4; i<=8; i++){
    var newUser = "user" + i;
    var newValue = "value" + i;
    jsonObj.members.viewers[newUser] = newValue ;

}

console.log(jsonObj); 
```

* * *

## 回答 #3

> 赞同：165
> 
> 时间：2009-04-10T03:04:59.827

JSON 对象只是一个 javascript 对象，因此 Javascript 是一种基于原型的语言，您所要做的就是使用点符号来处理它。

```
mything.NewField = 'foo'; 
```

* * *

## 回答 #4

> 赞同：100
> 
> 时间：2018-10-14T23:07:51.800

从 2015 年开始使用 ECMAScript，您可以使用传播语法（…三个点）：

```
let  people = { id: 4 ,firstName: 'John'};
people = { ...people, secondName: 'Fogerty'}; 
```

它允许您添加子对象：

```
people = { ...people, city: { state: 'California' }}; 
```

结果将是：

```
{  
   "id": 4,
   "firstName": "John",
   "secondName": "Forget",
   "city": {  
      "state": "California"
   }
} 
```

您还可以合并对象：

```
var mergedObj = { ...obj1, ...obj2 }; 
```

* * *

## 回答 #5

> 赞同：79
> 
> 时间：2010-11-26T12:56:34.840

感谢这篇文章。我想添加一些有用的东西。

对于IE来说，很好用

```
object["property"] = value; 
```

语法，因为 IE 中的一些特殊词可能会给您一个错误。

一个例子：

```
object.class = 'value'; 
```

这在 IE 中失败，因为“**类**”是一个特殊词。我花了几个小时来处理这个。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2017-08-24T12:54:50.073

您也可以使用`Object.assign`from `ECMAScript 2015`。它还允许您一次添加嵌套属性。例如：

```
const myObject = {};

Object.assign(myObject, {
    firstNewAttribute: {
        nestedAttribute: 'woohoo!'
    }
}); 
```

Ps：这不会覆盖具有分配属性的现有对象。相反，它们将被添加。但是，如果您为现有属性分配一个值，那么它将被覆盖。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-10-26T01:30:10.593

```
extend: function(){
    if(arguments.length === 0){ return; }
    var x = arguments.length === 1 ? this : arguments[0];
    var y;

    for(var i = 1, len = arguments.length; i < len; i++) {
        y = arguments[i];
        for(var key in y){
            if(!(y[key] instanceof Function)){
                x[key] = y[key];
            }
        }           
    };

    return x;
} 
```

扩展多个 json 对象（忽略函数）：

```
extend({obj: 'hej'}, {obj2: 'helo'}, {obj3: {objinside: 'yes'}}); 
```

将产生单个 json 对象

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2019-11-29T08:21:40.383

您还可以直接在对象文字中动态添加带有变量的属性。

```
const amountAttribute = 'amount';
const foo = {
                [amountAttribute]: 1
            };
foo[amountAttribute + "__more"] = 2; 
```

结果是：

```
{
    amount: 1, 
    amount__more: 2
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-03-27T14:10:32.983

您还可以使用[扩展](http://api.jquery.com/jQuery.extend/)功能将新的 json 对象添加到您的 json 中，

```
var newJson = $.extend({}, {my:"json"}, {other:"json"});
// result -> {my: "json", other: "json"} 
```

扩展函数的一个很好的选择是递归合并。只需添加真值作为第一个参数（阅读文档以获取更多选项）。例子，

```
var newJson = $.extend(true, {}, {
    my:"json",
    nestedJson: {a1:1, a2:2}
}, {
    other:"json",
    nestedJson: {b1:1, b2:2}
});
// result -> {my: "json", other: "json", nestedJson: {a1:1, a2:2, b1:1, b2:2}} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-04-25T21:07:01.507

jquery`$.extend()`的**用法**，如下所示：

```
token = {_token:window.Laravel.csrfToken};
data = {v1:'asdass',v2:'sdfsdf'}
dat = $.extend(token,data); 
```

我希望你为他们服务。

# firefox - 在 Firefox 扩展中如何保存在浏览器窗口中打开的 pdf 的副本

> ID：736601
> 
> 赞同：0
> 
> 时间：2009-04-10T03:05:12.200
> 
> 标签：firefox, pdf

我有一个 Firefox 扩展，在某些情况下，当用户导航到 PDF 时，我想保存该文件的副本。下载 PDF 时这很容易（因为我可以使用 nsIObserverService 获取文件），但是当使用 Adob​​e Reader 插件在浏览器中打开 PDF 时，如果不再次下载，我将看不到如何获取文件。有任何想法吗？

该插件或 firefox 似乎将 pdf 包装在 html 中，其中包含带有 pdf 的单个 EMBED 标记。所以我可以通过 doc.embeds[0] 获取嵌入的对象，但不知道是否有任何可用的接口来做任何事情。

另一种方法是使用类似 nsIObserverService 的东西来通知何时检索到文件以供查看 - 但我不知道这是否可能？

我不想简单地获取 url 并重新检索它，因为它有时不再可用，已经从 web 应用程序提供。

谢谢！

更新：澄清一下，我希望我的 Firefox 扩展在代码中执行此操作，而不是作为用户按 CTRL+S。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T04:29:47.143

如果使用 Adob​​e Reader 插件打开 pdf，您只需单击阅读器工具栏上的保存图标即可。这是最简单的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-05T11:47:23.507

按**Ctrl+S**
在弹出的窗口中选择保存文件的位置，然后按保存。

# .net - 如何反序列化有些不兼容的 BinaryFormatter 数据？

> ID：736615
> 
> 赞同：2
> 
> 时间：2009-04-10T03:13:26.813
> 
> 标签：.net, serialization

我有一个在 .NET 1.1 中开发的继承代码库。当我将它迁移到 2.0 时，我重命名了一个程序集。现在，我发现有必要读取包含由旧程序集和 .NET 1.1 序列化的对象的旧文件。 *一些*字段被成功反序列化，但大多数被忽略。如果我启用 FormatterAssemblyStyle.Full ，我会收到如下错误：

`T_VERSION+s_sys_ver`类“ ”中的成员“ ”`MyNamespace.T_VERSION`不存在于序列化流中，并且未使用 System.Runtime.Serialization.OptionalFieldAttribute 进行标记。

对二进制文件的检查表明`T_VERSION+s_sys_ve`r 以*某种形式存在*，并且字段类型没有改变。

除了手动对旧格式进行逆向工程并编写我自己的手动反序列化例程之外，有什么方法可以反序列化旧格式文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T03:19:49.747

检查[序列化绑定器](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.serializationbinder(vs.71).aspx)

> 在序列化期间，格式化程序传输创建正确类型和版本的对象实例所需的信息。此信息通常包括对象的完整类型名称和程序集名称。程序集名称包括程序集的名称、版本和强名称（请参阅强命名程序集）哈希。默认情况下，反序列化使用此信息创建相同对象的实例（受安全策略限制的任何程序集加载除外）。一些用户需要控制加载哪个类，因为该类已在程序集之间移动，或者服务器和客户端需要该类的不同版本。

# perl - 如何在 Perl 中的给定索引处获取字符？

> ID：736616
> 
> 赞同：42
> 
> 时间：2009-04-10T03:14:01.537
> 
> 标签：perl, string

如果我有一个 Perl 字符串：

```
$str = "Hello"; 
```

如何在给定索引处获取类似于 charAt(index) 的字符？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-04-10T03:16:38.943

`substr`与长度 1 一起使用，如：

```
$nth = substr($string, n-1, 1); 
```

还可以查找[perlmonks](http://www.perlmonks.org/?node_id=4688)以获取其他解决方案。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-04-10T03:17:39.453

```
$char = substr( $mainstring, $i , 1 ); 
```

是一种方法，可能是最清楚的。

如果您想要的是*数值*并且您打算这样做很多：

```
unpack("W*","hello") 
```

返回一个 Char 值数组：

```
print join ",", unpack("W*","hello")  ; 
#  104,101,108,108,111 
```

对于正确的 Unicode/Utf8 内容，您可能想要使用

```
use utf8;
unpack("U*","hello\0ƀ\n") 
# 104,101,108,108,111,0,384,10 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-10T14:07:19.627

其他 substr() 答案的推论是您也可以使用它在索引处*设置值。*它支持这个作为左值或额外的参数。它也与 splice 非常相似，这是相同的东西，但对于数组。

```
$string = "hello";
substr($string, 2, 2) = "this works?";
substr($string, 2, 2, "same thing basically");
@a = qw(s t r i n g s a n d t h i n g s);
@cut_out = splice(@a, 2, 2);
@cut_out = splice(@a, 2, 2, @replacement); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-20T12:35:00.357

要获取第 i 个索引处的字符，请使用`substr`. 要获取第二个索引字符，例如：

```
$str="Perl";
print substr($str,2,1). 
```

这将给出输出`r`。

# vb.net - 在 WinForms 中使用 Linq to SQL 的可更新数据网格

> ID：736628
> 
> 赞同：1
> 
> 时间：2009-04-10T03:20:24.550
> 
> 标签：vb.net, linq, datagrid

我正在使用 Linq 填充数据网格——标准类型的东西（下面的代码）。但是由于某种原因，我的 ultraDataGrid 陷入了某种只读模式。我已经检查了我能想到的所有网格属性。这是绑定到 Linq 数据源的结果吗？有人有使用 Linq 的可更新网格的示例代码吗？

```
db = New DataContext
myData = New dataClass
dataUltraGrid.DataSource = From table _
       In db.profiles _
        Select table.field1, table.field2... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T05:39:12.470

您真的没有使用 LinqDataSource 控件...您正在绑定到 List db.profiles 您的数据网格仅通过绑定到该列表而对更新、删除或插入一无所知，我可以建议这样做：

```
<asp:GridView ID="GridView1" runat="server" DataSourceID="LinqDataSource1" 
            AutoGenerateColumns="False" DataKeyNames="FooID">
            <Columns>
                <asp:BoundField DataField="FooID" HeaderText="FooID" InsertVisible="False" 
                    ReadOnly="True" SortExpression="FooID" />
                <asp:BoundField DataField="Name" HeaderText="Name" SortExpression="Name" />
                <asp:BoundField DataField="Description" HeaderText="Description" 
                    SortExpression="Description" />
            </Columns>
        </asp:GridView>
        <asp:LinqDataSource ID="LinqDataSource1" runat="server" 
            ContextTypeName="YourDataContext" EnableDelete="True" 
            EnableInsert="True" EnableUpdate="True" TableName="Foos">
        </asp:LinqDataSource> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T17:58:59.840

找到解决方案：使用 lambda 表达式过滤实体并直接绑定到实体。

# .net - 在 .NET 中解析分隔的 CSV

> ID：736629
> 
> 赞同：26
> 
> 时间：2009-04-10T03:22:17.073
> 
> 标签：.net, vb.net, parsing, csv

我有一个以逗号分隔格式的文本文件，由`"`大多数字段分隔。我正在尝试将其转化为可以枚举的内容（例如，通用集合）。我无法控制文件的输出方式，也无法控制它用于分隔符的字符。

在这种情况下，字段用逗号分隔，文本字段用`"`标记括起来。我遇到的问题是某些字段中有引号（即 8 `"`Tray），并且不小心被选为下一个字段。在数字字段的情况下，它们周围没有引号，但它们确实以 + 或 - 符号开头（表示正数/负数）。

我正在考虑一个 RegEx，但我的技能不是那么好，所以希望有人能提出一些我可以尝试的想法。这个文件中有大约 19,000 条记录，所以我试图尽可能高效地完成它。以下是几个示例数据行：

```
"00","000000112260   ","Pie Pumpkin                             ","RET","6.99 ","     ","ea ",+0000000006.99000
"00","000000304078   ","Pie Apple caramel                       ","RET","9.99 ","     ","ea ",+0000000009.99000
"00","StringValue here","8" Tray of Food                             ","RET","6.99 ","     ","ea ",-00000000005.3200 
```

还有很多领域，但你可以得到图片....

我正在使用 VB.NET，并且我有一个通用的列表设置来接受数据。我曾尝试使用[CSVReader](http://www.codeproject.com/KB/database/CsvReader.aspx)，它似乎运行良好，直到您达到第三条记录（在文本字段中带有引号）。如果我能以某种方式让它处理额外的引号，那么 CSVReader 选项会很好用。

谢谢！

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-04-10T03:42:37.100

我建议查看 .Net 中的[TextFieldParserClass](http://msdn.microsoft.com/en-us/library/zezabash.aspx)。你需要包括

```
Imports Microsoft.VisualBasic.FileIO.TextFieldParser 
```

这是一个快速示例：

```
 Dim afile As FileIO.TextFieldParser = New FileIO.TextFieldParser(FileName)
        Dim CurrentRecord As String() ' this array will hold each line of data
        afile.TextFieldType = FileIO.FieldType.Delimited
        afile.Delimiters = New String() {","}
        afile.HasFieldsEnclosedInQuotes = True

        ' parse the actual file
        Do While Not afile.EndOfData
            Try
                CurrentRecord = afile.ReadFields
            Catch ex As FileIO.MalformedLineException
                Stop
            End Try
        Loop 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-09-05T05:03:02.107

试试这个网站。 [http://kbcsv.codeplex.com/](http://kbcsv.codeplex.com/)

我一直在寻找一个好的实用程序，这是我发现并正常工作的最好的。不要浪费时间尝试其他东西，这是免费的，而且很有效。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-10T03:34:39.960

从[这里](http://www.developmentnow.com/blog/Parse+CSV+Files+In+C+And+ASPNET.aspx)：

```
Encoding fileEncoding = GetFileEncoding(csvFile);
// get rid of all doublequotes except those used as field delimiters
string fileContents = File.ReadAllText(csvFile, fileEncoding);
string fixedContents = Regex.Replace(fileContents, @"([^\^,\r\n])""([^$,\r\n])", @"$1$2");
using (CsvReader csv =
       new CsvReader(new StringReader(fixedContents), true))
{
       // ... parse the CSV 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-12-20T06:18:33.203

正如这个链接所说......[不要滚动你自己的 CSV 解析器！](http://secretgeek.net/csv_trouble.asp "不要滚动您自己的 CSV 解析器！")

按照 Avi 的建议使用 TextFieldParser。Microsoft 已经为您完成了这项工作。如果您最终编写了一个，并且发现其中存在错误，请考虑替换它而不是修复错误。我最近就是这样做的，它为我节省了很多时间。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-10T03:31:05.163

看看[FileHelpers 库](http://filehelpers.sourceforge.net/)。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-01-12T15:26:47.943

你可以[试试 CsvHelper](http://joshclose.github.io/CsvHelper/)（我维护的一个库），它可以通过[NuGet](http://nuget.org/packages/CsvHelper)获得。它遵循 CSV 的[RFC 4180](https://www.rfc-editor.org/rfc/rfc4180)标准。它将能够处理字段内的任何内容，包括逗号、引号和换行符。

CsvHelper 易于使用，但也很容易配置它以处理许多不同类型的分隔文件。

```
CsvReader csv = new CsvReader( streamToFile );
IEnumerable<MyObject> myObjects = csv.GetRecords<MyObject>(); 
```

如果要读取较低级别的 CSV 文件，可以直接使用解析器，它将每一行作为字符串数组返回。

```
var parser = new CsvParser( myTextReader );
while( true )
{
    string[] line = parser.ReadLine();
    if( line == null )
    {
        break;
    }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-13T13:15:57.027

我将其发布为答案，以便我可以解释我是如何做到的以及为什么.... Mitch Wheat 的答案是为我提供了针对这种情况的最佳解决方案的答案，由于格式的原因，我只需要对其稍作修改此数据已导出。

这是VB代码：

```
Dim fixedContents As String = Regex.Replace(
                            File.ReadAllText(csvFile, fileEncoding),
                            "(?<!,)("")(?!,)", 
                            AddressOf ReplaceQuotes) 
```

使用的 RegEx 是我需要更改的，因为某些字段中包含非转义引号，并且提供的 RegEx 似乎不适用于所有示例。这个使用“向前看”和“向后看”来查看引用是在逗号之后还是之前。在这种情况下，它们都是否定的（意思是告诉我双引号不在逗号之前或之后的位置）。这应该意味着引号在字符串的中间。

在这种情况下，我没有直接替换，而是使用函数 ReplaceQuotes 来为我处理。我使用它的原因是因为我需要一些额外的逻辑来检测它是否在行首。如果我会花更多的时间在上面，我相信我可以调整 RegEx 以考虑行的开头（使用 MultiLine 等），但是当我快速尝试时，它似乎不起作用全部。

有了这个，在 32MB CSV 文件（大约 19000 行）上使用 CSV 阅读器，读取文件大约需要 2 秒，执行正则表达式，将其加载到 CSV 阅读器中，将所有数据添加到我的通用类并完成. 真快！！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-12-28T06:12:23.687

排除第一个和最后一个引号的正则表达式将是`(?<!^)(?<!,)("")(?!,)(?!$)`. 当然，你需要使用 RegexOptions.Multiline。

这样就不需要评估器功能。我的代码用单引号替换了不需要的双引号。

完整的 C# 代码如下。

```
string fixedCSV = Regex.Replace(
            File.ReadAllText(fileName),
            @"(?<!^)(?<!;)("")(?!;)(?!$)", "'", RegexOptions.Multiline); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-10T03:24:18.517

至少有 CSV 文件的 ODBC 驱动程序。但是 CSV 有不同的风格。

是什么产生了这些文件？根据源应用程序的要求，不太可能存在匹配的驱动程序。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-10T03:31:09.483

您对 CSVReader 的问题是第三条记录中的引号没有被另一个引号（也就是双引号）转义。如果您不逃避它们，那么您希望如何处理文本字段中间的“？

[http://en.wikipedia.org/wiki/Comma-separated_values](http://en.wikipedia.org/wiki/Comma-separated_values)

（我最终不得不处理文件（使用不同的分隔符），但文本值中的引号字符没有被转义，我最终编写了自己的自定义解析器。我不知道这是否绝对必要。）

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-10T22:00:08.057

这种自定义方法的逻辑是：一次读取文件 1 行，用逗号分隔每一行，删除第一个和最后一个字符（删除外引号但不影响任何内引号），然后将数据添加到您的通用列表。它很短，很容易阅读和使用。

```
 Dim fr As StreamReader = Nothing
        Dim FileString As String = ""
        Dim LineItemsArr() as String

        Dim FilePath As String = HttpContext.Current.Request.MapPath("YourFile.csv")

        fr = New System.IO.StreamReader(FilePath)

        While fr.Peek <> -1
            FileString = fr.ReadLine.Trim

            If String.IsNullOrEmpty(FileString) Then Continue While 'Empty Line

            LineItemsArr = FileString.Split(",")

            For Each Item as String In LineItemsArr
                'If every item will have a beginning and closing " (quote) then you can just
                'cut the first and last characters of the string here.
                'i.e.  UpdatedItems = Item. remove first and last character

                'Then stick the data into your Generic List (Of String()?)
            Next
        End While 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-01-17T20:16:03.137

```
 public static Encoding GetFileEncoding(String fileName)
    {
        Encoding Result = null;
        FileInfo FI = new FileInfo(fileName);
        FileStream FS = null;

        try
        {
            FS = FI.OpenRead();
            Encoding[] UnicodeEncodings = { Encoding.BigEndianUnicode, Encoding.Unicode, Encoding.UTF8 };
            for (int i = 0; Result == null && i < UnicodeEncodings.Length; i++)
            {
                FS.Position = 0;
                byte[] Preamble = UnicodeEncodings[i].GetPreamble();
                bool PreamblesAreEqual = true;
                for (int j = 0; PreamblesAreEqual && j < Preamble.Length; j++)
                {
                    PreamblesAreEqual = Preamble[j] == FS.ReadByte();
                }
                if (PreamblesAreEqual)
                {
                    Result = UnicodeEncodings[i];
                }
            }
        }
        catch (System.IO.IOException)
        {
        }
        finally
        {
            if (FS != null)
            {
                FS.Close();
            }
        }

        if (Result == null)
        {
            Result = Encoding.Default;
        }

        return Result;
    } 
```

# fogbugz - 如何分解fogbugz，区域中的部分？

> ID：736638
> 
> 赞同：4
> 
> 时间：2009-04-10T03:31:09.703
> 
> 标签：fogbugz

我有一个想要构建的 Web 应用程序，我应该如何使用fogbugz 管理我的所有任务。

如果我想逐页列出我的所有任务，我应该为此使用区域吗？我也想把它分解成模块，我再次使用区域？

例子：

*   用户
    *   添加用户
    *   删除用户
    *   为用户分配权限/角色

或者如果它以页面为基础，列表看起来会有所不同。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-04-12T19:59:12.837

随着时间的推移，我发现试图通过项目和责任（区域）以外的任何东西来严格地构建你的案例是浪费精力。

只需将案例放入 FogBugz 下的正确项目和具有良好标题的区域即可。

因此，项目是您正在从事的任何产品或业务项目。

这些领域应该是诸如 UI、代码、文档、数据迁移之类的东西，人们在这些方面有不同的责任和/或能力。

然后为您的案例命名以便于管理和搜索，如果可能的话，将案例的范围控制在几个小时内，当然不超过几天。

所以，从你的例子来看，它可能很简单......

*   添加角色
*   查看角色
*   更新角色
*   删除角色？
*   列出角色
*   添加用户
*   查看用户
*   更新用户
*   删除用户
*   列出用户
*   添加依赖检查以删除角色。

老实说，即使上述内容也可能有点过火，您可能会逃脱：

*   用户角色添加/查看/更新/删除/列表
*   用户添加/查看/更新/删除/列表

你做的越简单，你对你的开发者的信任越多，你的开发者感受到的阻碍就越少，更有可能继续下去。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-14T14:27:19.250

用户可以按分配给他们的案例进行过滤，因此他们始终可以查看自己的队列。

许多不同的领域只会产生不必要的复杂性——你只是不需要那种程度的细分。

请记住，您永远不应该有大量的活动案例，并且您不需要对短名单进行大量分类。

我发现区域标志的最佳用途是将工作分组到多个开发人员的队列中。然后你得到一个任何人都可以快速查看的队列。

例如，您可能有一个“产品规划”区域，用于展示您尚未决定执行的功能创意。在大型团队中，您可能会为每个子团队分配一个区域，以便每个直线经理可以自己查看他们的队列。

We have one large and complex project that's been using Fogbugz for 4 years and we've never needed more than 5 areas. If we'd split areas the way that you suggest here we would now have hundreds of them.

# css - 如何设置用于过滤的链接菜单样式，例如 Facebook 上的“Dean + Friends”、“Just Dean”、“Just Friends”？

> ID：736639
> 
> 赞同：0
> 
> 时间：2009-04-10T03:33:08.543
> 
> 标签：css, facebook, hyperlink, visited

我们电子商务网络应用程序上的几个页面允许用户过滤他们提交给我们的请求的状态列表。

过滤器通常是这样的：

所有待完成

我们将它们设置为链接。我们希望对它们进行样式设置，以便当前活动的过滤器用彩色矩形突出显示（带圆角，natch！），文本变为白色。

矩形突出显示将一直保持，直到用户单击其他过滤器之一（待处理，已完成），此时突出显示将移动到刚刚单击的链接。

这方面的一个例子出现在 Facebook 上的几个地方，例如，墙上的帖子被过滤到：

院长+朋友只是院长只是朋友

在 CSS 中是否有一种简单的方法可以做到这一点，也许是通过设置最近“访问过”的链接的样式，但将以前访问过的链接标记为未访问？

谢谢，

迪恩理查森

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T04:22:45.680

> 在 CSS 中是否有一种简单的方法可以做到这一点，也许是通过设置最近“访问过”的链接的样式，但将以前访问过的链接标记为未访问？

你不能用纯 CSS 产生这种效果的动态。Facebook 通过添加一个带有 Javascript 的 CSS 类来做到这一点，当您单击其中一个药丸标签按钮时会触发该类。CSS 类包含使其以所需方式显示的样式规则。

# c# - 如何将文本框上的自动完成链接到数据库表？C# 2.0

> ID：736645
> 
> 赞同：2
> 
> 时间：2009-04-10T03:41:53.657
> 
> 标签：c#, data-binding, textbox, autocomplete

我正在使用带有 Framework 2.0 的 Visual Studio 2005、C#。我想使用自动完成，但希望列表来自我数据库中的表。

有没有办法对 AutoCompleteSoure 进行数据绑定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T07:51:09.517

您可能想看看这篇[博文](http://csharpdotnetfreak.blogspot.com/2009/01/winforms-autocomplete-textbox-using-c.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T05:30:54.797

您可以使用 AjaxControlToolkit AutoComplete 完成您想做的事情

[http://www.asp.net/AJAX/AjaxControlToolkit/Samples/AutoComplete/AutoComplete.aspx](http://www.asp.net/AJAX/AjaxControlToolkit/Samples/AutoComplete/AutoComplete.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-17T18:46:13.340

是的，您可以在 C# 的 WinForms 中使用自动完成功能来完成。这是示例：

1.  将文本框的更改`AutoCompleteMode`为`SuggestAppend`。
2.  将 更改`AutoCompleteSource`为`CustomSource`。

现在，在文本框的 Enter_Event 中编写以下代码以从任何表中加载数据：

```
AutoCompleteStringCollection acs = new AutoCompleteStringCollection();
acs.Clear();

try
{
    this.Cursor = Cursors.WaitCursor;
    OleDbCommand odc = new OleDbCommand("<your sql statement>", <your connection>);
    OleDbDataReader odr = odc.ExecuteReader();

    while (odr.Read())
    {
        acs.Add(odr["name"].ToString());
    }

    textbox1.AutoCompleteCustomSource = acs;
}
catch (Exception ex)
{
    throw new ex;
}
finally
{
    this.Cursor = Cursors.Default;
} 
```

希望这段代码有所帮助。如有其他疑问，请回复。

# java - 应用容器中的守护线程

> ID：736650
> 
> 赞同：3
> 
> 时间：2009-04-10T03:45:44.503
> 
> 标签：java, multithreading, spring, concurrency, xmpp

我最近在 Smack 论坛的[一篇文章中读到](http://www.igniterealtime.org/community/message/189500)

> 在 Java EE 服务器中启动守护线程是一个很大的禁忌

基本上，Smack 的 XMPPConnection 启动一个守护线程来监视传入数据和另一个分别从/向 jabber 服务器发送传出数据。在这种情况下使用守护线程来监听写入/读取是否合理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T06:37:13.453

是的，XMPPConnection 创建了两个线程——一个用于听/读，一个用于写。但这些只与 XMPPConnection 实例一样长，我认为它不会永远存在。

> “在 Java EE 服务器中启动守护线程是一个很大的禁忌”

您是否正在编写符合规范的 EJB？如果是这样，那么这适用。规范说不要这样做。EJB 2.1 规范：

> “企业 bean 不得尝试管理线程。企业 bean 不得尝试启动、停止、暂停或恢复线程，或更改线程的优先级或名称。企业 bean 不得尝试管理线程组。”

或者它只是一个恰好在 Tomcat 中运行的 webapp？如果是这种情况，那么我认为没有任何根本问题。如果没有线程，您的 Smack 客户端将无法与服务器通信。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T04:13:47.073

我只将 Smack API 用于独立程序的客户端连接。首先，您应该重新审视 J2EE 容器中 Smack API 的选择（或用途）。

# python - 在从列表创建小部件的 for 循环中使用 PyQt 连接方法错误

> ID：736651
> 
> 赞同：1
> 
> 时间：2009-04-10T03:48:22.063
> 
> 标签：python, pyqt

我有一个 GUI 程序，

它从名称列表中自动创建按钮，并连接到一个函数并打印其名称。

但是当我运行这个程序时，我按下了所有的按钮，

他们都返回最后一个按钮的名称。

我想知道为什么会发生这种情况。有人可以帮忙吗？

```
import sys
from PyQt4.QtCore import *
from PyQt4.QtGui import *
import logging

logging.basicConfig(level=logging.DEBUG,)

class MainWindow(QWidget):
    def init(self):
        names = ('a','b','c')
        lo = QHBoxLayout(self)
        for name in names:
            button = QPushButton(name,self)
            lo.addWidget(button)
            self.connect(button,SIGNAL("clicked()"),
                         lambda :logging.debug(name))

if __name__=="__main__":
    app = QApplication(sys.argv)
    m = MainWindow();m.init();m.show()
    app.exec_() 
```

结果如下：

```
python t.py
DEBUG:root:c
DEBUG:root:c
DEBUG:root:c 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T04:51:10.867

我在您的代码中看到至少一个错误。

代替：

```
 lambda :logging.debug(name) 
```

经过：

```
 lambda name=name: logging.debug(name) 
```

请参阅[为什么 map() 和列表理解的结果不同？](https://stackoverflow.com/questions/139819/why-results-of-map-and-list-comprehension-are-different)详情。

# iphone - 在 iPhone 上播放音频的更简单解决方案

> ID：736653
> 
> 赞同：0
> 
> 时间：2009-04-10T03:49:41.687
> 
> 标签：iphone, objective-c, cocoa-touch, uikit

Apple 将 ( [http://developer.apple.com/samplecode/AudioQueueTest/listing1.html](http://developer.apple.com/samplecode/AudioQueueTest/listing1.html) ) 列为播放音频文件的快速演示。

有没有办法用更少的代码行播放音频文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-03-07T23:48:44.600

这是一种快速而肮脏的发声方式。它适用于播放无法控制持续时间、音量或精确时间的短声音。有了这些免责声明，我们开始吧。

在将播放声音的视图控制器中，导入此框架：

```
#import <AudioToolbox/AudioToolbox.h> 
```

然后手动将 AudioToolbox 框架添加到您的项目中：*Control-click on Frameworks Group --> Add... --> Existing Frameworks... --> AudioToolbox.framework*

接下来，将“someSound.caf”添加到您的项目资源文件夹中，显然使用您的实际文件名。

在播放声音的方法中，添加：

```
SystemSoundID theSound;
AudioServicesCreateSystemSoundID((CFURLRef)[NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"someSound" ofType:@"caf"]], &theSound);
AudioServicesPlaySystemSound(theSound); 
```

我将这种方法用于原型设计，而不是用于生产代码，因为它有很多限制。

# java - Java 的 Scanner vs String.split() vs StringTokenizer；我应该使用哪个？

> ID：736654
> 
> 赞同：10
> 
> 时间：2009-04-10T03:49:47.100
> 
> 标签：java, regex, split, java.util.scanner

我目前正在使用`split()`扫描一个文件，其中每行都有由 . 分隔的字符串数`'~'`。我在某个地方读到了`Scanner`可以更好地处理长文件的地方，性能方面，所以我想检查一下。

我的问题是：我是否必须创建两个实例`Scanner`？也就是说，一个读取一行，另一个基于该行获取分隔符的标记？如果我必须这样做，我怀疑我是否会从使用它中获得任何好处。也许我在这里遗漏了一些东西？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-15T19:43:02.837

在单线程模型中围绕这些指标做了一些指标，这是我得到的结果。

```
～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～ ～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～
~ 分词器 | String.Split() | 而+子字符串 | 扫描仪 | ScannerWithCompiledPattern ~
~ 4.0 毫秒 | 5.1 毫秒 | 1.2 毫秒 | 0.5 毫秒 | 0.1 毫秒 ~
~ 4.4 毫秒 | 4.8 毫秒 | 1.1 毫秒 | 0.1 毫秒 | 0.1 毫秒 ~
~ 3.5 毫秒 | 4.7 毫秒 | 1.2 毫秒 | 0.1 毫秒 | 0.1 毫秒 ~
~ 3.5 毫秒 | 4.7 毫秒 | 1.1 毫秒 | 0.1 毫秒 | 0.1 毫秒 ~
~ 3.5 毫秒 | 4.7 毫秒 | 1.1 毫秒 | 0.1 毫秒 | 0.1 毫秒 ~
____________________________________________________________________________________________________________

```

结果是 Scanner 提供了最好的性能，现在需要在多线程模式下进行评估！我的一位资深人士说，Tokenizer 会产生 CPU 峰值，而 String.split 不会。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-10T04:07:23.877

对于处理线，您可以使用扫描仪，对于从每条线获取令牌，您可以使用拆分。

```
Scanner scanner = new Scanner(new File(loc));
try {
    while ( scanner.hasNextLine() ){
        String[] tokens = scanner.nextLine().split("~");
        // do the processing for tokens here
    }
}
finally {
    scanner.close();
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-10T04:19:19.557

您可以使用该`useDelimiter("~")`方法让您使用 遍历每行上的标记`hasNext()/next()`，同时仍使用`hasNextLine()/nextLine()`遍历行本身。

编辑：如果要进行性能比较，则应在进行 split() 测试时预编译正则表达式：

```
Pattern splitRegex = Pattern.compile("~");
while ((line = bufferedReader.readLine()) != null)
{
  String[] tokens = splitRegex.split(line);
  // etc.
} 
```

如果使用`String#split(String regex)`，则每次都会重新编译正则表达式。（扫描器在第一次编译它们时会自动缓存所有正则表达式。）如果你这样做，我不希望看到性能上有太大差异。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-10T04:00:31.270

我会说`split()`是最快的，并且对于你正在做的事情可能已经足够好了。它没有那么灵活`scanner`。`StringTokenizer`已弃用，仅可用于向后兼容，因此请不要使用它。

编辑：您总是可以测试这两种实现，看看哪个更快。我很好奇自己是否`scanner`可以比`split()`. 对于给定的大小，拆分可能会更快 VS `Scanner`，但我不能确定这一点。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-07-13T06:01:36.783

您实际上并不需要正则表达式，因为您在固定字符串上进行拆分。Apache `StringUtils` [split](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/StringUtils.html#split%28java.lang.String,%20char%29)对纯字符串进行拆分。

对于大容量拆分，拆分是瓶颈，而不是说文件 IO，我发现这比`String.split()`. 但是，我没有针对已编译的正则表达式对其进行测试。

Guava 也有一个拆分器，以更面向对象的方式实现，但我发现它比 StringUtils 大容量拆分慢得多。

# desktop-application - 什么样的应用程序更适合创建为桌面应用程序而不是在线应用程序？

> ID：736656
> 
> 赞同：3
> 
> 时间：2009-04-10T03:52:26.173
> 
> 标签：desktop-application

有人知道吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-10T03:57:11.560

一个网络浏览器。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T04:14:45.637

具有大内存、本地数据或密集 cpu 要求的应用程序：

*   编译器
*   光线追踪程序
*   多媒体应用

涉及敏感数据的应用程序：

*   薪资软件
*   库存系统
*   客户数据库系统

与硬件交互的程序

*   医疗校准系统
*   呼叫中心应用
*   建筑报警监控/气候控制/视频监控系统
*   射频识别系统

关键正常运行时间解决方案

*   911 紧急调度系统
*   敏感区域的访问控制
*   关键服务器的监控解决方案

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T04:12:28.513

我会说在计算和表示之间需要很少延迟的应用程序（例如游戏或视频编辑）。其他需要与本地硬件接口的应用程序不太适合在线应用程序。

您得到的几乎所有答案都取决于您的网络连接是瓶颈这一事实。但是请记住，当您处理在线应用程序时，您所做的大部分工作都将通过网络连接进行管道传输。即使将大量计算卸载到本地 CPU 的框架仍将通过网络连接对框架本身进行流水线化。如果该连接缓慢、滞后或不可靠，那么您的应用程序也是如此。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-10T04:12:56.530

通常，需要访问大型本地文件的东西。视频/图像/声音编辑、游戏、3D建模程序等。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-10T04:04:48.733

我会说任何必须与特定硬件通信的东西。还有具有性能要求的程序（例如游戏，当然，理论上您也可以在浏览器中运行游戏（例如 Quake Live），但这与孤岛危机相比算不了什么：D）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-10T04:10:38.780

iTunes - 除非苹果想要托管 80 TB 的盗版音乐

# .net - 需要临时报告组件

> ID：736660
> 
> 赞同：5
> 
> 时间：2009-04-10T03:57:28.687
> 
> 标签：.net, asp.net, sql, reporting, adhoc

我们的 ASP.NET 网站需要一些简单的临时报告解决方案。

只是一种使用用户友好界面构建查询的能力，然后在某个表中显示此查询的结果，并可能将其导出到 Excel 或打印。

对于对数据库、SQL 和其他技术一无所知的最终用户（我们的网站访问者），该解决方案必须非常简单。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T13:21:29.923

[EasyQuery.NET](http://devtools.korzh.com/eq/dotnet/)可能适合您的需要。它是专有的，但他们也有免费版本。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-06-12T08:26:41.287

虽然不是 .NET（还没有）——但可以使用 iframe 嵌入——我建议**[i-net Clear Reports](http://www.inetsoftware.de/products/crystal-clear)**（以前是 i-net Crystal-Clear）带有一个易于使用的临时报告组件- 用于非技术用户的东西。您的用户根本不需要了解任何有关报告的知识。他们只需选择报告的类型，数据等等，就会有适合需求的报告。

除了 HTML 输出的 Web 可嵌入性之外，您还可以提供独立的组件和/或 Java 小程序（i-net Clear Reports 完全是 Java，但我们正在努力将服务器端移植到[.NET](http://www.inetsoftware.de/products/clear-reports-dot-net)）。即将推出的版本甚至支持网络皮肤，因此您的用户/客户不会认出它是“第三方”。;)

披露：是的。我为建立这个的公司工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-01-13T08:18:37.290

我强烈推荐[http://www.izenda.com](http://www.izenda.com)上的 Izenda Reports 。这是一个完全集成的 ASP.Net AJAX 解决方案，可连接到您的数据库，允许最终用户构建自己的报告以及运行现有报告。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T04:17:07.113

老实说，您可能需要收集需求并找出他们有兴趣运行哪些类型的报告并为他们构建报告。但是，您是否考虑过水晶报表？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T13:42:04.307

我为 SQL 报告服务构建了类似的东西。不过，它需要几张桌子才能完成。

1.  AdHock_SQL_Reports，其中包括报告的名称、路径和显示名称。
2.  AdHock_Sql_Reports_Parameters，其中包括参数名称和值，以及一个告诉代码的标志，该值可以是用于动态生成值的 SQL commnd。

然后，您需要构建代码来处理这些表，并在网页上生成下拉列表列表。

我建造的是相当“拳头传球”，边缘有点粗糙。

您还可以向用户公开 SQL 报告服务报告，并让报告服务为这些报告提供输入字段。我们已经开始以这种方式倾斜并远离我的代码。（反正比我有的好）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-07-12T20:15:07.300

可能不是在“简单”方面，但对于更复杂的即席报告，允许业务用户在不了解 SQL 且不安装任何东西的情况下在浏览器中构建报告，请查看我们的[ActiveReports 服务器产品](http://www.activereportsserver.com)。

我们完全使用托管的 .NET 代码构建它，并且包含 ASP.NET 控件，以便轻松集成到您自己的 ASP.NET 站点中。当然还有其他语言/平台的 web 服务，它处理基于 web 的报告的许多其他重要细节，如可伸缩性/负载平衡、调度报告、输出到 excel/pdf/word 等、基于角色的安全性、支持多租户部署，支持移动设备，兼容 ActiveReports Developer Component XML 报表文件。

是的，我是产品经理。

# programming-languages - 我应该学习哪些编程基础知识？

> ID：736668
> 
> 赞同：4
> 
> 时间：2009-04-10T04:09:21.997
> 
> 标签：programming-languages

我在编程方面有过非常奇怪的学习经历。我被教过 C++，但我并没有从中学到很多东西。这是我从中得到的：标题和变量声明。我尝试自学 PHP，在其中我学到了很多东西。问题是，我的很多知识都是广泛的、随机的，并且是为特定情况设计的。

**所以，我的问题是：大多数**语言的编程都有哪些基础知识？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-04-10T05:36:49.340

术语“基础”意味着一个简短的列表，但要成为一名有效的程序员，您必须学习很多概念。但是，一旦你学会了它们，你就可以跨语言应用许多相同的概念。

我已经编制了一个（很长！）的概念列表，这些概念在几种（如果不是大多数）编程语言中都很重要。

*   语言语法

    *   关键词
    *   命名约定
    *   运营商
        *   任务
        *   算术
        *   细绳
        *   其他
    *   字面量
    *   条件句
        *   如果别的
        *   开关/外壳
        *   什么被认为是真或假（0？空字符串？空？）
    *   循环构造
        *   为了
        *   foreach/迭代
        *   尽管
        *   做时
    *   异常处理
    *   从其他文件导入/包含代码
*   类型系统

    *   强/弱
    *   静态/动态
*   内存管理

*   范围界定

    *   可用的范围
    *   如何处理重叠范围
*   语言结构/程序组织

    *   变量
    *   方法
    *   职能
    *   课程
    *   闭包
    *   包/模块/命名空间
*   数据类型和数据结构

    *   原语
    *   对象
    *   数组/列表
    *   映射/哈希/关联数组
    *   套
    *   枚举
    *   字符串
        *   字符串连接
        *   字符串比较和相等
        *   子串
        *   替换
        *   可变性
        *   创建文字字符串的语法
*   函数、方法、闭包

    *   方法/函数重载
    *   方法/函数覆盖
    *   参数传递（按值传递/按引用传递
    *   返回值（单次返回/多次返回）
*   语言类型（不互斥）

    *   脚本
    *   程序
    *   功能性
    *   面向对象
*   面向对象原则

    *   遗产
    *   经典与原型
    *   单个、多个或其他
    *   课程
    *   静态变量/全局变量
    *   访问修饰符（private、public、protected）
*   API（或如何做基本的东西）

    *   基本 I/O
    *   打印到标准输出
    *   从标准中读取
    *   文件输入/输出
        *   读取文件
        *   写一个文件
        *   检查文件属性
    *   正则表达式的使用
    *   引用环境变量
    *   执行系统命令
    *   线程模型
        *   创建线程
        *   线程安全
        *   同步原语
    *   模板

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-10T04:16:52.543

这里还没有提到的另一件重要的事情就是面向对象编程。围绕类、继承、接口等的想法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T04:52:18.760

一项非常重要的基本编程技能是能够在许多不同的抽象级别上进行思考，并知道何时以及哪个抽象级别最适合特定的编程任务。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-10T04:12:31.523

指针。因为真正了解他们的人太少了。

递归和迭代，以及区别是什么，以及何时使用它们。

获取一本算法书并完成练习——你不会失望的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-20T20:18:11.490

测试！（单元测试，集成测试，夹具，模拟对象，...）

这不是一种编程技能，而是一种开发技能：使用修订控制，并学习提交一组更改来处理一个（或几个相关的）需求或错误修复，并且总是会产生一个可以无错误编译的源代码树。这将教你组织你的工作:-)

最后但同样重要的是：英语...... :-) 同样，这不是一种编程技能，我知道有些人可能不同意，但我觉得任何使用英语关键字的编程语言也应该用英语编程。所以：使用英文变量名，等等。我什至会说代码注释应该是英文的，但我相信更多的人会不同意这一点……所以：学习其他人如何描述他们的代码，并坚持下去。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-10T04:15:34.027

如果我是你，我会回去从 K&R 类书籍中学习 C 编程语言。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-20T19:54:10.813

找出你想首先为什么样的东西编程——例如网络、PC 应用程序、基于 Java 的应用程序、移动设备、报告、系统接口、企业对企业接口等，然后从那里开始。

# postscript - “currentpoint newpath moveto”过程的更好名称

> ID：736685
> 
> 赞同：3
> 
> 时间：2009-04-10T04:17:40.013
> 
> 标签：postscript

*问题：您对这些函数的更好名称有什么建议吗？*

由于 newpath 和 stroke 导致当前点变得未定义，我通常定义如下过程

```
/new_path     { currentpoint newpath moveto             } bind def
/close_stroke { currentpoint closepath stroke moveto    } bind def 
```

但是，这些名称实际上是[如何编写不可维护代码](http://mindprod.com/jgloss/unmaincamouflage.html)的示例，我宁愿将它们称为其他名称，但无法想出任何好名称（除了可能类似的名称`newpath_without_undefining_currentpoint`，然后使用过程的好处或多或少消失了）。

搜索现有用法仅在 ghostscript 的 pdf_ops.ps 中找到以下内容：

> /tn { currentpoint newpath moveto } bdef % 已过时，从未使用过。

并且*tn*并不是一个更好的名字。

编辑：我所说的具有不可维护的特征的意思是我最终得到`newpath` and `new_path`，两者都做同样的事情但略有不同，并且名称中没有任何内容暗示任何事情。我知道标识符通常保持简短以节省空间，但这对于我的手写文件来说不是问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T04:49:35.443

如何使用`/beginpath`（或`/startpath`）和`/completepath`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T04:30:17.330

你的名字对我来说很好看。我会冒险我的几个 -`/newpath_here`和`/stroke_here`。

> tn 并不是一个更好的名字。

短名称是为了保持 PS 文件较小（字节数越少意味着通过网络传输的内容越少）的结果。事实上，这甚至由 PDF 的操作员共享（其中含义随大小写而变化）。

# asp.net - ASP.NET MVC 检索到控制器、操作和参数的路由

> ID：736690
> 
> 赞同：0
> 
> 时间：2009-04-10T04:22:43.527
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-routing

在 ASP.NET MVC 中，如何生成指向特定控制器和操作的 URL 以及其他参数。RedirectToAction 允许我重定向，但我想从我的控制器中检索此 URL。

我尝试使用：

```
Url.Action("Page", "Administrator", New With {.page = _currentPage}) 
```

但这返回了 /Administrator/Page?page=2 之类的链接，而我希望检索 /Administrator/Page/2 之类的链接

我搜索了无数的论坛，我确信这有一些东西，但我一辈子都找不到它。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T04:27:29.787

你的路线是什么样的？标准路由需要一个 id 作为第三个参数。如果您没有更改路线，请尝试使用：

```
Url.Action( "Page", "Administrator", New With { id = _currentPage } ) 
```

# http - 当前正在浏览的网站

> ID：736694
> 
> 赞同：0
> 
> 时间：2009-04-10T04:23:17.347
> 
> 标签：http, visual-c++, monitoring, web-traffic

我在局域网中有 50 台机器，每台都可以访问互联网。可以使用 vc++ 开发一个程序，它会告诉每台机器上的用户正在打开的所有网站是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T07:05:10.203

您可以通过编写一个捕获端口 80 上的出站数据包（以及相关的 DNS 信息）的应用程序来轻松完成此操作。问题是此应用程序必须在您要跟踪的每台客户端计算机上运行。正如其他人所说，更简单的方法是利用您的网络架构并将所有流量通过可以记录相同信息的中央代理进行隧道传输。

在后一种情况下，有许多企业工具只适合此任务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T04:27:04.903

通过集中式代理路由您的互联网流量，并使用 Fiddler 或其他方式监控来自代理的流量。如果无法进行代理，请使用 Fiddler 在已知位置生成数据，然后按要求的时间间隔对其进行整理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T06:52:38.563

如果您还没有防火墙，请安装防火墙，并使用它来记录连接。

# asp.net - 在 localhost 上运行 asp.net 应用程序

> ID：736699
> 
> 赞同：0
> 
> 时间：2009-04-10T04:26:46.480
> 
> 标签：asp.net, iis, localhost

毕竟这可能是一个“呃”的问题。

在本地主机上运行 asp.net (3.5) 应用程序是否有任何注意事项？假设我安装了所有必需的服务，我正在寻找以下方面的陷阱/麻烦

*   数据库访问
*   报告/图表和其他此类功能
*   表现

主要原因是我正在开发的应用程序最终将托管在适当的 Web 服务器上，但在此之前我希望能够从浏览器中使用我的应用程序（用于测试、演示......）。

[注意：在应用程序托管在网络服务器上之前，只有我会使用该应用程序]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T04:28:16.650

只要您在计算机上安装与服务器上可用的所有相同组件（以及它们的相同版本以 100% 确定），那么功能上就不应该有任何差异。需要注意的一件事是，与客户端和服务器是同一台机器相比，当有人通过 Internet 访问该应用程序时，该应用程序的响应性肯定会降低。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T04:31:12.990

你根本不会有任何问题，这确实是多少人测试的。当您准备好将其移至网上时，只需确保主机支持您所需的一切。

# c++ - Vim 中突出显示的类和函数名

> ID：736701
> 
> 赞同：75
> 
> 时间：2009-04-10T04:27:12.547
> 
> 标签：c++, vim, syntax-highlighting, textmate, vim-syntax-highlighting

在沉迷于它的模态输入之后，我最近才从 Textmate 设置了我的 Vim 环境。

然而，语法高亮在 Vim 中似乎并不那么漂亮。我用 C++ 编写代码，由于无法突出显示函数调用和类名，因此代码更难阅读。我玩了一会儿配色方案，但找不到与“类名”或“函数名”对应的任何字段。

在下图中，请注意MacVim 右侧如何突出显示`DroughtLayer::`和未突出显示。`*.size()`

[![Textmate（左）和 Vim（右）的图片对比](https://i.stack.imgur.com/1cHzr.png)](https://i.stack.imgur.com/1cHzr.png)
[（来源：[ivzhao.com](http://ivzhao.com/temp/vimHL.png)）]

任何想法如何解决这个问题？这真的让我很恼火，因为我是一个对视觉敏感的人。

* * *

## 回答 #1

> 赞同：134
> 
> 时间：2009-04-21T16:09:24.963

当我开始使用 vim 时，我遇到了同样的问题。解决方法很简单，你只需要编辑 vim 使用的 c 语法文件，方法如下：

当您开始编辑 C 或 C++ 文件时，vim 会读取位于

```
$VIMRUNTIME/syntax/c.vim 
```

（$VIMRUNTIME 是你安装 vim 的地方。你可以通过打开 vim 并使用命令 ":echo $VIMRUNTIME" 找到它的默认值）。

您可以简单地覆盖该文件，或者您可以在此位置创建自定义 C 语法文件（将由 vim 加载而不是默认文件）：

```
$HOME/.vim/syntax/c.vim      (for UNIX)
$HOME/vimfiles/syntax/c.vim  (for PC or OS/2) 
```

（我从未使用过 Mac，所以我不知道哪一个适合你。你可以在 vim 帮助中找到更多信息，“:help vimfiles”）

现在有趣的部分。将默认的 "$VIMRUNTIME/syntax/c.vim" 文件复制到你的 vimfiles 目录（对于 UNIX 是 "$HOME/.vim/syntax/c.vim"），并通过添加以下行来编辑它：

> ```
> " Highlight Class and Function names
> syn match    cCustomParen    "(" contains=cParen,cCppParen
> syn match    cCustomFunc     "\w\+\s*(" contains=cCustomParen
> syn match    cCustomScope    "::"
> syn match    cCustomClass    "\w\+\s*::" contains=cCustomScope
> 
> hi def link cCustomFunc  Function
> hi def link cCustomClass Function 
> ```

就是这样！现在函数和类名将使用“函数”突出显示（“：hi Function”）中定义的颜色突出显示。如果要自定义颜色，可以将上面的最后两行更改为以下内容：

```
hi def cCustomFunc  gui=bold guifg=yellowgreen
hi def cCustomClass gui=reverse guifg=#00FF00 
```

或者你可以不理会 C 语法文件并在你的 vimrc 文件中定义颜色 (":help vimrc"):

```
hi cCustomFunc  gui=bold guifg=yellowgreen
hi cCustomClass gui=reverse guifg=#00FF00 
```

（注意没有“def”关键字，详情请看“:help highlight-default”）。关于 ":hi" 命令的可用参数见 ":help :highlight"。

您可以在此链接上找到 Vim 7.2 的完整 c.vim 文件（注意：仅当您有未修改的 Vim 7.2 版时才使用此文件）：

> [http://pastebin.com/f33aeab77](http://pastebin.com/f33aeab77)

和强制性的截图：

> [![在此处输入图像描述](https://i.stack.imgur.com/qenES.png)](https://i.stack.imgur.com/qenES.png)

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2012-04-13T12:32:09.777

这是我在这里的第一篇文章，我不知道如何进行观察，Eduardo 的答案使“（”和“{”看起来没有问题并且错误语法折叠，我对其进行了一些更改以解决此问题。

```
syn match    cCustomParen    "?=(" contains=cParen,cCppParen
syn match    cCustomFunc     "\w\+\s*(\@=" contains=cCustomParen
syn match    cCustomScope    "::"
syn match    cCustomClass    "\w\+\s*::" contains=cCustomScope
hi def cCustomFunc  gui=bold guifg=yellowgreen
hi def link cCustomClass Function 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-04-15T15:49:12.663

有趣的是，VIM 中的语法高亮不支持将语法应用于标识符或函数名——至少不支持 C 和 C++ 的语法高亮。所以，即使你这样做：

```
:hi Function guifg=red 
```

或者

```
:hi Identifier guifg=red 
```

它没有给这些颜色。我似乎只是这些语言的关键字和常量。

在这里，有人开始扩展 cpp 语法文件以支持方​​法名称。我猜这是一个开始。 [http://vim.wikia.com/wiki/Highlighting_of_method_names_in_the_definition](http://vim.wikia.com/wiki/Highlighting_of_method_names_in_the_definition)

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-04-16T10:43:03.647

一种解决方案是使用内置的 ctags 数据库。[因此，使用ctags](http://ctags.sourceforge.net/)实用程序创建一个。然后设置'tags'变量并将以下内容放入

```
~/.vim/after/syntax/c.vim

function! s:highlight()
    let list = taglist('.*')

    for item in list
        let kind = item.kind

        if kind == 'f' || kind == 'c'
            let name = item.name
            exec 'syntax keyword Identifier '.name
        endif
    endfor
endfunction

call s:highlight() 
```

我必须警告您，这在非常大的 ctags 数据库上可能会运行得很慢。

vim.org 上也有[一种解决方案](http://www.vim.org/scripts/script.php?script_id=1232)，但我没有尝试过。请让我知道这对你有没有用。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-04-03T14:07:10.213

编辑： color_coded 对你来说可能太重了。试试[octol/vim-cpp-enhanced-highlight](https://github.com/octol/vim-cpp-enhanced-highlight)。它支持 C++11/14 并集成了 @Eduardo 的答案。 ![](https://camo.githubusercontent.com/acc500e971dffcf43116e6dfacafaa2172868697/687474703a2f2f7777772e6861656767626c61642e636f6d2f76696d2f73637265656e73686f742e706e67)

**基于语义**的荧光笔：
我会推荐[jeaye/color_coded](https://github.com/jeaye/color_coded)，一个基于 libclang 的高亮 vim 插件
很抱歉，我是 stackoverflow 的新手，这意味着我没有足够的声誉来发布图像。如果你想试一试，去看看它的效果。:)

优点：

*   简易安装
*   语义突出显示
*   上面提到的 Clighter，需要用 vim 编译`python2.7`。但是，color_coded 是用 C++ 编写的，并提供 lua 绑定 -> C++。

缺点：

*   除非您制作一些 vim 事件来激活它，否则它会延迟。
*   定制有点困难；你需要自己编辑 syntax/color_coded.vim。但定制已被置于其路线图上。

尽管它仍在开发中，但它越来越受到关注。

![前](https://i.stack.imgur.com/33rt5.png) ![后](https://i.stack.imgur.com/lNYl3.png)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-09-22T06:07:05.657

Sergey，将第一行从

```
syn match    cCustomParen    "(" contains=cParen,cCppParen 
```

到

```
syn match    cCustomParen    "(" contains=cParen contains=cCppParen 
```

似乎为我修复它。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-04-29T21:20:05.940

尝试使用这个插件[http://www.vim.org/scripts/script.php?script_id=2646](http://www.vim.org/scripts/script.php?script_id=2646) 它会为你非常有效地突出显示所有 ctags

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-10T04:39:54.717

使用[Taglist 之](http://vim-taglist.sourceforge.net/)类的 vim 插件，或者设置`ctags`或`cscope`与 vim 集成（[这里是](http://cscope.sourceforge.net/cscope_vim_tutorial.html)vim/cscope 的教程。）

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-07-06T04:14:14.953

我真的向你推荐这个`taghighlight`插件，点击[这里](http://www.cgtk.co.uk/vim-scripts/taghighlight)查看它的网站。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-08-13T10:18:20.527

[`Clighter`](https://github.com/bbchung/clighter)插件也可以考虑，这是一个

```
plugin for c-family semantic source code highlighting, based on Clang 
```

但是，需要相当新的版本和软件：`vim 7.4.330 +python2`和`libclang`.

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-10-08T23:33:35.073

仅匹配**C**函数定义，这对我有用：

```
syn match    cCustomFuncDef display /\(\w\+\(\s\|*\)\+\)\@<=\w\+\s*(\@=/ 
hi def cCustomFuncDef ctermfg=lightblue 
```

# xml - 如何计算 XSLT 中的引用总数？

> ID：736702
> 
> 赞同：1
> 
> 时间：2009-04-10T04:27:16.667
> 
> 标签：xml, xslt, xpath

我的问题是：使用XSLT，如何统计QUOTE标签的总数（请看下面的示例代码）结果需要在HTLM中导出，它会显示如下：共有6个引号

```
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="text.xsl" ?>

    <quotes>
      <quote>Quote 1 </quote>
      <quote>Quote 2</quote>
      <quote>Quote 3</quote>
      <quote>Quote 4</quote>
      <quote>Quote 5</quote>
      <quote>Quote 6</quote>
    </quotes> 
```

我已经尝试过这个 XSLT 代码，但它不起作用：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
      xmlns:xs="http://www.w3.org/2001/XMLSchema"
      exclude-result-prefixes="xs"
      version="2.0">
    <xsl:template match="/">
        <xsl:value-of select="count(//quote)"></xsl:value-of>
    </xsl:template>

</xsl:stylesheet> 
```

你能帮我解决这个问题吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T05:47:01.280

**您的 XPath 表达式**虽然效率不高，但**会产生正确的结果**。

当使用 Saxon 9.1.0.5J 运行转换时，结果为：

```
<?xml version="1.0" encoding="UTF-8"?>6 
```

**问题似乎是这是一个 XSLT 2.0 转换**（它不需要！），您似乎正试图在浏览器中运行它。**不幸的是，今天的浏览器（还）不支持 XSLT 2.0**。

***解决方案是简单地将版本更改为`1.0`.***

此转换也不需要 XML Schema 名称空间。

最后，如果所提供的 XML 文档的结构不会改变，更有效的 XPath 表达式（因为使用`//`缩写会导致从顶部元素节点开始扫描整个（子）树）将如下所示：

```
count(/*/quote) 
```

**将所有这些放在一起，我们得到以下转换**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 >
 <xsl:output method="html"/>

    <xsl:template match="/">
        <xsl:value-of select="count(/*/quote)"/>
    </xsl:template>
</xsl:stylesheet> 
```

**它产生了想要的结果**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T04:47:03.670

它似乎在 Firefox 3 和 IE6 中运行良好。有关您的设置的更多信息？

# vim - 使用 vi 在 c 中显示函数

> ID：736704
> 
> 赞同：0
> 
> 时间：2009-04-10T04:27:58.507
> 
> 标签：vim, editor

有没有办法使用 vim 显示 C 源文件中的所有函数。简要编辑器提供此功能。这对我有很大帮助。

注意：这不是编程问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T05:03:01.183

我认为[Taglist](http://www.vim.org/scripts/script.php?script_id=273)插件是您正在寻找的。它在侧边栏中显示函数、类等，旨在使源代码浏览更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T13:37:16.687

我用这个。[0扫描](http://www.vim.org/scripts/script.php?script_id=2507)

您可以使用标签搜索机制对当前文件中的所有函数进行增量搜索。

[0scan](http://www.vim.org/scripts/script.php?script_id=2507)旨在执行许多不同的搜索。[在这里](http://www.railmoon.com/0scan/scan-current-file-ctags)您可以找到如何在当前文件中搜索函数和对象。

# .net - 如何防止 .net 应用程序因突然断电而丢失数据？

> ID：736712
> 
> 赞同：0
> 
> 时间：2009-04-10T04:36:28.313
> 
> 标签：.net, winforms, ups

我们正在开发一个 RetailPOS .net (windows) 应用程序。

一位客户问“突然断电时，应用程序中正在处理的当前数据会发生什么？”，“应用程序能否恢复未保存的数据？”

我想知道，如何将这个功能包含在 .net 应用程序中？

有人可以帮助我，为此需要做些什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T04:39:07.807

首先，查看 UPS（不可中断电源）

其次，考虑创建持久事务，这些事务将尽早且经常保存，但在您告诉它之前不会提交。这一点超出了 TSQL 中的典型事务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T04:41:41.610

如果是硬断电（比如笔记本电脑上的电池在拔掉电源时拔掉了），那么除了每次都写入磁盘之外，您无能为力。步。的。这。方式。（谈论性能损失。）并且还要确保您记录了一些内容，以让应用程序知道它何时启动备份它之前正在执行的操作，以便它可以继续或重试操作。

如果是断电，例如按下电源按钮以关闭/睡眠/休眠计算机，则侦听 SystemEvents.PowerModeChanged 事件并采取相应措施。

最后，确保如果您的数据在中途写入数据库时​​会损坏，请确保您的数据库写入是原子的（所有更改都发生并被接受，或者它们都不被接受）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T05:40:25.430

您可以将当前接收到的信息附加到文件系统中。这将影响性能，但可以让您回到最后一个被捕获的项目。

当应用程序启动时检测是否有挂起的文件，并提供恢复选项。适当地加载保存在文件中的数据。

一旦您掌握了所有信息，当您执行付款时发生的流程时，请确保以原子方式记录流程中的任何重大更改。如果您正在访问外部系统，请记录您启动操作的时间以及它立即返回的时间。在上述情况下，总有一个时间窗口可能会失败，但您希望将其保持尽可能短，并为恢复过程提供足够的信息。最坏的情况是，如果系统无法自动恢复，您希望它有足够的信息来确定它在进程中停止的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T04:41:23.467

PowerFailureException 类将解决这个问题。实际上只是用UPS维持电源。唯一的其他选择实际上是维护数据库事务的原子性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T04:45:32.427

您真正想要的是磁盘事务的原子性。有很多方法可以执行这些操作，但通常如果您使用现有的数据库产品，它会为您完成。

如果您推出自己的数据库或文件格式，您可以根据您的文件格式为您完成一些工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-25T01:32:24.810

您可能需要考虑让您的应用程序使用[SQLite](http://www.sqlite.org)。

他们有一些关于[何时使用 page](http://www.sqlite.org/whentouse.html)的重要信息。

一些突出的点是：

> *   随着应用程序内容的修改，更新自动发生
>     
>     
> *   内容会持续自动更新，因此在发生电源故障或崩溃时不会丢失任何工作。

我正在为我将要实现的应用程序寻找类似的选项，该选项将在第三世界国家/地区使用，那里全天经常断电……到目前为止，SQLite 似乎是一个不错的选择.

但归根结底，您的选择将取决于您的个人情况和要求。

# c# - 如何创建自定义 System.Windows.Media.Brush？

> ID：736724
> 
> 赞同：1
> 
> 时间：2009-04-10T04:42:56.863
> 
> 标签：c#, .net

我找不到任何关于实现继承类的文档`System.Windows.Media.Brush`——它需要提供什么来完成这项工作？

我的具体目标是三角形渐变；如果我能找出如何实际实现一个新画笔，我就能处理计算颜色的细节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T05:30:36.577

似乎没有任何扩展指南`System.Windows.Media.Brush`。但看起来他们提供了一个画笔，可以渲染你给它的绘图。[`DrawingBrush`](http://msdn.microsoft.com/en-us/library/system.windows.media.drawingbrush.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-22T20:17:25.093

出于性能原因，通过添加内部抽象方法，似乎 Brush 和其他绘图原语被显式密封或阻止子类化。

请参阅Microsoft[的这篇文章](http://www.ureader.com/message/884678.aspx)。

[鉴于MSDN 中的这一行，这](http://msdn.microsoft.com/en-us/library/system.windows.media.brush.aspx)有点误导：

> 继承人注意事项：
> 
> 从 Brush 类继承时，必须重写 CreateInstanceCore 方法。根据您的类是必须执行额外的初始化工作还是包含非依赖属性数据成员，您可能需要覆盖额外的 Freezable 方法。有关从 Freezable 类型继承的更多信息，请参阅 Freezable 对象概述。

这似乎暗示如果他们给继承者注释应该可以从 Brush 继承，但是 Brush 有一些内部抽象方法不能被第三方类覆盖。

# html - 如何在 XSLT 中将文本格式化为粗体、下划线

> ID：736725
> 
> 赞同：1
> 
> 时间：2009-04-10T04:43:42.617
> 
> 标签：html

我有一些 XML 代码。我想使用 XSLT 将其转换为 HTML 。问题是我想将输出文本格式化为粗体和下划线。但我不知道如何在 XSLT 中将文本格式化为粗体和下划线。

你能帮帮我吗？请为此提供一些示例代码。太感谢了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-10T04:46:36.090

如果您要生成 HTML，则使用 HTML 进行格式化：

```
<b>bold</b> <u>underline</u> <strong>strong</strong> 
```

...或CSS：

```
<span style="font-weight:bold;text-decoration:underline;">
   bold underlined
</span> 
```

# asp.net-mvc - DiggBar 是如何工作的？

> ID：736730
> 
> 赞同：5
> 
> 时间：2009-04-10T04:47:10.143
> 
> 标签：asp.net-mvc, css, digg

DiggBar 是如何工作的？

我正在尝试制作一个 ASP.NET MVC DiggBar 克隆只是为了学习目的，有没有人建议如何为下框架指定内容的 url？您将如何在 MVC 中构建它？

另外，我知道它是一个 iFrame，但是他们如何定位它，所以无论滚动它都保持在顶部？它是 CSS 魔法吗？

![替代文字](https://imgur.com/IBFBW.png)

编辑：我对你是否喜欢它们不感兴趣。我不会将其投入生产，也不会询问它们是否是好的设计。我只是~想做一个。

我发现 DiggBar 很有用，我喜欢它。地狱，您可以单击两次将其关闭！同样，reddit 有一个 reddit 栏，可以选择加入（可能是更好的方法）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T16:01:45.530

基本`html`情况是：

```
<html>
<head>
  <style type="text/css">
    #toolbar {position: fixed; top: 0; height: 40px; width: 100%; ... }
    #page {width: 100%; height: 100%;}
  </style>
</head>
<div id="toolbar">
  All your toolbar stuff here.
</div>
<iframe id="page" name="page" src="http://url.to/page" frameborder="0" noresize="noresize"></iframe>
</html> 
```

你会在你自己的 URL 上有一个 slug 映射到页面的 URL，例如
`d1oKo3 => http://news.bbc.co.uk/2/hi/technology/7991708.stm`

您的视图所要做的就是查找映射并将页面的 URL`iframe`放入`src`. 只要确保您有办法让用户选择退出，因为有些人不喜欢这种工具栏。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-06T12:05:53.800

在你看来，这很可能是互联网上的一个可怕的灾难，但这不是那个人所问的——你为什么认为有人关心你是否认为这些工具栏应该存在于那里？没有人要求您使用 em。

如果您觉得他们不应该那么简单地退出并让其他人回答问题。毕竟，如果他们真的如此不受欢迎，人们会用他们的老鼠投票并去其他地方，部署他们的网站将减少到一无所有。这就是网络的伟大之处，它不需要无能的极客口述什么是好的，什么不是人们可以自己决定的。

快乐的编码方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T04:53:06.683

首先，请不要做那样的事情，我不知道有谁喜欢这些事情。

可以使用 CSS 将某些内容保持在顶部：

```
position: fixed; 
```

至于指定 URL，我不确定你在问什么。当你现在点击 digg 上的链接时，目标 URL 是这样的：

```
http://digg.com/d1oIyx 
```

“d1oIyx”将仅用作数据库的主键，他们将在其中存储要加载到底部 iframe 中的 URL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-06T11:54:35.320

谢谢，我找到了一个可行的解决方案（附加），但是我如何使它成为整页 iframe？

工作链接：[http ://www.clalit.org/2.php?link=http://cnn.com](http://www.clalit.org/2.php?link=http://cnn.com)

```
<?php
$link=$_GET["link"];
echo "<iframe src=\"$link\"/>";
?> 
```

# algorithm - 有人知道OLAP Internals吗？

> ID：736731
> 
> 赞同：29
> 
> 时间：2009-04-10T04:48:35.837
> 
> 标签：algorithm, data-structures, theory, olap, cubes

我对数据库内部了解一些。我之前实际上已经实现了一个小型、简单的关系数据库引擎，使用磁盘上的 ISAM 结构和 BTree 索引以及所有类似的东西。这很有趣，而且很有教育意义。我知道我对仔细设计数据库模式和编写查询更加了解，因为我对 RDBMS 如何在幕后工作有了更多了解。

但是我对多维 OLAP 数据模型一无所知，而且我很难在互联网上找到任何有用的信息。

信息如何存储在磁盘上？多维数据集包含哪些数据结构？如果 MOLAP 模型不使用包含列和记录的表，那么……什么？尤其是在高维数据中，什么样的数据结构让 MOLAP 模型如此高效？MOLAP 实现是否使用类似于 RDBMS 索引的东西？

为什么 OLAP 服务器在处理即席查询方面表现得如此出色？*在普通关系数据库中可能需要数小时*才能处理的相同类型的聚合可以在 OLTP 多维数据集中以毫秒为单位进行处理。使这成为可能的模型的基本机制是什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-10T05:04:42.990

我已经实现了几个模仿 OLAP 多维数据集的系统，下面是我们为使它们工作而做的一些事情。

1.  核心数据保存在一个 n 维数组中，全部在内存中，所有键都是通过指向底层数组的指针层次结构实现的。通过这种方式，我们可以为相同的数据拥有多组不同的键。数组中的数据相当于事实表，通常它只有几条数据，在一个例子中是价格和销售数量。

2.  底层数组通常是稀疏的，因此一旦创建它，​​我们就会删除所有空白单元格以节省内存 - 大量的硬核指针算法，但它有效。

3.  由于我们有键的层次结构，我们可以很容易地编写例程来轻松地向下钻取/向上钻取层次结构。例如，我们将通过月份键访问年份数据，而月份键又映射到天和/或周。在每个级别，我们将聚合数据作为构建多维数据集的一部分 - 使计算速度更快。

4.  我们没有实现任何类型的查询语言，但我们确实支持在所有轴上向下钻取（在我们最大的立方体中最多 7 个），这与用户喜欢的 UI 直接相关。

5.  我们在 C++ 中实现了核心内容，但这些天我认为 C# 可能足够快，但我担心如何实现稀疏数组。

希望有帮助，听起来很有趣。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-01-27T03:30:20.783

《[Microsoft SQL Server 2008 Analysis Services Unleashed](https://rads.stackoverflow.com/amzn/click/com/0672330016) 》一书详细阐述了 SSAS 2008 的一些特性。这不是“这就是 SSAS 在幕后工作的确切方式”，但它很有启发性，尤其是在数据结构方面。（关于确切的算法，它没有那么详细/具体。）作为该领域的业余爱好者，我从这本书中收集了一些东西。这都是关于 SSAS MOLAP 的：

*   尽管所有关于多维立方体的讨论，事实表（又名度量组）数据仍然是，第一个近似值，最终存储在基本的二维表中，每个事实一行。许多 OLAP 操作似乎最终都包括对 2D 表中的行的迭代。
*   然而，MOLAP 中的数据可能比相应 SQL 表中的数据小得多。一个技巧是每个唯一的字符串只存储一次，在“字符串存储”中。然后，数据结构可以以更紧凑的形式（基本上通过字符串 ID）引用字符串。SSAS 还以某种形式压缩 MOLAP 存储中的行。我认为这种缩小可以让更多数据同时保留在 RAM 中，这很好。
*   同样，SSAS 通常可以迭代数据的一个子集，而不是整个数据集。有一些机制在起作用：
    *   默认情况下，SSAS 为每个维度/属性值建立一个哈希索引；因此，它“立即”知道磁盘上的哪些页面包含相关数据，例如 Year=1997。
    *   There's a caching architecture where relevant subsets of the data are stored in RAM separate from the whole dataset. For example, you might have cached a subcube that has only a few of your fields, and that only pertains to the data from 1997\. If a query is asking only about 1997, then it will iterate only over that subcube, thereby speeding things up. (But note that a "subcube" is, to a first approximation, just a 2D table.)
    *   If you're predefined aggregates, then these smaller subsets can also be precomputed at cube processing time, rather than merely computed/cached on demand.
*   SSAS fact table rows are fixed size, which presumibly helps in some form. (In SQL, in constrast, you might have variable-width string columns.)
*   The caching architecture also means that, once an aggregation has been computed, it doesn't need to be refetched from disk and recomputed again and again.

These are some of the factors in play in SSAS anyway. I can't claim that there aren't other vital things as well.

# sql-server - 跟踪有序 smalldatetime 列的最佳方法

> ID：736735
> 
> 赞同：0
> 
> 时间：2009-04-10T04:50:37.470
> 
> 标签：sql-server, datetime, timestamp

我知道 smallDateTime 和 timeStamp 之间的区别。现在我正在使用 smallDateTime，因为精度足以满足我的需求。但问题是我仍然需要保持插入的项目井井有条，如果插入物彼此靠得太近，smallDateTime 就会混淆。

同时使用 smallDateTime 和 timeStamp 字段是否可以接受？我会使用 smallDateTime 来了解何时插入项目，并使用 timeStamp 字段按时间顺序排序。

注意：我不认为使用 DateTime 是一个有效的解决方案，因为如果插入速度足够快，它在保持事物有序方面也会遇到同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T04:58:43.080

使用自动生成的身份字段作为主键怎么样？我认为使用合成键是一个非常好的主意，再加上自然键上的唯一索引。这将解决您的排序问题，因为记录将按主键排序。

# drupal - Drupal 内容块中的多个部分

> ID：736755
> 
> 赞同：1
> 
> 时间：2009-04-10T04:59:36.573
> 
> 标签：drupal

如何在 Drupal 的内容块中创建多个部分？

当用户访问我的主页时，会显示一个主页；此页面将在中间面板包含几个部分。其中一个部分是新闻更新部分，另一个是视频频道，就像[mtv UK](http://www.mtv.co.uk/)在主页中间部分的样子。

[http://lh6.ggpht.com/_SDci0Pf3tzU/Sd7SEwzEbhI/AAAAAAAAEqc/ROuP7fXkRSk/s400/section.png](http://picasaweb.google.com/lh/photo/i8bt_NIExHjD2oEXvULrpA?feat=embedwebsite)

创建这种网站布局需要哪些模块？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T06:24:28.040

该站点主要使用[Panels](http://drupal.org/project/panels)和[Nice Menus](http://drupal.org/project/nice_menus)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T05:46:47.240

视图和面板模块的组合将能够做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-25T15:08:35.407

您可能还想尝试复合布局模块（我发现它比面板更易于使用和主题）：[http](http://drupal.org/project/composite) ://drupal.org/project/composite （不幸的是，D7 尚不可用）

# c - K&R 第 1 章 - 练习 22 的解法，你怎么看？

> ID：736759
> 
> 赞同：10
> 
> 时间：2009-04-10T05:02:39.420
> 
> 标签：c, kr-c

我正在从 k&r 学习 C 作为第一语言，我只是想问一下，如果你认为这个练习以正确的方式解决，我知道它可能没有你想要的那么完整，但我想要意见，所以我知道我正在学习 C 正确。

谢谢

```
/* Exercise 1-22\. Write a program to "fold" long input lines into two or
 * more shorter lines, after the last non-blank character that occurs
 * before then n-th column of input. Make sure your program does something
 * intelligent with very long lines, and if there are no blanks or tabs
 * before the specified column.
 * 
 * ~svr
 *
 * [NOTE: Unfinished, but functional in a generic capacity]
 * Todo:
 * Handling of spaceless lines
 * Handling of lines consisting entirely of whitespace
 */

#include <stdio.h>
#define FOLD 25
#define MAX 200
#define NEWLINE '\n'
#define BLANK ' '
#define DELIM 5
#define TAB '\t'

int
main(void)
{
    int line  = 0, 
        space = 0,
        newls = 0,
            i = 0, 
            c = 0, 
            j = 0;

    char array[MAX] = {0};

    while((c = getchar()) != EOF) {
        ++line;
        if(c == NEWLINE)
            ++newls;
        if((FOLD - line) < DELIM) {
            if(c == BLANK) {
                if(newls > 0) {
                    c = BLANK;
                    newls = 0;
                }
                else
                    c = NEWLINE;
                line = 0;
            }
        }
        array[i++] = c;
    }
    for(line = 0; line < i; line++) {
        if(array[0] == NEWLINE)
            ;
        else
            printf("%c", array[line]);
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-10T06:45:05.523

我相信你在正确的轨道上，但有一些可读性的指针：

*   评论你的东西
*   正确命名变量，如果您拒绝，至少给出描述
*   因此，一些单行 if 是你使用的，而另一些你不使用。（恕我直言，请始终使用 {} 以使其更具可读性）
*   最后一个 for 循环中的 if 语句可以更好，比如

```
 if(array[0] != NEWLINE)  
    {   
        printf("%c", array[line]); 
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T10:38:29.847

恕我直言，这不好。

首先，它不符合您的要求。您应该在输出行边界之前的非空白之后找到最后一个空白。您的程序甚至没有远程尝试这样做，它似乎在努力寻找 (margin - 5) 个字符之后的第一个空白（5 来自哪里？如果所有单词都有 9 个字母怎么办？）。但是它也没有这样做，因为您使用 newls 变量进行了操作。另外，这个：

```
for(line = 0; line < i; line++) {
    if(array[0] == NEWLINE)
        ;
    else
        printf("%c", array[line]);
} 
```

可能是错误的，因为您检查了一个在整个循环中永远不会改变的条件。

最后但同样重要的是，将整个文件存储在固定大小的缓冲区中并不好，原因有两个：

*   缓冲区必然会在大文件上溢出
*   即使它永远不会溢出，人们仍然不喜欢你存储例如。内存中的千兆字节文件，只是为了将其切成 25 个字符的块

我认为您应该重新开始，重新考虑您的算法（包括极端情况），然后才开始编码。我建议你：

*   逐行处理文件（意思是输出行）
*   将该行存储在足够大的缓冲区中以容纳最大的输出行
*   在缓冲区中搜索要中断的字符
*   然后打印它（提示：您可以使用 '\0' 终止字符串并使用 打印`printf("%s", ...)`），将未打印的内容复制到缓冲区的开头，然后继续

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T05:58:53.793

一个明显的问题是您静态分配“数组”并且在访问它时从不检查索引限制。等待发生的缓冲区溢出。事实上，你从来没有在第一个循环中重置 i 变量，所以我对程序应该如何工作感到有点困惑。似乎您在打印单词包装之前将完整的输入存储在内存中？

因此，建议：将两个循环合并在一起并打印您已完成的每一行的输出。然后您可以将数组重新用于下一行。

哦，还有更好的变量名和一些注释。我不知道'DELIM'应该做什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T05:59:58.877

它看起来（未经测试）可以工作，但似乎有点复杂。

这是我第一个想到的一些伪代码

```
const int MAXLINE = ??  — maximum line length parameter
int chrIdx = 0 — index of the current character being considered 
int cand = -1  — "candidate index",  Set to a potential break character
char linebuf[bufsiz]
int lineIdx = 0 — index into the output line
char buffer[bufsiz]   — a character buffer
read input into buffer
for ix = 0 to bufsiz -1
do     
   if buffer[ix] == ' ' then
      cand = ix
   fi
   linebuf[lineIdx] = buffer[ix]
   lineIdx += 1
   if lineIdx >= MAXLINE then
      linebuf[cand] = NULL — end the string
      print linebuf
      do something to move remnants to front of line (memmove?)
   fi
 od 
```

已经很晚了，我刚拿到一条腰带，所以可能有缺陷，但它显示了总体思路——加载一个缓冲区，并将缓冲区的内容复制到一个行缓冲区，跟踪可能的断点。当你接近尾声时，使用断点。

# c# - 从 SQL Server Express 表列到数据集的默认值？

> ID：736766
> 
> 赞同：0
> 
> 时间：2009-04-10T05:05:38.493
> 
> 标签：c#, .net, sql-server-express

我是一名新的数据库编程学习者。我正在使用 C# (.NET 3.5) 和 SQL Server Express。

我正在关注 Microsoft 的 Forms over Data 视频系列。但是，我正在创建一个与视频中创建的数据库不同的数据库。

在其中一个表中，我希望将当前日期/时间插入到日期列中，因此我使用 getdate() 函数作为默认值，该函数是我使用 SQL Server Management Studio 设置的。当我使用 SQL Server Management Studio 在该表中插入新行时，该列会更新得很好。

但是，当我使用 Windows 窗体以及为此特定表的数据集自动生成的数据网格时，它不会使用默认值进行更新。

我想我在这方面遗漏了一些东西。如果有人能指出我正确的方向，那将非常有帮助。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T05:13:27.587

生成查询时，不要将日期作为参数传递，或者将 DateTime.Now 或 DateTime.UTCNow 作为“当前时间”传递

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T16:26:03.240

由于您使用 GETDATE() 设置列的默认值，我什至不会在查询中包含该列，让 SQL 继续为您设置它。我希望我能正确理解你的问题

# php - 如何使用 PHP 进行文本 DIFF？

> ID：736771
> 
> 赞同：5
> 
> 时间：2009-04-10T05:09:10.857
> 
> 标签：php, shell, diff

对 PHP 执行此操作的最佳方法是什么？考虑到列内容可能非常大，是否有任何 PHP 函数可以做到这一点？

如果 PHP 函数不可用，我可以调用什么 shell 实用程序？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-10T06:29:37.870

PHP 中没有任何内置的 diff 函数。但是，PEAR 万岁：[Text_Diff](http://pear.php.net/package/Text_Diff)（从未使用过它，但我相信 PEAR）。

甚至还有一个 PECL 包[xdiff](http://pecl.php.net/package/xdiff)

提示：pear 类是纯 php，pecl 包是模块。通常，模块比类快，但这也取决于功能。你只需要测试和评估。

用于存储：我会存储纯文本，而不是差异。空间很便宜，许多数据库（例如mysql）支持数据压缩（或者你可以在php中解压缩），但如果你存储明文，你就独立于diff算法，如果需要可以在以后更改它。

如果你需要速度，你可以存储明文和差异。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T05:11:38.387

通常的过程是存储每个不同的修订并在用户想要查看它时计算差异，如果该过程很昂贵，可能会缓存该输出。

您可以存储一个基本修订版，然后拥有一组可用于获取先前版本的差异。

无论哪种情况，都需要做出让步；第一个选项使检索特定版本变得便宜，但代价是差异需要更多的处理；第二个使查看差异变得便宜，但代价是可能需要昂贵的增量补丁才能获得特定版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T06:41:50.523

如果内容很大，而且改动很小，你可以考虑采用“reverse delta”的方法：只有最新版本的文本以完整格式存储，之前的版本是与最新版本的差异版本为上一个。

它将节省大量存储空间，但比较两个修改次数较多的版本，该过程的成本可能相当可观。毕竟，它始终是存储空间和处理要求之间的权衡。

如果您不能或不想使用 PEAR 和 PECL，您仍然可以使用 exec 调用的 diff 实用程序。我肯定会选择标准的差异格式，并且永远不会开发自己的差异格式。

# sysadmin - 创建 solaris 区域

> ID：736772
> 
> 赞同：2
> 
> 时间：2009-04-10T05:10:09.090
> 
> 标签：sysadmin, containers, opensolaris

对于这些部分：

zonecfg:[区域名称]:net> 设置地址= zonecfg:[区域名称]:net> 设置物理=

我怎么知道我应该设置什么样的值？

我正在使用 vmware 机器打开 solaris 并当前设置区域。

我希望能够进入那个区域。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T05:43:44.173

这实际上很简单，[Zones FAQ](http://hub.opensolaris.org/bin/view/Community+Group+zones/faq)有大部分问题，但基础是

*   使用[*zonecfg(1)*](http://hub.opensolaris.org/bin/view/Community+Group+zones/faq#HQ:HowdoIcreateazone3F)[创建区域](http://docs.oracle.com/cd/E19044-01/sol.containers/817-1592/z.config.ov-1/index.html)[](http://hub.opensolaris.org/bin/view/Community+Group+zones/faq#HQ:HowdoIcreateazone3F) **   区域配置数据的详细信息在[这里，](http://docs.oracle.com/cd/E19044-01/sol.containers/817-1592/z.config.ov-12/index.html)但通常默认值很有用
    *   你可能想要一个[共享 IP 配置](http://docs.oracle.com/cd/E19044-01/sol.containers/817-1592/z.admin.ov-9/index.html)，除非你用 vmware 做了一些创造性的事情* 
**   以 root 身份登录到区域*   确保 ssh 服务正在运行*

 *然后你应该被设置。阅读[有关 Zones 的 BigAdmin 文章](http://www.sun.com/bigadmin/content/zones/)和[Sysadmin 指南部分](http://docs.oracle.com/cd/E19044-01/sol.containers/817-1592/)也不会受到伤害。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T09:47:36.163

由于您想从外部通过 SSH 进入区域，因此它需要在与全局区域相同的网络上拥有自己的 IP 地址。因此，要么在同一个网络中找到一个空闲地址，要么让你的网络管理员分配一个——无论你通常做什么。

对于“物理”设置；这里（我认为）是最简单的情况：如果您为 VM 分配了一个虚拟网络接口，则将该接口用于“物理”设置

所以，在全局区域，做

```
/usr/sbin/ifconfig -a 
```

列出您的接口。它应该说类似

```
 lo0:1: flags=2001000849<UP,LOOPBACK,RUNNING,MULTICAST,IPv4,VIRTUAL> mtu 8232 index 1
    inet 127.0.0.1 netmask ff000000 
 bge0:1: flags=1000843<UP,BROADCAST,RUNNING,MULTICAST,IPv4> mtu 1500 index 2
    inet 123.45.123.45 netmask ffffff00 broadcast 123.45.123.255 
```

这里的接口名称是 bge0。（lo0 是环回接口；您不希望这样）您的可能会被称为不同的东西 - 可能是 e1000g0，具体取决于 VMWare 提供的网络接口类型。

请注意，由于您在全局区域和子区域中使用相同的网络接口，因此您必须在与全局区域相同的子网上为子区域选择 IP 地址。在上面的示例中，bge0 的网络掩码是 255.255.255.0，这意味着您的子区域 IP 需要介于 123.45.123.0 和 123.45.123.254 之间

# c# - Instantiating custom .NET types in IronPython

> ID：736781
> 
> 赞同：0
> 
> 时间：2009-04-10T05:18:05.937
> 
> 标签：c#, .net, ironpython

Assume the following code:

```
public class Foo
{
    public string Bar { get; set; }
} 
```

How can I instantiate an instance of Foo in the following code?

```
ScriptRuntimeSetup setup = Python.CreateRuntimeSetup(null);
ScriptRuntime runtime = new ScriptRuntime(setup);
ScriptEngine engine = Python.GetEngine(runtime);
ScriptScope scope = engine.CreateScope();

string script = @"x = ***???***";
ScriptSource source = engine.CreateScriptSourceFromString(script, SourceCodeKind.Statements);
source.Execute(scope); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T05:28:19.047

```
string script = @"
  import clr
  clr.AddReference('FooNamespace')
  from FooNamespace import *
  x = Foo()"; 
```

# c++ - 调用 OpenCV 方法 cvLoadImage() 时 CoInitializeEx 失败

> ID：736782
> 
> 赞同：4
> 
> 时间：2009-04-10T05:20:08.537
> 
> 标签：c++, windows, mfc, opencv, directshow

我正在尝试将一些 OpenCV 功能集成到我的应用程序中。目前，我使用 DirectShow 设置了代码，以从我的相机获取视频源，然后显示在 MFC 窗口中。此代码无法更改或删除。

代码运行完全正常，但无论我放置以下代码行的位置如何：

```
IplImage *img = cvLoadImage("C:/well.jpg"); 
```

网络摄像头无法正确初始化并中断程序。

更直接地，我在以下位置得到一个失败的 HRESULT：

```
CoInitializeEx(NULL, COINIT_APARTMENTTHREADED) 
```

更具体地说，在我的代码中的某个时刻，我调用 CDialog::doModal()，然后它会命中 CoInitializeEx()，从而使程序失败。

有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T05:30:21.553

如果线程先前被初始化为不同的单元，则 CoInitialize 将失败，即，如果之前存在 CoInitializeEx(NULL, COINIT_MULTITHREADED)

我猜 OpenCV 会调用 CoInitializeEx(NULL, COINIT_MULTITHREADED)，导致您随后对 CoInitializeEx 的调用失败。您可以通过检查 CoInitializeEx 的返回来确认这一点 - 在这种情况下它将是 RPC_E_CHANGED_MODE。

没有直接的解决方法，最直接的方法是将 OpenCV 调用移动到单独的线程中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T07:51:49.623

除了迈克尔所说的检查外部依赖 DLL 之外，如果缺少一个，CoInitialize 也会失败。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-19T08:55:20.847

我有一个类似的问题。在我的 MFC 应用程序中，调用`AfxOleInit`失败并显示`RPC_E_CHANGED_MODE`.

我不能忽略失败（我需要应用程序内的 COM），也不能将 OpenCV 调用移动到不同的线程（正如 Michael 正确建议的那样）。

我找到了解决我的问题的线程[“wxwidgets and opencv 1.1 ole initialization error”](http://tech.dir.groups.yahoo.com/group/OpenCV/message/58089)：我不需要 OpenCV 的视频输入支持，所以我可以按照[http://tech.dir.groups.yahoo.com](http://tech.dir.groups.yahoo.com/group/OpenCV/message/60060)`#define HAVE_VIDEOINPUT 1`中的建议删除[/group/OpenCV/message/60060](http://tech.dir.groups.yahoo.com/group/OpenCV/message/60060)

> 转到`_highgui.h`，注释第 96 行（“ `#define HAVE_VIDEOINPUT 1`”）并重新编译

它适用于 OpenCV_1.1pre1a。

# javascript - 从 ajax 返回的数据对象中读取多个变量

> ID：736783
> 
> 赞同：2
> 
> 时间：2009-04-10T05:21:53.587
> 
> 标签：javascript, jquery, asp.net-mvc, ajax

我正在对 mvc 控制器进行 jquery ajax 调用。我想从控制器返回 2 个或更多变量。我如何为此在控制器中打包数据？我如何用jquery提取？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T11:41:37.823

在您的控制器操作中，使用内置的 Json 方法：

```
return Json(new {name1 = "value1", name2 = "value2"}); 
```

还有你的 jQuery 调用：

```
$.ajax({
    type: "POST",
    url: "/your-url",
    dataType: "json",
    data: {data: to_send},
    success: function(msg) {
       alert(msg.name1);
       alert(msg.name2);
    }
});
//you can of course use another ajax function jQuery provides. 
```

# .net - 如何在 C++ 中使用 .Net 的命名空间？

> ID：736786
> 
> 赞同：1
> 
> 时间：2009-04-10T05:27:30.423
> 
> 标签：.net, c++-cli

如何使用 C++ 中的 .NET 框架命名空间？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T09:27:52.233

## C# 将是

```
using System;

using System.Configuration; 
```

## C++ 将是

```
using namespace System;

using namespace System::Configuration; 
```

* * *

不要忘记在 C++ 项目属性中引用这些库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T05:32:42.813

您可以在托管 C++ 中执行此操作。使用 #using 指令并像往常一样使用命名空间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T05:37:03.363

从这里开始：[纯 C++：你好，C++/CLI](http://msdn.microsoft.com/en-us/magazine/cc163681.aspx "MSDN 杂志")

# wpf - 如何从 WPF 中的 Gridview 列控件中读取值

> ID：736789
> 
> 赞同：1
> 
> 时间：2009-04-10T05:30:18.840
> 
> 标签：wpf, gridview, textbox

我有一个 listview 控件，它有 3 个 gridview 列。我正在使用来自代码隐藏文件的数据表填充列表视图。第一个 Gridview 列有一个标签控件，其余 2 个 gridview 列有文本框控件。

我的问题是，如果用户在第一个 Gridview 文本框列中输入一个值，则第二个 gridview 文本框列应该更新为某个值。有没有办法做到这一点。

还有什么方法可以获取第一个 gridview 列中标签控件的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T05:45:07.557

您可以使用 ElementName 绑定将两个 TextBox 绑定在一起。他们所在的 Grid 列是无关紧要的。下面的示例将导致 textBox2 中的文本自动更新为 textBox1 中输入的文本。

```
 <TextBox Text="TextBox" Name="textBox1" />
    <TextBox Text="{Binding ElementName=textBox1, Path=Text}" Name="textBox2"/> 
```

如果需要使用不同的值更新第二个文本框，您可以删除上述绑定，而是以编程方式进行：

```
textBox2.Text = textBox1.Text + " some text"; 
```

要获取 Label 控件的值，您需要为其分配一个名称，然后您可以使用该名称在代码隐藏文件中访问它。

XAML：

```
<Label Name="myLabel" Content="Label"/> 
```

C＃：

```
 // Assuming you have assigned text content to the Label as in the above XAML.
 string labelContent = myLabel.Content as string; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T05:54:14.507

从我所见，WPF GridView 只是 ListView 控件的一种视图模式（外观和感觉）。与 WPF 中的大多数内容一样，我建议您使用 ViewModel 模式来执行此操作。

*   这意味着您已经为 Grid 中的每一行创建了一个 ViewModel 对象。真正的模型将是您的 DataTable 行。视图模型以来自真实模型的数据为种子。即，您从 DataTable 中的每一行创建一个新的 ViewModel 实例。然后使用 ViewModel 对象填充 Grid
*   View 模型为您需要在实际视图中显示的每个值公开属性。因此，在这种情况下，您的 ViewModel 将公开 3 个属性（对于每一列）。
*   连接您的 UI 列以绑定到 ViewModel 中的相应属性。
*   现在，您的 ViewModel.Property1 将包含在更改时使用正确的计算值更新 Property2 的逻辑。它们都应该触发 PropertyChanged 通知，并且 GridView 应该反映两个单元格中的更新值。

# c# - 在代码 dom 中如何使用内置属性

> ID：736798
> 
> 赞同：0
> 
> 时间：2009-04-10T05:36:50.477
> 
> 标签：c#, code-generation

```
CodeVariableDeclarationStatement hashTableParam = new CodeVariableDeclarationStatement();
hashTableParam.Name = "hastable";
hashTableParam.Type = new CodeTypeReference(typeof(System.Collections.Hashtable)); 
```

在这里，我创建了一个`hashtable data type`using `code dom`.

现在我想对我使用它的内置属性`add`，`clear`等等。更清楚我想在代码 dom 中实现与此类似的代码。

```
ht.add("key","value"); 
```

我试着这样做

```
CodeVariableDeclarationStatement hashTableParam = new CodeVariableDeclarationStatement();
hashTableParam.Name = "hastable";
hashTableParam.Type = new CodeTypeReference(typeof(System.Collections.Hashtable));

CodeMethodInvokeExpression invokeExp2 = new CodeMethodInvokeExpression(new CodeVariableReferenceExpression(hashTableParam.Name), "add");
invokeExp2.Parameters.Add(new CodeArgumentReferenceExpression("key"));
invokeExp2.Parameters.Add(new CodeArgumentReferenceExpression("value"));
// CodeStatementCollection statements = new CodeStatementCollection();
return hashTableParam; 
```

但我无法在`invokeExp2`和之间建立联系`hashtableparam`。

有没有其他解决方案可以在内置属性中使用我正在尝试使用它有用户定义

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T06:04:04.233

您在那里的代码看起来像您正在尝试将**键**和**值**参数的值传递给您正在构建哈希表的添加方法的方法：

```
void GeneratedMethod( string key, string value )
{
    ...
    hashtable.add( key, value );
} 
```

如果您尝试传递实际的单词“key”和“value”，它看起来更像这样：

```
invokeExp2.Parameters.Add( new CodePrimitiveExpression( "key" ) );
invokeExp2.Parameters.Add( new CodePrimitiveExpression( "value" ) ); 
```

您还设置了它以将 hashTableParam 变量本身视为一种方法。相反，您需要使用[CodeMethodReferenceExpression](http://msdn.microsoft.com/en-us/library/system.codedom.codemethodreferenceexpression.aspx)。

```
invokeExp2 = 
new CodeMethodInvokeExpression(
    new CodeMethodReferenceExpression( 
        new CodeVariableReferenceExpression( hashTableParam.Name ),
        "add" )        
) 
```

# java - 所有数据包的一个侦听器与处理特定类型的单独侦听器

> ID：736802
> 
> 赞同：0
> 
> 时间：2009-04-10T05:38:38.133
> 
> 标签：java, design-patterns, xmpp

Smack 的 XMPPConnection 实现了一种从 jabber 服务器接收 XMPP 响应的事件驱动方式。方法[addPacketListener](http://www.igniterealtime.org/builds/smack/docs/latest/javadoc/org/jivesoftware/smack/XMPPConnection.html#addPacketListener) (org.jivesoftware.smack.PacketListener, org.jivesoftware.smack.filter.PacketFilter) 允许您指定自己的自定义侦听器。我正在维护一个 PacketListener 处理所有类型的传入消息的代码。为了改进设计（向[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)致敬），我计划创建单独的侦听器来处理特定类型的数据包。这是一个好主意吗 ？另一个问题是**消息**包可能来自许多 IM 系统，例如 yahoo、google 等...？我是否为每个雅虎、谷歌服务创建单独的处理器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-13T05:45:49.573

我决定使用多个 PacketListeners 选项。一个单独的 PacketListener 会做太多的工作，还有所有的 if-else-statements。

# c# - 为什么使用 APM 而不是使用单独的线程？

> ID：736809
> 
> 赞同：2
> 
> 时间：2009-04-10T05:42:38.107
> 
> 标签：c#, .net, multithreading, asynchronous

如果我想读取或写入文件，我*可以*使用 stream.BeginRead 和 stream.EndRead，但这需要回调和大量使用异步编程模型的丑陋、复杂的代码。

为什么我要使用这些异步 IO 方法（在幕后使用 .NET 线程池）而不是以同步方式编写相同的代码，然后将其传递*给*线程池。（而不是用回调来分割我的方法。）

更新：

一些（好的）响应表明使用 APM 使我免于创建线程——我同意这一点，因为每个新线程都有自己的 2MB 堆栈。但是“BeginRead”和“Endread”在哪里执行？线程池？重用已经分配的线程是唯一的好处吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-10T05:48:29.203

首先，您还应该研究[基于事件的 APM](http://msdn.microsoft.com/en-us/library/wewwczdw.aspx)。

要回答您的问题，您可能正在考虑使用单独的线程并进行同步调用。另一个线程将阻塞等待调用完成。

使用 APM，根本没有线程阻塞。没有从线程池中抽取。这对于像 ASP.NET 这样的服务器应用程序尤其重要，因为这意味着阻塞线程不会阻止请求被处理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T19:28:58.507

Jeff Richter 有一个非常聪明和干净的[方式](http://channel9.msdn.com/posts/Charles/Jeffrey-Richter-and-his-AsyncEnumerator/)来使用 APM。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T05:54:04.290

使用异步调用的优点是您不会在 I/O 上浪费线程阻塞。线程可能很昂贵，因此在执行大量 I/O 的情况下，明智地使用线程是关键。

也就是说，是的，Begin-End APM 非常难用。如果您确实需要非阻塞 I/O 并且可以灵活地为您的应用程序的一部分使用另一种语言，请尝试 F#。“异步工作流程”使编写异步代码变得轻而易举。

# asp.net - 用于 IIS 部署的“管理网站”等效项

> ID：736810
> 
> 赞同：0
> 
> 时间：2009-04-10T05:43:24.113
> 
> 标签：asp.net, iis

在开发过程中，我可以使用 Visual Studio 中的“管理网站”或“ASP.net 配置”命令轻松管理我的用户/角色/smtp 等。将站点部署到 IIS 服务器后，如何获得相同的功能（用户和角色管理）。

我正在使用 IIS 6

# 编辑 1

我的服务器没有博文（JP 的回复）中提到的 Web 服务器可执行文件。所以我从我的开发机器上复制了它。但它仍然无法正常工作。服务器因错误而崩溃：

```
Unhandled Exception: System.IO.FileNotFoundException: Could not load file or ass
embly 'WebDev.WebHost, Version=8.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f
11d50a3a' or one of its dependencies. The system cannot find the file specified. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T05:51:50.100

IIS 管理工具也将在生产服务器上可用。 [这是一篇](http://blogs.neudesic.com/blogs/phil_scott/archive/2006/07/04/187.aspx)关于 ASP.NET 配置的博客文章。网站。

编辑评论：

我不认为你可以把exe复制过来。我认为您至少需要安装[visual web developer](http://www.microsoft.com/express/download/)。这将确保所有依赖项都已安装。

# python - 如何使用 Python 读取 MP3 中的 ID3 标签？

> ID：736813
> 
> 赞同：15
> 
> 时间：2009-04-10T05:45:24.513
> 
> 标签：python, tags, mp3, id3

有没有人有在 MP3 文件或 WMA 文件中读写 ID3 标签的经验？有一些图书馆，但我想从头开始。:-)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-10T06:20:26.987

[Dive into Python](https://web.archive.org/web/20180905200140/http://diveintopython.net/object_oriented_framework/index.html)以 MP3 ID3 标签为例。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-10T05:48:51.743

Mutagen [https://bitbucket.org/lazka/mutagen](https://bitbucket.org/lazka/mutagen) *编辑于 14/09/23 与当前代码主机位置*

eyeD3 [http://eyed3.nicfit.net/](http://eyed3.nicfit.net/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T09:24:35.063

试试[eyeD3](http://eyed3.nicfit.net/)，它是一个程序和一个模块。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-10T05:48:03.710

一个快速的谷歌出现了[http://id3-py.sourceforge.net/](http://id3-py.sourceforge.net/)

也许这对你有用？

# java - 2字节短java

> ID：736815
> 
> 赞同：33
> 
> 时间：2009-04-10T05:45:34.607
> 
> 标签：java, type-conversion, byte, core, short

我正在从串口读取 133 个长度的数据包，最后 2 个字节包含 CRC 值，2 个字节值我使用 java 制作了单个（我认为很短）。这就是我所做的，

```
short high=(-48 & 0x00ff);
short low=80;

short c=(short) ((high<<8)+low); 
```

但我没有得到正确的结果，是因为签名值有问题吗？我该如何解决这个问题，请帮助我，我有麻烦了

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-04-10T06:06:09.907

请记住，如果您对细节不太熟悉，则不必为位移而纠结。您可以使用 ByteBuffer 来帮助您：

```
ByteBuffer bb = ByteBuffer.allocate(2);
bb.order(ByteOrder.LITTLE_ENDIAN);
bb.put(firstByte);
bb.put(secondByte);
short shortVal = bb.getShort(0); 
```

反之亦然，你可以放一个短的，然后拉出字节。

顺便说一句，按位运算会自动将操作数提升到至少 int 的宽度。真的没有“不允许将一个字节移动超过 7 位”的概念以及其他似乎正在流传的谣言。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-04-10T06:40:54.800

在 Java 中将字节值从流转换为数值时，必须非常小心符号扩展。有一个带有负数的陷阱（值从（无符号）128-255）。

试试这个（如果 hi 和 lo 是任何 Java 整数类型，它可以工作）：

```
short val=(short)(((hi & 0xFF) << 8) | (lo & 0xFF)); 
```

我发现在这些情况下最好用括号明确。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-07-06T15:43:48.237

尝试连接字节时会发生这种情况（非常微妙）

```
byte b1 = (byte) 0xAD;
byte b2 = (byte) 0xCA;
short s = (short) (b1<<8 | b2); 
```

以上产生0xFFCA，这是错误的。这是因为 b2 是负数（字节类型是有符号的！），这意味着当它将被转换为 int 类型的位 | 操作，它会被左填充0xF！

因此，您必须记住屏蔽填充字节，以便它们绝对为零：

```
short s = (short) (b1<<8 | b2 & 0xFF); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-07-08T14:18:43.293

其他答案还可以，但我想强调一下类型：

```
short high=(-48 & 0x00ff);
short low=80;

int c= ((high & 0xFF) << 8) | (low & 0xFF); 
```

该`short`类型可以表示 -32768 到 32767 之间的值。53328 不能很好地存储在 short 中，`int`而是使用它，因为它允许您将无符号值存储到 ~10 ⁹ 所以不要将表达式向下转换为 short ，因为它会让你得到有符号的价值。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2018-02-27T16:30:35.610

您可以以更易读和更优雅的方式将 2 个字节转换为短字节。

```
short s = ByteBuffer.wrap(new byte[]{0x01, 0x02}).getShort();
// now s equals 258 = 256 + 2 
```

第一个字节是最高有效字节。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-12-11T08:14:12.043

这对我有用

```
short temp = ;
result[0] = (byte) ((temp >>> 8) & 0xFF);
result[1] = (byte)((temp) & 0xFF); 
```

# web-services - WSDL 能否指示 Web 服务的 SOAP 版本（1.1 或 1.2）？

> ID：736845
> 
> 赞同：79
> 
> 时间：2009-04-10T06:02:18.530
> 
> 标签：web-services, soap, wsdl

是否可以根据 WSDL 中的信息查看 Web 服务使用的是 SOAP 1.1 还是 1.2？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2013-09-23T20:53:41.257

SOAP 1.1 使用命名空间[http://schemas.xmlsoap.org/wsdl/soap/](http://schemas.xmlsoap.org/wsdl/soap/)

SOAP 1.2 使用命名空间[http://schemas.xmlsoap.org/wsdl/soap12/](http://schemas.xmlsoap.org/wsdl/soap12/)

wsdl 能够在同一个wsdl 中同时定义soap 1.1 和soap 1.2 下的操作。如果您需要改进 wsdl 以支持需要 soap 1.2 的新功能（例如 MTOM），这很有用，在这种情况下，您不需要创建新服务，只需改进原始服务即可。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2015-02-08T11:41:05.580

在 WSDL 中，如果您查看**Binding**部分，您会清楚地看到如果服务使用的是 soap 1.2，soap 绑定被明确提及。请参阅以下示例。

```
<binding name="EmployeeServiceImplPortBinding" type="tns:EmployeeServiceImpl">
<soap12:binding transport="http://schemas.xmlsoap.org/soap/http" style="document"/>
<operation name="findEmployeeById">
    <soap12:operation soapAction=""/>
    <input><soap12:body use="literal"/></input>
    <output><soap12:body use="literal"/></output>
</operation><operation name="create">
    <soap12:operation soapAction=""/>
    <input><soap12:body use="literal"/></input>
    <output><soap12:body use="literal"/></output>
</operation>
</binding> 
```

如果Web 服务使用soap 1.1，它不会在绑定部分的WSDL 文件中明确定义任何soap 版本。请参阅以下示例。

```
<binding name="EmployeeServiceImplPortBinding" type="tns:EmployeeServiceImpl">
<soap:binding transport="http://schemas.xmlsoap.org/soap/http" style="rpc"/>
<operation name="findEmployeeById">
    <soap:operation soapAction=""/>
    <input><soap:body use="literal" namespace="http://jaxb.ws.jax.samples.chathurangaonline.com/"/></input>
    <output><soap:body use="literal" namespace="http://jaxb.ws.jax.samples.chathurangaonline.com/"/></output>
</operation><operation name="create">
    <soap:operation soapAction=""/>
    <input><soap:body use="literal" namespace="http://jaxb.ws.jax.samples.chathurangaonline.com/"/></input>
    <output><soap:body use="literal" namespace="http://jaxb.ws.jax.samples.chathurangaonline.com/"/></output>
</operation>
</binding> 
```

**如何确定 SOAP 消息的 SOAP 版本？**

但请记住，这并不是确定您的 Web 服务使用的肥皂版本的推荐方法。可以使用以下方法之一确定肥皂消息的版本。

**1.检查soap消息的命名空间**

```
SOAP 1.1  namespace : http://schemas.xmlsoap.org/soap/envelope

SOAP 1.2 namespace  : http://www.w3.org/2003/05/soap-envelope 
```

**2.检查soap消息的传输绑定信息（http头信息）**

SOAP 1.1：上下文类型的用户文本/xml

```
 POST /MyService HTTP/1.1
   Content-Type: text/xml; charset="utf-8"
   Content-Length: xxx
   SOAPAction: "urn:uuid:myaction" 
```

SOAP 1.2：上下文类型的用户应用程序/soap+xml

```
 POST /MyService HTTP/1.1
   Content-Type: application/soap+xml; charset="utf-8"
   Content-Length: xxx
   SOAPAction: "urn:uuid:myaction" 
```

**3.使用SOAP故障信息**

两个版本之间的 SOAP 故障消息的结构不同。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2010-12-17T18:24:28.650

我找到了这个页面

[http://schemas.xmlsoap.org/wsdl/soap12/soap12WSDL.htm](http://schemas.xmlsoap.org/wsdl/soap12/soap12WSDL.htm)

这表示 Soap 1.2 使用新的命名空间[http://schemas.xmlsoap.org/wsdl/soap12/](http://schemas.xmlsoap.org/wsdl/soap12/)

它位于“SOAP 1.1 的 WSDL 1.1 绑定扩展”中。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-10T06:08:49.620

是的，您通常可以根据 WSDL 查看支持的 SOAP 版本。

看看[演示 web 服务 WSDL](http://www.authorstream.com/Services/Test.asmx?wsdl)。它有一个对 soap12 命名空间的引用，表明它支持 SOAP 1.2。如果不存在，那么假设该服务仅支持 SOAP 1.1，您可能是安全的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-08-25T08:55:24.750

在 binding-element 中找到了 transport-attribute，它告诉我们这是 SOAP 1.1 HTTP 绑定的 WSDL 1.1 绑定。

前任。

```
<wsdlsoap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/> 
```

# date - 确定日期是美国假期还是国际假期的最佳免费图书馆或数据库？

> ID：736852
> 
> 赞同：6
> 
> 时间：2009-04-10T06:06:57.520
> 
> 标签：date, calendar

为了提高年度比较的相关性，我想纠正去年数据落在复活节、劳动节或其他日期的事实。以编程方式确定此信息的最简单方法是什么？是否有任何已知的解决国际假期的解决方案？我可以抓取这样的网站，但我觉得这违反了他们的服务条款 [。](http://holidays.lightdev.com/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T06:14:13.383

在 Java 世界中，您提到的站点确实包含一个 API，[**即 Instant Holiday Connection**](http://www.lightdev.com/page/106.htm)，这可能是一个很好的解决方案（比屏幕抓取更好）。

> > Light Development Holiday Client API 是一个 Java 类库，用于将任意其他应用程序与**[World Holiday Calendar Service](http://www.daybase.eu/)**无缝集成，以使它们了解全球的特殊观察日。

但是，免费版只能访问去年的假期...

* * *

另一个（更公开的）数据库是[**Earth Calendar**](http://www.earthcalendar.net/index.php)，免费但没有可见的 API（再次返回屏幕抓取）

* * *

[**time 和 date.com**](http://www.timeanddate.com)似乎也有所有国家的所有假期（同样没有可见的 API）。

他们确实有一份相当[完整的假期清单](http://www.timeanddate.com/holidays/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T11:22:33.220

一种方法是让您的用户输入他们知道并影响他们工作的国定假日。不过你必须小心，在我工作的一个 IB 中，我们注意到其中一位交易员在他的交易系统上进入了**国家烤肉串日**作为土耳其假期。

# c# - C# 用于创建 Windows 驱动程序？

> ID：736854
> 
> 赞同：1
> 
> 时间：2009-04-10T06:11:45.107
> 
> 标签：c#, device-driver

**完全重复：** [C# 驱动程序开发？](https://stackoverflow.com/questions/75886/c-driver-development)

我想知道 C# 是否可以用于创建 Windows 驱动程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T06:17:09.273

请看：[C#驱动开发？](https://stackoverflow.com/questions/75886/c-driver-development)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T06:16:42.347

我对此表示怀疑——托管代码需要 .NET 运行时才能执行。

# perl - 如何在 Perl 中合并两个 FASTA 文件（一个带换行符的文件）？

> ID：736855
> 
> 赞同：3
> 
> 时间：2009-04-10T06:12:05.183
> 
> 标签：perl, bioinformatics, fasta

我有两个以下 Fasta 文件：

文件1.fasta

```
>0
GAATAGATGTTTCAAATGTACCAATTTCTTTCGATT
>1
GTTAAGTTATATCAAACTAAATATACATACTATAAA
>2
GGGGCTGTGGATAAAGATAATTCCGGGTTCGAATAC 
```

文件 2.qual

```
>0
40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40
40 40 40 40 40 40 40 40 15 40 40
>1
40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 20 40 40 40
40 40 40 40 40 40 40 40 40 40 40
>2
40 40 40 40 7 40 40 5 40 40 40 40 40 40 40 40 37 13 31 20 15 40 10 11 4
40 8 3 29 10 19 18 40 19 15 5 
```

请注意每个 fasta 标头的“qual”文件中的换行符 - 用“>”标记。两个文件的文件头 ('>') 的数量相同。数字质量的数量=序列长度。

我想要做的是附加这两个文件产生：

```
GAATAGATGTTTCAAATGTACCAATTTCTTTCGATT  40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 15 40 40
GTTAAGTTATATCAAACTAAATATACATACTATAAA  40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 20 40 40 40 40 40 40 40 40 40 40 40 40 40 40
GGGGCTGTGGATAAAGATAATTCCGGGTTCGAATAC  40 40 40 40 7 40 40 5 40 40 40 40 40 40 40 40 37 13 31 20 15 40 10 11 4 40 8 3 29 10 19 18 40 19 15 5 
```

但不知何故，我下面的代码无法正确执行？特别是 'qual' 文件中每个条目的第二行不会被打印出来。

```
use strict;
use Data::Dumper;        
use Carp;
use File::Basename;      

my $fastafile = $ARGV[0] || "reads/2039F.2.fasta"; 
my $base      = basename( $fastafile, ".fasta" );
my $qualfile  = "reads/" . $base . ".qual";
print "$qualfile\n";

open SEQ, '<', $fastafile or die $!; #Seq
open PRB, '<', $qualfile or die $!; #quality

while (my $seq = <SEQ>) {
     my $qual = <PRB>;
     chomp($seq);
     chomp($qual);

     if ($seq =~ /^>/ || $qual =~ /^>/) {
         next;
     }
     else {
         print "$seq\t$qual\n";      
     }

} 
```

正确的方法是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-10T06:46:15.257

问题是您正在并行推进文件，因此当一个文件中的行是“>”时，下一个文件中可能不是“>”。

您读取数据的方式是成对的，如下所示：

```
1：>0
2：>0
1：GAATAGATGTTTCAAATGTACCAATTTCTTTCGATT
2：40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40
1：>1
2：40 40 40 40 40 40 40 40 15 40 40
1：GTTAAGTTATATCAAACTAAATATACATACTATAAA
2：>1
1：>2
2：40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 20 40 40 40
1：GGGGCTGTGGATAAAGATAATTCCGGGTTCGAATAC
2：40 40 40 40 40 40 40 40 40 40 40
1：EOF
2：>2
1：EOF
2：40 40 40 40 7 40 40 5 40 40 40 40 40 40 40 40 37 13 31 20 15 40 10 11 4
1：EOF
2：40 8 3 29 10 19 18 40 19 15 5

```

应用您的循环规则的同一组数据将执行此操作：

```
1：GAATAGATGTTTCAAATGTACCAATTTCTTTCGATT
2：40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40
1：GGGGCTGTGGATAAAGATAATTCCGGGTTCGAATAC
2：40 40 40 40 40 40 40 40 40 40 40

```

因此，您需要将循环逻辑分开或找到使文件匹配的方法。

这是分离搜索的尝试，但我还没有测试过。

```
fileIO: {
  while( 1 ){ 
   my $seq; 
   my $qual  = q{};
   while( 1 ){ 
     $seq = <SEQ>; 
     last fileIO if not $seq;  # stop at end of file
     last if $seq !~ /^>/; 
  }
  while( 1 ){ 
     my $qual_in = <PRB>;
     last fileIO if not $qual_in; # stop at end of file 
     last if $qual_in =~ /^>/ and $qual ne q{}; 
     next if $qual_in =~ /^>/ and $qual eq q{}; 
     $qual .= $qual_in;
  }
  print "$seq \n $qual \n";

 }
} 
```

## 更新

我将上面的代码重新分解为一个函数，它将根据需要从任意文件句柄中读取一个块，它似乎可以根据需要工作。当然请注意，我在这里尝试了一些我一直打算用于实际操作的技巧。

```
use strict;
use warnings;

# 
#  readUntilNext( $fileHandle, \$scalar_ref ); 
#
#  returns 0 when nothing could be read from the fileHandle. 
#  otherwise returns 1; 
#

sub readUntilNext {
    my ($fh)            = shift;
    my ($output)        = shift;
    my ($output_buffer) = '';
    while (1) {
        my $line = <$fh>;
        if ( !$line ) { # No more data
            # No data to flush to user, return false.
            return 0 if $output_buffer eq q{};
            last;  # data to  flush to user, loop exit. 
        }
        if ( $line =~ /^>/ ) {
            # Didn't get anything, keep looking. 
            next if $output_buffer eq q{};
            # Got something, flush data to user. 
            last;
        }
        chomp($line);
        $output_buffer .= $line;
    }
    # Data to flush to user 
    # Write to the scalar-reference 
    $$output .= $output_buffer;
    return 1;
}

open my $m, '<', 'a.txt';
open my $n , '<', 'b.txt';
# Creates 2 scalar references every loop, and only loops as long 
# as both files have data. 
while ( readUntilNext( $m, \my $seq ) && readUntilNext( $n, \my $qual ) ) {
    print "$seq\t$qual\n";
} 
```

上面的代码，经过测试，完全符合您的要求。

请注意\我的东西

```
while( readUntilNext( $m, \my $seq ) ) { 
} 
```

基本相同

```
my $seq; 
while( readUntilNext( $m, \$seq ) ) { 
} 
```

除了前者每次都创建一个新的标量，保证相同的值不会被连续循环看到；

所以它变得更像：

```
while( 1 ){ 
 my $seq; 
 last if not readUntilNext($m, \$seq);
 do { 
    # loop body here
 }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-10T15:54:07.843

这是一个不使用 perl 而是使用普通 shell 命令的解决方案：

```
prompt>grep -v '^>[0-9]' file1.fasta > tmp1
prompt>(tr '\012' ' ' < file2.qual; echo) | sed 's/>[0-9]* /\n/g' | sed 1d > tmp2
prompt>paste tmp1 tmp2
GAATAGATGTTTCAAATGTACCAATTTCTTTCGATT    40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 15 40 40
GTTAAGTTATATCAAACTAAATATACATACTATAAA    40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 40 20 40 40 40 40 40 40 40 40 40 40 40 40 40 40
GGGGCTGTGGATAAAGATAATTCCGGGTTCGAATAC    40 40 40 40 7 40 40 5 40 40 40 40 40 40 40 40 37 13 31 20 15 40 10 11 4 40 8 3 29 10 19 18 40 19 15 5
prompt> 
```

我搜索了很多年的粘贴命令（知道“这是一个超级基本的操作，**一定**有人已经实现了一些东西来解决这个问题”）。

第二个命令行首先将所有换行符转换为空格，然后添加 echo 命令以将最终换行符添加到输入中（因为 sed 将忽略缺少 EOL 的行），从而将所有输入行合并为一行，然后 sed 命令再次分裂（可移植性说明：并非所有 sed 程序都可以使用任意行长度，但 GNU sed 可以）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-11T21:26:07.880

您错过了质量分数的第二行（以及随后的每一行），并且还会错过其他序列行。出于此和代码重用目的，处理 FASTA 序列的方法是作为整个条目/记录：

```
local $/ = "\n>";
while (my $seq = <SEQ>) {
     my $qual = <PRB>;
     chomp($seq);  $seq =~ s/^>*.+\n//;  $seq =~ s/\n//g;
     chomp($qual);  $qual =~ s/^>*.+\n//;  $qual =~ s/\n/ /g;

     print "$seq\t$qual\n";      

} 
```

您还可以在第一次替换时轻松捕获 FASTA 标头。

# svn - svn：导入期间忽略属性

> ID：736856
> 
> 赞同：11
> 
> 时间：2009-04-10T06:12:54.573
> 
> 标签：svn, svnignore

如何在导入时递归应用 svn:ignore glob？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-10T14:54:38.343

您不能通过常规导入来做到这一点；您需要[就地导入](http://subversion.apache.org/faq.html#in-place-import)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-10T14:22:14.880

我不确定“在导入时递归地应用*svn:ignore ”是什么意思。*

如果要从导入中排除一组文件，可以在导入之前设置*global-ignores*属性`~/.subversion/config`。没有命令行选项可以即时执行此操作。

或者，您可以在提交之前*添加目录并删除不需要的文件：*

```
$ svn co --non-recursive <repository_url> repo_root
$ cp -R <project_to_import> repo_root
$ cd repo_root
$ svn add *
$ find . -regex ".*\.\(bak\|obj\)" | xargs svn --force del
$ svn ci 
```

*虽然费力，但我更喜欢后一种方法，因为我不是svn import*的忠实粉丝（*svn del*部分对我来说并不常见，我喜欢在提交之前查看文件列表）。

否则，如果您想要在导入之前设置层次结构中每个目录的*svn:ignore*属性，则必须使用第二种方法并在提交之前执行*svn* propset （而不是*svn del*）：

```
$ svn propset -R -F ignore.txt svn:ignore . 
```

（您实际上可以执行*svn import*后跟*svn propset*，但不能在单个提交中执行。）

# java - 如何确定文件是逻辑移动还是物理移动

> ID：736859
> 
> 赞同：1
> 
> 时间：2009-04-10T06:14:32.073
> 
> 标签：java, file-io, filesystems, nio

**事实：**

移动文件时，有两种可能性：

1.  源文件和目标文件在同一个分区，只更新文件系统索引
2.  源和目标位于两个不同的文件系统上，文件需要逐字节移动。（又名移动复制）

**问题：**

如何确定文件是逻辑移动还是物理移动？

我正在传输大文件（700 多兆），并且会针对每种情况采取不同的行为。

* * *

编辑：

我已经编写了一个带有工作线程的移动文件对话框，该线程执行阻塞 io 调用以一次复制文件一个兆。它向用户提供信息，例如粗略估计剩余时间和传输速率。

**问题是：在尝试物理移动文件之前，我如何知道文件是否可以在逻辑上移动？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-10T06:47:01.353

在 Linux 或其他 *nices`stat()`上，调用源目录和目标目录并比较它们的`st_dev`值。如果相同，则可以进行逻辑移动，否则必须进行物理复制+删除。

在 Windows 上，您可以调用`GetFileInformationByHandle()`两个目录的句柄并比较它们的`dwVolumeSerialNumber`值。请注意，这需要 Windows 2000 或更高版本。

我看到您正在使用 Java——必须有一些门户，您可以通过该门户访问此操作系统级别的信息（也许是 JNI？）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T08:34:23.063

好的，我在做某事:)

使用**[JNA](https://github.com/twall/jna/)**，我可以**从 java****调用 Win32 API**（和 *nix API）。

 **我尝试调用`GetFileInformationByHandle`并确实得到了结果，但`dwVolumeSerialNumber`属性始终等于 0（尝试使用我的 C: 和 D: 驱动器）

然后我在 MSDN 上看到了这个功能：[`MoveFileEx`](http://msdn.microsoft.com/en-us/library/aa365240(VS.85,loband).aspx). 当标志参数设置为 0 时，移动复制功能将被禁用。**它有效！！！！**

所以我会简单地打电话

```
if (!Kernel32.INSTANCE.MoveFileEx(source.getAbsolutePath(), destination.getAbsolutePath(), 0)) {
    System.out.println("logical move failed");
} 
```

这是要放入`Kernel32.java`接口的代码（该文件可以在**[JNA](https://github.com/twall/jna/)**站点下载部分的 src.zip 包中找到）：

```
boolean MoveFileEx(String lpExistingFileName, String lpNewFileName, int dwFlags);

int MOVEFILE_REPLACE_EXISTING = 0x01;
int MOVEFILE_COPY_ALLOWED = 0x02;
int MOVEFILE_CREATE_HARDLINK = 0x04;
int MOVEFILE_WRITE_THROUGH = 0x08;
int MOVEFILE_DELAY_UNTIL_REBOOT = 0x10;
int MOVEFILE_FAIL_IF_NOT_TRACKABLE = 0x20; 
```

# c# - .net C# 中的 SqlConnectionStringBuilder 表单

> ID：736860
> 
> 赞同：0
> 
> 时间：2009-04-10T06:14:53.600
> 
> 标签：c#, .net, sql, database-connection

我想知道如何将 DATA LINK 表单添加到我的 WIN 应用程序中。您知道用户可以在哪些表单上选择他们要连接的女巫 SQL 服务器，以及他们要使用什么类型的安全性以及在什么数据库上。

这张图片上的 [替代文字 http://img186.imageshack.us/img186/7259/datalink.png](http://img186.imageshack.us/img186/7259/datalink.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T06:24:28.163

您可以通过一些 COM Introp 来做到这一点......但是您必须将一堆 Interop 程序集拉入您的项目中，这可能是一个拖累。此代码将改为使用反射显示对话框。

```
public static string ShowDialog( IWin32Window owner, 
                                 string connectionString )
{
    Type dlType = Type.GetTypeFromProgID( "DataLinks", true );
    Type acType = Type.GetTypeFromProgID( "ADODB.Connection", true );

    object form = Activator.CreateInstance( dlType );
    object connection = Activator.CreateInstance( acType ); 

    acType.InvokeMember( 
        "ConnectionString", 
        BindingFlags.Public | BindingFlags.SetProperty, 
        null, 
        connection, 
        new object[]{ connectionString } 
        );  
    object result = 
    dlType.InvokeMember( 
        "PromptEdit", 
        BindingFlags.Public | BindingFlags.InvokeMethod, 
        null, 
        form, 
        new object[]{ connection } 
        );          
    if( result != null && (bool)result )
        return acType.InvokeMember( 
                    "ConnectionString", 
                    BindingFlags.Public | BindingFlags.GetProperty, 
                    null, 
                    connection, 
                    new object[]{} ) as string;

    return null;
} 
```

这基本上转换为以下 VB 脚本

```
form = GetObject( "DataLinks" )
connection = GetOBject( "ADODB.Connection" )
connection.ConnectionString = "existing connection"
form.PromptEdit( connection )
Return connection.ConnectionString 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T06:29:08.557

更多关于[这里](https://stackoverflow.com/questions/53178/prompt-for-database-connection-string)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-06-01T22:31:11.983

我认为最好的选择是在这里使用微软提供的代码：http: [//code.msdn.microsoft.com/Connection](http://code.msdn.microsoft.com/Connection)。

它是 Visual Studio 中使用的连接对话框。

但是，它仅适用于已注册的 ADO.NET 提供程序。

# ruby-on-rails - DRb 的可靠性如何？

> ID：736866
> 
> 赞同：4
> 
> 时间：2009-04-10T06:18:36.710
> 
> 标签：ruby-on-rails, ruby, drb

[在使用DRb](http://www.ruby-doc.org/stdlib/libdoc/drb/rdoc/index.html)实现内存中的消息队列和同步进程之间的操作时，是否有任何问题需要考虑？我听说它可能不可靠，但在网上没有找到任何证实这一说法的东西。

如果相关，这些将是在 Rails 应用程序环境中运行的进程，它将更新数据库中的模型。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-10T07:03:35.497

DRb 已经相当成熟并被广泛使用。我不知道任何会使它不可靠的东西，但我不将它用作消息队列

我会说使用消息队列作为消息队列而不是使用 DRb 滚动你自己会更幸运。根据您的需要，有很多解决方案，memcacheq 很容易与之交互，并且在内存中，并且非常可靠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-02-03T17:14:24.047

我个人使用 DRb 在我的 Web 服务器上的两个独立进程中运行，一个用于[执行长达几分钟的计算，允许网站轮询并检查进度](http://phrogz.net/drb-server-for-long-running-web-processes)，另一个作为共享验证码服务器，具有自己的数据库连接，用于我服务器上的各种应用程序. 在这两种情况下，我都没有让 DRb 服务器发生故障（除非这是我的编程错误）。

即使 DRb 服务器确实发生故障，您也可以重新启动它，并且仍在运行的客户端将在下次需要通信时干净地重新连接。

# .net - 我应该在我的 ccnet.config 的 prebuild 部分调用我的验证脚本吗？

> ID：736870
> 
> 赞同：2
> 
> 时间：2009-04-10T06:21:08.907
> 
> 标签：.net, scripting, cruisecontrol.net

我有一个 ccnet.config 部分，我为演示目的实现了该部分。所以我有一个简单的验证检查，在我的构建被触发之前完成。因此，如果验证通过，那么我的构建开始成功。所以验证检查是计算单个 .c 文件中存在的“#defines”的数量，`a.c`例如。我使用 .bat 文件调用的 VB 脚本（.vbs）实现了这一点。

所以我的疑问是

1.  如果在 prebuild 部分的 ccnet.config 文件中调用我的 .bat 文件是正确的。
2.  如果我能够获得返回值，即。.c 文件中的#defines 数量到我的 .bat 文件中的变量中，我应该如何继续将此返回值与固定的已知值进行比较或验证？

我希望我能够清楚地表达我的疑问。如果您需要更多说明，请回复我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T01:21:23.220

prebuild 部分在源更新之前执行，因此您可能希望在任务部分中调用您的 bat 文件。

我会让 vbs/bat 文件进行比较/验证以及计数，然后您只需要以 errorlevel > 0 退出以指示构建应该失败。

[此外，ccnet这里](http://confluence.public.thoughtworks.org/display/CCNET/Project+Configuration+Block)有很好的文档。

# iphone - 如何创建一个骰子 iPhone 应用程序

> ID：736872
> 
> 赞同：0
> 
> 时间：2009-04-10T06:22:20.570
> 
> 标签：iphone

> **可能重复：**
> [如何检测有人摇晃 iPhone？](https://stackoverflow.com/questions/150446/how-do-i-detect-when-someone-shakes-an-iphone)

我知道商店里有很多骰子应用程序，但我只想知道如何开始创建应用程序，当摇动手机时，3D 模型会滚动，谢谢，如果可以提供有关如何开始的任何指示

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T15:25:33.807

Apple 提供了带有 SDK 的示例。

# iphone - 播放声音加速时发生

> ID：736876
> 
> 赞同：0
> 
> 时间：2009-04-10T06:29:00.133
> 
> 标签：iphone, accelerometer

我正在开发一款游戏，我想根据加速度计移动 UIImageView。当我从左到右或从右到左旋转 iPhone 设备时，UIImageView 必须以特定角度旋转。它也在移动，但是当我因为那个声音播放背景声音时会出现问题，即使我的 iPhone 空闲，它也会发送一些加速点。所以我的 UIImageView 也在移动。它不应该发生。当我降低 iphone 音量时，它工作得很好。我必须为此做些什么。

而且，如果有人知道如何仅在 iphone 从左到右或从右到左移动时获得加速点。它不应该检测到 iphone 何时是 xz 或 yz 平面。

如果有人知道解决方案，请回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T08:14:18.057

您是否对加速度计的输入进行了过滤？我希望加速度计拾取的扬声器发出的噪音在幅度和频率上与游戏控制有很大不同。

Apple 加速度计图形示例代码中有一个简单的低通滤波器。

# image-processing - 调整大小的图像在 flex 中不平滑

> ID：736880
> 
> 赞同：0
> 
> 时间：2009-04-10T06:33:16.397
> 
> 标签：image-processing, image

我在 flex 3.0 中加载图像，但是当它们调整大小时，它们看起来有颗粒感和扭曲。我可以给出某种效果或dsomething来解决这个问题吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T06:44:54.713

[试试这个网站。Flex 猴子补丁](http://blog.flexmonkeypatches.com/2007/02/05/scaling-an-image-with-smoothing/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T07:00:24.317

为此，您需要将图像加载为位图并对其**应用平滑处理**。我已在幻灯片放映中实现了这一点。我从这个链接中找到了代码片段，希望这是你想要的

[http://askmeflash.com/article/4/smoothing-resized-distorted-images-in-flex](http://askmeflash.com/article/4/smoothing-resized-distorted-images-in-flex)

# tags - 附加标签

> ID：736886
> 
> 赞同：0
> 
> 时间：2009-04-10T06:36:55.777
> 
> 标签：tags, tagging, tag-cloud

在项目开发中将多个标签附加到特定内容的实际过程是什么。这个标签是怎么回事？？？

我需要使用 c# 在 .NET 中为我的项目创建标签云。帮助我作为基本标记概念的初学者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T07:30:15.557

标签是关键字添加有关被标记的项目的信息。标签添加有关某事物的语义信息以进一步促进它。

例如，您父亲生日的照片可以标记为“爸爸”、“家庭”、“事件”、“生日”等...

通过向图片添加标签，您可以添加上下文并使图像更易于索引、排序和搜索。

标签是有目的的通用和灵活的，因为不同的人可以为同一个工件赋予不同的个人含义，或者同一个人可能在不同的上下文中应用不同的含义——比如将同一张图片添加到图库摄影网站或将其签入源代码存储库作为项目的一部分。

通常，该过程是要求项目的所有者在文本字段中添加标签列表。像 stackoverflow 这样的一些网站会限制（大多数）用户使用现有的标签，而另一些网站（如美味）则将标签由用户决定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T06:43:51.877

软件上下文中的标记通常意味着分配给该软件的有意义的名称或属性。在版本控制场景中，标签是一个有意义的名称，赋予该名称所代表的文件的特定状态。例如，标签 20090401 可能被分配给源代码，就像它在 2009 年 4 月 1 日看到的那样。标记某些东西也可能意味着对其进行描述或对其进行分类。例如，IE8、Chrome 或 Firefox 等软件可能都被标记为“浏览器”，以便在下载页面上对其进行分类。允许用户创建标签并使用现有标签是对内容进行分类并帮助人们零关注感兴趣的项目的强大方法。标签只是人们可以深入了解数据的额外信息。

多标签在软件开发中出于多种原因很有用。例如，在我的 git 存储库中，我习惯于根据日期创建标签，这些标签可以很容易地被计算机排序和解析。我还可以给更改一个更人性化的消耗性名称，例如标签“Deleted_Duplicates”、“RC1”或“V1_Delievered_To_Michigan”。这允许理解，同时也允许机器处理。

# php - 如何在php中提取字符串的一部分

> ID：736889
> 
> 赞同：3
> 
> 时间：2009-04-10T06:39:45.553
> 
> 标签：php, regex, text-extraction

我正在使用 preg_replace() 进行一些字符串替换。

```
$str = "<aa>Let's find the stuff qwe in between <id>12345</id> these two previous brackets</h>";

$do = preg_match("/qwe(.*)12345/", $str, $matches); 
```

这工作得很好，并给出以下结果

```
$match[0]=qwe 在 12345 之间
$match[1]=介于两者之间

```

但我使用相同的逻辑从以下字符串中提取。

```
<text>
  <src><![CDATA[<TEXTFORMAT LEADING="2"><P ALIGN="LEFT"><FONT FACE="Arial" SIZE="36" COLOR="#999999" LETTERSPACING="0" KERNING="0">r1 text 1  </FONT></P></TEXTFORMAT>]]></src>
  <width>45%</width>
  <height>12%</height>
  <left>30.416666666666668%</left>
  <top>3.0416666666666665%</top>
  <begin>2s</begin>
  <dur>10s</dur>
  <transIn>fadeIn</transIn>
  <transOut>fadeOut</transOut>
  <id>E2159292994B083ACA7ABC7799BBEF3F7198FFA2</id>
</text> 
```

我想从中提取字符串

```
r1text1 
```

至

```
</id> 
```

我目前拥有的正则表达式是：

```
preg_match('/r1text1(.*)</id\>/', $metadata], $matches); 
```

其中 $metadata 是上面的字符串..

$matches 不返回任何内容....出于某种原因...我该怎么做？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T07:12:51.370

如果要提取文本，您可能需要使用[`preg_match`](http://php.net/preg_match). 以下可能有效：

```
preg_match('#\<P[^\>]*\>\<FONT[^\>]*\>(.*\</id\>)#', $string, $matches) 
```

括号中匹配的任何内容都可以稍后在`$matches`数组中找到。在这种情况下，`<P>`标签后跟`<FONT>`标签和之间的所有内容`</id>`，包括后者。

上面的正则表达式未经测试，但可能会让您大致了解如何做到这一点。如果您的需求有点不同，请适应:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T09:25:01.723

即使不知道为什么要在不完整的 XML 片段上匹配正则表达式（从 a 开始`<![CDATA[`并在结束 XML 标记之前结束`</id>`，您的正则表达式确实存在三个明显的问题：

1.  正如[Amri](https://stackoverflow.com/questions/736889/how-to-extract-a-portion-of-a-string-in-php/737037#737037)所说：您必须转义`/`结束 XML 标记中的字符，因为您将`/`其用作模式分隔符。顺便说一句，你不必逃避这个`>`角色。这给了您：`'/r1text1(.*)<\/id>/'`或者，您可以将模式分隔符更改`#`为例如：（`'#r1text1(.*)</id>#'`我将使用第一个模式来进一步开发表达式）。

2.  正如[Rich Adams](https://stackoverflow.com/questions/736889/how-to-extract-a-portion-of-a-string-in-php/737100#737100)已经说过的那样：示例数据中的文本是“ `r1_text_1`”（`_`是空格字符），但您匹配`'/r1text1(.*)<\/id>/'`. 您必须在正则表达式中包含空格或允许不确定数量的空格，例如`'/r1(?:\s*)text(?:\s*)1(.*)<\/id>/'`（这`?:`是非捕获子模式的语法）

3.  默认情况下，正则表达式中的`.`(dot) 不匹配换行符。您必须添加`s`(PCRE_DOTALL) 模式修饰符以让`.`(dot) 也与换行符匹配：`'/r1(?:\s*)text(?:\s*)1(.*)<\/id>/s'`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T08:58:30.650

在示例中，您有“r1 text 1”，但您的正则表达式有“r1text1”。正则表达式不匹配，因为您尝试匹配的字符串中有空格。您应该在正则表达式中包含空格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-10T06:48:37.357

您可能需要解析您的字符串/文件并提取 FONT 标记之间的值。然后将值插入到 id 标签中

尝试使用谷歌搜索进行 php 解析。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-10T08:18:56.110

尝试这个

```
preg_match('/r1text1(.*)<\/id\>/', $metadata], $matches); 
```

您正在使用 / 作为模式分隔符，但您的内容有 / in 。您可以使用 \ 作为转义字符。

# graph - 用于绘制大量网络相关数据的应用程序

> ID：736894
> 
> 赞同：3
> 
> 时间：2009-04-10T06:42:40.710
> 
> 标签：graph

*我知道这与编程无关，但我希望一些反馈可以帮助我摆脱困境。*

实际上，我们的 Web 应用程序有很多不同的数据，这些数据可以追溯到几年前。

例如，我们已经

*   Apache 日志文件
*   来自我们的跟踪软件 (CSV) 的每日统计文件
*   另一项来自全国广告排名（CSV）的每日统计数据
*   ..我也可以从其他来源产生新数据。

一些数据记录始于 2005 年，一些始于 2006 年，等等。但是在某个时间点，我们开始拥有所有这些数据。

我的梦想是什么^H^H^H^H正在搜索是一个理解所有数据的应用程序，让我加载它们，比较单个数据集和时间线（以图形方式），比较同一时间跨度内的不同数据集，请允许我过滤（尤其是 Apache 日志文件）；当然，这一切都应该是交互式的。

仅 BZ2 压缩的 Apache 日志文件就已经总计 21GB，并且每周都在增长。

我在 awstats、Nihu Web Log Analyzer 或类似工具方面没有取得真正的成功。他们只能产生静态信息，但我需要交互式查询信息、应用过滤器、覆盖其他数据等。

我也尝试过数据挖掘工具，希望它们能帮助我，但并没有真正成功地使用它们（即它们超出了我的想象），例如 RapidMiner。

只是为了确保：它**可以**是商业应用程序。但是还得找到*真正有用*的东西。

不知何故，我得到的印象是我正在寻找不存在的东西，或者我有错误的方法。任何提示都非常受欢迎。

**更新：**

最后，我混合了以下内容：

*   编写 bash 和 PHP 脚本来解析和管理解析日志文件，包括许多过滤功能
*   生成普通的旧 CSV 文件以读入 Excel。我很幸运使用 Excel 2007，它的图形功能，虽然仍在处理一组固定的数据，但帮助很大
*   我使用 Amazon EC2 运行脚本并通过电子邮件将 CSV 发送给我。我不得不爬取大约 200GB 的数据，因此使用其中一个大型实例来并行化解析。我必须执行多次解析尝试才能正确获取数据，总处理时间为 45 分钟。如果没有 Amazon EC2，我不知道我能做什么。我为此付出的每一分钱都是值得的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-14T23:03:40.413

Splunk 就是针对这类事情的产品。我自己还没有用过。 [http://www.splunk.com/](http://www.splunk.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-06T18:31:38.353

开源数据挖掘和网络挖掘软件[RapidMiner](http://www.rapid-i.com/)可以导入 Apache Web 服务器日志文件以及 CSV 文件，还可以导入和导出 Excel 表格。Rapid-I 为 RapidMiner 提供了很多培训课程，其中一些还涉及网络挖掘和网络使用挖掘。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-15T02:12:41.207

In the interest of full disclosure, I've not used any commercial tools for what your describing.

Have you looked at [LogParser](http://www.microsoft.com/downloads/details.aspx?FamilyID=890cd06b-abf8-4c25-91b2-f8d975cf8c07&displaylang=en)? It might be more manual than what your looking for, but it will allow you to query many different structured formats.

As for the graphical aspect of it, there is some basic charting capabilities built in, but your likely to get much more mileage piping the log parser output into a tabular/delimited format and loading into Excel. From there you can chart/graph just about anything.

As for cross joining different data sources, you can always pump all the data into the database where you'll have a richer language for querying the data.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T14:18:45.573

您正在寻找的是一个“数据挖掘框架”，即可以愉快地吃掉几千兆字节的随机数据，然后让您以未知的方式对其进行切片，以找到深埋在静态内部的金块.

一些链接：

*   [CloudBase](http://cloudbase.sourceforge.net/#homePage)：“CloudBase 是建立在 Map-Reduce 架构之上的高性能数据仓库系统。它使业务分析师能够使用 ANSI SQL 直接查询网站、电信或 IT 运营中产生的大规模日志文件。”

*   [RapidMiner](http://sourceforge.net/projects/yale/)：“RapidMiner aleady 是一个完整的数据挖掘和商业智能引擎，它还涵盖了许多相关方面，从 ETL（提取、转换和加载）到分析再到报告。”

# c# - 反序列化器不知道映射到该合约的任何类型

> ID：736900
> 
> 赞同：4
> 
> 时间：2009-04-10T06:44:47.647
> 
> 标签：c#, serialization, datacontractserializer

我正在尝试序列化和反序列化 Node 对象树。我的抽象“节点”类以及从它派生的其他抽象和具体类在我的“Informa”项目中定义。此外，我在 Informa 中创建了一个用于序列化/反序列化的静态类。

首先，我将树解构为**Dictionary(guid,Node)**类型的平面列表，其中 guid 是 Node 的唯一 ID。

我能够毫无问题地序列化我的所有节点。但是当我尝试反序列化时，我得到以下异常。

> 第 1 行位置 227 出错。元素“ [http://schemas.microsoft.com/2003/10/Serialization/Arrays:Value](http://schemas.microsoft.com/2003/10/Serialization/Arrays:Value) ”包含“Informa:Building”数据合同的数据。反序列化器不知道映射到该合约的任何类型。将与“Building”对应的类型添加到已知类型列表中 - 例如，通过使用 KnownTypeAttribute 或将其添加到传递给 DataContract Serializer 的已知类型列表中。

从 Node 派生的所有类，包括 Building，都应用了**[KnownType(typeof(type t))]**属性。

我的序列化和反序列化方法如下：

```
public static void SerializeProject(Project project, string filePath)
{
    try
    {
        Dictionary<Guid, Node> nodeDic = DeconstructProject(project);

        Stream stream = new FileStream(filePath, FileMode.Create, FileAccess.Write, FileShare.None);

        //serialize

        DataContractSerializer ser = new DataContractSerializer(typeof(Dictionary<Guid, Node>),"InformaProject","Informa");

        ser.WriteObject(stream,nodeDic);

        // Cleanup
        stream.Close();
    }
    catch (Exception e)
    {
        MessageBox.Show("There was a problem serializing " + Path.GetFileName(filePath) + ". \n\nException:" + e.Message, "Doh!", MessageBoxButtons.OK, MessageBoxIcon.Error);
        throw e;
    }

}

public static Project DeSerializeProject(string filePath)
{
    try
    {
        Project proj;

        // Read the file back into a stream
        Stream stream = new FileStream(filePath, FileMode.Open, FileAccess.Read, FileShare.Read);

        DataContractSerializer ser = new DataContractSerializer(typeof(Dictionary<Guid, Node>), "InformaProject", "Informa");

        Dictionary<Guid, Node> nodeDic = (Dictionary<Guid, Node>)ser.ReadObject(stream);

        proj = ReconstructProject(nodeDic);        

        // Cleanup
        stream.Close();

        return proj;

    }
    catch (Exception e)
    {
        MessageBox.Show("There was a problem deserializing " + Path.GetFileName(filePath) + ". \n\nException:" + e.Message, "Doh!", MessageBoxButtons.OK, MessageBoxIcon.Error);
        return null;
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T07:29:44.217

> 从 Node 派生的所有类，包括 Building，都应用了 [KnownType(typeof(type t))] 属性。

`KnownType`通常应用于*基本*类型 - 即

```
[DataContract, KnownType(typeof(Building)), ...]
abstract class Node { ... } 
```

（注意 - 您也可以在`DataContractSerializer`构造函数中指定已知类型，而不需要属性）

**编辑您的回复**

如果框架类不知道所有派生类型，那么您需要在创建序列化程序时指定已知类型：

```
[DataContract] abstract class SomeBase { }
[DataContract] class Foo : SomeBase { }
[DataContract] class Bar : SomeBase { }
...
// here the knownTypes argument is important
new DataContractSerializer(typeof(SomeBase),
      new Type[] { typeof(Foo), typeof(Bar) }); 
```

`preserveObjectReferences`这可以通过替换上一个示例中的与（例如）等结合使用`null`。

**结束编辑**

但是，如果没有可重现的东西（即`Node`和`Building`），将很难有多大帮助。

另一个奇怪的事情；树结构*非常适合*诸如`DataContractSerializer`- 通常不需要先将它们展平，因为树可以在 xml 中简单地表达。你真的需要把它弄平吗？

* * *

例子：

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Runtime.Serialization;
using System.Xml;

[DataContract, KnownType(typeof(Building))]
abstract class Node {
    [DataMember]
    public int Foo {get;set;}
}
[DataContract]
class Building : Node {
    [DataMember]
    public string Bar {get;set;}
}

static class Program
{
    static void Main()
    {
        Dictionary<Guid, Node> data = new Dictionary<Guid, Node>();
        Type type = typeof(Dictionary<Guid, Node>);
        data.Add(Guid.NewGuid(), new Building { Foo = 1, Bar = "a" });
        StringWriter sw = new StringWriter();
        using (XmlWriter xw = XmlWriter.Create(sw))
        {
            DataContractSerializer dcs = new DataContractSerializer(type);
            dcs.WriteObject(xw, data);
        }

        string xml = sw.ToString();

        StringReader sr = new StringReader(xml);
        using (XmlReader xr = XmlReader.Create(sr))
        {
            DataContractSerializer dcs = new DataContractSerializer(type);
            Dictionary<Guid, Node> clone = (Dictionary<Guid, Node>)
                dcs.ReadObject(xr);
            foreach (KeyValuePair<Guid, Node> pair in clone)
            {
                Console.WriteLine(pair.Key + ": " + pair.Value.Foo + "/" +
                    ((Building)pair.Value).Bar);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T20:49:01.237

好的，这里有一个图表，应该让事情更清楚。我正在为另一个程序开发一个插件，该插件添加了程序中尚未包含的关系和属性。这些关系/属性在我的树结构中定义。但是，我试图抽象地定义这个结构，以便我可以为不同的程序创建插件的实现，以及在单个“查看器”程序中访问来自多个实现的信息。

我的 Serialize/Deserialize 方法是在框架中定义的，但框架并不知道所有的实现。我希望我可以避免让实现项目将类型列表传递给框架项目中的保存/打开/序列化/反序列化方法，但似乎我无法避免这种情况？我想这是有道理的，序列化/反序列化方法必须能够访问它们正在反序列化的类型。

[http://dl.getdropbox.com/u/113068/informa_framework.jpg](http://dl.getdropbox.com/u/113068/informa_framework.jpg) <---大版本 [替代文本 http://dl.getdropbox.com/u/113068/informa_framework.jpg](http://dl.getdropbox.com/u/113068/informa_framework.jpg)

所以这并不能真正解释 Building 的问题，因为它是框架项目中的一个具体类。我认为发生的事情是当我序列化 DataContractSerializer 可以访问所有对象及其 KnowType 参数并正确保存它们时。但是当我反序列化时，我使用 Dictionary 作为类型创建了我的 DataContractSerializer。所以它只知道节点，而不知道节点的派生类。

```
new DataContractSerializer(typeof(Dictionary<Guid, Node>)) 
```

我不能告诉它所有派生类型是什么，因为就像我说它们在框架项目不知道的其他项目中一样。Soooooooo 似乎最好的解决方案是让每个实现将它使用的节点类型列表传递给框架项目中的序列化和反序列化方法。

这有意义吗？有一个更好的方法吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-10T09:48:07.580

KnownTypes 属性的这两种用法有什么区别？我没有意识到您可以/想要指定一个类是另一个类的 KnownType。

```
[DataContract]
[KnownType(typeof(Building))]
abstract class Node {
    [DataMember]
    public int Foo {get;set;}
}
[DataContract]
class Building : Node {
    [DataMember]
    public string Bar {get;set;}
} 
```

* * *

```
[DataContract] 
[KnownType(typeof(Node))]
abstract class Node {
    [DataMember]
    public int Foo {get;set;}
}
[KnownType(typeof(Building))]
class Building : Node {
    [DataMember]
    public string Bar {get;set;}
} 
```

# .net - 由于对象的当前状态，操作无效

> ID：736908
> 
> 赞同：0
> 
> 时间：2009-04-10T06:51:59.610
> 
> 标签：.net, clone

“由于对象的当前状态，操作无效”在 .net 中的 .Clone() 操作中引发异常。

我正在使用框架 2.0。

任何想法可能是什么原因。

提前致谢。

拉维

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T07:10:52.797

不幸的是，您的问题没有包含足够的信息来给出直接的答案。

但是，您绝对可以尝试使用[Reflector](http://www.red-gate.com/products/reflector/)分析向您抛出异常的对象的 Clone 方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-01-16T09:47:04.053

在你的页面上单个帖子发送的表单字段数为1000，即MaxHttpCollectionKeys的默认值为1000，尝试设置更大的值。

解决方案是 Add Key into webconfig **add key="aspnet:MaxHttpCollectionKeys" value="2001"**

# asp.net-mvc - mvc beginform 的问题

> ID：736910
> 
> 赞同：0
> 
> 时间：2009-04-10T06:54:51.757
> 
> 标签：asp.net-mvc

我的表单中有两个下拉列表。从此下拉列表中选择的值应发送到正确的路线。一称为“类别”，二称为“状态”。当我发送我的表格时，我没有得到预期：

首页/列表/类别/状态地址

但像这样：

Home/List?category=category&status=status

我怎么能解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T13:39:07.323

如果您将参数附加为查询字符串，这意味着它们在路线中没有位置，因此您必须为它们设置路线。在你的路线的某个地方，你需要有一个地方让他们跌倒。

您需要添加一条路线或将默认路线更改为如下所示...

```
routes.MapRoute(
    "MyRouteName",
    "Home/List/{category}/{status}",
    new { category = "default", status = "alsoDefault" }
    );

routes.MapRoute(
    "MyRouteName",
    "{controller}/{action}/{category}/{status}",
    new { controller = "Home", action = "Index", category = "default", status = "alsoDefault" }
    ); 
```

# git - 你如何让 git diff 在 OS X 上使用 gitx --diff

> ID：736911
> 
> 赞同：13
> 
> 时间：2009-04-10T06:56:13.173
> 
> 标签：git, macos, diff

Gitx 有一个很棒的差异查看器，我如何让 git 自动将 git diff*任何东西*通过管道传输到 gitx 中？

我尝试将 git config diff.external 设置为如下所示的 shell 脚本：

```
git diff "$2" "$5" | gitx 
```

但是，这只会将所有单个文件打开到多个 gitx 窗口中，并且确实会弄乱文件名（将它们全部更改为具有疯狂名称的 tmp 文件）。

有没有人有更好的解决方案？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-08-09T13:38:43.307

就像 sigjuice 在上面说的那样。只有那些菜鸟（就像我现在一样）需要知道如何“连接” git 才能使用它。这是我所做的

```
echo 'opendiff $2 $5' > ~/opendiff-git.sh
chmod a+x ~/opendiff-git.sh
git config --global diff.external ~/opendiff-git.sh 
```

现在所有“git diff”都应该打开 FileMerge.app ...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2010-04-21T13:57:57.533

我不太确定这是您想要的，但对于我们在 Mac 上的我们来说，无论如何它肯定很方便并且有些相关，您可能想尝试：

$ git difftool -t opendiff #hash

这会在我觉得非常有用的 opendiff 程序中打开差异。这比创建一个 shell 脚本并通过新的外部 diff 强制所有差异要容易得多。如果您不在 Mac 上，您可能可以将 opendiff 更改为您最喜欢的可用差异工具...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T09:13:13.220

很抱歉，这并不能真正回答您关于 gitx 的问题。我什至不确定 gitx 是否可以用作通用差异工具。您可能喜欢 FileMerge，它是 Xcode 安装中包含的合并/差异工具。有一个名为 opendiff 的脚本可以为您启动它。只需制作一个包含以下行的脚本并将 diff.external 指向它。

```
opendiff $2 $5 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-10T16:43:31.997

我为 Araxis 合并做了这个，但无论你喜欢什么工具，修改这些基本指令都不难。

首先，我创建了 ~/bin/git-diff-driver.sh 并向文件添加了执行权限。

```
 #!/bin/sh

/usr/local/bin/compare -title1:"$1 (repo version)" -title2:"$1 " -max "$2" "$5" 
```

Araxis 将它的命令行界面工具安装在 /usr/local/bin 比较工具是他们的通用工具，araxis* 工具通过比较提供。

设置完成后，需要将以下行添加到 ~/.gitconfig

```
 [merge]
    tool = araxismerge
[mergetool "araxismerge"]
    cmd = "/usr/local/bin/compare -3 -merge -wait $LOCAL $BASE $REMOTE $MERGED"
    path = /usr/local/bin/
[diff]
    external = "/Users/mark/bin/git-diff-driver.sh" 
```

这将通过 Araxis Merge 重定向所有 2 路和 3 路差异。似乎“路径=”不是必需的，但它有效。

祝你好运。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-15T00:07:01.440

我正在使用我命名`git-diffx`并放入路径中的这个脚本：

```
#!/bin/bash

result=$(git diff $@)

if [ "$result" ]; then
   echo "$result" | gitx
fi 
```

然后`git diff ...`，您调用`git diffx ...`.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-01-11T23:38:15.163

这个问题可能有点老了，但我刚刚找到了适合我的东西。

打开 GitX 应用程序（v.7），选择“GitX”菜单，然后选择“启用终端使用”

在终端管道差异到 gitx 通过：

混帐差异 | gitx

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-10T10:31:55.557

不久前我问了一个[类似的问题](https://stackoverflow.com/questions/585844/merging-with-git-mergetool)。该答案可能对您有所帮助。那里有几个问题，但其中一个与在 FileMerge 以外的其他东西中打开差异视图有关。

# java - xmlbeans - 设置复杂类型的内容

> ID：736913
> 
> 赞同：0
> 
> 时间：2009-04-10T06:57:41.533
> 
> 标签：java, xml, xmlbeans

我的 xsd 文件包含：

```
 <xs:sequence>
                    <xs:element name="Book">
                        <xs:complexType>
                            <xs:attribute name="author" type="xs:string" />
                            <xs:attribute name="title" type="xs:string" />
                        </xs:complexType>
                    </xs:element>
                </xs:sequence> 
```

使用 xmlbeans，我可以使用以下方法轻松设置属性：

```
 Book book= books.addNewBook();
    book.setTitle("The Lady and a Little Dog"); 
```

我知道我可以使用 newCursor() 来设置元素的内容，但这是最好的方法吗？

```
object.newCursor().setTextValue(builer.toString()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T07:14:30.440

我不太明白你的问题。

我认为您的 XSD 将为您提供 Java 类来生成这样的 XML：

```
<book author="Fred" title="The Lady and a Little Dog" /> 
```

你的意思是你想在一个 XML 元素中设置“内部”文本，所以你最终得到了这样的 XML？

```
<book>
  <author>Fred</author>
  <title>The Lady and a Little Dog</title>
</book> 
```

如果是这样，请将您的 XSD 更改为此，以使用嵌套元素而不是属性：

```
<xs:sequence>
    <xs:element name="Book">
        <xs:complexType>
          <xs:sequence>
            <xs:element name="author" type="xs:string" />
            <xs:element name="title" type="xs:string" />
          </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:sequence> 
```

然后你就可以做到：

```
Book book= books.addNewBook();
book.setAuthor("Fred");
book.setTitle("The Lady and a Little Dog"); 
```

* * *

**更新**

好的我现在明白了。

试试这个：

```
<xs:element name="Book"  minOccurs="0" maxOccurs="unbounded">
  <xs:complexType>
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute name="author" type="xs:string" />
        <xs:attribute name="title" type="xs:string" />
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>    
</xs:element> 
```

进而：

```
 Book book1 = books.addNewBook();
    book1.setAuthor("Fred");
    book1.setTitle("The Lady and a Little Dog");
    book1.setStringValue("This is some text");

    Book book2 = books.addNewBook();
    book2.setAuthor("Jack");
    book2.setTitle("The Man and a Little Cat");
    book2.setStringValue("This is some more text"); 
```

哪个应该给 XML 这样的，我认为这是你想要的：

```
<Book author="Fred" title="The Lady and a Little Dog">This is some text</Book>
<Book author="Jack" title="The Man and a Little Cat">This is some more text</Book> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T05:48:32.227

我不确定这是否正是您要问的，但使用 XMLBeans 设置属性或元素值的最佳方法是使用 XMLBeans 生成的 getter 和 setter。

也许为您的光标问题提供更多上下文会有所帮助。

# visual-c++ - vcpp中的日期项目

> ID：736917
> 
> 赞同：0
> 
> 时间：2009-04-10T07:01:45.423
> 
> 标签：visual-c++, mfc

在 VC++ 6.0 MFC 应用程序中，我试图以镜头格式显示日期，例如；05-10-09，但它会打印 05-10-2009

这是我写的 SYSTEMTIME st 的代码；获取系统时间(&st);

CString 字符串；

str.Format("%02d-%02d-%02d",st.wDay,st.wMonth,st.wYear); m_date=m_date + str;

我会得到输出，例如：05-10-2009，但我想要这种格式 05-10-09

请任何人帮助我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T11:31:01.437

... "%02d", st.wYear % 100 ...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T10:18:00.863

1.  它应该是 %02d-%02d-%02d，而不是 %02d-%02d- **02%d**
2.  正确的方法应该是使用 CTime::Format （我不知道 VC 6 是否有）
3.  通过 (st.Year % 100)

# reporting-services - 从 SSRS 导出时如何获取命名的 Excel 工作表

> ID：736918
> 
> 赞同：33
> 
> 时间：2009-04-10T07:02:17.683
> 
> 标签：reporting-services, reportingservices-2005, ssrs-2008, export-to-excel

每当将单页报表导出到 excel 时，excel 中的工作表都会以报表名称命名。如果报表有多个页面，则工作表被命名为 sheet1、sheet2、.... 有没有办法在 SSRS 2005 中指定工作表名称？

解决方案：经过一些谷歌搜索后发现： [更改 SQL Server RS Excel 中的工作表名称：QnD XSLT](http://spacefold.com/lisa/post/2007/10/03/Changing-the-Sheet-names-in-SQL-Server-RS-Excel-QnD-XSLT.aspx)

如果可行，将尝试并发布更新。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2016-06-15T12:46:29.243

死灵术，以防万一所有链接都变暗：

1.  将组添加到您的报告
    此外，建议在此处设置组表达式的排序顺序，以便选项卡按字母顺序排序（或者您希望它排序）。

    [![1\. 将组添加到您的报告中](https://i.stack.imgur.com/0RsVX.png)](https://i.stack.imgur.com/0RsVX.png)

    *   “Zeilengruppe”的意思是“目标群体”
    *   “Gruppeneigenschaften”是指“集团财产”
2.  在组属性中设置分页符 [![2.在组属性中设置分页符](https://i.stack.imgur.com/DU2XT.png)](https://i.stack.imgur.com/DU2XT.png)

    *   “Seitenumbruche”的意思是“分页符”
    *   “Zwischen den einzelnen Instanzen einer Gruppe”的意思是“在一个群体的各个实例之间”
3.  现在您需要设置`PageName`Tablix**成员**（组）的，而**不是**`PageName`Tablix**本身**的。
    如果你得到了正确的对象，如果会在属性网格的标题框中显示“Tablix **Member ”（德语中的 Tablix-Element）。**如果它是错误的对象，它会在属性网格的标题框中**只**显示“table/tablix”（没有*member*）。

4.  注意：如果您获得的是 tablix 而不是 tablix 成员，它将在每个选项卡中放置相同的选项卡名称，后跟一个`(tabNum)`！如果发生这种情况，您现在就知道问题所在了。 [![Tablix 会员](https://i.stack.imgur.com/0M6lu.jpg)](https://i.stack.imgur.com/0M6lu.jpg)

[![MultiTabExcel文件](https://i.stack.imgur.com/ispe1.png)](https://i.stack.imgur.com/ispe1.png)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-08T06:32:26.490

要导出到不同的工作表并使用自定义名称，从 SQL Server 2008 R2 开始，这可以使用分组、分页符和组的**PageName**属性的组合来完成。

或者，如果它只是您想要指定特定名称的单个工作表，请尝试报表上的**InitialPageName**属性。

有关更详细的说明，请查看此处：[http ://blog.hoegaerden.be/2011/03/23/where-the-sheets-have-a-name-ssrs-excel-export/](http://blog.hoegaerden.be/2011/03/23/where-the-sheets-have-a-name-ssrs-excel-export/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-07-17T11:31:10.257

在 SSRS 2008 R2 中使用页面组的**PageName**属性：http: [//bidn.com/blogs/bretupdegraff/bidn-blog/234/new-features-of-ssrs-2008-r2-part-1-naming-excel-sheets -何时导出报告](http://bidn.com/blogs/bretupdegraff/bidn-blog/234/new-features-of-ssrs-2008-r2-part-1-naming-excel-sheets-when-exporting-reports)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-07-16T01:01:46.880

要在导出到 excel 时添加选项卡名称，我使用了以下方法：

*   在报表设计窗口中，选择 tablix 对象。
*   打开 tablix 对象的属性窗口。
*   将所需的选项卡名称添加到`PageName`属性。
*   运行报告
*   将报告导出到 Excel。
*   `PageName`现在工作表名称与 tablix 对象的属性相同。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-06-15T12:22:12.527

将选项卡名称放在报表的页眉或组 TableRow1 上，以便它出现在每个 Excel 工作表的“A1”位置。然后在您的 Excel 工作簿中运行此宏。

```
Sub SelectSheet()
        For i = 1 To ThisWorkbook.Sheets.Count
        mysheet = "Sheet" & i
        On Error GoTo 10
        Sheets(mysheet).Select
        Set Target = Range("A1")
        If Target = "" Then Exit Sub
        On Error GoTo Badname
        ActiveSheet.Name = Left(Target, 31)
        GoTo 10
Badname:
        MsgBox "Please revise the entry in A1." & Chr(13) _
        & "It appears to contain one or more " & Chr(13) _
        & "illegal characters." & Chr(13)
        Range("A1").Activate
10
        Next i
End Sub 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-01T17:36:01.483

没有直接的方法。您可以导出 XML，然后对 XSLT 进行正确的格式化以正确格式化（这是困难的方法）。一种更简单的方法是编写多个没有明确分页符的报告，因此每个报告仅在 Excel 中导出到一个工作表中，然后编写一个将为您合并的脚本。无论哪种方式，它都需要一个后处理步骤。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-10-09T20:03:43.127

我能够按照 Valentino Vranken 和 rao 建议的更复杂的说明完成这项工作，但这里有一个更简单的方法，用于更简单的报告。这会将每个表放在单独的工作表上，并在 Excel 中命名。它似乎对 PDF 和 Word 等其他导出没有影响。

首先在`Tablix Properties`您的表中`General`，检查其中一个`Add a page break before or after`，这会将报告分成工作表。

然后在每个表中，单击表，然后在`Grouping`视图中，在`Row Groups`侧面，选择父组或默认行组，然后在`Properties`视图下`Group -> PageBreak`设置`BreakLocation`为`None`工作`PageName`表的名称。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-03-21T16:12:37.547

> **矩形方法**

我发现实现工作表/分页符的最简单、最可靠的方法是使用矩形工具。

将您的页面分组在矩形或填充子报表中页面的单个矩形内，如下所示：

*   我发现放置矩形的最快方法是将其绘制在您希望放置在矩形中的对象周围。

*   右键单击并在布局菜单中，将矩形发送到后面。

*   选择所有对象并轻轻拖动它们，但要确保它们落在原来的位置。它们现在都将在矩形中。

在矩形属性中，您可以将分页符设置在矩形的开头或结尾，并且页面的名称可以基于表达式。

工作表的名称将与页面名称相同。

重复的名称将在括号后缀中有一个数字。

**注意：**确保名称是有效的工作表名称。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-06T01:41:13.713

您可以使用 -sed- 和 -grep- 替换或写入每个文件的 xml 标头，在任何出现的标签之间指定所需的工作表名称，例如 sheetname1：

```
<Sheetnames>?sheetname1?</Sheetnames> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-08-27T04:10:22.920

虽然在对象上使用 PageName 属性实际上允许您在 Excel 中自定义导出的工作表名称，但请注意，它还可以更新报表的命名空间定义，这可能会影响将报表重新部署到服务器的能力。

我有一个报告，我在 BIDS 中应用了它，它更新了我的命名空间，从 2008 年到 2010 年。当我尝试将报告发布到 2008R2 报告服务器时，我收到一个错误，即命名空间无效，必须将所有内容还原. 我确信我的情况可能是独一无二的，也许这不会总是发生，但我认为值得一提。一旦我发现问题，这个页面帮助恢复命名空间（除了重置命名空间之外，还必须删除一些标签）：

[http://beatheadagainstwall.blogspot.com/2011/03/invalid-target-namespace-when-deploying.html?showComment=1440647962263#c5741523651495876761](http://beatheadagainstwall.blogspot.com/2011/03/invalid-target-namespace-when-deploying.html?showComment=1440647962263#c5741523651495876761)

# algorithm - 是否有充分的理由使用插入排序？

> ID：736920
> 
> 赞同：48
> 
> 时间：2009-04-10T07:03:26.247
> 
> 标签：algorithm, computer-science

对于通用排序，答案似乎是否定的，因为快速排序、归并排序和堆排序在平均和最坏情况下往往表现更好。然而，插入排序似乎在增量排序方面表现出色，即在较长时间内一次向列表添加一个元素，同时保持列表排序，特别是如果插入排序实现为链表（O(log n) 平均情况与 O(n))。但是，堆似乎能够（或几乎）执行增量排序（从堆中添加或删除单个元素的最坏情况是 O(log n)）。那么与其他基于比较的排序算法或堆相比，插入排序究竟提供了什么？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-04-10T07:05:33.883

来自[http://www.sorting-algorithms.com/insertion-sort](http://www.sorting-algorithms.com/insertion-sort)：

> 尽管它是最坏情况时间为 O(n ² ) 的基本排序算法之一，但插入排序是当数据接近排序（因为它是自适应的）或当问题规模很小（因为它开销低）。
> 
> 由于这些原因，并且由于它也很稳定，因此插入排序通常用作递归基本情况（当问题规模较小时），用于更高开销的分治排序算法，例如合并排序或快速排序。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-04-10T07:15:06.140

算法分析中的一个重要概念是**渐近**分析。在具有不同渐近运行时间的两种算法的情况下，例如一种 O(n^2) 和一种 O(nlogn)，分别是插入排序和快速排序的情况，**并不能确定一种比另一种快。**

这种分析的重要区别在于，对于**足够大的 N**，一种算法将比另一种算法更快。在将算法分析到 O(nlogn) 之类的术语时，您会删除常量。在实际分析算法的运行时，这些常数仅在 n 较小的情况下才重要。

那么这是什么意思？这意味着对于某些小的 n，某些算法更快。这篇来自 EmbeddedGurus.net 的[文章](http://embeddedgurus.com/stack-overflow/2009/03/sorting-in-embedded-systems)包含了一个有趣的观点，即在有限空间 (16k) 和有限内存系统的情况下选择不同的排序算法。当然，本文仅引用了对 20 个整数的列表进行排序，因此 n 的较大顺序无关紧要。更短的代码和更少的内存消耗（以及避免递归）最终是更重要的决定。

插入排序开销低，可以写得相当简洁，并且它有几个两个关键的好处：它是稳定的，并且当输入接近排序时它有一个相当快的运行情况。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2015-05-12T14:05:38.563

是的，有理由使用插入排序或其变体之一。

此处其他答案的排序选项（快速排序等）假设数据已经在内存中并准备就绪。

但是，如果您尝试从较慢的外部源（例如硬盘驱动器）读取大量数据，则会浪费大量时间，因为瓶颈显然是数据通道或驱动器本身。它只是跟不上CPU。在任何读取过程中都会发生一系列自然的等待。这些等待是***浪费的 CPU 周期***，除非您使用它们进行***排序***。

例如，如果您要解决此问题，请执行以下操作：

1.  将专用循环中的大量数据读入内存
2.  对该数据进行排序

与在两个线程中执行以下操作相比，您很可能需要更长的时间。

线程 A：

1.  读取数据
2.  将数据放入 FIFO 队列
3.  （重复直到数据从驱动器中耗尽）

线程 B：

1.  从 FIFO 队列中获取数据
2.  ***将其插入排序列表中的适当位置***
3.  （重复直到队列为空并且线程 A 说“完成”）。

...以上将允许您使用否则浪费的时间。注意：线程 B 不会阻碍线程 A 的进展。

当数据被完全读取时，它已经被分类并准备好使用了。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-10T07:04:20.143

大多数排序过程将使用快速排序，然后对非常小的数据集使用插入排序。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-10T07:41:47.587

如果您正在谈论维护排序列表，则与某种树相比没有优势，只是速度较慢。

好吧，也许它消耗更少的内存或者是一个更简单的实现。

插入排序列表会涉及扫描，这意味着每次插入都是 O(n)，因此排序 n 项变为 O(n^2)

插入平衡树等容器通常是 log(n)，因此排序是 O(n log(n))，这当然更好。

但对于小型列表，它几乎没有任何区别。如果您必须自己编写而不使用任何库、列表很小和/或您不关心性能，则可以使用插入排序。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-21T20:28:17.463

是的，

插入排序在短列表上优于快速排序。

事实上，最佳快速排序有一个大小阈值，它会在该阈值处停止，然后整个数组通过插入排序超过阈值限制进行排序。

还...

为了维护记分牌，二元插入排序可能会尽可能好。

请参阅[此页面](http://www.pathcom.com/~vadco/binary.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-03-06T16:28:06.083

对于小数组大小的插入排序优于快速排序。 **Java 7 和 Java 8**使用双主元快速排序对原始数据类型进行排序。双轴快速分拣执行典型的单轴快速分拣。根据双轴快速排序算法：

1.  对于小数组（长度 < 27），使用插入排序算法。
2.  选择两个支点…………

当然，插入排序对较小的数组大小执行快速排序，这就是为什么要 **为长度小于 27 的数组切换到插入排序**。原因可能是：插入排序中没有递归。

资料来源：[http ://codeblab.com/wp-content/uploads/2009/09/DualPivotQuicksort.pdf](http://codeblab.com/wp-content/uploads/2009/09/DualPivotQuicksort.pdf)

# .net - 将用户输入转换为文字正则表达式的代码？（C＃）

> ID：736924
> 
> 赞同：0
> 
> 时间：2009-04-10T07:04:30.970
> 
> 标签：.net, regex

有时我想将用户输入转换为正则表达式中的文字值。即，如果用户输入`C:\Win\Bin\File.txt`正则表达式将类似于`C:\\Win\\Bin\File.txt`因为某些字符组合必须被转义。有谁知道执行此操作的经过验证的真实代码，或自动执行此操作的其他技术？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T07:16:16.963

你试过 Regex.Escape() 吗？

例如

```
var userInputRegex = new Regex(Regex.Escape(userInput));
```

# actionscript-3 - 无法在 HTML 组件中显示图像

> ID：736926
> 
> 赞同：1
> 
> 时间：2009-04-10T07:05:33.417
> 
> 标签：actionscript-3, air, webkit

我有以下 HTML 组件，试图显示本地图像，但是无论我使用`<img src="file:/tmp/img.png">`还是`<img src="/tmp/img.png" />`. 任何想法为什么这不起作用？将文件保存到本地文件并打开它工作正常！

```
var xhtml:XML = <html>
<body>
  <img src="file:/tmp/logo.gif" />
</body>
</html>;
myhtml.htmlText = xhtml.toXMLString(); 
```

**更新：**

顺便说一句，这很好用，如果我将相同的 xhtml 保存到文件中并使用 webkit 使用`myhtml.htmlLoader.load(new URLRequest("file:///path/to/html/file"))`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T07:25:34.773

您是否在网页的其他部分检查过任何 javascript 错误？他们可能会阻止您的网页打开。

嵌入图像的语法看起来不错，请在此处查看： [http ://www.w3schools.com/htmL/tryit.asp?filename=tryhtml_images2](http://www.w3schools.com/htmL/tryit.asp?filename=tryhtml_images2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T12:27:22.143

你检查过安全沙箱违规吗？你也试过“tmp/img.png”和“./tmp/img.png”吗？

或者也许 Air 不支持 xhtml，我不确定。尝试删除 img 标签中的斜线，如下所示：

```
myhtml.htmlText = "<html><body><img src=\"tmp/logo.gif\"></body></html>"; 
```

# asp.net - 是 ASP.NET MVC 1.0 Futures 测试版/预览版代码吗？

> ID：736930
> 
> 赞同：1
> 
> 时间：2009-04-10T07:07:16.953
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-futures

我了解“ASP.NET MVC 1.0 期货”中的“1.0”意味着它是针对 ASP.NET MVC 1.0 RTW（最终/发布到网络）构建的 ASP.NET MVC 期货。我想知道的是期货代码是否足够可靠，可以视为 1.0 / 黄金质量？

我们即将第一次进入 ASP.NET MVC，因此我们应该考虑将 Futures 添加到我们的构建中。问题是，如果它是字母代码，我想知道它是否明智；稳定性对我们来说非常重要。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T07:11:46.677

这是正式版本，不是测试版。但是，与任何 Microsoft 产品一样，如果您可以等待，2.0 总是会更好，但就您的问题而言，它是完整版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-10T07:09:25.403

稳定性还是不错的。唯一的问题是将来可能会更改功能。无论如何，我在productino网站上使用它们没有任何问题。

# c# - 在自身内部复制arraylist值

> ID：736931
> 
> 赞同：-1
> 
> 时间：2009-04-10T07:07:48.777
> 
> 标签：c#

考虑我有这样的 ArrayLists，

1){int[],int,int[]}
2){int[],int[],int} 我有一个计数，'n'。如果 n 是 3，那么我的 arrayList 应该是，

1){int[],int[],int[],int,int[],int[],int[]}

2){int[],int[],int[],int[],int[],int[],int}

即新的ArrayList 应该包含'n' 倍的Array int[]。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T07:23:03.750

一方面，您真的必须使用`ArrayList`吗？您在一个集合中保存不同类型的数据这一事实表明，可能有更好的方法来解决您的问题。无论如何，你可以做这样的事情：

```
public static ArrayList DuplicateIntArrays(ArrayList input, int copies)
{
    ArrayList ret = new ArrayList();
    foreach (object element in input)
    {
        if (element is int[])
        {
            for (int i=0; i < copies; i++)
            {
                ret.Add(element);
            }
        }            
        else
        {
            ret.Add(element);
        }
    }
    return ret;
} 
```

# hibernate - 休眠工具

> ID：736934
> 
> 赞同：0
> 
> 时间：2009-04-10T07:11:06.850
> 
> 标签：hibernate

嗨，我使用 Hibernate 工具和 eclipse ganymede 3.4.1。现在，当我使用 Hibernate 工具的代码生成创建 .hbm.xml 文件时，它会自动创建一个复合键。我在这里添加代码：

但我需要一个类似的映射

```
 <id name="id" type="java.lang.Integer">
            <column name="id" />
        </id>
        <key-property name="name" type="string">
            <column name="name" length="30" />
        </key-property>
        </class> 
```

. 有人可以告诉我该怎么做。

提前致谢， 里玛

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T07:30:06.260

该工具以某种方式使您的表结构具有复合主键（id，name）。如果这是表结构，那么工具没有弄错。或者它只是有一个错误。

无论如何，如果你在“名称”字段上有一个唯一索引，你应该像这样映射它：

```
<property name="name" type="string" unique="true">
    <column name="name" length="30"/>
</property> 
```

`<key-property>`tag 在`<composite-id>`tag 中用于将多个属性定义为标识符属性。

# java - 良好的 Java 社区和资源

> ID：736940
> 
> 赞同：2
> 
> 时间：2009-04-10T07:16:15.620
> 
> 标签：java, resources

我刚刚开始学习 Java 作为我的 uni 课程的一部分，到目前为止我真的很喜欢它。我做了一个快速搜索，试图在网上找到一个 Java 社区，但真的没有任何运气。我一直在寻找类似于 gotoandlearn.com 和 www.kirupa.com 的东西，就像 Flash 社区一样。

任何人都可以为 java n00b 推荐一个好的起点和友好的地方吗？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-10T07:18:21.810

你可以试试 javaranch.com。它是 Internet 上最活跃的 Java 社区之一。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-04-10T07:18:25.880

*   [Javaranch.com](http://www.javaranch.com/)
*   [CodeRanch 论坛](http://www.coderanch.com/forums)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T12:53:28.727

试试[Java Blackbelt](http://www.javablackbelt.com)，它提供可以帮助您学习的测验和测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-10T07:22:30.083

您可能希望在此处查看[http://www.theserverside.com/](http://www.theserverside.com/)以及其他人推荐的其他内容。但是如果你是一个[在 Java 中思考的菜鸟，Bruce Ecke](http://www.mindview.net/Books/TIJ4) l 是一个很好的起点 IMO。不能总是相信你在博客等 IMO 中找到的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-10T09:58:05.497

Sun 有一个[Java 论坛](http://forums.sun.com/index.jspa)。注册一个 ID 并浏览。与 Java Ranch 不同，这对新人来说可能是一个粗糙的地方。我认为自从他们添加了版主以来，情况有所改善。但它始终是 100% Java。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-10T07:19:05.770

你试过[comp.lang.java.programmer 新闻组](http://groups.google.com/group/comp.lang.java.programmer/topics)吗？（还有[comp.lang.java.help](http://groups.google.com/group/comp.lang.java.help/topics)，它更“面向新手”，但流量较少。）

# asp.net - 构建动态 LINQ 查询的最佳方式

> ID：736952
> 
> 赞同：7
> 
> 时间：2009-04-10T07:23:36.710
> 
> 标签：asp.net, linq

您好我正在寻找编写动态 LINQ 查询的最佳方法。

我有一个像

```
public IQueryable<Student> FindByAllStudents(int? id, string Name, int? CourseID, bool? IsActive) // like this way, all field values are passed
    {    
        // code for compairision
        return db.Student;
    } 
```

我们也可以写 db.Students.where(predicate)

或者

像这样的查询

```
var students = from s in db.students where s.Name.Contains(Name)
                s.ID.Equals(id)
                //and so on.... 
```

那么如果我不传递 ID（即 Null），这种方法会起作用吗？是所有数据类型的正确方法吗？

关键是函数可以将所有空值作为 select * from 语句等价的参数。

任何人都可以帮助我使用示例代码构建最佳查询吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-10T07:35:28.790

好的，尚不完全清楚您想要什么，但如果您尝试只为非空参数添加 where 子句，您可以这样做：

```
public IQueryable<Student> FindByAllStudents
    (int? id, string name, int? courseID, bool? isActive)
{    
    IQueryable<Student> query = db.Student;
    if (id != null)
    {
        query = query.Where(student => student.ID == id.Value);
    }
    if (name != null)
    {
        query = query.Where(student => student.Name.Contains(name));
    }
    if (courseID != null)
    {
        query = query.Where(student => student.CourseID == courseID.Value);
    }
    if (isActive != null)
    {
        query = query.Where(student => student.IsActive == isActive.Value);
    }
    return query;
} 
```

我还没有尝试过， LINQ to SQL*可能*会被代码混淆以查找可为空值类型的值。您可能需要编写如下代码：

```
 if (courseID != null)
    {
        int queryCourseID = courseID.Value;
        query = query.Where(student => student.CourseID == queryCourseID);
    } 
```

值得先尝试更简单的形式:)

当然，这一切都会让人有些恼火。一个有用的扩展方法可以让生活更简洁：

```
public static IQueryable<TSource> OptionalWhere<TSource, TParameter>
    (IQueryable<TSource> source,
     TParameter? parameter, 
     Func<TParameter, Expression<Func<TSource,bool>>> whereClause)
    where TParameter : struct
{
    IQueryable<TSource> ret = source;
    if (parameter != null)
    {
        ret = ret.Where(whereClause(parameter.Value));
    }
    return ret;
} 
```

然后你会像这样使用它：

```
public IQueryable<Student> FindByAllStudents
    (int? id, string name, int? courseID, bool? isActive)
{    
    IQueryable<Student> query = db.Student
        .OptionalWhere(id, x => (student => student.ID == x))
        .OptionalWhere(courseID, x => (student => student.CourseID == x))
        .OptionalWhere(isActive, x => (student => student.IsActive == x));
    if (name != null)
    {
        query = query.Where(student => student.Name.Contains(name));
    }
    return query;
} 
```

但是，如果您对它不太满意，使用这样的高阶函数可能会让人感到困惑，因此，如果您不做很多这样的查询，您可能希望坚持使用更长但更简单的代码。

# c# - 在 C# 中调用 F# dll

> ID：736956
> 
> 赞同：6
> 
> 时间：2009-04-10T07:25:45.613
> 
> 标签：c#, dll, f#, reference

如何创建 F# dll 并在 C# 中调用它？谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-10T09:50:48.433

要在 F# 中创建 DLL，您应该在项目属性中将输出类型设置为类库。使用前面提到的“添加引用”对话框在 C# 项目中添加引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-10T07:29:33.000

没有真正的技巧。像

[http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!307.entry](http://lorgonblog.spaces.live.com/blog/cns!701679AD17B6D310!307.entry)

反之亦然。需要注意的一点是，如果您未在 F# 代码中指定命名空间，则默认情况下，所有顶级定义都以文件名称结尾，因此如果您有 Program.fs，则可以参考Program.Whatever 来自 C#。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-11T01:55:45.867

如果您使用的是最新版本，您只需在创建项目时将项目类型设置为“F# Library”。

# email - 如何将 Zend_Mail_Transport_Smtp 与托管的 Google Apps 一起使用？

> ID：736964
> 
> 赞同：9
> 
> 时间：2009-04-10T07:30:16.447
> 
> 标签：email, zend-framework, smtp, gmail, dreamhost

所以我的印象是，如果我`Zend_Mail_Transport_Smtp`在发送大量电子邮件时不使用，就会发生不好的事情。问题是......我不知道如何设置它。我正在为我的域使用 Google Apps 托管的电子邮件。因此，要访问我的电子邮件，我会访问 mail.mydomain.com，它会将我带到 google 登录页面。

这是我正在使用的代码，但它不起作用。

```
$config = array('ssl' => 'tls', 'port' => 587, 'auth' => 'login', 'username' => 'webmaster@mydomain.com', 'password' => 'password');
$smtpConnection = new Zend_Mail_Transport_Smtp('mail.mydomain.com', $config); 
```

*   使用“mail.mydomain.com”我收到“连接超时”错误（这让我认为使用它是错误的。
*   使用“smtp.mydomain.com”我收到“无法打开套接字”错误。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-13T07:24:34.437

由于您通过 gmail 发送电子邮件，因此您应该使用“smtp.gmail.com”而不是您的域。

```
$config = array('ssl' => 'tls', 'port' => 587, 'auth' => 'login', 'username' => 'webmaster@mydomain.com', 'password' => 'password');
$smtpConnection = new Zend_Mail_Transport_Smtp('smtp.gmail.com', $config); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T12:05:12.150

多一些参考。使用远程端口上打开的端口扫描器检查端口，测试他们是否回复数据包，有时端口 25 无法正常工作，因此电子邮件失败，还有 SSL 或 TLS。

```
$config = array(
  'ssl' => 'ssl', //TLS = tcp://    use port 25      
                  //SSL = ssl://    use port 465 or 587
  'port' => 465,
  'auth' => 'login',
  'username'=> 'x',
  'password'=> 'b/c',
);
$tr = new Zend_Mail_Transport_Smtp('email-smtp.us-east-1.amazonaws.com', $config);
Zend_Mail::setDefaultTransport($tr); 
```

# design-patterns - 处理可以经历多个阶段的场景的最佳设计模式是什么

> ID：736967
> 
> 赞同：1
> 
> 时间：2009-04-10T07:31:46.613
> 
> 标签：design-patterns

这是我的问题。

我正在尝试编写一个简单的小型游戏引擎（我这样做是为了提高我的设计技能）。我有一个场景对象，它包含渲染 API 渲染它所需的一切。

自然，我希望我的场景不受未来变化的影响，这意味着对它的未来变化不必破坏它的界面。例如，如果我希望将来我的场景有一个可以打开和关闭的雾功能，我希望能够在不破坏我的场景界面的情况下添加它。

一件重要的事情是，渲染 API 通过一个接口（显然命名为“IScene”）与场景通信

我的想法是走向“装饰者”模式，有人能提出更合适的建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-10T08:27:21.347

我建议看看[现有的 API](http://www.google.com/search?q=3d+game+engines+open+source)。你很快就会明白这不是一个简单的问题。雾可能是一个过滤器（在屏幕上均匀），但这看起来不切实际。雾应该更像是靠近地面的半透明云。因此将其渲染为一个或多个半透明灰色对象可能更真实，但可能无法用当前硬件实现。

[编辑] 我想说的是：一个简单的装饰器模式可能不足以实现任何复杂的效果。我没有见过很多引擎，但大多数引擎都选择一个非常简单的场景对象，它只保存一些全局变量（环境光、相机位置、显示大小）以及要显示的对象列表。然后这些对象包含附加信息。

这些东西非常愚蠢。渲染器将​​获取存储在这些对象中的信息并将它们转换为显示硬件可以使用的东西。

同样，我的建议是从现有 API 中获得一些想法，因为它们已经犯了所有错误。

# c# - 你如何简单地解释类型转发？

> ID：736968
> 
> 赞同：3
> 
> 时间：2009-04-10T07:32:56.673
> 
> 标签：c#, .net

[阅读本文](http://msdn.microsoft.com/en-us/library/ms404275.aspx)后，我正在为 MCTS 70-536 做准备。我不是 100% 确定我理解类型转发的概念。我发现文章中给出的步骤更加令人困惑。如果我要复制要转发的类型的源代码并重新编译它，该怎么办。旧 dll 和客户端会发生什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-10T07:41:35.827

类型转发允许您在程序集之间重新定位类型。所以最初它`TypeA`在`AssemblyA`. `TypeA`通过应用类型转发，您可以以in结尾`AssemblyB`。

微妙之处在于*，已经编译的代码*看不到变化——它们要求输入 in `AssemblyA`，运行时默默地给他们 from 的类型`AssemblyB`。如果您有现有代码，这非常重要。

然而; *新*代码不能在`TypeA`没有你引用的情况下重新编译引用`AssemblyB`。

所以：

*   老客户端不需要重新编译
*   但是，您确实需要在上面的示例`AssemblyA`中重建两者`AssemblyB`
*   新代码（或任何重新编译的代码）现在必须引用`AssemblyB`（新代码）

# asp.net - ASP.NET DynamicData 和 IronSpeed 有什么区别？

> ID：736969
> 
> 赞同：1
> 
> 时间：2009-04-10T07:33:02.540
> 
> 标签：asp.net, asp.net-dynamic-data, ironspeed

新的 commer (DynamicData) 会取代旧的 (IronSpeed) 吗？它们似乎具有重叠功能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-10T09:51:12.567

好吧，一方面——ASP.NET 动态数据是您获得的基本 ASP.NET 包的一部分——IronSpeed 是一个价格相当高昂的商业附加组件。

所以我会假设对于很多人来说，只要 ASP.NET 动态数据有一半的用处（而且它确实有用！），这个问题是不费脑子的。

另外 - 这两者真的是完全不同的野兽 - 这就像将苹果与大象进行比较。IronSpeed 是一个完整的 Web 应用程序生成包——我想说，它不仅仅是用基本的管理 UI 为您的表格搭建脚手架。

另一方面，ASP.NET 动态数据不是一个完整的应用程序框架——它是一个很好的工具来启动和运行基本的管理和/或原型 UI，但它并不是最终的应用程序，真的。

马克

# licensing - 使用 GPL 的非 GPL 内核模块

> ID：736972
> 
> 赞同：11
> 
> 时间：2009-04-10T07:34:43.423
> 
> 标签：licensing, linux-kernel, gpl

我工作的公司正在开发一个闭源内核模块（.ko 文件）。该模块必须调用 gpl2 模块中包含的函数。基本上我们有这样的情况：

```
// GPL 2 kernel module  (gpl.c -> gpl.ko)
void a_function(void)
{
// ...
}
EXPORT_SYMBOL(a_function)

// Closed Source module (closed.c -> closed.ko)
a_function(); 
```

这合法吗？在这个例子中我们是否违反了 GPL2 许可？请注意，closed.c 不包含任何 gpl2 头文件。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-10T08:15:08.337

模块有**`GPL_ONLY`**标志，不应在非 GPL 模块中使用。因此，如果您正在谈论的模块不是`GPL_ONLY`，您可以使用它。

[**但是，如果您通过用户空间**](http://liquidat.wordpress.com/2007/07/21/linux-kernel-2623-to-have-stable-userspace-driver-api/)驱动程序访问它们，即使这些也`GPL_ONLY`可以使用[，这在 2.6.23 中是可能的](http://liquidat.wordpress.com/2007/07/21/linux-kernel-2623-to-have-stable-userspace-driver-api/)。这正是 USB 子系统发生的事情。[http://www.linux-magazine.com/online/news/linux_2_6_25_without_closed_source_usb_drivers](http://www.linux-magazine.com/online/news/linux_2_6_25_without_closed_source_usb_drivers)[](http://liquidat.wordpress.com/2007/07/21/linux-kernel-2623-to-have-stable-userspace-driver-api/)

 **不完全解决法律问题，但给你一些想法： [http ://www.cyberciti.biz/tips/linus-rejects-the-idea-of-non-gpl-kernel-modules.html](http://www.cyberciti.biz/tips/linus-rejects-the-idea-of-non-gpl-kernel-modules.html)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-13T11:38:11.537

IANAL 所以你真的应该寻求合格的法律意见。然而，这种方法肯定违背了许可证的精神，并且不会在内核领域赢得任何朋友。

但是，您可以考虑不同的拆分。一种方法是拥有一个完全 GPL 的模块，并将您所有的“秘密公司 IP”放在用户空间驱动程序中。当我工作的公司不热衷于向世界公开我们的 FPGA 细节时，我采用了这种方法。在用户空间和驱动程序的内核端决定的所有决定和寄存器设置只是将值加载到 IRQ 上。通过精心设计，您可以管理您可能遇到的任何实时问题，并且在封闭的驱动程序和内核之间有一个很好的干净分离。我相信使用支持用户空间驱动程序的较新内核会更容易，尽管我认为它们还不能正确支持 DMA（我必须编写用户空间 DMA 内核模块以直接在芯片组和用户空间之间支持 DMA）。

但是（再次）我真的建议您考虑一下您要保护的内容。对于您对内核版本和硬件有严格控制的嵌入式应用程序，封闭的驱动程序可能是可以的。但是，如果这个驱动程序被考虑用于任何更通用的东西（即销售硬件的人将插入他们自己的系统），那么闭源驱动程序只会被证明是持续痛苦和维护头痛的根源。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-10T08:02:05.900

第一：你需要和律师谈谈这件事；可能是您公司的法律部门。

第二：重要的问题是哪一段代码是从哪一段代码衍生而来的。

不幸的是，这个问题几乎有很多答案。

有些人会认为所有内核模块都是内核的派生作品，因此无论是否包含标头都必须是 GPL 的。

或者，您的封闭模块源自 GPL 模块，而 GPL 模块源自内核，因此封闭模块也必须是 GPL。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-15T19:18:01.147

一些关键的内核开发人员（但不是 Linus 本人）认为任何非 GPL 的模块都违反了内核许可。

当一些开发人员从 Linksys 路由器上拆下 Belkin 驱动程序，对其进行逆向工程并发布结果时，Belkin 无法阻止他们，因为将这种许可证解释提交法庭作为辩护的反威胁。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-15T19:22:19.313

无数其他驱动程序使用开源“shim”将闭源目标文件与开源内核桥接。大多数内核开发人员认为这至少在精神上违反了 GPL。

在我看来，这取决于您是否分发该软件。如果您纯粹在软件即服务上运行它，则应该允许这样做。如果您要分销嵌入式设备或盒装产品，这是不行的。

将您需要的任何功能移出内核，或开源您的内核组件。这就是其他人（老实说）所做的事情，而且通常并不那么棘手，因为任何拥有大量内核空间“知识产权”的人，要么拥有糟糕的商业模式，要么拥有不称职的工程团队。

***以上是我的看法***

# audio - 通过麦克风分析数字/模拟信号

> ID：736978
> 
> 赞同：0
> 
> 时间：2009-04-10T07:37:22.747
> 
> 标签：audio, analysis

我只需要指出正确的方向，因为我可能在这里过头了。

如果我想编写一个程序来分析声波，我会怎么做？

我有一个想法，它将涉及数学包（如mathematica或matlab）和C或C++的混合，但不知道从哪里开始。

我现在只是想知道，但任何指针将不胜感激。

我是新手，但并非无能，一个好的挑战永远是最好的学习方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T07:40:50.103

Mathematica 和 Matlab 都可以将 .wav 文件作为输入。

# c++ - 如何在我的 Qt 应用程序中处理“项目文件”？

> ID：736981
> 
> 赞同：1
> 
> 时间：2009-04-10T07:39:35.473
> 
> 标签：c++, xml, qt, settings

我的 Qt 应用程序应该能够一次创建/打开/保存单个“项目”。将项目设置存储在文件中的轻松方式是什么？它应该是 XML 还是不那么可怕的东西？

当然，要存储在文件中的数据会随着时间而改变。

我需要的是类似`QSettings`但仅限于我的应用程序中的**项目**而不是整个应用程序的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-10T08:13:39.540

我为了让它用户可编辑，我会坚持使用一个键 = 值的纯文本，就像在大多数 Linux 应用程序中一样。

但是，这仅适用于设置，而不适用于我认为需要更复杂结构的完整项目数据。

所以也许[JSON](http://www.json.org/)？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-10T08:34:17.930

专业 XML：

*   您可以在编辑器中查看它
*   您可以在其中存储任何语言的任何类型的字符串（unicode支持）
*   学习很简单
*   多个程序可以读取相同的 XML
*   使用 XML 构造数据很容易。例如，当您使用键/值列表时，当您需要保存树状结构时会遇到问题。

反对 XML

*   结果有些臃肿
*   大多数编程语言（尤其是像 C++ 这样的旧语言）对 XML 没有很好的支持。旧的 XML API 的设计方式使得它们可以用任何语言（最小公分母）实现。'纳夫说。
*   您需要了解“编码”（或“字符集”）的概念。虽然乍一看这可能看起来微不足道，但有一些隐藏的问题可能会咬你。所以总是用一些变音符号甚至日本汉字（日语字符）来测试你的代码，以确保你做对了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-10T17:13:20.490

您可以使用 QSettings 将数据存储在特定的 .ini 文件中。从文档：

有时您确实想访问存储在特定文件或注册表路径中的设置。在所有平台上，如果要直接读取 INI 文件，可以使用 QSettings 构造函数，该构造函数将文件名作为第一个参数，并将 QSettings::IniFormat 作为第二个参数传递。例如：QSettings settings("/home/petra/misc/myapp.ini", QSettings::IniFormat);

# c++ - 指针到指针不支持 C++ 多态性

> ID：736982
> 
> 赞同：2
> 
> 时间：2009-04-10T07:39:45.627
> 
> 标签：c++, pointers, polymorphism

我正在寻找一种正确的方法来清理我的指针。这里的示例代码：

```
class Parent {
   protected:
      int m_Var;
   public:
      Parent() : m_Var(0) {}
      virtual ~Parent() {}
      void PubFunc();
};

class Child : public Parent {
   protected:
      bool m_Bool;
   public:
      Child() : m_Bool(false) {}
      virtual ~Child() {}
      void ChildFunc();
};

void RemoveObj(Parent **ppObj)
{
   *ppObj->PubFunc();
   delete *ppObj;
   ppObj = NULL;
}

int main()
{
   Parent* pPObj = NULL;
   Child*  pCObj = NULL;
   pPObj = new Parent();
   pCObj = new Child();

   RemoveObj(&pPObj);
   RemoveObj(&pCObj); // This is line 33
   return 1;
} 
```

但是编译器给出了错误：

```
classes.cpp:33: error: invalid conversion from ‘Child**’ to ‘Parent**’
classes.cpp:33: error:   initializing argument 1 of ‘void RemoveObj(Parent**)’ 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-10T07:49:05.823

有很多方法可以正确处理内存。

与您的示例接近的一个是：

```
template <typename T>
RemoveObj(T **p)
{
    if (p == NULL) return;
    delete *p;
    *p = NULL;
} 
```

此外，您可能想改用 std::auto_ptr 。它看起来像：

```
int main()
{
   std::auto_ptr<Parent*> pPObj(new Parent);
   std::auto_ptr<Child*> pCObj(new Child);
   // no deletes needed anymore 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-10T09:20:36.680

简单地说：

Child 是 Parent 的子类，这意味着 Child* 可以替换为 Parent*

但

Child* 不是 Parent* 的子类，因此这意味着 Child** 不能用 Parent** 代替

“Child”和“Child*”不是同一类型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-10T09:52:40.287

您需要做的是使所有指向您刚刚删除的对象的指针无效。指针的思想是有不止一个指针存储同一个对象的地址。如果不是，则几乎没有理由使用裸指针，因此您尝试捕获的模式不是很有用 - 但您远不是第一个尝试这个的人。正如其他答案所提到的，处理指针的唯一方法是仔细控制对它们的访问。

你的问题的标题是绝对正确的！这是有充分理由的。指针标识存储特定类型对象的位置。指向指针的指针使您能够更改指针指向的对象。

```
void Foo(Parent **pp)
{
    *pp = new OtherChild();
} 
```

你的`Child`类派生自`Parent`，我的类也是如此`OtherChild`。假设编译器允许您这样做：

```
Child *c = 0;
Foo(&c); 
```

您希望它可以工作，但如果它可以工作，那么我们现在将有一个`Child`指针`c`，它实际上指向`OtherChild`. 谁说这两种类型可以兼容？

`List<Parent>`同样，这是一个非常常见的误解——它在这里反复出现在其他语言中，尤其是`List<Child>`在 C# 中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-10T08:19:47.090

您不需要用于删除的包装器，请保持简单：

```
int main()
{
  Parent* pPObj = NULL;
  Child*  pCObj = NULL;
  pPObj = new Parent();
  pCObj = new Child();

  delete pPObj;
  delete pCObj; // This is line 33
  return 1;
} 
```

请记住，您会遇到删除数组类型对象的问题`RemoveObj`（因为您总是使用 scalar `delete`）。当然，另一种方法是传递一个标志来表明你想要`delete []`。但正如我所说：亲吻。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-10T09:35:24.070

如果您的问题是处理内存和资源，最好的建议是完全忘记您的方法并使用智能指针。*std::auto_ptr*或*boost::shared_ptr*将是一个起点。

如果您使用智能指针保存所有堆分配的资源，您的代码将更加健壮。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-10T08:16:08.363

你可以从《C++ 常识》Item 8\. Pointers to Pointers 一书中找到一些有用的信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-10T11:14:51.180

可能是我找到的最简单的解决方案：

```
#define __REMOVE_OBJ(pObj) RemoveObj(pObj); pObj = NULL; 
```

就叫这个：

```
 __REMOVE_OBJ(pPObj);
   __REMOVE_OBJ(pCObj); 
```

但是我自己不是很喜欢...

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-10T13:59:18.647

从关于[make shared_ptr 的讨论不使用删除](https://stackoverflow.com/questions/441306/make-sharedptr-not-use-delete/441810#441810)

共享指针将确保您在应该清理的时候进行清理，并且您不会访问被破坏的东西。此外，您可以专门化并提供另一种销毁方法。

```
boost::shared_ptr<T> ptr( new T, std::mem_fun_ref(&T::deleteMe) ); 
```

# php - PHP 重定向暂停

> ID：736989
> 
> 赞同：16
> 
> 时间：2009-04-10T07:45:04.397
> 
> 标签：php, redirect

如何在使用 PHP 将用户重定向到另一个 HTML/PHP 页面之前将页面暂停几秒钟？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-04-10T08:44:04.663

这个应该有效：

```
<?php
header('Refresh: 5; URL=http://yoursite.com/page.php');
//other code
?> 
```

并允许您的用户查看您想要的任何类型的输出（您将在 X 秒内被重定向，如果没有，请单击 yere 等。）

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-10T07:56:25.307

不需要 Javascript 甚至 PHP 的低技术解决方案：

```
<html>
<head>
    <title>Redirecting...</title>
    <meta http-equiv="refresh" 
content="10;URL=http://www.newsite.com">
</head>
<body>
    You are being automatically redirected to a new location.<br />
    If your browser does not redirect you in 10 seconds, or you do
    not wish to wait, <a href="http://www.newsite.com">click here</a>. 
</body>
</html> 
```

与使用“Location:”标头相比，此解决方案的优势在于您无需暂停脚本执行，这对用户来说就像服务器正忙或他们的连接已挂起。

此解决方案还为用户提供了立即进入新页面的选项，而不必在浏览器不显示任何信息时等待*x 秒。*

编辑：我认为还值得注意的是，如果您决定使用 header() 方法，则需要确保 sleep() 持续时间不会太长。我认为大多数浏览器在 1 分钟内未从服务器接收任何数据后生成*连接超时。*

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-10T11:15:11.257

**永远不要**以这种方式使用睡眠。即使在轻微负载下，您的服务器也会耗尽 http 连接。最糟糕的是，如果您的防火墙用完了。

重定向标头中的延迟参数是出于完全相同的原因而制作的。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-03-19T12:22:07.813

如果您想等待然后返回上一页，方法如下

```
$referrer = $_SERVER['HTTP_REFERER']; 

header ("Refresh: 2;URL='$referrer'"); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-10T07:47:10.430

**更新**：这可行，但可能不是这种情况下最合适的解决方案。看评论。

这可能是您正在寻找的东西吗？

```
<?php
sleep(5);
header("Location: http://www.example.com/");
exit();
?> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-10T07:48:08.040

其他 2 个选项是使用 setTimeout() 的 Javascript 重定向或具有超时的元刷新标记。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-23T00:45:47.257

尝试：

```
<?php
$url=base_url().'page_you_want_to_go_to'
header('Refresh: X; URL=$url');
?> 
```

在本地主机和远程服务器之间进行交换时，这将为您提供额外的灵活性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-08T09:29:18.997

把它放在标题中。

```
 <meta http-equiv="refresh" content="0.01;makensucces.html" /> 
```

在 0.01 的地方，你必须输入秒数，我使用了十进制数。

在 makensucces.html 的位置上，您需要将名称从您想要的文件中删除。*******************```