# StackOverflow 问答 10330000-10330999

# android - 为什么我不能设置 TextView 显示来电电话号码？

> ID：10330001
> 
> 赞同：1
> 
> 时间：2012-04-26T08:45:27.440
> 
> 标签：android, textview, broadcastreceiver, phone-call

我有一个应用程序可以用我自己的设计替换标准的来电屏幕。当有人打电话时，我的自定义屏幕会弹出。这很好，但由于某种原因，我的应用程序无法显示传入的电话号码。传入的电话号码显示在 LogCat 中，但是当我尝试将 TextView 设置为该字符串时，什么也没有显示。这是检索传入电话号码的代码：

```
Bundle extras = intent.getExtras();
    phoneNr = extras.getString("incoming_number");
    Log.v(TAG, "phoneNr: " + phoneNr); 
```

如您所见，字符串“phoneNr”在 LogCat 中显示传入的电话号码。但是当我尝试使用它在显示我的自定义屏幕的类 (IncomingCallRecieved) 中设置 TextView 的文本时：

```
IncomingCallListener ICL = new IncomingCallListener(); // class for BroadcastReciever
textView_incomingNumber.setText(ICL.phoneNr); 
```

TextView 保持空白。

关于为什么会发生这种情况的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T08:56:04.793

如果 phoneNr 是整数，请执行此操作`""+phoneNr`，

也使`new IncomingCallListener()`对象不会引用实际获得数字的类..所以要么使该数字变量`public static`并直接使用该变量，例如`classname.variablename`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T03:55:51.190

找到了答案！ [http://android-journey.blogspot.com/2010/01/android-braodcast-receivers.html](http://android-journey.blogspot.com/2010/01/android-braodcast-receivers.html)

我所做的是为以下内容创建了一个 String 方法：

```
 intent.getStringExtra(TelephonyManager.EXTRA_INCOMING_NUMBER) 
```

抓住电话号码并返回。所以在我的自定义屏幕的课堂上，我这样做了：

```
IncomingCallListener ICL = new IncomingCallListener();
textView_incomingNumber.setText(ICL.getPhoneNumber()); 
```

现在我的自定义屏幕在 textview 中显示传入的电话号码

# c++ - 小双数的总和c ++

> ID：10330002
> 
> 赞同：13
> 
> 时间：2012-04-26T08:45:30.477
> 
> 标签：c++, , c++, numbers, double, sum

假设我们在[c++](/questions/tagged/c%2b%2b "show questions tagged 'c++'")`10^(-15)`中有一个小（大约）双精度数的数组。如果我们按顺序计算这个数组中数字的总和，例如

```
double sum = 0;
for (int i = 0; i < n; i++) sum+=array[i]; 
```

我们得到了一些价值`x`。

但是，如果我们将一个数组分成若干部分，然后计算每个部分的总和，然后将所有部分总和相加，我们会得到一些值`x2`，该值接近`x`但不完全`x`。所以我在计算总和时失去了准确性。

有人知道如何通过将这些数字分成一些部分来计算小双数的总和而不会失去准确性吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-04-26T09:39:49.160

使用[卡汉求和](http://en.wikipedia.org/wiki/Kahan_summation_algorithm)：

```
#include <numeric>
#include <iostream>
#include <vector>

struct KahanAccumulation
{
    double sum;
    double correction;
};

KahanAccumulation KahanSum(KahanAccumulation accumulation, double value)
{
    KahanAccumulation result;
    double y = value - accumulation.correction;
    double t = accumulation.sum + y;
    result.correction = (t - accumulation.sum) - y;
    result.sum = t;
    return result;
}

int main()
{
    std::vector<double> numbers = {0.01, 0.001, 0.0001, 0.000001, 0.00000000001};
    KahanAccumulation init = {0};
    KahanAccumulation result =
        std::accumulate(numbers.begin(), numbers.end(), init, KahanSum);

    std::cout << "Kahan Sum: " << result.sum << std::endl;
    return 0;
} 
```

输出：

```
Kahan Sum: 0.011101 
```

代码[在这里](http://ideone.com/iuPPP)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-26T09:04:30.383

数字的绝对大小不是问题。

如果您想要更准确的总和，您是否考虑过补偿总和？[http://en.wikipedia.org/wiki/Kahan_summation_algorithm](http://en.wikipedia.org/wiki/Kahan_summation_algorithm)

但是，如果您真的是在不损失**任何**准确性的情况下，您的结果不一定适合双精度数。如果这确实是您想要的，您可以在[http://dl.acm.org/citation.cfm?id=1824815](http://dl.acm.org/citation.cfm?id=1824815)或类似网站上查看算法 908。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-26T08:51:34.670

在这些情况下，诀窍是首先将数组从小到大排序，然后在您创建的循环中求和。这样，准确性最好。

您还可以检查[Kahan 求和算法](http://en.wikipedia.org/wiki/Kahan_summation_algorithm)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-26T08:55:39.817

考虑对整个集合或每个子集应用[Kahan 求和算法。](http://en.wikipedia.org/wiki/Kahan_summation_algorithm)

还有其他[问题](https://stackoverflow.com/questions/4940072/kahan-summation)可以参考这个算法，可以帮助你

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-26T08:50:47.050

计算机中的双精度数以二进制数字系统存储。这就是为什么当您看到一个双精度值（十进制表示法）时，您实际上会看到带有一些舍入的双精度值（例如 0.1 是无限小数）。您可以进行相同的实验，其中双精度值为 2（例如 2^(-30)），然后您将看到这些值将匹配。

将不同顺序的双精度值求和时观察到差异的原因是，每次计算后，结果都会以二进制数字系统四舍五入，因此与实际值会出现一点差异。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-04-26T08:50:53.763

用于表示十进制数的二进制浮点数具有比准确性更高的精度。你已经找到了一种表现差异的方法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-26T09:03:35.950

*可能*是您的个人求和正在被优化并在 80 位的寄存器中执行，但随后又被转移回 64 个双精度数（阅读有关编译器开关的信息）。这自然会失去精度。如果是这种情况，那么分解数组并添加单独的 64 位和将给出不同的答案，将它们全部添加为 80 位 a 并将总计转换回来。

这可能不是原因，但可能值得进一步研究。看看[这个问题的选择答案](https://stackoverflow.com/questions/3206101/extended-80-bit-double-floating-point-in-x87-not-sse2-we-dont-miss-it)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-06T12:49:28.867

在处理非常小的数字与处理正常大小的数字时，添加数字的结果中的精度损失没有什么不同。可能相关的是：a）数字之间的相对差异是否很大？b) 数字有不同的标志吗？

最后一个问题通常与加法精度有关。你应该做的——也许不是完全最优的，但是公平的，并且易于实施——是：

a) 分别将它们分成正负子集

b) 对每个子集进行排序

然后

c）从两个集合中取最大的（绝对大小），并用该数字初始化您的总和，并将其从列表中删除

d) 迭代：每当当前总和为正时，取最大的剩余负数并将其添加到总和中，并将其从列表中删除；每当当前总和为负数时，也一样。

通过这种方式，您有很大的机会（几乎）将精度损失降到最低，而这本来是不可避免的（考虑到数字的表示）。

# php - 意外'['，期待')' - 构造函数中的数组

> ID：10330005
> 
> 赞同：0
> 
> 时间：2012-04-26T08:45:48.667
> 
> 标签：php

我有这个代码：

```
class foo
{
    public function __construct
    (
        $bar[var1]  = 0,
        $bar[var2]  = 0,
        $bar[var3]  = 0
    )
    {
        /* do something */
    }
} 
```

我得到这个错误：

> 解析错误：语法错误，第 5 行*$this*中出现意外的 '['，期待 ')'

我不知道出了什么问题。

**编辑：**

我想像这样初始化类：`$instance = new foo($bar)` （$bar 是一个数组）

因为这个类需要很多参数，我可以很容易地从构造函数返回数组。如果这不是一个好主意，请告诉我。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-26T08:46:45.337

你为什么要在函数参数定义中创建一个数组？这是没有意义的，你不能这样做。

如果您想`$bar`成为参数但确保存在某些值（即默认值），请这样做：

```
public function __construct($bar)
{
    if(!isset($bar['var1'])) $bar['var1'] = 0;
    if(!isset($bar['var2'])) $bar['var2'] = 0;
    if(!isset($bar['var3'])) $bar['var3'] = 0;

    /* do something */
} 
```

或更紧凑的方式：

```
public function __construct($bar)
{
    $bar = array_merge(array('var1' => 0, 'var2' => 0, 'var3' => 0), $bar);
    /* do something */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T08:47:07.753

```
class foo
{
    public function __construct($bar = array())
    {
        $bar += array(
            "var1" => 0,
            "var2" => 0,
            "var3" => 0
        );

        /* do something */
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T08:47:56.070

```
class foo
{
    public function __construct()
    {
        $bar = func_get_args();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T08:48:20.580

你不能这样做，你应该将数组作为一个整体传递。还必须引用键

```
public function __construct($bar)
    {
        $bar['var1']  = 0;
        $bar['var2']  = 0;
        $bar['var3']  = 0;

        /* do something */
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-26T08:49:11.983

```
class foo
{
    public function __construct($bar = array('var'=>0, 'var2'=>0, 'var3'=>0))
    {
        var_dump($bar);
    }
} 
```

# javascript - 十字准线的 Highcharts zIndex 问题

> ID：10330012
> 
> 赞同：2
> 
> 时间：2012-04-26T08:46:00.733
> 
> 标签：javascript, jquery, highcharts, jsfiddle, highstock

我最近（从昨天开始）开始使用 highcharts。我正在使用`area`该系列的情节。我启用了十字准线并将其设置`zIndex`得更大，使其在绘图区域上方可见。但是，这里又出现了一个问题。标记（我在这里使用了一个圆圈）位于十字准线的后面。我的意思是现在的序列是（情节->标记->十字准线）。

现在，我想要的是（情节->十字准线->标记）。这甚至可能吗？如果是，我需要做什么？

下面是当前情况的图像场景。如果我在任何地方错了，请纠正我。

![在此处输入图像描述](../Images/30cfd91bf4d7eee3774a1649f073eac6.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-23T05:28:53.807

您所要做的就是设置十字准线

```
tooltip: {
  crosshairs: [true, true]
} 
```

和标记宽度

```
plotOptions: {
  area: {
    marker: {
      enabled: false,
      symbol: 'circle',
      radius: 6,
      states: {
        hover: {
          enabled: true
        }
      }
    }
  }
} 
```

# android - 从列表视图中选择主键

> ID：10330018
> 
> 赞同：0
> 
> 时间：2012-04-26T08:46:24.383
> 
> 标签：android, listview, primary-key

我使用了这个链接[如何查找选择的选定列表的主键](https://stackoverflow.com/q/8473151/1296361)，显示了一个项目时的Toast消息..任何人都请帮助我如何获取所选项目的主键...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T08:52:15.823

我不知道您在 ListView 中显示什么数据。但我建议你创建**`ArrayList<Object>`**，这样你就可以从那个点击的位置获得一个特定的对象。

所以，一旦你有了对象，你就可以从这个对象中获取/显示你想要的任何细节。

例如，我有`ArrayList<Student>`where student 是用户定义类的对象，包含 RollNo、Name、Address 等。因此，如果您以这种方式准备数组列表，则可以轻松管理特定对象的多个数据。

# oracle - Oracle 存储过程删除用户

> ID：10330031
> 
> 赞同：2
> 
> 时间：2012-04-26T08:47:01.173
> 
> 标签：oracle

我尝试了类似的方法从 Oracle DB 中删除用户。

```
create or replace procedure skeleton1(inUser varchar) IS
begin
  set @str = concat('drop user ', "'",inUser,"'@","'localhost'");
  prepare stmt from @str;
  -- select @str;  
  execute IMMEDIATE stmt;
  deallocate prepare stmt;
end//
delimiter ; 
```

但我面临多个编译错误。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T09:04:05.723

您所拥有的很少是有效的 Oracle 语法。我建议你在尝试做任何可能具有破坏性的事情之前开始阅读 PL/SQL 文档。也许从[这里](http://docs.oracle.com/cd/E11882_01/appdev.112/e10766/toc.htm)开始，看看它会把你带到哪里。

我有点不愿意直接回答，但你会从某个地方得到它；所以你可以做类似的事情：

```
create or replace procedure skeleton1(inUser varchar) IS
begin
  execute IMMEDIATE 'drop user ' || inUser);
end;
/ 
```

但是你需要清理你的输入以真正确保它不会被滥用，你真的需要了解你在做什么以及它可能产生什么影响。举一个例子，如果用户拥有任何对象，这将失败。

# javascript - 用JS写文字

> ID：10330032
> 
> 赞同：0
> 
> 时间：2012-04-26T08:47:06.413
> 
> 标签：javascript

我正在尝试为相关结果编写文本，但我希望每个页面的文本都不同，我认为可以使用 document.write 来完成，但我不确定具体的操作方式。我正在使用博客，它为每个页面放置相同的代码，所以你可以理解我不能为每个页面使用不同的 JS，应该有一种方法可以在每个不同的页面上为相关结果提供不同的文本。这是测试页面的链接[http://bloghutsbeta.blogspot.com/2012/04/testing-slider.html](http://bloghutsbeta.blogspot.com/2012/04/testing-slider.html) 那里的图片是相关结果。

这是我的 JS

```
<script type='text/javascript'>
    var defaultnoimage=&quot;http://1.bp.blogspot.com/_u4gySN2ZgqE/SosvnavWq0I/AAAAAAAAArk/yL95WlyTqr0/s400/noimage.png&quot;;
    var maxresults=14;
    var splittercolor=&quot;none&quot;;
    var relatedpoststitle=&quot;Related Results&quot;;
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T08:53:14.573

您可以做的是检查每个页面的标题。我相信每一页都会有一个独特的标题。根据该标题，您可以使用 JS 为该页面编写文本 var pageTitle = document.title;

```
if(pageTitle == 'testpage')
{
  document.getElementById('myID').text = 'Your text goes here'
}
else
{
  document.getElementById('myID').text = 'Your new text goes here'
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T10:06:03.770

好吧，这里有一些技巧：

```
window.onload = function() { // Wait for the DOM to be loaded
    var t = document.getElementById('posttitle')
    switch ( window.location.pathname ) {
        case '/2012/04/testing-slider.html':
            t.textContent = 'Some title'
            break
        case '/2012/05/some-thing.html':
            t.textContent = 'Some other title'
            break
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-04-26T08:48:44.447

你能做的就是让你的代码像这样

```
<div id="posttitle" style="display: none;">Related Results</div> 
```

然后将此变量添加到您的 JS

```
var relatedpoststitle = document.getElementById(&quot;posttitle&quot;).innerHTML; 
```

它应该可以帮助你。

# jquery - jQuery 验证和延迟对象

> ID：10330034
> 
> 赞同：0
> 
> 时间：2012-04-26T08:47:09.283
> 
> 标签：jquery, jquery-validate, jquery-deferred

我有一个使用 jQuery 验证功能的表单，其中一些自定义函数使用 ajax 帖子验证值。

我的问题是当我提交表单时，我让 submitHandler 做 ajax 发布以通过签入数据库来检查该字段是否有效。如果返回的值有效，我只希望提交表单。

```
(function ( $ ) {
    $.fn.checkValidSubDomain = function (params) {
        params['siteID'] = wlSiteID;
        var deferred = $.Deferred();
        var promise = deferred.promise();

        $("div#"+$(this).attr('id')+"Info").html(copyItems["info_checkingStatus"]);
        var jqxhr = $(this).ajaxPost('checkValidSubDomain', params)
        jqxhr.success(function (data){
            if (data.validSubdomain) {
                $("div#"+$(this).attr('id')+"Info").html(copyItems["info_"+$(this).attr('id')+"Available"]);
                deferred.resolve(data);
            } else {
                $("div#"+$(this).attr('id')+"Info").html(copyItems["err_"+$(this).attr('id')+"Unavailable"]);
                deferred.reject(jqxhr, 'error');
            }
        })
        jqxhr.error(function (jqXHR, status, error){
            $("div#"+$(this).attr('id')+"Info").html(copyItems["err_"+$(this).attr('id')+"Unavailable"]);
            deferred.reject(jqXHR, status, error);
        });
        return promise;
    };
})(jQuery);

var validationRules = {
    submitHandler: function(form) {
        var promise;
        if ($('input[name="domainSetting"]:checked').val() == 'subDomain') {
            alert("checking subdomain - " + $('#subDomainSiteName').val())
            promise = $('#subDomainSiteName').checkValidSubDomain({'subDomain': $('#subDomainSiteName').val(), 'domain':$("#domainSelect option:selected").val()});
        } 
        promise.done(function() {
            form.submit();
        });
        return false;
    },
    onfocusout: false,
    onkeyup: false,
    rules: {
        subDomainSiteName: {
            required: {
                depends: '#domainSettingSubDomain:checked'
            }
        }
    }
};
$('#domainSettingsFRM').formValidation(validationRules); 
```

我不知道我是如何进入表单的，只有在该字段有效的情况下才提交。目前，它只是显示警报然后提交表单而不管值如何。

任何帮助表示赞赏

**编辑**

我想我刚刚想通了。一旦异步 ajax 调用完成，promise.done() 就会触发。那时我只需检查状态以查看它是否已解决或被拒绝。将代码更改为以下似乎可以解决问题。

```
promise.done(function() {
    if (promise.state() == "resolved") {
        form.submit();
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T08:54:07.143

没有看到带有该代码的演示页面，乍一看，行为可能是由于 javascript 错误：你写的地方

```
 promise.done()(function() {
            form.submit();
 }, null); 
```

你应该改写

```
 promise.done(function() {
     form.submit();
 }); 
```

# dll - 构建路径中的 JNA dll

> ID：10330036
> 
> 赞同：1
> 
> 时间：2012-04-26T08:47:10.797
> 
> 标签：dll, jna, search-path

我在 java web 应用程序中使用 ghost4j。这个库通过 JNA 加载一个 dll。现在我想将 dll 放在类路径中，因为当我运行测试、使用 eclipse 在服务器上运行它或仅运行用于测试目的的主函数时，此应用程序的工作目录会发生变化。

我如何告诉 JNA 查看类路径？

我想到了类似的东西

```
class.getProtectionDomain().getCodeSource().getLocation().getPath() 
```

但是我怎样才能将这个程序添加到搜索路径中呢？我不喜欢添加 VM 参数

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T12:34:02.417

JNA 将查找`jna.library.path`本机库，如果在那里找不到任何内容，则回退到系统默认值（通常与 相同`java.library.path`）。

```
System.setProperty("jna.library.path", "/whatever/path/you/want"); 
```

# asp.net-mvc - _ViewStart.cshtml 与嵌套布局

> ID：10330041
> 
> 赞同：2
> 
> 时间：2012-04-26T08:47:17.480
> 
> 标签：asp.net-mvc, razor

我有以下项目结构：

![项目结构](../Images/3a0d549bf96b201708f2f849733b4461.png)

_ViewStart.cshtml：

```
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
} 
```

_Red.cshtml：

```
@{
    ViewBag.Title = "Red";
    Layout = "~/Views/Shared/_Layout.cshtml";
} 
```

_Blue.cshtml 没有**明确**指定的布局。

现在，如果尝试使用 _Red.cshtml 布局呈现 Index.cshtml，也会分层应用 _Layout.cshtml。所以基本上我们有一个嵌套的模板链_Layout->Red->Our page

但是，如果我尝试使用 _Blue.cshtml 呈现 Index.cshtml，则**不会**应用 _Layout.cshtml。我期待 _Layout.cshtml 按照约定使用 _viewstart 应用于 _Blue.cshtml。相反，我得到了仅应用了 _Blue.cshtml 模板的 Index.cshtml 页面。

我的假设错了吗？

提前致谢！

**更新：**

控制器方法：

```
public ActionResult Index()
{
    ViewBag.Message = "Welcome to ASP.NET MVC!";

    return View("Index");
} 
```

所以，我返回的是 ViewResult，而不是 PartialViewResult ;)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:02:52.550

是的，你的假设是错误的。如果指定了布局 (_Blue.cshtml)，则不会应用 _Viewstart 中的布局。_Viewstart 用于您的默认布局，因此您不必在每个页面上都指定它。

# android - Linux下使用ndk在Android中的ObjC代码

> ID：10330046
> 
> 赞同：1
> 
> 时间：2012-04-26T08:47:42.267
> 
> 标签：android, objective-c, linux, android-ndk, centos

我正在尝试在 Linux 下实现这一点， **将 Objective C 支持添加到 Android NDK**

我从这里拿了一些参考资料

[http://blog.vucica.net/2011/06/developing-objective-c-apps-for-android-using-mac-os-x.html](http://blog.vucica.net/2011/06/developing-objective-c-apps-for-android-using-mac-os-x.html)

但它不能编译，因为二进制文件是用于 OS-X

所以在那之后我决定为 Linux 编译 ndk-tools，点击这个链接

[http://michael.f1337.us/2011/11/19/rebuilding-the-android-ndk-for-objective-c-support/](http://michael.f1337.us/2011/11/19/rebuilding-the-android-ndk-for-objective-c-support/)

我得到的第一个错误，缺少 --mpc-version 信息，可以在 build-gcc.sh 文件中手动添加，现在我被困在下一步，我得到了这个错误

错误：

“修复从 /home/SDKs/Android/toolchain-src/binutils/binutils-2.22.51/binutils/sysinfo.h 到 /tmp/ndk-root/build/toolchain/binutils-2.22.51/binutils/ 的 Google 错误复制sysinfo.h”</p>

构建：arm-linux-androideabi-4.6.1 工具链 [这可能需要很长时间]。构建工具链时出错。请参阅 /tmp/ndk-root/build/toolchain/config.log

**其中进一步说**：

配置：错误：在`/tmp/ndk-root/build/toolchain/libbfd-binutils-2.22.51'中：

配置：错误：C 编译器无法创建可执行文件

如果有人遇到过这个或有任何关于这个的信息，请分享..非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T10:07:58.853

我重建了最新的 NDK 以支持 ObjC，只是从 vanilla 开始。因此，您只需执行 2 个脚本并更改 NDK 中的 2 个文件。

用于下载工具链 ./download-toolchain-sources.sh

并重建 gcc，但不要忘记修改它。./build-gcc.s

您需要修改哪些文件，您可以在页面[http://michael.f1337.us/2011/11/19/rebuilding-the-android-ndk-for-objective-c-support/上找到](http://michael.f1337.us/2011/11/19/rebuilding-the-android-ndk-for-objective-c-support/)

# haskell - haskell GADTs 构造函数

> ID：10330047
> 
> 赞同：0
> 
> 时间：2012-04-26T08:47:50.070
> 
> 标签：haskell, gadt

我有以下

```
data Expr = Condition v
          | And Expr Expr
          | Or Expr Expr 
```

并且我被要求考虑以下无类型版本才能完成：

```
data Expr e where 
```

我不确定我应该为构造函数写什么。我尝试了以下方法：

```
data Expr e where
  Condition :: v -> Expr v
  And :: -- really not sure what to do with this one
  OR :: Expr b -> (Expr b -> Expr a) -> Maybe Expr a -> Expr b 
```

此外，由于`v`可以是任何类型，即`int`等`bool`，是否可以将其称为以下（上）并声明`v`稍后的类型？

```
data v = IntVat int 
```

任何帮助将非常感激 ：）

**编辑**：更改了整个帖子以添加更多信息和清晰度（基于我对练习的理解）。

基本上，我需要帮助找出`data Expr = Condition v...etc`作为参考的 GADT 的构造函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T17:27:03.540

如果我使用基本表达式语言作为激励示例在 GADT 上设置作业，那么我会想到这样的答案：

```
data Expr v where
    Literal :: v -> Expr v
    And     :: Expr Bool -> Expr Bool -> Expr Bool
    Or      :: Expr Bool -> Expr Bool -> Expr Bool
    -- and I'd probably add some things like this to
    -- show why the type variable is useful
    Equal   :: Expr Int -> Expr Int -> Expr Bool
    If      :: Expr Bool -> Expr v -> Expr v -> Expr v 
```

你可以看到为什么你可以称它为“类型化”表达式：类型变量的实例化看起来像是一种小语言的类型化规则：

```
a : Bool         b : Bool
-------------------------
    And a b : Bool

a : Int          b : Int
------------------------
    Equal a b : Bool 
```

等等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:33:12.957

对我来说，这听起来像是一种存在主义。我必须承认，我从来没有真正使用过它们，我只是试图理解它们；无论如何，也许它的意思是这样的：

```
data Expr = forall v. Condition v
          | And Expr Expr
          | Or Expr Expr 
```

然后你有一个像这样的 GADT（他们概括存在主义，见[这里](http://www.haskell.org/ghc/docs/7.4.1/html/users_guide/data-type-extensions.html)）：

```
data Expr where
    Condition :: v -> Expr
    And :: Expr -> Expr -> Expr
    Or :: Expr -> Expr -> Expr 
```

虽然，这不会（据我理解这个概念）有多大意义，因为你不能`v`用于任何事情。

另一方面，*这*会（我希望）更有意义（因为有一个“条件”）：

```
class Testable v where
    test :: v -> Bool

data Expr where
    Condition :: Testable v => v -> Expr
    And :: Expr -> Expr -> Expr
    Or :: Expr -> Expr -> Expr 
```

那么你可以做，例如

```
eval :: Expr -> Bool
eval (Condition v) = test v
eval (And e1 e2) = (eval e1) && (eval e2)
eval (Or e1 e2) = (eval e1) || (eval e2) 
```

这将适用于不同类型的“条件”。

不过，我没有测试这段代码，而且，正如我所说，我并不是真正的存在主义专业人士。我希望我的代码是正确的，但请告诉我任何人，如果你知道得更好（或者我完全错了......）

# sql - t-sql Tree Join to Values 以获取限制为最新数据的无子节点的总和

> ID：10330050
> 
> 赞同：3
> 
> 时间：2012-04-26T08:48:01.760
> 
> 标签：sql, sql-server, umbraco, common-table-expression

想要总结 SQL (MS 2008 r2) 2 个相对简单的表，我正在努力寻找一种让它工作的方法，几乎​​就在那里，但我真的很感谢 SQL 专家的帮助:)

我将一个树型表加入到一组值中，我们只检索该值的最新实例（对于每个外键 x2），并且每个值都有一个创建日期，我们只想要创建日期之前的最新值。最后，我们只想对位于树底部的那些（即没有孩子的）的值求和。我读过关于 CTE 的文章，并认为这是使它工作的好方法，但以前没有这样做过，所以仍然在努力阅读我所写的内容 :)

我有一个相对简单的树表，称为节点

```
[id] [int] IDENTITY(1,1) NOT NULL,
[parentID] [int] NOT NULL 
```

我感兴趣的这张表中的数据是这样的。（实际的简单示例可能有 1000-2000 条记录，最多可能有 7 层嵌套，通常只有 3 或 4 层）ID + ParentID 始终是唯一的。

```
ID      parentID
1077    1055
1110    1077
1103    1077
1104    1103
1105    1103
1111    1110
1112    1110 
```

然后是我想加入的另一个表分配。

```
[Id] [int] IDENTITY(1,1) NOT NULL,
[creation] [datetime] NULL,
[crewId] [int] NULL,
[mealId] [int] NULL,
[allocation] [int] NULL 
```

加入树的是 crampId，这是作为参数发送的，因此我们将检索 1077 的所有孩子的总和。我只想包括无子值的总和。我想为 mealId 的每个值求一个总和。crampId + mealId + creation 始终是唯一的。

```
Id          creation                crewId      mealId      allocation
----------- ----------------------- ----------- ----------- -----------
1           2012-04-13 16:50:00.000 1111        1085        1
2           2012-04-13 16:55:00.000 1111        1085        3
3           2012-04-13 17:03:31.100 1111        1085        2
4           2012-04-18 22:35:21.790 1112        1085        1
5           2012-04-18 22:35:32.630 1112        1086        1
6           2012-04-18 22:35:42.473 1112        1087        1
7           2012-04-25 18:15:53.117 1111        1086        1
8           2012-04-25 19:11:46.227 1111        1085        1
9           2012-04-25 19:11:46.227 1110        1085        5 
```

这是我目前所拥有的

```
declare  @crewId int
set @crewId = 1077

-- get total of allocated to childless children
;with 
Recurse as (
select 
  n.Id as DirectChildId
, n.Id
from umbracoNode n
where parentId = @crewId
union all
select
  b.DirectChildId
, n.Id
from umbracoNode n 
join Recurse b on b.Id = n.ParentId
)

select
  n.DirectChildId, mealId, sum(a.Allocation) as TotalAllocation
from Recurse n
left join Allocations a on n.Id = a.crewId
   and a.CrewId not in (select parentId from umbracoNode)
group by DirectChildId, mealId; 
```

这几乎可行，但尚未考虑获取最新值。

我目前检索最新版本的查询如下所示。但我不知道如何将它们结合起来。

```
SELECT a.mealId, a.allocation
FROM Allocations AS a
  LEFT OUTER JOIN Allocations AS a2
  ON (a2.crewId = @crewId and a.MealId = a2.MealId AND a2.creation < a2.creation)
WHERE a.crewId = @crewId and a2.crewId IS NULL; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T17:36:42.627

我得到了这个工作，这是我的答案：

```
ALTER PROCEDURE [dbo].[tegsGetTotalAllocated] 
(@crewId As Integer)
AS
BEGIN
-- SET NOCOUNT ON added to prevent extra result sets from
-- interfering with SELECT statements.
SET NOCOUNT ON;
;with q as (
SELECT n.id
FROM umbracoNode n
WHERE n.id = @crewId
UNION ALL
   SELECT n2.id
    FROM  umbracoNode n2
    JOIN q 
    ON n2.parentId = q.id
)

SELECT
  sum(a.allocation) as totalAllocated, a.mealId
FROM q
left join Allocation_Meal a on q.Id = a.crewId
   and a.CrewId not in (select parentId from umbracoNode)
where mealId is not null 
group by mealId
END 
```

主要技巧是创建一个执行最新部分的视图。我不太清楚这有什么影响。除了给我一种总是包含最新结果的虚拟表。这总是在每次点击时评估还是比这更聪明？

```
CREATE VIEW [dbo].[Allocation_Meal]
AS
SELECT t1.mealId, t1.allocation, t1.crewId
FROM tegsAllocation AS t1
      LEFT OUTER JOIN tegsAllocation AS t2
    ON (t2.crewId = t1.crewId and t1.MealId = t2.MealId AND t1.creation < t2.creation)
WHERE t2.crewId IS NULL; 
```

非常感谢任何关于它是否可以更有效的想法或评论:)尤其是我应该添加哪些索引以使其更好地工作，或者是识别这些的好方法:)

# php - 如何使用 cURL 登录此页面？PHP

> ID：10330052
> 
> 赞同：0
> 
> 时间：2012-04-26T08:48:09.937
> 
> 标签：php, cookies, curl

我需要登录，收集任何 cookie，然后继续到经过身份验证的下一页。

```
<form action="logon.asp"  method="post" name="FmDefault" id="CkIn">    
<table width="90%" border="0" cellpadding="0" cellspacing="0">
<tr>    
   <td colspan="2">
       <div align="right"><img src="images/some_image.gif" width="85" height="20">

         <input name="u_id" type="text" size="15" maxlength="10">

       </div>
   </td>
</tr>
<tr>
    <td colspan="2">
       <div align="right"><img src="images/some_other_image.gif" width="85" height="20">

        <input name="ps_word" type=password size="15" maxlength="10">

       </div>
     </td>
 </tr>
 <tr> 
    <td colspan="2">
       <div align="right">

         <input alt="Login" type="image" src="images/button_image.gif" width="57" height="25" border="0">
        </div>
     </td>
 </tr>
 <tr>
 <td><font color='#ff0000'>

<!---    
<b>ATTENTION: <br>    
</b></font><b><span class="style1"><a href="http://www.example.com/holiday2009.asp" target="_blank" style="color:#00FF00;">CLICK HERE FOR THE <br>    
EXAMPLE 2008 HOLIDAY SCHEDULE!</a></span></b>    
-->    
</td>    
</tr>
</table>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T08:52:53.430

```
 $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, 'http://example.com/logon.asp');
    curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_POSTFIELDS, 'u_id=YOUR_USERNAME&ps_word=YOUR_PASSWORD');
    curl_setopt($ch, CURLOPT_COOKIEJAR, 'cookie.txt');
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_TIMEOUT, 60);
    $store = curl_exec($ch); 
```

# android - 适用于 Android 的 Google Drive\Docs API

> ID：10330053
> 
> 赞同：28
> 
> 时间：2012-04-26T08:48:19.283
> 
> 标签：android, google-docs-api, google-drive-api

我在几个小时内将 Dropbox 与我的应用程序集成在一起，因为 SDK 被清楚地描述并且有很好的使用示例。

Google Drive 似乎只有一个“一刀切”的 Gdata SDK，它非常重（有许多依赖项，它使我的应用程序的大小增加了三倍）并且不是很直观，因为它的级别太低了。我敢肯定，当您知道如何使用它时，它非常有意义，但是由于我找不到任何真实的使用示例，因此我真的很挣扎。

是否有任何可用的示例应用程序可供我查看和学习？如果没有，如果有人有一个简单的上传和下载文件的例子来让我开始，那将不胜感激。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-26T09:16:38.327

**编辑：**由于我们推出了 Google Drive SDK v2，首选方式是使用 Drive API（而不是 Document List API）。有一个完全访问范围，可让您访问列出和读取所有驱动器文件，并且可以在 Android 应用程序中轻松使用，因为我们的[新客户端库](http://code.google.com/p/google-api-java-client)是 Android 友好的！我还建议观看[Google IO](http://www.youtube.com/watch?v=xRGyzqD-vRg&feature=plcp)的演讲，该演讲解释了如何将移动应用程序与 Drive 集成。

您还可以使用每个文件范围并[与 Drive Android App](https://developers.google.com/drive/integrate-android-ui) Intent 集成。

我们将提供完整的示例应用程序和开发指南，所以请保持原样。

* * *

这已经在[这个 SO post](https://stackoverflow.com/questions/10306456/android-api-for-google-drive)中得到了回答。

目前，Google Drive SDK 基本上是针对 Chrome Web Store Web 应用程序的。今天要在 Android 上使用 Google Drive，您必须使用 GData Document List API。

GData 客户端库较旧（Android 之前的世界:)）并且不能很好地与 Android 配合使用。正如 Alain 在另一篇文章中解释的那样，您可以选择仍然尝试使用 GData 客户端库或使用较新的[google-api-java-client](http://code.google.com/p/google-api-java-client)，但由于它没有文档列表 API 服务类，您必须手动实现它。

可能最简单和最轻量级的选择是直接使用 API 的基于 HTTP 的 REST 协议以及良好的 XML 解析器。该协议在[Google Document List API 的文档中进行了](https://developers.google.com/google-apps/documents-list)描述，只需在页面中有代码示例的任何地方找到读取“协议”的选项卡即可。

最后一个选项，您等到我们最终发布更好、更新、与 Android 配合得很好的东西 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T21:40:44.590

请注意，他们发布的使用 Google Drive (dredit) 的示例应用程序包括适用于 Android 的 jars：

/dredit/war/WEB-INF/lib/google-api-client-android2-1.8.0-beta-sources.jar

可能是一个红色的听力，但这似乎意味着示例应用程序的 Java 版本可以在 Android 上使用？

# scala - 将 Netty 中的 DynamicChannelBuffer 更改为 String 并返回 ChannelBuffer

> ID：10330058
> 
> 赞同：2
> 
> 时间：2012-04-26T08:48:41.783
> 
> 标签：scala, cordova, netty, finagle

我的 Web 服务器是使用 Twitter 的 Finagle 库用 Scala 编写的，而后者又依赖于 Netty。因此，请求内容作为 DynamicChannelBuffer 返回。如果我从终端使用 curl 将图像上传到服务器，如下所示：

```
 curl -T "abc.jpg" http://127.0.0.1:8080/test/image 
```

然后我可以读取图像，并使用如下所示的 SOAP 数据包将图像转发到后端网络服务器：

```
 <soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
        <soap:Header>
          <AuthHeader xmlns="http://www.testtesttest.co.za/">
            <LogonID>testtesttest</LogonID>
            <Password>testtesttest</Password>
          </AuthHeader>
        </soap:Header>
        <soap:Body>
          <uploadFile xmlns="http://www.testtesttest.co.za/">
            <FileDetails>
               <FileName>image.jpg</FileName>
              <FileContents>
                 {(Base64.encode(request.getContent())).toString(UTF_8)
              </FileContents>
            </FileDetails>
          </uploadFile>
        </soap:Body>
      </soap:Envelope> 
```

在上面的示例中，代码：`(Base64.encode(request.getContent())).toString(UTF_8)`将请求内容转换为 base 64 编码字符串。

问题是我需要从 PhoneGap 移动应用程序发送的 Multipart Http 请求中读取图像内容。PhoneGap 没有给我选项，只发送图像，并坚持将文件上传作为多部分请求。

为了将多部分请求分开，我使用 toString(UTF_8) 将 request.getContent() 结果更改为字符串，然后通过将 http 多部分消息拆分为单独的块来获取图像数据部分：

```
 var requestParts = request.content.toString(UTF_8).split("\\Q--*****org.apache.cordova.formBoundary\\E")
 val imageParts = requestParts(3).split("\\n\\s*\\n")
 val imageHeader = imageParts(0)
 val imageBody = imageParts(1) 
```

这很糟糕，我知道（我稍后会改进），但现在就可以了。imageBody 现在将图像内容作为字符串。

现在，如果我将 imageBody 放回 SOAP 数据包中，我必须使用以下命令再次对其进行编码：

```
 val encoder = new BASE64Encoder();
 val encodedImage = encoder.encode(imageBody) 
```

此时图像只是乱码。它的大小看起来不错，但我在字符串转换或编码方面搞砸了。对于第一个示例，我使用的是 Netty 的编码器，但对于第二个示例，我使用的是标准的 java 编码器。原因是 Netty 的编码器只能对 ChannelBuffer 类型的对象进行编码。

我不想说得太大声，但我已经为此苦苦挣扎了一天多。非常感谢这里的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T13:51:43.240

所以这有效：

```
image --> [curl] ------> post1 -->  [your code] --> soap msg 1 --> [back-end] 
```

这不会：

```
image --> [phonegap] --> post2 -->  [your code] --> soap msg 2 --> [back-end] 
```

要可靠地解决此类问题，您需要了解每个步骤中使用的编码。

假设您可以使用相同的图像，您能否检查 post1 和 post2 中的原始编码内容并推断正在使用哪种编码？然后，当您理解这一点时，在您解码和重新编码消息时将内容记录在*代码中。*这样你就可以确保它在*soap msg1*和*soap msg2*中是一样的。

# asp.net-mvc - Hmtl.DropDownList 仅使用 ViewBag 作为选定值

> ID：10330059
> 
> 赞同：1
> 
> 时间：2012-04-26T08:48:42.313
> 
> 标签：asp.net-mvc

我可以使用 ViewBag 中的项目创建一个下拉列表，但似乎没有办法选择当前项目。我没有使用模型来实现这一点，只是想使用 ViewBag，否则我必须创建另一个模型类来包装选择项和要显示的实际数据。

我的代码：

```
@Html.DropDownList("MyFilter", (IEnumerable<SelectListItem>)ViewBag.SelectItems, "Show All" ) 
```

没有参数来设置选择列表的值。我忽略了什么吗？如果我要使用 DropDownListFor<> 这只对模型有效吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T08:52:14.653

您可以尝试`MyFilter`在您的设置属性`ViewBag/ViewData`：

```
public ActionResult Index()
{
    ViewBag.SelectItems = new[]
    {
        new SelectListItem { Value = "1", Text = "item 1" },
        new SelectListItem { Value = "2", Text = "item 2" },
        new SelectListItem { Value = "3", Text = "item 3" },
    };

    // preselect the second item
    ViewBag.MyFilter = "2";

    return View();
} 
```

但我的建议是使用视图模型和强类型版本的助手：

```
public ActionResult Index()
{
    var model = new MyViewModel
    {
        SelectItems = new[]
        {
            new SelectListItem { Value = "1", Text = "item 1" },
            new SelectListItem { Value = "2", Text = "item 2" },
            new SelectListItem { Value = "3", Text = "item 3" },
        },
        // preselect the second item
        MyFilter = "2"
    };
    return View(model);
} 
```

在您的强类型视图中：

```
@model MyViewModel
...
@Html.DropDownListFor(x => x.MyFilter, Model.SelectItems, "Show all") 
```

# android - 手机充电时自定义 Android 电池图标

> ID：10330060
> 
> 赞同：0
> 
> 时间：2012-04-26T08:48:42.940
> 
> 标签：android, icons, android-animation

我想在手机充电时制作一个带有电池图标的应用程序。但我不知道从哪里开始。你能帮我一些想法吗？

稍后澄清：我实际上只想实现类似于电池充电时的动画。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T08:53:59.927

Afaik 这与您的 Launcher 及其主题有关。（如我错了请纠正我）

看

*   [Android：如何创建启动器](https://stackoverflow.com/questions/4603427/android-how-to-create-a-launcher)

*   [http://developer.android.com/resources/samples/Home/index.html](http://developer.android.com/resources/samples/Home/index.html)

*   [如何制作启动器](https://stackoverflow.com/questions/4841686/how-to-make-a-launcher)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:55:25.347

如果您想要一个动画图标，那么您可能应该创建一个[小部件](http://developer.android.com/reference/android/widget/package-summary.html)，您可以创建一个类似于图标但可以在电池充电时动画的小部件。

对于动画，您可以使用 Thomas K. 评论中发布的链接。

# python - 在 Python 中组合命令行和环境变量数据的方法

> ID：10330064
> 
> 赞同：0
> 
> 时间：2012-04-26T08:48:46.133
> 
> 标签：python, command-line, environment-variables, optparse

我正在编写一个通用函数来检查某些命令行选项的存在并返回一个包含它们的对象。到目前为止，使用`optparse`（我仅限于使用 Python 2.6.2），我得到了：

```
def getConfig( usage, needInputFile=False, needPhase=False ):
    parser = OptionParser( usage=usage )
    if ( needInputFile ):
        parser.add_option("-f", "--file", dest = "filename",
                          help = "Read report from FILE", metavar="FILE")
    if ( needPhase ):
        parser.add_option("-p", "--phase", dest = "phase",
                          help = "Processing phase")

    ( options, args ) = parser.parse_args()

    if ( needInputFile and options.filename == None ):
        parser.error("Filename must be provided.")

    if ( needPhase and options.phase == None ):
        parser.error("Phase must be provided.")

    return options 
```

这工作正常，但我现在想通过相同的机制提供程序名称和某些环境变量，以便它可用于将使用它的几个不同脚本。

我的直觉是将 optparse 选项复制到字典中并添加程序名称和额外的环境。在返回之前将 var info 放入字典中。

我很想知道人们对这种方法的看法。有没有更好/更被接受的方式？

# html - ExtJS - 将 Div 中的面板设置为 100%

> ID：10330066
> 
> 赞同：0
> 
> 时间：2012-04-26T08:48:56.480
> 
> 标签：html, extjs, width

有 1 个 Div 容器，我想在其中呈现我的完整应用程序。应用程序应填写整个 Div 宽度。

我尝试了以下两个 Div，但 Div-container 仍然不是 100%，甚至没有宽度，就像没有内容一样。怎么了？

```
<div id="stuff"></div> 
```

和

```
<div style="width: 100%;" id="stuff"></div> 
```

我的 ExtJS 应用程序：

```
 launch: function() {

                    var div = Ext.Element.get('stuff');

                    Ext.create('Ext.panel.Panel', {
                        renderTo: div,
                        width: "100%",
                        height: 500,
                        title: 'Container Panel',
                        layout: 'border',
                        items: [
                            {
                                xtype: 'panel',
                                title: 'Child Panel 1',
                                height: '80%',
                                width: '100%'
                            },
                            {
                                xtype: 'panel',
                                title: 'Child Panel 2',
                                html: 'textextetxtext',
                                height: '80%',
                                width: '100%'
                            }
                        ]
                    });
                } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T14:37:43.063

尝试将 div 设置为以像素为单位的固定宽度，而不仅仅是 100%。换句话说，如果我给了你100%的钱，你却一无所获，那是因为我没有钱。同样，您指定了 100% 的宽度，但是是什么？也许#stuff div 需要一个包含 div 来绘制其 100% 的宽度。

此外，两个子面板都有 100% 的宽度和 80% 的高度。每个尝试 50%。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T08:38:36.247

谢谢您的帮助。框架顶部还有几个额外的 Div。所以删除它们解决了它。

# sql - 从 Ms SQL Server 2008 中的三个字段创建 datetime2

> ID：10330067
> 
> 赞同：2
> 
> 时间：2012-04-26T08:48:59.360
> 
> 标签：sql, database, cursor, datetime2

我有一张包含超过 13,8k 行的巨大表格。它的布局类似于，

```
CREATE TABLE table1(
[id] [int] NOT NULL,
[regnr] [char](10) NULL,
[kilde] [char](100) NULL,
[dd] [char](10) NULL,
[mm] [char](10) NULL,
[yyyy] [char](16) NULL, 
```

)

清除日期部分的新表将具有这样的布局，以及其他不重要的字段。

```
create table table2(id int primary key identity not null, regnr nvarchar(10), kilde nvarchar(100), dato datetime2) 
```

然后我做了一个光标，在我执行它之前我关闭了

```
SET IDENTITY_INSERT navneregister on 
```

光标看起来像这样，但有趣的是我将三个字段解析为一个新的 datetime2。

```
declare @id int, @regnr nvarchar(10), @kilde nvarchar(100), @composeddate nvarchar(max), @dd char(10), @mm char(10), @yyyy char(16)
declare p cursor
for select id, regnr, kilde, dd, mm, yyyy from table2
open p
fetch p into @id, @regnr, @kilde, @dd, @mm, @yyyy
while @@FETCH_STATUS != -1
    begin
    begin
    if((@mm = '0' or @mm = '00') and (@dd = '0' or @dd = '00') and (@yyyy ='0000'))
        set @composeddate = null
    end
    if(@mm = '0' or @mm = '00')
        set @mm = '01'
    if(@dd = '0' or @dd = '00')
        set @dd = '01'

    begin
    if(@yyyy = '')
        set @composeddate = null
    else
        set @composeddate = CAST(CAST(@yyyy AS char(16)) + '-' + CAST(@mm AS char(10)) + '-' + CAST(@dd AS char(10)) AS DATETIME2)
    end
    begin
        insert into table1(id, regnr, kilde, dato) 
        values (@id, @regnr, @kilde, @composeddate)
    end
    fetch p into @id, @regnr, @kilde, @dd, @mm, @yyyy
    end
close p
deallocate p 
```

我部分工作，但有一些边缘情况会失败，例如，如果 dd = 00、mm = 00 和 yyyy = 0000。还有很多特殊情况，比如设置了年份，但设置了月份和日期，并且我的计划是将年份设置为 0000。此外，在某些情况下，所有三个字段都为空。还有能提供一些好的建议的人吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T10:11:08.027

你想达到什么目的？如果你有坏数据进来，你想出去什么数据？此外，没有“0000 年”，因为[没有 0 年](http://en.wikipedia.org/wiki/0_%28year%29)。这使您处于一个有趣的位置：如果您故意制造虚假日期，您打算如何处理它们？如果你有一个月和一天，你可以按月和天（有点）对数据进行分组，但是当有人想要找到最早或最新的记录时会发生什么？哎呀。真的不能那样做。

13,8K 行实际上非常小，所以我想知道您是否有日志或周围的任何东西可以让您重建丢失的数据？试图从坏数据中创建“好”数据几乎总是意味着有人会出现并假设你的数据是可靠的，而实际上它并不可靠。确定这些数据的用例，并尝试找出哪些不能处理不完整的数据并从那里着手。

此外，您是否可以选择消除包含错误数据的行？无论如何，假设日期很重要，您可能无能为力。

# java - 与另一个物体碰撞时旋转/旋转一个物体

> ID：10330073
> 
> 赞同：2
> 
> 时间：2012-04-26T08:49:30.647
> 
> 标签：java, android, box2d, andengine, game-physics

我正在实现一个由 AndEngine 和 box2d 驱动的物理游戏。
假设有一个物体从上方垂直落下。球与另一个物体碰撞，并改变它的方向

现在，碰撞后，球应该在空中旋转/旋转，对吧？

所以，我想知道我是否需要自己进行计算（以及如何？）使用 setAngularVelocity 函数
或 box2d 可以自动完成。

我希望我能正确表达自己感谢
sock.socket的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:02:37.397

不......你不需要做任何计算......当你像这样为你的身体创建物理连接器时......

```
 public PhysicsConnector(final IShape pShape, final Body pBody, final boolean pUdatePosition, final boolean pUpdateRotation) { 
```

如果您将 pUpdateRotation 设置为 true... 您可以看到您的身体在旋转...如果不想看到...请将其设置为 false...但这只会禁用屏幕上精灵的更新。它仍然保持身体在物理中..所以身体仍然会旋转..但旋转是不可见的......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-23T16:24:24.707

对于其他阅读本文的人，您的精灵可能不旋转的另一个原因是夹具/夹具的摩擦力设置为 0。（想想在冰上滑动）。

# git - git-diff：仅显示提交的更改

> ID：10330080
> 
> 赞同：36
> 
> 时间：2012-04-26T08:49:54.320
> 
> 标签：git, git-diff

我想查看已添加到提交 ( `git add something`) 的文件的差异。我可以做这个：

```
git diff HEAD `git status -s | grep ^M | cut -c 4-` 
```

有没有更短的方法？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-04-26T08:50:36.830

您可以使用`git diff --staged`（或`git diff --cached`）查看提交时将使用的差异。

从手册页：

> `git diff [--options] --cached [<commit>] [--] [<path>...]`
> 此表单用于查看您为下一次提交相对于命名的`<commit>`. 通常，您希望与最新提交进行比较，因此如果您不提供`<commit>`，则默认为`HEAD`. 如果`HEAD`不存在（例如未出生的分支）并且`<commit>`未给出，则显示所有阶段性更改。`--staged`是的同义词`--cached`。

# sql-server - 如何在 SQLServer 中将表从一个数据库移动到另一个数据库

> ID：10330081
> 
> 赞同：0
> 
> 时间：2012-04-26T08:49:54.820
> 
> 标签：sql-server

先生，我需要将 database1 中存在的表移动到同一个 Sqlserver 中的 database2。请你告诉我我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T08:53:28.187

1-您可以在右键单击数据库后使用 Import/Export Util 传输表，传输成功后从旧数据库中删除。

2- 生成用于创建表的 SQL 脚本，然后使用 select into from 子句。

# javascript - 根据单击的内容更改输入值

> ID：10330086
> 
> 赞同：-1
> 
> 时间：2012-04-26T08:50:06.090
> 
> 标签：javascript, javascript-events

 所以我想要做的是根据用户单击的内容更改输入字段的值。

我查看了这个网站，我只找到了 JQuery 版本，但我要求它在 Vanilla JS 中，而不是使用库。

链接在这里; 

[http://jsbin.com/avumel/edit#javascript,html](http://jsbin.com/avumel/edit#javascript,html)

本

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T08:59:51.913

如果你想这样做，你需要遍历 childNodes：http: [//jsbin.com/avumel/4/edit#source](http://jsbin.com/avumel/4/edit#source)

但最好将事件处理程序附加到#comments，然后听孩子：http: [//jsbin.com/avumel/8/edit](http://jsbin.com/avumel/8/edit)

# tsql - MS SQL 浮点十进制比较问题

> ID：10330087
> 
> 赞同：4
> 
> 时间：2012-04-26T08:50:12.417
> 
> 标签：tsql, comparison, decimal

我正在对数据库进行规范化，其中一部分涉及将一个表中的列从 a 转换`FLOAT`为 a `DECIMAL(28,18)`。然后，当我尝试将此转换后的列连接回源列时，在某些情况下它不会返回任何结果。

这似乎与它的转换方式有关。例如， `FLOAT`转换为 a`DECIMAL(28,18)`会产生：

```
51.051643260000006000 
```

原文`FLOAT`是

```
51.05164326 
```

我尝试了各种修改 的方法`FLOAT`，但这些都不起作用：

```
CAST(51.05164326 AS DECIMAL(28,18)) = 51.051643260000000000
STR(51.05164326 , 28,18) = 51.0516432599999990 
```

转换的原因是由于提高了这些字段的准确性。

有没有人有一个一致的策略来转换这些数字，并能够确保后续的加入工作？

提前致谢

厘米

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T09:15:47.667

对于您的应用程序，您需要考虑需要多少个小数位。看起来实际上您需要大约 8-14 位小数而不是 18。

进行转换的一种方法是`cast(cast(floatColumn as decimal(28,14)) as decimal(28,18))`.

要在小数列和浮点列之间进行连接，您可以执行以下操作：

```
ON cast(cast(floatColumn as decimal(28,14)) as decimal(28,18)) = decimalColumn 
```

如果双重转换与用于创建 的双重转换**相同**`decimalColumn`，这将允许您使用`decimalColumn`.

或者，您可以使用范围连接：

```
ON floatColumn > decimalColumn - @epsilon  AND floatColumn < decimalColumn + @epsilon 
```

这仍应使用`decimalColumn`.

但是，加入小数是不寻常的。除非您确实*需要*加入它们或需要进行直接相等比较（而不是范围比较），否则最好按您的原样进行转换，并记录准确性损失很小的事实由于最初选择了不合适的数据类型。

有关更多信息，请参阅：

*   [使用 == 运算符比较两个舍入浮点数是否正确？](https://stackoverflow.com/questions/236439/is-it-correct-to-compare-two-rounded-floating-point-numbers-using-the-operato)

*   [处理浮点数的精度问题](https://stackoverflow.com/questions/590822/dealing-with-accuracy-problems-in-floating-point-numbers)

# spring - 我是否必须使用 jetty 嵌入式服务器来测试我在 Spring 项目中的活动 mq 结构？

> ID：10330090
> 
> 赞同：0
> 
> 时间：2012-04-26T08:50:26.010
> 
> 标签：spring, unit-testing, junit, activemq

我是否必须使用 jetty 嵌入式服务器来测试我在 Spring 项目中的活动 mq 结构？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T08:58:59.927

请参阅 ActiveMQ 的以下链接：

*   [如何对 JMS 代码进行单元测试](http://activemq.apache.org/how-to-unit-test-jms-code.html)
*   [集成测试 > 示例测试场景](http://activemq.apache.org/example-testing-scenario.html)
*   [使用 JMS (ActiveMQ) 进行单元测试](https://stackoverflow.com/questions/2870431/unit-testing-with-jms-activemq)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T09:40:10.670

首先，为您的侦听器容器 bean 添加上下文，如下所示：

```
<bean id="sampleListenerContainer" class="org.springframework.jms.listener.DefaultMessageListenerContainer">
    <property name="concurrency" value="20-100"/>
    <property name="connectionFactory" ref="connectionFactory"/>
    <property name="destination" ref="sampleDestination"/>
    <property name="messageListener" ref="sampleListenerConsumer"/>
</bean> 
```

第二，

```
DefaultMessageListenerContainer container = BeanProvider.getBeanFactory().getBean("sampleListenerContainer", DefaultMessageListenerContainer.class);
container.start(); 
```

相似地，

```
container.stop(); 
```

# c++ - GUID 的唯一性

> ID：10330091
> 
> 赞同：2
> 
> 时间：2012-04-26T08:50:26.277
> 
> 标签：c++, windows, coding-style, registry, guid

GUID 是 MSFT 生成的 128 位唯一标识符。

我怀疑 GUID 是否是全球唯一的。我的意思是我生成的 GUID，在任何系统中使用任何应用程序的整个世界中没有其他人可以生成？真的吗？

我很惊讶微软将如何知道或跟踪这种独特性。

并且生成的唯一 GUID 也可以链接到任何实体？应用、变量、系统、?

GUOD 可以链接到哪些实体？任何人都可以澄清 GUID 的概念吗？它是否独立于编程语言。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T08:56:14.807

您可能会对这两篇文章感兴趣，并且应该可以帮助您理解这些 ID 背后的概念。

*   [通用唯一标识符](http://en.wikipedia.org/wiki/Universally_Unique_Identifier)(UUID)
*   [全局唯一标识符](http://en.wikipedia.org/wiki/Globally_unique_identifier)(GUID)

* * *

> UUID 的目的是使分布式系统能够唯一地识别信息，而无需大量的中央协调。[...] 独特一词应理解为“实际上独特”而不是“保证独特”。[...] 两个不同的项目可以共享相同的标识符。
> 
> 需要选择标识符大小和生成过程，以使这在实践中足够不可能。
> 
> 任何人都可以创建一个 UUID 并使用它来识别某些东西，并且有理由相信任何人都不会无意中创建相同的标识符来识别其他东西。因此，标有 UUID 的信息可以在以后组合到单个数据库中，而无需解决标识符 (ID) 冲突。

非常简单：它基本上是一种创建标识符（具有特定格式）的方法，该标识符具有很高的唯一性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T08:55:43.917

它基本上是一种各种信息位的哈希值，它们的总组合极有可能是唯一的或极其罕见的。与任何哈希一样，冲突是可能的，它们实际发生的机会非常低，可以忽略不计。

散列函数利用保证或预期是唯一的各种信息（例如，它可以使用 MAC 地址），或者另一种选择是随机生成数字（使用 128 位，随机生成完全相同的数字的机会是......好吧，你可以计算，相当低:-))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T08:59:31.160

您可能想阅读对非常相似的问题给出的答案[GUID 是否 100% 的时间都是唯一的？](https://stackoverflow.com/questions/39771/is-a-guid-unique-100-of-the-time)其中包括来自 Wikipedia 的以下引用：

> 虽然不能保证每个生成的 GUID 都是唯一的，但唯一键的总数（2^128 或 3.4×10^38）是如此之大，以至于生成两次相同数字的概率非常小。例如，考虑可观测宇宙，它包含大约 5×10^22 颗恒星；然后，每颗星都可以有 6.8×10^15 个普遍唯一的 GUID。

*请参阅lx*给出的答案中的链接

 *然后，按照 Raymond Chen 的博客文章[GUID 是全球唯一的，但 GUID 的子字符串不是](http://blogs.msdn.com/b/oldnewthing/archive/2008/06/27/8659071.aspx)更多详细信息。

在另一个 SO 问题之后进行了有趣的讨论[简单证明 GUID 不是唯一的](https://stackoverflow.com/questions/1705008/simple-proof-that-guid-is-not-unique)，也值得检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T09:00:05.610

可以生成全局唯一标识符。例如，MAC 地址（唯一）+ 当前时间。当然，GUID 生成器使用更复杂的算法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T09:30:30.780

我可以想到一个简单的反例，它证明 GUID 即使在单个系统上也不是唯一的，更不用说全局了：

```
for i = 0 : 2^128
   generateGUID(); 
```

确实生成`2^128`GUID 是不可行的，但这表明唯一性在数学上是不可能的。

不过，您绝对不太可能遇到两个相同的 GUID。*

# ios - 在 iOS 上显示基于 Unicode 的五位埃及象形文字字体的代码是什么？

> ID：10330092
> 
> 赞同：7
> 
> 时间：2012-04-26T08:50:30.000
> 
> 标签：ios, unicode, truetype, astral-plane

StackOverflow 和其他网站上的代码建议在 iOS[上显示 unicode ：](https://stackoverflow.com/questions/7827962/how-to-locate-and-display-a-unicode-character-in-ios)

```
[view1 setText:@"\uF300"]; 
```

这适用于大多数 unicode 字符，但是，对于[埃及象形文字 unicode 字体](http://www.ancientwords.net/full.html)（等待加载大字体）失败。

象形文字 unicode 有一个额外的数字（即“\uF3001”而不是“\uF300”）。结果，显示了错误的字符，并且“1”留在了尾随。

很明显iOS可以显示象形文字字体。例如，如果将此字形 () 剪切并粘贴到 setText 语句中，则在导入 TTF 后，可以在 iOS 屏幕上看到该字形。

所以问题是，如何使用需要五位而不是四位的 unicode 字体在 setText 语句中显示 unicode 字符（即“\uF3001”）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-27T02:14:21.720

实际上，只要您使用大写字母“U”，您最多可以指定 8 位数字，例如：“ **\U000F3001** ”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:00:08.523

通过您使用的方法是不可能的：

[https://developer.apple.com/library/ios/#documentation/MacOSX/Conceptual/BPInternational/Articles/NotesForLocalizers.html](https://developer.apple.com/library/ios/#documentation/MacOSX/Conceptual/BPInternational/Articles/NotesForLocalizers.html)

> 字符串可以包含任意 Unicode 字符，“\U”**后跟最多四个**表示 Unicode 字符的十六进制数字；例如，十六进制 20 的空格表示为“\U0020”。如果字符串必须包含由于某种原因无法键入的 Unicode 字符，则此选项很有用。

# java - 将java战争部署到heroku，pom.xml错误

> ID：10330095
> 
> 赞同：2
> 
> 时间：2012-04-26T08:50:45.497
> 
> 标签：java, maven, deployment, heroku, maven-plugin

我想将java war部署到heroku ..我在我的pom.xml中提到了下面的依赖项

```
 <build>
            <plugins>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-dependency-plugin</artifactId>
                    <version>2.4</version>
                    <executions>
                        <execution>
                            <id>copy-dependencies</id>
                            <phase>package</phase>
                            <goals><goal>copy-dependencies</goal></goals>
                        </execution>
                    </executions>
                </plugin>
            </plugins>
<plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>appassembler-maven-plugin</artifactId>
            <version>1.1.1</version>
            <configuration>
                <assembleDirectory>target</assembleDirectory>
                <programs>
                    <program>
                        <mainClass>com.cim.Server.TomcatServer</mainClass>
                        <name>webapp</name>
                    </program>
                </programs>
            </configuration>
            <executions>
                <execution>
                    <phase>package</phase>
                    <goals>
                        <goal>assemble</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>       
        </build> 
```

我跑了

```
mvn package 
```

我跑了

```
D:\HUV\sri>java -cp target/classes:target/dependency/* com.cim.Server.TomcatServer 
```

但是即使我在上面的路径中有课程，我也遇到了错误。**在哪里做错了？请帮忙**

```
Exception in thread "main" java.lang.NoClassDefFoundError: com/cim/Server/Tomca
Server
Caused by: java.lang.ClassNotFoundException: com.cim.Server.TomcatServer
        at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
Could not find the main class: com.cim.Server.TomcatServer.  Program will exit. 
```

**webapp.bat**

```
@REM ----------------------------------------------------------------------------
@REM Copyright 2001-2004 The Apache Software Foundation.
@REM
@REM Licensed under the Apache License, Version 2.0 (the "License");
@REM you may not use this file except in compliance with the License.
@REM You may obtain a copy of the License at
@REM
@REM      http://www.apache.org/licenses/LICENSE-2.0
@REM
@REM Unless required by applicable law or agreed to in writing, software
@REM distributed under the License is distributed on an "AS IS" BASIS,
@REM WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
@REM See the License for the specific language governing permissions and
@REM limitations under the License.
@REM ----------------------------------------------------------------------------
@REM

@echo off

set ERROR_CODE=0

:init
@REM Decide how to startup depending on the version of windows

@REM -- Win98ME
if NOT "%OS%"=="Windows_NT" goto Win9xArg

@REM set local scope for the variables with windows NT shell
if "%OS%"=="Windows_NT" @setlocal

@REM -- 4NT shell
if "%eval[2+2]" == "4" goto 4NTArgs

@REM -- Regular WinNT shell
set CMD_LINE_ARGS=%*
goto WinNTGetScriptDir

@REM The 4NT Shell from jp software
:4NTArgs
set CMD_LINE_ARGS=%$
goto WinNTGetScriptDir

:Win9xArg
@REM Slurp the command line arguments.  This loop allows for an unlimited number
@REM of arguments (up to the command line limit, anyway).
set CMD_LINE_ARGS=
:Win9xApp
if %1a==a goto Win9xGetScriptDir
set CMD_LINE_ARGS=%CMD_LINE_ARGS% %1
shift
goto Win9xApp

:Win9xGetScriptDir
set SAVEDIR=%CD%
%0\
cd %0\..\.. 
set BASEDIR=%CD%
cd %SAVEDIR%
set SAVE_DIR=
goto repoSetup

:WinNTGetScriptDir
set BASEDIR=%~dp0\..

:repoSetup

if "%JAVACMD%"=="" set JAVACMD=java

if "%REPO%"=="" set REPO=%BASEDIR%\repo

set CLASSPATH="%BASEDIR%"\etc;"%REPO%"\org\apache\tomcat\embed\tomcat-embed-core\7.0.27\tomcat-embed-core-7.0.27.jar;"%REPO%"\org\apache\tomcat\embed\tomcat-embed-logging-juli\7.0.27\tomcat-embed-logging-juli-7.0.27.jar;"%REPO%"\org\apache\tomcat\embed\tomcat-embed-jasper\7.0.27\tomcat-embed-jasper-7.0.27.jar;"%REPO%"\org\apache\tomcat\tomcat-jasper\7.0.27\tomcat-jasper-7.0.27.jar;"%REPO%"\org\apache\tomcat\tomcat-servlet-api\7.0.27\tomcat-servlet-api-7.0.27.jar;"%REPO%"\org\apache\tomcat\tomcat-juli\7.0.27\tomcat-juli-7.0.27.jar;"%REPO%"\org\apache\tomcat\tomcat-el-api\7.0.27\tomcat-el-api-7.0.27.jar;"%REPO%"\org\eclipse\jdt\core\compiler\ecj\3.7\ecj-3.7.jar;"%REPO%"\org\apache\tomcat\tomcat-api\7.0.27\tomcat-api-7.0.27.jar;"%REPO%"\org\apache\tomcat\tomcat-util\7.0.27\tomcat-util-7.0.27.jar;"%REPO%"\org\apache\tomcat\tomcat-jasper-el\7.0.27\tomcat-jasper-el-7.0.27.jar;"%REPO%"\org\apache\tomcat\tomcat-jsp-api\7.0.27\tomcat-jsp-api-7.0.27.jar;"%REPO%"\org\springframework\spring-context\3.0.6.RELEASE\spring-context-3.0.6.RELEASE.jar;"%REPO%"\org\springframework\spring-aop\3.0.6.RELEASE\spring-aop-3.0.6.RELEASE.jar;"%REPO%"\aopalliance\aopalliance\1.0\aopalliance-1.0.jar;"%REPO%"\org\springframework\spring-beans\3.0.6.RELEASE\spring-beans-3.0.6.RELEASE.jar;"%REPO%"\org\springframework\spring-core\3.0.6.RELEASE\spring-core-3.0.6.RELEASE.jar;"%REPO%"\org\springframework\spring-expression\3.0.6.RELEASE\spring-expression-3.0.6.RELEASE.jar;"%REPO%"\org\springframework\spring-asm\3.0.6.RELEASE\spring-asm-3.0.6.RELEASE.jar;"%REPO%"\org\springframework\spring-webmvc\3.0.6.RELEASE\spring-webmvc-3.0.6.RELEASE.jar;"%REPO%"\org\springframework\spring-context-support\3.0.6.RELEASE\spring-context-support-3.0.6.RELEASE.jar;"%REPO%"\org\springframework\spring-web\3.0.6.RELEASE\spring-web-3.0.6.RELEASE.jar;"%REPO%"\org\aspectj\aspectjrt\1.6.9\aspectjrt-1.6.9.jar;"%REPO%"\org\slf4j\slf4j-api\1.5.10\slf4j-api-1.5.10.jar;"%REPO%"\org\slf4j\jcl-over-slf4j\1.5.10\jcl-over-slf4j-1.5.10.jar;"%REPO%"\org\slf4j\slf4j-log4j12\1.5.10\slf4j-log4j12-1.5.10.jar;"%REPO%"\log4j\log4j\1.2.15\log4j-1.2.15.jar;"%REPO%"\javax\inject\javax.inject\1\javax.inject-1.jar;"%REPO%"\javax\servlet\jstl\1.2\jstl-1.2.jar;"%REPO%"\com\cim\controllers\1.0.0-BUILD-SNAPSHOT\controllers-1.0.0-BUILD-SNAPSHOT.war
set EXTRA_JVM_ARGUMENTS=
goto endInit

@REM Reaching here means variables are defined and arguments have been captured
:endInit

%JAVACMD% %JAVA_OPTS% %EXTRA_JVM_ARGUMENTS% -classpath %CLASSPATH_PREFIX%;%CLASSPATH% -Dapp.name="webapp" -Dapp.repo="%REPO%" -Dbasedir="%BASEDIR%" com.cim.Server.TomcatServer %CMD_LINE_ARGS%
if ERRORLEVEL 1 goto error
goto end

:error
if "%OS%"=="Windows_NT" @endlocal
set ERROR_CODE=1

:end
@REM set local scope for the variables with windows NT shell
if "%OS%"=="Windows_NT" goto endNT

@REM For old DOS remove the set variables from ENV - we assume they were not set
@REM before we started - at least we don't leave any baggage around
set CMD_LINE_ARGS=
goto postExec

:endNT
@endlocal

:postExec

if "%FORCE_EXIT_ON_ERROR%" == "on" (
  if %ERROR_CODE% NEQ 0 exit %ERROR_CODE%
)

exit /B %ERROR_CODE% 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T21:50:17.637

我也有类似的问题。

在敲了 2 天之后，我深入研究了我的`pom`. 它与节无关`<build>`。

我的问题是 pom.xml 中的元数据有一个额外的`<packaging>war</packaging>`标签。

我将元数据修改为

```
 <modelVersion>4.0.0</modelVersion>
        <groupId>com.my.apps</groupId>
        <artifactId>DummyHerokuApp</artifactId>
        <version>0.0.1-SNAPSHOT</version>
        <name>Dummy name</name>
        <description>Dummy war</description>
        <url>http://maven.apache.org</url> 
```

一切都运行顺利。

我希望这对你们有帮助。

如果您再次遇到此问题，请尝试`pom.xml`根据 heroku devcenter 上提供的内容重建您的内容，然后添加依赖项或增量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-21T19:55:47.313

我建议使用[jcabi-heroku-maven-plugin](http://www.jcabi.com/jcabi-heroku-maven-plugin/index.html)，它会自动为您完成所有这些工作。您需要做的就是配置您要运行的工件以及如何在那里运行它：

```
 <plugin>
    <groupId>com.jcabi</groupId>
    <artifactId>jcabi-heroku-maven-plugin</artifactId>
    <version>0.4.1</version>
    <configuration>
      <name>my-test-app</name>
      <artifacts>
        <artifact>com.example:example-app:jar::${project.version}</artifact>
      </artifacts>
      <procfile>web: java -Xmx256m -jar ./example-app.jar \${PORT}</procfile>
    </configuration>
    <executions>
      <execution>
        <goals>
          <goal>deploy</goal>
        </goals>
      </execution>
    </executions>
  </plugin> 
```

这就是您需要在`pom.xml`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T09:34:24.393

根据`pom.xml`您使用的文件，`appasssembler-maven-plugin`该文件会生成用于运行 java 应用程序的脚本。尝试使用它。[示例](http://mojo.codehaus.org/appassembler/appassembler-maven-plugin/usage-program.html)
类似：

```
Compile: 
mvn package appassembler:assemble

Run:
target/appassembler/bin/app.bat 
```

# java - 使用 @Before 和 xml 文件在 Hibernate 和 MySQL 中设置默认日期

> ID：10330098
> 
> 赞同：0
> 
> 时间：2012-04-26T08:50:50.000
> 
> 标签：java, spring, hibernate, junit

我正在尝试使用 Hibernate + Spring 构建一个表并使用 JUnit 对其进行测试。

这是我的班级模型：

```
@Id
@ManyToOne(fetch = FetchType.LAZY, cascade = CascadeType.ALL)
@JoinColumn(name = "user_name")
private User user;

@Id
@Column(name = "date_exam")
private Date dateExam;

@Column
private Float percent; 
```

当我尝试使用 JUnit 对其进行测试时：

```
@Test
public void testGetAll() {
    List<Score> scores = service.getScores();
    assertEquals(1, scores.size());
} 
```

它显示了这个错误（实际上我尝试了所有测试，如保存、更新、删除、获取记录并发生相同的错误）：

```
java.sql.SQLException: Field 'dateExam' doesn't have a default value
at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1073)
at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3593)
at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3525)
at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1986)
at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2140)
at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2626)
at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2111)
at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1362)
at org.dbunit.database.statement.SimplePreparedStatement.addBatch(SimplePreparedStatement.java:80)
at org.dbunit.database.statement.AutomaticPreparedBatchStatement.addBatch(AutomaticPreparedBatchStatement.java:70)
at org.dbunit.operation.AbstractBatchOperation.execute(AbstractBatchOperation.java:195)
at org.dbunit.operation.CompositeOperation.execute(CompositeOperation.java:79)
at test.backend.config.dao.ScoreDaoTest.resetDatabase(ScoreDaoTest.java:45)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
at java.lang.reflect.Method.invoke(Method.java:601)
at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)
at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:74)
at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:82)
at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:72)
at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:240)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)
at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)
at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:180)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197) 
```

我认为`private Date dateExam;`我混淆的问题是`dateExam`我设置默认值的列，`NULL`但它为什么这么说`SQLErrorException`。在此之前，我已经构建了另外 4 个表，但没有`Date`作为列类型并且没有错误。我尝试将其更改为，`private java.sql.Timestamp dateExam`但仍然出现错误。

任何人都可以给我解决这个问题？我非常感谢您的帮助。谢谢...

**更新**

我尝试删除`@Id`并设置`nullable = true`但仍然相同......

**更新 30/04**

我遇到了问题，当 JUnit 测试时，我尝试从 xml 文件加载第一个数据：

```
@Before
public void resetDatabase() throws Exception {
    IDataSet dataSet = new FlatXmlDataSetBuilder().build(new File(
            "fixtures/score.xml"));
    final Connection conn = dtSource.getConnection();
    DatabaseOperation.CLEAN_INSERT.execute(new DatabaseConnection(conn),
            dataSet);
} 
```

还有 score.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<dataset>
<user 
    user_name="crazenezz" 
    first_name="craze" 
/>
<score 
    user_name="crazenezz" 
    date_exam="2012-04-30" 
    percent="100" 
/>
</dataset> 
```

现在的问题是，**如果我们在 xml 文件中初始化值，****这里使用****的日期的真正格式是什么`date_exam``java.util.Date`**？因为我之前尝试在模型中设置默认值`private Date dateExam = new Date()`仍然出现错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:20:32.200

Use `@Temporal(TemporalType.TIME)` Hibernate annotation`(TemporalType TIME/DATE/TIMESTAMP)`, initialize the date.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T11:42:31.497

删除日期的 id 注释（你不能有两个字段的 id 值），初始化你可以这样做，它给出一个初始日期值。

```
@Column(name = "date_exam")
private Date dateExam = new Date(); 
```

但我建议使用[joda-time](https://stackoverflow.com/a/8989253/106261)

# objective-c - IBOutlets 应该是 ivars 还是属性？

> ID：10330103
> 
> 赞同：7
> 
> 时间：2012-04-26T08:51:00.873
> 
> 标签：objective-c, ios, properties, iboutlet, ivar

虽然我确定它们存在，但我很难找到或确定在 ViewController 中声明插座的官方最佳实践。

据我所知，有3个选项：

1.  仅限伊瓦尔
2.  仅财产
3.  以 ivar 为后盾的属性

当我尝试通过从 IB 拖入 ViewController 来自动生成属性时，Xcode 当前崩溃，但据我记得，这样做会创建一个没有 ivar 的属性。也可以拖入 ivar 部分，这将创建一个没有属性的 ivar。这表明仅限财产的网点和仅限 ivar 的网点都适用于苹果。

因此，在 viewDidUnload 中，我们需要将 nil 分配给我们的任何出口，但 dealloc 呢？如果我们使用了没有 ivar 的属性，如果我们不应该在 init 或 dealloc 中使用任何访问器，我们如何释放我们的出口？

在我看来，唯一允许我们在没有访问器的情况下释放出口的模式是使用由 ivar 支持的属性，因此我们可以在 dealloc 中手动释放 ivar 而不使用其访问器，但这是 Apple 的一个选项代码生成不支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:42:18.973

根据经验，我通常为`IBOutlet`s 创建访问器。

在 ARC 或非 ARC 项目中，我通常会执行以下操作：

```
//.h (ARC)
@property (nonatomic, weak) IBOutlet UILabel* myLabel;

//.h (non-ARC)
@property (nonatomic, retain) IBOutlet UILabel* myLabel;

//.m
@synthesize myLabel; 
```

通过这种方式，您可以让编译器为您创建实例变量。但是你也可以声明你的实例变量并告诉编译器使用它。

然后，您可以在任何地方使用该访问器/实例变量。

[Apple 内存管理指南](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmPractical.html)说，当您有非 ARC 项目时，您必须避免使用访问器方法或方法`init`。`dealloc`因此，例如：

```
// (non-ARC)
- (void)dealloc
{
   [myLabel release]; myLabel = nil; // I'm using the instance variable here!
   [super dealloc];       
} 
```

这在非 ARC 项目中非常重要。原因是，如果没有访问器，KVC 会将 nib 对象分配给实例变量并对其进行保留。如果您忘记释放它，您可能会发生内存泄漏。使用访问器会强制您在最后释放该对象。

我强烈建议阅读Mike Ash[的 friday-qa-2012-04-13-nib-memory-management](http://www.mikeash.com/pyblog/friday-qa-2012-04-13-nib-memory-management.html)。这是一篇关于 nib 和内存管理的非常酷的文章。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-22T18:02:27.720

这是我的理解

对将被其他类访问的变量使用属性，可以从（getter）读取或写入（setter）。setter 和 getter 都是为属性合成的。

将 ivars 用于仅由所属类在内部使用的变量，也就是说，其他类不会设置或获取它们的值。

当然，您可以使用属性代替 ivars，但无论何时访问它们都会产生函数调用开销。所以如果你有一个被你的类访问的内部变量很多，函数调用会影响实时性能，这可以通过将它们声明为 ivars 来避免。

# java - 在 servlet 中启动一个新线程

> ID：10330104
> 
> 赞同：5
> 
> 时间：2012-04-26T08:51:03.040
> 
> 标签：java, multithreading, servlets, web

当请求到达处理文件上传的 servlet 时，在该 servlet 中启动一个新线程是否是个好主意，该线程`new Thread(r).start()`将处理上传文件附带的另一条数据。我想以此来同时处理这两项工作。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-04-26T08:56:44.583

这不仅是一个坏主意，而且也行不通。原因如下：您的文件上传请求最终会命中`doPost()`方法。只要您使用此方法，容器就会保持连接打开。一旦您从该方法返回（并且如果您决定在单独的线程中处理传入数据，`doPost()`将提前完成），容器会假定您已完成请求并将关闭连接。从客户端的角度来看，上传被服务器中断了。而且由于线程的异步特性，中断将随机发生。

相信我，一些用户已经体验过：[HttpServletResponse 似乎会定期发送过早](https://stackoverflow.com/questions/9316904)。

此外，每个请求都启动新线程是个坏主意，因为它的扩展性很差（某些规范甚至禁止它）。您**可以**做的是使用 Servlet 3.0 异步请求并异步处理上传，但最好使用一些线程池。另请参阅：[为什么使用 startAsync 创建新线程而不是在 servlet 线程中工作？](https://stackoverflow.com/questions/10066199).

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-04-26T08:56:05.423

Servlet 由 webserver 在新线程中隐式运行，因此每当任何请求命中 servlet 时，它将在不同的线程中执行。我没有预见到自己创建新线程的理由

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2012-04-26T08:53:25.713

在 Servlet 中启动新线程没有任何问题（与 EJB 不同），所以是的，没关系。

编辑：第二个想法@Tomasz Nurkiewicz 是对的。文件上传将停止。

# c# - 找不到文件“Microsoft.Windows.Common-Controls，版本=6.0.0.0，文化=*，PublicKeyToken=6595b64144ccf1df，

> ID：10330105
> 
> 赞同：9
> 
> 时间：2012-04-26T08:51:10.590
> 
> 标签：c#, wpf, manifest, common-controls

我正在尝试[将此库](http://www.codeproject.com/Articles/21276/Vista-TaskDialog-Wrapper-and-Emulator)集成到我的应用程序中。

起初它崩溃了

```
Unable to find an entry point named 'TaskDialogIndirect' in DLL 'ComCtl32'. 
```

所以我没有评论

```
<dependentAssembly>
  <assemblyIdentity
      type="win32"
      name="Microsoft.Windows.Common-Controls"
      version="6.0.0.0"
      processorArchitecture="*"
      publicKeyToken="6595b64144ccf1df"
      language="*"
    />
</dependentAssembly> 
```

正如[这里](https://stackoverflow.com/questions/719251/unable-to-find-an-entry-point-named-taskdialogindirect-in-dll-comctl32)推荐的那样。

现在应用程序不会编译并显示以下消息：

```
Could not find file 'Microsoft.Windows.Common-Controls, Version=6.0.0.0, Culture=*, 
    PublicKeyToken=6595b64144ccf1df, ProcessorArchitecture=*, Type=win32' 
```

删除 app.manifest 会导致应用崩溃，因为我使用的是 Microsoft 功能区。

如何修复此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T12:17:18.480

Windows 7 不支持您尝试的文件。这意味着您必须提供它，如果您尝试开发适用于 Windows XP 的应用程序，最简单的解决方案是放弃对 Windows XP 的支持。

> Microsoft Visual Basic 6.0 的主流支持已于 2005 年 3 月 31 日结束。但是，我们发布了这个与安全无关的包，因为它包含在主流支持结束之前准备好发布的改进。Microsoft Visual Basic 6.0 已过渡到扩展支持，该支持将持续到 2008 年 3 月 31 日。Microsoft 不会以任何方式扩展 Microsoft Visual Basic 6.0 的主流支持阶段。

**来源：** [Microsoft Visual Basic 6.0 通用控件](http://www.microsoft.com/download/en/details.aspx?id=10019)

> 支持的操作系统：Windows 2000、Windows 2000 Advanced Server、Windows 2000 Professional Edition、Windows 2000 Server、Windows 98、Windows 98 Second Edition、Windows ME、Windows NT、Windows Server 2003、Windows XP、Windows XP Home Edition、Windows XP Media中心版、Windows XP 专业版、Windows XP 平板电脑版

在您停止使用此文件之前，它不能在任何 Windows 操作系统（包括 64 位 Windows XP 版）上作为 64 位进程运行。

您没有理由不能将要使用的代码的行为修改为受支持的文件。

您可能对这个项目有更好的运气：http: [//www.codeproject.com/Articles/137552/WPF-TaskDialog-Wrapper-and-Emulator](http://www.codeproject.com/Articles/137552/WPF-TaskDialog-Wrapper-and-Emulator)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-17T10:16:58.947

我在一个项目中遇到了同样的错误信息，只是想分享我的解决方案。

我正在 Windows 7 上构建一个项目，该项目依赖于清单文件中列出的这个 dll。由于它试图在 Windows 7 上编译，它找不到该文件，因此我得到了同样的错误。

解决方案只是从清单中删除此依赖项，因为项目中的任何内容实际上似乎都没有依赖此程序集。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-01-29T01:10:36.687

与问题无关，但与相同的错误消息有关。

我尝试通过右键单击项目 -> 发布来发布 WPF 应用程序，然后该应用程序停止编译。

使其正常工作的唯一方法是删除项目（csproj）文件中所有添加的行。

# android - 获取有关我的 Android 上已安装应用程序的信息

> ID：10330107
> 
> 赞同：0
> 
> 时间：2012-04-26T08:51:26.510
> 
> 标签：android, browser, get, device

我需要获取有关我的 Android 设备上所有已安装应用程序的数据。

例如，我需要我的应用程序能够从浏览器获取活动会话等信息，或者从设备发送多少邮件或接收到数据包。

这似乎很难，但我认为这将是一个解决方案！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T08:55:11.110

尝试这个

```
final Intent mIntent = new Intent(Intent.ACTION_MAIN, null);
mainIntent.addCategory(Intent.CATEGORY_LAUNCHER);
final List pkgAppsList = context.getPackageManager().
    queryIntentActivities(mIntent, 0); 
```

这将为您提供具有意图的已安装应用程序列表

```
Intent.ACTION_MAIN 
```

我认为浏览器部分并不容易。您必须跟踪浏览器的启动时间，并持续观察它是否仍在运行。我猜邮件部分是可行的，但不知道。

# apache-flex - 带有 flex 应用程序 + 外部接口的 flashsocket.io 或 socket.io

> ID：10330108
> 
> 赞同：0
> 
> 时间：2012-04-26T08:51:29.263
> 
> 标签：apache-flex, socket.io, externalinterface

我目前有一个`flex application`which is a`simple chat`并且它进行长轮询。我想通过使用`sockets`.

我也是在长时间轮询后使用了flex `LCCS(server pushing)`，后来意识到LCCS即将关闭，所以我继续使用socket.io

我看到两个选项，

1.  在 js 中使用[socket.io](http://socket.io)并使用外部接口与 flex 应用程序进行通信
2.  使用[flashsocket.io](https://github.com/simb/FlashSocket.IO)

我确实在我的应用程序中实现了第二种情况（外部接口 + js 套接字），但我确实看到 10 分之 1 是失败的。

我所说的失败是指应用程序遇到错误情况，例如

1.  要么节点服务器不回复（奇怪）
2.  flex 应用程序没有成功执行 io.connect('server')。

> 所以我想知道将其更改为**flashsocket.io**是否是更好的选择？

请提出建议，如果这可能是重复的，请指出我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-20T09:34:06.803

我正在开发一个基于 Flex 4/Node.js 的应用程序，我们正在使用 flashsocket（稍作修改）。我想说我们对此非常满意。如果你愿意，我可以与你分享更新的 Flashsocket。

我避免使用第一种方法来解释为什么使用 ExternalInterface/JS，而所有这些都只能使用 flex/flash 来完成。

# iphone - 两个UIScrollView，同步滚动

> ID：10330110
> 
> 赞同：3
> 
> 时间：2012-04-26T08:51:32.900
> 
> 标签：iphone, ios, cocoa-touch, uiscrollview, uikit

我有两个 UIScrollView，它们在彼此之上。

```
 UIView
                                           |
                              --------------------------
                              |                        |
                         UIScrollView1            UIScrollView2 
```

我希望它以下列方式工作。如果我滚动 UIScrollView2，UIScrollView1 也应该滚动相同的 contentOffset。它必须同步完成，因此`scrollViewDidScroll`不能选择使用。你们有什么想法，怎么做？

源代码

```
 _prContentGridView = [[PRContentGridView alloc] initWithFrame:frame];
    _prContentGridView.minimumZoomScale = 0.25;
    _prContentGridView.maximumZoomScale = 2.0;
    _prContentGridView.delegate = self;

    _prBackgroundGridView = [[PRBackgroundGridView alloc] initWithFrame:frame];

    [self addSubview:_prBackgroundGridView];
    [self addSubview:_prContentGridView]; 
```

委托方法

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
    if (_prContentGridView.scrollEnabled == YES) {
        CGPoint p = CGPointMake(scrollView.contentOffset.x -   _prevousContentOffsetOfContentScrollView.x, scrollView.contentOffset.y - _prevousContentOffsetOfContentScrollView.y);
        [_prBackgroundGridView setContentOffset:p animated:YES];
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-26T09:04:58.697

使用 UIScrollViewDelegate 协议方法：

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView{
  if (scrollView == UIScrollView1){
    UIScrollView2.contentOffset = scrollView.contentOffset;
  }else{
    UIScrollView1.contentOffset = scrollView.contentOffset;
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T09:16:54.733

你应该试试这个代码，首先在 .h 文件中声明 IBOutlet，

```
IBOutlet UIScrollView *FirstScrollView;
IBOutlet UIScrollView *SecondScrollView; 
```

然后试试这段代码，

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
  if ([scrollView isEqual: FirstScrollView])
  {
            SecondScrollView.contentOffset =
              CGPointMake(FirstScrollView.contentOffset.x, 0);
  }
  else
  {
            FirstScrollView.contentOffset = 
              CGPointMake(SecondScrollView.contentOffset.x, 0);
  }
} 
```

# ios - 在 iOS 设备上使用自定义/现有蓝牙 HID？

> ID：10330114
> 
> 赞同：1
> 
> 时间：2012-04-26T08:51:34.637
> 
> 标签：ios, bluetooth, hid, mfi

我正在构建或使用现有的蓝牙 HID 设备（类似于[http://www.icontrolpad.com](http://www.icontrolpad.com)）并让我的 iOS 设备读取来自它的数据。所以我对此有一些疑问：-

1.  考虑到蓝牙堆栈在非越狱设备上不可用，是否有可能这样做。
2.  我需要注册苹果 Mfi 程序吗？如果我不需要，有什么替代方案？
3.  如果我确实注册了 Apple 的 Mfi 程序，我将获得允许我从蓝牙堆栈读取数据的访问框架。
4.  考虑到 iOS 设备上将有一个自定义应用程序需要与硬件 im 建筑物进行通信，苹果方面批准该应用程序意味着什么？

在此先感谢，非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-12T15:39:34.217

使用 Made for iPhone，您基本上可以使用 ExternalAccesory 框架获得连接设备的串行管道（实际上，它使用的是串行端口配置文件以及一些身份验证）。因此，虽然您不能使用实际的 HID 设备，但您可以发送数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T08:59:56.897

核心蓝牙框架可用于 iOS 5 上的低功耗蓝牙设备，无需 MFi 会员资格。

# python - 如何回溯 python 2.7 中的函数？

> ID：10330119
> 
> 赞同：5
> 
> 时间：2012-04-26T08:51:59.077
> 
> 标签：python, debugging, python-2.7

我有一个很大的 python 脚本，有多个文件，我需要知道一个方法在哪里被调用。python中是否有像php中的debug_backtrace这样的回溯功能？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-26T08:55:53.620

请参阅[回溯](http://docs.python.org/library/traceback.html#module-traceback)模块。

```
import traceback

def foo():
    bar()

def bar():
    baz()

def baz():
    traceback.print_stack() 
    # or trace = traceback.extract_stack()

foo() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T08:55:52.880

如果你想调试 python

```
import pdb 
```

然后放下一个

```
pdb.set_trace() 
```

您想从哪里开始调试

看到这个网站了解更多信息

[http://docs.python.org/library/pdb.html](http://docs.python.org/library/pdb.html)

# google-app-engine - 使用 JPA 和 Google App Engine 更新查询

> ID：10330120
> 
> 赞同：2
> 
> 时间：2012-04-26T08:52:01.650
> 
> 标签：google-app-engine, jpa

我正在尝试更新我的实体类，但我得到：

```
javax.persistence.PersistenceException: Only select and delete statements are supported. 
```

当我不使用 Google 应用引擎时，这个确切的代码运行良好。我的代码是：

```
 em.getTransaction().begin();

    Query query =
            em.createQuery("UPDATE Profile p" +
                           "SET p.age = 1 " +
                           "WHERE p.email = :email" );

    query.setParameter("newPoint", point);
    query.setParameter("email", email);

    int updateCount = query.executeUpdate();        
    em.getTransaction().commit(); 
```

所以我问我如何更新实体查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T08:54:09.007

由于 GAE 数据存储不支持直接更新数据存储中字段的查询，因此您同样无法通过 JPA API 执行此操作。由于 JPA 从未为其他类型的数据存储设计，因此您将看到不适用的功能。

通过查询检索对象，并手动更新它们。

当 GAE 提供开箱即用的完整 map-reduce 时，类似的东西将是可行的支持

# .net - 设置 Sharpssh sftp 连接超时

> ID：10330126
> 
> 赞同：2
> 
> 时间：2012-04-26T08:52:26.313
> 
> 标签：.net, sftp, sharpssh

我正在使用sharpssh.dll并想连接到sftp服务器，但是如果sftp服务器与网络断开连接，程序将等待很长时间才能显示“超时”消息，是否有设置超时sharpssh？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T13:04:49.260

截至目前，我不认为 SharpSSH 的 API 公开了 Sftp.cs 中 Session 的超时功能。它在一些较低级别的实现类中可用，所以我不知道现在做起来有多困难。

我一直在为 SharpSSH 提供一些补丁，尽管我不再对它做太多工作，所以我不会真的认为它“受支持”。如果您愿意，可以在[https://bitbucket.org/mattgwagner/sharpssh](https://bitbucket.org/mattgwagner/sharpssh)提交请求。

不过，您可能想查看[http://sshnet.codeplex.com/](http://sshnet.codeplex.com/)，它是一个更简洁、受支持的库，可满足您的 SSH 需求。

# javascript - Jquery / Handlebars 错误消息 - Uncaught TypeError: Object [object Object] has no method 'match'

> ID：10330129
> 
> 赞同：6
> 
> 时间：2012-04-26T08:52:47.580
> 
> 标签：javascript, jquery, mysql, ajax, handlebars.js

我正在做一个小学习项目，但遇到了一个我无法解决的问题。

我在谷歌浏览器开发控制台上收到以下错误消息：-

```
Uncaught TypeError: Object [object Object] has no method 'match'
lexer.nexthandlebars-1.0.0.beta.6.js:364
lexhandlebars-1.0.0.beta.6.js:392
lexhandlebars-1.0.0.beta.6.js:214
parsehandlebars-1.0.0.beta.6.js:227
Handlebars.parsehandlebars-1.0.0.beta.6.js:507
compilehandlebars-1.0.0.beta.6.js:1472
(anonymous function)handlebars-1.0.0.beta.6.js:1481
(anonymous function)scripts.js:103
jQuery.Callbacks.firejquery.js:1046
jQuery.Callbacks.self.fireWithjquery.js:1164
donejquery.js:7399
jQuery.ajaxTransport.send.callback 
```

现在，这会在车把脚本中的以下代码出现错误

```
match = this._input.match(this.rules[rules[i]]);
Uncaught TypeError: Object [object Object] has no method 'match' 
```

所以我从中得到的是，我的代码一定有问题，而不是车把代码，即使它处于测试阶段。

这是启动这一切的代码部分。

```
displayJobInfo: function( e ) {
    var self = Actors;

    self.config.jobInfo.slideUp( 300 );
    var jobnum = $(this).data( 'job_id' );
    $.ajax({
        data: { job_id: jobnum }

    }).then(function( results ) {
        self.config.jobInfo.html( self.config.JobInfoTemplate( { jobs: results, job_id: jobnum }) ).slideDown(300);
    });
    console.log($(this).data( 'job_id' ));
    e.preventDefault();
} 
```

我花了几个小时试图自己解决这个问题，并且几乎相同的代码部分在我网站的另一部分工作。

一点背景知识 - 我正在使用 php 从 mysql 中提取数据库，然后根据用户输入和 jquery 查询数据库以将字段覆盖回页面上。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-03T23:12:59.120

如果您尝试从 jquery 元素对象而不是字符串编译模板，则会发生这种情况。例如

```
<script id="my-template-script" type="text/template">...</script> 
```

接着

```
var my_template = Handlebars.compile( $("#my-template-script") );  // WRONG 
```

你可能期望这会立即爆炸，但事实并非如此。相反，它应该是

```
var my_template = Handlebars.compile( $("#my-template-script").html() ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-14T21:25:00.170

如果您将模板作为 text/html 获取，那么您的模板可能是 htmlDocument。如果您按如下方式初始化模板，那么它将正常工作。

```
function getTemplate(templateName,context, callback, errorCallback) {
var template = {};
template.name = templateName;
$.ajax({
    url: templateName,
    timeout: 1000,
    datatype: "text/javascript",
    error: function(jqXHR, textStatus, errorThrown) {
        errorCallback && errorCallback.call(context, textStatus);
    },
    success:function(response, textStatus, jqXHR) {
        try {
            template['handlebar'] = Handlebars.compile(jqXHR.responseText);
        } catch(e) {
            console.error("error while creating Handlebars script out of template for [", template, e);
            throw e;
        }
        template['rawTemplate'] = jqXHR.responseText;
        callback && callback.call(context, template);
        return response;
    }
}); 
```

}

如果您使用响应参数而不是 jqHXR.responseText，那么您将找不到“匹配”。我试过了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T09:06:00.363

[`match`](http://www.w3schools.com/jsref/jsref_match.asp "W3School 比赛页面")仅适用于字符串。您必须将其应用于输入的值。如果它是一个 jQuery 对象，你可以使用，`_input.val()`否则`_input.value`应该可以工作。

另一方面，由于它是库的一部分，您可能需要检查预期输入的数据类型以及实际发送的数据类型。

`null`例如是 javascript 中的一个对象，因此如果库不处理它，您可能希望将其更改为空字符串。

# vba - VBA如何在按下表单按钮时强制函数返回

> ID：10330132
> 
> 赞同：5
> 
> 时间：2012-04-26T08:52:57.360
> 
> 标签：vba, excel

我以为这很简单，但事实证明这很困难。任何建议或想法都会受到赞赏。

我在 Excel 中有一个表单，如果按下某个按钮，我需要用户在该按钮的代码运行之前输入密码。

我可以只使用输入框，但这将允许其他人在输入密码时看到密码。所以我想使用带有文本框的第二种表单并将其 PasswordChar 参数设置为 *

这是问题所在。我想使用这样的代码

```
if checkPassword("Please enter your password") = False then exit sub 
```

`checkPassword`是一个将字符串作为参数的函数。此函数打开一个表单并将消息放入标签中。用户应输入密码并单击确定。

sub`btnOK_Click()`应该检查密码是否正确，然后如果密码正确，则强制打开表单的函数返回 True 或 False 是密码不正确。

我只是不知道如何强制函数返回。当用户单击确定然后卸载表单时，我尝试将全局变量设置为 True 或 False。这会使函数返回，但它也会重置表单设置的所有全局变量。

这是我调用表单的函数

```
Function checkPassword(message As String) As Boolean

  frmPassword.Show
  frmPassword.passwordMsg.Caption = message

  'passwordStatus is a global variable
  If passwordStatus = True Then checkPassword = True Else  checkPassword = False

End Function 
```

这是链接到表单确定按钮的子：

```
Private Sub passwordok_Click()

  If Me.passwordtext.Text = "password" Then
      passwordStatus = True
  Else
      passwordStatus = False
  End If
  Unload Me

End Sub 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T09:10:07.937

> > > 我可以只使用输入框，但这将允许其他人在输入密码时看到密码。所以我想使用带有文本框的第二种表单并将其 PasswordChar 参数设置为 *

这是我的数据库中的一些内容。

**免责声明**：我没有写这个，我不记得是谁写的

**用法**：

```
Private Sub passwordok_Click()
    Dim Prompt, password As String
    Prompt = "Please enter your password."
    password = InputBoxDK(Prompt)

    MsgBox password '<~~ Do whatever you want to do with this
End Sub 
```

**在一个模块中**

```
Option Explicit

Private Declare Function CallNextHookEx Lib "user32" (ByVal hHook As Long, _
ByVal ncode As Long, ByVal wParam As Long, lParam As Any) As Long

Private Declare Function GetModuleHandle Lib "kernel32" Alias _
"GetModuleHandleA" (ByVal lpModuleName As String) As Long

Private Declare Function SetWindowsHookEx Lib "user32" Alias "SetWindowsHookExA" _
(ByVal idHook As Long, ByVal lpfn As Long, ByVal hmod As Long, _
ByVal dwThreadId As Long) As Long

Private Declare Function UnhookWindowsHookEx Lib "user32" (ByVal hHook As Long) As Long

Private Declare Function SendDlgItemMessage Lib "user32" Alias "SendDlgItemMessageA" _
(ByVal hDlg As Long, ByVal nIDDlgItem As Long, ByVal wMsg As Long, _
ByVal wParam As Long, ByVal lParam As Long) As Long

Private Declare Function GetClassName Lib "user32" Alias "GetClassNameA" _
(ByVal hwnd As Long, ByVal lpClassName As String, ByVal nMaxCount As Long) As Long

Private Declare Function GetCurrentThreadId Lib "kernel32" () As Long

'Constants to be used in our API functions
Private Const EM_SETPASSWORDCHAR = &HCC
Private Const WH_CBT = 5
Private Const HCBT_ACTIVATE = 5
Private Const HC_ACTION = 0

Private hHook As Long

Public Function NewProc(ByVal lngCode As Long, ByVal wParam As Long, _
ByVal lParam As Long) As Long
    Dim RetVal
    Dim strClassName As String, lngBuffer As Long

    If lngCode < HC_ACTION Then
        NewProc = CallNextHookEx(hHook, lngCode, wParam, lParam)
        Exit Function
    End If

    strClassName = String$(256, " ")
    lngBuffer = 255

    'A window has been activated
    If lngCode = HCBT_ACTIVATE Then
        RetVal = GetClassName(wParam, strClassName, lngBuffer)
        'Class name of the Inputbox
        If Left$(strClassName, RetVal) = "#32770" Then
            'This changes the edit control so that it display the password character *.
            'You can change the Asc("*") as you please.
            SendDlgItemMessage wParam, &H1324, EM_SETPASSWORDCHAR, Asc("*"), &H0
        End If
    End If

    'This line will ensure that any other hooks that may be in place are
    'called correctly.
    CallNextHookEx hHook, lngCode, wParam, lParam

End Function

Public Function InputBoxDK(Prompt, Optional Title, Optional Default, Optional XPos, _
Optional YPos, Optional HelpFile, Optional Context) As String
    Dim lngModHwnd As Long, lngThreadID As Long
    lngThreadID = GetCurrentThreadId
    lngModHwnd = GetModuleHandle(vbNullString)
    hHook = SetWindowsHookEx(WH_CBT, AddressOf NewProc, lngModHwnd, lngThreadID)
    InputBoxDK = InputBox(Prompt, Title, Default, XPos, YPos, HelpFile, Context)
    UnhookWindowsHookEx hHook
End Function 
```

**快照**

![在此处输入图像描述](../Images/c6ac815b60b3b1fbfeac13ee8364287f.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T09:56:57.103

从对话框中返回一个值是一项常见的任务，而且非常简单。

最简单的模式是将函数放在对话框表单本身中，并让该函数以模态方式显示其宿主表单。

```
Private passwordStatus As Boolean

Function checkPassword(message As String) As Boolean
  '//setup the form
  Me.passwordMsg.Caption = message

  '//show the form modally, this will not return until the form is unloaded 
  '//i.e. when the button is clicked; so values in private variable are still valid
  Me.Show vbModal

  '//form is unloaded (via unload me or a close) return the value;
  checkPassword = passwordStatus
End Function

Private Sub passwordok_Click()
  passwordStatus = Me.passwordtext.Text = "password"
  Unload Me
End Sub 
```

用作

```
passworkOk = frmPassword.checkPassword("enter your blabla") 
```

# css - 如何使用 mediaquery css 将 font-size:medium 应用于整个站点

> ID：10330133
> 
> 赞同：0
> 
> 时间：2012-04-26T08:53:06.383
> 
> 标签：css, media-queries

我有一个styles.css 文件。现在我要为手机/平板设备编写 css - 媒体查询。在styles.css 中，我提到了不同类的不同字体大小。现在我需要将所有“字体大小”应用于移动设备的“中等”。如何申请？

我已经申请了字体大小：中；到媒体查询 css。它工作正常。但对于 style.css 中的 ex:.dynamicdata{font-size:14px;}。我需要将替换字体大小：中等应用于我为 mediaqueires css 应用字体大小的所有类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T09:01:39.930

我会这样做...

```
@media screen and (max-width: 480px) {

  /* disable webkit text size adjust (for iPhone) */
  html {
    -webkit-text-size-adjust: none;
  }
  .class1, .class2, .class3 {
    font-size: 1.2em;
  }
} 
```

# java - java.net.URI 仅针对查询字符串解析

> ID：10330138
> 
> 赞同：6
> 
> 时间：2012-04-26T08:53:20.293
> 
> 标签：java, uri

我正在尝试使用 JDK [java.net.URI](http://docs.oracle.com/javase/6/docs/api/java/net/URI.html)构建 URI 。
我想附加到一个绝对 URI 对象，一个查询（在字符串中）。例如：

```
URI base = new URI("http://example.com/something/more/long");
String queryString = "query=http://local:282/rand&action=aaaa";
URI query = new URI(null, null, null, queryString, null);
URI result = base.resolve(query); 
```

理论（或我认为）是 resolve 应该返回：

```
http://example.com/something/more/long?query=http://local:282/rand&action=aaaa 
```

但我得到的是：

```
 http://example.com/something/more/?query=http://local:282/rand&action=aaaa 
```

为什么[#resolve()](http://docs.oracle.com/javase/6/docs/api/java/net/URI.html#resolve%28java.net.URI%29) “吃掉”最后一条路径？如果新的 URI ( `query`) 构建为：

```
URI query = new URI(null, null, base.getPath(), queryString, null); 
```

它运作良好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-02T10:02:53.557

我想自己回应。Javadoc 确实解释正确。正如[URI#resolve()](http://docs.oracle.com/javase/6/docs/api/java/net/URI.html#resolve%28java.net.URI%29)所说，在第 3.b 节中：

> 否则，给定 URI 的路径是相对的，因此新 URI 的路径是通过根据该 URI 的路径解析给定 URI 的路径来计算的。这是通过将此 URI 路径的最后一段（如果有的话）与给定 URI 的路径连接起来，然后像调用 normalize 方法一样对结果进行规范化来完成的。

所以....我没有正确阅读。我应该删除这个回复吗？还是让它自己回应？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:40:08.077

**第一种情况：**

```
base = http://example.com/something/more/long 
```

并`query`评估为

```
query = ?query=http://local:282/rand&action=aaaa. 
```

根据 method 的文档 `public URI resolve(URI uri)`，它根据基本 URI 解析查询 URI。在解析该方法是否在查询 URI 中找到路径时，它会将相同的路径分配给新解析的 URI。在这种情况下，没有与`query`. 如果您看到下面的`resolve()`函数片段，它会变得更加清晰。

//片段

```
 String cp = (child.path == null) ? "" : child.path;
        if ((cp.length() > 0) && (cp.charAt(0) == '/')) {
        // 5.2 (5): Child path is absolute
        ru.path = child.path;
        } else {
        // 5.2 (6): Resolve relative path
        ru.path = resolvePath(base.path, cp, base.isAbsolute());
        } 
```

其中 cp 是孩子（在您的情况下是查询路径）。由于此处为 null，流程进入 else 循环，其中已解析的查询被分配了来自基本 URI 的路径。

您的新 URI 具有此路径`/something/more/`，因为它会删除最后一个“/”字符之后的所有内容。

**第二种情况：**

base = [http://example.com/something/more/long](http://example.com/something/more/long) 并`query`评估为

```
query = /something/more/long?query=http://local:282/rand&action=aaaa 
```

这里是 if 循环，它将查询路径分配给新 URI 的路径。您的查询 URI 的路径在`/something/more/long`这里，即它也包括“长”值。可能这就是他们解析 URI 的方式。仔细阅读文档，您将对此有更清晰的了解。

# php - 在 Ubuntu 上使用 Apache/SVN 渲染代码

> ID：10330139
> 
> 赞同：0
> 
> 时间：2012-04-26T08:53:20.440
> 
> 标签：php, svn, ubuntu, lamp

我不确定我是否错过了这里的重点......

我们的开发人员想要以下...

在带有 SVN/WebDAV 的 LAMP 服务器上，他们希望根 Apache 目录成为他们都可以使用的存储库。但是，将默认 Apache 目录设置为 repo 不起作用，因为文件不存储为 html/php 文件，而是存储在 SVN db 结构中以处理更改/修订/等。

有没有办法做到这一点？还是我们必须有一个单独的存储库，以便他们在开发时将文件复制到网络根目录/从网络根目录复制文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:11:32.833

您必须设置一个单独的 svn 存储库和[Hook Scripts](http://svnbook.red-bean.com/en/1.1/ch05s02.html)。这个钩子脚本可以在每次代码更改到您的 apache 根目录时检查代码。这很常见，也用于自动测试等。

# spring - 使用 rest jersey 从 spring 调用 EJB

> ID：10330141
> 
> 赞同：1
> 
> 时间：2012-04-26T08:53:25.800
> 
> 标签：spring, ejb-3.1

首先，问题是当我从其他 servlet 调用 ejb 时，ejb 始终为空。

我有一个在 jersey + spring 3.0.5 中开发的休息网络服务。以及用于服务的 EJB 3.1。

我已经将战争和罐子打包在耳朵里，所以我的应用程序看起来像（我使用 maven 进行依赖）：

```
+ear
++war
++jar 
```

我想知道如何从 war 文件中的类调用 jar 文件中的服务。据我记得是通过 JNDI 并且我需要公开 ejb api？我该怎么做？

我确定 EJB 已成功创建，因为我可以在服务器中看到这样的日志： EJB UserServiceBean 的便携式 JNDI 名称：[java:global/demo-cg-ear-0.0.1-SNAPSHOT/demo-cg-ejbs /UserServiceBean!com.demo.cg.service.user.UserServiceBeanLocal, java:global/demo-cg-ear-0.0.1-SNAPSHOT/demo-cg-ejbs/UserServiceBean]|#]

但问题是当我在 rest jersey servlet 中调用它时，它总是为空：

```
@Path("/payment")
@Stateless
public class PaymentService {

@Path("/payment")
@Stateless
public class PaymentService {

    @EJB
    private UserServiceBeanLocal userServiceBean;

    @GET
    @Path("/hello")
    public Response savePayment() {

        String result = userServiceBean.getName();
        return Response.status(200).entity(result).build();

        /* return Response.status(200).entity("hello edward").build(); */
    }

} 
```

我的 applicationContext.xml 文件

```
<context:annotation-config />
    <context:component-scan base-package="com.sido" />
    <context:property-placeholder location="WEB-INF/build.properties" />

    <!-- <bean class="org.springframework.context.annotation.CommonAnnotationBeanPostProcessor"> 
        <property name="alwaysUseJndiLookup" value="true" /> </bean> -->

    <jee:jndi-lookup id="userServiceBean"
        jndi-name="java:global/sido-cg-ear-0.0.1-SNAPSHOT/sido-cg-ejbs/UserServiceBean"
        resource-ref="true" lookup-on-startup="true"
        expected-type="com.sido.cg.service.user.UserServiceBeanLocal"
        proxy-interface="com.sido.cg.service.user.UserServiceBeanLocal"></jee:jndi-lookup> 
```

UserBean 类

```
@Interceptors(SpringBeanAutowiringInterceptor.class)
@Stateless
public class UserServiceBean implements UserServiceBeanLocal {
    private String name;

    public UserServiceBean() {
        name = "edward";
    }

    @PostConstruct
    private void init() {
        name = "edward";
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

} 
```

谢谢，
czetsuya

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-28T01:09:53.040

对于那些感兴趣的人，我就是这样做的：[http ://czetsuya-tech.blogspot.com/2012/05/how-to-call-stateless-ejb-from-spring.html](http://czetsuya-tech.blogspot.com/2012/05/how-to-call-stateless-ejb-from-spring.html)

# c# - 代表和事件哪个先执行/引发？

> ID：10330146
> 
> 赞同：0
> 
> 时间：2012-04-26T08:53:35.597
> 
> 标签：c#, asp.net, .net, events, delegates

我不知道我是否应该在这里问这个问题但无论如何我在问..

假设我有一个 asp 按钮控件，并且我同时使用 Delegate 和 Click 事件来处理将首先触发的按钮？

初始化时：

```
 btn1.Click += delegate{ Save(); }; 
```

点击事件：

```
 protected void btn1_Click(object sender, EventArgs e)
   {
     Save1();
   } 
```

我想知道哪个会先执行/提出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T09:39:16.883

btn1_click 在设计时自动附加到 InitializeComponent() 函数中的单击事件。InitializeComponent(0 函数是从表单的构造函数调用的。它是winforms的默认片段。

在调用InitializeComponent()之前不能调用下面的语句，否则会报错“Object reference not set to an instance of an object”。直到此时，控件还没有初始化。

```
btn1.Click += delegate{ Save(); }; 
```

所以执行顺序将首先是 btn1_Click 事件，然后是委托附加的保存函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T08:59:29.723

我认为这与分配它们的顺序有关。通常，一个名为 btn1_Click 的方法不会触发，除非您将它绑定到代码隐藏或您正在使用的 ASPX 文件中。

我猜你正在将 btn1 绑定到 ASPX 中的 btn1_Click 方法，这可能会首先触发，但为什么不直接测试它呢？在两行都设置断点，看看哪个是第一个被击中的？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T08:57:59.710

事件未“执行”，事件已*引发*，因此执行将由您的事件处理程序执行，该事件处理程序`btn1_Click`由客户端特别点击。

# reverse-engineering - 如何使用 OllyDbg 绕过 IsDebuggerPresent？

> ID：10330147
> 
> 赞同：17
> 
> 时间：2012-04-26T08:53:36.377
> 
> 标签：reverse-engineering, ollydbg

我真的不明白如何绕过 IsDebuggerPresent。我想我应该找到用于调试的寄存器，然后将其设置为 0 以欺骗 IsDebuggerPresent，但我不知道该怎么做。我尝试在 Google 上搜索，甚至尝试了一些解决方案，但它并没有真正适合我。有人可以向我解释这应该如何工作以及如何绕过它？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-04-26T10:58:44.827

有很多方法可以做到这一点。正如您所说，可以修补程序的线程块。这是一个教程，如何绕过 IsDebuggerPresent，只需修补此函数，使其始终返回 0。

1) 定位 IsDebuggerPresent

![OllyDbg 1](../Images/88fcec08f15e8f4d99e5676207b026e8.png)

在我的情况下，它位于 7664EFF7，并且仅包含三个指令 + 一个 RET。它读取线程块（地址位于 FS:18），然后找到显示“我正在调试”的字节并返回它。返回值存储在 EAX 中（与大多数 WINAPI 函数一样）。如果我修改函数以使其最终具有 EAX = 0，我将成功绕过 IsDebuggerPresent。

2）修补它

现在最简单的方法是简单地使函数简单地执行`MOV EAX, 0`指令，然后执行`RETN`：

![OllyDbg 2](../Images/54e8746fca3a96d654691c4c6dcbf5b9.png)

请注意，我还用 NOP 填充了函数的其余部分，以避免改变它的大小。可能没有必要，您也可以只做 `MOV EAX, 0`然后只做`RETN`.

您还应该知道，修改仅对程序的一次运行有效。当您重新启动它时，它将使用原始功能加载 kernel32.dll（IsDebuggerPresent 所在的位置）的新副本，您将不得不再次应用补丁。如果要使补丁永久化，则需要修改启动二进制文件并修改/删除对此函数的*调用。*但在您这样做之前，您还需要确保二进制文件不会检查自己的修改。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-07T16:33:41.370

在您的进程中注入此代码：

```
mov eax,dword ptr fs:[18]
mov eax,dword ptr ds:[eax+30]
mov byte ptr ds:[eax+2],0 
```

这将修补`PEB.BeingDebugged` [标志](http://blog.rewolf.pl/blog/?p=294)，确保`IsDebuggerPresent`始终返回`0`

使用 x64dbg 时，您可以运行该`dbh`命令。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-03-05T19:12:33.840

如果您希望您的应用程序永远不要检查它，请执行以下操作：

*   按下`Alt + e`或打开`Executable modules`窗口。
*   选择`C:\WINDOWS\system32\kernel32.dll`并按下`ctrl + N`
*   选择`IsDebuggerPresent`并按回车。
*   按`f2`
*   运行程序并在此操作码上等待您的程序中断。
*   按一些`f8`直到回到您的代码。
*   寻找类似的东西`TEST EAX,EAX`，然后寻找类似的东西`je` `jnz`等等，注意输出`IsDebuggerPresent`保存在`EAX`.
*   如果在此操作码上发生跳转，则将其更改为`nop`，如果没有发生，则将其更改为`jmp`.
*   保存您的程序。如果您不知道如何在 ollyDBG 中保存修改后的代码，只需搜索即可。

# jquery - JQuery在提交时刷新一个div

> ID：10330148
> 
> 赞同：1
> 
> 时间：2012-04-26T08:53:38.170
> 
> 标签：jquery, html, web.py

当用户提交一个简单的表单时，我想刷新一个 div。但是我似乎无法找出它为什么不起作用。（这是我第一次使用 JQuery 和 Ajax）

我的脚本：

```
 <script src="static/jquery.js"></script> 
        <script>
                $('#submit_div').click(function(){
                    var data: $("#name").val();
                    var datastr: 'name='+data;
                    $.ajax{
                        type: "POST",
                        url: $(this),
                        data: datastr,
                        success: function(data){
                            $("#content").replaceWith($('#content'),$(data));
                            }
                    }
                });

        </script> 
```

我的 HTML：

```
<div id="content">
          <div id="form_div">
            <form method="POST">
                <div id="form"> 
                    <div id="name_div"> name <input type="text" id="name" name="name"/></div>
                    <div id="submit_div">  <button type="submit" id="submit" name="submit">submit</button></div>
                </div>
            </form>
 <div style="clear:both;"></div></div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T09:02:54.557

**错误**

```
var data: $("#name").val();
var datastr: 'name='+data;
$.ajax{...}
$("#content").replaceWith($('#content'),$(data)); 
```

**固定的**

```
$('#submit_div').click(function(e){
    e.preventDefault();                
    var data = $("#name").val();
    var datastr='name='+data;
    $.ajax({
        type: "POST",
        url: $(this),
        data: datastr,
        success: function(data){
            $("#content").replaceWith(data);
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T08:58:32.273

您的代码中存在语法错误。你应该写：

```
var data = $("#name").val();
var datastr = 'name='+data; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T08:56:01.580

您是否尝试过 jQuery Load 方法？

[http://api.jquery.com/load/](http://api.jquery.com/load/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T08:57:57.317

我认为返回的值数据是你想要替换的（如果我是对的）..然后像这样使用..

```
$("#content").replaceWith(data); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T09:08:50.400

```
$("#form_div form").submit(function(e){
  e.preventDefault();
  var data = $("#name").val();
  $.post('/some/url/file.php',{name: data},function(data){
    $("#content").html(data);
  });
}); 
```

您应该处理表单提交事件并阻止它的默认操作。

# java - 读取 XML 文件 java

> ID：10330151
> 
> 赞同：3
> 
> 时间：2012-04-26T08:53:46.407
> 
> 标签：java, xml

大家好，我在 java 中有一个 XML 文件，其中包含一个二维数字数组，它看起来像

```
<tableNumbers>
     <row id="0">
         <column id="0"> 4 </column>
         <column id="1"> 2 </column>
         <column id="2"> 5 </column>
         <column id="3"> 6 </column>
    </row>
    <row id="1">
         <column id="0"> 5 </column>
         <column id="1"> 10 </column>
         <column id="2"> 7 </column>
         <column id="3"> 9 </column>
    </row>
</tableNumbers> 
```

现在表中的每一行都有相同数量的列，我想要做的是循环遍历 xml 并将 XML 文件中的数字存储到一个整数数组中。（例如，第 0 行第 0 列将存储在 numbers[0][0] 中。

我目前拥有的代码是：

```
public static Integer[][] getNumbers(File file, int noRows, int noColums){
        Integer[][] numbersArray = new Integer[noRows][noColumns];

        DocumentBuilderFactory docBuilderFactory = DocumentBuilderFactory.newInstance();
        try {
            Document document = docBuilderFactory.newDocumentBuilder().parse(file);
            Element rootElement = document.getDocumentElement(); 

            NodeList rowList = rootElement.getElementsByTagName("row");
            if ((rowList != null)) 
                for (int i = 0; i < rowList.getLength(); i++) {
                    NodeList columnsList = rowList.item(i).getChildNodes();
                    if ((columnsList != null)) 
                        for (int j = 0; j < columnsList.getLength(); j++) {
                            Element number = (Element) columnsList.item(j); 
                            System.out.println("(" +i + "," + j + ") " + number.getNodeValue());
                            numbersArray[i][j] = number.getNodeValue();
                        }
                }

            return numbersArray;
        }
        catch (Exception c){}
        return null;
} 
```

标准输出的几行是：

```
(0,0) null
(0,1) null
(0,2) null
(0,3) null
(1,0) null
(1,1) null
(1,2) null
(1,3) null 
```

从所有单元格返回的值是`null`。我知道错误是从 xml 文件中读取的。如果有人能告诉我哪里出错了，我将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:18:38.103

我会添加以下内容：

```
Element number = (Element) columnsList.item(j);
if ("column".equals(number.getTagName())) }
    System.out.println("(" +i + "," + j + ") " + number.getTextContent());
} 
```

因为您可能有一个空元素。另外，我正在使用声明中的`getTextContent()`方法`Node`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T08:58:39.330

该 XML 示例是准确的副本吗？如果是这样，那么您的结束“行”标签有错误。他们应该是`</row>`（即他们缺少斜线）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T09:05:36.597

尝试`System.out.println("(" +i + "," + j + ") " + number.item(0).getNodeValue());`代替`System.out.println("(" +i + "," + j + ") " + number.getNodeValue());`

**或者**

```
NodeList valList = number.getChildNodes();
System.out.println("Last Name : " + ((Node) valList.item(0)).getNodeValue()); 
```

希望有效，

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T09:10:04.067

getNodeValue 返回节点的值 - 列节点没有值（可能除了空格）。它们应该包含文本元素，并且它们将包含您需要的值

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T09:37:25.043

我进行了一些更改以使其正常工作。这是片段。

```
 for (int j = 0; j < columnsList.getLength(); j++) {
                        if ("column".equals(columnsList.item(j)
                                .getNodeName())) {
                            Element number = (Element) columnsList.item(j);
                            System.out.println("(" + i + "," + j + ") "
                                    + columnsList.item(j).getTextContent());
                            numbersArray[i][j] = Integer
                                    .parseInt(columnsList.item(j)
                                            .getTextContent().trim());
                        }
                    } 
```

# c# - C# XML 序列化和十进制值

> ID：10330155
> 
> 赞同：2
> 
> 时间：2012-04-26T08:54:02.477
> 
> 标签：c#, xml, xml-serialization, decimal

我正在使用 XmlSerializer 将包含小数的 C# 对象序列化为 xml 字符串

例如

```
AnObject.ADecimalValue 
```

我发现精度特别不同，即使我明确地四舍五入如下，一些值在点之后得到四个值的输出，例如 12564.39 得到输出为 12564.3900

`AnObject.ADecimalValue = decimal.Round(AnObject.ADecimalValue, 2);`

序列化代码如下。

```
 XmlSerializer serializer = new XmlSerializer(typeof(AnObject));

    using (StringWriter writer = new StringWriter())
    {
        serializer.Serialize(writer, source);

        string result = writer.ToString();

        return result;
    } 
```

**如何确保在小数点后只输出两个值**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T12:45:16.133

你能实现`IXmlSerializable`重新定义你如何序列化你的对象吗？

[此处](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)的文档以及如何在[此处](https://stackoverflow.com/questions/279534/proper-way-to-implement-ixmlserializable)实现它的详细说明。

然后[这里](http://geekswithblogs.net/NotImpossible/archive/2009/02/17/xml-serialization-doubles-decimals-and-sql-server.aspx)有一个与您有类似（但不相关）问题的人的帖子。你可以正确地四舍五入你的小数，看看它是否有效，如果没有，那么你可以把它写成一个字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T09:12:07.420

我不认为四舍五入一个浮点数可以帮助这一点。序列化程序根据自己的规则将数字转换为字符串。您可以做的最好的事情是引入一个新的字符串属性，并将其中的数字格式化并序列化它而不是原始数字。

有关该主题的更多信息，类似问题： [您可以为日期时间的 XmlSerialization 指定格式吗？](https://stackoverflow.com/questions/1118833/can-you-specify-format-for-xmlserialization-of-a-datetime)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-09-23T00:14:27.640

这是我解决类似问题的方法，它对我来说非常有效。

```
 private decimal  price;

    [XmlElement(DataType="decimal")]
    public string  Price
    {
        get { return price.ToString("c"); }
        set { price = Convert.ToDecimal(value); }
    } 
```

就我而言，我将其转换为货币，但您可以使用 price.ToString("0.00") 将 XML 元素转换为带有 2 个零的十进制。

# mysql - mysql系统用户

> ID：10330159
> 
> 赞同：0
> 
> 时间：2012-04-26T08:54:17.773
> 
> 标签：mysql

在此处引用 MySQL 文档

> 如果这是系统用户，它指的是由服务器生成的用于在内部处理任务的非客户端线程。这可能是复制从属或延迟行处理程序上使用的 I/O 或 SQL 线程。未经身份验证的用户是指已与客户端连接关联但尚未完成客户端用户身份验证的线程。event_scheduler 是指监控调度事件的线程。对于系统用户，主机列中没有指定主机。

什么是 MySQL 系统用户？如何为 MySQL 创建系统用户？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T11:09:52.847

您无法*创建*“系统用户”。这是 MySQL 用于文档中描述的目的的特殊用户。具体来说：主要不是源于用户交互的过程。由于这些使用 MySQL 线程和资源，它们也出现在`SHOW PROCESSLIST`.

# batch-file - 改变线条的颜色

> ID：10330161
> 
> 赞同：1
> 
> 时间：2012-04-26T08:54:35.753
> 
> 标签：batch-file

> **可能重复：**
> [如何更改批处理文件中注释行的文本颜色](https://stackoverflow.com/questions/2586012/how-to-change-the-text-color-of-comments-line-in-a-batch-file)

您好，我想打印一条类似于以下内容的消息：当命令有效时测试 [OK] 为绿色，当命令失败时测试 [失败] 为红色

我发现我可以通过输入 COLOR 0A（黑色 + 绿色）和 0C（黑色 + 红色）和 07（黑色和白色）来管理 DOS 颜色。

前任：

```
IF EXIST filename. (
COLOR 07
ECHO Test.
COLOR 0A
ECHO [OK]

) ELSE (
COLOR 07
ECHO Test.
COLOR 0C
ECHO [Failed]
)
REM: Setting the color back to default
COLOR 07 
```

但是，当它到达 COLOR 行时，它只会以该颜色更改整个 cmd 屏幕......有没有办法以不同的颜色打印单个字符串。

# php - 将 html 存储在配置文件中的最佳方法

> ID：10330162
> 
> 赞同：0
> 
> 时间：2012-04-26T08:54:36.907
> 
> 标签：php, quotes

我正在编写自己的下载跟踪器，我想为用户提供在下载页面上显示自定义消息的能力。我想允许 html 和 javascript，以便用户可以编写段落或使用广告代码等。

我将我的设置存储在配置文件中（不是我知道的最佳方式）

例子：`<?php define("WAIT_MESSAGE", "htmlcodehere"); ?>`

问题是引号或斜杠弄乱了配置文件，设置页面将无法加载。我已经研究过添加斜杠以尝试转义这些字符，但它只是添加了多个斜杠。

在我的配置文件中存储 html 内容/javascript 的最佳方式是什么？

编辑：尝试了几种方法，但是每次我单击保存以更新配置文件时，所有引号都被转义了 \"hello\" 变为 \"hello\" 等

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T08:59:22.740

您不应该**如此**信任您的用户，以至于您让他们在您的网站上发布和保存 JavaScript 和 HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T08:59:11.727

您是否尝试过像单 ' 一样？

```
<?php define('WAIT_MESSAGE', '<p>Please wait.. your download starts shortly</p>'); ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T09:02:05.717

那根本不安全。有人可以轻松地将 PHP 注入其中。

你能做的（这有点老套）是`base64_encode()`数据，以及`base64_decode()`当你需要使用它的时候。这样做将摆脱引号/特殊字符问题和安全问题。

在配置文件中编写 base64_encoded HTML 后，要使用它，您将执行以下操作：

```
<?php
    echo base64_decode(WAIT_MESSAGE);
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T09:05:55.067

## 允许用户在您的页面中实际插入 HTML/Javascript/PHP 是一件非常糟糕的事情

说了这么多，这个问题时常困扰着我们所有人。您需要以某种不会改变上述代码含义的格式存储 HTML 代码。

此问题通常通过将任何此类字符转换为其等效的 HTML 实体来解决，以便您可以安全地存储

查看[http://php.net/manual/en/function.htmlspecialchars.php](http://php.net/manual/en/function.htmlspecialchars.php)和[http://www.php.net/manual/en/function.htmlspecialchars-decode.php](http://www.php.net/manual/en/function.htmlspecialchars-decode.php)了解更多信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T09:54:37.440

就个人而言，我会在数据库中保存任何可编辑的值以确保安全，但如果您真的想要/需要编辑 php 配置文件，那么这可能是最安全的方式。

```
<?php 
/*Function to check if magic_quotes is enabled.
 (Stops double slashes happening)
*/
function check_magic_quotes($value){
    if (get_magic_quotes_gpc()) {
        return stripslashes($value);
    } else {
        return $value;
    }
}

/*Form was posted, 
You should also do a check to see if logged in and have rights to edit*/
if($_SERVER['REQUEST_METHOD']=='POST'){
    //Check for magic quotes and then base64_encode the string.
    $value = base64_encode(check_magic_quotes($_POST['configVal']));

    /*Use heredoc to create the php line for the config & insert the
      base64 encoded string into place*/
$config=<<<CONFIG
    <?php define("WAIT_MESSAGE", '$value'); ?>
CONFIG;

    file_put_contents('someConfig.php',$config);
}

//When you want to include the config
include('someConfig.php');

/*To echo out the config value: base64_decode it,
  and then htmlentities encode it, to protect from XSS*/
echo 'This was included: '.htmlentities(base64_decode(WAIT_MESSAGE));

//Basic form with current value when someConfg.php has not been included
$config = file_get_contents('someConfig.php');
preg_match("#\"WAIT_MESSAGE\", '(.*?)'#",$config,$match);
 ?>

<form method="POST" action="">
  <p>Config Value:<input type="text" name="configVal" value="<?php echo htmlentities(base64_decode($match[1]));?>" size="20"><input type="submit" value="Update"></p>
</form> 
```

# scala - 我应该使用 Scala、Java 还是 Node.js？

> ID：10330164
> 
> 赞同：6
> 
> 时间：2012-04-26T08:54:46.720
> 
> 标签：scala, node.js

我非常广泛地阅读了有关 Scala 编程语言的内容。到目前为止，我了解了以下有关 Scala 的概念：

*   在常规 JVM 上运行
*   与Java互操作
*   OOP 和函数式编程概念的结合
*   静态类型和可扩展
*   更少的代码，做更多的范例

我的要求很简单。我必须编写一个遵循一组应在运行时动态加载的预定义规则的业务模块。例如，A 公司有一套业务规则，B 公司有另一套。当不同的程序访问业务模块 API 时，它应该加载该特定公司的规则并响应服务。业务模块将涉及数据库访问和更多的内部 Web 服务调用以及广泛的 xml 解析。

我们需要这个模块尽可能地具有可扩展性。我可以使用 JAVA 的 AOP 概念，但它太复杂了。该代码将来将无法维护。

在这种情况下，Scala 是更好的选择吗？我什至在考虑 Node.js

请让我知道你的想法！

# android - 如何在 android 上使用 ffmpeg 创建播放器？

> ID：10330168
> 
> 赞同：0
> 
> 时间：2012-04-26T08:55:04.863
> 
> 标签：android, ffmpeg, android-mediaplayer

我已经为 android 编译了 ffmpeg 库，
可以指导我如何使用它在屏幕上显示视频。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T09:58:23.113

据我所知，ffmpeg 用于视频转换......用于显示视频使用 videoview 或 mediaplayer。

# matlab - 在 Matlab 中使用表中的变量名

> ID：10330169
> 
> 赞同：0
> 
> 时间：2012-04-26T08:55:10.853
> 
> 标签：matlab, variables, eval

我在 Matlab 中编写了一个小模型。该模型在一个需求节点中分析多个供应节点以满足所需的需求量。供应节点在一个向量中指定，其中每个时间步都有可用的供应。

为了满足需求，供应节点随后分析它们是否能够满足需求，并相应地更新从供应节点到需求节点的通量。此分析现在使用由脚本代码定义的固定顺序。在伪代码中：

```
for timestep=1:end
     if demand(timestep) > supply_1(timestep)
          supply_1_demand(timestep) = supply_1(timestep)
     else
          supply_1_demand(timestep) = demand(timestep)
     end

     if remaining_demand(timestep) > supply_2(timestep)
          supply_2_demand(timestep) = supply_2(timestep)
     else
          supply_2_demand(timestep) = demand(timestep)
     end

     # etcetera, etcetera
end 
```

但是，分析供应节点的顺序必须有所不同。我想从表格中读取此顺序，其中分析顺序由它们在表格中的显示顺序给出。因此，表格可以如下所示

```
 1   supply_4
 2   supply_1
 3   supply_5
 # etcetera 
```

有没有办法从这样的表中读取变量名？最好不要使用 eval，因为这非常慢（正如我听说的那样），并且模型将扩展到相当多的节点和通量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:37:43.357

也许你可以使用结构：

```
varNames={'supp_1','supp_2','supp_3'};
supply.(varNames{1}) = 3; %%% set a variable by name
display(supply.(varNames{1})) %%% get value by name

ans =
       3 
```

# c# - 将单行从一个数据表复制到另一个

> ID：10330173
> 
> 赞同：13
> 
> 时间：2012-04-26T08:55:19.447
> 
> 标签：c#, asp.net, ado.net, datatable, datarow

我有两个数据表，一个有几行，另一个是空的。我在第一个上运行循环以将一些行复制到另一个表。我收到错误“该行已经属于另一个表”。

有没有办法将DataRows一一复制到其他DataTable。

提前致谢

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-26T09:06:27.637

采用

```
newtable.ImportRow(oldtable.Rows[i]) 
```

哪里`i`是所需的行号。

如[http://support.microsoft.com/kb/308909/en-us中所述](http://support.microsoft.com/kb/308909/en-us)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T08:59:40.260

复制 ItemArray，当然只有在列相同时才有效

```
var dtCopyTo = new DataTable();
foreach(var rowCopyFrom in dtCopyFrom.Rows)
{
    var updatedDataRow = dtCopyTo.NewRow();
    updatedDataRow.ItemArray = rowCopyFrom.ItemArray;
    dtCopyTo.AddRow(updatedDataRow);
} 
```

ps：代码是在没有ide的情况下输入的，所以请检查语法

# php - 在 PHP 5.3.10 中将货币符号转换为 XML 十进制实体引用

> ID：10330177
> 
> 赞同：0
> 
> 时间：2012-04-26T08:55:34.900
> 
> 标签：php, xml, type-conversion, php-5.3, html-entities

无论如何，在 PHP 5.3.10 中，将货币符号转换为`£`它的 XML 十进制实体引用`&#163;`？

我可以为我的所有货币使用“地图”，但我认为这对于 htmlentities 或类似的东西是可能的。

这是在 XML 文档中使用的。

不幸的是，`htmlspecialchars`没有做我想要的。请参见下面的示例：

```
error_log('POUND SIGN');
error_log(htmlspecialchars('&pound;', ENT_QUOTES));

error_log('EURO SIGN');
error_log(htmlspecialchars('&#0128;', ENT_QUOTES));

error_log('DOLLAR SIGN');
error_log(htmlspecialchars('$', ENT_QUOTES)); 
```

生成：

```
[Thu Apr 26 14:06:56 2012] [error] [client 192.168.10.2] POUND SIGN
[Thu Apr 26 14:06:56 2012] [error] [client 192.168.10.2] &amp;pound;
[Thu Apr 26 14:06:56 2012] [error] [client 192.168.10.2] EURO SIGN
[Thu Apr 26 14:06:56 2012] [error] [client 192.168.10.2] &amp;#0128;
[Thu Apr 26 14:06:56 2012] [error] [client 192.168.10.2] DOLLAR SIGN
[Thu Apr 26 14:06:56 2012] [error] [client 192.168.10.2] $ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:04:05.577

如果要转换符号 html 实体，可以尝试使用该[`htmlspecialchars()`](http://php.net/manual/en/function.htmlspecialchars.php)函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T16:47:39.200

我所做的基本上是这样的：

```
public function getCurrencyXMLDecimalEntity(string $symbol): string 
{
    $map = array(
            '&pound;'   => '&#163;',    // £ - Great British Pounds
            '&#0128;'   => '&#8364;',   // € - Euro
            '$'         => '&#36;'      // $ - US Dollars
    );

    return $map[$symbol];                
} 
```

但这只是基本的 PHP，毫无疑问，它可以通过多种方式完成。不幸的是，它似乎没有内置的 PHP 函数。

# delphi - 如何创建虚拟可变文件？

> ID：10330192
> 
> 赞同：-1
> 
> 时间：2012-04-26T08:56:13.193
> 
> 标签：delphi

如何创建一个我可以处理对该文件的所有访问的文件。我的程序可以将请求的数据发送到从该文件读取并接收对该文件的所有写入的所有程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:01:51.237

在我看来，您需要使用 CreateFileMapping / MapViewOfFile 创建一个共享内存区域 - 您会在网络和书中找到许多示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T10:11:04.413

这个问题很模糊。

如果其他应用程序是您的，那么您可以选择其他一些进程间通信 (IPC) 机制而不是使用文件。或者您可以使用临时文件（使用特殊 TEMPORARY 属性创建的文件）。

如果其他应用程序不是您的并且希望该文件存在于磁盘上，那么您需要创建此文件，或者创建一个虚拟文件系统和一个磁盘或现有文件系统上的虚拟文件。要创建虚拟文件系统，您需要内核模式驱动程序（文件系统驱动程序）。要在现有磁盘上创建虚拟文件，您需要内核模式文件系统过滤器驱动程序。

内核模式驱动程序的创建既棘手又耗时，并且需要对 Windows 内部结构有很好的了解。作为选项之一，您可以使用我们的回调文件系统 (CBFS) 产品，它允许您在用户模式下创建虚拟文件系统（我们提供驱动程序）。但是 CBFS 对您的任务来说可能是一种过度杀伤力。

因此，您更好的选择是审查您的任务和要求，并找到另一种方式向其他应用程序提供数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T14:31:14.890

**NTFS 流：**

NTFS [Stream](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364404)可能是一个替代选项。

* * *

**[来自Windows Sysinternals](http://technet.microsoft.com/en-us/sysinternals/bb897440.aspx)的报价：**

> NTFS 文件系统为应用程序提供了创建 **替代信息数据流的**能力。默认情况下，所有数据都存储在文件的主要未命名数据流中，但是通过使用语法“文件：流”，您可以**读取和写入备用**...

* * *

**Stream 上的其他相关资源：**

*   [文件流](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364404)（Msdn 页面）
*   [此处](http://msdn.microsoft.com/en-us/library/windows/desktop/bb540537)提供了使用 Streams 的 c++ 代码示例。
*   [NTFS 流](http://www.auditmypc.com/ntfs-streams.asp)（在 AuditMyPC.com 上的条目）
*   [NTFS 备用流：内容、时间和方法](http://www.flexhex.com/docs/articles/alternate-streams.phtml#download)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T17:46:14.687

听起来你需要的是一个命名管道 [http://msdn.microsoft.com/en-us/library/windows/desktop/aa365150(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365150(v=vs.85).aspx)

# c# - jquery show/hide - 如果条件为真，则开始打开

> ID：10330194
> 
> 赞同：0
> 
> 时间：2012-04-26T08:56:19.740
> 
> 标签：c#, jquery, asp.net-mvc-3, jquery-ui

在我的 MVC3 razor 页面上处理用于过滤复选框的 jQuery 显示隐藏框。

我有一个页面，该页面会根据这些复选框是否被选中而改变，但如果有任何复选框未被选中，我希望它们保持打开状态。

目前显示/隐藏有效，但是如何根据是否选中任何复选框来确定页面是否加载显示/隐藏？

我可以返回一个布尔值来说明是否有任何未选中，并且真的在寻找一个 jQuery 天才来帮助我用最好/最整洁的方法来实现这一点。

这是其中一个过滤器的示例，其中 modeFilterList 是每个复选框的通用列表，包含名称、ID 和检查状态：

```
<div id="filterwrap">
    <h2 class="filter">Filter your results</h2>
    @using (Html.BeginForm())
    {
    <ul id="filter">
        <li>
            <h2>                            
                <a href="#">Modes</a></h2>
            <div class="filtercontent">
                @foreach (var item in modeFilterList)
                {
                    <div class="radiorow">
                        @Html.CheckBox("mode_" + item.ID, item.Checked)
                        @item.Name
                    </div>
                }   
            </div>
            <!-- end of filtercontent -->
        </li>
    </ul>
    }
</div> 
```

这是用于显示和隐藏的 jquery 代码：

```
$('#filterwrap li h2').live('click', function (e) {
    $(this).next('div.filtercontent').slideToggle() ;
    e.preventDefault();  //stops page jumping to top
}); 
```

我想过在页面重新加载时可以读取的 h2 下方包含一个包含真/假值的隐藏字段，但是必须有更好的方法来使用 jQuery 来做到这一点！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:05:13.737

您可以使用 Jquery toggle() 函数或 $("componentID").show() 或 hide() 函数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T10:23:35.663

好的，我对我提出的解决方案并不疯狂，所以如果有人有更好更整洁的解决方案，请告诉我。

因此，对于每个过滤器，我通过 viewbag 传递一个 bool 参数以显示是否已选择任何复选框。

```
bool modeStatus = ViewBag.modeStatus; 
```

然后我添加了一个带有类的隐藏字段：

```
<div id="filterwrap">
    <h2 class="filter">Filter your results</h2>
    @using (Html.BeginForm())
    {
    <ul id="filter">
        <li>
            @Html.Hidden("mode", modeStatus, new { @class = "filteritem" })
            <h2>                            
                <a href="#">Modes</a></h2>
            <div class="filtercontent">
                @foreach (var item in modeFilterList)
                {
                    <div class="radiorow">
                        @Html.CheckBox("mode_" + item.ID, item.Checked)
                        @item.Name
                    </div>
                }   
            </div>
            <!-- end of filtercontent -->
        </li>
    </ul>
    }
</div> 
```

和 (document).ready 中的这段代码

```
$("input.filteritem:hidden").each(function () {
    if ($(this).val() == "True") {            
        $(this).nextAll('div.filtercontent').show();
    }
}); 
```

# sql - 将数据从 txt 文件导入 SQL-Server 表的函数

> ID：10330204
> 
> 赞同：1
> 
> 时间：2012-04-26T08:57:09.433
> 
> 标签：sql, sql-server, function, import, text-files

我对 SQL Server 很陌生。我有一个 .txt 文件，其中的值分隔如下：

```
20120101;001;2;0;0;0;0;0;8
20120102;002;3;0;0;0;0;0;8
20120103;003;4;0;0;0;0;0;8
... 
```

该文件位于服务器中，我需要每天在同一时间自动导入此文件，并更新更改（文件每天都在更改）。我正在考虑制作一个功能来做到这一点，但我不知道这是否可能。

任何帮助，将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:04:49.290

```
insert into your_table
  SELECT a.*  
  FROM OPENROWSET( BULK 'c:\input.csv', FORMATFILE = 'c:\Format.fmt') AS a; 
```

示例`Format.fmt`

```
9.0
6
1       SQLCHAR     0     15   ";"      1     col1      SQL_Latin1_General_CP1_CI_AS
2       SQLCHAR     0     25   ";"      2     col2      SQL_Latin1_General_CP1_CI_AS
3       SQLCHAR     0     6    ";"      3     col3      SQL_Latin1_General_CP1_CI_AS
4       SQLCHAR     0     5    ";"      4     col4      SQL_Latin1_General_CP1_CI_AS
5       SQLCHAR     0     15   ";"      5     col5      SQL_Latin1_General_CP1_CI_AS
6       SQLCHAR     0     100  "\r\n"   6     col6      SQL_Latin1_General_CP1_CI_AS 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T09:59:57.803

您可以使用*SQL Server Integration Services (SSIS)*按计划导入平面文件。

这是一个循环遍历给定文件夹中所有相同格式的 CSV 文件并将它们加载到数据库中的示例。

[**处理完文件后，如何将文件移动到存档文件夹？**](https://stackoverflow.com/a/6703691/756519)

这是另一个例子：

[**Validate CSV file Data before import into SQL Server table in SSIS?**](https://stackoverflow.com/a/6484026/756519)

Following answer shows how to schedule an SSIS package to run from inside a SQL Server Agent job.

[**How do I create a step in my SQL Server Agent Job which will run my SSIS package?**](https://stackoverflow.com/a/6713464/756519)

Hope that gives you an idea.

# c# - 如果条件与实体框架

> ID：10330209
> 
> 赞同：2
> 
> 时间：2012-04-26T08:57:29.877
> 
> 标签：c#, .net, entity-framework

在我的 asp.net 应用程序中，我有两个页面，比如新学生和编辑学生。在新的学生页面上，我传递了一般详细信息，例如名字、姓氏、手机号码、电子邮件和注册号码。

这里的 RegNo 应该是唯一的。我正在使用实体框架进行数据库连接。我正在检查条件以避免输入相同的 RegNo，例如：

```
DataObject.Entities dataEntities = new DataObject.Entities();

if (!dataEntities.Students.Any(s => s.RegNo == RegNo))
{
    // my code here.
} 
```

尝试更改 RegNo 时，编辑选项的方法相同。如果分配给其他学生，则不应进入更新代码。

我知道如果我在这里使用相同的条件，它会失败，因为 RegNo 存在于该学生的数据库中（正在尝试更新的那个），所以如果 RegNo 分配给这个特定的学生而不是其他学生它应该被接受，否则应该去其他部分。

我不知道如何使用实体框架进行检查。任何人都可以帮助我吗？

我有一列`StudentId`，它是一个自动增量列

我试过了

```
if (!dataEntities.Students.Any(s => s.RegNo == RegNo && s.StudentId != StudentId))
{
} 
```

仍然无法正常工作......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:21:29.430

```
 if(!dataEntities.Students.Any(s=>s.RegNo == RegNo && s != studentBeingUpdated)) 
```

替换`studentBeingUpdated`为包含对您当前正在更新的学生的引用的变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:36:23.900

您可以在数据库级别设置.. 即如果您设置自动增量，那么您不需要编辑/重新分配 id 给其他人，也不需要为此单独管理。

如果我理解错误，请告诉我。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T12:23:56.593

我刚刚为学生表声明了一个对象并尝试了，

```
DataObject.Student student = dataEntities.Students.First(s => s.StudentId == 
                                                                     StudentId);

 if (!dataEntities.Students.Any(s => s.RegNo == RegNo &&
                                             s.StudentId != student.StudentId))
 {

 }
 else
 {
    throw new exception("RegNo already exists!");
 } 
```

它为我工作

# wpf - 使用 MEFedMVVM 在父视图/视图模型中实现视图模型优先方法

> ID：10330210
> 
> 赞同：0
> 
> 时间：2012-04-26T08:57:32.253
> 
> 标签：wpf, mef, datatemplate, mefedmvvm

[我正在使用 MEF 和名为MEFedMVVM](http://mefedmvvm.codeplex.com)的第三方库编写 WPF 应用程序。

我正在尝试创建一个设计，其中父视图模型具有一组子视图模型，并且我希望使用视图模型优先的方法，因为这将视图保持在视图模型之外，从而使代码保持更多视图模型-中心化且更可单元测试。

我已经阅读[了这个讨论](http://mefedmvvm.codeplex.com/discussions/270277)和关于使用 DataTemplate 作为视图的[讨论](http://mefedmvvm.codeplex.com/discussions/300184)，以及 Reed Copsy, Jr 的建议[，](http://social.msdn.microsoft.com/Forums/da/wpf/thread/a1ac2e19-9137-417d-8144-6562e51f5a09)即使用通用视图来查看模型映射资源。但是，我正在努力实现一些有效的东西。

我的父视图很简单：

```
<UserControl x:Class="MyParentView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:meffed="clr-namespace:MEFedMVVM.ViewModelLocator;assembly=MEFedMVVM.WPF"
             meffed:ViewModelLocator.ViewModel="MyParentViewModel" /> 
```

父视图模型派生自实现*IContextAware*的基本类型：

```
[ExportViewModel("MyParentViewModel")]
public class MyParentViewModel : ViewModelBase
{
    [ImportingConstructor]
    public MyParentViewModel()
    {
        var myChildVM = ServiceLocator.Current.GetInstance<MyChildViewModel>());
    }
} 
```

这是子视图模型：

```
[Export(typeof(MyChildViewModel))]
[ExportViewModel("MyChildViewModel", true)]
public class MyChildViewModel : ViewModelBase
{
} 
```

而这有对应的看法：

```
<UserControl x:Class="MyChildView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:meffed="clr-namespace:MEFedMVVM.ViewModelLocator;assembly=MEFedMVVM.WPF"
             meffed:ViewModelLocator.ViewModel="MyChildViewModel" /> 
```

最初，我认为在 MyChildViewModel 的 ExportViewModel 属性上指定第二个布尔参数*将使**一切*工作使用视图模型优先的方法，因为我的视图和视图模型在视图的 XAML 代码中被 MEFed 在一起。但是，事实证明并非如此，当我在*MyParentViewModel*构造函数中实例化*MyChildViewModel*对象时，实际上传递给**IContextAware.InjectContext()的是***MyParentView*对象。不是我期待和希望的*MyChildView对象。*显然，我需要添加一些东西来将它们连接在一起。谁能提供一个如何做到这一点的例子？

 *****谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-30T05:58:40.240

当您真的想首先使用视图模型时，您应该这样做：

```
[ExportViewModel("MyParentViewModel")]
public class MyParentViewModel : ViewModelBase
{
    // Create property for your child vm
    public MyChildViewModel Child {get; private set}

    // If you do MEF use constructor injection instead of servicelocator
    [ImportingConstructor]
    public MyParentViewModel(MyChildViewModel child)
    {
        this.Child = child;
    }
 } 
```

然后为您的 childvm 定义一个数据模板

```
 <DataTemplate DataType="{x:Type local:MyChildViewModel}">
     <view:MyChildViewUserControl />
 </DataTemplate> 
```

在您的 MainView 中，您知道要在哪里显示子数据，否则您将不需要子属性；）所以只需将 ContentControl 放在子数据应该去的位置并绑定到您的属性。

例如

```
<TabControl>
   <TabItem Header="MyChildData">
      <ContentControl Content="{Binding Child}" />
   </TabItem>
</TabControl> 
```

PS：代码是在没有 IDE 的情况下编写的，所以可能会出错 :)*****

# javascript - 如何使用 jQuery 在 PAGE LOAD 上获取元素的 id

> ID：10330213
> 
> 赞同：0
> 
> 时间：2012-04-26T08:57:51.113
> 
> 标签：javascript, jquery, jquery-selectors, jquery-events

我只知道如何获取点击元素的 id，就像这样：

```
$("button").click(function(){
console.log($(this).attr("id"));
} 
```

但是我该怎么做才能在网页加载时获取 id？看这个..

```
$("button").ready(function(){
console.log($(this).attr("id"));
} 
```

它返回整个文档对象和这个..

```
$("button").load(function(){
console.log($(this).attr("id"));
} 
```

根本什么都不做。

我想在加载时动态更改所有按钮的样式。

主项目比较复杂，我不想用 js core 来做，我想要 jQuery 选择器的简单性，但是等价的 js 方法值得赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T09:04:20.290

> 我想在加载时动态更改所有按钮的样式。

如果是这种情况，您可以简单地在加载时将 应用于`css`选择`button`器，而无需获取`id`每个按钮的 。

```
$(function() {
    $("button").css("background-color", "#C00");
}); 
```

或者更好的是，将 css 样式放入一个类中，然后将一个类应用于所有按钮：

```
$(function() {
    $("button").addClass("red-bg");
}); 
```

如果您确实想要`id`加载每个按钮的 ，则需要使用一个数组来满足可能有多个按钮的事实：

```
var buttonIds = $("button").map(function() {
    return this.id;
}).get(); 
```

但是，这是一种相当没有意义的方法，因为您无论如何都可以使用`each()`迭代`button`选择器来访问每个单独的按钮元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:08:57.260

您可以在 jquery 中获取所有按钮元素，然后在每个按钮元素上循环以更改其样式-：

```
$(function()
{
    var allButtons = $('button');
    $.each(allButtons,function(index,element)
    {
        $(element).css('width','100px');
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T10:34:21.017

我想你正在寻找这个：

```
 $(document).ready(function () {
            $(":button").each(function () {
                console.log($(this).attr("id"));
            })
        }); 
```

# ffmpeg - ffmpeg 每帧请求的位太多

> ID：10330215
> 
> 赞同：5
> 
> 时间：2012-04-26T08:57:57.430
> 
> 标签：ffmpeg, mp4, mov

我正在使用 ffmpeg 将视频转换为 mp4 格式。除 MOV 格式外，一切正常。

我用于一切的命令是：

`ffmpeg -i input.mov -strict experimental -sameq -s vga -aspect 1.7777 -vcodec libx264 -preset fast -crf 22 -y output.mp4`

但我不断得到的输出是：

```
ffmpeg version 0.9, Copyright (c) 2000-2011 the FFmpeg developers
built on Mar 12 2012 11:01:05 with gcc 4.4.5
configuration: --enable-libx264 --enable-gpl --disable-yasm
  libavutil    51\. 32\. 0 / 51\. 32\. 0
  libavcodec   53\. 42\. 0 / 53\. 42\. 0
  libavformat  53\. 24\. 0 / 53\. 24\. 0
  libavdevice  53\.  4\. 0 / 53\.  4\. 0
  libavfilter   2\. 53\. 0 /  2\. 53\. 0
  libswscale    2\.  1\. 0 /  2\.  1\. 0
  libpostproc  51\.  2\. 0 / 51\.  2\. 0
[mov,mp4,m4a,3gp,3g2,mj2 @ 0x21767a0] Referenced QT chapter track not found

Seems stream 0 codec frame rate differs from container frame rate: 30.00 (30/1) -> 30.07 (2225/74)
Input #0, mov,mp4,m4a,3gp,3g2,mj2, from 'input.mov':
  Metadata:
    creation_time   : 2009-04-04 07:12:29
    comment         : EASTMAN KODAK COMPANY  KODAK Z1275 ZOOM DIGITAL CAMERA
    comment-eng     : EASTMAN KODAK COMPANY  KODAK Z1275 ZOOM DIGITAL CAMERA
  Duration: 00:00:17.76, start: 0.000000, bitrate: 8100 kb/s
    Stream #0:0(eng): Video: mpeg4 (Advanced Simple Profile) (mp4v / 0x7634706D), yuv420p, 1280x720 [SAR 1:1 DAR 16:9], 7968 kb/s, 30.07 fps, 30.07 tbr, 8544k tbn, 30 tbc
    Metadata:
      creation_time   : 2009-04-04 07:12:29
      handler_name    : 
    Stream #0:1(eng): Audio: pcm_mulaw (ulaw / 0x77616C75), 16000 Hz, 1 channels, s16, 128 kb/s
    Metadata:
      creation_time   : 2009-04-04 07:12:29
      handler_name    : 
[buffer @ 0x2187f00] w:1280 h:720 pixfmt:yuv420p tb:1/1000000 sar:1/1 sws_param:
[scale @ 0x219c120] w:1280 h:720 fmt:yuv420p -> w:640 h:480 fmt:yuv420p flags:0x4
[libx264 @ 0x2190d20] using SAR=4/3
[libx264 @ 0x2190d20] using cpu capabilities: none!
[libx264 @ 0x2190d20] profile High, level 3.0
[libx264 @ 0x2190d20] 264 - core 120 - H.264/MPEG-4 AVC codec - Copyleft 2003-2012 - http://www.videolan.org/x264.html - options: cabac=1 ref=2 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=6 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=12 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=1 keyint=250 keyint_min=25 scenecut=40 intra_refresh=0 rc_lookahead=30 rc=crf mbtree=1 crf=22.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
[aac @ 0x21917e0] Too many bits per frame requested
Output #0, mp4, to 'output.mp4':
  Metadata:
    creation_time   : 2009-04-04 07:12:29
    comment         : EASTMAN KODAK COMPANY  KODAK Z1275 ZOOM DIGITAL CAMERA
    comment-eng     : EASTMAN KODAK COMPANY  KODAK Z1275 ZOOM DIGITAL CAMERA
    Stream #0:0(eng): Video: h264, yuv420p, 640x480 [SAR 4:3 DAR 16:9], q=-1--1, 90k tbn, 30.07 tbc
    Metadata:
      creation_time   : 2009-04-04 07:12:29
      handler_name    : 
    Stream #0:1(eng): Audio: aac, 16000 Hz, 1 channels, s16, 128 kb/s
    Metadata:
      creation_time   : 2009-04-04 07:12:29
      handler_name    : 
Stream mapping:
  Stream #0:0 -> #0:0 (mpeg4 -> libx264)
  Stream #0:1 -> #0:1 (pcm_mulaw -> aac)
Error while opening encoder for output stream #0:1 - maybe incorrect parameters such as bit_rate, rate, width or height 
```

似乎问题在于每帧的音频位。哪个可能是正确的解决方案？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-27T06:03:13.283

" `Too many bits per frame requested`" 错误来自本机 FFmpeg AAC 编码器 ( `-c:a aac`)。您可以使用以下一种或多种解决方案：

# 更新您的`ffmpeg`

开发非常活跃，原生 FFmpeg AAC 编码器有了很多改进；**它现在会自动钳制到每帧的最大位数，而不是因为这个错误而失败**。请参阅[FFmpeg 下载](https://ffmpeg.org/download.html)页面以获取指向已编译二进制文件的链接，这是获取最新`ffmpeg`.

## 如果你被一个旧的、过时的、古老的`ffmpeg`：

*   增加音频采样率，例如添加`-ar 44100`.

*   降低比特率。默认可能是`-b:a 128k`. 尝试较低的值，直到它起作用。

*   用于`-c:a copy`流[式复制](https://ffmpeg.org/ffmpeg.html#Stream-copy)（重新复用）音频，并且由于 MP4 不支持`pcm_mulaw`，使用不同的输出容器格式，例如 Matroska ( `.mkv`)。

*   使用不同的 AAC 编码器，`libfdk_aac`如果您`ffmpeg`支持的话。

如果升级，则无需执行任何这些选项`ffmpeg`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T19:09:35.553

我希望 ffmpeg 比这更聪明，但您可以尝试为您的`-s`and`-aspect`选项指定视频流：`-s:v`和`-aspect:v`.

或者，由于您没有对音频做任何特殊处理，您可以使用`-c:a copy`.

# c# - 将奇怪的日期格式转换为短 DateTime

> ID：10330219
> 
> 赞同：1
> 
> 时间：2012-04-26T08:58:01.567
> 
> 标签：c#, javascript, asp.net, html

我有一个从 ExtJS 日期时间选择器返回的日期字符串，如下所示：

```
Wed Apr 25 2012 00:00:00 GMT+0300 (GTB Daylight Time) 
```

从这里我需要使用 C# 或 JavaScript 以这种格式：YYYY-mm-dd。我怎么能这样做？我试过使用 DateTime.Parse 并且无法解析。任何的想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T09:24:33.210

您似乎并不关心时间和时区信息，因此您实际上可以`DateTime.ParseExact`用来解析日期。假设月份部分可能只是一个数字（例如 2012-04-01 是`Sun Apr 1 2012`），您需要使用的模式是`ddd MMM d yyyy`.

“最难”的部分实际上是切割时间和时区部分。如果月份中的日期是一位数，则必须取长度为 14 的子字符串；否则长度为 15。这是一种获取字符串中第 4 个空格字符的索引的方法：

```
var str = "Wed Apr 25 2012 00:00:00 GMT+0300 (GTB Daylight Time)";
var index = -1;
for (var i = 0; i < 4; i += 1)
  index = str.IndexOf(' ', index + 1); 
```

然后，您可以将日期解析为`DateTime`：

```
var date = DateTime
  .ParseExact(str.Substring(0, index), "ddd MMM d yyyy", CultureInfo.InvariantCulture); 
```

可以使用您需要的任何格式和文化将其格式化回字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T09:10:41.563

在 .NET 中，您有一个具有**保证**格式的日期的字符串表示形式，您可以使用[`DateTime.ParseExact`](http://msdn.microsoft.com/en-us/library/w2sa9yss.aspx)它来解析它：

```
var input  = "Wed Apr 25 2012 00:00:00 GMT+0300 (GTB Daylight Time)"
                            .Substring(0, 15);
var format = "ddd MMM dd YYYY";
var date = DateTime.ParseExact(input, format, CultureInfo.InvariantCulture);

// Now date is a DateTime holding the date

var output = date.ToString("yyyy-MM-dd");

// Now output is 2012-04-25 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T09:02:53.050

可能这可以帮助你[点击](http://www.csharp-examples.net/string-format-datetime/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T09:04:15.723

在 JavaScript 中

```
new Date("Wed Apr 25 2012 00:00:00 GMT+0300 (GTB Daylight Time)") 
```

会给你一个日期对象。然后，您可以通过选择 (UTC) 年、月和日，将其格式化为您的日期格式（或者最好是 ISO8601，或使用 .getTime() 从 epoc 开始的毫秒数）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-04-26T09:06:49.150

尝试使用 Javascript。

```
var d = new Date('Wed Apr 25 2012 00:00:00 GMT+0300 (GTB Daylight Time)');
var curr_day = d.getDate();
var curr_month = ('0'+(d.getMonth()+1)).slice(-2)
var curr_year = d.getFullYear();
var new_date  = curr_year+"-"+curr_month+"-"+curr_day; 
```

# sql - 在 SQL Server 中将 XML 转换为 XML 数据类型

> ID：10330221
> 
> 赞同：2
> 
> 时间：2012-04-26T08:58:04.333
> 
> 标签：sql, sql-server, xml, sql-server-2008, tsql

我有一个名为标签的表，如下所示：

```
 --------------------
|TagId   |   TagName |
--------------------
| 1      |   Travel  |
 --------------------
| 2      |   Gadgets |
 --------------------
| 3      |   Hobbies |
 --------------------
| 4      |   Movies  |
 -------------------- 
```

我还有另一个表，其中有一个名为标签的 XML 数据类型列。

```
 -------------------------------------------------------------------------
   |PostId   |   Title          | Tags                                       |
    -------------------------------------------------------------------------
   | 1       |  Blog Post 1     | <xml><tags><tag>1</tag/><tag>2</tag></tags>|
   --------------------------------------------------------------------------
   | 2       |  Blog Post 2     | <xml><tags><tag>2</tag/><tag>3</tag></tags>|
   --------------------------------------------------------------------------
   | 3       |  Blog Post 3     | <xml><tags><tag>3</tag/><tag>4</tag></tags>|
   -------------------------------------------------------------------------- 
```

我想组合这两个表中的数据，以创建一个视图，如下所示。节点内的数字应该作为标签表的外键。

```
 ---------------------------------------------------------------------------
   | Title         | Tags                                                      |
    ---------------------------------------------------------------------------
   | Blog Post 1   | <xml><tags><tag>Travel</tag/><tag>Gadgets</tag><tags>     |
   ----------------------------------------------------------------------------
   | Blog Post 2   | <xml><tags><tag>Gadgets</tag/><tag>Hobbies</tag></tags>   |
   ----------------------------------------------------------------------------
   | Blog Post 3   | <xml><tags><tag>Hobbies</tag/><tag>Movies</tag></tags>    |
   ---------------------------------------------------------------------------- 
```

是否可以创建这样的视图？我怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T10:02:01.080

这样的事情应该可以解决问题：

```
/* SQL Follows */
select
postID, title,
tags,
(
    select 
        /* 4\. Retrieve the tag name */
        y.tag.value('.', 'int') tagID,
        t.tagName
    from 
        /* 2\. Shred the XML into nodes */
        p.tags.nodes('/xml/tags/tag') as y(tag)
        /* 3\. Join the tag ID onto the tags table. */
        inner join #tags t on t.tagID = y.tag.value('.', 'int')
    for 
        /* 5\. Convert it into XML */
        xml path('tag'), type
)tags2
/* 1\. For each post */
from #posts p 
```

我在这个例子中`#tags`使用了临时表。`#posts`要获得准确的输出，您需要稍微调整 XML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:47:10.733

好吧，我不会提供完整的解决方案，因为我不知道您的数据如何。我敢肯定它并不像您展示的那么简单，但我想我可以为您指明正确的方向。

我会对您的完整字符串进行替换，查找 ID（不要只查找 1，因为例如您可以有 11 并且会失败），然后将其替换为 select where tagID=ID

```
select replace('<xml><tags><tag>1</tag/><tag>2</tag></tags>','<tag>1</tag/>',(select name from tags where tagid=1)) 
```

结果：

```
<xml><tags>Travel<tag>2</tag></tags> 
```

当然，您需要对每个标签执行此操作，而不是由您决定如何执行此操作。您可以查看标签表，或者如果您只有几个标签，请运行替换几次

# ruby-on-rails - Rails 国际化需要精确的格式

> ID：10330227
> 
> 赞同：0
> 
> 时间：2012-04-26T08:58:52.217
> 
> 标签：ruby-on-rails, internationalization

我开始在 Rails 中使用 I18n，我有 2 个问题：这是一个将两个问题分组的小示例：

```
en:
  format: ! '%{attribute} %{message}'
fr: 
  errors:&errors 
    format:Le %{attribute} %{message} 
```

第一个问题是第一个翻译中的“！”是什么意思。第二个是如何使用格式翻译。如果我收到错误，在法语中，错误格式将是 '%{attribute} %{message}' 并且“Le”不会出现在任何地方。

我查看了rails guide，但没有找到任何东西。

谢谢您的帮助

斯蒂芬。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-01T09:46:48.177

开头是 YAML的`!`一些语法糖（基本上是因为您的字符串以应该转义的字符开头 : `%`。

请注意，您的法语翻译适用于 rails 3+，如果您使用的是 2.3，则需要以下内容：

```
fr:
  activerecord:
    errors:
      full_messages:
        format: "Le %{attribute} %{message}" 
```

# twitter-bootstrap - Twitter Bootstrap + 更少

> ID：10330230
> 
> 赞同：0
> 
> 时间：2012-04-26T08:59:02.327
> 
> 标签：twitter-bootstrap, less

我是一名网页设计师新手，刚刚发现 LESS 和 Twitter 的引导程序。如文档中所述，它说可以使用 LESS 修改引导程序。

我的问题是，如何使用 LESS 修改/自定义引导程序？我通常使用 javascript 编译较少。是否有任何好的教程链接/系列教如何最大化引导程序定制？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T01:06:39.243

它不是特定于引导程序的，但[lesscss.org](http://lesscss.org/)网站也有一些很好的信息。我认为“[用法](http://lesscss.org/#usage)”部分与您的问题特别相关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T12:24:33.693

引导页面上有一个冗长的文档可供您浏览。它列出了您可以根据自己的喜好轻松识别和修改的大多数变量和 mixin。

您可以在此处找到文档：[将 LESS 与 Bootstrap 一起使用](http://twitter.github.com/bootstrap/less.html)。

在引导程序文档页面上还有一个下载部分，您可以在其中修改默认样式并在网站上根据自己的喜好自定义引导程序，然后将所有内容下载到自定义包中。

您可以在此处找到自定义下载部分：[自定义和下载](http://twitter.github.com/bootstrap/download.html)

# c# - C#加载JPG文件，提取BitmapImage

> ID：10330239
> 
> 赞同：15
> 
> 时间：2012-04-26T08:59:26.760
> 
> 标签：c#, image-processing, bitmap, jpeg, bitmapimage

我正在尝试从 JPG 中提取 BitmapImage。这是我的代码：

```
FileStream fIn = new FileStream(sourceFileName, FileMode.Open); // source JPG
Bitmap dImg = new Bitmap(fIn);
MemoryStream ms = new MemoryStream();
dImg.Save(ms, ImageFormat.Jpeg);
image = new BitmapImage();
image.BeginInit();
image.StreamSource = new MemoryStream(ms.ToArray());
image.EndInit();
ms.Close(); 
```

image 以 0 × 0 的图像返回，这当然意味着它不起作用。我该怎么做呢？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-04-26T09:03:27.907

试试这个：

```
public void Load(string fileName) 
{

    using(Stream BitmapStream = System.IO.File.Open(fileName,System.IO.FileMode.Open ))
    {
         Image img = Image.FromStream(BitmapStream);

         mBitmap=new Bitmap(img);
         //...do whatever
    }
} 
```

或者你可以这样做（[来源](http://www.vcskicks.com/image-from-file.php)）：

```
Bitmap myBmp = Bitmap.FromFile("path here"); 
```

# r - 合并数据框并包含重复行

> ID：10330241
> 
> 赞同：1
> 
> 时间：2012-04-26T08:59:30.493
> 
> 标签：r, merge, dataframe

我有几个数据框，例如

```
>data1
     pearson     fisher      yates  mec
1 0.01141204 0.02857143 0.05777957 2.50
2 0.02609829 0.04761905 0.11203684 2.25
3 0.05280751 0.07619048 0.19670560 2.00
4 0.09742169 0.16666667 0.31998422 1.75
5 0.16754628 0.42857143 0.49015296 1.50
6 0.27332168 0.44444444 0.71500065 1.25
7 0.42919530 1.00000000 1.00000000 1.00
8 0.65790502 1.00000000 0.65790502 0.75
9 1.00000000 1.00000000 0.29184055 0.50

> data2
     pearson     fisher     yates  mec
1 0.02609829 0.04761905 0.1120368 2.25
2 0.05777957 0.20634921 0.2059032 2.50
3 0.11203684 0.24242424 0.3403557 2.25
4 0.19670560 0.52380952 0.5186050 2.00
5 0.31998422 0.52380952 0.7402693 1.75
6 0.49015296 1.00000000 1.0000000 1.50
7 0.71500065 1.00000000 0.7150007 1.25
8 1.00000000 1.00000000 0.4291953 1.00
9 0.65790502 1.00000000 0.6579050 0.75 
```

当我尝试合并这两个数据框时，这是我得到的：

```
> merge(data1, data2, all=TRUE)
      pearson     fisher      yates  mec
1  0.01141204 0.02857143 0.05777957 2.50
2  0.02609829 0.04761905 0.11203684 2.25
3  0.05280751 0.07619048 0.19670560 2.00
4  0.05777957 0.20634921 0.20590321 2.50
5  0.09742169 0.16666667 0.31998422 1.75
6  0.11203684 0.24242424 0.34035574 2.25
7  0.16754628 0.42857143 0.49015296 1.50
8  0.19670560 0.52380952 0.51860502 2.00
9  0.27332168 0.44444444 0.71500065 1.25
10 0.31998422 0.52380952 0.74026928 1.75
11 0.42919530 1.00000000 1.00000000 1.00
12 0.49015296 1.00000000 1.00000000 1.50
13 0.65790502 1.00000000 0.65790502 0.75
14 0.71500065 1.00000000 0.71500065 1.25
15 1.00000000 1.00000000 0.29184055 0.50
16 1.00000000 1.00000000 0.42919530 1.00 
```

我需要得到 18 行，但我得到了 16 行，我有重复的行，我想将它们保留在数据集中。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-28T09:23:44.057

**编辑**忽略这个答案。`merge`给出所需的输出。

`rbind()`将两个数据框放在一起，将两者的所有行都保留在新数据框中。此外，如果您使用 重新标记您的问题，您可能会得到更多的回复和及时的回复`r`。

首先，将您的两个数据集放入`r`：

```
data1 = read.table(text = "
 pearson    fisher     yates      mec
 0.01141204 0.02857143 0.05777957 2.50
 0.02609829 0.04761905 0.11203684 2.25
 0.05280751 0.07619048 0.19670560 2.00
 0.09742169 0.16666667 0.31998422 1.75
 0.16754628 0.42857143 0.49015296 1.50
 0.27332168 0.44444444 0.71500065 1.25
 0.42919530 1.00000000 1.00000000 1.00
 0.65790502 1.00000000 0.65790502 0.75
 1.00000000 1.00000000 0.29184055 0.50", sep = "", header = TRUE)

data2 = read.table(text = "
 pearson     fisher     yates  mec
 0.02609829 0.04761905 0.1120368 2.25
 0.05777957 0.20634921 0.2059032 2.50
 0.11203684 0.24242424 0.3403557 2.25
 0.19670560 0.52380952 0.5186050 2.00
 0.31998422 0.52380952 0.7402693 1.75
 0.49015296 1.00000000 1.0000000 1.50
 0.71500065 1.00000000 0.7150007 1.25
 1.00000000 1.00000000 0.4291953 1.00
 0.65790502 1.00000000 0.6579050 0.75", sep = "", header = TRUE)

data.merge = rbind(data1, data2) 
```

# mysql - 加入更多父表

> ID：10330253
> 
> 赞同：1
> 
> 时间：2012-04-26T09:00:04.357
> 
> 标签：mysql, sql, join

我有 8 个主表，每个表有大约 60 万条记录。

让我们说表名是

```
type_11_14 
type_12_15
type_13_16
type_4_5
type_6
type_7
type_8
type_10 
```

每个表都有**代码**和**名称**列。**代码**是**主键**。我无法将所有这些表格组合起来制作一张表格。

在上面的表格中，**type_11_14** 有 11 和 14 条记录，**type_7** 有 7 条记录

我还有其他表**all_types_count**。它具有上述类型的计数信息。对于给定的类型和代码列表（我们给出的最大代码是 50），我需要获取它的**名称、类型、代码和计数**

我用 UNION 编写了以下查询。查询运行正常。但是如果我运行解释计划，我会得到

**错误 无法启用约束。一行或多行包含违反非空、唯一或外键约束的值。**

再次在下面的查询中，我查询**all_types_count**表 8 次。相反，我想先从**all_types_count**获取所有记录，然后加入主表以获得所需的结果..

不知道什么是最好的 SQL 查询解决方案。有人可以为我提供最好的方法吗？

```
SELECT type,code,total_count,type_11_14.name 
FROM all_types_count,type_11_14 
WHERE all_types_count.type in (11,14) 
AND all_types_count.code=type_11_14.code 
AND all_types_count.code in ( 3456,6789)

UNION ALL

SELECT type,code,total_count,type_12_15.name 
FROM all_types_count,type_12_15 
WHERE all_types_count.type in (12,15) 
AND all_types_count.code=type_12_15.code 
AND all_types_count.code in ( 2345,9087,234)

UNION ALL

SELECT type,code,total_count,type_13_16.name 
FROM all_types_count,type_13_16 
WHERE all_types_count.type in (13,16) 
AND all_types_count.code=type_13_16.code 
AND all_types_count.code in ( 98,24)

UNION ALL

SELECT type,code,total_count,type_4_5.name 
FROM all_types_count,type_4_5 
WHERE all_types_count.type in (4,5) 
AND all_types_count.code=type_4_5.code  
AND all_types_count.code in ( 765,9087,3456)

UNION ALL

SELECT type,code,total_count,type_6.name 
FROM all_types_count,type_6 
WHERE all_types_count.type=6 
AND all_types_count.code=type_6.code  
AND all_types_count.code in ( 5563,323,434,3442)

UNION ALL

SELECT type,code,total_count,type_7.name 
FROM all_types_count,type_7 
WHERE all_types_count.type=7 
AND all_types_count.code=type_7.code  
AND all_types_count.code in ( 7887,313,23,32,21)

UNION ALL

SELECT type,code,total_count,type_8.name 
FROM all_types_count,type_8 
WHERE all_types_count.type=8 
AND all_types_count.code=type_8.code  
AND all_types_count.code in ( 9988,1221)

UNION ALL

SELECT type,code,total_count,type_10.name 
FROM all_types_count,type_10 
WHERE all_types_count.type=10 
AND all_types_count.code=type_10.code  
AND all_types_count.code in ( 7787,23213) 
```

谢谢你

基兰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T21:00:04.807

如果将查询写为：

```
SELECT type,code,total_count,type_11_14.name 
FROM all_types_count 
left outer join type_11_14 
     on all_types_count.type in (11,14) 
     and all_types_count.code=type_11_14.code 
     and all_types_count.code in ( 3456,6789) 
left outer join type_12_15 
     on all_types_count.type in (12,15) 
     and all_types_count.code=type_12_15.code 
     and all_types_count.code in ( 2345,9087,234) 
left outer join  . . . 
```

如果你不熟悉 join/left outer join/right outer join/cross join 语法，那么你应该学习它。

在您的原始查询中，优化器很可能会为每个子查询读取一次 all_types_count 表。使用连接，它应该只读取一次，并在需要时加入其他表。

# html - 如何强制图像相对于固定表格单元格调整大小

> ID：10330260
> 
> 赞同：1
> 
> 时间：2012-04-26T09:00:24.243
> 
> 标签：html, image, html-table, formatting, cell

我一直在网上四处寻找，试图找出如何将使用 PHP 回显的图像放入表格中，但表格单元格的大小是固定的，我希望我可以让图像按比例调整大小在表格单元格内修复。图像的大小会有所不同，因此我希望它会看到图像的最大相对高度或宽度并相应地显示，因此最后在宽度或高度上可能会有一点差距，但图像将被重新调整大小并显示在设置的表格单元格。任何指针将不胜感激。

这是我当前表格的 PHP 代码，但没有固定大小：

```
<?php
foreach($searchResult1 as $row){
?>  
<tr> 
    <td><b>Seller: </b><?php echo $row['Owner'];?></td>
    <td><b>Asking Price: </b><?php echo $row['AskingPrice'];?></td>
</tr>
<tr>
    <td><img src="images/<?php echo $row['PropertyID'];?>.jpg"></td>
    <td><b>Town or City: </b><?php echo $row['Town'];?></td>
    <td><b>Post Code: </b><?php echo $row['PostCode'];?></td>
</tr>
<tr>
    <td><b>Address: </b><?php echo $row['PropertyAddress'];?></td>
</tr>
<tr>
    <td><b>Description: </b><?php echo $row['Description'];?></td>
</tr>
<tr>
    <td><b>Property ID: </b><?php echo $row['PropertyID'];?></td>
    <td><b>Email: </b><?php echo $row['ContactEmail'];?></td>
    <td><b>Contact: </b><?php echo $row['ContactNumber'];?></td>
</tr>
<tr>

    <td><input type="button" value="Save" onClick="savePropertyButton(<?php echo $row['PropertyID'] ?>);" >
</tr>   

<?php
}
?>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:06:00.083

使用 css 并将图像的宽度设置为 100%。

例子：

```
table img {
    width: 100%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:47:05.157

这取自[http://www.lamp-tips.com/programming/php/how-do-i-resize-all-of-the-images-in-a-table-in-a-php-script/](http://www.lamp-tips.com/programming/php/how-do-i-resize-all-of-the-images-in-a-table-in-a-php-script/)

这让我询问了我最初的问题，因为这听起来像只使用 HTML 和表格验证来做我想做的事情是不可能的。正如任何人对这个人的解决方案有任何经验一样。谢谢

如果您打算以一种有效的方式使用 php 来更好地显示数据，您可以让 PHP 生成表格数据并将图像调整为 200 像素宽的缩略图以输出。

为此，您将创建一个包含所有图像路径的数组。然后循环遍历数组以构建表格数据，当您循环遍历它时，检查服务器上是否存在缩略图，如果存在，则显示它。如果没有，请调用函数来调整图像大小并生成缩略图。

# python - 如何在python中连接到远程mysql服务器

> ID：10330264
> 
> 赞同：0
> 
> 时间：2012-04-26T09:00:37.847
> 
> 标签：python, mysql, python-2.7

嗨，我有一个需要连接到远程 mysql 服务器的要求。我的应用程序将在本地计算机上运行，​​我的 mysql 将在远程服务器上运行。我尝试了以下代码：

```
DB = 'gts'
DB_HOST = 'ps95074.dreamhost.com'
DB_USER = 'root'
DB_PASSWORD = 'dbadminpassword'
conn = MySQLdb.Connection(db=DB, host=DB_HOST, user=DB_USER,passwd=DB_PASSWORD)
cursor = conn.cursor() 
```

但我收到以下错误

```
OperationalError: (2005, "Unknown MySQL server host 'ps95074.dreamhost.com' (1)") 
```

相反，如果我使用

```
DB_HOST='localhost' 
```

一切正常。远程主机怎么可能做到这一点。任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:04:54.173

检查你的防火墙。该服务器在线并可从任何机器访问：

```
> mysql -h ps95074.dreamhost.com
ERROR 1045 (28000): Access denied for user 'myuser'@'myhost' (using password: NO) 
```

但是，即使您可以连接，您的数据库用户也只允许本地连接。

更新：我刚刚再次尝试，现在使用命令行客户端也失败了。很明显，您的服务器出了点问题。

# css - cssClass 显示为未定义

> ID：10330268
> 
> 赞同：1
> 
> 时间：2012-04-26T09:01:12.577
> 
> 标签：css, visual-studio, visual-studio-2010

我认为这并不重要，因为它有效。但我只是想知道为什么有时在 html 中它看起来像一个 CssClass 不存在，当它存在时.. ![在此处输入图像描述](../Images/3863e7f3aad227bfbf1eb0784202deec.png)

当我运行应用程序时，该类中的所有 css 数据都已到位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:04:09.057

这只是 Visual Studio 智能感知的一个问题，我自己也遇到过几次。我觉得这没什么好担心的。

重新启动软件并重新打开应用程序应该可以解决问题。

但是，这可能取决于您如何在页面中包含样式表。如果您以编程方式包含此内容，则 Visual Studio 将无法理解这一点，因此不会在其智能感知中提取样式，它只会从包含在`head`标签中的 StyleSheet 中提取样式作为`link`元素。

# ios - 如何将 Apple Development Centificate 更新到 Provisioning Center

> ID：10330273
> 
> 赞同：3
> 
> 时间：2012-04-26T09:01:55.617
> 
> 标签：ios, xcode, certificate, provisioning

我的开发证书即将到期。我采取行动并通过支付金额续订了我的会员资格，现在收到了来自 Apple 的邮件，上面写着“感谢您续订 Apple Developer Program”。有几个细节，比如新的到期日期和我的团队 ID。

仍然当我用我的苹果 ID 登录到配置中心时，我没有看到我的新证书在那里列出。所以我的问题是，我该怎么做才能把它放进去？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:09:03.233

我几天前才这样做。我不得不去供应门户并生成一个新的。对于分发，我不得不撤销现有的。

这似乎不对，但这是我找到的唯一方法。

# objective-c - GCD 和 for 循环

> ID：10330275
> 
> 赞同：1
> 
> 时间：2012-04-26T09:02:03.120
> 
> 标签：objective-c, ios, for-loop, grand-central-dispatch, glkit

我想知道使用 for 循环和使用 GCD 的功能有什么区别，并且`dispatch_apply`在文档和问题中都找不到答案。

此外，在运行时情况下使用 GCD 函数作为 GLKit 渲染/更新方法会产生更好的结果吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:03:54.927

该文件指出：

> dispatch_apply() 函数通过类似原语的“for (;;)”循环提供数据级并发：

这意味着 dispatch_apply 调用的代码块不会像 for 那样被顺序调用，而是可以并发执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T11:15:26.307

> 此外，在运行时情况下使用 GCD 函数作为 GLKit 渲染/更新方法会产生更好的结果吗？

回答这个问题的唯一方法是尝试并衡量性能。

# android - 扩展文件的CRC错误

> ID：10330283
> 
> 赞同：2
> 
> 时间：2012-04-26T09:02:35.913
> 
> 标签：android, zip, crc, expansion

成功上传和下载扩展文件[Apk 外部数据，Android 扩展](https://stackoverflow.com/questions/10327532/apk-external-data-android-expansion)

但现在我在解压缩文件时面临*CRC 。*

没有得到确切的问题所在，谷歌将我的文件重命名为`.obb`

寻找解决方法（如果有）？

**更新**

此处定义的完整说明[创建APK扩展文件的步骤](https://stackoverflow.com/questions/11715855/steps-to-create-apk-expansion-file/11717019#11717019)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T05:02:18.367

修复了它，我只是跳过检查 CRC32 算法并且它工作得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-14T20:10:07.853

[我怀疑你和这个问题](https://stackoverflow.com/questions/9928334/android-apk-expansion-files-gives-crc-error-after-downloading-file)有同样的问题。简而言之，示例代码不适用于压缩的 zip 文件。

# web-services - 多少 gzipping 负担客户端？

> ID：10330286
> 
> 赞同：1
> 
> 时间：2012-04-26T09:02:40.517
> 
> 标签：web-services, gzip

我正在优化我们的网络服务，并且听说过 gzip。

如果我们可以使用 gzip 减少网络负载会很好，但我有点担心它会给客户端带来多少解包开销。

特别是，我们的服务经常使用 javascript - 这意味着在 Web 浏览器中渲染页面会消耗 CPU 时间。

我不能确定花 cpu 时间解压缩 gzip 数据包（而不是处理 javascript）仍然会给我们的服务带来积极的影响。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:18:38.297

诸如 HTML 和 javascript 库之类的东西，尤其是静态文件，是很好的压缩候选者。图像不是 - 它们已经被压缩。

与大多数互联网连接相比，gzip 压缩数据的解压速度非常快——在我的 PC（AMD phenom 2.8GHz）上进行的快速测试导致单核解压速度约为 170m/秒。因此，现代 PC 上的现代浏览器将在大约 2 毫秒内解压缩约 200k 的 javascript 文件，而 javascript 通常会压缩到其原始大小的 25% 左右（如果已经缩小，则约为 35%）。

当然，您的网络负载中有多少比例是由解压缩的 javascript 组成的，这是另一回事。

# java - Android从文件中读取大字符串

> ID：10330287
> 
> 赞同：1
> 
> 时间：2012-04-26T09:02:40.873
> 
> 标签：java, android

在我的应用程序中，当它加载时，它会进行一个 Web 调用来检索 JSON 字符串。我想将此 JSON 字符串存储到手机中，这样如果用户失去连接，应用程序就不会崩溃。需要 JSON 字符串来设置应用程序的文本。所以我正在这样做

```
 File myDir = new File(getFilesDir().getAbsolutePath());

                FileWriter fw = new FileWriter(myDir + "/jsonMain.txt");
                fw.write(sJsonMain);
                fw.close(); 
```

然后检索它我正在这样做

```
 BufferedReader br = new BufferedReader(new FileReader(
                            myDir + "/jsonMain.txt"));
                    sStoredJSON = br.readLine(); 
```

它适用于其他 JSON 字符串，但不适用于大型 JSON 字符串。我检查了日志，上面写着

> 04-26 10:00:44.511: I/global(893): BufferedReader 构造函数中使用的默认缓冲区大小。如果需要 8k 字符的缓冲区，最好是明确的。

有人可以告诉我我还能如何阅读这样的大字符串吗？

提前致谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T09:07:05.990

尝试这个：

```
BufferedReader br = new BufferedReader(new FileReader(
                        myDir + "/jsonMain.txt"), 8); // or a higher value than 8
sStoredJSON = br.readLine(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:14:47.187

您可以在 BufferedReader[构造函数](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/BufferedReader.html#BufferedReader%28java.io.Reader,%20int%29)中添加缓冲区大小，因此您可以使用之前的 File 对象来确定文件[长度](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/File.html#length%28%29)并相应地创建缓冲区大小。

# android - Sencha Touch 2 原生安卓应用启动白屏

> ID：10330289
> 
> 赞同：0
> 
> 时间：2012-04-26T09:02:45.943
> 
> 标签：android, extjs, sencha-touch-2, splash-screen

当我使用 Sencha Touch 2 设置本机 Adroid 应用程序时，在显示 index.html 之前，我在设备上看到一个空白屏幕，并且没有启动图像。我使用 SDK 工具创建应用程序并在多个 android 设备上进行了测试。

**我已经厌倦了不同的方法：**
为了加快加载速度，我传递了一个空的 css 文件 --> 没有区别
我从 index.html 中删除了除了microloader 之外的所有内容
有人建议在 index.html 中使用背景图片 --> 没有区别， index.html 在白屏后显示。
我还检查了实际包含默认启动图像的生成的 apk 文件。

**测试环境**
Windows 7 x64
java 7 x64
Android SDK API lvl 7 已安装（因为构建工具只为 API lvl 7 生成应用程序）
Sencha SDK Tools 2.0.0beta3
Sencha touch 2.0.1

**重现问题的步骤**

sencha app create name /path
set Android sdk path in packager.json
set platform to "Android" in packager.json
sencha app build native

如果可能的话，我的首要任务是移除白屏，或者至少将其变为黑色。
另外我想知道是否可以像在 iOS 上那样用启动图像覆盖它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T11:38:17.757

我使用 phonegap 将 sencha touch 应用程序打包为 Android 和 iOS 中的原生应用程序。然后我在 Android 的主类中使用以下代码来设置启动画面：

```
setIntegerProperty("splashscreen", R.drawable.splash); 
```

图像文件应该在

```
res/drawable-hdpi/splash.png
res/drawable-mdpi/splash.png
res/drawable-ldpi/splash.png 
```

我还设置了在加载 android 浏览器时显示的背景图像。

# php - PHP后台进程不工作

> ID：10330294
> 
> 赞同：2
> 
> 时间：2012-04-26T09:03:05.443
> 
> 标签：php, background-process, shell-exec

我正在使用以下网站来帮助我处理 PHP 中的后台进程 - [http://nsaunders.wordpress.com/2007/01/12/running-a-background-process-in-php/](http://nsaunders.wordpress.com/2007/01/12/running-a-background-process-in-php/)

我的代码基本相同，只是我的`shell_exec`方法如下所示 -
`nohup php -f /my/path/to/import_products.php 2 > /dev/null 2> /dev/null & echo $!`

它正在执行的 PHP 脚本运行良好并且产品已导入，但是当我将 a 添加`sleep(10)`到唯一`import_products.php`的`while(is_process_running($ps))`循环一次并退出时。

似乎`shell_exec`正在执行的命令立即完成，而不是等待 10 秒（从`sleep(10)`）。

任何想法为什么会这样？

**编辑**
我想我的问题确实是“为什么进程不等待 PHP 脚本在它停止出现在 ps 中之前退出？” - 当然，因为 PHP 脚本正在休眠 10 秒`ps $pid`应该显示该进程至少 10 秒？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:23:39.513

请相应地修改您的代码。

1.  `#!/usr/bin/env /usr/bin/php`在开始 php 标记之前在 php 文件的顶部 添加 。
2.  改变`shell_exec("nohup /usr/bin/php /my/path/to/import_products.php > /dev/null &")`。

请注意我的 php 路径是 /usr/bin/php 并且我使用的是 ubuntu os。因此，如果您的 php 可执行文件路径不同，请相应地替换它。

# android - Android WebView 使用 setWideViewPort，禁用双击缩放但保持捏缩放？

> ID：10330296
> 
> 赞同：6
> 
> 时间：2012-04-26T09:03:21.880
> 
> 标签：android, android-webview

我正在使用这段代码，它完全按照我的意愿工作。但是我必须在双击时实现另一个功能，并且想禁用双击缩放（但保留捏缩放功能）。

```
webView.getSettings().setLoadWithOverviewMode(true);
webView.getSettings().setUseWideViewPort(true);
webView.getSettings().setLayoutAlgorithm(LayoutAlgorithm.NORMAL);
webView.getSettings().setBuiltInZoomControls(true);
webView.getSettings().setSupportZoom(true); 
webView.setInitialScale(1); 
```

试图手动计算比例，但没有运气（这感觉很复杂）。 [在 web 视图上禁用双击缩放/取消缩放](https://stackoverflow.com/questions/9018714/disable-double-tap-zoom-unzoom-on-a-webview)

[Android Webview - 网页应适合设备屏幕](https://stackoverflow.com/questions/3916330/android-webview-webpage-should-fit-the-device-screen/3916700#3916700)

有没有办法使用 setUseWideViewPort 和 Zoomcontrolls 但只能禁用或覆盖双击缩放？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-21T12:42:36.040

最好的解决方案，只需从 MyWebView 扩展您的 WebView

```
 public class HelpWebView extends WebView {

    private GestureDetector gestureDetector;
    private AtomicBoolean mPreventAction = new AtomicBoolean(false);
    private AtomicLong mPreventActionTime = new AtomicLong(0);

    public HelpWebView(Context context) {
        super(context);
        gestureDetector = new GestureDetector(context, new GestureListener());
    }

    public HelpWebView(Context context, AttributeSet attrs) {
        super(context, attrs);
        gestureDetector = new GestureDetector(context, new GestureListener());
    }

    public HelpWebView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        gestureDetector = new GestureDetector(context, new GestureListener());
    }

    public HelpWebView(Context context, AttributeSet attrs, int defStyle, boolean privateBrowsing) {
        super(context, attrs, defStyle, privateBrowsing);
        gestureDetector = new GestureDetector(context, new GestureListener());
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        int index = (event.getAction() & MotionEvent.ACTION_POINTER_INDEX_MASK) >> MotionEvent.ACTION_POINTER_INDEX_SHIFT;
        int pointId = event.getPointerId(index);

        // just use one(first) finger, prevent double tap with two and more fingers
        if (pointId == 0){
            gestureDetector.onTouchEvent(event);

            if (mPreventAction.get()){
                if (System.currentTimeMillis() - mPreventActionTime.get() > ViewConfiguration.getDoubleTapTimeout()){
                    mPreventAction.set(false);
                } else {
                    return true;
                }
            }

            return super.onTouchEvent(event);
        } else {
            return true;
        }
    }

    private class GestureListener extends GestureDetector.SimpleOnGestureListener {
        @Override
        public boolean onDoubleTap(MotionEvent e) {
            mPreventAction.set(true);
            mPreventActionTime.set(System.currentTimeMillis());
            return true;
        }
        @Override
        public boolean onDoubleTapEvent(MotionEvent e) {
            mPreventAction.set(true);
            mPreventActionTime.set(System.currentTimeMillis());
            return true;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T11:36:08.983

找到了解决方案：

```
class MyWebView extends WebView { 

    public boolean onTouchEvent(MotionEvent event) {

            gd.onTouchEvent(event);

            // disable double tap zooming

        if(doubleTap)
            {
                doubleTap = false;
                return false;
            }

            return super.onTouchEvent(event);
        }

    GestureDetector.SimpleOnGestureListener sogl = new GestureDetector.SimpleOnGestureListener() { 

            public boolean onDoubleTap(MotionEvent e) {

                    showToast("Double tap");
                    doubleTap = true;

                    return false;
            }        
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T09:50:36.927

抱歉，我没有时间对此进行测试，但请尝试：

```
GestureDetector.SimpleOnGestureListener sogl = new GestureDetector.SimpleOnGestureListener() {
    public boolean onDoubleTap(MotionEvent e) {
        showToast("Double tap");
        return true; //instead of false
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-21T03:23:36.123

带有“一个（第一）手指”解决方案的 GestureDetector 无法可靠地工作。在 Galaxy S3 Android 4.0.4 上，Web 视图有时仍会放大。像这样的附加 WebViewClient 可用于在视图缩放时恢复缩放比例：

```
public class NoZoomedWebViewClient extends WebViewClient {
    private static final String LOG_TAG = "NoZoomedWebViewClient";
    private static final long STABLE_SCALE_CALCULATION_DURATION = 2 * 1000;

    private long   stableScaleCalculationStart;
    private String stableScale;  // Avoid comparing floats
    private long   restoringScaleStart;

    NoZoomedWebViewClient() {
        stableScaleCalculationStart = System.currentTimeMillis();
    }

    @Override
    public void onScaleChanged(final WebView view, float oldScale, float newScale) {
        Log.d(LOG_TAG, "onScaleChanged: " + oldScale + " -> " + newScale);

        long now = System.currentTimeMillis();
        boolean calculating = (now - stableScaleCalculationStart) < STABLE_SCALE_CALCULATION_DURATION;
        if (calculating) {
            stableScale = "" + newScale;
        } else if (!stableScale.equals("" + newScale)) {
            boolean zooming = (now - restoringScaleStart) < STABLE_SCALE_CALCULATION_DURATION;
            if (!zooming) {
                Log.d(LOG_TAG, "Zoom out to stableScale: " + stableScale);
                restoringScaleStart = now;
                view.zoomOut();

                // Just to make sure, do it one more time
                view.postDelayed(new Runnable() {
                    @Override
                    public void run() {
                        view.zoomOut();
                    }
                }, STABLE_SCALE_CALCULATION_DURATION);
            }
        }
    }
} 
```

# c# - 文件名 > 60 个字符时忽略断点

> ID：10330299
> 
> 赞同：0
> 
> 时间：2012-04-26T09:03:23.860
> 
> 标签：c#, lua, luainterface

我的 lua 源文件的文件名 > 60 个字符（带有必要的非绝对路径）当调试器运行时，LuaDebugger.cs 执行断点检查：

```
breakpoint = GetBreakpoint(src, line); 
```

GetBreakpoint 调用 GetFile() 但它总是返回 null 因为

```
String.Compare(fileName, file.FileName, StringComparison.OrdinalIgnoreCase) 
```

失败

```
when filename = luaDebug.shortsrc 
```

（shortsrc 由 定义 `[System.Runtime.InteropServices.MarshalAs(System.Runtime.InteropServices.UnmanagedType.ByValTStr, SizeConst = 60/*LUA_IDSIZE*/)]` ）

如果我使用`filename = luaDebug.source.toString().Substring(1)`它，但我不想更改 luainterface-debugger 源代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:46:45.213

好吧，如果您不想更改源代码，那么您几乎没有选择，因为给您带来麻烦的是源代码本身（我假设是 LUA_IDSIZE const）。

在不修改代码的情况下，您拥有的选项非常有限。它们都涉及放弃拥有 60 多个字符路径。

# r - 在文本编辑器中集成 R linter 有哪些选择？svTools、codetools 等中的 lint

> ID：10330302
> 
> 赞同：6
> 
> 时间：2012-04-26T09:03:28.183
> 
> 标签：r, coding-style, sublimetext, sublimetext2

我正在尝试使用 R 的 linter 扩展 SublimeLinter。SublimeLinter 在 Sublime Text 2 中为许多语言提供自动 linting。目标是 linter 在后台运行并突出显示编码错误或编码风格不佳的行。

目前，我正在使用包`lint`中的功能`svTools`并且它正在工作。然而，结果并不令人满意。linter`)`在一行中捕获许多或许多`}`，但它没有检测到未定义变量的使用，没有编码风格等。

还有其他选择吗？我知道这个讨论[写一个 R lint 程序](https://stackoverflow.com/questions/5160150/writing-a-r-lint-program)，`R CMD check`和`codetools`。但是我怎样才能`R CMD check`在普通的 .r 文件而不是包上运行呢？飞行 linter 应该使用哪些选项？还有其他想法吗？

谢谢！

编辑：该`lint`功能在检测错误位置方面似乎也不是很好，或者它基本上总是指示第 1 列。例如，在`fn = function(...) { ]`列中是 1 而不是`]`最后。

ps：我知道该`lint`函数是`checkUsage()`...的包装器

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-22T00:48:34.977

查看 Andrew（lint 作者）的[github 存储库](https://github.com/halpo)，特别是 NppToR 以了解有关编辑器集成的想法。

至于如何对普通的 .r 文件运行 R CMD 检查，您可以创建一个包骨架并将 R 路径用作当前编辑文件的缓存。显然，在你去的时候找出最好的/需要的 R CMD 检查选项；尽管可能更容易阅读源代码以了解 R CMD 如何执行它的工作，以及一些开源 R IDE 如何使用和解析输出（即：RStudio 及其错误报告）。

# c# - 在报表查看器的行中显示唯一数据

> ID：10330306
> 
> 赞同：0
> 
> 时间：2012-04-26T09:03:51.583
> 
> 标签：c#, asp.net, report-viewer2010

首先请原谅我的英语，我想使用报表查看器 asp.net 2010 显示报表，将数据绑定到报表查看器并显示报表数据效果很好，但是在组中隐藏重复数据不起作用，我确实右键单击文本box & F4 设置用组名隐藏重复项。它只会隐藏连续重复的行数据

```
 for example 
    Data in the column is 
    <br />Employee
    <br />Employee
    <br />Employee
    <br />Employee
    means it'll show only one time. if it is like 
    <br />Employee
    <br />Department
    <br />College
    <br />Employee
    <br />Department
    <br />College
    means it'll display same format as above.
    & here also i need get unique data in the group.
<br>
Why am asking this means i can't apply distinct in query because it is Many to many relationship query, for that i need to get uniqueness in report only please help me thanks in advance. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-19T16:58:16.227

我最近不得不做这件事。rdlc 有一个叫做行组的东西。我相信这就是你想要做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:35:27.543

我建议您从查询中进行优化，而不是在报表查看器中尝试。当我们考虑查询时，您可以使用“GROUP BY”而不是“DISTINCT”删除重复项。希望这可以帮助。

# c# - 使用带有 StructureMap 的抽象工厂的可能性

> ID：10330308
> 
> 赞同：3
> 
> 时间：2012-04-26T09:03:52.487
> 
> 标签：c#, dependency-injection, inversion-of-control, structuremap, abstract-factory

```
public interface IExecuter
{
    void Execute();
}

public class Executer : IExecuter
{
    readonly Data _data;
    readonly IService _service;

    public Executer(Data data, IService service)
    {
        _data = data;
        _service = service;
    }

    public void Execute()
    {
        Console.WriteLine("I consume the data object with id {0}", _data.Id);
        _service.DoAnything();
    }
}

public interface IService
{
    void DoAnything();
}

public class Service : IService
{
    public void DoAnything()
    {
        Console.WriteLine("I do anything else");
    }
}

public class Data
{
    public int Id { get; set; }
    public string Description { get; set; }
} 
```

现在我需要一个抽象工厂来创建 IExecuter，因为我需要将运行时值传递给构造函数。

可能性 #1 -**使用静态抽象工厂**：

```
public class FormularWindow
{
    public static Func<Data, IExecuter> CreateExecuter = data => {throw new NotImplementedException("");};

    public void InvokeExecuter()
    {
        var selectedData = GetSelectedData();
        var executer = CreateExecuter (selectedData);
        executer.Execute();
    }

    private static Data GetSelectedData()
    {
        return new Data { Id = 4, Description = "Test" };
    }
}

class Program
{
    static void Main()
    {
        ObjectFactory.Initialize(x =>
        {
            x.For<IExecuter>().Use<Executer>();
            x.For<IService>().Use<Service>();
        });
        FormularWindow.CreateExecuter = data => ObjectFactory.With(data.GetType(), data).GetInstance<IExecuter>();

        var consumer = ObjectFactory.GetInstance<FormularWindow>();

        consumer.InvokeExecuter();

        Console.ReadLine();
    }
} 
```

可能性 #2 -**使用抽象工厂作为构造函数参数**：

```
public class FormularWindow
{
    readonly Func<Data, IExecuter> _createExecuter;

    public FormularWindow(Func<Data, IExecuter> createExecuter)
    {
        _createExecuter = createExecuter;
    }

    public void InvokeExecuter()
    {
        var selectedData = GetSelectedData();
        var executer = _createExecuter(selectedData);
        executer.Execute();
    }

    private static Data GetSelectedData()
    {
        return new Data { Id = 4, Description = "Test" };
    }
}

class Program
{
    static void Main()
    {
        ObjectFactory.Initialize(x =>
        {
            x.For<IExecuter>().Use<Executer>();
            x.For<IService>().Use<Service>();
            x.For<Func<Data, IExecuter>>().Use(data => ObjectFactory.With(data.GetType(), data).GetInstance<IExecuter>());
        });

        var consumer = ObjectFactory.GetInstance<FormularWindow>();

        consumer.InvokeExecuter();

        Console.ReadLine();
    }
} 
```

可能性 #3 -**使用 IExecuterFactory**：

```
class Program
{
    static void Main()
    {
        ObjectFactory.Initialize(x =>
        {
            x.For<IExecuter>().Use<Executer>();
            x.For<IService>().Use<Service>();
            x.For<IExecuterFactory>().Use<ExecuterFactory>();
        });

        var consumer = ObjectFactory.GetInstance<FormularWindow>();

        consumer.InvokeExecuter();

        Console.ReadLine();
    }
}

public interface IExecuterFactory
{
    IExecuter Create(Data data);
}

public class ExecuterFactory : IExecuterFactory
{
    readonly IService _service;

    public ExecuterFactory(IService service)
    {
        _service = service;
    }

    public IExecuter Create(Data data)
    {
        return new Executer(data, _service);// ?!
    }
}

public class FormularWindow
{
    readonly IExecuterFactory _executerFactory;

    public FormularWindow(IExecuterFactory executerFactory)
    {
        _executerFactory = executerFactory;
    }

    public void InvokeExecuter()
    {
        var selectedData = GetSelectedData();
        var executer = _executerFactory.Create(selectedData);
        executer.Execute();
    }

    private static Data GetSelectedData()
    {
        return new Data { Id = 4, Description = "Test" };
    }
} 
```

如您所见，对于可能性＃3，我不知道如何实现它。我可以再次`Func`在 的构造函数中使用`ExecuterFactory`，但这有点奇怪，因为我在**抽象工厂**中使用了**抽象工厂**。

还有一种 #4 的可能性来注入容器，但这不是一个好主意，因为引入了**服务定位器**。

我问自己是否有一种使用**抽象工厂**的方法`Func<>`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T15:10:12.717

我不会称它为[Abstract Factory](http://en.wikipedia.org/wiki/Abstract_factory_pattern)，它看起来与某些人所说的 Simple Factory 的功能等价物。

我建议你看看 Mark Seemann[关于抽象工厂的帖子](http://blog.ploeh.dk/2012/03/15/ImplementingAnAbstractFactory.aspx)，他以简单的方式解释了几个选项。

实际上，您可以调用您的容器`ExecuterFactory`来解决您的依赖关系，以防它与您的组合根位于同一个项目中，或者`new`在您手动编码的工厂中自己实例化它们。我更喜欢手动方法，因为我喜欢将容器的使用保持在最低限度的想法。

# r - 带箱线图类型分组的点距图

> ID：10330314
> 
> 赞同：2
> 
> 时间：2012-04-26T09:04:07.580
> 
> 标签：r, ggplot2, plot, confidence-interval, statistics-bootstrap

我有可以用箱线图绘制的数据，但每个框的 n 仅为 3。我想在 ggplot2 中使用点范围类型的图来绘制它们。默认情况下，它们相互重叠。当它们在箱线图中分组时，如何将我的点并排分组？

```
library(ggplot2)

x <- rnorm(12, 3,5) # Real data are not always normally distributed.
y <- c(rep("T1", 6), rep("T2", 6))
z <- rep(c(10,20),6)

dat <- data.frame(Treatment = y, Temp = z, Meas = x)

p <- ggplot(dat, aes(Treatment, Meas))
p + geom_boxplot(aes(fill=factor(Temp))) 
```

**编辑：**我更新了问题以按照建议排除自举（最初的想法是使用置信区间作为误差线。一个问题的问题太多=D）。[此处](https://stackoverflow.com/questions/10351704/monte-carlo-nonparametric-confidence-intervals-for-mean-estimate)给出了更详细的引导问题

![在此处输入图像描述](../Images/199acf7819caf57a1818fe8534f8b492.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T11:15:04.220

You have two questions (try to avoid that).

1.  Bootstrapping. How do you bootstrap from a sample of 3 points, where you don't know the underlying distribution?

2.  Line ranges. I've used your original data to construct line ranges. For a line range, you just need a min, max and middle value:

    ```
    ##First rearrange your data frame
    dat = with(dat, dat[order(Treatment, Temp, Meas),])
    dat$type = c("min", "mid", "max")

    library(reshape2)
    dat1 = dcast(dat, Treatment + Temp ~  type, value.var = "Meas") 
    ```

Then plot as usual:

```
 p = ggplot(dat1) +
        geom_pointrange(aes(ymin=min, ymax=max, 
                            y=mid,x=Treatment, group=Temp),
           position=position_dodge(width=0.20)) 
```

The position arguments stops the lines being placed on top of each other. This gives:

![Example line range plot](../Images/6a580412715a3528011b970e5beed86d.png)

# python - 如何在matplotlib中绘制两组字符串的散点图

> ID：10330318
> 
> 赞同：0
> 
> 时间：2012-04-26T09:04:25.750
> 
> 标签：python, numpy, plot, matplotlib, scatter-plot

我想在两个字符串数组之间绘制散点图。在调用 scatter() 时，我收到以下错误。

返回 amin（轴，出）

TypeError：无法使用灵活类型执行归约

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T11:35:14.240

你是什​​么意思：“在两个字符串数组之间绘制散点图”。

这个命令会产生你说的错误，但是没有任何意义：

```
plt.scatter('azerty','qsdfgh') 
```

# android - Android：从第二个活动切换回第一个活动退出

> ID：10330321
> 
> 赞同：1
> 
> 时间：2012-04-26T09:04:38.363
> 
> 标签：android, android-activity

这个问题的解决方案非常简单：

不幸的是，我在我的代码中以某种方式评论了这个错误，也许我从某个地方复制了它：

```
public void onUserLeaveHint() { // this only executes when Home is selected.
        if(started){
            started=false;
            recordTask.cancel(true);
            }
            this.finish();
            super.onUserLeaveHint();
        }
    }
} 
```

那来自API：

> 当活动由于用户选择而即将进入后台时，作为活动生命周期的一部分调用。

所以每当一个新的活动开始时，主要的活动就会进入后台并完成。

无论如何感谢大家的帮助。我的愚蠢错误，完全忘记了那个方法。问题解决了。

原始问题：

我减少了第二个活动的代码，现在只返回一个结果，它看起来像这样。（当我取消注释整个代码时，第二个活动起作用。它只是一个文件资源管理器，应该返回字符串路径。为了调试，我使用它直到我可以让它工作。）这两个活动都在清单中声明。

```
public class AndroidExplorer extends ListActivity {
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.olddata);

        Intent sender=getIntent();
        Intent intent=new Intent();
        intent.putExtra("ComingFrom", "Hello");
        setResult(Activity.RESULT_OK, intent);
        AndroidExplorer.this.finish();
    }
} 
```

这是从第一个活动中调用的：

```
Intent intent;
intent = new Intent(firstactivity.this,AndroidExplorer.class);
firstactivity.this.startActivityForResult(intent,0); 
```

结果应通过以下方式收到：

```
@Override
    public void onActivityResult(int requestCode,int resultCode,Intent data)
    {
     super.onActivityResult(requestCode, resultCode, data);

     String extraData=data.getStringExtra("ComingFrom");
     Log.e("result", extraData);
     go2startscreen();
    } 
```

不幸的是它不会返回到第一个活动，它只是关闭应用程序。

错误日志：

```
04-26 11:11:14.096: D/memalloc(32383): /dev/pmem: Mapped buffer base:0x51b3e000 size:17645568 offset:15556608 fd:53
04-26 11:11:32.264: D/memalloc(32383): /dev/pmem: Mapped buffer base:0x52e66000 size:3686400 offset:1597440 fd:59
04-26 11:11:32.584: D/memalloc(32383): /dev/pmem: Unmapping buffer base:0x51b3e000 size:17645568 offset:15556608
04-26 11:11:32.584: D/memalloc(32383): /dev/pmem: Unmapping buffer base:0x52e66000 size:3686400 offset:1597440
04-26 11:11:32.644: W/IInputConnectionWrapper(32383): showStatusIcon on inactive InputConnection
04-26 11:11:32.644: W/IInputConnectionWrapper(32383): InputConnection = android.view.inputmethod.BaseInputConnection@40d9ddd0, active client = false 
```

这是 go2startscreen 函数：

```
void go2startscreen(){
        setContentView(R.layout.startscreen);
        appPosition = "startscreen";
        newRecord = (Button) this.findViewById(R.id.newRecord);
        newRecord.setOnClickListener(this);
} 
```

所以它应该在 R.layout.startscreen 结束。当我从第一个活动中调用它时，调用 go2startscreen 有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:19:35.540

检查 resultCode 是否正常，然后做你想做的事——像这样::

```
@Override
   public void onActivityResult(int requestCode,int resultCode,Intent data)
   {
    super.onActivityResult(requestCode, resultCode, data);
if(resultCode==RESULT_OK){
    String extraData=data.getStringExtra("ComingFrom");
    Log.e("result", extraData);
   go2startscreen();
    }
  } 
```

希望对你有帮助。。

# python - 如何使 python opencv 处理 C++ 应用程序读取的文件？

> ID：10330328
> 
> 赞同：2
> 
> 时间：2012-04-26T09:05:01.417
> 
> 标签：python, opencv, codec

我有一个 python（Python(x,y) 发行版）应用程序无法使用 opencv（带有 pythonxy 安装程序的 2.3.1 版）打开视频文件的问题。该文件有一个相当有问题的格式（应该是常规的 MPEG-2，但我们有播放它的问题的报告），但由 ffdshow 视频解码器处理。

我的问题是同一系统上不同的opencv实例处理文件的方式不同，安装在python目录中的版本无法读取文件。

您知道如何让 python 应用程序以与其他应用程序相同的方式处理视频文件吗？

以下代码：

```
import cv2.cv as cv
capture = cv.CaptureFromFile("film.mpeg")

print cv.GetCaptureProperty(capture, cv.CV_CAP_PROP_POS_MSEC)
print cv.GetCaptureProperty(capture, cv.CV_CAP_PROP_FRAME_COUNT )
print cv.GetCaptureProperty(capture, cv.CV_CAP_PROP_CONVERT_RGB  )

cv.SetCaptureProperty(capture, cv.CV_CAP_PROP_POS_MSEC, 50)

frame = cv.QueryFrame(capture)
cv.SaveImage("img.jpg",frame) 
```

返回

```
0.0   
0.0  
0.0 
```

并写入无效的图像文件。

同时，在同一台计算机上，我有一个使用 opencv（相同版本号 2.3.1）的 C++ 应用程序，它能够以这种格式打开文件。在列出了两个应用程序使用的库之后，我发现 C++ 的一个加载`ffdshow.ax`（仅当我不重命名它，但请看下面的第 3 点），而 python 没有。

到目前为止我做了什么：

1.  我已验证 python 应用程序为另一个文件提供了正确的结果，但格式不同
2.  我认为python中opencv dll的某些编译选项可能存在问题，因此我将opencv dll替换`C:\Python27\Lib\site-packages`为正在运行的应用程序中的那些，得到的结果仍然相同。
3.  我将文件重命名为`ffdshow.ax`，`ffdshow.ax_`C++ 应用程序没有加载它，但仍在工作 - 这让我很困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-10T14:50:21.660

我回到那个项目。这个问题的答案：

[OpenCV 2.4 VideoCapture 在 Windows 上不起作用](https://stackoverflow.com/questions/11699298/opencv-2-4-videocapture-not-working-on-windows)

帮助。我需要做的就是将 3rdparty/ffmpeg 目录添加到 PATH 环境变量中，并将 opencv 版本号添加到 dll 文件名（opencv_ffmpeg.dll -> opencv_ffmpeg246.dll）

# ruby - 如何使用 Rails 和 JSON 在 Mongoid 中返回模型的字段

> ID：10330331
> 
> 赞同：1
> 
> 时间：2012-04-26T09:05:17.853
> 
> 标签：ruby, ruby-on-rails-3, mongodb, mongoid

我有这个示例文档：

```
{
    "_id" : ObjectId("4f98fd1df2699a2f8a000003"),
    "comments" : "Foo bar",
    "location" : "Somewhere",
    "user_id" : ObjectId("4f98fd1df2699a2f8a000001")
} 
```

当我使用控制器检索数据时：

```
respond_to :json

def index
  respond_with Comment.all
end 
```

它返回 JSON：

```
[{
   "_id": "4f98fd1df2699a2f8a000003",
    "comments": "Foo bar",
    "location": "Somewhere",
    "user_id": "4f98fd1df2699a2f8a000001",
}] 
```

我的问题是如何轻松地在响应中包含 User 类的字段？

```
class User
    include Mongoid::Document

    field :username
    field :first_name
    field :last_name
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T10:59:55.417

您需要覆盖`as_json`.

```
def index
  respond_with Comment.all.as_json(:include => "user")
end 
```

更好的选择是使用 JSON 模板构建器，例如[Jbuilder](https://github.com/rails/jbuilder)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:42:34.630

试试看：

```
respond_with Comment.includes(:user).all 
```

[请参阅此处的文档。](http://mongoid.org/docs/querying/criteria.html#includes)

# android - 有效管理 Android GPS 以获取电池电量

> ID：10330333
> 
> 赞同：2
> 
> 时间：2012-04-26T09:05:27.037
> 
> 标签：android, gps

已经阅读了关于同一主题的其他 SO 帖子，并且坚持在以下方法之间做出决定： [线程 1](https://stackoverflow.com/questions/9522154/android-regular-gps-polling-in-service-maximizing-battery-life)与[线程 2](https://stackoverflow.com/questions/7872863/keeping-a-gps-service-alive-and-optimizing-battery-life)与[简单的 onLocationUpdate()](http://developer.android.com/reference/android/location/LocationManager.html#requestLocationUpdates%28long,%20float,%20android.location.Criteria,%20android.app.PendingIntent%29)

有人可以帮助我了解所有这些的利弊。我需要每 30 秒更新一次；而且我认为将 requestSingleUpdate() 与 AlarmManager 一起使用将不准确（因为它必须重新初始化该过程），并且会消耗更多电池。但线程似乎说相反。

我的应用程序中还有一个地理围栏代码 - 提供较大的投票值也会影响该代码吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T14:15:58.313

请注意，您引用的两个线程需要每 5 或 10 分钟修复一次。您每 30 秒查找一次。我的粗略经验是，每次打开 GPS 时您可能需要 30-60 秒才能获得新的修复，结果是每 30 秒可能与连续运行它没有太大区别。

但是，如果您可以说服自己每隔几分钟进行一次修复，那么我们确定的粗略策略是启用 gps，如果您在 1 分钟内获得修复，则使用大约获得的第 10 个（每秒获得一次） gps 开始运行），因为某些手机这样做显然具有一定的准确性优势，如果您在 1 分钟内没有得到修复，请关闭，放弃并在下一个间隔重试。AlarmManager 是一种计时这些的好方法，因为它会将手机从睡眠中唤醒，这样您就不会错过任何修复间隔。

# java - 注销后单击后退按钮缓存问题

> ID：10330336
> 
> 赞同：4
> 
> 时间：2012-04-26T09:05:40.367
> 
> 标签：java, jsp, caching, logout

```
<%
    response.setHeader("Cache-Control","no-cache,no-store,must-revalidate");//HTTP 1.1
    response.setHeader("Pragma","no-cache"); //HTTP 1.0
    response.setDateHeader ("Expires", 0); //prevents caching at the proxy server
%> 
```

注销后，在登录页面上，如果您单击后退按钮，它会在登录时显示旧页面。我在 jsp 中使用了以上 3 行，并将其包含在我的所有 jsp 内 body 标记中。这不适用于某些 jsps 。注销后停止缓存需要考虑哪些事项。如果一个 jsp 有一个带有 Post 方法的表单，这种技术不起作用？

在我的注销操作中，我正在这样做。

```
Cookie logoutCookie = new Cookie("somename", null);
logoutCookie.setPath("/somename");
logoutCookie.setMaxAge(0);
ServletActionContext.getResponse().addCookie(logoutCookie); 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T11:44:51.153

如果您使用浏览器的后退按钮，则无能为力。该页面将始终来自缓存。

只需确保在用户单击注销时使会话无效。这样，当用户点击“返回”并尝试使用该页面时，他将被重定向到登录页面（如果您的网站编程正确）。

[编辑]

这是我们为 http 1.1 设置的没有缓存的标头：

```
httpResponse.setHeader("Cache-Control", "private,no-store,no-cache"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T14:04:38.587

> *我在body标签内的所有jsps中都包含了这个*

当 HTTP 响应此时已经提交时，这可能**为时已晚。**当已经写入 X 数量的字符时，将提交 HTTP 响应，在您的情况下是 HTML `<head>`。您需要将这些行放在 JSP 文件的最顶部，而不是`<body>`HTML 表示中。

* * *

在不相关的说明中，您通过将相同的代码行复制粘贴到多个文件中而犯了一个巨大的设计错误。这不是[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)。每当你需要复制粘贴代码时，你应该停下来问问自己是否没有一个*地方*可以执行特定的代码。在您的特定情况下，您应该使用 a`Filter`代替。有关具体示例，另请参阅此答案：[防止用户在注销后看到以前访问过的安全页面](https://stackoverflow.com/questions/4194207/prevent-user-from-going-back-to-the-previous-secured-page-after-logout/4194251#4194251)。此外，在 JSP 中编写 Java 代码是一种不好的做法。检查[如何避免 JSP 文件中的 Java 代码？](https://stackoverflow.com/questions/3177733/how-to-avoid-java-code-in-jsp-files/3180202#3180202)

另外，您的注销方法很奇怪。不要将用户名存储在某些自定义 cookie 中。你基本上是在重塑会话。只需将登录用户存储为会话属性，并使整个会话无效并发送重定向。

```
request.getSession().invalidate();
response.sendRedirect(request.getContextPath() + "/home.jsp"); 
```

有关会话工作的背景信息，请阅读以下内容：[servlet 如何工作？实例化、会话、共享变量和多线程](https://stackoverflow.com/questions/3106452/how-do-servlets-work-instantiation-session-variables-and-multithreading/3106909#3106909)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T09:20:11.387

Have you tried `response.setHeader("Cache-control","no-store"); response.setHeader("Pragma","no-cache"); response.setDateHeader("Expires", -1);`? I think your missing the quotes at the right place..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-28T09:20:44.790

创建一个会话属性，让我们说“有效”，并在登录凭据匹配后使用 jsp 中除 null 以外的任何值对其进行初始化。现在使用以下代码创建一个 verify.jsp：

```
<%
response.setHeader("Cache-Control", "no-cache, no-store, must-revalidate"); // HTTP 1.1.
response.setHeader("Pragma", "no-cache"); // HTTP 1.0.
if(session.getAttribute("valid")==null)
{
    out.println("<script>parent.location.href='login.jsp'</script>");
}
%> 
```

现在只需在每个 jsp 页面上包含这个 jsp 文件并完成。不要忘记写“session.invalidate();” 在注销.jsp

希望它会工作..!!!

# google-plus - Google Plus 按钮与页面的优点

> ID：10330337
> 
> 赞同：0
> 
> 时间：2012-04-26T09:05:45.287
> 
> 标签：google-plus, google-plus-one

我的网站有一个 Google Plus 页面，位于[https://plus.google.com/111407386830313266899?prsrc=3](https://plus.google.com/111407386830313266899?prsrc=3)

截至目前，它有8个优点。

但是，如果您查看与之相关的我的网站[http://www.derekbeck.com/1775/](http://www.derekbeck.com/1775/)，G+ 按钮只会呈现数字 4。

现在，似乎 G+ 按钮与 G+ 页面相关联。如果我加上我网站上的按钮，G+ 页面上的数字就会增加。然而，显然反过来是不正确的。

有任何想法吗？

谢谢，德里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T19:42:35.893

在您的网站[http://www.derekbeck.com/1775/](http://www.derekbeck.com/1775/)上，+1 按钮定位到您的 Google+ 信息页的网址[https://plus.google.com/111407386830313266899](https://plus.google.com/111407386830313266899)。

您实际上应该定位您的主页，如您的页面所示：[http ://www.1775thebook.com](http://www.1775thebook.com)

这意味着您的标记将从

```
<div class="g-plusone" data-size="small" data-href="https://plus.google.com/111407386830313266899"></div> 
```

到

```
<div class="g-plusone" data-size="small" data-href="http://www.1775thebook.com"></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T08:56:14.530

好的，从@abraham 结束这个问题，埋在上面的评论中：

“该网站显示 6 个 +1，而 G+ 页面显示 8 个关注者，将它们组合起来，您会在 G+ 页面上看到 +14。如果您在网站上添加 G+ 徽章而不是 +1 按钮，您将看到 +14那里也有。——亚伯拉罕 9 月 7 日 22:51"

# android - Android AudioRecord 哪些设置可以记录通话

> ID：10330340
> 
> 赞同：10
> 
> 时间：2012-04-26T09:05:55.123
> 
> 标签：android, signal-processing, audio-recording, android-audiorecord

我使用 AudioRecord 类在通话过程中录制语音。

我有兴趣只记录拥有电话的人的声音（来自麦克风）。在录制过程中，我想做一些音频处理，但现在这是题外话。

Android 有以下 AudioSources 选项：

*   MediaRecorder.AudioSource.VOICE_CALL
*   MediaRecorder.AudioSource.MIC
*   MediaRecorder.AudioSource.VOICE_UPLINK
*   MediaRecorder.AudioSource.VOICE_DOWNLINK

你能解释一下它们之间有什么区别吗？好的 MIC 很明显，但是 VOICE_CALL vs VOICE_UPLINK vs VOICE_DOWNLINK ？

另外我应该选择一个采样率（8000Hz、16000Hz、2250Hz、44100Hz）。你能告诉我选择什么采样率，为什么？

对于音频格式，我选择了 AudioFormat.ENCODING_PCM_16BIT，但它也有： - AudioFormat.ENCODING_DEFAULT - AudioFormat.ENCODING_INVALID - AudioFormat.ENCODING_PCM_8BIT

最后是我应该使用多少个频道，为什么？（ AudioFormat.CHANNEL_IN_STEREO 或 AudioFormat.CHANNEL_IN_MONO ）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-07-17T09:12:26.967

您应该始终以使用 44100 作为采样率为目标，因为它是唯一保证根据谷歌工作的采样率。

> “以赫兹表示的采样率。44100Hz 是目前唯一保证适用于所有设备的速率，但其他速率（例如 22050、16000 和 11025）可能适用于某些设备。” [开发网站](http://developer.android.com/reference/android/media/AudioRecord.html#AudioRecord%28int,%20int,%20int,%20int,%20int%29)

至于立体声与单声道，请使用单声道。

> “描述了音频通道的配置。参见 CHANNEL_IN_MONO 和 CHANNEL_IN_STEREO。CHANNEL_IN_MONO 保证在所有设备上都能正常工作。” [开发网站](http://developer.android.com/reference/android/media/AudioRecord.html#AudioRecord%28int,%20int,%20int,%20int,%20int%29)

最后：8bit pcm vs 16bit pcm：使用16bit pcm，

> “音频数据格式：每个样本 PCM 16 位。保证设备支持。” [开发网站](http://developer.android.com/reference/android/media/AudioFormat.html#ENCODING_PCM_16BIT)

请记住在使用 16 位时使用 short[] 缓冲区而不是字节缓冲区。由于 16 位是 2 个字节，因此您必须一次在缓冲区中组合两个条目：

byte][]{sample_1_upper, sample_1_lower, sample_2_upper, sample_2_lower,...,sample_n_lower} 但是，如果您使用短 [] 缓冲区：
short[]{sample1, sample2, ..., sample3}

我从未尝试录制通话，但如果操作系统未绑定 MIC 源，您可能会从中录制。由于您是从麦克风录制的，因此您应该只获得用户的声音。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-26T16:02:30.647

> 你能解释一下它们之间有什么区别吗？好的 MIC 很明显，但是 VOICE_CALL vs VOICE_UPLINK vs VOICE_DOWNLINK ？

VOICE_UPLINK：从你端传输到对方的音频。IOW，你对着麦克风说的话（加上周围的噪音，取决于是否使用了噪音抑制以及它的表现如何）。

VOICE_DOWNLINK：从对方传输到你端的音频。

VOICE_CALL：VOICE_UPLINK + VOICE_DOWNLINK。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-02T11:18:03.467

有点晚了，但您可以查询音频设备以了解它可以做什么；

```
AudioManager audioManager = (AudioManager) context.getSystemService(Context.AUDIO_SERVICE);
String sampleRate =  audioManager.getProperty(AudioManager.PROPERTY_OUTPUT_SAMPLE_RATE);
String sampleBufferSize = audioManager.getProperty(AudioManager.PROPERTY_OUTPUT_FRAMES_PER_BUFFER);
int bufferSize = AudioRecord.getMinBufferSize(Integer.parseInt(sampleRate), AudioFormat.CHANNEL_IN_MONO, AudioFormat.ENCODING_PCM_16BIT); 
```

# javascript - Threejs：为几何中的每个顶点分配不同的颜色

> ID：10330342
> 
> 赞同：21
> 
> 时间：2012-04-26T09:05:57.597
> 
> 标签：javascript, webgl, three.js, picking

我想通过 Three.js 中的 IdMapping 进行挑选

由于性能问题，我只有一个巨大的几何图形，计算如下：

```
for (var i = 0; i < numberOfVertices; i += 9) {
  p1  = new THREE.Vector3(graphData.triangles.vertices[i+0], graphData.triangles.vertices[i+1], graphData.triangles.vertices[i+2]);
  p2  = new THREE.Vector3(graphData.triangles.vertices[i+3], graphData.triangles.vertices[i+4], graphData.triangles.vertices[i+5]);
  p3  = new THREE.Vector3(graphData.triangles.vertices[i+6], graphData.triangles.vertices[i+7], graphData.triangles.vertices[i+8]);
  geometry.vertices.push(new THREE.Vertex( p1.clone() ));
  geometry.vertices.push(new THREE.Vertex( p2.clone() ));
  geometry.vertices.push(new THREE.Vertex( p3.clone() ));
  geometry.faces.push( new THREE.Face3( i/3, i/3+1, i/3+2 ) );

  // i want to do something like this:
  geometry.colors.push(new THREE.Color(0xFF0000));
  geometry.colors.push(new THREE.Color(0xFF0000));
  geometry.colors.push(new THREE.Color(0xFF0000)); 
}

geometry.computeFaceNormals();
var material = new THREE.MeshBasicMaterial({});

var triangles = new THREE.Mesh( geometry, material );
scene.add(triangles); 
```

如何为几何图形中的每个顶点分配不同的颜色？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-04-26T11:31:14.877

它必须是 geometry.vertexColors 而不是 geometry.colors （每个顶点推一种颜色）。

和材料：

```
material = new THREE.MeshBasicMaterial({ vertexColors: THREE.VertexColors }); 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-08-07T22:35:29.990

我使用的是 71 版[。Lee 的回答](https://stackoverflow.com/a/11906130/901641)可能仍然有效，但看起来非常复杂。

这是我可以做的最简单的例子，它`Mesh`为每个顶点分配了单独的颜色：

```
var geometry = new THREE.Geometry();

// Make the simplest shape possible: a triangle.
geometry.vertices.push(
    new THREE.Vector3(-10,  10, 0),
    new THREE.Vector3(-10, -10, 0),
    new THREE.Vector3( 10, -10, 0)
);

// Note that I'm assigning the face to a variable
// I'm not just shoving it into the geometry.
var face = new THREE.Face3(0, 1, 2);

// Assign the colors to the vertices of the face.
face.vertexColors[0] = new THREE.Color(0xff0000); // red
face.vertexColors[1] = new THREE.Color(0x00ff00); // green
face.vertexColors[2] = new THREE.Color(0x0000ff); // blue

// Now the face gets added to the geometry.
geometry.faces.push(face);

// Using this material is important.
var material = new THREE.MeshBasicMaterial({vertexColors: THREE.VertexColors});

var mesh = new THREE.Mesh(geometry, material); 
```

希望这个答案看起来不那么可怕。

将颜色分配给面的顶点而不是几何体的顶点有点糟糕，因为这意味着您必须重复设置它们。就个人而言，我将在 Three.js 之上添加一个图层，以便我可以将颜色分配给几何图形。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-08-10T16:59:15.413

此代码应该适用于 three.js v49，创建一个 RGB 颜色立方体。

（与[如何在 Three.js 中更改面部颜色有关](https://stackoverflow.com/questions/11252592/how-to-change-face-color-in-three-js)）

```
// this material causes a mesh to use colors assigned to vertices
var vertexColorMaterial = new THREE.MeshBasicMaterial( { vertexColors: THREE.VertexColors } );

var color, point, face, numberOfSides, vertexIndex;

// faces are indexed using characters
var faceIndices = [ 'a', 'b', 'c', 'd' ];

var size = 100;
var cubeGeometry = new THREE.CubeGeometry( size, size, size );

// first, assign colors to vertices as desired
for ( var i = 0; i < cubeGeometry.vertices.length; i++ ) 
{
    point = cubeGeometry.vertices[ i ];
    color = new THREE.Color( 0xffffff );
    color.setRGB( 0.5 + point.x / size, 0.5 + point.y / size, 0.5 + point.z / size );
    cubeGeometry.colors[i] = color; // use this array for convenience
}

// copy the colors to corresponding positions 
//     in each face's vertexColors array.
for ( var i = 0; i < cubeGeometry.faces.length; i++ ) 
{
    face = cubeGeometry.faces[ i ];
    numberOfSides = ( face instanceof THREE.Face3 ) ? 3 : 4;
    for( var j = 0; j < numberOfSides; j++ ) 
    {
        vertexIndex = face[ faceIndices[ j ] ];
        face.vertexColors[ j ] = cubeGeometry.colors[ vertexIndex ];
    }
}

cube = new THREE.Mesh( cubeGeometry, vertexColorMaterial ); 
```

# javascript - 是否可以使用 HTML5 在 Visual Studio 2010 中制作自定义用户组件？

> ID：10330346
> 
> 赞同：1
> 
> 时间：2012-04-26T09:06:09.850
> 
> 标签：javascript, visual-studio-2010, custom-component

我正在制作一个项目，其中涉及为 Visual Studio 创建自定义组件。我已经使用 Javascript，使用 Kinetic 库制作了控件，但找不到将其用作组件的方法。有什么建议么？

现在我担心必须使用 C# 重新创建控件，但我宁愿不这样做，因为已经在 javascript 控件上花费了大量工作。

提前致谢！

-编辑-

我做了更多的研究并询问了一些同事。显然这是不可能的。我将不得不想出另一个解决方案...

# web-services - Camel 和 BPEL 的区别

> ID：10330350
> 
> 赞同：9
> 
> 时间：2012-04-26T09:06:24.797
> 
> 标签：web-services, rest, soa, apache-camel, bpel

SOA 的概念很容易掌握，但我对企业服务集成架构和 BPEL 和 Apache Camel 等技术完全不熟悉。

我知道 BPEL 有助于编排服务，并且 Camel 是企业集成模式的一种实现。我目前正在阅读著名的企业集成模式一书。

但对我来说，EIP 和编排之间的界限似乎很窄。在我看来，Camel 也以自己的方式编排服务。此外，Camel 提供了许多连接器，因此可以轻松使用不同的协议。

Camel 比 BPEL 好吗？
或者是否有可能用 BPEL 做一些你不能用 Camel 做的事情？
哪个？
关于我读到的内容，似乎 Camel 在编排 REST 服务方面比 BPEL 更好：这是真的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T15:01:47.543

在我之前的工作中，我们多次尝试回答这个问题。我们的产品是 TIBCO BusinessWorks（类似于 Apache Camel）和 TIBCO iProcess（类似于 Apache ServiceMix）。

我们得出了简单的结论：

*   如果您的流程是长期的（您通常需要暂停并等待经理批准），您需要 BPEL。
*   如果您的流程更短期并且没有人参与，那么您需要集成（Camel）。

这并不总是适用，这两个世界没有很强的界限，但你可以简化它。还有一点需要注意 - 您可以使用集成产品执行类似 BPEL 的流程，反之亦然。这只是一个方法问题。但是如果你坚持这些规则，你应该能够区分这两者。还有很多方面，但这是我认为最重要的一个。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-26T22:16:11.850

Bpel 更像是一种用于 bpm 和服务编排实现的语言/标准。它有点像苹果和梨，因为骆驼是一个集成引擎实现。您可能希望更多地了解用于高级业务自动化的 bpel（或 bpmn）（例如使用多个系统、长时间运行的流程和业务逻辑实现采购流程）。在 Camel 中，您通常处理更多技术方面的问题，例如路由和有线协议转换。通常以相当无国籍的方式。

当然，两者之间存在一些问题——例如任何解决方案都可以在同类协议之间进行路由。比如你的休息例子。另请注意，Camel 可以与诸如 activti 和 apache ode 之类的编排引擎一起运行。

# c# - 如何使我的 Ninject 模块干燥？

> ID：10330351
> 
> 赞同：0
> 
> 时间：2012-04-26T09:06:25.980
> 
> 标签：c#, ninject

我的 Ninject 模块中有以下代码重复了几次。我可以使用哪些方法和技术来减少这种重复代码？

```
public override void Load()
{
    Bind<IDataReader<IList<Price>>>()
        .To<PricesDataReader>().Named("ValDatePrices");
    Bind<IDataConnection<IList<PricesCsvRecord>>>()
        .To<PricesXLConnection>().WhenParentNamed("ValDatePrices")
        .Named("ValDatePricesXLConnection");
    Bind<IDirectoryBuilder>()
        .ToMethod(DefaultValDatePricesDirectory)
        .WhenParentNamed("ValDatePricesXLConnection");

    Bind<IDataReader<IList<Price>>>()
        .To<PricesDataReader>().Named("EDDatePrices");
    Bind<IDataConnection<IList<PricesCsvRecord>>>()
        .To<PricesXLConnection>().WhenParentNamed("EDDatePrices")
        .Named("EDDatePricesXLConnection");
    Bind<IDirectoryBuilder>()
        .ToMethod(DefaultEDDatePricesDirectory)
        .WhenParentNamed("EDDatePricesXLConnection");
} 
```

主要区别发生在请求`IDirectoryBuilder`其主要功能是通过使用实现根据配置设置确定文件位置时`IDirectory`。

在上面的示例中，我返回 a `DefaultDirectoryBuilder`，但是我在下面有几个其他的实现（参见`EdNrrDirectoryBuilder`方法）。

```
public IDirectoryBuilder DefaultValDatePricesDirectory(IContext arg) 
{
    return new DefaultDirectoryBuilder(
         ConfigurationManager.AppSettings["VALDATE_PRICES_DIR"],
         ConfigurationManager.AppSettings["VALDATE_PRICES_FILENAME"]);
}

public IDirectoryBuilder DefaultEDDatePricesDirectory(IContext arg) 
{
    return new DefaultDirectoryBuilder(
         ConfigurationManager.AppSettings["EDDATE_PRICES_DIR"],
         ConfigurationManager.AppSettings["EDDATE_PRICES_FILENAME"]);
}

public IDirectoryBuilder EdNrrDirectoryBuilder(IContext arg)
{
    return new ExternalDirectoryBuilder(
         ValuationDate,
         ConfigurationManager.AppSettings["NRRDATE_DIR"],
         ConfigurationManager.AppSettings["NRRDATE_PRICES_FILENAME"]);
} 
```

我的问题是我需要配置文件中的值。现在，所有与配置相关的请求都限制在我的 Ninject 模块中。

如果我使用 Ninject Factory 方法来创建`IDirectoryBuilder`s，我认为我需要将`ConfigurationManager` 相关调用分散在我的代码库中。

如果我使用 Ninject Provider 方法，我将需要`IDirectoryBuilder`s 的所有实现的提供者，并更新我的构造函数和`IDataConnection`. 我的代码现在看起来也像（不是很干，与我目前的方法相似）。

```
Bind<IDirectoryBuilder>().ToProvider<DefaultDirectoryBuilderProvider>()
    .WhenParentNamed("EDDatePricesXLConnection")
    .WithConstructorArgument("baseDir", "someConfigValue")
    .WithConstructorArgument("fileName", "someOtherConfigValue"); 
```

我的代码目前有一个非常一致的依赖链（使用 NamedArguments）：`ICalculator`-> `IDataReader`-> `IDataConnection`-> `IDirectoryBuilder`- 这让我相信必须有某种方法可以重复创建这个链，而不必重复设置代码 - 我可以似乎没有弄清楚。还有一个额外的限制，因为我经常需要相同依赖链的两个实例——唯一的区别是不同的配置值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T10:20:27.057

根据鲁本的评论，这是我目前的解决方案。我做的一件事是使用约定的概念，因此检索我的配置设置变得更容易。这过滤了大多数使用 Ninject`Named`参数的其他代码。

```
public void Load(){
    BindDependencies<IDataReader<IList<Price>>, PricesDataReader
      , IDataConnection<IList<PricesCsvRecord>>, PricesXLConnection
      , DefaultDirectoryBuilder>
      ("ValDatePrices");

    BindDependencies<IDataReader<IList<Price>>, PricesDataReader
      , IDataConnection<IList<PricesCsvRecord>>, PricesXLConnection
      , DefaultDirectoryBuilder>
      ("EDDatePrices");
       // etc etc 
}

 public void BindDependencies<
     TReaderBase, TReaderImpl,
     TDataConnectionBase, TDataConnectionImpl,
     TDirectoryBuilderFactoryImpl>
     (string baseName)
         where TReaderImpl : TReaderBase
         where TDataConnectionImpl : TDataConnectionBase
 {
     DirectoryBuilderInfo dirInfor = GetSettings(baseName);

     Bind<TReaderBase>()
           .To(typeof(TReaderImpl))
           .Named(baseName);
     Bind<TDataConnectionBase>().To(typeof(TDataConnectionImpl))
            .WhenParentNamed(baseName)
            .Named(baseName + "XLConnection");
     Func<IDirectoryBuilder> directoryBuilder = CreateDirectoryBuilderFunc<TDirectoryBuilderFactoryImpl>(dirInfor);

     Bind<IDirectoryBuilder>()
            .ToMethod(d => directoryBuilder())
            .WhenParentNamed(baseName + "XLConnection");
    }

private Func<IDirectoryBuilder> CreateDirectoryBuilderFunc<TDirectoryBuilderFactoryImpl>(DirectoryBuilderInfo dirInfor)
{
    Func<IDirectoryBuilder> directoryBuilder = 
         () => CreateDefaultDirectoryBuilder(dirInfor.BaseDirectory, dirInfor.FileName);

    if (typeof(TDirectoryBuilderFactoryImpl) == typeof(RiskDirectoryBuilderFactory))
    {
        directoryBuilder = 
         () => CreateRiskDirectoryBuilder(ValuationDate, dirInfor.BaseDirectory, dirInfor.FileName);
    }
    return directoryBuilder;
}

private DirectoryBuilderInfo GetSettings(string baseName)
{
    var settingsName = baseName.ToUpperInvariant();
    return new DirectoryBuilderInfo()
    {
        BaseDirectory = ConfigurationManager.AppSettings[settingsName + "_DIR"],
        FileName = ConfigurationManager.AppSettings[settingsName + "_FILENAME"]
     };
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T07:41:51.727

没有理由依赖任何 Ninject 特定技术（尽管在某些情况下，[提供者](https://github.com/ninject/ninject/wiki/Providers,-Factory-Methods-and-the-Activation-Context)可能是合适[的（此处提供者示例](https://stackoverflow.com/a/2228905/11635)）。

简单的答案是您为绑定表达式的前一个组件返回的内容创建扩展方法（[类似问题](https://groups.google.com/forum/?fromgroups#!topic/ninject/gZErCEzCBgU)）。

* * *

在重新阅读您的问题时，我建议您查看[Ninject.Extensions.Conventions](https://github.com/ninject/ninject.extensions.conventions/wiki)，它有很多`Bind`扩展方法，可以让您`Bind`按照您建议的方式进行操作。如果不是，我建议您评论并识别您认为它没有解决的位。

# visual-studio-2010 - 内部 CPS 错误：解决方案构建管理器现在应该调用 BeginBuild

> ID：10330353
> 
> 赞同：0
> 
> 时间：2012-04-26T09:06:30.797
> 
> 标签：visual-studio-2010, visual-c++, visual-studio-debugging

我正在使用 Microsoft Visual Studio 2010 (VC++) 编写程序。前几天建了一个项目，程序运行成功。今天我在程序中添加了一些新代码，但是我在重建项目时出现了错误。

错误如下：

```
1>------ Build started: Project: ProcessImage, Configuration: Debug Win32 ------
1>Error: Internal CPS Error: The Solution Build Manager was expected to have called BeginBuild by now.
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

我今天添加的新代码只是几个简单的陈述，我可以确认它们是正确的。

那么，谁能告诉我出了什么问题以及如何解决这个问题？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-01-18T09:53:36.920

这是一个旧线程，但是由于我现在遇到了问题，并且网络中所有可用的解决方案都建议修复 VS 2010 安装，这可能会很耗时，尤其是如果在 VS 中应用了一系列修复程序（因此必须重新应用它们） ）我会发布一个替代答案。

在 VS 加载期间使用 Sysinternals 进程监视器，我在各种与 VS 相关的注册表项上发现了多个拒绝访问错误消息。

为当前操作系统用户更正这些注册表项权限后，VS 构建成功完成。

# javascript - 多次ajax调用后超时

> ID：10330359
> 
> 赞同：2
> 
> 时间：2012-04-26T09:06:48.797
> 
> 标签：javascript, android, jquery-mobile, cordova

我正在使用phonegap在android中开发一个应用程序。所以几乎我的应用程序中的所有内容。用javascript完成。我遇到了下面描述的问题。如果有人能告诉我如何解决这个问题，我将非常感激。所以：请帮忙！

如果我点击我的应用程序，我的 ajax 请求会超时。一旦产生超时，所有其他请求也会给出超时。如果我在浏览器中运行它，则不会出现此问题。所有调用都是异步的。有时：在构建我的页面时，多个请求并行运行。

我的代码：

```
if (typeof TheApplication.webServiceCall !== 'function'){
    TheApplication.webServiceCall = function(uri, theType, async, data, callback, callbackError){

        var result;

        var successCallback = function (r) {

            TheApplication.user.name = r.username;

            $.ajax({
                url: baseUrl + uri,
                type: theType,
                async: async,
                data: data,
                dataType: 'json',
                timeout: 7000,
                cache: false,
                contentType: "application/json; charset=utf-8",
                beforeSend: function(xhr,settings) {
                    var authToken = r.authtoken;
                    xhr.setRequestHeader('Authorization','Basic '+authToken);
                    xhr.setRequestHeader('max-age',0);
                    xhr.setRequestHeader('Expires','already expired');
                },
                success: function(data, textStatus, jqXHR) {
                    if (data.Error.length > 0){
                        console.log("log TheApplication.webServiceCall error "+JSON.stringify(data.Error));
                        TheApplication.Error.Throw(data.Error);
                    }
                    result = callback(data);
                },
                error: function(xhr, options, error){
                    var errorMessage = JSON.stringify(error);
                    if (typeof callbackError === 'undefined' || callbackError == false) {
                        TheApplication.Error.Throw('UNKNOWN');
                    }
                    if(errorMessage == "" || (errorMessage.indexOf("timeout"))>0){
                        TheApplication.Error.Throw('NO_CONNECTION');
                    }
                }
            });

        };

        var failureCallback = function (e) {
            TheApplication.Error.Throw('UNKNOWN');
        };

        window.plugins.accountManager.getAccount(successCallback, failureCallback);
    };
} 
```

# c++ - 如何使用模板而不是宏来创建具有动态数量的函数的类

> ID：10330362
> 
> 赞同：1
> 
> 时间：2012-04-26T09:06:52.080
> 
> 标签：c++, function, templates, dynamic, macros

目前我正在创建一个带有 set 和 get 函数的基类。但是我想添加更复杂的宏，但是宏对于调试来说真的很糟糕，所以我想用模板来做，但我不知道有人知道一本书或链接给我。

我真正的问题要复杂得多，我只是创建了一个集合并获取示例来演示该问题。

作为一个简单的示例，请参见：

```
#include <iostream>

#define SETGET_BEGIN(name) \
  class name##Base { \
  public: name##Base(){};

#define SETGET_VAR(type,name) \
  protected: type name##_; \
  public: void set##name(const type &_r) {name##_ = _r;} ; \
  public: const type &get##name() const {return name##_; };  \

#define SETGET_END };

SETGET_BEGIN(MyClass)
SETGET_VAR(int,NrA)
SETGET_VAR(float,NrB)
SETGET_END

class MyClass : public MyClassBase {
  public: 
    MyClass() : MyClassBase() {};
};

int main(int argc, char **argv) {
    MyClass myclass;
    myclass.setNrA(4);    
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:39:24.857

尽管宏不是 C++ 的最大特性，但由于范围问题、调试限制和其他可能的意外，它们确实偶尔使用。由于宏是文本替换器，它们的优势之一是可以使用文本输入创建代码，如您的示例中所做的那样。

我看不到您制作“动态”类的方法的附加值，但类似的方法可能可用于枚举值或其他重复代码的序列化或值检查。宏也可用于记录以获取文件名/行号/函数名/...

因此，正如 Gumik 已经评论的那样，我看不出如何使用模板来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T20:26:09.927

您可以使用模板 mixin 组合不同类型的 setter 和 getter。模板混合定义了一个从其模板参数继承的类。这是您使用 mixins 而不是宏的示例：

```
class MyBaseClass {
public:
    MyBaseClass() {}
};

template<class B> class SetGetNrA : public B {
private:
    int NrA;
public:
    void setNrA(int NrA) { this->NrA = NrA; }
    int getNrA() { return NrA; }
};

template<class B> class SetGetNrB : public B {
private:
    float NrB;
public:
    void setNrB(float NrB) { this->NrB = NrB; }
    float getNrB() { return NrB; }
}; 
```

现在使用它：

```
typedef SetGetNrA<SetGetNrB<MyBaseClass> > MyClass;
MyClass myclass;
myclass.setNrA(4); 
```

您也可以将变量的类型设为模板参数，但如果您希望变量的名称作为参数，则必须使用宏。尽管如此，与仅使用宏替换相比，在模板中做更多的工作可以确保您从一个好的编译器 (clang++) 获得更好的错误消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T09:56:32.513

最简单的解决方案是`std::tuple`. 它包含您需要的所有功能，名称除外。而不是`setnrA(int)`元组方法将是`set<1>(int)`. 显然，您可以添加一个枚举来为元组索引分配有意义的名称，因此您可以调用`.set<nrA>(4)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T17:09:48.597

我建议您看一看《现代 C++ 设计：应用的通用编程和设计模式》一书。特别是“基于策略的类设计”一章可能会给你一些想法。不过，我不知道它是否符合您的确切需求。

# css - 无论宽度如何，如何使我的弹出窗口死点

> ID：10330363
> 
> 赞同：0
> 
> 时间：2012-04-26T09:06:53.173
> 
> 标签：css, popup, center, compliant

我的网站有一个使用 CSS 设置样式的弹出窗口，但我终其一生都无法弄清楚如何将其居中。所有正常方式都行不通，因为无论宽度如何，我都需要将其居中。

这是背景和弹出框的CSS：

```
 .filterbox {
     background-color: #000000;
     display: none;
     height: 100%;
     left: 0%;
     opacity: 0.5;
     position: absolute;
     top: 0%;
     width: 100%;
     z-index: 10;
}

.floatbox {
     background-color: white;
     border: 2px solid #FD6907;
     display: none;
     margin:0 auto;
     min-height: 200px;
     min-width:500px;
     overflow: hidden;
     padding: 10px;
     position: absolute;
     top: 30px;
     left:30%;
     z-index: 11;
     -moz-border-radius: 15px; 
     border-radius: 15px;
     -webkit-border-radius:15px;
} 
```

这是弹出框内的 div。

```
#boxcontent {
 height: auto;
 width:100%;
 left: 0pt;
 margin-bottom: 50px;
 min-height: 150px;
 padding: 10px;
} 
```

目前它是绝对定位的，但是我想知道一种更合规的方式，无论弹出框是什么，它都会使弹出框居中。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:10:24.330

```
.floatbox{
    width:600px;
    margin-left:auto;
    margin-right:auto;
} 
```

或您选择的任何宽度

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:10:09.747

我认为您需要 js 来定位弹出窗口...

# java - 两个字符串数组的联合运算 - Java

> ID：10330369
> 
> 赞同：4
> 
> 时间：2012-04-26T09:07:28.620
> 
> 标签：java

我有两个字符串数组。例如`A = {"ABC", "XYZ", "MNO"}`，`B = {"ABC", "PQR", "XYZ"}`现在我想要一个字符串数组`{"ABC", "XYZ", "MNO", "PQR"}`

我怎样才能做到这一点？请帮我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T09:11:11.610

获取一个[HashSet](http://developer.android.com/reference/java/util/HashSet.html)并将两个数组中的所有字符串都放入其中。集合不允许复制，因此它只有唯一值。完成后，您可以使用[Collections.toArray()](http://developer.android.com/reference/java/util/Collection.html#toArray%28T%5B%5D%29)为自己获取一个字符串数组。

编辑：您似乎并不遵循元素的排序方式，但是，根据 carlspring 的建议，如果您是，只需将 替换`HashSet`为[LinkedHashSet](http://developer.android.com/reference/java/util/LinkedHashSet.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T09:28:36.207

这是如何做到的：

```
public class Foo
{

    public static String[] array1 = { "abc", "def", "ghi" };
    public static String[] array2 = { "xyz", "abc" };

    public static void main(String[] args)
    {
        System.out.println("Using List: " + Arrays.toString(usingList()));
        System.out.println("Using Set: " + Arrays.toString(usingSet()));
    }

    public static String[] usingList()
    {
        List<String> list = new ArrayList<String>();
        list.addAll(Arrays.asList(array1));
        list.addAll(Arrays.asList(array2));

        return list.toArray(new String[list.size()]);
    }

    public static String[] usingSet()
    {
        Set<String> set = new LinkedHashSet<String>();
        set.addAll(Arrays.asList(array1));
        set.addAll(Arrays.asList(array2));

        return set.toArray(new String[set.size()]);
    }

} 
```

使用 a 时`Set`，请确保您使用的是 LinkedHashSet，如果您期望类似数组的排序 - 其中元素保留在您放置它们的索引处。`Set`-s 倾向于在内部重新排序元素，这可能不是您想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T09:11:52.983

你可以使用[HashSet](http://docs.oracle.com/javase/6/docs/api/java/util/HashSet.html)

```
String[] str={"abc","def","ghi"};
    String[] str1={"xyz","abc"};
    Set<String> set=new HashSet<String>();
    for (int i = 0; i < str.length; i++) {
        set.add(str[i]);
    }
    for (int i = 0; i < str1.length; i++) {
        set.add(str1[i]);
    }
    System.out.println(set.toString()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T09:22:06.283

我从旧的 Apache Commons Lang 库中找到了一个单行解决方案。[ArrayUtils.addAll(T[], T...)](http://commons.apache.org/lang/api-3.1/org/apache/commons/lang3/ArrayUtils.html#addAll%28T%5B%5D,%20T...%29)。代码：

String[] both = ArrayUtils.addAll(first, second);

例如:: ArrayUtils.addAll(["a", "b", "c"], ["1", "2", "3"]) = ["a", "b", "c", " 1”、“2”、“3”]

# c# - PHP 等效于 C# string.IsNullOrEmpty 方法？

> ID：10330371
> 
> 赞同：14
> 
> 时间：2012-04-26T09:07:45.370
> 
> 标签：c#, php, string, null

是否有官方等效于 PHP 中的 C# isNullOrEmpty 方法？我知道有空之类的，但这是一样的吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-04-26T09:11:04.113

我`strlen`用于检查字符串是否为空或为空。

```
if (strlen($str) == 0){
    //your code here
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-04-26T09:09:52.540

[empty()](http://php.net/empty)方法也将NULL 视为空值。以及所有这些值：

*   ""（一个空字符串）
*   0（0 为整数）
*   0.0（0 作为浮点数）
*   "0" (0 作为字符串)
*   空值
*   错误的
*   array() （一个空数组）
*   变量$变量；（声明的变量，但在类中没有值）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-26T10:31:51.540

如果你想检查字符串是否为空但不是 0，那么试试这个..

```
if (!is_numeric($str) && empty($str)) 
```

这里`is_numeric`检查字符串是否不是数字值，然后`empty`检查null。

谢谢..

# silverlight - 如何保持 TextBlock Textname 完全居中

> ID：10330372
> 
> 赞同：0
> 
> 时间：2012-04-26T09:07:48.650
> 
> 标签：silverlight, silverlight-5.0

我有一个文本块并指定了它的名称，我保持 Text Alignment="Center" 输出显示为第一行的中心。. .我想要完全居中，我该如何调整？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T09:11:52.093

使用 Grid 会比 Canvas 更容易。例如，您可以这样做：

```
<Grid>
    <TextBlock Text="My text" Width="Auto" Height="Auto" HorizontalAlignment="Center" VerticalAlignment="Center" />
</Grid> 
```

* * *

讨论后编辑：

以下是在 Canvas 中的特定位置添加文本的代码示例：

```
 private void AddText(double x, double y, string textContent)
    {
        var text = new TextBlock()
        {
            Foreground = new SolidColorBrush(Colors.Black),
            Text = textContent
        };
        MyCanvas.Children.Add(text);
        Canvas.SetLeft(text, x);
        Canvas.SetTop(text, y);
    }

// Usage:
AddText(100, 100, "Test"); 
```

# apache2 - 如何为所有路径设置代理位置，除了一些使用 apache2 的路径？

> ID：10330374
> 
> 赞同：9
> 
> 时间：2012-04-26T09:07:53.973
> 
> 标签：apache2, virtualhost, mod-proxy

我的网络服务器上运行了几个网络应用程序：

*   SVN 存储库浏览器，可通过以下方式访问`https://beta.mydomain.tld/svn/repos`
*   Trac 实例，可通过`https://beta.mydomain.tld/trac`
*   我自己的 java Web 应用程序，可通过 访问`http://beta.mydomain.tld/`，使用端口 8080 上的本地 Apache Tomcat 代理

请注意，前两个可通过 SSL 获得，第三个（目前）尚不可用。现在我需要通过 https 使我的网络应用程序可用，但我希望 Trac 和 SVN 浏览器仍然可以在其当前位置访问。

即我正在尝试将apache2 配置为代理所有不以Tomcat 开头`svn`或`trac`以Tomcat 开头的请求。

对于现有的 SSL Web 应用程序，有以下配置

```
 <Location /svn/repos>
        DAV svn
        SVNParentPath /home/myuser/svn
        SVNListParentPath on
        AuthType Basic
        AuthName "Subversion repository"
        AuthUserFile /home/myuser/.htpasswd
        Require valid-user
    </Location>

    <Location /trac>
        SetHandler mod_python
        PythonHandler trac.web.modpython_frontend
        PythonOption TracEnvParentDir /home/myuser/trac
        PythonOption TracUriRoot /trac
        AuthType Basic
        AuthName "Trac"
        AuthUserFile /home/myuser/.htpasswd
        Require valid-user
    </Location> 
```

我试图添加以下位置，但它没有任何帮助......

```
 <Location />
        ProxyPass           http://localhost:8080
        ProxyPassReverse    http://localhost:8080/
    </Location> 
```

有关更多信息，这里是有关 SSL 部分的完整 apache2 配置（其中没有我的任何失败试验 - 我认为这是默认的 trac 配置）：

```
<VirtualHost *:443>
    ServerAdmin webmaster@localhost
    ServerName beta.mydomain.tld:443

    DocumentRoot /var/www/
    <Directory /var/www/>
            Options Indexes FollowSymLinks MultiViews
            AllowOverride None
            Order allow,deny
            allow from all
    </Directory>

    ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
    <Directory "/usr/lib/cgi-bin">
            AllowOverride None
            Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
            Order allow,deny
            Allow from all
    </Directory>

    ErrorLog /var/log/apache2/error.log

    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel warn

    CustomLog /var/log/apache2/ssl_access.log combined

    Alias /doc/ "/usr/share/doc/"
    <Directory "/usr/share/doc/">
            Options Indexes MultiViews FollowSymLinks
            AllowOverride None
            Order deny,allow
            Deny from all
            Allow from 127.0.0.0/255.0.0.0 ::1/128
    </Directory>

    SSLEngine on

    SSLCertificateFile    /etc/ssl/certs/ssl.crt
    SSLCertificateKeyFile /etc/ssl/private/ssl.key

    BrowserMatch ".*MSIE.*" \
            nokeepalive ssl-unclean-shutdown \
            downgrade-1.0 force-response-1.0

    <Location /svn/repos>
        DAV svn
        SVNParentPath /home/myuser/svn
        SVNListParentPath on
        AuthType Basic
        AuthName "Subversion repository"
        AuthUserFile /home/myuser/.htpasswd
        Require valid-user
    </Location>

    <Location /trac>
        SetHandler mod_python
        PythonHandler trac.web.modpython_frontend
        PythonOption TracEnvParentDir /home/myuser/trac
        PythonOption TracUriRoot /trac
        AuthType Basic
        AuthName "Trac"
        AuthUserFile /home/myuser/.htpasswd
        Require valid-user
    </Location> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-04-29T02:52:12.573

只需放 ProxyPass ！进入这两个位置块。这将停止代理相关位置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-13T08:42:02.693

我有相同的场景（在 Windows 上）。对于任何为此苦苦挣扎的人：

当我在 Proxy* 指令*之前*移动“svn location”部分时，它才开始为我工作。

```
<VirtualHost *:443>
  ServerName www.domain.com
  DocumentRoot "C:/Apache/domain"
  ServerAdmin admin@domain.com

  SSLEngine On
  SSLCertificateFile "conf/ssl/domain.crt"
  SSLCertificateKeyFile "conf/ssl/domain.key"
  SSLCertificateChainFile "conf/ssl/domain.ca-bundle.crt"

  <Location /svn>   
    DAV svn
    SVNPath "C:/svnrepo"
    SSLRequireSSL 
    AuthName "www.domain.com"
    AuthType Basic
    AuthUserFile "conf/svn/users"
    AuthGroupFile "conf/svn/groups"
    Require valid-user

    # needs to come before the ProxyPass directives
    ProxyPass !
  </Location>

  ProxyRequests off
  ProxyPreserveHost on

  ProxyPass / ajp://127.0.0.1:8080/
  ProxyPassReverse / ajp://127.0.0.1:8080/    
</VirtualHost> 
```

# java - 如何使用 netbeans 工具在 j2me 代码中打印俄语符号（文本）

> ID：10330375
> 
> 赞同：0
> 
> 时间：2012-04-26T09:07:55.817
> 
> 标签：java

谁能告诉我如何在 j2me 中使用 netbeans 打印俄语符号...

[1] 为此，我使用了自定义文本方法....在此方法中，我们添加了一个带有俄语符号的字体条并将其放入资源文件夹中。[2] 在源代码中，我们采用相同符号的数组及其宽度，并使用该数组打印俄语文本... [3] 但这样做时 netbean 无法读取数组并为它无法识别的符号......

谢谢，请告诉我解决此问题的正当理由和解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T09:16:56.783

确保您的源文件设置了 UTF-8 编码。为此，我使用[Notepad++ 。](http://notepad-plus-plus.org/)有菜单“编码”。它显示当前编码并允许更改文件的编码。

如果要更改编码，请剪切整个文本 (CTRL+X)，更改编码，然后再次粘贴文本。之后保存文件。

如果您只是更改编码而不剪切/粘贴，那么代码中的一些非 ansi 字符串将变得不可读。

# jquery - jquery 和 rails 3 资产管道

> ID：10330376
> 
> 赞同：0
> 
> 时间：2012-04-26T09:07:59.950
> 
> 标签：jquery, ruby-on-rails-3, asset-pipeline

只是一个简单的问题，因为我试图澄清我对资产管道的理解。

所以如果我有

```
 //= require jquery_ujs 
```

在我的 application.js 文件中，这是否意味着 rails 会为我调用必要的库，还是我仍然需要将实际的库放在我的 assets/javascripts 目录中。

我已经阅读了一些文档，但它背后的理论并不完全存在

任何帮助/建议表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T08:29:18.807

我已经找到了答案：当你添加 // require jquery_ui rails 实际上是为此动态调用 js 文件。因此，例如，如果我的 assets/javascripts 目录中有 jquery-ui-1.8.19.custom.min.js，我可以删除它，因为我已经通过资产管道在 application.js 文件中调用它

# php - 从循环内部更改位于循环外部的元素的 css 类

> ID：10330383
> 
> 赞同：0
> 
> 时间：2012-04-26T09:08:41.807
> 
> 标签：php, wordpress

```
<?php if ( have_posts() ) : ?>

<?php
$count = 1;
$featuredPosts = 9;
query_posts('showposts=19');
?>

<div class="articleTile column_3">

<?php while ( have_posts() ) : the_post(); ?>

    <?php if($count > $featuredPosts) : ?> 

        <!--change class to articleList column_2-->

    <?php endif; ?>

<div class="column">

    <?php get_template_part( 'content', 'featured' ); ?>

    <!-- #post-<?php the_ID(); ?> -->

</div>

<?php
$count = $count ++;
endwhile;
?>

</div> 
```

`<div class="articleTile column_3">`当 count 变量达到 10 时，我将如何定位元素并更改其类？

编辑：对不起，我是个白痴。

我已经设法做到了：

```
<?php if ( have_posts() ) : ?>

<?php
$count = 1;
$featuredPosts = 9;
query_posts('showposts=19');
?>

<div class="articleTile column_3">

<?php while ( have_posts() ) : the_post(); ?>

    <?php if($count == $featuredPosts + 1) : ?>

    <?php echo $count ?>
        </div>
        <div class="articleList column_2">

    <?php endif; ?>

<div class="column">
<?php echo $count ?>
    <?php get_template_part( 'content', 'featured' ); ?>

    <!-- #post-<?php the_ID(); ?> -->

</div>

<?php
$count = $count +1;
endwhile;
?>

</div> 
```

如果没有具有不同类的第二个元素，我的原始方法无论如何都不会起作用。我很抱歉。感谢他们帮助我指出正确方向的快速反应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:15:46.257

首先运行 a 循环以检查总计数然后使用它来设置正确的类不是更聪明吗？

大概是这样的？：

```
<?php if ( have_posts() ) : ?>

<?php
$count = 1;
$count_posts = 1;
$featuredPosts = 9;
$class = 'column_3';

query_posts('showposts=19');

/* Run loop */
while ( have_posts() ) : the_post(); 

    $count_posts = $count_posts ++;
endwhile;

if ($count_posts > $featuredPosts) { $class = 'column_2'; }

?>

<div class="articleTile <? echo $class; ?>">

<?php while ( have_posts() ) : the_post(); ?>

<div class="column">

    <?php get_template_part( 'content', 'featured' ); ?>

    <!-- #post-<?php the_ID(); ?> -->

</div>

<?php
$count = $count ++;
endwhile;
?>

</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:14:13.107

您可以在 div 类中添加一个条件，例如

你需要把这个 div 放在一个循环中

```
<div class="<?php echo ($count<=10) ? 'articleTile column_3' : 'articleTile column_5' ?>"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-11T08:26:55.640

这是我使用的：

```
<?php if ( have_posts() ) : ?>

<?php
$count = 1;
$featuredPosts = 9;
query_posts('showposts=19');
?>

<div class="articleTile column_3">

<?php while ( have_posts() ) : the_post(); ?>

    <?php if($count == $featuredPosts + 1) : ?>

    <?php echo $count ?>
        </div>
        <div class="articleList column_2">

    <?php endif; ?>

<div class="column">
<?php echo $count ?>
    <?php get_template_part( 'content', 'featured' ); ?>

    <!-- #post-<?php the_ID(); ?> -->

</div>

<?php
$count = $count +1;
endwhile;
?>

</div> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-04-26T09:18:39.127

```
<div class=<?php echo $class; ?></div> 
```

您可以在要更改类的元素上尝试此操作。

```
$class = "oldclass";
if(a==10){
$class= "newclass";
} 
```

# c - 生产环境中的记录器文件内存不足

> ID：10330384
> 
> 赞同：-2
> 
> 时间：2012-04-26T09:08:43.300
> 
> 标签：c

我正在使用`freopen`C编程语言的功能来跟踪

1.  执行的功能
2.  警告信息
3.  遇到的错误

通过将所有消息路由`stderr`到指定的文本文件。这在测试平台环境中运行良好。但是在生产中，我们遇到了打开的日志文件的内存不足异常，`freopen()`并且服务器正在崩溃。我需要你的帮助来解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:14:16.453

确保您的日志记录代码没有泄漏资源。

`[freopen()](http://linux.die.net/man/3/freopen)`我假设您正在谈论的功能分配内存以保存`FILE`结构，并且很可能为缓冲 I/O 等额外空间。

完成文件后，除非进程即将终止，否则必须`fclose()`调用`freopen()`.

当然，您的代码中可能存在任何数量的其他资源泄漏。不看代码很难做到这一点。

# crontab - 系统 crontab：如何以 root 和用户身份运行脚本

> ID：10330402
> 
> 赞同：1
> 
> 时间：2012-04-26T09:09:39.117
> 
> 标签：crontab

我有一个通宵脚本执行给定用户的家务，然后关闭。关机需要 root 权限，但管理任务需要以正在清理文件的用户身份运行。清理需要一段无法定义的运行时间，因此清理和关闭都必须在同一个脚本中。我的问题是如何使用这两个命令来 cron 脚本，第一个命令需要由普通用户（比如 Bob）运行；只有在第一个完成后，下一个才需要以 root 身份运行（关闭）。我已经尝试过系统 crontab（它可以以 Bob 的身份运行管理员，但随后无法关闭）；并作为 root crontab（可以关闭，但不能以 Bob 身份运行管理任务）。帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T09:54:15.543

您可以使用`sudo`以其他用户身份执行命令。

我在 Debian 上尝试了以下操作。

编写了一个包含以下内容的脚本。

```
#!/bin/bash

echo $HOME 
```

**并以root**身份执行以下命令。

```
sudo -u nonrootuser ./script && some-admin-command 
```

哪个打印`/home/nonrootuser`并执行了`some-admin-command`

这表明 root 能够以普通用户和 root 身份执行。因此，将您的用户内务脚本保留在 中，用 Bob 和shutdown 命令`script`替换并以 root 身份运行它。`nonrootuser``some-admin-command`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-16T07:50:26.530

在文件 cronjob 中，您可以执行以下命令命令：

```
0 5 * * * sudo -u nonrootser -H bash script.sh && some-command-another 
```

您可以编写一个包含以下内容的文件 script.sh：

```
#!/bin/bash
echo "Hello World" 
```

# ajax - Play Framework 2.0 中的 isAjax() 方法在哪里？

> ID：10330403
> 
> 赞同：6
> 
> 时间：2012-04-26T09:09:42.613
> 
> 标签：ajax, playframework-2.0

在 Play Framework 1.x 中，我们可以通过询问方法快速知道请求是否为 AJAX `request.isAjax()`，但我在 Play 2 上找不到。

有什么替代方法或这种方法在哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-27T13:21:45.460

如果您使用 JQuery for Ajax，它会设置以下请求标头：

```
 X-Requested-With: XMLHttpRequest 
```

您可以稍后访问以测试调用是否通过 Ajax 完成。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-03T09:53:31.947

您可以将其定义为方法并在控制器中使用它：

```
def isAjax[A](implicit request : Request[A]) = {
  request.headers.get("X-Requested-With") == Some("XMLHttpRequest")
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-25T17:58:16.763

对于那些不使用 Scala 的人（比如我），这是一个幼稚的 Java 实现

```
/**
 * Check if the request was made via Ajax or not
 * @return
 */
public static Boolean isAjax() {
    String requestWithHeader = "X-Requested-With";
    String requestWithHeaderValueForAjax = "XMLHttpRequest";

    String[] value = request().headers().get(requestWithHeader);
    return
        value != null &&
        value.length > 0 &&
        value[0].equals(requestWithHeaderValueForAjax);
} 
```

# javascript - 单个文本框和提交行为

> ID：10330416
> 
> 赞同：7
> 
> 时间：2012-04-26T09:10:22.750
> 
> 标签：javascript, html

我在表单上有一个没有提交按钮的文本框，如下所示：

```
<html>
    <form action="http://www.google.com">
        <input type="text"/>
    </form>
</html> 
```

当文本框被选中并按下回车键时，表单将被提交并显示谷歌页面。但是，如果我有两个如下文本框：

```
<html>
    <form action="http://www.google.com">
        <input type="text"/>
        <input type="text"/>
    </form>
</html> 
```

现在，如果我按下提交按钮，什么都不会发生。

**谁能在这里解释一下：
i）为什么在第一种情况下提交表单？
ii) 为什么表格在第二种情况下不提交？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T09:17:46.133

[HTML 2.0 规格](http://www.w3.org/MarkUp/html-spec/html-spec_8.html#SEC8.2)：

> 当表单中只有一个单行文本输入字段时，用户代理应接受该字段中的 Enter 作为提交表单的请求。

禁用此行为的最简单方法是添加隐藏输入字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:17:00.070

这可能是因为在 2 个输入字段的情况下，浏览器不知道从哪个输入字段将 Enter 键作为表单提交事件处理。我不确定，但这可能是原因，此外，每当您想向服务器提交数据时，请始终使用按钮，或者您可以在 onClick 函数的字段之一中定义提交事件

# iphone - 带有 ARC 的 Obj-C 代码中的 EXC_BAD_ACCESS 代码 = 2 错误

> ID：10330417
> 
> 赞同：0
> 
> 时间：2012-04-26T09:10:23.710
> 
> 标签：iphone, objective-c, ipad, ios5, automatic-ref-counting

我最近将一些代码转换为 ARC，其中大部分代码不是我自己编写的，但现在我已经尝试了几个小时来解决这个问题。

此代码在不在 ARC 上时运行良好，尽管在分析时它会产生一些潜在的泄漏。

当我运行时，我在第三行得到一个异常：poi[i]=[MapPOI alloc]，但我的猜测是其他段也可能会造成一些麻烦。

```
poi = (__strong MapPOI **)malloc(sizeof(MapPOI *) * dbsize);
for (int i = 0; i < dbsize; i++) {
    poi[i] = [MapPOI alloc];
}
poilayer = (__strong CALayer **)malloc( sizeof(CALayer *) * ( dbsize + (extraDB == nil ? 0 : [extraDB count]) ) );

if (extraDB != nil) {
    extraPOI = (__strong MapPOI **)malloc(sizeof(MapPOI *) * [extraDB count]);
    for (int i = 0; i < [extraDB count]; i++) {
        extraPOI[i] = [MapPOI alloc];
    }
} 
```

有人对为什么这可能会造成麻烦有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T11:08:04.153

> 有人对为什么这可能会造成麻烦有任何想法吗？

好吧，您`-init`对`MapPOI`对象失败了。

此外，您可能应该将它们存储在 NSArrays（或 NSMutableArrays）中。

# c - 有效地使用 siglongjmp

> ID：10330419
> 
> 赞同：3
> 
> 时间：2012-04-26T09:10:26.603
> 
> 标签：c, linux, signals

我有一个类似 shell 的程序，它在循环中运行；它接受很少的命令并执行所需的功能。程序仅在调用“getout”命令时退出。

让我们假设如果发生分段错误信号，我只是处理清理我的程序，而不是退出我只想留在里面的程序。我可以使用 siglongjmp() 调用来实现这一点。

我的问题：当我在恢复函数中再次运行我的 shell 程序时，并且现在发生任何分段错误时，我的信号没有被捕获以进行清理并且程序以分段错误退出。

请提出解决方案：

```
#include <stdio.h>
#include <signal.h>
#include <stdlib.h>
#include <setjmp.h>
sigjmp_buf mark;

void myhandler(int signo)
{
my_action();
siglongjmp(mark,-1);
}

recover()
{
my_program_loop();
}

my_program_loop()
{
/* accept some commands and do some functionality*/
/*some part of the code may cause segfault*/
}

main()
{
     if (sigsetjmp(mark,0) != 0)
    {
        printf("siglongjmp() is called\n");
        recover();
        exit(1);
    }

    struct sigaction myhandle;
    myhandle.sa_handler = myhandler;
    sigemptyset(&myhandle.sa_mask);
    myhandle.sa_flags = 0;
    sigaction(SEGSEGV, &myhandle, NULL);

    my_program_loop();

} 
```

请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:41:32.523

你的 « my_program_loop » 应该有问题，我可以用这段代码很好地捕捉到信号：

```
#include <stdio.h>
#include <signal.h>
#include <stdlib.h>
#include <setjmp.h>

sigjmp_buf mark;

void myhandler(int signo) {
    printf("Sig caught\n");
    siglongjmp(mark, -1);
}

void my_program_loop(void) {
    char *p = NULL;
    *p = 5;
}

void recover(void) {
    my_program_loop();
}

int main(void) {
    struct sigaction myhandle;

    if (sigsetjmp(mark, 0) == -1) {
        recover();
        exit(1);
    }

    myhandle.sa_handler = myhandler;
    sigemptyset(&myhandle.sa_mask);
    myhandle.sa_flags = 0;
    sigaction(SIGSEGV, &myhandle, NULL);

    my_program_loop();

    return 0;
} 
```

# sql-server - 没有服务的 SQL 实例

> ID：10330421
> 
> 赞同：0
> 
> 时间：2012-04-26T09:10:36.423
> 
> 标签：sql-server, sql-server-2008-r2

实例是否有可能在没有与之关联的服务的情况下存在？我的 SQL 配置管理器没有显示实例名称的服务。我无法连接到实例。但 SQL 安装向导会显示该名称的实例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:12:25.750

您可以在远程服务上运行它，但不能完全没有服务。

# android - Webview在android中打开错误的链接

> ID：10330422
> 
> 赞同：-1
> 
> 时间：2012-04-26T09:10:39.277
> 
> 标签：android, webview

我想用文本框中的关键字打开谷歌搜索。链接有点像这样

```
http://www.google.com.vn/#hl=vi&output=search&q= + keyword 
```

然后我`mWebView (WebView object)`用以下代码调用：

```
mWebView.loadUrl(link); 
```

此后，webview 出现（我把它放在一个弹出窗口中）和 google 页面（不是上面查询的结果）。我不知道这有什么问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:29:56.470

尝试类似的东西，

```
mWebView.loadUrl("http://www.google.com/search?q="+value); 
```

如果它不起作用，请发布您的链接网址..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:46:15.400

可能是您没有从文本框中阅读内容，或者没有将其附加到链接中？

# git - 如何将 git 日志导出到文本文件？

> ID：10330425
> 
> 赞同：92
> 
> 时间：2012-04-26T09:10:47.320
> 
> 标签：git

我想将 repo 中所有提交的日志导出到文本文件，有什么办法吗？

* * *

## 回答 #1

> 赞同：148
> 
> 时间：2012-04-26T09:29:57.373

您只需要禁用寻呼机。

```
git --no-pager log > log.txt 
```

如果你想格式化它看起来更好，你可以使用git log 的[参数](http://linux.die.net/man/1/git-log)。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-04-26T09:15:45.420

你试过`git log > log.txt`吗？

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2016-06-02T07:29:21.743

```
git log | clip 
```

复制到剪贴板，然后粘贴到文本文件。

（特别是如果您遇到行尾问题，因此通过这种方法您可以将其复制并粘贴到 Microsoft Word 文档（.docx）中；因此每次提交都会有一个新行！！！）

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2019-01-02T13:29:03.927

您可以使用`>`符号将输出发送到文件。例如：

```
git log > commits.txt 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-02-25T15:02:40.650

```
git log --before="2019-2-23" --pretty=format:'"%h","%an","%ae","%aD","%s",' --shortstat --no-merges | paste - - - > log.txt 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-04-20T07:32:51.110

自从提出这个问题以来已经很久了，到那时事情已经发展了。

***但是***，非常有趣的是，这里的所有答案都是正确的，但并没有真正解决同样很常见***的命令后错误。***让我们试着理解。. . .

谁知道这超级容易。运行一个简单的命令

```
git log -p --all > git_log.txt 
```

但后来我遇到了一个错误

```
> warning: inexact rename detection was skipped due to too many files.
> warning: you may want to set your diff.renameLimit variable to at least 2951 and retry the command. 
```

我们遇到了问题。输出文件是半个演出。

我们只想要 2018 年上半年，我们能够做到这一点，`--after`并且`--until`

```
git log --pretty=format:"%ad - %an: %s" --after="2018-01-01" --until="2018-06-30" > git_log.txt 
```

这很适合我们的目的，很高兴知道我们可以在需要时更改格式。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-03-27T03:42:22.223

您可以使日志报告更清楚，通过

(1) 设置最新提交的数量（例如，在下面的命令中，我们得到最新的 50 个提交，您可以将其更改为 100、500 等）

(2) 在一行中显示长提交该命令是在当前分支中显示提交日志：

```
 git log --oneline -50 > log50_latest_commits.txt 
```

(3) 如果你想在所有分支显示提交

```
 git log --all --oneline -50 > log50_latest_commits.txt 
```

生成的文本文件将位于当前目录。

参考：[https ://git-scm.com/docs/git-log](https://git-scm.com/docs/git-log)

（经过测试`git version 2.11.0.windows.1`，它适用于许多其他版本的 Git）

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-03-24T10:21:28.990

`Git Bash`这对我有用`Windows 7`：

`git log > /C/Users/<user-name>/Desktop/git-log.txt`

**替换`<user-name>`为您的`user name`.**

该文件将从您可以导出的位置导出到您`Desktop`的位置`read`。

祝你好运...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-03-22T05:07:06.693

**就我而言，我发现这很有帮助**

`git log --after="2020-3-20" --pretty=format:'Author : %an %nDate/Time : %aD%nCommit : %s' | paste > log.txt`

这将产生：

作者：你的名字

日期/时间：提交日期时间

提交：提交消息

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-03-09T16:44:24.437

我发现这篇文章可以帮助你。[关于如何生成变更日志的文章](https://herewecode.io/blog/a-beginners-guide-to-git-what-is-a-changelog-and-how-to-generate-it/) 您可以使用的一种工具是变更日志

```
npm install generate-changelog -g
changelog generate 
```

它将创建一个格式良好的 CHANGELOG.md 文件。

问候。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2020-04-08T10:56:05.503

这很简单。如果您不关心保存文件，则需要打开终端

```
cd {your git repository}
git log > your_file_name.txt 
```

如果你需要一个特殊的目录，把所有的路径写在右边，像这样

```
cd {your git repository}
git log > /home/user/logs/your_file_name.txt 
```

例如这个目录，你可以使用任何你需要的东西。我刚才写了一个这样的日志。

[此示例显示如何通过 bash 在文件中写入文本](https://linuxize.com/post/bash-append-to-file/)

# jquery - 你如何解释 jQuery(document).ready()？

> ID：10330426
> 
> 赞同：1
> 
> 时间：2012-04-26T09:10:49.060
> 
> 标签：jquery

函数也是如此`jQuery()`，文档是用作`jQuery()`函数参数的对象。

我想，该`jQuery(document)`函数然后返回一个具有 ready() 方法的对象？这是正确的吗？`jQuery(document)`那么返回什么样的对象呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:14:02.500

jQuery 使用了很多魔法（例如，为了避免使用`new`）。

`jQuery(...)`总是创建一个新的 jQuery 对象，包含零个或多个传递给它的元素（取决于参数）。

jQuery 有一个`ready`方法，因此您可以在任何 jQuery 对象上调用它。使用`$().ready()`or`$(document).ready()`或`$('whatever').ready()`- 它总是会做同样的事情：

```
ready: function( fn ) {
    // Attach the listeners
    jQuery.bindReady();

    // Add the callback
    readyList.add( fn );

    return this;
}, 
```

如您所见，`this`仅返回用于链接 - 函数的实际逻辑根本不使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:15:11.927

> `jQuery(document)`那么返回什么样的对象呢？

它返回一个[jQuery 对象](http://api.jquery.com/Types/#jQuery)：

> jQuery 对象包含文档对象模型 (DOM) 元素的集合，这些元素是从 HTML 字符串创建的或从文档中选择的。

该`jQuery`方法本身记录在这里：[http ://api.jquery.com/jQuery/#jQuery1](http://api.jquery.com/jQuery/#jQuery1)

> 这个函数的第二和第三个公式使用一个或多个已经以其他方式选择的 DOM 元素创建一个 jQuery 对象。此工具的一个常见用途是在已传递给回调函数的元素上调用 jQuery 方法...

该`jQuery(...)`函数通常也缩写为`$(...)`，如：

```
$(document) 
```

基本上，它是 jQuery 库中的第一个常用钩子。你会经常看到它以这种方式使用：

```
$(document).ready(function() {
  // This code gets called once the document has finished loading
  // to the point where you'd want to use the jQuery library against the DOM
}); 
```

以下是该`.ready`方法的文档：

*   [http://api.jquery.com/ready/](http://api.jquery.com/ready/)

> 虽然 JavaScript 提供了在页面呈现时执行代码的加载事件，但在完全接收到所有资产（例如图像）之前，不会触发此事件。在大多数情况下，只要完全构建了 DOM 层次结构，就可以运行脚本。传递给 .ready() 的处理程序保证在 DOM 准备好后执行，因此这通常是附加所有其他事件处理程序并运行其他 jQuery 代码的最佳位置...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T09:16:47.043

参考 jQuery 文档：

[http://api.jquery.com/jQuery/](http://api.jquery.com/jQuery/) - 你对函数的`jQuery( element )`版本感兴趣。`jQuery`它将您传递的元素包装在一个新`jQuery`对象中。然后，此对象包含一个[.ready()](http://api.jquery.com/ready/)方法，您可以在其中将事件处理程序作为函数传递。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T09:24:19.677

如果您使用 typeof 文档，您将获得对象，因此 jQuery(document) 将给出文档的 jQuery 对象。

您可能已经像 $(this) 一样将其视为 jQuery 对象。使用 javascript 关键字 this 我们可以调用所有 dom 方法/属性，但不能调用 jQuery 方法和属性，类似地使用 $(this) 我们可以调用所有 jquery 方法/属性，但不能调用基本 dom 方法和属性。

现在 $(document).ready() 意味着获取 dom 对象文档将其转换为 jQuery 对象并附加就绪函数。

以下是我在 chrome 控制台中给出的几个命令来解释它。

```
typeof document
"object"

$(document).ready
function (a){e.bindReady(),A.add(a);return this}

document.ready
undefined 
```

这里 document.ready 显示 undefined 清楚地表明它不知道 dom 和 $(document).ready 在 jquery 的帮助下显示它的定义

# java - 将 T[]（其中 T 是 Byte[]）返回到 Byte[]

> ID：10330433
> 
> 赞同：3
> 
> 时间：2012-04-26T09:11:30.073
> 
> 标签：java, arrays, generics, java-6

我有一个 Java JUnit 4 测试和一个创建泛型数组的泛型类。当我创建一个方法来返回这个通用数组时，我在返回它时收到一条错误消息。如果我将一个 ArrayList（其中 T 是按类实例化的字节）返回一个 ArrayList，它就可以工作。

为什么数组似乎已实例化且可用（在更复杂的类上测试）但我无法返回对该数组的引用？

**错误：**

```
java.lang.ClassCastException: [Lcom.waikato.assignment.Object; cannot be cast to [Ljava.lang.Byte;
at com.waikato.testing.TestJava.test(TestJava.java:20) 
```

**班级：**

```
public class TestClass<T> {
    T[] array;

    @SuppressWarnings("unchecked")
    public TestClass() {
        array = (T[]) new Object[32];
    }

    public T[] getArray() {
        return array;
    }

    public boolean doThing() {
        T[] t = array;

        return t == array && t != null;
    }
} 
```

**测试：**

```
public class TestJava {

    @Test
    public void test() {
        TestClass<Byte> t = new TestClass<Byte>();
        Byte[] b = t.getArray(); // Crash caused

        assertTrue(t.doThing()); // Works when above line is removed.
        assertTrue(b.length != 0);
    }

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T09:18:19.200

可以通过反射构造“通用”数组：

```
T[] array = (T[]) Array.newInstance(Byte.class, 32) 
```

替换`Byte.class`为对所需类的引用。换句话说：

```
public class TestClass<T> {
    T[] array;

    @SuppressWarnings("unchecked")
    public TestClass(Class<T> type) {
        array = (T[]) Array.newInstance(type, 32);
    }

    public T[] getArray() {
        return array;
    }

    public boolean doThing() {
        T[] t = array;

        return t == array && t != null;
    }
} 
```

您可以这样验证：

```
public static void main(String[] args) {
    TestClass<Byte> test = new TestClass<Byte>(Byte.class);
    // No ClassCastException here
    Byte[] array = test.getArray();
    System.out.println(Arrays.asList(array));
} 
```

`Class<?>`由于类型擦除，如果不使用对象作为构造函数参数，则无法解决此问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T09:21:04.150

```
array = (T[]) new TestClass[32]; 
```

这对我来说看起来不像`Byte[]`，编译器应该警告你泛型转换在运行时被忽略。

这是通用解决方案

```
TestClass(Class<T> tclass){
   //create an array for the generic type
   array = (T[])java.lang.reflect.Array.newInstance(tclass,32);
}

TestClass<Byte> bTest = new TestClass(Byte.class); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T09:51:28.447

有一种方法可以找出通用类型类的实际类型参数。

我刚刚为 Main 类更改了这样的构造函数。

```
public class TestClass<T> {
T[] array;

@SuppressWarnings("unchecked")
public TestClass() {
    Class<T> objClass;
    objClass = (Class<T>) ((ParameterizedType) getClass().getGenericSuperclass()).getActualTypeArguments()[0]; // Found the type paramenter
    array = (T[]) Array.newInstance( objClass, 32);
}

public T[] getArray() {
    return array;
}

public boolean doThing() {
    T[] t = array;

    return t == array && t != null;
} } 
```

和测试方法..

```
@Test
public void test() {
    TestClass<Byte> t = new TestClass<Byte>(){}; // Added {}
    Byte[] b = t.getArray(); 

    Assert.assertTrue(t.doThing()); 
    Assert.assertTrue(b.length != 0);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T09:14:52.367

这一行是错误的：

```
public TestClass() {
    array = (T[]) new TestClass[32];
} 
```

这与您的问题的标题相矛盾，即“T 是字节的位置”，因为 T 被初始化为 TestClass。

一种想法是将数组更改为 List<T>。

# null - ConfigurationManager 找不到 App.config .NET4

> ID：10330435
> 
> 赞同：3
> 
> 时间：2012-04-26T09:11:35.353
> 
> 标签：null, app-config, configurationmanager, assign

StackOverflow 上的第一个问题，所以请善待。

我的 DLL 应用程序找不到我手动添加到项目中的 App.config。我像这样使用 ConfigurationManager：

```
string rootMailTemplate = ConfigurationManager.AppSettings["RootMailTemplate"]; 
```

还有我的 xml 配置文件：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <appSettings>
    <add key="RootMailTemplate" value="D:\Exercise\MailManagement\" />
    <add key="ClientSettingsProvider.ServiceUri" value="" />
  </appSettings>
</configuration> 
```

但是当我运行我的测试时，不知何故拒绝接受这个值和它的空值。

知道为什么吗？如果您需要更多信息，请告诉我！

编辑：固定：

好的伙计们，修复了，用于测试的 app.config 也必须在测试项目中。访问者可以访问函数和方法，但不能访问附加文件。

# msbuild - 如何使用（wix）torch msbuild 任务？

> ID：10330436
> 
> 赞同：4
> 
> 时间：2012-04-26T09:11:35.933
> 
> 标签：msbuild, wix, wix3.5, msbuild-task, msbuild-4.0

我正在尝试从 Wix 构建补丁（msp）。

其中一个步骤指定我必须使用 Torch 任务来创建 wixmst。

我在 Wix.targets 中寻找火炬任务。该任务存在，但没有该任务的文档。

任何人都可以在他们的 Msbuild 脚本中使用 Torch 任务吗？如果是这样，请帮助我如何使用它？

我的意图是使用 torch task 创建 wixmst 文件。通过exe，我们可以像下面那样做。

```
“torch.exe -p -xi 1.0\Product.wixpdb 1.1\Product.wixpdb -out Patch\Diff.Wixmst” 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T17:06:05.660

Torch 任务的源代码可以在这里找到：

[http://wix.codeplex.com/SourceControl/changeset/view/a782416c7fbc#src%2fWixTasks%2fTorch.cs](http://wix.codeplex.com/SourceControl/changeset/view/a782416c7fbc#src%2fWixTasks%2fTorch.cs)

因此命令行选项映射到任务的属性，如下所示：

```
-notidy         LeaveTemporaryFiles
-xo             OutputAsXml
-xi             InputIsXml
-p              PreserveUnmodifiedContent
-out            OutputFile
-a              adminImage
-x              BinaryExtractionPath
-serr           SuppressTransformErrorFlags
-t              TransformValidationType
-val            TransformValidationFlags
<targetInput>   BaselineFile
<updatedInput>  UpdateFile 
```

所以你的命令行可能看起来像这样：

```
 <Target Name="DoTorch">
    <!-- torch.exe -p -xi 1.0\Product.wixpdb 1.1\Product.wixpdb -out Patch\Diff.Wixmst -->
    <Torch PreserveUnmodifiedContent="true" 
           InputIsXml="true"
           BaselineFile="$(TargetFile)"
           UpdateFile="$(UpdateFile)"
           OutputFile="$(PatchOutputFile)" />     
  </Target> 
```

# vb.net - RichTextBox 中的对齐选项

> ID：10330438
> 
> 赞同：1
> 
> 时间：2012-04-26T09:12:02.117
> 
> 标签：vb.net, winforms

我正在开发一个应用程序，我想证明在 RichTextbox 中输入的文本，类似于 Word 文档。

我已经浏览了此链接中的代码

[http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/455a6427-a3a2-4215-89a3-557114dbcddd](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/455a6427-a3a2-4215-89a3-557114dbcddd)

有人在VB代码中有更简单的解决方案吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-29T04:46:15.890

我找到了一个简单的 VB 代码来做到这一点，它工作得很好。链接在这里。

[http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/25045a28-b8c9-4146-9820-1231a58c5925/](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/25045a28-b8c9-4146-9820-1231a58c5925/)

我也在放置代码以防我们丢失链接。

```
' Constants and structures from richedit.h
Const MAX_TAB_STOPS = 32 ' expanded individually
Const PFA_JUSTIFY = 4 ' Left = 1, Center = 2, Right = 3
Const CBSIZE = 188 ' Size of PARAFORMAT2 structure
Const PFM_ALIGNMENT = &H8

Const WM_USER = &H400
Const EM_DISPLAYBAND = WM_USER + 51
Const EM_FORMATRANGE = WM_USER + 57
Const EM_SETPARAFORMAT = WM_USER + 71
Const EM_SETTARGETDEVICE = WM_USER + 72

<StructLayout(LayoutKind.Sequential)> _
Private Structure PARAFORMAT2
    Public cbSize As Int16 'UINT cbSize;
    Public dwMask As Int32 'DWORD dwMask;
    Public wNumbering As Int16 'WORD  wNumbering;
    Public wEffects As Int16  'WORD  wEffects;
    Public dxStartIndent As Int32  'LONG  dxStartIndent;
    Public dxRightIndent As Int32  'LONG  dxRightIndent;
    Public dxOffset As Int32  'LONG  dxOffset;
    Public wAlignment As Int16  'WORD  wAlignment;
    Public cTabCount As Int16  'SHORT cTabCount;
    Public rgxTabs1 As Int32   'LONG  rgxTabs[MAX_TAB_STOPS];
    Public rgxTabs2 As Int32
    Public rgxTabs3 As Int32
    Public rgxTabs4 As Int32
    Public rgxTabs5 As Int32
    Public rgxTabs6 As Int32
    Public rgxTabs7 As Int32
    Public rgxTabs8 As Int32
    Public rgxTabs9 As Int32
    Public rgxTabs10 As Int32
    Public rgxTabs11 As Int32
    Public rgxTabs12 As Int32
    Public rgxTabs13 As Int32
    Public rgxTabs14 As Int32
    Public rgxTabs15 As Int32
    Public rgxTabs16 As Int32
    Public rgxTabs17 As Int32
    Public rgxTabs18 As Int32
    Public rgxTabs19 As Int32
    Public rgxTabs20 As Int32
    Public rgxTabs21 As Int32
    Public rgxTabs22 As Int32
    Public rgxTabs23 As Int32
    Public rgxTabs24 As Int32
    Public rgxTabs25 As Int32
    Public rgxTabs26 As Int32
    Public rgxTabs27 As Int32
    Public rgxTabs28 As Int32
    Public rgxTabs29 As Int32
    Public rgxTabs30 As Int32
    Public rgxTabs31 As Int32
    Public rgxTabs32 As Int32
    Public dySpaceBefore As Int32 'LONG  dySpaceBefore;
    Public dySpaceAfter As Int32 'LONG  dySpaceAfter;
    Public dyLineSpacing As Int32 'LONG  dyLineSpacing;
    Public sStyle As Int16 'SHORT sStyle;
    Public bLineSpacingRule As Byte 'BYTE  bLineSpacingRule;
    Public bOutlineLevel As Byte 'BYTE  bOutlineLevel;
    Public wShadingWeight As Int16 'WORD  wShadingWeight;
    Public wShadingStyle As Int16 'WORD  wShadingStyle;
    Public wNumberingStart As Int16 'WORD  wNumberingStart;
    Public wNumberingStyle As Int16 'WORD  wNumberingStyle;
    Public wNumberingTab As Int16 'WORD  wNumberingTab;
    Public wBorderSpace As Int16 'WORD  wBorderSpace;
    Public wBorderwidth As Int16 'WORD  wBorderWidth;
    Public wBorders As Int16 'WORD  wBorders;
End Structure

<DllImport("user32.dll")> _
Private Shared Function SendMessage(ByVal hWnd As IntPtr, _
                                ByVal msg As Int32, _
                                ByVal wParam As Int32, _
                                ByVal lParam As IntPtr) As Int32
End Function 
```

* * *

> **表单设计器代码在此处**

* * *

```
Private Sub btnSetAlignment_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnSetAlignment.Click

    Dim pf2 As PARAFORMAT2

    rtb.SelectAll()

    pf2.cbSize = CBSIZE
    pf2.dwMask = pf2.dwMask Or PFM_ALIGNMENT
    pf2.wAlignment = PFA_JUSTIFY

    ' Allocate memory for the PARAFORMAT2 struct and
    ' copy the contents of the struct to this memory
    Dim lParam As IntPtr
    lParam = Marshal.AllocCoTaskMem(Marshal.SizeOf(pf2))
    Marshal.StructureToPtr(pf2, lParam, False)

    Dim iRet As Integer
    iRet = SendMessage(rtb.Handle(), EM_SETPARAFORMAT, 0, lParam)

    ' Free allocated memory
    Marshal.FreeCoTaskMem(lParam)

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:39:09.840

看看[扩展 RichTextBox](http://geekswithblogs.net/pvidler/archive/2003/10/15/182.aspx)。它类似于 MSDN 上的示例，但更简单一些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T11:19:50.183

尝试类似的东西

rtbox.SelectionStart = 0 'rtbox 是富文本框的名称
rtbox.SelectionLength = rtbox.Text.Length
rtbox.SelectionAlignment =TextAlignment.Justify

'对于其他文本对齐方式
'rtbox.SelectionAlignment = TextAlignment.Left
'rtbox.SelectionAlignment = TextAlignment.Right
'rtbox.SelectionAlignment = TextAlignment.Center

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-08T17:08:16.990

该解决方案对我不起作用，除非我添加：

```
SendMessage(Handle, EM_SETTYPOGRAPHYOPTIONS, TO_ADVANCEDTYPOGRAPHY, TO_ADVANCEDTYPOGRAPHY) 
```

完整代码：

```
 Private Const EM_SETTYPOGRAPHYOPTIONS As Long = WM_USER + 202
 Private Const TO_ADVANCEDTYPOGRAPHY As Long = 1

 Private sub SetAlignJustify()
    Dim Para As New Paraformat2
    With Para
       .cbSize = CUInt(Marshal.SizeOf(Para))
       .dwMask = PFM_ALIGNMENT
       .wAlignment = value
    End With

    SendMessage(Handle, EM_SETTYPOGRAPHYOPTIONS, TO_ADVANCEDTYPOGRAPHY, TO_ADVANCEDTYPOGRAPHY)

    Dim lpar As IntPtr = Marshal.AllocCoTaskMem(Marshal.SizeOf(Para))
    Marshal.StructureToPtr(Para, lpar, False)
    Dim result As Integer = SendMessage(Handle, EM_SETPARAFORMAT, 0, lpar)
    Marshal.FreeCoTaskMem(lpar)
End Sub 
```

# android - 在android中引用ViewGroup

> ID：10330443
> 
> 赞同：0
> 
> 时间：2012-04-26T09:12:34.643
> 
> 标签：android, viewgroup

我想在一个活动中滑下android中的相对布局。我有以下滑下布局的功能：

```
public void setLayoutAnim_slidedown(ViewGroup panel, Context ctx) {

    AnimationSet set = new AnimationSet(true);

    Animation animation = new TranslateAnimation(
            Animation.RELATIVE_TO_SELF, 0.0f, Animation.RELATIVE_TO_SELF,
            0.0f, Animation.RELATIVE_TO_SELF, -1.0f,
            Animation.RELATIVE_TO_SELF, 0.0f);
    animation.setDuration(800);
    animation.setAnimationListener(new AnimationListener() {

        @Override
        public void onAnimationStart(Animation animation) {
            // TODO Auto-generated method stub
            // MapContacts.this.mapviewgroup.setVisibility(View.VISIBLE);

        }

        @Override
        public void onAnimationRepeat(Animation animation) {
            // TODO Auto-generated method stub

        }

        @Override
        public void onAnimationEnd(Animation animation) {

            // TODO Auto-generated method stub

        }
    });
    set.addAnimation(animation);

    LayoutAnimationController controller = new LayoutAnimationController(
            set, 0.25f);
    panel.setLayoutAnimation(controller);

} 
```

如您所见，第一行中的参数类型为 ViewGroup ..我的问题是如何引用 View 组...

注意我尝试了以下

```
 LayoutInflater inflater = (LayoutInflater) myContext
                        .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                View v = inflater.inflate(R.layout.childView, null); 
```

但这返回 View 而不是 groupView ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:14:59.700

只需键入将返回结果转换为`ViewGroup`，只要您的 R.layout.childView 以 ViewGroup 开头，就可以了：

```
ViewGroup vg = (ViewGroup )inflater.inflate(R.layout.childView, null); 
```

# c# - 如何知道何时在 WPF 中呈现（绘制）了控件（或窗口）？

> ID：10330446
> 
> 赞同：4
> 
> 时间：2012-04-26T09:12:48.153
> 
> 标签：c#, wpf, drawing, rendering

我需要将 Window 的内容存储到图像中，保存并关闭窗口。如果我在 Loaded 事件上关闭窗口，则图像包含窗口，其中一些项目绘制正常，其他一些仅绘制一半或扭曲，而其他则不在图像上。

如果我设置一个计时器并在一段时间后关闭窗口（取决于窗口的复杂性，介于 250 毫秒和 1 秒之间），图像都可以。

看起来窗口需要一些时间才能完全呈现自己。有没有办法知道何时完成此渲染以避免使用 Timer 并在我们知道它已完成渲染时关闭窗口？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-26T09:19:04.167

我认为您正在寻找[ContentRendered](http://msdn.microsoft.com/en-us/library/system.windows.window.contentrendered.aspx)事件

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T10:00:43.550

我在我正在工作的应用程序中遇到了类似的问题，我通过使用以下代码解决了它，尝试一下，如果它有帮助，请告诉我。

```
 using (new HwndSource(new HwndSourceParameters())
                   {
                       RootVisual =
                           (VisualTreeHelper.GetParent(objToBeRendered) == null
                                ? objToBeRendered
                                : null)
                   })
        {
            // Flush the dispatcher queue
            objToBeRendered.Dispatcher.Invoke(DispatcherPriority.SystemIdle, new Action(() => { }));

            var renderBitmap = new RenderTargetBitmap(requiredWidth, requiredHeight,
                                                      96d*requiredWidth/actualWidth, 96d*requiredHeight/actualHeight,
                                                      PixelFormats.Default);

            renderBitmap.Render(objToBeRendered);
            renderBitmap.Freeze();                

            return renderBitmap;
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-19T09:05:50.273

我在 SizeChanged 上使用了该方法。

```
public partial class MyUserControl: UserControl
{

    public MyUserControl()
    {
        InitializeComponent();
        SizeChanged += UserControl_DoOnce; //register
    }

    private void UserControl_DoOnce(object sender, SizeChangedEventArgs e)
    {
        if (ActualHeight > 0)//Once the object has size, it has been rendered.
        {
              SizeChanged -= UserControl_DoOnce; //Unregister so only done once
        }
    }
} 
```

这是我发现在不引用 Window 的情况下从控件可靠地工作的唯一方法。

# java - Java Spring - 将参数注入带有注释的超类

> ID：10330447
> 
> 赞同：2
> 
> 时间：2012-04-26T09:13:03.957
> 
> 标签：java, spring, inheritance, dependency-injection, superclass

我有一个超类，它需要子类来提供超类运行的接口的实现。

我们使用 Spring 和 DI，所以我们不能只用 new 创建实现。

只有在 Spring 初始化之后，子类才会知道要提供哪个 bean，因此使用超级构造函数将不起作用。

我也不想`@PostConstruct`在子类中使用 q setup 方法，因为这需要子类开发人员知道如何设置超类。

我希望超类要求子类提供对实现 bean 的引用，以便它可以设置其成员：

* * *

超类使用 UrlBuilder 接口：

```
public class JsonConnection{

    private UrlBuilder urlBuilder;
} 
```

`UrlBuilderFacebook`子类通过依赖注入提供实现（ ）。

```
@Component
public class FacebookJsonConnection extends JsonConnection {

    @Inject
    private UrlBuilder urlBuilderFacebook;    
} 
```

超类可以是抽象的，也可以是组件的，没关系。重要的是我希望能够创建轻量级的子类，为`UrlBuilder`超类和需要的`@Inject`地方提供。

```
@Inject
private JsonConnection facebookJsonConnection; 
```

或者

```
@Inject
private JsonConnection redmineJsonConnection; 
```

此外，我不希望超类知道哪个子类正在使用它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T09:22:49.663

如果`urlBuilder`需要，`JsonConnection`您可以将其作为构造函数参数传递并使用构造函数注入：

```
public class JsonConnection{
    private UrlBuilder urlBuilder;

    public JsonConnection(UrlBuilder urlBuilder) {
        this.urlBuilder = urlBuilder;
    }
} 

@Component  
public class FacebookJsonConnection extends JsonConnection {
    private UrlBuilder urlBuilderFacebook;
    @Inject
    public FacebookJsonConnection(UrlBuilder urlBuilderFacebook) {
        super(urlBuilderFacebook);
        this.urlBuilderFacebook = urlBuilderFacebook;
    }
} 
```

# internet-explorer - 为什么这在 Opera 中不起作用？

> ID：10330450
> 
> 赞同：-1
> 
> 时间：2012-04-26T09:13:20.907
> 
> 标签：internet-explorer, opera

所以我建立了一个小网站，它使用了很多 CSS3 动画，并且我在其他浏览器中测试过它（我通常使用 Chrome），我注意到 Opera 没有显示任何内容，就像是`opacity`遗骸一样`0`。

更新：我刚刚注意到 IE 最新版本的行为与 Opera 相同。

链接：[http](http://rolandgroza.com/projects/tcsg/) ://rolandgroza.com/projects/tcsg/ ；

有人能告诉我为什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T11:00:33.500

Opera 12 增加了对 CSS3 动画的支持。如果你在 11.6x 中测试，它不会显示任何动画。Opera 12 测试版现已推出，所以请测试一下，看看它是否效果更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T10:58:39.627

Opera 目前不支持 CSS3 动画。[您可以使用http://modernizr.com/ 之](http://modernizr.com/)类的东西来触发仅支持浏览器的动画。动画应该增强现有内容。

# wpf - 鼠标移动不会在 WPF 主窗口外触发

> ID：10330452
> 
> 赞同：10
> 
> 时间：2012-04-26T09:13:24.190
> 
> 标签：wpf, mouse, capture

我想获得相对于屏幕坐标的鼠标位置。我正在使用以下代码来做到这一点。

```
window.PointToScreen(Mouse.GetPosition(window)); 
```

它按预期工作。但是我的 MouseMove 事件没有在 MainWindow 之外触发。也就是说，如果我在恢复窗口的情况下将鼠标移到桌面上。

任何想法表示赞赏。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-26T17:02:34.927

使用 CaptureMouse() 方法。

对于上面的示例，您可以添加：

```
window.CaptureMouse(); 
```

在 MouseDown 事件处理程序内的代码隐藏中。

然后你需要调用：

```
window.ReleaseMouseCapture(); 
```

在 MouseUp 事件处理程序内的代码隐藏中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-05T16:43:23.833

无论按下任何鼠标按钮，我都需要能够在 WPF 窗口之外捕获鼠标位置。我最终使用 Interop 调用 WINAPI GetCursorPos 结合线程而不是窗口事件。

```
using System.Runtime.InteropServices;
using Point = System.Drawing.Point;

[DllImport("user32.dll")]
[return: MarshalAs(UnmanagedType.Bool)]
static extern bool GetCursorPos(ref Point lpPoint);

 public MainWindow()
    {
        InitializeComponent();

        new Thread(() =>
        {
            while (true)
            {
                //Logic
                Point p = new Point();
                GetCursorPos(ref p);

                //Update UI
                Dispatcher.BeginInvoke(new Action(() =>
                {
                    Position.Text = p.X + ", " + p.Y;
                }));

                Thread.Sleep(100);
            }
        }).Start();
    }
} 
```

效果很好！

# facebook - Kohana 中的 Facebook 身份验证错误

> ID：10330454
> 
> 赞同：0
> 
> 时间：2012-04-26T09:13:32.267
> 
> 标签：facebook, authentication, kohana

当我尝试在 Kohana 中进行 Facebook 身份验证时遇到问题。

我要做的是：

在 kohana 我有一个名为 loginview.php 的视图文件，我在其中嵌入了这段代码

```
href="https://www.facebook.com/dialog/oauth?client_id=341106515944015"&redirect_uri=http://verana.ge/fbauth/&scope=user_about_me&state=veranalast">

```

在控制器文件夹中，我有一个名为 fbauth.php 的控制器，其中有这段代码

```
 public function action_index()
{

   $app_id = "341106515944015";
   $app_secret = "79f547b92f34f886cc8d51ca1a5d33e0";
   $my_url = "http://verana.ge/";

  // session_start(); <!-- commented because in Kohana the Session is already started -->

   $code = $_REQUEST["code"];

   if(empty($code)) {
   $_SESSION['state'] = md5(uniqid(rand(), TRUE)); //CSRF protection
         $dialog_url = "https://www.facebook.com/dialog/oauth?client_id=" 
     . $app_id . "&redirect_uri=" . urlencode($my_url) . "&state="
     . $_SESSION['state'];
   echo("<script> top.location.href='" . $dialog_url . "'</script>");
    }

if($_REQUEST["state"] = 'veranalast') {
   $token_url = "https://graph.facebook.com/oauth/access_token?"
   . "client_id=" . $app_id . "&redirect_uri=" . urlencode($my_url)
   . "&client_secret=" . $app_secret . "&code=" . $code;

   $response = file_get_contents($token_url);

   $params = null;

   parse_str($response, $params);

   $graph_url = "https://graph.facebook.com/me?access_token=" 
             . $params['access_token'];

   $user = json_decode(file_get_contents($graph_url));
           echo("Hello " . $user->name);
}
else {
   echo("The state does not match. You may be a victim of CSRF.");
}

} 
```

但是当我点击 facebook 链接并尝试连接时，我收到以下错误消息

```
  ErrorException [ Warning ]: file_get_contents(https://graph.facebook.com/oauth/access_token?client_id=341106515944015&redirect_uri=http%3A%2F%2Fverana.ge%2F&client_secret=79f547b92f34f886cc8d51ca1a5d33e0&code=AQB9jQDcWXNVhPoxhOH-GyJ_0P0UQD9y5wfFy8cfP48TxvlX0VnycEWSpTOC0NWXTyCfssTUHCwFjmZdySy74zor_AQGvtzE5YCkB3asMBhWiiAJhesbFa_GrQIzT7UWiNrbl73CmVz5hell-shwrnavUviuDvpMqg6jCbMBHa6nb39xvidf-P5KOe4wlyR9TG8) [function.文件获取内容]：打开流失败：HTTP 请求失败！HTTP/1.0 400 错误 APPPATH/classes/controller/fbauth.php [32]
27 $token_url = "https://graph.facebook.com/oauth/access_token?"
28 . “client_id=”。$app_id 。“&redirect_uri=”。urlencode($my_url)
29\. “&client_secret=”。$app_secret 。“&代码=”。$代码;
30
31             
32 $response = file_get_contents($token_url);
33             
34 $参数=空；
35                         
36 parse_str($response, $params);
37

```

同样为了仔细检查，我在 Kohana 之外创建了这个函数，它没有问题。

我所做的是在 Kohana 之外我创建了由 index.php 命名的文件，我在其中放置了 html 一个 Facebook 身份验证的标签，接下来我创建了由 testauth.php 命名的文件，我在其中放入了与我放入 fbauth.php 相同的代码和正如我所说，它没有问题。

可能在哪里有简单的方法来解决它，但我不知道。请告诉我如何解决它。

任何想法？

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T09:49:19.723

你试过打开`https://graph.facebook.com/oauth/access_token?client_id=341106515944015&redirect_uri=http%3A%2F%2Fverana.ge%2F&client_secret=79f547b92f34f886cc8d51ca1a5d33e0&code=AQB9jQDcWXNVhPoxhOH-GyJ_0P0UQD9y5wfFy8cfP48TxvlX0VnycEWSpTOC0NWXTyCfssTUHCwFjmZdySy74zor_AQGvtzE5YCkB3asMBhWiiAJhesbFa_GrQIzT7UWiNrbl73CmVz5hell-shwrnavUviuDvpMqg6jCbMBHa6nb39xvidf-P5KOe4wlyR9TG8`吗？它会产生 400 HTTP 错误。一切都好。

# sql - 从数据末尾删除句号

> ID：10330456
> 
> 赞同：0
> 
> 时间：2012-04-26T09:13:45.627
> 
> 标签：sql, sql-server-2008, tsql

这类似于关于 [如何从数据末尾删除句号的问题](https://stackoverflow.com/questions/7443734/how-to-remove-a-full-stop-from-the-end-of-data)

但在这种情况下，数据字段可以是这样的

**我的瓦尔**

```
 abcd.          ->>expected   abcd
 abcd..                       abcd
 abcd .                       abcd 
 abcd ..                      abcd
 ab.abb...                    ab.abb 
```

ETC....

我可以做类似的事情

```
Select case when like '%.' then substring(MyVal ,1,len(MyVal )-1)
       case when like '%..' then substring(MyVal ,1,len(MyVal )-2) 
```

通过匹配每种类型的模式。由于这是手动方式，我正在寻找一种可以删除值字段之后可能出现的任意数量的句号的通用方式。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T09:32:58.377

```
select substring(MyVal, 1, len(MyVal)+1-patindex('%[^.]%', reverse(MyVal))) 
```

**更新：**
如果你也想删除空格，你可以使用它来代替。

```
select substring(MyVal, 1, len(MyVal)+1-patindex('%[^. ]%', reverse(MyVal))) 
```

[SE-数据](https://data.stackexchange.com/stackoverflow/query/67891)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:30:01.030

如果不使用 T-SQL，我不确定这是否可行：

```
DECLARE @Example varchar(max) = 'Hello, Dave....'

SET @Example = LTRIM(RTRIM(@Example))

WHILE SUBSTRING(REVERSE(@Example), 0, 2) = '.'
BEGIN
    SET @Example = SUBSTRING(@Example, 0, LEN(@Example) - 1)
END

SELECT @Example 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T09:52:31.270

您可以创建一个函数，如

```
Create FUNCTION [dbo].[fn_RemoveFullStopsFromEnd] (@Input varchar(255))
Returns varchar(255)
AS
BEGIN
    DECLARE @Output VARCHAR(255) 
    SELECT @OutPut = @Input

    While (Len(@Output) > 0) and (SUBSTRING(@Output,Len(@Output),1) = '.')
    Begin
       SELECT @Output = substring(@Output ,1,len(@Output )-1)
    End
    RETURN @Output
END 
```

用法

```
 select dbo.fn_RemoveFullStopsFromEnd('abcd..') 
```

如果您想从末尾删除空格和句号，可以轻松修改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T12:04:28.813

您可以尝试这种方法：

```
DECLARE @t TABLE(somestrings VARCHAR(20))
INSERT INTO @t VALUES('abcd.')
, ('abcd..')
, ('abcd .')
, ('abcd ..')
, ('ab.abb...');
SELECT somestrings=LEFT(somestrings,LEN(RTRIM(REPLACE(somestrings,'.', ' ')))) FROM @t; 
```

结果：

```
somestrings
--------------------
abcd
abcd
abcd
abcd
ab.abb 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T09:29:26.037

这应该有效：

```
SELECT CASE WHEN CHARINDEX('.', MyVal) > 0 
        THEN RTRIM(LEFT(MyVal, CHARINDEX('.', MyVal) - 1))
        ELSE MyVal 
       END  As NewValue
FROM Table 
```

经测试：

```
declare @t1 table(MyVal varchar(20));
insert into @t1 values('abcd.');
insert into @t1 values('abcd..');
insert into @t1 values('abcd .');
insert into @t1 values('abcd ..');
insert into @t1 values('abcd   . ..');
insert into @t1 values('abcd... . ..');

SELECT   MyVal As FullStopVal
      ,  CASE WHEN CHARINDEX('.', MyVal) > 0 
          THEN RTRIM(LEFT(MyVal, CHARINDEX('.', MyVal) - 1))
          ELSE MyVal  END  As NewValue
FROM @t1 
```

**编辑**：我的方法不喜欢 @MikaelEriksson 已经指出的值中间的点，但它适用于像

```
abcd   . .. 
abcd       ... . ..
abcd... . .. 
```

[不像他的:)]

# jquery - 当我使用 getScript 时，定义的变量在 javascript 文件中不起作用

> ID：10330457
> 
> 赞同：2
> 
> 时间：2012-04-26T09:13:46.553
> 
> 标签：jquery, variables

当我使用`$.getScript`主 javascript 文件中的变量时，无法传递给包含的 js 文件。例如：

```
var tVar = 'Hello World!';
$.getScript('js/setting.js', function() {
    // My callback code
}); 
```

*设置.js*：

```
alert(tVar); 
```

如何将变量传递给包含的文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:16:09.823

可以在包含的 js 文件中使用函数并将变量作为参数传递给该函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:16:37.897

加载的脚本只能访问全局变量。

你有两个选择：

1.  临时创建一个全局变量。
2.  从回调中调用注入的函数。

方法1的代码：

```
var tVar = 'Hello World!';
$.getScript('js/setting.js');
window.get_tVar = function() {
    delete window.get_tVar; // Clean-up
    return tVar;
};
// In settings.js:
function logic() {
    var tVar = window.get_tVar();
} 
```

方法2的代码：

```
var tVar = 'Hello World!';
$.getScript('js/setting.js', function() {
    newGlobalFunc(tVar);
});

// In settings.js:
function newGlobalFunc(tVar) {
    // Do something
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T09:20:02.793

好吧，老实说，我不知道为什么更多的人不这样做，但这就是我所做的

```
// settings.js

var com = {};
com.example = {};    

( function( $ ) {

    com.example.Main = function(){
        var private = {};
        var public = {};

        public.initialize = function( myVar ){
            alert( myVar );
        }

        return public;
    }()

})( jQuery );

// main 
var myVar = 'Hello World!';
$.getScript('js/setting.js', function() {
    com.example.Main.initialize( myVar );
}); 
```

# visual-c++ - CMFCColorButton::SetPalette

> ID：10330458
> 
> 赞同：3
> 
> 时间：2012-04-26T09:13:53.153
> 
> 标签：visual-c++, mfc, mfc-feature-pack, color-palette

最近我开始在我的应用程序中使用 CMFCColorButtons 替换旧的自定义控件。现在我想限制可选择的颜色。

因此，我找到了“SetPalette”方法。我在 OnInitDialog 方法中创建了一个如下所示的 CPalette：

```
// CArray<COLORREF, COLORREF> arrColors is an array of COLORREFS coming
// from my helper class
if (arrColors.GetCount() > 0)
{
    LOGPALETTE* pLogPalette = (LOGPALETTE*) new BYTE[sizeof(LOGPALETTE) + 
                              (arrColors.GetCount() * sizeof(PALETTEENTRY))];
    pLogPalette->palNumEntries = arrColors.GetCount();

    for (int i = 0; i < arrColors.GetCount(); i++)
    {
        COLORREF currentColor = arrColors.GetAt(i);
        pLogPalette->palPalEntry[i].peRed = GetRValue(currentColor);
        pLogPalette->palPalEntry[i].peGreen = GetGValue(currentColor);
        pLogPalette->palPalEntry[i].peBlue = GetBValue(currentColor);
    }

    m_pPalette = new CPalette();
    m_pPalette->CreatePalette(pLogPalette);
    delete []pLogPalette;
} 
```

之后在代码中，创建 CMFCColorButtons 并设置调色板（此对话框中总共有六个颜色按钮），并在 OnInitDialog 中调用：

```
void CMyColorPopUp::InitColorButton(CMFCColorButton* pColorButton, int iColor)
{
    pColorButton->SetPalette(m_pPalette);
    pColorButton->SetColor(iColor);
    pColorButton->SetColumnsNumber(8);
} 
```

行为不符合预期。当我单击该按钮时，调色板是巨大的跨越整个显示器，每个条目只包含一种颜色（如 100 行和 8 列）......

也许您可以帮助解决我的 ColorButton 问题，我在网络上没有找到任何其他帮助。先感谢您！

- 克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:44:49.373

好的，我找到了答案。我只是忘记设置 LOGPALETTE 的系统版本。这只是一行代码：

```
pLogPalette->palVersion = 0x300; 
```

# c# - 如何反序列化此 JSON 以访问其中的每条数据？

> ID：10330459
> 
> 赞同：2
> 
> 时间：2012-04-26T09:13:58.623
> 
> 标签：c#, json, windows-phone-7

如何反序列化这个 JSON？

```
{"totalResult":3,"categories":[{"1":{"categoryName":"plumbers","categoryIconUrl":"","headingName":"plumbers"}},{"2":{"categoryName":"plumbing parts and accessories","categoryIconUrl":"","headingName":"plumbing parts and accessories"}},{"3":{"categoryName":"plumbing services","categoryIconUrl":"","headingName":"plumbing services"}}]} 
```

所以我已经尝试了几件事......目前我可以获得“totalResult”，但是我无法获得其他数据，这是我用来获取我目前获得的信息的数据合约：

```
[DataContract]
public class categories_result
{
    [DataMember(Name="totalResult")]
    public int totalResult {get; set;}
    [DataMember(Name="categories")]
    public category[] results {get; set;}
}
[DataContract]
public class category
{
    [DataMember(Name="categoryName")]
    public string categoryName {get; set;}
    [DataMember(Name="categoryIconUrl")]
    public string categoryIconUrl {get; set;}
    [DataMember(Name="headingName")]
    public string headingName {get; set;}
} 
```

当涉及到作为结果返回的类别类时，我得到以下信息

```
-       results {TrudonMobile.category[3]}  TrudonMobile.category[]
-       [0] {WP7proj.category}  WP7proj.category
    categoryIconUrl Could not evaluate expression   string
    categoryName    Could not evaluate expression   string
    headingName Could not evaluate expression   string 
```

感觉就像我错过了一些东西，但我不确定。

添加：

我想我可能会在实际尝试反序列化的地方添加代码，因为这可能很有用：>

```
 try
            {
                Stream responseStream = e.Result;
                DataContractJsonSerializer ser = new DataContractJsonSerializer(typeof(categories_result));
                categories_result response = (categories_result)ser.ReadObject(responseStream);

            }
            catch (Exception x)
            {
                string bob = x.ToString();
                return;
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:38:43.593

使用[Json.Net](http://json.codeplex.com/)

```
string json =
@"
{
    ""totalResult"": 3,
    ""categories"": [
        {
            ""1"": {
                ""categoryName"": ""plumbers"",
                ""categoryIconUrl"": """",
                ""headingName"": ""plumbers""
            }
        },
        {
            ""2"": {
                ""categoryName"": ""plumbing parts and accessories"",
                ""categoryIconUrl"": """",
                ""headingName"": ""plumbing parts and accessories""
            }
        },
        {
            ""3"": {
                ""categoryName"": ""plumbing services"",
                ""categoryIconUrl"": """",
                ""headingName"": ""plumbing services""
            }
        }
    ]
}
";

dynamic jObj = JsonConvert.DeserializeObject(json);

for (int i = 0; i < jObj.categories.Count; i++)
{
    Console.WriteLine(jObj.categories[i][(i+1).ToString()].categoryName);
} 
```

//或者

```
JObject jObj = (JObject)JsonConvert.DeserializeObject(json);

for (int i = 0; i < jObj["categories"].Count(); i++)
{
    Console.WriteLine(jObj["categories"][i][(i+1).ToString()]["categoryName"]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:21:20.187

Try json.newtonsoft library

```
 string data = "@:{"totalResult":3,"categories":[{"1":{"categoryName":"plumbers","categoryIconUrl":"","headingName":"plumbers"}},{"2":{"categoryName":"plumbing parts and accessories","categoryIconUrl":"","headingName":"plumbing parts and accessories"}},{"3":{"categoryName":"plumbing services","categoryIconUrl":"","headingName":"plumbing services"}}]} ";

        JObject o = JObject.Parse(data);

        JArray alldata = (JArray)(o["category"]); 
```

to access the members in the category class

```
 JObject first = (JObject)category[1]; 
```

# javascript - 带有 HTML5 验证的 JQuery 对话框表单

> ID：10330467
> 
> 赞同：2
> 
> 时间：2012-04-26T09:14:28.853
> 
> 标签：javascript, jquery, html, validation

我正在创建一个 HTML5 示例应用程序，但我坚持做一些简单的事情：-/ 这是我想做的：

我有一个链接，它打开一个 JQuery 模式对话框。在该对话框中，有一个表单（带有 2 个字段）。当我单击“Envoyer”按钮（这是一个 JQuery 按钮......而不是提交按钮）时，我想触发 HTML5 本机验证。如果验证正常，我想执行一些代码，然后关闭对话框。如果验证失败，我想查看浏览器的“提示”并让用户像往常一样修改值。

第一个问题是 JQuery 的“Envoyer”按钮不是提交按钮，事实上，它不会触发 HTML5 验证。

我在那个论坛上找到了解决方法：只需触发点击事件（它正在工作）。所以现在，当我点击“Envoyer”按钮时，就会触发验证。

第二个问题是：如果验证成功，如何执行一个代码，如果验证失败，如何执行另一个代码？我在论坛上找到了该`checkValidity()`方法，该方法可以测试字段（实际工作）或表单的有效性......但我无法使其在表单对象上工作。（错误是：`Uncaught TypeError: Object #<HTMLDivElement>`没有方法'checkValidity'）

第一个问题：为什么我不能在我的表单上调用 checkValidity()（我使用 Chrome 18）

第二个问题：我做了一些有效的东西，但我确信有更好的方法来做到这一点，因为它有点棘手。你能帮忙写一个更干净的代码吗？

这是我完成的代码：

```
 $("#dialog-form").dialog({
        height : '400',
        width : '400',
        modal : true,
        autoOpen : false,
        //position : 'top',
        overlay : {
            backgroundColor : '#000',
            opacity : 0.5
        },
        buttons : {
            'Envoyer' : function() {

                if ($('#dialog-form input[type=text]')[0].checkValidity()) {
                    // If validation is OK for that field, do the stuff and close the modal dialog
                    MyNotes.notesController.createPendingNote();
                    MyNotes.notesController.resetPendingNote();
                    $(this).dialog('close');
                }
                else {
                    // If validation failed, submit the form
                    // to trigger html5 validation
                    $('#dialog-form input[type=submit]').click();
                }
            },
            Cancel : function() {
                $(this).dialog('close');
            }
        }
    }); 
```

# c# - C#窗口定位

> ID：10330470
> 
> 赞同：12
> 
> 时间：2012-04-26T09:14:40.133
> 
> 标签：c#, winforms, positioning, window-handles

使用 Windows 窗体我想将窗口定位到特定的坐标中。我认为可以通过简单的方式完成，但以下代码根本不起作用：

```
public Form1()
{
    InitializeComponent();

    this.Top = 0;
    this.Left = 0;
} 
```

但是，当只获得该窗口的句柄时，它运行良好：

```
public Form1()
{
    InitializeComponent();

    IntPtr hwnd = this.Handle;
    this.Top = 0;
    this.Left = 0;
} 
```

你可以看到我根本没有使用那个指针。我在 MSDN 上发现了以下声明：

> Handle 属性的值是 Windows HWND。如果尚未创建句柄，则引用此属性将强制创建句柄。

这是否意味着我们只能在创建其句柄之后设置窗口位置？设置器顶部/左侧是否在内部使用此句柄？谢谢你的澄清。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-04-26T09:20:41.410

Usually a WinForm is positioned on the screen according to the StartupPosition property.
This means that after exiting from the constructor of Form1 the Window Manager builds the window and positions it according to that property.
If you set **StartupPosition = Manual** then the Left and Top values (Location) set via the designer will be aknowledged.
[See MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.startposition.aspx) for the StartupPosition and also for the [FormStartPosition](http://msdn.microsoft.com/en-us/library/system.windows.forms.formstartposition.aspx) enum.

Of course this remove the need to use `this.Handle`. (I suppose that referencing that property you are forcing the windows manager to build immediately the form using the designer values in StartupPosition)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-26T12:03:57.037

```
public Form1()
{
    InitializeComponent();
    Load += Form1_Load;
}

void Form1_Load(object sender, EventArgs e)
{
    Location = new Point(700, 20);
} 
```

或者：

```
public Form1()
{
    InitializeComponent();
    StartPosition = FormStartPosition.Manual;
    Location = new Point(700, 20);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-01-22T04:54:31.830

您可以像这样设置表单加载事件的位置。这是自动***处理***表单位置。

```
this.Location = new Point(0, 0); // or any value to set the location 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-04-26T09:30:27.500

不太确定原因，但如果您在 Form_Load 事件上添加定位代码，它将按预期工作，而无需显式初始化处理程序。

```
using System;
using System.Windows.Forms;

namespace PositioningCs
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            /*
            IntPtr h = this.Handle;
            this.Top = 0;
            this.Left = 0;
            */
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            this.Top = 0;
            this.Left = 0;
        }
    }
} 
```

# wpf - 为什么当我编写这个 Wpf xmal 代码时 VisualStudio 关闭

> ID：10330474
> 
> 赞同：0
> 
> 时间：2012-04-26T09:14:53.450
> 
> 标签：wpf, visual-studio-2010, c#-4.0

我在 wpf 中编写了一个代码来显示指数，通过接受这两个数字，我创建了一个转换器函数和代码.. 但是在编写此代码后它显示错误，例如“Microsoft Visual Studio 遇到问题，它必须关闭”..然后当我们点击不发送时，它会关闭 Vs2010。这可能是什么问题？代码附在这里...

```
namespace WpfTutSamples
{

    public partial class Exponential : Window
    {
        public Exponential()
        {
            InitializeComponent();
        }
        public double GetValue(double number, double exponent)
        {
            double value = Math.Pow(number, exponent);
            return value;

        }
    }
} 
```

> -----XmlCode

```
<Window x:Class="WpfTutSamples.Exponential"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfTutSamples"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="Exponential" Height="300" Width="300">

    <Window.Resources>
        <ObjectDataProvider x:Key="expCalculator" MethodName="GetValue" ObjectType="{x:Type local:Exponential}">
            <ObjectDataProvider.MethodParameters>
                <sys:Double>4</sys:Double>
                <sys:Double>2</sys:Double>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
    </Window.Resources>

    <Grid>

        <Label Content="Number" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="2"> </Label>

        <TextBox HorizontalAlignment="Left" x:Name="txtNumber" Height="30" VerticalAlignment="Top" Margin="70,1" Width="60"
                 Text="{Binding Source={StaticResource expCalculator}, Path=MethodParametes[0], Mode=OneWayToSource, BindsDirectlyToSource=True}"></TextBox>

        <Label Content="Number" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="2,40"> </Label>
        <TextBox HorizontalAlignment="Left" x:Name="txtpower" Height="30" VerticalAlignment="Top" Margin="70,40" Width="60"
                 Text="{Binding Source={StaticResource expCalculator}, Path=MethodParametes[1], Mode=OneWayToSource, BindsDirectlyToSource=True}"></TextBox>

<Label Content="Result" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="2,80"> </Label>
        <TextBox HorizontalAlignment="Left" x:Name="txtResult" Height="30" VerticalAlignment="Top" Margin="70,80" Width="60"
                 Text="{Binding Source={StaticResource expCalculator}}"></TextBox>

    </Grid>
</Window> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T10:32:32.390

**回答**

也许是因为stackoverflow？您从class'引用`Exponential`class' 方法，该方法创建类实例，实例化等等。`Exponential``ObjectDataProvider``Exponential``ObjectDataProvider`

**解释**

`ObjectDataProvider`绑定到方法需要实例化类，包含调用它的方法。这就是为什么你有无穷无尽的重复。

**解决方法**

`ObjectDataProvider`将方法放在一个单独的类中并在 Exponential.xaml 中引用它

# .net - 在 C# 中测试静态类的扩展方法时，MSTest 抛出“System.TypeInitializationException”

> ID：10330481
> 
> 赞同：2
> 
> 时间：2012-04-26T09:15:16.577
> 
> 标签：.net, visual-studio-2010, unit-testing, mstest

我有一个名为 Helpers 的静态类，其中包含大量简单的辅助方法，包括一些简单的“字符串”扩展方法等：

```
public static string AddSquareBrackets(this string str)
{
     return "[" + str + "]";
} 
```

我有一个测试类和方法如下：

```
[TestMethod()]
public void AddSquareBracketsTest()
{
     Assert.AreEqual("[NAME]", "NAME".AddSquareBrackets());
} 
```

使用默认（无编码）构造函数声明的静态类：

```
namespace Equinoxe.Utilities.Helpers
{
    public static class HELPERS
    { 
```

对 AddSquareBrackets 的调用会引发以下内容：

```
System.TypeInitializationException was unhandled by user code
  Message=The type initializer for 'XXX.Utilities.Helpers.HELPERS' threw an exception.
  Source=XXX.Utilities
  TypeName=XXX.Utilities.Helpers.HELPERS
  StackTrace:
       at XXX.Utilities.Helpers.HELPERS.AddSquareBrackets(String str)
       at XXX.Utilities.Test.HELPERSTest.AddSquareBracketsTest() in C:\DEVELOPMENT\PROJECTS\XXX.NavEgate\XXX.Utilities.Test\HELPERSTest.cs:line 77
  InnerException: System.NullReferenceException
       Message=Object reference not set to an instance of an object.
       Source=XXX.Utilities
       StackTrace:
            at XXX.Utilities.Helpers.HELPERS..cctor() in C:\DEVELOPMENT\PROJECTS\XXX.Utilities\XXX.Utilities\Helpers\HELPERS.cs:line 44
       InnerException:{System.NullReferenceException: Object reference not set to an instance of an object.
   at XXX.Utilities.Helpers.HELPERS..cctor() in C:\DEVELOPMENT\PROJECTS\XXX.Utilities\XXX.Utilities\Helpers\HELPERS.cs:line 44} 
```

我也看过

我正在运行 VS2010

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:28:44.777

在以下位置添加断点：

`C:\DEVELOPMENT\PROJECTS\XXX.Utilities\XXX.Utilities\Helpers\HELPERS.cs:line 44`

在那条线上，有些东西是`null`，那不应该是。

# c# - 如何处理使用MVC路由的IIS子应用程序？

> ID：10330491
> 
> 赞同：2
> 
> 时间：2012-04-26T09:16:17.233
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-routing

我有一个 MVC 应用程序已移动到 wwwroot 中的子文件夹，并且该子文件夹已通过 IIS 成为应用程序。因此，在我的登录页面的 url 看起来像这样之前：

**www.mydomain.com/login**

现在看起来像这样：

**www.mydomain.com/application/login**

该应用程序运行良好，它似乎没有影响路由或我的应用程序中的任何链接。但是，它会导致我像这样引用图像 src 的问题：

```
<img src="/content/images/myimage.png"/> 
```

因为它试图从 url **www.mydomain.com/content/images/myimage.png**检索图像，这显然返回 404。

在我的 global.asax 文件中，我只使用默认路由，我尝试对其进行修改以将子文件夹作为 url 的一部分：

```
routes.MapRoute("Default",
                "application/{controller}/{action}/{id}",
                new { controller = "dashboard", action = "index", id = UrlParameter.Optional }); 
```

但是，现在当我尝试访问根 URL **www.mydomain.com/application**时，我只会得到一个目录列表！如果我尝试直接访问控制器，即 **www.mydomain.com/application/dashboard**，我会得到 404！

有人知道如何通过 MVC 路由处理这种情况吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T09:21:59.970

1.  You don't need to change your routing. It works from entry point to your app.
2.  Use @Url.Content("~/content/images/myimage.png").

Hope this will help.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:33:15.407

试试这个...

```
routes.MapRoute("Application",
                "application/{controller}/{action}/{id}",
                new { controller = "dashboard", action = "index", id = UrlParameter.Optional });

routes.MapRoute("Default",
                "{controller}/{action}/{id}",
                new { controller = "dashboard", action = "index", id = UrlParameter.Optional }); 
```

# python - Python中的“导入安全”是什么意思？

> ID：10330499
> 
> 赞同：7
> 
> 时间：2012-04-26T09:16:45.053
> 
> 标签：python, permissions, nose

我只是遇到了鼻子不会运行标记为可执行的测试的行为（如上[一个问题](https://stackoverflow.com/questions/2378146/why-does-nose-finds-tests-in-files-with-only-644-permission)中所述）。我发现这很令人惊讶，在我了解鼻子的行为之前，我浪费了一些时间试图找出为什么鼻子没有运行我的测试。

在鼻子测试的手册页中，它描述了一个覆盖默认行为的选项：

```
--exe               Look for tests in python modules that are executable.
                    Normal behavior is to exclude executable modules,
                    since they may not be import-safe [NOSE_INCLUDE_EXE] 
```

我的问题是：“进口安全”是什么意思？什么是非导入安全模块的示例？并且可以通过删除可执行位使非导入安全模块成为导入安全模块，还是还有更多？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T09:35:16.700

我不熟悉鼻子，但我很确定“导入安全”的含义是导入模块只会定义事物，而不是开始运行事物。

这个想法是，如果 .py 文件被设计为作为脚本执行，那么它的功能将在执行模块范围代码时启动。这可以防止使用`__name__ == '__main__'`技巧导入，但可能不是。如果不是，则导入它可能会执行与不带参数调用脚本时相同的操作，这在某些情况下可能会很糟糕。

因此，您可以通过传递标志明确告诉鼻子没有这样的可执行脚本会危险地导入`--exe`，或者您可以从脚本中清除可执行权限。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-26T09:29:10.547

“进口安全”没有特定的定义含义。在这种情况下，重点是 Python 模块在导入时可以做一些事情（请记住，导入模块只是意味着执行它并将所有内容保存在其命名空间中）。

如果模块标有可执行位，`nose`则假设是这种情况——并且由于您可能不希望每次运行测试时都发生这种情况，因此它将跳过该模块。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-26T09:27:38.187

它指的是可以作为脚本导入或执行的模块。这通常由以下代码完成：

```
if __name__ == "__main__":
    print "running as script" 
```

如果本来可以执行的脚本没有进行此检查，则导入将立即执行它，这可能会以不需要的副作用或引发异常而结束。

# mysql - 如何使用 Hibernate 在 Struts 2 中的 mySql DB 的 jsp 页面中显示图像（bolb 类型）

> ID：10330503
> 
> 赞同：3
> 
> 时间：2012-04-26T09:16:55.320
> 
> 标签：mysql, hibernate, struts2

我面临一个问题，如何使用 Hibernate 在 Struts 2 中的 mySql DB 的 jsp 页面中显示图像（bolb 类型）？请分享您的观点。提前致谢。

```
 public byte[] getrepImagechange2(int loginid) {

    Criteria criteria = null;
    byte[] repCurrentImage = null;

    try {
        session = sessionFactory.openSession();
        criteria = session.createCriteria(Membersdetails.class).add(Expression.eq("logintable.loginId", loginid));
        List list = criteria.list();
        Iterator itr = list.iterator();
        if (itr.hasNext()) {

            Membersdetails get = (Membersdetails) itr.next();
            repCurrentImage = get.getRepPicture();

            HttpServletResponse response23 = ServletActionContext.getResponse();
            response23.setContentType("image/jpg");
            OutputStream out = response23.getOutputStream();
            out.write(repCurrentImage);
            out.close();

        }
    } catch (Exception e) {
        System.out.println("Exception in getrepImage() :" + e);
    } finally {
        try {

            session.flush();
            session.close();
        } catch (Exception e) {
            System.out.println("Exception in getrepImage resource closing  :" + e);
        }
    }
    return repCurrentImage;
}
  And I am displaying this image in jsp page in a table cell using this code :                     
   <img src="<s:property value="bs"/>" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:42:14.427

我使用以下内容从 JPA（Hibernate Backed）示例中渲染图像，该示例使用 struts2-conventions-plugin，结果类型注释“流”是视图的全部内容：

```
package com.kenmcwilliams.photogallery.action.gallery;

import com.kenmcwilliams.photogallery.orm.Picture;
import com.kenmcwilliams.photogallery.orm.PictureDetails;
import com.kenmcwilliams.photogallery.service.Gallery;
import com.opensymphony.xwork2.ActionSupport;
import java.io.ByteArrayInputStream;
import java.io.InputStream;
import org.apache.struts2.convention.annotation.Result;
import org.springframework.beans.factory.annotation.Autowired;

@Result(type = "stream", params = {
    "contentType", "${contentType}",
    "contentLength", "${contentLength}",
    "contentDisposition", "${contentDisposition}",
    "inputStream", "${inputName}",
    "bufferSize", "${bufferSize}",
    "allowCaching", "${allowCaching}"
})
public class Stream extends ActionSupport {
    @Autowired private Gallery gallery; 
    private String contentType = "text/plain";
    private int contentLength = 0;
    private String contentDisposition = "inline";
    private InputStream inputStream;
    public String inputName = "inputStream";//This should not be required
    private Integer bufferSize = 1024;
    private String allowCaching = "true";
    private Integer id = null;

    @Override
    public String execute() {
        if (id != null){
            //gallery.get
            PictureDetails details = gallery.getPictureDetails(id);
            Picture photo = details.getPictureId();
            this.contentType = details.getContentType();
            System.out.println("Content Type: " + contentType);
            ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(photo.getPicture());
            this.contentLength = photo.getPicture().length;
            System.out.println("Content Length: " + contentLength);
            this.inputStream = byteArrayInputStream;
        }else{
            return ERROR;
        }
        return SUCCESS;
    }

    /**
     * @return the contentType
     */
    public String getContentType() {
        return contentType;
    }

    /**
     * @param contentType the contentType to set
     */
    public void setContentType(String contentType) {
        this.contentType = contentType;
    }

    /**
     * @return the contentLength
     */
    public int getContentLength() {
        return contentLength;
    }

    /**
     * @param contentLength the contentLength to set
     */
    public void setContentLength(int contentLength) {
        this.contentLength = contentLength;
    }

    /**
     * @return the contentDisposition
     */
    public String getContentDisposition() {
        return contentDisposition;
    }

    /**
     * @param contentDisposition the contentDisposition to set
     */
    public void setContentDisposition(String contentDisposition) {
        this.contentDisposition = contentDisposition;
    }

    /**
     * @return the bufferSize
     */
    public int getBufferSize() {
        return bufferSize;
    }

    /**
     * @return the allowCaching
     */
    public String getAllowCaching() {
        return allowCaching;
    }

    /**
     * @param allowCaching the allowCaching to set
     */
    public void setAllowCaching(String allowCaching) {
        this.allowCaching = allowCaching;
    }

    /**
     * @return the inputStream
     */
    public InputStream getInputStream() {
        return inputStream;
    }

    /**
     * @param inputStream the inputStream to set
     */
    public void setInputStream(InputStream inputStream) {
        this.inputStream = inputStream;
    }

    /**
     * @return the id
     */
    public int getId() {
        return id;
    }

    /**
     * @param id the id to set
     */
    public void setId(int id) {
        this.id = id;
    }
} 
```

您还询问了如何显示上述内容，以下是用于显示图片库的 JSP（因此该操作将为该 JSP 提供图像 ID，上述操作将使用该图像 ID 从数据库中获取图片和标题画廊）。

如果我没记错的话，这个画廊会显示四张图片，其中包含显示所有图片所需的行数。

```
<%@taglib prefix="s" uri="/struts-tags"%>
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>JSP Page</title>
    </head>
    <body>
        <h1><s:property value="photoGallery.name"/></h1>
        <table>
            <s:iterator begin="0" end="pictureDetails.size/4" var="row">
                <tr>
                    <s:subset source="pictureDetails" start="4 * #row" count="4">
                        <s:iterator>
                            <s:url forceAddSchemeHostAndPort="true" namespace="/gallery" action="stream" var="streamURL">
                                <s:param name="id" value="id"/>
                            </s:url>
                            <td>
                                <s:a value="%{#streamURL}"><img width="200px" src="<s:property value="#streamURL"/>"/></s:a>
                            </td>
                        </s:iterator>
                    </s:subset>
                </tr>
            </s:iterator>
        </table>
    </body>
</html> 
```

在上面这行可能是这部分可能是你想要的：

```
<img width="200px" src="<s:property value="#streamURL"/>"/> 
```

# c++ - 来自 setsockopt 的错误 22 是什么？

> ID：10330508
> 
> 赞同：1
> 
> 时间：2012-04-26T09:17:20.477
> 
> 标签：c++, setsockopt

我有以下代码返回错误号 22。我在任何地方都找不到 22 指的是什么，有人能指出我可能在哪里找到吗？

```
 if (setsockopt(sock, IPPROTO_TCP, TCP_NODELAY,
                 (char *)&arg, sizeof(arg)) < 0) {
    log.debug("unable to setsockopt TCP_NODELAY: %d", errorNumber());
    return false;
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:20:42.503

Its defined in `errno.h` or somewhere close to it. I would guess it to be EINVAL, but its really implementation dependent. You should check your return values with error code defines, not numeric values.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:21:00.597

It's system specific.

Use e.g. `strerror(3)`, `strerror_r(3)` or `perror(3)` to see error description.

# android - Android 中 ShapeDrawable 的烦人行为

> ID：10330509
> 
> 赞同：6
> 
> 时间：2012-04-26T09:17:20.970
> 
> 标签：android, background, android-linearlayout, shapedrawable

我将 ShapeDrawable 用于 LinearLayouts 背景。形状是由 cod 制作的，因为我需要根据条件为它们动态分配颜色。这是我的自定义形状

```
public class CustomShapeDrawable extends ShapeDrawable {
    private final Paint fillpaint, strokepaint, linePaint = new Paint();
    private int strokeWidth = 3;
    private final boolean disableBottomBorder;

    public CustomShapeDrawable(Shape s, int fill, int stroke, int strokewidth, boolean disablebottomborder) {
        super(s);
        fillpaint = new Paint(this.getPaint());
        fillpaint.setColor(fill);
        strokepaint = new Paint(fillpaint);
        strokepaint.setStyle(Paint.Style.STROKE);
        strokepaint.setStrokeWidth(strokewidth);
        strokepaint.setColor(stroke);
        linePaint.setStyle(Paint.Style.STROKE);
        linePaint.setStrokeWidth(strokewidth + 1);
        linePaint.setColor(fill);
        strokeWidth = strokewidth;
        disableBottomBorder = disablebottomborder;

    }

    public CustomShapeDrawable(Shape s, int fill, int stroke, boolean disablebottomborder) {
        super(s);
        fillpaint = new Paint(this.getPaint());
        fillpaint.setColor(fill);
        strokepaint = new Paint(fillpaint);
        strokepaint.setStyle(Paint.Style.STROKE);
        strokepaint.setStrokeWidth(strokeWidth);
        strokepaint.setColor(stroke);
        linePaint.setStyle(Paint.Style.STROKE);
        linePaint.setStrokeWidth(strokeWidth + 1);
        linePaint.setColor(fill);
        disableBottomBorder = disablebottomborder;
    }

    @Override
    protected void onDraw(Shape shape, Canvas canvas, Paint paint) {
        shape.resize(canvas.getClipBounds().right, canvas.getClipBounds().bottom);
        shape.draw(canvas, fillpaint);

        Matrix matrix = new Matrix();
        matrix.setRectToRect(new RectF(0, 0, canvas.getClipBounds().right, canvas.getClipBounds().bottom), new RectF(strokeWidth / 2, strokeWidth / 2, canvas.getClipBounds().right - strokeWidth / 2,
                canvas.getClipBounds().bottom - strokeWidth / 2), Matrix.ScaleToFit.FILL);
        canvas.concat(matrix);

        shape.draw(canvas, strokepaint);

        if (disableBottomBorder) {
            canvas.drawLine(0 + strokeWidth/2, shape.getHeight(), shape.getWidth() - strokeWidth/2, shape.getHeight(), linePaint);
        }
    } 
```

此 CustomShapeDrawable 用作我的布局的 StateListDrawable，如下所示：

```
 RoundRectShape shapeTopCorners = new RoundRectShape(new float[] { 10, 10, 10, 10, 0, 0, 0, 0 }, null, null);
        ShapeDrawable shapeTopCornersNormal =
                new CustomShapeDrawable(shapeTopCorners, Global.getFleet().getSkins().getBackgroundcolour(), context.getResources().getColor(R.color.item_line), true);
        ShapeDrawable shapeTopCornersPressed =
                new CustomShapeDrawable(shapeTopCorners, context.getResources().getColor(R.color.menu_grey), context.getResources().getColor(R.color.item_line), true);

        StateListDrawable stateTopCornersRounded = new StateListDrawable();
        stateTopCornersRounded.addState(new int[] { android.R.attr.state_focused }, shapeTopCornersPressed);
        stateTopCornersRounded.addState(new int[] { android.R.attr.state_pressed }, shapeTopCornersPressed);
        stateTopCornersRounded.addState(new int[] {}, shapeTopCornersNormal); 
```

一切看起来都很好，布局与我想要的颜色具有相同的形状。丑陋的事情发生在屏幕上我得到另一个元素时，比如键盘或 AlertDialog。当我的应用程序再次获得焦点时，布局变得疯狂，上面有随机线条和伪影。这就是我的意思：

![在此处输入图像描述](../Images/4acbbe82f7232208831039e890aaabfb.png)

我能做些什么来防止或修复这些伪影，因为它们看起来很丑。我不知道为什么会发生这种情况。感谢您为我提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-27T17:14:13.073

没有任何建议，目前唯一可以解决的问题是： - 我在我的活动中创建了一个方法，称为 invalidate() ，其中对于我想要刷新的所有布局，我添加了 layoutId.invalidate() - 每当出现警报对话框时如图所示，调用 invalidate() - 对于所有 EditTexts onFocusChanged 或 onTextChanged，调用 invalidate()

不是一个符合人体工程学的解决方案，但它现在似乎工作。

# emacs - 显示以特定键开头的 Emacs 键绑定

> ID：10330510
> 
> 赞同：30
> 
> 时间：2012-04-26T09:17:27.490
> 
> 标签：emacs, key-bindings

我读过[这个](https://stackoverflow.com/questions/2845934/emacs-print-key-binding-for-a-command-or-list-all-key-bindings)，但我的问题是不同的。我想知道如何在 Emacs 中查看以特定键*开头的键绑定。*我想绑定`f2`，但想知道它当前绑定的是什么。按键序列的按下`C-h` `m`提示。进入`f2`这里导致 Emacs 等待我完成链，因为`f2`单独什么都不做。如何查看所有以*开头*的键绑定`f2`？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-04-26T09:20:38.430

`F2``F1` or `F2``C-h`

In general, typing `F1` or `C-h` after any prefix-binding will list all the bindings using that prefix:

> `describe-prefix-bindings` is an interactive compiled Lisp function in `help.el`.
> 
> Describe the bindings of the prefix used to reach this command. The prefix described consists of all but the last event of the key sequence that ran this command.

`F1` is the more reliable of the two (but only *very* slightly so), as detailed by the following documentation excerpts.

`M-:` `(info "(emacs) Misc Help")` `RET`:

> You can get a list of subcommands for a particular prefix key by typing `C-h` (`describe-prefix-bindings`) after the prefix key. (There are a few prefix keys for which this does not work--those that provide their own bindings for `C-h`. One of these is `<ESC>`, because `<ESC> C-h` is actually `C-M-h`, which marks a defun.)

`M-:` `(info "(emacs) Keys")` `RET`:

> Typing the help character (`C-h` or `<F1>`) after a prefix key displays a list of the commands starting with that prefix. The sole exception to this rule is `<ESC>`: `<ESC> C-h` is equivalent to `C-M-h`, which does something else entirely. You can, however, use `<F1>` to display a list of commands starting with `<ESC>`.

`M-:` `(info "(emacs) Help")` `RET`:

> `C-h` or `<F1>` means "help" in various other contexts as well. For instance, you can type them after a prefix key to view a list of the keys that can follow the prefix key. (A few prefix keys don't support `C-h` in this way, because they define other meanings for it, but they all support `<F1>` for help.)

`M-:` `(info "(elisp) Key Binding Conventions")` `RET`:

> Don't bind `C-h` following any prefix character (including `C-c`).
> If you don't bind `C-h`, it is automatically available as a help character for listing the subcommands of the prefix character.

# iphone - 触摸 UIScrollView 中的图像时在 UIView 中生成图像

> ID：10330511
> 
> 赞同：0
> 
> 时间：2012-04-26T09:17:34.490
> 
> 标签：iphone, ios

在我的应用程序中有一个 UIView，其中一个 UIScrollView 中有一些带有图像（表单服务器）的 UIImageViews 在那里并动态加载。我的要求是当我触摸滚动视图图像中的图像时，必须在 UIView 中生成恰好位于 UIScrollView 图像顶部的图像。为此，我正在使用 UITapGestureRecognizer。图像在 UIView 中生成，但不完全位于 scrollView 图像的顶部。任何人都可以帮助提出建议。

鉴于确实加载了一个静态数组，用于生成我想动态计算的生成图像的坐标

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    xCordArray = [[NSArray  alloc]initWithObjects:@"30",@"78",@"126",@"174",  @"222",@"270",@"318",@"366",@"34",@"82",@"130",@"179",@"226",@"274",@"322",@"369",@"38" ,@"88",@"136", @"183",@"248",@"278",@"316",@"375", nil];
   UITapGestureRecognizer *singleTap = [[UITapGestureRecognizer alloc]     initWithTarget:self action:@selector(singleTapGestureCaptured:)];
   [scrollView addGestureRecognizer:singleTap]; 
   [self populateScrollView];  
   scrollView.delegate = self;
   NSMutableArray *getEffectsImageData = [ud objectForKey:@"getimageeffects"];
   int scrollViewWidth = [getEffectsImageData count]*48;
   [scrollView setContentSize:CGSizeMake(scrollViewWidth, 40)];  
} 
```

在下面的 singleTapGestureCaptured 方法中，使用静态 xCordArray 值生成图像。我想动态生成它。

```
- (void)singleTapGestureCaptured:(UITapGestureRecognizer *)gesture
{ 
    NSUserDefaults *ud = [NSUserDefaults standardUserDefaults];
    NSMutableArray *getEffectsImageData = [ud objectForKey:@"getimageeffects"];
    TonifyAppDelegate *appDelegate = (TonifyAppDelegate *)[UIApplication         sharedApplication].delegate;
    ImageToDrag *img = [[ImageToDrag alloc] init];
    for (int i=0; i<[getEffectsImageData count]; i++)
    {
         UIImageView *ImageView = [imageViewsArray objectAtIndex:i];
         NSString *sfxUrlFileName = [[getEffectsImageData objectAtIndex:i] lastPathComponent];
         NSLog(@"sfxUrlFileName: %@", sfxUrlFileName);
         NSData *imageData = [appDelegate    readSongDataFromDocsDirectory:sfxUrlFileName];
         UIImage *image = [[UIImage alloc] initWithData:imageData];
         CGPoint location = [gesture locationInView:self.scrollView];
         int xc = [[xCordArray objectAtIndex:i] intValue];// i want to calculate this xc dynamically.
         if(CGRectContainsPoint(ImageView.frame,location))
         {
             img = [img initWithImage:image];
             img.frame = CGRectMake(xc,240, 45, 42);
             img.userInteractionEnabled = YES;
             [self.view addSubview:img];
             img.tag = i;
         }  
    }
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T10:04:02.960

我认为你必须替换`img.frame = CGRectMake(xc,240, 45, 42);`它`img.frame = [self.scrollView convertRect:ImageView.frame toView:self.view];`并且它“有效”。但是您的代码中有很多奇怪的地方。考虑为每个图像视图添加一个手势识别器，而不是在滚动视图中添加一个“全局”手势识别器。这样，您就可以摆脱循环，而作为您问题原因的框架设置也变得不那么复杂。

# android - android editText 禁用自动更正

> ID：10330513
> 
> 赞同：3
> 
> 时间：2012-04-26T09:17:45.077
> 
> 标签：android, android-edittext, autocorrect

是否可以有一个带有建议但自动更正关闭的 editText ？我试过了：

```
android:inputType="textFilter"

android:inputType="textFilter|textNoSuggestions" 
```

但是这些代码行禁用了建议。那么我怎样才能只禁用自动更正呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T10:00:54.200

有一个不推荐使用的方法：

```
android:autoText="false" 
```

检查这是否适合您。

# java - 是否有一个类似 ORM 的 java 库，其中包含用于构建 sql 查询的运行时定义的表？

> ID：10330516
> 
> 赞同：0
> 
> 时间：2012-04-26T09:17:48.010
> 
> 标签：java, sql, hibernate, orm

我有以下问题：我们有几个不同的数据库运行我们的程序，所以在编译时确切的数据库结构是未知的。我们现在正在寻找一个允许我们构建查询对象的库，它可以被翻译成几种 SQL 方言并给我们一个普通的查询字符串。

我们搜索类似于常规 ORM 库的东西，例如 Hibernate。我们已经研究了其中的一些，但似乎除了表和列之外的所有这些都在编译时定义为常规的 java 类。如果我在这方面错了，请纠正我。

ORM 方法与我们的方法之间的基本区别在于，我们不想将 java-objects 存储在数据库中，而是将查询生成为 java-objects。为了更清楚地说明我的观点，我将向您展示一些示例代码，这些代码应该可由库执行。

```
QueryObject query = new QueryObject();
query.addSelectedTable("customers");
query.addSelectedColumn("customerID");
query.addSelectedColumn("firstname");
query.addCondition("age < 20");
query.addLimit(10);

System.out.println(query.toMySQL()); 
//prints SELECT customerID, firstname FROM customers WHERE age < 20 LIMIT 10; 
```

我不知道这样的图书馆是否存在，但如果你知道，我很乐意知道。

如果要求更高，还有其他几个功能，那就太好了。例如，它还应该能够将子查询和其他查询类型作为 SELECT 来处理。但这太过分了;-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:32:08.783

你是说[jOOQ](http://www.jooq.org/)还是 CrieriaAPi？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:31:03.713

你检查过[Squiggle-SQL](https://code.google.com/archive/p/squiggle-sql/)吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T09:27:53.187

一种简单的方法是使用自己的配置（hibernateDialect）进行“许多”会话。也许重新初始化（休眠）会话（程序配置）有效 - 从未尝试过。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-27T06:40:34.537

[Apache Cayenne是一个支持](http://cayenne.apache.org/)[通用持久类](http://cayenne.apache.org/doc30/generic-persistent-class.html)的开源 Java ORM 。在运行时，您将通过 API 或通过对 DB 模式进行逆向工程来动态定义您的 DB 映射，然后运行查询，取回类似映射的通用对象。事实上，通过这种方法，您不仅可以获得查询，还可以获得您可能期望的所有其他正常 ORM 功能 - 惰性关系、修改和提交对象的能力等。

# java - 如何创建不均匀范围数随机函数？

> ID：10330517
> 
> 赞同：4
> 
> 时间：2012-04-26T09:17:50.880
> 
> 标签：java, algorithm, random

我们知道经典的范围随机函数是这样的：

```
public static final int random(final int min, final int max) {
    Random rand = new Random();
    return min + rand.nextInt(max - min + 1);  // +1 for including the max
} 
```

我想创建算法函数以在 1..10 之间的范围内随机生成数字，但可能性不均匀，例如：
1) 1,2,3 -> 3/6 (1/2)
2) 4,5,6,7 -> 1/6
3) 8,9,10 -> 2/6 (1/3)

上面的意思是函数有 1/2 的机会返回 1 到 3 之间的数字，1/6 的机会返回 4 到 7 之间的数字，以及 1/3 的机会返回 8 到 10 之间的数字。

有人知道算法吗？

**更新：**
实际上 1..10 之间的范围仅作为示例。我要创建的函数适用于任何数字范围，例如：1..10000，但规则仍然相同：3/6 用于顶部范围（30% 部分），1/6 用于中间范围（下一个40% 部分），底部范围的 2/6（最后 30% 部分）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T09:20:33.307

Use the algorithm:

```
int temp = random(0,5);
if (temp <= 2) {
  return random(1,3);
} else if (temp <= 3) {
 return random(4,7);
} else  {
 return random(8,10);
} 
```

This should do the trick.

EDIT: As requested in your comment:

```
int first_lo = 1, first_hi = 3000; // 1/2 chance to choose a number in [first_lo, first_hi]
int second_lo = 3001, second_hi = 7000; // 1/6 chance to choose a number in [second_lo, second_hi] 
int third_lo = 7001, third_hi = 10000;// 1/3 chance to choose a number in [third_lo, third_hi] 
int second
int temp = random(0,5);
if (temp <= 2) {
  return random(first_lo,first_hi);
} else if (temp <= 3) {
 return random(second_lo,second_hi);
} else  {
 return random(third_lo,third_hi);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T09:24:50.223

您可以使用所需的密度填充所需数字的数组，然后生成随机索引并获取相应的元素。我认为它更快一点，但它可能并不那么重要。类似的东西，这不是正确的解决方案，只是一个例子：

```
1,1,1,2,2,2,3,3,3,4,5,6 ... 
```

或者您可以先使用 if 语句定义域，然后从该域生成一个简单的数字。

```
int x = random(1,6)
if (x < 4) return random(1, 3);
if (x < 5) return random(4, 7);
return random(8, 10); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T09:27:55.573

掷出一个 72 面骰子以从以下阵列中进行选择：

```
// Each row represents 1/6 of the space
[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3,
 4, 4, 4, 5, 5, 5, 6, 6, 6, 7, 7, 7,
 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9,
 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T11:51:57.100

如果您使用整数，这可能会有所帮助：

您需要使用以下功能：

```
f : A -> B 
```

B = [b0, b1] 表示您希望从随机数生成器中获得的值的范围

A = [b0, 2 * b1] 使得 f 的最后一个分支实际上到达 b1

```
f(x) = step((x / 3) , 
    f(x) is part of interval [b0, length(B)/3]
f(x) = step(x)  + E,   
    f(x) is part of interval [length(B) / 3, 2 * length(B) / 3],
    E is a constant that makes sure the function is continuous
f(x) = step(x / 2) + F,   
    f(x) is part of interval [2 * length(B) / 3, length(B)]
    F is a constant that makes sure the function is continuous 
```

解释：在第一个分支上获得相同值需要比在第二个分支上多 3 倍的数字。因此，在第一个分支上获得数字的概率是第二个分支的 3 倍，其值从随机数生成器中均匀分布。这同样适用于第三个分支。

我希望这有帮助！

编辑：修改了间隔，你必须稍微调整一下，但这是我的一般想法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T09:26:53.773

```
final int lut[] = [
  1, 1, 1,
  2, 2, 2,
  3, 3, 3,
  4,
  5,
  6,
  7,
  8, 8,
  9, 9,
  10, 10
];

int uneven_random = lut[random.nextInt(lut.length)]; 
```

或类似的规定...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-27T10:19:24.897

根据要求，这是我的代码（基于 izomorphius 的代码），有望解决我的问题：

```
private static Random rand = new Random();

public static int rangeRandom(final int min, final int max) {
    return min + rand.nextInt(max - min + 1);  // +1 for including the max
}

/**
 * 
 * @param min           The minimum range number
 * @param max           The maximum range number
 * @param weights       Array containing distributed weight values. The sum of values must be 1.0 
 * @param chances       Array containing distributed chance values. The array length must be same with weights and the sum of values must be 1.0 
 * @return              Random number
 * @throws Exception    Probably should create own exception, but I use default Exception for simplicity
 */
public static int weightedRangeRandom(final int min, final int max, final float[] weights, final float[] chances) throws Exception {
    // some validations
    if (weights.length != chances.length) {
        throw new Exception("Length of weight & chance must be equal");
    }

    int len = weights.length;

    float sumWeight = 0, sumChance = 0;
    for (int i=0; i<len; ++i) {
        sumWeight += weights[i];
        sumChance += chances[i];
    }
    if (sumWeight != 1.0 || sumChance != 1.0) {
        throw new Exception("Sum of weight/chance must be 1.0");
    }

    // find the random number
    int tMin = min, tMax;
    int rangeLen = max - min + 1;

    double n = Math.random();
    float c = 0;
    for (int i=0; i<len; ++i) {
        if (i != (len-1)) {
            tMax = tMin + Math.round(weights[i] * rangeLen) - 1;
        }
        else {
            tMax = max;
        }

        c += chances[i];
        if (n < c) {
            return rangeRandom(tMin, tMax);
        }
        tMin = tMax + 1;
    }

    throw new Exception("You shouldn't end up here, something got to be wrong!");
} 
```

使用示例：

```
int result = weightedRangeRandom(1, 10, new float[] {0.3f, 0.4f, 0.3f}, 
    new float[] {1f/2, 1f/6, 1f/3}); 
```

代码在分配子范围边界（tMin 和 tMax）时可能仍然不准确，因为按重量除法会导致十进制值。但我猜这是不可避免的，因为范围数是整数。

可能需要一些输入验证，但为了简单起见，我省略了。

批评，更正和评论非常欢迎:)

# javascript - Clojurescript、JavaScript、SVG、图表、图形

> ID：10330519
> 
> 赞同：8
> 
> 时间：2012-04-26T09:18:05.847
> 
> 标签：javascript, svg, clojure, clojurescript

我正在编写一个客户端应用程序。我想使用 ClojureScript。我想生成矢量图形（图形、图表、折线图）。

我应该读什么？

[唯一的硬性要求是 ClojureScript -- (1) 我喜欢 Clojure，并且想在 Clojure 中完成整个应用程序 (2) 这需要在浏览器中运行]

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-26T21:53:59.940

无耻插件：您可以使用[C2](http://keminglabs.com/c2/)，一个 Clojure/ClojureScript 数据可视化库。[（这里](https://github.com/lynaghk/c2)是Github 。）核心思想与 D3 相同——将数据映射到 DOM 元素——但由于您拥有 Clojure 更强大的语义和数据结构，因此它最终比 D3/JavaScript 更具可组合性。

文档可以使用一些爱，但如果您在 SVG 中制作传统图表，请查看轴和刻度生成助手：

[https://github.com/lynaghk/c2/blob/master/src/cljx/c2/svg.cljx](https://github.com/lynaghk/c2/blob/master/src/cljx/c2/svg.cljx)

[https://github.com/lynaghk/c2/blob/master/src/cljx/c2/ticks.cljx](https://github.com/lynaghk/c2/blob/master/src/cljx/c2/ticks.cljx)

虽然目前还没有正式的 0.1.0 版本，但我们已经在 Keming Labs 的几个大型 Web 和 iOS 项目中使用过它。

如果你有一个特定的可视化，但不确定如何处理，请随时联系我@lynaghk 或打开 Github 问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T13:55:07.947

由于可以在 clojurescript 中使用常规 javascript 库，我想您可以使用[Raphael](http://raphaeljs.com/)或[d3](http://mbostock.github.com/d3/)之类的东西来处理 svg。d3 可能更适合您的需求，尽管使用起来有点困难。

总有直接使用 DOM 的替代方法，您不需要任何教程。[SVG 标准](http://www.w3.org/TR/SVG/)结构良好且易于理解。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-01-28T17:38:24.077

我建议查看 Vega-Lite 和 Vega，它们是围绕图形语法（R 流行的 ggplot2 库背后的力量）的思想设计的。GG 的核心思想是数据可视化被指定为数据属性如何映射到数据可视化美学的声明性描述。Vega-Lite & Vega 在提供交互语法方面更进一步，它允许构建交互式数据可视化和复杂的浏览器视图。此外，它提高了 GG 的声明性质，因为 Vega-Lite 和 Vega 规范被描述为纯数据 (JSON)，这使得它非常符合 Clojure 世界的数据驱动哲学，并为与不同语言等无缝互操作的方式。

Vega-Lite 或多或少是更高杠杆的日常数据科学工具，专注于基于非常简陋的规范提供高杠杆和自动化。它编译为 Vega，它是 Vega-Lite 的较低级别和更强大但自动化程度较低的版本。通常从 Vega-Lite 开始，仅在需要时切换到 Vega 就足够了。

有关 Vega 和 Vega-Lite 的更多信息，请参阅：[https](https://vega.github.io) ://vega.github.io 。

如果您想使用来自 Clojure 或 ClojureScript 的 Vega-Lite 或 Vega，您可能希望查看我编写的一个名为 Oz 的小而灵活的包装器库：

[https://github.com/metasoarous/oz](https://github.com/metasoarous/oz)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-18T04:10:37.957

这是一个老问题，但对于现在找到它的任何人来说，另一种选择是使用[strokes library](https://github.com/dribnet/strokes)，在提出问题时它不可用。Strokes 是 d3.js 的 Clojure 包装器。

# xpages - XPages - 将项目（字段）保存到文档

> ID：10330524
> 
> 赞同：1
> 
> 时间：2012-04-26T09:18:36.200
> 
> 标签：xpages, xpages-ssjs

我在将字段（新字段或现有字段）的值保存到我选择的当前文档时遇到问题：

```
var selectedIDs = getComponent("viewPanel").getSelectedIds();
var doc:NotesDocument = database.getDocumentByID(selectedIDs[0]);
doc.replaceItemValue("Parentid","TEST VALUE");
doc.save; 
```

当我在新文档上使用 replaceItemValue 时，它​​可以正常工作，但这是一个现有的邮件文档，我试图用一个值标记（它将是 ParentID - 将其分配给另一个文档），它根本不想要去工作

有什么建议吗？:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T10:57:06.723

您正在调用`doc.save`，返回字段“保存”（或函数对象？）的值。你必须调用方法`doc.save()`

# cuda - “-arch sm_13”和“-arch sm_20”有什么区别

> ID：10330527
> 
> 赞同：18
> 
> 时间：2012-04-26T09:18:38.253
> 
> 标签：cuda, gpu

我的应用程序需要双精度计算。根据我在谷歌上找到的内容，我应该添加一个标志“-arch sm_13”或“-arch sm_20”。

Q1：“-arch sm_13”和“-arch sm_20”有什么区别？

Q2：“-arch sm_13”和“-arch sm_20”在性能上有区别吗？

我的显卡：GTX 570。

谢谢。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-04-26T10:49:02.257

SM 代表 Streaming Multiprocessor，数字表示架构支持的功能。[您可以在CUDA 编程指南](http://developer.nvidia.com/nvidia-gpu-computing-documentation)第 3.1.2-3.1.4 节中找到一个很好的描述，并且您可以在附录 F 的表格中查看与每个架构相关的特性。

来自[NVCC 手册](http://developer.nvidia.com/nvidia-gpu-computing-documentation)（也包含在工具包中）：

> 为了实现架构演进，NVIDIA GPU 分不同代发布。新一代在功能和/或芯片架构方面引入了重大改进，而同一代中的 GPU 模型显示出轻微的配置差异，这些差异“适度”影响功能、性能或两者。

您的 GPU 具有 Compute Capability 2.0，因此您应该使用 sm_20 使编译器能够使用旧架构中不可用的功能。如果您想要向后兼容，您也*可以*针对 sm_13（或 sm_1x），查看上面的文档，了解如何使用 nvcc 的`-gencode`选项在一次调用 nvcc 中针对多个架构。

关于性能，需要注意的一件事是 sm_1x 不支持 IEEE754 浮点，因此如果您以 sm_13 为目标并在具有 Compute Capability 2.0 或更高版本的设备上运行，那么您可能会发现浮点运行得更快，因为它使用的是 less准确的路径。您还可以使用`-ftz=true -prec-div=false -prec-sqrt=false`选项强制使用 sm_20 或更高版本的不太准确的路径，有关更多信息，请参阅 CUDA 编程指南中的第 5.4.1 节。

# objective-c - 从 iPod touch 第 4 代 (IOS 5.0) 将 UITableview 发送到 airplay

> ID：10330529
> 
> 赞同：3
> 
> 时间：2012-04-26T09:18:41.883
> 
> 标签：objective-c, ios, airplay

我想问一下通过airplay将自定义UIView（没有照片/视频等）作为运行ios 5.0的iPod touch 4th gen的第二个屏幕发送到苹果电视是否可行。可能吗？为此，我需要 iPad 2+ 吗？

提前致谢

瓦西利斯

ps：我读过类似的问题，例如：[我可以为 AirPlay 启用我的应用程序吗？](https://stackoverflow.com/questions/4913408/can-i-enable-my-app-for-airplay)但当时的工具还处于早期版本中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-26T05:15:18.077

如果 airplay 镜像不符合您的需求，请查看 doco [Enriching your app for airplay](http://developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/AirPlayGuide/EnrichYourAppforAirPlay/EnrichYourAppforAirPlay.html)。特别是如何获得对两个屏幕的单独访问权限。您将拥有 2 个 uiwindows，它们可以执行完全独立的活动。

# encryption - 在十六进制编辑器中写评论

> ID：10330531
> 
> 赞同：-1
> 
> 时间：2012-04-26T09:18:49.270
> 
> 标签：encryption, steganography, hex-editors

我使用 HxD 作为我的十六进制编辑器，我想知道是否可以在特定文件的十六进制代码中创建注释。例如，我有一张图片，我在 HxD 中打开它。是否可以在该代码中写注释？

进一步说明：你知道在 html 中你可以放置这样的评论，或者在 javascript 中你可以放置这样的评论 // 或 /* test */? 你如何在十六进制编辑器中做到这一点？还是完全不可能？任何帮助将不胜感激！

背景信息：不，我不是黑客。我是一名平面设计师，我想保护我的图像。我知道使用 exif 或 iptc 或其他元数据标签会更容易，但我研究过并且很容易删除这些标签，使我的工作毫无用处。我注意到使用隐写术，即使调整了图像，图像数据标题也保持不变。但如果图像被重新保存，我放在十六进制文件底部的隐藏文本将被删除。如果上述问题的答案是否定的..如果重新保存图像，是否有任何方法可以防止隐藏文本消失？

非常感谢任何帮助！先感谢您

* * *

**附加信息：我找到了一种将图片转换为文件存储库的方法，可防止您使用 Photoshop 打开该图像。不幸的是，您可以使用microsoft office 和paint 打开它。继承人链接： http: [//www.computerhope.com/issues/ch000861.htm](http://www.computerhope.com/issues/ch000861.htm) 我忘了添加（例如）如果你有一个 .png 图像你必须把它变成一个 .jpg **

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:37:50.640

十六进制不是一种语言或格式规范，它是一种查看二进制数据的方式，所以是的，你可以写“评论”，因为你可以在文件中写文本，但它可能会破坏你的形象，所以我会说这取决于关于它的格式。

我很确定有一些类型的隐写术软件/库可以让您查看保护是否已被破坏。你应该在这个方向上做一些研究。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:40:47.147

有一种叫做[隐写术](http://en.wikipedia.org/wiki/Steganography)的东西，它可以让你将隐藏的信息放入图像中。

在 Code Project 上，有一位作者写[了很多](http://www.codeproject.com/Articles/Corinna-John#Articles)关于它的文章。例如，有一篇文章将[信息隐藏在图像](http://www.codeproject.com/Articles/4877/Steganography-Hiding-messages-in-the-Noise-of-a-Pi)中，她还有其他几篇文章将信息隐藏在各种“容器”中，甚至是[在 HTML 文档中隐藏二进制数据](http://www.codeproject.com/Articles/8792/Steganography-13-Hiding-Binary-Data-in-HTML-Docume)等不常见的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-06T13:52:17.997

在 PNG 文件中，您可以执行以下操作。

`@tEXtcomment.YOUR.Comment.HeRe.XdV`

文件有分隔符并且因文件类型而异。大多数情况下，这种东西用于图像。如果您执行类似的搜索，您可以找到其他文件格式。

对不起，因为我在术语上失败了，所以没有更多帮助，但是这个评论块有效。

与往常一样，保存并测试。

# wix - 在 WiX 中，ProductCode 在哪里指定？

> ID：10330534
> 
> 赞同：21
> 
> 时间：2012-04-26T09:19:10.210
> 
> 标签：wix

我正在使用 WiX 创建安装程序，为了从命令行（使用`MsiExec.exe /X{...}`）卸载我的应用程序，我需要知道 .msi 文件的 ProductCode。

当我安装我的应用程序时，我可以看到`ProductCode`安装日志文件中列出了 。但是，显示的 GUID 在我的 WiX 文件中没有任何功能。我的安装程序的版本之间似乎也发生了变化。

`ProductCode`我可以在我的 WiX`.wsx`文件中指定某个位置吗？如果有，在哪里？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-04-26T10:40:43.500

产品代码是产品元素的 ID。

指定向导

```
<Product Id="INSERT_GUID_HERE" 
```

指定 '*' 使 GUID 每次都自动生成

```
<Product Id="*" 
```

或者您可以将产品代码作为变量存储在 config.wxi 文件中并像这样引用它

```
<Product Id="$(var.MyProductCode)" 
```

# java - 使用 AppEngine 获取 Https URL

> ID：10330536
> 
> 赞同：2
> 
> 时间：2012-04-26T09:19:13.657
> 
> 标签：java, google-app-engine

这边表示可以通过提供的代码支持https。但是，Appengine SDK 抱怨说：

```
java.net.InetAddress is not supported by Google App Engine's Java runtime environment

java.net.Socket is not supported by Google App Engine's Java runtime environment 

javax.net.ssl.SSLSession is not supported by Google App Engine's Java runtime environment 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:38:15.233

请参阅 urlfetch（适用于 Java 和 Python）：[https ://developers.google.com/appengine/docs/java/urlfetch/](https://developers.google.com/appengine/docs/java/urlfetch/)

> App Engine 应用程序可以通过获取 URL 与其他应用程序通信或访问网络上的其他资源。应用程序可以使用 URL Fetch 服务来发出**HTTP 和 HTTPS**请求并接收响应。URL Fetch 服务使用 Google 的网络基础设施来提高效率和扩展性。

**例子：**

```
import java.net.MalformedURLException;
import java.net.URL;
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.IOException;

// ...
        try {
            URL url = new URL("http://www.example.com/atom.xml");
            BufferedReader reader = new BufferedReader(new InputStreamReader(url.openStream()));
            String line;

            while ((line = reader.readLine()) != null) {
                // ...
            }
            reader.close();

        } catch (MalformedURLException e) {
            // ...
        } catch (IOException e) {
            // ...
        } 
```

* * *

**关于 HTTP(S)：**

> 要获取的 URL 可以使用**以下范围内的任何端口号：80-90、440-450、1024-65535**。如果 URL 中未提及端口，则方案隐含该端口：http://... 为 80 端口，https://... 为 443 端口。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:26:08.240

您必须使用 URL Fetch API。

这是参考。[https://developers.google.com/appengine/docs/java/urlfetch/overview#Secure_Connections_and_HTTPS](https://developers.google.com/appengine/docs/java/urlfetch/overview#Secure_Connections_and_HTTPS)

# css - 如果有超链接，则更改列表样式类型 - 没有 javascript/jQuery

> ID：10330538
> 
> 赞同：5
> 
> 时间：2012-04-26T09:19:16.990
> 
> 标签：css

> **可能重复：**
> [活动孩子的父母的复杂 CSS 选择器](https://stackoverflow.com/questions/45004/complex-css-selector-for-parent-of-active-child)

我有以下代码：

```
<li>
  <a href="jsfiddle.net">Text</a>
</li>
<li>
  only text
</li>​ 
```

我已将 css 应用于 li 元素：

```
li {list-style-type: circle;} 
```

我希望悬停时的元素 li 应该有**list-style-type:disc**，但**前提是**它里面有一个**锚元素**。我知道它是使用 javascript 的小菜一碟，但是否有可能在没有 javascript 的情况下实现这一目标？

我已经尝试过这样的事情，但无法实现：http: [//jsfiddle.net/k5SQe/](http://jsfiddle.net/k5SQe/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:22:59.203

CSS 中没有“父”选择器。您不能`<li>`根据给定的要求向元素添加圆形样式。

不过，可以将项目符号添加到锚点**：http: [//jsfiddle.net/k5SQe/31/](http://jsfiddle.net/k5SQe/31/)**

```
li:hover a {
    display: list-item;
    list-style-type: disc;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:26:19.933

根据您的情况，向`<li>`包含链接的元素添加一个类。

[http://jsfiddle.net/k5SQe/10/](http://jsfiddle.net/k5SQe/10/)

# c# - 如何从 c# 获取和设置带有参数的 vb6 属性？

> ID：10330539
> 
> 赞同：3
> 
> 时间：2012-04-26T09:19:28.110
> 
> 标签：c#, vb6

我需要从 vb6 对象获取和设置带有参数的属性：

```
Property Prop(ByVal type As SomeEnum) As Currency 
```

这就是我创建对象实例的方式：

```
dynamic obj = Activator.CreateInstance(Type.GetTypeFromProgID(progID)); 
```

我在 c# 中尝试了 vb6 语法，但它不起作用（甚至无法编译）：

```
obj.Prop(enumValue) = 1.2m; 
```

所以问题是：如何从 c# 获取和设置带有参数的 vb6 属性？

**编辑：**

此方法不适用于`dynamic`. AFAIK 它适用于 COM 互操作：

```
obj.get_Prop(enumValue);
obj.set_Prop(enumValue, newValue); 
```

反射方法工作得很好，但它太冗长了：

```
obj.GetType().InvokeMember("Prop", System.Reflection.BindingFlags.Public |
    System.Reflection.BindingFlags.SetProperty, null, obj,
    new object[] { enumValue, 1.2m }); 
```

属性索引器方法也适用：

```
obj.Prop[enumValue] = 1.2m; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-27T18:50:08.020

在 C# 中，属性索引器像数组一样编写。

```
obj.Prop[enumValue] = 1.2m; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:20:58.713

我对此不是 100% 确定，但我相信 VB6 COM 对象中的属性实际上已转换为 C# 中的方法。

所以一个 Property Get 将是 obj.get_Prop(); 一个属性集是 obj.set_Prop(newValue);

# javascript - 灯箱加载内容而不被触发

> ID：10330540
> 
> 赞同：-1
> 
> 时间：2012-04-26T09:19:30.780
> 
> 标签：javascript, jquery, css

我正在使用一个简单的灯箱，或者您可以将其称为模态窗口。它不会加载任何 Flash 内容，直到您单击按钮 PLAY 并且当您单击关闭时，它会停止 Flash 游戏（它实际上会停止，因为当您再次单击 PLAY 时游戏会从头开始）但这只是关于 FIREFOX 它的不是 CHROME、IE 或 Safari 中的行为，除了 MOZILLA FIREFOX，所有浏览器都以完全不同的方式运行，这与我上面描述的方式相反。

在 chrome、IE、Safari 中，可能会在 Opera 中加载 Flash 内容而不会被触发（意味着如果您不点击 PLAY BUTTON 仍然会加载），即使您点击关闭按钮也是如此。flash 游戏不会像 Firefox 中那样停止 flash，而是继续运行（就像被最小化而不是关闭）。

为什么会发生这种情况，如何解决，我无法理解这种奇怪的行为？

相关代码： CSS：

```
#fade { 
    display: none; 
    background: #000;
    position: fixed; left: 0; top: 0;
    width: 100%; height: 100%;
    opacity: .80;
    z-index: 9999999;
}

.popup_block{
   width: 98.95%; height: 98.2%;
    display: none; 
    padding: 0px;
    line-height:1em;
    font-size: 1em;
    position: fixed;
    top: 0px; left: 0px;
    z-index: 999999999;
    -webkit-box-shadow: 0px 0px 20px #000;
    -moz-box-shadow: 0px 0px 20px #000;
    box-shadow: 0px 0px 20px #000;
    -webkit-border-radius: 10px;
    -moz-border-radius: 10px;
    border-radius: 10px;
}
.close {
    height:20px;
    float: right;
    margin: 0 2px 0 0;   
} 
```

HTML：

```
<table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody>
<tr><td style="text-align: center;"><a class="poplight" href="#?w=100%" rel="popup_name"><img alt="play game" class="happybutton" onmouseout="this.style.opacity=0.8;this.filters.alpha.opacity=80" onmouseover="this.style.opacity=1;this.filters.alpha.opacity=100" src="http://farm5.static.flickr.com/4084/4998558471_27e3985c16_m.jpg" style="opacity: 0.8;" /></a></td></tr>
</tbody></table>
<div class="popup_block" id="popup_name">
<div class="gamesharebuttons addthis_toolbox addthis_default_style ">
<a class="addthis_button_facebook_like" fb:like:layout="button_count"></a><a class="addthis_button_tweet"></a><a class="addthis_button_google_plusone" g:plusone:size="medium"></a><a class="addthis_button_more">Share</a></div>
<iframe id="myvideo" width="100%" height="98%" src="http://files.cryoffalcon.com/bhgames/Adventure/star%20island.html" frameborder="0" scrolling="no" allowTransparency="false"
></iframe>
</div> 
```

JS：

```
<script type="text/javascript">
$(document).ready(function(){

    //When you click on a link with class of poplight and the href starts with a # 
    $('a.poplight[href^=#]').click(function() {
        var popID = $(this).attr('rel'); //Get Popup Name
        var popURL = $(this).attr('href'); //Get Popup href to define size

        //Pull Query &amp; Variables from href URL
        var query= popURL.split('?');
        var dim= query[1].split('&amp;');
        var popWidth = dim[0].split('=')[1]; //Gets the first query string value

        //Fade in the Popup and add close button
        $('#' + popID).fadeIn().css({ 'width': Number( popWidth ) }).prepend('<a href=";#"; title=";Close It"; class=";close";><img src=";http://files.cryoffalcon.com/bloghuts/images/close%20button.png"; alt=";Close"; width=";20"; height=";20"; /></a>');

        //Define margin for center alignment (vertical + horizontal) - we add 80 to the height/width to accomodate for the padding + border width defined in the css
        var popMargTop = ($('#' + popID).height() + 0) / 0;
        var popMargLeft = ($('#' + popID).width() + 0) / 0;

        //Apply Margin to Popup
        $('#' + popID).css({ 
            'margin-top' : -popMargTop,
            'margin-left' : -popMargLeft
        });

        //Fade in Background
        $('body').append('<div id=";fade";></div>'); //Add the fade layer to bottom of the body tag.
        $('#fade').css({'filter' : 'alpha(opacity=80)'}).fadeIn(); //Fade in the fade layer 

        return false;
    });

    //Close Popups and Fade Layer
    $('a.close, #fade').live('click', function() { //When clicking on the close or fade layer...
        $('#fade , .popup_block').fadeOut(function() {
            $('#fade, a.close').remove();  
    }); //fade them both out

        return false;
    });

});

</script> 
```

这是现场演示页面[http://bloghutsbeta.blogspot.com/2012/04/fullscreen-testing.html](http://bloghutsbeta.blogspot.com/2012/04/fullscreen-testing.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T09:39:05.357

添加`display:none`到`iframe`包含您的 flash 的内容似乎并不能阻止 flash 在后台播放，那么您如何将其从页面中删除，将其存储在一个变量中以便按需添加。您看起来将拥有多个灯箱，因此您可以将它们存储在一个对象中。

所以在页面加载：

```
var popups = {};
$("a.poplight").each(function(){
  var $that = $("#" + $(this).attr('rel'));
  popups[$that.attr("id")] = $that.html(); //store the object in an object for later
  $that.html(""); //only empty it, don't remove it, so we can use it late
}); 
```

然后在您的`$('a.poplight[href^=#]').click`通话中，在淡入弹出窗口之前：

```
$('#' + popID).html(popups['#' + popID]); 
```

希望这有效，我已经足够清楚了！

## 实施的

```
<script type="text/javascript">
var popups = {};
$(document).ready(function(){
    $("a.poplight").each(function(){
       var $that = $("#" + $(this).attr('rel'));
       popups[$that.attr("id")] = $that.html(); //store the object in an object for later
       $that.html(""); //only empty it, don't remove it, so we can use it late
    });
    //When you click on a link with class of poplight and the href starts with a # 
    $('a.poplight[href^=#]').click(function() {
        var popID = $(this).attr('rel'); //Get Popup Name
        var popURL = $(this).attr('href'); //Get Popup href to define size

        //Pull Query &amp; Variables from href URL
        var query= popURL.split('?');
        var dim= query[1].split('&amp;');
        var popWidth = dim[0].split('=')[1]; //Gets the first query string value

        //Put the html back in
        $('#' + popID).html(popups['#' + popID]);

        //Fade in the Popup and add close button
        $('#' + popID).fadeIn().css({ 'width': Number( popWidth ) }).prepend('<a href=";#"; title=";Close It"; class=";close";><img src=";http://files.cryoffalcon.com/bloghuts/images/close%20button.png"; alt=";Close"; width=";20"; height=";20"; /></a>');

        //Define margin for center alignment (vertical + horizontal) - we add 80 to the height/width to accomodate for the padding + border width defined in the css
        var popMargTop = ($('#' + popID).height() + 0) / 0;
        var popMargLeft = ($('#' + popID).width() + 0) / 0;

        //Apply Margin to Popup
        $('#' + popID).css({ 
            'margin-top' : -popMargTop,
            'margin-left' : -popMargLeft
        });

        //Fade in Background
        $('body').append('<div id=";fade";></div>'); //Add the fade layer to bottom of the body tag.
        $('#fade').css({'filter' : 'alpha(opacity=80)'}).fadeIn(); //Fade in the fade layer 

        return false;
    });

    //Close Popups and Fade Layer
    $('a.close, #fade').live('click', function() { //When clicking on the close or fade layer...
        $('#fade , .popup_block').fadeOut(function() {
            $('#fade, a.close').remove();  
    }); //fade them both out

        return false;
    });

});

</script> 
```

# http - Meteor HTTP GET 在 Mongo 循环中崩溃

> ID：10330541
> 
> 赞同：0
> 
> 时间：2012-04-26T09:19:32.340
> 
> 标签：http, crash, get, meteor

目前遇到一个非常令人沮丧的问题。

我可以进行 Meteor.http.get 调用，但是当我把它放在一个循环中时，就会发生不好的事情。

我不是 100% 确定我在做什么，所以任何指针都会很棒！

此代码有效 - 它是咖啡脚本

```
Meteor.http.get("http://some_site.com/feed.rss", (error, results)->
  console.log "results: " + results.statusCode 
  if results.statusCode is 200
    console.log results.content
) 
```

此代码崩溃：

```
things.forEach( (thing) ->
  console.log thing.url  # it logs http://some_site.com/feed.rss
  Meteor.http.get(thing.url, (error, results) ->
    if results.statusCode is 200
      console.log results.content
  )
)) 
```

出现此错误：

```
node.js:201
    throw e; // process.nextTick error, or 'error' event on first tick
          ^
TypeError: Cannot read property '_meteor_dynamics' of undefined
at Object.bindEnvironment (app/packages/meteor/dynamics_nodejs.js:48:44)
at Object.call (app/packages/http/httpcall_server.js:72:25)
at Object.get (app/packages/http/httpcall_common.js:40:29)
at app/craftcandy.coffee.js:112:28
at app/packages/mongo-livedata/mongo_driver.js:307:7
at /usr/local/meteor/lib/node_modules/mongodb/lib/mongodb/cursor.js:173:11
at [object Object].nextObject (/usr/local/meteor/lib/node_modules/mongodb/lib/mongodb/cursor.js:485:5)
at Object.callback (/usr/local/meteor/lib/node_modules/mongodb/lib/mongodb/cursor.js:478:12)
at Array.0 (/usr/local/meteor/lib/node_modules/mongodb/lib/mongodb/connection/server.js:197:36)
at EventEmitter._tickCallback (node.js:192:41) 
```

退出并显示代码：1 您的应用程序正在崩溃。等待文件更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T16:24:39.053

我认为这可能是因为meteor 在底层使用了node.js，而node.js 是异步且非阻塞的。

因此，与其检查 results.statusCode，不如放入回调（请原谅我的咖啡脚本）：

```
things.forEach( (thing) ->
   console.log thing.url  # it logs http://some_site.com/feed.rss
   Meteor.http.get(thing.url, (error, results) ->
      results.on('data', (d) ->
        //Do something here with the data stream
      )

      results.on('end', (rslts) ->
         //Do something here with the results stream, like log to console:
         console.log rslts.content
      )
   )
) 
```

如果脚本语法错误，请提前道歉。正如我所说，我不会说咖啡脚本（还）。

但你明白了要点。我从一个[node.js 问题](https://stackoverflow.com/questions/8893167/node-js-http-get-function-is-not-responding)中蚕食了这个。让我知道它是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T16:53:06.390

我将怀疑您的代码有问题，我看不到，或者您的 URL 格式错误。您可以尝试像这样测试它：

```
Things.find().forEach(function(thing){
  var url = thing.url;
  console.log("geting " + url);
  (function (_url){
    try{
      Meteor.http.get(_url, function(error, results){
        if(results.statusCode === 200){
          console.log("request success: " + _url);
        } else {
          console.log("request error: " + _url);
        }
      });
    } catch (e) {
      // if it gets here you probly have a malformed url
      console.log("meteor error!: "+_url);
    }
  })(url);
}); 
```

这是我将其转换为咖啡条的*未经测试*的尝试：

```
Things.find().forEach (thing) ->
  url = thing.url
  console.log "geting: " + url
  go = (_url) ->
    try
      Meteor.http.get _url, (error, results) ->
        if results.statusCode is 200
          console.log "request success: " + _url
        else 
          console.log "request error: " + _url

    catch e
      # if it gets here you probly have a malformed url
      console.log "meteor error!: "+ _url

  go url 
```

# ruby-on-rails-3 - 检查一个值是否在 Rails 3 的范围内？

> ID：10330551
> 
> 赞同：0
> 
> 时间：2012-04-26T09:20:09.610
> 
> 标签：ruby-on-rails-3, if-statement, range

我正在开发 Rails 3 应用程序，需要以下列格式显示一些测试结果：

```
TestLower     TestResult    TestUpper
1.1           1.5           2.0 
```

我想做的是，如果值在下限和上限范围内，则给结果一个 css 类，如果值超出范围，则给它一个不同的 css 类。

我之前使用过 if 和 unless 语句，但这有点复杂，因为我需要将一个值与其他两个值进行比较，而不是一个值与另一个值进行比较。

我能想到的唯一方法将涉及相当多的 if 语句和后备。例如'if @lab.TestResult > @lab.TestLower' 然后有另一个相同的检查它低于TestUpper。

有没有一种简单的方法可以做到这一点？也许某种形式的rails number helper？

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T09:37:36.650

红宝石还有[`between?`](http://www.ruby-doc.org/core-1.9.3/Comparable.html#method-i-between-3F)：

```
if (value.between?(lower, higher)) 
   ... 
```

[`content_tag`](http://api.rubyonrails.org/classes/ActionView/Helpers/TagHelper.html#method-i-content_tag)您可以将它与rails中的助手结合使用：

```
content_tag(:span, value, :class => value.between?(lower, higher) ? "between" : "not-between") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T09:27:43.163

您可以在相同的 if 条件下进行这两项检查：

```
lower, upper, value = ...
if value > lower and value < upper
  puts "In range"
else
  puts "Out of range"
end 
```

# java - Return a string and integer using one method

> ID：10330557
> 
> 赞同：2
> 
> 时间：2012-04-26T09:20:24.227
> 
> 标签：java

Im trying to write a program which has a method Exam mark This contains objects of pupil class and a string that gives the pupils name. The method should return the pupils exam mark and their name. if there is a pupil called joe and their exam score is 32 then when joe is passes 32 should be printed.

In the student class i have getters, for getexamscore and in a subclass i have the getter getpupilname. the vector elements should be in the pupil class.

If the pupil is not in the class -1 should be returned.

Here is my method and everything must be in only this method:

```
import java.util.*;
public class vectors
{
   public int lookforMark(Vector <pupil> v, String name)
   {
       int examscoremark=0;
       name="";
       try{

           for(int i=0; i<=v.size(); i++){
               try
               {
                  int element= v.elementAt(i).getexamscore();
                  String element2= v.elementAt(i).getpupilname();

               }
               catch(Exception e)
               {
                   System.out.println("there is an error");
                   return -1;
               }  
            }
        } 
```

Can someone help me on returning the exammark with the pupil name?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:23:46.010

`setMark`您可以在瞳孔上创建一个方法。

或者，创建一个对象来保存名称并标记并返回它。

```
public class ExamMark {
    private final String name;
    private final int mark;

    public ExamMark(String name, int mark){
        this.name = name;
        this.mark = mark;
    }

    public String getName(){
        return name;
    }

    public int getMark(){
        return mark;
    }
} 
```

像这样使用它：

```
return new ExamMark(v.elementAt(i).getpupilname(), v.elementAt(i).getexamscore()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:24:38.583

这个问题有两个答案：

1.  使用一个`Pair<E,K>`类。有几个可通过 Google 获得。这是捷径。
2.  创建一个特定于您要返回的信息的持有对象。这是更清洁的方式，通常应该是首选。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T09:48:09.277

你特意说了

> 在学生类中，我有 getter，对于 getexamscore，在子类中我有 getter getpupilname。向量元素应该在瞳孔类中。

因此，您不需要任何额外的包装类。而不是返回一个 int，而是像这样返回一个瞳孔对象

```
public pupil lookforMark(Vector <pupil> v, String name) {
      for(int i = 0; i < v.size(); i++)
         if(v.elementAt(i).getpupilname().equals(name))
            return v.elementAt(i);
      return null;
} 
```

就这么简单。现在学生拥有姓名和年级。

稍后编辑：更正了 for 循环中的错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T09:40:28.697

最好使用List或Map，vector会降低性能吗？

创建将具有用户和学生对象的类结果，并使用键作为用户初始化哈希图，值将是结果对象。

映射 userMap = new HashMap();

```
public Result getUserMarks(String user){

Result result = userMap.get(user);  

    return result;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-13T10:04:29.267

一次返回两个对象的最佳方法是将这两个对象包装在可以包含两个值的标准 java 对象中。这将是一个类型的对象`Map.Entry<T1, T2>`。要创建这样的对象，您将使用：

`new AbstractMap.SimpleEntry<T1, T2>(value1, value2);`

所以在你的情况下`new AbstractMap.SimpleEntry<Integer, String>(mark, name);`

# javascript - 在加载 dom 之前执行 javascript

> ID：10330560
> 
> 赞同：9
> 
> 时间：2012-04-26T09:20:31.697
> 
> 标签：javascript, jquery

我想开发一个处理使用过的框架的句柄 javascript 类，等等。

例如：

```
myClass.addFramework('jQuery'); // just an example 
```

它工作正常，我的类添加了框架 - 但如果其中有任何 jQuery 代码，它就不会工作，因为框架是在 dom 准备好后加载的，所以默认的 jQuery 代码片段`jQuery(document).ready(function(){});`不能工作，因为 'jQuery ' 尚未定义。

有什么解决方案可以让我编写一个“修复”脚本，在 dom 的其余部分开始加载之前`addFramework`必须执行我的所有方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-04T11:50:16.933

`script`您应该在创建标签时使用 onload 事件。你可以这样使用：

```
myClass.addFramework('jQuery', function () {
    // do stuff after jquery loaded.
}); 
```

你可以这样实现它：

```
myClass.addFramework = function (name, onload) {
    var _script = document.createElement('script');
    _script.onload = function () {
        onload();
    }
    _script.onreadystatechange = function () {
        if (this.readyState == 'complete') onload();
    }
    _script.src = myClass.FRAMEWORK_BASE + '/' + name + '.js';
    document.getElementsByTagName('head')[0].appendChild(_script);
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T09:49:08.113

使用自定义事件怎么样？像这样的东西：

```
var CustomEvent = function() {
    this.eventName = arguments[0];
    var eventAction = null;
    this.subscribe = function(fn) {
        eventAction = fn; // you can customize this to hold array of handlers
    }; 
    this.fire = function(sender, eventArgs) {
        if (eventAction != null) {
            eventAction(sender, eventArgs);
        } else {
            alert('No ' + mEventName + ' handler!');
        }
    };
}; 
```

现在您可以定义如下内容：

```
var myEvent = new CustomEvent("Framework Loaded");
myEvent.subscribe(function(sender, eventArgs) {
    alert('Framework loaded! Hurray!');
    // jQuery goes here
}); 
```

并且在加载例如 jQuery 的框架后，您只需执行以下操作：

```
myEvent.fire(null, { framework: 'jQuery' }); 
```

（您应该将代码放在 XHR 处理程序中的某个位置）。

此外，如果您在 DOM 加载后触发它，那么您可以忘记 jQuery 的`$(document).ready(...)`包装器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-28T23:28:46.837

看起来你的类有一个 jQuery 依赖，理想情况下你不应该有那个依赖。

尽管如此，如果您正在寻找一种简单的方法来动态加载 jQuery，也许这会有所帮助：

```
function onReady(){
    // My Custom Ready state. lets go wild here.
}

if (typeof jQuery === undefined || jQuery.fn.jquery !== '1.7.2') {

    var jScript = document.createElement('script');
    jScript.setAttribute("type", "text/javascript");
    jScript.setAttribute("src", "http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js")

    //Run onReady() once jQuery and document have loaded
    jScript.onload = function () { //Add on load Event delegate
        //JQuery is Loaded!! so you can do whatever you want with it to deligate.
        $(document).ready(onReady)
    }; 
    jScript.onreadystatechange = function () { //Same thing but for IE
        if (this.readyState == 'complete' || this.readyState == 'loaded')(function () {
            //JQuery is Loaded!! so you can do whatever you want with it to deligate.
            $(document).ready(onReady)
        });
    } 

    // Append Script to the Head
    document.getElementsByTagName("head")[0].appendChild(script_tag);

} else {
    // JQuery Exists so lets just use it
    $(document).ready(onReady);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T09:23:17.057

JQuery document.ready 函数基本上是这样做的：

```
window.onload = function ()
{
Javascript code goes here
} 
```

它不依赖于外部库，并且会在文档加载后运行您的 Javascript。

您可能还想查看[require.js](http://requirejs.org/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T09:24:57.610

您可以使用这个小库在加载后执行脚本： [Yepnope javascript loader](http://yepnopejs.com/)

您也可以通过 ajax 调用下载脚本。并在成功回调中将其附加到文档并执行脚本的代码。但是这种方法已经在 Yepnope 库中使用。

# cuda - CUDA核函数

> ID：10330572
> 
> 赞同：2
> 
> 时间：2012-04-26T09:21:06.163
> 
> 标签：cuda

我只是想知道调用 CUDA 内核函数与

```
<<<BLOCK_NUM, THREAD_NUM>>> 
```

和

```
<<<BLOCK_NUM, THREAD_NUM, THREAD_NUM * sizeof(float)>>> ? 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-04-26T09:26:29.310

第二种情况下的附加参数指定要分配给内核中每个块的动态共享内存量。

例如，如果您有这样定义的内核：

```
__global__ void kernel(...)
{

    extern __shared__ float buffer[];

} 
```

第二次内核启动将尝试为内核的每个块分配`THREAD_NUM`共享内存数组的字。`buffer`有关详细信息，请参阅 CUDA 4.1 编程指南的附录 B.17。

# jsf-2 - Primefaces , jquery 问题包括页面与 ui:include 在 p:tabview

> ID：10330580
> 
> 赞同：1
> 
> 时间：2012-04-26T09:21:43.963
> 
> 标签：jsf-2, primefaces

我已经构建了一个 JSF 2.1.2 页面，其中包含各种 primefaces 组件，例如 p: calendar、p: selectOneMenu ...这个页面运行良好。但是：我需要将第一页集成到 ap:tab 元素中的另一个页面中，并使用 p: TabView parent ：像这样：

```
<p:tabView id="tabview">
 <p:tab title="User admin">
  <ui:include src="firstPage.xhtml" />
 </p:tab>
</p:TabView> 
```

问题：primefaces 组件不再工作（例如，没有显示 p:calendar），我遇到了很多错误，比如 jQuery 不存在：

```
$(this.jqId + " ul").sortable is not a function
[Stopper sur une erreur]    

...d+" .ui-picklist-target-controls .ui-picklist-button-move-up").click(function(){...

primef...mefaces (ligne 27)
$(this.jqId + " ul").sortable is not a function
[Stopper sur une erreur]    

...d+" .ui-picklist-target-controls .ui-picklist-button-move-up").click(function(){...

..... 
```

谢谢你的帮助。克里斯托夫。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T12:33:41.417

确保您的 HTML 输出在语法上是有效的。如果`firstPage.xhtml`代表一个完整的`<html>`页面，那么当您将其用作另一个`<html>`页面中的包含文件时，这将失败，因为嵌套`<html><head><body>`标签是非法的。

您需要以这种方式删除所有`<html><head><body>`标签`firstPage.xhtml`，以便它真正代表唯一的选项卡内容。例如

```
<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
>
    <p>This is the tab content.</p>
</ui:composition> 
```

# javascript - 在 javascript 或 jquery 中解析 Json

> ID：10330581
> 
> 赞同：4
> 
> 时间：2012-04-26T09:21:45.677
> 
> 标签：javascript, jquery, json

> **可能重复：**
> [如何在 javascript 中解析 json](https://stackoverflow.com/questions/4935632/how-to-parse-json-in-javascript)

我需要用 JavaScript 或 jQuery 解析这个 JSON。请帮助我获取以下 JSON 中的产品列表。

获取产品列表

```
{
    "main": {
        "ProductsData": {
            "Product": {
                "AdjustmentTypeID": "0",
                "BrandID": "4",
                "BrandName": "Joseph Joseph",
                "ChildrenGenerated": "False",
                "Cost": "8.50",
                "Description": "<span style=\"line-height: 120%; \">The ingenious dual-chamber design of this measuring jug eliminates the need for separate measuring spoons, cups and jugs. Use the small chamber to accurately measure liquids from as little as a single teaspoon (5ml), and then for greater volumes (up to 550ml) simply turn the jug 180&ordm; and use the larger chamber. Made from SAN material. Heat resistant to 90&deg;C \\/ 190&deg;F.<\\/span>\\u000d\\u000a<p class=\"MsoNormal\" style=\"margin-bottom:0cm;margin-bottom:.0001pt;line-height:\\u000d\\u000a120%;mso-layout-grid-align:none;text-autospace:none;vertical-align:middle\"><br \\/>\\u000d\\u000aDesign registered<span lang=\"EN-US\"><o:p><\\/o:p><\\/span><\\/p>\\u000d\\u000a<p class=\"BasicParagraph\"><span style=\"font-size:11.0pt;line-height:120%;\\u000d\\u000afont-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:windowtext\"><br \\/>\\u000d\\u000aDimensions&nbsp;&nbsp; 7x 7 x 15cm<o:p><\\/o:p><\\/span><\\/p>",
                "DownloadFile": "",
                "InternalCode": "502842009381 0",
                "IsProductActive": "False",
                "ManufacturerID": "11",
                "ManufacturerName": "Joseph Joseph",
                "OptionMatchGroupID": "",
                "ParentProduct": "",
                "ProductID": "80",
                "ProductName": "2-in-1 Measuring Jug",
                "ProductTypeDescription": "Compound Product",
                "ProductTypeID": "8",
                "SiteID": "57",
                "StockLevel": "",
                "SupplierID": "3",
                "SupplierName": "Joseph Joseph",
                "UseStockControl": "False",
                "VatRate": "20"
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:23:37.603

使用 jQuery 中的[`parseJSON`方法](http://api.jquery.com/jQuery.parseJSON/)。

例子：

```
var obj = $.parseJSON(yourJsonString);
alert(obj.main.ProductsData.Product.Cost); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T09:30:51.023

从文件中读取 JSON：

```
myobject = $.parseJSON("myfile.json") 
```

或者从字符串中读取 JSON：

```
myobject = $.parseJSON(jsonString) 
```

现在获取您想要的数据：

```
//Loops  into every Product in ProductsData:
$(myobject.main.ProductsData.Product).each(function(index, element){
    //Do something with Product variable such as below
    alert(element.BrandName + ' ' + element.SupplierName);
} 
```

请务必使用[http://jsonlint.com/检查您的 JSON 数据](http://jsonlint.com/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T09:23:27.343

只需使用`JSON.parse`函数（[MDN 文档链接](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/JSON/parse)）

```
yourObj = JSON.parse( jsonstring ); 
```

之后，您可以通过您的对象访问 JSON 字符串的任何属性，例如，

```
yourObj['main']['ProductsData']['ProductName'] 
```

将返回

```
"2-in-1 Measuring Jug" 
```

在你给定的例子中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T09:23:18.843

您可以使用 jquery 函数`$.parseJSON(jsonString)`来获取 json 对象

如果 jsonString 存储您给定的字符串，

```
jsonObj = $.parseJSON(jsonString); 
```

> jsonObj.main.ProductsData.Product

将是一系列产品

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T09:24:55.847

使用 JavaScript：`JSON.parse(yourjavascriptobjecttoparse);`

然后`var productx = yourjavascriptobjecttoparse['main']['ProductsData']['Product']`参考产品。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-26T09:26:11.150

您可以使用

```
var object = $.parseJSON(jsonString); 
```

现在您可以像访问本机 JavaScript 对象一样访问此对象：

```
object.main.ProductsData.Product.BrandName     // Joseph Joseph 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-04-26T09:37:39.147

jQuery 有一个有趣的 JSON 插件，叫做[jquery-json](http://code.google.com/p/jquery-json/)。

它允许您序列化和反序列化 JSON。它是这样工作的：

```
var myObject = { property1: "value1", property2: "value2" };

// Converts myObject to JSON
var serialized = $.toJSON(myObject);

// Parses generated JSON into a new object
var deserialized = $.evalJSON(serialized); 
```

# c - Using valgrind to find out how an object is still reachable

> ID：10330583
> 
> 赞同：0
> 
> 时间：2012-04-26T09:21:50.933
> 
> 标签：c, memory-leaks, valgrind

I use valgrind for memory leak detection. There was some code I was expecting to produce a memory leak, but valgrind did not detect it. Now I would like to find out in what way this object might still be reachable (this would be a problem in this case). Can valgrind output those references?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-22T21:38:00.687

升级到（尚未发布）3.8.0 SVN 版本的 Valgrind。然后，您将拥有以下 gdbserver 监控命令：

> ```
>  block_list <loss_record_nr>
>         after a leak search, shows the list of blocks of <loss_record_nr>
>   who_points_at <addr> [<len>]
>         shows places pointing inside <len> (default 1) bytes at <addr>
>         (with len 1, only shows "start pointers" pointing exactly to <addr>,
>          with len > 1, will also show "interior pointers") 
> ```

# python - Import Python class from module but not dependencies

> ID：10330588
> 
> 赞同：2
> 
> 时间：2012-04-26T09:22:19.827
> 
> 标签：python, python-module

How can I import a python class but avoid running the import statement in that module?

```
Module foo
    from bar import A

Module bar
    import alpha

    class A(object):
        ...

    class B(objects):
        ... 
```

I want to import class A but don't need class B. The import statement in the module bar is required for class B but I'd like to avoid needing to install that dependency if possible, as (I assume) it will be loaded into memory but not used.

Any help would be appreciated.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:33:27.333

你不能停止`bar`导入`alpha`而不破解它的源代码。`alpha`但是您可以通过将其写入以下内容来“伪造” `sys.modules`：

```
>>> import alpha
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named alpha
>>> import sys; sys.modules['alpha'] = object()
>>> import alpha
>>> 
```

这是因为 Python 将导入的模块缓存在`sys.modules`. 添加`alpha`它意味着 Python 认为您已经导入了`alpha`，因此当`bar`尝试这样做时，它只会取回缓存的副本。

显然，您应该仔细考虑您是否愿意这样做——`bar`如果它实际上在任何地方使用，将会以意想不到的方式崩溃`alpha`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:35:14.180

将导入放在 B 类初始化中

```
class B:
    def __init__:
        import alpha 
```

如果我没记错的话，这可能会奏效

# java - 从后台进程控制全局推送屏幕

> ID：10330591
> 
> 赞同：1
> 
> 时间：2012-04-26T09:22:29.623
> 
> 标签：java, blackberry

大家好，我想控制从后台应用程序全局推送屏幕。目前我制作了一个**扩展 MainScreen 的屏幕。**我想在全球范围内显示这个屏幕。如果有两个屏幕一个接一个地显示，我正在使用 `pushGlobalScreen(Screen to push, int priority, flag);`它。但实际上我想做的是。我想关闭第一个屏幕然后我想显示下一个屏幕等等。那么如何实现这一点。

这里我解释得更清楚

我正在解释我在数据库中检查时间的整个场景，如果当前时间与警报时间匹配，那么它会推动屏幕，假设同时保存了多个警报。

```
while (Checking into database for time){
if (databasetime == current time ) {// let suppose there is more than 
                                    //one alarm save for the same time
    synchronized (getEventLock()) {// This will call one after other but i want to first

        UiEngine ui = Ui.getUiEngine();

        ui.pushGlobalScreen(new AlarmScreen() , 1, UiEngine.GLOBAL_QUEUE);//  
                      //Here i want to stop. I want user to close the screen then
                      // i want to push again the screen. As we do in
                      // PushModalScreen(Screen) How can i block 
                     //pushGlobalScreen(new AlarmScreen() , 1, UiEngine.GLOBAL_QUEUE);
         }

   }

} 
```

我想我的要求现在很清楚了。是吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T11:18:08.503

`AlarmScreen`在推送新实例之前，请检查以下代码片段以从显示堆栈中删除`AlarmScreen`实例。

```
net.rim.device.api.ui.Screen currentScreen = Ui.getUiEngine().getActiveScreen();

// pop previously pushed AlarmScreen
if (currentScreen instanceof AlarmScreen) {
    try {
        Ui.getUiEngine().popScreen(currentScreen);
    } catch (IllegalArgumentException iaexc) {
        // If your screen is not on the stack.
    } catch (Exception exc) {           
    }
}

// push new AlarmScreen
synchronized (Application.getEventLock()) {
    Ui.getUiEngine().pushGlobalScreen(new AlarmScreen() , 1, UiEngine.GLOBAL_QUEUE);
} 
```

* * *

以下应用程序（`UiApplication`）使用队列`AlarmScreen`。在从显示堆栈中主动`AlarmScreen`移除时，它将另一个`AlarmScreen`从等待队列推入显示堆栈。

```
package mypackage;

import net.rim.device.api.ui.UiApplication;
import net.rim.device.api.ui.container.MainScreen;

public class MyApp extends UiApplication implements CloseEventListener {
    public static void main(String[] args) {
        (new MyApp()).enterEventDispatcher();
    }

    private AlarmScreen []queue;
    private int MAX = 10;
    private int head = 0;

    public MyApp() {
        // initialize queue 
        queue = new AlarmScreen[MAX];
        head = 0;
        for (int i=0;i<MAX;i++) {
            queue[i] = new AlarmScreen(this, "Screen no. " + i);
        }

        // push first screen on display
        UiApplication.getUiApplication().pushScreen(queue[head ++]);
    }

    public void screenClosed() {
        if (head < MAX) {
            UiApplication.getUiApplication().pushScreen(queue[head ++]);
        }
    }
}

interface CloseEventListener {
    public void screenClosed();
}

class AlarmScreen extends MainScreen {
    private CloseEventListener listener;

    public AlarmScreen(CloseEventListener listener, String title) {
        setTitle(title);
        this.listener = listener;
    }

    public boolean onClose() {
        try {
            UiApplication.getUiApplication().invokeLater(new Runnable() {
                public void run() {
                    close();
                }
            });
        } catch (Exception exc) {
            System.out.println(exc.getMessage());
        }
        // push a new screen from waiting queue
        if (listener != null) {
            listener.screenClosed();
        }
        return true;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-19T09:14:15.653

我已经解决了这个问题，但方式不同。我选择的方式是，我将所有 id 存储在表中并检查表中是否有任何 id 我只推送一个屏幕。在关闭它之前，我正在检查表中是否有更多的 id `updating the Contents of the Screen`。现在它按我想要的方式工作，如果没有更多数据，我只是关闭屏幕。

# java - 读取 xlsx 文件时出现 apache POI 异常

> ID：10330593
> 
> 赞同：10
> 
> 时间：2012-04-26T09:22:32.353
> 
> 标签：java, exception, apache-poi

我正在使用 apache POI通过添加以下依赖项来读取**xlsx文件**

```
<dependency>
            <groupId>org.apache.poi</groupId>
            <artifactId>poi-ooxml</artifactId>
            <version>3.8</version>
        </dependency>

<dependency>
            <groupId>org.apache.xmlbeans</groupId>
            <artifactId>xmlbeans</artifactId>
            <version>2.5.0</version>
        </dependency> 
```

即使部署在tomcat中，我在使用jetty插件运行时也会出现以下异常。

```
org.apache.poi.POIXMLException: java.lang.reflect.InvocationTargetException
    at org.apache.poi.xssf.usermodel.XSSFFactory.createDocumentPart(XSSFFactory.java:62)
    at org.apache.poi.POIXMLDocumentPart.read(POIXMLDocumentPart.java:403)
    at org.apache.poi.POIXMLDocument.load(POIXMLDocument.java:155)
......

Caused by: java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
...........
Caused by: java.lang.NoClassDefFoundError: Could not initialize class org.openxmlformats.schemas.spreadsheetml.x2006.main.StyleSheetDocument
    at org.openxmlformats.schemas.spreadsheetml.x2006.main.StyleSheetDocument$Factory.parse(Unknown Source)
    at org.apache.poi.xssf.model.StylesTable.readFrom(StylesTable.java:121)
    at org.apache.poi.xssf.model.StylesTable.<init>(StylesTable.java:92)
    ... 186 more 
```

我删除了 xmlbeans 依赖项，因为 maven 会自动下载 poi 依赖项，仍然是相同的异常。有帮助吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2015-09-26T21:16:02.563

我在 3.12 版本中使用了 poi。还需要以下依赖项：

`compile 'org.apache.poi:ooxml-schemas:1.1'`

另见[http://poi.apache.org/faq.html#faq-N10025](http://poi.apache.org/faq.html#faq-N10025)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-02-27T15:38:41.840

我已经为这些依赖项运行了它：

```
     def poiVersion='3.9'
     编译'org.apache.poi:poi:'+poiVersion
     编译'org.apache.poi:poi-ooxml:'+poiVersion
     编译'org.apache.poi:poi-ooxml-schemas:'+poiVersion

```

当我为其他人尝试时，它不起作用：

3.10：maven central 不知道

3.11 : 失败，在这种情况下有确切的错误！！！

结论 POI 3.9 有效！！！！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-07T11:58:20.207

我尝试使用`poi 3.10`,`3.11`和`3.12 beta`Grails 并得到这个错误。

下载并包含[http://mirrors.ibiblio.org/pub/mirrors/maven2/org/apache/poi/ooxml-schemas/1.0/oox​​ml-schemas-1.0.jar](http://mirrors.ibiblio.org/pub/mirrors/maven2/org/apache/poi/ooxml-schemas/1.0/ooxml-schemas-1.0.jar)后，错误消失了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T10:22:34.333

我使用 3.7 但你有没有尝试添加

```
 <dependency>
        <groupId>org.apache.poi</groupId>
        <artifactId>poi-ooxml-schemas</artifactId>
        <version>3.8</version>
    </dependency> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-20T12:07:54.907

这是由于 poi jar 不一致而发生的。您可以下载最新的 jars，它将开始工作。

您可以为以下所有内容添加最新的 jar 文件：

Commons-compress , ooxml-schemas , poi-scratchpad , poi-ooxml , poi , poi-ooxml-schemas , dom4j , poi-excelant

# javascript - jquery比较href + url和'contains'问题

> ID：10330596
> 
> 赞同：1
> 
> 时间：2012-04-26T09:22:49.843
> 
> 标签：javascript, jquery

我在这里有一些jquery：

```
 $(document).ready(function () {
        $('a[href*="' + window.location.href + '"]').css('font-weight', 'bold');

        //check that the text exists in the div and make top menu item bold
        $("ul#menu2 div:contains('About Us')");
        {
            $("ul.sf-menu li a:contains('About Us')").css('font-weight', 'bold');
        }
   }); 
```

问题是页面加载 URL 除了 www.website.co.uk 之外什么都没有。代码将 url 与菜单中的 href 匹配，然后使其变为粗体。

当您单击菜单项时，它会很好，因为 URL 显示 www.website.co.uk/aboutus/abgroup.apx

jquery 的第二部分在其中一个页面的左侧菜单中检查一个单词，然后将样式添加到也匹配该字符串的顶部菜单中。但它似乎使所有顶部菜单项都变粗了。

有任何想法吗。

我需要类似的东西，如果 URL 最后包含 .co.uk 则在页面加载时将主页设为`li a`粗体。

**菜单标记：**

```
<ul class="sf-menu">
    <li class="first"><a href="http://www.site.co.uk/en-us/home.aspx">Home</a></li>
    <li class=""><a href="http://www.site.co.uk/en-us/aboutus/abgroup.aspx">About Us</a></li>
    <li class=""><a href="http://www.site.co.uk/en-us/casestudies.aspx">Case Studies</a></li>
</ul> 
```

这是一个两部分的问题，

**1）**当url只是www.website.co.uk时，我需要停止jquery，因为它在与href和url进行比较时失败了。

**2）**需要知道为什么在某些页面上包含一直突出显示（这可能是因为我不够具体，我使用ID来检查但顶部菜单不是。）

**这是我的“关于我们”菜单：（** 我也有服务和部门，同样的原则适用 - 我想从菜单中搜索 div 并使顶部相应的菜单项加粗。

```
<ul id="menu2">
    <div>About Us<br>
    </div>
    <li><a href="/en-us/aboutus/ABgroup.aspx" class="current">A&amp;B Group</a></li>
    <li style="padding-left: 10px;"><a href="/en-us/aboutus/csr.aspx">CSR</a></li>
    <li style="padding-left: 10px;"><a href="/en-us/aboutus/csr/sustainability.aspx">Sustainability</a></li>
    <li style="padding-left: 10px;"><a href="/en-us/aboutus/csr/healthsafety.aspx">Health &amp; Safety</a></li>
    <li><a href="/aboutus/ab/aluminiumsheets.aspx">Aluminium Sheets</a></li>
    <li><a href="/aboutus/ab/test.aspx">Test</a></li>
    <li><a href="/aboutus/ab/cars.aspx">Cars</a></li>
    <li><a href="/aboutus/ab/houseinteriors.aspx">House Interiors </a></li>
    <li><a href="/aboutus/ab/abreports.aspx">A&amp;B reports</a></li>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:42:33.700

为 JQuery使用这个插件[JAMES PADOLSEY 正则表达式选择器](http://james.padolsey.com/javascript/regex-selector-for-jquery/)

并像这样使用：

```
var regexp_part = /\w+\.aspx$/.exec(window.location.href)[0];
if (regexp_part != null) {
    $('a:regex(href, ' + regexp_part[0] +'$)').css('font-weight', 'bold');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:58:16.830

解决第一部分很简单

```
var pattern = new RegExp('http(s?):\/\/(?:[\w-]+\.)?testsite\.co\.uk(/?)$');
if(pattern.test(window.location.href)) {
    $('.first').css('font-weight', 'bold');
} else {
    $('a[href*="' + window.location.href + '"]').css('font-weight', 'bold');
} 
```

在 a中以 a`<div>`作为根元素`<ul>`是无效的。如果这是一个标题，我会建议使用标题标签并将其放在`<ul>`. 像这样的东西：

```
<h2>About Us</h2>
<ul> .... </ul> 
```

然后你可以为javascript做一些简单的事情：

```
var title = $('h2').text();
if(title !== '') $("ul.sf-menu li a:contains('" + title + "')").css('font-weight', 'bold'); 
```

# java - Java 从 DB Netbeans 获取数据后更改表头

> ID：10330598
> 
> 赞同：0
> 
> 时间：2012-04-26T09:22:50.543
> 
> 标签：java, swing, jtable

我正在使用 Netbeans、SWING 将数据从 mysql 表获取到 jTable。我做到了，但是表格的标题。标题与 mysql 表中的相同。从数据库获取数据后如何更改jTable的标题？

附言

默认标题在此问题中不起作用。

这是自动生成的代码：

@SuppressWarnings("unchecked") // private void initComponents() { bindingGroup = new org.jdesktop.beansbinding.BindingGroup();

```
progressjournalPUEntityManager = java.beans.Beans.isDesignTime() ? null : javax.persistence.Persistence.createEntityManagerFactory("progressjournalPU").createEntityManager();
pupilsQuery = java.beans.Beans.isDesignTime() ? null : progressjournalPUEntityManager.createQuery("SELECT p FROM Pupils p");
pupilsList = java.beans.Beans.isDesignTime() ? java.util.Collections.emptyList() : pupilsQuery.getResultList();
jScrollPane1 = new javax.swing.JScrollPane();
jTable1 = new javax.swing.JTable();

setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
setTitle("Журнал успеваемости");
setResizable(false);

jTable1.setModel(new javax.swing.table.DefaultTableModel(
    new Object [][] {

    },
    new String [] {
        "#", "ФИО", "Курс", "Предмет", "Оценка"
    }
) {
    Class[] types = new Class [] {
        java.lang.Integer.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class
    };

    public Class getColumnClass(int columnIndex) {
        return types [columnIndex];
    }
});

org.jdesktop.swingbinding.JTableBinding jTableBinding = org.jdesktop.swingbinding.SwingBindings.createJTableBinding(org.jdesktop.beansbinding.AutoBinding.UpdateStrategy.READ_WRITE, pupilsList, jTable1);
org.jdesktop.swingbinding.JTableBinding.ColumnBinding columnBinding = jTableBinding.addColumnBinding(org.jdesktop.beansbinding.ELProperty.create("${pupilMark}"));
columnBinding.setColumnName("Pupil Mark");
columnBinding.setColumnClass(String.class);
columnBinding = jTableBinding.addColumnBinding(org.jdesktop.beansbinding.ELProperty.create("${pupilSubject}"));
columnBinding.setColumnName("Pupil Subject");
columnBinding.setColumnClass(String.class);
columnBinding = jTableBinding.addColumnBinding(org.jdesktop.beansbinding.ELProperty.create("${pupilCourse}"));
columnBinding.setColumnName("Pupil Course");
columnBinding.setColumnClass(String.class);
columnBinding = jTableBinding.addColumnBinding(org.jdesktop.beansbinding.ELProperty.create("${pupilName}"));
columnBinding.setColumnName("Pupil Name");
columnBinding.setColumnClass(String.class);
columnBinding = jTableBinding.addColumnBinding(org.jdesktop.beansbinding.ELProperty.create("${pupilId}"));
columnBinding.setColumnName("Pupil Id");
columnBinding.setColumnClass(Integer.class);
bindingGroup.addBinding(jTableBinding);
jTableBinding.bind();
jScrollPane1.setViewportView(jTable1);

javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
getContentPane().setLayout(layout);
layout.setHorizontalGroup(
    layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
    .addGroup(layout.createSequentialGroup()
        .addGap(15, 15, 15)
        .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 616, Short.MAX_VALUE)
        .addContainerGap())
);
layout.setVerticalGroup(
    layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
    .addGroup(layout.createSequentialGroup()
        .addContainerGap()
        .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 275, javax.swing.GroupLayout.PREFERRED_SIZE)
        .addContainerGap(14, Short.MAX_VALUE))
);

bindingGroup.bind();

pack(); 
```

}//

并且此代码已锁定以进行编辑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:33:45.453

调用`getMetaData()`你的 sql `ResultSet`。[`ResultSetMetaData`](http://docs.oracle.com/javase/6/docs/api/java/sql/ResultSetMetaData.html)包含列名。列标题名称（如行数据）从`TableModel`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:34:39.803

表的标题由 确定[`TableModel#getColumnName`](http://docs.oracle.com/javase/7/docs/api/javax/swing/table/TableModel.html#getColumnName%28int%29)，正如该方法的 javadoc 中明确说明的那样：

> 返回 columnIndex 处的列名。这用于初始化表的列标题名称

# c++ - 将 ptime 提升为 unix 时间戳转换错误

> ID：10330606
> 
> 赞同：2
> 
> 时间：2012-04-26T09:23:23.710
> 
> 标签：c++, datetime, boost

我正在使用提升日期时间来计算特定日期的 unix 时间。在大多数情况下，返回值是正确的，但有时计算的秒数不正确。

这是一个例子：

```
boost::posix_time::ptime t(boost::gregorian::date(1900, 1, 1));

boost::posix_time::ptime epoch(boost::gregorian::date(1970, 1, 1));
boost::posix_time::time_duration dur;

dur = t - epoch; 

int tstamp = dur.total_seconds();

if (t < epoch) tstamp = -tstamp ; 
```

预期值为-2208902400，但我得到-2085978496。您有解决此问题的方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T09:44:50.393

For some reason boost has the [year 2038 bug](https://svn.boost.org/trac/boost/ticket/3109).

The work around is to avoid dates from before your grandparents were born :)

update: the boost bug tracker has [a bug](https://svn.boost.org/trac/boost/ticket/3109) for this. It's 3 years old.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T10:15:25.243

如果您的系统已`time_t`定义为`int`32 位`int`，则其中可表示的最早日期为 1901-12-13T20:45:52。正如迈克尔斯莱德在另一个答案中所说，显然 boost 在内部某处使用 32 位，即使`time_t`更大，所以 date 1900-01-01 不适用于`boost::posix_time::ptime`.

# asp.net-mvc - json 没有通过 mvc 3 控制器上的 id

> ID：10330613
> 
> 赞同：1
> 
> 时间：2012-04-26T09:23:50.373
> 
> 标签：asp.net-mvc, json, extjs4.1

我有以下控制器

```
[HttpPost]
public JsonResult Update(List<DeliveryNoteDisplay> DeliveryNotes, UserSession userSession)
{
// etc
} 
```

这会正确地传递所有值，唯一的例外是 id 值始终为 null，即使我可以通过 fire bug 看到它。

![在此处输入图像描述](../Images/0ce941e90b2c6ea5e3d9dce006c63903.png)

```
public class DeliveryNoteDisplay
{
    public virtual string Id { get; set; }
    public virtual string ProjectId { get; set; }
    public virtual string DeliveryNoteId { get; set; }
    public virtual string ClientId { get; set; }
    public virtual string VehicleId { get; set; }
    public virtual string CourierId { get; set; }
    public virtual string JobIds { get; set; }
    public virtual string Name { get; set; }
    public virtual string DeliveryTo { get; set; }
    public virtual string DeliveryFrom { get; set; }
    public virtual string Estimated { get; set; }
    public virtual string Actual { get; set; }
    public virtual string BookedDate { get; set; }
    public virtual string CreatedByUserName { get; set; }
    public virtual string Modified { get; set; }
    public virtual string Created { get; set; }
    public virtual bool ShowAddressFooter { get; set; }
    public virtual bool ShowDeliveryFrom { get; set; }
    public virtual bool ShowHeaderLogo { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:26:24.867

在帖子中，json 以带有值的 Id 开头，并再次以 id 结尾......它是空的。

# spree - esale_spree 模块

> ID：10330617
> 
> 赞同：0
> 
> 时间：2012-04-26T09:24:11.660
> 
> 标签：spree

我想使用 esale_spree 模块，它用作电子商务网站和 openERP 的连接器，我从以下链接下载了它：

**http://apps.openerp.com/addon/2431?filter={%22version%22%3A+3%2C+%22order_by%22%3A+%22last_update+desc%2C+click_counter+desc%22%2C+%22author% 22%3A+142}&页=0**

我已经安装了该模块并使用 api 密钥将其与 spree 站点链接。但我无法从 spree 中检索产品、类别、订单、税收等。但是当我在 esale_spree 模块的数据库中插入一些数据时，这些值通过 OpenERP esale_module 是可见的。例如，**esale_spree_product**中的值可以通过 openerp 检索。但这不是连接器应该工作的方式，我猜。

告诉我使用连接器的正确方法。

尝试使用 spree - 1.0.0 rails - 1.9.2、1.9.3 Oerp 版本 - 6.0.3

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T00:04:40.093

该扩展已使用 spree 0.9.99 边缘进行了测试，该边缘已有 2 年多的历史了。很可能 api 在 0.9 和 1.0 之间发生了根本性的变化，并且在 spree 1.0 和 1.1 之间再次发生了变化。

# asp.net - 我应该使用什么控件来显示保存在数据库中并编码为图像的图像

> ID：10330619
> 
> 赞同：1
> 
> 时间：2012-04-26T09:24:15.130
> 
> 标签：asp.net, .net

一切都在问题之中。我有一个图像保存在数据库中的图像列中。我怎么能设法在 aspx 页面中显示它？

问题是我不知道如何在不指定 URL 的情况下显示图像。提前感谢您的帮助祝您有美好的一天

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T09:27:05.117

编写一个基于 URL 参数返回特定图像的处理程序（将图像的字节数组写入响应）并将其设置为 Image 控件的 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:27:11.230

创建一个 HTTP 处理程序并在每个 img scr 中调用该处理程序

```
<img src="ShowImg.ashx?ID=imageid" alt="imgetitle" /> 
```

处理程序将从作为查询字符串传递给它的 imageid 加载图像。在处理程序上，我们将正确的代码从数据库中读取图像并显示在页面上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T09:28:25.587

您可以使用提供图像的 HTTP 处理程序来执行此操作，同时在 html 图像标记中引用该处理程序。

看看[这篇](http://aspalliance.com/1322_Displaying_Images_in_ASPNET_Using_HttpHandlers.1)文章的例子。

# objective-c - 如何将小图像嵌入到我的应用程序中？

> ID：10330621
> 
> 赞同：1
> 
> 时间：2012-04-26T09:24:21.690
> 
> 标签：objective-c, ios, xcode, cocoa, ios5

我有 4 个小的“LED”图标，我在我的应用程序中使用它们来指示 UITableView 和后续详细视图中对象的状态。我真的不想将它们存储在网上 - 有没有办法将它们保存为应用程序的一部分？如果是这样，我该如何引用它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:27:36.413

只需将它们**拖放**到您的 Xcode 项目中即可。

然后，要“引用”它们，您可以使用：

```
[[NSBundle mainBundle] pathForResource:@"yourImage" ofType:@"png"]; 
```

* * *

**要获得实际的`NSImage`**（从您的应用程序包中）：

```
NSString* imagePath = [[NSBundle mainBundle] pathForResource:@"yourImage" ofType:@"png"];
NSImage* image = [[NSImage alloc] initWithContentsOfFile: imagePath]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-08T23:34:27.143

```
UIImage *image = [UIImage imageNamed:@"yourImage"]; 
```

# spring - 使用 proguard 混淆 Spring 应用程序

> ID：10330625
> 
> 赞同：1
> 
> 时间：2012-04-26T09:24:40.187
> 
> 标签：spring, security, jakarta-ee, obfuscation, proguard

我在混淆包括 Struts2、dwr、Spring 和 JPA 在内的 Java EE 应用程序时遇到了麻烦。我只是想从实际上已经成功混淆此类架构的程序员的经验中受益。

由于各种问题，我们最终切换到基于注释的配置。

我知道默默无闻的安全性很糟糕，我意识到这可能不值得付出努力，但这是目前的要求。

# jquery - JQuery 获取 tr 之后的表中的所有 tr

> ID：10330629
> 
> 赞同：1
> 
> 时间：2012-04-26T09:24:53.867
> 
> 标签：jquery, jquery-selectors

我在同一页面中有几个这样的表：

```
<table>
<tr class="head">
    <th>
        Brand
    </th>
</tr>
<tr class="attributeVal">
    <td>
        text
    </td>
</tr>
<tr class="attributeVal">
    <td>
        text
    </td>
</tr>
....
</table> 
```

并且在页面加载中

```
$('.attributeVal').hide(); 
```

这个想法是当“head”鼠标悬停时显示同一个表中的所有“attributeVal”类。我做 $('.attributeVal') 因为它会影响页面上的所有 'attributeVal'。

此外，一旦我离开该表，当前表中的所有“attributeVal”都将隐藏（）。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:27:00.183

此方法在鼠标悬停时显示行，并在悬停时隐藏它们。如果要保持行可见，请替换`.toggle()`为。`.show()`

```
$('table').mouseleave(function() {
    $(this).find('.attributeVal').hide();
});
$('.head').mouseover(function() {
    $(this).nextAll('.attributeVal').show();
}); 
```

使用[`mouseleave`](http://api.jquery.com/mouseleave/)和[`mouseover`](http://api.jquery.com/mouseover/)。
演示： http: [//jsfiddle.net/t7CWp/](http://jsfiddle.net/t7CWp/)（也适用于 jQuery 1.5.1）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:26:59.093

将包含表作为上下文传递给`.attributeVal`选择器，以便您仅从当前表中选择匹配的元素：

```
$(".head").mouseover(function() {
    $(".attributeVal", $(this).closest("table")).show();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T09:28:16.500

您正在寻找 .siblings() 方法。它选择所有兄弟姐妹（匹配可选选择器）。

要仅在离开表格时隐藏元素，请使用表格`mouseleave`上的事件：

```
$('.head').on('mouseover',function() {
    $(this).siblings('.attributeVal').show();
})
$('table').on('mouseleave',function() {
    $(this).find('.attributeVal').hide();
}); 
```

你可以在这里看到它的实际效果：http: [//jsfiddle.net/ATWFH/](http://jsfiddle.net/ATWFH/)

此外`.attributeVal`，您可以给它们一个样式，而不是使用 javascript 隐藏页面加载，因此它们直接被 CSS 隐藏：

```
<style>
    .attributeVal { display: none; }
</style> 
```

# solr - 如何在 solr 中删除重复的令牌

> ID：10330632
> 
> 赞同：1
> 
> 时间：2012-04-26T09:24:57.507
> 
> 标签：solr, duplicates

[为什么 solr RemoveDuplicatesTokenFilterFactory 不起作用](https://stackoverflow.com/questions/10329470/why-solr-removeduplicatestokenfilterfactory-dont-work)的后续问题？

无论单词位置如何，如何让 solr 删除重复的单词？

例如：

```
Field value:                    text word word text word word
Expected tokens after X filter: text word 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T11:48:18.187

编写自己的[TokenFilter](http://lucene.apache.org/core/old_versioned_docs/versions/3_5_0/api/all/org/apache/lucene/analysis/TokenFilter.html)来实现这一点应该很容易。可能不简单的一件事是[位置增量](http://lucene.apache.org/core/old_versioned_docs/versions/3_5_0/api/all/org/apache/lucene/analysis/tokenattributes/PositionIncrementAttribute.html)的处理（如果您有兴趣在此字段上运行短语查询范围）。如果您不知道如何开始，您可以查看[StopFilter implementation](http://grepcode.com/file/repo1.maven.org/maven2/org.apache.lucene/lucene-core/3.5.0/org/apache/lucene/analysis/StopFilter.java#StopFilter)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-10-07T13:44:12.293

我从“FilteringTokenFilter”创建了一个新的过滤器类。任务很简单。我会在添加到列表之前检查。

我创建了一个简单的插件[消除重复的单词](https://github.com/volkan/lucene-solr-filter-eliminateduplicate)

要加载插件，JAR 文件（以及 EliminateDuplicate-*.jar，可以通过执行 mvn package 命令或[https://github.com/volkan/lucene-solr-filter-eliminateduplicate/tree/master/solr/创建lib](https://github.com/volkan/lucene-solr-filter-eliminateduplicate/tree/master/solr/lib) ) 在 Solr 主目录的 lib 目录中。lib 目录的位置在 solr.xml 文件附近。

# php - PHP - Pear Mail：身份验证失败，但 telnet 有效

> ID：10330636
> 
> 赞同：0
> 
> 时间：2012-04-26T09:25:13.587
> 
> 标签：php, email, authentication, pear

我陷入了身份验证问题。我想使用 PHP 通过外部 SMTP 服务器（运行 Microsoft Exchange 2010）发送邮件。当我在 telnet 会话中发送邮件时，它工作正常：

```
telnet mail.myweb.com 25
Trying 100.200.300.400...
Connected to mail.myweb.com.
Escape character is '^]'.
220 mail.myweb.com SMTP Service ready
AUTH LOGIN
334 VXNlcm5hbWU6
bXlzZWNyZXR1c2VybmFtZQ==
334 UGFzc3dvcmQ6
bXlzZWNyZXRwYXNz
235 Authentication successful
MAIL FROM:user1@myweb.com
250 <user1@myweb.com> ... Sender ok
RCPT TO:fakeuser@fakeweb.com
250 Requested mail action okay, completed.
DATA
354 Start mail input; end with <CR><LF>.<CR><LF>
SUBJECT:test email

"test data"
.
250 Requested mail action okay, completed. 
```

但是当我尝试使用 Pear Mail 代码时，我遇到了身份验证失败。这是调试响应：

```
DEBUG: Recv: 220 mail.myweb.com SMTP Service ready 
DEBUG: Send: EHLO localhost 
DEBUG: Recv: 500 Syntax error, command unrecognized 
DEBUG: Send: HELO localhost 
DEBUG: Recv: 250 Requested mail action okay, completed. 
DEBUG: Send: RSET 
DEBUG: Recv: 250 Requested mail action okay, completed.

authentication failure [SMTP: SMTP server does not support authentication (code: 250, response: Requested mail action okay, completed.)]
DEBUG: Send: QUIT 
DEBUG: Recv: 221 mail1.myweb.com closing transmission channel 
```

这是PHP代码：

```
<?php
require_once "Mail.php";

$from = "user1@myweb.com";
$to = "fakeuser@fakeweb.com";
$subject = "Hi!";
$body = "Hi,\n\nHow are you?";

$host = "mail.myweb.com";
$port = "25";
$username = "mysecretusername";
$password = "mysecretpass";

$headers = array ('From' => $from,
     'To' => $to,
     'Subject' => $subject);
$smtp = Mail::factory('smtp',
      array ('host' => $host,
          'port' => $port,
          'debug' => true,
          'auth' => true,
          'username' => $username,
          'password' => $password));

$mail = $smtp->send($to, $headers, $body);

if (PEAR::isError($mail)) {
    echo("<p>" . $mail->getMessage() . "</p>");
 } else {
echo("<p>Message successfully sent!</p>");
 }
?> 
```

PHP 代码适用于其他 SMTP 服务器，因此 Pear Mail 没有问题。用户名/密码没问题。你有什么想法吗？

# android - 当视图不可见时在视图下方放置广告视图

> ID：10330637
> 
> 赞同：0
> 
> 时间：2012-04-26T09:25:19.043
> 
> 标签：android

我有一个布局，它在 imageview 下有一个 adview。在某些情况下，我使 imageview 不可见，这使得我的 adview 无法正确调整（android:layout_below 属性我已经给了我的 adview）。

`

```
<ImageView
    android:id="@+id/previous"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_marginLeft="5dp"
    android:layout_marginTop="10dp"
    android:background="@drawable/le"
    android:clickable="true"
    android:contentDescription="@string/app_name"
    android:onClick="previous"
    android:paddingBottom="3dp" >
</ImageView>

<ImageView
    android:id="@+id/next"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_marginRight="5dp"
    android:layout_marginTop="10dp"
    android:background="@drawable/ri"
    android:clickable="true"
    android:contentDescription="@string/app_name"
    android:onClick="next"
    android:paddingBottom="3dp" >
</ImageView>

<com.google.ads.AdView
        android:id="@+id/adView"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        ads:adSize="BANNER"
        ads:adUnitId="PUB ID"
        android:layout_below="@+id/next"
        ads:loadAdOnCreate="true" />

<TextView
    android:id="@+id/tv"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="18dp"
    android:layout_below="@+id/adView"
    android:textColor="@color/red"
    android:textSize="20dp"
    android:textStyle="bold" />

<ListView
    android:id="@+id/list"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_below="@+id/tv"
    android:layout_marginTop="6dp"
    android:cacheColorHint="#00000000"
    android:clickable="false"
    android:dividerHeight="30.0dp"
    android:fadingEdge="none"
    android:focusable="false"
    android:focusableInTouchMode="false"
    android:scrollbars="none" >
</ListView> 
```

`

我已经使用 Layout_above 属性将 adview 放在 textview 上方，因为 textview 始终可见。但是当我这样做时，我得到一个错误，说循环依赖在相对布局中是不可能的。下面是更好理解的图像。

![在此处输入图像描述](../Images/f465a758d4749bd4815e649256e2bebd.png)

我该如何解决这个问题。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:34:30.087

你是如何制造`ImageView`隐形的？如果您使用`imgView.setVisibility(View.INVISIBLE)`，则 adView 应保留其位置。

# c# - 将文件上传到 FTP 在目的地一次损坏

> ID：10330641
> 
> 赞同：12
> 
> 时间：2012-04-26T09:26:04.723
> 
> 标签：c#, winforms, ftpwebrequest

我正在创建一个简单的拖放文件并自动上传到 ftp Windows 应用程序

![在此处输入图像描述](../Images/59d379b2350ef408249290b1b013bc11.png)

我正在使用[MSDN 代码](http://msdn.microsoft.com/en-us/library/ms229715.aspx)将文件上传到 FTP。

代码非常简单：

```
// Get the object used to communicate with the server.
FtpWebRequest request = (FtpWebRequest)WebRequest.Create(String.Format("{0}{1}", FTP_PATH, filenameToUpload));
request.Method = WebRequestMethods.Ftp.UploadFile;

// Options
request.UseBinary = true;
request.UsePassive = false;

// FTP Credentials
request.Credentials = new NetworkCredential(FTP_USR, FTP_PWD);

// Copy the contents of the file to the request stream.
StreamReader sourceStream = new StreamReader(fileToUpload.FullName);
byte[] fileContents = Encoding.UTF8.GetBytes(sourceStream.ReadToEnd());
sourceStream.Close();
request.ContentLength = fileContents.Length;

Stream requestStream = request.GetRequestStream();
requestStream.Write(fileContents, 0, fileContents.Length);
requestStream.Close();

FtpWebResponse response = (FtpWebResponse)request.GetResponse();
writeOutput("Upload File Complete!");
writeOutput("Status: " + response.StatusDescription);

response.Close(); 
```

它**确实**被上传到 FTP

![在此处输入图像描述](../Images/6d0d265173bb3dc721f405b8ee5976af.png)

**问题是**当我在浏览器上看到文件，或者只是下载并尝试在桌面上看到它时，我得到：

![在此处输入图像描述](../Images/c1c1549c018b530785011d4320d838f3.png)

我已经用过`request.UseBinary = false;`，`request.UsePassive = false;`但它没有任何好处。

**我发现**，原始文件的长度为 122Kb，在 FTP 中（下载后），它有 219Kb ...

> 我究竟做错了什么？

顺便说一句，该`uploadFileToFTP()`方法在 a 中运行`BackgroundWorker`，但我真的没有什么不同...

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-26T09:34:56.263

您不应该使用 StreamReader 而只能使用 Stream 来读取二进制文件。

Streamreader 旨在仅读取文本文件。

试试这个：

```
private static void up(string sourceFile, string targetFile)
{            
    try
    {
        string ftpServerIP = ConfigurationManager.AppSettings["ftpIP"];
        string ftpUserID = ConfigurationManager.AppSettings["ftpUser"];
        string ftpPassword = ConfigurationManager.AppSettings["ftpPass"];
        ////string ftpURI = "";
        string filename = "ftp://" + ftpServerIP + "//" + targetFile; 
        FtpWebRequest ftpReq = (FtpWebRequest)WebRequest.Create(filename);
        ftpReq.UseBinary = true;
        ftpReq.Method = WebRequestMethods.Ftp.UploadFile;
        ftpReq.Credentials = new NetworkCredential(ftpUserID, ftpPassword);

        byte[] b = File.ReadAllBytes(sourceFile);

        ftpReq.ContentLength = b.Length;
        using (Stream s = ftpReq.GetRequestStream())
        {
            s.Write(b, 0, b.Length);
        }

        FtpWebResponse ftpResp = (FtpWebResponse)ftpReq.GetResponse();

        if (ftpResp != null)
        {
            MessageBox.Show(ftpResp.StatusDescription);
        }
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.ToString());
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T09:34:48.423

问题是由您的代码将二进制数据解码为字符数据并返回二进制数据引起的。不要这样做。

* * *

使用[WebClient 类](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)的[UploadFile 方法](http://msdn.microsoft.com/en-us/library/36s52zhs.aspx)：

```
using (WebClient client = new WebClient())
{
    client.Credentials = new NetworkCredential(FTP_USR, FTP_PWD);
    client.UploadFile(FTP_PATH + filenameToUpload, filenameToUpload);
} 
```

# c# - 通过自动化为 ASP.NET 应用程序生成资源文件

> ID：10330642
> 
> 赞同：0
> 
> 时间：2012-04-26T09:26:07.720
> 
> 标签：c#, asp.net-mvc

我有一个完全开发和使用的 ASP.NET 应用程序。现在我必须支持多种语言。应用程序一直不一致地使用资源文件已经存在。75% 的页面使用资源字符串，25% 的页面使用硬编码字符串。现在我想支持多种语言。任何人都可以请给出最简单的方法吗？

# image - 没有得到 8 位灰度图像的 glcm 矩阵尺寸

> ID：10330652
> 
> 赞同：0
> 
> 时间：2012-04-26T09:26:30.830
> 
> 标签：image, matlab, glcm

正如[理论](http://en.wikipedia.org/wiki/Co-occurrence_matrix)所述，glcm 矩阵的尺寸为 2^x x 2^x，其中 x 是图像的灰度深度。我的问题是，当我在 8 位灰度图像上运行它时，我得到一个 8 × 8 矩阵而不是 2^8 × 2^8 矩阵。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T14:37:47.153

根据 MA​​TLAB 文档，

> graycomatrix 从图像的缩放版本计算 GLCM。默认情况下，如果 I 是二值图像，graycomatrix 会将图像缩放到两个灰度级。如果 I 是强度图像，graycomatrix 将图像缩放到八个灰度级。您可以使用参数指定 graycomatrix 用于缩放图像的灰度级数`'NumLevels'` ，以及 graycomatrix 使用参数缩放值的方式 `'GrayLimits'`- 请参阅参数。

简而言之，您需要按如下方式运行该函数：

```
glcm = graycomatrix(I , 'NumLevels' , 2^8 ); 
```

# java - Java + Google Web Toolkit（谷歌应用引擎）从服务器下载文件

> ID：10330661
> 
> 赞同：0
> 
> 时间：2012-04-26T09:27:19.393
> 
> 标签：java, google-app-engine, gwt

我已经在 Google App Engine 中部署了一个应用程序，并且我想使用桌面上的 java 代码和用于下载请求的服务器代码从服务器上传和下载数据，还有一个：我在哪里将数据存储在应用程序引擎中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T13:24:20.037

要存储二进制数据（文件内容），您有三个选项：

1.  [数据存储区实体的 Blob 属性](https://developers.google.com/appengine/docs/java/datastore/entities#Properties_and_Value_Types)
2.  [Blobstore](https://developers.google.com/appengine/docs/java/blobstore/)
3.  [谷歌云存储](https://developers.google.com/appengine/docs/java/googlestorage/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T06:47:23.260

您可以将文件保存在服务器上的任何位置，您只需要知道路径即可。

> 我如何将它作为输出流？

这是一个可以帮助您的代码片段。

```
File fileOnServer = new File("Hello.txt"); // Give full path where your file is located

byte[] file = new byte[(int) fileOnServer.length()];

FileInputStream fileInputStream = new FileInputStream(fileOnServer);
fileInputStream.read(file);

int contentLength = (int) file.length;
response.setContentLength(contentLength);
response.setHeader("Content-Disposition", "attachment; filename=\"Hello.txt\"");
out = response.getOutputStream();

int bytesWritten = 0;
byte[] buffer = new byte[1024];
while (bytesWritten < contentLength) {
    int bytes = Math.min(1024, contentLength - bytesWritten);
    System.arraycopy(file, bytesWritten, buffer, 0, bytes);
    if (bytes > 0) {
        out.write(buffer, 0, bytes);
        bytesWritten += bytes;
    } else if (bytes < 0);
} 
```

> 下载到用户端？

好吧，您可以在客户端的 Button 上添加 ClickHandler 并覆盖`onClick`方法。

```
public void onClick(ClickEvent event) {
        Window.open("UrlToYourServelet", "_blank", "null");
} 
```

希望这可以帮助！

**编辑**

我找到了解决方案。[您可以像这样](http://www.4shared.com/)在任何免费文件托管网站上传文件。该站点为每个上传的文件提供一个 URL。因此，在您的 serverlet 中，向 URL 发出 HTTP 请求，然后下载文件`byte[]`并将其写入 outputStream，如上面的代码所示。

# gitolite - gitolite：通道 0 上的 PTY 分配请求失败

> ID：10330678
> 
> 赞同：25
> 
> 时间：2012-04-26T09:28:28.723
> 
> 标签：gitolite

jenkins（ci-server）和我的 git 存储库都托管在同一台服务器上。git repo 由 gitolite 控制。如果我从外部访问存储库，例如从我的工作站我得到

```
ssh git@arrakis

PTY allocation request failed on channel 0
hello simou, this is git@arrakis running gitolite3 v3.0-12-ge0ed141 on git 1.7.3.4

 R W    testing
Connection to arrakis closed. 
```

我猜这很好（除了PTY ...警告）

现在回到服务器，我希望 jenkins 也能够连接到我的 git 存储库。

```
jenkins@arrakis:~> ssh git@arrakis
gitolite: PTY allocation request failed on channel 0 
```

以用户 git（gitolite 用户）身份登录 arrakis：

```
git@arrakis:~> cat ~git/.ssh/authorized_keys

command="/home/git/gitServer/gitolite/src/gitolite-shell jenkins",no-port-forwarding,no-x11-forwarding,no-agent-forwarding,no-pty ssh-rsa <PUBLIC-KEY> jenkins@arrakis 
```

“no-pty”条目让我很怀疑，所以我将其从 authorized_keys 中删除并再次尝试：

```
jenkins@arrakis:~> ssh git@arrakis
hello jenkins, this is git@arrakis running gitolite3 v3.0-12-ge0ed141 on git 1.7.3.4

 R W    testing
Connection to arrakis closed. 
```

这解决了我的问题，但我不确定删除“no-pty”的后果。

为什么它只影响本地访问，因为远程访问似乎根本没有受到影响？

* * *

openSUSE 11.4 (x86_64) 版本 = 11.4 代号 = 青瓷

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-04-27T07:33:21.957

您的工作站和服务器之间的行为差​​异可能是由于`ssh`在每个系统上使用不同版本的 OpenSSH 客户端 ( )（不是远程与本地）。`-T`除非给出，否则客户端将向服务器请求 pty ，或者`RequestTTY`配置选项设置为`no`（后者首先在 OpenSSH 5.9 中可用）。行为的不同在于客户端如何处理服务器拒绝此请求（例如，因为`no-pty`在适用的`authorized_keys`条目中给出）：

*   在 OpenSSH 5.6 之前：
    *   客户端将显示“PTY 分配请求失败”消息，并且
    *   **继续**“无 pty”模式
*   在 OpenSSH 5.6-5.8 中：
    *   客户端将显示“PTY 分配请求失败”消息，并且
    *   **中止**连接
*   在 OpenSSH 5.9（及更高版本）中：
    *   客户端将显示“PTY 分配请求失败”消息，并且
    *   如果`-t`没有给出，并且`RequestTTY`是`auto`（默认），那么
        *   **继续**“无 pty”模式
    *   else（`-t`给定，或者`RequestTTY`配置选项是`yes`or `force`）
        *   **中止**连接

由于您的服务器`ssh`在其 pty 分配请求被拒绝时似乎中止，它可能正在运行 OpenSSH 5.6-5.8（至少对于客户端二进制文件）。同样，由于您的工作站`ssh`显示警告但仍在继续，它可能正在运行 5.6 之前的 OpenSSH，或者 5.9 或更高版本的 OpenSSH。您可以使用`ssh -V`.

您可以通过使用 always 提供`-T`选项来防止行为差异，以便客户端（任何版本）永远不会从服务器请求 pty：

```
ssh -T git@YourServer 
```

在实际的 Git 访问期间，客户端从不尝试分配 pty，因为 Git 会给客户端一个特定的命令来运行（例如`ssh server git-upload-pack path/to/repository`）而不是请求“交互式”会话（例如`ssh server`）。换句话说，`no-pty`不应该对实际的 Git 访问造成问题；它只会影响您的身份验证测试（取决于您运行的 OpenSSH 客户端的版本），因为缺少命令参数会导致隐式 pty 分配请求（对于“交互式”会话）。

* * *

从[OpenSSH 5.6 发布公告](http://marc.info/?l=openssh-unix-dev&m=128256356229601)：

> *   当 pty 分配请求失败时终止通道。如果服务器拒绝 pty 分配，则修复了卡住的客户端 (bz#1698)

`bz#1698`似乎是对[记录在“Portable OpenSSH”Bugzilla 中的报告](https://bugzilla.mindrot.org/show_bug.cgi?id=1698)的引用。

* * *

从[OpenSSH clientloop.c rev 1.234](http://www.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/clientloop.c#rev1.234)的签入消息中：

> 在 TTY 分配失败时改进我们的行为：如果我们处于 RequestTTY=auto 模式（默认），那么不要将 TTY 分配错误视为致命，而只是将本地 TTY 恢复为熟模式并继续。这在从不分配 TTY 的设备上更加优雅。
> 
> 如果 RequestTTY 设置为“yes”或“force”，则无法分配 TTY 是致命的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T11:09:42.310

要知道为什么它只影响本地访问，您需要像[在本文中](http://platonic.techfiz.info/2008/10/13/pty-allocation-request-failed-on-channel-0/)那样调试它。

```
ssh -vvv git@arrakis 
```

如果您的`/etc/ssh/sshd_config`SSH 守护程序配置文件包含 (un-commented) 行`SyslogFacility AUTHPRIV`，您可以查看您的 SSH 登录`/var/log/secure`。

话虽如此，请查看[GitoliteV3](http://sitaramc.github.com/gitolite/g3why.html)：我认为它不会`no-pty`在当前设置中使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-03T07:34:48.240

除了 Chris Johnsen 之外，非常完整的答案请注意，明确给出`info`命令不会显示 PTY 警告：

```
ssh git@arrakis info 
```

在这种情况下，SSH 认为这不是交互式会话，不会请求 TTY。

# objective-c - 如何在没有死锁的情况下同步调度主队列？

> ID：10330679
> 
> 赞同：63
> 
> 时间：2012-04-26T09:28:29.767
> 
> 标签：objective-c, ios, objective-c-blocks, grand-central-dispatch

我需要在主队列上同步调度一个块。我不知道我当前是否在主线程上运行。天真的解决方案如下所示：

```
dispatch_sync(dispatch_get_main_queue(), block); 
```

但是，如果我当前位于主队列上运行的块内，则此调用会产生死锁。（同步调度等待块完成，但块甚至没有开始运行，因为我们正在等待当前的完成。）

显而易见的下一步是检查当前队列：

```
if (dispatch_get_current_queue() == dispatch_get_main_queue()) {
    block();
} else {
    dispatch_sync(dispatch_get_main_queue(), block);
} 
```

这有效，但它很丑。在我至少将它隐藏在一些自定义函数后面之前，对于这个问题没有更好的解决方案吗？我强调我不能异步调度块——应用程序处于异步调度块将“太晚”执行的情况。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-04-26T21:14:55.400

我需要在我的 Mac 和 iOS 应用程序中经常使用类似的东西，所以我使用以下帮助函数（最初在[这个答案](https://stackoverflow.com/a/5226271/19679)中描述）：

```
void runOnMainQueueWithoutDeadlocking(void (^block)(void))
{
    if ([NSThread isMainThread])
    {
        block();
    }
    else
    {
        dispatch_sync(dispatch_get_main_queue(), block);
    }
} 
```

你通过它调用

```
runOnMainQueueWithoutDeadlocking(^{
    //Do stuff
}); 
```

这几乎就是您在上面描述的过程，并且我已经与其他几位为自己独立制作类似这样的东西的开发人员进行了交谈。

我使用`[NSThread isMainThread]`而不是检查`dispatch_get_current_queue()`，因为该[函数的警告部分](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man3/dispatch_get_current_queue.3.html)曾经警告不要使用它进行身份测试，并且[该调用在 iOS 6 中已弃用](https://stackoverflow.com/questions/13237417/alternatives-to-dispatch-get-current-queue-for-completion-blocks-in-ios-6)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-06-29T13:24:25.437

为了在主队列或主线程上同步（不一样），我使用：

```
import Foundation

private let mainQueueKey    = UnsafeMutablePointer<Void>.alloc(1)
private let mainQueueValue  = UnsafeMutablePointer<Void>.alloc(1)

public func dispatch_sync_on_main_queue(block: () -> Void)
{
    struct dispatchonce  { static var token : dispatch_once_t = 0  }
    dispatch_once(&dispatchonce.token,
    {
        dispatch_queue_set_specific(dispatch_get_main_queue(), mainQueueKey, mainQueueValue, nil)
    })

    if dispatch_get_specific(mainQueueKey) == mainQueueValue
    {
        block()
    }
    else
    {
        dispatch_sync(dispatch_get_main_queue(),block)
    }
}

extension NSThread
{
    public class func runBlockOnMainThread(block: () -> Void )
    {
        if NSThread.isMainThread()
        {
            block()
        }
        else
        {
            dispatch_sync(dispatch_get_main_queue(),block)
        }
    }

    public class func runBlockOnMainQueue(block: () -> Void)
    {
        dispatch_sync_on_main_queue(block)
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-28T17:50:34.810

我最近开始在 UI 更新期间遇到死锁。这导致了我这个 Stack Overflow 问题，这导致我`runOnMainQueueWithoutDeadlocking`根据接受的答案实现了一个 -type 辅助函数。

然而，真正的问题是，当从我错误使用的块更新 UI 时，`dispatch_sync`而不是`dispatch_async`获取 UI 更新的主队列。代码完成很容易做到，事后可能很难注意到。

因此，对于阅读此问题的其他人：**如果不需要同步执行**，只需使用即可`dispatch_**a**sync`避免您可能间歇性遇到的死锁。

# python - 如何更新谷歌应用引擎中的数据 - Python？

> ID：10330680
> 
> 赞同：0
> 
> 时间：2012-04-26T09:28:32.670
> 
> 标签：python, google-app-engine

如何在谷歌应用引擎中更新我的记录？

我的模型具有以下字段

```
doc_no = db.IntegerProperty()
title = db.StringProperty()
level = db.StringProperty() 
```

我想要的是更新字段标题和级别，但我想通过 JavaScript 对象之类的字符串访问属性/属性，即

如果我对模型进行选择

```
myRecord = db.GQLQuery('Select * from MyModelAbove where doc_no = 1') 
```

是否可以像这样访问和更新属性；

```
myRecord['title']='New Tile'
myRecord['level']='Level2'
myRecord.put() 
```

我见过的是这个（不适合我）；

```
myRecord.title = 'New Title' 
```

注意：顺便说一下，谷歌在这方面的文档非常少

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-26T12:00:07.130

在您的代码示例中，myRecords 是一个查询。您必须在进行任何修改之前[获得结果：](https://developers.google.com/appengine/docs/python/datastore/gqlqueryclass#GqlQuery_get)

```
result = myRecords.get() 
```

然后，如果您不能或不想使用 访问 title 属性`result.title`，则可以使用`setattr(result, 'title', 'New Title')`then`result.put()`

# .net - 下载 .NET 3.5 的实体框架

> ID：10330682
> 
> 赞同：3
> 
> 时间：2012-04-26T09:28:40.907
> 
> 标签：.net, entity-framework, .net-3.5

**我可以在.NET 3.5**中使用哪个版本的**实体框架**(EF)，我可以在哪里下载这个旧版本？

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:35:04.853

对于 .Net 3.5，您可以使用 EF v1。

您是否尝试从[http://www.microsoft.com/download/en/details.aspx?id=22](http://www.microsoft.com/download/en/details.aspx?id=22)下载 Microsoft .NET Framework 3.5 Service Pack 1 它应该包括第一个版本的实体框架 (EFv1)，如上所述[http://en.wikipedia.org/wiki/ADO.NET_Entity_Framework](http://en.wikipedia.org/wiki/ADO.NET_Entity_Framework)。**

# c# - 从不同的代码隐藏更改 ascx 内容

> ID：10330683
> 
> 赞同：0
> 
> 时间：2012-04-26T09:28:42.433
> 
> 标签：c#, javascript, asp.net, .net, webforms

假设我有 tvo 页面 page1.ascx 和 page2.ascx。两个页面都有代码隐藏（分别为 page1.ascx.cs 和 page2.ascx.cs）。

因此 page1 和 page2 在浏览器中同时呈现，并排。

现在 page1.ascx 有一个 ListView，它的代码隐藏有一个填充它的方法（PopulateListbox()）。如何从 page2.ascx 代码隐藏中调用 PopulateListbox()？

```
page1 p1 = new page1();
p1.PopulateListbox(); 
```

...不起作用，并且 findController 查找列表框的 ID 返回一个空值。

任何指导都会有很大帮助，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:32:10.273

```
var p1 = this.Page.FindControl("page1Id") as page1;
if (p1 != null)
   p1.PopulateListbox(); 
```

不过，您可以通过不同的方式执行此操作。在第一个控件上为特定操作创建一个事件。在父页面中添加一个事件处理程序，该事件处理程序将包含以下调用

```
p1.PopulateListbox(); 
```

[这里](http://msdn.microsoft.com/en-us/library/ms972975.aspx#usercontrols_topic8)是如何创建自己的事件的链接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:37:43.040

直接从另一个用户控件访问一个用户控件方法听起来不是一个很好的设计。

您可以做的是在 page2.ascx 中创建一个委托，当您在其他用户控件中的刷新操作需要发生时，该委托会被调用。

您的 aspx 页面订阅该委托并调用 page1.ascx PopulateListBox 方法。

因此，您的页面编排了两个用户控件之间的交互，并且它们彼此不了解。

# debugging - Opa 会话错误

> ID：10330685
> 
> 赞同：0
> 
> 时间：2012-04-26T09:28:51.043
> 
> 标签：debugging, opa

我的 opa 应用程序出现以下错误：

```
[SESSION] Uncaught exception: "{OpaRPC_Server: {timeout: {client: {client: $"s2jtpj3tbyztpfbrm3gf8bd2k7kcnxg1"$; page: $
896774575$}; fun_id: $"_v0_get_value_stdlib.core.xhtml"$}}}"
  The following message is skipped.:
    If you want (msg, st, ctx) debug printing set debug variable session_debug >= 200C 
```

这是什么意思 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T10:23:20.803

这意味着两件事你有一个调用客户端函数的服务器会话，但客户端不回复服务器。

1 - 当客户端不回复服务器时，客户端调用会在超时后引发 Opa 异常“OpaRPC_Server”。这可能在几种情况下发生（客户端运行时错误、客户端离开应用程序等）。在您的情况下，服务器尝试调用由“_v0_get_value_stdlib.core.xhtml”标识的客户端函数（Dom.get_value？）

2 - 当会话处理程序上未捕获异常时，会话捕获异常，抛出当前消息并释放会话以处理将来的消息。

请注意，当您进行（标准）会话时，消息处理程序是一个关键部分。

# algorithm - 地牢牢房系统算法

> ID：10330686
> 
> 赞同：0
> 
> 时间：2012-04-26T09:29:05.553
> 
> 标签：algorithm, xna

现在，我正在制作类似地牢大师的游戏。游戏必须比*《荒野传说》*更多地与剑和魔法相关；类似*走廊巫术 8*的东西。我要制作一些像样的图形，所以我正在考虑正确的细胞系统算法。

首先，我在考虑 BSP。我从这些链接中获得了一些信息

*   [BSP地牢生成的简单示例](https://stackoverflow.com/questions/4997642/simple-example-of-bsp-dungeon-generation)
*   [http://roguebasin.roguelikedevelopment.org/index.php?title=Basic_BSP_Dungeon_generation](http://roguebasin.roguelikedevelopment.org/index.php?title=Basic_BSP_Dungeon_generation)

但我不知道。基本形式的 BSP 仅对 2D 类 Rogue-like 地牢有用。

我正在使用 C# XNA，所以我正在考虑我自己的系统在 xml 中逐个单元格地定义，首先是它们在空间中的位置（制作一些隧道地图系统），然后是它们的所有细节，例如纹理。但是，我害怕在墙上放置“地图文件”生成的对象，如火把、宝箱、秘密按钮、陷阱其他物品等。

我想知道，哪种方式最能满足我的游戏内需求，我不想花几个月的时间探索 BSP，然后选择另一种方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T09:42:49.813

通常，您为此目的所追求的是[迷宫生成算法](http://en.wikipedia.org/wiki/Maze_generation_algorithm)，其中 BSP 是一种实现方式。

但是，您应该首先决定如何代表您的世界。

如果您想创建一组“链接区域”，那么您可以使用 DFS 类型的算法，它会尝试以复杂的方式链接各个区域。（把它想象成你在 MUD 类型游戏中导航的区域）

否则，如果您想选择一个代表您的地牢的大型实体迷宫，那么您可以使用该维基百科链接中的一种算法生成一个简单的位图，然后将其用作您的“平面图”。然后可以向上挤压以创建墙壁并为您提供非常基本的“末日”式空间，然后您可以使用火炬/纹理/任何其他对象丰富该空间。

我希望这有帮助。

# jquery - 红色警报通知 div 顶部，如 facebook stackexchange

> ID：10330687
> 
> 赞同：1
> 
> 时间：2012-04-26T09:29:06.617
> 
> 标签：jquery, css

当我在 facebook 中收到评论或回答我的问题 StackExchange 时，我看到左上角的红色圆圈有任何效果。我每 X 分钟加载/刷新我的 div。现在我需要在这个***红色圆圈***中打印我的结果（1,2,3 ...） 。如何工作？我的结果`DIV id="new"`。

我的代码：

```
<script type="text/javascript">
var auto_refresh = setInterval(
function ()
{
$('#new').load('new.php').fadeIn("slow");
}, 10000); // refresh every 10000 milliseconds
</script>

<div id="new"></div> 
```

演示屏幕：

![在此处输入图像描述](../Images/26e9e2c566162436047c9fa816bcaacf.png)

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:33:39.697

您可以使用 SetTimeOut() javascript 函数

```
(function(){
        $.ajax({
            'url': 'news.php', 
            'success':  function (data,textStatus)
                        {
                            var res = $.parseJSON(data);
                            if(res.ok)
                            {
                                $('#news').html(res.newsCount);
                            }
                        }
        });
        setTimeout(arguments.callee, 1000);
    })();​ 
```

我不知道你的 new.php 做了什么，但我认为 ajax 函数是获取新通知计数的更好方法

例如：http : [//jsfiddle.net/PCSL5/3/](http://jsfiddle.net/PCSL5/3/)

对于 php：

```
$result = array();
$result['ok'] = false;
/*
* make here your DB Query
*/

if($queryResultAsCount > 0 )
{
    $result['newsCount'] = $queryResultAsCount;
    $result['ok'] = true;
}

$json = json_encode($result);

die($json); 
```

在你的 ajax 请求中，你得到一个 JSON 对象，它有 2 个属性 res.ok 和 res.newsCount （作为你死的 php 表）

# r - 发生错误是因为 ggplot2 未在 R 2.15 中升级

> ID：10330690
> 
> 赞同：2
> 
> 时间：2012-04-26T09:29:10.933
> 
> 标签：r, ggplot2

我需要一些关于 ggplot2 的帮助。我有一些气象数据，想绘制时间序列。我尝试使用 R 脚本，它适用于这种类型的数据，并进行了轻微修改。但是当尝试 ggplot 时，我得到了一个我以前从未见过的错误（不像 R 用户那样有经验）。

我正在使用的代码

```
library(ggplot2)
library(zoo)

datos=read.csv("dat.txt",header=TRUE,sep=";")
fecha=as.POSIXct(datos[,1], format="%d/%m/%Y")
tmax = ggplot(data=datos,aes(x=fecha, y=TempMax)) + geom_line(colour="red") 
```

我在写作时遇到的错误`tmax`是

```
Error in cut.default(unclass(x), unclass(breaks), labels = labels, right = right,  : 
  a vector of length 1317420001 could not be assigned 
```

`dput`可以在 https://www.dropbox.com/s/rkh6db9aqdyfw7k/dputdatos.txt 找到数据结构，在[https://www.dropbox.com/s/ds5zp9jonznpuwb/dat.txt](https://www.dropbox.com/s/ds5zp9jonznpuwb/dat.txt)找到[原始](https://www.dropbox.com/s/rkh6db9aqdyfw7k/dputdatos.txt) 数据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:31:40.180

问题来自 R 和 ggplot2 版本。我正在使用 R 2.15.0，必须将 ggplot2 更新为 0.9.0。

现在一切都运行良好。

谢谢你们

# c++ - ComboBox 子类化列表框

> ID：10330692
> 
> 赞同：1
> 
> 时间：2012-04-26T09:29:21.187
> 
> 标签：c++, subclass, common-controls

出于某些自定义原因，我正在尝试对组合框的列表框和编辑控件进行子类化。下面是代码工作。编辑控件的子类化工作完美，但列表框没有收到 MouseDown 的消息。

```
void Subclass(HWND hComboBox)
{
    HWND hEdit=FindWindowEx(hComboBox, NULL, WC_EDIT, NULL);
    HWND hCombo=FindWindowEx(hComboBox, NULL, WC_LISTBOX, NULL);
    SetProp(hEdit, TEXT("Wprc"), (HANDLE)GetWindowLongPtr(hEdit, GWL_WNDPROC));
    SubclassWindow(hEdit, ComboBox_Proc);
    SetProp(hCombo, TEXT("Wprc1"), (HANDLE)GetWindowLongPtr(hCombo, GWL_WNDPROC));
    SubclassWindow(hCombo, ComboBox_Proc1);
}

static LRESULT CALLBACK ComboBox_Proc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
{

    switch(msg)
    {
        case WM_CHAR:
            break;
        case WM_KEYDOWN:
            break;
        case WM_DESTROY:
            SetWindowLongPtr(hwnd, GWLP_WNDPROC, (DWORD)GetProp(hwnd, TEXT("Wprc")));
            RemoveProp(hwnd, TEXT("Wprc"));
            break;
        default:
            return CallWindowProc((WNDPROC)GetProp(hwnd, TEXT("Wprc")), hwnd, msg, wParam, lParam);
    }
    return FALSE;
}

static LRESULT CALLBACK ComboBox_Proc1(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
 {
    switch(msg)
    {
        case WM_LBUTTONDOWN:
          //PROBLEM IS HERE
            break;
        case WM_DESTROY: 
            SetWindowLongPtr(hwnd, GWLP_WNDPROC, (DWORD)GetProp(hwnd, TEXT("Wprc1")));
            RemoveProp(hwnd, TEXT("Wprc1"));
            break;
        default:
            return CallWindowProc((WNDPROC)GetProp(hwnd, TEXT("Wprc1")), hwnd, msg, wParam, lParam);
    }
    return FALSE;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T11:08:24.720

ComboBox 的 ListBox 部分是 COMBOLBOX 类型（**带有 L**）。

ComboLBox 窗口不是 ComboBox 窗口的子窗口。我发现子类 COMBOLBOX 控件的唯一方法如下。

在绘制列表框之前， Windows 将 WM_CTLCOLORLISTBOX 消息发送到 COMBOBOX（**无 L**）。此消息的 lParam 包含列表框的句柄。

```
 case  WM_CTLCOLORLISTBOX:
 {       
    if ( !hSubclassedListBox ) 
    { 
        hSubclassedListBox = (HWND)lParam; 
        SubclassWindow(hSubclassedListBox , MyLBProc);
    }
 } 
```

另请参阅此[链接](http://www.codeproject.com/Articles/9455/Hacking-the-Combo-Box-to-give-it-horizontal-scroll)以获取更多信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-12-30T02:50:36.993

对于那些使用 WINVER 设置为 0500 或更高版本（Windows XP 或更高版本）的 Visual Studio 的用户，您可以使用 GetComboBoxInfo 函数（将句柄传递给 ComboBox），它将（在 COMBOBOXINFO 结构中）将句柄返回给两个编辑框和组合框（ListBox）。然后可以使用句柄来获取它们所代表的 CWnd 派生对象。

# java - Javascript 正则表达式在 Java 中不起作用

> ID：10330693
> 
> 赞同：0
> 
> 时间：2012-04-26T09:29:25.007
> 
> 标签：java, javascript, regex

我得到了这个 Javascript 电话正则表达式： `/^([\+][0-9]{1,3}[ \.\-])?([\(]{1}[0-9]{2,6}[\)])?([0-9 \.\-\/]{3,20})((x|ext|extension)[ ]?[0-9]{1,4})?$/`

字符串“063-444-444”成功通过。

我试图将其转换为 Java：

```
^([\\+][0-9]{1,3}[ \\.\\-])?([\\(]{1}[0-9]{2,6}[\\)])?(\\[0-9 \\.\\-\\]{3,20})((x|ext|extension)[ ]?[0-9]{1,4})?$ 
```

相同的字符串在 Java 中失败。怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T09:33:30.123

你没有正确地逃脱它。您无需转义字符类周围的方括号 (`[`和)。`]`

尝试：

```
^([\\+][0-9]{1,3}[ \\.\\-])?([\\(]{1}[0-9]{2,6}[\\)])?([0-9 \\.\\-\\/]{3,20})((x|ext|extension)[ ]?[0-9]{1,4})?$ 
```

# c# - 处理重复任务的框架

> ID：10330699
> 
> 赞同：2
> 
> 时间：2012-04-26T09:29:38.240
> 
> 标签：c#, .net-3.5, windows-services

我们实现了一个包含几个计时器的 Windows 服务。随着时间的推移，计时器的逻辑变得越来越复杂。是时候重构我们的解决方案了，一种可能的方法是使用一个有据可查的框架来处理我们的需求。

有这样的规则：

*   每天早上 9 点开始计时器 A

*   每 2 分钟启动计时器 B

*   如果计时器 A 已启动，则不要启动任何其他计时器

*   定时器 C 和 D 不允许同时运行

我查看了 Quartz.net，因为它有我们列表的前 2 个要求，但它不处理任何并发规则。

有什么框架我可以看看吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:39:05.930

我有类似的要求：本质上，您需要的是一个可以轻松序列化到磁盘或数据库的状态**机**，使用分层状态轻松指定状态机的某种方式，轻松指定时间事件的某种方式（*After*，*Every*，*At*）以及一些可以轻松知道何时将状态机加载回内存以根据当前时间推进状态的方法。

最后我写了自己的状态机，因为我没有找到满足我要求的状态机，特别是时间事件和序列化要求。[您可以在Nuget Package](https://nuget.org/packages/AboditStateMachine/0.1.1353)中获取源代码。博客条目[在这里](http://blog.abodit.com/2012/04/building-a-better-net-state-machine/)。欢迎反馈。

# struts2 - 无法显示 Struts2 fieldError

> ID：10330703
> 
> 赞同：0
> 
> 时间：2012-04-26T09:29:47.840
> 
> 标签：struts2, struts-validation

我创建了发送动作请求的 index.jsp

```
 <meta http-equiv="REFRESH" content="0;url=./radioButton.action"> 
```

完成此操作后，请求被转发到**radio.jsp**。在这个我显示国家，州列表等。（所以我从**index.jsp****重定向**）。现在**我正在对这个表单进行验证**。**我已经**为验证正确创建了 .xml。当验证失败时，它将被重定向到 ./radioButton.action

 ******```
 <result name="input" type="redirectAction">radioButton</result> 
```

我创建了一个扩展**MethodFilterInterceptor**的拦截器，以便将操作错误保留在会话范围内，在 after() 方法中具有以下逻辑。

```
if (fieldErrors != null && fieldErrors.size() > 0)
        {
            Iterator it = fieldErrors.entrySet().iterator();
            while (it.hasNext()) {
                Map.Entry pairs = (Map.Entry)it.next();
                System.out.println(pairs.getKey() + " = " + pairs.getValue().toString());
            }
            session.put(FIELD_ERRORS_KEY, fieldErrors);
        }

 public static final String FIELD_ERRORS_KEY    = "RedirectMessageInterceptor_FieldErrors"; 
```

我已经在我的 .xml 中配置了拦截器，如下所示

```
<interceptors>
    <interceptor name="redirectMessage"  class="com.daya.message.RedirectMessageInterceptor" />

       <interceptor-stack name="sessionStack">
        <interceptor-ref name="redirectMessage" />
            <interceptor-ref name="defaultStack" />
       </interceptor-stack>
  </interceptor-stack>
</interceptors> 
```

**在进入会话范围之前，我在控制台上**收到错误消息。在控制台打印的输出是

```
userName = [User Name is required to login]
password = [Password is required to login] 
```

我正在使用下面的标签来显示字段错误

```
<s:fielderror></s:fielderror> 
```

但是在重定向后的jsp中（当验证失败时）消息没有得到显示。

**客户端验证运行良好。我禁用了用于检查服务器端验证的 javascript**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T11:00:23.413

由于 Struts 提供了一种使用[MessageStoreInterceptor](http://struts.apache.org/2.3.1/docs/message-store-interceptor.html)处理此问题的方法，但我不知道您为什么要手动执行此操作。******

# php - Symfony 2.0 在实体内部获取服务

> ID：10330704
> 
> 赞同：37
> 
> 时间：2012-04-26T09:29:48.690
> 
> 标签：php, service, symfony, doctrine-orm, entity

我搜索并找不到答案。我的应用程序中有数据库角色模型。用户可以有一个角色，但这个角色必须存储到数据库中。

但是随后用户需要从数据库中添加默认角色。所以我创建了一个服务：

```
<?php

namespace Alef\UserBundle\Service;

use Alef\UserBundle\Entity\Role;

/**
 * Description of RoleService
 *
 * @author oracle
 */
class RoleService {

    const ENTITY_NAME = 'AlefUserBundle:Role';

    private $em;

    public function __construct(EntityManager $em)
    {
        $this->em = $em;
    }

    public function findAll()
    {
        return $this->em->getRepository(self::ENTITY_NAME)->findAll();
    }

    public function create(User $user)
    {
        // possibly validation here

        $this->em->persist($user);
        $this->em->flush($user);
    }

    public function addRole($name, $role) {
        if (($newrole = findRoleByRole($role)) != null)
            return $newrole;
        if (($newrole = findRoleByName($name)) != null)
            return $newrole;

        //there is no existing role
        $newrole = new Role();
        $newrole->setName($name);
        $newrole->setRole($role);

        $em->persist($newrole);
        $em->flush();

        return $newrole;
    }

    public function getRoleByName($name) {
        return $this->em->getRepository(self::ENTITY_NAME)->findBy(array('name' => $name));
    }

    public function getRoleByRole($role) {
        return $this->em->getRepository(self::ENTITY_NAME)->findBy(array('role' => $role));
    }

} 
```

我`services.yml`的是：

```
alef.role_service:
    class: Alef\UserBundle\Service\RoleService
    arguments: [%doctrine.orm.entity_manager%] 
```

现在我想在两个地方使用它： `UserController`和`User`实体。我怎样才能让它们进入实体？至于控制器，我想我只需要：

```
$this->get('alef.role_service'); 
```

但是如何在实体内部获得服务？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-04-26T12:25:23.687

你没有。这是一个很常见的问题。实体应该只知道其他实体，而不是实体管理器或其他高级服务。过渡到这种开发方式可能有点挑战，但通常是值得的。

您要做的是在加载用户时加载角色。通常，您最终会得到一个执行此类操作的 UserProvider。您是否阅读过有关安全的部分？这应该是你的起点：

[http://symfony.com/doc/current/book/security.html](http://symfony.com/doc/current/book/security.html)

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2015-09-29T18:54:10.220

首先将服务引入实体如此困难的原因是 Symfony 的明确设计意图是永远不应该在实体内部使用服务。因此，最佳实践答案是重新设计您的应用程序，使其不需要在实体中使用服务。

但是，我发现有*一种*方法可以做到这一点，而不涉及弄乱全局内核。

Doctrine 实体具有生命周期事件，您可以将事件侦听器挂钩，请 参阅[http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/events.html#lifecycle-events](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/events.html#lifecycle-events)在示例中，我将使用 postLoad，它会在创建实体后不久触发。

EventListeners*可以*作为你注入其他服务的服务。

添加到 app/config/config.yml：

```
services:
     example.listener:
           class: Alef\UserBundle\EventListener\ExampleListener
     arguments:
           - '@alef.role_service'
     tags:
           - { name: doctrine.event_listener, event: postLoad } 
```

添加到您的实体：

```
 use Alef\UserBundle\Service\RoleService;

 private $roleService;

 public function setRoleService(RoleService $roleService) {
      $this->roleService = $roleService;
 } 
```

并添加新的 EventListener：

```
namespace Alef\UserBundle\EventListener;

use Doctrine\ORM\Event\LifecycleEventArgs;
use Alef\UserBundle\Service\RoleService;

class ExampleListener
{
     private $roleService;

     public function __construct(RoleService $roleService) {
         $this->roleService = $roleService;
     }

     public function postLoad(LifecycleEventArgs $args)
     {
         $entity = $args->getEntity();
         if(method_exists($entity, 'setRoleService')) {
             $entity->setRoleService($this->roleService);
         }
     }
} 
```

请记住，此解决方案附带一个警告，即这仍然是一种快速而肮脏的方式，实际上您应该考虑以正确的方式重新设计您的应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-08-02T14:36:19.327

感谢[Kai 在](https://stackoverflow.com/a/32851695/724027)上面对问题的回答，但它与 symfony 5.x 不兼容。

准确地说这是一个不好的做法，但在某些特殊情况下需要，比如遗留代码或糟糕的数据库设计（作为模式迁移之前的临时解决方案）

就我而言，我将此代码与邮件程序和翻译器一起使用，如果 Symfony >= 5.3 会引入私有属性的问题，因此这里是 symfony 最新版本的解决方案：

在 config/services.yaml 中：

```
services:
    Alef\UserBundle\EventListener\ExampleListener:
        tags:
           - { name: doctrine.event_listener, event: postLoad } 
```

示例监听器：

```
namespace Alef\UserBundle\EventListener;

use Doctrine\ORM\Event\LifecycleEventArgs;
use Alef\UserBundle\Entity\Role;

class ExampleListener
{

    public function postLoad(LifecycleEventArgs $postLoad): void
    {
        $entity = $postLoad->getEntity();
        if ($entity instanceof User) {
            $repository = ;
            $entity->roleRepository(
                $postLoad->getEntityManager()->getRepository(Role::class)
            );
        }
    }
} 
```

在您的实体中（或者如果您在多个实体中使用它，则在特征中）：

```
 use Alef\UserBundle\Service\RoleService;

    /** @internal bridge for legacy schema */
    public function roleRepository(?RoleRepository $repository = null) {
        static $roleRepository;
        if (null !== $repository) {
            $roleRepository = $repository;
        }
        return $roleRepository;
    }

    public function getRoleByName($name) {
        return $this->roleRepository()->findBy(array('name' => $name));
    } 
```

# configuration - PostgreSQL 允许来自 MAC 地址的连接

> ID：10330717
> 
> 赞同：2
> 
> 时间：2012-04-26T09:30:32.827
> 
> 标签：configuration, configure, mac-address, postgresql-9.1

PostgreSQL 9.1 中是否有配置指令允许通过写入其 MAC 地址而不是将其 IP 地址写入“pg_hba.conf”来允许来自客户端的连接？

例如; 而不是这样做；

```
host    all             all             192.168.2.1/32           trust 
```

我想写这个；

```
host    all             all             00:08:C7:1B:8C:02        trust 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T12:42:25.750

不。

正如[文档](http://www.postgresql.org/docs/9.1/interactive/auth-pg-hba-conf.html)所说：

> 此字段可以包含主机名、IP 地址范围或下面提到的特殊关键字之一。

# regex - 如何使用 sed 或 perl 在流中的字符串上的查找替换正则表达式中打印替换字符串中的匹配计数（第 n 个匹配）？

> ID：10330719
> 
> 赞同：1
> 
> 时间：2012-04-26T09:30:45.470
> 
> 标签：regex, perl, sed

细节：

我正在使用 tail -f 读取传入流中的文件

我可以使用 sed 在流中查找和替换字符/字符串，例如：

```
tail -f a.log | sed 's/'`echo -e "\xnn"`'/'`echo "$(tput setaf 1)|sep|$(tput sgr0)"`'/g' 
```

以上实现的是为分隔符字符串提供了一个清晰的视觉标记（在这种情况下是不可打印的十六进制字符 nn，例如 nn 可能是 05，将其替换为红色（在这种情况下）颜色（通过 tput ) 字符串 |sep|。

所以我得到类似的东西

```
field **|sep|** field **|sep|** field **|sep|** 
```

我想要的是

```
field **|sep#1|** field **|sep#2|** field **|sep#3|** 
```

因此，要求是在替换字符串中将第 n 个匹配标记为这样（|sepn| 其中 n 是遇到的匹配数）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:38:52.077

使用 Perl 动态评估替换的能力来跟踪所做的替换次数：

```
my $str='field **|sep|** field **|sep|** field **|sep|**';
my $str2='saodifuasd|sep|psaoidugfsdoif|sep|sdoiufd';
my $cnt;
$cnt=0; $str=~s/\|sep\|/"|sep#".$cnt++."|"/ge;
$cnt=0; $str2=~s/\|sep\|/"|sep#".$cnt++."|"/ge;
print "$str\n";
print "$str2\n"; 
```

结果：

```
field **|sep#0|** field **|sep#1|** field **|sep#2|**
saodifuasd|sep#0|psaoidugfsdoif|sep#1|sdoiufd 
```

如您所见，您必须在每一行上手动重置分隔符计数器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-27T12:55:08.017

```
 #! /usr/bin/perl
    #sed 's/'`echo -e "\x05"`'/'`echo "$(tput setaf 1)|sep|$(tput sgr0)"`'/g'
    use warnings;
    use strict;
    use Term::ANSIColor;
    use Term::ANSIColor qw(:constants);

    while(<>) {
    my $count=1;
    #s/\x05/"|#".$count++."|"/ge;
    s/\x05/colored("|#".$count++."|", 'RED')/ge;
    print;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T10:08:11.240

检查这是否有帮助，它在 (g)awk 中。

```
gawk -F 'sep' '{ a=1;while (a <= NF) {printf("%d:%s",a,$a); a++}print}' 
```

# sencha-touch - 在 selectfield displayvalue 中添加多个字段（Sencha Touch 2）

> ID：10330722
> 
> 赞同：2
> 
> 时间：2012-04-26T09:31:07.840
> 
> 标签：sencha-touch, sencha-touch-2

我有以下选择字段：

```
{
    xtype: 'selectfield',
    name: 'sourcecurrency',
    label: 'Source Currency',
    valueField: 'name',
    displayField: '{name} - {description}',
    store: 'Countries',
    placeHolder: 'Select your source currency'
}, 
```

数据返回两个字段“名称”和“描述”；我想在选择区域中显示这两个字段，将 displayField 设置为如图所示，但我仍然有'{}'围绕它们。

一定是真的很傻，但想不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T12:51:52.427

没有直接的方法可以在`selectfield's` `displayField`.

因此，您将需要创建一个基于`selectfield`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T21:50:18.820

我知道它很旧，但是为了完整性，还有另一种方法：

在您的模型中创建一个像 DisplayName 这样的字段，并使其成为您想要显示的字段和信息的任何组合。

然后只有 displayField: '{displayName}'

创建自定义字段更有效，但这更容易。仅取决于您需要展示的内容、您需要应用程序的效率以及您希望在解决方案上投入多少时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-18T08:20:11.893

如果它对某人有帮助，您可以直接使用 getTabletPicker 或 getPhonePicker（在 sencha 6 中测试）。

例如，在 getTabletPicker 中，您需要更改的只是行

```
 itemTpl: '<span class="x-list-label">{' + me.getDisplayField() + ':htmlEncode}</span>', 
```

到别的东西

```
 itemTpl : me.getTpl() 
```

所以你的选择字段将是

```
 xtype        : 'selectfield',
        displayField : 'YOURDISPLAY',
        valueField   : 'YOURVALUE',            
        tpl          : new Ext.XTemplate(
                        '<tpl for=".">',
                            '{YOURDISPLAY}',
                            '{YOURDISPLAY2}',
                            '{YOURDISPLAY3}',
                        '</tpl>'
                       ) 
```

# jquery - ajax调用后的JQuery for循环

> ID：10330723
> 
> 赞同：1
> 
> 时间：2012-04-26T09:31:22.153
> 
> 标签：jquery, ajax, image, for-loop, jquery-pagination

我正在尝试循环 ajax 调用成功后返回的数据并将结果添加到[分页插件。](http://tympanus.net/codrops/2009/11/17/jpaginate-a-fancy-jquery-pagination-plugin/)

这是我的代码：

```
 var imagesPerPage = 2, pageNumber = 1;
  var pagesContainer = $('#pagesContainer'),
  imagesInPage = 0,
  divPage = $("#p1");

    $.ajax({
           type: "POST",
           url: "Default.aspx/GetImages",
           data:{},
           contentType: "application/json; charset=utf-8",
           dataType: "json",
           success: function (response) {

             //Here goes my for loop                    

           }
      }); 
```

这是我的 for 循环，我需要从 webmethod 获取图像并将它们循环并添加到分页中。

```
 for (i = 0; i < response.d.length; i++) {
          if (imagesInPage >= imagesPerPage) {
          imagesInPage = 1;
          pageNumber += 1;
          divPage = $('<div/>', { id: "p" + pageNumber }).addClass('pagedemo').hide().appendTo(pagesContainer);
          } else {
          imagesInPage += 1;
          }
} 
```

这是我的分页默认配置：

```
 $("#pagination").paginate({
              count: pageNumber,
              start: 1,
              display: Math.min(7, pageNumber),
              border: true,
              border_color: '#fff',
              text_color: '#fff',
              background_color: 'black',
              border_hover_color: '#ccc',
              text_hover_color: '#000',
              background_hover_color: '#fff',
              images: false,
              mouse: 'press',
              onChange: function (page) {
              $('#paginationdemo ._current').removeClass('_current').hide();
              $('#p' + page).addClass('_current').show();
        }
  }); //pagination 
```

现在我的问题是，当我尝试获取一个图像的响应时，它没有向我显示图像和分页。如果它不止一个，那么它开始向我显示分页和图像。

**截图**：

![在此处输入图像描述](../Images/15a7344a34842dbd0f8272be4e145db8.png)

所以谁能说我哪里错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T09:43:22.570

where are you trying to get the response for one image? If you are trying to do this in your if condition then it will not work for only one response because

imagesInPage >= imagesPerPage

evaluates to false as imagesPerPage = 2 and imagesInPage=0;

also if your response type is json and this does not solve your problem try using

```
$.each(response,function(index,data){
    //check each image here 
      // data.id gives you the id of each json object in the response
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:44:48.887

This is your pagination problem recently i met with the same problem. To fix this you will need a condition. check the length of response. if it is 1 then add some default values and that will work.

# php - 使用 codeigniter 的 Facebook 评论

> ID：10330725
> 
> 赞同：4
> 
> 时间：2012-04-26T09:31:28.653
> 
> 标签：php, facebook, codeigniter

我正在尝试在我的 codeignitor 项目中开发 facebook 评论应用程序，但我遇到了加载评论框等问题，也没有正确显示所有评论，当我使用另一个新的应用程序 codeignitor 时，它工作正常。

我在视图文件中使用此代码

> (function(d, s, id){ var js, fjs = d.getElementsByTagName(s)[0];
> if (d.getElementById(id)) return; js = d.createElement(s); js.id = id ; js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=123456789789652";
> fjs.parentNode.insertBefore(js, fjs); } (document, 'script', 'facebook-jssdk '));

我在控制器文件中使用此代码

> 类 Fb_comments 扩展 CI_Controller { function _construct *()
> { parent::* _construct();
> }
> 
> ```
>  function index()
>   { 
> ```
> 
> $this->load->view('fb_comments'); } }

任何想法和建议都会被采纳

在此先感谢.. bhavik patel

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T12:20:26.633

您缺少实际显示 facebook 评论块的代码：

```
<div class="fb-comments" data-href="http://example.com" data-num-posts="2" data-width="470"></div> 
```

其中[http://example.com](http://example.com)将替换为您在 facebook 代码生成器中提到的站点 url。

[http://developers.facebook.com/docs/reference/plugins/comments/](http://developers.facebook.com/docs/reference/plugins/comments/)

当您按下“获取代码”时，您有 2 个代码要包含在您的视图中，第一个是 JS SDK，第二个是您放置内容的 div。

# jquery - jquery多文件使用

> ID：10330730
> 
> 赞同：1
> 
> 时间：2012-04-26T09:31:39.013
> 
> 标签：jquery

我无法在单个页面中使用多个 jquery 文件。尝试使用 noconflict 但它没有帮助。一个 jquery 用于滑动面板，另一个用于可折叠窗口。

我正在使用以下 jquery 文件。

```
 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T09:35:02.020

有两种选择：

1.  使用适合您的最新版本。

2.  文件的排序，对旧版本的引用必须首先是新版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:35:28.527

使用最新的。现在是：

[http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js)

# emacs - ELisp：如何在“else”块中执行多个表达式？

> ID：10330731
> 
> 赞同：4
> 
> 时间：2012-04-26T09:31:40.947
> 
> 标签：emacs, elisp

使用 ELisp 时，如何在语句`else`块中执行多个表达式？`if`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-04-26T12:17:31.623

您不需要这样做`progn`，因为这已经是默认行为：

`C-h``f` `if` `RET`

> if 是“C 源代码”中的一种特殊形式。
> 
> （如果条件那么其他......）
> 
> 如果 COND 产生非零，则执行 THEN，否则执行 ELSE...
> 返回 THEN 的值或最后一个 ELSE 的值。
> **THEN 必须是一个表达式，但 ELSE... 可以是零个或多个表达式。**
> 如果 COND 产生 nil，并且没有 ELSE，则值为 nil。

重用 sindikat 的例子：

```
(if (> 1 2)
    (message "True")
  (message "False")
  (message "I repeat, completely false")) 
```

当然，`progn`如果您希望计算`THEN`表单中的多个表达式，则可以使用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-04-26T09:38:01.107

[菲尔斯的回答](https://stackoverflow.com/a/10333220/596361)是正确且惯用的。如果您想在 的`else`块中执行多个语句`if`，并且您只关心 Emacs Lisp，请按照他的答案进行。

在 Emacs Lisp 和 Common Lisp 中，当您想按顺序执行多个操作以[产生副作用](http://en.wikipedia.org/wiki/Side_effect_%28computer_science%29)时（例如更改变量、在屏幕上打印某些内容，通常是与函数返回值无关的任何操作），然后返回只有一个表达式，您使用[`progn`](http://www.gnu.org/software/emacs/manual/html_node/elisp/Sequencing.html#index-progn-560), [`prog1`](http://www.gnu.org/software/emacs/manual/html_node/elisp/Sequencing.html#index-prog1-561), 或[`prog2`](http://www.gnu.org/software/emacs/manual/html_node/elisp/Sequencing.html#index-prog2-562)。它们都计算其中的所有表单，但分别只返回最后一个、第一个和第二个表达式的值。

`(progn 1 2 3 4 5)`返回 5，`(prog1 1 2 3 4 5)`返回 1，`(prog2 1 2 3 4 5)`返回 2。这显然是没有用的，因为在`progn`, `prog1`,中评估表单`prog2`的目的是为了产生副作用。因此，以下所有内容都会在[回显区域](http://www.gnu.org/software/emacs/manual/html_node/emacs/Echo-Area.html)（和缓冲区）中打印 string `α`, `β`, `γ`, ，但只会返回其中一个字符串：`δ`[`*Messages*`](http://www.emacswiki.org/emacs/MessagesBuffer)

```
(progn (message "α") (message "β") (message "γ") (message "δ")) ; => "δ"
(prog1 (message "α") (message "β") (message "γ") (message "δ")) ; => "α"
(prog2 (message "α") (message "β") (message "γ") (message "δ")) ; => "β" 
```

所有 3 个函数都存在于 Emacs Lisp 和 Common Lisp 中。但是如果你想返回^(第三)个表达式的值呢？没有`prog3`。结合现有的！以下所有返回`γ`：

```
(progn (message "α") (message "β") (prog1 (message "γ") (message "δ"))) ; => "γ"
(prog1 (progn (message "α") (message "β") (message "γ")) (message "δ")) ; => "γ"
(prog2 (message "α") (progn (message "β") (message "γ")) (message "δ")) ; => "γ"
(prog2 (message "α") (prog2 (message "β") (message "γ") (message "δ"))) ; => "γ" 
```

在 Common Lisp 中将语句组合在一起并仅返回最后一个值 in `if`，您可以：

```
(if t
    (progn (message "ε") (message "ζ"))
    (progn (message "η") (message "θ"))) ; returns ζ
(if nil
    (progn (message "ε") (message "ζ"))
    (progn (message "η") (message "θ"))) ; returns θ 
```

在 Emacs Lisp 中，您仍然必须将语句`then`与`progn`, `prog1`,组合在一起`prog2`，但您`else`不必在块中这样做，因此 phils 的回答。在 Emacs Lisp`(if nil 1 2 3)`中会返回 3，而在 Common Lisp 中会出错`too many parameters for special operator IF`。

*另请参阅*：“ [Emacs Lisp Intro ”中](http://www.gnu.org/software/emacs/emacs-lisp-intro/)[的“8.1.4 'progn' 特殊形式](http://www.gnu.org/software/emacs/emacs-lisp-intro/html_node/progn.html)”部分。

# javascript - 如何显示来自 xtype 的 tpl？

> ID：10330732
> 
> 赞同：0
> 
> 时间：2012-04-26T09:31:57.740
> 
> 标签：javascript, extjs, items

我的 MatchDetail.js 上有这个：

```
items:[{
   xtype: 'matchdetailtpl',
   flex: 1
}, 
```

这在我的 MatchDetailTpl.js 上：

```
tpl:new Ext.XTemplate([
   '<tpl for=".">',
      '<div>',
         '<div><h1>{firstName} {lastName}</h1> from {league} - <i>{division}</i></div>',
      '</div>',
   '</tpl>',
].join('')) 
```

如果我将 tpl 放在我的 MatchDetail.js 配置中：{} 它会正确显示，但是一旦我像上面的示例那样构建它。我得到的只是一张空白的“卡片”。

应该如何处理以使 tpl 出现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T19:10:58.717

“xtype”将创建一个具有该别名的类的实例。我假设该类是 MathDetailTpl.js 的其余内容所包含的内容（您只向我们展示了一个配置）。

假设您的 MathDetailTpl 类确实是一个 Ext.Component，您可能只需要提供`data`给该类的实例以便`tpl`渲染。您也可以尝试使用`renderTpl`and `renderData`。

发布 MathDetailTpl.js 的内容，或许还有更多关于您如何在`items`第一个代码块的数组中使用它以获得更多帮助。

*更新*

根据您的评论，您正在尝试使用带有 XTemplate 的集中式存储。您正在寻找的神奇粘合剂是 Ext.DataView（或 Ext 4 中的 Ext.view.View）。

```
Ext.define('MatchDetail', {
    extend: 'Ext.view.View',
    alias: 'widget.matchDetail',

    itemSelector: 'div.match-detail',
    tpl:new Ext.XTemplate([
       '<tpl for=".">',
          '<div class="match-detail">',
             '<div><h1>{firstName} {lastName}</h1> from {league} - <i>{division}</i></div>',
          '</div>',
       '</tpl>',
    ].join(''))
}); 
```

然后，您应该能够：

```
...
items: [{
    xtype: 'matchDetail',
    store: myCentralizedStore
}] 
... 
```

DataView 需要该`itemSelector`属性，这就是为什么我为模板中的每个项目在 div 中添加一个类的原因。

# json - JSON.parse() 静默失败

> ID：10330737
> 
> 赞同：1
> 
> 时间：2012-04-26T09:32:28.860
> 
> 标签：json, parsing, jqplot

我正在开发一个 Windows 桌面应用程序，它包含一个 System::Windows::Forms::WebBrowser 类型的对象。该应用程序处理一些性能数据并显示带有各种图形（直方图、饼图等）的 HTML 页面。

它的工作原理如下：

*   应用程序在本地临时路径上生成一个 HTML 文件（例如，.../local/path/myfile.html）
*   应用程序的 WebBrowser 对象导航到生成的文件：

    webBrowser1->Navigate(".../local/path/myfile.html")

*   jQuery 和其他一些插件（例如，jqPlot）用于创建各种图形，myfile.html 在应用程序中呈现

**myfile.html 包含一段代码：**

```
<div id="frame-time-histograms">
    <div id="frame-time-histogram-1">
        <div id="frame-time-histogram-1-target-plot" class="histogram-target" style="height:250px; width:900px;"></div>
        <div id="frame-time-histogram-1-controller-plot" class="histogram-controller" style="height:100px; width:900px;"></div>
        <script id="frame-time-histogram-1-data" class="histogram-data" type="text/plain">
            [{"type" : "Type 1", "shortest" : 12, "longest" : 74}, [[0, 0], [1, 12.632], [2, 16.619], [3, 16.592], [4, 16.664], [5, 16.586]]]
        </script>
    </div>
    <div id="frame-time-histogram-2">
        <div id="frame-time-histogram-2-target-plot" class="histogram-target" style="height:250px; width:900px;"></div>
        <div id="frame-time-histogram-2-controller-plot" class="histogram-controller" style="height:100px; width:900px;"></div>
        <script id="frame-time-histogram-2-data" class="histogram-data" type="text/plain">
            [{"type" : "Type 2", "shortest" : 24, "longest" : 19}, [[0, 0], [1, 20.145], [2, 20.091], [3, 20.301], [4, 20.109], [5, 20.087]]]
        </script>
    </div>
</div> 
```

注意：这里我使用脚本标签作为直方图的数据容器。

**我的 JavaScript 文件包含一段代码：**

```
var histograms = $('div#frame-time-histograms');
histograms.children().each(function(index) {
    var histogramTargetId = $(this).find('div.histogram-target').attr('id');
    var histogramControllerId = $(this).find('div.histogram-controller').attr('id');

    var histogramData = JSON.parse($(this).find('script.histogram-data').html()); 
```

然而 JSON.parse() 似乎没有做任何事情。我在此行之前和之后添加了 alert("hello") ，但只执行了第一个。

如果我转到临时路径并双击 myfile.html，JSON.parse() 工作正常。我可以在我的网络浏览器（Chrome、FF 和 IE）中查看所有图表。

有人能告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T18:12:09.987

我刚刚注意到 jqPlot 提供了它的 json2.js 文件版本：

```
...\plugins\jqplot.json2.js 
```

为了解决我遇到的问题，我在 myfile.html 中包含了这个 js 文件并进行了更改

```
JSON.parse($(this).find('script.histogram-data').html()); 
```

到

```
$.jqplot.JSON.parse($(this).find('script.histogram-data').html()); 
```

# c# - MVVM SelectedItem.Property OnChanged

> ID：10330738
> 
> 赞同：2
> 
> 时间：2012-04-26T09:32:31.310
> 
> 标签：c#, wpf, xaml, mvvm

我是 MVVM 的新手，我被卡住了......

我在 MainWindow 中有一个 ListBox。ListBox 包含由 DataTemplates 显示的 WhatEverViewModel 类型的项目。用户可以与这些项目进行交互，并且 WhatEverViewModel 有几个 DependencyProperties，它们可能会在交互过程中发生变化。

我的问题是：如何优雅地（在 MainWindowViewModel 中）对当前选择的 WhatEverViewModel 的 DependencyProperties 的变化做出反应。我个人会在 WhatEverViewModel 中实现一些事件，当 ListBox 的 SelectedItem 发生变化时，我会附加到当前选择的 WhatEverViewModel 的事件上。但我认为在 MVVM 中可能有更优雅的方法来解决这个问题......

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:54:40.593

viewmodel 之间的通信可以通过多种方式完成。

*   [像MVVM Light](http://www.galasoft.ch/mvvm/)的一种形式的 Messenger/Mediator
*   像[PRISM这样的事件](http://msdn.microsoft.com/en-us/library/ff921122%28v=pandp.20%29.aspx)
*   或者简单地使用 harcoupling 并订阅来自 mainviewmodel 中 WhatEverViewModel 的事件。

顺便说一句，为什么在你的视图模型中使用 DependencyProperties？使用 INotifyPropertyChanged 的​​简单属性是可行的方法。

还有一件事。**为什么要对 SelectedViewmodel 中的更改做出反应**（或者更好地使用所选视图模型来实现您想要实现的目标。）？如果您只想在视图中显示一些信息，只需将 SelectedViewmodel 绑定到它。您应该以这种方式指定您的问题。

编辑

> WhatEverViewModel 有一个列表，该列表也绑定到列表框（在数据模板中），并且根据我在 WhatEverViewModel 中选择的内容，我想在 MainViewModel 中显示某种“配置器”。– JensPfister1 1 小时前

为什么不简单地将 SelectedWhatEverViewmodel.SelectedListEntryProperty 绑定到您的配置器视图？你可以发布一些代码吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T09:44:50.643

Make `CurrentWhatEver` a property of your `MainWindowViewModel` and bind the `Listbox.SelectedItem` property on it. This way, `MainWindowViewModel` knows when the selected WhatEver changes and can register/unregister to events it's interested in.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T09:43:40.887

You should implement the [`INotifyPropertyChanged`](http://msdn.microsoft.com/en-us/library/System.ComponentModel.INotifyPropertyChanged.aspx) interface on each of your ViewModels. Then when one of your properties changes call the `PropertyChanged` event, your views will get notifications that the property has changed (as long as your Binding is correct). If a property is a list or collection make sure that the list is based off an [`INotifyCollectionChanged`](http://msdn.microsoft.com/en-us/library/system.collections.specialized.inotifycollectionchanged.aspx).

Add a property for the Selected WhatEverViewModel to your MainWindowViewModel, bind that in your ListBox. Then in your MainWindowViewModel you can hook on to the property changes of your Selected WhatEverViewModel.

For more guidance read:

*   [WPF MVVM INotifyPropertyChanged Implementation - Model or ViewModel](https://stackoverflow.com/questions/5285377/wpf-mvvm-inotifypropertychanged-implementation-model-or-viewmodel)
*   [http://blogs.msdn.com/b/soultech/archive/2011/06/07/mvvm-tips-when-implementing-inotifypropertychanged.aspx](http://blogs.msdn.com/b/soultech/archive/2011/06/07/mvvm-tips-when-implementing-inotifypropertychanged.aspx)

# netbeans - 如何在 NetBeans 中进行 HTML 注释

> ID：10330739
> 
> 赞同：6
> 
> 时间：2012-04-26T09:32:37.077
> 
> 标签：netbeans, netbeans-7, netbeans-plugins

在 NetBeans 中，对于 javascript 和 php 文件/代码，您只需选择它们然后单击注释按钮即可轻松注释代码行，如图所示。

![在此处输入图像描述](../Images/70d1d9f2ef8b0432182114de624a0d12.png)

是否可以对 HTML 代码执行相同的操作？如果是，如何？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-04-26T12:31:39.367

要注释掉 html 代码（和 javascript/php 代码），请选择要注释掉的代码部分并使用`Ctrl`+ `Shift`+ `C`（对于 Mac 为 + +）键盘快捷`Cmd`键`Shift`。`C`对于 html 代码，这会`<!-- -->`在您的代码周围添加标签。

要取消注释，请选择注释代码并使用相同的键盘快捷键。这将删除评论标签。

# vba - 安全更新后无法加载 MSCOMCTL.ocx

> ID：10330740
> 
> 赞同：2
> 
> 时间：2012-04-26T09:32:47.380
> 
> 标签：vba

几天前，我的 VBA 应用程序的一些用户开始向我报告，宏无法正常工作。他们收到一条消息：

**“无法加载对象，因为它在这台机器上不可用。”**

在我的研究中，我发现问题可能是由安全更新引起的：

[http://blogs.msdn.com/b/vsod/archive/2009/06/05/visual-basic-6-controls-stop-working-after-security-advisory-960715.aspx](http://blogs.msdn.com/b/vsod/archive/2009/06/05/visual-basic-6-controls-stop-working-after-security-advisory-960715.aspx)

[http://dutchgemini.wordpress.com/2012/04/17/excel-vba-error-could-not-load-an-object-because-it-is-not-available-on-this-machine/](http://dutchgemini.wordpress.com/2012/04/17/excel-vba-error-could-not-load-an-object-because-it-is-not-available-on-this-machine/)

[http://support.microsoft.com/kb/2664258](http://support.microsoft.com/kb/2664258)

我试图应用建议的解决方案。在某些计算机上，只需删除 exd 文件并注册 mscomctl.ocx 就足够了。

在大多数计算机上，没有任何帮助。我真的不知道该怎么办，有几十个用户无法工作！

出现问题并且不会消失的计算机是：

*   Windows XP、Office 2003 SP3

*   KB2653956 更新是最后安装的

*   当我试图安装这个：[http](http://technet.microsoft.com/pl-pl/security/bulletin/ms12-027) ://technet.microsoft.com/pl-pl/security/bulletin/ms12-027 （第一个列出）我收到一个错误：

**“在您的系统上找不到预期的产品版本”**

*   删除所有 *.exd 文件并注册 mscomctl.ocx 无济于事

# php - 如何在没有 GET 和 POST 方法的情况下提交数据。？

> ID：10330741
> 
> 赞同：-2
> 
> 时间：2012-04-26T09:32:51.840
> 
> 标签：php, javascript, client-side, server-side

通过使用 post 方法，我看不到 url 中传递的值是什么，除了 GET 之外还有其他方法可以实现这一点，我听说有一种方法可以在脚本中使用编码。有人对此有想法吗？提前致谢..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:36:45.093

> 通过使用 post 方法，我看不到 url 中传递的值是什么

是的你可以。URL 中没有传递任何值，您可以看到它们全部为零！;)

更严重的是，您可以使用浏览器调试工具的网络选项卡或使用诸如 Charles Proxy 之类的代理服务器来查看正文中传递了哪些数据。

您不应考虑更改用于数据检查的 HTTP 方法。这只是意味着您要么最终在生产中使用了不合适的方法，要么当您改回正确的方法时，您冒着破坏事情的风险。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:37:41.110

一种方法是您可以尝试使用 javascript（jquery 等）从表单中的控制框中捕获所有值，然后在视图上呈现为 url 链接。

# sdk - 寻找 Livescribe SDK，和/或破解 Pulse Smartpen 的方法

> ID：10330742
> 
> 赞同：4
> 
> 时间：2012-04-26T09:32:56.123
> 
> 标签：sdk, livescribe

我正在寻找 Livescribe SDK 的旧副本。Livescribe 已经停止了他们的开发者计划，我已经广泛搜索了它，只发现其他人要求相同： [http ://www.kellbot.com/2011/06/livescribe-developer-community-huge-f-你/](http://www.kellbot.com/2011/06/livescribe-developer-community-huge-f-you/)

我正在设想可以通过额外功能（蓝牙/wifi）扩展 smartpen 的新方法，以用于额外的场景（它可以自动完成您的费用，或者与音乐人员/五线谱纸一起工作）。

我正在尝试尽可能接近工作原型，并且对使用 Anoto dot paper 或任何其他 smartpen 制造商进行开发的任何人感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-26T07:23:11.933

我还没有找到 Livescribe 的 SDK，但您可能想看看这个链接：[livescribe.custhelp.com/app/answers/detail/a_id/1/kw/sdk](https://livescribe.custhelp.com/app/answers/detail/a_id/1/kw/sdk)

> Livescribe 为 Apple iOS 7（或更高版本）开发了一个 SDK，使 Livescribe 3 智能笔能够使用 Bluetooth® LE（低能耗）4.0+ 直接连接到平板电脑或智能手机。借助 Livescribe 3 SDK，特定合作伙伴开发人员将能够快速轻松地添加对 Livescribe 3 智能笔的支持，并增强他们的笔记、绘图、注释和协作应用程序。有关在开发人员应用程序中工作的 SDK 示例，请参阅他们在 Outline/Outline+ 上的博客文章。如果您想参与 Livescribe SDK，请发送电子邮件至 developer@livescribe.com。

# sql - 在选择子句中使用大小写？

> ID：10330746
> 
> 赞同：1
> 
> 时间：2012-04-26T09:33:06.810
> 
> 标签：sql, db2

我想使用 CASE 语句有条件地检查参数，`if parameter is an empty string I want to return Nil if not then string 'test'`但这不起作用。我也不想使用 COALESCE

```
select TEST=CASE '' WHEN '' THEN 'Nil' ELSE 'Test' END,current_timestamp from sysibm.sysdummy1; 
```

我收到一个错误

> SQL 状态：42601 供应商代码：-104 消息：[SQL0104] 令牌 = 无效。有效令牌： + - AS 。原因 。. . . . : 在 token = 处检测到语法错误。令牌 = 不是有效令牌。有效令牌的部分列表是 + - AS 。此列表假定该语句在令牌之前是正确的。错误可能出现在语句的前面，但语句的语法在此之前似乎是有效的。恢复 。. . ：执行以下一项或多项操作，然后再次尝试请求： -- 验证令牌 = 区域中的 SQL 语句。更正陈述。错误可能是缺少逗号或引号，可能是拼写错误的单词，也可能与从句的顺序有关。-- 如果错误标记是 ，请更正 SQL 语句，因为它没有以有效子句结尾。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:36:45.107

```
select CASE '' WHEN '' THEN 'Nil' ELSE 'Test' END as TEST,current_timestamp from sysibm.sysdummy1; 
```

用预期的列替换*一些东西。*

* * *

有关更多信息，请查看[此](http://publib.boulder.ibm.com/infocenter/dzichelp/v2r2/index.jsp?topic=/com.ibm.db2.doc.sqlref/psmcse.htm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:37:55.157

您的案例语法不正确，正确的是，

```
select TEST=CASE <fieldname> WHEN '' THEN 'Nil' ELSE 'Test' END,current_timestamp from sysibm.sysdummy1; 
```

# ruby-on-rails - instagram-ruby-gem 未定义方法“query_values”

> ID：10330747
> 
> 赞同：2
> 
> 时间：2012-04-26T09:33:08.387
> 
> 标签：ruby-on-rails, instagram

嗨，我一直在做一个项目，该项目可以抓取用户的 instagram 照片并让他们下载。要进行身份验证，我使用名为[instagram-ruby-gem 的 gem](https://github.com/Instagram/instagram-ruby-gem) ，它是 instagram 的官方 ruby​​ gem

```
def instagram_callback
  response = Instagram.get_access_token(params[:code], :redirect_uri => "http://0.0.0.0:3000/oauth/callback")
  client = Instagram.client(:access_token => response.access_token)
  user = client.user
  raise client.user_recent_media.inspect
end

def instagram_login
  return redirect_to Instagram.authorize_url(:redirect_uri => "http://0.0.0.0:3000/oauth/callback")
end 
```

调用 instagram 回调方法时会弹出错误

#URI::HTTPS:0x0000010441f028 的未定义方法“query_values”，它显示了该行

```
 response = Instagram.get_access_token(params[:code], :redirect_uri => "http://0.0.0.0:3000/oauth/callback") 
```

[我想这可能不是一个 gem 错误，但我遇到了问题，在git-hub 页面](https://github.com/Instagram/instagram-ruby-gem/issues/33)中有一个关于它的问题，有人对此有任何解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T17:05:00.950

[我在github page](https://github.com/Instagram/instagram-ruby-gem/issues/33)上评论了解决方法。请尝试使用法拉第版本“0.7.6”。

# java - 使用没有 WSDL 的 java 的 Soap 客户端服务 - 如何？

> ID：10330752
> 
> 赞同：3
> 
> 时间：2012-04-26T09:33:18.597
> 
> 标签：java, web-services, soap, wsdl

我使用 jdk 附带的 JAX-WS 来创建肥皂客户端。现在，服务提供者没有公开 wsdl。如果我知道提供的服务，如何在没有 wsdl 的情况下创建肥皂客户端？

编辑：我可以自由使用任何肥皂 api/工具，不限于 JAX-WS。

Edit2：这是点击服务 url 时显示的消息。此服务的元数据发布当前已禁用。并建议配置服务行为配置。我了解该服务是在 .Net 中完成的。但是如何使用提供的服务行为相关细节来访问 Java 中的服务呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:46:59.137

您可以直接使用 HttpClient，但您必须手动编码您发送的每条 xml 消息并解析您收到的每条消息。您还可以手动创建与您的 xml 匹配的对象并使用 jaxb 来编组/解组消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:49:21.677

您可以创建一个扩展的客户端服务提供程序`javax.xml.ws.Service`，然后覆盖服务构造函数，接受您当前手头的远程服务的 URL。

```
public class Foo extends Service
{ 
  ... 

  public Foo(URL wsdlLocation)
  {
    super(wsdlLocation, SERVICE);
  }
} 
```

然后在构建 Provider Binding 时，将 URL 显式传递给服务接口。

```
Foo service = new Foo(url);
BindingProvider binding = (BindingProvider)service; 
```

# vim - 如何解决这些数字问题？

> ID：10330760
> 
> 赞同：2
> 
> 时间：2012-04-26T09:33:35.203
> 
> 标签：vim, floating-point, numbers, integer, exponential

我仍然在 Vim 中遇到数字问题：

体育

```
let a = 1.02 | let b = '10000000' | let total = a*b | echo total --> 1.02e7 
```

我想避免使用指数。我怎样才能有输出 10200000 ？

```
let a = 4000000000 | let b = '1' | let total = a+b | echo total  --> -294967295 
```

为什么这会给出错误的输出？

肿瘤坏死因子

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:46:52.477

```
:echo printf("%.0f", 4000000000.0 + 1.0) 
```

注意事项：

*   您正在使用 string->int 转换来进行算术运算，这通常不是一件好事。
*   整数是机器字大小的，所以大数字会溢出，尤其是在 32 位机器上。
*   浮点数格式通常使用 %g，如果要控制精度，请使用 printf。
*   如果您要处理大量数字，请使用浮点数，尽管如果您期望精确的精度，那真的不会很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T09:53:35.683

溢出很容易被看到

```
:let a = 4000000000 | echo a --> -294967296 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T09:43:51.947

使用`printf`：

```
let a = 1.02 | let b = '10000000' | let total = a*b | echo printf( "%.f", total) 
```

输出：

```
10200000 
```

# c++ - 在头文件中定义所有库是不好的做法吗？

> ID：10330761
> 
> 赞同：4
> 
> 时间：2012-04-26T09:33:38.720
> 
> 标签：c++, libraries

如果我有一段代码，说`main.cpp`需要定义的类然后在文件中`myheader.h`包含所有所需的库/头文件是不好的做法吗？`main.cpp``myheader.h`

如果是这样，为什么？考虑到`main.cpp`没有`myheader.h`任何办法是行不通的。

对不起，如果这个问题有点简单 - 我只是不确定分隔多个文件的常见做法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-26T09:38:10.053

通常，您应该只包含当前文件中需要的那些内容。好的，所以无论如何都要`main.cpp`使用`myheader.h`，那么为什么不包括，比如说，`<iostream>`以及其他`myheader.h`需要的标题`main.cpp`？因为明天您将要包含哪些不需要或包含`myheader.h`在中的其他头文件，这是多余的并且会增加编译时间。因此，无论在 中需要什么，都包括在 中。`myOthercpp.cpp``<iostream>``myheader.h``main.cpp``main.cpp`

这种模式有一个例外，称为[预编译标头](http://en.wikipedia.org/wiki/Precompiled_header)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:54:10.980

有例外，但通常最好不要在标题中包含标题。

## 编译速度

例如，如果你有一个大图书馆 biglibrary.cpp / biglibrary.h

一个依赖大库做一些工作的类 myclass.h / myclass.cpp

还有一些依赖于 MyClass 的代码 - main.cpp

* * *

main.cpp 不依赖于 biglibrary。它不需要知道任何事情。它只取决于 myclass.h。如果 myclass.h 包含 biglibrary.h 则编译 main.cpp 必须解析 biglibrary.h 以及减慢编译速度。

## 循环依赖

另一个问题是循环依赖。假设您有 2 个类 A、B。A 引用 B 和 B 引用 A

你是在 bh 中包含 ah 还是在 ah 中包含 bh

一个更简洁的解决方案是只在源文件中包含您需要的标头。

如果标头中的代码需要对不存在的类的引用，请使用如下所示的前向减速：[http ://www.eventhelix.com/realtimemantra/headerfileincludepatterns.htm](http://www.eventhelix.com/realtimemantra/headerfileincludepatterns.htm)

# php - 使用正则表达式将图像包装在标签中

> ID：10330763
> 
> 赞同：1
> 
> 时间：2012-04-26T09:33:42.857
> 
> 标签：php, html, regex

我一直在使用正则表达式将我的图像包装在 < a > 标签中并更改它们的路径等。我知道使用 dom 会更好，已经阅读了很多关于包装的主题，但我无法理解如何去做。

这就是我正在使用的：

```
$comments = (preg_replace('@(<img.+src=[\'"]/uploads/userdirs/admin)(?:.*?/)(.+?)\.(.+?)([\'"].*?>)@i', '<a class="gallery" rel="'.$pagelink.'" href=/uploads/userdirs/'.$who.'/$2.$3>$1/mcith/mcith_$2.$3$4</a>', $comments)); 
```

它成功地将每个图像包装在我想要的标签中。但前提是提供的字符串 ($comments) 具有正确的标记。

```
<p><img src="/uploads/userdirs/admin/1160501362291.png" alt="" width="1280" height="960" /></p>
<p><img src="/uploads/userdirs/admin/100_Bullets_68_1280x1024.jpg" alt="" width="1280" height="1024" /></p> 
```

当这样呈现时，它可以工作。我正在使用 tinymce，所以当我使用 enter 进行换行时，它会包含在 < p > 中。但是当我不这样做时，当我一个接一个地插入图像时，HTML 看起来像这样，它不会：

```
<p><img src="/uploads/userdirs/admin/1160501362291.png" alt="" width="1280" height="960" /><img src="/uploads/userdirs/admin/100_Bullets_68_1280x1024.jpg" alt="" width="1280" height="1024" /></p> 
```

相反，它会将这 2 个图像包装在同一个 <a> 标记中。使输出看起来像这样：

```
<p><a class="gallery" rel="test" href="/uploads/userdirs/admin/100_Bullets_68_1280x1024.jpg">
<img src="/uploads/userdirs/admin/1160501362291.png" alt="" width="1280" height="960">
<img src="/uploads/userdirs/admin/mcith/mcith_100_Bullets_68_1280x1024.jpg" alt="" width="1280" height="1024">
</a></p> 
```

这是错误的。我想要的输出是这样的：

```
<p><a class="gallery" rel="test2" href="/uploads/userdirs/admin/100_Bullets_68_1280x1024.jpg"><img src="/uploads/userdirs/admin/mcith/mcith_100_Bullets_68_1280x1024.jpg" alt="" width="1280" height="1024"></a></p>
<p><a class="gallery" rel="test2" href="/uploads/userdirs/admin/1154686260226.jpg"><img src="/uploads/userdirs/admin/mcith/mcith_1154686260226.jpg" alt="" width="1280" height="800"></a></p> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T10:21:09.487

我遗漏了一些细节，但这里是我使用 DOMDocument 的方法：

```
$s = <<<EOM
<p><img src="/uploads/userdirs/admin/1160501362291.png" alt="" width="1280" height="960" /></p>
<p><img src="/uploads/userdirs/admin/100_Bullets_68_1280x1024.jpg" alt="" width="1280" height="1024" /></p>
EOM;

$d = new DOMDocument;
$d->loadHTML($s);

foreach ($d->getElementsByTagName('img') as $img) {
    $img_src = $img->attributes->getNamedItem('src')->nodeValue;
    if (0 === strncasecmp($img_src, '/uploads/userdirs/admin', 23)) {
        $a = $d->createElement('a');

        $a->setAttribute('class', 'gallery');
        $a->setAttribute('rel', 'whatever');
        $a->setAttribute('href', '/uploads/userdirs/username/' . $img_src);

        // disconnect image tag from parent
        $img->parentNode->replaceChild($a, $img);

        // and move to anchor
        $a->appendChild($img);
    }
}

echo $d->saveHTML(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:44:38.553

您应该使用 更改`.*`正则表达式`[^>]*`。后者的意思是：任何字符都期望比`>`. 因为正则表达式得到尽可能长的匹配。如果没有这个附加条件，这最终会得到两个`<img>`'s 匹配。

# c - C程序中的ASM代码导致分段错误

> ID：10330767
> 
> 赞同：2
> 
> 时间：2012-04-26T09:34:02.997
> 
> 标签：c, linux, gcc, x86, inline-assembly

我在一个小程序中包含了一些示例 ASM 代码来进行测试。

我的程序是：

```
#include <stdio.h>

static inline
unsigned char inb (int port) {
    unsigned char data;
    asm volatile("inb %w1,%0" : "=a" (data) : "d" (port));
    return data;
}

int main()
{
    printf("hello world %d\n", inb(22));
    return 0;
} 
```

当我运行该程序时，它在执行 ASM 代码时因分段错误而崩溃。有人能告诉我这个小程序有什么问题吗？非常感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-26T09:52:37.243

[`ioperm`](http://www.kernel.org/doc/man-pages/online/pages/man2/ioperm.2.html)在允许使用端口 I/O 之前，您需要使用。另外，请注意内核已经提供了[`inb`和`outb`函数](http://www.kernel.org/doc/man-pages/online/pages/man2/outb.2.html)。

> 使用 ioperm(2) 或 iopl(2) 来告诉内核允许用户空间应用程序访问有问题的 I/O 端口。不这样做将导致应用程序收到分段错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T09:49:26.383

如果您的操作系统是 Windows 或 Linux，您的程序很可能被终止，因为操作系统不允许常规应用程序访问 I/O 端口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T10:04:45.797

你的语法是绝对正确的。只需在系统上找到并使用有效或未使用的端口即可。

# apache2 - 符号链接 documentroot 时 NFS 分区出现 Apache 404 错误

> ID：10330772
> 
> 赞同：0
> 
> 时间：2012-04-26T09:34:14.580
> 
> 标签：apache2, symlink, nfs, performance

我有 apache 虚拟主机：

```
<VirtualHost IP_WAN:80>
  ServerName test.localnet
  DocumentRoot /srv/http/localnet/test/trunk/docroot
  <Directory /srv/http/localnet/test/trunk/docroot>
    Options Indexes
  </Directory>
</VirtualHost> 
```

分区 /srv 是 NFS3 挂载的文件系统：

```
172.16.0.2:/srv /srv nfs    nodev 0 0 
```

在服务器端，它通过以下方式导出：

```
/srv    172.16.0.0/255.255.255.240(rw,sync,no_subtree_check,no_root_squash) 
```

目录 /srv/http/localnet/test/trunk 是到 /srv/http/localnet/test/exports/trunk-v2 的绝对符号链接

在 /srv/http/localnet/test/exports 我导出了 SVN 树（trunk-v1、trunk-v2、trunk-v3）

当我向 apache 询问[http://test.localnet](http://test.localnet)时，它提供 200 OK 并从 /srv/http/localnet/test/exports/trunk-v2/docroot 索引

但：

如果我删除符号链接 /srv/http/localnet/test/trunk 并创建一个新版本到另一个版本（ln -s /srv/http/localnet/test/exports/trunk-v3 /srv/http/localnet/test/trunk ），apache给我404 Not Found。大约需要几秒钟/分钟，然后一切都会恢复正常。

如果我在这种情况下执行 ls -la /srv/http/localnet/test/trunk/ ，它会立即恢复正常。我认为 NFS 缓存存在一些问题，但我无法找到问题发生的确切位置以及如何防止它。符号链接占用与前一个相同的 inode，两个目标（旧的和新的）都存在。

在服务器端，我以这种方式安装了 /srv 分区：

```
/dev/xvda7 on /srv type xfs (rw,nosuid,nodev) 
```

我也使用这个参数：

```
echo 262144 >/proc/sys/net/core/rmem_max
echo 262144 >/proc/sys/net/core/rmem_default
echo 262144 >/proc/sys/net/core/wmem_max
echo 262144 >/proc/sys/net/core/wmem_default
echo noop >/sys/block/xvda7/queue/scheduler
echo 0 >/sys/block/xvda7/queue/read_ahead_kb 
```

我也在尝试将网络接口的 MTU 调到 9000，但没有成功。

有谁知道，有什么问题吗？为什么 apache 在“手动”刷新目录结构（ls）之前找不到符号链接？非常感谢

翁德拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-27T12:21:11.717

解决方案似乎是：http: [//publib.boulder.ibm.com/httpserv/manual70/mod/core.html#enablemmap](http://publib.boulder.ibm.com/httpserv/manual70/mod/core.html#enablemmap)

“使用 NFS 挂载的 DocumentRoot，如果在 httpd 进行内存映射时删除或截断文件，则 httpd 可能会因分段错误而崩溃”

这正是删除页面路径中的符号链接时的情况。希望它可以帮助其他人:-)

# php - 带有 [tags] 的 PHP 通讯脚本

> ID：10330773
> 
> 赞同：0
> 
> 时间：2012-04-26T09:34:19.040
> 
> 标签：php, newsletter

我目前正在开发一个 PHP 通讯系统。我可以快速向不同的客户发送大量电子邮件。

好吧，我想知道如何添加`[tags]`文本区域。我会将标签`[name]`添加到我的消息中，并且它旨在使每封电子邮件的名称等于收件人的名称。

有没有人知道这是怎么做到的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:39:01.563

这个问题有点奇怪，我不太确定问题是什么，但这可以解决问题。显然，您可以做很多不同的事情，但从这里开始，逐步向上。

```
function getMyNewsletter($tags){
    $newsletter = "Hello {$tags['name']}, I hope you liked your {$tags['whattheybought']}. please buy more of my stuff!";
    return $newsletter;
}

$tags = $user->getTagsFromSomewhere();
$mailbody = getMyNewsletter($tags);
yourMailer("SubjectGoesHere",$mailbody,$OtherOptions); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:41:39.870

当您从数据库中获取消息或模板并发送电子邮件时，您可以使用以下内容：

```
 $message = 'Your HTML Message or Text with your tags like [name]';

 // Replaces the tag [name] with the receiver name from the database 
 $send_message = str_replace('[name]', $fetch['Name'], $message); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T11:33:59.437

```
<head>
    <script type="text/javascript">
        function ModifySelection () {
            var textarea = document.getElementById("myArea");
            if ('selectionStart' in textarea) {
                    // check whether some text is selected in the textarea
                if (textarea.selectionStart != textarea.selectionEnd) {
                    var newText = textarea.value.substring (0, textarea.selectionStart) + 
                        "[start]" + textarea.value.substring  (textarea.selectionStart, textarea.selectionEnd) + "[end]" +
                        textarea.value.substring (textarea.selectionEnd);
                    textarea.value = newText;
                }
            }
            else {  // Internet Explorer before version 9
                    // create a range from the current selection
                var textRange = document.selection.createRange ();
                    // check whether the selection is within the textarea
                var rangeParent = textRange.parentElement ();
                if (rangeParent === textarea) {
                    textRange.text = "[start]" + textRange.text + "[end]";
                }
            }
        }
    </script>
</head>
<body>
    <textarea id="myArea" cols="30" spellcheck="false">Select some text within this field.</textarea>
    <button onclick="ModifySelection ()">Modify the current selection</button>
</body> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T10:01:58.123

我很下定决心：

第 1 页：

```
<table>
       <tr>
           <td>
               <textarea rows="11" cols="70" name="message" id="message" placeholder="your message"></textarea>
           </td>
       </tr>
       <tr>
           <td>
              <script type="text/javascript">
              <!--
                 document.write('<span id="var1" class="insert">[name]</span>, <span id="var2" class="insert">[surnaam]</span>');
              // -->
              </script>
           </td>
       </tr>
</table> 
```

第2页：

```
 <?php
 $message = $_POST['c_email_message'];
 $mes = $message;
 $mes = str_replace('[voornaam]',$userOb->c_user_name,$mes);                                                                                $mes = str_replace('[achternaam]',$userOb->c_user_surname,$mes);                                                                                

$html_inhoud = '';
$html_inhoud = '
   <table>
       <tr>
           <td>' . htmlentities($mes) . '</td>
       </tr>
   </table>
 '; 
```

# javascript - 对象不支持 IE 中的属性或方法“indexOf”

> ID：10330781
> 
> 赞同：0
> 
> 时间：2012-04-26T09:35:03.153
> 
> 标签：javascript, internet-explorer, three.js

> **可能重复：**
> [如何在 IE 浏览器的 JavaScript 中修复数组 indexOf()](https://stackoverflow.com/questions/1744310/how-to-fix-array-indexof-in-javascript-for-ie-browsers)

我正在使用three.js，当我将相机添加到场景时，它会警告错误

```
Object doesn't support property or method 'indexOf' 
```

我的代码是

```
<script src="build/Three.js"></script>
<script>
        var container;
        var camera, scene, renderer, objects;
        var particleLight, pointLight,theta = 45;
        var materials,k=0;

        init();
        animate();

        function init()
        {
            container = document.createElement('div');
            document.body.appendChild(container);

            camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 2000 );
            camera.position.set( 0, 200, 800 );

            scene = new THREE.Scene();
            scene.add(camera);
         }
</script> 
```

在 Three.js 文件中使用 indexOf 函数，代码如下

```
add:function(a){if(a===this)console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");else if(-1===this.children.indexOf(a)){void 0!==a.parent&&a.parent.remove(a);a.parent=this;this.children.push(a);for(var b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof THREE.Scene&&b.__addObject(a)}} 
```

# php - PHP 数组，输出，仅在 type = 'image/jpeg' 时输出

> ID：10330788
> 
> 赞同：0
> 
> 时间：2012-04-26T09:35:57.590
> 
> 标签：php, arrays, if-statement

我有 php 数组 ($_FILE[fails]) 我只需要输出类型为“image/jpeg”或“image/jpg”的 thous 名称...

```
array(5) { ["name"]=> array(4) { [0]=> string(16) "3970867_460s.jpg" [1]=> string(12) "DSCI0783.JPG" [2]=> string(8) "dump.php" [3]=> string(0) "" } 
           ["type"]=> array(4) { [0]=> string(10) "image/jpeg" [1]=> string(10) "image/jpeg" [2]=> string(24) "application/octet-stream" [3]=> string(0) "" } 
           ["tmp_name"]=> array(4) { [0]=> string(27) "C:\Windows\Temp\phpC9C9.tmp" [1]=> string(27) "C:\Windows\Temp\phpC9DA.tmp" [2]=> string(27) "C:\Windows\Temp\phpC9DB.tmp" [3]=> string(0) "" } 
           ["error"]=> array(4) { [0]=> int(0) [1]=> int(0) [2]=> int(0) [3]=> int(4) } ["size"]=> array(4) { [0]=> int(101011) [1]=> int(55354) [2]=> int(12290) [3]=> int(0) } 
         } 
```

怎么做？与foreach？

```
foreach ($_FILES["fails"] as $x => $y ) {
echo $y->....something here?
   if(($y->... == 'image/jpeg') AND (..)) {}
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:42:29.620

```
for ($i = 0; $i < count($_FILES['fails']['name']); $i++) {
    if ($_FILES['fails']['type'][$i] == "image/jpeg" || $_FILES['fails']['type'][$i] == "image/jpg") {
        echo "Name : " . $_FILES['fails']['name'][$i];
        echo "Type : " . $_FILES['fails']['type'][$i];
    }
} 
```

这将回显数组中每个图像/jpg 或图像/jpeg 的名称和类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:41:01.213

尝试一下：

```
$output = array();
foreach ($_FILES["fails"]['type'] as $k => $type ) {
    if($type == 'image/jpeg' || $type == 'image/jpg')
        $output[] = $_FILES["fails"]['name'][$k];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T09:49:53.393

尝试

```
$allowTypes = array (
        "image/jpeg",
        "image/jpg" 
); // Ad More to list
$_FILE ['fails'] = array ();
foreach ( $_FILES ['image'] ['tmp_name'] as $key => $val ) {
    $fileName = $_FILES ['image'] ['name'] [$key];
    $fileType = $_FILES ['image'] ['type'] [$key];
    if ($_FILES ["image"] ["error"] [$key] != UPLOAD_ERR_OK) {
        $_FILE ['fails'] [] = $fileName;
        continue;
    }

    if (! in_array ( $fileType, $allowTypes )) {
        $_FILE ['fails'] [] = $fileName;
        continue;
    }
} 
```

# java - 在小程序中使用 EJB

> ID：10330792
> 
> 赞同：0
> 
> 时间：2012-04-26T09:36:24.687
> 
> 标签：java, applet, ejb

我一直在尝试从小程序中注入/使用我的 EJB，但没有成功。我创建了一个新的 Java EE Enterprise 应用程序。我正在使用 glassfish 3 和 netbeans 7.1

主要问题是实例化`InitialContext`.

这是我的豆子的声明。

```
 @Stateless
   public class UserFacade implements UserFacadeLocal {
   @PersistenceContext(unitName = "MetroEntitiesPU")
   private EntityManager em;

   @Remote
   public interface UserFacadeLocal { 
```

`gf-client.jar`通过包含类路径并使用以下代码，我已经能够创建一个独立的 Java 客户端。

```
try {
   UserFacadeLocal ufl = (UserFacadeLocal) new InitialContext()
     .lookup("bidd.data.ejb.UserFacadeLocal");
   System.out.println("FROM EJB COUNT: " + String.valueOf(ufl.count()));
} catch (NamingException ex) {
    Logger.getLogger(JavaApplication3.class.getName())
      .log(Level.SEVERE, null, ex);
} 
```

问题是当我试图在小程序中做同样的事情时。小程序在 jar 文件中编译，然后从 jsp 网站加载，该网站是我在 netbeans 中的企业应用程序的一部分。

这是 init 方法中给出以下错误的行。

```
UserFacadeLocal ufl = (UserFacadeLocal) new InitialContext()
  .lookup("bidd.data.ejb.UserFacadeLocal"); 
```

## 错误

```
Need to specify class name in environment or system property, 
  or as an applet parameter, 
  or in an application resource file:  java.naming.factory.initial 
```

如何解决这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T10:05:46.577

```
Need to specify class name in environment or system property, 
  or as an applet parameter, 
  or in an application resource file:  java.naming.factory.initial 
```

*   `environment or system property`
    对于公开部署的小程序¹不实用。
*   `as an applet parameter`
    应该是微不足道的¹。就像是：
    `<applet ..><param name='the.name' value='bidd.data.ejb.UserFacadeLocal'> </applet>`
*   `in an application resource file`
    可能可行，但大概您需要添加一个`param`来识别文件。

* * *

1.  小程序：这同样适用于 JWS 应用程序。这是我实际推荐用于此部署的内容。

# visual-studio-2010 - tfs 2010如何在签入时防止锁定

> ID：10330793
> 
> 赞同：2
> 
> 时间：2012-04-26T09:36:26.490
> 
> 标签：visual-studio-2010

我在我使用 VS2010 Ultimate 的电脑上安装了 tfs 2010，我的所有项目组都可以毫无问题地签入（带有用户图标），除了我；当我签入文件时将被锁定（锁定图标）！

我在项目中的文件：

![在此处输入图像描述](../Images/6890e854cb92135342fa94e6fd46190e.png)

其他个人电脑文件：

![在此处输入图像描述](../Images/5930e3e4baabe88151eb8c6e0e239cdf.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T11:06:41.220

您的第一张图片中显示的“锁定”仅表示此文件`MainPanel.cs`已签入。
任何其他用户都应该能够签出此文件以进行编辑。
您在第二张图片中显示的内容告诉我们`MainPanel.cs`，与所有其他文件一起，已由另一个用户签出。我的猜测是只有另一个开发人员已经`MainPanel.cs`签出。

为了找出谁签出了什么： 安装最新的[TFS Power Tools](http://msdn.microsoft.com/en-us/vstudio/bb980963)，其中一部分是“团队成员”。
![在此处输入图像描述](../Images/4713bce34545611a9e3e8a3f7244fdd0.png)
您可以在那里添加任何有效的团队项目用户并使用“显示待处理的更改”调查她/他的结帐：
![在此处输入图像描述](../Images/27ea1e5abd6bacd2d2fe72c281acfc60.png)。

另一个可能与您的问题相关的注释：
当您选择签出任何文件时，可以从三种不同的锁类型中进行选择，这些锁类型会影响其他开发人员可以对您签出的源执行的操作：
![在此处输入图像描述](../Images/dceee1c8b58cd2662df6f8de45fe1c31.png)

# image - 为图像添加自动超链接

> ID：10330796
> 
> 赞同：4
> 
> 时间：2012-04-26T09:36:37.427
> 
> 标签：image, wordpress, hyperlink

我为图片创建了一个 wordpress 博客。在发布所有帖子时，我没有使用 wordpress 编辑器上传图片。相反，我使用 FillaZilla 上传图像。然后，在 wordpress 编辑器中，我在所有帖子中手动只写了图像标签（如下）并发布。所有帖子均不包含文字，而仅包含图像。像这样，

```
<img alt="" title="" src=""></img> 
```

现在我想问你的是，我希望所有帖子中的图像都获得与图像 src 相同的自动超链接地址。我的 wordpress 博客中有 200 多篇博文。我不想一一编辑它们。这是wordpress内容区域的编码，

```
<div class="post-entry">
                                            <p><img src='http://www.mywebsite.com/wp-content/uploads/2012/04/sun.jpg' title="sun" alt="sun" /></p>

</div> 
```

有人可以帮我吗？如何向图像添加超链接？是否有任何代码可以放入我的 wordpress 主题页面的 post-entry div 中？

@chandu-vkm 解释了（在评论中）我正在寻找的东西。现在我还有一个问题。当我在 img 之前添加 aa span 标签时，提到的代码 @chandu-vkm 不允许我在 img 标签之前添加 span 标签。相反，它将 place 标记放在 p 标记之外，如下面的代码所示。

```
<div class="post_div">
<span class="entry"></span>
<p>
<img src='http://www.mywebsite.com/wp-content/uploads/2012/04/sun.jpg' title="Cute Teddy Bear" alt="Cute Teddy Bear" />
</p>
</div> 
```

但我希望 span 放在 p 之后，就像这样。

```
 <div class="post_div">
        <p>
         <span class="entry"></span>
        <img src='http://www.mywebsite.com/wp-content/uploads/2012/04/sun.jpg' title="Cute Teddy Bear" alt="Cute Teddy Bear" />
        </p>
    </div> 
```

有人请帮帮我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T10:07:11.460

你可以用一些jquery来做

```
<div class="post_div">
    <img src='http://www.mywebsite.com/wp-content/uploads/2012/04/sun.jpg' title="sun" alt="sun" />
</div> 
```

像这样

```
$('.post_div img').each(function(){
$(this).wrap(function() {
  return '<a href="' + $(this).attr('src') + '" />';
})   
}); 
```

这里的示例[http://jsfiddle.net/a4PYd/](http://jsfiddle.net/a4PYd/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:53:52.907

如果您确定您的所有帖子内容仅包含`<img>`标签，您可以将此代码片段添加到您的**functions.php**文件中：

```
function hyperlink_all_my_content( $content ) {
    $link = "http://www.somelink.com";
    return "<a href='$link'>$content</a>";
}
add_filter( 'the_content', 'hyperlink_all_my_content' ); 
```

请注意，这将链接您的所有内容，即使在您的 wordpress 页面上也是如此。

编辑：

```
function hyperlink_all_my_content( $content ) {

    $matches = array();
    $nummatches = preg_match("/src=['|\"](.*)['|\"]/", $content, $matches);
    return "<a href='" . $matches[1] . "'>$content</a>";
}
add_filter( 'the_content', 'hyperlink_all_my_content' ); 
```

# ruby-on-rails - .bashrc 的 windows 等价文件是什么

> ID：10330797
> 
> 赞同：0
> 
> 时间：2012-04-26T09:36:39.650
> 
> 标签：ruby-on-rails, windows

我正在尝试按如下方式安装 eventmachine： gem install eventmachine -v '0.12.10'

我遇到以下问题：

```
D:\rails_workspace\rubytime>gem install eventmachine -v '0.12.10'
Temporarily enhancing PATH to include DevKit...
Building native extensions.  This could take a while...
ERROR:  Error installing eventmachine:
        ERROR: Failed to build gem native extension.

        C:/Rails/Ruby1.9.3/bin/ruby.exe extconf.rb
checking for rb_trap_immediate in ruby.h,rubysig.h... no
checking for rb_thread_blocking_region()... yes
checking for inotify_init() in sys/inotify.h... no
checking for __NR_inotify_init in sys/syscall.h... no
checking for writev() in sys/uio.h... no
checking for rb_thread_check_ints()... yes
checking for rb_time_new()... yes
checking for windows.h... yes
checking for winsock.h... yes
checking for main() in -lkernel32... yes
checking for main() in -lrpcrt4... yes
checking for main() in -lgdi32... yes
checking for main() in -lssl... no
creating Makefile

make
generating rubyeventmachine-i386-mingw32.def
compiling binder.cpp
cc1plus.exe: warning: command line option "-Wdeclaration-after-statement" is valid for C/ObjC but not for C++
cc1plus.exe: warning: command line option "-Wimplicit-function-declaration" is valid for C/ObjC but not for C++
In file included from project.h:137:0,
                 from binder.cpp:20:
binder.h:35:34: warning: type qualifiers ignored on function return type
In file included from project.h:138:0,
                 from binder.cpp:20:
em.h:91:47: warning: type qualifiers ignored on function return type
em.h:92:76: warning: type qualifiers ignored on function return type
em.h:93:56: warning: type qualifiers ignored on function return type
em.h:95:57: warning: type qualifiers ignored on function return type
em.h:96:60: warning: type qualifiers ignored on function return type
em.h:97:58: warning: type qualifiers ignored on function return type
em.h:98:55: warning: type qualifiers ignored on function return type
em.h:99:36: warning: type qualifiers ignored on function return type
em.h:101:47: warning: type qualifiers ignored on function return type
em.h:106:42: warning: type qualifiers ignored on function return type
em.h:123:45: warning: type qualifiers ignored on function return type
em.h:132:36: warning: type qualifiers ignored on function return type
In file included from project.h:145:0,
                 from binder.cpp:20:
eventmachine.h:45:61: warning: type qualifiers ignored on function return type
eventmachine.h:46:112: warning: type qualifiers ignored on function return type
eventmachine.h:47:69: warning: type qualifiers ignored on function return type
eventmachine.h:49:73: warning: type qualifiers ignored on function return type
eventmachine.h:62:75: warning: type qualifiers ignored on function return type
eventmachine.h:63:74: warning: type qualifiers ignored on function return type
eventmachine.h:64:77: warning: type qualifiers ignored on function return type
eventmachine.h:65:41: warning: type qualifiers ignored on function return type
In file included from project.h:145:0,
                 from binder.cpp:20:
eventmachine.h:99:60: warning: type qualifiers ignored on function return type
eventmachine.h:100:58: warning: type qualifiers ignored on function return type
eventmachine.h:102:60: warning: type qualifiers ignored on function return type
eventmachine.h:105:41: warning: type qualifiers ignored on function return type
compiling cmain.cpp
cc1plus.exe: warning: command line option "-Wdeclaration-after-statement" is valid for C/ObjC but not for C++
cc1plus.exe: warning: command line option "-Wimplicit-function-declaration" is valid for C/ObjC but not for C++
In file included from project.h:137:0,
                 from cmain.cpp:20:
binder.h:35:34: warning: type qualifiers ignored on function return type
In file included from project.h:138:0,
                 from cmain.cpp:20:
em.h:91:47: warning: type qualifiers ignored on function return type
em.h:92:76: warning: type qualifiers ignored on function return type
em.h:93:56: warning: type qualifiers ignored on function return type
em.h:95:57: warning: type qualifiers ignored on function return type
em.h:96:60: warning: type qualifiers ignored on function return type
em.h:97:58: warning: type qualifiers ignored on function return type
em.h:98:55: warning: type qualifiers ignored on function return type
em.h:99:36: warning: type qualifiers ignored on function return type
em.h:101:47: warning: type qualifiers ignored on function return type
em.h:106:42: warning: type qualifiers ignored on function return type
em.h:123:45: warning: type qualifiers ignored on function return type
em.h:132:36: warning: type qualifiers ignored on function return type
In file included from project.h:145:0,
                 from cmain.cpp:20:
eventmachine.h:45:61: warning: type qualifiers ignored on function return type
eventmachine.h:46:112: warning: type qualifiers ignored on function return type
eventmachine.h:47:69: warning: type qualifiers ignored on function return type
eventmachine.h:49:73: warning: type qualifiers ignored on function return type
eventmachine.h:62:75: warning: type qualifiers ignored on function return type
eventmachine.h:63:74: warning: type qualifiers ignored on function return type
eventmachine.h:64:77: warning: type qualifiers ignored on function return type
eventmachine.h:65:41: warning: type qualifiers ignored on function return type
In file included from project.h:145:0,
                 from cmain.cpp:20:
eventmachine.h:99:60: warning: type qualifiers ignored on function return type
eventmachine.h:100:58: warning: type qualifiers ignored on function return type
eventmachine.h:102:60: warning: type qualifiers ignored on function return type
eventmachine.h:105:41: warning: type qualifiers ignored on function return type
cmain.cpp:98:71: warning: type qualifiers ignored on function return type
cmain.cpp:109:122: warning: type qualifiers ignored on function return type
cmain.cpp:119:79: warning: type qualifiers ignored on function return type
cmain.cpp:129:83: warning: type qualifiers ignored on function return type
cmain.cpp:260:85: warning: type qualifiers ignored on function return type
cmain.cpp:270:84: warning: type qualifiers ignored on function return type
cmain.cpp:280:88: warning: type qualifiers ignored on function return type
cmain.cpp:290:51: warning: type qualifiers ignored on function return type
cmain.cpp:300:70: warning: type qualifiers ignored on function return type
cmain.cpp:320:55: warning: type qualifiers ignored on function return type
cmain.cpp:546:70: warning: type qualifiers ignored on function return type
cmain.cpp:669:68: warning: type qualifiers ignored on function return type
cmain.cpp: In function 'int evma_send_file_data_to_connection(long unsigned int, const char*)':
cmain.cpp:752:6: error: cannot convert 'stat*' to '_stati64*' for argument '2' to 'int _fstati64(int, _stati64*)'
make: *** [cmain.o] Error 1

Gem files will remain installed in C:/Rails/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/eventmachine-0.12.10 for inspection.
Results logged to C:/Rails/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/eventmachine-0.12.10/ext/gem_make.out 
```

[在这里](https://stackoverflow.com/questions/6447590/thin-eventmachine-non-root-installation-problem)我找到了一些信息，但不知道如何在 Windows 中做到这一点

请帮助我如何在 Windows 中解决此问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:42:55.370

您不需要 .bashrc，而是添加环境变量。要设置环境变量（相当于帖子中描述的解决方案），请右键单击我的电脑，选择属性 -> 高级，然后选择环境变量。创建一个新值，其名称与您在 linux 中的名称相同（请注意 $USER 将不起作用。输入您的用户名或使用 %USERNAME%）。我不确定这是否会解决您的问题我只是告诉您如何执行与您链接到的答案中描述的操作等效的操作。此外，设置环境变量的方式可能会因您的 Windows 版本而有所不同。

# c# - c#多个调度选项？

> ID：10330805
> 
> 赞同：6
> 
> 时间：2012-04-26T09:36:59.800
> 
> 标签：c#, dynamic, .net-4.0, multiple-dispatch

我有这些课程：

```
class Asset
{    }

class House:Asset
{    } 
```

考虑这些局外人静态函数：

```
static void Foo (Asset a) { }
static void Foo (House h) { } 
```

如果我写：

```
House h = new House (...); 
Foo(h); 
```

它会调用`Foo(House)`（编译时绑定）

如果我写：

```
Asset a = new House (...);
Foo(a); 
```

它会调用`Foo(Asset)` （编译时绑定）

目标：访问运行时类型方法：

我有两个选择：

1）像这样使用动态：

```
 Asset a = new House (...);
 Foo ((dynamic)a); // NOW it will call  Foo(House) 
```

2) 将功能从using`static`移至`override`using `polymorphism mechanism`。

**问题**：

还有**其他**方法吗（无需将函数移至`polymorphism mechanism`|| `dynamic`）？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-04-26T13:09:10.163

> 目标：访问运行时类型方法

这就是`dynamic`关键字的用途。这实际上是一种非常干净且快速的多次调度方式。

[您对多次调度](http://en.wikipedia.org/wiki/Multiple_dispatch)的最终选择是

1.  `dynamic`
2.  双分派虚方法
3.  一些散列匿名函数规则集合
4.  `if (x is House) ... else if(x is Asset)...`
5.  反射——真的很慢很丑

> 问题：还有其他方法吗（不将函数移至多态机制||动态）？

`dynamic`所以，是的，当您可以使用快速、不易出错且[语法非常简洁](http://blogs.msdn.com/b/laurionb/archive/2009/08/13/multimethods-in-c-4-0-with-dynamic.aspx)的方法时，有一些方法需要您做很多工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T12:49:30.663

我认为这就是幕后发生的事情`Foo((dynamic)a)`：

```
Asset a = new House();

Type t = typeof(MainClass);
t.InvokeMember("Foo", 
     System.Reflection.BindingFlags.InvokeMethod, null, 
     t, new object[] { a }); 
```

这将解决`Foo(House h)`

* * *

快速访问 monodis.exe，不使用反射（例如 InvokeMember），即使用动态关键字代替`Asset a = new House(); Foo((dynamic)a)`，这是 IL：

```
IL_0025:  ldstr "Foo"
IL_002a:  ldnull 
IL_002b:  ldtoken MainClass
IL_0030:  call class [mscorlib]System.Type class [mscorlib]System.Type::GetTypeFromHandle(valuetype [mscorlib]System.RuntimeTypeHandle) 
```

几乎你的直觉会告诉你，“Foo”是一个死的赠品，动态是一种*反射式*的业务。

现在，这是动态的，即`Asset a = new House(); Foo(a)`：

```
IL_0010:  ldloc.0 
IL_0011:  call void class MainClass::Foo(class Asset) 
```

烧毁的指令几乎是确定的，不会改变，它总是解决`Foo(Asset);`

以下是可用于分析动态行为的完整代码（通过 monodis.exe 或 ildasm.exe）：

```
using System;

public class MainClass {
    public static void Main() {

        Console.WriteLine("Hei");

        Asset a = new House();        
        Foo(a);    
        Foo((dynamic)a);  

        object x = 7;
        Foo((dynamic)x);
    }

    public static void Foo(House h) { Console.WriteLine("House"); }
    public static void Foo(Asset a) { Console.WriteLine("Asset"); }
    public static void Foo(int i) { Console.WriteLine("int"); }
}

public class Asset {
}

public class House : Asset {
} 
```

输出：

```
Hei
Asset
House
int 
```

这将调用 Foo 重载 int，即`Foo(int i)`：

```
object x = 7;
t.InvokeMember("Foo", System.Reflection.BindingFlags.InvokeMethod, null, 
   t, new object[] { x } ); 
```

这也将：

```
t.InvokeMember("Foo", System.Reflection.BindingFlags.InvokeMethod, null, 
   t, new object[] { 8 } ); 
```

* * *

所以关于你的问题，你可以使用什么其他选项，你可以使用一个接受无类型对象的方法：

```
public static void FooDynamic(object o) 
{
    Type t = typeof(MainClass);
    t.InvokeMember("Foo", System.Reflection.BindingFlags.InvokeMethod, null, t, new object[] { o } ); 
} 
```

调用：

```
Asset a = new House();
FooDynamic(a); // will select Foo House overload 

int i = 7;
FooDynamic(i); // will select Foo int overload 
```

您也可以将此 API 用于上面的代码：`public static void Foo(object o)`，然后您必须像这样调用 Foo：

```
Asset a = new House();
Foo((object)a); // will resolve to House 
```

鉴于 C# 4 中已经有一项`dynamic`功能，除非开发人员仍在使用 C# 3，否则我将很难使用反射。因此，请改用动态方法:-)

* * *

**更新**

对于它的价值，它`dynamic`很**慢**（至少在 Mono 上），当我运行这段代码时，在字母“B”出现之前有相当长的延迟，大约 2 秒。即使我交换动态和反射的代码顺序，动态的延迟也是可重现的。反射的延迟是难以察觉的，它比动态的要快。

```
using System;

public class MainClass {

    public static void Main() {

        // there's a delay on initial dynamic call, about two seconds
        Test (); 
        Console.ReadLine ();

        // dynamic's speed is instant on subsequent calls, 
        // as clarified by Eric Lippert, the delegate is cached,
        // hence the elimination of delay on subsequent dynamic calls
        Test (); 

    }

    public static void Test() {

        Asset a = new House();

        Console.WriteLine("A");
        Foo((dynamic)a);  // there is a considerable delay here, the "B" string appears after two seconds

        Console.WriteLine ("B");        
        Type t = typeof(MainClass);
        t.InvokeMember("Foo", System.Reflection.BindingFlags.InvokeMethod, null, t, new object[] { a } ); 

        Console.WriteLine("C");

    }

    public static void Foo(House h) { Console.WriteLine("House"); }
    public static void Foo(Asset a) { Console.WriteLine("Asset"); }
    public static void Foo(int i) { Console.WriteLine("int"); }
}

public class Asset {
}

public class House : Asset {
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T13:34:08.910

如果您想要静态入口点，但也想要多态行为，那么最简单的混合是使用单例模式。它将为您提供静态入口点，并且它返回的对象将具有多态方法。

我还建议忽略所有说单身是一件可怕的坏事的人。Prima Donna 单例讲道是中级开发人员的陈词滥调。单例只是一个工具，如果它符合您的需求 - 那就使用它。

# regex - 如何在 RPM SPEC 文件中使用正则表达式？

> ID：10330808
> 
> 赞同：3
> 
> 时间：2012-04-26T09:37:15.460
> 
> 标签：regex, rpm, specifications

我想使用正则表达式或 find 的输出列出要包含在我的包中的文件。

我怎样才能做到这一点？

TIA

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T10:59:03.340

您可以使用`'-f'`指令`%files`获取要从文件中包含的文件列表。这样您就可以生成要包含在`%install`部分末尾的文件

```
...
%install
...

find %{buildroot} -regex '.*a$' > file-lists

%files -f file-lists
... 
```

# .net - 移动文件夹中的所有文件，但不删除 VB .NET 中的文件夹

> ID：10330812
> 
> 赞同：0
> 
> 时间：2012-04-26T09:37:26.180
> 
> 标签：.net, vb.net

我需要知道如何将文件夹内的所有文件（例如：C:\Folder1）移动到另一个文件夹（例如：C:\Folder2），但不能删除 Folder1 并获取已移动的项目数量，让我解释;

我需要移动 Folder1 中的所有项目（文件、文件夹、子文件夹、子文件等）维护目录结构，但不删除 Folder1，如果可能的话，知道移动了多少文件夹和多少文件（只有文件夹数和文件数）。

有人可以帮我吗？提前谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T10:38:52.450

您可以尝试使用此递归过程。

```
Public Shared Function moveDirectoryContent(srcDir As String, destDir As String) as Integer
    Dim countFile As Integer = 0
    If (Not Directory.Exists(destDir)) Then
        Directory.CreateDirectory(destDir)
    End If
    Dim listFiles() As String = Directory.GetFileSystemEntries(srcDir)
    Dim curFile As String

    For Each curFile In listFiles
        If Directory.Exists(curFile) Then
            countFile = countFile + moveDirectoryContent(curFile, Path.Combine(destDir, Path.GetFileName(curFile)))
        Else
            Dim dstFile = Path.Combine(destDir, Path.GetFileName(curFile))
            If File.Exists(dstFile) Then
                dstFile = GetUniqueName(dstFile)
            End If
            File.Copy(curFile, dstFile)
            File.Delete(curFile)
            countFile = countFile + 1
        End If
    Next
    Return countFile
End Function

Public Shared Function GetUniqueName(srcFile as String) as String
    Dim uFile As String = Path.GetFileNameWithoutExtension(srcFile)
    Dim ext as String = Path.GetExtension(srcFile)
    Dim cnt As Integer = 0
    Dim uniqueText = string.Format("_{0}_00", DateTime.ToDay.ToString("yyyy_MM_dd"))
    While(File.Exists(uFile + uniqueText + ext))
        cnt = cnt + 1
        uniqueText = string.Format("_{0}_{1:D2}", DateTime.ToDay.ToString("yyyy_MM_dd"), cnt)
    End While
    Return Path.GetDirectoryName(srcFile) + "\" + uFile + uniqueText + ext
End Function 
```

并以这种方式调用

```
numMoved = moveDirectoryContent("C:\temp", "C:\temp2") 
```

请注意，目标文件夹不能在源文件夹内......（不执行检查）

# postgresql - 如果 Postgresql 数据库中存在带有 eclipselink 的表，如何忽略创建表？

> ID：10330813
> 
> 赞同：0
> 
> 时间：2012-04-26T09:37:29.937
> 
> 标签：postgresql, jpa, persistence, eclipselink, postgresql-8.4

我在 JOnAS（Java 环境）中使用带有 eclipselink2.3 提供程序的 Postgresql 数据库。我的配置是：

持久性.xml：

```
...
<property name="eclipselink.ddl-generation" value="create-tables"/>
<property name="eclipselink.ddl-generation.output-mode" value="database"/>
<property name="eclipselink.target-database" value="POSTGRESQL"/>
... 
```

Postgresql 版本是

```
Version : 8.4.11-0squeeze1 
```

JDBC 驱动程序版本是

```
postgresql-8.4-703.jdbc3.jar 
```

当数据库为空时，没有问题。

我的问题是当 eclipselink.ddl-generation 设置为 create-tables 并且表已经存在于数据库中时，会发生错误并且进程不会继续执行下一条语句，如此[处](http://wiki.eclipse.org/Using_EclipseLink_JPA_Extensions_%28ELUG%29#eclipselink.ddl-generation)所述。

有没有人看到解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T13:18:34.317

在您的情况下，我没有看到任何可以防止抛出错误的[属性。](http://jdbc.postgresql.org/documentation/80/connect.html)所以我建议以下。您应该有 3 个用于 3 个不同环境的 persistence.xml 文件：开发、测试和生产。

在开发环境中，您想使用干净的数据库，所以

```
<property name="eclipselink.ddl-generation" value="drop-and-create-tables"/> 
```

测试环境也是如此，但在这种情况下，我会使用 DBUnit 来用测试数据填充数据库。

在生产中，您不想弄乱数据库结构，所以

```
<property name="eclipselink.ddl-generation" value="none"/> 
```

是正确的选择。

如果您使用 ant 或 maven，这样的配置相当容易完成（您可能会在网上找到示例，因为这是非常标准的方法）。

我猜你不会喜欢这个答案；），因为这看起来需要做很多额外的工作，但从长远来看，干净的配置和分离会得到回报。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T13:23:21.783

如果表已经存在，“create-tables”选项不会失败。它将记录错误，但继续。如果您不想看到错误，可以关闭日志记录。

你得到什么错误？

# python - 变量是否由于某种原因作为指针传递？

> ID：10330831
> 
> 赞同：0
> 
> 时间：2012-04-26T09:38:18.110
> 
> 标签：python, function, pointers, reference, module

我制作的代码有效，但我想知道为什么。我不小心在代码中犯了一个错误，但由于某种原因它可以工作，为什么？当我传递`lastkeys`给时`move.mov`，键不应该是一个新变量吗？与 , 相同`ent.playerlocation`，不应该`player`是`move.mov`一个新变量吗？当我退出函数时，原始变量将更改为新变量的值。我试图重新创建它，但无法做到。

主要.py：

```
import pygame
import move, updatescreen

class entities:
    def __init__(self):
        self.playerlocation = [64,64]

if __name__ == '__main__':
    pygame.init()
    screen=pygame.display.set_mode((640,360),pygame.RESIZABLE,32)#pygame.FULLSCREEN
    pygame.display.set_caption('Pygame Window')

    ent = entities()
    lastkeys = [0,0,0,0]
    ispaused = 0

    while True:
        move.userevents(lastkeys)
        move.mov(lastkeys, ent.playerlocation)
        updatescreen.gameupdate(screen,ent) 
```

移动.py：

```
import pygame, sys

def userevents(keys):
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            pygame.quit()
            sys.exit()
        elif event.type == pygame.KEYDOWN:
            if event.key == pygame.K_LEFT:
                keys[0] = 1
            elif event.key == pygame.K_RIGHT:
                keys[1] = 1
            elif event.key == pygame.K_UP:
                keys[2] = 1
            elif event.key == pygame.K_DOWN:
                keys[3] = 1
        elif event.type == pygame.KEYUP:
            if event.key == pygame.K_LEFT:
                keys[0] = 0
            elif event.key == pygame.K_RIGHT:
                keys[1] = 0
            elif event.key == pygame.K_UP:
                keys[2] = 0
            elif event.key == pygame.K_DOWN:
                keys[3] = 0

def mov(keys,player):
    if keys[0]:
        player[0] -=1
    elif keys[1]:
        player[0] +=1
    if keys[2]:
        player[1] -=1
    elif keys[3]:
        player[1] +=1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:49:42.723

当您传入一个可变对象时，它会通过引用传入（因此，您对其所做的任何修改都会影响原始对象）。例如：

```
>>> def change_list(lst):
...   lst[0] = lst[0] * 2
... 
>>> a = [1,2,3]
>>> change_list(a)
>>> a
[2, 2, 3] 
```

因此，要么在将列表传递给函数之前复制它：

```
>>> def change_list(lst):
...   lst[0] = lst[0] * 2
... 
>>> a = [1,2,3]
>>> cpy_a = list(a)
>>> change_list(cpy_a)
>>> a
[1, 2, 3] 
```

或者在它被传递到函数之后：

```
>>> def change_list(lst):
...   lst_cpy = list(lst)
...   lst_cpy[0] = lst_cpy[0] * 2
... 
>>> a = [1,2,3]
>>> change_list(a)
>>> a
[1, 2, 3] 
```

有关更彻底的讨论，请参阅：[如何通过引用传递变量？](https://stackoverflow.com/questions/986006/python-how-do-i-pass-a-variable-by-reference)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:48:30.023

> 当我传递`lastkeys`给时`move.mov`，键不应该是一个新变量吗？

不，对象总是在 Python 中通过引用传递。如果您将一个列表传递给一个函数，并且该函数修改了该列表，那么之后从调用方可以看到修改。

# c# - 当我尝试打开以 .xls 作为扩展名的 excel 文件时出现一个对话框

> ID：10330832
> 
> 赞同：2
> 
> 时间：2012-04-26T09:38:22.153
> 
> 标签：c#, asp.net, export-to-excel

我正在使用以下代码将数据导出到 Excel 表。

```
 private void ExportToExcel(string fileName)
    {
        fileName = "MyXML.xls";

        Response.Clear();
        Response.AddHeader("content-disposition", "attachment; filename=" + fileName);
        Response.ContentType = "application/vnd.xls";
        System.IO.StringWriter stringWrite = new System.IO.StringWriter();
        System.Web.UI.HtmlTextWriter htmlWrite = new HtmlTextWriter(stringWrite);
        rptLinks.RenderControl(htmlWrite);
        Response.Write(stringWrite.ToString());
        Response.End();
    } 
```

一切正常，但是当我尝试通过双击打开 Excel 文件**MyXML.xls**时，会打开一个弹出/对话框，并显示以下消息：

“您尝试打开的文件，**MyXML.xls**的格式与文件扩展名指定的格式不同。”等..

我们可以对代码进行一些更改，以免弹出/对话框出现吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:51:30.437

希望这可以帮助

[http://devblog.grinn.net/2008/06/file-you-are-trying-to-open-is-in.html](http://devblog.grinn.net/2008/06/file-you-are-trying-to-open-is-in.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T09:46:01.733

更改 Response.ContentType = "application/vnd.xls"; 到 Response.ContentType = "application/vnd.ms-excel"

# c# - 将列表的最后一个元素与之前的元素进行比较的简化语法？

> ID：10330833
> 
> 赞同：1
> 
> 时间：2012-04-26T09:38:27.307
> 
> 标签：c#, .net

```
List<DateTime> list = new List<DateTime>(); 
```

目前我有以下语法：

```
if(list[list.Count - 1] != list.[list.Count - 2])
{
    //do something
} 
```

这是一个令人难以置信的长语法（在我的实际程序中，列表名称也长得多）。该列表也可通过静态方法获得，该方法甚至会大大增加此语法的宽度。

我怎样才能把这个语法写得更短、更易读？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:46:16.430

在这种情况下创建一个静态函数，您将在任何地方使用它而不创建对象

```
if(myclass.PenultimateCondition(mylist))
{
    //do something
}

public class myclass
{
    public static bool PenultimateCondition(List<Datetime> list)
    {
         return list[list.Count - 1] == list.[list.Count - 2];
    }
} 
```

**或者**

制作日期时间扩展方法。在这种情况下，您甚至不必写类名

```
public class ExtensionMethod
{
    public static bool PenultimateCondition(this IEnumerable<DateTime> value)
    {
        Datetime[] dt = value.ToArray();
        return dt[dt.Length-2] == dt[dt.Length-1];
    }
} 
```

并像使用它一样

```
if(myList.PenultimateCondition())
{
    //do something
} 
```

**或者**

制作通用扩展方法。在这种情况下，您可以将其用于任何数据类型

```
public class ExtensionMethod
{
    public static bool PenultimateCondition<T>(this IEnumerable<T> value)
    {
        T[] dt = value.ToArray();
        return Equals(dt[dt.Length-2], dt[dt.Length-1]);
    }
} 
```

并像使用它一样

```
if(myList.PenultimateCondition())
{
    //do something
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-26T09:42:25.167

```
var count = list.Count; 

if(list[count - 1] != list[count - 2])
{
    //do something
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T09:48:01.517

将您的条件重构为一个函数：

```
static Boolean LastTwoElementsAreEqual<T>(IList<T> list) {
  if (list.Count < 2)
    return false;
  return Equals(list[list.Count - 1], list[list.Count - 2]);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T10:31:03.543

我强烈建议也将其放入一种方法中，但这可能是您可以在一行中完成的最短的方法：

```
// Mine vs original.
if(list.Last() != list[list.Count - 2])
if(list[list.Count - 1] != list[list.Count - 2]) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-04-26T09:47:40.687

您可以使用包含功能来检查列表。

```
String toCheck = list [list.Count - 1]
if(!list.Contains())
{
 // do the ...
} 
```

# c# - 实体翻译服务实现

> ID：10330834
> 
> 赞同：0
> 
> 时间：2012-04-26T09:38:38.177
> 
> 标签：c#, asp.net, wcf, entity, dto

我有一个与 WCF 通信的 asp.net 应用程序。WCF 消息在 DTO 类中表示。

要从**WCF**获取数据，我必须将**DTO**消息转换为 View **DTO**类，以便在应用程序中查看。

[我记得MSDN](http://msdn.microsoft.com/en-us/library/cc304747.aspx)有实体翻译服务

但现在文章说内容已退役并移至 Web 服务软件工厂。

我在 WSSF 中搜索了相同的服务，但没有运气。这项服务有新的替代品吗？？？**或者实体翻译服务**有更好的实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T09:51:26.200

我在我的项目中使用[Glue](http://glue.codeplex.com/)库进行实体映射。[AutoMapper](https://github.com/AutoMapper/AutoMapper)并[在此处输入链接描述](http://valueinjecter.codeplex.com/)是您可以使用的其他一些流行库。

Glue 还没有处理子类映射；但我更喜欢 AutoMapper（它可以正确映射子类）。AutoMapper 处理其配置的方式太像黑盒并且容易出错恕我直言。

# c - GDB：强制通过 if 语句

> ID：10330835
> 
> 赞同：6
> 
> 时间：2012-04-26T09:38:38.530
> 
> 标签：c, gdb

这是我的代码的结构

```
if(someFunction())
{
  // Some code
} 
```

大部分时间都在哪里`someFunction()`评估`0`

当 GDB 在上面的第 1 行时，如果我这样做，`next`则`// Some code`不会执行。

有没有办法告诉 GDB 执行`if`语句中的代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T09:45:34.783

我只能建议你一个解决方法。有一个临时变量`int i=0`，然后执行 if as

```
if(i==1){
  //some code
} 
```

当您使用 gdb 到达所需位置时。使用设置`i`为 1

```
set i = 1 
```

然后你的循环将被执行。当然，在循环之后，如果您不想每次都执行它，您将不得不重置您。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-26T12:24:48.980

您可以在 gdb 中`// Some code`停止 on 语句后跳转到，除非未优化，请参阅[17.2 Continuing at a different Address](http://sourceware.org/gdb/onlinedocs/gdb/Jumping.html#Jumping)。假设您停在，您可以：`if``// Some code``if`

```
jump +2 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-04-26T09:52:51.047

0 表示假，所以不会进入 if 循环，使用

```
if(1) 
```

# mysql - 如何在MySQL中计算不包括周末和节假日的日期差异

> ID：10330836
> 
> 赞同：20
> 
> 时间：2012-04-26T09:38:39.097
> 
> 标签：mysql, sql

我需要计算两个日期之间的天数（工作日），不包括周末（最重要）和节假日

```
SELECT DATEDIFF(end_date, start_date) from accounts 
```

但是，我不知道我应该如何在 MySQL 中做到这一点，我发现这篇文章[Count days between two dates，不包括周末（仅限 MySQL）](https://stackoverflow.com/questions/9757919/count-days-between-two-dates-excluding-weekends-mysql-only)。我无法弄清楚如何在 mysql 中进行功能查询，您能否提供一些有关如何使用 mysql 查询来实现这一点的信息。如果我缺少任何东西，请告诉我。

[编辑]

```
CREATE TABLE `candidatecase` (
  `ID` int(11) NOT NULL AUTO_INCREMENT COMMENT 'Unique ID',
  `CreatedBy` int(11) NOT NULL,
  `UseraccountID` int(11) NOT NULL COMMENT 'User Account ID',
  `ReportReadyID` int(11) DEFAULT NULL COMMENT 'Report Ready ID',
  `DateCreated` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Date Created',
  `InitiatedDate` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT 'Date Initiated',
  `ActualCompletedDate` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT 'Date Completed Case',
  `ProjectedCompletedDate` timestamp NULL DEFAULT '0000-00-00 00:00:00' COMMENT 'Date Projected Finish',
  `CheckpackagesID` int(11) DEFAULT NULL COMMENT 'Default Check Package Auto Assign Once Initiate Start',
  `Alacartepackage1` int(11) DEFAULT NULL COMMENT 'Ala carte Request #2',
  `Alacartepackage2` int(11) DEFAULT NULL COMMENT 'Ala carte Request #3',
  `OperatorID` int(11) NOT NULL COMMENT 'User Account - Operator',
  `Status` int(11) NOT NULL COMMENT 'Status',
  `caseRef` varchar(100) NOT NULL,
  PRIMARY KEY (`ID`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=293 ;

--
-- Dumping data for table `candidatecase`
--

INSERT INTO `candidatecase` (`ID`, `CreatedBy`, `UseraccountID`, `ReportReadyID`, `DateCreated`, `InitiatedDate`, `ActualCompletedDate`, `ProjectedCompletedDate`, `CheckpackagesID`, `Alacartepackage1`, `Alacartepackage2`, `OperatorID`, `Status`, `caseRef`) VALUES
(1, 43, 70, NULL, '2011-07-22 02:29:31', '2011-07-07 07:27:44', '2011-07-22 02:29:31', '2011-07-17 06:53:52', 11, NULL, NULL, 44, 6, ''),
(2, 43, 74, NULL, '2012-04-03 04:17:15', '2011-07-11 07:07:23', '2011-07-13 05:32:58', '2011-07-21 07:01:34', 20, 0, 0, 51, 0, ''),
(3, 43, 75, NULL, '2011-07-29 04:10:07', '2011-07-11 07:27:12', '2011-07-29 04:10:07', '2011-07-21 07:02:14', 20, NULL, NULL, 45, 6, ''),
(4, 43, 78, NULL, '2011-07-18 03:32:27', '2011-07-11 07:51:31', '2011-07-13 02:18:34', '2011-07-21 07:37:53', 20, NULL, NULL, 45, 6, ''),
(5, 43, 76, NULL, '2011-07-29 04:09:19', '2011-07-11 07:51:11', '2011-07-29 04:09:19', '2011-07-21 07:38:30', 20, NULL, NULL, 45, 6, ''),
(6, 43, 77, NULL, '2011-07-18 03:32:49', '2011-07-11 07:51:34', '2011-07-18 02:18:46', '2011-07-21 07:39:00', 20, NULL, NULL, 45, 6, ''),
(7, 43, 79, NULL, '2011-07-18 03:33:02', '2011-07-11 07:53:24', '2011-07-18 01:50:12', '2011-07-21 07:42:57', 20, NULL, NULL, 45, 6, ''),
(8, 43, 80, NULL, '2011-07-29 04:10:38', '2011-07-11 07:53:58', '2011-07-29 04:10:38', '2011-07-21 07:43:14', 20, NULL, NULL, 45, 6, ''),
(9, 43, 81, NULL, '2011-07-18 03:31:54', '2011-07-11 07:53:49', '2011-07-13 02:17:02', '2011-07-21 07:43:43', 20, NULL, NULL, 45, 6, ''),
(11, 43, 88, NULL, '2011-07-18 03:15:53', '2011-07-13 04:57:38', '2011-07-15 08:57:15', '2011-07-23 04:39:14', 12, NULL, NULL, 44, 6, ''),
(13, 43, 90, NULL, '2011-07-26 07:39:24', '2011-07-13 12:16:48', '2011-07-26 07:39:24', '2011-07-23 12:13:50', 15, NULL, NULL, 51, 6, ''),
(63, 43, 176, NULL, '2011-09-13 08:23:13', '2011-08-26 10:00:32', '2011-09-13 08:23:13', '2011-09-05 09:58:47', 41, NULL, NULL, 45, 6, ''),
(62, 43, 174, NULL, '2011-08-24 03:54:30', '2011-08-24 03:53:13', '2011-08-24 03:54:30', '2011-08-29 03:52:48', 17, NULL, NULL, 51, 6, ''),
(61, 43, 173, NULL, '2011-08-24 03:55:05', '2011-08-24 03:53:39', '2011-08-24 03:55:05', '2011-08-29 03:52:36', 17, NULL, NULL, 51, 6, ''),
(60, 43, 172, NULL, '2011-08-24 03:22:41', '2011-08-24 03:21:50', '2011-08-24 03:22:41', '2011-08-29 03:21:11', 17, NULL, NULL, 51, 6, ''),
(59, 43, 171, NULL, '2011-08-24 03:23:19', '2011-08-24 03:22:00', '2011-08-24 03:23:19', '2011-08-29 03:20:57', 17, NULL, NULL, 51, 6, ''); 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-04-26T10:09:41.570

你可能想试试这个：

1.  计算工作日数（从[这里](https://stackoverflow.com/questions/1828948/mysql-function-to-find-the-number-of-working-days-between-two-dates/6762805#6762805)获取）

    `SELECT 5 * (DATEDIFF('2012-12-31', '2012-01-01') DIV 7) + MID('0123444401233334012222340111123400012345001234550', 7 * WEEKDAY('2012-01-01') + WEEKDAY('2012-12-31') + 1, 1)`

    这为您提供了 2012 年的 261 个工作日。

2.  现在您需要知道不是周末的假期

    `SELECT COUNT(*) FROM holidays WHERE DAYOFWEEK(holiday) < 6`

    其结果取决于您的假期表。

3.  我们需要在一个查询中得到它：

    `SELECT 5 * (DATEDIFF('2012-12-31', '2012-01-01') DIV 7) + MID('0123444401233334012222340111123400012345001234550', 7 * WEEKDAY('2012-01-01') + WEEKDAY('2012-12-31') + 1, 1) - (SELECT COUNT(*) FROM holidays WHERE DAYOFWEEK(holiday) < 6)`

    这应该是它。

编辑：**请注意，只有当您的结束日期高于开始日期时，这才能正常工作。**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-26T10:06:01.867

创建一个表，其中包含未来 100 年的所有周末和节假日。

鉴于没有人知道 2052 年的假期是什么，您需要能够指定一天是什么时候是“假期”，无论如何此时您将无法做出准确的功能。只需在每年知道假期时更新您的非工作日表（但您总是会知道周末）。

然后您的查询变为：

```
SELECT DATEFIFF(end_date, start_date) - COALESCE((SELECT COUNT(1) FROM nonWorkDays WHERE nonWorkDays.date BETWEEN start_date AND end_date), 0)
FROM accounts 
```

如果你真的需要编写一个`DATEDIFFWITHOUTWEEKENDSORHOLIDAYS`函数，那么只需使用上面的方法并创建一个函数（关于如何在每个 RDBMS 中创建函数的资源很多）.. 一定要给它一个更好的名字。^_^

您需要解决的一件事是我认为上面某处缺少 +1，例如 DATEDIFF(today, today) 如果今天是周末将返回 -1 而不是返回 0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T10:15:33.740

这样的事情可能会奏效。将所有假期日期和周末日期添加到表中。

```
SELECT 
  DATEDIFF(end_date, start_date) 
FROM table
WHERE date NOT IN (SELECT date FROM holidaydatestable ) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-14T10:49:21.933

**试试这个代码，这将计算不包括周末的天数**

```
 SELECT
       (DATEDIFF(dd, @StartDate, @EndDate)+1)
      -(DATEDIFF(wk, @StartDate, @EndDate) * 2)
from test_tbl where date NOT IN (SELECT date FROM holidaydatestable ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T09:47:31.040

制作一个函数，该函数将在日期之间进行一段时间循环，以增加不是星期六或星期日的天数。

# c++ - 捕捉 SIGVTALRM 信号，cp

> ID：10330837
> 
> 赞同：2
> 
> 时间：2012-04-26T09:38:40.937
> 
> 标签：c++, signals

我正在尝试捕获`SIGVTALRM`sent by `setitimer`，但我不知道为什么它不起作用。这是我的代码：

```
void time(int time) {
    cout << "time" << endl;
    exit(0);
}

int main(void) {
    signal(SIGVTALRM, time);
    itimerval tv;
    tv.it_value.tv_sec = 5;
    tv.it_value.tv_usec = 0;
    tv.it_interval.tv_sec = 5;
    tv.it_interval.tv_usec = 0;
    setitimer(ITIMER_VIRTUAL, &tv, NULL);
    while (true) {
        cout << "waiting" << endl;
    }
    return 0;
} 
```

出于某种原因，它从不调用`time()`- 是因为它没有捕获信号还是因为我不知道一开始就没有发送信号。

这应该很简单。有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T10:05:16.610

你确定它不工作吗？

在我看来一切都很好。可能是你等的还不够。由于您在循环内打印字符串`waiting`并且您正在使用虚拟计时器，因此时钟仅在进程运行时才会滴答作响（不包括 IO 时间）。因此，实际上您的计时器可能会在几（> 5）秒后到期。

尝试注释掉打印部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-16T04:22:51.060

这是由于`signal`功能。如[http://manpages.ubuntu.com/manpages//precise/en/man2/signal.2.html](http://manpages.ubuntu.com/manpages//precise/en/man2/signal.2.html)中所述：

```
The  behavior  of  signal()  varies  across UNIX versions, and has also varied historically across different versions of Linux.  Avoid its use: use sigaction(2) instead. 
```

所以主要的方法应该是：

```
int main(void) {
    itimerval tv;
    struct sigaction sa;

    sigemptyset(&sa.sa_mask);
    sa.sa_flags = 0;
    sa.sa_handler = timer_handler;
    if (sigaction(SIGVTALRM, &sa, NULL) == -1) {
        printf("error with: sigaction\n");
        exit(EXIT_FAILURE);
    }

    tv.it_value.tv_sec = 5;
    tv.it_value.tv_usec = 0;
    tv.it_interval.tv_sec = 5;
    tv.it_interval.tv_usec = 0;
    setitimer(ITIMER_VIRTUAL, &tv, NULL);

    while (true) {
        cout << "waiting" << endl;
    }

    return 0;
} 
```

# xcode - 如何将标签 Core Plot 向右移动？

> ID：10330838
> 
> 赞同：2
> 
> 时间：2012-04-26T09:38:42.930
> 
> 标签：xcode, core-plot, padding

我使用以下方法来显示我的情节的标签：

```
-(CPTLayer *)dataLabelForPlot:(CPTPlot *)plot recordIndex:(NSUInteger)index{ 
 ... 
 CPTTextLayer *label=[[CPTTextLayer alloc] initWithText:stringValue style:textStyle];
 } 
```

每个索引都应该返回标签

我知道可以使用以下方法向上或向下移动标签：

```
plot.labelOffset=10; 
```

问题是：我怎样才能将标签向右移动一点？我试着用

`label.paddingLeft=50.0f;`

但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T21:18:25.093

在您的示例中添加填充确实有效，但可能不是您期望的方式。散点图和条形图将使每个数据点上方的标签居中（具有正偏移）。填充使整个标签更宽，因此当居中时，测试会偏向一边。很难控制，尤其是在标签文本长度不同的情况下。

有一个悬而未决的问题需要解决（[问题 266](http://code.google.com/p/core-plot/issues/detail?id=266)）。不能保证什么时候会修复它，但这是我们正在研究的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-18T18:57:13.543

我遇到了同样的问题并提出了不同的解决方案。

我决定做的是使用 CPTAxisLabel 方法 initWithContentLayer 创建标签：

```
CPTTextLayer *textLayer = [[CPTTextLayer alloc] initWithText:labelStr  style:axisTextStyle];

CGSize textSize = [textLayer sizeThatFits];

// Calculate the padding needed to center the label under the plot record.
textLayer.paddingLeft = barCenterLeftOffset - textSize.width/2.0;

CPTAxisLabel *label = [[CPTAxisLabel alloc] initWithContentLayer:textLayer]; 
```

这里 barCenterLeftOffset 是绘图记录中心的偏移量。

我写了一篇关于这个的文章：

[http://finalize.com/2014/09/18/horizo​​ntal-label-positioning-in-core-plot-and-other-miscellaneous-topics/](http://finalize.com/2014/09/18/horizontal-label-positioning-in-core-plot-and-other-miscellaneous-topics/)

我创建的使用此解决方案的演示项目可以在以下位置找到：

[https://github.com/scottcarter/algorithms](https://github.com/scottcarter/algorithms)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-17T13:56:45.177

您可以继承 CPTTextLayer 并包含偏移量。

```
@interface WPTextLayer : CPTTextLayer

@property (nonatomic) CGPoint offset;

@end

@implementation WPTextLayer

-(void)setPosition:(CGPoint)position
{
    CGPoint p = CGPointMake(position.x + self.offset.x, position.y + self.offset.y);
    [super setPosition:p];
} 
```

然后使用：

```
WPTextLayer *tLayer = [[WPTextLayer alloc] initWithText:@"blah" style:textStyle];
tLayer.offset = CGPointMake(3, -3);
return tLayer; 
```

这可能会产生我不知道的后果，但到目前为止它似乎正在发挥作用。

# ios - 如何让 Airplay 使用加密的 HTTPS 流媒体？

> ID：10330849
> 
> 赞同：2
> 
> 时间：2012-04-26T09:39:10.050
> 
> 标签：ios, encryption, avplayer, airplay

我一直在努力让 AirPlay 与在 AVPlayer 中播放的加密流一起工作。

阅读[Apple 的这一页](http://developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/AirPlayGuide/EncryptionandAuthentication/EncryptionandAuthentication.html)对我没有多大好处。

> 从受保护的 HTTPS 领域提供密钥。在播放开始之前，您的应用可以使用 NSURLConnection 进行身份验证，提供隐藏的凭据。

**我只能让它在模拟器中工作。不在设备上。**

> 通过 HTTPS 使用 cookie。您的应用程序可以连接到 HTTPS 服务器并以应用程序定义的方式对应用程序进行身份验证。然后，您的服务器可以发出适用于关键 URL 的 cookie。您应该将 cookie 设置为在播放完成后很久才过期。然后，服务器必须要求在未来对密钥的 GET 请求中存在有效的会话 cookie。为了获得最大的可靠性，如果到期日期在不久的将来，服务器应在其对未来 GET 请求的响应中更新 cookie 的到期日期。

**由于我没有直接访问服务器设置的权限，因此实际上没有尝试过，但如果没有其他答案出现，我会尝试。**

> 使用应用程序定义的 URL 方案指定 .m3u8 文件中的密钥。应用应该注册一个自定义的 NSURLProtocol 来处理对这些 URL 的请求。然后，播放器在需要加载关键 URL 时回调到您的应用程序；然后，您的应用可以使用安全侧通道获取密钥并将其提供给播放器。

**这似乎不起作用，因为 AVPlayer HTTP 连接完全绕过了 NSURLProtocol 系统。您只是无法拦截 AVPlayer 发出的任何 HTTP 请求。**

如果有人能以与 AVPlayer 和 AirPlay 一起使用的方式解决加密密钥服务问题，我将永远感激不尽。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-11T08:55:42.617

似乎我遇到的麻烦随着 iOS 5.1.1 更新和随后的 Apple TV 更新而消失了。iOS 5.1.1 更新不足以单独解决这个问题，但与随后的 Apple TV 更新一起，一切都很好，而且又漂亮了。

正如我在之前的[问题](https://stackoverflow.com/questions/9000614/how-to-let-avplayer-retrieve-playlist-secured-by-ssl/)中所描述的，现在实现您自己的环回服务器就足够了。

# jquery - 背景图像的 z-index

> ID：10330851
> 
> 赞同：1
> 
> 时间：2012-04-26T09:39:10.520
> 
> 标签：jquery, html, css

我们可以将 z-index 设置为背景属性吗？

我有一个 div，其中包含带有 ajax 请求的动态内容，其中包含带有背景图像的表格。

现在的问题是，在 div 中设置了图像背景的第一个请求表之后。当第二个请求发送时，在 beforeSend 方法中编写一个代码来显示处理图像，同时响应到达 div。但是无法显示处理图像，因为表格背景集中有所有准备好的图像......

问题是 div 背景位于基础级别，被表格背景图像隐藏

我可以以某种方式或任何其他方式使用 Z-Index 来管理它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:42:19.520

可以为处理图像添加z-index，其值高于背景图像的z-index值。

# java - 可编辑的 JCombobox mouseclicked 事件不起作用

> ID：10330854
> 
> 赞同：1
> 
> 时间：2012-04-26T09:39:33.587
> 
> 标签：java, jcombobox, mouselistener

我现在处于一个尴尬的境地，所以我在这里寻求一些专家的建议。我有一个`Editable JComboBox`. 我有实现`actionPerformed`事件，它工作正常。但我有`mouseListener`一个不起作用的工具。

```
component = jcbItemType.getEditor().getEditorComponent();
component.addMouseListener(new java.awt.event.MouseListener() {
    public void mouseClicked(java.awt.event.MouseEvent evt) {
        jcbItemTypeMouseClicked(evt);
    }
    public void mousePressed(java.awt.event.MouseEvent evt) {
        jcbItemTypeMousePressed(evt);
    }
    public void mouseReleased(java.awt.event.MouseEvent evt) {
        jcbItemTypeMouseReleased(evt);
    }
    public void mouseExited(java.awt.event.MouseEvent evt) {
        jcbItemTypeMouseReleased(evt);
    }
    public void mouseEntered(java.awt.event.MouseEvent evt) {
        jcbItemTypeMouseReleased(evt);
    }
}); 
```

我还尝试了以下代码：

```
Component[] comps = jcbItemType.getComponents();
for(int i = 0; i < comps.length; i++)
{    
    comps[i].addMouseListener(new java.awt.event.MouseAdapter() {
        public void mouseClicked(java.awt.event.MouseEvent evt) {
            jcbItemTypeMouseClicked(evt);
        }
        public void mousePressed(java.awt.event.MouseEvent evt) {
            jcbItemTypeMousePressed(evt);
        }
        public void mouseReleased(java.awt.event.MouseEvent evt) {
            jcbItemTypeMouseReleased(evt);
        }
        public void mouseExited(java.awt.event.MouseEvent evt) {
            jcbItemTypeMouseReleased(evt);
        }
        public void mouseEntered(java.awt.event.MouseEvent evt) {
            jcbItemTypeMouseReleased(evt);
        }
    });
} 
```

我知道这`JComboBox`是一个复合元素，因此直接鼠标处理事件将不起作用。但是我使用了单个组件`mouseListener`，但它也不起作用。

有人可以询问`stateChanged`事件，但我想在完全选择项目后加载一些信息，而不是在我只输入项目的 2/3 个字符时加载一些信息。如果它仅在`stateChanged`2/3 个字符之后显示项目信息，则它会负载很重，因为我针对每个项目的信息权重很大。

**那么，当通过鼠标单击选择项目时如何获取事件？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-29T08:23:16.913

以下链接解决了我的问题。

[http://engin-tekin.blogspot.com/2009/10/hrefhttpkfd.html](http://engin-tekin.blogspot.com/2009/10/hrefhttpkfd.html)

**链接中的代码片段如下：**

```
import java.lang.reflect.InvocationTargetException;  
import java.awt.event.MouseAdapter;  
import java.lang.reflect.Field;  
import javax.swing.*;  
import javax.swing.plaf.basic.BasicComboPopup;  
import javax.swing.plaf.basic.BasicComboBoxUI;  
import java.awt.event.MouseEvent;  

/** 
 * User: destiny 
 * Date: Oct 19, 2009 
 * Time: 9:18:34 PM 
 */  
public class JComboPopupMouseListenerDemo {  

    private static void addPopupMouseListener(JComboBox box) {  
        try {  
                  Field popupInBasicComboBoxUI = BasicComboBoxUI.class.getDeclaredField("popup");  
                popupInBasicComboBoxUI.setAccessible(true);  
                BasicComboPopup popup = (BasicComboPopup) popupInBasicComboBoxUI.get(box.getUI());  

                Field scrollerInBasicComboPopup = BasicComboPopup.class.getDeclaredField("scroller");  
                scrollerInBasicComboPopup.setAccessible(true);  
                JScrollPane scroller = (JScrollPane) scrollerInBasicComboPopup.get(popup);  

                scroller.getViewport().getView().addMouseListener(this);  
//                ((JViewport) ((JScrollPane) ((BasicComboPopup) popupInBasicComboBoxUI.get(box.getUI())).getComponents()[0]).getComponents()[0]).getComponents()[0].addMouseListener(this);  
        }  
        catch (NoSuchFieldException e) {  
            e.printStackTrace();  
        }  
        catch (IllegalAccessException e) {  
            e.printStackTrace();  
        }  
    }  

    private static MouseAdapter listener() {  
        return new MouseAdapter(){  
            public void mouseClicked(MouseEvent mouseEvent) {  
                System.out.println("mouseClicked");  
            }  

            public void mousePressed(MouseEvent mouseEvent) {  
                System.out.println("mousePressed");  
            }  

            public void mouseReleased(MouseEvent mouseEvent) {  
                System.out.println("mouseReleased");  
            }  

            public void mouseEntered(MouseEvent mouseEvent) {  
                System.out.println("mouseEntered");  
            }  

            public void mouseExited(MouseEvent mouseEvent) {  
                System.out.println("mouseExited");  
            }  
        };  
    }  

    public static void main(String[] args) throws InvocationTargetException, InterruptedException {  
        JComboBox box = new JComboBox(new String[]{"val 1","val 2","val ......","val 4","val 5","val 6"});  
        box.setEditable(true);  
        addPopupMouseListener(box);  

        JFrame frame = new JFrame();  
        frame.add(box);  
        frame.pack();  
        frame.setVisible(true);  
    }  
} 
```

# jquery - Asual jQuery Address 在 Firefox 中是否存在问题？

> ID：10330855
> 
> 赞同：12
> 
> 时间：2012-04-26T09:39:39.740
> 
> 标签：jquery, firefox, jquery-address

这是我使用 jQuery Address 的第二个项目，我认为 Firefox 有一些奇怪的地方，或者至少我可以弄清楚它在 Firefox 和 Webkit 中有不同的行为。

深度链接时，jQuery Address 应该触发一个更改事件并执行与此状态相关的一段 JavaScript。

对于 /foo/bar 深层链接，如果我将事件对象写到控制台，在 Google Chrome 中，我会触发两个事件：

**jQuery.Event #1**

```
path: "/"
pathNames: Array[0]
queryString: ""
timeStamp: 1335431580471
type: "change"
value: "/" 
```

**jQuery.Event #2**

```
path: "/foo/bar"
pathNames: Array[2]
queryString: ""
timeStamp: 1335431580471
type: "change"
value: "/foo/bar" 
```

但是在 Firefox 中，我只触发了一个事件，它没有考虑当前的 URI：

**jQuery.Event #1**

```
path: "/"
pathNames: Array[0]
queryString: ""
timeStamp: 1335431580471
type: "change"
value: "/" 
```

所以很明显，在 Firefox 中，我想为 /foo/bar URI 打开的灯箱永远不会打开:-(

这是我的 jQuery 地址代码：

```
$.address.crawlable(1).state('/').change(function(event) {
    var page = event.path;
    if (page == '/foo/bar'){
        openLightbox($('#create-popup-template').html());
        create_main();
    }
}); 
```

现在我正在使用一个简单的解决方法让它在 Firefox 中工作，只需添加一个 init 函数来强制在 Firefox 中进行第二个更改事件：

```
$.address.init(function(){
    if ($.browser.mozilla)
         $.address.value(window.location.pathname);
 }); 
```

但这是我第二次必须这样做，感觉不对……我错过了什么吗？

我也已经尝试搞乱内部和外部更改回调，没有机会..

感谢您的帮助，

托马斯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-18T16:44:33.460

我使用 Asual jQuery Adress 插件 1.6，你可以在这里找到：在此处[输入链接描述，](https://github.com/asual/jquery-address/blob/master/src/jquery.address.js)而不是在 Asual 网站上。

在这个版本中，他们删除了可抓取的功能（但它可以被谷歌正常抓取）。另外，您可以使用[http://refresh-sf.com/yui/对其进行压缩](http://refresh-sf.com/yui/)

所以这可能是1.5版本的错误

# mysql - 为什么mysql决定这个子查询是依赖的？

> ID：10330856
> 
> 赞同：3
> 
> 时间：2012-04-26T09:39:47.743
> 
> 标签：mysql, performance, subquery

在 MySQL 5.1.34 服务器上，我遇到了以下令人困惑的情况：

```
mysql> explain select * FROM master.ObjectValue WHERE id IN ( SELECT id FROM backup.ObjectValue ) AND timestamp < '2008-04-26 11:21:59';
+----+--------------------+-------------+-----------------+-------------------------------------------------------------+------------------------------------+---------+------+--------+-------------+
| id | select_type        | table       | type            | possible_keys                                               | key                                | key_len | ref  | rows   | Extra       |
+----+--------------------+-------------+-----------------+-------------------------------------------------------------+------------------------------------+---------+------+--------+-------------+
|  1 | PRIMARY            | ObjectValue | range           | IX_ObjectValue_Timestamp,IX_ObjectValue_Timestamp_EventName | IX_ObjectValue_Timestamp_EventName | 9       | NULL | 541944 | Using where | 
|  2 | DEPENDENT SUBQUERY | ObjectValue | unique_subquery | PRIMARY                                                     | PRIMARY                            | 4       | func |      1 | Using index | 
+----+--------------------+-------------+-----------------+-------------------------------------------------------------+------------------------------------+---------+------+--------+-------------+
2 rows in set (0.00 sec)

mysql> select * FROM master.ObjectValue WHERE id IN ( SELECT id FROM backup.ObjectValue ) AND timestamp < '2008-04-26 11:21:59';
Empty set (2 min 48.79 sec)

mysql> select count(*) FROM master.ObjectValue;
+----------+
| count(*) |
+----------+
| 35928440 |
+----------+
1 row in set (2 min 18.96 sec) 
```

*   访问所有记录只需要 2 分钟，怎么可能需要 3 分钟检查 500000 条记录？
*   如何将单独数据库上的子查询分类为依赖？
*   我能做些什么来加快这个查询？

更新：

需要很长时间的实际查询是 DELETE，但您无法对此进行解释；DELETE 是我使用子选择的原因。我现在已经阅读了文档并发现了语法“DELETE FROM t USING ...”重写查询：

```
DELETE FROM master.ObjectValue 
WHERE timestamp < '2008-06-26 11:21:59' 
AND id IN ( SELECT id FROM backup.ObjectValue ) ; 
```

进入：

```
DELETE FROM m 
USING master.ObjectValue m INNER JOIN backup.ObjectValue b ON m.id = b.id 
WHERE m.timestamp < '2008-04-26 11:21:59'; 
```

将空备份的时间从几分钟减少到 0.01 秒。ObjectValue。

谢谢大家的好建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T09:56:20.607

依赖子查询将您的外部查询减慢到爬行（我想您知道这意味着它在正在查看的数据集中找到的每行运行一次）。

您不需要那里的子查询，不使用子查询会大大加快您的查询速度：

```
SELECT m.*
FROM master.ObjectValue m
JOIN backup.ObjectValue USING (id)
WHERE m.timestamp < '2008-06-26 11:21:59' 
```

MySQL 经常将子查询视为依赖，即使它们不是。我从来没有真正理解过它的确切原因——也许仅仅是因为查询优化器未能将其识别为独立的。我从不费心查看更多细节，因为在这些情况下，您几乎总是可以将其移至`FROM`修复它的子句。

例如：

```
DELETE FROM m WHERE m.rid IN (SELECT id FROM r WHERE r.xid = 10)
// vs
DELETE m FROM m WHERE m.rid IN (SELECT id FROM r WHERE r.xid = 10) 
```

前者会产生一个依赖子查询，并且可能非常慢。后者将告诉优化器隔离子查询，从而避免表扫描并使查询运行得更快。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T09:56:32.267

> 访问所有记录只需要 2 分钟，怎么可能需要 3 分钟检查 500000 条记录？

`COUNT(*)``COUNT(1)`在 MySQL中总是转换为。所以它甚至不必输入每条记录，而且，我想它使用内存索引来加快速度。在长时间运行的查询中，您使用范围 ( `<`) 和`IN`运算符，因此对于它访问的每条记录，它必须做额外的工作，特别是因为它识别子查询是依赖的。

> 如何将单独数据库上的子查询分类为依赖？

好吧，它是否在单独的数据库中并不重要。如果子查询依赖于外部查询中的值，则子查询是依赖的，在你的情况下你仍然可以这样做......但你不这样做，所以它被归类为依赖子查询确实很奇怪。也许这只是 MySQL 中的一个错误，这就是为什么它需要这么长时间 - 它为外部查询选择的每条记录执行内部查询。

> 我能做些什么来加快这个查询？

首先，尝试使用`JOIN`：

```
SELECT master.*
FROM master.ObjectValue master
JOIN backup.ObjectValue backup
  ON master.id = backup.id
  AND master.timestamp < '2008-04-26 11:21:59'; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-04-26T10:26:32.713

请注意它是如何说子查询只有 1 行的？显然不止1行。这表明 mysql 一次只加载 1 行。mysql 可能试图做的是“优化”子查询，以便它只加载子查询中也存在于主查询中的记录，一个依赖子查询。这就是连接的工作方式，但是您对查询的表述方式迫使您逆转优化的连接逻辑。

您已经告诉 mysql 加载备份表（子查询），然后将其与主表“timestamp < '2008-04-26 11:21:59'”的过滤结果进行匹配。Mysql 确定加载整个备份表可能不是一个好主意。所以mysql决定使用master的过滤结果来过滤backup查询，但是尝试过滤subquery时master查询还没有完成。因此，它需要在从主查询加载每条记录时进行检查。因此，您的依赖子查询。

正如其他人提到的，使用连接，这是正确的方法。加入人群。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-06T09:00:43.163

真正的答案是，不要使用 MySQL，它的优化器是垃圾。切换到 Postgres，从长远来看，它将为您节省时间。

对于每个说“使用 JOIN”的人来说，这只是 MySQL 人群的无稽之谈，他们 10 年来一直拒绝修复这个可怕的错误。

# magento - Magento 会话

> ID：10330863
> 
> 赞同：0
> 
> 时间：2012-04-26T09:40:28.430
> 
> 标签：magento

谁能告诉我magento如何创建会话？？？我每天有 600 个用户的 magento，会话/coockie TTL 为 1 周。其中 60% 的用户是复出的日常用户。会话目录有 285580 个会话文件。所有文件的日期不超过 1 周。

那么我们从哪里有这么多 600 个用户的会话文件呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T19:55:59.343

只是一个理论，表现不佳的机器人正在爬取您的网站（即没有持久性 cookie），Magento 正在为每个页面视图创建一个新会话。

将您的 apache 日志与会话文件进行比较以确认，然后在 /robots.txt 文件中禁止有问题的机器人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-03T02:12:26.790

会话是 PHP 会话，而不是 Magento。

您在这里有几个选择：

1.  为您的服务器使用某种代理，如 Cloudflare ( [https://www.cloudflare.com/](https://www.cloudflare.com/) )，它具有 DDoS 保护，因此如果问题是恶意的，这将提供某种保护。

2.  浏览您的 apache 日志文件并确定流量的来源，具体取决于您的 linux 发行版，这将位于 /var/log/httpd/access_log 之类的位置。

我使用类似这样的方法来获取最后 20 行，但如果找不到，则需要 grep。

```
 $ tail /var/log/httpd/access_log -n20 
```

然后设置 robots.txt 来限制机器人，或者设置防火墙规则来阻止恶意流量。

3.  Magento 允许（并鼓励）使用 Redis 进行会话和缓存管理。以下 local.xml 示例将 10.0.0.2 作为您的数据库服务器，将 10.0.0.3 作为您的 redis 服务器。

    ```
    <?xml version="1.0"?>
    <!--
    /**
     * Magento
     *
     * NOTICE OF LICENSE
     *
     * This source file is subject to the Academic Free License (AFL 3.0)
     * that is bundled with this package in the file LICENSE_AFL.txt.
     * It is also available through the world-wide-web at this URL:
     * http://opensource.org/licenses/afl-3.0.php
     * If you did not receive a copy of the license and are unable to
     * obtain it through the world-wide-web, please send an email
     * to license@magentocommerce.com so we can send you a copy immediately.
     *
     * DISCLAIMER
     *
     * Do not edit or add to this file if you wish to upgrade Magento to         newer
     * versions in the future. If you wish to customize Magento for your
     * needs please refer to http://www.magentocommerce.com for more         information.
     *
     * @category   Mage
     * @package    Mage_Core
     * @copyright  Copyright (c) 2008 Irubin Consulting Inc. DBA Varien         (http://www.varien.com)
     * @license    http://opensource.org/licenses/afl-3.0.php  Academic Free         License (AFL 3.0)
     */
    -->
    <config>
        <global>
            <install>
                <date><![CDATA[Wed, 18 Jan 2012 06:19:25 +0000]]></date>
            </install>
            <crypt>
                <key><![CDATA[{some crypt key}]]></key>
            </crypt>
            <disable_local_modules>false</disable_local_modules>
            <resources>
                <db>
                    <table_prefix><![CDATA[]]></table_prefix>
                </db>
                <default_setup>
                    <connection>
                        <host><![CDATA[10.0.0.2]]></host>
                        <username><![CDATA[dbusername]]></username>
                        <password><![CDATA[dbpassword]]></password>
                        <dbname><![CDATA[dbschema]]></dbname>
                        <initStatements><![CDATA[SET NAMES utf8]]></initStatements>
                        <model><![CDATA[mysql4]]></model>
                        <type><![CDATA[pdo_mysql]]></type>
                        <pdoType><![CDATA[]]></pdoType>
                        <active>1</active>
                    </connection>
                </default_setup>
            </resources>
            <session_save><![CDATA[db]]></session_save>
            <redis_session>
                <host>10.0.0.3</host>
                <port>6379</port>
                <password>redispassword</password>
                <timeout>2.5</timeout>
                <persistent></persistent>
                <db>2</db>
                <compression_threshold>2048</compression_threshold>
                <compression_lib>gzip</compression_lib>
                <log_level>1</log_level>
                <max_concurrency>6</max_concurrency>
                <break_after_frontend>5</break_after_frontend>
                <break_after_adminhtml>30</break_after_adminhtml>
                <bot_lifetime>7200</bot_lifetime>
            </redis_session>   
        <cache>
            <backend>Mage_Cache_Backend_Redis</backend>
            <backend_options>
                <server>10.0.0.3</server>
                <port>6379</port>
                <persistent></persistent>
                <database>1</database>
                <password>redispassword</password>
                <force_standalone>0</force_standalone>
                <connect_retries>3</connect_retries>    
                <read_timeout>10</read_timeout>      
                <automatic_cleaning_factor>0</automatic_cleaning_factor> 
                <compress_data>1</compress_data> 
                <compress_tags>1</compress_tags> 
                <compress_threshold>20480</compress_threshold>
                <compression_lib>gzip</compression_lib>
                <use_lua>0</use_lua>
            </backend_options>
        </cache>    
    </global>
        <admin>
            <routers>
                <adminhtml>
                    <args>
                        <frontName><![CDATA[admin]]></frontName>
                    </args>
                </adminhtml>
            </routers>
        </admin>
    </config> 
    ```

除此之外，您总是可以查看您的会话超时，看到它们都不到一周，似乎正在进行一些会话清理，但至于为什么有这么多会话，这可能是一个糟糕的问题设置负载均衡器（会在客户端看到会话/购物车问题），或者类似于 PHP 的超时问题。

# session - 如何在控制器中设置会话的过期时间？

> ID：10330865
> 
> 赞同：0
> 
> 时间：2012-04-26T09:40:28.820
> 
> 标签：session, symfony, session-timeout

我需要在控制器中设置一个过期时间为 5 分钟的会话。我该怎么做？我需要类似的东西：

```
$this->container->get('session')->set('mysession', 'value', 'expiration'); 
```

以 symfony2 的方式？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T09:08:45.477

假设您的会话已经创建，您可以通过以下方式实现您的目标：

```
$this->container->get('session')->migrate($destroy = false, $lifetime = null); 
```

`$destroy`：是否删除旧会话或将其留给垃圾回收。

`$lifetime`：设置会话 cookie 的 cookie 生命周期。空值将保持系统设置不变，0 将 cookie 设置为随着浏览器会话过期。时间以秒为单位，不是 Unix 时间戳。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T13:28:34.513

此功能是[最近](https://github.com/symfony/symfony/commit/b9de0be3499c938926401219711353476ed100c9)添加的。您可以更新到此提交或补丁。从代码看来，您可以通过以下方式设置到期时间，

```
$this->container->get('session')->getMetadataBag()->stampNew(300); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-11T11:43:20.453

要控制活动会话的时间（以及空闲时间），您必须以这种方式在控制器中执行此操作（摘自：官方文档中的[会话配置）：](http://symfony.com/doc/master/components/http_foundation/session_configuration.html#session-lifetime)

```
$session->start();
if (time() - $session->getMetadataBag()->getCreated() > $maxTime) {
  $session->invalidate();
  throw new SessionExpired(); // redirect to expired session page
} 
```

当时间到达您的 $maxTime 会话时“关闭”。您可以将此代码作为函数放在应用程序的后端，以从不同的方法调用来控制时间。

# c# - 使用 MVVM 模型时如何在 WPF 中使用 WndProc？

> ID：10330866
> 
> 赞同：4
> 
> 时间：2012-04-26T09:40:31.690
> 
> 标签：c#, wpf, mvvm, wndproc

谁能帮帮我吗？我想在 WPF 中使用 WndProc，但我不想在 MainWindow.xaml.cs 中使用它，如下所示：

```
 public MainWindow()
    {
        InitializeComponent();
    }

    protected override void OnSourceInitialized(EventArgs e)
    {
        base.OnSourceInitialized(e);
        HwndSource source = PresentationSource.FromVisual(this) as HwndSource;
        source.AddHook(WndProc);
        _windowHandle = source.Handle.ToInt32();
    } 
```

我想在不同的课程中使用它，原因是 uEye 相机通过消息进行通信，我需要“捕捉”它们。因为我使用的是主视图 ViewModel 模型，所以我不想在 MainWindow.xaml.cs 中输入代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T10:18:56.550

MVVM 并不是说​​不能在 View 层写代码。它说您必须编写代码才能访问 ViewModel 中的 Model 并尝试尽可能简单地保持 View 和 ViewModel 之间的连接（通常使用绑定）。

在这种情况下，您正在编写视图层代码以访问作为视图层一部分的 WndProc。

所以在我看来，您的代码完全符合 MVVM。

# mysql - 我如何在 MySQL 中获取快速数据？

> ID：10330871
> 
> 赞同：-1
> 
> 时间：2012-04-26T09:40:54.037
> 
> 标签：mysql

我有一个包含 100,00,000 条或更多记录的消息表，我如何运行查询并获取快速数据。简单的查询是`select title,message from messages`请告诉我正确的查询来快速检索数据。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T09:44:13.777

按某列过滤您的结果并在该过滤列上放置一个索引，例如，

```
SELECT title,message from messages
WHERE `date` > somedate 
```

和相应的索引

```
CREATE INDEX dateIndex ON messages ( `date` ); 
```

我认为您不想获得所有 10^7 行，对吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-26T09:43:52.140

在如此广泛的问题上，答案不可能非常具体 - 所以这是广泛的答案：

[设置正确的索引列](http://dev.mysql.com/doc/refman/5.0/en/create-index.html)（`title`以及`message`您的示例）并[`EXPLAIN`](http://dev.mysql.com/doc/refman/5.5/en/explain.html)在您的查询中使用以查看是否使用了这些索引。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T09:42:43.543

在列上添加索引`title`和`message`.

```
CREATE INDEX title_message_index ON messages (title, message); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-26T09:49:50.193

使用 INDEX 将极大地帮助优化 sql 操作。检查[这个](http://dev.mysql.com/doc/refman/5.0/en/create-index.html)

# window - Applescript：如何获取所有空间中进程的窗口计数？

> ID：10330876
> 
> 赞同：1
> 
> 时间：2012-04-26T09:41:08.803
> 
> 标签：window, applescript

将 Microsoft Office 更新到最新版本会导致每隔几个小时出现一次弹出错误。“此时无法接收邮件。” 只有重新启动应用程序才能使错误消失。很多人似乎都没有解决这个问题，所以我（一个 Windows 程序员）决定编写我的第一个 AppleScript。

首先，我尝试获取 Office 的窗口数：

```
tell application "Microsoft Outlook" to display dialog (count of windows) 
```

返回 1 这不好。这是否意味着弹出对话框不被 OSX 视为窗口？唔。似乎不太可能。

其次，我试图从进程中获取窗口计数：

```
tell application "System Events" to tell process "Microsoft Outlook" to display dialog (count of windows) 
```

返回 2\. 太好了。窗口 1 是我需要的窗口，我编写脚本、运行它并完美运行……直到我从 Outlook 所在的空间更改为另一个空间。从窗口的新空间计数返回 0。在进一步研究中，AppleScript 的 Lion 中似乎不包含空间模块。

任何人都知道我如何计算所有空间中的进程窗口？是否有另一种方法来检测弹出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T12:54:46.573

您可能需要激活应用程序：

```
activate application "Microsoft Outlook"
tell application "System Events"
    tell process "Microsoft Outlook"
        if accessibility description of window 1 is "alert" then
            beep
            -- enter rest of your code
        end if
    end tell
end tell 
```

# jquery - 带有 JQuery 砌体和无限滚动的 imagesLoaded 方法

> ID：10330878
> 
> 赞同：0
> 
> 时间：2012-04-26T09:41:22.407
> 
> 标签：jquery, tumblr, jquery-masonry, infinite-scroll

我发现了这篇文章：[imagesLoaded method not working with JQuery masonry and infinite scroll](https://stackoverflow.com/questions/9766515/imagesloaded-method-not-working-with-jquery-masonry-and-infinite-scroll)

它显示了如何使用带有 JQuery 砌体和无限滚动的 imagesLoaded 方法的答案

我想知道的是，是否有人有一个可以做到这一点的 Tumblr 主题？我想我错过了一些东西，因为砖石和无限滚动不起作用。我想我错过了最初调用该函数的脚本。

# c# - 单击确定按钮时防止 ShowDialog() 返回

> ID：10330882
> 
> 赞同：16
> 
> 时间：2012-04-26T09:41:36.980
> 
> 标签：c#, winforms, dialog, showdialog

我有一个对话框，我想阻止单击 OK 按钮时关闭，但它会返回，即使 AcceptButton 属性设置为 none 而不是我的 OK 按钮。阻止它关闭的最佳方法是什么？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-04-26T09:46:30.043

实际上，您正在更改错误的属性。你当然想[`AcceptButton`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.acceptbutton.aspx)成为确定按钮。此属性确定哪个是 Windows 术语中的**默认**按钮。那是当您敲击`ENTER`键盘时按下的按钮。通过更改`AcceptButton`，您只是破坏了对话框的键盘界面。您不会以任何方式影响按下按钮时发生的事情。

您需要做的是将[`DialogResult`](http://msdn.microsoft.com/en-us/library/system.windows.forms.button.dialogresult.aspx)按钮的属性设置为，`DialogResult.None`因为这决定了按下按钮是否关闭表单。然后，在按钮的单击处理程序中，您需要决定如何响应按钮按下。我希望，如果对话框验证成功，您应该通过设置表单的[`DialogResult`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.dialogresult.aspx)属性来关闭对话框。例如

```
private void OKbuttonClick(object sender, EventArgs e)
{
    if (this.CanClose())
        this.DialogResult = DialogResult.OK;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-04-26T09:44:30.400

停止此行为的最佳方法是在设计时将 OK 按钮的 DialogResult 属性更改为`DialogResult.None`属性窗口中。

此外，如果您已经在 OK 按钮的单击事件中有一些代码，您可以更改表单 DialogResult。

```
private void comOK_Click(object sender, EventArgs e)
{
    // your code .....

    // Usually this kind of processing is the consequence of some validation check that failed
    // so probably you want something like this
    if(MyValidationCheck() == false)
    {
        // show a message to the user and then stop the form closing with
        this.DialogResult = DialogResult.None;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T09:44:28.153

您还需要删除`DialogResult`按钮本身的 ，在按钮的属性窗口中将其设置为`None`。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.button.dialogresult.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.button.dialogresult.aspx)

> 如果此属性的 DialogResult 设置为 None 以外的任何值，并且如果父窗体是通过 ShowDialog 方法显示的，则单击该按钮将关闭父窗体，而无需连接任何事件。

显然，现在您的按钮不会执行任何操作，因此您需要为该`Click`事件注册一个处理程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-27T03:28:28.040

最佳实践是实际将 Ok 按钮设置为禁用，而不是不响应用户输入。

DialogResult 属性应该根据表单设置为 Ok 或 Yes，AcceptButton 也应该链接到 Ok。

我通常在所有对话框上创建一个函数，并在用户与数据交互时调用它。

`void RefreshControls() { button.Enabled = this.ValidateInput(); }`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-10-12T18:10:16.757

```
 static class Program
    {
        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);

            Form2 fLogin = new Form2();
            if (fLogin.ShowDialog() == DialogResult.OK)
            {
                Application.Run(new Form1());
            }
            else
            {
                Application.Exit();
            }
        }
    }

public partial class Form2 : Form
    {
        public Form2()
        {
            InitializeComponent();
        }

        private void btnKlik_Click(object sender, EventArgs e)
        {
            this.DialogResult = DialogResult.OK;
        }
    }

 public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
    } 
```

# javascript - 如何获取操作 ID 以删除时间线上先前发布的操作

> ID：10330885
> 
> 赞同：0
> 
> 时间：2012-04-26T09:41:44.397
> 
> 标签：javascript, facebook-graph-api, facebook-opengraph

我正在使用以下代码在时间轴上发布操作

```
<script type="text/javascript">
function read()
{
FB.api('/me/app_namespace:read' + 
'?article=http://example.com/test.php&access_token=','post',
function(response) {
var msg = 'Error occured';
if (!response || response.error) {
if (response.error) {
msg += "\n\nType: "+response.error.type+"\n\nMessage: "+response.error.message;
}
alert(msg);
} 
else {

alert('Post was successful! Action ID: ' + response.id);
}
});
}
</script> 
```

现在我想使用下面的代码来删除动作，但问题是不知道如何从上面的代码中保存“动作 id”，以便它可以在下面的代码中使用。

```
<script type="text/javascript">

function deleteAction()
{
  FB.api(
    '/actionid',
    'delete',
    function(response) {
       alert('action deleted')
    });
}
</script> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-28T19:03:21.613

这取决于，您是要在以后的会话或当前会话中删除该操作吗？在当前会话本身中，您可能可以简单地将其存储在一个变量中。例如：

```
function read() 
{
    FB.api('/me/app_namespace:read' + 
    '?article=http://example.com/test.php&access_token=','post',
    function(response) {
    var msg = 'Error occured';
    if (!response || response.error) {
    if (response.error) {
    msg += "\n\nType: "+response.error.type+"\n\nMessage: "+response.error.message;
    }
    alert(msg);
    } 
   else {

   alert('Post was successful! Action ID: ' + response.id);
    var idToDeleteLater = response.id;
}
});
}

 function deleteAction()
{
  FB.api(
    '/'+idToDeleteLater,
    'delete',
    function(response) {
       alert('action deleted')
    });
} 
```

如您所见，这非常简单，您所做的只是将 actionID 存储在一个变量中。您可以将多个 ID 存储在一个数组或其他东西中。

另一方面，如果您想在以后的会话中删除操作（不太可能是“读取”操作），那么您需要将这些操作 ID 存储在数据库或其他东西中，并在删除之前从那里提取操作。

# vb.net - 为什么 RowLeave 在 CellLeave/CellValidating 之前触发？

> ID：10330887
> 
> 赞同：0
> 
> 时间：2012-04-26T09:42:03.227
> 
> 标签：vb.net, datagridview

我的 datagridview 的 RowLeave 事件下有一个更新语句。在我更新它之前，我需要验证单元格是否有空值。但是每当我将焦点移到另一行时，在 CellLeave/CellValidating 之前首先调用 RowLeave。

离开一行时是否有另一种验证单元格的方法？

注意：将单元格留在同一行中不是问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-02T18:14:33.987

好吧，您的应用程序按设计运行，看看您是否可以收听 cellexitEditmode 或单元格验证性质的内容（不完全确定这些都在那里）。最佳实践是，如果行代表和绑定的对象说您的行代表一个订单并且您的网格绑定到一个订单集合。该单元格将是一个属性，您可以在属性更改时验证该顺序。

# java - simjava2中的分布式调度算法MTTMEL模拟

> ID：10330892
> 
> 赞同：1
> 
> 时间：2012-04-26T09:42:14.693
> 
> 标签：java, eclipse, scheduling, distributed

在我的模拟中，我有一个来源（调度员）和 4 个接收者。我为两层（tier1 和 tier2）做了两个水槽。前 3 个接收器是 tier1_sink 的实例（具有一个“输入”端口和一个“输出”端口），最后一个接收器是 tier2_sink 的实例（具有三个“输入”端口 in0、in1 和 in2）发送者是源的实例with（三个“输出”，即 out0、out1 和 out2 端口）。我能够将发送方的输出端口连接到第 1 层的接收方输入端口，但是在将第 1 层中每个接收器的输出端口链接到第 2 层中的接收器时出现运行时错误。我还尝试通过传递该索引的索引然后链接如下来为每个新实例提供唯一的端口 ID：

```
 Sim_system.link_ports("Reciever1", "out"+1, "Receiver4", "in0");
    Sim_system.link_ports("Reciever2", "out"+2, "Receiver4", "in1");
    Sim_system.link_ports("Reciever3", "out"+3, "Receiver4", "in2"); 
```

但这对我也不起作用。我知道 Costas（simjava2 的作者）在这里很活跃。请帮帮我。

# android - 适用于只有 3 个字母代码的语言的 Android 资源

> ID：10330893
> 
> 赞同：2
> 
> 时间：2012-04-26T09:42:15.417
> 
> 标签：android, locale

在我的 android 应用程序中尝试为[Sakha 语言](http://en.wikipedia.org/wiki/Sakha_language)添加本地化资源时，我不断收到以下消息错误：

```
[aapt] invalid resource directory name: /Users/yuvipanda/code/WikipediaMobile/res/values-bho

BUILD FAILED
/Users/yuvipanda/adk/tools/ant/build.xml:539: The following error occurred while executing this line:
/Users/yuvipanda/adk/tools/ant/build.xml:568: null returned: 1 
```

尝试为*任何*三个字母的语言代码添加变体都会给我同样的错误（`values-bho`、、、`values-kbd`等`values-sah`）。

是否有我遗漏的技巧，或者 Android 不支持对只有 3 个字母语言代码的语言进行本地化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:54:47.910

从开发人员指南中的[提供替代资源](http://developer.android.com/guide/topics/resources/providing-resources.html#AlternativeResources)来看，Android 似乎只支持两个字母的[ISO 639-1](http://www.loc.gov/standards/iso639-2/php/code_list.php)语言代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-25T03:42:36.360

包含三个字母语言代码的应用程序的命名约定不同。不要将资源放在文件夹中`values-bho`，而是将它们放入名为`values-b+bho`. 将`-b+`以下语言标签标识为与[BCP 47](https://en.wikipedia.org/wiki/IETF_language_tag)（语言代码、方言、地区、脚本和厨房水槽的其余部分）有关，而不是 ISO 639-1（两个字母代码）。

# mysql - sql查询将年份设置为列名

> ID：10330898
> 
> 赞同：6
> 
> 时间：2012-04-26T09:42:26.500
> 
> 标签：mysql, sql

通过编写以下查询

```
SELECT item_name, YEAR( DATE ) , SUM( item_sold_qty ) 
FROM item
JOIN sales ON item.id = sales.item_number
GROUP BY YEAR( DATE ) , item_name
ORDER BY item_name 
```

我能够得到以下结果

```
item_name   YEAR( DATE )    SUM( item_sold_qty )
pencil          2011              22
pencil          2012              44
eraser          2012              22
eraser          2011              11
pen             2012              66
pen             2011              33
nib             2012              88
nib             2011              44 
```

相反，我希望通过以下方式获得结果

```
 item_name      2011    2012
    pencil       22      44            
    eraser       11      22                   
    pen          33      66                  
    nib          44      88 
```

我不太擅长 sql，也不知道如何将年份设置为列名。需要帮忙。

**注意** :: 我的数据库有 2 个表。销售表的日期列具有不同的日期，如 2012-03-01、2012-04-02、2011-07-03 等...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-04-26T09:46:24.647

也许是这样的：

```
SELECT 
    item_name, 
    SUM(CASE WHEN YEAR( DATE )=2011 THEN item_sold_qty ELSE 0 END) AS '2011',
    SUM(CASE WHEN YEAR( DATE )=2012 THEN item_sold_qty ELSE 0 END) AS '2012'
FROM 
    item
JOIN sales ON item.id = sales.item_number
GROUP BY
    item_name
ORDER BY 
    item_name 
```

**编辑**

如果你想要其他年份并且仍然总结它们。然后你可以这样做：

```
SELECT 
    item_name, 
    SUM(CASE WHEN YEAR( DATE )=2011 THEN item_sold_qty ELSE 0 END) AS '2011',
    SUM(CASE WHEN YEAR( DATE )=2012 THEN item_sold_qty ELSE 0 END) AS '2012',
    SUM(CASE WHEN NOT YEAR( DATE ) IN (2011,2012) THEN item_sold_qty ELSE 0 END) AS 'AllOtherYears'
FROM 
    item
JOIN sales ON item.id = sales.item_number
GROUP BY
    item_name
ORDER BY 
    item_name 
```

**编辑2**

如果你有很多年并且你不想继续增加年数。然后你需要使用动态sql。这意味着您连接 sql 的 varchar 然后执行它。

有用的参考资料：

*   [具有基于单列数据的动态标题的 MySQL 数据透视表](https://stackoverflow.com/questions/6158230/mysql-pivot-table-with-dynamic-headers-based-on-single-column-data)
*   [如何在 MySQL 存储过程中使用动态 SQL](https://stackoverflow.com/questions/190776/how-to-have-dynamic-sql-in-mysql-stored-procedure)
*   [MySQL/数据透视表](http://en.wikibooks.org/wiki/MySQL/Pivot_table)
*   [MYSQL - 行到列](https://stackoverflow.com/questions/1241178/mysql-rows-to-columns)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:58:04.583

上面的答案会起作用，但每年添加一个案例可能合适，也可能不合适。如果您在 PHP 平台上，您可以像这样更改现有数组的布局

```
foreach($items as $item)
{
    $item_names[$item[item_name]][$item[year]] += $item[item_sold_qty];
} 
```

这将创建一个数组，如下所示：

```
Array
(
    [pencil] => Array
        (
            [2011] => 22
            [2012] => 44
        )

    [eraser] => Array
        (
            [2012] => 22
            [2011] => 11
        )

    [pen] => Array
        (
            [2012] => 66
            [2011] => 33
        )

    [nib] => Array
        (
            [2012] => 88
            [2011] => 44
        )

) 
```

还要更改您的原始查询以为变量分配更好的名称：

```
SELECT item_name, YEAR( DATE ) as year , SUM( item_sold_qty ) as item_sold_qty
FROM item
JOIN sales ON item.id = sales.item_number
GROUP BY YEAR( DATE ) , item_name
ORDER BY item_name 
```

以上假设您的 mysql 结果数组如下所示：

```
Array
(
    [0] => Array
        (
            [item_name] => pencil
            [year] => 2011
            [item_sold_qty] => 22
        )

    [1] => Array
        (
            [item_name] => pencil
            [year] => 2012
            [item_sold_qty] => 44
        )

    [2] => Array
        (
            [item_name] => eraser
            [year] => 2012
            [item_sold_qty] => 22
        )

    [3] => Array
        (
            [item_name] => eraser
            [year] => 2011
            [item_sold_qty] => 11
        )

    [4] => Array
        (
            [item_name] => pen
            [year] => 2012
            [item_sold_qty] => 66
        )

    [5] => Array
        (
            [item_name] => pen
            [year] => 2011
            [item_sold_qty] => 33
        )

    [6] => Array
        (
            [item_name] => nib
            [year] => 2012
            [item_sold_qty] => 88
        )

    [7] => Array
        (
            [item_name] => nib
            [year] => 2011
            [item_sold_qty] => 44
        )

) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T10:04:42.170

这里：

```
SELECT
    i.item_name, 
    SUM(s1.item_sold_qty) AS '2011',
    SUM(s2.item_sold_qty) AS '2012'

FROM item i
     LEFT JOIN sales s1 ON (i.id = s1.item_number AND YEAR(s1.DATE) = 2011)
     LEFT JOIN sales s2 ON (i.id = s2.item_number AND YEAR(s2.DATE) = 2012)

GROUP BY i.item_name
ORDER BY i.item_name 
```

当然，您必须添加尽可能多的连接，因为您想搜索多少年......

# qt - 如何从 Qt WebView 中的失败 url 加载中获取错误消息

> ID：10330899
> 
> 赞同：2
> 
> 时间：2012-04-26T09:42:27.697
> 
> 标签：qt, signals, qml

假设我有一个基本的 QML 文件，它监听 onLoadFailed 信号，如下所示：

```
import QtQuick 1.1
import QtWebKit 1.0

WebView
{
  onLoadFailed: {

  }

  url: "bogus_url"
} 
```

在这个例子中，我应该得到 404 或 500。**我应该在 onLoadFailed 中输入什么来输出返回的错误消息？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-21T15:52:13.997

恐怕您无法使用简单的 QML WebView 来做到这一点。

您可以使用QT 论坛上此[线程](http://qt-project.org/forums/viewthread/3754)中描述的 [bad] 技巧。

否则，您必须制作自己的 QDeclarativeItem 并使用您需要的所有信息来扩展 WebView。

# internet-explorer - PDF 与 IE 中的屏蔽、下拉菜单重叠

> ID：10330904
> 
> 赞同：1
> 
> 时间：2012-04-26T09:42:38.783
> 
> 标签：internet-explorer, pdf, drop-down-menu, mask, overlap

我有一个需要显示 pdf/html 的屏幕。所以我正在使用 iframe 内容来显示其中的 PDF 或 HTML。每当需要时，我需要在顶部显示一个弹出窗口来遮盖整个屏幕。这在所有地方都很酷。

问题是，仅在 Internet Explorer 中，如果 iframe 内容中存在 PDF，则屏蔽不会出现在 pdf 之上，而是 pdf 与屏蔽、弹出窗口、下拉菜单重叠。

请让我们知道如何解决这个问题。

提前致谢。

# php - 如何在我自己的墙上发布“评论” - Facebook

> ID：10330907
> 
> 赞同：0
> 
> 时间：2012-04-26T09:42:48.117
> 
> 标签：php, facebook, facebook-graph-api

PHP/Facebook 中非常简单的任务。我希望能够在我自己的页面上发表评论，

目前我已经下载并使用了 php_facebook graph api，并且能够连接到 FB 并获取我的用户数据。但是我如何发表评论？

我想要类似的东西

```
$facebook->postOnWall('Hello World!'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T10:33:50.440

[http://developers.facebook.com/docs/reference/plugins/comments/](http://developers.facebook.com/docs/reference/plugins/comments/)

# android - 位图和内存问题，怎么办？

> ID：10330915
> 
> 赞同：0
> 
> 时间：2012-04-26T09:43:08.467
> 
> 标签：android, memory, bitmap

我正在将棋盘游戏移植到 Android。板本身是一个 1000x1000 的位图，在 png 格式中大约需要 250k。对于小屏幕设备上的用户，它可以缩放和拖动，只需以下代码：

```
Bitmap scaledBitmap = Bitmap.createBitmap(mBoardBitmap, left, top, width, width, matrix, true);
board.setBackgroundDrawable(new BitmapDrawable(getResources(), scaledBitmap)); 
```

您注意到到目前为止我有一个成员 mBoardBitmap，我用它来加载我的 1000x1000 位图 onCreate()。当用户移动或缩放时，加载一次似乎比重复加载更合适。我开始质疑这种策略，因为我需要在我的板上添加层，因此每层都有一个位图。

那么我应该加载几个 1000x1000 位图（1 MB 内存，除非我弄错了）并将它们保留在那里，还是应该在每次用户触摸板时重新加载它们，这可能很频繁？

其次，在每个 MotionEvent.ACTION_MOVE 中，使用前两行代码重新绘制电路板 - 我创建的这些 scaledBitmap 和新 BitmapDrawable 会发生什么？我从来没有发生过内存崩溃，但我如何确保它们被回收/垃圾收集？

最好的祝福。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T10:03:26.373

您可以使用适用于 Android 的新内存缓存：http: [//developer.android.com/training/displaying-bitmaps/cache-bitmap.html](http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html)然后您只需重新下载/重新加载已从内存中取出的图像，您也不会碰撞。

# django - 如何隐藏 django-admin 中的某些字段？

> ID：10330916
> 
> 赞同：71
> 
> 时间：2012-04-26T09:43:17.300
> 
> 标签：django, django-admin

```
class Book(models.Model):
    title = models.CharField(..., null=True)
    type = models.CharField(...)
    author = models.CharField(...) 
```

我在models.py 中有一个简单的类。在管理员中，当保存的图书类型为 1 时，我想隐藏图书的标题（以图书详细信息形式）。如何以最简单的方式做到这一点？

* * *

## 回答 #1

> 赞同：170
> 
> 时间：2013-09-03T11:45:32.260

对于**Django > 1.8，可以[直接在 admin 中设置要排除的字段](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.exclude)**：

```
 class PostCodesAdmin(admin.ModelAdmin):
      exclude = ('pcname',) 
```

* * *

隐藏字段在 Django 的 ORM 中通过设置 Field 属性直接定义：`editable = False`

例如

```
class PostCodes(models.Model):
  gisid  = models.IntegerField(primary_key=True)
  pcname = models.CharField(max_length=32, db_index=True, editable=False)
  ... 
```

但是，直接设置或更改模型的字段可能并不总是可行或有利的。原则上，以下`admin.py`设置可以工作，但不会因为[exclude](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.exclude)是 InlineModelAdmin 选项。

```
class PostCodesAdmin(admin.ModelAdmin):
     exclude = ('pcname',)
.... 
```

至少在 Django 1.4（以及可能的更高版本号）中工作的解决方案是：

```
class PostCodesAdmin(admin.ModelAdmin):
  def get_form(self, request, obj=None, **kwargs):
      form = super(PostCodesAdmin, self).get_form(request, obj, **kwargs)
      del form.base_fields['enable_comments'] 
      return form 
```

对于项目的管理列表视图，只需省略不需要的字段即可：例如

```
class PostCodesAdmin(admin.ModelAdmin):
  list_display = ('id', 'gisid', 'title', ) 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-04-26T11:52:56.290

你要在你的模块中创建**admin.py （可能是****book**）

```
class BookAdmin(admin.ModelAdmin):
    list_display = ("pk", "get_title_or_nothing") 
```

在**书**类：

```
class Book:
    ...
    def get_title_or_nothing(self):
        if self.type == WEIRD_TYPE:
            return ""
        return self.title 
```

**更新：**

```
class BookAdmin(admin.ModelAdmin):
    list_display = ("pk", "get_title_or_nothing")

    def get_form(self, request, obj=None, **kwargs):
        if obj.type == "1":
            self.exclude = ("title", )
        form = super(BookAdmin, self).get_form(request, obj, **kwargs)
        return form 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-10-11T15:51:59.233

我试图覆盖`get_form()`函数，但是当我切换不同的记录时会出现一些混淆错误。我发现有一个`get_exclude()`我们可以覆盖的功能。

采用：

```
class BookAdmin(admin.ModelAdmin):
    def get_exclude(self, request, obj=None):
        if obj and obj.type == "1":
            # When you create new data the obj is None
            return ("title", )
        return super().get_exclude(request, obj) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-14T19:30:23.210

中肯的@Lorenz @mrts 答案

使用 Django 2.1，我发现如果该字段已通过 fields = 指定，则 exclude 不起作用。

在这种情况下，您可以使用

```
self.fields.remove('title') 
```

必须将字段定义为列表 [] 才能正常工作

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-07T00:32:36.183

如果要保持表单中的值（例如根据请求设置值，即用户）并隐藏字段，可以将小部件更改为`forms.HiddenInput()`：

```
from django import forms

...

    def get_form(self, request, obj=None, **kwargs):
        """Set defaults based on request user"""
        # update user field with logged user as default
        form = super().get_form(request, obj, **kwargs)
        form.base_fields["user"].initial = request.user.id
        form.base_fields["user"].widget = forms.HiddenInput()
        return form 
```

# python - 如何停止整个循环？

> ID：10330917
> 
> 赞同：0
> 
> 时间：2012-04-26T09:43:17.320
> 
> 标签：python

我在下面的python循环中有问题。

它不会在 totalout=4 时立即停止，而是仅在 scorein 的整个循环结束时才停止。（即第三循环）

例如，如果得分 2 中的 totalout=4，它会运行循环直到达到 10

```
#global value   
totalturn=0
totalscorein=0
totalout=0

def main

  numberofturn=int(input("Number of score:"))

  no_turn=['1','2','3','4','5','6','7','8','9','10'] 
    #while loop condition    
    while totalturn<numberofturn and totalout<10:

            #increasement
            totalscore+=1

            #for loop for score
            for t in range(1,numberofturn+1):
                turns=s*1

                print("\n\n\nThe turn"+no_turn[t]+":",turns)

                #for loop for number to appear from list
                for c in range (10):

                    #list for random number to appear
                    numscore = ['1','2','3','4','5','6','7','8','9','o']

                    #random choice from numscore list to appear
                    from random import choice
                    scorein=choice(numscore)

                    print ("\n\nScores :",scorein)

                    if scorein.isdigit():
                        totalscorein=totalscorein+int(scorein)               

                    if scorein.isalpha():
                        totalout+=1

                    if totalturn==numberofturn:
                        print("\nTotal turn played:",totalturn)

                    elif totalout==4:

                        print("\nTotal turns played",totalturn)
                        break

                    else:

                        print("") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T10:13:19.153

你想`break`打破3个循环吗？我猜你是从问题的标题来看

在这种情况下，由于它是函数的结尾，您可以替换`break`为`return`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:59:04.660

尝试将`and`运算符更改为`or`. 这似乎是你想要的。

`while totalscore<numberofscore or totalout<10:`

# php - Finding whether time is in a defined range

> ID：10330922
> 
> 赞同：-1
> 
> 时间：2012-04-26T09:43:30.487
> 
> 标签：php

> **Possible Duplicate:**
> [How to check if a date is in a given range?](https://stackoverflow.com/questions/976669/how-to-check-if-a-date-is-in-a-given-range)
> [How to check if date(entered by user) is in given range (Date format :-day month ie.:-1 june )](https://stackoverflow.com/questions/10329134/how-to-check-if-dateentered-by-user-is-in-given-range-date-format-day-month)

I am trying to find whether a date is in defined range. I'm using the following code:

```
 $apple='25 March';
    $udate= date('d F',strtotime($apple));

    echo $udate;
    $startDate='21 March';
    $realStartDate= date('d F',strtotime($startDate)) ;
    echo $realStartDate;
    $endDate='19 April';
    $realEndDate= date('d F',strtotime($endDate)) ;
    if ($udate >= $realStartDate && $udate <= $realEndDate ) {
        echo 'within tange';
    }
    else{
        echo 'Not in range';
    }
    ?> 
```

Where am I going wrong?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T10:03:52.617

试试这个它的工作......

```
<?php
        $udate          = '25 March';
        $udateTimestamp = strtotime($udate);

        $startDate          = '21 March';
        $startDateTimestamp = strtotime($startDate);

        $endDate           = '19 April';
        $eEndDateTimestamp = strtotime($endDate);

        if ($udateTimestamp >= $startDateTimestamp && $udateTimestamp <= $eEndDateTimestamp)
        {
                echo 'within tange';
        }
        else
        {
                echo 'Not in range';
        }
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T09:44:55.127

Compare timestamps not the string representations!

```
if(strtotime($apple) < strtotime($endDate) && strtotime($apple) > strtotime($startDate)){
 // All ok!
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T07:46:28.633

您可以使用`DateTime`

```
$userDate = new DateTime("2012-03-01");

if ( $userDate > new DateTime("2012-03-21 00:00:00") &&  $userDate < new DateTime("2012-04-19 23:59:59"))
{
   // In Range 
} 
```

**如果格式为（7 月 1 日），则将其放入函数中**

```
if (inRange ( "1 June", "3 March", "7 December" )) {
    echo "In Range";
} else {
    echo "Out Of Range";
}

function inRange($dateCheck, $dateFrom, $dateTo) {

    $date = DateTime::createFromFormat ( "d F", $dateCheck );
    $date1 = DateTime::createFromFormat ( "d F", $dateFrom );
    $date2 = DateTime::createFromFormat ( "d F", $dateTo );

    if ($date > $date1 && $date < $date2) {
        return true;
    }

    return false;

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-26T07:44:15.537

像这样

```
if(strtotime($givendate) > strtotime('3/21/xxxx') && strtotime($givendata) < strtotime('4/19/xxxx')) {
   // Its within range
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-04-26T09:48:52.190

尝试这个

```
 if (strtotime($udate) >= strtotime($realStartDate) && strtotime($udate) <= strtotime($realEndDate) ) {
    echo 'within tange';
}
else{
    echo 'Not in range';
} 
```

# backbone.js - 如何在 Backbone.Collection.get() 中设置嵌套对象属性？

> ID：10330923
> 
> 赞同：2
> 
> 时间：2012-04-26T09:43:31.260
> 
> 标签：backbone.js, nested

我有一个带有另一个嵌套对象的对象，我想使用 Backbone 的 .get() 功能对其进行修改。根据文档，我可以设置根级对象键，但是有没有办法改变嵌套属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T19:09:20.800

您可以设置/获取嵌套值，但它将充当替换而不是更新。

```
model = {'foo': {'bar': 'baz', 'qux': 'foo'}};
model.get('foo');                 // {'bar': 'baz', 'qux': 'foo'}
model.set('foo', {'baz': 'qux'});
model.get('foo');                 // {'baz': 'qux'} 
```

# jquery - Rails 3.1 Asset pipeline

> ID：10330929
> 
> 赞同：0
> 
> 时间：2012-04-26T09:43:58.730
> 
> 标签：jquery, ruby-on-rails-3, asset-pipeline

I am fairly new to rails and Jquery and am looking for some guidance on which libraries I should keep and which one I don't need.

Anyway currently I have the following in my javascript library

```
admin.js.coffee 
application.js  
bootstrap-alert.js  
calendar.js 
documents.js.coffee 
folders.js.coffee   
fullcalendar.js
gcal.js 
jquery-1.7.min.js   
jquery-ui-1.8.9.custom.min.js   
jquery-ui.js    
jquery-ui.min.js    
jquery.bookshelfslider.js   
jquery.bookshelfslider.min.js   
jquery.easing.1.3.js    
jquery.js   
jquery.rest.js  
jquery.ticker.js    
jquery_ujs.js   
rails.js    
site.js 
stickybar.jquery.min.js
stickysidebar.jquery.js 
turn.js 
```

My application.js file looks like this

```
 //= require jquery
 //= require jquery-ui
//= require jquery_ujs
//= require twitter/bootstrap
//= require_tree . 
```

Is there anything anyone can see that would cause me any issues? if I am calling a library within application.js, do I need the library in my Javascript directory?

Any advice appreciated

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:53:22.870

`rails.js`是 的旧名称`jquery_ujs.js`。您可以删除前者。

此外，您不需要将以下文件存储在 javascripts 目录中

```
jquery-1.7.min.js   
jquery-ui-1.8.9.custom.min.js   
jquery-ui.js    
jquery-ui.min.js    
jquery.js
rails.js 
```

只需安装[jquery-rails](https://github.com/rails/jquery-ujs) gem。

有关更多信息，请参阅[Rails 3.1 资产管道指南](http://guides.rubyonrails.org/asset_pipeline.html)。

# css - Empty div causing alignment issues in FF

> ID：10330933
> 
> 赞同：0
> 
> 时间：2012-04-26T09:44:20.510
> 
> 标签：css, firefox, html, alignment

I am facing a similar issue as following post

[Empty Div Causing Very Strange Behavior](https://stackoverflow.com/questions/4476063/empty-div-causing-very-strange-behavior)

Answer dint help me much. &nbsp fixes alignment issue, but my html code is generated by spring, so I have to find a way to fix it via CSS. I have uploaded sample code at [http://jsfiddle.net/sZ77p/1/](http://jsfiddle.net/sZ77p/1/)

If you add an &nbsp or any text in empty lines under HTML code and run, alignment comes perfectly. Please help.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:55:55.503

尝试添加`overflow: hidden;`到您的`div {...}`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T10:12:28.367

你试过给你的 div 和明确的高度吗？根据您的示例：

```
div {
  line-height: normal;
  font: inherit;
  color: inherit;
  height: 16px;
} 
```

# facebook-graph-api - fb_xdm_frame_https permission denied with AJAX

> ID：10330936
> 
> 赞同：1
> 
> 时间：2012-04-26T09:44:33.153
> 
> 标签：facebook-graph-api, jquery, facebook-comments

I am loading the api like so:

```
<div id="fb-root"></div> 
<script> 
    window.fbAsyncInit = function() { 
        FB.init({ 
        appId      : 'YOUR_APP_ID', // App ID 
        channelURL : '//WWW.YOUR_DOMAIN.COM/channel.html', // Channel File 
        status     : true, // check login status 
        cookie     : true, // enable cookies to allow the server to access the session 
        oauth      : true, // enable OAuth 2.0 
        xfbml      : true  // parse XFBML 
        }); 
    }; 

    (function(d){ 
    var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;} 
    js = d.createElement('script'); js.id = id; js.async = true; 
    js.src = "//connect.facebook.net/el_GR/all.js"; 
    d.getElementsByTagName('head')[0].appendChild(js); 
    }(document)); 
</script> 
```

I am opening a page through a jQuery UI dialog and reparsing the #comments section with:

```
<script>FB.XFBML.parse(document.getElementById('comments'));</script> 
```

While on the non-ajax loaded page works fine, when I am opening it from the dialog it gives the error (on the js console):

```
Permission denied to access property 'fb_xdm_frame_https' @ https://s-static.ak.fbcdn.net/rsrc.php/v1/yt/r/Via9RsGlPnX.js:66 
```

and it looks as if it still is loading (the gif keeps playing) ![enter image description here](../Images/6998cb4ac32ee5fd3ef4fa5fefb3992a.png)

Any ideas?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T05:48:54.473

**我认为您没有正确加载 javascript sdk。试试这个代码**

```
window.fbAsyncInit = function() {
     FB.init({
          appId      : 'appid', // App ID
          channelUrl : 'http://www.url.com', // Channel File
          status     : true, // check login status
          cookie     : true, // enable cookies to allow the server to access the session
          xfbml      : true  // parse XFBML
     });
};

 (function(d){
      var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
      if (d.getElementById(id)) {return;}
      js = d.createElement('script'); js.id = id; js.async = true;
      js.src = "//connect.facebook.net/en_US/all.js";
      ref.parentNode.insertBefore(js, ref);
 }(document)); 
```

# pthreads - Does pthread resets pthread_t value after finishing execution?

> ID：10330937
> 
> 赞同：1
> 
> 时间：2012-04-26T09:44:35.183
> 
> 标签：pthreads

first argument of pthread_create is pthread_t (which is typedef'ed to long), which I understand is thread ID.

Does it set this value to zero when thread finishes execution? I would like to use it to check if the thread is running

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-26T22:28:39.270

不，`pthread_t`pthread 库一旦初始化就不会更改它。将`pthread_t`对象传递`pthread_join()`给等待线程完成。如果您想在不阻塞的情况下进行确定，您可以通过在某个共享对象中为其状态设置指示器来让线程进行协作。

# c# - click from different page to affect on another page

> ID：10330938
> 
> 赞同：0
> 
> 时间：2012-04-26T09:44:36.500
> 
> 标签：c#

I have a project to work on and i dont have any idea on it, i want to know so i could get some tutorials...the project is, i have a web application which is use for ticket sales, so i need to develop another web application that allow users to use the Ticket sales web applications without seeing the application, everything should be on my interface...the only diffeculties is how can i transfer the clicks on my buttons that represent the Ticket Application buttons, to the application

I dont know if anyone get the idea and can help me on how to go about this and what tutorials i should go for to be able to complete this Note: i want to use C# and SQL as my database.

Cheers

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:53:30.130

门票销售应用程序必须提供服务（例如 WCF 服务）。另一个应用程序向该服务器发送请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T10:02:24.337

如@mrtofigh 所写，如果您可以修改售票应用程序，那么您可以在其中添加一个Web 服务层。

如果您无法修改售票应用程序（我怀疑是您的情况），则没有简单的解决方案。

您可以使用`HttWebRequest`该类向应用程序发送模拟浏览器将执行的操作的请求 - 但这会很棘手，特别是如果售票网站使用 Ajax、JavaScript 等。

另一种选择是使用`WebBrowser`控件（基本上是嵌入式浏览器）导航到售票应用程序网站，然后向其发送事件。

# java - Thread-safe code without using the `synchronized` keyword?

> ID：10330941
> 
> 赞同：14
> 
> 时间：2012-04-26T09:44:44.177
> 
> 标签：java, multithreading

What are the possible ways to make code thread-safe without using the `synchronized` keyword?

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-04-26T09:52:53.250

其实方法很多：

1.  如果您没有可变状态，则根本不需要同步。
2.  如果可变状态仅限于单个线程，则无需同步。这可以通过使用局部变量或[`java.lang.ThreadLocal`](http://docs.oracle.com/javase/7/docs/api/java/lang/ThreadLocal.html).
3.  您还可以使用内置同步器。[`java.util.concurrent.locks.ReentrantLock`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/ReentrantLock.html)与使用块和方法时访问的锁具有相同的功能`synchronized`，并且功能更强大。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-26T09:46:06.877

只有方法本地的变量/引用。或者确保任何实例变量都是不可变的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-04-26T09:48:09.147

您可以通过使所有数据不可变来使您的代码线程安全，如果没有可变性，那么一切都是线程安全的。

其次，您可能想看看 java 并发 API，它提供了读/写锁，在有很多读者和少数写者的情况下表现更好。纯同步关键字也会阻止两个阅读器。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2018-08-03T11:40:45.877

```
 ////////////FIRST METHOD USING SINGLE boolean//////////////

    public class ThreadTest implements Runnable { 
        ThreadTest() {
            Log.i("Ayaz", "Constructor..");
        }

        private boolean lockBoolean = false;

        public void run() {
            Log.i("Ayaz", "Thread started.." + Thread.currentThread().getName());
            while (lockBoolean) {
             // infinite loop for other thread if one is accessing
            }
            lockBoolean = true;
            synchronizedMethod();
        }

        /**
         * This method is synchronized without using synchronized keyword
         */
        public void synchronizedMethod() {
            Log.e("Ayaz", "processing...." + Thread.currentThread().getName());
            try {
                Thread.currentThread().sleep(3000);
            } catch (Exception e) {
                System.out.println("Exp");
            }
            Log.e("Ayaz", "complete.." + Thread.currentThread().getName());
            lockBoolean = false;
        }

    } //end of ThreadTest class

     //For testing use below line in main method or in Activity
     ThreadTest threadTest = new ThreadTest();
            Thread threadA = new Thread(threadTest, "A thead");
            Thread threadB = new Thread(threadTest, "B thead");
            threadA.start();
            threadB.start();

///////////SECOND METHOD USING TWO boolean/////////////////

 public class ThreadTest implements Runnable {
    ThreadTest() {
        Log.i("Ayaz", "Constructor..");
    }

    private boolean isAnyThreadInUse = false;
    private boolean lockBoolean = false;

    public void run() {
        Log.i("Ayaz", "Thread started.." + Thread.currentThread().getName());
        while (!lockBoolean)
            if (!isAnyThreadInUse) {
                isAnyThreadInUse = true;
                synchronizedMethod();
                lockBoolean = true;
            }
    }

    /**
     * This method is synchronized without using synchronized keyword
     */
    public void synchronizedMethod() {
        Log.e("Ayaz", "processing...." + Thread.currentThread().getName());
        try {
            Thread.currentThread().sleep(3000);
        } catch (Exception e) {
            System.out.println("Exp");
        }
        Log.e("Ayaz", "complete.." + Thread.currentThread().getName());
        isAnyThreadInUse = false;
    }

} // end of ThreadTest class

     //For testing use below line in main method or in Activity
     ThreadTest threadTest = new ThreadTest();
     Thread t1 = new Thread(threadTest, "a thead");
     Thread t2 = new Thread(threadTest, "b thead");
     t1.start();
     t2.start(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-26T10:34:15.773

为了保持可预测性，您必须确保对可变数据的所有访问都是按顺序进行的，或者处理由并行访问引起的问题。

最粗暴的保护使用`synchronized`关键字。除此之外，至少有两层可能性，每一层都有其好处。

**锁/信号量**

这些可能非常有效。例如，如果您有一个由多个线程读取但仅由一个线程更新的结构，您可能会发现它`ReadWriteLock`很有用。

如果您选择与算法匹配的锁，则锁的效率会更高。

**原子**

例如，使用`AtomicReference`通常可以提供完全无锁的功能。这通常可以提供巨大的好处。

原子背后的原因是允许它们失败，但告诉您它们以您可以处理的方式失败。

例如，如果您想更改一个值，您可以读取它，然后写入它的新值，只要它仍然是旧值。这称为“比较和设置” `cas`，通常可以在硬件中实现，因此非常有效。然后，您需要的只是：

```
long old = atomic.get();
while ( !atomic.cas(old, old+1) ) {
  // The value changed between my get and the cas. Get it again.
  old = atomic.get();
} 
```

但是请注意，可预测性并不总是必需的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-05-23T09:18:16.723

那么有很多方法可以实现这一点，但每种方法都包含多种口味。Java 8 还附带了新的并发特性。可以确保线程安全的一些方法是：
`Semaphores`
Locks- `Reentrantlock,ReadWriteLock,StampedLock`(Java 8)

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2012-04-26T10:01:44.137

为什么你需要这样做？

仅使用局部变量/引用并不能解决大多数复杂的业务需求。此外，如果实例变量是不可变的，它们的引用仍然可以被其他线程更改。

一种选择是使用[SingleThreadModel](http://docs.oracle.com/javaee/1.4/api/javax/servlet/SingleThreadModel.html)之类的东西，但强烈建议不要使用它。

您还可以查看**Kal上面建议的并发 api**

# cocoa - 如何避免复制和粘贴？

> ID：10330947
> 
> 赞同：1
> 
> 时间：2012-04-26T09:45:00.660
> 
> 标签：cocoa, fast-enumeration

如果可能的话，我想改进这个方法：这是一个保存所有文本字段（目镜、物镜等）文本的小部分。不幸的是，我的应用程序的每个部分都必须多次这样做很容易出错，所以我想改进它。我正在考虑使用文本字段等方法的参数进行某种快速枚举，并且我可以拥有字典中的所有键（已经设置）。只是一个指向正确文档的指针，或者，也许，某种对你有用的过程会很棒！

```
-(IBAction)saveUserEntries {

if (eyepiece.text != nil) {

    eyepieceString = [[NSString alloc] initWithFormat:eyepiece.text];
    [eyepiece setText:eyepieceString];
    NSUserDefaults *eyepieceDefault = [NSUserDefaults standardUserDefaults];
    [eyepieceDefault setObject:eyepieceString forKey:@"eyepieceKey"];
}
else {
    [[NSUserDefaults standardUserDefaults] removeObjectForKey:@"eyepieceKey"];
}

if (objectiveLenses.text != nil) {

    objectiveLensString = [[NSString alloc] initWithFormat:objectiveLenses.text];
    [objectiveLenses setText:objectiveLensString];
    NSUserDefaults *objectiveDefault = [NSUserDefaults standardUserDefaults];
    [objectiveDefault setObject:objectiveLensString forKey:@"objectiveKey"];
}
else {
    [[NSUserDefaults standardUserDefaults] removeObjectForKey:@"objectiveKey"];
} 
```

感谢您抽出时间来阅读！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T12:09:56.777

我将尝试基于 OOP 解决方案来回答这个问题。

创建一个接受这些文本框的任何类型对象作为参数的方法，将所述对象的引用发送到该方法，并将条目保存在您知道的类似方法中。这将避免您担心的“复制和粘贴”错误。

您应该能够遍历存在的所述对象的每个实例，如果可可应用程序的工作方式类似于 Java 和 .NET（我真的不知道）。我只知道必须有一种方法可以遍历应用程序域中单个对象的每个实例。

如果这是 .NET，我只是建议 TextBox.Name 和 TextBox.String 使其成为一种通用方法，可用于保存发送给它的任何 TextBox 的属性。如果这不能回答您的问题（评论有点长），那么我很抱歉。

# hibernate - NHibernate and batch-size

> ID：10330948
> 
> 赞同：4
> 
> 时间：2012-04-26T09:45:07.173
> 
> 标签：hibernate, nhibernate, nhibernate-mapping

I wanted to ask how you guys in general use `batch-size` within the mappings. Do you in general set a certain number on any mapped collection? Of course, I do know about the other fetching strategies like `join fetch`, but sometimes I have to filter during post processing, which might trigger lot's of lazy loading. I figured out if I set the batch-size e.g. to 100, I have much better performance in such cases.

**Do you set this property in general on any mapped collection?** If not, why not? Could there be any disadvantage?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-04-26T11:28:00.920

在集合或父实体上设置`batch-size`几乎可以做同样的事情。

`batch-size`真正在做的是将问题`SELECT N+1`转化为`SELECT N/batch-size + 1`条件。

有一个缺点，那就是您需要平衡设置正确数字之间的差异。如果batch-size 太大，会加载太多数据，如果太小，仍然会有太多查询。你如何平衡这一点是有争议的，如果不设置测试是不可能衡量的。

我认为这是一个微优化，很重要，因为它可以真正减少 select/n+1 问题。然而，它确实不如为每个场景独立选择正确的获取策略重要，这使得整体策略更好。

我也认为这是一个生产问题，应该针对真实用户针对真实数据进行测试。

附带说明一下，我总是将 my 设置`batch-size`为等于我的分页大小，不要问我为什么感觉很好！

# asp.net-mvc-3 - Unable to service 20+ connections MVC3 IIS6 w long polling

> ID：10330952
> 
> 赞同：2
> 
> 时间：2012-04-26T09:45:15.237
> 
> 标签：asp.net-mvc-3, iis-6, long-polling

It seems this is a common question/problem but despite checking out a number of proposed solutions nothing worked for us so far.

### The app

It's a simple chat app, that puts a new interface on an existing app's JSON library. We proxy all the calls to their app to avoid x-domain restrictions (IE8). ASP.net MVC3 App;

It's hosted in IIS6, W2K3 SP2\. DEV svr has 1gig ram, TEST svr has 4gig ram.

### The problem

When we approach 20 concurrent users, requests start lagging - no issues in Event Viewer to be found. It looks like calls are just queued. There are NO 503's returned.

### What we've tried

*   We're using AsyncController to long-poll a 3rd party webservice for results Hosted in IIS6
*   We're using the TPL to call their service in our AsyncController method
*   We've modified [processModel](http://msdn.microsoft.com/en-us/library/7w2sway1.aspx) and set maxWorkerThreads=100.
*   We've looked at [this how-to](http://blogs.msdn.com/b/david.wang/archive/2006/04/12/howto-maximize-the-number-of-concurrent-connections-to-iis6.aspx) but the HTTP.SYS config looks to service an infinite number of threads so we haven't bothered adding the reg keys.
*   The 3rd party service can handle lots of concurrent requests (and is in a web farm, so we're fairly confident we're the weakest link)

*what are we missing?* - any help greatly appreciated

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T13:07:44.647

嗯......差不多四个星期后，我想我会更新这个，以防有人想知道是什么帮助我们克服了这些限制（我们在我们的 DEV 服务器 1gig Xeon 上塞满了大约 100 个模拟连接）。

### 异步控制器

*   如果您有一个潜在的长时间等待请求（即长时间轮询），请使用它们。
*   随意使用*TaskFactory*但请务必将其标记为长时间运行的进程，如果您的线程中存在异常风险，请务必使用 ContinueWith 以便您可以减少操作，并将错误返回给调用者。

### 服务点管理器

*   如果您正在进行下游调用（即 WebService/3rd 方 API），请确保您已从默认的 2 个同时连接增加 DefaultConnectionLimit。
*   粗略的指南是 8 * Num 核心，这样您就不会饿死传出连接资源。
*   有关更多信息，请参阅[有关 DefaultConnectionLimit 的 MSDN 文章。](http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.defaultconnectionlimit.aspx)

### IOCP 与 RestSharp

*   我喜欢 RestSharp 的 API，它很棒，但它可能更多地用于客户端编程，而不是代理请求。我的错！！使用 HttpWebRequest 和 Begin/End 方法来使用 IOCP
*   如果您正在寻找反向代理或 url 重写，[请查看 URL Rewriter，这是 CodePlex 上免费提供的一个很棒的库](http://urlrewriter.codeplex.com/)

最后，我们的问题不在于传入的请求，而在于请求被代理给第三方，我们没有提供足够的连接，因此它们都排队等待整个系统。很高兴地说，经过大量阅读、调查和编码，我们已经解决了这个问题。

# sql - SQL 新手 - 不确定如何编写查询

> ID：10330953
> 
> 赞同：1
> 
> 时间：2012-04-26T09:45:15.557
> 
> 标签：sql, sqlite

我有 3 张桌子：单位类型派系

Units 具有来自 Types 和 Factions（TypeID 和 FactionID）的外键。我需要使用 Types.TypeName 和 Factions.FactionName 来获取 Units.UnitName。

我想我可能需要加入，但我不确定如何构建它。有什么帮助吗？

编辑：这是相关表格的截图：http: [//i.imgur.com/Il9Qn.png](http://i.imgur.com/Il9Qn.png)

我需要返回这些数据： UnitName - SupplyCost - CreditsCost - MetalCost - CrystalCost

获取此信息的表单将提供 FactionName 和 TypeName，因为它们是文本值，因此用户易于理解，而不是数字 ID。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:48:19.357

```
SELECT Units.UnitName
FROM Units INNER JOIN Types ON Units.TypeId = Types.TypeId
    INNER JOIN Factions ON Units.FactionId = Factions.FactionId
WHERE Types.TypeName = @typeName
    AND Factions.FactionName = @factionName 
```

那会是你所追求的吗？如果没有，您可能需要在问题中提供更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-04-26T09:48:56.807

就像是：

```
select UnitName, SupplyCost, CreditsCost, MetalCost, CrystalCost from Units
inner join Types on Types.TypeID = Units.TypeID 
inner join Factions on Faction.FactionID = Units.FactionID
WHERE Types.TypeName = @typeName
AND Factions.FactionName = @factionName 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-26T09:48:28.007

请检查一下

```
select UnitName, SupplyCost, CreditsCost, MetalCost, CrystalCost from Units
inner join Types on Types.TypeID = Units.TypeID 
inner join Factions on Faction.FactionID = Units.FactionID
WHERE Types.TypeName = @typeName
AND Factions.FactionName = @factionName 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-04-26T09:48:41.350

```
SELECT
   SupplyCost, CreditsCost, MetalCost, CrystalCost
FROM
   Units 
      INNER JOIN Types ON Units.TypeID = Types.TypeId
      INNER JOIN Factions ON Units.FactionId = Factions.TypeId
WHERE 
      Types.TypeName = 'value from form for types'
      AND
      Factions.FactionName = 'value from form for factions' 
```

您可以阅读[http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)以获得关于 JOIN 的直观解释

# c# - 如何在 asp.net 配置文件中存储名称-值对

> ID：10330954
> 
> 赞同：0
> 
> 时间：2012-04-26T09:45:21.577
> 
> 标签：c#, asp.net

> **可能重复：**
> [将通用字典存储在 asp.net 配置文件中？](https://stackoverflow.com/questions/1277656/store-a-generic-dictionary-in-an-asp-net-profile)

我想在 asp.net 配置文件中保存名称-值对，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:56:34.590

定义一个可以保存键值数据的类，例如：

```
namespace Samples.AspNet.Profile 
{
    [Serializable]
    public class KeyValue{

        public Dictionary<string, Object> dict= new Dictionary<string, Object>();
    }

} 
```

在 KeyValue 类型的配置中初始化配置文件：

```
<profile defaultProvider="AspNetSqlProfileProvider">
  <properties>
    <add name="List" 
      type="Samples.AspNet.Profile.KeyValue" 
      serializeAs="Binary" />
  </properties>
</profile> 
```

现在您可以添加如下值：

```
KeyValue data= new KeyValue ();
data.dict.Add("Contoso","value");
bookCart.CartItems.Add("Microsoft","value2");
Profile.List= data; 
```

# android - ZoneAlarm 与具有 OpenGL ES 2.0 仿真的 Android SDK 仿真器冲突

> ID：10330956
> 
> 赞同：0
> 
> 时间：2012-04-26T09:45:24.783
> 
> 标签：android, android-emulator, firewall

好吧，我想我在这个问题上碰到了一面钢筋金属墙，这里......

上周我对在 android 手机上创建应用程序很感兴趣，经过几次尝试模拟 OpenGL ES 2.0 之后，我终于做到了！

但是......这是问题所在：

据我了解，仿真的工作方式深入操作系统，然后通过您的 GPU 运行并返回 SDK 仿真器：

[http://android-developers.blogspot.ca/2012/04/faster-emulator-with-better-hardware.html](http://android-developers.blogspot.ca/2012/04/faster-emulator-with-better-hardware.html)

这是相当不错的东西，可惜我有一个过度偏执的检测拒绝和销毁每个未知的应用程序防火墙，称为 ZoneAlarm。

我已授予以下程序完全访问权限（3 条/超级信任级别和所有其他列）：

```
adb.exe
AVD Manager.exe
emulator.exe
emulator-arm.exe 
```

然而，事情从来都不是那么简单，所以我现在就在这里，希望一些大师能告诉我停止 GPU 仿真的 ZoneAlarm 到底是什么阻止了我，这样我就可以停止用我的头撞到加固的金属墙上了！

给每一个尝试的人一杯咖啡！

# python - svn 提交之前的 XML 模式验证

> ID：10330957
> 
> 赞同：2
> 
> 时间：2012-04-26T09:45:28.620
> 
> 标签：python, xml, svn, validation, xsd

svn 中是否有可能在将 xml 文件提交到存储库之前针对模式文件验证它？所以我可以确定存储库中的文件是可靠的。我已经搜索过了，但我没有找到答案。编程语言应该是python。我发现了一些关于“预提交钩子”的文章，但它们并没有解决我的问题。也许我只是在理解上遇到了问题。

我希望你能帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-27T01:08:27.570

预提交挂钩是您想要的。因此，一个名为“pre-commit”的可执行 Python 程序位于 your-repo/hooks 目录中，并对提交的 xml 文件进行验证，如果它们通过验证则返回零，如果不通过则返回非零值。

[http://lxml.de/validation.html](http://lxml.de/validation.html)和[http://wordaligned.org/articles/a-subversion-pre-commit-hook](http://wordaligned.org/articles/a-subversion-pre-commit-hook)应该给你足够的继续。

# c# - 在 Windows Phone 中旋转图像

> ID：10330959
> 
> 赞同：3
> 
> 时间：2012-04-26T09:45:31.953
> 
> 标签：c#, windows-phone-7, xaml

我在我的一个页面上展示了一张我拍的照片。

我以人像模式拍摄照片，它工作正常。

当我在下一个视图中显示照片时，它会将照片视为在风景中拍摄的。

所以我需要将图片/图像旋转-90 来纠正这个问题。

这是我的 .XAML 的相关代码：

```
 <!--ContentPanel - place additional content here-->
    <Grid x:Name="ContentPanelx" Grid.Row="1" Margin="0,0,0,0">
    </Grid> 
```

这是我加载照片并将其放入 ContentPanel 的方法：

```
void loadImage()
    {
        // The image will be read from isolated storage into the following byte array

        byte[] data;

        // Read the entire image in one go into a byte array

        using (IsolatedStorageFile isf = IsolatedStorageFile.GetUserStoreForApplication())
        {

            // Open the file - error handling omitted for brevity

            // Note: If the image does not exist in isolated storage the following exception will be generated:

            // System.IO.IsolatedStorage.IsolatedStorageException was unhandled 

            // Message=Operation not permitted on IsolatedStorageFileStream 

            using (IsolatedStorageFileStream isfs = isf.OpenFile("0.jpg", FileMode.Open, FileAccess.Read))
            {

                // Allocate an array large enough for the entire file

                data = new byte[isfs.Length];

                // Read the entire file and then close it

                isfs.Read(data, 0, data.Length);

                isfs.Close();

            }
        }

        // Create memory stream and bitmap

        MemoryStream ms = new MemoryStream(data);

        BitmapImage bi = new BitmapImage();

        // Set bitmap source to memory stream

        bi.SetSource(ms);

        // Create an image UI element – Note: this could be declared in the XAML instead

        Image image = new Image();

        // Set size of image to bitmap size for this demonstration

        image.Height = bi.PixelHeight;

        image.Width = bi.PixelWidth;

        // Assign the bitmap image to the image’s source

        image.Source = bi;

        // Add the image to the grid in order to display the bit map

        ContentPanelx.Children.Add(image);

    }
} 
```

加载后，我正在考虑对图像进行简单的旋转。我可以在 iOS 中做到这一点，但我的 C# 技能比坏还差。

有人可以就此提出建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-04-26T09:52:50.647

如果图像在 xaml 中声明，您可以像这样旋转它：

```
//XAML
    <Image.RenderTransform>     
    <RotateTransform Angle="90" /> 
      </Image.RenderTransform> 
```

同样的事情也可以通过 c# 完成。如果您总是旋转图像，那么在 xaml 中使用它是更好的选择

```
//C#
((RotateTransform)image.RenderTransform).Angle = angle; 
```

请试试这个：

```
RotateTransform rt = new RotateTransform();
            rt.Angle = 90;

            image.RenderTransform = rt; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-05-09T10:13:11.207

您可以创建一个 RotateTransform 对象以用于图像的 RenderTransform 属性。这将导致 WPF 在呈现时旋转 Image 控件。

如果要围绕图像中心旋转图像，还需要设置旋转原点，如下所示：

```
RotateTransform rt = new RotateTransform();
rt.Angle = 90;
image.RenderTransform = rt;
image.RenderTransformOrigin = new Point(0.5, 0.5); 
```

# php - Symfony sf_culture = 1 错误

> ID：10330962
> 
> 赞同：1
> 
> 时间：2012-04-26T09:45:42.873
> 
> 标签：php, symfony1, symfony-1.4

由于服务器上的 sf_culture = 1，我遇到了很多错误。

```
{sfConfigurationException} Unable to find a matching route to generate url 
for params "array (  'action' => 'legend',  'module' => 'housing',  'sf_culture' =>'1',)" 
```

在本地，这与默认路由匹配：

```
Match route "default" (/:sf_culture/:module/:action/*) for /de_DE/housing/legend with 
parameters array (  'module' => 'housing',  'action' => 'legend',  'sf_format' => 'html',  
'sf_culture' => 'de_DE',) 
```

看起来像这样

```
default:
  url:   /:sf_culture/:module/:action/*
  param: { sf_format: html }
  requirements:
    sf_culture: (?:<?php echo $cultures ?>) 
```

为什么 :sf_culture 或 $sf_user->getCulture() 甚至可能返回“1”，而且我在日志中看到了“de?keepthis=true”，这更奇怪。

我能做些什么来处理这个错误？

编辑：我不能是唯一一个有这个错误的人吗？我的意思是看看这些日志（~ 1 分钟）

```
May 10 09:50:23 symfony [err] {sfConfigurationException} Unable to find a matching route to generate url for params "array (  'action' => 'legend',  'module' => 'housing',  'sf_culture' => 'en√¢‚Ç¨≈ì',)".
May 10 09:50:34 symfony [err] {sfConfigurationException} Unable to find a matching route to generate url for params "array (  'action' => 'legend',  'module' => 'housing',  'sf_culture' => 'mvcleltja',)".
May 10 09:50:45 symfony [err] {sfConfigurationException} Unable to find a matching route to generate url for params "array (  'action' => 'legend',  'module' => 'housing',  'sf_culture' => '√ en',)".
May 10 09:51:26 symfony [err] {sfConfigurationException} Unable to find a matching route to generate url for params "array (  'action' => 'legend',  'module' => 'housing',  'sf_culture' => '1',)".
May 10 09:51:42 symfony [err] {sfConfigurationException} Unable to find a matching route to generate url for params "array (  'action' => 'legend',  'module' => 'housing',  'sf_culture' => 'whwgopshwhyrydi',)". 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-16T22:33:46.180

您可以通过 routing.yml (apps/appname/config/routing.yml) 限制 URL 中允许的文化，如下所示：

```
本地化_主页：
  网址：/：sf_culture/
  参数：{模块：你的模块，动作：你的动作}
  要求：
    sf_culture: (?:fr|en)

```

# xml - UTF-8 模式可以验证 ISO-8859-2 xml 吗？

> ID：10330969
> 
> 赞同：1
> 
> 时间：2012-04-26T09:46:18.250
> 
> 标签：xml, encoding, xsd

以 UTF-8 编码的 XML 模式是否可以验证以 ISO-8859-2 编码的某些 xml 或编码必须相同？

架构：

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:.... 
```

数据：

```
<?xml version="1.0" encoding="ISO-8859-2"?>
<data>... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T10:01:01.773

模式和文档编码是完全独立的。

# git - 将推送的分支恢复为具体的提交

> ID：10330970
> 
> 赞同：6
> 
> 时间：2012-04-26T09:46:24.050
> 
> 标签：git, git-reset, git-revert

我已经将一个 dev 分支（具有恒定的，有时是不稳定的更改）合并到我们的 master 分支（我们存储已发布的稳定代码的地方）。我想将 master 分支恢复到之前的状态，就像从未发生与 dev 分支的合并一样（并且当将来我们合并 dev 分支时，我们现在将丢弃的所有更改都将“再次”合并）。

这是 master 分支的当前状态，我希望它在 HEAD 处具有“professional-1.1.2”提交/标记。

![master 分支的状态](../Images/d8d3ec60c5eacc2da103426eb0157b4d.png)

我试过了：

```
$ git revert -n professional-1.1.2..HEAD
fatal: Commit 9167e846a387c793edbc089c7ab6bd9eb8260456 is a merge but no -m option was given.
$ git revert -n -m 1 professional-1.1.2..HEAD
fatal: Mainline was specified but commit 380169097f35d07466640bc0db1b639278cd25fa is not a merge.
$ git revert -n -m 2 professional-1.1.2..HEAD
fatal: Mainline was specified but commit 380169097f35d07466640bc0db1b639278cd25fa is not a merge. 
```

经过一番研究，我认为更好的选择是做 a`git reset --hard professional-1.1.2`并`git push --force`作为[Git 的答案：如何忽略快进并将原点 [分支] 恢复到较早的提交？](https://stackoverflow.com/questions/3166713/git-how-to-ignore-fast-forward-and-revert-origin-branch-to-earlier-commit)或[恢复推送的 git commit](https://stackoverflow.com/questions/5316438/reverting-pushd-git-commit)。其他开发人员在同一个办公室，他们永远不应该向 master 提交任何东西（我也不应该，但是......是的，我们没有每个分支的权限），所以告诉他们并做任何事情都不是什么大问题需要采取的行动。

所以最后的问题是：`git revert something`还是`git reset --hard <TAG>`&& `git push --force`？如果`git revert`，我应该使用哪个命令行？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-04-26T09:54:30.333

该`-m number`选项指定您要恢复到哪个父级（因为合并有多个父级）。

所以你想要`git revert -m 1 HEAD`或`git revert -m 1 SHA_OF_MERGE_COMMIT`（假设你做了`git checkout master; git merge devel;`）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-04-26T10:08:45.180

如果您只想使状态与`master`完全一样`professional-1.1.2`，同时避免重写历史和强制推送，您可以在 master 之上创建一个新的提交，代表项目的相同状态`professional-1.1.2`。您可以通过以下步骤做到这一点：

```
# Check that "git status" is clean, since the steps that follow will throw
# way uncommitted changes:
git status

# Set the index (staging area) to be as it was at professional-1.1.2:
git read-tree professional-1.1.2

# Create a commit based on that index:
git commit -m "Reverting to the state at professional-1.1.2"

# Your working tree will still be as it was when you started, so
# you'll want to reset that to the new commit:
git reset --hard 
```

作为替代方案，您可以按照[Charles Bailey 在此答案](https://stackoverflow.com/a/1895095/223092)中建议的步骤进行操作，它完成了同样的事情，但我认为稍微有点混乱（即使我建议的步骤涉及“管道”命令[`git read-tree`](http://schacon.github.com/git/git-read-tree.html)）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-27T09:47:10.627

如果你是一个冒失鬼（对于所有其他提交者来说，从上游 rebase 中恢复可能是必要的）

```
git checkout yourbranch
git reset HEAD <commit-hash>
git push origin yourbranch -f 
```

# wcf - 带有 UriTemplate 的 WCF 服务-“长度不能小于零”

> ID：10330972
> 
> 赞同：1
> 
> 时间：2012-04-26T09:46:28.677
> 
> 标签：wcf, rest, .net-4.0, sitecore

我有一个非常简单的 WCF 服务设置，其方法类似于：

```
[OperationContract]
[WebGet(UriTemplate = "/GetById/{id}")]
ResponseSingle<BinderViewModel> GetById(string id); 
```

当我尝试使用 GUID 之类的...

**http://localhost/services/myservicename.svc/GetById/5c3f04d7-f96e-4acd-847b-6da5937e**

它返回 500 和异常说明：

> 长度不能小于零。参数名称：长度

如果我删除 UriTemplate 而是将其按为：

**http://localhost/services/myservicename.svc/GetById?id=5c3f04d7-f96e-4acd-847b-6da5937e**

它工作正常。

我已经阅读了一些内容，看起来当它增长>一定长度时请求会失败。

想知道以前是否有其他人被此咬伤，如果有，是否有运气解决？

干杯，蒂姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-28T21:20:01.560

```
[WebGet(UriTemplate = "/GetById/{id}")] 
```

应该：

```
[WebGet(UriTemplate = "/GetById?id={id}"] 
```

* * *

添加更多信息（因为我有点困惑）`/Action/{variable}`是为了服务的路径。即 /GetBy/ID 或 /GetBy/Name

然而，该方法期望一个值来完成服务的处理，因此这必须是语法中的查询`?CaseSenstiveMethodParameterName={queryParameter}`

[MSDN URL 模板帮助](http://msdn.microsoft.com/en-us/library/bb675245.aspx)

# mysql - jsp mysql服务器连接超时

> ID：10330975
> 
> 赞同：0
> 
> 时间：2012-04-26T09:46:44.730
> 
> 标签：mysql, jsp, tomcat

嗨，我正在做一个 jsp 项目。我将我的项目部署在 apache tomcat 上。我使用 mysql 作为数据库。

当我在远程服务器上部署项目时，它运行良好。但几个小时后它给了我sql错误。然后我回到我的 apache 服务器并再次启动项目它运行，几个小时后它再次给我同样的 sql 错误。我不知道问题所在。是由我的 java 连接代码引起的还是与 mysql 服务器有关。有人能告诉我为什么它给我sql错误吗？

```
public class ConnectionManager {

    private String className = "com.mysql.jdbc.Driver";
    private String userName ="username";
    private String password = "password";
    private String url = "jdbc:mysql://localhost:3306/database?useUnicode=true&characterEncoding=utf-8";
    /**
     * @uml.property  name="connectionInstance"
     * @uml.associationEnd  
     */
    private static ConnectionManager connectionInstance = null;

  public ConnectionManager(){

  }

  public static synchronized ConnectionManager getInstance() {
    if(connectionInstance == null) {
      connectionInstance = new ConnectionManager();         
    }
    return connectionInstance;
  }

  public Connection getConnection(){

      Connection conn = null;
      try {
          Class.forName(className);
          conn = DriverManager.getConnection (url, userName, password);
          System.out.println("Connection Established");
      }  catch (ClassNotFoundException e) {
          e.printStackTrace();
      }  catch (SQLException e) {
          e.printStackTrace();
      }
      return conn;
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T13:46:29.737

MySQL 的默认连接超时时间为 8 小时。因此，这意味着您将 SQL 连接保持打开的时间过长。您的代码表明您在应用程序启动时仅创建一个连接并在应用程序范围内重用它。这真是太糟了。这不是线程安全的。

您需要更改代码，以免在代码中的*任何位置*`Connection`将 SQL 声明和存储为静态或实例变量。相反，它应该在**尽可能短的范围**内被声明、创建和关闭。最好在与您执行 SQL 查询的位置完全相同的方法块内。

 ***这是您正确完成工作的小改写`ConnectionManager`：

```
public class ConnectionManager {

    private static final String DRIVER = "com.mysql.jdbc.Driver";
    private static final String USERNAME ="username";
    private static final String PASSWORD = "password";
    private static final String URL = "jdbc:mysql://localhost:3306/database?useUnicode=true&characterEncoding=utf-8";

    static {
        try {
            Class.forName(DRIVER);
        }
        catch (ClassNotFoundException e) {
            throw new ExceptionInInitializerError(DRIVER + " missing in classpath!", e);
        }
    }

    public static Connection getConnection() throws SQLException {
        return DriverManager.getConnection(URL, USERNAME, PASSWORD);
    }
} 
```

按如下方式使用它：

```
public class SomeDAO {

    public SomeEntity find(Long id) throws SQLException {
        Connection connection = null;
        // ...

        try {
            connection = ConnectionManager.getConnection();
            // ...
        }
        finally {
            // ...
            if (connection != null) try { connection.close(); } catch(SQLException ignore) {}
        }

        return someEntity;
    } 
```

要提高连接性能，请使用连接池而不是`DriverManager`.

### 也可以看看：

*   [使用 MVC 和 DAO 模式在 JSP 页面的 HTML 中显示 JDBC ResultSet](https://stackoverflow.com/questions/5003142/jsp-using-mvc-and-jdbc/5003701#5003701)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:56:25.760

使用它们后是否正确关闭连接。***

# ios - IOS 如何使用按钮发送消息？

> ID：10330977
> 
> 赞同：0
> 
> 时间：2012-04-26T09:46:46.983
> 
> 标签：ios, button

我设置了一个按钮，点击时它会跳转到拨打电话视图！现在我设置另一个按钮时点击发送消息。如何让它只停留在APP视图而不是跳转到手机发送消息视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T09:49:09.777

不能从应用程序内拨打电话。您只能使用电话号码 URL 重定向用户。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T09:48:19.370

如果不深入研究私有框架，这是不可能的。

# android - 使用 ActionBarSherlock/HoloEverywhere Light 的对话框

> ID：10330979
> 
> 赞同：3
> 
> 时间：2012-04-26T09:46:53.897
> 
> 标签：android, actionbarsherlock, android-holo-everywhere

我正在使用 Christophe Versiuex 的[HoloEverywhere](https://github.com/ChristopheVersieux/HoloEverywhere)库项目和`Theme.HoloEverywhereLight.Sherlock`主题。

系统对话框——复制所有文本、日期选择器对话框等——都有白色文本作为窗口标题，而不是浅蓝色。如果您运行演示，您可以看到这一点。

我试过用它们来设计它们，`android:windowTitleStyle`但没有运气。有人在使用它并找到解决方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-19T20:24:43.177

标题文字[很难更改](http://blog.stylingandroid.com/archives/280#)。您可以更改标题的背景颜色，使其变得可读，并将其他所有内容保留在浅色主题中：

```
<style name="Theme.MyTheme" 
       parent="Theme.HoloEverywhereLight.DarkActionBar.Sherlock">
       <item name="android:alertDialogStyle">@style/AlertDialogHoloMix</item>
</style>

<style name="AlertDialogHoloMix" 
       parent="AlertDialogHoloLight">
       <item name="android:topDark">@drawable/dialog_top_holo_dark</item>
</style> 
```

我在 Gingerbread 和 ICS 上对此进行了测试。

# silverlight - 如何使用发件人获取 ContextMenu 的封闭元素

> ID：10330983
> 
> 赞同：1
> 
> 时间：2012-04-26T09:47:05.520
> 
> 标签：silverlight, windows-phone-7, contextmenu, sender

我有一个位于网格内的上下文菜单。在上下文菜单的关闭事件中，我需要掌握封装网格。我知道我可以在最新的 silverlight 工具包中使用：

```
var cm = sender as ContextMenu;

var grid = cm.Owner as Grid; 
```

但是，我想用我当前的（旧的）工具包版本来解决它。

```
private void Contextmenu_Closed(object sender, RoutedEventArgs e)
{
   // insert solution here
} 
```

有谁知道我怎么能做到这一点？

更新：尝试了一切，无法弄清楚。最终安装了最新的工具包。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-16T20:01:14.403

```
<toolkit:MenuItem Header="Add"  Click="MenuItem_Click"/>    

private void MenuItem_Click(object sender, RoutedEventArgs e)
        {
            MenuItem menuItem = (MenuItem)sender;
            MessageBox.Show("You chose to  " + menuItem.Header.ToString(),"Result",MessageBoxButton.OK);
        } 
```

# linux - linux复制符号链接

> ID：10330984
> 
> 赞同：32
> 
> 时间：2012-04-26T09:47:09.957
> 
> 标签：linux, shell, command-line, symlink, cp

如何将符号链接从一个目录复制到另一个目录？

```
ls -ls

file1.txt
file2.txt
files -> /mnt/iscsi-nfs-share/faulttracker-files 
```

我想要做的是将文件符号链接复制到另一个目录中？

```
cp files /var/copylinktohere/ 
```

上面的结果是 cp: omitting directory `files'

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-04-26T09:51:32.817

使用`-d`选项：

```
cp -d files /var/copylinktohere/ 
```

来自`man cp`：

```
 -d     same as --no-dereference --preserve=link

   --no-dereference
          never follow symbolic links 
```

# java - 使用 mvn assembly:single 构建带有依赖关系的 jar 时，如何包含本地 jar？

> ID：10330987
> 
> 赞同：2
> 
> 时间：2012-04-26T09:47:16.023
> 
> 标签：java, maven, jvm, jython, maven-assembly-plugin

具体来说，我正在尝试构建一个具有依赖项的 Datomic (http://www.datomic.com) jar，以便我可以在 Jython REPL 中对其进行试验。

Datomic 不在 Maven 上分发，但您可以像这样下载并安装 Datomic 到本地 Maven 存储库中：

```
mvn install:install-file 
  -DgroupId=com.datomic 
  -DartifactId=datomic 
  -Dfile=datomic.jar 
  -DpomFile=pom.xml 
```

但是我需要将它作为具有依赖关系的单个 jar，以便我可以将它放在我的类路径中并从 Jython REPL 中使用它。

`mvn assembly:single`构建一个具有依赖关系的 jar，但它不包含 Datomic jar，大概是因为它是一个本地文件。

你如何在做的时候包括一个本地罐子`mvn assembly:single`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-04-26T10:01:14.987

我认为使用 Maven Shade 插件会更好： [http ://maven.apache.org/plugins/maven-shade-plugin/](http://maven.apache.org/plugins/maven-shade-plugin/)

这将允许您创建一个*über-jar*，其中将包含您自己的类和依赖项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-26T10:54:38.153

jar 是否安装在本地并不重要，只要将 jar 文件添加到项目的 pom.xml 文件（依赖项部分）即可：

```
<dependencies>
  ... ...
  <dependency>
    <groupId>com.datomic</groupId>
    <artifactId>datomic</artifactId>
    <version>1.0</version>
  </dependency>
</dependencies> 
```

查看 Maven Assembly Plugin 文档[jar-with-dependency](http://maven.apache.org/plugins/maven-assembly-plugin/descriptor-refs.html#jar-with-dependencies)：

> 使用 jar-with-dependencies 作为您的程序集插件配置的 descriptorRef，以创建一个 JAR，其中包含项目的二进制输出以及解压缩的依赖项。此内置描述符使用 JAR 归档格式生成带有分类器 jar-with-dependencies 的程序集。
> 
> 请注意，jar-with-dependencies 仅提供对 uber-jars 的基本支持。如需更多控制，请使用[Maven Shade Plugin](http://maven.apache.org/plugins/maven-shade-plugin/)。

示例 pom.xml：

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-assembly-plugin</artifactId>
  <version>2.3</version>
  <configuration>
    <descriptorRefs><descriptorRef>jar-with-dependencies</descriptorRef></descriptorRefs>
  </configuration>
  <executions>
    <execution>
      <phase>package</phase>
      <goals><goal>single</goal></goals>
    </execution>
  </executions>
</plugin> 
```

# android - 动态改变View的边框

> ID：10330991
> 
> 赞同：0
> 
> 时间：2012-04-26T09:47:24.347
> 
> 标签：android, android-layout, android-widget

我只是计划实现一个视图，其边框颜色在运行时基于计时器不断变化。例如，最初视图的边框将是绿色（计时器 = 20 秒），并且每隔一秒绿色就会消失，一旦超过一半（计时器 = 10 秒）的视图......边框颜色应该变为橙色和一旦它到达定时器的结束（定时器 = 5 秒），它应该是红色的，并且手机应该振动（很容易做到）....如果有人熟悉 zynga poker，它与我想要实现的相同。
现在实现它的一种方法可能是有一个后端计时器，并基于它有“n”个可绘制对象，并继续每秒更改视图的背景。但这需要很多图像，我认为这不是实现它的最佳方式。
只是想知道我是否可以编写一个自定义视图并实现表面视图并围绕它做一些事情以便可以做到这一点。有人对如何实现这一目标有任何想法吗？这可以使用自定义视图周围的任何动画来完成吗？非常感谢有关此的任何想法。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-04-26T09:51:05.990

运行 timertask，并通过将视图的背景值设置为样式来更改视图的边框。喜欢，

```
view.setBackground(R.drawable.border_style_green); 
```

所以在定时器任务中，不断检查时间，改变边框。

注意 - border_style_green 是一个 XML 文件，它具有您可以设置边框、圆角到视图等的样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-26T10:00:44.503

我的建议是使用 android 的动画框架。如果您的应用程序的目标版本低于蜂窝，请使用[NineOldAndroids](http://nineoldandroids.com/)。

正如已经建议的那样，通过将 shapeDrawable 分配给您的视图来设置边框

```
view.setBackground(R.drawable.border_style_green); 
```

你像这样启动动画师。（此代码将在 1000 毫秒内从 currentColor 变为红色）

```
 ObjectAnimator animator = ObjectAnimator.ofFloat(this, "color", currentColor,Color.RED);
    animator.setEvaluator(new ArgbEvaluator());
    animator.setDuration(1000);
    animator.start(); 
```

然后在您的活动中实施：

```
public void setColor(int color){
            currentColor = color;
    view.getBackground().setColorFilter(color, PorterDuff.Mode.MULTIPLY);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-04-26T09:54:10.233

如果视图是 html 页面：使用 Jquery 进行此实现。通过ajax，您也可以调用后端。[jQuery延迟函数](http://api.jquery.com/delay/)

# javascript - 使用 JavaScript 授权 Google Drive

> ID：10330992
> 
> 赞同：43
> 
> 时间：2012-04-26T09:47:24.900
> 
> 标签：javascript, oauth-2.0, google-drive-api

我正在尝试授权我的应用程序与 Google Drive 集成。[Google 文档提供了有关各种服务器技术](https://developers.google.com/drive/credentials)的基于服务器的授权和代码示例的详细信息。

还有一个[JavaScript Google API 库](https://code.google.com/p/google-api-javascript-client/)，支持授权。在 wiki的[示例部分](https://code.google.com/p/google-api-javascript-client/wiki/Samples)有一个用于创建配置和调用[授权函数](https://code.google.com/p/google-api-javascript-client/wiki/ReferenceDocs)的代码片段。我已将范围更改为我认为驱动所需的范围：

```
var config = {
    'client_id': 'my_client_ID',
    'scope': 'https://www.googleapis.com/auth/drive.file'
  };
  gapi.auth.authorize(config, function() {
    console.log(gapi.auth);
  }); 
```

回调函数从未被调用（是的，Google API 库已更正加载）查看 Java Retrieve and Use OAuth 2.0 Credentials example，客户端密码似乎是一个参数，这应该进入配置吗？

有没有人在 JS、Drive 或其他 Google API 中尝试过这个？有谁知道调试此类问题的最佳途径，即我是否需要逐步浏览库并停止抱怨？

请不要建议在服务器端进行授权，我们的应用程序完全是客户端，我不希望服务器上有任何状态（我理解这会导致令牌刷新问题）。我熟悉 Google 控制台中的 API 配置，我相信驱动 SDK 设置是正确的。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-04-26T10:13:14.007

可以将 Google APIs Javascript 客户端库与 Drive 一起使用，但您必须意识到存在一些痛点。

目前有两个主要问题，这两个问题都有解决方法：

## 授权

首先，如果您仔细了解 Google Drive 身份验证的工作原理，您会发现，在用户安装了您的 Drive 应用程序并尝试使用您的应用程序打开文件或创建新文件后，Drive 会自动启动 OAuth 2.0 授权流程并auth 参数设置为**response_type=code**和**access_type=offline**。这基本上意味着现在 Drive 应用程序被迫使用 OAuth 2 服务器端流程，这对 Javascript 客户端库（仅使用客户端流程）没有任何用处。

问题在于：Drive 启动服务器端 OAuth 2.0 流程，然后 Javascript 客户端库启动客户端 OAuth 2.0 流程。

这仍然可以工作，您所要做的就是使用服务器端代码来处理驱动器服务器端流程后返回的授权代码（您需要将其交换为访问令牌和刷新令牌）。这样，只有在第一个流程中才会提示用户进行授权。第一次交换授权码后，会自动绕过授权页面。

[我们的文档](https://developers.google.com/drive/credentials)中提供了执行此操作的服务器端示例。

如果您不在服务器端流程上处理/交换身份验证代码，则每次用户尝试从云端硬盘使用您的应用时，都会提示他进行身份验证。

## 处理文件内容

第二个问题是我们的 Javascript 客户端库无法轻松上传和访问实际的 Drive 文件内容。您仍然可以这样做，但您必须使用自定义 Javascript 代码。

**读取文件内容**

当检索文件元数据/文件对象时，它包含`downloadUrl`指向实际文件内容的属性。现在可以使用 CORS 请求下载文件，最简单的身份验证方法是在 URL 参数中使用 OAuth 2 访问令牌。因此，只需使用 XHR 或通过将用户转发到 URL 来附加并获取`&access_token=...`文件。`downloadUrl`

**上传文件内容**

更新更新：上传端点**现在**支持 CORS。

~~更新：与 Drive API 的其余部分不同，上传端点不支持 CORS，因此您现在必须使用以下技巧：~~

上传文件很棘手，因为它不是内置在 Javascript 客户端库中，而且您不能完全使用[本响应](https://stackoverflow.com/questions/10317638/inserting-file-to-google-drive-through-api/10323612#10323612)中描述的 HTTP 来完成，因为我们不允许在这些 API 端点上进行跨域请求。因此，您必须利用我们的 Javascript 客户端库使用的 iframe 代理，并使用它向 Drive SDK 发送构建的多部分请求。感谢[@Alain](https://stackoverflow.com/users/1106381/alain)，我们在下面有一个如何做到这一点的示例：

```
/**
 * Insert new file.
 *
 * @param {File} fileData File object to read data from.
 * @param {Function} callback Callback function to call when the request is complete.
 */
function insertFileData(fileData, callback) {
  const boundary = '-------314159265358979323846';
  const delimiter = "\r\n--" + boundary + "\r\n";
  const close_delim = "\r\n--" + boundary + "--";

  var reader = new FileReader();
  reader.readAsBinaryString(fileData);
  reader.onload = function(e) {
    var contentType = fileData.type || 'application/octet-stream';
    var metadata = {
      'title': fileData.fileName,
      'mimeType': contentType
    };

    var base64Data = btoa(reader.result);
    var multipartRequestBody =
        delimiter +
        'Content-Type: application/json\r\n\r\n' +
        JSON.stringify(metadata) +
        delimiter +
        'Content-Type: ' + contentType + '\r\n' +
        'Content-Transfer-Encoding: base64\r\n' +
        '\r\n' +
        base64Data +
        close_delim;

    var request = gapi.client.request({
        'path': '/upload/drive/v2/files',
        'method': 'POST',
        'params': {'uploadType': 'multipart'},
        'headers': {
          'Content-Type': 'multipart/mixed; boundary="' + boundary + '"'
        },
        'body': multipartRequestBody});
    if (!callback) {
      callback = function(file) {
        console.log(file)
      };
    }
    request.execute(callback);
  }
} 
```

* * *

为了改善这一切，未来我们可能会：

*   让开发人员选择他们想要使用的 OAuth 2.0 流程（服务器端或客户端），或者让开发人员完全处理 OAuth 流程。
*   `/upload/...`在端点上允许 CORS
*   `exportLinks`在原生 gDocs上允许 CORS
*   我们应该使用我们的 Javascript 客户端库更容易上传文件。

虽然在这一点上没有承诺:)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-07-01T07:24:08.400

我做到了。这是我的代码：

```
<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8' />
    <style>
        p {         
            font-family: Tahoma;
        }
    </style>
  </head>
  <body>
    <!--Add a button for the user to click to initiate auth sequence -->
    <button id="authorize-button" style="visibility: hidden">Authorize</button>
    <script type="text/javascript">
      var clientId = '######';
      var apiKey = 'aaaaaaaaaaaaaaaaaaa';
      // To enter one or more authentication scopes, refer to the documentation for the API.
      var scopes = 'https://www.googleapis.com/auth/drive';

      // Use a button to handle authentication the first time.
      function handleClientLoad() {
        gapi.client.setApiKey(apiKey);
        window.setTimeout(checkAuth,1);
      }

      function checkAuth() {
        gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: true}, handleAuthResult);
      }

      function handleAuthResult(authResult) {
        var authorizeButton = document.getElementById('authorize-button');
        if (authResult && !authResult.error) {
          authorizeButton.style.visibility = 'hidden';
          makeApiCall();
        } else {
          authorizeButton.style.visibility = '';
          authorizeButton.onclick = handleAuthClick;
        }
      }

      function handleAuthClick(event) {
        gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: false}, handleAuthResult);
        return false;
      }

      // Load the API and make an API call.  Display the results on the screen.
      function makeApiCall() {
        gapi.client.load('drive', 'v2', function() {

          var request = gapi.client.drive.files.list ( {'maxResults': 5 } );

          request.execute(function(resp) {          
            for (i=0; i<resp.items.length; i++) {
                    var titulo = resp.items[i].title;
                    var fechaUpd = resp.items[i].modifiedDate;
                    var userUpd = resp.items[i].lastModifyingUserName;

                    var fileInfo = document.createElement('li');
                    fileInfo.appendChild(document.createTextNode('TITLE: ' + titulo + ' - LAST MODIF: ' + fechaUpd + ' - BY: ' + userUpd ));                
                    document.getElementById('content').appendChild(fileInfo);
            }
          });        
        });
      }
    </script>
    <script src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>    
    <p><b>These are 5 files from your GDrive :)</b></p>
    <div id="content"></div>
  </body>
</html> 
```

你只需要改变：

*   var clientId = '######';
*   var apiKey = 'aaaaaaaaaaaaaaaaaaa';

从您的 Google API 控制台到您的 clientID 和 ApiKey :)

当然，您必须在 Google API 控制台上创建您的项目，激活 Drive API 并在 OAuth 2.0 中激活 Google 帐户身份验证（真的很容易！）

PS：它不会在您的 PC 上本地运行，它会在某些主机上运行，​​并且您必须在项目控制台上提供它的 url :)

# javascript - 在 javascript 中预加载 SVG

> ID：10330997
> 
> 赞同：2
> 
> 时间：2012-04-26T09:47:45.150
> 
> 标签：javascript, jquery, image, svg, preloading

我知道 javascript 可以在输出之前使用 Image() 对象来准备图像，但是我需要 SVG 的相同功能。我不想将它加载到“img”标签中，而是在 javascript 中构建 SVG 标记并确保在将 src 文件转储到屏幕之前加载它们。有谁知道这是否可能以及如何实现？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-04-26T09:50:04.477

只需通过通常的 AJAX-GET 请求检索您的 SVG 文件，并在此请求成功时插入代码。

```
$.get( 'path/to/your/svg/file.svg', function(data) {
  $('#svgContainer').html( data );
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-04-28T09:46:42.470

您可以创建一个 <iframe>，为 iframe 上的“加载”添加一个事件侦听器，然后将 iframe 的 src 设置为您要加载的 svg。

例如：

```
var iframe = document.createElement("iframe");
iframe.addEventListener('load', function() {
  ... svg now loaded, do something ...
});
iframe.src = "your.svg"; 
```

如果您希望可以将元素导入到主文档中，只需注意在尝试附加它们之前您需要将节点[导入](http://www.w3.org/TR/DOM-Level-3-Core/core.html#Core-Document-importNode)或[采用到主文档中。](http://www.w3.org/TR/DOM-Level-3-Core/core.html#Document3-adoptNode)

像 Sirko 建议的那样使用 XmlHttpRequest 可能更自然。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-26T09:57:47.693

你可以使用`createElementNS()`：

```
var img = document.createElementNS('http://www.w3.org/2000/svg','image');
img.setAttributeNS(null,'height','536');
img.setAttributeNS(null,'width','536');
img.setAttributeNS('http://www.w3.org/1999/xlink','href','https://upload.wikimedia.org/wikipedia/commons/2/22/SVG_Simple_Logo.svg');
img.setAttributeNS(null,'x','10');
img.setAttributeNS(null,'y','10');
img.setAttributeNS(null, 'visibility', 'visible');
$('svg').append(img); 
```

# apache-camel - 在 Apache Camel 中的处理器之间传递值

> ID：10330998
> 
> 赞同：29
> 
> 时间：2012-04-26T09:47:52.030
> 
> 标签：apache-camel

在 apache camel 中，哪一个是将值从交换处理器传递到另一个（以及为什么）的最佳方式：

*   将其存储在交换标头中
*   `setProperty`在构建路线时使用该方法。
*   其他方式..

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-04-27T13:52:04.953

Ben 和 Petter 没有提到的一个区别是，在 Camel 中处理消息的整个过程中，属性都是安全存储的。相反，标头是消息协议的一部分，并且可能不会在路由期间传播。例如，JMS 限制了您可以存储为标题等的内容。

您可能想阅读 Camel in Action 一书的免费第 1 章，因为它涵盖了 Exchange、Message 等的 Camel 概念。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-04-26T21:58:06.867

属性和标题几乎相同。但是，标头转换为/从某些组件（例如 Jms）上的协议特定标头转换。所以，

*   路由内的元数据：属性
*   进出外部的元数据：标头

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2012-04-26T16:25:25.950

[交换](http://camel.apache.org/maven/current/camel-core/apidocs/org/apache/camel/Exchange.html)在处理器之间传递。它包含属性、IN 消息和可选的 OUT 消息。它们中的每一个都能够存储对象数据，但通常：

*   使用 Exchange 属性获取有关消息的一般元数据（使用频率较低）
*   使用 IN 消息头来配置端点属性或关于消息体的元数据（经常使用）
*   使用 IN 消息体作为消息的有效负载（最常用）
*   仅在必要时创建 OUT 消息以在处理期间维护单独的 IN 和 OUT 消息（默认情况下仅使用 IN）

也就是说，它实际上取决于在您的处理器之后调用的组件。大多数都有一些使用端点等所需的标头和/或正文值。有关这些详细信息，请参阅特定[组件页面](http://camel.apache.org/components.html)。

此外，在这些页面上更详细地解释了交换/消息：

[http://camel.apache.org/maven/current/camel-core/apidocs/org/apache/camel/Exchange.html](http://camel.apache.org/maven/current/camel-core/apidocs/org/apache/camel/Exchange.html)

[http://fusesource.com/docs/router/2.8/prog_guide/MsgFormats-Exchanges.html](http://fusesource.com/docs/router/2.8/prog_guide/MsgFormats-Exchanges.html)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-06-14T15:10:50.407

答案在这里：

属性：属性是一个 Map，可能看起来像消息头。主要区别在于它们的生命周期：属性存在于整个交换执行期间，而标头仅限于消息持续时间（并且消息在路由期间可能会发生很大变化，因此在交换执行期间）。Camel 本身可能会为某些用例添加一些属性。