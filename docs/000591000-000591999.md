# StackOverflow 问答 000591000-000591999

# c# - 识别 IDisposable 对象

> ID：591000
> 
> 赞同：14
> 
> 时间：2009-02-26T15:24:14.810
> 
> 标签：c#, memory-leaks, dispose, idisposable, using-statement

我必须查看其他人编写的代码，该代码有一些内存泄漏。现在我正在搜索一次性对象以使用 using 语句将它们包含在内，我想知道是否有一种快速方法可以告诉您声明的所有一次性对象。我的意思是像 resharper 或其他 Visual Studio 插件。

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-26T15:29:31.270

我明白你的意思。我不知道，但看看 FxCop。它可能在某处有一条规则来检查实现 IDisposable 的对象是否未释放。只是一种预感，请注意。

**更新**：[米奇小麦](https://stackoverflow.com/users/16076/mitch-wheat)写道：

> FxCop 包含规则，也就是说，从实现 IDisposable 的类型派生的所有类型都应该实现 Dispose() 模式

谢谢，米奇。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-26T15:51:39.330

[你可以用ReSharper](http://www.jetbrains.com/resharper/)做到这一点。使用 ReSharper，您可以使用 Alt-End 轻松导航任何接口的实现，但对于像`IDisposable`这样的流行接口是不切实际的。

这是你可以做的：

1.  转到对象浏览器（Ctrl-Alt-J 或查看->对象浏览器）
2.  寻找`System.IDisposable`
3.  右键单击并选择“Find Usages Advanced”（ReSharper 的菜单项）
4.  用户查找，检查“实施”，在范围下选择解决方案
5.  您将获得实施的*所有*类型（您的解决方案）的列表`IDisposable`。粗体**字**是你想要的——它们`IDisposable`直接实现。

希望有帮助。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-26T15:54:35.767

使用规则 FxCop 中的 CA2213 (DisposableFieldsShouldBeDisposed) 和 CA2215 (DisposeMethodsShouldCallBaseClassDispose) 将捕获您自己的类中未正确调用 dispose 的位置，但我不相信有任何东西可以检查 dispose 总是被调用，尽管具有讽刺意味的是有一个规则（ CA2202) 用于 DoNotDisposeObjectsMultipleTimes

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T15:44:57.753

此外，根据您是否使用这样的系统，如果您使用的是 IoC 容器，它可能会在服务通过接口返回给您之前经过几层代码，并且在这种情况下处理 IDisposable 可能并非易事一个案例。

也许您解析的接口不是从 IDisposable 继承的，但实际使用的服务类会继承吗？如何处理？等等

# java - 泛型..？超级T

> ID：591004
> 
> 赞同：13
> 
> 时间：2009-02-26T15:25:14.823
> 
> 标签：java, generics

> **可能重复：**
> [Java 泛型中的“超级”和“扩展”有什么区别](https://stackoverflow.com/questions/1910892/what-is-the-difference-between-super-and-extends-in-java-generics)

一个）

```
List<? super Shape> shapeSuper = new ArrayList<Shape>();

shapeSuper.add(new Square());       //extends from SHAP  
shapeSuper.add(new DoubleSquare()); //extends from SQ  
shapeSuper.add(new TripleSquare()); //extends from DS  
shapeSuper.add(new Rectangle());    //extends from SHAP  
shapeSuper.add(new Circle());       //extends from SHAP  

for (Object object : shapeSuper) { ... } 
```

当我只能添加形状及其衍生物时，为什么迭代必须是对象？

二）

```
List<? super Shape> shapeSuper = new ArrayList<Object>();  

shapeSuper.add(new Object()); //compilation error 
```

为什么上面的行会产生编译错误？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-26T23:22:19.560

For your example, you can use a plain `List<Shape>` like Dan and Paul said; you don't need to use the wildcard question mark syntax such as `List<? super Shape>` or `List<? extends Shape>`). I think your underlying question may be, "when would I use one of the question mark style declarations?" (The Get and Put Principle that Julien cites is a great answer to this question, but I don't think it makes much sense unless you see it in the context of an example.) Here's my take at an expanded version of the Get and Put Principle for when to use wildcards.

Use `<? extends T>` if...

*   A method has a generic class parameter `Foo<T>` readSource
*   The method GETS instances of T from readSource, and doesn't care if the actual object retrieved belongs to a subclass of T.

Use `<? super T>` if...

*   A method has a generic class parameter `Foo<T>` writeDest
*   The method PUTS instances of T into writeDest, and doesn't care if writeDest also contains objects that are subclasses of T.

Here's a walkthrough of a specific example that illustrates the thinking behind wildcards. Imagine you are writing a processSquare method that removes a square from a list, processes it, and stores the result in an output list. Here's a method signature:

```
void processSquare(List<Square> iSqua, List<Square> oSqua)
{ Square s = iSqua.remove(0); s.doSquare(); oSqua.add(s); } 
```

Now you create a list of DoubleSquares, which extend Square, and try to process them:

```
List<DoubleSquare> dsqares = ... 
List<Square> processed = new ArrayList<Square>;
processSquare(dsqares, processed); // compiler error! dsquares is not List<Square> 
```

The compiler fails with an error because the type of dsquares `List<DoubleSquare>` doesn't match the type of the first parameter to processSquare, `List<Square>`. Perhaps a DoubleSquare is-a Square, but you need to tell the compiler that a `List<DoubleSquare>` is-a `List<Square>` for the purposes of your processSquare method. **Use the `<? extends Square>` wildcard to tell the compiler that your method can take a List of any subclass of Square.**

```
void processSquare(List<? extends Square> iSqua, List<Square> oSqua) 
```

Next you improve the application to process Circles as well as Squares. You want to aggregate all your processed shapes in a single list that includes both circles and squares, so you changed the type of the processed list from a `List<Square>` to a `List<Shape>`:

```
List<DoubleSquare> dsqares = ... 
List<Circle> circles = ... 
List<Shape> processed = new ArrayList<Square>;
processSquare(dsqares, processed); // compiler error! processed is not List<Square> 
```

The compiler fails with a new error. Now the type of the processed list `List<Shape>` doesn't match the 2nd parameter to processSquare, `List<Square>`. **Use the `<? super Square>` wildcard to tell the compiler that a given parameter can be a List of any *superclass* of Square.**

```
void processSquare(List<? extends Square> iSqua, 
                          List<? super Square> oSqua) 
```

Here's the full source code for the example. Sometimes I find it easier to learn stuff by starting with a working example and then breaking it to see how the compiler reacts.

```
package wild;

import java.util.ArrayList;
import java.util.LinkedList;
import java.util.List;

public abstract class Main {
  // In processing the square, 
  // I'll take for input  any type of List that can PRODUCE (read) squares.
  // I'll take for output any type of List that can ACCEPT (write) squares.
  static void processSquare(List<? extends Square> iSqua, List<? super Square> oSqua) 
  { Square s = iSqua.remove(0); s.doSquare(); oSqua.add(s); }

  static void processCircle(List<? extends Circle> iCirc, List<? super Circle> oCirc) 
  { Circle c = iCirc.remove(0); c.doCircle(); oCirc.add(c); }

  public static void main(String[] args) {
    // Load some inputs
    List<Circle> circles = makeList(new Circle());
    List<DoubleSquare> dsqares = makeList(new DoubleSquare());

    // Collated storage for completed shapes
    List<Shape> processed = new ArrayList<Shape>();

    // Process the shapes
    processSquare(dsqares, processed);
    processCircle(circles, processed);

    // Do post-processing
    for (Shape s : processed)
      s.shapeDone();
  }

  static class Shape { void shapeDone() { System.out.println("Done with shape."); } }
  static class Square extends Shape { void doSquare() { System.out.println("Square!"); } }
  static class DoubleSquare extends Square {}
  static class Circle extends Shape { void doCircle() { System.out.println("Circle!"); } }

  static <T> List<T> makeList(T a) { 
    List<T> list = new LinkedList<T>(); list.add(a); return list; 
  }

} 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-02-26T15:38:21.327

为了扩展[保罗的答案](https://stackoverflow.com/questions/591004/generics-super-t/591011#591011)，将 shapeSuper 声明为 List<? super Shape>，您是说它可以接受任何属于 Shape 超类的对象。对象是形状的超类。这意味着每个列表元素的公共超类是 Object。

这就是为什么必须在 for 循环中使用 Object 类型的原因。就编译器而言，列表可能包含不是形状的对象。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-26T17:06:02.147

第 (2.4) 节中的“获取和放置原则”是[Java 泛型和集合](http://oreilly.com/catalog/9780596527754/)的真正瑰宝：

> Get and Put 原则：当你只从结构中获取值时使用扩展通配符，当你只将值放入结构时使用超级通配符，当你同时获取和放置时不要使用通配符。

![替代文字](https://covers.oreillystatic.com/images/9780596527754/cat.gif)

此外，将类型声明为`List<? super Shape> shapeSuper`一种不好的形式，因为它限制了它的使用。一般来说，我唯一使用通配符的时候是在方法签名中：

```
public void foo(List<? super Shape> shapeSuper) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-26T15:57:47.443

**一个）**

因为`super`表示通用元素的下界类。所以，`List<? super Shape>`可以表示`List<Shape>`或`List<Object>`。

**二）**

因为编译器不知道实际的类型`List<? super Shape>`是什么。

您添加了一个对象，`shapeSuper.add(new Object());`但编译器只知道泛型类型`List`是一种超类型，`Shape`但并不确切知道它是什么。

在您的示例中，`List<? super Shape>`实际上可能会`List<ShapeBase>`强制编译器禁止该`shapeSuper.add(new Object());`操作。

请记住，[泛型不是协变的](http://www.ibm.com/developerworks/java/library/j-jtp01255.html)。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-26T15:27:51.617

尝试将 shapeSuper 声明为`List<Shape>`。然后你可以做

```
for (Shape shape : shapeSuper) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-26T16:22:34.903

（免责声明：我从未将“super”用作通用通配符限定符，因此请谨慎对待...）

对于 (A)，实际上你不能添加 Shape 及其派生词，你只能添加 Shape 及其祖先。我想也许你想要的是

```
List<? extends Shape> shapeSuper = new ArrayList<Shape>(); 
```

指定“扩展”意味着 Shape 和任何从 Shape 派生的东西。指定“super”意味着 Shape 和任何 Shape 的后代。

不确定 (B)，除非 Object 不是隐式的。如果您将 Shape 显式声明为 会发生什么`public class Shape extends Object`？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T21:08:12.407

参考上述内容，我认为这是不正确的：

> 通过将 shapeSuper 声明为`List<? super Shape> shapeSuper`，您是说它可以接受任何属于 Shape 超类的对象

乍一看，这确实很直观，但实际上我不认为它是这样工作的。不能只将 Shape 的任何超类插入 shapeSuper。superShape 实际上是对 List 的引用，它可能被限制为持有特定的（但未指定的）Shape 超类型。

让我们想象一下 Shape 实现了 Viewable 和 Drawable。所以在这种情况下， superShape 引用实际上可能指向 a`List<Viewable>`或 a `List<Drawable>`（或者实际上是 a `List<Object>`）——但我们不知道是哪一个。如果它实际上是 a`List<Viewable>`你不应该能够在其中插入一个`Drawable`实例 - 编译器会阻止你这样做。

下界构造实际上在使泛型类更灵活方面仍然非常有用。在下面的示例中，它允许我们将定义为包含 Shape 的任何超类的 Set 传递给 addShapeToSet 方法 - 我们仍然可以将 Shape 插入其中：

```
public void addShapeToSet(Set<? super Shape> set) {
    set.add(new Shape());
}

public void testAddToSet() {
    //these all work fine, because Shape implements all of these:
    addShapeToSet(new HashSet<Viewable>());
    addShapeToSet(new HashSet<Drawable>());           
    addShapeToSet(new HashSet<Shape>());           
    addShapeToSet(new HashSet<Object>());
} 
```

# java - 如何从插件编写到 Eclipse 控制台的超链接

> ID：591018
> 
> 赞同：3
> 
> 时间：2009-02-26T15:29:27.573
> 
> 标签：java, eclipse, eclipse-plugin

我想将文件的位置作为超链接写入 Eclipse 控制台。当您单击它时，它应该在 eclipse 中打开该文件。我目前正在做这样的事情（但链接不显示）

```
console = new MessageConsole("myconsole", null);
console.activate();
ConsolePlugin.getDefault().getConsoleManager().addConsoles(new IConsole[]{ console });

IPath path = Path.fromOSString(filePath);
IFile file = ResourcesPlugin.getWorkspace().getRoot().getFileForLocation(path);
FileLink fileLink = new FileLink(file, null, 0, 0, 0);
console.addHyperlink(fileLink, 0, 0); 
```

我可能不应该为偏移量、文件长度参数等传入 0。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T10:37:08.423

好吧，事实证明我写的代码很好，除了 2 个小改动它实际上应该是

```
console = new MessageConsole("myconsole", null);
console.activate();
ConsolePlugin.getDefault().getConsoleManager().addConsoles(new IConsole[]{ console });

IPath path = Path.fromOSString(filePath);
IFile file = ResourcesPlugin.getWorkspace().getRoot().getFileForLocation(path);
FileLink fileLink = new FileLink(file, null, -1, -1, -1);
console.addHyperlink(fileLink, 10, 5); 
```

我有点惊讶必须提供偏移量 (10)，它从控制台输出的开头开始计算。为什么你甚至想自己计算，但这是另一个讨论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-26T11:37:02.747

如果你写`(filename:linenumber)`，这一切都会自动发生。

另请参阅[如何让 Eclipse 控制台将文本超链接到源代码文件？](https://stackoverflow.com/q/6469445/796559)

# asp.net - 跨应用程序的 ASP.Net 持久数据

> ID：591019
> 
> 赞同：1
> 
> 时间：2009-02-26T15:29:30.240
> 
> 标签：asp.net, variables, global

如何为 ASP.Net 应用程序保留用户特定的数据。

我尝试了会话变量 - 工作进程回收时不好。

我需要我的应用程序的任何类都可以全局访问的东西。

欢迎咨询。

我尝试使用 asp.net 会话状态服务器，但我得到了一些 DLL 崩溃，因为它们是不可序列化的。

有没有其他方法可以在整个应用程序中使用持久变量？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T15:31:53.293

可以将 ASP.NET 会话状态配置为持久保存到数据库。

[这是有关如何设置它的教程。](http://support.microsoft.com/kb/317604)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T15:30:34.933

将数据存储在数据库（例如 SQL Server）中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T15:36:07.090

您可以将会话状态服务器更改为不在进程中，这将使其更加稳定，并将其与工作进程分开（如果尚未启动，您需要能够在服务器上启动 Asp.NET 状态服务跑步）

```
<sessionState mode="StateServer" stateConnectionString="tcpip=127.0.0.1:42424" sqlConnectionString="data source=127.0.0.1;Trusted_Connection=yes" cookieless="false" timeout="20"/> 
```

此外，如果您需要在同一域中的应用程序之间共享它，您应该能够为它们提供相同的[机器密钥](http://msdn.microsoft.com/en-us/library/ms998288.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T15:43:00.257

你应该使用会话。您可以在这样的类中全局访问会话状态...

```
HttpContext.Current.Session 
```

为避免工作进程回收丢失会话，请使用[StateServer](http://msdn.microsoft.com/en-us/library/system.web.sessionstate.sessionstatemode.stateserver.aspx)模式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T15:31:53.963

您可以使用带有 SQL 数据库的 Profile Provider 作为您的后备存储。

请参阅此[MSDN 文章](http://msdn.microsoft.com/en-us/library/2y3fs9xs.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T15:34:54.673

对于流程回收，您无能为力。如果您巧妙地使用缓存以更全局的方式保留信息，但您仍然有相同的工作进程限制。

我尝试在具有业务实体对象的 n 层设置中设计我的应用程序。我的对象的工厂方法使用类似于惰性实例化模式的缓存。如果它在 cahce 中，拉它。如果没有，则将其放入缓存中以备下次使用。

IE

```
MyAppsNameSpace.MyBusinessLayerNameSpace.MyObject.GetObject(objectID) 
```

现在当它返回我的对象​​时，它可能来自缓存，也可能不是，如果对象使用率很高，那么它可能会被缓存。

这可以在您的整个应用程序中使用，并且因为缓存机制是集中维护的，所以您不必担心它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T22:23:54.707

如果在工作进程回收时丢失数据，则应停止对 Session 使用 InProc 持久模式。使用 StateServer 或 SQL Server。最终，如果您都不满意，您可以构建自己的会话持久性模块。

# database - 如何连接来自两个不同数据库的两个表？

> ID：591021
> 
> 赞同：1
> 
> 时间：2009-02-26T15:30:23.500
> 
> 标签：database, sql-server-2005, database-tools

对于 DbVisualizer，有什么方法可以使用查询并连接位于同一服务器上的两个不同数据库中的两个表？我将以下内容用于 SQL 服务器

```
Select * from table union select * from datbase.dbo.table2 
```

我在 DbVisualizer 上试过这个，但没有用。我该怎么做呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T15:59:27.627

如果数据库位于不同的服务器中，您需要确保将它们设置为链接服务器。

还要注意，优化器在这种情况下相对较弱，无论是否相同。问题是用于加权不同操作成本的统计数据在不同数据库之间不一定有意义，尤其是在两个数据库将“相交”的地方。所以性能不是它可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T15:50:29.550

如果 DBVisualizer 支持视图，请在数据库中手动设置 table2 的视图。

```
create view table2 as  select * from database.dbo.table2 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-26T16:30:08.300

我不认为它可以做到。我通过每晚运行到 SQL 服务器的数据传输解决了这种情况。我从那里做工会选择......

# floating-point - 实现浮点减法

> ID：591046
> 
> 赞同：4
> 
> 时间：2009-02-26T15:35:16.670
> 
> 标签：floating-point, subtraction

我正在尝试实现一个浮点算术库，但我无法理解减去浮点数的算法。我已经成功地实现了加法，我认为减法只是它的一个特例，但似乎我在某处犯了错误。我在这里添加代码仅供参考，它有很多自我解释的功能，但我不希望有人能 100% 理解它。我想要帮助的是算法。我们遵循与添加浮点数相同的方法，除了当我们添加尾数时，我们将负数（我们减去的数）转换为二进制补码然后添加它们？

这就是我正在做的，但结果不正确。尽管它非常接近......但不一样。有人有什么想法吗？提前致谢！

我很确定我做事的方式是有效的，因为我实现了一个几乎相同的算法来添加浮点数，它就像一个魅力。

```
_float subFloat(_float f1,_float f2)
{
unsigned char diff;
_float result;

//first see whose exponent is greater
if(f1.float_parts.exponent > f2.float_parts.exponent)
{
    diff = f1.float_parts.exponent - f2.float_parts.exponent;

    //now shift f2's mantissa by the difference of their exponent to the right
    //adding the hidden bit
    f2.float_parts.mantissa = ((f2.float_parts.mantissa)>>1) | (0x01<<22);
    f2.float_parts.mantissa >>= (int)(diff);//was (diff-1)

    //also increase its exponent by the difference shifted
    f2.float_parts.exponent = f2.float_parts.exponent + diff;
}
else if(f1.float_parts.exponent < f2.float_parts.exponent)
{
    diff = f2.float_parts.exponent - f1.float_parts.exponent;
    result = f1;
    f1 = f2;        //swap them
    f2 = result;

    //now shift f2's mantissa by the difference of their exponent to the right
    //adding the hidden bit
    f2.float_parts.mantissa = ((f2.float_parts.mantissa)>>1) | (0x01<<22);
    f2.float_parts.mantissa >>= (int)(diff);

    //also increase its exponent by the difference shifted
    f2.float_parts.exponent = f2.float_parts.exponent + diff;
}
else//if the exponents were equal
  f2.float_parts.mantissa = ((f2.float_parts.mantissa)>>1) | (0x01<<22); //bring out the hidden bit

//getting two's complement of f2 mantissa
f2.float_parts.mantissa ^= 0x7FFFFF;
f2.float_parts.mantissa += 0x01;

result.float_parts.exponent = f1.float_parts.exponent;
result.float_parts.mantissa = (f1.float_parts.mantissa +f2.float_parts.mantissa)>>1;
                                                //gotta shift right by overflow bits

//normalization
if(manBitSet(result,1))
    result.float_parts.mantissa <<= 1;  //hide the hidden bit
else
    result.float_parts.exponent +=1;

return result;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T15:56:19.100

`a-b == a+(-b)`，并且一元减号是微不足道的，所以我什至不会打扰二进制减号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T16:17:55.117

如果您的加法代码正确，而您的减法不正确，则问题可能出在二进制补码和加法中。

是否有必要做两者的补码和加法，而不是减法？

如果这不是问题，那么我的算法有问题。我已经有一段时间没有做这样的事情了。你能提供一些细节吗？更具体地说，隐藏位是什么？

在我看来，隐藏位的处理适用于加法而不是减法。难道你应该将它设置在 f1 尾数而不是 f2 中？或者否定 f1 尾数而不是 f2？

在不知道您得到什么与您期望什么以及您正在使用的算法的更多细节的情况下，这是我能做的最好的事情。

编辑：好的，我查看了您评论中的参考资料。您在提供的代码中没有做的一件事是规范化。添加时，隐藏位溢出（尾数左移，指数递增），或者它们不溢出。减法时，尾数的任意部分可以为零。十进制，考虑加0.5E1和0.50001E1；你会得到 1.00001E1，如果你要标准化，你会得到 0.10001E2。当从 0.50001E1 中减去 0.5E1 时，得到 0.00001E1。然后你需要将尾数向左移动，并尽可能减少指数，得到 0.1E-4。

# command-line - 挂在 RDP 窗口中的命令行窗口

> ID：591047
> 
> 赞同：16
> 
> 时间：2009-02-26T15:35:56.327
> 
> 标签：command-line, rdp

我们定期通过 RDP 访问构建机器，并且打开了许多命令行窗口。有时这些窗口像有人将焦点切换到它们并按下暂停键一样挂起。敲击键盘会移动进程，但每隔一段时间就会错过这一点，每个人都在等待进程完成，而它正在等待某人按下一个键。为什么会这样？是否有可以阻止它发生的设置或版本升级/降级？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-26T15:51:35.523

发生这种情况时，窗口标题是否显示“选择命令提示符”？如果是这样，按下一个键将取消暂停，但击键也将被发送到暂停的程序，除非它是 ESC 或 enter （或可能其他）。您可以通过进入命令提示符属性/默认值并取消选中“快速编辑模式”来关闭此功能。

如果不是这样，您将不得不发布有关您的构建过程的更多信息。您的构建系统是用什么编写的（make、scons、jam、msbuild 等）？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-26T15:52:33.930

在命令行 Windows 中需要注意的一件事；如果您启用了快速编辑模式（单击标题栏中的图标、属性...、选项选项卡），您可以使用鼠标突出显示和复制，绕过编辑菜单。在窗口中单击鼠标会突出显示下面的字符，并且控制台将显示为“挂起”，直到按下一个键。

# datetime - 从 SQL Server 中获取 UTC 日期并在网格中显示为本地时间

> ID：591064
> 
> 赞同：1
> 
> 时间：2009-02-26T15:40:03.320
> 
> 标签：datetime, utc

我在 SQL Server 2005 中有一个表，其中有一个 datetime 列，其中包含 UTC 格式的日期。我希望客户端调用 .NET 服务器应用程序，服务器将返回一个 DataTable，其中包含将客户端绑定到 DataGridView 的记录。** 在客户端上，日期应显示为当地时间 **，客户将在世界上的多个地区。有没有人有任何关于实现这一目标的提示？我当然可以添加几行来循环遍历并在显示之前更新表格中的日期，但我不禁觉得必须有一些时髦时髦的方式来做到这一点。

塔！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T15:43:30.270

[DateTime.ToLocalTime](http://msdn.microsoft.com/en-us/library/system.datetime.tolocaltime.aspx)是您正在寻找的。

本质上，您调用该方法的事实告诉 DateTime 对象添加当前区域性与 UTC 的偏移量并返回结果。 [DateTime.ToUniversalTime](http://msdn.microsoft.com/en-us/library/system.datetime.touniversaltime.aspx)则相反。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T11:34:53.333

首先，确保表中的 DATETIME 值存储为 UTC 值。

之后，当您阅读它们时，“客户端”应用程序可以将它们转换为本地日期时间（无论是什么）。

插入/更新内容时，请确保在存储到数据库之前从本地转换为 utc。

# c# - 您发现哪种方法输出动态 HTML 更具可读性？

> ID：591067
> 
> 赞同：0
> 
> 时间：2009-02-26T15:41:04.597
> 
> 标签：c#, readability, html-generation

我想这将归结为个人喜好，但你会走哪条路？

```
StringBuilder markup = new StringBuilder();

foreach (SearchResult image in Search.GetImages(componentId))
{
    markup.Append(String.Format("<div class=\"captionedImage\"><img src=\"{0}\" width=\"150\" alt=\"{1}\"/><p>{1}</p></div>", image.Resolutions[0].Uri, image.Caption));
}

LiteralMarkup.Text = markup.ToString(); 
```

比。

```
StringBuilder markup = new StringBuilder();

foreach (SearchResult image in Search.GetImages(componentId))
{
    markup.Append(String.Format(@"<div class=""captionedImage""><img src=""{0}"" width=""150"" alt=""{1}""/><p>{1}</p></div>", image.Resolutions[0].Uri, image.Caption));
}

LiteralMarkup.Text = markup.ToString(); 
```

还是我根本不应该这样做，而是使用 HtmlTextWriter 类？

**编辑：这里有一些非常好的建议。我们在 2.0 框架上，所以 LINQ 不可用**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T15:43:14.483

就我个人而言，我会选择第一个选项。还要指出，这里有一个快速的代码保存技巧。您可以将**AppendFormat**用于 StringBuilder。

**编辑： HtmlTextWriter 方法会给你一个更加结构化的结果，如果要生成的 HTML 数量增加，那么这将是一个明显的选择。或使用 HTML 文件并将其用作模板以及可能的字符串替换**

ASP.NET 用户控件是另一个不错的模板选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T15:46:44.303

再次投票给“AppendFormat”。此外，为了服务器代码，我可能会在这里使用单引号以避免需要转义任何内容：

```
StringBuilder markup = new StringBuilder();

foreach (SearchResult image in Search.GetImages(componentId))
{
    markup.AppendFormat(
        "<div class='captionedImage'><img src='{0}' width='150' alt='{1}'/><p>{1}</p></div>", 
        image.Resolutions[0].Uri, image.Caption
      );
}

LiteralMarkup.Text = markup.ToString(); 
```

最后，您可能还需要在某处进行额外检查以防止 html/xss 注入。

另一种选择是将您的图像封装在一个类中：

```
public class CaptionedHtmlImage
{  
    public Uri src {get; set;};
    public string Caption {get; set;}

    CaptionedHtmlImage(Uri src, string Caption)
    {
        this.src = src;
        this.Caption = Caption;
    }

    public override string ToString()
    {
        return String.Format(
            "<div class='captionedImage'><img src='{0}' width='150' alt='{1}'/><p>{1}</p></div>"
            src.ToString(), Caption
          );
    }
} 
```

这样做的好处是，随着时间的推移，可以轻松地重复使用并为概念添加功能。要获得真正的幻想，您可以将该类转换为用户控件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T15:46:08.720

我更喜欢：

```
StringBuilder markup = new StringBuilder();
string template = "<div class=\"captionedImage\"><img src=\"{0}\" width=\"150\" alt=\"{1}\"/><p>{1}</p></div>";

foreach (SearchResult image in Search.GetImages(componentId))
{
   markup.AppendFormat(template,image.Resolutions[0].Uri, image.Caption);
}

LiteralMarkup.Text = markup.ToString(); 
```

正如另一个答案中提到的，使用 AppendFormat()。

看看[SharpTemplate](http://www.codeplex.com/SharpTemplate)的 html 模板，即使是少量的 HTML，它也能更容易阅读。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T15:48:54.703

我更喜欢在 aspx 中使用正是为此目的而制作的 ListView 控件。因此，您的代码将保持可读性并且是分开的（C# 代码中没有 HTML）。使用您的方法，您将不会收到编译时 XHTML 验证警告。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T16:00:47.233

我制作了一些帮助类来创建 html 控件，所以我的代码如下所示：

```
foreach (SearchResult image in Search.GetImages(componentId)) {
  ContainerMarkup.Controls.Add(
    Tag.Div.CssClass("captionedImage")
    .AddChild(Tag.Image(image.Resolutions[0].Uri).Width(150).Alt(Image.Caption))
    .AddChild(Tag.Paragraph.Text(Image.Caption)));
} 
```

起初它可能看起来并不简单，但它很容易使用，创建对值进行正确 html 编码的控件，并且不存在字符串转义问题。

# c++ - Visual Studio项目中的C++文件列表可以动态填充吗？

> ID：591078
> 
> 赞同：0
> 
> 时间：2009-02-26T15:44:21.580
> 
> 标签：c++, visual-studio-2005, compilation

我有一个工具可以生成大多数（但不是全部）需要在 Visual Studio 中编译的文件。该工具读取配置文件并随后生成 c++ 文件。当配置更改时，此列表可能与一个调用不同。

我想知道是否可以根据我的需要调整编译过程，即：

1.  启动工具（如果配置文件已修改则不需要）
2.  检索要编译的 C++ 文件的新列表（最好隔离在项目内的文件夹中）
3.  编译 C++ 文件

编辑：必须关闭 Visual Studio 才能使此过程正常工作对我来说是不行的。这个想法是动态添加 cpp 文件作为编译过程的第一步。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T15:48:13.440

我认为您应该做的是创建一个自定义生成文件并将其用于构建。

请[参阅此页面了解更多信息](http://msdn.microsoft.com/en-us/library/txcwa2xx(VS.71).aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T16:11:30.030

*   使用预构建步骤来运行您的工具。
    *   另外，创建一个包含包含和源列表的文件
    *   该文件名应该是固定的（这样您就不必更改项目属性或 vcproj 文件）——将其添加到项目中。例如：项目属性 > 命令行 > 附加选项 > @headerListingFile

您不是在尝试将 lex/yacc 输出与 VS 集成，是吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T16:26:50.230

[CMake 有](http://www.cmake.org/)帮助吗？它是一个自动化的项目管理器，可为您定义的项目生成 Makefile 和 VS 项目。只需添加一个源文件，重新运行 CMake 即可。

# xml - 如何更好地将 XML 导入/导出到数据库，将 XML 与模式结合起来？

> ID：591081
> 
> 赞同：0
> 
> 时间：2009-02-26T15:44:52.217
> 
> 标签：xml, database, schema

你知道最佳实践吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T16:20:49.540

在我的论文（Java 1.4）中，我以这种方式解决了这个问题：

1.  DOM 解析（但*SAX*方式更好）用于读取 XML 文件并将值插入对象集合（1 个集合用于 1 种节点）；
2.  该数组的循环：在循环中，在第*k*步，我构建了SQL**插入的****StringBuffer ，在 k 位置添加了***k* -Object（作为字符串：使用正确实现的**toString()** ） ；
******   使用另一个或相同的循环执行此 StringBuffer 的**插入**；*****

 *****这个系统是一个草案：你真的可以优化减少步数等。

XML 模式在该系统的运行时是无用的，但您可以将它用于项目数据库。

不是一个非常优化和优雅的系统，但它可以工作:)

# glassfish - Glassfish Eclipselink 加入获取提示不起作用

> ID：591084
> 
> 赞同：1
> 
> 时间：2009-02-26T15:45:07.520
> 
> 标签：glassfish, eclipselink, hint

我很难让 eclipselink.join-fetch 提示在 glassfish 中工作。

我有一个包含 Task 对象集合的 Client 对象，并且 Task 对象具有 WorkPeriod 对象的集合。

我的代码如下所示：

```
Query query = entityManager.createQuery("select client from Client client left join fetch client.tasks");   
//Set hint to allow nested fetch joins
query.setHint("eclipselink.join-fetch","client.tasks.workPeriods");
List<Client> clients = query.getResultList(); 
```

但无论我将 TOPLINK 调试级别设置为精细时做什么，它总是显示实际运行的 SQL 是：

```
SELECT t0.ID, t0.NAME, t1.ID, t1.DESCRIPTION FROM CLIENT t0 LEFT OUTER JOIN (CLIENT_TASK t2 JOIN TASK t1 ON (t1.ID = t2.tasks_ID)) ON (t2.Client_ID = t0.ID) 
```

显然没有做第三层的join fetch。

有没有其他人有这个问题......或者只是我:-(

任何帮助或提示（没有双关语）将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T21:51:39.060

好的，经过 8 个小时的挫折，我已经深究了。

Glassfish V2 不使用 EclipseLink 作为其持久性提供程序，它使用 Toplink Essentitals。不幸的是，Toplink Essentials 没有提供加入获取提示（我对以下链接感到非常困惑，这让我认为它提供了：[https](https://glassfish.dev.java.net/issues/show_bug.cgi?id=1200) ://glassfish.dev.java.net/issues/show_bug.cgi?id=1200虽然这显然是一个功能请求而不是一个功能）。

所以看起来我试图做的事情是不可能的，如果我想在 glassfish 中进行多级急切获取，我将不得不获取 EntityManagers 委托并直接使用 toplink 要领表达式。

# c# - VS 在 C# 代码中获取返回值？

> ID：591086
> 
> 赞同：4
> 
> 时间：2009-02-26T15:45:28.707
> 
> 标签：c#, visual-studio, debugging

在 VS 中调试 C/C++（非托管？）代码时，跳出函数后，您可以在“自动”窗口中看到返回值：

[替代文字 http://img156.imageshack.us/img156/6082/cpp.jpg](http://img156.imageshack.us/img156/6082/cpp.jpg)

但是，这不适用于 C# 代码：

[替代文字 http://img120.imageshack.us/img120/9350/38617355.jpg](http://img120.imageshack.us/img120/9350/38617355.jpg)

除了用临时变量使代码混乱之外，关于如何获取返回值的任何建议？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T16:02:13.423

它实际上是可见的。调试 + 其他 Windows + 寄存器。查看 EAX 的值（x64 中的 RAX）。简单整数类型的值在 EAX 寄存器中返回。做多 EDX:EAX。STx 中的浮点数（x64 中的 XMM00）。

* * *

这很难实现，抖动决定了方法返回值的方式，不同的抖动会做出不同的选择。特别是当返回值类型不简单时，比如结构。如果它很大，那么抖动将在调用方法上保留堆栈空间并传递一个指向该空间的指针，以便被调用方法可以在那里复制返回值。尽管如此，VS2013[终于提供了它](http://blogs.msdn.com/b/visualstudioalm/archive/2013/06/27/seeing-function-return-values-in-the-debugger-in-visual-studio-2013.aspx)，目前在预览版中可用。`$ReturnValue`在“自动”窗口中以及通过使用“立即”窗口中的内在变量和观察表达式中可见。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-26T15:52:13.620

不幸的是，只有在托管代码（C# 或 VB）中才能使用临时变量使代码混乱。CLR 不支持调试器中的“托管返回值”，因此 VS 也不支持。

在 C++ 中，这个特性稍微简单一些。C++ 可以只获取最后一个返回值的寄存器或堆栈位置。它不必处理诸如 JITer 和垃圾收集之类的问题。两者都使诸如此类的功能变得非常复杂。

如果您喜欢此功能，我**强烈**建议您提交功能请求或在 connect 上为现有功能投票

[https://connect.microsoft.com/VisualStudio](https://connect.microsoft.com/VisualStudio)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-28T23:28:01.197

Visual Studio 2013 将此功能添加到 C# 和 VB 代码中。请在预览版[http://www.microsoft.com/visualstudio/eng/2013-preview](http://www.microsoft.com/visualstudio/eng/2013-preview)中查看并告诉我们您的反馈。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T15:58:42.027

您可以将 Main 设置为返回一个 int，如果 Main() 的返回值对您有帮助，但您不会看到 test() 例程的返回值，正如 Jared 所提到的。因此，如果您想查看值，则必须将代码弄乱。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-02T09:50:33.200

[它最终在 VS 2013 中实现。阅读VS 博客上](http://blogs.msdn.com/b/visualstudioalm/archive/2013/06/27/seeing-function-return-values-in-the-debugger-in-visual-studio-2013.aspx)的长篇故事。

简而言之：*退出*或*跳过方法调用会在***Autos**窗口中填充被调用方法的结果。图片胜于文字：

5.  开始调试。
    ![在此处输入图像描述](https://i.stack.imgur.com/VsglP.jpg)

6.  跳过方法调用。

7.  利润！*请注意，所有*嵌套方法调用的返回值都会显示出来。好的！

    ![在此处输入图像描述](https://i.stack.imgur.com/Lqg81.jpg)

[下载 VS 2013 Preview](http://www.microsoft.com/visualstudio/eng/2013-downloads)自己试试。

奖金！还实现了 64 位代码编辑并继续！

# database - 在运行时设置 Crystal Report 数据源

> ID：591088
> 
> 赞同：6
> 
> 时间：2009-02-26T15:45:43.010
> 
> 标签：database, vb6, crystal-reports

创建 Crystal Report 时，我显然设置了用于开发的数据库和服务器连接。

我现在想要在我的 VB 应用程序中做的是动态设置数据库和服务器名称以与报告一起使用。我将这些值作为字符串 varServer 和 varDatabase。

有人知道该怎么做吗？

提前致谢。

PS 我尝试了几种在线解决方案，但在使用 VB6 时遇到了问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T17:35:13.637

[此链接](http://www.tek-tips.com/faqs.cfm?fid=5374)包含您想知道的所有信息。

**更新：**这是与 SQL Server 集成身份验证的最低工作示例。您应该使用表对象的 ConnectionProperties 来设置连接参数。

```
Dim app As New CRAXDDRT.Application
Dim rpt As CRAXDDRT.Report
Dim tbl As CRAXDDRT.DatabaseTable
Dim tbls As CRAXDDRT.DatabaseTables

Set rpt = app.OpenReport("C:\report\repotest.rpt")

For Each tbl In rpt.Database.Tables
    tbl.ConnectionProperties.DeleteAll
    tbl.ConnectionProperties.Add "Provider", "SQLOLEDB"
    tbl.ConnectionProperties.Add "Data Source", "localhost"
    tbl.ConnectionProperties.Add "Initial Catalog", "testdb"
    tbl.ConnectionProperties.Add "Integrated Security", "True"   ' cut for sql authentication
    'tbl.ConnectionProperties.Add "User Id", "myuser"   ' add for sql authentication
    'tbl.ConnectionProperties.Add "Password", "mypass"  ' add for sql authentication
Next tbl

'This removes the schema from the Database Table's Location property.
Set tbls = rpt.Database.Tables
For Each tbl In tbls
    With tbl
        .Location = .Name
    End With
Next

'View the report
Viewer.ReportSource = rpt
Viewer.ViewReport 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-12-16T11:31:49.170

做得好！感谢您的代码！不过，我对其进行了一些更改，因为这部分不起作用：

```
'View the report
Viewer.ReportSource = rpt
Viewer.ViewReport 
```

它有一个找不到对象的错误

所以我这样做了：

```
With Me.CRViewer91
    .ReportSource = rpt
    .ViewReport
End With 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T15:56:39.427

你用的是什么版本的水晶？

在 .net 世界中，我通常将数据集传递给报告，正如 emoreau 所说[的](http://www.emoreau.com/Entries/Articles/2006/09/Feeding-Crystal-Reports-from-your-application.aspx)。

这样，您的连接是从代码而不是水晶设置的，并且可以存储在全局连接属性中。但是，那是.net。我认为您拥有的水晶版本应该具有类似的功能，或者 Emoreau 可能有一个示例，说明如何在您使用的版本中的 VB6 中执行此操作。

希望这能让你开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-09T13:26:33.697

还可以通过添加此代码位来设置报告的默认提供程序。

```
 Dim MyProvider As Object = logOnInfo.ConnectionInfo.LogonProperties.LookupNameValuePair("Provider")
            If IsNothing(MyProvider) = False Then
                MyProvider.Value = "SQLOLEDB"
            End If 
```

# php - 使用 SOAP 访问 Web 服务 - 在 soapclient() 上失败

> ID：591089
> 
> 赞同：0
> 
> 时间：2009-02-26T15:45:57.597
> 
> 标签：php, xml, soap, wsdl

使用 soapclient($myUrl); 时收到以下错误；

SOAP 错误：解析 WSDL

这是我直接访问 WSDL 链接时看到的内容。

http://services" xmlns:apachesoap="http://xml.apache.org/xml-soap" xmlns:impl="http://services" xmlns:intf="http://services" xmlns:soapenc ="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns1="http://rpc.xml.coldfusion" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:wsdlsoap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:xsd="http://www.w3.org/2001/XMLSchema"> http://xml.apache.org/ xml-soap" xmlns="http://www.w3.org/2001/XMLSchema"> http://services"/> http://rpc.xml.coldfusion"/> http://schemas.xmlsoap. org/soap/encoding/"/>

```
 <element name = "key" nillable="true" type="xsd:anyType"/>
                <element name = "value" nillable="true" type="xsd:anyType"/>
            </sequence>
        </complexType>
        <complexType name = "Map">
            <sequence>
                <element maxOccurs = "unbounded" minOccurs="0" name="item" type="apachesoap:mapItem"/>
            </sequence>
        </complexType>

    </schema>
    <schema targetNamespace = "http://rpc.xml.coldfusion" xmlns="http://www.w3.org/2001/XMLSchema">
        <import namespace = "http://services"/>
        <import namespace = "http://xml.apache.org/xml-soap"/>
        <import namespace = "http://schemas.xmlsoap.org/soap/encoding/"/>
        <complexType name = "CFCInvocationException">
            <sequence/>
        </complexType>
        <complexType name = "QueryBean">

            <sequence>
                <element name = "columnList" nillable="true" type="impl:ArrayOf_xsd_string"/>
                <element name = "data" nillable="true" type="impl:ArrayOfArrayOf_xsd_anyType"/>
            </sequence>
        </complexType>
    </schema>
    <schema targetNamespace = "http://services" xmlns="http://www.w3.org/2001/XMLSchema">
        <import namespace = "http://xml.apache.org/xml-soap"/>
        <import namespace = "http://rpc.xml.coldfusion"/>

        <import namespace = "http://schemas.xmlsoap.org/soap/encoding/"/>
        <complexType name = "ArrayOf_xsd_anyType">
            <complexContent>
                <restriction base = "soapenc:Array">
                    <attribute ref = "soapenc:arrayType" wsdl:arrayType="xsd:anyType[]"/>
                </restriction>
            </complexContent>
        </complexType>
        <complexType name = "ArrayOf_xsd_string">

            <complexContent>
                <restriction base = "soapenc:Array">
                    <attribute ref = "soapenc:arrayType" wsdl:arrayType="xsd:string[]"/>
                </restriction>
            </complexContent>
        </complexType>
        <complexType name = "ArrayOfArrayOf_xsd_anyType">
            <complexContent>
                <restriction base = "soapenc:Array">

                    <attribute ref = "soapenc:arrayType" wsdl:arrayType="xsd:anyType[][]"/>
                </restriction>
            </complexContent>
        </complexType>
    </schema>
</wsdl:types>

<wsdl:message name = "updateCampaignResponse">

    <wsdl:part name = "updateCampaignReturn" type="xsd:boolean"/>

</wsdl:message> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T15:49:55.840

看起来 WSDL 的第一部分被砍掉了……那只是一个复制/粘贴错误，还是实际上是你得到的？

如果这实际上是你得到的，那么你的问题就在那里。出于某种原因，您只能获得 WSDL 的“尾端”。

# .net - 如何在 .NET Windows Mobile 手持设备上搜索 XML 文件？

> ID：591090
> 
> 赞同：0
> 
> 时间：2009-02-26T15:46:06.707
> 
> 标签：.net, windows-mobile, compact-framework, searching-xml

我有一个用于数据收集的 .NET Windows Mobile 5.0 应用程序。出于这个问题的目的，假设它是一个带有两个屏幕的调查应用程序 - 一个调查列表屏幕和一个调查详细信息屏幕。单击调查列表屏幕中的调查以显示调查详细屏幕，其中包含您单击的调查的详细信息。

保存新调查的数据后，它将被序列化为手持设备目录中的 XML 文件。以下是 XML 文件格式的示例：

```
<GDO key=”Order”&gt;
<PROP key=”OrderID” dataType=”System.String” value=””/>
<PROP key=”TrackingID” dataType=”System.String” value=””/>
<PROP key=”OrderType” dataType=”System.String” value=””/>
<GDO key=”Customer”&gt;
    <PROP key=”CustomerID” dataType=”System.String” value=””/>
            <PROP key="CustomerName" dataType="System.String" value=""/>
    <PROP key=”Address” dataType=”System.String” value=””/>
    <PROP key=”City” dataType=”System.String” value=””/>
    <PROP key=”State” dataType=”System.String” value=””/>
    <PROP key=”Zip” dataType=”System.Int16” value=””/>
</GDO>
</GDO> 
```

我需要能够搜索此目录中的所有 XML 文件以构建调查列表屏幕的上下文标签列表（使用上面的示例，假设上下文标签是 OrderID 和 CustomerName）。

我目前没有任何特定的文件名命名约定，我认为我已经决定文件扩展名将是 .GDO。

我知道我可以将数据库用于此类工作，但此实现必须基于文件。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T16:02:06.777

恕我直言，您如何在桌面上执行此操作没有区别。

*   遍历目录中的所有文件
*   将 XML 读入 XMLDocument
*   使用 XMLDocument.SelectNodes 和 XPath 查询进行搜索

# php - 如何在 PHP 中重新索引数组但索引从 1 开始？

> ID：591094
> 
> 赞同：171
> 
> 时间：2009-02-26T15:46:37.157
> 
> 标签：php, arrays, indexing

我有以下数组，我想重新索引，以便键反转（理想情况下从 1 开始）：

当前数组（**编辑：**数组实际上看起来像这样）：

```
Array (

[2] => Object
    (
        [title] => Section
        [linked] => 1
    )

[1] => Object
    (
        [title] => Sub-Section
        [linked] => 1
    )

[0] => Object
    (
        [title] => Sub-Sub-Section
        [linked] => 
    )

) 
```

应该如何：

```
Array (

[1] => Object
    (
        [title] => Section
        [linked] => 1
    )

[2] => Object
    (
        [title] => Sub-Section
        [linked] => 1
    )

[3] => Object
    (
        [title] => Sub-Sub-Section
        [linked] => 
    )

) 
```

* * *

## 回答 #1

> 赞同：480
> 
> 时间：2009-02-26T16:07:51.460

如果要从零开始重新索引，只需执行以下操作：

```
$iZero = array_values($arr); 
```

如果您需要从一个开始，请使用以下命令：

```
$iOne = array_combine(range(1, count($arr)), array_values($arr)); 
```

以下是所使用功能的手册页：

*   [`array_values()`](http://ca3.php.net/manual/en/function.array-values.php)
*   [`array_combine()`](http://ca3.php.net/manual/en/function.array-combine.php)
*   [`range()`](http://ca3.php.net/manual/en/function.range.php)

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2011-06-28T13:58:16.313

**这是最好的方法**：

```
# Array
$array = array('tomato', '', 'apple', 'melon', 'cherry', '', '', 'banana'); 
```

返回

```
Array
(
    [0] => tomato
    [1] => 
    [2] => apple
    [3] => melon
    [4] => cherry
    [5] => 
    [6] => 
    [7] => banana
) 
```

通过做这个

```
$array = array_values(array_filter($array)); 
```

你明白了

```
Array
(
    [0] => tomato
    [1] => apple
    [2] => melon
    [3] => cherry
    [4] => banana
) 
```

**解释**

`array_values()`：以数字形式返回输入数组和索引的值。

`array_filter()`：使用用户定义的函数过滤数组的元素（UDF ，**如果没有提供**，**则输入表中所有值为 FALSE 的条目将被删除**。）

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2013-12-04T19:45:28.400

我刚刚发现你也可以做一个

```
array_splice($ar, 0, 0); 
```

这会在原地重新索引，因此您最终不会得到原始数组的副本。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-26T15:48:35.203

为什么要重新索引？只需将 1 添加到索引：

```
foreach ($array as $key => $val) {
    echo $key + 1, '<br>';
} 
```

* * *

**编辑**   澄清问题后：您可以使用`array_values`重置从 0 开始的索引。如果您只想打印元素从 1 开始，则可以使用上面的算法。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-26T16:05:00.920

好吧，我想无论您的最终目标是什么，您实际上都不需要将数组修改为基于 1 而不是基于 0，而是可以像 Gumbo 发布的那样在迭代时处理它。

*但是*，要回答您的问题，此函数应将任何数组转换为基于 1 的版本

```
function convertToOneBased( $arr )
{
    return array_combine( range( 1, count( $arr ) ), array_values( $arr ) );
} 
```

## 编辑

如果您需要，这里有一个更可重用/灵活的功能

```
$arr = array( 'a', 'b', 'c' );

echo '<pre>';
print_r( reIndexArray( $arr ) );
print_r( reIndexArray( $arr, 1 ) );
print_r( reIndexArray( $arr, 2 ) );
print_r( reIndexArray( $arr, 10 ) );
print_r( reIndexArray( $arr, -10 ) );
echo '</pre>';

function reIndexArray( $arr, $startAt=0 )
{
    return ( 0 == $startAt )
        ? array_values( $arr )
        : array_combine( range( $startAt, count( $arr ) + ( $startAt - 1 ) ), array_values( $arr ) );
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-26T15:55:39.633

这将做你想要的：

```
<?php

$array = array(2 => 'a', 1 => 'b', 0 => 'c');

array_unshift($array, false); // Add to the start of the array
$array = array_values($array); // Re-number

// Remove the first index so we start at 1
$array = array_slice($array, 1, count($array), true);

print_r($array); // Array ( [1] => a [2] => b [3] => c ) 

?> 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-02-26T16:16:55.137

您可能需要考虑为什么要使用基于 1 的数组。从零开始的数组（使用非关联数组时）是相当标准的，如果您想输出到 UI，大多数人会通过在输出到 UI 时增加整数来处理解决方案。

在考虑数组的基于 1 的索引器时，请考虑一致性——无论是在您的应用程序中还是在您使用的代码中。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2011-02-06T20:58:16.207

更优雅的解决方案：

```
`$list = array_combine(range(1, count($list)), array_values($list));` 
```

* * *

 `## 回答 #9

> 赞同：5
> 
> 时间：2014-01-29T09:17:41.067

您可以重新索引一个数组，以便新数组从索引 1 开始，如下所示；

```
$arr = array(
  '2' => 'red',
  '1' => 'green',
  '0' => 'blue',
);

$arr1 = array_values($arr);   // Reindex the array starting from 0.
array_unshift($arr1, '');     // Prepend a dummy element to the start of the array.
unset($arr1[0]);              // Kill the dummy element.

print_r($arr);
print_r($arr1); 
```

上面的输出是；

```
Array
(
    [2] => red
    [1] => green
    [0] => blue
)
Array
(
    [1] => red
    [2] => green
    [3] => blue
) 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2013-11-29T12:13:23.123

与@monowerker 类似，我需要使用对象的键重新索引数组...

```
$new = array();
$old = array(
  (object)array('id' => 123),
  (object)array('id' => 456),
  (object)array('id' => 789),
);
print_r($old);

array_walk($old, function($item, $key, &$reindexed_array) {
  $reindexed_array[$item->id] = $item;
}, &$new);

print_r($new); 
```

这导致：

```
Array
(
    [0] => stdClass Object
        (
            [id] => 123
        )
    [1] => stdClass Object
        (
            [id] => 456
        )
    [2] => stdClass Object
        (
            [id] => 789
        )
)
Array
(
    [123] => stdClass Object
        (
            [id] => 123
        )
    [456] => stdClass Object
        (
            [id] => 456
        )
    [789] => stdClass Object
        (
            [id] => 789
        )
) 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-02-26T16:16:03.500

```
$tmp = array();
foreach (array_values($array) as $key => $value) {
    $tmp[$key+1] = $value;
}
$array = $tmp; 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2014-09-23T20:21:35.163

如果您不想重新排序数组，您可以这样做：

$array = array_reverse($array);
$array = array_reverse($array);

array_reverse 非常快，并且在反转时会重新排序。很久以前有人给我看了这个。所以我不能因为提出它而受到赞扬。但它非常简单快捷。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-08-22T19:59:25.137

与 Nick 的贡献类似，我为重新索引数组找到了相同的解决方案，但从 PHP 5.4 版开始稍微增强了该功能，因为通过引用传递变量，它不起作用。`use`使用关键字闭包的示例重新索引函数如下所示：

```
function indexArrayByElement($array, $element)
{
    $arrayReindexed = [];
    array_walk(
        $array,
        function ($item, $key) use (&$arrayReindexed, $element) {
            $arrayReindexed[$item[$element]] = $item;
        }
    );
    return $arrayReindexed;
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2020-04-21T10:06:54.127

我能想到的最快的方法

```
array_unshift($arr, null);
unset($arr[0]);
print_r($arr); 
```

如果你只想重新索引数组（从零开始）并且你有 PHP +7.3 你可以这样做

```
array_unshift($arr); 
```

我相信比前者不创建数组的副本`array_unshift`要好。`array_values`

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2011-12-20T11:43:57.113

重复删除和重新索引一个数组：

```
<?php  
   $oldArray = array('0'=>'php','1'=>'java','2'=>'','3'=>'asp','4'=>'','5'=>'mysql');
   //duplicate removal
   $fillteredArray = array_filter($oldArray);
   //reindexing actually happens  here
   $newArray = array_merge($filteredArray);
   print_r($newArray);
?> 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-09-25T13:12:36.233

这是我自己的实现。输入数组中的键将使用从 $start_index 开始的递增键重新编号。

```
function array_reindex($array, $start_index)
{
    $array = array_values($array);
    $zeros_array = array_fill(0, $start_index, null);
    return array_slice(array_merge($zeros_array, $array), $start_index, null, true);
} 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-01-28T12:28:38.823

只需这样做：

```
<?php

array_push($array, '');
$array = array_reverse($array);
array_shift($array); 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2019-02-08T12:38:28.890

在 PHP 中一起使用 array_values() 和 array_filter() 函数来删除空数组元素并从数组中重新索引后，您可以轻松地做到这一点。

**[array_filter() 函数](http://php.net/manual/en/function.array-filter.php)** PHP array_filter() 函数从 PHP 中的数组中删除空数组元素或值。这也将删除空白、null、false、0（零）值。

**[array_values() 函数](http://php.net/manual/en/function.array-values.php)** PHP array_values() 函数返回一个包含数组所有值的数组。返回的数组将有数字键，从 0 开始并增加 1。

**删除空数组元素并重新索引**

首先让我们看看 $stack 数组输出：

```
<?php
  $stack = array("PHP", "HTML", "CSS", "", "JavaScript", null, 0);
  print_r($stack);
?> 
```

**输出：**

```
Array
(
    [0] => PHP
    [1] => HTML
    [2] => CSS
    [3] => 
    [4] => JavaScript
    [5] => 
    [6] => 0
) 
```

在上面的输出中，我们想要删除空白、null、0（零）值，然后重新索引数组元素。现在我们将一起使用 array_values() 和 array_filter() 函数，如下例所示：

```
<?php
  $stack = array("PHP", "HTML", "CSS", "", "JavaScript", null, 0);
  print_r(array_values(array_filter($stack)));
?> 
```

**输出：**

```
Array
(
    [0] => PHP
    [1] => HTML
    [2] => CSS
    [3] => JavaScript
) 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2020-01-04T05:36:34.737

感觉所有`array_combine()`答案都在复制相同的“错误”（不必要的调用`array_values()`）。

`array_combine()`忽略它接收到的两个参数的键。

代码：（[演示](https://3v4l.org/3hEg4)）

```
$array = [
    2 => (object)['title' => 'Section', 'linked' => 1],
    1 => (object)['title' => 'Sub-Section', 'linked' => 1],
    0 => (object)['title' => 'Sub-Sub-Section', 'linked' => null]
];

var_export(array_combine(range(1, count($array)), $array)); 
```

输出：

```
array (
  1 => 
  (object) array(
     'title' => 'Section',
     'linked' => 1,
  ),
  2 => 
  (object) array(
     'title' => 'Sub-Section',
     'linked' => 1,
  ),
  3 => 
  (object) array(
     'title' => 'Sub-Sub-Section',
     'linked' => NULL,
  ),
) 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-26T18:01:35.180

排序只是一个[sort()](http://php.net/sort)，重新索引似乎有点傻，但如果需要，它会这样做。虽然不是到位。如果您要在很多地方执行此操作，请使用[array_walk()](http://php.net/manual/en/function.array-walk.php)，如果这是一次性操作，则只需使用 for-key-value 循环。

```
<?php

function reindex(&$item, $key, &$reindexedarr) {
    $reindexedarr[$key+1] = $item;
}

$arr = Array (2 => 'c', 1 => 'b', 0 => 'a');

sort($arr);
$newarr = Array();
array_walk($arr, reindex, &$newarr);
$arr = $newarr;
print_r($arr); // Array ( [1] => a [2] => b [3] => c )

?> 
```

* * *

## 回答 #21

> 赞同：-9
> 
> 时间：2009-02-26T15:49:51.067

如果可以创建一个新数组，那就是：

```
$result = array();
foreach ( $array as $key => $val )
    $result[ $key+1 ] = $val; 
```

如果您需要就地反转，则需要向后运行，以免踩到所需的索引：

```
for ( $k = count($array) ; $k-- > 0 ; )
    $result[ $k+1 ] = $result[ $k ];
unset( $array[0] );   // remove the "zero" element 
```

# c# - LINQ-to-SQL：ExecuteQuery(Type, String) 填充一个字段，但不填充另一个

> ID：591097
> 
> 赞同：5
> 
> 时间：2009-02-26T15:47:15.097
> 
> 标签：c#, .net, linq-to-sql, datacontext, executequery

我编写了一个应用程序，用作代理从数据库中查询数据并自动将其加载到我的分布式 Web 缓存中。

我通过在配置中指定一个 sql 查询和一个类型来做到这一点。实际执行查询的代码如下所示：

```
List<Object> result = null;
try { result = dc.ExecuteQuery(elementType, entry.Command).OfType<Object>().ToList(); }
catch (Exception ex) { HandleException(ex, WebCacheAgentLogEvent.DatabaseExecutionError); continue; } 
```

`elementType`是从配置中指定的类型创建的 System.Type（使用`Type.GetType()`），并且`entry.Command`是 SQL 查询。

我遇到问题的特定实体类型如下所示：

```
public class FooCount
{
    [Column(Name = "foo_id")]
    public Int32 FooId { get; set; }

    [Column(Name = "count")]
    public Int32 Count { get; set; }
} 
```

SQL 查询如下所示：

```
select foo_id as foo_id, sum(count) as [count]
from foo_aggregates
group by foo_id
order by foo_id 
```

出于某种原因，当查询被执行时，“Count”属性最终被填充，而不是“FooId”属性。我尝试自己运行查询，并返回正确的列名，并且列名与我在映射属性中指定的匹配。帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T16:42:30.627

疯了吧...

解决我的问题的是用以下方式装饰我的实体类`TableAttribute`：

```
[Table(Name = "foo_aggregates")]
public class FooCount
{
    [Column(Name = "foo_id")]
    public Int32 FooId { get; set; }

    [Column(Name = "count")]
    public Int32 Count { get; set; }
} 
```

我曾假设（显然是错误的）因为我没有使用该`GetTable<T>()`方法，所以我不需要相应的映射属性。

**更新：**一年半后，我终于明白，除非类上有相应的 TableAttribute 装饰，否则属性上的 ColumnAttribute 装饰似乎被忽略了。这解释了为什么“计数”属性被填充，因为它的命名将匹配 SQL 语句中的列，而 FooId/foo_id 当然不匹配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T16:28:04.187

当属性的名称与列的名称不同时，Linq To Sql 很难映射东西。尝试使用下划线将您的属性名称更改为 foo_id。那应该是诀窍。

要么，或者您可以将您的选择语句更改为 foo_id 作为 FooId 以匹配您的属性。无论哪种方式，它们应该是相同的（尽管不需要是相同的情况）。

# ruby - Ruby RSS/Atom 处理器，它知道我已经在提要中处理了哪些项目

> ID：591099
> 
> 赞同：3
> 
> 时间：2009-02-26T15:48:08.370
> 
> 标签：ruby, rss

是否有处理 RSS/Atom 提要并跟踪我已经处理的项目的 ruby​​ 类或项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T16:07:15.300

看看这个

[http://simonwoodside.com/weblog/2008/12/7/ruby_on_rails_feedrss_aggregator/](http://simonwoodside.com/weblog/2008/12/7/ruby_on_rails_feedrss_aggregator/)

它是 Rails，与纯 Ruby 不同，但是您需要某种数据存储来跟踪已处理的项目，而 Rails 中的 ActiveRecord 与其他任何东西一样好。

# html - 如何找到表格或单元格的宽度？

> ID：591102
> 
> 赞同：1
> 
> 时间：2009-02-26T15:48:28.213
> 
> 标签：html, html-table, stylesheet

如何在不使用 HTML 或 Javascript 指定的情况下找到表格或表格中列的宽度？

例如：

```
<table id="myTable">
<tr><td>column a</td><td>column b</td></tr>
</table> 
```

在 Javascript 中：

```
var tbl = document.getElementByID("myTable");
alert(tbl.style.width);  //will be undefined 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T16:13:11.727

CSS样式关键字和javascript关键字之间没有直接对应关系。在您的情况下，您需要 tbl.offsetWidth，而不是 tbl.style.width。对于初学者，请参阅[这篇 quirksmode 文章。](http://www.quirksmode.org/dom/getstyles.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T15:54:36.763

在原始 DOM 调用中尝试这些事情是很危险的，因为浏览器不同。

安全的做法是使用库（如[jQuery](http://jquery.com/)）并使用它们的例程。

要在 jQuery 中完全执行您的示例：

```
 $("#myTable").width() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T15:57:32.653

你可以试试：

```
var tbl = document.getElementByID("myTable");
alert(tbl.clientWidth); 
```

它在 FireFox 中运行良好，但您应该在 IE 中检查它。

# sql - 请帮我创建一个正则表达式来解析我的 SQL 语句

> ID：591105
> 
> 赞同：0
> 
> 时间：2009-02-26T15:48:47.137
> 
> 标签：sql, vb.net, regex, text-parsing

我要提取

```
FROM codes WHERE FieldName='ContactMethod' and IsNull(Deactived,'') != 'T' 
```

从

```
SELECT FieldDescription,FieldValue FROM codes WHERE FieldName='ContactMethod'
   and IsNull(Deactived,'') != 'T' order by fielddescription 
```

使用正则表达式。我有一个像这样的正则表达式：

```
\FROM.*\order 
```

提取

```
FROM codes WHERE FieldName='ContactMethod' and IsNull(Deactived,'') != 'T' order 
```

另外，我怎样才能摆脱大写？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T15:52:42.883

这里的技巧可能是用括号捕获你真正想要的部分：

```
(FROM.*) order 
```

这将贪婪地匹配直到最后一个`order`，如果你只想直到第一次出现，就懒惰地匹配：

```
(FROM.*?) order 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T16:17:26.240

扩展 Fabian Steeg 的回答

```
 Dim regex As Regex = New Regex( _
          "(FROM.*?) ORDER", _
        RegexOptions.IgnoreCase _
        Or RegexOptions.CultureInvariant _
        Or RegexOptions.IgnorePatternWhitespace _
        Or RegexOptions.Compiled _
        )

    Dim ms As MatchCollection = regex.Matches(InputText) 
```

其中 InputText 当然是您的 SQL 查询字符串。

ms(1) 应该保持括号匹配

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T16:00:57.560

如果归根结底，您可以通过执行 (F|f)(R|r)(O|o)(M|m) 来忽略大写。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T16:24:07.613

[RegexBuddy](http://www.regexbuddy.com/ "正则表达式好友主页")（40 美元）或[The Regex Coach](http://weitz.de/regex-coach/ "正则表达式教练主页") （免费）等交互式工具将真正帮助您为大多数平台设计和调试正则表达式。

# weblogic - 使用 WLST 退回托管服务器？

> ID：591106
> 
> 赞同：5
> 
> 时间：2009-02-26T15:48:47.933
> 
> 标签：weblogic, wlst

有没有办法使用 WLST 反弹/重新启动托管服务器？ServerRuntime MBean 似乎具有执行此操作的正确功能，但据我所知，您只能访问 WLST 连接到的服务器（即管理服务器）的此 MBean。有没有办法为每个托管服务器访问这个 MBean？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-06T04:53:08.027

是的。我一直在自动构建/部署任务中使用它。

[连接到节点管理器](http://docs.oracle.com/cd/E24329_01/web.1211/e24490/reference.htm#autoId349)并为每个托管服务器/集群调用[关闭](http://docs.oracle.com/cd/E24329_01/web.1211/e24490/reference.htm#autoId365)/[启动。](http://docs.oracle.com/cd/E24329_01/web.1211/e24490/reference.htm#autoId381)

# oracle - Oracle TDE 能否保护 DBA 的数据？

> ID：591112
> 
> 赞同：3
> 
> 时间：2009-02-26T15:50:00.660
> 
> 标签：oracle

甲骨文专家。

我的客户想要部署一个必须在数据库中保存信用卡号的应用程序。客户显然关心安全性。

我们特别关注一个痛苦的问题。我们如何确保只允许具有“业务需要知道”的授权用户访问数据？我们如何保护 DBA 的数据？

一种明显的解决方案是在应用程序级别进行加密。我们不想那样做。

作为一种可能的解决方案出现的 Oracle 产品是 Orace TDE（透明数据加密）。它似乎很好地涵盖了磁盘加密案例。但是，如果它可用于向具有 DBA 权限的人隐藏数据，则存在争议。

我想非常具体地说明我们正在处理的用例。我们有一个启动并运行的应用程序，24/7/365，它不断地进行数据访问。这意味着 Oracle 钱包是打开的，数据正在被数据库解密。同时，DBA 应该仍然无法访问数据。

我知道 Oracle 正在针对这个问题营销 Oracle Database Vault。鉴于我只想阻止 DBA 从一个特定的表访问，我真的需要 Vault 还是可以使用 TDE？

非常感谢您的帮助，

或者

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T16:51:24.413

我的猜测是您需要 Oracle Vault。TDE 无法读取数据文件，但简单的选择仍会检索未加密的数据。

但是请向那些声称 TDE 足够的人解释如何在没有 Oracle Vault 的情况下做到这一点。

编辑：关于这个问题的两个线程：

[http://forums.oracle.com/forums/thread.jspa?messageID=3249532镼](http://forums.oracle.com/forums/thread.jspa?messageID=3249532&#3249532)

[http://forums.oracle.com/forums/thread.jspa?messageID=3261345쎡](http://forums.oracle.com/forums/thread.jspa?messageID=3261345&#3261345)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-28T03:59:07.030

“如果它可以用来向具有 DBA 特权的人隐藏数据，则存在争议。” 可能是因为对于什么是 DBA 特权可能存在相互矛盾的想法。有一个 DBA 数据库角色，一个 SYSDBA 权限和一个可以在操作系统级别以 oracle（或管理员）身份登录服务器的人，每个都具有更高的权限权限可以从 DBA 角色中撤销，因此更加模糊。

例如，VPD 可以确保信用卡列仅对从特定 IP（例如应用程序服务器）登录的用户、作为特定用户或具有特定角色的用户可见。虽然具有 DBA 角色的用户能够更改 VPD 权限，或授予自己适当的角色或模拟相关用户，但这将显示在审核日志中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T13:08:30.603

i came across a similiar problem with one of our customers. During the evaluation process i have found a possible solution from a german security company. It seems they have developed a system that should prevent the DBA to access any sensitive data. Take a look at their [website](http://www.corisecio.com/en/products/data/db_encryption/overview.php). It didn´t take a deeper look yet, so i cannot give you further information about this solution.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-18T04:47:06.730

有一些具有数据库加密和访问控制解决方案的替代公司在 DBA 和安全管理员之间实现了严格的职责分离。

您可能想看看韩国公司 Penta Security Systems 的[D'Amo](https://www.pentasecurity.com/product/encryption/damo/)。

免责声明：我曾担任数据库顾问，并为我的许多客户部署了该解决方案。

# java - 是否有不允许空值的基本 Java Set 实现？

> ID：591115
> 
> 赞同：33
> 
> 时间：2009-02-26T15:50:40.830
> 
> 标签：java, api, null, set

Java [Set](http://java.sun.com/javase/6/docs/api/java/util/Set.html)接口的 API 指出：

> 例如，一些实现禁止`null`元素，而一些实现对其元素的类型有限制

我正在寻找一个不需要排序的基本 Set 实现（因为[ArrayList](http://java.sun.com/javase/6/docs/api/java/util/ArrayList.html)为[List](http://java.sun.com/javase/6/docs/api/java/util/List.html)接口提供）并且不允许`null`. [TreeSet](http://java.sun.com/javase/6/docs/api/java/util/TreeSet.html)、[HashSet](http://java.sun.com/javase/6/docs/api/java/util/HashSet.html)和[LinkedHashSet](http://java.sun.com/javase/6/docs/api/java/util/LinkedHashSet.html)都允许空元素。此外， TreeSet 要求元素实现[Comparable](http://java.sun.com/javase/6/docs/api/java/lang/Comparable.html)。

目前似乎不`Set`存在这样的基础。有谁知道为什么？或者如果确实存在我可以找到它的地方？

[编辑]：我不想允许`null`s，因为稍后在代码中我的类将遍历集合中的所有元素并调用特定方法。（我实际上正在使用`HashSet<MyRandomObject`>）。我宁愿快速失败也不愿稍后失败，或者由于`null`存在于场景中而意外引发一些奇怪的行为。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-26T16:06:23.973

比扩展特定实现更好的是，您可以轻松编写`Set`检查`null`s 的代理实现。这类似于`Collections.checkedSet`. 除了适用于任何实现之外，您还可以确保您已经覆盖了所有适用的方法。通过扩展具体集合发现了许多缺陷，然后在以后的版本中添加了其他方法。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-26T16:28:30.007

我会说使用组合而不是继承......它可能会做更多的工作，但面对 Sun 可能对 Collections Framework 所做的任何更改，它会更加稳定。

```
public class NoNullSet<E> implements Set<E>
{
   /** The set that is wrapped. */
   final private Set<E> wrappedSet = new HashSet<E>();

   public boolean add(E e)
   {
     if (e == null) 
       throw new IllegalArgumentException("You cannot add null to a NoNullSet");
     return wrappedSet.add(e);
   }

   public boolean addAll(Collection<? extends E> c)
   {
     for (E e : c) add(e);
   }

   public void clear()
   { wrappedSet.clear(); }

   public boolean contains(Object o)
   { return wrappedSet.contains(o); }

   ... wrap the rest of them ...
} 
```

请注意，此实现不依赖于`addAll`调用`add`（这是一个实现细节，不应使用，因为不能保证在所有 Java 版本中都保持正确）。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-09-21T14:57:21.443

没有忽略或约束 null 的基本专有 Set 实现！有[EnumSet](http://docs.oracle.com/javase/7/docs/api/java/util/EnumSet.html)，但它是为包含枚举类型量身定制的。

[但是，如果您使用Guava](https://code.google.com/p/guava-libraries/)或[Commons Collections](https://commons.apache.org/proper/commons-collections/)，则可以避免创建自己的实现：

**1.番石榴解决方案：**

```
Set noNulls = Constraints.constrainedSet(new HashSet(), Constraints.notNull()); 
```

**2.公共收藏：**

```
Set noNulls = new HashSet();
CollectionUtils.addIgnoreNull(noNulls, object); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T03:57:28.570

您可以使用 apache 集合及其[PredicatedCollection 类](http://commons.apache.org/collections/api-release/index.html)，并将谓词设置为不允许空值。如果有人发送空值，您将收到异常。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-27T06:08:47.460

这是一种失败的通用方式 - 您提供了一个过滤器实现，可以限制以您想要的任何方式添加的内容。查看 java.util.Collections 的源代码以了解有关包装的想法（我认为我的 FilteredCollection 类的实现是正确的......但它没有经过广泛测试）。最后有一个示例程序显示了用法。

```
public interface Filter<T>
{
    boolean accept(T item);
}

import java.io.Serializable;
import java.util.Collection;
import java.util.Iterator;

public class FilteredCollections
{
    private FilteredCollections()
    {
    }

    public static <T> Collection<T> filteredCollection(final Collection<T> c,
                                                       final Filter<T>     filter)
    {
        return (new FilteredCollection<T>(c, filter));
    }

    private static class FilteredCollection<E>
        implements Collection<E>,
                   Serializable
    {
        private final Collection<E> wrapped;
        private final Filter<E> filter;

        FilteredCollection(final Collection<E> collection, final Filter<E> f)
        {
            if(collection == null)
            {
                throw new IllegalArgumentException("collection cannot be null");
            }

            if(f == null)
            {
                throw new IllegalArgumentException("f cannot be null");
            }

            wrapped = collection;
            filter  = f;
        }

        public int size()
        {
            return (wrapped.size());
        }

        public boolean isEmpty()
        {
            return (wrapped.isEmpty());
        }

        public boolean contains(final Object o)
        {
            return (wrapped.contains(o));
        }

        public Iterator<E> iterator()
        {
            return new Iterator<E>()
            {
                final Iterator<? extends E> i = wrapped.iterator();

                public boolean hasNext()
                {
                    return (i.hasNext());
                }

                public E next()
                {
                    return (i.next());
                }

                public void remove()
                {
                    i.remove();
                }
            };
        }

        public Object[] toArray() 
        {
            return (wrapped.toArray());
        }

        public <T> T[] toArray(final T[] a)
        {
            return (wrapped.toArray(a));
        }

        public boolean add(final E e)
        {
            final boolean ret;

            if(filter.accept(e))
            {
                ret = wrapped.add(e);
            }
            else
            {
                // you could throw an exception instead if you want - 
               // IllegalArgumentException is what I would suggest
                ret = false;
            }

            return (ret);
        }

        public boolean remove(final Object o)
        {
            return (wrapped.remove(o));
        }

        public boolean containsAll(final Collection<?> c)
        {
            return (wrapped.containsAll(c));
        }

        public boolean addAll(final Collection<? extends E> c)
        {
            final E[] a;
            boolean   result;

            a = (E[])wrapped.toArray();

            result = false;

            for(final E e : a)
            {
                result |= wrapped.add(e);
            }

            return result;
        }

        public boolean removeAll(final Collection<?> c)
        {
            return (wrapped.removeAll(c));
        }

        public boolean retainAll(final Collection<?> c)
        {
            return (wrapped.retainAll(c));
        }

        public void clear() 
        {
            wrapped.clear();
        }

        public String toString()
        {
            return (wrapped.toString());
        }
    }
}

import java.util.ArrayList;
import java.util.Collection;

public class Main
{
    private static class NullFilter<T>
        implements Filter<T>
    {
        public boolean accept(final T item)
        {
            return (item != null);
        }
    }

    public static void main(final String[] argv) 
    {
        final Collection<String> strings;

        strings = FilteredCollections.filteredCollection(new ArrayList<String>(), 
                                                         new NullFilter<String>());
        strings.add("hello");
        strings.add(null);
        strings.add("world");

        if(strings.size() != 2)
        {
            System.err.println("ERROR: strings.size() == " + strings.size());
        }

        System.out.println(strings);
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-19T17:48:56.597

[是](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/index.html)的 - 在文档中`com.google.common.collect.ImmutableSet`：

> 具有可靠的、用户指定的迭代顺序的高性能、不可变 Set。**不允许空元素。**

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-26T15:54:47.997

您可以通过继承适当的现有类并覆盖所有相关方法来轻松编写自己的方法，这样您*就无法*添加`null`元素。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-26T16:50:16.083

您可能还希望查看[Google Collections](http://code.google.com/p/google-collections/)。我相信他们更害怕零。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-12-04T17:41:34.137

对我来说，我没有找到，所以我`overrode the add function`

```
Collection<String> errors = new HashSet<String>() {
    @Override
    public boolean add(String s) {
        return StringUtil.hasContent(s) && super.add(s);//we don't want add null and we allow HashSet.add(null)
    }
}; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-02-27T14:11:19.843

> [编辑]：我不想允许空值，因为稍后在代码中我的类将遍历集合中的所有元素并调用特定方法。

**我们可以在迭代 set 之前简单地删除*****一次***`null`null ，而不是检查。

 *您可以使用删除空值`set.remove(null);`

```
 Set<String> set = new HashSet<>();

      set.add("test");
      set.add(null);
      set.add(null);
      System.out.println(set);

      set.remove(null);
      System.out.println(set);

      Iterator<String> iterator = set.iterator();
        while(iterator.hasNext()) {
            System.out.println(iterator.next());
        } 
```

**输出**

```
[null, test]
[test]
test 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-29T07:03:52.467

顺便说一句，如果您要求一个`Map`不允许空值的实现，旧的`java.util.Hashtable`则不允许。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-02-12T21:43:07.933

在这个特定的问题/示例中，如果您 在开始迭代您提到的所有元素之前 有一个`HashSet<MyRandomObject> mySet`电话？`mySet.remove(null)`

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2009-02-26T15:55:13.347

我不确定这是否属实。但是您能否不从您选择的集合或 HashTable 继承并覆盖 Add 方法，如果元素为空则抛出异常？

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-02-26T15:57:15.137

为什么不想让`null`？

`null`如果添加到您的集合中，您想抛出异常吗？如果是这样，只需执行以下操作：

```
private Set<Object> mySet = new HashSet<Object>() {
    @Override
    public boolean add(Object e) {
        if (e == null)
            throw new IllegalArgumentException("null"); // or NPE
        // or, of course, you could just return false
        return super.add(e);
    }
}; 
```

`HashSet`'s反复`addAll()`调用`add()`，因此这是您必须覆盖的唯一方法。

* * *

## 回答 #15

> 赞同：-2
> 
> 时间：2012-08-23T05:26:10.360

Hashtable 不允许空值......

# javascript - 我可以添加 和链接到 javascript 警报吗？

> ID：591130
> 
> 赞同：31
> 
> 时间：2009-02-26T15:53:06.130
> 
> 标签：javascript

我有以下声明：

```
btnApply.Attributes.Add("onclick", "alert('Must be a member to Use this Tool')"); 
```

有没有办法添加一个新行。我试过了，但它显示在文本中。此外，我可以添加一个链接来关闭警报并将用户带到另一个页面吗？

我怎样才能用我的例子做到这一点？

当我添加 \n 时，警报没有出现。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-02-26T15:55:25.607

您不能使用 HTML，但可以添加换行符：

```
alert('line1\nline2'); 
```

如果您确实想要一个丰富的模式弹出窗口，您可以使用[jQuery 的对话框](http://docs.jquery.com/UI/Dialog)功能并将您想要的任何内容放在那里。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-04-06T21:11:41.953

使用 \\n （需要两个斜杠）。

您会注意到，在执行此操作之前，警报甚至不会发布 javascript 错误。\n 将不起作用，因为斜杠需要转义。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-26T15:55:14.937

您不能允许链接，但**可以**有换行符。

只需使用“\n”作为换行符而不是`<br/>`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T15:56:42.610

Javascript 有一个特定的 AlertDialog，当您调用 alert('') 时它会打开，并将整个正文视为文本 - 据我所知，无法将 HTML 添加到显示的对话框中。

我建议使用支持可自定义对话框或模态框的 Javascript 库，如[模态框](http://www.wildbit.com/labs/modalbox/)，以获得所需的行为（看起来会更好）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T15:58:04.633

您不能在 javascript 警报中使用标记。但是，您可以使用“\n”实现换行符

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T15:58:33.183

警报是一个相当粗糙的工具（看起来也是）。也许是时候以一种对网络更友好的方式来做这件事了……

在您的页面上创建一个隐藏的消息 div，而不是执行警报，而是使用一些消息标记（如果您愿意，包括一个锚链接）填充它，然后将其显示给用户。您可以为此添加各种漂亮的视觉技巧，包括淡入/淡出、居中、分层半透明背景等。

编辑：jQuery 对话框（正如其他人所提到的）是处理这个问题的好方法，大多数库都会有一些小部件或其他类似的东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-26T15:58:52.590

简短的回答：你不能。Javascript 对话框是基本的。

您可以[使用 VBScript 的 MsgBox 方法创建自定义对话框](http://www.tizag.com/vbscriptTutorial/vbscriptmsgbox.php)，但这仅适用于打开 VBScript 的 Internet Explorer。不是跨平台的；不建议。

另一种方法是在 HTML 中伪造它，大量的[Javascript](http://jqueryfordesigners.com/coda-popup-bubbles/)[库](http://yensdesign.com/2008/09/how-to-create-a-stunning-and-smooth-popup-using-jquery/)[为](http://plugins.jquery.com/project/popup) [.](http://abeautifulsite.net/notebook/87)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-02-01T10:16:18.873

正如 Gumbo 所说，`\n`正在 100% 工作。但不要忘记在文本和`\n`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-26T15:54:01.477

不，`alert()`只允许纯文本。`\n`换行也是如此。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-11-14T05:31:43.380

也许您可以尝试确认（）而不是警报（）。此解决方案不是链接，而是来自按钮的重定向。

如果将确认包装到其他变量中并检查真/假，则可以执行 2 个操作。

`var r=confirm("Do you wanna do"); if (r==true) { window.location.assign('register.html'); // this will be append to current url. For other, use http:// full url assignement. } else { window.location.assign(''); // cancel does nothing }`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-04-09T04:26:41.593

您可以使用**\n代替****br**换行，但请记住，如果您**在 PHP echo 中使用 alert，**则 \n 将不适合您。您的完整警报将消失。为此，您必须使用**\n**。

# regex - 希望将选项 value="" 替换为之间的文本 本文

> ID：591133
> 
> 赞同：1
> 
> 时间：2009-02-26T15:53:54.380
> 
> 标签：regex, grep

我有这个 html，我想用`value="##"`之间的值替换其中的数值`<option>value</option>`

例如：`<option value="16">Accounting</option>`，我想知道自动将其更改为所需的正则表达式`<option value="Accounting">Accounting</option>`

我计划对整个列表执行此操作。

```
<option value="16">Accounting A.A.S.</option>
<option value="15">Accounting A.S.</option>
<option value="33">Art Studies</option>
<option value="18">Business Administration A.A.S.</option>
<option value="17">Business Administration A.S.</option>
<option value="20">Computer Network Technician</option>
<option value="21">Computer Support Specialist</option>
<option value="40">Criminal Justice A.A.S.</option>
<option value="39">Criminal Justice A.S.</option>
<option value="37">Criminal Justice: Corrections Certificate</option>
<option value="41">Criminal Justice: Cybersecurity</option>
<option value="42">Criminal Justice: Economic Crime</option>
<option value="43">Criminal Justice: Forensic Investigation</option>
<option value="34">Early Childhood</option>
<option value="22">Fashion Buying & Merchandising</option>
<option value="35">Fine Arts</option>
<option value="23">Health Services Management A.S.</option>
<option value="24">Health Services Management Technology A.A.S.</option>
<option value="92">Human Resource Management A.A.S.</option>
<option value="44">Human Services</option>
<option value="25">International Business</option>
<option value="36">Liberal Arts & Sciences: Childhood Education</option>
<option value="49">Liberal Arts & Sciences: Communication Arts</option>
<option value="50">Liberal Arts & Sciences: General Studies</option>
<option value="52">Liberal Arts & Sciences: Social Science</option>
<option value="51">Liberal Arts and Sciences: Humanities</option>
<option value="26">Marketing A.A.S.</option>
<option value="27">Medical Coder/Transcriptionist Certificate</option>
<option value="45">Music Industry</option>
<option value="28">Paralegal</option>
<option value="46">Photographic Technology</option>
<option value="47">Radio/Television Broadcasting</option>
<option value="91">Science A.S.</option>
<option value="29">Small Business Management</option>
<option value="30">Small Business Management: Certificate</option>
<option value="48">Teaching Assistant: Certificate</option>
<option value="31">Travel & Tourism: Hospitality & Events Management</option>
<option value="32">Website and E-Business Development</option> 
```

编辑：我想在 textwrangler 中使用 GREP

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T16:01:47.700

只需删除值属性。`<option>`默认情况下，它的内容取值。

```
<option value="Accounting">Accounting</option> 
```

相当于：

```
<option>Accounting</option> 
```

编辑：使用[sed](http://en.wikipedia.org/wiki/Sed)你可以做

```
sed -r s/' value="[0-9]+"'//g 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T15:59:35.457

我认为这意味着你想要：

```
<option value="14">Foobar</option> 
```

成为：

```
<option value="Foobar">Foobar</option> 
```

如果是这样，这里是Javascript。我假设`select`变量包含周围的`<select>`标签 DOM 元素，例如 by `form.nameOfselect`。

```
for ( var option : select.options ) {
   option.value = option.text;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T15:59:14.973

在 Linux 下：

```
sed 's|<option value="[^"]*">\([^<>]*\)</option>|<option value="\1">\1</option>|g' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T16:02:31.207

如果您的 HTML 格式正确，则可以这样做：

正则表达式：

```
(?<=<option) value="\d+" 
```

替换为空字符串。

在 HTML 中，如果没有 value 属性，选项值会自动回退到显示的文本。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T16:17:20.500

您已添加要在文本编辑器中执行该操作。我写了一些假设你想使用 php，我会放在这里，因为我认为它很重要。

无论如何，使用**TextWrangler （或任何其他文本编辑器）**，替换

```
<option value="[^"]*">([^<]*)</option> 
```

和

```
<option value="\1">\1</option> 
```

* * *

由于您主要在 php 标签中活跃，我假设您在 php.ini 中寻求解决方案。但是，让我从一个建议开始这个答案：**如果您正在寻找一种方法，请说明您的目标，而不是您认为合适的技术。**正则表达式可以工作，但这在[simplexml](http://php.net/simplexml)中要容易得多：

```
$xml = str_replace("&", "&amp;", $xml); // Fix errors in your XML
$doc = simplexml_load_string($xml);
foreach ($doc->xpath("//option") as $o) {
    $o["value"] = "" . $o;
}
$xml = $doc->asXML(); 
```

如果你坚持使用正则表达式，你可以这样做：

```
$xml = preg_replace(
    '#<option value="[^"]*">([^<]*)</option>#',
    '<option value="$1">$1</option>', $xml); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T16:06:44.020

It can be made a bit more general, but it works when there are no other attributes in the option tag:

```
/(.*")([^"]+)(">)([^<]+)(.*)/ 
```

然后用这个替换捕获的字符串：

```
$1$4$3$4$5 
```

如果您使用反斜杠作为子组引用字符，请将美元符号替换为反斜杠。

提示：http://gskinner.com/RegExr/ 上有一个很棒的在线正则表达式测试器[，](http://gskinner.com/RegExr/)看看吧！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T16:18:19.203

我还没有测试过这个，但我相信这会工作，使用 jQuery。

```
 $('option').each(function(elm) { $(this).val($(this).text()); }); 
```

# c# - C# 从 IGrouping 中选择不同的值

> ID：591144
> 
> 赞同：3
> 
> 时间：2009-02-26T15:54:55.017
> 
> 标签：c#, lambda

我有两节课：

```
class Foo 
{ 
    public Bar SomeBar { get; set; } 
}

class Bar
{ 
    public string Name { get; set; } 
} 
```

我有一个我组合在一起的 Foos 列表：

```
var someGroup = from f in fooList
                orderby f.SomeBar.Name ascending
                group f by f.SomeBar.Name into Group
                select Group; 
```

如何从 someGroup 中获取不同酒吧的列表？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T15:58:28.160

可能会有不止一个同名的酒吧吗？如果是这样，那就很棘手了。如果没有，您可以将其更改为：

```
var grouped = from f in fooList
              orderby f.SomeBar.Name ascending
              group f by f.SomeBar into Group
              select Group;

var bars = grouped.Select(group => group.Key); 
```

或者，如果你只想要一个 Bar 每个*name*，你可以坚持你原来的查询，但改变最后一点：

```
var someGroup = from f in fooList
                orderby f.SomeBar.Name ascending
                group f by f.SomeBar.Name into Group
                select Group;

var bars = someGroup.Select(group => group.First().SomeBar); 
```

这将获取每个组中的第一个 Foo，并找到它的 Bar。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T16:01:48.680

`Equals`如果您通过特殊实现定义“与众不同” for `Bar`，您可以使用：

```
var result = someGroup.SelectMany(x => x.Select(t => t.SomeBar)).Distinct(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T11:00:44.017

以前有人问过类似的问题，所以我结合大家的知识做了这个：

```
var newlist<T2> = oldlist<T1>.GroupBy(g => g.distinct_var).Select(g => g.First()) //a
                 .Select(r=> new T2() {var1=r.va1, var2=r.var2 ...etc}).ToList(); //b 
```

它的作用是：

一种。第一行选择您选择的不同项目，这就是您想要的。

湾。第二行通过构造新的 T2 列表将旧的 type1 转换为新的 type2。

也许你的问题有点矫枉过正，只是去掉你不需要的东西。

# java - 在 Eclipse 中删除一行

> ID：591172
> 
> 赞同：146
> 
> 时间：2009-02-26T15:59:15.800
> 
> 标签：java, eclipse

在 Visual Studio 中，您将使用`Ctrl`+ `L`，而在 Eclipse 中，我被迫选择一行，或者，如果它为空，则在单击删除/退格之前转到该行的开头。

有快捷的捷径吗？谢谢！

* * *

## 回答 #1

> 赞同：254
> 
> 时间：2009-02-26T16:01:08.963

`Ctrl`+`D`

从**Help** -> **Key Assist** ... Eclipse 有各种有用的键盘快捷键。

对于 Mac 用户：`⌘</kbd> + `D``

* * *

## 回答 #2

> 赞同：120
> 
> 时间：2009-02-26T22:48:57.517

将来，如果您需要快速找到简单的键盘快捷键，只需点击`Ctrl`++`Shift`即可`L`。

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2009-02-26T16:01:41.943

`Ctrl`+`D`应该删除该行。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-27T11:42:33.757

您可以将`Delete Line`命令重新分配给您最喜欢的热键。
窗口->首选项
常规->编辑器->键。

现在键入“删除”并重新分配过滤的突击队。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2017-04-12T15:39:49.860

如果您使用的是 MAC，那么它是

```
command + D  => ⌘ + D 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-27T10:19:57.200

要快速找到快捷方式，请点击`Ctrl`+ `L`、`Ctrl`+ `L`( `Ctrl`+`L`两次)，然后在按键分配的过滤器文本中键入与您的命令所做的近似的内容。这对于大多数快捷方式都非常有效，尽管对于某些菜单分配的名称与此列表中的命令名称无关的某些快捷方式可能有点棘手（例如，Team->Revert to base 出现在键列表中作为“替换为存储库中的最新版本”），因此有时需要进行一些横向思考 :-) 如果不存在快捷方式，则很容易在键对话框中添加一个快捷方式。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-27T03:15:55.473

如果您希望将其作为列表打印或其他内容，这里是指向 eclipse 快捷方式 pdf 的链接。

[pdf页面的快捷方式](http://eclipse-tools.sourceforge.net/shortcuts.html)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-04-28T08:18:05.007

按 Ctrl+Shift+L 两次并按 TAB 然后您可以键入以查找您的快捷键

# c# - 如何模拟返回列表对象的属性 - 在 rhino mock

> ID：591174
> 
> 赞同：4
> 
> 时间：2009-02-26T15:59:32.930
> 
> 标签：c#, mocking, rhino-mocks

```
Interface IView
{
   List<string> Names {get; set;}
}

public class Presenter
{
   public List<string> GetNames(IView view)
   {
       return view.Names;
   }
}

var mockView = MockRepository.GenerateMock<IView>();
var presenter = new Presenter();
var names = new List<string> {"Test", "Test1"};

mockView.Expect(v => v.Names).Return(names);

Assert.AreEqual(names, presenter.GetNames(mockView)) // Here presenter returns null which is incorrect behaviour in my case; 
```

当我使用上面的代码返回名称的模拟列表时，它与预期不匹配，然后返回 null 并失败

感谢您的帮助

编辑：我将视图作为参数传递给演示者的 GetNames 方法。这里的问题是，当我从模拟属性返回列表对象时，它返回 null。但是，当我将属性数据类型更改为 string/int iepremitive 类型时，值会正确返回

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T21:47:46.277

我看不到您的 mockView 与您的演示者相关联的任何地方。所以从演讲者的角度来看，观点是空的。您可能必须执行以下操作：

```
presenter.View = view; 
```

* * *

我刚刚使用 NUnit 和 RhinoMocks 3.5 对其进行了编码，以确保它可以正常工作。这是我的两个类文件。测试通过了。

```
using System.Collections.Generic;

namespace Tests
{
    public interface IView
    {
        List<string> Names { get; set; }
    }

    public class Presenter
    {
        public List<string> GetNames(IView view)
        {
            return view.Names;
        }
    }
}

using System.Collections.Generic;
using NUnit.Framework;
using Rhino.Mocks;

namespace Tests
{

    [TestFixture]
    public class TestFixture
    {
        [Test]
        public void TestForStackOverflow()
        {
            var mockView = MockRepository.GenerateMock<IView>();
            var presenter = new Presenter();
            var names = new List<string> {"Test", "Test1"};

            mockView.Expect(v => v.Names).Return(names);

            Assert.AreEqual(names, presenter.GetNames(mockView));
        }
    }
} 
```

我只能猜测您在混淆代码的方式上做错了什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T09:31:20.303

感谢您的帮助，经过调查，我发现我正在演示器内创建一个具有相同视图列表对象内容的新列表对象，因此它失败了。现在我使用属性约束来匹配期望的参数并且它起作用了！谢谢大家

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T14:18:57.237

我对 Rhino Mocks 不熟悉，但我可以告诉你如何使用 NUnit 的内置模拟库 NUnit.Mocks 来做到这一点：

列表名称 = 新列表 {"Test", "Test1"};

DynamicMock mockView = new DynamicMock(typeof(IView));

mockView.ExpectAndReturn("get_Names", names);

IView 视图 = (IView)mockView.MockInstance;

Assert.AreEqual(names, presenter.GetNames(view));

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-09T09:45:50.117

你不应该忘记的一件事（我知道我做了，这让我很困惑）：**指定你希望期望工作多少次**- 否则如果你的代码多次使用该属性，你会得到奇怪的结果，因为期望

```
mockView.Expect(v => v.Names).Return(names); 
```

仅适用于单个呼叫。所以你应该写

```
mockView.Expect(v => v.Names).Return(names).Repeat.Any(); 
```

如果您的模拟属性应该在每次调用时返回相同的东西。

# sharepoint - 添加共享点网页而不将其存储在文档库中？

> ID：591181
> 
> 赞同：1
> 
> 时间：2009-02-26T16:00:31.430
> 
> 标签：sharepoint

我想做一些非常简单的事情：将“基本页面”添加到共享点站点，并让它出现在快速启动侧导航中。但它坚持将其存储在文档库中。无论如何不将其存储在文档库中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T16:52:24.490

您可以将页面作为[模块](http://msdn.microsoft.com/en-us/library/ms453137.aspx)添加到站点。

以下 XML 是您如何注册模块以与 SharePoint 一起使用：

```
<?xml version="1.0" encoding="utf-8" ?>
<Elements
  Id="<GUID />"
  xmlns="http://schemas.microsoft.com/sharepoint/" >
  <Module Name="<Name />" >
    <File Path="<Feature Sub-Directory />"
          Url="<URL on SharePoint site />"
    />
  </Module>
</Elements> 
```

要使导航正常工作，请使用功能接收器。这是开始以编程方式修改导航的好地方：http: [//msdn.microsoft.com/en-us/library/ms558975.aspx](http://msdn.microsoft.com/en-us/library/ms558975.aspx)

# sql - 在 SQL Server 中将 mon-yy 格式的 varchar 转换为 datetime

> ID：591184
> 
> 赞同：3
> 
> 时间：2009-02-26T16:01:04.563
> 
> 标签：sql, sql-server, sql-server-2005, datetime

有没有一种简单的方法可以将存储在 varchar 中的日期以 mon-yy 格式（例如“Feb-09”）转换为日期时间，该日期时间会将任何无效值转换为空值。

我目前正在使用与 case 语句相结合的字符串操作，但它相当麻烦。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-26T16:13:19.857

对于有效值，您可以在上面放一天，这是一个完整的日期：

```
convert(datetime,'01-' + 'Feb-09',120) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T16:18:40.013

这会做到的。

```
SELECT convert(datetime,'01-' + 'Feb-09',120) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T16:05:02.543

```
CONVERT( DATETIME, "Feb-09", 64, 7 ) 
```

# wix - 从 InstallShield 切换到 WiX

> ID：591186
> 
> 赞同：14
> 
> 时间：2009-02-26T16:01:12.833
> 
> 标签：wix, installshield

我正在寻找 InstallShield 的替代品。不幸的是，我们只有 1 个 InstallShield 许可证，并且它安装在开发人员的机器上。我正在考虑切换到 WiX，但在阅读文档后，有一个产品 ID GUID、升级代码 GUID 和一个包 GUID。

我也知道 GUID 是由 InstallShield 创建的。如果我切换到 WiX，我可以开始使用新的 GUID 还是使用 InstallShield 创建的一些 GUID？如果发布了对产品的升级，更换安装程序是否会影响使用旧安装程序的客户？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-26T16:09:17.027

为了能够升级您的旧软件包，您需要使用（并找出）您的旧升级代码。
对于每个不同的 MSI，包代码应该不同（即自动生成）（MSI 可以使用 guid 作为缓存键进行缓存）。
产品代码在主要升级之间应该不同，但对于次要升级和补丁很重要。我现在除了主要升级外没有使用 wix 做任何其他事情，所以我不知道确切的细节

请参阅有关[修补和升级](http://msdn.microsoft.com/en-us/library/aa370579(VS.85).aspx)的 MSDN 文章以及[WiX 教程](http://www.tramontana.co.hu/wix/)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-26T23:56:17.760

知道您可以使用 dark.exe 工具（包含在 wix 中）反编译由 Installshield 生成的 msi 可能也很有趣。这将恢复升级代码等。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-26T21:42:53.917

我还建议获得一份[The Definitive Guide to Windows Installer](https://rads.stackoverflow.com/amzn/click/com/1590592972)的副本，我*强烈*推荐这本书，如果没有它，我不知道如何迁移到 WiX。这是对 Windows Installer 的一个非常低级的概述，如果您理解这本书，那么 WiX 就变得非常简单。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-03T06:46:07.953

我知道您已经接受了答案，但如果您还没有这样做，请与[Orca成为朋友。](http://msdn.microsoft.com/en-us/library/aa370557(VS.85).aspx)

Orca 帮助我了解了 MSI 以及 WiX 在幕后所做的事情。在您的情况下，它会使查找升级（或任何）GUID 变得非常容易。

这个[问题](https://stackoverflow.com/questions/471424/wix-tricks-and-best-practices)也可以为您节省一些时间和头痛:)

# c# - 尽管存在 DataAccessKind.Read，SqlFunction 无法打开上下文连接

> ID：591191
> 
> 赞同：10
> 
> 时间：2009-02-26T16:01:49.447
> 
> 标签：c#, .net, sql-server, sqlclr, user-defined-functions

我有一个 SqlServer 项目，对表值函数进行了非常简单的测试：-

```
[SqlFunction(TableDefinition = "forename nvarchar(50)", FillRowMethodName = "TestFillRow", DataAccess = DataAccessKind.Read)]
public static IEnumerable TestConn(int ID)
{
    using (SqlConnection con = new SqlConnection("context connection=true"))
    {
        //con.Open();
        yield return "Anthony";
    }
}

public static void TestFillRow(object obj, out string forename)
{
    forename = (string)obj;
} 
```

请注意，连接上的 Open 当前已被注释掉。部署后，我可以在 SQL 中像这样执行：-

```
SELECT * FROM [dbo].[TestConn](1) 
```

一切正常。

现在我取消注释`con.open()`它失败了： -

> 在这种情况下不允许数据访问。上下文要么是未使用 DataAccessKind.Read 或 SystemDataAccessKind.Read 标记的函数或方法，要么是从表值函数的 FillRow 方法获取数据的回调，要么是 UDT 验证方法。

我看不出问题出在哪里，TestConn 函数得到了`DataAccessKind.Read`.

任何人都知道出现此错误的任何其他原因吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-14T12:54:00.140

问题如下：

1.  SQLCLR 不允许 TestFillRow 内的任何数据访问

2.  即使它“看起来”像您的 TestFillRow 不访问数据，编译器使用“yield”语句翻译代码的方式实际上是将其执行推迟到第一个 .MoveNext() 调用迭代器。因此以下声明：

    ```
    using (SqlConnection con = new SqlConnection("context connection=true")) 
    ```

    在里面被执行`TestFillRow`......这是非法的。

**不要使用 yield return**；而是将整个结果加载到 a`List<>`并在 UD 函数的末尾返回列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-12T20:31:39.510

“SQLCLR 不允许 TestFillRow 内的任何数据访问”是一个错误。

如果您不使用`context connection = true`连接字符串，您可以访问`FillRow`方法内的数据。

# xml - E4X 条件调用仅返回 1 个匹配项不返回任何内容？

> ID：591198
> 
> 赞同：1
> 
> 时间：2009-02-26T16:02:42.907
> 
> 标签：xml, actionscript-3, e4x

好的，这是我的代码：

```
var xml:XML = 
<xml>
    <typeA amount1="500" amount2="300" amount3="250" date="2008-02-17"/>
    <typeA amount1="500" amount2="300" amount3="250" date="2008-02-16"/>
    <typeA amount1="500" amount2="300" amount3="250" date="2008-02-17"/>
    <typeB amount1="500" amount2="300" amount3="250" date="2008-02-18"/>
    <typeB amount1="500" amount2="300" amount3="250" date="2008-02-19"/>
    <typeC amount1="500" amount2="300" amount3="250" date="2008-02-20"/>
    <typeC amount1="500" amount2="300" amount3="250" date="2008-02-21"/>
    <typeC amount1="500" amount2="300" amount3="250" date="2008-02-20"/>
</xml>;

trace(xml.typeA.(@date == "2008-02-16")); // no results
trace(xml.typeA.(@date == "2008-02-17")); // finds both
trace(xml.typeC.(@date == "2008-02-20")); // finds both
trace(xml.typeC.(@date == "2008-02-21")); // no results 
```

似乎只有在出现超过 1 次时才会找到它。

难道我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T17:16:33.853

实际上它找到了它，但是因为它只是一个项目，所以它将它作为一个 XML（而不是 XMList）来跟踪。节点为空，它将只跟踪一个空字符串。

试试这个 ：

```
<typeA amount1="500" amount2="300" amount3="250" date="2008-02-16">Hello</typeA> 
```

在调试 XML 时，最好使用该`toXMLString`方法。

```
trace(xml.*.(@date="1980-04-29").toXMLString()); 
```

# python - 我可以使用装饰器来改变 Python 中函数的本地范围吗？

> ID：591200
> 
> 赞同：8
> 
> 时间：2009-02-26T16:03:08.943
> 
> 标签：python, decorator

有没有办法编写一个装饰器，以便以下工作？

```
assert 'z' not in globals()

@my_decorator
def func(x, y):
   print z 
```

* * *

编辑：从 anwser 移动

回答 hop 的“为什么？”：语法糖 / DRY。

这不是关于缓存，而是关于根据 x 和 y 的值计算 z（以及 z1、z2、z3、...）。

我有很多功能可以做相关的事情，我不想写

```
z1, z2, z3=calculate_from(x, y) 
```

在每个函数的开头 - 我会在某个地方弄错。如果这是 c 我会用 cpp 做这个（如果这是 lisp，我会用宏做这个......），但我想看看装饰器是否可以做同样的事情。

如果它有帮助，我几乎肯定会称装饰器为“precalculate_z”，它肯定不会成为任何公共 API 的一部分。

我也可以通过使用类基础结构获得类似的效果，但我想看看它是否可以使用原始函数。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-26T19:20:17.660

呼应Hop的回答

1.  不要这样做。
2.  说真的，不要这样做。Lisp 和 Ruby 是更适合编写您自己的自定义语法的语言。使用其中之一。或者找到一种更清洁的方法来做到这一点
3.  如果必须，您需要动态范围的变量，而不是词法范围。

Python 没有动态范围的变量，但您可以模拟它。这是一个通过创建全局绑定来模拟它的示例，但在退出时恢复先前的值：

[http://codepad.org/6vAY8Leh](http://codepad.org/6vAY8Leh "python中的动态范围")

```
def adds_dynamic_z_decorator(f):
  def replacement(*arg,**karg):
    # create a new 'z' binding in globals, saving previous
    if 'z' in globals():
      oldZ = (globals()['z'],)
    else:
      oldZ = None
    try:
      globals()['z'] = None
      #invoke the original function
      res = f(*arg, **karg)
    finally:
      #restore any old bindings
      if oldZ:
        globals()['z'] = oldZ[0]
      else:
        del(globals()['z'])
    return res
  return replacement

@adds_dynamic_z_decorator
def func(x,y):
  print z

def other_recurse(x):
  global z
  print 'x=%s, z=%s' %(x,z)
  recurse(x+1)
  print 'x=%s, z=%s' %(x,z)

@adds_dynamic_z_decorator
def recurse(x=0):
  global z
  z = x
  if x < 3:
    other_recurse(x)

print 'calling func(1,2)'
func(1,2)

print 'calling recurse()'
recurse() 
```

我对上述代码的实用性或完整性不做任何保证。实际上，我保证它*很*疯狂，除非你想从你的 Python 同行那里得到鞭打，否则你应该避免使用它。

此代码类似于 eduffy 和 John Montgomery 的代码，但确保“z”被创建并正确恢复“就像”局部变量一样——例如，注意“other_recurse”如何能够看到“z”的绑定' 在 'recurse' 的主体中指定。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-26T16:23:43.277

我不知道本地范围，但您可以临时提供一个替代的全局名称空间。就像是：

```
 import types

def my_decorator(fn):
    def decorated(*args,**kw):
        my_globals={}
        my_globals.update(globals())
        my_globals['z']='value of z'
        call_fn=types.FunctionType(fn.func_code,my_globals)
        return call_fn(*args,**kw)
    return decorated

@my_decorator
def func(x, y):
    print z

func(0,1) 

```

哪个应该打印“z的值”

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-26T16:26:19.433

a) 不要这样做。

b) 说真的，你为什么要那样做？

c) 你可以在你的装饰器中将 z 声明为全局的，所以在第一次调用装饰器之前 z 不会在 globals() 中，所以断言不会吠叫。

d) 为什么？？？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-26T19:09:07.280

我将首先回应“请不要”，但这是你的选择。这里有一个解决方案：

```
assert 'z' not in globals ()

class my_dec:
    def __init__ (self, f):
        self.f = f
    def __call__ (self,x,y):
        z = x+y
        self.f(x,y,z)

@my_dec
def func (x,y,z):
    print z

func (1,3) 
```

它确实需要`z`形式参数，但不是实际参数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T19:02:39.043

*我也可以通过使用类基础结构获得类似的效果，但我想看看它是否可以使用原始函数。*

好吧，Python 是一种面向对象的语言。在我看来，你应该在课堂上这样做。制作一个漂亮的类接口肯定会简化你的问题。这**不是**装饰器的用途。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T00:19:45.723

显式优于隐式。

这够好吗？

```
def provide_value(f):
    f.foo = "Bar"
    return f

@provide_value
def g(x):
    print g.foo 
```

（如果你真的想要邪恶，分配给 f.func_globals 似乎很有趣。）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-27T00:50:36.710

其他人给出了一些制作工作装饰器的方法，许多人建议不要这样做，因为它与正常的 python 行为在风格上是如此不同，以至于它会让任何试图理解代码的人感到困惑。

如果您需要大量重新计算事物，将它们组合在一个对象中是否有意义？在构造函数中计算 z1...zN，然后使用这些值的函数可以访问预先计算的答案作为实例的一部分。

# .net - 即时升级 .NET 应用程序中使用的 COM 对象

> ID：591201
> 
> 赞同：0
> 
> 时间：2009-02-26T16:03:12.813
> 
> 标签：.net, com, interop, activex

我们有一个大型、已部署的 3 层 .NET 应用程序，出于良好的业务原因，目前无法升级。客户端通过通常的互操作机制使用了许多经典的 c++ ActiveX 控件。

我们已经修复了其中一个 ActiveX 控件中的一些严重错误，并且需要将修复程序部署给许多客户，而无需重新安装客户端。允许使用补丁，包括升级 dll。有没有一种方法可以在不需要新客户端的情况下安装已修复错误的 ActiveX dll？界面、文件名、GUID 等均未更改。

我试过只是更换 dll 没有成功——出现了各种有点奇怪的错误，但 ActiveX dll（仍在开发中）可能有缺陷——正在并行跟进。

是否应该简单地替换 dll 工作？如果没有，您能否建议另一种方法，而不是重建然后重新安装应该可以工作的客户端？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T16:06:20.997

如果接口没有改变，那么覆盖原始 dll 将起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T20:14:44.050

更换之前取消注册，然后重新注册。

```
regsvr32.exe /u [YOUR DLL HERE] 
```

然后覆盖dll，然后

```
regsvr32.exe [YOUR DLL HERE] 
```

# windows - Crystal Reports 8.5 网络文件保存

> ID：591209
> 
> 赞同：0
> 
> 时间：2009-02-26T16:05:22.277
> 
> 标签：windows, crystal-reports, save

我有一个用户突然开始收到以下错误：-“文件保存失败文档无法保存在 J:\XXXX\reports\xxxx.rpt。已保存在 C:\DOCUME~1\username\LOCALS~1\Temp\crw25.tmp 中。”</p>

这是在他们使用的 SQL 服务器更新 IP 地址以及笔记本电脑进行 XP 自动更新之后开始的。更新已被删除，但这没有帮助，并且使用限定名称访问 SQL 服务器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T16:22:48.210

如果您使用的是 ODBC，请尝试在那里测试连接（可能必须重建）。刷新 DNS，尝试使用普通的网络故障排除工具来验证连接性。还要确保映射驱动器正确连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T11:50:31.460

感谢您的评论，我将刷新 DNS。

只需添加：- 如果用户从 nertowrk 驱动器打开现有报告，然后将其保存回来，它将失败并从网络中删除该文件。我也有另一个用户遇到这个问题。凯文

# mysql - mysql在不同的服务器上解释不同的结果，相同的查询，相同的数据库

> ID：591210
> 
> 赞同：8
> 
> 时间：2009-02-26T16:05:34.117
> 
> 标签：mysql, join, sql-execution-plan

经过大量工作，我终于得到了一个相当复杂的查询，可以非常顺利地工作并很快返回结果。

它在开发和测试中运行良好，但现在测试速度大大放缓。在开发中花费 0.06 秒并且在测试中大致相同的解释查询现在在测试中是 7 秒。

解释略有不同，我不确定为什么会这样 来自开发的解释

```
-+---------+------------------+------+ ------------------------------
---+
| 编号 | 选择类型 | 表| 类型 | 可能的键 | 钥匙
 | key_len | 参考 | 行 | 额外的
   |
+----+-------------+------------+--------+-------- -----------------+------------
-+---------+------------------+------+ ------------------------------
---+
| 1 | 初级 | | 全部 | 空 | 空值
 | 空 | 空 | 5 |
   |
| 1 | 初级 | 门票 | 参考 | 投标日期_idx | 出价日期_idx
 | 7 | 演出日期.出价,演出日期.日期 | 78 |
   |
| 2 | 派生 | 节目 | 全部 | biddate_idx,latlong_idx | 空值
 | 空 | 空 | 3089 | 使用临时的；使用文件
rt |
| 2 | 派生 | 流派 | 参考 | bandid_idx | bandid_idx
 | 4 | activehw.shows.bid | 2 | 使用索引
   |
| 2 | 派生 | 艺术家 | eq_ref | 出价IDX | bid_idx
 | 4 | activehw.genres.bid | 1 | 使用哪里
   |
+----+-------------+------------+--------+-------- -----------------+------------

```

并且在测试中

```
| 编号 | 选择类型 | 表| 类型 | 可能的键 | 关键 | key_len | 参考 | 行 | 额外 |
+----+-------------+------------+--------+-------- -----------------+--------------+---------+-------- ----------------------+--------+------------------ --------------------------------------------+
| 1 | 初级 | | 全部 | 空 | 空 | 空 | 空 | 5 | |
| 1 | 初级 | 门票 | 参考 | 投标日期_idx | 投标日期_idx | 7 | 演出日期.出价,演出日期.日期 | 78 | |
| 2 | 派生 | 流派 | 索引 | bandid_idx | bandid_idx | 139 | 空 | 531281 | 使用索引；使用临时的；使用文件排序 |
| 2 | 派生 | 艺术家 | eq_ref | 出价IDX | 出价IDX | 4 | activeHW.genres.bid | 1 | |
| 2 | 派生 | 节目 | eq_ref | biddate_idx,latlong_idx | 投标日期_idx | 7 | activeHW.artists.bid | 1 | 使用位置 |
+----+-------------+------------+--------+-------- -----------------+--------------+---------+-------- ----------------------+--------+------------------ --------------------------------------------+
5 行一组（6.99 秒）

```

即使查询完全相同，表的顺序也不同。这是导致减速的原因吗？如果是这样，我将如何解决它？开发是windows，测试是centOs。两者都运行相同版本的 mysql 5.0，就像我说的，测试运行完美，我没有对数据库进行任何结构更改。

我运行了 mysqlcheck，所有表都恢复正常。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T16:15:01.473

MySQL 查看表中的数据以及查询本身来决定使用哪个执行计划。

如果两个数据库中的数据相同，我建议对查询中的所有表使用 ANALYZE 或 OPTIMIZE。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-26T16:17:49.097

第一个计划不使用 index on `shows`。

如果您确定此索引会对您有所帮助，请强制执行：

```
SELECT ...
FROM ..., shows FORCE INDEX (biddate_idx) , ...
WHERE ... 
```

同时，为您的表格收集统计信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T16:13:45.500

我会尝试重新生成统计信息并重建所有表的索引，看看是否能解决您的问题——这可能就是计划不同的原因。

它可能还有很多其他的东西（内存、磁盘、操作系统差异、其他负载等），但我假设这些可能不是问题，因为你提到它之前运行良好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T16:21:55.030

你确定这些来自同一个查询吗？解释不仅略有不同，它们之间也存在相当大的差异：

1.  WHERE 子句针对不同的表（开发中的艺术家，测试中的显示）
2.  它在流派中命中的行数不同（开发时为 2，测试时为 531281）。
3.  第一个和第二个解释之间的其他杂项差异（主要是额外的东西）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-29T08:35:27.083

我们刚刚遇到了一个非常相似的问题，一个新建的 master 需要几分钟来执行与旧 master（功率较小）在几分之一秒内完成的相同查询。我们在查询中的两个 myisam 表上快速运行了修复表，现在新主控执行查询的速度至少与旧主控一样快。

谢谢！

# asp.net - 提供者模式和默认提供者

> ID：591211
> 
> 赞同：1
> 
> 时间：2009-02-26T16:05:53.773
> 
> 标签：asp.net, design-patterns, provider

我正在尝试在自定义 Web 控件中实现提供者模式。我仍在尝试理解这种模式，并且我有以下问题。

默认提供程序是我的控件加载时始终使用的提供程序吗？据我所知，使用的提供程序将始终是默认值，但我不确定，因为 MSDN 文档说允许选择提供程序的服务器控件应具有应默认为 defaultProvider 值的 Provider 属性。对我来说，这意味着控件可以根据它的 Provider 属性加载给定的提供者，只要该提供者在配置文件中。那是对的吗？因此，如果未请求特定提供者，则返回默认提供者。

要更改提供程序，我是否只需更改配置文件中的默认提供程序？<-- 我认为这是不正确的，因为这只会更改返回的 defaultProvider。

这是否正确：在控件中，默认提供程序将在控件的 OnLoad 事件方法中加载？我需要根据提供者从不同的来源传递控制数据，但结果数据将被放入一个类中。控件将用于呈现自身。

我也很困惑如何从页面获取数据到控件？假设我的 ProviderBase 有一个名为 LoadData 的方法

然后在我的 SQLCustomerProvider 中，我将实现 LoadData 方法，是否可以在此处自定义此代码以读取我的特定数据并加载到类中，或者使用控件的页面是否应该将数据加载到类中？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-28T20:57:07.080

我会预先承认，我对提供者的了解仅限于为会员/个人资料/角色编写它们，但一般的东西仍然应该适用：

除非您允许开发人员有机会指定不同的提供程序，否则是的，默认提供程序就是将要使用的提供程序。

因此，以身份验证为例，如果您的 web.config 中有以下内容：

```
<membership defaultProvider="SqlProvider" userIsOnlineTimeWindow="20">
  <providers>
    <remove name="AspNetSqlProvider" />
    <add name="SqlProvider"
      type="System.Web.Security.SqlMembershipProvider"
      connectionStringName="SqlServices"
      enablePasswordRetrieval="false"
      enablePasswordReset="true"
      requiresQuestionAndAnswer="true"
      passwordFormat="Hashed"
      applicationName="/" />
    <add name="AdProvider"
      type="System.Web.Security.ActiveDirectoryMembershipProvider" />
  </providers>
</membership> 
```

当您在页面的某处添加登录控件时，它将使用 SqlProvider。

您可以通过以下两种方式之一使用不同的提供程序：

1.  您可以使用Login 控件的[MembershipProvider](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.login.membershipprovider.aspx)属性指定不同的提供程序
2.  [您可以提供在登录控件身份验证](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.login.authenticate.aspx)事件上调用的方法，您可以在其中选择您的提供程序。

方法 2 的示例是：

```
private void OnAuthenticate(object sender, AuthenticateEventArgs e){
  bool authenticated = false;

  MembershipProvider sqlProvider = Membership.Providers["SqlProvider"];

  authenticated = sqlProvider.ValidateUser(Login1.UserName, Login1.Password);

  if (!authenticated){
    // User not found in database, try Active Directory:
    MembershipProvider adProvider = Membership.Providers["AdProvider"];
    authenticated = adProvider.ValidateUser(Login1.UserName, Login1.Password);
  }

  e.Authenticated = authenticated;
} 
```

您可以在自己的控件上执行此操作的其他方法是公开 Provider 属性，并检查它是否具有值，并使用该提供程序而不是 defaultProvider。

通常，提供者模型已用于为已知类提供一组默认行为 - 因此成员资格提供者都有（例如）返回[MembershipUser的方法](http://msdn.microsoft.com/en-us/library/system.web.security.membershipuser.aspx)[GetUser](http://msdn.microsoft.com/en-us/library/bwzxkby7.aspx) - AspNetSqlMembershipProvider 的 GetUser 实现的全部目的是加载来自 ASP.NET SQL 数据库的 MembershipUser 数据 - 您可以在[Sample Membership Provider](http://msdn.microsoft.com/en-us/library/6tc47t75.aspx)中看到这一点

我希望这会有所帮助！

# apache-flex - 对于潜在的 Flex 开发人员，有哪些好的面试问题？

> ID：591216
> 
> 赞同：2
> 
> 时间：2009-02-26T16:06:31.323
> 
> 标签：apache-flex

我计划在不久的将来面试 Flex 候选人，我正在寻找一些好的（阅读：不是非常困难的）Flex 开发问题。

来自 Stackoverflow 社区的任何意见？如果您发布一个可能的问题，我们也会感谢您的回答（但不是必需的）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T16:19:30.620

**基本的：**

*   MXML 与 AS 概览
*   弹性/空气差异
*   构建过程（项目、资源）
*   基本类型处理、函数
*   事件处理
*   标准 UI 组件

**中等的：**

*   自定义 UI 组件
*   网络服务/HTTPRequest
*   外部接口
*   动态类，反射等
*   优化
*   Flash播放器安全的一些知识

**先进的：**

*   共享模块，本地通信
*   AS3 类型系统详细信息
*   垃圾收集
*   Flash 播放器安全、沙盒、crossdomain.xml
*   安装/更新 AIR 应用程序

**专门：**

*   LCDS/Blaze 集成
*   PHP/JS 互操作性
*   AMF

我的 0.02 美元。你可以自由地重新安排。这只是一个**主观**的观点，请让我知道你为什么要下调模组？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T16:19:03.710

1.  解释 UIComponent 的生命周期，包括 initialize()、createChildren() 等重要方法。

2.  解释失效模型以及它如何用于属性、测量和显示列表。

3.  说出实现数据绑定的三种不同方式

4.  解释 Flash 中的事件模型。描述冒泡事件的工作原理。解释什么是弱引用事件监听器以及为什么要使用它。

5.  描述 IResponder 接口由什么组​​成以及如何使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T16:55:25.887

您可能想问他们熟悉哪些 MVC 架构（EasyMVC、Cairngorm 等）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T22:07:39.823

著名的 Flex 开发人员 Jesse Warden 最近在他的博客上发布了一份不错的[Flex 面试问题列表。](http://jesterxl.tumblr.com/post/80056718/flex-interview-questions)每个问题都包含一个解释，说明您可能想问它的原因。我唯一要争论的是最后一个，但这更多是因为他倾向于从事更多以设计为中心的项目，并且比许多 Flex 开发人员更重基于时间线的资产。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T16:11:15.367

问：请告诉我 Flex 中光栅图像与矢量图像的优缺点。

A：[光栅](http://en.wikipedia.org/wiki/Raster_graphics)与[矢量](http://en.wikipedia.org/wiki/Vector_graphics)

# sql-server - 重新启动后无法远程或本地连接到 SQL Server

> ID：591222
> 
> 赞同：3
> 
> 时间：2009-02-26T16:07:39.730
> 
> 标签：sql-server, sql-server-2005, connectivity

上周末进行了一些网络维护后，我们的开发服务器出现了一些问题，导致我们重新启动了它。在重新启动期间安装了一些更新，这可能是一个因素，也可能不是一个因素。从那时起，我们就无法连接到 SQL Server 2005，甚至无法通过 Management Studio 在本地连接。根据用于连接尝试的协议，我们会收到以下两个错误之一：

1.  当您尝试使用命名管道协议或共享内存协议连接到实例时，您会收到以下错误消息：

> 管道的另一端没有进程。

2.  当您尝试使用 TCP/IP 协议连接到实例时，您会收到以下错误消息：

> 现有连接被远程主机强行关闭。

上述协议均已启用，SQL 服务均正常运行（除了 SQL Server Agent 也无法连接 SQL Server）。我们还检查了表面积配置工具以确保它接受连接。

这不是证书问题（如在线所示），因为我们不使用加密连接。

有什么建议么？否则，我们可能会诉诸完全重新安装。

** 更新 **

更多线索：

*   我们可以连接到集成服务，但没有别的
*   我们可以连接到在同一台服务器上运行的 SQL Server Embedded Edition 的实例

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T16:10:10.270

验证 SQL Browser 服务是否正在运行。很可能它没有设置为自动启动。

您可能想查看它的属性以验证它正在侦听正确的网络接口。

运行 SQL Server 配置管理器。在 SQL Server 2005 网络配置下，您将看到 4 个协议。然后转到 TCP/IP 的属性。你应该能够从那里弄清楚。

失败的唯一原因是 SQL Server 服务或 SQL Server Browser 服务未运行，或者浏览器服务配置错误。

**** 更新 **** 另一种可能性是使用防火墙。请务必关闭 windows 防火墙，然后重试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T16:57:01.543

检查“表面区域配置”工具并确保所有设置都正确（远程连接设置为：TCP/IP 等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T17:08:11.923

远射，但您没有在那个盒子上安装另一个 SQL Server 实例？

我知道这听起来可能很奇怪，但我最近遇到了一些情况，因为客户端一直使用 Backup Exec 作为他们的备份服务，它安装了自己的 SQL Server 实例来管理自己，因此我们不得不跳过箍。这往往会以不可预知的结果搞砸各种事情 - 以至于在几次升级时，我们已经删除了 Backup Exec，完成了升级，然后重新安装。当您进行连接时，您没有尝试连接到您认为您正在连接的 SQL Server 实例，这是完全有可能的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T16:13:51.727

您是否检查过连接端口以确保它没有被其他东西使用？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T16:29:26.447

尝试使用 DAC（专用管理员连接）进行连接。[http://msdn.microsoft.com/en-us/library/ms178068(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms178068(SQL.90).aspx) 你看过[http://support.microsoft.com/?kbid=942861](http://support.microsoft.com/?kbid=942861)吗？这可能是某些网络适配器芯片组引起的，您可以通过以下方式解决此问题：

> 单击开始，单击运行，键入 cmd，然后按 Enter。
> 在命令提示符处，键入以下命令，然后按 Enter：
> Netsh int ip set chimney DISABLED

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-02T14:25:12.250

当我说“这不是证书问题（如在线所见）因为我们不使用加密连接”时，我错了。

显然，我们在服务器上拥有的一些旧 SSL 证书导致了这些问题，即使我们似乎没有使用它们。我仍然不知道为什么，但删除它们（然后从 IIS 中卸载它们）解决了我们的问题。

非常感谢大家的帮助！

# sharepoint - SharePoint：从 ContentType 注销 EventReceiver 时出错

> ID：591225
> 
> 赞同：3
> 
> 时间：2009-02-26T16:08:08.353
> 
> 标签：sharepoint, events, moss, content-type, event-receiver

我在从内容类型中注销某些事件接收器时遇到了一些问题。内容类型和接收器是我自己部署和注册的，所以我不会尝试删除任何 MOSS 内置或内部事件接收器。

我试图用以下代码片段存档：

```
using (SPSite site = new SPSite("http://wssdev06/"))
        {
            using (SPWeb web = site.RootWeb)
            {
                // web.AllowUnsafeUpdates = true;

                SPContentType type = web.AvailableContentTypes[<ContentTypeName>];

                while (type.EventReceivers.Count > 0)
                {
                    type.EventReceivers[0].Delete();                        
                }

                type.Update();

                // web.AllowUnsafeUpdates = false;
            }
        } 
```

不幸的是，命令“type.Update()”引发了一个异常，告诉我无法修改集合。正如您在代码中看到的那样，我已经尝试了不同的方法来解决此问题，例如允许不安全的更新或以提升的权限运行此代码。但我总是得到同样的例外。

那么我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T10:18:35.970

您的问题是“AvailableContentTypes”属性为您返回一个**只读**集合。

您还应该使用“ContentTypes”属性，一切都应该没问题。

问候，

挖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T21:21:41.533

类型是否基于发布类型？我在更改这些类型时遇到了问题。否则，您可能会尝试更改该类型的整个 SchemaXml。我发现这有时会在其他方法不起作用时起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T21:32:52.537

您应该能够设置`type.ReadOnly = false`为启用对该类型的写入。

同样，您的 SPWeb 也不需要处理 - 请参阅[此处的 Roger Lamb 博客](http://blogs.msdn.com/rogerla/archive/2008/02/12/sharepoint-2007-and-wss-3-0-dispose-patterns-by-example.aspx#SPDisposeCheckID_140)了解更多详细信息。

# java - 自动将循环重构为递归方法？

> ID：591228
> 
> 赞同：3
> 
> 时间：2009-02-26T16:09:16.667
> 
> 标签：java, refactoring, recursion, loops

您是否知道一种工具可以自动将具有单个循环的方法重构为递归方法，最好是在 Java 中？

这是出于教学目的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T16:34:23.470

我认为不存在这样的工具，因为通常重构旨在提高性能，而不是降低性能（使用递归方法而不是循环时就是这种情况）。如果是出于教学目的，为什么不让学生创建可以做到这一点的工具呢？这样，他们可以同时学习递归和解析。

我不知道递归是否可以自动化，但这是转换的样子。为了演示，让我们使用伪代码中的通用 for 循环：

```
loopFunc() // method (could return a value or not)
{
    for (initialization ; // Sets the context
         test ;           // Test continuation wrt the context
         counting_exp     // Update the context after each iteration
        ) 
    { 
        loop_body
    }
} 
```

循环由四部分组成：`initialization`，初始化上下文（通常是变量）；`test`，这是一个布尔表达式，用于检查循环是否完成；`counting_exp`，这是每次迭代后执行的语句；最后，`loop_body`表示在每次迭代中执行的操作。

此方法的递归版本应分解为两部分：一用于初始化，另一部分用于实际执行循环：

```
recFunc()
{
    initialization        // Sets the context
    innerRecFunc(context) // We need to pass the context to the inner function
}

innerRecFunc(context)
{
    if not test then return // could return a value
    else
    {
        loop_body             // Can update context
        counting_exp          // Can update context
        innerRecFunc(context) // Recursive call (note tail-recursion)
    }
} 
```

我没有充分考虑这个问题，无法 100% 确定这在所有情况下都有效，但对于简单的循环，这应该是正确的。当然，这种转换可以很容易地适应其他类型的循环（while、do while）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T16:35:56.040

我不完全确定这在一般意义上是否可行，因为在我看来，这就像[停止问题](http://en.wikipedia.org/wiki/Halting_problem)的变体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T22:17:45.237

如果您出于教学目的这样做，我认为您可以在非常有限的情况下这样做。所以你能不能写点东西

```
myMethod() {
  // startcode
  for (init,cond,incr) {
    // loopcode
  }
  //endcode
} 
```

并将其转换为

```
myMethod() {
  //startcode
  init;
  recursive(value);
  //endcode
}
recursive(value) {
  if (!cond) {
    return
  } else {
    //loopcode
    incr;
    recursive(value);
} 
```

我相信你可以自己整理出伪代码。

# sql - 创建列的聚合校验和

> ID：591234
> 
> 赞同：9
> 
> 时间：2009-02-26T16:10:36.413
> 
> 标签：sql, mysql, checksum

我想计算汇总列的所有值的校验和。

换句话说，我想做一些等价的

```
md5(group_concat(some_column)) 
```

这种方法的问题是：

1.  这是低效的。在将列的所有值传递给 md5 函数之前，它必须将列的所有值作为字符串连接到某个临时存储中
2.  group_concat 的最大长度为 1024，之后其他所有内容都将被截断。

（如果您想知道，您可以确保值的连接顺序一致，但是，不管您信不信 group_concat() 接受其中的 order by 子句，例如`group_concat(some_column order by some_column)`）

MySQL 提供了非标准的按位聚合函数 BIT_AND()、BIT_OR() 和 BIT_XOR()，我认为它们对这个问题很有用。在这种情况下，该列是数字的，但我很想知道是否有办法使用字符串列。

对于这个特定的应用程序，校验和不必是密码安全的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-15T19:22:53.227

Percona 的 Mysql 表校验和工具中使用了以下查询。它有点难以理解，但本质上它`CRC32`是每一行的列（或一堆连接的列），然后使用group 函数`XOR`将它们全部放在一起。`BIT_XOR`如果一个 crc hash 不同，那么`XOR`ing 一切的结果也会不同。这发生在固定内存中，因此您可以对任意大的表进行校验和。

`SELECT CONV(BIT_XOR(CAST(CRC32(column) AS UNSIGNED)), 10, 16)`

需要记住的一件事是，这并不能防止可能的碰撞，而且`CRC32`按照今天的标准，这是一个相当弱的功能。更好的散列函数类似于`FNV_64`. `XOR`当ed 在一起时，不太可能有两个相互补充的哈希。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T00:12:21.107

如果您不关心加密强度，您似乎也可以使用它`crc32`。`md5`我认为这：

```
select sum(crc32(some_column)) from some_table; 
```

将在字符串上工作。它可能效率低下，因为 MySQL 可能会创建一个临时表（特别是如果您添加了`order by`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T16:31:04.900

```
SELECT  crc
FROM
(
  SELECT @r := MD5(CONCAT(some_column, @r)) AS crc,
         @c := @c + 1 AS cnt
  FROM
    (
    SELECT @r := '', @c := 0
    ) rc,
    (
    SELECT some_column
    FROM mytable
    WHERE condition = TRUE
    ORDER BY
      other_column
    ) k
) ci
WHERE cnt = @c 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T16:13:59.807

如果该列是数字，您可以这样做：

```
SELECT BIT_XOR(mycolumn) + SUM(mycolumn) 
```

当然这很容易被打败，但它将包括列中的所有位。

# string - 生成不区分大小写的唯一固定长度字母数字字符串

> ID：591238
> 
> 赞同：0
> 
> 时间：2009-02-26T16:11:25.443
> 
> 标签：string, uniqueidentifier, case-insensitive, alphanumeric

我一直在寻找一个优雅的解决方案，但没有运气。最终，我需要创建多个以字母开头且仅包含数字或大写字母的固定长度（3 个字符）的唯一 ID（在单台机器上）。（例如 AXX，其中 X 可以是数字或字母）

我正在使用 mktemp 实用程序来生成唯一 ID。问题：mktemp 创建了区分大小写的临时文件名。

目前，我将生成的每个临时文件存储在一个目录“GeneratedFile”中。然后我创建一个不区分大小写的文件版本，并将它存储在一个目录“ExistingID”中。每次调用 mktemp 时，我都会检查生成的文件是否在 ExistingID 目录中有不区分大小写的对应文件。如果是这样，我将继续调用 mktemp，直到生成一个当前未用作唯一 ID 的文件名。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T16:16:26.040

你没有提到它必须是多么独特——在一台机器上是独一无二的？在网络上？*一定要有*字母吗？如果仅数字是可以的，那么一种简单的方法可能是使用当前系统时间戳，只要您在一个特定实例的时间不需要多个唯一字符串即可。甚至可能通过 md5 运行它以将其转换为固定长度的字母数字字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T16:40:19.820

这似乎太容易了，

```
mktemp AXX | tr 'a-z' 'A-Z' 
```

### 更新

这可能会在 之后生成非唯一名称`tr`是一个很好的问题，但是看，有什么理由需要唯一和*随机*的吗？为什么不按字典顺序生成它们？

```
 # pseudobash, untested
 digit1=0
 digit2=0
 chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"
 function nextName {
      str= "A" chars[digit2] chars[digit1]
      ((digit1++))
      if digit1 > 35
      then
          ((digit2++))
          digit1=0
      fi
      return str
  } 
```

# .net - 如何在 .NET 中自动化 Winforms？

> ID：591250
> 
> 赞同：1
> 
> 时间：2009-02-26T16:14:51.957
> 
> 标签：.net, winapi, vb6, controls

我想在 VB6 代码中获取 .NET 属性的 ControlName，就像[本文](http://msdn.microsoft.com/en-us/library/ms996405.aspx)中描述的那样。但不幸的是，它对我不起作用。bufferMem 总是为 0。

```
 bufferMem = VirtualAllocEx(processHandle, 0, size, 
        MEM_RESERVE Or MEM_COMMIT, PAGE_READWRITE)
        If bufferMem = 0 Then
            Error Err, "VirtualAllocEx API Failed"
        End If 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T19:15:33.163

你事先设置好尺寸吗？

```
size = 65536 
```

# c - strftime( ) 无法正确显示秒数

> ID：591252
> 
> 赞同：0
> 
> 时间：2009-02-26T16:15:16.480
> 
> 标签：c, time, formatting, timestamp

我尝试使用 strftime() 来获取格式化的时间戳。

```
char ft[ 256 ];
struct tm *tmp;
strftime( ft, 256, "%D - %T", tmp ); 
```

我的问题是我得到“13/02/60 - 03:07:-17958194”。有没有办法正确显示秒数？（我正在使用 Mac OS X 和 gcc）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T16:27:33.847

您在发布的代码中使用了未初始化的值，这可以解释您遇到此问题的原因。以下代码会导致您要查找的内容：

```
#include <stdio.h>
#include <time.h>

int
main(int argc, char *argv[]) {
  char ft[256];
  struct tm *tmp;
  time_t curtime;

  time(&curtime);
  tmp = localtime(&curtime);

  strftime(ft, 256, "%D - %T %s", tmp);
  printf("%s\n", ft);

  return(0);
} 
```

然后，编译并运行示例：

```
cc -o time_ex time_ex.c
./time_ex
02/26/09 - 11:26:34 1235665594 
```

**ETA：**当然，如果您只想要本地时间而不需要 UNIX 时间，请删除 %s。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T16:28:01.410

假设您想要“mm/dd/yy - hh:mm:ss”，“%D - %T”应该会给你正确的结果。

如果您的示例对您的使用准确，您可能需要考虑为函数提供实时而不是内存中的某个随机地址。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T16:40:01.460

%s 和 %S 是不同的格式字符。

*   %s 是自 unix 纪元以来的秒数。
*   %S 是当前时间的秒值 (00-60)，对于小于 10 的数字，前导 0。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T16:27:50.100

您没有`struct tm *tmp;`使用任何东西进行初始化 - 请您发布一个完整的示例吗？

# python - 使用随机时，哪种形式返回相等的 50% 机会？

> ID：591253
> 
> 赞同：12
> 
> 时间：2009-02-26T16:15:37.837
> 
> 标签：python, random

我猜大多数内置的随机生成器都会返回如下内容：

```
[0.0, 1.0) 
```

所以如果我想要 50% 的机会我会使用这样的东西：

```
if random() < .5 
```

或类似的东西：

```
if random() <= .5 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-26T16:23:32.827

啊，旧的“.5”问题。这是答案：

如果你要将 10 个东西分成两个**相等**的部分，那么每个部分需要 5 个东西。第一部分 0 到 4，第二部分 5-9。所以……`< .5`是正确的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-14T17:28:14.677

为什么要自己做？Python 有 random.choice :)

random.choice([0, 1]) 会给你 0/1 的机会 - 它是 Python 的标准部分，由编写 random.random 的同一个人编码（因此比它更了解它的语义还有谁）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-26T16:20:05.143

大致上，两者都有效。

最好的方法是选择一个随机生成器，它专门发出带范围的布尔值或整数。然后你可以准确地确定范围。

无论如何，像浮点“平等”这样的操作是不确定的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T16:21:16.170

```
 if random() < .5 
```

在二进制中，.5 是 .10000000000....所以，基本上，问题归结为“小数点后的第一个二进制数字是什么...... 0（对于 <.5）或 1（对于 .5 或更多）？”

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-19T21:08:18.407

```
import random
def fifty_fifty():
    "Return 0 or 1 with 50% chance for each"
    return random.randrange(2) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T16:39:14.177

对于特定系统，如果您真的想找出答案，您应该对其进行测试。不过可能需要一段时间:-)

我同意其他海报的第一顺序，没关系。如果它确实重要，那么无论如何你都需要一个更好的RNG。

**编辑：** 我刚刚尝试了 C# 中的默认 RNG 1,000,000,000 次尝试，答案是相同的......

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-08-02T04:03:14.320

这是我喜欢使用的版本：

```
import random

# Returns True 50% of the time. 
def fifty_fifty():
    if random.random() < .5:
        return True
    return False 
```

用法：

```
if fifty_fifty():
    # Do something half the time
else:
    # Do something else instead half the time 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-26T16:21:19.913

```
< .5 
```

但这假设您的浮点支持足以满足您的精度要求（因为它从来都不*是精确*的）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-26T16:21:40.460

如果我想要 50% 的机会，我只需检查 LSB（最低有效位）。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-26T16:44:19.967

如果您需要真正的随机数，可以尝试[random.org](http://random.org/)。他们提供连接到检测来自宇宙的噪音的设备的网络服务。从技术上讲仍然不是随机的，但我猜足够接近。

他们有各种方式来进行查询，例如黑白图像。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-26T16:46:01.400

如果您对随机数如此挑剔，请不要依赖任何内置的东西。从您信任的地方获取一个文档齐全的 RNG（我相信 Boost，因为它的价值），并阅读文档。过去，标准的 RNG 是出了名的糟糕，我仍然不相信它们。

或者，使用一个整数 RNG，它为您提供一个范围内的离散值，并将该范围分成两半。根据我的经验，RNG 是整数，浮点函数只是除以范围的顶部。

当然，如果这是真的，你已经得到了答案。如果整数 RNG 产生 0、1、2 和 3，则浮点等效值将是 0.0、0.25、0.5 和 0.75，因此答案是 test < 0.5。

如果 RNG 不是基于积分计算，那么它是基于浮点计算，因此是不精确的。在这种情况下，您是否测试 <= 或 < 并不重要，因为不能保证应该是精确的 0.5 的计算。

因此，答案可能是测试 < 0.5，如果它有所作为，这可能是正确的。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-02-26T16:19:19.543

没关系。这两个公式都产生了预期的结果。

# mysql - 获取字符串的数字/规范化表示以帮助数据库中标题的“自然排序”

> ID：591256
> 
> 赞同：2
> 
> 时间：2009-02-26T16:16:16.963
> 
> 标签：mysql, algorithm, string, natural-sort

我想在表中存储一个附加列作为“排序值”，它是标题列的数字表示，这样这些值的顺序就代表了字符串的自然字母排序顺序。即，这样我就可以检索按排序值排序的行，它们将按自然排序顺序 - 当我插入新行时，我可以生成数值并知道相对于其他值的值将代表字符串的位置在字母搜索中，精确到前 X 个字母左右。

这有几个原因：首先，我想要一个比数据库服务器提供的简单排序更自然的排序，其中“The”和“A”之类的东西和标点符号在开始时会被忽略，而数字会被“自然”处理'。

其次，这适用于具有大量排列的索引 - 它会节省空间，并且可能会在遍历具有许多行的索引时节省时间。

我所追求的是将字符串转换为该数值的算法，或者我想只是一个规范化的字符串值。

我正在使用 PHP 和 MySQL。

恐怕“从数据库中提取所有内容并使用 natcasesort() 在 PHP 中排序”不是这种特殊情况的解决方案，因为我想在它们之前按排序顺序检索行（使用 order by 和 group by）得到一个连接或限制子句。谢谢。

**编辑：**

感谢您到目前为止的回答。我突然想到，我的应用程序使用 UTF-8 的事实非常相关。话虽如此，我认为以压缩/数字形式表示字符串的初始部分的实用性是一种延伸，可能只是某种规范化形式（所有大小写折叠，数字零填充，以及尽可能多的字符）归一化到它们的根，即 ã 到 a) 是合适的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T16:49:52.280

“*精确到前 X 个字母左右”*部分至关重要，因为不可能完全准确地分配数字。要看到这一点，假设您的`title`列是具体的`varchar(50)`并且您想要使用 32 位列`integer` `sort_order`。然后您可以存储 (255^51 - 1) 个不同的标题，每个标题都需要不同的`sort_order`值——但只有 2^32 个不同的`sort_order`值可供使用。即使您说您永远不会添加超过 2^32 行，您也需要提前知道他们将拥有哪些标题，以便提出一个避免`sort_order`每次插入行时都必须重新分配所有值的方案。

尽管“理论上完美”的解决方案是不可能的，但仍然有可能获得一个实用的“近似”系统，该系统应该以完美的精度处理多达数百万行。最简单的方法是使用浮点类型。最初，按排序顺序列出行并将第一行的`sort_order`值分配为 1.0，将第二行的值分配为 2.0，依此类推。然后，每当插入一行时，将其设置`sort_order`为排序顺序两边各行的中点（即平均值）。如果新添加的行位于所有现有行之前（或之后），只需将其设置为小于（或大于）之前的最小（或最大值）`sort_order`值 1。

从头开始重新分配数字（如在初始构建步骤中）以定期或在大量更新后“平滑”值是一个好主意。特别是如果表格从小开始变大，您可能会在末端发现一些“一堆”数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-12T02:28:30.110

感谢您到目前为止的答案。我只是想用我要使用的解决方案来更新人们。我采取的方法与我在问题中设想的方法不同。

回顾一下，我想存储字符串的表示形式，这样当以二进制顺序检索时，我为“8 Mile”存储的任何内容都将在我为“101 Dalmations”存储的任何内容之前排序。

对于字符串中的每个数字（本质上是一个数字序列），我在它们之前插入一个数字，描述该数字的位数。

所以，“8”变成“18”，“101”变成“3101”。它为数字添加了一些冗余，因为您使用的数字比您需要的多，并且某些值不存在，但它们现在具有二进制排序将数字排序为数字顺序的属性。“101”会事先排在“8”之前，这是不希望的。添加额外的数字后，“18”排在“3101”之前。

注意：如果数字是 9 位或更多位，我会在开头添加两个数字：数字中的位数减去 9，然后是 9，然后是数字。这允许最多 18 位数字：对我来说已经足够了。

我也在以其他方式对字符串进行规范化——所有内容都小写，Unicode 字符将被翻译成最接近的 ascii 等价字符，如果它们是第一个单词，'a'、'an' 和 'the' 将被删除.

我放弃了将字符串变成一个大数值；它仍然是一个字符串，只是它不是为人类阅读而设计的。

# javascript - JavaScript 中的 setTimeout 和 "this"

> ID：591269
> 
> 赞同：40
> 
> 时间：2009-02-26T16:18:42.243
> 
> 标签：javascript

我有一个使用该[`setTimeout`](https://developer.mozilla.org/en/window.setTimeout)函数并调用另一个方法的方法。在初始加载方法 2 工作正常。但是，超时后，我收到一个`method2`未定义的错误。我在这里做错了什么？

前任：

```
test.prototype.method = function()
{
    //method2 returns image based on the id passed
    this.method2('useSomeElement').src = "http://www.some.url";
    timeDelay = window.setTimeout(this.method, 5000);
};

test.prototype.method2 = function(name) {
    for (var i = 0; i < document.images.length; i++) {
        if (document.images[i].id.indexOf(name) > 1) {
            return document.images[i];
        }
    }
}; 
```

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-10-26T17:41:47.983

一个更优雅的选择是附加`.bind(this)`到函数的末尾。例如：

```
 setTimeout(function() {
        this.foo();
    }.bind(this), 1000);
//   ^^^^^^^^^^^ <- fix context 
```

所以OP问题的答案可能是：

```
 test.prototype.method = function()
    {
        //method2 returns image based on the id passed
        this.method2('useSomeElement').src = "http://www.some.url";
        timeDelay = window.setTimeout(this.method.bind(this), 5000);
        //                                       ^^^^^^^^^^^ <- fix context
    }; 
```

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-02-26T16:37:22.730

问题是`setTimeout()`导致 javascript 使用全局范围。本质上，您是在调用`method()`类，而不是从`this`. 相反，您只是告诉`setTimeout`使用 function `method`，没有特定的范围。

要解决此问题，您可以将函数调用包装在另一个引用正确变量的函数调用中。它看起来像这样：

```
test.protoype.method = function()
{
    var that = this;

    //method2 returns image based on the id passed
    this.method2('useSomeElement').src = "http://www.some.url";

    var callMethod = function()
    {
        that.method();
    }

    timeDelay = window.setTimeout(callMethod, 5000);
}; 
```

`that`可能是`this`因为`callMethod()`在方法的范围内。

当您需要将参数传递给`setTimeout`方法时，此问题会变得更加复杂，因为 IE 不支持将两个以上的参数传递给`setTimeout`. 在这种情况下，您需要阅读有关[Closures](http://www.jibbering.com/faq/faq_notes/closures.html)的内容。

另外，作为旁注，您正在为自己设置一个无限循环，因为`method()`总是调用`method()`.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-26T16:36:35.230

`this`您使用的是`setTimeout`通过自身确定范围。`var _this = this;`在您的`test.prototype.method`函数内部创建一个并`_this`改为使用。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-02-08T09:19:43.493

在 es6 中你可以这样做

```
window.setTimeout(() => {
    this.foo();
}, 1000); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T16:40:09.167

> 我收到一条错误消息，提示 method2 未定义

是的，当您`this.method`从它的所有者中切出并将函数单独传递给 时`setTimeout`，您将失去设置的关联`this`，因此`this`in`method()`等于全局对象`window`。

有关在 JavaScript 中实际工作的令人惊讶的方式的解释，请参阅[此答案。](https://stackoverflow.com/questions/585840/implement-map-in-javascript-that-supports-object-methods-as-mapped-functions/585918#585918)`this`

# c# - Streamreader 和外来字符

> ID：591273
> 
> 赞同：2
> 
> 时间：2009-02-26T16:19:29.683
> 
> 标签：c#, encoding

我应该使用哪种编码来读取æ,Ø,å,ä,ö,ü 等？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-26T16:24:56.927

您应该使用原始数据的任何编码。你从哪里得到数据，你有没有关于它的编码的信息？如果您尝试使用错误的编码读取它，您将得到错误的答案：即使您的编码可以处理字符，它也会误解二进制数据。

如果您*选择*编码，那么 UTF-8 通常是一个不错的选择。如果你有很多远东角色，那么它的大小就很糟糕，但其他方面都很好。特别是，ASCII 仍然以每个字符一个字节的形式出现。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-09-10T21:26:47.000

您也可以将文化读入奇怪的字符，如ç á á 等。

```
CultureInfo pt = CultureInfo.GetCultureInfo("pt-BR");
StreamReader fileReader = new StreamReader("C:\temp\test.txt",Encoding.GetEncoding(pt.TextInfo.ANSICodePage),true); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-26T16:42:00.863

正如提到的所有其他答案一样，您需要使用正确的编码。

问题是如何发现编码。这取决于文件的来源：

1.  如果是XML文件，文件开头应该有`<?xml>`处理指令指定编码。如果没有，您应该假设它是 UTF8。
2.  如果它是文本文件，您可以尝试 UTF8 编码，或者如果失败，您应该尝试正在运行的机器的系统区域设置。如果失败了，你几乎是靠你自己的，除非你知道有人可以告诉你创建文件的机器的系统区域设置。

在任何情况下，通过使用 UTF8 并回退到 UTF16，您应该能够覆盖大约 90% 的文件。过去五年中几乎所有程序或语言都支持 Unicode。但是，如果您要消耗大量来自中国的文件，您可以先尝试 UTF16，这在编码[GB18030](http://en.wikipedia.org/wiki/GB_18030)时更为普遍。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T16:30:17.927

编码都归结为这样一个事实：如果一个字符使用 8 位，则只能处理 256 个不同的字符。从英国和美国的约定来看，256 个标准 ASCII 字符大多是无重音的西方字符。

这就是 UTF8 和 UTF16 发挥作用的地方。UTF8 很像 ASCII - 它使用一个字节来表示大多数西方字符。但是，有一些特殊字节表示字符超出正常 ASCII 范围——紧跟在特殊字节后面的两个字节表示真正的字符。

UTF16（也称为 Unicode）取消了特殊的指示字节，每个字符只使用 16 位。众所周知，16 位给你 65536 个不同的字符，这还不足以覆盖世界上所有的书面字符，但它基本上可以完成这项工作。

所以回答你的问题：如果你的大部分字符都是没有重音的西方字符，UTF8 将是你最紧凑的表示（并且在许多编辑器中最易读）。如果你的大部分字符都是非西方的（比如中文），你可能会想要使用 Unicode（又名 UTF16）。

祝你好运！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T16:22:01.097

Encoding.UTF8 或 Encoding.Unicode。

StreamReader 类的构造函数中有一个 bool 参数，允许它自动检测编码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-26T19:17:19.850

没有完全可靠的方法，但您可以使用一些启发式方法来猜测编码。

1.  寻找[字节顺序标记](http://en.wikipedia.org/wiki/Byte-order_mark)。
2.  如果没有找到 BOM，假设文件是​​ UTF-8 并尝试解析它。如果是 XML 文件，则声明可能包含编码。类似地，HTML 文件可能包含元编码标记。
3.  如果以上所有都失败，假设它是 UTF-8（或 ANSI——你的选择）。

[Rick Strahl 有一篇](http://west-wind.com/weblog/posts/197245.aspx)关于通过 BOM 检测编码的方便文章。这有点过时了—— System.Text.Encoding 现在有一个 GetPreamble 方法，并且 StreamReader 有一个重载，它将尝试为您检测编码。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T16:22:09.087

Unicode => UTF-8/UTF-16 ？:)

# powershell - 如何判断使用 powershell 的类支持哪些 WQL 运算符？

> ID：591277
> 
> 赞同：0
> 
> 时间：2009-02-26T16:20:14.317
> 
> 标签：powershell, wmi, wql

[因此，此问题](https://stackoverflow.com/questions/580133/powershell-wmi-root-microsoftexchangev2-and-wql-where-usage)中我的 WMI 类不支持 WQL LIKE 运算符。我如何提前或在我写的时候以交互方式告诉我支持/不支持什么？我想在这里坚持使用 Powershell 并避免使用 wmic 等其他解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T04:33:23.697

我只能找到一处提到 LIKE 不起作用，那就是在旧系统上。LIKE 是在 XP 和 Server 2003 中添加的。它不适用于旧机器。这适用于您从中获取 WMI 对象的机器。

# sql-server-2005 - 将 T-SQL 与 Oracle DB 结合使用

> ID：591278
> 
> 赞同：0
> 
> 时间：2009-02-26T16:20:22.163
> 
> 标签：sql-server-2005

我直接在 Microsoft SQL Server Studio 的查询窗口中对大型 Oracle DB 使用 T-SQL 查询，而我的 SQL 服务器是 2005。

我创建了一个链接服务器作为 myOracleServer。通过使用以下 T-SQL 查询：

```
SELECT COUNT(*) FROM myOracleServer..owner.myTable WHERE id = 1000 AND Dt = '2009-02-26' 
```

打一个电话就需要1分钟以上。对于一个小尺寸的表是可以的，但是 Oracle 端的 myTable 非常大，有数百万行数据。

我发现我可以使用 OPENQUERY 进行类似的调用，使用 SQL 查询作为传递调用。结果非常快。执行时间是00:00:02！

```
SELECT * FROM OPENQUERY(myOracleServer, 'SELECT COUNT(*) FROM owner.myTable WHERE ...'); 
```

我遇到的问题是查询不是常量字符串。我可能会更改查询中的 id 和 Dt 值，例如：

```
'SELECT COUNT(*) FROM ownwer.myTable WHERE id = ' + CAST(@id AS VARCHAR)... 
```

OPENQUERY 不支持将变量作为查询字符串或表达式。

有没有其他方法可以快速获得对 Oracle 的直通查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T16:30:21.343

尝试这样的事情

```
DECLARE @sql varchar(2000)
SET @sql = SELECT COUNT(*) FROM owner.MyTable WHERE id = " + CAST(@id to varchar(9))
SELECT * FROM OPENQUERY(myOracleServer, @Sql) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T16:38:13.960

您是否尝试过基于该查询创建视图？如果可行，您应该能够像使用本地表一样使用视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T19:47:57.187

当我尝试将查询从 SQL 2005 服务器传递到 Oracle 数据库时，我想我找到了解决缓慢问题的解决方案。

有三种方法可以做到这一点。第**一个**是这样的：

```
SELECT COUNT(*) FROM myOracleServer..owner.myTable 
  WHERE id = 1000 AND Dt = '2009-02-26' 
```

如果Oracle端的表很大，比如3M行数据，执行时间很长。今天我在我的 SQL 服务器上再次尝试了它，仅一个查询就花了大约 2'44" （也许该表在工作日非常繁忙）。

第二种**方法**是使用 OPENQUERY，正如我在问题中所述：

```
SELECT COUNT(*) FROM OPENQUERY(myOracleServer, N'SELECT COUNT(*) FROM 
  owner.myTable WHERE id = 1000 AND Dt = TO_DATE(''2009-02-26'')'); 
```

它非常快。我再次运行它，执行时间是 00:00:00，速度惊人！但是，这种方法的问题是 OPENQUERY 不支持变量作为查询。

实际上，我找到了这个方法，并且对昨天工作迟到的结果感到非常兴奋。我昨晚写了一篇[关于这个问题](http://davidchuprogramming.blogspot.com/2009/02/using-openquery-for-oracle-db.html)的博客。今天早上，当我尝试将其投入生产（存储过程）时，我无法使用 OPENQUERY，因为在我的情况下，变量查询必须基于 id 和日期构建。

好消息是我找到了**第三种方法**，一个很好的解决方案：

```
DECLARE @sql NVARCHAR(MAX);
SET @sql = N'SELECT COUNT(*) FROM owner.myTable WHERE id = ' + 
  CAST(@id AS VARCHAR) + N' AND Dt = TO_DATE(''' + @dt +
  N''', ''yyyy-mm--dd'')');
EXEC (@sql) AT myOracleServer; 
```

这里的关键点是使用 EXEC 和 AT 来指定远程服务器或链接服务器，并且不要忘记使用 () 将 @sql 变量括起来。执行时间为00:00:00！

我的沼泽将在今晚更新。

# php - 您会建议我使用哪种语言来构建门户网站？

> ID：591281
> 
> 赞同：1
> 
> 时间：2009-02-26T16:21:08.620
> 
> 标签：php, asp.net, architecture, programming-languages

我是网络编程的新手，但在各种操作系统（Windows、linux、vxworks）上使用 C++ 和 C#（winforms 和 WPF）构建应用程序方面积累了很多经验。目前，我还在学习 Java 和各种客户端网络语言（html、css、xhtml、javascript 等）的课程。

现在，我的一些朋友决定建立一个商业门户网站，它基本上将拥有商业门户网站所拥有的所有标准内容（具有不同特权（sp？）的用户，浏览各种信息和类似的东西）——我决定帮助他们并为他们建立这个门户。我不是在问这是否是一个合理的选择:)

我要问的主要是你们是否认为我应该采用 ASP.NET 或 PHP 的方式来做这件事。如果有人可以为我列出一些优点和缺点，我会很高兴 - 作为一个额外的问题，有没有人知道任何资源以简短和描述性的方式告诉我门户网站应该具有的架构（考虑稳定性，安全性，性能等考虑）。

我知道这个问题非常不确定，但我仍处于试图找出需要哪些功能以及使用哪些平台的阶段。

[编辑] 只想对所有出色的答案说声谢谢。据我所知，我使用 ASP.NET 还是 PHP 并不重要——两者都可以完成这项工作。所以我猜它是 C# 中的 ASP.NET。另外，我只想说，我很难过我只能标记 1 个答案，因为这里的所有评论都很棒 :) TY

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T16:27:46.997

以您的背景，听起来 C# 是合适的语言，而 ASP.NET 或 ASP.NET MVC 是您的方向。

在坚定地转向任何方向之前，我会检查一些已设置的门户网站系统并获得想法。已经有很多开源门户可以从中获取想法。

至于赚钱，C# 方向可能更有可能让你赚钱，因为许多 PHP 公司都在大力支持开源，至少在我工作过的市场中是这样。在全国范围内，统计数据可能不同，但我会检查市场趋势，并确保您拥有足够大的市场，值得您一试。

此外，请查看竞争情况，因为商业软件领域在一种平台/语言上可能比另一种更充分。

只要您坚持使用 .NET 2.0（Linux、Mac 上的 Mono），您就可以使用任一解决方案关闭 Windows。

如果您想赚钱，请考虑创建一个可在 SharePoint 中运行的 Web 门户。您的主要关注点应该是易于扩展的点，因为这是 SharePoint 的一个问题区域。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T16:24:30.280

如果您的背景是 C++、Java 等。C# 可能更适合您，因为它是一种编译语言。PHP 被解释并且 C# 将捕获的基本错误（拼写错误的标识符或方法名称等）在运行时而不是编译时显示出来。另一方面，人们已经成功地用 PHP（维基百科）构建了大型项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T16:25:22.773

看起来您正在寻找 SharePoint / MOSS2007。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T16:38:26.253

由于可以选择 C#，因此要使用任何新技术，您必须问自己以​​下问题：

1.  我愿意学习一门新语言吗？
2.  我学得很快吗？
3.  我会再次使用这项技术吗？

如果您可以肯定地回答所有问题，请选择新技术。

其他技术的一些可能的其他替代方案（所有这些都提供出色的功能和非常好的社区支持）：

1.  Ruby on Rails 或 Ruby + 任何其他相关框架
2.  PHP
3.  Java + J2EE
4.  Python + Django 或任何其他相关框架
5.  CGI Perl
6.  冷融合
7.  任何其他 MS 技术（我并没有真正使用 MS Technolgy）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T16:27:02.303

您选择的平台应该基于您现有的舒适度。如果您有同等的 PHP/Linux 和 C#/Windows 经验，那么从长远来看，这并不重要。掷硬币开始吧。

如果您对其中一个更熟悉，请从您更了解的那个开始。在空闲时间修补另一个。然后，您将根据自己的优点确切地知道自己喜欢每个人的优点，并且可以在比较的同时完成工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T16:28:44.233

使用 C#/ASP.NET 是合乎逻辑的语言选择，因为您从 C#/WinApps 经验中对它很熟悉，而且虽然您没有指定门户要求，但 ASP.NET 的能力将比以往任何时候都强。

我建议您将问题的其余部分分解，也许发布单独的问题 - 您需要更具体一些才能获得许多可用的答案。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T16:34:57.917

到目前为止，在讨论 .NET 和 ASP.NET 答案时尚未提及的另一件事是，Microsoft 在 framework 2.0 中将 WebParts 添加到 ASP.NET 中，正是为了构建门户和构成门户的不同模块。

# java - 使用 4Gb Ram 和 IBM Java 1.5 按钮文本消失

> ID：591291
> 
> 赞同：1
> 
> 时间：2009-02-26T16:22:22.877
> 
> 标签：java, graphics, jdk1.5

我们在开发人员站点上发生了一个非常奇怪的错误，我们无法自行复制。

波兰的一位开发人员最近将他的 Windows XP Service Pack 3 机器升级到 4Gb 的 Ram 当他这样做时，他开始在使用 IBM JDK 1.5 的 Java 程序中遇到图形错误。这个错误只发生在 IBM JDK 1.5 中，而不会发生在任何其他版本中。

当您在窗体上创建按钮或控件并将鼠标移到它上面时，问题就会显现出来。

我们有一个测试程序

```
import java.awt.FlowLayout;

import javax.swing.JButton;
import javax.swing.JFrame;

public class GraphicTest {
    public static void main(String args[]) {
        JFrame frame = new JFrame("GraphicTest");
        frame.getContentPane().setLayout(new FlowLayout());
        frame.setSize(200, 200);
        JButton button = new JButton("Test button");
        button.setVisible(true);
        frame.getContentPane().add(button);
        frame.setVisible(true);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }
} 
```

这立即显示了问题。

但是，当我将相同的 Windows 版本升级到 4Gb 的 Ram 时，我自己的机器上不会出现问题。

有没有其他人见过这样的问题？

为了澄清这一点，这个问题只发生在 IBM JDK 1.5 中，并且只发生在我们有 4Gb 的 Ram 时。它不会发生在任何其他版本的 JDK 上，如果我们将内存量减少到 3 Gb，问题就会消失。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T16:49:21.640

尝试减少 Windows 图形驱动程序中的硬件优化（可通过扩展显示控制面板访问）。如果有问题的机器有一个使用部分主内存的板载图形适配器，那么升级 RAM 可能会暴露驱动程序中的问题（或者 RAM 甚至可能出现故障）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T16:27:27.950

首先要说的第一件事是：将 Swing 组件的使用限制在 AWT 事件调度线程 (EDT) 中。

```
public class GraphicTest {
    public static void main(final String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                runEDT();
            }
        });
    }
    private static void runEDT() {
        assert java.awt.EventQueue.isDispatchThread();
        JFrame frame = new JFrame("GraphicTest");
        ... 
```

我不知道为什么内存大小很重要。也许它会以某种方式影响时间。也许 JVM 决定它在服务器级机器上运行并以更积极的优化运行。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T16:49:38.817

只是为了排除硬件故障假设：让开发人员测试他的 RAM。[Memtest86](http://www.memtest86.com/)会这样做。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-10T11:45:00.460

我在具有 3.24 G 内存的 IBM 机器上拥有完全相同的东西：所有的 Swing 应用程序都会显示——但文本（在菜单、表单、按钮上——似乎无处不在）是空白的。

在 Sun JDK 上运行的同一个 swing 程序没有问题。

我使用 Intel(r) 82865G 显卡将硬件加速从“完全”降低到“无”（在即插即用监视器设置中关闭“高级”显示）。

现在 Swing 应用程序似乎工作得很好。

好地方...

# python - 如何使用 Python 在 Windows 中修改密码过期？

> ID：591300
> 
> 赞同：4
> 
> 时间：2009-02-26T16:24:28.970
> 
> 标签：python, windows, passwords

如何在 Windows XP 上为使用 Python 的本地用户修改密码过期时间为“从不”？我有 PyWIN 和 WMI 模块，但没有解决方案。我设法通过 WMI（基于 Win32_UserAccount 类）查询当前设置，但如何修改呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T18:29:00.103

如果您使用 ActvePython 针对 Active Directory 运行您的 python 脚本，那么您可以使用如下内容：

```
import win32com.client
ads = win32com.client.Dispatch('ADsNameSpaces')
user = ads.getObject("", "WinNT://DOMAIN/username,user")
user.Getinfo()
user.Put('userAccountControl', 65536 | user.Get('userAccountControl'))
user.Setinfo() 
```

但是如果你的 python 在 unix 下运行，你需要两件事来与 Active Directory 对话：Kerberos 和 LDAP。与 Active Directory 服务器建立 SASL(GSSAPI(KRB5)) 身份验证 LDAP 连接后，即可访问目标用户的“userAccountControl”属性。

userAccountControl 是一个整数属性，被视为一个位字段，您必须在其上设置 DONT EXPIRE PASSWORD 位。有关位值，请参阅[此知识库文章](http://support.microsoft.com/kb/305144)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-01T22:05:10.467

您可能需要管理员权限才能执行此操作，因此请考虑提升当前进程或启动具有更多权限的新进程。（即类似于 vista 的 UAC，但在 XP 上。）

虽然不能帮助细节。：-/

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T16:43:51.733

该更改需要管理员权限，这可能（或可能不会）导致 PyWin32 内部出现问题。我没有看到任何直接从 Python 脚本进行此更改的方法，但我确信这可以使用不同的方法实现自动化。

这个 MSFN 线程似乎有可以帮助你的信息，或者至少是一个开始：

[http://www.msfn.org/board/Password-Expires-Chang-t115757.html](http://www.msfn.org/board/Password-Expires-Chang-t115757.html)

# asp.net - 将字符串存储在模式为 StateServer 的会话变量中

> ID：591304
> 
> 赞同：2
> 
> 时间：2009-02-26T16:25:13.960
> 
> 标签：asp.net, session, timeout

如果我在会话变量中存储一个字符串值，我需要对其进行序列化还是反序列化？我读到，当你在你的`web.config`

```
<sessionState mode="StateServer" 
              stateConnectionString="tcpip=127.0.0.1:42424"
              stateNetworkTimeOut="60"
/> 
```

您需要先进行序列化，然后才能将值存储在会话变量中，然后在检索值时进行反序列化。我想知道例如，您是否只是将字符串值放入会话中，例如：

```
Session("MyStringVar") = "MyStringValue" 
```

当你检索它时，你可以这样做：

```
DIm strVal as String
strVal = Ctype(Session("MyStringVar"), String) 
```

另外，指定的超时时间是 60，是几分钟还是几小时？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T16:27:16.717

不，.net 运行时会处理所有这些。

但是，如果您要存储未标记为可序列化的对象，则需要进行自己的序列化。此外，超时值以分钟为单位。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T16:28:02.097

对于 web.config 你应该能够做到：

```
String myValue = ConfigurationManager.AppSettings["MyValue"].ToString(); 
```

对于 Session 和您可以执行的字符串值，如果它不是字符串，请将字符串替换为对象类型...：

```
String myValue = (string)Session["MyValue"]; 
```

# apache-flex - 导航到声明（F3 或 CTRL+单击）- 在导航器中显示文件

> ID：591308
> 
> 赞同：1
> 
> 时间：2009-02-26T16:26:11.087
> 
> 标签：apache-flex, eclipse

我一直在使用 Eclipse 开发 Flex 应用程序，在升级到 Eclipse 3.4.1 后，我注意到每当我 CTRL+单击一个类型以导航到它的声明时，编辑器都会在所选类型上打开，但它不会“导航”到 Flex Navigator 树上的文件。

我已经检查过这不是我的同事 Eclipse 上的默认行为，因为他们会在导航器上突出显示最近打开的文件。

我在 Eclipse Preferences 上到处搜索，但看不到它的切换。任何人都知道我应该在哪里启用它？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T17:06:20.210

我不确定它的 flex 部分，但在 Eclipse 中，资源管理器窗口中有一个“Link With Editor”按钮（看起来像一个左右箭头堆叠）。单击它，看看它是否开始像您期望的那样运行。

# css - 对于 Web 应用程序结构的最佳实践，您有什么建议？

> ID：591328
> 
> 赞同：24
> 
> 时间：2009-02-26T16:30:55.757
> 
> 标签：css, design-patterns, javascript-framework

我在工作中做了很多自定义应用程序。我正在尝试为新应用程序定义一些标准。有点像元素。

**CSS**：你如何组织样式表？我是否应该为整个站点创建一个基本样式表，为每个单独的页面创建一个用于自定义的样式表？我应该有另一个打印样式吗？我听说链接更多文件需要更多时间让浏览器检索它们。（每页更多的对象...还有很多 javascript 文件或图像的问题）... 多少是太多？你是否大量评论你的 CSS？提供任何嵌套结构？在元素中按字母顺序排列？我需要重置吗？进口呢？和排版？

**Javascript**：基本上是同一个问题。Javascript 文件...我应该包含一个或两个不错的库（例如 JQuery 和 Prototype），然后为每个页面包含另一个库吗？现在我突然包含 5 或 6 个 CSS 和 JS 文件......

**目录结构**：您如何组织网站？目前，我使用类似的东西

```
/CSS          ... For CSS files
/JS           ... For javascript files
/INC          ... For private code includes
/ASSETS/IMG   ... For images
/ASSETS/AU    ... For audio
/ASSETS/SWF   ... For Flash 
```

此外，欢迎任何其他提示。谢谢！！

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-26T17:05:48.030

> 我是否应该为整个站点创建一个基本样式表，为每个单独的页面创建一个用于自定义的样式表？

务实。如果您的规则足够少，您可以将它们全部组织在一个文件中并保留对做什么的监督，那么就这样做。如果您有大量仅适用于站点中某些部分或单个页面的规则，请务必将它们分解为自己的子样式表，但不需要为每个页面创建单独的样式表即使它只包含两个规则。将特定于页面的类或 id 添加到 <body> 以便您可以在需要时从共享样式表中挑选出单个页面。

将样式分离到样式表中是为了您作为作者的利益，所以做您认为最容易管理的事情。对于一个可能有多个 CSS 文件但不会有几十个的复杂网站。

> 我应该有另一个打印样式吗？

一般是的。虽然您可以使用 @media 规则将打印样式嵌入到另一个样式表中，但这在传统上是有问题的，因此将媒体放在 <link> 标记中通常是最简单的。在任何情况下，打印样式表通常与它们的屏幕对应物如此不同，以至于将它们的规则分开是有意义的。

> 我听说链接更多文件需要更多时间让浏览器检索它们。

是的，但这种影响往往被夸大了。HTTP/1.1 通过保持客户端和服务器之间的连接活动来减少每个请求的延迟，这是一个强有力的缓解措施。

> 多少算太多？

足以让您极不可能拥有那么多样式表。如果您使用的框架要求每个类有一个脚本文件，那么脚本可能会成为问题，但其他情况通常都可以。很多小图像更容易出现问题。

> 你是否大量评论你的 CSS？

简单的评论通常就足够了。CSS 的声明式规则样式通常不会变得复杂到需要代码可以要求的深入解释。但特别是，记录任何违反直觉的事情，例如特定于浏览器的黑客攻击。

> 在元素中按字母顺序排列？

除非这使您更容易管理。通常不会，您会尝试将类似的规则分组，或将规则应用于类似的元素组。

> 我需要重置吗？

完全重置？如果您知道自己在做什么并且可以选择要重置的特定有问题的默认值，则不会。

> 我应该包含一两个不错的库吗（例如，JQuery 和 Prototype）

除非绝对必须，否则不要包含多个框架。

> 然后每个页面都包含另一个？

如果每个页面都有特定的自定义行为，你可以。但这通常不会发生。如果您制作绑定到例如的渐进增强行为脚本。类名，您可以在使用它的每个页面上包含每个行为的脚本，然后让它自动找到要绑定的元素。

> 目录结构：您如何组织网站？

就我个人而言，对于我的 Python/WSGI 应用程序：

```
appfolder
    application.py       - main WSGI entry point and control/configuration script
    data                 - run-time writable application file store
        private          - files not available through the web server
        public           - mounted as a virtual directory on the web server
    logs                 - access, error, application log files
    system               - all the static application code and data
        htdocs           - web server root folder
            file         - static servable files
            img          - static images
            script       - JavaScript
            style        - CSS
        lib              - Python modules used by site
            appmodule    - main application code package
        templates        - HTML page templates
            mail         - mail text templates 
```

对我来说，将“数据”保存在“系统”中的应用程序的单独位置（具有单独的权限）是很重要的。您需要能够换出“系统”文件夹来升级应用程序，而不必担心 htdocs/img 中有上传的图像，您必须担心保留。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-07-22T06:34:50.117

**CSS：**我只使用一个样式表。我只是继续附加到底部。我通常在每个特定于页面的规则集之前添加评论。如果我需要编辑某些内容，请按 Ctrl+F。

**Javascript：**通常只包含一个库，可能还有几个插件。用于将任何特定于页面的 JS 直接扔到该页面的标题中，但我觉得它有点难看，并且将“行为”与数据混合在一起。所以我开始了一个新的范式——

**MVCB——**模型、视图、控制器、行为。MVC 非常适合具有相当静态 UI 的桌面应用程序，但是当您添加大量 JS 时，我认为它需要额外的抽象层。

因此，我的原始文件结构：

```
index.php
app
    config
        bootstrap.php               -- code that needs to run before anything else, or functions that don't really fit elsewhere
        core.php                    -- timezone, database, and misc settings
        routes.php                  -- default routes
    layouts                         -- layout/template files
        flash                       -- layouts for one-time popup messages
    objects                         -- all files are stored in the same folder as the controller to keep directories
                                            smaller and ease reusability
        object
            controller.php
            model.php
            routes.php              -- object-specific routes to override default routes
            behaviours              -- page-specific javascript files
                action.js           -- included automatically on that page if this file exists
            views
                action.php          -- the view for this action
    public                          -- static media files, sometimes called "assets"
        favicon.ico
        xrds.xml
        css
        img
        js
        uploads         
core
    app.php                         -- initializes stuff
    controller.php                  -- default controller
    dispatcher.php                  -- includes everything and calls all the appropriate functions
    model.php                       -- default model that all other models inherit from
    components                      -- helper functions to used in controllers
    datasources                     -- mysql, oracle, flat-file...
    helpers                         -- functions to be used in views and layouts
    structures                      -- model helpers such as tree or polymorphic behaviours
    utils                           -- functions that are useful everywhere
libs                                -- 3rd party libs 
```

**.htaccess**

```
Options -Indexes 

RewriteEngine On

RewriteCond %{REQUEST_URI} !^/app/public/
RewriteCond %{DOCUMENT_ROOT}/app/public%{REQUEST_URI} -f
RewriteRule .* /app/public/$0 [L]

RewriteCond %{REQUEST_URI} !^/app/objects/
RewriteRule ^([^/]+)/(.+\.js)$ /app/objects/$1/behaviours/$2 [L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule .* /index.php?url=$0 [L,QSA] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T17:11:25.580

我已经在另一个线程中发布了我的目录结构和评论，但它也适用于这里！

我已经使用以下设置一段时间了，效果很好：

*   /site：这是我实际工作网站所在的位置。创建模板后，我将在此目录中安装我的 CMS 或平台。

    *   .htaccess *（我通常会发现自己启用的基本调整）*
    *   robots.txt *（所以我以后不要忘记禁止 /admin 之类的项目）*
*   /source: 包含任何comps、notes、documents、specifications等。

*   /模板：从这里开始！创建最终需要移植到 CMS 或 /site 框架中的所有静态模板。

    *   /_行为
        *   global.js *（特定于站点的代码；可以根据需要分解为多个文件）*
    *   /_media：图像、可下载文件等。根据需要进行组织

    *   /_style：我更喜欢模块化 CSS 开发，因此我通常会为网站的每个独特部分制作许多样式表。[Blender](http://github.com/cgriego/front-end-blender/tree/master)可以很好地清理这个问题 - 我强烈推荐这个工具！

        *   print.css *（最终会被混合，所以使用@media print）*
        *   reset.css *（[埃里克迈耶的](http://meyerweb.com/eric/tools/css/reset/)）*
        *   screen.css *（用于@media screen，手持）*
        *   *必要时附加模块*
    *   /_vendor：所有第 3 方代码（jQuery、shadowbox 等）

    *   Blendfile.yaml *（用于 Blender；见上文）*

    *   template.html *（基本起始模板；可以为每个唯一模板复制和重命名）*
*   /tests：[硒](http://seleniumhq.org/)单元测试

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-07-22T06:15:46.177

只要确保您不要在文件夹中使用大写字母即可。当你在 windows 上开发并在 linux 服务器上部署时，它可能会咬你。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T16:51:56.470

尽力拥有一个样式表。为单个页面链接单个样式表违背了目的。

您可以通过在表单顶部包含以下行来继承 CSS 中的其他样式表

```
@import url('blueprint/screen.css');
@import url('blueprint/styles.css'); 
```

在这种情况下，我继承了蓝图 css 样式，然后在其下方添加了我的自定义样式。

就 JS 库而言，我更喜欢链接 3 个文件。

库，包含所有插件的一页，最后是页面代码。

对于目录结构，我通常有以下内容：

/_css /_images /_scripts 文件

但最近我开始将所有用于使网站看起来/以我想要的方式工作的东西放在 /_presentation 目录中......然后任何额外的东西，比如博客文章的图像等都会放在 /images

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T21:15:57.040

我总是试图让浏览器不必加载和解释未在相关 HTML 上使用的 CSS 规则和 JS 代码。我同意@bobince 的观点，即如果组织需要，您应该只将页面的样式和脚本分解为单独的文件，但如果您的网站非常大，您将达到这一点。

然而，由于我只构建基于模板的网站，我开始怀疑我为什么要链接到外部文件。例如，如果我有一个基本模板，那么我放在该模板头部的内容将应用于我网站上的所有页面。那么为什么不把我的样式和脚本放在那里呢？

我想到了两个原因。首先，浏览器可以缓存外部文件并在包含它的每个页面上重用它，而无需重新加载它。第二个设计师可能不喜欢在你的模板中四处乱逛，因为他们在处理普通的 CSS 文件。

这对于适用于您网站中每个页面的全局样式来说都很好，但是对于那些具有某些在其他任何地方都没有共享的样式的一次性页面呢？如果您将此样式添加到全局应用的外部文件中，您会增加站点的初始加载时间，只是为了拥有一种仅在一个页面上使用的样式。此外，当您在几个月后返回该文件时，您可能已经忘记了这些规则的用途。

我建议任何未在*每个页面*上表达的样式规则都应该放在子模板中的`<style>`标签中，该子模板呈现规则适用的 HTML。这会将负载和复杂性从全局样式表转移到需要样式的实际页面，并提供规则上下文以便将来可以维护它们。如果这让你的设计师感到害怕，他们无论如何都不需要编写 CSS。只是告诉他们坚持使用 Photoshop，让你做大男孩的工作。

# delphi - Delphi InputBox 用于输入密码？

> ID：591333
> 
> 赞同：16
> 
> 时间：2009-02-26T16:32:46.360
> 
> 标签：delphi, mask, textinput, inputbox

输入框：

```
answer:=Inputbox('a','b','c'); 
```

效果很好，但我正在寻找一个蒙面的，比如一个密码框，你只能看到小星星而不是输入的字符。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2014-01-14T20:02:20.880

在 XE2 中，`InputBox()`并`InputQuery()`已更新为原生支持屏蔽`TEdit`输入，尽管该功能尚未记录在案。如果参数的第一个字符`APrompt`设置为任何值 <`#32`则将`TEdit.PasswordChar`设置为`*`，例如：

```
answer := InputBox('a', #31'b', 'c'); 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-02-26T18:06:08.367

您可以向由 创建的编辑控件发送一条 Windows 消息，该消息`InputBox`将标记编辑控件以供输入密码。以下代码取自[http://www.swissdelphicenter.ch/en/showcode.php?id=1208](http://www.swissdelphicenter.ch/en/showcode.php?id=1208)：

```
const
   InputBoxMessage = WM_USER + 200;

type
   TForm1 = class(TForm)
     Button1: TButton;
     procedure Button1Click(Sender: TObject);
   private
     procedure InputBoxSetPasswordChar(var Msg: TMessage); message InputBoxMessage;
   public
   end;

var
   Form1: TForm1;

implementation

{$R *.DFM}

procedure TForm1.InputBoxSetPasswordChar(var Msg: TMessage);
var
   hInputForm, hEdit, hButton: HWND;
begin
   hInputForm := Screen.Forms[0].Handle;
   if (hInputForm <> 0) then
   begin
     hEdit := FindWindowEx(hInputForm, 0, 'TEdit', nil);
     {
       // Change button text:
       hButton := FindWindowEx(hInputForm, 0, 'TButton', nil);
       SendMessage(hButton, WM_SETTEXT, 0, Integer(PChar('Cancel')));
     }
     SendMessage(hEdit, EM_SETPASSWORDCHAR, Ord('*'), 0);
   end;
end;

procedure TForm1.Button1Click(Sender: TObject);
var
   InputString: string;
begin
   PostMessage(Handle, InputBoxMessage, 0, 0);
   InputString := InputBox('Input Box', 'Please Enter a Password', '');
end; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-26T17:24:45.080

InputBox 调用 Dialogs 中的 InputQuery 函数，动态创建表单。您可以随时复制此函数并更改 TEdit 的 PasswordChar 属性。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T17:18:56.563

我不认为 Delphi 包含开箱即用的东西。也许您可以在[http://www.torry.net/](http://www.torry.net/)或网络的其他地方找到一个。否则自己写一个——应该不会那么难。:-) 如果您有“足够大”的 Delphi 版本，您甚至可以查看源代码。

乌力。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-27T10:15:17.497

您可以使用 InputQuery 代替 InputBox。当设置 TRUE 参数时，密码字段将被屏蔽。

```
InputQuery('Authenticate', 'Password:',TRUE, value); 
```

这里有一些资源；[http://lazarus-ccr.sourceforge.net/docs/lcl/dialogs/inputquery.html](http://lazarus-ccr.sourceforge.net/docs/lcl/dialogs/inputquery.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-12-17T10:04:59.707

如果有人仍然需要一个简单的解决方案，这里是：

```
InputQuery('MyCaption', #0 + 'MyPrompt', Value); // <-- the password char '*' is used 
```

这是因为 InputQuery 函数具有以下嵌套函数：

```
function GetPasswordChar(const ACaption: string): Char;
begin
  if (Length(ACaption) > 1) and (ACaption[1] < #32) then
    Result := '*'
  else
    Result := #0;
end; 
```

每个提示都会调用它：

```
PasswordChar := GetPasswordChar(APrompts[I]); 
```

因此，如果 APrompts 中的第一个字符 < #32（例如 #0），则 TEdit 的密码字符将是 '*'。

**在德尔福 10.4 上测试。**我不确定这是什么时候引入的，我从 D6 直接跳到 10.4 并且没有在 D6 上测试过。

# c++ - 如何在 C++ 中声明 volatile 迭代器

> ID：591338
> 
> 赞同：1
> 
> 时间：2009-02-26T16:35:57.197
> 
> 标签：c++, iterator, volatile

有没有办法声明一个迭代器，它是类中的成员变量，即使该类的对象是 const，也可以使用成员函数递增。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-26T16:38:24.430

那将与“可变”关键字一起使用。

```
class X
{
public:
   bool GetFlag() const
   {
      m_accessCount++;
      return m_flag;
   }
private:
   bool m_flag;
   mutable int m_accessCount;
}; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-26T17:00:31.193

你确定你需要迭代器作为成员吗？迭代器有一个能力：它们变得无效。这是设计问题的一个小迹象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T16:38:49.840

声明它是可变的，而不是易变的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-26T17:39:04.673

知道了。

```
using namespace std;
class tmptest
{
    public:
    void getNextItr()const
    {
        m_listItr = m_list.begin();
        m_listItr++;
    }
    list<string> m_list;
    mutable list<string>::const_iterator m_listItr;
}; 
```

随`const_iterator`作品变化。感谢您提醒我 mutable 与 volatile。我将 volatile 与 mutable 混淆了。再次感谢！

# iphone - 如何在 iPhone 上实现 2d Image 动画？

> ID：591342
> 
> 赞同：1
> 
> 时间：2009-02-26T16:37:16.490
> 
> 标签：iphone, cocoa-touch

我有一系列想要制作动画的 UIImage 序列。事实证明，使用计时器并执行 drawRect 存在一些性能问题。

我的下一步是使用 UIImageView 进行调查，但如果您多次更新动画图像数组，显然会有内存泄漏。

我的下一步是研究使用 CALayer 和 CAAnimation 来做到这一点，但在快速浏览文档后，他们似乎并没有表明它是用于在图像之间制作动画（注意，我没有改变位置或其他任何东西，只是图片）。

我是走在正确的道路上还是我应该调查其他一些方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T16:49:49.737

你真的需要多次更新 UIImageView 中的图像数组吗？如果您需要更改已经使用过的动画，我会认为最好创建一个新的 UIImageView ？

我听说 UIImageView 的数组动画中存在内存泄漏，但我从 v2.0 开始就一直在使用它，并且没有遇到任何重大问题。当然是 YMMV。

要首先设置帧数组，请加载带有 UIImages 的 NSMutableArray（每个帧一个）并将其设置到 UIImageView 的 animationImages 属性中（然后也设置 animationDuration 属性）。只需在您想要对其进行动画处理时调用 startAnimating 方法。在正常使用中，一旦设置，您不需要更改帧数组。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-26T16:42:26.790

我不熟悉 iPhone 开发，但听起来你需要一个用于 2-d 动画的精灵。一个包含每一帧的大图像文件，一次只显示一个。就像索引二维数组一样，但您只需跟踪每一帧的像素偏移量。

# sql-server - 只读数据库查询？

> ID：591347
> 
> 赞同：0
> 
> 时间：2009-02-26T16:37:43.620
> 
> 标签：sql-server

我已经阅读了很多关于 ReadOnly 数据库的内容。

因此，我想知道拥有一个只读数据库是否有任何好处，它大量用于读取和查询数据，并且当写入数据库不使用锁定时，一个单独的写入数据库用于所有 CRUD 工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-26T16:41:30.613

可能会有一些好处，特别是如果它从 R/W 数据库中卸载了您的即席查询和报告需求。最大的挑战是让它们保持同步，但如果一夜之间的过程足够好（即不需要将日内更改包含在只读数据库中），那么通常拥有两个数据库效果很好，特别是如果数据库位于不同的物理机器上。

**编辑：**作为一个真实的例子，几年前在我的一个客户那里，他们很难从他们的生产数据库（SQL Server）中获取可用的临时报告，在非常强大的机器上运行，仅硬件成本就超过 50,000 美元。

我说服他们设置一个只读数据库，使用非规范化的 r/o 数据，并设置在台式机上运行的 SQL 服务器（硬件成本约为 2500 美元）和 2500 美元的现成台式电脑风靡一时性能是康柏四核处理服务器的 10 倍，具有大量内存和大量磁盘，试图满足单元的 OLTP、批处理和报告需求。

毋庸置疑，用户非常高兴，尽管最初遭到 IT 人员的抵制，但最终在“生产”机器上释放了宝贵的周期，并且该模型在其他地方得到了模仿。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T16:42:47.600

只读数据库的好处很明显：没有表锁定，当您尝试读取数据时没有人会更改数据。

但是，您确实有一个同步问题，您需要使用更改更新只读数据库，比如一夜之间。

您还可以将两个数据库放在不同的服务器上，以进一步提高性能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T16:44:17.487

我不认为只读关系数据库有很多好处。

也许您正在考虑的是一个 OLAP，其中数据被大量去规范化为多维矩阵。查看 SQL 服务器分析服务。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T16:50:20.110

如果您的应用程序通过已知的存储过程、报告等限制对数据库执行的 SQL 语句，请不要担心只读副本。毕竟，数据库旨在同时读取、写入和更新。毕竟，您将测试您的系统并确保您的 SELECT 查询不会锁定表，因此其他用户无法插入/更新/删除。

但是，如果您提供一种访问数据的特殊方法（即带有链接表的 MS Access），那么您肯定希望拥有一个只读数据库。否则，用户可能会编写诸如 SELECT * FROM TheBiggestTableEveryoneUses 之类的临时查询，这可能会与尝试在该表中插入/更新/删除记录的其他用户产生死锁。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-12T15:33:22.893

**这是一个架构问题，属于资源规划。**

*   您应该计划您的负载 http/SQL 调用/事务
*   定义您需要多少点击量 谁是您的受众
*   有多少并发 sql db 命中
*   缓存
*   SQL 并发模型
*   什么是压力水平

因此，您定义的体系结构称为事务数据库和报告数据库 [何时构建单独的报告数据库？](https://stackoverflow.com/questions/3331637/when-to-build-a-separate-reporting-database)

所以我在教育部工作，我们有 50 亿学生、老师、父母等的 100TB 数据。所以我们做了 SQL 集群和复制。因此，我们的数据每 5 分钟复制一次，并且从复制的数据库中，我们每周运行每月的大量报告，而不会影响我们的事务数据库。同样，如果您的公司负担不起多个数据库，您可以像初创公司一样在同一个数据库中进行操作。或者，如果受众不重要，只需节省 $$ LOL 您必须构建基础设施就像有人已经提到的那样需要 1\. 当事务性能至关重要时。2\. 当很难在事务性应用程序上获得维护窗口时。3\. 如果报告不仅需要关联来自此应用程序的结果，还需要关联来自其他应用程序孤岛的结果。4\. 如果报告需要支持最适合星型模式/商业智能环境的趋势或其他类型的报告。5\. 如果报告长时间运行。6\. 如果事务性应用程序位于昂贵的硬件资源（集群、大型机等）上 7\. 如果您需要对事务性数据进行数据清理/提取-转换-加载操作（例如，将状态名称转换为规范状态缩写） .

# iphone - 关于内存泄漏的问题（包括 Instruments 的屏幕截图）

> ID：591354
> 
> 赞同：0
> 
> 时间：2009-02-26T16:39:31.697
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我正在尝试从内存泄漏中清除我的应用程序。我面临的问题是 Instruments 正在报告我自己没有明确分配的对象的泄漏。现在，我确实明白这些对象可能是由于我编写的其他一些代码而被实例化的，但是我在堆栈中的任何地方都找不到我的客户端代码。这是 Instruments 报告泄漏的罪魁祸首对象集的屏幕截图：http: [//dl-client.getdropbox.com/u/57676/screenshots/leakss.png](http://dl-client.getdropbox.com/u/57676/screenshots/leakss.png)

有没有人对我如何继续找出这些泄漏的真正来源并将它们从应用程序中删除有任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T19:49:17.777

为了给这个错误增加另一层确定性，我会考虑在你的代码上运行 LLVM/Clang 静态分析器。取自他们的[网站](http://clang.llvm.org/StaticAnalysis.html)：

> LLVM/Clang 静态分析器是一个独立的工具，用于查找 C 和 Objective-C 程序中的错误。

更具体地说，它可以检查代码中的 alloc、init、release 调用的数量。它非常有用。

有关更多信息，Jeff LaMarche 在这里写了一篇关于安装和使用 Clang 静态分析器的精彩[文章](http://iphonedevelopment.blogspot.com/2009/02/clang-static-analyzer.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T18:43:23.100

> 我在堆栈中的任何地方都找不到我的客户端代码。

这并不意味着什么。Apple 的代码可能会因计时器或用户启动的事件（点击等）而运行。您的代码在 Apple 的代码*之后*运行（例如，Apple`mouseUp:`调用您的操作方法）。Apple 的代码不仅仅是调用你的代码；因此，找到仅包含 Apple 方法的堆栈跟踪也就不足为奇了。

因此，该泄漏似乎是Apple的。[您应该在Radar](https://bugreport.apple.com/)中提交错误。

这也适用于其他人。查看堆栈跟踪；如果它显示您的代码没有参与（即，仅 Apple 的代码），那么您应该提交一个错误。如果您的代码分配了它，那么它（可能）是您的错误，因此您应该找到它并自己修复它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T22:16:21.650

这些看起来非常像模拟器中出现的泄漏。如果你在 iPhone 上运行它，我敢打赌你不会再看到泄漏了。请记住，模拟器不会模仿 iPhone 的真实环境。最终的答案是关闭 iPhone。模拟器非常适合测试，但在您开始了解您在模拟器中看到的内容之前，请确保您也在 iPhone 中看到了它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T20:01:34.127

请记住，您的应用程序可能会到处泄漏一些字节，但如果它不影响应用程序本身的功能，那么它可能不是一个大问题。显然，如果您能提供帮助，您不想泄漏内存，但我还没有听说 Apple 会因为内存泄漏小而拒绝人们的应用程序。如果有人因内存泄漏而被拒绝，希望对此进行更正。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T22:17:40.713

要检查的另一件事是内存泄漏是否随时间增加？如果没有，则不会注意到泄漏 200 字节。我想重点是 - 一天只有这么多小时，而且很可能在几个小时的编码/调试中，您可以将应用程序内存占用减少 10 或 1000 倍，显示为泄漏的几个字节在您提供的屏幕截图中。

总内存占用是最重要的，一旦泄漏，如果它们不能被轻易追踪，有时最好保持原样。

——汤姆

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T17:05:55.127

我看过一些关于此的帖子，似乎是一个常见的挫折点。

我有一个应用程序可以解析从 Web 服务检索到的 XML 文件。由于 URL 缓存，它也有类似的泄漏。

在 XML 解析器上调用 init 之前，我使用以下代码堵住了漏洞：

`[[NSURLCache sharedURLCache] setMemoryCapacity:0]; [[NSURLCache sharedURLCache] setDiskCapacity:0];`

# sql - 将 SELECT 转换为更新语句

> ID：591360
> 
> 赞同：6
> 
> 时间：2009-02-26T16:41:16.560
> 
> 标签：sql, sql-server

```
SELECT t1.status, t3.guid, t3.objectID
FROM Table1 t1, Table2 t2, Table3 t3
WHERE t2.ID = t3.ID
   AND t1.ID = t2.ID
   AND t3.Guid IN ('', '', '') 
```

如何将其转换为我设置的更新语句`t1.status = 1`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-26T16:49:28.210

我首先将其转换为使用连接而不是“经典连接”：

```
select t1.status, t3.guid, t3.objectID
from Table1 t1
inner join Table2 t2 on t2.ID = t1.ID
inner join Table3 t3 on t3.ID = t2.ID
where t3.Guid in ('', '', '') 
```

然后，您可以撕下 select 语句并在其上添加 update 和 set 语句：

```
update t1
set status = 1
from Table1 t1
inner join Table2 t2 on t2.ID = t1.ID
inner join Table3 t3 on t3.ID = t2.ID
where t3.Guid in ('', '', '') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T16:43:34.167

尝试这样的事情：

```
update Table1
set status = 1
from Table1 t1
    inner join Table2 t2 on t1.ID = t2.ID
    inner join Table3 t3 on t2.ID = t3.ID
where t3.Guid IN ('', '', ''); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T16:43:40.720

```
UPDATE Table1
SET status = 1
FROM Table1 t1, Table2 t2, Table3 t3
WHERE t2.ID = t3.ID
   AND t1.ID = t2.ID
   AND t3.Guid IN ('', '', '') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T16:44:26.397

```
update Table1
set status = 1
FROM Table1 t1, Table2 t2, Table3 t3
WHERE t2.ID = t3.ID
   AND t1.ID = t2.ID
   AND t3.Guid IN ('', '', '') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T16:44:50.140

```
UPDATE Table1 set status = 1 
from table2 t2, table 3 t3 
where t2.ID = t3.ID 
and Table1.ID = t2.ID 
and t3.GUID in ('','','') 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T16:45:47.297

我相信 MS SQL Server（但不是 Oracle），你可以这样写：

```
UPDATE TABLE1 
set t1.status = 1
FROM Table1 t1, Table2 t2, Table3 t3
WHERE t2.ID = t3.ID
   AND t1.ID = t2.ID
   AND t3.Guid IN ('', '', '') 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-26T16:47:18.197

```
MERGE
INTO Table1 t1
USING
  (
  SELECT t2.id
  FROM Table2 t2, Table3 t3
  WHERE 
    t3.ID = t2.id
    AND t3.GUID IN ('', '', '')
 ) to
ON t1.id = to.id
WHEN MATCHED THEN
  UPDATE
  SET t1.status = 1 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-04-11T17:42:45.920

```
update t1 set t1.status=(select 1 from Table1 t1, Table2 t2, Table3 t3 WHERE t2.ID = t3.ID   AND t1.ID = t2.ID  AND t3.Guid IN ('', '', '')) 
```

# c# - 在 NInject 中实现 OnePerSessionBehavior

> ID：591362
> 
> 赞同：2
> 
> 时间：2009-02-26T16:41:48.010
> 
> 标签：c#, dependency-injection, inversion-of-control, ninject

我想为 NInject (v1.0) 创建一个 OnePerSessionBehavior，而且我大部分时间都在工作。剩下的唯一问题是如何使用 .WithArguments() 传递新的参数，因为每个新会话都要求容器提供一些东西。现在我将容器的引用保留为应用程序变量，因此该模块只加载一次，所以当然绑定只发生一次。

例如，以下为每个新会话返回 'Something' 的各个实例，但传递给所有会话的构造函数参数是相同的 DateTime。

```
Bind<ISomething>()
    .To<Something>()
    .Using<OnePerSessionBehavior>()
    .WithArgument("currentDateTime", DateTime.Now); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-03-01T06:34:53.933

你可以通过一个 lamda 作为你的论点吗？例如，如果您有这样的课程：

```
public class Something : ISomething
{
    public Something(Action<DateTime> initializer)
    {
        var now = initializer();
    }
} 
```

您可以按如下方式绑定它：

```
Bind<ISomething>()
    .To<Something>()
    .Using<OnePerSessionBehavior>()
    .WithArgument("initializer", () => { return DateTime.Now; }); 
```

虽然我不知道你的确切情况，但另一个想法是创建你的对象而不用担心参数注入，*然后*设置你的属性：

```
kernel.Bind<ISomething>().To<Something>().Using<OnePerSessionBehavior>();    
var mySomething = kernel.Get<Something>();
mySomething.DateCreated = DateTime.Now; 
```

或者：

```
mySomething.Initialize(DateTime.Now); 
```

这些想法中的任何一个都行得通吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-14T19:50:35.573

您正在传递一个在绑定定义期间评估的值。这就是为什么你一遍又一遍地获得相同的价值。实际上，从我的脑海中，我没有一个简单的答案，但我肯定会考虑它，因为它可能对我的测试目的有用。

# c# - MSI 启动条件自定义操作

> ID：591367
> 
> 赞同：1
> 
> 时间：2009-02-26T16:42:28.583
> 
> 标签：c#, asp.net, installation, windows-installer, custom-action

我已经能够触发 C# 自定义操作来覆盖 MSI 的安装和提交阶段。但是，在部署 ASP.NET 应用程序时，我希望能够在安装开始之前执行检查。

我知道有启动条件，但是，我希望能够在此处插入我自己的代码来处理自己启动时的检查，因为我看到启动条件只是用于检查 IIS 等的正确版本？

谁能在这里指出我正确的方向，或者即使有办法让启动条件触发一些 C#？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T22:45:40.613

我认为使用自定义操作设置属性值然后运行启动条件来检查属性值将是一种方法。但是，这似乎不适用于 VS 安装项目，因为自定义操作在启动条件之后才会运行。[WiX](http://wix.sourceforge.net/)将允许更大的控制，并且应该允许更早地执行自定义操作。

一种粗略的方法是让自定义操作抛出异常并回滚安装，但这将是一个丑陋的黑客攻击。

我发现了一个[论坛线程](http://www.eggheadcafe.com/forumarchives/windowsmsi/Jun2005/post23457192.asp)，讨论如何检查某个服务是否在安装时运行，这可能会引导您朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T04:33:13.167

只需在 LaunchConditions 之后*立即安排您的自定义操作。*对于所有意图和目的，结果都是相同的。

在 InstallShield 中，这只是通过下拉菜单选择运行时间的问题。或者使用 WiX，这将是这样的：

```
 <Custom Action="BlahBlahBlah" After="LaunchConditions">1</Custom> 
```

与往常一样，对于任何开始使用 MSI 的人，我建议阅读[Windows Installer 权威指南](https://rads.stackoverflow.com/amzn/click/com/1590592972)。它提供了非常宝贵的底层知识（使用 Visual Studio 安装项目和 Orca），无论您使用 WiX、InstallShield 还是任何其他工具来构建 MSI 文件，这些知识都适用。

# silverlight - 在 Visual Studio 安装项目中创建 IE 的快捷方式

> ID：591369
> 
> 赞同：1
> 
> 时间：2009-02-26T16:42:34.230
> 
> 标签：silverlight, internet-explorer, installation, project, shortcut

我正在为我们的 Silverlight 应用程序创建安装程序。该应用程序将在本地计算机上以信息亭模式在 Internet Explorer 中运行，并将从桌面快捷方式启动。我在 VS 2008 中使用我的安装项目创建快捷方式时遇到问题。我最终需要的是桌面上的快捷方式

*"C:\Program Files\Internet Explorer\iexplore.exe" -k [ProgramFilesFolder][Manufacturer][ProductName]\MySilverlightHostPage.html*

作为目标。如果可能的话，我也想要我自己的图标。有任何想法吗？我尝试了几种不同的方法来做到这一点，但没有什么完全正确的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-29T13:44:12.763

我试过了，它奏效了： - 在文件系统的任何位置手动创建快捷方式，指定你想要的目标并设置它的图标 - 在你的安装项目中右键单击你的安装项目。选择视图-> 文件系统。右键单击目标机器上的文件系统，选择添加特殊文件夹->用户桌面。右键单击用户桌面，选择添加->文件。选择您之前创建的快捷方式。此快捷方式将添加到用户桌面。

安装后，此快捷方式将显示在用户桌面上，并带有您选择的图标，卸载应用程序会将其删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T17:03:29.860

查看 Deskliter 实用程序，它将“包装”您的 XAP 并生成一个 EXE 文件，您可以使用该文件将您的 Silverlight 应用程序作为“kiosk”应用程序在桌面上运行：http: [//blendables.com/labs/Desklighter/Default。 .aspx](http://blendables.com/labs/Desklighter/Default.aspx) _

也有传言说 SL3 支持离线。[在http://blogs.zdnet.com/Stewart/?p=769](http://blogs.zdnet.com/Stewart/?p=769)上查看- 尚未确认，但后续会很有趣。

# asp.net - ASP.NET MVC - 部署在 IIS6 上，会话开始后停止加载

> ID：591372
> 
> 赞同：1
> 
> 时间：2009-02-26T16:43:26.537
> 
> 标签：asp.net, asp.net-mvc, iis-6

到达这里...我有一个 ASP.NET MVC 应用程序，它可以在 VS2008 开发服务器和 IIS7 上完美运行。但是，在 IIS6 上部署会产生空白页，并且事件日志中也没有错误消息。非常令人沮丧！

我已经尝试了通配符映射技术、基于扩展的路由 ({controller}.aspx/{action}) 以及我能想到的每个配置变体。

有人对解决此类问题有任何想法吗？为什么 IIS 会提供空白页面而不是真实的页面（如错误）。内存问题？机器有 4Gig 的 RAM，所以这不应该是一个问题。

登录应用程序显示 Global.asax 文件正在成功处理，直到 Session_Start。之后（当路由应该接管时），它停止。

任何想法，将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T18:29:38.187

您必须设置一些 ISAPI 映射。Phil Haack 在他的博客上介绍了它。您可以在此处找到条目：http: [//haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx](http://haacked.com/archive/2008/11/26/asp.net-mvc-on-iis-6-walkthrough.aspx)

这有点痛苦，但这是 IIS6 处理事情的方式。我不确定RC版本是否还有这个问题，因为我今天都是IIS7。

# sql - 是否可以将 SELECT INTO 子句与 UNION [ALL] 一起使用？

> ID：591382
> 
> 赞同：178
> 
> 时间：2009-02-26T16:44:44.757
> 
> 标签：sql, sql-server

在 SQL Server 中，这会将 100 条记录从 Customers 表插入到 tmpFerdeen 中：-

```
SELECT top(100)*
INTO tmpFerdeen
FROM Customers 
```

是否可以跨 UNION ALL SELECT 执行 SELECT INTO ：-

```
SELECT top(100)* 
FROM Customers
UNION All
SELECT top(100)* 
FROM CustomerEurope
UNION All
SELECT top(100)* 
FROM CustomerAsia
UNION All
SELECT top(100)* 
FROM CustomerAmericas 
```

不太确定在哪里添加 INTO 子句。

* * *

## 回答 #1

> 赞同：253
> 
> 时间：2009-02-26T16:54:30.990

这适用于 SQL Server：

```
SELECT * INTO tmpFerdeen FROM (
  SELECT top 100 * 
  FROM Customers
  UNION All
  SELECT top 100 * 
  FROM CustomerEurope
  UNION All
  SELECT top 100 * 
  FROM CustomerAsia
  UNION All
  SELECT top 100 * 
  FROM CustomerAmericas
) as tmp 
```

* * *

## 回答 #2

> 赞同：141
> 
> 时间：2012-09-27T10:26:08.650

为此，您根本不需要派生表。

只需将`INTO`后放在第一个`SELECT`

```
SELECT top(100)* 
INTO tmpFerdeen
FROM Customers
UNION All
SELECT top(100)* 
FROM CustomerEurope
UNION All
SELECT top(100)* 
FROM CustomerAsia
UNION All
SELECT top(100)* 
FROM CustomerAmericas 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-09-27T04:05:10.957

```
SELECT * INTO tmpFerdeen FROM 
(SELECT top(100)*  
FROM Customers 
UNION All 
SELECT top(100)*  
FROM CustomerEurope 
UNION All 
SELECT top(100)*  
FROM CustomerAsia 
UNION All 
SELECT top(100)*  
FROM CustomerAmericas) AS Blablabal 
```

这个“Blablabal”是必要的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-04-11T17:22:22.330

对于 MS Access 查询，这有效：

```
SELECT * INTO tmpFerdeen FROM( 
    SELECT top(100) *
    FROM Customers 
UNION All 
    SELECT top(100) *  
    FROM CustomerEurope 
UNION All 
    SELECT top(100) *  
    FROM CustomerAsia 
UNION All 
    SELECT top(100) *  
    FROM CustomerAmericas
) 
```

这在 MS Access 中不起作用

```
SELECT top(100) * 
  INTO tmpFerdeen
  FROM Customers
UNION All
  SELECT top(100) * 
  FROM CustomerEurope
UNION All
  SELECT top(100) * 
  FROM CustomerAsia
UNION All
  SELECT top(100) * 
  FROM CustomerAmericas 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-05-23T14:03:22.543

我会这样做：

```
SELECT top(100)* into #tmpFerdeen
FROM Customers

Insert into #tmpFerdeen
SELECT top(100)* 
FROM CustomerEurope

Insert into #tmpFerdeen
SELECT top(100)* 
FROM CustomerAsia

Insert into #tmpFerdeen
SELECT top(100)* 
FROM CustomerAmericas 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-06-10T16:21:45.247

我在解决方案中看到的挑战：

```
FROM( 
SELECT top(100) *
    FROM Customers 
UNION
    SELECT top(100) *  
    FROM CustomerEurope 
UNION 
    SELECT top(100) *  
    FROM CustomerAsia 
UNION
    SELECT top(100) *  
    FROM CustomerAmericas
) 
```

是这会创建一个窗口数据集，该数据集将驻留在 RAM 中，并且在更大的数据集上，此解决方案将产生严重的性能问题，因为它必须首先创建分区，然后它将使用该分区写入临时表。

更好的解决方案如下：

```
SELECT top(100)* into #tmpFerdeen
FROM Customers

Insert into #tmpFerdeen
SELECT top(100)* 
FROM CustomerEurope

Insert into #tmpFerdeen
SELECT top(100)* 
FROM CustomerAsia

Insert into #tmpFerdeen
SELECT top(100)* 
FROM CustomerAmericas 
```

选择插入临时表，然后添加其他行。然而，这里的缺点是数据中是否有任何重复的行。

最佳解决方案如下：

```
Insert into #tmpFerdeen
SELECT top(100)* 
FROM Customers
UNION
SELECT top(100)* 
FROM CustomerEurope
UNION
SELECT top(100)* 
FROM CustomerAsia
UNION
SELECT top(100)* 
FROM CustomerAmericas 
```

此方法适用于需要不同行的所有目的。但是，如果您想要重复的行只需将 UNION 换成 UNION ALL

祝你好运！

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-02-26T16:47:25.717

也许试试这个？

```
SELECT * INTO tmpFerdeen (
SELECT top(100)* 
FROM Customers
UNION All
SELECT top(100)* 
FROM CustomerEurope
UNION All
SELECT top(100)* 
FROM CustomerAsia
UNION All
SELECT top(100)* 
FROM CustomerAmericas) 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-02-26T16:47:16.967

尝试这样的事情：创建最终的对象表，tmpFerdeen 与联合的结构。

然后

```
INSERT INTO tmpFerdeen (
SELECT top(100)* 
FROM Customers
UNION All
SELECT top(100)* 
FROM CustomerEurope
UNION All
SELECT top(100)* 
FROM CustomerAsia
UNION All
SELECT top(100)* 
FROM CustomerAmericas
) 
```

# magic-numbers - 为什么人们在他们的代码中使用魔法值而不是 null？

> ID：591384
> 
> 赞同：9
> 
> 时间：2009-02-26T16:45:01.353
> 
> 标签：magic-numbers

我在遗留代码和一些 .NET 开源项目中看到了这一点。我想不出这样做的理由。仅使用“null”对我来说似乎要容易得多。

例子：

```
public class Category
{
   int parentID;

   bool HasParent
   {
      get
      {
          return parentID != -1;
      }
   }
} 
```

相对

```
public class Category
{
   int parentID;

   bool HasParent
   {
      get
      {
          return parentID != null;
      }
   }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-26T17:48:23.917

Because to have a "null" value, the type must be nullable. This works fine for reference types (any class you define and the standard library), and if you look you'll see that people *do* use null whenever they have a reference object with no value

```
Employee employee = Employees.Find("John Smith");
if(employee == null) throw new Exception("Employee not found"); 
```

The issue comes when you use the *value* types like int, char or float. Unlike reference types, which point to a block of data somewhere else in memory, these values are stored and manipulated inline (there is no pointer/reference).

Because of this, by default, the value types **do not have a null value**. In the code you provided, it is **impossible** for parentID to be null (I'm actually surprised this even got by your compiler - Visual Studio 2008 and probably 2005 will draw a green underline and tell you that the statement is always false).

In order for an int to have a null value, you need to declare it as nullable

```
int? parentID; 
```

*Now* parentID can contain a null value, because it is now a *pointer* (well "reference") to a 32 bit integer, instead of just a 32bit integer.

So hopefully you understand why "magic values" are often used to represent null with the basic types (value types). It is simply a lot of trouble, and often a large performance hit (lookup what boxing/unboxing is), to store these value types as a reference to the value in order to allow them to be null.

Edit: For further reference about boxing/unboxing (what you need to have an int==null), see the article at [MSDN](http://msdn.microsoft.com/en-us/library/yz2be5wk.aspx):

> *Boxing and Unboxing (C# Programming Guide)*
> 
> Performance
> 
> In relation to simple assignments, boxing and unboxing are computationally expensive processes. When a value type is boxed, a new object must be allocated and constructed. To a lesser degree, the cast required for unboxing is also expensive computationally. For more information, see Performance.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T17:24:07.547

这些通常是用 C 编程时养成的习惯。许多 C 程序员会对可空 int 的浪费感到震惊，这至少需要一个完整的额外位，甚至可能需要一个指针。当您知道该值将是正值并且您有整个负值空间可用于标志时，这尤其糟糕。-1 可能表示未设置，-2 可能表示 parentId 在此节点的上下文中甚至没有意义，-3 可能表示该节点的父节点无法处理工作并继续酗酒，并且再也见不到了，等等……

在 C# 世界中，可空整数（以及它们与 RDMS 的轻松集成）以及具有 2GB+ RAM 的计算机的清洁意味着旧的 C 习惯正在慢慢消失，但旧的习惯很难改掉。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T16:49:07.350

拥有一个空对象可能会引发异常，而错误代码（如“-1”失败案例）不会引发异常。

这在不能很好地处理异常的语言或应用程序中可能很关键。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-26T16:51:03.510

在大数据仓库工作时，我有时使用 0 值而不是 null，在我的多维数据集中插入一个非 null 值。我总是有一个 0 id 对应于所有维度的“未知”值，所以我有一个没有空值的多维数据集。

它的主要兴趣是有更简单和更有效的查询

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T17:32:37.090

可空值类型并非在每种语言/环境中都可用；它们被添加到 .Net 2.0。如果您的旧代码是基于 .Net 的并且是使用 1.1 框架开始的，那么您的答案是 null 当时不是一个选项。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-26T16:48:12.173

您是否真的查看了应用程序以查看？只要将幻数保存在一个带有描述性名称的地方，它就会非常有用。

# vb.net - 遍历 DataRepeater (VB.Net PowerPack)

> ID：591391
> 
> 赞同：0
> 
> 时间：2009-02-26T16:46:06.033
> 
> 标签：vb.net, winforms, datarepeater, powerpacks

我正在使用来自 vb.net 电源组的 winform datarepeater 控件。

中继器上的所有项目都是只读的，除了复选框列。

我想遍历这些项目并找出选中了哪些复选框。

我在控件上找不到数据重复项的集合，并且帮助很少。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-12-02T11:58:49.647

不久前有人问过这个问题，但以防万一其他人正在寻找答案：

```
for (int i = 0; i < this.dataRepeater1.ItemCount; i++)
{
    this.dataRepeater1.CurrentItemIndex = i;

    CheckBox checkBox = (CheckBox)
                this.dataRepeater1.CurrentItem.Controls["controlName"];
    bool isChecked = checkBox.Checked;
} 
```

这种方法使处理/读取同一中继器项目上的任何相关控件变得更加容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-02T13:33:09.340

为什么不只检查数据中继器的数据源？

例如，我有一个 datarepeater 绑定到 Persons 的 Bindingsource 请参阅按钮处理程序

```
 private void Form1_Load(object sender, EventArgs e)
    {
        List<Person> persons = new List<Person>();
        persons.Add(new Person { Name = "Peter", IsLocal = true });
        persons.Add(new Person { Name = "Sepp", IsLocal = false });
        persons.Add(new Person { Name = "Franz", IsLocal = false });

        personBindingSource.DataSource = persons;
    }

    private void buttonCountCheckBox_Click(object sender, EventArgs e)
    {
        int i = 0;

        foreach (Person singlePerson in personBindingSource)
        {
            if (singlePerson.IsLocal)
            {
                i++;
            }

        }
        Console.WriteLine("DEBUG: checked found: " + i);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-04T01:55:03.603

您可以遍历控件列表（从模板生成）

1.  将数据中继器中的复选框重命名为“checkBoxUnbound”

2.  使用下面的代码

    ```
    private void button3_Click(object sender, EventArgs e)
    {
        int i = 0;
        CheckBox unboundCheckBox;
        foreach (Control c in dataRepeater1.Controls)
        {
            unboundCheckBox = c.Controls["checkBoxUnbound"] as CheckBox;
            if (unboundCheckBox != null && unboundCheckBox.Checked)
            {
                i++;
            }
        }

        Console.WriteLine("DEBUG: checked found: " + i);

    } 
    ```

# emacs - Emacs Lisp：如何对列表中的奇数求和？

> ID：591392
> 
> 赞同：7
> 
> 时间：2009-02-26T16:46:36.297
> 
> 标签：emacs, elisp

我想找到 elisp 的类似物：

```
sum(n for n in numbers if n % 2) # Python
numbers.select { |n| n % 2 != 0 }.inject { |a, b| a + b } # Ruby 
```

命令方式：

```
(defun oddp (number)
  (not (= (mod number 2) 0)))

(defun sum-odd-with-dolist (list)
  (let ((acc 0))
    (dolist (item list acc)
      (if (oddp item)
          (setq acc (+ item acc)))))) 
```

从[移植 Common Lisp](http://www.gnu.org/software/emacs/manual/html_node/cl/Porting-Common-Lisp.html)：

```
(defun sum-odd-with-dolist-incr (list)
  (let ((total 0)) 
    (dolist (item list) 
      (if (oddp item)
          (incf total item))) 
      total)) 
```

使用“ `cl-*`” `loop`：

```
(defun sum-odd-with-loop (list)
  (loop for x in list if (oddp x) sum x))

(sum-odd-with-loop '(1 2 3))
4 
```

有没有更惯用的方法（不需要`cl-*`包）？

### 有关的：

> [如何对 Emacs Lisp 中的数字列表求和？](https://stackoverflow.com/questions/590579/how-to-sum-a-list-of-numbers-in-emacs-lisp)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-26T19:19:20.970

惯用的方法是使用`cl`包中的函数和宏。它们是 Emacs Lisp 的标准配置，使用它们没有任何问题。

我怀疑你会找到一种简洁明了的方法

```
(loop for x in list if (oddp x) sum x) 
```

还有更多功能性的方法可以做到这一点，例如

```
(apply #'+ (remove-if-not #'oddp list)) 
```

但这使用`remove-if-not`的是`cl-seq`包装中的。你可以手动写出一个循环：

```
(let ((sum 0)) (dolist (x list sum) (when (oddp x) (incf sum x)))) 
```

但这两种用途`dolist`都`incf`在`cl-macs`包装中。基本上你无法逃脱这个`cl`包：`oddp`它本身就是一个`cl`函数！

我完全不使用任何`cl`设施的最大努力是：

```
(apply #'+ (mapcar (lambda (x) (* x (mod x 2))) list)) 
```

但是在实践中使用它而不是`(loop ...)`版本是荒谬的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-26T18:01:32.247

```
 (apply '+ (delq nil (mapcar (lambda (x) (and (= 1 (% x 2)) x)) '(1 2 3 4 5)))) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-18T11:14:04.607

我同意[Gareth Rees 的回答](https://stackoverflow.com/a/592016/596361)，但如果您在代码中大量使用函数式编程和数据操作，我强烈建议您安装 Magnar Sveen 的[`dash.el`](https://github.com/magnars/dash.el)列表 API。它有大量用于编写简洁优雅的函数式代码的函数。顺便说一句，它本身是在没有`cl`库的情况下编写的。总结一个列表中的奇数将是：

```
(-sum (--filter (= (mod it 2) 1) '(1 2 3 4 5))) 
```

[`-sum`](https://github.com/magnars/dash.el#-sum-list)是 的缩写`(-reduce '+ xs)`。以 2 个连字符开头的函数是[照应宏](http://en.wikipedia.org/wiki/Anaphoric_macro)，它们公开一个临时变量。例如，这里不是传递`(lambda (x) (= (mod x 2) 1))`给[`--filter`](https://github.com/magnars/dash.el#-filter-pred-list)我们，而是简单地写`(= (mod it 2) 1)`，其中`it`用于局部变量。

# abstract-class - 抽象类和 Mixin 有什么区别？

> ID：591402
> 
> 赞同：15
> 
> 时间：2009-02-26T16:48:12.080
> 
> 标签：abstract-class, mixins, apache-zest, cop

我刚刚发现[一篇](http://www.infoq.com/news/2008/11/Qi4j)关于 Java 框架的文章，它显然允许它支持[Mixins](http://en.wikipedia.org/wiki/Mixin)和一种叫做面向复合编程的东西（据我所知，这甚至可能是同一件事......）我也听说过/使用过 AOP，而且我不确定它与此有何不同...

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-26T16:54:40.660

在与语言无关的级别上，mixin 只是为类添加功能，更多的是为了程序员的方便和避免代码重复。抽象（基）类形成一个 is-a 关系并允许多态性。过度使用继承的一个原因是，它是一种实现 mixin 的简单方法，无需用不真正支持它们的语言编写任何样板。问题是您将多态 is-a 关系声明为副作用，使您的 API 更加混乱并可能增加歧义。因此，像 D 和 Ruby 等较新的语言支持 mixins 作为本机特性，从而可以方便地向类添加一堆功能，而无需声明多态 is-a 关系。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T17:35:39.703

Mixin 从来都不是独立的类。他们只是为您声明的类添加了一些功能。在 Python 中，它们可以很容易地被类装饰器应用。例如，您可以使用 Singleton mixin 装饰您的班级，使您的班级成为单身人士。

# java - Java 错误：找到接口...但应使用类

> ID：591411
> 
> 赞同：42
> 
> 时间：2009-02-26T16:49:47.380
> 
> 标签：java, guice

我从我的代码中得到一个奇怪的运行时错误：

```
"Found interface [SomeInterface] but class was expected" 
```

这怎么可能发生？接口如何被实例化？

**更新：（**响应一些答案）我正在编译和运行同一组库，但我**正在**使用[Guice](http://code.google.com/p/google-guice/)为这个特定的接口注入一个提供程序。

当我将实现绑定到接口时，问题就消失了（似乎 @ImplementedBy 注释还不够）。

我对 Guice 实际实例化接口的机制更感兴趣。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2009-02-26T16:56:02.217

当您的运行时类路径与编译时类路径不同时，就会发生这种情况。

编译您的应用程序时，一个类（在您的问题中命名`SomeInterface`）作为一个类存在。

当您的应用程序在编译时运行时，`SomeInterface`作为接口（而不是类）存在。

这会导致`IncompatibleClassChangeError`在运行时抛出一个。

如果编译时类路径上的 jar 文件版本与运行时类路径上的版本不同，则这种情况很常见。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-26T16:57:19.110

很可能代码是针对库中的类编译的，然后将其更改为您运行的版本中的接口。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-10T05:28:04.460

我有同样的问题。我在我的应用程序中使用了两个 jar 库。一个库建立在另一个之上。

库 A 定义了顶级类和接口。库 B 需要库 A。

这是库 B 中使用的一些代码的伪代码：

```
TheInterface instance = new TheClass();
instance.someMethod(); 
```

显然库 A 比库 B 更新，`TheInterface`并且不再包含`someMethod`，但`TheClass`仍然包含。解决此问题的唯一方法是获取任一 jar 的源代码并手动更改这些内容（如果可能的话）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-11-02T16:18:23.577

这发生在我运行`maven build`.

从我能收集到的信息（以及 Jared 的[回答](https://stackoverflow.com/a/591432/8919607)），原因是 - 在我的有效文件中指定了同一个 3rd 方 jar 的两个版本`pom.xml`。一个版本是作为[传递依赖](https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#Transitive_Dependencies)项进来的，另一个是我在本地指定的`pom.xml`。

所以在编译时，它指的是旧版本，而在运行时它指的是新版本。

我删除了本地指定的版本`pom.xml`并且它有效。

当然，第 3 方破坏了他们版本之间的向后兼容性，并将类更改为接口，反之亦然。但他们可以自由地这样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T16:54:15.187

听起来你做了

```
class MyClass extends SomeInterface 
```

实际上应该是什么时候

```
class MyClass implements SomeInterface 
```

我对吗？

编辑：哦，你说这是*运行时*错误而不是*编译时*错误？让我看看周围...

编辑 2：看起来 Jared 的答案是正确的。无论如何，尝试扩展接口实际上会在编译时给出“*这里没有预期的接口*”消息，而不是“*找到接口但预期类*”错误。

# python - python变量不接受名称

> ID：591421
> 
> 赞同：0
> 
> 时间：2009-02-26T16:53:16.407
> 
> 标签：python, variables, syntax-error

我试图在一个非常基本的碰撞检测程序中声明一些简单的变量作为函数的一部分。出于某种原因，它拒绝了我的变量（尽管只有其中一些变量，即使它们几乎相同）。这是函数的代码；

```
def TimeCheck():
    timechecknumber = int(time.time())
    timecheckdiv = backcolourcheck % 5
    if timecheckdiv < 1:
        timecheck = true
    else:
        timecheck = false
    if timecheck == true:
        backgroundr = (int(random.random()*255)+1
        backgroundg = (int(random.random()*255)+1
        backgroundb = (int(random.random()*255)+1 
```

出于某种原因，它接受背景但不接受背景，有人知道为什么吗？谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T16:55:47.087

您在以 . 开头的行上的括号不匹配`backgroundr`。我想也许你想要这个：

```
backgroundr = int(random.random() * 255) + 1 
```

请注意，接下来的两行中的每一行也有不匹配的括号，因此您也必须修复它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T17:00:12.550

mipadi 的答案总是会产生 1。在转换为 int 之前，您需要乘以 255。试试这个。

```
backgroundr = int(random.random() * 255) + 1 
```

# html - 将 UL 右角放在 DIV 左角开始的位置

> ID：591422
> 
> 赞同：-1
> 
> 时间：2009-02-26T16:53:54.970
> 
> 标签：html, css, html-lists

我里面有DIV和UL，位置：绝对。默认情况下，左侧为 0px。我需要将 UL 移动到 100% 的 UL 宽度的左侧。UL 右角将是 DIV 左角开始的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T17:16:01.407

如果您知道 ul 的宽度，请将 left 属性设置为 -that 宽度，例如

```
left: -100px; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T17:21:57.430

您是否尝试过为 UL 赋予样式：

```
ul { margin-left:-100%; } 
```

这应该将其移动到与 UL 相同的宽度，并将呈现在 div 之外。如果没有更多页面源，很难说这将如何影响您的布局的其余部分......

编辑：

要使 UL 相对于 DIV 移动，还需要设置：

```
div { position:relative; } 
```

# ios - 通过 SDK 获取本地 iPhone 号码

> ID：591430
> 
> 赞同：0
> 
> 时间：2009-02-26T16:55:40.970
> 
> 标签：ios, iphone, phone-number

我正在寻找一个 SDK API 来
从 SIM 卡中检索设备的本地电话号码。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T00:26:25.613

没有可靠的方法。您会在网上找到告诉您查找 SBFormattedPhoneNumber 的代码，有时这可行，但并非始终如一。大多数是从另一个手机运营商那里带来电话号码的人。在这些情况下，您会得到一个电话号码，但不是当前电话的电话号码，也不是保证对任何东西都有效的电话号码（它甚至可能不是唯一的）。

我没有理由说这是少数人还是很多人，但它是一个未记录的密钥，本质上是不可靠的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-25T14:42:19.610

[在此处](http://blog.timeister.com/2009/06/25/objective-c-get-iphone-number/)查看此博客文章。

```
NSString *num = [[NSUserDefaults standardUserDefaults] stringForKey:@”SBFormattedPhoneNumber”]; NSLog(@”Phone Number: %@”, num); 
```

阿德里安

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-26T10:12:36.337

此方法是指激活时iTunes中存储的数字......所以，不要使用它。从 4.x 开始，您可以利用 CoreTelephony 框架来获取有关网络的许多信息，但仍然没有数字......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-03-18T10:29:27.647

```
CFShow([[NSUserDefaults standardUserDefaults] objectForKey:@"SBFormattedPhoneNumber"]); 

NSString *path = [NSHomeDirectory() stringByAppendingPathComponent:@"Library/Preferences/.GlobalPreferences.plist"];  
NSDictionary *dict = [NSDictionary dictionaryWithContentsOfFile:path];  
CFShow(dict); 
```

# sharepoint - SharePoint，模拟后抛出异常

> ID：591433
> 
> 赞同：1
> 
> 时间：2009-02-26T16:56:27.910
> 
> 标签：sharepoint

我们正在模拟 SharePoint 用户并尝试访问列表项。

```
using (SPSite site = new SPSite(BAH.SN.Properties.Settings.Default.RootSiteUrl, new SPUserToken(currentUser.ImpersonationToken)))
        {
            using (SPWeb web = site.RootWeb)
            {
                SPList list = web.GetList(BAH.SN.Properties.Settings.Default.CommunitiesListPath);
                if (list != null)
                {
                    SPQuery query = CAMLHelper.GetSPQueryForCommunityListByOwner(user.UserName);
                    SPListItemCollection items = list.GetItems(query);
                    if (items != null && items.Count > 0)
                    {
                        // Read here
                    }
                }
            }
        } 
```

我们能够获得列表上的句柄，但是一旦我们尝试访问 SPListItemCollection“项目”的任何属性，我们就会得到一个 COM 异常：532459699。

我们正在运行 FBA，调用此代码的用户是匿名用户。

亲切的问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T22:22:07.987

您是否尝试过使用`ElevatedPrivileges`而不是令牌？

```
SPSecurity.RunWithElevatedPrivileges(delegate() { 
    //your code inside here, except use the SPSite ctor that only takes the url and get that frome SPContext:
    // new SPSite(SPContext.Current.Site.Url);
} 
```

还请提供完整的堆栈跟踪，以便为我们提供帮助您的最佳方式。如果您不知道如何启用它，请在[此处查看](http://blogs.importchaos.com/alonsorobles/2008/06/09/enabling-the-sharepoint-safe-mode-call-stack-disabling-custom-errors-and-enabling-compilation-debugging/)`web.config`有关该问题的众多博客文章之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-11T07:34:54.327

`SPSecurity.RunWithElevatedPrivileges`将在系统帐户中运行代码。那不会解决他/她的问题。

# asp.net - ScriptManager 的 EnablePartialRendering 属性到底有什么意义

> ID：591437
> 
> 赞同：6
> 
> 时间：2009-02-26T16:57:27.207
> 
> 标签：asp.net, ajax, scriptmanager

如果将 AJAX 功能构建到页面中，为什么希望 EnablePartialRendering 属性永远为“假”？似乎适得其反。我已经在这里和那里阅读了一些可能想要将属性设置为 false 的事情。但我读过的没有意义。

想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T17:02:39.160

我之前在测试中使用过该属性，以强制显示服务器端错误的完整“黄屏”。以这种方式调试快速的服务器端问题比检查事件日志中的错误或 XmlHttpRequest 的错误响应要容易得多。

此外，它不好的一件事*是*防止 MicrosoftAjax.js 被注入。我过去曾尝试过，希望可以单独使用 ScriptManager 的脚本组合。不幸的是，不，它仍然注入 MicrosoftAjax.js。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T17:03:40.873

Eilon Lipton在他的博客中[记录了这个问题](http://weblogs.asp.net/leftslipper/archive/2007/09/12/scriptmanager-s-enablepartialrendering-and-supportspartialrendering-properties.aspx)（以及 SupportsPartialRendering 属性）。值得注意的是：

> EnablePartialRendering 适用于页面开发人员。也就是说，构建 ASP.NET 页面并将 ScriptManager 放置在其上的人。他们可以决定是否对使用部分渲染功能感兴趣。例如，出于优化目的，他们可能会完全禁用部分渲染功能，以防止下载任何额外的脚本。或者也许是为了调试他们想要暂时禁用 UpdatePanels 进行异步回发的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-10T09:00:12.093

因为并非所有 Web 浏览器（通过一些严格的安全策略）都允许启用 ajax 的回发工作，所以在构建多个公司/公司可以使用的集中式应用程序时，更改此设置意味着该站点仍然可以在没有部分呈现的情况下工作，并且适用于公司/corporations 或其他支持完整 ajax 而无需构建站点的两个版本的用户。

我发现 EnablePartialRendering 非常有用，并且节省了数百小时需要构建站点的非 ajax 版本的时间，无论您多么讨厌或不同意，大型国际公司的安全经理的想法几乎没有改变避免更改策略，以便您的应用程序可以在其员工的 Internet 域上运行。

# html - 如何将不同的样式放在两个相同的元素上？

> ID：591438
> 
> 赞同：3
> 
> 时间：2009-02-26T16:57:37.237
> 
> 标签：html, css

我有这个

```
<p>
     <cite>One</cite><cite>Two</cite>
</p> 
```

css中有没有办法说第一个引用是粗体，第二个是斜体，**而不编辑上面的代码**？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T17:01:05.530

```
p > cite { font-weight: bold }
p > cite + cite { font-style: italic } 
```

但要注意它在 IE6 中不起作用。您可能想使用 jquery 在 ie6 中应用 css3 规则。还有一个脚本叫做[IE7](http://dean.edwards.name/IE7/)，但是有点慢。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-26T17:01:30.690

使用 CSS3，您应该能够使用以下样式完成此操作：

```
cite:nth-child(1) { font-weight: bold; }
cite:nth-child(2) { font-style: italic; } 
```

目前对 CSS3 的支持很差，因此请检查您决定支持的浏览器。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-26T17:00:56.543

您可以使用 :first-child 伪选择器，尽管它不是跨浏览器友好的。

```
p cite:first-child { font-weight: bold; font-style: normal; }
cite { font-style: italics; } 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-26T17:02:03.170

有一些方法可以使用 CSS，但它与 IE6 不兼容。只要你没问题，你可以这样做：

```
p cite {
    font-weight: bold; 
}

p cite + cite {
    font-style: italic; 
    font-weight: normal;
} 
```

这个工作的原因是因为'+'选择任何给定引用的兄弟。由于兄弟关系仅在 DOM 中前进，因此您只需选择第二个（或第 n 个，其中 n > 1）引用标记。

不幸的是 + 不适用于 IE6。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-20T20:45:13.377

```
p cite:first-child {
    font-weight: bold;
}
p cite:last-child {
    font-style: italic;
} 
```

# asp.net - 如何使用 javascript 抑制 IE7 ActiveX 消息？

> ID：591439
> 
> 赞同：2
> 
> 时间：2009-02-26T16:57:49.577
> 
> 标签：asp.net, javascript, jquery, ajax, activex

我正在尝试决定是使用自定义 ASP.Net Ajax Extender 还是 jQuery 来执行简单的 Web 服务调用。Web 服务方法接受客户 ID 并返回客户名称。我倾向于 jQuery，因为它很简单。唯一的问题是，由于我公司的 IE7 组策略设置，jQuery 第一次调用 Web 服务时会提示用户以下消息：

> 脚本正在访问此页面上的某些软件（ActiveX 控件），这些软件已被标记为可安全编写脚本。你想允许这个吗？

Extender 不会导致显示此消息。我假设 ASP.Net Ajax 库有一些 javascript voodoo 可以抑制它。所以我的问题是，**如何使用 javascript 禁止显示此消息？**

这是我的 aspx 标记：

```
<h1>
    Finder Test</h1>
<div>
    <h2>
        Extender</h2>
    Customer ID:
    <asp:TextBox ID="txtCustomerId" runat="server" MaxLength="9" Width="4em" />
    <belCommon:FinderExtender ID="extCustomerId" runat="server" TargetControlID="txtCustomerId"
        ResultLabelID="lblResult" ServicePath="~/Customer.asmx" ServiceMethod="Name" />
    <asp:Label ID="lblResult" runat="server" />
</div>
<div>
    <h2>
        jQuery</h2>
    Customer ID:
    <input id="txtCustomerId2" type="text" maxlength="9" style="width: 4em;" value="0000" />
    <span id="txtCustomerName2"></span>

    <script type="text/javascript">
        $(document).ready(function()
        {
            $("#txtCustomerId2").change(
            function()
            {
                updateCustomerDescription(this.value, "txtCustomerName2");
            }).change();
        });

        function updateCustomerDescription(id, descriptionControlId)
        {
            // if we don't have a value, then don't bother calling the web service
            if (id == null || id.length == 0)
            {
                $("#" + descriptionControlId).text("");
                return;
            }

            jsonAjax("customer.asmx/Name", "{'id':'" + id + "'}", true,
                function(result)
                {
                    var name = result.d == null ? "" : result.d;
                    $("#" + descriptionControlId).text(name);
                }, null);
        }

        function jsonAjax(url, data, async, onSuccess, onFailed)
        {
            $.ajax({
                async: async,
                type: "POST",
                url: url,
                data: data,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: onSuccess,
                error: onFailed
            });
        }
    </script>
</div> 
```

[更新]

我假设消息中引用的 ActiveX 控件是 XMLHttpRequest。我还假设 jQuery 和 ASP.Net Ajax 的内部都将它用于 IE7。

[更新]

区别似乎在于 ASP.Net Ajax 和 jQuery 如何构造 XMLHttpRequest 的实例。

ASP.Net Ajax（感谢@Jesse Dearing）：

```
 window.XMLHttpRequest = function window$XMLHttpRequest() {
 var progIDs = [ 'Msxml2.XMLHTTP.3.0', 'Msxml2.XMLHTTP' ];
 for (var i = 0, l = progIDs.length; i < l; i++) {
  try {
    return new ActiveXObject(progIDs[i]);
  }
  catch (ex) { }
  }
     return null;
  }
} 
```

jQuery 1.3.2：

```
// Create the request object; Microsoft failed to properly
// implement the XMLHttpRequest in IE7, so we use the ActiveXObject when it is available
// This function can be overriden by calling jQuery.ajaxSetup
xhr:function(){
    return window.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : new XMLHttpRequest();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T17:44:11.213

这对我来说听起来不对。如果有适当的安全策略，您应该不能用 javascript 覆盖它。

我会仔细检查这两个页面，看看它们是否真的访问同一个 ActiveX 控件。我假设这些页面来自同一主机（因此不存在不同 WinInet 信任区域的问题）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T19:06:31.407

我正在开发一个 ASP.NET AJAX 应用程序，因此我检查了它的源代码，并在 ASP.NET AJAX 代码中找到了它：

```
 window.XMLHttpRequest = function window$XMLHttpRequest() {
 var progIDs = [ 'Msxml2.XMLHTTP.3.0', 'Msxml2.XMLHTTP' ];
 for (var i = 0, l = progIDs.length; i < l; i++) {
  try {
    return new ActiveXObject(progIDs[i]);
  }
  catch (ex) { }
  }
     return null;
  }
} 
```

我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-26T20:14:24.830

我通过重写 jQuery 的 xhr 函数解决了这个问题：

```
function overrideJqueryXhr()
{
    $.ajaxSetup({
        xhr: function()
        {
            if (window.XMLHttpRequest)
            {
                return new XMLHttpRequest();
            }
            else
            {
                var progIDs = ['Msxml2.XMLHTTP.3.0', 'Msxml2.XMLHTTP', 'Microsoft.XMLHTTP'];

                for (var i = 0; i < progIDs.length; i++)
                {
                    try
                    {
                        var xmlHttp = new ActiveXObject(progIDs[i]);
                        return xmlHttp;
                    }
                    catch (ex)
                    {
                    }
                }

                return null;
            }
        }
    });
} 
```

该函数告诉 jQuery 为非 IE 浏览器创建 XMLHttpRequest 类的实例，然后以 MS Ajax 方式为 IE 创建一个 ActiveX 对象。它首先尝试最新版本 Msxml2.XMLHTTP.3.0，然后是 Msxml2.XMLHTTP，最后是 Microsoft.XMLHTTP。

# python - Python Win32 - 映射驱动器上的 DriveInfo

> ID：591443
> 
> 赞同：2
> 
> 时间：2009-02-26T17:00:07.030
> 
> 标签：python, winapi

有谁知道我如何确定映射网络驱动器的服务器和共享名称？

例如：

```
import win32file, win32api
for logDrive in win32api.GetLogicalDriveStrings().split("\x00"):
  if win32file.GetDriveType(logDrive) != win32file.DRIVE_REMOTE: continue
  # get server and share name here 
```

有一个方便的api调用吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T17:01:34.530

您必须调用 win32 API：[WNetGetUniversalName](http://msdn.microsoft.com/en-us/library/aa385474(VS.85).aspx)

# php - 如何在 PHP 中获取字符串的字节值？

> ID：591446
> 
> 赞同：31
> 
> 时间：2009-02-26T17:00:52.893
> 
> 标签：php, string, ascii, bytecode

假设我在 php 中有一个字符串，它会打印到这样的文本文件中：

nÖ§9q1Fª£

如何将它的字节码获取到我的文本文件而不是时髦的 ascii 字符？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-02-26T17:03:15.087

使用 ord 函数

[http://ca.php.net/ord](http://ca.php.net/ord)

例如。

```
<?php
$var = "nÖ§9q1Fª£ˆæÓ§Œ_»—Ló]j";

for($i = 0; $i < strlen($var); $i++)
{
   echo ord($var[$i])."<br/>";
}
?> 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-03-21T14:28:21.097

如果您希望将字符串作为整数代码数组获取，有一个很好的单行：

```
unpack('C*', $string) 
```

请注意，生成的数组是从 1 开始索引的，而不是从 0 开始！

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-18T10:26:07.883

如果您在谈论十六进制值，这应该适合您：

```
$value = unpack('H*', "Stack");
echo $value[1]; 
```

[参考](https://stackoverflow.com/questions/6382738/convert-string-to-binary-then-back-again-using-php)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-26T17:06:56.793

[`Ord()`](http://php.net/ord)使用 ASCII 字符集来解决问题。但是，如果您使用多字节字符串（如 UTF-8），那么您就不走运了，需要自己破解它。

# c - Unix 上的分段错误 - 可能的堆栈损坏

> ID：591457
> 
> 赞同：3
> 
> 时间：2009-02-26T17:02:39.813
> 
> 标签：c, debugging, stack, coredump, corrupt

我正在查看在 Unix 中运行的进程的核心。通常我可以解决问题并深入回溯以尝试识别内存问题。在这种情况下，我不确定如何进行。

首先，回溯只给出了 3 帧，我期望更多。对于那些帧，所有呈现的函数参数似乎完全无效。没有我所期望的。

一些指针参数与它们相关联 - 无法访问地址处的内存

这是否表明某种完整的堆栈损坏。我用 libumem 运行了这个过程，所有的缓冲区都被报告为干净的。

umem_status 也没有报告任何内容。

所以基本上我很难过。可能的原因是什么？我应该在代码中寻找什么，因为 libumem 似乎没有报告任何错误。

关于如何进一步调试的任何建议？我应该考虑 mdb 中的任何额外功能吗？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T17:13:32.113

堆栈损坏听起来确实有可能。一些事情要尝试：

*   尽可能打开所有编译器警告！
*   运行棉绒！
*   如果可能的话，尝试在 OpenBSD 上构建和测试你的程序，它内置了很多内存损坏检测。
*   如果可能，请使用 ProPolice、StackGuard 等工具。
*   如果您可以轻松地重现此问题，那么值得在调试器中进行尝试。尽可能缩小范围，然后逐步进行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T17:13:09.883

您可以查看使用[Valgrind](http://directory.fsf.org/project/valgrind/)或[ElectricFence](http://directory.fsf.org/project/ElectricFence/)是否会更早地为您中断。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T04:01:30.777

我确实遇到了类似的问题。GDB 的回溯没有帮助。Valgrind 来救我。

通过 Valgrind 运行您的应用程序。识别所有错误，如无效写入。分析这段代码，看看它们是否可以修复。

在我的情况下，我正在尝试一个无效的写入（有时可能会写入 NULL），它不是在那个实例上而是在其他地方显示它的效果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T17:27:04.110

libumem 不应该报告与电围栏相同的溢出吗？

在测试环境中无法轻松重现，但在 unix/solaris 下的商业环境中，核心发生了，但 libumem 没有显示出任何问题，

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T17:32:05.843

你的代码？当这种情况发生在我身上时，我总是会发现相同的东西：空指针。崩溃时看起来很可怕，但原因最终很简单。

# java - 你能混合使用 JVM 语言吗？即：Groovy & Clojure

> ID：591459
> 
> 赞同：12
> 
> 时间：2009-02-26T17:03:08.580
> 
> 标签：java, groovy, jvm, clojure, mixing

我知道你可以很容易地混合 groovy&java、clojure&java、whateverJvmLang&java。

这是否也意味着我也可以让 clojure 和 groovy 代码交互？如果我使用 Grails 或 jRoR，我也可以在那个环境中使用 clojure 吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-26T17:16:36.800

只要所讨论的语言实际上产生 Java 类（即：Java 平台已知的类，不一定用 Java 语言编写），那么是的：它们可以轻松地相互交互。

至少对于 Groovy，我知道编写可以从“普通”Java 代码中使用的类是完全可能的。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-26T18:29:16.597

Clojure 可以`gen-class`像任何其他代码一样通过 Java 编译为 .class 文件并从 Java 中使用；看[这里](http://clojure.org/compilation)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-27T04:38:08.723

还有一个关于如何[从 JRuby 调用 Clojure 代码](http://blog.rubyenrails.nl/articles/2008/12/12/calling-clojure-from-jruby)的示例。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-10-06T14:52:08.773

如前所述，Clojure 可以轻松地与 Java 交互。尽管您看到的许多示例都展示了如何从 REPL 执行此操作，但一旦您将 Clojure 或任何其他 JVM 语言编译为类或 jar 文件，就可以像任何其他类一样从 Java 调用它。

就我而言，困难（不大）是弄清楚如何`gen-class`正确使用。在[http://kenai.com/projects/binomialstats](http://kenai.com/projects/binomialstats)中有一小部分用 Clojure 编写的统计函数，说明了如何执行此操作。这个 Clojure 库被一个 Java 项目使用——signtest。（抱歉，由于我是新手，StackOverflow 不会让我发布多个链接。）

现在真正好的是如果某些 IDE 可以在同一个项目中处理不同的语言。例如，上面提到的两个项目作为两个单独的 NetBeans 项目进行维护。确保这两个部分始终同步可能需要一些额外的工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-07-28T00:47:12.687

如前所述，您可以通过预编译从 Groovy 访问 Clojure 类。

您也可以通过 Java 6 的脚本 API 访问最流行的*脚本*语言，尽管 Scala 和 Clojure 似乎并未得到官方支持。以下是来自 Groovy 的示例：

[http://groovy.codehaus.org/JSR-223+access+to+other+JVM+languages](http://groovy.codehaus.org/JSR-223+access+to+other+JVM+languages)

您还可以从 Groovy 访问 Clojure 的类，例如（对于 Groovy 1.7 快照）：

```
@Grab(group='org.clojure', module='clojure', version='1.0.0')
import clojure.lang.*

def ss = StringSeq.create('The quick brown fox')
def done = false
while (!done) {
  println ss.first()
  ss = ss.next()
  done = !ss
} 
```

或者通过创建一个新进程进行交互（同样适用于 Groovy 1.7 快照）：

```
@Grab(group='org.clojure', module='clojure', version='1.0.0')
import clojure.lang.Script

def src = new File('temp.clj')
src.text = '''
(defn factorial [n]
   (if (< n 2)
       1
       (* n (factorial (- n 1)))))
(println (factorial 4))
'''
def path = System.getProperty('user.home') + '/.groovy/grapes/org.clojure/clojure/jars/clojure-1.0.0.jar'
new AntBuilder().with {
    java(classname:Script.name, classpath:path) {
        arg(value:src.path)
    }
} 
```

还有一个用于 Grails 的 Clojure 插件，可以轻松访问从任何 Grails 工件（控制器、标记库、服务等）执行 clojure 代码：

http://grails.org/plugin/clojure

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-18T18:31:07.167

另一个有助于在 JVM 上混合语言的环境是**[WebSphere sMash](http://projectzero.org)**（又名零项目）。这包括：

*   一个用 Java 编写的 PHP 引擎，允许[PHP 代码与 Java 代码交互](http://www.projectzero.org/sMash/1.1.x/docs/zero.devguide.doc/zero.php/ZeroAdvancedPHPJavaBridge.html)。
*   一个 PHP/Groovy 桥，允许[PHP 和 Groovy 之间直接交互](http://www.projectzero.org/sMash/1.1.x/docs/zero.devguide.doc/zero.php/ZeroAdvancedPHPGroovyBridge.html)。

# java - 将 Excel 2003 XML 文件转换为 Excel 2003 XLS 格式

> ID：591463
> 
> 赞同：1
> 
> 时间：2009-02-26T17:03:50.060
> 
> 标签：java, xml, excel

有没有办法使用 Java 将 Excel 2003 XML 文件转换为 Excel 2003 XLS 格式？或者至少有任何开源框架可以做到这一点？

谢谢，马修黄

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T17:29:23.200

我之所以关注这个市场，是因为我的公司有一个适用于 .NET 的 Excel 兼容电子表格组件，而且我曾在 Actuate 工作并领导了 Java / e.Spreadsheet 的一级方程式开发工作 10 多年。我知道的唯一可能做到这一点的产品是 Aspose.Cells——它们是我在 .NET 中的竞争对手，所以我绝对不会通过提及它们来获得任何好处。

有许多用于 Java 和 .NET 的免费和非免费产品可以读取和写入 xlsx 和 xls 工作簿，其中一些产品可以在两者之间转换，包括我公司销售[的用于 .NET 的 SpreadsheetGear 。](http://www.spreadsheetgear.com/)Aspose 是我所知道的唯一一个支持 Excel 2003 SpreadsheetML 文件格式的软件（我不知道他们的 Excel 2003 SpreadsheetML 支持有多好）。

需要考虑的一件事是 Excel 2003 SpreadsheetML 格式是一种死胡同，而且它也是一种不完整的格式。[未来的首选格式是 Excel 2007 Open XML (xlsx) 格式，该格式已获得广泛支持，您可以在openxmldeveloper.org](http://openxmldeveloper.org/)了解该格式。当然，如果您有必须处理的旧格式的文件，那对您没有好处。

免责声明：我拥有 SpreadsheetGear LLC

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T17:08:29.753

如果你在 Windows 上，你可以使用 COM 自动化从你的 Java 应用程序中命令 excel。

# c - 如何从 OCI 调用 ORACLE 函数？

> ID：591467
> 
> 赞同：1
> 
> 时间：2009-02-26T17:05:24.677
> 
> 标签：c, oracle, oracle-call-interface

我可以在 C 程序中通过 OCI 调用 ORACLE 存储过程，方法是为命令构造 SQL 命令，这是我的代码中的一个简短片段：

```
 /* build sql statement calling stored procedure */
      strcpy ( sql_stmt, "call get_tab_info(:x)" );
      rc = OCIStmtPrepare(p_sql, p_err, sql_stmt,
          (ub4) strlen (sql_stmt), (ub4) OCI_NTV_SYNTAX, (ub4) OCI_DEFAULT); 
```

但是，我如何构造一个调用（在我的 C 程序中）具有以下签名的 ORACLE 函数：

```
 CREATE OR REPLACE FUNCTION get_seq_number (p_table_name IN VARCHAR2, p_seq_type IN VARCHAR2) 
      RETURN NUMBER IS 
```

要在 PL/SQL 中调用该函数，我将使用例如：

```
 v_seq := get_seq_number(v_tabname, v_seqtype); 
```

如何构造 SQL 字符数组 (sql_stmt) 以在我的 C 程序中调用 ORACLE 函数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T18:33:31.330

如下构造您的 SQL 语句

```
strcpy ( sql_stmt, "BEGIN :v_seq := get_seq_number(:v_tabname, :v_seqtype); END;" ); 
```

像以前一样准备你的陈述。按名称绑定变量（包括`v_seq`代码中之前的变量并执行语句。过程完成后，将正确设置 :v_seq 的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-26T17:15:35.493

你要么发出：

```
SELECT my_udf()
FROM dual 
```

并解析结果`SELECT query`，或调用匿名块：

```
BEGIN
   :test := my_udf();
END; 
```

, 并绑定`:test`为输出参数。

# .net - .NET 4.0 会增强 Entity Framework 多对多编码吗？

> ID：591475
> 
> 赞同：0
> 
> 时间：2009-02-26T17:06:45.187
> 
> 标签：.net, entity-framework

我正在使用 3.5 SP1 中的实体框架代码开发一个项目，但是尽管在大多数情况下一切都很好，但多对多表似乎需要大量的变通方法编码。有谁知道在下一个 .net 版本中事情是否会更容易？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T17:14:24.343

我认为，多对一，然后使用一对多。这完全是关于设计而不是对实体框架的多对多支持。

[http://thedatafarm.com/LearnEntityFramework/tutorials/many-to-many-relationships-in-the-entity-data-model/](http://thedatafarm.com/LearnEntityFramework/tutorials/many-to-many-relationships-in-the-entity-data-model/)

# max - 抗锯齿：确定最大频率的首选方法？

> ID：591476
> 
> 赞同：4
> 
> 时间：2009-02-26T17:06:54.657
> 
> 标签：max, frequency, antialiasing

我一直在阅读一些关于抗锯齿的文章，这似乎是有道理的，但有一件事我不太确定。您如何准确找到信号的最大频率（在图形的上下文中）。

我意识到有不止一种情况，所以我认为答案不止一种。但首先让我陈述一个我认为代表最大频率的简单算法，以便有人可以告诉我我是否以错误的方式概念化它。

假设它适用于一维、有限和灰度图像（以像素为单位）。我是否正确假设您可以简单地扫描整个像素线（在空间域中）以寻找最小振荡并且最小振荡的倒数将是最大频率？

防爆值 {23,26,28,22,48,49,51,49}

频率：关于设置 {}

(1/2) = .5 : {28,22}

(1/4) = .25 : {22,48,49,51}

那么0.5是最大频率吗？

对于与上述类似的像素线，计算此值的理想方法是什么？

从理论上讲，如果您的采样输入是无限的（更像现实世界）怎么办？一个有效的过程会是这样的：

```
Predetermine a decent interval for point sampling
Determine max frequency from point sampling
while(2*maxFrequency >  pointSamplingInterval)
{
pointSamplingInterval*=2
Redetermine maxFrequency from point sampling (with new interval)
} 
```

我知道这些算法效率低下，那么有哪些首选方法？（不是在寻找疯狂优化的东西，只是从根本上更好的概念）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T07:21:59.093

解决这个问题的正确方法是使用傅立叶变换（实际上是 FFT 或*快速傅立叶变换*）

该理论的工作原理如下：如果您有一组具有彩色/灰度的像素，那么我们可以说图像由“空间域”中的像素表示；也就是说，每个单独的数字都指定了特定空间位置的图像。

然而，我们真正想要的是图像在“频域”中的表示。不是每个单独的数字指定每个像素，而是每个数字代表整个图像中特定频率的幅度。

从“空间域”转换到“频域”的工具是傅里叶变换。FT 的输出将是一系列数字，指定不同频率的相对贡献。

为了找到最大频率，您执行 FT，并查看您获得的高频幅度 - 然后只需从最高频率向下搜索，直到您达到“最小有效幅度”阈值。

您可以编写自己的 FFT，但在实践中使用预打包的库（例如[FFTW ）要容易得多](http://en.wikipedia.org/wiki/FFTW)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-13T05:42:41.207

您不会扫描最高频率的信号，然后选择您的采样频率：您选择一个足够高的采样频率来捕获您想要捕获的东西，然后*过滤*信号以*去除*高频。*在采样之前*，您丢弃所有高于采样率一半的东西。

> 我是否正确假设您可以简单地扫描整个像素线（在空间域中）以寻找最小振荡并且最小振荡的倒数将是最大频率？

如果您有一行像素，则采样已经完成。应用抗锯齿过滤器为时已晚。可能出现的最高频率是采样频率的一半（我猜是“1/2px”）。

> 从理论上讲，如果您的采样输入是无限的（更像现实世界）怎么办？

是的，那是您使用过滤器的时候。首先，您有一个连续函数，例如真实图像（无限采样率）。然后过滤它以删除 fs/2 以上的所有内容，然后在 fs 处对其进行采样（将图像数字化为像素）。相机实际上并没有进行任何过滤，这就是为什么在拍摄砖块等时会出现[莫尔条纹的原因。](http://en.wikipedia.org/wiki/Moir%C3%A9_pattern)

![替代文字](https://upload.wikimedia.org/wikipedia/commons/f/fb/Moire_pattern_of_bricks_small.jpg)

如果您要对计算机图形进行抗锯齿处理，则必须首先考虑理想的连续数学函数，然后考虑如何对其进行过滤和数字化以在屏幕上产生输出。

例如，如果你想用计算机生成方波，你不能天真地在最大值和最小值之间交替。这就像在不先过滤的情况下对现实生活中的信号进行采样一样。高次谐波回绕到基带中，并在频谱中产生大量杂散尖峰。您需要生成点，就好像它们是从过滤的连续数学函数中采样的一样：

![替代文字](https://zone.ni.com/images/reference/en-XX/help/372416B-01/dsdsimuldataalisng.gif)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T01:35:29.193

我认为 O'Reilly 网站上的这篇文章也可能对您有用... [http://www.onlamp.com/pub/a/python/2001/01/31/numerically.html](http://www.onlamp.com/pub/a/python/2001/01/31/numerically.html) ...在那里他们'指的是声音文件的频率分析，但它给了你这个想法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T01:32:44.923

我认为您需要的是傅立叶分析的应用程序（[http://en.wikipedia.org/wiki/Fourier_analysis](http://en.wikipedia.org/wiki/Fourier_analysis)）。我研究过这个，但从未使用过，所以要加点盐，但我相信如果你正确地将它应用到你的一组数字上，你会得到一组频率，它们是系列的组成部分，然后你可以选择最高的一个。

我无法向您指出执行此操作的一段代码，但我确信它会在某个地方。

# emacs - 更好地控制 Emacs 窗口

> ID：591478
> 
> 赞同：9
> 
> 时间：2009-02-26T17:08:10.270
> 
> 标签：emacs, elisp, emacs23

我花了很多时间在 emacs 上，而且大部分时间都很棒。但是当我深入其中时，有一件事真的让我发疯，那就是控制在哪个窗口中打开各种新缓冲区。当我这样做时`find-file`，它总是在当前窗口中打开，这就是我喜欢的。但是很多其他模式喜欢为我拆分窗口、更改布局以及做其他各种让我烦恼的事情。例如，运行`M-x manual-entry`似乎没有关于它在何处打开联机帮助页的押韵或理由，并且各种`org-mode`命令做同样的事情，关闭我想保持打开的窗口等。我不喜欢每次我想看时都必须重做布局在我的`org`议程或打开手册页。

简而言之，是否有全局控制哪些窗口用于想要在当前窗口以外的窗口中打开的模式？我可以更轻松地指导他们吗？还是我必须破解每种模式才能按照我想要的方式行事？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T17:49:11.123

试试赢家模式：

[http://www.emacswiki.org/emacs/WinnerMode](http://www.emacswiki.org/emacs/WinnerMode)

它为窗口配置的更改提供撤消/重做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T17:31:50.040

这个问题也一直困扰着我。我发现了这个：

[http](http://www.gnu.org/software/emacs/elisp/html_node/Choosing-Window.html)

: //www.gnu.org/software/emacs/elisp/html_node/Choosing-Window.html 看起来你可以使用 (setf pop-up-frames t) 让东西出现在一个新的框架。

此外，看起来您可以使用 display-buffer-function 来覆盖显示功能（如何选择缓冲区。）当然，您必须擅长 elisp。

# javascript - 如何将消息（字符串）从 Win32 应用程序发送到在现有 IE 窗口中运行的 Javascript 程序？

> ID：591482
> 
> 赞同：1
> 
> 时间：2009-02-26T17:08:54.260
> 
> 标签：javascript, winapi

我有一个接收来电的系统托盘图标。当有电话进来时，我想将电话号码发送到一个网络应用程序中，该应用程序对该电话号码进行处理。我们可以使用查询字符串中的电话号码启动 Web 应用程序，但是如果我为每个呼叫启动一个新窗口，它会用大量浏览器实例将用户的计算机搞得一团糟，不会保留用户移动的位置/大小浏览器窗口，并且比仅仅刷新页面需要更长的时间。相反，我想让 Win32 应用程序重新使用相同的 IE 浏览器窗口，并在每次有新呼叫时向 Web 应用程序发送新电话号码。我设想以某种方式发送 Windows 消息，或者以某种方式指示 IE 浏览器使用一些数据运行某个 javascript 事件？我可以明白为什么做相反的事情（javascript 输出到 Win32）会是一个安全问题，但这只是从 Win32 向 javascript 发送一条消息。

所以我特别不问如何做这个问题中已经回答的事情： [How to Interact Between Web App and Windows Form Application](https://stackoverflow.com/questions/126048/how-to-interact-between-web-app-and-windows-form-application)

该用户询问如何从 Javascript 启动 Win32 应用程序并将数据传递给 win32 应用程序。粗略地说，我需要做相反的事情。我需要将数据从 Win32 应用程序发送到正在运行的 javascript 程序中。

另请注意，我不是在问如何一次启动一个带有 Javascript 参数的 IE 窗口。我可以使用查询字符串轻松做到这一点。我要问的是我如何/是否可以将数据从浏览器外部正在运行的 Win32 应用程序传递到浏览器窗口内正在运行的 Javascript 应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-26T17:18:49.417

您应该能够找到 IE 窗口的句柄，然后向它发送消息（可能是按键）。使用一点 javascript 来捕获所有按键活动，您就有了一个非常简单的方法来传输信息。

这并不容易（魔鬼在细节中 - 焦点问题等）但它应该是可能的。

-亚当

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-26T17:32:00.947

由于您可以通过查询字符串将电话号码发送到站点，因此您真正需要做的就是告诉 IE 导航到您选择的 URL。

为此，您可以使用此知识库文章中的内容来帮助您找到要连接的 IE 实例。

[http://support.microsoft.com/kb/299356/de](http://support.microsoft.com/kb/299356/de)

当然，它在 Visual J++ 中的所有内容，但由于您通过 COM 自动化进行交互，因此调用应该很容易翻译。

一旦有了 IE 实例（以 IWebBrowser2 接口实现的形式），您就可以简单地使用所需的 URL 调用 Navigate 或 Navigate2 方法（当然，在查询字符串中使用电话号码）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T17:32:54.627

您需要的是一种[如何连接到 Internet Explorer 正在运行的实例的方法](http://support.microsoft.com/kb/299356) （注意：这是在 Java 中，但您应该能够很容易地将其转换为 C#）。

或者您可以枚举顶级窗口以查找特定的 IE 实例，然后[从 HWND 获取 IHTMLDocument2](http://support.microsoft.com/kb/249232)（这是 C++ 中的，因此您可能需要执行一些 Win32 互操作；您可以在[PInvoke.net](http://pinvoke.net)上找到所有必要的声明）。

如果您在友好的本地搜索引擎上搜索**如何连接到正在运行的 Internet Explorer 实例**，您会发现更多信息。

进入文档后，您可以通过文档脚本接口调用 JavaScript 函数，也可以将其导航到您的页面并将电话号码作为参数传递。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-26T17:39:43.627

您可以通过在 Web 服务器上使用 Web 服务来解决此方法的安全性和其他问题，并让 win32 应用程序更新 Web 服务并让网页每隔几秒轮询相同的 Web 服务。然后，您可以选择将该号码映射到数据库并获取其他信息。

唯一的缺点是，浏览器中显示的信息不是即时的，而是有延迟的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-26T18:38:45.870

您如何编写一个使用 Javascript 在浏览器中创建的 active-x 控件。这实际上是一个 Explorer 浏览器插件。Mozilla 等的想法相同，只是它们使用不同的插件结构。这使您可以在将来支持其他浏览器。

该控件可以使用管道或套接字或任何类型的进程间通信与您的 win32 应用程序通信，然后可以作为 Javascript 对象访问。

# blackberry - BlackBerry CLDC 编程的最佳资源是什么？

> ID：591485
> 
> 赞同：0
> 
> 时间：2009-02-26T17:10:08.097
> 
> 标签：blackberry, user-interface, cldc

我在 Blackberry 上部署了许多 midlet，但现在我想尝试他们的 CLDC 模型。永远不要处理它。什么是快速入门的最佳阅读资源（BB 示例除外？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-03T23:26:56.930

这个网站有很多关于如何构建一个真实的黑莓应用程序的文章

[如何构建真实的 BlackBerry 应用程序](http://www.miamicoder.com/post/2008/04/How-To-Build-a-Real-World-BlackBerry-Application.aspx)

虽然不是快速阅读，但这两种形式对我有很大帮助：

[黑莓支持论坛](http://supportforums.blackberry.com/rim/?category.id=BlackBerryDevelopment)

[黑莓论坛](http://www.blackberryforums.com/developer-forum/)

以下是我发现有用的其他一些资源：

[Blackberry Java 开发环境 (JDE) 入门](http://devsushi.com/2007/11/15/getting-started-with-the-blackberry-java-development-environment-jde/)

[为 BlackBerry 开发应用程序](https://web.archive.org/web/1/http://articles.techrepublic%2ecom%2ecom/5100-10878_11-5265422.html)

[jonathanhfisher 的博客](http://www.jonathanhfisher.co.uk/b2/?cat=2)

# matlab - 如何在 MATLAB 中预分配非数字向量？

> ID：591495
> 
> 赞同：5
> 
> 时间：2009-02-26T17:13:09.883
> 
> 标签：matlab, matlab-struct, pre-allocation

我经常发现自己在做这样的事情：

```
unprocessedData = fetchData();  % returns a vector of structs or objects
processedData = [];             % will be full of structs or objects

for dataIdx = 1 : length(unprocessedData) 
    processedDatum = process(unprocessedData(dataIdx));
    processedData = [processedData; processedDatum];
end 
```

哪个，虽然功能，不是最佳的 -`processedData`向量在循环内增长。甚至`mlint`警告我，我应该考虑预先分配速度。

如果数据是 的向量`int8`，我可以这样做：

```
% preallocate processed data array to prevent growth in loop
processedData = zeros(length(unprocessedData), 1, 'int8'); 
```

并修改循环以填充向量槽而不是连接。

**有没有办法预先分配一个向量，以便它可以随后保存结构或对象？**

* * *

**更新：**受[Azim 回答的](https://stackoverflow.com/questions/591495/matlab-preallocate-a-non-numeric-vector/591569#591569)启发，我只是颠倒了循环顺序。正如调试器确认的那样，首先处理最后一个元素会强制在第一次命中时预分配整个向量：

```
unprocessedData = fetchData();

% note that processedData isn't declared outside the loop - this breaks 
% it if it'll later hold non-numeric data. Instead we exploit matlab's 
% odd scope rules which mean that processedData will outlive the loop
% inside which it is first referenced: 

for dataIdx = length(unprocessedData) : -1 : 1 
    processedData(dataIdx) = process(unprocessedData(dataIdx));
end 
```

**这要求由 MATLAB 返回的任何对象`process()`都具有有效的零参数构造函数**`processedData`，因为 MATLAB在第一次使用真实对象写入它时进行初始化。

`mlint`仍然抱怨可能的数组增长，但我认为那是因为它无法识别反向循环迭代......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-26T18:18:38.027

除了[Azim 的回答](https://stackoverflow.com/a/591569/52738)之外，另一种方法是使用[`repmat`](https://www.mathworks.com/help/matlab/ref/repmat.html)：

```
% Make a single structure element:
processedData = struct('field1',[],'field2',[]);
% Make an object:
processedData = object_constructor(...);
% Replicate data:
processedData = repmat(processedData,1,nElements); 
```

其中`nElements`是结构或对象数组中的元素数量。

注意：如果您正在制作的对象是从[句柄类](https://www.mathworks.com/help/matlab/handle-classes.html)派生的，您将不会复制对象本身，只需处理对它的引用。根据您的实现，您可能需要`nElements`多次调用对象构造函数方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-26T17:33:12.923

由于您知道结构的字段`processedData`并且知道它的长度，因此一种方法如下：

```
unprocessedData = fetchData();
processedData = struct('field1', [], ...
                       'field2', []) % create the processed data struct
processedData(length(unprocessedData)) = processedData(1); % create an array with the required length
for dataIdx = 1:length(unprocessedData)
    processedData(dataIdx) = process(unprocessedData(dataIdx));
end 
```

这假定该`process`函数返回一个与 具有相同字段的结构`processedData`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-02T16:37:56.050

您可以传入`struct`适当大小的元胞数组：

```
processedData = struct('field1', cell(nElements, 1), 'field2', []); 
```

这将创建一个与元胞数组大小相同的结构体数组。

# terminal - 将文件夹从桌面移动到服务器？

> ID：591498
> 
> 赞同：9
> 
> 时间：2009-02-26T17:14:16.153
> 
> 标签：terminal, cp

我的桌面上有一个文件夹。我想将它复制到终端中的服务器。

我试过这个不成功

```
[~/bin]# cp -r /Users/Sam/Desktop/tig-0.14.1 ~/bin/
cp: cannot stat `/Users/Sam/Desktop/tig-0.14.1': No such file or directory 
```

**[编辑]**

我在我的服务器中运行该命令。问题似乎在于“/Users/Sam/Desktop/tig-0.14.1”是我的 Mac 中的一个文件夹，而不是我的服务器中的一个文件夹。

也许，我不能简单地将文件夹移动到我的服务器，因为我的服务器不知道我的文件夹在哪里。

我一直通过 GUI 移动文件夹。只是在终端也有可能吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-26T17:45:52.660

从服务器：

```
scp -r username@A.B.C.D:~/Desktop/tig-0.14.1/ ~/bin/ 
```

用户名是您在本地 Mac 上的简称。ABCD 是服务器看到的本地 mac 的 IP 地址。系统将提示您输入密码。

或者，如果您想从本地客户端推送：

```
scp -r ~/Desktop/tig-0.14.1/ serveruser@W.X.Y.Z:~/bin/ 
```

serveruser 是要复制到其 ~/bin 的服务器上的用户。WXYZ 是您的客户端看到的服务器的 IP 地址。系统将提示您输入服务器用户的密码。

scp 是 ssh 的一部分。有关更多信息，请参阅“man scp”（来自终端）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-26T17:46:01.333

从您的 Mac（不是服务器）：

```
# scp -r ~/Desktop/tig-0.14.1 myUsername@myServerName:~/bin 
```

replace `myUsername` and `myServerName` appropriately.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T17:44:03.600

cp 不是正确的命令。改用 scp ；它有类似的用途，您可以像这样使用它：（请参阅手册以供参考）

来自 linux 客户端：scp user1@host1://Users/Sam/Desktop/tig-0.14.1 ~/bin/

如果您使用 Windows 客户端，您可以使用 winscp 以“拖放”样式执行此操作

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-26T17:45:24.643

> `cp: cannot stat`/Users/Sam/Desktop/tig-0.14.1'：没有这样的文件或目录`

这就是问题所在，好吧：您尝试复制的文件不在您想的地方，或者没有命名您键入的内容。正如评论中所建议的那样，您可以尝试在提示符下使用制表符完成以确保一切正确：

```
# cp /Users/Sam/Desk<TAB>
# cp /Users/Sam/Desktop/tig<TAB>
# cp /Users/Sam/Desktop/tig-0.14.1.tar.gz 
```

请注意，tig-0.14.1.tar.gz 可能是实际的文件名，如在野外发现的那样......

# ruby-on-rails - 我有一个 Rails 任务：我应该使用 script/runner 还是 rake？

> ID：591503
> 
> 赞同：71
> 
> 时间：2009-02-26T17:16:07.007
> 
> 标签：ruby-on-rails, ruby, rake

对于*特定*的 Rails 任务，我们有一些实现替代方案，其中主要的似乎是：

```
script/runner some_useful_thing 
```

和：

```
rake some:other_useful_thing 
```

我应该更喜欢哪个选项？如果有一个明确的最爱，那么我应该在什么时候（如果有的话）考虑使用另一个？如果从来没有，那么您为什么认为它仍然存在于框架中而没有弃用警告？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-02-26T18:49:07.127

它们之间的区别在于`script/runner`启动 Rails 而 Rake 任务不会，除非您通过使任务依赖来告诉它`:environment`，如下所示：

```
task :some_useful_task => :environment do
  # do some useful task
end 
```

由于引导 Rails 的成本很高，如果可以避免的话，可能值得跳过。

除此之外，它们大致相等。我两者都使用，但最近我`script/runner`更多地使用单独执行脚本。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-10T19:01:28.410

FWIW 似乎有一些[远离使用脚本运行器](http://www.icyte.com/system/snapshots/fs1/6/2/8/d/628ddf1f6b7a231ddf6d0c9f0dc7e38dc7834e06/index.html)来支持 rake 的运动：

> 更新（2009 年 4 月 25 日）：我建议使用 rake 任务而不是脚本/运行程序来执行重复任务。

此外，[根据这篇文章](http://www.railsenvy.com/2007/6/11/ruby-on-rails-rake-tutorial#rails_models)，您可以将 rake 用于重复性任务就好了：

> 如果我希望它每晚在午夜在我的生产数据库上运行，我可能会编写一个看起来像这样的 cronjob：
> 
> > 0 0 * * * cd /var/www/apps/rails_app/ && /usr/local/bin/rake RAILS_ENV=production utils:send_expire_soon_emails

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-12-15T00:58:07.220

至少可以说，将参数传递给 rake 任务是一件让人头疼的事情。您要么需要使用环境变量，要么需要使用不直观且有很多警告的非常老套的参数系统。

如果您的任务需要优雅地处理命令行参数，那么编写脚本是您的最佳选择。

Luke Francl 提到了启动 Rails 的脚本/运行程序。确实如此。但是，如果您不想启动 rails，那么只需按原样运行脚本，无需脚本/运行器。因此，脚本和 rake 任务之间唯一真正的区别是它们的美学。选择任何你觉得合适的东西。

我将 rake 任务用于小任务（一两行）。任何更复杂的东西都进入 script/ 目录。如果我认为其他开发人员会期望代码位于一个地方而不是另一个地方，我将打破这条规则。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2010-12-29T22:13:22.330

根据评论 2 更正。给他们业力！

FWIW - Rails 3.0+ 改变了您在独立脚本中初始化 Rails 系统的方式。

```
require File.dirname(__FILE__) + '/config/environment' 
```

如上所述，您还可以执行以下操作：

```
rails runner script/<script name> 
```

或者将所有代码放在 Rake 任务中，但我有很多来自 Rails 2 的遗留代码；所以我不想立即走这条路。

每个都有其优点和缺点。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-02-26T19:35:44.643

我所做的一件事就是编写普通的 ruby​​ 脚本并将它们放在`script/maintenance`目录中。

加载rails和访问所有模型等所需要做的一切都放在`require '../../config/environment.rb'`文件的顶部，然后你就走了。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-26T17:36:33.743

对于一次性命令脚本/运行程序可以很好。对于重复的任何内容，从长远来看，rake 任务更容易，并且如果您忘记了它的作用，它会有一个摘要。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2010-12-31T17:44:30.000

在 Rails 3.0+ 中，`config/environment.rb`需要`config/application.rb`， 需要`config/boot.rb`.

因此，要在 Rails 3 中加载应用程序，您仍然只需要要求`environment.rb`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-26T18:03:38.310

我得到的印象脚本/运行器主要用于定期任务。例如，一个运行的 cron 作业：

```
SomeClass.update_from_web('http://www.sourcefordata.gov/') 
```

# documentation - 有没有任何方法可以在没有 Web 服务器的情况下提供基于服务器的帮助？

> ID：591507
> 
> 赞同：0
> 
> 时间：2009-02-26T17:17:32.557
> 
> 标签：documentation

我们希望为客户端/服务器系统提供帮助。在当前版本的系统中，这是通过传统的 HTML 帮助在客户端完成的（即每台客户端机器上都有很多 .chm 文件）。出于各种原因（例如，允许快速/轻松地更新帮助），我们希望将帮助内容（即实际的主题文件）移动到服务器上。

与帮助相关的客户端桌面应用程序已经连接到服务器，所以看起来我们应该能够让客户端帮助查看器执行类似的操作 - 即将其主题文件从服务器中拉出。

但是，如果已经有一些东西可以做到这一点，我们不想重新发明轮子并编码一些东西。

显而易见的解决方案是使用 WebHelp，但要求我们的客户运行 Web 服务器存在一些阻力。并且托管自己，或通过第 3 方，不是一种选择。

那么有没有人知道在内容驻留在服务器上的地方提供帮助的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T17:28:14.200

你正在运行什么样的服务器？您是否有任何理由无法在服务器产品中托管 Web 服务器，可能位于“通常未使用”的端口上？如果您自己捆绑 Web 服务器，则无需要求客户安装和管理 Web 服务器。

这是在什么平台上，顺便说一句？

编辑：正如大卫在评论中所建议的，有一个[关于嵌入轻量级网络服务器的相关问题](https://stackoverflow.com/questions/516028/small-php-capable-web-server-for-windows)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-09T06:30:36.577

您应该可以轻松做到这一点。我构建了一个 CHM 到 Web 的转换器，它在 CHM 中啜饮并吐出一个网站。这是由转换器工具生成
[的示例网站。](http://cheeso.members.winisp.net/DotNetZipHelp)

通过 Sandcastle Helpfile Builder 创建 CHM 需要很长时间，但从 CHM 到 Web 的转换大约需要 6 秒。它是完全自动化的。

您可以利用这种魔力并对其进行调整以适合您的富客户端应用程序。客户端可以向服务器查询索引或主题列表，然后按需从服务器检索用户所需的帮助内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-26T17:30:05.537

也许我弄错了，但是如果这一切都驻留在 Intranet 上，那么也许您可以使用在所有客户端计算机之间共享的映射网络驱动器，例如 H:/（您可以将其作为他们的一部分登录脚本）。然后，您可以使用文件链接访问 HTML 页面，例如 file:///H:/help_folder/index.html

如果您的应用程序的其余部分是通过网络交付的，那么您将不得不使用网络服务器。有非常便宜和简单的网络托管可用。

# mfc - 用户界面：切换 MDI 框架顶部状态的最佳方式？

> ID：591508
> 
> 赞同：1
> 
> 时间：2009-02-26T17:17:58.110
> 
> 标签：mfc, user-interface, visual-c++-6, mdi, always-on-top

我维护一个使用 Frame Windows 作为文档视图的 MFC (VC6) MDI 应用程序。一次只有一个文档，但有多个 MDI 框架，每个框架都有不同的文档数据视图。

最近出现了一个请求，即能够将这些框架窗口中的一个保持在其他框架窗口之上，同时能够与背景窗口进行交互。

*   一个想法是在框架的标题栏中添加一个“固定按钮”。在我的研究中，我发现每个实现都使用位图而不是例如 CButton 对象。一旦使用默认灰色以外的窗口颜色，更不用说 UI 主题，这就会开始变得难看。

*   框架窗口菜单中的一个选项（左键单击标题栏中的窗口图标时出现的东西）是可能的，但我正在寻找对用户更明显的东西。

设置此框架窗口的顶部状态还有哪些其他可能性？

### 更新

我决定[采用 Uli 建议的解决方案，](http://www.codeguru.com/cpp/controls/buttonctrl/bitmapbuttons/article.php/c8211%5F%5F1/)因为该解决方案适用于 XP 主题。不幸的是，这直接引出了我的下一个问题：**[我怎样才能真正让框架窗口保持在顶部？](https://stackoverflow.com/questions/594375/how-to-make-an-mdi-frame-stay-on-top)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T17:22:50.420

也许[这个](http://www.codeguru.com/cpp/w-d/dislog/titlebar/article.php/c1897)或[这个](http://www.codeguru.com/cpp/controls/buttonctrl/bitmapbuttons/article.php/c8211__1/)有帮助。

乌里

# c# - 将存储过程调用从 LINQ 数据上下文传递到另一个方法。C＃

> ID：591514
> 
> 赞同：2
> 
> 时间：2009-02-26T17:20:17.200
> 
> 标签：c#, .net, linq-to-sql, datacontext

我觉得这个问题的答案可能在于代表，但我很难理解代表的概念。主要问题是我读过的每一个代表的解释和例子总是围绕着做一些你可以在没有代表的情况下完成的事情的方法，所以对我来说它没有教给我任何东西。通过查看现实世界的例子，我学得最好。

既然这已经过去了，这就是我想要完成的事情。我有一个包含许多存储过程的数据上下文 (.dbml)。我也有多种情况，我使用完全相同的 20 行代码来更新表中的一列，但除了使用不同的数据网格之外，唯一的区别是调用了存储过程。为了减少使用的代码量，我希望有一种方法可以将数据上下文对象中的存储过程调用作为参数传递。这样我就可以将所有代码移动到一个可重用的函数中。这甚至可能吗？我正在使用 Visual Studio 2008 和 C#。

感谢您的任何指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-26T20:17:39.533

虽然我无法在 sql/stored proc 方面为您提供帮助，但我可以*尝试*解释委托，至少从 C# 的角度来看是这样。

虽然通常您将函数声明为类的一部分（因此它们与类密切相关），但有时您希望将它们放入变量中。一旦你这样做了，你就可以传递它，就像你传递任何其他变量一样。

所以我们知道字符串是一种可以将文本粘贴到其中的变量。*之后，委托是您将函数*粘贴到其中的那种变量。然而，这非常令人困惑，因为 C# 与它在代码中命名事物的方式不一致或不清楚。观察：

```
public void WriteText() {
  Console.WriteLine("Hello");
}

...
Action x = WriteText;
x(); // will invoke the WriteText function 
```

请注意，我们使用“Action”，其中逻辑意味着代码应该读取`delegate x = WriteText`。我们需要这种额外混乱的原因是因为“委托”本身就像`System.Object`. 它不包含任何信息，它是一切背后的“基类”。如果我们真的想使用一个，我们必须附加一些类型信息。这就是`Action`进来的地方。定义`Action`如下：

```
public delegate void Action(); 
```

这段代码的意思是“我们正在声明一个名为 Action 的新委托，*它不接受任何参数并返回 void* ”。此后，如果您有任何不带参数并返回 void 的函数，则将它们放入 type 的变量中`Action`。

现在，您可以将普通函数粘贴到委托中，但您也可以将“匿名”函数粘贴到委托中。“匿名”函数是您在内联声明的东西，因此`WriteText`我们可以在代码中间构建一个新函数，而不是附加已经声明的函数，如下所示：

```
Action x = () => { Console.WriteLine("Hello"); };
x(); // invoke our anonymous function. 
```

这样做是使用 C#“lambda 语法”来声明一个新的匿名函数。作为函数的一部分运行的代码（当我们调用它时）是`Console.WriteLine`.

所以

总而言之，您可以拥有一个“SaveData”函数，并将其传递给一个委托。它可以完成 20 行表构建，然后将该表传递给委托，委托可以调用适当的存储过程。这是一个简单的例子：

```
public void SaveData(Action<Table> saveFunc){
    var t = new Table();
    ... 20 lines of code which put stuff into t ...
    saveFunc(t);
}

SaveData( t => StoredProc1.Invoke(t) ); // save using StoredProc1
SaveData( t => StoredProc37.Invoke(t) ); // save using StoredProc37 
```

所以

说了这么多。这不是我实际解决问题的方式。与其将委托传递给您的 savedata 函数，不如让您的 SaveData 函数简单地*返回*表，然后您可以调用适当的 StoredProc 而不需要委托

# php - 简单的正则表达式 PHP

> ID：591516
> 
> 赞同：3
> 
> 时间：2009-02-26T17:20:54.590
> 
> 标签：php, regex

由于我对正则表达式完全没用，而且过去半小时一直困扰着我，我想我会在这里发布它，因为它可能很简单。

```
<a href="/folder/files/hey/">hey.exe</a>
<a href="/folder/files/hey2/">hey2.dll</a>
<a href="/folder/files/pomp/">pomp.jpg</a> 
```

在 PHP 中，我需要提取`<a>`标签示例之间的内容：

```
hey.exe
hey2.dll
pomp.jpg 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T17:44:27.327

避免使用 '.*' 即使你让它变得不贪心，直到你对 RegEx 有更多的练习。我认为对您来说一个好的解决方案是：

```
'/<a[^>]+>([^<]+)<\/a>/i' 
```

注意 '/' 分隔符 - 您必须在 PHP 中使用 preg 正则表达式函数套件。它看起来像这样：

```
preg_match_all($pattern, $string, $matches);
// matches get stored in '$matches' variable as an array
// matches in between the <a></a> tags will be in $matches[1]
print_r($matches); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-26T17:23:44.303

`<a href="[^"]*">([^<]*)</a>`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-26T17:25:22.520

我发现[这个正则表达式测试器](http://www.iowacomputergurus.com/free-products/regular-expression-tester.aspx)很有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-26T17:27:27.167

这是一个非常简单的：

```
<a.*>(.*)</a> 
```

但是，如果您在同一行中有多个匹配项，则应小心，例如

```
<a href="/folder/hey">hey.exe</a><a href="/folder/hey2/">hey2.dll</a> 
```

在这种情况下，正确的正则表达式是：

```
<a.*?>(.*?)</a> 
```

注意“？” 在“*”量词之后。默认情况下，量词是贪婪的，这意味着它们会吃掉尽可能多的字符（这意味着在本例中它们只会返回“hey2.dll”）。通过附加引号，您可以使它们变得不贪婪，这应该更好地满足您的需求。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-26T17:30:34.083

这似乎有效：

```
$pattern = '/<a.*?>(.*?)<\/a>/'; 
```

# sql - 如何查看 HSQLDB 数据库中的所有表？

> ID：591518
> 
> 赞同：40
> 
> 时间：2009-02-26T17:21:32.547
> 
> 标签：sql, hsqldb

我通常使用 SQLDeveloper 来浏览数据库，但我无法使其与 HSQLDB 一起使用，而且我不知道已经创建了哪些表……我想这是一个特定于供应商的问题，而不是普通的 SQL，但重点是：如何我可以查看表格以便删除/更改它们吗？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-02-26T17:27:22.440

用于查询数据库元数据的 ANSI SQL92 标准包含在`INFORMATION_SCHEMA`数据结构中。

我不知道您的数据库是否支持此功能，但请尝试以下操作：

```
SELECT *
FROM   INFORMATION_SCHEMA.TABLES 
```

在进一步的研究中，HSQLDB 似乎确实支持`INFORMATION_SCHEMA`，但命名略有不标准。

所有表格都已`SYSTEM_*`添加到它们之前，因此上面的示例将显示为

```
SELECT *
FROM   INFORMATION_SCHEMA.SYSTEM_TABLES 
```

我无法对此进行测试，答案是在[sourceforge](http://sourceforge.net/forum/message.php?msg_id=5978227)上找到的。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-07-12T10:11:36.767

很好，谢谢！一直在网上搜索该信息。这将只获取您的表的字段信息：

```
SELECT TABLE_NAME, COLUMN_NAME, TYPE_NAME, COLUMN_SIZE, DECIMAL_DIGITS, IS_NULLABLE FROM INFORMATION_SCHEMA.SYSTEM_COLUMNS WHERE TABLE_NAME NOT LIKE 'SYSTEM_%' 
```

您可以从`INFORMATION_SCHEMA.SYSTEM_TABLES`. 一定要喜欢 oo 文档：p

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-10-28T22:27:51.280

如果您在命令行上，您可能想尝试在[SqlTool 手册](http://hsqldb.org/doc/2.0/util-guide/sqltool-chapt.html)(hsqldb.org) 中记录的 Hsqldb SqlTool。

*   将您的数据库连接信息放在“ `~/sqltool.rc`”中并选择您想要的任何 DBNAME，替换正确的用户名和密码（如果知道）。
    *   `urlid DBNAME`
    *   `url jdbc:hsqldb:/path/to/hsql/database`
    *   用户名 SA
    *   密码
*   安装工具：（`apt-get install hsqldb-utils`在 Ubuntu 上）
*   `hsqldb-sqltool DBNAME`在 Ubuntu 上使用 # 连接
*   其他系统的提示：`java -jar YourHsqlJar.jar DBNAME`
*   显示表格：`\dt`
*   显示列：\d TABLENAME
*   标准查询，例如：`SELECT * FROM …;`
*   编辑（附加）最后一个命令：`:a`
*   退出：`\q`
*   使用以下命令查看特殊命令：`\?`或`:?`

祝你好运！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-12-24T15:05:21.253

当您在 HSQLDB 的命令行中`\dt`点击提示符时使用该命令。`>sql`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-26T17:43:34.770

查看[DBVisualiser](http://www.minq.se/products/dbvis/)和[SQuirreL SQL 客户端](http://squirrel-sql.sourceforge.net/)。这两者都支持 HSQLDB，以及用于编辑/修改/查看表的 GUI。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-02T04:30:08.180

您使用 运行查询`hsql database manager`，是吗？如果你使用它，下面可能会给出一些提示：

选择您的连接：

1.  类型：`HSQL DATABASE ENGINE SERVER`
2.  司机：`jdbc.hsqldb.jdbcDriver`
3.  网址：`jdbc:hsqldb:hsql://localhost/`

然后，您将浏览数据库。

# cpython - 完成后如何以编程方式告诉 CPython 解释器进入交互模式？

> ID：591520
> 
> 赞同：8
> 
> 时间：2009-02-26T17:21:57.443
> 
> 标签：cpython, python

如果您使用 -i 选项调用 cpython 解释器，它将在完成任何命令或脚本运行后进入交互模式。有没有办法在程序中让解释器即使没有给出 -i 也能做到这一点？明显的用例是在发生异常情况时通过交互检查状态进行调试。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-26T17:25:18.420

你想要[代码模块](http://docs.python.org/library/code.html)。

```
#!/usr/bin/env python

import code    
code.interact("Enter Here") 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-26T19:06:18.520

设置 PYTHONINSPECT 环境变量。这也可以在脚本本身中完成：

```
import os
os.environ["PYTHONINSPECT"] = "1" 
```

对于调试意外异常，您还可以使用这个不错的配方[http://code.activestate.com/recipes/65287/](http://code.activestate.com/recipes/65287/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T23:49:05.157

在另一个答案中提到的[食谱](http://code.activestate.com/recipes/65287/)`sys.excepthook`使用, 听起来像你想要的。否则，您可以`code.interact`在程序退出时运行：

```
import code
import sys
sys.exitfunc = code.interact 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-01T08:48:04.023

我所知道的最好的方法是：

```
from IPython import embed
embed() 
```

它允许访问当前范围内的变量，并为您带来 IPython 的全部功能。

# scripting - 什么时候使用像 Lua 这样的嵌入式脚本语言比较好

> ID：591523
> 
> 赞同：6
> 
> 时间：2009-02-26T17:22:52.323
> 
> 标签：scripting, lua

我玩了大约 2 年的魔兽世界，我对用于编写插件的 Lua 非常好奇。由于到目前为止我所读到的关于 Lua 的内容是“快速”、“轻便”和“这很棒”，我想知道如何以及何时使用它。

您需要在系统中嵌入像 Lua 这样的脚本语言的典型情况是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-26T17:27:36.633

当您需要最终用户能够定义/更改系统而不需要重写系统时。它在游戏中用于允许扩展或允许主游戏引擎保持不变，同时允许更改内容。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-26T17:32:37.420

嵌入式脚本语言也适用于存储配置信息。最后我检查了一下，Mozilla 家族都使用 JavaScript 作为他们的配置信息。

接下来，它们非常适合开发插件。您可以创建自定义 API 以向插件开发人员公开，并且插件开发人员可以从使用完整的语言中获得很大的自由。

另一个是平面文件不够表达。如果你想编写行为参数化的数据驱动应用程序，你会厌倦对配置组合进行长串条件测试。发生这种情况时，您最好将规则及其评估写入您的配置。

这个主题在 Pragramtic Programmer 一书中得到了一些报道。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-26T17:28:04.450

卢阿是：

*   轻的
*   易于集成，即使在游戏等异步环境中
*   易于学习的非程序员人员，如集成商、设计师和艺术家

由于游戏通常需要所有这些品质，因此 Lua 主要用于那里。其他位置可能是需要一些脚本功能的任何应用程序，但开发人员通常会选择更重量级的解决方案，例如 .Net 或 python。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-08T16:33:00.723

除了提到的脚本和可配置性案例，我只想说 Lua+C（或 Lua+C++）是*任何*软件开发的完美匹配。它允许创建引擎/使用接口，其中引擎在 C/C++ 中完成，行为或定制在 Lua 中完成。

OS X Cocoa 具有 Objective-C（C 和 Smalltalk 的混合物，其中语言按行更改）。我发现 Lua+C 类似，只是源文件改变了语言，这对我来说是一个更好的抽象。

您不想使用 Lua 的原因*也*值得注意。因为它几乎没有一个好的调试器。话又说回来，人们似乎也几乎不需要一个。:)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-23T06:24:52.967

如果您必须在应用程序运行时更改代码（立即生效），也可以使用像 Lua 这样的脚本语言。人们可能不会在 wow 中看到这一点，因为据我记得代码是在开始时加载的（并且在运行时没有重新检查和重新加载）。

但是想想另一个例子：网络服务器和脚本语言——（谢天谢地）你可以改变你的 php 代码，而不必重新编译 apache 或重新启动 apache。

steve yegge使用 jython 或 rhino 和 javascript（不记得）为他自己的为[wyvern提供动力的 mmorpg 引擎做了这件事。](http://www.cabochon.com/)他用java编写了核心引擎，但用python/javascript编写了程序逻辑。

这样做的效果是：

*   他在更改脚本时不必重新启动核心引擎，因为那样会断开所有玩家的连接
*   他可以让其他人进行更简单的编程，例如定义新项目和怪物，而无需将所有关键代码暴露给他们
*   沙盒：如果脚本内部发生错误，您可以优雅地处理它，而不会危及周围的应用程序

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-26T17:26:26.077

具有实时约束的应用程序的快速开发。电脑游戏就是其中之一；-)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-26T17:27:02.020

如果您想允许第三方为您的软件开发插件或模组，这是一个有效的解决方案。

你可以用你使用的任何语言来实现 API，但是像 LUA 这样的脚本语言往往更简单，并且对于临时开发人员来说更容易使用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-21T13:55:13.150

除了其他人提到的所有优秀理由之外，当您需要操作文本、处理文件或只需要更高级别的语言时，在 C 中嵌入 Lua 非常有用。Lua 有很多漂亮的特性（表、函数是一流的值，还有很多其他的好东西）。此外，虽然 lua 不如 C 或 C++ 快，但它对于解释型语言来说相当快。

# jquery - jquery Accordion“破坏”不起作用

> ID：591525
> 
> 赞同：1
> 
> 时间：2009-02-26T17:23:47.283
> 
> 标签：jquery, accordion

我正在使用 jQuery Accordion 并想制作一个可打印的页面，其中所有“手风琴”都被扩展。我找到了 .accordion('destroy') 选项。但是，当我实现它时，单击销毁按钮后仅显示现有的可见 div。任何帮助，将不胜感激。

```
<link type="text/css" href="/js/theme/ui.all.css" rel="Stylesheet" />   
<script type="text/javascript" src="/js/jquery-ui-personalized-1.6rc6.js"></script>
<script type="text/javascript">
$(function(){
// Accordion
$("#accordion").accordion({ header: "h2", autoHeight: false, animated: false });

 //attach click hander to button        
$("#accordionKiller").click(function() { 
 //destroy the accordion
$("#accordion").accordion('destroy');
}); 
});
</script>

<a id="accordionKiller">Printable version</a> 

<div id="accordion">

<div>
    <h2><a href="#">Services</a></h2>
    <div class="services">

    </div>
</div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-26T18:38:23.487

调用手风琴销毁后，您需要将内容 div 设置为可见。

根据您链接到的页面，我将**在**$("#accordion").accordion('destroy') 行之前添加它：

```
$(".ui-accordion-content").css("display", "block"); 
```

# c# - 如何处理 C++ 加载的 C# DLL 中的异常

> ID：591533
> 
> 赞同：4
> 
> 时间：2009-02-26T17:25:44.597
> 
> 标签：c#, c++, com, exception-handling

我有一个用 C# 创建的 DLL，目的是为第三方 C# 库提供 COM 接口。我有一个使用该 COM 接口的 C++ 程序，以便它可以与 C# 库进行通信。有时，异常会在 C# 端抛出，而我在 C++ 端得到的只是来自 COM 调用的 HRESULT，它表示“发生异常”（或类似的东西）。有什么方法可以让我获取整个异常信息，以便我可以在我的 C++ 应用程序日志中打印一条信息性消息？如果没有，我可以在 C# 端做些什么来拦截所有异常，然后它们触发将 HRESULT 返回到 C++ 的任何机制，以便我可以在 C# 端记录它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-26T17:44:00.433

有一个托管异常到 HRESULT 的映射。[请参阅此 MSDN 文章](http://msdn.microsoft.com/en-us/library/9ztbc5s1.aspx)中的表格。.NET 使用 IErrorInfo 从 COM 对象检索错误信息。这也可能反过来起作用。值得一试。

# linux - 我们可以修改 int 0x80 例程吗？

> ID：591536
> 
> 赞同：0
> 
> 时间：2009-02-26T17:26:54.780
> 
> 标签：linux, assembly, routines

1.  linux 2.6 与 2.4 有何不同？
2.  我们可以修改源内核吗？
3.  我们可以修改 int 0x80 服务程序吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-26T17:44:42.477

更新：
1\. 0x80 处理程序在 2.4 和 2.6 之间基本相同，尽管从处理程序调用的函数由 2.6 中 x86-64 的“syscall”指令处理程序调用。2\. 0x80 处理程序可以像内核的其余部分一样进行修改。
3\. 你不会因为修改它而破坏任何东西，除非你删除向后兼容性。例如，如果您愿意，可以添加自己的跟踪或后门。另一篇文章说，如果您修改处理程序，您将破坏您的库和工具链是不正确的。如果你破坏了调度算法，或者错误地修改了调度表，那么你就会破坏事情。
3a。正如我最初发布的那样，扩展 0x80 服务的最佳方法是扩展系统调用处理程序。

正如内核源代码所说：

```
What：内核系统调用接口
描述：
        该接口与 POSIX 接口的大部分内容相匹配，并且基于
        在它和其他基于 Unix 的接口上。它只会被添加到
        随着时间的推移，并没有从它删除的东西。

```
 Note that this interface is different for every architecture
    that Linux supports.  Please see the architecture-specific
    documentation for details on the syscall numbers that are to be
    mapped to each syscall. 
```

i386 的系统调用表条目位于：

`arch/i386/kernel/syscall_table.S`

请注意，该表是一个指针序列，因此如果您想与内核维护者保持一定程度的前向兼容性，您需要在放置指针之前填充该表。系统调用向量号在.h

中定义，
然后 traps.c 设置函数的地址 via ，它将条目放入中断描述符表中。该函数本身在entry.S 中，并从系统调用表中调用所请求的指针。

有一些看家的细节，看代码可以看到，但是直接修改0x80中断处理是在entry.S里面完成的`irq_vectors`
`system_call``set_system_gate``system_call`
`system_call`功能。以一种更理智的方式，您可以修改系统调用表，插入您自己的函数而不修改调度机制。

事实上，在阅读了 2.6 的源代码后，它直接说 int 0x80 和 x86-64 系统调用使用相同的代码，到目前为止。因此，您可以对 x86-32 和 x86-64 进行可移植的更改。

END 更新

INT 0x80 方法调用系统调用表处理程序。这将寄存器参数与调用表匹配，根据 EAX 寄存器的内容调用内核函数。您可以轻松扩展系统调用表以添加自定义内核 API 函数。

这甚至可能适用于 x86-64 上的新系统调用代码，因为它也使用系统调用表。

如果您以任何方式更改当前系统调用表而不是扩展它，您将破坏所有依赖库和代码，包括 libc、init 等。

这是当前 Linux 系统调用表：[http ://asm.sourceforge.net /syscall.html](http://asm.sourceforge.net/syscall.html)

            回答 #2

赞同：5

时间：2009-02-26T17:36:37.563

1.  这是一次架构大修。一切都在内部发生了变化。SMP 支持已经完成，进程调度程序得到了极大的改进，内存管理得到了彻底的改进，还有很多很多其他的事情。
2.  是的。它是开源软件。如果您没有源代码的副本，您可以从供应商或[kernel.org](http://www.kernel.org)获得。
3.  是的，但这是不可取的，因为它**会**破坏 libc，它**会**破坏你的基本布局，如果你改变现有系统调用的顺序，它**会**破坏你的工具链，并且几乎所有你可能认为你想做的事情都应该在用户空间中完成一切皆有可能。

        html - 如何在没有表格的情况下设置样式和对齐表格？

ID：591539

赞同：32

时间：2009-02-26T17:27:15.560

标签：html, css, forms, html-table

我已经习惯于`<table>s`完美地对齐表单字段。这就是我通常编写表单的方式：

```
<table border="0">
   <tr>
     <td><label for="f_name">First name:</label></td>
     <td><input type='text' id='f_name' name='f_name' /></td>
     <td class='error'><?=form_error('f_name');?></td>
   </tr>
</table> 
```

我知道这是不好的做法，我*想*使用 CSS、、、`<label>s`或`<div>s`更简洁的方法。然而，事实是，`<table>s`这些表格的效果非常好。一切都完全正确对齐，间距完美，所有错误都正好在彼此下方，等等。

我最近尝试在表单中使用`<dt>`和`<dd>`标签，但我最终还是回到了表格，因为它们看起来好多了。

如何在不使用`<table>`s 的情况下获得这种对齐的表格布局？

            回答 #1

赞同：27

时间：2009-02-26T18:13:38.957

这可能不会得到很多支持，但这是我的两分钱：

在某些情况下，表格**更易于**布局；例如三列或表单（尽管这里有一些很好的建议来做一个纯 css 表单布局，所以也不要忽略这些。）

```
流程和方法可以成为好仆人，但却是糟糕的主人。
   - 马克·多德、约翰·麦克唐纳和贾斯汀·舒
     在“软件安全评估的艺术”中

```

我相信这句话非常适用于这种情况。如果您的表格布局适合您，不会导致可访问性问题并且没有损坏 - 那么不要修复它。

像这样的短语：“你应该”、“必须”、“总是”——让我害怕，因为一刀切不适合所有人！以一粒盐为狂热者。

            回答 #2

赞同：15

时间：2009-02-26T17:30:56.440

是的，使用标签和 CSS：

```
<label class='FBLabel' for="FName">First Name</label>
<input value="something" name="FName" type="text" class='FBInput'>
<br> 
```

CSS：

```
.FBLabel, .FBInput {
    display:block;
    width:150px;
    float:left;
    margin-bottom:10px;
} 
```

见：[http ://www.alistapart.com/articles/prettyaccessibleforms](http://www.alistapart.com/articles/prettyaccessibleforms)

            回答 #3

赞同：11

时间：2009-09-08T19:01:47.330

如果您不使用表格，则需要预先知道标签的宽度。这通常是多语言网站 (i18n) 的问题。

对于表格，它们可以拉伸以适应不同尺寸的标签。单靠 CSS 还不能以得到良好支持的方式做到这一点。

            回答 #4

赞同：5

时间：2009-02-26T17:30:41.527

为什么不想使用表格？听起来他们现在很适合你。您是否担心可访问性问题？仅仅因为它是一张桌子并不意味着可访问性会受到影响。

我想提醒您不要为了纯洁而为已解决的问题创建新的解决方案。即使你担心语义，到底什么样的语义描述了一种形式？

            回答 #5

赞同：5

时间：2009-02-26T17:37:27.283

我大部分时间都使用以下方法，它允许我按照我喜欢的方式设置所有对齐方式。如您所见，它为我提供了大量的 CSS 和 JS 钩子。

```
<form id="login-form" action="#" method="post">
	<fieldset>
		<label id="for-email" for="email">
			<span class="label-title">Email Address <em class="required">*</em></span>
			<input id="email" name="email" type="text" class="text-input" />
		</label>

		<label id="for-password" for="password">
			<span class="label-title">Password <em class="required">*</em></span>
			<input id="password" name="password" type="password" class="text-input" />
		</label>
	</fieldset>

	<ul class="form-buttons">
		<li><input type="submit" value="Log In" /></li>
	</ul>
</form><!-- /#login-form -->
```

            回答 #6

赞同：4

时间：2017-05-18T14:36:13.363

这里的大多数非基于表格的答案都依赖于预先确定的固定宽度，这对于国际化或您无法确定标签所需宽度的任何其他情况来说可能是一种痛苦。

但是 CSS`display: table`正是出于这个原因：

**HTML**

```
<div class="form-fields">
  <div class="form-field">
    <label class="form-field-label" for="firstNameInput">First Name</label>
    <div class="form-field-control"><input type="text" id="firstNameInput"></div>
    <div class="form-field-comment">Required</div>
  </div>
  <div class="form-field">
    <label class="form-field-label" for="lastNameInput">Last Name</label>
    <div class="form-field-control"><input type="text" id="lastNameInput"></div>
    <div class="form-field-comment">Required</div>
  </div>
</div> 
```

**CSS**

```
.form-fields {
  display: table;
}

.form-field {
  display: table-row;
}

.form-field-label,
.form-field-control,
.form-field-comment {
  display: table-cell;
  padding: 3px 10px;
} 
```

简单的。

            回答 #7

赞同：3

时间：2009-02-26T17:46:31.300

没有桌子有很多方法可以做到这一点。一旦你掌握了基本格式，它就像桌子一样容易使用，只是最初的游戏可能会很痛苦。因此，只需看看其他已经为您解决所有问题的人：

*   [http://www.alistapart.com/articles/prettyaccessibleforms](http://www.alistapart.com/articles/prettyaccessibleforms)
*   [http://woork.blogspot.com/2008/06/clean-and-pure-css-form-design.html](http://woork.blogspot.com/2008/06/clean-and-pure-css-form-design.html)

我还记录[了我](http://forgottenexpanse.com/blog/2009/02/19/semantically-delicious-forms)上周确定的方法（片段）：

```
<form action="/signup" method="post">
<fieldset>
<legend>Basic Information</legend>
<ol>
<li><label for="name">Name <span class="error">*</span>
    </label><input type="text" id="name" name="name" size="30" /></li>
<li><label for="dob">Date of Birth <span class="error">*</span></label>
    <div class="inputWrapper">
    <input type="text" id="dob" name="dob" size="10" />
    <span class="note">YYYY-MM-DD</span></div></li>
<li><label for="gender">Gender <span class="error">*</span></label>
    <select id="gender" name="gender">
    <option value=""></option>
    <option value="female">Female</option>
    <option value="male">Male</option>
    </select></li>
</ol>
</fieldset>
</form> 
```

和CSS：

```
fieldset { 
    margin: 0 0 20px 0; } 

fieldset legend { 
    font-weight: bold; 
    font-size: 16px; 
    padding: 0 0 10px 0; 
    color: #214062; } 

fieldset label { 
    width: 170px; 
    float: left; 
    margin-right:10px; 
    vertical-align: top; } 

fieldset ol { 
    list-style:none; 
    margin: 0;
    padding: 0;} 

fieldset ol li { 
    float:left; 
    width:100%; 
    padding-bottom:7px; 
    padding-left: 0; 
    margin-left: 0; } 

fieldset ol li input, 
fieldset ol li select, 
fieldset ol li textarea { 
    margin-bottom: 5px; } 

form fieldset div.inputWrapper { 
    margin-left: 180px; } 

.note { 
    font-size: 0.9em; color: #666; }

.error{ 
    color: #d00; } 
```

[jsFiddle](https://jsfiddle.net/u0asnyek/)

            回答 #8

赞同：2

时间：2009-02-26T17:31:12.447

真的取决于你和谁说话。纯粹主义者说使用 CSS 是因为 table 元素不适合布局。但对我来说，如果它有效，为什么要改变它？我现在确实使用 CSS 进行布局，但我仍然有很多遗留代码我没有也不会改变。

            回答 #9

赞同：0

时间：2009-02-26T17:45:50.117

我过去相当有效地使用过它：

**HTML：**

```
<fieldset>
  <p>
    <label for="myTextBox">Name</label>
    <span class="field"><input type="text" name="myTextBox" id="myTextBox" /></span>
    <span class="error">This a message place</span>
  </p>
</fieldset> 
```

**CSS：**

```
<style type="text/css">
fieldset label, fieldset .field, fieldset .error { display: -moz-inline-box; display: inline-block; zoom: 1; vertical-align: top; }
fieldset p { margin: .5em 0; }
fieldset label { width: 10em;  text-align: right; line-height: 1.1; }
fieldset .field { width: 20em; }
</style> 
```

唯一真正的问题是 Firefox 2，它可以优雅地降级。（请参阅 -moz-inline-box 这有点 hack，但还不错）

            回答 #10

赞同：0

时间：2009-02-26T17:51:01.120

没有一刀切的方法。但是，您使用的表格示例可以改进：

```
<table>
  <tbody>
    <tr>
      <th scope="row"><label for="f_name">First name:</label></th>
      <td>
        <input type='text' id='f_name' name='f_name' />
        <?php form_error('f_name'); ?>
      </td>
    </tr>
    <!-- ... -->
  </tbody>
</table> 
```

对错误部分不太确定；我认为将它放在输入旁边比为其设置单独的列更有意义。

            回答 #11

赞同：0

时间：2013-11-14T17:29:07.793

我也遇到了这个问题，但是左边有一个菜单（也有浮动：左边）。

所以。我的解决方案是：html

```
<div class="new">
   <form>
     <label class="newlabel">Name</label>
     <input type="text" name="myTextBox" id="myTextBox" />
   </form>
</div> 
```

css

```
.new {
    display:block;
}
.newlabel {
    min-width: 200px;
    float: left;
} 
```

我认为，它也可以在表单类中使用，但实际上我在“新”类中有更多表单。

        c# - C#如何禁用浏览器使用

ID：591543

赞同：5

时间：2009-02-26T17:27:38.507

标签：c#, winforms

我有一个 C# 应用程序，它有一个网络浏览器，有时需要能够完全禁用它。这样做的最佳方法是什么？

我正在考虑创建一个透明面板以在需要时放置在网络浏览器上，但不确定这是否是最佳方法。我还注意到 C# 不容易让面板透明。

编辑：澄清我的意思是禁用...我不想让用户能够单击或更改\编辑网络浏览器中的任何内容。  

            回答 #1

赞同：18

时间：2009-02-26T17:38:06.000

~~奇怪的是，WebBrowser 控件没有您可能期望的 Enabled 属性。您可以将 AllowNavigation 属性设置为 false，这将阻止用户单击链接。~~

原来它确实有一个 Enabled 属性，继承自 Control。但是您必须将其显式转换为 Control 才能访问它：

```
((Control)webBrowser1).Enabled = false; 
```

*尽管设置启用完全*禁用与 WebBrowser 控件的任何用户交互，但您应该知道。这包括滚动条，因此一旦将 Enabled 设置为 false，用户甚至无法在控件中滚动网页。

如果这超出了您的预期，那么将 AllowNavigation 属性设置为 false 将阻止用户单击链接，但仍允许他们滚动页面。您需要检查它是否也会阻止 Javascript onclick 事件触发。

如果您想阻止任何事件在页面中触发，您可能会实现一些 DOM 从 WebForms 代码到 WebBrowser 控件的工作。您可能还需要开始禁用 WebBrowser 中的输入控件。这完全取决于您想要它的禁用程度。

            回答 #2

赞同：3

时间：2009-02-26T17:37:14.833

根据您的最后评论，我假设您使用的是 WinForms。（WPF 确实很容易允许透明面板 :-)）这意味着您正在使用[`WebBrowser`](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser.aspx)控件。您是否尝试将其[`Enabled`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.enabled.aspx)属性设置为 false？

            回答 #3

赞同：1

时间：2009-02-26T17:37:55.783

当您说“禁用”它时，您是什么意思？如果将“启用”属性设置为 false，它将被禁用，这适用于所有表单控件。但是，如果需要，您可以通过将面板设置为背景色来将面板设置为透明。

更新：实际上，您是对的，它是 ActiveX 控件的包装器，因此它不是典型的 WinForms 控件。您想要的是透明的 paenl 解决方案。这家伙托比在他的博客上有一个解决方案：

[http://saftsack.fs.uni-bayreuth.de/~dun3/archives/creating-a-transparent-panel-in-net/108.html](http://saftsack.fs.uni-bayreuth.de/~dun3/archives/creating-a-transparent-panel-in-net/108.html)

基本思想是在面板类上覆盖此方法：

```
protected override CreateParams CreateParams
{
    get
    {
         CreateParams createParams = base.CreateParams;
         createParams.ExStyle |= 0x00000020; // WS_EX_TRANSPARENT
         return createParams;
    }
} 
```

            回答 #4

赞同：0

时间：2009-02-26T17:42:33.213

您可以从其父控件数组中删除网络浏览器吗？

            回答 #5

赞同：0

时间：2014-10-02T18:17:47.663

在 VB 中：DirectCast(WebBrowser1, Control).Enabled = False

        design-patterns - 充满静态方法的类的设计注意事项

ID：591546

赞同：2

时间：2009-02-26T17:28:17.710

标签：design-patterns, static

作为一名多年的 Swing 开发人员，我已经确定了许多用于布局组件的模式。例如，我经常创建与 JLabel 关联的组件。我通常写：

```
JPanel panel = new JPanel(new BorderLayout());
panel.add(label, BorderLayout.NORTH);
panel.add(list, BorderLayout.CENTER);
```

我经常这样做，所以我决定创建一个包含我常用的布局习惯用法的类。那我可以简单的说：

```
JPanel panel = LayoutPatterns.createNorthLabeledPanel(label, list);
```

...这大大减少了我的打字负担。

所以，现在我有一个包含大约 20 个静态方法的类。该类没有状态 - 所有上下文都通过方法参数传入。

除了 Java 的 Math 类之外，我还没有看到任何完全由静态方法组成并且没有状态的类。  

一方面，这感觉不对。另一方面，我看不出有什么问题。  

这是一个可以使用的模式，还是表明代码气味的东西？如果将此模式应用于不同的域，我是否应该关注静态类的多线程使用？如果您曾在生产质量代码中看到这一点，您会犹豫吗？

            回答 #1

赞同：4

时间：2009-02-26T17:46:14.750

I think the only problem here is a language that forces you to invent a class where -gasp- global functions are totally appropriate. :-)

            回答 #2

赞同：4

时间：2009-02-26T17:36:41.823

我认为这种事情通常有不好的代码气味。但是，我和你在一起，在这种情况下我没有看到任何特别错误的地方。

我认为您已经很好地解释并证明了您的设计。

考虑一个可能的替代方案，也许您可​​以继承 JPanel 并创建 NorthLabelJPanel（或者甚至更好地创建一个包含 JPanel 的新类）。但是，我不确定这是否值得付出努力。我认为您的代码以这种方式看起来会更复杂，即使它可能是“按书本”更好的方式。

我的 2 美分 :)

            回答 #3

赞同：2

时间：2009-02-26T17:33:22.127

我认为制作这样的课程没有问题。如果该类在其正常使用中有意义，以至于您永远不需要实例化它的实例，那么为什么不将方法设为静态呢？

我自己也写过类似的代码。

            回答 #4

赞同：2

时间：2009-02-26T17:34:27.990

只要事情不会失控，仅静态的实用程序类就没有错。如果您放入其中的方法不需要任何状态，则没有理由实例化您的类。

事实上，这种情况非常普遍，在 .Net 中，扩展方法必须位于静态类中，因为大多数情况下，实用程序函数是静态的，并试图扩展另一种类型的功能。

            回答 #5

赞同：1

时间：2009-02-26T18:01:53.557

Seems like every project ends up with a static utility class sooner or later. For your particular example I would maybe look into a factory pattern. But I don't see anything wrong with what you are doing if it helps you get the job done and doesn't confuse others on your team.

            回答 #6

赞同：1

时间：2009-02-26T17:35:06.990

我认为您的方法没有任何问题，事实上，我一直在做这些实用程序静态类。因为这个类没有任何状态，我认为你在多线程环境中不会有问题。如果您担心此类的尺寸，请考虑根据某些类型的挥杆组件对其进行划分。

            回答 #7

赞同：0

时间：2009-02-26T17:51:54.253

VB.NET and now C# even have language support for static classes (VB calls them Modules) so you can have the compiler check that they are indeed all static.

            回答 #8

赞同：0

时间：2009-02-26T17:53:40.003

Personally, I would prefer to see the code in the original form of what you've described.  It would be much easier to tell at a glance exactly what the code is doing, and easier to maintain because if you ever wanted to change the layout of the panel, you wouldn't have to search for the proper method or create a whole new method to achieve what you want.  Also, as you add more attributes to your components, the number of your static methods would grow at an exponential rate.

In the world of design patterns, I see the Builder pattern applied to cases like this, which it appears that is what the Java API is trying to achieve.

The basic rundown:

1.  Create a simple object, little or no decoration
2.  Add objects/attributes/etc. to it to make it look/do what you want

NOTE: The beauty is that you don't know what the end result will look like until you are done, which gives you a full range of flexibility.

Furthermore, I just read a response that discussed extending JPanel.  From a design stand-point, remember to try to favor a has-a relationship instead of an is-a relationship whenever possible.  Otherwise, you end up with a very flat class structure that looks identical to your static methods, and would suffer the same pitfalls as I described above.

Now with that said, I have written and used a large collection of what I call "Services", classes that have no state and only static methods (as you've described), and they have saved me from writing (and more importantly, duplicating) a lot of my basic routines.  They can come in real handy, if used properly, but I tend to only use them for very basic (and common) routines, such as formatting text, copying arrays, converting float arrays to double arrays (in C++), or anything else that you would expect to find in a standard library.

It really just depends on how "static" your static methods really are.  If you don't see them needing to be maintained or updated that often, then you could probably get away with locking them down to what you've described.  However, if there's any chance of re-factoring in the future, I think you should prefer to leave it as flexibile as possible, which unfortunately means making the API calls manually each time.

Good luck!

            回答 #9

赞同：0

时间：2009-10-30T15:35:27.883

我认为如果你在面向对象的环境中开发，你只有两个选择：

1.  将所有类方法设为静态。
2.  开发一个常规类并使用单例模式。

        permissions - 使用“make install”以足够的权限安装 Tig

ID：591549

赞同：0

时间：2009-02-26T17:30:28.423

标签：permissions, installation, tig

我怎样才能给命令“make install”足够的权限来成功运行以下命令？

```
[~/tig-0.14.1]# make install
mkdir -p /usr/local/bin && \
for prog in tig; do \
    install -p -m 0755 "$prog" "/usr/local/bin"; \
done
mkdir: cannot create directory `/usr/local': Permission denied
make: *** [install] Error 1 
```

我在问题出现之前运行 ./configure 和 make 成功。

            回答 #1

赞同：2

时间：2009-02-26T17:33:01.210

以 root 身份运行`make install`，或在您具有写入权限的目录中配置 Tig。（通常与`--prefix=<path>`配置命令一起使用）

        c# - 使用 jQuery 的具有复杂功能的弹出窗口

ID：591556

赞同：0

时间：2009-02-26T17:31:29.370

标签：c#, asp.net, jquery, listview, popup

我正在使用 jQuery 来模拟一个弹出窗口，用户将在其中选择一系列过滤器，我希望使用这些过滤器在原始窗口中重新绑定一个 ListView。

“弹出窗口”是通过 ajax 请求打开的，内容实际上是一个不同的 aspx 文件（呈现的输出被注入到充当弹出窗口的 div 中）。

我在这个弹出窗口中有另一个 ListView，它有分页。

我的问题是，由于弹出窗口实际上是同一页面中 div 内的 html 内容，因此当我尝试分页时，整个页面回发并被具有过滤器的 aspx 替换。

我怎样才能解决这个问题？我尝试使用更新面板来包含 ListView 但它不起作用。

            回答 #1

赞同：1

时间：2009-02-26T18:37:17.623

$("div.yourthingie").hide();

将隐藏您要显示的部分 :) 与其即时生成弹出窗口，不如留下已经制作的一小部分，并在开始时将其隐藏，当您需要显示时，取消隐藏并添加您需要的信息。

希望能帮助到你

            回答 #2

赞同：1

时间：2009-02-26T18:37:55.890

要么摆脱 HTML“外壳”，只生成 <div> 及其内容，要么使用 IFRAME。

            回答 #3

赞同：0

时间：2009-02-27T15:44:50.477

首先，让我们思考一下正在发生的事情。当您提交原始页面时，您将进行“正常”请求/响应之旅以获取代码。页面上有一个 JQuery AJAX 位，它触发本质上是模式对话框的内容。期望的效果是用户玩新页面，直到他们找出过滤器并提交回来。问题是当有人分页时，这个“模态页面”会丢失信息。

理论上，这个问题的解决方案相当简单。您必须将“过滤器”存储在弹出页面中，以便可以重新发送它们以及分页信息。或者您必须在用户分页时缓存结果集。

为了解决这个问题，我要做的是创建一个静态页面，其中包含“过滤器”，并计算出 AJAX 扭结与将页面回发到父页面分开。一旦所有的 AJAX 位都正常工作，我会将其链接到弹出例程中，并确保分页仍然没有问题。最后一个问题是创建一个 JavaScript 例程，该例程发送回父页面并允许父页面将其 JQuery 位发送回服务器。

我不确定等式的 HTML DIV 部分，我认为您可以在没有此解决方案的情况下解决问题。事实上，我相信你可以在不调用 AJAX 的情况下制作“模式弹出”页面，如果可以 a) 通过查询字符串提交过滤器以应用，或者 b) 将表单提交到第二页。查询字符串是一个更简单的选项，但它公开了一些信息。总体而言，伪造表单提交并不难，但弹出窗口可能会出现问题。

我只是提出了一些想法，但我希望它对你有所启发。

        asp.net - 禁用 .NET 控件是否会阻止它回发

ID：591559

赞同：1

时间：2009-02-26T17:31:50.790

标签：asp.net, forms, controls

我有一个基于选择（下拉菜单）的定制 ASP 控件。如果我通过在其 html 中添加单词“禁用”来禁用我的控件，则在处理表单数据时会开始出现空指针错误。

我想，要么浏览器不回发禁用的表单项，要么 ASP.NET 在处理表单数据时忽略它们。我不确定是哪一个。我试图了解我在哪里丢失数据。

谢谢你的帮助。

PS。我意识到有比手动编辑 html 更好的方法来创建和禁用控件，但是这里有一个上下文不允许我这样做。

            回答 #1

赞同：5

时间：2009-02-26T17:35:56.787

是的，设置控件的 Enable = false 是防止控件的值被添加到发布的数据集合中。

您可以改用[readonly 属性](http://www.w3schools.com/ASPNET/prop_webcontrol_textbox_readonly.asp)。

在[MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.textbox.readonly.aspx)中它说：

发生回发时，将 ReadOnly 属性设置为 true 的 TextBox 控件的 Text 值发送到服务器，但服务器不处理只读文本框。这可以防止恶意用户更改只读文本值。Text 属性的值在回发之间保留在视图状态中，除非被服务器端代码修改。

这里也是[微软对](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=102065)与主题相关的错误报告的回复。

但是，如果您以这样的经典方式使用它，它将起作用：

```
txt2.Attributes.Add("readonly", "readonly"); 
```

            回答 #2

赞同：0

时间：2009-02-26T22:21:32.247

它将阻止控件回发，但请记住此 Web 范例是客户端/服务器技术。一个人可以修改客户端数据（HTML 和/或 Javascript）并强制回发，无论您向他发送什么。

因此，不要依赖它来进行安全敏感的操作，例如金钱操纵等。

始终在服务器端检查敏感操作。

        html - CSS：级联只是一个级别

ID：591560

赞同：2

时间：2009-02-26T17:32:00.087

标签：html, css, inheritance

假设我有一个定义了 css 类的 <table> (<table class="x">)，并且我想更改 <td> 的第一级的“颜色”属性，这是否可以在不设置类的情况下使用 css在相关的 <td> 上？

IE

```
<table class="x">
    <tr>
        <td>
            xxxx
            <table><tr><td>yyy</td><tr></table>
        </td>
    </tr>
<table> 
```

我只希望 xxxx 改变颜色 - 所以`.x td{color:red;}`目前适用于 xxxx 和 yyyy 当我只希望 xxxx 为目标时，但不想给 xxxx td 一个类名

            回答 #1

赞同：17

时间：2009-02-26T17:34:04.030

试试这个：

```
table.x > tr > td { ... } 
```

是`>`直接子选择器。

            回答 #2

赞同：8

时间：2009-02-26T17:38:17.763

一种选择是通过将第二级设置为您想要的来覆盖级联效果，从而允许您取消顶级效果。

像这样的东西：

```
table.x tr td { ...}

table.x tr td table tr td { ... } 
```

第一条语句将应用于 .x 表下的所有 td，但随后第二条语句将覆盖内部嵌套级别（以及它们之下的任何内容）。由于它出现在第一个语句之后，它将覆盖上面语句中设置的任何内容。

这也将在 IE 中起作用，因为它使用更基本的祖先/后代结构而不是子代，后者没有得到很好的支持。

        design-patterns - 如何超越回调编程？

ID：591562

赞同：2

时间：2009-02-26T17:32:02.083

标签：design-patterns, oop, callback

我注意到我的大部分代码都是围绕回调构建的。这被认为是“设计缺陷”吗？我应该遵循更好的设计模式吗？

            回答 #1

赞同：7

时间：2009-02-26T17:35:57.440

我想您可以将[观察者模式](http://en.wikipedia.org/wiki/Observer_pattern)视为类似于回调的东西。你检查过它们吗？

在[Pragmatic Programmer](https://rads.stackoverflow.com/amzn/click/com/020161622X)一书中，他们提到了一个人等待登机的例子。与其不断询问值机柜台她是否可以登机（投票），不如说当航班准备好时，值机柜台会向所有感兴趣的人公开宣布。

此示例的伪代码可能如下所示：

```
class Clerk implements CheckInNotifyer {
  BunchOfObservers observers = new Bunch();

  public void addObserver(CheckInObserver observer) {
    observers.add(observer);
  }

  private void notifyListeners() {
    observers.all.notifyCheckIn(new CheckInEvent());
  }
}

class Passenger implements CheckInObserver {
  public void notifyCheckIn(CheckInEvent event) {
    event.getPlane().board();
  }
}

class WaitingArea {
  public init() {
    Passenger passenger = new Passenger();
    Clerk clerk = new Clerk();

    clerk.addObserver(passenger);
  }
} 
```

            回答 #2

赞同：4

时间：2009-02-26T18:07:03.623

它也被称为[事件驱动编程](http://en.wikipedia.org/wiki/Event-driven_programming)。

            回答 #3

赞同：3

时间：2009-02-26T17:37:22.773

当您有多个带有回调的过程时，另一个特别有效的选择是使用 WaitHandles。  

            回答 #4

赞同：3

时间：2009-02-26T18:03:04.880

这还不错，它只是用非函数式语言进行函数式编程的唯一方法。

            回答 #5

赞同：1

时间：2009-02-26T18:04:54.377

这取决于。对于 Javascript，我更喜欢观察者模式，因为它可以真正知道触发的事件——主要是因为您可以注册和管理多个观察者。但是对于像 AJAX 调用这样的东西，将其包装在一个闭包中并包含回调方法似乎是最干净的方法。

            回答 #6

赞同：-1

时间：2009-03-01T11:05:43.173

在面向对象的语言中，我发现多态性更“干净”（没有强制转换和混乱的函数类型声明）和更面向对象的方法（从接口派生）来实现回调提供的功能。

        asp.net - 在 web.config 中注册用户控件显示错误，但控件仍然有效

ID：591564

赞同：0

时间：2009-02-26T17:32:17.933

标签：asp.net, web-config

这一直困扰着我一上午，我什至无法弄清楚错误在哪里。

在我正在开发的当前网站中（它不是一个Web应用程序，以防万一，有用户控件声明如下：

```
<controls>
        <add tagPrefix="uc1" tagName="TransitLinkAdmin" src="~\controls\TransitLinkAdmin.ascx"/>
        <add tagPrefix="uc1" tagName="TransitLinkList" src="~\controls\TransitLinkList.ascx"/>
        <add tagPrefix="uc1" tagName="WelcomeMessageAdmin" src="~\controls\WelcomeMessageAdmin.ascx"/>
        <add tagPrefix="uc1" tagName="WelcomeMessageDisplay" src="~\controls\WelcomeMessageDisplay.ascx"/>
        <add tagPrefix="asp" namespace="System.Web.UI" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
        <add tagPrefix="asp" namespace="System.Web.UI.WebControls" assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"/>
</controls> 
```

到目前为止一切顺利，对吧？

但是，当我尝试将其中一个控件添加到页面时，我收到一条错误消息，告诉我找不到该控件。那么为什么当我运行页面时，我可以使用控件呢？

设计者告诉我它找不到用户控制文件并且它正在使用来自 web.config 文件的路径，所以它必须以某种方式查看它。

如果我直接在页面中注册控件，那里没有问题。

我的假设（我们现在是如何工作的）是整个站点存在一些编译错误，这会阻止智能感知工作。

提前谢谢大家。

            回答 #1

赞同：1

时间：2009-02-26T17:38:30.960

只是一个完整的猜测，但也许是因为您使用的是反斜杠而不是正斜杠？尝试：

```
 <add tagPrefix="uc1" tagName="TransitLinkAdmin" src="~/controls/TransitLinkAdmin.ascx"/>
    <add tagPrefix="uc1" tagName="TransitLinkList" src="~/controls/TransitLinkList.ascx"/>
    <add tagPrefix="uc1" tagName="WelcomeMessageAdmin" src="~/controls/WelcomeMessageAdmin.ascx"/>
    <add tagPrefix="uc1" tagName="WelcomeMessageDisplay" src="~/controls/WelcomeMessageDisplay.ascx"/> 
```

            回答 #2

赞同：1

时间：2009-02-26T17:45:30.867

你用的是锐化器吗？我不确定是什么版本，但在这个工件发生的过程中的某个地方。尝试更新到最新版本。顺便说一句，他们有一个早期访问程序，您可以在其中下载构建（体面的质量），并使用最新的功能和修复进行更新。
[链接到抢先体验计划](http://www.jetbrains.net/confluence/display/ReSharper/ReSharper+4.5+Nightly+Builds)

            回答 #3

赞同：0

时间：2012-10-16T04:25:39.353

1.  关闭视觉工作室
2.  移动到位置：

    *在 Windows 7 中*：

    > C:\Users\Pavel\AppData\Roaming\Microsoft\VisualStudio\10.0\ReflectedSchemas

    *在 Windows XP 中*：

    > Windows XP 中的 C:\Documents and Settings[您的用户名]\Application Data\Microsoft\VisualStudio\10.0\ReflectedSchemas

3.  删除该文件夹位置中的所有文件。请注意，删除此位置的文件是完全安全的。

4.  然后重新打开视觉工作室。

这应该可以解决您的问题。

        .net - OCR 用于识别 .NET 中的笔迹

ID：591574

赞同：12

时间：2009-02-26T17:34:54.450

标签：.net, ocr, icr

我需要在可以识别手写内容的 .NET 应用程序中使用 OCR 组件。我们启动并运行了 MS office 的 MODI 组件，它可以识别打印文本，但不能识别手写内容。

我不介意付钱。

有人有什么建议吗？

非常感谢吉姆

            回答 #1

赞同：3

时间：2009-02-26T17:36:53.087

我推荐[Pegasus Imaging](http://www.pegasusimaging.com)，我们每天都在使用它，它很棒。对于手写，您有 ICR 模块。

            回答 #2

赞同：2

时间：2012-05-15T08:04:00.473

在我的应用程序中，我们需要识别一些用手写文本填写的表格。只要用户使用格式正确的字符，准确性就很好。我使用的 SDK 称为[Leadtools](http://www.leadtools.com/sdk/ocr/icr.htm)。我的应用程序使用 MFC，但它们也有 .NET 类。

            回答 #3

赞同：1

时间：2009-02-26T17:44:42.397

大多数 OCR 工具包旨在识别印刷文本，而不是手写文本。我会推荐[Atalasoft 的工具包](http://www.atalasoft.com/products/dotimage/ocr/default.aspx)，因为您可以插入各种 OCR 引擎。

识别手写文本的准确性要低得多，也更加困难。它通常被标记为[智能字符识别](http://en.wikipedia.org/wiki/Intelligent_character_recognition)(ICR)，我不确定 Atalasoft、Pegasus 或大多数商业产品是否支持 ICR。通过在网格上的一个单元格中写下每个字母来帮助手写识别，就像在 SAT 上填写你的名字一样。您是在谈论自由格式文本还是在网格上书写？

            回答 #4

赞同：0

时间：2009-06-11T19:47:28.017

试试[tessnet](http://www.pixel-technology.com/freeware/tessnet2/)，它是一个基于 tesseract 的开源 .NET OCR 引擎

            回答 #5

赞同：0

时间：2009-06-16T14:47:58.667

区分手写文本和草书书写很重要。ICR 一词通常用于指代手写文本。

Accusoft Pegasus 提供了一个 SmartZone ICR .NET SDK，可以让您快速识别文本。随着您可以控制文本的输入方式（例如在表单上等），准确性会越来越好。

同样重要的是要认识到，可用于实时识别的线索（例如在平板电脑上）与扫描图像中的线索完全不同。这就是为什么实时草书识别比事后识别（扫描图像）容易得多的原因。可以读出笔的动作，笔画的顺序对识别很有帮助。

        bonjour - 发现 Zeroconf/Bonjour 节点？

ID：591581

赞同：6

时间：2009-02-26T17:35:41.343

标签：bonjour, zeroconf

是否有一种简单的方法可以扫描给定网络以查找 Bonjour/Zeroconf 服务？

我有一组计算机（Linux、Windows、Apple），并希望在我的 Intranet 中自动生成所有可用的支持 Zeroconf 的联网节点的列表。

            回答 #1

赞同：7

时间：2009-03-03T22:26:29.917

如果使用 Linux 和[Avahi-Daemon](http://avahi.org/)，看起来 Avahi-Discover 值得研究。

不过，您显然必须下载/安装/启动它。在 Ubuntu/Debian 上，您可以使用以下内容：

```
% sudo apt-get install avahi-discover 
```

并使用以下命令启动 GUI：

```
% avahi-discover 
```

            回答 #2

赞同：4

时间：2009-02-26T17:39:40.803

我没用过，但你可能想看看[Mono Project 的 Zeroconf 库](http://www.mono-project.com/Mono.Zeroconf)。

看起来他们有一个`mzclient`可以帮助你的查询工具。

如果不出意外，您应该能够使用该库在 C# 中构建一些东西。

            回答 #3

赞同：2

时间：2011-10-22T20:27:30.050

到目前为止，最可靠的方法（我已经尝试了所有这些，构建了一个支持 MDNS 的嵌入式产品）是使用开源的“Bonjour”。这是 mDNSResponder 守护进程，可在此处获取：

[http](http://opensource.apple.com/source/mDNSResponder/mDNSResponder-320.10/)

 : 
//opensource.apple.com/source/mDNSResponder/mDNSResponder-320.10/ mDNSResponder 包有一个 Java JNI 库和示例，可让您轮询所有可用服务。

            回答 #4

赞同：1

时间：2013-08-14T17:26:54.010

@EdH，谢谢你的帖子。我投了赞成票。我还没有尝试过 Mono.Zeroconf，但我很肯定它会起作用，因为 Bonjour/Zeroconf 在过去几年里变化很小。我只是在寻找服务发布和发现等基本功能。mzclient 似乎是一个不错的起点。我挖出了源的 git 位置：[mzclient on github](https://github.com/mono/Mono.Zeroconf/tree/master/src/MZClient)。希望这可以帮助其他寻找类似解决方案的人:-)

        apache-flex - 在 Flex 中解析多部分 SOAP 响应？

ID：591587

赞同：1

时间：2009-02-26T17:36:15.630

标签：apache-flex, soap, jasperserver

我有一个*Flex*应用程序，它需要通过*JasperReports 服务器 Web 服务 API从**JasperReports 服务器*获取报告数据。*Flex Builder 3*在生成 Web 服务消费代码方面做得很好，但有一个例外。如果您要求提供目录列表或报告参数的记帐，*JR Server*会在*SOAP*包装器中返回纯*XML ，而**Flex*会很好地解析它。但是，如果您要求报告本身，无论是*XML*还是*PDF*格式，它都会作为带有一些描述性*XML的多部分**MIME消息返回***********作为第一部分，报告——即使报告本身是*XML——*作为第二部分。*Flex*不知道如何处理多部分消息，只是抱怨无效的*XML*。********** **这是响应的示例。我目前的策略是进行一些字符串解析并单独管理这些位。但是*Flex*是否有任何内置方法来处理这个问题？（我一直找不到。）

```
------=_Part_2_27050467.1235668849951
Content-Type: text/xml; charset=UTF-8
Content-Transfer-Encoding: binary
Content-Id: <0F082AF1DAF83B3077B1867B4FC8AAA6>

<?xml version="1.0" encoding="utf-8"?>
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<soapenv:Body>
    <ns1:runReportResponse soapenv:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:ns1="http://axis2.ws.jasperserver.jaspersoft.com">
        <runReportReturn xsi:type="xsd:string">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;operationResult version=&quot;2.0.1&quot;&gt;\n\t&lt;returnCode&gt;&lt;![CDATA[0]]&gt;&lt;/returnCode&gt;\n&lt;/operationResult&gt;\n
        </runReportReturn>
    </ns1:runReportResponse>
</soapenv:Body>
</soapenv:Envelope>
------=_Part_2_27050467.1235668849951
Content-Type: application/pdf
Content-Transfer-Encoding: binary
Content-Id: <report>

%PDF-1.4\n%âãÏÓ\n1 0 obj <</Filter/FlateDecode/Length 29>>stream\nx+är\ná26S°00S\bIár\rá\näâ 
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:22:14.070

我要说的只是我相信的：我可能错了，因为我还没有尝试过。

我认为你没有太多选择。Flex HTTPService（或您使用的任何东西）只能提供这么多（/或这么少）数据格式。见[这里](http://livedocs.adobe.com/flex/3/langref/mx/rpc/http/HTTPService.html#resultFormat)。对于任何自定义流，您必须将其作为 an 检索`object`并通过您自己的解码器传递。Flex 似乎不对 MIME 消息进行任何解析，而是依赖（这也是浏览器的典型行为方式）服务器来识别正在传输的内容。如果服务器只发送一个文本文件但将内容类型更改为说`audio/mpeg`我认为你会遇到同样的问题。即使 Flex 确实知道如何处理文本。

如果你有时间做这个实验（使用文本文件作为 MIME 类型的视频或任何你喜欢的东西）请告诉我们。

同时，您可以查看[SerializationFilter](http://livedocs.adobe.com/flex/3/langref/mx/rpc/http/SerializationFilter.html)并继续为 PDF 添加新的 MIME 类型！

[希望 Flex 4 和HTTPMultiService](http://livedocs.adobe.com/flex/gumbo/langref/mx/rpc/http/HTTPMultiService.html)让生活变得轻松一些。

# iis - 如何从命令提示符将 SSL 证书分配给 IIS7 站点

> ID：591597
> 
>         
> 
> 赞同：56
> 
>         
> 
> 时间：2009-02-26T17:37:54.473
> 
>         
> 
> 标签：iis, iis-7, ssl, ssl-certificate, appcmd

您能否告诉我是否可以使用 APPCMD 应用程序将 SSL 证书分配给 IIS7 中的网站？

我熟悉设置 HTTPS 绑定的命令

```
appcmd set site /site.name:"A Site" /+bindings.[protocol='https',bindingInformation='*:443:www.mysite.com'] 
```

以及如何获取当前映射

```
%windir%\system32\inetsrv\Appcmd 
```

但似乎找不到任何将站点映射到证书的方法（例如证书哈希）

* * *

## 回答 #1

> 赞同：54
> 
>             
> 
> 时间：2009-05-07T11:44:10.180

答案是使用 NETSH。例如

```
netsh http add sslcert ipport=0.0.0.0:443 certhash='baf9926b466e8565217b5e6287c97973dcd54874' appid='{ab3c58f7-8316-42e3-bc6e-771d4ce4b201}' 
```

* * *

## 回答 #2

> 赞同：17
> 
>             
> 
> 时间：2010-10-17T16:56:13.710

这对我帮助很大：Sukesh Ashok Kumar 编写的简单指南，用于从命令行为 IIS 设置 SSL。`certutil`包括使用/导入/生成证书`makecert`。

[http://www.awesomeideas.net/post/How-to-configure-SSL-on-IIS7-under-Windows-2008-Server-Core.aspx](http://www.awesomeideas.net/post/How-to-configure-SSL-on-IIS7-under-Windows-2008-Server-Core.aspx)

编辑：如果原始 URL 已关闭，它仍然可以[通过 Wayback Machine](https://web.archive.org/web/20131128023715/http://www.awesomeideas.net/post/How-to-configure-SSL-on-IIS7-under-Windows-2008-Server-Core.aspx)获得。

* * *

## 回答 #3

> 赞同：9
> 
>             
> 
> 时间：2012-08-07T19:55:32.703

使用 PowerShell 和 WebAdministration 模块，您可以执行以下操作以将 SSL 证书分配给 IIS 站点：

```
# ensure you have the IIS module imported
Import-Module WebAdministration

cd IIS:\SslBindings
Get-Item cert:\LocalMachine\My\7ABF581E134280162AFFFC81E62011787B3B19B5 | New-Item 0.0.0.0!443 
```

需要注意的事项...值“7ABF581E134280162AFFFC81E62011787B3B19B5”是您要导入的证书的指纹。所以需要先导入证书存储。该`New-Item`cmdlet 接受 IP 地址（所有 IP 为 0.0.0.0）和端口。

有关更多详细信息，请参阅[http://learn.iis.net/page.aspx/491/powershell-snap-in-configuring-ssl-with-the-iis-powershell-snap-in/](http://learn.iis.net/page.aspx/491/powershell-snap-in-configuring-ssl-with-the-iis-powershell-snap-in/)。

我已经在 Windows Server 2008 R2 以及 Windows Server 2012 预发行版中对此进行了测试。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2011-12-01T00:29:52.050

@David 和 @orip 说得对。  

但是，我确实想提一下，示例中指定的**ipport**参数 (0.0.0.0:443) 是 MSDN 所称的“未指定地址（IPv4：0.0.0.0 或 IPv6：[::]）”。

我去查了，所以我想我会在这里记录以节省其他人的时间。本文重点介绍 SQL Server，但信息仍然相关：

[http://msdn.microsoft.com/en-us/library/ms186362.aspx](http://msdn.microsoft.com/en-us/library/ms186362.aspx)

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2018-01-12T09:33:05.293

使用这篇文章的答案，我创建了一个脚本来为我解决问题。它从 pfx 文件开始，但您可以跳过该步骤。

这里是：

```
cd C:\Windows\System32\inetsrv

certutil -f -p "pa$$word" -importpfx "C:\temp\mycert.pfx"

REM The thumbprint is gained by installing the certificate, going to cert manager > personal, clicking on it, then getting the Thumbprint.
REM Be careful copying the thumbprint. It can add hidden characters, esp at the front.
REM appid can be any valid guid
netsh http add sslcert ipport=0.0.0.0:443 certhash=5de934dc39cme0234098234098dd111111111115 appid={75B2A5EC-5FD8-4B89-A29F-E5D038D5E289}

REM bind to all ip's with no domain. There are plenty of examples with domain binding on the web
appcmd set site "Default Web Site" /+bindings.[protocol='https',bindingInformation='*:443:'] 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2019-12-02T22:50:32.173

如果您尝试在不使用 MMC 管理单元 GUI 的情况下执行 IIS 管理，则应使用 powershell WebAdministration 模块。  

此博客上的其他答案不适用于更高版本的 Windows Server (2012)

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2020-03-25T19:47:57.490

使用`PowerShell`+ `netsh`：

```
$certificateName = 'example.com'
$thumbprint = Get-ChildItem -path cert:\LocalMachine\My | where { $_.Subject.StartsWith("CN=$certificateName") } | Select-Object -Expand Thumbprint
$guid = [guid]::NewGuid().ToString("B")
netsh http add sslcert ipport="0.0.0.0:443" certhash=$thumbprint certstorename=MY appid="$guid" 
```

如果您需要命名绑定，请将`netsh`call 替换为：

```
netsh http add sslcert hostnameport="$certificateName:443" certhash=$thumbprint certstorename=MY appid="$guid" 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2021-12-15T16:12:05.537

使用 IISAdministration 1.1.0.0 ( [https://www.powershellgallery.com/packages/IISAdministration/1.1.0.0](https://www.powershellgallery.com/packages/IISAdministration/1.1.0.0) )，您可以使用以下代码将新的 HTTPS 绑定添加到特定站点：

```
$thumbPrint = (gci Cert:\localmachine\My | Where-Object { $_.Subject -Like "certSubject*" }).Thumbprint
New-IISSiteBinding -Name "Site Name" -BindingInformation "*:443:" -CertificateThumbPrint $thumbPrint -CertStoreLocation My -Protocol https 
```

查看现有绑定

```
Get-IISSiteBinding -Name "Site Name" 
```

删除现有绑定

```
Remove-IISSiteBinding -Name "Site Name" -BindingInformation "*:443:" -Protocol https -Confirm:$False 
```

# sql - 按子句顺序使用布尔表达式

> ID：591608
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-02-26T17:39:56.807
> 
>         
> 
> 标签：sql, mysql, postgresql

我有一个 order by 子句，如下所示：

```
( user_id <> ? ), rating DESC, title 
```

在哪里 ？替换为当前用户的 id。

在 postgresql 上，这给了我正在寻找的顺序，即按当前用户，然后是最高评级，然后是标题（按字母顺序）。

但是在 MySQL 上，我得到一个不清楚的顺序，当前用户既不是第一个也不是最后一个，也不是按评级或标题。

跨数据库兼容性的唯一选择是用 CASE WHEN .. THEN .. ELSE .. END 语句替换这个快速而肮脏的布尔表达式吗？

编辑：感谢大家的帮助，正如 Chaos 和 Chad Birch 正确指出的那样，问题出在其他地方*（特别是我使用上述查询的结果作为下一个查询的输入 - 然后表现得惊讶于第一个的顺序丢失了；）*

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-02-26T22:41:24.383

MySQL 没有*真正*的布尔概念，只是将`TRUE`和分别映射到`FALSE`数值。`1``0`

在这种情况下`user_id <> ?`，将为表中的大多数行返回 0，为其他行返回 1。默认排序顺序是`ASC`，这意味着您想要的行很可能位于结果集的**底部**`0/FALSE`（在*前面* `1/TRUE`）。尝试修改您的查询以适应这种情况。

```
( user_id <> ? ) DESC, rating DESC, title 
```

假设这确实是问题所在，则可以轻松实现跨数据库兼容性。

```
IF(user = ?, 0, 1), rating DESC, title 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T18:24:15.547

你可以尝试做一个

```
select (user_id <> ?), user_id 
```

看看你得到了正确的真/假值。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T17:56:47.500

我在 mysql 中测试了几个变体，它们都正常工作（你期望的方式）。我想你的问题必须在查询以外的地方。为了自己验证，我建议直接从 mysql 客户端运行等效查询。

# java - Java 1.5 中的 JTable 对行进行排序

> ID：591610
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-26T17:40:17.370
> 
>         
> 
> 标签：java, jtable

是否有一种简单的方法可以使用 Java 1.5（`setAutoCreateRowSorter`并且`TableRowSorter`似乎是 Java 1.6 功能）对 JTable 中的行进行排序？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-10-25T22:18:56.103

Java 1.5 中的排序只能通过库进行。

例如，使用 Kaarel 中提到的 JXTable 或[此处](http://www.vlsolutions.com/en/documentation/articles/jtable/index.php)的 VLTable 。

另一个好的图书馆是[glazedlists](http://publicobject.com/glazedlists/)

它也用于 Spring Rich Client 项目。

甚至有一些方法可以将[Glazed Lists 与 JXTable 结合使用](http://sites.google.com/site/glazedlists/documentation/swingx)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T17:42:05.273

使用[SwingX](http://swinglabs.org)`JXTable`项目中的，参见例如

*   [SwingLabs：如何使用 SwingX JXTable：对行进行排序](http://wiki.java.net/bin/view/Javadesktop/SwingLabsSwingXJXTableHowTo#RowSorting) 

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-10-22T13:25:11.247

JXTable 需要一个大包，并且很难获得正确的版本。（Java 1.5 不高于 1.0 版）。

改用 TableSorter.java。获取它：

[http://ouroborus.org/java/2.1/TableSorter.java](http://ouroborus.org/java/2.1/TableSorter.java)

并将其插入您的项目中。

现在您将 tableModel 包装在 TableSorter 的一个实例中，并将其插入到 JTable 中。TableSorter 充当 JTable 实例和您的 tableModel 的“中间人”。

像这样使用它（代码未经测试）：

```
JTable myTable = new JTable();
TableSorter mySorter = new TableSorter(myTableModel, myTable.getTableHeader());
myTable.setTableModel(mySorter); 
```

您可以像这样以编程方式设置sprting：

```
mySorter.setSortingStatus(0,TableSorter.ASCENDING); 
```

尝试 tweeking`MouseHandler.mouseClicked()`让它在单击顺序中跳过 NOT_SORTED 选项，并与渲染器混淆以获得更好的列标题以及三角形的放置和可见性。

# web-services - 如何准确确定访问者访问我网站的位置？

> ID：591613
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-02-26T17:41:21.063
> 
>         
> 
> 标签：web-services, web-applications, geolocation

我需要一种一致且可靠的方法来确定访问我网站的计算机的位置（州/省、国家/地区等），使用以下任何方法：

*   PHP

*   JavaScript

*   MySQL

*   任何网络服务

*   有什么我没有想到的？

我不是在**寻找**锁定的第 3 方统计程序，例如 Google Analytics。它已经在使用并且做了很多很棒的事情，但是我需要对信息进行代码级访问。

理想的解决方案应该允许我提供所需的任何信息（例如 IP 地址）并尽可能准确地获取有关访问的信息。获得原籍国是最低要求，但是诸如州，经纬度，城市等的附加信息会很好。

澄清：我需要能够在 PHP 代码中定期使用这些信息。不只是在某个地方查看它。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-02-26T17:44:10.497

它被称为“地理定位”，[之前已经介绍过](https://stackoverflow.com/questions/37015/how-can-i-find-a-users-location-based-on-their-ip-address-free-and-not-free-s)。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T17:48:09.067

如果你的意思是 100% 的可靠性，它就不存在。但是你可以使用 MaxMind 进行地理定位，如果可靠意味着低于 100%。他们有一个开源版本：

[http://www.maxmind.com/app/geolitecity](http://www.maxmind.com/app/geolitecity)

如果您需要更准确的结果，还有一项付费服务​​。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T17:46:24.593

[Hostip.info](http://www.hostip.info/use.html)提供免费的 IP GeoLookup API 供您在应用程序中使用。但是，由于易于代理，IP 查找不会保持一致或可靠。任何从代理后面访问您的网站的人都可能会被错误地报告。

但是，这是您可以使用 IP 做的最好的事情。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T17:49:33.150

只针对乡村地区。[Geoip 库](http://www.maxmind.com/app/api)很有用。

linux中甚至还有一个命令行程序。

您还可以使用 PHP 脚本获取环境变量。

[这是我不久前写的用于显示](http://directfreight.com/jeremy/discovery.pl)变量的 Perl 脚本。没有什么花哨。

```
#!/usr/bin/perl

print 'Content-type: text/HTML' . "\n\n";
print "<body><center>";
print "<table border=1>";
print '<tr><td>' . $_ . "<td>" . $ENV{$_} . "<br>\n" foreach sort (keys(%ENV)) ; 
```

可以看到浏览器

# javascript - 重置或清除 Javascript 对象的正确方法？

> ID：591619
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-26T17:42:39.033
> 
>         
> 
> 标签：javascript, function, object, reset

我有一个 Javascript 类，其中包含一些函数和成员对象：

```
function MyUtils()
{
  // Member Variables (Constructor)
  var x = getComplexData();
  var y = doSomeInitialization();

  // Objects
  this.ParamHash = function()
  {
    // Member variables
    this.length = 0;
    this.items = new Array();

    // Constructor
    for (var i = 0; i < arguments.length; i += 2)
    {
      // Fill the items array.
      this.items[arguments[i]] = arguments[i+1];
      this.length++;
    }
  }

  // Functions
  this.doSomething = function()
  {
    // Do something.
    // Uses the items in the ParamHash object.
    for (var i in this.ParamHash.items)
    {
      // Really do something!
    }

    // Clear the ParamHash object -- How??
  }
} 
```

这是通过以下方式调用的：

```
// First call - works fine.
var utils = new MyUtils();
utils.paramHash = new utils.ParamHash("a", 1, "b", 2);
utils.doSomething();

// Don't want to re-initialize.
// utils = new MyUtils();

// Consequent call - crashes ["Object doesn't support this action."].
utils.paramHash = new utils.ParamHash("c", 3);
utils.doSomething(); 
```

问题源于我想在`utils`整个代码中重用同一个对象而不必重新初始化它的限制。另外，我希望每次调用 ParamHash 对象时都从头开始重新创建它。但是，对 ParamHash 构造函数的后续调用会引发错误“对象不支持此操作”。在这个阶段，我可以看到 utils.paramHash 对象仍然包含旧值（“a”、“b”）。

我尝试了各种方法来清除 ParamHash 对象，例如将其项目和长度设置为 null，从数组中弹出项目。`doSomething()`在我使用以下方式（在函数中）之前，似乎没有任何效果：

```
this.paramHash.items = new Array();
this.paramHash.length = 0; 
```

这似乎是错误的，因为如果我有很多成员变量怎么办......我必须单独重置每个变量吗？所以，问题是：将对象重置为`ParamHash`初始状态的最佳方法是什么？我肯定希望有一种更清洁/更直接的方式。就像是 ：

```
// Doesn't work! :-(
this.paramHash = new function() {}; 
```

**编辑：我正在寻找一种跨浏览器的解决方案——至少在 IE6+ 和 FF 2+ 中有效。**

* * *

**解决方案：**感谢 Cristoph，我能够通过创建一个单独的变量/属性来做到这一点，`MyUtils`其中仅包含`ParamHash`函数的实例。

```
function MyUtils()
{
  // Same ol' stuff.
  var myParamHash;
}

// First call - works fine.
var utils = new MyUtils();
utils.myParamHash = new utils.ParamHash("a", 1, "b", 2);
utils.doSomething();

// Consequent call - works fine now.
utils.myParamHash = new utils.ParamHash("c", 3);
utils.doSomething(); 
```

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T17:57:24.927

这

```
utils.ParamHash = new utils.ParamHash("a", 1, "b", 2); 
```

`ParamHash()`用实例对象覆盖包含构造函数的属性。您可以通过以下方式获取构造函数

```
utils.ParamHash.constructor 
```

但更简洁的方法是首先不覆盖它并使用单独的属性来保存实例。

* * *

我不知道 Cerebrus 试图解决的确切问题，所以他的所作所为可能有正当的理由。但在我看来，他的解决方案过于复杂。我会做这样的事情：

```
function MyUtils() {
    this.x = getComplexData();
    this.y = doSomeInitialization();
    this.params = {};
}

MyUtils.prototype.doSomething = function() {
    for(var prop in this.params) {
        if(this.params.hasOwnProperty(prop)) {
            // do stuff
        }
    }
};

var utils = new MyUtils;
utils.params = { a : 1, b : 2 };
utils.doSomething(); 
```

`hasOwnProperty()`如果您可以确定没有人弄乱`Object.prototype`.

* * *

一些额外的评论：

*   在 JavaScript 中，通常只有构造函数的名称大写

*   `items`不应该是一个数组，而是一个普通的对象，即`this.items = {};`

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T17:57:36.453

当你这样做时

```
utils.ParamHash = new utils.ParamHash("a", 1, "b", 2); 
```

您将 ParamHash 构造函数替换为对象实例。随后`new ParamHash()`失败，因为 utils.ParamHash 不再是构造函数。

试试这个：

```
var utils = new MyUtils();
utils.paramHashInstance = new utils.ParamHash("a", 1, "b", 2);
utils.DoSomething(); 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T17:49:35.193

您是否尝试过省略 new 关键字？

```
utils.ParamHash = utils.ParamHash("c", 3); 
```

# java - Thread.getId() 全局唯一性问题

> ID：591627
> 
>         
> 
> 赞同：13
> 
>         
> 
> 时间：2009-02-26T17:44:11.853
> 
>         
> 
> 标签：java, multithreading, uniqueidentifier

如果多个 Java 应用程序在一个系统上运行，那么每个线程 ID 是否相对于所有其他 Java 线程是唯一的，无论它们在哪个应用程序中运行？

Java 应用程序相对于其他 Java 应用程序应该是沙盒的，所以我认为线程 ID 可能会发生冲突。

如果线程 ID 在所有应用程序中都是唯一的，那不会泄露一些（尽管非常少）有关系统上其他应用程序的信息吗？例如在其他应用程序中启动了多少线程，或者即使其他 Java 应用程序正在运行？

* * *

## 回答 #1

> 赞同：24
> 
>             
> 
> 时间：2009-02-26T17:50:24.257

好吧，让我检查一下来源。

在`Thread`'s`init`方法中（由每个构造函数调用）：

```
/* Set thread ID */
tid = nextThreadID(); 
```

在`nextThreadID()`：

```
private static synchronized long nextThreadID() {
    return ++threadSeqNumber;
} 
```

和：

```
/* For generating thread ID */
private static long threadSeqNumber; 
```

`threadSeqNumber`初始化为 0（默认`long`值），因此返回的第一个值`nextThreadID`是 1。

因此，线程 ID 编号始终从 1 开始并以 1 递增。换句话说，您的问题的答案是它们*不是*全局唯一的。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-02-26T17:51:21.023

根据 JDK 源，线程 ID 在给定的 JVM 中是唯一的 - 实际上，它只是作为运行序列实现的。

这是 1.6.0_10 中的 nextThreadID() 方法：

```
private static synchronized long nextThreadID() {
    return ++threadSeqNumber;
} 
```

（实际上可能有一个很长的溢出错误，大概它从未真正发生过）

# logging - 文件中日志信息的开销

> ID：591632
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T17:44:53.973
> 
>         
> 
> 标签：logging, file, overhead

我正在做一些长时间的模拟，可能需要几个小时到几天的时间，并且我正在将信息记录到文件中。这些文件可以达到数百 Mb 的大小，并且里面只有一个数字列表。我真的很担心由此产生的开销。我想问一下使用这种方法的开销是否真的很大，是否有其他更有效的方法可以做到这一点，只需记录信息。

我正在使用 C++ 并记录文件，我只使用 fprintf 的常用方法。为了解释开销，如果你可以给出一个类似于使用文件的实际示例，这次使用文件而不使用它们，那将是理想的。

我做了一些测试，但我不知道开销是否随文件大小线性增长。我要说的是，在大小为 1Mb 的文件中添加一行可能与在大小为 1Gb 的文件中添加一行不同。有谁知道开销如何随着文件的大小而增长？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-26T17:54:49.753

我认为你只需要一些粗略的计算。

让“数百 Mb”为 400MB。

让“几个小时到几天”为 48 小时。

(400 * 1024 * 1024 字节) / (3600 * 48 秒) = 2427 字节/秒

显然，您可以只观察您的系统或使用实数进行计算，但使用上面的粗略估计，您记录的速度约为 2KB/秒，与平均硬盘驱动器限制相比，这是微不足道的。

所以，不，开销似乎不是很大。是的，有更有效的方法可以做到这一点，但你可能会花费更多的时间和精力来获得微不足道的节省，除非你的数字与你所说的有很大不同。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T17:50:19.373

“数百兆字节”在几天内可能无关紧要。数百 GB 可能很重要，但可能仍然不会很大。

但是，有一种明显的方法可以为您的确切应用程序找出答案：在打开日志记录的情况下运行模拟，并对其计时。然后在关闭日志记录的情况下运行它（使用相同的输入）并计时。比较差异。理想情况下，这样做几次以抵消其他干扰。我怀疑您会发现大量日志记录的潜在好处远远超过对性能的影响。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:07:07.943

您可以将数据放入 STL 向量中并对数据进行一些分析，例如：

- 排除重复的行；

- 只保存差异；

- 一段时间后刷新数据；

- 选择要保存的特定数据；

- ETC...

# php - geoip + pecl + 64 位框

> ID：591637
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T17:45:54.547
> 
>         
> 
> 标签：php, 64-bit, pecl

有没有人尝试在 64 位机器上通过 pecl 安装 geoip？

我可以在我的 32 位 Fedora 盒子上使用这些命令很好地安装 geoip。我不能在 64 位版本上。任何想法为什么？

yum install make gcc cpp gcc-c++ glibc glibc-headers php-pear php-devel geoip geoip-devel

pecl安装geoip

=> 在 64 位版本上，它在此处中断并显示以下消息：

在 /var/tmp/geoip/geoip.c:32 中包含的文件中：/var/tmp/geoip/php_geoip.h:62:22: 错误：运算符 '>=' 没有左操作数 (...) make： *** [geoip.lo] 错误 1 ​​错误：“制作”失败

谢谢你的评论，弗兰基

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-24T12:01:15.390

他们有一个错误，但现在已在 PECL 上修复。

没有什么比开源更能让你开心的了。

感谢开发者。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2020-10-21T14:14:23.190

我有同样的问题，但在尝试安装 Beta 版本后问题解决了

```
pecl install geoip-beta 
```

# bash - 在服务器上打开另一个外壳？

> ID：591642
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-26T17:46:52.593
> 
>         
> 
> 标签：bash, terminal, buffer

当我通过 ssh 在我的服务器上时，如何打开另一个终端？

我不想输入两次密码来为我的服务器获取另一个终端。

也许，Bash 具有与 Vim 类似的缓冲区。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-26T17:48:48.160

查看[GNU 屏幕](http://www.gnu.org/software/screen/)。它使用起来有点晦涩难懂，但可以满足您的需求，而且它可能也安装在您的服务器上。

您还可以转发 X11 并运行多个`xterm`实例，但这很痛苦。

不过，您最好的选择是众所周知的“每次都输入密码”解决方案：您应该设置 SSH 密钥，这样您就不需要每次都输入密码，然后只需在终端选项卡中使用多个连接即可。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T17:48:59.907

您可以使用类似[GNU Screen](http://www.kuro5hin.org/story/2004/3/9/16838/14935)的东西。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T17:52:34.233

Bash shell 有一个称为作业控制的功能，它允许您运行和管理多个进程。你可以在这里阅读： http: [//commandlinemac.blogspot.com/2008/12/bash-job-control-fg-bg-jobs-and-ctrl-z.html](http://commandlinemac.blogspot.com/2008/12/bash-job-control-fg-bg-jobs-and-ctrl-z.html)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T17:49:33.463

可以使用[screen](http://www.manpagez.com/man/1/screen/)打开其他终端，无需再次认证。

屏幕也可以分离，以便您可以在注销后保持终端打开并稍后重新连接它们。我在我的家庭服务器上使用它来保持 rtorrent 开放。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T17:49:38.050

[GNU 屏幕](http://en.wikipedia.org/wiki/GNU_Screen)

顺便提一句。如果您不喜欢输入密码，请[尝试 PK auth。](http://en.wikipedia.org/wiki/Secure_Shell#How_SSH_uses_public-key_cryptography) 
[PuTTy 是如何完成的。](http://tartarus.org/~simon/putty-snapshots/htmldoc/Chapter8.html#pubkey) 

# asp.net - 使用 ASP.Net 验证上传文件的内容类型

> ID：591648
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T17:48:53.917
> 
>         
> 
> 标签：asp.net, file

如何在不使用文件扩展名或使用 ASP.Net 的 mime 类型的情况下验证文件内容类型。

我不想使用 mime 类型，因为它似乎是由文件扩展名决定的。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T17:53:24.327

您可以使用 UrlMon.dll 中的 FindMimeFromData() 函数（使用 pinvoke）。

[有关示例](http://www.pinvoke.net/default.aspx/urlmon.FindMimeFromData)，请参阅此页面，有关该函数[的文档，请参阅此 MSDN 页面。](http://msdn.microsoft.com/en-us/library/ms775107.aspx)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:27:27.210

这实际上取决于文件类型。对于许多文件类型，您可以检查文件的标题，它通常在文件中的第一个 0 字符之前。我曾经有一些检查图片类型的代码，所以我可以在某个地方找到它。

但是，有些文件类型没有这种形式的标题，例如 XML（是的，这是一个便宜的例子，但我很容易想到 ;->）。我相信所有图形类型都会有标题，其他二进制文件类型也是如此。

正如安德鲁所提到的，标题不是 100%。但是，如果文件“格式错误”，则不太可能是黑客攻击。它更有可能是损坏的上传或损坏的文件的上传。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T17:53:55.230

没有通用的方法来验证文件是否属于给定的扩展类型。

您可以创建格式白名单（png、jpg、zip 等）并检查文件头以确定它是否符合预期格式。

即使这样也不是万无一失的，因为文件内容本身可能格式错误，只有在尝试加载文件时才会变得明显。

# jquery - jQuery Problem with class attribute: Why does this work in 1.2.6 and doesn't on 1.3.1?

> ID：591657
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-26T17:49:47.330
> 
>         
> 
> 标签：jquery

Well... for me it's just the same thing, but I don't know why this
works in 1.2.6 and doesn't in 1.3.1:

```
if ($('.trSelected').length == 2) {
    alert("hello");
} 
```

In this case, I'm selecting rows on flexigrid and used to work just
fine in 1.2.6.

To work in 1.3.1, I had to do this:

```
if ($('#flexDiv .trSelected').length == 2) {
    alert("hello");
} 
```

I had to specify the table from where the trSelected are... why does
Does this happen?

I'm having too many problems with class attributes. For example: If I
have 3 input text with class "test", only the first input text is
functional... the other ones no.
Why?

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:08:52.433

Did you debug what does the $('#flexDiv .trSelected').length return ?

Best thing for javascript debugging is Firebug.

In javascript write:

```
console.log(  $('#flexDiv .trSelected').length  ); 
```

And then look in your Firebug console what do you get.

# optimization - 经典asp的性能提示？

> ID：591658
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-02-26T17:49:58.920
> 
>         
> 
> 标签：optimization, asp-classic

今天我的任务是改进经典 ASP 页面的性能。在 ASP.NET 中重写代码目前不是一种选择，因此我接受了挑战，以挤压我可以从页面中获得的每一盎司性能。

该页面包含基本的“SELECT bla bla FROM bla”到几个记录集。while 循环遍历这些记录集并转储 <tr><td> 字符串。在while循环中有一堆条件和诸如此类的东西。调用了 3 个使用全局变量（不是作为参数传递的局部变量）的子例程。

所以没有什么真正令人震惊的东西。在我开始优化之前，循环大约需要 15 秒才能完成。在 15 秒中，大约 6 秒被 sql 查询占用。

在改变了一些事情之后，我设法把它弄到了 7 秒。

我改变的事情是：

*   我没有做 SELECT *，而是只选择了我需要的列。查询平均下降到 4 秒。这是一个非常繁重的查询，其中包含视图中的视图。

*   我删除了循环内的所有上下文切换。因此，我将 <%= bla %> 之类的内容更改为 Response.Write(bla)。

*   这 3 个子程序被定义为函数，但它们被用作子程序（没有结果）。所以我把函数改成了subs。这有帮助吗？

进行更改后，我发现大部分时间都被其中一个子例程占用。我今天没有足够的时间来更改子例程，但它包含以下内容：

*   日期函数：Dateadd、Datediff

*   数组函数：Ubound(arr) 和索引引用：arr(I)

*   字符串函数：left、mid、right、lower、replace

每次页面调用时，该子例程都会运行大约 1600 次。

有没有人有优化经典asp页面的经验？你有什么好的优化技巧吗？我正在寻找的是改进 do ... 循环语句中的代码。

我是一位经验丰富的 ASP.NET 开发人员，并且对 ASP.NET 的性能改进非常了解。经典 ASP 使用不同的“引擎”，所以我想知道是否有人对提高经典 ASP 的性能有任何见解。

谢谢！

米

PS：是的，我知道经典的 ASP 使用 VBScript

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-02-26T17:58:57.667

[GetRows](http://www.w3schools.com/ado/met_rs_getrows.asp)  这将创建您寻求的速度。以下是我使用过的[其他一些技巧。](http://www.somacon.com/p236.php)

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2012-05-11T07:42:40.813

看到这是一个流行的问题，我决定解释一下我在 3 年前所做的加速 ASP 脚本的事情。

原始脚本大量使用可调整大小的数组来存储键值，因此我修改了该代码以使用 Scriting.Dictionary。例子：

```
Dim myDictionary
Set myDictionary = Createobject("Scripting.Dictionary") 
myDictionary.item("key") = "value" 
```

这比可调整大小的数组快得多。

另一个很大的变化是字符串的连接。原始脚本充满了：

```
S = ""
S = S & "First line<br />"
S = S & "Second line<br />"
S = S & "Third line line<br />"
Response.Write(S) 
```

我将其修改为：

```
Response.Write("First line<br />")
Response.Write("Second line<br />")
Response.Write("Third line<br />") 
```

这产生了巨大的变化。字符串的连接是一个巨大的瓶颈，因为字符串被丢弃然后重新初始化。

另一种选择是：

```
S = "First line<br />" & _
        "Second line<br />" & _
        "Third line line<br />" 
Response.Write(S) 
```

这也是 ASP.NET 的一个很好的提示：使用 StringBuilder 而不是连接字符串。

另一个重要的变化是上下文切换。原始代码充满了：

```
<table>
    <tr>
        <td><%= rs("Col1") %></td>
        <td><%= rs("Col2") %></td>
        <td><%= rs("Col2") %></td>
    </tr>
</table> 
```

3 个上下文切换占用了大量时间，所以我修改为：

```
<%
Response.Write("<table>")
Response.Write("<tr>")
Response.Write("<td>")
Response.Write(rs("Col1"))
Response.Write("</td>")
Response.Write("</tr>")
Response.Write("<tr>")
Response.Write("<td>")
Response.Write(rs("Col2"))
Response.Write("</td>")
Response.Write("</tr>")
Response.Write("<tr>")
Response.Write("<td>")
Response.Write(rs("Col3"))
Response.Write("</td>")
Response.Write("</tr>")
Response.Write("</table>")
%> 
```

是的，代码非常冗余，但性能更好。

另一个小的修改（实际上是一个肮脏的 hack）是在 SQL 查询中使用 WITH (NOLOCK)：

```
conn.Query("SELECT * FROM MyTable WITH (NOLOCK) LEFT JOIN AnotherTable WITH (NOLOCK) ON MyTable.Id = AnotherTable.Id") 
```

它有所作为。

最后，我不知道这是否有多大帮助，但有很多复制粘贴的代码被我重构为干净的函数。

我希望找到此主题的人们会发现这些提示很有用。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-02-26T17:54:15.633

> 每次页面调用时，该子例程都会运行大约 1600 次。

我想说这几乎是整个问题，但是在不知道返回查询的数据的详细信息、该子例程的作用以及*为什么*需要为一个页面执行 1600 次的情况下，很难建议降低它。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-03-04T10:18:19.987

我将 MrChrister 的回答标记为我的问题“你有什么好的优化技巧吗？”的答案。那里的提示很好，它设法将脚本加速了 2 秒。

我最终发现是什么让脚本变慢了。在 while 循环中，程序员做了很多 Filter(Array)。他基本上是使用 Filter(Array) 来查找键/值对。

所以最终的解决方案是将 Filter(Array) 的代码更改为使用“Scripting.Dictionary”对象。它将代码速度提高了 12 倍。

感谢您的回复。

米

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T17:58:29.307

如果你真的认为问题出在那个 1 函数上，为什么不把代码放在这里，以便人们提出优化建议。

* * *

## 回答 #6

> 赞同：-2
> 
>             
> 
> 时间：2009-02-27T03:29:45.440

我体验到，在大多数情况下，在经典 ASP 中使用 StringBuilder 可以获得性能。[ajaxed 库](http://www.ajaxed.org)中的经典 ASP有一个不错的[StringBuilder 实现](http://ajaxed.org/api/#class_18)。它使用.net StringBuilder。这非常酷且易于使用：

```
<%
set output = new StringBuilder
do
  output("some output")
loop
response.write(output.toString())
%> 
```

如果您需要进行一些调整，我建议您使用 ajaxed 库。它设置迅速，并为您提供了许多经典 ASP 的工具。例如，也许您在使用 AJAX 时也可以获得一些性能（或者至少是性能的印象）。

# asp.net - 我如何连接我的 asp.net

> ID：591665
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-26T17:51:22.023
> 
>         
> 
> 标签：asp.net, visual-studio-2008, iis

ASP.NET 的另一个初学者问题：

我正在 Visual Studio 2008 中启动一个 ASP.NET 项目，并希望将其链接到远程服务器上的文件夹（就像它构建/发布到此文件夹一样）。这可能是我的措辞，但我似乎无法弄清楚如何做到这一点（即使有谷歌在我身边！）。

我天真地试图将代码文件上传到服务器，但运行我的代码会产生与页面未设置为应用程序有关的错误。

任何帮助将不胜感激（或指向资源的链接，我可以在其中了解更多关于我不断遇到的基本 asp.net/vs08 的东西）。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T17:53:54.387

在您的 Web 服务器上，您将文件复制到的文件夹需要设置为应用程序或虚拟目录。这是通过控制面板外的“管理工具”中的 Internet 信息服务面板完成的。

根据您使用的 IIS 的风格，该过程可能会有所不同。

Visual Studio 2008 具有发布功能。如果您右键单击 Web 项目，则会出现“发布”选项。然后，您可以选择要发布文件的位置。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T17:58:58.243

2个快速答案：

您可以使用 Visual Studio 中的“发布”选项并在 wwwroot 中创建一个文件夹以进行发布

或者，您可以创建一个简单的安装程序。只需在解决方案中添加一个新的“Web 设置项目”，并将网站的结果添加到设置项目中即可。

当然，您是否尝试过使用谷歌搜索 asp.net 部署以获得一些帮助？

祝你好运！:)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T18:03:52.930

你会喜欢 Visual Studio 2010，它应该在 2010 年初推出，如果它遵循以前的版本。这也意味着几个月前发布 MSDN。为什么？更好地部署故事。

至于我们今天的位置，您可以发布并创建目录。您必须发布到 IIS 而不是目录才能完成此操作。这意味着您必须有权添加和发布 Web 应用程序。

对于目录，您必须在 IIS 管理器中创建应用程序。如果您没有访问权限，请尝试 IIS 管理员。如果您不能让他们这样做，您将返回发布。

# windows - Linux 相当于 DOS“启动”命令？

> ID：591667
> 
>         
> 
> 赞同：23
> 
>         
> 
> 时间：2009-02-26T17:52:06.030
> 
>         
> 
> 标签：windows, linux, scripting

我正在编写一个 ksh 脚本，我必须在单独的命令提示符窗口中运行一个可执行文件。

* * *

## 回答 #1

> 赞同：26
> 
>             
> 
> 时间：2011-06-27T17:14:55.377

`xdg-open`是 linux 中类似的命令行应用程序。

有关其使用的详细信息，请参阅[https://superuser.com/questions/38984/linux-equivalent-command-for-open-command-on-mac-windows](https://superuser.com/questions/38984/linux-equivalent-command-for-open-command-on-mac-windows)。

* * *

## 回答 #2

> 赞同：15
> 
>             
> 
> 时间：2009-02-26T17:57:11.883

我相信你的意思是`xterm -e your.sh &`

不要忘记决赛`&` 

* * *

## 回答 #3

> 赞同：12
> 
>             
> 
> 时间：2009-02-26T17:54:37.663

也许它不是一个单独的启动窗口，但您可以使用“&”在后台运行一些可执行文件

例如

```
./myexecutable & 
```

意味着您的脚本不会等到 myexecutable 完成，而是立即继续。也许这就是你要找的。问候

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2012-09-12T10:41:00.077

xdg-open 是 MS windows 命令行启动命令的良好等效项： xdg-open 文件使用其默认应用程序 xdg-open 打开该文件或 url。在默认文件管理器中打开当前文件夹

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T18:01:34.010

最有用的终端会话程序之一是屏幕。

```
screen -dmS title executable 
```

您可以通过运行列出所有屏幕会话

```
screen -ls 
```

您可以通过运行连接到您创建的屏幕会话（也允许多个同时/同步的会话）

```
screen -x title 
```

这将在当前运行的窗口中打开模拟终端`executable`。您可以通过按 Ca Cd 来分离屏幕会话，并且可以根据需要多次重新连接。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T18:06:15.700

如果您真的希望您的程序在新的终端窗口中启动，您可以执行以下操作：xterm yourtextmodeprogram 或 gnome-terminal -e yourtextmodeprogram 或 konsole -e mc

问题是你不能指望安装一个特定的终端模拟器，所以（再次：如果你*真的*想这样做）你需要寻找常见的，然后执行遇到的第一个。

正如 Joachim 所提到的：执行此操作的正常方法是将命令置于后台（如果您想更深入地挖掘，请在某处阅读有关 shell 作业控制的信息）。

在某些情况下，您希望启动一个持久的 shell，即当您关闭终端窗口时，一个 shell 会话仍然存在。有两种方法可以做到这一点：

*   面向批处理：nohup 命令运行 &

*   互动：屏幕

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T17:59:06.030

如果您想要一个新窗口，只需启动终端应用程序的新实例：在 kde 中

```
konsole -e whatever 
```

我确定 Gnome 终端有类似的选项

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T18:05:26.233

有些人建议在后台使用 & 启动它，但请注意，这仍会将所有控制台输出从您启动的应用程序发送到您启动它的终端。此外，如果您关闭初始终端，您加载的程序将结束。

如果您使用的是 KDE 或 GNOME 等桌面环境，我会检查 alt+f2 启动应用程序（gnome-open 是 GNOME 的应用程序，我不知道 KDE 应用程序的名称），看看是否可以将要启动的命令作为参数传递给他们。

此外，如果您打算启动一个守护进程，您应该查看[nohup](http://en.wikipedia.org/wiki/Nohup)文档。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2021-10-22T00:53:50.953

我用作`nohup`以下命令并且它有效：

`nohup <your command> &`

然后按回车键！不要忘记最后一个`&`

例如，我运行了一个侦听端口 5000 的 python 代码：
`nohup python3 -W ignore mycode.py &`
然后我确保运行通过`netstat -tulnp | grep :5000`它就可以了。

# delphi - 如何在 Mac 的 Lazarus 中执行相当于 shellexecute() 的操作？

> ID：591678
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-02-26T17:54:39.767
> 
>         
> 
> 标签：delphi, macos, pascal, lazarus

如何`shellexecute()`在 Mac 上执行与 Lazarus 中的等效操作？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-03-05T19:26:49.910

{ 这是执行此操作的代码。使用 TProcess 对象！}

```
uses Process;

...

procedure DoProcess;
Var
  Proc : TProcess;

Begin
  Proc := TProcess.Create(nil);
  try
    Proc.CommandLine := '/Applications/MyApp.app';

    PRoc.Options := Proc.Options + [poWaitOnExit];
    Proc.CommandLine := Proc.CommandLine + ' -someparam';
    PRoc.Execute;
  finally
    Proc.free;
  end;  
End; 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-27T05:22:06.887

我不知道 Lazarus 库是否已经包含此功能，但如果没有，您可以使用[Launch Services Programming Guide](http://developer.apple.com/documentation/Carbon/Conceptual/LaunchServicesConcepts/LSCIntro/chapter_1_section_1.html)中的信息编写条件编译的*ShellExecute()*版本。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2011-09-19T10:43:47.767

如果您想使用 ShellExecute 打开带有首选应用程序的文档，则可以使用 LCLIntf 单元中的 OpenDocument 过程。

Lazarus 转换工具也使用这个替代 ShellExecute，请参阅[Lazarus wiki](http://wiki.lazarus.freepascal.org/Delphi_Converter_in_Lazarus#Function_call_replacement)。如 RobS 所述，它在内部使用 open。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-27T09:06:09.640

我已经成功地`Shell('open ' + Filename)`在 OS X 10.4 和 10.3 中使用，这对于大多数文件类型来说似乎工作得相当好。

我在 shell 提示符下偶然发现`open`，现在在 cygwin/linux 等中错过了它。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-26T17:27:26.143

叉子在 Mac 上很痛。BSD 使用 vfork，而不是 fork。

# c# - Using C#, how do you check if a computer account is disabled in active directory?

> ID：591681
> 
>         
> 
> 赞同：13
> 
>         
> 
> 时间：2009-02-26T17:55:07.270
> 
>         
> 
> 标签：c#, active-directory, ldap

How do you check if a computer account is disabled in Active Directory using C#/.NET

* * *

## 回答 #1

> 赞同：26
> 
>             
> 
> 时间：2009-02-26T18:16:43.927

尝试这个：

```
class Program
{
    static void Main(string[] args)
    {
        const string ldap = "LDAP://your-ldap-server-here";

        using (DirectoryEntry conn = new DirectoryEntry(ldap))
        {
            using (DirectorySearcher searcher = new DirectorySearcher(conn))
            {
                searcher.Filter = "(|(samAccountName=userA)(samAccountName=userB))";
                searcher.PropertiesToLoad.Add("samAccountName");
                searcher.PropertiesToLoad.Add("userAccountControl");

                using (SearchResultCollection results = searcher.FindAll())
                {
                    foreach (SearchResult result in results)
                    {
                        int userAccountControl = Convert.ToInt32(result.Properties["userAccountControl"][0]);
                        string samAccountName = Convert.ToString(result.Properties["samAccountName"][0]);
                        bool disabled = ((userAccountControl & 2) > 0);

                        Console.WriteLine("{0} ({1:x}) :: {2}", samAccountName, userAccountControl, disabled);
                    }
                }
            }
        }

        Console.ReadLine();
    }
} 
```

`userAccountControl`如果帐户被禁用，第二位将为 1。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-02-26T17:59:58.180

Try this entry:

[http://www.codeproject.com/KB/system/everythingInAD.aspx#42](http://www.codeproject.com/KB/system/everythingInAD.aspx#42)

You will want to examine the User Account Control flags.

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-05-02T21:18:18.923

如果您使用的是 .NET 3.5，则可以使用新的 System.DirectoryServices.AccountManagment 命名空间方法来更轻松地访问 Active Directory。UserPrincipal 对象有一个 Enabled 属性，可以为您提供所需的内容。

2008 年 1 月的 MSDN 杂志对这些例程进行了很好的概述。您可以在此处在线阅读文章：[在 .NET Framework 3.5 中管理目录安全主体](http://msdn.microsoft.com/en-us/magazine/cc135979.aspx)

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2010-12-13T12:26:36.247

Leandro López 的回答很酷并且有效......另一个选择是我们可以为 userAccountControl 执行一个 LINQ，其值为 disable 并禁用这些用途

userAccountControl 的回复是：

512 启用帐户

514 禁用帐户

544 已启用，不需要密码

546 已禁用，不需要密码

66048 已启用，密码不会过期

66050 已禁用，密码不会过期

66080 已启用，密码不会过期且不需要

66082 已禁用，密码不会过期且不需要

262656 已启用，需要智能卡

262658 已禁用，需要智能卡

262688 已启用，需要智能卡，不需要密码

262690 已禁用、需要智能卡、不需要密码

328192 已启用，需要智能卡，密码不会过期

328194 已禁用，需要智能卡，密码不会过期

328224 已启用，需要智能卡，密码不会过期且不需要

328226 已禁用，需要智能卡，密码不会过期且不需要

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-03-05T14:51:12.083

不检查位，添加：

(userAccountControl:1.2.840.113556.1.4.803:=2)

到您的过滤器应该只返回禁用的用户。当然，

(!userAccountControl:1.2.840.113556.1.4.803:=2)

如果您愿意走这条路，将确保不会禁用用户。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2011-03-17T21:13:20.430

嘿，我终于明白了 :) 这是我的代码希望它可以帮助你

常量 int ADS_UF_ACCOUNTDISABLE = 0x00000002;

```
 DirectoryEntry de = new DirectoryEntry();
        de.Path = "LDAP://companyname.com";
        DirectorySearcher objADSearcher = new DirectorySearcher(de);
        de.AuthenticationType = AuthenticationTypes.Secure;

        objADSearcher.SearchRoot = de;
        objADSearcher.Filter = "(SAMAccountName=" + TextBox1.Text + ")";
        SearchResult results = objADSearcher.FindOne();
        if (results.ToString() !="")
        {

           int flags= Convert.ToInt32(results.Properties["userAccountControl"][0].ToString()); 
```

//供参考结果.Properties["userAccountControl"][0].ToString().Equals("514");

```
 if (Convert.ToBoolean(flags & ADS_UF_ACCOUNTDISABLE))
           {
               Response.Write("Account Disabled");
           } 
```

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2016-09-26T18:35:27.793

您可以通过将结果转换为枚举来轻松解码 userAccountControl 属性。

```
int userAccountControlValue = 544;
UserAccountControl userAccountControl = (UserAccountControl) userAccountControlValue;

// This gets a comma separated string of the flag names that apply.
string userAccountControlFlagNames = userAccountControl.ToString();

// This is how you test for an individual flag.
bool isNormalAccount = (userAccountControl & UserAccountControl.NORMAL_ACCOUNT) == UserAccountControl.NORMAL_ACCOUNT;
bool isAccountDisabled = (userAccountControl & UserAccountControl.ACCOUNTDISABLE) == UserAccountControl.ACCOUNTDISABLE;
bool isAccountLockedOut = (userAccountControl & UserAccountControl.LOCKOUT) == UserAccountControl.LOCKOUT; 
```

您还可以使用它来构建 LDAP 过滤器：

```
// To get a user that is disabled.
string ldapFilter = string.Format("(&(objectCategory=person)(objectClass=user)(sAMAccountName={0})(userAccountControl:1.2.840.113556.1.4.803:={1:D}))", accountName, UserAccountControl.ACCOUNTDISABLE)

// To get a user that is not disabled.
string ldapFilter = string.Format("(&(objectCategory=person)(objectClass=user)(sAMAccountName={0})(!(userAccountControl:1.2.840.113556.1.4.803:={1:D})))", accountName, UserAccountControl.ACCOUNTDISABLE) 
```

另请参阅[Active Directory：LDAP 语法过滤器](http://social.technet.microsoft.com/wiki/contents/articles/5392.active-directory-ldap-syntax-filters.aspx)以获取常用 Active Directory LDAP 过滤器的示例。

这是您想要的枚举定义：

```
/// <summary>
/// Flags that control the behavior of the user account.
/// </summary>
[Flags()]
public enum UserAccountControl : int
{
    /// <summary>
    /// The logon script is executed. 
    ///</summary>
    SCRIPT = 0x00000001,

    /// <summary>
    /// The user account is disabled. 
    ///</summary>
    ACCOUNTDISABLE = 0x00000002,

    /// <summary>
    /// The home directory is required. 
    ///</summary>
    HOMEDIR_REQUIRED = 0x00000008,

    /// <summary>
    /// The account is currently locked out. 
    ///</summary>
    LOCKOUT = 0x00000010,

    /// <summary>
    /// No password is required. 
    ///</summary>
    PASSWD_NOTREQD = 0x00000020,

    /// <summary>
    /// The user cannot change the password. 
    ///</summary>
    /// <remarks>
    /// Note:  You cannot assign the permission settings of PASSWD_CANT_CHANGE by directly modifying the UserAccountControl attribute. 
    /// For more information and a code example that shows how to prevent a user from changing the password, see User Cannot Change Password.
    // </remarks>
    PASSWD_CANT_CHANGE = 0x00000040,

    /// <summary>
    /// The user can send an encrypted password. 
    ///</summary>
    ENCRYPTED_TEXT_PASSWORD_ALLOWED = 0x00000080,

    /// <summary>
    /// This is an account for users whose primary account is in another domain. This account provides user access to this domain, but not 
    /// to any domain that trusts this domain. Also known as a local user account. 
    ///</summary>
    TEMP_DUPLICATE_ACCOUNT = 0x00000100,

    /// <summary>
    /// This is a default account type that represents a typical user. 
    ///</summary>
    NORMAL_ACCOUNT = 0x00000200,

    /// <summary>
    /// This is a permit to trust account for a system domain that trusts other domains. 
    ///</summary>
    INTERDOMAIN_TRUST_ACCOUNT = 0x00000800,

    /// <summary>
    /// This is a computer account for a computer that is a member of this domain. 
    ///</summary>
    WORKSTATION_TRUST_ACCOUNT = 0x00001000,

    /// <summary>
    /// This is a computer account for a system backup domain controller that is a member of this domain. 
    ///</summary>
    SERVER_TRUST_ACCOUNT = 0x00002000,

    /// <summary>
    /// Not used. 
    ///</summary>
    Unused1 = 0x00004000,

    /// <summary>
    /// Not used. 
    ///</summary>
    Unused2 = 0x00008000,

    /// <summary>
    /// The password for this account will never expire. 
    ///</summary>
    DONT_EXPIRE_PASSWD = 0x00010000,

    /// <summary>
    /// This is an MNS logon account. 
    ///</summary>
    MNS_LOGON_ACCOUNT = 0x00020000,

    /// <summary>
    /// The user must log on using a smart card. 
    ///</summary>
    SMARTCARD_REQUIRED = 0x00040000,

    /// <summary>
    /// The service account (user or computer account), under which a service runs, is trusted for Kerberos delegation. Any such service 
    /// can impersonate a client requesting the service. 
    ///</summary>
    TRUSTED_FOR_DELEGATION = 0x00080000,

    /// <summary>
    /// The security context of the user will not be delegated to a service even if the service account is set as trusted for Kerberos delegation. 
    ///</summary>
    NOT_DELEGATED = 0x00100000,

    /// <summary>
    /// Restrict this principal to use only Data Encryption Standard (DES) encryption types for keys. 
    ///</summary>
    USE_DES_KEY_ONLY = 0x00200000,

    /// <summary>
    /// This account does not require Kerberos pre-authentication for logon. 
    ///</summary>
    DONT_REQUIRE_PREAUTH = 0x00400000,

    /// <summary>
    /// The user password has expired. This flag is created by the system using data from the Pwd-Last-Set attribute and the domain policy. 
    ///</summary>
    PASSWORD_EXPIRED = 0x00800000,

    /// <summary>
    /// The account is enabled for delegation. This is a security-sensitive setting; accounts with this option enabled should be strictly 
    /// controlled. This setting enables a service running under the account to assume a client identity and authenticate as that user to 
    /// other remote servers on the network.
    ///</summary>
    TRUSTED_TO_AUTHENTICATE_FOR_DELEGATION = 0x01000000,

    /// <summary>
    /// 
    /// </summary>
    PARTIAL_SECRETS_ACCOUNT = 0x04000000,

    /// <summary>
    /// 
    /// </summary>
    USE_AES_KEYS = 0x08000000
} 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2011-03-31T17:39:40.963

如果您使用 samAcountName 或任何其他身份字段..使用 UserPrincipal.FindByIdentity 方法更简单。并对 Leandro López 和 Deepti 使用混合方法。他们的方法都非常好..但非常狭窄。[MSDN](http://msdn.microsoft.com/en-us/library/aa772300%28VS.85%29.aspx)上提供了有关此标志的更多详细信息

# javascript - How can I dynamically unload a javascript file?

> ID：591685
> 
>         
> 
> 赞同：33
> 
>         
> 
> 时间：2009-02-26T17:57:04.303
> 
>         
> 
> 标签：javascript

I am including pages using Ajax but I also need to include their respective javascript files, which requires removing the previous javascript files from memory at the same time.

How can I unload the currently-loaded javascript files (as well as their code in memory) so that I can load the new page's files? They will more than likely conflict, so having multiple independent files' javascript files loaded.

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-02-26T18:15:07.473

这听起来真的像你需要重新评估你的设计。要么你需要放弃 ajax，要么你的方法名不需要冲突。

您可以查看此链接：[http ://www.javascriptkit.com/javatutors/loadjavascriptcss2.shtml](http://www.javascriptkit.com/javatutors/loadjavascriptcss2.shtml)

其中提供了有关如何从 DOM 中删除 javascript 的信息。但是，现代浏览器会将代码留在浏览器的内存中。

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2011-08-03T13:35:15.147

不，你不能那样做。一旦 JavaScript 块加载到浏览器中并执行，它就会存储在相应窗口范围内的浏览器内存中。绝对没有办法卸载它（没有页面刷新/窗口关闭）。

* * *

## 回答 #3

> 赞同：8
> 
>             
> 
> 时间：2013-09-19T18:11:10.643

你可以命名你的代码..这样你就可以防止冲突

> var MyJavaScriptCode = {};
> 
>   
>   
> 
> MyJavaScriptCode.bla = function () {};

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2011-08-10T09:28:42.957

其实这是很有可能的。您可以替换脚本或链接元素。

```
function createjscssfile(filename, filetype){
if (filetype=="js"){ //if filename is a external JavaScript file
  var fileref=document.createElement('script')
  fileref.setAttribute("type","text/javascript")
  fileref.setAttribute("src", filename)
}

else if (filetype=="css"){ //if filename is an external CSS file
  var fileref=document.createElement("link")
  fileref.setAttribute("rel", "stylesheet")
  fileref.setAttribute("type", "text/css")
  fileref.setAttribute("href", filename)
}
  return fileref
}

function replacejscssfile(oldfilename, newfilename, filetype){
var targetelement=(filetype=="js")? "script" : (filetype=="css")? "link" : "none" //determine element type to create nodelist using
var targetattr=(filetype=="js")? "src" : (filetype=="css")? "href" : "none" //determine corresponding attribute to test for
var allsuspects=document.getElementsByTagName(targetelement)
for (var i=allsuspects.length; i>=0; i--){ //search backwards within nodelist for matching elements to remove
    if (allsuspects[i] && allsuspects[i].getAttribute(targetattr)!=null && allsuspects[i].getAttribute(targetattr).indexOf(oldfilename)!=-1){
        var newelement=createjscssfile(newfilename, filetype)
        allsuspects[i].parentNode.replaceChild(newelement, allsuspects[i])
    }
  }
} 
```

您必须将文件名参数填写为 src 属性，并将文件类型填写为“js”或“css”

我认为没有必要解释代码。你也曾在 2009 年发过帖，但是嘿。也许有人会需要它吗？:)

所有功劳归于：[http ://www.javascriptkit.com/javatutors/loadjavascriptcss2.shtml](http://www.javascriptkit.com/javatutors/loadjavascriptcss2.shtml)

顺便说一句，你可以在那里学习一些技巧。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2019-01-28T03:27:46.090

可以从浏览器中卸载清除整个代码的 JavaScript 文件。步骤是：

1.  给目标“ **script** ”元素一个ID（例如“ **mainJs** ”，指向“ **main.js** ”）

2.  创建另一个JS文件（例如“ **flush.js ”），在“** **main.js** ”中具有相同的函数和变量，并确保函数和变量内容为空。

3.  在“ **main.js** ”用完后，我们通过删除“ **script#mainJs** ”元素并将“ **flush.js** ”动态加载到DOM树中来刷新它。

例子

```
mainJs    = document.getElementById("mainJs");
document.head.removeChild(mainJS);//Remooves main.js from the DOM tree

flushFile = document.createElement("script");
flushFile.setAttribute("src", "flush.js");
document.head.appendChild(flushFile);//Loads flush.js into the DOM tree, overwriting all functions and variables of main.js in browser memory to null 
```

而已

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2021-12-31T17:55:58.427

正是我和我尝试过的类似要求，但它甚至需要开发人员方面的一个小编码部分。

我有一个包含 20 多个函数的 js 文件，文件名为 profile.js

```
function myprofile(){
//code block A
}  
function updateprofile(){
//code block B
}....
var functionsInJs=["myprofile","updateprofile",...] 
```

现在我写了一个方法来清除这个文件的内存如下

```
function unloadJs(array){
    array.forEach(function(eachJsFn){
         window[eachJsFn]=undefined;//Clearing the functionality of js function in browsers window
    }
} 
```

因此，在卸载 js 函数时，我将在其中传递函数名称数组。

# lotus-notes - 使用 Java API 读取 Lotus Notes 文档

> ID：591693
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-26T17:58:34.143
> 
>         
> 
> 标签：lotus-notes, lotus

我正在使用 Lotus Notes 6.5.1 Java API 来读取 .nsf 文件。.nsf 文件中的每个文档都有多个文档历史记录。在使用 Lotus Notes Java API 遍历 .nsf 文件中的文档时，我将所有文档版本作为单独的文档获取。

如何确保 Lotus Notes 仅检索每个文档的最新版本？有没有办法将文档及其所有版本历史唯一标识为其子项？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-27T11:00:49.723

Notes Domino 中有一个用于对文档进行版本控制的内置功能。根据它在数据库设计中的配置方式（并假设数据库开发人员没有推出自己的版本），版本要么是对原始父级的响应，要么是反过来，新版本成为父级，旧版本是回应。

然而，所有这些都是在您编辑文档时自动为您在数据库中设置响应层次结构。数据库设计的其余部分如何与此层次结构交互取决于开发人员。

您可能想要做的是创建一个仅在响应层次结构顶部显示文档的视图。然后，您可以遍历该视图并知道您从中获得的文档是最新版本。

因此，如果您有使用“文章”表单创建的文档，则视图选择公式将是。

```
SELECT form*="Article" & !@IsAvailable($ref) 
```

这将选择所有不是响应的文章文档。现在在代码中，您可以简单地打开视图并遍历它。

一旦你处理了一个文档，你就可以通过它获得它的直接子响应

```
doc.getResponses() 
```

这将返回一个`DocumentCollection`您可以递归查找响应的响应。您无法直接获取父文档。您首先需要获取其 id，`doc.getParentDocumentUNID()`然后调用`db.getDocumentByUNID()`. 当然，您可以将其结合起来：

```
db.getDocumentByUNID(doc.getParentDocumentUNID()) 
```

在任何情况下，您都必须查看您的数据库实际在做什么，它最初是如何设计的并与之相适应。

# c# - URL-encoded slash in URL

> ID：591694
> 
>         
> 
> 赞同：58
> 
>         
> 
> 时间：2009-02-26T17:58:57.323
> 
>         
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-routing, urlencode

My Map is:

```
routes.MapRoute(
   "Default",                                             // Route name
   "{controller}/{action}/{id}",                          // URL with params
   new { controller = "Home", action = "Index", id = "" } // Param defaults
); 
```

If I use the URL `http://localhost:5000/Home/About/100%2f200` there is no matching route.
I change the URL to `http://localhost:5000/Home/About/100` then the route is matched again.

Is there any easy way to work with parameters that contain slashes? Other escaped values (space `%20`) seem to work.

EDIT:

To encode Base64 works for me. It makes the URL ugly, but that's OK for now.

```
public class UrlEncoder
{ 
    public string URLDecode(string  decode)
    {
        if (decode == null) return null;
        if (decode.StartsWith("="))
        {
            return FromBase64(decode.TrimStart('='));
        }
        else
        {
            return HttpUtility.UrlDecode( decode) ;
        }
    }

    public string UrlEncode(string encode)
    {
        if (encode == null) return null;
        string encoded = HttpUtility.PathEncode(encode);
        if (encoded.Replace("%20", "") == encode.Replace(" ", ""))
        {
            return encoded;
        }
        else
        {
            return "=" + ToBase64(encode);
        }
    }

    public string ToBase64(string encode)
    {
        Byte[] btByteArray = null;
        UTF8Encoding encoding = new UTF8Encoding();
        btByteArray = encoding.GetBytes(encode);
        string sResult = System.Convert.ToBase64String(btByteArray, 0, btByteArray.Length);
        sResult = sResult.Replace("+", "-").Replace("/", "_");
        return sResult;
    }

    public string FromBase64(string decode)
    {
        decode = decode.Replace("-", "+").Replace("_", "/");
        UTF8Encoding encoding = new UTF8Encoding();
        return encoding.GetString(Convert.FromBase64String(decode));
    }
} 
```

EDIT1:

At the end it turned out that the best way was to save a nicely formated string for each item I need to select. Thats much better because now I only encode values and never decode them. All special characters become "-". A lot of my db-tables now have this additional column "URL". The data is pretty stable, thats why I can go this way. I can even check, if the data in "URL" is unique.

EDIT2:

Also watch out for space character. It looks ok on VS integrated webserver but is different on iis7 [Properly url encode space character](https://stackoverflow.com/questions/1651711/properly-url-encode-space-character)

* * *

## 回答 #1

> 赞同：48
> 
>             
> 
> 时间：2009-02-26T18:01:54.710

If it's only your last parameter, you could do:

```
routes.MapRoute(
    "Default",                                                // Route name
    "{controller}/{action}/{*id}",                            // URL with parameters
    new { controller = "Home", action = "Index", id = "" });  // Parameter defaults 
```

* * *

## 回答 #2

> 赞同：26
> 
>             
> 
> 时间：2011-03-09T16:06:03.327

这是对解决方案的简单解释和对已经说过的内容的总结。

请求方：

1.  UrlEncode 您的路径。

2.  将 '%' 替换为 '!'。

3.  提出请求。

回应方：

1.  更换 '！' 和 '％'。

2.  UrlDecode 您的路径。

3.  按预期使用参数。

冲洗，重复，享受。

* * *

## 回答 #3

> 赞同：24
> 
>             
> 
> 时间：2009-11-16T23:00:58.267

在 .NET 4.0 beta 2 中，CLR 团队提供了一种解决方法。

将此添加到您的 web.config 文件中：

```
<uri> 
    <schemeSettings>
        <add name="http" genericUriParserOptions="DontUnescapePathDotsAndSlashes" />
    </schemeSettings>
</uri> 
```

这会导致 Uri 类根据描述 URI 的 RFC 运行，允许在路径中转义斜杠而不进行转义。CLR 团队报告说，出于安全原因，他们偏离了规范，并且在您的 .config 文件中进行设置基本上可以让您对不转义斜杠所涉及的其他安全考虑拥有所有权。

* * *

## 回答 #4

> 赞同：13
> 
>             
> 
> 时间：2009-11-14T18:15:45.783

另一种选择是使用查询字符串值。很蹩脚，但比自定义编码更简单。

```
http://localhost:5000/Home/About?100%2f200 
```

* * *

## 回答 #5

> 赞同：9
> 
>             
> 
> 时间：2010-09-28T07:38:38.953

Java / Tomcat 也是如此。

如果您的 URL 中有编码的“/” (%2F)，仍然存在问题。

RFC 3986 - 第 2.2 节说：“如果 URI 组件的数据与保留字符作为分隔符的目的发生冲突，则冲突数据必须在 URI 形成之前进行百分比编码。” （RFC 3986 - 第 2.2 节）

但是Tomcat有一个问题：

> [http://tomcat.apache.org/security-6.html](http://tomcat.apache.org/security-6.html) - 在 Apache Tomcat 6.0.10 中修复
> 
>   
>   
> 
> 重要：目录遍历 CVE-2007-0450
> 
>   
>   
> 
> Tomcat 允许 '\'、'%2F' 和 '%5C' [...]。
> 
>   
>   
> 
> 以下 Java 系统属性已添加到 Tomcat，以提供对 URL 中路径分隔符处理的额外控制（这两个选项默认为 false）：
> 
>   
>   
> 
> *   org.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH：真|假
> 
> *   org.apache.catalina.connector.CoyoteAdapter.ALLOW_BACKSLASH：真|假
> 
>   
>   
> 
> 由于无法保证所有 URL 都由 Tomcat 处理，就像它们在代理服务器中一样，因此 Tomcat 应该始终受到保护，就好像没有使用限制上下文访问的代理一样。
> 
>   
>   
> 
> 影响：6.0.0-6.0.9

因此，如果您有一个带有 %2F 字符的 URL，Tomcat 会返回：“400 Invalid URI: noSlash”

您可以在 Tomcat 启动脚本中切换错误修复：

```
set JAVA_OPTS=%JAVA_OPTS% %LOGGING_CONFIG%   -Dorg.apache.tomcat.util.buf.UDecoder.ALLOW_ENCODED_SLASH=true 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2016-03-16T17:15:13.283

您可以避免上述双重编码/解码建议，只需使用 HttpServerUtility.UrlTokenEncode 和相应的 UrlTokenDecode。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-11-21T19:44:53.643

这对 .NET 4 很有趣。无论如何，此链接描述了 RFC 1738 并包括哪些字符需要编码，哪些只是“不安全”。
[链接文本](http://www.blooberry.com/indexdot/html/topics/urlencoding.htm#whatwhy)

如果我想要一个 SEO 友好的 URL（比如当您想在 URL 中放置论坛帖子主题时），则跳过编码并替换任何不是 AZ、az、0-9 的内容。  

```
public static string CreateSubjectSEO(string str)
    {
        int ci;
        char[] arr = str.ToCharArray();
        for (int i = 0; i < arr.Length; i++)
        {
            ci = Convert.ToInt32(arr[i]);
            if (!((ci > 47 && ci < 58) || (ci > 64 && ci < 91) || (ci > 96 && ci < 123)))
            {
                arr[i] = '-';
            }
        }
        return new string(arr);
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2019-04-24T16:28:00.597

对于入站编码的“/”问题，我可以通过添加“*”来捕获所有 id 参数来解决我的问题，然后能够正确地将编码的“/”传递到控件中（参数是一个带有编码的字符串'/')

```
routes.MapRoute(
            name: "Default",
            url: "{controller}/{action}/{*id}",
            defaults: new 
            { 
                controller = "Control", 
                action = "Action", 
                id = UrlParameter.Optional 
            }) 
```

* * *

## 回答 #9

> 赞同：-1
> 
>             
> 
> 时间：2011-08-30T10:05:00.623

正如Symfony 1.x 开发人员遇到问题时所建议的那样（+ 在[PHP](https://groups.google.com/group/symfony-devs/browse_thread/thread/e23a55143cce36c0?pli=1)[注释中`urlencode()`](http://www.php.net/manual/en/function.urlencode.php#47132)建议）：

*   之前将“/”编码为“%2F”`urlencode()`

*   在（如有必要）之后将“%2F”解码为“/”`urldecode()`

注意：您可以使用`rawurlencode()`，但您仍然需要对 '/' 进行两次 urlencode。

优点：

*   避免需要额外的转义过程（如果将 '/' 替换为特殊字符，如 '!' 或 '_'）

*   不要依赖任何服务器设置，例如`AllowEncodedSlashes`Apache

* * *

## 回答 #10

> 赞同：-3
> 
>             
> 
> 时间：2012-06-22T07:23:13.350

只需使用`Server.UrlDecode`. 它会起作用，我已经测试过了。

# asp.net - Footertemplate in gridview

> ID：591700
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T17:59:22.190
> 
>         
> 
> 标签：asp.net, gridview

I am using datatable to fill gridview.

How can i add blank row in datatable to view footertemplate even if i don't have any data ?

I am using asp.net 2005\. I am using gridview control to add,edit and modify the data. i put add control at footertemplate. it's working fine but i face one problem that when ever there is no data in the grid then footertemplate is not visible. I want footertemplate will be visible all the time so that user can add data even though there is no data available.

Can any body help me out...

Thanks

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:02:16.503

I ran into this as well. If I remember correctly, there is no way to actually fix it. I worked around the issue by creating an empty data template that had the controls I needed to be able to add the data.

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:04:52.210

There are a couple tricks to doing this, and most of them are kind of "ad hoc". The route I took was to intercept my datasource and check the row count. If the row count was 0, then I went ahead and injected my own row into the dataset with a coded "blank" value. Then in the databinding event, I made sure that the empty row just put empty strings into the proper fields, allowing the footer to still render.

The other route to go would be to essentially subclass the GridView class and add a few extensions so that you can still display the header/footer when there is no data. Matt Berseth has a [nice little article](http://mattberseth.com/blog/2007/07/how_to_show_header_and_footer.html) on how to accomplish this.

# asp.net - UpdatePanel 实际上是如何工作的？

> ID：591705
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-02-26T18:00:58.893
> 
>         
> 
> 标签：asp.net, ajax, updatepanel

触发更新时会更新什么？什么去服务器？什么回来了？

我的印象是只有面板的内容被传输到服务器并返回（没有触摸面板外页面中的任何内容），但我遇到了奇怪的结果，可能是因为我不太了解它是如何工作的确切地。

有人可以简单解释一下它是如何工作的吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T18:06:03.593

发送到服务器的帖子几乎包含了帖子的所有信息，包括视图状态。不同之处在于实际返回给浏览器的内容。为了处理请求，整个页面被实例化，如果在更新面板之外有任何更新，那么你可能会得到一些丑陋的错误。

**更新 1：**这与其他 ajax 方法不同，它只发送所需的信息，不使用视图状态，即 ajax 控制工具包的 autocompleteextender - 查找 json、ajax 请求和其他相关信息。

它可能对您有用，但是您正确地了解正在发生的事情是正确的，当它适用于其他解决方案时，您需要这种方式。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T18:08:17.817

生成的是通过 AJAX 提交的表单，本质上是浏览器中的 XML HTTP。当它到达服务器时，服务器将其视为 AJAX 调用，并将请求路由到正确的方法。

至于确切发送什么，它是表单提交应该发送的任何内容，这很可能是 UpdatePanel 之外的信息。服务器然后确定要使用的内容并发送回响应。

这一切都很好，就像理论一样，但你处理的是问题而不是理论。你正在经历什么奇怪的事情？如果您可以发布，我们可以专注于问题的细节。

# html - 如何在 IE 中禁用文件输入文本框？

> ID：591710
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-02-26T18:01:35.600
> 
>         
> 
> 标签：html, file, internet-explorer, input, filepath

是否可以阻止用户在 IE 中输入文件输入文本框？我问的原因是，如果用户输入的文本看起来不像文件系统路径（例如，不以 c:... 之类的内容开头），那么当用户单击提交按钮时，什么都不会发生。

我要么不允许用户在框中输入，要么让表单正常提交。

我发现这里问了同样的问题而没有答案：
 [http ://www.webmasterworld.com/html/3290988.htm](http://www.webmasterworld.com/html/3290988.htm)

如果没有其他合适的答案，这个人想出了一个技巧，我可以使用它：http:
 [//www.shauninman.com/archive/2007/09/10/styling_file_inputs_with_css_and_the_dom](http://www.shauninman.com/archive/2007/09/10/styling_file_inputs_with_css_and_the_dom)

编辑：澄清 - 如果用户在“浏览”按钮旁边的文本框中键入“不是文件路径”并单击提交，则在 IE 中不会发生任何事情。表单不会提交 - 当 <input type="file"> 框没有真实的文件路径时，IE 不允许提交表单。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-04-09T04:15:07.777

这个怎么样？您不能键入，也不能右键单击并粘贴。

```
<input type="file" name="file" onKeyDown="this.blur()" onContextMenu="return false;"> 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T18:09:59.153

一开始这可能是个坏主意。如果用户没有使用 Windows 操作系统并且想要上传文件 /home/user/example.txt 怎么办？

这种类型的检查可能在服务器端实现得更好。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T21:38:38.887

我用另一种方式解决了这个问题，使用按钮而不是提交，并在提交前使用 JavaScript 检查值。

```
<input type="file" name="inputFile">
<input type="button" onclick="if(fileHasValidPath()) { submitForm(); }" value="Submit">

function fileHasValidPath() {
  if (isIE()) {
    var inputFile = document.forms[0].inputFile;
    if (inputFile.value != "" && /^(\w:)|(\\)/.test(inputFile.value)) {
      alert("File is not a valid file.  Please use the Browse button to select a file.");
      inputFile.select();
      inputFile.focus();
      return false;
    }
  }

  return true;
}

function submitForm() {
  document.forms[0].submit();
} 
```

我意识到仍然需要对文件进行服务器端验证，但这只是为了防止用户单击提交按钮而没有看到任何事情发生。此外，它假定 IE 使用 Windows 操作系统。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:04:45.267

一种方法是在提交按钮中添加一些 javascript 代码。这个想法是验证盒子并停止提交或允许它。

但是，您最好只验证文件内容服务器端并将适当的错误返回给客户端。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2011-03-09T03:29:53.383

对于安全问题，输入类型=文件元素的值属性是只读的。您可以阅读此属性并进行检查。如果它不符合您的规则，您将给出警告并让人修改它。另一种方法是使用 outerHTML 属性覆盖它。例如：名为 objInputFileElement 的 HTML 输入文件元素。objInputFileElement.outerHTML="";

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T18:04:15.690

你不能用

```
<input ... disabled> 
```

*编辑*：不，实际上这也阻止了提交......但显然在 HTML 4 中

```
<input ... readonly> 
```

应该管用。[http://htmlhelp.com/reference/html40/forms/input.html](http://htmlhelp.com/reference/html40/forms/input.html)

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2012-04-10T16:02:14.083

我找到了解决您问题的选项。`contentEditable`选项如下：

```
<input type="file" name="name" contentEditable="false"/> 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2012-04-10T16:22:41.843

这是该`contentEditable`选项的演示：

```
<input type="file" name="name" contentEditable="false" /> 
```

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2015-02-17T18:04:00.943

我的解决方案基于[这个线程](https://stackoverflow.com/questions/24424214/disable-copy-or-paste-action-for-text-box)。

因此，考虑到这个文件字段：

```
<input type="file" id="file_field"> 
```

我让它在 jquery 中使用这样的东西：

```
$(document).ready( function() {
    $('#file_field').bind("keydown", function(e) {
        e.preventDefault();
    });
}); 
```

**注意：**您必须使用***keydown***而不是***keypress***，因为它涵盖了 DEL 和 BACKSPACE 以及任何打印键。

# asp.net-mvc - 如何对我的 asp.net-mvc 控制器的 OnActionExecuting 方法进行单元测试？

> ID：591720
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-02-26T18:04:13.473
> 
>         
> 
> 标签：asp.net-mvc, unit-testing

我已经重写了控制器的 OnActionExecuting 方法，以根据正在执行的 filterContext 设置一些内部状态。我该如何测试这个？该方法本身是受保护的，所以我假设我必须在调用堆栈中更高。

我需要什么代码来测试这个？

我正在使用 mvc RC 1。

编辑：我也在使用 nunit。

谢谢

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-02-26T18:12:31.567

您需要添加和使用 Private Accessor。右键单击您的控制器类并`Create Private Accessors`从菜单中选择并将它们添加到您的测试项目中。进入测试项目后，创建控制器，然后为其创建访问器。该方法应该在访问器上可用。这是我自己的代码中的示例测试：

```
/// <summary>
///A test for OnActionExecuting
///</summary>
[TestMethod()]
[ExpectedException( typeof( InvalidOperationException ) )]
public void OnActionExecutingWindowsIdentityTest()
{
    var identity = WindowsIdentity.GetCurrent();
    WindowsPrincipal principal = new WindowsPrincipal( identity );
    var httpContext = MockRepository.GenerateStub<HttpContextBase>();
    httpContext.User = principal;

    var actionDescriptor = MockRepository.GenerateStub<ActionDescriptor>();

    RouteData routeData = new RouteData();

    BaseController controller = new BaseController();
    BaseController_Accessor accessor = new BaseController_Accessor( new PrivateObject( controller ) );
    ControllerContext controllerContext = MockRepository.GenerateStub<ControllerContext>( httpContext, routeData, controller );

    ActionExecutingContext filterContext = new ActionExecutingContext( controllerContext, actionDescriptor, new Dictionary<string, object>() );

    accessor.OnActionExecuting( filterContext );

} 
```

**编辑**：如果您没有使用 MSTest 进行单元测试，则可能必须手动生成访问器。本质上，您创建一个包装类，通过等效的公共方法公开被测类的私有/受保护方法，将被测类的实例传递给包装器，然后使用包装类的反射来调用私有/受保护的方法被测类的方法。

```
 public class MyClass
   {
       protected void DoSomething( int num )
       {
       }
   }

   public class MyClass_accessor
   {
       private MyClass privateObj;

       public MyClass_accessor( MyClass obj )
       {
           this.privateObj = obj;
       }

       public void DoSomething( int num )
       {
           MethodInfo info = privateObj.GetType()
                                       .GetMethod("DoSomething",
                                                   BindingFlags.NonPublic
                                                   | BindingFlags.Instance );

           info.Invoke(obj,new object[] { num });
       }
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2012-06-26T02:53:24.167

我最近遇到了类似的问题，找不到令人满意的解决方案。所以我创建了我自己的辅助函数来调用 OnActionExecuted 和 OnActionExecuting。请参阅此处的代码[http://mkramar.blogspot.com.au/2012/06/onactionexecuting-and-onactionexecuted.html](http://mkramar.blogspot.com.au/2012/06/onactionexecuting-and-onactionexecuted.html)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2013-12-30T19:30:20.783

我试图这样做，但实际上我想**测试自定义属性的结果，**因为它应用于**实际的控制器**。在我们的例子中，我们有一个在控制器上设置属性的授权属性，然后控制器使用这些属性。我们的代码看起来像这样：

```
// Create the controller to test
PortalController controller = new PortalController();
var method = typeof(PortalController);
var attribute = method.GetCustomAttributes(typeof(OrganizationContextFilter),true).Cast<OrganizationContextFilter>().SingleOrDefault();

// Set the controller Context with our fake objects on it
controller.ControllerContext = this.GetDefaultControllerMock(controller);

// Execute the Organization Context Filter
var actionDescriptor = new Mock<ActionDescriptor>();
var context = Mock.Get(actionDescriptor.Object);
context.Setup(s => s.ControllerDescriptor).Returns(new Mock<ControllerDescriptor>().Object);

// Use the current controller Context
ActionExecutingContext filterContext = new ActionExecutingContext( controller.ControllerContext, actionDescriptor.Object, new Dictionary<string, object>() );
attribute.OnActionExecuting(filterContext);

// We have to use this one, because it has the result of the Attribute execution
PortalController pc = filterContext.Controller as PortalController;
ActionResult result = pc.MethodToTest(); // Call the controller that had OnActionExecuting results 
```

这样做的好处是我们实际上在我们实际测试的控制器上执行了自定义 MVC 属性。这既练习了自定义属性代码，又在更像“真实世界”的情况下测试了控制器。

# cocoa-touch - What are the main differences between Cocoa and CocoaTouch?

> ID：591725
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-02-26T18:04:55.920
> 
>         
> 
> 标签：cocoa-touch, cocoa

I am currently learning Objective-C and Cocoa. Next, I want to stick up to iPhone programming. I'll get a book for that, of course. But I would like to know now already, what the main differences are between Cocoa and Cocoa Touch.

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-02-26T18:15:09.470

Cocoa 和 Cocoa touch 的核心概念是相似的，都有视图层次和响应者链。然而，UIView 架构与 CoreAnimation 等最新技术的联系更加紧密。

可用的控件类型也会发生变化。

此外，Cocoa touch 引入了 UIViewControllers 的概念，它创建了一个很好的抽象来放置与你的主程序和它拥有的特定视图交互的代码。正如 Chuck 在评论中指出的那样，这是在 Mac OS X 10.5 的 Cocoa 中添加的，因此根据您学习 Cocoa 的方式，您可能知道也可能不知道它们。

最后，正如其他人所提到的，垃圾收集目前在 iPhone 上不存在。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-02-26T19:44:13.700

补充一下其他人所说的，大部分基础是 Cocoa Touch 和 Cocoa 共享的。例如，数据类型类`NSString`和集合类`NSArray`在两个框架中是相同的。其他类`NSURLConnection`基本相同。Cocoa Touch 中没有其他高级框架，例如 Core Data。

此外，Cocoa Touch 是使用 Objective-C 2.0 开发的。所以 UIKit，Cocoa Touch 框架对应 Cocoa 中的 AppKit，广泛使用了属性。在许多方面，Cocoa Touch 比 Cocoa 更现代。Cocoa Touch 也倾向于使用 Objective-C`@protocol`语法而不是旧的类别语法来实现 Apple 所谓的“非正式协议”（即某些方法是可选的协议）

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2011-02-24T06:45:22.253

Objective C 是一种动态编程语言——有点像 C++，有点像 Java。

Cocoa 是 Mac OS X 的应用程序框架。

Cocoa Touch 是 iPhone 和 iPod Touch 的应用程序框架 - 与 Cocoa 非常相似。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:13:47.210

基本上它只是您可以使用的框架。对于桌面开发，您将使用 AppKit，而对于 iPhone 开发，您将使用 UIKit。UIkit 显然包括多点触控功能等。

当您开始 iPhone 开发时，这里有一个可能会派上用场的常见问题解答：
 [http ://www.plaidworld.com/iphonefaq.txt](http://www.plaidworld.com/iphonefaq.txt)

编辑：是的，就像上面提到的帖子一样，即使 Objective-C 2.0 可用于 iPhone 开发，也没有 GC

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2009-02-26T18:12:10.163

据我了解，主要区别之一是 cocoa 有自己的垃圾收集版本（像 .NET 一样的托管内存），但 cocoaTouch 没有。

# c# - 在哪里可以下载没有 Visual Studio 2010 的 C# 4.0 编译器？

> ID：591726
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-26T18:05:24.547
> 
>         
> 
> 标签：c#, .net, compiler-construction, c#-4.0

我知道 CTP VS 2010 图像，但我只能下载 .NET Framework 4.0 和 C# 编译器吗？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-26T18:09:37.970

AFAIK，VS 2010 CTP 仅作为 VM 映像提供。我不相信微软发布了 VS 的安装程序。一个绝对不适用于独立的 CLR/SDK。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T18:06:40.240

不是这个时候。猜测可能何时 Beta 开始发货。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T18:08:08.830

.Net 4.0 可再发行组件尚不可用。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-03-12T00:53:28.560

有趣的是，当我们说话时，我正试图从 VHD 中[提取它。](https://stackoverflow.com/questions/636850/register-dll-in-gac-without-assembly-manifest)

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-03-12T01:22:25.840

如前所述，没有 VHD 就无法使用。原因是（我猜）因为：

1) MS 希望你通过 VHD 上的预安装教程来提供设计反馈。

2) MS 不想让安装程序在所有受支持的操作系统上运行所需的额外工作。

# css - CSS more short query

> ID：591743
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T18:09:29.733
> 
>         
> 
> 标签：css, css-selectors

For example I have a CSS selector:

```
#spotlightPlayer .container .commands.over span,
#spotlightPlayer .container .commands.over ul,
#spotlightPlayer .container .commands.over ul li { clear:both } 
```

Is there a way to write like, 

```
(#spotlightPlayer .container .commands.over) span, ul, ul li { clear:both } 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T18:22:45.893

您可以使用某种 CSS 预处理器，例如[Shaun Inman 的 CSS 服务器端预处理器](http://www.shauninman.com/archive/2007/06/27/css_server_side_pre_processor)来转换：

```
#spotlightPlayer .container .commands.over {
    span,
    ul,
    ul li { clear:both }
} 
```

进入这个：

```
#spotlightPlayer .container .commands.over span,
#spotlightPlayer .container .commands.over ul,
#spotlightPlayer .container .commands.over ul li { clear:both } 
```

但是 CSS 本身没有这样的语法。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:34:28.003

那么你实际上想要的是一个'with'/grouping 构造？

我不认为 CSS 可以直接做到这一点，但它肯定会很有用。

编写一个从速记生成速记版本的基本脚本可能不会太难。

但是，也许更一致的语法是：

```
@with( #spotlightPlayer .container .commands.over )
{
    span, ul, ul li { clear:both }
} 
```

虽然在这种情况下更长，但它允许您添加更多仅适用于该特定块的样式。

***编辑：****或者更好的是，使用另一个答案中建议的 css 预处理器。*

另外，关于杰里米的回答/评论：除非您有（或计划拥有）`.commands.over`项目*之外*的`.container`项目，否则您可以删除中间部分。

当你用空格分隔你的选择器时，它允许*任何*后代，而不是需要直接的父/子关系（就像`>`那样）。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T19:04:37.183

You might check out [Sass](http://haml.hamptoncatlin.com/docs/rdoc/classes/Sass.html). It has a lot of helpful little features that let you make your style sheets more declarative than the normal CSS syntax allows. It handles deeply nested tags in a very natural way. In Sass, this would be:

```
#spotlightPlayer .container. commands.over
  span, ul, ul li
    :clear both 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T18:16:23.273

如果您只想清理您的 CSS，并且您不关心让您的 HTML 混乱，请为相关部分中的每个 、 和 元素`span`应用`ul`一个类。`ul>li`您可以清除两行额外的 CSS，但您会在 HTML 杂乱无章中获得很多权重。我不会推荐这个。

* * *

## 回答 #5

> 赞同：-2
> 
>             
> 
> 时间：2009-02-26T18:12:19.990

听起来问题出在您的文档结构而不是您的 CSS 上。你真的需要这么长的标识符列表来获得你需要的特异性吗？您应该只需要 HTML 元素的属性，例如用于描述您正在显示的数据的属性。

# .net - 将较旧的数据访问应用程序块与较新的企业库一起使用

> ID：591747
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T18:10:07.173
> 
>         
> 
> 标签：.net, database, enterprise-library

有什么理由我不能使用旧版本的数据访问应用程序块（sqlhelper）和企业库（如果我不使用它的数据部分？）

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:53:26.100

EnterpriseLibrary 被分解为几个不同的 dll，因此您甚至不需要引用您不想要的部分。即使它们被引用，也没有什么能阻止你混合和匹配。

如果您确实遇到在同一个类中引用了多个具有相同名称的类的情况，只需明确命名它们（或通过 using 语句）以确保您获取正确的对象类型。  

请记住，对象的完全限定名称包括其命名空间，因此只要包含命名空间，其中一个中的 SqlHelper 与另一个中的 SqlHelper 不同。

玩得开心！

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T20:03:36.680

我不明白为什么你不能~从技术上讲。但是您不想转换它似乎很奇怪。

EnterpriseLibarary.Data 框架的“干净”非常吸引人。

它还制作了非常“干净”的代码。例子：

```
 public override IDataReader CustomersGetSingleWithOrdersReader(string customerId)
    {
        IDataReader returnReader = null;
        try
        {
            Database db = this.GetDatabase(); //encapsulate call to retrieve a database object, very simple routine
            DbCommand dbc = db.GetStoredProcCommand  ("dbo.uspCustomersGetSingleWithOrders);
    db.AddInParameter(dbc, "@CustomerID", System.Data.DbType.String, customerId);
            returnReader = db.ExecuteReader(dbc);
            return returnReader;
        }
        finally
        {
        }
    } 
```

你关心上面代码中的两件事。调用哪个存储过程。给它什么参数。EnterpriseLibrary.Data 为您完成其余的工作。

根据我的经验，EnterpriseLibrary.Data 唯一不能保护您的事情（因为在这种情况下它不能）是使用 IDataReader 然后不关闭它。这是一个很大的禁忌。

但如前所述，完全限定的命名空间等可以帮助您解决问题。

不要忘记 EnterpriseLibrary.Data 框架比原来的 DAAB 更成熟。

并且不要忘记 DAAB 2.0 上的错误之一。

[http://weblogs.asp.net/rosherove/archive/2003/07/29/10614.aspx](http://weblogs.asp.net/rosherove/archive/2003/07/29/10614.aspx)

# plugins - TinyMCE Plugins: Listboxes

> ID：591749
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-26T18:10:38.403
> 
>         
> 
> 标签：plugins, tinymce

I'm writing a plugin for TinyMCE, and I want to have ListBox B dependent on what's selected in Listbox A. I can make it so the initial selection in ListBox A fills ListBox B, but I cannot make a second selection, wipe ListBox B clean, and fill ListBox B with the new items.

I've tried using just Native ListBoxes and JQuery functions but JQuery can't find them on the page.

Thanks!

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2010-12-01T13:41:34.127

这是一个对我有用的解决方法。我的 ListBox 包含类名（cssclass 是一个包含简单字符串的变量）：

```
listbox = ed.controlManager.get('p_style'); // listboxname
if (typeof listbox == "undefined") return;

// after rendering, no new listbox elements can be entered -> workaround
if (listbox && listbox.isMenuRendered) {
    listbox.menu.destroy();
    listbox.isMenuRendered = false;
    listbox.oldID = 0;
}

// class zu Listboxen hinzufügen
if (listbox)
    listbox.add(cssclass, cssclass); 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2010-06-11T09:03:35.773

TinyMCE 创建一个 iframe 来保存它正在编辑的内容，因此您要搜索的列表框在那里而不是主文档中。您可以使用 tinymce.get('editor_id').getDoc() 函数从 iframe 中检索文档（请参阅[http://tinymce.ephox.com/documentation/api/index.html#class_tinymce.Editor.html-获取文档](http://tinymce.ephox.com/documentation/api/index.html#class_tinymce.Editor.html-getDoc)）。如果您在该文档上定位标准 JQuery 函数，它应该可以工作。

问候，

阿德里安·萨顿。

[http://tinymce.ephox.com](http://tinymce.ephox.com)

# iphone - How do I package components to use in multiple iPhone app?

> ID：591751
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-26T18:11:40.210
> 
>         
> 
> 标签：iphone, xcode

I am working on a number of iPhone development projects and I am starting to refactor code and would like to be able to package it in a library or framework that I can reuse in different xcode projects for different iPhone applications. I looked at the New Project dialog in xcode and the only option I have under iPhone OS is to create an Application. I have also read somewhere in the iPhone SDK documentation that I cannot create my own framework to reuse in different iPhone apps. What is then the best way to package my reusable components? I went over the iPhone SDK documentation and could not find out. I could keep all my reusable classes in a dummy project and link to those source files from other projects (so I would have a single copy of the source to maintain), but that feels very clumsy.
Thank you,
fxt

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-26T21:51:17.047

*   将您的公共代码创建为静态库。

*   将 xcodeproj 文件拖到要使用它的项目的组和文件部分。

*   更新包含路径以指向静态库的标头。

*   在您要使用静态库的项目的信息窗格中，将其添加为直接依赖项。

此过程使其*几乎*与常规框架一样易于使用。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T18:20:06.760

不幸的是，Apple 在这个阶段不允许 iPhone 开发框架。您可以将代码捆绑在静态库中，也可以将源文件捆绑在这样一种方式中，以便在多个项目中轻松使用它们。

我使用 SVN 并将我的可重用代码保存在存储库中，以便我可以轻松地将它们作为外部项目包含在新项目中

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2012-01-02T16:20:32.290

Apple 不允许创建自己的框架。但是您可以通过创建静态库来实现您的目标。这是启动静态库的重要链接。看看：http:
 [//blog.stormyprods.com/2008/11/using-static-libraries-with-iphone-sdk.html](http://blog.stormyprods.com/2008/11/using-static-libraries-with-iphone-sdk.html)

# c# - 在c#中获取上个月的第一天和最后一天的日期

> ID：591752
> 
>         
> 
> 赞同：157
> 
>         
> 
> 时间：2009-02-26T18:11:46.980
> 
>         
> 
> 标签：c#, .net, datetime, date

我想不出一个简单的一两个班轮会得到前几个月的第一天和最后一天。

我正在对一个调查 Web 应用程序进行 LINQ 化，他们提出了一个新要求。

调查必须包括上个月的所有服务请求。所以如果是 4 月 15 日，我需要所有 Marches 请求 ID。

```
var RequestIds = (from r in rdc.request 
                  where r.dteCreated >= LastMonthsFirstDate && 
                  r.dteCreated <= LastMonthsLastDate 
                  select r.intRequestId); 
```

如果没有开关，我就无法轻易想到日期。除非我是盲目的并且忽略了一种内部方法。

* * *

## 回答 #1

> 赞同：338
> 
>             
> 
> 时间：2009-02-26T18:26:21.500

```
var today = DateTime.Today;
var month = new DateTime(today.Year, today.Month, 1);       
var first = month.AddMonths(-1);
var last = month.AddDays(-1); 
```

如果您真的需要一两条线，请将它们串联起来。

* * *

## 回答 #2

> 赞同：28
> 
>             
> 
> 时间：2009-02-26T18:17:52.427

我过去这样做的方式是首先获得本月的第一天

```
dFirstDayOfThisMonth = DateTime.Today.AddDays( - ( DateTime.Today.Day - 1 ) ); 
```

然后减去一天得到上个月的月底

```
dLastDayOfLastMonth = dFirstDayOfThisMonth.AddDays (-1); 
```

然后减去一个月得到上个月的第一天

```
dFirstDayOfLastMonth = dFirstDayOfThisMonth.AddMonths(-1); 
```

* * *

## 回答 #3

> 赞同：13
> 
>             
> 
> 时间：2009-09-04T12:13:23.927

使用流利的日期时间[https://github.com/FluentDateTime/FluentDateTime](https://github.com/FluentDateTime/FluentDateTime)

```
 var lastMonth = 1.Months().Ago().Date;
        var firstDayOfMonth = lastMonth.FirstDayOfMonth();
        var lastDayOfMonth = lastMonth.LastDayOfMonth(); 
```

* * *

## 回答 #4

> 赞同：9
> 
>             
> 
> 时间：2009-02-26T18:25:04.483

```
DateTime LastMonthLastDate = DateTime.Today.AddDays(0 - DateTime.Today.Day);
DateTime LastMonthFirstDate = LastMonthLastDate.AddDays(1 - LastMonthLastDate.Day); 
```

* * *

## 回答 #5

> 赞同：6
> 
>             
> 
> 时间：2014-05-06T13:44:36.163

我使用这个简单的单线：

```
public static DateTime GetLastDayOfPreviousMonth(this DateTime date)
{
    return date.AddDays(-date.Day);
} 
```

请注意，它会保留时间。

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2009-02-26T19:04:18.417

使用扩展方法的方法：

```
class Program
{
    static void Main(string[] args)
    {
        DateTime t = DateTime.Now;

        DateTime p = t.PreviousMonthFirstDay();
        Console.WriteLine( p.ToShortDateString() );

        p = t.PreviousMonthLastDay();
        Console.WriteLine( p.ToShortDateString() );

        Console.ReadKey();
    }
}

public static class Helpers
{
    public static DateTime PreviousMonthFirstDay( this DateTime currentDate )
    {
        DateTime d = currentDate.PreviousMonthLastDay();

        return new DateTime( d.Year, d.Month, 1 );
    }

    public static DateTime PreviousMonthLastDay( this DateTime currentDate )
    {
        return new DateTime( currentDate.Year, currentDate.Month, 1 ).AddDays( -1 );
    }
} 
```

有关一些受启发的 DateTime 扩展，请参阅此链接
[http://www.codeplex.com/fluentdatetime](http://www.codeplex.com/fluentdatetime) 
。

* * *

## 回答 #7

> 赞同：3
> 
>             
> 
> 时间：2012-06-10T16:17:33.257

电子商务中的典型用例是信用卡到期日期，MM/yy。减去一秒而不是一天。否则，该卡将在到期月份的整个最后一天显示为已过期。

```
DateTime expiration = DateTime.Parse("07/2013");
DateTime endOfTheMonthExpiration = new DateTime(
  expiration.Year, expiration.Month, 1).AddMonths(1).AddSeconds(-1); 
```

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:29:58.683

```
DateTime now = DateTime.Now;
int prevMonth = now.AddMonths(-1).Month;
int year = now.AddMonths(-1).Year;
int daysInPrevMonth = DateTime.DaysInMonth(year, prevMonth);
DateTime firstDayPrevMonth = new DateTime(year, prevMonth, 1);
DateTime lastDayPrevMonth = new DateTime(year, prevMonth, daysInPrevMonth);
Console.WriteLine("{0} {1}", firstDayPrevMonth.ToShortDateString(),
  lastDayPrevMonth.ToShortDateString()); 
```

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:35:48.547

如果您的日期时间有可能不是严格的日历日期，您应该考虑使用结束日期排除比较...这将防止您错过在 1 月 31 日创建的任何请求。

```
DateTime now = DateTime.Now;
DateTime thisMonth = new DateTime(now.Year, now.Month, 1);
DateTime lastMonth = thisMonth.AddMonths(-1);

var RequestIds = rdc.request
  .Where(r => lastMonth <= r.dteCreated)
  .Where(r => r.dteCreated < thisMonth)
  .Select(r => r.intRequestId); 
```

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2016-04-15T18:08:35.893

这是对 Mike W 的回答：

```
internal static DateTime GetPreviousMonth(bool returnLastDayOfMonth)
{
    DateTime firstDayOfThisMonth = DateTime.Today.AddDays( - ( DateTime.Today.Day - 1 ) );
    DateTime lastDayOfLastMonth = firstDayOfThisMonth.AddDays (-1);
    if (returnLastDayOfMonth) return lastDayOfLastMonth;
    return firstDayOfThisMonth.AddMonths(-1);
} 
```

你可以这样称呼它：

```
dateTimePickerFrom.Value = GetPreviousMonth(false);
dateTimePickerTo.Value = GetPreviousMonth(true); 
```

# .net - Stream (.NET) 处理最佳实践

> ID：591760
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-26T18:12:43.623
> 
>         
> 
> 标签：.net, streaming

这个问题的标题是“Stream”这个词，因为下面的问题是我对 Streams 有一个更普遍的疑问的一个具体例子：

我有一个接受两种解决方案的问题，我想知道最好的一个：

1.  我下载一个文件，将其保存到磁盘（2 分钟），读取它并将内容写入数据库（+ 2 分钟）。

2.  我下载一个文件并将内容直接写入数据库（3 分钟）。

如果写入数据库失败，我将不得不在第二种情况下再次下载，但不是在第一种情况下。

哪个最好？你会用哪个？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T18:31:27.823

除非增加的延迟真的会杀死你，否则我通常会选择选项 1，除非你有充分的理由不希望文件系统上的数据（例如，对安全性、容量的担忧......）。

或者[Max Schmeling 建议的选项 3，](https://stackoverflow.com/questions/591760/stream-net-handling-best-practices/591814#591814)在写入数据库的同时保存到文件系统。

磁盘空间很便宜，备份下载的数据通常很有用（例如，测试对数据库编写代码的更改，作为下载数据内容的证据，...）。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T18:17:33.363

我假设如果由于文件内容中的某些内容而导致对数据库的写入失败，那么无论我尝试将相同的内容写入数据库多少次，它都会失败。在这种情况下，唯一的解决方案是（修复并）重新下载文件。如果由于数据库中的某些内容而导致对数据库的写入失败，那么您将遇到比是否需要再次下载文件更大的问题。

选择选项#2。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T18:30:27.827

要详细说明 Jekke 的回复：

根据文件系统创建许多失败的场合（您必须创建一个有效的文件名，确保文件系统未满，确保文件可以由您打开和写入但不能由其他人打开和写入，并发呢？使用等）。

我能想到的写入文件的唯一好处是，在对数据库进行任何操作之前，您将知道下载已成功完成。如果您可以将内容保存在内存中，请改为这样做。如果您不能并且真的坚持在下载中断的情况下不访问数据库，那么至少使用 .NET 的内置支持来帮助您解决棘手的问题（例如，IsolatedStorageFileStream）。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:15:41.730

没有理由第 2 步必须花费两分钟两次。下载文件时，您可以通过内存中的变量将其流式传输到数据库。

除非您有令人信服的理由保留文件的文件系统副本，否则在大多数情况下我会选择 #2。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:18:18.010

我不明白您添加的关于时间或必须下载文件两次的限定符，但是，如果系统内存不足，将下载缓存到磁盘然后将其发送到数据库可能真的是您唯一的选项（假设您的数据提供者可以接受流）。

编辑：在原始帖子中，作者将直接写入数据库描述为一个两阶段的过程，我假设是 1\. 将文件下载到变量中，2\. 将变量内容流式传输到 DB。如果他在选项 2 中直接流式传输到数据库，那么我同意这是一个更好的方法。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:24:51.800

我会选择选项二。不应该经常出现故障，当有你可以重新下载。如果由于某种原因您需要在文件系统上拥有该本地副本，则不要下载、保存、读取和发送到数据库...只需在保存到文件系统的同时下载并发送到数据库.

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:37:27.373

我会选择选项 3。将其保存到磁盘并将 URI 存储在数据库中。我从来都不喜欢在数据库中存储文件。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2010-05-26T08:58:29.280

[我会选择在我关于 blobstreams 的博客文章](http://peshir.blogspot.com/2009/08/cool-my-article-got-translated-and.html)的主题中提到的迄今为止尚未提及的选项（也许在评论中除外）：设置一个流处理管道，负责下载和解释您需要的文件。然后使用代码从这个复合流中读取解释记录，并在一个事务中（每个文件/每个记录，根据您的功能要求）在您的数据库中执行所需的插入/更新。

这种场景是`Stream`基础类擅长的地方。这意味着您在处理时永远不会同时将整个文件放在磁盘或内存中的任何位置。正如您提到的下载文件需要几分钟，它可能很大。您的系统是否可以对完整文件进行中间存储（可能不止一次：内存和磁盘）？即使同时处理多个文件？

此外，如果您在实践中发现该链对您来说不够可靠，并且您希望能够将下载的文件临时存储到磁盘上，并且确实希望重复处理它而无需再次下载，这简单。所需要的只是管道中的额外内容`Stream`，它将检查所需文件是否已经在您的“已下载文件”缓存中（在某个文件夹中，在隔离存储中，等等）并返回其中的字节，而不是实际循环下载`Stream`进入您的处理管道。

# javascript - 使用 facebook connect 触发函数

> ID：591761
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-26T18:12:49.553
> 
>         
> 
> 标签：javascript, jquery, function, triggers, facebook

我正在尝试使用 facebook connect 做应该相当简单的事情，但没有运气。

当用户登录时，我想显示用户详细信息（刷新而不重新加载页面），当用户注销时，我需要回到登录状态。

我的代码是

```
function update_user_box()
{
   jQuery('span#loggedin').html('<fb:profile-pic uid="loggedinuser" facebook-logo="true"></fb:profile-pic><fb:login-button size="small" onclick="fbLogout()" autologoutlink="true"></fb:login-button>');
   jQuery('span#fbLogin, ul#otherLogin').hide();
   jQuery('div#popForecast li.otherLogin, ul.showList li.otherLogin').remove();
   jQuery('span#logged').text('1');
   FB.XFBML.Host.parseDomTree();
}

function fbLogout()
{
   FB.Connect.logout();
   jQuery('span#fbLogin').show();
   jQuery('span#loggedin').empty();
   jQuery('span#logged').text('0');
}
FB.init('c0529b8c11709f2317ae643d854e3866', 'xd_receiver.htm');
FB.ensureInit(function(){
   FB.Connect.ifUserConnected(update_user_box);
}); 
```

我可以登录和注销用户，但没有其他任何变化。我什至无法从我的功能中触发警报。

出于某种原因，我使用的 html 不会显示在 pre 标记中，但是，在重新加载页面时，会显示用户（或不显示用户），因此它不是直接从 javascript 函数触发的。但是刷新页面会启动正确的功能。

我在萤火虫中遇到的错误是

> 'fbLogout 未定义'

，但显然它是定义的。我在哪里定义它重要吗？目前所有的 javascript/jquery 都在脚本标签的头部。尽管我尝试将其移到页面中，但也没有运气。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-28T00:25:51.473

原来我是在想这个。FB 为您做了很多工作。我在登录和注销事件中调用了这些函数，但是使用 FB.Connect.isUserConnected 函数，FB 会为您密切注意这一点。

我的代码完全相同，除了 1）我在 fb:login 按钮中不再有 onclick 事件 2）FB.Connect.isUserConnected 函数现在看起来像这样

```
FB.Connect.isUserConnected(update_user_box, fbLogout);

```

# memory - 安装奇数个 DDR 内存模块

> ID：591765
> 
>         
> 
> 赞同：-1
> 
>         
> 
> 时间：2009-02-26T18:14:04.167
> 
>         
> 
> 标签：memory, installation

我有三个 DDR PC 3200 内存模块，其中两个是 512 MB，一个是 1 GB。我的主板手册描述了 1、2 和 4 模块配置；安装三个可以吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T18:15:31.760

如果您不使用双通道内存配置，它应该可以工作。唯一知道的方法是尝试看看。

这不是一个编程问题，顺便说一句，很快就会结束。

# ssh-keys - 我可以在 PuTTy 以外的东西（在 Mac 上）使用 SSH 密钥吗？

> ID：591766
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-26T18:14:12.810
> 
>         
> 
> 标签：ssh-keys

Bluehost 只推荐 PuTTy。但是，是否可以在没有任何额外可见程序的情况下在 Mac 中使用 ssh 密钥？

我想轻而易举地连接到我的服务器，这样我就可以在终端中控制我的服务器。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-02-26T18:15:20.373

当然！在 Unix 和 OS X 上，该`ssh-keygen`命令将为 SSH 公钥身份验证生成公钥和私钥。调用此命令的常用方法（在客户端）是：

```
ssh-keygen -t rsa 
```

该命令将询问您将私钥放在哪里；默认位置是`~/.ssh/id_rsa`，公钥将放在同名文件中，并`.pub`添加扩展名（例如：`~/.ssh/id_rsa.pub`）。该命令还要求您为私钥创建密码（“密码短语”）；你可以像我一样把它留空，因为没有密码，但我不推荐这种做法。  

在客户端计算机上拥有公钥和私钥后，您需要让服务器识别该公钥。如果您对服务器具有 shell 访问权限，则可以使用 上传公钥文件`scp`，然后使用`ssh`在服务器上运行以下命令：

```
cat id_rsa.pub >> ~/.ssh/authorized_keys 
```

如果您的托管公司没有为您提供 shell 访问权限（尽管 Bluehost 有），或者此过程不起作用，它可能会为您提供相同功能的 Web 界面。

一旦您的服务器设置为识别您的公钥，当`ssh`客户端尝试使用您的私钥进行身份验证时，它将允许您无需密码即可访问。您可能仍然需要输入私钥的密码，但通常您只需为每个客户端登录会话输入一次。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T18:17:18.903

当然，我一直这样做。只需按照[这些](http://oreilly.com/pub/h/66)说明生成 SSH 密钥并将其复制到您的服务器。这些说明应该适用于 Mac 和 Linux。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T18:22:44.693

[SSHKeychain](http://www.sshkeychain.org/)非常适合这个。它不显眼地存在于菜单栏上，并与 OS X 的 Keychain 和 SSH 实现无缝集成。

您将需要`ssh-keygen`按照其他答案中的说明使用，但是一旦完成，您就可以使用 SSHKeychain 来避免一直输入您的私钥密码。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:17:49.183

您应该可以在 OS X 上使用 OpenSSH；打开终端并查看“man ssh”。SSH 密钥（以不同于 PuTTY 的格式）存储在 ~/.ssh 中。在 ~/.ssh/config 中进行配置也可以让您的生活更轻松；您将能够说“使用此 $KEY 将此 $SHORTNAME 用于此 $HOST”等。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:17:51.897

在终端提示下执行

```
$ apropos ssh 
```

您应该获得 Mac OS X 附带的与 ssh 相关的所有程序的列表。

使用这些`ssh*`工具，您的 ssh 密钥将存储在`~/.ssh`. PuTTY 很不错，但与标准的 OpenSSH 工具相比，它真的只在 Windows 系统上有用。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:19:22.440

当然可以！首轮：

```
ssh-keygen 
```

并完成这些步骤。给它一个密码等是个好主意。那么你就可以：

```
cat ~/.ssh/id_rsa.pub 
```

并将结果复制粘贴到 bluehost 公钥文本区域。

# perl - 在 Perl 中从 Moose 迁移到鼠标 - 鼠标不执行 BUILD

> ID：591767
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T18:14:42.467
> 
>         
> 
> 标签：perl, moose, perl-mouse

为了速度，我正在尝试从 Moose 迁移到 Mouse，但遇到了 showstopper 错误。

我正在同一范围内构建两个对象：

```
sub scope {

   my $foo = Foo->new();
   my $bar = Bar->new();

} 
```

Foo 的 BUILD 方法正在触发，但 Bar 的 BUILD 方法没有。有任何想法吗？Foo 和 Bar 都继承自 Baz，而 Baz 继承自 Mouse::Object。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-03-07T21:04:38.660

您并没有真正为任何人提供足够的上下文来调试它。

另外，我担心您的评论“为了速度”而从 Moose 迁移到 Mouse，而没有更好的方法。有几个软件包的基准测试速度比 Mouse 或 Moose 都快。分析您的应用程序可能表明您将 99% 的时间用于元类编译、访问器访问和对象创建……此时移植到 Mouse 可能是合理的。事实证明，您将 99% 的时间花在业务逻辑上，此时移植到 Mouse 不会为您做任何事情。

鼠标非常好，并且有几个特定的​​用例。当我知道我将在 Moose 传统上不擅长 (CGI) 的环境中运行时，我在生产中使用了它。然而，Mouse 不是（正如有些人声称的那样）Moose + FAST ... Mouse 更像 Moose - Class::MOP（以及所有在 MOP 级别标准化 Perl 的技巧）。

# apache - 我想托管我自己的家庭网络服务器。我已经安装了 Apache 但我无法登录其他计算机

> ID：591769
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T18:15:04.837
> 
>         
> 
> 标签：apache

我正在使用 Windows Vista，我已经安装了 Apache。Apache 运行良好，但我想让我的网站被公开查看。

当我在其他计算机上输入我的 IP 地址（托管网站的地址）时，该页面不显示。它只是加载但不显示。

如何编辑我的 httpd 以允许所有人访问我的网站？

谢谢

-- 已编辑

是的，我已经转发了。这是屏幕截图：

[替代文字 http://www.picamatic.com/show/2009/02/26/09/29/2470958_522x128.jpg](http://www.picamatic.com/show/2009/02/26/09/29/2470958_522x128.jpg)

是正确的方式吗？还是我需要更改端口？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-26T18:21:03.403

您需要配置服务器的防火墙以允许传入连接，并且您的路由器将连接转发到服务器。

另请注意，许多 ISP 会阻止传入端口 80 连接，以避免让他们的客户托管自己的网站（检查您的 ISP 的合同，您可能因托管 Web 服务器而违反它）

如果您的 ISP 阻止端口 80，则可以将您的路由器设置为使用不同的端口并将其作为端口 80 转发到您的服务器。请参阅路由器的用户手册以了解转发端口。某些路由器可能不支持将传入端口更改为其他端口，在这种情况下，您还必须更改 Apache 运行的端口。

从您的屏幕截图中，将公共端口设置为 80 以外的其他值（按照惯例，使用 1024-49151 之间的端口），并将私有端口保留为 80。

此外，请确保您在其他客户端上使用您的公共 IP。不要使用 192.168。*.* 地址，它们仅用于专用网络。

然后外部用户应该能够使用链接[http://[您的](http://[your)公共路由器 IP]:[新端口] 进行连接。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T18:24:56.920

确保您使用的是启用“IP 转发”的任何类型的路由器，否则您的服务器将隐藏在其后面。

可以在路由器的配置网页上更改此选项。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T18:35:36.457

`bstpierre' 是正确的，因为某些 ISP 阻止了端口 80。我自己使用端口 8080。祝你好运！

# python - pygame 函数似乎被忽略了

> ID：591776
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-26T18:15:48.127
> 
>         
> 
> 标签：python, function, pygame

我正在构建一个相对简单的程序来测试碰撞检测，目前一切正常，除了一件事，我试图让背景颜色随机变化，唯一的问题是它似乎完全跳过了该功能做这个;

```
import pygame
from pygame.locals import *
import random, math, time, sys
pygame.init()

Surface = pygame.display.set_mode((800,600))

backgroundr = int(random.random()*255)+1
backgroundg = int(random.random()*255)+1
backgroundb = int(random.random()*255)+1

Circles = []
class Circle:
    def __init__(self):
        self.radius = int(random.random()*50) + 1
        self.x = random.randint(self.radius, 800-self.radius)
        self.y = random.randint(self.radius, 600-self.radius)
        self.speedx = 0.5*(random.random()+1.0)
        self.speedy = 0.5*(random.random()+1.0)
        self.r = int(random.random()*255)+1
        self.g = int(random.random()*255)+1
        self.b = int(random.random()*255)+1
##        self.mass = math.sqrt(self.radius)

for x in range(int(random.random()*30) + 1):
    Circles.append(Circle())

def CircleCollide(C1,C2):
    C1Speed = math.sqrt((C1.speedx**2)+(C1.speedy**2))
    XDiff = -(C1.x-C2.x)
    YDiff = -(C1.y-C2.y)
    if XDiff > 0:
        if YDiff > 0:
            Angle = math.degrees(math.atan(YDiff/XDiff))
            XSpeed = -C1Speed*math.cos(math.radians(Angle))
            YSpeed = -C1Speed*math.sin(math.radians(Angle))
        elif YDiff < 0:
            Angle = math.degrees(math.atan(YDiff/XDiff))
            XSpeed = -C1Speed*math.cos(math.radians(Angle))
            YSpeed = -C1Speed*math.sin(math.radians(Angle))
    elif XDiff < 0:
        if YDiff > 0:
            Angle = 180 + math.degrees(math.atan(YDiff/XDiff))
            XSpeed = -C1Speed*math.cos(math.radians(Angle))
            YSpeed = -C1Speed*math.sin(math.radians(Angle))
        elif YDiff < 0:
            Angle = -180 + math.degrees(math.atan(YDiff/XDiff))
            XSpeed = -C1Speed*math.cos(math.radians(Angle))
            YSpeed = -C1Speed*math.sin(math.radians(Angle))
    elif XDiff == 0:
        if YDiff > 0:
            Angle = -90
        else:
            Angle = 90
        XSpeed = C1Speed*math.cos(math.radians(Angle))
        YSpeed = C1Speed*math.sin(math.radians(Angle))
    elif YDiff == 0:
        if XDiff < 0:
            Angle = 0
        else:
            Angle = 180
        XSpeed = C1Speed*math.cos(math.radians(Angle))
        YSpeed = C1Speed*math.sin(math.radians(Angle))
    C1.speedx = XSpeed
    C1.speedy = YSpeed
    C1.r = int(random.random()*255)+1
    C1.g = int(random.random()*255)+1
    C1.b = int(random.random()*255)+1
    C2.r = int(random.random()*255)+1
    C2.g = int(random.random()*255)+1
    C2.b = int(random.random()*255)+1

def ColourCheck():
    checknumber = int(random.random()*50)+1
    if checknumber == 50:
        backgroundr = int(random.random()*255)+1
        backgroundg = int(random.random()*255)+1
        backgroundb = int(random.random()*255)+1

def Move():
    for Circle in Circles:
        Circle.x += Circle.speedx
        Circle.y += Circle.speedy
def CollisionDetect():
    for Circle in Circles:
        if Circle.x < Circle.radius or Circle.x > 800-Circle.radius:
            Circle.speedx *= -1
            Circle.r = int(random.random()*255)+1
            Circle.g = int(random.random()*255)+1
            Circle.b = int(random.random()*255)+1
        if Circle.y < Circle.radius or Circle.y > 600-Circle.radius:
            Circle.speedy *= -1
            Circle.r = int(random.random()*255)+1
            Circle.g = int(random.random()*255)+1
            Circle.b = int(random.random()*255)+1
    for Circle in Circles:
        for Circle2 in Circles:
            if Circle != Circle2:
                if math.sqrt(  ((Circle.x-Circle2.x)**2)  +  ((Circle.y-Circle2.y)**2)  ) <= (Circle.radius+Circle2.radius):
                    CircleCollide(Circle,Circle2)
def Draw():
    Surface.fill((backgroundr,backgroundg,backgroundb))
    for Circle in Circles:
        pygame.draw.circle(Surface,(Circle.r,Circle.g,Circle.b),(int(Circle.x),int(600-Circle.y)),Circle.radius)
    pygame.display.flip()

def GetInput():
    keystate = pygame.key.get_pressed()
    for event in pygame.event.get():
        if event.type == QUIT or keystate[K_ESCAPE]:
            pygame.quit(); sys.exit()

def main():
    while True:
        ColourCheck()
        GetInput()
        Move()
        CollisionDetect()
        Draw()
if __name__ == '__main__': main() 
```

这是`ColourCheck`被忽略的功能，有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-26T18:26:27.600

我相信 backgroundr、backgroundg 和 backgroundb 是 ColourCheck() 函数的局部变量。

如果您决定使用全局变量，请在文件顶部尝试以下操作：

```
global backgroundr;
global backgroundg;
global backgroundb;
backgroundr = int(random.random()*255)+1
backgroundg = int(random.random()*255)+1
backgroundb = int(random.random()*255)+1 
```

这在你的功能中：

```
def ColourCheck():
    global backgroundr;
    global backgroundg;
    global backgroundb;
    checknumber = int(random.random()*50)+1
    if checknumber == 50:
        backgroundr = int(random.random()*255)+1
        backgroundg = int(random.random()*255)+1
        backgroundb = int(random.random()*255)+1 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T18:27:08.940

`Move()`, `CollisionDetect()`, 和`Draw()`所有引用`Circles`，但不要声明它是全局的。尝试`global Circles`在每个函数的开头添加一行。另外，我建议您将变量更改为小写；不仅初始上限通常表示 Python 中的类，而且您实际上会在`Circle`变量和`Circle`类之间产生（微不足道的）冲突。

例如：

```
circles = []

# ...

for x in range(int(random.random()*30) + 1):
    circles.append(Circle())

# ...

def Move():
    global circles

    for circle in circles:
        circle.x += circle.speedx
        circle.y += circle.speedy

# ... 
```

**编辑：**

正如 Nathan 所指出的，您的`backgroundX`变量还需要在`ColorCheck()`和中声明为全局变量`Draw()`。

您可能会考虑将所有这些函数包装到一个`Game`类（或一些此类）中，以避免使用如此多的全局变量。

# .net - 为了记录委托或事件，什么会运行得更快？

> ID：591777
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-26T18:16:13.180
> 
>         
> 
> 标签：.net

我正在合并两个项目，一个使用委托进行日志记录，另一个使用事件。一个比另一个快，为什么？或者使用一个比另一个有优势？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:19:19.600

事件是一种委托，因此我认为您不会看到重大差异，因为事件不会产生大量开销。根据您的编码方式，您可能会看到细微的差别。

一个比另一个的优势更多的是你和你的开发人员所处的范式。如果你更容易将注意力集中在事件上，那么它更容易维护。我不会只追求性能，因为你最终可能会得到一些你的窥视者无法维持的东西，尽管在我的书中学习使用仅限委托的解决方案所必需的学习是值得的。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:21:37.050

有关事件与代表的良好讨论，请参阅[本文。](http://blog.monstuff.com/archives/000040.html)[这里还有一个很好](http://www.yoda.arachsys.com/csharp/events.html)的。

# jquery - Jquery 拖放到任意位置

> ID：591789
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T18:19:10.537
> 
>         
> 
> 标签：jquery, drag-and-drop, z-index

我有一种情况，用户需要能够将图像拖放到页面的动态生成部分的一部分上，该部分将始终用`<pre> </pre>`标签括起来，但没有其他信息。

我认为实现此目的的唯一方法是添加具有不同 z-index 的包装 div，但是否甚至可以将此项“拖放”到预格式化文本上方图层上的任意位置？

任何建议/想法将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T18:23:44.143

你见过 JQuery UI 吗？您可以从字面上以最简单的形式执行此操作：

```
$("#MyDragElement").draggable(); 
```

和

```
$("#MyDropElement").droppable(); 
```

[http://jqueryui.com/](http://jqueryui.com/)

文档：

[http://docs.jquery.com/UI](http://docs.jquery.com/UI)

看看这个： ：-）

安德鲁

# c - 保护 EEPROM 数据不被修改

> ID：591794
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-26T18:19:59.147
> 
>         
> 
> 标签：c, security, embedded

通常，我会通过在 ROM 映像中放置一些独特且随机的东西来解决此问题，并将其用作加密 EEPROM 内容的种子，以在映像修改后停止提取和重新编程。

一个明显的缺陷似乎是，这并没有停止以用空白芯片替换 EEPROM 外部芯片的形式进行篡改......哦，看起来又回到了第一次使用的状态，让我们请求密钥保存！

* * *

选择组件对我来说不是一个选项，硬件平台已经定义。EEPROM 在器件的生命周期内随着配置和状态的变化而被编程，因此断开擦除线也是不行的。

我正在就可能的解决方案征求意见，以防止伪造处女（首次运行）状态，因为这将允许保存敏感数据和解锁设备的功能。

我相信分组密码（ECB 模式）足以保护敏感数据，甚至可能超过顶部！这种方法以及多份副本，盐渍一个而不是另一个应该会使投入金钱和时间来应对这些措施在经济上没有回报。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-02-26T21:08:59.583

一些想法：如果“防止修改”是指您可以检测到这种篡改，那么您可以

1.  在整个 eeprom 上生成校验和，仅在校验和正常时启动您的应用程序

2.  使用提供唯一编号的附加芯片，使用该编号加密 eeprom 的内容

3.  将所有信息存储在 eeprom 中的多个位置（如果您只想检测更改，则两次，如果您想检测并拒绝被篡改的值并使用“仍然正确”的值，则三次）

但是，如果您想首先防止篡改，则必须使用机械防护装置-热胶整个芯片，锁定PCB的外壳，...

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T18:26:41.453

将擦除引脚浮动并将整个芯片环氧树脂涂在板上？使用舞会？

如果您不想修改图像，请使其无法修改。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T21:16:19.893

如果硬件措施已经失效，并且您坚持使用软件方法，并且读取 EEPROM 的东西可以处理[公钥算法](http://en.wikipedia.org/wiki/Public-key_cryptography)，那么您可以在 EEPROM 中使用公钥签名的数据块（获取您的 EEPROM 数据，在其前面是一个固定块，其中包含数据的长度和已用私钥加密的数据的安全散列）。

这需要任何使用 EEPROM 内容的东西用相应的公钥来验证它（显然不要把它放在同一个 eeprom 中）。公钥算法在计算上有点昂贵，因此很难证明这种方法适用于微控制器。

* * *

如果你不能阻止人们篡改硬件，但你可以选择你使用的硬件，你也可以使用一个安全的 EEPROM，比如[Maxim DS28CN01](http://www.maxim-ic.com/quick_view2.cfm/qv_pk/5369)（虽然我必须承认，我讨厌 Maxim，因为它们的零件价格昂贵，而且有很长的交货时间，并且在足够多的人下订单让他们制造零件之前通常是汽化件）或[Atmel 的 AT88SC 系列](http://www.atmel.com/dyn/products/devices.asp?family_id=646)。

# iphone - iPhone模拟器失败

> ID：591799
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-26T18:21:28.160
> 
>         
> 
> 标签：iphone, xcode, ios-simulator

我有一个新的 iPhone 项目。当我“建造并出发”时：

> 来自调试器的错误：无法启动模拟应用程序：iPhone 模拟器无法安装应用程序。

这是为什么？！

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-03-22T19:07:35.787

您需要将文件夹删除为 sudo ~/Library/Application Support/iPhone Simulator

```
sudo rm -Rfv ~/Library/Application\ Support/iPhone\ Simulator 
```

看起来以前版本的 SDK 存在某种权限问题。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T20:12:16.100

您无需签署代码即可在模拟器中运行，只需在真实设备上运行即可。

该应用程序之前是否在模拟器中成功运行过？如果是这样，您是否对应用程序进行了更改？也许尝试回滚它们，直到它再次开始工作以确定问题出在哪里。

其他应用程序是否可以在模拟器中运行，或者问题是否与某个特定应用程序有关？

看看[这篇文章](http://www.iphonedevelopmentfaq.com/index.php?action=artikel&cat=6&id=47&artlang=en)。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-01T16:16:45.687

您是否尝试过从 /Developer/Platforms/iPhoneSimulator.platform/Developer/Applications/iPhone Simulator.app 打开模拟器

并检查模拟器中是否有任何东西（即邮件、Safari 等）？这至少可以告诉您模拟器是否损坏或部署有问题。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-11T21:03:39.307

我也有这个问题！我删除了用户目录中的文件夹“/Library/Application\ Support/iPhone\ Simulator”。再次启动模拟器，它立即启动。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-15T20:37:27.260

我遇到了类似的情况，我的主目录位于 NFS 共享上。删除我的“~/Library/Application Support/iPhone Simulator”目录并没有帮助，但是将该目录符号链接到我本地磁盘上的某个位置确实解决了这个问题。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-09-01T07:49:34.667

我刚刚通过重新安装 SDK (iphone_sdk_3.1_beta_3__leopard) 并重新启动我的机器解决了这个问题。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2013-05-22T23:35:49.663

重命名应用程序后，该应用程序将无法在模拟器中启动。我收到了上述错误。我尝试了上面的大部分建议，检查了 plist 中的所有设置，还检查了构建设置，但没有任何效果。对我有用的是重置模拟器。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2014-01-18T18:26:00.947

尝试在 ios 模拟器菜单上“重置内容和设置”

# c# - 从 Windows 服务和控制台应用程序访问相同的运行代码？

> ID：591802
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T18:21:51.217
> 
>         
> 
> 标签：c#, .net, architecture, windows-services, .net-2.0

我有一个构建为 Windows 服务和 ac# 库程序集 (.dll) 的应用程序。为了管理和维护此服务，我想添加运行命令行应用程序的功能，该应用程序告诉最后时间服务归档的文件、下次计划这样做的时间、上次运行的状态以及服务创建的文件的位置。

编写可以与另一个应用程序共享数据的服务和库的最佳架构是什么？我正在使用.net 2.0。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T18:27:32.200

最好的架构可能是让您的服务成为可以报告其状态（以及您想要的任何信息）的“服务器”。像 ocdecio 建议的那样使用 WCF 会使它变得非常简单。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T19:23:01.817

.net 中进程间通信的方式是通过远程处理（即使两个进程都在同一台机器上）。其他响应建议了不需要远程处理的进程间通信的替代方案。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:24:21.630

为此，我使用 WCF 并为我想要支持的命令/事件创建合同定义。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:24:51.490

我过去应用过的选项浮现在脑海中：

*   将信息保存到数据库（如果您手头有一个）

*   在服务上实现一个“状态监视器”类型的线程，客户端可以通过 TCP/IP 等连接和查询。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:27:30.920

一种相当简单的方法是将该信息存储在两个应用程序都可以访问的本地配置/文本文件中。甚至将其放在注册表项中。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T19:25:42.933

+1 让服务在查询时提供（和任何其他数据）（简单的 tcp、RPC、Web 服务或其他）

我会让它非常通用 - 比如

QueryInfo(some identifier) 作为一些字符串的响应和一个返回值或其他指示服务不知道您在说什么，无法获取信息，或返回信息

# c# - 当 CompilerParameters.GenerateInMemory == true 时，在运行时编译类失败

> ID：591806
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-26T18:22:48.750
> 
>         
> 
> 标签：c#, reflection

我正在运行时编译一个动态程序集。它需要引用另一个dll。一切正常，只要我在 CompilerParameters 中设置了一个 OutputAssembly。但是一旦我设置 GenerateInMemory = true; 它失败：

```
var compilerParameters = new CompilerParameters();
if( compileInMemory )
    compilerParameters.GenerateInMemory = true;
else
    compilerParameters.OutputAssembly = "<my_dynamic_dll_path>";
compilerParameters.ReferencedAssemblies.Add( "<other_dll_path>" );
var compilerResults = new CSharpCodeProvider().CompileAssemblyFromDom( compilerParameters, codeCompileUnit );

// Here: compilerResults.Errors.HasErrors == false

foreach( var type in compilerResults.CompiledAssembly.GetTypes() )
{
     // Exception:
     // Unable to load one or more of the requested types.
     // Retrieve the LoaderExceptions property for more information.
} 
```

LoaderExceptions 告诉我找不到“other_dll”。为什么只要我不在内存中编译它就可以工作，我必须做什么才能让它在内存中工作？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-02-26T19:04:46.340

使用 GenerateInMemory 时没有加载上下文，程序集由 Assembly.Load(Byte[]) 重载加载。一种解决方法是暂时挂钩 AppDomain.AssemblyResolve 事件，以便您可以自己加载“other_dll”。

# .net - .Net：如何将类属性转换为输出 xml 元素？

> ID：591819
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-26T18:26:18.460
> 
>         
> 
> 标签：.net, attributes, xml-serialization

全部。我似乎忘记了过程以及如何通过在属性成员上设置属性来将类属性设置为 xml 元素或属性。因此，您可以将对象写入 xml。

我不确定我在这里是否有任何意义，但希望有人知道我在说什么，并指出我的操作方法或教程或 MSDN 文档。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T18:28:01.513

属性需要是公共的，并且只需添加您希望的[XmlElementAttribute](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlelementattribute.aspx) / [XmlPropertyAttribute](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlpropertyattribute.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:29:10.123

查看 XmlSerializer 类。

关于如何控制生成的 xml 有很多不同的选项。例如，您可以从模式 (xsd) 开始并从中生成类，然后使用 XmlSerializer 将类转换为 xml。

或者，如果类已经存在，只需添加发出所需 xml 所需的语法糖。

一篇不错的文章位于：[http ://www.dotnetjohn.com/articles.aspx?articleid=173](http://www.dotnetjohn.com/articles.aspx?articleid=173)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T18:30:15.610

```
[System.Xml.Serialization.XmlElement]
public string MyHappyThing { get; set; } 
```

可能建议您对属性应用一些进一步的信息，您可以在[此处](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlelementattribute.aspx)阅读有关它的信息。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T18:30:22.117

您需要[System.Runtime.Serialization](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.aspx)命名空间。对属性使用[DataContract](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.contractnamespaceattribute.aspx)和[DataMember ，对序列化使用](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datamemberattribute.aspx)[XmlObjectSerializer](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.xmlobjectserializer.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T19:58:27.490

System.Xml.Serialization.XmlRootAttribute System.Xml.Serialization.XmlRoot XmlElementAttribute XmlArray

这些是要寻找的一些关键项目。

Full example available at:
[http://sholliday.spaces.live.com/Blog/cns!A68482B9628A842A!114.entry](http://sholliday.spaces.live.com/Blog/cns!A68482B9628A842A!114.entry)

....

# macos - 在命名管道（FIFO）上使用 poll() 时，看起来 OS X 确实存在错误......专家可以确认吗？

> ID：591826
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-26T18:27:28.287
> 
>         
> 
> 标签：macos, posix, named-pipes

我一直在尝试从一组命名管道中进行轮询一段时间，并且我不断收到 POLLNVAL 对任何命名管道文件描述符的即时响应。在找到这篇[关于 OS X 中的错误轮询的博客文章后，](http://valhenson.livejournal.com/21031.html)我很确定这是 OS X 中的一个错误。

我已经计划将我的代码切换为使用 UDP 套接字，但我想要求 SO 对此进行验证 a) 以便我确定它真的坏了，并且 b) 用于文档目的。

这是我编写的代码的精简版本（尽管上面链接中的代码经过我测试，拼写得很好）：

```
#includes
...
....
#

static const char* first_fifo_path = "/tmp/fifo1";
static const char* second_fifo_path = "/tmp/fifo2";

int setup_read_fifo(const char* path){
  int fifo_fd = -1;

  if( mkfifo(path, S_IRWXU | S_IRWXG | S_IRWXO) )
    perror("error calling mkfifo()... already exists?\n");

  if((fifo_fd = open(path, O_RDONLY | O_NDELAY)) < 0)
    perror("error calling open()");

  return fifo_fd;
}

void do_poll(int fd1, int fd2){
  char inbuf[1024];
  int num_fds = 2;
  struct pollfd fds[num_fds];
  int timeout_msecs = 500;

  fds[0].fd = fd1;
  fds[1].fd = fd2;
  fds[0].events = POLLIN;
  fds[1].events = POLLIN;

  int ret;
  while((ret = poll(fds, num_fds, timeout_msecs)) >= 0){
    if(ret < 0){
      printf("Error occured when polling\n");
      printf("ret %d, errno %d\n", ret, errno);
      printf("revents =  %xh : %xh \n\n", fds[0].revents, fds[1].revents);
    }

   if(ret == 0){
      printf("Timeout Occurred\n");
      continue;
    }                                                                   

    for(int i = 0; i< num_fds; i++){
      if(int event = fds[i].revents){

        if(event & POLLHUP)
          printf("Pollhup\n");
        if(event & POLLERR)
          printf("POLLERR\n");
        if(event & POLLNVAL)
          printf("POLLNVAL\n");

        if(event & POLLIN){
          read(fds[i].fd, inbuf, sizeof(inbuf));
          printf("Received: %s", inbuf);
        }
      }
    }
  }
}

int main (int argc, char * const argv[]) {
  do_poll(setup_read_fifo(first_fifo_path), setup_read_fifo(second_fifo_path));
  return 0;
} 
```

这输出：

```
$ ./执行
轮询
轮询
轮询
轮询
轮询
轮询
轮询
轮询
轮询
...

```

令人作呕。

还有其他人遇到这个吗？这是一个真正的错误，对吧？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-26T19:19:17.023

这似乎是一个真正的错误。它在 Linux 和 OpenBSD 上按预期工作，但正如您在 OS X 上描述的那样失败。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-26T19:28:33.363

OSX 10.4.1，我可以确认行为。相同的代码在 Linux 上工作正常（只要超时消息正常）。所有的证据，包括这个 - [http://www.virtualbox.de/changeset/12347](http://www.virtualbox.de/changeset/12347) - 都表明存在真正的问题。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-03-11T20:14:19.697

是的，已知的错误。我认为投票中断只是从 10.4 开始，我们不得不在 Fink 中处理它。Glib 的 configure.in 对此进行了测试，因此您可以确定您没有想象到它。（嗯，不完全是这个，glib 测试设备上的轮询，而不是 fifos。）

# java - 哪里可以获得 Flex - Java DS (Blaze) 培训材料？

> ID：591838
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-02-26T18:30:39.260
> 
>         
> 
> 标签：java, apache-flex, blazeds, amf, dataservice

我想知道你们中是否有人知道我在哪里可以获得关于 Flex - Java 数据服务（BlazeDS 将是理想的）非常好的培训材料（视频、示例等），除了 Adob​​e 直接提供的那些。我正在考虑类似[大卫塔克的博客](http://www.davidtucker.net/)

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2009-03-22T13:40:23.530

这是我不久前关于 Flex 和 Java 的演示文稿的截屏视频：

[http ://www.jamesward.com/blog/2008/07/21/video-flex-and-java/](http://www.jamesward.com/blog/2008/07/21/video-flex-and-java/)

此外，这是我与人合着的 BlazeDS 文章简介：http: 

[//www.infoq.com/articles/blazeds-intro](http://www.infoq.com/articles/blazeds-intro)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-03-02T16:29:12.327

[Flex on Java](http://www.manning.com/allmon/)在第 5 章中介绍了 BlazeDS。我还没有正确地通读它，所以我不知道这本书有多好。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-03-03T00:06:44.473

查看[Christophe Coenraets 的博客](http://coenraets.org/)

我认为他创建了 BlazeDS 交钥匙示例，并且他的博客上还有其他一些使用 BlazeDS 的参考应用程序。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-03-21T13:54:33.350

继续使用[Tour de Flex](http://flex.org/tour)中的示例，太棒了！！！

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2012-07-15T22:27:23.557

在这里您可以获得[Blaze 培训](http://www.hartmannsoftware.com)。

# python - 是否有与 prefuse 可视化工具包等效的 python？

> ID：591839
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-02-26T18:30:45.283
> 
>         
> 
> 标签：python, visualization, prefuse

prefuse[可视化工具包](http://prefuse.org/)非常好，但适用于 Java。我想知道python是否有类似的东西。我的主要兴趣是能够导航动态图。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-05-11T20:10:57.813

我知道这不完全是 python，但你可以*通过* [jython在 python 中使用 prefuse](http://jython.org)

类似于以下内容：

将 prefuse 添加到您的路径中：

`export JYTHONPATH=$JYTHONPATH:prefuse.jar`

和

`>>> import prefuse`

来自您的 jython 机器

这[家伙在](http://github.com/fajran)[这里](http://gist.github.com/32288)有一个使用 jython 的 prefuse 的例子

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-06-12T17:48:49.527

您可能想查看[SUMMON](http://people.csail.mit.edu/rasmus/summon/index.shtml)，这是一个使用 python 但处理相当大的数据集的可视化系统。有一个令人印象深刻的可视化和导航一棵巨大的树的视频。（无法发布链接，因为我是第一次发帖。它在 SUMMON 头版。）

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T20:38:22.510

如果您使用的是 Mac，请查看[NodeBox](http://nodebox.net/code/index.php/Home)。它提供的一个扩展是一个看起来相当不错的[图形库。](http://nodebox.net/code/index.php/Graphing)在[NodeBox 库](http://nodebox.net/code/index.php/Gallery)中四处寻找与您的问题相似的内容，它应该有一些有用的链接。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2010-08-13T12:12:14.900

这在 OP 之后很好，但以防万一：

[pydot](http://dkbza.org/pydot.html) _ 允许生成和渲染图表。如果您需要图形算法（传递闭包等），还请查看扩展和集成 pydot 的 pygraphlib。

请注意，两者都不允许对渲染图进行交互式编辑。他们都使用 graphviz 来生成输出。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T18:35:03.383

请注意，prefuse 现在有使用 flash 的[flare](http://flare.prefuse.org/)包。  

[通过web2py](http://mdp.cti.depaul.edu/)将它连接到 Python 后端，你就有了一个很棒的网络应用程序（只是一个想法）。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T19:16:35.063

如果找不到合适的替代品，您可以尝试将 prefuse 与[JPype一起使用。](http://jpype.sourceforge.net/)

* * *

## 回答 #7

> 赞同：-1
> 
>             
> 
> 时间：2009-02-26T18:33:07.210

[玛雅维](http://mayavi.sourceforge.net/)

# svn - SVN 将 FTP 上所做的更改合并到工作副本中

> ID：591843
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-26T18:31:48.493
> 
>         
> 
> 标签：svn, ftp, merge

我们使用 SVN 管理我们的 Web 开发。在一个项目中，我们通过导出项目并将其通过 FTP 传输到客户端服务器来部署站点。这个客户亲自动手并且对 FTP 上的代码进行了更改。我们现在受雇为网站添加更多功能。

如何获取在 FTP 上完成的工作并将其合并到我的工作副本中？我想保留 svn props 和 externals 并且只更新那些被更改的文件，以便我可以使用 diff 跟踪这些更改。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T18:33:52.077

将文件夹复制到本地工作副本中，并让它覆盖任何更改的文件。您现在拥有一个包含所有更改的工作副本，您可以正常提交。
**更新1：**任何未更改的文件都将被检测到，因此不会被提交（至少使用乌龟）

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:47:00.720

首先，确保您的本地副本没有未提交的更改。如果你这样做并且它们很稳定，请提交它们。如果您有不稳定的更改，您最好从 head 修订中创建一个新的结帐。然后按照以下步骤操作。

1.  创建当前头部修订的标签/分支。

2.  将您的本地副本更新为主要版本。（见上面的评论）

3.  从 FTP 下载代码

4.  将下载的代码复制到本地工作副本中

5.  检查覆盖后更改的文件。

6.  使用差异工具对这些更改的文件进行标记。

7.  提交合并的文件。

8.  如果出现问题，您可以回滚到您在步骤 1 中创建的标签/分支，然后重试。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T18:52:48.787

也许有点跑题了，但是试试像 git、bazaar 或 mercurial 这样的分布式版本控制系统怎么样？听起来完全符合您的需要。

客户端可以克隆一个存储库并在本地对其进行提交，然后您可以在完成后将其合并回主存储库。这样，您仍然保留来自客户端的所有历史记录，而 FTP 不会。

# sql - 在数据库的所有表、行和列中搜索字符串

> ID：591853
> 
>         
> 
> 赞同：78
> 
>         
> 
> 时间：2009-02-26T18:35:34.897
> 
>         
> 
> 标签：sql, sql-server-2005

我迷失在一个大数据库中，我无法找到我得到的数据来自哪里。我想知道 SQL Server 2005 是否可以在数据库的所有表、行和列中搜索字符串？

有没有人知道它是否可能以及如何？

* * *

## 回答 #1

> 赞同：93
> 
>             
> 
> 时间：2009-02-26T19:11:56.180

这段代码应该在 SQL 2005 中完成，但有几点需要注意：

1.  这是非常缓慢的。我在一个只有少数表的小型数据库上对其进行了测试，并且需要几分钟才能完成。如果您的数据库太大以至于您无法理解它，那么无论如何这可能无法使用。

2.  我即兴写了这个。我没有进行任何错误处理，可能还有其他一些草率，尤其是因为我不经常使用游标。例如，我认为有一种方法可以刷新列光标，而不是每次都关闭/取消分配/重新创建它。

如果您不了解数据库或不知道资料来自何处，那么您可能应该找一个懂的人。即使您可以找到数据的位置，它也可能在某处重复，或者您可能不了解数据库的其他方面。如果您公司中没有人了解数据库，那么您将陷入混乱。

```
DECLARE
    @search_string  VARCHAR(100),
    @table_name     SYSNAME,
    @table_schema   SYSNAME,
    @column_name    SYSNAME,
    @sql_string     VARCHAR(2000)

SET @search_string = 'Test'

DECLARE tables_cur CURSOR FOR SELECT TABLE_SCHEMA, TABLE_NAME FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE'

OPEN tables_cur

FETCH NEXT FROM tables_cur INTO @table_schema, @table_name

WHILE (@@FETCH_STATUS = 0)
BEGIN
    DECLARE columns_cur CURSOR FOR SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = @table_schema AND TABLE_NAME = @table_name AND COLLATION_NAME IS NOT NULL  -- Only strings have this and they always have it

    OPEN columns_cur

    FETCH NEXT FROM columns_cur INTO @column_name
    WHILE (@@FETCH_STATUS = 0)
    BEGIN
        SET @sql_string = 'IF EXISTS (SELECT * FROM ' + QUOTENAME(@table_schema) + '.' + QUOTENAME(@table_name) + ' WHERE ' + QUOTENAME(@column_name) + ' LIKE ''%' + @search_string + '%'') PRINT ''' + QUOTENAME(@table_schema) + '.' + QUOTENAME(@table_name) + ', ' + QUOTENAME(@column_name) + ''''

        EXECUTE(@sql_string)

        FETCH NEXT FROM columns_cur INTO @column_name
    END

    CLOSE columns_cur

    DEALLOCATE columns_cur

    FETCH NEXT FROM tables_cur INTO @table_schema, @table_name
END

CLOSE tables_cur

DEALLOCATE tables_cur 
```

* * *

## 回答 #2

> 赞同：35
> 
>             
> 
> 时间：2013-03-05T14:16:22.800

我建议您为自己找到一个 3rd 方工具，例如[ApexSQL Search](http://www.apexsql.com/sql_tools_search.aspx)（可能还有其他工具，但我使用这个是因为它是免费的）。  

如果您真的想采用 SQL 方式，您可以尝试使用由 
[Sorna Kumar Muthuraj](http://gallery.technet.microsoft.com/scriptcenter/c0c57332-8624-48c0-b4c3-5b31fe641c58)创建的存储过程——复制的代码如下。只需为架构中的所有表执行此存储过程（使用动态 SQL 很容易）

```
CREATE PROCEDURE SearchTables 
 @Tablenames VARCHAR(500) 
,@SearchStr NVARCHAR(60) 
,@GenerateSQLOnly Bit = 0 
AS 

/* 
    Parameters and usage 

    @Tablenames        -- Provide a single table name or multiple table name with comma seperated.  
                        If left blank , it will check for all the tables in the database 
    @SearchStr        -- Provide the search string. Use the '%' to coin the search.  
                        EX : X%--- will give data staring with X 
                             %X--- will give data ending with X 
                             %X%--- will give data containig  X 
    @GenerateSQLOnly -- Provide 1 if you only want to generate the SQL statements without seraching the database.  
                        By default it is 0 and it will search. 

    Samples : 

    1\. To search data in a table 

        EXEC SearchTables @Tablenames = 'T1' 
                         ,@SearchStr  = '%TEST%' 

        The above sample searches in table T1 with string containing TEST. 

    2\. To search in a multiple table 

        EXEC SearchTables @Tablenames = 'T2' 
                         ,@SearchStr  = '%TEST%' 

        The above sample searches in tables T1 & T2 with string containing TEST. 

    3\. To search in a all table 

        EXEC SearchTables @Tablenames = '%' 
                         ,@SearchStr  = '%TEST%' 

        The above sample searches in all table with string containing TEST. 

    4\. Generate the SQL for the Select statements 

        EXEC SearchTables @Tablenames        = 'T1' 
                         ,@SearchStr        = '%TEST%' 
                         ,@GenerateSQLOnly    = 1 

*/ 

    SET NOCOUNT ON 

    DECLARE @CheckTableNames Table 
    ( 
    Tablename sysname 
    ) 

    DECLARE @SQLTbl TABLE 
    ( 
     Tablename        SYSNAME 
    ,WHEREClause    VARCHAR(MAX) 
    ,SQLStatement   VARCHAR(MAX) 
    ,Execstatus        BIT  
    ) 

    DECLARE @sql VARCHAR(MAX) 
    DECLARE @tmpTblname sysname 

    IF LTRIM(RTRIM(@Tablenames)) IN ('' ,'%') 
    BEGIN 

        INSERT INTO @CheckTableNames 
        SELECT Name 
          FROM sys.tables 
    END 
    ELSE 
    BEGIN 

        SELECT @sql = 'SELECT ''' + REPLACE(@Tablenames,',',''' UNION SELECT ''') + '''' 

        INSERT INTO @CheckTableNames 
        EXEC(@sql) 

    END 

    INSERT INTO @SQLTbl 
    ( Tablename,WHEREClause) 
    SELECT SCh.name + '.' + ST.NAME, 
            ( 
                SELECT '[' + SC.name + ']' + ' LIKE ''' + @SearchStr + ''' OR ' + CHAR(10) 
                  FROM SYS.columns SC 
                  JOIN SYS.types STy 
                    ON STy.system_type_id = SC.system_type_id 
                   AND STy.user_type_id =SC.user_type_id 
                 WHERE STY.name in ('varchar','char','nvarchar','nchar') 
                   AND SC.object_id = ST.object_id 
                 ORDER BY SC.name 
                FOR XML PATH('') 
            ) 
      FROM  SYS.tables ST 
      JOIN @CheckTableNames chktbls 
                ON chktbls.Tablename = ST.name  
      JOIN SYS.schemas SCh 
        ON ST.schema_id = SCh.schema_id 
     WHERE ST.name <> 'SearchTMP' 
      GROUP BY ST.object_id, SCh.name + '.' + ST.NAME ; 

      UPDATE @SQLTbl 
         SET SQLStatement = 'SELECT * INTO SearchTMP FROM ' + Tablename + ' WHERE ' + substring(WHEREClause,1,len(WHEREClause)-5) 

      DELETE FROM @SQLTbl 
       WHERE WHEREClause IS NULL 

    WHILE EXISTS (SELECT 1 FROM @SQLTbl WHERE ISNULL(Execstatus ,0) = 0) 
    BEGIN 

        SELECT TOP 1 @tmpTblname = Tablename , @sql = SQLStatement 
          FROM @SQLTbl  
         WHERE ISNULL(Execstatus ,0) = 0 

         IF @GenerateSQLOnly = 0 
         BEGIN 

            IF OBJECT_ID('SearchTMP','U') IS NOT NULL 
                DROP TABLE SearchTMP 
            EXEC (@SQL) 

            IF EXISTS(SELECT 1 FROM SearchTMP) 
            BEGIN 
                SELECT Tablename=@tmpTblname,* FROM SearchTMP 
            END 

         END 
         ELSE 
         BEGIN 
             PRINT REPLICATE('-',100) 
             PRINT @tmpTblname 
             PRINT REPLICATE('-',100) 
             PRINT replace(@sql,'INTO SearchTMP','') 
         END 

         UPDATE @SQLTbl 
            SET Execstatus = 1 
          WHERE Tablename = @tmpTblname 

    END 

    SET NOCOUNT OFF 

go 
```

* * *

## 回答 #3

> 赞同：28
> 
>             
> 
> 时间：2012-09-23T23:29:03.553

尽管之前提出的解决方案是有效且有效的，但我谦虚地提供了一个更干净、更优雅、性能更好的代码，至少在我看来是这样。

首先，有人可能会问：为什么有人需要一个代码片段来全局和盲目地查找字符串？嘿，他们已经发明了全文，你不知道吗？

我的回答：我的主要工作是系统集成项目，每当我学习一个新的未记录的数据库时，发现数据写入的位置很重要，这很少发生。

此外，我提供的代码是一个更强大和更危险的脚本的精简版，它在整个数据库中搜索和替换文本。

```
CREATE TABLE #result(
  id      INT IDENTITY, -- just for register seek order
  tblName VARCHAR(255),
  colName VARCHAR(255),
  qtRows  INT
)
go

DECLARE @toLookFor VARCHAR(255)
SET @toLookFor = '[input your search criteria here]'

DECLARE cCursor CURSOR LOCAL FAST_FORWARD FOR
SELECT
  '[' + usr.name + '].[' + tbl.name + ']' AS tblName,
  '[' + col.name + ']' AS colName,
  LOWER(typ.name) AS typName
FROM
  sysobjects tbl
    INNER JOIN(
      syscolumns col
        INNER JOIN systypes typ
        ON typ.xtype = col.xtype
    )
    ON col.id = tbl.id
    --
    LEFT OUTER JOIN sysusers usr
    ON usr.uid = tbl.uid

WHERE tbl.xtype = 'U'
  AND LOWER(typ.name) IN(
        'char', 'nchar',
        'varchar', 'nvarchar',
        'text', 'ntext'
      )
ORDER BY tbl.name, col.colorder
--
DECLARE @tblName VARCHAR(255)
DECLARE @colName VARCHAR(255)
DECLARE @typName VARCHAR(255)
--
DECLARE @sql  NVARCHAR(4000)
DECLARE @crlf CHAR(2)

SET @crlf = CHAR(13) + CHAR(10)

OPEN cCursor
FETCH cCursor
INTO @tblName, @colName, @typName

WHILE @@fetch_status = 0
BEGIN
  IF @typName IN('text', 'ntext')
  BEGIN
    SET @sql = ''
    SET @sql = @sql + 'INSERT INTO #result(tblName, colName, qtRows)' + @crlf
    SET @sql = @sql + 'SELECT @tblName, @colName, COUNT(*)' + @crlf
    SET @sql = @sql + 'FROM ' + @tblName + @crlf
    SET @sql = @sql + 'WHERE PATINDEX(''%'' + @toLookFor + ''%'', ' + @colName + ') > 0' + @crlf
  END
  ELSE
  BEGIN
    SET @sql = ''
    SET @sql = @sql + 'INSERT INTO #result(tblName, colName, qtRows)' + @crlf
    SET @sql = @sql + 'SELECT @tblName, @colName, COUNT(*)' + @crlf
    SET @sql = @sql + 'FROM ' + @tblName + @crlf
    SET @sql = @sql + 'WHERE ' + @colName + ' LIKE ''%'' + @toLookFor + ''%''' + @crlf
  END

  EXECUTE sp_executesql
            @sql,
            N'@tblName varchar(255), @colName varchar(255), @toLookFor varchar(255)',
            @tblName, @colName, @toLookFor

  FETCH cCursor
  INTO @tblName, @colName, @typName
END

SELECT *
FROM #result
WHERE qtRows > 0
ORDER BY id
GO

DROP TABLE #result
go 
```

* * *

## 回答 #4

> 赞同：13
> 
>             
> 
> 时间：2009-02-26T19:29:16.640

如果您从应用程序“获取数据”，明智的做法是在运行应用程序时使用分析器并分析数据库。跟踪它，然后搜索该字符串的结果。

* * *

## 回答 #5

> 赞同：8
> 
>             
> 
> 时间：2009-07-02T23:06:55.240

适用于 Microsoft SQL Server Management Studio 和 Microsoft SQL Server Management Studio Express 的 SSMS Tools PACK 插件（插件）将完全满足您的需求。在较大的数据库上，搜索需要一些时间，但这是意料之中的。它还包括大量很酷的功能，这些功能一开始就应该包含在 SQL Server Management Studio 中。试试看[www.ssmstoolspack.com/](http://www.ssmstoolspack.com/Main.aspx)

您确实需要安装 SQL Server Management Studio 的 SP2 才能运行这些工具。

* * *

## 回答 #6

> 赞同：6
> 
>             
> 
> 时间：2009-05-19T21:27:35.137

我改编了最初由[Narayana Vyas Kondreddi 于 2002 年](http://vyaskn.tripod.com/search_all_columns_in_all_tables.htm)编写的脚本。我通过使用 patindex 而不是 like 更改了 where 子句以检查 text/ntext 字段。我还稍微更改了结果表。不合理地，我更改了变量名称，并按照我的喜好对齐（没有不尊重 Kondretti 先生）。用户可能想要更改搜索的数据类型。我使用全局表来允许查询中间处理，但永久表可能是一种更聪明的方法。

```
/* original script by Narayana Vyas Kondreddi, 2002 */
/* adapted by Oliver Holloway, 2009 */

/* these lines can be replaced by use of input parameter for a proc */
declare @search_string varchar(1000);
set @search_string = 'what.you.are.searching.for';

/* create results table */
create table ##string_locations (
  table_name varchar(1000),
  field_name varchar(1000),
  field_value varchar(8000)
)
;
/* special settings */
set nocount on
;
/* declare variables */
declare
  @table_name varchar(1000),
  @field_name varchar(1000)
;
/* variable settings */
set @table_name = ''
;
set @search_string = QUOTENAME('%' + @search_string + '%','''')
;
/* for each table */
while @table_name is not null
begin

  set @field_name = ''
  set @table_name = (
    select MIN(QUOTENAME(table_schema) + '.' + QUOTENAME(table_name))
    from INFORMATION_SCHEMA.TABLES
    where 
      table_type = 'BASE TABLE' and
      QUOTENAME(table_schema) + '.' + QUOTENAME(table_name) > @table_name and
      OBJECTPROPERTY(OBJECT_ID(QUOTENAME(table_schema) + '.' + QUOTENAME(table_name)), 'IsMSShipped') = 0
  )

  /* for each string-ish field */
  while (@table_name is not null) and (@field_name is not null)
  begin
    set @field_name = (
      select MIN(QUOTENAME(column_name))
      from INFORMATION_SCHEMA.COLUMNS
      where 
        table_schema    = PARSENAME(@table_name, 2) and
        table_name  = PARSENAME(@table_name, 1) and
        data_type in ('char', 'varchar', 'nchar', 'nvarchar', 'text', 'ntext') and
        QUOTENAME(column_name) > @field_name
    )

    /* search that field for the string supplied */
    if @field_name is not null
    begin
      insert into ##string_locations
      exec(
        'select ''' + @table_name + ''',''' + @field_name + ''',' + @field_name + 
        'from ' + @table_name + ' (nolock) ' +
        'where patindex(' + @search_string + ',' + @field_name + ') > 0'  /* patindex works with char & text */
      )
    end
    ;
  end
  ;
end
;

/* return results */
select table_name, field_name, field_value from ##string_locations (nolock)
;
/* drop temp table */
--drop table ##string_locations
; 
```

* * *

## 回答 #7

> 赞同：4
> 
>             
> 
> 时间：2009-02-26T18:42:11.760

实际上我同意 MikeW (+1) 在这种情况下最好使用分析器。

无论如何，如果您真的需要获取 db 中的所有 (n)varchar 列并进行搜索。见下文。我想使用 INFORMATION_SCHEMA.Tables + 动态 SQL。普通搜索：

```
DECLARE @SearchText VARCHAR(100) 
SET @SearchText = '12'
DECLARE @Tables TABLE(N INT, TableName VARCHAR(100), ColumnNamesCSV VARCHAR(2000), SQL VARCHAR(4000))

INSERT INTO @Tables (TableName, ColumnNamesCSV)
SELECT  T.TABLE_NAME AS TableName, 
        ( SELECT C.Column_Name + ',' 
          FROM   INFORMATION_SCHEMA.Columns C 
          WHERE  T.TABLE_NAME = C.TABLE_NAME 
                 AND C.DATA_TYPE IN ('nvarchar','varchar') 
                 FOR XML PATH('')
        )
FROM    INFORMATION_SCHEMA.Tables T 

DELETE FROM @Tables WHERE ColumnNamesCSV IS NULL

INSERT INTO @Tables (N, TableName, ColumnNamesCSV)
SELECT ROW_NUMBER() OVER(ORDER BY TableName), TableName, ColumnNamesCSV  
FROM   @Tables

DELETE FROM @Tables WHERE N IS NULL

UPDATE @Tables 
SET ColumnNamesCSV = SUBSTRING(ColumnNamesCSV, 0, LEN(ColumnNamesCSV))

UPDATE @Tables 
SET SQL = 'SELECT * FROM ['+TableName+'] WHERE '''+@SearchText+''' IN ('+ColumnNamesCSV+')'

DECLARE @C INT, 
        @I INT, 
        @SQL VARCHAR(4000)

SELECT @I = 1, 
       @C = COUNT(1) 
FROM   @Tables

WHILE @I <= @C BEGIN
    SELECT @SQL = SQL FROM @Tables WHERE N = @I
    SET @I = @I+1
    EXEC(@SQL)
END 
```

和一个带有 LIKE 子句的：

```
DECLARE @SearchText VARCHAR(100) 
SET @SearchText = '12'

DECLARE @Tables TABLE(N INT, TableName VARCHAR(100), ColumnNamesCSVLike VARCHAR(2000), LIKESQL VARCHAR(4000))

INSERT INTO @Tables (TableName, ColumnNamesCSVLike)
SELECT   T.TABLE_NAME AS TableName, 
         (   SELECT  C.Column_Name + ' LIKE ''%'+@SearchText+'%'' OR ' 
             FROM    INFORMATION_SCHEMA.Columns C 
             WHERE   T.TABLE_NAME = C.TABLE_NAME 
                     AND C.DATA_TYPE IN ('nvarchar','varchar') 
          FOR XML PATH(''))
FROM     INFORMATION_SCHEMA.Tables T

DELETE FROM @Tables WHERE ColumnNamesCSVLike IS NULL

INSERT INTO @Tables (N, TableName, ColumnNamesCSVLike)
SELECT ROW_NUMBER() OVER(ORDER BY TableName), TableName, ColumnNamesCSVLike 
FROM @Tables

DELETE FROM @Tables WHERE N IS NULL

UPDATE @Tables 
SET  ColumnNamesCSVLike = SUBSTRING(ColumnNamesCSVLike, 0, LEN(ColumnNamesCSVLike)-2)

UPDATE @Tables SET LIKESQL = 'SELECT * FROM ['+TableName+'] WHERE '+ColumnNamesCSVLike

DECLARE @C INT, 
        @I INT, 
        @LIKESQL VARCHAR(4000)

SELECT @I = 1, 
       @C = COUNT(1) 
FROM @Tables

WHILE @I <= @C BEGIN
    SELECT @LIKESQL = LIKESQL FROM @Tables WHERE N = @I
    SET @I = @I +1
    EXEC(@LIKESQL)
END 
```

* * *

## 回答 #8

> 赞同：4
> 
>             
> 
> 时间：2010-06-21T21:55:47.107

已经发布的其他答案可能同样有效或更好，但我没有使用它们。但是，我使用了以下 SQL，当我尝试对具有巨大（且非常杂乱无章的）SQL Server 数据库的大型系统进行逆向工程时，它确实帮助了我。

这不是我的代码。我希望我能相信原作者，但我再也找不到文章的链接了:(

```
Use 
go

declare @SearchChar varchar(8000)
Set @SearchChar =  -- Like 'A%', '11/11/2006'

declare @CMDMain varchar(8000), @CMDMainCount varchar(8000),@CMDJoin varchar(8000)
declare @ColumnName varchar(100),@TableName varchar(100)

declare dbTable cursor for 
SELECT 
Distinct b.Name as TableName
FROM 
sysobjects b
WHERE 
b.type='u' and b.Name  'dtproperties'
order by b.name
open dbTable
fetch next from dbTable into @TableName

WHILE @@FETCH_STATUS = 0
BEGIN
declare db cursor for 
SELECT 
c.Name as ColumnName
FROM 
sysobjects b,
syscolumns c
WHERE 
C.id = b.id and
b.type='u' and b.Name = @TableName
order by b.name
open db
fetch next from db into @ColumnName
set @CMDMain = 'SELECT ' + char(39) + @TableName + char(39) + ' as TableName,'+ 
' ['+ @TableName + '].* FROM [' + @TableName + ']'+
' WHERE '
set @CMDMainCount = 'SELECT Count(*) FROM [' + @TableName + '] Where '
Set @CMDJoin = ''
WHILE @@FETCH_STATUS = 0
BEGIN
set @CMDJoin = @CMDJoin + 'Convert(varchar(5000),[' +@ColumnName + ']) like ' + char(39) + @SearchChar + char(39) + ' OR '

fetch next from db into @ColumnName
end
close db
deallocate db

Set @CMDMainCount = 'If ('+ @CMDMainCount + Left(@CMDJoin, len(@CMDJoin) - 3)+ ') > 0 Begin '
Set @CMDMain = @CMDMainCount + @CMDMain + Left(@CMDJoin, len(@CMDJoin) - 3)
Set @CMDMain = @CMDMain + ' End '

Print @CMDMain

exec (@CMDMain)
fetch next from dbTable into @TableName
end
close dbTable
deallocate dbTable
```

* * *

## 回答 #9

> 赞同：3
> 
>             
> 
> 时间：2013-05-29T08:19:05.683

这不使用游标或类似的东西，只使用一个动态查询。

另请注意，这使用`LIKE`. 因为那恰好是我需要的。它适用于所有模式、所有表，并且仅查询那些具有 UDDT`NVARCHAR`或`VARCHAR`即使它们具有 UDDT 的列。

```
DECLARE @searchstring  NVARCHAR(255)
SET @searchstring = '%searchstring%'

DECLARE @sql NVARCHAR(max)

SELECT @sql = STUFF((
    SELECT ' UNION ALL SELECT ''' + TABLE_NAME + ''' AS tablename, ''' + COLUMN_NAME + ''' AS columnname, ' + COLUMN_NAME + ' AS valuename' + 
    ' FROM ' + TABLE_SCHEMA + '.' + TABLE_NAME + 
    ' WHERE ' + COLUMN_NAME + ' LIKE ''' + @searchstring + ''''
    FROM INFORMATION_SCHEMA.COLUMNS 
    WHERE DATA_TYPE in ('nvarchar', 'varchar')
    FOR XML PATH('')
) ,1, 11, '')

EXEC(@sql) 
```

输出为您提供表、列和值。在小型数据库上执行的时间约为 3 秒，大约有 3000 个结果。

* * *

## 回答 #10

> 赞同：3
> 
>             
> 
> 时间：2013-08-08T16:52:58.057

@NLwino，很好的查询，关键字使用有一些错误。我不得不稍微修改一下以用 [ ] 包装关键字，并查看 char 和 ntext 列。

```
 DECLARE @searchstring  NVARCHAR(255)
    SET @searchstring = '%WDB1014%'

    DECLARE @sql NVARCHAR(max)

    SELECT @sql = STUFF((
      SELECT ' UNION ALL SELECT ''' + TABLE_NAME + ''' AS tbl, ''' + COLUMN_NAME + ''' AS col, [' + COLUMN_NAME + '] AS val' + 
        ' FROM ' + TABLE_SCHEMA + '.[' + TABLE_NAME + 
        '] WHERE [' + COLUMN_NAME + '] LIKE ''' + @searchstring + ''''
        FROM INFORMATION_SCHEMA.COLUMNS 
        WHERE DATA_TYPE in ('nvarchar', 'varchar', 'char', 'ntext')
                  FOR XML PATH('')
             ) ,1, 11, '')

    Exec (@sql) 
```

我在 2.5 GB 数据库上运行它，它在 51 秒内返回

* * *

## 回答 #11

> 赞同：2
> 
>             
> 
> 时间：2011-08-02T13:04:24.247

```
/*
This procedure is for finding any string or date in all tables
if search string is date, its format should be yyyy-MM-dd
eg. 2011-07-05
*/

-- ================================================
-- Exec SearchInTables 'f6f56934-a5d4-4967-80a1-1a2223b9c7b1'

-- ================================================
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:      <Joshy,,Name>
-- Create date: <Create Date,,>
-- Description: <Description,,>
-- =============================================
ALTER PROCEDURE SearchInTables
@myValue nvarchar(1000)
AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    -- Insert statements for procedure here
        DECLARE @searchsql nvarchar(max)
        DECLARE @table_name nvarchar(1000)
        DECLARE @Schema_name nvarchar(1000)
        DECLARE @ParmDefinition nvarchar(500)
        DECLARE @XMLIn nvarchar(max)
        SET @ParmDefinition = N'@XMLOut varchar(max) OUTPUT'

        SELECT A.name,b.name 
        FROM sys.tables A 
            INNER JOIN sys.schemas B ON A.schema_id=B.schema_id
        WHERE A.name like 'tbl_Tax_Sections' 

        DECLARE tables_cur CURSOR FOR 
                            SELECT A.name,b.name FOM sys.tables A 
                            INNER JOIN sys.schemas B ON A.schema_id=B.schema_id
                            WHERE A.type = 'U'  
        OPEN tables_cur  
        FETCH NEXT FROM tables_cur INTO @table_name , @Schema_name 
            WHILE (@@FETCH_STATUS = 0) 
            BEGIN
                SET @searchsql ='SELECT @XMLOut=(SELECT PATINDEX(''%'+ @myValue+ '%'''
                SET @searchsql =@searchsql  + ', (SELECT * FROM '+@Schema_name+'.'+@table_name+' FOR XML AUTO) ))'
                --print @searchsql 
                EXEC sp_executesql @searchsql, @ParmDefinition, @XMLOut=@XMLIn OUTPUT
                --print @XMLIn 

                IF @XMLIn <> 0 PRINT @Schema_name+'.'+@table_name

                FETCH NEXT FROM tables_cur INTO @table_name , @Schema_name 

            END
        CLOSE tables_cur 
        DEALLOCATE tables_cur 
    RETURN
END
GO 
```

* * *

## 回答 #12

> 赞同：2
> 
>             
> 
> 时间：2015-04-22T04:48:45.410

我认为这是在数据库的所有行中查找字符串的最简单方法——无需使用*游标*和*FOR* XML—— 。

```
CREATE PROCEDURE SPFindAll (@find VARCHAR(max) = '')
AS
BEGIN
    SET NOCOUNT ON;
    --
    DECLARE @query VARCHAR(max) = ''

    SELECT  @query = @query + 
            CASE 
                WHEN @query = '' THEN '' 
                ELSE ' UNION ALL '
            END +
            'SELECT ''' + s.name + ''' As schemaName, ''' + t.name + ''' As tableName, ''' + c.name + ''' As ColumnName, [' + c.name + '] COLLATE DATABASE_DEFAULT As [Data] FROM [' + s.name + '].[' + t.name + '] WHERE [' + c.name + '] Like ''%' + @find + '%'''
    FROM 
        sys.schemas s
        INNER JOIN
        sys.tables t ON s.[schema_id] = t.[schema_id]
        INNER JOIN 
        sys.columns c ON t.[object_id] = c.[object_id]
        INNER JOIN
        sys.types ty ON c.user_type_id = ty.user_type_id
    WHERE
        ty.name LIKE '%char'

    EXEC(@query)
END 
```

通过创建此存储过程，您可以为任何要查找的字符串运行它，如下所示：

```
EXEC SPFindAll 'Hello World' 
```

结果将是这样的：

```
schemaName | tableName | columnName | Data
-----------+-----------+------------+-----------------------
schema1    | Table1    | Column1    | Hello World
schema1    | Table1    | Column1    | Hello World!
schema1    | Table2    | Column1    | I say "Hello World".
schema1    | Table2    | Column2    | Hello World 
```

* * *

## 回答 #13

> 赞同：1
> 
>             
> 
> 时间：2009-07-03T03:29:34.370

要“查找我从哪里获得的数据”，您可以启动 SQL Profiler，启动您的报告或应用程序，您将看到针对您的数据库发出的所有查询。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2017-03-02T03:19:57.703

或者，您可以在此处使用我的查询，应该比为您要搜索的每个数据库创建 sProcs 更简单：[FullParam SQL 博客](http://fullparam.wordpress.com/2012/09/07/fck-it-i-am-going-to-search-all-tables-all-collumns/)

```
/* Reto Egeter, fullparam.wordpress.com */

DECLARE @SearchStrTableName nvarchar(255), @SearchStrColumnName nvarchar(255), @SearchStrColumnValue nvarchar(255), @SearchStrInXML bit, @FullRowResult bit, @FullRowResultRows int
SET @SearchStrColumnValue = '%searchthis%' /* use LIKE syntax */
SET @FullRowResult = 1
SET @FullRowResultRows = 3
SET @SearchStrTableName = NULL /* NULL for all tables, uses LIKE syntax */
SET @SearchStrColumnName = NULL /* NULL for all columns, uses LIKE syntax */
SET @SearchStrInXML = 0 /* Searching XML data may be slow */

IF OBJECT_ID('tempdb..#Results') IS NOT NULL DROP TABLE #Results
CREATE TABLE #Results (TableName nvarchar(128), ColumnName nvarchar(128), ColumnValue nvarchar(max),ColumnType nvarchar(20))

SET NOCOUNT ON

DECLARE @TableName nvarchar(256) = '',@ColumnName nvarchar(128),@ColumnType nvarchar(20), @QuotedSearchStrColumnValue nvarchar(110), @QuotedSearchStrColumnName nvarchar(110)
SET @QuotedSearchStrColumnValue = QUOTENAME(@SearchStrColumnValue,'''')
DECLARE @ColumnNameTable TABLE (COLUMN_NAME nvarchar(128),DATA_TYPE nvarchar(20))

WHILE @TableName IS NOT NULL
BEGIN
    SET @TableName = 
    (
        SELECT MIN(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME))
        FROM    INFORMATION_SCHEMA.TABLES
        WHERE       TABLE_TYPE = 'BASE TABLE'
            AND TABLE_NAME LIKE COALESCE(@SearchStrTableName,TABLE_NAME)
            AND QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME) > @TableName
            AND OBJECTPROPERTY(OBJECT_ID(QUOTENAME(TABLE_SCHEMA) + '.' + QUOTENAME(TABLE_NAME)), 'IsMSShipped') = 0
    )
    IF @TableName IS NOT NULL
    BEGIN
        DECLARE @sql VARCHAR(MAX)
        SET @sql = 'SELECT QUOTENAME(COLUMN_NAME),DATA_TYPE
                FROM    INFORMATION_SCHEMA.COLUMNS
                WHERE       TABLE_SCHEMA    = PARSENAME(''' + @TableName + ''', 2)
                AND TABLE_NAME  = PARSENAME(''' + @TableName + ''', 1)
                AND DATA_TYPE IN (' + CASE WHEN ISNUMERIC(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(@SearchStrColumnValue,'%',''),'_',''),'[',''),']',''),'-','')) = 1 THEN '''tinyint'',''int'',''smallint'',''bigint'',''numeric'',''decimal'',''smallmoney'',''money'',' ELSE '' END + '''char'',''varchar'',''nchar'',''nvarchar'',''timestamp'',''uniqueidentifier''' + CASE @SearchStrInXML WHEN 1 THEN ',''xml''' ELSE '' END + ')
                AND COLUMN_NAME LIKE COALESCE(' + CASE WHEN @SearchStrColumnName IS NULL THEN 'NULL' ELSE '''' + @SearchStrColumnName + '''' END  + ',COLUMN_NAME)'
        INSERT INTO @ColumnNameTable
        EXEC (@sql)
        WHILE EXISTS (SELECT TOP 1 COLUMN_NAME FROM @ColumnNameTable)
        BEGIN
            PRINT @ColumnName
            SELECT TOP 1 @ColumnName = COLUMN_NAME,@ColumnType = DATA_TYPE FROM @ColumnNameTable
            SET @sql = 'SELECT ''' + @TableName + ''',''' + @ColumnName + ''',' + CASE @ColumnType WHEN 'xml' THEN 'LEFT(CAST(' + @ColumnName + ' AS nvarchar(MAX)), 4096),''' 
            WHEN 'timestamp' THEN 'master.dbo.fn_varbintohexstr('+ @ColumnName + '),'''
            ELSE 'LEFT(' + @ColumnName + ', 4096),''' END + @ColumnType + ''' 
                    FROM ' + @TableName + ' (NOLOCK) ' +
                    ' WHERE ' + CASE @ColumnType WHEN 'xml' THEN 'CAST(' + @ColumnName + ' AS nvarchar(MAX))' 
                    WHEN 'timestamp' THEN 'master.dbo.fn_varbintohexstr('+ @ColumnName + ')'
                    ELSE @ColumnName END + ' LIKE ' + @QuotedSearchStrColumnValue
            INSERT INTO #Results
            EXEC(@sql)
            IF @@ROWCOUNT > 0 IF @FullRowResult = 1 
            BEGIN
                SET @sql = 'SELECT TOP ' + CAST(@FullRowResultRows AS VARCHAR(3)) + ' ''' + @TableName + ''' AS [TableFound],''' + @ColumnName + ''' AS [ColumnFound],''FullRow>'' AS [FullRow>],*' +
                    ' FROM ' + @TableName + ' (NOLOCK) ' +
                    ' WHERE ' + CASE @ColumnType WHEN 'xml' THEN 'CAST(' + @ColumnName + ' AS nvarchar(MAX))' 
                    WHEN 'timestamp' THEN 'master.dbo.fn_varbintohexstr('+ @ColumnName + ')'
                    ELSE @ColumnName END + ' LIKE ' + @QuotedSearchStrColumnValue
                EXEC(@sql)
            END
            DELETE FROM @ColumnNameTable WHERE COLUMN_NAME = @ColumnName
        END 
    END
END
SET NOCOUNT OFF 
```

SELECT TableName, ColumnName, ColumnValue, ColumnType, COUNT(*) AS Count FROM #Results GROUP BY TableName, ColumnName, ColumnValue, ColumnType

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2019-03-01T17:28:17.287

这个查询可以为你做这件事。

```
DECLARE
@search_string  VARCHAR(100),
@table_name     SYSNAME,
@table_id       INT,
@column_name    SYSNAME,
@sql_string     VARCHAR(2000)

SET @search_string = 'StringtoSearch'

DECLARE tables_cur CURSOR FOR SELECT ss.name +'.'+ so.name [name], object_id FROM sys.objects so INNER JOIN sys.schemas ss ON so.schema_id = ss.schema_id WHERE  type = 'U'

OPEN tables_cur

FETCH NEXT FROM tables_cur INTO @table_name, @table_id

WHILE (@@FETCH_STATUS = 0)
BEGIN
    DECLARE columns_cur CURSOR FOR SELECT name FROM sys.columns WHERE object_id = @table_id 
        AND system_type_id IN (167, 175, 231, 239, 99)

    OPEN columns_cur

    FETCH NEXT FROM columns_cur INTO @column_name
        WHILE (@@FETCH_STATUS = 0)
        BEGIN
            SET @sql_string = 'IF EXISTS (SELECT * FROM ' + @table_name + ' WHERE [' + @column_name + '] 
            LIKE ''%' + @search_string + '%'') PRINT ''' + @table_name + ', ' + @column_name + ''''

            EXECUTE(@sql_string)

        FETCH NEXT FROM columns_cur INTO @column_name
        END

    CLOSE columns_cur

DEALLOCATE columns_cur

FETCH NEXT FROM tables_cur INTO @table_name, @table_id
END

CLOSE tables_cur
DEALLOCATE tables_cur 
```

# javascript - 抛出异常时如何获取 JavaScript 堆栈跟踪？

> ID：591857
> 
>         
> 
> 赞同：616
> 
>         
> 
> 时间：2009-02-26T18:36:33.163
> 
>         
> 
> 标签：javascript, stack-trace

如果我自己抛出一个 JavaScript 异常（例如，`throw "AArrggg"`），我如何获得堆栈跟踪（在 Firebug 中或其他中）？现在我刚刚收到消息。

**编辑**：正如下面许多人发布的那样，可以获得*JavaScript 异常*的堆栈跟踪，但我想获得*我的*异常的堆栈跟踪。例如：

```
function foo() {
    bar(2);
}
function bar(n) {
    if (n < 2)
        throw "Oh no! 'n' is too small!"
    bar(n-1);
} 
```

当`foo`被调用时，我想获得一个堆栈跟踪，其中包括对`foo`, `bar`,的调用`bar`。

* * *

## 回答 #1

> 赞同：909
> 
>             
> 
> 时间：2009-03-11T18:50:56.327

**编辑 2（2017 年）：**

在所有现代浏览器中，您可以简单地调用：`console.trace();` [（MDN 参考）](https://developer.mozilla.org/en-US/docs/Web/API/Console/trace)

**编辑 1 (2013):**

正如对原始问题的评论中指出的那样，一个更好（和更简单）的解决方案是使用对象的`stack`属性，`Error`如下所示：

```
function stackTrace() {
    var err = new Error();
    return err.stack;
} 
```

这将生成如下输出：

```
DBX.Utils.stackTrace@http://localhost:49573/assets/js/scripts.js:44
DBX.Console.Debug@http://localhost:49573/assets/js/scripts.js:9
.success@http://localhost:49573/:462
x.Callbacks/c@http://localhost:49573/assets/js/jquery-1.10.2.min.js:4
x.Callbacks/p.fireWith@http://localhost:49573/assets/js/jquery-1.10.2.min.js:4
k@http://localhost:49573/assets/js/jquery-1.10.2.min.js:6
.send/r@http://localhost:49573/assets/js/jquery-1.10.2.min.js:6 
```

给出调用函数的名称以及 URL、它的调用函数等。

**原件（2009 年）：**

[此代码段](https://web.archive.org/web/20090504054309/http://ivan-ghandhi.livejournal.com/942493.html)的修改版本可能会有所帮助：

```
function stacktrace() { 
  function st2(f) {
    return !f ? [] : 
        st2(f.caller).concat([f.toString().split('(')[0].substring(9) + '(' + f.arguments.join(',') + ')']);
  }
  return st2(arguments.callee.caller);
} 
```

* * *

## 回答 #2

> 赞同：213
> 
>             
> 
> 时间：2010-11-16T23:47:33.327

请注意，chromium/chrome（其他使用 V8 的浏览器）和 Firefox 确实有一个方便的接口，可以通过*Error*对象的*堆栈*属性获取堆栈跟踪。

 *```
try {
   // Code throwing an exception
} catch(e) {
  console.log(e.stack);
} 
```

它适用于基本异常以及您自己抛出的异常。（考虑到您使用 Error 类，这无论如何都是一个好习惯）。

查看[V8 文档的详细信息](https://v8.dev/docs/stack-trace-api)

* * *

## 回答 #3

> 赞同：86
> 
>             
> 
> 时间：2013-02-27T20:38:35.150

在 Firefox 中，您似乎不需要抛出异常。做就够了

```
e = new Error();
console.log(e.stack); 
```

* * *

## 回答 #4

> 赞同：25
> 
>             
> 
> 时间：2009-02-26T22:58:54.513

如果您有 firebug，则脚本选项卡中的所有错误选项都会中断。脚本到达断点后，您可以查看 firebug 的堆栈窗口：

![截屏](https://i.stack.imgur.com/XA8Bf.png)

* * *

## 回答 #5

> 赞同：17
> 
>             
> 
> 时间：2013-08-13T17:35:20.257

正如对原始问题的评论中指出的那样，一个好的（且简单的）解决方案是使用对象的`stack`属性，`Error`如下所示：

```
function stackTrace() {
    var err = new Error();
    return err.stack;
} 
```

这将生成如下输出：

```
DBX.Utils.stackTrace@http://localhost:49573/assets/js/scripts.js:44
DBX.Console.Debug@http://localhost:49573/assets/js/scripts.js:9
.success@http://localhost:49573/:462
x.Callbacks/c@http://localhost:49573/assets/js/jquery-1.10.2.min.js:4
x.Callbacks/p.fireWith@http://localhost:49573/assets/js/jquery-1.10.2.min.js:4
k@http://localhost:49573/assets/js/jquery-1.10.2.min.js:6
.send/r@http://localhost:49573/assets/js/jquery-1.10.2.min.js:6 
```

给出调用函数的名称以及 URL 和行号、它的调用函数等。

我有一个非常精细和漂亮的解决方案，我为我目前正在从事的项目设计了它，并且我已经提取并重新设计了它以进行概括。这里是：

```
(function(context){
    // Only global namespace.
    var Console = {
        //Settings
        settings: {
            debug: {
                alwaysShowURL: false,
                enabled: true,
                showInfo: true
            },
            stackTrace: {
                enabled: true,
                collapsed: true,
                ignoreDebugFuncs: true,
                spacing: false
            }
        }
    };

    // String formatting prototype function.
    if (!String.prototype.format) {
        String.prototype.format = function () {
            var s = this.toString(),
                args = typeof arguments[0],
                args = (("string" == args || "number" == args) ? arguments : arguments[0]);
            if (!arguments.length)
                return s;
            for (arg in args)
                s = s.replace(RegExp("\\{" + arg + "\\}", "gi"), args[arg]);
            return s;
        }
    }

    // String repeating prototype function.
    if (!String.prototype.times) {
        String.prototype.times = function () {
            var s = this.toString(),
                tempStr = "",
                times = arguments[0];
            if (!arguments.length)
                return s;
            for (var i = 0; i < times; i++)
                tempStr += s;
            return tempStr;
        }
    }

    // Commonly used functions
    Console.debug = function () {
        if (Console.settings.debug.enabled) {
            var args = ((typeof arguments !== 'undefined') ? Array.prototype.slice.call(arguments, 0) : []),
                sUA = navigator.userAgent,
                currentBrowser = {
                    firefox: /firefox/gi.test(sUA),
                    webkit: /webkit/gi.test(sUA),
                },
                aLines = Console.stackTrace().split("\n"),
                aCurrentLine,
                iCurrIndex = ((currentBrowser.webkit) ? 3 : 2),
                sCssBlack = "color:black;",
                sCssFormat = "color:{0}; font-weight:bold;",
                sLines = "";

            if (currentBrowser.firefox)
                aCurrentLine = aLines[iCurrIndex].replace(/(.*):/, "$1@").split("@");
            else if (currentBrowser.webkit)
                aCurrentLine = aLines[iCurrIndex].replace("at ", "").replace(")", "").replace(/( \()/gi, "@").replace(/(.*):(\d*):(\d*)/, "$1@$2@$3").split("@");

            // Show info if the setting is true and there's no extra trace (would be kind of pointless).
            if (Console.settings.debug.showInfo && !Console.settings.stackTrace.enabled) {
                var sFunc = aCurrentLine[0].trim(),
                    sURL = aCurrentLine[1].trim(),
                    sURL = ((!Console.settings.debug.alwaysShowURL && context.location.href == sURL) ? "this page" : sURL),
                    sLine = aCurrentLine[2].trim(),
                    sCol;

                if (currentBrowser.webkit)
                    sCol = aCurrentLine[3].trim();

                console.info("%cOn line %c{0}%c{1}%c{2}%c of %c{3}%c inside the %c{4}%c function:".format(sLine, ((currentBrowser.webkit) ? ", column " : ""), ((currentBrowser.webkit) ? sCol : ""), sURL, sFunc),
                             sCssBlack, sCssFormat.format("red"),
                             sCssBlack, sCssFormat.format("purple"),
                             sCssBlack, sCssFormat.format("green"),
                             sCssBlack, sCssFormat.format("blue"),
                             sCssBlack);
            }

            // If the setting permits, get rid of the two obvious debug functions (Console.debug and Console.stackTrace).
            if (Console.settings.stackTrace.ignoreDebugFuncs) {
                // In WebKit (Chrome at least), there's an extra line at the top that says "Error" so adjust for this.
                if (currentBrowser.webkit)
                    aLines.shift();
                aLines.shift();
                aLines.shift();
            }

            sLines = aLines.join(((Console.settings.stackTrace.spacing) ? "\n\n" : "\n")).trim();

            trace = typeof trace !== 'undefined' ? trace : true;
            if (typeof console !== "undefined") {
                for (var arg in args)
                    console.debug(args[arg]);

                if (Console.settings.stackTrace.enabled) {
                    var sCss = "color:red; font-weight: bold;",
                        sTitle = "%c Stack Trace" + " ".times(70);

                    if (Console.settings.stackTrace.collapsed)
                        console.groupCollapsed(sTitle, sCss);
                    else
                        console.group(sTitle, sCss);

                    console.debug("%c" + sLines, "color: #666666; font-style: italic;");

                    console.groupEnd();
                }
            }
        }
    }
    Console.stackTrace = function () {
        var err = new Error();
        return err.stack;
    }

    context.Console = Console;
})(window); 
```

[在GitHub 上](https://github.com/gabrielnahmias/Console.js)查看（当前为 v1.2）！您可以像使用它一样使用它`Console.debug("Whatever");`，它会根据 中的设置`Console`打印输出和堆栈跟踪（或者只是简单的信息/根本没有额外的东西）。这是一个例子：

![控制台.js](https://i.stack.imgur.com/HfgLP.png)

确保玩弄`Console`对象中的设置！您可以在轨迹线之间添加间距并将其完全关闭。这是`Console.trace`设置为`false`：

![没有痕迹](https://i.stack.imgur.com/6310K.png)

您甚至可以关闭显示的第一位信息（设置`Console.settings.debug.showInfo`为`false`）或完全禁用调试（设置`Console.settings.debug.enabled`为`false`），这样您就不必再次注释掉调试语句了！把它们留在里面，这将无济于事。

* * *

## 回答 #6

> 赞同：11
> 
>             
> 
> 时间：2009-02-26T18:39:47.943

我不认为有任何内置的东西可以使用，但是我确实找到了很多人自己滚动的例子。

*   [DIY javascript 堆栈跟踪](http://helephant.com/2007/05/diy-javascript-stack-trace/)

*   [任何浏览器中的 Javascript 堆栈跟踪](http://eriwen.com/javascript/js-stack-trace/)

* * *

## 回答 #7

> 赞同：9
> 
>             
> 
> 时间：2009-08-21T05:43:49.303

即使你扔了它，你也可以访问实例的`stack`（`stacktrace`在 Opera 中）属性。`Error`问题是，您需要确保使用`throw new Error(string)`（不要忘记**新**的而不是`throw string`.

例子：

```
try {
    0++;
} catch (e) {
    var myStackTrace = e.stack || e.stacktrace || "";
} 
```

* * *

## 回答 #8

> 赞同：9
> 
>             
> 
> 时间：2014-07-03T18:07:36.473

使用 Chrome 浏览器，您可以使用`console.trace`方法：[https ://developer.chrome.com/devtools/docs/console-api#consoletraceobject](https://developer.chrome.com/devtools/docs/console-api#consoletraceobject)

* * *

## 回答 #9

> 赞同：7
> 
>             
> 
> 时间：2015-01-23T20:28:38.350

这将为现代 Chrome、Opera、Firefox 和 IE10+ 提供堆栈跟踪（作为字符串数组）

```
function getStackTrace () {

  var stack;

  try {
    throw new Error('');
  }
  catch (error) {
    stack = error.stack || '';
  }

  stack = stack.split('\n').map(function (line) { return line.trim(); });
  return stack.splice(stack[0] == 'Error' ? 2 : 1);
} 
```

用法：

```
console.log(getStackTrace().join('\n')); 
```

它从堆栈中排除了它自己的调用以及 Chrome 和 Firefox（但不是 IE）使用的标题“错误”。

它不应该在旧浏览器上崩溃，而只是返回空数组。如果您需要更通用的解决方案，请查看[stacktrace.js](http://www.stacktracejs.com/)。它支持的浏览器列表确实令人印象深刻，但在我看来，它对于它的小任务来说非常大：37Kb 的缩小文本，包括所有依赖项。

* * *

## 回答 #10

> 赞同：7
> 
>             
> 
> 时间：2015-03-12T21:07:46.780

尤金回答的更新：必须抛出错误对象才能让 IE（特定版本？）填充`stack`属性。以下应该比他当前的示例更好，并且应该避免`undefined`在 IE 中返回。

```
function stackTrace() {
  try {
    var err = new Error();
    throw err;
  } catch (err) {
    return err.stack;
  }
} 
```

注意 1：这种事情应该只在调试时进行，并且在上线时禁用，尤其是在频繁调用的情况下。注意 2：这可能不适用于所有浏览器，但似乎适用于 FF 和 IE 11，非常适合我的需求。

* * *

## 回答 #11

> 赞同：6
> 
>             
> 
> 时间：2012-03-14T03:43:20.823

在 Firebug 上获取真正的堆栈跟踪的一种方法是创建一个真正的错误，例如调用未定义的函数：

```
function foo(b){
  if (typeof b !== 'string'){
    // undefined Error type to get the call stack
    throw new ChuckNorrisError("Chuck Norris catches you.");
  }
}

function bar(a){
  foo(a);
}

foo(123); 
```

或者使用`console.error()`后跟`throw`语句 since`console.error()`显示堆栈跟踪。

* * *

## 回答 #12

> 赞同：5
> 
>             
> 
> 时间：2017-08-12T22:08:12.717

这个 polyfill 代码在现代（2017）浏览器（IE11、Opera、Chrome、FireFox、Yandex）中工作：

```
printStackTrace: function () {
    var err = new Error();
    var stack = err.stack || /*old opera*/ err.stacktrace || ( /*IE11*/ console.trace ? console.trace() : "no stack info");
    return stack;
} 
```

其他答案：

```
function stackTrace() {
  var err = new Error();
  return err.stack;
} 
```

不能在 IE 11 中工作！

使用**arguments.callee.caller** - 在任何浏览器中都不能在严格模式下工作！

* * *

## 回答 #13

> 赞同：3
> 
>             
> 
> 时间：2012-06-08T11:18:24.747

在 Google Chrome（版本 19.0 及更高版本）中，只需抛出异常即可完美运行。例如：

```
/* file: code.js, line numbers shown */

188: function fa() {
189:    console.log('executing fa...');
190:    fb();
191: }
192:
193: function fb() {
194:    console.log('executing fb...');
195:    fc()
196: }
197:
198: function fc() {
199:    console.log('executing fc...');
200:    throw 'error in fc...'
201: }
202:
203: fa(); 
```

将在浏览器的控制台输出中显示堆栈跟踪：

```
executing fa...                         code.js:189
executing fb...                         code.js:194
executing fc...                         cdoe.js:199
/* this is your stack trace */
Uncaught error in fc...                 code.js:200
    fc                                  code.js:200
    fb                                  code.js:195
    fa                                  code.js:190
    (anonymous function)                code.js:203 
```

希望这有帮助。

* * *

## 回答 #14

> 赞同：3
> 
>             
> 
> 时间：2016-03-23T07:09:10.697

功能：

```
function print_call_stack(err) {
    var stack = err.stack;
    console.error(stack);
} 
```

用例：

```
 try{
         aaa.bbb;//error throw here
     }
     catch (err){
         print_call_stack(err); 
     } 
```

* * *

## 回答 #15

> 赞同：2
> 
>             
> 
> 时间：2015-10-30T10:46:50.973

```
<script type="text/javascript"
src="https://rawgithub.com/stacktracejs/stacktrace.js/master/stacktrace.js"></script>
<script type="text/javascript">
    try {
        // error producing code
    } catch(e) {
        var trace = printStackTrace({e: e});
        alert('Error!\n' + 'Message: ' + e.message + '\nStack trace:\n' + trace.join('\n'));
        // do something else with error
    }
</script> 
```

此脚本将显示错误

* * *

## 回答 #16

> 赞同：2
> 
>             
> 
> 时间：2017-03-17T16:48:38.813

```
function stacktrace(){
  return (new Error()).stack.split('\n').reverse().slice(0,-2).reverse().join('\n');
} 
```

* * *

## 回答 #17

> 赞同：2
> 
>             
> 
> 时间：2021-01-26T21:35:42.710

**至少在 Edge 2021 中：**

```
console.groupCollapsed('jjjjjjjjjjjjjjjjj')
    console.trace()
    try {
        throw "kuku"
    } catch(e) {
        console.log(e.stack)
    }
console.groupEnd()
traceUntillMe() 
```

你完了，我的朋友

* * *

## 回答 #18

> 赞同：1
> 
>             
> 
> 时间：2014-07-13T13:38:36.400

有点晚了，但是，这是另一个解决方案，它**自动检测**arguments.callee 是否可用，如果没有，则使用 new Error().stack。在 chrome、safari 和 firefox 中测试。

2 个变体 - stackFN(n) 为您提供远离直接调用者的函数 n 的名称，而 stackArray() 为您提供一个数组，stackArray()[0] 是直接调用者。

[在http://jsfiddle.net/qcP9y/6/](http://jsfiddle.net/qcP9y/6/)尝试一下

```
// returns the name of the function at caller-N
// stackFN()  = the immediate caller to stackFN
// stackFN(0) = the immediate caller to stackFN
// stackFN(1) = the caller to stackFN's caller
// stackFN(2) = and so on
// eg console.log(stackFN(),JSON.stringify(arguments),"called by",stackFN(1),"returns",retval);
function stackFN(n) {
    var r = n ? n : 0, f = arguments.callee,avail=typeof f === "function",
        s2,s = avail ? false : new Error().stack;
    if (s) {
        var tl=function(x) { s = s.substr(s.indexOf(x) + x.length);},
        tr = function (x) {s = s.substr(0, s.indexOf(x) - x.length);};
        while (r-- >= 0) {
            tl(")");
        }
        tl(" at ");
        tr("(");
        return s;
    } else {
        if (!avail) return null;
        s = "f = arguments.callee"
        while (r>=0) {
            s+=".caller";
            r--;   
        }
        eval(s);
        return f.toString().split("(")[0].trim().split(" ")[1];
    }
}
// same as stackFN() but returns an array so you can work iterate or whatever.
function stackArray() {
    var res=[],f = arguments.callee,avail=typeof f === "function",
        s2,s = avail ? false : new Error().stack;
    if (s) {
        var tl=function(x) { s = s.substr(s.indexOf(x) + x.length);},
        tr = function (x) {s = s.substr(0, s.indexOf(x) - x.length);};
        while (s.indexOf(")")>=0) {
            tl(")");
            s2= ""+s;
            tl(" at ");
            tr("(");
            res.push(s);
            s=""+s2;
        }
    } else {
        if (!avail) return null;
        s = "f = arguments.callee.caller"
        eval(s);
        while (f) {
            res.push(f.toString().split("(")[0].trim().split(" ")[1]);
            s+=".caller";
            eval(s);
        }
    }
    return res;
}

function apple_makes_stuff() {
    var retval = "iPhones";
    var stk = stackArray();

    console.log("function ",stk[0]+"() was called by",stk[1]+"()");
    console.log(stk);
    console.log(stackFN(),JSON.stringify(arguments),"called by",stackFN(1),"returns",retval);
    return retval;
}

function apple_makes (){
    return apple_makes_stuff("really nice stuff");
}

function apple () {
    return apple_makes();
}

   apple(); 
```

* * *

## 回答 #19

> 赞同：1
> 
>             
> 
> 时间：2014-10-21T21:07:48.063

你可以使用这个库[http://www.stacktracejs.com/](http://www.stacktracejs.com/)。这很好

从文档

> 您还可以传入自己的错误以获取 IE 或 Safari 5 中不可用的堆栈跟踪

```
<script type="text/javascript" src="https://rawgithub.com/stacktracejs/stacktrace.js/master/stacktrace.js"></script>
<script type="text/javascript">
    try {
        // error producing code
    } catch(e) {
        var trace = printStackTrace({e: e});
        alert('Error!\n' + 'Message: ' + e.message + '\nStack trace:\n' + trace.join('\n'));
        // do something else with error
    }
</script> 
```

* * *

## 回答 #20

> 赞同：1
> 
>             
> 
> 时间：2017-04-05T00:52:38.043

这是一个可以为您提供最大性能（IE 6+）和最大兼容性的答案。兼容IE 6！

```
 function stacktrace( log_result ) {
    	var trace_result;
    // IE 6 through 9 compatibility
    // this is NOT an all-around solution because
    // the callee property of arguments is depredicated
    /*@cc_on
    	// theese fancy conditinals make this code only run in IE
    	trace_result = (function st2(fTmp) {
    		// credit to Eugene for this part of the code
    		return !fTmp ? [] :
    			st2(fTmp.caller).concat([fTmp.toString().split('(')[0].substring(9) + '(' + fTmp.arguments.join(',') + ')']);
    	})(arguments.callee.caller);
    	if (log_result) // the ancient way to log to the console
    		Debug.write( trace_result );
    	return trace_result;
    @*/
    	console = console || Console;	// just in case
    	if (!(console && console.trace) || !log_result){
    		// for better performance in IE 10
    		var STerror=new Error();
    		var unformated=(STerror.stack || STerror.stacktrace);
    		trace_result = "\u25BC console.trace" + unformated.substring(unformated.indexOf('\n',unformated.indexOf('\n'))); 
    	} else {
    		// IE 11+ and everyone else compatibility
    		trace_result = console.trace();
    	}
    	if (log_result)
    		console.log( trace_result );

    	return trace_result;
    }
// test code
(function testfunc(){
	document.write( "<pre>" + stacktrace( false ) + "</pre>" );
})();
```

* * *

## 回答 #21

> 赞同：0
> 
>             
> 
> 时间：2009-03-04T02:53:56.967

在 Firefox 上比在 IE 上更容易获得堆栈跟踪，但基本上这是您想要做的：

将“有问题的”代码段包装在 try/catch 块中：

```
try {
    // some code that doesn't work
    var t = null;
    var n = t.not_a_value;
}
    catch(e) {
} 
```

如果您要检查“错误”对象的内容，它包含以下字段：

e.fileName ：问题来自的源文件/页面 e.lineNumber ：出现问题的文件/页面中的行号 e.message ：描述发生什么类型的错误的简单消息 e.name ：类型发生的错误，在上面的示例中应该是 'TypeError' e.stack ：包含导致异常的堆栈跟踪

我希望这能够帮到你。

* * *

## 回答 #22

> 赞同：0
> 
>             
> 
> 时间：2014-10-15T12:28:59.543

我不得不用 IE11 研究 smartgwt 中的无限递归，所以为了更深入地研究，我需要一个堆栈跟踪。问题是，我无法使用开发控制台，因为那样复制更加困难。

在 javascript 方法中使用以下内容：

```
try{ null.toString(); } catch(e) { alert(e.stack); } 
```

* * *

## 回答 #23

> 赞同：0
> 
>             
> 
> 时间：2015-10-03T07:09:19.747

哇 - 我在 6 年内没有看到一个人建议我们`stack`在使用之前先检查是否可用！您在错误处理程序中可以做的最糟糕的事情是因为调用不存在的东西而引发错误。

正如其他人所说，虽然`stack`现在大多数情况下可以安全使用，但 IE9 或更早版本不支持它。

我记录了我的意外错误，堆栈跟踪非常重要。为了获得最大的支持，我首先检查是否`Error.prototype.stack`存在并且是一个函数。如果是这样，那么使用它是安全的`error.stack`。

```
 window.onerror = function (message: string, filename?: string, line?: number, 
                                   col?: number, error?: Error)
        {
            // always wrap error handling in a try catch
            try 
            {
                // get the stack trace, and if not supported make our own the best we can
                var msg = (typeof Error.prototype.stack == 'function') ? error.stack : 
                          "NO-STACK " + filename + ' ' + line + ':' + col + ' + message;

                // log errors here or whatever you're planning on doing
                alert(msg);
            }
            catch (err)
            {

            }
        }; 
```

**编辑：**似乎因为`stack`是属性而不是方法，即使在旧浏览器上也可以安全地调用它。我仍然很困惑，因为我很确定`Error.prototype`以前检查对我有用，而现在却没有——所以我不确定发生了什么。

* * *

## 回答 #24

> 赞同：0
> 
>             
> 
> 时间：2016-01-22T13:52:45.253

使用`console.error(e.stack)`Firefox 仅在日志中显示堆栈跟踪，Chrome 也会显示消息。如果消息包含重要信息，这可能是一个糟糕的惊喜。始终记录两者。

* * *

## 回答 #25

> 赞同：0
> 
>             
> 
> 时间：2017-07-22T14:06:36.040

你试一试

```
throw new Error('some error here') 
```

这对 chrome 非常有效：

[![在此处输入图像描述](https://i.stack.imgur.com/6rQ5m.png)](https://i.stack.imgur.com/6rQ5m.png)

# regex - 验证网址并匹配空字符串的正则表达式？

> ID：591859
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-26T18:36:37.750
> 
>         
> 
> 标签：regex

当前表达式验证网址 (HTTP)，如何更改它以使空字符串也匹配？

```
(http|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])? 
```

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-26T22:28:57.830

如果要修改表达式以匹配完全空的字符串*或完整的 URL* **，**则需要使用锚元字符 ^ 和 $（分别匹配行的开头和结尾）。

```
^(|https?:\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])?)$ 
```

正如 dirkgently 指出的那样，您可以稍微简化您对协议的匹配，所以我也为您提供了它。

但是，如果您在程序或脚本中使用此表达式，则使用语言自己的方法来检查输入是否为空可能会更简单。

```
// in no particular language...
if input.length > 0 then
    if input matches <regex> then
        input is a URL
    else
        input is invalid
else
    input is empty 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T18:38:13.283

将整个表达式放在括号中并将其标记为可选（“<code>?”量词，不重复或重复一次）：

```
((http|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])?)? 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T18:40:09.533

`Expr?``Expr`您的 URL 匹配器在哪里。就像我想`http`和`https`: `https?`。这`?`是一个被称为量词的——你可以查一下。来自[维基百科](http://en.wikipedia.org/wiki/Regular_expression)：

> ? 问号表示前面的元素为零或之一。

# asp.net - .NET 成员资格

> ID：591860
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-26T18:36:49.480
> 
>         
> 
> 标签：asp.net, membership

您好，我正在试用 .NET 的会员功能，并且正在使用 ASP.NET Web 应用程序管理工具。我的问题是用户数据存储在哪里？我检查了我的数据库，但在任何地方都找不到。我还尝试在管理工具的 Providers 中查找任何信息，但仍然找不到路径。有人可以帮我吗？谢谢。

[编辑] App_Data 文件夹中没有任何内容。

我还想知道当我右键单击 App_Data 并尝试添加数据库时，没有这样做的选项。（添加新项目）。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:38:38.803

我认为，默认情况下它会创建一个名为 aspnet 的数据库。

核实 ：）

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:39:20.457

在 Web 应用程序项目的 App_Data 文件夹中查找名为 ASPNETDB.MDF 的文件。那是一个 SQL Express 数据库文件。

编辑：尝试在 Windows 资源管理器中查看 App_Data 文件夹。它可能在磁盘上，但未显示在 Visual Studio 内的项目中。

[http://aspnet.4guysfromrolla.com/articles/120705-1.aspx](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:42:52.257

它保存在 ASP.NET 应用程序的 App_Data 文件夹下的数据库文件中。

您可以通过[aspnet_regsql.exe](http://msdn.microsoft.com/en-us/library/ms229862(VS.80).aspx)工具将其配置为包含在您的 sql server 实例中：

```
aspnet_regsql.exe -E -S localhost -A mr 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T18:40:33.403

检查您的 web.config 以获取到数据库的连接字符串。如果是 sql server，那么会有一堆表以 'aspnet_' 或类似的东西为前缀。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T18:48:20.823

如果您需要为成员资格/角色提供程序创建表和存储过程，您可以打开 Visual Studio 命令提示符（检查您的开始菜单）并运行`aspnet_regsql`. `.exe`也在目录下`%WINDOWSDIR%\Microsoft.NET\Framework\v2.0.50727\`。

它使您能够从运行的服务器中选择一个数据库并创建您需要处理的所有内容。

# php - Qcodo vs. CakePHP vs. Zend

> ID：591865
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-26T18:38:03.300
> 
>         
> 
> 标签：php, zend-framework, cakephp, qcodo

我对 CakePHP 有一些了解，并认为它是一个很棒的框架。然后，我遇到了一个叫做 Qcodo 的东西。它是另一个 PHP 框架。我一直在听 Zend。它们看起来都非常整洁，但我想知道所有这些框架之间有什么区别。

在我浪费太多时间学习另一个框架之前，有没有人知道每个框架的优缺点？

他们似乎都有一个共同的目标：使 PHP 中的 Web 应用程序开发变得简单、模块化和可扩展。

**编辑在**[CakePHP 和 Zend](http://2tbsp.com/node/87)
之间发现了这个有趣的比较结果

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-26T18:56:50.413

我从来没有听说过Qcodo。

CakePHP 是一个功能齐全的框架，具有很多自动化功能，但不幸的是，它是目前[最慢的框架](http://www.avnetlabs.com/php/php-framework-comparison-benchmarks)之一。它也没有官方论坛，也没有那么忙碌的社区。它试图成为一个 Ruby on Rails 的克隆，但它不能很好地与 PHP 一起工作。

Zend 令人印象深刻。它拥有强大的社区和企业支持。它很有特色，但也很臃肿（参见那个基准），所以它的性能适中。不过据我所知，您可以在不使用整个框架的情况下单独使用组件，甚至可以将它们与其他框架一起使用！

我在工作中使用[CodeIgniter](http://codeigniter.com/)，我喜欢它。它是迄今为止对新手最友好的框架，并且根据您的 CakePHP 经验，它应该是轻而易举的事。它有[非常好的文档](http://codeigniter.com/user_guide/toc.html)，详尽、清晰且写得很好。它有一些其他框架没有的特性（例如 ORM），但 CI 拥有我见过的最活跃的框架社区之一。由于为它编写库很容易，因此您可以找到一个库来做几乎任何您想做的事情 - ORM、身份验证等。此外，如果您想要一个用于 CI 的 ORM，我推荐[DataMapper](http://codeigniter.com/forums/viewthread/90181/)。

您可能还想查看[Kohana](http://kohanaphp.com/)。它是 CodeIgniter 的衍生产品。它是严格的 PHP5 并且有一个 ORM 和一些更多的特性。虽然我自己没用过，但我听说过好东西。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-26T18:46:36.257

我建议阅读每个功能并确定您需要什么，并查看您将最常使用的功能的代码示例。

有些框架对你来说可能很直观，但对其他人来说却不是。选择 PHP 框架是 IMO 非常个人的选择。

在使用 CakePHP 一段时间后，我自己一直在使用 CodeIgniter。切换的主要原因是性能，但 CakePHP 在过去几年里取得了长足的进步，所以这可能不再是一个正当的理由。

[编辑：显然，它仍然存在性能缺陷，请参阅 ryeguy 的帖子和评论。]

我从来没有发现 Zend 是直观的，也从未研究过 Qcodo。

维基百科有一个[按语言列出的网络应用程序框架列表](http://en.wikipedia.org/wiki/List_of_web_application_frameworks)，您也可以找到帮助您做出决定的信息。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-04-04T11:18:10.657

我同时使用 QCodo 和 Zend 框架

QCodo 是一个代码生成器的 MVC 框架，许多代码是从您的数据库设计中生成的，并为您的每个数据库表生成可供使用的搜索和编辑表单。它还处理数据库表关系，为表之间的一对多/多对多关系预先生成一组方法。

由于这些代码是从您的数据库设计中生成的，因此所有代码都针对每个项目进行了优化。简而言之，它是一个框架`database oriented`

..................................................... .

据我从这个项目的创始人那里知道，Zend 框架的设计是为了解耦所有模型，实际上他们正在为不同类型的项目部署大量现成的模型，来自 Zend_ACL（访问控制列表身份验证）、Zend _Search _Lucene、Zend _Service _Twitter、Zend _Service _Flickr 等）。我认为未来会有。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-04-11T15:56:45.860

我投票给 Qcodo！前段时间我做了一个最适合我的研究，结果是qcodo，现在我不能不考虑使用qcodo，或者至少他的数据库处理部分，这绝对是太棒了。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2010-02-14T14:30:23.663

我认为 Simfony 是最好的 PHP 框架，虽然我没有使用它。我主要使用 Qcodo/Qcubed，但我正在转向 Rails，这就是我觉得 Simfony 不错的原因。我尝试了 Code Igniter 并没有，它使用简单，轻巧（我想），但它没有任何脚手架，但现在可能会改变。正如另一个人所说，您可以使用外部 ORM，因为 CI 默认情况下没有。Zend Framework 有一个非常模块化的架构，并且有很多库。我使用了 Zend_ACL，但是权限继承很痛苦，所以我自己实现了，Zend_Lucene 查询没有找到我需要的数据...... ZF 是一个非常低级的框架，它也需要一个 ORM。我看了一下 CakePHP，但我发现它的数据库接口不是 Propel、Qcodo 和 Doctrine 级别的，但我认为你可以使用自己的库。

我通常希望在一个框架中：

*   ORM 和对象包装数据库中的真实行 ($objUser->Name = 'Jack')

*   MVC - 大多数都是 MVC

*   代码生成器（Qcodo 非常适合从数据库生成代码）

*   前端控制器，路由和url友好（Qcodo没有）

*   清理模板（Qcodo 有 $objLabel->Render()；不是真正的标签）

*   辅助方法，如 link_to、image_tag 等（Simphony 和 Ruby on Rails）

*   数据库迁移以跟踪数据库更改

*   集成测试框架来测试真正的应用程序，而不是几个孤立的功能（Rails 可以做到这一点，并且可能是 Simfony）

*   该框架的社区和流行度。

我遇到的大多数高级 PHP 开发人员都使用 Simfony，但这只是我个人的经验。

最后，我会使用 Simfony 位，我强烈建议尝试使用 Ruby 或 JRuby 的 Rails。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2011-04-21T15:45:01.493

确定最佳框架应该是逐个项目的决策。如果您有一个使用 innoDB 引擎的大型数据库，并且表之间存在大量关系，请查看 QCubed (Qcodo)。我没有看到任何框架可以处理复杂的 ORM 关系——甚至可以轻松地反转关系！它在处理复杂查询（例如反向关系查询）方面也相当快——尽管任何框架中的性能很大程度上取决于编码器高效编写的能力。

如果您正在构建一个 CMS，那么您将需要 Zend 或 Symfony 来实现 MVC 功能。QCubed/codo 据说是基于 MVC 的，但它似乎不像 Zend 那样清晰。QCodo 还依赖于从不更改数据库的结构 - 可以管理，但是一旦站点启动，向数据库表添加新字段真的很痛苦，因为它会为每个表自动生成自定义类。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T19:27:34.053

我使用 CodeIgniter 主要是因为它有非常好的文档并且以易于使用着称。此外，拉斯穆斯说这是他最喜欢的，这无疑是一个蹩脚的理由，但我没有抱怨。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-02-27T01:28:38.680

不要忽视 Symfony，它会摇摆不定。我想说它最大的优势是在各个层面上始终如一的“遵循最佳实践”方法、充满活力的社区和出色的文档。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2011-11-19T23:57:32.907

我正在使用 QCodo 的继任者 QCubed。它只是你可以从开源 PHP 框架中获得的最好的东西。如果您知道如何使其工作，速度会非常快。唯一的缺点是缺少文档。但是，示例站点很棒。开始使用它，我打赌你会很平静！:)

# asp.net - ASP.NET Web 控件可以接受构造函数中的任何内容吗？

> ID：591869
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-26T18:38:25.637
> 
>         
> 
> 标签：asp.net, asp.net-webcontrol, asp.net-customcontrol

我想要一个安全控件，但也想要扩展 asp.net 框架提供的现有按钮或文本框。所以我的类 dec 看起来像：

```
public class MyTextBox : System.Web.UI.WebControls.TextBox 
```

我正在考虑类似的策略模式，但不确定如何将 ISecureControl 传递给 ctor 或者可能是 init 方法之类的？

我可能正在回答我自己的问题。我想我可能能够覆盖 OnInit 或 OnPreInit 或其他东西并在那里创建并传递它，但不确定是否有办法在创建时以某种方式直接传递它？

```
override OnInit()
{
  secureControl = new MySecureControl();
}

override OnRender()
{
  if(secureControl.CanRender)
    base.OnRender();
} 
```

有没有更好的办法？还是我在这里解决我自己的问题...

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T18:49:49.947

为什么 MyTextBox 不只实现 ISecureControl？

```
public class MyTextBox : TextBox, ISecureControl 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:46:46.913

是的，就是这样。对于那种特定的情况，我会继续前进。如果 MySecureControl 有自己的构造函数参数，您可以查看依赖注入，但这意味着您将使用 ObjectFactory.GetInstance<> 之类的东西，或者只是 ObjectFactory.BuildUp(this) 并使用属性注入，而不是使用 new。不要出汗:)

# css - IE 6触发haslayout，使用* html div { height: 1%; 有什么副作用 }

> ID：591870
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-26T18:38:28.260
> 
>         
> 
> 标签：css, stylesheet, internet-explorer-6

有一段时间，我一直在放入`* html div { zoom: 1; }`我的基本样式表，并且效果很好。但是，我现在遇到这样的情况，即绝对定位的元素在 IE 6 中失去了它们的高度和宽度。所以我正在考虑`* html div { height: 1%; }`改用，但副作用是什么？

**更新：**

感谢您的所有回复。正如你们所说的那样，答案很可能没有副作用。

但是，我将不得不不同意您（在这个特定时刻）关于如何/何时触发 haslayout 的所有建议。我认为 haslayout 是一种理想的行为，因此应该是 IE6 (& 7) 中的默认行为。

有人提到，由于确切的原因，它不太可能有任何副作用，为什么不将其设为默认行为，并且仅在发生不良行为（如果有的话）时将其关闭。

可以通过在基本样式表中定义特定元素的方式指定`{zoom: auto;}`或来做到这一点。`{height:auto;}`

我将不得不给第一个说“没有副作用”的人的答案，因为每个人的答案都是一样的，而有些人的答案超出了范围。再次感谢！

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T21:45:35.767

这被称为[冬青黑客](http://www.communitymx.com/content/article.cfm?page=2&cid=c37E0)。据我所知，没有副作用，特别是如果您`* html`直接使用 IE6。我同意其他海报的观点，将它放在`<div>`标签上可能不是最明智的选择——我会针对导致悲伤的个别元素。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T21:39:59.273

我尽量减少使用这些变通方法以避免不可预见的问题；我只在 IE6 破坏布局时需要它的元素上使用它，而不是在页面中的所有元素上使用它。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-27T11:33:56.820

我也不认为有任何副作用。但如前所述 - 只在你需要的地方使用它。我个人会...

1.  仅在集合类上使用它：

    *   html .haslayout { 高度：1%; }

2.  将它放在通过[条件注释包含的 IE 6 样式表中](http://www.quirksmode.org/css/condcom.html)

    <!--[如果 IE 6]> <link href="ie6.css" rel="stylesheet" type="text/css" media="screen,projection" /> <![endif]-->

希望有帮助

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T21:47:56.743

1% 的高度应该没有影响，因为 IE 确实将尺寸视为最小尺寸。然而 pos:abs 无论如何都足以提供 haslayout 了，我同意 jeroen 的观点，即像这样的笼统断言是不明智的。例如，这不是您在 CSS 重置中想要的。

# wpf - WPF 列表视图在加载时排序

> ID：591873
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-26T18:38:49.960
> 
>         
> 
> 标签：wpf, list, listview

这是问题所在：

我想在第一次加载 ListView 时对其进行排序。如果单击 ListView 中的 Header 列，我已经实现了可以在 List View 中排序的功能。

我找不到合适的事件来调用我的排序函数。我尝试使用 UserControl 和 Loaded 事件的 OnInitialized，但是当我调用这些函数时，似乎没有填充列表视图。

我尝试了 ListView 的 GotFocus。它可以工作，但是我必须单击窗口才能完成排序。

我希望在加载 ListView 后立即进行排序。

我在列表视图中使用 XML 数据绑定。ListView 是用户控件的一部分。用户控件托管在 MMC 应用程序中。

如果您需要任何其他信息，请告诉我。

公共类 SortableGridViewColumn : GridViewColumn { 公共字符串 SortPropertyName { get { return (string)GetValue(SortPropertyNameProperty); } set { SetValue(SortPropertyNameProperty, value); } }

```
 // Using a DependencyProperty as the backing store for SortPropertyName.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty SortPropertyNameProperty =
        DependencyProperty.Register("SortPropertyName", typeof(string), 
        typeof(SortableGridViewColumn), new UIPropertyMetadata(""));

    public bool IsDefaultSortColumn
    {
        get { return (bool)GetValue(IsDefaultSortColumnProperty); }
        set { SetValue(IsDefaultSortColumnProperty, value); }
    }
    public static readonly DependencyProperty IsDefaultSortColumnProperty =
        DependencyProperty.Register("IsDefaultSortColumn", typeof(bool), 
        typeof(SortableGridViewColumn), new UIPropertyMetadata(false));
}

public class SortableListView : ListView
{
    public SortableListView()
    {                   

    }     

   SortableGridViewColumn lastSortedOnColumn = null;
   ListSortDirection lastDirection = ListSortDirection.Ascending;   

    public void Sort(string sortBy,  ListSortDirection direction)
    {        
        ICollectionView dataView = CollectionViewSource.GetDefaultView
            (this.ItemsSource);
        //Check if dataView isn't null
        if (dataView != null)
        {
            dataView.SortDescriptions.Clear();
            SortDescription sd1 = new SortDescription("@isenabled", direction);
            dataView.SortDescriptions.Add(sd1);

            SortDescription sd = new SortDescription(sortBy, direction);
            dataView.SortDescriptions.Add(sd);
            dataView.Refresh();
        }

    }

    private void GridViewColumnHeaderClickedHandler(object sender, RoutedEventArgs e)
    {
        GridViewColumnHeader headerClicked = e.OriginalSource as GridViewColumnHeader;

        if (headerClicked != null &&
            headerClicked.Role != GridViewColumnHeaderRole.Padding)
        {
             // attempt to cast to the sortableGridViewColumn object.
            SortableGridViewColumn sortableGridViewColumn = (headerClicked.Column) as SortableGridViewColumn;

            // ensure that the column header is the correct type and a sort property has been set.
            if (sortableGridViewColumn != null && !String.IsNullOrEmpty(sortableGridViewColumn.SortPropertyName))
            {

                ListSortDirection direction;
                bool newSortColumn = false;

                // determine if this is a new sort, or a switch in sort direction.
                if (lastSortedOnColumn == null
                    || String.IsNullOrEmpty(lastSortedOnColumn.SortPropertyName)
                    || !String.Equals(sortableGridViewColumn.SortPropertyName, lastSortedOnColumn.SortPropertyName, StringComparison.InvariantCultureIgnoreCase))
                {
                    newSortColumn = true;
                    direction = ListSortDirection.Ascending;
                }
                else
                {
                    if (lastDirection == ListSortDirection.Ascending)
                    {
                        direction = ListSortDirection.Descending;
                    }
                    else
                    {
                        direction = ListSortDirection.Ascending;
                    }
                }

                // get the sort property name from the column's information.
                string sortPropertyName = sortableGridViewColumn.SortPropertyName;

                // Sort the data.
                Sort(sortPropertyName, direction);

                lastSortedOnColumn = sortableGridViewColumn;
                lastDirection = direction;
            }
        }
    }

    protected override void OnInitialized(EventArgs e)       
    {
        base.OnInitialized(e);
        // add the event handler to the GridViewColumnHeader. This strongly ties this ListView to a GridView.
        this.AddHandler(GridViewColumnHeader.ClickEvent, new RoutedEventHandler(GridViewColumnHeaderClickedHandler));
        // cast the ListView's View to a GridView
        GridView gridView = this.View as GridView;

        if (gridView != null)
        {
            // determine which column is marked as IsDefaultSortColumn. Stops on the first column marked this way.1
            SortableGridViewColumn sortableGridViewColumn = null;

            foreach (GridViewColumn gridViewColumn in gridView.Columns)
            {
                sortableGridViewColumn = gridViewColumn as SortableGridViewColumn;
                if (sortableGridViewColumn != null)
                {
                    if (sortableGridViewColumn.IsDefaultSortColumn)
                    {
                        break;
                    }
                    sortableGridViewColumn = null;
                }
            }

            // if the default sort column is defined, sort the data 
            if (sortableGridViewColumn != null)
            {
                lastSortedOnColumn = sortableGridViewColumn;
                Sort(sortableGridViewColumn.SortPropertyName, ListSortDirection.Ascending);
            }
        }           
    }

} 
```

XAML 如下所示：

```
 **<local:SortableListView x:Name="ListViewControl" Grid.Row="0"   ItemContainerStyle="{DynamicResource StretchedContainerStyle}" 
    ItemTemplateSelector="{DynamicResource myControlTemplateSelector}" 
    IsSynchronizedWithCurrentItem="True"        
    ItemsSource="{Binding Source={StaticResource dataProvider},
    XPath=//CONFIGURATION}">           
        <ListView.View >
            <GridView >                    
                <local:SortableGridViewColumn  Header="ID" HeaderContainerStyle="{StaticResource CustomHeaderStyle}" 
        DisplayMemberBinding="{Binding XPath=./@id}"
        IsDefaultSortColumn="True"
        SortPropertyName="@id"/>
                <local:SortableGridViewColumn  Header="VALUE" HeaderContainerStyle="{StaticResource CustomHeaderStyle}" 
        CellTemplateSelector="{DynamicResource myControlTemplateSelector}" 
        SortPropertyName="@value"/>
                <local:SortableGridViewColumn  Header="DATATYPE" HeaderContainerStyle="{StaticResource CustomHeaderStyle}" 
        DisplayMemberBinding="{Binding XPath=./@data_type}"
        SortPropertyName="@data_type"/>
                <local:SortableGridViewColumn  Header="DESCRIPTION" HeaderContainerStyle="{StaticResource CustomHeaderStyle}"  
        DisplayMemberBinding="{Binding XPath=./@description}"
        SortPropertyName="@description"
        Width="{Binding ElementName=ListViewControl, Path=ActualWidth}"/>

            </GridView>
        </ListView.View>
    </local:SortableListView>**
    <StackPanel Grid.Row="1">
        <Button Grid.Row="1" HorizontalAlignment="Stretch"  Height="34" HorizontalContentAlignment="Stretch" >
            <StackPanel  HorizontalAlignment="Stretch"  VerticalAlignment="Center"  Orientation="Horizontal"  FlowDirection="RightToLeft" Height="30">
                <Button  Grid.Row="1" Content ="Apply" Padding="0,0,0,0 " Margin="6,2,0,2" Name="btn_Apply" HorizontalAlignment="Right"  VerticalContentAlignment="Center"   HorizontalContentAlignment="Center" Width="132"  IsTabStop="True" Click="btn_ApplyClick"  Height="24" />
            </StackPanel >
        </Button> 
    </StackPanel >

</Grid> 
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-06T16:51:56.747

我终于能够解决它。我不得不在 ListView ItemSource 上使用转换器。然后在转换函数上对列表进行排序。

下面是代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.Xml;
using System.Threading;
using System.Collections.ObjectModel;

namespace ...MiscellaneousCAESettings
{
    /// <summary>
    /// Interaction logic for ConfigDataView.xaml
    /// </summary>
    public partial class ConfigDataView : UserControl, IConfigDataViewControl 
    {

    ConfigDataViewPresenter _presenter = null;
    public static string _currDataType = "";
    public static string _min = "" ;
    public static string _max = "";        

    public string Min 
    {
        get
        {
         return _min;
        }
        set
        {
            _min = value ;
        }
    }

    public string Max
    {
        get
        {
            return _max;
        }
        set
        {
            _max = value;
        }
    }

    public string CurrDataType 
    {
        get
        {
            return _currDataType;
        }
        set
        {
            _currDataType = value;
        }
    }

    public ConfigDataView()
    {            
        InitializeComponent();

        //To give the classic windows look
        Uri uri = new Uri("PresentationFramework.Classic;V3.0.0.0;31bf3856ad364e35;component\\themes/classic.xaml", UriKind.Relative);
        this.Resources.MergedDictionaries.Add(Application.LoadComponent(uri) as ResourceDictionary);            
    }

    private void txtBoxGotFocus(object sender, RoutedEventArgs e)
    {
        Min = "" ;
        Max = "" ;

        TextBox txtbox = e.Source as TextBox;            
        this.ListViewControl.SelectedItem = txtbox.DataContext;

        //index         
        int index = this.ListViewControl.Items.IndexOf(this.ListViewControl.SelectedItem);

        System.ComponentModel.ICollectionView dataView = CollectionViewSource.GetDefaultView(this.ListViewControl.ItemsSource);

        object stCurr = (dataView.CurrentPosition ) ;

        //Check if the "data_type" attribute exists
        if (((XmlElement)dataView.CurrentItem).Attributes["data_type"] != null)
        {
            CurrDataType = ((XmlElement)dataView.CurrentItem).Attributes["data_type"].Value;
        }

        //Check if the "min" attribute exists
        if (((XmlElement)dataView.CurrentItem).Attributes["min"] != null)
        {
            Min = ((XmlElement)dataView.CurrentItem).Attributes["min"].Value;
        }

        //Check if the "min" attribute exists
        if (((XmlElement)dataView.CurrentItem).Attributes["max"] != null)
        {
            Max = ((XmlElement)dataView.CurrentItem).Attributes["max"].Value;
        }

    }

    #region IConfigDataViewControl Members

    public void LoadRootConfigData(string xmlFileName, string xmlFileContent, string xmlXPath)
    {
        try
        {
            XmlDocument configFileDoc = new XmlDocument();
            configFileDoc.LoadXml(xmlFileContent);

            XmlDataProvider xmldp = (XmlDataProvider)this.TryFindResource("dataProvider");
            xmldp.Document = configFileDoc;
            if (string.IsNullOrEmpty(xmlXPath))
            {
                xmldp.XPath = @"//node()[1]/node()[@value]";
            }
            else
            {
                xmldp.XPath = xmlXPath;
            }

            Binding bnd = new Binding();
            bnd.Source = xmldp;                
            bnd.Converter = new SortList();                 

            ListViewControl.SetBinding(ItemsControl.ItemsSourceProperty, bnd);

        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
    }

    public void LoadCategoryConfigData(string xmlFile, string xmlFileContent, string CategoryNodeName)
    {
        try
        {                
            XmlDocument configFileDoc = new XmlDocument();
            configFileDoc.LoadXml(xmlFileContent);

            XmlDataProvider xmldp = (XmlDataProvider)this.TryFindResource("dataProvider");
            xmldp.Document = configFileDoc;
            xmldp.XPath = @"//CONTEXT[@id='" + CategoryNodeName + @"']/CONFIGURATION";

            Binding bnd = new Binding();
            bnd.Source = xmldp;
            bnd.Converter = new SortList();
            ListViewControl.SetBinding(ItemsControl.ItemsSourceProperty, bnd);                
         }
        catch(Exception ex)
        {
            MessageBox.Show(ex.Message);  
        }          
    }        

    public void AttachPresenter(ConfigDataViewPresenter cfgpresenter)
    {
        _presenter = cfgpresenter;
    }

    #endregion

    private void btn_ApplyClick(object sender, RoutedEventArgs e)
    {            
        XmlDataProvider odp = (XmlDataProvider)this.TryFindResource("dataProvider");

        XmlDocument configFileDoc = new XmlDocument();
        configFileDoc =odp.Document;

        _presenter.Save(configFileDoc.InnerXml );             
    }
}

public class TextBoxMinMaxValidation : ValidationRule
{

    public override ValidationResult Validate(object value, System.Globalization.CultureInfo cultureInfo)
    {
        try
        {
            //Check for min max string length if it is a "Text" data type
            if (ConfigDataView._currDataType.ToLower() == "text")
            {
                int minLength = Convert.ToInt32(ConfigDataView._min);
                int maxLength = Convert.ToInt32(ConfigDataView._max);

                int strLength = value.ToString().Length;
                bool isValidLength = true;

                isValidLength = ((strLength >= minLength) && (strLength <= maxLength));

                if (!isValidLength)
                {
                    return new ValidationResult(false, string.Format("The input String Length is out of range. The String Length should be between {0} to {1}", minLength, maxLength));
                }
                else
                {
                    return new ValidationResult(true, null);
                }
            }

            //Check for min max string length if it is a "Numeric" data type
            if (ConfigDataView._currDataType.ToLower() != "numeric")
            {
                return new ValidationResult(true, null);
            }

            int min = Convert.ToInt32(ConfigDataView._min);
            int max = Convert.ToInt32(ConfigDataView._max);

            int res ;
            bool isNumber = int.TryParse(value.ToString(), out res);
            bool isValidRange = true;

            if (!isNumber)
            {
                return new ValidationResult(false, "The input string is in incorrect format. Should be a Number.");
            }

            isValidRange = ((res >= min) && (res <= max));

            if (!isValidRange)
            {
                return new ValidationResult(false, string.Format("The input integer is out of range. The number should be between {0} to {1}", min, max));
            }

        }
        catch
        {

        }

        return new ValidationResult(true, null);
    }
}    

public class ControlTemplateSelector : DataTemplateSelector
{
    public const String XML_TAG_DATATYPE = "data_type";
    public const String DATATYPE_DROPDOWN = "Dropdown";
    public const String DATATYPE_BOOLEAN = "Boolean";

    public override DataTemplate SelectTemplate(object item,
      DependencyObject container)
    {
        FrameworkElement window = (container as FrameworkElement);
        try
        {                 
            XmlNode node = (XmlNode)item;
            String dataType = "";
            if (node.Attributes[XML_TAG_DATATYPE] != null)
            {
                dataType = (string)node.Attributes.GetNamedItem(XML_TAG_DATATYPE).Value;
            }
            if (dataType == DATATYPE_DROPDOWN)
            {

                return window.FindResource("dropDownTemplate") as DataTemplate; 
            }
            if (dataType == DATATYPE_BOOLEAN)
            {
                return window.FindResource("booldropDownTemplate") as DataTemplate; 
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show("Select template Exception" + ex.Message ); 
        }
        return window.FindResource("textTemplate") as DataTemplate;
    }
 }

public class boolConverter : IValueConverter
{
    public const String XML_TAG_VALUE = "value";
    public const String XML_TAG_ID = "id";

    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        Boolean boolVal = false;
        try
        {
            boolVal = System.Convert.ToBoolean(value);
        }
        catch
        {
            string strVal = value.ToString();
            int iVal = int.Parse(strVal);
            boolVal = System.Convert.ToBoolean(iVal);
        }

        if (boolVal == true)
        {
            return 1;
        }
        else
        {
            return 0;
        }

    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {           
        Boolean boolVal = false;
        try
        {
            boolVal = System.Convert.ToBoolean(value);
        }
        catch
        {
            string strVal = value.ToString();
            int iVal = int.Parse(strVal);
            boolVal = System.Convert.ToBoolean(iVal);
        }
        return boolVal;

    }
}

public class SortableGridViewColumn : GridViewColumn
{
    public string SortPropertyName
    {
        get { return (string)GetValue(SortPropertyNameProperty); }
        set { SetValue(SortPropertyNameProperty, value); }
    }

    // Using a DependencyProperty as the backing store for SortPropertyName.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty SortPropertyNameProperty =
        DependencyProperty.Register("SortPropertyName", typeof(string), 
        typeof(SortableGridViewColumn), new UIPropertyMetadata(""));

    public bool IsDefaultSortColumn
    {
        get { return (bool)GetValue(IsDefaultSortColumnProperty); }
        set { SetValue(IsDefaultSortColumnProperty, value); }
    }
    public static readonly DependencyProperty IsDefaultSortColumnProperty =
        DependencyProperty.Register("IsDefaultSortColumn", typeof(bool), 
        typeof(SortableGridViewColumn), new UIPropertyMetadata(false));
}

public class SortableListView : ListView
{
    public SortableListView()
    {
        // add the event handler to the GridViewColumnHeader. This strongly ties this ListView to a GridView.
        this.AddHandler(GridViewColumnHeader.ClickEvent, new RoutedEventHandler(GridViewColumnHeaderClickedHandler));
    }     

   SortableGridViewColumn lastSortedOnColumn = null;
   ListSortDirection lastDirection = ListSortDirection.Ascending;

    public void Sort(string sortBy,  ListSortDirection direction)
    {

        ICollectionView dataView = CollectionViewSource.GetDefaultView
           (this.ItemsSource);

        //Check if dataView isn't null
        if (dataView != null)
        {                
            dataView.SortDescriptions.Clear();

            SortDescription sd1 = new SortDescription("@isenabled", direction);
            dataView.SortDescriptions.Add(sd1);

            SortDescription sd = new SortDescription(sortBy, direction);
            dataView.SortDescriptions.Add(sd);                                           

            dataView.Refresh();
        }

    }

    private void GridViewColumnHeaderClickedHandler(object sender, RoutedEventArgs e)
    {
        GridViewColumnHeader headerClicked = e.OriginalSource as GridViewColumnHeader;

        if (headerClicked != null &&
            headerClicked.Role != GridViewColumnHeaderRole.Padding)
        {
             // attempt to cast to the sortableGridViewColumn object.
            SortableGridViewColumn sortableGridViewColumn = (headerClicked.Column) as SortableGridViewColumn;

            // ensure that the column header is the correct type and a sort property has been set.
            if (sortableGridViewColumn != null && !String.IsNullOrEmpty(sortableGridViewColumn.SortPropertyName))
            {

                ListSortDirection direction;                   

                // determine if this is a new sort, or a switch in sort direction.
                if (lastSortedOnColumn == null
                    || String.IsNullOrEmpty(lastSortedOnColumn.SortPropertyName)
                    || !String.Equals(sortableGridViewColumn.SortPropertyName, lastSortedOnColumn.SortPropertyName, StringComparison.InvariantCultureIgnoreCase))
                {                        
                    direction = ListSortDirection.Descending;
                }
                else
                {
                    if (lastDirection == ListSortDirection.Ascending)
                    {
                        direction = ListSortDirection.Descending;
                    }
                    else
                    {
                        direction = ListSortDirection.Ascending;
                    }
                }

                // get the sort property name from the column's information.
                string sortPropertyName = sortableGridViewColumn.SortPropertyName;

                // Sort the data.
                Sort(sortPropertyName, direction);

                lastSortedOnColumn = sortableGridViewColumn;
                lastDirection = direction;
            }
        }
    }       
}

public class SortList : IValueConverter
{     
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {     
        //If the value is null tell binding engine to do nothing
        if (value == null)
        {
            return Binding.DoNothing;  
        }

        ListCollectionView view = (ListCollectionView)
           CollectionViewSource.GetDefaultView(value);

        SortDescription sort_isdisabled =
            new SortDescription("@isenabled",
                ListSortDirection.Ascending);

        view.SortDescriptions.Add(sort_isdisabled);

        SortDescription sort_id =
            new SortDescription("@id",
                ListSortDirection.Ascending);

        view.SortDescriptions.Add(sort_id);

        return view;
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        return Binding.DoNothing;
    }
} 
```

}

XAML 如下： xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns: local="clr-namespace:.....MiscellaneousCAESettings" Horizo​​ntalAlignment 

    ="Stretch" VerticalAlignment="Stretch" Margin="0,0,0,0" >

```
<ControlTemplate x:Key="validationTemplate">
  <DockPanel>
        <TextBlock Foreground="Red" FontSize="20">!</TextBlock>
        <AdornedElementPlaceholder/>
  </DockPanel>
</ControlTemplate>

<Style x:Key="textBoxInError" TargetType="{x:Type TextBox}">
  <Style.Triggers>
    <Trigger Property="Validation.HasError" Value="true">
      <Setter Property="ToolTip"
        Value="{Binding RelativeSource={x:Static RelativeSource.Self},
                        Path=(Validation.Errors)[0].ErrorContent}"/>
    </Trigger>
  </Style.Triggers>
</Style>

    <DataTemplate x:Key="textTemplate">
        <TextBox  HorizontalAlignment= "Stretch" 
    IsEnabled="{Binding XPath=./@isenabled}"        
    Validation.ErrorTemplate="{StaticResource validationTemplate}"
    GotFocus="txtBoxGotFocus"
    Style="{StaticResource textBoxInError}">
            <TextBox.Text>
                <Binding XPath="./@value" UpdateSourceTrigger="PropertyChanged">
                    <Binding.ValidationRules>           
                        <local:TextBoxMinMaxValidation>
            <local:TextBoxMinMaxValidation.DataType>
                          <local:DataTypeCheck 
                                Datatype="{Binding Source={StaticResource dataProvider}, XPath='/[@id=CustomerServiceQueueName]'}"/>
                        </local:TextBoxMinMaxValidation.DataType>              
                         <local:TextBoxMinMaxValidation.ValidRange>
            <local:Int32RangeChecker 
                                Minimum="{Binding Source={StaticResource dataProvider}, XPath=./@min}" 
                                Maximum="{Binding Source={StaticResource dataProvider}, XPath=./@max}"/>                                            
             </local:TextBoxMinMaxValidation.ValidRange>
                        </local:TextBoxMinMaxValidation>
                    </Binding.ValidationRules> 
                </Binding >
            </TextBox.Text> 
        </TextBox>
    </DataTemplate>
    <DataTemplate x:Key="dropDownTemplate">
        <ComboBox  Name="cmbBox" HorizontalAlignment="Stretch"
           SelectedIndex="{Binding XPath=./@value}"
           ItemsSource="{Binding XPath=.//OPTION/@value}"
           IsEnabled="{Binding XPath=./@isenabled}"
         />
    </DataTemplate>
<DataTemplate x:Key="booldropDownTemplate">
        <ComboBox  Name="cmbBox" HorizontalAlignment="Stretch"
           SelectedIndex="{Binding XPath=./@value,  Converter={StaticResource boolconvert}}">
            <ComboBoxItem>True</ComboBoxItem>
            <ComboBoxItem>False</ComboBoxItem>                                         
        </ComboBox>
    </DataTemplate>
    <local:ControlTemplateSelector 
        x:Key="myControlTemplateSelector"/>

    <Style x:Key="StretchedContainerStyle" TargetType="{x:Type ListViewItem}">
        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
        <Setter Property="Template" Value="{DynamicResource ListBoxItemControlTemplate1}"/>
    </Style>
    <ControlTemplate x:Key="ListBoxItemControlTemplate1" TargetType="{x:Type ListBoxItem}">
        <Border SnapsToDevicePixels="true" x:Name="Bd" Background="{TemplateBinding Background}" BorderBrush="{DynamicResource {x:Static SystemColors.ActiveBorderBrushKey}}" Padding="{TemplateBinding Padding}" BorderThickness="0,0.5,0,0.5">
            <GridViewRowPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
        </Border>            
    </ControlTemplate>

    <Style x:Key="CustomHeaderStyle" TargetType="{x:Type GridViewColumnHeader}">
        <Setter Property="Background" Value="LightGray" />            
        <Setter Property="FontWeight" Value="Bold"/>
        <Setter Property="FontFamily" Value="Arial"/>
        <Setter Property="HorizontalContentAlignment" Value="Left" />
    <Setter Property="Padding" Value="2,0,2,0"/>                 
    </Style>

</UserControl.Resources>
<Grid x:Name="GridViewControl" Height="Auto">
    <Grid.RowDefinitions>
        <RowDefinition Height="*" />
        <RowDefinition Height="34"/>
    </Grid.RowDefinitions>

    <ListView x:Name="ListViewControl" Grid.Row="0"   ItemContainerStyle="{DynamicResource StretchedContainerStyle}" 
    ItemTemplateSelector="{DynamicResource myControlTemplateSelector}" 
    IsSynchronizedWithCurrentItem="True"
    ItemsSource="{Binding Source={StaticResource dataProvider}, 
    XPath=//CONFIGURATION}">           

        <ListView.View >
            <GridView >                    
                <GridViewColumn  Header="ID" HeaderContainerStyle="{StaticResource CustomHeaderStyle}" DisplayMemberBinding="{Binding XPath=./@id}"/>
                <GridViewColumn  Header="VALUE" HeaderContainerStyle="{StaticResource CustomHeaderStyle}" CellTemplateSelector="{DynamicResource myControlTemplateSelector}" />
                <GridViewColumn  Header="DATATYPE" HeaderContainerStyle="{StaticResource CustomHeaderStyle}" DisplayMemberBinding="{Binding XPath=./@data_type}"/>
                <GridViewColumn  Header="DESCRIPTION" HeaderContainerStyle="{StaticResource CustomHeaderStyle}"  
        DisplayMemberBinding="{Binding XPath=./@description}" 
        Width="{Binding ElementName=ListViewControl, Path=ActualWidth}"/>

            </GridView>
        </ListView.View>

    </ListView>
    <StackPanel Grid.Row="1">
        <Button Grid.Row="1" HorizontalAlignment="Stretch"  Height="34" HorizontalContentAlignment="Stretch" >
            <StackPanel  HorizontalAlignment="Stretch"  VerticalAlignment="Center"  Orientation="Horizontal"  FlowDirection="RightToLeft" Height="30">
                <Button  Grid.Row="1" Content ="Apply" Padding="0,0,0,0 " Margin="6,2,0,2" Name="btn_Apply" HorizontalAlignment="Right"  VerticalContentAlignment="Center"   HorizontalContentAlignment="Center" Width="132"  IsTabStop="True" Click="btn_ApplyClick"  Height="24" />
            </StackPanel >
        </Button> 
    </StackPanel >

</Grid> 
```

# language-agnostic - 在 Web 应用程序中保持下拉列表 DRY

> ID：591883
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-26T18:40:59.080
> 
>         
> 
> 标签：language-agnostic, drop-down-menu, dry

我正在为各种表格等编写 CMS，我发现我正在创建很多下拉菜单。我真的不想用大量随机键/字符串值表来破坏我的数据库，以便使用 2-4 个很少更改的简单下拉列表。你如何以负责任的方式管理这件事？

这与语言无关，但如果有人有具体建议，我正在 Rails 中工作。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-26T19:10:31.833

我们将所有内容放入数据库中的单个 LookUp 表中，其中一列映射到一个枚举，该枚举描述了它用于哪个查找（标题、国家等）。

这使我们能够在查找下拉列表中添加“其他，请指定”选项的灵活性。我们制作了一个控件来封装它，并带有一个属性来根据具体情况打开或关闭此行为。

如果最终用户选择“其他，请指定”，则会出现一个文本框供他们输入自己的值。这将被添加到查找表中，但被标记为临时项目。

该表包含一个标志，表示每个查找值的状态：Active、Inactive、AdHoc。只有活跃的会出现在下拉列表中；AdHoc 是通过“其他，请说明”选项创建的。

管理页面显示了 AdHoc 值的使用频率，允许站点管理员将常见的流行值推广到一般用途（即将其状态标志更改为活动）。

这对您的应用程序来说可能有点矫枉过正，但它对我们的应用程序来说非常有效：该应用程序基本上几乎完全是对非常特定于业务的数据的 CRUD 操作。我们在整个站点上进行了数十次查找，客户希望能够自行维护这些查找。这给了他们完全的灵活性，无需我们干预。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T18:42:53.070

您冷有一个带有额外列的下拉表来说明下拉列表的用途...使用 where 子句限制结果...

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:45:50.533

在我目前的职位上，我们实现了一个 LookupCode 表，其中包含一个 CodeGroup、Code 和 Meaning 列，以及其他一些列（如 active）。这样，您就有一个包含所有查找值的表位于一个位置，并且您可以进行一些快速查找以绑定到您的下拉列表。

# c++ - C++ dll循环问题

> ID：591886
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T18:42:22.743
> 
>         
> 
> 标签：c++, vb.net, dll, loops

我在从 VB 调用的 C++ dll 中的循环出现问题。我希望这个循环更新一个全局变量，但是当我调用该函数时，该变量不会在第一轮更新，而是每次都会更新。

这就是我尝试更新变量的方式。

```
else 
{
   ::nScore = nHighest;

    if (nScore != 0)
    {
       ::nColourOn++;               
    }
} 
```

作为一种工作方法，我强制变量成为我在 VB 代码中想要的，但对这个解决方案不满意。有谁知道可能是什么原因造成的？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T19:00:23.027

If the value of nHighest isn't initialized, nScore will be 0 and nColorOn won't be incremented. Is that the error you're seeing? If so, set nHighest, otherwise, it's working fine. :)

# testing - 生成模拟数据的工具？

> ID：591892
> 
>         
> 
> 赞同：104
> 
>         
> 
> 时间：2009-02-26T18:43:23.817
> 
>         
> 
> 标签：testing, data-generation

我正在寻找一个好的、免费的工具来生成样本数据，以便加载到测试数据库中。以此类推，为任何 RDBMS 生成“ [lorem ipsum](http://en.wikipedia.org/wiki/Lorem_ipsum) ”文本的东西。我正在寻找的功能包括：

*   为现有表定义生成数据的灵活性。

*   能够生成大小数据集（> 100 万行或更多）。

*   以 SQL 脚本格式（`INSERT`语句）或其他适合批量导入的平面文件格式生成（通常更快）。

*   用于轻松编写脚本的命令行界面。

*   可扩展的、开源的、用动态语言编写的（这些都是不错的，不是强要求）。

PS：我确实在 StackOverflow 上搜索了一个重复的问题，但没有找到。如果有的话，我会很感激得到一个指向它的指针。

* * *

感谢大家的精彩回复！我应该修改我的要求，即我使用 Mac OS X 作为我的主要开发环境，而不是 Windows（尽管我确实说过命令行界面是可取的，并且*实际上*排除了 Windows）。不过，Windows 特定的建议无疑会对这个问题的其他读者有用，所以谢谢。

* * *

这是我的结论：

*   生成数据： 

    *   PHP Web 应用程序界面，而不是命令行

    *   仅限于生成 200 条记录（或为生成 5,000 条记录的许可支付 20 美元）

*   RedGate SQL 数据生成器

    *   不是免费的，售价 295 美元

    *   需要 Windows、.NET、SQL Server

*   Visual Studio 2008 数据库版

    *   需要 Windows

    *   需要昂贵的 MSDN 或 ISV 订阅

*   横幅数据检测

    *   不是免费的，价格 595 美元

    *   需要 Windows (?)

    *   不支持 MySQL (?)

    *   GUI，不是命令行或可编写脚本的

*   Ruby Faker 宝石

    *   使用 ActiveRecord 进行批量数据加载太慢了

*   超级棒

    *   主要是负载测试工具，内置随机数据生成器

    *   不过使用起来很简单

    *   总体来说是一个不错的亚军工具

*   Databene Benerator

    *   满足我需求的最佳解决方案

    *   XML 脚本，与 DbUnit 兼容

    *   开源 (GPL) Java 代码

    *   命令行使用

    *   通过 JDBC 直接访问许多数据库

* * *

## 回答 #1

> 赞同：41
> 
>             
> 
> 时间：2009-03-05T11:21:32.697

看看[databene benerator](http://databene.org/)，一个看起来接近您要求的测试数据生成器。

*   它可以为现有的表定义生成数据（甚至匿名生产数据）

*   它可以生成大数据集（无限大小）

*   它支持各种输入（CSV、平面文件、DBUnit）和输出格式（CSV、平面文件、DBUnit、XML、Excel、脚本）

*   它可以在命令行上使用，也可以通过 maven 插件使用

*   它是开源和可定制的

我会试一试。

顺便说一句，databene benerator 的网站上提供了[类似产品的列表。](http://databene.org/databene-benerator/similar-products.html)

* * *

## 回答 #2

> 赞同：23
> 
>             
> 
> 时间：2009-02-26T19:06:15.960

这看起来很有希望：[generatedata.com](http://www.generatedata.com/)。开源，有很多内置的数据类型。

这里列出了其他几个：[测试（样本）数据生成器](http://www.webresourcesdepot.com/test-sample-data-generators/)。我对他们中的任何一个都没有经验，但名单上的一些人看起来可能相当不错。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2013-02-05T04:32:02.817

试试[http://www.mockaroo.com](http://www.mockaroo.com)

这是我公司为帮助测试我们自己的应用程序而开发的工具。我们已经免费供任何人使用。它基本上是 Forgery ruby​​ gem，带有一个 Web 应用程序。您可以生成 CSV、txt 或 SQL 格式的数据。希望这可以帮助。

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2009-03-04T15:18:31.950

我知道您说过您正在寻找免费工具，但在这种情况下，我建议花费 295 美元会在节省时间的情况下迅速收回成本。去年我一直在使用 RedGate 工具[SQL 数据生成器](http://www.red-gate.com/products/SQL_Data_Generator/index.htm)，简而言之，它是一个很棒的工具。它允许设置列之间的依赖关系，为电话号码、url、姓名等业务对象生成真实的数据。我可以诚实地说，这个工具一次又一次地为自己付出了代价。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-03-03T23:12:10.117

如果你正在寻找或愿意使用 MySQL 特定的东西，你可以看看[Super Smack](http://vegan.net/tony/supersmack/)。它目前由 Tony Bourke 维护。  

Super Smack 允许您生成随机数据以插入到您的数据库表中。它是可定制的，允许您使用打包的 words.dat 文件或您选择的任何测试数据。

它的优点之一是它的命令行是高度可定制的。[《高性能 MySQL](https://rads.stackoverflow.com/amzn/click/com/0596003064)》一书中有一些相当不错的使用示例，也[摘录在这里](http://imysql.cn/docs/High_Performance_MySQL/0596003064/hpmysql-CHP-3-SECT-3.html)。

不确定这是否符合您正在寻找的内容，但只是一个想法。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-03-04T14:36:30.880

带有可用假数据生成器之一的 Ruby 脚本应该可以满足您的需求。

[http://faker.rubyforge.org/](http://faker.rubyforge.org/)就是这样一颗宝石。不幸的是，这并不能满足您的所有要求。

这是另一个：[http ://random-data.rubyforge.org/](http://random-data.rubyforge.org/)

还有一个使用 Faker 的教程：[http ://www.rubyanandhow.com/how-to-generate-fake-names-addresses-in-ruby/](http://www.rubyandhow.com/how-to-generate-fake-names-addresses-in-ruby/)

* * *

RE：为现有表定义生成数据的灵活性。将 Faker gem 与可用的 ORM 之一结合起来。ActiveRecord 可能是最简单的。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2009-03-05T13:57:26.003

通常非常昂贵，但如果您是小型 ISV，您可以非常便宜地获得[Visual Studio 2008 数据库版](http://www.microsoft.com/products/info/product.aspx?view=22&pcid=33be3c12-3d78-4c52-82c2-b54d2120bf0e&crumb=catpage&catid=515c9859-958b-4433-b4f9-91f37258ca2f)，请参阅[授权](http://www.empowerforisv.com/)和[bizspark](http://www.microsoft.com/bizspark/)促销。它提供了比生成测试数据更多的功能（与 SCC 集成、单元测试、数据库重构等）

由于我喜欢 Red-Grate 工具如此易于学习这一事实，我仍然会关注[SQL 数据生成器](http://www.red-gate.com/products/SQL%5FData%5FGenerator/index.htm)

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2013-02-14T13:58:10.200

列表中真正不应缺少的工具是 Datanamic 的数据生成器，它直接填充数据库或生成插入脚本，具有大量预安装的生成器（并支持多个数据库......

[http://www.datanamic.com/datagenerator/index.html](http://www.datanamic.com/datagenerator/index.html)

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T20:08:38.323

我知道您不是在寻找实际的 lorem ipsum 文本；但万一其他人搜索实际的 lorem ipsum 生成器并找到这个线程：[lipsum.com](http://lipsum.com/)做得很好。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2009-03-04T15:18:01.467

不是免费的，但[Visual Studio 2008 数据库版](http://www.microsoft.com/products/info/product.aspx?view=22&pcid=33be3c12-3d78-4c52-82c2-b54d2120bf0e&crumb=catpage&catid=515c9859-958b-4433-b4f9-91f37258ca2f)是一个不错的选择，它提供了更多功能（与 SCC 集成、单元测试、数据库重构等...）

* * *

## 回答 #11

> 赞同：1
> 
>             
> 
> 时间：2009-03-07T15:49:50.633

我使用一个名为[Datatect](http://www.datatect.com/)的工具：

1.  将数据生成到平面文件或任何 ODBC 兼容数据库。

2.  可通过 VBScript 扩展。

3.  参考意识；将使用父表中的值填充外键。

4.  数据是上下文感知的；给定邮政编码的城市、州和电话号码、名字和带有性别的头衔。

5.  可以创建自定义的复杂数据类型。

6.  生成超过 20 亿个专有名称、企业名称、街道地址、城市、州和邮政编码。

我使用这个工具为 SQLServer 数据库生成了多达 40,000,000 行数据，并为 Oracle 数据库生成了 8,000,000 行数据。

我与 Banner Systems 没有任何关系，我只是一个满意的客户。

* * *

## 回答 #12

> 赞同：1
> 
>             
> 
> 时间：2012-11-11T20:48:43.833

以下是此类工具的列表（免费和商业）：
 [http ://c2.com/cgi/wiki?TestDataGenerator](http://c2.com/cgi/wiki?TestDataGenerator)

* * *

## 回答 #13

> 赞同：1
> 
>             
> 
> 时间：2013-06-04T16:26:56.983

对于 OS X，有 Data Creator（7 美元）。出于测试目的免费下载。您可以使用它来评估软件及其功能。

它需要 OS X Lion 或后续版本。它可以生成很多不同的字段类型，并具有自定义导出模式以及一些预设（TSV、CSV、Html 表格、带有表格的网页）。

[http://www.tensionsoftware.com/osx/datacreator/](http://www.tensionsoftware.com/osx/datacreator/)

在应用商店：

[https://itunes.apple.com/us/app/data-creator/id491686136?mt=12](https://itunes.apple.com/us/app/data-creator/id491686136?mt=12)

* * *

## 回答 #14

> 赞同：1
> 
>             
> 
> 时间：2013-06-28T09:53:17.330

您可以使用 DbSchema，www.dbschema.com，它是一个数据库管理工具，它有一个随机数据生成器来填充您的数据库。

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2009-03-04T14:52:11.327

不能直接回答您的问题，但这对某些类型的数据可能会有所帮助：

假名生成器可能很有用 - [http://www.fakenamegenerator.com/](http://www.fakenamegenerator.com/)，除了用户帐户或类似的东西外，不适用于所有内容。AFAIK 他们为批量订购提供支持。

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2009-09-23T12:01:41.507

Benerator +1：我尝试了 3 或 4 种其他提供的工具（包括 dbmonster），但发现 Benerator 非常快，可以提供真实的数据并且非常灵活。当我在论坛上发帖时，我还从该工具的创建者那里得到了非常快速且有用的反馈。

# javascript - 在javascript对象数组中查询唯一属性值的最佳方法？

> ID：591894
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-26T18:44:31.053
> 
>         
> 
> 标签：javascript, arrays

在以下示例数组中找到“foo”的所有可能值的最佳（或最快）方法是什么。

```
var table = [
    {foo: 0, bar:"htns", stuff:123},
    {foo: 2, bar:"snhn", stuff:156},
    {foo: 5, bar:"trltw", stuff:45},
    {foo: 5, bar:"lrctm", stuff:564},
    //few thousand lines later
    {foo: 2596, bar:"cns", stuff:321},
    {foo: 2597, bar:"gcrl", stuff:741}
]; 
```

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-26T19:05:50.410

遍历数组并将值放入哈希（对象）中。这是一个 O(n) 算法。

```
var result = {};
for(var i=0; i<table.length; i++) {
    result[table[i].foo] = 1; //the value can be anything
}

//now read back the unique values
for (i in result) {
    if (result.hasOwnProperty(i)) { 
        console.log(i);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T19:57:28.130

这是 Chetan 答案的类型安全版本：

```
var result = {};
for(var i = 0; i < table.length; ++i) {
    var value = table[i].foo;
    result[(typeof value) + ' ' + value] = value;
}

for(id in result) {
    if(result.hasOwnProperty(id)) { 
        console.log(result[id]);
    }
} 
```

但是，它仍然会中断对象：只要`toString()`方法没有被覆盖，它们都共享字符串表示`'[object Object]'`。

# mysql - Real-world uses of MySQL savepoints in web services?

> ID：591897
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-02-26T18:46:05.043
> 
>         
> 
> 标签：mysql, web-services, transactions, nested-transactions

Does anyone have experience they can share using MySQL [savepoints](http://dev.mysql.com/doc/refman/5.0/en/savepoint.html) (directly or via an ORM), especially in a non-trivial web service?  Where have you actually used them?  Are they reliable enough (assuming you're willing to run a fairly recent version of MySQL) or too bleeding-edge or expensive?

Lastly, does anyone have experience with something like the following use case and did you use savepoints for it?  Say the main point of some specific unit of work is to add a row to an `Orders` table (or whatever, doesn't have to be order-related, of course) and update an `OrdersAuditInfo` table, in the same transaction.  It is essential that `Orders` be updated if at all possible, but `OrdersAuditInfo` table is not as essential (e.g., it's ok to just log an error to a file, but keep going with the overall transaction).  At a low level it might look like this (warning, pseudo-SQL follows):

```
BEGIN;

INSERT INTO Orders(...) VALUES (...);
/* Do stuff outside of SQL here; if there are problems, do a
 ROLLBACK and report an error (i.e., Order is invalid in this
 case anyway). */

SAVEPOINT InsertAudit;
INSERT INTO OrdersAudit(...) VALUES(...);
/* If the INSERT fails, log an error to a log file somewhere and do: */
ROLLBACK TO SAVEPOINT InsertAudit;

/* Always want to commit the INSERT INTO Orders: */
COMMIT; 
```

But even here perhaps there'd be a better (or at least more common) idiom?  One could do the `OrdersAuditInfo` insert in a completely different transaction but it would be nice to be guaranteed that the `OrdersAuditInfo` table were **not** written to unless the final `COMMIT` actually worked.

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-03T06:34:00.673

我通常倾向于避免使用 SAVEPOINT，因为它会使代码很难理解和验证。

在您发布的情况下，包装在单个事务中将取决于`OrdersAudit`与 , 完全对应的记录是否`Orders`是您的业务规则的一部分。

编辑：只需重新阅读您的问题，您不需要保证`OrdersAudit`and之间的对应关系`Orders`。所以我不会使用任何事务来插入`OrdersAudit`记录。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2021-10-12T12:33:43.083

我相信您正在使用保存点来避免失败`INSERT`的 s 回滚整个事务。但在这种情况下，最好的方法是使用`INSERT IGNORE`. 如果失败，您将收到警告而不是错误，并且不会回滚。

由于您不需要回滚，因此我建议您不要使用事务。

`SAVEPOINT`如果您可能想要回滚一些成功的语句（但不是所有语句）， s 非常好。例如：

1.  开始交易；

2.  您不想经常运行的相对较慢的查询

3.  插入一个

4.  保存点一；

5.  SELECT id INTO @id FROM slot WHERE status = 'free' ORDER BY timestamp LIMIT 1;

6.  插入 b (slot_id, ...) 值 (@id, ...)

7.  插入 c (slot_id, ...) 值 (@id, ...)

8.  INSERT INTO d (slot_id, ...) 值 (@id, ...)

9.  犯罪;

如果`SELECT`没有返回任何内容，您可以运行全局`ROLLBACK`. 如果以下任何 INSERT 失败，您可以`ROLLBACK TO SAVEPOINT one`选择另一个`id`. 显然，在这种情况下，您希望在代码中实现最大尝试次数。

# .net - 你如何让 Inno Setup 在执行长执行时看起来不冻结？

> ID：591899
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-02-26T18:46:21.140
> 
>         
> 
> 标签：.net, installation, inno-setup

长期`Exec`安装.NET 3.5，输出脚本基于此：
 http: [//www.blackhillsoftware.com/blog/2006/06/26/using-innosetup-with-the-dotnet-framework/](http://www.blackhillsoftware.com/blog/2006/06/26/using-innosetup-with-the-dotnet-framework/)

问题在于它正在使用`ewWaitUntilTerminated`，因为我们需要捕获退出代码。由于我们正在运行它`/passive /norestart`以减少用户方面的工作（也许我们不应该？）

我能想到的最简单的选择是在安装.NET 时隐藏窗口并在完成后再次显示它，但我不知道该怎么做。  

理想的解决方案是显示一个进度页面，但这似乎不太可能，因为我们需要立即返回，但在进程退出时仍会以某种方式收到通知并捕获退出代码，否则我们会只是有一个永恒的进度条。

关于如何解决这个问题的任何想法？

编辑：最小化可能会更好，但也不知道该怎么做。我们确实会显示一条消息，通知用户该过程可能需要 10-20 分钟，但问题是主设置表单完全冻结，无法移动、最小化或对其进行任何操作。此外`/passive`，在较慢的机器上运行 .NET 安装程序实际上并不会在一两分钟内显示任何进度。

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2015-10-17T10:51:33.190

使 Inno Setup“看起来不冻结”的一种方法是添加一个“假”进度指示器，如选取框，以显示正在发生的事情。但这并不能解决“窗口不可拖动/移动”的问题。

因此，另一种方法是真正解冻 Inno Setup GUI，同时执行长时间运行的进程：“长时间运行的进程”通过`ShellExecuteEx()`. 然后安装程序使用一个带有条件的while循环
`WaitForSingleObject`和一个非常小的超时来执行`AppProcessMessage`。

`AppProcessMessage`本身就是一个辅助函数。它使用“通用”代码重新创建`Application.ProcessMessages`-ish 过程，使用 WinAPI函数`PeekMessage()`和. 它的工作是成为 Inno Setup GUI 的消息泵。`TranslateMessage()``DispatchMessage()`

这个技巧使窗口再次响应/可拖动，而“长时间运行的进程”在后台处理。

这是执行循环的来源：

```
if ShellExecuteEx(ExecInfo) then
begin
  while WaitForSingleObject(ExecInfo.hProcess, 100) = WAIT_TIMEOUT
  do begin
      AppProcessMessage;
      WizardForm.Refresh();
  end;
  CloseHandle(ExecInfo.hProcess);
end; 
```

以下 GIST包含用于在[不阻塞 Inno Setup GUI 的情况下执行 7zip](https://gist.github.com/jakoch/33ac13800c17eddb2dd4)`unzip.iss`的独立 Unzip Helper 的代码，包括使用该功能的点点滴滴。`AppProcessMessage`

在这种情况下，“解压缩”只是一个示例，您可以将执行的应用程序替换为 .NET 安装程序或任何其他长时间运行的任务。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T19:17:23.390

尽管这可能很容易，但我不建议在 .Net 安装程序运行时隐藏您的安装程序。我见过其他安装程序这样做，当它发生时，我认为安装已经完成，然后当我发现它真的没有时我很困惑。（当安装真的完成时，我也不能确定。也许它只是再次隐藏了自己。）

您可以在 Inno Setup 向导中显示自定义页面。让这样的页面显示进度条并保持其准确可能是一个挑战，但至少您可以在向导页面上显示一条消息，说明您的安装程序正在等待 .Net 安装程序，然后再继续。请参阅帮助文件的“使用自定义向导页面”部分。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T19:41:09.590

您可以通过调用简单地隐藏安装程序向导表单

```
WizardForm.Hide;
Exec(...);
WizardForm.Show; 
```

虽然我同意这不是很漂亮。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T19:18:36.773

我们需要安装带有几个产品的 .NET，并采取了两种方法：

*   使用 Innosetup 安装 .NET 时，我们让用户知道安装将需要很长时间，并在安装完成后期待某个消息

*   我们在没有任何标志的情况下启动 .NET 设置以强制客户端通过它。这样，如果他们更倾向于技术，他们就会知道为什么安装需要这么长时间

老实说，第二个选项的运气更好，特别是现在更多的系统管理员似乎在一定程度上锁定了桌面。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2014-04-27T02:26:07.313

你问这个问题已经5年了，但无论如何这是我的答案。

在调用 Exec() 之前，您可以设置 Inno Setup 将在主进度条上方显示的消息，如下所示：

```
WizardForm.StatusLabel.Caption := 'Installing .NET Framework 3.5\. Please wait, this can take up to 1 hour...'; 
```

# javascript - 如何在 Javascript 中确定现场时间？

> ID：591901
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-02-26T18:46:36.850
> 
>         
> 
> 标签：javascript, analytics

谷歌分析跟踪“现场时间”。你将如何有效地做到这一点？它是否真正跟踪用户关闭浏览器或导航离开的时间？

想法？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-26T19:03:26.593

我当然不能 100% 确定，但我猜他们使用 javascript 以及 onload 和 onunload 事件和/或 setTimer 通过 AJAX 与 Web 服务进行通信。通过这种方式，他们可以确定用户何时访问或离开您网站上的页面。一旦浏览器停止“ping”网络服务，就假定他们离开了您的网站。

我敢肯定，不管你怎么做，都会有一些误差，但你可以通过这种方式得到一个相当不错的估计。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T19:04:45.560

只需设置这样的功能：    

```
function track()
{
   setTimeout(track ,1000);
   now = new Date;
   now_string = now.getHours() + ":" + now.getMinutes() + ":" + now.getSeconds();
   (... whatever you want to do with this data)
} 
```

在 javascript 中，如果小时/分钟/秒数少于 2 个字符，您会得到这样的字符串 HH:MM:SS 或 H:M:S

所以只需围绕它做一些数学运算

只需将它运行在窗口中的某个位置，并将其与会话相关联（保证这是在所有页面中），您就可以准确地了解某个用户在您的页面中的时间。

编辑：必须删除我在那里的一个功能，它不是来自 javascript sry：p

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-11-24T17:48:54.153

`onBeforeUnload`当用户离开页面时，会调用一个 javascript 事件。这可能包括关闭窗口/选项卡或导航到不同的页面（即使它在同一个站点上）。通过在页面加载后立即获取时间并使用 JavaScript 以加载和离开之间的时间差发送同步请求`onBeforeUnload`，您可以有效地跟踪在页面上花费的时间。我认为这就是谷歌所做的。

如果您想要工作代码示例和更多信息，请查看[此](http://www.metamorphosite.com/time-site-javascript-send-synchronous-request-php)内容。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T19:03:36.343

我认为它不会在您关闭浏览器或导航离开时进行跟踪，即使这样做，这在 100% 的情况下也不起作用。

我的猜测是，他们估计了退出页面的停留时间，可能是基于前几页或所有访问者该页面的平均值。如果您在几分钟内获得了三个页面点击量，那么您对前两个页面的查看时间是准确的，但您永远不知道第三个页面被查看了多长时间。也许您立即关闭页面，或者将其打开并稍后阅读。

这是统计数据，所以从长远来看，它通常是相当准确的，但它从来都不是真的。;)

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T19:02:28.483

我怀疑他们可能会运行一个计时器，该计时器使用 cookie 在每个循环上重复并执行某种回调来识别用户和会话

# html - 如果我只是在做 Ruby 编程，在什么情况下需要 eruby

> ID：591904
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-26T18:47:12.107
> 
>         
> 
> 标签：html, ruby-on-rails, ruby, haml, eruby

据我了解，eruby 就像 erb - 它可以让您将 ruby​​ 代码粘贴到 HTML 中。如果有人在使用 Rails，他们很可能会使用 erb 或 Haml。

**但是如果我不使用 Rails，如果我只是在做 Ruby 编程，在什么情况下需要 eruby？** 

我想我不明白为什么有人需要输出 HTML，如果他们只是使用 Ruby 来编写脚本。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T19:04:34.717

eRuby 不仅适用于 HTML - 它允许您将 ruby​​ 嵌入到任意文本中。例如，我已经看到它在生成 Apache 配置文件的脚本中使用 - 如果您有任何需要一些动态内容的基于文本的输出，它通常很有用，因为 eRuby 模板通常比一堆更容易阅读字符串连接或插值。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T18:52:44.683

你刚刚回答了你自己的问题。如果你的脚本需要输出 HTML，你可以使用 eruby。除此之外，您可能不需要它。

# web-applications - 我可以在不需要 Internet 的情况下构建 Intranet Web 应用程序吗？

> ID：591905
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-26T18:47:41.373
> 
>         
> 
> 标签：web-applications

我最近接触了一家根本不需要互联网但他们想要一个网络应用程序来促进他们的生产的公司。

是否可以在不需要互联网的情况下满足他们的要求？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-02-26T18:48:45.957

是的，它被称为 intRAnet，它托管在公司网络内的 Web 服务器上。您不会遇到那么多防火墙问题，并且访问内部数据库会更容易。但除此之外，情况大致相同——只是没有互联网。我假设您正在考虑基于浏览器的应用程序，因为原始问题标签是“web-applications”。

当然，您也可以编写不需要浏览器的桌面应用程序。或者有混合解决方案、Silverlight（或类似）或后端带有 Web 服务的桌面应用程序。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T19:03:45.750

是的，我开发的大多数应用程序都是为了内部业务需求。它们旨在提高我们员工的自动化程度和生产力。

此外，通常您的公司/组织将拥有一个集中的 LDAP 存储库，用于存储您的所有员工信息，这使得处理安全和查询员工信息变得更加容易。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:49:04.193

是的，只要所有用户（和服务器）都在本地网络上

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-27T03:01:52.603

当然。正如其他人已经说过的那样，这就是 Intranet 的全部意义所在。

我要补充一点，Web 应用程序是一个很好的方法，因为它需要零部署。任何带有网络浏览器的机器都可以访问和使用它。进行修复，使用该应用程序的每个人都会立即使用修复的代码。  

但是，Web 应用程序可能很困难。从后端到前端以及介于两者之间的所有内容，都有一百万个框架。然后，您可能需要处理复杂的服务器配置。授权和身份验证可能是一个真正的痛苦。等等。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2013-03-25T12:37:30.947

我在电脑上安装了一个浏览器应用程序，作为连接到本地网络工作组的服务器。所以我需要能够在同一网络上的另一台电脑上访问这个应用程序

* * *

## 回答 #6

> 赞同：-1
> 
>             
> 
> 时间：2009-02-26T18:51:52.890

Intranet 的主要目的是更有效和高效地使用组织资源，资源也在 Intranet 中得到保护。

# .net - 如何控制 .NET DataContract 序列化，使其使用 XML 属性而不是元素？

> ID：591907
> 
>         
> 
> 赞同：18
> 
>         
> 
> 时间：2009-02-26T18:47:47.720
> 
>         
> 
> 标签：.net, serialization, xml-serialization, datacontract

如果我有一个标记为 a 的类`DataContract`和一些用属性标记的`DataMember`属性，我可以轻松地将其序列化为 XML，但它会创建如下输出：

```
<Person>
    <Name>John Smith</Name>
    <Email>john.smith@acme.com</Email>
    <Phone>123-123-1234</Phone>
</Person> 
```

我更喜欢的是属性，比如......

```
<Person Name="John Smith" Email="john.smith@acme.com" Phone="123-123-1234" /> 
```

该`DataMember`属性允许我控制名称和顺序，但不能控制它是否被序列化为元素或属性。我环顾四周并找到了`DataContractFormat`，`IXmlSerializable`但我希望有一个更简单的解决方案。

最简单的方法是什么？

* * *

## 回答 #1

> 赞同：39
> 
>             
> 
> 时间：2009-08-17T11:25:14.073

您可以使用 DataContractSerializer 执行此操作 - 答案是通过实现 IXmlSerializable 接口自己接管 Xml 序列化。对于只写支持 - 您可以将 ReadXml 的实现留空，并为 GetSchema 返回 null，然后编写 WriteXml 的实现，如下所示：

```
public class MyPerson : IXmlSerializable
{
  public string Name { get; set;}
  public string Email { get; set;}
  public string Phone { get; set;}

  public XmlSchema GetSchema() { return null; }
  public void ReadXml(XmlReader reader) { }
  public void WriteXml(XmlWriter writer)
  { 
    writer.WriteAttributeString("name", Name);
    writer.WriteAttributeString("email", Email);
    writer.WriteAttributeString("phone", Phone);
  } 
} 
```

如果您也使用相同的类型进行 JSON 序列化，那么您仍然可以自由添加 DataContract 和 DataMember 属性 - DataContractSerializer 将仅在编写 Xml 时使用 IXmlSerializable 接口实现。

[我在这里](http://lordzoltan.blogspot.com/2010/09/serializing-to-attributes-in-wcf-with.html)写了一篇博客。

* * *

## 回答 #2

> 赞同：17
> 
>             
> 
> 时间：2009-02-26T18:50:01.367

你不能用`DataContractSerializer`; 如果你想要属性，你需要使用`XmlSerializer`。使用`DataContractSerializer`该类，允许使用限制性更强的 XML 规范子集，这可以提高性能，并提高已发布服务的互操作性，但对 XML 格式的控制却相当少。

如果您使用的是 WCF 服务，请查看[`XmlSerializerFormatAttribute`](http://msdn.microsoft.com/en-us/library/system.servicemodel.xmlserializerformatattribute.aspx)哪些允许您使用`XmlSerializer`用于序列化。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2012-05-20T21:35:52.407

序列化/反序列化时，您可以在属性和元素之间来回转换。以下适用于后者。

```
 private XmlReader AttributesToElements( Stream stream )
    {
            var root = XElement.Load( stream );
            foreach ( var element in root.Descendants() ) {
                    foreach ( var attribute in element.Attributes() )
                            element.Add( new XElement( root.Name.Namespace + attribute.Name.LocalName, (string)attribute ) );
                    element.Attributes().Remove();
            }
            return root.CreateReader();
    } 
```

# perl - 如何使用 Perl 对平面文件进行全文搜索？

> ID：591918
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-26T18:50:36.920
> 
>         
> 
> 标签：perl, search, flat-file

我们有一个基于 Perl 的 Web 应用程序，它的数据来自一个庞大的平面文本文件存储库。这些平面文件被放置在我们系统上的一个目录中，我们广泛解析它们，将一些信息插入 MySQL 数据库，然后将这些文件移动到它们的存档存储库和永久主页 (/www/website/archive/*.txt)。现在，我们不会解析这些平面文件中的每一位数据，并且一些更晦涩的数据项不会被数据库化。  

目前的要求是用户能够从 Perl 生成的网页对整个平面文件存储库执行全文搜索，并返回一个点击列表，然后他们可以单击并打开文本文件审查。

启用此搜索功能的最优雅、最高效且非 CPU 密集型的方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-02-27T01:15:31.517

我建议按以下顺序：

1.  将每个文档的全部内容放入 MySQL 表中，并使用 MySQL 的全文搜索和索引功能。我从来没有做过，但 MySQL 总是能够处理比我能处理的更多的事情。  

2.  **[Swish-E](https://www.esa.org/tiee/search/html/readme.html)**仍然存在，旨在构建全文索引并允许排名结果。我已经运行它几年了，效果很好。

3.  您可以`File::Find`在 Perl 代码中使用类似 的方法来浏览存储库`grep -r`，但与上面的索引选项之一相比，它会很糟糕。但是，它会起作用，甚至可能会让您大吃一惊:)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T19:03:33.910

我建议使用专门的搜索引擎来进行索引和搜索。  

我最近没有看搜索引擎，但几年前我使用了[ht://dig ，并且对结果很满意。](http://www.htdig.org/)

**更新：**此时看起来 ht://dig 是一个僵尸项目。您可能想使用另一个引擎。  [Hyper Estraier](http://hyperestraier.sourceforge.net/)除了不发音之外看起来很有希望。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-27T16:40:59.827

我支持添加索引机的建议。[考虑来自http://namazu.org](http://namazu.org)的Namazu 。当我需要它时，它看起来比 Swish-e 更容易上手，ht://dig 并且我对它很满意。

如果您不想要索引器的开销，请查看分叉 grep/egrep。一旦文本量达到数兆字节，这将比仅在 Perl 中扫描要快得多，例如：

```
open GREP, "find $dirlist -name '$filepattern' | xargs egrep '$textpattern' |"
                                         or die    "grep: $!";
while (<GREP>)  {
       ...
} 
```

奖励：使用日期/标签/等文件名约定将文件集减少为 grep。笨重`find ... | xargs ...`的旨在解决通配符扩展的外壳大小限制，您可能会遇到大档案。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-03-03T05:47:36.947

我看到有人推荐 Lucene/Plucene。查看[KinoSearch](http://search.cpan.org/~creamyg/KinoSearch-0.163/lib/KinoSearch.pm)，我在一个基于 Catalyst 的项目中使用它已经有一年或更长时间了，对编程/维护的性能和易用性非常满意。

应根据您的情况考虑该页面上的警告，但我可以证明该模块的稳定性。

# email - ASP.NET SQLMembershipProvider - 电子邮件作为用户名

> ID：591919
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-26T18:50:44.127
> 
>         
> 
> 标签：email, asp.net-membership

我即将开始构建一个新的 asp.net 项目，而我刚刚开始使用 SQLMembershipProvider 的全部内容。我真正想做的是消除对用户名的需要，只需将用户的密钥作为电子邮件地址。

在我看来，最简单的事情可能是将存储过程更改为仅从表中删除电子邮件地址，并且当有人通过电子邮件进行搜索时，只需使用密钥（我还需要处理有人更改他们的电子邮件地址...

在我开始之前，有没有人知道那里有一个预先推出的例子。必须构建它似乎太常见了。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-26T18:54:05.630

您无需更改提供程序中的任何内容。只需在注册时将电子邮件设置为用户名，并且不要在 UI 中提供任何更改电子邮件地址的方法。它会轻松完成这项工作。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T18:53:43.840

您可以修改程序...或者只是省略表单/ui 中的电子邮件或用户名字段，并在幕后使用其中一个或另一个来填充另一个字段。这可能是重复的数据，但您可能会发现需要有一封电子邮件，这也不是用户名。

# git - Make Git automatically remove trailing white space before committing

> ID：591923
> 
>         
> 
> 赞同：234
> 
>         
> 
> 时间：2009-02-26T18:52:20.720
> 
>         
> 
> 标签：git, whitespace, githooks

I'm using Git with my team and would like to remove white space changes from my diffs, logs, merges, etc. I'm assuming that the easiest way to do this would be for Git to automatically remove trailing white space (and other white space errors) from all commits as they are applied.

I have tried to add the following to the `~/.gitconfig` file, but it doesn't do anything when I commit. Maybe it's designed for something different. What's the solution?

```
[core]
    whitespace = trailing-space,space-before-tab
[apply]
    whitespace = fix 
```

I'm using Ruby in case anyone has any Ruby specific ideas. Automatic code formatting before committing would be the next step, but that's a hard problem and is not really causing a big problem.

* * *

## 回答 #1

> 赞同：119
> 
>             
> 
> 时间：2009-02-26T19:19:01.453

这些设置 (`core.whitespace`和`apply.whitespace`) 不是为了删除尾随空格，而是为了：

*   `core.whitespace`：检测它们，并引发错误

*   `apply.whitespace`：并剥离它们，但仅在补丁期间，而不是“总是自动”

我相信这**[`git hook pre-commit`](https://git-scm.com/docs/githooks#_pre_commit)**会做得更好（包括删除尾随空格）

* * *

请注意，在任何给定时间，您都可以选择不运行该`pre-commit`挂钩：

*   暂时地：`git commit --no-verify .`

*   永久：`cd .git/hooks/ ; chmod -x pre-commit`

警告：默认情况下，一个`pre-commit`脚本（比如[这个](http://www.rpcurnow.force9.co.uk/git/tdl.git/hooks/pre-commit)）*没有*“删除尾随”功能，而是一个“警告”功能，例如：

```
if (/\s$/) {
    bad_line("trailing whitespace", $_);
} 
```

但是，您可以**[构建一个更好的`pre-commit`hook](https://web.archive.org/web/20120119055419/http://newartisans.com:80/2009/02/building-a-better-pre-commit-hook-for-git/)**，尤其是当您考虑到以下情况时：

> 在 Git 中只在暂存区添加一些更改的提交仍然会导致“原子”修订，它*可能永远不会作为工作副本存在并且可能无法正常工作*。

* * *

例如，[oldman](https://stackoverflow.com/users/792416/oldman)[在另一个答案中](https://stackoverflow.com/a/22704385/6309)提出了一个检测和删除空格的[`pre-commit`钩子。](https://github.com/imoldman/config/blob/master/pre-commit.git.sh)

由于该挂钩获取每个文件的文件名，因此我建议对某些类型的文件要小心：您不想删除`.md`（降价）文件中的尾随空格！

* * *

[hakre](https://stackoverflow.com/users/367456/hakre)在[评论](https://stackoverflow.com/questions/591923/make-git-automatically-remove-trailing-white-space-before-committing/592014?noredirect=1#comment123842676_592014)中建议的另一种方法：

> 您可以在 markdown 的行尾有两个空格，而不是通过`\`在前面添加 ""将其作为尾随空格`\n`。

然后是内容过滤器驱动程序：

```
git config --global filter.space-removal-at-eol.clean 'sed -e "s/ \+$//"'
# register in .gitattributes 
*.md filter=space-removal-at-eol 
```

* * *

## 回答 #2

> 赞同：49
> 
>             
> 
> 时间：2013-03-13T23:30:18.590

你可以欺骗 Git 为你修复空白，方法是欺骗 Git 将你的更改视为一个补丁。与“预提交挂钩”解决方案相比，这些解决方案向 Git 添加了空白修复命令。

是的，这些都是黑客。

* * *

## 强大的解决方案

以下 Git 别名取自 
[我的`~/.gitconfig`](https://github.com/ntc2/conf/blob/79ceaa6f54402b4d3a2592bef845efa38c0102eb/dot.gitconfig).

“健壮”是指这些别名运行没有错误，做正确的事情，无论树或索引是否脏。`git rebase -i`但是，如果交互已经在进行中，它们将不起作用；如果您关心这个极端情况，请参阅[我`~/.gitconfig`](https://github.com/ntc2/conf/blob/79ceaa6f54402b4d3a2592bef845efa38c0102eb/dot.gitconfig)`git add -e`的其他检查，最后描述的技巧应该可以工作。

如果您想直接在 shell 中运行它们，而不创建 Git 别名，只需复制并粘贴双引号之间的所有内容（假设您的 shell 类似于 Bash）。

### 修复索引但不修复树

以下`fixws`Git 别名修复了索引中的所有空白错误（如果有），但不涉及树：

```
# Logic:
#
# The 'git stash save' fails if the tree is clean (instead of
# creating an empty stash :P). So, we only 'stash' and 'pop' if
# the tree is dirty.
#
# The 'git rebase --whitespace=fix HEAD~' throws away the commit
# if it's empty, and adding '--keep-empty' prevents the whitespace
# from being fixed. So, we first check that the index is dirty.
#
# Also:
# - '(! git diff-index --quiet --cached HEAD)' is true (zero) if
#   the index is dirty
# - '(! git diff-files --quiet .)' is true if the tree is dirty
#
# The 'rebase --whitespace=fix' trick is from here:
# https://stackoverflow.com/a/19156679/470844
fixws = !"\
  if (! git diff-files --quiet .) && \
     (! git diff-index --quiet --cached HEAD) ; then \
    git commit -m FIXWS_SAVE_INDEX && \
    git stash save FIXWS_SAVE_TREE && \
    git rebase --whitespace=fix HEAD~ && \
    git stash pop && \
    git reset --soft HEAD~ ; \
  elif (! git diff-index --quiet --cached HEAD) ; then \
    git commit -m FIXWS_SAVE_INDEX && \
    git rebase --whitespace=fix HEAD~ && \
    git reset --soft HEAD~ ; \
  fi" 
```

这个想法是在索引中有空格错误时`git fixws`先运行。`git commit`

### 修复索引和树

以下`fixws-global-tree-and-index`Git 别名修复了索引和树中的所有空白错误（如果有）：

```
# The different cases are:
# - dirty tree and dirty index
# - dirty tree and clean index
# - clean tree and dirty index
#
# We have to consider separate cases because the 'git rebase
# --whitespace=fix' is not compatible with empty commits (adding
# '--keep-empty' makes Git not fix the whitespace :P).
fixws-global-tree-and-index = !"\
  if (! git diff-files --quiet .) && \
     (! git diff-index --quiet --cached HEAD) ; then \
    git commit -m FIXWS_SAVE_INDEX && \
    git add -u :/ && \
    git commit -m FIXWS_SAVE_TREE && \
    git rebase --whitespace=fix HEAD~2 && \
    git reset HEAD~ && \
    git reset --soft HEAD~ ; \
  elif (! git diff-files --quiet .) ; then \
    git add -u :/ && \
    git commit -m FIXWS_SAVE_TREE && \
    git rebase --whitespace=fix HEAD~ && \
    git reset HEAD~ ; \
  elif (! git diff-index --quiet --cached HEAD) ; then \
    git commit -m FIXWS_SAVE_INDEX && \
    git rebase --whitespace=fix HEAD~ && \
    git reset --soft HEAD~ ; \
  fi" 
```

要修复未版本化文件中的空白，请执行

```
git add --intent-to-add <unversioned files> && git fixws-global-tree-and-index 
```

* * *

## 简单但不可靠的解决方案

这些版本更容易复制和粘贴，但如果不满足其附带条件，它们就不会做正确的事情。

### 修复以当前目录为根的子树（但如果它不为空则重置索引）

使用`git add -e`身份编辑器“编辑”补丁`:`：

```
(export GIT_EDITOR=: && git -c apply.whitespace=fix add -ue .) && git checkout . && git reset 
```

### 修复并保留索引（但如果树脏或索引为空则失败）

```
git commit -m TEMP && git rebase --whitespace=fix HEAD~ && git reset --soft HEAD~ 
```

### 修复树和索引（但如果它不为空则重置索引）

```
git add -u :/ && git commit -m TEMP && git rebase --whitespace=fix HEAD~ && git reset HEAD~ 
```

* * *

### `export GIT_EDITOR=: && git -c apply.whitespace=fix add -ue .`套路的解释

[在我从这个答案](https://stackoverflow.com/a/19156679/470844)中了解`git rebase --whitespace=fix`技巧之前，我到处都在使用更复杂的技巧。`git add`

如果我们手动完成：

1.  设置`apply.whitespace`为`fix`（您只需执行一次）：

    ```
    git config apply.whitespace fix 
    ```

    这告诉 Git 修复*补丁*中的空白。

2.  说服 Git 将您的更改视为一个*补丁*：

    ```
    git add -up . 
    ```

    点击`a`+`enter`选择每个文件的所有更改。您将收到有关 Git 修复空白错误的警告。

    （`git -c color.ui=auto diff`此时表明您的非索引更改正是空白错误）。

3.  从工作副本中删除空白错误：

    ```
    git checkout . 
    ```

4.  带回您的更改（如果您还没有准备好提交它们）：

    ```
    git reset 
    ```

作为编辑器使用的`GIT_EDITOR=:`手段`:`，作为命令
使用`:`的就是身份。

* * *

## 回答 #3

> 赞同：30
> 
>             
> 
> 时间：2010-08-18T20:44:57.350

我发现了一个 Git[预提交钩子，可以删除尾随空格](http://snipplr.com/view/28523/git-precommit-hook-to-fix-trailing-whitespace/)。

```
#!/bin/sh

if git-rev-parse --verify HEAD >/dev/null 2>&1 ; then
   against=HEAD
else
   # Initial commit: diff against an empty tree object
   against=4b825dc642cb6eb9a060e54bf8d69288fbee4904
fi
# Find files with trailing whitespace
for FILE in `exec git diff-index --check --cached $against -- | sed '/^[+-]/d' | sed -r 's/:[0-9]+:.*//' | uniq` ; do
   # Fix them!
   sed -i 's/[[:space:]]*$//' "$FILE"
   git add "$FILE"
done
exit 
```

* * *

## 回答 #4

> 赞同：20
> 
>             
> 
> 时间：2011-01-04T18:31:48.513

在 macOS（或者可能是任何 BSD）上，sed 命令参数必须略有不同。尝试这个：

```
#!/bin/sh

if git-rev-parse --verify HEAD >/dev/null 2>&1 ; then
   against=HEAD
else
   # Initial commit: diff against an empty tree object
   against=4b825dc642cb6eb9a060e54bf8d69288fbee4904
fi

# Find files with trailing whitespace
for FILE in `exec git diff-index --check --cached $against -- | sed '/^[+-]/d' | sed -E 's/:[0-9]+:.*//' | uniq` ; do
    # Fix them!
    sed -i '' -E 's/[[:space:]]*$//' "$FILE"
    git add "$FILE"
done 
```

将此文件另存为`.git/hooks/pre-commit`-- 或查找已经存在的文件，然后将底部的块粘贴到其中的某个位置。并记住`chmod a+x`它。

或者为了全局使用（通过[Applying a git post-commit hook to all current and future repos](https://stackoverflow.com/questions/2293498)）你可以把它放进去`$GIT_PREFIX/git-core/templates/hooks`（其中 GIT_PREFIX 是 /usr 或 /usr/local 或 /usr/share 或 /opt/local/share ）和`git init`在您现有的存储库中运行。

根据`git help init`：

> `git init`在现有存储库中运行是安全的。它不会覆盖已经存在的东西。重新运行的主要原因`git init`是选择新添加的模板。

* * *

## 回答 #5

> 赞同：13
> 
>             
> 
> 时间：2009-02-26T21:34:44.530

我宁愿把这个任务留给你最喜欢的编辑。

只需设置一个命令以在保存时删除尾随空格。

* * *

## 回答 #6

> 赞同：12
> 
>             
> 
> 时间：2015-02-11T04:07:35.450

# 使用 Git 属性和过滤器设置与 Git 配置

好的，这是解决这个问题的新方法……我的方法是不使用任何钩子，而是使用过滤器和 Git 属性。这允许您在您开发的每台机器上设置一组过滤器，这些过滤器将在提交文件之前去除文件末尾的额外尾随空格和额外空行。

然后设置一个 .gitattributes 文件，说明过滤器应该应用于哪些类型的文件。过滤器有两个阶段，`clean`一个是在将文件添加到索引时应用，另一个是在将文件`smudge`添加到工作目录时应用。

## 告诉你的 Git 寻找一个全局属性文件

首先，告诉您的全局配置使用全局属性文件：

```
git config --global core.attributesfile ~/.gitattributes_global 
```

## 创建全局过滤器

现在，创建过滤器：

```
git config --global filter.fix-eol-eof.clean fixup-eol-eof %f
git config --global filter.fix-eol-eof.smudge cat
git config --global filter.fix-eol-eof.required true 
```

## 添加[sed](https://en.wikipedia.org/wiki/Sed)脚本魔法

最后，将`fixup-eol-eof`脚本放在路径上的某个位置，并使其可执行。该脚本使用 sed 进行一些即时编辑（删除行尾的空格和空白，以及文件末尾的无关空白行）

fixup-eol-eof 应该如下所示：

```
#!/bin/bash
sed -e 's/[     ]*$//' -e :a -e '/^\n*$/{$d;N;ba' -e '}' $1 
```

[我的要点](https://gist.github.com/zbeekman/c3f2ef40ea176ba550fe)

## 告诉 Git 将新创建的过滤器应用于哪些文件类型

最后，在您喜欢的文本编辑器中创建或打开文件*~/.gitattributes_global并添加如下行：*

```
pattern attr1 [attr2 [attr3 […]]] 
```

因此，如果我们想解决空白问题，对于我们所有的 C 源文件，我们将添加如下所示的一行：

```
*.c filter=fix-eol-eof 
```

# 过滤器的讨论

过滤器有两个阶段。将内容添加到索引或签入时应用的清洁阶段，以及 Git 将内容放入工作目录时的涂抹阶段。

在这里，我们的涂抹只是通过`cat`命令运行内容，应该保持它们不变，除了如果文件末尾没有换行符，则可能添加尾随换行符。

[clean 命令是我从http://sed.sourceforge.net/sed1line.txt](http://sed.sourceforge.net/sed1line.txt)的注释中拼凑起来的空白过滤。看来它必须放入一个shell脚本。我不知道如何注入 sed 命令，包括将文件末尾多余的额外行直接注入 git-config 文件。（但是，您*可以*摆脱尾随空白，而无需单独的 sed 脚本。只需将 设置`filter.fix-eol-eof`为类似于`sed 's/[ \t]*$//' %f`实际`\t`选项卡的位置，按`Tab`。）

如果出现`require = true`问题，则会引发错误，以免您遇到麻烦。

* * *

## 回答 #7

> 赞同：9
> 
>             
> 
> 时间：2014-03-28T04:44:37.460

请尝试[我的**预提交**钩子](https://github.com/imoldman/config/blob/master/pre-commit.git.sh)。它可以自动检测尾随空格并将***其删除***。

它可以在[Git Bash](https://superuser.com/questions/1053633/what-is-git-bash-for-windows-anyway) (Windows)、Mac OS X 和 Linux 下运行！

* * *

快照：

```
$ git commit -am "test"
auto remove trailing whitespace in foobar/main.m!
auto remove trailing whitespace in foobar/AppDelegate.m!
[master 80c11fe] test
1 file changed, 2 insertions(+), 2 deletions(-) 
```

* * *

## 回答 #8

> 赞同：9
> 
>             
> 
> 时间：2013-10-14T07:33:56.440

我写了这个 pre-commit 钩子，它只从你更改/添加的行中删除尾随空格，因为如果目标文件有太多尾随空格，前面的建议往往会创建不可读的提交。

```
#!/bin/sh

if git rev-parse --verify HEAD >/dev/null 2>&1 ; then
   against=HEAD
else
   # Initial commit: diff against an empty tree object
   against=4b825dc642cb6eb9a060e54bf8d69288fbee4904
fi

IFS='
'

files=$(git diff-index --check --cached $against -- | sed '/^[+-]/d' | perl -pe 's/:[0-9]+:.*//' | uniq)
for file in $files ; do
    diff=$(git diff --cached $file)
    if test "$(git config diff.noprefix)" = "true"; then
        prefix=0
    else
        prefix=1
    fi
    echo "$diff" | patch -R -p$prefix
    diff=$(echo "$diff" | perl -pe 's/[ \t]+$// if m{^\+}')
    out=$(echo "$diff" | patch -p$prefix -f -s -t -o -)
    if [ $? -eq 0 ]; then
        echo "$diff" | patch -p$prefix -f -t -s
    fi
    git add $file
done 
```

* * *

## 回答 #9

> 赞同：7
> 
>             
> 
> 时间：2011-06-07T08:44:15.787

这是一个 Ubuntu 和 Mac OS X 兼容的版本：

```
#!/bin/sh
#

# A Git hook script to find and fix trailing white space
# in your commits. Bypass it with the --no-verify option
# to git-commit
#

if git-rev-parse --verify HEAD >/dev/null 2>&1 ; then
  against=HEAD
else
  # Initial commit: diff against an empty tree object
  against=4b825dc642cb6eb9a060e54bf8d69288fbee4904
fi
# Find files with trailing whitespace
for FILE in `exec git diff-index --check --cached $against -- | sed '/^[+-]/d' | (sed -r 's/:[0-9]+:.*//' > /dev/null 2>&1 || sed -E 's/:[0-9]+:.*//') | uniq` ; do
  # Fix them!
  (sed -i 's/[[:space:]]*$//' "$FILE" > /dev/null 2>&1 || sed -i '' -E 's/[[:space:]]*$//' "$FILE")
  git add "$FILE"
done

# Now we can commit
exit 
```

* * *

## 回答 #10

> 赞同：5
> 
>             
> 
> 时间：2012-09-20T07:54:14.863

我今天正在考虑这个问题。这就是我最终为 Java 项目所做的一切：

```
egrep -rl ' $' --include *.java *  | xargs sed -i 's/\s\+$//g' 
```

* * *

## 回答 #11

> 赞同：4
> 
>             
> 
> 时间：2014-06-19T13:37:50.457

对于[崇高文本](https://en.wikipedia.org/wiki/Sublime_Text)用户。

*在您的设置用户*配置中正确设置以下内容。

```
"trim_trailing_white_space_on_save": true 
```

* * *

## 回答 #12

> 赞同：2
> 
>             
> 
> 时间：2011-10-16T23:44:40.453

`for`文件循环使用shell`$IFS`变量。在给定的脚本中，其中包含一个字符且也在 $IFS 变量中的文件名将被视为`for`循环中的两个不同文件。

[这个脚本修复了它： sed](https://en.wikipedia.org/wiki/Sed)手册中给出的多行模式修饰符默认情况下在我的 Ubuntu 机器上似乎不起作用，所以我寻找不同的实现并发现它带有迭代标签，基本上它只会开始替换如果我理解正确，文件的最后一行。

```
#!/bin/sh
#

# A Git hook script to find and fix trailing white space
# in your commits. Bypass it with the --no-verify option
# to git-commit
#

if git rev-parse --verify HEAD >/dev/null 2>&1
then
    against=HEAD
else
    # Initial commit: diff against an empty tree object
    against=4b825dc642cb6eb9a060e54bf8d69288fbee4904
fi

SAVEIFS="$IFS"
# only use new-line character as separator, introduces EOL-bug?
IFS='
'
# Find files with trailing white space
for FILE in $(
    git diff-index --check --cached $against -- \
    | sed '/^[+-]/d' \
    | ( sed -r 's/:[0-9]+:.*//' || sed -E 's/:[0-9]+:.*//' ) \
    | uniq \
)
do
# replace whitespace-characters with nothing
# if first execution of sed-command fails, try second one (Mac OS X version)
    (
        sed -i ':a;N;$!ba;s/\n\+$//' "$FILE" > /dev/null 2>&1 \
        || \
        sed -i '' -E ':a;N;$!ba;s/\n\+$//' "$FILE" \
    ) \
    && \
# (re-)add files that have been altered to Git commit-tree
#   when change was a [:space:]-character @EOL|EOF git-history becomes weird...
    git add "$FILE"
done
# restore $IFS
IFS="$SAVEIFS"

# Exit script with the exit-code of git's check for white space characters
exec git diff-index --check --cached $against -- 
```

[1](https://en.wikipedia.org/wiki/Sed) sed 替换模式：*[如何使用 sed 替换换行符 (\n)？](https://stackoverflow.com/questions/1251999/sed-how-can-i-replace-a-newline-n/7697604#7697604)*

* * *

## 回答 #13

> 赞同：2
> 
>             
> 
> 时间：2017-10-21T03:10:35.633

这不会在提交之前**自动**删除空格，但它很容易实现。我将以下[Perl](https://en.wikipedia.org/wiki/Perl)脚本放在 $PATH 目录中名为 git-wsf (Git white space fix) 的文件中，这样我可以：

```
git wsf | sh 
```

*它仅从*Git 报告为差异的文件行中删除所有空白。

```
#! /bin/sh
git diff --check | perl -x $0
exit

#! /usr/bin/perl

use strict;

my %stuff;
while (<>) {
    if (/trailing whitespace./) {
        my ($file,$line) = split(/:/);
        push @{$stuff{$file}},$line;
    }
}

while (my ($file, $line) = each %stuff) {
    printf "ex %s <<EOT\n", $file;
    for (@$line) {
        printf '%ds/ *$//'."\n", $_;
    }
    print "wq\nEOT\n";
} 
```

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2021-11-01T10:01:11.050

## 相同结果的 Python 脚本。

```
import subprocess                                                                 

def get_trailing_lines():                                                         

    result = subprocess.run([                                                     
                            'git',                                            
                            'diff',                                           
                            '--check'                                         
                        ], capture_output=True)                               

    return result.stdout.decode().split('\n')                                     

def modify_line(file_path, l_num):                                                

    f_lines = open(file_path).readlines()                                         
    f_lines[l_num] = f_lines[l_num].rstrip()+'\n'\                                
                     if '\n' in f_lines[l_num] else f_lines[l_num].rstrip()    

    with open(file_path, "w") as w_fp:                                            
        w_fp.writelines(f_lines)                                                  

if __name__ == '__main__':                                                        

    l = get_trailing_lines()                                                      
    for m, d in zip(l[::2], l[1::2]):                                             
        f_path, l_no, *_ = m.split(":")                                           
        modify_line(f_path, int(l_no)-1) 
```

* * *

## 回答 #15

> 赞同：-1
> 
>             
> 
> 时间：2009-02-26T19:12:18.333

This probably won't directly solve your problem, but you might want to set those via [git-config](https://git-scm.com/docs/git-config) in your actual project space, which edits file *./.git/config* as opposed to file *~/.gitconfig*. It is nice to keep the settings consistent among all project members.

```
git config core.whitespace "trailing-space,space-before-tab"
git config apply.whitespace "trailing-space,space-before-tab" 
```

* * *

## 回答 #16

> 赞同：-1
> 
>             
> 
> 时间：2014-12-02T13:50:00.070

要可移植地删除文件中行尾的尾随空格，请使用`ed`：

```
test -s file &&
   printf '%s\n' H ',g/[[:space:]]*$/s///' 'wq' | ed -s file 
```

* * *

## 回答 #17

> 赞同：-2
> 
>             
> 
> 时间：2014-07-25T22:20:53.477

在 Vim 中打开文件。要用空格替换制表符，请在 Vim 命令行中输入以下内容：

```
:%s#\t#    #gc 
```

摆脱其他尾随空格

```
:%s#\s##gc 
```

这几乎为我做到了。如果您有很多文件要编辑，这很乏味。但我发现它比预提交钩子和使用多个文本编辑器更容易。

# c# - 相当于 Gdi+ 中的 MM_ISOTROPIC 映射模式

> ID：591926
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T18:53:09.223
> 
>         
> 
> 标签：c#, gdi+, gdi

我有一些使用各向同性映射模式的 C++/GDI 绘图代码。我有一个带有大量绘图代码的大型对象模型，我试图在 C# 项目中重用这些代码以绘制到内存位图。我在正确设置 System.Graphics 对象以生成相同的图片时遇到问题。有没有办法在 System.Graphics 对象中设置等效的 MM_ISOTROPIC 映射模式？

这是准备映射模式的 C++/GDI 的相关代码。

```
CDC* pDC = ...
pDC->SetMapMode(MM_ISOTROPIC); 
pDC->SetWindowExt(24, 24); 
pDC->SetViewportExt(pDC->GetDeviceCaps(LOGPIXELSX), pDC->GetDeviceCaps(LOGPIXELSY)); 
```

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T20:09:18.290

MM_ISOTROPIC 没有什么特别之处，它只是确保 X 和 Y 缩放是相同的，即使您使用 SetViewportExt() 和 SetWindowExt() 给它的值冲突。你没有。我认为没有任何硬件没有方形像素。

无论如何，只要确保将相等的值传递给 Graphics.ScaleTransform()。

# sharepoint - SharePoint, Anonymous Access in FBA and SPContext issues

> ID：591933
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T18:55:06.503
> 
>         
> 
> 标签：sharepoint

We have created a virtual directory under the root sharepoint site. This virtual directory hosts a Web Service which is accessed anonymously.
In the code we are doing the following:

```
using(SPSite site = new site(some uri))
{
    using(SPWeb web = site.RootWeb)
    {
        SPList list = web.Lists["SomeList"];
        SPListItem item = list.GetItemById(1); // Exception Here, COM Exception        
    }
} 
```

This does not work even when using RunWithElevatedPrivileges.

However, if the HttpContext.Current is set to null, before creating the SPSite, everything works fine.

Any pointersas to why this is happening will be very helpful.

Kind regards,

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T22:09:27.673

相反！始终检查 null 并明确处置您的 SPSite 和您的 SPWeb 被认为是一种很好的做法，即使 SPSite 可以说会为您处置您的 SPWeb。

这也不是问题的一部分:-) 最坏的情况会导致工作进程比平时更频繁地回收......

您能否添加更多代码（整个类）。

还请包括错误的完整堆栈跟踪。（有关如何在此处启用堆栈跟踪和调试的详细信息[http://blogs.importchaos.com/alonsorobles/2008/06/09/enabling-the-sharepoint-safe-mode-call-stack-disabling-custom-errors-and -启用-编译-调试/](http://blogs.importchaos.com/alonsorobles/2008/06/09/enabling-the-sharepoint-safe-mode-call-stack-disabling-custom-errors-and-enabling-compilation-debugging/)）

我也认为您确定列表和项目存在并允许匿名访问？

关于安德斯拉斯克

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T21:37:38.937

这可能不是您的问题的原因，但您`SPWeb`不需要按照[Roger Lamb](http://blogs.msdn.com/rogerla/archive/2008/02/12/sharepoint-2007-and-wss-3-0-dispose-patterns-by-example.aspx#SPDisposeCheckID_140)的说法进行处理，这是 Microsoft 最佳实践文档的[提炼](http://msdn.microsoft.com/en-us/library/aa973248.aspx)。

# php - mysqli_use_result() 和并发

> ID：591936
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T18:57:12.287
> 
>         
> 
> 标签：php, mysql, mysqli, innodb, myisam

根据[mysqli_use_result的文档](http://us3.php.net/mysqli_use_result)

> 如果在客户端执行大量处理，则不应使用 mysqli_use_result()，因为这将占用服务器并阻止其他线程更新从中获取数据的任何表。

这仅适用于 myISAM 表还是适用于 InnoDB？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T21:17:55.160

刚刚检查：`MyISAM`锁定，`InnoDB`不锁定：

```
<?php
        $db = new mysqli() or die ("Cannot connect: " . mysqli_connect_error() . "\n");
        $query = "SELECT * FROM mytable";
        $db->real_query($query) or die ("Cannot fetch: $db->error\n");
        $result = $db->use_result() or die ("Cannot use result: $db->error\n");
        while($row = $result->fetch_row()) {
                print join("\t", $row) . "\n";
                usleep(1000000);
        }
?> 
```

这锁定：

```
UPDATE mytable /* isam */ SET myvalue = 'test' WHERE id = 100 
```

这不会：

```
UPDATE mytable /* innodb */ SET myvalue = 'test' WHERE id = 100 
```

# ruby-on-rails - 如何格式化 Rails 编辑字段中显示的值？

> ID：591939
> 
>         
> 
> 赞同：31
> 
>         
> 
> 时间：2009-02-26T18:59:27.380
> 
>         
> 
> 标签：ruby-on-rails, ruby, forms

我想让编辑表单字段尽可能方便用户。例如，对于数值，我希望该字段以逗号（如`number_with_precision`）显示。

这在显示方面很容易，但是编辑呢？有没有好的方法来做到这一点？

我正在使用 Rails FormBuilder。经过调查，我发现它使用了 InstanceTag，它通过 using 获取字段的值，这意味着不会调用`<attribute>_value_before_type_cast`覆盖。`<attribute>`

* * *

## 回答 #1

> 赞同：39
> 
>             
> 
> 时间：2009-02-26T19:04:53.047

到目前为止，我想出的最好的是这样的：

```
<%= f.text_field :my_attribute, :value => number_with_precision(f.object.my_attribute) %> 
```

或者`my_attribute`可以返回格式化的值，如下所示：

```
def my_attribute
  ApplicationController.helpers.number_with_precision(read_attribute(:my_attribute))
end 
```

但是你仍然必须使用`:value`

```
<%= f.text_field :my_attribute, :value => f.object.my_attribute %> 
```

这似乎需要做很多工作。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-02-26T19:46:05.990

我更喜欢你的第一个答案，格式是在视图中完成的。但是，如果您想在模型中执行格式化，您可以对 getter 和 setter 使用包装器方法，而不必完全使用 :value 选项。

你最终会得到这样的东西。

```
def my_attribute_string
  foo_formatter(myattribute)
end

def my_attribute_string=(s)
  # Parse "s" or do whatever you need to with it, then set your real attribute.
end

<%= f.text_field :my_attribute_string %> 
```

[Railscasts 在第 32 集](http://railscasts.com/episodes/32-time-in-text-field)的 text_field 中使用 Time 对象对此进行了介绍。真正聪明的部分是他们如何处理验证错误。仅此一集就值得一看。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2013-01-08T22:51:06.673

这是一个老问题，但如果有人遇到这个问题，您可以使用 number_to_X 助手。它们具有显示编辑值所需的所有属性：

```
<%= f.text_field :my_number, :value => number_to_human(f.object.my_number, :separator => '', :unit => '', :delimiter => '', :precision => 0) %> 
```

还有更多可用的属性：http: [//api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html](http://api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html)

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T23:52:04.260

如果您希望在编辑期间创建或维护格式，则需要添加 Javascript 来实现“掩码”。  [这是一个演示。](http://www.xaprb.com/html-input-mask/html-form-input-mask.html)

这是[这些结果](http://www.google.com/search?hl=en&safe=off&q=javascript+form+mask&btnG=Search)中的第一个打击。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-03-07T06:10:32.227

您可以使用[number_format](http://github.com/vladr/number_format/tree/master)插件。通过为模型中的现有数字属性指定 a `number_format`，该属性现在将在所有表单和视图中显示为 Rails 的格式。在插入数据库之前，它还将从该格式（通过表单分配时）解析回来。（该插件还创建纯数字`unformatted_<attribute-name>`访问器，可以继续用于算术，或直接用于数字分配或检索以实现无缝集成。）

```
class MyModel < ActiveRecord::Base
  # this model has the balance attribute, which we
  #  want to display using formatting in views,
  #  although it is stored as a numeric in the database
  number_format :balance, 
                :precision => 2,
                :delimiter => ',',
                :strip_trailing_zeros => false

  def increment_balance
    unformatted_balance += 10
  end 
```

您还可以将上述内容与 Javascript 解决方案结合使用，这可以强制用户在编辑时保留小数点和千位分隔符，尽管这实际上没有必要。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-03-05T22:38:33.287

我做过类似的事情。我们使用自定义表单构建器格式化时间和长度。它利用现有的 text_field，但将其包装起来，以便可以自定义值：

```
class SuperFormBuilder < ActionView::Helpers::FormBuilder
  include ApplicationHelper
  include FormHelper
  include ActionView::Helpers::TagHelper
  include ActionView::Helpers::FormTagHelper

  def length_field(label,*args)
    scale = 'medium'
    args.each do |v|
      if v.has_key?(:scale)
        scale = v[:scale]
        v.delete(:scale)
      end
    end
  value = length_conversion(@object.send(label.to_sym),scale)
  options = (args.length > 0) ? args.pop : {}
  return has_error(label, text_field_tag(field_name(label),value,*args) + ' ' +  length_unit(scale))
end

private
def field_name(label)
  return @object_name + "[#{label}]"
end

def has_error(label, output)
  return    "<div class='fieldWithErrors'>#{output}</div>" if @object.errors[label]
  return output
end 
```

它是这样使用的：

```
<%= form_for( @section, {:action => 'save', :id => @section.id}, :builder => SuperFormBuilder) do |sf| %> 
   <%= sf.length_field :feed_size_min_w, :size => 3, :scale => 'small'  %>
<% end %> 
```

最终结果是基于他们对系统（公制、英制）和比例 IE small = 英寸或毫米的选择的适当单位的值。

我基本上从现有的表单构建器中复制了 text_field 方法，它使用了 text_field_tag 本身。

有两个陷阱：1）知道对象字段的名称以及如何访问对象以获取要格式化的值。2）获取正确的名称，以便在提交表单时它是正确参数哈希的一部分。

表单构建器被赋予一个类变量@object。您可以使用 .send 方法获取字段的值。在我的情况下，我将标签 :feed_size_min_w 发送到 @object 并取回它的长度。然后我将其转换为我想要的格式，并将其提供给 text_field_tag。

字段的名称是让它最终出现在 params 哈希中的关键，在我的例子中是 params[:sections] 之一。我制作了一个名为 field_name 的小辅助函数来处理这个问题。

最后，如果该标签上有错误，has_error 会将字段包装在错误 div 中。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2021-09-09T23:43:51.960

我需要在某些指定的文本字段上使用“更好”的格式，通过将其添加到我的初始化程序来解决它。似乎在 Rails ~= 5.2 上工作得很好，而且应该很容易定制。

```
class ActionView::Helpers::Tags::TextField
  private

  def value_before_type_cast  # override method in ActionView::Helpers::Tags::Base
    v = super

    # format as you like, when you like
    if @options.delete(:nice_decimal)
      v = v.to_s.gsub('.', ',') if v.is_a?(BigDecimal)
    end

    v
  end
end 
```

表格中的用法`f`

```
<%= f.text_field :foo, nice_decimal: true %> 
```

# linux - 从命令行恢复/暂停能源之星 linux

> ID：591940
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T19:00:21.153
> 
>         
> 
> 标签：linux, acpi

我有一个到 linux 机器的 ssh 连接，该机器在一些非活动时间后休眠。

我想让它恢复，我该怎么做？（写入 /dev/mouse 以模拟鼠标移动并没有成功）

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T19:06:39.953

如果以太网适配器具有局域网唤醒 (WOL) 功能并且主板支持，则处于休眠状态的机器无法在不按下电源按钮或发送魔术包的情况下从睡眠中醒来。WOL 数据包只能在本地网络上生成，而不能从其他网络远程生成。

-亚当

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T19:13:22.077

除了亚当所说的，一些主板支持在触发中断时从各种状态中唤醒。

这里的关键是您将哪个状态称为休眠状态；您是在谈论硬件中的极低功耗模式，还是将核心内存写入磁盘并且机器完全关闭的软件休眠？如果是后者，WOL 是唯一的可能；如果是前者，那么您可以告诉您的主板注意来自各种来源的中断，并且您可以使用其他一些方法来触发唤醒。

一个很好的阅读起点[是 Wikipedia 上的 Wake-On-LAN 文章](http://en.wikipedia.org/wiki/Wake_On_Lan)。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2010-11-10T09:26:53.710

要完成 WOL，您需要做一些事情：

首先，检查您要唤醒的机器的 BIOS，看它是否支持 WOL。如果是这样，请确保它已打开。

然后得到一个可以发送WO​​L数据包的程序：

*   在 linux 中：sudo apt-get install wakeonlan

*   对于 Windows，只需使用 google 找到一个即可下载。可能有 100 种不同的应用程序可以做到这一点，我不使用 Windows，所以我没有一个可以参考。

如果您想从本地网络外部接收 WOL 数据包。将您的路由器配置为将端口 9 转发到 255.255.255.255（IP 广播到所有地址）。

有关 WOL 协议的一些真正有用的信息以及可以在 Wireshark 中加载的示例捕获文件，[请参阅这篇文章](http://wiki.wireshark.org/WakeOnLAN)。

# drop-down-menu - Custom dropdownlist with items autopopulated

> ID：591945
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-26T19:01:07.690
> 
>         
> 
> 标签：drop-down-menu, asp.net-2.0, custom-server-controls

I have the need for a dropdownlist with the U.S. states in it.  I could need this dropdownlist on various pages.  Instead of always having to create a listitem for each state, I want a simple control.  I don't want a UserControl - I want to extend the existing dropdownlist control.  I know I have done this before at a previous employer, but for the life of me I can't remember how to do it!  

Can't I just do something like this for each state?  If so, where?

```
MyBase.Items.Add(New ListItem("Illinois","IL")) 
```

Any ideas out there?

Thanks

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T19:04:55.513

All you have to do is create a new class and inherit from the appropriate control:

```
/// <summary>
/// </summary>
[DefaultProperty("DataTable"),
     ToolboxData("<{0}:ExtendedDropDownlist runat=server></{0}:ExtendedDropDownlist>")]
public class ExtendedDropDownList : DropDownList

    /// <summary>
    /// Render this control to the output 
    /// parameter specified.
    /// </summary>
    /// <param name="output"> The HTML writer to 
    /// write out to </param>
    protected override void Render(HtmlTextWriter output)
    {
        //output.Write(Text);
        base.Render(output);
    } 
```

In the constructor just add the appropriate listbox items like you have. 

You may need to put it in a different project and reference the dll.  I think I remember something about that, but it's been a while since I have had to do it.

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T19:11:05.920

Extend DropDownList control and override OnLoad event and add your items like that : 

```
protected override void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack)
    {
        this.Items.Add(new ListItem("Illinois","IL"));
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T19:21:28.373

```
<ToolboxData("<{0}:StateDropDownList runat=server></{0}:StateDropDownList>")> _
Public Class StateDropDownList
    Inherits DropDownList

    Protected Overrides Sub RenderContents(ByVal output As HtmlTextWriter)
        output.Write(Text)
    End Sub

    Protected Overrides Sub RenderChildren(ByVal writer As System.Web.UI.HtmlTextWriter)
        MyBase.RenderChildren(writer)
    End Sub

    Private Sub LoadStates()
        MyBase.Items.Add(New ListItem("Alabama", "AL"))
        'Additional states removed for size
        MyBase.Items.Add(New ListItem("Wyoming", "WY"))
    End Sub

    Public Sub New()
        'tried does not work
        ' LoadStates()
    End Sub

    Private Sub StateDropDownList_Init(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Init
        'tried does not work
        ' LoadStates()
    End Sub

    Private Sub StateDropDownList_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        'tried does not work
        'If Not Page.IsPostBack Then
        '    LoadStates()
        'End If
    End Sub

    Protected Overrides Sub Render(ByVal writer As System.Web.UI.HtmlTextWriter)
        MyBase.Render(writer)
    End Sub
End Class 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T19:31:58.317

```
public class DropDownListStates : System.Web.UI.WebControls.DropDownList
{
    protected override void CreateChildControls()
    {
        if (Items.Count > 0) return;

        Items.Add(new System.Web.UI.WebControls.ListItem("AL"));

        // other states here...

        Items.Add(new System.Web.UI.WebControls.ListItem("WY"));

    }
} 
```

# javascript - iPhone Webkit jQuery 奇怪：无法更新内容

> ID：591949
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T19:02:42.617
> 
>         
> 
> 标签：javascript, jquery, iphone, webkit

使用 jQuery 和我的 WebViewController 在 iPhone 上遇到最奇怪的问题。

我有一个 div 来添加内容：

```
<div id="thumbnails">
  Here are your thumbnails:
  <div id="mythumbs"></div>
</div> 
```

代码如下所示：

```
for (var i = 0; i < thumbs.length; i++) {
  var item = thumbs[i];
  $('<img class="imgthumb" />').data('url', item.Url).attr({
    "src": item.Thumbnail.Url,
  }).appendTo($('#mythumbs'));
}; 
```

效果很好。

然后我切换到其他 div ( `$('#thumbnails').hide(); $('#someotherdiv').show()`)，继续我的业务，​​并最终切换回缩略图 div。

在这一点上，我似乎无法再使用 jQuery 向该 div 附加任何内容。我可以删除就好了，但附加不再有效。

完全相同的代码在 iPhone 之外的 Firefox 和 Safari 上运行良好，但在嵌入的 WebKit 中运行失败。

如果我直接使用 JavaScript 修改 DOM，它可以工作，但如果我使用 jQuery，它会失败：

```
var x = document.createTextNode('THE FIRST THING');
document.getElementById('thumbspage').appendChild(x);
$('#thumbspage').append('-- THE SECOND THING'); 
```

“第一件事”出现，但“第二件事”没有。

有任何想法吗？这件事快把我逼疯了。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-03-06T19:45:09.530

终于找到了解决办法：

我正在使用 window.location 调用我的目标 c 函数。事实证明，如果我在对 window.location 的调用周围添加了一个 setTimeout ，一切都会重新开始工作。我猜调用 window.location 会立即调用 Objective-C 代码，中断 javascript 线程，让事情处于糟糕的状态。通过添加 setTimeout，它允许 javascript 线程在跳转到 Objective-C 代码之前完成。或类似的东西。

# .net - .NET Streams 是否节省内存？

> ID：591951
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-26T19:03:18.043
> 
>         
> 
> 标签：.net, memory, stream

例子：  

1.  如果我读取一个文件并通过 .NET Streams 将其复制到另一个文件中，文件的总大小会随时占用内存吗？还是字节一使用就被丢弃？

2.  如果天真的方法不能节省内存，缓冲流会这样做吗？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-02-26T19:08:30.620

如果您流式传输复制，即读取缓冲区、写入缓冲区、读取缓冲区、写入缓冲区等，直到数据用完，它只需要与缓冲区大小一样多的内存。我希望 File.Copy 能够做到这一点（诚然，在本机 Windows 代码中）。

如果您想自己做，请使用以下内容：

```
public void CopyData(Stream input, Stream output)
{
    byte[] buffer = new byte[32 * 1024];
    int read;
    while ((read = input.Read(buffer, 0, buffer.Length)) > 0)
    {
        output.Write(buffer, 0, read);
    }
} 
```

无论流多大，这只需要 32K。

编辑：正如评论中所指出的，流也可能有自己的缓冲区，但关键是您仍然可以传输一个非常大的文件而不会耗尽内存。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-26T19:10:21.270

如果你调用类似`ReadToEnd()`then yes 的方法，文件的内容将被加载到内存中。您猜对了，使用缓冲区是确保在任何给定时间仅将文件数据的一部分加载到内存中的适当方法。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T19:13:35.383

不，整个文件不会加载到内存中。

内存占用将取决于您用于读取和写入的缓冲区的大小，以及流维护的任何内部缓冲区。

FileStream 类使用一个内部缓冲区，其大小可以在构造函数重载中指定，默认为 0x1000 字节（可能取决于实现 - 该值是通过使用 Lutz Reflector 检查 FileStream 类获得的）。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-26T19:20:48.377

这真的取决于你的方法。如果您使用流作为临时端点`ReadToEnd()`，您可以将整个文件加载到内存中。相反，如果您正在缓冲，则不会使用超过缓冲区大小的一点开销。

# jquery - jQuery BlockUI 与 jqModal

> ID：591965
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-26T19:05:16.510
> 
>         
> 
> 标签：jquery, asp.net-mvc, blockui

我需要一个模式窗口，告诉用户等到我在服务器上完成一些工作。看起来[BlockUI](http://malsup.com/jquery/block/)和[jqModal](http://dev.iceburg.net/jquery/jqModal/)都可以做到这一点。

你有任何经验吗？优点和缺点？我正在使用 ASP.NET MVC。  

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-02-27T05:16:01.597

我使用 jqModal 和 BlockUI 进行了概念模式对话框的验证，我可以毫无疑问地说 BlockUI 是它们中“最薄的”。它允许对 jQuery 可以选择的任何内容进行更简单的阻塞访问，并且您只需将模态 DIV 的“消息”参数传递给它。它将自动设置 display:block 并将其设置在模态覆盖的顶部。

除了标准模式对话框，如果 $.ajax 调用时间超过 250 毫秒，我还使用它在我的 ajax 接口上设置“请稍候”对话框。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T22:43:46.843

我已经使用了很多 jqModal 并且非常喜欢它。它非常易于实现和灵活，但它的主要用途是模态对话框。

我没有使用过 BlockUI，尽管它似乎提供了一些不同的功能。它不仅可以在模式窗口中显示内容，还可以阻止用户访问整个 UI 或其中的一部分。

另一种选择是[jQuery UI 对话框](http://docs.jquery.com/UI/API/1.7/Dialog)，它更通用，可用于构建。我在一个应用程序中使用它，虽然它没有 jqModal 的开箱即用功能，但我认为如果我想构建一个与之集成的自定义插件，它会非常有用。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-06-22T19:25:14.467

我正在使用 BlockUI 并且喜欢它，但明智的说法是，众所周知，它在 linux 中的 Firefox 上非常慢。它将 CPU 峰值提高到 100%

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2011-06-22T18:38:39.850

我同时使用 & 。

对于简单的静态模态，@Peter J 的回答是正确的 - BlockUI 很棒而且非常轻量级。您可以将隐藏的 div 作为消息传递，它将显示为模态对话框，可以通过 jQuery 绑定等进行交互。它不提供通过 ajax 检索消息而无需手动编码的方法（其中与 BlockUI 的简单完美背道而驰——在等待 ajax 操作完成时显示块消息）。  

对于动态模态，jqModal 非常棒，因为它可以通过 ajax 调用检索模态内容。它还可以为您处理触发元素（按钮、链接等），控制显示/隐藏本身，但也可以让您以任何您喜欢的方式对其进行自定义。

为了变得更复杂 - 我什至同时使用两者来通过 jqModal 显示一个 ajax 提供的对话框，然后在提交时通过 BlockUI 阻止它以显示自定义消息。（需要注意的一点：注意 jqModal 的默认 z-index 低于 BlockUI 的默认值，因此将它们一起使用需要您将 BlockUI basez 选项设置为高于 jqModal 的默认值 3000。）

# jquery - 从 SQL Server Reporting Services 页面获取字段

> ID：591967
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T19:05:49.333
> 
>         
> 
> 标签：jquery, reporting-services

我正在尝试从 SQL Server Reporting Services 使用 JavaScript 创建的页面访问下拉框。我通常只是 getElementById 但下拉元素的 id 和 name 属性是由服务器生成的，所以我不想用它来引用元素。即如果页面的设计在未来发生变化，它会将元素命名为 _ct105 或 _ct107

我在页面上指定的唯一内容是标签“营业期间”。我正在考虑使用 xpath 来引用该跨度，然后使用下一个选择元素的相对位置，但我不知道该怎么做。

理想情况下，我可以指定 Select 元素本身的 ID 或名称（或任何其他属性）。这可能吗？

我将在页面上使用 jQuery，所以如果有人能想出一个好的方法来找到它，那就太好了。

```
<tr IsParameterRow="true">
<td class="ParamLabelCell">
    <span>Business Period</span>
</td>
<td class="ParamEntryCell" style="padding-right:0px;">
    <div>
        <select name="ctl140$ctl00$ctl03$ddValue" id="ctl140_ctl00_ctl03_ddValue"> <!-- This is the select box I want -->
            <option value="0">&lt;Select&nbsp;a&nbsp;Value&gt;</option>
            <option value="1">Customer</option>
            <option value="2">Previous&nbsp;Week</option>
            <option value="3">Current&nbsp;Week</option>
            <option value="4">Next&nbsp;Week</option>
        </select>
    </div>
</td> 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T19:40:39.297

如果您已经在使用 jQuery，那么 XPath 将是矫枉过正。我在 jQuery 中看到了几种不同的方法来实现它。jQuery 使用 CSS 选择器，这就是它们的工作方式：

```
/* this attaches to selectboxes, which are in a div,
 * which is in a [TD] with class ParamEntryCell
 */
 $("td.ParamEntryCell div select");
 /* selects a selectbox whose id attribute starts with "ctl"
  * in an element with class ParamEntryCell 
  */
 $(".ParamEntryCell select[name^='ctl']")
 $("td.ParamEntryCell div select");
 /* selects a selectbox whose id attribute starts with "ctl"
  * in an element with class ParamEntryCell 
  */
 $(".ParamEntryCell select[id^='ctl']") 
```

然后要使用其中之一，您只需使用 jQuery 的内置方法：

```
$(".ParamEntryCell select[id^='ctl']").change(function(){
    var val = $(this).val();
    alert(val);
}) 
```

# objective-c - How can I call a method in Objective-C?

> ID：591969
> 
>         
> 
> 赞同：57
> 
>         
> 
> 时间：2009-02-26T19:05:55.027
> 
>         
> 
> 标签：objective-c

I am trying to build an iPhone  app. I created a

method like this:

```
- (void)score {
    // some code
} 
```

and I have tried to call it in an other method like this:

```
- (void)score2 {
    @selector(score);
} 
```

But it does not work. So, how do I call a method correctly?

* * *

## 回答 #1

> 赞同：95
> 
>             
> 
> 时间：2009-02-26T19:10:31.397

To send an objective-c message in this instance you would do

```
[self score]; 
```

I suggest you read the Objective-C programming guide
[Objective-C Programming Guide](https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/Introduction/Introduction.html)

* * *

## 回答 #2

> 赞同：31
> 
>             
> 
> 时间：2009-02-26T19:09:41.193

I suggest you read [The Objective-C Programming Language](https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/Introduction/Introduction.html). The part about messaging is specifically what you want here, but the whole thing will help you get started. After that, maybe try doing a few tutorials to get a feel for it before you jump into making your own apps.

* * *

## 回答 #3

> 赞同：24
> 
>             
> 
> 时间：2009-02-26T19:08:36.563

I think what you're trying to do is:

```
-(void) score2 {
    [self score];
} 
```

The `[object message]` syntax is the normal way to call a method in objective-c. I think the `@selector` syntax is used when the method to be called needs to be determined at run-time, but I don't know [objective-c](/questions/tagged/objective-c "show questions tagged 'objective-c'") well enough to give you more information on that.

* * *

## 回答 #4

> 赞同：24
> 
>             
> 
> 时间：2014-07-05T12:25:19.207

调用方法是这样的

```
[className methodName] 
```

但是，如果您想在同一个类中调用该方法，则可以使用 self

```
[self methodName] 
```

以上都是因为您的方法没有采用任何参数

但是，如果您的方法需要参数，您将需要这样做

```
[self methodName:Parameter] 
```

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2012-06-18T04:54:55.180

用这个：

```
[self score]; you don't need @sel for calling directly 
```

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2019-12-10T09:19:46.230

语法是客观的 c 是

> returnObj = [对象函数名称：参数];

其中 object 是具有您正在调用的方法的对象。如果你从同一个对象调用它，你将使用'self'。本教程可能会帮助您学习 Obj-C。

在你的情况下，它只是

> [自我评分]；

如果你想传递一个参数，那么它就是这样

```
- (void)score(int x) {
    // some code
} 
```

我试图用这样的其他方法调用它：

```
- (void)score2 {
    [self score:x];
} 
```

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2014-12-07T03:45:32.687

```
[self score]; instead of @selector(score) 
```

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2019-12-10T11:26:37.400

```
use this,
[self score]; 
instead of @selector(score). 
```

# .net - DSLs and Form Creation

> ID：591981
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T19:08:51.213
> 
>         
> 
> 标签：.net, asp.net, forms, dsl, dsl-tools

I'm currently working on the requirements/scoping of a project now that could involve:

1) 5 to 6 forms

2) with 250 to 300 questions/fields accross the forms

3) 2 to 3 workflows  

Are there any .NET or cross-platform tools that will allow me to put the responsibility of developing the forms back onto a non-technical Business Analyst? Are there any good DSLs for this? I think this person would *NOT* be sucessful at trying to use InfoPath for this.

I guess I'm looking for a DSL that I could put through an engine at runtime to display the CRUD screens. I'd rather not use my own XML or DSL if there is something like this already out there.

I'm thinking I would display the forms as part of an ASP.NET WebForm or ASP.NET MVC application.

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-03-15T23:14:03.397

我对您的 DSL 的预感是，任何强大到足以解决您确定的任务的语言对于您的非技术业务分析师来说都太复杂了。

也就是说，对于一个高度受限的问题域（正如我认为您正在研究的那样），应该可以提出一个相对有用的 DSL。

事实上，这是 Ruby On Rails 的起始前提。

我目前的偏见是内部 DSL/[语言专业化](http://www.spinellis.gr/pubs/jrnl/2000-JSS-DSLPatterns/html/dslpat.html)，即：作为另一种语言的一部分嵌入的 DSL。这可能意味着在您的 .net 应用程序中嵌入 IronRuby 或 IronPython。

虽然这确实使您摆脱了为您自己的自定义语言编写编译器/解释器的问题，但这确实意味着在嵌入式语言中编写 DSL 的一些前期工作。

从经验来看，与内置文档、文档编写支持以及所有其他免费出现的语言功能相比，这只是小菜一碟。

# sql-server - 如何在 SQL Server 中格式化 XML

> ID：591984
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-26T19:09:56.437
> 
>         
> 
> 标签：sql-server, xml, formatting

我正在从 SQL Server 中提取一些数据。其中一列是一个 ntext 列，其中有一个 XML 块。当我提取它时，它看起来真的很难看。有没有办法在 SQL Server 2005 存储过程中格式化 XML？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-26T19:15:05.520

SQL Server 中没有“使这个漂亮”功能。但是，您可以在 .NET 中执行此操作，因此一种选择是设置一个 CLR 函数，使 XML 的输出变得漂亮。由于这是 NText，您必须对任何不是 XML 的字符串进行异常处理，否则您会崩溃。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T19:13:22.030

不容易，但如果你用格式化插入它，那么当你提取它时 sqlserver 将保持格式化。在 SQL Server 中进行文本格式化非常困难，因为可用的功能非常有限。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2019-05-16T05:03:15.393

有同样的问题，只是写了我自己的函数：

```
CREATE FUNCTION LocalCustom.Pretty_XML(@uglyXML VARCHAR(MAX))
RETURNS VARCHAR(MAX) 
AS
BEGIN
  DECLARE @len AS INT = LEN(@uglyXML)
        , @prettyXML AS VARCHAR(MAX) = ''
        , @indent AS INT = 0
        , @tab AS CHAR(1) = CHAR(9)
        , @lf AS CHAR(1) = CHAR(10)
        , @currElement AS VARCHAR(MAX) = NULL
        , @nextElement AS VARCHAR(MAX);

  WHILE @uglyXML + ISNULL(@currElement,'') <> ''
  BEGIN
     IF @currElement IS NULL
     BEGIN
        SET @currElement = LocalCustom.GetColumn(1,'>',@uglyXML);
        SET @uglyXML = SUBSTRING(@uglyXML,LEN(@currElement)+2,@len);
     END;
     SET @nextElement = LocalCustom.GetColumn(1,'>',@uglyXML);
     IF @currElement LIKE '</%'
     BEGIN
        SET @indent = @indent - 1;
        SET @prettyXML = @prettyXML + REPLICATE(@tab,@indent) +  @currElement + '>' + CASE @indent WHEN 0 THEN '' ELSE @lf END;
        SET @currElement = @nextElement;
        SET @uglyXML = SUBSTRING(@uglyXML,LEN(@nextElement)+2,@len);
     END
     ELSE
        IF @currElement LIKE '<% /'
        BEGIN
           SET @prettyXML = @prettyXML + REPLICATE(@tab,@indent) +  @currElement + '>' + CASE @indent WHEN 0 THEN '' ELSE @lf END;
           SET @currElement = @nextElement;
           SET @uglyXML = SUBSTRING(@uglyXML,LEN(@nextElement)+2,@len);
        END
        ELSE
           IF @nextElement LIKE '%</' + SUBSTRING(@currElement,2,@len) 
           BEGIN
              SET @prettyXML = @prettyXML + REPLICATE(@tab,@indent) +  @currElement + '>' + @nextElement + '>' + @lf;
              SET @uglyXML = SUBSTRING(@uglyXML,LEN(@nextElement)+2,@len);
              SET @currElement = NULL;
           END
           ELSE
              IF @nextElement NOT LIKE '</%'
              BEGIN
                 SET @prettyXML = @prettyXML + REPLICATE(@tab,@indent) +  @currElement + '>' + @lf;
                 SET @indent = @indent + 1;
                 SET @currElement = @nextElement;
                 SET @uglyXML = SUBSTRING(@uglyXML,LEN(@nextElement)+2,@len);
              END;
  END;
  RETURN @prettyXML;
END
GO 
```

上面的函数使用我们这里现有的一个：

```
CREATE FUNCTION [LocalCustom].[GetColumn]
(@ColumnNumber INT,
 @Delimiter VARCHAR(32),
 @Record VARCHAR(2000)) 
RETURNS VARCHAR(500)
AS
BEGIN
  DECLARE @ReturnValue VARCHAR(500)
  DECLARE @StartPosition INT
  DECLARE @EndPosition INT
  DECLARE @Counter INT
  -- Find position of first opening delimeter
  IF @ColumnNumber = 1
      SET @StartPosition = 1 - DATALENGTH(@Delimiter)
  ELSE
      BEGIN
      SET @StartPosition = 1
      SET @Counter = 1
      WHILE @StartPosition < LEN(@Record) AND @StartPosition <> 0 AND @Counter < @ColumnNumber 
          BEGIN
          SET @StartPosition = CHARINDEX(@Delimiter,@Record,@StartPosition+1)
          SET @Counter = @Counter + 1
          END
      IF @StartPosition = 0
          SET @StartPosition = LEN(@Record) + 1
      END
  -- Find position of closing delimeter
  SET @EndPosition = CHARINDEX(@Delimiter,@Record,@StartPosition+1)
  IF @EndPosition = 0
      SET @EndPosition = LEN(@Record) + 1
  -- If Valid start and end positions get column
  IF @EndPosition > @StartPosition AND @EndPosition <= LEN(@Record) + 1
      IF @EndPosition - @StartPosition - 1 = 0
          SET @ReturnValue = ''
      ELSE
          SET @ReturnValue = SUBSTRING(@Record, @StartPosition + DATALENGTH(@Delimiter), @EndPosition - @StartPosition - DATALENGTH(@Delimiter))
  ELSE
      SET @ReturnValue = NULL
  -- Strip Carriage Return, Line Feed character
  IF @ReturnValue IS NOT NULL
      BEGIN
      SET @ReturnValue = REPLACE(@ReturnValue,CHAR(10),'')
      SET @ReturnValue = REPLACE(@ReturnValue,CHAR(13),'')
      END
  -- Remove double quotes if used as column delimiter
  IF LEFT(@ReturnValue,1) = '"' AND RIGHT(@ReturnValue,1) = '"'
     BEGIN
     SET @ReturnValue = SUBSTRING(@ReturnValue,2,LEN(@ReturnValue)-2)
     SET @ReturnValue = REPLACE(@ReturnValue,'""','"')
     END
  RETURN @ReturnValue
END
GO 
```

# jquery - The content is added and showed in the browser but jQuery can't see it

> ID：591993
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-26T19:12:41.717
> 
>         
> 
> 标签：jquery, ajax

I have a [WebMethod] that load an html snippet and add some content to it. That [WebMethod] is then injected into a page using $.post() and .html().

A piece of snippet:

```
<p id="name"></p> 
```

The [WebMethod] add content to it:

```
<p id="name">Joe</p> 
```

The snippet also contains a JavaScript code, like:

```
alert($("#id").text()) 
```

The problem: $("#id").text() return nothing (like in the snippet) but the content ("Joe") is showed correctly in the browser. Where is the problem?

Thanks and sorry for my EngRish.

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-26T19:14:08.687

Your element does not have an id of "id", it has an id of "name".  Change your selector to this...

```
$("#name") 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-26T19:19:00.970

你应该打电话`$("p#name")`而不是`$("#id");`

```
<p id="something"> </p>
$("p#something")...

<p class="something_else"></p>
$("p.something_else")... 
```

# javascript - 如何实现 gmail 风格的标签选择器？

> ID：591994
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-26T19:12:47.833
> 
>         
> 
> 标签：javascript, user-interface, gmail, label

实现（类似）Gmail 用于标记邮件的界面的最简单方法是什么？有没有任何 javascript 库有这样的小部件？

[http://img294.imageshack.us/img294/7097/36698396.png](http://img294.imageshack.us/img294/7097/36698396.png)

行为：

1.  单击下拉列表中的标签以立即标记消息。

2.  检查多个标签，然后“应用”以添加多个标签（不确定我是否喜欢“应用”要求......）

3.  在框中键入以缩小标签列表的范围。如果将其缩小到 1，则按 Enter 会应用该标签。

4.  使用快捷键“L”触发小部件。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-27T01:59:08.760

Horace - 你想要一些非常复杂的东西，你应该考虑到即使有很多预制组件，也需要一些时间才能让这样的东西工作（更不用说 - 漂亮:-)）。

无论如何，预制组件很好，但我经常喜欢自己破解它，像自由风格一样。所以这是我为你准备的东西：[我的简单标签演示](http://geek.co.il/articles/labels/)（*警告 - 我只在 Firefox 3 上测试过这个，我很确定它不会在其他任何东西上工作*）。

它远非漂亮，但代码非常简单，应该很容易理解。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-27T00:29:05.967

我怀疑是否有一个预先准备好的解决方案可以*完全*满足您的需求，但是您应该能够自己将一些东西与一个体面的 JavaScript 库组合在一起。像[Ext JS](http://extjs.com/)这样的东西将是理想的选择。

一些可能感兴趣的 API 页面：

*   [`Ext.Panel`](http://extjs.com/deploy/dev/docs/?class=Ext.Panel)

*   [`Ext.form.TextArea`](http://extjs.com/deploy/dev/docs/?class=Ext.form.TextArea)

*   [`Ext.menu.CheckItem`](http://extjs.com/deploy/dev/docs/?class=Ext.menu.CheckItem)

*   [`Ext.KeyNav`](http://extjs.com/deploy/dev/docs/?class=Ext.KeyNav)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-09-23T02:28:25.610

我正在寻找一个类似的标签实现，并偶然发现了这个线程。

我不能添加到问题的 JS 部分，但就标签的“漂亮”而言，您可能会发现以下文章/代码很有用：

[CSS 类 Gmail 标签](http://tympanus.net/codrops/2009/08/29/css-gmail-like-labels/)

祝一切顺利！*** 
```*`*****