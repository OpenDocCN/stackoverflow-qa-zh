# StackOverflow 问答 12451000-12451999

# asp.net - 改进我的图像调整功能以获得更好的图像质量...循环减少？

> ID：12451002
> 
> 赞同：0
> 
> 时间：2012-09-16T21:45:54.027
> 
> 标签：asp.net, image-processing, graphics, bitmap, image-resizing

前段时间我试图为我的网站后端创建一个图像上传工具。我设法做到了这一点，但在较小的图像上我的图像质量仍然很差。

我需要创建 4 个图像：

1.  最大缩放图像 1800 x 1800 像素
2.  显示图像最大 180 x 275 像素
3.  搜索图像最大 120 x 100 像素
4.  小缩略图 50 x 50 像素（最大）

我通常在上传之前使用Photoshop或其他工具手动调整大小和图像到1800 x 1800，然后使用下面的代码上传和调整大小（图像都是jpgs）

变量是：

1.  FileName = 最初上传正常
2.  NewFileName = 将调整大小的图像保存为的文件名
3.  maxWidth / maxHeight - 不言自明
4.  uploadDir = 要保存到的目录
5.  分辨率 = 质量 jpg 分辨率 0-100，我在这些示例中使用 80

    ```
     Public Shared Sub ResizeImages(FileName, NewFileName, maxWidth, maxHeight, uploadDir, resolution)
     Try
        Dim originalImg As System.Drawing.Image = System.Drawing.Image.FromFile(uploadDir & FileName)
        Dim aspectRatio As Double
        Dim newHeight As Integer
        Dim newWidth As Integer
       ' Calculate Size '
            If originalImg.Width > maxWidth Or originalImg.Height > maxHeight Then
                If originalImg.Width >= originalImg.Height Then ' image is wider than tall
                    newWidth = maxWidth
                    aspectRatio = originalImg.Width / maxWidth
                    newHeight = originalImg.Height / aspectRatio
                Else ' image is taller than wide
                    newHeight = maxHeight
                    aspectRatio = originalImg.Height / maxHeight
                    newWidth = originalImg.Width / aspectRatio
                End If
            Else ' if image is not larger than max then keep original size
                newWidth = originalImg.Width
                newHeight = originalImg.Height
            End If

            Dim newImg As New Bitmap(originalImg, CInt(newWidth), CInt(newHeight)) '' blank canvas
            Dim canvas As Graphics = Graphics.FromImage(newImg) 'graphics element

            '*** compress ***'
            Dim myEncoderParameters As EncoderParameters
            myEncoderParameters = New EncoderParameters(1)
            ' set quality level based on "resolution" variable
            Dim myEncoderParameter = New EncoderParameter(System.Drawing.Imaging.Encoder.Quality, CType(resolution, Int32))
            myEncoderParameters.Param(0) = myEncoderParameter

            canvas.CompositingQuality = System.Drawing.Drawing2D.CompositingQuality.HighQuality
            canvas.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic
            canvas.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighQuality

            canvas.DrawImage(newImg, New Rectangle(0, 0, newWidth, newHeight))
            newImg.Save(uploadDir & (NewFileName), getCodec("image/jpeg"), myEncoderParameters)

            '*** Close ***'
            canvas.Dispose()
            originalImg.Dispose()
            newImg.Dispose()
            '*** Nothing ***'
            canvas = Nothing
            newImg = Nothing
            originalImg = Nothing

        Catch ex As Exception
            HttpContext.Current.Response.Write(ex.ToString & " " & uploadDir & " " & FileName & " _ " & NewFileName)
        End Try

    End Sub 
    ```

为了实现所有四个图像，我将所需的大小作为列表传递，然后循环该列表，按预期文件大小的降序排列，因此，最大的在前，然后我将最近上传的图像作为`FileName`参数传递给函数这样每次，该功能都会收到一个较小的图像，所以不要像我从阅读各种帖子中意识到的那样尝试将 2000x2000px 图像调整为 50x50px，这样缩小会导致质量下降。

以这种方法运行循环后，我的小缩略图质量非常好，但我的中间图像仍然很差。

在这里，它们按尺寸降序排列：

[http://www.hartnollguitars.co.uk/Products2/0/0/0/9/6/57/1347831580.jpg](http://www.hartnollguitars.co.uk/Products2/0/0/0/9/6/57/1347831580.jpg) http://www.hartnollguitars.co.uk/Products2/0/0/0/9 /6/57/1347831580-dis.jpg [http://www.hartnollguitars.co.uk/Products2/0/0/0/9/6/57/1347831580-se.jpg](http://www.hartnollguitars.co.uk/Products2/0/0/0/9/6/57/1347831580-se.jpg) http://www.hartnollguitars.co .uk/Products2/0/0/0/9/6/57/1347831580-tb.jpg

如您所见，“搜索”和“显示”图像在吉他边缘周围仍然是块状的。

我究竟做错了什么？！

如果我的减少太多，我将如何运行内存中的逐渐减少。

我的意思是，让我印象深刻的是，上面的函数每次都将文件保存到磁盘，这必须占用一些时间，所以如果我要循环一个缩减函数，缩小图像的大小，小在内存中增加（例如每次 10%），然后在减少达到正确大小时将最终图像保存到磁盘。我不确定如何做到这一点。

我正在使用 ASP.NET 2.0 并且对它比较陌生，所以我并不完全了解我可以使用的所有方法。

任何代码示例都会有很大帮助！

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T22:05:04.337

您做错的是您正在使用`Bitmap`构造函数创建缩小的图像，然后将该图像绘制到自身上。构造`Bitmap`函数自然不能使用您`Graphics`稍后在对象中设置的质量设置来调整图像大小，因此质量会很差。

`Bitmap`相反，您应该使用仅采用大小的构造函数创建一个空白对象：

```
Dim newImg As New Bitmap(newWidth, newHeight) 
```

然后你应该在画布上绘制原始图像：

```
canvas.DrawImage(originalImg, New Rectangle(0, 0, newWidth, newHeight)) 
```

# c++ - 你能解释一下类的方法是如何被调用的吗？

> ID：12451003
> 
> 赞同：0
> 
> 时间：2012-09-16T21:46:04.650
> 
> 标签：c++, visual-c++

转换.h

```
class Base 
{
public:
    void foo();
};

class Derived: public Base 
{
public:
    void bar();
};

class A {};
class B 
{
public:
    void koko();
}; 
```

转化率

```
void Base::foo()
{
    cout<<"stamm";
}

void Derived::bar()
{
    cout<<"bar shoudn't work"<<endl;
}
void B::koko()
{
    cout<<"koko shoudn't work"<<endl;
} 
```

主文件

```
#include "conv.h"
#include <iostream>
int main()
{   
    Base * a = new Base;
    Derived * b = static_cast<Derived*>(a);
    b->bar();

    Derived * c = reinterpret_cast<Derived*>(a);
    c->bar();

    A* s1 = new A;
    B* s2 = reinterpret_cast<B*>(s1);
    s2->koko();
} 
```

输出：

```
bar shoudn't work
bar shoudn't work
koko shoudn't work 
```

尽管我创建了一个未派生的基类，但如何在运行时成功调用方法栏？它甚至适用于两种类型的转换（静态和重新解释转换）。

与上述相同的问题，但与不相关的类（A 和 B）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-16T21:49:35.223

未定义的行为可以做任何事情，包括看起来有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T21:58:10.250

它正在工作（阅读：“编译而不崩溃”）因为您从不`this`在名义上的“成员”函数中使用指针。例如，如果你试图打印出一个成员变量，你会得到你所期望的垃圾输出或崩溃——但这些函数现在并不依赖于它们应该属于的类中的任何内容。 `this`甚至可以`NULL`为他们所关心的一切。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T22:25:45.830

编译器知道`Derived`可以使用成员函数`foo()`，`bar()`并且知道在哪里可以找到它们。在你做了你的“技巧”之后，你有了指向`Derived`.

它们是类型的指针这一事实`Derived`——无论哪些*数据*与这些指针相关联——允许它们调用函数`foo()`并`kook()`与 Derived 相关联。

如前所述，如果您实际使用了指针处的数据（即读取或写入相对于`this`属于派生类的数据成员（在这种情况下您没有），那么您将访问没有的内存' t 属于你的对象。

# c# - EF5 中的外部枚举

> ID：12451011
> 
> 赞同：1
> 
> 时间：2012-09-16T21:46:55.973
> 
> 标签：c#, entity-framework

我是实体框架 5 的新手，我正在尝试枚举支持，但我遇到了一些问题。我使用 EF5，就像我使用以前的版本一样，这是创建数据库并从数据库生成模型并使用代码生成。因此，我将模型的代码生成属性更改为“默认”并删除了 .tt 文件。

我有一个包含多个 dll 的解决方案，其中一个有 DataModel (edmx)，另一个有一个名为“EnumGender”的枚举，它有 2 个值：男性和女性。

在数据库中，我有一个表用户，其中有一个名为“性别”（smallint）的字段，我试图使用“EnumGender”。

EnumGender 位于名为“Sample.Datatypes.Enums”的命名空间中，因此在 edmx 模型浏览器中，我试图添加一个 Enum。为此，我将“EnumGender”设置为名称，我没有添加任何值，我选中了“引用外部类型”复选框，并在文本框中输入了“Sample.Datatypes.Enums.EnumGender”。

问题是 EF 似乎在数据模型命名空间中创建了一个新的枚举，这是我不想要的，我想在“Sample.Datatypes.Enums”命名空间中使用 EnumGender。EF创建的新枚举也没有值......如果我输入数据模型cs文件（生成的代码），这就是它添加的内容：

```
/// <summary>
/// No Metadata Documentation available.
/// </summary>
[EdmEnumTypeAttribute(NamespaceName="SampleModel", Name="EnumGender")]
[DataContractAttribute()]
public enum EnumGender : short
{
} 
```

我不知道发生了什么......也许我不能使用来自外部 dll 的数据类型......但是对于我读到的关于枚举支持的内容，我应该能够做到这一点......

如果您能帮助我解决这个问题，我将不胜感激。

谢谢！胡安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T20:01:11.663

虽然不明显，但这是设计使然。EntityObject 模板（将模型的代码生成属性设置为“默认”时使用的模板）不使用外部类型，因为它要求类型具有某些属性（EdmEnumTypeAttribute 和 DataContractAttribute 用于枚举）。只有当类型本身也由模板生成时，才能可靠地满足此约束。

我强烈建议使用 DbContext 模板（默认添加的 .tt 文件），因为它使用 POCO 类型，因此支持外部类型。

但是，如果您的方案绝对需要您使用 EntityObject 模板，则有一种方法可以将其更改为使用外部枚举类型：

1.  确保您的枚举类型与生成的枚举类型具有相同的属性。（是的，这意味着它不能与使用 EnityObject 生成的不同实体模型共享）
2.  下载并安装 EF 5.x EntityObject T4 模板： http: [//visualstudiogallery.msdn.microsoft.com/1da40393-b5ec-404a-a000-6a7e6e911339](http://visualstudiogallery.msdn.microsoft.com/1da40393-b5ec-404a-a000-6a7e6e911339) 如果您正在处理 Web 项目，请改用此模板：[http:// /visualstudiogallery.msdn.microsoft.com/94b48556-fcf0-4b9b-8615-20f9066ae9ac](http://visualstudiogallery.msdn.microsoft.com/94b48556-fcf0-4b9b-8615-20f9066ae9ac)
3.  右键单击模型的实体设计器视图中的任意位置，然后选择“添加代码生成项...”
4.  添加“EF 5.x EntityObject 生成器”
5.  打开添加的 .tt 文件
6.  在它之前搜索`public string SourceCsdlPath{ get; set; }`并添加这一行：

```
private const string ExternalTypeNameAttributeName = @"http://schemas.microsoft.com/ado/2006/04/codegeneration:ExternalTypeName"; 
```

7\. 搜索`GetSourceSchemaTypes<EnumType>().OrderBy(c => c.Name)`并替换为：

```
GetSourceSchemaTypes<EnumType>()
    .Where(i => !i.MetadataProperties.Any(p => p.Name == ExternalTypeNameAttributeName))
    .OrderBy(c => c.Name) 
```

8\. 搜索`string typeName = MultiSchemaEscape(usage.EdmType, code);` 并替换为：

```
string typeName = code.Escape(usage.EdmType.MetadataProperties
                          .Where(p => p.Name == ExternalTypeNameAttributeName)
                          .Select(p => (string)p.Value)
                          .FirstOrDefault())
        ?? MultiSchemaEscape(usage.EdmType, code); 
```

# java - 不可变对象和不可修改的集合

> ID：12451013
> 
> 赞同：2
> 
> 时间：2012-09-16T21:47:09.937
> 
> 标签：java, design-patterns, collections, immutability

对于不可变对象，将包含的集合包装为不可修改的合适位置在哪里？我看到 3 个选项：

1.  在不可变对象的工厂中：

    ```
    public class ImmutableFactory {

        public Immutable build(){
           List<Integer> values = new ArrayList<Integer>();

            values.add(1);
            values.add(2);
            values.add(3);

            return new Immutable(Collections.unmodifiableList(values), "hello");
        }
    } 
    ```

2.  在不可变的构造函数中

    ```
    public class Immutable {

        private final List<Integer> values;
        private final String hello;

        public Immutable(List<Integer> values, String hello) {
            this.values = Collections.unmodifiableList(values);
           this.hello = hello;
        }

        public List<Integer> getValues() {
            return values;
        }

        public String getHello() {
            return hello;
        }
    } 
    ```

3.  在不可变的访问器中（如果适用）。

    ```
    public class Immutable {

        private final List<Integer> values;
        private final String hello;

        public Immutable(List<Integer> values, String hello) {
            this.values = values;
            this.hello = hello;
        }

        public List<Integer> getValues() {
            return Collections.unmodifiableList(values);
        }

        public String getHello() {
            return hello;
        }
    } 
    ```

还有其他选择吗？哪一个合适？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-16T21:53:40.067

我会说，如果您创建 Immutable 集合，那么您需要保护自己免受某人修改作为构造函数参数给出的列表，您应该保护性地复制它。

```
public Immutable(List<Integer> values, String hello) {
    this.values = Collections.unmodifiableList(new ArrayList<Integer>(values));
    this.hello = hello;
} 
```

我个人很久以前就切换到[Guava](http://code.google.com/p/guava-libraries/)集合，因为在那里你可以找到不可变集合的接口。你的构造函数看起来像这样：

```
public Immutable(ImmutableList<Integer> values, String hello) {
    this.values = values;
    this.hello = hello;
} 
```

您可以确定您收到的参数不会被任何人修改。

在不可变类中保留对不可变列表的引用通常是一个好主意，因为这样可以保证您不会错误地修改它。

在我看来，案例（1）只有当工厂方法是创建不可变集合的唯一方法时才有意义，即使这样，当有人重构这些类时它也可能会中断。除非有其他限制，否则最好创建自给自足的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T22:05:48.727

首先，您在所有地方的代码确实是不可变的**，但这**只是因为 an`Integer`是不可变的。
如果您有`private final List<SomeCustomClass> values;`，则`Collections.unmodifiableList(values);`不能保证`SomeCustomClass`列表中的个人是不可变的。*你*必须为此编写代码。
话虽如此，另一种选择是对列表进行**防御性深层复制**。这种方法还提供了不变性。

# c# - 调用 IPGlobalProperties.GetIPGlobalProperties() 时从 NSIS 脚本加载 DLL 时出错

> ID：12451014
> 
> 赞同：0
> 
> 时间：2012-09-16T21:47:09.827
> 
> 标签：c#, .net, nsis

我正在用 C# 构建一个简单的库。这个DLL有两个功能；一个获取计算机的 MAC 地址，另一个获取 CPU ID。DLL 的最终目的是从将调用这些函数的 NSIS 脚本中调用。

我在 NSIS 脚本中这样称呼它：

```
CLR::Call /NOUNLOAD "CypherLibrary.dll" "CpuMacGetter1.HwInfoRetriever" "GetMacAddress" 0 
```

执行返回以下错误：

> 调用 .NET DLL 方法时出错。调用的目标已引发异常。

它仅在我使用此类对象时发生：

> IPGlobalProperties computerProperties = IPGlobalProperties.GetIPGlobalProperties();

或者：

> ManagementClass mc = new ManagementClass("Win32_NetworkAdapterConfiguration");

例如，如果我返回当前时间，则没有问题。

更重要的是，只有当我使用 .NET 4 Framework 而不是使用 .NET 3.5（是的，我都安装了它们）时才会发生错误。如果这在最终用户的计算机中还不够，则相反。适用于 4 版本，但不适用于 3.5。

这种行为背后的任何线索？

非常感谢您提前！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-15T13:19:23.920

我知道这个问题已经快一年了，但我认为迟到总比没有好。:)

## 找到真正的问题

首先我们应该注意异常消息过于笼统。更详细的消息将阐明问题所在。为此，您必须修改 NSIS 插件本身。

在插件的[官方页面](http://nsis.sourceforge.net/Call_.NET_DLL_methods_plug-in)上，您可以[下载](http://nsis.sourceforge.net/mediawiki/images/9/9c/CLR.zip)其源代码。使用 Visual Studio 提取并打开它。（我使用的是 VS2010。）（可能升级后）尝试在调试和发布中构建解决方案。发布配置有一个构建后事件，它将输出 DLL 复制到您计算机上已安装的 NSIS 插件文件夹中。（如果您有一台 x64 机器，则必须修改此事件以将后 `(x86)`​​缀添加到路径的 Program Files 部分。）因此，每个 Release 版本都会更新您当前的 NSIS CLR 插件。

要生成详细的异常消息，请在`NSIS_CLS_Loader.cpp`（第 145 行）中找到主要的 catch 块，并将消息更改为 log`ex->ToString()`而不是`ex->Message`. 重建你的插件。（当然，您应该在开发阶段使用此过程，因为它将整个堆栈跟踪转储到您的显示器。）

在您还重建 NSIS 安装程序并尝试安装它之后，您将看到详细的异常消息，并且您可以找出潜在的问题是什么。我很确定这将是一条消息，告诉无法加载依赖程序集。这是这个 NSIS 插件的一个已知问题，作者自己在插件页面上声明了它：

> 另一个问题是，如果想从您的 .NET dll 中调用一个 .NET dll，您会发现安装程序找不到第二个 .NET dll。目前，补救措施是将您的安装程序包装在另一个安装程序中。此其他安装程序应将 .NET dll 放置在与安装程序将运行的目录相同的目录中。当安装程序运行时，现在可以找到 .NET dll。只会分发一个安装文件。

如果详细的异常消息对您来说不一样，您必须根据消息找出解决方案。但如果你有同样的情况，也许下面的解决方法可以解决问题。

## 解决方案

当您加载程序集并且此过程失败时，`AssemblyResolve`将引发一个事件。一个非常简单的解决方案是订阅此事件并在事件处理程序方法中加载依赖程序集。

因此，在第 51 行调用之前订阅过程中的`AssemblyResolve`事件。`CallCLR``LoadAssembly`

```
AppDomain::CurrentDomain->AssemblyResolve += gcnew ResolveEventHandler(&MyResolveEventHandler); 
```

创建事件处理程序和字典对象以防止多次加载相同的程序集。并发字典用于处理并发问题。

```
ref class Container {
public:
    static ConcurrentDictionary<String^, Assembly^>^ LoadedAssemblies = gcnew ConcurrentDictionary<String^, Assembly^>();
};    

static Assembly^ MyResolveEventHandler(Object^ sender, ResolveEventArgs^ args)
{
    AssemblyName^ assemblyName = gcnew AssemblyName(args->Name);
    String^ assemblyFileName = ".\\" + assemblyName->Name + ".dll";

    if (!Container::LoadedAssemblies->ContainsKey(assemblyFileName))
    {
        Assembly^ loadedAssembly = LoadAssembly(assemblyFileName);
        return Container::LoadedAssemblies->GetOrAdd(assemblyFileName, loadedAssembly);
    }

    return nullptr;
} 
```

不要忘记在`CallCLR`.

当然，必须修改您的 NSIS 安装程序以将依赖的程序集文件复制到该`$PLUGINSDIR`目录。

当我第一次遇到这个问题时，发现插件无法解决`log4net.dll`.

*特别感谢我的同事 Attila，他为我提供了此解决方案的指南。*

编辑 (03.10.2013.)

## 部署

构建修改后的插件后，您必须将其部署到 NSIS 的插件文件夹（通常`C:\Program Files (x86)\NSIS\Plugins`）并重新构建安装程序。它在我的机器上运行良好（也在我们的 Hudson 构建服务器上），但是当我将安装程序复制到目标 PC 时，它再次失败并显示错误消息`Could not load CLR.DLL`。

原来问题是我将源代码的解决方案转换为 Visual Studio 2012。此转换还将目标 C++ 平台设置为 Visual Studio 2012 (v110)。目标 PC 没有 C++ Redistributable for Visual Studio 2012，这是失败的原因。在搜索已安装的程序后，我在目标 PC 上找到了 Visual Sudio 2010 的 C++ 可再发行包，因此我不得不更改解决方案设置。（转到`Project Property pages\Configuration Properties\General`并设置`Platform Toolset`为您需要的任何版本，在我的情况下它是 Visual Studio 2010 (v100)）在重建插件并将其重新部署到 NSIS 插件文件夹后，我还重建了我的安装程序包，这个修改解决了我的问题。

# oracle - 每个 oracle 会话执行的查询

> ID：12451026
> 
> 赞同：0
> 
> 时间：2012-09-16T21:48:49.087
> 
> 标签：oracle

无论如何检查每个oracle会话执行的查询的查询统计信息（如执行，执行时间......）。（对于所有活动/非活动会话）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T14:23:21.833

最好的方法是查看系统视图`V$SESSION`。如果您看不到它，请让您的 DBA 访问它。

说明位于[http://docs.oracle.com/cd/E11882_01/server.112/e25513/dynviews_3016.htm#i1414383的 Oracle 参考中](http://docs.oracle.com/cd/E11882_01/server.112/e25513/dynviews_3016.htm#i1414383)

# python - Python 替换 Rubys grep？

> ID：12451027
> 
> 赞同：1
> 
> 时间：2012-09-16T21:48:52.620
> 
> 标签：python, ruby

```
abc=123
dabc=123
  abc=456
  dabc=789
    aabd=123 
```

从上面的文件中，我需要找到以 abc= 开头的行（空格无关紧要）

在红宝石中我会把它放在一个数组中并做

```
matches = input.grep(/^\s*abc=.*/).map(&:strip) 
```

我对 Python 完全是个菜鸟，甚至说我是一个新的 Python 开发人员也太过分了。

也许有更好的“Python方式”来做到这一点，甚至不需要 grepping ？

我需要解决问题的平台上可用的Python版本是2.6

那时还没有办法使用 Ruby

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-16T22:01:54.603

```
with open("myfile.txt") as myfile:
    matches = [line.rstrip() for line in myfile if line.lstrip().startswith("abc=")] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T22:02:31.563

在 Python 中，您通常会使用列表推导式，其`if`子句执行您使用 Ruby 完成的操作`grep`：

```
import sys, re
matches = [line.strip() for line in sys.stdin
           if re.match(r'^\s*abc=.*', line)] 
```

# xcode4 - 如何在 xcode 中创建密码字段

> ID：12451036
> 
> 赞同：22
> 
> 时间：2012-09-16T21:49:51.800
> 
> 标签：xcode4

我正在尝试制作一个 iPhone 应用程序，我将在其中让用户登录他们的帐户。为此，我想要用户的用户 ID 和密码。我的问题是如何创建一个密码字段，我输入的任何内容都将显示为“*”。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-09-16T21:53:15.090

听起来您正在`setSecureTextEntry`“ `UITextField`”对象上寻找“”。

[在“ ”协议](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UITextInputTraits_Protocol/Reference/UITextInputTraits.html#//apple_ref/occ/intfp/UITextInputTraits/secureTextEntry)中也称为[“`secureTextEntry`属性`UITextInputTraits`](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UITextInputTraits_Protocol/Reference/UITextInputTraits.html#//apple_ref/occ/intfp/UITextInputTraits/secureTextEntry)” 。

您可以通过在要设置密码`.secureTextEntry = YES`的“”对象上调用“”以编程方式调用它。`UITextField`

您也可以在 Interface Builder 中设置它（在文本字段属性检查器中查找“安全”复选框）。它看起来像这样：

![SecureAttributeForTextField](../Images/713368cd4e1f397c533640372f770c69.png)

在较新版本的 Xcode 中：

![较新 Xcode 中的 SecureAttributeForTextField](../Images/52d38ad43403e59c3f7bb6f63534ce77.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-12-27T21:22:10.433

# Xcode 12.2+ 的更新

我的观点是属性的编程声明更容易来回切换。

在 Swift 5 中以编程方式：

```
myPasswordTextField.isSecureTextEntry = true 
```

# ios - AVAudioPlayer 在文件结束前停止

> ID：12451048
> 
> 赞同：0
> 
> 时间：2012-09-16T21:52:02.327
> 
> 标签：ios, cocoa-touch, avaudioplayer

我有一个几乎可以工作的功能。根据您所在的页面播放不同的音频文件。问题是，一些音频文件突然结束。例如，当音频文件在“case 1”播放到结尾时，在“case 2”播放到大约 90%。

```
- (void)playAudio
{
    NSURL *audioURL;
    [voiceAudio release];

    switch (pageNumber)
    {
        case 1:
            audioURL = [[NSURL alloc] initFileURLWithPath:[[NSBundle mainBundle] pathForResource:@"file1" ofType:@"aac"]];
            voiceAudio = [[AVAudioPlayer alloc]
                                    initWithContentsOfURL:audioURL error:nil];
            [audioURL release];
            voiceAudio.delegate = self;
            [voiceAudio play];
            break;

        case 2:
            audioURL = [[NSURL alloc] initFileURLWithPath:[[NSBundle mainBundle] pathForResource:@"file2" ofType:@"aac"]];
            voiceAudio = [[AVAudioPlayer alloc]
                                    initWithContentsOfURL:audioURL error:nil];
            [audioURL release];
            voiceAudio.delegate = self;
            [voiceAudio play];
            break;

        // And so on...
    }
} 
```

AAC 有几分钟的时间。也许有更好的方法来解决这个问题？AVAudioPlayer 可能有点时髦。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T00:37:06.630

编辑： AVAudioPlayer 对于我在 Adob​​e Soundbooth 中制作的 64kb 单声道 AAC 有点不可预测，但在将文件重新混合到 M4A 后似乎运行良好。我使用[MP4Box](http://www.videohelp.com/tools/mp4box)使用以下语法转换它们：“mp4box -add source.aac:mpeg4 -sbr -ipod target.m4a”（[信用](http://forum.doom9.org/showthread.php?p=1345004#post1345004)）

Reencoding to a higher bitrate (128kb) seemed to fix some, but not all, of the files as well. I didn't thoroughly test this before I discovered remuxing.

# batch-file - 前缀 PATH，现在 cmd 和 help 不是可操作的命令

> ID：12451052
> 
> 赞同：0
> 
> 时间：2012-09-16T21:52:51.913
> 
> 标签：batch-file, cmd

场景：我找到了很棒的 Console2 [http://sourceforge.net/projects/console/](http://sourceforge.net/projects/console/)并着手为其创建三个环境：Cygwin、原始 Windows 和 GnuWin32。前两个工作正常，但第三个非常困难。

我将此文件作为 cmdrc.bat 保存在我的用户目录中，并告诉控制台这是我的 GnuWin32 选项卡的外壳。

```
set PATH="C:\gnuwin32\bin;C:\gnuwin32\include\glibc;%PATH%"
echo %PATH%
cmd
help
ls 
```

通过打开命令提示符并粘贴该代码（因此窗口不会消失），我得到：

```
C:\Users\Chris>set PATH="C:\gnuwin32\bin;C:\gnuwin32\include\glibc;%PATH%"

C:\Users\Chris>echo %PATH%
"C:\gnuwin32\bin;C:\gnuwin32\include\glibc;[all the correct stuff that was there before]"

C:\Users\Chris>cmd
'cmd' is not recognized as an internal or external command,
operable program or batch file.

C:\Users\Chris>help
'help' is not recognized as an internal or external command,
operable program or batch file.

C:\Users\Chris>ls // GnuWin32 isn't available, either.
'ls' is not recognized as an internal or external command,
operable program or batch file. 
```

我的 中是否有无效的语法`set`，或者什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T22:13:29.730

从`PATH`定义中删除双引号。

```
set PATH=C:\gnuwin32\bin;C:\gnuwin32\include\glibc;%PATH% 
```

# django - Django bulk_create 忽略导致 IntegrityError 的行？

> ID：12451053
> 
> 赞同：58
> 
> 时间：2012-09-16T21:52:53.547
> 
> 标签：django, postgresql, bulk-load

我正在使用 bulk_create 将数千行或行加载到 postgresql 数据库中。不幸的是，有些行导致 IntegrityError 并停止了 bulk_create 进程。我想知道是否有办法告诉 django 忽略这些行并尽可能多地保存批处理？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2019-01-14T21:33:10.913

# 这现在可以在 Django 2.2 上实现

Django 2.2`ignore_conflicts`为该方法添加了一个新选项`bulk_create`，来自[文档](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.bulk_create)：

> 在支持它的数据库上（除 PostgreSQL < 9.5 和 Oracle 之外的所有数据库），将 ignore_conflicts 参数设置为 True 会告诉数据库忽略插入任何违反约束的行（例如重复唯一值）的失败。启用此参数将禁用在每个模型实例上设置主键（如果数据库通常支持它）。

例子：

```
Entry.objects.bulk_create([
    Entry(headline='This is a test'),
    Entry(headline='This is only a test'),
], ignore_conflicts=True) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-17T02:03:29.827

（注意：我不使用Django，所以可能有更合适的框架特定的答案）

Django 不可能通过简单地忽略`INSERT`失败来做到这一点，因为 PostgreSQL 在第一个错误时中止整个事务。

Django 需要以下方法之一：

1.  `INSERT`单独事务中的每一行并忽略错误（非常慢）；
2.  在每次插入之前创建一个[`SAVEPOINT`](http://www.postgresql.org/docs/current/static/sql-savepoint.html)（可能有缩放问题）；
3.  仅当行不存在时才使用过程或查询插入（复杂且缓慢）；或者
4.  将数据批量插入或（更好）[`COPY`](http://www.postgresql.org/docs/current/static/sql-copy.html)到`TEMPORARY`表中，然后将其合并到服务器端的主表中。

类似 upsert 的方法 (3) 似乎是个好主意，但是[upsert 和 insert-if-not-exists 出奇地复杂](http://www.depesz.com/2012/06/10/why-is-upsert-so-complicated/)。

就个人而言，我会采取（4）：我会批量插入到一个新的单独表中，可能是`UNLOGGED`or `TEMPORARY`，然后我会运行一些手动 SQL 来：

```
LOCK TABLE realtable IN EXCLUSIVE MODE;

INSERT INTO realtable 
SELECT * FROM temptable WHERE NOT EXISTS (
    SELECT 1 FROM realtable WHERE temptable.id = realtable.id
); 
```

[`LOCK TABLE ... IN EXCLUSIVE MODE`](http://www.postgresql.org/docs/current/static/explicit-locking.html)防止创建行的并发插入与上述语句完成的插入发生冲突并失败。它不会*阻止*并发`SELECT`s，只有`SELECT ... FOR UPDATE`、和`INSERT`，所以从表中读取正常进行。`UPDATE``DELETE`

如果您不能长时间阻止并发写入，则可以改为使用可写 CTE 将行范围从`temptable`into复制`realtable`，如果失败则重试每个块。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-06-02T16:46:42.967

一种不涉及手动 SQL 和临时表的快速而肮脏的解决方法是尝试批量插入数据。如果失败，请恢复为串行插入。

```
objs = [(Event), (Event), (Event)...]

try:
    Event.objects.bulk_create(objs)

except IntegrityError:
    for obj in objs:
        try:
            obj.save()
        except IntegrityError:
            continue 
```

如果您有很多错误，这可能不是那么有效（您将花费更多时间连续插入而不是批量插入），但我正在处理一个重复很少的高基数数据集，所以这解决了我的大部分问题问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-02T17:42:59.953

或者 5\. 分而治之

我没有对此进行彻底的测试或基准测试，但它对我来说表现相当不错。YMMV，具体取决于您希望在批量操作中遇到多少错误。

```
def psql_copy(records):
    count = len(records)
    if count < 1:
        return True
    try:
        pg.copy_bin_values(records)
        return True
    except IntegrityError:
        if count == 1:
            # found culprit!
            msg = "Integrity error copying record:\n%r"
            logger.error(msg % records[0], exc_info=True)
            return False
    finally:
        connection.commit()

    # There was an integrity error but we had more than one record.
    # Divide and conquer.
    mid = count / 2
    return psql_copy(records[:mid]) and psql_copy(records[mid:])
    # or just return False 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-11-10T09:13:15.273

即使在 Django 1.11 中也没有办法做到这一点。我找到了比使用 Raw SQL 更好的选择。它使用[djnago-query-builder](https://github.com/ambitioninc/django-query-builder)。它有一个[upsert](http://django-query-builder.readthedocs.io/en/latest/ref/query.html?highlight=upsert#querybuilder.query.Query.upsert)方法

```
from querybuilder.query import Query
q = Query().from_table(YourModel)
# replace with your real objects
rows = [YourModel() for i in range(10)] 
q.upsert(rows, ['unique_fld1', 'unique_fld2'], ['fld1_to_update', 'fld2_to_update']) 
```

注意：该库仅支持 postgreSQL

这是我用于批量插入的[要点，它支持忽略 IntegrityErrors 并返回插入的记录。](https://gist.github.com/jnoortheen/13dead7e6ba9ec7df98bb8ca8bd8dcd9)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-31T08:30:23.633

**pre Django 2.2 项目的迟到答案：**

我最近遇到了这种情况，我找到了用第二个列表数组检查唯一性的方法。

就我而言，该模型具有唯一的共同检查，并且由于批量创建的数组中包含重复数据，因此批量创建会引发完整性错误异常。

所以我决定在批量创建对象列表之外创建清单。这是示例代码；唯一键是*owner*和*brand*，在此示例中 owner 是一个用户对象实例，而 brand 是一个字符串实例：

```
create_list = []
create_list_check = []
for brand in brands:
    if (owner.id, brand) not in create_list_check:
        create_list_check.append((owner.id, brand))
        create_list.append(ProductBrand(owner=owner, name=brand))

if create_list:
    ProductBrand.objects.bulk_create(create_list) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-13T13:20:23.537

这对我有用，我
在线程中使用这个函数。
我的 csv 文件包含 120907 行。

```
def products_create():
    full_path = os.path.join(settings.MEDIA_ROOT,'productcsv')
    filename = os.listdir(full_path)[0]
    logger.debug(filename)
    logger.debug(len(Product.objects.all()))
    if len(Product.objects.all()) > 0:
        logger.debug("Products Data Erasing")
        Product.objects.all().delete()
        logger.debug("Products Erasing Done")

    csvfile = os.path.join(full_path,filename)
    csv_df = pd.read_csv(csvfile,sep=',')
    csv_df['HSN Code'] = csv_df['HSN Code'].fillna(0)
    row_iter = csv_df.iterrows()
    logger.debug(row_iter)

    logger.debug("New Products Creating")

    for index, row in row_iter:
        Product.objects.create(part_number = row[0],
                               part_description = row[1],
                               mrp = row[2],
                               hsn_code = row[3],
                               gst = row[4],
                               )

    # products_list = [
    #           Product(
    #               part_number = row[0] ,
    #               part_description = row[1],
    #               mrp = row[2],
    #               hsn_code = row[3],
    #               gst = row[4],
    #           )
    #           for index, row in row_iter

    #       ]
    # logger.debug(products_list)

    # Product.objects.bulk_create(products_list)
    logger.debug("Products uploading done")``` 
```

# jquery - 带百分比的动态宽度和响应式设计

> ID：12451071
> 
> 赞同：1
> 
> 时间：2012-09-16T21:55:51.003
> 
> 标签：jquery, debugging, responsive-design, slide, fluid-layout

我正在设计我的作品集，其中有一个带有水平幻灯片的区域，例如 coda slide。我的问题是，JS 生成的宽度以 px 为单位，我需要以 % 为单位设置该宽度才能在大多数屏幕分辨率下工作。当我尝试更改某些内容时，宽度变为 % 但幻灯片垂直移动。

示例 HTML：

```
<div class="scroll">

<!-- the element that will be scrolled during the effect -->
<div class="scrollContainer">
<!-- our individual panels -->

<!-- PROJECT 1 -->
<article class="panel" id="work1">
<figure><img src="images/works/project1.png" alt="Alt Text" title="Title Text"/></figure>

<header>
    <h1>TITLE</h1>
</header>

    <p> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec eu diam elit, non sodales magna. Nam ut imperdiet metus. Nam in lectus eros, non varius nunc. In elementum, urna in pulvinar vestibulum, ligula ipsum pharetra massa, ac porta neque turpis vel ligula. Morbi nec justo vitae urna luctus suscipit. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Morbi semper cursus nisi nec tincidunt. Donec non sapien at turpis iaculis iaculis vel at eros. Phasellus dictum consectetur dui, sed imperdiet diam rhoncus et. Aliquam egestas, nisl ut pellentesque egestas, sapien orci tristique lacus, quis egestas odio enim a felis. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Pellentesque mattis dapibus libero, nec ultrices neque iaculis nec.</p>
    <p> Ut quis purus diam. Vestibulum bibendum, ipsum ac pharetra pretium, lectus justo molestie ligula, nec dignissim ante nulla non nulla. Maecenas sit amet elit metus. Nulla dignissim pretium porttitor. Cras pellentesque condimentum fringilla. Fusce ac odio convallis ante venenatis interdum et et mauris. Donec tincidunt sapien nec enim egestas sollicitudin. Proin sit amet metus ac eros commodo dapibus id vel neque. Nulla in luctus felis. Sed at urna magna, ac vestibulum neque. Nam dictum elementum pharetra.</p>
</article>

<!-- PROJECT 2 -->
<article class="panel" id="work2">
<figure><img src="images/works/project2.png" alt="Alt Text" title="Title Text"/></figure>

<header>
    <h1>TITLE</h1>
</header>

    <p> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec eu diam elit, non sodales magna. Nam ut imperdiet metus. Nam in lectus eros, non varius nunc. In elementum, urna in pulvinar vestibulum, ligula ipsum pharetra massa, ac porta neque turpis vel ligula. Morbi nec justo vitae urna luctus suscipit. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Morbi semper cursus nisi nec tincidunt. Donec non sapien at turpis iaculis iaculis vel at eros. Phasellus dictum consectetur dui, sed imperdiet diam rhoncus et. Aliquam egestas, nisl ut pellentesque egestas, sapien orci tristique lacus, quis egestas odio enim a felis. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Pellentesque mattis dapibus libero, nec ultrices neque iaculis nec.</p>
    <p> Ut quis purus diam. Vestibulum bibendum, ipsum ac pharetra pretium, lectus justo molestie ligula, nec dignissim ante nulla non nulla. Maecenas sit amet elit metus. Nulla dignissim pretium porttitor. Cras pellentesque condimentum fringilla. Fusce ac odio convallis ante venenatis interdum et et mauris. Donec tincidunt sapien nec enim egestas sollicitudin. Proin sit amet metus ac eros commodo dapibus id vel neque. Nulla in luctus felis. Sed at urna magna, ac vestibulum neque. Nam dictum elementum pharetra.</p>

<figure>
    <img src="images/works/project2a.png" class="workscenter" alt="Alt Text" title="Title Text"/><br/>
    <img src="images/works/project2b.png" class="workscenter" alt="Alt Text" title="Title Text"/><br/>
    <img src="images/works/project2c.png" class="workscenter" alt="Alt Text" title="Title Text"/>
</figure>

</article>
</div>
</div> 
```

在我正在使用的 jS 下面：

```
jQuery(document).ready(function($) {
    // Container
    var container = $('.scroll');

    // Navigation
    var navContainer = $('#slider .navigation');
    var navLink = $('#slider .navigation li a');

    // Slides
    var panelsContainer = $('.scroll .scrollContainer');
    var panels = $('.scroll .scrollContainer > article');
    var panelWidth = panels[0].offsetWidth;

    // Float all slides side by side
    panels.css({
        'float' : 'left',
        'position' : 'relative',
        'width': panelWidth,
        'height': 'auto',
        'opacity': 0
    });

    // Set the width of the first slide
    container.css({
        'width': panelWidth,
        'height': panels[0].offsetHeight,
        'overflow': 'hidden'
    });

    // Set the total width to allow the slide effect
    panelsContainer.css({
        'width': panelWidth * panels.length,
    });

    // Activate the first slide
    navLink.eq(0).addClass('selected');
    panels.eq(0).css('opacity', 1);

    // Verify the links where is possible to slide
    $('a').bind('click', function(e) {
        var target = $(this).attr('href');

        if($(target).html() !== undefined ) {
            $('html, body').stop().animate({
                scrollTop: $(target).offset().top
            }, 1500, 'easeInOutExpo');

            if($(target).parent('div').hasClass('scrollContainer')) {
                $('#slider .navigation li a').removeClass('selected');
                $('#slider .navigation li a[href=' + target + ']').addClass('selected');

                // Actual slide
                var current = $('#slider .navigation li a.selected');

                // Slide to be opened
                var index = current.closest('li').index();

                // Dinâmica height with plus 70px at the end
                container.css('height', $(target).height() + 70);

                // Set the actual slide
                navLink.removeClass('selected');
                current.addClass('selected');

                // Show the actual slide
                panels.css('opacity', 1);

                // Create the transition effect
                $(container).scrollTo($('.scroll .scrollContainer > article').eq(index), 800);

                // Hidden all others slides
                setTimeout(function() {
                    panels.css('opacity', 0);
                    panels.eq(index).css('opacity', 1);
                }, 800);
            }
        }
    });

    // Fix to makes right wrong projects
    if(window.location.hash) {
        $('a[href="' + window.location.hash + '"]:first').trigger('click');
    }
}) 
```

有人知道一些方法来制作我想要的东西吗？

感谢你们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-14T18:31:45.910

使用更简单的解决方案，例如 CSS3 幻灯片：

*   [扫我](http://www.cssplay.co.uk/menu/cssplay-swipe-me-mobile.html)
*   [也扫我](http://www.cssplay.co.uk/menu/cssplay-swipe-me-too.html)
*   [刷我内联](http://www.cssplay.co.uk/cssplay-swipe-me-inline.html)

# c++ - “/usr/lib/libstdc++.so.6：找不到版本‘GLIBCXX_3.4.15’”，如何解决？

> ID：12451073
> 
> 赞同：0
> 
> 时间：2012-09-16T21:56:56.607
> 
> 标签：c++

我正在`.so`使用 Anjuta IDE 在 Ubuntu 下编译一个。即使它编译得很好，当我加载时`.so`，它也会抛出该错误：

`/usr/lib/libstdc++.so.6: version GLIBCXX_3.4.15' not found`

我发现运行命令：

`strings /usr/lib/libstdc++.so.6 | grep GLIBCXX`将打印您已安装的版本，但它给了我错误：`strings: '/usr/lib/libstdc++.so.6': No such file`

你们中的任何人对如何解决这个问题有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-28T13:49:31.800

尝试运行：`sudo apt-get install libstdc++6`

# php - wordpress 代码中出现意外的 T 函数错误

> ID：12451074
> 
> 赞同：0
> 
> 时间：2012-09-16T21:57:29.540
> 
> 标签：php

嗨，当我在运行 php 5.2 的网络服务器上运行以下代码时，我在最后一行不断收到 Unexpected T_function 错误，这在运行 php 5.3.6 的本地机器上运行良好

```
 // ***** Declare function that buids the post type
 function add_post_type($name, $args = array() ) {
    add_action('init',function() use($name, $args) { 
```

有人可以帮我找出问题所在吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T22:00:05.667

匿名函数直到 PHP 5.3 才可用。[请参阅更改日志](http://php.net/manual/en/functions.anonymous.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T22:00:32.090

PHP 5.2 不支持匿名函数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T22:02:08.380

这段代码：

```
function() use($name, $args) { .. 
```

它是一个**匿名函数**（或闭包）。 自**PHP 5.3.0起可以使用**[匿名函数](http://php.net/manual/en/functions.anonymous.php)

# html5-video - 在模态窗口中自动播放视频

> ID：12451075
> 
> 赞同：0
> 
> 时间：2012-09-16T21:57:33.780
> 
> 标签：html5-video, simplemodal, autoplay

我正在使用模态窗口来显示多个视频，但我的自动播放似乎在模态窗口中被忽略了。如果我在页面上有视频并且它没有隐藏，那么自动播放就可以了。我需要做其他事情来触发模式窗口中的自动播放吗？

我正在使用[SimpleModal](http://www.ericmmartin.com/projects/simplemodal/)来做模态窗口。对于视频，我使用了一个简单的视频标签和一个带有自动播放布尔值的 mp4 视频。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T00:16:52.447

我只能通过在 jQuery UI 对话框的“打开”处理程序中使用 javascript play() 调用来使其工作。没有其他方法可以工作..也许 simplemodal 有一个模拟？这是 jQuery UI 的解决方案：

```
$('div#mydialog').dialog({
    open: function(event, ui)   {
        $('video#myvideo').get(0).play();   
    }
}); 
```

# html - 在 chrome 中使用 Filereader 上传文件

> ID：12451077
> 
> 赞同：1
> 
> 时间：2012-09-16T21:57:48.757
> 
> 标签：html, xmlhttprequest, filereader

我必须从应用程序的本地内存上传一个文件（HTML5 File api）。Onselect，用户应该可以直接上传，没有任何问题。这个想法是管理下载/上传给用户无缝。这是代码：

```
 $("body").on("click", ".upload-file", function(e){

    var fileToUpload = $('input:radio[name=optionsRadios]:checked').val();
    var formData = new FormData();

    $('input:radio[name=optionsRadios]:checked').parent().parent().parent().remove();

    window.requestFileSystem  = window.requestFileSystem || window.webkitRequestFileSystem;      
    window.requestFileSystem(window.TEMPORARY, 50*1024*1024, initFS, errorHandler);

    var reader = new FileReader();
    function initFS(fs){
        fs.root.getDirectory('/', {}, function(dirEntry){
            var dirReader = dirEntry.createReader();
            dirReader.readEntries(function(entries) {
                for(var key = 0; key < entries.length; key++) {
                        var entry = entries[key];
                         if (entry.isFile){
                             var name = entry.name;                             
                             if(name == fileToUpload){
                                 getAsText(entry.toURL());
                                 formData.append('file', entry.toURL);
                                 break;
                             }
                        }
                }

        }, errorHandler);
        }, errorHandler);
    }

    function errorHandler(){
          console.log('An error occured');
        }   

    function getAsText(readFile) {
          alert ("getting as text :" +readFile);
          var reader = new FileReader();

          // Read file into memory as UTF-16      
          reader.readAsText(readFile, "UTF-16");

          // Handle progress, success, and errors
          reader.onprogress = updateProgress;
          reader.onload = loaded;
          reader.onerror = errorHandler;
    }

    function loaded(evt) {  
          // Obtain the read file data 
            alert("loaded file");
          var fileString = evt.target.result;
          // Handle UTF-16 file dump
          if(utils.regexp.isChinese(fileString)) {
            //Chinese Characters + Name validation
          }
          else {
            // run other charset test
          }
          // xhr.send(fileString)     
        }
    var serverurl = "/fileserver/uploadFile?selpath="+fileToUpload;       

      var xhr = new XMLHttpRequest();
      xhr.open('POST', serverurl);
      xhr.onload = function () {
        if (xhr.status === 200) {
          console.log('all done: ' + xhr.status);
        } else {
          console.log('Something went terribly wrong...');
        }
      };

      xhr.send(formData);
}); 
```

现在，我正在尝试将文件作为文本读取（这是一种不好的做法，但想找到使其工作的方法），但它不会引发任何事件。你能帮我找出哪里出错了吗？

# maven - 简单的 Jetty/Maven Hello World webapp 中的 404 Not Found 错误

> ID：12451081
> 
> 赞同：9
> 
> 时间：2012-09-16T21:58:13.313
> 
> 标签：maven, maven-2, jetty, embedded-jetty

我已按照Eclipse wiki 上的说明完全按照说明创建“带有 Jetty 和 Maven 的标准 WebApp”：*http* : [//wiki.eclipse.org/Jetty/Tutorial/Jetty_and_Maven_HelloWorld#Developing_a_Standard_WebApp_with_Jetty_and_Maven](http://wiki.eclipse.org/Jetty/Tutorial/Jetty_and_Maven_HelloWorld#Developing_a_Standard_WebApp_with_Jetty_and_Maven)

但是，当我运行 webapp (mvn jetty:run) 并转到 localhost:8080/hello-world/hello 时，我最终会遇到“访问 /hello-world/hello 的 HTTP 错误 404 问题。原因：未找到”。我通读了文档，查看了 wiki 页面的历史，浏览了其他论坛和 stackoverflow 线程，但找不到这个看似简单问题的答案。我将发布我的源代码，但它实际上与教程相同。

任何帮助，将不胜感激。我真的很想开始使用这项技术，但是不断地撞到同样的死胡同令人沮丧。

（请注意：教程的第一部分创建“JettyMavenHelloWorld”工作正常。我的问题是第二部分“JettyMavenHelloWarApp”。本节标题为“使用 Jetty 和 Maven 开发标准 WebApp”）

JettyMavenHelloWarApp/pom.xml

```
<project xmlns="http://maven.apache.org/POM/4.0.0" 
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
      xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">

  <modelVersion>4.0.0</modelVersion>
  <groupId>org.example</groupId>
  <artifactId>hello-world</artifactId>
  <version>0.1-SNAPSHOT</version>
  <packaging>jar</packaging>
  <name>Jetty HelloWorld</name>

  <properties>
    <jettyVersion>7.2.0.v20101020</jettyVersion>
  </properties>

  <dependencies>
    <dependency>
      <groupId>org.eclipse.jetty</groupId>
      <artifactId>jetty-server</artifactId>
      <version>${jettyVersion}</version>
    </dependency>
  </dependencies>

  <build>
    <plugins>
      <plugin>
        <!-- This plugin is needed for the servlet example -->
        <groupId>org.mortbay.jetty</groupId>
        <artifactId>jetty-maven-plugin</artifactId>
        <version>${jettyVersion}</version>
      </plugin>
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>exec-maven-plugin</artifactId>
        <version>1.1</version>
        <executions>
          <execution><goals><goal>java</goal></goals></execution>
        </executions>
        <configuration>
          <mainClass>org.example.HelloWorld</mainClass>
        </configuration>
      </plugin>
    </plugins>
  </build>
</project> 
```

JettyMavenHelloWarApp/src/main/java/org/example/HelloServlet.java

```
package org.example;

import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class HelloServlet extends HttpServlet
{
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException
    {
        response.setContentType("text/html");
        response.setStatus(HttpServletResponse.SC_OK);
        response.getWriter().println("<h1>Hello Servlet</h1>");
        response.getWriter().println("session=" + request.getSession(true).getId());
    }
} 
```

JettyMavenHelloWarApp/src/main/webapp/WEB-INF/web.xml

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<web-app 
   xmlns="http://java.sun.com/xml/ns/javaee" 
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" 
   version="2.5">
  <servlet>
    <servlet-name>Hello</servlet-name>
    <servlet-class>org.example.HelloServlet</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>Hello</servlet-name>
    <url-pattern>/hello/*</url-pattern>
  </servlet-mapping>
</web-app> 
```

JettyMavenHelloWarApp/src/main/webapp/index.html

```
<h1>Hello World Webapp</h1>
<a href="/hello">Hello Servlet</a> 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-16T22:35:02.457

本教程给出了不正确的 url - 您的应用上下文仍然是“/”，因此 url 分别是`http://localhost:8080`和`http://localhost:8080/hello`用于静态和动态内容。

maven jetty 插件文档确实声称默认上下文将被命名为与 pom.xml 中的 artifactId 相同，但这似乎在这里不起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-22T18:03:54.447

我遇到了同样的问题，对我有用的是访问应用程序，例如：`http://localhost:8080/hello/index.jsp`或者`http://localhost:8080/hello/index.html`，无论您使用的是 html 还是 js 页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-22T09:58:54.783

我认为在你的 pom 中向 jetty 插件定义添加配置应该将 contextpath 更改为 hello-world：

```
 <plugin>
            <groupId>org.eclipse.jetty</groupId>
            <artifactId>jetty-maven-plugin</artifactId>
            <version>${jettyVersion}</version>
            <configuration>
                <webApp>
                    <contextPath>/hello-world</contextPath>
                </webApp>
            </configuration>
        </plugin> 
```

这是基于 jetty 版本 9。有关配置选项，请参阅[http://wiki.eclipse.org/Jetty/Feature/Jetty_Maven_Plugin](http://wiki.eclipse.org/Jetty/Feature/Jetty_Maven_Plugin)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-04T14:01:17.263

我在基本配置上遇到了同样的问题。

我想用 Spring 3 MVC 用这个配置重定向一个错误页面（在 web.xml 中）

```
<error-page>
        <error-code>404</error-code>
        <location>/WEB-INF/views/error.html</location>
</error-page> 
```

我通过将**error.html**的扩展名更改为**error.jsp**来解决它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-10T18:36:39.597

我认为您在那之前没有运行`mvn package`任务，`mvn jetty:run`这就是码头看不到任何来源的原因。就先跑吧`mvn package`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-22T04:55:12.243

您的 servlet 映射不正确或不充分。

```
<url-pattern>/hello/*</url-pattern> // does not respond to "/hello" 
```

您需要为 URL 模式“/hello”添加映射

```
<url-pattern>/hello</url-pattern> 
```

# automatic-ref-counting - ARC 中的 AFNetworking 在添加 -fno-obc-arc 后给出编译器警告

> ID：12451084
> 
> 赞同：2
> 
> 时间：2012-09-16T21:58:43.310
> 
> 标签：automatic-ref-counting, afnetworking

我有一个 ARC 项目，我正在尝试向其中添加 AFNetworking。在目标的构建阶段中，我用“-fno-objc-arc”标志标记了所有 AFNetworking 文件。但我仍然收到不少编译器警告，例如“方法可能缺少 [super dealloc] 调用”和“未指定 'assign'、'copy' 或 'retain' 属性，假定分配”，有时是后跟“默认属性属性‘分配’不适用于非 gc 对象”。

我见过的所有关于 AFNetworking 的示例都说，如果我设置了编译器标志，文件应该编译时不会出现错误或警告。我错过了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-16T22:10:44.967

似乎 AFNetworking 现在可以使用 ARC 编译，因此不需要`-fno-objc-arc`标志。在非 ARC 项目中，您需要将 AFNetworking 文件标记为`-fobjc-arc`. AFNetworking 在最近的一次提交中也放弃了对 iOS 4 的支持。

# regex - Mod_Rewrite 条件有助于盗链，但允许本地请求

> ID：12451085
> 
> 赞同：2
> 
> 时间：2012-09-16T21:58:43.547
> 
> 标签：regex, .htaccess, mod-rewrite

我有热链接保护工作，所以我想，但不是当推荐人是本地人时。

```
IndexIgnore *
Options +FollowSymlinks
RewriteEngine on
RewriteOptions MaxRedirects=10

RewriteCond %{REQUEST_URI} ^/image_dir/
RewriteCond %{REQUEST_URI} \.(png|gif|jpe?g)$ [NC]
RewriteCond %{HTTP_REFERER} !^https?://(www\.)?domain.com/
RewriteRule ^(.*)$ /some_dir/some_file.php?querystring=$1 [L] 
```

我需要的是：

如果在网站上的任何图像请求中引用者不是来自我的网站，则重定向到包含用户请求的图像的页面。

如果引用者来自我的站点并且请求是针对 image_dir 中的任何图像，则重定向，否则不要。

任何帮助是极大的赞赏！

编辑：这是帮助的完整文件：

```
## Default .htaccess file
IndexIgnore *
Options +FollowSymlinks
RewriteEngine on
RewriteOptions MaxRedirects=10

# your rules were looping before, that's bad, this will stop it
RewriteCond %{ENV:REDIRECT_STATUS} 200
RewriteRule ^ - [L]

# redirect the browser back to the referring page
RewriteCond %{REQUEST_URI} ^/img/
RewriteCond %{REQUEST_URI} \.(png|gif|jpe?g)$ [NC]
RewriteCond %{HTTP_REFERER} !^https?://(www\.)?domain.com/
RewriteRule ^ %{HTTP_REFERER} [L,R]

# rewrite the request to the handler
RewriteCond %{REQUEST_URI} ^/img/
RewriteCond %{REQUEST_URI} \.(png|gif|jpe?g)$ [NC]
RewriteCond %{HTTP_REFERER} ^https?://(www\.)?domain.com/
RewriteRule ^(.*)$ /img/index.php?img_hash=$1 [L]

## Do pretty permalinks for our images
# these rules ensure you aren't clobbering legit requests (like to image.php) 
RewriteCond %{REQUEST_FILENAME} !-f 
RewriteCond %{REQUEST_FILENAME} !-d 

# just in case, exclude the admin directory 
RewriteCond %{REQUEST_URI} !^/admin [NC] 

# rewrite 
RewriteRule ^(.*)$ /display_image.php?img_hash=$1 [L] 
```

除了盗链之外，一切都像我想要的那样工作：

```
domain.com/t4hd -> domain.com/display_image.php?img_hash=t4hd (WORKS)
domain.com/t4hd.jpg -> domain.com/display_image.php?img_hash=t4hd.jpg (WORKS)
domain.com/img/t4hd -> domain.com/img/index.php?img_hash=t4hd (WORKS)
domain.com/img/t4hd.jpg -> domain.com/img/index.php?img_hash=t4hd.jpg (WORKS)
domain.com/img/123/456/789/t4hd.jpg -> domain.com/img/index.php?img_hash=t4hd.jpg (DOES NOT WORK) 
```

我仍然必须允许所有请求：

```
domain.com/admin/index.php (WORKS)
domain.com/profile/index.php (WORKS) 
```

希望这有助于澄清正在发生的事情。很抱歉一开始没有这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:41:46.393

尝试使用这些规则：

```
# your rules were looping before, that's bad, this will stop it
RewriteCond %{ENV:REDIRECT_STATUS} 200
RewriteRule ^ - [L]

# redirect the browser back to the referring page
RewriteCond %{REQUEST_URI} ^/image_dir/
RewriteCond %{REQUEST_URI} \.(png|gif|jpe?g)$ [NC]
RewriteCond %{HTTP_REFERER} !^https?://(www\.)?domain.com/
RewriteCond %{HTTP_REFERER} !^$
RewriteRule ^ %{HTTP_REFERER} [L,R]

# rewrite the request to the handler
RewriteCond %{REQUEST_URI} ^/image_dir/
RewriteCond %{REQUEST_URI} \.(png|gif|jpe?g)$ [NC]
RewriteCond %{HTTP_REFERER} ^https?://(www\.)?domain.com/ [OR]
RewriteCond %{HTTP_REFERER} ^$
RewriteRule ^(.*)$ /some_dir/some_file.php?querystring=$1 [L] 
```

也就是说，我在你的问题中假设这个神秘的位：

> 如果引用者来自我的站点并且请求是针对 image_dir 中的任何图像，则重定向，否则不要。

方法：

“如果引用者来自我的站点并且请求是针对 image_dir 中的任何图像，则将请求发送到 some_file.php 处理程序，否则不做任何事情。”

# java - startActivity() 强制关闭我的应用程序

> ID：12451087
> 
> 赞同：0
> 
> 时间：2012-09-16T21:58:49.393
> 
> 标签：java, android, android-intent

无论我做什么，我都无法开始新的活动。我再次重新下载了所有 Android SDK。我重新下载了 Eclipse 并再次安装了 ADT 插件

错误日志

```
09-16 17:53:51.537: W/IInputConnectionWrapper(4661): getCursorCapsMode on inactive InputConnection
09-16 17:53:51.998: D/AndroidRuntime(4661): Shutting down VM
09-16 17:53:51.998: W/dalvikvm(4661): threadid=1: thread exiting with uncaught exception (group=0x41987300)
09-16 17:53:52.022: E/AndroidRuntime(4661): FATAL EXCEPTION: main
09-16 17:53:52.022: E/AndroidRuntime(4661): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.lays.decisong/com.lays.decisong.activities.GameActivity}: java.lang.NullPointerException
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1983)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.os.Handler.dispatchMessage(Handler.java:99)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.os.Looper.loop(Looper.java:137)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.app.ActivityThread.main(ActivityThread.java:4745)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at java.lang.reflect.Method.invokeNative(Native Method)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at java.lang.reflect.Method.invoke(Method.java:511)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at dalvik.system.NativeStart.main(Native Method)
09-16 17:53:52.022: E/AndroidRuntime(4661): Caused by: java.lang.NullPointerException
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.content.ContextWrapper.getApplicationInfo(ContextWrapper.java:132)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.view.ContextThemeWrapper.getTheme(ContextThemeWrapper.java:65)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.app.AlertDialog.resolveDialogTheme(AlertDialog.java:142)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.app.AlertDialog.<init>(AlertDialog.java:98)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.app.ProgressDialog.<init>(ProgressDialog.java:77)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.app.ProgressDialog.show(ProgressDialog.java:110)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.app.ProgressDialog.show(ProgressDialog.java:99)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at com.lays.decisong.activities.GameActivity$3.<init>(GameActivity.java:401)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at com.lays.decisong.activities.GameActivity.<init>(GameActivity.java:398)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at java.lang.Class.newInstanceImpl(Native Method)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at java.lang.Class.newInstance(Class.java:1319)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.app.Instrumentation.newActivity(Instrumentation.java:1053)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1974) 
```

DecisongApplication.java 中的公钥

```
public static final String PLAYERS_KEY = "com.lays.decisong.activities.Players"; 
```

InputActivity.java 中的按钮处理程序

调用 startActivity() 时应用程序强制关闭

```
public void startGame(View v) {
    // check if there's more than one player
    if (mPlayers.size() < 2) {
        Log.i(TAG, "Only 1 player");
        Toast.makeText(mContext, "At least 2 players needed to start game",
                Toast.LENGTH_SHORT).show();
        return;
    }

    Intent intent = new Intent(this.getApplicationContext(), GameActivity.class);
    intent.putStringArrayListExtra(DecisongApplication.PLAYERS_KEY, mPlayers);
    startActivity(intent);
    overridePendingTransition(R.anim.slide_up_incoming, R.anim.slide_up_outgoing);
} 
```

清单.xml

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.lays.decisong"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="10"
    android:targetSdkVersion="16" />

<supports-screens
    android:anyDensity="true"
    android:largeScreens="false"
    android:normalScreens="true"
    android:smallScreens="false"
    android:xlargeScreens="false" />

<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

<application
    android:name="com.lays.decisong.DecisongApplication"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:screenOrientation="portrait"
    android:theme="@android:style/Theme.NoTitleBar" >
    <activity android:name=".activities.MainActivity" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".activities.InstructionsActivity"
        android:noHistory="true" />
    <activity
        android:name=".activities.InputActivity"
        android:noHistory="true" />
    <activity
        android:name=".activities.SettingsActivity"
        android:noHistory="true" />
    <activity
        android:name=".activities.GameActivity"
        android:noHistory="true" />
</application>

</manifest> 
```

com.lays.decisong.activities 中 GameActivity.java 的 onCreate 从未被调用

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_game);

    // init rdio variables
    mTrackQueue = new LinkedList<Track>();
    if (mRdio == null) {
        mRdio = new Rdio(DecisongApplication.RDIO_API_KEY,
                DecisongApplication.RDIO_SECRET_KEY, null, null, this, this);
    }

    // init quiz variables
    mListView = getListView();
    mAllAlbums = new HashMap<String, Album>();
    mChosenTracks = new ArrayList<Track>();
    mAdapter = new TracksAdapter(this, mChosenTracks);
    setListAdapter(mAdapter);

    // init player variables
    mCurrentRoundView = (TextView) findViewById(R.id.current_round);
    mCurrentRound = INITIAL_ROUND;
    mCurrentPlayerView = (TextView) findViewById(R.id.current_player);
    mCurrentPlayer = INITIAL_PLAYER;
    mPlayers = new ArrayList<Player>();
    if (getIntent().hasExtra(DecisongApplication.PLAYERS_KEY)) {
        ArrayList<String> players = getIntent().getStringArrayListExtra(DecisongApplication.PLAYERS_KEY);
        for (String p : players) {
            mPlayers.add(Player.create(p));
        }
    }

    // setup game conditions
    Collections.shuffle(mPlayers);
    mCurrentPlayerView.setText(mPlayers.get(mCurrentPlayer).name);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T22:03:24.027

```
09-16 17:53:52.022: E/AndroidRuntime(4661):     at com.lays.decisong.activities.GameActivity$3.<init>(GameActivity.java:401)
09-16 17:53:52.022: E/AndroidRuntime(4661):     at com.lays.decisong.activities.GameActivity.<init>(GameActivity.java:398) 
```

看起来你正试图在你的构造函数中做一些设置，或者在活动完全初始化`GameActivity`之前初始化一些字段。`Context`你真的应该在`onCreate()`; 不要使用构造函数，也不要依赖在输入`Context`之前可用`onCreate()`。

# php - PDO - 搜索是整体查询术语，而不是单独查询每个术语

> ID：12451091
> 
> 赞同：4
> 
> 时间：2012-09-16T21:59:28.797
> 
> 标签：php, mysql, search, pdo, prepared-statement

我目前有一个简单的搜索引擎，它根据用户的输入在我的数据库中搜索列：

```
$search = $_GET['search'];
$terms = explode(" ", $search);

        $sql = "SELECT * FROM people WHERE lname LIKE :search";
    $q   = $conn->prepare($sql) or die("failed!");
    $q->bindValue(':search',"%".$search."%",PDO::PARAM_STR);
    $q->execute();

 if ($q){

 //
 do something

 } 
```

目前它正在整体搜索术语，例如“red desk”返回结果但“desk red”不返回任何内容

有任何想法吗？非常感谢任何帮助！

编辑：

从那以后我把它改成了这个......

```
 $search = $_GET['search'];
   $terms = explode(" ", $search);

        $sql = "SELECT * FROM people WHERE MATCH (lname,fname) AGAINST  (:search IN BOOLEAN MODE)";
    $q   = $conn->prepare($sql) or die("failed!");
    $q->bindValue(':search',"%".$search."%",PDO::PARAM_STR);
    $q->execute(); 
```

现在似乎工作正常，如果有人能提出更好的解决方案，我将非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T04:07:50.870

这可能不是最好的方法，但我认为这样的事情可能会奏效。我自己很想知道是否有更聪明的方法来做到这一点！

```
$search = $_GET['search'];
$terms = explode(" ", $search);

$sql = "SELECT * FROM people"
if(count($terms) > 0) {
  $sql .= " WHERE (lname LIKE '%:term_0%' OR fname LIKE '%:term_0%')";
  for($i = 1; $i < count($terms); $i++)
    $sql .= " AND (lname LIKE '%:term_" . $i . "%' OR fname LIKE '%:term_" . $i . "%')";
}

$q = $conn->prepare($sql) or die("failed!");

for($i = 0; $i < count($terms); $i++)
  $q->bindValue(':term_' . $i, $terms[$i]);
$q->execute(); 
```

# algorithm - 英文拼写错误更正序列

> ID：12451097
> 
> 赞同：2
> 
> 时间：2012-09-16T22:00:44.723
> 
> 标签：algorithm, search, linguistics, spelling

我正在做一些搜索引擎。其中一个功能是尝试在没有找到任何东西的情况下更正拼写。我替换了以下语音序列：ph<->f, ee <-> i, oo<->u, ou<->o (color<->color)。我在哪里可以找到类似英语的完整列表？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T22:26:29.637

您可能想从[这里](http://en.wikipedia.org/wiki/Soundex)开始（Soundex 上的维基百科），然后通过“另见”链接开始追踪。（例如，Metaphone 有一个替换列表。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T11:16:52.350

如果您正在创建搜索引擎，您必须意识到有**很多网页包含拼写错误的单词**。但是，当然，您需要任何策略来使这些页面也可搜索。所以没有通用的规则来实现拼写校正器（**因为正确性成为网络中的相对概念**）。但是在实践中有一些技巧可以做到这一点:-)

我建议您使用**[n-gram index](http://en.wikipedia.org/wiki/N-gram)** + **[Levenstein distance](http://en.wikipedia.org/wiki/Levenshtein_distance)**（或[任何类似的距离](http://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance)）来纠正拼写。

**列文斯坦距离小的字符串可能是同一个词的变体。**

假设您要更正单词“fantoma”。如果您有大量单词 - 遍历字典并计算与每个单词的距离将非常昂贵。因此，您必须非常快速地找到与“fantoma”距离可能很小的单词。

主要思想是在抓取和索引网页时 - 将 n-gram（例如 - bigrams）索引到单独的索引中。将每个单词拆分为 n-gram，并将其添加到 n-gram 索引中：

```
1) Split each word from dictionary, 
   for example: "phantom" -> ["ph", "ha", "an", "nt", "to", "om"]

2) Create index:
   ...
   "ph" -> [ "phantom", "pharmacy", "phenol", ... ]
   "ha" -> [ "phantom", "happy" ... ]
   "an" -> [ "phantom", "anatomy", ... ]
   ... 
```

现在 - 你有索引，你可以很快找到你的话的候选人。

例如：

```
1) "fantoma" -> ["fa", "an", "nt", "to", "om", "ma"]
2) get lists of words for each n-gram from index, 
   and extract most frequent words from these lists - these words are candidates
3) calculate Levenstein distance to each candidate, 
   the word with smallest distance is probably spell-corrected variant of searched word. 
```

我建议你看一下[《信息检索简介》](https://rads.stackoverflow.com/amzn/click/com/0521865719)这本书。

# sql - SQL is-a / has-a / is-a 结构和验证

> ID：12451098
> 
> 赞同：0
> 
> 时间：2012-09-16T22:00:48.330
> 
> 标签：sql, postgresql

考虑以下示例。当我写“is-a”时，我的意思是一个列，它既是其表的主键，又是另一个表的外键，以形成一对一的关系。当我写“has-a”时，我的意思是一个常规的外键列，形成一对多的关系。

*   水果篮桌。
*   一个applebasket 桌子，“is-a”水果篮。
*   橙色篮子桌，“is-a”水果篮。
*   水果桌，“有”水果篮。
*   一张苹果桌，“is-a”水果。
*   橙色的桌子，“is-a”水果。

暂时假设在 applebasket、orangebasket、apple 和 orange 中有特定于上下文的列，足以保证该表的存在，而不是用可空列或类型枚举使父表混乱。

问题：

*   将水果和水果篮关联起来，还是将苹果和苹果篮+橙子和橙子篮关联起来更好？前者似乎不那么多余，但可能具有无效的关系（例如，apple -> fruit -> fruitbasket -> orangebasket）。后者强制关系有效，但更冗余，并要求任何其他继承的水果表声明自己的篮子外键。
*   特别是对于 PostgreSQL，给定第一选择（将水果与水果篮相关联），我检查关系有效性的最简单方法是什么？它必须执行三个连接。
*   还有其他建议可以干净地实施吗？

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T06:46:10.647

我认为您对此的看法有些错误。关系数据建模是关于*数据*的，而对象建模是关于*行为的。* 这些是不同的学科，就像我喜欢做的对象关系数据建模一样，has-a 和 is-a 不属于数据库。而是查看功能依赖关系并对其进行建模。否则，如果您有多个应用程序试图以不同的方式访问相同的数据，您最终可能会遇到问题。

例如，假设我们有两个应用程序。一个人提取数据并对其进行操作，并对行为进行建模。第二个提取数据，将其视为静态，并获取信息。如果 LSP 允许您说“正方形是矩形”，就像您自己一样。在第一种情况下，没有。在第二种情况下，是的。在第一种情况下，您可能想要使用 has-a “rectangular_area”，而在第二种情况下，“is-a rectangle”是完全有效的。

所以这让我想到了我的第二点。如果您正在查看这种复杂的关系，您如何进行映射可能取决于您对数据所做的工作。一般来说，最好根据定义元素而不是行为元素来约束您的数据。因此，在这种情况下，您可以在任何需要它们的地方进行映射。然后我会建议以下内容：

1.  水果（储存苹果、梨、橙子等）。
2.  您需要的任何补充表格。
3.  水果篮
4.  多对多映射表，显示水果篮中的水果种类。

这让我特别想到了你的问题：

> 将水果和水果篮关联起来，还是将苹果和苹果篮+橙子和橙子篮关联起来更好？

两个都。同时。往上看。

> 特别是对于 PostgreSQL，给定第一选择（将水果与水果篮相关联），我检查关系有效性的最简单方法是什么？

声明性参照完整性将带您一路走来。不要害怕使用一侧设置为 DEFERRABLE INITIALLY DEFERRED 的双向外键。

# ruby-on-rails - 按带有 seo 友好 url 的复选框过滤？

> ID：12451100
> 
> 赞同：0
> 
> 时间：2012-09-16T22:01:11.313
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我想在我们的房屋列表页面中添加过滤（复选框）。我正在考虑通过 ajax 来实现，以防万一，但同样重要的是 URL 结构对于 seo 来说是 SEO 友好的。

一个例子：

*   主题复选框是“近海”。网址是 domain.com/houses/nearthesea
*   主题复选框是“idealfortwo”。网址是 domain.com/houses/idealfortwo
*   amenity 复选框是“wifi” 网址必须是 domain.com/houses/idealfortwo/wifi

有人有想法、链接、帖子等来设置它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T15:47:14.147

不幸的是，没有真正的方法可以做到这一点，即定义具有未定义数量的路径组件的路由。您可以选择最大数量，并定义一系列路线，例如

```
get '/houses/:f1' => 'houses#index'
get '/houses/:f1/:f2' =>'houses#index'
...
get '/houses/:f1/:f2/:f3/:f4/:f5/:f6' =>'houses#index' 
```

但这会很快变得丑陋，我建议使用这样的 URL 方案：

```
get '/houses' => 'houses#index' 
```

然后您的 URL 可能如下所示：

```
/houses?filter=goodschool,bbq,northeast 
```

然后在您的索引操作中：

```
def index
  if params[:filter]
     filters = params[:filter].split(",")
     filters.each do |f|
       # do something with each term in the filter, I have no idea
     end
     @houses = House.where(.....???)
  else
     @houses = House.all
  end
end 
```

它不会产生您所追求的 SEO 友好 URL，但我不确定这将如何影响您的情况下的 SEO。

# c# - http post上的mvc错误对象引用未设置为对象的实例

> ID：12451105
> 
> 赞同：0
> 
> 时间：2012-09-16T22:01:59.877
> 
> 标签：c#, asp.net-mvc, razor, viewmodel

我遇到以下错误消息：

```
Object reference not set to an instance of an object. 
```

断线：

```
Line 16:         </div>
Line 17:         <div class="editor-field">
Line 18:              @Html.DropDownList("KPI.CSF.FYID", Model.Financial_Years)
Line 19:             @Html.ValidationMessageFor(model => model.KPI.CSF.FYID)
Line 20:         </div> 
```

这发生在我的 mvc 项目中的表单发布期间。

加载创建表单时，我正在传递以下视图模型：

```
public class KPICreateFormViewModel
    {

        //Properties
        public KPI KPI { get; set; }
        public SelectList Financial_Years { get; private set; }

        FYRepository fyrepo = new FYRepository();
      public KPICreateFormViewModel(KPI kpi)
        {
            KPI = kpi;
            Financial_Years = new SelectList(fyrepo.GetFys(), "ID", "Financial_Year");

        }

    } 
```

我使用财务年度作为下拉菜单，然后启动一些 ajax 以级联其他一些下拉菜单，这些下拉菜单将在我的帖子中填充 ID 号。

我不希望我的财务年度下拉列表在我的控制器的 http post 方法中发布任何内容。所以我想如果我只是传回以下内容，我会没事的：

```
[HttpPost]
    public ActionResult Create(KPI kpi)
    {
        try
        {

            kpirepository.Add(kpi);
            kpirepository.Save();

            return RedirectToAction("Details", new { id = kpi.ID });
        }
        catch
        {
            return View();
        }
    } 
```

我认为这一切都是因为我的视图基于视图模型而发生的，然后在发布后我没有将其退回？经过数小时弄乱级联代码以使其正常工作后，我的脑袋有点想尝试解决这个问题..帮助！

我认为显示财政年度下拉列表的相关部分：

```
@model ES_Business_Intelligence.ViewModels.Admin.KPICreateFormViewModel

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>KPI</legend>
        <div class="editor-label">
            @Html.LabelFor(model => model.KPI.CSF.FYID)
        </div>
        <div class="editor-field">
             @Html.DropDownList("KPI.CSF.FYID", Model.Financial_Years)
            @Html.ValidationMessageFor(model => model.KPI.CSF.FYID)
        </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T06:23:52.720

在从 webdeveloper 确认问题后，我进行了更多挖掘，发现当从表单提交返回数据时，我可以告诉我的视图模型的某些元素不绑定。我将以下代码添加到我的视图模型中：

```
[Bind(Exclude = "Financial_Years")]
    public class KPICreateFormViewModel
    {

        //Properties
        public KPI KPI { get; set; }
        public SelectList Financial_Years { get; private set; }

        FYRepository fyrepo = new FYRepository();
      public KPICreateFormViewModel(KPI kpi)
        {
            KPI = kpi;
            Financial_Years = new SelectList(fyrepo.GetFys(), "ID", "Financial_Year");

        }

    } 
```

魔术都在第一行：

```
[Bind(Exclude = "Financial_Years")] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T22:19:08.510

您是绝对正确的，您使用强类型视图并在发布`null`视图路径后，这就是为什么当您尝试访问属性 ( `model => model.KPI.CSF.FYID`) 时会引发异常。作为解决方案，您可以添加 if 块并忽略 html 标记，如果模型是`null`.

# java - BitmapFactory.decodeResource(getResources(), R.drawable.four_colors); 四色是什么意思？

> ID：12451112
> 
> 赞同：0
> 
> 时间：2012-09-16T22:02:47.520
> 
> 标签：java, android, photo

我正在尝试实现此代码：

```
package fortyonepost.com.iapa;  

import android.app.Activity;  
import android.graphics.Bitmap;  
import android.graphics.BitmapFactory;  
import android.os.Bundle;  
import android.util.Log;  

public class ImageAsPixelArray extends Activity  
{  
//a Bitmap that will act as a handle to the image  
private Bitmap bmp;  

//an integer array that will store ARGB pixel values  
private int[][] rgbValues;  

/** Called when the activity is first created. */  
@Override  
public void onCreate(Bundle savedInstanceState)  
{  
    super.onCreate(savedInstanceState);  
    setContentView(R.layout.main);  

    //load the image and use the bmp object to access it  
    bmp = BitmapFactory.decodeResource(getResources(), R.drawable.four_colors);  

    //define the array size  
    rgbValues = new int[bmp.getWidth()][bmp.getHeight()];  

    //Print in LogCat's console each of one the RGB and alpha values from the 4 corners of the image  
    //Top Left  
    Log.i("Pixel Value", "Top Left pixel: " + Integer.toHexString(bmp.getPixel(0, 0)));  
    //Top Right  
    Log.i("Pixel Value", "Top Right pixel: " + Integer.toHexString(bmp.getPixel(31, 0)));  
    //Bottom Left  
    Log.i("Pixel Value", "Bottom Left pixel: " + Integer.toHexString(bmp.getPixel(0, 31)));  
    //Bottom Right  
    Log.i("Pixel Value", "Bottom Right pixel: " + Integer.toHexString(bmp.getPixel(31, 31)));  

    //get the ARGB value from each pixel of the image and store it into the array  
    for(int i=0; i < bmp.getWidth(); i++)  
    {  
        for(int j=0; j < bmp.getHeight(); j++)  
        {  
            //This is a great opportunity to filter the ARGB values  
            rgbValues[i][j] = bmp.getPixel(i, j);  
        }  
    }  

    //Do something with the ARGB value array  
}  
}  

} 
```

我似乎无法弄清楚这行代码做了什么 bmp = BitmapFactory.decodeResource(getResources(), R.drawable.four_colors);
当我尝试实现它时，eclipse 会说它找不到four_colors 是什么，我不知道它是什么并且似乎无法弄清楚。小伙伴们知道是什么吗？以及应该如何使用？预先感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-16T22:06:56.970

R 是一个自动生成的文件，用于跟踪项目中的资源。可绘制意味着资源是可绘制类型，通常（但不总是）意味着资源位于您的 - 文件夹之一中`res/drawables`，例如`res/drawables_xhdpi`. Four_colors 指的是资源名称，通常表示您所指的文件是一个名为“four_colors”的文件（例如PNG 文件），位于res/drawables-xhdpi 文件夹中。

因此，four_colors 指的是（在这种情况下）您的应用程序尝试加载的可绘制对象的名称。

当 Eclipse 说它找不到资源时，这意味着该资源没有包含在应该包含它的项目中。例如，您复制了一些代码，但没有复制代码中提到的可绘制对象。

这条线`BitmapFactory.decodeResource(...)`完全按照它所说的去做；它将编码的图像解码为位图，这是 Android 可以实际显示的。通常，当您使用位图时，它会在后台进行这种解码；这里是手动完成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T02:54:12.903

您需要下载[此](http://www.41post.com/uploads/2011/04/four_colors.png)图像并将其放入您的`./res/drawable`文件夹中。请务必右键单击该项目并选择刷新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-10T17:24:21.937

Four_colors 是图像的名称。你必须将图像放在 res / drawable 图像应该有名称four_colors.jpg

# jquery - jquery / jquery.ui 的 google.load 过时了吗？

> ID：12451114
> 
> 赞同：4
> 
> 时间：2012-09-16T22:03:09.050
> 
> 标签：jquery, jquery-ui

我刚刚从 Google js.api 与 google.load 进行了一次奇怪的磨合，并加载了 jquery 和 jquery-ui。

当我使用 google.load

```
google.load('jquery', '1.7.1');
google.load('jqueryui', '1.8.17') 
```

这些版本是我能得到的最高版本，否则它会抛出“错误：模块：'jquery' 版本'1.8.1'未找到！” 和类似的。

但是，它可以将文件包含在脚本标签中：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.js"></script> 
```

在[Google Hosted Libraries](https://developers.google.com/speed/libraries/devguide)上没有提到 google.load 作为替代方案，尽管我可以发誓前一段时间有一个。但是，在[Google Loader](https://developers.google.com/loader/)上，该示例中仍然包含 jquery 和 jquery-ui。谷歌忘记更新页面了吗？如果您不应该再加载带有负载的库，那么这个更改是什么时候引入的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T22:08:34.263

试试这个：

```
google.load("jquery", "1.7.1"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T01:03:11.257

正确，jquery 1.8 不在 Google Loader 中

如果您直接访问[https://www.google.com/jsapi](https://www.google.com/jsapi)，您将在底部看到所有受支持的版本，并且 1.8.1 不存在。

# opengl - OpenGL中的颜色减淡

> ID：12451115
> 
> 赞同：2
> 
> 时间：2012-09-16T22:03:18.160
> 
> 标签：opengl, color-blending

我需要在 OpenGL 的背景上渲染图像，我试图获得与 Photoshop 中的“颜色减淡”相同的结果，但我无法做到。

现在我正在做：

```
glEnable(GL_BLEND);
glBlendFunc(GL_SRC_ALPHA, GL_ONE);

// background
glEnable(GL_TEXTURE_2D);
glBindTexture(GL_TEXTURE_2D, background);
glBegin(GL_TRIANGLE_STRIP);
glTexCoord2f(0.0, 0.0);
...
glEnd();
glDisable(GL_TEXTURE_2D);

// image
glEnable(GL_TEXTURE_2D);
glBindTexture(GL_TEXTURE_2D, image);
glBegin(GL_TRIANGLE_STRIP);
glTexCoord2f(0.0, 0.0);
...
glEnd();
glDisable(GL_TEXTURE_2D); 
```

背景是没有 Alpha 通道的 tga。图像是带有 alpha 通道的 tga。

这会在背景上渲染带有 alpha 的图像，但太亮了。

我读到它应该很简单：

```
glBlendFunc(GL_ONE, GL_ONE); 
```

但是尽管有 alpha 通道，图像仍被渲染为白色方块。

显然我做错了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T23:43:17.780

您将无法使用混合来获得相当于 Photoshop“颜色减淡”效果的效果。这是一个比使用标准混合逻辑更复杂的数学函数。所以你必须想出一些程序化的混合方法来使它工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-23T11:11:58.970

有一种方法可以在 GL blend func 中进行颜色减淡。它就像那个混合模式的 Photoshop 版本，但它比 Photoshop 的“颜色减淡”更暗。您必须使用这种类型的功能：

```
glBlendFunc(GL_DST_COLOR, GL_ONE); 
```

# python - 打印列表，包含另一个列表中的值

> ID：12451117
> 
> 赞同：0
> 
> 时间：2012-09-16T22:03:35.947
> 
> 标签：python, arrays, list

对不起，如果这个问题措辞尴尬。我想做的是：

我有一个清单。

```
standardpizzalist = ["1\. Supreme", "2\. Godfather", "3\. Meatlovers", "4\. Capricosa", "5\. BBQ Chicken", "6\. Prawn Delight", "7\. Basil and Pork",] 
```

客户显示此列表，然后他们输入他们想要的选择，例如。1、3、5 代表 Supreme、Meatlovers 和 BBQ Chicken。这些值也保存在一个列表中：

```
orderedpizzas = [1, 3, 5] 
```

我需要将有序披萨列表显示在屏幕上，但不是打印 1、3 和 5，而是需要它从另一个列表中读取值。例如。1.至尊，3.肉食爱好者，5.烧烤鸡。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T22:07:27.103

你的意思是这样的：

```
>>> for pizza in orderedpizzas: print standardpizzalist[pizza-1]

1\. Supreme
3\. Meatlovers
5\. BBQ Chicken 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-16T22:08:47.190

我认为你最好使用[字典](http://docs.python.org/tutorial/datastructures.html#dictionaries)来代替：

```
>>> pizza_dict
{1: 'Supreme', 2: 'Godfather', 3: 'Meatlovers', 4: 'Capricosa', 5: 'BBQ Chicken', 6: 'Prawn Delight', 7: 'Basil and Pork'}
>>> pizza_dict[1]
'Supreme'
>>> pizza_dict[3]
'Meatlovers'
>>> pizza_dict[5]
'BBQ Chicken' 
```

然后我们可以使用[列表推导](http://docs.python.org/tutorial/datastructures.html#list-comprehensions)来获取名称：

```
>>> ordered_pizzas = [1,3,5]
>>> names = [pizza_dict[num] for num in ordered_pizzas]
>>> names
['Supreme', 'Meatlovers', 'BBQ Chicken'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T22:11:59.757

```
print ', '.join(standardpizzalist[x-1] for x in orderedpizzas) 
```

会给你一个逗号分隔的订购比萨饼列表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-16T22:15:07.753

使用有序字典。

```
from collections import OrderedDict

pizzas = OrderedDict()
pizzas[1] = 'Supreme'
pizzas[2] = 'Godfather'
...etc... 
```

因此，当您遍历项目时，会保留顺序（与常规字典不同）：

```
for index, pizza in pizzas.items():
    print pizza      # First prints 'Supreme', then 'Godfather', etc... 
```

# python - python中的简单交换，概念混乱

> ID：12451124
> 
> 赞同：0
> 
> 时间：2012-09-16T22:04:34.290
> 
> 标签：python

所以我已经毕业并获得了 Compsci 学位的所有学分。但是我上个季度的教授刚刚给我发了一封电子邮件，说他在我的一个家庭作业中发现了一些有趣的东西。我忘记了上下文，但我认为这并不重要。我会发布电子邮件交换。

* * *

发件人：PROF
收件人：ME
主题：RE：LDA

嗨，学生，
我注意到您的一个作业答案中有一些奇怪的地方：

```
def swap(i,j):
    tmp = i
    i = j
    j = tmp
    return i,j 
```

这行得通，但它有什么问题？

* * *

从：ME
到：PROF
主题：RE：LDA

哦，是的，我在用 C 语言思考，难道它不能在 python 中工作：

```
def swap(i,j): 
    i,j = j,i
    return i,j 
```

然后 Python 将优化堆栈上的交换，完全消除对 tmp 变量的需要。

* * *

发件人：PROF
收件人：ME
主题：RE：LDA

这是真的，但有一个更微妙的概念混淆

所以我的问题是：我在这里缺少什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-16T22:09:46.313

想想如何`swap`在 Python 中调用，与如何在 C 中调用交换函数。

例如，在 C 中，

```
swap(&a, &b); 
```

`a`是有效的并将内存与内存交换`b`（假设实现`swap`是正确的）。

但是，在 Python 中，

```
swap(a, b) 
```

...什么也没做！您必须分配结果：

```
a,b = swap(a,b) 
```

但那你为什么不做

```
a,b = b,a 
```

并完全放弃 swap() 函数？

如果你真正理解了 Python 和 C 的区别，你就能解释为什么 Python 的交换函数不能在不赋值的情况下交换两个变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T22:11:44.093

您的功能似乎过于复杂，当然您可以这样做

def swap(i,j): 返回 j,i

只用一行代码就可以达到同样的效果？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-16T22:15:55.303

他所期待的只是pythonic的交换方式：

```
i, j = j, i 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-16T22:09:51.660

我猜他的观点是，在函数内部根本不需要进行交换 - 因为函数的返回值与传入的值无关，所以这也可以：

```
def swap(i, j):
    return j, i 
```

所以实际上拥有这个功能没有意义，它根本没有添加任何东西。你必须打电话`i, j = swap(i, j)`- 这与`j, i = i, j`.

# ios - AFHTTPRequestOperation 无响应而不是错误

> ID：12451125
> 
> 赞同：2
> 
> 时间：2012-09-16T22:05:02.810
> 
> 标签：ios, xcode, nsurl, nsurlrequest, afnetworking

我正在使用 AFHTTPRequestOperation 来解析几个 HTML 页面。我遇到的问题是，如果我使用了错误的端口号，例如，当连接到服务器时，“失败”错误块不会触发。相反，完成块触发但响应字符串为零。我只是从 ASIHTTP 切换到 AFNetworking，而使用 ASIHTTP 这会产生错误。

当然这应该提供一个错误？我怎么能抓住这个？

```
 NSString *urlString;
    urlString = [NSString stringWithFormat:@"%@://%@:%@/",kHttp,_IP,_Port];
    NSURL *url = [NSURL URLWithString:urlString];

    // Set authorization
    AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:url];
    [httpClient setAuthorizationHeaderWithUsername:_User password:_Pass];

    NSURLRequest *request = [httpClient requestWithMethod:@"POST" path:@"Info.htm" parameters:nil];
    AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];
    [operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
        if ([self parseInfoLive:operation.responseString])
            _count_parsed++;
        if (_count_parsed == 2)
            [[NSNotificationCenter defaultCenter] postNotificationName:@"downloadsComplete" object:nil];
    }
                                     failure:^(AFHTTPRequestOperation *operation, NSError *error) {
                                         NSLog(@"Error during connection: %@",error.description);
                                         [[NSNotificationCenter defaultCenter] postNotificationName:@"errorConnecting" object:nil];
                                     }];
[operation start]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-01T15:40:54.003

这似乎是 AFNetworking 中的一个错误，即使在这个问题之后 2.5 年也是如此。当响应包含特殊字符时会发生这种情况（它可以显示为空格，因为有时甚至文本查看器也无法解析它）。如果需要，您可以尝试将收到的 JSON 字符串转换为 NSUTF8StringEncoding，然后将其用作 NSData。

```
NSURL *url = <YOUR REQUEST URL>
NSString *data = [NSString stringWithContentsOfURL:url];
NSData *metOfficeData = [data dataUsingEncoding:NSUTF8StringEncoding];
NSError *error = [NSError new];
NSDictionary *jsonData = [NSJSONSerialization JSONObjectWithData:metOfficeData options:kNilOptions error:&error]; 
```

# python - 用 BeautifulSoup 中的标签替换 CDATA NavigableStrings

> ID：12451127
> 
> 赞同：2
> 
> 时间：2012-09-16T22:05:16.083
> 
> 标签：python, xml, xml-parsing, beautifulsoup, cdata

我正在用 BeautifulSoup 解析几个 XML 文档提要，并想做一些预处理以用自定义 XML 标记替换非标准`CDATA`标记。为了显示：

以下 XML 源...

```
<title>The end of the world as we know it</title>
<category><![CDATA[Planking Dancing]]></category>
<pubDate><![CDATA[Sun, 16 Sep 2012 12:00:00 EDT]]></pubDate>
<dc:creator><![CDATA[Bart Simpson]]></dc:creator> 
```

...会变成：

```
<title>The end of the world as we know it</title>
<category><myTag>Planking Dancing<myTag></category>
<pubDate><myTag>Sun, 16 Sep 2012 12:00:00 EDT<myTag></pubDate>
<dc:creator><myTag>Bart Simpson<myTag></dc:creator> 
```

我认为之前没有在 SO 上问过这个问题（我尝试了一些不同的 SO 查询）。我还尝试了几种不同的方法，使用`.findAll('cdata', text=True)`BeautifulSoup[`replaceWith()`](http://www.crummy.com/software/BeautifulSoup/bs3/documentation.html#Replacing%20one%20Element%20with%20Another)方法并将其应用于每个结果`NavigableString`。我所做的尝试要么没有替换，要么看起来像一个递归循环。

我很高兴发布我以前的尝试，但鉴于这里的问题非常简单，我希望有人可以发布一个清晰的示例，说明如何使用 BeautifulSoup 3 完成上述搜索和替换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T03:13:07.793

`CData`是 的子类`NavigableString`，因此您可以`CData` 通过首先搜索所有`NavigableString`对象，然后测试每个对象是否是 的实例来找到所有元素`CData`。一旦你有了一个，它可以很容易地用 替换`replaceWith`，正如你所建议的：

```
>>> from BeautifulSoup import BeautifulSoup, CData, Tag
>>> source = """
... <title>The end of the world as we know it</title>
... <category><![CDATA[Planking Dancing]]></category>
... <pubDate><![CDATA[Sun, 16 Sep 2012 12:00:00 EDT]]></pubDate>
... <dc:creator><![CDATA[Bart Simpson]]></dc:creator>
... """
>>> soup = BeautifulSoup(source)
>>> for navstr in soup(text=True):
...     if isinstance(navstr, CData):
...         tag = Tag(soup, "myTag")
...         tag.insert(0, navstr[:])
...         navstr.replaceWith(tag)
... 
>>> soup

<title>The end of the world as we know it</title>
<category><myTag>Planking Dancing</myTag></category>
<pubdate><myTag>Sun, 16 Sep 2012 12:00:00 EDT</myTag></pubdate>
<dc:creator><myTag>Bart Simpson</myTag></dc:creator>

>>> 
```

几点注意事项：

*   你可以像调用一个`BeautifulSoup`函数一样调用一个对象，效果和调用它的`.findAll()`方法是一样的。

*   我知道`CData`在 BS3 中获取对象内容的唯一方法是对其进行切片，如上面的片段所示。`str(navstr)`会保留所有 `<![CDATA[...]]>`垃圾，这显然是您不想要的。在 BS4 中，`str(navstr)` 为您提供没有垃圾的内容。

# ruby-on-rails - 在 rails_admin 中禁用关联

> ID：12451128
> 
> 赞同：1
> 
> 时间：2012-09-16T22:05:18.970
> 
> 标签：ruby-on-rails, mongoid, rails-admin

是否可以完全禁用特定模型关联的使用`rails_admin`？

我有一个包含数千个关联对象的模型，似乎在 rails admin 中让它们可见/启用会导致数据库阻塞。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T08:15:42.363

```
config.model 'ParentModel' do
  configure :my_association do
    hide
    # for list view
    filterable false
    searchable false
  end

  # rest of your ParentModel configuration
end 
```

那应该这样做。

或者，如果您排除关联模型 ( `config.excluded`)，关联也不会显示。

# algorithm - 二叉搜索树更新

> ID：12451130
> 
> 赞同：1
> 
> 时间：2012-09-16T22:05:41.237
> 
> 标签：algorithm, tree, binary-search-tree

我正在开发一个需要将值存储在二叉搜索树中的应用程序。它有点类似于通过将每一行存储为带有某个键的值来实现文本板的应用程序。如果删除了一行，则在 O(n) 中更新之后行的键。通过考虑类似于行号（在示例中）的参数作为键，我能够在我的应用程序中实现 O(n) 时间。

有没有办法通过选择其他键来实现 O(log n) 时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T22:09:10.457

如果您需要`O(logN)`二叉树的性能保证，您应该使用自平衡版本，例如[Splay Tree](http://en.wikipedia.org/wiki/Splay_tree)或[Red black tree](http://en.wikipedia.org/wiki/Red%E2%80%93black_tree)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T22:23:45.850

如果您的要求是插入/更新、删除和搜索，请尝试`Hash Table`使用良好的哈希函数。`unordered_map`许多语言在 C++、`dict`python、 javascript 中提供哈希表实现`{}`......哦，顺便说一句，您可以自己编写一个。

您也可以尝试一些平衡的 bst，`O(log(n))`例如红黑树、avl 树、2-3 棵树。

# api - 给定名称的一部分，如何从 Freebase 获取 id？

> ID：12451133
> 
> 赞同：1
> 
> 时间：2012-09-16T22:05:56.067
> 
> 标签：api, freebase

当我去[Freebase.com](http://www.freebase.com/)并搜索`bush`（例如）时，我会收到诸如此类的建议`George Bush, Kate Bush, George H.W. Bush`。

如何从查询 api 中获取该列表作为 ID？

我正在尝试获取特定名称的 id 列表，如下所示：

```
[{
 "id": null,
 "name": "bush",
}] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T23:26:44.990

您可以使用搜索 API

```
https://www.googleapis.com/freebase/v1/search?query=bush 
```

或者如果您想使用 MQL，可以使用包含运算符 (~=)

```
https://www.googleapis.com/freebase/v1/mqlread?query=[{%22name~=%22:%20%22bush%22,%20%22id%22:null}] 
```

contains 运算符默认进行全词匹配。如果您想要部分单词匹配，您可以添加额外的通配符，但您可能会遇到超时，特别是对于前导通配符。

```
https://www.googleapis.com/freebase/v1/mqlread?query=[{%22name~=%22:%20%22*bush*%22,%20%22id%22:null}] 
```

# php - 如何使用另一个文件中的图像更改背景？

> ID：12451136
> 
> 赞同：3
> 
> 时间：2012-09-16T22:06:25.163
> 
> 标签：php, javascript, ajax, background, onclick

我正在制作一个网站来跟踪我的电影收藏。我有一个名为“list.php”的页面，其中列出了我所有的电影标题。每个标题都是可点击的。当您单击电影时，ajax 函数将从另一个名为 getmovie.php 的文件中检索有关电影的信息。然后一个 div 展开并且信息被放置在展开的 div 中。那很容易做。为了使网站更漂亮，我想将 list.php 的背景切换为“点击”电影的海报。数据库存储了这张海报的路径，getmovie.php 会得到它。但是如何将 list.php 中的背景更改为存储在 getmovie.php 中的路径？

基本上我有一个变量，其中包含我想在另一个文件中设置为背景的图像的路径。我应该如何编码？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T22:44:48.537

当我用不同的方法测试时，不可能从另一个页面设置页面的背景。但是，您可以从页面本身设置图像。你应该做 2 个 ajax。首先你应该用一个简单的 ajax 来获取文本，因为你已经这样做了。其次获取背景。编写一个获取电影输入并仅在浏览器中显示图像 url 的 php 脚本，然后执行 ajax 并使用检索到的 url 设置新页面的背景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T22:17:00.240

我认为您可以在调用 ajax 函数时使用 javascript 来更改 document.body.background。例如，在 playMovie() 函数中：

```
document.body.background = "images/movie01.jpg"; 
```

希望它有用。

# c# - 在此示例中，在主线程上执行的 Windows.Forms.Form 上调用的操作？

> ID：12451138
> 
> 赞同：1
> 
> 时间：2012-09-16T22:06:51.030
> 
> 标签：c#, multithreading

我正在尝试用 C# 编写一个服务器，并且有一个关于线程委托和通信的基本问题。

```
 using System.Windows.Forms;

// main thread..
callbackform = new Form();
callbackform.createControl();
int dummy = callbackform.Handle.ToInt32();

// here I create a new thread to connect to a server and handle messages from server

// main thread loops indefinitely
Application.run(new ApplicationContext()); 
```

现在，Form 实现了 ISynchronizeInvoke 接口。因此，如果我想在主 STA 线程上同步或异步执行方法，我可以使用 callbackform.InvokeRequired/BeginInvoke/EndInvoke/Invoke(...) 函数吗？

Form/Control/Handle 对象是否创建新线程，在这种情况下它们管理的线程与主线程不同，并且我委托给 Form 的操作实际上不会在主 STA 线程上执行？

这是正确的理解还是我在这里遗漏了一些基本的东西？我开始使用 C# 编写非 GUI 服务器。

# wordpress - WordPress wp_nav_menu()

> ID：12451139
> 
> 赞同：0
> 
> 时间：2012-09-16T22:06:52.087
> 
> 标签：wordpress, wordpress-theming

我正在尝试构建一个 WordPress 菜单，但在删除给 li 的默认 ID 时遇到了麻烦。我已经成功地使用 $menu_id 和 $menu_class 重命名了 ul id 和类，但在 li 的情况下似乎无法弄清楚。

我需要我的菜单看起来像

```
<ul id="menubar">   
<li><a href="/" class="main home active">Home</a></li>
    <li><a href="About_us" class="main about-us">About Us</a></li>
<li><a href="Mission" class="main mission">Mission</a></li>
</ul> 
```

代替

```
<ul id="menubar" class="">
     <li id="menu-item-7" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-4 current_page_item menu-item-7"><a href="#">Test</a></li> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T22:17:46.860

看看`nav_menu_item_id`过滤器。在`wp-includes/nav-menu-template.php`中，它的使用如下：

```
 $id = apply_filters( 'nav_menu_item_id', 'menu-item-'. $item->ID, $item, $args );
    $id = $id ? ' id="' . esc_attr( $id ) . '"' : '';

    $output .= $indent . '<li' . $id . $value . $class_names .'>'; 
```

这意味着您只需添加一个函数来返回一个“虚假”值，以防止生成 ID 属性。为此，只需将以下内容添加到您的主题中`functions.php`：

```
function mytheme_remove_nav_menu_item_id( $id ) {
    return false;
}
add_filter( 'nav_menu_item_id', 'mytheme_remove_nav_menu_item_id' ); 
```

# ruby-on-rails-3 - 如何在 Heroku 上托管的自定义域上修复 Firefox 默认为 https 的 Rails 应用程序

> ID：12451144
> 
> 赞同：1
> 
> 时间：2012-09-16T22:07:20.550
> 
> 标签：ruby-on-rails-3, firefox, ssl, heroku, https

我在 Heroku 上托管了一个带有自定义域的 ruby​​ on rails 3 应用程序。它使用 oauth 来允许用户通过 Facebook 登录。用户通过 Facebook 登录后，下次他们在 Firefox 中输入我们的域（在 Mac 上在 FF 15.0.1 上测试）时，它会自动在地址前填写 https（因此用户习惯于在其中输入“example.com”地址栏并按 ENTER，但 Firefox 将其更改为[https://www.example.com](https://www.example.com)）。这当然会显示“此连接不受信任”警告页面（[http://support.mozilla.org/en-US/kb/connection-untrusted-error-message](http://support.mozilla.org/en-US/kb/connection-untrusted-error-message)），因为我们没有 SSL 证书而不是加载我们的页。

这似乎只发生在 Firefox 上（也在 Chrome 和 Safari 上测试过）。

我尝试使用此示例（[http://captico.com/securing-specific-routes-in-rails-3/2011/02](http://captico.com/securing-specific-routes-in-rails-3/2011/02)）将我们指向 root 的 rails 操作重定向到 http 协议版本，但是没用。我还尝试添加 ssl_requirement gem ( [https://github.com/bartt/ssl_requirement](https://github.com/bartt/ssl_requirement) ) 并排除我们指向根域的操作，但后来我得到了一个错误的 URI 错误。

我们现在正处于省钱模式，因为我们正在测试网站并慢慢增加用户。我相信最好的办法是为我们自己的 SSL 证书支付费用，以及每月向 heroku 支付 20 美元来为我们的自定义域获取 SSL。但就目前而言，我们希望避免产生这些额外费用。

有没有办法免费解决这个问题？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-16T23:24:36.433

要免费修复它，请使用 *.herokuapp.com 域而不是自定义域。

# java - 计算物体的角度和余弦值

> ID：12451146
> 
> 赞同：-1
> 
> 时间：2012-09-16T22:07:31.347
> 
> 标签：java

> 我需要计算余弦 theta 的值，并且我还需要最终找到机器人当前位置和它移动的新位置之间的角度值。θ 值。

```
import java.io.IOException;
import java.lang.reflect.Method;
import mrds_project.Path;
import mrds_project.Pose;
import mrds_project.controller.Controller;
import java.lang.Math;

public class NaiveStrategy implements PathStrategy {

private final Controller controller;

private NaiveStrategy() {

}
public NaiveStrategy(Controller controller) {
    this.controller = controller;
}

@Override
public void move(Path path) {
    for (Pose target : path) {
                    Pose currentPose = controller.getPose();
        double[] targetPoint = target.getPosition().getVector();
                    double targetVectorX;
                    double targetVectorY;
                    double currentVector;
                    targetVectorX = targetPoint[0] - currentPose.getPosition().getVector()[0];
                    targetVectorY = targetPoint[1] - currentPose.getPosition().getVector()[1];
    }
}
    public double dotPro1(double[] vectorA, double[] vectorB){
        double[] vecPro;
        vecPro = new double[2];
        vecPro[0] = vectorA[0]*vectorB[0];
        vecPro[1] = vectorA[1]*vectorB[1];
        return vecPro[0] + vecPro[1];
    }
    public double dotPro2(double[] length){
        double[] lenPro;
        lenPro = new double[1];
        lenPro[0] = length[0];
        return lenPro[0];
    }
    public static double cosine(double a) throws IOException, ClassNotFoundException{
        double x = Math.cos(Math.toRadians(a));
        Class c = Class.forName("NaiveStrategy");
        Class methodTypes[] = new Class[3];
        methodTypes[0] = Double.TYPE;
        methodTypes[1] = Double.TYPE;
        methodTypes[2] = Double.TYPE;
        Method[] m = c.getMethods();
        NaiveStrategy ns = new NaiveStrategy();
        Object arg[] = new Object[3];
        arg[0] = new Double(50);
        arg[1] = new Double(50);
        arg[2] = new Double(50);
        Object o = m.ns(ns, arg);
        return 0;  
    }
} 
```

我需要知道这个问题的答案，我在构造函数中遇到错误，我知道为什么是因为“变量控制器可能没有初始化”。在 return 语句之前的最后一行出现错误，我不知道，它说“找不到符号”

```
Controller.java
package mrds_project.controller;

import mrds_project.Pose;

public interface Controller {
void setVelocity(int linear, int angular);
public Pose getPose();

}
Pose.java
package mrds_project;

import java.util.Map;

public class Pose {
private final Quaternion orientation;
private final Quaternion position;

public Pose(Map<String, Object> mrdsmap)
{
Map<String, Object> orientationMap = (Map<String, Object>) mrdsmap.get("Orientation");
double w = (Double) orientationMap.get("W");
double x = (Double)orientationMap.get("X");
double y = (Double)orientationMap.get("Y");
double z = (Double)orientationMap.get("Z");
orientation = new Quaternion(w, x, y, z);
Map<String, Object> positionMap = (Map<String, Object>) mrdsmap.get("Position");
double x1 = (Double)positionMap.get("X");
double y1 = (Double)positionMap.get("Y");
double z1 = (Double)positionMap.get("Z");
position = new Quaternion(x1, y1, z1);
}

public Quaternion getOrientation() {
return orientation;
}

public Quaternion getPosition() {
return position;
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T22:17:33.697

你不能有一个未分配的最终变量

```
private final Controller controller; 
```

*和*一个默认构造函数 - 编译器将防止未分配的变量。删除`final`关键字将允许您保留 2 个构造函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T22:20:45.727

改变

```
Object o = m.ns(ns, arg); 
```

至

```
Object o = m.invoke(ns, arg); 
```

但是你为什么还要使用反射呢？为什么不使用

```
 public static double cosine(double a) {
        double x = Math.cos(Math.toRadians(a));
        NaiveStrategy ns = new NaiveStrategy();
        ns.YourMethodHere(50, 50, 50);
        return 0;  
    } 
```

# .htaccess - .htaccess 如果文件不存在，则执行其他操作

> ID：12451148
> 
> 赞同：0
> 
> 时间：2012-09-16T22:07:42.073
> 
> 标签：.htaccess

我们将 .htaccess 与锚标记结合使用来提供文件并隐藏服务器目录结构。

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /_docu/clients/$1/$2/$3.pdf [NC,L] 
```

例如，所有文件都存储在`/public_html/_docu/clients/`该文件夹下和内部，列出了所有客户端，然后在每个客户端下列出了他们的项目。但是，文件的锚标记将只读：

`http://mydomain.com/client-name/proj-name/docname.pdf`

（ /_docu/clients/ 被省略 - 这是有充分理由的）。上面的 .htaccess 抓取`client-name`,`proj-name`并`docname`从正确的文件夹中提供它：

`http://mydomain.com/_docu/clients/client-name/proj-name/docname.pdf`

同时在地址栏中保留不正确（隐藏）的目录结构。

**我希望处理不存在的文档的错误情况。**这不应该发生，但它可能发生。任何人都可以提出处理这个问题的方法吗？可以在 .htaccess 文件中以某种方式构造类似于“if fileexist($1/$2/%3.pdf)”的功能吗？

* * *

编辑：

延迟响应作为 JL 在下面的答案需要研究和实验。谢谢，乔恩，在正确的方向上轻轻推动，但我还没有让它工作。这是我尝试过的：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
# check if the requested file exists in the "_docu/clients" directory
RewriteCond %{DOCUMENT_ROOT}/_docu/clients/$1/$2/$3.pdf -f
RewriteRule ^([a-z0-9])/([a-z0-9])/([a-z0-9]*).pdf$ /_docu/clients/$1/$2/$3.pdf [NC,L]
RewriteRule ^(.*)$ /errors/404.php [L] 
```

我*认为*应该做的是：

1.  如果`http://mydomain.com/_docu/clients/$1/$2/$3.pdf`不存在，
2.  转到页面`http://mydomain.com/errors/404.php`

实际结果是“内部服务器错误”消息。

* * *

编辑二：

最新变化：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} ^/([a-z0-9])/([a-z0-9])/([a-z0-9]*).pdf$
RewriteCond %{DOCUMENT_ROOT}/_data/cli/%1/%2/%3.pdf -f
RewriteRule ^([a-z0-9])/([a-z0-9])/([a-z0-9]*).pdf$ /_data/cli/$1/$2/$3.pdf [NC,L]
RewriteCond %{ENV:REDIRECT_STATUS} !200
RewriteRule ^(.*)$ /metshare/404.php [L] 
```

这个问题是合法页面也被定向到 404.php

给未来读者的信息：

Jon Lin 的最终回答中解决了上述所有问题。当发现问题时，他修改了他的答案，直到它成为一个完美的、有效的解决方案。我将保留上述内容，因为对于那些想要比较版本的人来说，里面有一些很好的 ULO（计划外的学习机会）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:45:59.170

您需要使用这样的条件：

```
RewriteCond %{DOCUMENT_ROOT}/_docu/clients%{REQUEST_URI} -f 
```

所以你的规则看起来像：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
# check if the requested file exists in the "_docu/clients" directory
RewriteCond %{DOCUMENT_ROOT}/_docu/clients%{REQUEST_URI} -f
RewriteRule ^ /_docu/clients%{REQUEST_URI} [L] 
```

* * *

编辑：回复有问题的编辑

你不能这样做：

```
RewriteCond %{DOCUMENT_ROOT}/_docu/clients/$1/$2/$3.pdf -f 
```

因为 $1/$2/$3 的反向引用还不存在，它们在 your 的分组中匹配，此时`RewriteRule`还没有发生。但你可以尝试这样的事情：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
# check if the requested file exists in the "_docu/clients" directory
RewriteCond %{REQUEST_URI} ^/([a-z0-9])/([a-z0-9])/([a-z0-9]*).pdf$
RewriteCond %{DOCUMENT_ROOT}/_docu/clients/%1/%2/%3.pdf -f
RewriteRule ^([a-z0-9])/([a-z0-9])/([a-z0-9]*).pdf$ /_docu/clients/$1/$2/$3.pdf [NC,L]

RewriteCond %{ENV:REDIRECT_STATUS} !200
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /errors/404.php [L] 
```

`%{REQUEST_URI}`本质上是在前面创建一个匹配，`RewriteCond`然后`%N`在下面使用反向引用`RewriteCond`。

# jquery - 由于 Internet Explorer，使用 bing 和 google 进行地理定位

> ID：12451150
> 
> 赞同：0
> 
> 时间：2012-09-16T22:08:11.500
> 
> 标签：jquery, html, geolocation

嗨，我目前正在玩地理定位，它适用于除 IE 之外的所有内容，因为它似乎不支持 Google 并且想使用 Bing 有没有人知道如何使 IE 友好的方向......它已经困扰我好几天了！

这是我的代码：

```
function fallback() {
    var myOptions = {
        center: new google.maps.LatLng(51.43255949795703, - 0.461750328540802),
        zoom: 14,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    var map = new google.maps.Map(document.getElementById("Map_Canvas"),
    myOptions);

    var markerPos = new google.maps.LatLng(51.43255949795703, - 0.461750328540802);
    var marker = new google.maps.Marker({
        position: markerPos,
        map: map,
        title: "The Harpers Hairdressing"
    });
}

function initGeolocation() {
    if (navigator.geolocation) {
        // Call getCurrentPosition with success and failure callbacks 
        navigator.geolocation.getCurrentPosition(success, fail);
    } else {
        fallback()
    }
}
var directionDisplay;
var directionsService = new google.maps.DirectionsService();
var map;

function success(position) {
    directionsDisplay = new google.maps.DirectionsRenderer();
    coords = new google.maps.LatLng(position.coords.latitude,
    position.coords.longitude);
    var myOptions = {
        zoom: 12,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        center: coords
    }
    map = new google.maps.Map(document.getElementById("Map_Canvas"),
    myOptions);
    directionsDisplay.setMap(map);
    calcRoute();
}

function calcRoute() {
    var start = coords;
    var end = new google.maps.LatLng(51.43255949795703, - 0.461750328540802);
    var request = {
        origin: start,
        destination: end,
        travelMode: google.maps.TravelMode.DRIVING
    };
    directionsService.route(request, function (result, status) {
        if (status == google.maps.DirectionsStatus.OK) {
            directionsDisplay.setDirections(result);
        }
    });
}

function fail() {
    fallback();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:37:08.647

快速搜索显示 IE9 应该支持地理定位，但它不如其他浏览器准确。对于 IE8 和更早版本，您似乎必须使用“polyfill”，例如[Webshims](http://afarkas.github.com/webshim/demos/demos/geolocation.html)。

# c# - 将 C# 字符串转换为与 Oracle 日期格式匹配的日期类型

> ID：12451151
> 
> 赞同：0
> 
> 时间：2012-09-16T22:08:18.023
> 
> 标签：c#, asp.net, sql, oracle

我正在尝试编写通过 C#/ASP.NET 程序执行的 Oracle SQL 查询，以将数据插入 Oracle Db。我在查找 C# 方法时遇到问题，该方法将转换字符串（来自格式为 2012 年 11 月 11 日的表单的用户输入）以匹配 Oracle 的日期数据类型。我尝试通过[Convert.ToDateTime(object) 方法](http://msdn.microsoft.com/en-us/library/ky38w316.aspx)进行转换，但没有成功。

这是我的代码：

```
<%@ Page Language="C#" Debug="true" %>
<%@ Import Namespace="System.Data" %>
<%@ Import Namespace="System.Data.OleDb" %>
<script runat="server">

   void Page_Load(Object sender, EventArgs e) {

       //Get user's input form form fields
       var saleID = Convert.ToInt32(Request.Form["saleID_aspx"]);
       var custID = Convert.ToInt32(Request.Form["custID_aspx"]);
       var agentID = Convert.ToInt32(Request.Form["agentID_aspx"]);
       var saleDate = Convert.ToDateTime("11/11/2012"); //Originally Request.Form["saleDate_aspx"]
       var homeID = Convert.ToInt32(Request.Form["homeID_aspx"]);
       var actualAmount = Convert.ToInt32(Request.Form["actualAmount_aspx"]);
       var contractID = Convert.ToInt32(Request.Form["contractID_aspx"]);
       var valueCommand = "VALUES(" + saleID + "," + custID + "," + agentID + "," + saleDate + "," + contractID + "," + homeID + "," + actualAmount + ")";
      // Declaration section
      OleDbConnection objDBConn;
      OleDbCommand    objCmd;
      OleDbCommand objCmdSelect;
      OleDbDataReader objDR;

      // Set up OLE DB Connection object
      objDBConn = new OleDbConnection("Provider=*****1;" +
                                      "User ID=********;" +
                                      "Password=*******;" +
                                      "Data Source=****");

      // Open DB connection
      objDBConn.Open();

      // Create OleDbCommand object with SQL to execute
      objCmd = new OleDbCommand("INSERT INTO Sale (saleID, cust_ID, agent_ID, saleDate, contractID, homeID, actualamount)" +
            valueCommand, objDBConn);

      // Create a DataReader and execute the command
      objDR = objCmd.ExecuteReader();

      // Copy results from DataReader to DataGrid object
      gridCusts.DataSource = objDR;
      gridCusts.DataBind();

      // Close all objects
      objDR.Close();
      objCmd.Dispose();

      ////////////////////////////////////////////////////////////
      // Create OleDbCommand object with SQL to execute
      objCmdSelect = new OleDbCommand("SELECT * " +
                                "  FROM Sale " +
                                " ORDER BY saleID", objDBConn);

      // Create a DataReader and execute the command
      objDR = objCmdSelect.ExecuteReader();

      // Copy results from DataReader to DataGrid object
      gridCusts.DataSource = objDR;
      gridCusts.DataBind();

      // Close all objects
      objDR.Close();
      objCmdSelect.Dispose();
      /////////////////////////////////////////////////////////// 
      objDBConn.Close();        
   }

</script>
<html>
<head>
<title>CUSTOMERS table</title>
<link href="bootstrap/css/bootstrap.css" type="text/css" rel="stylesheet">
</head>
<body>
    <div id="container">
        <h2>Oracle SALES table contents via C#.NET and OLE DB</h2>
        <div style="margin:0 auto text-align:center;">
            <asp:DataGrid id="gridCusts" class='table' runat="server" />
        </div>
        <a href="index.html" target="_self" class="btn">Go Back</a>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T22:16:15.257

您可以简单地使用 oracle 函数`to_date`。

```
var valueCommand = "VALUES(" + saleID + "," + custID + "," + agentID + ", 
    to_date('" + saleDate.ToString("MM/dd/yyyy") + "', 'mm/dd/yyyy')," + contractID + "," + homeID + "," + actualAmount + ")"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T03:17:51.333

我在您的代码中看到了许多导致程序失败的问题。

1.  导致[类型转换、转义和 SQL 注入问题](http://msdn.microsoft.com/en-us/magazine/cc163917.aspx)的硬编码 SQL 字符串。[如何：防止 ASP.NET 中的 SQL 注入](http://msdn.microsoft.com/en-us/library/ff648339.aspx)
2.  命令方法的选择 - 何时使用 ExecuteNonQuery、ExecuteScalar 和 ExecuteReader？调用`ExecuteNonQuery()`方法来执行除`SELECT`.
3.  处理数据库资源的方式不正确。使用[using](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)块。（SO Threads -[什么是 C# Using 块，我为什么要使用它？](https://stackoverflow.com/questions/212198/what-is-the-c-sharp-using-block-and-why-should-i-use-it)和[C# - 关闭 Sql 对象最佳实践](https://stackoverflow.com/questions/328005/c-sharp-closing-sql-objects-best-practice)。

# css - 我的侧边栏越过了页脚。我该如何解决这个问题？

> ID：12451155
> 
> 赞同：1
> 
> 时间：2012-09-16T22:08:43.493
> 
> 标签：css, wordpress, positioning, footer, sidebar

我有一个内容区和一个侧边栏。我的内容区很好。当我通过 WordPress 添加博客文章时，内容区域会扩展并且不会超出页脚。我的侧边栏很好，但只有当内容区域比侧边栏长时。当内容区域较短时，侧边栏会越过页脚。

我想知道为什么侧边栏没有像内容那样将页脚向下推。我已经调用了 php get_sidebar(); 在内容 div 里面，所以我不确定问题是什么。我猜这与绝对定位有关。我尝试将侧边栏定位到相对位置，但随后内容区域被向下推，并且有很大的边距，所以把它搞砸了。

这是本节元素的 CSS：

```
html, body {
height: 100%;
}

#wrapper {
min-height: 100%;
position: relative;
}

#container{
width: 960px;
position: relative;
left: 50%;
margin-left: -480px;
}

#content{
width: 960px;
position: relative;
}

.entry-content{
width: 600px;
}

#sidebar{
width: 200px;
top: 0px;
right: 0px;
margin-right: 0px;
position: absolute;
text-align: right;
}

#footer{
width: 100%;
height: 300px;
bottom: 0px;
} 
```

如果有人设法告诉我如何使它工作，我将不胜感激。我对此感到有些沮丧。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T22:28:24.227

您`position: absolute;`的侧边栏和绝对定位的元素被从文档的正常流程中取出（也就是说，其他元素的行为就像绝对定位的元素不存在一样）。这就是为什么它没有推动页脚。

您可能要考虑浮动它。`float: left;`在您的内容区域或侧边栏上使用`float: right;`，以您的 HTML 中的第一个为准。并添加`overflow: hidden`他们的父母。

# php - 回显 MySQL 变量 (PHP) 返回白页？

> ID：12451160
> 
> 赞同：-2
> 
> 时间：2012-09-16T22:09:24.153
> 
> 标签：php, mysql

我曾经使用过不好的例子，但自从我切换后我解决了它。

解决了我的问题。坏的例子：

```
$currentdj = "SELECT username FROM djsays WHERE current = '1'";

$result = mysql_query($currentdj);  

while($dj = mysql_fetch_row($result))

  echo $dj;
?> 
```

使用好：

```
$mysqli = new mysqli('hostname','user','password','databasename');
if (!$mysqli) {
  // connect failure, check connect_error()
  echo $mysqli->connect_error();
}
else {
  // Call query() to execute your SQL
  $result = $mysqli->query("SELECT * FROM some_table");
  if ($result) {
    // $result is an object of type mysqli_result
    // Call fetch_assoc() on $result
    while ($row = $result->fetch_assoc())
      echo $row['id'];
  }
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T22:15:59.510

您不能只使用 echo 打印一行，它不会作为简单的字符串返回。

```
<?php
$currentdj = "SELECT username FROM djsays WHERE current = '1'";
$result = mysql_query($currentdj);  
while($dj = mysql_fetch_assoc($result))
{
  echo $dj['username'];
}
?> 
```

但是请注意，如果您只是在学习，请帮自己一个忙并[找到一个向您展示如何使用 PDO 的教程](http://www.phpeveryday.com/articles/PHP-Data-Object/PDO-Tutorial-P842.html)，这并不难，但它是最新的，并且对您的代码*更加*安全和可靠。

# awesome-wm - 当鼠标在 Awesome-wm 中触摸屏幕边缘时执行命令

> ID：12451161
> 
> 赞同：2
> 
> 时间：2012-08-17T17:00:44.023
> 
> 标签：awesome-wm

我是在 Awesome 中为 rc.lua 做自定义 lua 的新手，我在弄清楚如何根据鼠标位置启动某些东西时遇到了一些麻烦。到目前为止，这就是我所拥有的，但它没有做任何事情。

```
-- Open todo when mouse hits right screen edge.
todo_timer = timer({timeout = 0.1})
todo_timer:add_signal("todopopup", function()
    if mouse.coords.x >= 3198 then
        scratch.drop("urxvt -e vim /home/ryan/to-do", "center", "right", 0.33, 1, "true")
    end
end)
todo_timer:start()
-- 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T21:46:23.997

您可以/应该使用鼠标抓取器，而不是使用计时器，如下所示：

```
mousegrabber.run(function(mouse)
    if mouse.x > 3196 then
        -- Do your stuff here
    end
    -- Return true, to continue grabbing the mouse
    return true
end) 
```

这种方法的问题是，您一次只能注册一个鼠标抓取器。所以这是一个完美的解决方案，如果您只需要稍等一下鼠标移动。如果您需要更长的时间，您可以在需要抓取器进行其他操作（主要是客户端调整大小和移动）时停止抓取，并在完成后启动它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-18T06:15:07.317

这几乎可以按预期工作。由于某种原因，暂存器第一次出现在屏幕 1 上并且没有正确垂直居中（这个问题只发生在水平位置“正确”的情况下，我认为这是暂存器的问题），对我来说，但它应该适用于人们谁没有多显示器设置或启动您选择的其他命令。

```
-- Open todo when mouse hits right screen edge.
local function todopad()
    scratch.drop("urxvt -e vimpager /home/ryan/to-do", "center", "right", .20, 800, "true", 2)
end

todo_timer = timer({timeout = 1})
todo_timer:add_signal("timeout", function()
    if mouse.coords()["x"] >= 3196 then
        todopad()
    end
end)
todo_timer:start()
-- 
```

# java - 从命令行获取文件名并查看它们是否存在于 Java 中

> ID：12451163
> 
> 赞同：2
> 
> 时间：2012-09-16T22:09:27.517
> 
> 标签：java, file, command-line

因此，以下程序应将输入和输出文件作为命令行参数。我在`java FileCopy input.txt output.txt`命令行上输入运行程序，它应该把文件名放在`args`. 对此进行测试，我在 args 中没有任何值。最重要的是，方法调用`fileExists()`不起作用，我无法弄清楚为什么这些调用没有被执行。请注意，该`getOutputFile`方法不完整，由于上述错误，当前没有执行任何代码。

```
class FileCopy
{
public static void main(String[] args) throws IOException
{
    String infile = null;
    String outfile = null;
    BufferedReader stdin = new BufferedReader(new InputStreamReader(System.in));    

    if (args.length >= 2) //both files given via command line
    {
        infile = args[0];
        if (fileExists(infile) == false)
        {
            infile = getInputFile();
        }
        outfile = args[1];
    }
    else if (args.length == 1) //input file given via command line
    {
        infile = args[0];
        outfile = getOutputFile(infile);
    }
    else //no files given on command line
    {
        infile = getInputFile();
        outfile = getOutputFile(infile);
    }

    //create file objects to use
    File in = new File(infile);
    File out = new File(outfile);

    /*
     *rest of code
     */
}

//get the input file from the user if given file does not exist
public static String getInputFile() //throws IOException
{
    BufferedReader stdin = new BufferedReader(new InputStreamReader(System.in));
    String fileName = null;
    boolean haveFile = false;

    while(haveFile == false)
    {
        System.out.println("Enter a valid filename for input:");
        System.out.print(">> ");
        try
        {
            fileName = stdin.readLine();
        }
        catch (IOException e)
        {
            System.out.println("Caught exception: " + e);
        }
        haveFile = fileExists(fileName);
    }

    return fileName;    
}

//get the output file and test things
public static String getOutputFile(String infile)
{
    BufferedReader stdin = new BufferedReader(new InputStreamReader(System.in));
    File input = new File(infile);
    String filename = null;
    boolean more = true;
    while(more)
    {
        System.out.println("Enter a valid filename for output:");
        System.out.print(">> ");
        try
        {
            filename = stdin.readLine();
        }
        catch (IOException e)
        {
            System.out.println("Caught exception: " + e);
        }
        File output = new File(filename);
        if (output.exists())
        {
            more = false;
        }
        if (filename == infile)
        {
            int selection;
            String inputString = null;

            System.out.println("The output file given matches the input file. Please choose an option:");
            System.out.println("1) Enter new filename");
            System.out.println("2) Overwrite existing file");
            System.out.println("3) Backup existing file");
            System.out.print(">> ");
            try
            {
                inputString = stdin.readLine();
            }
            catch (IOException e)
            {
                System.out.println("Caught exception: " + e);
            }
            selection = Integer.valueOf(inputString);
            switch (selection)
            {
                case 1: //new filename
                case 2: //overwrite
                case 3: //backup
                default: System.exit(0);
            }
        }
    }
    return null;
}

//check the given file to see if it exists in the current working directory
public static boolean fileExists(String n)
{
    return (new File(n)).exists();
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T22:28:33.473

课堂不应该公开吗？

```
public class FileCopy 
```

不确定这是否会解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T22:32:36.993

刚刚在 eclipse 调试器中测试了这个并且命令行参数正确放置在 args 中，您可以检查您测试的文件是否在您的项目文件夹或实际目录“。” 因为如果不是，它将提示输入新文件

```
 if (fileExists(infile) == false)
    {
        infile = getInputFile();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T23:46:17.697

您将需要输入一个完全限定的路径，具体取决于您的项目结构。在我的测试环境中，它默认为 IDE 中项目的根级别。通常，`new File(n)`调用将默认到系统相关的默认目录。我确实从没有包的单个目录中编译并运行了它，并且能够成功使用抽象文件名（即`input.txt`和`output.txt`）。强制用户提供完整的限定文件名或至少只检查`args`值是否有任何危害。这将允许您在无效参数上尽早失败，而不必担心提示用户输入其他文件名。

# windows-runtime - 在项目详细信息 ScrollViewer 中嵌套 WrapGrid / GridView？

> ID：12451168
> 
> 赞同：0
> 
> 时间：2012-09-16T22:09:46.970
> 
> 标签：windows-runtime, winrt-xaml

**2012 年 9 月 17 日更新：**重申了问题并添加了娱乐步骤

我正在尝试将 WrapGrid 样式的图像库添加到 ItemDetailPage。到目前为止，我发现实现此目的的唯一解决方案是创建组样式并使用 DataTemplate 选择器。在详细信息页面上执行此操作似乎有点矫枉过正，因为我需要为页面上的每一列创建一个类。

我试图解决这个问题，如下所示，但 GridView 独立于我的 ScrollViewer 滚动，这是不可接受的。

要从 VS 中的默认 Grid 应用程序开始重新创建：

将此属性添加到 SampleDataItem

```
// Add to SampleDataItem TODO: replace int with image url strings
private List<int> _subItems = null;
public List<int> SubItems
{
    get
    {
        if (_subItems == null)
        {
            _subItems = new List<int>();
            for (int i = 0; i < 50; i++)
                this._subItems.Add(i);
        }
        return this._subItems;
    }
    set { this.SetProperty(ref this._subItems, value); }
} 
```

在 ItemDetailPage.xaml 中替换 ScrollViewer 中的 RichTextColumns：

```
 <!--Fixed column layout, replaces RichTextColumns from template-->    
  <Grid Grid.Row="1">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="800"/>
            <ColumnDefinition Width="1400"/>
        </Grid.ColumnDefinitions>
        <StackPanel>
            <TextBlock Text="{Binding Title}"/>
            <Image x:Name="image" MaxHeight="480" Margin="0,20,0,10" Stretch="Uniform" Source="{Binding Image}"/>                                     
        </StackPanel>
        <GridView ScrollViewer.HorizontalScrollMode="Disabled"  VerticalAlignment="Top" ItemsSource="{Binding SubItems}"  Grid.Column="1" ItemTemplate="{StaticResource GridViewDataTemplate1}" >
        </GridView>
    </Grid> 
```

最后添加以下DataTemplate

```
<DataTemplate x:Key="GridViewDataTemplate1">
    <Grid Background="Yellow" Width="200" Height="200"/>
</DataTemplate> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T06:26:22.700

您可以通过将 GridView 的 Horizo​​ntalScrollMode 设置为`Disabled`

```
<GridView ScrollViewer.HorizontalScrollMode="Disabled" /> 
```

**但是**，我会敦促您考虑这里的最佳方法。如果 GridViews 不与每个相关，则将它们显示在单独的页面上。如果它们是相关的，则将一个 GridView 分组。您可以使用[DataTemplateSelector](https://stackoverflow.com/questions/12152406/gridview-binding-to-groups-of-different-viewmodels-combining-images-and-text/12179853#12179853)对组的项目进行不同的样式设置。

# php - php包含给出错误

> ID：12451174
> 
> 赞同：1
> 
> 时间：2012-09-16T22:11:01.383
> 
> 标签：php, include

我是 php 的初学者，试图制作一个 main.php 文件，其中包含页眉和页脚作为开始

### 头文件.php

```
<html>
<body>
<div class="header">
logo, navigation etc
</div> 
```

### 页脚.php

```
<div class="footer">
Footer content here
</div>
</body>
</html> 
```

### 和主文件

```
<?php include "header.php"; ?>
<div class="main content">
<h1> header </h1>
<p> paragraph </p>
</div>
<?php include "footer.php"; ?> 
```

### 错误：

```
Warning: include(header.php): failed to open stream: No such file or directory in - on line 1
Warning: include(): Failed opening 'header.php' for inclusion (include_path='.:') in - on line 1

Warning: include(footer.php): failed to open stream: No such file or directory in - on line 6
Warning: include(): Failed opening 'footer.php' for inclusion (include_path='.:') in - on line 6 
```

所有文件都在同一个文件夹中，并在 XAMPP 上进行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T22:14:42.510

您包含的任何文件都必须在您的[include_path](http://us.php.net/manual/en/ini.core.php#ini.include-path)中。调用[get_include_path](http://www.php.net/manual/en/function.get-include-path.php)以查看当前值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-24T14:15:08.457

如果页眉、页脚和主文件位于同一目录中，请尝试以下操作：

```
include dirname(__FILE__) . '/header.php'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-24T12:45:32.787

您应该将文件添加到同一个文件夹中，以便它们位于同一个父目录中，然后您可以使用“include”直接访问它们例如：在名为 Home 的文件夹中，如果我创建第三个我可以使用的文件，则有 2 个 php 文件此代码“<？php 包括“找到的另外两个文件之一的名称。php”希望它清楚

# c - 在函数中更改指针的值

> ID：12451176
> 
> 赞同：0
> 
> 时间：2012-09-16T22:11:28.950
> 
> 标签：c, pointers, valgrind

我想在函数中更改变量的值。我的代码是这样的：

```
void change(char *buf){
    char str = "xxxxxxx";
    *buf = &str;
}
int main(){
    char *xxx = NULL;
    change(xxx);
} 
```

当我使用 valgrind 进行调试时，它说：

```
==3709== Invalid write of size 1
==3709==    at 0x80483CA: change (test.c:5)
==3709==    by 0x80483E5: main (test.c:10)
==3709==  Address 0x0 is not stack'd, malloc'd or (recently) free'd
==3709== 
==3709== 
==3709== Process terminating with default action of signal 11 (SIGSEGV)
==3709==  Access not within mapped region at address 0x0
==3709==    at 0x80483CA: change (test.c:5)
==3709==    by 0x80483E5: main (test.c:10) 
```

谁能帮我？我是C的新人......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-16T22:14:34.693

使用指向指针的指针：

```
void change(char **buf)
{
    *buf = "xxxxxxx";
}

int main(void)
{
    char *xxx = NULL;
    change(&xxx);
} 
```

# asp.net-mvc - 如何从模型状态中检索属性值

> ID：12451178
> 
> 赞同：1
> 
> 时间：2012-09-16T22:11:48.570
> 
> 标签：asp.net-mvc, asp.net-mvc-3

如何在 httppost 操作中从 modelstate 检索属性值。

下面是代码，我用来从模型状态中检索隐藏的 id 字段。但是是否不可能拥有强类型版本来获得价值。比如，如果属性名被修改，会提示编译时错误。

谁能解释一下“AttemptedValue”和“RawValue”之间的区别。

* * *

```
 ModelState state;      
 if (ModelState.TryGetValue("id", out state))
 {
     string value = state.Value.AttemptedValue.ToString();
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T00:49:50.787

框架使用尝试的值，它包含连接的值列表。就我而言，因为它是 id 字段，所以我将继续尝试价值。下面的链接有更多关于此的信息。

[http://forums.asp.net/t/1571473.aspx/1?MVC+2+Custom+ModelBinder+and+storing+the+attempted+value+for+the+view](http://forums.asp.net/t/1571473.aspx/1?MVC+2+Custom+ModelBinder+and+storing+the+attempted+value+for+the+view)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T22:28:08.217

您可以迭代 ModelStateDictionary 对象并通过字典上的键（属性名称）获取所需属性的值，或者您可以执行类似的操作`ModelState["PropertyName"].Value`

# jquery - jQuery单击并下拉一个div（如iOS通知中心）

> ID：12451183
> 
> 赞同：-1
> 
> 时间：2012-09-16T22:13:03.383
> 
> 标签：jquery, jquery-ui, resizable, jquery-ui-resizable

我知道 jQuery .toggle() 和 .slideDown() 函数，但是有没有一种方法可以让用户单击链接或项目并可以拉下/向下滑动 div。

我正在寻找与 iOs 通知中心类似的效果，您可以在其中单击图标并将 div 的大小调整为（定义的）高度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:15:03.680

你的第一句话令人困惑。单击链接或项目并让 div 向下滑动基本上是 .slideDown()。如果您只是想将 div 从小高度调整为大高度，请尝试使用 .animate({height: 200px}, 500) 使小 div 在半秒内增长到 200px。

# wpf - 绑定 PathGeometry 时未设置 StrokeStartLineCap

> ID：12451191
> 
> 赞同：2
> 
> 时间：2012-09-16T22:13:58.373
> 
> 标签：wpf, pathgeometry

XAML 产生预期的结果：带有圆角末端的线。

但是，绑定相同 PathGeometry 的数据会产生平端。我不确定这是为什么，谁能解释一下？

这是一个简化的示例：

XAML：

```
<Grid>
    <Path Fill="Green" Stroke="Black" StrokeThickness="8"
        Stretch="None" IsHitTestVisible="False"
        Data="{Binding IndicatorGeometry}"
        StrokeStartLineCap="Round" StrokeEndLineCap="Round"/>
    <!--<Path Fill="Green" Stroke="Black" StrokeThickness="8"
        Stretch="None" IsHitTestVisible="False"
        StrokeStartLineCap="Round" StrokeEndLineCap="Round">
        <Path.Data>
            <PathGeometry>
                <PathFigure StartPoint="64,64">
                    <LineSegment Point="128,8"/>
                </PathFigure>
            </PathGeometry>
        </Path.Data>
    </Path>-->
</Grid> 
```

C＃：

```
 private static PathFigure[] ms_figure = new []
                                                {
                                                    new PathFigure(
                                                        new Point(64, 64),
                                                        new[]
                                                            {
                                                                new LineSegment(new Point(128, 8), false)
                                                            },
                                                        true)
                                                };

    public PathGeometry IndicatorGeometry
    {
        get { return (PathGeometry)GetValue(IndicatorGeometryProperty); }
        set { SetValue(IndicatorGeometryProperty, value); }
    }

    public static readonly DependencyProperty IndicatorGeometryProperty =
        DependencyProperty.Register("IndicatorGeometry", typeof(PathGeometry), typeof(MainWindow),
            new FrameworkPropertyMetadata(new PathGeometry(ms_figure)));

    public MainWindow()
    {
        InitializeComponent();
        DataContext = this;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:44:23.470

如果您将`Geometry`XAML 创建的与在后面的代码中创建的进行比较，那么它们是不同的。

隐藏代码有许多不同之处......它使用“z”来关闭路径，而您的 XAML 没有......还有一个有 PathFigureCollection 另一个没有......它也设置了可冻结属性为真。

您需要尝试在代码隐藏中构建一个与 XAML 生成的相同......似乎构建几何以匹配它需要做很多工作。

我想出了另一种方法来构建有效的几何图形......希望这对你的情况有所帮助。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;

namespace WpfApplication4
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        private static Geometry m_DefaultIndicatorGeometry = Geometry.Parse("M 64,64 L 128,8");

        public Geometry IndicatorGeometry
        {
            get { return (Geometry)GetValue(IndicatorGeometryProperty); }
            set { SetValue(IndicatorGeometryProperty, value); }
        }

        public static readonly DependencyProperty IndicatorGeometryProperty =
            DependencyProperty.Register("IndicatorGeometry", typeof(Geometry), typeof(MainWindow),
            new FrameworkPropertyMetadata(m_DefaultIndicatorGeometry));

        public MainWindow()
        {
            InitializeComponent();
            DataContext = this;
        }
    }
} 
```

您也可以只使用字符串作为属性，因为 Data 属性有一个 TypeConverter 可以将使用路径标记语法描述路径的字符串转换为几何。

```
public partial class MainWindow : Window
{
    private static string m_DefaultIndicatorGeometry = "M 64,64 L 128,8";

    public string IndicatorGeometry
    {
        get { return (string)GetValue(IndicatorGeometryProperty); }
        set { SetValue(IndicatorGeometryProperty, value); }
    }

    public static readonly DependencyProperty IndicatorGeometryProperty =
        DependencyProperty.Register("IndicatorGeometry", typeof(string), typeof(MainWindow),
        new FrameworkPropertyMetadata(m_DefaultIndicatorGeometry));

    public MainWindow()
    {
        InitializeComponent();
        DataContext = this;
    }
} 
```

# html - 由于引入了元素样式宽度为 75 像素的跨度，因此像按钮对话框一样裁剪

> ID：12451192
> 
> 赞同：0
> 
> 时间：2012-09-16T22:14:05.957
> 
> 标签：html, facebook-like

我遇到了类似按钮的问题，该按钮似乎正在像这样裁剪弹出对话框

![裁剪 Facebook Like 对话框](../Images/4ac27bf25470221c644e3d92182c2aec.png)

我的标记是这个

```
<div class="fb-like" data-href="<%= campaign_link(share_link, campaign, :facebook)%>" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false"></div> 
```

似乎是因为`span`引入了一个元素样式宽度为 75px 的元素。

```
<div class="fb-like fb_edge_widget_with_comment fb_iframe_widget" data-href="http://app.bunch.dev/clubs/brc/posts/50564b4281772e72d1000007?utm_campaign=share_discussion&amp;utm_medium=facebook&amp;utm_source=bunchcc" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false">
  <span style="height: 20px; width: 75px; ">
    <iframe id="f1447ba434" name="f3f4b5ff04"... 
```

欢迎任何关于为什么会发生这种情况以及我如何预防/解决它的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-09T21:29:51.820

我知道它很旧，但如果它对某人有帮助：它可能与iframe 上的`max-width: 100%`or规则有关。`width: 100%`我遇到了完全相同的问题并通过以下方式解决了它：

```
.fb-like iframe{
    max-width: none;
} 
```

# asp.net-mvc - 根据 URL 参数定义控制器命名空间

> ID：12451195
> 
> 赞同：0
> 
> 时间：2012-09-16T22:14:34.973
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-mvc-routing

我正在使用 MVC4 开发一个 Web API，我想让它向后兼容，因为我无法控制客户端何时更新。

为此，我将在不同的命名空间上创建控制器，例如 MyApp.Controllers.v1_0.AccountsController 和 MyApp.Controllers.v1_1.AccountsController

显然，当我创建它们并尝试访问一个操作时，我得到“找到与名为'Accounts'的控制器匹配的多种类型”

然后，我试图做的是编写我自己的 IHttpControllerActivator，这样当调用 Create 时，它​​会返回其中一个......但这不起作用 b/c 它永远不会被击中，这在 Create 接收系统时是有意义的.Web.Http.Controllers.HttpControllerDescriptor 包含有关它将使用的控制器的信息。

此外，我不能只是将控制器命名为不同的（Accounts1_0Controller、Accounts1_1Controller），因为当激活器返回 Accounts1_0Controller 时，它会说它的名称不是“Accounts”......它的名称可能是 Accounts1_0。

你有没有看到任何一种方式：

1.  从 url 设置命名空间？这样我就有了 url /v1_0/SomeAction 或 /v1_1/SomeAction 并在适当的命名空间中搜索控制器
2.  有多个具有相同 MVC 名称但类名不同的控制器？

希望问题足够清楚。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T23:05:41.850

修复了它实现我自己的 IHttpControllerSelector。微软如何将 MVC4 开源，这很棒，几乎可以轻松地查看他们的 System.Web.Http.Dispatcher.DefaultHttpControllerSelector。

# java - 当我使用 removeAll（和 e.getValueIsAdjusting == false）从列表中删除多个项目时，为什么我的 ListSelectionListener 会看到多个事件？

> ID：12451198
> 
> 赞同：0
> 
> 时间：2012-09-16T22:15:13.587
> 
> 标签：java, jtable, jlist, glazedlists

我正在使用 GlazedLists'`EventList`并`EventTableModel`在下面的示例中。我不确定它是否有所作为。我有一张桌子，我正在观察选择的变化。当我删除多个项目时，会`ListSelectionListener`看到多个事件，并且在处理程序内部时，表报告的选定索引与删除发生**之前**的模型状态匹配，即使模型已经更改。

当我运行以下示例时，列表中添加了 7 个项目。如果我选择最后 2 项，控制台上会出现以下输出：

```
Selected row count: 2
Item list size: 7
Selected index: 5
Selected index: 6 
```

这就是我所期望的，但是当我删除这两个项目时，我得到以下输出：

```
Selected row count: 1
Item list size: 5
Selected index: 5

Selected row count: 0
Item list size: 5 
```

由于我正在删除`removeAll`列表中使用的连续块中的项目，因此我认为这是一个事件，但`ListSelectionListener`似乎收到通知，就好像它是两个单独的事件一样。如果我删除 4 个项目，侦听器会看到 4 个事件。

表格和模型不同步，但我不知道为什么。如果从列表末尾删除项目，则表报告的选定索引可能大于基础列表大小。基本上，在调用底层模型`JTable.getSelectedRows`引起的最后一个选择事件之前，返回的索引是不可靠的。`removeAll`

`JTable`在列表选择稳定并且将报告正确的选定索引后，如何获得有关选择更改的通知？

```
import ca.odell.glazedlists.BasicEventList;
import ca.odell.glazedlists.EventList;
import ca.odell.glazedlists.gui.AdvancedTableFormat;
import ca.odell.glazedlists.impl.sort.ComparableComparator;
import ca.odell.glazedlists.swing.EventTableModel;

import javax.swing.*;
import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;
import java.util.Comparator;
import java.util.List;

import static javax.swing.WindowConstants.EXIT_ON_CLOSE;

public class MultiDeleteMain {
    // The number of items that should be added to the model.
    @SuppressWarnings("FieldCanBeLocal")
    private final int itemCount = 7;

    private EventList<Item> itemList;
    private JTable itemTable;

    public static void main(String[] args) {
        new MultiDeleteMain();
    }

    public MultiDeleteMain() {
        SwingUtilities.invokeLater(new Runnable() {
            @SuppressWarnings("ConstantConditions")
            @Override
            public void run() {
                // The delete function needs access to the list and table, so
                // they are stored as instance variables.
                itemList = createItemList();
                itemTable = createItemTable(itemList);

                addListSelectionListenerToItemTable(itemTable);

                JPanel mainPanel = new JPanel(new BorderLayout());
                mainPanel.add(createDeleteButton(), BorderLayout.NORTH);
                mainPanel.add(new JScrollPane(itemTable), BorderLayout.CENTER);

                JFrame mainFrame = new JFrame("Multi-deletion in list test.");
                mainFrame.setContentPane(mainPanel);
                mainFrame.pack();
                mainFrame.setSize(300, mainFrame.getHeight());
                mainFrame.setLocationRelativeTo(null);
                mainFrame.setDefaultCloseOperation(EXIT_ON_CLOSE);
                mainFrame.setVisible(true);
            }
        });
    }

    private EventList<Item> createItemList() {
        EventList<Item> itemList = new BasicEventList<>();
        for (int i = 0; i < itemCount; i++) {
            itemList.add(new Item("Item " + i));
        }
        return itemList;
    }

    @SuppressWarnings("ConstantConditions")
    private JTable createItemTable(EventList<Item> itemList) {
        JTable itemTable = new JTable(new EventTableModel<>(itemList, new EventTableModelFormat()));
        itemTable.setSelectionMode(ListSelectionModel.SINGLE_INTERVAL_SELECTION);
        return itemTable;
    }

    private void addListSelectionListenerToItemTable(final JTable itemTable) {
        ListSelectionListener listener = new ListSelectionListener() {
            @Override
            public void valueChanged(ListSelectionEvent e) {
                if(!e.getValueIsAdjusting()) {
                    System.out.println("Selected row count: " + itemTable.getSelectedRowCount());
                    System.out.println("Item list size: " + itemList.size());
                    for(Integer index : itemTable.getSelectedRows()) {
                        System.out.println("Selected index: " + index);
                    }
                    System.out.println();
                }
            }
        };

        itemTable.getSelectionModel().addListSelectionListener(listener);
    }

    private JButton createDeleteButton() {
        JButton deleteButton = new JButton("Delete");
        deleteButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                deleteSelectedItems();
            }
        });
        return deleteButton;
    }

    @SuppressWarnings("ConstantConditions")
    private void deleteSelectedItems() {
        List<Item> itemsToDelete = new ArrayList<>();
        for (Integer rowIndex : itemTable.getSelectedRows()) {
            int convertedIndex = itemTable.convertRowIndexToModel(rowIndex);
            itemsToDelete.add(itemList.get(convertedIndex));
        }

        itemList.removeAll(itemsToDelete);
        itemTable.revalidate();
        itemTable.repaint();
    }

    // Enum for managing table columns
    private static enum Columns {
        NAME("Name", String.class, new ComparableComparator());

        private final String name;
        private final Class type;
        private final Comparator comparator;

        private Columns(String name, Class type, Comparator comparator) {
            this.name = name;
            this.type = type;
            this.comparator = comparator;
        }
    }

    // Each table holds a list of items.
    private static class Item {
        private final String name;

        private Item(String name) {
            this.name = name;
        }
    }

    // Table format for use with the EventTableModel
    private static class EventTableModelFormat implements AdvancedTableFormat<Item> {
        @Override
        public int getColumnCount() {
            return 1;
        }

        @Override
        public String getColumnName(int i) {
            return Columns.values()[i].name;
        }

        @Override
        public Object getColumnValue(Item item, int i) {
            return item.name;
        }

        @Override
        public Class getColumnClass(int column) {
            return Columns.values()[column].type;
        }

        @Override
        public Comparator getColumnComparator(int column) {
            System.out.println("Asked for comparator.");
            return Columns.values()[column].comparator;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:13:25.353

我们必须知道 EventList 和 EventTableModel 的样子。我敢打赌，EventTableModel 不能保证 deleteAll 方法只传递连续的元素。所以唯一的选择是一个一个地删除它们，为每个它们触发一个单独的事件。

# php - PHP：选中默认状态的粘性复选框

> ID：12451200
> 
> 赞同：1
> 
> 时间：2012-09-16T22:15:18.873
> 
> 标签：php, sticky

我正在使用 PHP 仅显示 MySQL 表中的选定记录。有一个带有提交按钮的表单，因此用户可以优化他们的搜索（“仅显示 fieldX = valueY 的记录”...）

为了使表格具有粘性，我使用了以下代码：

```
<input type="checkbox" name="SBS" value="SBS" <?php if($_POST['SBS'] == 'SBS') echo'checked="checked" ' ?> /> 
```

唯一的问题是我需要检查默认值。我尝试添加

```
$_POST['SBS'] = 'SBS'; 
```

在顶部，但是这显然每次提交表单时都会设置变量，所以我不能关闭它！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T22:29:37.733

不要设置`$_POST['SBS']`。让表单的提交做到这一点。

如果您想默认勾选复选框，那么您可以使用`$_SERVER['REQUEST_METHOD']`检测 a`GET`或 a `POST`。

`$_POST`如果表单已经提交，这将使用，否则如果它是 a `GET`，它将默认为选中。

```
<input type="checkbox" name="SBS" value="SBS" <?php if (($_SERVER['REQUEST_METHOD'] == 'POST' && $_POST['SBS'] == 'SBS') || $_SERVER['REQUEST_METHOD'] == 'GET') echo'checked="checked" ' ?> /> 
```

您还可以通过 a 使用`$_REQUEST['SBS']`而不是`$_POST['SBS']`默认`POST`来自查询字符串或查询字符串的值`GET`。

# javascript - 需要从JSP发送动态数据到sql server

> ID：12451201
> 
> 赞同：0
> 
> 时间：2012-09-16T22:15:18.763
> 
> 标签：javascript, hibernate

使用 Javascript 将单元格动态添加到 JSP 页面。需要从单元中收集数据并将数据发送到数据库。使用 Spring MVC、hibernate、spring form 标签

任何解释这一点的文章都非常感谢！

任何建议都会有所帮助！

javascript:

```
var i=0;
function addRow()
{
i++;
var tbl = document.getElementById('div1');
var lastRow = tbl.rows.length;
var iteration = lastRow - 1;
var row = tbl.insertRow(lastRow);

var firstCell = row.insertCell(0);
var el = document.createElement('input');
el.type = 'text';
el.name = 'hostName' + i;
el.id = 'hostName' + i;
el.size = 30;
el.maxlength = 200;
firstCell.appendChild(el);

var secondCell = row.insertCell(1);
var el2 = document.createElement('input');
el2.type = 'text';
el2.name = 'directory' + i;
el2.id = 'directory' + i;
el2.size = 30;
el2.maxlength = 200;
secondCell.appendChild(el2);

var thirdCell = row.insertCell(2);
var el3 = document.createElement('input');
el3.type = 'text';
el3.name = 'userName' + i;
el3.id = 'userName' + i;
el3.size = 20;
el3.maxlength = 20;
thirdCell.appendChild(el3);

var fourthCell = row.insertCell(3);
var el4 = document.createElement('input');
el4.type = 'text';
el4.name = 'password' + i;
el4.id = 'password' + i;
el4.size = 20;
el4.maxlength = 20;
fourthCell.appendChild(el4);
}

 function removeRowFromTable()
 {
 var tbl = document.getElementById('div1');
 var lastRow = tbl.rows.length;
 if (lastRow > 2) tbl.deleteRow(lastRow - 1);
 }
</script>` 
```

动态创建的单元格：

```
<tr><td colspan="4">
        <table id="div1" style="display:none">
            <tr><td>Host Name</td><td>Directory</td><td>User Name</td><td>Password</td></tr>
            <tr><td><input type="text" value="${events.hostName}" size="30" maxlength="200"/></td>
            <td><input type="text" value="${events.directory}" size="30" maxlength="200"/></td>
            <td><input type="text" value="${events.userName}" size="20" maxlength="20"/></td>
            <td><input type="text" value="${events.password}" size="20" maxlength="20"/></td></tr>
        </table>
            </td></tr>
            <tr id="i1" style="display:none"><td><input type="button" onclick="addRow()" value="+"/>
            <input type="button" onclick="removeRowFromTable();" value="-" />
            </td></tr> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T03:19:59.357

由于您没有使用 javascript 向服务器发出 ajax 请求，而仅生成 html 内容，因此从服务器端的角度来看，它与您通常使用 Spring MVC 或 Spring 表单没有什么不同。

你可以把程序流程想象成：当一个请求被发送到服务器时，服务器可以请求资源作为响应。在您的情况下，它是带有 javascript 代码的 html 页面。javascript代码在客户端执行。它修改html标签。对于您的情况，您只需要确保生成的 html 表单将以 Spring Controller 处理它的任何方式创建对您的服务器的有效请求。换句话说，您可以先尝试在没有 javascript 的情况下制定可行的解决方案。然后用javascript替换静态组件。

如果你不熟悉 Spring MVC 或 Hibernate，网上有很多教程：

[http://www.mkyong.com/tutorials/spring-mvc-tutorials/](http://www.mkyong.com/tutorials/spring-mvc-tutorials/)

[http://static.springsource.org/docs/Spring-MVC-step-by-step/](http://static.springsource.org/docs/Spring-MVC-step-by-step/)

[http://www.mkyong.com/tutorials/hibernate-tutorials/](http://www.mkyong.com/tutorials/hibernate-tutorials/)

希望能帮助到你

# c# - 大数据绑定失败

> ID：12451209
> 
> 赞同：1
> 
> 时间：2012-09-16T22:16:12.153
> 
> 标签：c#, windows-phone-7, data-binding, binding

我创建了一个具有实时过滤和排序功能的应用程序（当文本框中的文本更改时，列表会动态更改）。我使用了一个绑定到 ObservableCollection 的 ListBox，后来又绑定到了一个 List。它适用于小数据，但是当我使用 1000 个项目时它失败了。

我使用**就地**QuickSort 进行排序，并使用 Visibility 属性对过滤的项目进行排序。我猜出于性能原因，这将是最好的。

首先，我尝试将 ObservableCollection 绑定到 ListBox。当我快速输入文本时，它引发了异常（检测到布局周期）。

比我尝试使用列表作为 ItemsSource。排序/过滤完成后，我触发了 NotifyPropertyChanged("MyList")。没有例外，但是当文件过滤器短语只导致**几个可见**项目时。它加载非常慢。

我最终做了一些我不喜欢的事情，因为它看起来真的很业余。

```
Data.ApplyFiltersSorting();
ItemsListBox.ItemsSource = Data.MyItems.Where(a => a.Visibility == Visibility.Visible); 
```

这实际上工作得很快并且不会导致错误。

有人可以告诉我在我之前的尝试中可能出了什么问题，以及这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T06:00:05.247

您是否尝试过使用`CollectionViewSource`for 排序和过滤？

Geoff Hudik 在这里做了类似的事情：[http ://www.geoffhudik.com/tech/2010/10/14/wp7-in-app-searching-filtering.html](http://www.geoffhudik.com/tech/2010/10/14/wp7-in-app-searching-filtering.html)

# javascript - 将 dojo 参数添加到现有字段

> ID：12451211
> 
> 赞同：1
> 
> 时间：2012-09-16T22:16:32.273
> 
> 标签：javascript, dojo, textfield

我有一个用 php 创建的表单，我想从 js dojo 向它添加一些属性。

我可以通过它的 id (dojo.byId) 检索文本字段，但是如何在不创建新字段并替换前一个字段的情况下将占位符属性添加到节点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T07:25:11.357

```
dojo.byId("textbox1").placeholder = "I'm your placeholder"; 
```

在行动中看到它：http: [//jsfiddle.net/phusick/ww98a/](http://jsfiddle.net/phusick/ww98a/)

# mysql - 使用 cron 作业从数据库表中删除行

> ID：12451215
> 
> 赞同：1
> 
> 时间：2012-09-16T22:17:35.483
> 
> 标签：mysql, cron

我想知道如何使用 cron 作业从给定的数据库表中删除一行，我可以直接使用我的 cPanel 中的 cron 作业命令行来执行此操作吗？我正在使用 MySQL 数据库

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T22:22:47.240

使用 MySQL 的[事件调度器](http://dev.mysql.com/doc/en/events.html)：

```
CREATE EVENT foo ON SCHEDULE AT CURRENT_TIMESTAMP + INTERVAL 3 HOUR
DO DELETE FROM my_table WHERE id = 123 
```

# iphone - iOS：在 iOS App 中处理下载的数据

> ID：12451216
> 
> 赞同：3
> 
> 时间：2012-09-16T22:17:41.907
> 
> 标签：iphone, objective-c, ios, xcode, instruments

我的应用程序下载一些图像并从解析的 JSON 值创建文本文件。下载的图像和文本文件中的内容然后在不同的视图控制器中显示给查看器。

在我第一次提交应用程序的早些时候，我被拒绝了，因为我在提交我的应用程序之前完全忘记了处理那些下载的文件（这些文件被下载到 Documents 目录中）。但从那以后，我加倍努力确保我的应用程序尽可能完美，这意味着阅读和重新阅读数据存储指南和人机界面指南，以便我的应用程序在我再次提交时不会被拒绝。

所以我对处理数据和内存有几个问题：

**之前：**我将所有从 Internet 下载的内容保存到 Documents 目录中（我现在意识到这是一个错误）。然后我正在创建一个 plist 文件，其中包含下载的图像和文本的路径。所以我在另一个视图控制器中所要做的就是打开 plist 文件，读取图像和文本文件路径，然后加载内容以显示给用户。

当视图控制器关闭时，我忘记删除那些下载的文件（尽管我在下一次应用程序运行中覆盖了现有文件）。结果是，当您启动应用程序时，上一个会话中已经存在大约 15 mb 的数据，这些数据从未被删除，但在用户进行另一次搜索时被覆盖。

**之后：**我采取了以下步骤： a) 现在我将所有互联网数据下载到“tmp”目录中。一旦第二个视图控制器关闭并且用户查看了所有内容，我就会从“tmp”目录中删除所有文件，包括 plist 文件。

b) 在应用程序启动时，我还会检查是否还有上次启动的剩余文件（如果应用程序终止了怎么办）。如果我从上一个会话中找到任何下载的文件，我会删除它们。

c) 当用户将特定数据添加到他/她的收藏夹（例如喜欢的新闻文章）时，我将相应的图像和文本保存到 /Documents/Data 目录，并在 /Documents 目录中创建一个收藏夹 PList 文件，该文件存储路径用户最喜欢的数据。此 plist 文件和收藏夹文件不会被删除，除非用户从 tableview 中删除该文章。

**Q 1）**以上是一个好方法吗？我应该将这些内容保存到 /Library/Caches 还是 /tmp 好？

**Q 2)**我没有使用 iCloud，但同时，我想确保如果用户有任何收藏夹，他们应该备份到 iCloud。这可以吗，还是我真的必须对收藏的文件使用“不备份”属性？

***编辑*** Alan Duncan - 感谢内存泄漏的答案。

我已经删除了有关内存泄漏的问题。关于数据存储问题，它们都与 Apple 的人机界面指南有关。但如果你能回答剩下的任何一个问题，那将是有价值的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-22T10:07:45.347

文档目录用于存储用户自己创建的文件或以后无法重新创建的文件，因此它们会在 iCloud 上备份或在用户进行 iTunes 备份时进行备份。除非用户卸载应用程序，否则永远不会清除文档文件夹。

缓存目录用于存储您想要在设备上缓存但可以在以后轻松重新创建的文件，例如下载的图像。如果设备的可用磁盘空间不足，当然当用户卸载应用程序时，操作系统可以自动清除缓存文件夹。

临时目录用于在会话期间临时存储文件。当用户关闭应用程序时，此文件夹会自动清除。

您应该考虑将用户最喜欢的文章与图像一起存储在缓存目录中，因为它们总是可以在以后再次下载。除非您明确声明即使在离线模式下（如 Pocket 应用程序）用户也应该能够看到带有图像的完整文章，否则您应该将它们与您的 plist 一起存储在文档目录中。搜索结果应该存储在 temp 目录中，尽管我不太确定如果用户不打算对搜索结果执行任何操作，为什么要将搜索结果保存到磁盘？

# c# - 如何显示当前登录数据库的用户？

> ID：12451220
> 
> 赞同：0
> 
> 时间：2012-09-16T22:17:55.717
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, visual-studio-2010, razor

我创建了一个网站，使用 SQL Server 自定义登录到我的数据库，并且想知道如何显示登录用户的文本。目前它在欢迎词旁边显示用户“登录”，但我宁愿显示用户的真实姓名。我是 MVC3 的新手，想知道如何更改 _LogOnPartial.cshtml 中的以下行以显示我的数据库“AgentFirstName”中的字段

```
<text>Welcome <strong>@User.Identity.Name</strong> 
```

这是我的 AccountControler

```
[HttpPost]
    public ActionResult LogOn(LogOnModel model)
    {
        if (ModelState.IsValid)
        {
            if (DAL.MyWebsiteContextClass.userIsValid(model.AgentLogin, model.AgentPassword))
            {
                FormsAuthentication.SetAuthCookie(model.AgentLogin, false);

                return RedirectToAction("Index", "Home");
            }
            else
            {
                ModelState.AddModelError("", "The user name or password provided is incorrect.");
            }
        }
        return View(model);
    } 
```

这是我的代理模型

```
public class Agents
{
    public virtual int ID { get; set; }
    public virtual string AgentFirstName { get; set; }
    public virtual string AgentLastName { get; set; }
    public virtual string AgentLogin { get; set; }
    public virtual string AgentPassword{ get; set; } 
```

使用这样的网络配置集

```
<add name="MyWebsiteContextClass"
     connectionString="Data Source=My-SQL\SQLEXPRESS; Initial Catalog=MyWebsite; Persist Security Info=True;User ID=sa;Password=password"
     providerName="System.Data.SqlClient"/> 
```

这是在我的上下文中

```
public DbSet<Agents> AgentsPkg { get; set; } 
```

不幸的是，我不知道您还需要什么帮助我，但如果您需要任何帮助，请询问，我会尽我所能。谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:04:39.997

在控制器的`Index`操作中`Home`，您可以检查用户是否经过身份验证（ using `User.Identity.IsAuthenticated`），如果是这种情况，您可以使用`User.Identity.Name`作为搜索键从数据库中获取用户信息。

假设您`MyProject.Models.User`从数据库中获得了一个返回的实例 - 然后您可以将此实例传递给`Index`视图，然后访问视图中的实例。

在视图中，您需要声明提供的模型的类型，在您的情况下是 migt `@model MyProject.Models.User`。然后，您可以`User`在视图中访问模型实例，例如，打印名字和姓氏等属性（或模型中可用的任何属性） - 模型实例的访问方式如下`@Model.FirstName`：

要查看如何将模型实例传递给视图并以强类型方式访问模型实例属性的示例，一个很好的示例可以阅读[本 asp.net mvc3 教程中的“](http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/accessing-your-model%27s-data-from-a-controller)*强类型模型和@model 关键字*”部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T00:10:46.073

根据您的附加信息...您的问题的解决方案非常简单（至少是您问题的解决方案，它并不是很理想..但理想的解决方案要复杂得多）。

您只需根据 AgentLogin 查询您的 Agents 表并使用 User.Identity.Name 作为条件。这使您可以获取 AgentFirstName 并将其传递给您的模型，并在其中显示它。

# android-viewpager - 向 ViewPager 添加超出其 setOffScreenPageLimit 值的页面

> ID：12451223
> 
> 赞同：1
> 
> 时间：2012-09-16T22:18:51.230
> 
> 标签：android-viewpager, android-listfragment

我`ViewPager`在我的 Android 应用程序中使用 a 。该应用程序允许用户添加和删除页面，每次`ListFragment`在新页面中添加一个页面添加。我的适配器是`FragmentPagerAdapter`. 这一切都很好，直到我添加的页面比我在 setOffScreenPageLimit + 1 中指定的值多一页。例如，我定义：

```
mPager.setOffscreenPageLimit(5); 
```

我最多可以毫无问题地添加 6 个（5 个屏幕外页面 + 1 个可见页面）页面。当我添加第七页时，应用程序在尝试调用`getActivity()`我的`ListFragment`代码时崩溃，因为`Activity = null`. 我还应该提到，`getActivity()`调用是在`onPostExecute`AsyncTask 的方法中进行的（仍在尝试确定某些内容是否不同步......）。

我在这里错过了什么......？

# php - PHP - json不通过循环解析

> ID：12451225
> 
> 赞同：2
> 
> 时间：2012-09-16T22:19:34.730
> 
> 标签：php, json

假设我的 JSON 是这样的：

```
{
  "achievement": [
    {
      "title": "All Around Submitter",
      "description": "Get one piece of content approved in all six areas.",
      "xp": 500,
      "level_req": 1
    },
    {
      "title": "World-wide Photo Journalist",
      "description": "Get one photo approved in all six areas.",
      "xp": 500,
      "level_req": 1
    },
    {
      "title": "Ready for Work",
      "description": "Sign up and get validated",
      "xp": 50,
      "level_req": 1
    },
    {
      "title": "Asian Pride",
      "description": "Get ten pieces of content approved to a club in an Asian nation.",
      "xp": 1500,
      "level_req": 1
    }
  ]
} 
```

我的PHP代码是这样的，所以我通过那个json文件加载......：

```
<?php

$string = file_get_contents("achievements.json");
$json_a=json_decode($string,true);

foreach ($json_a as $key => $value){
  echo  $value[0]['title'] . " <br />";
}

?> 
```

然而，它只输出第一个数组。我知道。只有 1\. 但是`foreach`循环呢？为什么它不是为每一行循环？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-16T22:22:43.557

您正在循环访问只有一个键的顶级数组：`achievement`

相反，你应该

```
foreach ($json_a['achievement'] as $key => $value){
  echo  $value['title'] . " <br />";
} 
```

提示：`[0]`是某种代码气味。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T22:24:50.930

这里试试这个

```
$string = file_get_contents("achievements.json");
$json_a=json_decode($string,true);

foreach ($json_a['achievement'] as $key => $value){
  echo  $value['title'] . " <br />";
} 
```

你正在循环你的顶级数组，但是在你解析你的 json 之后，你得到：

```
array(1) {
  ["achievement"]=>
  array(4) {
  //your other arrays
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T22:23:49.603

它不起作用，因为您正在循环的数组只有一个键，`achievements`这是您返回的数组`json_decode()`，给定您当前的 json。循环通过它，你会得到你所追求的：

```
foreach ($json_a['achievement'] as $key => $value){
    echo $value['title'] . "<br />";
} 
```

# lotus-notes - Lotus Notes 两个表单相同的文档

> ID：12451226
> 
> 赞同：0
> 
> 时间：2012-09-16T22:19:35.963
> 
> 标签：lotus-notes

回到基础。我想要有两个表单来查看文档。但是，如果文档是使用表单 A 创建的，则始终显示表单 A，如果文档是使用表单 B 创建的，则在打开该文档时始终显示表单 B（但就视图而言，它们必须具有相同的别名和表单名称）。我不想更改我当前的任何应用程序逻辑，也不想更改我的视图公式以获得此表单 B（表单 A 已经存在）。任何帮助或提示将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T21:29:41.537

您可以在视图中添加表单公式。如果可以包含一个简单的公式，例如

```
@If(FormWasUsed="FormA"; "FormA"; "FormB") 
```

或者只是简单

```
FormWasUsed 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T00:53:55.210

我不明白你为什么要这样做。在我看来，从长远来看，这会让你的生活变得非常困难。但是，我想你一定有一个理由，所以这就是我要做的：

*   将表单 A 复制到子表单 A 中。在底部添加 Computed-When-Composed 字段 OriginalForm，并将值公式设置为“A”。
*   将表单 B 复制到子表单 B 中，在底部添加 Computed-When-Composed 字段 OriginalForm，并将值公式设置为“B”。
*   删除原始表格。
*   使用 Computed Subform 创建一个新的 Form A，并将公式设置为“Subform” + OriginalForm。
*   使用 Computed Subform 创建一个新的 Form B，并将公式设置为“Subform” + OriginalForm。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T14:59:54.177

您可以使用计算的子表单和字段和标签上的隐藏时间来执行此操作。

正如 Richard 建议的那样，创建两个子表单，其中包含“Form A”和“Form B”独有的标签和字段。确保在主表单上有一个“文档类型”字段，指示该文档将使用哪个子表单。所有通用信息都放在主窗体上，以便所有文档出现在所有视图中并使用现有的应用程序逻辑。

如果不同的标签和字段不连续或数量很少，只需根据“文档类型”字段添加具有隐藏时公式的字段。

您不能有两个具有相同名称和别名的表单。您可以有两个具有相同别名的表单，但这最适用于仅适用于 Notes 客户端或仅适用于 Web 客户端的表单。否则，客户将不知道要使用哪种形式，因为两者都可用——我怀疑它只会使用一种，但这不是你想要的。

# c++ - 任意解引用指针的输出

> ID：12451230
> 
> 赞同：3
> 
> 时间：2012-09-16T22:20:32.480
> 
> 标签：c++, pointers, x86, arm, memory-alignment

我按如下方式填充内存：

```
char buf[8] = { 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88}; 
```

然后将无符号长指针依次放在前 5 个字节上并输出结果：

```
char *c_ptr;
unsigned long *u_ptr;

c_ptr = buf;
for (int i=0;i<5;i++)
{
    u_ptr = (unsigned long *)c_ptr;
    printf("%X\n",*u_ptr);
    c_ptr++;
} 
```

当我在 x64 平台上执行此代码时，我得到了我的预期：

```
44332211
55443322
66554433
77665544
88776655 
```

但是当我在 ARM 平台上执行相同的代码时，我得到以下信息：

```
44332211
11443322
22114433
33221144
88776655 
```

即，它每 4 个字节绑定一次，并且在此范围内仅取消引用 4 个字节。

所以我想问一下，这种行为（何时`pointer_value%4 != 0`）是错误的还是特定于实现的？

UPD：我知道字节序，我想知道这是正确的，我得到了

```
11443322 
```

代替

```
55443322 
```

即，例如，当我有指针时，`0x10000001` 它会从具有地址 , 和 than 的字节中生成 unsigned `0x10000001`long ，`0x10000002`而不是.`0x10000003``0x10000000``0x10000005`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T22:33:47.230

在怀疑内存对齐后，我做了一个快速的谷歌 =）

[http://awayitworks.blogspot.co.nz/2010/02/arm-memory-alignment.html](http://awayitworks.blogspot.co.nz/2010/02/arm-memory-alignment.html)

在那篇文章中说：

> 直到 ARMv4 架构，假定为获取内容提供的地址是内存对齐的……32 位数据获取应该具有与 32 位对齐的地址，依此类推。正如正确猜测的那样，问题仅适用于 32 位和 16 位数据获取。如果数据获取是 32 位，ARM 会忽略地址的低 2 位，如果数据获取是 16 位，则忽略低 1 位。因此，如果地址没有正确对齐，那么数据获取将是错误的。

注意最后一句话=）

如果您需要在 x86 上预期的行为，则必须从字符显式构建整数，*即*（假设 little-endian）：

```
// Endian-specific
inline unsigned long ulong_at( const char *p ) {
    return ((unsigned long)p[0])
         | (((unsigned long)p[1]) << 8)
         | (((unsigned long)p[2]) << 16)
         | (((unsigned long)p[3]) << 24);
} 
```

也许：

```
// Architecture-specific
inline unsigned long ulong_at( const char *p ) {
    unsigned long val;
    char *v = (char*)&val;
    v[0] = p[0];
    v[1] = p[1];
    v[2] = p[2];
    v[3] = p[3];
    return val;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-16T22:34:39.660

如果你想从内存中取出一个四字节的字，地址应该是四的倍数。

在任何架构上，未对齐的访问通常都是一个坏主意。有些人会抛出一个 SEGFAULT，其他人会透明地处理错误，并且 - 非常缓慢地 - 通过获取包含所需值的两个单词并将它们拼接在一起来合成正确的值。看来（尽管我不是专家）ARM 正在获取指针占用的四字节插槽并旋转结果，以便寄存器的 LSB 与指针匹配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-16T22:27:20.150

字节序不能解释这种行为。似乎 ARM 处理器不允许四字节内存访问未与四字节边界对齐，并且输出表明处理器读取内存，就好像它受到了经过访问的每个字节 8 位的[向右按位旋转](http://en.wikipedia.org/wiki/Bitwise_operation#Rotate_no_carry)四字节边界。有关内存对齐的更多信息，请参阅[此 Wikipedia 文章](http://en.wikipedia.org/wiki/Data_structure_alignment)。

事实上，在某些架构上，如果您尝试执行此类未对齐的内存访问，则可能会发生[总线错误。](http://en.wikipedia.org/wiki/Bus_error)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-16T22:35:54.083

问题是您正在取消引用一个未对齐的指针，根据硬件，它可能是未定义的。许多架构假设 a`long*`将与 32 位内存对齐，即可以被 4 整除。如果不是，则结果未定义。

通常，C 不保证将一种指针类型转换为另一种时会发生什么。

# android - Android禁用WebView触摸但继续缩放/滚动

> ID：12451231
> 
> 赞同：1
> 
> 时间：2012-09-16T22:20:32.547
> 
> 标签：android, webview, scroll, touch, zooming

我正在寻找一种禁用 WebView 触摸的方法，以便用户无法单击 html 链接，但保留 WebView 的缩放和滚动功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-27T10:54:53.393

下面的代码允许您滚动，但是当单击链接时，它不会转到下一页。

```
webView.setLongClickable(false);

webView.setOnTouchListener(new View.OnTouchListener()
{

  @Override

  public boolean onTouch(View arg0, MotionEvent arg1)
  {

       return arg1.getAction() == MotionEvent.ACTION_UP;

  }
}

); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-04T20:28:48.937

我一开始就使用了rattisuk的答案，但意识到如果你点击某个地方，点击会被拦截，但会变成长按，如果你点击了某个文本字段，手机会振动并且还会弹出一些潜在的版本菜单。此外，只要在 web 视图中按下可更改的 UI 元素（例如单击链接或按钮），这些 UI 元素就会改变外观。为了防止这种情况，这是我改进的解决方案：

```
// Disable the haptic feedback so that handling the long click doesnt make the phone vibrate
webview.setHapticFeedbackEnabled(false);
// Intercept long click events so that they dont reach the webview
webview.setOnLongClickListener(new OnLongClickListener() {
    @Override
    public boolean onLongClick(final View v) {
        return true;
    }
});
// Intercept any touch event not related to scrolling/zooming
webview.setOnTouchListener(new View.OnTouchListener() {
    @Override
    public boolean onTouch(final View v, final MotionEvent event) {
        if (event.getAction() == MotionEvent.ACTION_DOWN) {
            // Change ACTION_DOWN location to outside of the webview so that it doesnt affect 
            // pressable element in the webview (buttons receiving PRESS" will change appearance)
            event.setLocation(webview.getWidth() + 1, webview.getHeight() + 1);
        }
        // Intercept any "up" event
        return event.getAction() == MotionEvent.ACTION_UP;
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T00:37:04.107

```
Webview.setWebViewClient(new WebViewClient(){
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {      
                    return false;
        }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-03T10:11:22.440

这是我的解决方案。它不会让用户触发 javascript 点击事件

```
public class NonClickableWebView extends WebView {
    private GestureDetectorCompat gestureDetector;
    private boolean isSingleTap = false;

    public NonClickableWebView(Context context) {
        super(context);
        gestureDetector = new GestureDetectorCompat(context, new GestureDetector());
    }

    public NonClickableWebView(Context context, AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
        gestureDetector = new GestureDetectorCompat(context, new GestureDetector());
    }

    public NonClickableWebView(Context context, AttributeSet attrs) {
        super(context, attrs);
        gestureDetector = new GestureDetectorCompat(context, new GestureDetector());
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        if (event.getAction() == MotionEvent.ACTION_DOWN) {
            isSingleTap = false;
        }
        gestureDetector.onTouchEvent(event);

        if (isSingleTap && event.getAction() == MotionEvent.ACTION_UP) {
            return true;
        }

        return super.onTouchEvent(event);
    }

    private class GestureDetector extends android.view.GestureDetector.SimpleOnGestureListener {
        @Override
        public boolean onSingleTapUp(MotionEvent e) {
            isSingleTap = true;
            return false;
        }

        @Override
        public boolean onSingleTapConfirmed(MotionEvent e) {
            isSingleTap = true;
            return false;
        }
    }
} 
```

# windows - Meteor：在windows下部署

> ID：12451235
> 
> 赞同：2
> 
> 时间：2012-09-16T22:20:53.997
> 
> 标签：windows, deployment, meteor

其他人在使用 Windows 版本部署应用程序时遇到问题吗？

根据程序输出，一切正常，它应该在所选的 URL 上提供服务，但浏览器的唯一响应是“此站点已关闭。稍后再试。”

然后我尝试部署最简单的应用程序，但它也不起作用。

有谁知道这是否是windows下的常见问题？

我确实在 windows 7 下安装了最新版本，适用于 windows 的流星 0.4.0（来自[http://win.meteor.com/](http://win.meteor.com/)）。

谢谢！

编辑：显然这是 Windows 版本中的一个错误：我在 ubuntu 下部署了我的网站，没有任何问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T22:53:54.877

Meteor 0.5.0 已经发布，在 Meteor 0.4.2 中，我修复了这个问题，使其适用于 Windows 上的 Git Bash。

在 Meteor 0.5.1 中，我计划在 Git Bash 和 CMD 中完成这项工作。

# java - JPanel 有时只显示组件

> ID：12451236
> 
> 赞同：1
> 
> 时间：2012-09-16T22:21:49.353
> 
> 标签：java, swing, jframe, jpanel

我在使用 JPanel 时遇到问题。我是 Swing 和一切的新手，所以其中一些可能是不正确的。任何帮助，将不胜感激。当调用battleGUISelection 方法时，问题出现在第二个类中。有时它会显示，但其他时候，例如在通过teachingMove 方法添加新移动后，它会显示为空白。JLabels 将完全不可见，并且在我将光标悬停在它们上之前，按钮不会出现。

这是我到目前为止...

```
import java.util.*;

@SuppressWarnings("unchecked")
public class Battle {

public int hp;
public String name;
public ArrayList<String> moves = new ArrayList<String>();   
public ArrayList<Integer> damages = new ArrayList<Integer>();

public Battle(String name_in)
{
    name = name_in;

    moves.add("punch");
    moves.add("kick");
    moves.add("slam");

    damages.add(10);
    damages.add(15);
    damages.add(20);
}

public void setHp(Battle player, int amt)
{
    player.hp = amt;
}

public void revive(Battle player, String difficulty_in)
{
    if(difficulty_in.equals("beginner"))
    {
        player.hp = 50;
    }
    else if(difficulty_in.equals("intermediate"))
    {
        player.hp = 75;
    }
    else if(difficulty_in.equals("expert"))
    {
        player.hp = 100;
    }
}
} 
```

和gui类..

```
import java.awt.*;
import java.util.*;
import java.awt.event.*;
import javax.swing.*;

public class GUIFrameTest extends JFrame {

        JPanel panel = new JPanel();
        JButton begButton = new JButton("Beginner");
        JButton intermButton = new JButton("Intermediate");
        JButton expertButton = new JButton("Expert");
        JButton okButton = new JButton("OK");
        JLabel title = new JLabel("SELECT DIFFICULTY");
        JLabel label = new JLabel();
        JLabel txtLabel = new JLabel();
        TextField name = new TextField();    

    static Battle newPlayer = new Battle("");
    static Battle enemyBeginner = new Battle("OPPONENT");
    static Battle enemyIntermediate = new Battle("OPPONENT");
static Battle enemyExpert = new Battle("OPPONENT");
static Battle enemy;
static String difficulty;

public GUIFrameTest(String windowName) 
{
    super(windowName);

    final Container c = getContentPane();
    panel.setLayout(null);

    //panel.setBounds(0, 0, 500, 500);

    begButton.setBounds(0, 25, 100, 50);
    intermButton.setBounds(125, 25, 110, 50);
    expertButton.setBounds(255, 25, 100, 50);
    label.setBounds(0, 100, 200, 50);
    name.setBounds(188, 225, 125, 25);
    txtLabel.setBounds(188, 178, 125, 50);
    okButton.setBounds(200, 255, 100, 25);
    title.setBounds(0, 0, 150, 15);

    txtLabel.setText("Enter name of player: ");

    begButton.addActionListener(new AbstractAction("add"){
        @Override
        public void actionPerformed(ActionEvent e){
            label.setText("Difficulty set to beginner");
            difficulty = "beginner";
            newPlayer.setHp(newPlayer, 50);
            enemyBeginner.setHp(enemyBeginner, 50);
            enemyBeginner.moves.add("punch");
            enemyBeginner.moves.add("kick");
            enemyBeginner.damages.add(10);
            enemyBeginner.damages.add(10);
            enemy = enemyBeginner;
        }
    });
    intermButton.addActionListener(new AbstractAction("add"){
        @Override
        public void actionPerformed(ActionEvent e){
            label.setText("Difficulty set to intermediate");
            difficulty = "intermediate";
            newPlayer.setHp(newPlayer, 75);
            enemyIntermediate.setHp(enemyIntermediate, 75);
            enemyIntermediate.moves.add("punch");
            enemyIntermediate.moves.add("kick");
            enemyIntermediate.moves.add("slam");
            enemyIntermediate.damages.add(20);
            enemyIntermediate.damages.add(15);
            enemyIntermediate.damages.add(25); 
            enemy = enemyIntermediate;
        }
    });
    expertButton.addActionListener(new AbstractAction("add"){
        @Override
        public void actionPerformed(ActionEvent e){
            label.setText("Difficulty set to expert");
            difficulty = "expert";
            newPlayer.setHp(newPlayer, 100);
            enemyExpert.setHp(enemyExpert, 100);
            enemyExpert.moves.add("super punch");
            enemyExpert.moves.add("smash");
            enemyExpert.moves.add("jump kick");
            enemyExpert.damages.add(20);
            enemyExpert.damages.add(25);
            enemyExpert.damages.add(30); 
            enemy = enemyExpert;

        }
    });
    okButton.addActionListener(new AbstractAction("add"){
        @Override
        public void actionPerformed(ActionEvent e){
            newPlayer.name = name.getText();
            panel.removeAll();
            panel.updateUI();
            battleGUISelection(c);
        }
    });

    panel.add(begButton);
    panel.add(intermButton);
    panel.add(expertButton);
    panel.add(label);
    panel.add(name);
    panel.add(txtLabel);
    panel.add(okButton);
    panel.add(title);

    panel.setBackground(Color.WHITE);

    c.add(panel);           
}

public static void battleGUISelection(final Container c)
{       
    int yCoord = 100;

    final JPanel nextPanel = new JPanel();
    JLabel title = new JLabel();

    nextPanel.updateUI();

    ArrayList<JLabel> moveLabelList = new ArrayList<JLabel>();
    ArrayList<JLabel> damageLabelList = new ArrayList<JLabel>();

    title.setText("Moves Known: ");
    title.setBounds(200, 75, 100, 30);

    nextPanel.setLayout(null);  

    JButton battleButton = new JButton("Battle");
    JButton moveButton = new JButton("Teach Moves");
    JButton healButton = new JButton("Heal");

    battleButton.setBounds(0, 360, 500, 30);
    moveButton.setBounds(0, 390, 500, 30);
    healButton.setBounds(0, 420, 500, 30);

    moveButton.addActionListener(new AbstractAction("add"){
        @Override
        public void actionPerformed(ActionEvent e){
            nextPanel.removeAll();
            nextPanel.updateUI();
            teachMove(c, nextPanel);

        }
    });

    nextPanel.add(battleButton);
    nextPanel.add(moveButton);
    nextPanel.add(healButton);
    nextPanel.add(title);

    for(int i=0; i<newPlayer.moves.size(); i++)
    {
        moveLabelList.add(new JLabel(newPlayer.moves.get(i).toString()));
        moveLabelList.get(i).setBounds(185, yCoord, 100, 15);
        yCoord=yCoord+25;
        nextPanel.add(moveLabelList.get(i));
    }

    yCoord = 100;

    for(int x=0; x<newPlayer.damages.size(); x++)
    {
        damageLabelList.add(new JLabel(newPlayer.damages.get(x).toString() + " damage"));
        damageLabelList.get(x).setBounds(280, yCoord, 100, 15);
        yCoord=yCoord+25;
        nextPanel.add(damageLabelList.get(x));
    }

    nextPanel.setBackground(Color.WHITE);
    //nextPanel.setVisible(true);
    c.setVisible(true); 
    c.add(nextPanel);
}

public static void teachMove(final Container x, final JPanel newPanel)
{
    final int confirmYOrN = 0;

    final JTextField moveName = new JTextField();
    final JSlider moveDamage = new JSlider(0, 30);
    final JLabel confirm = new JLabel("Great! Your move has been added.");

    JLabel entryLabel = new JLabel("Enter the new move's name: ");
    JLabel damageEntryLabel = new JLabel("Enter the new move's damage: ");
    JButton enterButton = new JButton("OK");

    confirm.setBounds(160, 350, 200, 15);

    enterButton.addActionListener(new AbstractAction("add"){
        @Override
        public void actionPerformed(ActionEvent e){
            final String mName = moveName.getText();
            final int mDam = moveDamage.getValue();
            newPlayer.moves.add(mName);
            newPlayer.damages.add(mDam);

            newPanel.removeAll();
            newPanel.updateUI();

            battleGUISelection(x);

        }
    });

    moveDamage.setMajorTickSpacing(10);
    moveDamage.setMinorTickSpacing(5);
    moveDamage.setPaintTicks(true);
    moveDamage.setPaintLabels(true);

    entryLabel.setBounds(160, 125, 175, 25);
    damageEntryLabel.setBounds(160, 200, 200, 25);
    moveName.setBounds(160, 155, 175, 25);
    moveDamage.setBounds(160, 230, 175, 45);
    enterButton.setBounds(225, 290, 60, 50);

    newPanel.add(entryLabel);
    newPanel.add(moveName);
    newPanel.add(damageEntryLabel);
    newPanel.add(moveDamage);
    newPanel.add(enterButton);

    x.add(newPanel);
    x.setVisible(true); 
}
public static void main(String[] args)
{
    GUIFrameTest window = new GUIFrameTest("BattleGUI");
     //Window properties
    window.setBounds(300, 300, 500, 500);
    window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    window.setVisible(true);
}    
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T01:49:36.927

我已经为您提供了基本的 GUI 代码并更改为使用一系列布局......

```
public class GUICompoundLayout extends JFrame {

    JPanel panel = new JPanel();
    JButton begButton = new JButton("Beginner");
    JButton intermButton = new JButton("Intermediate");
    JButton expertButton = new JButton("Expert");
    JButton okButton = new JButton("OK");
    JLabel title = new JLabel("SELECT DIFFICULTY");
    JLabel label = new JLabel();
    JLabel txtLabel = new JLabel();
    TextField name = new TextField(10);
    static Battle newPlayer = new Battle("");
    static Battle enemyBeginner = new Battle("OPPONENT");
    static Battle enemyIntermediate = new Battle("OPPONENT");
    static Battle enemyExpert = new Battle("OPPONENT");
    static Battle enemy;
    static String difficulty;

    public GUICompoundLayout(String windowName) {
        super(windowName);

        JPanel pnlTop = new JPanel(new FlowLayout(FlowLayout.LEFT));
        JPanel pnlMiddle = new JPanel(new FlowLayout(FlowLayout.LEFT));
        JPanel pnlBody = new JPanel(new GridBagLayout());

        pnlTop.setBackground(Color.WHITE);
        pnlMiddle.setBackground(Color.WHITE);
        pnlBody.setBackground(Color.WHITE);

        pnlTop.add(title);
        pnlMiddle.add(begButton);
        pnlMiddle.add(intermButton);
        pnlMiddle.add(expertButton);

        txtLabel.setText("Enter name of player: ");

        GridBagConstraints gbc = new GridBagConstraints();
        gbc.gridx = 0;
        gbc.gridy = 0;
        gbc.insets = new Insets(2, 2, 2, 2);
        pnlBody.add(txtLabel, gbc);

        gbc.gridy++;
        pnlBody.add(name, gbc);

        gbc.gridy++;
        pnlBody.add(okButton, gbc);

        setLayout(new GridBagLayout());
        gbc = new GridBagConstraints();
        gbc.weightx = 1;
        gbc.fill = GridBagConstraints.HORIZONTAL;
        gbc.gridx = 0;
        gbc.gridy = 0;

        add(pnlTop, gbc);
        gbc.gridy++;
        add(pnlMiddle, gbc);
        gbc.gridy++;
        gbc.weightx = 1;
        gbc.weighty = 1;
        gbc.fill = GridBagConstraints.BOTH;
        add(pnlBody, gbc);

//        begButton.setBounds(0, 25, 100, 50);
//        intermButton.setBounds(125, 25, 110, 50);
//        expertButton.setBounds(255, 25, 100, 50);
//        label.setBounds(0, 100, 200, 50);
//        name.setBounds(188, 225, 125, 25);
//        txtLabel.setBounds(188, 178, 125, 50);
//        okButton.setBounds(200, 255, 100, 25);
//        title.setBounds(0, 0, 150, 15);
//
//        txtLabel.setText("Enter name of player: ");

        begButton.addActionListener(new AbstractAction("add") {
            @Override
            public void actionPerformed(ActionEvent e) {
                label.setText("Difficulty set to beginner");
                difficulty = "beginner";
                newPlayer.setHp(newPlayer, 50);
                enemyBeginner.setHp(enemyBeginner, 50);
                enemyBeginner.moves.add("punch");
                enemyBeginner.moves.add("kick");
                enemyBeginner.damages.add(10);
                enemyBeginner.damages.add(10);
                enemy = enemyBeginner;
            }
        });
        intermButton.addActionListener(new AbstractAction("add") {
            @Override
            public void actionPerformed(ActionEvent e) {
                label.setText("Difficulty set to intermediate");
                difficulty = "intermediate";
                newPlayer.setHp(newPlayer, 75);
                enemyIntermediate.setHp(enemyIntermediate, 75);
                enemyIntermediate.moves.add("punch");
                enemyIntermediate.moves.add("kick");
                enemyIntermediate.moves.add("slam");
                enemyIntermediate.damages.add(20);
                enemyIntermediate.damages.add(15);
                enemyIntermediate.damages.add(25);
                enemy = enemyIntermediate;
            }
        });
        expertButton.addActionListener(new AbstractAction("add") {
            @Override
            public void actionPerformed(ActionEvent e) {
                label.setText("Difficulty set to expert");
                difficulty = "expert";
                newPlayer.setHp(newPlayer, 100);
                enemyExpert.setHp(enemyExpert, 100);
                enemyExpert.moves.add("super punch");
                enemyExpert.moves.add("smash");
                enemyExpert.moves.add("jump kick");
                enemyExpert.damages.add(20);
                enemyExpert.damages.add(25);
                enemyExpert.damages.add(30);
                enemy = enemyExpert;

            }
        });
        okButton.addActionListener(new AbstractAction("add") {
            @Override
            public void actionPerformed(ActionEvent e) {
                newPlayer.name = name.getText();
                panel.removeAll();
                panel.updateUI();
                battleGUISelection(getContentPane());
            }
        });

//        panel.add(begButton);
//        panel.add(intermButton);
//        panel.add(expertButton);
//        panel.add(label);
//        panel.add(name);
//        panel.add(txtLabel);
//        panel.add(okButton);
//        panel.add(title);

//        panel.setBackground(Color.WHITE);

//        c.add(panel);
    }

    public static void battleGUISelection(final Container c) {
        int yCoord = 100;

        final JPanel nextPanel = new JPanel();
        JLabel title = new JLabel();

        nextPanel.updateUI();

        ArrayList<JLabel> moveLabelList = new ArrayList<JLabel>();
        ArrayList<JLabel> damageLabelList = new ArrayList<JLabel>();

        title.setText("Moves Known: ");
        title.setBounds(200, 75, 100, 30);

        nextPanel.setLayout(null);

        JButton battleButton = new JButton("Battle");
        JButton moveButton = new JButton("Teach Moves");
        JButton healButton = new JButton("Heal");

        battleButton.setBounds(0, 360, 500, 30);
        moveButton.setBounds(0, 390, 500, 30);
        healButton.setBounds(0, 420, 500, 30);

        moveButton.addActionListener(new AbstractAction("add") {
            @Override
            public void actionPerformed(ActionEvent e) {
                nextPanel.removeAll();
                nextPanel.updateUI();
                teachMove(c, nextPanel);

            }
        });

        nextPanel.add(battleButton);
        nextPanel.add(moveButton);
        nextPanel.add(healButton);
        nextPanel.add(title);

        for (int i = 0; i < newPlayer.moves.size(); i++) {
            moveLabelList.add(new JLabel(newPlayer.moves.get(i).toString()));
            moveLabelList.get(i).setBounds(185, yCoord, 100, 15);
            yCoord = yCoord + 25;
            nextPanel.add(moveLabelList.get(i));
        }

        yCoord = 100;

        for (int x = 0; x < newPlayer.damages.size(); x++) {
            damageLabelList.add(new JLabel(newPlayer.damages.get(x).toString() + " damage"));
            damageLabelList.get(x).setBounds(280, yCoord, 100, 15);
            yCoord = yCoord + 25;
            nextPanel.add(damageLabelList.get(x));
        }

        nextPanel.setBackground(Color.WHITE);
        //nextPanel.setVisible(true);
        c.setVisible(true);
        c.add(nextPanel);
    }

    public static void teachMove(final Container x, final JPanel newPanel) {
        final int confirmYOrN = 0;

        final JTextField moveName = new JTextField();
        final JSlider moveDamage = new JSlider(0, 30);
        final JLabel confirm = new JLabel("Great! Your move has been added.");

        JLabel entryLabel = new JLabel("Enter the new move's name: ");
        JLabel damageEntryLabel = new JLabel("Enter the new move's damage: ");
        JButton enterButton = new JButton("OK");

        confirm.setBounds(160, 350, 200, 15);

        enterButton.addActionListener(new AbstractAction("add") {
            @Override
            public void actionPerformed(ActionEvent e) {
                final String mName = moveName.getText();
                final int mDam = moveDamage.getValue();
                newPlayer.moves.add(mName);
                newPlayer.damages.add(mDam);

                newPanel.removeAll();
                newPanel.updateUI();

                battleGUISelection(x);

            }
        });

        moveDamage.setMajorTickSpacing(10);
        moveDamage.setMinorTickSpacing(5);
        moveDamage.setPaintTicks(true);
        moveDamage.setPaintLabels(true);

        entryLabel.setBounds(160, 125, 175, 25);
        damageEntryLabel.setBounds(160, 200, 200, 25);
        moveName.setBounds(160, 155, 175, 25);
        moveDamage.setBounds(160, 230, 175, 45);
        enterButton.setBounds(225, 290, 60, 50);

        newPanel.add(entryLabel);
        newPanel.add(moveName);
        newPanel.add(damageEntryLabel);
        newPanel.add(moveDamage);
        newPanel.add(enterButton);

        x.add(newPanel);
        x.setVisible(true);
    }

    public static void main(String[] args) {
        GUICompoundLayout window = new GUICompoundLayout("BattleGUI");
        //Window properties
        window.setBounds(300, 300, 500, 500);
        window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        window.setVisible(true);
    }
} 
```

这是我最终得到的用户界面......

![在此处输入图像描述](../Images/01b63b44ee18d069c09d9680668b7bdc.png)

布局管理器是您的朋友。 [花点时间学习它们](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)，它们将为您节省数小时的挫败感和烦恼。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T22:38:14.880

问题是你已经设置

```
nextPanel.setLayout(null); 
```

这导致面板的首选尺寸为零。考虑为此面板使用布局管理器，例如[BoxLayout 。](http://docs.oracle.com/javase/tutorial/uiswing/layout/box.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T22:28:36.983

很难看到，因为它是很多代码，但尝试在面板上调用 repaint() 而不是 updateUI()。

# javascript - 有没有什么地方可以获取 Windows 样式模态框的 CSS

> ID：12451240
> 
> 赞同：0
> 
> 时间：2012-09-16T22:23:13.900
> 
> 标签：javascript, jquery, windows, modal-dialog

我正在寻找一个看起来像 Windows 7 模态框的模态框。

例如，记事本框。

我以前在某个地方发现过这个，但我从来没有得到过这种风格，而且看起来真的很好。它具有调整大小的功能，这将是非常好的。

有什么地方可以得到我需要的图像吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T23:04:16.983

[Tomatocart](http://www.tomatocart.com/products/store-demo.html)的管理部分使用了惊人的 windows 图层样式...

您应该检查代码并尝试获取资产...

# enums - 使用 intPtr 和在 powershell 中使用 add-type 编组

> ID：12451246
> 
> 赞同：4
> 
> 时间：2012-09-16T22:23:53.673
> 
> 标签：enums, struct, powershell-2.0, add-type

我正在 Powershell 中尝试添加类型。我正在使用 netapi32.dll 处理 NetSessionEnum 函数。这几乎可以工作，但不完全。当用零级查询时，我可以得到一个结果。当使用任何其他选项查询时，IDE 或 powershell 会话在尝试编组 PtrToStructure 时只会崩溃。我完全被困住了？

我认为这与结构大小有关，但不确定。如果有人能指出我正确的方向或提供一些很棒的提示。

[NetSessionEnum 函数](http://msdn.microsoft.com/en-us/library/windows/desktop/bb525382%28v=vs.85%29.aspx)

```
function Get-NetSessions {

param(
[string]$ComputerName = "",
[string]$ComputerSession = "",
[string]$UserName = "",
[int]$QueryLevel

)

$DebugPreference = 'continue'

$signature = @'
[DllImport("netapi32.dll", SetLastError=true)]
public static extern int NetSessionEnum(
        [In,MarshalAs(UnmanagedType.LPWStr)] string ServerName,
        [In,MarshalAs(UnmanagedType.LPWStr)] string UncClientName,
        [In,MarshalAs(UnmanagedType.LPWStr)] string UserName,
        Int32 Level,
        out IntPtr bufptr,
        int prefmaxlen,
        ref Int32 entriesread,
        ref Int32 totalentries,
        ref Int32 resume_handle);
'@

$SessionInfoStructures = @'
namespace pinvoke {
using System;
using System.Runtime.InteropServices;

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    public struct SESSION_INFO_0
    {
    [MarshalAs(UnmanagedType.LPWStr)]
    public String sesi0_cname;
    }

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    public struct SESSION_INFO_1
    {
    [MarshalAs(UnmanagedType.LPWStr)]
    public string sesi1_cname;
    [MarshalAs(UnmanagedType.LPWStr)]
    public string sesi1_username;
    public uint sesi1_num_opens;
    public uint sesi1_time;
    public uint sesi1_idle_time;
    public uint sesi1_user_flag;
    }

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    public struct SESSION_INFO_2
    {
    [MarshalAs(UnmanagedType.LPWStr)]
    public string sesi2_cname;
    [MarshalAs(UnmanagedType.LPWStr)]
    public string sesi2_username;
    public uint  sesi2_num_opens;
    public uint  sesi2_time;
    public uint  sesi2_idle_time;
    public uint  sesi2_user_flags;
    [MarshalAs(UnmanagedType.LPWStr)]
    public string sesi2_cltype_name;
    }

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    public struct SESSION_INFO_10
    {
    [MarshalAs(UnmanagedType.LPWStr)]
    public string sesi10_cname;
    [MarshalAs(UnmanagedType.LPWStr)]
    public string sesi10_username;
    public uint sesi10_time;
    public uint sesi10_idle_time;
    }

    [StructLayout(LayoutKind.Sequential, CharSet = CharSet.Auto)]
    public struct SESSION_INFO_502
    {
    [MarshalAs(UnmanagedType.LPWStr)]
    public string sesi502_cname;
    [MarshalAs(UnmanagedType.LPWStr)]
    public string sesi502_username;
    public uint sesi502_num_opens;
    public uint sesi502_time;
    public uint sesi502_idle_time;
    public uint sesi502_user_flags;
    [MarshalAs(UnmanagedType.LPWStr)]
    public string sesi502_cltype_name;
    [MarshalAs(UnmanagedType.LPWStr)]
    public string sesi502_transport;
    }

    public enum NERR
    {
    /// <summary>
    /// Operation was a success.
    /// </summary>
    NERR_Success = 0,
    /// <summary>
    /// More data available to read. dderror getting all data.
    /// </summary>
    ERROR_MORE_DATA = 234,
    /// <summary>
    /// Network browsers not available.
    /// </summary>
    ERROR_NO_BROWSER_SERVERS_FOUND = 6118,
    /// <summary>
    /// LEVEL specified is not valid for this call.
    /// </summary>
    ERROR_INVALID_LEVEL = 124,
    /// <summary>
    /// Security context does not have permission to make this call.
    /// </summary>
    ERROR_ACCESS_DENIED = 5,
    /// <summary>
    /// Parameter was incorrect.
    /// </summary>
    ERROR_INVALID_PARAMETER = 87,
    /// <summary>
    /// Out of memory.
    /// </summary>
    ERROR_NOT_ENOUGH_MEMORY = 8,
    /// <summary>
    /// Unable to contact resource. Connection timed out.
    /// </summary>
    ERROR_NETWORK_BUSY = 54,
    /// <summary>
    /// Network Path not found.
    /// </summary>
    ERROR_BAD_NETPATH = 53,
    /// <summary>
    /// No available network connection to make call.
    /// </summary>
    ERROR_NO_NETWORK = 1222,
    /// <summary>
    /// Pointer is not valid.
    /// </summary>
    ERROR_INVALID_HANDLE_STATE = 1609,
    /// <summary>
    /// Extended Error.
    /// </summary>
    ERROR_EXTENDED_ERROR= 1208,
    /// <summary>
    /// Base.
    /// </summary>
    NERR_BASE = 2100,
    /// <summary>
    /// Unknown Directory.
    /// </summary>
    NERR_UnknownDevDir = (NERR_BASE + 16),
    /// <summary>
    /// Duplicate Share already exists on server.
    /// </summary>
    NERR_DuplicateShare = (NERR_BASE + 18),
    /// <summary>
    /// Memory allocation was to small.
    /// </summary>
    NERR_BufTooSmall = (NERR_BASE + 23)
    }

    public enum SESSION_LEVEL
    {
    /// <summary>
    /// ZERO
    /// </summary>
    LEVEL_0 = 0,
    /// <summary>
    /// ONE
    /// </summary>
    LEVEL_1 = 1,
    /// <summary>
    /// TWO
    /// </summary>
    LEVEL_2 = 2,
    /// <summary>
    /// TEN
    /// </summary>
    LEVEL_10 = 10,
    /// <summary>
    /// FIVE HUNDRED AND TWO
    /// </summary>
    LEVEL_502 = 502
    }
}
'@

# Add the custom structures and enums
Add-Type $SessionInfoStructures

# Add the function definition
Add-Type -MemberDefinition $signature -Name Win32Util -Namespace Pinvoke -Using Pinvoke

if ([Pinvoke.SESSION_LEVEL]::LEVEL_0 -eq $QueryLevel) {$x = New-Object pinvoke.SESSION_INFO_0}
if ([Pinvoke.SESSION_LEVEL]::LEVEL_1 -eq $QueryLevel) {$x = New-Object pinvoke.SESSION_INFO_1}
if ([Pinvoke.SESSION_LEVEL]::LEVEL_2 -eq $QueryLevel) {$x = New-Object pinvoke.SESSION_INFO_2}
if ([Pinvoke.SESSION_LEVEL]::LEVEL_10 -eq $QueryLevel) {$x = New-Object pinvoke.SESSION_INFO_10}
if ([Pinvoke.SESSION_LEVEL]::LEVEL_502 -eq $QueryLevel) {$x = New-Object pinvoke.SESSION_INFO_502}

# Declare the reference variables
$type = $x.gettype()
Write-Debug "$type.tostring()"

$ptrInfo = 0 
$EntriesRed = 0
$TotalRead = 0
$ResumeHandle = 0

# Call the function
$Result = [pinvoke.Win32Util]::NetSessionEnum($ComputerName,$ComputerSession,$UserName,0,[ref]$ptrInfo,-1,[ref]$EntriesRed,[ref]$TotalRead,[ref]$ResumeHandle)

$Result

if ($Result -eq ([pinvoke.NERR]::NERR_Success)){

    Write-Debug 'Result is success'
    Write-Debug "IntPtr $ptrInfo"
    Write-Debug "Entries read $EntriesRed"
    Write-Debug "Total Read $TotalRead"

    # Locate the offset of the initial intPtr
    $offset = $ptrInfo.ToInt64()
    Write-Debug "Starting Offset $offset"

    # Work out how mutch to increment the pointer by finding out the size of the structure
    $Increment = [System.Runtime.Interopservices.Marshal]::SizeOf($x)
    Write-Debug "Increment $Increment"

    for ($i = 0; ($i -lt $EntriesRed); $i++){

        $newintptr = New-Object system.Intptr -ArgumentList $offset
        Write-Debug "Newintptr `[$i`] $newintptr"
        $Info = [system.runtime.interopservices.marshal]::PtrToStructure($newintptr,$type)
        $Info | Select-Object *
        $offset = $newintptr.ToInt64()
        $offset += $increment
    }

}
else 
{
    #       switch ($Result)
    #           {
    #           ([Pinvoke.NERR]::ERROR_ACCESS_DENIED)       {Write-Host "The user does not have access to the requested information."}
    #           ([Pinvoke.NERR]::ERROR_INVALID_LEVEL)       {Write-Host "The value specified for the level parameter is not valid."}
    #           ([Pinvoke.NERR]::ERROR_INVALID_PARAMETER)   {Write-Host 'The specified parameter is not valid.'}
    #           ([Pinvoke.NERR]::ERROR_MORE_DATA)           {Write-Host 'More entries are available. Specify a large enough buffer to receive all entries.'}
    #           ([Pinvoke.NERR]::ERROR_NOT_ENOUGH_MEMORY)   {Write-Host 'Insufficient memory is available.'}
    #           ([Pinvoke.NERR]::NERR_ClientNameNotFound)   {Write-Host 'A session does not exist with the computer name.'}
    #           ([Pinvoke.NERR]::NERR_InvalidComputer)      {Write-Host 'The computer name is not valid.'}
    #           ([Pinvoke.NERR]::NERR_ClientNameNotFound)   {Write-Host 'The user name could not be found.'}                
    #           }
}
}

Get-NetSessions -QueryLevel 0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-06T20:34:28.823

我早就放弃了上面的事情，转而去做其他事情，直到有什么事情再次引起了我的兴趣。

[https://support.microsoft.com/en-us/help/2909958/exceptions-in-windows-powershell-other-dynamic-languages-and-dynamical](https://support.microsoft.com/en-us/help/2909958/exceptions-in-windows-powershell-other-dynamic-languages-and-dynamical)

当添加这个非常小的修改时，上面的代码工作（没有抛出错误）：

```
$Info = [system.runtime.interopservices.marshal]::PtrToStructure($newintptr,$type) 
```

至

```
$Info = [system.runtime.interopservices.marshal]::PtrToStructure($newintptr,[System.Type]$type) 
```

如果您对使用 Windows API 感兴趣，[此](http://www.harmj0y.net/blog/powershell/powershell-and-win32-api-access/)人有一些有趣的工作和一些其他优秀资源的链接。

感谢 NullBind 的回复，非常感谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-27T16:52:14.443

我玩了一下这个，似乎你忘记做的唯一重要的事情就是`$QueryLevel`在你调用它时将变量传递给函数的“级别”参数。`0`当前调用函数时它静态设置的级别参数。结果，当您将 设置为结构`$Querylevel`以外`0`的任何内容时，级别返回的数据`0`不匹配并且脚本崩溃......或类似的东西。

**这就是你所拥有的：**

```
# Call the function<br>
$Result = [pinvoke.Win32Util]::NetSessionEnum($ComputerName,$ComputerSession,$UserName,0,[ref]$ptrInfo,-1,[ref]$EntriesRed,[ref]$TotalRead,[ref]$ResumeHandle) 
```

**这似乎有效：**

```
# Call the function
$Result = [pinvoke.Win32Util]::NetSessionEnum($ComputerName,$ComputerSession,$UserName, $QueryLevel,[ref]$ptrInfo,-1,[ref]$EntriesRed,[ref]$TotalRead,[ref]$ResumeHandle) 
```

我对高级 PowerShellery 有点陌生。因此，如果我不在我的摇杆上，请告诉我，但希望这会有所帮助。

# ruby-on-rails - 使用 Rails 的部分内容为每个用户包含不同的 html

> ID：12451249
> 
> 赞同：0
> 
> 时间：2012-09-16T22:24:12.137
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, partial-views, erb

我正在使用 Rails 3.2.8，需要根据 URL 参数和登录的用户帐户在特定网页中包含或导入 HTML（实际上是 ERB）文件。所以导入的 HTML/ERB 文件会经常不同。

例如，我在 show.html.erb 文件中有以下代码：

```
<%= render "levels/#{@level.name}/#{@user.version}" %> 
```

为此目的使用部分是否合适？根据[文档](http://guides.rubyonrails.org/layouts_and_rendering.html#using-partials)，partials“是将渲染过程分解为更易于管理的块的另一种设备”。我使用部分不是为了模块化页面构建过程，而是动态呈现不同的内容。我担心我正在做的事情的性能后果和副作用。有没有更好的方法来完成我想要用 Rails 完成的任务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T23:55:20.667

如果这些部分有一定数量（有 3 个级别和 2 个版本），那么有 6 个可以调用的部分可能是有意义的。随着这种情况的增加，使用嵌入式 ruby​​ 来呈现不同的 html 可能会更好。那是

```
<div>
  <% if user.version == 2 %>
    <!-- render some stuff -->
  <% else %>
    <p>
      <!-- some other stuff -->
    </p>
  <% end %>
</div> 
```

如果您担心性能，可以使用[片段缓存](http://api.rubyonrails.org/classes/ActionController/Caching/Fragments.html)。Heroku 在缓存方面有很好的 [速成课程](https://devcenter.heroku.com/articles/caching-strategies)。

简而言之，是的，partials 可以这样使用；但就个人而言，我会尝试将其重构为少量缓存代码块的部分

如果你有成千上万的部分，我认为没有一种单一的方法来处理它们。在我看来，它几乎可以是一个单独的应用程序，您希望将其嵌入到您的应用程序中。[Rails 使用引擎](http://edgeapi.rubyonrails.org/classes/Rails/Engine.html)解决了这个问题。如果引擎不是一个选项，您还可以查看[Presenters](http://blog.nhocki.com/2012/01/10/simple-presenters--decorators-on-rails)。

# javascript - 如何从 URL 收集变量，将它们插入数组并动态更改 href URL？

> ID：12451258
> 
> 赞同：2
> 
> 时间：2012-09-16T22:25:31.773
> 
> 标签：javascript, url, parameters, onclick, href

如何从 URL 收集变量，将它们插入数组并动态更改 href URL？

我不是开发人员，所以请在这里放轻松！我熟悉 HTML，并且不擅长从各种来源获取代码片段并将它们拼凑在一起。这是我第一次决定在这样的博客上寻求帮助，因为我一直在环顾四周，但似乎找不到我真正需要的东西。非常接近，但到目前为止..请帮助！

我想做的是：

1.  像这样从 URL 收集变量（`wwww.myurl.com/index.html?var1=1&var2=2&var3=3`等等等等）

2.  取出这些变量并将它们插入到数组中，同时去掉不需要的部分。我找到了这段代码，它得到了它，但将它打印在屏幕上，我不需要..

    ```
    myurl.com/index.html?log=1&pass=2 
    ```

    ```
    function addComment()
    {
        var parameters = location.search.substring(1).split("&");

        var temp = parameters[0].split("=");
        l = unescape(temp[1]);

        temp = parameters[1].split("=");
        c = unescape(temp[1]);

        document.getElementById("log").innerHTML = l;
        document.getElementById("pass").innerHTML = c;
    }
    addComment();

    <p>http://www.myurl.com/</b><span id="log" ></span></p>
    <p>http://www.myurl.com/</b><span id="pass"></span></p>

    </script> 
    ```

3.  根据从 URL 收集的参数动态更改 href 标记。

我发现这段代码可以很好地更改 URL，但是 (a) 变量是从输入表单中收集的，我需要能够从 URL 中获取它们。(b) 我还需要其中几个（可能是 20 个），所以需要一个数组。

```
<input type="text" id="mySearchBox" />
<a href="http://www.myurl.com/index.html?" onclick="this.href+=+document.getElementById('mySearchBox').value">Enter Parameter</a> 
```

（编辑代码格式）

* * *

关于技术...我不拘泥于任何特定的语言或方法，但 javascript 和 jquery 对我来说似乎是最简单的。**我对PHP**和其他语言做得不多。您可以提供更好的傻瓜最简单的方法。

我敢肯定这对你来说就像小学的东西，但我似乎无法弄清楚，所以非常感谢你的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T22:35:34.600

用于读取和修改查询字符串的出色 jQuery 插件：http: [//archive.plugins.jquery.com/project/query-object](http://archive.plugins.jquery.com/project/query-object)

只需使用它来完成工作或检查它的来源以获得您问题的答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T08:09:29.700

**Javascript 和 jQuery**

addComment 函数的第一行从 url 获取 searchsrtstring，这一切都来自（和）？直到（和没有）散列（#）或结尾（如果没有散列）。

之后，第一个字符 (?) 用 . 删除`substr(1)`。最后，字符串在每个“&”处用`.split("&")`. 所有拆分的部分都存储在一个数组中。将其应用于示例：

`www.myurl.com/index.html?var1=1&var2=2&var3=3`

变成

`["var1=1", "var2=2", "var3=3"]`

这个数组存储在变量参数中。接下来，数组的第一个元素在“=”字符处拆分。我们得到

`temp = ["var1", "1"]`

temp 的第二个元素未转义（用于将 %20 等 url 中的特殊字符解码为 " " （空格））

要创建一个对象，首先创建一个空对象，然后像这样填充它：

`var obj = {};`

`obj[ temp[0] ] = temp[1];`

在 for 循环中使用参数中的所有元素执行此操作将使您：

`obj = { var1 : 1, var2 : 2, var3 : 3 }`

你想要的对象。这是一个非常简单的解析器，对于更复杂的值可能无法正常工作。这是上面描述的完整代码：

```
function getUrlObj() {
  var parameters = location.search.substring(1).split("&");
  var obj = {};
  for( var i = 0; i < parameters.length; ++i) {
    var tmp = parameters[i].split("=");
    obj[ tmp[0] ] = unescape( tmp[1] );
  }
  return obj
} 
```

现在到链接：

在您的示例中，链接的 onclick 事件决定了加载哪个 url。像这样，浏览器的状态栏不会显示正确的目的地，这更难以调试且用户友好性较差。另一种方法（使用 jQuery）是收集页面中的所有链接并根据 url 更改它们的 href 标签。这可以在页面（或更好的 DOM）加载后完成。一个 jquery 示例可能如下所示：

```
$( function() { //called when dom is ready
  //get url object
  var urlObj = getUrlObj();
  //find all <a> elements on page
  // iterate over elements
  $('a').each(function() {
    // change attribute href
    $(this).attr('href', 'new url goes here');
  });
}); 
```

我猜你想在新的 url 中插入 url 对象的某些部分。href 属性的初始值是多少？它到底应该是什么样子？

初始值可以指示必须如何更改 url。可以使用`.attr('href')`jquery 中的方法访问属性的值（第二个参数会更改值）。

该方法（和其他）的详细说明`.attr()`可以在 jquery 文档中找到：http: [//api.jquery.com/attr/](http://api.jquery.com/attr/)

如果您不想更改所有链接元素，则可以将类应用于要修改的链接，例如：

`<a class="modify" href...`

然后使用 `$('.modify')`(with dot) 而不是. 访问这些元素`$('a')`。

**PHP**

如果你想用 php 来做，代码可能会简单得多，因为 php 可以本地处理 url 查询字符串。例子：

`<a href="<?php echo $_GET["var1"]; ?>.php">link</a>`

将导致您的示例链接到“1.php”。

**更新**：（根据评论中的讨论）

搜索查询`?iframe1=1&banner1=1&button1=1&button2=2&button3=3`与 url 一起发送到服务器。如上所述， PHP 可以通过魔术[变量`$_GET`](http://php.net/manual/de/reserved.variables.get.php)直接访问搜索查询的值。$_GET['button1'] 将为 1。

要使用该变量，文件结尾必须是 .php，以便服务器知道必须评估文件的内容。生成的文件将是一个普通的 html 文件（以 php 结尾）。

写作`<?php`表示以下文字最多`?>`为php代码。`echo "something";`将字符串打印`something`到生成的 html 文件中。将某些内容打印到文档的快捷方式是`<?="text" ?>`. 可以打印变量而不是字符串：`<?=$somevar ?>`.

将此应用于示例，html 文件必须更新如下内容：

```
<a target="theiframe" href="www.mysite.com/redirect2external?<?=$_GET['button1'] ?>">a link</a>
<a target="theiframe" href="www.mysite.com/redirect2external?<?=$_GET['button2'] ?>">another link</a> 
```

等等。iframe（或横幅）相同：

```
<iframe name="theiframe" src="www.mysite.com/redirect2external?<?=$_GET['iframe1'] ?>"/> 
```

将所有 html 文件组合到一个 php 文件中的另一种（更好的）方法是使用代表页面的数字或字符串。例如`?page=somepage`（尽量避免特殊字符和空格，它们可能无法正常工作）。

在 php 文件中，所有页面都会有一个开关：

```
<?php if( $_GET['page'] == "somepage" ) { ?>
  <a target="theiframe" href="www.mysite.com/redirect2external?1">a link</a>
  <a target="theiframe" href="www.mysite.com/redirect2external?2">another link</a>
<?php } elseif( $_GET['page'] == "someotherpage" ) { ?>
  <a target="theiframe" href="www.mysite.com/redirect2external?3">a link</a>
  <a target="theiframe" href="www.mysite.com/redirect2external?4">another link</a>
<?php } //and so on (btw this is a php comment) ?> 
```

这种方法的优点是：

1.  较短的网址
2.  在第一种方法中，如果稍后添加了新按钮，则必须更改指向该页面的所有链接，在 url 中添加 buttonx=x。如果有人使用书签（带有旧网址）导航到该站点，附加按钮也将不起作用。

# android - Edittext不填充父级

> ID：12451260
> 
> 赞同：0
> 
> 时间：2012-09-16T22:25:39.950
> 
> 标签：android, xml, styles

所以我正在尝试使用我的片段的表格布局制作带有提交按钮的教科书，但问题是教科书正在变成按钮的大小。它没有填充宽度

```
<?xml version="1.0" encoding="utf-8"?>
<TableLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal">

        <TableRow
            android:id="@+id/tableRow1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >

            <EditText
                android:id="@+id/editText1"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:inputType="textUri" />

        </TableRow>

        <TableRow
            android:id="@+id/tableRow3"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >

            <Button
                android:id="@+id/button_as"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="As" />

        </TableRow>

</TableLayout> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T22:42:59.530

目前，整个列的宽度由后续 Button 的宽度定义。这是因为该按钮是列中最宽的。

在您的`TableLayout`元素中，您希望通过声明将第一列（索引 0）标记为可拉伸`android:stretchColumns`。

```
<TableLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal"
    android:stretchColumns="0"> 
```

# objective-c - IOS app通过TestFlight抛出SIGSEGV异常

> ID：12451263
> 
> 赞同：2
> 
> 时间：2012-09-16T22:26:47.767
> 
> 标签：objective-c, testflight

我有一个我开发的 IOS 应用程序，当通过 xCode 部署时，它在模拟器和我的IPOD touch 上运行良好。我试图通过 TestFlight 与测试人员分享它；但应用程序总是遇到 SIGSEGV 异常。当我通过 TestFlight 加载应用程序时，我的 IPOD 触摸发生了同样的异常；但当我在我的IPOD touch上通过xCode运行应用程序时不会。

我已尽力追踪问题并使用远程日志记录并确定了失败的代码行；我不清楚它为什么会失败，我能做些什么，以及为什么它可以通过 xCode 而不是 TestFlight。

这是注销放置：

```
2012-09-16 14:46:41 TestFlight: Crash Handlers are installed
2012-09-16 14:46:41 Bootstrap
2012-09-16 14:46:41 bind settingsLoaded
2012-09-16 14:46:41 adding listeners to map
2012-09-16 14:46:41 listener map {
settingsLoaded = "{(\n)}";
}
2012-09-16 14:46:41 Loading appModel
2012-09-16 14:46:41 Loading settings
2012-09-16 14:46:41 Waiting for data to load
2012-09-16 14:46:42 TestFlight: Team Token is recognized
2012-09-16 14:46:42 Loading settings content
2012-09-16 14:46:42 Loading startScreen
2012-09-16 14:46:42 Loading jpegQuality
2012-09-16 14:46:42 Loading paperSize
2012-09-16 14:46:42 Loading showGrid
2012-09-16 14:46:42 Loading cropMode
2012-09-16 14:46:42 Loading filterType
2012-09-16 14:46:42 Loading adjustAllPages
2012-09-16 14:46:42 Loading settings complete
2012-09-16 14:46:42 triggering settings loaded
2012-09-16 14:46:42 trigger settingsLoaded
2012-09-16 14:46:42 triggerEvent settingsLoaded
2012-09-16 14:46:42 getting listeners from map 
```

这是我失败的类的头文件

```
#import <Foundation/Foundation.h>
#import "Gritz.h"

@interface GritzObject : NSObject {

    NSMutableDictionary *listenerMap;
}

#pragma creation

+ (GritzEvent*) create;

#pragma Events

- (void) bind:(void (^)(GritzEvent*))listener forEvent:(NSString*)name;
- (void) unbind:(void (^)(GritzEvent*))listener forEvent:(NSString*)name;
- (void) trigger:(NSString*)name;
- (void) triggerEvent:(GritzEvent*)event;

@end 
```

这是失败的类的实现文件

```
#import "GritzObject.h"
#import "TestFlight.h"

@implementation GritzObject 

#pragma create

+ (GritzObject *)create {

    return [[GritzObject alloc] init];
}

- (id)init {

    self = [super init];
    if(self) {
        listenerMap = [[NSMutableDictionary alloc] init];
    }
    return self;
}

#pragma events

- (void)bind:(void (^)(GritzEvent*))listener forEvent:(NSString *)name {

    TFLog(@"bind %@", name);

    NSMutableSet* listeners = [listenerMap objectForKey:name];

    if(nil == listeners) {

        TFLog(@"adding listeners to map");

        listeners = [[NSMutableSet alloc] init];

        [listenerMap setValue:listeners forKey:name];

        TFLog(@"listener map %@", listenerMap);
    }

    [listeners addObject:listener];
}

- (void)unbind:(void (^)(GritzEvent*))listener forEvent:(NSString *)name {

    TFLog(@"unbind %@", name);

    NSMutableSet* listeners = [listenerMap objectForKey:name];

    if(nil != listeners) {
        [listeners removeObject:listener];
    }
}

- (void)trigger:(NSString *)name {

    TFLog(@"trigger %@", name);

    [self triggerEvent:[GritzEvent withName:name]];
}

- (void)triggerEvent:(GritzEvent *)event {

    TFLog(@"triggerEvent %@", event.name);

    TFLog(@"getting listeners from map");

    TFLog(@"listener map %@", listenerMap); // This throws a SIGSEGV exception

    NSMutableSet* listeners = [listenerMap objectForKey:event.name];

    TFLog(@"inspecting listeners array");

    if(nil != listeners) {

        for (void (^listener)(GritzEvent*) in listeners) {
            listener(event);
        }
    }
    else {

        TFLog(@"no listeners found for event %@", event.name);
    }
}

@end 
```

从日志语句中我可以看出，尝试访问listnerMap 时会发生异常。看起来这个变量正在被取消引用；但目前尚不清楚为什么或我能做些什么？

我正在为这个应用程序使用 ARC。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T05:20:55.950

我遇到的问题是通过在将块存储到 NSSet 之前“复制”块来解决的。在将块存储到集合中之前，必须对其进行复制。

我改变了这条线

```
[listeners addObject:listener]; 
```

至

```
[listeners addObject:[listener copy]]; 
```

# mysql - MySQL - 在表之间插入或更新行

> ID：12451272
> 
> 赞同：1
> 
> 时间：2012-09-16T22:28:39.963
> 
> 标签：mysql

TableA：ID、邮件、团队、[其他列]

TableB：ID、邮件、团队、[其他列]

ID 是两个表中的主键。我需要处理 TableB 中的每一行，并且：

1.  如果 ID 在 TableA 中不存在，则插入新行 - 使用列 ID、邮件、团队（仅限）
2.  如果 ID 确实存在于 TableA 中，则使用新的邮件值更新行（仅限）
3.  存在于 TableA 但不存在于 TableB 行中的 ID 应保持不变

我有 ：

```
INSERT INTO tablea (id,mail,team) (SELECT id,mail,team FROM tableb)
ON DUPLICATE KEY update tablea SET tablea.mail=tableb.mail; 
```

这不起作用 - 我想我需要加入才能使最后一个 SET 命令有效，但不确定这部分，有人可以帮忙吗？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T22:34:07.777

如[`INSERT ... ON DUPLICATE KEY UPDATE`语法](http://dev.mysql.com/doc/en/insert-on-duplicate.html)中所述：

> 您可以使用子句中的函数来引用语句部分中的列值。换句话说，在子句中是指将被插入的值，没有发生重复键冲突。此功能在多行插入中特别有用。[`VALUES(*col_name*)`](http://dev.mysql.com/doc/en/miscellaneous-functions.html#function_values)[`UPDATE`](http://dev.mysql.com/doc/en/update.html)[`INSERT`](http://dev.mysql.com/doc/en/insert.html)[`INSERT ... ON DUPLICATE KEY UPDATE`](http://dev.mysql.com/doc/en/insert-on-duplicate.html)[`VALUES(*col_name*)`](http://dev.mysql.com/doc/en/miscellaneous-functions.html#function_values)`ON DUPLICATE KEY UPDATE`*`col_name`*

所以：

```
INSERT INTO tablea (id, mail, team)
SELECT id, mail, team FROM tableb
ON DUPLICATE KEY UPDATE mail = VALUES(mail) 
```

# android - WebView 上传 HTML 不起作用

> ID：12451273
> 
> 赞同：4
> 
> 时间：2012-09-16T22:28:46.260
> 
> 标签：android, webview

> **可能重复：**
> [WebView 中的文件上传](https://stackoverflow.com/questions/5907369/file-upload-in-webview)

我希望这个问题有一个简单的答案。我在我的应用程序中运行了这个 Android 代码：

```
package com.example.myfirstapp;

import android.webkit.WebViewClient;
import android.webkit.WebView;
import android.util.Log;

public class MyWebViewClient extends WebViewClient {
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
            view.loadUrl(url);
            Log.d ("myfirstapp_tag", "shouldOver... loaded Url " + url  );
            return true;
    }
} 
```

...但是当这个 HTML 被加载时...

```
<tr><td>
    <form method="post" action="/myphp.php" enctype="multipart/form-data">
            <label for="upload">Add Pic:</label><input type="file" name="file" id="file" />
            <input type="hidden" name="action" value="upload" />
            <input type="submit" name="submit" value="Upload" />
    </form>
</td></tr> 
```

...表单显示有一个“选择文件”按钮，但是当我点击它时没有任何反应。我在这里做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T23:27:45.873

我在stackoverflow上找到了答案，但丢失了链接，所以这就是我必须做的......

在我的 MainActivity 课程中，我这样做......

```
...
import android.webkit.ValueCallback;
import android.net.Uri;

public class MainActivity extends Activity {
...
private ValueCallback<Uri> mUploadMessage;
private final static int FILECHOOSER_RESULTCODE=1; 

@Override  
protected void onActivityResult(int requestCode, int resultCode, Intent intent) {  
    if(requestCode==FILECHOOSER_RESULTCODE)  {  
        if (null == mUploadMessage) return;  
        Uri result = intent == null || resultCode != RESULT_OK ? null  : intent.getData();  
        mUploadMessage.onReceiveValue(result);  
        mUploadMessage = null;
    }  
}  

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) { 
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    WebView webView = (WebView) findViewById(R.id.webview);
    webView.getSettings().setJavaScriptEnabled(true);
    webView.setWebViewClient(new MyWebViewClient());

    webView.setWebChromeClient(
        new WebChromeClient() {   
            @SuppressWarnings("unused")
            public void openFileChooser(ValueCallback<Uri> uploadMsg) {  
                mUploadMessage = uploadMsg;  
Log.d ("myfirstapp_tag", "1) MainActivity.java loaded openFileChooser" );
                Intent i = new Intent(Intent.ACTION_GET_CONTENT);  
Log.d ("myfirstapp_tag", "2) MainActivity.java loaded openFileChooser" );                   
                i.addCategory(Intent.CATEGORY_OPENABLE);  
Log.d ("myfirstapp_tag", "3) MainActivity.java loaded openFileChooser" );
                i.setType("image/*");  
Log.d ("myfirstapp_tag", "4) MainActivity.java loaded openFileChooser" );
MainActivity.this.startActivityForResult(Intent.createChooser(i,"File Chooser"), FILECHOOSER_RESULTCODE);
Log.d ("myfirstapp_tag", "5) MainActivity.java loaded openFileChooser" );                     
            }  
        }
    );  

    webView.loadUrl("http://example.com/EZC.php");
    setContentView(webView);
    Log.d ("myfirstapp_tag", "MainActivity.java loaded URL and set Content View." ); 
}   
 } 
```

# javascript - 使用具有相同 javascript 函数的不同变量

> ID：12451274
> 
> 赞同：0
> 
> 时间：2012-09-16T22:29:02.337
> 
> 标签：javascript, forms, function, variables, verify

我正在尝试创建一个通用的 Javascript 函数，我可以使用它来验证不同的字段值并在正确的字段旁边输出错误消息。我想创建一个高效、可重用的函数，但我是 Javascript 新手，不确定如何继续。

建议如何更改我的验证功能以验证两者`firstname`，`lastname`我们将不胜感激。

到目前为止我的代码：

```
function validateForm() {
    var x = document.forms["myForm"]["firstname"].value;
    var reg_azs = /^[^a-zA-Z\-']+$/;
    var reg_oal = "!#$%^&*()+=[]\\\';,{}|\":<>?123456790";

    if (x == null || x == "") {
        document.getElementById("fn").innerHTML = "This fuild is required.";
        return false;
    } else if (reg_azs.test(firstname.value)) {
        document.getElementById("fn").innerHTML = "Only alphabetic letters.";
        return false;
    } else {
        for (var i = 0; i < x.length; i++) {
            if (reg_oal.indexOf(x.charAt(i)) != -1) {
                document.getElementById("fn").innerHTML = "Only alphabetic letters.";
                return false;
            }
        }
    } else {
        document.getElementById("fn").innerHTML = "correct";
        return true;
    }
} 
```

我的表格：

```
<form name="myForm" action="connection.php" method="post">
    <label for='firstname'>First Name:</label>
    <input type="text" id="firstname" name="firstname" onchange="return validateForm()" />
    <err1 id="fn"></err1>
    <br>  

    <label for='lastname'>Last Name:</label>
    <input type="text" id="lastname" name="lastname" onchange="return validateForm()" />
    <err1 id="ln"></err1>
    <br>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T22:38:29.037

我会让函数接受一些参数：`id`被检查`id`的元素，显示错误消息的元素，然后可能是一串正则表达式来验证它（可能是可选的）。

从那里，您可以设置`x`为：

```
var x=document.getElementById(param1).value; 
```

并且每次您引用错误元素时，如下所示：

```
document.getElementById("fn") 
```

将其更改为：

```
document.getElementById(param2) 
```

所以你的函数声明看起来像这样：

```
function validateForm(param1, param2) { 
```

当你调用它时，它看起来像：

```
onchange="return validateForm('firstname', 'fn');"
onchange="return validateForm('lastname', 'ln');" 
```

等等。

您可能还想更改参数名称，`param1`并且`param2`只是例如，可能更好，分别为`targetElem`和。`errorLabel`

更新：

这种设计也是狭隘的，因此您必须调用`validateForm`要验证的每个元素。另一种方法是，允许通过一个函数调用验证多个元素是使用对象数组，其中每个对象具有如下形式：

```
{"element_id": "whatever", "error_id": "whatever"} 
```

但是在您的函数中，您将遍历单个参数（一个数组），并像这样访问每个参数：

```
for (var i = 0; i < param1.length; i++) {
    // Use param1[i]["element_id"] and param1[i]["error_id"]
} 
```

In this case, you can add extra things to each object, to allow for specific validation rules, such as not being empty, at least a certain length, no longer than a certain length, etc. ...and in the loop, you'd have to check for those things being present.

# javascript - 如何将消息发布到同级 iFrame

> ID：12451275
> 
> 赞同：2
> 
> 时间：2012-09-16T22:29:26.080
> 
> 标签：javascript, iframe, xss, postmessage

我正在寻找一种在父页面中没有任何 javascript 的情况下将消息发布到兄弟 iFrame 的方法。我遇到的困难是尝试从第一个 iFrame 获取另一个 iFrame 的窗口对象

该页面的布局如下：

```
html body (http://host.com/)
  iFrame#a (http://me.com/a)
  iFrame#b (http://me.com/b) 
```

从`iFrame#a`我想做的事：

```
(iFrame#b window).postMessage(...) 
```

问题是我不知道如何`iFrame#b`从内部获取窗口对象`iFrame#a`。`parent.getElementById()`和其他功能受 XSS 限制。在上面的示例中，我只想向`postMessage`父页面上来自我的域的所有其他 iFrame发出 a 。`http://me.com/`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-17T11:40:44.827

虽然不可能与另一个域上的另一个窗口/iframe 进行交互，但**可以**获取对此类窗口/iframe 以及嵌入该窗口/iframe 的所有子 iframe 的引用。这样做的方法是使用`window.top.frames`（访问顶部窗口对象）或`window.parent.frames`（访问直接父窗口对象，同时可能还有其他更高级别的祖先）。无需使用`getElementById`或其他与 DOM 相关的功能。有关更多信息，请参见：[https ://developer.mozilla.org/en-US/docs/DOM/window.frames](https://developer.mozilla.org/en-US/docs/DOM/window.frames)

window.frames 属性返回一个类似数组的对象，然后您可以对其进行迭代并在每个 iframe 上执行 postMessage。这不会触发同源限制，因为除了在它们上使用 postMessage 之外，您不会以任何方式与任何窗口进行交互。由于您想对来自特定域的每个 iframe 执行 postMessage，您可以这样做：

```
var frames = window.parent.frames;
for (var i = 0; i < frames.length; i++) { 
  frames[i].postMessage("hello", targetDomain);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-16T22:54:01.770

您将无法执行此操作，因为 iframe 无法与其嵌入的页面（也不是该页面中的任何内容）进行交互，除非父级位于同一域下（在您的示例中，它不是）。如果可以的话，它会造成 XSS 安全问题，正如您所指出的那样。

相反，您可以：

*   在 /a/ 中设置一个 cookie 并在 /b/ 中轮询它（这会很昂贵，因为 /b/ 必须以某种方式继续调用服务器）
*   使用“HTML5”持久数据存储机制，从 /a/ 存储数据并在 /b/ 中轮询（也许可以使用[localStorage ）](http://www.w3schools.com/html5/html5_webstorage.asp)
*   使用[websocket](http://net.tutsplus.com/tutorials/javascript-ajax/start-using-html5-websockets-today/)通过服务器链接所有兄弟姐妹
*   重新考虑您要做什么：您要实现的目标听起来很奇怪-您确定没有比使用这样的 iframe 更好的做事方式吗？

# bash - 将标准输出捕获到变量，但仍将其显示在控制台中

> ID：12451278
> 
> 赞同：85
> 
> 时间：2012-09-16T22:30:22.303
> 
> 标签：bash, ubuntu, tee, process-substitution

我有一个 bash 脚本，它调用了几个长时间运行的进程。出于处理原因，我想将这些调用的输出捕获到变量中。但是，因为这些是长时间运行的进程，我希望 rsync 调用的输出*实时*显示在控制台中，而不是事后显示。

为此，我[找到](http://sebthom.de/158-bash-capturing-stderr-variable/)了一种方法，但它依赖于将文本输出到 /dev/stderr。我觉得输出到 /dev/stderr 不是一个好的做事方式。

```
VAR1=$(for i in {1..5}; do sleep 1; echo $i; done | tee /dev/stderr)

VAR2=$(rsync -r -t --out-format='%n%L' --delete -s /path/source1/ /path/target1 | tee /dev/stderr)

VAR3=$(rsync -r -t --out-format='%n%L' --delete -s /path/source2/ /path/target2 | tee /dev/stderr) 
```

在上面的示例中，我调用了 rsync 几次，我想在处理文件名时查看它们，但最后我仍然希望将输出放在变量中，因为稍后我将对其进行解析。

有没有一种“更清洁”的方式来实现这一点？

如果有什么不同，我使用的是 Ubuntu 12.04，bash 4.2.24。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-09-16T22:58:56.983

在您的 shell 中复制 &1（在我的示例中为 5）并在子 shell 中使用 &5（这样您将写入父 shell 的标准输出（&1））：

```
exec 5>&1
FF=$(echo aaa|tee >(cat - >&5))
echo $FF 
```

将打印 aaa 两次，因为子外壳中的 echo，第二次打印变量的值。

在您的代码中：

```
exec 5>&1
VAR1=$(for i in {1..5}; do sleep 1; echo $i; done | tee >(cat - >&5))
# use the value of VAR1 
```

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2013-04-30T04:25:38.203

Op De Cirkel 的回答是正确的。它可以进一步简化（避免使用`cat`）：

```
exec 5>&1
FF=$(echo aaa|tee /dev/fd/5)
echo $FF 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2017-01-30T19:18:28.277

这是一个捕获`stderr`命令的退出代码的示例。这是建立在罗素戴维斯的答案之上的。

```
exec 5>&1
FF=$(ls /taco/ 2>&1 |tee /dev/fd/5; exit ${PIPESTATUS[0]})
exit_code=$?
echo "$FF"
echo "Exit Code: $exit_code" 
```

如果文件夹`/taco/`存在，这将捕获其内容。如果该文件夹不存在，它将捕获一条错误消息，退出代码将为 2。

如果您省略`2>&1`then only`stdout`将被捕获。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-11-16T12:50:16.813

如果“控制台”是指您当前的 TTY，请尝试

```
variable=$(command with options | tee /dev/tty) 
```

这是一个有点可疑的做法，因为尝试使用它的人有时会在没有 TTY（cron 作业等）时输出到达意想不到的地方时感到惊讶。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-09-16T22:41:35.117

您可以使用三个以上的文件描述符。在这里试试：

[http://tldp.org/LDP/abs/html/io-redirection.html](http://tldp.org/LDP/abs/html/io-redirection.html)

“每个打开的文件都被分配一个文件描述符。[2] stdin、stdout 和 stderr 的文件描述符分别为 0、1 和 2。对于打开其他文件，保留描述符 3 到 9。有时有用将这些附加文件描述符之一分配给 stdin、stdout 或 stderr 作为临时重复链接。”

关键是为了达到这个结果是否值得让脚本更复杂。其实这并没有错，你这样做的方式。

# android - 为什么我的列表视图滚动不顺畅？

> ID：12451281
> 
> 赞同：1
> 
> 时间：2012-09-16T22:30:46.517
> 
> 标签：android, listview, view, scroll, layout-inflater

我对 Android 开发很感兴趣，我正在尝试使用在 OnCreate 期间从 twitter 解析的图像填充列表视图。我可以毫无问题地填充列表视图，但列表视图滚动生涩而不是平滑。起初我认为这是一个模拟器问题，但它在我的设备上也很生涩。令人沮丧的是，我使用的是 stackoverflow 上的所有教程和帖子都推荐的 viewholder 方法。任何帮助是极大的赞赏。这是我的代码...

```
 public View getView(int position, View convertView, ViewGroup parent) {
    View v = convertView;
    if (v == null) {
        LayoutInflater vi = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = vi.inflate(R.layout.listitem, null);
          ViewHolder holder = new ViewHolder();          
          holder.username = (TextView) v.findViewById(R.id.username);        
          holder.message = (TextView) v.findViewById(R.id.message);
          holder.image = (ImageView) v.findViewById(R.id.avatar);
          v.setTag(holder);

    }

    Tweet tweet = tweets.get(position);
    if (tweet != null) {
        ViewHolder holder = (ViewHolder)v.getTag();
        holder.username = (TextView) v.findViewById(R.id.username);
        holder.message = (TextView) v.findViewById(R.id.message);
        holder.image = (ImageView) v.findViewById(R.id.avatar);

        if (holder.username != null) {
            holder.username.setText(tweet.username);
        }

        if(holder.message != null) {
            holder.message.setText(tweet.message);
        }

        if(holder.image != null) {
            holder.image.setImageBitmap(getBitmap(tweet.image_url));

        }
    }
    return v;
}
}

static class ViewHolder {
        TextView username;  
        TextView message;
        ImageView image;
    }

public Bitmap getBitmap(String bitmapUrl) {
    try {
        URL url = new URL(bitmapUrl);
        return BitmapFactory.decodeStream(url.openConnection() .getInputStream()); 
    }
    catch(Exception ex) {return null;}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T22:56:08.383

您的 getBitmap 方法正在 UI 线程上下载和解码图像。这将导致在更高版本的 android 上滚动显着暂停和崩溃。

The [Developer Guide on Bitmap Processing](http://developer.android.com/training/displaying-bitmaps/process-bitmap.html)包含一个相当容易实现的异步加载位图技术

# vba - 在 Excel 的 VBA 代码中计算 %

> ID：12451284
> 
> 赞同：0
> 
> 时间：2012-09-16T22:31:14.177
> 
> 标签：vba, excel

我正在尝试通过 VBA 代码计算 Excel 表中的百分比，如下所示：

```
.ActiveCell.FormulaR1C1 = "=IF((ISBLANK(RC[-2])=FALSE),IF((ISERROR(RC[-2]/RC[-1]),0,RC[-2]/RC[-1]),"""")" 
```

但这给了我一个错误。

如果该`RC[-2]`列为空，则%列的结果应该为空，如果不是，我需要检查分母是否为0以避免除以零错误（`#DIV/0!` 如果分母为零则填充）

有人可以指出错误在哪里吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T22:34:30.887

你错过了一个右括号 - 这可能会更好（不确定它是否会做你想要的！）：

```
"=IF(ISBLANK(RC[-2])=FALSE,IF(ISERROR(RC[-2]/RC[-1]),0,RC[-2]/RC[-1]),"""")" 
```

或者更具可读性：

```
"=IF(ISBLANK(RC[-2]),"""",IF(ISERROR(RC[-2]/RC[-1]),0,RC[-2]/RC[-1]))" 
```

# javascript - Node.js 中的 fs 不明白 ~/

> ID：12451285
> 
> 赞同：5
> 
> 时间：2012-09-16T22:31:16.937
> 
> 标签：javascript, node.js, fs

我正在尝试检查目录是否作为 node.js 中命令行应用程序的一部分存在。不过，`fs`好像不太明白`~/`。例如，以下返回 false...

```
> fs.existsSync('~/Documents')
false 
```

...但这返回true...

```
> fs.existsSync('/Users/gtmtg/Documents')
true 
```

……虽然它们是同一个东西。

为什么会发生这种情况，是否有解决方法？提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-16T22:35:18.460

这是因为`~/`命令 shell 支持，而不是文件系统 API。

# ruby-on-rails - 如何验证关联的模型 ID？

> ID：12451288
> 
> 赞同：13
> 
> 时间：2012-09-16T22:31:52.047
> 
> 标签：ruby-on-rails, ruby, activerecord

我有一个学生和一个课程模型。学生属于课程，课程有很多学生。

```
class Student < ActiveRecord::Base
  attr_accessible :course_id, :name, :password, :status, :studentID, :year
  belongs_to :course

  validates :name, :password, :status, :studentID, :year, :presence =>true
  validates_associated :course
end

class Course < ActiveRecord::Base
  attr_accessible :courseCode, :courseName, :courseYr
  validates :courseCode,:courseName,:courseYr, :presence => true
  validates :courseCode,:courseYr, :uniqueness=>{:message=>"Cannot repeat the code"}

  has_many :students 
end 
```

在用于创建学生记录的表单中，我让用户输入课程 ID。

```
<div class="field">
  <%= f.label :course_id %><br />
  <%= f.text_field :course_id %>
</div> 
```

但我不知道如何验证`course_id`用户的输入。即使我键入不存在的课程 ID，学生模型验证也不会产生错误。我如何让它显示错误？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-16T22:44:38.617

您应该考虑创建自定义验证方法：

```
class Student < ActiveRecord::Base
  validates :course_id, presence: true, numericality: { only_integer: true }
  ...
  validate :validate_course_id

private

  def validate_course_id
    errors.add(:course_id, "is invalid") unless Course.exists?(self.course_id)
  end
end 
```

首先，您的模型将确保`course_id`是一个有效的整数，然后您的自定义验证将确保该课程存在于数据库中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-09-12T12:18:02.697

您可以验证课程关联的存在。那么，如果不存在，有效吗？将是错误的。

你的班级应该是：

```
class Student < ActiveRecord::Base
  attr_accessible :course_id, :name, :password, :status, :studentID, :year
  belongs_to :course

  validates :course, :name, :password, :status, :studentID, :year, presence: true
end 
```

在这篇[文章](http://railsguides.net/belongs-to-and-presence-validation-rule1/)中解释了验证外键和关联本身的区别。

如果您当然不需要验证存在，您可以执行此解决方法：

```
validates :course, presence: true, if: -> {course_id.present?} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-16T22:41:20.543

您可以只执行一个自定义验证方法来检查您的课程 ID 的有效性：

```
# course.rb
validates :course_id_is_valid

def course_id_is_valid
  if #course id isn't valid
    errors.add(:course_id, "is invalid")
  end
end 
```

或者，如果课程列表是离散列表，您可以在验证中使用 :in 选项：

```
# course.rb
validates :course_id, :inclusion => { :in => list_of_courses, :message => "%{value} is not a course id" } 
```

还有更多选择。这两个例子都来自 Rails 文档：

[http://guides.rubyonrails.org/active_record_validations_callbacks.html#custom-methods](http://guides.rubyonrails.org/active_record_validations_callbacks.html#custom-methods)

# python - OSError，[Errno 13] 权限被拒绝，当我尝试使用 apache/mod_wsgi 服务器在 django 中上传加载文件时抛出

> ID：12451290
> 
> 赞同：0
> 
> 时间：2012-09-16T22:32:10.617
> 
> 标签：python, django, apache, file-upload, wsgi

这是追溯

```
Environment:

Request Method: POST
Request URL: http://mysite.com/admin/content/author/add/

Django Version: 1.4.1
Python Version: 2.7.3
Installed Applications:
('grappelli',
 'filebrowser',
 'south',
 'django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'django.contrib.admin',
 'django.contrib.admindocs',
 'tinymce',
 'mailchimp',
 'content',
 'categorization',
 'mptt')
Installed Middleware:
('django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware')

Traceback:
File "/usr/local/lib/python2.7/dist-packages/django/core/handlers/base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/contrib/admin/options.py" in wrapper
  366\.                 return self.admin_site.admin_view(view)(*args, **kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/utils/decorators.py" in _wrapped_view
  91\.                     response = view_func(request, *args, **kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/views/decorators/cache.py" in _wrapped_view_func
  89\.         response = view_func(request, *args, **kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/contrib/admin/sites.py" in inner
  196\.             return view(request, *args, **kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/utils/decorators.py" in _wrapper
  25\.             return bound_func(*args, **kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/utils/decorators.py" in _wrapped_view
  91\.                     response = view_func(request, *args, **kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/utils/decorators.py" in bound_func
  21\.                 return func(self, *args2, **kwargs2)
File "/usr/local/lib/python2.7/dist-packages/django/db/transaction.py" in inner
  209\.                 return func(*args, **kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/contrib/admin/options.py" in add_view
  955\.                 self.save_model(request, new_object, form, False)
File "/usr/local/lib/python2.7/dist-packages/django/contrib/admin/options.py" in save_model
  709\.         obj.save()
File "/usr/local/lib/python2.7/dist-packages/django/db/models/base.py" in save
  463\.         self.save_base(using=using, force_insert=force_insert, force_update=force_update)
File "/usr/local/lib/python2.7/dist-packages/django/db/models/base.py" in save_base
  551\.                 result = manager._insert([self], fields=fields, return_id=update_pk, using=using, raw=raw)
File "/usr/local/lib/python2.7/dist-packages/django/db/models/manager.py" in _insert
  203\.         return insert_query(self.model, objs, fields, **kwargs)
File "/usr/local/lib/python2.7/dist-packages/django/db/models/query.py" in insert_query
  1576\.     return query.get_compiler(using=using).execute_sql(return_id)
File "/usr/local/lib/python2.7/dist-packages/django/db/models/sql/compiler.py" in execute_sql
  909\.         for sql, params in self.as_sql():
File "/usr/local/lib/python2.7/dist-packages/django/db/models/sql/compiler.py" in as_sql
  872\.                 for obj in self.query.objs
File "/usr/local/lib/python2.7/dist-packages/django/db/models/fields/files.py" in pre_save
  249\.             file.save(file.name, file, save=False)
File "/usr/local/lib/python2.7/dist-packages/django/db/models/fields/files.py" in save
  86\.         self.name = self.storage.save(name, content)
File "/usr/local/lib/python2.7/dist-packages/django/core/files/storage.py" in save
  45\.         name = self._save(name, content)
File "/usr/local/lib/python2.7/dist-packages/django/core/files/storage.py" in _save
  168\.                 os.makedirs(directory)
File "/usr/lib/python2.7/os.py" in makedirs
  150\.             makedirs(head, mode)
File "/usr/lib/python2.7/os.py" in makedirs
  157\.     mkdir(name, mode)

Exception Type: OSError at /admin/content/author/add/
Exception Value: [Errno 13] Permission denied: '//media/uploads' 
```

这是我的模型

```
class ArticleImage(models.Model):
title = models.CharField(
    verbose_name = _(u'Title'),
    help_text = _(u'The title for this article image'),
    max_length = 255,
)
alt_text = models.CharField(
    verbose_name = _(u'Alt. Text'),
    help_text = _(u'The alt text for this article image'),
    max_length = 255,
)
image = models.ImageField(
    verbose_name = _(u'Image'),
    upload_to = 'uploads/articleimages/'
)
article = models.ForeignKey(
    Article,
    verbose_name = _(u'Article'),
    help_text = _(u'The article to which this image belongs'),
)
class Meta:
    verbose_name = _(u'Image')
    verbose_name_plural = _(u'Images')

def __unicode__(self):
    return u'%s'%self.title 
```

以下是相关设置

```
MEDIA_ROOT = os.getcwd() + '/media/'
MEDIA_URL = '/media/'
DEBUG = False 
```

这是我的媒体目录的 httpd.conf

```
Alias /media/ /home/quinton/Sites/prod/media/

<Directory /home/quinton/Sites/prod/media>
Order deny,allow
Allow from all
</Directory> 
```

当我在本地运行所有内容时，这不是问题。只有当我推送到我的服务器并重新启动 Apache 时才会发生这种情况。我尝试将媒体目录的文件权限更改为 777，但仍然没有运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T01:55:02.677

`os.getcwd()`可能不会给你你想要的。不能保证工作目录就是您的 settings.py 文件所在的目录。

如果你想从你的设置文件的位置工作，那么你可以在你的文件中使用`os.path`和：`__file__``settings.py`

```
import os.path
# Get the directory the settings.py file is located in.
BASE_DIR = os.path.abspath(os.path.dirname(__file__)) 
```

作为奖励，您项目中的其他模块也可以使用它：

```
from django.conf import settings
print "Base directory:", settings.BASE_DIR 
```

# google-apps-script - Google Apps 脚本中的时区

> ID：12451292
> 
> 赞同：2
> 
> 时间：2012-09-16T22:32:32.420
> 
> 标签：google-apps-script

我想将日期对象转换为与 Google 电子表格中使用的日期的基础值一致的“序列号”。我的理解是，在 Javascript 中，日期对象的原始值是 1970 年 1 月 1 日午夜之后（或之前）的毫秒数；在 Google 电子表格中，对于 1899 年 12 月 30 日午夜，日期的原始值是 0（零），之后的每一天都等于 1（例如，7 小时等于 7 除以 24）。

我试过这个功能：

```
function date2Serial(date) {
  return (date.getTime() + 2209161600000) / 86400000;
  // 2209161600000 = milliseconds between 1899-12-30 and 1970-01-01
  // 86400000 = milliseconds in a day
  // question "on the side" - is there any essential difference between
  //  .getTime() and .valueOf()?
} 
```

这会返回一个有点偏离的值 - 我认为“关闭”对应于我与 GMT 的时区差异。因此，即使在我的情况下，电子表格设置和项目属性都设置为 GMT+10，getTime() 似乎在 GMT 上运行。

例如：

```
A1: 16/09/2012 06:00:00
A2: =date2serial(A1)
A3: =VALUE(A1) 
```

A2 返回 41167.8333，其中 A3 返回 41168.25。

现在我尝试使用[getTimezoneOffset()](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/getTimezoneOffset)方法，该方法似乎可以解决问题：

```
function date2Serial(date) {
  return (date.getTime() + 2209161600000 - (date.getTimezoneOffset() * 60000)) / 86400000;
} 
```

然而，这依赖于正确的项目属性时区，而不是电子表格设置时区（实际上可以不同地设置这些时区）。

我的问题：

这种行为是预期的吗，是否需要对时区进行“调整”？或者 getTime()（以及所有其他方法，如 getHours()、getMinutes() 等）是否应该在用户设置的时区而不是 GMT/UTC 上运行，而“调整”实际上是解决 bug 的一种方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T07:19:30.527

getTime() 返回一个持续时间，而不是某个时刻，因此没有时区。减去的参考时刻是 1970 年 1 月 1 日午夜（UTC）。

getHours()、getMinutes() 等方法会提供部分时间。结果取决于使用的日期对象的时区。如果您想独立于日期对象的时区，您应该使用 getUTCHours()、getUTCMinutes() 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-06-07T11:59:29.627

此代码还将考虑当地的夏令时。这有点低效，因为要正确，必须创建两次 Date 对象。

```
function ValueToDate(GoogleDateValue) {
  var d = Date.UTC(1899,11,30,0,0,0)+(GoogleDateValue*86400000) ;
  return new Date(d+(new Date(d)).getTimezoneOffset()*60000) ;
}

function DateToValue(date) {
  return (date.getTime()-date.getTimezoneOffset()*60000)/86400000+25569 ;
} 
```

# c - 信号名称“somename”无效，例如“0x80c00b0”

> ID：12451297
> 
> 赞同：1
> 
> 时间：2012-09-16T22:32:59.333
> 
> 标签：c, gtk, signals, glib

我正在尝试在安装后的 GtkWidget （ GooCanvas ）上注册一个新信号。 [我在这里](http://developer.gnome.org/gobject/stable/signal.html#signal-registration)做了：

```
g_signal_new                         ("canvas_changed",
                                     G_TYPE_FROM_INSTANCE(canvas),
                                     G_SIGNAL_RUN_LAST | G_SIGNAL_ACTION,
                                     0,
                                     NULL, NULL,
                                     g_cclosure_marshal_VOID__POINTER,
                                     G_TYPE_NONE,
                                     1,
                                     G_TYPE_POINTER); 
```

但是当我尝试在画布上发出信号时：

```
g_signal_emit_by_name(canvas, "changed2"); 
```

我得到错误：

```
signal name `changed2' is invalid for instance `0x80c00b0' 
```

我不确定我做错了什么？我尝试传递一些其他类型但仍然没有结果？有谁知道这里有什么问题？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T22:39:08.780

你试过这个吗？

```
g_signal_emit_by_name(canvas, "canvas_changed"); 
```

# silverstripe - Silverstripe 3 - 为什么没有将数据传递给模板

> ID：12451298
> 
> 赞同：0
> 
> 时间：2012-09-16T22:33:03.307
> 
> 标签：silverstripe

我正在尝试使用 YouTube 小部件，但它似乎在 Silverstripe 3 中存在问题，并且它没有将 DataObjectSet 传递给模板，因此我无法将我的数据传递给模板。所有值都在 CMS 中正确显示，只是在模板中它们没有被传递，因此这似乎是 SS3 中的 DataObjectSet 的问题。我已经进行了广泛的搜索，但找不到任何提及它在 SS3 中被弃用的内容。

```
class YoutubeWidget extends Widget{
    static $title = "My favorite video";
    static $cmsTitle = "Your tube widget";
    static $description = "This widget can embed clips from youtube.com";

    static $db = array(
        "Width" => "Int",
        "Height" => "Int",
        "URL" => "Text",
        "Title" => "Text"
    );

    static $defaults = array(
        "Width" => 283,
        "Height" => 182
    );

    function getCMSFields(){
        return new FieldList(
            new NumericField("Width", "Video Width"),
            new NumericField("Height", "Video Height"),
            new TextField("URL", "Video URL"),
            new TextField("Title","Title or a note about this video")
        );
    }

    function GetVideoData(){
        $output = new DataObjectSet();
        $output->push(
            new ArrayData(
                array(
                    "Width" => $this->Width,
                    "Height" => $this->Height,
                    "URL" => $this->URL,
                    "Title" => $this->Title
                )
            )
        );      
        return $output;
    }
} 
```

模板中没有填充任何变量。

```
<% control GetVideoData %>
    <object width="$Width" height="$Height">
        <param name="movie" value="$URL"></param>
        <param name="allowFullScreen" value="true"></param>
        <embed src="$URL" type="application/x-shockwave-flash" allowfullscreen="true" width="$Width" height="$Height"></embed>
    </object>

    <p style="text-align:center;">$Title</p>
<% end_control %> 
```

如果我将控件包装在 <% if GetVideoData %> 中，它不会访问控件，表明没有返回任何内容，即使我将 GetVideoData 函数更改为仅返回一个字符串，也会发生这种情况。IE`return "asdf";`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T23:53:52.143

这是由于 SS3 的变化。我只需要从模板中的控制调用中删除“get”；

```
<% if VideoData %>
    <% control VideoData %>
    <% end_control %>
<% end_if %> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-22T21:15:12.953

SS3 现在将使用`<% loop VideoData %>`or`<% with VideoData %>`代替`<% control VideoData %>`.

# python - Twisted Names 如何为查询构建搜索结果？

> ID：12451299
> 
> 赞同：0
> 
> 时间：2012-09-16T22:33:12.407
> 
> 标签：python, dns, twisted

具体来说，在 authority.FileAuthority 类下的 _lookup 调用会发生什么，它是如何返回结果的？这是未记录的名称领域之一。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T22:33:12.407

以下是 Twisted Names 11.1 的 authority.py 文件中 FileAuthority._lookup 调用的注释版本。此方法负责同步搜索已从 BIND zonefiles、Python zonefiles 等索引的 DNS 信息。

```
def _lookup(self, name, cls, type, timeout = None):
    """Return a list of results.
    name: Queried host name.
    cls: An enum of the query class. See dns.py:

        IN, CS, CH, HS = range(1, 5)

        QUERY_CLASSES = {
            IN: 'IN',
            CS: 'CS',
            CH: 'CH',
            HS: 'HS',
            ANY: 'ANY'
        }

    type: The type of record to search for (or ANY/255 for any and all). 
          See dns.py:

        (A, NS, MD, MF, CNAME, SOA, MB, MG, MR, NULL, WKS, PTR, HINFO, MINFO, MX, TXT,
         RP, AFSDB) = range(1, 19)
        AAAA = 28
        SRV = 33
        NAPTR = 35
        A6 = 38
        DNAME = 39
        SPF = 99

        QUERY_TYPES = {
            A: 'A',
            NS: 'NS',
            MD: 'MD',
            MF: 'MF',
            CNAME: 'CNAME',
            SOA: 'SOA',
            MB: 'MB',
            MG: 'MG',
            MR: 'MR',
            NULL: 'NULL',
            WKS: 'WKS',
            PTR: 'PTR',
            HINFO: 'HINFO',
            MINFO: 'MINFO',
            MX: 'MX',
            TXT: 'TXT',
            RP: 'RP',
            AFSDB: 'AFSDB',

            # 19 through 27?  Eh, I'll get to 'em.

            AAAA: 'AAAA',
            SRV: 'SRV',
            NAPTR: 'NAPTR',
            A6: 'A6',
            DNAME: 'DNAME',
            SPF: 'SPF'
        }

    timeout: The retention time for this record, in seconds.
    """
    cnames = []
    results = []
    authority = []
    additional = []
    default_ttl = max(self.soa[1].minimum, self.soa[1].expire)

    # Do records search. Get a list of classes like Record_A and Record_MX 
    # back. These are defined in dns.py .
    domain_records = self.records.get(name.lower())

    # Structure the results so as to present them the way that DNS records 
    # usually come back.

    if domain_records:
        # Loop through all of the results.
        for record in domain_records:
            if record.ttl is not None:
                ttl = record.ttl
            else:
                ttl = default_ttl

            # If we're looking at a [subdomain?] NS record, note it.
            if record.TYPE == dns.NS and name.lower() != self.soa[0].lower():
                # NS record belong to a child zone: this is a referral.  As
                # NS records are authoritative in the child zone, ours here
                # are not.  RFC 2181, section 6.1.
                authority.append(
                    dns.RRHeader(name, record.TYPE, dns.IN, ttl, record, auth=False)
                )

            # Was the record what was requested, or did we want everything?
            elif record.TYPE == type or type == dns.ALL_RECORDS:
                results.append(
                    dns.RRHeader(name, record.TYPE, dns.IN, ttl, record, auth=True)
                )

            # If we're looking at a CNAME record, note it.
            if record.TYPE == dns.CNAME:
                cnames.append(
                    dns.RRHeader(name, record.TYPE, dns.IN, ttl, record, auth=True)
                )

        # If no requested records were found, use the CNAME records (if any).
        if not results:
            results = cnames

        # Go through any NS, CNAME, or MX records found, and find the IPs 
        # for those hosts.
        #
        # NOTE: The "additional" list doesn't appear to be populated.
        for record in results + authority:
            section = {dns.NS: additional, dns.CNAME: results, dns.MX: additional}.get(record.type)
            if section is not None:
                n = str(record.payload.name)
                for rec in self.records.get(n.lower(), ()):
                    if rec.TYPE == dns.A:
                        section.append(
                            dns.RRHeader(n, dns.A, dns.IN, rec.ttl or default_ttl, rec, auth=True)
                        )

        # Not found. Return an SOA record with the name that was requested 
        # (the normal response that you'll see at the console).
        if not results and not authority:
            # Empty response. Include SOA record to allow clients to cache
            # this response.  RFC 1034, sections 3.7 and 4.3.4, and RFC 2181
            # section 7.1.
            authority.append(
                dns.RRHeader(self.soa[0], dns.SOA, dns.IN, ttl, self.soa[1], auth=True)
                )

        # We return a tuple of individual result lists. Each of the records 
        # is an instance of RRHeader, which wraps the Record_* classes in 
        # dns.py for returning as a result (Resource Record). 
        #
        # The first item in the tuple refers to the "ANSWER SECTION" in the 
        # DiG output, and the third item refers to the "ADDITIONAL 
        # SECTION". As "authority" was an empty list in the example, no 
        # output relates to it. It will have NS records if any are present, 
        # or contain an SOA record for what was requested if nothing was 
        # found.
        # 
        #;; QUESTION SECTION:
        #;example-domain.com.            IN      ANY
        #
        #;; ANSWER SECTION:
        #example-domain.com.     3600    IN      SOA     ns1.example-domain.com. root.example-domain.com. 2003010601 3600 3600 3600 3600
        #example-domain.com.     3600    IN      A       127.9.9.9
        #example-domain.com.     3600    IN      NS      ns1.example-domain.com.
        #example-domain.com.     3600    IN      MX      0 mail.example-domain.com.
        #
        #;; ADDITIONAL SECTION:
        #mail.example-domain.com. 3600   IN      A       123.0.16.43

        return defer.succeed((results, authority, additional))
    else:
        if name.lower().endswith(self.soa[0].lower()):
            # We are the authority and we didn't find it.  Goodbye.
            return defer.fail(failure.Failure(dns.AuthoritativeDomainError(name)))
        return defer.fail(failure.Failure(dns.DomainError(name))) 
```

# list - F# 不可变版本的 List ?

> ID：12451305
> 
> 赞同：1
> 
> 时间：2012-09-16T22:34:34.960
> 
> 标签：list, f#, immutability

我目前正在尝试学习 F# 以获得乐趣。

在 C# 中，我处理来自数据库的复杂数据，这些数据通常必须在一个元素中包含整数、双精度、字符串。这`System.Collections.Generic List<T>`是完美的。

我正在尝试探索 F# 中的并行性，但需要一个不可变`List<T>`的来这样做。这可能吗？语法会类似于 C#`var x = new List<T>`吗？

谢谢。

我将对其进行编辑以使其更清晰：

在 F# 中，我想创建一个不可变的类或记录列表（应该命名），就像在 C# 中使用 List 一样。这样我就可以在同一个元素中使用分组字符串、整数、双精度数。希望这真的很简单。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T15:42:54.117

在回答如何使用 List 之前，您可能需要确定**为什么**要使用***List***。

这不是微不足道的，因为我们在计算机科学中称为***List***是一种非常精确的结构，其含义不同于例如***sequence***，它更多地对应于“list”的随意使用。在 C# 中，这称为 IEnumerable，在 F# 中是别名*seq*（它们是相同的 BCL 类型）。

这个序列的一般功能概念可以在数组、列表、集合、字典、地图等类型中看到......任何可以*枚举的东西*

为了让您了解不同的结构，这里是动物学的示例列表（错误..序列）：

*   **Set**本身是无序的，但可以枚举，即使它不是第一次使用
*   **List**是一种结构，其中每个元素都有一个指向下一个元素的指针，允许扫描和 o(n) 随机访问。在 F# 中它是不可变的，您只能创建新的，而不能向其添加元素。你可以有 1 路遍历的链表和 2 路遍历的双链表。

*   **数组**是一个连续的内存块，允许 o(1) 随机访问，如果您事先知道集合的大小，那就太好了

*   **字典**就像一个数组，但由某个不是整数的键索引
*   **ResizableArray**类似于您所知道的 c# List，因为您可以在其中添加元素

List 本身的一切都在这里

[http://en.wikibooks.org/wiki/F_Sharp_Programming/Lists](http://en.wikibooks.org/wiki/F_Sharp_Programming/Lists)

如果你理解你的程序，你应该能够事先证明为什么你使用这个结构而不是另一个结构。

如果有一天你的程序太慢了，去寻找他们在 o(n) 的结构上的'find'。也就是说，相当于数据库中的“全面扫描”。获得正确的结构将使您的程序飞起来

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T20:59:43.497

我没有投反对票，但如果没有更多细节，很难回答你的问题。

在 F# 中，不可变列表是最常用的数据结构。您经常使用 cons 构造函数`(::)`和空列表来构造列表`[]`。例如，`[1; 2; 3]`是 的语法糖`1::2::3::[]`。您可以按照@Brian 建议的链接阅读有关基本列表处理的更多信息。

一旦习惯了 F# 列表，就可以使用[高阶函数](http://msdn.microsoft.com/en-us/library/ee353738.aspx)和列表推导来创建新列表。在您的情况下，可以按如下方式生成随机数列表：

```
let genRand =
    let rand = System.Random()
    fun () -> rand.NextDouble()

/// Creating a list using high-order functions
let genRandList n = List.init n (fun _ -> genRand())

/// Creating a list using list comprehension
let genRandList' n = [ for i in 1..n -> genRand() ] 
```

我不熟悉蒙特卡罗模拟；但是通读[这篇文章](http://it-quant.blogspot.dk/2008/10/monte-carlo-simulation.html)`List.map`，一旦生成了随机数列表，您将在列表元素上统一应用多个函数。出于并行性目的，我建议您使用 Array 而不是 List，这样可以提供更好的加速。数组允许对元素进行随机访问，因此不同的线程可以轻松地并行访问数组的不相交部分。[尽管数组是可变的，但由于高阶函数](http://msdn.microsoft.com/en-us/library/ee370273.aspx)和数组理解，您可以以无副作用的方式使用它们。

为了使每个元素的任务有意义，您应该将一系列合并`Array.map`为一个并更改`Array.map`为[`Array.Parallel.map`](http://msdn.microsoft.com/en-us/library/ee821126.aspx)并行性。您还可以并行化`mean`功能；但是，它不太可能给您任何加速。看看[这个片段](http://fssnip.net/cr)，看看解决方案在数组中的样子。

**更新**：

创建记录列表：

```
type RandPair = { First: float; Second: float}
let genRandPairs n = [ for i in 1..n -> 
                          { First = genRand(); Second = genRand() } ] 
```

[你可以对classes](http://msdn.microsoft.com/en-us/library/dd233205.aspx)做类似的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T10:14:48.540

我认为，在这个问题的上下文中，应该说明 F# 不可变结构对您没有太大帮助，因为如果您按照其他答案中的描述创建不可变 F# 列表，您只能确保您的列表是未修改，而它持有的引用可能指向不可变的对象。

也就是说，即使它们是，并行化也不会自动发生。F# 不是纯语言，所以它不能确定你的对象会引入什么样的副作用，并且不能自行并行化任何东西（即使可以，它也可能不是非常有效的解决方案，因为自动并行化是没那么容易）。

以下问题很好地描述了它：[F# 是否提供自动并行性？](https://stackoverflow.com/questions/682710/does-f-provide-you-automatic-parallelism)

当然这是一般情况，因为我们不知道您的问题的细节。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-17T04:30:10.693

你可以看看

[http://en.wikibooks.org/wiki/F_Sharp_Programming/Lists](http://en.wikibooks.org/wiki/F_Sharp_Programming/Lists)

或者

[http://msdn.microsoft.com/en-us/library/dd233224.aspx](http://msdn.microsoft.com/en-us/library/dd233224.aspx)

# matlab - MATLAB 中的 yyplot 标签

> ID：12451311
> 
> 赞同：0
> 
> 时间：2012-09-16T22:35:05.920
> 
> 标签：matlab, plot, labels

如何在[MATLAB](http://en.wikipedia.org/wiki/MATLAB)中向 yyplot 添加标签？

以下是 MATLAB 建议执行的操作：

```
figure

x = 0:0.01:20;

y1 = 200*exp(-0.05*x).*sin(x);

y2 = 0.8*exp(-0.5*x).*sin(10*x);

[AX,H1,H2] = plotyy(x,y1,x,y2,'plot');

set(get(AX(1),'Ylabel'),'String','left label')

set(get(AX(2),'Ylabel'),'String','right label') 
```

我想在不使用轴手柄的情况下为 yyplot 的两个 y 轴添加标签。甚至有可能还是必须使用轴手柄来做到这一点？

# jasperserver - 是否可以安排一个作业，其中每个结果创建一个单独的报告以由 JasperServer 发送？

> ID：12451316
> 
> 赞同：0
> 
> 时间：2012-09-16T22:35:45.973
> 
> 标签：jasperserver

如果没有单独的调度程序的帮助（如果我必须走那条路线，可能用 Java 编写）是否可以在 JasperServer 中调度一个运行一些 SQL 的作业，然后为返回的每一行运行并提供报告？

例如，SQL 将类似于：

```
select customerName, billableAmount from billing where trunc(billingdate) = trunc(sysdate); 
```

这可能会返回如下内容：

```
Bongo Beans, 100,000
Moon Lives, 750,000 
```

然后，我想创建 2 个报告实例以发送到我们的会计部门，1 个用于 Bongo Beans，1 个用于 Moon Lives。

根据我迄今为止阅读的所有内容，这似乎是不可能的，但如果是的话，那就太神奇了！

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-25T16:14:57.233

根据 Lisa 和我之前的评论，事实证明目前这是不可能的。

我最终采用的解决方案是编写一个运行我的第一个 SQL 的 java 应用程序，然后使用下面链接的 java-rest 客户端（称为 JaspserServer）和参数来创建我的报告，然后通过电子邮件将它们发送出去。

[https://github.com/gkudos/jasperserver-simple-java-rest-client](https://github.com/gkudos/jasperserver-simple-java-rest-client)

感谢您的浏览，希望对您有所帮助。

# objective-c - 如何在按钮中打印出字符串

> ID：12451319
> 
> 赞同：0
> 
> 时间：2012-09-16T22:35:56.077
> 
> 标签：objective-c, ios, uibutton

我正在尝试为 iphone 制作井字游戏

我想如果用户按下a按钮

它显示用户 'X' 或 'O' ，

那么如何在按钮中显示字符串

我试着输入这段代码

```
NSString *sign =[ sender titleLabel];
NSString *buttonSign=[sign initWithFormat:@"X"]; 
```

但它失败了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T02:02:01.280

为了设置按钮的标题，您需要像这样设置文本：

```
[sender setTitle:@"X" forState:UIControlStateNormal]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T22:40:48.533

您可以使用以下方法：

```
- (void)setTitle:(NSString *)aString 
```

例如：

```
[button setTitle: @"X"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T22:37:23.470

```
sender.titleLabel.text = @"X"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-18T10:37:32.877

您可以根据您的要求设置标题

对于正常状态：

```
[mybutton setTitle:@"yes" forState:UIControlStateNormal]; 
```

对于高亮状态：

```
[mybutton setTitle:@"no" forState:UIControlStateHighlighted]; 
```

对于选定的状态：

```
[mybutton setTitle:@"ok" forState:UIControlStateSelected]; 
```

# mongodb - MongoDB聚合排序

> ID：12451322
> 
> 赞同：39
> 
> 时间：2012-09-16T22:36:26.840
> 
> 标签：mongodb

我有一个学生数据库及其联系方式。我试图找出容纳最多学生的邮政编码。学生的文件看起来像这样......

> {学生代码：'smi0001'，名字：'bob'，姓氏：'smith'，邮编：2001}

我想我可以使用聚合框架来找出大多数学生的邮政编码，方法是......

```
db.students.aggregate({$project: { postcode: 1 }, $group: {_id: '$postcode', students: {$sum: 1}}}) 
```

这可以按预期工作（将邮政编码`_id`和每个邮政编码中的学生人数返回为“学生”，但是如果我添加`$sort`到管道中，它似乎会尝试按整个学生集合而不是`$group`操作结果进行排序。

我正在尝试的看起来像......

```
db.students.aggregate({$project: { postcode: 1 }, $group: {_id: '$postcode', students: {$sum: 1}}, $sort: {_id: -1}}) 
```

但它会返回整个集合并忽略`$project`and `$group`...我错过了什么吗？我以为我只能按学生人数降序排序并返回第一项。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-09-16T23:24:46.870

你几乎拥有它...

```
db.test.aggregate(
  {$group: {_id: '$postcode', students: {$sum: 1}}}, 
  {$sort: {_id: -1}}
); 
```

给出（我添加了一些与您的样本匹配的测试数据）：

```
{
  "result" : [
    {
        "_id" : 2003,
        "students" : 3
    },
    {
        "_id" : 2002,
        "students" : 1
    },
    {
        "_id" : 2001,
        "students" : 2
    }
  ],
  "ok" : 1
} 
```

你对所有东西都有一个外在`{}`，这引起了一些混乱。分组和排序在管道中没有作为单独的操作工作。

对于这种情况，您实际上并不需要该项目。

**更新**您可能想按“学生”排序，像这样，首先获得最大的邮政编码（按人口）：

```
db.test.aggregate(
  {$group: {_id: '$postcode', students: {$sum: 1}}}, 
  {$sort: {students: -1}}
); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-16T23:39:16.670

我认为您的语法略有错误。管道中的每个聚合操作都应该是它自己的文档。

```
db.students.aggregate( {$project: ...}, {$group: ...}, {$sort: ...} ) 
```

在你的情况下，它应该是：

```
db.students.aggregate(
    {$project: { postcode: 1 }}, 
    {$group: {_id: '$postcode', students: {$sum: 1}}}, 
    {$sort: {students: -1}}
) 
```

我已经根据您的架构在样本集合上对其进行了测试，它适用于我，按学生人数降序对分组的邮政编码进行排序。

# objective-c - 将调度程序放入 CCSequence

> ID：12451328
> 
> 赞同：1
> 
> 时间：2012-09-16T22:37:51.683
> 
> 标签：objective-c, cocos2d-iphone

所以基本上我有 2 个调度程序函数，我想将它们放入 CCSequence 中。

```
id func1 = [CCCallFuncN actionWithTarget:self selector:@selector(pan1)];
id func2 = [CCCallFuncN actionWithTarget:self selector:@selector(pan2)];
id seq = [CCSequence actions: func1, func2, nil];
[img runAction:seq]; 
```

pan1 从左到右进行平移，pan2 从右到左进行平移。

```
-(void) pan1{
    [self schedule:@selector(panLtoR) interval:0.05]; 
}

-(void) pan2{
    [self schedule:@selector(panRtoL) interval:0.05];
} 
```

我想要的结果是在 func2 开始之前完全完成 func1。但是现在...... func2 在 func1 仍在运行时开始。我不知道为什么。我怎么解决这个问题？提前致谢。

补充：panLtoR 的代码如下所示

```
-(void) panLtoR{
   [self panLtoR: 1 andY:0.5];
} 

-(void) panLtoR:(float) x andY: (float) y{

   float rightAnchorX = x - m_minAnchorX;

   if(m_curAnchorX <= rightAnchorX)
   {
       m_img.anchorPoint = ccp(m_curAnchorX, y);
       m_curAnchorX += 0.005;
   }

    else{
       [self unschedule:@selector(panLtoR)];
   }
} 
```

和 panRtoL 做类似的事情。基本上我想做的是通过移动锚点而不是位置来实现平移。我怎样才能使它在启动func2之前完成func1？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:05:49.760

让我们分解一下你写的内容：

```
id func1 = [CCCallFuncN actionWithTarget:self selector:@selector(pan1)];
id func2 = [CCCallFuncN actionWithTarget:self selector:@selector(pan2)];
id seq = [CCSequence actions: func1, func2, nil];
[img runAction:seq]; 
```

在这里，这意味着 call `pan1`，完成后， call `pan2`。这基本上只是：

```
[self pan1];
[self pan2]; 
```

这意味着您的两个调度程序（几乎）同时开始。他们在内部运行的行动将相互对抗。

* * *

虽然我不能确切地说出你想用有限的代码来完成什么，但我希望你想要的是类似于这样的东西：

```
id func1 = [CCMoveBy actionWithDuration:0.5f position:ccp(-100, 0)];
id func2 = [CCMoveBy actionWithDuration:0.5f position:ccp( 100, 0)];
id seq = [CCSequence actions: func1, func2, nil];
[img runAction:seq]; 
```

# css - 如何使用悬停图片库效果制作 CSS 菜单“选中”？

> ID：12451334
> 
> 赞同：0
> 
> 时间：2012-09-16T22:39:08.677
> 
> 标签：css

我试图弄清楚如何使第一个导航菜单选项成为“**选定**”类，当您访问网页时，该类会自动（默认）显示右侧的图像。

然后，当您将鼠标悬停在其他链接上时，它仍会正确显示其他图像。现在，在您将鼠标移到菜单上的**“衬衫”上之前，您看不到第一张图片。**

链接：[http ://avisuals.web.fc2.com/readymade.html](http://avisuals.web.fc2.com/readymade.html)

有任何 CSS 提示或建议吗？

![截屏](../Images/82352e78d05fd3dee1eef9369a56e7e2.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T23:22:57.327

保留当前结构的解决方案是在链接具有焦点时使图像可见。

## [**演示**](http://dabblet.com/gist/3734782)

HTML 结构几乎保持不变，我只添加`tabindex=1`了链接

```
<ul id="gallery">
    <li class="thumb">
        <a class="thumb" href="#" tabindex=1>Orion</a>
        <div><img src="http://i.space.com/images/i/20521/i02/eso-orion-nebula-1600.jpg" alt="blue shirt" border="0"><br><a class="selected" href="images/blueshirt.jpg" border="0"></a></div>
    </li>
    <li class="thumb">
        <a class="thumb" href="#" tabindex=1>Pencil</a>
        <div><img src="http://i.space.com/images/i/21535/i02/pencil-nebula-wide-1600.jpg" alt=""><br><a class="enlarge" href="images/P1010426.jpg"></a></div>
    </li>
    <li class="thumb">
        <a class="thumb" href="#" tabindex=1>Carina</a>
        <div><img src="http://i.space.com/images/i/15222/i02/carina-nebula-1600-1200.jpg" alt=""><br><a class="enlarge" href="images/P1010426.jpg"></a></div>
    </li>
    <li class="thumb">
        <a class="thumb" href="#" tabindex=1>Trifid</a>
        <div><img src="http://i.space.com/images/i/19657/i02/trifid-nebula-1600.jpg" alt=""><br><a class="enlarge" href="images/P1010426.jpg"></a></div>
    </li>
</ul> 
```

我使用的 CSS - 保持最小化以概述功能（也因为我正在睡着），你可以添加眼睛糖果：

```
div { position: absolute; left: 0; opacity: 0; transition: 1s; }
a:focus { outline: none; }
li:first-child div, a:focus + div, a:active + div { opacity: 1; } 
```

我已经将包含图像的 div 堆叠在另一个之上并用来`opacity: 0;`隐藏它们。然后，我将第一个设置为具有`opacity: 1`，并且与具有焦点的链接对应的那个设置相同（也用于`a:active`IE）。

这种方法的主要缺点是它不是持久的。一旦单击页面上的其他任何位置，最后单击的链接将失去焦点，并且保存图像的相应 div 的不透明度再次变为 0。

* * *

为了使其持久化，您必须使用称为复选框 hack 的东西对 HTML 进行更多更改。这涉及用单选输入相应标签替换链接，隐藏单选按钮并在选中相应单选按钮时将不透明度设置为 1 ( `input[type=radio]:checked`)。

## [**演示**](http://dabblet.com/gist/3734840)

HTML变成：

```
<ul id="gallery">
    <li class="thumb">
        <input type=radio name=i id=i1 checked>
        <label for=i1>Orion</label>
        <div><img src="http://i.space.com/images/i/20521/i02/eso-orion-nebula-1600.jpg" alt="blue shirt" border="0"><br><a class="selected" href="images/blueshirt.jpg" border="0"></a></div>
    </li>
    <li class="thumb">
        <input type=radio name=i id=i2>
        <label for=i2>Pencil</label>
        <div><img src="http://i.space.com/images/i/21535/i02/pencil-nebula-wide-1600.jpg" alt=""><br><a class="enlarge" href="images/P1010426.jpg"></a></div>
    </li>
    <li class="thumb">
        <input type=radio name=i id=i3>
        <label for=i3>Carina</label>
        <div><img src="http://i.space.com/images/i/15222/i02/carina-nebula-1600-1200.jpg" alt=""><br><a class="enlarge" href="images/P1010426.jpg"></a></div>
    </li>
    <li class="thumb">
        <input type=radio name=i id=i4>
        <label for=i4>Trifid</label>
        <div><img src="http://i.space.com/images/i/19657/i02/trifid-nebula-1600.jpg" alt=""><br><a class="enlarge" href="images/P1010426.jpg"></a></div>
    </li>
</ul> 
```

和CSS：

```
input[type=radio] { display: none; }
label { cursor: pointer; }
div { position: absolute; left: 0; opacity: 0; transition: 1s; }
input[type=radio]:checked ~ div { opacity: 1; } 
```

# nokogiri - 如何使用 Nokogiri 从此 HTML 中提取文本并保留 元素？

> ID：12451337
> 
> 赞同：0
> 
> 时间：2012-09-16T22:39:49.610
> 
> 标签：nokogiri

我有这个字符串

```
<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE en-note SYSTEM \"http://xml.evernote.com/pub/enml.dtd\">\n\n\n<en-note>\n<font size=\"5\">text_part_1</font><br><br>\n<font size=\"5\">text_part_2</font><br><br>\n<font size=\"5\">text_part_3</font> 
```

我需要提取文本内容，还要保留`<br>`元素。所以结果是

```
text_part_1<br><br>text_part_2<br><br>text_part_3 
```

我怎样才能使用 Nokogiri 来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T06:39:57.093

部分问题是，您的 XML 是非法的。`<br>`未终止；它应该是`<br/>`XML 格式，或者有一个结束标记，即`</br>`.

因此，Nokogiri 在尝试解析 XML 时会引发错误。如果您`errors`在解析后检查该方法，您会看到如下内容：

```
[
#<Nokogiri::XML::SyntaxError: Premature end of data in tag br line 7>,
#<Nokogiri::XML::SyntaxError: Premature end of data in tag br line 7>,
#<Nokogiri::XML::SyntaxError: Premature end of data in tag br line 6>,
#<Nokogiri::XML::SyntaxError: Premature end of data in tag br line 6>,
#<Nokogiri::XML::SyntaxError: Premature end of data in tag en-note line 5>
] 
```

修复它，Nokogiri 将能够正确处理 XML。那时，您将能够做一些简单的事情，例如：

```
require 'nokogiri'

doc = Nokogiri::XML(<<EOT)
<?xml version=\"1.0\" encoding=\"UTF-8\"?>
<!DOCTYPE en-note SYSTEM \"http://xml.evernote.com/pub/enml.dtd\">

<en-note>
<font size=\"5\">text_part_1</font><br/><br/>
<font size=\"5\">text_part_2</font><br/><br/>
<font size=\"5\">text_part_3</font>
EOT

doc.search('br').each do |br|
  br.replace('##br##')
end

text = doc.content.gsub('##br##', '<br/>')
puts text 
```

这是带有更正`br`标签的输出：

```
text_part_1<br/><br/>
text_part_2<br/><br/>
text_part_3 
```

修复 XML 的最简单方法是在解析之前运行一些清理代码，例如：

```
doc = Nokogiri::XML(xml.gsub('<br>', '<br/>')) 
```

`xml`包含您的 XML 内容的变量在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T23:21:33.557

怎么样：

```
html =  "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE en-note SYSTEM \"http://xml.evernote.com/pub/enml.dtd\">\n\n\n<en-note>\n<font size=\"5\">text_part_1</font><br><br>\n<font size=\"5\">text_part_2</font><br><br>\n<font size=\"5\">text_part_3</font>"
doc = Nokogiri::HTML(html)
str = ""
doc.traverse { |n| str << n.to_s if (n.name == "text" or n.name == "br") }
str #=> "text_part_1<br><br>text_part_2<br><br>text_part_3" 
```

# php - 输出一堆json返回值

> ID：12451343
> 
> 赞同：0
> 
> 时间：2012-09-16T22:41:15.320
> 
> 标签：php, jquery, ajax, json, codeigniter

```
$('.more').live("click",function() {
    var id = $('.wallPosts:last').attr("relOne");
    $.ajax({
        type: "POST",
        url: "<?=base_url()?>index.php/regUserDash/ajaxMore",
        data:  {id: id},
        cache: false,
        success: function(data) {
                $("#morebox").append(data.idWallPosts);
        }
    });
}); 
```

使用上面的代码，我将如何输出一堆 json 返回值？以下是我的 json 值：

```
{"idwallPosts":"803"}{"idwallPosts":"798"}{"idwallPosts":"797"}{"idwallPosts":"796"}{"idwallPosts":"793"}{"idwallPosts":"792"}{"idwallPosts":"789"}{"idwallPosts":"785"}{"idwallPosts":"780"} 
```

下面是我的codeigniter代码：

```
public function ajaxMore() {
        $id = $this->input->post('id');
        $result = $this->db->query("SELECT * FROM wallposts WHERE idwallPosts < '$id' ORDER BY idwallPosts DESC LIMIT 9");
        foreach($result->result() as $row) {
            echo json_encode(array('idwallPosts' => $row->idwallPosts));
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T22:45:09.980

添加`dataType:'json'`到 的选项`$.ajax`，并使用`data`成功函数中的参数作为任何其他数组对象来迭代它

```
$.each(data, function( .. ) { .. } ): 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T07:30:20.453

您应该将`ajaxMore()`函数更改为：

```
public function ajaxMore() {
    $id = $this->input->post('id');
    $result = $this->db->query("SELECT * FROM wallposts WHERE idwallPosts < '$id' ORDER BY idwallPosts DESC LIMIT 9");

    $idwallPosts = array();
    foreach($result->result() as $row)
    {
        $idwallPosts[] = $row->idwallPosts));
    }

    print json_encode(array('posts'=>$idwallPosts));
    exit;
} 
```

在ajax调用中，添加`dataType:'json'`到$.ajax的options中，使用success函数中的参数数据为：

```
success: function(data) {
    var div_to_append = "<div>";

    $.each(data.posts, function(i,post){
        div_to_append += "<p>" + post + "</p>";
    });

    $(div_to_append).appendTo("#morebox");        
} 
```

# google-apps-script - 我如何以编程方式访问在 GUI builder 中创建的界面？

> ID：12451346
> 
> 赞同：0
> 
> 时间：2012-09-16T22:41:35.097
> 
> 标签：google-apps-script

我创建了一个具有 GUI 的 web 应用程序，我需要在启动时启动所述 GUI，并以编程方式从处理程序访问文本区域**和**两个文本框的内容，这**不是**一个强烈的需求，我可以稍等片刻同时得到答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T05:16:29.730

您可以在启动时添加 Gui（假设您使用 GUI builder），

```
 function doGet() {
  var app = UiApp.createApplication();
  app.add(app.loadComponent("MyGui"));
  return app;
} 
```

您可以在 GUI 构建器中设置小部件的 ID 和名称，然后在代码中使用它们，

```
app.getElementById('id') or e.parameter.[name] 
```

您还可以参考以下 URL 获取 gui

1.  [https://developers.google.com/apps-script/gui_builder](https://developers.google.com/apps-script/gui_builder)
2.  [https://developers.google.com/apps-script/uiapp](https://developers.google.com/apps-script/uiapp)
3.  [https://developers.google.com/apps-script/html_service](https://developers.google.com/apps-script/html_service)

# mobile - 我的诺基亚 x2 手机上的 lwuit 应用程序运行缓慢

> ID：12451347
> 
> 赞同：1
> 
> 时间：2012-09-16T22:41:47.243
> 
> 标签：mobile, java-me, lwuit, nokia

为什么我的 lwit 应用程序在手机上运行缓慢，我该如何修复它以更好地运行？

当我运行 LwuitDemo 时，它运行良好。所以也许我的代码中缺少一些东西。

我想显示对话框时使用它：

```
 Display.getInstance().invokeAndBlock(new Runnable() {
            public void run() {
                Dialog.show("Add User/Flux", "Please enter the pin", "Ok", null);
            }
        }); 
```

当我想创建和显示表单时

```
System.gc(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T09:37:48.477

你绝不能那样做。调用和阻塞会在阻塞 EDT 的同时打开一个新线程，这与您需要做的完全相反。

您需要在 EDT 上显示对话框，而不是相反，例如使用`callSerially/AndWait`.

# mysql - 选择不同的*错误mysql

> ID：12451348
> 
> 赞同：-1
> 
> 时间：2012-09-16T22:42:10.450
> 
> 标签：mysql

我有下表

```
mysql> select * from abc;
+---+------+------+
| A | B    | C    |
+---+------+------+
| 2 | 2    | 2    |
| 1 | 2    | 3    |
| 3 | 3    | 2    |
| 4 | 3    | 3    |
+---+------+------+
4 rows in set (0.00 sec)

mysql> select count(distinct *)
    -> from abc
    -> group by a;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that
corresponds to your MySQL server version for the right syntax to use near '*)
from abc
group by a' at line 1 
```

任何人都可以知道**上述**查询的正确语法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T22:56:26.593

因为`DISTINCT`您需要提供一个要使用的列`DISTINCT`。

因此，例如在您的情况下：`SELECT DISTINCT(a) FROM abc`

您想根据唯一值计算表中的行数吗？

```
SELECT COUNT (DISTINCT a) FROM abc 
```

没有必要，`GROUP BY`因为`DISTINCT`已经处理好了。

# joomla - Joomla 2.5.6 php 错误安装“升级的 1.5”模板

> ID：12451349
> 
> 赞同：0
> 
> 时间：2012-09-16T22:42:33.650
> 
> 标签：joomla, joomla2.5

尝试在 Joomla 中安装转换后的 1.5 模板会导致 500 服务器错误。原来是由PHP错误引起的：

> 试图在第 54 行的 library/joomla/installer/adapters/template.php 中获取非对象的属性

和

> 致命错误：调用`attributes()`非对象的成员函数”在下一行。

有任何 Joomla 专家有想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T23:23:44.273

这种类型的错误是模板 mainfest (XML) 文件格式错误的结果。即它的结构不正确。

当您转换 1.5 模板时，我会查看 docs.joomla.org 文章“[将 Joomla 1.5 模板升级到 Joomla 2.5](http://docs.joomla.org/Upgrading_a_Joomla_1.5_template_to_Joomla_2.5) ”

如果您发布模板清单文件，我们可能会提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T08:54:05.073

*Joomla库/joomla/installer/adapters/template.php*的第 53 和 55 行与加载语言文件有关。具体线路如下。如您所见，这仅与从清单中查找语言文件的名称有关

```
$this->manifest = $this->parent->getManifest();
$name = strtolower(JFilterInput::getInstance()->clean((string) $this->manifest->name, 'cmd'));
$client = (string) $this->manifest->attributes()->client; 
```

我建议第 53 行找不到 $this->parent->getManifest() ，因此在一个空对象（`$this->manifest`部分）上调用属性，并且找不到实例，`$this->manifest`因为它没有存在。

如果您不知道清单是什么，请阅读[此Joomla Wiki 文章。](http://docs.joomla.org/Manifest_files)我建议您是否永久升级您通读的模板并更新您的模板 XML 文件以确保它适用于所有这些。正如上面所说的 cppl 也尝试阅读将 Joomla 1.5 模板升级到 2.5 [here](http://docs.joomla.org/Upgrading_a_Joomla_1.5_template_to_Joomla_2.5)。特别是在您的情况下，语言部分似乎会产生错误-但是由于清单是通过Joomla非常普遍的事情，我怀疑这只是找到的第一个实例-并且将通过安装进行系统化！

# azure - 无法使用 StorageClient 1.7.1 运行 Azure 项目

> ID：12451350
> 
> 赞同：2
> 
> 时间：2012-09-16T22:42:52.103
> 
> 标签：azure, storage, worker

我正在尝试在 VS2012 中运行包含三个项目的 Azure 解决方案：

1.  InSysDashboard（Web 角色）
2.  InSysService（Web 角色）
3.  InSysWatcher（工作者角色）

在添加 3\. 之前，1\. 和 2\. 构建和部署都很好。3\. 自己构建就好了，部署好（但这当然不好，因为角色不能单独部署，需要作为同一个包的一部分进行部署）。

问题似乎出在我从[https://github.com/WindowsAzure/azure-sdk-for-net/tree/sdk_1.7.1](https://github.com/WindowsAzure/azure-sdk-for-net/tree/sdk_1.7.1)下载并编译的 Azure SDK 1.7.1 Microsoft.WindowsAzure.StorageClient 上。我正在使用此资源中的 Microsoft.WindowsAzure.StorageClient 和 Microsoft.WindowsAzure.Configuration 库，以及来自 VS2012 1.7 June SDK 的 Microsoft.WindowsAzure.Diagnostics 和 Microsoft.WindowsAzure.ServiceRuntime。

包含所有三个项目的解决方案编译时没有错误。

在任何项目中都没有明确引用 Microsoft.WindowsAzure.StorageClient 1.7，只有 1.7.1。

但是，当我尝试运行解决方案时，无法加载 Worker Role (3.)。输出窗口包含以下代码段：

```
'WaIISHost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Web.ApplicationServices\v4.0_4.0.0.0__31bf3856ad364e35\System.Web.ApplicationServices.dll'
'WaIISHost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Data.Entity\v4.0_4.0.0.0__b77a5c561934e089\System.Data.Entity.dll'
Microsoft.WindowsAzure.ServiceRuntime Information: 200 : Role entrypoint . CALLING   OnStart()
Microsoft.WindowsAzure.ServiceRuntime Information: 203 : Role entrypoint . CALLING   Run()
Microsoft.WindowsAzure.ServiceRuntime Information: 100 : Role environment . INITIALED RETURNED. HResult=0
'WaIISHost.exe' (Managed (v4.0.30319)): Loaded 'F:\Everything\Current_Work\Web_Apps\Azure\InSys\InSysCloud\csx\Debug\roles\InSysService\approot\bin\Microsoft.WindowsAzure.Diagnostics.dll'
Microsoft.WindowsAzure.ServiceRuntime Information: 101 : Role environment . INITIALIZED
'WaWorkerHost.exe' (Managed (v4.0.30319)): Loaded 'F:\Everything\Current_Work\Web_Apps\Azure\InSys\InSysCloud\csx\Debug\roles\InSysWatcher\approot\Microsoft.WindowsAzure.StorageClient.dll'
Microsoft.WindowsAzure.ServiceRuntime Information: 202 : Role entrypoint . COMPLETED OnStart()
The thread 'Role Initialization Thread' (0xaa4) has exited with code 0 (0x0).
Microsoft.WindowsAzure.ServiceRuntime Information: 203 : Role entrypoint . CALLING   Run()
'WaWorkerHost.exe' (Managed (v4.0.30319)): Loaded 'F:\Everything\Current_Work\Web_Apps\Azure\InSys\InSysCloud\csx\Debug\roles\InSysWatcher\approot\InSysWatcher.dll', Symbols loaded.
'WaWorkerHost.exe' (Managed (v4.0.30319)): Loaded 'C:\Windows\Microsoft.Net\assembly\GAC_MSIL\System.Web.ApplicationServices\v4.0_4.0.0.0__31bf3856ad364e35\System.Web.ApplicationServices.dll'
Microsoft.WindowsAzure.ServiceRuntime Critical: 201 : Role entrypoint could not be created:
System.TypeLoadException: Unable to load the role entry point due to the following exceptions:
-- System.IO.FileLoadException: Could not load file or assembly 'Microsoft.WindowsAzure.StorageClient, Version=1.7.1.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)
File name: 'Microsoft.WindowsAzure.StorageClient, Version=1.7.1.0, Culture=neutral, PublicKeyToken=null'

=== Pre-bind state information ===
LOG: User = BertiesExtreme\bertie
LOG: DisplayName = Microsoft.WindowsAzure.StorageClient, Version=1.7.1.0, Culture=neutral, PublicKeyToken=null
 (Fully-specified)
LOG: Appbase = file:///F:/Everything/Current_Work/Web_Apps/Azure/InSys/InSysCloud/csx/Debug/roles/InSysWatcher/approot
LOG: Initial PrivatePath = F:\Everything\Current_Work\Web_Apps\Azure\InSys\InSysCloud\csx\Debug\roles\InSysWatcher\approot
Calling assembly : InSysWatcher, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null.

LOG: This bind starts in default load context.
LOG: Using application configuration file: F:\Everything\Current_Work\Web_Apps\Azure\InSys\InSysCloud\csx\Debug\roles\InSysWatcher\approot\InSysWatcher.dll.config
LOG: Using host configuration file: 
LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework64\v4.0.30319\config\machine.config.
LOG: Policy not being applied to reference at this time (private, custom, partial, or location-based assembly bind).
LOG: Attempting download of new URL file:///F:/Everything/Current_Work/Web_Apps/Azure/InSys/InSysCloud/csx/Debug/roles/InSysWatcher/approot/Microsoft.WindowsAzure.StorageClient.DLL.
WRN: Comparing the assembly name resulted in the mismatch: PUBLIC KEY TOKEN
ERR: Failed to complete setup of assembly (hr = 0x80131040). Probing terminated.

-- System.IO.FileLoadException: Could not load file or assembly 'Microsoft.WindowsAzure.StorageClient, Version=1.7.1.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)
File name: 'Microsoft.WindowsAzure.StorageClient, Version=1.7.1.0, Culture=neutral, PublicKeyToken=null' 
```

最后一个条目似乎表明 Microsoft.WindowsAzure.StorageClient 存在问题。

如果我查看构建解决方案时生成的 CSX 文件夹，对于我找到的每个项目：

1.  Release/roles/InSysDashboard/approot/Microsoft.WindowsAzure.StorageClient.dll（即 1.7.1）
2.  Release/roles/InSysService/approot/Microsoft.WindowsAzure.StorageClient.dll（即 1.7.1）
3.  Release/roles/InSysWatcher/approot/Microsoft.WindowsAzure.StorageClient.dll（即**1.7.0**）

出于某种原因，Microsoft.WindowsAzure.StorageClient.dll 的 1.7.0 版包含在 Worker Role 中。我检查了参考列表，它肯定包括 1.7.1 而不是 1.7.0，那么为什么要包括 1.7.0？我假设在这个阶段这是 Worker Role 没有运行的原因。

有任何想法吗？

更多信息：

如果我用 1.7.1.0 版本替换 C:\Program Files\Microsoft SDKs\Windows Azure.NET SDK\2012-06\ref 中的 Microsoft.WindowsAzure.StorageClient.dll (1.7.0.0) 版本，我会得到一个与 Microsoft.WindowsAzure.Diagnostics 相关的错误。

```
{"Could not create Microsoft.WindowsAzure.Diagnostics.DiagnosticMonitorTraceListener, Microsoft.WindowsAzure.Diagnostics, Version=1.7.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35."} 
```

然后在内部异常中：

```
{"Could not load file or assembly 'Microsoft.WindowsAzure.StorageClient, Version=1.7.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)":"Microsoft.WindowsAzure.StorageClient, Version=1.7.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"} 
```

Microsoft.WindowsAzure.Diagnostics 似乎依赖于 Microsoft.WindowsAzure.StorageClient 1.7.0.0，因此将其替换为 1.7.1.0 会导致问题。我猜这个依赖是硬编码的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T03:15:22.307

注释掉 InSysWatcher（工作者角色）的 app.config 的 systems.diagnostics 部分似乎有所帮助，即现在可以部署该解决方案并且似乎按预期运行。这似乎不是“正确”的方法，但在花了将近 2 天的时间之后，此时“无论什么都有效”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T18:26:57.427

完全令人沮丧，我发现的所有工作都是在 VS 中清理解决方案并重试 - 有时需要多次清理才能运行解决方案。

当 GAC 中存在另一个版本的 StorageClient 时，似乎有时会出现冲突

# asp.net - 如何在 MVC 中传递模型，这样我就不必查询数据库两次？

> ID：12451351
> 
> 赞同：0
> 
> 时间：2012-09-16T22:42:57.237
> 
> 标签：asp.net, asp.net-mvc, razor

我想在我的页面上创建一个超链接来导出我的模型，但我不想为我需要导出的每个模型编写一个方法。我想最终得到一种可以将模型作为其参数之一并在该模型上执行导出逻辑的方法。*有没有一种方法可以将发送到视图的模型传递回控制器操作？*

**编辑：**

我有以下控制器动作-

```
 public ViewResult PenDaily(Nullable<DateTime> startDate = null, Nullable<DateTime> endDate = null, string listName = "")
    {
        //Removed code for brevity/clarity

        PenDailyViewModel penDailyView = new PenDailyViewModel();
        penDailyView.startDate = startDate;
        penDailyView.endDate = endDate;
        penDailyView.listNames = GetLists(m_db);
        penDailyView.penDaily = GeneratePenDaily(m_db, listName, startDate, endDate);
        penDailyView.penSummary = GeneratePenSummary(m_db, startDate, endDate, "").Where(a => a.listName == listName);

        return View(penDailyView);
    } 
```

PenDailyViewModel 是我传递给我的 Razor 视图的模型对象。PenDaily 和 PenSummary 都是 IQueryable 对象，在结果页面上的表中使用。PenDaily 是主要数据集，PenSummary 用于表格页脚中的总行。

我想获取这组数据并将其导出到文件中。我有一个为此编写的函数，但我不知道如何从我的页面中使用它。我想进行设置，以便当用户单击超链接时，系统会提示他们保存导出。

**如果有帮助，我的 Razor 观点：**

```
@model WebTools.Models.PenDailyViewModel

<table>
    <thead>Header Stuff</thead>
    <tbody>
    @foreach (var item in Model.penDaily)
    {
        //Generate table body
    }
    </tbody>
    <tfoot>
    @foreach (var item in Model.penSummary)
    {
        //Generate table footer
    }
    </tfoot>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:34:38.933

就个人而言，我总是为视图（即 a `GET`）或任何`POSTS`.

*   `IndexViewModel`
*   `IndexInputModel`

很多时候，这些 poco 非常相似。

现在的诀窍可能是利用`AutoMapper`，这样您就可以更容易地支持/维护您的代码，而不是拥有大量从左到右的代码（例如 foo = viewmodel.Foo）。

这个想法是这样的：你有一个在控制器中使用的基类库对象。它是主要的 POCO 对象。接下来，您将拥有与此 POCO 的架构/结构直接相关的视图模型和输入模型。使用 AutoMapper（或大量从左到右的代码，如果您对这种编程内容还不熟悉），您可以轻松地在*相关*对象之间“复制”数据。

例如。

示例视图。

视图模型。

```
public class IndexViewModel
{
    public string Name { get; set; }
    public string Description { get; set; }
    public Uri InfoUrl { get; set; }
} 
```

(View) Action 方法（错误检查等。被剥离）。

```
// product/{id}   eg /products/5
public Action Index()
{
    // Load the Product.
    var product = YourRepository.Load(id);
    if (product == null)
    {
        return NotFound("Product can't be found.");
    }

    // Convert the product to this view requirements.
    // This will copy over the Name and the Uri.
    var model = Mapper.Map<Product, IndexViewModel>(product);

    return View(model);
} 
```

这里的*必要条件*是该 ONE 视图的模型有一个硬且清晰的表示。每个视图都应该有自己的模型，因为每个视图都是独一无二的。

现在你可能会说“我不想要两个模型”。好吧，我建议你这样做。事实上，这里有 3 个模型。主要用于控制器/服务/业务逻辑。另外两个用于输入（可选）或视图（每个操作都需要某种类型的结果）。

# 更新

你说你想避免多次去数据库。公平通话！:) 诀窍是利用[CACHING](http://msdn.microsoft.com/en-us/library/system.runtime.caching.memorycache.aspx)代替。不将数据存储在客户端？为什么？首先，我可以在 1 秒内破解客户端数据。第二缓存（通常）便宜且（通常）非常快。

让我们更新初始代码...

```
// product/{id}   eg /products/5
public Action Index()
{
    // Load the Product from your cache
    var product = YourCache.Load(id);
    if (product == null)
    {
        return NotFound("Product can't be found.");
    }

    // Convert the product to this view requirements.
    // This will copy over the Name and the Uri.
    var model = Mapper.Map<Product, IndexViewModel>(product);

    return View(model);
} 
```

..这是一些示例缓存伪代码..

```
public class YourCache
{
    private static ObjectCache cache = MemoryCache.Default; 

    private IRepository Repository { get; set; }

    public YourCache(IRepository repository)
    {
        Repository = repository;
    }

    public Product Load(int id)
    {
        var product = cache["Product-" + id] as Product;
        if (product == null)
        {
            // Grab it and remember it.
            product = repository.Load(id);

            if (product != null)
            {
                cache.Set("Product-" + id, product, ....);
            }
        }

        return product;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T23:28:56.390

在隐藏的表单字段中传递您想要返回的数据，然后使用表单而不是简单的超链接来调用您的控制器。然后它将接收来自隐藏字段的数据。

这是一个真正的页面状态，而不是可能与页面状态不同步的会话状态（使用后退按钮、打开另一个选项卡/窗口等）。

也就是说，如果查询便宜（因此很快），访问数据库不一定是坏事。

# css - 优化（删除冗余和合并）CSS 的工具？

> ID：12451354
> 
> 赞同：47
> 
> 时间：2012-09-16T22:43:41.977
> 
> 标签：css, compression, minify, yui-compressor

我正在寻找一个好的 CSS 压缩、合并和优化工具。我找到了清理 CSS 的工具，但它们不会优化覆盖。

这是一个基本示例：

`a{color:#000}`

在另一行上，`a`颜色被以下内容覆盖：

`a{color:#fff}`

有谁知道可以清理未使用的 CSS 的工具，它被覆盖并只保留应用的样式？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-20T18:36:57.673

我不是特别明白“清理未使用的 CSS”是什么意思，但无论如何，我会给你两个工具，也许其中一个会起作用（*好的霰弹枪方法*）。

[CSS Lint](http://csslint.net/)似乎指出了“重复属性”。有[一系列](http://net.tutsplus.com/articles/should-you-start-using-csslint/) [文章](http://www.smashingninja.com/webdesign/csslint-check-your-css-code/)涵盖了它的一些功能。但是你有两个定义的测试，

```
a { color: #fff; }
a { color: #000; } 
```

它没有做任何事情。尽管 ...

[Code Beautifier](http://www.codebeautifier.com/)确实结合了这两个选择器，选择了两者中的后者（即实际应用的样式）。导致：

```
a {
  color:#000;
} 
```

# c++ - 分而治之——买还是卖？（最大连续子数组）

> ID：12451355
> 
> 赞同：2
> 
> 时间：2012-09-16T22:44:00.507
> 
> 标签：c++, recursion, divide-and-conquer

该程序的要点是使用蛮力方法（有效！）和分治法（无效）找到具有波动股票价格的一维数组的最大子数组。该程序的目的是找到天的集合（因此结构中的 lsub 和 rsub）和这些天的最大利润。

我在网上看到的所有地方，比如[这个 powerpoint](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&ved=0CDUQFjAB&url=http://www.personal.kent.edu/~aguercio/CS46101Slides/Ch04-Lesson5-DivideConquer.pptx&ei=EDpWUPWMJ6Xq0gHXw4DoDg&usg=AFQjCNGfrrGcvosT6z2rzkuH3zNnyfJI8Q&sig2=NkVYIQhWQPTpC-O4lzjLcw)都表明我的代码应该可以工作。我也看到了类似的东西，但是在 StackOverflow 上的 Java 中，该代码的实现也不起作用。[这是该 Java 程序的链接。](https://stackoverflow.com/questions/6997019/problem-with-divide-and-conquer-maximum-consecutive-subarray-mcs)

我的代码如下：

```
#include <stdio.h>
#include <iostream>
#include <climits>
#include <cstring>

struct funOut{
int lsub; //Left subscript
int rsub; //Right subscript
int maximum; //Contains the max value
 //This way, max has the absolute smallest value and only needs to be done once rather than at the beginning of the algorithm calls.
};

void load(int arr[], int n);
void brute(int arr[],  int n, funOut &out);
funOut dac(int arr[], int low, int high, funOut &out);
void findMax(int sumLval, int sumRval, funOut &sumMval, int low, int mid, int high, funOut &out);
funOut crossSum(int arr[], int low, int mid, int high);
void print(funOut out);

using namespace std;

int main(void)
{
   funOut out;

   string alg;
   cin >> alg;

   int n;
   cin >> n;

   int arr[n];

   // cout << n << endl;

   load(arr, n);
   if(alg[0] == 'b')
      brute(arr, n, out); //PARAMETERS NEEDED
   else if(alg[0] == 'd')
   {
      out.maximum = 0;
      out = dac(arr, 1, n-1, out);
   }

   else
   {
      cout << "\nERROR: No algorithm chosen, aborting program." << endl;
      return 0;
   }

   cout << "Before Print" << endl;
   print(out);
   return 0;
}

void load(int arr[], int n)
{
   cout << "Loading" << endl;
   for(int i=0; i<n; i++)
      cin >> arr[i];
}

void brute(int arr[], int n, funOut &out) //THIS WORKS!!!
{
   out.maximum = 0;
   int change;
   int temp = 0;
   for(int i=1; i<n-1; i++)
   {
      for(int j=i; j<n; j++)
      {
         change = arr[j] - arr[j-1];
         temp += change;
         if(temp > out.maximum){
            out.lsub = i;
            out.rsub = j;
            out.maximum = temp;
         }     
      }
      temp = 0;
   }
}

funOut dac(int arr[], int low, int high, funOut &out)
{
   cout << "DAC Start!" << endl;
   if(low == high)
   {
      out.lsub = out.rsub = low;
      out.maximum = arr[low];
      return out;
   }
   else
   {
      // cout << "DAC IF" << endl;
      int mid = (low + high)/2;

      funOut sumLval = dac(arr, low, mid, out);
      funOut sumRval = dac(arr, mid+1,high, out);
      funOut sumMval = crossSum(arr, low, mid, high);

      cout << "\nsumLval = " << sumLval.maximum << endl; 
      cout << "\nsumRval = " << sumRval.maximum << endl;
      cout << "\nsumMval = " << sumMval.maximum << endl;
      //FindMax
      if(sumLval.maximum >= sumRval.maximum && sumLval.maximum >= sumMval.maximum)
         return sumLval;         
      else if(sumRval.maximum >= sumLval.maximum && sumRval.maximum >= sumMval.maximum)
         return sumRval;
      else
         return sumMval;
   }
}

funOut crossSum(int arr[], int low, int mid, int high)
{
funOut sumMval;
int lsum = 0;
int rsum = 0;
int sum = 0;
int maxl, maxr;
//For loop finding lsum
for(int i=mid; i>=low; i--)
{
   cout << "DAC For I = " << i << endl;
   sum += arr[i];
   if(sum > lsum)
   {
      lsum = sum;
      maxl = i;
   }
}

sum = 0;

for(int j=mid+1; j<=high; j++)
{
   cout << "DAC For J = "<< j << endl;
   sum += arr[j];
   if(sum > rsum)
   {
      rsum = sum;
      maxr = j;
   }
}

sumMval.lsub = maxl;
sumMval.rsub = maxr;
sumMval.maximum = lsum + rsum;

return sumMval;
}

void print(funOut out)
{
   cout << "The max value is: ";
   cout << out.maximum << endl;
   cout << "The left subscript is: ";
   cout << out.lsub << endl;
   cout << "The right subscript is: ";
   cout << out.rsub << endl;
} 
```

示例数据集：（它们应该在单独的行上，但它不允许我这样做。）

```
d
17
100
113
110
85
105
102
86
63
81
101
94
106
101
79
94
90
97 
```

预期的输出是：

最大值为：43

左下标为：8

右下标是：11

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T23:21:49.650

从概念上讲，您的蛮力方法正在做大量多余的工作。

当您将数组中的所有点对点差异相加时，您得到的只是两端之间的差异：

```
int diff = (x[1] - x[0]) + (x[2] - x[1]) + (x[3] - x[2]) + (x[4] - x[3]); 
```

以上与此相同（因为所有其他值都取消了）：

```
int diff = x[4] - x[0]; 
```

所以你所有的蛮力算法似乎正在做的是搜索`i`和`j`最大的差异受`i < j`. 这相当于找到数组的最小值和最大值，其中最小值出现在最大值之前。

在我看来，这像是动态编程的问题。我看不出分而治之对这个问题有什么用处。

**[编辑]**

所以，我认为问题是`crossSum`。它正在做一些与`brute`. 当然，您只想找到左侧 ( `minl`) 中的最小值的索引和右侧 ( ) 中的最大值的索引`maxr`。该输出结构中的“最大值”只是`arr[maxr] - arr[minl]`.

有趣的是，对于这个问题，分而治之的方法仍然不必要地低效。考虑一下：

```
struct funOut f;
f.lsub = 0;
f.rsub = 0;
f.maximum = 0;

int minval = arr[0];
int minidx = 0;

for( int i = 1; i < n; i++ ) {
    if( arr[i] < minval ) {
        minval = arr[i];
        minidx = i;
        continue;
    }

    int delta = arr[i] - minval;
    if( delta > f.maximum ) {
        f.lsub = minidx;
        f.rsub = i;
        f.maximum = delta;
    }
} 
```

# mongodb - Mongoose/Mongo 在 objectIds 数组中查找

> ID：12451358
> 
> 赞同：12
> 
> 时间：2012-09-16T22:44:16.117
> 
> 标签：mongodb, mongoose, nodes

我在 mongo 中有这个项目：

```
[ { title: 'Product Name',
_id: 5052843e023273693300013c,
description: 'This is a fake description',
categories: [ 5052843e023273693300010a ],
} ] 
```

我想找到具有此类别的此类产品。我努力了：

```
Product.find({ categories:  mongoose.Types.ObjectId('5052843e023273693300010a')})
Product.find({ categories:  mongoose.mongo.BSONPure.ObjectID.fromString('5052843e023273693300010a')})
Product.find({ categories:  '5052843e023273693300010a'})
Product.find({ 'categories':  '5052843e023273693300010a'})
Product.find({ categories:  {$in: ['5052843e023273693300010a']}})
Product.find({ categories:  Schema.Types.ObjectId('5052843e023273693300010a')}) 
```

但没有任何效果。我可以使用 _id: '5052843e023273693300013c' 按 id 获取。

请注意，当插入产品时，类别 ID 被添加为字符串（这意味着我只是分配了 ID 而不是类别对象，但这并不能解释为什么上述方法都不起作用 - 它在转储中未引用，因此 Mongo 可能识别为对象 ID。

关于 SO 的类似问题没有得到答案。

我正在使用最新的 Mongoose（3 个东西）和最近的 Mongo，Node。

更新：

我可以使用以下命令从 CLI 中很好地获取：

```
db.products.find({ categories: '5052843e02327369330000fe' }); 
```

有趣的是，我可以通过在我的代码中执行不相等来获取它 - 嗯？：

```
Product.find({ categories: { $ne: '5052843e02327369330000fe' }}) 
```

我的架构如下：

```
 var Product = new Schema({
        title: { type: String, required: true },
        slug: { type: String },
        summary: { type: String }, //browser title
        description: { type: String, required: false },
        excerpt: { type: String },    //for list and also for meta description
        publish: { type: Boolean },
        featured: { type: Boolean },
        unavailable: { type: Boolean },
        model: { type: String },
        google: { type: String },
        tags: { type: Array },
        categories:  [{ type: Schema.Types.ObjectId, ref: 'Category' }],
        manufacturer: { type: String },
        variations: { type: Array },
        prices: { type: Array },
        images: { type: Array },
        specs: { type: Array },
        modified: { type: Date, default: Date.now }

    });

    var Category = new Schema({
        title: { type: String, required: true },
        description: { type: String },
        parent: { type: Schema.Types.ObjectId, ref: 'Category' },
        images: { type: Array }
    }); 
```

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-04-28T20:51:07.257

在某些情况下，使用 Mongoose，您必须强制将字符串转换为 ID。通常它会自动为您执行此操作，但在您的特定情况下，它不会。以下代码片段将获取包含传递的 ID 的所有连接。

```
var mongoose = require('mongoose');
Node.find({ connections: mongoose.Types.ObjectId("535c5c1b8aa6dc5f021e8a98") }, function (err, results) { 
    console.log(results); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T23:26:45.157

发生的事情是，Mongoose 正在将您在调用中使用的任何值转换为 ObjectId 的值，因为这`categories`就是模式中定义的方式。但是您尝试匹配的文档值具有字符串类型而不是 ObjectId，因此它不匹配。`Product.find``categories``categories`

要让事情再次正常工作，您需要清理现有文档以匹配您定义的架构。

# php - PHP页面创建过多负载，服务器超载页面？

> ID：12451359
> 
> 赞同：2
> 
> 时间：2012-09-16T22:44:23.443
> 
> 标签：php, load

我有一个繁忙的网站，不断关闭服务器。

什么是可以查看服务器负载的简单 PHP 代码，如果服务器负载变量设置为 2，那么当负载大于 2 时 - 它将为用户生成一个页面 - 服务器超载。

有谁知道在哪里可以找到这么简单的代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-16T22:50:25.150

如果负载超过 80%，它就会死掉。

但是，这在 Windows 平台上不受支持：

```
<?php
$load = sys_getloadavg();
if ($load[0] > 80) {
    header('HTTP/1.1 503 Too busy, try again later');
    die('Server too busy. Please try again later.');
}
?> 
```

参考。: PHP.net : [sys_getloadavg](http://php.net/manual/en/function.sys-getloadavg.php)

# google-apps-script - 有没有办法使用仅包含特定电子表格的 Google Apps 脚本创建 pdf？

> ID：12451360
> 
> 赞同：3
> 
> 时间：2012-09-16T22:44:28.523
> 
> 标签：google-apps-script

在电子表格应用程序本身中，您可以选择仅打印特定工作表。在应用程序中创建 pdf 时，您还可以关闭网格线。创建pdf时有没有办法通过脚本来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T15:05:30.857

看看这个代码片段：[https ://gist.github.com/4169590](https://gist.github.com/4169590)

它的作用是使用 Google 电子表格内置下载作为 PDF 功能，因此可以进行相同类型的自定义，包括隐藏网格线和指定工作表。使用 GET 参数来获得所需的输出。最后，脚本将 PDF 文件转换为 blob，您可以在自己的脚本中进一步操作。要使其运行，您需要对电子表格提要范围进行额外授权。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-17T23:33:59.653

@rcknr，为我工作，下面有更多选择。（来自：[http](http://productforums.google.com/forum/#!msg/apps-script/wQvCF6yY1Qk/R0uyVmf-Xx0J) ://productforums.google.com/forum/#!msg/apps-script/wQvCF6yY1Qk/R0uyVmf-Xx0J ）

像这样的网址： [https ://spreadsheets.google.com/feeds/download/spreadsheets/Export?key=tOHm3f8tdIxf7tSZzWvBGiA&gid=0&size=legal&fitw=true&gridlines=false&portrait=false&exportFormat=pdf](https://spreadsheets.google.com/feeds/download/spreadsheets/Export?key=tOHm3f8tdIxf7tSZzWvBGiA&gid=0&size=legal&fitw=true&gridlines=false&portrait=false&exportFormat=pdf)

其他设置

```
fmcmd=12
size=legal/A4
fzr=true/false
portrait=false/true
fitw=true/false
gid=0/1/2  
gridlines=false/true
printtitle=false/true
sheetnames=false/true
pagenum=UNDEFINED
attachment=false/true 
```

有时需要的真/假，我不能使用 0/1 代替。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-21T10:31:54.047

用于创建电子表格特定工作表的 pdf 的 Google 应用程序脚本。

```
function generatePdf() {
    var originalSpreadsheet = SpreadsheetApp.getActive();

    var sourcesheet = originalSpreadsheet.getSheetByName("Sheet - Name");
    var sourcerange = sourcesheet.getRange('A1:G7');  // range to get - here I get all of columns which i want
    var sourcevalues = sourcerange.getValues();
    var data = sourcesheet.getDataRange().getValues();

    var newSpreadsheet = SpreadsheetApp.create("Spreadsheet to export"); // can give any name.
    var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
    var projectname = SpreadsheetApp.getActiveSpreadsheet();
    var sheet = sourcesheet.copyTo(newSpreadsheet);
    var destrange = sheet.getRange('A1:G7');
    destrange.setValues(sourcevalues);
    newSpreadsheet.getSheetByName('Sheet1').activate();
    newSpreadsheet.deleteActiveSheet();

    var pdf = DriveApp.getFileById(newSpreadsheet.getId());
    var theBlob = pdf.getBlob().getAs('application/pdf').setName("name");

    var folderID = "Folder Id"; // Folder id to save in a folder.
    var folder = DriveApp.getFolderById(folderID);
    var newFile = folder.createFile(theBlob);

    DriveApp.getFileById(newSpreadsheet.getId()).setTrashed(true); 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-30T16:32:59.397

当您选择导出为 pdf 时，您会看到一个带有选项的消息框。在此消息框的右侧有五个复选框。检查第二个，然后您将隐藏导出中的网格线。我不知道这个复选框的标签，因为我使用的语言不是英语。

祝你好运！

- 罗伯特

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-26T23:15:25.493

不幸的是，目前 Apps 脚本无法实现这一点，但您可以在我们的[问题跟踪器](http://code.google.com/p/google-apps-script-issues/issues/list)上提交功能请求。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-20T17:35:05.470

我只是隐藏了我不想放在 pdf 中的表格

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-14T22:19:39.787

这是一个解决方案

```
var blob = DriveApp.getFileById(idsheet).getAs("application/pdf");
blob.setName("name".pdf");
var dossier = DriveApp.getFolderById("0Bx71KaTqXxQPQUYyVEVyYkJ0bEU");
dossier.createFile(blob); 
```

# vb.net - 将文本文件的内容转换为新文件

> ID：12451365
> 
> 赞同：0
> 
> 时间：2012-09-16T22:44:52.907
> 
> 标签：vb.net, streamreader, streamwriter

我正在尝试创建一个转换器来读取一个非常长的文本文件，以查找包含某个字符串的行。当它找到这个字符串时，它应该将找到的行连同之前和之后的其他行一起写入一个新文件。

我的应用程序有效，但只重复它创建的所有行组中找到的第一行。

例如，旧文件中的组如下所示：

```
[PARTICLE930]
INDEX = 930              ;º§¶óÅä076_¼ÕµîÀÌÆåÆ®_¿À¸¥
ABSAXIS=0 
PARTICLE=.\Chef\60LV_WHITE\B\BF\076\hand_eff_r.spt 
```

我想只提取以开头`PARTICLE=.\`的行并自动在其周围创建新行。因为组号是连续的并且没有间隔，所以我不需要提取索引号，我可以即时创建它。

到目前为止我的代码：

```
Dim source As String = "Particle.ini"
Dim dest As String = "CParticle.ini"
Dim path As String = Application.StartupPath
Dim max As Integer = 1233

Dim l_pnum As String = "[PARTICLE{0}]"
Dim l_index As String = "INDEX = {1}"
Dim l_absaxis As String = "ABSAXIS=0"
Dim l_particle As String = "{2}"

If System.IO.File.Exists(path & "\" & source) Then
    Dim objReader As New System.IO.StreamReader(path & "\" & source)
    Dim objWriter As New System.IO.StreamWriter(path & "\" & dest, True)

    objWriter.WriteLine("[PARTICLE_INFO]")
    objWriter.WriteLine("MAXPARTICLE=" & max.ToString)

    Dim loop_num As Integer = 1
    Do While objReader.Peek() <> -1

        Dim line_read As String = objReader.ReadLine()

        If line_read.Contains("PARTICLE=.\") Then

            l_pnum = l_pnum.Replace("{0}", loop_num.ToString)
            l_index = l_index.Replace("{1}", loop_num.ToString)
            l_particle = l_particle.Replace("{2}", line_read)

            objWriter.WriteLine(l_pnum)
            objWriter.WriteLine(l_index)
            objWriter.WriteLine(l_absaxis)
            objWriter.WriteLine(l_particle)

            loop_num = loop_num + 1
        End If

    Loop

Else
    MessageBox.Show("File does not exist" & vbNewLine & path & "\" & source)
End If 
```

正如我上面所说，它可以工作，但它只是`1`一遍又一遍地重复索引，次数与要转换的组一样多。实际上，我想要做的就是从文件中删除所有白色空白和外来字符，同时保留它的结构。

我不确定我在这里做错了什么。有谁能帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T03:17:27.350

看起来您在第一次替换时正在清除格式，因此它永远不会写入下一条记录。

你设置你的字符串是这样的：

```
Dim l_pnum As String = "[PARTICLE{0}]" 
Dim l_index As String = "INDEX = {1}" 
Dim l_absaxis As String = "ABSAXIS=0" 
Dim l_particle As String = "{2}" 
```

然后，当您编写第一条记录时，您会用结果替换您的主记录，这意味着您不再具有写出下一条记录的格式。

```
l_pnum = l_pnum.Replace("{0}", loop_num.ToString)  
l_index = l_index.Replace("{1}", loop_num.ToString)  
l_particle = l_particle.Replace("{2}", line_read) 
```

要么创建临时变量来保存您的结果，要么使用结果而不将其分配给您的初始字符串。

IE

```
objWriter.WriteLine(l_pnum.Replace("{0}", loop_num.ToString))      
objWriter.WriteLine(l_index.Replace("{1}", loop_num.ToString))      
objWriter.WriteLine(l_absaxis)      
objWriter.WriteLine(l_particle.Replace("{2}", line_read)) 
```

# c# - Ninject.MVC 构造函数注入，其中注入对象的构造函数接受一个参数

> ID：12451368
> 
> 赞同：2
> 
> 时间：2012-09-16T22:45:13.943
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, dependency-injection, ninject

嗨，我正在将 Ninject.MVC Nuget 包与我的 MVC3 应用程序一起使用，并且我为某些构造函数注入设置了当前绑定。

```
 private static void RegisterServices(IKernel kernel)
    {
        kernel.Bind<IUnitOfWork>().To<ERSUnitOfWork>();
        kernel.Bind<IRepository<Recipe>>().To<GenericRepository<Recipe>>();
    } 
```

我的控制器示例如下：

```
public class RecipesController : Controller
{
    private readonly IUnitOfWork unitOfWork;
    private readonly ERSDbContext context;
    private readonly IRepository<Recipe> recipeRepository;

    public RecipesController(IUnitOfWork unitOfWork, IRepository<Recipe> recipeRepository)
    {
        this.context = new ERSDbContext();
        this.unitOfWork = unitOfWork;
        this.recipeRepository = recipeRepository;
    }
} 
```

我想从控制器中删除私有 DBContext 属性并将新的 ERSDbContext() 传递给 ERSUnitOfWork 的构造函数和 GenericRepository 作为 Ninject 正在执行的构造函数注入的一部分，但最好将 ERSDbContext 类的初始化保留在控制器内？

任何有关您如何执行此操作的帮助将不胜感激。谢谢

我有点希望它不需要我的 NinjectWebCommon 类必须创建 DbContext，我希望在控制器中对其进行初始化。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T23:07:46.687

这是您如何抽象依赖关系的问题。

因为您想控制创建[`DbContext`](http://msdn.microsoft.com/en-us/library/system.data.entity.dbcontext%28v=vs.103%29.aspx)实例的时间，所以您应该有一个工厂来创建特定类型的`DbContext`实例，如下所示：

```
public interface IDbContextFactory
{
     T CreateDbContext<T>() where T : DbContext;
} 
```

[（注意，如果您的 DI 框架很好地处理了泛型接口上的类型参数，那么您可以使用 Entity Framework 5 引入的[`IDbContextFactory`接口](http://msdn.microsoft.com/en-us/library/hh506876.aspx)）]

如果您只需要`DbContext`使用默认的无参数构造函数创建类型化实例，您可以像这样定义您的接口：

```
public interface IDbContextFactory
{
     T CreateDbContext<T>() where T : DbContext, new();
} 
```

然后像这样定义一个实现：

```
public class DbContextFactory : IDbContextFactory
{

    #region Implementation of IDbContextFactory

    public T CreateDbContext<T>() where T : DbContext, new()
    {
        // Create a new instance of T and return.
        return new T();
    }

    #endregion
} 
```

如果您需要调用不同的构造函数，那么您将删除[`new()`约束](http://msdn.microsoft.com/en-us/library/sd2w2ew5.aspx)并且必须使用反射调用（或者，您可以创建一个 lambda 表达式并根据 的类型对其进行缓存`T`）来创建 typed `DbContext`。

从那里您将`IDbContextFactory`合同与您的实现相关联并将`IDbContextFactory`实现注入您的类，就像您对任何其他接口一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T23:31:13.237

这是依赖注入的好处之一，它会自动解析所有构造函数参数及其依赖的构造函数参数。它为您完成所有这些，只需要定义对象的映射。

所以在你的情况下，你只需这样做：

```
kerel.Bind<ERSDbContext>().ToSelf(); 
```

然后你可以将 ERSDbContext 添加到你的 UoW 和 Repo 中，你就很好了。

如果你想对事物进行单元测试，那么你需要以某种方式抽象你的上下文，无论是 casperOne 提到的还是我提到的（你让你的 DbContext 派生自一个通用接口），然后改为这样做：

```
kernel.Bind<IDbContext>().To<ERSDbContext>(); 
```

使用 DI 的好处之一是它可以控制对象的生命周期。如果将 DbContext 的构建推迟到 DI 容器之外，则必须手动管理其生命周期，而不是允许 DI 容器根据生命周期策略来管理它（例如在请求结束时自动销毁它）。

我认为延迟创建上下文没有可衡量的好处。我认为你正在做过早的优化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T14:48:08.707

由于我的并发问题，我暂时取消了工厂的使用，我正在使用这种方法，因为我的时间很短。

```
kernel.Bind<ERSDbContext>().ToSelf().InRequestScope(); 
```

然后在我的 UoW 和 GenericRepository 中，构造函数需要一个 ERSDbContext 类型参数。

我想稍后改进这种方法，但现在这可行。

# extjs - extjs 检索实例化对象的配置信息？

> ID：12451376
> 
> 赞同：1
> 
> 时间：2012-09-16T22:49:42.307
> 
> 标签：extjs

我需要为例如选项卡栏上的选项卡构建一个 PropertyManager.... tab1.config; 和tab1.configMap；在运行时是空对象。我也试过 Ext.TabPanel.configMap; 和 Ext.TabPanel.config；以未定义的形式返回。有没有办法获取这些信息？Architect 执行完全相同的操作来显示其 PropertyManager 以设置属性。蒂亚。

...我在想，也许解决方案是使用配置创建每个对象：所有要检查的属性，以便可以访问它们。

# java - 将数组的内容传递给另一个数组java

> ID：12451377
> 
> 赞同：0
> 
> 时间：2012-09-16T22:49:55.850
> 
> 标签：java, arrays, class

我必须创建一个获取数组内容并将其添加到另一个数组的方法。所以我有一个方法 addTune(Tune t) 可以将曲调添加到数组中。我有一组对象 Tunes（类库）。

库的构造函数

```
Library (int size)
{
    array = new Tune[size];
    count
}

public void addTune(tune b)
{
    //check if program can add new tune

    if(count < array.length)
    {
        array[count] = b;
        count++;

    }
    else
    {
        System.out.println("The Library is full!");
    }

} 
```

我也尝试创建 addLibrary 函数，但无法使其工作。addLibrary(Library l) 采用 Library 参数。这是我写的

```
public void addLibrary (Library l)
{
    for (int i=0; i< l.array.length;i++)
    {
        array.addTune(l.array[i]); 
    }
} 
```

这应该将一个数组的对象添加到另一个数组，所以如果我有一个带有 2 个曲调的库对象 lib 和另一个更大尺寸的库对象 lib2，lib2.addLibrary(lib1) 应该将书籍从 lib1 添加到 lib2。请帮我解决一下这个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T22:56:49.497

假设`addLibrary`在您的 Library 类中，并且旨在将整个 Library 添加到现有数组中，您可能的意思是：

```
public void addLibrary (Library l) {
    for (int i=0; i< l.array.length; i++) {
        addTune(l.array[i]); //just call the addTune method
    }
} 
```

`array.addTune(...)`不能工作，因为数组没有`addTune`方法。

甚至更好：

```
public void addLibrary (Library l) {
    for (Tune t : l.array) {
        addTune(t); //just call the addTune method
    }
} 
```

# php - 将值从 jQuery AJAX 传递到 PHP

> ID：12451378
> 
> 赞同：0
> 
> 时间：2012-09-16T22:50:00.687
> 
> 标签：php, javascript, jquery, ajax

假设我有这个脚本，例如：

```
<script type="text/javascript">
    function getdata() {
        var referenceNumber = $("#reference_number").val();

        $.ajax({
            url: 'getlistofsomething.php',
            type: 'POST',
            dataType: 'json',
            data: 'referenceNumber=' + referenceNumber,
            success: function (output_string) {
                $("#name").val(output_string[0]);
                $("#address").val(output_string[1]);
            }
        });
    }
</script> 
```

有没有办法可以将值传递`$("#address").val(output_string[1]);`到上面这个脚本所在的 PHP 文件中？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T23:31:11.903

最简单的方法是使用`GET`. 只有在数据不是很敏感的情况下才这样做......

```
<script type="text/javascript">
function getdata()
    {
        var referenceNumber = $("#reference_number").val();
        $.ajax({
            url: 'getlistofsomething.php?address=' + $("#address").val(output_string[1]),
            type: 'POST',
            dataType: 'json',
            data: 'referenceNumber='+referenceNumber,
            success: function(output_string)
                {                               
                    $("#name").val(output_string[0]);
                    $("#address").val(output_string[1]);
                }
        });
    }
</script> 
```

然后可以在您的 php 脚本中使用以下命令访问它：

```
$address = $_GET['address']; 
```

# android - 时区偏移格式 +HH:mm 与 +HHmm

> ID：12451380
> 
> 赞同：2
> 
> 时间：2012-09-16T22:50:26.487
> 
> 标签：android, android-date

我需要与一个没有实现完整 ISO 8601 的应用程序进行通信，并且只接受 +HH:mm 格式的时区偏移。

Android 似乎只生成格式 +HHmm（小时和分钟之间没有 ':' 字符）和 SampleDateFormat 中的 'z'。

代码示例：

```
SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZ");
String str = String.format(Locale.US, "%s", sdf.format(new Date(0))); 
```

生成：1970-01-01T00:00+0000

我想生成：1970-01-01T00:00+00:00

是否有任何简单的方法可以在不编写代码来操作字符串的情况下产生所需的输出？

谢谢，路易斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:19:32.643

我认为最简单的方法是操作字符串。

a) SimpleDateFormat 不支持您需要的内容。

b) SimpleDateFormat 类中的 appendNumericTimeZone 方法是私有的。所以，你不能覆盖它。

2）您可以创建自己的格式化程序（实现 java.text.DataFormat）。但是，这将比字符串操作更麻烦。

顺便提一句。我在查看 SimpleDateFormat 源代码时发现的有趣的东西。有一些代码几乎可以生成您需要的内容（它添加到末尾“GMT+XX:XX”）。但是，仅当您在格式中指定“Z”并且系统找不到当前时区的时区名称时，才会调用此代码。

# xml - Oracle XML 选择结果到表中

> ID：12451381
> 
> 赞同：1
> 
> 时间：2012-09-16T22:50:27.593
> 
> 标签：xml, oracle11g, xquery

如果我有一个 XML 列，其中元素具有以下结构

> ```
> > <library>
> >     <bookshelf>
> >         <book>
> >         <book>
> >           ...
> >         <book>
> >     </bookshelf> </library> 
> ```

如何检索所有信息并将其放入一个表中，其中的列看起来像这个 LIBRARY BOOKSHELF BOOK？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T17:28:20.683

[这个](https://stackoverflow.com/questions/4715696/parse-xml-string-stored-on-oracle-table)问题可能会帮助您明智地提取每一列并插入。

# javascript - 如何在 JavaScript 中检测 Mac OS X 版本

> ID：12451382
> 
> 赞同：5
> 
> 时间：2012-09-16T22:50:52.093
> 
> 标签：javascript, macos, browser, operating-system, detect

我在互联网上到处搜索如何检测操作系统及其版本。我已经找到了如何在 Windows 上执行此操作（请参见下面的代码），现在我希望它也适用于 Mac。

Windows 检测代码（完美运行！）：

```
// OS detection
var _os_ = (function(){
var userAgent = navigator.userAgent.toLowerCase();
return {
    isWin2K: /windows nt 5.0/.test(userAgent),
    isXP: /windows nt 5.1/.test(userAgent),
    isVista: /windows nt 6.0/.test(userAgent),
    isWin7: /windows nt 6.1/.test(userAgent),
};
}());

// get OS shorthand names

var OS;
if(_os_.isWin2K){
OS = "Windows 2000";
}

if(_os_.isXP){
OS = "Windows XP";
}

if(_os_.isVista){
OS = "Windows Vista";
}

if(_os_.isWin7){
OS = "Windows 7";
}

alert(OS); 
```

所以我想知道是否有可能为 Mac OS X 做同样的事情。比如，

```
 ...
 return {
     isMac10.5: /mac osx 10.5/.test(userAgent),
     isMac10.6: /mac osx 10.6/.test(userAgent),
     isMac10.7: /mac osx 10.7/.test(userAgent),
     isMac10.8: /mac osx 10.8/.test(userAgent),
 };

 ....
 if(_os_.isMac10.5){
 OS = "Mac OS X Leopard";
 }

 etc., etc... 
```

有任何想法吗？任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-16T23:04:11.040

```
return {
     isMac105: /Mac OS X 10_5/.test(userAgent),
     isMac106: /Mac OS X 10_6/.test(userAgent),
     isMac107: /Mac OS X 10_7/.test(userAgent),
     isMac108: /Mac OS X 10_8/.test(userAgent),
 }; 
```

mac的用户代理，例如

`Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_1) AppleWebKit/536.25 (KHTML, like Gecko) Version/6.0 Safari/536.25`

`Macintosh; U; Intel Mac OS X 10_5_8; ru) AppleWebKit/533.18.1 (KHTML, like Gecko) Version/5.0.2 Safari/533.18.5`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-28T15:33:19.903

是的，这是因为在 Firefox 上 OSX 版本没有列为 10_6 而是 10.6 所以你必须添加特定的行：isMac106: /Mac OS X 10.6/.test(userAgent)

注意10到6之间的点

# iphone - setFetchBatchSize 有什么作用？

> ID：12451384
> 
> 赞同：0
> 
> 时间：2012-09-16T22:50:56.800
> 
> 标签：iphone, objective-c, ios, core-data, nsfetchrequest

如果我设置了这个，我的请求会返回我请求的更多结果，但其中大多数是错误的。如果我试图访问一个有故障的会发生什么？会不会让另一个人犯错？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T01:10:27.047

setFetchBatchSize 方法设置一次要获取的对象数量。无论如何，您必须检查每个 NSManagedObject 的“isFault”属性。“故障”项目在此时/请求中只是未使用的项目。

# ruby - 如何切换指南针版本？

> ID：12451387
> 
> 赞同：1
> 
> 时间：2012-09-16T22:51:28.923
> 
> 标签：ruby, gem, sass, compass-sass

我有两个版本的 Compass，0.12 和 0.13.alpha。默认版本是 0.13.alpha 但有时我需要切换到 0.12。

请问什么命令允许这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-24T02:56:45.467

老话题，但我刚刚遇到了有 2 个项目的问题。一个使用指南针版本`0.12`，另一个使用`1.0`.

由于较新版本的 compass 依赖于新的主要版本 sass，因此在尝试在旧项目上运行较新的 compass 时会遇到许多弃用警告和兼容性问题。

* * *

好吧，现在解决方案：

ruby gems 已经支持安装多个版本。在查看`compass`可执行文件后，发现有一种方法可以指定要使用的指南针版本（该文件由 ruby​​gems 生成，如果您好奇，请参阅[http://pastebin.com/HeZnE0T5 ）](http://pastebin.com/HeZnE0T5)

有了它，我们现在可以一次安装多个版本的指南针。例如：

```
gem install compass -pre // currently version 1.0.0.alpha.19
gem install compass // currently version 0.12.6 
```

现在我们可以通过指定要使用的版本来使用它们：

```
$ compass version
Compass 1.0.0.alpha.19
Copyright (c) 2008-2014 Chris Eppstein
Released under the MIT License.
Compass is charityware.
Please make a tax deductable donation for a worthy cause: http://umdf.org/compass

$ compass _0.12.6_ version
Compass 0.12.6 (Alnilam)
Copyright (c) 2008-2014 Chris Eppstein
Released under the MIT License.
Compass is charityware.
Please make a tax deductable donation for a worthy cause: http://umdf.org/compass 
```

这显然也适用于其他指南针命令，例如`watch`：

```
$ compass _0.12.6_ watch .
>>> Compass is watching for changes. Press Ctrl-C to Stop. 
```

编辑：当然版本切换可以在 Gemfile 中完成，但在我的情况下，它不是 ruby​​ 项目，指南针是通过命令行启动的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T08:08:30.683

如果您要为不同的项目切换版本，我建议使用[RVM](http://rvm.io/rvm/install/) (Ruby) 或[virtualenv](http://www.virtualenv.org/en/latest/index.html)以及[一些帮助](https://gist.github.com/1078601)(Python) 或类似的东西来管理 gems 和版本。[Bundler](http://gembundler.com/)将有助于使任一解决方案更易于维护。

如果您在项目中切换版本，我建议您重新考虑您的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-24T22:38:25.407

使用捆绑器非常简单。

安装捆绑器：

```
$ gem install bundler 
```

如果您还没有 Gemfile，请在您的项目中创建：

```
$ bundle init 
```

在 Gemfile 中指定您想要/需要的版本：

```
gem 'compass', '~>0.12.2'
gem 'sass', '3.2.8' 
```

安装您在 Gemfile 中定义的特定 gem 和依赖项：

```
$ bundle install 
```

执行 gem 时，您现在可以使用 bundler 根据您的 Gemfile 控制要执行的版本：

```
$ bundle exec compass watch 
```

而已！

在您的 Gemfile 中留下评论告诉其他开发人员如何使用 bundler 会很有帮助：

```
# Now that you're using Bundler, you need to run `bundle exec compass watch` instead of simply `compass watch`. 
```

[在http://bundler.io/v1.6/gemfile.html](http://bundler.io/v1.6/gemfile.html)阅读有关版本控制的更多信息

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-17T01:19:12.683

更改 gemfile，添加版本参数。

# django - 在 Django Admin 中“实时”过滤选择字段

> ID：12451388
> 
> 赞同：1
> 
> 时间：2012-09-16T22:51:44.113
> 
> 标签：django, django-admin

我在选择字段中过滤值时遇到了一些问题。

这是我的应用程序模型：

```
from django.db import models

class Role(models.Model):
    name = models.CharField(max_length=20, blank=False)

    def __unicode__(self):
        return self.name

class Rank(models.Model):
    name = models.CharField(max_length=20, blank=False)
    role = models.ForeignKey(Role, blank=False)

    def __unicode__(self):
        return self.name

class Member(models.Model):

    name = models.CharField(max_length=100, blank=False)
    rank = models.ForeignKey(Rank, verbose_name = 'Member Rank')
    mainrole = models.ForeignKey(Role, related_name = 'main_role', blank=False)
    secondaryrole = models.ForeignKey(Role, related_name = 'secondary_role', blank=False)
    picture = models.ImageField(
        null=True,
        blank=False,
        upload_to='member/pictures/',
        )

    def __unicode__(self):
        return self.name 
```

只是为了澄清。一个会员可以有一个`Rank`，从那个`Rank`，最多可以有两个不同的`Roles`。但是，`Ranks`可以有 'n' 个类型的`Roles`.

我遇到的两个问题：

1.  在管理员中，`Rank`的名称出现在选择字段中的次数与`Roles`附加到它的次数一样多。有没有办法让我摆脱重复的名字，只留下一个记录？*这可能与我对课程的建模方式有关，我对 Django 有点陌生。*

2.  如果我选择 a `Rank`，我需要在用户点击保存（ajax-esque）之前`Roles`过滤他两个的选择字段以`Roles`获取可用的。`Rank`有没有办法做到这一点？如何？

感谢您的时间。

使用我的模型管理员的代码进行编辑：

```
class MemberInlineFormset(BaseInlineFormSet):
    def add_fields(self, form, index):
        super(MemberInlineFormset, self).add_fields(form, index)
        roles = Role.objects.none()
        if form.instance:
            try:        
                rank = form.instance.rank
            except Rank.DoesNotExist:
                pass   
            else:  
                roles= Role.objects.filter(role__within=Rank.role)
        form.fields['mainrole'].queryset = roles
        form.fields['secondaryrole'].queryset = roles

class MemberInline(admin.TabularInline):
    model = Member
    formset = MemberInlineFormset 
```

# grails - Heroku Grails buildpack：“指定的最小和最大堆大小不兼容”

> ID：12451393
> 
> 赞同：1
> 
> 时间：2012-09-16T22:53:01.450
> 
> 标签：grails, heroku

我在尝试将 Grails 应用程序推送到 Heroku 时遇到“指定的最小和最大堆大小不兼容”编译器错误。我不知道如何在编译期间启用更详细的日志记录，但我很乐意提供更多信息。

```
506 ita-signup $ git push heroku master
Counting objects: 31, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (19/19), done.
Writing objects: 100% (21/21), 2.74 KiB, done.
Total 21 (delta 11), reused 0 (delta 0)
-----> Heroku receiving push
-----> Removing .DS_Store files
-----> Grails app detected
-----> Grails 2.0.4 app detected
WARNING: The Grails buildpack is currently in Beta.
-----> Executing grails -Divy.default.ivy.user.dir=/app/tmp/repo.git/.cache compile --non-interactive
Error occurred during initialization of VM
Incompatible minimum and maximum heap sizes specified
! Failed to build app
! Heroku push rejected, failed to compile Grails app
To git@heroku.com:XXX-3359.git
! [remote rejected] master -> master (pre-receive hook declined)
error: failed to push some refs to 'git@heroku.com:XXX-3359.git' 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-20T12:39:21.593

答：我已经设置了[user-env-compile](https://devcenter.heroku.com/articles/labs-user-env-compile)功能。使用它来强制有效的堆设置有效：

```
$ heroku config:set JAVA_OPTS='-Xms384m -Xmx384m -Xss512k -XX:+UseCompressedOops'
$ git push heroku master
...
(success) 
```

# javascript - 如何以编程方式将 JS 和 CSS 资源添加到

> ID：12451397
> 
> 赞同：8
> 
> 时间：2012-09-16T22:54:04.800
> 
> 标签：javascript, css, jsf, head

我需要以编程方式将 JavaScript 和 CSS 资源添加到`<h:head>`JSF 页面。目前尚不清楚如何实现这一目标。我该怎么做或者有一个启动示例？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-17T00:12:16.883

这取决于您要在哪里声明资源。*通常*，以编程方式声明它们的唯一原因是您有自定义[`UIComponent`](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIComponent.html)或[`Renderer`](http://docs.oracle.com/javaee/6/api/javax/faces/render/Renderer.html)生成 HTML 代码，而这些代码又需要这些 JS 和/或 CSS 资源。然后它们将由[`@ResourceDependency`](http://docs.oracle.com/javaee/6/api/javax/faces/application/ResourceDependency.html)or声明[`@ResourceDependencies`](http://docs.oracle.com/javaee/6/api/javax/faces/application/ResourceDependencies.html)。

```
@ResourceDependency(library="mylibrary", name="foo.css")
public class FooComponentWithCSS extends UIComponentBase {
    // ...
} 
```

```
@ResourceDependencies({
    @ResourceDependency(library="mylibrary", name="bar.css"),
    @ResourceDependency(library="mylibrary", name="bar.js")
})
public class BarComponentWithCSSandJS extends UIComponentBase {
    // ...
} 
```

但是，如果您*确实*需要在其他地方声明它们，例如在渲染响应*之前*调用的支持 bean 方法中（否则为时已​​晚），那么您可以通过[`UIViewRoot#addComponentResource()`](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIViewRoot.html#addComponentResource%28javax.faces.context.FacesContext,%20javax.faces.component.UIComponent,%20java.lang.String%29). 组件资源必须创建为具有or[`UIOutput`](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIOutput.html)的渲染器类型，以分别表示完全值得的or 。和属性可以只放在属性映射中。`javax.faces.resource.Script``javax.faces.resource.Stylesheet``<h:outputScript>``<h:outputStylesheet>``library``name`

```
UIOutput css = new UIOutput();
css.setRendererType("javax.faces.resource.Stylesheet");
css.getAttributes().put("library", "mylibrary");
css.getAttributes().put("name", "bar.css");

UIOutput js = new UIOutput();
js.setRendererType("javax.faces.resource.Script");
js.getAttributes().put("library", "mylibrary");
js.getAttributes().put("name", "bar.js");

FacesContext context = FacesContext.getCurrentInstance();
context.getViewRoot().addComponentResource(context, css, "head");
context.getViewRoot().addComponentResource(context, js, "head"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T23:09:21.637

您可以像这样向页面添加脚本和样式资源：

```
var head = document.getElementsByTagName("head")[0];
var s = document.createElement("script");
s.type = "text/javascript";
s.src = "xxxx.js";
head.appendChild(s);

s = document.createElement("style");
s.type = "text/css"
s.src = "yyy.css";
head.appendChild(s); 
```

或者，以函数形式：

```
function addScript(path) {
    var head = document.getElementsByTagName("head")[0];
    var s = document.createElement("script");
    s.type = "text/javascript";
    s.src = path;
    head.appendChild(s);
}

function addCSSFile(path) {
    var head = document.getElementsByTagName("head")[0];
    var s = document.createElement("style");
    s.type = "text/css";
    s.src = path;
    head.appendChild(s);
} 
```

# c - 提高交易率的技巧

> ID：12451398
> 
> 赞同：5
> 
> 时间：2012-09-16T22:54:06.500
> 
> 标签：c, linux, performance, data-structures, g-wan

Lighttpd、nginx 等使用一系列技术来提供最大的应用程序性能，例如 AIO、sendfile、MMIO、缓存和 epoll 以及无锁数据结构。

我和我的同事编写了一个小型应用服务器，它使用了许多这些技术，也可以服务器静态文件。因此，我们使用 apache bench 对其进行了测试，并将我们的与 lighttpd 和 nginx 进行了比较，并且至少与 100 字节到 1K 文件的静态内容的性能相匹配。

但是，当我们将相同静态文件的交易率与 G-WAN 进行比较时，G-WAN 遥遥领先。

我知道这个问题可能有点主观，但是除了我提到的那些显而易见的技术之外，Pierre Gauthier 可能会在 GWAN 中使用哪些技术来使他能够实现如此惊人的性能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-19T07:35:06.830

多年来一直关注 G-WAN 服务器，我在旧的 G-WAN 论坛上阅读了（许多）关于这个问题的演讲。

据我所知，反复提到的是这个程序：

1.  架构（具体对比了 nginx、lighty 和 cherokee）
2.  实施（如何进行整体分支、请求解析和响应构建）
3.  精益公共路径（所有类型请求所遵循的路径：动态、静态、处理程序）

Pierre 经常提到其他服务器来解释他们的特定架构和实现中是*什么让*他们慢了下来。

随着时间的推移，由于 G-WAN 似乎堆叠了越来越多的功能（C# 脚本支持、反向代理和负载均衡器预计将在下一个版本中出现），因此上述 3 点似乎越来越重要。

这可能就是为什么每个新版本的 G-WAN 似乎都愿意比以前更快的原因：你做的工作越多，必须消除的额外脂肪就越多，因为它的成本越来越高。就像赛车或飞机一样，这是一个渐进的过程，一个需要更多的另一个。

如果您正在寻找 G-WAN 速度的“秘密”，那么我想这就是关键所在。但是，如果您想了解更多详细信息，那么您应该直接与 G-WAN 作者交谈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T16:39:59.170

查看 G-WAN 的时间表。2011 年 8 月 8 日的更新可能会让您了解他正在使用什么。

[G-WAN 时间线](http://gwan.ch/en_timeline.html)

Pierre 提到 G-WAN 在 G-WAN 的核心功能上大量使用了它的免等待键值存储。由于没有使用锁，因此速度更快。

他还使用 Lorenz Waterwheel 启发的技术来处理线程。我不确定它是如何工作的，但他说它允许 G-WAN 在所有可能的情况下运行得更快。

# php - 如何在 JSON 响应中呈现 ZF2 视图？

> ID：12451399
> 
> 赞同：20
> 
> 时间：2012-09-16T22:54:18.217
> 
> 标签：php, json, zend-framework2, zend-framework-mvc

到目前为止，我已经弄清楚了如何在 Zend Framework 2 中返回典型的 JSON 响应。首先，我在配置部分添加`ViewJsonStrategy`了。然后，我不是从控制器操作返回一个实例，而是返回一个设置了所有变量的实例。`strategies``view_manager``ViewModel``JsonModel`

现在我已经弄清楚了那部分，我需要了解如何呈现视图并在该 JSON 响应中返回它。在 ZF1 中，我可以使用`$this->view->render($scriptName)`，它将 HTML 作为字符串返回。在 ZF2 中，该`Zend\View\View::render(...)`方法返回`void`.

那么...如何呈现 HTML 视图脚本并在一个请求中以 JSON 响应的形式返回它？

这就是我现在所拥有的：

```
 if ($this->getRequest()->isXmlHttpRequest()) {
        $jsonModel = new JsonModel(...);

        /* @todo Render HTML script into `$html` variable, and add to `JsonModel` */
        return $jsonModel;
    } else {
        return new ViewModel(...);
    } 
```

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-09-29T08:39:26.317

好的，我想我终于明白你在做什么了。我找到了一个我认为符合您标准的解决方案。虽然我确信还有改进的空间，因为有一些令人讨厌的手工工作要做......

```
public function indexAction()
{
  if (!$this->getRequest()->isXmlHttpRequest()) {
    return array();
  }

  $htmlViewPart = new ViewModel();
  $htmlViewPart->setTerminal(true)
               ->setTemplate('module/controller/action')
               ->setVariables(array(
                  'key' => 'value'
               ));

  $htmlOutput = $this->getServiceLocator()
                     ->get('viewrenderer')
                     ->render($htmlViewPart);

  $jsonModel = new JsonModel();
  $jsonModel->setVariables(array(
    'html' => $htmlOutput,
    'jsonVar1' => 'jsonVal2',
    'jsonArray' => array(1,2,3,4,5,6)
  ));

  return $jsonModel;
} 
```

~~正如你所看到的，我创建的 templateMap 是......讨厌......这很烦人，我相信它可以改进很多。这是一个可行的解决方案，但不是一个干净的解决方案。也许有人能够以某种方式从 ServiceLocator 中获取可能已经实例化的默认 PhpRenderer，并使用它的模板和路径映射，然后它应该更干净。~~

感谢@DrBeza 的评论，需要完成的工作可以减少相当多的数量。现在，正如我最初想要的那样，我们将获取所有模板映射完整的视图渲染器，并直接渲染 ViewModel。唯一重要的因素是您需要指定要呈现的完全限定模板（例如：“$module/$controller/$action”）

我希望这能让你开始；）

PS：响应如下所示：

```
Object:
    html: "<h1>Hello World</h1>"
    jsonArray: Array[6]
    jsonVar1: "jsonVal2" 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-08-10T15:14:55.413

您可以使用更简单的方法为您的 JSON 响应呈现视图。

```
public function indexAction() {
    $partial = $this->getServiceLocator()->get('viewhelpermanager')->get('partial');
    $data = array(
            'html' => $partial('MyModule/MyPartView.phtml', array("key" => "value")),
            'jsonVar1' => 'jsonVal2',
            'jsonArray' => array(1, 2, 3, 4, 5, 6));
    $isAjax = $this->getRequest()->isXmlHttpRequest());
    return isAjax?new JsonModel($data):new ViewModel($data);
} 
```

请注意，在使用 JsonModel 类之前，您需要在模块的**module.config.php**文件中配置 View Manager。

```
'view_manager' => array(
        .................
        'strategies' => array(
            'ViewJsonStrategy',
        ),
        .................
    ), 
```

这对我有用，希望对您有所帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-02-26T21:48:06.263

在 ZF 3 中，您可以使用此代码获得相同的结果

MyControllerFactory.php

```
public function __invoke(ContainerInterface $container, $requestedName, array $options = null)
{
    $renderer = $container->get('ViewRenderer');

    return new MyController(
        $renderer
    );
} 
```

MyController.php

```
private $renderer;

public function __construct($renderer) {
    $this->renderer = $renderer;
}

public function indexAction() {

    $htmlViewPart = new ViewModel();
    $htmlViewPart
            ->setTerminal(true)
            ->setTemplate('module/controller/action')
            ->setVariables(array('key' => 'value'));

    $htmlOutput = $this->renderer->render($htmlViewPart);

    $json = \Zend\Json\Json::encode(
        array(
            'html' => $htmlOutput,
            'jsonVar1' => 'jsonVal2',
            'jsonArray' => array(1, 2, 3, 4, 5, 6)
        )
    );

    $response = $this->getResponse();
    $response->setContent($json);

    $response->getHeaders()->addHeaders(array(
        'Content-Type' => 'application/json',
    ));
    return $this->response;
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-09-26T03:56:01.650

像往常一样，框架开发人员在遵循规则为什么简单时可能会复杂时会弄乱 AJAX 这是控制器脚本中的简单解决方案

```
public function checkloginAction()
{
   // some hosts need to this some not 
   //header ("Content-type: application/json");  // this work
   // prepare json aray ....
   $arr = $array("some" => .....);
   echo json_encode($arr); // this works
   exit;
} 
```

这也适用于 ZF1 和 ZF2 根本不需要查看脚本

如果您使用 ZF2 创建者的建议

```
use Zend\View\Model\JsonModel;
....

 $result = new JsonModel($arr);
 return $result; 
```

至少在 zf 2.0.0 中，AJAX 响应为 null

# mysql - MYSQL Workbench 无法更新索引排序顺序

> ID：12451401
> 
> 赞同：1
> 
> 时间：2012-09-16T22:54:32.100
> 
> 标签：mysql, database

我试图编辑我的数据库上的索引。但是每次我申请并按下完成时，重新打开索引编辑器时结果都是一样的我是否必须设置一组特定的参数才能工作？还是 innoDb 不允许 btree 索引按降序排列？

# haskell - 如何为 Category 实例定义相等性？

> ID：12451403
> 
> 赞同：10
> 
> 时间：2012-09-16T22:54:57.477
> 
> 标签：haskell, category-theory

例如，为了证明*类别定律*适用于对数据类型的某些操作，如何决定如何定义相等？考虑以下类型来表示布尔表达式：

```
data Exp
    = ETrue
    | EFalse
    | EAnd Exp Exp
    deriving (Eq) 
```

试图证明*Exp*形成具有身份*ETrue*和运算符的类别是否可行：

```
(<&>) = EAnd 
```

没有重新定义*Eq*实例？使用*Eq*的默认实例，*左恒等式*违反了，即：

```
ETrue <&> e == e 
```

评估为*False*。但是，定义一个*eval 函数*：

```
eval ETrue =  True
eval EFalse = False
eval (EAnd e1 e2) = eval e1 && eval e2 
```

和*Eq*实例为：

```
instance Eq Exp where
    e1 == e2 = eval e1 == eval e2 
```

解决问题。*用(==)*进行比较是声称满足此类定律的一般要求，还是说这些定律适用于特定类型的相等运算符就足够了？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-19T23:51:33.417

**平等是[邪恶](http://ncatlab.org/nlab/show/evil)的。** 你很少（如果有的话）需要*结构平等*，因为它*太强大了*。你只想要一个对你正在做的事情足够*强大的**等价物。*对于范畴论尤其如此。

 *在 Haskell 中，`deriving Eq`将为您提供结构上的平等，这意味着您经常想要编写自己的`==`/实现`/=`。

一个简单的例子：将有理数定义为整数对 `data Rat = Integer :/ Integer`。如果您使用结构相等（Haskell 是什么 `deriving`），您将拥有`(1:/2) /= (2:/4)`，但作为分数 `1/2 == 2/4`。您真正关心的是您的元组*表示*的值，而不是它们的 *表示*。这意味着您需要一个比较*缩减分数的***等价**，因此您应该实现它。

 *旁注：如果使用该代码的人假设您已经定义了结构相等性测试，即`==`通过模式匹配检查来证明替换数据子组件是合理的，那么他们的代码可能会中断。如果这很重要，您可以隐藏构造函数以禁止模式匹配，或者定义自己的构造函数`class`（例如，`Equiv`使用`===`and `=/=`）来分隔两个概念。（这对于像 Agda 或 Coq 这样的定理证明者来说最为重要，在 Haskell 中，很难让实际/现实世界的代码如此错误以至于最终出现问题。）

非常愚蠢（TM）的例子：假设某人想要打印长长的巨大 `Rat`s 列表，并相信记忆 s 的字符串表示`Integer`将节省二进制到十进制的转换。有一个 s 的查找表`Rat`，这样等于 `Rat`s 永远不会被转换两次，并且有一个整数的查找表。如果 ，将通过在- / -`(a:/b) == (c:/d)`之间复制来填充缺失的整数条目以跳过转换（哎哟！）。对于 list ，被转换，然后，因为，字符串被复制到 查找条目中。最后的结果很烂。`a``c``b``d``[ 1:/1, 2:/2, 2:/4 ]``1``1:/1 == 2:/2``1``2``"1/1, 1/1, 1/4"`**

# php - 使用php填写一个在网页上。寻找更快的加载时间我添加了这个： <select>query('SELECT type FROM card_type'); $rows = $query ID：12451404 赞同：0 时间：2012-09-16T22:55:02.043 标签：php, mysql, html, select 回答 #1 赞同：2 时间：2012-09-16T23:35:04.793 这些是您的代码中影响性能的一些问题： 您不应该print为表的每一行调用。这会降低性能（如果服务器没有缓存输出），因为每次调用print时都会通过网络发送字节，这是一项代价高昂的操作，最好对一大块数据执行一次，而不是对小块数据执行多次data，这就是 Web 服务器通常会在将所有 PHP 输出发送到浏览器之前缓存它的原因。 使用 foreach 遍历数组时，应通过引用传递数组值，以避免在循环的每次迭代中复制变量。 用逗号而不是句号回显。如果使用句点，PHP 必须在输出之前连接字符串。如果您使用逗号，它只是按顺序输出它们而无需额外处理。 您应该使用 echo 而不是print(). 作为一种语言结构而非函数，echo 与 print() 相比具有轻微的性能优势。 所以这是您的代码，上面已更正了第 2、3 和 4 点，因此假设您的 Web 服务器正在缓存输出： <?php $query = $db->query('SELECT type FROM card_type'); $rows = $query->fetchAll(); foreach($rows as &$row) { echo '<option value="', $row['type'] ,'">' ,$row['type'] , '</option>'; } ?> 这是您的代码，上面已更正了第 1 点和第 2 点，因此假设您的 Web 服务器没有缓存输出： <?php $query = $db->query('SELECT type FROM card_type'); $rows = $query->fetchAll(); $out = ''; foreach($rows as &$row) { $out .= '<option value="'.$row['type'].'">'.$row['type'].'</option>'; } echo $out; ?> 回答 #2 赞同：0 时间：2013-02-16T11:31:20.717 试试这个。。 <select> <option value=""></option> <?php include 'connect/config.php'; include 'connect/opendb.php'; $query = $db->query('SELECT type FROM card_type'); $rows = $query->fetchAll(); $select_option = ''; foreach($rows as $row) { $select_option .= '<option value="'.$row['type'].'">'.$row['type'].'</option>'; } echo $select_option; unset($db); ?> </select> 回答 #3 赞同：0 时间：2012-09-16T23:00:33.437 现在，您将整个数据库表放入一个 php 数组中。如果您的表很大，这可能会导致响应延迟。 试试这个，对于你填写的部分<select>： <?php $query = $db->query('SELECT type FROM card_type'); while($row = $query->fetch_array()) { print '<option value="'.$row['type'].'">'.$row['type'].'</option>'; } ?></select>

# wordpress - FeedWordPress - 将字符串另存为自定义字段

> ID：12451415
> 
> 赞同：0
> 
> 时间：2012-09-16T22:58:06.103
> 
> 标签：wordpress

我正在使用 FeedWordPress 插件[http://wordpress.org/extend/plugins/feedwordpress/](http://wordpress.org/extend/plugins/feedwordpress/)将帖子从一个站点拉到另一个站点。

我编写了一个过滤器，在 Stack 用户的帮助下成功扫描 $content 并将图像 URL 提取到 $new_content

```
define('FWPASTOPC_AUTHOR_NAME', 'radgeek');

add_filter(
/*hook=*/ 'syndicated_item_content',
/*function=*/ 'fwp_add_source_to_content',
/*order=*/ 10,
/*arguments=*/ 2
);

function fwp_add_source_to_content ($content, $post) {
// Use SyndicatedPost::author() to get author
// data in a convenient array
$content = $post->content();

// Authored by someone else
if( preg_match( '/<img[^>]+src\s*=\s*["\']?([^"\' ]+)[^>]*>/', $content, $matches ) ) {
$new_content .= 'URL IS '.$matches[0].'';

return $new_content;
}
else
{
}
} 
```

我现在想做的是将此 URL 保存到自定义字段中，而不是仅仅返回它。有没有人取得过类似的成就？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T00:11:20.433

据我了解，该插件从外部 RSS 提要中获取内容并将它们创建为您网站中的帖子。

如果是这种情况，使用您的过滤器，您应该能够在`$post`变量中获取帖子 ID。

因此，您只需要[add_post_meta()](http://codex.wordpress.org/Function_Reference/add_post_meta)函数即可将自定义字段添加到特定帖子。

所以在它上面包含你的代码应该看起来像：

```
define('FWPASTOPC_AUTHOR_NAME', 'radgeek');

add_filter(
/*hook=*/ 'syndicated_item_content',
/*function=*/ 'fwp_add_source_to_content',
/*order=*/ 10,
/*arguments=*/ 2
);

function fwp_add_source_to_content ($content, $post) {
// Use SyndicatedPost::author() to get author
// data in a convenient array
$content = $post->content();

// Authored by someone else
if( preg_match( '/<img[^>]+src\s*=\s*["\']?([^"\' ]+)[^>]*>/', $content, $matches ) ) {
$new_content .= 'URL IS '.$matches[0].'';    

//Add custom field with author info to post
add_post_meta($post->ID, 'post_author', $new_content); 

return $new_content;
}
} 
```

# c# - 如何检测控件何时移动到 MonoTouch 中的视图？

> ID：12451416
> 
> 赞同：0
> 
> 时间：2012-09-16T22:58:28.507
> 
> 标签：c#, ios, xcode, uinavigationcontroller, xamarin.ios

我有 View1 和 View2。在 View1 中，我调用以下命令来访问 View2：

```
View2 pl = new View2();
this.NavigationController.PushViewController(pl, true); 
```

View2 加载正常。然后在 View2 中，我调用代码返回 View1：

```
this.NavigationController.PopViewControllerAnimated(true); 
```

如何在 View1 中检测到它现在再次成为活动视图？我似乎没有任何明显的东西可以覆盖。我将在 MonoTouch 或 XCode 范例中给出答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T00:43:06.100

我假设在您的代码中 View1 和 View2 是 UIViewController 的子类，现在是 UIView，对吗？

如果是这样，您可以覆盖 V1 上的 ViewWillAppear，这将在 View2 的消失动画开始之前被调用：

```
 public override void ViewWillAppear(bool animated) {} 
```

# ios - 寻找如何在 iOS 或 Cocoa 上使用 UIGraphicsSetPDFContextURLForRect

> ID：12451417
> 
> 赞同：5
> 
> 时间：2012-09-16T22:58:41.150
> 
> 标签：ios, cocoa, pdf, hyperlink

我正在玩 iOS 上的 PDF 操作（显示但也主要是生成）。

我希望嵌入充当“外部”链接的矩形区域（如[http://host.tld/path/file 的](http://host.tld/path/file)URL ）。

您知道我在哪里可以找到有关如何使用 UIGraphicsSetPDFContextURLForRect 函数的示例吗？我在互联网上找不到任何东西。

如果我理解得很好，唯一的要求是当前图形上下文应该是 PDF“类型”，我认为我尊重这一点，因为在上游，我调用 UIGraphicsPushContext 为什么我的 PDF 上下文作为参数（无论如何这对于 drawAtPoint 之类的方法是必需的：我也成功使用）。

我认为这并不重要，但以防万一我指定这不会发生在 view 子类的 drawRect: 中。

你毫不含糊地说我“都错了”是对的。iOS 中的图形环境非常复杂和丰富，我认为目前吸收的比例不超过 1% 或 2%。

先感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T09:09:34.047

没错，要求是当前图形上下文是 PDF 上下文。您可以推送它（UIGraphicsPushContext）以使其处于活动状态，也可以像这样创建上下文：

```
UIGraphicsBeginPDFContextToFile(path, CGRectMake(0, 0, 612, 792), nil);
UIGraphicsBeginPDFPageWithInfo(CGRectMake(0, 0, 612, 792), nil);
// ...
UIGraphicsSetPDFContextURLForRect(url, rect);
// ... 
UIGraphicsEndPDFContext(); 
```

UIGraphicsSetPDFContextURLForRect 有 2 个参数：第一个是你希望链接去的 url，第二个是当前页面上代表链接区域的矩形。例如此行将在页面左下角创建指向 url 的链接，链接的大小为 72*72 点：

```
UIGraphicsSetPDFContextURLForRect(url, CGRectMake(0, 0, 72, 72)); 
```

这个方法实际上是在 PDF 文件中创建一个链接注释。链接本身没有视觉外观，您必须知道它在那里，否则如果您将鼠标移到查看器中的 PDF 页面上，您可能会偶然发现它。因此，您通常在页面上绘制/写一些东西（例如单击此处），然后将链接区域设置在文本上方。

更新 - 工作代码片段：

```
- (void) makePdf {
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *pdfFile = [documentsDirectory stringByAppendingPathComponent:@"uigraphics.pdf"];

    UIGraphicsBeginPDFContextToFile(pdfFile, CGRectMake(0, 0, 612, 792), nil);
    UIGraphicsBeginPDFPageWithInfo(CGRectMake(0, 0, 612, 792), nil);

    NSURL* url = [NSURL URLWithString: @"http://www.ipdfdev.com/"];
    UIGraphicsSetPDFContextURLForRect(url, CGRectMake(0, 0, 50, 50));

    UIGraphicsEndPDFContext();
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T14:12:32.640

我希望这能帮到您。

```
UIGraphicsBeginPDFContextToFile( pdfFilePath, CGRectZero, nil );

CGRect windowFrame = CGRectMake( 0, 0, 596, 842 );
UIGraphicsBeginPDFPageWithInfo( windowFrame, nil );

NSURL *url = [NSURL URLWithString:@"http://www.google.com"];

CGRect textFrame = CGRectMake( 10, 10, 200, 20 );
CGRect linkFrame = textFrame;
linkFrame.origin.y = windowFrame.size.height - linkFrame.origin.y - linkFrame.size.height;
UIGraphicsSetPDFContextURLForRect( url, linkFrame );

NSDictionary *attributesDict;
NSMutableAttributedString *attString;

NSNumber *underline = [NSNumber numberWithInt:NSUnderlineStyleSingle];
attributesDict = @{NSUnderlineStyleAttributeName : underline, NSForegroundColorAttributeName : [UIColor blueColor]};
attString = [[NSMutableAttributedString alloc] initWithString:url.absoluteString attributes:attributesDict];

[attString drawInRect:textFrame];

UIGraphicsEndPDFContext(); 
```

# java - 何时为每个应用程序创建多个执行器服务 java

> ID：12451420
> 
> 赞同：9
> 
> 时间：2012-09-16T22:58:59.543
> 
> 标签：java

每次运行程序/应用程序时创建多个执行程序服务什么时候是个好主意？你为什么要这样做，而不是从头`executors.newcachedthreadpool()`开始并提交所有可调用的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-16T23:06:37.640

*   您可能需要不同的风格（比如固定线程池或预定执行程序）
*   封装：如果一个特定的类需要通过一个执行器来运行事物，那么这个类负责决定它的执行策略是有意义的，这是一个实现细节
*   专业化 - 上一点的推论：
    *   有些任务需要很多线程（通常是网络任务）
    *   而其他人只需要几个（CPU密集型任务）
    *   有些应该只使用一个（例如，如果您在本地硬盘上读/写）
*   在某些情况下，您希望将执行程序传递给对象，因为您希望调用代码控制某些任务的执行方式

最重要的是，我想不出为什么对于一个足够大的项目，您只想为整个程序使用一个线程池。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T23:05:19.253

添加执行器服务的典型用例是，当您希望服务使用不同的线程池策略或具有两种不同的池大小时。您的应用程序可能包含一类您希望提交到固定大小的大型池的可运行文件，以及您想要较小池的另一种可运行文件。

请记住，ExecutorService 有几个实现：

1.  [线程池执行器](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ThreadPoolExecutor.html)
2.  [ScheduledThreadPoolExecutor](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ScheduledThreadPoolExecutor.html)

查看 ThreadPoolExecutor 的构造函数参数，这些都是您可能想要根据您提交的任务类型调整的所有内容：

```
ThreadPoolExecutor(int corePoolSize, 
   int maximumPoolSize, 
   long keepAliveTime, 
   TimeUnit unit, 
   BlockingQueue<Runnable> workQueue) 
```

请注意，您也可以传入一个队列，因此您可以控制线程池使用的排队策略。

# java - 如何从 TextField 获取用户输入并将其转换为 Double？

> ID：12451421
> 
> 赞同：6
> 
> 时间：2012-09-16T22:59:35.717
> 
> 标签：java, windows, eclipse

我正在使用 Eclipse 构建一个计算器，但我遇到了麻烦，因为我需要用户输入 2 个值。这是我的运行类代码。

```
import display.Gui;

public class Main {

public static void main(String argsp[]) {

    Gui window = new Gui();
    double a = 0, b = 0, c = 0;
    String operator;
    boolean calculate = true;

    window.setVisible(true);
    window.setSize(500, 400);
    window.setResizable(false);
    window.setLocationRelativeTo(null);

    while (calculate) {
        window.textArea_1.append("Enter an equation.\n");
        a = Double.parseDouble(window.textField.getText());
        operator = window.textField.getText();
        b = Double.parseDouble(window.textField.getText());

        if (operator.contains("+"))
            c = a + b;

        if (operator.contains("-"))
            c = a - b;

        if (operator.contains("*"))
            c = a * b;

        if (operator.contains("/"))
            c = a / b;

        if (operator.contains("x^2"))
            c = a * a;

        if (operator.contains("sqrt"))
            c = Math.sqrt(a);

        if (operator.contains("%"))
            c = a / 100;

        window.textArea.append("" + c + "\n");
        window.textArea.append("");
        window.textArea.append("Would you like to make another calculation? [Yes/No]\n");

        String calculation = window.textField.getText();

        try {
        if (calculation.equalsIgnoreCase("Yes"))
            calculate = true;

        if (calculation.equalsIgnoreCase("No"))
            calculate = false;
        } catch (Exception e) {
            window.textArea_1.append("Please enter yes or no");
        }

    }
}

} 
```

这是我的 JFrame 课程：

```
import java.awt.Dimension;
import java.awt.EventQueue;

import javax.swing.JFrame;
import java.awt.BorderLayout;
import javax.swing.JTextField;
import javax.swing.JTextArea;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;

public class Gui extends JFrame {

public JTextArea textArea, textArea_1;
public JTextField textField;

/**
 * Launch the application.
 */
public static void main(String[] args) {
    EventQueue.invokeLater(new Runnable() {
        public void run() {
            try {
                Gui frame = new Gui();
                frame.setVisible(false);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    });
}

/**
 * Create the frame.
 */
public Gui() {
    setBounds(100, 100, 450, 300);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    getContentPane().setLayout(new BorderLayout(0, 0));

    textField = new JTextField();
    textField.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent Ev) {
            textArea.append(textField.getText() + "\n");
            textField.setText("");
        }
    });
    textField.requestFocus();
    getContentPane().add(textField, BorderLayout.SOUTH);
    textField.setColumns(10);

    textArea = new JTextArea();
    textArea.setEditable(false);
    textArea.setPreferredSize(new Dimension(215, 200));
    getContentPane().add(textArea, BorderLayout.WEST);

    textArea_1 = new JTextArea();
    textArea_1.setEditable(false);
    textArea_1.setPreferredSize(new Dimension(215, 200));
    getContentPane().add(textArea_1, BorderLayout.EAST);

} 
```

我尝试使用`Double.parseDouble(window.textField.getText());`

但这没有用。我怎样才能让它工作？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T02:12:15.113

首先，我认为您的程序设计存在一些问题。为什么不使用事件（按钮点击、按键等）来触发计算？我没有看到这个程序中 while 循环的好处。

此外，正如一些人已经指出的那样，您的代码甚至在用户输入之前就从文本字段读取和解析值。那肯定会产生无效的结果。

尝试类似（未测试）：

```
calcButton = new JButton("Calculate");
calcButton.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent Ev) {
        actionCalc();
    }
});

public void actionCalc(){
    // get the string
    // validate string (check for empty string etc)
    // parse to Double
    Double val = Double.parseDouble(window.textField.getText());
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T03:17:53.863

您正在从 TextField 请求文本，而没有实际检查文本是否存在。如果您想以这种方式循环，您必须首先查看是否输入了文本，然后将输入分配给双精度。不过，我会推荐一种不同的策略。

在我看来，您在这里使用循环的逻辑并不是最好的。如果您必须从 TextField 中读取两个数字，我实际上会添加一个 KeyListener 并等待输入键。就像是

**伪代码**

```
...
// global vals
double a = Null;
double b = Null;
public void keyPressed(KeyEvent e) {
    if (e.getKeyCode() == KeyEvent.VK_ENTER) {
        if (!window.textField.getText().equals("")) {
            // check if input is a legal double value
            // notify user that you recieved the first number
            // and request the next input.
            // once both inputs have been entered do your calculation and 
            // output the result. The program will continue to respond to key triggers.
        }
    }
} 
```

**有用的网址**

以下是有关 KeyListeners 的更多信息：http: [//docs.oracle.com/javase/tutorial/uiswing/events/keylistener.html](http://docs.oracle.com/javase/tutorial/uiswing/events/keylistener.html)

这是关于 TextField 的链接以及如何使用它们： [http ://docs.oracle.com/javase/tutorial/uiswing/components/textfield.html](http://docs.oracle.com/javase/tutorial/uiswing/components/textfield.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-13T12:37:00.943

这是你可以做到的：

```
double value=Double.parseDouble(jtextfield-name.getText()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-15T06:11:46.920

您可以直接使用：

```
Double.valueOf("Pass your string here"); 
```

它是一个静态方法，它返回参数中给出的任何值的双精度值。

# c++ - 关于班级构成

> ID：12451422
> 
> 赞同：0
> 
> 时间：2012-09-16T22:59:51.003
> 
> 标签：c++, oop

我正在制作一个用于控制网络数据包的小系统。我有以下课程：

*   数据包（具有检索和设置数据的功能）
*   AuthPackets（继承数据包类）
*   AuthSend（AuthPackets 的发送函数）
*   AuthRecv（AuthPackets 的接收函数）

因此，据我了解，AuthSend 和 AuthRecv 是 AuthPackets 的组合，但它们都需要 Packets 类的功能。

所以代码看起来像这样：

```
class Stream {
private:
    int position;
    void* packet;
    void* get_streampointer();
    public:
        void Skip(int bytes);
        void NewPos(int pos);

        void SetShort(short Data);
        void SetInt(int Data);
        void SetStringRef(StringRef* stringref);

        short GetShort();
        int   GetInt();
        void GetStringRef(StringRef* storedata);
};

class Packets : public Stream {
public:
    void PacketEncrypt();
    void PacketDecrypt();
    short Size;
    short Type;
};

class AuthPackets: public Packets {
    AuthSend send;
    AuthRecv recv;
    bool Protocol(Player* player);
};

class AuthSend: public Packets {
public:
    void SecureToken(short SecurCode);
    void EncSecureToken(short SecurCode);
};

class AuthRecv: public Packets {
public:
    bool SecurCode(Player* player);
}; 
```

问题是，如果 AuthSend 和 AuthRecv 是 AuthPackets 类的一部分，为什么它们必须继承 Packets？（已经继承了数据包）。

此外，如果我从 AuthSend 和 AuthRecv 继承 AuthPackets，我将失去调用函数的糖语法，如下所示：

```
authpackets.send.SecureToken 
```

所以主要问题是为什么我的设计有缺陷？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T23:39:42.580

好吧，我将尝试在这里解决（我相信是）您的问题；如果您使用公共的任何东西，它们确实需要从数据包继承：在 AuthSend 和 AuthRecv 的数据包中。它们不是 AuthPackets 的一部分，它们只是 AuthPackets 中的对象。无论如何，您不会影响您的 AuthSend 和 AuthRecv 定义，并在另一个具有公共：数据包的类中声明一个对象。如果您想使用 Packets 中公开的内容，我不明白这里的一切对我来说都很好时，您的意思是“设计上的缺陷”。如果我错过了，请在此处提供有关您的问题的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T23:09:03.973

AuthSend 和 AuthRecv 应该继承自一个可能称为 Packet 的抽象基类（注意：单数）。为什么您的 AuthPackets 类包含每种类型的成员，而不仅仅是通用功能？如果您需要一个类来保留身份验证数据包本身，它不应该从 Packet 继承。

要获得完整的答案，需要更多关于您尝试做什么的信息。

# mysql - 在本地化 WAMP 上使用 mysql 控制台导入表

> ID：12451424
> 
> 赞同：0
> 
> 时间：2012-09-16T22:59:58.100
> 
> 标签：mysql, import, console

这是我在 MySQL 控制台（WAMP）中使用的（没有密码，因为它是本地的）

```
mysql> mysql -u root -p dbase < table.sql

```

或这个

```
mysql> mysql -u root -p dbase < C:\path\to\table.sql

```

这就是我得到的：

```
ERROR 1064 (42000)：您的 SQL 语法有错误；检查手册
对应于您的 MySQL 服务器版本，以便在 'mysql 附近使用正确的语法
 -u root -p dbase < table.sql' 在第 1 行

```

什么可能导致这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:08:48.870

您正在使用的命令旨在在 mysql shell 之外运行。如果您刚刚`exit`退出 mysql shell 并输入相同的命令，它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T01:56:42.923

好的 - 一步一步来 - 因为，如果有人不习惯，任何疏忽都可能让那个“某人”迷失。

* * *

**远程 nix 服务器**：

1.  使用例如 Putty 连接到 mysql cli（命令行界面） - 输入：mysql -u user -pyourpassword

2.  现在您已连接到 MySQL 服务器，您可以使用例如 LOAD INFILE 命令等。

3.  “exit”让你回到“-bash”，这样你就可以使用，例如数据库导入 - 只需输入：mysql -u root -p hmvc < table.sql

* * *

**本地 WAMP -（设置：WAMP2.2 - Apache2.2.21 - MySQL5.5.20）**

**案例一**：使用 Windows“命令提示符”

1.  将目录更改为您的 mysql 位于 WAMP 根目录中的目录，例如：C:\wamp\bin\mysql\mysql5.5.20\bin

2.  连接到mysql cli：mysql -u user -pyourpassword

3.  现在你进去了，所以你可以使用例如 LOAD INFILE 命令等。

4.  "exit" 让你回到 "C:\wamp\bin\mysql\mysql5.5.20\bin>" 这样你就可以使用，例如数据库导入：mysql -u root -p hmvc < table.sql 等。

**案例2**：直接使用mysql cli

WAMP 在其托盘图标命令集合中提供了指向它的链接

链接被称为：MySQL 控制台

它通过调用 C:\wamp\bin\mysql\mysql5.5.20\bin\mysql.exe 直接调用 mysql 服务器

1.  您可以立即使用所有 MySQL 命令，例如 LOAD INFILE

2.  如果您尝试退出，则无法使用此控制台导入/转储数据库，MySQL 控制台将执行此操作 - 它将退出（窗口关闭）

我希望它会给你一些时间。

# php - PHP显示目录文件夹

> ID：12451429
> 
> 赞同：0
> 
> 时间：2012-09-16T23:00:41.707
> 
> 标签：php

我试图显示特定目录中的所有文件夹。基本上，每次添加新文件夹时，它都会自动显示在列表中。这是我到目前为止所拥有的。我从其他帖子中拼凑了这个，似乎没有工作，不知道为什么。我收到一个关于权限的严重错误，但没有找到。

```
 $dir = '/s/';
        $result = array();

        if (is_dir($dir)) {
                $iterator = new RecursiveDirectoryIterator($dir);
                foreach (new RecursiveIteratorIterator($iterator, RecursiveIteratorIterator::CHILD_FIRST) as $file) {                    
                    if (!$file->isFile()) {
                        $result[] = 'path: ' . $file->getPath(). ',  filename: ' . $file->getFilename();
                    }
                }

        }

        print_r($result); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T23:35:38.557

您可以使用该自制代码：

```
function collect_files($dir)
{
if (is_dir($dir)) {
    if ($dh = opendir($dir)) {
        $dir = $dir.'/';
        while (($file = readdir($dh)) !== false) {
        if(filetype($dir . $file)=='file'){
            $path = strchr($dir,'/');            
            echo "$file - $path<br>\n";
            }
        }
        rewinddir($dh);
        while (($file = readdir($dh)) !== false) {
        if(filetype($dir . $file)=='dir')
            if($file!='.'&&$file!='..'){
            collect_files($dir.$file);
            }
        }
        closedir($dh);
    }
}
}
collect_files('.'); 
```

# java - Javax：尝试找到在 jar 中打开 AVI 的解决方案

> ID：12451430
> 
> 赞同：2
> 
> 时间：2012-09-16T23:00:56.620
> 
> 标签：java, jar, embedded-resource, jmf

我试图在可执行 jar 文件中打开 AVI，我发现的唯一解决方案是使用 FileOutputStream 并在临时文件中制作副本：

```
InputStream inputStream = getClass().getResourceAsStream(filePathInJar);
int read = 0;
byte[] bytes = new byte[1024];
this.file = new File("c:\\tmpfile.avi");
OutputStream out = new FileOutputStream(file);
while ((read = inputStream.read(bytes)) != -1) {
    out.write(bytes, 0, read);
}
inputStream.close();
out.flush();
out.close(); 
```

然后我可以制作：

```
mediaPlayer = Manager.createRealizedPlayer(new File("c:\\tmpfile.avi").toURI().toURL()); 
```

**第一个问题：您有更好的解决方案吗？**

因此，使用此解决方案，我将在他使用结束时删除临时文件，然后我尝试了：

```
mediaPlayer.stop();
mediaPlayer.close();
mediaPlayer.deallocate();
file.delete() 
```

但是删除不起作用。它似乎总是在播放器中使用...

**第二个问题：如何停止使用临时文件或强制删除？**

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:55:18.363

我还没有尝试过，但是您可以尝试使用 `getClass().getResource(filePathInJar)`来获取资源的 URL，然后使用它来构造 a`MediaLocator`以用作`createRealizedPlayer()`. 就像是：

```
URL url = getClass().getResource(filePathInJar);
MediaLocator locator = new MediaLocator(url);
mediaPlayer = Manager.createRealizedPlayer(locator); 
```

编辑：所以，我已经验证 MediaLocator 无法处理 jar:file:/ url。在我看来，您有两个选择：

1.  查找或创建自定义的基于 InputStream 的 DataSource。[http://www.extollit.com/isdsjmf.php](http://www.extollit.com/isdsjmf.php)上的页面声称有一个可以工作。我没试过。

2.  继续做你现在正在做的事情 - 将媒体文件从 jar 复制到临时文件，并使用 file:// url。我认为您可以使用 File.createTempFile() 和 File.deleteOnExit() 解决删除文件的问题

# python - 加载和解析具有多个 JSON 对象的 JSON 文件

> ID：12451431
> 
> 赞同：127
> 
> 时间：2012-09-16T23:00:56.853
> 
> 标签：python, json, file, jsonlines

我正在尝试在[Python](http://en.wikipedia.org/wiki/Python_%28programming_language%29)中加载和解析 JSON 文件。但我一直试图加载文件：

```
import json
json_data = open('file')
data = json.load(json_data) 
```

产量：

```
ValueError: Extra data: line 2 column 1 - line 225116 column 1 (char 232 - 160128774) 
```

我看了*[18.2。`json`— Python 文档中的 JSON 编码器和解码器](http://docs.python.org/library/json.html)*，但是阅读这个看起来很糟糕的文档非常令人沮丧。

前几行（使用随机条目匿名）：

```
{"votes": {"funny": 2, "useful": 5, "cool": 1}, "user_id": "harveydennis", "name": "Jasmine Graham", "url": "http://example.org/user_details?userid=harveydennis", "average_stars": 3.5, "review_count": 12, "type": "user"}
{"votes": {"funny": 1, "useful": 2, "cool": 4}, "user_id": "njohnson", "name": "Zachary Ballard", "url": "https://www.example.com/user_details?userid=njohnson", "average_stars": 3.5, "review_count": 12, "type": "user"}
{"votes": {"funny": 1, "useful": 0, "cool": 4}, "user_id": "david06", "name": "Jonathan George", "url": "https://example.com/user_details?userid=david06", "average_stars": 3.5, "review_count": 12, "type": "user"}
{"votes": {"funny": 6, "useful": 5, "cool": 0}, "user_id": "santiagoerika", "name": "Amanda Taylor", "url": "https://www.example.com/user_details?userid=santiagoerika", "average_stars": 3.5, "review_count": 12, "type": "user"}
{"votes": {"funny": 1, "useful": 8, "cool": 2}, "user_id": "rodriguezdennis", "name": "Jennifer Roach", "url": "http://www.example.com/user_details?userid=rodriguezdennis", "average_stars": 3.5, "review_count": 12, "type": "user"} 
```

* * *

## 回答 #1

> 赞同：267
> 
> 时间：2012-09-16T23:08:23.347

你有一个[JSON Lines 格式的文本文件](http://jsonlines.org/)。您需要逐行解析文件：

```
import json

data = []
with open('file') as f:
    for line in f:
        data.append(json.loads(line)) 
```

每*行都*包含有效的 JSON，但作为一个整体，它不是有效的 JSON 值，因为没有顶级列表或对象定义。

请注意，由于该文件每行都包含 JSON，因此您可以省去尝试一次性解析所有文件或找出流式 JSON 解析器的麻烦。您现在可以选择在继续下一行之前分别处理每一行，从而节省过程中的内存。如果您的文件非常大，您可能不想将每个结果附加到一个列表*然后处理所有内容。*

如果您有一个包含单个 JSON 对象且中间有分隔符的文件，请使用[如何使用“json”模块一次读取一个 JSON 对象？](https://stackoverflow.com/questions/21708192/how-do-i-use-the-json-module-to-read-in-one-json-object-at-a-time/21709058#21709058)使用缓冲方法解析出单个对象。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2017-07-17T18:00:11.673

对于那些偶然发现这个问题的人：python`jsonlines`库（比这个问题年轻得多）优雅地处理每行一个 json 文档的文件。见[https://jsonlines.readthedocs.io/](https://jsonlines.readthedocs.io/)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2021-07-27T09:13:54.350

如果您正在使用`pandas`并且您有兴趣将`json`文件加载为数据框，您可以使用：

```
import pandas as pd
df = pd.read_json('file.json', lines=True) 
```

并将其转换为 json 数组，您可以使用：

```
df.to_json('new_file.json') 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-16T23:09:16.917

那*是*格式不正确。每行有一个 JSON 对象，但它们不包含在更大的数据结构（即数组）中。您要么需要重新格式化它，使其在每行末尾以逗号开头`[`和结尾`]`，要么将其逐行解析为单独的字典。

# android - 使用多个签名从 android 应用程序链接到 facebook

> ID：12451434
> 
> 赞同：0
> 
> 时间：2012-09-16T23:02:10.727
> 
> 标签：android, facebook, authentication, single-sign-on

要链接到 Facebook，必须保存一个应用签名哈希参考。这样做，工作正常。我相信很多人都发现了与谷歌和亚马逊一起销售的应用程序的问题，这些应用程序在正常的事件过程中会有不同的签名。我知道在亚马逊上发布时可以使用自己的签名来解决此冲突。我只是想知道实际上是否可以以任何方式链接到 Facebook 上具有不同签名的单个参考，以便我可以继续使用默认的亚马逊签名？任何使用别名的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T00:13:14.430

在配置 Facebook 应用程序时，您可以安全地添加多个密钥哈希。

![Facebook 密钥哈希](../Images/d0b29a9057df8ed731a54f1e2777a803.png)

# objective-c - 将图标放在资源子文件夹下

> ID：12451436
> 
> 赞同：0
> 
> 时间：2012-09-16T23:02:30.403
> 
> 标签：objective-c, ios, xcode

当我尝试归档我的一个 iOS 项目时，我收到了以下警告消息：

```
Validate MyApp.app ...in ....
Icon specified in the Info.plist not found under the top level app wrapper: Images/icon.png 
```

我已将所有图像文件放在资源/图像下，并在项目中创建了对图像文件夹的文件夹引用。对于文件夹引用下的图标图像，我应该为 Info.plist 赋予什么价值？

![资源文件夹](../Images/bbaba8f2a020459bfda592d5f50fcc4f.png)

这是我目前的价值观：

![在此处输入图像描述](../Images/7d96b4692f4d46097d59a0a4c49f0570.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T23:05:56.327

确保正确设置文件夹引用。当没有正确指定与项目文件夹相关的文件夹路径时，可能会发生这种情况。

刚刚注意到，itunesartwork.png 文件在哪里？我看到它列在您的 plist 中，但不在文件夹中。

# android - 使用谷歌地图

> ID：12451445
> 
> 赞同：0
> 
> 时间：2012-09-16T23:04:56.843
> 
> 标签：android, google-maps

这是我的代码-

```
 <uses-sdk
        android:minSdkVersion="15"
        android:targetSdkVersion="15" />

    <uses-library android:name="com.google.android.maps"/>
    <uses-permission android:name="android.permission.INTERNET"/>

    <application

        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/title_activity_main" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

当我保存它时，它显示有关使用库行的错误。为什么我在使用使用库行时出错？任何人都可以帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:09:07.567

使用库应该在应用程序标签下......你应该粘贴你的日志，这样我们可以更有帮助

# ruby-on-rails - 在我的视图的实例变量上使用 each 方法会返回 NoMethodError，未定义的 .each 方法

> ID：12451448
> 
> 赞同：1
> 
> 时间：2012-09-16T23:05:20.773
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我正在努力在我的视图中生成一个列表。尝试循环通过我的 @residents 实例变量时，我收到错误

管理员中的 NoMethodError#show

显示 /Users/myCPU/rails_projects/whizcharts/app/views/residents/index.html.erb 其中第 3 行提出：

```
undefined method `each' for nil:NilClass
Extracted source (around line #3):

1: <h1>Resident Profiles</h1>
2: <ul class="list-residents">
3:  <% @residents.each do |r| %>
4:      <li>
5:          <%= link_to r.fname, r %>
6:      </li>
Trace of template inclusion: app/views/admins/show.html.erb 
```

我试过以下...

*   Ran rake db:migrate 以防万一。

*   在我的“/controllers/residents_controller”文件中，我尝试过更改

    `@residents = Resident.find(:all) to @residents = Resident.find.all`

这是我的代码...

# “控制器/residents_controller.rb”

```
class ResidentsController < ApplicationController
  def index
    @residents = Resident.find(:all) 
  end

  def show
    @resident = Resident.find(params[:id])
  end

  def new
    @resident = Resident.new
  end

  def create
    @resident = Resident.new(params[:resident])
    if @resident.save 
      redirect_to @resident, :success => "Your submission was a success"
    else 
      render :action => 'new'
    end
  end

  def edit
    @resident = Resident.find(params[:id])
  end

  def update
    @resdient = Resident.find(params[:id])
    if @resident.update_attributes(params{:resident})
        flash[:success] = "Resident's profile updated"
        sign_in @resident
        redirect_to @resident
    else
      render 'edit'
    end
  end

  def destroy
    Resident.find(params[:id]).destroy
    flash[:success] = "Resident deleted"
    redirect_to residents_path
  end

  def _form
    @residents = Resident.paginate(page: params[:page])
  end
end 
```

# '配置/路由.rb'

```
Whizcharts::Application.routes.draw do
  root to: 'static_pages#home'
  resources :admins, :residents
  resources :sessions, only: [:new, :create, :destroy]

  # static_page 
  match '/help',       to: 'static_pages#help'
  match '/about' ,     to: 'static_pages#about'
  match '/contact',    to: 'static_pages#contact'

  # sign in | sign up
  match '/signup',    to: 'admins#new'
  match '/signin',    to: 'sessions#new'
  match '/signout',   to: 'sessions#destroy', via: :delete
 .
 .
 .
   match ':controller(/:action(/:id))(.:format)'
end 
```

# '意见/居民/index.html.erb'

```
<h1>Resident Profiles</h1>
<ul class="list-residents">
    <% @residents.each do |r| %>
        <li>
            <%= r.fname %>
        </li>
    <% end %>
</ul> 
```

# '/db/schema.rb'

```
ActiveRecord::Schema.define(:version => 20120722195705) do

  create_table "admins", :force => true do |t|
    t.string   "fname"
    t.string   "lname"
    t.string   "soc"
    t.string   "dob"
    t.string   "gender"
    t.text     "address"
    t.string   "city"
    t.string   "state"
    t.string   "zip"
    t.string   "email"
    t.string   "phone1"
    t.string   "phone2"
    t.datetime "created_at",                               :null => false
    t.datetime "updated_at",                               :null => false
    t.string   "password_digest"
    t.string   "password"
    t.string   "password_confirmation"
    t.string   "remember_token"
    t.boolean  "super",                 :default => false
  end

  add_index "admins", ["email"], :name => "index_admins_on_email", :unique => true
  add_index "admins", ["remember_token"], :name => "index_admins_on_remember_token"

  create_table "residents", :force => true do |t|
    t.string   "fname"
    t.string   "lname"
    t.string   "dob"
    t.string   "gender"
    t.string   "soc"
    t.string   "address"
    t.string   "city"
    t.string   "state"
    t.string   "zip"
    t.string   "phone"
    t.string   "doc_fname"
    t.string   "doc_lname"
    t.string   "doc_phone1"
    t.string   "doc_phone2"
    t.string   "doc_fax"
    t.string   "doc_email"
    t.string   "guard_fname"
    t.string   "guard_lname"
    t.string   "guard_address"
    t.string   "guard_city"
    t.string   "guard_state"
    t.string   "guard_zip"
    t.string   "guard_phone1"
    t.string   "guard_phone2"
    t.string   "guard_email"
    t.datetime "created_at",    :null => false
    t.datetime "updated_at",    :null => false
  end

end 
```

由于 NoMethodError 在 Admins#show 中，因此这里是它的代码。

# '/views/admins/show.html.erb'

```
<% provide(:title, @admin.fname + " " + @admin.lname) %>
<div class="row">
    <aside class="span4">
        <section>
            <h1>
                <%= gravatar_for @admin %>
                <%= @admin.fname + " " + @admin.lname %> 
            </h1>
        </section>
        <section class="resident">
            <div class="content">
                <div id="new-resident">
                    <%= link_to 'create a new resident', new_resident_path %>
                </div>
                <div id="list-residents">
                    <%= render :template => 'residents/index' %>
                </div>
            </div><!-- END content CLASS -->
        </section>
    </aside>
</div> 
```

最后，当我从“views/residents/index.html.erb”文件中删除 each 方法时，我的浏览器会正确呈现。我不觉得我了解如何混合来自不同控制器的部分，也不了解如何正确使用实例变量。感谢您提供有关此问题的任何帮助以及提供我应该阅读的主题（除了 rails 文档）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T23:22:47.380

看来您在 Admins 控制器中遇到了 show 操作，而不是 index 操作 ( `NoMethodError in Admins#show`)。

如果添加`@residents = Resident.find(:all)`under还会发生这种情况`def show`吗？

# objective-c - JSON 到 Objective-C 字典

> ID：12451452
> 
> 赞同：1
> 
> 时间：2012-09-16T23:05:42.617
> 
> 标签：objective-c, xcode, ios5, jsonkit

我正在向 API 发出 URL 请求，但我不知道如何呈现 JSON，它会生成一个这样的多个用户数组，`[{"user": "value"}, {"user":"value"}]`我试图使用 TableView，所以我需要一个 NSDictionary，但我认为呈现 JSON 更好喜欢`{users: [{"user": "value"}, {"user":"value"}]}`。我有这个代码来提出请求

```
#import "JSONKit.h"
NSError *error = nil;
NSURLResponse *response = nil;
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL: [NSURL URLWithString: @"http://localhost:3000/getusers"]];
[request setHTTPMethod:@"GET"];
NSData *jsonData = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];
users = [[jsonData objectFromJSONData] objectForKey:@"users"];
usersKeys = [users allKeys]; 
```

但我收到了这个错误

2012-09-16 18:51:11.360 tableview[2979:c07]-[JKArray allKeys]：无法识别的选择器发送到实例 0x6d30180 2012-09-16 18:51:11.362 tableview[2979:c07] ***由于未捕获而终止应用程序异常“NSInvalidArgumentException”，原因：“-[JKArray allKeys]：无法识别的选择器发送到实例 0x6d30180”

我真的不知道如何做到这一点，所以任何帮助都是有用的，谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T23:12:44.687

您收到该错误是因为从“ `jsonData`”中解析出来的内容不一定是您所期望的（即字典）。

也许您需要在您的代码中进行一些错误检查。

例如：

```
NSData *jsonData = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];
if(jsonData)
{
    id objectReturnedFromJSON = [jsonData objectFromJSONData];
    if(objectReturnedFromJSON)
    {
        if([objectReturnedFromJSON isKindOfClass:[NSDictonary class]])
        {
            NSDictionary * dictionaryFromJSON = (NSDictionary *)objectReturnedFromJSON;
            // assuming you declared "users" & "usersKeys" in your interface,
            // or somewhere else in this method
            users = [dictionaryFromJSON objectForKey:@"users"];
            if(users)
            {
                usersKeys = [users allKeys];
            } else {
                NSLog( @"no users in the json data");
            }
        } else {
            NSLog( @"no dictionary from the data returned by the server... check the data to see if it's valid JSON");
        }
    } else {
        NSLog( @"nothing valid returned from the server...");
    }
} else {
    NSLog( @"no data back from the server");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T23:43:38.587

我在想这样的事情

```
NSError *error = nil;
NSURLResponse *response = nil;
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL: [NSURL URLWithString: @"http://localhost:3000/getusers"]];
[request setHTTPMethod:@"GET"];
NSData *jsonData = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];

JSONDecoder *decoder = [[JSONDecoder alloc]
                        initWithParseOptions:JKParseOptionNone];
NSArray *json = [decoder objectWithData:jsonData];

NSMutableArray *objects = [[NSMutableArray alloc] init];
NSMutableArray *keys = [[NSMutableArray alloc] init];
for (NSDictionary *user in json) {
    [objects addObject:[user objectForKey:@"user" ]];
    [keys addObject:[user objectForKey:@"value" ]];
}
users = [[NSDictionary alloc] initWithObjects:objects forKeys:keys];
NSLog(@"users: %@", users);
usersKeys = [users allKeys]; 
```

但是对于许多项目来说它看起来效率不高还是我错了？

# javascript - 我网站上的 Javascript 问题。找不到错误

> ID：12451457
> 
> 赞同：1
> 
> 时间：2012-09-16T23:06:17.217
> 
> 标签：javascript, opencart

我的网站刚刚发生了一些事情，我真的无法让我的错误日志显示任何错误。它在 Firefox 中运行良好，所以我真的找不到 firebug 的错误。当我在 Chrome 中分析该站点时，我也看不到任何错误，但 javascripts 根本没有正确运行。

当我尝试将产品添加到购物中时，Chrome 中并没有真正发生任何事情，但是当我按下“检查购物车”时，所有产品都在那里。当我按下删除键时，也没有任何反应，但如果我更新网站，产品就会按原样被删除。

但是当我添加一些产品，然后按“检查卡”时，我收到此错误消息（无法标记文本，因此很遗憾它处于图像模式）： [图像](http://imgur.com/7bfEn)

我怎样才能找到这个错误？

我的网站位于 www nosmoke se，如果有人想知道，我正在使用 Open Cart 1.5.4.1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T20:09:55.587

Attracta 添加的功能可能会导致某些网站（例如 OpenCart）上的 AJAX 请求出现问题。最后，您需要请求 Attracta 将其禁用，但这可能需要几个小时到几天的时间。

要立即删除 Attracta 代码，您需要从网站的“网络根目录”（文档根目录）中删除 .fastinclude 文件。

要删除此文件： 1\. 登录您的帐户“文件管理器” 2\. 选择“Web Root (public_html/www)”选项，如果使用 GUI，请确保勾选“显示隐藏文件 (dotfiles)”。3.选择名为'.fastinclude'的文件并删除

删除此文件后，该应用程序将立即删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T23:16:15.347

在发送 JSON 的末尾，有一个 HTML 注释，以`<!--`

找出它的来源并摆脱它。

看起来底部还有一个不应该存在的脚本标签。

# c# - 为什么我们要将 ClassInterface 属性应用于类？

> ID：12451459
> 
> 赞同：6
> 
> 时间：2012-09-16T23:07:22.517
> 
> 标签：c#, .net

```
[ClassInterface(ClassInterfaceType.None)]
Class Program()
{
} 
```

我们什么时候需要将`ClassInterface`属性应用到一个类，就像这里所做的那样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T04:14:47.200

`ClassInterfaceAttribute`用于声明您的类对 COM 调用者的可见性，也就是说，如果您的类与 COM 世界中试图使用您的类的东西配合得很好。枚举中包含三个选项，`ClassInterfaceType`您可以将它们指定为`ClassInterfaceAttribute`. 这里它来自 MSDN，下面是三个类声明的示例，每个类声明都有不同的 InterfaceType 选择：

[`ClassInterfaceAttribute`在 MSDN 上](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.classinterfaceattribute.aspx)

[`ClassInterfaceType`在 MSDN 上](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.classinterfacetype.aspx)

下面说明了 的使用`ClassInterfaceAttribute`：

```
// This one will not be visible to COM clients.
[ClassInterface(ClassInterfaceType.None)]
public class MyClass1
{

}

// This one will provide an interface for COM clients, 
// but only when/if one is requested of it.
[ClassInterface(ClassInterfaceType.AutoDispatch)]
public class MyClass2
{

}

// This one will, immediately upon instantiation, 
// automatically include an interface for COM clients.
[ClassInterface(ClassInterfaceType.AutoDual)]
public class MyClass3
{

} 
```

# python - Python 3：将多行打印到一行

> ID：12451461
> 
> 赞同：1
> 
> 时间：2012-09-16T23:07:26.763
> 
> 标签：python, python-3.x

我使用 Google 机器搜索了 Stackoverflow 和其他网站上的线程，但没有什么能完全满足我的需求。

我是使用 Python 3 的新编程学生，所以我的大部分东西都很基础。

我正在编写一个程序，允许我使用 Caeser 密码加密和解密文本文件。从用户那里获取一个短语并应用用户给定的班次。

这就是我现在正在使用的：

一些代码只是在那里作为占位符，直到我进一步了解我的程序。

```
import string
print ("1) Encrypt")
print ("2) Decrypt")
print ("3) Decrypt w/o Shift")

Choice = input("Choice: ")

if Choice == '1':
    message = input("Message: ")
    shift = int(input("Shift: "))
    newmsg = ''
    for char in message:
        if char.isupper():
            new = (ord(char)-ord('A')) + shift
            newmsg = chr(new+ord('A'))
            print (newmsg, end="")
        else:
            print(" ")

elif Choice == '2':
    print ("2")

elif Choice == '3':
    print ("3") 
```

当我输入一个测试短语（例如“这是一个测试”）时，它会给出正确加密的输出，但它会显示如下：

```
V
J
K
U

K
U

C

V
G
U
B 
```

这是2的“转变”

如果我添加`end = ' '`到我的打印语句，它输出为：

```
V J K U
K U
C
V G U V 
```

如果我添加`end = ''`到我的打印语句，它输出为：

```
VJKU
KU
C
VGUV 
```

我正在寻找以下输出：

```
VJKU KU C VGUV 
```

我知道这是我忽略的愚蠢的事情。任何帮助，将不胜感激。非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-16T23:09:25.667

使用`end=""`, 还要将此参数添加到该行

```
print(" ") 
```

否则，此行将添加一个换行符。

也就是说，您最好先收集列表中的字符，然后`print()`只调用一次：

```
print("".join(list_of_characters)) 
```

另一种方法是创建一个字符转换表`str.maketrans()`并使用`str.translate()`.

# drupal - 我收到 500 内部错误 IIS 7。安装 Drupal 时在哪里可以找到我的服务器的错误日志

> ID：12451462
> 
> 赞同：2
> 
> 时间：2012-09-16T23:07:40.540
> 
> 标签：drupal, iis, iis-7, error-log

我有一个 Drupal 站点，我正在从一台服务器复制到另一台服务器。我检查了所有连接、权限但我收到内部 500 服务器错误。谁能建议我在哪里可以看到 IIS 7.0 的错误日志？我的drupal版本是6.0

# android - 详尽搜索一无所获：Android 模拟器仅加载紧急呼叫应用

> ID：12451469
> 
> 赞同：1
> 
> 时间：2012-09-16T23:08:48.493
> 
> 标签：android, android-emulator

几周以来，我一直在使用 Android 模拟器、命令行和 Intellij 运行 ApiDemos 和我自己的应用程序，没有任何问题。
现在，没有任何异常或消息表明模拟器将只运行紧急呼叫应用程序的原因，仅此而已。

这是一个错误吗？如果是这样，我如何为 Android SDK 开发者创建问题？
我现在谨慎地将任何 .apk 加载到我的手机中，看看情况是否相同。

详情如下：

*   操作系统：Ubuntu 12.04
*   Android SDK：4.1（ICS）。
*   JDK：1.7.x

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-01T16:49:06.140

也许是一个愚蠢的答案，但你确定你没有在锁定屏幕上设置 PIN 码吗？这将在您加载模拟器时加载 PIN 输入屏幕，但仍允许您拨打紧急电话。

当你保存新的安全证书时，你必须在 Android ICS 上设置一个 PIN，这让我很困惑。

# regex - RegEx - 替换除第一个匹配项之外的所有内容

> ID：12451470
> 
> 赞同：0
> 
> 时间：2012-09-16T23:08:54.760
> 
> 标签：regex

如何在应用于字符串的替换函数中使用 RegEx 来匹配子字符串的所有实例，第一个实例除外？

例如，如果我要替换除第一个以外的所有 'a' 并且我的字符串是：

```
a b a c b a a b 
```

我想得到：

```
a b c b b 
```

* * *

我的实际用例是我正在使用 Ant 构建一个项目，它将一堆 .js 文件连接成一个。每个 javascript 文件都以：“use strict”开头。我只想要这个声明一次，因此我希望删除这个子字符串的所有实例，除了开头的那个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T14:11:08.310

这是一个通用的正则表达式：

```
echo "a b a c b a a b" | perl -pWe 's/(?<=(a))(.*?)\1/$2/g' 
```

它使用lookbehind来检查匹配的模式是否在字符串的第一个。（基本上，我的想法是`s/(?<=(a).*?)\1//g`，但可变长度的后视似乎并没有被广泛实施）。有一个缺点 - 它会产生类似的输出

```
a b  c b   b 
```

为了使其整洁，您可以使用

```
echo "a b a c b a a b" | perl -pWe 's/(?<=(a\s))(.*?)\1/$2/g' 
```

但它不会删除`a`输入中的最后一个，比如`a b a c b a a`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T23:37:15.533

只需删除所有出现的`"use strict";`，然后在开始时再次添加一个。

**编辑**：示例：

1.  ```
    sed '/"use strict";/d' < infile > outfile 
    ```

    变成

    ```
    (echo '"use strict"'; sed '/"use strict";/d') < infile > outfile 
    ```

2.  ```
    perl -nie 'print unless /"use strict";/;' file 
    ```

    变成

    ```
    perl -nie 'BEGIN { print qq["use strict";\n]; } print unless /"use strict";/;' file 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-16T23:41:18.323

要解决您的示例，您可以使用否定的前瞻断言：

```
echo "a b a c b a a b" | perl -pe 's/(?!^)a //g' 
```

结果：

```
a b c b b 
```

要解决您的项目问题（假设`use strict`在您的连接文件的每一行上没有多次出现），您可以使用`GNU sed`删除除第一个之外的所有出现：

```
sed '0,/$/!s/use strict//g' file.txt 
```

# jquery - JQuery删除动态表上的行

> ID：12451475
> 
> 赞同：4
> 
> 时间：2012-09-16T23:09:18.417
> 
> 标签：jquery, html, html-table, dynamic-tables

我正在创建一个注册页面，用户可以在其中注册其他几个人。我已经做到了，只有当用户选择某个选项时，表格才会显示。我还添加了添加按钮，添加行非常好。问题是当我为删除按钮添加功能时，一切都会中断。这是我的html：

```
<div id="add_table" style="display:none;" >
    <button type="button" id="AddLine">Add Line</button>
    <table border="1px" id="table">
        <tr>
            <td>First Name</td>
            <td>Last Name</td>
            <td>Phone</td>
            <td>Email</td>
            <td>Ethnicity</td>
        </tr>
        <tr>
            <td><input type=text /></td>
            <td><input type=text /></td>
            <td><input type=text /></td>
            <td><input type=text /></td>
            <td><input type=text /></td>
            <td><button type="button">delete</button></td>
        </tr>
    </table>​
</div> 
```

这是我的jQuery代码：

```
$(document).ready(function(e) { 
    $("input[name= 'Reg_num_r']").change( function () {
        if($(this).val()==1) {
            $("#add_table").hide();
        } else {
            $("#add_table").show();
        }
    });

    /*$("#table").on("click", "button", function() {
       $(this).closest("tr").remove(); 
    });​*/

    $("#AddLine").click(function () {
        var row = "<tr><td><input type=text /></td><td><input type=text /></td><td><input type=text /></td><td>                   <input type=text /></td><td><input type=text /></td><td><button type=button>delete</button></td></tr>";
        $("#table").append(row);
    });
}); 
```

现在，当我取消注释上面的注释代码时，一切都停止了。即使用户选择了正确的选项，表格也不会显示。我应该如何修复它才能正确执行删除行操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T23:44:38.820

`Ctrl+C``Ctrl+V`从你的代码：

```
/*$("#table").on("click", "button", function() {
    $(this).closest("tr").remove(); 
});​*/ 
```

最后一个分号后面有一个 0 宽度的空格，点击编辑并使用箭头键查看。它是 JavaScript 中的非法字符，会产生语法错误。

这是从 jsFiddle 和其他地方复制代码时的常见问题。

我建议手头有一个[Notepad++](http://notepad-plus-plus.org/)的副本来查看 copypasta 代码，它`?`默认显示那些不可见的字符：

![在此处输入图像描述](../Images/39c5dd0b8a2bc7da4b7c25ead7304203.png)

您也可以取消注释代码并在[JSHint](http://www.jshint.com/)中对其进行测试，它会告诉您在哪一行有无效字符。

# symfony - Symfony2 为第三方包生成 crud

> ID：12451479
> 
> 赞同：1
> 
> 时间：2012-09-16T23:10:04.263
> 
> 标签：symfony, admin, crud, vendor

可以使用 CRUD 生成器为我的实体生成基本管理界面。IE`php app/console generate:doctrine:crud`

问题是，这是否也适用于供应商捆绑的实体？我收到关于找不到我想要的实体的错误。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T00:30:59.067

您似乎想向供应商捆绑包添加额外的功能，因此您可能需要对其进行扩展。

[Symfony2 继承](http://symfony.com/doc/2.0/cookbook/bundles/inheritance.html)

# python - 无法使用 django 1.4 运行 mongodb

> ID：12451481
> 
> 赞同：2
> 
> 时间：2012-09-16T23:10:48.713
> 
> 标签：python, django, mongodb

我正在使用虚拟环境。我使用这些包来安装 pymongo。

> [https://github.com/django-nonrel/django-1.4](https://github.com/django-nonrel/django-1.4)
> 
> [https://bitbucket.org/wkornewald/djangotoolbox/get/tip.tar.gz](https://bitbucket.org/wkornewald/djangotoolbox/get/tip.tar.gz)
> 
> [https://github.com/django-nonrel/mongodb-engine/tarball/master](https://github.com/django-nonrel/mongodb-engine/tarball/master)

这是我得到的错误：

```
Traceback (most recent call last):
File "C:\virtual\please\lib\site-packages\djangotoolbox\db\base.py", line 94,
in __init__
super(NonrelDatabaseOperations, self).__init__()
TypeError: __init__() takes exactly 2 arguments (1 given) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T06:35:26.190

[django-nonrel 1.4](https://github.com/django-nonrel/django-1.4)分支目前有免责声明：

```
 "Work in progress 1.4 port, DON'T USE". 
```

您应该改用稳定的[django-nonrel](https://github.com/django-nonrel/django-nonrel)分支。

# php - PHP - 使用 fgets 从服务器获取数据/聊天的 TCP 客户端不起作用

> ID：12451482
> 
> 赞同：0
> 
> 时间：2012-09-16T23:11:08.743
> 
> 标签：php, tcp, client

首先 fputs 用于将聊天从 PHP 站点发送到该游戏服务器。但是当我使用 fgets 从服务器获取所有聊天日志时，它不会返回它，例如，当我在文本字段中写一些东西并使用以下代码中的按钮发送它时，它会向服务器发送消息，我希望它从服务器返回该值，或者从服务器获取所有聊天日志并将其放入作为 php 网站的客户端，这是代码：

```
 <?php

 $host="192.168.0.6";
 $port = 7777;
 // open a client connection
 $fp = fsockopen ($host, $port, $errno, $timeout);
 if (!$fp){
 $result = "Error: could not open socket connection";
 }
 else
 {

  echo '<center><form action="tcpclient.php "method="POST" /></center>';
  echo '<center>'."Nickname: ".'<input type="text" name="nick" size="31" /></center>';
  echo '<center>'." Text: ".'<input type="text" name="chat" size="150" /> <input type="submit" name="send" value="Send"  /></center>';

  if (isSet($_POST['send'])) $formvalue =$_POST['chat'];
  //$name = $_POST['nick'];
  //if (isSet($_POST['send'])) $formvalue + $_POST['chat']; 
  fputs ($fp, $formvalue);

  }
  $result = fgets ($fp, 7777);
  echo $result;

  ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T23:22:58.770

`fgets()`只读取一行（由 终止`"\n"`）并且将阻塞直到`"\n"`收到或连接关闭。确保其中一件事情发生。（使用`telnet`或`nc`程序）

哦，我不确定，但它可能会`"\r\n"`在 Windows 上出现，并且不会`"\n"`单独做出反应。不过不要相信我的话。

如果没有换行符，请使用and`fread`的组合（请参阅手册）。`stream_select``stream_set_blocking`

如果它更复杂，您可能需要切换到`socket_*`函数。请注意，套接字和流不会混合。

* * *

抱歉，我懒得举个例子了。您可以[在此处](https://bitbucket.org/virtulis/22sync/src/3ba8c834d507/22sync.php "这里")查看实际操作的一般示例`stream_select`（免责声明：我知道代码很丑陋。）

基本上，您将`stream_set_blocking`使用 0 并循环，`stream_select`直到`fread`您阅读了所有内容（如果您可以检测到）或遇到超时。很难提出任何不了解协议的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T23:13:45.510

您必须实际实现服务器所说的协议。当您调用 时`fgets`，您只会获得 TCP 堆栈当时恰好准备好的任何数据，这绝对不是您想要的。

# objective-c - 检索应用程序的 DockTile（视图）

> ID：12451483
> 
> 赞同：0
> 
> 时间：2012-09-16T23:11:10.893
> 
> 标签：objective-c, macos, cocoa

通过尝试写一些类似 Dock 的东西，而视觉上的花里胡哨的东西少了一点，我用一点 ObjC 弄脏了我的手。进展顺利。但是我偶然发现了一个我无法安静解决的问题：

通过检索应用程序的图标`NSRunningApplication`很容易。但是，一些应用程序不使用它们的图标`DockTile`，它们[使用自定义视图](https://developer.apple.com/library/mac/#documentation/Carbon/Conceptual/customizing_docktile/docktasks_cocoa/docktasks_cocoa.html)，因为它们的 DockTiles 是动态的（大多数 torrent 应用程序在 Dock 中显示它们当前的上升/下降速度）。

有没有办法得到它`DockTile`并在我自己的应用程序中显示它？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:54:44.497

不，那里没有。设置自定义 Dock 磁贴的方法最终将视图的内容直接传递给 Dock；它不适用于其他进程。

就其价值而言，为 Dock 编写替代品将是一项无望的任务——Apple 的 Dock.app 使用许多私有的、未记录的 API 与 WindowServer 交互，其中一些根本不能被任何进程使用不是码头。

# iphone - 无法将 Tapku 库添加到 XCode 4.2 项目中

> ID：12451484
> 
> 赞同：0
> 
> 时间：2012-09-16T23:11:17.573
> 
> 标签：iphone, objective-c, ios, xcode, tapku

我尝试按照作者的 github 存储库中的[本教程进行操作，但没有成功。](https://github.com/devinross/tapkulibrary/wiki/Adding-Tapku-to-Your-Project-in-XCode-4)当我尝试构建项目时，出现 6 个错误。

其中 5 个是

> 使用未声明的标识符“_accessibleElements”

其中1个是

> 接收器类型“TKCalendarMonthTiles”例如消息未声明具有选择器“rectForCellAtIndex”的方法

所有错误都在 TKCalendarMonthView.m 文件中报告

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T00:44:52.303

看来该类`TKCalendarMonthTiles`声明了一个属性：

```
@property (nonatomic, strong) NSMutableArray *accessibleElements; 
```

这不是在类实现中合成的。由于没有`_accessibleElements`声明 ivar，因此您会收到您提到的未声明标识符错误。

对于这个错误，你可以在 Xcode 4.4 上构建来自动合成声明的属性，或者添加：

```
@synthesize accessibleElements = _accessibleElements 
```

在`TKCalendarMonthTiles`实施中

现在，对于您的第二个错误。这也是基于 Xcode 4.2 而不是 4.4 构建的。从 4.4 开始（或者可能是 4.3，我不记得了），您不需要在类扩展中声明私有方法。但是由于您是使用 Xcode 4.2 构建的，因此您需要将方法声明添加到类扩展中`TKCalendarMonthTiles`

```
@interface TKCalendarMonthTiles ()
- (CGRect)rectForCellAtIndex:(int)index;
@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T18:00:27.833

我也有同样的问题。我一直在努力，放弃了。升级到 xCode 4.5，瞧。有效。希望我当时能看到这个论坛。谢谢偷看

# android - 如何在android中调用restful服务

> ID：12451486
> 
> 赞同：0
> 
> 时间：2012-09-16T23:12:04.207
> 
> 标签：android, rest

我正在将我的一些 Windows Phone 7 应用程序移植到 Android。当我们在 WP7 世界中调用服务时，调用是异步的。我们调用该服务，并且有一个委托 _completed 事件，该事件在返回结果时触发。与此同时，我们继续前进。

下面粘贴的 java android 代码是我在云服务器上调用 HTTP 服务的方式。我通过学习如何在 android 世界中调用服务的 Android 教程开发了这段代码。显然，这里的服务调用是同步的，因此以 InputStream in... 开头的指令在返回结果之前不会被执行。

这是它应该如何为Android工作？如果服务没有响应，则等待几分钟，然后发生超时异常。那不好。一切都会挂起。

在android中调用服务的推荐方式是什么？谢谢，加里

```
 public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    HttpURLConnection urlConnection = null;

        try 
        {
            URL url = new URL("http://www.deanblakely.com/REST/api/products");
            urlConnection = (HttpURLConnection) url.openConnection();
            InputStream in = new BufferedInputStream(urlConnection.getInputStream());     
            String myString = readStream(in);
            String otherString = myString;
            otherString = otherString + " ";
        } 
        catch (MalformedURLException e) 
        {
            e.printStackTrace();
        } 
        catch (IOException e) 
        {   
            e.printStackTrace();
        }  

        finally 
        {     
            urlConnection.disconnect();   
        } 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T23:24:42.690

> 这是它应该如何为Android工作？

是的。在后台线程中执行 HTTP 操作，例如由`AsyncTask`.

> 如果服务没有响应，则等待几分钟，然后发生超时异常。那不好。一切都会挂起。

您可以将套接字超时设置为比“几分钟”更短的时间。例如，您可以调用`setReadTimeout()`您的`HttpURLConnection`以毫秒为单位指定超时时间。

# c - C 和 execve(3) 参数

> ID：12451487
> 
> 赞同：1
> 
> 时间：2012-09-16T23:12:25.670
> 
> 标签：c, exec, constants, ptrace, execve

我正在做一个与`strace(1)`使用`ptrace()`. 基本上，我们有一个 controller.c 程序，它接受一个可执行文件作为参数，它输出可执行文件所做的任何系统调用（例如`% controller ls -l`）我们正在使用`execve()`来运行可执行文件，但是我们遇到了一些麻烦。execve 采用以下参数

```
 execve( const char *filename, char *const argv[], char *const envp[] ) 
```

其中 filename 在这种情况下是`"ls"`, 并且`argv[]`是给定文件名的参数列表。所以我们有一些看起来像这样的东西（在 C 文件中）

```
int main(int argc, char *argv[],char *envp[]){
  pid_t child;
  child = fork;

  if(/* CHILD */){
    ptrace(PTRACE_TRACEME,0, NULL, NULL);

    if(argc == 2) {
      execve(argv[1],NULL,envp);
    }
    else {
      execve( argv[1], /* ARGUMENT LIST */, envp);
    }

  } else /* PARENT */ {
    //PARENT CODE 
  }
} 
```

因此，如果我们得到一个可执行文件，例如`controller ls -l`、`where argv[0] = "controller"`、`argv[1] = "ls"`和`argv[2] = "-l"`，我们如何在“ARGUMENT LIST”中传递正确的参数（这种情况下的参数只是`"-l"`但可能更多）？

基本上，我们如何初始化一个类型的数组，以`const char *`使该数组具有可执行文件的参数值？我们是否甚至需要担心数组中有额外的值并且只是过去`argv`的 ARGUMENT LIST？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:19:00.710

您可以简单地通过`argv + 1`（跳过您的程序名称）。`argv + 1`是一个指向从 的第二个元素开始的数组的指针`argv`，它是执行程序的名称。`argv + 1`相当于`&argv[1]`，你可以使用任何你喜欢的风格。

正如评论中提到的，标准的第 5.1.2.2.1 节指定`argv`确实是空终止的。为了完整起见，保留以下部分。

如果 C 不保证`argv`是空终止的（我不清楚它是否是），你可以这样做：

```
char **new_argv = malloc((argc-1) * sizeof(char*));
for (int i = 0; i < argc - 1) new_argv[i] = argv[i+1]; 
```

并`new_argv`用于参数列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T00:13:03.957

```
execve(argv[1], argv+1, envp); 
```

# sql - 在 SELECT 中过滤掉重复的后续记录

> ID：12451489
> 
> 赞同：6
> 
> 时间：2012-09-16T23:12:44.890
> 
> 标签：sql, postgresql, gaps-and-islands, window-functions

**(PostgreSQL 8.4)** 表“trackingMessages”存储移动设备 (tm_nl_mobileid) 和固定设备 (tm_nl_fixedId) 之间的跟踪事件。

```
CREATE TABLE trackingMessages
(
  tm_id SERIAL PRIMARY KEY,           -- PK
  tm_nl_mobileId INTEGER,             -- FK to mobile
  tm_nl_fixedId INTEGER,              -- FK to fixed
  tm_date INTEGER,                    -- Network time
  tm_messageType INTEGER,             -- 0=disconnect, 1=connect
  CONSTRAINT tm_unique_row
    UNIQUE (tm_nl_mobileId, tm_nl_fixedId, tm_date, tm_messageType)
); 
```

这里的问题是，同一台手机可能随后会连接到同一台固定设备两次（或更多次）。我不想看到后面的那些，但是可以在以后看到移动设备连接到同一个固定设备，前提是两者之间有不同的固定设备连接。

我想我很接近但不完全。我一直在使用以下 CTE（在 Stack Overflow 上找到）

```
WITH cte AS 
(
  SELECT tm_nl_fixedid, tm_date, Row_number() OVER (
    partition BY tm_nl_fixedid
    ORDER BY tm_date ASC
  ) RN 
  FROM   trackingMessages
) 
SELECT * FROM cte 
  WHERE tm_nl_mobileid = 150 AND tm_messagetype = 1
  ORDER BY tm_date; 
```

给我以下结果

```
32;1316538756;1
21;1316539069;1
32;1316539194;2
32;1316539221;3
21;1316539235;2 
```

这里的问题是最后一列应该是 1, 1, 1, 2, 1，因为第三个“32”实际上是一个重复的跟踪事件（在同一行中固定两次）并且最后一个连接到“21 " 是可以的，因为 "32" 介于两者之间。

**请不要建议使用光标，**这是我目前试图摆脱的。游标解决方案确实有效，但考虑到我必须处理的记录数量，它太慢了。我宁愿修复 CTE，只选择哪里`RN = 1`……除非你有更好的主意！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-16T23:45:05.450

好吧，您并没有那么接近，因为`row_number()`无法同时跟踪两组序列。`PARTITION BY tm_nl_fixedid ORDER BY date RESTART ON GAP`不存在，没有这样的事情。

Itzik Ben-Gan 为您面临的岛屿和差距问题提供了解决方案（实际上有几个解决方案）。这个想法是按主要标准（日期）对行进行排序，然后按分区标准+主要标准进行排序。序数之间的差异将保持不变，因为它们属于相同的分区标准和日期序列。

```
with cte as
(
  select *,
      -- While order by date and order by something-else, date
      -- run along, they belong to the same sequence
         row_number() over (order by tm_date)
       - row_number() over (order by tm_nl_fixedid, tm_date) grp
    from trackingMessages
)
select *,
    -- Now we can get ordinal number grouped by each sequence
       row_number() over (partition by tm_nl_fixedid, grp
                          order by tm_date) rn
  from cte
 order by tm_date 
```

[这是带有示例的 Sql Fiddle](http://sqlfiddle.com/#!11/4cd20/5)。

[这是 Sql Server MVP Deep Dives 的第 5 章，其中包含一些解决孤岛和间隙问题](http://www.manning.com/nielsen/SampleChapter5.pdf)的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T23:51:15.513

[使用窗口函数`lag()`](http://www.postgresql.org/docs/current/interactive/functions-window.html#FUNCTIONS-WINDOW-TABLE)应该更简单：

```
WITH cte AS (
   SELECT *
         ,lag(tm_nl_fixedId) OVER (PARTITION BY tm_nl_mobileId
                                   ORDER BY tm_date) AS last_fixed
   FROM   trackingmessages
   )
SELECT *
FROM   cte
WHERE  last_fixed IS DISTINCT FROM tm_nl_fixedId
ORDER  BY tm_date 
```

### 解释

*   在 CTE 中，`lag()`获取移动设备连接的最后一个固定设备（`NULL`对于每个移动设备的第一行 - 这就是我`IS DISTINCT FROM`稍后使用的原因，请在[此处](https://stackoverflow.com/a/12467777/939860)查看不同的方法）。

*   然后简单地排除最后一个固定设备与该设备相同的所有行，从而排除所有“后续设备”。全部做完。

# objective-c - iOS 通过应用内购买从服务器下载非消耗性内容

> ID：12451492
> 
> 赞同：5
> 
> 时间：2012-09-16T23:13:28.260
> 
> 标签：objective-c, ios, in-app-purchase

我已经阅读并搜索了有关 iOS 应用内主题的所有内容。至少来自谷歌（减去无休止的应用内黑客链接）。我找不到的一件事是有关如何从服务器获取内容并在收据验证后将其存储到手机上的说明或教程。我知道我可以将内容存储在我自己的服务器上，也可以使用应用程序加载器将其打包并让 Apple 托管它。我得到了整个非消耗性内容并使用您自己的服务器或 NSUserDefaults 来记住购买的物品。我找不到有关如何从我自己的服务器或 Apple 的服务器获取应用内购买内容的编码教程，以及我可以将其存储在手机的哪个位置？正常的套接字调用？我可以将内容存储在应用程序的目录中吗？

例如，我有一个现有的应用程序，我想通过应用程序内购买来销售新图像。现有图像位于捆绑包中。如何将捆绑的图像从服务器返回到我的应用程序？我可以接受每次购买的新捆绑包，我知道您不能修改现有捆绑包。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-03T15:50:50.780

当您购买成功时，您将获得交易对象。不是吗？

```
- (void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions 
```

遍历每个事务对象并使用以下代码：

```
if (transaction.downloads)
{
    [[SKPaymentQueue defaultQueue] startDownloads:transaction.downloads];
} 
```

成功下载后，您将收到一个委托呼叫：

```
-(void)paymentQueue:(SKPaymentQueue *)queue updatedDownloads:(NSArray *)downloads
{
    for (SKDownload *download in downloads)
    {
        switch (download.downloadState) {
            case SKDownloadStateActive:
                NSLog(@"Download progress = %f and Download time: %f", download.progress, download.timeRemaining);
                break;
            case SKDownloadStateFinished:
                NSLog(@"%@",download.contentURL);
                // Download is complete. Content file URL is at
                // path referenced by download.contentURL. Move
                // it somewhere safe, unpack it and give the user
                // access to it
                break;
            default:
                break;
        }
    }
} 
```

下载后，您将获得下载数据的 URL，现在您可以将其存储在库的应用程序支持文件夹中，并防止其自动同步到云端（如果需要）。而已。

# java - Java - 在主框中添加 9 个框

> ID：12451495
> 
> 赞同：5
> 
> 时间：2012-09-16T23:13:59.583
> 
> 标签：java

这里是典型的新手。尝试为我的第一个编程课构建所有强大的井字游戏网格。

我一直在尝试从 api 文档中进行所有有意义的操作，但到目前为止还没有运气。

我认为我最大的问题是不了解如何使用方法和参数，并且是一个完全的菜鸟，但我会到达那里。

这就是我所拥有的：

```
import java.awt.Rectangle;

public class TicTacToe {
    public static void main (String[] args) {
        new Rectangle (0,0,30,30); //create new box
        Rectangle box = new Rectangle (0,0,30,30); // tying the box to a variable

        box.add (Rectangle 0,0,10,10); /* error box can onot be resolved to a variable*/

    }
} 
```

所以我的问题是如何将 9 个宽度为 10 高度为 10 的盒子添加到这个较大的盒子中？当我添加这些框时，我也必须输入新的 xy 尺寸，对吗？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T03:29:08.323

我假设您的目标是编写一个简单的命令行程序，而不是带有用户界面的程序。正确的？如果是这样，那么您需要从计算机的角度考虑问题。井字游戏对人来说是一组 9 个方格，对计算机来说，它只是一组 9 个变量，每个变量可以有 3 种可能的状态：1）填充有 X，2）填充有O，和 3) 打开。因此，您的棋盘可以表示为，例如，一个由 9 个整数组成的数组。

像这样：

```
int[] board = new int[9]; 
```

要跟踪每个方格的状态，您可以声明一些常量：

```
static final int OPEN = 0;
static final int FILLED_WITH_X = 1;
static final int FILLED_WITH_O = 2; 
```

您的程序的其余部分可以只操作板数组，根据需要更改其状态（即其元素的值）。您甚至可以将此板的字符串表示形式输出到命令行。

您使用 Rectangle 类的唯一原因是您打算在屏幕上绘制板。在这种情况下，我会创建一个白色背景的大矩形并将其绘制在屏幕上。然后我会在上面绘制 9 个较小的矩形，每个矩形都有深色背景，为您提供游戏网格。`board`最后，我将根据前面讨论的数组状态在适当的位置绘制 x 和 o（圆圈和交叉线段） 。这里的重点是不需要在父对象中包含矩形对象。实际上，您只需要计算出每个要绘制的坐标集（4 个十进制数），然后编写一个在屏幕上所需位置绘制矩形的方法。

# c++ - 字符串的数据类型是什么？

> ID：12451496
> 
> 赞同：0
> 
> 时间：2012-09-16T23:14:01.190
> 
> 标签：c++, string, stdstring

这很可能是一个非常愚蠢的问题，但是在 C++ 中，字符串的数据类型是什么？我想让变量 x = "Slim Shady"。

我会将 x 声明为 int 吗？我尝试将其声明为字符，但是当我计算变量时，它只给出第一个字母。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-16T23:26:38.307

您需要包含头文件字符串

```
#include <string> 
```

然后你就可以使用 std::string

```
std::string x="Slim Shady" 
```

[http://en.cppreference.com/w/cpp/string/basic_string](http://en.cppreference.com/w/cpp/string/basic_string)

您也可以不使用 std::strings，如果您不想使用它们，尽管它们是您的最佳选择

您可以使用 Char 数组或 char 指针（C 字符串）

```
char x[]="Slim Shady"; 
```

或者

```
char* x="Slim Shady"; 
```

auto 关键字是 C++0x 的一个特性。在你学习 C++ 基础之前，你应该远离它

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-16T23:19:49.853

`std::string`是最好的选择。但您也可以使用`auto`, 如`auto x = "Slim Shady!";`. 这意味着您不必弄清楚使用表达式的类型。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-17T01:14:17.777

“Slim Shady”是`char[11]`可转换为`const char*`. 您还可以使用它来初始化任何大于 11 的字符数组。请参阅：

```
char a[] = "Slim Shady";
char a[11] = "Slim Shady";
const char* a = "Slim Shady";
char a[12] = "Slim Shady"; 
```

看到这个小代码：

```
#include <typeinfo>
#include <iostream>

template <class T>
void printTypeName(T t)
{
   std::cout << typeid(T).name() << std::endl;
}

int main() {
  printTypeName("Slim Shady");
  printTypeName<decltype("Slim Shady")>("Slim Shady");
} 
```

你得到（在 gcc 上）[错位](https://stackoverflow.com/questions/12400105/getting-mangled-name-from-demangled-name)的名字：

```
PKc
A11_c 
```

据我所知-第一个是`const char*`第二个`char[11]`。这很容易解释，因为当将任何数组传递给函数时 - 它被转换为 const 指针。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-16T23:16:24.657

你只是说：

```
std::string x = "Slim Shady"; 
```

# java - 在 lwjgl 中实现时间增量

> ID：12451497
> 
> 赞同：0
> 
> 时间：2012-09-16T23:14:10.603
> 
> 标签：java, physics, lwjgl, timedelta

我正在使用 Java 和 LWJGL 开发物理/游戏引擎。到目前为止，我一直使用`Display.Sync(int)`恒定的帧速率和 1/int 的时间增量来进行物理更新。我正在尝试实现真正的时间增量，以便我可以充分利用处理能力。下面是我用来跟踪这个增量的类：

```
package techwiz24.jVox2D.Physics;

public class PhysicsUtils {
    private static long lastTime = System.nanoTime();

    public static double getTimeDelta(){
        return (System.nanoTime()-lastTime)/1000000000d;
    }

    public static void updateDelta(){
        lastTime = System.nanoTime();
    }
} 
```

在每个滴答声中，引擎循环通过物理实体并应用标准重力等，更新速度和加速度分量。然后应该使用时间增量应用运动。在循环结束时，`updateDelta()`被调用。问题在于，这以某种方式使一切进展得更快。例如，这是我的运动模块：

```
package techwiz24.jVox2D.Physics;

/**
 * Moves an object in relation to it's velocity, acceleration, and time components
 * using the Kinematic equations.
 * @author techwiz24
 *
 */
public class PStandardMotion extends PhysicsEffect {

    @Override
    public String getName() {
        return "Standard Motion Effect";
    }

    @Override
    public String getVersion() {
        return "1";
    }

    /**
     * Using two Kinematic Equations, we can update velocity and location 
     * to simulate an earth-like gravity effect. This is called every tick,
     * and uses the TimeDelta stored in the physics object (Time since last update)
     * as the Time component. TODO: Figure out actual time deltas...
     * 
     * Note: This ignores wind resistance
     * 
     * Using: V_FINAL=V_INITIAL+at
     *        X=V_INITIAL*t + .5 * a * t^2
     * 
     * @param o The physics object to apply this to.
     */
    public void applyTo(PhysicsObject o) {

        double vf = o.getVelocityComponent()[1] + (o.getAccelerationComponent()[1]*o.timeDelta());
        double dy = o.getVelocityComponent()[1] + (0.5d * o.getAccelerationComponent()[1] * Math.pow(o.timeDelta(), 2));
        double dx = o.getVelocityComponent()[0] + (0.5d * o.getAccelerationComponent()[0] * Math.pow(o.timeDelta(), 2));

        o.updateVelocity(o.getVelocityComponent()[0], vf);
        o.updateLocation(o.getLocationComponent()[0]+dx, o.getLocationComponent()[1]+dy);

    }

} 
```

`timeDelta()`只返回当前时间增量。

```
public double timeDelta(){
        return PhysicsUtils.getTimeDelta();
} 
```

我是否以错误的方式处理这件事？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-06-02T16:00:49.730

```
This is generally how I do my FPS counter.

public class Game {
public static final int WIDTH = 800;
public static final int HEIGHT = 600;
public static final String TITLE = "Physics Tech Demo";

private long lastFrame;
private long lastFPS;
private int fps;

public void init() {
    try {
        Display.setDisplayMode(new DisplayMode(WIDTH, HEIGHT));
        Display.setTitle(TITLE);
        Display.create();
    } catch (LWJGLException e) {
        e.printStackTrace();
        Display.destroy();
    }

    initGL();
    getDelta();
    lastFPS = getTime();

    while (!Display.isCloseRequested()) {
        int delta = getDelta();
        tick(delta);
        renderGL();
        Display.update();
        Display.sync(60);
    }
    Display.destroy();
}

public int getDelta() {
    long time = getTime();
    int delta = (int) (time - lastFrame);
    lastFrame = time;

    return delta;
}

public long getTime() {
    return (Sys.getTime() * 1000) / Sys.getTimerResolution();
}

public void updateFPS() {
    if (getTime() - lastFPS > 1000) {
        System.out.println("FPS: " + fps);
        fps = 0;
        lastFPS += 1000;
    }
    fps++;
}

public void initGL() {
}

public void tick(int delta) {
    updateFPS();
}

public void renderGL() {
}

public static void main(String[] args) {
    Game game = new Game();
    game.init();
} 
```

}

# php - PHP Str_replace 不适用于大字符串

> ID：12451498
> 
> 赞同：0
> 
> 时间：2012-09-16T23:14:36.403
> 
> 标签：php

我正在使用 str_replace 格式化具有相对较大（我认为）字符数的字符串，但它不处理字符串。下面是我的字符串和我使用的代码

```
$formlink = str_replace('&stepvars='.$_GET['stepvars'],'',$link); 
```

字符串长度为 1004 个字符

```
?content=com_motor&folder=same&file=motor_form&step=one&stepvars=VzNOMGNERmRkR2wwYkdVOVBsTmxiR1ZqZENCVWFYUnNaU3h3Y205d2IzTmxjbDl6ZFhKdVlXMWxQVDVOZFdOb2FYSnBMRzkwYUdWeVgyNWhiV1Z6UFQ1VVpYTjBJRTkwYUdWMExHOWpZM1Z3WVhScGIyNWZjSEp2Wm1WemMybHZiajArVjJWaUlFUmxjMmxuYm1WeUxHUmhlVDArTVRjc2JXOXVkR2c5UGs5amRHOWlaWElzZVdWaGNqMCtNakF3TWl4d2FXNWZibTg5UGpFeU16UTFOaXhwWkY5dmNsOXdZWE56Y0c5eWRGOXViejArTmpVME16SXhMR1J5YVhabGNsOXNhV05sYm5ObFgyNXZQVDQyTXpJMU5ERXNlV1ZoY2w5bWFYSnpkRjlrY21sMmFXNW5YMnhwWTJWdWMyVmZhWE56ZFdWa1BUNHlNREEwTEc1MWJXSmxjbDl2Wmw5NVpXRnljMTlrY21sMmFXNW5YMlY0Y0dWeWFXVnVZMlU5UGpVc1pXMWhhV3hmWVdSa2NtVnpjejArYzI1bmRXMXZRR2R0WVdsc0xtTnZiU3h0YjJKcGJHVmZiblZ0WW1WeVBUNHdOelF4TlRJMk15eHdYMjlmWW05NFBUNHhNalUwZEdWemRDeHdiM04wWVd4ZlkyOWtaVDArTVRJMU5EYzRMSFJ2ZDI0OVBrNWhhWEp2WW1rc1pHOWZlVzkxWDE5aGJtUnZjbDloYm5sZmIzUm9aWEpmY0dWeWMyOXVjMTkzYUc5ZmRHOWZlVzkxY2w5cmJtOTNiR1ZrWjJWZmQybHNiRjlrY21sMlpWOTBhR1ZmWTJGeVgxOXpYMTlmYzNWbVptVnlYMlp5YjIxZlpHVm1aV04wYVhabFgzWnBjMmx2Ymw5dmNsOW9aV0Z5YVc1blgyOXlYMkZ1ZVY5d2FIbHphV05oYkY5cGJtWnBjbTFwZEhsZmFXNWpiSFZrYVc1blgyWnBkSE05UGpBc1czeHpkSEF4WFE9PQ%3D%3D&msgvalid=Now_enter_your_vehicle_details 
```

请帮助我了解我哪里出错了。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T23:20:27.550

可能发生的情况是您的 URL 中包含转义字符（%3D%3D），而您的 $_GET 是未转义字符，因此它们不匹配。str_replace 可以毫无问题地处理非常大的字符串。

如果您想摆脱该值，只需执行以下操作：

```
$query_params = $_GET;
unset($query_params['stepvars']);
$new_link = http_build_query($query_params); 
```

即使参数是第一个参数 (?stepvars=...)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T23:21:01.367

从总体上看，那个字符串不是很大，这不太可能是这里问题的根源。

更有可能的是，问题是由`%3D%3D`字符串末尾的引起的，如果是您要查找的内容，`$_GET`它将转换为`==`将导致字符串不匹配的字符串。`%3D%3D`

# delphi - 如何在向上或向下拖动项目时使列表视图滚动？

> ID：12451500
> 
> 赞同：5
> 
> 时间：2012-09-16T23:14:55.767
> 
> 标签：delphi, listview, drag-and-drop

我正在使用`TListView`具有拖放功能的产品，可以将一个或多个项目拖放到另一个项目中，作为一种合并形式。当您将项目拖动到控件的顶部或底部时，我需要它自动向上或向下滚动，但它不会。这同样适用于在某些视图样式中向右或向左滚动。我怎样才能让它在用户拖动项目的方向上自动滚动？

PS：我也启用了 VCL 主题

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T00:22:41.267

没有进行太多测试，但是下面的尝试在将项目拖动到其父项的控件之外（在示例中为表单）时启用计时器，并且计时器事件测试光标位置以找出是否有滚动消息应该发送到列表视图。

```
procedure TForm1.FormCreate(Sender: TObject);
begin
  Timer1.Enabled := False;
  Timer1.Interval := 500;
end;

procedure TForm1.FormDragOver(Sender, Source: TObject; X, Y: Integer;
  State: TDragState; var Accept: Boolean);
begin
  if Source = ListView1 then 
    Timer1.Enabled := True
  else
    Timer1.Enabled := False;
end;

procedure TForm1.Timer1Timer(Sender: TObject);
var
  Pt: TPoint;
begin
  // Stop timer and exit if not dragging any more
  if not ListView1.Dragging then begin
    Timer1.Enabled := False;
    Exit;
  end;

  Pt := ListView1.ScreenToClient(Mouse.CursorPos);
  if Pt.Y < 0 then
    ListView1.Perform(WM_VSCROLL, SB_LINEUP, 0)
  else
    if Pt.Y > ListView1.ClientHeight then
      ListView1.Perform(WM_VSCROLL, SB_LINEDOWN, 0)
    else
      Timer1.Enabled := False;
end;

procedure TForm1.FormDragDrop(Sender, Source: TObject; X, Y: Integer);
begin
  Timer1.Enabled := False;
end; 
```

如果它工作正常，您也可以合并水平滚动。

# iphone - NSInvalidArgumentException'，原因：'无法使用 nil 模型创建 NSPersistentStoreCoordinator'

> ID：12451505
> 
> 赞同：0
> 
> 时间：2012-09-16T23:15:30.553
> 
> 标签：iphone, sdk, xcode4.3

我有一个非常奇怪的问题.. 我的应用程序放在一个文件夹中，我保存所有项目。如果我从该位置打开应用程序（使用 Xcode 4.5），一切正常，应用程序工作正常，但如果我将应用程序的副本放在桌面上并尝试打开应用程序以在我的 iPhone 上进行测试，则错误是出来（NSInvalidArgumentException'，原因：'无法使用 nil 模型创建 NSPersistentStoreCoordinator'）

我已经尝试重置和清理一切都是可能的，但没有什么不工作？

这件事让我发疯？

有任何想法吗？

谢谢你的帮助..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-24T08:42:55.893

在代码行 stringByAppendingPathComponent 中更改数据库的名称。将值从 dummy.sqlite 更改为 anyOther.sqlite。这是重新创建数据库的正确解决方案。

```
- (NSPersistentStoreCoordinator *)persistentStoreCoordinator {
if (persistentStoreCoordinator != nil) {
    return persistentStoreCoordinator;
}
NSURL *storeUrl = [NSURL fileURLWithPath: [[self applicationDocumentsDirectory]
                                           stringByAppendingPathComponent: @"dummy.sqlite"]];
NSError *error = nil;
persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc]
                              initWithManagedObjectModel:[self managedObjectModel]];
if(![persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType
                                             configuration:nil URL:storeUrl options:nil error:&error]) {
    /*Error for store creation should be handled in here*/
}

return persistentStoreCoordinator; 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-14T02:00:37.610

它相对简单。

如果您有一个**没有**版本的 xcdatamodel 文件：在您的 managedObjectModel 声明中使用扩展名“mom”。如果你的 xcdatamodel 有版本，你应该使用“momd”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-11T02:49:21.347

我有同样的问题。发现在 AppDelegate.m 中，我已将模型 URL 链接到以前不再使用的模型名称，因此在尝试与数据模型交互时，它会抛出此错误。

希望对遇到同样问题的人有所帮助。

干杯

# java - 如何在 Tomcat 中保留主体信息（即 setPrincipal？）

> ID：12451507
> 
> 赞同：0
> 
> 时间：2012-09-16T23:16:01.573
> 
> 标签：java, tomcat, servlets, principal

我正在尝试构建第二种用户登录方式以及tomcat领域功能。这意味着未经身份验证的用户可以：
1\. 通过调用领域
登录 2\. 提供有效令牌并自动登录

我正在尝试实现 2。所以我使用过滤器将请求重定向到包装器中。在该包装器中，我覆盖了，`getUserPrincipal`以便可以创建该用户的主体。然后容器将识别主体并让用户进入而不重定向到登录页面。

但是现在的问题是：似乎并非所有请求都会获得正确的主体。关于 servlet 的请求以及 servlet 是否`Dispatcher`用于转发请求将获得主体集。使用简单链接或 servlet`sendRedirect`不会调用该`getUserPrincipal`方法，因此即使用户使用方法 2 登录也会出现登录页面。

这就像为该用户创建的主体是“临时的”。我想知道是否有办法将主体存储在会话中或某处，以便容器知道用户已通过身份验证。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T03:06:01.313

我确实做到了这一点，但我是通过使用 Tomcat JAAS 领域并提供两个 LoginModules 来做到的，一个用于票证，一个用于用户名/密码。需要进行一些集成才能防止在票证登录时获得登录页面。实际上，在我的系统中，有第三种登录方法，通过有效的客户端证书，还有第四个登录模块，用于为用户查找和分配角色，但是他是由前三个模块之一建立的。

我参与了一个名为 AuthenticRoast 的 Google 代码项目，在这方面有所帮助。与 Tomcat 6 和 7 以及 Glassfish 集成，尽管我没有尝试过。

# java - Google-App-Engine 中的预定电子邮件 - Java

> ID：12451508
> 
> 赞同：0
> 
> 时间：2012-09-16T23:16:14.627
> 
> 标签：java, google-app-engine, email

什么应用引擎 API 将用于发送预定的电子邮件？我希望应用程序每周发送电子邮件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-16T23:19:42.193

调度见：

[https://developers.google.com/appengine/docs/java/config/cron](https://developers.google.com/appengine/docs/java/config/cron)

例如：

```
<cron>
 <url>/reports/weekly</url>
 <description>Mail out a weekly report</description>
 <schedule>every saturday 09:00</schedule>
 <timezone>Asia/Tokyo</timezone>
</cron> 
```

然后配置一个 servlet 来处理对*/reports/weekly*的请求。如果您有很多要发送，您可能需要设置处理 servlet 以使用[taskQueue](https://developers.google.com/appengine/docs/java/taskqueue/)

邮寄见：

[https://developers.google.com/appengine/docs/java/mail/](https://developers.google.com/appengine/docs/java/mail/)

# javascript - 在由字符串构成的 DOM 上调用 jQuery.remove()

> ID：12451515
> 
> 赞同：3
> 
> 时间：2012-09-16T23:18:36.633
> 
> 标签：javascript, jquery, html, dom

```
html = '<h1>foo</h1><p>bar</p>';
virtual_dom = $(html);
console.log(virtual_dom);
// logs a data structure recognizable as a DOM with the h1 and p from the string 
```

jQuery 是否提供了一种从 中删除段落的方法`virtual_dom`，这样`console.log(virtual_dom)`将记录一个只有一个`h1`标签的 DOM，就像`$('p').remove()`但影响`virtual_dom`而不是浏览器呈现的实际文档？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T23:21:09.247

使用[`.filter()`](http://api.jquery.com/filter/)，例如：

```
virtual_dom = $(html).filter(":not(p)"); 
```

这*将从*`p`您的`html`.

**[演示](http://jsfiddle.net/N7UPN/)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T23:30:12.383

您的虚拟 DOM 是可遍历的，并且每个标记节点都是可移动的。

在 FireBug 或浏览器控制台中进行测试

```
var html = $('<div />');
html.append('<p /><p />').children(':last').text('Test');
console.log(html.html());
html.children(':first').remove();
console.log(html.html()); 
```

# android - Android 表格布局行填充

> ID：12451518
> 
> 赞同：6
> 
> 时间：2012-09-16T23:19:20.180
> 
> 标签：android, android-tablelayout

我想在行的右侧创建一个带有按钮的表格，如下所示。我想为每一行的右侧设置填充，但这会“吃掉”最右边的按钮。有没有办法在不影响按钮显示的情况下进行填充？

![表格布局的屏幕截图](../Images/72c80754f4c6e10e2eb8b865b07f88ca.png)

这是我的布局 xml 代码：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:padding="10dp" >

<TableLayout 
    android:id="@+id/tbl_test"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="#000000"
    android:orientation="vertical"
    android:layout_marginTop="1dp"
    android:layout_marginBottom="1dp"
    android:stretchColumns="1"
    >

     <TableRow android:background="#ffffff" android:layout_margin="1dp">

        <TextView android:text="Col 1" android:layout_column="0" />
        <TextView android:text="Col 2" android:layout_column="1" />
        <TextView android:text="Col 3" android:layout_column="2" />
        <TextView android:text="Col 4" android:layout_column="3" />

    </TableRow>

     <TableRow
         android:background="#ffffff"
         android:layout_marginLeft="1dp"
         android:layout_marginRight="1dp"
         android:layout_marginBottom="1dp">

         <TextView android:text="r1" android:layout_column="0" />
         <TextView android:text="padding right 0dp" android:layout_column="1" />
         <Button android:text="edit" />
        <Button android:text="delete" />

    </TableRow>

     <TableRow
         android:background="#ffffff"
         android:layout_marginLeft="1dp"
         android:layout_marginRight="1dp"
         android:layout_marginBottom="1dp"
         android:paddingRight="2dp">

        <TextView android:text="r2" android:layout_column="0" />
        <TextView android:text="padding right 1dp" android:layout_column="1" />
        <Button android:text="edit" />
        <Button android:text="delete" />

    </TableRow>

     <TableRow
         android:background="#ffffff"
         android:layout_marginLeft="1dp"
         android:layout_marginRight="1dp"
         android:layout_marginBottom="1dp"
         android:paddingRight="3dp">

        <TextView android:text="r3" android:layout_column="0" />
        <TextView android:text="padding right 2dp" android:layout_column="1" />
        <Button android:text="edit" />
        <Button android:text="delete" />

    </TableRow>

     <TableRow
         android:background="#ffffff"
         android:layout_marginLeft="1dp"
         android:layout_marginRight="1dp"
         android:layout_marginBottom="1dp"
         android:paddingRight="4dp">

        <TextView android:text="r4" android:layout_column="0" />
        <TextView android:text="padding right 3dp" android:layout_column="1" />
        <Button android:text="edit" />
        <Button android:text="delete" />

    </TableRow>

</TableLayout>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T12:37:34.377

尝试

```
android:stretchColumns="0,1,2"
```

这将解决之后的问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T08:36:03.913

我不知道为什么会发生剪裁问题，但修复它并获得相同外观的一种简单方法是从 中删除`paddingRight`属性，并在行的最后一项上`TableRows`添加属性（设置为填充值） `layout_marginRight`，删除`Button`。

# php - PDO - 按价格升序或降序排列

> ID：12451519
> 
> 赞同：0
> 
> 时间：2012-09-16T23:19:34.330
> 
> 标签：php, mysql, search, pdo, sql-order-by

目前我有一个简单的搜索查询，其工作方式如下：

```
$username = $_SESSION['username'];
$chosencategory = $_GET['category'];
$price = $_GET['price'];

$search = $_GET['search'];
$terms = explode(" ", $search);

if ($price && $chosencategory){
        $sql = "SELECT * FROM people WHERE MATCH (lname,fname) AGAINST (:search IN BOOLEAN MODE) AND category='$chosencategory' ORDER BY price $price";
    $q   = $conn->prepare($sql) or die("failed!");
    $q->bindValue(':search',"%".$search."%",PDO::PARAM_STR);
    $q->execute();
    } 
```

例如，当用户选择“显示价格从最低到最高”时，发送到`$_GET['price']`= ASC 的值，但是我不确定这是否是对结果进行排序的安全方法，有没有人有更好的方法？

这种方法也不是最好的，因为当用户选择“显示价格从最低到最高”之类的排序选项时，下拉框会回显已发送到 $_GET['price'] 的值，即“ASC”所以在表单发送后的下拉框显示为 ASC！

抱歉，如果这令人困惑，请发表评论，如果您希望我重新解释这一点，非常感谢任何帮助或建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T14:30:14.853

与您的值绑定和 sql 注入相关，您还应该在使用前检查是否设置了值。如果启用`error_reporting(E_ALL)`，您会看到很多未定义的警告。以下是一些提示/更改：

```
<?php 
// Check and set username
$username = (isset($_SESSION['username']) ? $_SESSION['username'] : 'guest');

// Check and set category
$category = (!empty($_GET['category']) ? $_GET['category'] : null);

// Check and set search
if(!empty($_GET['search'])){
    $search = $_GET['search'];
    $terms  = explode(" ", $search);
}else{
    $search = null;
    $terms  = null;
}

// Check that $_GET['price'] is ASC if not set to DESC
// as static values its ok to directly put in the query 
if(isset($_GET['price']) && $_GET['price'] == 'ASC'){
    $price = 'ASC';
}else{
    $price = 'DESC';
}

if ($category !== null && $search !== null){

    $sql = "SELECT   *
            FROM     people
            WHERE    MATCH (lname,fname) AGAINST (:search IN BOOLEAN MODE)
            AND      category = :category
            ORDER BY price ".$price;

    $q = $conn->prepare($sql);
    // Bind the params to the placeholders
    $q->bindParam(':search', $search, PDO::PARAM_STR);
    $q->bindParam(':category', $category, PDO::PARAM_STR);
    $q->execute();
    // Get result
    $result = $q->fetchAll(PDO::FETCH_ASSOC);
}
?> 
```

# objective-c - 如何在 ObjC 中对数组进行排序

> ID：12451525
> 
> 赞同：-1
> 
> 时间：2012-09-16T23:20:47.867
> 
> 标签：objective-c, nsarray, nssortdescriptor

我正在寻找一个数组（mainArray），包含几个数组（array1,2,3,...）
比较器（NSnumber）位于每个array1,2,3中的index8 ...

我应该使用哪种方法？

你有什么解决办法吗？
非常感谢

干杯

蒂姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:38:09.643

您可以对`NSMutableArray`.

```
// Create an array of arrays of integers using the new array and number literal syntax 
NSMutableArray* arrayOfArrays = 
    [NSMutableArray arrayWithArray:@[ @[ @0, @1, @2 ], @[ @1, @2, @3 ] ];

// The key on which to sort is located at this index in each array
NSUInteger sortKeyIndex = 2;

// Sort the array of arrays using a stable sort. This means that arrays which considered
// equal in arrayOfArrays will retain their relative positions in the sorted arrayOfArrays
// Use a comparator block to sort arrayOfArrays. 
[arrayOfArrays sortWithOptions:NSSortStable 
               usingComparator:^(id lhs, id rhs) {
    // Cast the two elements of arrayOfArrays being compared to their actual type (NSArray)
    NSArray* lhsArray = lhs;
    NSArray* rhsArray = rhs;

    // Extract the element of each array which is used as a sort key
    // This makes use of the new array index syntax
    NSNumber* lhsNumber = lhsArray[sortKeyIndex];
    NSNumber* rhsNumber = rhs[sortKeyIndex];

    // Unbox the integers from each NSNumber to get the actual values of the sort keys
    NSInteger lhsSortKey = [lhs integerValue];
    NSInteger rhsSortKey = [rhs integerValue];

    // Compare the two sort keys
    if (lhsSortKey < rhsSortKey) {
        return NSOrderedAscending;
    } else if (lhsSortKey > rhsSortKey) {
        return NSOrderedDescending;
    } else {
        return NSOrderedSame;
    }
}]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T23:35:14.507

如果使用比较器对 NSArray 进行排序，则可以完全控制每个比较。
所以你可以使用：

```
array=[array sortedArrayUsingComparator: ^ NSComparisonResult (id obj1, id obj2)
{
    // obj1 and obj2 are two arrays
    NSNumber* n1=[obj1 objectAtIndex:8];
    NSNumber* n2=[obj2 objectAtIndex: 8];
    <compare the numbers and return NSOrderedAscending, NSOrderedSame or NSOrderedDescending>
}]; 
```

# python - Python 在 lambda 中尝试 Catch 块

> ID：12451531
> 
> 赞同：62
> 
> 时间：2012-09-16T23:22:24.817
> 
> 标签：python, lambda, try-catch

是否可以在 lambda 函数中使用 try catch 块。我需要 lambda 函数将某个变量转换为整数，但并非所有值都能够转换为整数。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2012-09-16T23:23:24.340

没有。Python lambda 只能是一个表达式。使用命名函数。

写一个泛型函数来转换类型很方便：

```
def tryconvert(value, default, *types):
    for t in types:
        try:
            return t(value)
        except (ValueError, TypeError):
            continue
    return default 
```

然后你可以写你的 lambda：

```
lambda v: tryconvert(v, 0, int) 
```

您也可以编写`tryconvert()`它*返回*一个接受要转换的值的函数；那么你不需要lambda：

```
def tryconvert(default, *types):
    def convert(value):
        for t in types:
            try:
                return t(value)
            except (ValueError, TypeError):
                continue
        return default
    # set name of conversion function to something more useful
    namext = ("_%s_" % default) + "_".join(t.__name__ for t in types)
    if hasattr(convert, "__qualname__"): convert.__qualname__ += namext
    convert.__name__ += namext
    return convert 
```

现在`tryconvert(0, int)`返回一个函数，该函数`convert_0_int`接受一个值并将其转换为整数，`0`如果无法完成则返回。您可以立即使用此功能（不保存副本）：

```
mynumber = tryconert(0, int)(value) 
```

或者保存它以便以后调用它：

```
intconvert = tryconvert(0, int)
# later...
mynumber = intconvert(value) 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-09-16T23:25:15.647

在这种特定情况下，您可以避免使用这样的`try`块：

```
lambda s: int(s) if s.isdigit() else 0 
```

如果的*所有*字符都是数字，则[`isdigit()`string 方法](http://docs.python.org/library/stdtypes.html#str.isdigit)返回 true 。（如果您需要接受负数，则必须进行一些额外的检查。）*`s`*

 ** * *

## 回答 #3

> 赞同：5
> 
> 时间：2020-02-28T21:31:38.833

# 是的，有可能

我把这段小代码放在一起来演示捕获异常并在 lambda 中对它们做出反应的可能性。它相当初级，或多或少地用作概念证明。

### 例子

```
>>> print_msg = lambda msg, **print_kwargs: \
...   begin(
...     print, msg, end='... ', **print_kwargs
...   ).\
...   rescue(
...     (TypeError, AttributeError),
...     lambda exc: print(f'just caught "{exc}"! how fun!')
...   ).\
...   ensure(print, 'ok done.')()

>>> print_msg('check')
check... ok done.

>>> print_msg('check', file=1)
just caught "'int' object has no attribute 'write'"! how fun!
ok done.

>>> print_msg('check', sep=1)
just caught "sep must be None or a string, not int"! how fun!
ok done. 
```

### 一个更实际的例子

```
modules = filter(None, (
  begin(importlib.import_module, modname).rescue(lambda exc: None)()
  for modname in module_names
)) 
```

## 代码

```
from typing import Iterable

class begin:

  def __init__(self, fun, *args, **kwargs):
    self.fun = fun
    self.args = args
    self.kwargs = kwargs

    self.exception_types_and_handlers = []
    self.finalize = None

  def rescue(self, exception_types, handler):
    if not isinstance(exception_types, Iterable):
      exception_types = (exception_types,)

    self.exception_types_and_handlers.append((exception_types, handler))
    return self

  def ensure(self, finalize, *finalize_args, **finalize_kwargs):
    if self.finalize is not None:
      raise Exception('ensure() called twice')

    self.finalize = finalize
    self.finalize_args = finalize_args
    self.finalize_kwargs = finalize_kwargs
    return self

  def __call__(self):
    try:
      return self.fun(*self.args, **self.kwargs)

    except BaseException as exc:
      handler = self.find_applicable_handler(exc)
      if handler is None:
        raise
      return handler(exc)

    finally:
      if self.finalize is not None:
        self.finalize()

  def find_applicable_handler(self, exc):
    applicable_handlers = (
      handler
      for exception_types, handler in self.exception_types_and_handlers
      if isinstance(exc, exception_types)
    )
    return next(applicable_handlers, None) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-09T12:15:15.173

根据您的需要，另一种方法可能是将 try:catch 保持在 lambda fn 之外

```
toint  = lambda x : int(x)
strval = ['3', '']

for s in strval:
    try:
        print 2 + toint(s)
    except ValueError:
        print 2 
```

输出：

```
5
2 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-21T06:33:55.213

虽然没有通用的方法来处理 lambda 表达式中的异常，但您可以针对至少一种异常以受限的方式实现它；`StopIteration`从表达式的一部分抛出 a并在另一部分捕获它是可以实现的；看：

```
from random import randrange

list((lambda:(yield from (randrange(0,2) or next(iter(())) for _ in (None,))))()) 
```

在哪里`next(iter(()))`举起`StopIteration`一会儿`yield from`就会抓住它；上面的表达式随机返回`[]`或`[1]`根据内部随机值（a`0`将引发异常并且 a`1`将被正常评估）。

您可以通过[http://baruchel.github.io/python/2018/06/20/python-exceptions-in-lambda/](http://baruchel.github.io/python/2018/06/20/python-exceptions-in-lambda/)了解更多信息。*

# templates - for-each 中的 XSLT 应用模板

> ID：12451533
> 
> 赞同：5
> 
> 时间：2012-09-16T23:22:38.760
> 
> 标签：templates, xslt, foreach, match, apply-templates

我有一个如下所示的 XSLT，并且想`apply-templates`在元素内部使用，`xsl:for-each`因此我不必使用“ ” XML 元素`<tr>`的信息重复该元素。`cliente`

我正在尝试但没有成功创建一个`xsl:template`并`xsl:apply-templates`放入`xsl:for-each`.

我知道我可以使用`xsl:call-template`，但是有什么方法可以`xsl:apply-templates`在里面或外面使用`for-each`吗？

关于如何做到这一点的任何想法？

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:template match="/">
      <html>
         <head><title>Informações</title></head>
         <body>
            <h1>Relação de Clientes</h1>
            <table border="2">
               <tr bgcolor="LightBlue">
                  <th>Nome</th>
                  <th>Telefone</th>
                  <th>Cidade</th>
                  <th>Estado</th>
                  <th>Crédito</th>
               </tr>
               <tr>
                  <th colspan="6" bgcolor="LightPink">Critério usado abaixo: exibir todos os elementos ordenado por nome</th>
               </tr>
               <xsl:for-each select="informacoes/cliente">
               <xsl:sort select="nome" order="ascending" />
                  <tr>
                     <td bgcolor="LightGreen"><xsl:value-of  select="nome"/></td>
                     <td><xsl:value-of  select="telefone"/></td>
                     <td><xsl:value-of select="cidade"/></td>
                     <td><xsl:value-of select="estado"/></td>
                     <td><xsl:value-of select="credito"/></td>
                  </tr>
               </xsl:for-each>
               <tr>
                  <th colspan="6" bgcolor="LightCyan"> Critério usado abaixo: exibir os clientes da cidade do Rio de Janeiro</th>
               </tr>
               <xsl:for-each select="informacoes/cliente">
                   <xsl:if test="cidade='Rio de Janeiro'">
                      <tr>
                         <td bgcolor="LightGreen"><xsl:value-of  select="nome"/></td>
                         <td><xsl:value-of  select="telefone"/></td>
                         <td><xsl:value-of select="cidade"/></td>
                         <td><xsl:value-of select="estado"/></td>
                         <td><xsl:value-of select="credito"/></td>
                      </tr>
                    </xsl:if>
                </xsl:for-each>
               <tr>
                  <th colspan="6" bgcolor="LightYellow"> Critério usado abaixo:  exibir os clientes do estado do RJ com ordenado pelo nome; </th>
               </tr>
               <xsl:for-each select="informacoes/cliente">
               <xsl:sort select="nome" order="ascending" />
               <xsl:if test="estado='RJ'">
                  <tr>
                     <td bgcolor="LightGreen"><xsl:value-of  select="nome"/></td>
                     <td><xsl:value-of  select="telefone"/></td>
                     <td><xsl:value-of select="cidade"/></td>
                     <td><xsl:value-of select="estado"/></td>
                     <td><xsl:value-of select="credito"/></td>
                  </tr>
                </xsl:if>
                  </xsl:for-each>
               <tr>
                  <th colspan="6" bgcolor="LightYellow"> Critério usado abaixo:  exibir os clientes com crédito entre 250 e 400, em ordem descendente de crédito) </th>
               </tr>
               <xsl:for-each select="informacoes/cliente">
               <xsl:sort select="credito" order="descending" />
               <xsl:if test="credito&gt;250 and credito&lt;400">
                  <tr>
                     <td bgcolor="LightGreen"><xsl:value-of  select="nome"/></td>
                     <td><xsl:value-of  select="telefone"/></td>
                     <td><xsl:value-of select="cidade"/></td>
                     <td><xsl:value-of select="estado"/></td>
                     <td><xsl:value-of select="credito"/></td>
                  </tr>
                </xsl:if>
                  </xsl:for-each>
               </table>
            </body>
         </html>
      </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T00:45:49.200

在`xsl:for-each`您迭代的地方`informacoes/cliente`，上下文节点将是当前`cliente`元素。

**为了`apply-templates`用于上下文节点，您可以`.`在您的 select 语句中使用。**例如：

```
<xsl:for-each select="informacoes/cliente">
  <xsl:sort select="nome" order="ascending" />
  <xsl:apply-templates select="."/>
</xsl:for-each> 
```

然后，创建模板以匹配`cliente`元素：

```
<xsl:template match="informacoes/cliente">
    <tr>
        <td bgcolor="LightGreen"><xsl:value-of  select="nome"/></td>
        <td><xsl:value-of  select="telefone"/></td>
        <td><xsl:value-of select="cidade"/></td>
        <td><xsl:value-of select="estado"/></td>
        <td><xsl:value-of select="credito"/></td>
    </tr>
</xsl:template> 
```

**您还可以`<xsl:if>`通过使用轴引用当前上下文节点`self::`然后在上下文节点上的谓词过滤器内应用测试条件来消除围绕您的某些项目的测试：**

```
 <xsl:for-each select="informacoes/cliente">
     <xsl:sort select="nome" order="ascending" />
     <xsl:apply-templates select="self::*[estado='RJ']"/>
  </xsl:for-each> 
```

将这些更改应用于您的示例样式表：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:template match="/">
        <html>
            <head><title>Informações</title></head>
            <body>
                <h1>Relação de Clientes</h1>
                <table border="2">
                    <tr bgcolor="LightBlue">
                        <th>Nome</th>
                        <th>Telefone</th>
                        <th>Cidade</th>
                        <th>Estado</th>
                        <th>Crédito</th>
                    </tr>
                    <tr>
                        <th colspan="6" bgcolor="LightPink">Critério usado abaixo: exibir todos os elementos ordenado por nome</th>
                    </tr>
                    <xsl:for-each select="informacoes/cliente">
                        <xsl:sort select="nome" order="ascending" />
                        <xsl:apply-templates select="."/>
                    </xsl:for-each>
                    <tr>
                        <th colspan="6" bgcolor="LightCyan"> Critério usado abaixo: exibir os clientes da cidade do Rio de Janeiro</th>
                    </tr>
                    <xsl:for-each select="informacoes/cliente">
                        <xsl:apply-templates select="self::*[cidade='Rio de Janeiro']"/>
                    </xsl:for-each>
                    <tr>
                        <th colspan="6" bgcolor="LightYellow"> Critério usado abaixo:  exibir os clientes do estado do RJ com ordenado pelo nome; </th>
                    </tr>
                    <xsl:for-each select="informacoes/cliente">
                        <xsl:sort select="nome" order="ascending" />
                        <xsl:apply-templates select="self::*[estado='RJ']"/>
                    </xsl:for-each>
                    <tr>
                        <th colspan="6" bgcolor="LightYellow"> Critério usado abaixo:  exibir os clientes com crédito entre 250 e 400, em ordem descendente de crédito) </th>
                    </tr>
                    <xsl:for-each select="informacoes/cliente">
                        <xsl:sort select="credito" order="descending" />
                        <xsl:apply-templates select="self::*[credito&gt;250 and credito&lt;400]"/>
                    </xsl:for-each>
                </table>
            </body>
        </html>
    </xsl:template>

    <xsl:template match="informacoes/cliente">
        <tr>
            <td bgcolor="LightGreen"><xsl:value-of  select="nome"/></td>
            <td><xsl:value-of  select="telefone"/></td>
            <td><xsl:value-of select="cidade"/></td>
            <td><xsl:value-of select="estado"/></td>
            <td><xsl:value-of select="credito"/></td>
        </tr>
    </xsl:template>
</xsl:stylesheet> 
```

正如 Dimitre Novatchev 的回答所示，您可以通过消除`xsl:for-each`语句并调整您的`xsl:apply-templates`select 语句来进一步简化样式表；`xsl:sort`在必要时应用应用模板的内部，以确保`cliente`以所需的顺序处理选定的元素。

```
<xsl:apply-templates select="informacoes/cliente[estado='RJ']">
  <xsl:sort select="nome" order="ascending" />
</xsl:apply-templates> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T01:42:34.077

**只需更换**：

```
 <xsl:for-each select="informacoes/cliente"> 
           <xsl:sort select="nome" order="ascending" /> 
              <tr> 
                 <td bgcolor="LightGreen"><xsl:value-of  select="nome"/></td> 
                 <td><xsl:value-of  select="telefone"/></td> 
                 <td><xsl:value-of select="cidade"/></td> 
                 <td><xsl:value-of select="estado"/></td> 
                 <td><xsl:value-of select="credito"/></td> 
              </tr> 
           </xsl:for-each> 
```

**与**：

```
<xsl:apply-templates select="informacoes/cliente">
  <xsl:sort select="nome" order="ascending" />
</xsl:apply-templates> 
```

**同样，替换**：

```
 <xsl:for-each select="informacoes/cliente">       
               <xsl:if test="cidade='Rio de Janeiro'">       
                  <tr>       
                     <td bgcolor="LightGreen"><xsl:value-of  select="nome"/></td>       
                     <td><xsl:value-of  select="telefone"/></td>       
                     <td><xsl:value-of select="cidade"/></td>       
                     <td><xsl:value-of select="estado"/></td>       
                     <td><xsl:value-of select="credito"/></td>       
                  </tr>       
                </xsl:if>       
            </xsl:for-each> 
```

**与**：

```
<xsl:apply-templates select="informacoes/cliente[cidade='Rio de Janeiro']"/> 
```

**同样，替换**：

```
 <xsl:for-each select="informacoes/cliente">           
           <xsl:sort select="nome" order="ascending" />           
           <xsl:if test="estado='RJ'">           
              <tr>           
                 <td bgcolor="LightGreen"><xsl:value-of  select="nome"/></td>           
                 <td><xsl:value-of  select="telefone"/></td>           
                 <td><xsl:value-of select="cidade"/></td>           
                 <td><xsl:value-of select="estado"/></td>           
                 <td><xsl:value-of select="credito"/></td>           
              </tr>           
            </xsl:if>           
              </xsl:for-each> 
```

**和：**

```
<xsl:apply-templates select="informacoes/cliente[estado='RJ']">
  <xsl:sort select="nome" order="ascending" />
</xsl:apply-templates> 
```

**最后替换**：

```
 <xsl:for-each select="informacoes/cliente">               
           <xsl:sort select="credito" order="descending" />               
           <xsl:if test="credito&gt;250 and credito&lt;400">               
              <tr>               
                 <td bgcolor="LightGreen"><xsl:value-of  select="nome"/></td>               
                 <td><xsl:value-of  select="telefone"/></td>               
                 <td><xsl:value-of select="cidade"/></td>               
                 <td><xsl:value-of select="estado"/></td>               
                 <td><xsl:value-of select="credito"/></td>               
              </tr>               
            </xsl:if>               
              </xsl:for-each> 
```

**与**：

```
<xsl:apply-templates select="informacoes/cliente[credito >250 and 400 > credito]">
  <xsl:sort select="credito" order="descending" />
</xsl:apply-templates> 
```

**然后添加这个简单的模板**：

```
<xsl:template match="informacoes/cliente">
 <tr>               
  <td bgcolor="LightGreen"><xsl:value-of  select="nome"/></td>               
  <td><xsl:value-of  select="telefone"/></td>               
  <td><xsl:value-of select="cidade"/></td>               
  <td><xsl:value-of select="estado"/></td>               
  <td><xsl:value-of select="credito"/></td>               
 </tr>               
</xsl:template> 
```

**您的完整 XSLT 代码现在变为**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:template match="/">
      <html>
         <head><title>Informações</title></head>
         <body>
            <h1>Relação de Clientes</h1>
            <table border="2">
               <tr bgcolor="LightBlue">
                  <th>Nome</th>
                  <th>Telefone</th>
                  <th>Cidade</th>
                  <th>Estado</th>
                  <th>Crédito</th>
               </tr>
               <tr>
                  <th colspan="6" bgcolor="LightPink">Critério usado abaixo: exibir todos os elementos ordenado por nome</th>
               </tr>
                             <xsl:apply-templates select="informacoes/cliente">
                              <xsl:sort select="nome" order="ascending" />
                             </xsl:apply-templates>
                             <tr>
                  <th colspan="6" bgcolor="LightCyan"> Critério usado abaixo: exibir os clientes da cidade do Rio de Janeiro</th>
               </tr>
                 <xsl:apply-templates select="informacoes/cliente[cidade='Rio de Janeiro']"/>
                 <tr>
                  <th colspan="6" bgcolor="LightYellow"> Critério usado abaixo:  exibir os clientes do estado do RJ com ordenado pelo nome; </th>
               </tr>
                             <xsl:apply-templates select="informacoes/cliente[estado='RJ']">
                              <xsl:sort select="nome" order="ascending" />
                             </xsl:apply-templates>
               <tr>
                  <th colspan="6" bgcolor="LightYellow"> Critério usado abaixo:  exibir os clientes com crédito entre 250 e 400, em ordem descendente de crédito) </th>
               </tr>
                             <xsl:apply-templates select="informacoes/cliente[credito >250 and 400 > credito]">
                              <xsl:sort select="credito" order="descending" />
                             </xsl:apply-templates>
              </table>
            </body>
         </html>
      </xsl:template>

            <xsl:template match="informacoes/cliente">
             <tr>
              <td bgcolor="LightGreen"><xsl:value-of  select="nome"/></td>
              <td><xsl:value-of  select="telefone"/></td>
              <td><xsl:value-of select="cidade"/></td>
              <td><xsl:value-of select="estado"/></td>
              <td><xsl:value-of select="credito"/></td>
             </tr>
            </xsl:template>
</xsl:stylesheet> 
```

# jquery - 显示一个类的一个元素并隐藏所有其他元素

> ID：12451548
> 
> 赞同：1
> 
> 时间：2012-09-16T23:24:45.993
> 
> 标签：jquery, class, animation, navigation, show-hide

在显示正确的元素之前，使用以下函数隐藏类的所有元素。但是我在后面的元素上得到了双重动画。

[http://jsfiddle.net/cR9bJ/16/](http://jsfiddle.net/cR9bJ/16/)

函数由 h2 调用。

功能是：

```
function showSubList(obj) {
var elem = obj;
$('.sublist').hide(function() {
    $(elem).parent().children('.sublist').show();
});
}​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T23:34:53.687

首先隐藏元素，然后显示您想要的元素。

```
function showSubList(obj) {
    $('.sublist').hide(300);
    $(obj).parent().children('.sublist').show();
};​ 
```

这修复了双重动画。

### [演示](http://jsfiddle.net/FranWahl/cR9bJ/22/)

# javascript - Highcharts + Plotband 工具提示悬停 + 默认样式

> ID：12451549
> 
> 赞同：6
> 
> 时间：2012-09-16T23:24:58.227
> 
> 标签：javascript, svg, tooltip, highcharts

当您将鼠标悬停在绘图带上时，我正在尝试找到显示工具提示的最简单方法。事件部分很好，我可以访问鼠标悬停和移出，但我需要找到一种方法以与 Highcharts 的默认外观相同的样式显示工具提示。

这是一个[简单的例子](http://jsfiddle.net/L3AQG/)。我需要文本“在工具提示中悬停时显示我”显示为工具提示，其样式与基于鼠标坐标的 Highcharts 默认某处相同？

我查看了[文档](http://api.highcharts.com/highcharts#xAxis.plotBands)，但找不到任何帮助。

有任何想法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-01-22T08:13:16.437

我根据 Gregs 的答案制作了另一个变体，但改用了情节线，因为那是我需要的。我想它也可以很容易地翻译成 plotBands。

此变体也适用于事件，但显示另一个 div 而不是依赖特定的隐藏系列。

该示例可以在[JSFiddle](http://jsfiddle.net/xL7us/)中找到。

所以工具提示被添加到与图表相同的容器中

```
<div id="tooltip" class="thetooltip">
    <p id="tooltiptext" style="margin:0">default</p>
</div> 
```

当用户将鼠标悬停在情节线上时，会触发一个事件，该事件会显示工具提示以及附加的工具提示

```
var $tooltip = $('#tooltip');
$tooltip.hide();
var $text = $('#tooltiptext');
displayTooltip = function (text, left) {
    $text.text(text);
    $tooltip.show();
    $tooltip.css('left', parseInt(left)+24 + 'px');
};
var timer;
hideTooltip = function (e) {
    clearTimeout(timer);
    timer = setTimeout(function () {
        $tooltip.fadeOut();
    }, 5000);
}; 
```

然后每个情节线都定义了一个附加选项、工具提示文本和用于显示上面 div 的事件。

```
plotLines: [{
    tooltipText: 'hello',
    value: Date.UTC(2011, 2, 28, 0, 1, 1),
    color: '#ff6666',
    dashStyle: 'solid',
    width: 3,
    events: {
        mouseover: function (e) {
            displayTooltip(this.options.tooltipText, this.svgElem.d.split(' ')[1]);
        },
        mouseout: hideTooltip
    }
} 
```

tooltipText 不是 highcharts api 的一部分，但在定义时可通过元素上的 options 属性使用。

工具提示的 css 可以定义为类似于 highcharts 的默认 css，只需模仿 css：

```
.thetooltip {
    border: 1px solid #2f7ed8;
    background-color: #fff;
    opacity: 0.8500000000000001;
    padding: 4px 12px;
    border-radius: 3px;
    position: absolute;
    top:100px;
    box-shadow: 1px 1px 3px #666;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-17T00:35:31.023

这是我在[JSFiddle](http://jsfiddle.net/82Q4D/)中整理的一个解决方案，尽管它有点小技巧。

将以下行添加到 mouseover 事件：

```
chart.tooltip.refresh(chart.series[1].points[2]); 
```

这将显示隐藏系列中适当放置的点的工具提示。

然后自定义工具提示格式化程序返回所需的文本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-08-16T09:41:27.287

另一种解决方案是使用带有“useHTML:true”标志和 CSS 悬停的 plotBands/plotLines 的“label”属性。

```
xAxis: {
//...code    
   plotLines: [{
      //...code
      dashStyle: 'Dash',
      color: '#000000', 
      width: 2,
      label: {
          text: `<div class="plotline">
                     <div id="custom-tooltip" class="thetooltip">
                         My custom tooltip!
                     </div>
                 </div>`,
          useHTML: true,
      }
   }]
} 
```

修改后的 CSS 将是：

```
.thetooltip {
    display: none; //the main change
    border: 1px solid #2f7ed8;
    background-color: #fff;
    opacity: 0.8500000000000001;
    padding: 4px 12px;
    border-radius: 3px;
    position: absolute;
    top:100px;
    box-shadow: 1px 1px 3px #666;
} 
```

当然在情节线类中：

```
.plotline {
     &:hover {
       .thetooltip {
          display: block;
        }
     }
} 
```

在我看来，这是一个更健壮的解决方案——首先，它是一个 CSS 解决方案，而不是 JS，从 UX/UI 的角度来看，它比古怪的 JS 更流畅（只需尝试设置正确的超时时间！）

# c++ - c++简单链表修改

> ID：12451552
> 
> 赞同：0
> 
> 时间：2012-09-16T23:25:24.213
> 
> 标签：c++

我想做的是修改简单的链表，到目前为止我有一个输入名称的功能，然后以相反的顺序输出，但是我在特定位置更改字符时遇到问题。

主要代码：

```
#include "list.h"
#include "string"
using namespace std;
int main(){
    cout<<"What is your name \n";
    string name;
    getline(cin,name);

    Node *list;

    list = new_list();                           
    for (int i=0; i<name.length();i++){
    insert_front(&list,name[i]);
    }                              
    print_list(list);                    
    int p;
    char x;
    cout<<"Change the position: ";
    cin>>p;
    cout<<"\n to the character " ;
    cin>>x;
    change_char(list, x, p);
    print_list(list);
    return 0;
} 
```

和我的 list.cpp

```
#include "list.h"                            
Node* new_list(){
    Node* list = 0;
    return list;
}
void insert_front(Node** plist,char x){
    Node* t;
    t = new Node;
    t->x = x;
    t->next = *plist;
    *plist = t;
    return;
}
void print_list(Node* list){
    Node* p;
    p = list;
    if(p == 0)
        cout << "--- empty list ---" << endl;
    while(p !=0){
        cout << p->x<<" -- ";
        p = p->next;
    }
    cout << endl;
}
void delete_front(Node** plist){
    Node* t;
    if( !is_empty(*plist) ){                            
        t = (*plist)->next;
        *plist = (*plist)->next;
        delete t;
    }
}
void delete_list(Node** plist){
    while( !is_empty(*plist) )                         
        delete_front(plist);
}
bool is_empty(Node* list){
    return (list == 0);                            
}
void change_char(Node* plist, char x, int p){
    Node* s;
    s=(plist->next);
      cout<<s<<endl;
      cout<<plist<<endl;
 return; 
```

我很想知道如何在特定位置改变角色。change_char 给了我一个地址，但不是一个列表，我不确定出了什么问题。

另外，字符的变化与字符的插入和删除有何不同。谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:34:12.400

插入 = 将一个字符附加到列表中；删除 = 从列表中删除一个字符

我希望这些是显而易见的。

改变一个位置需要你将列表走到那个位置。您可以选择迭代或递归地执行此操作。假设您的位置是基于 1 的（而不是基于 0 的（并且此代码未经过测试编译，因此使用风险自负）：

```
void change_char(Node* plist, char x, int p)
{
    Node* s = plist;
    for (int i=1; i<p && 0!=s;i++)
       s = s->next;
    if (0 != s)
       s->x = x;
} 
```

# c# - C# Action +=函数的C++方式？

> ID：12451554
> 
> 赞同：3
> 
> 时间：2012-09-16T23:26:04.010
> 
> 标签：c#, c++, c++11, lambda, action

在 C# 中，我们可以说：

```
Action act = ()=> {/*stuff*/}; 
act += ()=> {/*another stuff*/}` 
```

然后调用`act()`.

我想知道如何在 C++ 中做这样的事情（现在使用 lambdas 将非常有用，如果可能的话不使用 Boost/Qt 信号）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-16T23:39:19.073

也许与`std::function`s：

```
std::vector<std::function<void()>> act;

act.emplace_back([] { /* stuff */ });
act.emplace_back([] { /* more stuff */ }); 
```

致电：

```
for (auto & f : act) { f(); } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-16T23:39:04.150

`std::vector<std::function<void()>>`通过用 lambda 填充 a 并调用每个函数对象，您可以相当容易地编写这样的东西。

```
#include <vector>
#include <functional>
#include <utility>

// warning: very crude and likely with typos / bugs
template<class Sig>
struct Action{
  template<typename Functor>
  void operator+=(Functor&& f)
  { _funcs.emplace_back(std::forward<Functor>(f)); }
  template<class... Args>
  void operator()(Args&&... args) const{
    for(auto& f : _funcs)
      f(args...);
  }
private:
  std::vector<std::function<Sig>> _funcs;
};

// ...
Action<void()> act;
act += []{ /*...*/ };
act += []{ /*...*/ };
act(); // invoke all handlers in order 
```

但是，据我所知，C# 还允许您使用*删除*处理程序`-=`，这在 C++ 中并不容易完成。您需要返回一个令牌`+=`，可以从中传递该令牌`-=`以删除该特定处理程序。

# java - Google App Engine (Java) 中的 HTML 格式电子邮件

> ID：12451555
> 
> 赞同：2
> 
> 时间：2012-09-16T23:26:07.480
> 
> 标签：java, google-app-engine, email

如何在 Google App Engine 中发送 HTML 格式的电子邮件？我只需要一些概述或文档，而不是代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T00:26:40.923

AE使用[javamail](https://developers.google.com/appengine/docs/java/mail/usingjavamail)

你基本上可以这样做：

```
String msgText = getHtmlMessageText(...);
msg.setContent(msgText, "text/html"); 
```

另一个简单的例子是[使用 javamail 发送 html](http://helpdesk.objects.com.au/java/how-to-send-html-mail-using-javamail) - 只需忽略 "sessionProperties.put("mail.smtp.host", smtpServer);" 在创建会话部分，因为您使用的是 AE。无论如何它都会被AE忽略......

或者只是谷歌“javamail html”。

请记住[，除了纯文本消息正文之外，您还可以使用多部分消息发送 HTML 消息正文](https://developers.google.com/appengine/docs/java/mail/usingjavamail#Multi_Part_Messages)

# c++ - 警告：不推荐将字符串常量转换为 'char*'

> ID：12451562
> 
> 赞同：-2
> 
> 时间：2012-09-16T23:27:18.330
> 
> 标签：c++

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-16T23:30:09.717

您以`strncat()`错误的顺序提供参数。第一个参数是要附加到的字符串；第二个参数是要附加的字符串。如所写，您正在尝试将输入添加`string`到常量 string `"Hello"`，这是不行的。您需要将其编写为两个单独的字符串操作。

使用该`std::string`课程将为您节省很多痛苦。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-16T23:36:31.657

由于您使用的是 C++，因此我建议您避免使用 C `char*`++ `std::string`。如果需要传入 a `char*`，则 string 类有一个`c_str()`方法以 a 的形式返回字符串`const char*`。

使用字符串类时的连接就像`"Hello " + "World!"`.

```
#include <iostream>
#include <string>

const int MaxLength = 599;

int main() {
    std::string name;

    std::cout << "Enter a name: ";
    std::cin >> name;

    if (name.length() > MaxLength) {
        name = name.substr(0, MaxLength);
    }

    // These will do the same thing.
    // std::cout << "Hello " + name << endl;
    std::cout << "Hello " << name << endl;

    return 0;
} 
```

这并不能完全回答您的问题，但我想它可能会有所帮助。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-17T09:24:21.127

更好的编写方法是使用字符串类并完全跳过字符。

```
#include <iostream>
#include <string>

int main(){
    std::string name;
    std::cout<<"Enter name: ";
    std::getline(std::cin, name);
    std::string welcomeMessage = "Hello " + name;
    std::cout<< welcomeMessage;
    // or just use:
    //std::cout << "Hello " << name;
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-16T23:29:01.823

```
char * strncat(char * destination, const char * source, size_t num); 
```

所以你的来源和目的地是错误的。

# javascript - 如何添加 Javascript 库以在 CouchDB 视图中使用

> ID：12451563
> 
> 赞同：4
> 
> 时间：2012-09-16T23:27:22.630
> 
> 标签：javascript, mapreduce, couchdb

**免责声明**：我正在为一个新项目审查 CouchDB，所以我对它的内部工作还不太熟悉。

如何将 Javascript 库引入 CouchDB 以便在 MapReduce 视图中使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T07:00:18.457

看看这个问题的答案（全部），他们描述了一系列可能的解决方案：

[如何干燥我的 CouchDB 视图？](https://stackoverflow.com/questions/1197449/how-do-i-dry-up-my-couchdb-views)

# php - 发布到 Tumblr 的 URL

> ID：12451564
> 
> 赞同：0
> 
> 时间：2012-09-16T23:27:37.800
> 
> 标签：php, url, oauth, tumblr

像许多其他人一样，我一直在杀死试图让 oauth 在 MAMP 上工作的脑细胞。因此，我转而使用我的母语 (python)，很快就获得了 Tumblr 的访问令牌和访问令牌秘密。我仍然想在 php 中写一些东西来发布到 tumblr，但我一直在弄清楚我需要发布到的 URL 是什么。

我知道网址是

[https://api.tumblr.com/v2/blog/test.tumblr.com/post](https://api.tumblr.com/v2/blog/test.tumblr.com/post)

我坚持的是我将访问令牌放在 url 中的位置。我的猜测是：

[https://api.tumblr.com/v2/blog/test.tumblr.com/post?oauth_token=XXX&oauth_token_secret=XXX&access_token=XXX&access_token_secret=XXX](https://api.tumblr.com/v2/blog/test.tumblr.com/post?oauth_token=XXX&oauth_token_secret=XXX&access_token=XXX&access_token_secret=XXX)

我已经尝试过这种变化，但似乎没有任何效果。也许这是标题的问题？我绝对需要安装 php oauth 客户端并在上面写一些东西吗？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T23:59:26.887

简而言之，是的。

您传递的参数在 URL ( `HTTP_GET`) 中。它们需要在`Authorization`标题中。

一个典型的`HTTP_GET`样子：

```
GET /questions/12451564/url-to-post-to-tumblr?someval=something HTTP/1.1
Host: stackoverflow.com 
```

典型的 OAuth 可能如下所示：

```
GET /v2/blog/test.tumblr.com/post
Host: api.tumblr.com
Authorization: OAuth realm="Photos",
    oauth_consumer_key="dpf43f3p2l4k3l03",
    oauth_token="nnch734d00sl2jdk",
    oauth_signature_method="HMAC-SHA1",
    oauth_timestamp="137131202",
    oauth_nonce="chapoH",
    oauth_signature="MdpQcU8iPSUjWoN%2FUDMsK2sui9I%3D" 
```

这不是唯一的请求 - 在此请求之前还有初始化临时令牌的调用，因此[Tumblr API](http://www.tumblr.com/docs/en/api/v2#auth)中给出了端点：

示例部分来自[RFC for OAuth - 1.2 示例](https://www.rfc-editor.org/rfc/rfc5849#page-5)

# image-processing - 什么是粗直方图？

> ID：12451570
> 
> 赞同：1
> 
> 时间：2012-09-16T23:29:34.380
> 
> 标签：image-processing, computer-vision

我正在阅读论文[Shape Context: A new descriptor for shape matching and object orientation](http://digital.cs.usu.edu/~xqi/Teaching/CS5650F03/FinalProject/ShapeDescriptor.Belongie.00.pdf)。在第 3 节中，它写道：

> 对于形状上的点 P，我们计算剩余 N-1 个点的相对坐标的粗略直方图。该直方图被定义为 P 的*形状上下文*。坐标系的参考方向可以是绝对的或相对于给定轴的。在本文中，我们将假设绝对参考方向，即相对于正 x 轴测量的角度。描述符应该对附近像素的差异更敏感。因此，我们建议使用对数极坐标系。

什么是粗直方图？我熟悉图像的颜色直方图，它将图像中的所有颜色作为 x 轴，y 轴是该颜色的像素数。这显然不是他们正在谈论的那种直方图。毕竟，你不能相对于一个点制作这样的直方图。

建议的直方图的 x 轴和 y 轴是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:54:03.810

在图 1 的描述中，您可以看到项目 e、f 和 g。这些就是本文所说的粗直方图。在引用的文本下方，直方图轴定义为

```
12 equally spaced angles bins and 5 equally spaced log-radius bins. 
```

在图 1 中，您可以看到 y 轴的 log r 和 x 轴的 theta。鉴于他们正在绘制 12 和 5，这可能就是他们使用“粗略”这个词的原因，样本并不多。

# javascript - 使用 javascript 监控标签的样式更改？

> ID：12451571
> 
> 赞同：1
> 
> 时间：2012-09-16T23:29:38.420
> 
> 标签：javascript, userscripts

我希望我的用户脚本监视此标签的更改：

```
<div id="moni" style="text-align: center; width: 773px; display: none; ">Offline</div> 
```

变化在于风格。`display:none;`有时更改为`display:block;`.

如何通过 javascript 进行监控？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T01:13:19.667

[这里](https://stackoverflow.com/questions/2157963/is-it-possible-to-listen-to-a-style-change-event)和[这里](https://stackoverflow.com/questions/1225102/jquery-event-to-trigger-action-when-a-div-is-made-visible)有一个类似的问题。他们将向您展示如何修改 jQuery 本身以获得您想要的。

如果你只想投票，你可以使用这个：

```
function foo(){
    $('#moni').each(function(){
        if($(this).is(':visible')){
            //do something
        }
    });
} //foo()
window.setInterval(foo, 100); 
```

根据您的情况将修改`100`为合理的毫秒数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T02:50:28.897

您的***真正目标***是让该 div 不显示吗？
如果是这样，那么只需在脚本中使用 CSS，如下所示：

```
GM_addStyle ('#moni {display: none !important;}'); 
```

* * *

但是，如果你真的想监控变化，这里有一些选择：

1.  轮询更改。这是最简单、最可靠的方法。
    例如（**不需要 jQuery**）：

    ```
    function checkForMoniDisplayChange () {
        this.lastDisp   = this.lastDisp  ||  "";
        var moniDiv     = document.getElementById ("moni")
        var moniDisp    = window.getComputedStyle (moniDiv).getPropertyValue ("display");

        if (moniDisp != this.lastDisp) {
            // DO SOMETHING
            //console.log (moniDisp);
        }
        this.lastDisp   = moniDisp;
    }

    //--- 150 is a good compromise between UI response and browser load.
    window.setInterval (checkForMoniDisplayChange, 150); 
    ```

2.  挂钩到正在进行更改的目标页面的 javascript（如果有）。
    例如，如果目标页面使用 javascript 函数`display (elem)`来显示该节点，那么您*通常可以* [**注入**](https://stackoverflow.com/a/5006952/331508)类似于以下内容的代码：

    ```
    var _old_display    = display;
    var display         = function (elem) {
        // DO SOMETHING
        _old_display (elem);    // Optional, depending on your goals.
        // DO SOMETHING MORE
    }; 
    ```

3.  使用全新[`MutationObserver`的 s](https://hacks.mozilla.org/2012/05/dom-mutationobserver-reacting-to-dom-changes-without-killing-browser-performance/)来监视元素的类和/或样式属性的更改。
    如果您打算这样做，最好通过[Google 的*Mutation Summary*库](https://code.google.com/p/mutation-summary/)来完成。询问一个新问题以获取有关此方法的更多信息。

* * *

请注意，出于安全原因，javascript 无法检测到每个样式更改。例如，您的脚本将无法获取已访问链接的颜色。

# javascript - 如何计算猫鼬中具有一个不同字段的记录？

> ID：12451575
> 
> 赞同：9
> 
> 时间：2012-09-16T23:30:25.520
> 
> 标签：javascript, node.js, nosql, mongoose

在为 nodejs 探索 mongoose 时，我遇到了需要知道我的集合中用户数量的问题：

我的收藏有记录，每条记录都有一个用户。我想知道唯一（不同）用户的数量。

我怎么能用猫鼬做到这一点？

**编辑：**

数据库增长得很快，有没有办法从数据库中取回数字而不是获取所有不同的记录并计算它们？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-17T01:36:43.950

这是一个替代答案，因为当我尝试使用 Mongoose 3.1.2 的 Reddest 方法时出现异常（这对我来说似乎是 Mongoose 中的一个错误，因为 Reddest 的方法应该没问题）。

您可以在集合的模型上调用该`distinct`方法，指定该集合的用户标识字段的名称：

```
Record.distinct('user_id').exec(function (err, user_ids) {
    console.log('The number of unique users is: %d', user_ids.length);
}); 
```

或者，如果您想`distinct`从查找链接调用，请在调用中包含回调`distinct`（这对我有用）：

```
Record.find().distinct('user_id', function (err, user_ids) { ... }); 
```

**更新**

如果您只想要计数而不获取值，`count()`请在链中调用：

```
Record.distinct('user_id').count().exec(function (err, count) {
    console.log('The number of unique users is: %d', count);
}); 
```

**注意**：这在最新的 Mongoose 代码 (3.5.2) 中不起作用。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-20T20:45:54.143

聚合将为您工作。像这样的东西：

```
Transaction.aggregate(
    { $match: { seller: user, status: 'completed'  } }, 
    { $group: { _id: '$customer', count: {$sum: 1} } }
).exec() 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-03-27T03:23:13.250

如果您只想获取查询集合的数量，可以使用：

```
Record.find()
      .distinct('user_id')
      .count(function (err, count) {
          //The number of unique users is 'count'
      }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-17T00:14:39.287

您可以执行不同的查询。

```
var Record = db.model('Record', yourSchema);
Record.find().distinct('user').exec(callback); 
```

猫鼬查询： http: [//mongoosejs.com/docs/queries.html](http://mongoosejs.com/docs/queries.html)

MongoDB 不同查询： [http ://www.mongodb.org/display/DOCS/Aggregation#Aggregation-Distinct](http://www.mongodb.org/display/DOCS/Aggregation#Aggregation-Distinct)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-05-17T12:10:45.873

我只需要不同音乐家的数量，但**上面的一些代码对我不起作用**。如果我同时使用 count 和 distinct ，我就得到了总数。

**这是我的解决方案**：

```
/**
 * Get number of distinct musicians
 */

myList.find()
    .distinct('musicianName')
    .exec(function (err, count) {
        console.log(count.length);
    }); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-25T21:02:35.547

我正在寻找答案并得到了这个问题，现在我得到了答案，所以回答了这个问题。

您可以使用以下代码隔离所有具有相似属性的用户。我以电子邮件为例，您可以更改它。您还将获得与您选择的属性值相同的所有用户的计数。

```
var agg = [{$group: {_id: "$email",total: {$sum: 1}}}];
User.aggregate(agg, function(err, logs){
  if (err) { return console.log(err); }
  return console.log(logs);
}); 
```

# html - 我的 h1 应该是我的徽标还是页面中的下一个标题？

> ID：12451579
> 
> 赞同：9
> 
> 时间：2012-09-16T23:30:44.127
> 
> 标签：html

我一直在为这个决定而苦苦挣扎，我想知道是否有任何结构或语义上的原因可以正确处理它：

因此，考虑到大多数网站都有一个徽标（有时称为标头），我通常`h1`为这个元素使用一个，然后隐藏该对象的文本，因为它通常是一个图像。

但随后出现的情况是，我将在页面上有一个真正的标题，在我们的例子中说它是“产品”，那么这应该是一个`h2`吗？还是应该是`h1`？有人告诉我，页面上的内容不应超过一个`h1`，但它似乎是最重要的，因为它`h1`永远不会改变。

是否有任何 SEO 考虑或其他原因，我想以某种方式处理这个问题？任何输入将不胜感激。

* * *

为了澄清，当我说我隐藏文本时，我通常会`background-image`在我的 CSS 中制作徽标，然后我通常使用 ol' 隐藏文本`text-indent:-99999px`。我一直认为这是让谷歌正确索引它的最佳方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-16T23:41:18.777

首先，我想说我不是这方面的专家，这只是我从一些消息来源得知的。

我相信 h1 标签应该只用于标题。原因是它们是一个很棒的搜索引擎优化工具。就页面的相关性而言，h1 是排名靠前的元素。

在图像周围放置 h1 对您的页面没有任何作用，除非您在其中放置一些描述性文本。在 h1 标签中放置隐藏文本的问题在于 Google 机器人比这更聪明。他们要么完全忽略标签，要么将您列入黑名单（通常为此需要发生多个实例，但通常尝试使用隐藏元素提升搜索排名是个坏主意，排除元标签）。

因此，将您的“产品”标题放在 h1 中。在没有标题的任何其他页面上，我会在 h1 内的页面中放置一个描述性句子，并将其样式设置为与周围的文本相匹配。这将确保机器人知道标签中的单词与页面相关。

## 编辑：对于 OP 编辑

无论您使用`display:none`或`left-margin:-99999px`，它仍然不是一个好主意。这是隐藏文本或元素的常用方法，我相信这对谷歌来说并不新鲜；）

# r - Lyx 中的 knitr 安装

> ID：12451581
> 
> 赞同：7
> 
> 时间：2012-09-16T23:31:11.090
> 
> 标签：r, knitr, lyx

我试图在 Lyx 中安装 Knitr 包，但遇到以下错误。

> “模块 knitr 需要一个在您的 Latex 安装中不可用的包或您尚未安装的转换器。Latex 输出可能是不可能的。包缺少 Knitr>latex。”

如果您能帮我解决这个问题，我将不胜感激。我检查了 Lyx 模块，但不知道该怎么做。我是 Lyx 和 Knitr 的新用户。

先感谢您

![](../Images/5bf80b3af7638b3d27061a7c3d7b7cd1.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T00:10:14.597

这通常表明存在 PATH 问题；请参阅 LyX/Sweave/knitr 手册的第一部分（PDF 链接位于[http://yihui.name/knitr/demo/lyx/](http://yihui.name/knitr/demo/lyx/)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-07-09T21:54:30.380

我在我的 Windows 10 机器上收到了同样的错误消息，发现错误出现在我为 R 提供的路径中。如果您没有通往 R 可执行文件的路径，它将无法正常工作。使用 Tools>Preferences>Paths 更改 Lyx 中的路径并编辑 PATH 前缀内容。我不得不添加

```
 C:\Program Files\R\R-3.6.0\bin\x64 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-27T08:28:38.383

咳咳……在 Windows 10 中，使用 MikTeX，您应该知道 R 安装在 x64 和 i386 架构下，因此当您在 R 中运行 R.home('bin') 时，它会给出：

i386 架构的“C:/Users/DIEGOA~1.ACO/DOCUME~1/R/R-34~1.2/bin/i386”和“C:/Users/DIEGOA~1.ACO/DOCUME~1/R/ R-34~1.2/bin/x64" 用于 x64 架构...在 LyX 中添加 Rnw(knitr) 时，您应该同时测试两者（一个抱怨，另一个不抱怨）...

希望这可以帮助...

# csv - 如何限制 sed 仅替换出现在第一个右方括号之后的数据？

> ID：12451587
> 
> 赞同：4
> 
> 时间：2012-09-16T23:32:05.660
> 
> 标签：csv, sed

我有一个使用高度自定义格式的 CSV 文件。在这里，每个数字代表 4 列中的每一列中的数据：

```
1 2 [3] 4 
```

我需要限制`sed`为仅搜索和修改出现在第四列中的数据。本质上，它必须忽略出现在第一次出现右方括号和空格之前的行上的所有数据，`]`并且只修改出现在之后的数据。例如，`file1.txt`可能包含以下内容：

```
penguin bird [lives in Antarctica] The penguin lives in cold places.
wolf dog [lives in Antarctica with penguins] The wolf likes to eat penguins. 
```

替代品可能是`sed 's/penguin/animal/g' file1.txt`. 运行脚本后，输出将如下所示：

```
penguin bird [lives in Antarctica] The animal lives in cold places.
wolf dog [lives in Antarctica with penguins] The wolf likes to eat animal. 
```

在这种情况下，所有出现的`penguin`都在第一次之前被忽略，`]`并且只在出现在之后的行上发生更改。

*   额外的右括号可能会出现在该行的后面，但只有第一个应该被视为除法。

在查找和替换文本时，如何`sed`忽略此自定义 CSV 格式的前三列？

我有 GNU sed 4.2.1 版。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T00:13:04.357

您告诉 sed 搜索 '] ' 组合后跟`.*`(anything)，然后作为替换的一部分，您放回`]`字符。

唯一的问题是`sed`通常“认为” `]`char 是字符类定义的一部分，因此您必须对其进行转义。尝试

```
echo "a b [c] d" | sed 's/\] .*$/\] XYZ/'
a b [c] XYZ 
```

请注意，因为没有开始`[`字符来指示字符类定义，所以你可以侥幸逃脱

```
echo "a b [c] d" | sed 's/] .*$/] XYZ/'
a b [c] XYZ 
```

**编辑**

只修复第 4 个单词，

```
echo "a b [c] d e" | sed 's/\] [^ ][^ ]*/\] XYZ/'
a b [c] XYZ e 
```

上面的加法`[^ ][^ ]/`表示“any-char-that-is-not-a-space”后跟任意数量的“any-char-that-is-not-a-space”，所以当匹配器找到下一个空格时停止匹配。

**最终编辑**

```
echo "penguin bird [lives in Antarctica] The penguin lives in cold places.
wold dog [lives in Antarctica with penguins] The wolf likes to eat penguins." \
| sed 's/\] The penguin \(.*$\)/] The animal \1/' 
```

并且当您使用 gnu sed 时，您不需要转义`(...`) 捕获括号。

```
echo "penguin bird [lives in Antarctica] The penguin lives in cold places.
wold dog [lives in Antarctica with penguins] The wolf likes to eat penguins." \
| sed 's/\] The penguin (*$)/] The animal \1/' 
```

**输出**

```
penguin bird [lives in Antarctica] The animal lives in cold places.
wolf dog [lives in Antarctica with penguins] The wolf likes to eat penguins. 
```

根据您使用的 sed 版本。在 lunix`sed`中，`AIX`、 vs `solaris`、 VS GNU seds 之间存在很大差异。

如果您有其他关于使用 sed 的问题，包含`sed --version`或的输出通常会有所帮助`sed -V`。如果这些命令没有响应，请尝试`what sed`. 否则包括`uname`.

IHTH

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T00:33:09.223

假设您只出现一次右括号，我`awk`会这样做：

```
awk 'BEGIN {FS=OFS="]"} { gsub(/penguin/, "animal", $2) }1' file.txt 
```

结果：

```
penguin bird [lives in Antarctica] The animal lives in cold places.
wolf dog [lives in Antarctica with penguins] The wolf likes to eat animals. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-17T00:40:37.937

通常我会按照庇护所描述的方式进行操作（如果我只是在快速`sed`命令行中输入），但它的缺点是，一旦你开始匹配部分输入以保留它（使用`\1`等），你必须匹配并替换所有内容并且不能再使用简单的替换，如`s/penguin/animal/`. 如果您愿意在替换*周围*添加一些样板，您可以将行的开头隐藏在保持缓冲区中，然后将其取回：

```
sed -e 'h' \
    -e 's/.*\] //' \
    -e 's/penguin/animal/' \
    -e 'x' \
    -e 's/\] .*/] /' \
    -e 'G' \
    -e 's/\n//' 
```

将`h`原始行保存在保持空间中。然后我们删除前缀并在行尾进行任何替换（在此处选择您的示例）或一系列替换。然后`x`交换结尾和保存的副本。我们从保存的副本中删除原始端`G`并将它们重新组合在一起。`G`添加一个我们不想要的换行符，所以我们删除它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-17T05:42:07.373

这可能对你有用（GNU sed）；

```
sed  -i 's/\]/&\n/;h;s/.*\n//;s/penguin/animal/g;H;g;s/\n.*.\n//' file 
```

解释：

*   `s/\]/&\n/`用`\n`标记分割线
*   `h`复制行
*   `s/.*\n//`删除您不想更改的行的部分
*   `s/penguin/animal/g`更改您要更改的部分
*   `H;g`将其添加回原始行
*   `s/\n.*\n//`删除要更改的原始行的部分

这适用于每一行，如果更改是有条件的，请使用：

```
sed  -i '/\]/!b;s//&\n/;h;s/.*\n//;s/penguin/animal/g;H;g;s/\n.*.\n//' file 
```

另一种选择（也许更简单的方法）：

```
sed ':a;s/\(\].*\)penguin/\1animal/;ta' file 
```

# cluster-analysis - 在 Weka 中以编程方式获取 Xmeans 聚类器输出

> ID：12451591
> 
> 赞同：5
> 
> 时间：2012-09-16T23:33:18.983
> 
> 标签：cluster-analysis, weka, xmeans

在 Weka 中使用 Kmeans 时，可以在模型的结果输出上调用 getAssignments() 来获取每个给定实例的集群分配。这是一个（截断的）Jython 示例：

```
>>>import weka.clusterers.SimpleKMeans as kmeans
>>>kmeans.buildClusterer(data)
>>>assignments = kmeans.getAssignments()
>>>assignments
>>>array('i',[14, 16, 0, 0, 0, 0, 16,...]) 
```

每个簇号的索引对应于实例。因此，实例 0 在集群 14 中，实例 1 在集群 16 中，依此类推。

我的问题是：Xmeans 有类似的东西吗？我在[这里](http://weka.sourceforge.net/doc.packages/XMeans/weka/clusterers/XMeans.html)浏览了整个 API并没有看到类似的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-23T16:58:58.660

这是 Weka listserv 对我的问题的答复：

```
 "Not as such. But all clusterers have a clusterInstance() method. You can 
 pass each training instance through the trained clustering model to 
 obtain the cluster index for each." 
```

这是我对这个建议的 Jython 实现：

```
 >>> import java.io.FileReader as FileReader
 >>> import weka.core.Instances as Instances
 >>> import weka.clusterers.XMeans as xmeans
 >>> import java.io.BufferedReader as read
 >>> import java.io.FileReader
 >>> import java.io.File
 >>> read = read(FileReader("some arff file"))
 >>> data = Instances(read)
 >>> file = FileReader("some arff file")
 >>> data = Instances(file)
 >>> xmeans = xmeans()
 >>> xmeans.setMaxNumClusters(100)  
 >>> xmeans.setMinNumClusters(2) 
 >>> xmeans.buildClusterer(data)# here's our model 
 >>> enumerated_instances = data.enumerateInstances() #get the index of each instance 
 >>> for index, instance in enumerate(enumerated_instances):
         cluster_num = xmeans.clusterInstance(instance) #pass each instance through the model
         print "instance # ",index,"is in cluster ", cluster_num #pretty print results

 instance # 0 is in cluster  1
 instance # 1 is in cluster  1
 instance # 2 is in cluster  0
 instance # 3 is in cluster  0 
```

我将所有这些作为参考，因为可以使用相同的方法为 Weka 的任何集群器的结果获取集群分配。

# linux - 仅用于行号的快速 grep / grep？

> ID：12451598
> 
> 赞同：5
> 
> 时间：2012-09-16T23:34:48.290
> 
> 标签：linux, search, grep

我正在寻找有关 grep 或 grep 之类的工具的帮助。这包括但不限于 grep、egrep、awk、sed 或任何其他用于搜索匹配项的工具。但对于剩下的问题，我只会称它为 grep。

我正在寻找 grep 匹配文件的快速方法，并且我也在寻找 grep 匹配文件的最快方法，并且只返回行号而不是匹配行的其余部分。我不介意语法是否复杂，只要它快，我将在程序中使用它复杂性不是问题。

如果我需要对模式进行正则表达式，我也需要这种方法才能工作，这样我也可以搜索范围。因此，如果我需要搜索所有小于 10 的数字（如果命令默认支持它）或者它需要一些正则表达式，我只是在寻找我能找到的最快的方法。

谢谢你。

编辑

我正在使用的文件会非常大，我的测试文件是 1.9gb

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T16:37:18.653

我认为 KingsIndian 可以`-m`选择 grep，但如果速度是您的主要目标，`cut`则可能比`awk`这种特殊用途更快。尝试：

```
grep -n -m 1 regex file | cut -d: -f1 
```

参数告诉 cut使用`-d:`冒号作为字段分隔符，而`-f1`参数告诉它只输出第一个字段。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-16T23:50:08.803

在第一场比赛后停止：

```
grep -n -m 1 str file | awk -F: '{print $1}' 
```

您可以将 的参数值更改`m`为不同的值，以在那么多匹配后停止。该`awk`部分仅捕获行号。

在 5 场比赛后停止：

```
grep -n -m 5 str file | awk -F: '{print $1}' 
```

**编辑：**
您可以使用`tail`它。例如，要跳过前 5 个匹配项并打印接下来的 7 个：`grep -n -m 12 str file| tail -7 | awk -F: '{print $1}'`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T01:17:34.033

您可以使用`GNU awk`并简单地打印出行号进行模式匹配：

```
awk '/regex/ { print NR }' file.txt 
```

假设值是空格分隔的，如果行包含小于 10 的数字，您可以找到行号：

```
awk '{ for (i=1; i<=NF; i++) if ($i <= 10) print NR }' file.txt 
```

但是，这将打印每次出现小于 10 的数字的行号。我相信您可能会觉得这是不可取的。因此，要删除每个匹配项的多个重复行号，您可以使用数组：

```
awk '{ for (i=1; i<=NF; i++) if ($i <= 10) array[NR]++ } END { for (i in array) print i }' file.txt 
```

如果您需要排序输出，请通过管道传输到`sort -n`. 如果您更喜欢更优雅的解决方案（即没有管道）：

```
awk '{ for (i=1; i<=NF; i++) if ($i <= 10) array[NR]++ } END { for (j in array) sorted[k++]=j+0; n = asort(sorted); for (j=1; j<=n; j++) print sorted[j] }' file.txt 
```

**编辑：**

在`awk`上面最后三个命令中的任何一个中，只需更改`if ($i <= 10)`为`if ($i >= 11 && $i <= 20)`以显示结果 11 到 20（包括）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-16T23:52:02.743

我不确定这是否很快，但这似乎有效：

```
nl -b a "<filename>" | grep "<phrase>" | awk '{ print $1 }' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-07-08T07:58:32.963

我刚刚使用非分叉 sed 调用进行了一些测试，但并不幸运，但在这里参考带有 1 GB 文本文件的数字，其中我的 $PATTERN 是最后一行的一部分：

（剧透：grep 在此操作上快 5 倍以上，awk 最慢）

```
user@box:~$ ls -lh /dev/shm/test
-rw-r--r-- 1 用户用户 979M 7 月 8 日 09:50 /dev/shm/test

```

```
user@box:~$ sed --version | 头-n1
GNU sed-版本 4.2.1
user@box:~$ time sed -n "/$PATTERN/{=;q}" /dev/shm/test
206558

真实0m6.835s
用户 0m6.160s
系统 0m0.648s

```

```
用户@box:~$ grep -V | 头-n1
grep (GNU grep) 2.14
user@box:~$ time grep -n -m 1 "$PATTERN" /dev/shm/test | 剪切-d：-f1
206558

真实0m1.337s
用户 0m0.592s
系统 0m0.736s

```

```
user@box:~$ awk --version | 头-n1
GNU awk 4.0.1
user@box:~$ time awk "/$PATTERN/ { print NR }" /dev/shm/test
206558

真实0m7.176s
用户 0m6.356s
系统 0m0.776s

```

# razor - 从 razor 网页中的连接表中选择下拉列表值（使用 WebMatrix）

> ID：12451606
> 
> 赞同：0
> 
> 时间：2012-09-16T23:35:39.470
> 
> 标签：razor, drop-down-menu, helper, webmatrix, asp.net-webpages

我正在学习使用 Webmatrix（带有剃刀语法）的 ASP.Net 网页编程。

目标是让下拉列表框由存储在表中的值和来自另一个连接表的选定值填充。

所选值应在帖子之前和之后显示。

我还希望如果 UserProfiles 表中没有 UserTypeId (UserTypeId == NULL)，则会显示默认的“请选择”。

表 1：具有 UserTypeId 和 Name 字段的 UserType 表 2：具有 UsertypeId 作为外键的 UserProfiles

我收到以下错误消息，但找不到解决该问题的方法： Operator '==' cannot be applied to operands of type 'int' and 'WebMatrix.Data.DynamicRecord'

**代码部分：**

```
var db = Database.Open("MyDatabase"); 
```

获取存储在 UserProfiles 表中的已连接用户的 UserTypeId

```
var selectedUserTypeId = db.QuerySingle("SELECT UserTypeId FROM UserProfiles INNER JOIN Users ON UserName=@0",authenticatedUser); 
```

获取 UserTypes 的列表

```
var sqlUserTypeData = "SELECT userTypeId, Name FROM UserTypes";
var userTypeData = db.Query(sqlUserTypeData);

var userTypeDataList = userTypeData.Select(userTypeDataListItem => new SelectListItem {
    Value = userTypeDataListItem.UserTypeId.ToString(),
    Text = userTypeDataListItem.Name,
    Selected = userTypeDataListItem.UserTypeId == selectedUserTypeId ? true : false
}); 
```

最后一行是出现问题的地方：userTypeDataListItem.UserTypeId == selectedUserTypeId。这些类型显然无法比较。

```
if(!IsPost){
    var sqlUserData = @"SELECT *,  UserTypes.Name AS UserType
                        FROM UserProfiles
                        INNER JOIN Users ON Users.UserId = UserProfiles.UserId 
                        INNER JOIN UserTypes ON UserTypes.UserTypeId = UserProfiles.UserTypeId 
                        WHERE Users.UserName=@0";

    var userData = db.QuerySingle(sqlUserData,authenticatedUser);

    userType = userData.UserType;
    }

if(IsPost){
    Validation.RequireField("userTypeCombo", "Please select");

    userId = Request.Form["userId"];
    userTypeId = Request.Form["userTypeCombo"];

if(Validation.IsValid()) {
        var updateCommand = @"UPDATE UserProfiles
                            SET UserTypeId=@0
                            WHERE UserId=@1";
        db.Execute(updateCommand, userTypeId, userId);
        Response.Redirect("~/authcontent/user");
    } 
```

**HTML部分：**

```
@if (isAuthenticated) {
    <form action="" method="post">
        @Html.ValidationSummary()
        <section class="infoblock">
            <fieldset>
                <legend>Mon profil</legend>
                <ul>
                    <li><label for="userType">Profil</label>
                        @Html.DropDownList("userTypeCombo", "Please select", userTypeDataList)</li>
                </ul>
            </fieldset>
        </section>
    </form>        
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T06:46:36.433

您应该解决此错误消息突出显示的问题

```
var selectedUserTypeId = db.QuerySingle(...) 
```

和

```
var selectedUserTypeId = db.QueryValue(...) 
```

或指定记录字段：

```
Selected = userTypeDataListItem.UserTypeId == selectedUserTypeId.UserTypeId ? true : false 
```

# ruby - 如何打印对象的属性而不是视图中的对象

> ID：12451608
> 
> 赞同：-1
> 
> 时间：2012-09-16T23:35:43.070
> 
> 标签：ruby, ruby-on-rails-3

我目前正在使用[closure_tree](https://github.com/mceachen/closure_tree) gem 在我的rails 应用程序上建模标记。在我的新标签视图中，我有一个字段，用户可以在其中输入要创建的标签的父标签。保存新标签后，编辑标签会将父字段显示为#。如何改为在字段中显示父标签的名称？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T09:03:20.623

原来我只需要一个 to_s 函数来为我的模型和正确显示的东西。

```
def to_s
  self.name
end 
```

# c# - 如何“等待”引发 EventHandler 事件

> ID：12451609
> 
> 赞同：66
> 
> 时间：2012-09-16T23:35:54.953
> 
> 标签：c#, events, mvvm, .net-4.5, async-await

有时，事件模式用于在 MVVM 应用程序中引发事件，或者子视图模型以像这样的松散耦合方式向其父视图模型发送消息。

**父视图模型**

```
searchWidgetViewModel.SearchRequest += (s,e) => 
{
    SearchOrders(searchWidgitViewModel.SearchCriteria);
}; 
```

**SearchWidget ViewModel**

```
public event EventHandler SearchRequest;

SearchCommand = new RelayCommand(() => {

    IsSearching = true;
    if (SearchRequest != null) 
    {
        SearchRequest(this, EventArgs.Empty);
    }
    IsSearching = false;
}); 
```

* * *

在为 .NET4.5 重构我的应用程序时，我正在制作尽可能多的代码来使用`async`和`await`. 但是以下不起作用（好吧，我真的没想到会这样）

```
 await SearchRequest(this, EventArgs.Empty); 
```

框架确实这样做是为了调用[诸如 this 之类](http://www.i-programmer.info/programming/c/1514-async-await-and-the-ui-problem.html)的事件处理程序，但我不确定它是如何做到的？

```
private async void button1_Click(object sender, RoutedEventArgs e)
{
   textBlock1.Text = "Click Started";
   await DoWork();
   textBlock2.Text = "Click Finished";
} 
```

我在异步引发事件的主题上发现的任何东西[都是](http://msdn.microsoft.com/en-us/library/e7a34yad.aspx) [古老](http://msdn.microsoft.com/en-us/library/wewwczdw.aspx)的，但我在框架中找不到支持这一点的东西。

如何`await`调用事件但仍保留在 UI 线程上。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-09-16T23:38:20.053

**编辑：**这不适用于多个订阅者，因此除非您只有一个订阅者，否则我不建议您使用它。

* * *

感觉有点hacky - 但我从来没有找到更好的东西：

声明一个代表。这等同于[`EventHandler`](https://docs.microsoft.com/en-us/dotnet/api/system.eventhandler)但返回一个任务而不是 void

```
public delegate Task AsyncEventHandler(object sender, EventArgs e); 
```

然后，您可以运行以下命令，只要在父级中声明的处理程序使用正确`async`，`await`那么这将异步运行：

```
if (SearchRequest != null) 
{
    Debug.WriteLine("Starting...");
    await SearchRequest(this, EventArgs.Empty);
    Debug.WriteLine("Completed");
} 
```

样品处理程序：

```
 // declare handler for search request
 myViewModel.SearchRequest += async (s, e) =>
 {                    
     await SearchOrders();
 }; 
```

注意：我从未对多个订阅者进行过测试，并且不确定这将如何工作 - 所以如果您需要多个订阅者，请务必仔细测试。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2015-06-09T17:42:30.683

根据 Simon_Weaver 的回答，我创建了一个可以处理多个订阅者的辅助类，并且具有与 c# 事件类似的语法。

```
public class AsyncEvent<TEventArgs> where TEventArgs : EventArgs
{
    private readonly List<Func<object, TEventArgs, Task>> invocationList;
    private readonly object locker;

    private AsyncEvent()
    {
        invocationList = new List<Func<object, TEventArgs, Task>>();
        locker = new object();
    }

    public static AsyncEvent<TEventArgs> operator +(
        AsyncEvent<TEventArgs> e, Func<object, TEventArgs, Task> callback)
    {
        if (callback == null) throw new NullReferenceException("callback is null");

        //Note: Thread safety issue- if two threads register to the same event (on the first time, i.e when it is null)
        //they could get a different instance, so whoever was first will be overridden.
        //A solution for that would be to switch to a public constructor and use it, but then we'll 'lose' the similar syntax to c# events             
        if (e == null) e = new AsyncEvent<TEventArgs>();

        lock (e.locker)
        {
            e.invocationList.Add(callback);
        }
        return e;
    }

    public static AsyncEvent<TEventArgs> operator -(
        AsyncEvent<TEventArgs> e, Func<object, TEventArgs, Task> callback)
    {
        if (callback == null) throw new NullReferenceException("callback is null");
        if (e == null) return null;

        lock (e.locker)
        {
            e.invocationList.Remove(callback);
        }
        return e;
    }

    public async Task InvokeAsync(object sender, TEventArgs eventArgs)
    {
        List<Func<object, TEventArgs, Task>> tmpInvocationList;
        lock (locker)
        {
            tmpInvocationList = new List<Func<object, TEventArgs, Task>>(invocationList);
        }

        foreach (var callback in tmpInvocationList)
        {
            //Assuming we want a serial invocation, for a parallel invocation we can use Task.WhenAll instead
            await callback(sender, eventArgs);
        }
    }
} 
```

要使用它，请在类中声明它，例如：

```
public AsyncEvent<EventArgs> SearchRequest; 
```

要订阅事件处理程序，您将使用熟悉的语法（与 Simon_Weaver 的答案相同）：

```
myViewModel.SearchRequest += async (s, e) =>
{                    
   await SearchOrders();
}; 
```

要调用事件，请使用我们用于 c# 事件的相同模式（仅使用 InvokeAsync）：

```
var eventTmp = SearchRequest;
if (eventTmp != null)
{
   await eventTmp.InvokeAsync(sender, eventArgs);
} 
```

如果使用 c# 6，则应该能够使用 null 条件运算符并改为：

```
await (SearchRequest?.InvokeAsync(sender, eventArgs) ?? Task.CompletedTask); 
```

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2012-09-17T04:38:37.117

正如您所发现的，事件与`async`and并不完美结合。`await`

UI 处理`async`事件的方式与您尝试执行的操作不同。UI[为其](http://msdn.microsoft.com/en-us/magazine/gg598924.aspx)[事件](http://msdn.microsoft.com/en-us/magazine/gg598924.aspx)[提供了一个`SynchronizationContext``async`](http://msdn.microsoft.com/en-us/magazine/gg598924.aspx)，使它们能够在 UI 线程上恢复。它永远*不会*“等待”他们。

**最佳解决方案 (IMO)**

我认为最好的选择是构建您自己的`async`友好发布/订阅系统，[`AsyncCountdownEvent`](https://devblogs.microsoft.com/pfxteam/building-async-coordination-primitives-part-3-asynccountdownevent/)用于了解所有处理程序何时完成。

**较小的解决方案＃1**

`async void`方法会在开始和结束时通知它们`SynchronizationContext`（通过增加/减少异步操作的计数）。所有 UI`SynchronizationContext`都会忽略这些通知，但您*可以*构建一个包装器来跟踪它并在计数为零时返回。

这是一个示例，使用`AsyncContext`来自我的[AsyncEx 库](http://nitoasyncex.codeplex.com/)：

```
SearchCommand = new RelayCommand(() => {
  IsSearching = true;
  if (SearchRequest != null) 
  {
    AsyncContext.Run(() => SearchRequest(this, EventArgs.Empty));
  }
  IsSearching = false;
}); 
```

但是，在此示例中，UI*线程*在`Run`.

**较小的解决方案＃2**

`SynchronizationContext`您还可以根据嵌套框架制作自己的`Dispatcher`框架，当异步操作的计数达到零时，该框架会自行弹出。但是，您随后会引入重入问题；`DoEvents`故意被排除在WPF之外。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2016-02-08T22:30:21.497

回答直接问题：我认为`EventHandler`不允许实现充分地与调用者进行通信以允许适当的等待。您可能能够使用自定义同步上下文执行技巧，但如果您关心等待处理程序，最好处理程序能够将它们`Task`的 s 返回给调用者。通过制作委托签名的这一部分，可以更清楚地了解委托将被`await`编辑。

我建议将[`Delgate.GetInvocationList()`Ariel 的回答中描述的方法与](https://stackoverflow.com/a/34493958/429091)[tzachs 的回答](https://stackoverflow.com/a/30739162/429091)中的想法混合使用。定义您自己的`AsyncEventHandler<TEventArgs>`委托，它返回一个`Task`. 然后使用扩展方法来隐藏正确调用它的复杂性。如果你想执行一堆异步事件处理程序并等待它们的结果，我认为这种模式是有意义的。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;

public delegate Task AsyncEventHandler<TEventArgs>(
    object sender,
    TEventArgs e)
    where TEventArgs : EventArgs;

public static class AsyncEventHandlerExtensions
{
    public static IEnumerable<AsyncEventHandler<TEventArgs>> GetHandlers<TEventArgs>(
        this AsyncEventHandler<TEventArgs> handler)
        where TEventArgs : EventArgs
        => handler.GetInvocationList().Cast<AsyncEventHandler<TEventArgs>>();

    public static Task InvokeAllAsync<TEventArgs>(
        this AsyncEventHandler<TEventArgs> handler,
        object sender,
        TEventArgs e)
        where TEventArgs : EventArgs
        => Task.WhenAll(
            handler.GetHandlers()
            .Select(handleAsync => handleAsync(sender, e)));
} 
```

这允许您创建一个普通的 .net 样式`event`。只需像往常一样订阅它。

```
public event AsyncEventHandler<EventArgs> SomethingHappened;

public void SubscribeToMyOwnEventsForNoReason()
{
    SomethingHappened += async (sender, e) =>
    {
        SomethingSynchronous();
        // Safe to touch e here.
        await SomethingAsynchronousAsync();
        // No longer safe to touch e here (please understand
        // SynchronizationContext well before trying fancy things).
        SomeContinuation();
    };
} 
```

然后只需记住使用扩展方法来调用事件，而不是直接调用它们。如果您想在调用中获得更多控制权，您可以使用`GetHandlers()`扩展。对于等待所有处理程序完成的更常见情况，只需使用便捷包装器`InvokeAllAsync()`。在许多模式中，事件要么不产生调用者感兴趣的任何东西，要么通过修改传入的`EventArgs`. （注意，如果您可以假设具有调度程序样式序列化的同步上下文，则您的事件处理程序可能会`EventArgs`在其同步块内安全地改变它们，因为延续将被编组到调度程序线程上。这将神奇地发生在您身上，例如，您调用和`await`来自 winforms 或 WPF 中的 UI 线程的事件。否则，您可能必须在突变时使用锁定`EventArgs`，以防您的任何突变发生在线程池上运行的延续中）。

```
public async Task Run(string[] args)
{
    if (SomethingHappened != null)
        await SomethingHappened.InvokeAllAsync(this, EventArgs.Empty);
} 
```

这使您更接近于看起来像普通事件调用的东西，除了您必须使用`.InvokeAllAsync()`. 而且，当然，您仍然会遇到事件带来的正常问题，例如需要保护对没有订阅者的事件的调用以避免`NullArgumentException`.

请注意，我**没有**使用`await SomethingHappened?.InvokeAllAsync(this, EventArgs.Empty)`，因为`await`在`null`. 如果需要，您可以使用以下调用模式，但可以说括号很难看，并且`if`由于各种原因，样式通常更好：

```
await (SomethingHappened?.InvokeAllAsync(this, EventArgs.Empty) ?? Task.CompletedTask); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-08-07T09:57:02.570

如果您正在使用自定义事件处理程序，您可能需要查看[DeferredEvents](https://www.nuget.org/packages/DeferredEvents/)，因为它允许您引发和等待事件的处理程序，如下所示：

```
await MyEvent.InvokeAsync(sender, DeferredEventArgs.Empty); 
```

事件处理程序将执行以下操作：

```
public async void OnMyEvent(object sender, DeferredEventArgs e)
{
    var deferral = e.GetDeferral();

    await DoSomethingAsync();

    deferral.Complete();
} 
```

或者，您可以使用这样的`using`模式：

```
public async void OnMyEvent(object sender, DeferredEventArgs e)
{
    using (e.GetDeferral())
    {
        await DoSomethingAsync();
    }
} 
```

[您可以在此处](https://www.pedrolamas.com/2017/04/04/await-your-event-handlers-completion-with-deferred-events/)阅读有关 DeferredEvents 的信息。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2021-02-10T12:57:15.313

我知道这是一个老问题，但我最好的解决方案是使用**TaskCompletionSource**。

见代码：

```
var tcs = new TaskCompletionSource<object>();
service.loginCreateCompleted += (object sender, EventArgs e) =>
{
    tcs.TrySetResult(e.Result);
};
await tcs.Task; 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2021-09-18T22:00:47.463

您可以使用Microsoft 提供的[Microsoft.VisualStudio.Threading](https://www.nuget.org/packages/Microsoft.VisualStudio.Threading/)`AsyncEventHandler`包中的委托，据我了解，它在 Visual Studio 中使用。

```
private AsyncEventHandler _asyncEventHandler; 
```

```
_asyncEventHandler += DoStuffAsync;

Debug.WriteLine("Async invoke incoming!");
await _asyncEventHandler.InvokeAsync(this, EventArgs.Empty);
Debug.WriteLine("Done."); 
```

```
private async Task DoStuffAsync(object sender, EventArgs args)
{
    await Task.Delay(1000);
    Debug.WriteLine("hello from async event handler");
    await Task.Delay(1000);
} 
```

输出：
**异步调用传入！
来自异步事件处理程序的问候
完成。**

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-09-16T23:57:49.387

我不清楚您所说的“我如何`await`调用事件但仍保留在 UI 线程上”是什么意思。您希望在 UI 线程上执行事件处理程序吗？如果是这种情况，那么您可以执行以下操作：

```
var h = SomeEvent;
if (h != null)
{
    await Task.Factory.StartNew(() => h(this, EventArgs.Empty),
        Task.Factory.CancellationToken,
        Task.Factory.CreationOptions,
        TaskScheduler.FromCurrentSynchronizationContext());
} 
```

它将处理程序的调用包装在一个`Task`对象中，以便您可以使用`await`，因为您不能使用`await`方法`void`- 这是您的编译错误的根源。

但是，我不确定您期望从中获得什么好处。

我认为那里有一个基本的设计问题。可以在 click 事件上执行一些后台工作，并且您可以实现一些支持`await`. 但是，对如何使用 UI 有什么影响？例如，如果您有一个`Click`启动一个需要 2 秒的操作的处理程序，您是否希望用户能够在操作挂起时单击该按钮？取消和超时是额外的复杂性。我认为这里需要对可用性方面做更多的理解。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-04-14T15:51:35.503

由于委托（并且事件是委托）实现了异步编程模型 (APM)，因此您可以使用[TaskFactory.FromAsync](https://msdn.microsoft.com/en-us/library/system.threading.tasks.taskfactory.fromasync(v=vs.110).aspx)方法。（另请参阅[任务和异步编程模型 (APM)](https://msdn.microsoft.com/en-us/library/hh873178(v=vs.110).aspx#Anchor_0)。）

```
public event EventHandler SearchRequest;

public async Task SearchCommandAsync()
{
    IsSearching = true;
    if (SearchRequest != null)
    {
        await Task.Factory.FromAsync(SearchRequest.BeginInvoke, SearchRequest.EndInvoke, this, EventArgs.Empty, null);
    }
    IsSearching = false;
} 
```

然而，上面的代码将调用线程池线程上的事件，即它不会捕获当前的同步上下文。如果这是一个问题，您可以将其修改如下：

```
public event EventHandler SearchRequest;

private delegate void OnSearchRequestDelegate(SynchronizationContext context);

private void OnSearchRequest(SynchronizationContext context)
{
    context.Send(state => SearchRequest(this, EventArgs.Empty), null);
}

public async Task SearchCommandAsync()
{
    IsSearching = true;
    if (SearchRequest != null)
    {
        var search = new OnSearchRequestDelegate(OnSearchRequest);
        await Task.Factory.FromAsync(search.BeginInvoke, search.EndInvoke, SynchronizationContext.Current, null);
    }
    IsSearching = false;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-12-10T22:10:57.557

```
public static class FileProcessEventHandlerExtensions
{
    public static Task InvokeAsync(this FileProcessEventHandler handler, object sender, FileProcessStatusEventArgs args)
     => Task.WhenAll(handler.GetInvocationList()
                            .Cast<FileProcessEventHandler>()
                            .Select(h => h(sender, args))
                            .ToArray());
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-12-28T12:57:40.917

为了继续[Simon Weaver](https://stackoverflow.com/users/16940/simon-weaver)的回答，我尝试了以下方法

```
 if (SearchRequest != null)
        {
            foreach (AsyncEventHandler onSearchRequest in SearchRequest.GetInvocationList())
            {
                await onSearchRequest(null, EventArgs.Empty);
            }
        } 
```

这似乎可以解决问题。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-06-07T23:05:41.927

这有点来自@Simon_Weaver 的回答，但我觉得它很有用。假设您有一些`RaisesEvents`具有事件的类，`RaisesEvents.MyEvent`并且您已将其注入到`MyClass`要订阅的类中，在方法中进行订阅`MyEvent`可能更好`Initialize()`，但为简单起见：

```
public class MyClass
{
    public MyClass(RaisesEvent otherClass)
    {
        otherClass.MyEvent += MyAction;
    }

    private Action MyAction => async () => await ThingThatReturnsATask();

    public void Dispose() //it doesn't have to be IDisposable, but you should unsub at some point
    {
        otherClass.MyEvent -= MyAction;
    }

    private async Task ThingThatReturnsATask()
    {
        //async-await stuff in here
    }
} 
```

# focus - 单选按钮聚焦而不是锚元素（IE9 问题）

> ID：12451612
> 
> 赞同：1
> 
> 时间：2012-09-16T23:36:22.523
> 
> 标签：focus, internet-explorer-9, radio-button, anchor

我有一个交互式 ASP.NET 表单，即使在浏览器上关闭了 Javascript，它也必须工作。此表单包含包含是-否单选按钮的问题。当 javascript 关闭时，“转到”链接（即“转到 Q2”）出现在这些单选按钮旁边，这些单选按钮是包含 href="#id-of-another-element" 的简单链接。因此，当用户单击“转到”链接时，页面将聚焦锚元素，这是标准浏览器行为。

Firefox、Chrome 和 Safari 这样做的方式是，如果您单击锚链接，它旁边的单选按钮不会自动选择 - 这意味着不会有任何东西阻止用户被引导到锚元素。然而，IE9 的做法有所不同。当您单击锚链接时，单选按钮被选中并且更重要的是集中。这会阻止锚元素被聚焦。但是，您可以在地址栏上看到，该 URL 已更新为末尾的锚标记（即 http..#id），因此当您刷新页面时，您将能够转到该链接你试图去。

我现在的问题是：如何在没有 javascript 的情况下解决这个问题，以便 IE9 用户可以成功地转到他们想要在单击链接时访问的锚元素，即使未选择单选按钮（以使其与其他浏览器一致） ?

# c# - 如何在 nopcommerce 中添加两个数据库连接？

> ID：12451614
> 
> 赞同：0
> 
> 时间：2012-09-16T23:36:39.403
> 
> 标签：c#, asp.net-mvc, nopcommerce

我正在使用 nopcommerce 开源购物车。我有问题。我只想从另一个数据库中获取 Stock Quantity。所以我想添加另一个数据库连接字符串。我该怎么做？？

我想在同一个视图中显示来自两个数据库的数据。

请给我解决方案..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T11:01:25.690

nopcommerec 还没有提供这样的工具来添加一个以上的数据源。而不是你需要编写 web 服务来使用股票数据

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-18T07:26:54.837

在 nopccommerec 中创建库存表并在 InstallationService.cs 中（NOP.Service/Installation）中编写 Web 服务器。这将在安装 NOP 应用程序时在库存表中插入值。

# ruby-on-rails-3 - 简单形式的订单关联

> ID：12451617
> 
> 赞同：7
> 
> 时间：2012-09-16T23:37:01.867
> 
> 标签：ruby-on-rails-3, simple-form

使用 simpleform 时，如何通过关联订购选择选项？我有这样的事情：

```
= f.association :color 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-17T08:20:35.500

您可以将`collection`选项传递给关联：

```
= f.association :color, collection: Color.order('created_at ASC') 
```

# javascript - 我无法隐藏 div 标签

> ID：12451618
> 
> 赞同：-3
> 
> 时间：2012-09-16T23:37:06.910
> 
> 标签：javascript, html

请看下面的代码：

```
<div id="flashwelcome" style="display: none">
  <h2 align="center">
    <script language="JavaScript1.2">
        var message = "Welcome to Dynamic Report Generation POC"
        var neonbasecolor = "green"
        var neontextcolor = "blue"
        var neontextcolor2 = "red"
        var flashspeed = 200 // speed of flashing in milliseconds
        var flashingletters = 3 // number of letters flashing in neontextcolor
        var flashingletters2 = 1 // number of letters flashing in neontextcolor2 (0 to disable)
        var flashpause = 0 // the pause between flash-cycles in milliseconds
        /**
         * No need to edit below this line
         */
        var n = 0
        if (document.all || document.getElementById) {
            document.write('<font color="' + neonbasecolor + '">')
            for (m = 0; m < message.length; m++)
            document.write('<span id="neonlight' + m + '">' + message.charAt(m) + '</span>')
            document.write('</font>')
        } else {
            document.write(message)
        }

        function crossref(number) {
            var crossobj = document.all ? eval("document.all.neonlight" + number) : document.getElementById("neonlight" + number)
            return crossobj
        }

        function neon() {
            /**
             * Change all letters to base color
             */
            if (n == 0) {
                for (m = 0; m < message.length; m++)
                crossref(m).style.color = neonbasecolor
            }

            /**
             * cycle through and change individual letters to neon color
             */
            crossref(n).style.color = neontextcolor

            if (n > flashingletters - 1) crossref(n - flashingletters).style.color = neontextcolor2
            if (n > (flashingletters + flashingletters2) - 1) crossref(n - flashingletters - flashingletters2).style.color = neonbasecolor

            if (n < message.length - 1) {
                n++
            } else {
                n = 0
                clearInterval(flashing)
                setTimeout("beginneon()", flashpause)
                return
            }
        }

        function beginneon() {
            if (document.all || document.getElementById) flashing = setInterval("neon()", flashspeed)
        }
        beginneon();​
    </script>
  </h2>               
</div> 
```

这就是我隐藏上述内容的方式，`div tag`但它并没有被隐藏，

`document.getElementById("flashwelcome").style.display = 'none';`

我不认为有什么问题，但仍然没有隐藏 div 标签。

请帮我找出问题所在。

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T00:37:53.720

正如其他人在这里指出的那样，您的 javascript 代码真的很难看。

但是，据我了解，您对 document.write 的第一次使用是覆盖 DOM 的全部内容（即您的整个页面的内容）。因此，一旦执行了第一个 document.write 语句，您的 flashwelcome div 就会消失。

您可以在此处找到代码的略微修改版本：http: [//jsfiddle.net/carlesandres/eTY4v/](http://jsfiddle.net/carlesandres/eTY4v/)

你会注意到我把你的`h2`and`flashwelcome div`移到了 document.write 句子。我还添加了 JSLint 推荐的分号和花括号（通常的 javascript 良好实践）

闪退还是不行。你必须弄清楚为什么。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T00:01:03.447

假设您正在使用代码将 div 隐藏在脚本标记中，并且所述脚本元素嵌入在**下面**的文档中，其中 id=flashwelcome 的 div 是，这应该可以正常工作。如果没有，请检查您的浏览器中是否启用了 JavaScript。

确保您的代码如下所示：

```
<div id="flashwelcome">...</div>
<script>
document.getElementById("flashwelcome").style.display = 'none';
</script> 
```

此外，您是否意识到您最初使用内联 css 来隐藏“flashwelcome”div？

* * *

正如 Musa 在评论中指出的那样：您在 h2 标记 (?) 中使用的 javascript 已经很老了。至于它的功能：你确定这样的闪烁文本是你的用户真正想在你的网站上看到的吗？

# jsf - 复合组件和ajax更新

> ID：12451620
> 
> 赞同：0
> 
> 时间：2012-09-16T23:37:15.347
> 
> 标签：jsf, primefaces

我需要使用 ajax 更新复合组件中的表单。我在使用复合组件时将 id 作为“comImplContSearch”赋予它，这样它就不会生成随机 id。在生成html后的dom中，我需要调用的表单id（在cc中）是comImplContSearch_contentListForm。并且在复合组件的 f:ajax 的 update 属性中给出。我们在 web.xml 中使用分隔符作为 '_' 而不是默认的 ':'。我需要纠正什么以避免错误。

## 复合组件代码

```
<composite:interface>
        <composite:attribute name="id"></composite:attribute>
    </composite:interface>
    <composite:implementation>
        <h:form id="contentLefNavForm" prependId="false">
            <p:tree id="folderTree"
                value="#{contentSearchController.contentListBean.folderTree}"
                var="node" styleClass="folderTree" selectionMode="single"
                animate="true" dynamic="false"
                selection="#{contentSearchController.contentListBean.selectedFolderTreeNode}"
                highlight="false" widgetVar="folderTreeHandle">
                <p:ajax event="select"
                    listener="#{contentSearchController.selectFolderNode}" update="_#{cc.attrs.id}_contentListForm"
                    />
                <p:treeNode styleClass="folderTreeRow"
                    collapsedIcon="iconColor iconFolder"
                    expandedIcon="iconColor iconFolderOpen">
                    <h:outputText value="#{node.title}" />
                </p:treeNode>
            </p:tree>
        </h:form>

        <h:form id="contentListForm" >
           .....................
          </h:form> 
```

## 使用复合组件时

```
 <h:form id="searchContentForm" prependId="false">
            <util:contentSearch id="comImplContSearch" />
        </h:form> 
```

## 错误

```
19:13:55,969 ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/emyed-web].[Faces Servlet]] (http--127.0.0.1-8080-2) Servlet.service() for servlet Faces Servlet threw exception: javax.faces.FacesException: Cannot find component with identifier "_comImplContSearch_contentListForm" referenced from "comImplContSearch_folderTree".
    at org.primefaces.util.ComponentUtils.findClientIds(ComponentUtils.java:251) [primefaces-3.3.1.jar:]
    at org.primefaces.util.AjaxRequestBuilder.addIds(AjaxRequestBuilder.java:102) [primefaces-3.3.1.jar:]
    at org.primefaces.util.AjaxRequestBuilder.update(AjaxRequestBuilder.java:90) [primefaces-3.3.1.jar:]
    at org.primefaces.component.behavior.ajax.AjaxBehaviorRenderer.getScript(AjaxBehaviorRenderer.java:63) [primefaces-3.3.1.jar:]
    at javax.faces.component.behavior.ClientBehaviorBase.getScript(ClientBehaviorBase.java:103) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at org.primefaces.renderkit.CoreRenderer.encodeClientBehaviors(CoreRenderer.java:288) [primefaces-3.3.1.jar:]
    at org.primefaces.component.tree.TreeRenderer.encodeScript(TreeRenderer.java:132) [primefaces-3.3.1.jar:]
    at org.primefaces.component.tree.TreeRenderer.encodeEnd(TreeRenderer.java:97) [primefaces-3.3.1.jar:]
    at javax.faces.component.UIComponentBase.encodeEnd(UIComponentBase.java:875) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1786) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.render.Renderer.encodeChildren(Renderer.java:168) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:845) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at com.sun.faces.renderkit.html_basic.HtmlBasicRenderer.encodeRecursive(HtmlBasicRenderer.java:304) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at com.sun.faces.renderkit.html_basic.GroupRenderer.encodeChildren(GroupRenderer.java:105) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:845) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1779) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at com.sun.faces.renderkit.html_basic.CompositeRenderer.encodeChildren(CompositeRenderer.java:78) [jsf-impl-2.1.7-jbossorg-2.jar:]
    at javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:845) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1779) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.render.Renderer.encodeChildren(Renderer.java:168) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:845) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at org.primefaces.renderkit.CoreRenderer.renderChild(CoreRenderer.java:55) [primefaces-3.3.1.jar:]
    at org.primefaces.renderkit.CoreRenderer.renderChildren(CoreRenderer.java:43) [primefaces-3.3.1.jar:]
    at org.primefaces.component.overlaypanel.OverlayPanelRenderer.encodeMarkup(OverlayPanelRenderer.java:55) [primefaces-3.3.1.jar:]
    at org.primefaces.component.overlaypanel.OverlayPanelRenderer.encodeEnd(OverlayPanelRenderer.java:35) [primefaces-3.3.1.jar:]
    at javax.faces.component.UIComponentBase.encodeEnd(UIComponentBase.java:875) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1786) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1782) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final]
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1782) [jboss-jsf-api_2.1_spec-2.0.1.Final.jar:2.0.1.Final] 
```

## 如果我删除 f:ajax 中的更新，则表单 ID 为

![在此处输入图像描述](../Images/b8a3a3975115245d1c66a01d3b77e5b0.png)

# php - 更好地解析数组或添加数据库调用？

> ID：12451622
> 
> 赞同：1
> 
> 时间：2012-09-16T23:37:40.010
> 
> 标签：php, mysql, codeigniter

我将编写两个代码来测试它们，但我很好奇这里的人们是怎么想的。

我有一组已发布到我的购物车控制器的数据。该数组包括每个产品潜在选项的条目。

要将选项放入数组以进行演示，我可以解析数组以查找键以“options-”开头的数组，或者我可以进行数据库调用并找出该产品可用的选项。

我们目前最多讨论 5 个项目。

想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T00:03:15.560

我认为这里的关键字是数据已发布到您的控制器。

你永远不应该相信用户数据。始终使用真实数据验证用户数据。因此，如果用户在购物车中添加了某些东西，请确保您返回数据库并确保添加的内容确实存在。由于您将在那时进行查询，因此最好依赖数据库中的数据。

否则，您已经在内存中拥有的数据肯定比进入数据库要快。通常，您希望避免进行不需要的额外查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T01:07:49.413

硬编码的优点

1.  更具可读性的代码
2.  更少的数据库使用。尽管您可以使用 memcached 来存储选项的键：值部分。

硬编码与数据库调用的缺点

1.  错别字会使购物车倒下。
2.  如果需要在多个位置引用选项，就会出错

# actionscript-3 - 在一个位图上加入多个 alpha 蒙版

> ID：12451625
> 
> 赞同：0
> 
> 时间：2012-09-16T23:37:55.223
> 
> 标签：actionscript-3, flash, actionscript, bitmapdata, blit

我有两层位图：
第 1 层 - 一些随机图像
第 2 层 - 用黑色填充的位图，覆盖第一个位图
我还有一个蒙版位图。我试图做这样的事情
[https://dl.dropbox.com/u/13089585/so/001.jpg](https://dl.dropbox.com/u/13089585/so/001.jpg)
但我得到这样的事情：
[https ://dl.dropbox.com/u/13089585/so/002 .jpg](https://dl.dropbox.com/u/13089585/so/002.jpg)
我尝试使用`BitmapData::copyPixels`,`BitmapData::copyChannel`并`BitmapData::draw`使用不同的参数组合来做到这一点，但仍然无法做到...我需要一些方法来覆盖 dest 上的 alpha 值。位图，但前提是该值大于 src 中的值。位图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T01:26:56.637

首先，如果您使用精灵而不是位图作为蒙版，则可以使用`BitmapData.draw()`with`BlendMode.ERASE`来获得该效果。但如果你想要半透明（例如 50% alpha），这将不起作用。

您可以做的是让蒙版位图为黑色，您希望第二张图像在其他地方透明且透明（蒙版中的 30% alpha 将在第二张位图上变为 70% alpha）。现在，创建一个`BitmapData`填充颜色为红色`draw`的第三个，`BitmapData`使用`BlendMode.DARKEN`. 然后，使用`copyChannel()`从第 3 个红色到第 2 个 alpha。

它不漂亮，但现实生活永远不会......

# c# - 为什么基于堆栈的 IL 字节码中有局部变量

> ID：12451626
> 
> 赞同：13
> 
> 时间：2012-09-16T23:38:08.513
> 
> 标签：c#, java, bytecode, local-variables

**在基于堆栈的中间语言中，例如 CIL 或 Java 字节码，为什么会有局部变量？**可以只使用堆栈。对于手工制作的 IL 来说可能并不那么容易，但编译器肯定可以做到。但我的 C# 编译器没有。

堆栈和局部变量都是方法的私有变量，并且在方法返回时超出范围。因此，它与从方法外部（来自另一个线程）可见的副作用没有任何关系。

如果我是正确的，JIT 编译器会在生成机器代码时消除对堆栈槽和局部变量的加载和存储，因此 JIT 编译器也不需要局部变量。

另一方面，即使在启用优化的情况下编译，C# 编译器也会为局部变量生成加载和存储。为什么？

* * *

例如，以下人为的示例代码：

```
static int X()
{
    int a = 3;
    int b = 5;
    int c = a + b;
    int d;
    if (c > 5)
        d = 13;
    else
        d = 14;
    c += d;
    return c;
} 
```

当用 C# 编译时，经过优化，它会产生：

```
 ldc.i4.3        # Load constant int 3
    stloc.0         # Store in local var 0
    ldc.i4.5        # Load constant int 5
    stloc.1         # Store in local var 1
    ldloc.0         # Load from local var 0
    ldloc.1         # Load from local var 1
    add             # Add
    stloc.2         # Store in local var 2
    ldloc.2         # Load from local var 2
    ldc.i4.5        # Load constant int 5
    ble.s label1    # If less than, goto label1
    ldc.i4.s 13     # Load constant int 13
    stloc.3         # Store in local var 3
    br.s label2     # Goto label2
label1:
    ldc.i4.s 14     # Load constant int 14
    stloc.3         # Store in local var 3
label2:
    ldloc.2         # Load from local var 2
    ldloc.3         # Load from local var 3
    add             # Add
    stloc.2         # Store in local var 2
    ldloc.2         # Load from local var 2
    ret             # Return the value 
```

注意四个局部变量的加载和存储。我可以在不使用任何局部变量的情况下编写完全相同的操作（忽略明显的常量传播优化）。

```
 ldc.i4.3        # Load constant int 3
    ldc.i4.5        # Load constant int 5
    add             # Add
    dup             # Duplicate top stack element
    ldc.i4.5        # Load constant int 5
    ble.s label1    # If less than, goto label1
    ldc.i4.s 13     # Load constant int 13
    br.s label2     # Goto label2
label1:
    ldc.i4.s 14     # Load constant int 14
label2:
    add             # Add
    ret             # Return the value 
```

这对我来说似乎是正确的，而且更短更高效。那么，为什么基于堆栈的中间语言有局部变量呢？为什么优化编译器如此广泛地使用它们？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-16T23:48:59.290

视情况而定，但尤其是在涉及必须重新排序参数以匹配调用的调用时，如果您没有可用的寄存器或变量，则纯堆栈是不够的。如果你想让这个只有堆栈，你需要额外的堆栈操作能力，例如交换/交换堆栈顶部的两个项目的能力。

最后，虽然在这种情况下可以将所有内容表达为纯基于堆栈的，但它会给代码增加大量复杂性，使代码膨胀并使其更难以优化（局部变量是理想的候选者）缓存在寄存器中）。

还要记住，在 .NET 中可以通过引用传递参数，如何在没有局部变量的情况下为该方法调用创建 IL？

```
bool TryGet(int key, out string value) {} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-17T22:14:24.077

这个答案纯粹是推测性的——但我怀疑答案有 3 个部分。

1：代码转换为更喜欢 Dup 而不是局部变量是非常重要的，即使您忽略了副作用。它为优化增加了很多复杂性和潜在的大量执行时间。

2：你不能忽视副作用。在所有内容都只是文字的示例中，很容易知道这些值是在堆栈中还是在局部变量中，因此完全受当前指令的控制。一旦这些值来自堆、静态内存或方法调用，您就不能再随意使用 Dup 而不是 locals。更改顺序可能会改变事情的实际工作方式，并由于副作用或对共享内存的外部访问而导致意想不到的后果。这意味着通常您无法进行这些优化。

3：堆栈值比局部变量更快的假设不是一个好的假设——对于特定的 IL-> 机器代码转换，堆栈值更快，但没有理由不让智能 JIT将堆栈位置放入内存，将局部变量放入寄存器。知道当前机器什么是快什么是慢是 JIT 的工作，解决问题是 JIT 的工作。按照设计，CIL 编译器无法回答是本地还是堆栈更快。因此，这些结果之间的可测量差异仅在于代码大小。

总而言之，1 意味着它很难并且具有不小的成本，2 意味着它有价值的现实世界案例很少，3 意味着 1 和 2 无论如何都是无关紧要的。

即使目标是最小化 CIL 大小，这对于 CIL 编译器来说是一个可衡量的目标，原因 #2 将其描述为对少量案例的小改进。帕累托原则不能告诉我们实现这种优化是一个坏主意，但它会建议可能更好地利用开发人员时间。

# bluetooth - Arduino Mega ADK 和 Itead Bluetooth Shield V2.2 无法使 AT 命令工作

> ID：12451630
> 
> 赞同：0
> 
> 时间：2012-09-16T23:38:56.313
> 
> 标签：bluetooth, arduino, at-command

我正在使用带有 Itead 蓝牙屏蔽 V2.2 和 Arduino 1.01 软件的 Arduino Mega ADK 芯片，我无法弄清楚如何让 AT 命令从 Arduino 串行监视器返回“OK”。

我为 cmd 设置了蓝牙芯片，其中 rx 在 D0 上，tx 在 D1 上，并且开关处于 cmd 模式，就像手册显示它应该为 cmd 配置一样。（见下面的链接）

[http://iteadstudio.com/store/images/produce/Shield/BTshieldv2.2/BTShieldV2.2_DS.pdf](http://iteadstudio.com/store/images/produce/Shield/BTshieldv2.2/BTShieldV2.2_DS.pdf)

然后我在芯片上尝试了一个应用程序，例如不涉及串行命令的闪烁，当我打开串行监视器时，我能够输入命令但没有收到响应。我也尝试了监视器的每种类型的波特率。

我计划使用 Amarino 应用程序来控制蓝牙芯片，但我找不到任何帮助来让这些命令正常工作。任何帮助，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T18:55:18.047

事实证明，我仍然无法让串行监视器返回任何值，所以我决定使用 tera term，它的工作简单了百万倍，并且使更改蓝牙芯片上的配置变得简单。

# memory-management - 解读 F# 垃圾回收报告

> ID：12451631
> 
> 赞同：1
> 
> 时间：2012-09-16T23:39:02.943
> 
> 标签：memory-management, f#, garbage-collection

我有一个相当复杂的 F# 应用程序，我使用 F# 脚本使用`#time`指令检查其性能。这个想法是我在更改代码后运行脚本以跟踪性能并避免引入速度或内存问题。

我得到的报告是这样的：

```
Real: 00:00:02.908, CPU: 00:00:02.948, GC gen0: 237, gen1: 3, gen2: 1 
```

但是在最后一次更改之后，我得到了这个：

```
Real: 00:00:03.058, CPU: 00:00:03.057, GC gen0: 262, gen1: 262, gen2: 0 
```

我很难弄清楚发生了什么。

更多的第 1 代垃圾收集意味着（？）有更多的长寿对象在第 0 代的垃圾收集中幸存下来 - 但为什么突然从 3 跳到 262？为什么第 0 代和第 1 代的垃圾回收次数相同？如果由于某种原因在代码更改后有更多长寿命的对象，我会期待这样的事情：

```
Real: 00:00:02.908, CPU: 00:00:02.948, GC gen0: 212, gen1: 54, gen2: 1 
```

即垃圾收集对象的总数相似，但第一代更多。

还是我完全误解了这些数字（我在文档中找不到描述）？

**更新**

正如评论中所指出的，我完全误解了这些数字：它们是每一代执行的垃圾收集的数量，而不是对象的数量。

说了这么多，我更纳闷了：好像我的应用程序把内存置于这样一种状态，每次0代垃圾回收都会触发1代垃圾回收，我无法想象这种状态会是什么。我尝试了各种测试程序来复制这种行为，但没有运气。

我仍然必须按照评论和垫的答案中的建议尝试分析器。

**更新 2**

我按照评论中的建议尝试了 CLR 探查器 - 为此，我将 F# 脚本转换为程序并从探查器运行它。

我得到的报告与垃圾收集完全不同`#time`：

*   第 0 代：279
*   第 1 代：5
*   第 2 代：2。

神秘 - 与独立程序相比，使用 FSI.exe 的副作用？错误`#time`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T05:26:47.643

.NET GC 是三代 GC。正如 John Palmer 所指出的，最后三个数字是这些世代[运行的集合数量。](https://github.com/fsharp/fsharp/blob/master/src/fsharp/fsi/fsi.fs#L124)较大的数字通常表示性能不佳`gen1`，`gen2`因为 GC 必须在每个垃圾收集过程中一次又一次地标记那些未使用的对象。有关 .NET GC 的更深入介绍，请查看[这篇不错的文章](http://blogs.msdn.com/b/abhinaba/archive/2009/03/02/back-to-basics-generational-garbage-collection.aspx)。

这里有一些建议：

1.  确保在两次测量之间“重置会话”，以便第一个会话的未使用对象不会影响第二个会话。
2.  找到三个更大的输入来测量。尽管这两个报告中的执行时间相似，但我希望第一种方法更具可扩展性。如果您有多个输入大小来测试可伸缩性，那就太好了。
3.  测量几次以记录模式，因为您可能只是观察到*异常*会话。
4.  如果有疑问，请在 Visual Studio 中进行[全面分析。](http://msdn.microsoft.com/en-us/library/ms242740%28v=vs.100%29.aspx)他们的报告在性能预测方面更加全面和可靠。

# sql - 如何对一系列日期使用谓词

> ID：12451637
> 
> 赞同：0
> 
> 时间：2012-09-16T23:40:05.507
> 
> 标签：sql, cocoa, core-data, nspredicate

我有一个（SQL）代码数据实体，其属性名为`date`. 我构造一个谓词并获取请求，并声明一个数组来保存结果，如下所示

```
NSDate *firstDate = <date1>;
NSDate *lastDate = <date2>;
NSArray *dates = [NSArray arrayWithObjects: firstDate, lastDate, nil];
NSPredicate *myPredicate = [NSPredicate predicateWithFormat: 
    @"date BETWEEN %@", dates];

NSFetchRequest * req = [NSFetchRequest fetchRequestWithEntityName:@"myEntity"];
NSArray * results; 
```

以下作品

```
results = [managedObjectContext executeFetchRequest:req error:nil];
// gets all records
results = [results filteredArrayUsingPredicate:myPredicate];
// results now has the records I wanted 
```

但以下不

```
req.predicate = myPredicate;
NSArray * results = [managedObjectContext executeFetchRequest:req error:nil]; 
```

这在控制台中

-[__NSTaggedDate constantValue]：无法识别的选择器发送到实例...

必须检索所有记录然后过滤它们似乎是错误的。为什么谓词不能与 fetch 请求一起使用？这是 SQLite 限制吗？我知道日期存储为`NSTimeInterval`s （即双打），并在谓词中尝试了这些，但类似的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T13:18:03.613

也许这就是你要找的..

datePredicate = [NSPredicate predicateWithFormat:@"(%@ <= date && date <= %@)", endDate, startDate];

并且 endDate 和 startDate 是 NSDate

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-17T13:13:54.367

崩溃的原因是数组中的东西不应该是`NSDate`实例。应该是`NSExpression`对象，其`constantValue`是`NSDate`. [聚合表达式](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSExpression_Class/Reference/NSExpression.html)的文档说明了这一点：

> 聚合表达式允许您创建包含表达式的谓词，这些表达式评估为包含更多表达式的集合。

所以你的收藏必须包含表达式，而不是日期。

# bash - 调用 Unix shell 脚本的方法（“.”、“source”）

> ID：12451638
> 
> 赞同：1
> 
> 时间：2012-09-16T23:40:15.640
> 
> 标签：bash, unix

要激活 TurboGears virtualenv（仅作为示例），请执行以下操作：

```
. bin/activate 
```

或这个：

```
source bin/activate 
```

1.  为什么当前目录是“.” 作为命令工作？

2.  为什么使用“来源”或“。” 有吗？为什么不简单地“bin/activate”？

（我对此进行了一些网络搜索，但“。”和“来源”得到了很多不好的点击。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-16T23:42:10.463

1.  `.`在这种情况下，并不意味着“当前目录”。它只是`source`.
2.  获取脚本（使用`.`or `source`）在*当前*shell 的上下文中运行脚本，而不是启动子 shell。这意味着它可以对您当前的 shell 环境进行修改。简单地运行一个脚本不能做到这一点。例子：

    ```
    $ cat script
    VARIABLE=something
    $ echo $VARIABLE

    $ ./script 
    $ echo $VARIABLE

    $ . ./script
    $ echo $VARIABLE
    something 
    ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T01:51:56.760

您可能使用“。”的另一个原因。或“源”来执行脚本是如果有问题的脚本不以“#!/bin/bash”（[shebang](http://en.wikipedia.org/wiki/Shebang_%28Unix%29 "社邦")）开头，它告诉 shell 哪个程序应该解释有问题的脚本。

# jquery - 如何在图像延迟加载（jQuery）后更改 CSS？

> ID：12451641
> 
> 赞同：1
> 
> 时间：2012-09-16T23:41:01.107
> 
> 标签：jquery, css, image, loading, lazy-evaluation

我遇到了以下问题：用户单击缩略图后，会通过延迟加载加载更大的图像并打开。加载更大图像的代码是：

```
<img width="663" height="845" class="big" data-original="real/path/to/image" src="path/to/empty/small/picture"> 
```

当用户单击缩略图时，将执行以下代码：

```
$("img.thumb").click(function() 
 {      
    var $cont = $(this).siblings('.item-content').children('.big'); 
    $cont.attr('src', $cont.attr("data-original"));
    setTimeout(function(){
        $cont.css({'height': 'auto', 'width': '100%'});
    }, 600);
 }); 
```

每个大图像都必须将 CSS`"height"`设置为`"auto"`，并且`"width"`设置为，`"100%"`因为我正在制作响应式/流体布局。上面的代码`"src"`从属性中获取它的属性值`"data-original"`。但是`"height: auto"`，`"width:100%"`在本例中设置为`600ms`在属性进行替换之后。这不起作用，因为我为此使用了 Isotope jQuery 插件（[http://isotope.metafizzy.co/](http://isotope.metafizzy.co/)），并且该插件需要元素的实际宽度和高度才能正确定位网格。在加载图像期间设置`"height: auto"`和`"width:100%"`时，插件会丢失并使元素位置不正确。

那么如何在图像加载后对其进行编码以设置这两个 CSS 属性呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:51:28.707

您可以使用`.load()`

```
$('img.big').load(function() {
    if($(this).attr('src') == $(this).attr('data-original')) {
        $(this).css({'height': 'auto', 'width': '100%'});
    }
}); 
```

[http://jsfiddle.net/TYufy/4/](http://jsfiddle.net/TYufy/4/) - 使用示例`.load()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T01:32:18.800

好吧，我找到了解决方案：有一个名为[imagesLoaded](https://github.com/desandro/imagesloaded)的小型 jQuery 插件。在加载所有选定的子图像后触发回调。问题是你不能`.load()`在缓存的图像上做。

# java - 什么 LayoutManager 可以将 JLabel 或 JTextField 的高度与其字体大小相匹配？

> ID：12451647
> 
> 赞同：3
> 
> 时间：2012-09-16T23:41:58.020
> 
> 标签：java, swing, layout-manager

我有几个`JPanel`s ，其中包含`JLabel`s 和`JTextField`s 用于我的 Swing 应用程序中的用户输入。

我正在手动编辑 NetBeans GUI Builder 生成的代码，但仍希望保持类似的布局。

我开始使用`GridLayout`. 我可以调整s`hgap`以使我`JLabel`的 s 和`JTextField`s 大小合适，但我必须为所有`JPanel`s 单独执行此操作。

是否有一个标准`LayoutManager`可以根据组件的字体大小计算文本组件的正确高度，并在文本组件之间和/或周围用空格填充包含组件？

**编辑：**

根据要求，这是一个 SSCCE 来展示我正在尝试做的事情

网格布局SSCCE：

```
package gridlayoutsscce;

import javax.swing.JFrame;
import javax.swing.SwingUtilities;

public class GridLayoutSSCCE {
    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                JFrame f = new JFrame("Grid Layout SSCCE");
                f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                f.add(new GridLayoutSSCCEPanel());
                f.pack();
                f.setVisible(true);
            }
        });
    }
} 
```

GridLayoutSSCCEPanel：

```
package gridlayoutsscce;

import java.awt.GridLayout;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextField;

class GridLayoutSSCCEPanel extends JPanel {
    public GridLayoutSSCCEPanel() {
        this.setLayout(new GridLayout(2, 2));
        this.add(new JLabel("Label 1:"));
        this.add(new JTextField());

        this.add(new JLabel("Label 2:"));
        this.add(new JTextField());
    }
} 
```

当我第一次运行程序时，这看起来很好。但是，当我调整窗口大小时，文本字段会伸展，因此每个字段都填充了窗口高度的一半。我希望它们在窗口调整大小时保持原来的高度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-16T23:57:57.853

[`GridBagLayout`](http://docs.oracle.com/javase/tutorial/uiswing/layout/gridbag.html)会做你想做的，虽然它是高度灵活的，但它也被认为是最复杂的之一。

我肯定`MigLayout`会得到提及，但我从未亲自使用过它，我也应该提到[JGoodies`FormLayout`](http://www.jgoodies.com/freeware/libraries/forms/)，但同样，我从未使用过它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T13:51:50.370

朋友不要让朋友使用 GridBagLayout（我们都是朋友，对吧？）

使用 JGoodies 表单布局，这可以完成您所说的您希望 SSCCE 执行的操作：

```
class MyFormLayoutSSCCEPanel extends JPanel {
  public MyFormLayoutSSCCEPanel() {
    FormLayout layout = new FormLayout(
      "pref, pref:grow",   // columns
      "pref, pref");       // rows
    this.setLayout(layout);

    CellConstraints cc = new CellConstraints();
    this.add(new JLabel("Label 1:"), cc.xy(1,1));
    this.add(new JTextField(), cc.xy(2, 1));

    this.add(new JLabel("Label 2:"), cc.xy(1, 2));
    this.add(new JTextField(), cc.xy(2, 2));
  }
} 
```

*（请注意，这并不能完全*重现原始 SSCCE 的行为- 我已经告诉它水平扩展文本字段以占用所有可用空间。）

不过，我不建议切换到 JGoodies - 您至少需要在默认的 Swing 布局管理器上浪费几个星期的时间，然后才能正确地体会到 JGoodies formlayout 将为您节省的工作量。

# drupal - 在drupal commerce上更新大量产品

> ID：12451649
> 
> 赞同：1
> 
> 时间：2012-09-16T23:42:14.537
> 
> 标签：drupal, updates, product, drupal-commerce

我想问一下如何更新我的产品的某些字段，例如价格、图片、统计信息？请注意，我有大约 6.000 个产品。我尝试了与导入它们相同的方式，但我收到此错误 SQLSTATE[23000]：完整性约束违规：1062 密钥 2 的重复条目。所以实际上模块找到了 SKU 的重复项并确实不更新字段。我想要的方式是模块查看 SKU，然后更新某些产品的字段，例如覆盖。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T09:04:37.540

我认为[commerce_product_save](http://drupalcontrib.org/api/drupal/contributions!commerce!modules!product!commerce_product.module/function/commerce_product_save/7)会为您完成任务。该函数与 node_save 非常相似。

您可以拥有所有更改的 csv 文件。导入时检查 SKU 是否存在，如果存在则使用此功能更新现有产品。否则，您可以创建新产品。

# python - python中的多进程快速排序挂起大量元素

> ID：12451651
> 
> 赞同：1
> 
> 时间：2012-09-16T23:42:24.670
> 
> 标签：python, multiprocessing, quicksort

为了进一步了解 python 中的进程，我决定使用多个进程来实现快速排序。它似乎在元素少于 ~21K 的列表上工作正常，但任何更大的（比如 25K 元素）它只是挂起。

我试过这个`import sys; sys.setrecursionlimit(2**30)`伎俩无济于事。这仅仅是因为 python 不喜欢真正的深度递归吗？有趣的是，相同的算法在大约 50k 个元素上作为单个进程运行良好。

```
import random, multiprocessing, time

DESIRED_PROC_DEPTH = 2
proc_depth = 1 #start at one to count the parent process that kicks this all off

def main():
    import sys; sys.setrecursionlimit(2**30)
    num_elements = 20000
    list_of_numbers = [random.randint(0,num_elements) for num in range(num_elements)]
    # print list_of_numbers
    simple_start = time.time()
    simple_sorted = simple_qs(list_of_numbers)
    simple_total_time = time.time() - simple_start
    print "Using a single thread we sorted " + str(num_elements) + " elements in " + str(simple_total_time) + " seconds"
    the_q = multiprocessing.Queue()
    sorter = MTQuickSort(list_of_numbers, the_q)
    start = time.time()
    sorter.start()
    sorter.join()
    mt_total_time = time.time() - start
    sorted_list = the_q.get()
    # print sorted_list
    print "Sorted " + str(num_elements) + " elements in " + str(mt_total_time) + " seconds"

class MTQuickSort(multiprocessing.Process):

    def __init__(self, list_to_sort, queue):
        super(MTQuickSort, self).__init__()
        print self.name
        self.queue = queue
        self.list = list_to_sort

    def run(self):
        self.queue.put(self.quicksort(self.list))

    def quicksort(self, list):
        global proc_depth
        global DESIRED_PROC_DEPTH
        if len(list) is 0:
            # base case is that list is empty
            return []
        else:
            pivot = list[0]
            less = [x for x in list[1:] if x <= pivot]
            greater = [x for x in list[1:] if x > pivot]
            if proc_depth < DESIRED_PROC_DEPTH:
                proc_depth += 1
                # We create threads in blocks of two since we partition the list into two parts
                lessor_q = multiprocessing.Queue()
                greater_q = multiprocessing.Queue()
                qs_process1 = MTQuickSort(less, lessor_q)
                qs_process2 = MTQuickSort(greater, greater_q)
                qs_process1.start()
                qs_process2.start()
                qs_process1.join()
                qs_process2.join()
                return lessor_q.get() + [pivot] + greater_q.get()
            else:
                less_than_pivot = self.quicksort(less)
                greater_than_pivot = self.quicksort(greater)
                return less_than_pivot + [pivot] + greater_than_pivot

def simple_qs(list):
    if len(list) is 0:
        # base case is that list is empty
        return []
    else:
        pivot = list[0]
        return simple_qs([x for x in list[1:] if x <= pivot]) + [pivot] + simple_qs([x for x in list[1:] if x > pivot])

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T09:32:37.790

这是由于您在从队列中获取（）结果之前加入（）子进程。显然，队列不会急切地从子进程中读取数据。因此，当您调用 join() 时，调用者的进程会一直等到子进程完成，但子进程本身正在等待尝试将数据发送到管道到其父进程。

如果我在相应的 get() 之后移动各种 join()，它就可以工作。

# python - 在 Python 中使用正则表达式提取文本

> ID：12451655
> 
> 赞同：1
> 
> 时间：2012-09-16T23:43:22.393
> 
> 标签：python, regex

如何从以下可能的排列中提取`roundUp(...)`using （或其他一些衍生物）：`regex`

```
[[[ roundUp( 10.0 ) ]]]
[[[ roundUp( 10.0 + 2.0 ) ]]]
[[[ roundUp( (10.0 * 2.0) + 2.0 ) ]]]
[[[ 10.0 + roundUp( (10.0 * 2.0) + 2.0 ) ]]]
[[[ 10.0 + roundUp( (10.0 * 2.0) + 2.0 ) + 20.0 ]]] 
```

我问的原因是我想在我的代码`roundUp(...)`中用`math.ceil((...)*100)/100.0`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-16T23:50:27.163

这是python，你为什么不重新绑定名称`roundUp`：

```
def my_roundup(x):
  return math.ceil(x*100)/100.

roundUp = my_roundup 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T00:23:49.880

您无法使用正则表达式解决一般情况。正则表达式的功能不足以表示类似于堆栈的任何内容，例如嵌套到任意深度的括号或 XML 标记。

如果您*在*python 中解决问题，您可以执行类似的操作

```
import re

def roundup_sub(m):
    close_paren_index = None
    level = 1
    for i, c in enumerate(m.group(1)):
        if c == ')':
            level -= 1
        if level == 0:
            close_paren_index = i
            break
        if c == '(':
            level += 1
    if close_paren_index is None:
        raise ValueError("Unclosed roundUp()")
    return 'math.ceil((' + m.group(1)[1:close_paren_index] + ')*100)/100.0' + \
            m.group(1)[close_paren_index:]    # matching ')' and everything after

def replace_every_roundup(text):
    while True:
        new_text = re.sub(r'(?ms)roundUp\((.*)', roundup_sub, text)
        if new_text == text:
            return text
        text = new_text 
```

这使用 re.sub 的 repl=function 形式，并使用正则表达式查找开头和 python 匹配括号并决定在哪里结束替换。

* * *

使用它们的一个例子：

```
my_text = """[[[ roundUp( 10.0 ) ]]]
[[[ roundUp( 10.0 + 2.0 ) ]]]
[[[ roundUp( (10.0 * 2.0) + 2.0 ) ]]]
[[[ 10.0 + roundUp( (10.0 * 2.0) + 2.0 ) ]]]
[[[ 10.0 + roundUp( (10.0 * 2.0) + 2.0 ) + 20.0 ]]]"""
print replace_every_roundup(my_text) 
```

这给了你输出

```
[[[ math.ceil((10.0 )*100)/100.0) ]]]
[[[ math.ceil((10.0 + 2.0 )*100)/100.0) ]]]
[[[ math.ceil(((10.0 * 2.0) + 2.0 )*100)/100.0) ]]]
[[[ 10.0 + math.ceil(((10.0 * 2.0) + 2.0 )*100)/100.0) ]]]
[[[ 10.0 + math.ceil(((10.0 * 2.0) + 2.0 )*100)/100.0) + 20.0 ]]] 
```

* * *

另一种选择是实现一个正则表达式，它可以处理一定深度的嵌套括号。

# objective-c - 检查是否已经创建了 UIViewController

> ID：12451657
> 
> 赞同：0
> 
> 时间：2012-09-16T23:43:35.000
> 
> 标签：objective-c, uiviewcontroller, uinavigationcontroller

我正在尝试检查是否已经创建了视图控制器。如果视图已经存在，那么它应该成为当前视图。如果它不存在，那么应该创建它并使其可见。

我的代码是

```
 DemoViewController *demoController = [DemoViewController alloc];
        for(DemoViewController *view in self.navigationController.viewControllers)
        {
            if([view isKindOfClass:[DemoViewController class]])
            {
                viewExists=true;
                demoController=view;
            }

        }
        if (!viewExists) {
            demoController initWithNibName:@"DemoViewController" bundle:nil;
        }
        [view release];
        [demoController release]; 
```

我不确定我哪里出错了，但似乎 for 循环没有被执行。任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T00:52:54.027

试试这样：

```
DemoViewController* demoController = nil;
for(int vv=0; vv<[self.navigationController.viewControllers count]; ++vv) {
    NSObject *vc = [self.navigationController.viewControllers objectAtIndex:vv];
    if([vc isKindOfClass:[DemoViewController class]]) {
        demoController = (DemoViewController*)vc;
    }
}

if (demoController == nil) {
    demoController = [[DemoViewController alloc] initWithNibName:@"DemoViewController" bundle:nil];
    // Do we need to push it into navigation controller?
}

[demoController release]; 
```

# c# - 防止图像被阻止覆盖，因为它是作为背景动态加载的

> ID：12451659
> 
> 赞同：0
> 
> 时间：2012-09-16T23:43:38.060
> 
> 标签：c#, image, background, overwrite, blocked

编辑：另请参阅我关于此程序的较早帖子以获取背景信息[C# - 在其他程序中编辑时实时更新 BackgroundImage](https://stackoverflow.com/questions/12375294/c-sharp-making-a-backgroundimage-update-in-real-time-while-editing-it-in-other)

我创建了一个图像查看器，它将所选图像显示为“表单”的背景。

在我关闭程序之前，我加载的所有图像都不会被其他应用程序覆盖，例如 Photoshop 或 GIMP 等图像处理应用程序。

我的代码很简单：

```
public partial class Form1:Form {
    private string FileName;

    public Form1() {
        InitializeComponent();

        FileName = "";
        openFileDialog1.Filter = "PNG Files (*.png)|*.png|JPG Files (*.jpg)|*.jpg";
    }

    private void button1_Click( object sender, EventArgs e ) {
        if(openFileDialog1.ShowDialog() == DialogResult.OK) {
            button2.Enabled = true;
            FileName = openFileDialog1.FileName;
            setImage();
        }
    }

    private void button2_Click( object sender, EventArgs e ) {
        setImage();
    }

    private void setImage() {
        Stream str=new FileStream( FileName, FileMode.Open, FileAccess.Read, FileShare.Read);
        Bitmap tempImg= new Bitmap( Bitmap.FromStream(str) );
        str.Close();
        using( tempImg = new Bitmap(FileName) ) {
            Rectangle rect = new Rectangle(0, 0, tempImg.Width, tempImg.Height);
            PixelFormat format = tempImg.PixelFormat;

            this.BackgroundImage = new Bitmap(FileName).Clone(rect, format);
        }
        openFileDialog1.FileName = "";
    }
} 
```

我怎么解决这个问题 ？

更新 ：

这段代码对我不起作用。

```
 private void setImage() {
        // using (FileStream stream = new FileStream("MyImage.png", FileMode.Open, FileAccess.Read))
        //var image = Image.FromStream(stream); 
        using( new FileStream( FileName, FileMode.Open, FileAccess.Read, FileShare.Read) ) {
            Stream str=new FileStream( FileName, FileMode.Open, FileAccess.Read, FileShare.Read);
            Bitmap tempImg= new Bitmap( Bitmap.FromStream(str) );
            str.Close();
            tempImg = new Bitmap(FileName);
            Rectangle rect = new Rectangle(0, 0, tempImg.Width, tempImg.Height);
            PixelFormat format = tempImg.PixelFormat;

            this.BackgroundImage = new Bitmap(FileName).Clone(rect, format);
        }
        openFileDialog1.FileName = "";
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T23:49:22.860

```
using (FileStream stream = new FileStream("MyImage.png", FileMode.Open, FileAccess.Read))
{
   var image = Image.FromStream(stream);

    // Do something with the image.
}

// The image will not be locked here. 
```

# devise - 设计：users_controller.rb 中的“def create”不起作用？

> ID：12451661
> 
> 赞同：0
> 
> 时间：2012-09-16T23:44:22.063
> 
> 标签：devise

我一直在努力让设计的 users_controller.rb 中的“def create”和“def update”能够正常工作。

例如，我试过这个：

```
 def create

    @user = User.new(params[:user])

  respond_to do |format|
    if @user.save
      flash[:notice] = "Test Save"
    else
      flash[:notice] = "Test Error"
    end
  end

  end 
```

我已将此代码与适当的代码一起使用，以在视图部分显示 Flash 通知。但是，当我提交空白表格、不完整表格或完整表格时，什么都没有显示。用户注册仍会以完整的形式完成，但它不遵循我在“def create”中输入的任何内容。除了快速通知之外，我还尝试了其他测试方法，例如发送到不同的页面等。我没有得到任何回应。“def update”也是如此，它似乎甚至没有使用该代码。

我对这个完全傻眼了，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T16:07:46.157

如果我正确理解您的问题，您应该覆盖设计控制器。

```
# app/controllers/registrations_controller.rb
class RegistrationsController < Devise::RegistrationsController
  def new
    super
  end

  def create
    # add custom create logic here
  end

  def update
    super
  end
end 
```

你可以在这里看到默认的设计控制器在做什么： [https ://github.com/plataformatec/devise/tree/master/app/controllers/devise](https://github.com/plataformatec/devise/tree/master/app/controllers/devise)

如果您只想编辑 flash 消息，查看上面的链接表明 devise 使用了一个名为[set_flash_message的方法](https://github.com/plataformatec/devise/blob/master/app/controllers/devise_controller.rb#L166)

```
 # Sets the flash message with :key, using I18n. By default you are able
  # to setup your messages using specific resource scope, and if no one is
  # found we look to default scope.
  # Example (i18n locale file):
  #
  #   en:
  #     devise:
  #       registrations:
  #         signed_up: 'Welcome! You have signed up successfully.' 
```

所以你可以用正确的文本编辑你的 devise.en.yml 文件，瞧！

注意：如果您确实覆盖了控制器，请不要忘记添加

```
# app/config/routes.rb
devise_for :users, :controllers => {:registrations => "registrations"} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:59:17.170

这个怎么样？

```
if @user.save
  redirect_to @user, notice: 'User was successfully created.'
else
  render action: 'new'
end 
```

您正在设置`flash`，但没有重定向，也没有渲染。我想知道你是得到一个空白页，还是没有正文的 200 页。

这将重定向到 show 操作，`flash`如果成功则设置通知并呈现`new`表单并`@user.errors`显示失败的原因。

如果您使用的是设计，您可以使用注册控制器创建一个新帐户，您不需要创建一个新帐户。`registrations#create`如果您创建一个新的，则在指向和`users#create`指向的路线中可能存在冲突`POST /users`

# jpa - 使用 JPA 在父/子关系中加载子实体

> ID：12451664
> 
> 赞同：1
> 
> 时间：2012-09-16T23:44:52.700
> 
> 标签：jpa, join, parent-child, fetch

我的域有一个 Category 实体，它本身具有双向关系。每个类别都可以有一个父级和一个子级。

```
@Entity
public class Category implements DomainObject {

    private Long id;
    private Integer version;
    private String name;
    private Category parent;
    private Set<Category> children;

    @Override
    @Id
    @GeneratedValue
    public final Long getId() {
        return id;
    }

    @Version
    public Integer getVersion() {
        return version;
    }

    public void setVersion(Integer version) {
        this.version = version;
    }

    public void setId(Long id) {
        this.id = id;
    }

    @Column(unique=true, nullable=false)
    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    @ManyToOne
    public Category getParent() {
        return parent;
    }

    public void setParent(Category parent) {
        this.parent = parent;
    } 

    @OneToMany
    @JoinColumn(name = "parent_id")
    public Set<Category> getChildren() {
        return children;
    }

    public void setChildren(Set<Category> children) {
        this.children = children;
    }
} 
```

我创建了以下查询来获取具有直接（1 级）子级的“根”类别。

```
select distinct c from Category c left join fetch c.children where c.parent is null order by c.name 
```

这实际上有效。我的问题是：为什么我需要 getChildren() 上的“JoinColumn”注释来完成这项工作，为什么我不能只进行“foin fetch”查询，而不需要“distinct”？如果我删除“不同”，我会得到一个乘法。对于父级的每个子级，将整个父级复制到结果集中。

有一个更好的方法吗？只是感觉……有点蹩脚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T14:30:27.307

在 JPA 中，您需要在加入 OneToMany 时设置 distinct，否则它将返回重复项。这是必需的。

JPA 规范要求这样做，但这是一个奇怪的默认设置，但与数据库连接中发生的情况有关。

# mysql - mysql alter table 卡在准备状态

> ID：12451675
> 
> 赞同：0
> 
> 时间：2012-09-16T23:48:27.943
> 
> 标签：mysql, django, django-south, django-database

我最近尝试将我的数据库中的一列更改为我的 django 项目的南迁移，从 CharField 到 IntegerField

我做了一个`python manage.py schemamigration appname --auto`

然后我应用了迁移，它就挂了。在本地尝试之前，我愚蠢地在我的生产服务器上运行了这个。一旦我在本地尝试过，我的回溯中就会出现这个错误

```
 File "/Library/Python/2.7/site-packages/MySQL_python-1.2.3-py2.7-macosx-10.7-intel.egg/MySQLdb/cursors.py", line 92, in _warning_check
_mysql_exceptions.Warning: Data truncated for column 'pickup_id' at row 1 
```

当我进入 mysql 工作台并尝试将更改恢复回 CharField 时，它只是挂在“准备”状态并最终超时。我的网站只是挂在使用此表的任何地方，我无法对这个特定表执行任何查询。

我愿意接受任何建议。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T18:13:58.710

最终的工作是将 --fake 参数应用于我的迁移调用

```
./manage migrate appname --fake 
```

# bash - 用于生成附加到同一屏幕会话的四个终端的 Bash 脚本

> ID：12451677
> 
> 赞同：2
> 
> 时间：2012-09-16T23:48:40.803
> 
> 标签：bash, gnome, gnu-screen

我正在尝试编写一个脚本来创建四个终端，每个终端都运行自己的屏幕实例，向第一个发送 bash 命令（在我的示例中为顶部），然后将该会话链接到其他每个终端。请参阅帖子的结尾，了解我为什么要这样做。

无论如何，它几乎可以满足我的要求；我最终得到了四个终端，每个终端都运行自己正确命名的屏幕实例，除了最后一个之外，所有终端都链接到原始会话。但不是最后一个。所以这是代码，我希望有人可以让我知道为什么它的行为不符合预期：

```
#!/bin/bash

for i in {1..4}
do
    gnome-terminal --window-with-profile=hdesk$i -e 'screen -S hdesk'$i
done

screen -XS hdesk1 stuff 'top^M'

for i in {2..4}
do
    screen -XS hdesk$i stuff 'screen -x hdesk1^M'
done 
```

我尝试从终端逐行执行相同的操作，而不是将其作为脚本运行，并且效果很好。出于某种原因，会话“hdesk4”虽然存在，但并未附加“hdesk1”。

至于为什么，我正在使用 compiz，并且我希望这个终端具有粘性（存在于所有虚拟桌面上）。但是我在两排四个中有八个虚拟桌面，我不希望在最上面一行粘贴，只是在底部，所以我不能只将单个终端设置为粘性。因此，任何实现该目标但完全避免这种屏幕混乱的解决方案也将受到欢迎。

**编辑**：它现在可以工作了，尽管我没有对代码或在不工作和工作之间的任何其他内容进行任何更改。刚刚暂停了我的电脑一夜之间并没有暂停。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T05:52:38.903

我试过你的代码，想出了这个：

```
#!/bin/bash

for i in {1..4}
do
    gnome-terminal --window-with-profile=hdesk$i -e 'screen -S hdesk'$i
done

screen -XS hdesk1 stuff 'top^M'

for i in {2..4}
do
    screen -XS hdesk$i stuff 'screen -x hdesk1^M'
    sleep 1
done 
```

我不知道为什么会这样，**也许** `screen`拒绝连接太快？

# memory - 将内存设置为高，然后将 set_time_limit 设置为 0

> ID：12451683
> 
> 赞同：0
> 
> 时间：2012-09-16T23:50:02.050
> 
> 标签：memory, memory-leaks, php

在 PHP 中，如果我通过设置内存 100M`ini_set`然后我设置`set_time_limit(0);`这是否意味着我的 PHP 内存分配永远是 100M（直到我重新启动我的 Apache）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T23:52:24.740

在脚本执行结束时不会将其重置为原始状态。

[从手册：](http://php.net/manual/en/function.ini-set.php)

> 字符串 ini_set ( 字符串 $varname , 字符串 $newvalue )
> 
> 设置给定配置选项的值。配置选项将在脚本执行期间保留此新值，并将在脚本结束时恢复。

并被`set_time_limit(0);`同等对待。

例子：

```
// 1\. Script starts
echo ini_get('memory_limit');//128M

// 2\. We set a new limit the script will now have 100M
ini_set('memory_limit','100M');
echo ini_get('memory_limit'); //100M

die;
// 3\. Script ends now its set back to 128M 
```

它`set_time_limit(0);`只是告诉脚本不要超时，但说你要`set_time_limit(0);`在循环中使用，然后在每次迭代中，它的内部计数器一遍又一遍地设置为 0。

因此，如果您要`set_time_limit(1);`在循环中使用，只要循环的每次迭代持续时间不超过 1 秒，那么它仍然不会超时，因为`set_time_limit(n);`每次迭代都会将内部超时计数器重置为 0。

1秒后不超时的示例：

```
for($i=0;$i<=10;$i++){
    set_time_limit(1);
    usleep(999998); //2micro seconds from a second
    echo $i;
} 
```

# javascript - 有没有办法以编程方式禁止触发 jstree“创建”事件？

> ID：12451686
> 
> 赞同：1
> 
> 时间：2012-09-16T23:50:40.160
> 
> 标签：javascript, jquery, events, jstree

这是我的困境：我同时使用上下文菜单并以编程方式创建新的 jstree 节点。我遇到的问题是，当我以编程方式创建一个新的 jstree 节点时，它也会触发 contextmenu`.create`绑定事件。

因此，从本质上讲，由于进行了手动创建调用以及上下文菜单创建绑定，因此会发生重复。**我通过在 contextmenu create 事件处理程序中放置一个if**语句来部分解释这一点，以防止它在以编程方式触发事件时运行其内容。

但是，仍然会导致重复，因为无论如何都会调用上下文菜单绑定。

`create`有没有办法在以编程方式调用时抑制上下文菜单创建事件？

这是代码：

“创建”的上下文菜单事件处理程序：

```
 .bind("create.jstree", function(e, data) {
        debugger;
        // Ajax call to Server with parent node id and new node text
        if($("#RMSDoc_RequirementFlag").val() == "CONTEXT")
        {
            $.ajax({
                "type": "POST",
                "url": '@Url.Content("~/RMS/insertRMSNode")',
                "data": {
                        "ParentID" : parseInt(ParentNode),
                        "Level" : parseInt(ParentLevel),
                        "ChildNodeText" : data.rslt.obj.text()
                },
                "success": function(new_data) {
//                    $.jstree._reference($("#RequirementsTree")).refresh(-1);
                    var addedNode = data.rslt.obj;

                    $(addedNode).attr("id", "rbs_" + new_data.RMSHierarchyId);
                    $(addedNode).attr("name", "rlevel_" + new_data.Level);
                    $(addedNode).addClass("jstree-closed");
                    ParentNode = null;
                    ParentLevel = null;
                    data = null;
                    return new_data;
                }   
            });
        }

        BranchReqFLag = null; 
```

这是以编程方式调用的`create`方法：

```
 function ReqSuccess(response) {
    // Dynamically add tree branch only (for ipad)
    if($("#RMSDoc_RequirementFlag").val() == "ADD_BRANCH_ONLY") {
        $("#RMSDoc_TreeBranch_id").val("0");
        $("#RMSDoc_TreeBranch_Text").val("");
        $("#RequirementsTree").jstree("create", null, "last", {"data" : response.TreeBranch.Text,
                                                                "state" : "closed",
                                                                "attr" : { "id" : "rbs_" + response.TreeBranch.id, "name" : "rlevel_" + response.TreeBranch.Level }
                                                                });
    } 
```

# android - 使用 HttpClient 的 HTTP 请求太慢？

> ID：12451687
> 
> 赞同：4
> 
> 时间：2012-09-16T23:50:52.543
> 
> 标签：android, eclipse, httpclient, keep-alive, asynchttpclient

我正在尝试编写一个 android 应用程序，该应用程序将一些帖子值发送到托管在专用服务器上的 php 文件并存储数组结果

代码是这样的

```
 HttpPost httppost;
    DefaultHttpClient httpclient;

    httppost = new HttpPost("http://IP/script.php"); 
    HttpParams param = new BasicHttpParams(); 
    param.setParameter(CoreProtocolPNames.PROTOCOL_VERSION, HttpVersion.HTTP_1_1);

  //  httppost.getParams().setBooleanParameter(CoreProtocolPNames.USE_EXPECT_CONTINUE, false);

    HttpProtocolParams.setContentCharset(param, "UTF-8");

    httpclient = new DefaultHttpClient(param);

    ResponseHandler <String> res=new BasicResponseHandler(); 
    List<NameValuePair> nameValuePairs;

    nameValuePairs = new ArrayList<NameValuePair>(); 
    nameValuePairs.add(new BasicNameValuePair("id","1"));
    nameValuePairs.add(new BasicNameValuePair("api", "1"));

    httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs)); 
Log.v("1",System.currentTimeMillis()+"");// Log to know the time diff
    String result= httpclient.execute(httppost, res);
Log.v("2",System.currentTimeMillis()+""); //  Log to know the time diff 
```

这段代码浪费了大约 2.5 秒（在 3G 或 WiFi 上）来发送帖子并从服务器获取“ok”字符串，即使这次有良好的 wifi 也只有 2.2 / 2.0 秒

我在通过同一部手机和 3G 连接到互联网的计算机上运行了一个简单的 Ajax sendpost 脚本，做同样的事情需要大约 0.300 毫秒，所以 ¿ 相同的连接，相同的动作，2 秒的差异？

/// *****更新**

我在计算机上再次尝试了我的 jquery 脚本（使用移动 3G+/HDSPA 连接）

平均时间响应约为250**毫秒**，但第**一个请求总是最多 1.7 秒**，我尝试以 30 秒的间隔发送帖子，平均时间为 1.5 秒，然后我尝试以 2 秒的间隔发送帖子，第一个是 1.41 秒，接下来是 252 毫秒

在这里你们可以查看图表：http: [//i46.tinypic.com/27zjl8n.jpg](http://i46.tinypic.com/27zjl8n.jpg)

无论如何，使用电缆连接（标准家庭 DSL）进行的相同测试始终提供**约 170 毫秒**间隔的固定时间响应（这里不是可靠的论点，但恕我直言，第一次尝试可能略高一些）

所以在第一次尝试中出现了严重影响移动连接的问题（或错误），有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T09:27:11.793

尝试使用此配置

```
HttpClient httpclient = new DefaultHttpClient();
HttpParams httpParameters = httpclient.getParams();
HttpConnectionParams.setConnectionTimeout(httpParameters, CONNECTION_TIMEOUT);
HttpConnectionParams.setSoTimeout(httpParameters, WAIT_RESPONSE_TIMEOUT);
HttpConnectionParams.setTcpNoDelay(httpParameters, true); 
```

这是关于*setTcpNoDelay*的javadoc ：

`public static void setTcpNoDelay (HttpParams params, boolean value)`

> ***自：API 级别 1***
> 
> 确定是否使用 Nagle 算法。Nagle 算法试图通过最小化发送的段数来节省带宽。当应用程序希望减少网络延迟并提高性能时，它们可以禁用 Nagle 算法（即启用 TCP_NODELAY）。数据将更早发送，但会增加带宽消耗。
> 
> ***参数***
> 
> 如果不使用 Nagle 的算法（即启用 TCP_NODELAY），则值为 true，否则为 false。

# jquery - 使用 jquery 和modernizr 改变平板电脑方向

> ID：12451701
> 
> 赞同：4
> 
> 时间：2012-09-16T23:54:18.583
> 
> 标签：jquery, media-queries, modernizr

所以我有一个导航菜单，可以在纵向或横向查看平板电脑时改变样式。它将最后几个菜单项折叠到另一个下拉菜单中。然而，菜单不会在方向改变时更新，只有在刷新后才会更新。

Jquery Modernizr 代码：

```
if(Modernizr.mq('(max-device-width: 800px) and (orientation: portrait)')){
    // portrait stuff
        // unhides last few menu items
        $('#menu-primary-items > li:nth-last-child(-n+3)').css('display', 'block');

        // remove hide and first child class originally assigned to it from it's ul parent
        // then add the more list item to the end of the nav menu
        $('.moreItem').removeClass('hide first-child').appendTo('#menu-primary-items');

        // grab the last two items of the nav menu and insert into the more list item menu
        $('.topNavigation .toplevel').slice(-2).appendTo('.moreMenu');
    } 
```

有什么建议么？？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T03:17:31.190

因此，将函数包装在调整大小侦听器中似乎可以使其工作！当有一个 else 语句时，似乎也能更好地工作。只需要在其他设备上做进一步的测试。

更新代码：

```
$(window).bind('resize', function(){

    if(Modernizr.mq('(max-device-width: 800px) and (orientation: portrait)')){
    // portrait stuff
        // unhides last few menu items
        $('#menu-primary-items > li:nth-last-child(-n+3)').css('display', 'block');

        // remove hide and first child class originally assigned to it from it's ul parent
        // then add the more list item to the end of the nav menu
        $('.moreItem').removeClass('hide first-child').appendTo('#menu-primary-items');

        // grab the last two items of the nav menu and insert into the more list item menu
        $('.topNavigation .toplevel').slice(-2).appendTo('.moreMenu');
    } else if(Modernizr.mq('(max-device-width: 1280px) and (max-device-height: 800px) and (orientation: landscape)') || Modernizr.mq('(max-device-width: 1024px) and (orientation: landscape)')){

        $('.moreMenu').children().appendTo('#menu-primary-items');

        $('.moreItem').addClass('hide first-child').appendTo('.moreItemHolder');

        $('#menu-primary-items > li:nth-last-child(-n+3)').css('display', 'block');

    }
}); 
```

# scala - 方差注释，由 Scala 编译器跟踪“正”和“负”位置

> ID：12451702
> 
> 赞同：9
> 
> 时间：2012-09-16T23:54:29.833
> 
> 标签：scala, compiler-construction, type-systems, variance

在*Programming in Scala*第 436 页中，作者给出了一个编译器检查每个类型参数是否仅用于适当分类的位置的示例。

```
abstract class Cat[-T, +U] {
  def meow[W^-](volume: T^-, listener: Cat[U^+, T^-]^-) : Cat[Cat[U^+, T^-]^-, U^+]^+
} 
```

这个例子是如何工作的？为什么 W 和第一个 T 得到一个负号？该算法实际上是如何工作的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T02:30:53.777

[http://www.artima.com/pins1ed/type-parameterization.html](http://www.artima.com/pins1ed/type-parameterization.html)

19.4 在第一版。

“方法值参数位置相对于方法外的位置分类为翻转分类。”

“除了方法值参数的位置，当前的分类也是在方法的类型参数上翻转的。”

在这种情况下，翻转意味着“从正面翻转”，因此是负面的。

对于奖励积分，生成一个 LOLcats 来说明此模型的物理解释。

附加问答：

```
Okay let's look at the 3rd value parameter "listener".

It has a annotation of: Cat[U^+, T^-]^-.

Why does U have +? Why does T have -? Why does the whole thing have a -? 
```

方法参数是一个逆变位置，因此是最外面（最右边）的减号。

Cat 的类型参数是 [-T, +U]，所以在这个翻转位置，[+, -]。（实际应用的参数 [U, T] 不相关。）它检查是因为实际参数分别是协变和反变的。

更多问题：

```
Could you kindly describe on SO why the return value type has the following annotation
for the sake of completeness...

Also could you be so kind as to give an example of the following rule?

A classification is sometimes flipped at the type argument position of a type... 
```

第二个附加问题与您之前的第一个附加问题相同。两个 Cat[+,-] 说明翻转，结果类型 Cat[-,+] 说明不翻转。

这个线程为参数（你传入的东西）和结果（你得到的东西）的变化提供了进一步的动力：

[https://groups.google.com/forum/#!topic/scala-user/ViwLKfvo3ec](https://groups.google.com/forum/#!topic/scala-user/ViwLKfvo3ec)

I found the Java discussion and examples (PECS or Naftalin and Wadler) useful background for what Scala provides.

# jquery - 从表中收集数据

> ID：12451703
> 
> 赞同：-1
> 
> 时间：2012-09-16T23:54:30.750
> 
> 标签：jquery, mysql, database

我创建了一个注册页面，用户可以在其中注册最多 20 个人。[这](http://jsfiddle.net/cRUsQ/2/)是该页面的外观。我正在使用验证插件来验证我的所有输入。

我遇到的问题是，如果用户在表中添加 20 个条目以注册那么多人，如何获取所有这些数据以及：

1.  像我对普通文本框一样验证它？
2.  获取所有数据并将其发布，以便我可以将其插入 mysql 数据库？

 `* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T00:00:51.237

您可以对输入名称使用数组语法，如下所示`name="fname_new[]"`：这将生成一个以键 0 开头的数组，直到你有多少。对于验证，给你的函数一些名字，使用 jQuery 选择器来选择与验证函数匹配的类型的所有输入，并在你想要验证的每个输入上调用它。至于发布值，只需发布​​表单（首先消除所有无效行）。`

# java - 使用 Eclipse 和 GWT 在 Java 中进行多页面开发

> ID：12451713
> 
> 赞同：1
> 
> 时间：2012-09-16T23:56:29.647
> 
> 标签：java, gwt, rpc

我一直在为我正在设计的应用程序编写一些基本代码。**我已经学习了基础知识并获得了一些使用RPC**调用等的简单数据库连接。我现在需要做的事情完全迷失了（因为我传统上是一个使用 windows 窗体的**c#开发人员）。**

在**c#**中，如果我想要一个新表单，我会创建它，然后调用该`show`方法。

如何在**GWT**中创建多个页面，并在它们之间切换？

在此先感谢，克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T14:04:55.350

最简单的方法是

1.  创建一个新的 java 类（GwtHome.java、GwtHelp.java 等）
2.  使用 Composite 类扩展这些类
3.  制作母版页的等效项，并将其作为具有适当页眉、菜单、页脚和内容占位符的类添加到 rootPanel（可以是 GWT 框架提供的任何 AbsolutePanel、VerticalPanel、Horizo​​ntalPanel 对象）
4.  通过单击菜单清除占位符并添加适当的 GwtHome、GwtHelp 等对象。

在熟悉了上述过程之后，您可能希望使用 Andrei 建议的设计模式将代码分解为多个文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T00:02:41.033

只需清除根面板 ( `RootPanel.get().clear()`) 并为您的新“页面”添加小部件，就像添加第一个小部件一样。

如果您使用的是 LayoutPanel，请`RootLayoutPanel.get().clear()`改用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T00:40:23.460

查看活动和地点设计模式：[https ://developers.google.com/web-toolkit/doc/latest/DevGuideMvpActivitiesAndPlaces](https://developers.google.com/web-toolkit/doc/latest/DevGuideMvpActivitiesAndPlaces)

我强烈推荐它用于多页 GWT 应用程序。它很好地解释了您如何创建不同的“视图”，这些“视图”由它们的“活动”驱动，并与用户可以导航的特定“位置”（页面）相关联。

通常，您使用 LayoutPanel 作为占据整个可用浏览器窗口的“页面”容器。您将此 LayoutPanel 拆分为 2-3 层（区域），如顶部菜单、侧边菜单、主区域。每个区域包含一个小部件，通常是 ScrollPanel、FlowPanel 或 HtmlPanel。然后，您在每个小部件中使用不同的小部件或 HTML 来显示您需要的任何内容。您还可以创建自己的复合小部件，您可以在不同的页面中重复使用这些小部件。

# r - 将数据框中的列重新对齐为多列

> ID：12451715
> 
> 赞同：1
> 
> 时间：2012-09-16T23:56:47.350
> 
> 标签：r

我正在尝试更改具有`var3`另一个变量的因子水平的多个值的数据框列（在下面的示例中`names`，在下面的示例中）。我想`var3`分成单独的列，每个值一个，这样因子水平`names`就不会重复。我的其他变量 ( `var1`, `var2`) 在必要时重复，以便为`var3`.

这是我拥有的数据类型：

```
df1 <- structure(list(name = structure(c(2L, 4L, 4L, 4L, 3L, 5L, 5L, 
1L), .Label = c("fifth", "first", "fourth", "second", "third"
), class = "factor"), var1 = c(90L, 84L, 84L, 84L, 18L, 22L, 
22L, 36L), var2 = c(301L, 336L, 336L, 336L, 412L, 296L, 296L, 
357L), var3 = c(-0.582075925, -1.108889624, -1.014962009, -0.162309524, 
-0.282309524, 0.563055819, -0.232075925, -0.773353424)), .Names = c("name", 
"var1", "var2", "var3"), class = "data.frame", row.names = c(NA, -8L)) 
```

这就是我想要的：

```
df2 <- structure(list(name = structure(c(2L, 4L, 3L, 5L, 1L), .Label = c("fifth", 
"first", "fourth", "second", "third"), class = "factor"), var1 = c(90L, 
84L, 18L, 22L, 36L), var2 = c(301L, 336L, 412L, 296L, 357L), 
var3 = c(-0.582075925, -1.108889624, -0.282309524, 0.563055819, 
-0.773353424), var3.2 = c(NA, -1.014962009, NA, -0.232075925, 
NA), var3.3 = c(NA, -0.162309524, NA, NA, NA)), .Names = c("name", "var1", 
"var2", "var3", "var3.2", "var3.3"), class = "data.frame", row.names = c(NA, -5L)) 
```

我看过`reshape`and `ddply`，但无法让他们给我这个输出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T00:19:12.987

```
ddply(df1, .(name), function(x) {
    var3 <- data.frame(rbind(unique(x$var3)))
    names(var3) <- paste0("var3.", 1:length(var3))
    return(data.frame(name = unique(x$name), var1 = unique(x$var1), 
    var2 = unique(x$var2), var3))
    })

 name var1 var2     var3.1     var3.2     var3.3
1  fifth   36  357 -0.7733534         NA         NA
2  first   90  301 -0.5820759         NA         NA
3 fourth   18  412 -0.2823095         NA         NA
4 second   84  336 -1.1088896 -1.0149620 -0.1623095
5  third   22  296  0.5630558 -0.2320759         NA 
```

`var1`如果您期望并且`var2`还包含多个值，则可以修改该函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T00:29:07.440

这是一个基本解决方案：

```
> df1$seqnam <- ave(as.character(df1$name), df1$name, FUN=seq)  # creates a "time" index 
> reshape(df1, direction="wide", timevar="seqnam",  idvar=c("name", "var1", "var2") )
    name var1 var2     var3.1     var3.2     var3.3
1  first   90  301 -0.5820759         NA         NA
2 second   84  336 -1.1088896 -1.0149620 -0.1623095
5 fourth   18  412 -0.2823095         NA         NA
6  third   22  296  0.5630558 -0.2320759         NA
8  fifth   36  357 -0.7733534         NA         NA 
```

# flash - actionscript3 tls socket 和 flash 策略文件：在 tlssocket 的资源请求被拒绝

> ID：12451719
> 
> 赞同：1
> 
> 时间：2012-09-16T23:57:50.937
> 
> 标签：flash, actionscript, policy

以下是让我感到困惑的要点：

*   我正在尝试使用 AS3 的 SecureSocket 类在我们的后端的端口 443 上建立一个 TLS 套接字。
*   后端有一个运行在端口 843 上侦听策略文件请求的服务。（如果您熟悉节点，这是为策略文件提供服务的服务器[https://github.com/3rd-Eden/FlashPolicyFileServer](https://github.com/3rd-Eden/FlashPolicyFileServer)）
*   提供的策略文件是
    `<?xml version="1.0"?><!DOCTYPE cross-domain-policy SYSTEM "http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd"><cross-domain-policy><allow-access-from domain="*" to-ports="*"/></cross-domain-policy>`

*   我写了一个小测试 Flash 片段（Test.swf），它试图建立所说的 TLS 套接字（在端口 443 上）。

*   通过 Vizzy Flash Tracer（在 Mac 上）启用和完成日志记录
*   Vizzy 跟踪内联跟踪和闪存策略相关消息。

**结果**

## **运行 1**

此运行仅通过内置策略文件请求端口 843 对策略文件进行 Flash 请求。以下是 Test.swf 运行的跟踪：

闪存日志：

> *** 违反安全沙箱 ***
> 与 mic.test.com:443 的连接已停止 - 不允许出现错误：由于缺少策略文件权限`http://localhost/~mic/flash/Test.swf`
> ，请求者在 tlssocket://mic.test.com:443 处的资源请求被拒绝。`http://localhost/~mic/flash/Test.swf`

政策日志：

> 确定：已加载根级 SWF：`http://localhost/~mic/flash/Test.swf`
> 确定：在策略文件中搜索以授权请求者从 tlssocket://mic.test.com:443 的资源加载数据，`http://localhost/~mic/flash/Test.swf`
> 错误：请求 tlssocket://mic.test 的资源。`http://localhost/~mic/flash/Test.swf`由于缺少策略文件权限，请求者的 com:443被拒绝。

## 运行 2

对于此运行，除了提供上述文件之外，策略文件服务器已被修改以进行另一次迭代，以将以下 xml 节点添加到响应中：（根据 adobe 文档）
此运行通过它构建了 flash 请求主策略文件在策略文件请求端口 843 中，然后在不同的端口上加载 crossdomain.xml 策略文件（准确地说是从网络服务器）
crossdomain.xml 文件如下所示：

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM "/xml/dtds/cross-domain-policy.dtd">
<!-- Policy file for xmlsocket://socks.example.com -->
<cross-domain-policy>
   <allow-access-from domain="*" to-ports="*" />
</cross-domain-policy> 
```

以下是 Test.swf 运行的跟踪：

闪存日志：

> *** 违反安全沙箱 ***
> 与 mic.test.com:443 的连接已停止 - 不允许出现错误：由于缺少策略文件权限 `http://localhost/~mic/flash/Test.swf`
> ，请求者在 tlssocket://mic.test.com:443 处的资源请求被拒绝。`http://localhost/~mic/flash/Test.swf`

政策日志：

> 确定：已加载根级 SWF：`http://localhost/~mic/flash/Test.swf`
> 确定：在策略文件中搜索以授权请求者从 tlssocket://mic.test.com:443 的资源加载数据：`http://localhost/~mic/flash/Test.swf` 确定：已接受策略文件：[https://mic.test。 com:10443/crossdomain.xml](https://mic.test.com:10443/crossdomain.xml)错误：由于缺少策略文件权限
> ，请求者在 tlssocket://mic.test.com:443 处的资源请求被拒绝。`http://localhost/~mic/flash/Test.swf`

唯一不同的是，flash 声称接受策略文件，但仍然拒绝播放。

你对我的想法哪里错了有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-02T07:34:22.323

正如@wvxvw 所建议的那样，答案原来是策略文件服务器需要能够通过 TLS 连接来回答请求。

# java - 位置每 35 秒更新一次，并在当前位置上画一个圆圈

> ID：12451722
> 
> 赞同：2
> 
> 时间：2012-09-16T23:58:48.913
> 
> 标签：java, android, location

`Circle`目前，我`Current Location`在每 35 秒更改一次位置并移动 10 米距离后绘制一个。

`LocationChanged`因此，一旦位置发生变化（35 秒和 10 米移动），我就实现了此功能，我正在绘制一个`Circle on the Google Maps on the Current Location`.

**问题陈述：-**

`My App is running very slow`. 有时我的应用程序被挂起？可能是因为我的代码按照我在下面写的方式效率不高？

基本上，我只需要在每 35 秒和 10 米的距离移动后在当前位置画一个圆圈。

我的代码有问题吗？任何想法，例如我应该如何进一步改进它，以使其顺利运行。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);    

    locationListener = new GPSLocationListener();

    locationManager.requestLocationUpdates(
            LocationManager.GPS_PROVIDER, 
            35000, 
            10, 
            locationListener);

    mapView = (MapView) findViewById(R.id.mapView);
    listView = (ListView) findViewById(R.id.mylist);
    mapView.setStreetView(true);
    mapView.setBuiltInZoomControls(true);
    mapController = mapView.getController();
    mapController.setZoom(15);
}

private class GPSLocationListener implements LocationListener {
    @Override
    public void onLocationChanged(Location location) {
        if (location != null) {
            GeoPoint point = new GeoPoint(
                    (int) (location.getLatitude() * 1E6), 
                    (int) (location.getLongitude() * 1E6));

            findUsersInCurrentRadius(4,location.getLatitude(),location.getLongitude());

            mapController.animateTo(point);
            mapController.setZoom(15);

            // add marker
            MapOverlay mapOverlay = new MapOverlay(this,android.R.drawable.star_on);
            mapOverlay.setPointToDraw(point);
            List<Overlay> listOfOverlays = mapView.getOverlays();
            listOfOverlays.clear();
            listOfOverlays.add(mapOverlay);

            String address = ConvertPointToLocation(point);
            Toast.makeText(getBaseContext(), address, Toast.LENGTH_SHORT).show();

            mapView.invalidate();
        }
    }

    @Override
    public void onProviderDisabled(String provider) {
    }

    @Override
    public void onProviderEnabled(String provider) {
    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
    }
} 
```

这是我在其中绘制圆圈的 MapOverlay 类。

```
class MapOverlay extends Overlay {
    private GeoPoint pointToDraw;
    int[] imageNames=new int[6];

    public MapOverlay(GPSLocationListener gpsLocationListener, int currentUser) {
        imageNames[0]=currentUser;
    }

    public void setPointToDraw(GeoPoint point) {
        pointToDraw = point;
    }

    public GeoPoint getPointToDraw() {
        return pointToDraw;
    }

    @Override
    public boolean draw(Canvas canvas, MapView mapView, boolean shadow, long when) {
        super.draw(canvas, mapView, shadow);
        //---translate the GeoPoint to screen pixels---
        Point screenPts = new Point();
        mapView.getProjection().toPixels(pointToDraw, screenPts);
        //--------------draw circle----------------------
        Point pt = mapView.getProjection().toPixels(pointToDraw,screenPts);
        Paint circlePaint = new Paint(Paint.ANTI_ALIAS_FLAG);
        circlePaint.setColor(0x30000000);
        circlePaint.setStyle(Style.FILL_AND_STROKE);

        int totalCircle=4;
        int radius=40;
        int centerimagesize=35;

        for (int i = 1; i <= totalCircle; i ++) { 
            canvas.drawCircle(screenPts.x,screenPts.y, i*radius, circlePaint); 
        } 

        canvas.drawBitmap(BitmapFactory.decodeResource(getResources(),imageNames[0]), (screenPts.x-(centerimagesize/2)),(screenPts.y-(centerimagesize/2)), null);

        super.draw(canvas,mapView,shadow);

        return true;
    }

} 
```

**更新代码：-**

```
private MapView mapView;
private ListView listView;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    mapView = (MapView) findViewById(R.id.mapView);
    listView = (ListView) findViewById(R.id.mylist);

    locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);    

    locationListener = new GPSLocationListener(mapView);

    locationManager.requestLocationUpdates(
            LocationManager.GPS_PROVIDER, 
            35000, 
            0, 
            locationListener);

    mapView.setStreetView(true);
    mapView.setBuiltInZoomControls(true);
    mapController = mapView.getController();
    mapController.setZoom(15);
}

    private class GPSLocationListener implements LocationListener {

    MapOverlay mapOverlay;

    public GPSLocationListener(MapView mapView) {
        mapOverlay = new MapOverlay(this,android.R.drawable.star_on);
        List<Overlay> listOfOverlays = mapView.getOverlays();
        listOfOverlays.add(mapOverlay);
    }

    @Override
    public void onLocationChanged(Location location) {
        if (location != null) {
            GeoPoint point = new GeoPoint(
                    (int) (location.getLatitude() * 1E6), 
                    (int) (location.getLongitude() * 1E6));

            mapController.animateTo(point);
            mapController.setZoom(15);

            // **See no need to make a new Object here**
            mapOverlay.setPointToDraw(point);
            mapView.invalidate();
        }
    }

    @Override
    public void onProviderDisabled(String provider) {
    }

    @Override
    public void onProviderEnabled(String provider) {
    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
    }
}

    class MapOverlay extends Overlay {
    private GeoPoint pointToDraw;
    int[] imageNames=new int[6];
    private Point mScreenPoints;
    private Bitmap mBitmap;
    private Paint mCirclePaint;

    public MapOverlay(GPSLocationListener gpsLocationListener, int currentUser) {
        imageNames[0]=currentUser;
        mCirclePaint = new Paint(Paint.ANTI_ALIAS_FLAG);
        mCirclePaint.setColor(0x30000000);
        mCirclePaint.setStyle(Style.FILL_AND_STROKE);
        mBitmap = BitmapFactory.decodeResource(getResources(),imageNames[0]);
        mScreenPoints = new Point();
    }

    public void setPointToDraw(GeoPoint point) {
        pointToDraw = point;
    }

    public GeoPoint getPointToDraw() {
        return pointToDraw;
    }

    public boolean draw(Canvas canvas, MapView mapView, boolean shadow, long when) {
        super.draw(canvas, mapView, shadow);
        mScreenPoints = mapView.getProjection().toPixels(pointToDraw, mScreenPoints);

        int totalCircle=4;
        int radius=40;
        int centerimagesize=35;

        for (int i = 1; i <= totalCircle; i ++) { 
            canvas.drawCircle(mScreenPoints.x,mScreenPoints.y, i*radius, mCirclePaint); 
        } 

        canvas.drawBitmap(mBitmap, (mScreenPoints.x-(centerimagesize/2)),(mScreenPoints.y-(centerimagesize/2)), null);
        super.draw(canvas,mapView,shadow);

        return true;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T00:41:43.133

绘画时要记住以下几点：

1.  不要阻塞主 UI 线程
2.  记住回收对象。
3.  记住回收对象。
4.  并且永远记得回收对象。

**可能的 UI 线程阻塞**

这段代码看起来像是在调用一个可能代价高昂的回调操作，`onLocationChanged()`这样做真的很危险，因为您最终可能会陷入 ANR。这可能应该在后台 AsyncTask 上完成，然后在它的结果上显示 toast。

```
String address = ConvertPointToLocation(point);
Toast.makeText(getBaseContext(), address, Toast.LENGTH_SHORT).show(); 
```

**更好地管理地图上的资源**

不要每次都添加新的叠加层，而是确保回收实例并重置它的位置。

```
private class GPSLocationListener implements LocationListener {
    MapOverlay mOverlay;

    public GPSLocationListener() {

    }

   @Override
   public void onLocationChanged(Location location) {
    if (location != null) {
        GeoPoint point = new GeoPoint(
                (int) (location.getLatitude() * 1E6), 
                (int) (location.getLongitude() * 1E6));

        findUsersInCurrentRadius(4,location.getLatitude(),location.getLongitude());

        mapController.animateTo(point);
        mapController.setZoom(15);

        if (mOverlay == null) {
            // Add this marker to the list of overlays always.
            // This stuff never changes so there is no need to do this logic
            // Every 30 secs. Loading images is **Expensive**
            mOverlay = mMapOverlay = new MapOverlay(this,android.R.drawable.star_on);
            List<Overlay> listOfOverlays = mapView.getOverlays();
            listOfOverlays.add(mMapOverlay);
        }
        // **See, no need to make a new Object here**
        mOverlay.setPointToDraw(point);

        // This can probably be done at another time.
        // String address = ConvertPointToLocation(point);
        // Toast.makeText(getBaseContext(), address, Toast.LENGTH_SHORT).show();

        mapView.invalidate();
    } 
```

此代码可以重用此标记并仅更新其位置。如果它不在列表中，您应该只创建一个。

**更好的绘图**

好的，接下来记住不要在 onDraw() 方法中创建对象，如果你不需要的话。一旦标记知道要绘制到哪里，您应该缓存所有内容，以便您可以专注于绘图。例如：

```
public class MapOverlay {

    private GeoPoint pointToDraw;
    int[] imageNames=new int[6];
    // This is the cached Point on the screen that will get refilled on every draw
    private Point mScreenPoints;
    // This is the cached decoded bitmap that will be drawn each time
    private Bitmap mBitmap;
    // Cached Paint
    private Paint mCirclePaint;

    public MapOverlay(GPSLocationListener gpsLocationListener, int currentUser) {
      imageNames[0]=currentUser;
      // This only needs to be made here, once. It never needs to change.
      mCirclePaint = new Paint(Paint.ANTI_ALIAS_FLAG);
      mCirclePaint.setColor(0x30000000);
      mCirclePaint.setStyle(Style.FILL_AND_STROKE);
      // We only need to load this image once and then just keep drawing it when dirtyed.
      mBitmap = BitmapFactory.decodeResource(context.getResources(),imageNames[0]);
      // This Point object will be changed every call to toPixels(), but the instance can be recycled
      mScreenPoints = new Point();
    }

    public void setPointToDraw(GeoPoint point) {
      pointToDraw = point;
    }

    public GeoPoint getPointToDraw() {
      return pointToDraw;
    }

    public boolean draw(Canvas canvas, MapView mapView, boolean shadow, long when) {
      super.draw(canvas, mapView, shadow);
      // In the case where nothing has been set yet, don't do any drawing
      if (pointToDraw == null) {
         return true;
      }
      //--------------draw circle----------------------
      mScreenPoints = mapView.getProjection().toPixels(pointToDraw, mScreenPoints);

      int totalCircle=4;
      int radius=40;
      int centerimagesize=35;

      for (int i = 1; i <= totalCircle; i ++) { 
          canvas.drawCircle(screenPts.x,screenPts.y, i*radius, mCirclePaint); 
      } 

      canvas.drawBitmap(mBitmap, (screenPts.x-(centerimagesize/2)),(screenPts.y-(centerimagesize/2)), null);
      super.draw(canvas,mapView,shadow);

      return true;
    } 
```

# entity-framework - 是否有必要在 Entity Famework 5 中管理事务？（多个上下文）

> ID：12451723
> 
> 赞同：0
> 
> 时间：2012-09-16T23:59:17.073
> 
> 标签：entity-framework, transactions

在自定义工作单元中可能有多个 DbContext 的情况下，EF5 是否会管理**所有**事务要求，或者下面的代码是否仍然有效/需要？如果没有，代码可以减少多远并且仍然提供相同的功能？

```
public void SaveAllChanges()
{
    var transactions = new List<DbTransaction>();

    foreach (var context in this.contexts
        .Where(context => context != null)
        .Select(dbcontext => ((IObjectContextAdapter)dbcontext).ObjectContext))
    {
        context.Connection.Open();

        var databaseTransaction = context.Connection.BeginTransaction();

        transactions.Add(databaseTransaction);

        try
        {
            context.SaveChanges();
        }
        catch
        {
            foreach (var transaction in transactions)
            {
                try
                {
                    transaction.Rollback();
                }
                finally
                {
                    databaseTransaction.Dispose();
                }
            }

            transactions.Clear();

            throw;
        }
    }

    try
    {
        foreach (var transaction in transactions)
        {
            transaction.Commit();
        }
    }
    finally
    {
        foreach (var transaction in transactions)
        {
            transaction.Dispose();
        }

        transactions.Clear();

        foreach (var context in this.contexts
            .Select(dbcontext => ((IObjectContextAdapter)dbcontext).ObjectContext)
            .Where(context => context.Connection.State != ConnectionState.Closed))
        {
            context.Connection.Close();
        }
    }
} 
```

假设 SQL Server 2008 及更高版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T08:56:56.070

在使用多个上下文时，您必须自己处理事务，但您的代码是错误的。如果您的任何事务在提交期间失败，您可以提交部分事务并回滚部分事务。

唯一有效的方法是手动使用`TransactionScope`和[管理](http://blogs.msdn.com/b/diego/archive/2012/01/26/exception-from-dbcontext-api-entityconnection-can-only-be-constructed-with-a-closed-dbconnection.aspx)EF 的连接或使用分布式事务：

```
var objectContexts = this.contexts
                         .Where(context => context != null)
                         .Select(dbcontext => ((IObjectContextAdapter)dbcontext).ObjectContext))
                         .ToArray();

var transactionOptions = new TransactionOptions { 
    IsolationLevel = IsolationLevel.ReadCommitted 
};
using (var scope = new TransactionScope(TransactionScopeOption.Required,
                                        transactionOptions)) {
   Array.ForEach(objectContext, 
                 o => o.SaveChanges(SaveOptions.DetectChangesBeforeSave));
   scope.Complete();
}

Array.ForEach(objectContext, o => o.AcceptAllChanges()); 
```

[这里](http://blogs.msdn.com/b/alexj/archive/2009/01/11/savechanges-false.aspx)描述了为什么 AcceptAllChanges 很重要。

# c# - 如何在 C# 中将字段命名添加到 KeyValuePair

> ID：12451725
> 
> 赞同：0
> 
> 时间：2012-09-17T00:00:18.010
> 
> 标签：c#

我有以下代码：

```
 var values1 = (EReferenceKey[])Enum.GetValues(typeof(EReferenceKey)); 
        var valuesWithNames = values1.Select(
            value => new {
                Value = ((int)value).ToString("00"),
                Text = Regex.Replace(value.ToString(), "([A-Z])", " $1").Trim() 
            }); 
```

这是stackoverflow上建议的一些代码，可以使此方法通用：

```
 public static IEnumerable<KeyValuePair<string, string>> GetValues2<T>() where T : struct {
        var t = typeof(T);
        if (!t.IsEnum)
            throw new ArgumentException("Not an enum type");
        return Enum.GetValues(t)
            .Cast<T>()
            .Select(x => new KeyValuePair<string, string>(
                ((int)Enum.ToObject(t, x)).ToString("00"), 
                Regex.Replace(x.ToString(), "([A-Z])", " $1").Trim()
                ));
    } 
```

它给了我几乎相同的结果，但它缺少命名“值”和“文本”。有人可以向我建议如何修改后面的代码以添加这些代码并且仍然可以按顺序返回结果吗？

我确实尝试过自己做，但是当我尝试将“Value =”和“Text =”添加到泛型的选择中时，它给了我错误：

错误 6 当前上下文中不存在名称“值”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T00:16:00.503

您需要定义一个类，将返回其值：

```
public class YourValues
{
    public string Value {get; set;}
    public string Text {get; set;}
} 
```

并像这样修改：

```
public static IEnumerable<YourValues> GetValues2<T>() where T : struct 
{
    var t = typeof(T);
    if (!t.IsEnum)
        throw new ArgumentException("Not an enum type");
    return Enum.GetValues(t)
        .Cast<T>()
        .Select(x => new YourValues{
            Value = ((int)Enum.ToObject(t, x)).ToString("00"), 
            Text = Regex.Replace(x.ToString(), "([A-Z])", " $1").Trim()
            });
} 
```

# gradle - gradle 1.2中的自定义scala测试路径

> ID：12451726
> 
> 赞同：0
> 
> 时间：2012-09-17T00:00:24.453
> 
> 标签：gradle

我是 Gradle 的新手，它对我来说仍然有点神奇。

在我的项目中，我们不使用默认的 sourceDirs，因为我们将不同类型的测试分开：

```
configure(subprojects) {
    sourceSets {
        test {
            java.srcDir('src/test/unit/java') 
            resources.srcDir('src/test/unit/resources')
        }
        integrationTest {
            java.srcDir('src/test/integration/java') 
            resources.srcDir('src/test/integration/resources')
        }
        concurrencyTest {
            java.srcDir('src/test/concurrency/java') 
            resources.srcDir('src/test/concurrency/resources')
        }
        componentTest {
            java.srcDir('src/test/component/java') 
            resources.srcDir('src/test/component/resources')
        }
    }
} 
```

我正在尝试配置一个 scala 测试源目录。我的尝试：

```
apply plugin: 'scala'

configure(subprojects) {
    sourceSets {
        test {
            java.srcDir('src/test/unit/java') 
            scala.srcDir('src/test/unit/scala')
            resources.srcDir('src/test/unit/resources')
        }
 ... 
```

结果：

```
FAILURE: Build failed with an exception.

* Where:
Build file 'C:\projects\...\build.gradle' line: 109
# note, this is the line "sourceSets {"

* What went wrong:
A problem occurred evaluating root project 'X'.
> Could not find method sourceSets() for arguments [build_5ft63n6d7svimaibmkfq56rbrk$_run_closure4_closure18@573ed6c3] on root project 'X'. 
```

我尝试了其他一些变体，但无法使其正常工作。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T06:54:49.363

`sourceSets`扩展是由语言插件添加的，`scala`但您没有将`scala`插件应用于子项目。因此错误。

PS：代替`configure(subprojects) { ... }`，您可以使用`subprojects { ... }`.

# c# - 从 Properties.Settings.Default 加载 NumericUpDown 值？

> ID：12451727
> 
> 赞同：0
> 
> 时间：2012-09-17T00:00:27.583
> 
> 标签：c#, winforms

我的程序`TextBoxes`通过[Properties.Settings](http://msdn.microsoft.com/en-us/library/aa730869%28v=VS.80%29.aspx)保存，以便我可以关闭和打开程序，它会记住其中的内容。那部分有效。但是，该程序也有一些`NumericUpDown`我希望保存值的框，但问题是我似乎无法加载它。这是我的代码：

加载：

```
private void Form1_Load(object sender, EventArgs e)
{
   numericUpDown1.Value = Settings.Default["H1"].ToString();
} 
```

保存：

```
private void button4_Click(object sender, EventArgs e)
{
    Settings.Default["H1"] = numericUpDown1.Value;
    Settings.Default.Save();
} 
```

错误在

```
Settings.Default["H1"].ToString(); 
```

消息是

> 错误 1：无法将类型“字符串”隐式转换为“十进制”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T00:27:28.223

该`Value`属性期望为其分配一个`Decimal`值，但您试图分配`string`。它应该是

```
numericUpDown1.Value = Convert.ToDecimal(Settings.Default["H1"].ToString()); 
```

# regex - 如何使正则表达式匹配的一部分成为可选的？

> ID：12451731
> 
> 赞同：32
> 
> 时间：2012-09-17T00:01:41.683
> 
> 标签：regex

这是一个示例字符串：

```
123456#p654321 
```

目前，我正在使用此匹配来捕获`123456`并`654321`进入两个不同的组：

```
([0-9].*)#p([0-9].*) 
```

但有时，`#p654321`字符串的一部分不存在，所以我只想捕获第一组。我试图通过附加到第二组来使第二组“可选” `?`，这有效，但前提是`#p`在剩余字符串的末尾有 a 。

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-09-17T00:05:05.303

您拥有`#p`捕获组的外部，这使其成为结果的必需部分。您还`.`错误地使用了点字符 ( )。点（在大多数 reg-ex 变体中）将匹配任何字符。将其更改为：

```
([0-9]*)(?:#p([0-9]*))? 
```

`(?:)`语法是如何获得非捕获组。然后，我们只捕获您感兴趣的数字。最后，我们使整个事情成为可选的。

此外，大多数 reg-ex 变体都有一个`\d`数字字符类。所以你可以进一步简化：

```
(\d*)(?:#p(\d*))? 
```

正如另一个人指出的那样，`*`操作员可能会匹配*零*位数字。为防止这种情况，请改用`+`运算符：

```
(\d+)(?:#p(\d+))? 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-17T00:17:54.503

您的正则表达式实际上不会匹配*任何*数字，因为您使用`*`的是`+`.
这就是（我认为）你想要的：

```
(\d+)(?:#p(\d+))? 
```

# javascript - 循环中两个不同变量的javascript addEventListener - >第一个监听器不起作用

> ID：12451732
> 
> 赞同：1
> 
> 时间：2012-09-17T00:01:43.500
> 
> 标签：javascript, dom-events, addeventlistener

只有 buttonEndNumber 事件监听器被正确触发。`buttonStartNumber`没有做任何事情。

```
function appendNumberButtons()
    {
        var xpathExpression = 'id("delform")/div/div/div/div/div/div'
        var xpathResult = document.evaluate(xpathExpression, document, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null)

        var buttonStartNumber
        var buttonEndNumber

        for ( var i=0 ; i < xpathResult.snapshotLength; i++ )
        {
            buttonStartNumber = document.createElement("input")
            buttonStartNumber.setAttribute('type', 'button')
            buttonStartNumber.setAttribute('value',"S"+i)
            //buttonStartNumber.addEventListener('click', function(i){ return function(I){alert(i)} }(i), false);
            listnerHelper(buttonStartNumber, i);

            buttonEndNumber = document.createElement("input")
            buttonEndNumber.setAttribute('type', 'button')
            buttonEndNumber.setAttribute('value',"E"+i)
            //buttonEndNumber.addEventListener('click', function(i){ return function(I){alert(i)} }(i), false);
            listnerHelper(buttonEndNumber, i);

            xpathResult.snapshotItem(i).innerHTML += " -> "
            xpathResult.snapshotItem(i).appendChild(buttonStartNumber)
            xpathResult.snapshotItem(i).innerHTML += " - "
            xpathResult.snapshotItem(i).appendChild(buttonEndNumber)
        }
    } 
```

我尝试过的事情：

一个额外的函数`listenerHelper(object, i) -> nop buttonStartNumber`，`buttonEndNumber`作为有和没有的数组`listenerHelper(object, i) -> nop`

我的错误在哪里？

# maven - 如何解析使用动态版本的依赖项的父 POM

> ID：12451737
> 
> 赞同：0
> 
> 时间：2012-09-17T00:02:33.807
> 
> 标签：maven

我正在构建一个多模块项目。项目结构如下：

```
 -Build
       -Local
         -POM.xml (Master)

-Main Project
   -Module A 

-Libs Project
   -Libs Project A 
```

Libs 项目 A 的 POM 具有来自其父 POM 的动态版本

```
 <parent>
    <groupId>com.myproject</groupId>
    <artifactId>libs</artifactId>
    <version>${release.version}</version>
   </parent>
    <!-- this POM -->
    <groupId>com.myproject.libs</groupId>
    <artifactId>http</artifactId>
    <packaging>bundle</packaging>
    <version>1.0.0</version> 
```

当我运行 maven build 并传递 version 参数来构建“模块 A”时，maven 找不到 libs 项目的 POM。

> 原因：找不到父项目：com.myproject:libs 项目：com.myproject.libs:http:bundle:1.0.0 项目 com.myproject.libs:http:bundle:1.0.0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:56:37.663

*立即停止*

POM 中有许多 XPath 位置，其中属性替换永远不会以任何可用的方式工作。

*   `/project/parent/groupId`
*   `/project/parent/artifactId`
*   `/project/parent/version`
*   `/project/groupId`
*   `/project/artifactId`
*   `/project/version`
*   `/project/packaging`

原因是反应堆构建必须是确定性的。

当您尝试在这些位置使用属性时，它*似乎可以工作*，换句话说，Maven 不会立即将您的脚踢掉....但是当您尝试在 Maven 上做任何进一步的事情时，它会友好地踢掉您的脚。

也许我们应该改变 Maven，让你一开始就大吃一惊……也许这会阻止人们认为在这些元素中添加属性扩展是受支持的。

# c# - 具有不可空值类型属性的对象的 LINQ DefaultIfEmpty 问题

> ID：12451741
> 
> 赞同：1
> 
> 时间：2012-09-17T00:03:17.817
> 
> 标签：c#, linq, defaultifempty

# 要求

1.  我需要加入 Table1 和 Table2
2.  两个表之间的键是 ID，它是 System.Guid 类型并且是不可空值类型
3.  如果 Table2.ID 为空，我需要从 Table1 中获取空记录。

## 我写的LINQ语法如下。

```
from records in DBContext.Table1
join history in DBContext.Table2 into recordhistory
from records in recordhistory.DefaultIfEmpty()
select (n => n); 
```

我得到的错误是“不能将空值分配给 System.Guid 类型的成员，这是一个不可为空的值类型。”

有人可以建议我吗？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T01:10:42.147

假设您有一个 ID 属性，以下应该作为内部联接：

```
var result = DBContext.Table1
              .Join(DBContext.Table2, t1 => t1.ID, t2 => t2.ID, (t1, t2) => t1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T02:52:24.510

我想，您提供的查询应该给出一个错误，说`on`应该指定该语句。所以，我想它应该看起来像这样：

```
from records in DBContext.Table1
join history in DBContext.Table2 on records.ID equals history.ID into temp
from recordhistory in temp.DefaultIfEmpty()
select new { Record = records, History = recordhistory }; 
```

# php - 如何在php的递归函数中使用数组

> ID：12451743
> 
> 赞同：0
> 
> 时间：2012-09-17T00:03:36.537
> 
> 标签：php, multidimensional-array

我试图在多维数组中找到类似的标题并打印这些标题。

### 数组转储：

```
Array ( [0] =>
 Array ( [test] => 1 [CdnEnabled] => true [Ver] => 4.1   [Size] => 646586847 [Title] => test1 [TitleId] => 0 [GroupId] => 12 )
 [1] => Array ( [test] => 1 [ed] => true  [Ver] => 4.1 [Size] => 637972836 [Title] => test1[TitleId] => 0 [GroupId] => 12 ) 
 [2] => Array ( [test] => 1[ed] => true [Ver] => 4.0.1  [Size] => 779055727 [Title] => test2[TitleId] => 0 [GroupId] => 12 ) 
 [3] => Array ( [test] => 1[ed] => true [Ver] => 4.0.1  [Size] => 779055727 [Title] => test2[TitleId] => 0 [GroupId] => 12 ) 
 [4] => Array ( [test] => 1[ed] => true [Ver] => 4.0.1  [Size] => 779055727 [Title] => test3[TitleId] => 0 [GroupId] => 12 ) 
 [5] => Array ( [test] => 1[ed] => true [Ver] => 4.0.1  [Size] => 779055727 [Title] => test3[TitleId] => 0 [GroupId] => 12 ) 
 [6] => Array ( [test] => 1[ed] => true [Ver] => 4.0.1  [Size] => 779055727 [Title] => test4[TitleId] => 0 [GroupId] => 12 ) 
 [7] => Array ( [test] => 1[ed] => true [Ver] => 4.0.1  [Size] => 779055727 [Title] => test4[TitleId] => 0 [GroupId] => 12 ) 
 ) 
```

### PHP代码：

```
function getrecursiveValues($start, $arrayValues, $totalCount, $previousTitle, $newtotalCount = 0)
{
  $currentTitle = $arrayValues[$i]['Title'];
  if ($currentTitle == "Panorama Base Images") {
    print_r($newAray);
  }

  for ($i = $start; $i < $newtotalCount; $i++) {
    echo "<h1> i is $i  new totalcount is $newtotalCount </h1>";
    if (($newtotalCount != 0) && ($i == ($newtotalCount - 1))) {
      echo "<br />in ifffffffffffffffffffffffffffff<br />";
      $currentTitle  = $arrayValues[$i]['Title'];
      $previousTitle = $arrayValues[$i - 1]['Title'];

      if ($previousTitle == $currentTitle) {
        echo "sameeeeee" . $currentTitle . "<br />";
        break 1;
      } else {
        break 1;
      }

    } else {
      echo "<br />in elseee<br />";
      $currentTitle = $arrayValues[$i]['Title'];
      if ($i == 0) {
        echo "<h1>  $currentTitle</h1>";
      }

      if ($i != $start)
        $previousTitle = $arrayValues[$i - 1]['Title'];
      echo "previous val is  -- $previousTitle";

      if ($previousTitle == $currentTitle) {
        echo "sameeeeee" . $currentTitle . "<br />";            
      } else {
        $nn = count($arrayValues);
        echo "<h2><br /> calling the recursivie from the function total isssssss $totalCount---- </h2> <br />";

        $newtotalCount = 0;
        $newAray       = array_slice($arrayValues, $i);
        $newtotalCount = count($newAray);

        $previousTitle = $newAray[0]['Title'];

        if ($totalCount >= $newtotalCount)
          getrecursiveValues(0, $newAray, $newtotalCount, $previousTitle, $newtotalCount);
        else
          return;

      }
    }

  }
  echo "<h1> Out of for</h1>";
  return "bye";
  exit;  
} 
```

我无法摆脱功能和功能，有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T00:15:27.897

如果我拼错了对不起，你试过用这样的东西吗？

```
function recursive($array) {
   foreach($arrays as $array) {
    if(is_array($array) == true) 
       $array = recursive($slimer aray);
     } else {
       //do what ever you gotta do
   }
  }
} 
```

# python - 如何遍历列表并根据python中前一个索引的值获取值？

> ID：12451745
> 
> 赞同：0
> 
> 时间：2012-09-17T00:03:52.743
> 
> 标签：python

> **可能重复：**
> [如何在 Python 中将列表拆分为大小均匀的块？](https://stackoverflow.com/questions/312443/how-do-you-split-a-list-into-evenly-sized-chunks-in-python)

基本上，我有一个列表，并且我正在遍历列表中的每个奇数索引。我想要做的是基于每个奇数索引的值，然后在所述奇数索引之后直接使用偶数索引中的值更新变量。

因此，如果`lst[1]`包含 value `p`，那么我希望 的值是`x`at 的值`lst[2]: x = lst[2]`。

如果`lst[3]`包含该值`m`，那么我希望 y 为`lst[4]: y = lst[4]`

列表的长度从来都不是一成不变的，因为它是从文件中获取的。

我目前正在使用以下代码遍历列表：

```
for item in lst:
    if lst[range(1, len(lst), 2] == "p"
        x = ?? 
```

编辑：我想更具体地说，我创建了一个类，现在正在创建一个函数，该函数将从文件中获取信息，并使用它来填充我的类中的方法。为此，我正在使用文件读取文件`readlines`，然后根据文件中的内容浏览由创建的列表`readlines`并更新我的类中的方法。文件中的每一个奇数行都指示我需要使用紧随其后的行更新哪种方法。

所以：

```
if lst[1] == "p":
   s.methodOne(lst[2])
if lst[1] == "m":
    s.methodTwo(lst[2]) 
```

我只是不确定如何在奇数索引之后获取偶数索引中的内容。

我的代码可能不是很整洁，但这是我目前所拥有的：

```
def processScores(fname):
    infile = open(fname, 'r')
    lineinfo = infile.readlines()
    infile.close()
    lstinfo = []
    for item in lineinfo:
        lst = item.split(",")
        s = Score()
        s.initialize(lst[0])
        if lst[range(1, len(lst -1), 2] == "o" or "O": 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T00:10:44.337

```
for idx in xrange(1, len(lst), 2):
    if lst[idx] == 'p':
        ...
    if lst[idx] == 'm':
        ... 
```

请注意`lst`is的第一个元素`lst[0]`，因此您在这里完全跳过它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T02:03:39.650

我喜欢迭代工具：

```
from itertools import izip

def grouper(n, iterable):
    args = [iter(iterable)] * n
    return izip(*args)

line = 'hello, my name is really not pete.'
#              ^^                    ^^

for a, b in grouper(2, line[1:]):
    if a == 'm':
        print b
    elif a == 'p':
        print b 
```

结果：

```
$ python oddeven.py
y
e 
```

# javascript - 具有不同大小内容的绝对中心 *above* div

> ID：12451746
> 
> 赞同：2
> 
> 时间：2012-09-17T00:04:35.497
> 
> 标签：javascript, jquery

我有这个脚本：http: [//jsfiddle.net/ZhXf5/3/](http://jsfiddle.net/ZhXf5/3/)

当您将鼠标悬停在其中一个框上时，“弹出”div 将位于具有不同大小图像的框上方。如何使这些不同大小的图像居中在 div 上方？

![在此处输入图像描述](../Images/4277d5a1a90b64393c7cad0096e00ce0.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T00:28:18.847

加载图像以正确放置缩略图后，您需要做更多的数学运算（[更新的 jsfiddle](http://jsfiddle.net/ZhXf5/9/)）：

```
$("document").ready(function () {

    $("div.box").hover(function() {

        var positionleft = $(this).position().left + $(this).outerWidth() / 2;
        var positiontop = $(this).position().top;

        var img = $("<img src='"+$(this).text()+"' />");
        $("div.popup div.image").html(img);

        img.load(function() {
            $("div.popup").css({
                display: 'block',
                left: positionleft - (img.outerWidth() / 2),
                top: positiontop - img.outerHeight() - 20,
            });   
        });
    });   

});​ 
```

# python - 在 python 2.6 中将单词定义为 2 个或更多字母

> ID：12451747
> 
> 赞同：0
> 
> 时间：2012-09-17T00:04:54.480
> 
> 标签：python, lambda, text-processing

我有一个我正在为课堂作业编写的 python 脚本，它计算文本文档中最常见的 10 个单词并显示这些单词及其频率。我能够让这部分脚本工作得很好，但是作业说一个单词被定义为**2 个字母或更多**。由于某种原因，我似乎无法将一个单词定义为 2 个或更多字母，当我运行脚本时，什么也没有发生。

```
# Most Frequent Words:
from string import punctuation
from collections import defaultdict

def sort_words(x, y):
    return cmp(x[1], y[1]) or cmp(y[0], x[0])

number = 10
words = {}

words_gen = (word.strip(punctuation).lower() for line in open("charactermask.txt")
                                             for word in line.split())
words = defaultdict(int)
for word in words_gen:
    words[word] +=1

letters = len(word)

while letters >= 2:
    top_words = sorted(words.iteritems(),
                        key=lambda(word, count): (-count, word))[:number] 

for word, frequency in top_words:
    print "%s: %d" % (word, frequency) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T00:14:29.650

您的脚本的一个问题是循环

```
while letters >= 2:
    top_words = sorted(words.iteritems(),
                        key=lambda(word, count): (-count, word))[:number] 
```

您不是在循环这里的单词；这个循环将永远循环。您需要更改脚本，以便脚本的这一部分实际上迭代所有单词。（此外，您可能需要更改`while`为，`if`因为您只需要每个单词执行一次该代码。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T00:26:42.187

我会重构你的代码~~并使用一个`collections.Counter`对象~~：

```
import collections
import string

with open("charactermask.txt") as f:
  words = [x.strip(string.punctuation).lower() for x in f.read().split()]

counter = collections.defaultdict(int):
for word in words:
  if len(word) >= 2:
    counter[word] += 1 
```

# c++ - Lambda 内循环

> ID：12451755
> 
> 赞同：7
> 
> 时间：2012-09-17T00:07:15.360
> 
> 标签：c++, lambda, c++11

我在 for 循环中有一个 lambda，在 lambda 中有循环变量参数。当我运行它时，我希望输出数字 0-9。但由于它是一个 lambda，x 不会立即得到评估。

```
 for( int x = 0; x < n; ++x)
    {
            vec.push_back(thread{[&x](){
                    m.lock();
                    cout << x << endl;
                    m.unlock();
            }});
    } 
```

输出：

```
0
3
3
9 
```

等等

其他语言的解决方案是创建一个临时变量，

```
 for( int x = 0; x < n; ++x)
    {
            int tmp = x;
            vec.push_back(thread{[&tmp](){
                    m.lock();
                    cout << tmp << endl;
                    m.unlock();
            }});
    } 
```

但这似乎不起作用。

请参阅[接收错误参数的线程](https://stackoverflow.com/questions/12324204/threads-receiving-wrong-parameters)

奖金：

在我寻找答案的过程中，我偶然发现了这个问题 [Generalizing C++11 Threads class to work with lambda](https://stackoverflow.com/questions/8382918/generalizing-c11-threads-class-to-work-with-lambda) ，它建议不要使用会使迭代器失效的容器。为什么会这样/

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-17T00:17:49.547

指定捕获时，可以在按值捕获和按引用捕获之间进行选择。您已选择通过引用进行捕获。通过引用捕获意味着 lambda 函数内部的变量引用的是同一个对象。这意味着对该变量的任何更改都将被共享，并且您还需要确保引用的对象在 lambda 函数的生命周期内一直存在。

您可能打算按值捕获。为此，您可以将捕获规范替换为 become`[=]`或 to become `[x]`。后者确保只能`x`访问，而前者将允许访问其他变量。

顺便说一句，我建议**不要**显式使用`lock()`and`unlock()`而是使用其中一个锁卫士。有了这个，你的循环体看起来像这样：

```
vec.push_back(std::thread{[x](){
    std::lock_guard<std::mutex> kerberos(m);
    std::cout << x << "\n";
}}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-17T00:09:13.223

如果要复制，请按*值*而不是按引用捕获参数：

```
vec.push_back(std::thread{[x](){
  m.lock();
  std::cout << x << std::endl;
  m.unlock();
}}); 
```

这将复制`x`创建 lambda 对象时的值（而不是在线程启动时）。

> 在我寻找答案的过程中，我偶然发现了这个问题 Generalizing C++11 Threads class to work with lambda，它建议不要使用会使迭代器失效的容器。为什么会这样/

因为它谈论的是直接使用 pthreads 库的完全不同的实现。您正在使用`std::thread`，它旨在在 C++ 中工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-17T00:10:00.690

问题是您正在通过引用捕获 x 。因此，当 x 在每个循环结束时递增时，这会反映在线程中。

您希望按值捕获 x，以便 lambda 仅在创建 lambda 时使用 x 的值。

```
for( int x = 0; x < n; ++x)
{               
   vec.push_back(thread{[x](){
      m.lock();
      cout << tmp << endl;
      m.unlock();
   }});
} 
```

# javascript - 如何在 JavaScript 中比较“x！= a OR b”？

> ID：12451765
> 
> 赞同：1
> 
> 时间：2012-09-17T00:09:16.847
> 
> 标签：javascript, logic, conditional-statements

想知道如何在 js 脚本中添加另外三个 !== 或语句。jsfriend00 提供了以下脚本作为一个壮观的答案，但问题是我犯了一个错误，没有提到还有三个文本区域下落不明。我在剩余的或 !== 条件下坚持使用 javascript。在以下脚本中，如何对以下每个 var obj 说 !==？

//查看管理员和客户之间的私有网络流的文件：

```
 <?php if(!defined('BASEPATH')) exit('No direct script access allowed'); ?>

 <html>
 <title>Chat</title>
 <head>

 <?php echo smiley_js(); ?>

 </head>
 <body>

 <?php echo form_open('controller/function');?>
 Reload chat<?php echo form_submit('reload','reload chat');?>
 <?php echo form_close();?>

 <?php if(isset($user_query)): foreach($user_query->result() as $row):?>

 <p>Created at: <?php echo $row->created_at; ?> </p> 

 <p>Updated at: <?php echo $row->updated_at; ?> </p> 

 <p><label for="update"> <?php echo $username_sess.'&nbsp;said'?>:<span class="optional"></span></label>  

  <textarea name="update" id="update" rows="7" cols="30"><?php echo $row->clt_rep_stream ?></textarea>

  <?php echo form_open('controller/function');?>

  <?php echo form_hidden('user_id',$row->user_id) ?>

  <p><label for="adm_update">reply to client:<span class="optional"></span></label>                                
  <textarea name="adm_update" id="adm_update" rows="7" cols="30"> </textarea>
  <?php echo form_error('adm_update'); ?>
   </p>
   <?php echo form_submit('submit','reply');?>

   <?php echo form_close();?>

   <?php echo form_open('controller/function'); ?>

   <?php echo form_hidden('user_id',$row->user_id) ?>

   <p>Replied at: <?php echo $row->adm_created_at; ?> </p> 

   <p>Updated at: <?php echo $row->adm_updated_at; ?> </p> 

   <p><label for="reupdate"> <?php echo $username_adm_sess.'&nbsp;replied:'?><span class="optional"></span></label>  

   <textarea name="reupdate" id="reupdate" rows="7" cols="30"><?php echo $row->adm_rep_stream ?> </textarea>
   <p>                             
   <?php echo form_submit( 'submit', 'update reply'); ?>
   </p>

  <?php echo form_close(); ?>

  <?php endforeach; ?>

  <?php endif; ?>

   <script>
   function autoRefresh(refreshPeriod) {
   var obj = document.getElementById("create"); 
   var obj_two = document.getElementById("update"); 
   var obj_three = document.getElementById("delete"); 
   var obj_four = document.getElementById("reload"); 

   function refreshIfSafe() {
   if (document.activeElement !== obj) { 
    window.location.reload();
  } else {
    setTimeout(refreshIfSafe, refreshPeriod);
   }
 }
    setTimeout(refreshIfSafe, refreshPeriod);
 }

   autoRefresh(2 * 1000);

   </script>

   </body>
   </html> 
```

我尝试了以下但没有奏效：

```
 if(document.activeElement !==(obj || obj_two)) 
```

我在布拉德的帖子之后尝试了以下内容，该帖子部分有效，但*在前两个之后的*任何更新或回复以及以下 js 都呈现为无效，这确实令人困惑：

```
 if(document.activeElement !== obj && document.activeElement !== obj_two) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T00:12:25.300

每个条件都是独立的。就这样对待它。

```
(document.activeElement !== obj) && (document.activeElement !== obj_two) && ... 
```

如果您的元素没有像它们一样被显式调用，您也可以在循环中执行此操作，但我不知道这将如何适合您的代码，因为我不知道您的实际代码是什么样的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T00:15:22.117

未经测试，但应该可以工作：

```
<script>
  function autoRefresh(refreshPeriod) {
    var elementArray = [
      document.getElementById("create"),
      document.getElementById("update"),
      document.getElementById("delete"),
      document.getElementById("reload")
    ];

    function refreshIfSafe() {
      if (elementArray.indexOf(document.activeElement) !== -1) {
        window.location.reload();
      } else {
        setTimeout(refreshIfSafe, refreshPeriod);
      }
    }
    setTimeout(refreshIfSafe, refreshPeriod);
  }

  autoRefresh(2 * 1000);
</script> 
```

或者

```
<script>
  function autoRefresh(refreshPeriod) {
    var elementArray = ["create", "update", "delete", "reload"];    

    function refreshIfSafe() {
      if (document.activeElement && elementArray.indexOf(document.activeElement.id) !== -1) {
        window.location.reload();
      } else {
        setTimeout(refreshIfSafe, refreshPeriod);
      }
    }
    setTimeout(refreshIfSafe, refreshPeriod);
  }

  autoRefresh(2 * 1000);
</script> 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-09-17T00:19:14.610

~~你可以试试~~……不，不要！

```
if(!(document.activeElement in [obj,obj_two])){
    // ...
} 
```

~~顺便说一句，在比较对象时，您实际上是在比较它们在内存中的引用地址......所以'！='就足够了。~~

# c++ - 检查谁在骰子游戏中获胜

> ID：12451766
> 
> 赞同：0
> 
> 时间：2012-09-17T00:09:24.777
> 
> 标签：c++, dice

我有一个骰子游戏

```
int userGame()
{
    cout << " User turn --- Press 2 to roll" << endl;
    cin >> userInput;

    if ( userInput == 2 )
    {
        Dice ();
        cout << "The user rolled        Dice 1 =" << die1 << " and Dice 2 = " << die2 << endl;
        cout << "Total = " << die1 + die2 << endl;
    }

    else {
        cout << "Wrong input. Try again";
        //userGame();
    }

    return (die1 + die2);
} 
```

现在在 int main 中，我有 -

```
int main ()
{
    // set the seed
    srand(time(0));
    userGame();

        while (true)
        {

            if (userGame() == 7 || userGame() == 11)
            {
                cout << "You won" << endl;
                break;
            }

            else if (userGame() == 2)
            {
                cout << "You loose" <<endl;
                break;
            }

            else

            {
                break;

            }

        }

        return 0; 
```

骰子 ();

```
#include<iostream>
#include<ctime>      // for the time() function
#include<cstdlib>    // for the srand() and rand() functions
using namespace std;
int compInput;
int userInput;
int die1 = 0;
int die2 = 0;
int Dice ()
{

    // roll the first die
    die1 = (rand() % 6 ) + 1;
    // roll the second die
    die2 = (rand() % 6 ) + 1;

} 
```

但是由于某种原因，输出显示不正确。一旦在输出为 7 时显示用户获胜，其他时间则继续游戏。

我在用 main() 中的循环做什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T00:15:06.970

```
if (userGame() == 7 || userGame() == 11) 
```

这条线是你的问题。C++ 使用短路评估。在这种情况下，如果`userGame() == 7`成功，则不检查后半部分。但是，如果失败，`userGame()`将在下半场再次调用，这意味着您将在进入 if 的代码部分之前玩两次。

```
 while (true)
    {
        int result = userGame();
        if (result == 7 || result == 11)
        {
            cout << "You won" << endl;
            break;
        }
        else if (result == 2)
        {
            cout << "You loose" <<endl;
            break;
        }
        else
        {
            break;
        }
    } 
```

# python - 如何在 Scipy 中定义具有时间延迟的 LTI 系统？

> ID：12451767
> 
> 赞同：9
> 
> 时间：2012-09-17T00:09:34.217
> 
> 标签：python, matlab, scipy, signal-processing, lti

具有时间延迟的 LTI 系统的传递函数有一个分子项 exp(-Td * s)，其中 Td 是时间延迟。在 Matlab 中，可以通过多种方式创建这样的 LTI 系统（例如，使用“s”运算符并直接设置指数项或通过设置对象的`inputdelay` `outputdelay`属性`tf`。）但是，我在 Scipy Signal LTI 中找不到任何方法来做到这一点对象。我还检查了 Python 控制系统库，但仍然找不到方法。

我不想将 Pade 近似用于时间延迟，并且想为 LTI 系统设置准确的时间延迟。

有谁知道如何在 Scipy 或任何其他外部 Python 库中实现这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-25T13:20:53.927

我在 github 上查看了 ltisys 模块，并尝试创建一个具有时间延迟的 LTI 类。我认为，如果我们将 BU(t) 替换为 BU(t-Td)，则在状态方程中引入输入时间延迟应该很简单，其中 Td 是时间延迟。以下方法适用于单输入单输出系统。可能不是没有错误，但它解决了我的目的。

```
#Inherit the parent LTI class  to create LTI class with time delay 

class ltidelay(lti):
    def __init__(self,inputdelay,*args,**kwargs):
        super(ltidelay,self).__init__(*args,**kwargs)    
        self.d =inputdelay

#define a method to simulate LTI with time delay . just copied lsim2 and made 2 changes. 1\. passed the delay from the `ltidelay` object and 2\. modified the state equation.

def lsim3(system , U=None, T=None,X0=None, **kwargs):
    if isinstance(system,lti):
        sys = system
    else:
        sys = lti(*system)
    delay = sys.d
    if X0 is  None:
        X0 = zeros(sys.B.shape[0],sys.A.dtype)        
    if T is None:
        T = linspace(0,10,101)
    T = atleast_1d(T)
    if len(T.shape) != 1:
        raise ValueError("T must be a rank1 array")
    if U is not None:
        U = atleast_1d(U)
        if len(U.shape)==1:
            U=U.reshape(-1,1)
        sU = U.shape
        if sU[0] != len(T):
            raise ValueError("U must have the same number of rows as elements in T")
        if sU[1] != sys.inputs:
            raise ValueError("The number of inputs in U is not compatible")
        ufunc = interpolate.interp1d(T, U, kind ='linear',axis =0,bounds_error =False)
        def fprime(x,t,sys,ufunc):
            return  dot(sys.A,x)+squeeze(dot(sys.B,nan_to_num(ufunc([t-delay]))))
        xout = odeint(fprime,X0,T,args=(sys,ufunc),**kwargs)
        yout = dot(sys.C,transpose(xout))
    else:
        def fprime(x,t,sys):
            return dot(sys.A,x)
        xout = odeint(fprime,X0,T,args=(sys,),**kwargs)
        yout = dot(sys.C, transpose(xout))
    return T , squeeze(transpose(yout)),xout   

#create an LTI system with delay 10

 tf = ltidelay(10,2,[4,1])

#create a step signal and time vector to simulate the LTI and check

u = linspace(0,0,100)

u[50:100] = 1

 t = linspace(1,100,100)

#check the simulation
y = lsim3(tf,u,t,X0 =0)

plot(y[1]) 
```

![在此处输入图像描述](../Images/6b8a9a2a240964723a60d07023b993b8.png)

```
# compare with  LTI without time delay
y1 =lsim2(tf, u,t, X0=0)

plot(y1[1]) 
```

![在此处输入图像描述](../Images/9b16a8b849ab9702ee0a703b21946459.png)

```
#delay works 
```

# c# - 页面对象事件

> ID：12451776
> 
> 赞同：0
> 
> 时间：2012-09-17T00:12:03.203
> 
> 标签：c#, .net

我正在分解我必须支持的一些以前的代码，并且想知道这些事件指的是什么？

```
public CodeFormatterExtension()
{
    Page.Serving += ServingContent;
    Post.Serving += ServingContent;
} 
```

### 问题：

1.  `Post`名称空间中无法识别对象`System.Web.UI`，那么我应该将其重新映射到什么位置？
2.  `Serving`事件未被识别。通过签名，它应该接受`(object, ServingEventArgs)`，应该将它重新映射到什么 Page/Post 事件？

最后，我不确定这是来自哪个 .Net 库框架，因为其中大部分只是我要导入到项目中的代码文件集合，以便为此类问题创建受控的开发环境。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T00:36:47.260

网络搜索将`ServiceEventArgs`我指向[BlogEngine.NET](http://blogengine.codeplex.com/wikipage?title=Extensions&referringTitle=Documentation)。不能保证这是您的代码的来源，但他们网站上的示例与您的完全匹配。

# vb.net - 检查窗口窗体按钮是否处于活动状态？

> ID：12451777
> 
> 赞同：0
> 
> 时间：2012-09-17T00:12:05.107
> 
> 标签：vb.net, winforms

如何检查一个按钮当前是否处于活动状态，例如，当您单击一个按钮后，它会保持蓝色，如果您从中选择，您将移至下一个按钮，不确定这是否有意义。我在一个数组中有很多按钮，我需要找到用户选择了哪个按钮，或者找到一种方法来轻松判断用户何时单击按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T00:25:13.827

当用户单击按钮时，它会触发一个事件，您可以拦截和处理该事件。

至于哪个按钮是“活动的”，即哪个按钮有焦点，可以使用窗体的ActiveControl属性。

此论坛帖子可能会有所帮助：[VBForums：查找哪些控件具有焦点？](http://www.vbforums.com/showthread.php?365712-Find-what-control-has-focus)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T02:19:56.580

为您的按钮分配一个常见的单击事件，然后测试发送者以确定单击了哪个按钮。在很多情况下，我将使用控件标记属性来分配唯一编号，而不是使用控件名称。Joao 关于使用[ActivControl 属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.containercontrol.activecontrol.aspx)的回答将让您知道表单上的哪个控件具有焦点。

```
Private Sub Button_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click, Button9.Click, Button8.Click, Button7.Click, Button6.Click, Button5.Click, Button4.Click, Button3.Click, Button2.Click, Button12.Click, Button11.Click, Button10.Click
    Dim btn As Button = CType(sender, Button)
    Select Case btn.Name
        Case "Button1"
            'Do Something
        Case "Button2"
            'Do Something
        Case "Button3"
            'Do Something
        Case "Button4"
            'Do Something
        Case Else
            'Do Something
    End Select
End Sub 
```

# iphone - 如何使用 Xcode 4.3 在情节提要中实现 UIModalTransitionStylePartialCurl？

> ID：12451781
> 
> 赞同：1
> 
> 时间：2012-09-17T00:12:45.863
> 
> 标签：iphone, objective-c, xcode, view, uimodaltransitionstyle

我试试这个：

视图控制器.h

```
@class SecondView;

@interface Introduccion : UIViewController{

    SecondView *second;
}

-(IBAction)AnimatecreditsPage:(id)sender;

@end 
```

视图控制器.m

```
-(IBAction)AnimatecreditsPage:(id)sender{

    second = [[SecondView alloc]initWithNibName:@"SecondView" bundle:nil];

    second.modalTransitionStyle = UIModalTransitionStylePartialCurl;
    [self presentModalViewController:second animated:YES];

} 
```

我正在使用故事板，并且我已经将我的视图控制器与相应的类链接起来，当我按下按钮时，iphone 模拟器就崩溃了。我正在使用导航控制器和标签栏控制器。

[视图控制器的图像](http://imageshack.us/a/img526/7783/sinttuloucd.png)

谢谢！！：） 请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T00:36:01.203

您尝试的方式正在崩溃，因为您指向的是不存在的 xib。由于使用故事板，您可以拥有多个视图控制器，因此您必须在界面构建器的属性检查器部分中为您希望使用的视图控制器添加一个标识符。然后，这允许您使用以下代码以编程方式实例化情节提要中具有您指定的 ID 的任何视图控制器。

```
second = [self.storyboard instantiateViewControllerWithIdentifier:@"someID"]; 
```

代替：

```
second = [[SecondView alloc]initWithNibName:@"SecondView" bundle:nil]; 
```

# jquery - 使用 jquery 过滤图像 src 中的单词

> ID：12451787
> 
> 赞同：5
> 
> 时间：2012-09-17T00:13:30.120
> 
> 标签：jquery, regex, string, filter

我正在尝试过滤我的图像 src 中的特定单词（“无图像”），如果它返回 true，我想删除该特定图像但保留其余图像。

这是我的输出：

```
<div class="product">
  <div class="image">
   <img src="mytee-red.jpg">
   <img src="mytee-blue.jpg">
   <img src="mytee-black.jpg">
   <img src="mytee-no-image.jpg">
 </div>
</div> 
```

这是我迄今为止尝试过的，但似乎无法让它工作：

```
var keyword = "no-image";
 $(".product .image img").filter(function(index) {
    if ($(this).attr("src") == keyword) {
        $(this).remove();
    }
}); 
```

任何帮助都会很棒！！！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T00:16:51.387

您可以将其简化为一个命令 -

```
$(".product .image img[src*='no-image']").remove(); 
```

[jQuery 属性包含选择器](http://api.jquery.com/attribute-equals-selector/)将帮助您精确定位您想要在`src`属性中的任何位置包含文本“no-image”的元素。

> 这是匹配值的最慷慨的 jQuery 属性选择器。如果选择器的字符串出现在元素属性值中的任何位置，它将选择一个元素。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T00:17:18.013

```
$('.product .image img[src*="no-image"]').remove(); 
```

[http://api.jquery.com/attribute-contains-selector/](http://api.jquery.com/attribute-contains-selector/)

不需要正则表达式。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-17T00:18:08.203

根据您的示例，您需要使用`match()`而不是`==`

```
var keyword = "no-image";
 $(".product .image img").filter(function(index) {
    if ($(this).attr("src").match(keyword)) {
        $(this).remove();
    }
}); 
```

假设您要删除`<img src="mytee-no-image.jpg">`，因为它与关键字匹配`no-image`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-17T00:23:02.613

其他答案提出了更好的方法，但`filter()`可能是：

```
var keyword = "no-image";
 $(".product .image img").filter(function(index) {
    return $(this).attr("src").match(keyword);
}).remove(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-17T00:17:16.027

过滤器只会保留传递函数返回 true 的项目。与其尝试在过滤器函数中删除它们，不如返回 false。

> .filter( function(index) )：将匹配元素的集合减少为匹配选择器或通过函数测试的元素。

```
var keyword = "no-image";
 $(".product .image img").filter(function(index) {
    return $(this).attr("src") != keyword;
}); 
```

# ios - UITableView 与 UIScrollView

> ID：12451788
> 
> 赞同：1
> 
> 时间：2012-09-17T00:14:24.137
> 
> 标签：ios, uitableview, uiscrollview

我正在开发一个动画应用程序。我想要一个水平的 UITableView 或水平的 UIScrollView 来显示代表页面 X 上的绘图的小图像。

由于我的动画应用可以轻松拥有 200 个绘图，这意味着我的 UITableView 或 UIScrollView 可以包含 200 个图像。

最后，我想实现 UIAnimation，用户可以通过拖放重新排序图像。我想要一些光滑的东西...

我有 2 个问题：

1.  哪些类更适合内存管理？我想我理解 UITableView 会自动卸载屏幕外的单元格，而不是 UIScrollView。真的吗？
2.  考虑到可能的重负载，哪一个可能更容易实现？（我为水平 UITableView 找到了这个：[EasyTableView](https://github.com/alekseyn/EasyTableView)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T00:36:52.097

您应该研究使用 UIScrollView 进行平铺。在过去的三年中，WWDC 上有一些关于 UIScrollView 高级使用的非常好的会议，如果您是注册开发人员，可以观看这些会议的视频。他们将向您展示如何使用 UIScrollView 的平铺功能来仅加载您需要的内容，就像 UITableView 仅加载它需要的内容一样。

据我所知，UITableView 不能在水平模式下工作，所以如果你只考虑 Cocoa Touch 中的类，UIScrollView 目前是你唯一的选择。我确信有一些第三方选项，但我不知道足以推荐一个。

# configuration - Hadoop/Hive 集群。只有一个节点利用率

> ID：12451790
> 
> 赞同：0
> 
> 时间：2012-09-17T00:14:29.900
> 
> 标签：configuration, hadoop, hive

我有一个小型 hadoop/hive 集群（总共 6 个节点）。使用“hadoop dfsadmin -report”我看到数据节点运行良好且已连接。此外，当我在配置单元表中添加数据时，我可以看到数据分布在整个节点上。（易于检查，随着使用的磁盘空间增加）。

我正在尝试在一张表上创建一些索引。从 jobtracker http 界面，我看到只有一个节点可用。我尝试运行多个查询（我使用 mysql 作为元数据），但它们似乎只在安装了 hive 的节点上运行。

基本上我的问题是如何让 jobtracker 也能利用其他节点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T06:52:26.040

从您所说的情况来看：
Datanodes 在所有节点上都正常运行，并且能够与 namenode 通信。
任务跟踪器**没有**在除一个之外的所有节点上运行，或者由于某种原因无法与作业跟踪器通信。
在检查任务跟踪器确实在运行之后 - 阅读他们的日志以找出他们与 JobTracker 通信的问题。

# grails - 如何处理 GORM 异常

> ID：12451792
> 
> 赞同：3
> 
> 时间：2012-09-17T00:14:43.950
> 
> 标签：grails, exception-handling, grails-orm

我正在尝试为 Hibernate 抛出的乐观锁类​​型异常实现异常处理，但我遇到了一个奇怪的问题。看来我无法捕捉到任何 Gorm 异常。

例如，我的服务中有以下代码：

```
try {
  User user = User.get(1);
  Thread.sleep(10000);
  user.viewedAt(new Date());
  user.save(flush:true);
} catch (OptimisticLockingException ex) {
  log.error("Optimistic lock exception");
} catch (StaleObjectStateException ex) {
  log.error("Optimistic lock exception");
} 
```

当我用两个线程点击这个块时，它会爆炸并且异常传播到 Grails 的标准异常处理程序。即使报告的异常是 .catch 块也不会被调用`StaleObjectStateException`。

我注意到如果我让它传播到控制器并在那里捕获它，我*可以捕获异常，但似乎我无法在服务中实现异常处理，这很奇怪。*

我错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T08:18:56.367

我查到了这个问题，我把它贴出来以防其他人遇到这个问题。出现此问题是因为 try/catch 块位于事务服务中。尽管 grails 报告在调用期间抛出了异常，但`save()`实际上它是在整个方法***之后，即事务提交时调用的。***

所以看起来：

1.  `flush: true`对交易服务没有影响
2.  在事务服务中捕获与 GORM 相关的异常是不可能的，至少在没有一些工作的情况下是不可能的

我终于通过自己手动管理事务来解决这个问题，即

```
try {
  User.withNewTransaction {
    User user = User.get(id); // Must reload object
    .. // do stuff
    user.save(flush:true)
  }
} catch (OptimisticLockingException ex) {
  ...
} 
```

我希望这对其他人有用！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-17T02:59:35.297

我花了一些时间来解决这个问题，并编写了一个更完整的解决方案来处理 Grails 中的乐观锁定异常情况。

首先，虽然堆栈跟踪中报告的异常是 StaleObjectStateException，但引发的实际异常是 HibernateOptimisticLockingFailureException（不是“OptimisticLockingException”）。其次，如果你想把它概括为处理修改域对象的任意闭包，你需要重新抛出闭包内抛出的异常。

以下静态函数将获取一个对象和一个对该对象进行操作的闭包，将其保存，如果失败，则重试，直到成功：

```
public static retryUpdate(Object o, Closure c) throws Exception {
    def retVal
    int retryCount = 0
    while (retryCount < 5) {
        try {
            Model.withTransaction { status ->
                retVal = c(status)
                o.save()
            }
            return retVal
        } catch (HibernateOptimisticLockingFailureException e) {
            log.warn "Stale exception caught saving " + o
            if (++retryCount >= 3) { // if retry has failed three times, pause before reloading
                Thread.sleep(1000)
            }
            o.refresh()
        } catch (UndeclaredThrowableException e2) {
            // rethrow exceptions thrown inside transaction
            throw e2.getCause()
        }
    }

    return null
} 
```

在这种情况下，模型是任何 GORM 模型类，不管是哪一个。特别是它是否是传入对象的类并不重要。

使用示例：

```
AnotherModelClass object = AnotherModelClass.get(id)
retryUpdate(object) {
    object.setField("new value")
} 
```

# ios - 带有 AccessoryView 的单个 UITableViewCell

> ID：12451794
> 
> 赞同：0
> 
> 时间：2012-09-17T00:15:15.137
> 
> 标签：ios, uitableview

我正在尝试在每个单元格内构建一个带有一些长文本的 UITableView。单元格没有 AccessoryView，除了一个单元格（第 8 个），这是一种打开详细视图的按钮。

考虑这段代码：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    CGSize size = [[quotes objectAtIndex:indexPath.row] sizeWithFont:16 constrainedToSize:CGSizeMake(self.view.frame.size.width, CGFLOAT_MAX)];
    return size.height+20;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    cell.textLabel.lineBreakMode = UILineBreakModeWordWrap;
    cell.textLabel.numberOfLines = 0;
    cell.textLabel.text = [quotes objectAtIndex:indexPath.row];

    if(indexPath.row==7){
        [cell setAccessoryType:UITableViewCellAccessoryDetailDisclosureButton];
    }

    return cell;
} 
```

它可以工作，但问题是当我滚动到表格的底部（第 8 行也是最后一行）然后我回到上面时，另一个 AccessoryView 被添加到一个随机点（或多或少的第 3 行）单元格，但我不知道它是在里面还是随机漂浮）。是否与iOS的单元重用有关？我怎样才能避免它？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T00:32:21.170

该单元正在被重用（如您对 的调用所示`-dequeueReusableCellWithIdentifer`）。

答案是在出列后将单元格设置为*所需*`else`的默认值，或者在语句中添加一个子句`if`来处理它。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    cell.textLabel.lineBreakMode = UILineBreakModeWordWrap;
    cell.textLabel.numberOfLines = 0;
    cell.textLabel.text = [quotes objectAtIndex:indexPath.row];
    // Set to expected default
    [cell setAccessoryType:UITableViewCellAccessoryNone];

    if(indexPath.row==7){
        [cell setAccessoryType:UITableViewCellAccessoryDetailDisclosureButton];
    }

    return cell;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T00:32:54.533

您必须为每个单元格明确设置不公开按钮，但您希望公开的单元格除外。这样，当单元格在其他地方重用时，它的公开指示符就会被删除：

```
 if(indexPath.row==7){
        [cell setAccessoryType:UITableViewCellAccessoryDetailDisclosureButton];
    }else{
        [cell setAccessoryType:UITableViewCellAccessoryNone];
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T00:34:34.703

这是由于您推测的细胞重用。您必须明确设置`UITableViewCellAccessoryNone`索引路径不是 7 处的单元格。

# java - 如何使用 Mockito 传递构造函数参数

> ID：12451802
> 
> 赞同：5
> 
> 时间：2012-09-17T00:17:14.330
> 
> 标签：java, mockito

我想使用 Mockito 框架来模拟一个类，它有几个构造函数参数。

我将如何在不为私有成员变量生成设置器的情况下传递这些构造函数参数？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T05:26:40.620

你说你想模拟一些但不是所有的方法。我不确定您为什么要这样做 - 如果您的班级是合作者，那么模拟整个班级是有意义的。或者，如果它是 SUT，您可能根本不想模拟它。

您正在寻找的可能是[spy](http://docs.mockito.googlecode.com/hg/latest/org/mockito/Mockito.html#13)，而不是 mock。如果您决定使用间谍，您将从一个真实的对象制作它，该对象已经使用您需要构建它的任何参数构建。

但是在你考虑使用间谍之前，我敦促你更仔细地考虑一下你正在测试的究竟是什么，以及为什么你认为你需要用模拟实现来替换你的*一些*方法，而不是其他的。

# interface-builder - 使用 NSArrayController 添加对象时使 NSTableView 行可编辑

> ID：12451811
> 
> 赞同：7
> 
> 时间：2012-09-17T00:18:10.820
> 
> 标签：interface-builder, nsuserdefaults, nstableview, cocoa-bindings, nsarraycontroller

我有一个 NSTableView 的表列绑定到 Interface Builder 中的 NSArrayController 。数组控制器绑定`Shared User Defaults Controller`到`Content Array`. 我必须选择`Handles Content As Compound Value`使添加新对象起作用。`add:`不幸的是，当我将对象添加到数组时，这会禁用表格行的突出显示。对象已添加，但表格行未突出显示，您必须双击您认为该行能够对其进行编辑的位置。

我的目标是`add:`使用数组控制器到表格视图的一行；然后，让该行自动突出显示并可供用户编辑。

NSArrayController 的属性：

![在此处输入图像描述](../Images/440415db4302ce2ce0febd4e04047915.png)

NSArrayController 的绑定：

![在此处输入图像描述](../Images/de2f92855063467992e7f0c170fa532a.png)

TableView 列的绑定：

![在此处输入图像描述](../Images/641162b2c8325bae4bfeb5711f893540.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T04:38:45.017

[我在这里](http://lists.apple.com/archives/cocoa-dev/2009/Dec/msg00326.html)找到的解决方法对我有用。

你需要继承 NSArrayController 并实现你自己的 add: 方法

```
//
//  MyArrayController.h
//

#import <AppKit/AppKit.h>

@interface MyArrayController : NSArrayController

@end 
```

和

```
//
//  MyArrayController.m
//

#import "MyArrayController.h"

@implementation MyArrayController

- (void)add:(id)sender {
    [super add:sender] ;

    [self performSelector:@selector(selectLastObject)
               withObject:nil
               afterDelay:0.0] ;
}

- (void)selectLastObject {
    if ([self selectsInsertedObjects]) {
        NSArray* arrangedObjects = [self arrangedObjects] ;
        NSInteger nObjects = [arrangedObjects count] ;
        if (nObjects > 0) {
            [self setSelectionIndex:nObjects-1] ;
        }
    }
}

@end 
```

# c# - c#方法中的方法

> ID：12451816
> 
> 赞同：3
> 
> 时间：2012-09-17T00:18:58.617
> 
> 标签：c#, methods

在 Delphi 中，您可以在函数中定义函数，例如：

```
function Foo : integer;
var myvar : integer;
    function Foo1;
    begin
        myvar := 42;
    end;
begin
    result := myvar;
end; 
```

这会按预期返回 42，因为 Foo1 可以访问 Foo 的 myvar。

C#中是否有任何等价物？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-17T00:23:57.993

是的，有很多方法可以做到这一点。一种方法是声明[Func](http://msdn.microsoft.com/en-us/library/bb534960.aspx)或[Action](http://msdn.microsoft.com/en-us/library/018hxwa8.aspx)委托，如下所示：

```
void Foo()
{
    Func<int,int> f = x => x+1;
    //or
    Func<int,int> ff = x => {
        return x+1;
    };
    var r = f(1); //2
    var rr = ff(2); //3

    Func<int,int,int> add => (a,b) => a+b;
    var rrr = add(2,3); //5
} 
```

简写声明 ( `=>`) 在 Linq 中很常用。请参阅[lambdas](http://msdn.microsoft.com/en-us/library/bb397687.aspx)。

在 BCL（或现在所谓的任何东西）中声明了许多泛型`Func`和委托，以允许除最愚蠢的长度参数列表之外的所有参数列表。`Action`如果您需要更多参数，您始终可以声明自己的通用委托。

# ios - 为现有的 CGImageRef 创建一个 CGContextRef

> ID：12451821
> 
> 赞同：1
> 
> 时间：2012-09-17T00:19:30.757
> 
> 标签：ios, core-graphics, cgcontext, cgimage

假设我有一个现有的 CGImageRef。我想为该现有图像创建一个 CGContextRef 并在其中绘制一些东西。

考虑到 CGImageRef 在内存中有一个底层数据数组，我的猜测是应该可以使用`CGBitmapContextCreateWithData`来自 CGImageRef 的底层内存数据创建一个新的上下文并将其作为数据数组传递。

不幸的是，我不知道如何从 CGImageRef 获取数据数组（甚至可能不可能）。

请注意，我不喜欢创建新上下文，先绘制旧图像，然后再绘制新内容。

# wpf - 将组合框中选定对象的属性绑定到 WPF 中的 TextBox

> ID：12451822
> 
> 赞同：2
> 
> 时间：2012-09-17T00:19:37.080
> 
> 标签：wpf, mvvm, binding, combobox, textbox

我正在使用 MVVM 加载文本文件并显示它们的内容。

**模型**

`MyFile.cs`有一个`Name`和`Text`// 实现 INotifyPropertyChanged

`MyFileRepository.cs`// 我加载的文件的集合

**视图模型**

`OpenFileCommand`加载文件并将其添加到 _filerepository 对象

`FileCollection`绑定到视图

**看法**

`Button`解雇`OpenCommand`

`ComboBox`显示加载文件的名称

`TextBox`在 combobx 中显示所选文件的内容

```
<Button Name="OpenFile" Command="{Binding OpenFileCommand}">
<ComboBox  Name="FilesList" ItemsSource="{Binding Path=FileCollection}" DisplayMemberPath="Name" />
<TextBox Name="FileContent" Text="{Binding the Text of selected file in combobx "/> 
```

如何将combobx中选择的MyFile的Text属性绑定到TextBox？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T00:48:03.890

最简单的方法是元素绑定：

```
<TextBox Name="FileContent"
         Text="{Binding SelectedItem.Text,ElementName=FilesList} /> 
```

所以这绑定到 FilesList ComboBox 中 SelectedItem 的 Text 属性，它（如果一切都按照我认为的方式连接）是 MyFile 类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T08:32:18.710

如果没有元素绑定，您可以将属性“SelectedItem”（类型：MyFile）添加到您的 VM 并将其绑定到您的组合框的 SelectedItem 属性（mode=twoway）。现在您的 TextBox.Text-Property 应该如下所示：

```
<TextBox Name="FileContent"
         Text="{Binding SelectedItem.Text} /> 
```

# asp.net-membership - 将数据从 ASP.Net Membership Provider 迁移到 System.Web.Providers

> ID：12451823
> 
> 赞同：0
> 
> 时间：2012-09-17T00:20:06.823
> 
> 标签：asp.net-membership, azure-sql-database

我正在将现有的 asp.net mvc 应用程序迁移到 Azure，并希望使用 System.Web.Providers 作为成员资格。

是否有任何现有的工具或方法可以将数据从 ASP.Net 成员资格提供程序迁移到 System.Web.Providers？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-22T07:31:40.400

.NET Web 开发和工具博客上有一篇文章
[http://blogs.msdn.com/b/webdev/archive/2012/08/16/migration-for-user-accounts-from-the-sqlmembershipprovider-to- the-universal-providers.aspx](http://blogs.msdn.com/b/webdev/archive/2012/08/16/migration-for-user-accounts-from-the-sqlmembershipprovider-to-the-universal-providers.aspx)
详细解释了如何移动数据以及要触摸的 Web.Config 属性。

基本上你需要的是一堆 SQL 语句

```
INSERT INTO dbo.Applications (ApplicationName, ApplicationId, Description)
SELECT ApplicationName, ApplicationId, Description FROM dbo.aspnet_Applications
GO

INSERT INTO dbo.Roles (ApplicationId, RoleId, RoleName, Description)
SELECT ApplicationId, RoleId, RoleName, Description FROM dbo.aspnet_Roles
GO

INSERT INTO dbo.Users (ApplicationId, UserId, UserName, IsAnonymous, LastActivityDate)
SELECT ApplicationId, UserId, UserName, IsAnonymous, LastActivityDate FROM dbo.aspnet_Users
GO

INSERT INTO dbo.Memberships (ApplicationId, UserId, Password, 

PasswordFormat, PasswordSalt, Email, PasswordQuestion, PasswordAnswer, 

IsApproved, IsLockedOut, CreateDate, LastLoginDate, LastPasswordChangedDate, 

LastLockoutDate, FailedPasswordAttemptCount, 

FailedPasswordAttemptWindowStart, FailedPasswordAnswerAttemptCount, 

FailedPasswordAnswerAttemptWindowStart, Comment) 
SELECT ApplicationId, UserId, Password, 

PasswordFormat, PasswordSalt, Email, PasswordQuestion, PasswordAnswer, 

IsApproved, IsLockedOut, CreateDate, LastLoginDate, LastPasswordChangedDate, 

LastLockoutDate, FailedPasswordAttemptCount, 

FailedPasswordAttemptWindowStart, FailedPasswordAnswerAttemptCount, 

FailedPasswordAnswerAttemptWindowStart, Comment FROM dbo.aspnet_Membership
GO

INSERT INTO dbo.UsersInRoles SELECT * FROM dbo.aspnet_UsersInRoles
GO 
```

您还必须`passwordCompatMode="Framework20"`向会员提供者配置添加属性。

# sql-server-2005 - SQL 表分区错误 - 无法向现有分区表添加新分区

> ID：12451826
> 
> 赞同：1
> 
> 时间：2012-09-17T00:21:01.973
> 
> 标签：sql-server-2005, database-design

我继承了一个 SQL Server，并且发现了一个表分区问题。由于我不确定的原因，我无法将新分区添加到现有表分区。

**环境：**

SQL Server 2005 Enterprise，数据库大小约为 400GB，4GB RAM，仅限 32 位系统。

**分区表详细信息：**

*表在多个磁盘卷上的 13 个文件组中分区。

*分区函数为 RANGE LEFT，具有 12 个边界点，它们是日期时间值。

*边界点采用日期季度结构（例如：2009-12-31 23:59:59、2010-03-31 23:59:59、2010-06-30 23:59:59）。

*日期时间值是分区键。

*数据根据当前日期每天插入到表中，但是只有最后一个文件组接收数据，因为函数的最后一个边界点是'2010-06-30 23:59:59'。

*表有一个与表对齐的聚集索引，以及 3 个非唯一非聚集索引（2 个对齐，1 个完全存在于不同的文件组中）。

*当前表卷详细信息：

数据空间：75GB+

索引空间：50GB+

行数：2亿+

**问题：**

当前最后一个文件组/分区没有最大日期边界点，因此日期 '2010-06-30 23:59:59' 之后的所有数据已经​​/仍在插入到此分区中。幸运的是，事务数据量相当小，但在两年的时间里，最终分区已增长到令人印象深刻的 22GB 大小。我不希望从这个现有分区中拆分或删除数据。但是，我确实想添加一个新文件组并更改现有的分区功能，以便将所有未来的数据插入到新的文件组中。我想添加一个新的未来日期作为边界点，以便在该日期之后插入的所有数据都进入一个新的文件组/分区。

**使用方法：**

使用 ALTER DATABASE 函数添加了一个新的文件组/文件 - *SUCCESS*。

更改了分区方案，以便为新创建的文件组分配 'NEXT USED' - *SUCCESS*。--用于改变分区方案的脚本--

ALTER PARTITION SCHEME [partition_scheme_name] NEXT USED (new_filegroup_name);

更改了分区函数以添加新的边界点 - *FAIL*。

--用于向函数添加新边界点的脚本--

ALTER PARTITION FUNCTION partition_function_name() SPLIT RANGE ('2012-10-01 23:59:59) GO

**错误：**

使用 SPLIT RANGE 技术将新边界点添加到现有分区失败，因为数据库事务日志已填满（限制为 18GB）。这让我感到惊讶，原因有两个 - 1）：我认为使用 SPLIT RANGE 只是一个元数据函数（如果我错了，请纠正我）和 2）：我的新边界点在表中尚不存在作为日期值，所以我假设不会有数据移动。

**到目前为止我已经尝试过：**

*我使用测试服务器成功测试了此方法，但数据集要小得多。

*然后我将生产数据库的完整副本恢复到测试系统上。我添加了第二个无限增长的数据库日志文件，并尝试再次更改分区功能。原数据库事务日志按预期填满，但辅助数据库事务日志增长到 60GB！此外，tempdb 增长到 14GB。当整个进程由于另一个错误而再次中止时，新文件组的大小开始增加。这次的错误是：

（'无法在具有唯一索引'Index_name'的对象'table_name'中插入重复的键行）。

现在有两件事让我完全困惑：

1）：测试错误中提到的索引是非聚集、非唯一索引 - 为什么会出现重复错误？

2）：更重要的是，我正在添加一个新的日期时间值作为新的最大边界点，并且该值在表中尚不存在。为什么会有数据移动？？？

如前所述，我已经使用更小的数据集测试了这种方法，并且效果很好。我不明白为什么它不适用于生产数据集。我在这里遗漏了一些非常明显的东西吗？任何意见是极大的赞赏。感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T08:58:16.420

我认为您想要对分区表进行分区，并且我看到您使用的命令是正确的，我认为您最好尝试在“创建方案查询”中添加新边界并添加新文件组到“创建与方案相关的函数查询”，以便它可以完美地工作，通过这样做，以前文件组中存在的数据将得到拆分。

所以你最好在“创建方案和创建函数”查询的源代码中尝试。:)

# php - 我应该如何在 php 中记录允许的数组参数值

> ID：12451827
> 
> 赞同：0
> 
> 时间：2012-09-17T00:21:07.493
> 
> 标签：php, documentation, phpdoc

我经常将数组作为构造函数参数传递。我应该如何记录允许值？我尝试了一些样式，但它们在 phpdoc 中看起来有点乱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T01:16:47.530

确实没有用于记录散列数组的“官方” phpdoc 方法，但这是一种方法：

```
/**
 * @param array $options hash of standard options for this class:
 *    int id the id of whatever object
 *    string name name of whoever it is
 *    array sub_option hash of sub options:
 *        int num number description for this index
 *    bool is_good should we do this or not?
 */
 function __construct( $options ){
 } 
```

# java - 如何将在终端中运行的 Java 应用程序变成带有 UI 的桌面应用程序？

> ID：12451832
> 
> 赞同：1
> 
> 时间：2012-09-17T00:22:58.493
> 
> 标签：java, swing, user-interface

我知道他们有很多不同的方法来做到这一点，但我越来越擅长使用终端，并希望继续创建用户界面和桌面应用程序！我写了一个非常俗气和凌乱的“数字游戏”，并希望让它在一个带有按钮和所有爵士乐的小程序中运行！

```
public static void gameStart()  {
    System.out.println("Welcome to the Game of Awesome V1.2");
    System.out.println("-------------------------------------");
    spin();
}

public static void spin()   {

    int spinNum = (int)(10*Math.random());
    Scanner input = new Scanner(System.in);
    Scanner input2 = new Scanner(System.in);
    System.out.println("type a number between 1 and 10:");
    int guessNum = input.nextInt();

    if(guessNum > 10)   {
        System.out.println(guessNum + " is greater than 10 you fool!");
                    spin();
    }else if(guessNum < 1)  {
        System.out.println(guessNum + " is less than 1 you fool!");
                    spin();
    }else   {

                System.out.println("\nSweet, looks like you chose [" + guessNum + "], good luck...");
                System.out.println("\ntype \"s\" to spin and \"quit\" to, quit...");
                String run = input2.nextLine();
            switch (run.toLowerCase()) {
                case "s":
                    System.out.println("\nyou spun [" + spinNum + "] and guessed [" + guessNum + "]!");
                    if(guessNum == spinNum) {
                        win();
                        askPlay();
                    }else   {
                            lose();
                            askPlay();
                    }
                    break;
                case "quit":
                    System.out.println("See ya later!");
                    System.out.println();
                    System.exit(0);
                    break;
                default:
                    System.out.println("shit, you broke it! Luckily, I can fix this.");
                    askPlay();
                    System.out.println();
                    break;
            }
            }
}

public static void askPlay()    {

        Scanner input = new Scanner(System.in);
        System.out.println("\nWanna play again? (Type \"yes\" or \"no\")");
        String decideSpin = input.nextLine();

    switch (decideSpin.toLowerCase()) {
        case "yes":
            spin();
            break;
        case "no":
            System.out.println("\nI know it's a crappy game, thanks for playing though!");
            System.out.println();
            System.exit(0);
            break;
        default:
            System.out.println("\nI'm sorry,\nI was made by a lazy "
            + "programmer and can only understand \"yes\" or \"no\"..");
            askPlay();
            break;
    }
}

public static void win()    {
    System.out.println("\nWINNER: you won this insanley stupid game, of awesome! Be proud, winner. (:");
}

public static void lose()   {
    System.out.println("\nLOOOOOSSSSSEEEERRRR: yep, you stand with the majority with this loss.");
} 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T00:49:11.250

我建议您先阅读[Swing Trail](http://docs.oracle.com/javase/tutorial/uiswing/index.html)

您需要了解的另一件事是 Swing 是事件驱动的，不像控制台程序，它倾向于按顺序运行

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T00:31:59.203

嗯，很简单：开始学习一些 Java 的 GUI，我会推荐以下两个之一：

*   [摇摆](http://docs.oracle.com/javase/tutorial/uiswing/start/index.html)

*   [SWT](http://www.eclipse.org/swt/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T00:45:29.987

一定要开始学习 Swing。这是标准的 Java GUI 框架。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-04T18:32:34.080

考虑在[处理](http://processing.org/)（Java 库/Applet）中运行它。这可能是最快最简单的方法来启动和运行。如果您愿意，您甚至可以将其导出为应用程序。干杯!

# jquery - 将xml解析成jquery

> ID：12451834
> 
> 赞同：0
> 
> 时间：2012-09-17T00:23:38.257
> 
> 标签：jquery, xml, parsing

我在 jquery 中解析 xml。我想在“alert()”运行时看到一行符号。

这是xml：

```
<?xml version="1.0" encoding="utf-8"?>
<charlist>
    <list>
        <title>symbol1</title>
        <chr><![CDATA[√,∽, ∝, ∵, ∫, ∬, ∈, ∋, ⊆]]></chr>
    </list>
    <list>
        <title>symbol2</title>
        <chr><![CDATA[①, ②, ③, ④, ⑤, ⑥, ⑦, ⑧]]></chr>
    </list>
    <list>
        <title>symbol3</title>
        <chr><![CDATA[㉠, ㉡, ㉢, ㉣, ㉤, ㉥, ㉦, ㉧]]></chr>
    </list>
    <list>
        <title>symbol4</title>
        <chr><![CDATA[㎕, ㎖, ㎗, ℓ, ㎘, ㏄, ㎣, ㎤]]></chr>
    </list>
</charlist> 
```

这是我做的jquery。

```
$.ajax({
    type: "get",
    url: "XMLFile1.xml",
    dataType: "xml",
    success: function (xml) {
        $(xml).find('list').each(function () {
            var title = $(this).find("title").text();
            var chr = $(this).find("chr").text();
            alert(chr);
        });
    }
}); 
```

运行后出现三行。"√,∽, ∝, ∵, ∫, ∬, ∈, ∋, ⊆" 然后, ㉠, ㉡, ㉢, ㉣, ㉤, ㉥, ㉦, ㉧ 然后, ㎕, ㎖, ㎗, ℓ, ㎘, ㏄、㎣、㎤。我只想查看我在 jquery 中按数组选择的一行。例如。如果我输入“alert(chr[1])”，第二行会出现 ㉠、㉡、㉢、㉣、㉤、㉥、㉦、㉧。“alert”只出现一行。任何人都可以帮助我解决这个问题？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T01:00:20.737

如果我对您的理解正确，以下示例应该可以帮助您了解如何从您的 xml 构建数组：

```
 var xml = '<?xml version="1.0" encoding="utf-8"?>\
<charlist>\
    <list>\
        <title>symbol1</title>\
        <chr><![CDATA[√,∽, ∝, ∵, ∫, ∬, ∈, ∋, ⊆]]></chr>\
    </list>\
    <list>\
        <title>symbol2</title>\
        <chr><![CDATA[①, ②, ③, ④, ⑤, ⑥, ⑦, ⑧]]></chr>\
    </list>\
    <list>\
        <title>symbol3</title>\
        <chr><![CDATA[㉠, ㉡, ㉢, ㉣, ㉤, ㉥, ㉦, ㉧]]></chr>\
    </list>\
    <list>\
        <title>symbol4</title>\
        <chr><![CDATA[㎕, ㎖, ㎗, ℓ, ㎘, ㏄, ㎣, ㎤]]></chr>\
    </list>\
</charlist>';

var parsed = $.parseXML(xml);

// declare the array
var chr = new Array();

// build the array by looping through the list elements
$(parsed).find('list').each(function(i,listElement){
    chr[i] = listElement.getElementsByTagName('chr')[0].textContent; 
});​

// will give an alert box with the string content of the chr element in the the second list element, which is actually "①, ②, ③, ④, ⑤, ⑥, ⑦, ⑧"
alert(chr[1]); 
```

# c++ - 基于 C++ 文本的 rpg 库存

> ID：12451838
> 
> 赞同：2
> 
> 时间：2012-09-17T00:24:03.367
> 
> 标签：c++, inventory

好的，现在我有一个基于文本的 rpg 的骨架。

你知道通常：健康怪物位置黄金攻击等

但是，我永远无法解决的一件事是类是如何工作的 + 使用多个 .cpp 文件来拆分游戏，这样更容易管理。

我想我的问题是，如何为“随机武器”（如伪随机）创建一个清单 + 有没有人解释如何将多个 .cpp 文件一起使用来保存代码的不同部分。

请记住，我已经阅读了多个描述和操作方法，但大多数要么让我头疼，要么只是鲁比斯，什么也没解释。

如果您愿意，我可以将我的代码复制并粘贴到 paste-bin 中供您查看，因为我知道它总是可以改进和修改的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T03:14:13.427

我觉得你的问题太笼统了。但无论如何我都会提供一个建议。

据推测，作为 RPG，您可以找到许多项目。有些是武器，有些是盔甲，有些有其他价值，有些只是没用。如果我正在接近这个，我可能会选择有一个类来代表它们并调用它`Item`。我什至可以从中派生出类型：`Weapon`, `Armour`, `Trinket`, ...

我也会以某种方式在程序中注册我所有的武器。假设我有一个简单的构造函数......

```
Weapon::Weapon( const char *name, int cost, int minlevel, int damage, int speed ); 
```

现在，这个武器注册表/存储库将是我认为合理的任何类型的容器。它可能只是一个 C 风格的数组 a `vector`，或者它可能是 a`map`或允许名称查找的东西。它甚至可能是你自己创建的一个可以做其他好事的类。所以让我们这样做（在内部你可能只使用 a `vector`）。

启动时，您需要注册所有项目。假设您在注册表中为不同的项目类型保留了单独的列表。所以你可能有一个`Add`武器功能和另一个盔甲功能......

```
void Repository::Add( Weapon &weapon )
{
    weapons.push_back(weapon);
} 
```

你的初始化可能是这样的。

```
Repository repository;   // A global somewhere, maybe...

repository.Add( Weapon( "Plastic Spork", 1, 1, 1, 10 ) );
repository.Add( Weapon( "M. C. Hammer", 5, 5, 5, 15 ) );
repository.Add( Weapon( "Stroustrup", 1000, 100, 0x7fffffff, 1 ) );
// etc... 
```

现在，您的存储库中拥有所有可用的武器（和其他物品）。选择一堆随机武器现在很容易。

```
Weapon Repository::RollWeapon( int minlevel )
{
    //...
} 
```

也就是说，如果我正确理解了您的问题。也许您想要生成具有随机统计数据的武器。有很多方法可以做到这一点，但您可能需要考虑在`Weapon`（或确实`Item`）上有一个函数来随机化/扰乱已注册项目的统计信息。

```
virtual void Item::RandomizeStats(); 
```

此功能的武器版本可能只是采用默认`damage`值并将其更改 +/- 20%。在这种情况下，它可能就像这样简单：

```
virtual void Weapon::RandomizeStats()
{
    int amount = damage / 5;
    damage += (rand() % (amount * 2 + 1)) - amount;
} 
```

您甚至可以将其构建到您的存储库中：

```
Weapon Repository::RollRandomizedWeapon( int minlevel )
{
    Weapon w = RollWeapon( minlevel );
    w.RandomizeStats();
    return w;
} 
```

无论如何，希望此答案中的某些内容对您有用。我个人有一点猜想...

# environment-variables - 如何使用 VMWare VIX api 的 readVariable 从客户机检索环境变量

> ID：12451840
> 
> 赞同：0
> 
> 时间：2012-09-17T00:24:21.140
> 
> 标签：environment-variables, vmware

我想从来宾 VM 中获取环境变量的值。VMWare VIX api 声称在他们的 API 中内置了这个功能

帮助`readVariable`内容如下：

```
Reads a variable from the virtual machine state or guest.
You can get eitherruntime configuration in the .vmx file,
or environment variables in the guest operating system.
The latter requires a valid guest login.
<path to .vmx file>
[ runtimeConfig |
guestEnv ]
<variable name> 
```

例如，获取用户配置文件：

```
vmrun -gu myusername -gp myfakepassword readVariable "C:\VMWare-VMs\myusername\myusername-XPSP3-3.vmx" guestEnv %USERPROFILE% 
```

但是……变量的值去哪儿了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T05:43:26.073

`USERPROFILE`, 不`%USERPROFILE%`, 有效

# javascript - 带参数的 setTimeout

> ID：12451844
> 
> 赞同：15
> 
> 时间：2012-09-17T00:25:28.397
> 
> 标签：javascript

试图解决这个问题时有点头疼。我想要做的是有一个带有参数的自定义 setTimeout ，**而**不必创建一个函数来传递它。让我通过代码来解释：

**想要避免：**

```
function makeTimeout(serial){
  serial.close();
}

setTimeout(makeTimeout(sp.name), 250); 
```

我想要做的就是通过以下方式调用 1 班轮：

```
setTimeout(function(arg1){ .... }(argument_value), 250); 
```

可以这样做还是只能传入无参数函数？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-17T00:27:32.837

您可以向它传递一个匿名函数，该函数`makeTimeout`使用给定的参数调用：

```
setTimeout(function () {
  makeTimeout(sp.name);
}, 250); 
```

还有一种替代方法，使用[`bind`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)：

```
setTimeout(makeTimeout.bind(this, sp.name), 250); 
```

但是，此功能是 ECMAScript 第 5 版功能，尚未在所有主要浏览器中支持。为了兼容性，您可以包含MDN 上提供`bind`的[source](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind#Compatibility)，允许您在本机不支持它的浏览器中使用它。

**[演示](http://jsfiddle.net/BqckR/)**。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-17T01:46:43.690

如果您不想声明单独的函数，可以使用立即调用的函数表达式和闭包，例如

```
// Parameter to use
var bar = 'bar';

// Function to call
function foo(arg) {
  alert(arg);
}

// Go…
setTimeout(
  (function(arg1){
    return function(){
      foo(arg1);
    };
  }(bar)), 2000); 
```

或者，您可以使用函数构造函数：

```
setTimeout( Function('foo(bar)'), 2000); 
```

或者你可以使用一个字符串：

```
setTimeout('foo(bar)', 1000); 
```

这本质上是一回事。现在等待“的嚎叫，*但这就像使用 eval，每个人都知道 eval 是邪恶的，并且是一个巨大的安全漏洞——你所有的长子都注定了！* ”

但严重`eval`的是，（和 Function 构造函数）效率低下并且可能导致惰性编程，因此请使用另一个选项，例如上面的第一个选项。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-23T08:12:05.640

似乎该功能已添加到某些浏览器将参数传递给 setTimeout：

**语法：（** `setTimeout (function (p1,p2) {},1000,p1,p2);` **添加任意数量的参数）**

如果您想确保它在任何地方都能正常工作，您可以使用随附的代码。

**注意：**如果你想在安装后立即设置超时，最好使用回调参数并在那里进行

**例如**

```
installSwizzledTimeout(function(param1,param2){
    setTimeout(myFunc,200,param1,param2);},param1,param2);
} 
```

这是因为它使用一种技巧来检测是否需要它，方法是设置一个非常短的超时并计算参数。

```
window.swizzledSetTimeout = function (fn, ms) {
    if (arguments.length === 2) {
        //console.log("Bypassing swizzledSetTimeout");
        return window.originalSetTimeout(fn, ms);
    } else {
        var args = [];
        for (i = 2; i < arguments.length; i++) {
            args.push(arguments[i])
        };
        //console.log("Setting swizzledSetTimeout for function (",args,") {...} in ",ms," msec");
        var retval = window.originalSetTimeout(function () {
            //console.log("Invoking swizzledSetTimeout for function (",args,") {...}");
            fn.apply(null, args);
        }, ms);
        return retval;
    }
}

function installSwizzledTimeout(cb) {
    var args = [];
    for (i = 1; i < arguments.length; i++) {
        args.push(arguments[i])
    };
    setTimeout(function (arg) {
        //console.log("arguments.length:",arguments.length,window.setTimeout.toString());
        if (arguments.length == 0) {

            function doInstall() {
                //console.log("Installing new setTimeout");
                window.originalSetTimeout = window.setTimeout;
                window.setTimeout = function setTimeout() {
                    return window.swizzledSetTimeout.apply(null, arguments);
                };
                if (cb) {
                    cb.apply(null, args);
                };
            }

            if (window.setTimeout.toString().indexOf("swizzledSetTimeout") < 0) {
                doInstall();
            }
        } else {
            //console.log("existing set time supports arguments ");
            if (cb) {
                cb.apply(null, args);
            };
        }
    }, 0, 1, 2, 3, 4);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-20T22:40:22.137

我有一个需要恒定超时设置的方法，该方法还具有最终执行函数的参数，所以我使用匿名函数执行以下操作：

```
function checkPageLoaded(checker, callback, nextCallTime) {
    return () => {
        let checkoutLoader = document.querySelector(checker);
        if(checkoutLoader === null)
            callback();
        else
            setTimeout(checkPageLoaded(checker, callback, nextCallTime), nextCallTime);
    }
} 
```

然后按如下方式调用它：

```
setTimeout(checkPageLoaded('.loader', reloadPagination, 500), 500); 
```

这样，使用参数执行的所需函数将是定义为匿名函数的函数。

# jquery - jquery：fancybox 缩略图助手，如何指定来源？

> ID：12451846
> 
> 赞同：3
> 
> 时间：2012-09-17T00:25:53.420
> 
> 标签：jquery, fancybox, thumbnails, helper

我正在使用 fancyBox 2，并且我正在使用“缩略图助手”。当我的画廊中有图像时，fancyBox 会自动使用目标图像作为缩略图，但是当我链接到视频（在我的情况下为 Vimeo）时，它不会生成缩略图。我认为只需为fancyBox 指定用于视频链接的图像即可轻松解决此问题，但我不知道该怎么做。

在网站[http://fancyapps.com/fancybox/](http://fancyapps.com/fancybox/)上，它说缩略图助手有一个“源”选项，应该像这样使用它来启用缩略图，并设置源：

```
$(".fancybox").fancybox({
    helpers:  {
        thumbs : {
            source : 'img/~~~.jpg'
        }
    }
}); 
```

但是，这当然行不通，因为我如何指定哪个缩略图用于哪个目标图像或视频？我找不到与视频或自定义缩略图一起使用的缩略图助手的任何工作示例。预先感谢您的任何帮助。

编辑：

“来源”选项被描述为“获取缩略图的 URL 的函数”。我试图弄清楚如何使用它。我在想类似的东西

```
source: item.thum 
```

我在我引用的每个项目中都有一个缩略图源的“thum”属性，例如

```
$.fancybox.open([
    {href : 'image1.jpg', thum : 'thumb1.jpg'},
    {href : 'image2.jpg', thum : 'thumb2.jpg'},
    {href : 'image3.jpg', thum : 'thumb3.jpg'}],
    {helpers : {
        thumbs:{source:this.thum}
    }   }
) 
```

会是这样吗？你能明白我的意思吗？我将如何真正做到这一点？如您所见，我不是 JavaScript 的演讲者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-03T09:26:44.843

对于不同 iframe（vimeo、youtube 等）的不同拇指，我最终这样做了。或多或少是您的原始计划：

```
$.fancybox.open([
  { 
    href : 'photo.jpg',
    thumb : 'photo-thumb.jpg'
  }
], {
    helpers : {
      thumbs : {
        source : function( item ) {
          if (item.thumb) {
            return item.thumb;
          } else {
            return item.href;
          }
        }
      }
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T14:34:16.333

我让它像这样工作：我的函数找到了`href`元素包含 string的所有项目`http://vimeo`，并将整个`href`s 替换为我用于视频的缩略图的 url。

我也必须学习正则表达式才能使其工作。

```
$(".fancybox").fancybox({
    helpers : {
        thumbs : {
            source: function( item ) {
                return item.href.replace(/http:\/\/vimeo.*/gi, 'img/vimeo.jpg');
    },
}); 
```

实际上，我的画廊中的 iFrame 中也有一个 HTML 文件，我也想给它自己的缩略图，所以我的最终产品是：

```
$(".fancybox").fancybox({
    helpers : {
        thumbs : {
            source: function( item ) {
                return item.href.replace(/http:\/\/vimeo.*/gi, 'img/vimeo.jpg')
                .replace(/.*html/gi, 'img/html.jpg');
    },
}); 
```

对于找到此线程并希望在实践中查看此示例的任何人，[这里是指向](http://www.studiogh.com)我使用它的站点的链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-23T06:20:36.337

它应该是这样的

```
$(".fancybox").fancybox({
    helpers:  {
        thumbs : {
          source : function ( item ) {
            return "/url/to/img.ext"; //get the image url for thumbnail
          }
        }
    }
}); 
```

# windows - 如何在运行时将组合框更改为所有者绘制？

> ID：12451847
> 
> 赞同：0
> 
> 时间：2012-09-17T00:25:54.120
> 
> 标签：windows, winapi, visual-c++, gdi+, gdi

我想在运行时将组合框控件更改为所有者绘制。在资源脚本中，控件被布置为标准控件。

我已经尝试将样式位设置为 CBS_OWNERDRAW | CBS_HASSTRINGS 但不知何故这无济于事。

在做子类之前，设置窗口样式..

```
 // turn to ownerdraw
DWORD dwStyle = ::GetWindowLong(hwnd, GWL_STYLE);
dwStyle |= CBS_OWNERDRAWVARIABLE | CBS_HASSTRINGS;
SetWindowLong(hwnd, GWL_STYLE, dwStyle); 
```

有人知道诀窍吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T04:16:16.217

并非所有样式都可以在创建窗口后在运行时成功更改 - 例如，即使它是通过样式控制的，您也无法在运行时将换行多行编辑更改为换行多行编辑；您需要创建一个全新的编辑控件，这就是记事本所做的。我怀疑 ownerdraw 是一种类似的样式，需要在 CreateWindow 时设置，之后可能无法修改。

最好的办法是保存您关心的属性 - 控件 ID、大小和位置 - 以及对话框中之前的 HWND。销毁旧控件并创建一个新的相同替换 - 但具有您想要的样式。您最终会得到一个新的 HWND，因此必须确保您的代码从那时起使用它而不是旧的。如果旧控件在您删除它时具有键盘焦点，您也应该给新控件键盘焦点，这样焦点就不会“消失”。最后，使用 SetWindowPos(hwndPrev...) 将新的 HWND 移动到 Z 顺序中的正确位置，以便基于 Z 顺序的制表符和标签与新窗口的工作方式相同老的。

# vb.net - Visual Basic 将 Excel 工作表导入数据表

> ID：12451849
> 
> 赞同：0
> 
> 时间：2012-09-17T00:26:00.457
> 
> 标签：vb.net, excel, import, datatable, ole

我目前正在处理 Excel 中的大量数据，并且我想将混合数据类型上传到 VB.Net 中的 DataTable（每 30 列 70,000 行）。

我正在使用下一个代码来导入信息：

```
Public Function mc_ExcelTableToDataTable(ByRef ExcelApp As Excel.Application, _
                                          ByVal SheetName As String, _
                                          ByVal TableName As String, _
                                          Optional ByVal FilePath As String = "", _
                                          Optional ByVal SQLsentence As String = "") As DataTable

        Dim vPath As String
        Dim vCloseExcelWorkbook As Boolean = False

        If ExcelApp.ActiveWorkbook IsNot Nothing Then
            vPath = IIf(FilePath = "", ExcelApp.ActiveWorkbook.FullName, FilePath)
        Else
            vPath = FilePath
        End If

        If SQLsentence = "" And ExcelApp.ActiveWorkbook Is Nothing Then
            vCloseExcelWorkbook = True
            ExcelApp.Workbooks.Open(vPath)
        End If

        Dim vRange As String = ExcelApp.Sheets(SheetName).ListObjects(TableName).Range.AddressLocal

        vRange = vRange.Replace("$", "")

        Dim vCNNstring As String = "Provider=Microsoft.ACE.OLEDB.12.0;" & _
                                    "Data Source= " & vPath & ";" & _
                                    "Extended Properties=""Excel 8.0;HDR=YES;IMEX=1"""

        Dim ExcelCNN As System.Data.OleDb.OleDbConnection = New System.Data.OleDb.OleDbConnection(vCNNstring)

        Dim vSQL As String = IIf(SQLsentence = "", _
                                 "SELECT * FROM [" + SheetName + "$" & vRange & "]", _
                                 SQLsentence)

        Dim ExcelCMD As System.Data.OleDb.OleDbDataAdapter = New System.Data.OleDb.OleDbDataAdapter(vSQL, ExcelCNN)

        ExcelCNN.Open()
        Dim ExcelDS As System.Data.DataSet = New DataSet
        ExcelCMD.Fill(ExcelDS)

        mc_ExcelTableToDataTable = ExcelDS.Tables(0).Copy

        ExcelCMD = Nothing
        ExcelCNN.Close()

        ExcelDS.mc_Dispose()

        If vCloseExcelWorkbook Then ExcelApp.ActiveWorkbook.Close(False)

        GCcleaner()
    End Function 
```

但是，VB.Net 给我以下错误：

![呃](../Images/3e4155f03e3136c1b3e2182d02b18e12.png)

有人知道提供者ACE.OLEDB.12.0 的最大容量是多少？或者如何解决这个问题？

仅供参考，这是 SQL 选择语句：

```
SELECT * FROM [Workflow data$A1:AC70276] 
```

值得一提的是，如果我将行数限制为 20000（SELECT * FROM [Workflow data$A1:AC20000]），则该过程可以正常工作！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T01:09:29.873

嗯..听说在某些情况下，ACE.OLEDB.12.0 驱动程序中可能存在一个旧的、工件样式的错误，这样对超过 60000 行的 Excel 电子表格的查询可能会产生类似这样的奇怪错误。 .虽然我自己无法证明这一点，但我不禁想知道如果您将范围大小修改为旧 Excel 中的 ol' 65536 行限制，或者 +/- 说 5%，如果错误会发生离开。它特别好奇你用 20000 行尝试它并且它显然有效。

**编辑**我已经汇总了一些可比较的 C# 代码来测试这个场景，并且只能提供接近这个大小的查询会产生不一致的错误，从“超出系统资源”到挂起到“OutOfMemoryExceptions”。虽然我不能说我已经看到了您的确切错误，但我会说这种行为开始对导入过程征税，因此可能会出现不受欢迎的行为，如果不是不可预测的行为。如果可能的话，我建议将数据分成更小的块。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T03:19:07.720

似乎我找到了问题的解决方案。

基本上我删除了范围。在我使用的当前选择的句子中：

```
SELECT * FROM [Workflow data$A1:AC70276] 
```

我用下一句替换了它：

```
SELECT * FROM [Workflow data$] 
```

# c++ - C++ 内存排序一致性

> ID：12451850
> 
> 赞同：3
> 
> 时间：2012-09-17T00:26:02.063
> 
> 标签：c++, memory, c++11, garbage-collection

假设我有以下代码：

```
void* p0 = nullptr;
void* p1 = alloc_some_data();
void f1() {
    p0 = p1;
    p1 = nullptr;
} 
```

假设`f1`在线程 1 上运行。是否有可能（让代码保持原样）另一个线程可能在某个时候看到`p0`和`p1`（`nullptr`如果编译器或硬件重新排序指令，例如第二个赋值发生在第一个之前）？

我问这个的原因是因为我想实现一个垃圾收集器，我想知道我是否需要使用原子指令（`std::atomic`）从 GC 线程访问指针。如果 GC 线程看到了没有问题，`p0 == p1 == alloc_some_data()`但是如果 GC 线程看到了就会有问题，`p0 == p1 == nullptr`因为当它明显可以访问时，它会将先前在 p1 中的数据报告为不可访问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T00:33:33.240

如果您在一个线程中读取由另一个线程写入而没有同步的对象，那么您将遇到数据竞争。这显然意味着您的垃圾收集器将需要使用某种同步来读取这些值。关于您的原始问题：您的代码中没有任何内容表明写入在写入`p0`之前变得可见`p1`，即，另一个线程确实可以看到两者都为空。这与用于与另一个线程通信的同步原语无关：这两个写入之间没有顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T00:35:53.783

是的。虽然不一定有可能，但完全有可能，因为这些操作不是原子的。

一种（几种可能的情况）是这样的：

```
Thread 2: Get value of p0 (null)

Thread 1: Get value of p1 (non-null)
          p0 = p1
          p1 = nullptr

Thread 2: Get value of p1 (null) 
```

您需要使用某种形式的访问控制（*即*互斥锁）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T00:37:57.177

您的问题的答案是肯定的，但它取决于编译器和 CPU。我认为你还需要制作`p0`和`p1`挥发。要停止重新排序，您可以使用`_mm_sfence`和`_mm_lfence`instrinsics（对于 x86/x64）

# erlang - 代码：哪个（riak_pb_client）。不存在的

> ID：12451852
> 
> 赞同：0
> 
> 时间：2012-09-17T00:26:15.960
> 
> 标签：erlang, riak

在 Erlang shell 中，当尝试测试[erlang-riak-client](https://github.com/basho/riak-erlang-client)时，它显示 riak_pb_client 不存在。我已经在 deps 中列出了 git 源，已发布`rebar get-deps`并且`rebar compile`都成功完成。

```
{deps,
  [
    {eredis, ".*", {git, "https://github.com/wooga/eredis.git", "HEAD"}},
    {jsx, ".*", {git, "https://github.com/talentdeficit/jsx.git", "HEAD"}},
    {riakc, "1.*.*", {git, "https://github.com/basho/riak-erlang-client.git", "HEAD"}}
  ]
}. 
```

我一定是错误地运行了 erl 命令。虽然，从我的项目的根目录，我可以在 deps/riakc 看到库，但`erl -pa ebin/ deps/*/ebin`没有加载库（或者可能只是没有我期望的名称。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T07:28:44.947

我可能错了，但我相信正确的模块名称是`riakc_pb_socket`而不是`riak_pb_client`. 以下应该有效：

```
code:which(riakc_pb_socket). 
```

# java - 在 IDEA 中覆盖 Android 的默认构建脚本？

> ID：12451853
> 
> 赞同：1
> 
> 时间：2012-09-17T00:26:23.547
> 
> 标签：java, android, ant, intellij-idea

我已将 eclipse 项目导入 IDEA 并为 Ant 创建了我的自定义 build.xml。它工作正常，但是当我按“构建项目”时，我希望 IDEA 使用我自己的 build.xml 而不是默认值。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T07:56:41.907

IntelliJ IDEA 默认不使用任何脚本来构建您的 Android 项目。它结合了复杂的增量 Make 系统和 Android 工具，以节省构建项目的时间。

如果您想使用自定义 Ant 脚本构建项目，只需将其添加到 Ant 构建面板并从那里运行所需的目标。

请注意，可以在 IntelliJ IDEA 中为 Ant 构建目标**分配键盘快捷键：**

![分配快捷方式...](../Images/8f36083e806c0e6e3ee6c7321fa6aaf1.png)

# javascript - 如何将事件侦听器添加到 svg 中的对象？

> ID：12451855
> 
> 赞同：22
> 
> 时间：2012-09-17T00:26:35.647
> 
> 标签：javascript, jquery, html, svg

我想创建一个显示交互式 svg 的网页：由于可以使用多个 svg，因此显示的各种对象将具有不同的 ID，因此事件侦听器（例如，捕捉鼠标点击）必须是动态的。

从[这个片段开始](https://stackoverflow.com/questions/2753732/how-to-access-svg-elements-with-javascript/3379830#3379830)

```
var a = document.getElementById("alphasvg");
a.addEventListener("load",function(){
        var svgDoc = a.contentDocument;
        var delta = svgDoc.getElementById("delta");
        delta.addEventListener("click",function(){alert('hello world!')},false);
    },false); 
```

我想找到一种方法来循环遍历 svg 的所有对象（可能具有特定的类）并为它们附加一个均匀的侦听器。

**更新**

所以 JQuery 'each' 函数可能是一个合适的选择，但似乎 JQuery 不能很好地处理 svg DOM。还有其他可用的选项吗？（像一个 JQuery 插件？）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-17T16:12:36.063

这是我使用 vanilla js 向 SVG 元素添加事件侦听器的首选结构......

```
// select elements
var elements = Array.from(document.querySelectorAll('svg .selector'));

// add event listeners
elements.forEach(function(el) {
   el.addEventListener("touchstart", start);
   el.addEventListener("mousedown",  start);
   el.addEventListener("touchmove",  move);
   el.addEventListener("mousemove",  move);
})

// event listener functions

function start(e){
  console.log(e);
  // just an example
}

function move(e){
  console.log(e);
  // just an example
} 
```

您提供的示例代码有些做作，但这是一个使其工作的重写......

```
var a = document.getElementById("alphasvg");
a.addEventListener("load",function(){
  var svgDoc = a.contentDocument;
  var els = svgDoc.querySelectorAll(".myclass");
  for (var i = 0, length = els.length; i < length; i++) {
    els[i].addEventListener("click", 
       function(){ console.log("clicked"); 
    }, false);
  }
},false); 
```

# programming-languages - 具有这些特征的语言

> ID：12451859
> 
> 赞同：0
> 
> 时间：2012-09-17T00:27:24.807
> 
> 标签：programming-languages

我正在寻找一种具有以下功能的编程语言：

1.  一等函数和匿名函数/代码块

2.  混合

3.  标准 OO（至少继承和一些封装，可能是原型之上的类）

4.  写起来很快，但最好是通过更短的关键字/运算符，而不是通过编造很多自己的新概念/糖（显然这里有一些主观性，所以我将其保持开放式）。

并具有强大的库支持：

1.  Web（包括 HTTP、HTML 模板、数据库和资产处理）

2.  依赖注入

3.  单元测试

它还应该能够比 abysmally 更好地进行矩阵操作，无论是作为语言的一部分还是通过库。

我不想开始任何开放式的哲学辩论 :) 我只是在寻找一些符合上述要求的语言。

编辑：我知道 Ruby 很接近，但我正在寻找糖少一点的东西。此外，根据我对符号的了解，它们基本上是猖獗的全球状态，这不是很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T00:30:43.510

不确定矩阵操作有多好（它[确实有](http://corelib.rubyonrails.org/classes/Matrix.html)），但 Ruby（使用 Ruby on Rails 用于 Web 框架）似乎符合您的描述

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T00:40:45.153

**Python：**

> 一等函数和匿名函数/代码块

查看！（用于匿名函数调用的 lambda）

> 混合

您可以从python中的多个类继承

> 标准 OO（至少继承和一些封装，可能是原型之上的类）

查看！

> 写起来很快，但最好是通过更短的关键字/操作符，而不是通过编造很多自己的新概念/糖（显然这里有一些主观性，所以我将其保留为开放式）。

python 编写速度快，易于阅读。我认为语法非常直观。

> Web（包括 HTTP、HTML 模板、数据库和资产处理）

[http://wiki.python.org/moin/WebFrameworks](http://wiki.python.org/moin/WebFrameworks)

> 依赖注入

python在这里可能会落后一点。据我所知，python 没有对应的 Spring，但该语言确实提供了这样做的能力。请参阅[http://wiki.python.org/moin/DependencyInjectionPattern](http://wiki.python.org/moin/DependencyInjectionPattern)

> 单元测试

查看！[http://docs.python.org/library/unittest.html](http://docs.python.org/library/unittest.html)

> 它还应该能够比 abysmally 更好地进行矩阵操作，无论是作为语言的一部分还是通过库。

结帐 numpy 的初学者： http: [//numpy.scipy.org/](http://numpy.scipy.org/)。我认为那里也有更好的解决方案。

# blackberry - BlackBerry OS 6 中的 batteryStatusChange(int status) 函数如何工作？

> ID：12451863
> 
> 赞同：0
> 
> 时间：2012-09-17T00:27:46.197
> 
> 标签：blackberry, java-me

```
public void batteryStatusChange(int status) 
{
    if(DeviceInfo.getBatteryLevel() == 70)
    {
// TODO Auto-generated method stub
        //play a tune that tells the user that yourbattery is at 70%

    }
} 
```

查看文档，状态为“来自 DeviceInfo 的 BSTAT_xxx 掩码的组合”

如果我的电池电量百分比下降，例如71%到70%，即使我不使用status参数，这个函数是否会被SystemListener2接口调用？

如果我想在 BSTAT 中更具体一些，说只在电池电量发生变化时激活函数内部的方法，而不是在检测到任何类型的变化（如热或冷）时激活，然后这段代码：

```
public void batteryStatusChange(int status) 
    {
        if(status == DeviceInfo.BSTAT_LEVEL_CHANGED)
            if(DeviceInfo.getBatteryLevel() == 70)
                {
            //play a tune that tells the user that ur battery is at 70%
        // TODO Auto-generated method stub      
                }
    } 
```

是基本上和第一个代码一样，但是检查到水平变化？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T05:55:00.880

如果`status`是*掩码的***组合**，那么我认为您需要进行此测试，以确定该值是否包含该位。`BSTAT_` *`int``BSTAT_LEVEL_CHANGED`*

 *```
public void batteryStatusChange(int status) 
{
    if ((status & DeviceInfo.BSTAT_LEVEL_CHANGED) != 0)
    {
        if(DeviceInfo.getBatteryLevel() == 70)
        {
            //play a tune that tells the user that ur battery is at 70%
        }
    }
} 
```

或者，我想另一种自己跟踪的方法就是将级别记录为成员变量：

```
private int currentBatteryLevel = -1;

public void batteryStatusChange(int status) 
{
    int newBatteryLevel = DeviceInfo.getBatteryLevel();
    if (currentBatteryLevel != newBatteryLevel) 
    {
        currentBatteryLevel = newBatteryLevel;
        if(DeviceInfo.getBatteryLevel() == 70)
        {
            //play a tune that tells the user that ur battery is at 70%
        }
    }
} 
```*

# angularjs - 如何在 Angular.js 中的 $resource 服务获取数据时引导数据

> ID：12451864
> 
> 赞同：10
> 
> 时间：2012-09-17T00:27:58.020
> 
> 标签：angularjs

我有这个由 UsersController 提供 index.html.erb 的 Rails 应用程序。在处理该页面的角度控制器中，我为用户提供了 $resource 服务

# 咖啡脚本

```
.factory('User', ['$resource', ($resource) ->
  $resource 'api/users/:user_id/:action', {authenticity_token:app.csrf},
    query:
      method: 'GET'
      isArray: yes
    new:
      method: 'GET'
      params:
        user_id: 'new'
    update:
      method: 'PUT'
]) 
```

控制器获取

```
window.app = angular.module("app", ['userServices'])
.config(["$routeProvider", ($routeProvider) ->
  $routeProvider
  .when "/users",
    templateUrl: "assets/templates/users/index.html"
    controller: UserCtrl

  .otherwise redirectTo: "/users"
])

# users Controllers
UserCtrl = ($scope, User) ->
  User.query (r) ->
    $scope.users = r
    # code.. 
```

我认为这是一个很常见的场景，但很明显，仅此页面就需要不止一次访问服务器。我想知道 Angular 是否有办法使用一些引导数据，因为它们是从 $resource 服务中调用的操作返回的数据。

我已经通过使用 Gon ruby​​ gem 将引导数据部分分配给名为 Gon 的全局变量来处理引导数据部分。我知道我可以简单地做 $scope.users = gon.users。但是这些用户模型不会得到像 $scope.users[0].$save() 这样的细节

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-20T21:25:26.180

事实证明，这真的很简单！

例如，假设您将所有非角度模型都放在变量 _tasks 和角度 $resource 模型任务中，您需要做的就是将 _tasks 一个一个地传递给构造函数 Task ，如下所示：

```
$scope.tasks = (new Task(task) for task in _tasks) 
```

然后每个 $scope.tasks 将具有所有这些 $update()、$delete() 方法

```
$scope.tasks[0].$update({due_at: new Date}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T02:34:05.860

您想避免来自 User.query 的往返，对吗？如果是这样，这样的事情怎么样

```
<html>
<script type='text/javascript>
  initialUsers = <%= User.someRubyMethod.to_json %>
<script> 
```

然后在你的控制器里面

```
 $scope.users = intitialUsers; 
```

# eclipse - Github 认证

> ID：12451866
> 
> 赞同：1
> 
> 时间：2012-09-17T00:28:08.427
> 
> 标签：eclipse, git, github, egit, github-for-mac

如果这是一个新手问题，我很抱歉。几个小时以来，我一直在努力尝试在 GitHub 上获得一些项目。

我登录到应用程序：

![在此处输入图像描述](../Images/b191fe22c50f24ff36bb71d124727985.png)

但是每当我尝试推动或拉动时，我都会得到：

![在此处输入图像描述](../Images/5170951535b2188d7d8ebda8f013504e.png)

我最初试图在 Eclipse 上连接，但也遇到了身份验证错误。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T06:28:04.680

确保：

*   您的远程仓库引用远程仓库读写地址[https://github.com/DavidTunnell/delivery-driver-wage-calculator.git](https://github.com/DavidTunnell/delivery-driver-wage-calculator.git)，
*   检查 GitHub 是否在您的 GitHub 管理员 ssh 部分中注册了 ssh 密钥。
    该键应命名为`GitHub for Mac - yourHostname`.
*   不要忘记在“GitHub for Mac”选项部分添加您的 GitHub 用户名和电子邮件。

# mysql - 这个查询有什么问题？

> ID：12451875
> 
> 赞同：-4
> 
> 时间：2012-09-17T00:29:33.990
> 
> 标签：mysql, sql

这个查询：

```
SELECT tbl_deliverable.*, user_to_deliverable.*
where tbl_deliverable.id = user_to_deliverable.d_id 
```

从 phpmyadmin 返回此错误：

> `#1064`- 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以`'where tbl_deliverable.id = user_to_deliverable.d_id'`在第 1 行附近使用正确的语法

为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T00:30:35.927

你没有`FROM`条款。

它应该是

```
SELECT tbl_deliverable.*, user_to_deliverable.* 
FROM tbl_deliverable, user_to_deliverable                -- <== missing
where tbl_deliverable.id = user_to_deliverable.d_id 
```

或执行 ANSI SQL-92

```
SELECT tbl_deliverable.*, user_to_deliverable.* 
FROM tbl_deliverable INNER JOIN user_to_deliverable               
         ON tbl_deliverable.id = user_to_deliverable.d_id 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T00:30:31.183

您在 SQL 中忘记了“来自表”：

```
SELECT tbl_deliverable.*,   user_to_deliverable.*
from   tbl_deliverable,     user_to_deliverable
where  tbl_deliverable.id = user_to_deliverable.d_id 
```

只需添加：

```
from tbl_deliverable, user_to_deliverable 
```

# javascript - 如何避免具有递增功能的全局变量？

> ID：12451877
> 
> 赞同：0
> 
> 时间：2012-09-17T00:29:54.553
> 
> 标签：javascript

这是我的自动执行功能：

```
var incrementInt = (function() {
    var manyOut = 10;

    if(incInt) {
        incInt+=manyOut;
    } else {
        var incInt = 0;
    }

    return {
        s: incInt,
        m: manyOut
    };
})(); 
```

我将变量 incInt 和 manyOut 私有化，并将变量 incrementInt 绑定到返回的对象。

我的目标是创建一个函数，该函数返回一个对象，其中一个属性是一个整数，每次调用时都会递增。我希望递增变量具有最窄的范围。

我对上述解决方案的问题是每次调用函数时都会重新初始化变量 incInt 。由于其在函数内的作用域，该变量会自动销毁。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T00:33:10.807

你可以像这样创建和对象

```
function incr () {
  var i = 0;

  this.inc = function() {
    i++;
  }
}

var incrInt = new incr();

// somewhere in you code
incrInt.inc(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T00:34:27.317

```
var f = function() { var c=0; return function() { return c++; }} ()
> f()
0
> f()
1
> f()
2 
```

基本上，利用 Javascript 使用函数创建作用域和闭包来捕获局部变量的能力。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T00:38:09.020

您需要使用方法来添加和获取变量`incInt`。

```
var incrementInt = (function() {
    var manyOut = 10,
        incInt = 0;

    return {
        add: function() {
            return incInt += manyOut;
        },
        getInt: function() {
            return incInt;
        }
    };

})();

var a = incrementInt;

a.add();
a.add();

a.getInt(); // 20​​​​​​ 
```

# mysql - mysql选择数组中的位置

> ID：12451878
> 
> 赞同：1
> 
> 时间：2012-09-17T00:30:00.300
> 
> 标签：mysql, sql, select

我正在做一个带有多个键盘或标签的表格，如下所示：

```
id |   keyboards
===+================================================
1  |     picture,mountain,animals 
2  |     water,mountain
3  |     sound, mountain
4  |     water, picture, mountain, space, other 
```

我想做一个选择。

**SELECT id from table where (mountain,picture,space) in keyboards** ;

结果必须是：1 行

ID

> 4.

请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T00:41:01.063

您的数据库规范化很差。最好的方法是创建一个表`Keyboards`

```
CREATE TABLE Keyboards
(
    Keyboard_ID INT AUTO_INCREMENT,
    KeyBoardName VARCHAR(25),
    CONSTRAINT kbrd_pk PRIMARY KEY (Keyboard_ID),
    CONSTRAINT kbrd_uq UNIQUE(KeyboardName)
)

CREATE table Tags
(
    ID INT AUTO_INCREMENT,
    Keyboard_ID int,
    CONSTRAINT tags_pk PRIMARY KEY (ID),
    CONSTRAINT tags_pk FOREIGN KEY (keyboard_ID) REFERENCES keyboards(keyboard_ID)
) 
```

然后`keyboards.id`在`tags`表中引用。

然后你可以做这个查询，

```
SELECT id,
FROM   tags a
       INNER JOIN keyboards b
           ON a.keyboard_id = b.keyboard_ID
WHERE  b.keyboardName IN ('mountain','picture','space')
GROUP BY ID
HAVING COUNT(DISTINCT b.keyboardName) = 3 
```

但要回答你的问题，你可以简单地这样做

```
select *
from tags
where keyboards like concat('%','mountain','%') AND
      keyboards like concat('%','picture','%') and
      keyboards like concat('%','space','%') 
```

# [*SQLFiddle 演示*](http://sqlfiddle.com/#!2/21233/1)

# java - 每 30 秒后以 10 米的距离获取当前位置（位置更新）的有效方法

> ID：12451880
> 
> 赞同：-1
> 
> 时间：2012-09-17T00:30:23.577
> 
> 标签：java, android, location

我有下面的代码，它得到了`Most Recent location`之后的 every`30 seconds`和`10 meters`，但它会不断地接收位置更新，并且每 30 秒后它会获取最新的位置更新。

有没有更好/有效的方法来做到这一点？

基本上我的要求是`Current Location`每 30 秒和`10 meters distance moved`. 我可以通过多种方式做到这一点，我在想有没有更好的方法来解决这个问题？那么 Timer 类呢？

任何想法都会有很大帮助。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);    

    locationListener = new GPSLocationListener();

    locationManager.requestLocationUpdates(
            LocationManager.GPS_PROVIDER, 
            30000, 
            10, 
            locationListener);

} 
```

下面是实现的类`LocationListener`。

```
private class GPSLocationListener implements LocationListener {
    @Override
    public void onLocationChanged(Location location) {
        if (location != null) {
            GeoPoint point = new GeoPoint(
                    (int) (location.getLatitude() * 1E6), 
                    (int) (location.getLongitude() * 1E6));
        System.out.println(location.getLatitude()+"--"+location.getLongitude());

        }
    }

    @Override
    public void onProviderDisabled(String provider) {
    }

    @Override
    public void onProviderEnabled(String provider) {
    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T04:57:23.260

Techgeeky, not sure what you exactly want. But what you have is exactly what you describe you want, that is to get a nupdate every 30 sec if you've moved 10 meters. The OS will let the GPS chip sleep for 30 seconds and once woken up, if you've moved 10 meters, it'll give an update. What you have should work perfectly so what exactly is the issue? I've written multiple apps that use the location listener and waking up every 30 seconds is reasonable for sure to get an update.

# javascript - 使用浮点数了解 javascript 中的 switch/case 用法

> ID：12451885
> 
> 赞同：-6
> 
> 时间：2012-09-17T00:30:44.883
> 
> 标签：javascript, google-maps, switch-statement

我写了这段代码，但有一个我无法弄清楚的问题：

我有一个包含 6 个浮点数的列表，但程序不会停止，`case=6`因此出现错误

```
@model IList<float>
@{ Layout = "~/Views/Shared/_Lay2.cshtml";
var culture = System.Globalization.CultureInfo.GetCultureInfo("en-US");}
<body  onload="initialize(@Model.Count.ToString(culture)">
  <table style="width: 100%; height: 70%">
    <tr>
      <td style="width: 100%">
        <div id="map_canvas" style="width: 100%; height: 500px;"></div>
      </td>
    </tr>
  </table>

  <script src="@Url.Content("~/Scripts/jquery-1.4.4.min.js")" type="text/javascript"></script>
  <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
  <script type="text/javascript">
    function initialize(a) {

        var myLatLng = new google.maps.LatLng(@Model[0].ToString(culture), @Model[1].ToString(culture));
        var nextpoint = new google.maps.LatLng(@Model[2].ToString(culture), @Model[3].ToString(culture));
        var myOptions = {
            zoom: 8,
            center: myLatLng,
            mapTypeId: google.maps.MapTypeId.TERRAIN
        };
        var map = new google.maps.Map(document.getElementById("map_canvas"),
        myOptions);
        var flightPlanCoordinates = [
        new google.maps.LatLng(@Model[0].ToString(culture), @Model[1].ToString(culture)),
        new google.maps.LatLng(@Model[2].ToString(culture), @Model[3].ToString(culture)),

        ];
        var flightmarker1 = new google.maps.Marker({
            position: new google.maps.LatLng(@Model[0].ToString(culture), @Model[1].ToString(culture)),
            map: map,
            title: " denden"
        });
        var flightmarker2 = new google.maps.Marker({
            position: new google.maps.LatLng(@Model[2].ToString(culture), @Model[3].ToString(culture)),
            map: map,
            title: " denden"
        });

        var flightPath = new google.maps.Polyline({
            path: flightPlanCoordinates,
            strokeColor: "#FF0000",
            strokeOpacity: 1.0,
            strokeWeight: 2
        });
        flightPath.setMap(map);
        switch (a) {
        case 6:
            var flightPlanCoordinates = [
            new google.maps.LatLng(@Model[2].ToString(culture), @Model[3].ToString(culture)),
            new google.maps.LatLng(@Model[4].ToString(culture), @Model[5].ToString(culture)),

            ];
            var flightmarker1 = new google.maps.Marker({
                position: new google.maps.LatLng(@Model[2].ToString(culture), @Model[3].ToString(culture)),
                map: map,
                title: " denden"
            });
            var flightmarker2 = new google.maps.Marker({
                position: new google.maps.LatLng(@Model[4].ToString(culture), @Model[5].ToString(culture)),
                map: map,
                title: " denden"
            });

            var flightPath = new google.maps.Polyline({
                path: flightPlanCoordinates,
                strokeColor: "#FF0000",
                strokeOpacity: 1.0,
                strokeWeight: 2
            });
            flightPath.setMap(map);
            alert(a);
            break;
        case 8:
            var flightPlanCoordinates = [
            new google.maps.LatLng(@Model[2].ToString(culture), @Model[3].ToString(culture)),
            new google.maps.LatLng(@Model[4].ToString(culture), @Model[5].ToString(culture)),
            new google.maps.LatLng(@Model[6].ToString(culture), @Model[7].ToString(culture))];
            var flightmarker1 = new google.maps.Marker({
                position: new google.maps.LatLng(@Model[2].ToString(culture), @Model[3].ToString(culture)),
                map: map,
                title: " denden"
            });
            var flightmarker2 = new google.maps.Marker({
                position: new google.maps.LatLng(@Model[4].ToString(culture), @Model[5].ToString(culture)),
                map: map,
                title: " denden"
            });
            var flightmarker2 = new google.maps.Marker({
                position: new google.maps.LatLng(@Model[6].ToString(culture), @Model[7].ToString(culture)),
                map: map,
                title: " denden"
            });
            var flightPath = new google.maps.Polyline({
                path: flightPlanCoordinates,
                strokeColor: "#FF0000",
                strokeOpacity: 1.0,
                strokeWeight: 2
            });
            flightPath.setMap(map);
            break;
            alert(a);
        case 10:
            var flightPlanCoordinates = [
            new google.maps.LatLng(@Model[2].ToString(culture), @Model[3].ToString(culture)),
            new google.maps.LatLng(@Model[4].ToString(culture), @Model[5].ToString(culture)),
            new google.maps.LatLng(@Model[6].ToString(culture), @Model[7].ToString(culture)),
            new google.maps.LatLng(@Model[8].ToString(culture), @Model[9].ToString(culture))];
            var flightmarker1 = new google.maps.Marker({
                position: new google.maps.LatLng(@Model[2].ToString(culture), @Model[3].ToString(culture)),
                map: map,
                title: " denden"
            });
            var flightmarker2 = new google.maps.Marker({
                position: new google.maps.LatLng(@Model[4].ToString(culture), @Model[5].ToString(culture)),
                map: map,
                title: " denden"
            });
            var flightmarker2 = new google.maps.Marker({
                position: new google.maps.LatLng(@Model[6].ToString(culture), @Model[7].ToString(culture)),
                map: map,
                title: " denden"
            });
            var flightmarker2 = new google.maps.Marker({
                position: new google.maps.LatLng(@Model[8].ToString(culture), @Model[9].ToString(culture)),
                map: map,
                title: " denden"
            });
            var flightPath = new google.maps.Polyline({
                path: flightPlanCoordinates,
                strokeColor: "#FF0000",
                strokeOpacity: 1.0,
                strokeWeight: 2
            });
            flightPath.setMap(map);
            break;

        }

    }
  </script>

</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T00:40:21.467

不确定这是否是整个问题，您的身体标签上缺少一个右括号：

```
<body  onload="initialize(@Model.Count.ToString(culture))">  
// missing the second parens after culture. 
```

# php - .htaccess 用于具有多个变量的友好 URL

> ID：12451886
> 
> 赞同：3
> 
> 时间：2012-09-17T00:30:53.320
> 
> 标签：php, .htaccess, mod-rewrite, url-rewriting

我正在努力使我的网站对我目前使用的 SEO 更友好

```
RewriteEngine On
RewriteRule (.*)$ index.php?page=$1 
```

变成`site.co.uk/index.php?page=page_name`_`site.co.uk/page_name`

我也想将它用于子页面。我试过这个：

```
RewriteEngine On
RewriteRule (.*)/(.*)$ index.php?page=$1&subpage=$2 
```

但它不工作，它运行`site.co.uk/page_name/sub_page`但当你去`site.co.uk/page_name`它返回 404 未找到。

我希望它运行`site.co.uk/page_name`并返回`page_name`

或者

`site.co.uk/page_name/sub_page`并返回`sub_page`

等等

`site.co.uk/page_name/sub_page/sub_page2/...`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T00:40:50.613

仅使用：

```
RewriteEngine On
Options -Indexes
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php?page=$1 [L,QSA] 
```

很好，那么您可以在脚本中路由请求。

您使用 explode() 分隔符 / 拆分页面变量，然后设置变量。

```
$route = explode('/',$_GET['page']);

$page    = isset($route[0]) ? $route[0] : null;
$subpage = isset($route[1]) ? $route[1] : null;
$yada    = isset($route[2]) ? $route[2] : null; 
```

许多 MVC 框架使用这种方法。它称为路由。

# silverstripe - Silverstripe - 在小部件中获取 SiteConfig 值

> ID：12451887
> 
> 赞同：1
> 
> 时间：2012-09-17T00:30:55.727
> 
> 标签：silverstripe

我正在尝试通过以下方式访问我的小部件类中的 siteconfig 值：

```
<?php
class FacebookFeedWidget extends Widget{
    static $title = "";
    static $cmsTitle = "Facebook Feed Widget";
    static $description = "This widget shows the Facebook feed";
    static $doSiteConfig = DataObject::get_one('SiteConfig'); 

    static $db = array(
        "FacebookURL" => "Text"
    );

    static $defaults = array(
        "FacebookURL" => $doSiteConfig->FacebookURL
    );

    function getCMSFields(){
        return new FieldList(
            new TextField("FacebookURL", "Facebook URL")
        );
    }

    function getFacebookURL(){
        $output = new ArrayList();
        $output->push(
            new ArrayData(
                array(
                    "FacebookURL" => $this->FacebookURL
                )
            )
        );
        return $output;
    }
} 
```

但我得到一个错误：解析错误：语法错误，意外'（'，期待'，'或';'在/....../widgets_facebookFeed/FacebookFeedWidget.php第8行

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-22T13:01:13.213

你不能做这样的事情：

```
static $defaults = array(
    "FacebookURL" => $doSiteConfig->FacebookURL
); 
```

但幸运的是，有一个函数 polulateDefaults，它接受 $defaults 并将其设置为对象，所以我们可以挂钩：

```
public function populateDefaults() {
    parent::populateDefaults();
    $this->FacebookURL = SiteConfig::current_site_config()->FacebookURL;
} 
```

# algorithm - 执行 nm 操作的算法的大 O 是多少，其中 m 是迭代次数？

> ID：12451894
> 
> 赞同：1
> 
> 时间：2012-09-17T00:32:56.563
> 
> 标签：algorithm, big-o

我写了一个算法来查找未排序列表中的重复项。它在每次迭代中执行 n - m 次操作，其中 m 是迭代次数，n 是输入列表的大小。它的大O是多少？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T00:37:46.633

O(n^2)。这里的工作是`n+(n-1)+(n-2)+...+1 = n(n+1)/2`。

一种更直观的看待它的方式是，您至少`n/2`为至少`n/2`迭代工作，所以您至少`n^2/4`工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T00:38:19.283

```
 (n - m) + (n - m - 1) + (n - m - 2) + ... + (n - m - m)
= (n * m) + m + (m - 1) + (m - 2) .. - (m - m)     # Group the `n`s
= (n * m) + (1 + 2 + .. + m)                       # Carefully reverse this sum
= (n * m) + 0.5 * m * (m + 1)                      # sum(1...n) = n(n+1)/2 
```

`m`范围应为`0`至`n`，因此：

```
= (n * n) + 0.5 * n * n + 0.5 * n                  # Just substitute `n` for `m`
= 3/2 * n^2 + 0.5 * n                              # Combine the `n^2` terms
-> 3/2 * n^2                                       # n^2 >> n for large enough n
=> n^2                                             # Drop the constant 
```

我可能这样做有点过于冗长了。

# xml - 在 Go 中使用嵌套 XML-RPC 解组组

> ID：12451898
> 
> 赞同：2
> 
> 时间：2012-09-17T00:33:24.113
> 
> 标签：xml, go, xml-rpc, unmarshalling

我正在使用 Webfaction API 并尝试解组他们的响应以获取会话 ID（下面的 12345abcde...）。

嵌套在多个字段（即 params>param）下时如何访问特定值？

以下代码位于[http://play.golang.org/p/krG4_fXVka](http://play.golang.org/p/krG4_fXVka)

```
package main

import ("encoding/xml"
        "fmt"
        )

type Result struct {
        XMLName xml.Name `xml:"methodResponse"`
        Values []string `xml:"params>param>value"`
}

func main() {
data := `
    <methodResponse>
<params>
    <param>
        <value><array><data>
            <value><string>12345abcde12345abcde12345</string></value>
            <value><struct>
                <member>
                    <name>username</name>
                    <value><string>trex</string></value>
                </member>
                <member>
                    <name>home</name>
                    <value><string>/home</string></value>
                </member>
                <member>
                    <name>mail_server</name>
                    <value><string>Mailbox1</string></value>
                </member>
                <member>
                    <name>web_server</name>
                    <value><string>Web12</string></value>
                </member>
                <member>
                    <name>id</name>
                    <value><int>1234</int></value>
                </member>
            </struct></value>
        </data></array></value>
    </param>
</params> 
```

`

```
v := Result{}
err := xml.Unmarshal([]byte(data), &v)
if err != nil {
fmt.Printf("error: %v", err)
        return
}
fmt.Printf("XMLName: %#v\n", v.XMLName)
fmt.Printf("Values: %#v\n", v.Values)

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T03:10:45.023

不是 100% 清楚您要做什么，但这似乎可以更好地分解它？

```
type Member struct {
    Name string `xml:"name"`
    Value string `xml:"value>string"`
}

type Result struct {
        XMLName xml.Name `xml:"methodResponse"`
        FirstValue string `xml:"params>param>value>array>data>value>string"`
        Members []Member `xml:"params>param>value>array>data>value>struct>member"`
} 
```

请注意，您的解析结构具有相当疯狂的深度。可能有助于通过漂亮的打印机运行 XML，该打印机将其格式化以供您使用缩进查看。

# c - 从 Zip 存档中读取

> ID：12451901
> 
> 赞同：-1
> 
> 时间：2012-09-17T00:33:48.683
> 
> 标签：c, file, zip, zlib

在使用**zlib 1.2.7**和**minizip**读取 zip 档案时，我发现它只能读入字节缓冲区。我将这些数据传递给另一个库进行处理，但是这个库要求数据采用`FILE*`.

我可以`FILE*`在内存中使用字节缓冲区创建一个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T00:41:29.593

为什么这个问题使用 C++ 标签？C 的源和目的地是不可扩展的。因此，您需要依赖特定于平台的扩展。在 C++ 中，您可以创建合适的流缓冲区以将内容插入 IOStreams。但是，.zip 存档是存档而不是平面文件，也就是说，您需要考虑如何具体说明您实际要提取的对象。不过，这仍然是可行的。

# mysql - MySQL 获取 2 个日期的差异...1 个检索和 1 个硬编码

> ID：12451902
> 
> 赞同：1
> 
> 时间：2012-09-17T00:34:24.643
> 
> 标签：mysql, datediff

对不起，很难用一行来解释我的问题。

这是我当前在 MySQL 中的查询：

```
SELECT purch_id AS PURCH_ID, 
DATEDIFF(CURDATE(),(purch_date)) AS PURCH_DATE 
FROM CS260USER.candy_purchase; 
```

例如，其中一个 purch_date 条目是 10-28-2004 我真正想要得到的实际上是 (10-28-2004) 和 2012 年圣诞节之间的差异。（是的，这是为了一个家庭作业，我对圣诞节不是很感兴趣，但是教授是：P）

好的，所以我试图做的是这样的：

```
SELECT purch_id AS PURCH_ID, 
DATEDIFF('12-25-2012',(purch_date)) AS PURCH_DATE 
FROM CS260USER.candy_purchase; 
```

但它不喜欢那样。

作业的全部部分是在“12-25”部分编码，然后检索当前年份，这样如果您在 2013 年再次尝试，它适用于 2013 年 12 月 15 日。

那有意义吗？需要检索表中的数据，并找出该数据与当年圣诞节之间的差异。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T00:37:23.470

MySQL 日期采用 ISO 格式：`YYYY-MM-DD`

如果您执行以下操作，这将是显而易见的：`SELECT CURDATE();`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T00:39:39.987

```
select datediff(concat(year(now()),'-12-25'), purchase_date) 
```

# wordpress - 如何防止 Wordpress 在帖子标题中将 & 更改为 html (&)

> ID：12451904
> 
> 赞同：1
> 
> 时间：2012-09-17T00:34:32.930
> 
> 标签：wordpress

我正在使用自定义帖子类型来跟踪联系人。因此，帖子标题将类似于 John & Jane Jackson。

当我保存帖子时，帖子标题中的 & 变为 & amp; （即：John & amp; Jackson） - 如果我在前端使用标题，这会很好，但我将这些联系人数据提取到 Wordpress 之外并将其用于打印材料。所以，我希望 & 保持为 & 而不是更改为 html 版本。

任何人都知道如何强制 Wordpress 保留在标题字段中输入的任何文本而不将其更改为 hmtl？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T06:52:08.077

以 HTML 模式而不是 VISUAL 模式添加您的内容，然后一切都会好起来的。请看下面的快照...![在此处输入图像描述](../Images/a217b2c3e26fd0eeeaafd056a8cbfeab.png)

# parsing - Haskell 中 JSON 解析期间的重载解析

> ID：12451906
> 
> 赞同：1
> 
> 时间：2012-09-17T00:34:39.237
> 
> 标签：parsing, haskell, overloading, typeclass

我正在阅读“Real World Haskell”（好书），我对编译器如何选择重载函数有些困惑。

如果我有一个类型类

```
type JSONError = String

class JSON a where
    toJValue :: a -> JValue
    fromJValue :: JValue -> Either JSONError a 
```

和两个这样的例子

```
instance JSON Bool where
    toJValue = JBool
    fromJValue (JBool b) = Right b
    fromJValue _ = Left "not a JSON boolean" 
```

和

```
instance JSON String where
    toJValue = JString
    fromJValue (JString s) = Right s
    fromJValue _ = Left "not a JSON string" 
```

例如，给定一个整数，编译器如何在两个“fromJValue”函数之间进行选择？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T01:04:14.807

如果您将`fromJValue someValue`其用作某些表达式的一部分，Haskell 会选择表达式所需的类型。因此，例如，如果您这样做：

```
case fromJValue someValue of 
    Right str -> putStr str
    Left _ -> error 
```

选择的实例`JSON String`是因为`putStr`需要一个字符串。

在无法明确确定所需类型的情况下，您将收到“模糊类型变量”错误，并且必须添加类型注释以手动选择要使用的实例。

请注意，与哪种`JValue` `someValue`包含完全无关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T04:56:32.843

在 OO 语言中，如果您返回一个对象，则虚拟方法表将与它一起*返回。*在 Haskell 中，如果您返回类型类的成员，则字典作为隐藏参数*传入。*

所以在运行时没有问题 - 隐藏字典参数就像 VTable 一样使用来获取实现。

现在你的问题变成了编译器最初是如何选择实例的。

看看怎么`fromJValue`用。

您从包含 JSON 数据的字符串开始，并将其传递给解析函数：

```
foo :: String
foo = parseJsonString x 
```

现在编译器知道它必须`instance JSON String`沿着调用链传递字典。

`parseJsonString`（我不记得正确的名称）将您的字符串解析为 JSON 数据类型。就像是

```
data ParsedJSON = JBool Bool | JString string | JObject ...

parseJsonString :: JSON a => String -> Either JSONError a 
```

首先，它尝试将传递的字符串转换为`ParsedJSON`数据结构。

其次，它将结构和字典传递给它`fromJValue`。

现在 if `x`is `"{ foo : 222 }"`，实例仍然是 for `String`，所以`Left`会调用 branch 并且解析器会说“不是 JSON 字符串”。

另一个小点 - 在生产中你应该使用`return`and `throwError`from`MonadError`而不是`Left`and`Right`让你的意图更清晰。但我认为这只是一个教程代码。

# vb.net - SQLite Transaction 在事务提交之前填充表

> ID：12451907
> 
> 赞同：0
> 
> 时间：2012-09-17T00:34:42.887
> 
> 标签：vb.net, sqlite

我有一个从 select SQL 语句创建数据表（在内存中）的代码。但是我意识到这个数据表是在过程中填充的，而不是由于事务提交语句的结果，它可以完成这项工作，但速度很慢。我究竟做错了什么 ？

```
 Inalready.Clear() 'clears a dictionary
        Using connection As New SQLite.SQLiteConnection(conectionString)
            connection.Open()
            Dim sqliteTran As SQLite.SQLiteTransaction = connection.BeginTransaction()
            Try
                oMainQueryR = "SELECT * FROM detailstable  Where name= :name AND Breed= :Breed"
                Dim cmdSQLite As SQLite.SQLiteCommand = connection.CreateCommand()

                Dim oAdapter As New SQLite.SQLiteDataAdapter(cmdSQLite)

                With cmdSQLite
                    .CommandType = CommandType.Text
                    .CommandText = oMainQueryR
                    .Parameters.Add(":name", SqlDbType.VarChar)
                    .Parameters.Add(":Breed", SqlDbType.VarChar)
                End With

                Dim c As Long = 0
                For Each row As DataRow In list.Rows 'this is the list with 500 names

                    If Inalready.ContainsKey(row.Item("name")) Then
                    Else
                        c = c + 1
                        Form1.TextBox1.Text = " Fill .... " & c
                        Application.DoEvents()

                        Inalready.Add(row.Item("name"), row.Item("Breed"))

                        cmdSQLite.Parameters(":name").Value = row.Item("name")
                        cmdSQLite.Parameters(":Breed").Value = row.Item("Breed")
                        oAdapter.Fill(newdetailstable)
                    End If

                Next

                oAdapter.FillSchema(newdetailstable, SchemaType.Source)

                Dim z = newdetailstable.Rows.Count 
```

'此时newdetailstable已经填满了，我什至还没有提交交易

```
 '  sqliteTran.Commit()

            Catch ex As Exception
            End Try
        End Using 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T07:26:24.357

事务防止其他用户（即连接）所做的更改；您自己的应用程序所做的任何更改都是立即可见的。

因此，对于内存数据库，除非您需要回滚，否则事务没有用处。

# php - 在 OS X Mountain Lion 上切换 PHP 版本

> ID：12451910
> 
> 赞同：7
> 
> 时间：2012-09-17T00:35:21.717
> 
> 标签：php, macos, osx-mountain-lion

是否可以在 OS X Mountain Lion 上安装多个版本的 PHP 并在它们之间自由切换？类似于 MAMP 允许的方式。我想停止使用 MAMP，这确实是唯一让我退缩的功能。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-18T09:45:14.040

即使我可能会对此答案投反对票，但我认为我必须为了 OP 的利益而发布它。

当然有一种方法可以实现你想要的，但你会浪费很多时间。

我经常在我的 OSX 机器上开发 Web 应用程序并猜猜是什么……我使用**Debian 虚拟机**在 Web服务器上测试它们。它更容易、更快、更整洁。我不需要 MacPorts 来安装四个不同版本的 PHP，我可以`pecl`用一个简单的命令来测试编译它们的所有扩展。我可以在虚拟机控制台中只用几条命令模拟任何可能的 Linux 服务器环境，而无需破解源代码以使其在 OSX 下工作，也不会搞砸任何事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T22:34:40.977

对于任何想要使用 Homebrew 的人：成功安装不同版本的 php（或任何程序版本）后，可以从命令行在它们之间切换：

```
brew unlink php53 && brew link php54 
```

更多提示： [https ://github.com/mxcl/homebrew/wiki/Tips-N%27-Tricks](https://github.com/mxcl/homebrew/wiki/Tips-N%27-Tricks)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-18T08:03:00.413

[这是一篇关于使用 MacPorts 维护两个版本的 PHP](http://mark-story.com/posts/view/maintaining-two-versions-of-php-with-macports)的精彩博客文章。应该足以满足您的需求。

# php - 计算百分比

> ID：12451912
> 
> 赞同：0
> 
> 时间：2012-09-17T00:35:48.707
> 
> 标签：php, mysql

我有一个 PHP/MySQL 排行榜，按百分比降序显示用户。我计算百分比：

```
$percentage = ($correct / $total) * 100 
```

我的问题是如何考虑尝试次数（风险），以便假设 100% 中 1 分的用户不高于 93.8% 中 80 分中 75 分的用户

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T00:41:22.500

这只是您订购结果的方式的一部分

```
SELECT (correct / $total) * 100 AS percent FROM table ORDER BY percent DESC, attempts ASC; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T00:46:45.843

取决于风险因素应该有多大的影响！只是在这里猜测，但我相信不除以总数会导致数字太大，因此可以实施各种解决方案，一些建议可能是将结果乘以 (1 + ($total / 100)) 或进一步减少影响您可以乘以 (1 + (sqrt($total) / 100)) 的每次新尝试 - 尝试其他值，100 仅用作示例或其他非线性函数，如 log。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T00:47:01.860

计算平均用户拥有的百分比，并为每个用户提供 10 次平均尝试的基线（对于 10 的某个值）。

假设平均值为 50%。然后你会计算`$percentage = ($correct+5)/($total+10)*100`. 始终表现良好的用户最终仍会脱颖而出（因为他们的成功将超过您开始使用他们的平均分数，但起步良好的用户不会跳到顶部）。

例如，在此系统下，您的第一个用户现在的得分为 ，`6/11 = 54%`而您的第二个用户的得分为`80 / 90 = 88%`.

# tsql - 应用程序为存储过程中的参数赋值，在水晶报表中使用

> ID：12451916
> 
> 赞同：1
> 
> 时间：2012-09-17T00:36:32.427
> 
> 标签：tsql, crystal-reports, parameter-passing, crystal-reports-xi

我有一个具有嵌入式 Crystal Reports 查看器的自定义应用程序。有问题的 RPT 文件调用存储过程。存储过程有一个参数“ **UserID** ”。

我想配置报告，以便它可以从应用程序接收**用户 ID的值。**

现在，当我在 CR11.5 中预览报告时，它会提示我输入**UserID**的值。相反，我希望自定义应用程序为我执行此操作，以便在运行报告时不会出现“**输入值”框。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T19:53:10.733

非常简单的解决方案。如果应用程序已被操纵以将值传递给特定参数，您所要做的就是在 RPT 文件中创建一个参数并为其命名：

1.  在**字段资源管理器**中右键单击**参数字段**
***   新的*   命名参数*   点击确定*   该报告现在应该在测试环境中按照您的需要运行。**

# perl - 在 perl 中传递命令行参数

> ID：12451929
> 
> 赞同：3
> 
> 时间：2012-09-17T00:38:40.783
> 
> 标签：perl, command-line-arguments

我在分配参数值/命令行参数时遇到了麻烦。这是我真正想做的。

```
Test.pl
#!/usr/bin/perl

#Variable declaration

$RUN_DIR="/home/ckhau/database/experiment/test";
    #Main program

$index=-999; 
#my $ARGV;
@files = <$RUN_DIR/b*.txt>;

foreach $file (@files)
{
 #$SCRIPT="perl abcdinfo.pl $file";
 $SCRIPT="perl abc.pl $file";
 system("$SCRIPT");       
} 
```

我尝试用 @ARGV 替换 b*.txt 并尝试运行程序，即当我将上面的代码替换为

```
@files = <$RUN_DIR/@ARGV>; 
```

然后尝试使用命令行运行

```
perl Test.pl b*.txt 
```

这给了我一个错误 perl: no match。任何人都可以在以下方面帮助我。

如何为此使用命令行参数？？？

我可以在命令行“b*.txt”或“r_*.txt”中使用这些语法吗？？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T01:57:27.790

shell 正在尝试扩展`b*.txt`到当前目录中的匹配文件列表。一旦你的程序收到这些值，你的`glob`样子

```
@files = </home/ckhau/database/experiment/test/b1.txt b3.txt b3.txt> 
```

这不是您想要的，如果`b1.txt`您的`$RUN_DIR`目录中没有文件，将无法找到任何文件

To prevent the shell globbing a wildcard file pattern you just need to put it in quotes, so your command becomes

```
perl Test.pl 'b*.txt' 
```

Beyond that, your program really needs improving. You should *always* `use strict` and `use warnings` at the head of all your programs, and declare every variable at its point of first use; you should really use just the first element of `@ARGV` as your file pattern, instead of the whole array; and it is wrong to put scalar variables in quotes when you simply want their contents

Take a look at this refactoring of your original

```
#!/usr/bin/perl

use strict;
use warnings;

my $run_dir="/home/ckhau/database/experiment/test";

my $pattern = "$run_dir/$ARGV[0]";

my $index = -999; 
my @files = glob $pattern;

foreach my $file (@files) {
  my $script = "perl abc.pl '$file'";
  system $script;
} 
```

**Update**

If you *really* want to have multiple wildcard patterns as parameters to `Test.pl` then you must patch the `$run_dir` directory onto the beginning of each of them. The best way to do this is to employ the [`File::Spec`](https://metacpan.org/module/File%3a%3aSpec) module's `rel2abs` function. The complete script would look like this

```
#!/usr/bin/perl

use strict;
use warnings;

use File::Spec;

my $run_dir="/home/ckhau/database/experiment/test";

my $pattern = join ' ', map File::Spec->rel2abs($_, $run_dir), @ARGV;

my $index = -999;
my @files = glob $pattern;

foreach my $file (@files) {
  my $script = "perl abc.pl '$file'";
  system $script;
} 
```

# javascript - 带有下拉菜单的 jQuery

> ID：12451930
> 
> 赞同：0
> 
> 时间：2012-09-17T00:38:42.967
> 
> 标签：javascript, jquery

```
<style type="text/css">
#DIV1, #DIV2, #DIV3 { display:none; }
</style>

<script>
$(function() {
    $('#saleselect').change(function() {
        var val = $(this).val();
        if (val) {
            $('#DIV' + val).addClass("display:block;");
            $('#DIV' + val).slideDown();
        } else {
            $('#DIV' + val).addClass("display:none;");
        }
    });
});
</script>

<div style="position:absolute; z-index:1; right:140px; margin-top:-124px;">
<form>
<select id="saleselect" style="font-size:115%; padding:5px;">
  <option value="1">ONE</option>
  <option value="2">TWO</option>
  <option value="3">THREE</option>
</select>
</form>
</div>

<div id="DIV1">
<?php require "page1.php"; ?>
</div>

<div id="DIV2">
<?php require "page2.php"; ?>
</div>

<div id="DIV3">
<?php require "page3.php"; ?>
</div> 
```

我需要`DIV`在下拉列表中选择显示，同时隐藏另一个`DIV's`我还需要显示`DIV1`为默认值`DIV`

此代码似乎以堆叠顺序显示 DIV。我如何只显示选定的`DIV`并隐藏其他？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T00:44:36.277

```
$(document).ready(function() {
    $('#DIV1').show();
});    

$('#saleselect').change(function() {
    var val = $(this).val();
    $('#DIV1:visible, #DIV2:visible, #DIV3:visible').hide();
    $('#DIV' + val).slideDown();
}); 
```

你不需要`.addClass('display:block')`，因为`.slideDown()`它需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T00:47:15.043

要显示`DIV1`为默认值`div`，请使用以下命令：

```
$(function() {
  $("#DIV1").show();
  // ...
}); 
```

要隐藏除下拉菜单中选择的之外的所有其他`DIV`s，您可以将它们全部隐藏，然后只显示选择的那个：

```
$('#saleselect').change(function() {
    var val = $(this).val();
    $("[id^=DIV]").hide();
    $("#DIV" + val).addClass("display:block;").slideDown();
}); 
```

这是一个**[演示](http://jsfiddle.net/QhjYC/)**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T00:47:52.450

[这样](http://jsfiddle.net/eATcy/)的事情怎么样？我为每个类添加了一个类，`DIV`以便更轻松地一次显示/隐藏所有内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T00:51:42.533

这可以帮助[jsfiddle](http://jsfiddle.net/YMWaP/)

```
$(function() {
$('#saleselect').change(function() {
    var val = $(this).val();
    if (val) {
        for (var i = 1; i < 4; i++) {
            if (val == i) {
                $('#DIV' + i).css("display", "block");
                $('#DIV' + i).slideDown();
            } else {
                $('#DIV' + i).css("display", "none");
            }
        }
    }
});
}); 
```

并且

```
#DIV1 {display: block;}
#DIV2, #DIV3 { display:none; } 
```

# php - PHP MVC 在本地工作，但上传到主机时失败

> ID：12451932
> 
> 赞同：0
> 
> 时间：2012-09-17T00:39:27.690
> 
> 标签：php, localhost, syntax-error

在 localhost/myweb 上一切正常，但是当我将文件夹 myweb 上传到我的 public_html 目录时出现错误：

```
[16-Sep-2012 18:32:55] PHP Warning:  Unexpected character in input:  '\' (ASCII=92)  
state=1 in /home1/programw/public_html/myweb/index.php on line 7

[16-Sep-2012 18:32:55] PHP Parse error:  syntax error, unexpected T_STRING in /home1
/programw/public_html/myweb/index.php on line 7 
```

在我的 index.php 第 7 行有以下代码：

```
 $app = new Core\Bootstrap(); 
```

我知道与 \ 斜杠有关，但我不知道是什么或如何解决它。

谁能帮帮我？我也使用 .htaccess 和 .htaccess 里面我有以下内容：

```
 RewriteEngine On
   RewriteCond %{REQUEST_FILENAME} !-d
   RewriteCond %{REQUEST_FILENAME} !-f
   RewriteCond %{REQUEST_FILENAME} !-l
   RewriteRule ^(.+)$ index.php?url=$1 [QSA,L] 
```

**解决方案**

我刚刚发现 \ 斜杠和命名空间仅在 PHP 5.3 中受支持，并且我的托管出于某种原因没有将他们的 PHP 更新到 5.3。如果有人知道在 5.2 上工作的方法，我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T00:53:26.557

该代码仅适用于 PHP 5.3 及更高版本。您的服务器可能仍在运行 PHP 5.2

您可以通过 phpinfo(); 最简单地检查这一点。或 phpversion();

要修复，您需要删除命名空间（这可能是外部框架的一项大工作）或将服务器升级到 PHP 5.3 或更高版本（请注意，5.2 已经很老了！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T00:53:33.297

没有在 PHP 5.2 上运行 PHP 5.3 代码的解决方法。要么你可以

1.  说服您的托管公司升级到 PHP 5.3 或更高版本

2.  寻找另一家拥有 PHP 5.3 或更高版本的托管公司

3.  为您要使用的包找到与 PHP 5.2 兼容的替代方案。

# mongodb - 启动 MongoDB : ./bin/mongod 没有这样的文件或目录

> ID：12451934
> 
> 赞同：0
> 
> 时间：2012-09-17T00:39:37.740
> 
> 标签：mongodb

使用 ruby​​ gem 安装 MongoDB 后

```
 gem install mongodb 
```

在我的用户/站点目录中，我做了

```
sudo mkdir -p /data/db/  
sudo chown `id -u` /data/db 
```

但是，这并没有在用户/站点中创建这些目录。我必须备份几个级别才能访问它们。

我遵循的指示然后告诉我

```
cd to your MongoDB bin directory or type in the complete path to it. You'll need to start mongod.

$ ./bin/mongod 
```

我在用户/站点中执行了此命令，并且在备份了几个级别之后，在数据目录和数据/数据库目录中执行了此命令。然而，每次我得到

```
./bin/mongod: No such file or directory 
```

**第一个问题：**知道什么是错的吗？

一次，如果我让它工作，我将不得不这样做来启动 mongo shell

```
./bin/mongo 
```

**第二个问题：**我将在哪里运行该命令？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-28T12:26:58.787

我有同样的问题。原来我在 64 位 ubuntu 机器上使用 32 位版本的 mongo。

我从下面的链接得到这个：

[https://groups.google.com/forum/?fromgroups=#!topic/mongodb-user/b8rhUllEhlA](https://groups.google.com/forum/?fromgroups=#!topic/mongodb-user/b8rhUllEhlA)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T02:10:32.687

您确定将 mongo 作为 Ruby gem 安装实际上会安装 MongoDB 吗？在我看来，您只是在安装 ruby​​ 驱动程序。这是一些关于如何[安装 MongoDB](http://docs.mongodb.org/manual/tutorial/install-mongodb-on-ubuntu/)的文档。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-21T08:00:34.507

**错误的路径：**

```
$ sudo chown -R sqy1 /Users/sqy1/data/db 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-28T15:09:20.600

如果您在 Windows 上，请转到 git bash/cmd 然后输入“cd”，这会将您带到根目录，然后输入“mongod”并按 type，这必须启动您的 mongoDB。我这样做了，它奏效了

# html - 最喜欢的书籍列表的 HTML5 文章或部分？

> ID：12451940
> 
> 赞同：7
> 
> 时间：2012-09-17T00:40:37.540
> 
> 标签：html, semantic-markup

一个关于书籍的虚构网站。每本书都有自己的页面。现在我想添加一个页面，列出我一直以来最喜欢的书籍。您会为“容器”使用哪些[HTML5 分段元素，每本书使用哪些？](http://www.w3.org/TR/html5/content-models.html#sectioning-content)`MARQUEE`占位符和`BLINK`占位符应该是`section`or `article`？

该页面可能如下所示：

```
<body>
  <h1>Books!</h1>

  <nav>
    <h1>Navigation</h1>
  </nav>

  <MARQUEE> <!-- section or article? -->
    <h1>My all time favorite books</h1>

      <BLINK> <!-- section or article? -->
        <h1><cite>The Hobbit, or There and Back Again</cite></h1>
        <p>…&lt;/p>
        <nav><a href="books/hobbit">see the page about "The Hobbit"</a></nav>
      </BLINK>

      <BLINK> <!-- section or article? -->
        <h1><cite>Alice's Adventures in Wonderland</cite></h1>
        <p>…&lt;/p>
        <nav><a href="books/alice">see the page about "Alice in Wonderland"</a></nav>
      </BLINK>

  </MARQUEE>

  <footer>☺ 2012 books.example.net</footer>
</body> 
```

* * *

## 我的想法

我认为每本书都应该是一个`article`元素。该[规范](http://www.w3.org/TR/html5/the-article-element.html#the-article-element)说“文档中的自包含组合”，“原则上，可独立分发或可重复使用”，“博客条目，[…] 独立的内容项”。我认为所有这些都在这里匹配。

但是容器呢？应该使用`section`or`article`吗？`article`带有嵌套元素的`article`博客评论应该被标记：

> 例如，网站上接受用户提交评论的博客条目可以将评论表示为`article`嵌套在`article`博客条目元素中的元素。

一般定义如下：

> 当`article`元素嵌套时，内部`article`元素代表原则上与外部文章内容相关的文章。

“原则上相关”似乎也符合我的例子，对吧？

我的看法：这个关于我最喜欢的书的页面是一个“自成一体的作品”。这是一篇我可以打印出来并给某人阅读的文章，他将拥有他需要的所有信息，它本身就很有意义，没有任何遗漏。此外，每本最喜欢的书都是“自成一体的作品”，因为我只能打印出其中一本最喜欢的书，而读者仍然可以获得所有相关信息（关于那本书），它本身就很有意义等。

如果有人反对，我很感兴趣？

对于那些同意的人，我的下一个问题是：在标记选择方面，最喜欢的书籍列表与最新博客文章列表在语义上是否不同？所以，你会说“好吧，`article`最喜欢的书列表很好，但最新博客文章列表不行？” 我能看到的唯一区别是大多数人不会对阅读最新博客文章的片段列表感兴趣，所以它不是口语意义上的“自成一体”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T00:52:03.263

我会将全部内容放在一个`article`中，每本书都放在一个`section`.

这将使其与[W3C 给出的第三部分示例极为一致](http://www.w3.org/TR/html5/the-section-element.html#the-section-element)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T00:52:42.423

理想情况下，您会使用其中包含文章的列表。因为它是，嗯，你最喜欢的书的清单，不是吗？

但就个人而言，我使用包含文章的部分。我不会真的认为一个列表可以与一篇文章相提并论，这基本上就是你所拥有的。如果您要扩展它以包含有关您如何提出列表的信息，使其更多地成为博客文章类型的东西，那么成为包含文章的文章会更有意义（同样，理想情况下，包含文章*列表*）。

无论如何，为您要链接的每本单独的书使用部分是没有任何意义的。

# node.js - node js express twitter api登录

> ID：12451948
> 
> 赞同：1
> 
> 时间：2012-09-17T00:41:42.387
> 
> 标签：node.js, express, pug, cloud9-ide

我是 nodejs 的新手，实际上我需要使用 twitter API 进行 twitter 登录，我一直在使用这个示例[http://moonlitscript.com/post.cfm/how-to-use-oauth-and-twitter-in -your-node-js-expressjs-app/](http://moonlitscript.com/post.cfm/how-to-use-oauth-and-twitter-in-your-node-js-expressjs-app/)所以，在花了一些时间尝试为我理解玉和所有这些新的小东西之后，我设法写了一些东西，但是我不知道我应该如何发送信息我的登录页面到处理 twitter 登录过程的方法。有没有人可以帮助我指出正确的方向？提前致谢。

这是我的代码

应用程序.js

```
var express = require('express')
  , routes = require('./routes')
  , user = require('./routes/user')
  , http = require('http')
  , path = require('path')
  , OAuth= require('oauth').OAuth;

var app = express();

var oa = new OAuth(
"https://api.twitter.com/oauth/request_token",
"https://api.twitter.com/oauth/access_token",
"occcccccccc",
"fccccccccccccccccccccccccc",
"1.0",
"http://ccccccccccccc.c9.io/",
"HMAC-SHA1"
);

 app.get('/auth/twitter', function(req, res){
    oa.getOAuthRequestToken(function(error, oauth_token, oauth_token_secret, results){
    if (error) {
        console.log(error);
        res.send("yeah no. didn't work.")
    }
    else {
        req.session.oauth = {};
        req.session.oauth.token = oauth_token;
        console.log('oauth.token: ' + req.session.oauth.token);
        req.session.oauth.token_secret = oauth_token_secret;
        console.log('oauth.token_secret: ' +    req.session.oauth.token_secret);
        res.redirect('https://twitter.com/oauth/authenticate? oauth_token='+oauth_token)
}
});
});

app.get('/auth/twitter/callback', function(req, res, next){
if (req.session.oauth) {
    req.session.oauth.verifier = req.query.oauth_verifier;
    var oauth = req.session.oauth;

    oa.getOAuthAccessToken(oauth.token,oauth.token_secret,oauth.verifier, 
    function(error, oauth_access_token, oauth_access_token_secret, results){
        if (error){
            console.log(error);
            res.send("yeah something broke.");
        } else {
            req.session.oauth.access_token = oauth_access_token;
            req.session.oauth,access_token_secret =      oauth_access_token_secret;
            console.log(results);
            res.send("worked. nice one.");
        }
    }
    );
} else
    next(new Error("you're not supposed to be here."))
});

app.configure(function(){
  app.set('port', process.env.PORT || 3000);
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.favicon());
  app.use(express.logger('dev'));
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(app.router);
  app.use(express.static(path.join(__dirname, 'public')));
});

app.get('/', function(req, res){
    res.render('index');
});

app.post('/', function(req,res){
  console.log(req.body);
})

app.configure('development', function(){
  app.use(express.errorHandler());
});

app.get('/', routes.index);

//http.createServer(app).listen(app.get('port'), function(){
 //  console.log("Express server listening on port " + app.get('port'));
 //});

app.listen(process.env.PORT, process.env.IP, function() {
  console.log("Listening on " + app.get('port'));
}); 
```

索引.jade

```
 form(name="input", action="/auth/twitter", method="get")
  |Username:
  input(type="text", name="user")
  |Password:
  input(type="password", name="pswd")
  input(type="submit", value="Submit") 
```

# java - 无法退出 Java JVM

> ID：12451950
> 
> 赞同：0
> 
> 时间：2012-09-17T00:42:13.687
> 
> 标签：java, multithreading, jvm

我编写了一个简单的 Java 程序。首先我将组件添加到扩展JWindow的类中，然后显示。

```
public class G4TestWindow extends JWindow {

    public G4TestWindow(){
        JLabel hah=new JLabel("Wooh");
        getContentPane().setLayout(new BorderLayout());
        getContentPane().add(hah);
        pack();
        setVisible(true);
    }
} 
```

并在主类中启动。

```
public class G4Test extends JWindow {

    public static void main(String []args){
        G4TestWindow g4tw=new G4TestWindow();   
        System.exit(-1);
    }
} 
```

但即使我使用`System.exit(-1)`. 我发现原因是`genContentPane().add(hah)`经过多次尝试（如果我忽略它，JVM会正常退出）。

为什么是这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T01:46:28.917

不知道为什么会失败。它到达 System.exit 并在我的系统上退出（Mac 上的 JDK 1.6），即使使用“.add(hah).

但是，您没有正确使用 BorderLayout 布局管理器。使用 BorderLayout 时，每当添加组件时，都需要指定区域，例如：

```
getContentPane().add(hah, BorderLayout.CENTER); 
```

尝试解决这个问题，看看你是否能得到更好的结果。

# tmux - tmux 同步一些但不是所有的窗格

> ID：12451951
> 
> 赞同：21
> 
> 时间：2012-09-17T00:42:59.717
> 
> 标签：tmux

在 tmux 中，我有一个 3 列和 2 行的布局，第一行是到我所有服务器的 ssh 连接，底部是运行在顶部的所有相同服务器。

我正在尝试同步第一行，所以如果我输入一个命令，所有三个窗格都复制相同的命令，我尝试了 synchronize-panes 但正如手册页所说，它将通过所有窗格运行命令，然后对我的所有窗格造成严重破坏底部行的“顶部”。

无论如何要同步一组窗格？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-06-29T07:19:39.337

这不完全是您正在寻找的东西，但它非常接近。这个想法是将一个键绑定到一组命令以：

1.  提示命令运行
2.  使用“选择窗格”选择第一个顶级窗格
3.  使用 'send-keys' 运行命令
4.  对其他顶级窗格重复步骤 2 和 3

这是命令的样子

```
bind R command-prompt -p "Command :" "select-pane -t 0 \; send-keys "%1" C-m \; select-pane -t 2 \; send-keys "%1" C-m \; select-pane -t 4 \; send-keys "%1" C-m " 
```

下面是一个完整的例子，让我们设置 6 个窗格，2 行，每行 3：

```
$ tmux new -s 'top_n_tail' \; split-window -h \; split-window -h \; select-layout even-horizontal \; detach
$ tmux att -t 'top_n_tail' \; select-pane -t 0 \; split-window \; detach
$ tmux att -t 'top_n_tail' \; select-pane -t 2 \; split-window \; detach
$ tmux att -t 'top_n_tail' \; select-pane -t 4 \; split-window 
```

在 tmux 提示符 (Cb :) 上将 'R' 绑定到一组 tmux 命令，这些命令接受您的 bash 命令并将其发送到某些窗格：

```
:bind R command-prompt -p "Command :" "select-pane -t 0 \; send-keys "%1" C-m \; select-pane -t 2 \; send-keys "%1" C-m \; select-pane -t 4 \; send-keys "%1" C-m " 
```

现在，当您按下 Cb R 时，系统会提示您输入命令

![提示输入命令](../Images/554d3521932af56ac1081b456c92568a.png)

仅在前 3 个窗格中运行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-25T17:36:53.550

您可以使用 禁用窗格上的输入`select-pane -d`。要再次启用它，请执行`select-pane -e`

我的前缀中有一个快捷方式：

```
bind -T marcos d select-pane -d
bind -T marcos e select-pane -e 
```

# php - 使用 PHP 查询 MySQL 数据库（if 语句）

> ID：12451953
> 
> 赞同：1
> 
> 时间：2012-09-17T00:43:11.563
> 
> 标签：php, mysql

我需要你的帮助。

我有一个 PHP 代码，用于在选择某个运算符后查询 MySQL 数据库。我从下拉列表中获得的运算符是“小于、大于和等于”。我的问题是；无论我选择哪个运算符，我从数据库中获得的结果始终是“LESS THAN”运算符。也就是说，无论我选择“小于”、“大于”还是“等于”，它都会给我相同的结果。我试图定位问题，但失败了。这是我使用的代码：

```
 if ($op='LESS THAN') {
        $query = "SELECT * FROM tbl_reservoir WHERE res_vol < '$vol'";
    } elseif ($op='GREATER THAN') {
            $query = "SELECT * FROM tbl_reservoir WHERE res_vol > '$vol'";
    } elseif ($op='EQUAL') {
         $query = "SELECT * FROM tbl_reservoir WHERE res_vol = '$vol'";
    } 
```

$op 是一个保存操作符的变量，而“res_vol”是我从数据库表中比较的一个字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T00:45:29.607

您必须使用`==`或`===`在您的`if`情况下

```
if ($op == 'LESS THAN')
{
  // code here
}
elseif ($op == 'GREATER THAN')
{
  // code here
}
// ....... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T00:46:19.743

您在`=`需要相等运算符 ( ) 的位置使用赋值运算符 ( `==`)，因此您的代码应为：

```
 if ($op=='LESS THAN') {
    $query = "SELECT * FROM tbl_reservoir WHERE res_vol < '$vol'";
} elseif ($op=='GREATER THAN') {
        $query = "SELECT * FROM tbl_reservoir WHERE res_vol > '$vol'";
} elseif ($op=='EQUAL') {
     $query = "SELECT * FROM tbl_reservoir WHERE res_vol = '$vol'";
} 
```

但是，您可以将其简化为：

```
static $map = array('LESS THAN' => '<', 'GREATER THAN' => '>', 'EQUAL' => '=');
if (!isset($map[$op])) {
    throw new Exception(sprintf("Unexpected operator '%s', $op));
}
$query = sprintf("SELECT * FROM tbl_reservoir WHERE res_vol %s '$vol'", $map[$op]); 
```

# python - 获取numpy数组中非零元素的数量？

> ID：12451954
> 
> 赞同：6
> 
> 时间：2012-09-17T00:43:56.333
> 
> 标签：python, numpy

是否可以在不迭代数组或屏蔽数组的情况下获取 numpy 数组中非零元素的长度。速度是计算长度的主要目标。

本质上，类似`len(array).where(array != 0)`.

如果它改变了答案，每一行都将从零开始。数组在对角线上用零填充。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-17T00:49:58.967

假设您的意思是非零元素的总数（而不是非零行的总数）：

```
In [12]: a = np.random.randint(0, 3, size=(100,100))

In [13]: timeit len(a.nonzero()[0])
1000 loops, best of 3: 306 us per loop

In [14]: timeit (a != 0).sum()
10000 loops, best of 3: 46 us per loop 
```

甚至更好：

```
In [22]: timeit np.count_nonzero(a)
10000 loops, best of 3: 39 us per loop 
```

最后一个 ,`count_nonzero`似乎在数组很小的时候也表现得很好，而`sum`诀窍不是那么多：

```
In [33]: a = np.random.randint(0, 3, size=(10,10))

In [34]: timeit len(a.nonzero()[0])
100000 loops, best of 3: 6.18 us per loop

In [35]: timeit (a != 0).sum()
100000 loops, best of 3: 13.5 us per loop

In [36]: timeit np.count_nonzero(a)
1000000 loops, best of 3: 686 ns per loop 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T00:49:41.427

`len(np.nonzero(array)[0])`?

*   [`np.nonzero`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.nonzero.html)返回一个索引元组，其长度等于初始数组中的维数
*   我们只得到沿第一维的索引`[0]`
*   计算它的长度`len`

# jquery - Jquery 动画圆形 div 的问题

> ID：12451958
> 
> 赞同：0
> 
> 时间：2012-09-17T00:44:59.583
> 
> 标签：jquery, button, html, jquery-animate, css

所以，

冒着迷失在论坛上“悬停动画问题”之海的风险，这里是：

我正在为登陆页面开发一系列悬停动画按钮。它们的悬停状态是一个圆形 div：

![在此处输入图像描述](../Images/6fc215d31466a8f4ef581a945ac40906.png)

初始/“mouseoff”状态是没有 div 的彩色动画文本：

![在此处输入图像描述](../Images/721b43a5bdd8472eeee32a1dca1faa32.png)

我有一个带有脚本的[JSfiddle](http://jsfiddle.net/Koubenec/2GE2b/7/)来为 div 的背景颜色设置动画，以便当光标在它上面时它会变成棕色，但我认为我忽略了语法中的某些内容，因为它似乎没有生效：

```
<script type="text/javascript">
  $(document).ready(function(){
    $(".corners").hover(function() {
      $(this).stop().animate({ backgroundColor: "#fff"}, 'fast');
    },
    function() {
      $(this).stop().animate({ backgroundColor: "#8B5E3C"}, 'fast');
    });
  });
</script>
<div class="corners"> 
    <div class="cornertext">Main Site</div> 
</div>
<div class="corners"> 
    <div class="cornertext">Mobile</div> 
</div> 
```

一旦我弄清楚了这个属性，目标就是设置一个函数来同时更改字体颜色，但首先我必须确定 DIV 颜色动画有什么问题。来自 SO 的人才的帮助会很棒！

-马卡 ​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T00:50:57.710

您忘记包含 ui 库。我在[这里](http://jsfiddle.net/2GE2b/10/)有一个工作演示。确保在包含 jquery 之后包含[库。](http://jqueryui.com/)

另请参阅[此处](http://jqueryui.com/demos/animate/)了解有关扩展的详细信息`.animate()`

# django - django重新组合奇怪的行为

> ID：12451961
> 
> 赞同：3
> 
> 时间：2012-09-17T00:45:48.643
> 
> 标签：django, django-templates

无论出于何种原因，我都无法在本地复制此问题，但在我的一个模板中的生产服务器上，重组标签正在做一些奇怪的事情。我正在尝试对所有具有相同pickup_id 的捐赠进行分组，并仅显示其中有多少被“错过”。出于某种原因，它在我的列表中多次显示相同的pickup_id。

看法

```
missed_routes = Donor.objects.filter(missed='YES').order_by('pickup_date') 
```

模板

```
{% block content %}
{% regroup missed_routes by pickup_id as missed_pickups %}

<div class="missedColumn">
    <h2>Missed Donations</h2>
    <p>Looks like we have some stragglers…&lt;/p>
    <p>These routes have missed donations in them.</p>
    {% for routes in missed_pickups %}

        <p><a href="/reschedule/{{ routes.grouper }}">{{ routes.list.0.route }}</a> - {{ routes.list.0.pickup_date }} ({{ routes.list|length }} missed - {{ routes.list.0.pickup_id }}</p>
    {% endfor %}
</div> 
```

结果 html # 600 是pickup_id

```
 <p><a href="/reschedule/600">Syosset</a> - Sept. 14, 2012 (1 missed - 600</p>

        <p><a href="/reschedule/423">Huntington Station</a> - Sept. 14, 2012 (1 missed - 423</p>

        <p><a href="/reschedule/600">Syosset</a> - Sept. 14, 2012 (2 missed - 600</p> 
```

在拾取 html 输出中迭代每个捐助者时

```
 <p><a href="/reschedule/600">Syosset</a> - Sept. 14, 2012 (1 missed - 600
        <ul>

            <li>134170</li>

        </ul>
        </p>

        <p><a href="/reschedule/423">Huntington Station</a> - Sept. 14, 2012 (1 missed - 423
        <ul>

            <li>134938</li>

        </ul>
        </p>

        <p><a href="/reschedule/600">Syosset</a> - Sept. 14, 2012 (2 missed - 600
        <ul>

            <li>134174</li>

            <li>133151</li>

        </ul> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-17T01:41:27.013

问题是 Django 的重新组合取决于您重新组合所依据的属性排序的列表。请参阅[文档](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#regroup)：

> 请注意，{% regroup %} 不会对其输入进行排序！我们的示例依赖于这样一个事实，即城市列表首先是按国家/地区排序的。如果城市列表未按国家/地区对其成员进行排序，则重组将天真地显示单个国家/地区的多个组

因此，改变：

```
missed_routes = Donor.objects.filter(missed='YES').order_by('pickup_date') 
```

至

```
missed_routes = Donor.objects.filter(missed='YES').order_by('pickup_id') 
```

# ruby-on-rails - 在超类级别处理 Rails 模型子类：简化路由和单个控制器

> ID：12451963
> 
> 赞同：1
> 
> 时间：2012-09-17T00:46:02.053
> 
> 标签：ruby-on-rails, controller, routes, polymorphism

我目前有：

```
class Tutorial
  has_many :comments
end

class VideoTutorial < Tutorial
end

class Comments
  belongs_to :tutorial
end 
```

`routes.rb`读起来像：

```
resources :tutorials do
  resources :comments
end 
```

我希望能够像这样引用特定类型的`Tutorial`（以 开头`VideoTutorial`）：

```
/tutorials/1234
/tutorials/1234/comments/new
/tutorials/1234/comments/6374 
```

`Tutorial`这意味着尽可能多地处理教程，而不是`VideoTutorial`（或出现的其他子类）。

我希望所有呼叫都转到单个控制器并使用上面的直接路由。

**问题：现在发生了什么**

我的表单似乎在多态上匹配路由，匹配特定`Tutorial`实例的类型，例如

```
# @tutorial is a VideoTutorial
= form_for @tutorial do |f|  # undefined method 'video_tutorial_path'
... 
```

这很酷，但不是我在这种情况下要找的:)

我目前正在通过生成这些路线来使事情顺利进行：

```
resources :tutorials do
  resources :comments
end

resources :video_tutorials, :controller => "tutorials" do
  resources :comments
end 
```

当出现新的子类时，我将指向`Tutorials`控制器，因为我想避免大量控制器成倍增加`Tutorial`。

但这变得混乱：

*   你会得到很多额外的路线
*   当您添加一个新的子类时，您会获得更多路线`Tutorial`
*   您最终会引用参数，`:video_tutorial_id`而不仅仅是泛型`:id`

我想在上述情况下处理所有`Tutorial`类型`Tutorial`。

有什么更简单、更简洁的方法？

**更新：根据@jdl 的建议**

`Tutorial`显示页面链接：

```
 # original approach:
  = link_to 'Show', @tutorial

  # now:
  = link_to 'Show', tutorial_path(@tutorial) 
```

`form_for`帮手：

```
 # original approach:
  = form_for @tutorial do |f|

  # now:
  = form_for @tutorial, :as => :tutorial, :url => tutorial_path do |f| 
```

`form_for`嵌套资源：

```
 # original approach:
  = form_for [@tutorial, @new_comment] do |f|

  # now:
  = form_for [@tutorial, @new_comment], :as => :tutorial, :url => tutorial_comments_path(@tutorial, @new_comment) do |f| 
```

这现在按预期工作。

有点罗嗦:) 关于使它更优雅的任何进一步想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T01:17:30.290

看一下`:as`参数`form_for`。

[http://apidock.com/rails/ActionView/Helpers/FormHelper/form_for](http://apidock.com/rails/ActionView/Helpers/FormHelper/form_for)

# ruby-on-rails - gem install sqlite3 给出错误 - sqlite3.h 丢失

> ID：12451964
> 
> 赞同：4
> 
> 时间：2012-09-17T00:46:05.543
> 
> 标签：ruby-on-rails, ruby, sqlite, gem, installation

(Ubuntu 12.04)

```
gem install sqlite3 
```

给出：

```
$ gem install sqlite3
Building native extensions.  This could take a while...
ERROR:  Error installing sqlite3:
        ERROR: Failed to build gem native extension.

        /home/durrantm/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb
checking for sqlite3.h... no
sqlite3.h is missing. Try 'port install sqlite3 +universal'
or 'yum install sqlite-devel' and check your shared library search path (the
location where your sqlite3 shared library is located).
*** extconf.rb failed *** 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-17T00:50:28.350

我看到你在 Linux 上。安装该`libsqlite3-dev`软件包应该可以解决您的问题（至少在 Debian 上是这样称呼的）。

例如`sudo apt-get install libsqlite3-dev`

如果这不是正确的包名称，只需四处寻找 sqlite3 的开发包（其中包括头文件，通常包括编译器/链接器中间文件）。

# android - 安卓透明布局

> ID：12451969
> 
> 赞同：0
> 
> 时间：2012-09-17T00:47:02.957
> 
> 标签：android, android-layout, transparency

我对 Android 很陌生。我想在用户接到电话时弹出一个透明屏幕。我有这段代码可以打开 MyActivity 屏幕，但它是白色的而不是透明的。

```
public class CallReceiver extends BroadcastReceiver {

  @Override
  public void onReceive(Context context, Intent intent) {
    String state = intent.getStringExtra(TelephonyManager.EXTRA_STATE);
    if (TelephonyManager.EXTRA_STATE_RINGING.equals(state)) {
      SystemClock.sleep(1);
      Intent intent = new Intent(context, MyActivity.class);
      intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_NO_USER_ACTION);
      context.startActivity(intent);
    }

  }

} 
```

这是 MyActivity 的代码：

```
public class MyActivity extends Activity {
  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_my);
    getWindow().addFlags(WindowManager.LayoutParams.FLAG_NOT_TOUCHABLE);
    getWindow().addFlags(WindowManager.LayoutParams.FLAG_NOT_TOUCH_MODAL);
  }
} 
```

这是布局：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:windowBackground="@android:color/transparent" 
    android:windowIsTranslucent="true" 
    android:windowAnimationStyle="@android:style/Animation.Translucent" >
    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="@string/incoming_call"
        tools:context=".MyActivity" />
</RelativeLayout> 
```

这成功地弹出了一个带有我的消息的屏幕，但它使用白色背景而不是透明背景。知道我可能做错了什么吗？我正在使用带有 Android 2.2 SDK 的模拟器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T00:59:03.373

我认为问题可能在于窗口和 contentView 之间的混淆。

```
android:windowBackground="@android:color/transparent" 
android:windowIsTranslucent="true" 
android:windowAnimationStyle="@android:style/Animation.Translucent"
android:windowNoTitle="true"
android:windowFrame="@null" 
```

一般来说，RelativeLayout 以及您在内容视图中放置的任何内容都可能不会尊重这些属性。

窗口属性是窗口的一个属性。您可以使用主题更改代码或活动设置中的窗口。

```
<activity android:name="....YourActivity" android:theme="@style/MyTransparentTheme"/> 
```

然后在一些 res 文件中：

**项目/res/values/themes.xml**

```
<resources ....>
 ....
<style android:name="MyTransparentTheme" parent="@android:style/Theme">
  <item name="android:windowBackground">@android:color/transparent</item>
  <item name="android:windowIsTranslucent">true</item>
  <item name="android:windowAnimationStyle">@android:style/Animation.Translucent</item>
  <item name="android:windowNoTitle">true</item>
  <item name="android:windowFrame">@null</item>
</style>
.... 
```

您也可以通过直接在活动的窗口上设置这些属性来进行设置，类似于您的设置方式。`getWindow().addFlags(WindowManager.LayoutParams.FLAG_NOT_TOUCHABLE);`您也可以将窗口设置为具有透明背景。

# java - 带有随机数生成器的公式

> ID：12451972
> 
> 赞同：1
> 
> 时间：2012-09-17T00:47:35.910
> 
> 标签：java, random

这里有点问题。想知道为什么我的arrivalInterval 方法的结果会得到“Infinity”。（tmp 是在上一个类中定义的，我将粘贴两个类）第一个类 RandomNum 工作得很好。

```
import java.util.Random;

public class RandomNum {

        static double x = 0.1;
        static double y = 0.2;
        static double z  = 0.3; 
        static double lamda;                                  
        static double tmp;
        static double count1, count2, count3;
        static double average;          
        static Random randomNumbGen = new Random();

        // 3 methods for testing x, y, and z
        public static double ExpInterval(double lamda)

        {
        tmp=randomNumbGen.nextDouble();            
        return (-(1/lamda) * Math.log(tmp));
        }

        public static void main(String[] args) {
                   // TODO Auto-generated method stub
                    // loop that runs then methods then adds them to the count (for an an average later)     and prints out the results

for (int i=1; i<1001; i++)
count1+=ExpInterval(x);
System.out.println(ExpInterval(x));
count2+=ExpInterval(y);
System.out.println("                         " + ExpInterval(y));
count3+=ExpInterval(z);
System.out.println("                                                       " + ExpInterval(z));
}

//calculates average then prints it out
average = count1/1000;
System.out.println("The Average of the first variable is" + average +"  " + "1/lamba is " + 1/x);
average = count2/1000;
System.out.println("The average of the second variable is " + average + "   " + "1/lamba is " + 1/y);
average = count3/1000;
System.out.println("The average of the third variable is " +  average + "   " +  "1/lamba is " + 1/z);
}} 
```

现在对于我遇到问题的课程。如果随机数选择 1，则除以 .1/tmp（第一类生成的随机数），如果为 2，则为 .2/tmp，如果为 3，则为 .3/tmp

```
 import java.util.*;
    public class RandomProcess extends RandomNum 
    {
    Set<Integer> set = new HashSet<Integer>();
    Random random = new Random();
    public double findArrivalInterval()
    {
    double arrivalInterval = 0.0;
    set.add(1);
    set.add(2);
    set.add(3);
    Integer result = (Integer) set.toArray()[random.nextInt(set.size())]; //only 1, 2, or 3 to be picked

    if (result == 1)
    {
    arrivalInterval = .1/tmp;
    System.out.println(arrivalInterval);
    return arrivalInterval;
    }
    if (result == 2)
    {
    arrivalInterval = .2/tmp;
    System.out.println(arrivalInterval);
    return arrivalInterval;

    }
    if (result == 3)
    {
    arrivalInterval = .3/tmp;
    System.out.println(arrivalInterval);
    return arrivalInterval;
    }
    System.out.print(arrivalInterval);
    return arrivalInterval;
    }
        public static void main(String[] args)
        {
        RandomProcess testProcess = new RandomProcess();
        testProcess.findArrivalInterval();
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T01:04:49.090

看来`tmp == 0f`; Java 浮点除以零产生`POSITIVE_INFINITY`或`NEGATIVE_INFINITY`取决于符号。

原因`tmp`是`0f`因为你从来没有给它赋值，所以它保留了它的默认初始化值，即`0f`. 请注意，您从不调用`ExpInterval`，因此`tmp`在您发布的代码中确实从未修改过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T00:52:49.117

你从不坐`tmp`二等舱，因为你从不打电话`ExpInterval`，只是`findArrivalInterval`。

此外，您可以`int result = (Math.random()*3)+1`使用`set`. 并将所有这些 if 语句替换为

```
arrivalInterval = 0.1*result/tmp
System.out.println(arrivalInterval);
return arrivalInterval; 
```

# c# - MongoDB（C# 驱动程序）反序列化 ObjectID 字段的问题

> ID：12451973
> 
> 赞同：0
> 
> 时间：2012-09-17T00:47:49.547
> 
> 标签：c#, mongodb, mongodb-.net-driver

我正在使用 MongoDB 将文档反序列化为 C# 对象，并且遇到了 ObjectID 字段的问题。这是我得到的错误：

> 缺少类 MyProject.Data.MyDocument 的属性“LayoutId”的必需元素“LayoutId”。

哪个（如果它看起来并不奇怪）确实有意义，因为指定了 LayoutId 字段：

```
using System;
using MongoDB.Bson;
using MongoDB.Bson.Serialization.Attributes;

namespace MyProject.Data
{
  public class MyDocument
  {

    public override ObjectId Id { get; set; }

    [BsonRequired]
    public String Name { get; set; }

    [BsonRequired]
    public ObjectId LayoutId { get; set; }

  }
} 
```

并将其填充在数据库中：

![在此处输入图像描述](../Images/a4d1c502a9e7a2accad07cd675aeac54.png)

那么序列化过程的哪些其他方面可以阻止这个元素被填充呢？特定版本的驱动程序是否存在错误？我是否使用了正确的数据类型？

还应该注意的是：

*   该文档用于在数据库中填充该值，因此似乎只有反序列化是一个问题，而序列化很好。
*   同一个库中还有其他文件有同样的问题。
*   在同一个解决方案中有 mongo 文档/合同，但在不同的库中似乎没有相同的问题，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T02:21:58.727

我无法重现此错误。你能用测试程序更新你的问题吗？

```
using MongoDB.Bson;
using MongoDB.Bson.Serialization;
using MongoDB.Bson.Serialization.Attributes;
using MongoDB.Driver;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Linq;

namespace TestConsole_Source
{
    class Program
    {
        public class MyDocument
        {
            public ObjectId Id { get; set; }

            [BsonRequired]
            public string Name { get; set; }

            [BsonRequired]
            public ObjectId LayoutId { get; set; }
        }

        static void Main(string[] args)
        {
            var server = MongoServer.Create();
            server.Connect();

            var db = server.GetDatabase("docstest");
            var collection = db.GetCollection<MyDocument>("docs");
            collection.Drop();

            var doc = new MyDocument
            {
                Name = "Test",
                LayoutId = ObjectId.GenerateNewId()
            };

            collection.Save(doc);

            var foundDoc = collection.FindOne();
            //Console.ReadKey();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-23T22:18:01.323

感谢克雷格试图解决这个问题。事实证明，我没有正确写出这个问题。

问题是我在结果上调用了“SetFields()”，而我请求的字段不包括“LayoutId”。不过，我本来希望驱动程序会出现更具描述性的错误。

# c++ - 远程进程的基地址和快照

> ID：12451976
> 
> 赞同：1
> 
> 时间：2012-09-17T00:48:17.867
> 
> 标签：c++, windows, memory, process

现在有几个问题让我的大脑爆炸：从 MODULEENTRY32 结构检索的基地址（从远程进程的快照创建，并引用远程进程的模块）是内存中的真实地址还是相对地址? 如果是相对的，它与什么相关？

第二：远程进程快照中任何其他模块的基地址是相对于远程进程的基地址还是内存中的真实地址？文档说 MODULEENTRY32 结构的 hModule 成员是“在拥有进程的上下文中模块的句柄”，所以我认为这暗示它是一个相对地址，但我不确定。

以防我所说的完全脱离上下文，这里有一些部分代码：

```
DWORD getProcBaseAddress(DWORD targetPID) {
    hModuleSnap = CreateToolhelp32Snapshot( TH32CS_SNAPMODULE, targetPID ); 
    MODULEENTRY32 me32;
    me32.dwSize = sizeof( MODULEENTRY32 );
    Module32First( hModuleSnap, &me32 );
    _tprintf( TEXT("Proc Base Address = 0x%08X"), (DWORD) me32.modBaseAddr);
    return (DWORD) me32.modBaseAddr;
} 
```

这可能是功能代码。targetPID 是我的目标进程的进程 ID。无论如何，我的问题是指 modBaseAddr。提前感谢您的任何帮助或考虑。如果您可以向我推荐任何有关相对和物理寻址的好文章或资源，则可以加分：-]

# java - 将多个模式添加到单个 servlet

> ID：12451978
> 
> 赞同：2
> 
> 时间：2012-09-17T00:48:33.067
> 
> 标签：java, servlets, xsd

我有两个模式和两个端点，目前我只有一个 servlet。有没有办法可以将两种模式都添加到一个 servlet 中？还是我必须添加第二个 servlet。

我看到的其他可能性涉及将两个两个模式组合成一个模式，我的问题是我不希望人们能够看到第二个模式的内容。解决此问题的最佳方法是什么。

对此的任何建议都会很有用，我已经找到了建议，但没有什么可以说最好的方法是什么。

目前我有一个使用`simpleXsdSchema`

```
 <bean id="schema" class="org.springframework.xml.xsd.SimpleXsdSchema" 
        p:xsd = "classpath:au/test/Search/ws/schemas/Search.xsd"/> 
```

我想做这样的事情：

```
<bean id="schema" class="org.springframework.xml.xsd.SimpleXsdSchema">
    <property name="schema">
        <list>
            <value>
                classpath:au/test/Search/ws/schemas/Search.xsd
            </value>
            <value>
                classpath:au/test/Search/ws/schemas/admin/SearchAdmin.xsd
            </value>
        </list>
    </property>
</bean>
*i am aware this does not work 
```

但我不确定这是否是解决此问题的正确方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T23:01:59.703

经过更多研究，可以使用模式集合类声明多个模式，需要导入 xmlschema 框架。

```
<bean id="schemaCollection"
    class="org.springframework.xml.xsd.commons.CommonsXsdSchemaCollection">
    <property name="xsds">
        <list>
            <value>au/test/Search/ws/schemas/admin/SearchAdmin.xsd</value>
            <value>au/test/Search/ws/schemas/Search.xsd</value>
        </list>
    </property>
    <property name="inline" value="true" />
</bean> 
```

就我而言，这不是我发现的最好的方法，而是声明两个 servlet 是最好的做法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T05:59:37.323

我不是你需要的 100%，但在 Servlets 中，你可以使用部署描述符 ( `web.xml`) 定义多个指向同一个 servlet 的端点，如下所示：

```
<servlet>
  <servlet-name>Servlet1</servlet-name>
  <servlet-class>Servlet.java</servlet-class>
</servlet>
....
<servlet-mapping>
  <servlet-name>Servlet1</servlet-name>
  <url-pattern>/endpoint1</url-pattern>
  <url-pattern>/endpoint2</url-pattern>
</servlet-mapping> 
```

然后在 Servlet 代码中，您可以定义应用程序逻辑（如果请求来自`endpoint1`您可以显示与来自的内容不同的内容 `endpoint2`）

# c++ - 指针映射与结构/容器映射 (C++)

> ID：12451980
> 
> 赞同：9
> 
> 时间：2012-09-17T00:48:47.710
> 
> 标签：c++, dictionary, pointers

我正在学习数据结构类，在教授的所有示例中，他总是让他的地图具有指向结构或容器的指针的值，而不是保存结构或容器本身。

他只是将其作为一种习惯，还是有诸如提高速度之类的充分理由？

*   我知道您可以使用指向数据的指针来避免数据的冗余副本，但仍然可以同时在多个容器/结构中容纳指向该数据的方向。
*   在这些示例中，情况并非如此。数据仅在该地图中。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-17T01:56:56.320

在我看来，决定是否使用指针与对象涉及许多因素：

**1\. 你是否需要多态性？**

如果要维护基类对象的容器，然后在其中存储各种派生类的对象，则必须使用指针，否则将无法正确解析虚函数调用。

**2.您存储的对象的大小及其对复制操作的适用性**

指针可能优于对象的关键原因之一是对容器执行的各种操作都涉及复制存储在其中的对象。对于许多存储操作（例如`std::vector<>::push_back()`or `std::map<>::insert()`）、一些检索操作（例如`std::vector<>::operator[]`，然后将对象存储在局部变量中）以及由容器“内部”执行的一些操作（例如重新分配当向量超出其容量时，或重新散列`std::unordered_map<>`. 请注意，复制操作可能不太重要，具体取决于您如何选择容器以及如何使用它（例如，`std::vector<>::reserve()`用于分配足够的空间、`std::vector<>::emplace_back()`用于存储以及从不制作检索到的元素的本地副本可能意味着没有副本是做过）。

但是，如果您希望制作大量副本（或者如果分析现有代码显示制作了许多副本），那么使用指针而不是对象显然会有所帮助，因为指针很小并且在内存中对齐良好。再说一次，如果您存储的对象实际上小于指针，这将没有多大意义。

**3.您对容器及其内容执行的其他操作**

即使您正在处理的对象大于指针并且您期望大量的复制操作，使用指针也不一定是可取的。考虑一种情况，您存储大量中等大小的对象（例如，每个 16 字节），并且您经常需要遍历整个容器并执行某种统计计算。当您将这些对象直接存储在向量中时，您将在迭代期间获得出色的缓存效率：当您检索一个对象时，将从内存中检索整个缓存行，从而使接下来几个对象的检索速度更快。使用指针时通常不是这种情况；相反，在检索到一个元素后，指针必须被取消引用，从而导致另一个可能未缓存的内存区域的移动操作。

很明显，这完全取决于您存储的对象的类型和大小，以及您执行的操作的类型和频率。如果您正在处理的对象是 GUI 应用程序的各种类型的窗口、按钮和菜单，您很可能希望使用指针并利用多态性。另一方面，如果您正在处理紧凑元素的巨大结构，大小和形状都相同，并且您执行的操作涉及频繁的迭代或批量复制，那么直接存储对象是可取的。在某些情况下，如果不尝试两者并根据内存和时间基准的结果做出决定，就很难做出决定。

* * *

最后一点，如果您最终使用指针，请考虑您正在构建的容器是您在堆上分配的对象的最终所有者，还是只是维护临时指针。如果容器是这些对象的所有者，那么建议您使用智能指针而不是原始指针。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T01:56:34.980

将对象实例直接存储在容器中的好处是可以避免一定程度的间接性，并且可以节省指针本身使用的空间。通过直接存储对象实例而不是存储指针，您*可以*在时间和空间效率方面取胜。如果您对处理器缓存内存的工作原理有所了解，就不难看出将对象实例“内联”存储在容器中可以带来真正的性能优势。

在不对包含的类型或容器使用模式做出任何假设的情况下，*默认*容器应该是`std::vector<T>`（而不是`std::vector<T*>`）。从该默认选择开始，如果您可以看到使用模式将如何从该其他类型结构的性能配置文件中受益，您将使用除向量之外的其他东西。*同样，如果需要*指针间接或在性能方面似乎值得，您将拥有指向对象的容器存储*指针。*如果包含的类型不是可复制构造的，则需要间接，如果容器不“拥有”其对象，则也需要间接。

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T00:52:44.203

一种可能性是内容类型不可复制。*

# c# - 如何从点网库调用 SL OOB 应用程序中的方法，反之亦然？

> ID：12451981
> 
> 赞同：2
> 
> 时间：2012-09-17T00:48:59.553
> 
> 标签：c#, silverlight, pinvoke, silverlight-5.0

我在我的机器上安装了一个 SL 5.0 OOB 应用程序，我有另一个用 C# dot net 编写的程序，我想从 dot net 应用程序调用 SL 应用程序，一旦处理数据，SL 应用程序回调 dot net 应用程序，任何建议让我开始，将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T01:25:16.827

*   托管一个 WCF 服务（服务器），该服务持有和维护会话及其对 silverlight 和 dotnet 应用程序的回调指针。
*   两个应用程序在启动时都连接到这个 wcf 服务并注册它们各自的回调
*   然后在 wcf 服务端编写逻辑以将调用和结果从 Dotnet 应用程序路由到 silverlight，反之亦然。

# image-processing - 图像处理 - 如何应用 Box Filter Smoothing

> ID：12451986
> 
> 赞同：3
> 
> 时间：2012-09-17T00:50:15.027
> 
> 标签：image-processing, convolution, smoothing, cimg, imagefilter

编辑：我对盒式过滤器的描述非常错误（盒式过滤器中的所有权重都应该相同），但提供的答案确实解决了图片中的问题。即不确保权重之和等于1的错误。

我正在上计算机图形课程，但在使平滑盒过滤器工作时遇到了一些问题。对于我的尝试，我使用 3x3 蒙版并将其与源图像进行卷积。我书中给出的公式将权重为离散的 1/(2r+1) 和连续的 1/2r，其中 r 是距中心像素的半径。所以我正在做的是分配 3x3 掩码的每个值，如

```
b a b
a 1 a
b a b 
```

其中 a 是 1/3，b 是 1/( ( 2 * sqrt(2) ) +1)

然后将其与源图像进行卷积。

我正在使用的特定库是 CImg，可以在此处找到：[http](http://cimg.sourceforge.net/) ://cimg.sourceforge.net/， 我不妨包括我的源代码和结果。

```
#include "CImg.h"
#include <cmath>

using namespace cimg_library;
int main() 
{
     CImg<unsigned char> image("zhbackground.bmp"), image2("zhbackground.bmp");
     double a = 1.0/3.0;
     double b = 1.0/((2.0*sqrt(2.0))+1.0);
     CImg<> mask = CImg<>(3,3).fill(b,a,b,a,1,a,b,a,b);
     image2.convolve(mask);
     CImgDisplay main_disp(image,"original"), main_disp2(image2, "second");
     while(1)
     {
        main_disp.wait();main_disp2.wait();
     }
} 
```

![原来的](../Images/a05307d272a3e070823ff99616e7a944.png) ![第二](../Images/bac3e29f823a8e812b55f68f4051d5f7.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T01:24:59.220

过滤器权重的总和应为 1.0。你的没有。

# visual-studio-2010 - 如何仅使用键盘过滤不同的异常？

> ID：12451987
> 
> 赞同：0
> 
> 时间：2012-09-17T00:50:22.050
> 
> 标签：visual-studio-2010

在 Visual Studio 的异常选择器 (CTRL+ALT+E) 中，如何使用键盘导航此屏幕？到目前为止，TAB 并没有让我走得太远。谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T01:12:46.967

您可以使用`Tab`浏览右侧的按钮并最终进入主窗格。选择主窗格时，“确定”按钮以蓝色突出显示，但没有围绕它的点线。

进入主要部分后，您可以使用箭头键浏览选项，并且可以使用`Alt`+选择/取消选择选项`T`

# backbone.js - Requirejs：模块加载超时

> ID：12451992
> 
> 赞同：1
> 
> 时间：2012-09-17T00:51:05.717
> 
> 标签：backbone.js, requirejs

实际上，我正面临 Requirejs 和 Backbone 的恼人问题。我正在两条不同的路径上开发我的应用程序：

1.  主要访问，例如：/App/index.php#list
2.  子访问，例如：/App/index.php/clone#list

当我需要使用 require([module]) 方法加载模块时出现问题。

如果我使用绝对路径，就像`require(['/App/js/views/modal.js'])`我得到这个错误一样：

> 错误：模块的加载超时：/App/js/views/modal.js
> 
> [http://requirejs.org/docs/errors.html#timeout](http://requirejs.org/docs/errors.html#timeout)

如果我使用相对方式，例如`require(['js/views/modal.js'])`在我的主访问和`require(['../js/views/modal.js'])`子访问上，一切都会按预期工作。

我正在使用绝对路径加载其他模块并且它们可以工作，如果我复制模块并使用不同的名称要求它可以工作，我认为唯一的区别是我需要的模块已经在另一个模块中确定并且所以它已经被加载了，像这样：

**主模块**

```
require('/App/js/views/row.js'], function(Row){
     Somecode...
});

....

require('/App/js/views/modal.js'], function(Modal){
     Othercode...
}); 
```

**行模块**

```
define([
'backbone',
'text!templates/row.html',
'views/modal', //the same view callend in my main file!
], function(Backbone, rowTemplate, Modal){
    Viewcode...
}); 
```

**模态模块**

```
define([
'backbone',
'text!templates/modal.html',
'models/user_model',
], function(Backbone, modalTemplate, Model){
    Viewcode...
}); 
```

也许我遗漏了一些东西，但我不明白这背后的逻辑，为什么不使用绝对地址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T23:00:36.933

您不需要`.js`在 require.js 中附加到文件名的末尾，我自己也看到了这样做的奇怪行为。此外，我建议您在应用程序的各个模块中使用相对路径，因为它可以更直接地将应用程序的模块/组件拖放到另一个应用程序中。

# php - php蜘蛛脚本不起作用

> ID：12451995
> 
> 赞同：-2
> 
> 时间：2012-09-17T00:52:00.473
> 
> 标签：php, web-crawler

我一直在使用以下脚本为我的客户网站创建站点地图。问题是它不适用于每个站点。我发现，godaddy 上托管的许多（如果不是全部）网站都没有蜘蛛。如果有人可以在我的脚本中看到错误或知道导致错误的原因，我将非常感谢您的帮助。

提前致谢

```
set_time_limit(0);
class spider_man
{
var $url;
var $limit;
var $cache;
var $crawled;
var $banned_ext;
var $domain;

function spider_man( $url, $banned_ext, $limit ){
    $this->domain = $url;
    $this->url = 'http://'.$url ;
    $this->banned_ext = $banned_ext ;
    $this->limit = $limit ;
    if( !fopen( $this->url, "r") ) return false;
    else $this->_spider($this->url);
}

function _spider( $url ){
    $this->cache = @file_get_contents( urldecode( $url ) );
    if( !$this->cache ) return false;
    $this->crawled[] = urldecode( $url ) ;
    preg_match_all( "#href=\"(https?://[&=a-zA-Z0-9-_./]+)\"#si", $this->cache, $links );
    if ( $links ) :
        foreach ( $links[1] as $hyperlink ){                
            if(strpos($hyperlink,$this->domain)===false){ break; }
            else{
                $this->limit--;
                if( ! $this->limit ) return;
                if( $this->is_valid_ext( trim( $hyperlink ) ) and !$this->is_crawled( $hyperlink ) ) :
                $this->crawled[] = $hyperlink;
                echo "Crawling $hyperlink<br />\n";
                unset( $this->cache );
                $this->_spider( $hyperlink );
                endif;
            }
        }
    endif;
}

function is_valid_ext( $url ){   
    foreach( $this->banned_ext as $ext ){
        if( $ext == substr( $url, strlen($url) - strlen( $ext ) ) ) return false;
    }
    return true;
}
function is_crawled( $url ){
    return in_array( $url, $this->crawled );
}
}

$banned_ext = array(".dtd",".css",".xml",".js",".gif",".jpg",".jpeg",".bmp",".ico",".rss",".pdf",".png",".psd",".aspx",".jsp",".srf",".cgi",".exe",".cfm");

$spider = new spider_man( 'domain.com', $banned_ext, 100 );
print_r( $spider->crawled ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T00:59:18.710

当您使用 fopen() 的 file_get_contents() 访问站点时，您不会发送 AGENT 或 REFERRER 或其他标题信息。很明显，这是一个自动化脚本。

您需要查看使用 fopen 发送上下文（[检查文档](http://php.net/manual/en/function.fopen.php)并阅读上下文部分），或者更好的是使用[CURL](http://php.net/manual/en/book.curl.php)。这允许您设置代理和引荐来源标头以模拟浏览器。

# python - BeautifulSoup getText 介于两者之间 , 不接后续段落

> ID：12451997
> 
> 赞同：67
> 
> 时间：2012-09-17T00:52:10.583
> 
> 标签：python, python-2.7, beautifulsoup

首先，当谈到 Python 时，我是一个完全的新手。但是，我编写了一段代码来查看 RSS 提要、打开链接并从文章中提取文本。这是我到目前为止所拥有的：

```
from BeautifulSoup import BeautifulSoup
import feedparser
import urllib

# Dictionaries
links = {}
titles = {}

# Variables
n = 0

rss_url = "feed://www.gfsc.gg/_layouts/GFSC/GFSCRSSFeed.aspx?Division=ALL&Article=All&Title=News&Type=doc&List=%7b66fa9b18-776a-4e91-9f80-    30195001386c%7d%23%7b679e913e-6301-4bc4-9fd9-a788b926f565%7d%23%7b0e65f37f-1129-4c78-8f59-3db5f96409fd%7d%23%7bdd7c290d-5f17-43b7-b6fd-50089368e090%7d%23%7b4790a972-c55f-46a5-8020-396780eb8506%7d%23%7b6b67c085-7c25-458d-8a98-373e0ac71c52%7d%23%7be3b71b9c-30ce-47c0-8bfb-f3224e98b756%7d%23%7b25853d98-37d7-4ba2-83f9-78685f2070df%7d%23%7b14c41f90-c462-44cf-a773-878521aa007c%7d%23%7b7ceaf3bf-d501-4f60-a3e4-2af84d0e1528%7d%23%7baf17e955-96b7-49e9-ad8a-7ee0ac097f37%7d%23%7b3faca1d0-be40-445c-a577-c742c2d367a8%7d%23%7b6296a8d6-7cab-4609-b7f7-b6b7c3a264d6%7d%23%7b43e2b52d-e4f1-4628-84ad-0042d644deaf%7d"

# Parse the RSS feed
feed = feedparser.parse(rss_url)

# view the entire feed, one entry at a time
for post in feed.entries:
    # Create variables from posts
    link = post.link
    title = post.title
    # Add the link to the dictionary
    n += 1
    links[n] = link

for k,v in links.items():
    # Open RSS feed
    page = urllib.urlopen(v).read()
    page = str(page)
    soup = BeautifulSoup(page)

    # Find all of the text between paragraph tags and strip out the html
    page = soup.find('p').getText()

    # Strip ampersand codes and WATCH:
    page = re.sub('&\w+;','',page)
    page = re.sub('WATCH:','',page)

    # Print Page
    print(page)
    print(" ")

    # To stop after 3rd article, just whilst testing ** to be removed **
    if (k >= 3):
        break 
```

这会产生以下输出：

```
>>> (executing lines 1 to 45 of "RSS_BeautifulSoup.py")
​Total deposits held with Guernsey banks at the end of June 2012 increased 2.1% in sterling terms by £2.1 billion from the end of March 2012 level of £101 billion, up to £103.1 billion. This is 9.4% lower than the same time a year ago.  Total assets and liabilities increased by £2.9 billion to £131.2 billion representing a 2.3% increase over the quarter though this was 5.7% lower than the level a year ago.  The higher figures reflected the effects both of volume and exchange rate factors.

The net asset value of total funds under management and administration has increased over the quarter ended 30 June 2012 by £711 million (0.3%) to reach £270.8 billion.For the year since 30 June 2011, total net asset values decreased by £3.6 billion (1.3%).

The Commission has updated the warranties on the Form REG, Form QIF and Form FTL to take into account the Commission’s Guidance Notes on Personal Questionnaires and Personal Declarations.  In particular, the following warranty (varies slightly dependent on the application) has been inserted in the aforementioned forms,

>>> 
```

问题是这是每篇文章的第一段，但是我需要展示整篇文章。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2012-10-26T13:00:41.013

你越来越近了！

```
# Find all of the text between paragraph tags and strip out the html
page = soup.find('p').getText() 
```

找到一个结果后，使用[find](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#find)（如您所见）停止。如果你想要所有的段落，你需要[find_all 。](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#find-all)如果页面格式一致（只是查看了一个），您还可以使用类似

```
soup.find('div',{'id':'ctl00_PlaceHolderMain_RichHtmlField1__ControlWrapper_RichHtmlField'}) 
```

在文章的正文中归零。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2019-05-27T15:08:27.070

这适用于文本全部包含在`<p>`标签中的特定文章。由于网络是一个丑陋的地方，因此并非总是如此。

通常，网站的文本会散布在各处，包裹在不同类型的标签中（例如，可能在 a`<span>`或 a`<div>`或 an中`<li>`）。

要[查找 DOM 中的所有文本节点](https://matix.io/extract-text-from-webpage-using-beautifulsoup-and-python/)，可以使用`soup.find_all(text=True)`.

这将返回一些不需要的文本，例如`<script>`和`<style>`标签的内容。您需要过滤掉不需要的元素的文本内容。

```
blacklist = [
  'style',
  'script',
  # other elements,
]

text_elements = [t for t in soup.find_all(text=True) if t.parent.name not in blacklist] 
```

如果您正在使用一组已知的标记，则可以标记相反的方法：

```
whitelist = [
  'p'
]

text_elements = [t for t in soup.find_all(text=True) if t.parent.name in whitelist] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-25T10:32:14.960

**获取文本**

```
htmldata = getdata("https://www.geeksforgeeks.org/how-to-automate-an-excel-sheet-in-python/?ref=feed") 
soup = BeautifulSoup(htmldata, 'html.parser') 
data = '' 
for data in soup.find_all("p"): 
    print(data.get_text()) 
```