# StackOverflow 问答 10431000-10431999

# c# - ffmpeg c# asp.net help on ProcessStartInfo

> ID：10431012
> 
> 赞同：1
> 
> 时间：2012-05-03T12:04:27.863
> 
> 标签：c#, asp.net, video, ffmpeg

我编写了代码以使用 ffmpeg 在 c#asp.net 中转换文件。执行时显示错误为“文件名、目录名或卷标语法不正确”，但我的路径是正确的。那么解决这个问题的方法是什么？

```
ProcessStartInfo info = new ProcessStartInfo("e:\ffmpeg\bin\ffmpeg.exe", "-i cars1.flv -same_quant intermediate1.mpg");

process.Start(); 
```

我尝试了另一种方法，如下所示。但这也行不通。

```
ProcessStartInfo info = new ProcessStartInfo("ffmpeg.exe", "-i cars1.flv -same_quant intermediate1.mpg"); 
```

请帮助我使用 c# asp.net 中的 ffmpeg 将一种视频文件格式转换为另一种视频文件格式的示例代码。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:11:35.507

有可用的包装库

[http://www.ffmpeg-csharp.com/](http://www.ffmpeg-csharp.com/)

另请参阅

[http://www.codeproject.com/Articles/24995/FFMPEG-using-ASP-NET](http://www.codeproject.com/Articles/24995/FFMPEG-using-ASP-NET)

[https://stackoverflow.com/questions/tagged/asp.net+c%23+video](https://stackoverflow.com/questions/tagged/asp.net+c%23+video)

```
 string apppath = Request.PhysicalApplicationPath; 

    string outf = Server.MapPath(".");

    string fileargs = "-i" + " " + "\"C:/file.mp4 \"" + " " + "\"C:/files/test.flv \"";

    Process myProcess = new Process();

    myProcess.StartInfo.FileName = Server.MapPath(".")+"//ffmpeg.exe";

    myProcess.StartInfo.Arguments = fileargs;

    myProcess.StartInfo.UseShellExecute = false;

    myProcess.StartInfo.CreateNoWindow = false;

    myProcess.StartInfo.RedirectStandardOutput = false;

    myProcess.Start();

    myProcess.WaitForExit(50 * 1000); 
```

谢谢

迪普

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:10:20.010

`\`路径中的反斜杠 ( ) 被认为是[转义序列](http://msdn.microsoft.com/en-us/library/h21280bw.aspx)的开始。为防止这种情况，请使用双反斜杠 ( `\\`)，或在字符串前面加上`@`.

```
ProcessStartInfo info = new ProcessStartInfo("e:\\ffmpeg\\bin\\ffmpeg.exe", 
                         "-i cars1.flv -same_quant intermediate1.mpg"); 
```

或者：

```
ProcessStartInfo info = new ProcessStartInfo(@"e:\ffmpeg\bin\ffmpeg.exe", 
                         "-i cars1.flv -same_quant intermediate1.mpg"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:11:54.073

您需要在路径中有反斜杠，请参见下面这是我使用 ffmpeg.exe 创建视频的方式

```
 string sConverterPath = @"C:\ffmpeg.exe";
        string sConverterArguments = @" -i ";
        sConverterArguments += "\"" + sAVIFile + "\"";
        sConverterArguments += " -s " + iVideoWidth.ToString() + "x" + iVideoHeight.ToString() + " ";
        sConverterArguments += " -b " + iVideoBitRate.ToString() + "k -ab " + iAudioBitRate.ToString() + "k -ac 1 -ar 44100 -r 24 -absf remove_extra ";
        sConverterArguments += "\"" + sOutputFile + "\"";

        Process oProcess = new Process();
        oProcess.StartInfo.UseShellExecute = true;
        oProcess.StartInfo.Arguments = sConverterArguments;
        oProcess.StartInfo.FileName = sConverterPath; 
```

# sip - 星号重定向呼叫是否可能

> ID：10431016
> 
> 赞同：2
> 
> 时间：2012-05-03T12:04:35.420
> 
> 标签：sip, asterisk

我有 2 个 sip 电话号码：sip1 和 sip2。如果有人在 sip1 上呼叫我而我不在线，我想将呼叫重定向到 sip2。如何在 extensions.conf 中配置它？

```
exten => sip1,1,Dial(SIP/sip1,20,tr)
exten => sip1,2,Voicemail()
exten => sip1,3,Hangup() 
```

如何更改 extensions.conf 文件以在客户端不在线的情况下进行重定向调用。如果客户在线但他没有接听，我希望电话进入语音信箱。如果他不在线，呼叫将被重定向到第二个电话号码。

需要一些建议。欣赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T18:49:19.163

您在示例配置文件中有示例，为什么不阅读？

这是它的样子

```
[main]
exten => _sip1,1,Dial(SIP/sip1,20)                          ; Ring the interface, 20 seconds maximum
exten => _sip1,n,Goto(checkstatus-sip1,${DIALSTATUS},1)           ; Jump based on status (NOANSWER,BUSY,CHANUNAVAIL,CONGESTION,ANSWER)
[checkstatus-sip1]
exten => NOANSWER,1,Goto(main,sip2,1)        ; If unavailable, send to voicemail w/ unavail announce
exten => BUSY,1,Voicemail(${mbx},b)            ; If busy, send to voicemail w/ busy announce
exten => _.,1,Goto(BUSY,1);if other 
```

# android - 如何在android中使用google track获取推荐人？

> ID：10431018
> 
> 赞同：5
> 
> 时间：2012-05-03T12:04:43.497
> 
> 标签：android, tracking

我想实现安装引荐来源网址跟踪并希望引荐来源网址参数并存储在后端数据库中我已经看到了许多示例或问题，例如[获取 Android Google Analytics 引荐来源标签](https://stackoverflow.com/questions/3817030/get-android-google-analytics-referrer-tag)或[Android Google Analytics Campaign 跟踪没有出现](https://stackoverflow.com/questions/7233875/android-google-analytics-campaign-tracking-not-appearing)但没有获得我生成链接的方式并尝试代码

```
 package SimpleDemo.ReferralTrack; 

   import java.io.UnsupportedEncodingException;
   import java.net.URLDecoder;
   import java.util.HashMap;
   import java.util.Map;

   import android.content.BroadcastReceiver;
   import android.content.Context;
   import android.content.Intent;
   import android.content.SharedPreferences;
   import android.os.Bundle;

  public class ReferralReceiver extends BroadcastReceiver
   {
@Override
public void onReceive(Context context, Intent intent)
{
    // Workaround for Android security issue: http://code.google.com/p/android/issues/detail?id=16006
    try
    {
        final Bundle extras = intent.getExtras();
        if (extras != null) {
            extras.containsKey(null);
        }
    }
    catch (final Exception e) {
        return;
    }

    Map<String, String> referralParams = new HashMap<String, String>();

    // Return if this is not the right intent.
    if (! intent.getAction().equals("com.android.vending.INSTALL_REFERRER")) { //$NON-NLS-1$
        return;
    }

    String referrer = intent.getStringExtra("referrer"); //$NON-NLS-1$
    if( referrer == null || referrer.length() == 0) {
        return;
    }

    try
    {    // Remove any url encoding
        referrer = URLDecoder.decode(referrer, "x-www-form-urlencoded"); //$NON-NLS-1$
    }
    catch (UnsupportedEncodingException e) { return; }

    // Parse the query string, extracting the relevant data
    String[] params = referrer.split("&"); // $NON-NLS-1$
    for (String param : params)
    {
        String[] pair = param.split("="); // $NON-NLS-1$
        referralParams.put(pair[0], pair[1]);
    }

    ReferralReceiver.storeReferralParams(context, referralParams);
}

private final static String[] EXPECTED_PARAMETERS = {
    "utm_source",
    "utm_medium",
    "utm_term",
    "utm_content",
    "utm_campaign"
};
private final static String PREFS_FILE_NAME = "ReferralParamsFile";

/*
 * Stores the referral parameters in the app's sharedPreferences.
 * Rewrite this function and retrieveReferralParams() if a
 * different storage mechanism is preferred.
 */
public static void storeReferralParams(Context context, Map<String, String> params)
{
    SharedPreferences storage = context.getSharedPreferences(ReferralReceiver.PREFS_FILE_NAME, Context.MODE_PRIVATE);
    SharedPreferences.Editor editor = storage.edit();

    for(String key : ReferralReceiver.EXPECTED_PARAMETERS)
    {
        String value = params.get(key);
        if(value != null)
        {
            editor.putString(key, value);
        }
    }

    editor.commit();
}

/*
 * Returns a map with the Market Referral parameters pulled from the sharedPreferences.
 */
public static Map<String, String> retrieveReferralParams(Context context)
{
    HashMap<String, String> params = new HashMap<String, String>();
    SharedPreferences storage = context.getSharedPreferences(ReferralReceiver.PREFS_FILE_NAME, Context.MODE_PRIVATE);

    for(String key : ReferralReceiver.EXPECTED_PARAMETERS)
    {
        String value = storage.getString(key, null);
        if(value != null)
        {
            params.put(key, value);
        }
    }
    return params;
}
} 
```

之后我尝试了我的活动

```
 SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(DemoActivity.this);
              String  referrers1 =preferences.getString("ga_campaign", "0");
              Map<String, String> retrieveReferralParams=ReferralReceiver.retrieveReferralParams(DemoActivity.this);
              String  referrers2= retrieveReferralParams.get("utm_source");
              String  referrers3= retrieveReferralParams.get("utm_medium");
              String  referrers4= retrieveReferralParams.get("utm_term");
              String  referrers5= retrieveReferralParams.get("utm_content");
              String  referrers6= retrieveReferralParams.get("utm_campaign");
              tv.setText(referrers1+" "+referrers2+" "+referrers3+" "+referrers4+" "+referrers5+" "+referrers6+" "); 
```

单击按钮但未获得所需的输出

我想要类似的东西

```
"https://play.google.com/store/apps/details?id=com.lifestreet.android.TestInstallationIntent&referrer=bb%3DAAAAAAAAAA&feature=search_result%22"  
 Ans     

   referrer=bb 
```

任何帮助我都非常感谢提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T07:22:45.650

不确定 Google 是否允许您发送任意信息。尝试使用生成器创建 url。

[https://developers.google.com/analytics/devguides/collection/android/devguide#google-play-builder](https://developers.google.com/analytics/devguides/collection/android/devguide#google-play-builder)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-04T13:35:58.777

我有一个类似的问题。发现它是生命周期问题：在我的应用程序的 onResume() 之后，在同一主线程上调用 install_referrer 接收器的 onReceive，因此在 onResume() 期间读取引荐来源文件的任何尝试都会失败。这是证明它的 logcat，这在使用 Android 4.2.1 和 4.4.2 的 2 台设备上是 100% 可重复的：

首先，play store 在单独的（store）进程中广播指向包的referrer：

```
11-04 14:17:51.558: D/Finsky(1737): [1] ReferrerRebroadcaster.doBroadcastInstallReferrer: Delivered referrer for com.xxx.demo 
```

应用程序 onResume() - 仍然没有激活广播接收器！小号

```
11-04 14:17:51.888: D/XXX Main Activity(22730): onResume 
```

该应用程序尝试读取引荐来源网址（接收者应使用 getSharedPreferences.putString 存储该引荐来源网址）：

```
11-04 14:17:51.958: I/XXX(22730): Extracted install referrer: 
```

只是现在接收器在主线程上被调用，并且很快就会尝试将引用者写入文件：

```
11-04 14:17:51.918: I/XXX(22730): Received install referrer: abcdefg 
```

如您所见， onResume() 没有机会实际读取文件，因此提取不会产生任何结果。但是，如果我关闭应用程序并重新打开它，onResume 现在可以找到该文件并处理引荐来源字符串 - 但不是在首次启动时 :)

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-03T17:09:48.613

Google Analytics 在其 SDK 中使用任意常量。对于 campaing_source 是 &cs。

# javascript - 在 github 上建立一个演示页面

> ID：10431022
> 
> 赞同：25
> 
> 时间：2012-05-03T12:04:55.477
> 
> 标签：javascript, jquery, github

有没有办法在 github 项目上设置演示页面？

我看到人们在谷歌代码上有演示页面，有没有办法在 github 上也这样做？

我只需要它做`html` `css`，`js`没有服务器端。

我正在尝试设置一个多页 ajax 插件，所以 jsfiddle 不会真正有帮助。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-03T12:09:51.110

尝试使用自定义域查看[github 页面：http:](http://pages.github.com/) [//help.github.com/pages/](http://help.github.com/pages/)

> **自定义域**
> 
> 假设您拥有域名 example.com。此外，您的 GitHub 用户名是“charlie”，并且您在[http://charlie.github.com/](http://charlie.github.com/)上发布了一个用户页面。现在您想在浏览器中加载[http://example.com/并让它显示来自](http://example.com/)[http://charlie.github.com/的内容](http://charlie.github.com/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-03T12:22:29.427

如果您在 github 中的用户名是 john，那么您需要创建一个名为`john.github.com`. 您可以按照创建其他存储库的方式进行操作。然后将文件提交到该存储库。如果您将`index.html`文件放在该存储库中，那么当人们访问时，`http://john.github.com`他们应该会看到该`index.html`文件。

所以你需要做的是，创建一个名为的存储库`<your_username>.github.com`并将你的演示文件放在那里。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-02T10:48:31.067

登录到您的 GitHub 并创建一个名为 username.github.io 的新存储库，其中 username 是您在 GitHub 上的用户名（或组织名称）。创建你的页面（创建你的 html css 文件）并将文件推送到 github 这将为你创建一个页面我在这里找到了一个很好的例子[http://wiki.workassis.com/how-to-create-github-page/](http://wiki.workassis.com/how-to-create-github-page/)

参考：[https ://pages.github.com/](https://pages.github.com/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-03-07T07:47:15.370

您可以添加“<a href="http://htmlpreview.github.io/" rel="nofollow noreferrer">http://htmlpreview.github.io/?” 在您的“ [https://github.com/yourname/xxx.html](https://github.com/yourname/xxx.html) ”之前。您可以检查设置选项以确认您的页面已推送。

# java - 如果 Tomcat 作为 Windows 服务运行，为什么没有本地 MBeanServer？

> ID：10431028
> 
> 赞同：3
> 
> 时间：2012-05-03T12:05:15.507
> 
> 标签：java, tomcat, jmx

如果 Tomcat 作为 Windows 服务运行（使用 Windows Tomcat 安装程序创建），则不能简单地使用`-Dcom.sun.management.jmxremote`. 您还需要设置`-Dcom.sun.management.jmxremote.port=<port>`. 此处解释了这一点：[Unable to use JConsole with Tomcat running as windows service](https://stackoverflow.com/questions/503057/unable-to-use-jconsole-with-tomcat-running-as-windows-service)

但是，我在任何地方都没有找到解释为什么会这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T20:53:49.730

当我写下这个问题时，我有点迷茫和困惑。这是我在此期间学到的。通常 Tomcat Windows 服务在本地系统帐户下运行。这就是大家闹得沸沸扬扬的主要原因。

如果您只是`-Dcom.sun.management.jmxremote`在服务配置的 JVM 设置中进行设置，则确实*会启用 JMX。*如果您有一个在同一个 JVM 实例中运行的 JMX 客户端（例如，因为它已嵌入到应用程序本身中），您可以获得类似的`MBeanServer`东西：`MBeanServerFactory.findMBeanServer(<specific-agent-ID-or-null>)`. 但是，JConsole 不会列出这个 Tomcat 进程。这一切都在这里解释：[https](https://blogs.oracle.com/nbprofiler/entry/monitoring_java_processes_running_as) ://blogs.oracle.com/nbprofiler/entry/monitoring_java_processes_running_as 。

如其他地方所述，如果这还不够好，您还需要设置`-Dcom.sun.management.jmxremote.port=<port>`. 然后，您可以使用 JConsole 连接到 JMX `localhost:<port>`。在 Java 代码中，这可以通过以下方式实现：

```
JMXServiceURL target = new JMXServiceURL("service:jmx:rmi:///jndi/rmi://localhost:<port>/jmxrmi");
JMXConnector connector = JMXConnectorFactory.connect(target);
connector.getMBeanServerConnection(); 
```

# iphone - 如何通过代码在 iphone 中创建 .doc 或 word 文件

> ID：10431030
> 
> 赞同：1
> 
> 时间：2012-05-03T12:05:33.790
> 
> 标签：iphone, ios, ms-word, .doc

> **可能重复：**
> [如何从 iPhone sdk 中收集的数据以编程方式生成 word 文件](https://stackoverflow.com/questions/9409859/how-to-generate-a-word-file-programmatically-from-collected-data-in-iphone-sdk)

我的要求是在我的 iOS 应用程序的 Word 文件中生成报告。

我搜索了它，但没有找到任何合适的方法来做到这一点。我发现`libopc`这不是很有帮助。

有没有人有任何适当的方法或任何 sdk 可以从给定的数据集创建*.doc*文件来做到这一点？

# django - 有没有办法在 django 中的每个 INSERT/UPDATE/DELETE 之前执行原始 sql？

> ID：10431033
> 
> 赞同：0
> 
> 时间：2012-05-03T12:05:51.043
> 
> 标签：django, audit, dml

我需要在 db 范围内设置变量，什么将包含 django 用户 ID 什么使 DML 查询。像这样的东西：

```
CREATE OR REPLACE FUNCTION set_user_id(auser_id integer)
  RETURNS void AS
  'GD["user_id"] = auser_id'
  LANGUAGE plpythonu VOLATILE
  COST 100; 
```

并在每个 DML 之前调用此函数以将该用户 ID 传递给审计触发器；有没有简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T14:18:10.593

如果您只需要对某些模型执行此操作，那么您应该覆盖[`save`](https://docs.djangoproject.com/en/dev/topics/db/models/#overriding-model-methods)模型的方法。

如果无论正在使用的模型如何，但在访问特定数据库的任何模型中都需要这样做，那么您应该通过为您的特定数据库调整一个来创建自己的 db 后端变体（在这种情况下，我怀疑它的 postgresql ）。

这样的事情应该这样做：

```
from django.db.backends.postgresql_psycopg2.base import *

class DatabaseWrapper(DatabaseWrapper):
    def _cursor(self):
        cursor = super(DatabaseWrapper, self)._cursor()
        q = " ... enter your query here ..."
        cursor.execute(q % (arg1,arg2))
        return cursor 
```

# html - CSS 右对齐列表

> ID：10431037
> 
> 赞同：20
> 
> 时间：2012-05-03T12:06:14.397
> 
> 标签：html, css

我应该如何将列表向右对齐？文本完全对齐，但项目**符号不**对齐。使用 CSS 是否有一种简单易行的方法？

**代码：**

```
<ul style="text-align: right">
<li>Item 1</li>
<li>Item 2</li>
<li>Item 3</li>
</ul> 
```

即使我将 LI 元素的规则直接与 rigth 对齐，它也不起作用。

**编辑** 我附上了一张图片，显示了我想要实现的目标： ![右边是我想要的。 左边是我的](../Images/aa252f845737c65cecf5d9e07fa10bc5.png)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-03T12:16:28.123

如果您需要将项目符号与文本对齐，您可以使用该`list-style-position`属性，如下所示：

```
.theList
{
    text-align: right;
    list-style-position: inside;
}​ 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-05-03T12:08:06.303

使用方向：

```
direction: rtl; 
```

它通常用于从右到左的语言。

编辑：

将每个浮动到右侧并清除两者。

```
float: right;
clear: both; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T12:23:27.873

如果我正确理解您的要求，那么只需正确浮动 li 元素就足够了：http: [//jsfiddle.net/Jxzs4/1/](http://jsfiddle.net/Jxzs4/1/)

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-05-03T12:20:41.333

```
<ul style="float:right; text-align:left; list-style:none;"> 
```

检查这个......

如果你想要子弹然后删除`list-style:none;`

# javascript - IE7上的jQuery dataTables非常慢

> ID：10431038
> 
> 赞同：0
> 
> 时间：2012-05-03T12:06:20.050
> 
> 标签：javascript, jquery, internet-explorer-7, datatables, jquery-datatables

我有一个 jquery 数据表在 Firefox 和 chrome 上运行良好，但在 IE7 上运行速度很慢。我正在使用数据表版本 1.7.6。

这是有 9 列的表：

```
this.dataTable = $('#sar-requests-table').dataTable({
    "aaSorting": [[ 4, "desc" ]],
    "aoColumnDefs": [{
        "fnRender": function ( row ) {
            return renderWorkOrderIdTableCell(row.aData[0]);
         },
         "aTargets": [0]
     }],
     "bProcessing": true,
     "bJQueryUI": true,
     "oLanguage": {
         "sSearch": "Filter:"
     }
}); 
```

当我调用 fnReloadAjax 插件时会发生缓慢。

```
 this.dataTable.fnReloadAjax("/api/sar/?_=" + Math.random() + "&" + query); 
```

此调用对 Java EE 应用程序进行查询，并带来最多 5000 条记录。我调试了插件并指出了需要花费大量时间的地方：

```
$.fn.dataTableExt.oApi.fnReloadAjax = function ( oSettings, sNewSource,      fnCallback,bStandingRedraw)
{
if ( typeof sNewSource != 'undefined' && sNewSource != null )
{
    oSettings.sAjaxSource = sNewSource;
}
this.oApi._fnProcessingDisplay( oSettings, true );
var that = this;
var iStart = oSettings._iDisplayStart;

 console.log('STEP 1 '+new Date());

oSettings.fnServerData( oSettings.sAjaxSource, null, function(json) {
    /* Clear the old information from the table */
    that.oApi._fnClearTable( oSettings );

    console.log('STEP 2 '+new Date());

    /* Got the data - add it to the table */
    for ( var i=0 ; i<json.aaData.length ; i++ )
    {
        that.oApi._fnAddData( oSettings, json.aaData[i] );
    }
    console.log('STEP 3 '+new Date());

    oSettings.aiDisplay = oSettings.aiDisplayMaster.slice();

    that.fnDraw( that );

    console.log('STEP 4 '+new Date());

    if ( typeof bStandingRedraw != 'undefined' && bStandingRedraw === true )
    {
        oSettings._iDisplayStart = iStart;
        that.fnDraw( false );
    } 

    console.log('STEP 5 '+new Date());

    that.oApi._fnProcessingDisplay( oSettings, false );

    /* Callback user function - for event handlers etc */
    if ( typeof fnCallback == 'function' && fnCallback != null )
    {
        fnCallback( json );
    }

    console.log('STEP 6 '+new Date());
} );
} 
```

大部分时间花在（STEP2和STEP3）和（STEP3和STEP4）之间，总共30秒（如果有5000条记录）。意思是，下面的块需要15秒；

```
for ( var i=0 ; i<json.aaData.length ; i++ )
    {
        that.oApi._fnAddData( oSettings, json.aaData[i] );
    } 
```

下面的一个需要另外 15 秒：

```
 oSettings.aiDisplay = oSettings.aiDisplayMaster.slice();
    that.fnDraw( that ); 
```

这两个块都需要不到一秒钟的时间。在 Firefox 和 chrome 上。我还尝试删除表格上的排序和单元格渲染，但没有帮助。当我输入“bpaginate：false”时，我看到了更好的性能，但它不是 5000 条记录的选项。

任何建议表示赞赏。

编辑：我尝试使用 1.8.0 和 1.9.1 版本，但它们都没有帮助。

# pdf - pdf中令人不安的伪影

> ID：10431039
> 
> 赞同：4
> 
> 时间：2012-05-03T12:06:20.590
> 
> 标签：pdf, gnuplot, eps

在用填充曲线绘制图时，我遇到了一个问题。在填充区域之间，似乎存在“间隙”。但是，这些伪影不会出现在打印件上，而是取决于查看器和缩放选项。在 Gnuplot 中，我使用 eps 终端，eps 文件看起来很棒，但是当我转换为 pdf 时会出现线条。它要么在绘图后直接完成，要么在将乳胶文档从 dvi 转换为 pdf 时完成。由于现在大多数文件都在这里展示，这是一个问题。当我在 Gnuplot 中直接使用 pdfcairo 终端时也会出现该问题，因此它不是由单独的转换（尝试 epstopdf 和 ps2pdf）引起的。

我附上了“acroread”中显示的绘图的屏幕截图（其他pdf查看器中的问题相同）。

有没有人知道如何摆脱它但保持图形矢量化？

![垂直线](../Images/1de267a65e7a505c9065153576d3cc12.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-06-28T22:03:23.143

我刚刚遇到了同样的问题。显然，两条曲线之间的填充是作为一组不完全相互接触的多边形完成的，因此在某些 PDF 查看器上可以看到细白线。

解决此问题的一种方法是绘制这些多边形边界。首先在 gnuplot 中定义 min 和 max 函数：

```
min(x, y) = x < y ? x : y
max(x, y) = x > y ? x : y 
```

然后，假设“数据文件”的第 1 列包含您的 x 值，并且第 2 列和第 3 列包含曲线 2 和 3 的 y 值，请编写：

```
plot "datafile" using 1:2:3 with filledcurves lc rgb "gray", \
"" using 1:2:(min($2, $3)):(max($2, $3)) with yerrorbars ps 0 lt 1 \
lc rgb "gray" lw 0.5 
```

第一个绘图指令以灰色填充曲线之间的空间。第二条绘图指令在曲线 (2) 上的每个 x 值 (1) 处绘制大小为零 (ps 0) 的点，其中细线 (lw 0.5)、连续 (lt 1)、灰色 (lc rgb "gray")、垂直误差线 ( yerrorbars) 从曲线 2 和 3 的较低到较高。

这涵盖了白线。为了获得最佳结果，您可能需要对钢筋的厚度进行试验（例如，lw 0.6、lw 0.2）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-01-13T16:59:42.703

这个问题仍然存在于 Gnuplot 5.0.4 和至少我用来输出 PDF 的 cairolatex 终端中。我还想为两条曲线之间的区域着色，在我的例子中定义为函数。

当我使用类似的东西时

```
f(x) = 2 + sin(x)
g(x) = cos(x)
plot '+' using 1:(f($1)):(g($1)) with filledcurves closed 
```

我得到了与问题相同的垂直白线。

对于一条总是在另一条之上的曲线，一个简单的解决方案是让 Gnuplot 用所需的颜色填充从上部曲线到 x 轴的区域，然后从下部曲线向下涂上白色：

```
f(x) = 2 + sin(x)
g(x) = cos(x)
plot f(x) with filledcurves x1, g(x) w filledc x1 fs lc rgb "white" 
```

显然，这种填充曲线样式（不是在曲线之间，而是在曲线和轴之间）避免了梯形伪影。这可以很容易地扩展为绘制数据文件和多个堆叠治疗，就像问题中一样。只需从上到下绘制，并在最低曲线和 x 轴之间的空白区域用白色完成。

对于重叠曲线，像 françois-tonneau 的答案中的最小和最大曲线的构造可能会奏效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-10-03T09:45:42.043

此问题已通过 gnuplot 5.2 修复，请参阅[https://sourceforge.net/p/gnuplot/patches/749/](https://sourceforge.net/p/gnuplot/patches/749/)

实际的问题是，填充曲线以前被绘制为许多四边形，这会导致由于抗锯齿在许多查看器中出现伪影（白色条纹）。

由于 5.2 版填充曲线被渲染为单个多边形，从而防止了这些问题（参见上面链接的问题）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T12:13:10.930

如果您谈论的是红色和青色位，则间隙可能是由 RGB 屏幕上的红色 + 青色 = 白色引起的错觉。也许没有间隙，但由于像素的接近，边界区域显示为白色。

截取屏幕截图并将其放大，以便您可以看到感知间隙周围的各个像素。

如果是这种情况，也许为相邻颜色选择不同的配色方案会消除这种效果。除了红色和青色位之外，我当然看不到任何与您的描述相符的东西。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-06-10T09:06:37.093

从[https://groups.google.com/forum/#!topic/comp.graphics.apps.gnuplot/ivRaKpu5cJ8](https://groups.google.com/forum/#!topic/comp.graphics.apps.gnuplot/ivRaKpu5cJ8)，这似乎是一个纯粹的 Gostscript 问题。

使用 Gnuplot 的 eps 终端并将 eps 文件转换为 pdf

```
epstopdf -nogs <file.eps> -o <file.pdf> 
```

解决了我系统上的问题。在相应的手册页中，“-nogs”选项指示 epstopdf 不要使用 Gostscript。

# ios - 简单 gui 元素的性能：石英 2d 还是 png？

> ID：10431044
> 
> 赞同：0
> 
> 时间：2012-05-03T12:06:43.373
> 
> 标签：ios, quartz-2d

我的 iOS 应用程序中有一些简单的按钮。我可以用石英 2d 正确地绘制它们，但我也可以使用 png-slices 来构建它们。

对 iPad 的 CPU 和分配有什么好处？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:19:07.277

如果我是你，我也会考虑分辨率独立性和应用程序大小的因素。甚至 Apple 也建议使用 Quartz 绘制简单的 UI 元素（参见 WWDC 2011 - Practical Drawing）。大多数 Apple 自己的应用程序也是这样做的（股票应用程序、天气应用程序、iPhoto 的一个很好的部分等）

性能方面，我在这里（[https://github.com/pkluz/PKCoreTechniques](https://github.com/pkluz/PKCoreTechniques)）进行了一些测试，方法是仅在 Quartz 中创建一个 AngryBird，其贝塞尔曲线的度数相当高。现在对于 iPad 3，我必须提供相当大的图像才能这样做（> 2-3 MB 仅用于所述设备上的一个图像），但对于 Quartz，它只是几个字节的代码。大部分时间，《愤怒的小鸟》的渲染速度比加载图像慢 15-18%，但我认为如果像素密度进一步增加，这种情况会迅速改变。对于简单的形状，Quartz 在大多数情况下应该比从包中加载图像更快。但请记住，增长不是线性的，因此根据复杂性和大小，这些可能会迅速改变以支持图像。

还记得 iPad 3 推出时应用程序的大小是如何翻倍的。Quartz 不会有这个问题，并且您的应用程序无需任何额外工作即可为高分辨率做好准备:)

我建议人们遵循的经验法则是：*“如果我不能立即围绕一个物体的几何描述，我会使用图像。”*

# javascript - 在 javascript 而不是 CSS(hover) 中更改链接颜色 --- 适用于 jsfiddle 而不是浏览器？

> ID：10431046
> 
> 赞同：0
> 
> 时间：2012-05-03T12:06:50.787
> 
> 标签：javascript, jquery, css, hover, onmouseover

感谢您的所有帮助。它在 jsfiddle/jsbin（翻转和翻转）中完美运行，但我似乎无法让它在浏览器中实际运行。

JavaScript - 在你们的帮助下进行了一些编辑，以匹配我如何学习 Math.random 等

```
colors = ['red','blue','green','gray','black','yellow'];
$(".test a").hover(function() {
  randomColor = Math.floor(Math.random() * colors.length - 1)
  $(this).css('color',colors[randomColor])
    }, function() {
      $(this).css('color', '#000000')
}); 
```

HTML（实际上使用不同的 html，但这是从 jsbin 中提取的并且不起作用）

```
<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>JS Bin</title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.2/jquery-ui.min.js"></script>  
<script type="text/javascript" src="randomcolor.js"></script>
<!--[if IE]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<style>
  article, aside, figure, footer, header, hgroup, 
  menu, nav, section { display: block; }
</style>
</head>
<body>
    <div class="test"><a href="http://test.com">WORKKKKK</a></div>
</body>
</html> 
```

与浏览器代码的唯一区别是我在 randomcolor.js 文件中有 js，在标题中调用

```
<script type="text/javascript" src="randomcolor.js"></script> 
```

从我在网上找到的内容来看，这与“onload”有关吗？我该如何实施？我也试过把这个脚本直接放在正文中的html中，我仍然无法让它工作。

但是再次感谢你们最初的帮助，让它在 jsfiddle 中正常工作绝对是一个好的开始！

也只是为了提供尽可能多的信息 - 尝试添加此 onload 但仍然无法正常工作

```
$(window).load(function(){
    colors = ['#ffffff', 'blue', 'green', 'gray', 'black', 'yellow'];
    $(".test a").hover(function() {
        randomColor = Math.floor(Math.random() * colors.length - 1)
        $(this).css('color', colors[randomColor])
    }, function() {
        $(this).css('color', '#000000')
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:08:53.603

你应该使用`$("div.input")`而不是`$("div input")` （见中间的点）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:14:12.193

这样的事情会有所帮助

```
<div class="test"><a href="http://test.com">Test</a></div>

colors = ['red','blue','green','gray','black','yellow'];
$(".test a").hover(function() {
  rand = parseInt(Math.random()*10)%colors.length
  $(this).css('color',colors[rand])
}); 
```

请检查

[http://jsfiddle.net/sethunath/WNGKv/](http://jsfiddle.net/sethunath/WNGKv/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:12:06.083

试试这个[http://jsfiddle.net/hdsuT/](http://jsfiddle.net/hdsuT/)

```
$("div.input").hover(function() {
  $(this).find('a').addClass("blue");
}, function() {
  $(this).find('a').removeClass("blue");
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T17:05:17.847

这是做到这一点的方法

```
function changcolor(){
    var link=document.getElementById("iDofyourLink").style.color = "#ffffff";
}

<a href="" onmouseover="changcolor()" id="iDofyourLink"></a> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-04T03:45:32.077

耶。我想到了。希望没有人在做这件事，我也没有浪费任何人的时间。我在这里发布它，所以如果其他人将来有这个问题......

我查看了草稿视图以查看 jsfiddle 的来源（在询问之前应该想到这一点）。它显示为 javascript -->

```
<script type='text/javascript'>//<![CDATA[ 
$(window).load(function(){
colors = ['red', 'blue', 'green', 'gray', 'black', 'yellow'];
$(".test a").hover(function() {
    randomColor = Math.floor(Math.random() * colors.length - 1)
    $(this).css('color', colors[randomColor])
}, function() {
    $(this).css('color', '#000000')
});
});//]]>  
</script> 
```

所以我决定将 randomcolor 作为一个单独的文件离开，为了让它工作，我把 CDATA 像这样 -->

```
<script type="text/javascript" src="randomcolor.js"><![CDATA[//]]></script> 
```

所以....如果其他人试图让这样的代码工作（随机颜色，链接悬停），这是对我有用的最终代码（与我使用它的实际文档不同）。

HTML

```
<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>JS Bin</title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.2/jquery-ui.min.js"></script>  
<script type="text/javascript" src="randomcolor.js"><![CDATA[//]]></script>
</head>
<body>
    <div class="test"><a href="http://test.com">Please work</a></div>
</body>
</html> 
```

JS

```
$(window).load(function(){
colors = ['red', 'blue', 'green', 'gray', 'black', 'yellow'];
$(".test a").hover(function() {
    randomColor = Math.floor(Math.random() * colors.length - 1)
    $(this).css('color', colors[randomColor])
}, function() {
    $(this).css('color', '#000000')
});
}); 
```

我希望这对其他人有帮助！

# ajax - Grails 中的 jQuery Ajax 请求

> ID：10431049
> 
> 赞同：4
> 
> 时间：2012-05-03T12:07:09.720
> 
> 标签：ajax, jquery, grails

如何使用 jQuery 在 Grails 页面中发出 Ajax 请求？

如何设置 URL 命中 Grails 控制器上的方法？假设控制器：'airport'，动作：'getJson'，动作的输入是'iata'。

我可以将静态 url 设置为`http://localhost:8080/trip/airport/getJson`但无法弄清楚如何专门为 iata 传递输入。

我对 Grails 相当陌生，并且遵循 IBM 的“掌握 Grails”教程系列。建议我一些关于在 Grails 中使用 jQuery 的好教程。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-03T13:55:27.660

在 jquery 中使用 $.ajax 方法

```
$.ajax({
    url:"${g.createLink(controller:'airport',action:'getJson')}",
    dataType: 'json',
    data: {
        iata: '.............',
    },
    success: function(data) {
        alert(data)
    },
    error: function(request, status, error) {
        alert(error)
    },
    complete: function() {
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T13:54:54.953

它的：

```
$.ajax({
  url: '/trip/airport/getJson',
  data: {paramName: 'iata'}
}); 
```

使用您期望的参数名称，而不是我使用过的参数名称`paramName`。

# asp.net-mvc-3 - 重定向到 returnURL 不起作用

> ID：10431050
> 
> 赞同：1
> 
> 时间：2012-05-03T12:07:15.960
> 
> 标签：asp.net-mvc-3

参考[这个发布的问题](https://stackoverflow.com/questions/7402701/redirecturl-not-working)

给出的答案对我不起作用，我在这里遇到同样的问题。

我也在使用 aspnet 身份验证，用户可以尝试导航到网站上的任何页面，特别是用户导航到 /mycontroller/myaction/25 之类的内容非常常见，其中 25 是帐户或产品标识符该用户经常使用。

如果用户在尝试访问该 url 时当前未通过身份验证，他们将被重定向到登录屏幕。登录后，redirect(returnURL) 不会将用户导航到请求的页面。该页面停留在登录屏幕上。

用户在登录前粘贴到地址栏中的 url 可能是：

```
http://localhost:4082/Account/LogOn?ReturnUrl=%2fProduct%2fEdit%2f59 
```

输入凭据并调试后看到凭据通过了身份验证，URL是一样的

```
http://localhost:4082/Account/LogOn?ReturnUrl=%2fProduct%2fEdit%2f59 
```

stock mvc 项目和我的不同之处在于，我在登录操作中发生的不仅仅是登录。这是我的代码：（显然，我通过使每个函数变小并包含在内而破坏了某些东西）

```
public ActionResult LogOn() {
    if (User.Identity.IsAuthenticated)
        return RedirectToAction("Index", "Home");
    var model = new LogOnViewModel();
    return View(model);
}

[HttpPost]
public ActionResult LogOn(LogOnViewModel model, string returnUrl) {
    if (ModelState.IsValid) {
        try {
            return AttemptToAuthenticateUser(model, returnUrl);
        }
        catch (Exception ex) {
            ModelState.AddModelError("", ex.Message);
        }
    }
    return View(model);
}

private ActionResult AttemptToAuthenticateUser(LogOnViewModel model, string returnUrl) {
    var membershipUser = GetUserFromMembershipProvider(model.Username, false);
    var audit = new LoginAudit(model.Username, model.Password, Request.Browser.Browser, Request.Browser.Type, Request.UserHostAddress);
    VerifyUserAccountIsApprovedNotLockedOut(membershipUser);
    AuthenticateCredentials(model, audit);
    AuditLogon(audit, model.Username, true);
    return ForwardToLogonResultAction(membershipUser, returnUrl, model.RememberMe);
}

internal static MembershipUser GetUserFromMembershipProvider(string username, bool isUserCurrentlyLoggedIn) {
    var membershipUser = Membership.GetUser(username, isUserCurrentlyLoggedIn);
    if (membershipUser == null)
        throw new Exception("The user account was not found");
    return membershipUser;
}

internal static void VerifyUserAccountIsApprovedNotLockedOut(MembershipUser membershipUser) {
    if (membershipUser.IsLockedOut || !membershipUser.IsApproved)
        throw new Exception("This account has been disabled or has been locked out. Please contact Administration for support");
}

private void AuthenticateCredentials(LogOnViewModel model, LoginAudit audit) {
    if (Membership.ValidateUser(model.Username, model.Password)) { }
    else {
        AuditLogon(audit, model.Username, false);
        throw new Exception("The user name or password provided is incorrect");
    }
}

private void AuditLogon(LoginAudit audit, string username, bool isSuccessfullyAuthenticated) {
    if (isSuccessfullyAuthenticated)
        audit.Password = string.Empty;
    audit.Save(username);
}

private ActionResult ForwardToLogonResultAction(MembershipUser currentMembershipUser, string returnUrl, bool rememberMe) {
    if (IsPasswordOnAccountTemporary((Guid)currentMembershipUser.ProviderUserKey))
        return RedirectToAction("Edit", "ChangePassword");
    if (Url.IsLocalUrl(returnUrl) && returnUrl.Length > 1 && returnUrl.StartsWith("/") && !returnUrl.StartsWith("//") && !returnUrl.StartsWith("/\\")) {
        return Redirect(returnUrl);
    }
    return ForwardUserToHomePage(currentMembershipUser.UserName, rememberMe);
}

private bool IsPasswordOnAccountTemporary(Guid userGUID) {
    var profile = new Profile(userGUID);
    return profile.IsTemporaryPassword;
} 
```

更新

我尝试更改 Post 操作，以便 returnURL 检查在同一个操作中，但它仍然不起作用：

```
 [HttpPost]
    public ActionResult LogOn(LogOnViewModel model, string returnUrl) {
        if (ModelState.IsValid) {
            try {
                AttemptToAuthenticateUser(model, returnUrl);
                if (Url.IsLocalUrl(returnUrl) && returnUrl.Length > 1 && returnUrl.StartsWith("/") && !returnUrl.StartsWith("//") && !returnUrl.StartsWith("/\\")) 
                    return Redirect(returnUrl);
                return ForwardUserToHomePage(model.Username, model.RememberMe);
            }
            catch (Exception ex) {
                ModelState.AddModelError("", ex.Message);
            }
        }
        return View(model);
    } 
```

更新 2 将我的代码改回原来的方式，它工作得很好......所以这告诉我，它与我正在做的事情的顺序有关......重新排序较小的方法以匹配此操作的顺序，看看会发生什么

```
 [HttpPost]
    public ActionResult LogOn(LogOnViewModel model, string returnUrl) {
        if (ModelState.IsValid) {
            MembershipUser currentUser;
            var audit = new LoginAudit(model.Username, model.Password, Request.Browser.Browser, Request.Browser.Type, Request.UserHostAddress);
            if (Membership.ValidateUser(model.Username, model.Password)) {
                audit.Password = string.Empty;
                FormsAuthentication.SetAuthCookie(model.Username, model.RememberMe);
                currentUser = Membership.GetUser(model.Username, true);
                if (currentUser != null && currentUser.ProviderUserKey != null) {
                    var profile = new Profile((Guid)currentUser.ProviderUserKey);
                    if (profile.IsTemporaryPassword)
                        return RedirectToAction("Edit", "ChangePassword");
                }
                if (Url.IsLocalUrl(returnUrl) && returnUrl.Length > 1 && returnUrl.StartsWith("/")
                    && !returnUrl.StartsWith("//") && !returnUrl.StartsWith("/\\")) {
                    return Redirect(returnUrl);
                }
                return RedirectToAction("Index", "Home");
            }
            currentUser = Membership.GetUser(model.Username, false);
            if (currentUser != null && (currentUser.IsLockedOut || !currentUser.IsApproved)) {
                ModelState.AddModelError("", "This account has been locked out. Please contact ELM Administration for support.");
            }
            else {
                ModelState.AddModelError("", "The user name or password provided is incorrect.");
            }
            audit.Save(model.Username);
        }
        return View(model);
    } 
```

更新 3

这修复了它，我自己得到了它:-)

```
 private void AuthenticateCredentials(LogOnViewModel model, LoginAudit audit) {
        if (Membership.ValidateUser(model.Username, model.Password)) {
            FormsAuthentication.SetAuthCookie(model.Username, model.RememberMe);
        }
        else {
            AuditLogon(audit, model.Username, false);
            throw new Exception("The user name or password provided is incorrect");
        }
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-03T12:43:13.867

在您的`Logon`视图中，您是否将 url 传递给 HttpPost 方法？

```
 @using (Html.BeginForm("LogOn", "Account", new { returnUrl= Request.QueryString["ReturnUrl"] }))
 {
     //your form elements
   <input type="submit" value="Login" />
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T13:19:35.210

解决方法是比我以前更早地设置 cookie。仅当我调用设置 cookie 的 ForwardUserToHomePage 方法然后重定向到 home/index 时，我才设置 cookie。但是由于该方法从未被调用，因为我正在执行 redirect(returnUrl) 而不是设置 cookie。由于未设置，重定向失败，因为客户端认为以前尚未登录，因此登录页面实际上是“再次被击中”。

将我的 AuthenticateCredentials 方法修改为：

```
 private void AuthenticateCredentials(LogOnViewModel model, LoginAudit audit) {
        if (Membership.ValidateUser(model.Username, model.Password)) {
            FormsAuthentication.SetAuthCookie(model.Username, model.RememberMe);
        }
        else {
            AuditLogon(audit, model.Username, false);
            throw new Exception("The user name or password provided is incorrect");
        }
    } 
```

# magento - Magento：在主导航中按价格分层导航

> ID：10431053
> 
> 赞同：0
> 
> 时间：2012-05-03T12:07:27.267
> 
> 标签：magento, magento-1.6

我的主导航中有一个名为“价格”的类别，系统中的每个产品都分配给它。该类别的要点是，当您查看它时，您可以使用分层导航上的价格过滤器按价格过滤网站上的任何产品。

我想做的是将价格过滤器作为主导航上的子菜单输出，以便用户可以看到不同价格范围的下拉菜单，然后按一个并被带到已经设置过滤器的类别。

我有一个计划编辑这个函数 Mage_Catalog_Block_Navigation::_renderCategoryMenuItemHtml() 并输出这个函数 Mage_Catalog_Model_Layer_Filter_Abstract::getItems() 如果类别被称为“价格”但我看不出有一种方法可以让过滤器从我通过的类别中输出它。

在此之前有没有人做过这样的事情可以为我指明正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T06:51:54.930

如果我是你，我很想稍微改变一下计划。

可以避免使用 magento 菜单。您可以创建类别并为基于价格的过滤器呈现自定义块。

如果您扩展 Mage_Catalog_Block_Layer_Filter_Price 您可以设置您的类别并获取大部分信息。

可能最好的事情实际上可能只是构建一个小滑块。它只需要从最昂贵的价格到最便宜的价格，或者为零，然后加载带有价格的类别列表。

# php - 安全原因 url 部分隐藏？

> ID：10431064
> 
> 赞同：0
> 
> 时间：2012-05-03T12:08:15.990
> 
> 标签：php, mysql

我的程序存在很大的安全问题，我需要隐藏部分 URL。我在网上搜索了一个解决方案，没有运气。在我的程序中，我有管理员和用户帐户 - 该程序只是工人 dosie 的数据库。管理员可以查看所有文档，但其他用户只能查看其工作组中的文档。所以我的问题是，当用户来查看 dosie 时，访问信息的 URL 如下所示：“viewdosje.php?album=108。问题是用户可以简单地更改专辑 ID，他可以看到其他 dosie ，这不好。例如：

```
"viewdosje.php?album=109" 
```

通过更改 URL 中的数字，他可以查看其他文件。隐藏 URL 的那部分会很棒，还是我错了？请帮我想出一个主意。我不知道从哪里开始。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-03T12:13:10.400

您不应隐藏 url，而应验证对应用程序中资源的访问权限。收到 ID 后，在显示内容之前，执行数据库查询以查看当前登录的用户是否有权访问该资源。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T12:17:26.173

依赖“隐藏” URL 是一个糟糕的解决方案——任何可以访问该 URL 的人都可以访问您的私人数据。可以通过各种方式访问​​ URL - 嗅探网络流量（例如在不安全的 WIFI 点）、通过 JavaScript、通过猜测、通过访问浏览器历史记录以及通过各种更可怕的路线，如木马、键盘记录器等。

如果这些员工记录中的数据是敏感/私人的，在大多数国家/地区，您有法律义务对其进行充分保护；即使没有法律要求，您的公司也可能希望避免将每个人的薪水公之于众。

正确的解决方案是设计登录机制，并分配用户权限；当用户尝试访问他们无权访问的页面时，您会向他们发送相应的错误消息。PHP 中有很多解决方案 - PEAR 有一个很好的实现。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-05-03T12:14:05.630

我没有真正的 PHP 经验，所以我无能为力，但如果我用 JSP 或 Rails 解决这个问题，我可能会执行以下操作：

也许将用户身份信息存储在 cookie 中，一旦通过身份验证，将这些信息与用户数据库进行比较？如果未经授权的用户手动编辑 url，请防止页面被提供给他们。

# c# - 调用带参数的javascript函数并读取页面加载中的返回值

> ID：10431068
> 
> 赞同：1
> 
> 时间：2012-05-03T12:08:28.197
> 
> 标签：c#, javascript, asp.net, cookies

我在 default.aspx 中有 javascript 函数，如下所示：

```
 function ReadValue(Name) {
    Return value;
 } 
```

现在从 pageLoad 方法，我想传递参数并获取返回值到服务器端变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:10:37.407

要将数据从客户端发送到服务器，您必须......将数据从客户端发送到服务器。:-) 通常，您可以使用[Ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)来执行此操作，尽管还有其他方法（执行标准表单`POST`，甚至执行`GET`某种方式，尽管如果您的服务器要通过更改服务器状态来处理信息，您应该t 使用`GET`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:27:15.387

我想说最好的主意是制作一个 Javascript 函数并制作一个服务器端 Hiddenfield。访问该隐藏字段并将您的值（逗号分隔）存储在您的隐藏字段中。并在页面加载时访问它。

我这样做。

```
<asp:HiddenField ID="hdn" runat="server" />
document.getElementById("<%= hdn.ClientID%>").value = "your value"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:19:08.243

另一种方法是将值放在 jquery 中的 exmaple 的服务器端控件中，您可以执行以下操作：

```
function pageLoad(sender, args) {
$("#txtMyTextBoxID").val('my value') 
```

}

aspx：

```
<asp:TextBox ID="txtMyTextBoxID" runat="server" ClientIDMode="Static"></asp:TextBox> 
```

# wcf - “WCF 端点”的定义是什么？

> ID：10431072
> 
> 赞同：2
> 
> 时间：2012-05-03T12:08:40.000
> 
> 标签：wcf, endpoint

我知道，我知道，但在你投票结束之前，因为[这个 3 年前的问题](https://stackoverflow.com/questions/745212/what-is-an-endpoint-in-wcf)是相同的：它的答案，也不是我在万维网上阅读和重读的几十个其他答案中的任何一个，都没有真正定义这个词，至少不会在人类语言课上的语言考试中获得可观的成绩。（技术作家似乎对“是”是什么有着完全不同的想法。）

恕我直言，请考虑该线程中最受好评的答案，该答案开始

> 端点是服务公开的，在 WCF 术语中，由三件事组成......

好的，这就是它的使用方式及其属性。*它是什么？*它是一个地址、一个绑定和一个合约，就像 ABC 一样简单！任何好学生都知道“绑定”只是通信机制的一个（其他）深奥术语，而“合同”实际上是服务本身的一部分。所以端点必须由“地址”定义！

> 可以访问端点的 URL。

嗯......那么规范的洛伊答案怎么样，也在那个线程中引用。不重复上述部分的摘录：

> 端点是地址、合约和绑定的融合。每个端点都必须具有所有三个元素，并且主机公开端点。

这就好比说鸭子是鸭子走路、鸭子叫、长得像鸭子的融合，动物王国暴露了鸭子。

撇开一切不谈，这不是牛虻的好奇心：很难掌握一个解释无法解释的概念。那么，WCF**中的端点是什么？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T12:44:24.663

端点实际上是这些东西的聚合，它不是一个实体或概念，它本身就存在。

为了扩展你的鸭子类比，它更像是试图定义嘎嘎本身——嘎嘎是空气在鸭子声带上移动、穿越空间并被你的大脑解释的集合。没有“庸医”可以在这些术语之外单独指出和定义。

端点代表外部客户端调用以要求您的服务做某事并（可选）获得一些答案或返回的数据。正如 Ladislav 所说，它是“服务功能的入口点”。

为了定义客户可以要求您做什么，您需要一个合同（接口定义）*。*要定义客户端应*如何*发送数据和接收答案，您需要一个绑定。要定义必须将请求发送到的位置，您需要定义地址*。*

如果您不定义其中之一，则您没有端点。

我们简单地说“端点被暴露”作为“服务定义合约“C”的简写，在地址“A”（ABC's）处绑定“B”，这就是它的全部内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T12:16:06.673

端点是服务的物理接口（边界），具有三个主要属性

*   您必须用来访问服务的地址
*   绑定 = 您必须遵循的一组配置才能与服务通信
*   合同 = 您可以在服务上调用的一组操作

服务可以有多个具有不同 ABC 的端点。

顺便提一句。这不是 WCF 术语。WCF 从 WSDL 中引入了这个术语。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:47:58.097

端点通常是服务使用的合约——它使用的接口。

# php - PHP存储我多次调用的函数的数组列输出

> ID：10431073
> 
> 赞同：0
> 
> 时间：2012-05-03T12:08:42.537
> 
> 标签：php

我正在尝试合并代码的两个部分。为此，我必须将我多次调用的函数的回显数组列输出存储到一个或多个我可以执行计算的数组中。

这是我正在尝试做的事情：

```
<?php

$searchquery[1] ="jupiter";
$searchquery[2] ="venus";
//can be multiple queries

include ('find.php');

for($i=0;$i<count($searchquery);$i++)
{
find($searchquery[$i]);
}

/find.php echoes back to me a MySQL query which then
 creates a 2 dimensional array for me called
/$searchresult which looks like this as an example
t x (let's call first column t for example, and second x)
|1|3|
|1|4|
|2|6|
|4|8|
|7|1|

and it echoes it back to me, this works.

But, i need to use the first column (t) (11247) output from find.php
which was the result of the searchquery "jupiter", 
and i need to store it as some sort of array in this  current sheet,
theni need to store the "venus" searchquery which is let's say

t x 
|1|3| 
|2|4|
|3|4|
|4|6|
|5|4| 
```

并将第一列 (t) 作为数组存储在当前工作表中。

我正在尝试将 find.php 函数的回声存储为数组，以便我可以在当前工作表中执行以下操作：

```
$venusarrayt = array(1, 1, 2, 4, 7); //the manually defined
 //$searchresult first column output from find.php which echos to me (t) (11247)
 $jupiterarrayt = array(1, 2, 3,4,5); //the manually defined 
 //$searchresult first column output from find.php which echos to me (t) (12345)

//I need to perform the following operation and sum all of the t combinations

for($l=0;$l<count($venusarrayt);$l++){
for($s=0;$s<count($jupiterarrayt);$s++){
echo $venusarrayt[$l]+$jupiterarrayt[$s]; 
```

这部分有效！但是我在将 echo'd`$searchresult`输出合并到一个数组中时遇到了麻烦，我可以在该数组上执行上述 for 循环。在这个例子中，我通过在 php 表中键入“venusarrayt 和 jupiterarrayt”来手动完成。

我确信有某种方法可以将我多次调用的函数的回显数组列结果存储到数组中，但我还没有弄清楚如何。请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T13:10:02.670

无论如何，进一步处理搜索数据的明确解决方案可能如下所示：

```
$searchquery[1] ="jupiter";
$searchquery[2] ="venus";

$search_result = array(); $i=0;
foreach($searchquery as $current_query){
  $current_result = FindResul($current_query);
  // FindResult will be your function which process single query and returns result of it
  $search_result[$i]['query'] = $current_query;
  $search_result[$i]['result'] = $current_result;
  $i++;
} 
```

执行上面的代码后，您将拥有数组 2-lvl 数组，其结构清晰且易于使用。您可以使用它来比较数据或以您想要的方式显示它。

结果数组将具有这样的结构：

```
$search_result[0]['query'] = 'jupiter';
$search_result[0]['result'] = '...jupiter resul';

$search_result[1]['query'] = 'venus';
$search_result[1]['result'] = '...venus result'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:16:12.910

我希望这有帮助：

```
<?php

$searchquery[0] ="jupiter";
$searchquery[1] ="venus";
//can be multiple queries

include ('find.php');
$results=null;
for($i=0;$i<count($searchquery);$i++)
{
  $temp=find($searchquery[$i]);
  $results[$i]=$temp[t];
}

for($l=0;$l<count($results[1]);$l++){
 for($s=0;$s<count($results[0]);$s++){
  echo $results[1][$l]+$results[0][$s];
  }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T13:04:50.350

你必须创建嵌套数组来解决这个问题我举个小例子怎么办？

```
$searchquery[1] ="jupiter";    
    $searchquery[2] ="venus";

for($i=1;$i<=count($searchquery);$i++){
  $temp=find($searchquery[$i]);
  $results[$i]=$temp[t];
}

$k=$i;
for($z=0;$z<=$i;$z++){
    $total='';
    for($p=0;$p<=$k;$p++){
        $total=$total+$results[$p][$z];
    }
    echo $total;
    echo "\n";
}

function find($word){
    return array('t' => array('1', '2', '4', '7'));
} 
```

答案是这样的：

```
Array
(
    [1] => Array
        (
            [0] => 1
            [1] => 2
            [2] => 4
            [3] => 7
        )

[2] => Array
    (
        [0] => 1
        [1] => 2
        [2] => 4
        [3] => 7

    )

)
2
4
8
14 
```

此解决方案将添加所有 n 个查询的第一个结果，第二个结果，依此类推......

# ruby-on-rails - as_json 中的参数数量错误 [保留了`timeout` 方法！]

> ID：10431077
> 
> 赞同：0
> 
> 时间：2012-05-03T12:08:50.460
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我在 Rails 中遇到与我的一个模型相关的错误，我们称之为`Unit`. 以下代码会产生错误：

```
format.json { render :json => @units.as_json } 
```

错误是关于错误数量的参数（0 of 1）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T14:25:55.357

我相信你想要的是；

```
def scheme
  @object = MonitoringObject.restricted_find params[:id], session[:client]

  @units = Unit.where("object_id = ?", @object.id)

  respond_to do |format|
    format.html
    format.json { render :json => @units[0] }
  end
end 
```

或者，如果您正确设置了`MonitoringObject`和`Unit`模型之间的关系，

```
def scheme
  @object = MonitoringObject.restricted_find params[:id], session[:client]
  @units = @object.units

  respond_to do |format|
    format.html
    format.json { render :json => @units[0] }
  end
end 
```

您正在为它提供一个`:except`空参数。

`:except`如果您不希望 JSON 响应中包含某些属性，您将使用条件。

根据[有关视图和渲染的 rails 指南](http://guides.rubyonrails.org/layouts_and_rendering.html)，您无需指定`.to_json`- 它会自动为您调用。

在我看来，问题可能出在你的`.restricted_find`方法上。您可以发布整个堆栈跟踪）或链接到包含它的 github gist 吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T15:23:47.797

我解决了这个问题。来自 Rails 源代码：

```
 module Serialization
    def serializable_hash(options = nil)
      options ||= {}

      attribute_names = attributes.keys.sort
      if only = options[:only]
        attribute_names &= Array.wrap(only).map(&:to_s)
      elsif except = options[:except]
        attribute_names -= Array.wrap(except).map(&:to_s)
      end

      hash = {}
      attribute_names.each { |n| hash[n] = read_attribute_for_serialization(n) } # exception here

      # ...
    end

    alias :read_attribute_for_serialization :send

    # ...
  end

  # ...
end 
```

所以真正的错误是调用 eg `Unit.first.attributes.keys.sort`( `["dev_id", "flags", "id", "inote", "ip", "location_id", "model_id", "name", "period", "phone", "port", "snote", "timeout"]`) 返回的方法之一希望我将参数传递给它。这个方法是`timeout`，它是 Rails 猴子修补 Object 的一些私有方法。所以解决这个问题的正确方法是把这个属性重命名为别的东西。

# javascript - SlickGrid 数据视图链接

> ID：10431079
> 
> 赞同：0
> 
> 时间：2012-05-03T12:08:55.110
> 
> 标签：javascript, slickgrid

我正在尝试遵循[http://mleibman.github.com/SlickGrid/examples/example4-model.html](http://mleibman.github.com/SlickGrid/examples/example4-model.html)本教程。我下载了所有必需`.js`的文件（core.js、dataview.js、grid.js），但是在创建`dataView`变量时我得到`"undefined"`.

```
var dataView = new Slick.Data.DataView(); 
```

谁能解释我的问题是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:23:21.987

确保您的 HTML 页面中以正确的顺序包含以下脚本文件：

```
<script src="../slick.core.js"></script>
<script src="../slick.grid.js"></script>
<script src="../slick.dataview.js"></script> 
```

检查 firebug 以确保文件的路径正确。使用脚本选项卡来验证脚本是否实际被加载。

# gwt - GWT 反序列化异常

> ID：10431080
> 
> 赞同：1
> 
> 时间：2012-05-03T12:08:59.393
> 
> 标签：gwt, deserialization, gwt-rpc

最近迁移到 Windows 7 并将 GWT 从 get 2.2.0 升级到 2.4.0。

但是以前工作的应用程序会引发此异常。

> 警告：获取 VaR 执行时间失败。环境=预。com.google.gwt.user.client.rpc.IncompatibleRemoteServiceException：无法在 com.google.gwt.user.client.rpc.impl.RequestCallbackAdapter.onResponseReceived(RequestCallbackAdapter.java:221) 处反序列化响应。 gwt.http.client.Request.fireOnResponseReceived(Request.java:287) 在 com.google.gwt.http.client.RequestBuilder$1.onReadyStateChange(RequestBuilder.java:395) 在 sun.reflect.GeneratedMethodAccessor34.invoke(未知来源)在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 在 java.lang.reflect.Method.invoke(Method.java:597) 在 com.google.gwt.dev.shell.MethodAdaptor.invoke(MethodAdaptor.java :103) 在 com.google.gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:71) 在 com.google。

我见过有关类似 GWT 问题的问题，但它与我的问题并不完全相同。

我检查了同步和异步接口以及实现类是否兼容。

被调用的方法是

```
Date getSophisVarDumpTime(String environment); 
```

该应用程序使用 GWT-RPC。

在托管模式下，我进入响应反序列化以查找问题。

我发现 SerializerBase.getTypeHandler() 的反序列化映射中的一个条目是 .

```
java.sql.Date/730999118=com.google.gwt.user.client.rpc.core.java.sql.Date_FieldSerializer 
```

但是响应中的类型信息是java.sql.Date/3996530531，所以没有找到反序列化例程。

我已经尝试清理和重建应用程序，但这没有任何效果。

不确定这些标识符如何不同。

任何想法都会受到欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:36:44.663

`java.sql.Date`无法反序列化，您必须将其替换为`java.util.Date`.

# jsp - 如何使用 NodeJS 共享 PowerPoint 文件？

> ID：10431083
> 
> 赞同：0
> 
> 时间：2012-05-03T12:09:22.177
> 
> 标签：jsp, node.js, servlets

我有`ShowPresentation.jsp`从计算机上传 PPT 文件并通过 java servlet 将每张幻灯片转换为图像的方法。

那我需要NodeJS实时分享，怎么做？这是`ShowPresentation.jsp`内容。

```
<!DOCTYPE >
<html>
<head> 
    <script type="text/javascript">
        var current_slide_number = 1;
        function button(slideNumber){
            current_slide_number = current_slide_number + slideNumber;
            var image = document.getElementById('imageslide');
            var fileName = document.getElementById('hidFileName');
            image.src = 'Viewer?slideNumber='+current_slide_number+'&hidFileName='+fileName.value;
        }
    </script>
    <title>PowerPoint to JPEG</title>
</head>
<body>
    <div>
        <form method="post" action="Viewer" enctype="multipart/form-data" >
            <p >
                Upload a file:</p>
            <input type="file" name="datafile" size="40"> <input type="submit" value="Upload">
        </form>
    </div>
    <% if (request.getAttribute("fileName") != null) {
    %>
    <div id="slide-controls">
        <b>Please navigate through the slides</b> 
```

```
</div>

<div id="slide"><p align="center">
        <img id="imageslide" src="Viewer?hidFileName=<%=request.getAttribute("fileName")%>"></img>
    </p>
</div>

<% }%>
<input id="hidFileName" type="hidden" value="<%=request.getAttribute("fileName")%>"></input> 
```

和这个 servlet 内容 Viewer.java

```
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics2D;
import java.awt.geom.Rectangle2D;
import java.awt.image.BufferedImage;
import java.io.DataInputStream;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import javax.imageio.ImageIO;
import javax.servlet.ServletException;
import javax.servlet.ServletOutputStream;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.apache.poi.hslf.model.Slide;
import org.apache.poi.hslf.usermodel.SlideShow;
public class Viewer extends HttpServlet {
@Override
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
    int slideNumber = 1; 
    BufferedImage image = null;
    ServletOutputStream os = null;
    try{
        if (request.getParameter("hidFileName") != null){
            String fileName = request.getParameter("hidFileName");
        if(request.getParameter("slideNumber") != null)
            slideNumber = Integer.parseInt(request.getParameter("slideNumber"));
        image = getSlideAsImage(fileName, slideNumber);
        os = response.getOutputStream();
        ImageIO.write(image, "jpeg", os );
        }
        else {
            response.sendRedirect("StartPresentation.jsp");
        }   
    }
    catch (Exception e){
                if (os != null)
            os.close();
    }       
}
@Override
protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
      String contentType = request.getContentType();
      String realPath = getServletContext().getRealPath("/");
        if ((contentType != null) && (contentType.indexOf("multipart/form-data") >= 0)) 
        {
            DataInputStream in = new DataInputStream(request.getInputStream());
            int formDataLength = request.getContentLength();
            byte dataBytes[] = new byte[formDataLength];
            int byteRead = 0;
            int totalBytesRead = 0;
            while (totalBytesRead < formDataLength) {
                byteRead = in.read(dataBytes, totalBytesRead, formDataLength);
                totalBytesRead += byteRead;
            }
            String file = new String(dataBytes);
            String saveFile = file.substring(file.indexOf("filename=\"") + 10);
            saveFile = saveFile.substring(0, saveFile.indexOf("\n"));
            saveFile = saveFile.substring(saveFile.lastIndexOf("\\")+ 1, saveFile.indexOf("\""));
            int lastIndex = contentType.lastIndexOf("=");
            String boundary = contentType.substring(lastIndex + 1, contentType.length());
            int pos;
            pos = file.indexOf("filename=\"");
            pos = file.indexOf("\n", pos) + 1;
            pos = file.indexOf("\n", pos) + 1;
            pos = file.indexOf("\n", pos) + 1;
            int boundaryLocation = file.indexOf(boundary, pos) - 4;
            int startPos = ((file.substring(0, pos)).getBytes()).length;
            int endPos = ((file.substring(0, boundaryLocation)).getBytes()).length;
            System.out.println("After File Name: "+ saveFile);
            String filePath = realPath + "/" +  saveFile;
            FileOutputStream fileOut = new FileOutputStream(filePath);
            fileOut.write(dataBytes, startPos, (endPos - startPos));
            fileOut.close();
            request.setAttribute("fileName", saveFile);
            getServletContext().getRequestDispatcher("/StartPresentation.jsp").forward(request, response);
        }
}
private BufferedImage getSlideAsImage(String fileName, int slideNumber) throws Exception
{
    BufferedImage image = null; 
    String realPath = getServletContext().getRealPath("/");
    String filePath = realPath + "/" + fileName;
    FileInputStream in = new FileInputStream(filePath);
    SlideShow ppt = new SlideShow(in);
    Slide[] slides = ppt.getSlides();
    Dimension pgsize = ppt.getPageSize();
    image = new BufferedImage(pgsize.width, pgsize.height,BufferedImage.TYPE_INT_RGB);
    Graphics2D graphics = image.createGraphics();
    graphics.setPaint(Color.white);
    graphics.fill(new Rectangle2D.Float(0, 0, pgsize.width, pgsize.height));
    if (slideNumber < 1)
        slideNumber = 1;
    else if (slideNumber > slides.length)
        slideNumber = slides.length;
    slides[slideNumber - 1].draw(graphics);
    return image;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:13:40.710

为什么你需要nodejs？如果它们只是转换后的静态文件，为什么不使用静态资产服务器（例如 nginx）提供图像文件？

听起来您只需要一个静态断言服务器。如果您想使用节点来执行此操作，[http-server](https://github.com/nodeapps/http-server)将完成这项工作：

```
npm install -g http-server
cd my/assets
sudo http-server -p 80 & 
```

然后在您的网络浏览器中访问[http://localhost 。](http://localhost)

# android - 从 Android 应用程序使用 WCF 服务

> ID：10431084
> 
> 赞同：0
> 
> 时间：2012-05-03T12:09:41.843
> 
> 标签：android, wcf, httprequest, httpresponse

到目前为止，我一直致力于视觉 c#。但现在我正在尝试开发 android 应用程序。

我需要我的 android 应用程序与 WCF 服务进行通信。我对 android 和 WCF 服务的想法都是新手，谁能给我一个关于如何编写可以与 android 应用程序通信的 WCF 服务的例子。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:14:07.310

Android (REST) 可以使用所有服务。

[一般如何使用android使用Web服务](http://romenlaw.blogspot.com/2008/08/consuming-web-services-from-android.html)

# iphone - notifications doesn't show/ doesn't scheduled in Simulator but works in device Problem on Simulator 4.3?

> ID：10431086
> 
> 赞同：0
> 
> 时间：2012-05-03T12:09:49.790
> 
> 标签：iphone, objective-c, xcode, ios4, ios-simulator

I have Implemented a reminder application.

```
[[UIApplication sharedApplication] scheduleLocalNotification:localNotification];
    int count = [[[UIApplication sharedApplication] scheduledLocalNotifications] count];  
    NSLog(@"count is %d",count); 
```

**All are works fine** notification alert raises when it's scheduled time arives.

**Suddenly today notifications are not showing** . and they didn't scheduled

notifications count also remains same even i set the notification,

But ***when i exicuted the application in my device, it works perfectly, notificaton count increases, Notification alert raises perfectly***

But not work in simulator...

*Why Notifications doesn't work on simulator..?*

I have used ***`Xcode 4.1`***

***`iPhone 4.3 simulator`***

What happen?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:39:04.603

```
Trash your /Users/{Your name}/Library/Application Support/iPhone Simulator/ directory and rebuild the projects you are having trouble with. 
```

Solved by follow question [iPhone: iOS 4.3 SDK Simulators stuck up and crashing:](https://stackoverflow.com/questions/5428576/iphone-ios-4-3-sdk-simulators-stuck-up-and-crashing)

Thank u @Kiby Todd...

*Make Sure we put a copy of* ***"User's"*** folder existed in ***iPhone Simulator*** folder

Re paste **User** Folder in ***iPhone Simulator***

# php - 将常见测试重构为基本测试用例

> ID：10431090
> 
> 赞同：3
> 
> 时间：2012-05-03T12:10:07.470
> 
> 标签：php, unit-testing, testing, phpunit, xunit

**如果两个或多个测试相同接口/抽象类的不同实现的测试类具有共同的测试但**具有不同的夹具，那么重构测试用例是一个好主意吗？

假设代码和测试如下所示：

```
interface MathOperation
{
    public function doMath($a, $b);
}

class Sumator implements MathOperation
{
    public function doMath($a, $b)
    {
        return $a + $b;
    }
}

class Multiplicator implements MathOperation
{
    public function doMath($a, $b)
    {
        return $a * $b;
    }
}

// tests
class SumatorTest extends PHPUnit_Framework_TestCase
{
    /**
     * @var Sumator
     */
    protected $sumator;

    public function setUp()
    {
        $this->sumator = new Sumator;
    }

    /**
     * @dataProvider fixtures
     */
    public function testDoMath($a, $b, $expected)
    {
        $result = $this->sumator->doMath($a, $b);
        $this->assertEqual($expected, $result);
    }

    public function fixtures()
    {
        return array(
            array(1, 1, 2);
            array(2, 1, 3);
            array(100, -1, 99);
        );
    }
}

class MultiplicatorTest extends PHPUnit_Framework_TestCase
{
    /**
     * @var Multiplicator
     */
    protected $multiplicator;

    public function setUp()
    {
        $this->multiplicator = new Multiplicator;
    }

    /**
     * @dataProvider fixtures
     */
    public function testDoMath($a, $b, $expected)
    {
        $result = $this->multiplicator->doMath($a, $b);
        $this->assertEqual($expected, $result);
    }

    public function fixtures()
    {
        return array(
            array(1, 1, 1);
            array(2, 1, 2);
            array(100, -1, -100);
        );
    }
} 
```

我希望它们（测试）看起来像这样：

```
class MathOperationTestCase extends PHPUnit_Framework_TestCase
{
    /**
     * @var MathOperation
     */
    protected $operation;

    public function setUp()
    {
        $this->operation = $this->createImpl();
    }

    /**
     * @return MathOperation
     */
    abstract function createImpl();

    /**
     * @dataProvider fixtures
     */
    public function testDoMath($a, $b, $expected)
    {
        $result = $this->operation->doMath($a, $b);
        $this->assertEqual($expected, $result);
    }

    abstract public function fixtures();
}

class SumatorTest extends MathOperationTestCase
{
    public function createImpl()
    {
        return new Sumator;
    }

    public function fixtures()
    {
        return array(
            array(1, 1, 2);
            array(2, 1, 3);
            array(100, -1, 99);
        );
    }
}

class MultiplicatorTest extends MathOperationTestCase
{
    public function createImpl()
    {
        return new Multiplicator;
    }

    public function fixtures()
    {
        return array(
            array(1, 1, 1);
            array(2, 1, 2);
            array(100, -1, -100);
        );
    }
} 
```

这似乎结构更好，但**可能缺乏可读性**。所以最后我不确定它是否有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:23:04.997

如果您的原始代码更改，则测试也必须更改。牢记这一点，然后您将看到哪种方式可以更轻松地处理更改。如果您决定将来分离接口或类似的问题可能会帮助您做出决定，该怎么办。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T13:04:41.097

您已经将 PHPUnitTest 的功能抽象出来，足以使其适用于多个类！凉爽的。我还看到，如果 Sumator 或 Multiplicator 在未来添加了功能，这将成为问题——无论您对任一类做什么，您都将始终面临是否应该将其抽象到基础的问题测试框架中的类也是如此。

在我看来，这使可维护性变得复杂，不是因为您必须调整多个类（无论哪种方式都发生在测试类中），而是因为维护额外代码结构的额外负担，您在做出选择时需要跟踪任一类。

出于这个原因，在我看来，单元测试适用于一对一的结构。你的方法减少了代码重复，因为只要一个类具有相同的结构和功能，它就适用于这个测试类。另一方面，在我看来，它打开了让课程适合考试的诱惑，而不是相反。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T00:19:16.143

经过一番考虑，我得出的结论是，这种方法的唯一好处是减少了代码重复。

提取基本测试用例只能适用于被测类的通用接口，但这些接口**不能强制**我们尝试测试的业务逻辑工作流相同。让我们修改`Multiplicator`类来证明这一点。

```
class Multiplicator implements MathOperation
{
    private $factor; // added factor which influences result of doMath()

    public function __construct($factor)
    {
        $this->factor = $factor;
    }

    public function doMath($a, $b)
    {
        return ($a * $b) * $factor;
    }
} 
```

现在，虽然`Sumator`和`Multiplicator`共享相同的接口，但`Multiplicator`应该测试的方式完全不同，例如

```
class MultiplicatorTest extends MathOperationTestCase
{
    // rest of code

    public function testDoMath2($ab, $b, $factor, $expected)
    {
        $multiplicator = new Multiplicator($factor);
        $result = $multiplicator->doMath($a, $b);
        $this->assertEqual($expected, $result);
    }
} 
```

此外**，我必须****通过对测试类进行轻微修改**来保持与基本测试用例的向后兼容性，这是巨大的禁忌......

```
class Multiplicator implements MathOperation
{
    // rest of code

    public function __construct($factor = 1) // default value set in class
    {
        $this->factor = $factor;
    }
} 
```

...或者通过**修改测试本身**。这使得从提取的测试用例派生的测试是重复的，并且在某种程度上是无用的。

```
class MultiplicatorTest extends MathOperationTestCase
{
    // rest of code

    public function createImpl()
    {
        return new Multiplicator(1); // added default value
    }
} 
```

除了明显的缺陷之外，以上所有内容都在可读性和可维护性方面增加了不必要的复杂性。

感谢大家的贡献。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-04T09:57:27.577

我发现有一个用于测试的基类主要只在两种情况下有用：

1.  基类仅包含您正在处理的应用程序的常见实用程序/帮助方法/类之类的东西，即常见的模拟类创建者。
2.  被测产品与其他产品共享一些代码，但在某种程度上对其进行了扩展；因此，您在测试基类及其子类中反映了这一点。

# algorithm - 具有最小颜色总和的着色树

> ID：10431091
> 
> 赞同：3
> 
> 时间：2012-05-03T12:10:09.187
> 
> 标签：algorithm, graph, tree

问题是用自然数为树顶点着色，使得分配给顶点的数字（颜色）之和最小。

执行此操作的颜色数量是否有限？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T13:39:36.503

> 我认为 3 种颜色足以做到这一点。如何证明？

它不是。用代数方式描述一棵有根树如下。`V`是一棵单节点树。`E(t1, t2)`是一棵树，由`t1`和`t2`和从`t1`' 根到`t2`' 根的边组成，以 ' 根为`t2`根。以下树`t3`需要四种颜色才能达到最小值 156。

```
t3 = E(t2, E(t2, E(t2, E(t2, t2))))
t2 = E(t1, E(t1, E(t1, E(t1, t1))))
t1 = E(t0, E(t0, E(t0, E(t0, t0))))
t0 = V 
```

基于一些实验，我~~猜想~~可以证明这种结构具有泛化性，因此没有固定数量的颜色足以达到所有树的最小值。

**定理**对于所有 d ≥ k ≥ 3，以下归纳构造的树 T(d, k) 至少需要 k 种颜色。T(d, 1) 是单顶点树。对于 i > 1，T(d, i) 是有 d 个叶子连接到 T(d, i - 1) 的每个顶点的树。

**通过对 k 的归纳**证明。**基本情况 k = 3 本质上是您的示例，其中需要 3 种颜色才能达到最优。对于 k > 3，考虑仅使用 k - 1 种颜色的 T(d, k) 着色。我们展示了如何使用颜色 k 来改进它。如果某个内部顶点的颜色为 1，那么我们通过将其颜色更改为 k 并将其 d > k - 1 个相邻叶子的颜色更改为 1 来改进。如果没有区间顶点的颜色为 1，并且某些叶子的颜色不是 1，将叶子更改为 1。如果我们还没有改进，则所有叶子的颜色为 1，所有区间顶点的颜色 > 1。移除所有叶子并减少标签，我们的颜色为 T(d, k - 1) ，我们可以通过归纳假设来改进。**

 *** * *

```
data Tree = V | E Tree Tree
    deriving (Eq, Show)

otherMinimums [x, y] = [y, x]
otherMinimums (x:xs) = minimum xs : map (min x) (otherMinimums xs)

color m V = [1..m]
color m (E t1 t2) = let
    c1 = color m t1
    c2 = color m t2 in
    zipWith (+) (otherMinimums c1) c2

t3 = E t2 $ E t2 $ E t2 $ E t2 $ t2
t2 = E t1 $ E t1 $ E t1 $ E t1 $ t1
t1 = E t0 $ E t0 $ E t0 $ E t0 $ t0
t0 = V 
```

结果：

```
> color 3 t3
[157,158,163]
> color 4 t3
[157,158,159,156] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T12:37:30.020

首先，2 种颜色对于任何树都足够了。为了证明这一点，您可以使用替代颜色逐级着色树。

其次，逐级着色是唯一有效的二次着色方法。可以通过层次上的归纳来证明。修复根节点的颜色。然后它的所有孩子都应该有不同的颜色，孩子的孩子——第一种颜色，等等。

第三，要选择最佳着色，只需检查两种可能的布局：分别是根节点有颜色的`0`时候和有颜色的时候`1`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:39:30.763

对于树，您只能使用两种颜色：一种用于奇数深度的节点，另一种颜色用于偶数深度的节点。

编辑：之前的答案是错误的，因为我不明白这个问题。

如 Wobble 所示，所需的颜色数量没有限制。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-24T08:29:49.853

具有 n 个节点的树的最小总和的颜色数限制为 O(logn)

E. Kubicka 在她 1989 年的论文 [http://dl.acm.org/citation.cfm?id=75430中对此进行了介绍](http://dl.acm.org/citation.cfm?id=75430)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-05-03T20:39:03.300

用 2 种颜色 {0,1} 为任何树着色就足够了，但复杂度将是 O(n)。

用 3 种颜色 {0,1,2} 着色任何树就足够了，但复杂度将是 O(log* (n))

现在的问题是什么是 log*(n)

log* (n) - **“log Star n”**，即**“迭代对数”**

简单来说，您可以假设 log* (n)= log(log(log(.....(log* (n))))

log* (n) 非常强大。

**例子：**

**1)** Log* (n)=5 其中 n= 宇宙中的原子数

**2）**在知道欧几里得最小生成树的情况下找到一组点的Delaunay三角剖分：随机O（n log * n）时间。**

# php - 如何按范围形成选择查询

> ID：10431092
> 
> 赞同：0
> 
> 时间：2012-05-03T12:10:13.073
> 
> 标签：php, mysql, variables, range

你好我有我的网站的搜索引擎。我有两个选择字段。我想举个例子：

输入_a：3 输入_b：5

所以查询应该如下所示：

```
if ( ($input_a == true) && ($input_b == false) ){
        $filter_orders[] = " `col` LIKE '%$input_a%' ";
    } 
    if ( ($input_a == false) && ($input_b == true) ){
        $filter_orders[] = " `col` LIKE '%$input_b%' ";
    } 
    if ( ($input_a == true) && ($input_b == true) ){
        $filter_orders[] = " `col`= `col`>='%$input_a%' AND `col` = `col`<='%$input_b%' "; 
```

现在的问题是，我不知道最后一个查询是否不正确。这背后的逻辑是，在我的例子中，应该找到 3 到 5 之间的范围。

所以 1,2 `[3,4,5]`6,7,8...

如果有人可以帮助我，我真的很感激。

多谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:12:25.410

那应该是

```
$filter_orders[] = " `col`>='%$input_a%' AND `col`<='%$input_b%' "; 
```

编辑：您可能希望整个语句如下所示：

```
if ( (!empty($input_a) && is_int($input_a)) && (empty($input_b) || !is_int($input_b)) {
    $filter_orders[] = " `col`='%$input_a%' ";
} 
else if ( (empty($input_b) || !is_int($input_a)) && (!empty($input_b) && is_int($input_b)) ) {
    $filter_orders[] = " `col`='%$input_b%' ";
} 
else if ( !empty($input_a) && !empty($input_b) && is_int($input_a) && is_int($input_b) ) {
    $filter_orders[] = " `col`>='%$input_a%' AND `col`<='%$input_b%' ";
} 
```

插入`else if`而不是仅仅`if`有助于确保`if`如果发现较早`if`的脚趾为真，则不会执行其他 s。

使用 the`=`而不是`LIKE`wille 确保`3 == 3`而不是`3 and 31 or 32`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:12:43.037

**不，**可悲的是，这一切都不是正确的。它应该是这样的。

```
$filter_orders[] = " `col`>='%$input_a%' AND `col`<='%$input_b%' "; 
```

# php - 从 mysql 数据库中选择许多列的最快方法是什么？

> ID：10431096
> 
> 赞同：1
> 
> 时间：2012-05-03T12:10:25.347
> 
> 标签：php, mysql

我需要从数据库中选择 25 列，条件为 WHERE 和 ORDER BY。

我试图为此建立一个索引，但它仅限于 16 列。我如何组织 mysql 语句和数据库以最快的方式从 PHP 中的数据库中选择这 25 列？

示例表：

列：A、B、C、D、E、F、....

查询：“SELECT A, B, C, D, E, F, ... FROM table WHERE X = 5 ORDER BY Z”

更新 1：

这是一个大表（很多行），这就是为什么我需要一个索引来加速这个过程。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-03T12:12:52.180

索引对您选择的列数（不包括 FULLTEXT）没有性能影响。它们仅用于在您使用选择（WHERE）以及有时排序（ORDER BY）和聚合（GROUP BY 等）时加快速度。

在这种情况下，您需要在 X 和 Z 上定义索引以获得最佳效率。因为 MySQL 每个查询只能使用 1 个索引，所以您需要 (X,Z) 上的索引（因为首先在 X 上选择，然后在 Z 上排序）。*请注意，这兼作 X 的索引*。

此外，包含*所有*列的索引几乎与表条目相同（尽管已排序），因此您不会从中获得太多 SELECT 性能改进，而 INSERT/UPDATE/DELETE 性能会直线下降。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:16:46.123

具有上述列的视图并对此执行 select 语句呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:41:03.960

在您的情况下，唯一有用的索引是 x 和 z 上的索引。更改表 tbl 添加键 (x, z)。

mysql only uses 1 index per table per query. so having many indexes will not help for this one query.

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-03T12:17:00.327

你的意思是使用 SELECT * FROM table where bla bla bla 吗？

# c# - 如何发送带有查询字符串的 URL 作为查询字符串

> ID：10431107
> 
> 赞同：21
> 
> 时间：2012-05-03T12:11:04.257
> 
> 标签：c#, url, query-string

我正在做从一个页面到另一个页面的重定向，以及从第二个页面到第三个页面的另一个重定向。我有第一页的信息，第二页没有使用，但必须转移到第三页。是否可以将第三页的 URL 及其查询字符串作为查询字符串发送到第二页。这是一个例子：

```
Response.Redirect("MyURL1?redi=MyURL2?name=me&ID=123"); 
```

我的问题是作为查询字符串发送的 URL 有两个查询字符串变量，那么系统如何知道 & 之后的内容是第二个 URL 的第二个变量而不是第一个 URL 的第二个变量？谢谢你。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-03T12:20:31.160

您必须对作为参数传递到重定向 URL 中的 url 进行编码。像这样：

```
MyURL = "MyURL1?redi=" + Server.UrlEncode("MyURL2?name=me&ID=123"); 
```

这将创建一个没有双“？”的正确网址 和 '&' 字符：

```
MyURL1?redi=MyURL2%3fname%3dme%26ID%3d123 
```

请参阅 MSDN：[HttpServerUtility.UrlEncode 方法](http://msdn.microsoft.com/en-us/library/zttxte6w.aspx)

要从此编码的 url 中提取重定向 url，您必须使用`HttpServerUtility.UrlDecode`它再次将其转换为正确的 url。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-03T12:28:30.590

我发现在发送之前在 Base64 中编码查询字符串参数很有帮助。在某些情况下，当您需要发送各种特殊字符时，这会有所帮助。它不会产生好的调试字符串，但它会保护您发送的任何内容不与任何其他参数混合。

请记住，解析查询字符串的另一方也需要解析 Base64 以访问原始输入。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-03T12:13:56.467

您的查询字符串应如下所示：

```
MyURL1?redi=MyURL2&name=me&ID=123 
```

检查：[http ://en.wikipedia.org/wiki/Query_string](http://en.wikipedia.org/wiki/Query_string)

你应该有一个？符号和所有参数用 & 连接。如果参数值包含特殊字符，只需对它们进行[UrlEncode](http://msdn.microsoft.com/en-us/library/zttxte6w.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-11T21:21:02.133

```
using System.IO;
using System.Net;

static void sendParam()
{

    // Initialise new WebClient object to send request
    var client = new WebClient();

    // Add the QueryString parameters as Name Value Collections
    // that need to go with the HTTP request, the data being sent
    client.QueryString.Add("id", "1");
    client.QueryString.Add("author", "Amin Malakoti Khah");
    client.QueryString.Add("tag", "Programming");

    // Prepare the URL to send the request to
    string url = "http://026sms.ir/getparam.aspx";

    // Send the request and read the response
    var stream = client.OpenRead(url);
    var reader = new StreamReader(stream);
    var response = reader.ReadToEnd().Trim();

    // Clean up the stream and HTTP connection
    stream.Close();
    reader.Close();
} 
```

# objective-c - 嵌套块和对自身的引用

> ID：10431110
> 
> 赞同：6
> 
> 时间：2012-05-03T12:11:25.987
> 
> 标签：objective-c, ios, objective-c-blocks, weak-references

我有一个我使用的块，`self`所以我声明了一个对 self 的弱引用：

```
__weak MyClass *weakSelf = self; 
```

现在我的问题：

1.  我在定义的地方出现错误，我`weakSelf`不明白这应该是什么意思。：

    无法在自动变量上指定弱属性

2.  在我的街区内，我传递`weakSelf`到另一个街区，我不确定我现在是否必须像这样再次做同样的事情：

    ```
    __weak MyClass *weakWeakSelf = weakSelf; 
    ```

    然后传到`weakWeakSelf`那个街区？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-03T12:28:13.470

这很可能发生在您针对 iOS 4 时。您应该将其更改为

```
__unsafe_unretained MyClass *weakWeakSelf = weakSelf; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T22:29:13.053

**带弧**

```
__weak __typeof__(self) wself = self; 
```

**没有ARC**

```
__unsafe_unretained __typeof__(self) wself = self; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-21T08:57:16.397

使用[libextobjc](https://github.com/jspahrsummers/libextobjc)，它将易于阅读且易于阅读：

```
- (void)doStuff
{
    @weakify(self); 
    // __weak __typeof__(self) self_weak_ = self;

    [self doSomeAsyncStuff:^{

        @strongify(self);
        // __strong __typeof__(self) self = self_weak_;

        // now you don't run the risk of self being deallocated
        // whilst doing stuff inside this block 
        // But there's a chance that self was already deallocated, so
        // you could want to check if self == nil

        [self doSomeAwesomeStuff];

        [self doSomeOtherAsyncStuff:^{

            @strongify(self);
            // __strong __typeof__(self) self = self_weak_;

            // now you don't run the risk of self being deallocated
            // whilst doing stuff inside this block 
            // Again, there's a chance that self was already deallocated, so
            // you could want to check if self == nil

            [self doSomeAwesomeStuff];

        }];
    }];
} 
```

# javascript - 如何防止客户端用户更改 onClick 函数中的参数？

> ID：10431122
> 
> 赞同：2
> 
> 时间：2012-05-03T12:11:44.587
> 
> 标签：javascript, security, onclick

我刚刚在使用 firebug 测试 onClick 函数时意识到，用户可以很容易地更改正在传递的参数的值。这可能会搞砸。

有什么简单的方法可以防止这种情况发生，尤其是在需要传递参数时？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T12:13:04.883

是不可能的。该代码正在用户的计算机上执行。他们在控制之中。

如果他们对其进行编辑并“搞砸”，那就在他们头上。

如果他们编辑它并向您的服务器提交 HTTP 请求，并且您的服务器允许（例如）该请求删除属于另一个用户的数据，那么问题是您的服务器没有检查提交请求的用户是否具有权限在执行之前删除该数据。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-03T12:15:33.833

您不能信任从客户端发送的**任何内容。**用户可能会手动编辑 URL 参数，或者脚本小子甚至可以根本不使用浏览器向您发送请求。您必须在服务器端验证所有内容。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-03T12:15:02.897

### 不，这根本做不到。

一旦脚本被加载到客户端的机器上。他可以随心所欲地使用/修改它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-03T12:14:18.347

我建议在处理结果的地方（客户端/服务器）根据预期的一组值和/或业务规则验证参数。理想情况下，验证检查发生在用户无法控制的服务器上。甚至可以修改客户端的验证以允许输入无效数据。

没有办法完全控制它 - 只能根据标准对其进行验证。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-03T12:46:11.183

您无法阻止此操作，因为 JavaScript 是客户端。你也永远不能相信客户。

您应该在服务器端对任何请求进行验证，以保护您的数据免受客户端滥用。

您可以使用 .delegate()以某种方式使其隐藏在客户眼中

**前任。**

```
$("table").delegate( "td","click", function() {<br>
  // write here your function<br>
}); 
```

客户可以执行这个脚本，但它不是直接在他的眼前..

# javafx - JavaFX 2.1 中的应用程序范围的菜单栏？

> ID：10431123
> 
> 赞同：2
> 
> 时间：2012-05-03T12:11:46.203
> 
> 标签：javafx, javafx-2, menubar

[JavaFX 2.1 发行说明](http://docs.oracle.com/javafx/2/release_notes_2-1/jfxpub-release_notes_2-1.htm)声明此版本包括 ：

*   UI 增强功能，包括组合框、堆叠图表和应用程序范围的菜单栏的控件。

“应用程序范围的菜单栏”是什么意思？这意味着什么？
寻找 UI 组件，但找不到任何对它的引用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T19:29:51.947

我相信评论指的是新的 JavaFX 2.1 能够将菜单栏设置为系统级应用程序菜单栏。例如，在 Mac 上，它将是屏幕顶部的菜单栏。

我认为添加的属性是[MenuBar.useSystemMenuBarProperty](http://docs.oracle.com/javafx/2/api/javafx/scene/control/MenuBar.html#useSystemMenuBarProperty)。

Windows（和一些 Linux 窗口管理器）没有相同的概念，所以我认为该属性在这些平台上没有任何作用。

# c# - 如何进行一系列异步调用，然后使用第一个线程返回的值？

> ID：10431127
> 
> 赞同：2
> 
> 时间：2012-05-03T12:12:05.897
> 
> 标签：c#, .net, multithreading, .net-2.0

我想进行异步调用，然后处理第一个线程返回的值。**我不想使用并行库。**我可以使用.Net 2.0。我编写了以下程序，应该可以满足我的要求。但是有人可以指出是否有更好的解决方案吗？谢谢。

这是我的代码：

```
class Program
{
    private static Worker _worker2;
    private static Worker _worker3;
    private static Worker _worker4;
    private static Worker _worker1;
    delegate void DoWorkDelegate(object param);

    private static Worker _firstReturnedWorker = null;
    private static object lockObject = new object();

    public static void Main()
    {
        _worker1 = new Worker();
        _worker2 = new Worker();
        _worker3 = new Worker();
        _worker4 = new Worker();

        int i = 10;
        DoWorkDelegate d1 = new DoWorkDelegate(_worker1.OnDoWork);
        d1.BeginInvoke(1, OnThreadReturned, ++i);

        DoWorkDelegate d2 = new DoWorkDelegate(_worker2.OnDoWork);
        d2.BeginInvoke(2, OnThreadReturned, ++i);

        DoWorkDelegate d3 = new DoWorkDelegate(_worker3.OnDoWork);
        d3.BeginInvoke(3, OnThreadReturned, ++i);

        DoWorkDelegate d4 = new DoWorkDelegate(_worker4.OnDoWork);
        d4.BeginInvoke(4, OnThreadReturned, ++i);

        Console.ReadKey();
    }
    private static void OnThreadReturned(IAsyncResult ar)
    {
        lock (lockObject)
        {
            if (_firstReturnedWorker == null)
            {                    
                var workerIdentifier = (int)ar.AsyncState;
                switch (workerIdentifier)
                {
                    case 11:
                        _firstReturnedWorker = _worker1;
                        break;
                    case 12:
                        _firstReturnedWorker = _worker2;
                        break;
                    case 13:
                        _firstReturnedWorker = _worker3;
                        break;
                    case 14:
                        _firstReturnedWorker = _worker4;
                        break;
                }
            }
            else
            {
                return;
            }
        }
        Console.WriteLine("First result received was {0}", _firstReturnedWorker.ReturnedValue);
    }
}

public class Worker
{
    public string ReturnedValue { get; private set; }

    public void OnDoWork(object value)
    {
        ReturnedValue = Process((int)value);
    }

    private string Process(int numberToProcess)
    {
        return string.Format("{0} was processed by {1}", numberToProcess, Thread.CurrentThread.ManagedThreadId);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T13:03:23.203

您的代码看起来应该可以工作，到目前为止还可以。

`AsyncState`您可以通过传递 Worker 实例对象作为而不是幻数来清理它。那么你也不需要`switch`in `OnThreadReturned`。

* * *

另一种方法是将所有的`IAsyncResult.AsyncWaitHandle`' 放在一个数组中并调用`WaitHandle.WaitAny`. 不过，这会产生更多开销，因为`WaitHandle`' 是按需创建的，因此在您的回调解决方案中不需要。它们是实际的内核对象，所以这很重要。

# prolog - 如何使用 prolog 查找字符串长度

> ID：10431130
> 
> 赞同：5
> 
> 时间：2012-05-03T12:12:21.980
> 
> 标签：prolog, iso-prolog

我有一个方法 length(list,var)，它给了我一个列表的长度，但我想找到一个字符串的长度，有人有解决方案吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-03T13:03:56.633

如果您想使用 ISO Prolog，则不会使用`name/2`谓词。

ISO Prolog 为您提供`atom_codes/2`和`atom_chars/2`. 它们为您提供将原子来回转换为代码列表或字符列表的功能。原子是 Prolog 系统的字符串，字符只是长度为 1 的原子。下面是两个谓词的一些示例调用：

```
?- atom_codes(ant, L).
L = [97,110,116]
?- atom_codes(X, [97,110,116]).
X = ant
?- atom_chars(ant, X).
X = [a,n,t]
?- atom_chars(X,[a,n,t]).
X = ant 
```

现在您想知道如何确定字符串（又名原子）的长度。一种方法是首先确定代码或字符，然后计算该列表的长度。但 ISO 也提供了一个`atom_length/2` 谓词。它的工作原理如下：

```
?- atom_length(ant,X).
X = 3 
```

许多 Prolog 系统都提供了这组内置谓词，即 SWI Prolog、GNU Prolog、Jekejeke Prolog 等。可用的字符代码范围和编码取决于 Prolog 系统。有些只允许 8 位代码，一些 16 位代码和一些 32 位代码。

原子的最大长度也可能不同，有时与经常出现的原子类型相比，还有一个额外的字符串类型没有列出。但是这种额外的类型通常与双引号括起来的字符串不同，后者只是字符列表的简写。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T13:01:10.660

由于字符串是原子，因此您不能直接操作它们以获取长度、提取子字符串等。首先您必须将它们转换为字符列表`atom_chars/2`：

```
atom_chars(StrVar, ListVar), length(ListVar, LengthVar). 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T16:58:35.253

只是在玩它，我把谓词作为

```
?- length("hello", R).
R = 5. 
```

令人惊讶的是它起作用了:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-12-22T13:46:54.330

也许是这样：

```
string_length(+String, -Length) 
```

来自 Prolog 手册。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-26T12:24:05.373

用这个 ：

```
?- same_length('abhi',Z).
Z=4 
```

如果您尝试为此创建一个 .pl 文件，请使用以下命令：

```
samelen(X ,Y) :-  string_length(X,Y).
// ctrl+c & ctrl+b to save this file

//Now write this as query:
samelen(roger,Y).
Y=5 
```

# java - 尝试通过 Java 连接到 Apple 的推送服务器时出现 SSL 握手错误。

> ID：10431132
> 
> 赞同：1
> 
> 时间：2012-05-03T12:12:24.273
> 
> 标签：java, ssl, apple-push-notifications

我一直在 Eclipse/Maven/Jetty 项目中尝试这个[问题](https://stackoverflow.com/questions/9410249/ssl-handshake-with-apple-push-notification-server-via-java/10420050#10420050)的代码 ，并且我从 sslSocket.startHandshake() 附近的 try{} 块中得到 SSLHandshakeException。我已经尝试将我的 .p12 文件加载到 keyStore 以及我的 .pem 中。它们都不起作用。两者都在我构建的 PHP 原型中工作。也不清楚这两个用途是否使用相同的密码。

```
try {
    KeyStore keyStore = KeyStore.getInstance("PKCS12");

    keyStore.load(getClass().getResourceAsStream("cert.p12"), "<password>".toCharArray());
    KeyManagerFactory keyMgrFactory = KeyManagerFactory.getInstance("SunX509");
    keyMgrFactory.init(keyStore, "<password>".toCharArray());

    SSLContext sslContext = SSLContext.getInstance("TLS");
    sslContext.init(keyMgrFactory.getKeyManagers(), null, null);
    SSLSocketFactory sslSocketFactory = sslContext.getSocketFactory();

    SSLSocket sslSocket = (SSLSocket) sslSocketFactory.createSocket(host, port);
    String[] cipherSuites = sslSocket.getSupportedCipherSuites();
    sslSocket.setEnabledCipherSuites(cipherSuites);
    sslSocket.startHandshake();
}catch()... 
```

我已经使用检查了与 Apples 服务器的连接

```
openssl s_client -connect gateway.sandbox.push.apple.com:2195 
```

作为回报，我得到以下。

```
CONNECTED(00000003)
depth=1 /C=US/O=Entrust, Inc./OU=www.entrust.net/rpa is incorporated by reference/OU=(c) 2009 Entrust, Inc./CN=Entrust Certification Authority - L1C
verify error:num=20:unable to get local issuer certificate
verify return:0
18183:error:14094410:SSL routines:SSL3_READ_BYTES:sslv3 alert handshake failure:/SourceCache/OpenSSL098/OpenSSL098-44/src/ssl/s3_pkt.c:1102:SSL alert number 40
18183:error:140790E5:SSL routines:SSL23_WRITE:ssl handshake failure:/SourceCache/OpenSSL098/OpenSSL098-44/src/ssl/s23_lib.c:182: 
```

我不确定发生了什么。有任何想法吗？

# tfs - 如何将多个 TFS 存储库拉入单个 Jenkins 作业？

> ID：10431142
> 
> 赞同：7
> 
> 时间：2012-05-03T12:13:02.270
> 
> 标签：tfs, jenkins, jenkins-plugins

我有一个包含 2 个子文件夹 $/Repo/project 和 $/Repo/thirdparty 的仓库。我需要将这两个都拉到 Jenkins 中进行一次构建。自然地，我尝试只提取 $/Repo，但这给了我一堆其他项目以及错误的民意调查（每次将任何东西签入 $/Repo 时都会构建）。我尝试使用有效的 multi-scm 插件，但不保存配置（烦人，但不是不可用）。我尝试使用常规的 tfs 插件并手动将另一个 repo 的调用放入 windows 命令中（即使我将它们绑定到不同的文件夹，这也不起作用）。

解决这个问题的最佳方法是什么？某种吸引第三方的子工作？修复多个 scm 插件？拉项目时是否有一些 tfs 命令或触发器来拉不同的仓库？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T19:46:26.183

我能够通过工作管道来完成这项工作。这有点hacky，但它有效。

我正在尝试构建的程序使用`$/Department/Framework/Main`(as `workspace\Framework`) 和`$/Department/Products/TheProgram/Main`(as `workspace\TheProgram`)。

我在 Jenkins 中创建了三个工作，每个工作都在另一个“下游”：

*   Framework-Get：在 TFS 的项目路径上触发的正常源代码`$/Department/Framework/Main`。没有构建步骤。
*   TheProgram-Get：在 TFS 的 Product Path 上触发的正常源代码`$/Department/Products/TheProgram`。没有构建步骤。
*   TheProgram-Build：无源代码控制。但构建步骤 xcopy 的来源来自上述两个步骤。然后，您可以运行正常的构建步骤。

TheProgram-Build 的第一个构建步骤是一个 windows 批处理命令：

```
REM =====================================
REM 首先获取Framework文件夹：
rmdir /s/q 框架
mkdir 框架
xcopy /y /q /e ..\..\Framework-Get\Workspace\Framework Framework

REM =====================================
REM 然后获取 TheProgram 文件夹：
rmdir /s/q 程序
mkdir 程序
xcopy /y /q /e ..\..\TheProgram-Get\Workspace\TheProgram TheProgram

```

第二个构建步骤是对 ant 的简单调用。但是你可以在这里使用 msbuild 或任何你喜欢的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T13:00:33.207

Jenkins 的 TFS 插件目前不支持从多个位置签出源。multiple-scm-plugin 可能是答案，但正如您在问题中指出的那样 - 在这一点上它真的不是一个选项。据我所知，实际上只有可能的解决方案供您测试：

1.  在 TFS 中创建一个工作区，其中将包含所有必需的导入。我在与 TFS 的日常接触中使用此功能，尽管我从未有机会将它与 Jenkins 插件一起使用。它可能有效，也可能无效。
2.  你可以使用，并且请 - 这是一个非常严肃的选择，至少对我来说 - git。有一个[git-tfs](https://github.com/git-tfs/git-tfs)并将所有需要的项目导入 git 存储库。将它们放在 git 中将为您打开许多可能性，包括为每个文件夹使用单独的存储库、使用 git 模块、git 外部......等等。所以，至少对我来说，这是一个有效的选择，尽管乍一看它似乎是一个丑陋的解决方法......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-02-08T17:21:18.610

TFS 插件支持`$\Repo`隐藏您不感兴趣的文件夹的功能。签入隐藏文件夹不会触发构建。不幸的是，这可能是很多文件夹，而您只对其中两个感兴趣 - 您需要在添加新文件夹时维护隐藏文件夹的列表。

我们避免使用 TFS 插件，而是使用 tfs 命令行通过 powershell 步骤编写 TFS 工作区的设置脚本。每个构建都指定了它想要的文件夹，并且脚本会注意隐藏/取消隐藏其余部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-09T14:05:30.047

我对此的解决方案是创建两个作业，一个仅下载您的依赖项，另一个用于构建。

就我而言，我使用 Maven 属性管理构建，例如：

### pom.xml

```
<properties>
  <my.dir>../MyDir</wsdl.dir>
</properties> 
```

### 詹金斯构建

```
Goals clean package -U -Dmy.dir=${WORKSPACE}/../../another-build/workspace/MyDir 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-10T20:15:30.827

我必须自己为 Jenkins 创建一个解决方法。这是使用 TF 和 powershell Snapin Microsoft.TeamFoundation.PowerShell 实现的。

基本上工作流程如下：

Get-TFsWorkspace（Powershell：检查工作区）

TF Workspace /new（创建工作区）

TF Workfold /unmap（使用它来删除在工作空间创建期间进行的默认 $/ 映射）

TF Workfold /map（映射特定位置，即$/Repo/project）

TF Scorch（如果有的话，删除任何伪影）

TF Get（获取代码）

人们可能还有其他方法，但这也允许您使用 tf Workfold /cloak 功能。

干杯，

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-09T07:35:22.000

可以确认 Multiple SCM 0.5 与 Team Foundation Server 插件 4.0 一起使用

然而，民意调查似乎确实中断了。

# c# - 将图像包含到 Excel 文件中的 C# 智能方法

> ID：10431149
> 
> 赞同：0
> 
> 时间：2012-05-03T12:13:14.227
> 
> 标签：c#, image, export-to-excel

我正在寻找一种使用 Office.Interop.Excel 将图像包含到 Excel 文件中的智能方法。基本上我想建立一个报告，我的专栏之一包含图像。

我面临两个问题：首先我没有找到添加图像，除非将临时副本保存到 HD 中（我的图像来自存储在数据库中的字节数组），然后我无法将图片本身添加到单元格中，我必须计算我的工作表上的确切位置，这不是很有效。

这是我的代码

```
using (MemoryStream stream = new MemoryStream(ByteArrayImage))
{
    Image image = Image.FromStream(stream);
    image.Save(directory + "\\Excel\\Temp\\image.png", ImageFormat.Png);
    xlWorkSheet.Shapes.AddPicture(directory + "\\Excel\\Temp\\image.png",
                 MsoTriState.msoFalse,MsoTriState.msoTrue,580, cumulHeight, 
                 image.Size.Width, image.Size.Height);
    cumulHeight += image.Size.Height + 10;
    SetRowHeight(xlWorkSheet, i + 2, image.Size.Height + 10);
} 
```

有任何想法吗？

感谢你们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:46:19.530

甚至几周前我也遇到了同样的问题。我通过将图像绑定到gridview解决了这个问题。唯一的缺点是图像将在左上角有gridview列的名称。如果你愿意，我可以为你提供代码。虽然我的技术你不需要office.interop.excel。

# ios - 我正在尝试实现 NIPhotoScrollView 但我的代码不起作用，即未调用数据源方法和委托方法

> ID：10431154
> 
> 赞同：1
> 
> 时间：2012-05-03T12:13:32.367
> 
> 标签：ios, nimbus

我一直在尝试实现 NIPhotoAlbumScrollView [http://jverkoey.github.com/nimbus/interface_n_i_photo_album_scroll_view.html](http://jverkoey.github.com/nimbus/interface_n_i_photo_album_scroll_view.html)。我在应用程序包中使用照片。但是这段代码不起作用。这是完整代码的链接[http://pastebin.com/ysvPL6ee](http://pastebin.com/ysvPL6ee)

```
AlbumViewController.h

@interface AlbumViewController : NIToolbarPhotoViewController    <NIPhotoAlbumScrollViewDataSource>
{
    NSMutableArray* photoInformation;
}
@end

#import "AlbumViewController.h"

@implementation AlbumViewController

#pragma mark - View lifecycle

// Implement loadView to create a view hierarchy programmatically, without using a nib.
- (void)loadView
{
    photoInformation = [[NSMutableArray alloc] init];

    for(int i=0; i<2; i++)
    {
        NSString* originalImageSource = @"Photo001.jpg";
        NSString* thumbnailImageSource = @"img1.jpg";
        NSDictionary* prunedPhotoInfo = [NSDictionary dictionaryWithObjectsAndKeys:
                                            originalImageSource, @"originalSource",
                                            thumbnailImageSource, @"thumbnailSource",
                                            nil];
        [photoInformation addObject:prunedPhotoInfo];
    }

    self.photoAlbumView.dataSource = self;

    self.title = NSLocalizedString(@"Loading...", @"Navigation bar title - Loading a photo album");

    [self.navigationController setNavigationBarHidden:NO];

    [self.photoAlbumView reloadData];
} 
```

编辑

不工作意味着 - 它不加载图像，甚至不显示加载图像

```
self.photoAlbumView.loadingImage = [UIImage imageWithContentsOfFile:
                                    NIPathForBundleResource(nil, @"img1.jpg")]; 
```

![只显示黑屏](../Images/5d1ac46477751b523f5ede8179828aef.png)

- (NSInteger)numberOfPagesInPagingScrollView:(NIPagingScrollView *)pagingScrollView 或任何其他方法没有被调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T10:26:26.907

我忘记在 loadView 方法的开头添加 [super loadView]。

```
// Implement loadView to create a view hierarchy programmatically, without using a nib.
- (void)loadView
{
    [super loadView];
    photoInformation = [[NSMutableArray alloc] init];

    for(int i=0; i<2; i++)
    {
        NSString* originalImageSource = @"Photo001.jpg";
        NSString* thumbnailImageSource = @"img1.jpg";
        NSDictionary* prunedPhotoInfo = [NSDictionary dictionaryWithObjectsAndKeys:
                                            originalImageSource, @"originalSource",
                                            thumbnailImageSource, @"thumbnailSource",
                                            nil];
        [photoInformation addObject:prunedPhotoInfo];
    }

    self.photoAlbumView.dataSource = self;

    self.title = NSLocalizedString(@"Loading...", @"Navigation bar title - Loading a photo album");

    [self.navigationController setNavigationBarHidden:NO];

    [self.photoAlbumView reloadData];
} 
```

# groovy - 使用 GroovyResourceLoader 的示例和提示

> ID：10431157
> 
> 赞同：0
> 
> 时间：2012-05-03T12:13:36.827
> 
> 标签：groovy

我正在尝试安装我自己的 GroovyResourceLoader 并且想知道是否有权威指南描述所有移动位。

我注意到当 groovy 尝试编译脚本时，它确实会尝试通过向 GRL 发送路径来查找类型。然而，它有时会做一些奇怪的事情，它使用'$'作为分隔符，而其他时候它使用普通的旧'.'。

这是尝试加载某些内容的一些日志记录的快照。忽略自动导入的东西，注意它是如何使用“$”作为包分隔符的，然后将每个“$”一次替换为一个“.”。

```
-->a$b$groovy$X$Something
-->a.b$groovy$X$Something
-->a.b.groovy$X$Something 
```

我正在使用 Groovy 1.8.0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T11:24:34.330

您看到的“$”来自尝试匹配内部类的 Groovy。我强烈假设您在某个地方有一个“abgroovy.X.Something”，它将引导 groovy 尝试为这个发现各种内部类组合。例如，您可以有一个“a$b$groovy$X$Something.groovy”文件。

# java - 如何以编程方式访问网页（Google Adsense）或电子邮件、聊天？

> ID：10431162
> 
> 赞同：1
> 
> 时间：2012-05-03T12:13:51.337
> 
> 标签：java, web-services, chat, adsense

我想处理网页（Google Adsense）或电子邮件、聊天。为此，我需要以编程方式访问网页（Google Adsense）或电子邮件、聊天。是否有任何可用的 Java API 或网络服务可供我们访问这些（Google Adsense、Microsoft AdCenter、电子邮件、聊天）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:25:40.670

对于 google adsence api -[链接](https://developers.google.com/adsense/)

对于谷歌聊天 api -[链接](https://developers.google.com/talk/)

Microsoft AdCenter api -[链接](http://advertising.microsoft.com/small-business/search-advertising/adcenter-api)

用于电子邮件 - 您可以根据支持的协议编写电子邮件客户端

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:28:02.780

这个问题非常棘手。如果只是想要获取的网页响应，那么可以使用[Apache 的 HTTPClient API](http://hc.apache.org/httpcomponents-client-ga/index.html)

如果您想单独访问这些网站的服务，那么您必须查看这些网站是否通过 SOAP 或 REST 公开其服务

# java - 会话过期时尝试注销导致登录后重定向到登录页面

> ID：10431173
> 
> 赞同：3
> 
> 时间：2012-05-03T12:14:22.463
> 
> 标签：java, spring, redirect, spring-security

如果标题不够清楚，我很抱歉。这是详细信息。

**背景**

我正在开发使用 Spring 3.1.1 和 Spring security 3.1.0 的基于 Spring 的应用程序。这是我们描述符的相关片段：

```
<security:http auto-config='true'>      
    <security:intercept-url pattern="/login.jsp*" access="IS_AUTHENTICATED_ANONYMOUSLY" />
    <security:intercept-url pattern="/login*" access="IS_AUTHENTICATED_ANONYMOUSLY" />
    <security:intercept-url pattern="/**" access="ROLE_USER" />     
    <security:form-login login-page='/login' authentication-failure-url="/login?authfailed=true"/>              
</security:http> 
```

网页上的“退出”链接指的是 URL，如`ROOT-URL/j_spring_security_logout`. 因此，单击此 URL 会将我们带到登录页面 ( `login.jsp`)，并且可以再次成功登录。

**问题**

如果用户登录到应用程序，等到会话过期，然后尝试注销他到达登录页面。这可以。然后他输入正确的凭据并单击登录按钮。*现在他被重定向到相同的登录页面，其中用户名和密码字段为空，而不是进入应用程序。*第二次尝试登录成功。

**重要提示：**仅当用户之前登录、会话已过期并且他尝试注销时才会发生这种情况。例如，如果用户在会话到期后单击任何其他链接，则不会发生这种情况。在这种情况下，他会被重定向到登录页面，并且可以从第一次尝试成功登录。

**分析**

我的调查显示如下。由于 HTTP 重定向导致我们两次到达登录页面，`SavedRequestAwareAuthenticationSuccessHandler.onAuthenticationSuccess()`并且因为`requestCache`包含对登录页面的请求而发生。是在会话属性中存储“缓存”请求`requestCache`的类型变量。`HttpSessionRequestCache``"SPRING_SECURITY_SAVED_REQUEST"`

在正常情况下，此缓存用于重定向到未经身份验证的用户在其身份验证后请求的页面。

但这就是我们的案例中发生的情况。用户登录。然后他的会话过期了。然后他点击链接退出。由于会话已过期，用户被重定向到“j_spring_security_logout”，将他重定向到登录页面。

在这种方式的某个地方，登录 URL 被缓存为“请求的”，因此当用户登录时，他被重定向到请求的 URL，即登录页面。当重定向发生时，缓存的 URL 被删除，因此不会发生无限循环；第二次尝试登录成功。

以下是相关代码参考：

`ExceptionTranslationFilter.handleSpringSecurityException()` 调用`sendStartAuthentication()`（第 168 行）

执行以下操作（第 183-184 行）：

```
 SecurityContextHolder.getContext().setAuthentication(null);
    requestCache.saveRequest(request, response); 
```

但是此时请求的 URL 是登录页面。因此，登录页面被缓存。

看起来此时`saveRequest()`不应调用 just ，例如，这闻起来是 Spring 框架中的错误...

我有这个问题的解决方案，我会在这里发布。但是我的解决方案对我来说看起来像是一个补丁，所以我希望有人知道“正确”的解决方案。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T13:25:01.507

```
<intercept-url pattern="/login.jsp*" access="permitAll" />
<intercept-url pattern="/login*" access="permitAll" /> 
```

没有理由对登录页面本身施加任何限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T13:41:27.320

试试这个，它对我有用：

```
<security:form-login 
        login-page="/login.jsp" 
        default-target-url="/home.jsp"
        always-use-default-target="true" 
        authentication-failure-url="/login?authfailed=true"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-26T02:31:26.413

代替：

```
.defaultSuccessUrl("/paginas/geral/index.jsf") 
```

经过：

```
.defaultSuccessUrl("/paginas/geral/index.jsf", true) 
```

> http.authorizeRequests() .anyRequest().authenticated() .and() .formLogin() .loginPage("/login.jsf") .permitAll() .usernameParameter("login") .passwordParameter("senha") 。 defaultSuccessUrl("/paginas/geral/index.jsf", true) .failureUrl("/login.jsf?invalid=true");

这个对我有用。（弹簧安全网络：4.1.3.RELEASE）

# javascript - 使用 Raphael 在鼠标悬停时缩放一个圆圈

> ID：10431180
> 
> 赞同：2
> 
> 时间：2012-05-03T12:15:10.040
> 
> 标签：javascript, jquery, raphael

你能帮我解决这个问题吗？

我正在使用 Raphael 绘制一个圆圈。在鼠标悬停时，圆圈应该放大和缩小（缩放）。

我可以轻松地增加圆圈的大小，但我想要在增加圆圈大小之间产生一些效果。它应该像弹性一样增加。

我想用 Raphel 开发那个动画。你能帮我么

这是我写的代码：

```
smallCircles[0].hover(function () { 
    smallCircles[0].animate({ fill: 'rgb(231,88,88)', opacity: 0.95, r: 55,r:45,r:55, 'stroke-width': 0 }, 100); 
  },
  function () { 
    smallCircles[0].animate({ fill: 'rgb(240,153,153)', opacity: 0.8, r: 35, 'stroke-width': 0 }, 300); 
}); 
```

谢谢，龙树菩萨

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T10:08:51.590

您是否尝试过使用内置的缓动修饰符？

我没有测试过下面的，但也许它有效。我添加了“弹性”作为该方法的`easing`参数`animate`

```
smallCircles[0].hover(function () { 
    smallCircles[0].animate({ fill: 'rgb(231,88,88)', opacity: 0.95, r: 55,r:45,r:55, 'stroke-width': 0 }, 100, 'elastic'); 
  },
  function () { 
     smallCircles[0].animate({ fill: 'rgb(240,153,153)', opacity: 0.8, r: 35, 'stroke-width': 0 }, 300, 'elastic'); 
}); 
```

# ajax - 如何在 mvc3 中通过 ajax 调用局部视图

> ID：10431181
> 
> 赞同：4
> 
> 时间：2012-05-03T12:15:10.180
> 
> 标签：ajax, asp.net-mvc-3, asp.net-mvc-ajax

我需要通过 ajax 调用局部视图。我已经尝试了以下，但我不知道如何完成它。

```
$("#UserName").change(function () {
        var userid = $("#UserName").val();
        var ProvincialStateID = $("#State").val();
        var Hobbyid = $("#Hobby").val();
        var Districtid = $("#DistrictNames").val();
        var Homeid = $("#Hobbyhome_EstablishmentId").val();
        var urlperson = '@Url.Action("FetchPersonByUserName")';
        $.ajax({
            type: "POST",
            url: urlperson,
            data: { userid: userid, stateid: ProvincialStateID, hobbyid: Hobbyid, districtid: Districtid, homeid: Homeid },
            success: function (data) { 
           //Dont know what to write here
        });
    }); 
```

这是我在控制器中编写的函数：

```
 [HttpPost]
    public ActionResult FetchPersonByUserName(int userid,int stateid,int districtid,int homeid,int Hobbyid)
    {
      //Code to fetch the data in the partial using all parameters
      return PartialView("_LearnerAssociationGridPartial", list);
    } 
```

当我单击下拉菜单时，将调用 ajax，我希望通过 ajax 调用的函数将其重定向到局部视图。请帮助我，因为目前我无法显示我的部分视图

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T12:26:55.573

你需要的是类似

```
$.ajax({
   type: "POST",
   url: urlperson,
   data: { userid: userid, 
           stateid: ProvincialStateID, 
           hobbyid: Hobbyid, 
           districtid: Districtid, 
           homeid: Homeid },
    success: function (data) { 
          var result = data; 
          $('targetLocation').html(result);
    }
   }); 
```

建议不要直接使用变量中的数据，但您可以。现在目标位置是您希望显示结果的位置。

在这里查看更多信息：

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

至于缓慢获取数据，请尝试优化您的查询

**更新** 对于 nhibernate 运行缓慢，请尝试[http://www.hibernatingrhinos.com/products/nhprof](http://www.hibernatingrhinos.com/products/nhprof)这是 nhibernate profiler，付费版本，或尝试 sql profiler 查看正在执行的查询，通常您可以获得更多由于查询的复杂性，会期望和/或真的很慢查询。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T12:22:26.573

我不明白您所说的重定向到部分视图是什么意思。通常人们使用 ajax 和 Partial 视图来获取页面的一部分而无需刷新页面（你可能已经在这个站点/facebook/twitter 等中看到过这种行为。）所以我猜你可能想要显示你正在获取的数据异步显示在当前页面的一部分中。你可以在你的成功处理程序中做到这一点

```
$.ajax({
        type: "POST",
        url: urlperson,
        data: { userid: userid, stateid: ProvincialStateID, hobbyid: Hobbyid, districtid: Districtid, homeid: Homeid },
        success: function (data) { 
          $("#divUserInfo".html(data);
        }
 }); 
```

`divUserInfo`假设您在当前页面中有一个带有 id 的 div 。

如果你真的想在 ajax 发布后重定向，你可以这样做。

```
$.ajax({
        type: "POST",
        url: urlperson,
        data: { userid: userid, stateid: ProvincialStateID, hobbyid: Hobbyid, districtid: Districtid, homeid: Homeid },
        success: function (data) { 
          window.location.href="Why-I-need-Ajax-Then.php";
        }
 }); 
```

就个人而言，我不使用`HttpPost`（在客户端和服务器中）如果它是`GET`某些数据的方法。我简单地使用 jquery 获取或加载。

```
$.get("yourUrl", { userid: userid, stateid: ProvincialStateID } ,function(data){
  $("#divUserInfo".html(data);
}); 
```

# core-data - iOS核心数据：存储与不同实体中任何NSManagedObject的关系

> ID：10431192
> 
> 赞同：1
> 
> 时间：2012-05-03T12:15:41.747
> 
> 标签：core-data, ios5

我想实现一个引用任何类型对象的表，例如一个引用来自人员、地址、...的对象的存档表

自然，我不喜欢为每个表（archivedPersons、archivedAddresses 等）建立额外的关系。有没有办法简单地与“NSManagedObject”建立关系？保存属性“NSManagedObject”并为每个归档对象都有一个条目也没有问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T14:16:58.097

不幸的是，你有点卡住了。您可以创建一个基础实体，并从中继承其他实体。然后，您可以只与 Base 实体建立一对多的关系。

这很好用，就像你认为的那样。但是，有一个很大的缺点。所有子实体都分组到一个表中。因此，子实体中的每个属性都有一个列。如果您没有大型数据库，这可能没问题。或者，如果您的行填充了大约 70%，那么也可以。您应该检查将浪费多少空间，看看这个选项是否真的适合您。

另一种选择是存储一组对象 ID，并手动获取引用的对象。

或者，如您之前所述，为每种实体类型使用一个引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-05T13:17:27.627

你可以这样做，但你必须自己编写一些代码。如果我对您的理解正确，您希望与任何类型的对象建立对多关系。

您需要做的是与对象一起存储一组（可能是有序的）对象 ID。*然后，您必须使用核心数据文档的非标准持久属性*部分中描述的技术之一从托管对象 <-> 对象 ID 集进行转换。

如果您有一组 URL（来自`-[NSManagedObjectID URIRepresentation]`），您可以使用`NSPropertyListSerialization`.

一个你有一组 URL，你可以将它们转换为对象。这是事情变得有点棘手的地方。您*必须*使用`NSFetchRequest`，但您只能对每个实体执行此操作。因此，您最好将实体名称与 objectID 一起存储。

由于获取请求的开销很大，因此您可能希望将`-[NSManagedObjectContext objectRegisteredForID:`所有尝试转换为对象的对象 ID 都用于这些 ID。如果此方法返回 non- `nil`，您可以直接使用该对象而无需执行 I/O（即获取请求）。`nil`然后，您只需使用返回的此方法（如果有）对这些对象 ID 执行获取请求。

我已经做到了。有用。但这不是直截了当的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T16:32:58.653

我有同样的问题（对于我的离线同步算法） ![并有错误：**配置错误的属性：Transactions.object 必须有一个目标实体**](../Images/6ff2660d9756a23a404692de6f497f42.png)

**错误配置的属性：Transactions.object 必须有一个目标实体** 0_0

并认为很好的解决方案，除了存储 ID 和用于搜索的表名称 - 存储到需要实体的链接 1。像这样： ![](../Images/3f750e065fd99a79d89686d278ae5406.png) 但我们不应该总是寻找实体。o_0

```
BEFORE
@interface Transactions : NSManagedObject

@property (nonatomic, retain) NSNumber * type;
@property (nonatomic, retain) NSNumber * order;
@property (nonatomic, retain) NSManagedObject *object;

AFTER
@interface Transactions : NSManagedObject

@property (nonatomic, retain) NSNumber * type;
@property (nonatomic, retain) NSNumber * order;
@property (nonatomic, retain) Workgroup *workgroup;
@property (nonatomic, retain) AgendaItem *agendaItem;
@property (nonatomic, retain) Meeting *note;
@property (nonatomic, retain) Meeting *meeting;
@property (nonatomic, retain) Person *person; 
```

**但是**！如果我们创建对象并删除它 - 我们意识到我们必须存储类型和 ID (( 这意味着 - 最后一个解决方案不适合删除实体的情况。并且解决方案属于我的情况是： ![我谴责自己不断通过表名和 ID 搜索实体](../Images/52f9517f1335c54846c0ea13a5c1e2c3.png) 我谴责自己的常数按表名和 ID o_o 搜索实体

# ios - 使用 TWRequest 验证用户名和密码

> ID：10431194
> 
> 赞同：1
> 
> 时间：2012-05-03T12:15:49.603
> 
> 标签：ios, twrequest

我对`TWRequest`.

我的要求是我需要在我的应用程序viewController中输入Twitter的用户名和密码，而不是在设备的设置中。

是否可以通过这种方式验证 Twitter 的登录凭据？

# iphone - iOS - 线程不会回到主线程

> ID：10431195
> 
> 赞同：3
> 
> 时间：2012-05-03T12:15:50.353
> 
> 标签：iphone, objective-c, ios, multithreading, objective-c-blocks

我的线程有问题。当线程忙时，我在 2 个屏幕之间切换了几次。线程不会执行每一行..，当它必须返回主线程时，断点就会消失。有人能帮帮我吗 ？

卸载视图时释放线程。

谢谢，

```
- (void)fetchFeedDataIntoDocument
{
    NSString * labelString = [NSString stringWithFormat:@"Feed Fetcher %@", self.pageTitle];
    const char *label = [labelString UTF8String];

    self.fetchF = dispatch_queue_create(label, NULL);
    dispatch_async(self.fetchF, ^{

        NSArray *feeds = [FeedFetcher getDataForJson:self.pageTitle downloadBy:@"up"];

        NSDictionary *lastfeed;

        AppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];

        NSManagedObjectContext *context = [appDelegate getManagedObjectContext];

        if ([feeds count] > 0)
        {
            lastfeed = [feeds objectAtIndex:0];

            [FeedFetcher setLastUpdateIdToCatgorie:self.pageTitle WithId:[lastfeed objectForKey:@"id"] AndPulishDate:[lastfeed objectForKey:@"publish_up"]];
        }

        for (NSDictionary *feedInfo in feeds) {
            [Feed FeedWithInfo:feedInfo InManageObject:context];
        }

        NSError *error = nil;

        [context save:&error];

        if (error){
            NSLog(@"Error save : %@", error);}

        dispatch_async(dispatch_get_main_queue(), ^{
            [self setupFetchedResultsController];
            [self.tableView reloadData];
            [self downloadImagesForFeeds:feeds];
        });

    }); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-03T13:28:36.463

您正在从创建它的不同线程访问 managedObjectContext。这是核心数据线程规则#1。

您正在从应用程序委托中获取 MOC。如果它是普通的 Xcode 生成的 MOC，那么它是使用线程限制并发创建的。你甚至不能用它来调用 performBlock。您只能从主线程访问该 MOC。时期。其他任何事情充其量都是在玩火。

如果你想在一个单独的线程中完成所有工作，你还需要一个单独的 MOC。像这样（只是输入-未编译）...

```
NSManagedObjectContext *moc = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
moc.parentContext = appDelegate.managedObjectContext;
[moc performBlock:^{
    // Go get your remote data and whatever you want to do

    // Calling save on this MOC will push the data up into the "main" MOC
    // (though it is now in the main MOC it has not been saved to the store).
    [moc save:&error];
}]; 
```

这将转化为这样的东西......

```
- (void)fetchFeedDataIntoDocument
{
    NSString * labelString = [NSString stringWithFormat:@"Feed Fetcher %@", self.pageTitle];
    const char *label = [labelString UTF8String];

    AppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];
    NSManagedObjectContext *mainContext = [appDelegate getManagedObjectContext];
    NSManagedObjectContext *context = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
    context.parentContext = mainContext;
    [context performBlock:^{    
        NSArray *feeds = [FeedFetcher getDataForJson:self.pageTitle downloadBy:@"up"];

        NSDictionary *lastfeed;

        if ([feeds count] > 0)
        {
            lastfeed = [feeds objectAtIndex:0];

            [FeedFetcher setLastUpdateIdToCatgorie:self.pageTitle WithId:[lastfeed objectForKey:@"id"] AndPulishDate:[lastfeed objectForKey:@"publish_up"]];
        }

        for (NSDictionary *feedInfo in feeds) {
            [Feed FeedWithInfo:feedInfo InManageObject:context];
        }

        NSError *error = nil;

        [context save:&error];

        if (error){
            NSLog(@"Error save : %@", error);}
DO you really want to continue on error?
        dispatch_async(dispatch_get_main_queue(), ^{
            // Data has been pushed into main context from the background
            // but it still needs to be saved to store...
            // Do not forget to perform error handling...
            NSError *error = nil;
            [mainContext save:&error];
            [self setupFetchedResultsController];
            [self.tableView reloadData];
            [self downloadImagesForFeeds:feeds];
        });

    }); 
```

**编辑**

Xcode 生成的用于创建 MOC 的代码使用 init，它使用 NSConfinementConcurrencyType。您可以用 MainConcurrency 替换它，没有任何问题，但可以获得一些好处。

在您的应用委托文件中，替换...

```
 __managedObjectContext = [[NSManagedObjectContext alloc] init]; 
```

有了这个...

```
 __managedObjectContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSMainQueueConcurrencyType]; 
```

现在，您的主 MOC 可以是“父级”，您也可以在其上调用 performBlock。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:24:08.773

更改以下代码..

```
 dispatch_queue_t queue1 = dispatch_queue_create("com.MyApp.AppTask",NULL);
   dispatch_queue_t main = dispatch_get_main_queue();
   dispatch_async(queue1, 
               ^{
                   dispatch_async(main, 
                                  ^{
                                      [self setupFetchedResultsController];
                                      [self.tableView reloadData];
                                      [self downloadImagesForFeeds:feeds];

                                  });

               }); 
```

希望对你有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:25:24.920

这样做怎么办...

```
-(void)functionToCallFetch {

     [self performSelectorInBackground:@selector(fetchFeedDataIntoDocument) withObject:nil];

} 

- (void)fetchFeedDataIntoDocument
{

     NSArray *feeds = [FeedFetcher getDataForJson:self.pageTitle downloadBy:@"up"];

        NSDictionary *lastfeed;

        AppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];

        NSManagedObjectContext *context = [appDelegate getManagedObjectContext];

        if ([feeds count] > 0)
        {
            lastfeed = [feeds objectAtIndex:0];

            [FeedFetcher setLastUpdateIdToCatgorie:self.pageTitle WithId:[lastfeed objectForKey:@"id"] AndPulishDate:[lastfeed objectForKey:@"publish_up"]];
        }

        for (NSDictionary *feedInfo in feeds) {
            [Feed FeedWithInfo:feedInfo InManageObject:context];
        }

        NSError *error = nil;

        [context save:&error];

        if (error){
            NSLog(@"Error save : %@", error);}

        //dispatch_async(dispatch_get_main_queue(), ^{
        //    [self setupFetchedResultsController];
        //    [self.tableView reloadData];
        //    [self downloadImagesForFeeds:feeds];
        //});
        [self performSelectorOnMainThread:@selector(setupFetchedResultsController) withObject:nil waitUntilDone:NO];
        [self.tableView performSelectorOnMainThread:@selector(reloadData) withObject:nil waitUntilDone:NO];
        [self performSelectorOnMainThread:@selector(downloadImagesForFeeds:) withObject:feeds waitUntilDone:NO];

} 
```

也许这样会更好？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T13:05:01.250

您是否尝试过构建类似的方法：

```
- (void)methodToBePerformedOnMainThread{
        [self setupFetchedResultsController];
        [self.tableView reloadData];
        [self downloadImagesForFeeds:feeds];
} 
```

并调用它

```
[self performSelectorOnMainThread:@selector(methodToBePerformedOnMainThread) withObject:nil waitUntilDone:NO]; 
```

在......的最后`fetchFeedDataIntoDocument`

编辑 ：

您是否尝试用 NSOperationQueue 代替 dispatch_queue 包装它？

像 ：

```
NSOperationQueue *operationQueue = [NSOperationQueue new];

NSInvocationOperation *operation = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(fetchFeedDataIntoDocument) object:nil];

if(operation != nil){
    [operationQueue addOperation:operation]; 
```

# android - java.io.IOException：收到的身份验证质询为空

> ID：10431202
> 
> 赞同：3
> 
> 时间：2012-05-03T12:16:33.893
> 
> 标签：android, httpurlconnection

我需要一个响应代码，但它会抛出一个 IOException。我不知道怎么回事！

```
 try
    {
        url = new URL(urlBuilder.toString());
        conn = (HttpURLConnection) url.openConnection();
        conn.setDoInput(true);
        conn.setConnectTimeout(TIME_OUT);
        conn.setRequestMethod(METHOD_GET);
        conn.setRequestProperty("accept", "*/*");
        conn.connect();
        int responseCode = conn.getResponseCode();   //throw IOException:Received authentication challenge is null
        if (responseCode == HTTP_OK)
        {
            inStream = conn.getInputStream();
            response = getResponse(inStream);
        }
        else
        {
            response = "response code："+responseCode;
        }
    } catch (Exception e)
    {
        throw e;
    }
    finally
    {
        conn.disconnect();
    }
    return response;
} 
```

IOException 是：

```
05-03 20:14:01.577: WARN/System.err(1515): java.io.IOException: Received authentication challenge is null
05-03 20:14:01.596: WARN/System.err(1515):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.doRequestInternal(HttpURLConnectionImpl.java:1694)
05-03 20:14:01.577: INFO/QQWeiBo(1515): Received authentication challenge is null
05-03 20:14:01.577: WARN/System.err(1515): java.io.IOException: Received authentication challenge is null
05-03 20:14:01.577: WARN/System.err(1515): java.io.IOException: Received authentication challenge is null
05-03 20:14:01.596: WARN/System.err(1515):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.doRequestInternal(HttpURLConnectionImpl.java:1694)
05-03 20:14:01.596: WARN/System.err(1515):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.doRequest(HttpURLConnectionImpl.java:1649)
05-03 20:14:01.596: WARN/System.err(1515):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getResponseCode(HttpURLConnectionImpl.java:1374)
05-03 20:14:01.596: WARN/System.err(1515):     at com.szy.weibo.service.SyncHttp.httpGet(SyncHttp.java:72)
05-03 20:14:01.596: WARN/System.err(1515):     at com.szy.weibo.service.Weibo.getRequestToken(Weibo.java:45)
05-03 20:14:01.606: WARN/System.err(1515):     at com.szy.weibo.MainActivity.startWebView(MainActivity.java:95)
05-03 20:14:01.606: WARN/System.err(1515):     at com.szy.weibo.MainActivity.authorization(MainActivity.java:83)
05-03 20:14:01.606: WARN/System.err(1515):     at com.szy.weibo.MainActivity$1.onClick(MainActivity.java:71)
05-03 20:14:01.606: WARN/System.err(1515):     at android.view.View.performClick(View.java:2408)
05-03 20:14:01.596: WARN/System.err(1515):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.doRequestInternal(HttpURLConnectionImpl.java:1694)
05-03 20:14:01.596: WARN/System.err(1515):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.doRequest(HttpURLConnectionImpl.java:1649)
05-03 20:14:01.596: WARN/System.err(1515):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getResponseCode(HttpURLConnectionImpl.java:1374)
05-03 20:14:01.596: WARN/System.err(1515):     at com.szy.weibo.service.SyncHttp.httpGet(SyncHttp.java:72)
05-03 20:14:01.596: WARN/System.err(1515):     at com.szy.weibo.service.Weibo.getRequestToken(Weibo.java:45)
05-03 20:14:01.606: WARN/System.err(1515):     at com.szy.weibo.MainActivity.startWebView(MainActivity.java:95)
05-03 20:14:01.606: WARN/System.err(1515):     at com.szy.weibo.MainActivity.authorization(MainActivity.java:83)
05-03 20:14:01.606: WARN/System.err(1515):     at com.szy.weibo.MainActivity$1.onClick(MainActivity.java:71)
05-03 20:14:01.606: WARN/System.err(1515):     at android.view.View.performClick(View.java:2408)
05-03 20:14:01.596: WARN/System.err(1515):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.doRequest(HttpURLConnectionImpl.java:1649)
05-03 20:14:01.596: WARN/System.err(1515):     at org.apache.harmony.luni.internal.net.www.protocol.http.HttpURLConnectionImpl.getResponseCode(HttpURLConnectionImpl.java:1374)
05-03 20:14:01.596: WARN/System.err(1515):     at com.szy.weibo.service.SyncHttp.httpGet(SyncHttp.java:72)
05-03 20:14:01.596: WARN/System.err(1515):     at com.szy.weibo.service.Weibo.getRequestToken(Weibo.java:45)
05-03 20:14:01.606: WARN/System.err(1515):     at com.szy.weibo.MainActivity.startWebView(MainActivity.java:95)
05-03 20:14:01.606: WARN/System.err(1515):     at com.szy.weibo.MainActivity.authorization(MainActivity.java:83)
05-03 20:14:01.606: WARN/System.err(1515):     at com.szy.weibo.MainActivity$1.onClick(MainActivity.java:71)
05-03 20:14:01.606: WARN/System.err(1515):     at android.view.View.performClick(View.java:2408)
05-03 20:14:01.606: WARN/System.err(1515):     at android.view.View$PerformClick.run(View.java:8816)
05-03 20:14:01.616: WARN/System.err(1515):     at android.os.Handler.handleCallback(Handler.java:587)
05-03 20:14:01.627: WARN/System.err(1515):     at android.os.Handler.dispatchMessage(Handler.java:92)
05-03 20:14:01.627: WARN/System.err(1515):     at android.os.Looper.loop(Looper.java:123)
05-03 20:14:01.627: WARN/System.err(1515):     at android.app.ActivityThread.main(ActivityThread.java:4627)
05-03 20:14:01.627: WARN/System.err(1515):     at java.lang.reflect.Method.invokeNative(Native Method)
05-03 20:14:01.606: WARN/System.err(1515):     at android.view.View$PerformClick.run(View.java:8816)
05-03 20:14:01.616: WARN/System.err(1515):     at android.os.Handler.handleCallback(Handler.java:587)
05-03 20:14:01.627: WARN/System.err(1515):     at android.os.Handler.dispatchMessage(Handler.java:92)
05-03 20:14:01.627: WARN/System.err(1515):     at android.os.Looper.loop(Looper.java:123)
05-03 20:14:01.627: WARN/System.err(1515):     at android.app.ActivityThread.main(ActivityThread.java:4627)
05-03 20:14:01.627: WARN/System.err(1515):     at java.lang.reflect.Method.invokeNative(Native Method)
05-03 20:14:01.627: WARN/System.err(1515):     at java.lang.reflect.Method.invoke(Method.java:521)
05-03 20:14:01.647: WARN/System.err(1515):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
05-03 20:14:01.647: WARN/System.err(1515):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
05-03 20:14:01.647: WARN/System.err(1515):     at dalvik.system.NativeStart.main(Native Method)
05-03 20:14:01.606: WARN/System.err(1515):     at android.view.View$PerformClick.run(View.java:8816)
05-03 20:14:01.616: WARN/System.err(1515):     at android.os.Handler.handleCallback(Handler.java:587)
05-03 20:14:01.627: WARN/System.err(1515):     at android.os.Handler.dispatchMessage(Handler.java:92)
05-03 20:14:01.627: WARN/System.err(1515):     at android.os.Looper.loop(Looper.java:123)
05-03 20:14:01.627: WARN/System.err(1515):     at android.app.ActivityThread.main(ActivityThread.java:4627)
05-03 20:14:01.627: WARN/System.err(1515):     at java.lang.reflect.Method.invokeNative(Native Method)
05-03 20:14:01.627: WARN/System.err(1515):     at java.lang.reflect.Method.invoke(Method.java:521)
05-03 20:14:01.647: WARN/System.err(1515):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
05-03 20:14:01.647: WARN/System.err(1515):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
05-03 20:14:01.647: WARN/System.err(1515):     at dalvik.system.NativeStart.main(Native Method)
05-03 20:14:01.627: WARN/System.err(1515):     at java.lang.reflect.Method.invoke(Method.java:521)
05-03 20:14:01.647: WARN/System.err(1515):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
05-03 20:14:01.647: WARN/System.err(1515):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
05-03 20:14:01.647: WARN/System.err(1515):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T13:44:03.217

大多数情况下，您可以通过在连接上再次调用 .getResponseCode() 来获得响应代码。起初这让我感到困惑，但如果你阅读 HttpURLConnectionImpl 足够多次，你的眼睛就会停止流血并看到真相......

如果您以这种方式修改代码，您将获得响应代码：

```
try
    {
        url = new URL(urlBuilder.toString());
        conn = (HttpURLConnection) url.openConnection();
        conn.setDoInput(true);
        conn.setConnectTimeout(TIME_OUT);
        conn.setRequestMethod(METHOD_GET);
        conn.setRequestProperty("accept", "*/*");
        conn.connect();
        int responseCode = conn.getResponseCode();   //throw IOException:Received authentication challenge is null
        if (responseCode == HTTP_OK)
        {
            inStream = conn.getInputStream();
            response = getResponse(inStream);
        }
        else
        {
            response = "response code："+responseCode;
        }
    } catch (Exception e)
    {
        // Here you can get the correct response code
        if (conn != null) {
            int responseCodeAfterException = conn.getResponseCode();
            // Handle according to new response code
        }
        // Maybe don't throw e if 401?
        throw e;
    }
    finally
    {
        conn.disconnect();
    }
    return response;
} 
```

请参阅 responseCodeAfterException。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-09T12:09:53.833

如果您可以对服务器端进行更改，则可以确保您发送了带有 401 状态代码的正确标头。来自[http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.2](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.2)

> 10.4.2 401 未经授权
> 
> 该请求需要用户身份验证。**响应必须包含一个 WWW-Authenticate 头域**（第 14.47 节）包含适用于所请求资源的质询。客户端可以使用合适的授权头域重复请求（第 14.8 节）。如果请求已包含授权凭证，则 401 响应表示已拒绝对这些凭证的授权。如果 401 响应包含与先前响应相同的质询，并且用户代理已经尝试了至少一次身份验证，则应该向用户呈现响应中给出的实体，因为该实体可能包含相关的诊断信息。HTTP 访问身份验证在“HTTP 身份验证：基本和摘要式访问身份验证”[43] 中进行了说明。

我使用与@tj-thind 相同的代码，直到遇到@Chiara 描述的情况。然后我在我的服务器脚本中添加了`WWW-Authenticate`标`Content-Length`头，现在我可以在使用`getResponseCode()`.

另请参阅[IOException：“收到的身份验证质询为空”（Apache Harmony/Android）](https://stackoverflow.com/questions/1357372/ioexception-received-authentication-challenge-is-null-apache-harmony-android)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T20:19:43.837

我自己以前也遇到过这个问题。该异常实际上是`getResponseCode`在 401 事件中引发的，这是未经授权的 HTTP 代码。这似乎是 Android 实现所独有的`HttpURLConnection`。我发现处理它的最简单方法就是处理 catch 块中的 401。

```
catch (java.io.IOException e) {
    //Probably got a 401 here
    response = "response code："+401;
} 
```

# android - Android MediaPlayer Uri.parse 问题（Api 15）

> ID：10431209
> 
> 赞同：0
> 
> 时间：2012-05-03T12:17:05.563
> 
> 标签：android, stream, nullpointerexception, mp3, android-mediaplayer

我正在使用一本名为 Android Wireless Application Development 2nd edition 2009（L.Darcey & S.Conder，Addison Wesley 出版）的书作为我目前正在学习的 Android 应用程序开发课程的文献资料。在本书的第三章中，您将使用 MediaPlayer 类来启动一个媒体播放器对象，以使用下面的此方法将 mp3 文件流式传输到您的应用程序。

```
public void playMusicFromWeb() {
    try {
        Uri file = Uri.parse("http://downloads.bbc.co.uk/podcasts/6music/adamandjoe/adamandjoe_20111231-1430a.mp3");
        mp = MediaPlayer.create(this, file);
        mp.start();
    }
    catch (Exception e) {
        Log.e(DEBUG_TAG, "Player failed", e);
    }
} 
```

快乐的日子，这一切都在 API 8 中运行良好（这就是本书使用的）。但是，尝试在更高的 API 中使用此方法，尤其是 15 （在编写时）最新可用的 API，我被`NullPointerException`抛出了。调试使我变得更聪明，因为`file`变量似乎可以很好地保存字符串值，但它不会转换为功能性 mp3 流。我尝试过使用`prepare(); prepareAsync(); setDataSource(); reset();`等的各种不同方法，但似乎没有任何效果。你会认为我的老师可以帮助我，但他们显然也不知道该怎么做。我现在假设这种流式传输方式在高于 8 的 API 中必须过时。如果有人能阐明如何在 API 15 中流式传输 mp3 文件，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:23:38.970

我认为你必须做的不止这些。[这](http://davanum.wordpress.com/2007/12/29/android-videomusic-player-sample-from-local-disk-as-well-as-remote-urls/)是一个做你想做的事的例子：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:26:44.870

1.  URL的标头`content-type`可能不好。

2.  你可以试试这个语法：

    ```
    MediaPlayer mp = new MediaPlayer();
    mp.setDataSource(URL_OF_FILE);
    mp.prepare();
    mp.start(); 
    ```

    看看有没有`NullPointerException`遗体。

3.  您还可以查看[有关此特定主题的更新教程](http://blog.infidian.com/2008/04/04/tutorial-custom-media-streaming-for-androids-mediaplayer/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-09T16:45:15.170

就像添加这一行一样简单：

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

到清单文件！

# javascript - 更改图像源但图像不出现

> ID：10431210
> 
> 赞同：0
> 
> 时间：2012-05-03T12:17:17.560
> 
> 标签：javascript

我在线获取了此代码，并希望将图像源从在线图片更改为我根文件夹中的图片。但是每次我更改文件位置时，图像都不会出现。

```
var firstreel=new reelslideshow({
    wrapperid: "myreel", //ID of blank DIV on page to house Slideshow
    dimensions: [1310, 400], //width/height of gallery in pixels. Should reflect dimensions of largest image
    imagearray: [
        ["http://i30.tinypic.com/531q3n.jpg"], //["image_path", "optional_link", "optional_target"]
        ["http://i29.tinypic.com/xp3hns.jpg", "http://en.wikipedia.org/wiki/Cave", "_new"],
        ["http://i30.tinypic.com/531q3n.jpg"],
        ["http://i31.tinypic.com/119w28m.jpg"] //<--no trailing comma after very last image element!
    ], 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:25:56.760

将其放置到路径中没有空格的文件夹中，或者将路径中的空格替换为 %20（url 编码的空格字符）

如果 html / js 位于“Project AMBIENT”文件夹中，则不必使用完整路径。您可以使用“./Photos/xyz.ext”或取决于文件的放置位置“../Photos/xyz.ext”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:26:25.450

尝试使用`file:///C:\Users\Rizal\Desktop\Project_AMBIENT\Photos\b.jpg`

你将不得不正确地转义空格`Project Ambient`或将其重命名为`Project_AMBIENT`或类似的东西。

[文件 URI 方案](http://en.wikipedia.org/wiki/File_URI_scheme)

**更新**

将以下内容放入名为“img_form.html”的文件中并双击它：

```
<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
</head>

<body>
<form id="target" action="javascript:return false;">
  <input type="text" value="http://i30.tinypic.com/531q3n.jpg" />
  <input type="submit" value="Go" />
</form>
<br>
<img id="image"/>

<script>
$('#target').submit(function() {
  $('#image').attr('src', $("input:first").val());
});    
</script>
</body> 
```

现在将输入表单中的文本更改为某个本地 url：

Unix：

```
file:///Users/snies/Pictures/043.jpg 
```

视窗：

```
file://localhost/c:/some/folder/foo.jpg
file:///c:/some/folder/foo.jpg 
```

并按下按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:29:02.557

您不能使用本地文件路径：

```
C:\Users\Rizal\Desktop\Project AMBIENT\Photos\b.jpg 
```

您必须使用托管在 Web 服务器上的文件：

```
www.x.com/images/stuff.jpg 
```

# android - 平板电脑上的 HDMI 视频输出空白

> ID：10431218
> 
> 赞同：1
> 
> 时间：2012-05-03T12:17:52.180
> 
> 标签：android, hdmi

我的 Android 应用使用 videoView 在应用内播放视频。使用 HDMI 将平板电脑连接到电视时，我可以在电视上看到我的平板电脑屏幕。

一切似乎都运行良好，但是在我的应用程序中，我的 videoView 仅显示在电视上。平板电脑只是空白。有没有办法强制 videoView 在电视和平板电脑上播放视频？我希望两个屏幕相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:31:18.157

HDMI 输出不是 Android SDK 的一部分，在许多情况下甚至不是标准 Android 操作系统的一部分。设备制造商可以根据平板电脑上显示的内容和电视上显示的内容来做他们想做的事。没有任何东西可以控制`VideoView`或`MediaPlayer`控制这种行为。

如果您的目标是某些特定的硬件，您可以尝试联系制造商，看看他们是否有一些超出 SDK 的方法来控制它。

# java - java方波

> ID：10431223
> 
> 赞同：3
> 
> 时间：2012-05-03T12:18:15.890
> 
> 标签：java, linux-kernel, signal-processing

我正在尝试使用 java 在并行端口上创建方波。到目前为止，我有这个实现。

```
public class Wave extends Thread {

    public Wave() {
        super();
        setPriority(MAX_PRIORITY);
    }

    @Override
    public void run() {
        Wave.high();
        LockSupport.parkNanos(20000000);
        Wave.low();
        LockSupport.parkNanos(20000000);
    }

    public static native void high();
    public static native void low();
} 
```

其中 high() 和 low() 是使用 JNI 实现的（一个共享的 C 库控制并行端口）。它工作得很好；它会产生一个周期约为 40ms 的方波。当计算机空闲时，使用示波器看起来标准偏差约为 10 微秒。当计算机不空闲时，标准偏差变得更大。我认为这是因为发生了更多的上下文切换，线程在等待状态中停留的时间太长，并且没有准确地达到指定的 20 毫秒。

有没有办法让我的实现更准确？我知道我可以为此使用硬件，但我想知道我是否也可以使用软件来做到这一点。

是否可以选择“听”时钟并执行计时到毫秒的操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:23:33.110

仅仅“听”时钟并不能解决上下文切换导致抖动的问题。

如果您可以为此奉献一个核心：

*   [将线程绑定到核心](http://en.wikipedia.org/wiki/Processor_affinity)；
*   [将 IRQ 处理移至其他核心](http://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_MRG/2/html/Realtime_Tuning_Guide/sect-Realtime_Tuning_Guide-General_System_Tuning-Interrupt_and_Process_Binding.html)；
*   有一个[紧密的循环](https://stackoverflow.com/questions/2212973/what-is-a-tight-loop)不断检查时间（使用[`System.nanoTime()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/System.html#nanoTime%28%29)or [`RDTS`/`RDTSCP`](http://en.wikipedia.org/wiki/Time_Stamp_Counter)），并酌情调用`high()`/ `low()`。

这样，您应该能够实现非常低的抖动。

当然，如果任务只是简单地产生方波，那么这是对计算资源的非常低效的使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T13:08:58.690

我认为会有两个抖动来源。

首先，Java 中的垃圾收集（可能还有其他后台进程，如 JIT）。对于您提供的代码，不应该有任何 gc。但如果这是更大系统的一部分，那么您可能会发现需要进行垃圾收集，并且它可能会改变运行时的时间。您可以尝试通过使用 jvm 设置 (java -X) 来改善这一点。

第二，系统调度器。除了 aix 的建议之外，您还可以提高进程的优先级并进行一些特定于 linux 的调整。 [这篇文章](http://www.eetimes.com/design/embedded/4371651/Comparing-the-real-time-scheduling-policies-of-the-Linux-kernel-and-an-RTOS-)解释了 linux 的一些问题。 [ubuntu 有一个低延迟内核](https://launchpad.net/ubuntu/+source/linux-meta-lowlatency/3.2.0.23.20)，你可以安装它，但我找不到它实际包含的信息，所以你可以在其他系统上做同样的事情（更新：我认为它可能包含[这个补丁](http://www.kernel.org/pub/linux/kernel/projects/rt/3.2/)）。如果您想查找更多信息，“低延迟”是要搜索的关键思想，而在 linux 上进行音频处理的人往往是最关心这一点的人）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:32:47.957

如果您的上下文切换不会导致太多延迟，您可以尝试将线程停在给定时间，而不是给定时间间隔：

```
public class Wave extends Thread {
    private final Object BLOCKER = new Object();

    public Wave() {
        super();
        setPriority(MAX_PRIORITY);
    }

    @Override
    public void run() {
      // I suspect this should be running in an endless loop?
      for (;;) {
        Wave.high();
        long t1 = System.currentTimeMillis();

        // Round interval up to the next 20ms "deadline"
        LockSupport.parkUntil(BLOCKER, t1 + 20 - (t1 % 20));
        Wave.low();

        // Round interval up to the next 20ms "deadline"
        long t2 = System.currentTimeMillis();
        LockSupport.parkUntil(BLOCKER, t2 + 20 - (t2 % 20));
      }
    }

    public static native void high();
    public static native void low();
} 
```

由于这依赖于 中的挂钟时间`ms`，而不是更精确的纳秒时间，因此这不适用于更高的频率。但这也可能不起作用，因为 GC（和其他进程）可能会在“不幸”的时间内中断该线程，从而导致相同的抖动。

当我在我的带有 JDK 6 的 Windows 7 四核上测试这个时，我每秒都有一些不可忽略的抖动，所以[aix 的解决方案](https://stackoverflow.com/a/10431303/521799)可能更好

# .htaccess - 使用 .htaccess 将所有请求重定向到根 URL

> ID：10431229
> 
> 赞同：0
> 
> 时间：2012-05-03T12:18:36.610
> 
> 标签：.htaccess, redirect

我对 .htaccess 规则很不满意，所以你能帮忙吗？

我正在寻找这种情况：

```
No matter what subdomain the request is for, the visitor is 301'd to the root of the domain. 
```

因此，例如：

*   [http://www.doma.in](http://www.doma.in)被重定向到[http://doma.in](http://doma.in)
*   [http://foo.doma.in](http://foo.doma.in)被重定向到[http://doma.in](http://doma.in)
*   [http://bar.doma.in](http://bar.doma.in)被重定向到[http://doma.in](http://doma.in)
*   [http://www.doma.in/images/image-1.png](http://www.doma.in/images/image-1.png)被重定向到[http://doma.in/images/image-1.png](http://doma.in/images/image-1.png)
*   [http://foo.doma.in/images/image-2.png](http://foo.doma.in/images/image-2.png)被重定向到[http://doma.in/images/image-2.png](http://doma.in/images/image-2.png)
*   [http://bar.doma.in/images/image-3.png](http://bar.doma.in/images/image-3.png)被重定向到[http://doma.in/images/image-3.png](http://doma.in/images/image-3.png)

而且，只是为了`index.html`：

*   [http://www.doma.in/index.html](http://www.doma.in/index.html)仍然被重定向到[http://doma.in](http://doma.in)
*   [http://foo.doma.in/index.html](http://foo.doma.in/index.html)仍然被重定向到[http://doma.in](http://doma.in)
*   [http://bar.doma.in/index.html](http://bar.doma.in/index.html)仍然被重定向到[http://doma.in](http://doma.in)

提前感谢大家的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:48:36.050

`RedirectMatch 301 (.*)doma.in(.*)$ http://doma.in$2`几乎“doma.in”之前的所有内容都被忽略，但域之后的所有内容都被正常重定向（注意`$2`，`$1`是域名“doma.in”之前的所有内容，但我认为你不需要那个......如果你告诉我我会编辑我的答案）

希望它有所帮助

# twisted - 如何将结构化数据从 Twisted 发送到 syslog？

> ID：10431238
> 
> 赞同：2
> 
> 时间：2012-05-03T12:19:19.043
> 
> 标签：twisted, syslog, rsyslog

我正在尝试将[RFC5424](https://www.rfc-editor.org/rfc/rfc5424)中定义的结构化数据从 Twisted 发送到系统日志。我在 Ubuntu 上，系统日志实现是 rsyslog。

我正在使用“ `twistd --syslog`”运行扭曲的应用程序，它将使用 log.msg 和 log.err 发送的消息发送到 syslog。

到目前为止，我一直在尝试根据规范格式化 log.msg 中的消息，例如：

```
log.err('[exampleSDID@32473 iut="3" eventSource="Application" eventID="1011"]') 
```

但这不起作用。Rsyslog 只是将其显示为常规消息。有人知道怎么做这个吗？我应该看看不同的日志库吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-06T11:28:57.480

似乎该问题与 Twisted 的 syslog 集成无关，而是 Python 的 stdlib syslog 模块不支持 RFC 5424 中描述的日志记录格式。

此外，RFC 5424 似乎 [在到达时已死](http://www.gossamer-threads.com/lists/rsyslog/users/6361)（至少是结构化数据部分）。它很可能会被[Project lumberjack](https://fedorahosted.org/lumberjack/)中描述的基于 JSON 或 XML 的语法所取代。因此，如果您对更结构化的日志记录感兴趣，您可能应该看看。

要根据该标准格式化消息，可以使用符合标准的自定义格式化程序，就像[这里](http://plumberjack.blogspot.com/2012/03/structured-logging.html)给出的那样。

# xml - XPATH 过滤掉带有字母的记录

> ID：10431239
> 
> 赞同：2
> 
> 时间：2012-05-03T12:19:21.883
> 
> 标签：xml, xslt, xpath

我正在寻找一个 XPATH 表达式，它将执行搜索以确保字段中没有字母。例如输入 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<payload>
    <records>
        <record>
            <number>123</number>
        </record>
        <record>
            <number>456</number>
        </record> 
        <record>
            <number>78A</number>
        </record> 
    </records>
</payload> 
```

我希望它也过滤掉第三个结果，因为它在标签中有一个字母。所以返回这个：

```
<?xml version="1.0" encoding="UTF-8"?>
<payload>
    <records>
        <record>
            <number>123</number>
        </record>
        <record>
            <number>456</number>
        </record> 
    </records>
</payload> 
```

可以在简单的 XPATH 中做到这一点吗？

所以像`/payload/records/record[reg expression here?]`

**@Cylian**

这就是我的意思：

```
<?xml version="1.0" encoding="UTF-8"?>
<payload>
    <records>
        <record>
            <number>123</number>
            <time>12pm</time>
            <zome>UK</zome>
        </record>
        <record>
            <number>456</number>
            <time>12pm</time>
            <zome>UK</zome>
        </record> 
        <record>
            <number>78A</number>
            <time>12pm</time>
            <zome>UK</zome>
        </record> 
    </records>
</payload> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T13:01:45.857

XPath（1.0 和 2.0）是一种用于 XML 文档的查询语言。

因此，**XPath 表达式仅选择节点集（或提取其他数据），但不能改变 XML 文档的结构（如删除节点）**。

因此，不可能构造一个将提供的 XML 文档更改为所需的 XPath 表达式。

使用 XSLT 或 XQuery 可以轻松完成此任务（不那么容易）：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match="record[translate(number, '0123456789', '')]"/>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<payload>
    <records>
        <record>
            <number>123</number>
        </record>
        <record>
            <number>456</number>
        </record>
        <record>
            <number>78A</number>
        </record>
    </records>
</payload> 
```

**产生了想要的正确结果：**

```
<payload>
   <records>
      <record>
         <number>123</number>
      </record>
      <record>
         <number>456</number>
      </record>
   </records>
</payload> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T13:41:21.513

您也可以使用 XQuery Update 表达式轻松删除节点：

```
for $record in doc('payload.xml')//record
where xs:string(number($record/number)) = 'NaN'
return delete node $record 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:33:24.487

**试试这个（XPath 2.0）：**

```
/payload/records/record[matches(child::*/text(),'[^\p{L}]')] 
```

# ruby-on-rails-3 - 从 ActiveAdmin 设置活动历史记录的任何方式

> ID：10431241
> 
> 赞同：1
> 
> 时间：2012-05-03T12:19:24.047
> 
> 标签：ruby-on-rails-3, activeadmin, rails-admin

我正在查看 RailsAdmin 并注意到它有一个活动历史记录，即对应用程序提交的所有操作的注释。我正在寻找一种非常快速的方法来将此类功能集成到基于使用 activeadmin 的项目中。关于如何完成它或者我可以使用哪些宝石开箱即用的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-04T08:52:33.620

我正在寻找相同问题的解决方案，并在 active_admin wiki 中看到了这个页面：

[通过书面记录进行审计](https://github.com/gregbell/active_admin/wiki/Auditing-via-paper_trail-%28change-history%29)

我还没有尝试过（你可能不再需要答案），但我想我还是会把它贴在这里，因为其他人可能会觉得它有用。

# html - chrome中的html em解析错误

> ID：10431242
> 
> 赞同：5
> 
> 时间：2012-05-03T12:19:24.317
> 
> 标签：html, parsing, google-chrome, em

代码也在这里：http: [//jsfiddle.net/wMfMT/5/](http://jsfiddle.net/wMfMT/5/)

这个简单的 html 块：

```
<div>
    <em><em><em><em><a href="#">fifth</a></em></em></em></em>
    <em><em><em><a href="#">fourth</a></em></em></em>
    <em><em><a href="#">third</a></em></em>
    <em><a href="#">second</a></em>
    <a href="#">first</a>
</div> 
```

这个CSS：

```
em {font-size:1.2em} 
```

在 Firefox 上正确呈现（每个单词的大小不同），但在 Chrome 上不正确（第五和第四个大小相同）。首先我认为这是一个 css 问题，但后来我检查了 html，结果发现 Chrome 将其呈现如下：

```
<div>
    <em>
        <em>
            <em>
                <em>
                    <a href="#">fifth</a>
                </em>
            </em>
        </em>
<!-- /em missing -->
        <em>
            <em>
                <em>
                    <a href="#">fourth</a>
                </em>
            </em>
        </em>
        <em>
            <em>
                <a href="#">third</a>
            </em>
        </em>
        <em>
            <a href="#">second</a>
        </em>
        <a href="#">first</a>
    </em><!-- this is the lost /em -->
</div> 
```

我的问题是：

1.  我的 html 是否正确（按照标准嵌套 em-s 可以吗？）
2.  如果是，那么有解决方法吗？*
3.  这是一个已知的错误，如果不是，我应该在哪里报告？

*) 我在 WordPress 插件中有这段代码，许多人通过添加自己的 css 来定制它，所以从 em 更改为 span 或其他任何东西都会破坏他们的网站。我正在寻找一种无需更改 css 的解决方法

在以下位置添加错误报告：[http ://code.google.com/p/chromium/issues/detail?id=126096](http://code.google.com/p/chromium/issues/detail?id=126096)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:26:40.403

您的 HTML 似乎是正确的，我可以在 Chrome Canary 版本上重现它。

一种解决方法是使用跨度：http: [//jsfiddle.net/PeeHaa/tCPd8/](http://jsfiddle.net/PeeHaa/tCPd8/)

我不知道这是否是一个已知问题，但您可以在[http://code.google.com/p/chromium/issues/list查看错误列表](http://code.google.com/p/chromium/issues/list)

如果您还运行 Safari，您还可以测试该浏览器以查看它是 Webkit 还是 Chrome 错误。

**更新**

> *) 我在 WordPress 插件中有这段代码，许多人通过添加自己的 css 来定制它，所以从 em 更改为 span 或其他任何东西都会破坏他们的网站。我正在寻找一种无需更改 css 的解决方法

我看不到任何可能性，因为浏览器只是将其呈现错误，因此您无法使用它。我看到的唯一 hack 是使用 javascript 将最高级别替换为`em`具有相同样式的跨度。

**更新2**

正如[James Allardice](https://stackoverflow.com/questions/10431242/html-em-parsing-bug-in-chrome/10431355#comment-13463175)所指出的，如果您的插件可以的话，您可以将这些东西包装在一个跨度中以解决问题。

# iphone - 如何将带有用户名和密码的 JSON 对象发送到 iphone 中的 REST 登录 Web 服务？

> ID：10431243
> 
> 赞同：2
> 
> 时间：2012-05-03T12:19:26.813
> 
> 标签：iphone, json, web-services, rest

我必须使用 JSON 对象发送用户名和密码来登录 REST Web 服务。我已经在 android 中完成了以下代码。

```
HttpClient client = new DefaultHttpClient();
                    String responseBody;
                    JSONObject jObj = new JSONObject();

                    try
                    {
                        HttpPost post = new HttpPost("http://localhost:8080/MTA/login");
                        jObj.put("email", "user@email.com");
                        jObj.put("password", "password12345");

                        StringEntity se = new StringEntity(jObj.toString());  

                        post.setEntity(se);
                        post.setHeader(new BasicHeader(HTTP.CONTENT_TYPE, "application/json"));
                        post.setHeader("Content-type", "application/json");
                        System.out.println("webservice request executing");

                        ResponseHandler responseHandler = new BasicResponseHandler();
                        responseBody = client.execute(post, responseHandler);

                        System.out.println("Response : " + responseBody);
                        /* 
                         * You can work here on your responseBody
                         * if it's a simple String or XML/JSON response
                         */

                    }
                    catch(Exception e)
                    {
                        System.out.println("Exception : " + e);
                    } 
```

我必须在 iOS 中做同样的事情。我可以在 iOS 中做什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T13:31:22.737

我正在使用 Ge.tt API，为了登录，我正在这样做：

```
NSString *email = @"Some email";
NSString *password = @"Some password"
NSString *apikey = @"some api key";
NSString *loginURL = @"http://open.ge.tt/1/users/login";

NSURL *url = [NSURL URLWithString:loginURL];

NSString *JSONString = [NSString stringWithFormat:@"{\"apikey\":\"%@\",\"email\":\"%@\",\"password\":\"%@\"}", apikey, email, password];

NSData *JSONBody = [JSONString dataUsingEncoding:NSUTF8StringEncoding];

NSMutableURLRequest *loginRequest = [[NSMutableURLRequest alloc] initWithURL:url];
loginRequest.HTTPMethod = @"POST";
loginRequest.HTTPBody = JSONBody;

NSOperationQueue *queue = [NSOperationQueue new];

[NSURLConnection sendAsynchronousRequest:loginRequest 
                                   queue:queue 
                       completionHandler:^(NSURLResponse *response, NSData *data, NSError *error){

                                        // Manage the response here.

                                        }]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-04T04:13:00.853

如果它有效，请将此代码用于您的网络服务，或者您有任何问题可以咨询我。

```
-(IBAction)Submit
 {

if(([user.text length]==0) || ([password.text length]==0) || ([eMail.text length]==0) || ([contactNo.text length]==0))
{
    UIAlertView *alert=[[UIAlertView alloc]initWithTitle:@"Alert !!!" message:@"Fill All the Text For Registration!!" delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:nil, nil];
    [alert show];
    [alert release]; 

}

else 
{
    if([self validateEmailWithString:eMail.text])
    {
        NSString *regestrationString=[[NSString alloc]initWithFormat:@"http://www.somename.com/foldername/login.php?user_name=%@&user_password=%@&user_emailid=%@&user_contactno=%d",user.text,password.text,eMail.text,contactNo.text];
        NSURLRequest *regestrationRequest=[[NSURLRequest alloc]initWithURL:[NSURL URLWithString:regestrationString]];
        NSURLResponse *regestrationResponce;
        NSError *error;

        NSMutableData *regestrationData=[[NSMutableData alloc]initWithData:[NSURLConnection sendSynchronousRequest:regestrationRequest returningResponse:&regestrationResponce error:&error]];
        NSString *dataString=[[NSString alloc]initWithData:regestrationData encoding:NSUTF8StringEncoding];
        NSLog(@"%@",dataString);
        UIAlertView *alert=[[UIAlertView alloc]initWithTitle:@"Thank You!!!" message:@"Your Registration is completed!!" delegate:self cancelButtonTitle:@"ok" otherButtonTitles:nil, nil];
        [alert show];
        [alert release];        
        [registrationView setHidden:YES];
    }
    else
    {
        UIAlertView *alert=[[UIAlertView alloc]initWithTitle:nil message:@"Invalid Email" delegate:self cancelButtonTitle:@"ok" otherButtonTitles:nil, nil];
        [alert show];
        [alert release]; 
    }
}

 }

 -(IBAction)login
 {
NSString *regestrationString=[[NSString alloc]initWithFormat:@"http://www.somename.com/foldername/login_table.php?user_name=%@&user_password=%@",userName.text,passWord.text];
NSURLRequest *regestrationRequest=[[NSURLRequest alloc]initWithURL:[NSURL URLWithString:regestrationString]];
NSURLResponse *regestrationResponce;
NSError *error;

NSMutableData *regestrationData=[[NSMutableData alloc]initWithData:[NSURLConnection sendSynchronousRequest:regestrationRequest returningResponse:&regestrationResponce error:&error]];
NSString *dataString=[[NSString alloc]initWithData:regestrationData encoding:NSUTF8StringEncoding];
NSLog(@" %@",dataString);

regestrationArray=[[NSArray alloc]init];
regestrationArray=[dataString JSONValue];
if(regestrationArray == NULL)
{
    UIAlertView *alert=[[UIAlertView alloc]initWithTitle:@"Alert !!!" message:@"Invalid Login" delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:nil, nil];
    [alert show];
    [alert release];        
}

userNameField =(NSString *)[NSString stringWithFormat:@"%@",[[regestrationArray objectAtIndex:0]valueForKey:@"user_name"]] ;

userName.text=@"";
passWord.text=@"";

[signInView setHidden:YES];
} 
```

login.php 有你的数据库插入查询和 login_table.php 有数据库选择查询。

# android - Android：将 json 数组与 SQLite 数据进行比较

> ID：10431249
> 
> 赞同：1
> 
> 时间：2012-05-03T12:19:42.097
> 
> 标签：android, json, sqlite, comparison, arrays

我的应用程序有一个大问题，我需要将 json 数组与 SQLite 数据库中存储的数据进行比较，但是我尝试了几天都没有成功解决这个问题，我有一个获取 json 数组的方法（这个没问题) 并且我已经创建了一个 SQLiteDatabase，信息是下一个：

“课程” JSONArray：

```
{"Courses":[{"CourseId":4,"Rating":5.0000,"Status":-1},{"CourseId":5,"Rating":5.0000,"Status":5},{"CourseId":6,"Rating":5.0000,"Status":-1},{"CourseId":8,"Rating":4.6119,"Status":5}.. etc 
```

数据库有 1 个包含 72 条记录的表，其中包含下一个数据：CourseID、Title、Instructor、Rating、Length、Topic、Subject & Description。

我的目标是从 JSONArray 中获取值“Status”（5 或 -1），但保存的所有记录都包含值“Status=5”，例如：

```
if(Status==5){ //save all the record {"CourseId":8,"Rating":4.6119,"Status":5}}. 
```

...然后从数据库中获取满足条件“CourseId：”（来自json的字符串）==（来自数据库的CourseID）的记录，并将此数据库值显示到列表视图中（Title，Instructor，Rating，Length，Topic ，主题和描述）。

任何建议或帮助都将受到欢迎和赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:34:47.150

我建议你看看这里：[http ://code.google.com/p/resting/wiki/TwoMinuteTutorial](http://code.google.com/p/resting/wiki/TwoMinuteTutorial)

通过这种方式，您可以将 JSON 结果构建到 POJO 中。然后，您可以迭代您的列表并保留所有状态为 5 的课程。

# migration - 将 Plone 3.0 迁移到 4.1 问题

> ID：10431250
> 
> 赞同：0
> 
> 时间：2012-05-03T12:19:43.630
> 
> 标签：migration, plone

我正在尝试将我们的克隆站点从 windows server 2003 迁移到 windows server 2008 机器上运行。我在 2008 服务器上安装了 Plone 4.1，然后从 Plone 3.0 复制了 data.fs 文件。我还发现我需要将 CMFPLONE 扩展目录从 3.0 复制到新版本。一旦我这样做了，该网站就出现了，但没有任何图形。当我尝试登录以查看是否可以更正网站样式时，我收到以下错误：

很抱歉，似乎有一个错误……这是完整的错误消息：

```
Traceback (innermost last):
  Module ZPublisher.Publish, line 126, in publish
  Module ZPublisher.mapply, line 77, in mapply
  Module ZPublisher.Publish, line 46, in call_object
  Module Products.CMFFormController.FSControllerPageTemplate, line 91, in __call__
  Module Products.CMFFormController.BaseControllerPageTemplate, line 28, in _call
  Module Products.CMFFormController.ControllerBase, line 231, in getNext
  Module Products.CMFFormController.Actions.TraverseTo, line 38, in __call__
  Module ZPublisher.mapply, line 77, in mapply
  Module ZPublisher.Publish, line 46, in call_object
  Module Products.CMFFormController.FSControllerPythonScript, line 105, in __call__
  Module Products.CMFFormController.Script, line 145, in __call__
  Module Products.CMFCore.FSPythonScript, line 130, in __call__
  Module Shared.DC.Scripts.Bindings, line 322, in __call__
  Module Shared.DC.Scripts.Bindings, line 359, in _bindAndExec
  Module Products.PythonScripts.PythonScript, line 344, in _exec
  Module script, line 29, in logged_in <FSControllerPythonScript at /Plone/logged_in> Line 29
  Module Products.PlonePAS.tools.membership, line 635, in loginUser
  Module Products.PlonePAS.plugins.cookie_handler, line 91, in login
  Module Products.PluggableAuthService.PluggableAuthService, line 1109, in      updateCredentials
  Module plone.session.plugins.session, line 220, in updateCredentials
  Module plone.session.plugins.session, line 136, in _setupSession
  Module plone.session.plugins.session, line 130, in _getSigningSecret
  Module zope.component._api, line 169, in getUtility
ComponentLookupError: (<InterfaceClass plone.keyring.interfaces.IKeyManager>, '') 
```

关于如何纠正错误以及可能导致网站无法正确显示的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:59:05.107

来自：[https ://dev.plone.org/ticket/8579](https://dev.plone.org/ticket/8579)

> 重新安装“plone.keyring KeyManager Registration”中的所有步骤以修复在站点设置中工作时出现的 ComponentLookupError: (, '') 错误

通常，升级时，需要运行一些升级步骤。作为登录错误，在 Web 界面中运行它们可能会出现问题。所以我同意最好先升级到最新的 3.X，然后再升级到 4.X

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T00:48:14.363

我只是做了类似的事情，只是从 3.1.5.1 到 4.1.4。强烈建议先迁移到 3.3.5（最后支持的 3x 版本），然后再迁移到 4x。

# visual-studio - 如何将 SQL Server Compact 3.5 与实体框架一起使用

> ID：10431251
> 
> 赞同：1
> 
> 时间：2012-05-03T12:20:10.537
> 
> 标签：visual-studio, entity-framework, sql-server-ce

我的 Visual Studio 项目中有一个 SQL Server Compact 3.5 数据库。当我尝试（从数据库）创建实体框架模型时，它只显示 SQL Server Compact 4.0。我试图重新安装 3.5，但什么也没做。

我需要将我的版本保持在 3.5，因为 SSIS 只能写入我的数据来自的 3.5 文件。

关于如何让 Visual Studio 使用 3.5 文件的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T15:49:21.983

在非 Web 项目中创建 EDMX，或使用我的 SQL Server Toolbox 加载项。

# jquery - 需要更改jquery对话框标题栏图像

> ID：10431253
> 
> 赞同：0
> 
> 时间：2012-05-03T12:20:16.283
> 
> 标签：jquery, jquery-ui

我尝试使用以下代码更改 jQuery 对话框标题栏图像，但它不起作用。

我的对话框和标题栏图像如下所示：

![在此处输入图像描述](../Images/d966b26bb0ca87d4fbd3d64f226f4f3c.png)

```
$("#dialog").dialog({
    title: '<img src="myImage.jpg" />'
});​​​​​​​​​​​ 
```

有关如何更改它的任何建议？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:44:29.517

你必须添加一个 CSS 规则：

```
.ui-dialog-titlebar{
    background:url(http://www.elementalsurface.com/beech-wood.jpg);
}​ 
```

看[演示](http://jsfiddle.net/p5ZJV/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:29:02.187

此代码将很好地了解如何执行此操作：

**jQuery：**

```
var $Dialog_div;

function fnOpenDialog() {
    $Dialog_div = $('<div id=\'ThisDialog\'>Hello</div>').prependTo('body');

    $Dialog_div = $('#ThisDialog').dialog({
        autoOpen: true,
        draggable: true,
        resizable: true,
        title: 'Dialogimage<img src="http://dummyimage.com/100x30/000/fff&text=I\'m+an+image,+hi!" />',
        modal: true,
        stack: true,
        height: ($(window).height() * 0.95),
        width: ($(window).width() * 0.9),  
        buttons: {
            'OK': function() {
                $Dialog_div.dialog('close');
            }
        }
    });  
}

$('#ClickMe').click(fnOpenDialog);​ 
```

**HTML：**

```
<!-- This is more than likely an Adobe issue where it thinks it should be in the front
     all the time no matter what however it is very annoying that you can't open
     a dialog over a PDF-->

<body>
    <div id='ClickMe'>Click here!</div>
    <br/>
    <div></div>
    <br/>      
</body> 
```

（可能是巧合，您的对话框图像与此处的示例非常相似：[标题的 jQuery ui 对话框图像](https://stackoverflow.com/questions/3543532/jquery-ui-dialog-image-for-the-title):)）

**工作演示：**

[http://jsfiddle.net/V5NkV/](http://jsfiddle.net/V5NkV/)或[http://jsfiddle.net/V5NkV/10/](http://jsfiddle.net/V5NkV/10/)

单击`click me`上面演示中的 ，您将看到带有小图像的对话窗口。

**不错的阅读链接：**

[http://jqueryui.com/demos/dialog/](http://jqueryui.com/demos/dialog/)

# javascript - 在 jQuery 循环中添加“滑块”功能？

> ID：10431255
> 
> 赞同：0
> 
> 时间：2012-05-03T12:20:28.740
> 
> 标签：javascript, jquery, jquery-cycle

使用 jQuery 的循环插件制作基本幻灯片（使用淡入淡出）横幅。
我想让图像每次滑动时都向右移动，以显示我们正在使用的图像。
我编码它的方式，它工作一次然后停止。我想让它在每次图像更改时滑动，然后让它滑回最后的第一个图像。

我创建了以下 Fiddle 来说明我的意思：[http://jsfiddle.net/9QXWn/](http://jsfiddle.net/9QXWn/)
它执行一次，然后停止。

有人可以修改 JSFiddle 让它每次都改变吗？如果不是太多要求，它是否在处理队列一次时重置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:34:05.147

恕我直言，您可以将函数放在循环方法的`before`or参数中。`after`请检查这个[http://jsfiddle.net/bondythegreat/HPwca/1/](http://jsfiddle.net/bondythegreat/HPwca/1/)

# objective-c - iOS 加密到带有密钥标识符的 NSData

> ID：10431256
> 
> 赞同：0
> 
> 时间：2012-05-03T12:20:28.680
> 
> 标签：objective-c, ios, encryption, aes, nsdata

在我的 iOS4+ 项目中，iam 使用 AES 128 加密来加密一些大字符串，然后将其发送到 php 服务器。使用提供的 AES128 密钥之一（随机选择）进行加密。当我加密数据时，我得到 NSData。

我需要的是在我发送到该服务器的文件的开头添加一个 2 字节的某种密钥标识符，以便服务器能够识别我用于加密的密钥。我该怎么做（将 2 个字节附加到 nsdata）？我到底可以用什么作为这个标识符？

感谢先进！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:59:06.073

你显然需要硬编码或在另一个请求中共享字典什么链接和标识符到一个键，但我会让你这样做......

附加一些标识符，例如两个数字

```
 ...

    const Byte identifierBytes[2] = { 0xFF, 0xAA }; //two identifier bytes

    NSMutableData *dataToSendToServer = [[NSMutableData alloc] initWithBytes:identifierBytes length:2];
    [dataToSendToServer appendData:encryptedDataToSendToServer];

    //send the dataToSendToServer to the server...

    ... 
```

然后读取应用程序端的标识符...

```
 ...

    const Byte *identifierBytes = [[dataFromTheServer subdataWithRange:NSMakeRange(0, 2)] bytes];
    if (identifierBytes[0] == 0xFF && identifierBytes[1] == 0xAA) {

        //the bytes are for the identifier {0xFF,0xAA}
        NSData *encryptedDataFromServer = [dataFromTheServer subdataWithRange:NSMakeRange(2, dataFromTheServer.length - 2)];

    }

    ... 
```

您可能想检查它，因为它是从内存中写入的，但您应该能够理解

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:59:41.580

如果您的键索引不会更改，为什么不使用键数组中的键索引作为标识？

您可以像这样添加字节：

```
NSMutableData *mutableData = [yourNSData mutableCopy]; // make a mutable copy so you can append bytes.
int aIndex = 0; // example index
[mutableData appendBytes:aIndex length:sizeof(int)]; // append a 4byte int 32 
```

然后，您可以在 PHP 中解压缩 int。

# xml - 如何使用 XQuery 获得此输出？

> ID：10431262
> 
> 赞同：1
> 
> 时间：2012-05-03T12:20:44.007
> 
> 标签：xml, xquery, basex

> **可能重复：**
> [XQuery 返回错误..？](https://stackoverflow.com/questions/10314562/xquery-returning-an-error)

以下是 XML 文件 -

```
<Continents>
  <Continent name="Asia">
    <Country name="Japan">
    <City name="Tokyo"><Desc>Tokoyo is a most populated City</Desc></City>
    <City name="Horishima"><Desc>What to say.. Faced the destruction due to Atom Bomb</Desc></City>
    </Country>
    <Country name="India">
    <City name="New Delhi"><Desc>Capital of India</Desc></City>
    <City name="Mumbai"><Desc>Financial Capital of India</Desc></City>
    <City name="Lucknow"><Desc>City of Nawabs</Desc></City>
    </Country>
  </Continent>  
</Continents> 
```

我想列出国家的城市=`"India"`

我的 XQuery FLWOR 代码是 -

```
for $x in doc("Continent")/Continents/Continent
  where $x/Country/@name='India'
  return $x/Country/City/@name 
```

我希望输出为 -

```
 name="New Delhi" name="Mumbai" name="Lucknow" 
```

但得到输出 -

```
 name="Tokyo" name="Horishima" name="New Delhi" name="Mumbai" name="Lucknow" 
```

任何人都可以帮助我获得正确的输出吗？另外如何将它放在单独的行上？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:52:31.633

[你在这里](https://stackoverflow.com/questions/10314562/xquery-returning-an-error)问了几乎完全相同的问题，同样的答案也适用于这里。你想要的是：

```
doc("Continent")/Continents/Continent/Country[@name = 'India']/City/@name 
```

如果您希望每个结果都在自己的行中，请尝试以下操作：

```
string-join(
  doc("Continent")/Continents/Continent/Country[@name = 'India']/City/@name,
  '&#10;'
) 
```

这应该导致：

```
New Delhi
Mumbai
Lucknow 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T15:09:58.297

您还可以稍微重写您的 FLWOR 以获得想要的结果：

```
for $x in doc("Continent")/Continents/Continent/Country
where $x/@name='India'
return $x/City/@name 
```

（请注意，我移动了 /Country 部分）

如有必要，您可以按照 Leo 的建议将此 FLWOR 包装在一个字符串连接中，就像他包装他的 XPath 表达式替代方案一样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-04T14:27:08.453

```
/*/*/Country[@name='India']/City/concat('name="', @name, '" ') 
```

**注意**：这也恰好是一个纯 XPath 2.0 表达式。

# wcf - WCF 故障 - 什么样的故障？

> ID：10431264
> 
> 赞同：1
> 
> 时间：2012-05-03T12:20:49.600
> 
> 标签：wcf

我正在使用 MSMQ 和 WCF。现在，MSMQ 可能会脱机，或者 WCF 和目标之间可能存在一些通信错误。我知道我可以订阅 serviceHost 上的 Faulted 事件，当 MSMQ 关闭/离线时，我确实会引发该事件 - 太好了。但是，如何知道发生的故障类型？我需要确定这是某种通信错误，如果是这样，我想在一段时间后重新连接并继续尝试，直到达到“幻数”。

服务没有抛出异常。只是当 MSMQ 下线时，WCF 服务确实出现了故障，但需要知道故障的类型。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T15:02:42.197

如果不是异常详细信息，正如 Christian K 所建议的那样，您正在寻找，而是为什么 WCF 服务/客户端没有收到其他通信异常，那么原因是 netMsmqBinding 实现了“即发即弃”模式。

WCF 服务通过 MSMQ 管道与客户端完全断开连接，它只侦听 MSMQ 目标队列上的消息。必须将使用 netMsmqBinding 的服务操作配置为单向（返回 void），因为一旦 WCF 客户端成功地将消息放入 MSMQ 传出队列中，它的工作就完成了。假设是 MSMQ 向 WCF 服务提供有*保证*的消息传递。MSMQ 4.0 将处理您对“重新连接”和“幻数重试”的担忧。

# java - 使用不同的工作目录运行 Runnable

> ID：10431266
> 
> 赞同：0
> 
> 时间：2012-05-03T12:20:51.963
> 
> 标签：java

在我的程序中，我想用不同的工作目录执行一些函数（我已经加载了使用当前目录中的文件并想要执行它的 JAR）

有没有办法通过设置工作目录来执行 Runnable 或 Thread 或其他对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:28:21.970

不，工作目录与操作系统级别的进程相关联，您不能在程序的一部分中更改它。您将不得不更改获取目录的方式。

（我假设您当前要么使用 System.getProperty("user.dir") 获取目录，要么调用类似地从环境中获取目录的代码。）

澄清：您当然可以全局更改属性，但随后它会在所有线程中更改。我认为这不是您想要的，因为您谈论的是线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:31:39.397

您不能为线程设置工作目录，但是您可以使用不同的工作目录创建新进程。在此处查看示例： [http ://docs.oracle.com/javase/1.5.0/docs/api/java/lang/ProcessBuilder.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/ProcessBuilder.html)

您还可以创建具有要使用的目录概念的特定类型的线程。例如：

```
public class MyThread extends Thread
{
   private final String workingDir;

   public MyThread(String workingDir)
   {
        this.workingDir = workingDir;
   }

   public void run()
   {
       //use the workingDir variable to access the current working directory
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:30:50.073

如果您`user.dir`使用[System.setProperty()设置它可能会起作用](http://docs.oracle.com/javase/6/docs/api/java/lang/System.html#setProperty%28java.lang.String,%20java.lang.String%29)

我想你可以用下面的例子来改变它：

```
public static void main(String[] args) {

    System.out.println("main: " + new File(".").getAbsolutePath());
    System.setProperty("user.dir", "C:/");
    Runnable r = new Runnable() {
        public void run() {
            System.out.println("child: "+new File(".").getAbsolutePath());
        }
    };

    new Thread(r).start();

    System.out.println("main: "+new File(".").getAbsolutePath());

} 
```

这将产生：

> 主要：C:\Projekte\Techtests。
> 
> 主要：C：\。
> 
> 孩子：C：\。

# windows - DLL 在机器上工作，而在另一台机器上则不行。相同的配置

> ID：10431267
> 
> 赞同：0
> 
> 时间：2012-05-03T12:20:52.567
> 
> 标签：windows, dll, regsvr32, dependency-walker

我有一个需要在 Java 应用程序中使用的 DLL。这已经使用 Windows 32 位服务包 3 制作，因此 DLL 可以正常工作。现在我有另一台具有相同配置的机器需要使用它。

当我尝试在 java 中加载 lib 时，会出现以下错误：

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: ARWAPI32 (This application has failed to start because the application configuration is incorrect. Reinstalling the application may fix this problem. ) 
```

当我在第一台机器上用**Dependency Walker**打开 DLL 时，没有问题发生，但是当我在机器上打开 DLL 时，它不起作用

```
Error: The Side-by-Side configuration information for "c:\ARWAPI32.DLL" contains errors. This application has failed to start because the application configuration is incorrect. Reinstalling the application may fix this problem (14001). 
```

这意味着什么？我尝试使用命令**Regsvr32**注册 dll，但显示了相同的错误。

```
LoadLibrary("c:\ARWAPI32.DLL") failed - This application has failed to start because the application configuration is incorrect. Reinstalling the application may fix this problem. 
```

# jquery - 奇怪的 iOS 动画，用 jQuery 显示？

> ID：10431268
> 
> 赞同：1
> 
> 时间：2012-05-03T12:21:00.943
> 
> 标签：jquery, ios, mobile

在你们可爱的家伙的帮助下，我一直在为滑动菜单制作一些动画:)

它在浏览器中完美运行，但是当使用 iPad 或 iPhone（iphone 有自己的布局）时，会出现以下情况......

在主页上，滑块打开后，一旦打开 div 需要几秒钟的时间来渲染菜单（与网页版相反），有时甚至不会出现。

在其他页面上，菜单会滑动打开，但一旦完全打开，文本就会隐藏起来，然后在您关闭菜单后变得可见，这也发生在子菜单上。

链接：http: [//jsre.kandimedia.com/](http://jsre.kandimedia.com/)

真的不知道遇到这样的错误时我应该寻找什么，非常感谢任何建议！

更新

添加了 jsfiddle，但不确定是否会有所帮助，因为问题出在移动设备/ipad 上

[http://jsfiddle.net/pxd8z/](http://jsfiddle.net/pxd8z/)

**编辑：**找出原因，与 background.js 有冲突

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T21:59:38.237

很好解决了，与 backstrech.js 有冲突

# javascript - 如何在 UIWebView 上运行 HTML+javascript 文件。.?

> ID：10431272
> 
> 赞同：7
> 
> 时间：2012-05-03T12:21:34.797
> 
> 标签：javascript, iphone, html, ios, uiwebview

大家，

我有一个 HTML 页面，其中包含一个显示一种动物动画的 Javascript 函数。我已将其本地添加到 xcode 项目中。

现在，当我在 UIWebView 中加载此文件时，它看起来很完美。这是将 HTMl 文件加载到 UIWebView 的代码

```
NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"elephant-animation" ofType:@"html"] isDirectory:NO];
        NSURLRequest *req = [NSURLRequest requestWithURL:url];
        [self performSelectorOnMainThread:@selector(startWebLoad3:) withObject:req waitUntilDone:YES];

-(void)startWebLoad3:(NSURLRequest *)request
{
    [wbView3 loadRequest:request];
    [wbView3 setBackgroundColor:[UIColor clearColor]];
    wbView3.scrollView.scrollEnabled = NO;
    [wbView3.scrollView setBackgroundColor:[UIColor clearColor]];
    [wbView3 setOpaque:NO];
} 
```

但我有 6 页。当开始使用单独的 UIWebView 加载每个页面时，它会出现内存警告。并给我像这里这样的错误。

```
void SendDelegateMessage(NSInvocation*): delegate (webView:didFinishLoadForFrame:) failed to return after waiting 10 seconds. main run loop mode: kCFRunLoopDefaultMode 
```

如果我只运行一页而不是完美运行，但是当我开始一起或一页一页地加载时，它会因内存警告而崩溃。

让我知道是否有人得到任何解决方案..

我一直坚持这个问题..

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-11T11:51:14.817

终于我得到了解决方案..经过长期的研发，得到了一些有效的解决方案......

```
"JavaScript execution time is limited to 10 seconds for each top-level entry point. If your script executes for more than 10 seconds, the web view stops executing the script" 
```

这就是为什么我无法在 UIWebView 中加载 html 页面的原因。而 iPad 仅在 App 启动时处理高达 3 MB 的数据加载。而且我使用的比它更多。

所以，我根据要求更改了javascript，现在工作了..

感谢您参与其中。。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-11T07:37:18.007

```
static NSInteger currentIndex = 0;
if (currentIndex < 99) {
    currentIndex++;
}
NSString *path = [[NSBundle mainBundle] pathForResource:[NSString stringWithFormat:@"file%d",currentIndex] ofType:@"html"];
NSFileHandle *readHandle = [NSFileHandle fileHandleForReadingAtPath:path];
NSString *htmlString = [[NSString alloc] initWithData: 
                        [readHandle readDataToEndOfFile] encoding:NSUTF8StringEncoding];
[self.myWebView loadHTMLString:htmlString baseURL:nil]; 
```

我希望它会工作

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-17T07:28:49.780

下图中，一个用于添加 HTML、Javascript 和 CSS 类文件，第二个用于一般 XCode 文件。

用于 HTML、Javascript 和 CSS 文件

将文件添加到 XCode 中时：

![在此处输入图像描述](../Images/6354d4663ed51deaa62ce618201443a9.png)

这对我有用..！希望它对所有人都有效。谢谢！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T11:21:08.397

我想，你想在 webview 中做 html 文件，在我的应用程序中，我在那个视图中做了一个滚动视图，在那个视图中，我在循环中添加了 webview，最后我在 webview 中添加了 html 文件。试试这个代码：

```
ScrollView = [[UIScrollView alloc] initWithFrame:CGRectMake(0,0,768,[[UIScreen mainScreen] bounds].size.height)];
    ScrollView.contentSize = CGSizeMake(768*21,[[UIScreen mainScreen] bounds].size.width);
    ScrollView.pagingEnabled=YES;
    ScrollView.delegate = self;
    ScrollView.userInteractionEnabled = YES;
    ScrollView.showsVerticalScrollIndicator=NO;
    ScrollView.showsHorizontalScrollIndicator=NO;

    int x=0,y=125;
    for ( i=1; i<22; i++)
    {

        view3=[[UIView alloc]initWithFrame:CGRectMake(x,0,768, 1000)];
        view3.backgroundColor=[UIColor whiteColor];

        webview2=[[UIWebView alloc]initWithFrame:CGRectMake(0,y,768,755)];
        webview2.scalesPageToFit=YES;
        webview2.autoresizingMask=(UIViewAutoresizingFlexibleWidth|UIViewAutoresizingFlexibleHeight);
        webview2.multipleTouchEnabled=YES;
        webview2.backgroundColor=[UIColor whiteColor];

        NSString *st = [NSString stringWithFormat:@"1%d",i];
        NSString *str12=[NSString stringWithFormat:@"information_"];
        str12=[str12 stringByAppendingString:st];
        NSString *urlAddress        = [[NSBundle mainBundle] pathForResource:str12 ofType:@"html"];//you can also use PDF files
        NSURL *url                  = [NSURL fileURLWithPath:urlAddress];
        NSURLRequest *requestObj    = [NSURLRequest requestWithURL:url];
        [webview2 loadRequest:requestObj];

        webview2.tag= i + 10;
        [view3 addSubview:webview2];

        [ScrollView addSubview:view3];

        x=x+768;

}
    [self.view addSubview:ScrollView];

} 
```

在我的应用程序中的 22 个 html 页面（信息_%i，必须在资源中）添加到 webview 中，它工作得很好。

我希望它对你也有帮助。

# c# - 使用Linq to objects，如何创建一个空字典 容易地？

> ID：10431281
> 
> 赞同：49
> 
> 时间：2012-05-03T12:21:58.913
> 
> 标签：c#, linq

要创建一个空序列，请使用以下

```
var empty = Enumerable.Empty<string> (); 
```

有没有类似的方法可以像这样轻松地创建一个空字典？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2019-02-27T10:07:07.040

回到 2019 年，有一种方法可以实现这一点，使用：

```
ImmutableDictionary<TKey, TValue>.Empty 
```

更多信息可以在这里找到（最后几篇文章）：[https ://github.com/dotnet/corefx/issues/25023](https://github.com/dotnet/corefx/issues/25023)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-05-03T12:36:48.460

不，没有等价物...

的目的`Enumerable.Empty<T>()`是返回一个空数组的“缓存”实例。因此，您可以避免创建新数组 ( `return new T[0];`) 的开销。

您不能将其转换为非只读结构，如 a `IDictionary<TKey, TValue>`or`Dictionary<TKey, TValue>`因为返回的实例可能会在以后被修改，因此会使目的无效......

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-03T12:23:02.700

有什么问题`new Dictionary<string, string>()`？

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-11-23T20:14:58.740

我假设（至少现在 5 年后）*空字典*真的意味着*空**的只读**字典*。这种结构与空的可枚举序列一样有用。例如，您可能有一个配置类型，它具有一个字典属性（想想 JSON），一旦配置就无法修改：

```
public class MyConfiguration
{
    public IReadOnlyDictionary<string, string> MyProperty { get; set; }
} 
```

但是，如果该属性从未配置过怎么办？然后`MyProperty`是`null`。避免意外的一个很好的解决方案`NullReferenceException`是使用空字典初始化属性：

```
public class MyConfiguration
{
    public IReadOnlyDictionary<string, string> MyProperty { get; set; }
        = new Dictionary<string, string>();
} 
```

缺点是每次分配都`MyConfiguration`需要分配一个空字典。为避免这种情况，您需要类似于 的`Enumerable.Empty<T>()`内容，即缓存的空只读字典。

有两种方法可以实现这一点。第一个是依赖[System.Collections.Immutable](https://www.nuget.org/packages/System.Collections.Immutable/)。一个`ImmutableDictionary<TKey, TValue>`实现`IReadOnlyDictionary<TKey, TValue>`，它有一个`Empty`可以使用的字段：

```
IReadOnlyDictionary<string, string> empty = ImmutableDictionary<string, string>.Empty; 
```

或者您可以实现自己的空只读字典，类似于`Enumerable.Empty<T>()`and `Array.Empty<T>()`。请注意空值如何不再是一个字段，并且该类不是通用的。相反，它是一种通用方法。这需要两个类。

第一类是“隐藏的”，可以是内部的：

```
internal static class EmptyReadOnlyDictionary<TKey, TValue>
{
    public static readonly IReadOnlyDictionary<TKey, TValue> Instance
        = new Dictionary<TKey, TValue>();
} 
```

第二个类使用第一个类，但将其隐藏在`IReadOnlyDictionary<TKey, TValue>`接口后面：

```
public static class ReadOnlyDictionary
{
    public static IReadOnlyDictionary<TKey, TValue> Empty<TKey, TValue>()
        => EmptyReadOnlyDictionary<TKey, TValue>.Instance;
} 
```

用法：

```
IReadOnlyDictionary<string, string> empty = ReadOnlyDictionary.Empty<string, string>(); 
```

`TKey`对于这两种解决方案，对于 和 的每个不同组合，只有一个空字典实例`TValue`。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-03-17T07:19:56.130

当 key 和 value 具有相同的类型时（例如：字符串）：

```
Enumerable.Empty<string>().ToDictionary(x=>x, x=>x) 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2016-01-03T10:31:57.670

```
Enumerable.Empty<KeyValuePair<string, object>>().ToDictionary(kvp => kvp.Key, kvp => kvp.Value) 
```

# javascript - Google ChromeOS > 版本 18 和 captureVisibleTab()

> ID：10431283
> 
> 赞同：0
> 
> 时间：2012-05-03T12:22:15.997
> 
> 标签：javascript, google-chrome-extension, google-chrome-os

我在`captureVisibleTab`这里详细使用[http://code.google.com/chrome/extensions/tabs.html](http://code.google.com/chrome/extensions/tabs.html)

```
chrome.tabs.captureVisibleTab(undefined,{format:"png"}, function(dataUrl){
    //checking for dataUrl here
}); 
```

我已将代码包装到 QUnit 测试中，在 ChromeOS 18 上我得到：

![在此处输入图像描述](../Images/88c210f8df19f550f57fc6331e67f501.png)

所以一切正常。

在 ChromeOS 19（测试版）或 20（开发版）上运行的相同代码返回：

![在此处输入图像描述](../Images/53225223cc6ff720b57c7f5b700c347b.png)

dataUrl 未定义

我还在 Inspector 中收到一条消息：

> 尝试捕获当前选项卡的可见区域时发生内部错误

顺便说一句，我也尝试在 Chrome Canary（当前版本 20）上对此进行测试，但没有收到此类问题

似乎 api 已更改，但我在文档中看不到这些更改的任何详细信息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-05T17:52:44.933

这是解释：[http ://code.google.com/p/chromium/issues/detail?id=126327&q=captureVisibleTab&colspec=ID%20Pri%20Mstone%20ReleaseBlock%20Area%20Feature%20Status%20Owner%20Summary](http://code.google.com/p/chromium/issues/detail?id=126327&q=captureVisibleTab&colspec=ID%20Pri%20Mstone%20ReleaseBlock%20Area%20Feature%20Status%20Owner%20Summary)

我猜/希望我们能尽快修复。

# ruby - 以不同语言显示的 Facebook 权限对话框

> ID：10431284
> 
> 赞同：0
> 
> 时间：2012-05-03T12:22:26.043
> 
> 标签：ruby, facebook, facebook-graph-api, permissions, omniauth

我正在开发一个大量使用 facebook 图形 API 的应用程序。我正在请求以下权限：

*   我的照片
*   朋友照片
*   我的关系
*   关系详细信息
*   家乡

我正在使用 omniauth ruby​​ gem 来指定这些权限并获取访问令牌。

我收到了以看似随机的语言显示的应用程序授权对话框的报告。

有没有人见过这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:29:50.370

很难说 facebook API 什么时候没有错误！是的！我真心的。这不应该发生。应该根据用户区域设置显示语言。所以，我认为你应该等待，或者你可以在 Facebook 开发者网站的错误跟踪器中添加一个错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-11T09:30:06.190

Facebook 上已经报告了一个错误

请参阅[如何在 Facebook 登录页面或对话框中更改语言？](https://stackoverflow.com/questions/10477975/how-to-change-language-in-facebook-login-page-or-dialog)

和[http://developers.facebook.com/bugs/407246299295529?browse=search_4fa410ea79db26337556383](http://developers.facebook.com/bugs/407246299295529?browse=search_4fa410ea79db26337556383)

# c# - Defining program as beta

> ID：10431289
> 
> 赞同：2
> 
> 时间：2012-05-03T12:22:45.577
> 
> 标签：c#, .net

I want users to test my program's beta builds. There's a simple checkbox in the options screen to check for beta updates. However what would be the best way to define a build as beta? Would that be to check if the build version of the assembly information is not zero (so 1.0.0.1, 1.0.0.239 are beta and 1.0.1.0 is final), it'll be defined as beta? Or is it better to have a variable (boolean) called `IsBeta`? Or any other way?

Please share your thoughts about this. Thanks.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T12:25:13.947

I would suggest using **[Semantic Versioning](http://semver.org/)**.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:28:29.537

I think a boolean/prop file setting is a better choice. It is very black and white. Trying to deduce beta or not-beta from the version number might be clear now, but at some point you'll either increment incorrectly, or want to have exact control (turn off beta for this specific release) and have to hack your numbering scheme.

This will also help when you release 1.0.0.239 (set as beta=true), and 10 minutes later change "small dog" to "puppy", but don't really want to push another update to your users. So 1.0.0.240 would just be beta=false. I mention this without knowing how many builds you do or how you control the users access to the builds...

# blackberry-eclipse-plugin - 黑莓推送通知中的推送启动器访问

> ID：10431290
> 
> 赞同：0
> 
> 时间：2012-05-03T12:22:46.687
> 
> 标签：blackberry-eclipse-plugin

最近我在黑莓中使用推送通知。我什至安装了 BPSS（BLackberry 推送服务 sdk）他们为我提供了用于黑莓的 Apache tomcat Server sdk。我已经在本地配置它并运行推送示例启动器。但是我已经获得以下：

```
 Sample Push Initiator
Push #  0 / 100  
Application Id  sampleappid  
Application Level
Reliability false    
Delay (s)   300  
State   General Push Active  
The following options each push to all active subscribers.
"Start General Push" sends an identical message to all active subscribers.
"Start Personalized Push" sends a unique message to each active subscriber.

Push #  Push Id Time/Date Sent  Push Outcome
1       Thu May 03 17:19:44 IST 2012    ERROR: There are no active subscribers.
1       Thu May 03 17:24:45 IST 2012    ERROR: There are no active subscribers.
1       Thu May 03 17:29:46 IST 2012    ERROR: There are no active subscribers.
1       Thu May 03 17:34:46 IST 2012    ERROR: There are no active subscribers.
1       Thu May 03 17:39:46 IST 2012    ERROR: There are no active subscribers.

v1.1 Copyright © 2011 Research In Motion Limited, unless otherwise noted. 
```

任何人都可以帮助我解决与黑莓推送相关的订阅和取消订阅问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-24T10:46:08.227

必须注册您的客户端推送应用程序？如果没有，请先注册，他们将能够收到推送通知。使用 net.rim.blackberry.api.push 包。

# ruby-on-rails - 在 Rails 中将变量传递给单引号字符串

> ID：10431291
> 
> 赞同：0
> 
> 时间：2012-05-03T12:22:54.717
> 
> 标签：ruby-on-rails, ruby-on-rails-3, string

嗨，我想在周末完成一个大学项目，但遇到了减速带。

该项目的基本思想是使用 rails 和 jQuery Mobile 在谷歌地图上显示带有地理标签的推文。我没有使用 twitter api，而是选择了 datasift 流 api。

为了使它工作，我需要将查询字符串传递给 datasift api，如下所示：

```
'twitter.geo exists AND interaction.geo geo_radius "53.33754457198889,-6.267493000000059:10"' 
```

其中地理位置“53.33754457198889,-6.267493000000059”是中心，“10”是捕获地理标记推文的半径（以英里为单位）。

我想在字符串中传递变量，例如

```
'twitter.geo exists AND interaction.geo geo_radius "#{@users_location}:#{radius}"' 
```

但是单引号意味着我不能用这个字符串来做这个我试图以不同的方式连接字符串没有快乐所以如果有人有一些建议或解决方案我会很感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:26:43.977

您还可以使用`%(` `)`引用字符串，例如`%(twitter.geo exists AND interaction.geo geo_radius "#{@users_location}:#{radius}")`.

有关您可能使用的其他一些替代方案，请参阅[此内容。](http://www.ruby-doc.org/docs/ProgrammingRuby/html/language.html#UB)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:28:12.150

您不能将变量传递到单引号字符串中，但有几种方法可以归档您想要的内容：

```
# use a double quouted string and escape the quotes inside the string
"twitter.geo exists AND interaction.geo geo_radius \"#{@users_location}:#{radius}\""

# use single quotes and concat several strings
'twitter.geo exists AND interaction.geo geo_radius "' + @users_location + ':' + radius + '"'

# just use single quotes in a double quoted string
"twitter.geo exists AND interaction.geo geo_radius '#{@users_location}:#{radius}'"

# as the other answers suggest use %()
%(twitter.geo exists AND interaction.geo geo_radius "#{@users_location}:#{radius}") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:27:30.763

我`%()`更喜欢（另一个答案），但您也可以`\"`在双引号字符串中转义引号。所有这些信息都可以在几乎任何 Ruby 字符串教程/文档中找到。

您还可以使用 HERE 字符串：

```
s = <<FOO
  twitter.geo exists AND interaction.geo geo_radius "#{@users_location}:#{radius}"
FOO 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T12:27:43.850

您可以转义双引号：

```
"twitter.geo exists AND interaction.geo geo_radius \"#{@users_location}:#{radius}\"" 
```

我希望它有帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-03T12:33:17.040

通过连接创建您需要的字符串。就像是：

```
 str = "'twitter.geo exists AND interaction.geo geo_radius " + '"' + "#{@users_location}:#{radius}" + '"' + "'" 
```

# wordpress - 自定义发布计划的操作挂钩，例如 publish_future_post

> ID：10431300
> 
> 赞同：0
> 
> 时间：2012-05-03T12:23:27.083
> 
> 标签：wordpress

当计划的自定义帖子发布时，我想在我的 Wordpress 中触发一个功能。不幸的是，没有默认的动作钩子`custom_post_type`。

这是我的插件的示例代码：

```
function connectwpblog123 () {
    if( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE )
        return; 
    $post_status = 'publish';
    $movie_post1 = array();
    $movie_post1['post_title'] = 'Schedule Test Example';
    $movie_post1['post_type']  = 'fbtweets';
    $movie_post1['post_content'] = 'Abce defgh i gk lmno p qr st';
    $movie_post1['post_status'] = $post_status;
    $movie_post1['tags_input'] = array(1);
    $movie_post1['post_category'] = array(1);
    $post_id = wp_insert_post( $movie_post1 );
} 
add_action('publish_future_fbtweets', 'connectwpblog123', 10, 1); 
```

当我使用发布自定义帖子挂钩挂钩我的自定义帖子时：

```
 add_action('publish_post', 'connectwpblog'); 
```

这会触发该功能无限时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-23T23:30:51.377

要将 publish_post 与任何帖子类型一起使用：

```
add_action( 'publish_' . $_POST['post_type'], 'your_func'  ); 
```

# sql - 如何重新排序表中的项目

> ID：10431305
> 
> 赞同：10
> 
> 时间：2012-05-03T12:23:34.850
> 
> 标签：sql, oracle

我有`my_table`可以像这样简化的表（称为它）：NAME，SEQ_NO，LOCKED。

项目被删除和添加，我想重新排序它们（修改 SEQ_NO），使序列始终从 1 变为 COUNT(*)，锁定的项目保留其 SEQ_NO，没有解锁的项目会获得该数字。只有未锁定的项目会使用新的 SEQ_NO 进行更新。

例子：

这

```
名称 SEQ_NO 已锁定
富 1 N
酒吧 3 是
美国广播公司 4 岁
巴兹 5 N
Cde 7 N

```

会导致：

```
名称 SEQ_NO 已锁定
富 1 N
巴兹 2 N
酒吧 3 是
美国广播公司 4 岁
Cde 5 N

```

我怎么能那样做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-14T04:15:19.227

有时，您的`1..COUNT(*)`编号目标和“不要重新编号锁定的行”会导致无法解决的冲突。例如：

```
NAME  SEQ_NO    LOCKED
Foo    1        N
Bar   13        Y
Abc   14        Y
Baz    5        N
Cde    7        N 
```

我将假设这种情况所需的输出是：

```
NAME  SEQ_NO    LOCKED
Foo    1        N
Baz    2        N
Cde    3        N
Bar   13        Y
Abc   14        Y 
```

您的示例显示未锁定的数据按其原始序列号顺序保留，而锁定的数据显然没有得到新的编号。

我假设原始数据中没有重复的序列号。

* * *

### 快速总结

这是一个有趣而棘手的问题。重新排序数据的关键是知道在哪里放置未锁定的行。在示例数据中：

```
NAME  OLD_SEQ   LOCKED   NEW_SEQ
Foo   1         N        1
Bar   3         Y        3
Abc   4         Y        4
Baz   5         N        2
Cde   7         N        5 
```

我们可以给解锁的行一个从 1..3 开始的序列号，所以我们最终得到了一对*ord:old*序列**A { 1:1, 2:5, 3:7 }**。我们可以为结果集 1..5 生成一个槽列表。我们从该插槽列表中删除由锁定行持有的那些插槽，留下 { 1, 2, 5 } 作为重新排序列表中未锁定行占用的插槽列表。然后我们也按顺序编号，留下对*ord:new* **B { 1:1, 2:2, 3:5 }**。然后，我们可以在第一个字段上加入这两个列表 A 和 B 并投影排序，留下*新旧*插槽编号对**C { 1:1, 2:5, 5:7 }**。锁定的行产生一组*新：旧*值，其中*新 = 旧*在每种情况下，所以**D { 3:3, 4:4 }**。最终结果是 C 和 D 的并集，所以结果集包含：

*   新序号1中的旧序号1；
*   新 2 中的旧 5；
*   （旧 3 中新 3）；
*   （新4中的旧4）；和
*   新 5 中的旧 7。

这适用于锁定行的序列号也为 13 和 14 的情况；未锁定的行被分配新的序列号 1、2、3，而锁定的行保持不变。该问题的一条评论询问“1 个已锁定，5 个未锁定，10 个已锁定”；这将产生'1锁定，2解锁，10锁定'。

在 SQL 中做到这一点需要大量的 SQL。精通 OLAP 功能的人可能比我的代码更快地到达那里。并且将 SELECT 结果转换为 UPDATE 语句也很棘手（我还没有完全解决）。但是能够以正确的结果顺序获得数据是至关重要的，解决这个问题的关键是列表 A 和 B 表示的排序步骤。

* * *

## TDQD — 测试驱动的查询设计

与任何复杂的 SQL 查询操作一样，秘诀是逐步构建查询。如前所述，我们需要区别对待锁定行和未锁定行。在这种情况下，目标最终是一条 UPDATE 语句，但我们需要知道如何为 UPDATE 生成数据，所以我们先执行 SELECT。

### 可重新编号的行

```
-- Query 1
SELECT Name, Seq_No
  FROM My_Table
 WHERE Locked = 'N'
 ORDER BY Seq_No;

NAME  SEQ_NO
Foo   1
Baz   5
Cde   7 
```

在适当的时候，可以使用 ORDER BY 子句对它们进行排序，但是子查询通常不允许使用 ORDER BY 子句，我们需要生成一个数字。使用 OLAP 函数，您可能可以更紧凑地执行此操作。在 Oracle 中，您可以使用 ROWNUM 生成行号。有一个技巧适用于任何 DBMS，尽管它不是特别快。

### 重新编号的行假设没有来自锁定行的干扰

```
-- Query 2
SELECT m1.Name, m1.Seq_No AS Old_Seq, COUNT(*) AS New_Seq
  FROM My_Table m1
  JOIN My_Table m2
    ON m1.Seq_No >= m2.Seq_No
 WHERE m1.Locked = 'N' AND m2.Locked = 'N'
 GROUP BY m1.Name, m1.Seq_No
 ORDER BY New_Seq;

NAME  Old_Seq   New_Seq
Foo   1         1
Baz   5         2
Cde   7         3 
```

这是一个非等值连接，这就是使它不是特别快的操作的原因。

### 不可重新编号的行

```
-- Query 3
SELECT Name, Seq_No
  FROM My_Table
 WHERE Locked = 'Y'
 ORDER BY Seq_No;

NAME  Seq_No
Bar   3
Abc   4 
```

### 新的序列号

假设我们设法得到一个数字列表，1..N（样本数据中的 N = 5）。我们从该列表中删除锁定条目 (3, 4) 离开 (1, 2, 5)。当这些被排序时（1 = 1, 2 = 2, 3 = 5），我们可以将解锁记录新序列加入排名，但使用另一个数字作为记录的最终序列号。这只给我们留下了一些需要解决的小问题。首先，生成每个数字 1..N；我们可以做一个可怕的非等值小技巧，但应该有更好的方法：

```
-- Query 4
SELECT COUNT(*) AS Ordinal
  FROM My_Table AS t1
  JOIN My_Table AS t2
    ON t1.Seq_No >= t2.Seq_No
 GROUP BY t1.Seq_No
 ORDER BY Ordinal;

Ordinal
1
2
3
4
5 
```

然后我们可以从此列表中删除锁定的序列号：

```
-- Query 5
SELECT Ordinal
  FROM (SELECT COUNT(*) AS ordinal
          FROM My_Table t1
          JOIN My_Table t2
            ON t1.Seq_No <= t2.Seq_No
         GROUP BY t1.Seq_No
       ) O
 WHERE O.Ordinal NOT IN (SELECT Seq_No FROM My_Table WHERE Locked = 'Y')
 ORDER BY Ordinal;

 Ordinal
 1
 2
 5 
```

现在我们需要对它们进行排名，这意味着另一个自连接，但这次是在那个表达式上。是时候使用“通用表表达式”或 CTE，也称为“WITH 子句”：

```
-- Query 6
WITH HoleyList AS
    (SELECT ordinal
       FROM (SELECT COUNT(*) ordinal
               FROM My_Table t1
               JOIN My_Table t2
                 ON t1.seq_no <= t2.seq_no
              GROUP BY t1.seq_no
            ) O
      WHERE O.Ordinal NOT IN (SELECT Seq_No FROM My_Table WHERE Locked = 'Y')
    )
SELECT H1.Ordinal, COUNT(*) AS New_Seq
  FROM HoleyList H1
  JOIN HoleyList H2
    ON H1.Ordinal >= H2.Ordinal
 GROUP BY H1.Ordinal
 ORDER BY New_Seq;

Ordinal  New_Seq
1        1
2        2
5        3 
```

### 整理起来

所以，现在我们需要将该结果与查询 2 连接以获得解锁行的最终数字，然后将其与查询 3 合并以获得所需的输出。当然，我们也必须在输出中为 Locked 获取正确的值。仍在逐步进行：

```
-- Query 7
WITH
Query2 AS
   (SELECT m1.Name, m1.Seq_No AS Old_Seq, COUNT(*) AS New_Seq
      FROM My_Table m1
      JOIN My_Table m2 ON m1.Seq_No <= m2.Seq_No
     WHERE m1.Locked = 'N' AND m2.Locked = 'N'
     GROUP BY m1.Name, m1.Seq_No
   ),
HoleyList AS
   (SELECT ordinal
      FROM (SELECT COUNT(*) AS ordinal
              FROM My_Table t1
              JOIN My_Table t2
                ON t1.seq_no <= t2.seq_no
             GROUP BY t1.seq_no
           ) O
      WHERE O.Ordinal NOT IN (SELECT Seq_No FROM My_Table WHERE Locked = 'Y')
    ),
Reranking AS    
   (SELECT H1.Ordinal, COUNT(*) AS New_Seq
      FROM HoleyList H1
      JOIN HoleyList H2
        ON H1.Ordinal >= H2.Ordinal
     GROUP BY H1.Ordinal
   )
SELECT r.Ordinal, r.New_Seq, q.Name, q.Old_Seq, 'N' Locked
  FROM Reranking r
  JOIN Query2    q
    ON r.New_Seq = q.New_Seq
 ORDER BY r.New_Seq;

Ordinal  New_Seq  Name  Old_Seq  Locked
1        1        Cde   7        N
2        2        Baz   5        N
5        3        Foo   1        N 
```

这需要结合查询 3 的变体：

```
-- Query 3a
SELECT Seq_No Ordinal, Seq_No New_Seq, Name, Seq_No Old_Seq, Locked
  FROM My_Table
 WHERE Locked = 'Y'
 ORDER BY New_Seq;

Ordinal  New_Seq  Name  Old_Seq  Locked
3        3        Bar   3        Y
4        4        Abc   4        Y 
```

### 结果集

结合这些产量：

```
-- Query 8
WITH
Query2 AS
   (SELECT m1.Name, m1.Seq_No AS Old_Seq, COUNT(*) AS New_Seq
      FROM My_Table m1
      JOIN My_Table m2 ON m1.Seq_No <= m2.Seq_No
     WHERE m1.Locked = 'N' AND m2.Locked = 'N'
     GROUP BY m1.Name, m1.Seq_No
   ),
HoleyList AS
   (SELECT ordinal
      FROM (SELECT COUNT(*) AS ordinal
              FROM My_Table t1
              JOIN My_Table t2
                ON t1.seq_no <= t2.seq_no
             GROUP BY t1.seq_no
           ) O
      WHERE O.Ordinal NOT IN (SELECT Seq_No FROM My_Table WHERE Locked = 'Y')
    ),
Reranking AS    
   (SELECT H1.Ordinal, COUNT(*) AS New_Seq
      FROM HoleyList H1
      JOIN HoleyList H2
        ON H1.Ordinal >= H2.Ordinal
     GROUP BY H1.Ordinal
   ),
Query7 AS
   (SELECT r.Ordinal, r.New_Seq, q.Name, q.Old_Seq, 'N' Locked
      FROM Reranking r
      JOIN Query2    q
        ON r.New_Seq = q.New_Seq
   ),
Query3a AS
   (SELECT Seq_No Ordinal, Seq_No New_Seq, Name, Seq_No Old_Seq, Locked
      FROM My_Table
     WHERE Locked = 'Y'
   )
SELECT Ordinal, New_Seq, Name, Old_Seq, Locked
  FROM Query7
UNION
SELECT Ordinal, New_Seq, Name, Old_Seq, Locked
  FROM Query3a
 ORDER BY New_Seq; 
```

这给出了结果：

```
Ordinal  New_Seq  Name  Old_Seq  Locked
1        1        Cde   7        N
2        2        Baz   5        N
3        3        Bar   3        Y
4        4        Abc   4        Y
5        3        Foo   1        N 
```

因此，可以（尽管远非简单）编写一个正确排序数据的 SELECT 语句。

### 转换为 UPDATE 操作

现在我们必须找到一种方法将这种怪物放入 UPDATE 语句中。留给我自己的设备，我会考虑将查询 8 的结果选择到临时表中的事务，然后从源表 ( `My_Table`) 中删除所有记录并将查询 8 的结果的适当项目插入到原始表，然后提交。

Oracle 似乎不支持动态创建的“每个会话”临时表；只有全局临时表。并且有充分的理由不使用它们，因为它们都是 SQL 标准。尽管如此，它会在这里解决问题，我不确定还有什么可以工作：

与这项工作分开：

```
CREATE GLOBAL TEMPORARY TABLE ReSequenceTable
(
    Name     CHAR(3) NOT NULL,
    Seq_No   INTEGER NOT NULL,
    Locked   CHAR(1) NOT NULL
)
ON COMMIT DELETE ROWS; 
```

然后：

```
-- Query 8a
BEGIN;   -- May be unnecessary and/or unsupported in Oracle
INSERT INTO ReSequenceTable(Name, Seq_No, Locked)
    WITH
    Query2 AS
       (SELECT m1.Name, m1.Seq_No AS Old_Seq, COUNT(*) AS New_Seq
          FROM My_Table m1
          JOIN My_Table m2 ON m1.Seq_No <= m2.Seq_No
         WHERE m1.Locked = 'N' AND m2.Locked = 'N'
         GROUP BY m1.Name, m1.Seq_No
       ),
    HoleyList AS
       (SELECT ordinal
          FROM (SELECT COUNT(*) AS ordinal
                  FROM My_Table t1
                  JOIN My_Table t2
                    ON t1.seq_no <= t2.seq_no
                 GROUP BY t1.seq_no
               ) O
          WHERE O.Ordinal NOT IN (SELECT Seq_No FROM My_Table WHERE Locked = 'Y')
        ),
    Reranking AS    
       (SELECT H1.Ordinal, COUNT(*) AS New_Seq
          FROM HoleyList H1
          JOIN HoleyList H2
            ON H1.Ordinal >= H2.Ordinal
         GROUP BY H1.Ordinal
       ),
    Query7 AS
       (SELECT r.Ordinal, r.New_Seq, q.Name, q.Old_Seq, 'N' Locked
          FROM Reranking r
          JOIN Query2    q
            ON r.New_Seq = q.New_Seq
       ),
    Query3a AS
       (SELECT Seq_No Ordinal, Seq_No New_Seq, Name, Seq_No Old_Seq, Locked
          FROM My_Table
         WHERE Locked = 'Y'
       )
    SELECT Name, Ordinal, Locked
      FROM Query7
    UNION
    SELECT Name, Ordinal, Locked
      FROM Query3a;

DELETE FROM My_Table;
INSERT INTO My_Table(Name, Seq_No, Locked) FROM ReSequenceTable;
COMMIT; 
```

您可能可以通过适当的更新来做到这一点；你需要做一些思考。

* * *

## 概括

这并不容易，但可以做到。

*关键步骤*（至少对我而言）是来自*Query 6*的结果集，它计算出更新结果集中未锁定行的新位置。这不是立即显而易见的，但对于产生答案至关重要。

其余的只是围绕该关键步骤包装的支持代码。

如前所述，可能有很多方法可以改进某些查询。例如，`1..N`从表中生成序列可能很简单`SELECT ROWNUM FROM My_Table`，它可以压缩查询（非常有益——它很冗长）。有OLAP功能；其中一个或多个可能有助于排名操作（可能更简洁；也喜欢表现更好）。

所以，这不是一个完美的最终答案；但这是朝着正确大方向的有力推动。

* * *

### PoC 测试

该代码已针对 Informix 进行了测试。我不得不使用一些不同的符号，因为 Informix （还）不支持 CTE。它确实具有非常方便、非常简单的每个会话的动态临时表，`INTO TEMP <temp-table-name>`它出现在 ORDER BY 子句可能出现的地方。因此，我模拟了查询 8a：

```
+ BEGIN;
+ SELECT O.Ordinal
  FROM (SELECT COUNT(*) AS ordinal
          FROM My_Table AS t1
          JOIN My_Table AS t2
            ON t1.Seq_No <= t2.Seq_No
         GROUP BY t1.Seq_No
       ) AS O
 WHERE O.Ordinal NOT IN (SELECT Seq_No FROM My_Table WHERE Locked = 'Y')
 INTO TEMP HoleyList;
+ SELECT * FROM HoleyList ORDER BY Ordinal;
1
2
5
+ SELECT H1.Ordinal, COUNT(*) AS New_Seq
  FROM HoleyList AS H1
  JOIN HoleyList AS H2
    ON H1.Ordinal >= H2.Ordinal
 GROUP BY H1.Ordinal
 INTO TEMP ReRanking;
+ SELECT * FROM ReRanking ORDER BY Ordinal;
1|1
2|2
5|3
+ SELECT m1.Name, m1.Seq_No AS Old_Seq, COUNT(*) AS New_Seq
  FROM My_Table m1
  JOIN My_Table m2
    ON m1.Seq_No >= m2.Seq_No
 WHERE m1.Locked = 'N' AND m2.Locked = 'N'
 GROUP BY m1.Name, m1.Seq_No
  INTO TEMP Query2;
+ SELECT * FROM Query2 ORDER BY New_Seq;
Foo|1|1
Baz|5|2
Cde|7|3
+ SELECT r.Ordinal, r.New_Seq, q.Name, q.Old_Seq, 'N' Locked
  FROM Reranking r
  JOIN Query2    q
    ON r.New_Seq = q.New_Seq
  INTO TEMP Query7;
+ SELECT * FROM Query7 ORDER BY Ordinal;
1|1|Foo|1|N
2|2|Baz|5|N
5|3|Cde|7|N
+ SELECT Seq_NO Ordinal, Seq_No New_Seq, Name, Seq_No Old_Seq, Locked
  FROM My_Table
 WHERE Locked = 'Y'
  INTO TEMP Query3a;
+ SELECT * FROM Query3a ORDER BY Ordinal;
3|3|Bar|3|Y
4|4|Abc|4|Y
+ SELECT Ordinal, New_Seq, Name, Old_Seq, Locked
  FROM Query7
UNION
SELECT Ordinal, New_Seq, Name, Old_Seq, Locked
  FROM Query3a
  INTO TEMP Query8;
+ SELECT * FROM Query8 ORDER BY Ordinal;
1|1|Foo|1|N
2|2|Baz|5|N
3|3|Bar|3|Y
4|4|Abc|4|Y
5|3|Cde|7|N
+ ROLLBACK; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-03T14:13:08.583

```
merge into my_table
using (
   select rowid as rid,
          row_number() over (order by seq_no) as rn
   from my_table
   where locked = 'N'
) t on (t.rid = my_table.rowid) 
when matched then update
   set seq_no = t.rn; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-03T14:08:22.827

这可能无法获得所有数据案例，但它适用于示例数据：

```
update my_table mt
set seq_no = 
(with renumber as (select /*+ MATERIALIZE */ rownum rn, name, seq_no, locked
from
(
select * from my_table
where locked = 'N'
order by seq_no
)
)
select rn from renumber rn where rn.seq_no = mt.seq_no
)
where locked = 'N'
; 
```

完整的例子如下：

```
create table my_table as
select 'Foo' name, 1 seq_no, 'N' locked from dual union
select 'Bar' name, 3 seq_no, 'Y' locked from dual union
select 'Baz' name, 5 seq_no, 'N' locked from dual 
order by seq_no
;

select * from my_table
order by seq_no
;

update my_table mt
set seq_no = 
(with renumber as (select /*+ MATERIALIZE */ rownum rn, name, seq_no, locked
from
(
select * from my_table
where locked = 'N'
order by seq_no
)
)
select rn from renumber rn where rn.seq_no = mt.seq_no
)
where locked = 'N'
;

select * from my_table
order by seq_no
; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-16T14:45:51.263

```
WITH
  yourTable_unlocked_resequenced
AS
(
  SELECT
    yourTable.*,
    CASE WHEN
      yourTable.locked ='N'
    THEN
      ROW_NUMBER() OVER (PARTITION BY locked ORDER BY seq_no)
    END AS unlocked_seq_no
  FROM
    yourTable
)
,
  master_list
AS
(
  SELECT
    ROW_NUMBER() OVER (ORDER BY seq_no)       AS seq_no
  FROM
    yourTable
)
,
  master_list_unlocked_resequenced
AS
(
  SELECT
    master_list.seq_no,
    ROW_NUMBER() OVER (PARTITION BY yourTable.locked ORDER BY master_list.seq_no) AS unlocked_seq_no
  FROM
     master_list
  LEFT JOIN
     yourTable
       ON  yourTable.seq_no = master_list.seq_no
       AND yourTable.locked = 'Y'
  WHERE
    yourTable.locked IS NULL
)
SELECT
  original.*,
  modified.*,
  COALESCE(modified.seq_no, original_seq_no) AS final_seq_no
FROM
  yourTable_unlocked_resequenced      AS original
LEFT JOIN
  master_list_unlocked_resequenced    AS modified
    ON original.unlocked_seq_no = modified.unlocked_seq_no 
```

浓缩它可能是可能的，但我会说它有效。

使用您当前的值...

```
Seq_No           1 3 4 5 7
Locked           N Y Y N N
Unlocked_Seq_No  1     2 3

Seq_No           1 2 3 4 5
Unlocked_Seq_No  1 2     3

Original_Seq_No  1 3 4 5 7
Modified_Seq_No  1 3 4 2 5 
```

如果您稍微更改了数据，您会得到以下结果，其中一个值 (the `8`) 由于它被锁定而位于序列之外...

```
Seq_No           1 3 5 7 8
Locked           N Y N N Y
Unlocked_Seq_No  1   2 3  

Seq_No           1 2 3 4 5
Unlocked_Seq_No  1 2   3 4

Original_Seq_No  1 3 5 7 8
Modified_Seq_No  1 3 2 4 8 
```

# network-programming - write() 函数返回 ULLONG_MAX？

> ID：10431307
> 
> 赞同：1
> 
> 时间：2012-05-03T12:23:53.663
> 
> 标签：network-programming

我正在构建 JPerf (http://sourceforge.net/projects/jperf/)，它是在 C 程序 IPerf (https://sourceforge.net/projects/iperf/) 上运行的 GUI。IPerf 基本上通过客户端向服务器发出 write() 命令并执行一些逻辑来测量带宽来测量网络链接的带宽。

简而言之，我遇到的问题如下：如果我拔掉客户端和服务器之间的网线，等待大约 10 秒，然后重新插入，write() 函数返回 ULLONG_MAX 的值，无论我等多久，它都会继续这样做。

有没有人在使用 write() 通过网络连接进行写入时遇到过这种情况？我的最终目标是让该功能恢复连接并即使在拔下并重新插入后也能继续传输数据。

提前感谢您提供的任何意见！

编辑：重新插入网络电缆后，errno 值为“对等方重置连接”，然后切换到“断管”

有谁知道我怎样才能恢复连接？

# macos - 在 OS X 上安装 yajl-py：“找不到 Yajl 共享对象。请安装 Yajl 并确认它在您的共享库路径上。”

> ID：10431308
> 
> 赞同：2
> 
> 时间：2012-05-03T12:23:54.780
> 
> 标签：macos, yajl

我正在尝试在我的 Mac 上安装 yajl-py ()。但是，它给出了以下错误：

```
Yajl shared object cannot be found. Please install Yajl and confirm it is on your shared lib path. 
```

我通过 yajl 安装了`ports`，所以我知道它在那里，问题是如何将 /opt/local/lib 中的共享库获取到库路径中。

做一些阅读，似乎是一个坏主意`LD_LIBRARY_PATH`，但我没有看到任何替代方案。有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T13:12:21.483

我不确定这是否是最好的解决方案（如果有问题请告诉我），但现在我将 dylib 文件从符号链接`/opt/local/lib`到`/user/local/lib`使用以下命令：

```
sudo ln -s /opt/local/lib/libyajl.dylib /usr/local/lib/libyajl.dylib 
```

# cocoa-touch - 在 Core Graphics 中向 CGContext 添加一个点

> ID：10431313
> 
> 赞同：2
> 
> 时间：2012-05-03T12:24:17.953
> 
> 标签：cocoa-touch, core-graphics, cgcontext

我必须在 UIButton 上添加一个小红点。我使用此方法设置自定义 UIButton 的颜色：

```
+ (UIImage *) imageFromColor:(UIColor *)color {
    CGRect rect = CGRectMake(0, 0, 1, 1);
    UIGraphicsBeginImageContext(rect.size);
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetFillColorWithColor(context, [color CGColor]);
    //  [[UIColor colorWithRed:222./255 green:227./255 blue: 229./255 alpha:1] CGColor]) ;
    CGContextFillRect(context, rect);
    UIImage *img = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return img;
} 
```

然后我只需在这个按钮上添加一个简单的红点，大概是这样完成的：

```
+ (UIImage *) addRedDot 
{
    CGRect rect = CGRectMake(0, 0, 1, 1);
    UIGraphicsBeginImageContext(rect.size);
    CGContextRef context = UIGraphicsGetCurrentContext();
    CGContextSetFillColorWithColor(context, [[UIColor redColor] CGColor]);
    //  [[UIColor colorWithRed:222./255 green:227./255 blue: 229./255 alpha:1] CGColor]) ;
    CGContextSetRGBStrokeColor(context, 1.0f, 0.0f, 0.0f, 1.0f);

    CGContextSetLineWidth(context, 2.0);
    CGContextStrokeEllipseInRect(context, CGRectMake(10, 11, 21, 21));

 //   CGContextFillRect(context, rect);
    UIImage *img = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return img;
} 
```

但它只返回一个白色图像.. 这个客户端代码是：

```
 if ([dateStringToAssign isEqualToString:[self dateToString:[NSDate date]]]) 
            {

                [buttonToLay setBackgroundImage:[CommonUIUtility imageFromColor:[UIColor cyanColor]] 
                                  forState:UIControlStateNormal];

            }
            if([dbm hasEventsForDate:buttonToLay.ownedDate])
            {
                NSLog(@"Has events");
                [buttonToLay setBackgroundImage:[CommonUIUtility addRedDot] forState:UIControlStateNormal];

            } 
```

向现有 CGContext 添加小红点的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:44:28.407

您正在抚摸一个超出您在此行中设置的上下文范围的椭圆：

`CGContextStrokeEllipseInRect(context, CGRectMake(10, 11, 21, 21));`

为了让椭圆显示出来，它需要在你的上下文范围内，它的大小似乎是 1x1。

# web-services - 如何从客户端应用程序访问 Jira GreenHopper 的数据？

> ID：10431314
> 
> 赞同：1
> 
> 时间：2012-05-03T12:24:18.023
> 
> 标签：web-services, jira, jira-plugin, jira-agile

我需要从客户端应用程序访问 Jira GreenHopper 的数据。数据是通过相同的 Jira SOAP api 公开还是有其他访问方式？任何指针都会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-03T15:33:48.960

您可以通过 API 访问 GreenHopper 数据。使用[REST API 浏览器](http://blogs.atlassian.com/2011/11/introducing-the-rest-api-browser-and-the-atlassian-developer-toolbox/)查找所有 REST 端点的列表以及您可以收集的数据（冲刺、排名、董事会等​​）。

如果您对 GreenHopper 或 JIRA 有任何其他问题，那么[Atlassian Answers](http://answers.atlassian.com)是一个很好的资源。

谢谢，

[尼古拉斯·马尔登](http://nicholasmuldoon.com)

[@GreenHopperTeam](http://twitter.com/GreenHopperTeam)

# java - 强制浏览器在 JAVA 中下载 docx 文件会生成损坏的文档

> ID：10431317
> 
> 赞同：1
> 
> 时间：2012-05-03T12:24:23.907
> 
> 标签：java, ms-office, mime-types, docx, force-download

使用 JAVA，我试图强制浏览器下载文件。

这是我目前使用的代码：

```
response.reset();
response.resetBuffer();
response.setContentType(mimeType);
response.setHeader("Content-Disposition", "attachment; filename=\"" + fileName + "\"");

InputStream in = new FileInputStream(file);
OutputStream out = response.getOutputStream();
IOUtils.copy(in, out);

out.flush();
out.close();
in.close();
response.flushBuffer(); 
```

它*几乎*可以正常工作，但是当强制下载`docx`文档（MS Office 2007+）时，下载的文件已损坏（至少，这是 MS Office 告诉我的）。如果我尝试直接在存储它们的服务器上打开它，则不会出现该错误，这意味着问题在下载时会干扰（而不是在上传时）。

根据[IANA](http://www.iana.org/assignments/media-types/application/index.html)，此类文件的 MIME 类型应为`application/vnd.openxmlformats-officedocument.wordprocessingml.document` **(1)**，但指定 MIME 类型并不能解决问题。

网上有好几*首曲目*，但没有一个适合我。中似乎有[解决方案](https://stackoverflow.com/questions/2477564/why-are-docx-files-being-corrupted-when-downloading-from-an-asp-net-page)`ASP.NET`，但我没有在 中找到等效的解决方案`JAVA`。

我也尝试使用我在[那里](http://www.coderanch.com/t/468307/JSP/java/pptx-docx)看到的 MIME 类型`application/vnd.ms-word` **(2)**，但下载的文件仍然损坏。一个人[在这里建议的 MIME 类型](http://code.google.com/p/java2word/issues/detail?id=16)**(3)和**[这个论坛](http://www.coderanch.com/t/572284/Servlets/java/docx-won-open)上提出的通用 MIME 类型**(4)**的同上。`application/msword` **`application/octet-stream`**

 ****然后，对于这四种 MIME 类型中的每一种，我都尝试将下载文件的名称从更改`myfile.docx`为`myfile.doc`（不再是*x*），但问题仍然存在。

那么，如何强制下载*未损坏的下载* `docx`文件？我的代码正确吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T13:17:04.537

我偶然尝试添加更多标题，实际上，`Content-Length`标题解决了问题......

所以最后，我只是添加了这一行来使它工作：

```
response.setContentLength((int) file.length()); 
```****

# java - 使用 Twitter4j 每日趋势？

> ID：10431321
> 
> 赞同：10
> 
> 时间：2012-05-03T12:24:37.727
> 
> 标签：java, twitter

我一直在开发一个小程序，我想在其中阅读流行的 twitter 主题并将它们存储在数据库中。目前我正在使用 twitter4j getDailyTrends() 方法，但得到奇怪的结果。

我目前拥有的代码是：

```
 Twitter twitter = new TwitterFactory().getInstance();
        ResponseList<Trends> dailyTrends;

        dailyTrends = twitter.getDailyTrends();

        System.out.println();

        // Print the trends.
        for (Trends trends : dailyTrends) {
                    System.out.println("As of : " + trends.getAsOf());
                      for (Trend trend : trends.getTrends()) {
                            System.out.println(" " + trend.getName());
                       }
        } 
```

但是，当程序运行时，它会显示相同的趋势列表 24 次。我曾尝试在不同的日子运行该程序，但是无论我在哪一天运行该程序，列表总是相同的。

我还尝试将当前日期传递给 getDailyTrends() 方法并获得相同的结果。

将不胜感激任何帮助，这让我发疯。:)

编辑：我不断得到的结果集显示了 25.04.2012 的 twitter 趋势。无论我何时运行程序，或者我给它的日期是什么 - 我都会得到相同的结果。

EDIT2：好的，所以这一直困扰着我一整天，我最终找到了 twitter4j 自己提供的示例代码，用于阅读趋势。我运行他们的代码而不是我的代码，我遇到了同样的问题。趋势是几周前的，并且永远不会改变。有没有人真正设法让这种方法工作过？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-08-05T13:12:13.237

```
getPlaceTrends(int woeid) 
```

如果有可用的趋势信息，则返回特定**WOEID的前 10 个趋势主题。**

**woeid** - 雅虎！要返回其趋势信息的位置 ID。使用 1 作为**WOEID**可获得全局信息。

您可以使用以下代码获取不同位置的 WOEID

```
Twitter twitter = new TwitterFactory().getInstance();
ResponseList<Location> locations;
locations = twitter.getAvailableTrends();
System.out.println("Showing available trends");
for (Location location : locations) {
    System.out.println(location.getName() + " (woeid:" + location.getWoeid() + ")");
} 
```

然后，您可以使用它的 WOEID 获取特定位置的当前趋势，如下所示

```
Trends trends = twitter.getPlaceTrends(2295414);
for (int i = 0; i < trends.getTrends().length; i++) {
    System.out.println(trends.getTrends()[i].getName());
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-10-30T09:28:29.480

我使用 twitter4j，这是我的课程，可以从您作为参数获取的位置获取趋势主题，在本例中为“西班牙”

```
import twitter4j.Location;
import twitter4j.ResponseList;
import twitter4j.Trends;
import twitter4j.Twitter;
import twitter4j.TwitterException;

public final class GetTrendingTopics {

    public static void main(String[] args) {

    try {

       ConfigurationBuilder cb = new ConfigurationBuilder();
cb.setDebugEnabled(true).setOAuthConsumerKey("yourConsumerKey").setOAuthConsumerSecret("yourConsumerSecret").setOAuthAccessToken("yourOauthToken").setOAuthAccessTokenSecret("yourOauthTokenSecret");

        TwitterFactory tf = new TwitterFactory(cb.build());
        Twitter twitter = tf.getInstance();

        ResponseList<Location> locations;
        locations = twitter.getAvailableTrends();

        Integer idTrendLocation = getTrendLocationId("spain");

        if (idTrendLocation == null) {
        System.out.println("Trend Location Not Found");
        System.exit(0);
        }

        Trends trends = twitter.getPlaceTrends(idTrendLocation);
        for (int i = 0; i < trends.getTrends().length; i++) {
        System.out.println(trends.getTrends()[i].getName());
        }

        System.exit(0);

    } catch (TwitterException te) {
        te.printStackTrace();
        System.out.println("Failed to get trends: " + te.getMessage());
        System.exit(-1);
    }
    }

    private static Integer getTrendLocationId(String locationName) {

    int idTrendLocation = 0;

    try {

        ConfigurationBuilder cb = new ConfigurationBuilder();
cb.setDebugEnabled(true).setOAuthConsumerKey("yourConsumerKey").setOAuthConsumerSecret("yourConsumerSecret").setOAuthAccessToken("yourOauthToken").setOAuthAccessTokenSecret("yourOauthTokenSecret");

        TwitterFactory tf = new TwitterFactory(cb.build());
        Twitter twitter = tf.getInstance();

        ResponseList<Location> locations;
        locations = twitter.getAvailableTrends();

        for (Location location : locations) {
        if (location.getName().toLowerCase().equals(locationName.toLowerCase())) {
            idTrendLocation = location.getWoeid();
            break;
        }
        }

        if (idTrendLocation > 0) {
        return idTrendLocation;
        }

        return null;

    } catch (TwitterException te) {
        te.printStackTrace();
        System.out.println("Failed to get trends: " + te.getMessage());
        return null;
    }

    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T12:57:13.983

我依稀记得，但你能试试以下

```
for (Trends trends : dailyTrends) {
                    System.out.println("As of : " + trends.getAsOf());

                     System.out.println(" " + trends.getTrendAt());

        } 
```

# ios - 我收到了崩溃。我有一个非常有趣的例外。它是什么？

> ID：10431323
> 
> 赞同：1
> 
> 时间：2012-05-03T12:24:45.263
> 
> 标签：ios, exception, crash

我收到了崩溃。我有一个非常有趣的例外。它是什么？

```
objc[4841]: EXCEPTIONS: throwing 0x11c06ac0 (object 0x11c06a30, a NSException)
objc[4841]: EXCEPTIONS: searching through frame [ip=0x113b9de sp=0xbfffe6d0] for exception 0x11c06aa0
objc[4841]: EXCEPTIONS: catch(id)
objc[4841]: EXCEPTIONS: unwinding through frame [ip=0x113b9de sp=0xbfffe6d0] for exception 0x11c06aa0
objc[4841]: EXCEPTIONS: handling exception 0x11c06aa0 at 0x113bb9c
objc[4841]: EXCEPTIONS: finishing handler
objc[4841]: EXCEPTIONS: throwing 0x11ea1220 (object 0x11c06a30, a NSException)
objc[4841]: EXCEPTIONS: searching through frame [ip=0x113bb8c sp=0xbfffe6d0] for exception 0x11ea1200
objc[4841]: EXCEPTIONS: searching through frame [ip=0x24b7d83 sp=0xbffff410] for exception 0x11ea1200
objc[4841]: EXCEPTIONS: unwinding through frame [ip=0x113bb8c sp=0xbfffe6d0] for exception 0x11ea1200
objc[4841]: EXCEPTIONS: unwinding through frame [ip=0x24b7d83 sp=0xbffff410] for exception 0x11ea1200
objc[4841]: EXCEPTIONS: handling exception 0x11ea1200 at 0x24b7e16
objc[4841]: EXCEPTIONS: rethrowing current exception
objc[4841]: EXCEPTIONS: searching through frame [ip=0x24b7ddf sp=0xbffff410] for exception 0x11ea1200
objc[4841]: EXCEPTIONS: terminating
objc[4841]: EXCEPTIONS: searching through frame [ip=0x2731eed sp=0xbffff3a0] for exception 0x11ea1200
objc[4841]: EXCEPTIONS: catch(id)
objc[4841]: EXCEPTIONS: unwinding through frame [ip=0x2731eed sp=0xbffff3a0] for exception 0x11ea1200
objc[4841]: EXCEPTIONS: handling exception 0x11ea1200 at 0x2731eff
2012-05-03 15:17:22.803 A[4841:16d03] *** Terminating app due to uncaught exception 'NSRangeException', reason: '*** -[__NSArrayM insertObject:atIndex:]: index 2 beyond bounds [0 .. 0]'
 *** First throw call stack:
 (0x2581022 0x2731cd6 0x256e33e 0x256f1f0 0x11e149 0x2582e99 0x89a89 0x2582e42 0x113b9df 0x255594f 0x24b8b43 0x24b8424 0x24b7d84 0x24b7c9b 0x27137d8 0x271388a 0x1473626 0x2e6d 0x2de5) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:28:06.430

`-[__NSArrayM insertObject:atIndex:]: index 2 beyond bounds [0 .. 0]'`意味着您正在尝试使用 NSMutableArray 的 -insertObject:atIndex: 索引值高于数组的实际计数（事实证明，它是空的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:27:51.153

似乎您正试图将数据插入到不存在索引位置的数组中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:29:04.290

以日期开头的行似乎最有可能找出正在发生的事情。

虽然这个问题没有足够的信息。

# jsp - 创建一个excel表并从数据库中插入数据

> ID：10431325
> 
> 赞同：0
> 
> 时间：2012-05-03T12:24:56.453
> 
> 标签：jsp

```
response.setContentType("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
"); response.setHeader("Content-Disposition",
"attachment;filename=\"j.xls\"  ");

//int ch=Integer.parseInt(request.getParameter("id"));
Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver"); String
url = "jdbc:sqlserver://"; Connection con =
DriverManager.getConnection(url,"sa","sql1423#3"); Statement stmt =
con.createStatement();

HSSFWorkbook hwb=new HSSFWorkbook(); HSSFSheet sheet = 
hwb.createSheet("new sheet"); HSSFSheet sheet1 =  hwb.createSheet("new
sheet1");

HSSFRow rowhead=   sheet.createRow((short)0);

String select[] = request.getParameterValues("id");  if (select != null && select.length != 0) {

    for (int i = 0; i < select.length; i++)     {   //out.println(select[i]);
        int ch=Integer.parseInt(select[i]);

        switch(ch)                  {
            case 1 :            rowhead.createCell((short) 0).setCellValue("INDEX_FLG");            ResultSet
rs=stmt.executeQuery("select INDEX_FLG from FFIX");

              while(rs.next())
              {

                  rowhead.createCell((short) 0).setCellValue(rs.getString("INDEX_FLG"));
                 //out.println(rs.getString("INDEX_FLG")); 

              }

              rs.close();
                 break;

         case 2 : 

            rowhead.createCell((short) 0).setCellValue("SYMBOL");           ResultSet rsS=stmt.executeQuery("select SYMBOL from FFIX");;

          while(rsS.next())
          {
              rowhead.createCell((short) 0).setCellValue(rsS.getString("SYMBOL"));
           } 

              rsS.close();
                break;

         case 3 : 
            rowhead.createCell((short) 0).setCellValue("SERIES");
            ResultSet rsSE=stmt.executeQuery("select SERIES from FFIX");
            while(rsSE.next())          {
                rowhead.createCell((short) 0).setCellValue(rsSE.getString("SERIES"));           
            }
         rsSE.close();
         break;
        }
    } 
```

嗨，这是我的 jsp 代码，我正在从 html 页面检索值并检查 switch case 中的复选框值。我正在尝试使用 jsp 创建一个 excel 表并将数据库中的记录插入到该 excel 中。但是当我执行上面的代码时，它给出的输出是白色的空白 excel 文件。即使 excel 表也没有显示我现在应该做什么请帮助我 PLZ Thanx Kajal

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:36:41.840

您是否将 HSSFWorkbook 写入响应的输出流？

```
hwb.write(response.getOutputStream()) 
```

# javascript - jQuery 悬停问题 - 最后一个 li 元素保持悬停

> ID：10431326
> 
> 赞同：0
> 
> 时间：2012-05-03T12:25:02.443
> 
> 标签：javascript, jquery, jquery-hover

我尝试了很多选择，但没有结果。但是，我有这个代码

```
<ul class="left_nav">
    <li class="left_nav1"><a href="#">opt1</a></li><li class="left_nav2">
    <a href="#">opt1</a></li><li class="left_nav3">
    <a href="#">opt1</a></li><li class="left_nav4">
    <a href="#">opt1</a></li><li class="left_nav5">
    <a href="#">opt1</a></li>
</ul> 
```

这些 div 带有图像

```
<div id="news1" class="news">
    <a href="#" target="_blank"><img src="img/news/news1.jpg" width="340" height="255" alt="" title="" /></a>
</div>
<div id="news2" class="news">
    <a href="#" target="_blank"><img src="img/news/news2.jpg" width="340" height="289" alt="" title="" /></a>
</div>
<div id="news3" class="news">
    <a href="#" target="_blank"><img src="img/news/news3.jpg" width="340" height="232" alt="" title="" /></a>
</div>
<div id="news4" class="news">
    <a href="#" target="_blank"><img src="img/news/news4.jpg" width="340" height="250" alt="" title="" /></a>
</div>
<div id="news5" class="news">
    <a href="#" target="_blank"><img src="img/news/news5.jpg" width="340" height="226" alt="" title="" /></a>
</div> 
```

现在`class="news"`默认是`display: none;`. 有了这个 jQuery

```
$(function() {
    $("ul.left_nav li").hover( function() {
            index = $("ul.left_nav li").index(this) + 1;
            $('#news' + index).addClass('active');
        }, function() {
            $('#news' + index).removeClass('active');
        }
    );
}); 
```

`active`通过添加定义为的类，div 在悬停时出现`display: block;`。`<ul>`当鼠标在菜单上时，我想再次删除这个类。但是如果鼠标离开菜单，那么最后一个悬停在悬停`<li>`状态，带有图像的 div 也将保持可见。我怎么能意识到这一点？

谢谢！​</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T12:36:31.173

像这样的东西怎么样...... [http://jsfiddle.net/HcjLW/1/](http://jsfiddle.net/HcjLW/1/)

您需要为悬停的 div 提供某种唯一的 id，以便我们可以将其转换为带有图像的 div 的 id（或索引）。

**带有 ID 而不是类的 HTML**

```
 <ul class="left_nav">
        <li id="left_nav1"><a href="#">opt1</a></li>
        ...
    </ul> 
```

**JS**

```
 $("ul.left_nav li").hover( function () {
        $('#news'+  $(this).attr('id').replace('left_nav','')).addClass('active');
    }, function () {
        $('#news'+  $(this).attr('id').replace('left_nav','')).removeClass('active');
    }); 
```

* * *

**更清洁的解决方案**

* * *

一个更好的想法是给所有 left_nav 项目一个公共类，并使用该`data-XXXX`属性分配一个索引 ( `data-index`)。

[http://jsfiddle.net/HcjLW/3/](http://jsfiddle.net/HcjLW/3/)

**HTML**

```
<ul class="left_nav">
    <li class="left_nav_item" data-index="1"><a href="#">opt1</a></li>
    <li class="left_nav_item" data-index="2"><a href="#">opt1</a></li>
    <li class="left_nav_item" data-index="3"><a href="#">opt1</a></li>
    <li class="left_nav_item" data-index="4"><a href="#">opt1</a></li>
    <li class="left_nav_item" data-index="5"><a href="#">opt1</a></li>
</ul> 
```

**JS**

```
 $(".left_nav_item").hover( function () {
        $('#news'+  $(this).data('index')).addClass('active');
    }, function () {
        $('#news'+  $(this).data('index')).removeClass('active');
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T12:36:44.447

将它与 mouseover 绑定，而不是让每个事件清除除 mouseovered 之外的其他消息。

```
$("ul.left_nav li").mouseover( function () {

     index = $("ul.left_nav li").index(this)+1;

     $('.news').removeClass('active');

     $('#news'+index).addClass('active');

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:45:51.057

您没有包含文档的就绪事件：

```
$(document).ready(function() {
    $("ul.left_nav li").hover( function () {
        index = $("ul.left_nav li").index(this)+1;
        $('#news'+index).addClass('active');
    }, function () {
        $('#news'+index).removeClass('active');
    });
}); 
```

这会起作用

# java - 如何使用 crawler4j 搜索存在于不同网页中的字符串

> ID：10431327
> 
> 赞同：0
> 
> 时间：2012-05-03T12:25:07.580
> 
> 标签：java, crawler4j

我正在使用 Crawler4j 它返回输出为已处理页面：10 找到的总链接：369 总文本大小：20077 到此它工作正常，但我想搜索此页面中存在的字符串我怎么能做到这一点你可以请帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T13:34:46.153

要搜索字符串，您必须下载页面源代码，然后使用字符串比较来找到您想要的。

# regex - Find -regex 比 find | 慢 grep

> ID：10431331
> 
> 赞同：2
> 
> 时间：2012-05-03T12:25:21.330
> 
> 标签：regex, bash, find, grep

我有一个使用正则表达式查找文件的脚本。代码如下：

```
find $dir | grep "$regex" 
```

该脚本运行速度有点慢，我想对其进行优化。搜索需要一些时间来执行，我想从中获得更好的性能。我试过这个尝试：

```
find $dir -regex ".*${regex}.*" 
```

我期待更快的结果，因为没有创建额外的过程来解析正则表达式。

然而结果不同，令我惊讶的是，命令“find | grep”比“find -regex”更快（尽管它需要更多的系统时间，正如人们所预料的那样）

我已经计时了这种行为：

查找 | grep 结果

```
real   0m12.467s
user   0m2.568s
sys    0m7.260s 
```

查找 -regex 结果

```
real   0m16.778s
user   0m6.772s
sys    0m6.380s 
```

您知道为什么 find -regex 解决方案较慢吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T15:41:42.310

很可能是因为`grep`它的正则表达式引擎多年来一直在高度优化，因为这是它的唯一目的（“做一件事并做好”）。我不知道 regex 引擎`find`使用什么，但它显然没有 's 那样高度精炼`grep`，可能是因为它是一个不太常用的辅助功能。

此外，如果您正在使用此文件列表执行任何操作，则应该使用更安全的空白方式来执行此操作。我认为`grep`不能接受以空值分隔的输入（尽管它可以输出），因此`find [...] -regex [...] -print0`即使速度较慢，您也应该使用。

# java - 从 tomcat6 到 jboss5 的远程 ejb 调用导致：无法取消引用对象异常

> ID：10431335
> 
> 赞同：0
> 
> 时间：2012-05-03T12:25:35.813
> 
> 标签：java, jakarta-ee, tomcat, jboss, ejb

我正在使用 Jboss5.1、Tomcat 6、Ejb3.0

我试图从Tomcat6 servlet对部署在Jboss5.1上的远程无状态bean进行简单的Ejb远程调用。

我将所有必需的 jar 添加到 tomcat lib 目录中。仍然经过大量的努力，我在尝试查找时遇到了这个错误

那是个例外：

```
javax.naming.NamingException: Could not dereference object [Root exception is java.lang.reflect.UndeclaredThrowableException]
      at org.jnp.interfaces.NamingContext.getObjectInstanceWrapFailure(NamingContext.java:1504)
      at org.jnp.interfaces.NamingContext.lookup(NamingContext.java:803)
      at org.jnp.interfaces.NamingContext.lookup(NamingContext.java:686)
      at javax.naming.InitialContext.lookup(InitialContext.java:392)
      at com.MomSetUp.setUp(MomSetUp.java:46)
      at org.apache.jsp.test.test_jsp._jspService(test_jsp.java:58)
      at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
      at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
      at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:388)
      at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
      at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
      at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
      at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
      at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
      at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
      at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
      at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
      at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
      at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
      at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
      at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
      at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
      at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
      at java.lang.Thread.run(Thread.java:619)
Caused by: java.lang.reflect.UndeclaredThrowableException
      at $Proxy0.createProxyBusiness(Unknown Source)
      at org.jboss.ejb3.proxy.impl.objectfactory.session.SessionProxyObjectFactory.createProxy(SessionProxyObjectFactory.java:129)
      at org.jboss.ejb3.proxy.impl.objectfactory.session.stateless.StatelessSessionProxyObjectFactory.getProxy(StatelessSessionProxyObjectFactory.java:79)
      at org.jboss.ejb3.proxy.impl.objectfactory.ProxyObjectFactory.getObjectInstance(ProxyObjectFactory.java:158)
      at javax.naming.spi.NamingManager.getObjectInstance(NamingManager.java:304)
      at org.jnp.interfaces.NamingContext.getObjectInstance(NamingContext.java:1479)
      at org.jnp.interfaces.NamingContext.getObjectInstanceWrapFailure(NamingContext.java:1496)
      ... 23 more
Caused by: java.lang.reflect.InvocationTargetException
      at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
      at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
      at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
      at java.lang.reflect.Method.invoke(Method.java:597)
      at org.jboss.remoting.InvokerRegistry.loadClientInvoker(InvokerRegistry.java:453)
      at org.jboss.remoting.InvokerRegistry.createClientInvoker(InvokerRegistry.java:352)
      at org.jboss.remoting.Client.connect(Client.java:512)
      at org.jboss.aspects.remoting.InvokeRemoteInterceptor.invoke(InvokeRemoteInterceptor.java:59)
      at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
      at org.jboss.ejb3.proxy.impl.remoting.IsLocalProxyFactoryInterceptor.invoke(IsLocalProxyFactoryInterceptor.java:72)
      at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
      at org.jboss.aspects.remoting.PojiProxy.invoke(PojiProxy.java:62)
      ... 30 more
Caused by: java.lang.NoSuchMethodError: org.jboss.util.propertyeditor.PropertyEditors.mapJavaBeanProperties(Ljava/lang/Object;Ljava/util/Properties;Z)V
      at org.jboss.remoting.transport.socket.MicroSocketClientInvoker.mapJavaBeanProperties(MicroSocketClientInvoker.java:1280)
      at org.jboss.remoting.transport.socket.MicroSocketClientInvoker.setup(MicroSocketClientInvoker.java:496)
      at org.jboss.remoting.transport.socket.MicroSocketClientInvoker.<init>(MicroSocketClientInvoker.java:275)
      at org.jboss.remoting.transport.socket.SocketClientInvoker.<init>(SocketClientInvoker.java:78)
      at org.jboss.remoting.transport.socket.TransportClientFactory.createClientInvoker(TransportClientFactory.java:39)
      at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
      at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
      at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
      at java.lang.reflect.Method.invoke(Method.java:597)
      at org.jboss.remoting.InvokerRegistry.loadClientInvoker(InvokerRegistry.java:453)
      at org.jboss.remoting.InvokerRegistry.createClientInvoker(InvokerRegistry.java:352)
      at org.jboss.remoting.Client.connect(Client.java:512)
      at org.jboss.aspects.remoting.InvokeRemoteInterceptor.invoke(InvokeRemoteInterceptor.java:59)
      at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
      at org.jboss.ejb3.proxy.impl.remoting.IsLocalProxyFactoryInterceptor.invoke(IsLocalProxyFactoryInterceptor.java:72)
      at org.jboss.aop.joinpoint.MethodInvocation.invokeNext(MethodInvocation.java:102)
      at org.jboss.aspects.remoting.PojiProxy.invoke(PojiProxy.java:62)
      at $Proxy0.createProxyBusiness(Unknown Source)
      at org.jboss.ejb3.proxy.impl.objectfactory.session.SessionProxyObjectFactory.createProxy(SessionProxyObjectFactory.java:129)
      at org.jboss.ejb3.proxy.impl.objectfactory.session.stateless.StatelessSessionProxyObjectFactory.getProxy(StatelessSessionProxyObjectFactory.java:79)
      at org.jboss.ejb3.proxy.impl.objectfactory.ProxyObjectFactory.getObjectInstance(ProxyObjectFactory.java:158)
      at javax.naming.spi.NamingManager.getObjectInstance(NamingManager.java:304)
      at org.jnp.interfaces.NamingContext.getObjectInstance(NamingContext.java:1479)
      at org.jnp.interfaces.NamingContext.getObjectInstanceWrapFailure(NamingContext.java:1496)
      at org.jnp.interfaces.NamingContext.lookup(NamingContext.java:803)
      at org.jnp.interfaces.NamingContext.lookup(NamingContext.java:686)
      at javax.naming.InitialContext.lookup(InitialContext.java:392)
      at com.MomSetUp.setUp(MomSetUp.java:46)
      at org.apache.jsp.test.test_jsp._jspService(test_jsp.java:58)
      at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
      at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
      at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:388)
      at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
      at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)
      at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
      at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
      at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
      at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
      at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
      at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
      at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
      at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
      at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
      at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
      at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
      at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
      at java.lang.Thread.run(Thread.java:619)
      at org.jboss.aspects.remoting.InvokeRemoteInterceptor.invoke(InvokeRemoteInterceptor.java:72) 
```

这是我的tomcat客户端：

```
 public void setUp() throws Exception {
                try {

                      Properties p = new Properties();
                      p.put(Context.INITIAL_CONTEXT_FACTORY,
                                  "org.jnp.interfaces.NamingContextFactory");
                      p.put(Context.URL_PKG_PREFIXES, "jboss.naming:org.jnp.interfaces");

                      p.put(Context.PROVIDER_URL, "192.168.200.32:1099"); // if not using

                      InitialContext context = new InitialContext(p);

                      // String lookupStr = "Mom/DispactherBeanRemote/remote";
                      String lookupStr = "DispactherBean/remote";
                      //System.out.println("lookup =" + context.lookup(lookupStr));

                      DispactherBeanRemote dispactherBean = (DispactherBeanRemote) context
                                  .lookup(lookupStr);
                      // Object dispactherBean = context.lookup(lookupStr);

                      System.out.println("dispactherBean ="
                                  + dispactherBean.getClass().getCanonicalName());

                } catch (Exception e) {
                      e.printStackTrace();

          } 
```

这是我的 ejb 无状态 bean，它的接口：

```
Stateless
@Remote(
{ DispactherBeanRemote.class })
@RemoteBinding(jndiBinding = "DispactherBean")
public class DispactherBean implements DispactherBeanRemote, Serializable
{
...
}

@Remote
public interface DispactherBeanRemote
{

    public MomDispatcherResponseMsgDTO dispatchMsg(MomDispatcherRequestMsgDTO momMessageRequestDTO);

} 
```

谢谢，雷。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-06T12:52:01.990

需要将 ejb3 jar 添加到项目中才能解析对象。

# jira - 是否可以通过 REST API 在 JIRA 4.4 中创建问题？

> ID：10431337
> 
> 赞同：2
> 
> 时间：2012-05-03T12:25:40.003
> 
> 标签：jira

我试图了解是否可以通过 REST API 在 JIRA 4.4 中创建问题。我正在启动本地 JIRA 4.4 服务器，并尝试通过通过休息客户端**链接发送 json 来创建问题：http://localhost:9090/rest/api/2/issue/**但它会响应下一个数据

```
Status Code: 404 Not Found
Server: Apache-Coyote/1.1
X-AREQUESTID: 972x1063x1
X-ASESSIONID: 1qhj5t4
X-Seraph-LoginReason: OK
X-AUSERNAME: admin
Content-Type: text/html;charset=utf-8
Content-Length: 1006
Date: Thu, 03 May 2012 12:12:32 GMT 
```

并使用下一个 json

```
{
    "fields": {
       "project":
       { 
          "key": "TEST"
       },
       "summary": "REST ye merry gentlemen.",
       "description": "Creating of an issue using project keys and issue type names using the REST API",
       "issuetype": {
          "name": "Bug"
       }}} 
```

我根据 JIRA [doc](https://developer.atlassian.com/display/JIRADEV/JIRA+REST+API+Example+-+Create+Issue)执行此操作。
我很困惑我做错了什么，也许有人熟悉这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T14:03:04.150

这个问题解决了。json发生语法错误的主要原因。

# c# - 具有 RAW 类型的 Oracle 参数化查询

> ID：10431341
> 
> 赞同：2
> 
> 时间：2012-05-03T12:25:51.490
> 
> 标签：c#, oracle10g

当我尝试完成对 Oracle RAW 类型的查询时，从我的 Oracle 10g 数据库获取值时遇到问题。myrawhash 最初是一个字符串。也许我没有正确转换它。

```
cmd = new OracleCommand();
cmd.CommandText = "SELECT * FROM mytable where HASH = :myrawhash";
cmd.Connection = oconn;

OracleParameter p_md5hash = new OracleParameter(":myrawhash", OracleType.Raw, 32);
// I suspect the line below is incorrect:                            
p_md5hash.Value = System.Text.Encoding.ASCII.GetBytes(myrawhash);  
cmd.Parameters.Add(p_md5hash);
OracleDataReader dr = cmd.ExecuteReader();
dr.Read(); 
```

错误我从异常中得到：
** 行或列不存在数据。

我知道这存在于数据库中。想法？

# android - Facebook Direct Url 在某人的墙上发布消息

> ID：10431346
> 
> 赞同：0
> 
> 时间：2012-05-03T12:26:04.020
> 
> 标签：android, html, ios, facebook, url

我正在开发一个 iOS 应用程序，该应用程序必须发布在某人的 Facebook 墙上消息上。当用户安装 Facebook 应用程序时，我找到了 url 方案。（网址就像 fb://publish/profile/{fbid}?text={message} 我想在浏览器中找到一个直接发布在某人墙上的网址。谢谢 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T13:08:34.940

如果我理解正确，您应该使用 Dialog API 将状态消息发布到某人的提要（https://www.facebook.com/dialog/feed?app_id=123050457758183&redirect_uri=http%3A%2F%2Fwww.example。 com%2Fresponse&display=touch)。

对话框 API 文档：[https ://developers.facebook.com/docs/reference/dialogs/](https://developers.facebook.com/docs/reference/dialogs/)

# sql - SQL Server：ORDER BY 变量列 CASE 语句与 NULL 值

> ID：10431352
> 
> 赞同：4
> 
> 时间：2012-05-03T12:26:33.593
> 
> 标签：sql, sql-server, sql-server-2008, tsql, sql-order-by

我有一个查询可以输出按各种列排序的结果，但我需要能够处理排序列中的空值。任何帮助将不胜感激。这是一个例子：

```
Table [People]
Columns [Name], [Birthday] (NULLABLE) 
```

Query where`@Sort`是一个 int 指定要对哪一列进行排序，`@pageStart`and`@pageEnd`是 int 告诉查询要返回哪些结果。（我只返回行的选择，所以我使用`[RowNum]`嵌套在 CTE 中的列。还有其他处理发生，但为简单起见，我将其删除。）：

```
;with results as(
SELECT [Name], [Birthday], ROW_NUMBER() OVER  (ORDER BY 
         CASE WHEN @Sort = 0 THEN [Name] END,
         CASE WHEN @Sort = 2 THEN [Birthday] END,
         CASE WHEN @Sort = 1 THEN [Name] END DESC,
         CASE WHEN @Sort = 3 THEN [Birthday] END DESC) AS RowNum
FROM [People]
)
SELECT [Name], [Birthday]
FROM results
WHERE RowNum BETWEEN @pageStart AND @pageEnd
--ORDER RowNum
--The last order by doesn't seem to be needed 
```

我知道可以使用以下语句处理空值：

```
ORDER BY (CASE WHEN [columnName] is NULL THEN 1 ELSE 0 END), [columnName] 
```

我很难将其应用于我正在使用的查询......任何帮助将不胜感激！让我知道我是否可以澄清任何事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:36:08.177

好像你大部分时间都在那里。而不是一个`CASE...WHEN...END`声明，你可以改为使用`ISNULL()`

您需要从同一数据类型中选择相关值，但`@Sort = 0`例如您可以使用

```
CASE WHEN @Sort = 0 THEN ISNULL([Name], '') END, 
```

看起来你可以将你的`CASE...WHEN...END`语句序列压缩成一个更像

```
CASE @Sort
    WHEN 0 THEN ISNULL([Name], '')
    WHEN 2 THEN ISNULL([Birthday], 0)
...
...
END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:36:12.950

您可以将排序参数与`CASE`表达式中的空检查结合起来：

```
;with results as(
SELECT [Name], [Birthday], ROW_NUMBER() OVER  (ORDER BY 
       CASE WHEN @Sort = 0 AND [Name] IS NULL THEN 1 ELSE 0 END, [Name],
       CASE WHEN @Sort = 2 AND [Birthday] IS NULL THEN 1 ELSE 0 END, [Birthday],
       CASE WHEN @Sort = 1 AND [Name] IS NULL THEN 1 ELSE 0 END, [Name] DESC,
       CASE WHEN @Sort = 3 AND [Birthday] IS NULL THEN 1 ELSE 0 END, [Birthday] DESC)As RowNum
FROM [People]
)
SELECT [Name], [Birthday]
FROM results
WHERE RowNum BETWEEN @pageStart AND @pageEnd 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:41:27.267

您的查询在代码重用方面很好。不幸的是，它在可优化性方面也很差。 *（这甚至是一个真实的词吗？）*

对于这个*单一*的查询，优化器需要建立一个*单一*的执行计划。例如，它不能在排序的不同索引之间切换。相反，随着参数的变化，它必须“手动”重新排序数据。

这在分页中尤其重要。使用合适的索引，优化器可以使用范围搜索直接跳转到您需要的行。在您的单个查询的情况下，效果将是实际处理整个表，适当地排序，然后跳转到适当的记录。 *（有一个适合所有参数的计划的结果。）* 对于任何大量的数据，这是一个非常*大*的开销。

出于这个原因，使用动态 SQL 来处理这个问题实际上通常会更高效。这允许每个不同的排序都有自己的执行计划。然后每个计划案例都使用最适合这些需求的索引。

# jquery - 如何在 HTML 中创建一个简单的微调器？或 jQuery

> ID：10431358
> 
> 赞同：2
> 
> 时间：2012-05-03T12:26:49.303
> 
> 标签：jquery, html, jquery-ui

是否可以在 HTML 中创建微调器？只有HTML？可能是标签？

我的 HTML：

```
<label for="time">Tempo:</label>
<input type="text" name="time" id="time" value="" style="width: 150px;" /> 
```

如果不能，我们可以使用一些 jquery 吗？像“datepicker”这样的东西

```
$("#time").spinner({ options }); 
```

事情真的很简单：D

我找到了这个，但我不明白如何使用它。

[http://docs.jquery.com/UI/Spinner/spinner](http://docs.jquery.com/UI/Spinner/spinner)

**编辑：**

如果我使用这个：

```
<label for="time">Tempo:</label>
<input type="number" name="time" id="time" value="0" style="width: 150px;" /> 
```

（区别在于输入类型）

Chrome 会自动创建微调器 (+1/-1)，但 Firefox 不会发生同样的情况（并且未在 IE 上测试）

为什么人们仍然使用其他浏览器？！:D

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T13:17:18.597

[http://github.com/fgnass/spin.js](http://github.com/fgnass/spin.js)

*   没有图片
*   没有外部 CSS
*   无依赖
*   高度可配置
*   独立于分辨率
*   在旧 IE 中使用 VML 作为后备
*   使用@keyframe 动画，回退到 setTimeout()
*   适用于所有主流浏览器，包括 IE6
*   占用空间小（压缩后约 1.9K）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-06-15T16:52:09.110

微调框的 HTML 代码如下所示：

```
<input type="number" min="0" max="50" step="2" value="0" size="6" name="cantitate"> 
```

类型是“数字”。MIN 和 MAX 是您想要的值的开始值和结束值。STEP 属性是单击箭头时值的增加或减少。VALUE 是页面加载时出现在框中的默认值，也是发送表单时返回的值。SIZE 是指你想要的盒子有多宽。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T12:34:07.557

[https://github.com/btburnett3/jquery.ui.spinner](https://github.com/btburnett3/jquery.ui.spinner)

**使用各自的标签加载 css 和 javascript**

```
<script type="text/javascript" src="js/jSpinner/ui.spinner.js"></script>
.
.
.
<link rel="stylesheet" type="text/css" href="css/jSpinner/ui.spinner.css" />

.
$("#time").spinner({
    min : 0,
    max : 100,
    showOn : 'both'
}); 
```

PS：请在加载 ui.spinner.js 之前加载 jquery 和 jquery.ui 插件

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-07-02T23:29:49.257

您可以使用即将发布的 jQuery UI 1.9 中的[微调器](http://wiki.jqueryui.com/w/page/12138077/Spinner)，尽管您必须对使用 beta 中的库感到满意。[这是一个演示](http://view.jqueryui.com/master/demos/index.html#spinner)。

Chrome (8) 和 Opera (11)[都使用](http://www.coreservlets.com/html5-tutorial/input-types.html#number-supported)原生的 HTML5 微调器，但它是丑陋的 IMO。

# c# - ffmpeg c# asp.net视频转换错误

> ID：10431361
> 
> 赞同：0
> 
> 时间：2012-05-03T12:27:00.160
> 
> 标签：c#, asp.net, video, ffmpeg

以下代码将错误显示为“StandardOut 尚未重定向或进程尚未启动”。这段代码有什么问题？它需要任何改变吗？它总是通过捕获异常来清除进程。

```
static void ExecuteAsync()
            {
                if (File.Exists("Videos/output.flv"))
                try
                {
                    File.Delete("Videos/output.flv");
                }
                catch
                {
                    return;
                }

            try
            {
                process = new Process();
                ProcessStartInfo info = new ProcessStartInfo(@"e:\ffmpeg\bin\ffmpeg.exe", "-i cars1.flv -same_quant intermediate1.mpg");
                info.CreateNoWindow = false;
                info.UseShellExecute = false;
                info.RedirectStandardError = true;
                info.RedirectStandardOutput = true;
                process.StartInfo = info;
                process.EnableRaisingEvents = true;
                process.ErrorDataReceived += new DataReceivedEventHandler(process_ErrorDataReceived);
                process.OutputDataReceived += new DataReceivedEventHandler(process_OutputDataReceived);
                process.Exited += new EventHandler(process_Exited);
                process.Start();
                process.BeginOutputReadLine();
                process.BeginErrorReadLine();
            }
            catch (Exception ex)
            {
                if (process != null) process.Dispose();
            }
        }
        static int lineCount = 0;
        static void process_ErrorDataReceived(object sender, DataReceivedEventArgs e)
        {
            Console.WriteLine("Input line: {0} ({1:m:s:fff})", lineCount++, DateTime.Now);
            Console.WriteLine(e.Data);
            Console.WriteLine();
        }

        static void process_OutputDataReceived(object sender, DataReceivedEventArgs e)
        {
            Console.WriteLine("Output Data Received.");
        }

        static void process_Exited(object sender, EventArgs e)
        {
            process.Dispose();
            Console.WriteLine("Bye bye!");
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T13:01:27.480

将此设置为false：

```
info.RedirectStandardOutput = false; 
```

文档说：

> 要使用 StandardOutput，必须将 ProcessStartInfo..::.UseShellExecute 设置为 false，并且必须将 ProcessStartInfo..::.RedirectStandardOutput 设置为 true。否则，从 StandardOutput 流中读取会引发异常

# android - 为 Google Play 设置应用图标？

> ID：10431364
> 
> 赞同：0
> 
> 时间：2012-05-03T12:27:18.740
> 
> 标签：android, icons, apk, google-play

嗨，我目前正在尝试将蛇游戏上传到 Google Play 市场，但我不断收到错误消息`The icon path specified by the manifest is not in the apk`。

我没有使用 appcreator，我使用 eclipse 来编辑和签名/导出 apk。以下是清单的相关部分，但如果您需要查看更多信息，请告诉我。我在 res/drawable 文件夹中有一个 icon.png。有人可以告诉我我做错了什么吗？

```
 <application android:label="Crazy Snake">      
      <activity android:icon="@drawable/icon"
          android:name="Snake"
          android:theme="@android:style/Theme.NoTitleBar"
          android:screenOrientation="portrait"
          android:configChanges="keyboardHidden|orientation">
          <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
          </intent-filter>
      </activity>
      <receiver android:name="com.Leadbolt.AdNotification" /> 
      <receiver android:name="com.example.android.snake.BootReceiver"> 
          <intent-filter> 
              <action android:name="android.intent.action.BOOT_COMPLETED" /> 
          </intent-filter> 
      </receiver>
</application> 
```

编辑：顺便说一句，模拟器和手机上的图标都很好......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:32:51.170

放：

```
android:icon="@drawable/icon" 
```

这里：

```
<application android:label="Crazy Snake"
android:icon="@drawable/icon" > 
...
</application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T10:34:04.090

将 android:icon="@drawable/icon" 放在应用程序标签内。

如果还有其他应用程序标签，您还需要放置 android:icon="@drawable/icon"

查找清单中的空应用程序标签，如果您发现它们，请删除它们。

# javascript - 带有颜色框的 iframe 不起作用

> ID：10431368
> 
> 赞同：0
> 
> 时间：2012-05-03T12:27:32.290
> 
> 标签：javascript, jquery, html, colorbox

我的头部分是

```
<head><title></title>
<link href="css/style-custom.php.css" rel="stylesheet" type="text/css" />
<link href="css/style.css" rel="stylesheet" type="text/css" />
<link href="css/layout-responsive.css" rel="stylesheet" type="text/css" />
<link href="css/skeleton-responsive.css" rel="stylesheet" type="text/css" />

<script src="js/jquery.js" type="text/javascript"></script>

<link href="css/superfish.css" rel="stylesheet" type="text/css" />
<link href="css/flexslider.css" rel="stylesheet" type="text/css" />

<script type="text/javascript" src="js/jquery.flexslider.js?ver=1.0"></script>
<script src="js/jquery.min.js" type="text/javascript"></script>

<link href="css/colorbox.css" rel="stylesheet" type="text/css" />

<script src="js/colorbox/jquery.colorbox.js" type="text/javascript"></script>

<script type="text/javascript">

$(document).ready(function () {    
    //Examples of how to assign the ColorBox event to elements    
    $(".iframe").colorbox({ iframe: true, width: "45%", height: "50%" });
});

</script>     
</head> 
```

并且打开 iframe 的链接在这里....最初它可以工作，但在添加母版页后它停止工作...请为我提供解决方案。

```
<a href="ForgotPassword.aspx" class="iframe" style="padding-left: 20px;">Forgot Password</a> 
```

* * *

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T23:46:23.353

检查您的开发者控制台是否有错误。而且您可能并不意味着要加载 jQuery 两次（未缩小版和缩小版）。

# java - 如何以相同的长度显示JTree中的所有String elementName？

> ID：10431372
> 
> 赞同：1
> 
> 时间：2012-05-03T12:27:45.527
> 
> 标签：java, swing, jtree, cellrenderer

我创建了一个显示文件列表的 JTree。这些文件的长度不同。我想在 JTree 中以相同的长度显示它们，例如 20 个字符。如果名称大于 20 个字符，它应该出现在工具提示中。

**我怎么能意识到它？** 下面是我的 cellRenderer。

```
 private static class FileTreeCellRenderer extends DefaultTreeCellRenderer {
    private Map<String, Icon> iconCache = new HashMap<String, Icon>();
    private Map<File, String> rootNameCache = new HashMap<File, String>();

    @Override
    public Component getTreeCellRendererComponent(JTree tree, Object value,
                                                  boolean sel, boolean expanded, boolean leaf, int row,
                                                  boolean hasFocus) {

        FileTreeNode ftn = (FileTreeNode) value;
        File file = ftn.file;
        String filename = "";
        if (file != null) {
            if (ftn.isFileSystemRoot) {
                filename = this.rootNameCache.get(file);
                if (filename == null) {
                    filename = fsv.getSystemDisplayName(file);
                    this.rootNameCache.put(file, filename);
                }
            } else {
                filename = file.getName();
            }
        }
        JLabel result = (JLabel) super.getTreeCellRendererComponent(tree,
                filename, sel, expanded, leaf, row, hasFocus);
        if (sel)
            this.setFont(getFont().deriveFont(Font.BOLD));
        else
            this.setFont(getFont().deriveFont(Font.PLAIN));
        if (file != null) {
            Icon icon = this.iconCache.get(filename);
            if (icon == null) {
                icon = fsv.getSystemIcon(file);
                this.iconCache.put(filename, icon);
            }
            result.setIcon(icon);
        }
        return result;
    }

    @Override
    public Dimension getPreferredSize() {
        Dimension dim = super.getPreferredSize();
        FontMetrics fm = getFontMetrics(getFont());
        char[] chars = getText().toCharArray();

        int w = getIconTextGap() + 40;
        for (char ch : chars)  {
            w += fm.charWidth(ch);
        }
        w += getText().length();
        dim.width = w;
        return dim;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T12:37:25.153

您可以调整标签上的文本以限制大小，例如

```
JLabel result = (JLabel) super.getTreeCellRendererComponent(tree,
                filename, sel, expanded, leaf, row, hasFocus);
result.setText( fileName.subString( 0, Math.min( 20, fileName.length() ) );
result.setTooltip( fileName ); 
```

笔记：

`getPreferredSize`您无缘无故地覆盖了，因为渲染器是一个组件这一事实并未在您的代码中使用。`getTreeCellRendererComponent`您在方法中返回一个标签

# ruby-on-rails - Rails 3.2 GNTP不发送通知

> ID：10431374
> 
> 赞同：3
> 
> 时间：2012-05-03T12:27:53.057
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rubygems, guard

我正在使用 Rails 3.2.2 并尝试使用`ruby_gntp`gem 从 Guard 发送 Growl 通知。

我在 Snow Lepoard 上，所以使用 Growl 1.2.2。

这是我的宝石文件。

```
source 'https://rubygems.org'

gem 'rails', '3.2.2'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'sqlite3'

group :assets do
  gem 'coffee-rails'
  gem 'uglifier'
end

gem 'jquery-rails'

group :development, :test do
  gem 'capybara'
  gem 'rspec-rails'
  gem 'guard-rspec'
  gem 'rb-fsevent'
  gem 'ruby_gntp'
end

# Gems used only for assets and not required
# in production environments by default.
# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# Use unicorn as the web server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'ruby-debug19', :require => 'ruby-debug' 
```

当我使用`bundle exec guard`命令运行 Guard 时。我收到以下...

```
Running all specs
No examples found.

Finished in 0.00005 seconds
0 examples, 0 failures
ERROR: Error sending notification with gntp: Connection refused - connect(2) 
```

我做了一些研究并读到这可能是我安装的以前的咆哮宝石的版本错误。我已经删除了这些宝石，但仍然收到错误消息。

编辑：让它工作:) 只需更改我`ruby_gntp`的`growl`gem文件中的gem。

我的 gemfile 现在读取..

来源“https://rubygems.org”

```
gem 'rails', '3.2.2'

# Bundle edge Rails instead:
# gem 'rails', :git => 'git://github.com/rails/rails.git'

gem 'sqlite3'

group :assets do
  gem 'coffee-rails'
  gem 'uglifier'
end

gem 'jquery-rails'

group :development, :test do
  gem 'capybara'
  gem 'rspec-rails'
  gem 'guard-rspec'
  gem 'rb-fsevent'
  gem "growl", :git => "https://github.com/visionmedia/growl.git"
end

# Gems used only for assets and not required
# in production environments by default.
# To use ActiveModel has_secure_password
# gem 'bcrypt-ruby', '~> 3.0.0'

# Use unicorn as the web server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
# gem 'ruby-debug19', :require => 'ruby-debug' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T22:09:42.333

[Guard README 解释](https://github.com/guard/guard#ruby-gntp)说 Ruby GNTP 至少需要 1.3 版的 Growl 。我建议安装适用于所有 Growl 版本的[Growl](https://github.com/guard/guard#growl)通知程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T10:42:18.913

我在 OS X 10.8 上遇到了完全相同的错误。在 Mac OS X 10.8 + 上，通过 Grows 的通知与 gemfile 中的此类 gem 一起工作：

```
group :development, :test do
  gem 'rb-fsevent'
  gem 'guard-rspec'                                                                       
  gem 'ruby_gntp'
end 
```

别忘了打开 Growl。

我也建议使用 gem `terminal-notifier-guard`。它通过 Mac 通知中心提供通知。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-07T00:28:47.293

通过 Mac App Store 更新 Growl 后，我遇到了同样的错误。

`Extras/growlnotify/growlnotify.pkg`我通过在 Growl 的[1.2.2](http://growl.googlecode.com/files/Growl-1.2.2.dmg)中重新安装 growlnotify 解决了这个问题。[磁盘映像（在](http://growl.googlecode.com/files/Growl-1.2.2.dmg)[下载页面](http://growl.info/downloads)上列出）。

# installation - 将 JDK、环境变量设置、tomcat、mysql 和应用程序 war 文件捆绑到安装程序

> ID：10431380
> 
> 赞同：1
> 
> 时间：2012-05-03T12:28:15.370
> 
> 标签：installation, desktop-application

我开发了一个使用 tomcat 和 mysql 的应用程序。

现在我的问题是：是否可以将 JDK、环境变量设置、tomcat、mysql 和应用程序 war 文件捆绑到安装程序中，以便我可以作为桌面产品跨多个操作系统发布？

提前致谢。-拉坦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T07:21:58.303

是的，有可能。

首先，您需要决定一个设置创作工具：[http ://en.wikipedia.org/wiki/List_of_installation_software](http://en.wikipedia.org/wiki/List_of_installation_software)

例如，Advanced Installer 有一个专门用于 Tomcat 应用程序的项目类型。之后，您可以尝试创建所需的包。如果遇到问题，您可以提出更具体的问题。

# javascript - 在多个下拉列表中获得点击选项

> ID：10431381
> 
> 赞同：9
> 
> 时间：2012-05-03T12:28:15.657
> 
> 标签：javascript, jquery, jquery-selectors

我有一个多选下拉菜单，例如：

```
<select id="myList" multiple="multiple">  
    <option value="1">Opt #1</option>
    <option value="2" selected="selected">Opt #2</option>
    <option value="3" selected="selected">Opt #3</option>
    <option value="4">Opt #4</option>
</select> 
```

如果我然后选择`Opt #4`，那么我如何只得到`Opt #4`而不是`Opt #2`和`Opt #3`？我知道我可以通过以下方式获得所有选定的选项：

```
var selectedOptions = $("#myList option:selected"); 
```

但是我只想要我点击的选项 - `Opt #4`。这可能吗？

编辑：请注意，当我在事件中操作列表时，`change`我无法在`click`事件中执行此操作。还添加了缺少的多个。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-03T12:32:34.763

您可以在每个选项元素的单击处理程序中获取它：

```
$("#myList option").click(function() {
    var clickedOption = $(this);
}); 
```

* * *

**更新**

> 编辑：当我在更改事件中操作列表时，我无法在单击事件中执行此操作。

在这种情况下，您需要使用`on`. 试试这个：

```
$("#myList").on("click", "option", function() {
    var clickedOption = $(this);
}); 
```

然而，需要注意的一点是，`option`元素在 IE 中根本不会引发`click`事件，因此上述任何一个都不会在该浏览器中工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:32:30.413

如您所知，如果用户在未按下 Cntrl 键的情况下单击选项 #4，那么您只会将选项 #4 作为选定选项。

如果用户在按下 Cntrl 键的情况下单击选项 #4，则将选择所有三个选项。所以所有三个选项都将返回。如果您只想要 Opt#4，那么您需要添加一个单击事件处理程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T12:33:23.237

以下内容对您有帮助吗？

```
$('#myList').delegate('option', 'click', function (opt) {
  alert('Option ' + opt.value + ' was clicked');
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-21T00:53:58.980

真正的答案：

```
select.onclick = function(e) {
  console.log(e.target.value);
}; 
```

# mysql - magento 使用属性值选择 SKU

> ID：10431385
> 
> 赞同：-3
> 
> 时间：2012-05-03T12:28:28.863
> 
> 标签：mysql, magento

![在此处输入图像描述](../Images/301b2a89df59dd84045dc2f856b6b048.png)

> 我需要选择 SKU，其中 partno = MEM1600-2U6D 和 brandname = Cisco 和 Condition = New

任何人都可以为此提供解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:51:43.677

```
$collection = Mage::getModel('目录/产品')
->getCollection()
->addAttributeToSelect('*')
->addFieldToFilter（数组（
    数组('属性'=>'partno','eq'=>'MEM1600-2U6D'),
))
->addFieldToFilter（数组（
    数组（'属性'=>'品牌'，'eq'=>'思科'），
))
->addFieldToFilter（数组（
    数组('属性'=>'条件','eq'=>'新'),
))

```

我不确定。此外，您可以尝试使用 UNION 来实现您的目标。

好吧，我会尝试这样的事情：

```
选择 sku
FROM catalog_product_entity
在哪里
entity_id in (
     SELECT entity_id from catalog_product_entity_varchar WHERE attribute_id = (SELECT attribute_id from eav_attribute WHERE name='Partno' LIMIT 1) AND value = 'MEM1600-2U6D'
     联盟
     SELECT entity_id from catalog_product_entity_varchar WHERE attribute_id = (SELECT attribute_id from eav_attribute WHERE name='brandname' LIMIT 1) AND value = 'Cisco'
     联盟
     SELECT entity_id from catalog_product_entity_varchar WHERE attribute_id = (SELECT attribute_id from eav_attribute WHERE name='Condition' LIMIT 1) AND value = 'new'
)

```

那么你可能

```
 GROUP by entity_id HAVING COUNT(*) = 3 
```

像这样的东西。这意味着如果我们有 3 个 entity_id 条目，这意味着它符合我们的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:36:19.813

条件列在哪里？

编辑：N/m，我刚看到。你不能用那个表设置来做到这一点。条件/品牌必须是单独的列或表，而不是值。在值列中使用 Condition 时，它有自己的 SKU，因此您有 2 个 SKU，一个用于产品，一个用于状态。

# iphone - Objective-C 宏重定义

> ID：10431395
> 
> 赞同：7
> 
> 时间：2012-05-03T12:28:52.157
> 
> 标签：iphone, objective-c, rest, macros, dns

我目前正在使用三台服务器（部署、live_testing 和本地）。我正在使用宏来定义一系列域位置：

```
#define __LIVE_TESTING // Here I chose what domain to use

#ifdef __PRODUCTION
#define DOMAIN @"http://192.168.10.228/rest/"
#define DOMAINCOMET @"http://192.168.10.228/"
#endif

#ifdef __LIVE_TESTING
#define DOMAIN @"http://192.168.10.229/rest/"
#define DOMAINCOMET @"http://192.168.10.229/"
#endif

... 
```

我遇到的问题是与重新定义 DOMAIN 和 DOMAINCOMET 有关的编译器问题。这些警告是否有解决方法？

在此先感谢克林顿

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-03T12:32:37.177

`#undef`是你的朋友：

```
#ifdef __LIVE_TESTING

    #if defined(DOMAIN) && defined(DOMAINCOMET)
        #undef DOMAIN
        #undef DOMAINCOMET
    #endif

    #define DOMAIN @"http://192.168.10.229/rest/"
    #define DOMAINCOMET @"http://192.168.10.229/"

#endif 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:49:33.010

如果您遇到重新定义错误，则必须多次定义宏。如果此代码是唯一定义`DOMAIN`并`DOMAINCOMET`定义的位置，则可能设置了两个控制标志。

如果两者`__PRODUCTION`和`__LIVE_TESTING`都定义为任何值，则可能发生这种情况 - 甚至为 0，因为您使用`#ifdef`的是查看它们是否已定义，而不是测试它们分配的实际值。

例如，甚至：

```
#define __PRODUCTION 0
#define __LIVE_TESTING 1 
```

将导致根据您的代码评估两个块，从而触发重新定义错误。

如果您希望两者互斥，则应检查它们的值，因此：

```
#if __PRODUCTION==1
#define DOMAIN @"http://192.168.10.228/rest/"
#define DOMAINCOMET @"http://192.168.10.228/"    
#elif __LIVE_TESTING==1
#define DOMAIN @"http://192.168.10.229/rest/"
#define DOMAINCOMET @"http://192.168.10.229/"
#endif 
```

# android - 删除在特定时间段内保存的外部和内部存储中的文件

> ID：10431397
> 
> 赞同：-3
> 
> 时间：2012-05-03T12:28:59.223
> 
> 标签：android, android-sdcard

我正在开发一个应用程序，我希望能够在一定时间内删除保存在内部和外部设备上的文件（例如，从 DateTime1 保存的文件从 DateTime2）。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:54:39.367

> 我不知道我们如何从存储中删除文件

使用标准 Java I/O。要删除一个`File`（无论是指向文件还是空目录），调用[`delete()`](http://developer.android.com/reference/java/io/File.html#delete%28%29). 请注意，对于外部存储，您需要持有该`WRITE_EXTERNAL_STORAGE`权限。

# c# - 使用最佳实践将 SQL 查询转换为 Lambda 查询

> ID：10431400
> 
> 赞同：0
> 
> 时间：2012-05-03T12:29:03.217
> 
> 标签：c#, lambda

我正在尝试将下面的 SQL 转录为 Lambda 表达式，并想知道如何最好地指示这种转换。

```
declare @codigoGrupo int
declare @nomeModelo varchar(20)

set @codigoGrupo = 8 -- null
set @nomeModelo = '%segundo%'

select g.dc_nome, m.dc_nome
from hlp.grupo_solicitacao g
     left join hlp.modelo_solicitacao m on g.codigo_grupo_solicitacao = m.codigo_grupo_solicitacao
     where 1=1
     and (g.codigo_grupo_solicitacao = @codigoGrupo or @codigoGrupo is null)
     and (m.dc_nome like @nomeModelo or @nomeModelo is null) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:41:35.367

我真的认为 lambda 表达式会很奇怪。这样做更容易，而且更干净：

```
int? codigoGrupo =8;
string nomeModelo="segundo";
var result= (
    from g in grupo_solicitacao
    from m in modelo_solicitacao
         .Where(a=>a.codigo_grupo_solicitacao=g.codigo_grupo_solicitacao)
        .DefaultIfEmpty()
    where 1==1
    && (g.codigo_grupo_solicitacao==codigoGrupo || !codigoGrupo.HasValue)
    && (m.dc_nome.Contains(nomeModelo) || nomeModelo==null)
    select new{g.dc_nome, m.dc_nome}
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:48:34.783

像这样的东西：

```
int? codigoGrupo = 8;
string nomeModelo = "segundo"

bool filterCodigoGrupo = codigoGrupo.HasValue;
bool filterNomeModelo = !String.IsNullOrEmpty( filterNomeModelo );

var list = context.grupo_solicitacao
  .Where( o =>
    ( 1 == 1 )
    &&
    ( !filterCodigoGrupo || o.codigo_grupo_solicitacao == codigoGrupo.Value )
    &&
    ( !filterNomeModelo || o.modelo_solicitacao.dc_nome.Contains( nomeModelo ) )
  )
  .Select( o => new { codigo = o.dc_nome, model = o.modelo_solicitacao.dc_nome } )
  .ToList(); 
```

# prolog - Prolog 帮助在追加时删除或跳过项目

> ID：10431402
> 
> 赞同：0
> 
> 时间：2012-05-03T12:29:04.753
> 
> 标签：prolog, artificial-intelligence, logic

如果它是列表的一部分，您如何跳过特定单词然后附加其余部分？通常此项目位于列表的开头，有时不是，我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:43:01.090

您的意思是删除列表中第一次出现的元素吗？您可以使用[selectchk/3](http://www.swi-prolog.org/pldoc/doc_for?object=selectchk/3)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T23:34:50.750

```
'如果它是列表的一部分，则跳过特定的单词，然后附加其余部分。通常此项目位于列表的开头，有时并非如此'(_item,_list,_rest) ：-
  追加（L1，[_item|L2]，_list），追加（L1，L2，_rest），！。

```

# r - 多个类别的 ifelse 风格重新编码的成语

> ID：10431403
> 
> 赞同：17
> 
> 时间：2012-05-03T12:29:07.097
> 
> 标签：r, r-factor, recode

我经常遇到这个问题，以至于我认为必须有一个好的成语。假设我有一个带有一堆属性的 data.frame，包括“产品”。我还有一把将产品转化为品牌+尺寸的钥匙。产品代码 1-3 是 Tylenol，4-6 是 Advil，7-9 是 Bayer，10-12 是 Generic。

编码这个的最快（就人类时间而言）方法是什么？

`ifelse`如果有 3 个或更少的类别，我倾向于使用 nested ，如果超过 3 个，我会输入数据表并将其合并。有更好的想法吗？Stata 有一个非常适合这类事情的[`recode`命令，尽管我认为它过度促进了数据代码混合。](http://www.stata.com/help.cgi?recode)

```
dat <- structure(list(product = c(11L, 11L, 9L, 9L, 6L, 1L, 11L, 5L, 
7L, 11L, 5L, 11L, 4L, 3L, 10L, 7L, 10L, 5L, 9L, 8L)), .Names = "product", row.names = c(NA, 
-20L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-03T13:19:39.420

您可以将变量转换为因子并通过`levels<-`函数更改其水平。在一个命令中，它可能像：

```
`levels<-`(
    factor(dat$product),
    list(Tylenol=1:3, Advil=4:6, Bayer=7:9, Generic=10:12)
) 
```

在步骤：

```
brands <- factor(dat$product)
levels(brands) <- list(Tylenol=1:3, Advil=4:6, Bayer=7:9, Generic=10:12) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-03T12:53:41.910

可以使用列表作为关联数组来定义`brand -> product code`映射，即：

```
brands <- list(Tylenol=1:3, Advil=4:6, Bayer=7:9, Generic=10:12) 
```

一旦你有了这个，你可以将其反转以创建一个`product code -> brand`列表（可能会占用大量内存），或者只使用搜索功能：

```
find.key <- function(x, li, default=NA) {
    ret <- rep.int(default, length(x))
    for (key in names(li)) {
        ret[x %in% li[[key]]] <- key
    }
    return(ret)
} 
```

我确信有更好的方法来编写这个函数（`for`循环让我很烦！），但至少它是矢量化的，所以它只需要一次遍历列表。

使用它会是这样的：

```
> dat$brand <- find.key(dat$product, brands)
> dat
   product   brand
1       11 Generic
2       11 Generic
3        9   Bayer
4        9   Bayer
5        6   Advil
6        1 Tylenol
7       11 Generic
8        5   Advil
9        7   Bayer
10      11 Generic
11       5   Advil
12      11 Generic
13       4   Advil
14       3 Tylenol
15      10 Generic
16       7   Bayer
17      10 Generic
18       5   Advil
19       9   Bayer
20       8   Bayer 
```

和解决方案非常好`recode`，`levels<-`但它们也比这个慢得多（一旦你有了`find.key`它，这对人类来说比`recode`和更容易`levels<-`）：

```
> microbenchmark(
     recode=recode(dat$product,recodes="1:3='Tylenol';4:6='Advil';7:9='Bayer';10:12='Generic'"), 
     find.key=find.key(dat$product, brands),
     levels=`levels<-`(factor(dat$product),brands))
Unit: microseconds
      expr      min        lq    median        uq      max
1 find.key   64.325   69.9815   76.8950   83.8445  221.748
2   levels  240.535  248.1470  274.7565  306.8490 1477.707
3   recode 1636.039 1683.4275 1730.8170 1855.8320 3095.938 
```

（我无法让该`switch`版本正确地进行基准测试，但它似乎比上述所有版本都快，尽管它对人类来说甚至比`recode`解决方案更糟糕。）

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-05-03T13:09:25.983

我喜欢包`recode`中的功能`car`：

```
library(car)

dat$brand <- recode(dat$product,
  recodes="1:3='Tylenol';4:6='Advil';7:9='Bayer';10:12='Generic'")

# > dat
#    product   brand
# 1       11 Generic
# 2       11 Generic
# 3        9   Bayer
# 4        9   Bayer
# 5        6   Advil
# 6        1 Tylenol
# 7       11 Generic
# 8        5   Advil
# 9        7   Bayer
# 10      11 Generic
# 11       5   Advil
# 12      11 Generic
# 13       4   Advil
# 14       3 Tylenol
# 15      10 Generic
# 16       7   Bayer
# 17      10 Generic
# 18       5   Advil
# 19       9   Bayer
# 20       8   Bayer 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-05-03T16:48:00.237

我经常使用以下技术：

```
key <- c()
key[1:3] <- "Tylenol"
key[4:6] <- "Advil"
key[7:9] <- "Bayer"
key[10:12] <- "Generic" 
```

然后，

```
> key[dat$product]
 [1] "Generic" "Generic" "Bayer"   "Bayer"   "Advil"   "Tylenol" "Generic" "Advil"   "Bayer"   "Generic"
[11] "Advil"   "Generic" "Advil"   "Tylenol" "Generic" "Bayer"   "Generic" "Advil"   "Bayer"   "Bayer" 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-05-04T01:00:58.063

“数据库方法”是为您的产品密钥定义保留一个单独的表（data.frame）。这更有意义，因为您说您的产品密钥不仅可以转化为品牌，还可以转化为尺寸：

```
product.keys <- read.table(textConnection("

product brand   size
1       Tylenol small
2       Tylenol medium
3       Tylenol large
4       Advil   small
5       Advil   medium
6       Advil   large
7       Bayer   small
8       Bayer   medium
9       Bayer   large
10      Generic small
11      Generic medium
12      Generic large

"), header = TRUE) 
```

然后，您可以使用以下方法加入您的数据`merge`：

```
merge(dat, product.keys, by = "product")
#    product   brand   size
# 1        1 Tylenol  small
# 2        3 Tylenol  large
# 3        4   Advil  small
# 4        5   Advil medium
# 5        5   Advil medium
# 6        5   Advil medium
# 7        6   Advil  large
# 8        7   Bayer  small
# 9        7   Bayer  small
# 10       8   Bayer medium
# 11       9   Bayer  large
# 12       9   Bayer  large
# 13       9   Bayer  large
# 14      10 Generic  small
# 15      10 Generic  small
# 16      11 Generic medium
# 17      11 Generic medium
# 18      11 Generic medium
# 19      11 Generic medium
# 20      11 Generic medium 
```

正如您所注意到的，行的顺序并没有被保留`merge`。如果这是一个问题，则该`plyr`包具有`join`保留顺序的功能：

```
library(plyr)
join(dat, product.keys, by = "product")
#    product   brand   size
# 1       11 Generic medium
# 2       11 Generic medium
# 3        9   Bayer  large
# 4        9   Bayer  large
# 5        6   Advil  large
# 6        1 Tylenol  small
# 7       11 Generic medium
# 8        5   Advil medium
# 9        7   Bayer  small
# 10      11 Generic medium
# 11       5   Advil medium
# 12      11 Generic medium
# 13       4   Advil  small
# 14       3 Tylenol  large
# 15      10 Generic  small
# 16       7   Bayer  small
# 17      10 Generic  small
# 18       5   Advil medium
# 19       9   Bayer  large
# 20       8   Bayer medium 
```

最后，如果您的表很大并且速度是一个问题，请考虑使用 data.tables（来自`data.table`包）而不是 data.frames。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-05-03T13:40:34.043

这需要一些打字，但如果你真的有一个庞大的数据集，这可能是要走的路。talkstats.com 的 Bryangoodrich 和 Dason 教了我这个。它使用哈希表或创建包含查找表的环境。实际上，我将这个保留在我的 .Rprofile（即哈希函数）上，用于字典类型查找。

我将您的数据复制了 1000 次以使其更大一些。

```
#################################################
# THE HASH FUNCTION (CREATES A ENW ENVIRONMENT) #
#################################################
hash <- function(x, type = "character") {
    e <- new.env(hash = TRUE, size = nrow(x), parent = emptyenv())
    char <- function(col) assign(col[1], as.character(col[2]), envir = e)
    num <- function(col) assign(col[1], as.numeric(col[2]), envir = e)
    FUN <- if(type=="character") char else num
    apply(x, 1, FUN)
    return(e)
}
###################################
# YOUR DATA REPLICATED 1000 TIMES #
###################################
dat <- dat <- structure(list(product = c(11L, 11L, 9L, 9L, 6L, 1L, 11L, 5L, 
    7L, 11L, 5L, 11L, 4L, 3L, 10L, 7L, 10L, 5L, 9L, 8L)), .Names = "product", row.names = c(NA, 
    -20L), class = "data.frame")
dat <- dat[rep(seq_len(nrow(dat)), 1000), , drop=FALSE]
rownames(dat) <-NULL
dat
#########################
# CREATE A LOOKUP TABLE #
#########################
med.lookup <- data.frame(val=as.character(1:12), 
    med=rep(c('Tylenol', 'Advil', 'Bayer', 'Generic'), each=3))  

########################################
# USE hash TO CREATE A ENW ENVIRONMENT #
########################################  
meds <- hash(med.lookup)  

##############################
# CREATE A RECODING FUNCTION #
##############################          
recoder <- function(x){
    x <- as.character(x) #turn the numbers to character
    rc <- function(x){
       if(exists(x, env = meds))get(x, e = meds) else NA 
    }  
    sapply(x, rc, USE.NAMES = FALSE) 
}
#############
# HASH AWAY #
#############
recoder(dat[, 1]) 
```

在这种情况下，散列很慢，但是如果您有更多级别要重新编码，那么它的速度会比其他级别提高。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-05-03T12:56:48.540

比嵌套`ifelse`的更具可读性：

```
unlist(lapply(as.character(dat$product), switch,
              `1`=,`2`=,`3`='tylenol',
              `4`=,`5`=,`6`='advil',
              `7`=,`8`=,`9`='bayer',
              `10`=,`11`=,`12`='generic')) 
```

警告：效率不高。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-09-05T19:35:07.420

我倾向于使用这个功能：

```
recoder <- function (x, from = c(), to = c()) {
  missing.levels <- unique(x)
  missing.levels <- missing.levels[!missing.levels %in% from]
  if (length(missing.levels) > 0) {
    from <- append(x = from, values = missing.levels)
    to <- append(x = to, values = missing.levels)
  }
  to[match(x, from)]
} 
```

如：

```
recoder(x = dat$product, from = 1:12, to = c(rep("Product1", 3), rep("Product2", 3), rep("Product3", 3), rep("Product4", 3))) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-09-05T16:51:08.433

如果您在示例中的顺序组中有代码，这可能`cut`是芥末：

```
cut(dat$product,seq(0,12,by=3),labels=c("Tylenol","Advil","Bayer","Generic"))
 [1] Generic Generic Bayer   Bayer   Advil   Tylenol Generic Advil   Bayer  
[10] Generic Advil   Generic Advil   Tylenol Generic Bayer   Generic Advil  
[19] Bayer   Bayer  
Levels: Tylenol Advil Bayer Generic 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-08-18T10:25:23.097

还有`arules:discretize`，但我不喜欢它，因为它使您可以将标签与值范围分开：

```
library(arules)
discretize( dat$product, method = "fixed", categories = c( 1,3,6,9,12 ), labels = c("Tylenol","Advil","Bayer","Generic") )

[1] Generic Generic Generic Generic Bayer   Tylenol Generic Advil   Bayer   Generic Advil   Generic Advil   Advil   Generic Bayer   Generic Advil   Generic Bayer  
Levels: Tylenol Advil Bayer Generic 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-08-12T13:10:59.983

为了完整性（可能是最快和最简单的解决方案），可以创建并命名向量并将其用于查找。信用：[http ://adv-r.had.co.nz/Subsetting.html#applications](http://adv-r.had.co.nz/Subsetting.html#applications)

```
product.code <- c(1='Tylenol', 2='Tylenol', 3='Tylenon', 4='Advil', 5 ='Advil', 6='Advil', 7='Bayer', 8='Bayer', 9='Bayer', 10='Generic', 11='Generic', 12='Generic') 
```

获取输出

```
$unname(product.code[dat$product]) 
```

使用顶级解决方案对速度进行基准测试

```
$microbenchmark(
 named_vector = unname(product.code[dat$product]), 
 find.key = find.key(dat$product, brands),
 levels = `levels<-`(factor(dat$product),brands))
Unit: microseconds
         expr     min       lq      mean   median       uq     max neval
 named_vector  11.777  20.4810  26.12832  23.0410  28.1610 207.360   100
     find.key  34.305  55.8090  58.75804  59.1370  65.5370 130.049   100
       levels 143.361 224.7685 234.02545 247.5525 255.7445 338.944   100 
```

此解决方案与@kohske 的解决方案非常相似，但适用于非数字查找。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-10-30T13:41:58.607

另一个版本，在这种情况下可以工作：

```
c("Tylenol","Advil","Bayer","Generic")[(dat$product %/% 3.1) + 1] 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-02-15T13:01:20.967

[规范 tidyverse 方法从查找表中更新向量的某些值](https://stackoverflow.com/questions/67081496/canonical-tidyverse-method-to-update-some-values-of-a-vector-from-a-look-up-tabl)

基于上述问题的代码，该问题通过查找表和 tidyverse 风格的 left_join 得到了很好的解决方案。

```
library(tidyverse) 
```

首先，我们应该设置一个查找表。您可以在 csv 文件中设置查找表，以缩短人工时间。

```
lookup <- tribble(
  ~brand, ~code, ~size,
  "Tylenol", 1, "small",
  "Tylenol", 2, "medium",
  "Tylenol", 3, "large",
  "Advil", 4, "small",
  "Advil", 5, "medium",
  "Advil", 6, "large",
  "Bayer", 7, "small",
  "Bayer", 8, "medium",
  "Bayer", 9, "large",
  "Generic", 10, "small",
  "Generic", 11, "medium",
  "Generic", 12, "large"
) 
```

然后，我们可以使用查找表创建新变量。

```
newdat <- dat %>% 
  left_join(lookup, by = c("product" = "code")) %>%
  select(-product) 
```

虽然这个答案可能已经过时，但由于这是我在搜索此类答案时遇到的第一个问题，而且我花了几个小时才找到一个整洁的答案，我相信我的答案是有道理的。

# iphone - 以编程方式执行 Storyboard Segue

> ID：10431408
> 
> 赞同：9
> 
> 时间：2012-05-03T12:29:38.970
> 
> 标签：iphone, objective-c, ios, segue

大家，我目前正在为一个新应用开发登录和密码界面，我想有条件地执行一个segue，只有当密码和登录都可以时。我在 Storyboard 中创建了一个带有“push”样式和“loginMainIdentifier”的 Segue。实现文件夹编写如下：

```
 - (IBAction)pushValidateButton:(id)sender {

    if([loginText.text isEqualToString:@""] || [passwordText.text isEqualToString:@""] )
    {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Identification" message:@"Veuillez completer l'ensemble des cases SVP" delegate:self cancelButtonTitle:@"Revenir" otherButtonTitles:nil];
        alert.alertViewStyle = UIAlertViewStyleDefault;
        [alert show];
    }

    if(![loginText.text isEqualToString:@""] && ![passwordText.text isEqualToString:@""])
    {
    //creation of the request
        NSMutableString *string = [[NSMutableString alloc] initWithCapacity:100];
        NSString *string01 = @"http://89.82.227.112/Vico/login.php?l=&m="; 

        [string appendFormat:string01];
        NSString *string02 = loginText.text;
        NSString *string03 = passwordText.text;

        [string insertString:string03 atIndex:41];
        [string insertString:string02 atIndex:38];

        NSURLRequest *request01=[NSURLRequest requestWithURL:[NSURL URLWithString:string]cachePolicy:NSURLRequestUseProtocolCachePolicy timeoutInterval:60.0];

    //create the connection and start loading data

        NSURLConnection *connection01 = [[NSURLConnection alloc] initWithRequest:request01 delegate:self];
        if(connection01)
        {
        //Create NSMutableData to receive data
        //receiveddata is an instance declared elsewhere
        receivedData = [NSMutableData data];
        }
    }
    [self performSegueWithIdentifier:@"loginMainSegue" sender:self];
} 
```

`[self performSegueWithIdentifier:@"loginMainSegue" sender:self]`我不明白为什么它在代码末尾不起作用。

是否有人知道缺少什么以便仅在填写登录名和文本时才执行segue。

谢谢

胜利者

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T12:39:27.940

检查名称是否拼写正确（您写在顶部**loginMainIdentifier**，然后**loginMainSegue**在代码中）。

还要检查这个 segue 是否从**整个**viewController 连接到，当然，目标 viewController。

# c# - Try catch finally：如果没有抛出异常就做某事

> ID：10431413
> 
> 赞同：34
> 
> 时间：2012-05-03T12:30:17.220
> 
> 标签：c#, try-catch

我想知道，如果没有抛出异常，有没有办法只执行一个块？

我能想到的最好的是：

```
bool exception = false;
try{
    // something
}catch(Exception e){
    exception = true;
}finally{
    if(!exception){
        // i can do what i want here
    } 
} 
```

有没有更好的办法？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-05-03T12:31:34.247

当然有：把它放在`try`块的底部。

```
try{
    // something
    // i can do what i want here
}catch(Exception e){
    // handle exception
} 
```

这并不完全等同于您的原始代码，因为如果“您想要的”抛出，异常将在本地捕获（这不会发生在您的原始方案中）。这是您可能关心或不关心的事情，并且很有可能不同的行为也是正确的行为。

如果你想恢复旧的行为，你也可以使用这个不需要 a 的变体来`finally`编写“如果没有异常”条件：

```
var checkpointReached = false;
try{
    // something
    checkpointReached = true;
    // i can do what i want here
}catch(Exception e){
    if (checkpointReached) throw; // don't handle exceptions after the checkpoint
    // handle exception
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-03T12:31:42.677

您不需要 finally 子句。

一个办法 ：

```
bool exception = false;
try{
    // something
}catch(Exception e){
    exception = true;
}
if(!exception){
     // u can do what u want here
} 
```

通常你会在你的 catch 子句中有一个 return ，这样你甚至不必测试：

```
try{
    // something
}catch(Exception e){
   // do things
   return;
}
// u can do what u want here 
```

或（取决于用例，通常不太清楚，特别是如果您预期有多个异常 - 您不希望有 try-catch 嵌套......）：

```
try{
    // something
    // u can do what u want here
}catch(Exception e){
   // do things
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-03T12:32:09.290

你能构造你的代码，`doSomething`让它是块中的最后一条语句并且它不会抛出吗？

```
bool exception = false;
try{
  // something
  doSomething();
} catch {
}
finally {
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-03T12:32:33.567

是的，有：把它放在 try 块的末尾:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-03T12:31:53.950

不-您所拥有的可能是在 C# 中执行此操作的最佳方法。

这是假设：

*   您不希望*“我可以在这里做我想做的事”*`try`代码在您的块底部运行。（也许是因为您不希望该代码中的异常由主`catch`块处理。）
*   您不希望*“我可以在这里做我想做的事”*代码完全在`try...catch...finally`结构之外运行。`finally`（也许是因为您希望该代码在位于块内的其他代码之前运行。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-03T12:33:04.977

虽然您的代码没有任何问题，但这是不必要的。只需将您希望执行的代码放在 try 块的底部：

```
try {
    ...
    // No errors to this point, run what you wanted to run in the finally.
}
catch(Exception e) {
    ...
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-19T22:56:51.227

我相信您正在尝试中寻找尝试：

```
try{
    // something

    try{
        // something else not interfering with first try
    } catch(Exception innerEx){
        // something else threw this innerEx
    }

}catch(Exception outerEx){
    // something threw this outerEx
} 
```

虽然这通常被认为是不好的做法，但我更喜欢它而不是标志版本。

# android - 如何使用 asp.net webservice 创建自定义推送通知？

> ID：10431415
> 
> 赞同：6
> 
> 时间：2012-05-03T12:30:22.453
> 
> 标签：android, iphone, asp.net, web-services, push-notification

我有适用于 iPhone 和 android 的单个应用程序。我想使用 asp.net webservice 在我的应用程序中实现自定义推送通知。

我该怎么做？

是否有任何使用 webservice 管理数据的示例代码？请建议我如何为此管理 webservice。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T12:57:17.590

请使用[来自 github 的以下代码](https://github.com/arashnorouzi/Moon-APNS)用于 .Net 推送通知。您需要在其中提供 .p12 文件，并且必须根据您的要求设置开发人员/生产模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T12:41:55.103

**以下代码适用于 PHP**。

没有现成的此类代码。您可以这样做，例如在数据库表中维护 1 个标记字段，例如 1 用于 iOS 设备，2 用于 android 设备。我已经实现了相同的功能，下面是相应地发送推送通知的代码。

```
//This function determines which is the device and send notification accordingly.
function sendPushNotificaitonToAllUser($NotificationMsg)
{
    $sql = "select ID,DeviceToken,DeviceType from TblDeviceToken";
    $rs  = mysql_query($sql);
    $num = mysql_num_rows($rs);

    if($num >= 1)
    {
        while($row = mysql_fetch_array($rs))
        {
            $deviceToken = $row['DeviceToken'];
            if($deviceToken!='' || $deviceToken!='NULL')
            {
                if($row['DeviceType']==1)   
                    deliverApplePushNotification($deviceToken,$NotificationMsg);
                else if($row['DeviceType']==2)  
                    sendAndroidPushNotification($deviceToken,$NotificationMsg);
            }
        }
    }     
}

//APPLE PUSH NOTIFICATION DELIVERY
function deliverApplePushNotification($deviceToken,$message)
{
    //Create context
    $ctx = stream_context_create();
    stream_context_set_option($ctx, 'ssl', 'local_cert', PEM_FILE_NAME);
    stream_context_set_option($ctx, 'ssl', 'passphrase', APPLE_PEM_PASSPHRASE);

    //Establish connection
    $fp = stream_socket_client(APPLE_URL, $err, $errstr, 60, STREAM_CLIENT_CONNECT|STREAM_CLIENT_PERSISTENT, $ctx);

    /*
        if (!$fp)
            exit("Failed to connect: $err $errstr" . PHP_EOL);
    */  

    $body['aps'] = array('alert' => $message,   'sound' => 'default'); // Create the payload body
    $payload = json_encode($body); // Encode the payload as JSON
    $msg = chr(0) . pack('n', 32) . pack('H*', $deviceToken) . pack('n', strlen($payload)) . $payload;// Build the binary notification
    $result = fwrite($fp, $msg, strlen($msg));// Send it to the server

    //If want to keep track of delivery can be done from here.
    /*if (!$result)
        echo '<br/>Message not delivered-->$deviceToken' . PHP_EOL;
    else
        echo '<br/>Message successfully delivered-->$deviceToken' . PHP_EOL;        
    */

    fclose($fp); // Close the connection to the server
}

function sendAndroidPushNotification($deviceRegistrationId,$messageText)
{   
    $authenticationID=googleAuthenticate(ANDROID_USERNAME,ANDROID_PASSWORD,ANDROID_SOURCE,ANDROID_SERVICE);
    $result= sendMessageToPhone($authenticationID,$deviceRegistrationId,ANDROID_MSGTYPE,$messageText);
}   

function googleAuthenticate($username, $password, $source="Company-AppName-Version", $service="ac2dm") 
{    
    session_start();
    if( isset($_SESSION['google_auth_id']) && $_SESSION['google_auth_id'] != null)
        return $_SESSION['google_auth_id'];

    // get an authorization token
    $ch = curl_init();
    if(!ch){
        return false;
    }

    curl_setopt($ch, CURLOPT_URL, "https://www.google.com/accounts/ClientLogin");
    $post_fields = "accountType=" . urlencode('HOSTED_OR_GOOGLE')
        . "&Email=" . urlencode($username)
        . "&Passwd=" . urlencode($password)
        . "&source=" . urlencode($source)
        . "&service=" . urlencode($service);
    curl_setopt($ch, CURLOPT_HEADER, true);
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $post_fields);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_FRESH_CONNECT, true);    
    curl_setopt($ch, CURLOPT_HTTPAUTH, CURLAUTH_ANY);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);

    // for debugging the request
    //curl_setopt($ch, CURLINFO_HEADER_OUT, true); // for debugging the request

    $response = curl_exec($ch);

    //var_dump(curl_getinfo($ch)); //for debugging the request
    //var_dump($response);

    curl_close($ch);

    if (strpos($response, '200 OK') === false) {
        return false;
    }

    // find the auth code
    preg_match("/(Auth=)([\w|-]+)/", $response, $matches);

    if (!$matches[2]) {
        return false;
    }

    $_SESSION['google_auth_id'] = $matches[2];
    return $matches[2];
}

function sendMessageToPhone($authCode, $deviceRegistrationId, $msgType, $messageText) 
{
    $headers = array('Authorization: GoogleLogin auth=' . $authCode);
    $data = array(
                            'registration_id' => $deviceRegistrationId,
                            'collapse_key' => $msgType,
                            'data.message' => $messageText //TODO Add more params with just simple data instead           
                        );

    $ch = curl_init();

    curl_setopt($ch, CURLOPT_URL, "https://android.apis.google.com/c2dm/send");
    if ($headers)
        curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($ch, CURLOPT_POST, true);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $data);

    $response = curl_exec($ch);

    curl_close($ch);

    return $response;
} 
```

**注意**：如有任何疑问/疑问，请随时联系。发表评论

# c++ - 保护这份关于将 C/C++ 与 GSSAPI 和 SASL 结合使用的宝贵文档

> ID：10431416
> 
> 赞同：36
> 
> 时间：2012-05-03T12:30:23.347
> 
> 标签：c++, c, kerberos, sasl, gssapi

一段时间以来，我一直致力于在 c/c++ 应用程序中使用 GSSAPI。显然，我不得不用谷歌搜索和研究很多。我发现的最有趣的文档之一是在 Sun 的旧网站上。甲骨文接管 Sun 后，旧网站已不复存在，但不知何故，这些信息仍然存在。 [http://docs.oracle.com/cd/E19253-01/816-4863/index.html](http://docs.oracle.com/cd/E19253-01/816-4863/index.html) 令人震惊的是，我在 Oracle 的文档中找不到任何指向上述 url 的链接。内容还包括几个 PDF 文件，幸运的是我保存在笔记本电脑上。

上面的 URL 也有一个很好的指南，介绍如何将 SASL 与 c/c++ 结合使用。

内容引用了一些包含示例源代码的 tar 文件。根据当前站点内容，该文件应位于： [http](http://www.sun.com/download/products.xml?id=41912db5) ://www.sun.com/download/products.xml?id=41912db5 但不幸的是，我现在无法在该站点上找到它们。

该内容是 ac/c++ 程序员从 GSSAPI / Kerberos / PAM / SASL 开始的绝佳起点

看看甲骨文目前的网站，我坚信这些内容目前是“不小心”留下的，很快就会消失。

现在这是我对访问 stackoverflow 的奇妙黑客的问题：

1.  你能以某种方式将内容复制到某个地方，以便每个人都能享受它的好处吗？
2.  有人有我所指的 tar-ball 的副本吗？你愿意分享吗？
3.  我必须在哪里上传这些 PDF，以便每个人都能轻松受益？

我认为这些内容确实非常宝贵，而且我想不出任何其他网络资源来提供关于将 GSSAPI 与 C/C++ 一起使用的如此详尽的清晰信息。如果你能对此做点什么，请现在就做，因为我认为上面的 URL 也将很快消失。

提前致以诚挚的感谢，我向您保证，许多其他人也会感谢您。

编辑：在 Oracle 的网站上搜索了一下，我发现了指向其中一个 PDF 的链接，但已经被赋予了一个新名称： [Oracle Solaris Security for Developers](http://docs.oracle.com/cd/E19253-01/816-4863/816-4863.pdf) 如果您开始使用 GSSAPI / SASL C++

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-07-25T11:10:11.533

看起来[“Internet 档案”](http://archive.org/index.php)就是您要找的东西。您还可以查看 [此 wiki中列出的](http://en.wikipedia.org/wiki/Internet_Archive)[“Archive-It”](http://www.archive-it.org/)和其他类似资源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-26T08:46:09.180

此文本受版权保护。无论您做什么，正确的做法是首先获得 Oracle/Sun 的许可。也许本指南已过时或在某些地方完全错误，因此他们决定将其离线。

*   如果你想复制它 - 去做吧！

*   有一个名为[ScrapBook](https://addons.mozilla.org/en-us/firefox/addon/scrapbook/)的 Firefox 插件。它可以很好地归档整个网站，完成后，您可以将数据从您的个人资料复制到您想要的任何地方。假设一个提供静态内容的 Web 服务器。

*   [Oracle wikis.oracle.com](http://wikis.oracle.com/)也有一个 wiki 站点，其中已经包含类似的内容。即一些具有类似指南的PDF。我认为把“你的”PDF放在那里是很安全的。

# jquery-ui - jQuery updown 奇怪的行为

> ID：10431419
> 
> 赞同：0
> 
> 时间：2012-05-03T12:30:42.257
> 
> 标签：jquery-ui, jquery-plugins

简单对话框：

```
$j('#appointment-time-dialog').dialog({
    closeText: 'hide',
    modal: true,
    resizable: false,
    title: 'Appointment Time',
    autoOpen: false
    });
$j('#appointment-time-hours').updown(0, 23, 0);
$j('#appointment-time-minutes').updown(0, 59, 0); 
```

我发现了该功能的有趣行为：两个向上按钮从 0 计数到 8，然后变为 0，向下按钮可以向下计数到 9，然后达到最大值（23 和 59）。

我可以找出“挖掘”的地方以找到解决方案..

PS：使用 JQuery 1.7.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T11:58:48.163

真相就在表面上=）

在设置递增/递减值之前，我曾经在新字符串值之前添加“0”（对于任何值 1..9 以模拟手表的分钟数），然后**parseInt()**它们。

但是前面的零是八进制数字。

所以要小心并使用**parseInt(value, scale)**（在我的情况下，我需要使用 parseInt(value, 10)）

# database - 试图在我的环境中设置 Postgres，但似乎无法获得 intidb 的权限

> ID：10431426
> 
> 赞同：32
> 
> 时间：2012-05-03T12:31:20.317
> 
> 标签：database, postgresql, chmod, chown

我正在关注最近关于设置 PostgreSQL 的 RailsCast，但我无法运行该`initdb /usr/local/var/postgres`命令。每次我运行它，我都会收到这个错误：

```
The files belonging to this database system will be owned by user "Construct".
This user must also own the server process.

The database cluster will be initialized with locale en_US.UTF-8.
The default database encoding has accordingly been set to UTF8.
The default text search configuration will be set to "english".

creating directory /usr/local/var/postgres ... initdb: could not create directory "/usr/local/var": Permission denied 
```

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2013-03-10T08:05:30.207

这应该可以正常工作：

```
# sudo mkdir /usr/local/var/postgres
# sudo chmod 775 /usr/local/var/postgres
# sudo chown construct /usr/local/var/postgres
# initdb /usr/local/var/postgres 
```

使用您的用户名代替构造。因此，如果您的计算机用户名是 WDurant，则代码将为：

```
# sudo chown $(whoami) /usr/local/var/postgres 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-11-04T04:28:46.370

如果您在 Arch Linux 上运行，请像这样使用：

```
sudo mkdir /var/lib/postgres
sudo chmod 775 /var/lib/postgres
sudo chown postgres /var/lib/postgres

sudo -i -u postgres

[postgres]$ initdb --locale $LANG -E UTF8 -D '/var/lib/postgres/data'
[postgres]$ exit

sudo systemctl start postgresql.service

sudo -i -u postgres 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-05-03T17:48:16.133

您实际上需要`SU`对`postgres`用户

*   `sudo su - postgres`

然后你可以运行命令

*   `initdb -E UTF8`（我现在更喜欢设置它，因为 UTF8 非常灵活，这会将所有集群创建为 UTF8 [除非您明确指定另外]）

那么您需要创建您的用户（如果尚未创建）

*   `$ createuser -s -U postgres`
*   `$ Enter name of role to add: {{ my login name }}`（这似乎是`Construct`）

然后你可以退出 postgres 用户，你可以创建自己的数据库

*   `$ createdb`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-05-03T17:40:32.650

您以哪个用户身份运行 initdb？如果您不是 root，您可能没有在 /usr/local 中创建目录的权限。我建议以 root 身份创建 /usr/local/var/postgres，然后 chown'ing 来构建：

```
# mkdir -m 0700 -p /usr/local/var/postgres
# chown construct /usr/local/var/postgres 
```

然后你的 initdb （作为构造运行）应该有权限。

另外，请注意 Unix 用户名通常全小写（但也区分大小写）；您*确定*您的 Construct 用户实际上是大写的吗？如果是这样，你*真的确定*你希望它被大写吗——很多东西都会坏掉。

（仅供参考：对于此类 Unix 问题，您可能会发现[Unix.SE](https://unix.stackexchange.com/)或[Ask Ubuntu](https://askubuntu.com/)提供更快的答案）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-15T23:29:21.223

现在至少在 CentOS/RHEL 中应该是这样的：

```
# install the binaries
sudo yum install -y postgresql-server
# create the database
sudo su postgres -c 'postgresql-setup initdb'
# enable the service to start on VM start
sudo systemctl enable postgresql.service
# start the service
sudo systemctl start postgresql.service 
```

然后你可以访问它

```
sudo -u postgresql psql 
```

# python - wxPython 在 TextCtrl 中键入关键字时，该单词会改变颜色

> ID：10431428
> 
> 赞同：-1
> 
> 时间：2012-05-03T12:31:24.877
> 
> 标签：python, wxpython, wxtextctrl

我有一个 wxTextCtrl，我希望能够在输入某些关键字时，在完成输入后他们的关键字会改变颜色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T13:40:49.797

您需要在富文本模式下使用 TextCtrl 或 StyledTextCtrl。然后你会想要监控按键，以便你可以知道用户何时按下了空格键并采取行动。您应该查看 Editra，这是一个在 wxPython 中创建并包含在 wxPython 演示和文档包中的 Python 编辑器。我很确定它已经具有此功能。

# vim - 如何在gvim中拆分打开所有包含TODO的文件？

> ID：10431429
> 
> 赞同：2
> 
> 时间：2012-05-03T12:31:32.813
> 
> 标签：vim

我想在 gvim 的拆分缓冲区中打开所有包含 TODO 的源文件。

我很确定这可以通过将`grep`其输出传递给编辑命令来完成，但我不确定如何实现这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-03T12:47:11.247

我不会分开打开它们，除非你知道只有两三个。但是，如果只有两三个文件需要编辑，你为什么还要寻找一个命令来自动打开它们呢？

这是您可以使用的基本 grep：

```
grep -lIr TODO . 
```

它递归地搜索当前目录以查找包含 `TODO`并列出它们的文件。它还避免匹配二进制文件（包括 .swp 和 .swo 文件）。然后，如果您正在运行 GUI Vim，我会选择：

```
mvim --remote-silent $(grep -lIr TODO .) 
```

或者，在 Vim 中，您可以使用`:argadd` sehe 在评论中巧妙建议的命令和反引号扩展：

```
:args `grep -Ilr TODO .` 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-03T14:52:47.143

vim 中实际上有一个功能，它可能比您实际要求的要好得多。退房`:help quickfix`。本质上，您可以按照您的想象执行 grep：

`grep -rn TODO . > index.txt`

然后你可以在 vim 的 quicklist 中打开这个索引：

`vim -q index.txt`

`:cn`这将允许您通过执行(next) 和`:cp`(previous)来浏览所有这些文件中的每个 TODO 。也可以`:copen`在底部打开快速列表窗口，向您显示您在整个列表中的位置，并允许您导航到任何文件中的每个 TODO。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-05-03T12:38:29.347

您可以使用`xargs`：

```
grep -l TODO * | xargs vim -o 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-19T19:19:58.143

您还没有说明您使用的是哪个操作系统和外壳。但是假设您使用的是类似的东西`bash`，这应该可以工作：

`vim -o $(grep -lr TODO .)`

但是，如果您当前的工作目录是 git repo 或其他东西，请小心，因为这将包含其中的文件。根据你设置 vim 的方式，你也可能得到旧的交换文件。为了解决这个问题，我有一个[`alias`](https://tldp.org/LDP/abs/html/aliases.html)to `grep`，带有一个 bundleo'`--exclude`和`--exclude-dir`参数。例如：

`alias gg='grep --exclude='\''*.sw?'\'' --exclude-dir='\'.git\'`

# php - 可使用 Jquery Tablesorter 排序的 HTML 表？

> ID：10431431
> 
> 赞同：0
> 
> 时间：2012-05-03T12:31:34.753
> 
> 标签：php, html-table, import-from-csv

我正在使用以下代码从 CSV 文件创建 HTML 表。如何使此表可排序？我尝试使用 Jquery 表排序器，但问题似乎是当我单击一行对其进行排序时，它会被 PHP 重新创建，从而导致未排序的表。

```
<!DOCTYPE html>
<html>

<?php
function jj_readcsv($filename, $header=false) {
$handle = fopen($filename, "r");
echo '<table>';
//display header row if true
if ($header) {
$csvcontents = fgetcsv($handle);
echo '<tr>';
foreach ($csvcontents as $headercolumn) {
    echo "<th>$headercolumn</th>";
}
echo '</tr>';
}
// displaying contents
while ($csvcontents = fgetcsv($handle)) {
echo '<tr>';
foreach ($csvcontents as $column) {
    echo "<td>$column</td>";
}
echo '</tr>';
}
echo '</table>';
fclose($handle);

}

jj_readcsv('table.csv',true);
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T12:46:36.203

页面重定向是由于其他一些错误`PHP`代码（可能）或也可能是脚本造成的。

**编辑：**缩进所有代码并检查它。

* * *

**PHP代码：**

```
<?php
function jj_readcsv($filename, $header=false) {
$handle = fopen($filename, "r");
?>
<table id="tb" >
<?php
if ($header) {
$csvcontents = fgetcsv($handle);
?>
    <thead>
        <tr>
    <?php foreach ($csvcontents as $headercolumn) { ?>
            <th><?php echo $headercolumn; ?></th>
    <?php } ?>
        </tr>
    </thead>
    <tbody>
<?php } 
while ($csvcontents = fgetcsv($handle)) { ?>
        <tr>
    <?php foreach ($csvcontents as $column) { ?>
            <th><?php echo $column; ?>
    <?php } ?>
        </tr>
<?php } ?>
    </tbody>
</table>
<?php fclose($handle); 

}
jj_readcsv('table.csv',true);
?> 
```

* * *

jQuery JS：

```
$("#tb").tablesorter(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T12:45:00.883

根据 tablesorter 网站，您需要将他们的类应用到您的表中，并为主要列标题使用 thead 标签，例如：

```
<table id="myTable" class="tablesorter"> 
<thead> 
<tr> 
    <th>Last Name</th> 
    <th>First Name</th> 
    <th>Email</th> 
    <th>Due</th> 
    <th>Web Site</th> 
</tr> 
```

```
etc... 
```

[根据http://tablesorter.com/docs/](http://tablesorter.com/docs/)上的文档，您的 php 没有为 tablesorter jquery 生成正确的 html。

# oracle - Oracle 触发器清除旧记录

> ID：10431438
> 
> 赞同：2
> 
> 时间：2012-05-03T12:31:56.663
> 
> 标签：oracle, triggers, oracle11g

我正在寻找创建触发器或其他一些 Oracle 机制来从表中删除旧记录。有问题的表有一个“创建日期”DateTime 列。我想定期删除一个月前的行。oracle 是否支持“定期任务”，或者可以/应该通过插入/更新触发器来完成。当触发器在同一个表上触发时，我认为我不能修改表中的其他行。

像这样的事情最好以编程方式处理吗？我正在通过 .NET 应用程序访问数据库，并认为最好以编程方式维护它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T12:35:21.827

查看 DBMS_SCHEDULER。它可以让您设置预定的作业。

官方文档： [http ://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_sched.htm](http://docs.oracle.com/cd/B28359_01/appdev.111/b28419/d_sched.htm)

有用的示例总结：http: [//psoug.org/reference/dbms_scheduler.html](http://psoug.org/reference/dbms_scheduler.html)

# iphone - iPhone核心位置经纬度的准确性

> ID：10431439
> 
> 赞同：0
> 
> 时间：2012-05-03T12:32:00.563
> 
> 标签：iphone, google-maps, core-location, latitude-longitude

我编写了一个非常基本的 iPhone 应用程序，每次我收到 CLLocation 更新时都会记录我的纬度和经度。它将这些新位置存储在 GPX 文件中，然后我可以将其加载到谷歌地图中作为路线覆盖。缩小时，路线看起来相当准确，但放大时，我的路线经常出现在我实际行驶的路边。一个典型的例子可能是位置更新发生在我接近一个路口时，然后在我转弯后再次发生。当这两个点连接起来时，我似乎已经离开了公路。有谁知道是否有办法提高这种准确性，或者将我的路线捕捉到实际道路本身？

我的更新代码如下：

```
- (void)locationUpdate:(CLLocation *)location 
{   
////////////////////////////////////////////////////////
//Write to File
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *testFile = [documentsDirectory stringByAppendingPathComponent:@"routeplots.gpx"];

    BOOL fileExists = [[NSFileManager defaultManager] fileExistsAtPath:testFile];

    if(fileExists) {
        // get a handle to the file

        NSFileHandle *fileHandle = [NSFileHandle fileHandleForWritingAtPath:testFile];

        // move to the end of the file
        [fileHandle seekToEndOfFile];

        NSString *data =[NSString stringWithFormat:@"\n<trkpt lat='%f' lon='%f'><name>%f</name></trkpt>", location.coordinate.latitude , location.coordinate.longitude , [location speed]];

        // move to the end of the file
        [fileHandle seekToEndOfFile];

        // convert the string to an NSData object
        NSData *textData = [data dataUsingEncoding:NSUTF8StringEncoding];

        // write the data to the end of the file
        [fileHandle writeData:textData];

        // clean up
        [fileHandle closeFile];
}
} 
```

感谢您查看我的问题，詹姆斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:54:02.130

将 desiredAccuracy 设置为 AccuracyBest 。locationManager.desiredAccuracy = KCLLocationAccuracyBest。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T13:07:10.690

看看APPLE 自己提供的这个[示例应用程序就知道你在做什么。](https://developer.apple.com/library/ios/#samplecode/Breadcrumb/Introduction/Intro.html)只需在设备中下载示例安装并了解他们的工作方式。

`It Demonstrates how to draw a path using the Map Kit overlay, MKOverlayView, that follows and tracks the user's current location. The included CrumbPath and CrumbPathView overlay and overlay view classes can be used for any path of points that are expected to change over time. It also demonstrates what is needed to track the user's location as a background process.`

希望能帮助到你。

# windows-phone-7 - WP7 HttpWebRequest 调用方法出错

> ID：10431443
> 
> 赞同：0
> 
> 时间：2012-05-03T12:32:29.867
> 
> 标签：windows-phone-7, c#-4.0, silverlight-4.0, httpwebrequest

我正在调用像 HttpWebRequest 这样的方法，它会给我这样的错误，我的代码是这样的。

```
HttpWebRequest objHttpWebRequest = System.Net.WebRequest.CreateHttp("http://url");
        objHttpWebRequest.BeginGetResponse(r =>
        {
            WebResponse response = null;
            try
            {
                response = objHttpWebRequest.EndGetResponse(r); //End Async Call to the URL
                using (var stream = response.GetResponseStream())
                using (var reader = new StreamReader(stream)) //get data in StreamReader
                {
                    string contents = reader.ReadToEnd(); //read content from reader and store it in content
                    XElement xmlResult = XElement.Parse(contents);
                    AEGAPI.clsGlobal.RandomToken = xmlResult.Value;
                } 
```

![错误快照](../Images/7034632cbe9ea92ea460fd117a5e4076.png)

我的错误报告是

```
System.NotSupportedException occurred
  Message=Timeouts are not supported on this stream.
  StackTrace:
       at System.IO.Stream.get_WriteTimeout()
       at MS.Internal.InternalNetworkStream.get_Length()
       at System.IO.StreamReader.ReadToEnd()
       at AEGAPI.clsAEGAPI.<>c__DisplayClass3.<Authenticate>b__0(IAsyncResult r)
       at System.Net.Browser.ClientHttpWebRequest.<>c__DisplayClassa.<InvokeGetResponseCallback>b__8(Object state2)
       at System.Threading.ThreadPool.WorkItem.WaitCallback_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadPool.WorkItem.doWork(Object o)
       at System.Threading.Timer.ring() 
```

谢谢你的帮助 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:46:04.100

使用 WebClient.DownloadStringAsync() 会不会更简单？

```
void startDownload(Uri url)
{
    WebClient wc = new WebClient();
    wc.DownloadStringCompleted += MyMethod;
    wc.DownloadStringAsync(url);
}
void MyMethod(object sender, DownloadStringCompletedEventArgs e)
{
    var contents = e.Result;
    XElement xmlResult = XElement.Parse(contents);
    AEGAPI.clsGlobal.RandomToken = xmlResult.Value;
} 
```

# c# - 如何在不丢失其他元素的情况下首先放置列表元素c#

> ID：10431447
> 
> 赞同：1
> 
> 时间：2012-05-03T12:32:33.933
> 
> 标签：c#, linq

我有一个字符串列表 (GUIDS)，我想拿一个并把它放在第一个，然后把其他的撞下来。如何才能做到这一点？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T12:33:55.103

您可以通过使用`Remove`（或`RemoveAt`，取决于您可以访问的信息）和后续的`Insert`.

你也可以做类似的事情

```
myList.OrderBy(x => x != theFirstNode).ThenBy(x => x.DefaultSortField); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:34:01.253

```
var targetGuid = whateverGuidtoMove;
myGuidList.Remove(targetGuid);
myGuidList.Insert(0, targetGuid); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:37:14.383

```
oldlist.Remove(value);
oldlist.Insert(0, value); 
```

# java - 如何从xml文件中获取属性？

> ID：10431450
> 
> 赞同：0
> 
> 时间：2012-05-03T12:32:37.230
> 
> 标签：java, xml, dom

我的 Xml 文件如下所示：

```
 <?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE pointList SYSTEM "point.dtd">
<pointList>
<point unit="mm">
<x>2</x>
<y>3</y>
</point>

<point unit="cm">
<x>9</x>
<y>3</y>
</point>

<point unit="px">
<x>4</x>
<y>7</y>
</point>

</pointList> 
```

当我尝试获取标签点的属性时：

```
import java.io.File;
import java.io.IOException;

import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;

import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.NamedNodeMap;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;
import org.xml.sax.SAXException;

public class TryXml {
    public static void main (String [] args) {
        DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
        DocumentBuilder builder = null;
        Document doc = null;
        try {
            builder = factory.newDocumentBuilder();
        }
        catch (ParserConfigurationException e){
            System.out.println(e.getMessage());
        }
        File f = new File("p1.xml");
        try {
            doc=builder.parse(f);
        }
        catch (SAXException e){
            e.printStackTrace();
        }
        catch (IOException e){
            e.printStackTrace();
        }

        Element root = doc.getDocumentElement();
        System.out.println(root.getTagName());

        System.out.println("****************");

        NodeList nList = root.getChildNodes();
        for (int i=0;i<nList.getLength();i++) {
        if(nList.item(i) instanceof Element)

        System.out.println(nList.item(i).getAttributes());
    }

    }
    } 
```

我得到的只是地址：

```
com.sun.org.apache.xerces.internal.dom.AttributeMap@3214512e
com.sun.org.apache.xerces.internal.dom.AttributeMap@53ddbcb1
com.sun.org.apache.xerces.internal.dom.AttributeMap@28f337b 
```

谁能给我一个关于如何获取点属性以及其他内部标签的提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:41:34.260

您可以将 println 替换为以下内容：

```
System.out.println(((Element) nList.item(i)).getAttribute("unit")); 
```

这应该为您提供当前元素的“单位”属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:42:48.810

利用，

"元素根 = doc.getElementByTagName("pointList"); "

代替，

"元素根 = doc.getDocumentElement();"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:43:44.587

[`Element.getAttributes()`](http://docs.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/Node.html#getAttributes%28%29)将给出其中所有属性的列表`Element`。如果您事先知道属性的名称并且只想获取其值，请[`Element.getAttribute(String)`](http://docs.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/Element.html#getAttribute%28java.lang.String%29)改用。

如果您需要获取子元素，请使用[`Element.getChildNodes()`](http://docs.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/Node.html#getChildNodes%28%29). 要获取 中的文本`Element`，或者更具体地说`Node`，使用[`getNodeValue()`](http://docs.oracle.com/javase/1.4.2/docs/api/org/w3c/dom/Node.html#getNodeValue%28%29).

例如：

```
 NodeList nList = root.getChildNodes();
        String out = "";
        for (int i=0;i<nList.getLength();i++) {
            // Assuming all first-level tags are <point>
            Element point = (Element) nList.item(i);
            String unit = point.getAttribute("unit");
            out += "point ";
            for (int y=0;y<point.getChildNodes().getLength();y++){
                Node child = point.getChildNodes().item(y);
                // String nodeName = child.getNodeName();
                String nodeValue = child.getNodeValue();
                out += nodeValue;
            }
        out += unit;
        out += ", ";
        } 
```

会输出`point 23mm, point 93cm, point 47px,`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T13:04:49.457

这篇[使用 java 获取 xml 属性的](https://stackoverflow.com/questions/6927385/get-the-the-attributes-from-an-xml-file-using-java)帖子可以实现您想要实现的目标。它教授常规的 xml 解析和操作。它还检索属性。

祝你好运！

# java - 如何使用java关闭正在运行的进程？

> ID：10431452
> 
> 赞同：8
> 
> 时间：2012-05-03T12:32:40.673
> 
> 标签：java

我正在使用 java Runtime.exec() 方法来执行 bat 文件，在 bat 文件中我编写了执行 jar 的代码。这个 jar 包含线程类，该线程类汇集了 rabbitmq 队列的无限时间，如果找到消息然后对其执行操作，意味着该过程将无限运行。我想用java代码杀死这个进程，我也想知道这个方法能不能在Linux操作系统上执行shall脚本。

```
 **Used java code**

 String myCMD = "cmd.exe /C start c:\\elasticmgmtservice.bat";
 Runtime rt = Runtime.getRuntime();
 Process proc = rt.exec(myCMD);

**used batch file**

cd c: 
cd ElasticMgmtService\ 
java -jar ElasticIndexManagementService.jar config\ElasticIndexManagementService.xml 
```

请帮我解决问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T12:50:52.767

Runtime.exec(...) 返回`Process`包含以下方法的对象

*   破坏（）
*   退出值（）
*   获取错误流（）
*   获取输入流（）
*   获取输出流（）
*   等待（）

您可以调用 destroy() 来杀死子进程。此 Process 对象所代表的子进程被强制终止。`taskkill /PID <process id>`或者你可以通过传入`Runtime.exec(...)`或杀死`kill -9 <process id>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T12:47:54.823

在 Windows 中

```
Runtime rt = Runtime.getRuntime();
rt.exec("taskkill " +<Your process>); 
```

在 Linux 中

```
Runtime rt = Runtime.getRuntime();
rt.exec("kill -9 " +<Your process>); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:43:09.980

`Runtime.exec()`返回一个 Process 对象，它是 exec 方法创建的进程的处理程序。要终止此进程，您必须调用`Process.destroy();`

# sql - 如何从要从另一个表中查找字段名的表中选择一个字段？

> ID：10431453
> 
> 赞同：0
> 
> 时间：2012-05-03T12:32:40.983
> 
> 标签：sql, sql-server, ssis

做一些 ETL，我有一个包含很多列的宽文件，每个不同的值。我正在尝试将其转换为每个值项一行的垂直文本文件。所以我的数据表看起来像；

```
Store  Date  Col1 Col2 Col3 ...
Store1 1/2/12 12   23   34  ...
Store2 1/2/12 23   34   35  ... 
```

我的 Col 查找表看起来像；

```
GLCode GLDesc TaxRate XLSColName
00.1234 Cash  0.00    Col2 
```

所以在我的输出文件行中我需要；
`Store1,1/2/34,00.1234,0.00,23`
其中 23 是 Col2 字段中数据表中的值，该值在 GL 查找字段中指定。

我一直在尝试将 SQL 作为 SSIS 包的一部分来执行此操作，因为我看不到如何使用 Lookup 任务执行此操作，但似乎也无法在 SQL 中执行此操作！

希望这是有道理的，并感谢您的帮助！JK

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:49:05.050

根据我对您的问题的理解，您正在寻找[SQL Server UNPIVOT 函数](http://msdn.microsoft.com/en-us/library/ms177410.aspx)，该函数采用列并将它们转换为单独的行/值。将其与联接相结合，以从查找表中获取所需的信息。

要在 SSIS 中执行此操作，您可以使用[UNPIVOT 转换](http://msdn.microsoft.com/en-us/library/ms141723.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:52:21.630

您将需要查看从以下位置旋转数据表：

```
Store  Date  Col1 Col2 Col3 ...
Store1 1/2/12 12   23   34  ...
Store2 1/2/12 23   34   35  ...

Store  Date  Col Value
Store1 1/2/12 Col1 12
Store1 1/2/12 Col2 23
Store1 1/2/12 Col3 34
Store2 1/2/12 Col1 23
Store2 1/2/12 Col2 34
Store2 1/2/12 Col3 35 
```

因此，您可以将列名视为要加入/查找的数据。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-03T12:46:07.437

你的问题有点令人困惑。我了解您要做什么，但不能 100% 确定数据的存储位置。这是正确的吗？：你有 2 个表，1 个表有你想要的数据？1 表具有搜索第一个表的值？

如果是这样，你想要类似的东西：

```
SELECT t1.col1, t1.col2, ... 
FROM table_1 t1 
    LEFT JOIN table_2 t2 ON t1.common_field = t2.common_field 
WHERE t2.search_by = 'CRITERIA' 
```

# version-control - 变基后更新所有整个 clearcase 视图

> ID：10431458
> 
> 赞同：1
> 
> 时间：2012-05-03T12:32:52.763
> 
> 标签：version-control, version, clearcase, clearcase-ucm

执行变基时，将阻止子流上的所有签出。

实际上，Clearcase 必须确保所有整个视图都基于新的流配置，因此会显示以下消息：

> 流的配置已更改。此更新操作将使视图显示新配置。是否要立即更新视图？

我试着想象一个场景来解释更新所有视图的绝对必要性。

我想象一个变基是从旧的基础基线制作的情况。
因此，当前子的配置流仍然基于当前父的基线，如果没有在其中执行更新，文件的保留将涉及非内聚状态。

执行此完整更新的充分理由是什么？

假设没有这种预防：

如果在 rebase 之后，我能够修改流子中的文件并检查它，那么潜在的问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:54:51.207

只有所有视图的更新将包括配置规范的重写。

如果您不更新完整视图并签入文件，您将根据该文件的先前基线执行此操作，而不是在变基期间指定的新基线。

有关该操作背后的 cleartool 命令，另请参见“[强制以 clearcase 形式显示视图以等于父流](https://stackoverflow.com/questions/9428274/forcing-a-view-in-clearcase-to-equal-parent-stream/9428378#9428378)”。

# r - 为报表中的表格创建自定义布局

> ID：10431461
> 
> 赞同：2
> 
> 时间：2012-05-03T12:33:01.207
> 
> 标签：r, tabular

如何创建一个看起来像这样的表：

```
 Estimate Std. Error t value Pr(>|t|)
(Intercept)    5.032      0.220  22.850    0.000
groupTrt      -0.371      0.311  -1.191    0.249
                       (Adjusted-R squared: 0.02) 
```

从以下对象？

```
 #DATA
    ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
    trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
    group <- gl(2,10,20, labels=c("Ctl","Trt"))
    weight <- c(ctl, trt)

    A<-(lm(weight ~ group)) 
    A<-summary(A)     
    B<-round(A$coefficients,3)
    R<-paste("(Adjusted R-squared:",round(A$adj.r.squared,2),")") 
```

我特别感兴趣，因为我一直在玩出色的 R2wd，它可以输出出色的表格（至少对于在工作场所受限于 Word 的人来说）。

```
require(R2wd)
library(rcom)
wdGet(T)
wdNewDoc("c:\\temp\\This.doc")
wdTitle("My Analysis Title") 
```

接下来我需要做的是找到一种方法将向量 A 和 R 组合成一个类似表格的对象，该对象将由函数 wdTable() 格式化。它非常巧妙地输出 B 尝试：

```
 wdTable(B) 
```

但我不太清楚如何加入 B 和 R 以便他们制作合适的表格。我想这将是将向量 R 放在第三行和第二列（如上所示）的问题，但我遇到了问题，我不确定它是否适用于 wdTable

我在 [这个论坛](http://www.r-statistics.com/2010/05/exporting-r-output-to-ms-word-with-r2wd-an-example-session/)上找到了一个相关的讨论，但它并没有真正触及它的核心。它将整个内容输出为文本，而不是选定的项目作为表格。

任何帮助将非常感激

PS 要运行 R2wd 如果不运行，则需要安装 Word 句柄

```
 install.packages(c("R2wd","rcom"))
    source("http://www.r-statistics.com/wp-content/uploads/2010/05/R-console-to-word.r.txt")

   txtStart.2wd()
   #Follow instructions (shows you commands to install the R handle)
   txtStop.2wd(F) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-05T20:47:25.717

我只是在调用 wdtable() 之前尝试将该行绑定到数据帧。您可以拆分字符串 R 并用元素填充新行中的单元格。

像这样：

```
require(R2wd)

ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
group <- gl(2,10,20, labels=c("Ctl","Trt"))
weight <- c(ctl, trt)

A <- summary(lm(weight ~ group))     
B <- round(A$coefficients,3)

# I edited the next line..
R <- paste("(Adjusted R-squared: ",round(A$adj.r.squared,2),")", sep = "")
# split it up:
R <- c(" ", unlist(strsplit(R, " ")))

# row-bind it:
R <- data.frame(rbind(B, " " = R))
colnames(R) <- colnames(A$coefficients)

wdGet()

# print table to doc in word default format:
wdTable(format(R), autoformat = 1)
wdSave(path.expand("~/My_Table.doc"))     # save file
wdQuit()                                  # close handler

shell.exec(path.expand("~/My_Table.doc")) 
```

# c# - 截取未打开的文件夹窗口的屏幕截图

> ID：10431463
> 
> 赞同：1
> 
> 时间：2012-05-03T12:33:04.103
> 
> 标签：c#, visual-studio, directory, screenshot

好的。这是我想要做的：

我有一个对用户指定的文件夹进行排序的 Windows 应用程序。我想在排序之前截取这个文件夹的截图，然后在我的程序完成文件夹排序后再次截取。

我知道如何使用以下链接截取活动窗口的屏幕截图：

[捕获活动窗口的屏幕截图？](https://stackoverflow.com/questions/1163761/c-sharp-capture-screenshot-of-active-window)

但是，如果我想截取未打开的位置的屏幕截图会怎样？

Meening，我想截取一个根本没有打开的文件夹的屏幕截图。甚至可能吗？

如果是，那么我将如何实现这一目标？

我猜一种方法是让程序打开文件夹->截屏->关闭它->排序文件夹->打开文件夹->截取新屏幕截图->在屏幕上显示

不过，这不是一个非常优雅的解决方案。

任何人都可以对这个问题有所了解吗？感谢您的时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:50:55.000

取决于您实际想要做什么，如果您的意图是在排序操作之前和之后检查“文件夹”和“子文件夹”的内容，我建议您使用命令提示符生成文本中的内容列表文件。您可以像这样使用 dir 命令：

```
DIR /S /B "Path\To\Folder" > "Path\to\text\File.txt" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:36:56.960

您无法拍摄未在屏幕上绘制的内容的快照。您需要打开文件夹、拍摄快照并关闭文件夹。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T12:48:22.860

首先想到截图的目的。您可能能够在对它们进行排序之前和之后记录文件夹内对象的顺序。然后，您可以使用您的日志数据来生成文本或图形输出，以显示一个像图像一样的文件夹，其中的内容按预先排序的顺序排列。

如果您截取屏幕截图，您如何处理不适合文件夹的对象？使用上述解决方案，您甚至可以获得打开文件夹中不可见的文件的信息。

否则将无法获得屏幕上任何内容的真实屏幕截图。打开文件夹将是最简单也是唯一的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-03T13:22:13.117

您可以将文件夹窗口放置在他/她的屏幕范围之外。然后对该窗口区域进行截图。

您可以使用以下代码确定屏幕的宽度、高度和位置（如果您将第二个屏幕放置在主屏幕的左侧，则屏幕的起始位置为负）：

```
System.Windows.SystemParameters.VirtualScreenWidth;  //Total width of screen
System.Windows.SystemParameters.VirtualScreenHeight; //Total height of screen
System.Windows.SystemParameters.VirtualScreenLeft;   //Start x location of screen
System.Windows.SystemParameters.VirtualScreenTop;    //Start y location of screen 
```

通过将您的文件夹窗口放在该区域之外，然后对该文件夹进行屏幕截图，应该可以解决问题。（不确定未测试）

```
System.Drawing.Bitmap bitmap = new System.Drawing.Bitmap(folderWidth, folderHeight);
System.Drawing.Graphics g = System.Drawing.Graphics.FromImage(bitmap);
g.CopyFromScreen(folderX, folderY, 0, 0, folderSize);
bitmap.Save(aRandomFileStream, System.Drawing.Imaging.ImageFormat.Jpeg); 
```

按原样提供的代码...如果有效，则无需保证。

# wpf - WPF 命中测试 UserControl 和几何

> ID：10431465
> 
> 赞同：1
> 
> 时间：2012-05-03T12:33:10.030
> 
> 标签：wpf, vb.net, hittest

我正在尝试在一个用户控件和另一个用户控件之间进行命中测试。我正在查看其他问题，发现我必须将它放在我的用户控件中。

```
Protected Overrides Function HitTestCore(hitTestParameters As System.Windows.Media.PointHitTestParameters) As System.Windows.Media.HitTestResult
Return New PointHitTestResult(Me, hitTestParameters.HitPoint)
End Function 
```

我还有一个过滤器，它可以正确显示我想以某种方式进行命中测试的控件`htcallback`不起作用。

因为我无法使用我的用户控件进行命中测试，所以我在同一个位置制作了一个矩形并在我的命中测试中使用它。这似乎不起作用。

```
Dim hitTestGeometry = New RectangleGeometry()
hitTestGeometry.Rect = New Rect(_selected.breedte, _selected.hoogte, Canvas.GetLeft(_selected), Canvas.GetTop(_selected))
Dim pt As New Point
VisualTreeHelper.HitTest(WorkFlowCanvas, New HitTestFilterCallback(AddressOf wcFilter), New HitTestResultCallback(AddressOf verplaatsing), New GeometryHitTestParameters(hitTestGeometry)) 
```

我的回答基于第三个答复。 [WPF 中 VisualTreeHelper.HitTest 的问题](https://stackoverflow.com/questions/3411910/problem-with-visualtreehelper-hittest-in-wpf/7162443#7162443)

他这是什么意思

> *如果你想对几何进行命中测试，你还需要覆盖第二个重载*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T13:59:21.650

除了带有参数的[HitTestCore](http://msdn.microsoft.com/en-us/library/ms598915.aspx)之外，还有第二种带有参数`PointHitTestParameters`的方法[HitTestCore](http://msdn.microsoft.com/en-us/library/ms598914.aspx)`GeometryHitTestParameters`。

当您针对几何进行命中测试时，将调用第二个。

# jquery - Jquery自动完成 - 如何将点击事件添加到列表中

> ID：10431467
> 
> 赞同：1
> 
> 时间：2012-05-03T12:33:21.490
> 
> 标签：jquery

嗨，我正在使用下面的代码来填充我的自动完成列表。

```
 $('#input').autocomplete({ ajax_get : get_roles});

    function get_roles(v,cont,roleName){
            var roleName = roleName.value;
            roleName = roleName.toLowerCase();
            $.get('/da/roleautocomplete?roleName='+escape(roleName),{q:v},
                function(obj){
                  var res = [];
                  for(var i=0;i<obj.length;i++){
                    res.push({ id:i , value:obj[i]});
                  }
                  cont(res);
                },
                'json')
        } 
```

我想在单击或从自动完成列表中选择一个项目时触发一个事件。我试过这个 -

```
$('#input').autocomplete({
     select:function(event, ui){
          // do your things here
      }, etc. 
```

但无济于事。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:49:01.823

我第一次尝试使用时遇到了类似的问题`select:function(event,ui){ ... }`，但这绝对是要走的路。

关键是用于`ui.item`获取已单击或以其他方式选择的选项。我最初一直在使用`event`then `this`，但是对于单击和键选择来说，这些是不同的（从`console.log`一些角度来看），所以`ui.item`这就是你想要的。自动完成将设置为`label: ..., value: ...`，因此您最有可能使用的是`ui.item.label`和`ui.item.value`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T12:39:28.330

**演示：http:** [//jsfiddle.net/DMDHC/](http://jsfiddle.net/DMDHC/)

有用的阅读： http: [//jqueryui.com/demos/autocomplete/](http://jqueryui.com/demos/autocomplete/)（您可以阅读可用的选项和事件等）

**代码：**

```
$( "#search" ).autocomplete({
    source: function( req, resp ) {
        $.post( "/echo/json/", {
            json: '["Rambo", "Foobar", "This", "That", "Batman", "Hulk"]',
            delay: 1
        }, function(data) {
            resp( data );
        }, "JSON" );
    },
    select: function(event, ui) {
        var TABKEY = 9;
        this.value = ui.item.value;

        if (event.keyCode == TABKEY) { 
            event.preventDefault();
            this.value = this.value + " ";
            $('#search').focus();
        }

        return false;
    }
}); 
```

# php - PHP 不允许在字符串日期中使用 d/m/Y 格式

> ID：10431468
> 
> 赞同：3
> 
> 时间：2012-05-03T12:33:21.297
> 
> 标签：php, string, date

我想验证一个应该保存为日期的字符串。我希望用户在此表单中给出日期`format ('d-m-Y)`。我正在使用此函数来检查是否给出了有效日期：

```
function isDateValid($birthdate)
{
  $date = date('Y-m-d', $birthdate);        

  $stamp = strtotime(str_replace('/', '-', $date), $date);

  if (!is_numeric($stamp))
     return FALSE;

  //checkdate(month, day, year)
  if ( checkdate(date('n', $stamp), date('d', $stamp), date('Y', $stamp)) )
  {
     return TRUE;
  }
  return FALSE;
} 
```

这适用于这种格式 dmy 的每个条目。但是当给定这样的格式时 d/m/Y ，它仍然返回 true 但日期会像这样 m/d/Y 保存在数据库中。

我能做些什么来确保这种格式“d/m/y”的条目无法保存在数据库中。

提前致谢

**找到了解决方案**

好的，我想我找到了解决方案

```
if(!preg_match('/^(\d\d?)-(\d\d?)-(\d\d\d\d)$/', $birthdate, $matches))
{
  return false;
}
return checkdate($matches[2], $matches[1], $matches[3]); 
```

我检查是否给出了正确的模式，然后检查它是否是有效日期。这对我来说很好，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:44:16.613

您可以使用正则表达式模式，例如：`*\d{4}-\d{2}-\d{2}*`检查格式

# android - 自定义 Android 设备中微调器的下拉效果？

> ID：10431471
> 
> 赞同：2
> 
> 时间：2012-05-03T12:33:31.320
> 
> 标签：android, android-spinner

您好在这里问我们如何将android的微调器的下拉样式更改为html下拉菜单。我知道正常的微调器样式我可以更改android中下拉菜单的微调器效果，那么我如何搜索整个web它只显示自定义微调器的样式找不到我需要的解决方案示例，***我***需要更改视图*![普通微调器](../Images/005572d1a8b53d1ae38fa1c1af66903b.png)*

 ****对此***_ *![自定义下拉微调器](../Images/1a24f2ac9b419ea2ab1a90d4f241168a.png)*

 *我怎样才能做到这一点？**

# asp.net - Razor Views (CSHTML) 不支持 Intellisense

> ID：10431472
> 
> 赞同：2
> 
> 时间：2012-05-03T12:33:33.300
> 
> 标签：asp.net, asp.net-mvc-3, razor

我无法在 VS 2010 中获得对 CSHTML 文件的智能感知支持。它以前工作得很好，突然间它让我发疯了。

关于可能导致问题的任何想法？甚至 Visual Studio 解决方案资源管理器中的视图文件也不会显示“Razor View”图标。

提前致谢

# java - 以编程方式阅读 jasper 报告

> ID：10431473
> 
> 赞同：0
> 
> 时间：2012-05-03T12:33:34.773
> 
> 标签：java, jasper-reports, reporting

我公司的一些顾问创建了多个碧玉报告（使用 iReports），这些报告将使用自定义 JRDataSource 以编程方式填充。

问题是我需要知道报告中存在哪些元素，以便我可以调用相应的 WebServices，所以我的问题是：*我如何以编程方式，在 Java 中，阅读报告，以便我可以识别需要的每个元素被填满？*

报告不能全部以编程方式制作，因为它们的布局会不断变化，而且我们不能在每次发生这种变化时更新我们的软件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:52:55.177

由于它是 XML，您当然可以阅读所有内容并解析您的信息。

由于 JasperReports反过来工作，通过 JRDataSource*提取*数据，而不是结构化数据*推送*，控制输出，如果您可以拦截数据源会更好。因此，如果您可以从数据源中获取所需的信息，则可以替换数据源（委托给原始数据源），或者进行 AOP。

*我不确定您的问题的确切要求。也许编辑你的答案到底是什么问题。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-04T08:34:14.253

使用以下代码管理获取报告所需的所有元素（字段）：

```
JasperReport report = (JasperReport) JRLoader.loadObjectFromFile(path + "MyTestReport.jasper");
JRField[] gf = report.getFields(); 
```

# jsf - 如何在 JSF 的 Tab 中包含表单页面

> ID：10431474
> 
> 赞同：0
> 
> 时间：2012-05-03T12:33:35.477
> 
> 标签：jsf, xhtml, facelets

在我的 JSF 页面中，我有 Tab。在选项卡内我有数据表和按钮。我的要求是当我单击选项卡内的按钮时，应该显示一个新的表单页面，并且应该隐藏数据表，并且在填写所有详细信息后，当我再次单击保存按钮时，数据表应该出现在该表单页面中。我正在使用 JSF2.0、PrimeFaces 3.2、DK 1.5 和 Tomcat 7。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T13:55:50.803

将它们都放在视图中并使用`rendered`属性在组件之间切换。

例如

```
<h:form>
    <h:panelGroup rendered="#{not bean.showForm}">
        <h:dataTable ... />
        ...
        <h:commandButton value="Submit table" action="#{bean.submitTable}">
            <f:ajax execute="@form" render="@form" />
        </h:commandButton>
    </h:panelGroup>

    <h:panelGroup rendered="#{bean.showForm}">
        <h:inputText ... />
        ...
        <h:commandButton value="Submit form" action="#{bean.submitForm}">
            <f:ajax execute="@form" render="@form" />
        </h:commandButton>
    </h:panelGroup>
</h:form> 
```

用这个在一个`@ViewScoped`bean中：

```
private boolean showForm;

public void submitTable() {
    // ...
    showForm = true;
}

public void submitForm() {
    // ...
    showForm = false;
} 
```

# windows-phone-7 - 应用程序进入后台时的导航事件

> ID：10431475
> 
> 赞同：1
> 
> 时间：2012-05-03T12:33:37.800
> 
> 标签：windows-phone-7, navigation

每当我将应用程序置于后台或调用选择器任务时，NavigateFrom 和（返回时）NavigateTo 事件都会触发。

我怎么知道我们什么时候真正导航到某个地方，或者应用程序什么时候进入后台？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T13:18:02.040

如果您的应用程序启动 OnNavigatedTo NavigationEventArgs NavigationMode 是新的，如果您的应用程序从墓碑恢复 OnNavigatedTo NavigationMode 又回来了，如果您在激活事件中的 App.xaml 中设置布尔值并检查是否设置了此布尔值，您可以确定您的应用程序是否正在从墓碑上回来。在墓碑上的 OnNavigatedFrom 中，NavigationEventArgs NavigationMode 是新的，而如果您按下后退按钮，NavigatedMode 又回来了，我不确定 OnNavigatedFrom 是否会出现任何其他状态。所以如果 OnNavigatedFrom NavigationMode 是新的，我猜你的应用程序正在墓碑化

# ruby-on-rails - Rails ActiveRecord 查询 - 来自实例变量的数组

> ID：10431477
> 
> 赞同：0
> 
> 时间：2012-05-03T12:33:56.947
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我有 2 个模型，响应和问题。一个问题有多个响应，因此每个响应都与一个 question_id 相关联。我想查询与@responses 对象中的响应相对应的问题，但我不确定语法。

```
@reponses = Response.find([1, 10])
@questions = Question.where(:id => [???]) 
```

我最初的想法是这样的，但是这种语法是错误的：

```
@reponses = Response.find([1, 10])
@questions = Question.where(:id => @responses.question_id) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T12:42:50.763

你非常接近......试试这个

```
@questions = Question.where(:id => @responses.map(&:question_id)) 
```

但我认为你应该在你的响应模型中使用范围

# sas - 在 SAS 数据集上使用 KEEP 选项会提高读取性能吗？

> ID：10431483
> 
> 赞同：5
> 
> 时间：2012-05-03T12:34:07.083
> 
> 标签：sas

假设我试图`var_1`在一个非常大的数据集（近 TB）中总结一个变量（称为它）。数据集既长又宽。我的代码如下所示：

```
PROC MEANS DATA=my_big_dataset SUM;
    VAR var_1;
RUN; 
```

`KEEP`通过使用正在读取的数据集上的选项，我会获得任何性能提升吗？那是：

```
PROC MEANS DATA=my_big_dataset (KEEP=var_1) SUM;
    VAR var_1;
RUN; 
```

在磁盘 I/O 方面，我认为无论如何都必须完整读取每条记录。但也许需要分配更少的内存来读取记录。任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T19:44:40.780

是的，它确实有所作为。大多数情况下差异不大，但如果您开始拥有非常宽或非常长的数据集，您将开始看到一些好处。

`keep=`在下面的链接中搜索...

[http://support.sas.com/techsup/technote/ts298.html](http://support.sas.com/techsup/technote/ts298.html)

如果您遇到性能问题，那么这可能会使您正在做的事情减少几分之一或几秒钟，但它不会将您的处理时间减少一半。如果需要，请寻找其他优化技术。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T12:53:30.663

就数据步而言，除非您指定 DROP 或 KEEP 语句，否则所有变量都将被读入 PDV。

对于过程，我*希望*SAS 足够聪明，只能读取过程中使用的任何变量。也许有人可以证实这一点？

您可以轻松地构建一些测试来确定这一点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-03T14:27:05.930

我没有发现任何迹象表明 KEEP 语句对于 PROC MEANS 更有效（或必要）。

但是，您可以使用[WHERE](http://support.sas.com/resources/papers/proceedings10/097-2010.pdf)语句以及在 MEANS 代码中使用其他[OPTIONS来提高效率。](http://www.lexjansen.com/wuss/2007/CodersCorner/COD_Elkin_WritingALean.pdf)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-04T08:16:16.227

我认为 where 语句通常比 keep 选项更有效。 **但**在这种情况下， where 是无用的，我不确定在 proc 调用中添加 keep 选项会改变什么。

但是您可以在日志中测试和检查处理时间。让我们知道！

编辑：

我对我拥有的最大数据集之一进行了测试。使用保留选项我得到：0.03 处理时间没有保留选项我得到：0.01 处理时间

所以我猜 SAS 已经针对这种情况进行了优化。

# linux - count.sh：第 13 行：意外标记“完成”附近的语法错误

> ID：10431485
> 
> 赞同：0
> 
> 时间：2012-05-03T12:34:08.470
> 
> 标签：linux, shell

我被要求编写一个 shell 脚本来计算当前目录中所有“.cpp”中的行数。

但是，在运行我的 shell 脚本时，它说`count.sh: line 13: syntax error near unexpected token "done"`
我不知道​​出了什么问题。

谁能告诉我如何解决这个问题？谢谢你的帮助。

```
#!/bin/bash

summary=0
for i in $(find . -name *.cpp -print) 
do
count=$(wc -l $i)
let summary+=count
if [$count -eq 1]
then 
    echo "$i : $count line"
elif [$count -gt 1]
    echo "$i : $count lines"        
done

if [$summary -eq 1]
then 
echo "TOTAL: $summary   line"

elif [$summary -gt 1]
echo "TOTAL: $summary   lines" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T12:35:30.187

你`fi`在`done`. 您必须`if`以 a 结束语句`fi`，然后`done`才能结束`for`循环。

示例：**UPDATE**以下示例并不是使该脚本正确所需的全部内容。我把它留在这里，因为这是 OP 看到的“初始”错误的原因。继续阅读以获取更多修复。

```
for i in $(find . -name *.cpp -print) 
do
  count=$(wc -l $i)
  let summary+=count
  if [$count -eq 1]
  then 
      echo "$i : $count line"
  elif [$count -gt 1]
      echo "$i : $count lines"        
  fi
done 
```

此外，也许这只是一个复制/粘贴错误，但在您的代码/脚本结束时，您完全缺少`fi`.

您的脚本中有几个错误。首先，这是正确的版本：

```
for i in $(find . -name *.cpp -print)
do
     count=$(wc -l $i | cut -f1 -d' ')
     let summary+=$count
     if [ $count -eq 1 ];
     then
       echo "$i : $count line"
     elif [ $count -gt 1 ];
     then
       echo "$i : $count lines"
     fi
done 
```

修复：

*   的输出`wc -l`是 like `12 ./filename`，因此要仅使用行数，您必须提取它。我用于`cut`那个目的。
*   该`let`命令要求您实际添加文字值或变量。因此，您需要使用`$count`而不只是`count`，这只是字符串计数，不能添加到其他内容中。
*   你需要把`;`测试条件放在后面。
*   你需要引入一个`elif`带有 的块`then`，就像`if`块本身一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:37:41.050

```
if [$count -eq 1]
then 
    echo "$i : $count line"
elif [$count -gt 1]
    echo "$i : $count lines"
done 
```

应该

```
if [$count -eq 1]
then 
    echo "$i : $count line"
elif [$count -gt 1]
    echo "$i : $count lines"
fi                           # << this line is new
done 
```

# flash - XMLSocket“加载策略文件失败”错误

> ID：10431487
> 
> 赞同：0
> 
> 时间：2012-05-03T12:34:12.730
> 
> 标签：flash, xmlsocket

我正在尝试使用 XMLSocket.swf 文件，但它没有连接。我需要在我的服务器上打开一个端口吗？我正在尝试在专用的远程 Windows 2008 服务器上运行它。

这是来自 FlashFirebug 的错误：

```
OK: Root-level SWF loaded: file:///C|/Users/vcaadmin/AppData/Roaming/Mozilla/Firefox/Profiles/70vbx4ys.default/extensions/flashfirebug%40o%2Dminds.com/chrome/content/flashfirebug.swf

OK: Root-level SWF loaded: http://speak-tome.com/flash/XMLSocket.swf

OK: Searching for <allow-access-from> in policy files to authorize data loading from resource at xmlsocket://speak-tome.com:9997 by requestor from http://speak-tome.com/flash/XMLSocket.swf

Error: Failed to load policy file from xmlsocket://speak-tome.com:9997

Error: Request for resource at xmlsocket://speak-tome.com:9997 by requestor from http://speak-tome.com/flash/XMLSocket.swf has failed because the server cannot be reached. 
```

我的 crossdomain.xml 保存到 web 目录的根目录，如下所示：

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM "http://www.adobe.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
<site-control permitted-cross-domain-policies="master-only"/>
<allow-access-from domain="*"/>
<allow-http-request-headers-from domain="*" headers="SOAPAction"/>
</cross-domain-policy> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T19:59:31.430

我认为答案的第一部分是您需要使用 xmlsocket 策略服务器，如[本答案](https://stackoverflow.com/questions/2181320/help-with-cross-domain-file-for-actionscript-3-socket)中所述。

# html - 如何结合 KnockoutJS 与 HTML 标签 - 特别是 BootStrap

> ID：10431488
> 
> 赞同：0
> 
> 时间：2012-05-03T12:34:13.517
> 
> 标签：html, knockout.js

我一直在使用 Bootstrap 并且喜欢它。节省了我很多时间。我刚从 KnockoutJS 开始，碰巧我必须在一个相当细粒度的级别上将两者结合起来。我的淘汰赛对象正在填写结果表。当我只想要值（如名称）时，它工作得很好。但是，我想在我的链接前面放一个图标（Bootstrap 人的图标铅笔），这样它就可以作为编辑的东西脱颖而出。我正在使用 ASP.Net（不是 MVC），但我怀疑这不是问题。

这是一些有效的代码（但没有图标）：

```
<asp:LinkButton ID="lbtEditGenerator" runat="server" data-bind="text: GeneratorName, click: function() { EditGeneratorClick(GeneratorID) }"></asp:LinkButton> 
```

但是，我想在“GeneratorName”前面添加以下代码以获得铅笔图标。我需要它在 text 属性中，所以它是 LinkBut​​ton 的一部分：

```
<i class='icon-pencil'></i> 
```

在绑定数据中组合它们（如下）会引发解析错误：

```
<asp:LinkButton ID="lbtEditGenerator" runat="server" data-bind="text: <i class='icon-pencil'></i> GeneratorName, click: function() { EditGeneratorClick(GeneratorID) }"></asp:LinkButton> 
```

除了在我的对象上创建一个结合了这两个值的新属性之外，还有没有办法通过 Knockout 绑定来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-04T00:53:54.547

你有没有尝试过这些方面的东西：

```
<asp:LinkButton ID="lbtEditGenerator" runat="server" click: function() { EditGeneratorClick(GeneratorID) }">
    <i class='icon-pencil'></i>
    <span data-bind="text: GeneratorName"></span>
</asp:LinkButton> 
```

或者，您可以将`<i>`元素放在`<asp:LinkButton>`. 上面的解决方案允许您单击图标或文本来触发按钮。

# php - Yii 中 XUpload 的附加字段

> ID：10431491
> 
> 赞同：2
> 
> 时间：2012-05-03T12:34:24.370
> 
> 标签：php, yii, yii-xupload

我是 Yii 框架的新手，我使用[yii xupload](http://www.yiiframework.com/extension/xupload/)扩展来上传多个文件。它工作正常。现在，我的问题是我不知道如何使用此 xupload 表单添加其他字段，例如标题（文本字段）、类别（列表框）。请帮忙。

我的代码是，

```
$this->widget('xupload.XUpload', array(
                'url' => Yii::app()->createUrl("site/upload"),
                'model' => $model,
                'attribute' => 'file',
                'multiple' => true,
)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T22:22:56.263

[XUpload](http://www.yiiframework.com/wiki/395/additional-form-data-with-xupload/)的附加表单数据是一个 wiki，它准确地描述了如何做你想做的事

# php - 从字符串中提取住所和手机号码

> ID：10431492
> 
> 赞同：1
> 
> 时间：2012-05-03T12:34:29.627
> 
> 标签：php, string

我有以下格式的字符串：

```
$string="(R)66325xxx,66315xxx (M)9908717xxx,9441253xxx (O)40506xxx"; 
```

用逗号隔开的数字后跟（R）、（M）、（O）分别是住宅号码、手机号码和办公号码。

例如：住宅号 1=66325xxx 住宅号 2=66315xxx

手机号码1=9908717xxx 手机号码2=9441253xxx

办公号码1=40506070

我想从输入字符串中提取住所、手机和办公室号码到一个数组中，如下所示：

```
$residencenumber=array(66325xxx,66315xxx)
$mobilenumber = array(9908717xxx,9441253xxx)
$officenumber = array(40506xxx) 
```

谁能帮我从输入字符串创建数组。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:44:39.083

你可以做：

```
$string="(R)66325xxx,66315xxx (M)9908717xxx,9441253xxx (O)40506xxx";
$temp = explode(' ', $string);

$residentnumber = explode(',', str_replace('(R)', '', $temp[0]));
$mobilenumber = explode(',', str_replace('(M)', '', $temp[1]));
$officenumber = explode(',', str_replace('(O)', '', $temp[2]));

print_r($residentnumber);
print_r($mobilenumber);
print_r($officenumber); 
```

**结果：**

```
Array
(
    [0] => 66325xxx
    [1] => 66315xxx
)
Array
(
    [0] => 9908717xxx
    [1] => 9441253xxx
)
Array
(
    [0] => 40506xxx
) 
```

# c++ - 如何通过首先检查是否使用 New() 初始化 vtk 对象来删除它们？

> ID：10431500
> 
> 赞同：0
> 
> 时间：2012-05-03T12:34:57.037
> 
> 标签：c++, class, vtk, delete-operator

我有一个 vtk 项目，其中很多 vtk 对象被构造为私有成员。在 .h 文件中，我初始化 vtk 对象，如下所示：

```
vtkSmoothPolyDataFilter *m_SmoothFilter;
vtkDecimatePro *m_DecimatePro;
vtkCleanPolyData *m_CleanPolyData; 
```

在运行时，其中一些对象是用 New() 命令初始化的，但其中一些不是。由于我不能使用智能指针（由于我的 UI 包无法使用），我必须在析构函数中删除这些对象。我必须使用一些布尔检查系统来了解它们是否已初始化：

```
if(m_SmoothFilter)
   m_SmoothFilter->Delete()
if(m_DecimatePro)
   m_DecimatePro->Delete() 
```

但是这段代码摘录没有检测对象是否被初始化。我该怎么做这个检查？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:40:43.477

将所有指针初始化为零或使用 new 创建的实际对象。然后你的 C++ delete 可以在没有任何 if 的情况下删除（可以删除零指针）。我不确定您上面的 Delete() 是做什么的。

# jquery - ajax - 查看不同的内容

> ID：10431508
> 
> 赞同：1
> 
> 时间：2012-05-03T12:35:35.730
> 
> 标签：jquery, html, ajax, mime-types

我想在同一页面中听音乐或观看视频（无需在浏览器中打开新页面）。所以我想为此目的使用ajax。我有不同的文件，我想对它们做些什么取决于它的类型。例如，我有`1.mp3`- 听，`2.avi`- 看，`3.png`- 看。如果我单击 href，我需要有相同的行为。`<a href="http://server.com/3.png" target="blank"></a>`- 它打开新页面并加载`3.png`。请帮我！谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:51:06.673

这个怎么样：

```
<div id="contentdiv" style="display:none">
<iframe id="contentframe"></iframe>
</div>

<script>
$(document).ready(function(){
 $('a').click(function(){
   var hreflink = $(this).attr('href');
   $('#contentframe').attr('src',hreflink);
   $('#contentdiv').show();
   return false;
 });
});
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:43:31.607

为您的内容创建单独的类：

```
<a href="http://server.com/1.png" target="blank" class='png'></a>
<a href="http://server.com/2.avi" target="blank" class='avi'></a>
<a href="http://server.com/3.mp3" target="blank" class='mp3'></a>

Now code in individual classes as

$('.png').click(function(){
 alert('png');
});
$('.avi').click(function(){
 alert('png');
});
$('.mp3').click(function(){
 alert('mp3');
}); 
```

**或者**

```
$('a').click(function(){
   var ext=$(this).attr('href').val().substring($(this).attr('href').val().lastIndexOf('.')+1).toLowerCase();
   if(ext=='png'){
     //code for png
   } //and so on
}) 
```

# ssl-certificate - 未找到 [/crls/secureca.crl] 的映射

> ID：10431512
> 
> 赞同：4
> 
> 时间：2012-05-03T12:35:43.900
> 
> 标签：ssl-certificate, hosts, verisign, ipfw

这是在测试 J2EE Spring 应用程序时在 Jetty 本地 Web 服务器的控制台中多次出现的内容。

```
2012-05-03 14:28:14,716 WARN [org.springframework.web.servlet.PageNotFound]
- <No mapping found for HTTP request with URI [/crls/secureca.crl] 
in DispatcherServlet with name 'DefaultServlet'> 
```

我已经像这样设置了我的本地主机（OSX）：

```
sudo ipfw add 100 fwd 127.0.0.1,8080 tcp from any to any 80 in 
```

将所有请求从 :80 转发到 :8080 到 localhost/127.0.0.1

有谁知道这是否是严重的错误/警告以及如何摆脱它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-03T12:44:22.983

我的错误，我得到了（只有上帝知道为什么）`/private/etc/hosts`

```
127.0.0.1 crl.verisign.com
127.0.0.1 crl.geotrust.com 
```

因此，如果有人遇到同样的问题，只需检查您的**主机文件**中的`crl, verisign, geotrust`关键字并禁用或删除匹配的行。

*   请注意，**hosts 文件中的注释**是这样工作的
    *   `#127.0.0.1 crl.geotrust.com`

# python - 如何使用 pympler 跟踪/修复 tornado-redis 中的内存泄漏？

> ID：10431516
> 
> 赞同：7
> 
> 时间：2012-05-03T12:36:13.243
> 
> 标签：python, redis, tornado, memory-profiling

我一直在尝试使用[tornado-redis](https://github.com/leporo/tornado-redis)（它基本上是[brükva](https://github.com/evilkost/brukva)的一个分支，经过稍微修改后可以使用 tornado.gen 接口而不是 adisp），以便通过使用[redis 的 pubsub](http://redis.io/topics/pubsub)来传递事件。

所以我写了一个小脚本来测试[这个例子](https://github.com/leporo/tornado-redis/blob/master/demos/websockets/app.py)的启发。

```
import os

from tornado import ioloop, gen
import tornadoredis

print os.getpid()

def on_message(msg):
    print msg

@gen.engine
def listen():
    c = tornadoredis.Client()
    c.connect()
    yield gen.Task(c.subscribe, 'channel')
    c.listen(on_message)

listen()

ioloop.IOLoop.instance().start() 
```

不幸的是，当我`PUBLISH`编辑通过`redis-cli`内存使用不断上升。

为了分析内存使用情况，我首先尝试使用[guppy-pe](http://pypi.python.org/pypi/guppy/)但它在 python 2.7 下不起作用（是的，甚至尝试过trunk）所以我回到了[pympler](http://pypi.python.org/pypi/Pympler)。

```
import os

from pympler import tracker
from tornado import ioloop, gen
import tornadoredis

print os.getpid()

class MessageHandler(object):

    def __init__(self):
        self.memory_tracker = tracker.SummaryTracker()

    def on_message(self, msg):
        self.memory_tracker.print_diff()

@gen.engine
def listen():
    c = tornadoredis.Client()
    c.connect()
    yield gen.Task(c.subscribe, 'channel')
    c.listen(MessageHandler().on_message)

listen()

ioloop.IOLoop.instance().start() 
```

现在每次我`PUBLISH`编辑我都可以看到一些对象从未被释放：

```
 types |   # objects |   total size
===================================================== | =========== | ============
                                                 dict |          32 |     14.75 KB
                                                tuple |          41 |      3.66 KB
                                                  set |           8 |      1.81 KB
                                       instancemethod |          16 |      1.25 KB
                                                 cell |          22 |      1.20 KB
                          function (handle_exception) |           8 |    960     B
                                     function (inner) |           7 |    840     B
                                            generator |           8 |    640     B
                             <class 'tornado.gen.Task |           8 |    512     B
                           <class 'tornado.gen.Runner |           8 |    512     B
  <class 'tornado.stack_context.ExceptionStackContext |           8 |    512     B
                                                 list |           3 |    504     B
                                                  str |           7 |    353     B
                                                  int |           7 |    168     B
                           builtin_function_or_method |           2 |    144     B
                                                types |   # objects |   total size
===================================================== | =========== | ============
                                                 dict |          32 |     14.75 KB
                                                tuple |          42 |      4.23 KB
                                                  set |           8 |      1.81 KB
                                                 cell |          24 |      1.31 KB
                                       instancemethod |          16 |      1.25 KB
                          function (handle_exception) |           8 |    960     B
                                     function (inner) |           8 |    960     B
                                            generator |           8 |    640     B
                             <class 'tornado.gen.Task |           8 |    512     B
                           <class 'tornado.gen.Runner |           8 |    512     B
  <class 'tornado.stack_context.ExceptionStackContext |           8 |    512     B
                                               object |           8 |    128     B
                                                  str |           2 |    116     B
                                                  int |           1 |     24     B
                                                types |   # objects |   total size
===================================================== | =========== | ============
                                                 dict |          32 |     14.75 KB
                                                tuple |          42 |      4.73 KB
                                                  set |           8 |      1.81 KB
                                                 cell |          24 |      1.31 KB
                                       instancemethod |          16 |      1.25 KB
                          function (handle_exception) |           8 |    960     B
                                     function (inner) |           8 |    960     B
                                            generator |           8 |    640     B
                             <class 'tornado.gen.Task |           8 |    512     B
                           <class 'tornado.gen.Runner |           8 |    512     B
  <class 'tornado.stack_context.ExceptionStackContext |           8 |    512     B
                                                 list |           0 |    240     B
                                               object |           8 |    128     B
                                                  int |          -1 |    -24     B
                                                  str |           0 |    -34     B 
```

现在我知道确实存在内存泄漏，我如何跟踪这些对象的创建位置？我想我应该从[这里](https://github.com/leporo/tornado-redis/blob/master/tornadoredis/client.py#L863-L891)开始？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-02T16:45:52.700

将 Tornado 升级到 2.3 版应该可以解决这个问题。

我遇到了同样的问题，ExceptionStackContext 泄漏得非常快。它与此错误报告有关：[https](https://github.com/facebook/tornado/issues/507) ://github.com/facebook/tornado/issues/507并在此提交中修复： [https](https://github.com/facebook/tornado/commit/57a3f83fc6b6fa4d9c207dc078a337260863ff99) ://github.com/facebook/tornado/commit/57a3f83fc6b6fa4d9c207dc078a337260863ff99 。升级到 2.3 为我解决了这个问题。

# css - css 星号选择器支持

> ID：10431524
> 
> 赞同：0
> 
> 时间：2012-05-03T12:36:33.400
> 
> 标签：css, selector

这是对 * 选择器的合法使用吗？如果是，是否有关于浏览器如何支持它的参考资料？它似乎适用于我测试过的所有浏览器，但我没有使用过旧的浏览器或 IE

```
body * {
   float: left;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:43:24.637

是的，但你应该避免使用它。你可以说得更清楚。但是，如果您真的希望所有元素都向左浮动，这是一个很好的方法。但是你为什么要这个？

所有浏览器都支持这个，来源：[http ://www.quirksmode.org/css/contents.html#t10](http://www.quirksmode.org/css/contents.html#t10)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:38:48.783

是的，您的示例是合法的，如果不是严厉使用`*`选择器的话。这将导致 body 元素的每个子元素都向左浮动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T12:46:28.500

是的！星号是一个通配符，它​​将选择您设置的 DOM 元素中的所有元素。

例如，如果我想将属性应用于整个站点：

```
* {
    attribute: value;
} 
```

或者就像你用一个特殊的 DOM 元素做的那样！

```
 element * {
     attribute: value;
    } 
```

你也可以使用类似的东西：

```
* { 
     attribute: value;
  }

* * { ... }

* * * { ... }

* div * { ... } 
```

这有点困难......就像递归一样。

# c# - 使用夹在客户端和服务器之间的交换机跟踪 IP 地址

> ID：10431525
> 
> 赞同：1
> 
> 时间：2012-05-03T12:36:34.087
> 
> 标签：c#, .net, ip

有两个应用程序服务器（IIS）。有一个交换机或一个虚拟 IP 可以对 2 个服务器的请求进行负载平衡。

我需要从我的 .NET 应用程序中跟踪请求者（客户端）IP 地址。

代码`Request.ServerVariables["REMOTE_ADDR"]`给出了交换机的 IP 地址。

请求首先命中交换机，然后请求被转移到任一服务器，在此过程中，我的应用程序正在获取该代码的交换机 IP 地址，并且客户端 IP 被屏蔽。

# iphone - iPhone 中的 GDataXml 解析问题

> ID：10431526
> 
> 赞同：0
> 
> 时间：2012-05-03T12:36:39.577
> 
> 标签：iphone, xml, parsing, gdataxml

这是下面的代码，我需要在 iOS 中使用 GDataXml 解析部分和公司子数据。

```
-<MainList>
    <FirstMessage>Right</FirstMessage>
    <SecondMessage>Wrong</SecondMessage>
    <Status>0</Status>
   -<CompanyList>
     -<Company>
         <Address1>12447 Hedges Run Drive</Address1>
         <Address2>#B-1 </Address2>
         <City>Lake Ridge</City> 
         <CompanyName>Starbucks</CompanyName>
         <CreatedBy>example@example.com</CreatedBy>
     -</Company>
      -<Company>
         <Address1>12447 Hedges Run Drive</Address1>
         <Address2>#B-1 </Address2>
         <City>Lake Ridge</City>
         <CompanyName>Starbucks</CompanyName>
         <CreatedBy>example@example.com</CreatedBy>
      -</Company>
   </CompanyList>
</MainList> 
```

这是我的尝试，我一切都很好，但我在 NSArray arr 中一无所获。

```
 NSArray *channels = [rootElement elementsForName:@"CompanyList"];  
  for (GDataXMLElement *icon in channels) {  
  NSArray *arr = [icon elementsForName:@"Company"];  
  if ([arr count]>0)  
  {  
        NSlog(@"Done");  
  }  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-07T09:32:26.140

大家好，我发现如下

GDataXMLDocument *xmlDocument = [[GDataXMLDocument alloc]initWithData:xmlData options:0 error:&error];

```
NSLog(@"Error:%@",[error description]);

NSArray *getData = [[xmlDocument rootElement]elementsForName:@"CompanyList"];
NSArray  *tempArray = [[NSMutableArray alloc]init];

for(GDataXMLElement *e in getData)
{

    NSArray *el = [e elementsForName:@"Company"];

    for (GDataXMLElement *e in el) {
        static int count =0;
        NSString    *testString = [[[e elementsForName:@"Address1"] objectAtIndex:0] stringValue];
        NSLog(@"Company  %d  : %@",count+1, testString);

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:39:56.970

看到这个答案，这个答案对你有帮助。 [NSXMLParser 示例](https://stackoverflow.com/a/4706056/932011)

# objective-c - 与 UIButton 对象一起识别滑动方向

> ID：10431532
> 
> 赞同：1
> 
> 时间：2012-05-03T12:36:51.967
> 
> 标签：objective-c, ios, uiswipegesturerecognizer

我需要识别执行滑动的方向并知道我视图中的哪个对象发送了它。我现在找到了解决方法，但它看起来很复杂而且很可怕，所以我怀疑有没有最简单的解决方案？我的解决方法是几句话：

1.  我将识别器附加到视图上的每个 UIButton 对象。
2.  有指示器显示在执行滑动期间点击了哪个按钮
3.  我必须检查这个指示器并滑动方向以做出正确的决定，应该移动哪个对象以及它应该向哪个方向移动。

谢谢你的建议。

```
@synthesize 滑动方向；//显示滑动方向的标签
@synthesize 按钮编号；//标签显示被点击的按钮数量

    - (void)viewDidLoad
    {
        UIButton* 按钮 = [UIButton buttonWithType:UIButtonTypeRoundedRect]; //创建按钮       
        [按钮 setTitle:@"test1" forState:UIControlStateNormal];                        
        button.frame = CGRectMake(100, 100, 100, 100);
        [button addTarget:self //添加选择器，它将更新指示器被点击的按钮，没有点击按钮无法进行滑动
                   动作：@选择器（更新按钮编号：）
         forControlEvents:UIControlEventTouchDown];
        [按钮设置标签：1]；
        [self.view addSubview:button]; //添加按钮查看
        [self beginListenToSwipes:button]; //向方法发送按钮，该方法将为 4 个方向添加 UISwipeGestureRecognizer

        /*第二个按钮的相同任务*/
        UIButton* button1 = [UIButton buttonWithType:UIButtonTypeRoundedRect];            
        [button1 setTitle:@"test2" forState:UIControlStateNormal];                        
        button1.frame = CGRectMake(200, 200, 100, 100);
        [button1 addTarget：自我                         
                   动作：@选择器（更新按钮编号：）
         forControlEvents:UIControlEventTouchDown];
        [button1 setTag:2];
        [self.view addSubview:button1];
        [self beginListenToSwipes:button1];

    }

    /*每次我们点击按钮（开始滑动时调用此方法并且buttonNumber总是指向当前按钮*/
    -(void)updateButtonNumber:(UIButton*)sender
    {
        self.buttonNumber.text = [NSString stringWithFormat:@"%d",sender.tag];
    }

    /*方法接收 UIButton 并添加识别器*/
    - (void) beginListenToSwipes:(UIButton*)sender
    {
        UISwipeGestureRecognizer *recognizer;
        识别器 = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(handleSwipe:)];
        [识别器设置方向：（UISwipeGestureRecognizerDirectionRight）]；
        [发送者 addGestureRecognizer:recognizer];

        识别器 = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(handleSwipe:)];
        [识别器设置方向：（UISwipeGestureRecognizerDirectionLeft）]；
        [发送者 addGestureRecognizer:recognizer];

        识别器 = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(handleSwipe:)];
        [识别器设置方向：（UISwipeGestureRecognizerDirectionUp）]；
        [发送者 addGestureRecognizer:recognizer];

        识别器 = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(handleSwipe:)];
        [识别器设置方向：（UISwipeGestureRecognizerDirectionDown）]；
        [发送者 addGestureRecognizer:recognizer];
    }

    /*滑动执行时调用的方法并显示执行的方向*/
    -(void)handleSwipe:(UISwipeGestureRecognizer *)recognizer
    {
        int i = 识别器.方向；
        self.swipeDirection.text = [NSString stringWithFormat:@"%d",i];
    }

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T13:19:12.430

我的想法是，

1.  注册`touchUpoutside`UIButton 的事件。
2.  当您将手指移出按钮时，它将被触发。
3.  从 touchesEnded 方法中找到接触点并存储在类级变量中。
4.  比较`touchupoutside`方法中的按钮框和触摸点，找出移动的方向。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T13:07:32.177

我想你也可以把你的手势识别器放在 self.view 中，然后看看手势是否发生在有问题的控件上（显然，你想让你的按钮 ivars 或你的 viewcontroller 的属性，这样你就可以跟踪这是哪个），例如

```
CGPoint point = [sender locationInView:self.view];
if (CGRectContainsPoint(button1.frame, point))
    // do whatever you want 
```

是否在 UIGestureRecognizerStateBegan 或 UIGestureRecognizerStateEnded 或两者都执行此逻辑取决于您。

**更新：**

顺便说一句，如果您正在检测您正在移动的方向，您还可以考虑使用 UIPanGestureRecognizer，它在单个手势识别器中处理所有四个方向（并且因为它是连续的，您可以在UI 动画移动）。

# c# - C# Facebook SDK - 如何使用 Web 表单来服务器端授权画布应用程序

> ID：10431539
> 
> 赞同：0
> 
> 时间：2012-05-03T12:37:29.677
> 
> 标签：c#, facebook, sdk, authorization, token

MVC 中有很多示例应用程序，但我正在处理的当前项目要求我使用 Web 表单。

我可以使用 javascript 方法授权应用程序，但我想使用服务器端。以下是我在 page.load 上开始的内容

```
dynamic parameters = new ExpandoObject();
parameters.client_id = AppId;
parameters.client_secret = appSecret;
parameters.response_type = "code";
//parameters.state = state;
parameters.redirect_uri = "http://fb.local/page.aspx";

// The requested response: an access token (token), an authorization code (code), or both (code token).
parameters.response_type = "token";

// list of additional display modes can be found at http://developers.facebook.com/docs/reference/dialogs/#display
//parameters.display = "popup";

// add the 'scope' parameter only if we have extendedPermissions.
if (!string.IsNullOrWhiteSpace(ExtendedPermissions))
parameters.scope = ExtendedPermissions;

// generate the login url
var fb = new FacebookClient();
var loginUrl = fb.GetLoginUrl(parameters);

Response.Redirect(loginUrl.AbsoluteUri, true); 
```

我可以授权，但无法从 URL 获取访问令牌。

在下一页上，我可以查看源代码并在 url 栏中查看访问令牌，但我不确定如何将其放入代码中。一旦我有了令牌，我就准备好了。

```
page.aspx#access_token=AAACrxQhmdpY 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T09:06:18.897

我曾经在我的页面加载和工作时使用过这段代码，它不是一个非常干净的代码，但你可能会想出如何更改它以最好地使用它。所以算法是，当页面加载时，您使用 response.redirect 将用户重定向到 Facebook 身份验证页面，该字符串包含三个参数：您的应用 ID（appid），您要询问用户的权限（范围），您想要的位置Facebook 在授权后重定向用户，以及一个参数作为状态，我猜它应该是一个随机数。因此，在用户授权您的应用程序后，他/她将被重定向到您的页面，请求 URL 包含您准备 Facebook 时使用的相同状态（如果我猜有很多请求，您可以使用它来识别哪个请求是哪个请求）还有一个新的“代码”参数，您将其传递给 Facebook 以获取访问令牌，

```
 int intstate;
        string strstate;
        string redirecturltofb;
        string scope;
        string appid;
        code = Request.QueryString["code"];

        if (!String.IsNullOrWhiteSpace(code))
        {
            goto alireza; 
        }

        appid = "424047057656831";
        scope = "user_about_me,user_activities,user_groups,email,publish_stream,user_birthday";
        intstate = 45; 
        strstate = Convert.ToString(intstate);
        redirecturltofb = "https://www.facebook.com/dialog/oauth?client_id=" + appid + "&redirect_uri=http://test5-2.apphb.com/&scope=" + scope + "&state=" + strstate;
        Response.Redirect(redirecturltofb); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-18T11:41:03.900

您必须使用 Javascript SDK 将访问令牌返回给后面的代码。

在[http://csharpsdk.org/docs/web/getting-started](http://csharpsdk.org/docs/web/getting-started)中使用**FB.Init**

并在某些条件下发回以获得访问令牌。

谢谢，

达门德拉

# c++ - 从函数生成一个 char* 指针数组

> ID：10431541
> 
> 赞同：3
> 
> 时间：2012-05-03T12:37:30.483
> 
> 标签：c++

我有一个必须传递给它的 C++ 函数`char* arguments[]`。这个函数的原型如下： `void somefunc(char* arguments[])`

为了将上面的数组传递给这个函数，我从另一个函数生成这个数组，这个函数可以返回这个`char* array`输出，这看起来有点像这样。

```
char** genArgs(int numOfArgs,...)
{
    va_list argList;    
    char** toRet = new char*[numOfArgs];
    va_start (arguments, numOfArgs);
    for(int cnt = 0; cnt < numOfArgs ; ++cnt)
        toRet[cnt] = va_arg(argList, char*);

    va_end(arguments);
} 
```

我很困惑如何正确编写上述函数，因为我会将输入传递给类似的函数：`genArgs(3, a.c_str(), b.c_str(), c.c_str())`或者`genArgs(2, a.c_str(), b.c_str())`
如何在不使用 char** 的情况下生成上述 char* 数组（因为在返回之前必须将其删除从函数中避免内存泄漏）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T12:56:49.383

从您的声明来看`genArgs`，似乎每当您调用 时`genArgs`，您都知道要传递多少个参数。它是否正确？如果是这样（并且如果您正在使用`C++11`），那么您可以`std::array`在调用函数中使用。所以代替这个：

```
char** arglist = genArgs (4, "MyArg1", mYaRG2", "LastArg", 0) ;
somefunc (arglist) ;
delete[] arglist ; 
```

你可以这样做：

```
#include <array>
std::array<char*, 4> arglist { "MyArg1", mYaRG2", "LastArg", 0 } ;
somefunc (&arglist[0]) ; 
```

但是第一个解决方案确实没有什么问题，除非你是一个 C++ 苦行者。（但是，您确实需要`return toRet ;`声明`genArgs`！）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T12:47:34.357

> 必须在从函数返回之前删除 this 以避免内存泄漏

这并不完全正确：尽管您最终需要使用`delete[]`分配的指针，但您`new[]`不一定必须在退出分配发生的函数之前这样做。

你可以这样做：

```
// This allocates args; we now own the pointer
char **argsToPass = genArgs(2, a.c_str(), b.c_str());
// Make the call as usual
somefunc(argsToPass);
// Now that args are no longer needed, we delete them:
delete [] argsToPass; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:48:18.620

通常的方法是使用一个管理数组生命周期的对象（例如 a`std::vector<char*>`或 a `std::unique_ptr<char*[]>`），然后返回它（以便类型系统保证最终释放内存）：

```
std::vector<char*> genArgs(int numOfArgs,...)
{
    std::vector<char*> toRet;
    toRet.reserve(numOfArgs);
    va_list argList;
    va_start(argList, numOfArgs);
    for(int cnt = 0; cnt < numOfArgs ; ++cnt) {
        toRet.push_back(va_arg(argList, char*));
    }
    va_end(arguments);
    return toRet;
} 
```

要使用它，请执行以下操作：

```
somefunc(&genArgs(3, a.c_str(), b.c_str(), c.c_str()).front()); 
```

# django - Django 使用多少个线程/连接来进行 DML 查询？

> ID：10431543
> 
> 赞同：0
> 
> 时间：2012-05-03T12:37:36.240
> 
> 标签：django

django 使用多少个连接或数据库后端连接/线程来进行 DML 查询？如果用户有两个请求同时更改数据库中的数据（+- 0.3 秒），django 会让它们并行还是串行？还是取决于设置？如果有一个数据库和一个服务器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T13:42:06.510

[交易](https://docs.djangoproject.com/en/dev/topics/db/transactions/)。不，真的，[交易](https://docs.djangoproject.com/en/dev/topics/db/transactions/)。

# c# - 使用 XPath/HTML Agility Pack 提取所有包含特定关键字的 div

> ID：10431547
> 
> 赞同：0
> 
> 时间：2012-05-03T12:37:47.440
> 
> 标签：c#, html, xml, dom, xpath

我尝试使用 HTML Agility Pack 从 html(-->xml) 文档（如下）中提取数据。`div`包含“”的“ ”`id=dealId_*****`是相关的。我想我知道如何继续，当我弄清楚如何`div`用“ ”计算所有“ `id=dealId_*****`”时。我尝试使用 XPath 方法“ `starts-with`”，但它不起作用：

```
HtmlDocument doc = new HtmlDocument();
doc.LoadHtml(Sourcecode);

int numberOfDIVs;
numberOfDIVs = doc.DocumentNode.SelectNodes("//*[@id='jLocalDeals']/*[starts-with(@id, 'dealId_']").Count;

    <div id="jLocalDeals" class="dealsBlock" style="">
    <h1>
    <div id="dealId_5474417" class="jDeal LEISURE_OFFERS">
    <div id="dealId_5476688" class="jDeal SHOPPING">
    <div id="dealId_5445019" class="jDeal TICKETS1 RESTAURANT1">
    <div class="wrapper3Deals"></div>
    <div id="dealId_5474286" class="jDeal BEAUTY">
    <div id="dealId_5476685" class="jDeal LEISURE_OFFERS">
    <div id="dealId_5474466" class="jDeal SERVICES">
    <div class="wrapper3Deals"></div>
    <div id="dealId_5466810" class="jDeal BEAUTY">
    <div id="dealId_5425417" class="jDeal SERVICES">
    <div id="dealId_5474329" class="jDeal SHOPPING">
    <div class="wrapper3Deals"></div>
    <div id="dealId_5476703" class="jDeal SHOPPING">
    <div id="dealId_5476729" class="jDeal SHOPPING">
    <div id="dealId_5474702" class="jDeal HEALTHCARE">
    <div class="wrapper3Deals"></div>
    <div id="dealId_5444044" class="jDeal TRAVEL1" style="display: block;">
    <div id="dealId_5474444" class="jDeal LEISURE_OFFERS" style="display: block;">
    <div id="dealId_5473774" class="jDeal TRAVEL1" style="display: block;">
    <div class="wrapper3Deals"></div>
    </div> 
```

PS：不幸的是，我只能使用 .NET 2.0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T14:18:12.633

使用 contains() 函数：

```
//div[@id='jLocalDeals']//div[contains(@id,'dealId')] 
```

如果你想要一个快捷方式，你可以在 xpath 中使用 count() 函数：

```
count(//div[@id='jLocalDeals']//div[contains(@id,'dealId')]) 
```

此外，在您的 xpath 中，starts-with 不起作用的原因是因为您正在检查 的子项的 id `//div[@id='jLocalDeals']`，而不是其子项`<h1>`所在的`<div id="dealId_****"/>`位置。使用开头：

```
//div[@id='jLocalDeals']//div[starts-with(@id,'dealId')] 
```

或者

```
//div[@id='jLocalDeals']/*/*[starts-with(@id,'dealId')] 
```

希望这会有所帮助，如果我需要澄清任何事情，请告诉我......

# java - Java通信客户端/服务器

> ID：10431550
> 
> 赞同：1
> 
> 时间：2012-05-03T12:38:18.130
> 
> 标签：java, stream, client-server

这是在我的客户中：

```
public static void logIn(String name, String pass) {
try {
    Socket s = new Socket("localhost", 9000);
    PrintStream out = new PrintStream(s.getOutputStream());
    BufferedReader in = new BufferedReader(new InputStreamReader(s.getInputStream()));
    out.print(name + "," + pass);
    out.flush();
    out.close();

    System.out.println(in.readLine());

    in.close();
    s.close();
}
catch(UnknownHostException exp)
{
    exp.printStackTrace();

}
catch(java.io.IOException exp)
{
    exp.printStackTrace();
}   
} 
```

这是我在我的服务器上的：

```
 public static void main(String[] args){
 boolean clientExists=false;
 ArrayList<User> users = new ArrayList<User>();
 users.add(new User("jmeno","heslo"));
 ServerSocket ss;
 try {
    ss = new ServerSocket(9000);
    while(true) {
                clientExists=false;
        Socket s = ss.accept();
        BufferedReader in = new BufferedReader(new InputStreamReader(s.getInputStream()));
        PrintStream out = new PrintStream(s.getOutputStream());
        String xmlpacket="";
                String pom;

                while ((pom = in.readLine())!=null){
                     xmlpacket+=pom;
                     xmlpacket+="\n";
                }

                for(User us: users)
                    {
                            if(us.isUserNameAndPasswordRight(login, passwd))
                            {
                                    out.print("user is connected");
                                    out.flush();
                                    clientExists=true;
                            }
                    }
                }
                if(clientExist != true)
              out.print("bad login");
        out.flush();
        out.close();
        in.close();
        s.close();
}
catch(java.io.IOException exp)
{
    System.out.println("chyba u socketu!");
} 
```

}

可以这样工作吗？我无法使其正常工作，因为尝试从服务器读取答案时客户端出现异常。

编辑：这是堆栈跟踪：

```
java.net.SocketException: socket closed
    at java.net.SocketInputStream.socketRead0(Native Method)
    at java.net.SocketInputStream.read(Unknown Source)
    at java.net.SocketInputStream.read(Unknown Source)
    at sun.nio.cs.StreamDecoder.readBytes(Unknown Source)
    at sun.nio.cs.StreamDecoder.implRead(Unknown Source)
    at sun.nio.cs.StreamDecoder.read(Unknown Source)
    at java.io.InputStreamReader.read(Unknown Source)
    at java.io.BufferedReader.fill(Unknown Source)
    at java.io.BufferedReader.readLine(Unknown Source)
    at java.io.BufferedReader.readLine(Unknown Source)
    at client.client.logIn(client.java:79)

    at client.GUI.GUI.jMenuItem1ActionPerformed(GUI.java:379)
    at client.GUI.GUI.access$5(GUI.java:367)
    at client.GUI.GUI$5.actionPerformed(GUI.java:151)
    at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)
    at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.setPressed(Unknown Source)
    at javax.swing.AbstractButton.doClick(Unknown Source)
    at javax.swing.plaf.basic.BasicMenuItemUI.doClick(Unknown Source)
    at javax.swing.plaf.basic.BasicMenuItemUI$Handler.mouseReleased(Unknown Source)
    at java.awt.Component.processMouseEvent(Unknown Source)
    at javax.swing.JComponent.processMouseEvent(Unknown Source)
    at java.awt.Component.processEvent(Unknown Source)
    at java.awt.Container.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Window.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$000(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:43:26.743

试着拿走`out.close()`，看看会发生什么。我相信关闭`OutputStream`也会关闭相关的套接字。在您阅读回复之前，您不想这样做。

**更新**：为了清楚起见，我的意思是带走（或移到最后）`out.close()`客户端，而不是服务器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T12:55:48.327

'out.print(name + "," + pass);' 似乎没有发出行终止符，因此您的客户端中的“readLine()”将不会返回。尝试“println”并摆脱关闭的边缘。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-03T13:57:32.213

我做了几件事，所以给出所有的代码。

*   稍后放置缓冲的阅读器，以防止阻塞。
*   添加了编码，因此它不使用默认的操作系统编码（不同操作系统上的客户端）。
*   println io 打印了吗？
*   自动冲洗。
*   重要提示：没有 PrintStream 而是 PrintWriter。
*   xmlpacket 上没有循环；那是以后的代码。

    ```
    public static void logIn(String name, String pass) {
    try {
        Socket s = new Socket("localhost", 9000);
        //PrintStream out = new PrintStream(s.getOutputStream(), true, "UTF-8");
        PrintWriter out = new PrintWriter(new OutputStreamWriter(s.getOutputStream(), "UTF-8"), true);
        out.println(name + "," + pass);
        out.flush();

        BufferedReader in = new BufferedReader(new InputStreamReader(
                s.getInputStream(), "UTF-8"));

        System.out.println(in.readLine());

        out.close();
        in.close();
        s.close();
    } catch (UnknownHostException exp) {
        exp.printStackTrace();

    } catch (java.io.IOException exp) {
        exp.printStackTrace();
    }
    }

    public static void main(String[] args) {
    ArrayList<User> users = new ArrayList<User>();
    users.add(new User("jmeno", "heslo"));
    ServerSocket ss;
    try {
        ss = new ServerSocket(9000);
        while (true) {
            Socket s = ss.accept();
            System.out.println("Accept...");
            BufferedReader in = new BufferedReader(new InputStreamReader(
                    s.getInputStream(), "UTF-8"));
            PrintWriter out = new PrintWriter(new OutputStreamWriter(s.getOutputStream(), "UTF-8"), true);
            String xmlpacket = "";
            String pom;

            pom = in.readLine();
            //while ((pom = in.readLine()) != null) {
                xmlpacket += pom;
                xmlpacket += "\n";
            //}
            int commaPos = xmlpacket.indexOf(',');
            int newlinePos = xmlpacket.indexOf('\n');
            String login = xmlpacket.substring(0, commaPos);
            String passwd = xmlpacket.substring(commaPos + 1, newlinePos);                        

            boolean clientExists = false;
            for (User us : users) {
                if (us.isUserNameAndPasswordRight(login, passwd)) {
                    out.println("user is connected");
                    clientExists = true;
                    break;
                }
            }
            if (!clientExists)
                out.println("bad login");
            out.close();
            in.close();
            s.close();
        }
    } catch (java.io.IOException exp) {
        System.out.println("chyba u socketu!");
    }
    } 
    ```

# ruby-on-rails - Red Hat Open Shift 上的 ImageMagick 开发包

> ID：10431551
> 
> 赞同：0
> 
> 时间：2012-05-03T12:38:26.880
> 
> 标签：ruby-on-rails, imagemagick, paas, openshift

我的 RoR 应用程序需要 ImageMagick，因为我使用 rmagick 和carrierwave gems 来编辑图像。如何在 Open Shift 上安装它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:41:57.053

编辑：

如果您访问 ssh，您可以看到机器已经带有 ImageMagick：

```
[blog-fdiazgarrido.rhcloud.com ~]\> convert --version
Version: ImageMagick 6.5.4-7 2010-02-26 Q16 OpenMP http://www.imagemagick.org
Copyright: Copyright (C) 1999-2009 ImageMagick Studio LLC 
```

所以你唯一需要做的就是将它包含在你的 Gemfile 中，它会像所有其他 gem 一样被拾取

* * *

* * *

您必须首先使用该库：

```
up2date install ImageMagick 
```

或者

```
yum install ImageMagick 
```

如果你使用的是 yum

最后像这样安装gem

```
sudo gem install rmagick 
```

或者将它包含在您的 Gemfile 和运行包中

# c - 从函数发送指针

> ID：10431557
> 
> 赞同：0
> 
> 时间：2012-05-03T12:38:51.313
> 
> 标签：c, variables, pointers, parameter-passing

这只是我想知道的。好吧，假设我在函数中声明了一个变量，我将这个变量作为指向另一个函数的指针传递。当第一个函数（声明变量的地方）结束时，这个变量会发生什么？它是留在堆栈上还是在函数结束时被删除？

提前谢谢=D

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T12:42:02.310

当您定义变量的函数返回该变量时，该变量被销毁，*除非*您将其声明为静态的。检查 C 中的存储类。这是一个指针：[http ://aelinik.free.fr/c/ch14.htm](http://aelinik.free.fr/c/ch14.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:41:19.310

当第一个函数结束时，变量被销毁，因此指针变得无效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T12:43:59.860

如果您在堆栈上声明此变量，它将消失：

```
void foo()
{
    int varInStack;
    foo2(&varInStack);

    // when foo returns, you loosed your variable.
} 
```

您可以退货：

```
int foo()
{
    int varInStack;
    foo2(&varInStack);

    return varInStack;
} 
```

# swing - scala Swing中BoxPanel内元素之间的空间

> ID：10431558
> 
> 赞同：0
> 
> 时间：2012-05-03T12:39:00.827
> 
> 标签：swing, scala, layout

我正在尝试使用 BoxPanel（使用 BoxLayout）在 scala Swing 中布置组件。我想在组件之间添加一个空格。这样做的正常方法是`javax.component.Box.createVerticalStrut(...)`，但我无法将此方法调用创建的组件添加到 BoxPanel - 编译器抱怨找到`scala.swing.Component`时需要`java.awt.Component`。

[正如http://scala-programming-language.1934581.n4.nabble.com/How-to-add-a-plain-AWT-Component-to-a-Scala-Swing-container-td2325998.html](http://scala-programming-language.1934581.n4.nabble.com/How-to-add-a-plain-AWT-Component-to-a-Scala-Swing-container-td2325998.html)中指出的那样 ， Scala 不支持 awt 组件。

我还没有找到`scala.swing.Component`可以用于此目的的任何合适的子类。[http://www.scala-lang.org/api/current/scala/swing/Component.html](http://www.scala-lang.org/api/current/scala/swing/Component.html)

在 BoxPanel 中的元素之间添加空间的首选方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-27T14:25:44.433

您必须将其添加到 BoxPanel 的对等组件中，如下例所示：

```
new BoxPanel(Orientation.Vertical) {
    contents += new MyButton()
    peer.add(Box.createVerticalStrut(2))
    contents += new MyComponent()
} 
```

# java - 从 Commons HttpClient 迁移到 HttpComponents 客户端

> ID：10431561
> 
> 赞同：3
> 
> 时间：2012-05-03T12:39:22.603
> 
> 标签：java, apache-commons-httpclient, apache-httpclient-4.x

我想从 Commons HttpClient (3.x) 迁移到 HttpComponents Client (4.x) 但难以处理重定向。该代码在 Commons HttpClient 下可以正常工作，但在迁移到 HttpComponents Client 时会中断。一些链接得到了不受欢迎的重定向，但是当我将“http.protocol.handle-redirects”设置为“假”时，大量链接完全停止工作。

Commons HttpClient 3.x：

```
private static HttpClient httpClient = null;
private static MultiThreadedHttpConnectionManager connectionManager = null;
private static final long MAX_CONNECTION_IDLE_TIME = 60000; // milliseconds

static {
    //HttpURLConnection.setFollowRedirects(true);
    CookieManager manager = new CookieManager();
    manager.setCookiePolicy(CookiePolicy.ACCEPT_ALL);
    CookieHandler.setDefault(manager);

connectionManager = new MultiThreadedHttpConnectionManager();
connectionManager.getParams().setDefaultMaxConnectionsPerHost(1000); // will need to set from properties file
connectionManager.getParams().setMaxTotalConnections(1000);
httpClient = new HttpClient(connectionManager);
}

/*
* Retrieve HTML
*/  
public String fetchURL(String url) throws IOException{

    if ( StringUtils.isEmpty(url) )
        return null;

    GetMethod getMethod = new GetMethod(url);
    HttpClient httpClient = new HttpClient();
    //configureMethod(getMethod);
    //ObjectInputStream oin = null;
    InputStream in = null;
    int code = -1;
    String html = "";
    String lastModified = null;
    try {
      code = httpClient.executeMethod(getMethod);

      in = getMethod.getResponseBodyAsStream();
        //oin = new ObjectInputStream(in);
        //html = getMethod.getResponseBodyAsString();
        html = CharStreams.toString(new InputStreamReader(in));

    }

    catch (Exception except) {
    }
    finally {

      try {
        //oin.close();
        in.close();
      }
      catch (Exception except) {}

      getMethod.releaseConnection();
      connectionManager.closeIdleConnections(MAX_CONNECTION_IDLE_TIME);
    }

    if (code <= 400){
        return html.replaceAll("\\s+", " ");
    } else {
        throw new Exception("URL: " + url + " returned response code " + code);
    }

} 
```

HttpComponents 客户端 4.x：

```
private static HttpClient httpClient = null;
private static HttpParams params = null;
//private static MultiThreadedHttpConnectionManager connectionManager = null;
private static ThreadSafeClientConnManager connectionManager = null;
private static final int MAX_CONNECTION_IDLE_TIME = 60000; // milliseconds

static {
    //HttpURLConnection.setFollowRedirects(true);
    CookieManager manager = new CookieManager();
    manager.setCookiePolicy(CookiePolicy.ACCEPT_ALL);
    CookieHandler.setDefault(manager);

connectionManager = new ThreadSafeClientConnManager();
connectionManager.setDefaultMaxPerRoute(1000); // will need to set from properties file
connectionManager.setMaxTotal(1000);
httpClient = new DefaultHttpClient(connectionManager);

    // HTTP parameters stores header etc.
    params = new BasicHttpParams();
    params.setParameter("http.protocol.handle-redirects",false);

}

/*
* Retrieve HTML
*/  
public String fetchURL(String url) throws IOException{

    if ( StringUtils.isEmpty(url) )
        return null;

    InputStream in = null;
    //int code = -1;
    String html = "";

 // Prepare a request object
 HttpGet httpget = new HttpGet(url);
httpget.setParams(params);

 // Execute the request
 HttpResponse response = httpClient.execute(httpget);

 // The response status
 //System.out.println(response.getStatusLine());
int code = response.getStatusLine().getStatusCode();

 // Get hold of the response entity
 HttpEntity entity = response.getEntity();

 // If the response does not enclose an entity, there is no need
 // to worry about connection release
 if (entity != null) {

        try {
            //code = httpClient.executeMethod(getMethod);

            //in = getMethod.getResponseBodyAsStream();
            in = entity.getContent();
            html = CharStreams.toString(new InputStreamReader(in));

        }

        catch (Exception except) {
            throw new Exception("URL: " + url + " returned response code " + code);
        }
        finally {

            try {
                //oin.close();
                in.close();
            }
            catch (Exception except) {}

            //getMethod.releaseConnection();
            connectionManager.closeIdleConnections(MAX_CONNECTION_IDLE_TIME, TimeUnit.MILLISECONDS);
            connectionManager.closeExpiredConnections();
        }

    }

    if (code <= 400){
        return html;
    } else {
        throw new Exception("URL: " + url + " returned response code " + code);
    }

} 
```

我不想要重定向，但在 HttpClient 4.x 下，如果我启用重定向，那么我会得到一些不受欢迎的东西，例如 [http://www.walmart.com/](http://www.walmart.com/) => [http://mobile.walmart.com/](http://mobile.walmart.com/)。在 HttpClient 3.x 下，不会发生此类重定向。

在不破坏代码的情况下，我需要做什么才能将 HttpClient 3.x 迁移到 HttpClient 4.x？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T06:17:52.897

这不是 HttpClient 4.x 的问题，可能是目标服务器处理请求的方式，因为用户代理是 httpclient，它可以作为移动设备处理（目标服务器可能会考虑其他可用浏览器，例如 chrome、mozilla等作为移动设备。）

请使用以下代码手动设置

```
 httpclient.getParams().setParameter(
            org.apache.http.params.HttpProtocolParams.USER_AGENT,
            "Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.2) Gecko/20100316 Firefox/3.6.2"
        ); 
```

# jquery - jQuery毫秒计时器？

> ID：10431562
> 
> 赞同：3
> 
> 时间：2012-05-03T12:39:23.013
> 
> 标签：jquery

是否可以以类似于 10 毫秒的间隔进行更新。我用了

```
window.setInterval(timeUpdate,20); 
```

这是可能的还是浏览器的线程有某种最短期限？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T12:43:32.247

取决于浏览器，它的版本，如果有焦点在选项卡上，计时器分辨率可能会有所不同。有关更多详细信息，请查看以下[参考](https://developer.mozilla.org/en/DOM/window.setTimeout)，尤其是[最小延迟和超时嵌套](https://developer.mozilla.org/en/DOM/window.setTimeout#Minimum_delay_and_timeout_nesting)部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:47:19.387

可以设置一个非常小的间隔（例如 1 ms）；然而，大多数浏览器都有一个最小的计时器粒度，通常在 4-50 毫秒之间；特殊情况可能适用于非活动浏览器视图/选项卡/窗口。

所以：函数调用是正确的，并且会成功完成，但不要指望你实际上*会得到*那么短的分辨率——首先，浏览器可能不会给你，其次，计算机可能不够快以该速度处理事件，即使事件触发得那么快。

# wordpress - 分页不适用于静态主页自定义页面模板

> ID：10431566
> 
> 赞同：0
> 
> 时间：2012-05-03T12:39:30.437
> 
> 标签：wordpress, pagination

我有一个功能齐全的自定义页面模板，其中列出了我的博客文章。但是，当我将此页面设置为我的静态首页时，分页无法加载下一页的帖子。如果有帮助，我正在使用 %/postname/% 永久链接设置。

我的模板代码和附加信息可以在这里找到：[post_nav_link 导航可以与 WordPress 自定义页面模板一起使用吗？](https://stackoverflow.com/questions/10121230/can-post-nav-link-navigation-work-with-wordpress-custom-page-templates)

# android - Android：清除动画后如何重新启动动画

> ID：10431568
> 
> 赞同：2
> 
> 时间：2012-05-03T12:39:30.950
> 
> 标签：android, android-animation, android-viewpager

在我调用 myImageView.clearAnimation() 后找不到重新启动动画的解决方案。动画在 onPageSelected 中设置，但 startoffset 超时不起作用。

或者是否有任何其他方法可以取消 thr 动画以获得未触及的图像视图，并且在调用 onPageSelected 时为相同的视图启动相同的动画。

我尝试在 onPageScrollStateChanged 中调用 myImageView.getAnimation().retart() 但动画仍在视图中...

这是我的代码：

```
public class myActivity extends Activity {
...
private ImageView myImageView;

private static final Integer startOffset = 5000;
private static final Integer duration= 2500;

@Override
public void onCreate(Bundle savedInstanceState) {
    ...
    currentImageView = (ImageView) findViewById(R.id.dashboardIndicator);
    currentImageView.setAnimation(indicatorAnimation());
    ...
}

private Animation indicatorAnimation() {
    Animation alphaAnimation = new AlphaAnimation(1, 0.2F);
    alphaAnimation.setInterpolator(new AccelerateInterpolator());
    alphaAnimation.setStartOffset(startOffset);
    alphaAnimation.setDuration(duration);
    alphaAnimation.setFillAfter(true);

    return alphaAnimation;
}

ViewPager.OnPageChangeListener onPageChangeListener = new ViewPager.OnPageChangeListener() {
    @Override
    public void onPageSelected(int position) {
        // Need here to start the animation again
        myImageView.setAnimation(indicatorAnimation());
        // Set's the animation but don't starts it after the startOffset timeout
    }

    @Override
    public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) { }

    @Override
    public void onPageScrollStateChanged(int position) {
        // Need here to cancel the animation to have no Alpha value on the imageview
        myImageView.clearAnimation();
        // image view 100% visible
    }
};} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:51:17.497

不需要清除动画，直接调用starAnimation

# string - Oreilly servlet 字符串值操作

> ID：10431569
> 
> 赞同：0
> 
> 时间：2012-05-03T12:39:41.340
> 
> 标签：string, servlets, jspx

我正在尝试使用 Oreilly servlet 类截断字符串。

我的问题是我不想使用整个字符串，而是其中的一部分。**paramPart.getStringValue()** 将给出未切割的值，但我有一个场景需要我获取字符串的一部分。例如：字符串值可以是**"xxxyyyy ,,,"**而我只需要使用**"xxxyyyy"**。我希望我的问题很清楚。任何帮助将不胜感激。附言

我在我的 jsp 应用程序上使用 com.oreilly.servlet 类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T19:15:52.463

我找到了一个解决我的问题的方法，使用 java 的 substring() 方法。

首先我通过 String value = paramPart.getStringValue(); 然后我继续创建另一个变量 String valuetrucated = value.substring(0, value.length() - 2);

这会将字符串值截断为字符串末尾的第三个字符...

# documentation - 为大型（ish）多语言 API 生成文档

> ID：10431570
> 
> 赞同：1
> 
> 时间：2012-05-03T12:39:50.207
> 
> 标签：documentation, documentation-generation, multilingual

我是一个相当大（并且还在增长）的框架的作者。它主要公开 JavaScript API，但也有 Ruby 中的公共 API 和不断增长的 CoffeeScript 部分。（CoffeeScript 最终将包含该项目的大部分内容，但总会有重要的纯 JavaScript 存在。）

到目前为止，我一直在用[PDoc](https://github.com/tobie/pdoc)记录 JavaScript，用 RDoc 记录 Ruby。尽管我对 RDoc 没有任何意见，但不幸的是，PDoc 老化、维护成本高，并且需要大量打字，感觉像是多余的混乱。此外，将大部分代码转换为 CoffeeScript 会使 PDoc 的用处大大降低。

[项目当前文档的示例](http://guides.jaxgl.com/api/js/Jax/index.html)

我在当地的一家分店对[Rocco](http://rtomayko.github.com/rocco/)进行了试验，效果比我预期的要好。真正好的是它适用于我的*所有*代码，从 Ruby 到 Coffee 到 JS。很高兴在一个地方查看所有文档。在文档旁边看到源代码也很酷，这使得特定代码段实际上*在做*什么非常清楚。

但是，我有点担心整体结构。Docco/Rocco 似乎非常适合公共 API 很少的小众项目，但它的阅读整个项目风格让我觉得是一把双刃剑。虽然它提供的信息非常丰富，但必须在没有目录的情况下垂直滚动文件（更不用说，首先要知道要转到哪个文件！）似乎很难真正*找到*任何东西。此外，默认模板需要一些黑客攻击，因为文件列表太长而无法显示。没什么大不了的，但很烦人，并且暗示这个项目可能超出了 Rocco 的范围。

我现在正在考虑[CoffeeDoc](https://github.com/omarkhan/coffeedoc)。仅从示例来看，它似乎很有希望，但它当然是以 Coffee 为中心的，这让我回到了运行 3 个单独的文档工具：RDoc、CoffeeDoc 和 -- 什么？JSDoc?

我并不完全反对为单独的源运行单独的工具，但是很难将其调和成一个连贯的结果，感觉不像是 3 个单独的网站。

所以我想我的问题是：你使用或建议什么工具？它支持什么语言？*浏览、阅读和实际在*大海捞针是您的项目是否容易？在这一点上，我什至考虑推出我自己的工具，但我不敢相信没有其他人遇到过这样的问题（如果我不需要的话，我真的不想浪费时间）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-14T22:08:12.120

[Sphinx](http://sphinx.pocoo.org/)直接支持[javascript](http://sphinx.pocoo.org/domains.html#the-javascript-domain)。通过扩展 ( [https://bitbucket.org/birkenfeld/sphinx-contrib/](https://bitbucket.org/birkenfeld/sphinx-contrib/) ) 支持 Ruby 和 CoffeeScript 的文档。

从网站：

存在以下功能，工作正常，可以在 Python 文档中看到“正在运行”：

*   输出格式：HTML（包括 Windows HTML 帮助）、LaTeX（用于可打印的 PDF 版本）、手册页、纯文本
*   广泛的交叉引用：语义标记和函数、类、引文、词汇表术语和类似信息的自动链接
*   层次结构：文档树的简单定义，自动链接到兄弟姐妹、父母和孩子
*   自动索引：通用索引以及模块索引
*   代码处理：使用 Pygments 荧光笔自动高亮显示
*   扩展：自动测试代码片段，包含来自 Python 模块的文档字符串（API 文档）等等

# c++ - istream_iterator eos

> ID：10431574
> 
> 赞同：3
> 
> 时间：2012-05-03T12:40:03.773
> 
> 标签：c++, iterator, cin

如果您将输入编码为

```
std::istream_iterator<std::string> ii(std::cin);
std::istream_iterator<std::string> eos;
std::for_each(ii,eos,record); 
```

我想知道如果以这种方式编码，您是否可以在控制台中放置一些将终止输入过程的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T12:50:08.170

您可以通过在 Windows 上按 CTRL-Z 或在 Linux 上按 CTRL-D 从终端向标准输入流发送[EOF 。](http://en.wikipedia.org/wiki/End-of-file)

# matlab - 如何在matlab中检索函数参数的名称？

> ID：10431577
> 
> 赞同：18
> 
> 时间：2012-05-03T12:40:12.467
> 
> 标签：matlab, reflection

除了解析函数文件之外，有没有办法在 matlab 中获取函数的输入和输出参数的名称？

例如，给定以下函数文件：

*划分.m*

```
function [value, remain] = divide(left, right)
     value = floor(left / right);
     remain = left / right - value;
end 
```

从函数外部，我想在这里获得一个输出参数数组：`['value', 'remain']`，输入参数也类似：`['left', 'right']`。

在matlab中有没有简单的方法来做到这一点？Matlab 通常似乎很好地支持反射。

编辑背景：

这样做的目的是在一个窗口中显示功能参数供用户输入。我正在编写一种信号处理程序，对这些信号执行操作的函数存储在一个子文件夹中。我已经有一个列表和用户可以从中选择的每个函数的名称，但有些函数需要额外的参数（例如，平滑函数可能将窗口大小作为参数）。

目前，我可以在程序将找到的子文件夹中添加一个新功能，用户可以选择它来执行操作。我缺少的是让用户指定输入和输出参数，在这里我遇到了障碍，因为我找不到函数的名称。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-24T21:43:01.263

如果您的问题仅限于您想要解析文件中主要函数的[函数声明行](https://www.mathworks.com/help/matlab/ref/function.html)的简单情况（即您不会处理[本地函数](https://www.mathworks.com/help/matlab/matlab_prog/local-functions.html)、[嵌套函数](https://www.mathworks.com/help/matlab/matlab_prog/nested-functions.html)或[匿名函数](https://www.mathworks.com/help/matlab/matlab_prog/anonymous-functions.html)），那么您可以提取使用一些标准字符串操作和[正则表达式](https://www.mathworks.com/help/matlab/ref/regexpi.html)*在文件中出现的*输入和输出参数名称。函数声明行具有标准格式，但由于以下原因，您必须考虑一些变化：

*   不同数量的空白或空行，
*   存在[单行或块注释](https://www.mathworks.com/help/matlab/matlab_prog/comments.html)，以及
*   将声明[拆分为多行](https://www.mathworks.com/help/matlab/matlab_prog/continue-long-statements-on-multiple-lines.html)。

*（事实证明，解释块评论是最棘手的部分......）*

我已经组合了一个`get_arg_names`可以处理上述所有内容的函数。如果给它一个函数文件的路径，它将返回两个包含输入和输出参数字符串的元胞数组（如果没有，则返回空元胞数组）。请注意，具有变量输入或输出列表的函数将分别简单地列出[`'varargin'`](https://www.mathworks.com/help/matlab/ref/varargin.html)或[`'varargout'`](https://www.mathworks.com/help/matlab/ref/varargout.html)用于变量名称。这是功能：

```
function [inputNames, outputNames] = get_arg_names(filePath)

    % Open the file:
    fid = fopen(filePath);

    % Skip leading comments and empty lines:
    defLine = '';
    while all(isspace(defLine))
        defLine = strip_comments(fgets(fid));
    end

    % Collect all lines if the definition is on multiple lines:
    index = strfind(defLine, '...');
    while ~isempty(index)
        defLine = [defLine(1:index-1) strip_comments(fgets(fid))];
        index = strfind(defLine, '...');
    end

    % Close the file:
    fclose(fid);

    % Create the regular expression to match:
    matchStr = '\s*function\s+';
    if any(defLine == '=')
        matchStr = strcat(matchStr, '\[?(?<outArgs>[\w, ]*)\]?\s*=\s*');
    end
    matchStr = strcat(matchStr, '\w+\s*\(?(?<inArgs>[\w, ]*)\)?');

    % Parse the definition line (case insensitive):
    argStruct = regexpi(defLine, matchStr, 'names');

    % Format the input argument names:
    if isfield(argStruct, 'inArgs') && ~isempty(argStruct.inArgs)
        inputNames = strtrim(textscan(argStruct.inArgs, '%s', ...
                                      'Delimiter', ','));
    else
        inputNames = {};
    end

    % Format the output argument names:
    if isfield(argStruct, 'outArgs') && ~isempty(argStruct.outArgs)
        outputNames = strtrim(textscan(argStruct.outArgs, '%s', ...
                                       'Delimiter', ','));
    else
        outputNames = {};
    end

% Nested functions:

    function str = strip_comments(str)
        if strcmp(strtrim(str), '%{')
            strip_comment_block;
            str = strip_comments(fgets(fid));
        else
            str = strtok([' ' str], '%');
        end
    end

    function strip_comment_block
        str = strtrim(fgets(fid));
        while ~strcmp(str, '%}')
            if strcmp(str, '%{')
                strip_comment_block;
            end
            str = strtrim(fgets(fid));
        end
    end

end 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-05-25T00:09:53.687

MATLAB 提供了一种获取类元数据信息的方法（使用`meta`包），但这仅适用于 OOP 类而不是常规函数。

一个技巧是动态编写一个类定义，其中包含您要处理的函数的源代码，并让 MATLAB 处理源代码的解析（这可能会像您想象的那样棘手：函数定义行跨越多行，实际定义之前的注释等...）

因此，在您的案例中创建的临时文件如下所示：

```
classdef SomeTempClassName
    methods
        function [value, remain] = divide(left, right)
            %# ...
        end
    end
end 
```

然后可以将其传递`meta.class.fromName`给解析元数据...

* * *

这是此 hack 的快速而肮脏的实现：

```
function [inputNames,outputNames] = getArgNames(functionFile)
    %# get some random file name
    fname = tempname;
    [~,fname] = fileparts(fname);

    %# read input function content as string
    str = fileread(which(functionFile));

    %# build a class containing that function source, and write it to file
    fid = fopen([fname '.m'], 'w');
    fprintf(fid, 'classdef %s; methods;\n %s\n end; end', fname, str);
    fclose(fid);

    %# terminating function definition with an end statement is not
    %# always required, but now becomes required with classdef
    missingEndErrMsg = 'An END might be missing, possibly matching CLASSDEF.';
    c = checkcode([fname '.m']);     %# run mlint code analyzer on file
    if ismember(missingEndErrMsg,{c.message})
        % append "end" keyword to class file
        str = fileread([fname '.m']);
        fid = fopen([fname '.m'], 'w');
        fprintf(fid, '%s \n end', str);
        fclose(fid);
    end

    %# refresh path to force MATLAB to detect new class
    rehash

    %# introspection (deal with cases of nested/sub-function)
    m = meta.class.fromName(fname);
    idx = find(ismember({m.MethodList.Name},functionFile));
    inputNames = m.MethodList(idx).InputNames;
    outputNames = m.MethodList(idx).OutputNames;

    %# delete temp file when done
    delete([fname '.m'])
end 
```

并简单地运行为：

```
>> [in,out] = getArgNames('divide')
in = 
    'left'
    'right'
out = 
    'value'
    'remain' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-29T20:14:33.107

对于一般功能（想想 varargin 等），这将是非常困难的（阅读：不可能）。此外，一般来说，依赖变量名作为一种文档形式可能......不是你想要的。我将建议一种不同的方法。

既然您控制程序，那么不仅要使用 m 文件，还要使用带有额外信息的表条目来指定每个模块呢？您可以记录额外的参数、函数本身、注释选项何时为布尔值并将它们显示为复选框等。

现在，把这个放在哪里？我建议让主 m 文件函数返回结构，作为一种模块加载步骤，并带有一个指向执行实际工作的子函数（或嵌套函数）的函数句柄。这保留了我确定您想要保留的单文件设置，并为您的模块提供了更多可配置的设置。

```
function module = divide_load()
    module.fn = @my_divide;
    module.name = 'Divide';
    module.description = 'Divide two signals';
    module.param(1).name = 'left';
    module.param(1).description = 'left signal';
    module.param(1).required_shape = 'columnvector';
    % Etc, etc.

    function [value, remain] = my_divide(left, right)
         value = floor(left / right);
         remain = left / right - value;
    end
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-27T04:37:29.667

当您无法从编程语言中获取有关其内容的信息（例如，“反射”）时，您必须跳出该语言。

另一位发帖人建议使用“正则表达式”，当应用于解析实际程序时总是失败，因为正则表达式无法解析上下文无关语言。

为了可靠地做到这一点，您需要一个真正的 M 语言解析器，它可以让您访问解析树。那么这相当容易。

我们的[DMS Software Reengineering Toolkit](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)有一个可用的 M 语言解析器，并且可以做到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-24T22:11:27.650

您是否考虑过使用[地图容器？](http://www.mathworks.co.uk/help/techdoc/matlab_prog/brqqo5e-1.html)

您可以按照这些思路编写函数。. .

```
function [outMAP] = divide(inMAP)
     outMAP = containers.Map();
     outMAP('value') = floor(inMAP('left') / inMAP('right'));
     outMAP('remain') = inMAP('left') / inMAP('right') - outMAP('value');
end 
```

...并这样称呼他们...

```
inMAP  = containers.Map({'left', 'right'}, {4, 5});
outMAP = divide(inMAP); 
```

...然后使用以下语法简单地检查变量名...

```
>> keys(inMAP)

ans = 

    'left'    'right' 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2012-05-03T13:49:37.090

`inputname(argnum)` [http://www.mathworks.com/help/techdoc/ref/inputname.html](http://www.mathworks.com/help/techdoc/ref/inputname.html)。

# linq - Linq 查询给出无效的列名“xyz”错误

> ID：10431578
> 
> 赞同：3
> 
> 时间：2012-05-03T12:40:15.680
> 
> 标签：linq, sql-server-2005, entity-framework-4

我正在使用这个 LINQ 查询

```
var db = new XYZ();
var product = (from cp in db.CatalogProducts
               where cp.ProductID == productId
               select cp).FirstOrDefault(); 
```

运行此查询给我一个错误

> 列名“Cracker Cruncher”无效。
> 列名“破碎扭矩”无效。
> 列名“切片速度”无效。

任何人都可以在这件事上帮助我吗？

高塔姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T12:21:47.573

问题已解决.. 刚才我检查了 Some1 在没有通知我的情况下对 DB 进行了重大更改.. 感谢您跟上我

# xcode - 永久配置 LLDB（在 Xcode 4.3.2 中）不停止信号

> ID：10431579
> 
> 赞同：44
> 
> 时间：2012-05-03T12:40:19.013
> 
> 标签：xcode, macos, signals, lldb

我试图让 LLDB（使用 OS X 应用程序在 Xcode 4.3.2 中运行）不要在某些信号上停止。如果我输入

`process handle SIGUSR2 -n true -p true -s false`

在调试控制台上它工作正常，LLDB 不再在 SIGUSR2 上停止。

但是，如果我把

`command process handle SIGUSR2 -n true -p true -s false`

进入 ~/.lldbinit 它似乎被忽略了。此文件中的其他命令（例如别名）工作正常。

如何让 LLDB 在某些信号上永不停止？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-05-04T21:48:07.740

万一其他人有这个问题，我终于通过添加断点来解决它`NSApplicationMain()`（对于普通的 C 程序，`main()`当然也可以）。

我将断点操作设置为`process handle SIGUSR2 -n true -p true -s false`，并启用了“评估后自动继续”选项。

![Xcode 4 断点截图](../Images/f3083895945a02e1640fdae4d70f04b5.png)

如果有人有更优雅的解决方案，我很乐意听到。

# php - 任何定义内部选择的方式标记而不是打开 I have a weird html option list which I dont want to check each value to make it selected or not see the list below <select name="height" id="height"><option value="" label="Select">Select Height ID：10431581 赞同：2 时间：2012-05-03T12:40:27.127 标签：php, html, drop-down-menu, option 回答 #1 赞同：3 时间：2012-05-03T12:49:17.233 您总是可以编写一个辅助函数，<option>通过传递参数来为您提供。类似的东西 function get_option($value, $selected_value) { return '<option value="' . $value . '" label="' . $value . '"' . ($value == $selected_value ? ' selected="selected"' : '') . '>' . $value . "</option>\n"; } 这将使您不必为每个值编写它，而是只需执行 $selected_value = '4ft 5in - 134cm'; echo get_option('4ft 5in - 134cm', $selected_value); echo get_option('4ft 6in - 137cm', $selected_value); //etc, etc 回答 #2 赞同：3 时间：2012-05-03T12:49:57.757 您可以将所有项目放在一个数组中，并使用 for（或 foreach）循环动态生成列表。然后只需在此循环中检查您的循环变量是否等于您的值，如果是，则分配所选属性。 像这样的东西： <select name="height" id="height"> <option value="" label="Select">Select Height</option> <?php $options = array("4ft 5in - 134cm", "4ft 6in - 137cm", "4ft 7in - 139cm", /* and all your other options ... */); $yourvalue = "4ft 6in - 137cm"; // or any valid entry foreach($options as $option) { echo '<option value="'.$option.'" label="'.$option.'" '. ($option == $yourvalue ? 'selected' : '') .'>'.$option.'</option>'; } ?> </select> 回答 #3 赞同：3 时间：2012-05-03T12:46:12.437 您不能更改<select>元素来指定这一点：它不是 HTML 规范的一部分。您可以做的是给每个option元素一个id，然后使用 Javascript 将正确的option元素设置为selected. 在 PHP 中，您需要在正确的位置输出脚本片段以让浏览器运行它。 例如 <option value="7ft - 213cm" label="7ft - 213cm" id="s23">7ft - 213cm</option> ... <script> document.getElementById("s23").selected=true </script> 回答 #4 赞同：3 时间：2012-05-03T12:42:00.377 不。 多个选项可以具有相同的值，并且（如果multiple设置了属性）可以同时选择多个选项，因此使用属性来指定值是不可行的。 回答 #5 赞同：0 时间：2012-05-03T12:52:27.493 如果您不想使用 javascript，您将不得不编写您要避免的代码。 <? $selected = "6ft 10in - 208cm"; ?> <select name="height" id="height"> <option value="" label="Select">Select Height</option> <? foreach ( $options as $option ): ?> <option value="<?= $option; ?>" <?= ($option == $selected ? "selected" : ""); ?> ><?= $option; ?></option> <? endforeach; ?> </select></option></select>

# html - 将 HTML 添加到

> ID：10431585
> 
> 赞同：6
> 
> 时间：2012-05-03T12:40:31.733
> 
> 标签：html, twitter-bootstrap, jsf

我正在使用 Twitter 引导程序。

警报 HTML 代码是：

```
<div class="alert alert-block">
  <a class="close" data-dismiss="alert" href="#">×</a>
  <h4 class="alert-heading">Warning!</h4>
  Best check yo self, you're not...
</div> 
```

我`<h:messages />`用来显示我的表单错误、信息和警告消息，如下所示：

```
<h:messages errorClass="alert alert-error" infoClass="alert alert-info" warnClass="alert alert-warning"/> 
```

颜色和圆角都可以，但我需要添加关闭链接：

```
<a class="close" data-dismiss="alert" href="#">×</a> 
```

我该怎么做`<h:messages/>`？

**编辑**

如果需要更好的理解，这里是警报样式的 twitter 引导链接：http: [//twitter.github.com/bootstrap/components.html#alerts](http://twitter.github.com/bootstrap/components.html#alerts)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-03T12:45:42.603

我猜你添加消息的常用方式......

```
FacesContext context = 
FacesContext.getCurrentInstance(); 
context.addMessage(null, new FacesMessage(your message goes here... 
```

消息应该从服务器端添加......例如`String myMessage = "here is the text / HTML code..."`

看看 BalusC 的这篇文章

[在 JSF 消息中使用 HTML](http://balusc.blogspot.com/2010/07/using-html-in-jsf-messages.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-15T06:50:04.600

只需使用omnifaces o:messages。问题将得到解决。

例如`<o:messages escape="false"/>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-10T21:38:10.430

另一种解决方案是

```
<div class="alert alert-danger alert-dismissible fade in" role="alert" jsf:rendered="#{not empty facesContext.getMessageList('InputPassword')}">
     <button type="button" class="close" data-dismiss="alert"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
  <strong>Error </strong>  <h:message for="InputPassword" /> 
                                    </div> 
```

它适用于 JSF 2.2，但您可以适应以前版本的 JSF..

# ruby-on-rails - 在 rspec 控制器测试中从具有嵌套关联的工厂正确构造参数

> ID：10431587
> 
> 赞同：0
> 
> 时间：2012-05-03T12:40:45.223
> 
> 标签：ruby-on-rails, rspec

以下是模型关系：

```
class Tool < ActiveRecord::Base
  ...
  has_many :loss_ratios, :dependent => :destroy, :order => "loss_ratios.starts_at DESC"

  validates_associated :loss_ratios
  accepts_nested_attributes_for :loss_ratios, :allow_destroy => true

  attr_accessible :name, :text, :service_id, :supplier_id, :loss_ratios_attributes
end

class LossRatio < ActiveRecord::Base
  belongs_to :tool

  validates :rate, :starts_at, :tool, :presence => true
  validates_uniqueness_of :starts_at, :scope => :tool_id
  validates_numericality_of :rate
  validates_inclusion_of :rate, :in => (0..1)
  ...
end 
```

我在创建/更新 ToolsController 操作中管理 LossRatio 关联。我想通过发布工具的属性集来测试它们（包括几个嵌套的 LossRatios，就好像它们是在表单中提交的一样）。我正在使用 FactoryGirl，但它似乎没有办法构建类似参数的属性哈希（attributes_for 忽略关联，并且看起来这种行为不会改变）。有没有办法做到这一点？

（我知道标题是一团糟，但我想不出更好更短的……）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T07:28:14.980

好的，这是我拉了半天头发后的想法：

```
def params_for(factory_name)
  exclude_params = [ "id", "created_at", "updated_at" ]
  f = FactoryGirl.build(factory_name)

  params = f.attributes.except(*exclude_params).dup

  f.reflections.select { |k,v|
    v.macro == :has_many && !v.instance_of?(ActiveRecord::Reflection::ThroughReflection)
  }.each_key do |k|
    assoc_collection = f.send(k)

    unless assoc_collection.empty?
      params["#{k.to_s}_attributes"] = {}

      assoc_collection.each_with_index do |assoc_obj,idx|
        params["#{k.to_s}_attributes"][idx.to_s] = assoc_obj.attributes.except(*exclude_params << "#{f.class.name.underscore}_id")
      end
    end
  end

  params
end 
```

这是一个辅助方法，用于构建控制器的 CRUD 操作可消耗的参数哈希值。我在我的控制器规格中使用它，如下所示：

```
subject { post :create, :tool => params_for(:tool_with_lr_history) }

it "creates a new tool" do
  expect { subject }.to change(Tool, :count).by(1)
end 
```

从片段中可以看出，该方法仅填充 has-many 关联的属性（并忽略 has-many-through 关联）。我想它可能会扩展到任何类型的关系，但到目前为止这对我有用（除非有更好的方法来做我想做的事）......

# c++ - 如何在 Linux 中的虚拟网络摄像头上写字？

> ID：10431588
> 
> 赞同：14
> 
> 时间：2012-05-03T12:40:58.093
> 
> 标签：c++, c, linux, opencv, video-streaming

我想从真实的网络摄像头捕获视频，使用**openCv**应用过滤器并将过滤后的视频写入虚拟网络摄像头，以便在网络上流式传输。

前两点我没有问题，但我不知道如何在虚拟网络摄像头上写字。

这是可能的？

我该怎么做？

我在**Debian上使用****openCv**和**C++**。谢谢

 *** * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-03T13:24:27.230

嗯，实际上这是可能的。一种快速而肮脏的方法是使用[WebcamStudio](https://sourceforge.net/p/webcamstudio/wiki/Home/)。这将创建一个新的视频设备（例如，/device/video2），其他程序将其视为普通视频设备并可以从桌面获取其输入，因此您只需将其设置为捕获显示 OpenCV 输出的屏幕的一部分那里。

一种更好但更具技术性的方法是使用[V4L2 环回模块](https://github.com/umlaeute/v4l2loopback)。这样，您可以简单地将 OpenCV 的输出通过管道传输到模块，该模块被其他程序视为常规视频设备。有关更多信息，请参阅此页面底部的自述文件： [https](https://github.com/umlaeute/v4l2loopback) ://github.com/umlaeute/v4l2loopback 和 wiki 页面： [https](https://github.com/umlaeute/v4l2loopback/wiki) ://github.com/umlaeute/v4l2loopback/wiki 。

希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-12-02T01:50:33.490

您还可以使用和`v4l2loopback`的组合。`OBS Studio``obs-v4l2sink`

用于`OBS Studio`从您的设备捕获视频，然后`obs-v4l2sink`是一个小插件，可将输出写入`/dev/video*`您的选择。

[![v4l2sink](../Images/66e12516e4c71b629c0d035c4178d0dc.png)](https://i.stack.imgur.com/Nz9kQ.png)

[https://github.com/umlaeute/v4l2loopback/wiki/OBS-Studio](https://github.com/umlaeute/v4l2loopback/wiki/OBS-Studio)

[https://github.com/CatxFish/obs-v4l2sink](https://github.com/CatxFish/obs-v4l2sink)**

# windows - OpenGL 软件渲染替代方案

> ID：10431591
> 
> 赞同：6
> 
> 时间：2012-05-03T12:41:11.297
> 
> 标签：windows, opengl, rendering

我需要在 Windows 中对 OpenGL 进行软件渲染，并且已经找到了[Mesa3D](http://www.mesa3d.org)，它不提供 DLL，而且我在构建时遇到了一些痛苦……有替代方案吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-08-25T16:19:34.137

这取决于您希望加速的 OpenGL 版本。根据您的需要，有一些替代方案可用。我在下面列出了我知道的那些：

**OpenGL 1.0 和 1.1**

Windows（从 Windows NT 3.5 开始）实际上包括一个 OpenGL[软件实现](http://www.opengl.org/wiki/Getting_Started#Windows)。如果您还没有安装任何其他软件光栅器，这应该是您的默认实现。Microsoft 软件光栅化器支持 OpenGL 1.0 或 1.1，具体取决于您的平台，但不会加速任何更新的东西。如果您想要的 OpenGL 版本被 1.0 或 1.1 覆盖（但不太可能），那么该解决方案就足够了。我不确定默认的 Windows OpenGL 软件实现在多大程度上通过其 OpenGL 1.0 或 1.1 支持覆盖了 OpenGL ES 1.x 框架。

**OpenGL 1.4**

此外，在 Windows Vista 中，微软包含了一个可以将 OpenGL 转换为 Direct3D的[仿真层；](http://books.google.se/books?id=odgdAAAAQBAJ&lpg=PA626&ots=waKxI0fVQ9&dq=windows%20opengl%20to%20d3d%20emulator%201.4&hl=sv&pg=PA626#v=onepage&q=windows%20opengl%20to%20d3d%20emulator%201.4&f=false)因此支持高达 OpenGL 1.4。此外，这应该意味着 Windows Vista（及更高版本？）运行时可能会加速 OpenGL SC 的大部分部分。我自己从未使用过这个模拟器，听到它时感到非常惊讶，但对于不得不在 Windows 环境中运行这些旧框架之一的人来说可能会感兴趣。请注意，标准 Windows OpenGL 软件光栅器（OpenGL 1.0 或 1.1）也包含在 Windows Vista 及更高版本中。

**OpenGL ES 2.0**

此外，还有一个[ANGLE 项目](http://code.google.com/p/angleproject/)，它通过将 OpenGL ES 2.0 调用转换为 DirectX 9 和 11 来加速 WebGL 和 OpenGL ES 2.0。他们的开发说明还提到 OpenGL ES 3.0 解决方案正在开发中。从来没有使用过 ANGLE，我无法做出判断。

**OpenGL 3.1**

除了上面提到的那些之外，[Mesa 3D](http://www.mesa3d.org/)（[最高支持 OpenGL 3.1](http://www.mesa3d.org/faq.html)）还具有三种软件实现：

*   斯拉斯特
*   软管
*   llvmpipe

由于我对 swrast（最初的 Mesa 项目软件光栅化器）和 softpipe（参考驱动程序）知之甚少，我将避免进入这些内容。第三个实现，llvmpipe，可能也是您最感兴趣的一个，它是一种高速软件实现，它使用多线程和 JIT 编译来加速使用本机和 SIMD 指令的仿真。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T14:24:15.697

我之前使用[过 Transgaming](http://transgaming.com/business/swiftshader)的 Swiftshader 进行制作项目，我必须说，它很棒。有点贵，但很精彩。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-25T21:58:11.250

据我搜索，唯一的其他选择是使用 WebGL 软件渲染器，截至目前只有 Chrome 支持。Direct3D 有参考驱动程序（它真的很不稳定）和 Swiftshader，它既好又贵。

经过一番头疼之后，我设法为 Windows 构建了 Mesa3D，但只有一个旧版本仍然支持它。至少，它的性能很棒。

# java - 覆盖 JPA @Embedded 列上的排序行为

> ID：10431593
> 
> 赞同：1
> 
> 时间：2012-05-03T12:41:15.773
> 
> 标签：java, jpa

我有一个实体类，其中有一个嵌入式对象：

```
@Entity
public class Flight implements Serializable {

    /// .... other attributes
    @Embedded
    @AttributeOverrides({
        @AttributeOverride(name = "value", column =
        @Column(name = "FLIGHT_TIME")),
        @AttributeOverride(name = "dataState", column =
        @Column(name = "FLIGHT_TIME_TYPE", length = 20))
    })
    private DateDataStateValue flightDate;
} 
```

DateDataStateValue 如下：

```
@Embeddable
public class DateDataStateValue implements DataStateValue<Date>, Serializable {

    private static final long serialVersionUID = 1L;

    @Column(name = "DATASTATE")
    @Enumerated(value = EnumType.STRING)
    private final DataState dataState;

    @Column(name = "DATAVALUE")
    @Temporal(TemporalType.TIMESTAMP)
    private final Date value;
} 
```

从数据库中获取航班时，使用 CriteriaQuery 并在时间列上创建 Order 对象：

```
Path<Flight> propertyPath = queryRoot.get("flightDate");
Order order = isAscending() ? criteriaBuilder.asc(propertyPath) :  criteriaBuilder.desc(propertyPath); 
```

顺序不是我想要的。例如，如果飞行表具有以下值：

```
Flight 1  | ESTIMATED | 1 Jan 2012
Flight 2  | ESTIMATED | 1 Jan 2011
Flight 3  | ACTUAL    | 1 Jan 2010
Flight 4  | ESTIMATED | 1 Jan 2009 
```

升序排序的结果将是：

```
Flight 3  | ACTUAL    | 1 Jan 2010
Flight 4  | ESTIMATED | 1 Jan 2009
Flight 2  | ESTIMATED | 1 Jan 2011
Flight 1  | ESTIMATED | 1 Jan 2012 
```

@Embedded 列的默认排序似乎是按照元素在类中命名的顺序使用元素的自然排序。即首先是DATASTATE，然后是DATAVALUE。

我想做的是每当排序属性是飞行日期时，排序是日期，然后是状态，即：

```
Flight 4  | ESTIMATED | 1 Jan 2009
Flight 3  | ACTUAL    | 1 Jan 2010
Flight 2  | ESTIMATED | 1 Jan 2011
Flight 1  | ESTIMATED | 1 Jan 2012 
```

使 DateDataStateValue 具有可比性并不会影响它，而且 @orderColumn/@OrderBy 似乎不适合这项工作。有没有人有任何想法？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T13:11:33.317

我什至不知道您可以在这样的可嵌入属性上通过查询添加订单。但我不会依赖它，只需在您的查询中添加两个订单：

```
Path<Flight> statePath = queryRoot.get("flightDate.dateState"); // or queryRoot.get("flightDate").get("dateState"): to be tested
Path<Flight> valuePath = queryRoot.get("flightDate.value");
Order[] orders;
if (isAscending()) {
    orders = new Order[] {criteriaBuilder.asc(valuePath), criteriaBuilder.asc(statePath)  };
}
else {
    orders = new Order[] {criteriaBuilder.desc(valuePath), criteriaBuilder.desc(statePath)  
}

query.orderBy(orders); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T13:11:44.163

可能类似于`"flightDate.value ASC, flightDate.dataState ASC"`，因为您定义的只是“flightDate”，这意味着该对象的自然排序

# solr - 如何同时使用 lucene/solr 从数据库和 doc 文件中导入记录进行关联

> ID：10431594
> 
> 赞同：1
> 
> 时间：2012-05-03T12:41:19.080
> 
> 标签：solr, lucene, solr-cell

我将二进制文档信息（文件元）存储在数据库中，并将二进制文档存储在文件系统中。使用文件名与数据库中的文件信息相关联。

现在我想将所有这些数据（二进制文档中的文件元和全文内容）导入 lucene solr。

lucene/solr 提供“使用数据导入处理程序 (DIH) 从数据库导入记录”。和“使用 Solr Cell (ExtractingRequestHandler) 索引 Word 和 PDF 等二进制文档。”分别导入这些数据。

导入后如何使用 solr/lucene 在二进制文档和文件元之间建立关联

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T17:57:54.890

我[回答](https://stackoverflow.com/a/9567536/604511)了一个相关的问题。

我通过查询数据库的客户端程序实现了类似的功能，获取与更新文档相对应的行，然后上传文件以及提供的元数据。

# autotools - 我在哪里放置额外的自动工具宏？

> ID：10431600
> 
> 赞同：1
> 
> 时间：2012-05-03T12:41:30.183
> 
> 标签：autotools

emsr 对这个问题的回答：[如何在 Makefile.am 中指定我想要 C++0x？](https://stackoverflow.com/questions/8585110/how-can-i-specify-that-i-want-c0x-in-makefile-am)是我遇到的问题的解决方案。不，我有一个新的：

我将宏定义放入 m4/check.m4 并相应地更改我的 configure.ac：

```
AC_INIT([CppSs], [0.1], [brinkmann@hlrs.de])
m4_include([m4/check.m4])
LT_INIT

AC_CONFIG_SRCDIR([src/main.cc])
AC_CONFIG_HEADERS([config.h])
AC_CONFIG_FILES([Makefile src/Makefile])
AC_CONFIG_MACRO_DIR([m4])

# Checks for programs.
AC_PROG_CXX
AC_PROG_CC

# ...

# Check for C++0x features
AC_COMPILE_STDCXX_OX
AC_HEADER_STDCXX_11

AC_OUTPUT 
```

现在，当我运行时，`autoreconf -v`我收到这些消息（也尝试过 -fiv）：

```
configure.ac:43: warning: AC_COMPILE_STDCXX_11 is m4_require'd but not m4_defun'd 
../../lib/m4sugar/m4sh.m4:606: AS_IF is expanded from... 
../../lib/autoconf/general.m4:2032: AC_CACHE_VAL is expanded from... 
../../lib/autoconf/general.m4:2053: AC_CACHE_CHECK is expanded from... m4/cppss.
m4:90: AC_HEADER_STDCXX_11 is expanded from... 
```

./configure 产生：

```
...
./configure: line 16234: AC_COMPILE_STDCXX_OX: command not found
./configure: line 16235: AC_COMPILE_STDCXX_11: command not found
... 
```

我错过了什么？

谢谢，史蒂芬

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T12:43:28.527

我自己解决了......这是几个拼写错误（`0`而不是`O`类似）和将宏放入`configure.ac`. 另外，我发现，如果它只是几个宏，将它们放在`acinclude.m4`同一目录中的一个文件中`configure.ac`并摆脱

```
m4_include([m4/check.m4]) 
```

[并且在检查 c++11 功能的页面底部部分的libstdc++ 手册](http://gcc.gnu.org/onlinedocs/libstdc++/manual/backwards.html)中有一个错误，因为（至少在 gcc 中）没有编译器选项`-std=c++11`。应该是`-std=c++0x`。

干杯，史蒂芬

# objective-c - 在 CAKeyFrameAnimation 期间检测碰撞

> ID：10431603
> 
> 赞同：2
> 
> 时间：2012-05-03T12:41:36.337
> 
> 标签：objective-c, ios, collision, cgrect, cgpath

是否可以在 CAKeyFrameAnimation 期间检测两个 UIImageView 的碰撞？

如果是这样，这是如何完成的，我尝试了多种方法，包括在动画期间检查 CGRects 的碰撞 - 但找不到合适的方法在 CAKeyFrameAnimation 期间执行方法并尝试检测路径和 UIImageView 的碰撞。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T13:02:48.020

您需要从表示层获取属性。它将具有动画期间存在的信息的最佳近似值。通过访问它

```
view.layer.presentationLayer 
```

有关更多详细信息，请查看 CALayer/presentationLayer 的文档。

当您想要检查碰撞时，您将获取每个对象的presentationLayer，然后访问您想要测试碰撞的任何属性。检查的确切方法取决于图层的类型，以及您是否想要简单的 hitTest-ing 或深度检查。只有您知道要查找的碰撞时间和类型。

但是，要在动画制作时访问对象的属性，您需要presentationLayer。

**编辑**

您可以随时进行这些检查。您可以在另一个操作的上下文中执行此操作，或者使用 NSTimer 在某个时间间隔执行此操作。您甚至可以使用 CADisplayLink，它同时将您连接到动画计时器本身。

如果您使用 CADisplayLink，我建议将 frameInterval 设置为尽可能高的值，并且仍然按照您的意愿进行操作，以免影响性能。

```
 timer = [CADisplayLink displayLinkWithTarget:self selector:@selector(checkForCollisions)];
    // Callback is for every frame, which is 60 times per second.
    // Only callback every 6 frames (which is ten times per second)
    timer.frameInterval = 6;
    [timer addToRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode]; 
```

完成后不要忘记使计时器无效。

# ruby-on-rails - Rails 字符串比较在十六进制字符串上失败

> ID：10431611
> 
> 赞同：0
> 
> 时间：2012-05-03T12:42:05.163
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我目前正在构建一个发送带有链接的电子邮件邀请的邀请模型。链接使用 sha1 哈希“保护”。但是，控制器无法验证哈希，我不知道为什么......

生成的链接看起来像

```
/projects/1/invitations/12?hash=c043b70c359a85e20cd9933c9cd37ef3f8943d7b 
```

并且控制器尝试使用

```
def show
    @invitation = Invitation.find(params[:id])
    if @invitation.hash.to_s != params[:hash].to_s
       redirect_to root_url
       .... 
```

字符串比较每次都失败。我已经检查了三次，但字符串看起来完全一样。

编辑：一些调试信息

```
logger.debug params
logger.debug @invitation.hash 
```

在 development.log 中产生以下输出

```
{"hash"=>"c043b70c359a85e20cd9933c9cd37ef3f8943d7b", "action"=>"show",
controller"=>"invitations", "project_id"=>"1", "id"=>"12"}
c043b70c359a85e20cd9933c9cd37ef3f8943d7b 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T13:09:10.040

看看`@invitation.hash`是不是真的在打电话[`Object#hash`](http://ruby-doc.org/core-1.9.3/Object.html#method-i-hash)。

# ios - 在 iOS Superviews 中强制布局位置和大小

> ID：10431612
> 
> 赞同：1
> 
> 时间：2012-05-03T12:42:08.017
> 
> 标签：ios, ipad, uiview, landscape, superview

我有一个大问题，我真的希望你能在这里帮助我......我现在很迷茫:(

我有一个使用 MainWindow.xib 运行的项目。在我的应用程序委托文件中，我检查设备的方向并加载一个适当的 NIB 文件，该文件具有基于方向的不同布局（子视图）。这是检查方向的代码：

```
-(void)checkTheOrientation
{
    if ([[UIApplication sharedApplication] statusBarOrientation] == UIInterfaceOrientationLandscapeLeft || [[UIApplication sharedApplication] statusBarOrientation] == UIInterfaceOrientationLandscapeRight) 
    {
        viewController = [[[MyViewController alloc] initWithNibName:@"MyWideViewController" bundle:nil] autorelease];
        NSLog(@"Landscape = MyWideViewController");
    } 
    else if ([[UIApplication sharedApplication] statusBarOrientation] == UIInterfaceOrientationPortrait || [[UIApplication sharedApplication] statusBarOrientation] == UIInterfaceOrientationPortraitUpsideDown)
    {   
        viewController = [[[MyViewController alloc] initWithNibName:@"MyViewController" bundle:nil] autorelease];
        NSLog(@"Portrait = MyViewController"); 
    }
} 
```

这可以按预期工作，并且在横向或纵向中我正在加载正确的视图。纵向视图加载完美，但横向视图加载时左侧有一个厚黑边，好像它的 x 和 y 位置没有分别设置为 0 和 0。

这是纵向视图： http: [//uploads.socialcode.biz/2f25352B0e3x3z2t2z21](http://uploads.socialcode.biz/2f25352B0e3x3z2t2z21) 这是带有错误的横向视图：http: [//uploads.socialcode.biz/1G2k3T012d1z0Y1U2q1k](http://uploads.socialcode.biz/1G2k3T012d1z0Y1U2q1k)

在 MyViewController.m 文件中，我有一个粗略的修复来正确调整大小，以避免左侧出现这个大黑条。这是此的代码：

```
- (void) performLayout {
    // Ensure the main view is properly placed
    NSInteger MaxSizeHeight, MaxSizeWidth;

    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) 
    {
        MaxSizeHeight = 1024;
        MaxSizeWidth  = 768;
    }
    if ([[UIApplication sharedApplication] statusBarOrientation] == UIInterfaceOrientationLandscapeLeft || [[UIApplication sharedApplication] statusBarOrientation] == UIInterfaceOrientationLandscapeRight) {
        CGRect mainViewFrame = [[self view] frame];
        float width = mainViewFrame.size.width;
        mainViewFrame.size.width = mainViewFrame.size.height;
        mainViewFrame.size.height = width;
        mainViewFrame.origin.x = 0;
        mainViewFrame.origin.y = 0;
        [[self view] setFrame:mainViewFrame];
    } else {
        CGRect mainViewFrame = [[self view] frame];
        mainViewFrame.origin.x = MaxSizeWidth - mainViewFrame.size.width;
        mainViewFrame.origin.y = MaxSizeHeight - mainViewFrame.size.height;
        [[self view] setFrame:mainViewFrame];
    }

    // Ensure the content view is properly placed
    CGRect contentFrame = [mainContentView frame];
    if ([[UIApplication sharedApplication] statusBarOrientation] == UIInterfaceOrientationLandscapeLeft || [[UIApplication sharedApplication] statusBarOrientation] == UIInterfaceOrientationLandscapeRight) 
    {
        contentFrame.size.width = MaxSizeHeight;
        contentFrame.size.height = MaxSizeWidth;
    }
    contentFrame.origin.x = 0;
    contentFrame.origin.y = 44;
    [mainContentView setFrame:contentFrame];

    // Ensure the content subviews are properly placed
    contentFrame.origin.y = 0;
    for (UIView *contentView in [mainContentView subviews]) {
        [contentView setFrame:contentFrame];
    }
} 
```

这种方法的问题在于，这只是一个非常糟糕的 hack，它实际上并没有解决我的问题。当它在 Landscape 中加载时，它现在将子视图调整大小并将其定位为 1024x768,0,0，但我通过其他 NIB 加载的任何其他子视图都有同样的问题。

我真正想知道的是，我到底如何将横向主超级视图设置为 1024x768 位置 0 和 0，而不必尝试将其组合在一起并继续执行 performLayout 选择器？目前这有很多不一致之处，因为黑客实际上并没有正确设置超级视图的大小，而只是我在超级视图之上加载的子视图。

我认为像这样的简单修复可能会解决超级视图问题，但可惜它没有：window.frame = CGRectMake(0, 0, 1024, 768);

我只希望我的主要超级视图在加载时正确放置和调整大小，然后超级视图只是加载到正确的位置。请问你能帮我吗？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T13:10:05.647

首先，UIView 有一个名为的方法`-layoutSubviews`，您可以覆盖它以随意放置子视图。它会在第一次加载视图时被调用，如果你曾经向它发送`-setNeedsLayout`消息，在绘制之前再次调用它。

其次，您应该能够在 .xib 或故事板文件中正确设置这些位置。在其 .xib 文件中选择您的主视图并检查其在大小检查器中的位置。此外，确保在属性检查器中将视图设置为横向。如果一切都正确，那么还有其他事情正在发生。为了简化问题，在 Xcode 中创建一个新项目，除了横向的空视图之外什么都没有。我刚做了一个，没有位置问题。这就是您在真实应用程序中想要的，因此请弄清楚您的真实应用程序中发生了什么来影响新示例应用程序中没有发生的视图位置。

# c++ - 宏选择

> ID：10431614
> 
> 赞同：0
> 
> 时间：2012-05-03T12:42:13.743
> 
> 标签：c++

是否可以使用类似于此（错误）语法的方法进行宏选择？

```
#define FLAG MULT
#ifdef FLAG ADD
   int op(int a, int b) {return a + b;}
#endif
#ifdef FLAG MULT
   int op(int a, int b) {return a * b;}
#endif 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-03T12:46:12.100

你可以这样做：

```
#define ADD  0
#define MULT 1

#define FLAG MULT
#if (FLAG == ADD)
   int op(int a, int b) {return a + b;}
#elif (FLAG == MULT)
   int op(int a, int b) {return a * b;}
#endif 
```

但是，条件编译通常会导致悲伤（通常，“未使用”的分支最终会无人维护，当您切换回使用它时，事情会中断）。

C++ 提供了更好的机制（运行时多态性、模板等）来解决大多数（但不是全部）这种性质的问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-03T12:46:17.890

```
#define ADD +
#define MULT *
//...
#define FLAG MULT
//...
int op(int a, int b) {return a FLAG b;} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-03T12:59:22.310

您应该尽量避免使用宏，更重要的是根据定义生成不同的代码。这是导致破坏 ODR 并导致未定义行为的第一步。

作为替代方案，您可以考虑只编写不同的替代方案，或使用模板（假设该函数比普通操作具有更多逻辑）：

```
template <typename BinaryFunction>
int op( int a, int b, BinaryFunction f ) {
   return f( a, b );
}
int main() {
   std::cout << op( 5, 3, std::plus<int>() ) << std::endl;        // 8
   std::cout << op( 5, 3, std::multiplies<int>() ) << std::endl;  // 15
} 
```

如果您要遵循宏的路径，则考虑将宏的范围缩小到最低限度（即`#undef`，在您不需要它们时立即使用它们），提供非常明确和唯一的名称（考虑添加组件，文件或类似的东西以避免交互：比避免名称冲突`#define BINARY_OPERATOR_IMPL_FLAG`要好得多），然后遵循任何其他答案中的建议。`#define FLAG`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-03T12:47:28.763

您当然可以根据定义的常量 fe 更改标记的行为

```
config.h
#define MP
#include "other.h"

other.h
#ifdef MP
 #define // your define here
#elif
 // other define here
#endif 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-03T12:48:52.197

您可以给宏一个值并检查该值，也可以更改宏名称。那是：

```
#define MULT 1
#define ADD 2

#define FLAG MULT
#if (FLAG == ADD)
    int op(int a, int b) {return a + b;}
#elif (FLAG == MULT)
    int op(int a, int b) {return a * b;}
#endif 
```

或者你可以这样做：

```
#define FLAG_MULT
#ifdef FLAG_ADD
    int op(int a, int b) {return a + b;}
#elif defined (FLAG_MULT)
    int op(int a, int b) {return a * b;}
#endif 
```

我个人更喜欢hamstergene的回答

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-03T12:49:58.813

```
#define ADD 0
#define MULT 1

#define FLAG MULT

#if FLAG == ADD
   int op(int a, int b) {return a + b;}
#endif

#if FLAG == MULT
   int op(int a, int b) {return a * b;}
#endif

// ...

int result = op(2, 3);
assert(result == 6); 
```

# mysql - MySQL按列插入

> ID：10431615
> 
> 赞同：0
> 
> 时间：2012-05-03T12:42:13.630
> 
> 标签：mysql

我正在尝试使用 MySQL 表创建计算逻辑。使用存储过程处理来自两个表的数据并生成一组值。这些值是输出表列的一部分。我必须运行不同的程序来为输出表中的每一列生成输出

现在，如果我为每一行创建插入查询，它将为每一列插入大量的插入。我可以一次将一组值插入到表列中吗？假设其他列可以为 NULL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:51:20.913

```
INSERT INTO tableName(columnName)
VALUES ('baz'),('foo'),('bar'),('baz'),('baz'),('baz'),('baz'); 
```

等你喜欢..

请参阅：[使用一个查询批量插入表](https://stackoverflow.com/questions/6994319/bulk-insert-into-table-with-one-single-query)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:54:37.103

如果剩余的列可以为空，则可以对一列进行插入，其余列可以为*NULL 。*

但是下次对于剩余的列，插入将不适用于现有的行。如果要更新现有行，则需要触发更新查询。

假设`col1`和`col2`可以为空

如果你想插入`col1`保持`col2`空插入将工作如果你想插入`col2`保持`col1`空插入将工作

# java - 将字符串转换为字节数组

> ID：10431616
> 
> 赞同：2
> 
> 时间：2012-05-03T12:42:23.433
> 
> 标签：java, bytearray, rsa

我正在使用**RSA**加密将简单文本转换为加密形式。

`my plain text is : hello`

`encrypted text : [B@d7eed7`

现在，如何将加密文本转换为简单的纯文本，我正在使用以下代码

```
KeyPairGenerator keygenerator = KeyPairGenerator.getInstance("RSA");
SecureRandom random = SecureRandom.getInstance("SHA1PRNG", "SUN");
keygenerator.initialize(1024, random);

KeyPair keypair = keygenerator.generateKeyPair();
PrivateKey privateKey = keypair.getPrivate();
PublicKey publicKey = keypair.getPublic();
Cipher cipher = Cipher.getInstance("RSA");

String arrayStr = "[b@d7eed7";
byte ciphertext = arrayStr.getBytes();
cipher.init(Cipher.DECRYPT_MODE, privateKey);
byte[] cleartext1 = cipher.doFinal(ciphertext);
System.out.println("the decrypted cleartext is: " + new String(cleartext1)); 
```

我收到**javax.crypto.BadPaddingException：数据必须从零开始**

需要帮忙 ！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:48:59.123

我只是查看了屏幕右侧的“相关”部分，然后...[将 Java 字符串转换为字节数组](https://stackoverflow.com/questions/5499924/convert-java-string-to-byte-array)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T12:50:10.693

问题是`[B@d7eed7`不是加密的文本。它只显示字节数组的类型和地址，而不是其内容。

有关更多信息，请参阅[https://stackoverflow.com/a/5500020/367273](https://stackoverflow.com/a/5500020/367273)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T12:54:20.867

要将字符串转换为字节数组，您可以使用以下命令：

```
String source = "0123456789";
byte[] byteArray = source.getBytes("specify encoding alongside endianess");// e.g "UTF-16LE", "UTF-16".. 
```

有关更多信息，您可以[在此处](https://stackoverflow.com/questions/228987/convert-string-to-byte)、[此处](https://stackoverflow.com/questions/1536054/how-to-convert-byte-array-to-string-and-vice-versa)和[此处查看](https://stackoverflow.com/questions/4432147/java-conversion-of-string-to-byte-array-then-to-long-value-and-vice-versa)。

祝你好运！

# python - 计算列表中最常见的列表（字典列表）

> ID：10431617
> 
> 赞同：0
> 
> 时间：2012-05-03T12:42:45.580
> 
> 标签：python, collections, counter

我有以下数据结构：

```
data = [[{'Posit': '0', 'R': '0', 'B': '0', 'G': '255'}, {'Posit': '1000', 'R': '255', 'B': '0', 'G': '0'}],
        [{'Posit': '0', 'R': '0', 'B': '0', 'G': '255'}, {'Posit': '1000', 'R': '255', 'B': '0', 'G': '0'}],
        [{'Posit': '0', 'R': '0', 'B': '0', 'G': '255'}, {'Posit': '1000', 'R': '255', 'B': '0', 'G': '0'}],
        [{'Posit': '0', 'R': '255', 'B': '0', 'G': '255'}, {'Posit': '1000', 'R': '0', 'B': '255', 'G': '0'}],
        [{'Posit': '0', 'R': '0', 'B': '0', 'G': '255'}, {'Posit': '1000', 'R': '255', 'B': '0', 'G': '0'}],
        [{'Posit': '0', 'R': '0', 'B': '0', 'G': '255'}, {'Posit': '1000', 'R': '255', 'B': '0', 'G': '0'}],
        [{'Posit': '0', 'R': '0', 'B': '0', 'G': '255'}, {'Posit': '1000', 'R': '255', 'B': '0', 'G': '0'}],
        [{'Posit': '0', 'R': '0', 'B': '0', 'G': '255'}, {'Posit': '1000', 'R': '255', 'B': '0', 'G': '0'}]] 
```

我想在上述数据结构中找到最常见的字典列表。

我的第一个想法是使用`most_common`函数 from `collections.Counter`，但是

```
from collections import Counter
c = Counter()
for point in data:
    c[point] += 1 
```

a 失败，`TypeError`因为列表是不可散列的。

我的下一个想法是将列表转换为元组，因为元组是不可变的

```
from collections import Counter
c = Counter()
for point in data:
    c[tuple(point)] += 1 
```

但后来我得到一个`TypeError`说法，字典也是不可散列的。

那么实现我想要的Pythonic方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:46:50.283

您可以使用`Counter`，但您必须将列表转换为元组，将字典转换为元组的排序元组（元组键值的排序元组，以便能够比较两个字典）。

```
>>> Counter(tuple(tuple(sorted(d.items())) for d in a) for a in data).most_common()

[(((('B', '0'), ('G', '255'), ('Posit', '0'), ('R', '0')),
   (('B', '0'), ('G', '0'), ('Posit', '1000'), ('R', '255'))),
  7),
 (((('B', '0'), ('G', '255'), ('Posit', '0'), ('R', '255')),
   (('B', '255'), ('G', '0'), ('Posit', '1000'), ('R', '0'))),
  1)] 
```

正如@Marcin 正确评论`tuple(sorted(d.items()))`可以替换为更合适的`frozenset(d.items())`：

```
>>> Counter(tuple(frozenset(d.items()) for d in a) for a in data).most_common()
[((frozenset([('Posit', '0'), ('B', '0'), ('G', '255'), ('R', '0')]),
   frozenset([('R', '255'), ('G', '0'), ('B', '0'), ('Posit', '1000')])),
  7),
 ((frozenset([('Posit', '0'), ('R', '255'), ('B', '0'), ('G', '255')]),
   frozenset([('B', '255'), ('G', '0'), ('R', '0'), ('Posit', '1000')])),
  1)] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T13:39:40.157

```
from collections import namedtuple, Counter
# You can probably think of a better name than this
datum = namedtuple('datum', 'Posit R B G')
Counter(tuple(datum(**d) for d in a) for a in data).most_common()
# You might actually want to make the conversion permanent;
# the data is possibly easier to work with that way given the
# fixed key structure, and it should save memory too 
```

# android - 如何将请求发送到 HTTP POST 请求到服务器

> ID：10431619
> 
> 赞同：6
> 
> 时间：2012-05-03T12:42:49.903
> 
> 标签：android, http-post

您好我正在使用两个按钮，单击显示日期选择器对话框和时间选择器对话框。我有一个微调器。

我想将用户输入值发送到 php 服务器。我应该为客户端代码做什么？

这是我的代码：

```
public class DineOutActivity extends Activity {

    private TextView mDateDisplay;
    private Button mPickDate;
    private int mYear;
    private int mMonth;
    private int mDay;
   /******************time picker**************/
        private TextView mTimeDisplay;
           private Button mPickTime;
           private int mHour;
           private int mMinute;
           private int mAmPm;

           static final int TIME_DIALOG_ID=1;

        static final int DATE_DIALOG_ID = 0;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        /********************spinner***********/

        Spinner food = (Spinner) findViewById(R.id.spinner1);
        ArrayAdapter<CharSequence> foodadapter = ArrayAdapter.createFromResource(
                    this, R.array.item_array, android.R.layout.simple_spinner_item);
        foodadapter.setDropDownViewResource(R.layout.spinner_layout);
        food.setAdapter(foodadapter);
        /**pick date*/

        mDateDisplay = (TextView) findViewById(R.id.textView2);
        mTimeDisplay = (TextView) findViewById(R.id.textView4);
        mPickDate = (Button) findViewById(R.id.button2);
       /**pick time**/

        mPickTime=(Button)findViewById(R.id.button3);

        // add a click listener to the button
        mPickTime.setOnClickListener(new View.OnClickListener() {

                     public void onClick(View v) {

                           showDialog(TIME_DIALOG_ID);
                     }
              });

        // get the current time
        final Calendar c=Calendar.getInstance();
        mHour=c.get(Calendar.HOUR_OF_DAY);
        mMinute=c.get(Calendar.MINUTE);
        mAmPm = c.get(Calendar.AM_PM);

        // display the current date
       upTimeDisplay();

/*****************************pick date***********************************/
        // add a click listener to the button
        mPickDate.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v1) {
                showDialog(DATE_DIALOG_ID);
            }
        });

        // get the current date
        final Calendar date = Calendar.getInstance();
        mYear = date.get(Calendar.YEAR);
        mMonth = date.get(Calendar.MONTH);
        mDay = date.get(Calendar.DAY_OF_MONTH);
        int mDst = date.get(Calendar.AM_PM);
        int mAmPm = date.get(Calendar.DST_OFFSET);

        // display the current date (this method is below)
        updateDisplay();
    }

    // updates the date in the TextView

   private void upTimeDisplay()
   {
     //  mTimeDisplay.setText(new  
           //    StringBuilder().append(pad(mHour)).append(":").append(pad(mMinute)).append(pad(mAmPm)));
       mTimeDisplay.setText(new  
                  StringBuilder().append(mHour).append(":").append(mMinute));
       mTimeDisplay.setTextColor(R.color.green);
   }
  /** private Object pad(int mMinute2) {

       if(mMinute2>=10)
              return String.valueOf(mMinute2);
       else
              return "0"+String.valueOf(mMinute2);
}**/

   private TimePickerDialog.OnTimeSetListener mtimeSetListener=new  
           TimePickerDialog.OnTimeSetListener() {

public void onTimeSet(TimePicker view, int hourOfDay, int minute) {

mHour=hourOfDay;
mMinute=minute;
int ampm;

upTimeDisplay();
}
};

    private void updateDisplay() {
        mDateDisplay.setText(new StringBuilder()
                    // Month is 0 based so add 1
                    .append(mMonth + 1).append("-")
                    .append(mDay).append("-")
                    .append(mYear).append(" "));
        mDateDisplay.setTextColor(R.color.green);
                 //   .append(mHour).append("_")
                  //  .append(mMinute).append("_")));
    }

    // the callback received when the user "sets" the date in the dialog
    private DatePickerDialog.OnDateSetListener mDateSetListener =
            new DatePickerDialog.OnDateSetListener() {

                public void onDateSet(DatePicker view, int year, 
                                      int monthOfYear, int dayOfMonth) {
                    mYear = year;
                    mMonth = monthOfYear;
                    mDay = dayOfMonth;
                    updateDisplay();
                }
            };

    @Override
    protected Dialog onCreateDialog(int id) {
        switch (id) {
        case DATE_DIALOG_ID:
            return new DatePickerDialog(this, mDateSetListener, mYear, mMonth,
                    mDay);

        case TIME_DIALOG_ID:
            return new TimePickerDialog(this,mtimeSetListener,mHour,mMinute,false);
        }
        return null;
    } 
```

我使用 mPickDate 作为打开到 DatePickerDialog mPickTime 的按钮作为单击打开 TimePicker 对话框 One Spinner (spinner1) 以获取项目列表的按钮。mDateDisplay 显示用户单击 DatePickerDialog 后编辑的日期。mTimeDisplay 显示用户点击 TimePickerDialog 后编辑的时间。

我希望 DatePickerDialog、TimePickerDialog 和 spinner 的用户输入的字符串值作为 HTTP post 发送到服务器。请告诉我该怎么做？我想要详细代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T12:48:00.370

```
public void postData() {

    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("http://www.yoursite.com/script.php");

    try {
        // Add your data
        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
        nameValuePairs.add(new BasicNameValuePair("text", "blablabla"));
        nameValuePairs.add(new BasicNameValuePair("date", "yourdate"));
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

        HttpResponse response = httpclient.execute(httppost);

    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
    } catch (IOException e) {
        // TODO Auto-generated catch block
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T14:01:35.797

```
 // Create a new HttpClient and Post Header
    String downloadedString= null;

    HttpClient httpclient = new DefaultHttpClient();

    //for registerhttps://te
    HttpPost httppost = new HttpPost("url here");
    //add data
    try{
        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(7);
        nameValuePairs.add(new BasicNameValuePair("firstname", "harsh"));
        nameValuePairs.add(new BasicNameValuePair("lastname", "chandel"));
        nameValuePairs.add(new BasicNameValuePair("email", "mike.bulurt66@gmail.com"));
        nameValuePairs.add(new BasicNameValuePair("phone", "944566778"));
        nameValuePairs.add(new BasicNameValuePair("username", "mikebulurt"));
        nameValuePairs.add(new BasicNameValuePair("password", "qwert"));
        nameValuePairs.add(new BasicNameValuePair("device_duid", "986409987"));

        //add data
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

        // Execute HTTP Post Request
        HttpResponse response = httpclient.execute(httppost);

        InputStream in = response.getEntity().getContent();
        StringBuilder stringbuilder = new StringBuilder();
        BufferedReader bfrd = new BufferedReader(new InputStreamReader(in),1024);
        String line;
        while((line = bfrd.readLine()) != null)
            stringbuilder.append(line);

        downloadedString = stringbuilder.toString();

    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
    System.out.println("downloadedString:in login:::"+downloadedString);

    return downloadedString; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-03T12:46:14.537

按照[此处](http://www.vogella.com/articles/ApacheHttpClient/article.html)或[此处](http://www.androidsnippets.com/executing-a-http-post-request-with-httpclient)的教程进行操作，您可能希望通过[Android Developer HTTP Post](http://developer.android.com/reference/org/apache/http/client/methods/HttpPost.html)

# javascript - 获取父/祖先 UL

> ID：10431622
> 
> 赞同：2
> 
> 时间：2012-05-03T12:43:00.403
> 
> 标签：javascript, jquery

我有一个看起来像的 HTML 标记

```
<ul>
  ...

    <li>
      <ul class="x">
        ...
        <a href="#"... 
```

如何`ul.x`从链接上的点击事件中获取父元素？

`this.parentNode`如果 UL 是父元素，则有效，但如果它是我必须使用的祖先之一，则`this.parentNode.parentNode`取决于两者之间有多少父元素......

我能以某种方式获得第一个 UL 父母吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T12:48:53.533

由于您已将问题标记为 jQuery：

```
$(this).closest("ul"); //Get the first ancestor `ul`
$(this).closest("ul.x"); //Get the first ancestor `ul` with class `x` 
```

或者，没有 jQuery（因为您的示例似乎没有使用 jQuery）：

```
var node = this;
while(node.tagName !== "UL") {
    node = node.parentNode;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T12:44:52.323

使用[`closest()`](http://api.jquery.com/closest/). 这将获得与您提供的选择器匹配的最近祖先。

```
$(function(){
    $('a').on('click',function(){         //handler of your <a>
        var ulx = $(this).closest('ul.x'); //find the closest ancestor <ul> with class "x"
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T12:45:36.330

如果`ul.x`是`a`使用这个的直接父母：

```
 $('a').on('click',function(){
        var ul = $(this).parent('ul.x');
    }); 
```

或者

```
 $('a').on('click',function(){
       var ul = $(this).closest('ul.x');
    }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-03T12:45:48.203

通常你会[`.closest()`](http://api.jquery.com/closest/)像这样使用：

```
$('a').click(function(){    
   var ul = $(this).closest('ul.x'); //or just closest('ul') in case you only used the x for demo purposes
}); 
```

这将向上 DOM 树并在第一个匹配项（您的`ul.x`-element）处停止。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-03T13:10:10.250

为了表现，

您也可以[在下面使用 jquery](http://api.jquery.com/on/)，jquery [eventObject](http://api.jquery.com/category/events/event-object/)也有一个名为[delegateTarget](http://api.jquery.com/event.delegateTarget/)的属性，这在您的情况下可能很有用。

```
$('ul.x').on('click', 'a', function(e){

    //e.delegateTarget is the parent ul of the clicked a tag
    //e.target.id is the clicked a tag

    alert(e.delegateTarget.id); 
    alert(e.target.id);

});​ 
```

**HTML：**

```
 <ul id='a' class="x">
      <li><a id='1' href="#">A</a></li>
      <li><a id='2' href="#">B</a></li>
      <li><a id='3' href="#">C</a></li>
 </ul>

 <ul id='b' class="x">
      <li><a id='11' href="#">1</a></li>
      <li><a id='21' href="#">2</a></li>
      <li><a id='31' href="#">3</a></li>
 </ul>​ 
```

在性能方面，您没有将事件绑定到所有`a`标签上。jQuery 建议采用这种方式。

这是[小提琴](http://jsfiddle.net/5sVNG/)。

# javascript - 使用目标从弹出窗口在 Safari 中发布和重定向 iframe

> ID：10431625
> 
> 赞同：0
> 
> 时间：2012-05-03T12:43:08.003
> 
> 标签：javascript, jquery, iframe, safari, popup

我在 Safari 中尝试从弹出窗口发布和重定向以及 iframe 时遇到问题。

让我解释一下流程：

1.  用户打开页面：x.com
2.  x.com 包含域上的 iframe：z.com
3.  用户单击 z.com 框架中的按钮，打开一个弹出窗口
4.  用户在弹出窗口中单击，然后弹出窗口创建一个表单，其中包含一些隐藏值、一个操作、方法作为 post 和 target 作为“_parent”（我试过说 target 是 iframe 的名称。）
5.  弹窗使用 self.close();

如您所见，我希望弹出窗口在重定向 iframe 的弹出窗口中提交表单。

这在 firefox、chrome、IE 中效果很好，但在 safari 中效果不佳。:( 如果我直接在 safari 中打开域 z.com，然后弹出 bla bla bla 效果很好。

所以请..我已经阅读了一千个问题和答案，但没有运气。

如何从弹出窗口将表单发布到 iframe 并确保 iframe 重定向到表单中的操作。

我认为我不需要显示任何代码，因为它是一个简单的形式。我`document.forms['iframename'].submit();`用来提交我的表格。

**解决方案：** 见评论。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T16:09:08.430

解决方案：向页面添加一个提交按钮，（可以显示：无）然后让javascript“单击”该提交按钮..猜测Safari需要“模拟”用户单击:)

# html - 显示 3D 地球的坐标线

> ID：10431632
> 
> 赞同：1
> 
> 时间：2012-05-03T12:43:30.640
> 
> 标签：html, webgl, three.js

这是一个基于`Three js`我想找到当前单击位置的经度和纬度的位置并显示坐标线的 3D 地球

定义这些分流线的策略应该是什么？

如何将我的纹理映射到正确的等效经度/纬度？

* * *

**编辑 1：**

**我的问题以更简单的形式：**

**如何获得在球体内单击的图案图像的 x、y？**

# postgresql - PostgreSQL 数据库中对象的物理位置？

> ID：10431635
> 
> 赞同：9
> 
> 时间：2012-05-03T12:43:36.447
> 
> 标签：postgresql, database-design, data-storage

我有兴趣获取 Linux OS 中 PostgreSQL 表中可用的表、视图、函数、数据/内容的物理位置。我有一个场景，PostgreSQL 可以安装在 SD 卡设施和硬盘中。如果我在 SD 中有表、视图、函数、数据，我想获取它们的物理位置，并在我希望替换存储空间时合并/复制到我的硬盘中。我希望数据库的存储应该是纯文件架构。

另外，是否可以查看文件的内容？我的意思是，我可以访问它们吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-03T22:03:24.513

Kevin 和 Mike 已经提供了在哪里可以找到数据目录的指针。对于文件系统**中表**的物理位置，请使用：

```
SELECT pg_relation_filepath('my_table'); 
```

除非您确切知道自己在做什么，否则不要直接弄乱文件。

**整个数据库**由以下子目录表示`PGDATA/base`：

如果您使用**表空间**，它会变得更加复杂。阅读[手册中](https://www.postgresql.org/docs/current/storage-file-layout.html)[**数据库文件布局**](https://www.postgresql.org/docs/current/storage-file-layout.html)一章的详细信息：

> 对于集群中的每个**数据库**，在 PGDATA/base 中都有一个子目录，以数据库的 OID 命名`pg_database`。该子目录是数据库文件的默认位置；特别是，它的系统目录存储在那里。

...

> 每个**表和索引**都存储在一个单独的文件中。*对于普通关系，这些文件以表或索引的文件节点*号命名 ，可以在`pg_class.relfilenode`.

...

> 该**`pg_relation_filepath()`**函数显示任何关系的整个路径（相对于 PGDATA）。

大胆强调我的。
[关于功能的手册`pg_relation_filepath()`](https://www.postgresql.org/docs/current/functions-admin.html#FUNCTIONS-ADMIN-DBLOCATION)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-03T12:59:13.363

该查询`show data_directory;`将向您显示主要数据目录。但这并不一定能告诉你东西存储在哪里。

PostgreSQL 允许您定义新的[表空间](http://www.postgresql.org/docs/9.1/static/manage-ag-tablespaces.html)。表空间是文件系统中的一个命名目录。PostgreSQL 允许您将单个表、索引和整个数据库存储在任何允许的表空间中。因此，如果在特定表空间中创建数据库，我相信它的任何对象都不会出现在数据目录中。

要获得有关事物在磁盘上的存储位置的可靠运行时信息，您可能需要从系统目录中查询[pg_database](http://www.postgresql.org/docs/9.1/static/catalog-pg-database.html)、[pg_tablespace](http://www.postgresql.org/docs/9.1/static/catalogs.html)或[pg_tables 。](http://www.postgresql.org/docs/9.1/static/view-pg-tables.html)表空间信息也可能在 information_schema 视图中可用。

但是对于合并或复制到您的硬盘，使用这些文件几乎可以肯定是一件坏事。对于那种工作，pg_dump 是你的朋友。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-03T14:18:20.730

如果您正在谈论将磁盘文件复制为一种备份形式，您可能应该阅读此内容，尤其是关于连续存档和时间点恢复 (PITR) 的部分：

[http://www.postgresql.org/docs/current/interactive/backup.html](http://www.postgresql.org/docs/current/interactive/backup.html)

如果您正在考虑尝试绕过数据库管理系统直接访问和解释磁盘文件中的数据，这是一个非常糟糕的主意，原因有很多。一方面，存储方案非常复杂。另一方面，它往往会在每个新的主要版本（每年发布一次）中发生变化。第三，[EF Codd](http://en.wikipedia.org/wiki/Edgar_F._Codd)的幽灵可能会困扰你；参见[Codd 的 12 条规则的第 8、9、11 和 12 条规则](http://en.wikipedia.org/wiki/Codd%27s_12_rules)。

# gwt - Guice-Persist：尝试在关闭的 EntityManager 上执行操作

> ID：10431640
> 
> 赞同：2
> 
> 时间：2012-05-03T12:43:56.787
> 
> 标签：gwt, guice, guice-persist

我有一个由 maven 管理的应用程序，它有两个模块：一个用于持久性，另一个用于 webapp 本身（gwt）。

我在持久性模块中的测试就像一个魅力，但是，在 webapp 中，当我多次执行相同的方法时，我得到了一个`java.lang.IllegalStateException: Attempting to execute an operation on a closed EntityManager.`.

我使用 guice-persist 将实体管理器注入到我的 DAO 中，并且我所有的 DAO 方法都有`@Transactional`注释。

在我的 webapp 中，我放了一个： public class ScuvServletModule extends ServletModule {

```
 @Override
    protected void configureServlets() {
       super.configureServlets();
       install(MyPersistenceAPI.getModule()); // return my module and install it
       filter("/*").through(PersistFilter.class);
       /// another bindings...
    }
} 
```

如果我删除`PersistFilter`，它会工作，但会随机抛出 Transaction Closed 异常或类似的东西。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-07T20:30:30.163

我发现了问题。它是`PersistFilter`. 显然，它是一个单例，我的 DAO 也是单例，但 EntityManager 不是。

所以，现在我注入 a `Provider<EntityManager>`instead `EntityManager`，它就像一个魅力。

# regex - 我可以从这个正则表达式中删除 OR

> ID：10431642
> 
> 赞同：1
> 
> 时间：2012-05-03T12:44:02.047
> 
> 标签：regex

我有这个正则表达式

```
((.*?)(\(.*?\))|(.*?)) 
```

我想删除 | 因为我认为有更好的方法来匹配这个。这是我希望它匹配的一些示例字符串

```
myString

myString(1234) 
```

如果它有括号，我想将括号的内容作为单独的捕获组捕获。它永远不必捕获这两种类型的字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T12:47:16.457

由于该`(...)`部分是可选的，因此您也可以将与其匹配的子正则表达式设为可选：

```
((.*?)(\(.*?\))?) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:48:11.323

只需使用

```
.*?(\(.*?\))? 
```

这使得括号部分是可选的，`.*?`如果括号部分不存在，第一个将匹配所有内容。

# c# - 更改标题高度/大小 Winform

> ID：10431645
> 
> 赞同：3
> 
> 时间：2012-05-03T12:44:16.750
> 
> 标签：c#, .net, winforms, custom-controls

是否可以在`windows-form`.

![在此处输入图像描述](../Images/9359c4167430efe16a3420f5aedde4d0.png)

我确实寻找了可以更改标题的属性，但没有找到任何东西。

是否可以使用标准形式或创建自己的形式`custom-control`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T12:48:44.810

不，您不能使用 WinForms 更改 Chrome，除非您将 FormBorderStyle 设置为 None 并实现您自己的标题，如 UserControl 将您想要的任何内容放在那里。

然后您将需要实现一些基本功能，例如移动表单、关闭表单等。

# nhibernate - 以编程方式设置 show_sql 而不重新创建 SessionFactory？

> ID：10431651
> 
> 赞同：0
> 
> 时间：2012-05-03T12:44:35.863
> 
> 标签：nhibernate

在 NHibernate 中，我`show_sql`开启了运行单元测试。我的每个单元测试都会清除数据库并重新填充它，这会导致很多我不希望 NHibernate 输出的 sql 查询。

是否可以在`show_sql`不破坏的情况下进行控制`SessionFactory`？如果可能的话，我想在运行测试设置时将其关闭，然后在测试主体开始运行时再次打开它。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:56:36.870

您可以设置的唯一位置是在构建**`NHibernate.Cfg.Configuration`**. 一旦你`SessionFactory`从你`Configuration`的 .配置错误。

如果您确实需要该功能，请获取 NH 源代码并找到评估 show_sql 设置的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T13:46:09.263

另一种选择虽然可能/可能不是那么好，但它是使用[NHProf](http://www.nhprof.com)并在测试时初始化 NHProf。

NHProf 不记录设置/清除数据库，只记录使用的查询。

# jquery - 我可以在 jquery 中检测到溢出事件吗？

> ID：10431659
> 
> 赞同：1
> 
> 时间：2012-05-03T12:45:04.443
> 
> 标签：jquery, events, overflow

我见过[这个](https://stackoverflow.com/questions/2112106/use-jquery-to-detect-container-overflow)，但我想知道是否有任何方法可以检测到溢出*事件*。

我有一个 div 可以通过一些 jquery 代码调整大小，但是稍后该 div 的内容会发生变化，并且 css height:auto 规则不再有效，因为之前的事件设置了高度，因此显示混乱。

我希望能够捕获溢出事件，以便将 div 的高度重置为自动。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T12:56:47.060

我不确定这是否有帮助，但我认为值得一试：

FF：[http ://help.dottoro.com/ljgsfkbc.php](http://help.dottoro.com/ljgsfkbc.php)

Chrom 和 Safari：[http ://help.dottoro.com/ljbnnejo.php](http://help.dottoro.com/ljbnnejo.php)

# mysql - MySql：多个左连接给出错误的输出

> ID：10431660
> 
> 赞同：6
> 
> 时间：2012-05-03T12:45:05.183
> 
> 标签：mysql

我在查询中使用多个左连接时遇到了一些麻烦。有些表与左表是一对一的关系，有些是一对多的关系。查询如下所示：

```
Select 
    files.filename,
    coalesce(count(distinct case
                when dm_data.weather like '%clear%' then 1
                    end),
            0) as clear,
    coalesce(count(distinct case
                when dm_data.weather like '%lightRain%' then 1
                    end),
            0) as lightRain,
    coalesce(count(case
                when kc_data.type like '%bicycle%' then 1
                    end),
            0) as bicycle,
    coalesce(count(case
                when kc_data.type like '%bus%' then 1
                    end),
            0) as bus,
    coalesce(count(case
                when kpo_data.movement like '%walking%' then 1
                    end),
            0) as walking,
    coalesce(count(case
                when kpo_data.type like '%pedestrian%' then 1
                    end),
            0) as pedestrian
from
    files
        left join
    dm_data ON dm_data.id = files.id
        left join
    kc_data ON kc_data.id = files.id
        left join
    kpo_data ON kpo_data.id = files.id
where
    files.filename in (X, Y, Z, ........)
group by files.filename; 
```

在这里，dm_data 表与“files”表具有一对一的关系（这就是我使用“distinct”的原因），而 kc_data 和 kpo_data 数据与“files”表具有一对多的关系。（kc_data 和 kpo_data 可以针对一个 files.id 有 10 到 20 行）。此查询工作正常。

当我添加另一个左连接和另一个一对多表 pd_markings（它可以有 100 行针对一个 files.id）时，就会出现问题。

```
Select 
    files.filename,
    coalesce(count(distinct case
                when dm_data.weather like '%clear%' then 1
                    end),
            0) as clear,
    coalesce(count(distinct case
                when dm_data.weather like '%lightRain%' then 1
                    end),
            0) as lightRain,
    coalesce(count(case
                when kc_data.type like '%bicycle%' then 1
                    end),
            0) as bicycle,
    coalesce(count(case
                when kc_data.type like '%bus%' then 1
                    end),
            0) as bus,
    coalesce(count(case
                when kpo_data.movement like '%walking%' then 1
                    end),
            0) as walking,
    coalesce(count(case
                when kpo_data.type like '%pedestrian%' then 1
                    end),
            0) as pedestrian,
    **coalesce(count(case
                when pd_markings.movement like '%walking%' then 1
                    end),
            0) as walking**
from
    files
        left join
    dm_data ON dm_data.id = files.id
        left join
    kc_data ON kc_data.id = files.id
        left join
    kpo_data ON kpo_data.id = files.id
        left join
    **kpo_data ON pd_markings.id = files.id**
where
    files.filename in (X, Y, Z, ........)
group by files.filename; 
```

现在所有的值都变成了彼此的倍数。有任何想法吗？？？

请注意，前两列返回 1 或 0 值。这实际上是期望的结果，因为一对一的关系表对于任何 files.id 只有 1 或 0 行，所以如果我不使用“Distinct”，那么结果值是错误的（我猜是因为其他针对同一个 file.id 返回超过一行的表）不，不幸的是，我的表没有自己的唯一 ID 列，除了“文件”表。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-03T16:35:17.687

您需要[展平](http://www.anicehumble.com/2012/05/sql-count-computer-program-does-what.html)查询结果，以获得正确的计数。

您说您的文件表与其他表之间存在一对多关系

如果SQL只有一个关键字`LOOKUP`，而不是把所有的东西都塞进`JOIN`关键字里，那么应该很容易推断A表和B表的关系是一对一的，使用`JOIN`会自动表示一对多。我跑题了。无论如何，我应该已经推断出您的文件与 dm_data 是一对多的；而且，针对 kc_data 的文件也是一对多的。`LEFT JOIN`是第一个表和第二个表之间的关系是一对多的另一个提示；虽然这不是确定的，一些编码人员只是用`LEFT JOIN`. 您的查询中的 LEFT JOIN 没有任何问题，但是如果您的查询中有多个一对多表，那肯定会失败，您的查询将产生针对其他行的重复行。

```
from
    files
        left join
    dm_data ON dm_data.id = files.id
        left join
    kc_data ON kc_data.id = files.id 
```

因此，有了这些知识，您表明文件与 dm_data 是一对多的，而且与 kc_data 也是一对多的。我们可以得出结论，链接这些连接并将它们分组到一个整体查询中存在问题。

例如，如果您有三个表，即 app(files)、ios_app(dm_data)、android_app(kc_data)，这是 ios 的示例数据：

```
test=# select * from ios_app order by app_code, date_released;
 ios_app_id | app_code | date_released | price  
------------+----------+---------------+--------
          1 | AB       | 2010-01-01    | 1.0000
          3 | AB       | 2010-01-03    | 3.0000
          4 | AB       | 2010-01-04    | 4.0000
          2 | TR       | 2010-01-02    | 2.0000
          5 | TR       | 2010-01-05    | 5.0000
(5 rows) 
```

这是您的 android 的数据：

```
test=# select * from android_app order by app_code, date_released;
.android_app_id | app_code | date_released |  price  
----------------+----------+---------------+---------
              1 | AB       | 2010-01-06    |  6.0000
              2 | AB       | 2010-01-07    |  7.0000
              7 | MK       | 2010-01-07    |  7.0000
              3 | TR       | 2010-01-08    |  8.0000
              4 | TR       | 2010-01-09    |  9.0000
              5 | TR       | 2010-01-10    | 10.0000
              6 | TR       | 2010-01-11    | 11.0000
(7 rows) 
```

如果您仅使用此查询：

```
select x.app_code, 
    count(i.date_released) as ios_release_count, 
    count(a.date_released) as android_release_count
from app x
left join ios_app i on i.app_code = x.app_code
left join android_app a on a.app_code = x.app_code
group by x.app_code
order by x.app_code 
```

输出将是错误的：

```
 app_code | ios_release_count | android_release_count 
----------+-------------------+-----------------------
 AB       |                 6 |                     6
 MK       |                 0 |                     1
 PM       |                 0 |                     0
 TR       |                 8 |                     8
(4 rows) 
```

您可以将链连接视为笛卡尔积，因此如果第一个表有 3 行，第二个表有 2 行，则输出将为 6

这是可视化，看到每个 ios AB 都有 2 个重复的 android AB。有 3 个 ios AB，那么当你做 COUNT(ios_app.date_released) 时计数是多少？那将变成6；与 相同`COUNT(android_app.date_released)`，这也将是 6。同样，每个 ios TR 有 4 个重复的 android TR，在 ios 中有 2 个 TR，所以我们的计数是 8。

```
.app_code | ios_release_date | android_release_date 
----------+------------------+----------------------
 AB       | 2010-01-01       | 2010-01-06
 AB       | 2010-01-01       | 2010-01-07
 AB       | 2010-01-03       | 2010-01-06
 AB       | 2010-01-03       | 2010-01-07
 AB       | 2010-01-04       | 2010-01-06
 AB       | 2010-01-04       | 2010-01-07
 MK       |                  | 2010-01-07
 PM       |                  | 
 TR       | 2010-01-02       | 2010-01-08
 TR       | 2010-01-02       | 2010-01-09
 TR       | 2010-01-02       | 2010-01-10
 TR       | 2010-01-02       | 2010-01-11
 TR       | 2010-01-05       | 2010-01-08
 TR       | 2010-01-05       | 2010-01-09
 TR       | 2010-01-05       | 2010-01-10
 TR       | 2010-01-05       | 2010-01-11
(16 rows) 
```

因此，您应该做的是在将每个结果加入其他表和查询之前将它们展平。

如果您的数据库能够进行 CTE，请使用。它非常整洁且非常自我记录：

```
with ios_app_release_count_list as
(
 select app_code, count(date_released) as ios_release_count
 from ios_app
 group by app_code
)
,android_release_count_list as
(
 select app_code, count(date_released) as android_release_count 
 from android_app 
 group by app_code  
)
select
 x.app_code, 
 coalesce(i.ios_release_count,0) as ios_release_count, 
 coalesce(a.android_release_count,0) as android_release_count
from app x
left join ios_app_release_count_list i on i.app_code = x.app_code
left join android_release_count_list a on a.app_code = x.app_code
order by x.app_code; 
```

而如果你的数据库还没有 CTE 功能，比如 MySQL，你应该这样做：

```
select x.app_code, 
 coalesce(i.ios_release_count,0) as ios_release_count, 
 coalesce(a.android_release_count,0) as android_release_count
from app x
left join
(
 select app_code, count(date_released) as ios_release_count
 from ios_app
 group by app_code
) i on i.app_code = x.app_code
left join
(
 select app_code, count(date_released) as android_release_count 
 from android_app 
 group by app_code   
) a on a.app_code = x.app_code
order by x.app_code 
```

该查询和 CTE 样式的查询将显示正确的输出：

```
 app_code | ios_release_count | android_release_count 
----------+-------------------+-----------------------
 AB       |                 3 |                     2
 MK       |                 0 |                     1
 PM       |                 0 |                     0
 TR       |                 2 |                     4
(4 rows) 
```

**现场测试**

查询不正确：[http ://www.sqlfiddle.com/#!2/9774a/2](http://www.sqlfiddle.com/#!2/9774a/2)

正确查询：[http ://www.sqlfiddle.com/#!2/9774a/1](http://www.sqlfiddle.com/#!2/9774a/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:52:38.573

我在这里质疑您的不同用法 - 它的编写方式将返回 1 或 0。这意味着不同的计数只会返回 0、1 或 2。

我假设您的每个表中都有唯一的 ID 列。您可以更改大小写以返回 ID 值，然后计算不同的值。如果您的联接从您的 pd_markings 表中返回多个相同的行，则 ID 上的不同计数将返回，好吧，仅返回不同的行数。

# hibernate - 假设是同一个实体，但 AssertSame 失败。不一致的数据

> ID：10431663
> 
> 赞同：1
> 
> 时间：2012-05-03T12:45:21.930
> 
> 标签：hibernate, caching, junit, assert, jta

我的 DAO 实现存在一些问题。我的场景：我在我的数据库中插入一个实体，我从我的数据库中两次获得这个实体。我了解 AssertSame 和 AssertEquals 之间的区别。我想同一个实体应该在这两种情况下都通过。在我的情况下， AssertEquals 通过，但 AssertSame 失败。

我已经为此苦苦挣扎了很长时间，任何帮助都将不胜感激。

我的问题是：必须满足哪些条件才能确保这两个实体相同？我应该在我的代码中更改什么？

我只粘贴了我认为必不可少的部分类和配置文件。

StudentEntity 类使用@Entity 进行注释。

我准备了以下 jUnit 测试：

```
@RunWith(SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = { "/dao-context.xml", "/hibernate-context.xml", "/core-context.xml" })
public class BidirectionalTest {

    @Autowired
    private UserService userService;

    @Test
    public void testBidirectionalRelation() {
        try {
            StudentEntity s = new StudentEntity();
            s.setLogin("Login");
            userService.registerUser(s);
            StudentEntity foundStudent1 = (StudentEntity) userService.findUserByLogin("Login");
            StudentEntity foundStudent2 = (StudentEntity) userService.findUserByLogin("Login");
            assertEquals(foundStudent1, foundStudent2);
            assertSame(foundStudent1, foundStudent2); // fail!
        } catch (ServiceException e) {
            e.printStackTrace();
        }
    }
} 
```

我的服务实现的一部分：

```
@Transactional(propagation=Propagation.REQUIRED)
public class UserServiceImpl implements UserService{

private UserDao userDao;

public AbstractUserEntity findUserByLogin(String login) throws ServiceException {
    Long userId = getUserDao().findUserByLogin(login);
    if(userId == null) {
        return null;
    }
    return getUserDao().findUser(userId);
}

public Long registerUser(AbstractUserEntity user) throws ServiceException {
    Long duplicateUserId = getUserDao().findUserByLogin(user.getLogin());
    if (duplicateUserId!=null) {
        throw new ServiceException("Użytkownik już istnieje");
    }
    return getUserDao().insertUser(user);
}
} 
```

我的 dao 实现的一部分：

```
@Repository
public class HibernateUserDao implements UserDao {

private EntityManagerFactory emf;

public EntityManagerFactory getEmf() {
    return emf;
}

@PersistenceUnit
public void setEmf(EntityManagerFactory emf) {
    this.emf = emf;
}

@Override
public Long insertUser(AbstractUserEntity user) {
    EntityManager em = emf.createEntityManager();
    try {
        em.getTransaction().begin();
        em.persist(user);
        em.getTransaction().commit();
    } finally {
        if (em != null) em.close();
    }
    return user.getId();
}

@Override
public Long findUserByLogin(String login) {
    EntityManager em = emf.createEntityManager();
    Long result;
    try{
        result = (Long) em.createNamedQuery("findUserByLogin").setParameter("login", login).getSingleResult();          
    } catch(NoResultException nre) {
        return null;
    }
    return result;
} 
```

}

我的persistence.xml的一部分

```
<persistence-unit name="JpaPersistenceUnit" transaction-type="RESOURCE_LOCAL">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <properties>
        <property name="hibernate.ejb.naming_strategy" value="org.hibernate.cfg.DefaultNamingStrategy" />
        <property name="hibernate.dialect" value="org.hibernate.dialect.DerbyDialect" />
        <property name="hibernate.hbm2ddl.auto" value="create-drop" />
        <property name="show_sql" value="true" />
    </properties>
</persistence-unit> 
```

我的 core-context.xml 的一部分

```
<!-- enable the configuration of transactional behavior based on annotations -->
<tx:annotation-driven transaction-manager="transactionManager" />

<!-- a PlatformTransactionManager is still required -->
<bean id="transactionManager" class="org.springframework.transaction.jta.JtaTransactionManager">
    <property name="transactionManager">
        <ref local="atomikosTM" />
    </property>
    <property name="userTransaction">
        <ref local="atomikosUTX" />
    </property>
</bean>

<bean id="atomikosTM" class="com.atomikos.icatch.jta.UserTransactionManager" />
<bean id="atomikosUTX" class="com.atomikos.icatch.jta.UserTransactionImp" /> 
```

编辑：

谢谢你的回答。现在我知道我需要一个缓存。我找到了一个很好的解释：“在 JPA 中，不跨 EntityManagers 维护对象身份。每个 EntityManager 都维护自己的持久性上下文，以及它自己的对象事务状态。” 我更改了我的 persistence.xml，但我的测试仍然失败。

```
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"
         version="2.0">
<persistence-unit name="JpaPersistenceUnit" transaction-type="RESOURCE_LOCAL">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <class>amg.training.spring.model.StudentEntity</class>
    <class>amg.training.spring.model.SubjectEntity</class>
    <class>amg.training.spring.model.TeacherEntity</class>
    <class>amg.training.spring.model.AbstractUserEntity</class>
    <class>amg.training.spring.model.TeacherDegree</class>
    <class>amg.training.spring.dao.AbstractEntity</class>
    <shared-cache-mode>ALL</shared-cache-mode>
    <properties>
        <property name="hibernate.ejb.naming_strategy" value="org.hibernate.cfg.DefaultNamingStrategy" />
        <property name="hibernate.dialect" value="org.hibernate.dialect.DerbyDialect" />
        <property name="hibernate.hbm2ddl.auto" value="create-drop" />
        <property name="show_sql" value="true" />
        <property name="hibernate.cache.provider_class" value="org.hibernate.cache.EhCacheProvider"/>
        <property name="hibernate.cache.use_second_level_cache" value="true"/>
        <property name="hibernate.cache.use_query_cache" value="true"/>
    </properties>
</persistence-unit> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:50:37.023

要检索相同的对象，您必须使用休眠查询缓存。任何进入数据库的查询都会创建不同的对象。

有关启用查询缓存的信息，请参见以下内容：http: [//docs.jboss.org/hibernate/orm/3.3/reference/en/html/performance.html#performance-querycache](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/performance.html#performance-querycache)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T22:50:39.380

Finally managed to make it work. I think that lack of cache was not a problem. It is necessary to bind a resource (in our case EntityManagerFactory ) to the same thread. [link to doc of .bindResource() method](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/transaction/support/TransactionSynchronizationManager.html#bindResource%28java.lang.Object,%20java.lang.Object%29)

```
@PersistenceUnit
private EntityManagerFactory emf;
private EntityManager em;

@Before
public void setUp() {
    em = emf.createEntityManager();
    TransactionSynchronizationManager.bindResource(emf, new EntityManagerHolder(em));
}

@After
public void tearDown() {
TransactionSynchronizationManager.unbindResource(emf);
EntityManagerFactoryUtils.closeEntityManager(em);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T13:03:49.283

原因`assertSame`是它根据文档比较对象，而不是它们的值：

**assertSame(java.lang.Object 预期，java.lang.Object 实际) -*断言两个对象引用同一个对象。***

学生的每次检索都会创建一个新`StudentEntity`对象，尽管它们引用相同的数据库条目。尝试缓存您的结果。

# objective-c - UITextView，如何删除返回键：换行符？

> ID：10431667
> 
> 赞同：0
> 
> 时间：2012-05-03T12:45:30.777
> 
> 标签：objective-c, ios, cocoa-touch, uikit, uitextview

我想删除由回车键输入的换行符。但是当我执行以下操作时，它会从文本中删除最后一个字符。为什么？

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text;
{
    NSLog(@"%d  %d  %@ %@",range.location,range.length, text, [textView text]);

    if ( [text isEqualToString:@"\n"] ) {

        NSString *s = [textView text];
        s = [s substringToIndex:[s length] - 1]; // <------------

        [tvText setText:[NSString stringWithFormat:@"%@\n>>",s]];
    }
    return YES;
} 
```

* * *

我希望结果看起来像：

```
>>name
>>yoda
>>                <---- cursor is moved to the right of ">>" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T12:50:09.380

我认为你可以做这样的事情，

```
 - (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text;
{
    NSLog(@"%d  %d  %@ %@",range.location,range.length, text, [textView text]);

    if ( [text isEqualToString:@"\n"] ) {

        [tvText setText:[NSString stringWithFormat:@"%@\n>>",tvText.text]];
        return NO;
    }
    return YES;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-03T12:51:49.120

或者也许在您阅读字符串之后并将其放入某个子字符串：

```
string = [string stringByReplacingOccurrencesOfString:@"\n;" withString:@""]; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-03T13:03:10.003

shouldChangeTextInRange 是[UITextViewDelegate](http://developer.apple.com/library/ios/#DOCUMENTATION/UIKit/Reference/UITextViewDelegate_Protocol/Reference/UITextViewDelegate.html)的一部分，在 textView中更改新文本**之前**调用。因此，您可以这样做：

```
- (BOOL)textView:(UITextView *)textView shouldChangeTextInRange:(NSRange)range replacementText:(NSString *)text;
{
    if ([text isEqualToString:@"\n"])
    {
        return NO;
    }

    return YES;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-08-27T09:22:20.320

使用它以获得更好的解决方案，因为它不允许用户在任何情况下发布任何空白消息。

```
//These for loops will remove the spaces and new line characters from start and end of the string

    //&&//

    NSMutableString *temp = [[NSMutableString alloc] initWithString:posttextview.text];

    //Remove spaces and new line characters from start
    for(int i = 0; i < yourtext.length; i++)
    {
        NSString *temp1 = [NSMutableString stringWithString:[temp substringWithRange:NSMakeRange(0,1)]];

        if([temp1 isEqualToString:@"\n"] || [temp1 isEqualToString:@" "])
        {
            [temp deleteCharactersInRange:NSMakeRange(0,1)];
        }

        else
        {
            break;
        }
    }

    yourtext.text = temp;

    //Remove spaces and new line characters from end
    for(int i = 0; i < yourtext.length; i++)
    {
        NSString *temp1 = [NSMutableString stringWithString:[temp substringWithRange:NSMakeRange(posttextview.text.length - 1,1)]];

        if([temp1 isEqualToString:@"\n"] || [temp1 isEqualToString:@" "])
        {
            [temp deleteCharactersInRange:NSMakeRange(posttextview.text.length - 1,1)];

            yourtext.text = temp;
        }

        else
        {
            break;
        }
    }

    yourtext.text = temp;

    //**// 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-03T12:52:38.743

问题是调用 shouldChangeCharactersImRange 的时间，新文本实际上还没有改变（这就是为什么它没有命名为 didChangeCharactersInRange ...）。因此，如果您遇到换行符，请不要欺骗子字符串，只需存储/处理文本视图到目前为止包含的字符串，然后返回 NO。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-03T13:19:50.620

首先在 .h 文件中添加 UITextViewDelegate

```
@interface YourClass : UITextField <UITextFieldDelegate> {
} 
```

然后实现委托方法

```
-(BOOL)shouldChangeCharactersInRange:replacementString: 
```

# ember.js - 如何从 DOM 中的现有元素设置子视图元素

> ID：10431669
> 
> 赞同：2
> 
> 时间：2012-05-03T12:45:36.567
> 
> 标签：ember.js, kineticjs

假设我有以下 DOM：

```
<div id="container">
   <div id="created-by-other-tools">I want this to be my child</div>
</div> 
```

div“容器”来自 Ember.ContainerView ：

```
container = Ember.ContainerView.create {
        elementId: 'container'
} 
```

div "created-by-other-tools" 来自另一个与 Ember 无关的 javascript 代码：

```
newDiv = document.createElement('div')
container.appendChild(newDiv) 
```

是否可以将此 newDiv 与我的容器的子视图链接？我想要这样的东西：

```
 child = Ember.View.create()
 Ember.set(child,'element',newDiv) 
```

我的想法是用我的子视图处理 newDiv 事件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T13:04:52.153

我已经使用 KinectJS 和 Ember.js 创建了一个示例，请参阅[http://jsfiddle.net/pangratz666/e6Dfh/](http://jsfiddle.net/pangratz666/e6Dfh/)

```
Ember.View.create({
    didInsertElement: function() {
        var id = this.get('elementId');
        var stage = new Kinetic.Stage({
            container: id,
            width: 578,
            height: 200
        });

        var layer = new Kinetic.Layer();
        ...
    }
}).append(); 
```

另请查看此博客文章：http: [//blog.sproutcore.com/using-raphael-js-with-sproutcore-2-0/](http://blog.sproutcore.com/using-raphael-js-with-sproutcore-2-0/)。为 SproutCore 2.0 编写的所有内容都很难，它可能会对您有所帮助。

# java - 从 servlet 调用 jsp 时出现异常？

> ID：10431674
> 
> 赞同：1
> 
> 时间：2012-05-03T12:45:50.217
> 
> 标签：java, jsp, servlets

我有一个jsp。它在 jsp 加载时调用一个 servlet，并以如下相同的 jsp 显示结果。

一些.jsp

```
<html>

    <jsp:include page="/HelloWorld"/>

    <%Iterator itr;%>
<% List data= (List)request.getAttribute("results");
for (itr=data.iterator(); itr.hasNext(); )
{
%>

<TABLE align="center" cellpadding="15" border="1" style="background-color: #ffffcc;">
                    <TR>
                        <TD align="center"><%=itr.next()%></TD>
                    </TR>

            </TABLE>

<%}%>

    </body>
</html> 
```

在 servlet 中，我将结果存储在 request 中，并使用 requestdispatcher 来调用 jsp，如下所示。

```
public class SomeServlet extends HttpServlet {

    public void doGet(HttpServletRequest request, 
              HttpServletResponse response)
              throws ServletException,IOException{

        List<String> list = new ArrayList<String>();

        //some logic to populate list

        request.setAttribute("results", list);
        request.getRequestDispatcher("/WEB-INF/Some.jsp").forward(request, response);

              }

} 
```

但是在jsp中显示结果时我遇到了异常：

```
java.io.IOException: Stream closed
    at org.apache.jasper.runtime.JspWriterImpl.ensureOpen(JspWriterImpl.java:202)
    at org.apache.jasper.runtime.JspWriterImpl.clearBuffer(JspWriterImpl.java:157) 
```

请帮我..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:59:20.147

JSP包含servlet，它转发给JSP，它包含servlet，它转发给JSP，它包含servlet，它转发给JSP，它包含servlet，它转发给JSP，它包含servlet，哪个转发给JSP，里面包含servlet，转发给JSP，里面包含servlet，转发给JSP...

你在这里有一个严重的设计问题。采用 MVC 原则：所有请求都转到一个 servlet（控制器），它加载模型，并分派到适当的 JSP（视图）。一个视图不应该包含一个 servlet，当然也不应该以这样的递归方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T13:01:25.917

您不能在 jsp:iclude 标记中提供 servlet url 模式。原因是它不知道调用get方法还是ost方法。您应该只提供 jsp 路径。

# bing-maps - 隐藏地图层时，Bing Maps Ajax v7 方向模块错误地设置了边界

> ID：10431683
> 
> 赞同：0
> 
> 时间：2012-05-03T12:46:13.973
> 
> 标签：bing-maps

我有一个相对简单的网络应用程序，它允许用户输入两个航路点（从和到位置），然后单击一个按钮以获取路线路线和地图，路线路径绘制在地图上。

该应用程序的布局使得表格、行程和地图在单独的“选项卡”中以及图层可以根据选项卡选择显示和隐藏。

奇怪的是，尽管正确绘制了图钉（航路点）和路线路径，但地图总是会缩小到最小缩放（整个世界视图），但地图边界并未得到遵守。如果地图可见，则遵循这些路线路径边界并且地图按预期运行。

一个例子在这里：http: [//jsfiddle.net/junto/DMR2T/](http://jsfiddle.net/junto/DMR2T/)

当地图可见时单击“获取方向”，地图将缩放到正确的边界。然后切换地图并再次单击“获取路线”。将地图切换回可见。您会看到地图的缩放级别和范围不正确。

Google Chrome、Safari、Firefox 的最新版本都显示此问题。Internet Explorer 没有。

这是一个错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T16:18:47.653

我的猜测是，为了正确计算缩放和边界，地图需要知道它的显示尺寸。为了让地图知道这一点，它需要是可见的。因此，一种解决方法是将地图移出屏幕而不是隐藏它。

在此处查看我的更新示例：http: [//jsfiddle.net/ZWzjC/](http://jsfiddle.net/ZWzjC/)

在我的示例中，我只是设置了一个负的左边距，我确信有更聪明的方法可以将某些内容移出屏幕，同时保持其可见性。我尝试使用 visibility:hidden 但这似乎并没有正确隐藏地图。display:none 不起作用，因为这会导致地图的维度为 0，这就是 .toggle() 可能在内部使用的内容。

# google-drive-api - 驱动 API 配额

> ID：10431688
> 
> 赞同：1
> 
> 时间：2012-05-03T12:46:27.190
> 
> 标签：google-drive-api

dash sugestes 500k的驱动器api是否有配额，但那是一天还是一个月？我们可以要求增加配额吗？我也可以使用选择器从外部应用程序中选择所有谷歌驱动器文件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T16:28:49.247

API 控制台中的配额是每天，它实际上应该是“500,000 个查询/天”。要询问更多，只需单击旁边的“请求更多...”链接并填写表格。

您可以使用选取器显示当前经过身份验证的用户的云端硬盘文件列表。[在https://developers.google.com/drive/integrate-open](https://developers.google.com/drive/integrate-open)查看文档

# windows - 这些奇怪的环境变量是什么？

> ID：10431689
> 
> 赞同：17
> 
> 时间：2012-05-03T12:46:28.487
> 
> 标签：windows, winapi, environment-variables

我`GetEnvironmentString()`用来获取程序的环境变量。

每个程序在第一个都有这样的结果：

```
=::=::\ 
```

我不知道这是什么意思？

这是代码：

```
LPWCH lpEnvString=GetEnvironmentStringsW();
 LPWSTR lpszVariable=(LPWSTR)lpEnvString;
 while (*lpszVariable)
 {
     wprintf(L"%s\n",lpszVariable);
     lpszVariable+=wcslen(lpszVariable)+1;
 }
 FreeEnvironmentStringsW(lpEnvString); 
```

此外，如果我们开始列出这些变量，我们会看到如下内容：

```
=::=::\
=C:=C:\Users\username\value
=ExitCode=00000001
ALLUSERSPROFILE=C:\ProgramData
APPDATA=C:\Users\artik\AppData\Roaming
CommonProgramFiles=C:\Program Files (x86)\Common Files
CommonProgramFiles(x86)=C:\Program Files (x86)\Common Files
CommonProgramW6432=C:\Program Files\Common Files
... 
```

另一方面，`getenv("=ExitCode")`或`getenv("=C:")`返回 NULL。

您能否提供有关此“功能”的适当文档，例如`getenv()`忽略此类字符串以及应如何处理此类值？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-05T01:34:08.193

它们是 cmd.exe 模拟 ms-dos 目录处理的遗留物，它们基本上没有什么用，而且比任何东西都更古老。本质上，它跟踪每个驱动器的当前目录，并作为环境变量保存以轻松传递给其他进程。

# tridion - Tridion 2009 事件系统到 2011 SP1

> ID：10431698
> 
> 赞同：3
> 
> 时间：2012-05-03T12:47:01.730
> 
> 标签：tridion, tridion2009

将 .Net Events 系统从 Tridion 2009 升级到 Tridion 2011 SP1。

有没有人简要概述所涉及的步骤？

什么是事件配置 XML 文件的替代品，以将事件限制到特定的发布？

我已经查看了新事件系统实现的订阅方法，但可以在每个发布中应用事件。到目前为止，唯一的方法似乎是在代码中而不是配置中实现发布过滤器逻辑？

非常感谢任何输入！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T12:48:45.533

这是一个非常好的开始。[由巴特·考普曼](https://stackoverflow.com/users/1220542/bart-koopman)撰写

[http://www.sdltridionworld.com/articles/sdltridion2011/sdltridion2011eventsystem.aspx](http://www.sdltridionworld.com/articles/sdltridion2011/sdltridion2011eventsystem.aspx)

它包括一个用于将旧事件映射到新事件阶段的[矩阵](http://www.sdltridionworld.com/images/event_matrix_tcm89-18738.pdf)。

据我所知，您仍然需要根据出版物选择是否从您的代码中执行您的代码。您不能为特定发布订阅特定事件。

# dll - Griaule 生物识别 DLL 控件在 64 位操作系统中不起作用

> ID：10431706
> 
> 赞同：2
> 
> 时间：2012-05-03T12:47:21.643
> 
> 标签：dll, 64-bit, biometrics

我们从**Griaule biometrics**购买了许可的**生物识别**控制。**我们在窗口应用程序的窗体**上使用此控件。该 控件在**32 位**操作系统上运行良好。****`AxInterop.GrFingerXLib Dll`****

 ******但是由于某种原因，我们将操作系统从**32 bit**t 更改为 **64 bit**。在**64 位**操作系统上，我们使用控件的窗体`AxInterop.GrFingerXLib DLL`无法创建。

如果我们从表单中删除控件工作正常。

我们使用最新版本的**指纹 SDK 2009**，但它仍然无法正常工作。

我们也这样做了，我们从表单中删除了控件，然后再次在表单中包含控件，然后它给出了一些`ActiveX control not find`相关的错误。

我们使用的是**Visual Studio 2008**和**Windows Server 2008 64 位**操作系统。

它的紧迫问题，我们希望尽快解决它。

请提供必要的支持。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T10:42:54.490

我找到了解决方案当我使用 x86 配置构建 .EXE 时，问题已解决

我遵循的步骤构建->配置管理

这里设置应用程序的目标平台。到 x86

构建项目

你会在 Bin 目录下找到一个新创建的文件夹 x86

在 64 位机器上使用这个 Exe 就可以了！******

# asp.net - ASP 页面性能很差，并且在不同环境中差异很大

> ID：10431708
> 
> 赞同：3
> 
> 时间：2012-05-03T12:47:31.320
> 
> 标签：asp.net, webforms

首先道歉我不能更具体，好像我可以然后我可能知道在哪里看。我有一个 ASP.net Web 应用程序，其中包含一堆使用 AjaxControlToolKit 的页面。我的两个环境之间的页面渲染速度差异很大。一方面`~5 seconds`，渲染一个相对简单的页面非常慢，该页面有两个网格和一堆控件。我到处看文章都说“检查你的 SQL”，但这不可能是因为 SQL 性能应该在所有环境中都是通用的。我还把它缩小到页面只是做一个基本的回发，没有sql，问题仍然是repro。用户单击全选，我们检查列表中的一堆项目。我为此计时了后面的代码，而且速度很快`00:00:00.0002178`。

这两个环境并排坐在一起，位置相同，都有 IE9，除了一个在 W2K8 上运行，一个在 W7 上运行。这是唯一真正的区别。在 W7 上，页面的渲染速度*相对较快。*

任何指针都非常感谢。

编辑：

将调试更改为 false 确实产生了积极影响。

调试页面时间 True 0.143363802770544 False 0.0377570798614921

因此，我接下来要做的是系统地查看应用程序的每个组件，以了解我为什么会犯错误、SQL、ViewState 等。我将为那些感兴趣的人更新我的最终发现。

谢谢大家的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T13:30:26.510

我会检查以下内容

1.  通过任务管理器（Web 应用程序和数据库）检查服务器上的 CPU 使用率。是不是刷爆了

2.  服务器的物理内存是否不足 - 再次是任务管理器

3.  返回的页面是否很大。这很明显，但有时并非如此。绝对数量的 HTML 可以杀死一个页面。这可能是隐藏的（ViewState，带有 display:'none' 的元素）或实际上在页面上，但您已经习惯于看，以至于看不到

4.  得到小提琴手。您是否调用了任何不应该调用的外部资源。也许您所依赖的 Web 服务突然无法从特定的盒子访问。我们有一个 twitter 提要超时，这完全杀死了一个网站。

5.  对数据库进行概要分析。你认为不可能，但你确定。你确定你确定。您可能不会在没有意识到的情况下将同类与同类进行比较并在一次测试中带回大量数据。

6.  某些进程对页面/数据长度非常敏感。例如，我有一个完全失败的正则表达式，一旦页面达到一定大小，页面就会超时。表演几乎没有结束 - 它停止了（写得很糟糕 - 谁做的 - 呃我！！）

7.  实体盒子是不是快死了。他们是否还有其他正在杀死它的进程/站点。你和谁共享盒子？硬盘是出路了吗？

8.  防火墙可能很顽皮。通过重新启动物理防火墙，我们看到了性能的大幅提升。你能追踪那些数据包吗？

任何会有更多 - 性能调试可能是一门艺术。但是，嘿-我们都是艺术家，不是吗。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:53:35.483

我可能首先检查我的 web.config 中是否打开了“调试”模式

# ssl - SSL serverhello 消息中的未指定字节

> ID：10431710
> 
> 赞同：2
> 
> 时间：2012-05-03T12:47:37.920
> 
> 标签：ssl, handshake

在 SSL 3.0 握手期间，服务器使用以下 serverhello 消息响应

```
16 03 00 00 51 02 00
00 4d 03 00 4f a1 c1
eb e3 fb 00 a9 c8 25
25 48 6f 89 27 ec bb
80 f3 8c 5d db f7 6c
94 56 d8 34 7a b5 9d
02 20 54 ab 20 ea 05
a6 38 6f ee 55 40 ae
af e2 5d ae 2a 4d c1
c6 f4 09 a7 08 b1 c5
49 39 87 82 d3 f7 00
39 00 00 05 ff 01 00
01 00 
```

我对这个回复的理解如下：

```
Content-type: 22 (Handshake protocol)
Version: 3.0
Length: a1 (81 bytes)

Content-type: 02 (ServerHello)
Length: 4d (77 bytes)
Version: 3.0
Random: 4f a1 c1 eb e3 fb 00 a9
        c8 25 25 48 6f 89 27 ec
        bb 80 f3 8c 5d db f7 6c
        94 56 d8 34 7a b5 9d 02
SessionID Length: 20 (32 bytes)
SessionID: 54 ab 20 ea 05 a6 38 6f
           ee 55 40 ae af e2 5d ae
           2a 4d c1 c6 f4 09 a7 08
           b1 c5 49 39 87 82 d3 f7
Cipher Suite: 00 39
Compression method: 00 
```

但我不明白最后 7 个字节应该如何解释：00 05 ff 01 00 01 00

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:59:01.393

这将是[RFC 5746](https://www.rfc-editor.org/rfc/rfc5746#section-3.2)`renegotiation_info`中定义的扩展：

> ```
> o  If this is the initial handshake for a connection, then the
>    "renegotiated_connection" field is of zero length in both the
>    ClientHello and the ServerHello.  Thus, the entire encoding of the
>    extension is ff 01 00 01 00\.  The first two octets represent the
>    extension type, the third and fourth octets the length of the
>    extension itself, and the final octet the zero length byte for the
>    "renegotiated_connection" field. 
> ```

# batch-file - 将 javac 命令从 .sh 转换为 .bat

> ID：10431712
> 
> 赞同：0
> 
> 时间：2012-05-03T12:47:49.340
> 
> 标签：batch-file, javac, sh

嗨，我在尝试将此 .sh 文件转换为 .bat 文件时遇到了困难。

```
javac -cp $tomcatpath/servlet-api.jar:$openejbpath/javaeeapi-5.0-3.jar 
$webapppath/*.java $webapppath/bean/*.java $webapppath/ejb/*.java 
```

对于熟悉这些文件的人来说，这应该非常简单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:50:55.203

```
javac -cp $tomcatpath\servlet-api.jar;$openejbpath\javaeeapi-5.0-3.jar 
$webapppath\*.java $webapppath\bean\*.java $webapppath\ejb\*.java 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:51:24.987

尝试

```
javac -cp %tomcatpath%/servlet-api.jar;%openejbpath%/javaeeapi-5.0-3.jar 
%webapppath%/*.java %webapppath%/bean/*.java %webapppath%/ejb/*.java 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-04T11:45:03.877

您需要确保在 Windows 安装中正确设置了 tomcatpath、openejbpath 和 webapppath 环境变量。使用命令

```
set tomcatpath=c:\path\to\tomcat
set openejbpath=c:\path\to\openejb 
set webapppath=c:\path\to\webapp 
```

然后运行命令为

```
javac -cp %tomcatpath%\servlet-api.jar;%openejbpath%\javaeeapi-5.0-3.jar %webapppath%\*.java %webapppath%\bean\*.java %webapppath%\ejb\*.java 
```

当然，如果你想使用跨平台构建脚本，你真的应该使用 Ant - [http://ant.apache.org/](http://ant.apache.org/)

# objective-c - cocoa：多按钮设置图片，标签效果

> ID：10431714
> 
> 赞同：0
> 
> 时间：2012-05-03T12:47:55.473
> 
> 标签：objective-c, macos, cocoa

有几个按钮，点击其中一个，改变这个按钮的图片，其他按钮设置另一个图片。下面的代码哪里出错了？

```
NSButton *button = (NSButton *)sender;
NSInteger tag = button.tag;
[button setImage:[NSImage imageNamed:@"menuBtnHover.png"]];
for (int i = 5; i <= 8; i++) {
    if (tag != i) {
        button =[(NSButton *)[self contentView] viewWithTag:i];
        [button setImage:[NSImage imageNamed:@"menuBtn.png"]];
    }
} 
```

**添加测试**，<code>按钮＝`null`

```
NSLog(@"button tag: %ld %d %@", tag,i ,button); 
```

![在此处输入图像描述](../Images/966668321d3d2c1b7e3ef1f8fa5256b3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T14:28:35.173

使用此代码

```
 NSButton *button = (NSButton *)sender;
NSInteger tag = button.tag;
[button setImage:[NSImage imageNamed:@"menuBtnHover.png"]];
for (int i = 5; i <= 8; i++) {
if (tag != i) { button =[(NSButton *)[self contentView] viewWithTag:i];                

   if(button)[button setImage:[NSImage imageNamed:@"menuBtn.png"]];}
  } 
```

# compression - 如何使用 zlib 和 zpipe.c 压缩我的 .php 站点

> ID：10431719
> 
> 赞同：0
> 
> 时间：2012-05-03T12:48:16.423
> 
> 标签：compression, zlib, deflate

我在压缩我的网站时遇到问题。我的主机 (www.one.com) 不支持 gzip，因此我联系了他们以了解任何其他方式来压缩我的网站。首先，我与一位支持者交谈，他告诉我这无法完成，因为他们的服务器是使用 zlib 设置的。所以我用谷歌搜索了 zlib，那里有一些关于这个问题的提示。

我尝试添加：

```
php_flag zlib.output_compression on
php_value zlib.output_compression_level 5 
```

到我的 .htaccess 文件，女巫导致浏览器呈现：“内部服务器错误”。

然后我再次尝试与他们交谈，这次我被指向了这个网站：[http ://www.zlib.net/zlib_how.html](http://www.zlib.net/zlib_how.html)

问题是我以前既没有遇到过 zlib 也没有遇到过 zpipe.c。我试图用谷歌搜索它，并查看不同的论坛，但我不明白。谁能给我一些关于如何让它工作的指示？如何实现 zpipe.c？我在这里是一个完整的菜鸟，所以我会很感激一步一步的指导。

我的网站是用 .php 编写的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T00:57:23.633

我就是这样做的，我使用 one.com 作为托管公司。

我将此行添加到我的索引文件中：

```
 <?php
    ini_set("zlib.output_compression", "On");
    ini_set("zlib.output_compression_level", "-1");
    ?> 
```

这在我的整个网站上增加了压缩 :) myvotebooth.com

然后我将它添加到我的 .htaccess 文件中

```
<IfModule mod_deflate.c>
<FilesMatch "\.(js|css|html)$">
SetOutputFilter DEFLATE
</FilesMatch>
</IfModule> 
```

通过这样做，我得到一个响应头：

```
Web page compressed?    Yes
Compression type?   gzip
Size, Markup (bytes)    11,329
Size, Compressed (bytes)    3,187
Compression %   71.9 
```

我还尝试压缩更多 -2 -3 -4 -5 但 one.com 只允许 -1

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T23:54:41.537

> 首先，我与一位支持者交谈，他告诉我这无法完成，因为他们的服务器是使用 zlib 设置的。

在我看来，他们不知道他们在说什么。你用的是什么http服务器？阿帕奇？不管是什么，它都应该支持使用 gzip 或“deflate”内容编码对您的 html 进行预压缩。您需要找到支持您的服务器并且知道他们在谈论的人。

zlib 是一个压缩例程库，可以压缩为 gzip 或“deflate”内容编码。

我一直将 deflate 放在引号中的原因是 HTTP 标准将 zlib 格式称为“deflate”。它有时会与原始 deflate 混淆，这就是您应该始终使用 gzip 进行 http 传递的原因，因为在这种情况下没有歧义。

*更新：*

由于您使用的是 Apache，因此您可能无需托管公司的帮助即可完成这项工作。您可以将[Apache 指令用于 mod_deflate](http://httpd.apache.org/docs/2.0/mod/mod_deflate.html)您的 .htaccess 文件。这是一个[例子](http://www.techiepark.com/tutorials/how-to-enable-gzip-compression-in-apache-server-to-speed-up-website/)。

# javascript - IE8 不会在插入内容时重新计算 div 的大小

> ID：10431720
> 
> 赞同：0
> 
> 时间：2012-05-03T12:48:16.670
> 
> 标签：javascript, css, internet-explorer-8

所以，现在在这个页面（它是一个开发页面），[http://www.antarctic-design.co.uk/oboe](http://www.antarctic-design.co.uk/oboe)当内容被加载（从 JSON 源动态）时，IE 不会重新计算大小。你知道如何强迫它这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:54:23.287

和

```
.information_block { height: auto; } 
```

您应该解决（或者至少可以使用开发工具 [F12] 注入该样式）

# linux-kernel - 来自文件结构的linux内核完整路径

> ID：10431722
> 
> 赞同：2
> 
> 时间：2012-05-03T12:48:18.840
> 
> 标签：linux-kernel, kernel-module

再会。我试图从结构文件中获取完整路径

```
char *buf = (char*)__get_free_page(GFP_USER);
char *buf2 = (char*)__get_free_page(GFP_USER);

char *name =  dentry_path(file->f_dentry, buf, PAGE_SIZE);
char *root = dentry_path(file->f_vfsmnt->mnt_mountpoint, buf2, PAGE_SIZE);

***some operations***

free_page((unsigned long)buf);
free_page((unsigned long)buf2);
kfree(*root);
kfree(*name); 
```

但我收到一个错误 fs/read_write.c:707: error: request for member 'mnt_mountpoint' in something not a structure or union

如何从文件中获取 vsfmount 结构？

内核版本 linux-2.6.37.6

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T05:56:34.077

在内核 2.6 中，您的代码应该可以工作。

在内核 3.0 中，`struct vfsmount`包含`mnt_root`类型为 的成员`struct dentry`。
我认为这会给你安装点路径。

你用的是哪个？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T08:34:48.163

从错误来看，是否有可能`f_vfsmnt`在`file`-struct中分配？

在这种情况下，该`mnt_mountpoint`字段应该可以通过`file->f_vfsmnt.mnt_mountpoint`.

# tridion - 调用 RenderComponentPresentation 时有没有办法传递变量？

> ID：10431725
> 
> 赞同：11
> 
> 时间：2012-05-03T12:48:29.063
> 
> 标签：tridion, tridion2009

> **可能重复：**
> [SDL Tridion 中 Dreamweaver 模板中的变量设置](https://stackoverflow.com/questions/10208580/variable-setting-in-dreamweaver-template-in-sdl-tridion)

我们使用`RenderComponentPresentation`（在 Tridion 2009 上）呈现内部和外部链接，以便代码库仅在一个 Dreamweaver 模板中。如果我们可以通过一个可选的 CSS 类在渲染链接时使用，那将会很有帮助。

任何想法如何做到这一点？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-03T12:52:53.273

可以在 RenderContext 中设置一个值，然后在第二个 Dreamweaver 模板中检索它。

在调用 RenderComponentPresentation 之前设置渲染上下文值，如下所示：

```
@@SetRenderContextVariable("CSSClass","red")@@ 
```

您将需要一个 C# 片段或 TBB 以从渲染上下文中获取变量并将它们添加到第二个 Dreamweaver 模板中的包中。一个例子是：

```
var renderContext = engine.PublishingContext.RenderContext;
foreach (string key in renderContext.ContextVariables.Keys)
{
    var value = renderContext.ContextVariables[key] as string;
    var item = package.CreateStringItem(ContentType.Text, value);
    package.PushItem("RenderContextVariable."+key, item);
} 
```

然后，您应该能够使用标准 Dreamweaver 表示法访问包中的变量

```
@@RenderContextVariable.CSSClass@@ 
```

希望这可以帮助！

# java - 如何在两个 JTable 之间切换？

> ID：10431729
> 
> 赞同：0
> 
> 时间：2012-05-03T12:48:42.770
> 
> 标签：java, swing, jtable, jscrollpane

所以我在一个有效的框架内的 JScrollPane 中有一个 JTable。我想要做的是将正在显示的表格更改为另一个表格，该表格显示一些其他信息并且具有更多/更少的列/行。我该怎么做呢？

我尝试过将另一个表放入 ScrollPane 之类的方法，但这不起作用，如果我将 ScrollPane 重新放入框架中，它就会消失。

编辑：

我认为这就是与这个问题有关的所有代码。我只是调用函数来改变视图。

```
 Object[][] userData = new Object[50][6];
    userTable = new JTable(userData, new String[] { "Namn", "Adress", 
            "Telefon", "Personnummer", "PIN", "Antal cyklar" }) {
        public boolean isCellEditable(int rowIndex, int colIndex) {
            return false;
        }
    };
    userTable.setSelectionMode(0);
    userTable.getTableHeader().setReorderingAllowed(false);
    Object[][] bikeData = new Object[50][7];
    bikeTable = new JTable(bikeData, new String[] { "Ägare", "Streckkod", 
            "Färg", "Märke", "Ram-nummer", "Senast hämtad", "Senast lämnad" }) {
        public boolean isCellEditable(int rowIndex, int colIndex) {
            return false;
        }
    };
    bikeTable.setSelectionMode(0);
    bikeTable.getTableHeader().setReorderingAllowed(false);
    JScrollPane tablePane = new JScrollPane(bikeTable);
    frame.add(tablePane);

    frame.setVisible(true);
}

public void displayUsers(){
    tablePane.setViewportView(userTable);
}

public void displayBikes(){
    tablePane.setViewportView(bikeTable);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T13:01:20.780

你有没有试过这个：

```
scrollPane.setViewportView(yourNewTable); 
```

这应该替换滚动窗格中显示的组件。当然，您可以随时更改 JTable 的模型及其列，但这不是我的偏好。

编辑：这是一个展示这一点的片段：

```
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.Vector;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.event.TableModelListener;
import javax.swing.table.TableModel;

public class Test {

    public static void main(String... args) {
        JFrame frame = new JFrame();
        final Vector<String> string = new Vector<String>();
        final JTable table = new JTable(getTableModel("First", 1));
        final JTable table2 = new JTable(getTableModel("Second", 3));
        final JButton click = new JButton("Click me");
        final JScrollPane scrollPane = new JScrollPane(table);
        click.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                if (table2.getParent() == null) {
                    scrollPane.setViewportView(table2);
                } else {
                    scrollPane.setViewportView(table);
                }
            }
        });
        JPanel panel = new JPanel(new BorderLayout());
        panel.add(click, BorderLayout.EAST);
        panel.add(scrollPane);
        frame.getContentPane().add(panel);
        frame.pack();
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        frame.setVisible(true);
    }

    private static TableModel getTableModel(final String prefix, final int colCount) {
        return new TableModel() {

            @Override
            public void setValueAt(Object aValue, int rowIndex, int columnIndex) {
                // TODO Auto-generated method stub

            }

            @Override
            public void removeTableModelListener(TableModelListener l) {
                // TODO Auto-generated method stub

            }

            @Override
            public boolean isCellEditable(int rowIndex, int columnIndex) {
                // TODO Auto-generated method stub
                return false;
            }

            @Override
            public Object getValueAt(int rowIndex, int columnIndex) {
                return prefix + "Hello cell (" + rowIndex + "," + columnIndex + ")";
            }

            @Override
            public int getRowCount() {
                return 30;
            }

            @Override
            public String getColumnName(int columnIndex) {
                return "Column " + columnIndex;
            }

            @Override
            public int getColumnCount() {
                return colCount;
            }

            @Override
            public Class<?> getColumnClass(int columnIndex) {
                return String.class;
            }

            @Override
            public void addTableModelListener(TableModelListener l) {
                // TODO Auto-generated method stub

            }
        };
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T12:51:22.220

如果您更改底层模型，它应该可以工作。

```
table.setModel(newModel) 
```

如果您对某些单元格/列执行特殊操作，您可能还需要更新渲染器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T13:02:50.037

如果您要维护两个 jTable（带有两个模型），那么最简单的方法可能是简单地设置滚动窗格的视口：

```
jscrollpane.setViewportView(mySecondJTable); 
```

然后切换回来：

```
jscrollpane.setViewportView(myFirstJTable); 
```

# ruby-on-rails - 在 Ruby on Rails 中隐藏字段

> ID：10431741
> 
> 赞同：9
> 
> 时间：2012-05-03T12:49:17.000
> 
> 标签：ruby-on-rails, ruby, database, blogs, field

我的数据库中有一个名为 IP 的字段，当他在 Rails 内置的博客中发送消息时，我将用户 IP（在 #create 方法中）放在其中。

但是当我想以另一种格式（JSON）查看文章时，该字段是可见的。如何隐藏字段 IP？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-03T13:03:28.043

您可以在控制器中的格式块中执行此操作，如下所示：

```
respond_to do |format|
  format.json { render :json => @user, :except=> [:ip] } # or without format block: @user.to_json(:except => :ip)
end 
```

如果您想普遍排除特定字段，只需覆盖用户模型中的 to_json 方法：

```
class User < ActiveRecord::Base
  def to_json(options={})
    options[:except] ||= [:ip]
    super(options)
  end
end 
```

**更新**：在 Rails 6 中，该方法变为`as_json`：

```
class User < ApplicationRecord
  def as_json(options={})
    options[:except] ||= [:ip]
    super(options)
  end
end 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-05-22T16:20:38.443

虽然这不是密码或特别要求的正确解决方案，但当您在 ​​Google 上隐藏 ActiveRecord 中的列时，就会出现这种情况，所以我将把它放在这里。

Rails5 引入了新的 API，`ignored_columns`可以让 activerecord 忽略一个列的完全存在。这是*我*真正想要的，许多其他通过谷歌到达这里的人可能也这样做了。

我自己还没有尝试过。

```
class User < ApplicationRecord
  self.ignored_columns = %w(employee_email)
end 
```

[https://blog.bigbinary.com/2016/05/24/rails-5-adds-active-record-ignored-columns.html](https://blog.bigbinary.com/2016/05/24/rails-5-adds-active-record-ignored-columns.html)

# scorm - 在 LMS、SCORM 中存储信息

> ID：10431751
> 
> 赞同：3
> 
> 时间：2012-05-03T12:50:05.827
> 
> 标签：scorm, scorm2004, scorm1.2

我正在阅读从 ADL 网站下载的 pdf“程序员 SCORM 用户指南”，我了解到我们只能在 LMS 中存储一些特定的信息集；比如学习者的名字、分数等。

我想知道我是否可以制作一个 SCO，它可以将我的 OWN 信息集存储在 LMS 中。假设如果我正在评估 SCO，我将如何存储学习者对每个问题的回答，然后以某种方式从 LMS 中获取？有可能吗？在 LMS 中存储我自己的信息？

亲切的问候，谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-03T15:09:19.193

SCORM 目前没有允许扩展存储特定新数据元素的机制。

但是，它确实为您提供了存储桶，您可以使用这些存储桶以文本格式存储您自己的数据，以便以后检索。这将允许您存储和检索数据，但 LMS 通常不会理解它。cmi.suspend 数据是为此目的最常用的字段。在 SCORM 2004 第 4 版中，还有一个更大、更健壮的 adl.data 结构。

如果您想报告学习者对问题的回答，可以使用一组 SCORM 数据模型元素。查看[SCORM Run-Time Reference Chart](http://scorm.com/scorm-explained/technical-scorm/run-time/run-time-reference/)中的 cmi.interactions 集合。

如果您确实需要开始存储比 SCORM 当前允许的更具表现力的数据，您应该查看即将推出的下一代 SCORM，即[Tin Can API](http://scorm.com/tincan/)。这还没有被广泛部署，但您将在接下来的几个月中开始看到早期的实施。

# linux - 如果语句在 shell 脚本中抛出意外的文件结尾

> ID：10431757
> 
> 赞同：2
> 
> 时间：2012-05-03T12:50:35.687
> 
> 标签：linux, bash, shell

每当我运行此脚本时，查找部分都会执行，但 if 语句会导致此错误：

```
./list_datasheets.csh: line 13: syntax error: unexpected end of file 
```

这是脚本：

```
find $1  -type d | while read -r dir
    do
    for f in ${dir}/*
    do
        echo ${f} | tr '[A-Z]' '[a-z]'
    done
done
if ($2 == "both") then 
    echo 'bye'
else
    echo 'hi'
endif 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-03T12:52:08.617

尝试将最后一行 ( `endif`)替换为`fi`，这是关闭`if`语句的正确标记。

另外，替换`($2 == "both")`为正确的`[ $2 == "both" ]`.

哦，然后，实际上`if`应该写成：

```
 if [ "$2" == "both" ]; then
      echo 'bye'
   else
      echo 'hi'
   fi 
```

注意周围的引号`$2`，前后的空格`[`和之前的`]`空格。`;``then`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T12:52:44.613

您需要以a和 not结束该`if`块。`fi``endif`

我猜你对在 C 和 C++`#endif`中关闭块的方式感到困惑。`#if`

# build - 在其他虚拟机上使用代理 TFS 2010

> ID：10431759
> 
> 赞同：3
> 
> 时间：2012-05-03T12:50:39.540
> 
> 标签：build, controller, agent

我的构建定义已经存在问题。我解释 ：

1.  我的服务器上有 1 个控制器

2.  此服务器上有 1 个默认代理

3.  虚拟机上的 1 个默认代理。

当我使用服务器上的代理构建我的项目时，一切都很好。但是当我禁用此代理并使用我的虚拟机上存在的代理时，我遇到了这个问题：

**MSBUILD : 错误 MSB4016: Arrêt inattendu de la génération, car le journal "WorkflowCentralLogger" a échoué de manière inattendue lors de l'initialisation。TF214007 : aucune build n'a été trouvée avec l'URI vstfs:///Build/Build/236。L'URI n'existe pas ou MS(nameofmachinevirtual)$ ne dispose pas des autorisations pour y accéder。**

**TF270015：“MSBuild.exe”返回了意外的退出代码。预期为“0”；实际的“1”。**

对不起，是法语...

我使用管理员帐户来避免一些权限问题...

当我想重新启动我的虚拟机上的构建服务时，我有这个：

管理控制台和构建服务之间的通信失败：

**在您的本地计算机上找不到管道端点“net.pipe://build/ServiceHost/8”。这通常是由 Build Service 处于不正确状态引起的。**

如果有人可以帮助我，因为我从 1 周开始就阻止了它......对不起我的英语......

最好的问候马克西姆 SZAC。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T14:37:17.977

这可能只是一个权限问题：
转到团队资源管理器并右键单击构建定义所在的团队项目。选择“团队项目设置”>“组成员资格...”。您可能希望将您的虚拟机添加到`[TeamProject]\Builders`组中。

为此，请双击组，按“添加成员”>“Windows 用户或组”，然后在“对象类型”中选择“计算机”
![在此处输入图像描述](../Images/69d841bd0fed9d34b5e7b4f65bb7920e.png)
如果然后输入 (VM-Name)$，则应该可以找到您的 VM .

# jquery - 来自 Twitter IE7 错误的引导程序

> ID：10431767
> 
> 赞同：12
> 
> 时间：2012-05-03T12:51:01.510
> 
> 标签：jquery, html, css, twitter-bootstrap

我在 IE7 中创建的网站中发现了一个错误。

网站网址： http: [//moldipaints-dokkum.nl/productcontroller/getProductList/19](http://moldipaints-dokkum.nl/productcontroller/getProductList/19)

在 IE7 中打开产品时，引导模式位于页面后面，灰色覆盖层位于顶部。并且图像位于模态之上。

我更改了以下内容：

css 位置：相对/绝对/固定（只有模态显示不正确）

css z-index ：（没有任何区别）

潜在修复推特（Github）；[http://jsfiddle.net/ATeaH/8/](http://jsfiddle.net/ATeaH/8/)

这些都不是正确的。我能做些什么来完成这项工作？

**从项目更新代码**

页面渲染

```
 <?php
    if(isset($productByType)){
        $countwidth = (count($productByType) / 2)*260+100;
    }?>

    <div class="productView">
        <div class="aligndiv">
           <div class="productcenter">
               <div class="productenview">
                   <div class="productcontainer" style="width:<?=@$countwidth?>px;" >
                       <?php
                       if(!empty($productByType)){
                       for($i=0;$i < count($productByType); $i++){

                       $id = $productByType[$i]['id'];
                       $title = $productByType[$i]['title'];
                       $img = base_url('/img/producten/'.$productByType[$i]["img"]);

                       if($i % 2 == 0){
                          echo '<div class="seperatorforproduct">';
                       //0,2,4,6,8
                       }

                    echo '<div class="button btnstyle">';
                    echo '<div class="imgbtn">';    
                    //  <!-- afbeelding -->
                    echo '<img src="'.$img.'" title="'.$title.'" alt="'.$title.'" data-toggle="modal" href="#modal'.$id.'" />';
                    echo '</div>';  
                    echo '<div class="txtbtn txtstyle">';   
                    echo '<a class="btn" data-toggle="modal" href="#modal'.$id.'" >'.$title.'</a>';
                    echo '</div>';
                    echo '</div>';
                    ?>
                    <div class="modal" style="display:none;" id="modal<?=$id?>">
                        <div class="modal-header">
                            <a class="close" data-dismiss="modal">&times;</a>
                            <h2><?=$title?></h2>
                        </div>
                        <div class="modal-body">
                            <div class="modal-left">
                            <img src="<?=$img?>" title="<?=$title?>" alt="<?=$title?>" />
                            </div>
                            <div class="modal-right">
                            <p><?=$productByType[$i]['info']?></p>
                            </div>
                        </div>
                        <div class="modal-footer">
                            Neem contact op met Moldipaints-Dokkum.nl voor meer informatie, telefoonnummer: 0519-297409
                        </div>
                    </div>

                    <?php
                    if($i % 2 == 1 || $i == count($productByType)){
                        // 0,3,6,9,12
                        echo '</div>';
                    }
                }      
            }?> 
        </div>
    </div>
</div> 
```

CSS 引导程序

```
 .modal-backdrop {
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      z-index: 10;
      background-color: #000000;
    }
    .modal {
      position: absolute;
      top: 50%;
      left: 50%;
      z-index: 1000;
      min-height: 500px;
      width: 700px;
      margin: -275px -380px;
      background-color: #ffffff;
      border: 1px solid #999;
      border: 1px solid rgba(0, 0, 0, 0.3);
      *border: 1px solid #999;
      /* IE6-7 */

      -webkit-border-radius: 6px;
      -moz-border-radius: 6px;
      border-radius: 6px;
      -webkit-box-shadow: 0 3px 7px rgba(0, 0, 0, 0.3);
      -moz-box-shadow: 0 3px 7px rgba(0, 0, 0, 0.3);
      box-shadow: 0 3px 7px rgba(0, 0, 0, 0.3);
      -webkit-background-clip: padding-box;
      -moz-background-clip: padding-box;
      background-clip: padding-box;
      } 
```

CSS 样式项目

```
 /*   Producten   */
    .productView{position:absolute; width:100%; height:700px; top:50px; margin:auto;}
    .aligndiv{position:relative; width:1024px; margin:auto;}
    .productcenter{width:1024px; height:500px; margin:auto;}
    .productenview{position:relative; width:480px; height: 600px; overflow-x:scroll; overflow-y:hidden; float:left; left:10%; margin:auto; margin-right:300px}
    .productcontainer{height: 400px; margin-top:90px; z-index:0;}
    .productmenu{position:absolute; width:300px; top:100px; right:5%; z-index:0;}
    .seperatorforproduct{position:relative; width:240px; height:480px; float:left;} 
```

先感谢您

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-11T22:31:21.967

我在 IE7 中的模式弹出窗口中遇到了同样的问题。模态对话框显示在模态背景下。但是，添加这个 javascript DID 为我解决了这个问题：

```
$('.fixedVersion .modal').appendTo($("body")); 
```

更多细节在这里：http: [//jsfiddle.net/ATeaH/8/](http://jsfiddle.net/ATeaH/8/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-11T19:23:25.347

我遇到了同样的问题，最终通过以下方式解决了这个问题：1）确保我的所有模式对话框都**没有**嵌套在 HTML 层次结构中，而是在根级别（就在里面`<body>`）和 2）在 HTML 文档的末尾。

上述两个条件可能有点矫枉过正，但它为我解决了这个问题。

# jquery - 本地 Ajax 调用成功但没有返回数据

> ID：10431774
> 
> 赞同：3
> 
> 时间：2012-05-03T12:51:31.137
> 
> 标签：jquery, ajax, json

我在 Visual Studio 2010 中创建了两个项目，一个是 Web 服务，另一个是 Web 应用程序，我在 Web 服务上有一个方法如下：

```
`[OperationContract]
    [WebInvoke(Method = "GET",
        ResponseFormat = WebMessageFormat.Json,
        BodyStyle = WebMessageBodyStyle.Wrapped,
        UriTemplate = "json/getData")]
    List<Objects> TestCall();` 
```

运行服务后，我可以愉快地输入 URL 以获取 JSON 响应：

`http://localhost:17258/RestService.svc/json/getData`

结果是

`{"TestCallResult":[{"id":1,"name":"Title"}, {"id":2,"name":"Title"},{"id":3,"name":"Title"},{"id":4,"name":"Title"}]}`

但是，在我的 Web 应用程序中，当我尝试进行此 Ajax 调用以获取此响应时，我从调用中获得了成功，但 JSON 为空，这是我的 ajax 调用：

```
`$.ajax({
                url: "http://localhost:17258/RestService.svc/json/getData",
                type: "GET",
                mimeType: "application/json",
                dataType: "json",
                cache: false,
                success: function (json, status) {
                    alert("Success JSON=" + json + ", status=" + status);
                    var obj = jQuery.parseJSON(json);
                    for (var i = 0; i <= obj.length; i++) {
                        alert(obj[i].id);
                    }
                }
            });` 
```

我在 FireFox 中尝试并且 json 变量返回为 null，在 IE 调试器中进行调试时，我可以向对象添加一个监视，并且可以看到对象下面有数组，我需要使用 json.TestCallResult 代替还是有任何其他人都看到了 IE 和 FireFox 之间的这种差异，或者有人可以说不要再做菜鸟了……

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T13:17:30.373

您的 ajax url 应该与您的 html 的 url 具有相同的 host:port。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-04T07:47:12.007

```
$.ajax({
                url: "http://localhost:17258/RestService.svc/json/getData",
                type: "GET",
                dataType: "json",
                cache: false,
                success: function (obj) {
                    for (var i = 0; i <= obj.length; i++) {
                        alert(obj[i].id);
        }
     }
}); 
```

尝试这个

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T13:41:21.190

在您的成功回调中，您已经获得了一个 json 对象。如果您尝试再次使用 $.parseJSON 解析它，则结果为空。[http://jsfiddle.net/H4v8G/](http://jsfiddle.net/H4v8G/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T13:53:44.973

您需要查看`json.d`而不是`json`.

响应数据包含在`.d`属性中，而不是直接包含在返回的对象中。

这发生在 ASP.NET 3.5 及更高版本中。

# c++ - C++/ 限制类的实例，其他类继承自它

> ID：10431775
> 
> 赞同：1
> 
> 时间：2012-05-03T12:51:37.340
> 
> 标签：c++

我想用 C++ 创建一个类，其他类从它继承。但是我想确保没有人能够从这个类中创建一个实例。

意义：

```
class Animal{
public:
virtual ~Animal() {}
};

class Fish: public Animal{
}; 
```

我想确保：

```
Fish* fish = new Fish(); 
```

有可能，但是

```
Animal* ana = new Animal(); 
```

不会。

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T12:54:11.690

最简单的解决方案是 make`Animal`的构造函数受保护：

```
Class Animal{
protected:
    Animal() {}
public:
    virtual ~Animal() {}
}; 
```

由于 C++ 不提供对*抽象类*的显式支持，但您可以将纯虚函数添加到您的类中以获得类似的效果。如果您没有合适的虚函数来制作纯虚函数，则常见的做法是使您的析构函数纯虚函数，然后在标头之外提供一个实现。

```
Class Animal{
protected:
    Animal() {}
public:
    virtual ~Animal() = 0;
};

Animal::~Animal() {
    // destructor code
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T12:58:00.333

制作抽象类的惯用语是拥有一个纯虚析构函数：

```
struct A
{
   A();
   virtual ~A() = 0;
}; 
```

请注意，您必须为析构函数提供一个实现，即使它被标记为纯：

```
A::~A()
{
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:54:11.347

使其成为一个[抽象类](http://publib.boulder.ibm.com/infocenter/comphelp/v8v101/index.jsp?topic=%2Fcom.ibm.xlcpp8a.doc%2Flanguage%2Fref%2Fcplr142.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-03T12:54:18.727

旧的方法是使 Animal 的构造函数受保护。

C++11 的方式是将构造函数标记为已删除。

# facebook - 将用户重定向到 Facebook 帖子

> ID：10431784
> 
> 赞同：0
> 
> 时间：2012-05-03T12:51:58.787
> 
> 标签：facebook, facebook-graph-api

我想在我的网站上以 facebook 样式显示 facebook 墙贴（按 id），或者重定向用户并将他的注意力集中在 facebook 上的当前帖子上。我已经使用带有我自己的 css 的开放图形显示它，但它应该以另一种方式显示。一般来说，我对第二个变体很感兴趣，它能够在 facebook 上重定向用户并向他展示那个帖子。可能有人知道该怎么做吗？

谢谢，安东。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-07T14:43:45.163

我找到了解决方案，`https://www.facebook.com/permalink.php?story_fbid=$POST_ID&id=$YOUR_ACCOUNT_ID`

# windows-phone-7 - Web 浏览器控件中显示的页面上的背景图像无法拉伸/适合 - Wp7

> ID：10431786
> 
> 赞同：0
> 
> 时间：2012-05-03T12:52:01.573
> 
> 标签：windows-phone-7, webbrowser-control

我正在构建一个带有 Web 浏览器控件的应用程序，其中包含一个移动平台自定义页面。该页面上的背景图像应自动适应窗口。在普通浏览器中访问 URL 时也是如此。但是当在 Web 浏览器控件中显示页面时，它不适合 Web 浏览器窗口。

Web 浏览器控件与屏幕大小相匹配。我在控件上设置为允许的脚本。适用于 android 的 WebView 正确显示页面。

![在此处输入图像描述](../Images/b79e83389daae6281540ba8abafdbe2d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-06T07:41:34.797

我 App.xaml.cs 你的应用程序你必须评论

```
 //Application.Current.Host.Settings.EnableFrameRateCounter = true
  //Application.Current.Host.Settings.EnableRedrawRegions = true
  //Application.Current.Host.Settings.EnableCacheVisualization = true 
```

你会在 public App() 中找到它。

# cron - cronjob 未执行

> ID：10431788
> 
> 赞同：2
> 
> 时间：2012-05-03T12:52:10.727
> 
> 标签：cron, crontab

我在运行 cronjob 时遇到问题。没有这方面的经验，所以可能监督一些nooby。当从 shell 运行时，以下脚本就像一个魅力（所有旧过滤器都从 db 中删除）：

```
dude@linux:~> /usr/bin/env /home/dude/RubyOnRails/myproject/script/rails runner /home/dude/RubyOnRails/myproject/script/delete_old_filters.rb 
```

我使用 chmod 使脚本可执行。现在我希望它使用 cronjob 定期运行：

```
dude@linux:~> crontab -e 
```

这个文件是空的，我把它放在一行上：

```
* * * * * /usr/bin/env /home/dude/RubyOnRails/myproject/script/rails runner /home/dude/RubyOnRails/myproject/script/delete_old_filters.rb 
```

我希望脚本每分钟运行一次，但没有任何反应。在 /etc/cron.deny 中，只提到了“guest”，并且 /etc/allow 不存在。重新启动我的系统也没有帮助。

crontab 似乎被探测地更新了：

```
dude@linux:~> crontab -l
# DO NOT EDIT THIS FILE - edit the master and reinstall.
# (/tmp/crontab.f9Et2M installed on Thu May  3 14:04:47 2012)
# (Cronie version 4.2)
* * * * * /usr/bin/env /home/dude/RubyOnRails/myproject/script/rails runner /home/dude/RubyOnRails/myproject/script/delete_old_filters.rb 
```

但我也有点期待：

```
dude@linux:~> atq
dude@linux:~> 
```

cronjob 做了一些事情。每分钟都会向 /var/log/cron.log 添加一个条目：

```
2012-05-03T15:27:01+02:00 linux /USR/SBIN/CRON[5276]: (dude) CMD (/usr/bin/env /home/dude/RubyOnRails/myproject/script/rails runner /home/dude/RubyOnRails/myproject/script/delete_old_filters.rb) 
```

问题是，作业没有执行。它应该从数据库中删除一些记录，但它没有。手动运行相同的脚本就可以了。

有人看到我错过的（也许是微不足道的）事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-10T20:32:08.063

也许这会有所帮助，使用括号。

`* * * * *`（*冒号分隔的命令执行*）

核实。

# c++ - 如何使用 boost.program_options 处理多个语法命令行参数

> ID：10431793
> 
> 赞同：1
> 
> 时间：2012-05-03T12:52:28.417
> 
> 标签：c++, boost, boost-program-options, command-line-arguments

考虑一个可以在不同模式下使用的实用程序，例如：

utility.exe --mode x（需要一个参数列表）
utility.exe --mode y（需要不同的参数列表）

我如何编写代码来解析 Boost.Program_Options 中的此类参数？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T13:03:56.283

您可以自己解析此模式（或使用 boost 程序选项使用忽略未知选项的方式），然后根据该结果，您可以将 cmd 行参数提供给不同的 boost 程序选项对象。

# wpf - 我们可以将 WinForms 应用程序与 WPF 应用程序集成吗？

> ID：10431798
> 
> 赞同：4
> 
> 时间：2012-05-03T12:52:39.493
> 
> 标签：wpf, winforms, interop

我想将两个现有的应用程序集成为一个。其中一个应用程序基于 Windows 窗体构建，另一个基于 WPF。

有可能实现这一目标吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T12:57:27.497

WPF 提供了[`WindowsFormsHost`](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.windowsformshost.aspx)允许您在 WPF 窗口中承载 WinForms 控件的类；相反，WinForms 提供[`ElementHost`](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.elementhost.aspx)了允许您在表单中承载 WPF 控件的功能。

不幸的是，事情的进展情况在很大程度上取决于你在做什么，上次我检查时有不止一些粗糙的边缘。欲了解更多信息，一定要从[这个 MSDN 页面](http://msdn.microsoft.com/en-us/library/ms751797.aspx)开始。

如果您想在同一个应用程序中拥有“独立”的 WPF 窗口和 WinForms 表单，则*必须*让这两个框架在您的 UI 线程的消息循环中“共享”一些代码。有关如何执行此操作的入门知识，请参见[此处](http://msdn.microsoft.com/en-us/library/aa348549.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:58:52.363

有各种课程可以帮助您解决这个问题。
要在 WPF 窗口中托管 Windows 窗体控件，您可以使用[`WindowsFormsHost`](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.windowsformshost.aspx)该类。要在 Windows 窗体窗口中托管 WPF 控件，您可以使用[`ElementHost`](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.elementhost.aspx)该类。

您可以在此处查看有关该主题的更多信息（Windows 表单部分）：http:
[//msdn.microsoft.com/en-us/library/ms753178.aspx](http://msdn.microsoft.com/en-us/library/ms753178.aspx)

# php - Zend Search Lucene - 搜索特定字段

> ID：10431800
> 
> 赞同：1
> 
> 时间：2012-05-03T12:52:43.050
> 
> 标签：php, zend-framework, zend-search-lucene

我目前已将**Zend_Search_Lucene**设置为我正在从事的项目的搜索引擎。

它在默认级别上运行良好（即搜索所有字段），但是我现在需要搜索特定字段。

这样做的原因是因为我试图编写处理拼写错误的能力。因此，我在文档标题中添加了每个单词的 soundex。

**例如：**

```
$productArray['title'] = 'June Monthly Meat Box';  
$doc = new Zend_Search_Lucene_Document();  
$doc->addField(Zend_Search_Lucene_Field::text('product_title', $productArray['title']));  
$soundex = implode(' ',  array_map('soundex', array_map('trim', preg_split('/ /', $productArray['title'], NULL, PREG_SPLIT_NO_EMPTY))));  
$doc->addField(Zend_Search_Lucene_Field::keyword('soundex', $soundex));  
$index->addDocument($doc); 
```

这会添加“J500 M534 M300 B200”作为 soundex 字段。

**这是执行搜索的方式：**

```
$queryString = trim(urldecode($this->_request->getParam('q')));  
$words = array_map('trim', preg_split('/ /', $queryString, NULL, PREG_SPLIT_NO_EMPTY));    

$query = new Zend_Search_Lucene_Search_Query_Boolean();  
$subquery1 = new Zend_Search_Lucene_Search_Query_MultiTerm();  
foreach($words as $word) 
{  
    $subquery1->addTerm(new Zend_Search_Lucene_Index_Term($word));  
}  

$subquery2 = new Zend_Search_Lucene_Search_Query_MultiTerm();  
foreach($words as $word)
{  
        $subquery2->addTerm(new Zend_Search_Lucene_Index_Term(strtolower(soundex($word)), 'soundex'));  
}  
$query->addSubquery($subquery1);  
$query->addSubquery($subquery2); 
```

变量`$subquery1`存储原始查询的每个单词（这可以自己使用）
变量`$subquery2`存储每个单词的 soundex。计划是在该字段中搜索 soundex 以及每个单词的其他字段。因此，如果有人将 ' **meat** ' 拼写为 ' **maet** '，它会返回结果，因为 soundex 在 ' **M300** ' 处是相同的。

我正在使用[Luke](http://code.google.com/p/luke/)查看数据集并看到正确的术语。当我使用 Luke 搜索 soundex（即。`soundex:M300`）时，它不会返回任何结果，但是如果我搜索整个字段（即。`soundex:"J500 M534 M300 B200"`），它会返回正确的文档。

阻止它在该领域内搜索出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-08T12:44:13.743

如果我正确理解 Zend_Search_Lucene_Field::keyword （您在上面用于“soundex”的内容），它旨在一次存储一个值（如单个日期或单个 URL）。

我认为对于“soundex”字段，您希望改用 Zend_Search_Lucene_Field::text 之类的标记化存储方法，因为听起来您想在“soundex”字段中搜索单个标记，而不仅仅是整个字段值。

# oracle - 将儒略日数转换为 DATE 或 TIMESTAMP 的 Oracle 11.1 错误

> ID：10431804
> 
> 赞同：3
> 
> 时间：2012-05-03T12:52:57.407
> 
> 标签：oracle, oracle11g

[最近的这篇文章](https://stackoverflow.com/questions/10356100/optimizing-this-select-query-with-julian-date-column/10359557#10359557)让我忙于调查 Oracle 中的 Julian 日期转换，并且我发现了我认为是 Oracle 11.1 中的一个错误。测试用例是：

情况1。

```
SELECT TO_CHAR(TO_TIMESTAMP('0', 'J'), 'DD MON SYYYY') FROM DUAL 
```

[这应该返回此处](http://en.wikipedia.org/wiki/Julian_day)定义的“01 JAN -4713” ，但会引发错误

```
ORA-01854: julian date must be between 1 and 5373484 
```

案例 2。

```
SELECT TO_CHAR(TO_TIMESTAMP('1', 'J'), 'DD MON SYYYY') FROM DUAL 
```

这应该返回“02 JAN -4713”作为上述的扩展（比朱利安零日期晚一天），而是返回“01 JAN -4712”（比一年少一天）。

案例 3。

```
SELECT TO_CHAR(TO_TIMESTAMP('1721424', 'J'), 'DD MON SYYYY') FROM DUAL 
```

返回“01 JAN 0001”。没关系（就目前而言）。如果我们从上面的日期值中减去 1，我们希望它返回前一天，即 31 DEC -0001（不存在零年）；但是，当我们执行以下操作时

```
SELECT TO_CHAR(TO_TIMESTAMP('1721423', 'J'), 'DD MON SYYYY') FROM DUAL 
```

抛出以下错误：

```
ORA-01841: (full) year must be between -4713 and +9999, and not be 0 
```

表明 Oracle 已尝试生成零年。

（请注意，尽管在上面的测试用例中使用了 TO_TIMESTAMP，但使用 TO_DATE 时会出现完全相同的问题）。

有谁知道如果

1.  Oracle 已经记录了这些问题？
2.  这些问题在11.2还存在吗？

分享和享受。

* * *

根据 Phil 在下面的回答，这些问题仍然出现在 11.2 中。

克苏鲁fhtagn。

* * *

10.2.0.4 中的相同错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T19:10:11.727

在尝试了解 Oracle 应该做什么时，请查看 Oracle 的[文档](http://docs.oracle.com/cd/E11882_01/server.112/e26088/sql_elements001.htm#SQLRF50988)，“儒略日数是自公元前 4712 年 1 月 1 日以来的天数。”

该措辞确实暗示儒略 1 将是自公元前 4712 年 1 月 1 日起的一天，即 1 月 2 日。然而，儒略日期计算的当前实现已经存在了很长时间，现有代码取决于行为. （我知道如果在 Oracle 中实现的 Julian 的定义发生变化，我们会被搞砸的。）在这一点上，自公元前 4713 年 12 月 31 日以来的几天最多只是一个文档错误。

**编辑在**[Call Interface Programmer's Guide](http://docs.oracle.com/cd/E11882_01/appdev.112/e10646/toc.htm)中找到了Julian 1的[参考资料](http://docs.oracle.com/cd/E11882_01/appdev.112/e10646/oci03typ.htm#LNOCI16288)，即 1 月 1 日。不是普通数据库程序员会看到的地方。

以下解释了维基百科和 Oracle 之间的年份差异：

> Oracle 数据库使用计算儒略日的天文系统，其中公元前 4713 年指定为 -4712。相比之下，计算儒略日的历史系统将公元前 4713 年指定为 -4713。如果您将 Oracle Julian 天数与使用历史系统计算的值进行比较，请注意考虑到 BC 日期的 365 天差异。如需更多信息，请参阅 [http://www.usno.navy.mil/USNO/astronomical-applications/astronomical-information-center/millennium](http://www.usno.navy.mil/USNO/astronomical-applications/astronomical-information-center/millennium)。

案例3对我来说是新闻。谢谢你提出来。我不知道有关该行为的任何参考资料。有关的：

```
SQL> select to_date('0001-01-01', 'YYYY-MM-DD') 
    - to_date ('-0001-12-31', 'SYYYY-MM-DD') from dual;

TO_DATE('0001-01-01','YYYY-MM-DD')-TO_DATE('-0001-12-31','SYYYY-MM-DD')
-----------------------------------------------------------------------
                                                                    367 
```

和

```
SQL> select months_between(to_date('0001-01-01', 'YYYY-MM-DD')
  2      , to_date ('-0001-12-31', 'SYYYY-MM-DD')) from dual;

MONTHS_BETWEEN(TO_DATE('0001-01-01','YYYY-MM-DD'),TO_DATE('-0001-12-31','SYYYY-MM-DD'))
---------------------------------------------------------------------------------------
                                                                             12.0322581 
```

显然，不存在的 0 年是闰年。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T12:58:50.040

以下是在 11.2.0.1.0 上执行的相同查询：

```
PHIL@PHILL11G2 > select * from v$version;

BANNER
--------------------------------------------------------------------------------
Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production
PL/SQL Release 11.2.0.1.0 - Production
CORE    11.2.0.1.0  Production
TNS for Linux: Version 11.2.0.1.0 - Production
NLSRTL Version 11.2.0.1.0 - Production

Elapsed: 00:00:00.04
PHIL@PHILL11G2 > SELECT TO_CHAR(TO_TIMESTAMP('0', 'J'), 'DD MON SYYYY') FROM DUAL;
SELECT TO_CHAR(TO_TIMESTAMP('0', 'J'), 'DD MON SYYYY') FROM DUAL
                            *
ERROR at line 1:
ORA-01854: julian date must be between 1 and 5373484

Elapsed: 00:00:00.00
PHIL@PHILL11G2 > SELECT TO_CHAR(TO_TIMESTAMP('1', 'J'), 'DD MON SYYYY') FROM DUAL;

TO_CHAR(TO_T
------------
01 JAN -4712

Elapsed: 00:00:00.00
PHIL@PHILL11G2 > SELECT TO_CHAR(TO_TIMESTAMP('1721424', 'J'), 'DD MON SYYYY') FROM DUAL;

TO_CHAR(TO_T
------------
01 JAN  0001

Elapsed: 00:00:00.00
PHIL@PHILL11G2 > SELECT TO_CHAR(TO_TIMESTAMP('1721423', 'J'), 'DD MON SYYYY') FROM DUAL;
SELECT TO_CHAR(TO_TIMESTAMP('1721423', 'J'), 'DD MON SYYYY') FROM DUAL
                            *
ERROR at line 1:
ORA-01841: (full) year must be between -4713 and +9999, and not be 0

Elapsed: 00:00:00.04
PHIL@PHILL11G2 > 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-29T08:09:35.297

见[美国海军天文台修改朱利安日期](http://tycho.usno.navy.mil/mjd.html)

# facebook - facebook Graph api 事件的实时更新

> ID：10431807
> 
> 赞同：1
> 
> 时间：2012-05-03T12:53:24.843
> 
> 标签：facebook

我想使用图形 api 订阅事件更新，目前我正在使用以下 url 订阅

**`https://graph.facebook.com/{App_id}/subscriptions?access_token=XXX&object=user&fields=events&verify_token=YYY&callback_url=http://localhost:8080/`**

但它不工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T22:57:56.027

根据[此处](https://developers.facebook.com/docs/reference/api/realtime/)的 Facebook Graph API ，该 API 目前支持...

> ...您可以订阅的以下用户连接列表：供稿、朋友、活动、兴趣、音乐、书籍、电影、电视、喜欢、签到。
> 
> 您还不能订阅这些用户连接：主页、标记、帖子、照片、相册、视频、群组、笔记、事件、收件箱、发件箱、更新、帐户。

事件支持可能会在以后实施。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-12T18:23:20.677

在最近的重大更新之后，现在可以订阅活动了。（7 月）

以下是您可以订阅的用户连接列表：供稿、朋友、活动、兴趣、音乐、书籍、电影、电视、喜欢、签到、位置、**事件**。

# ruby-on-rails - Ruby on Rails - 这个符号是什么意思：<%- ... -%> 在 erb 中？

> ID：10431809
> 
> 赞同：1
> 
> 时间：2012-05-03T12:53:29.150
> 
> 标签：ruby-on-rails, ruby

刚刚生成的设计视图并在生成的`erb.html`：

```
<%- if controller_name != 'sessions' %>
  <%= link_to "Sign in", new_session_path(resource_name) %><br />
<% end -%> 
```

什么是`<%- %> .. <% -%>`，我知道这是猴子的问题，但我不知道要搜索哪个关键字..所以我求助于无敌的 Stackoverflow..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-03T12:55:07.727

吃掉空白，因此呈现的 HTML 看起来更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:56:38.607

您可以将 Ruby 代码放在 <% %> 中

```
<% Ruby code -- inline with output %>
<%= Ruby expression -- replace with result %>
<%# comment -- ignored -- useful in testing %>
% a line of Ruby code -- treated as <% line %> (optional -- see ERB.new)
%% replaced with % if first thing on a line and % processing is used
<%% or %%> -- replace with <% or %> respectively 
```

参考：[http ://ruby-doc.org/stdlib-1.9.3/libdoc/erb/rdoc/ERB.html](http://ruby-doc.org/stdlib-1.9.3/libdoc/erb/rdoc/ERB.html)

# facebook - 如何使用 Windows Phone 7 原生应用制作墙贴

> ID：10431815
> 
> 赞同：0
> 
> 时间：2012-05-03T12:54:07.383
> 
> 标签：facebook, windows-phone-7.1

我在 Windows Phone 7 上创建了本机应用程序。

该应用程序的用户在注册为新用户时将向我们提供他的登录凭据。我想要做的是在我的应用程序中在 facebook 上提供一个共享句柄。

单击句柄时，应将所选图像发布到用户的墙上，并向用户显示图像是否成功发布的消息。

问题是 facebook 没有为 Windows Phone 7 原生应用程序提供开发环境。

我想要一些替代解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-25T06:47:19.907

感谢您的链接。我之前已经访问过该链接。我已经在 wp7 中实现了 facebook 集成。它工作正常，我可以制作墙柱。

这是我的代码，

//用户点击在facebook上分享按钮

私人无效btnFacebookPost_Click（对象发送者，RoutedEventArgs e）{

```
 //Check if access tokens are already set.
        if (App.accessTokens == null)
        {
            GetAccessTokens();
        }
        else
        {
            //Use the access tokens to post on facebook
        }

    } 
```

私人无效GetAccessTokens（）{

```
 // Navigate user to facebooks login page
       // if user has already authenticated your app you'll receive the access tokens directly

        webBrowser.Source = new Uri("https://www.facebook.com/dialog/oauth?client_id='your app id'&redirect_uri=https://www.facebook.com/connect/login_success.html&response_type=token&scope='whatever extended permissions you require'");

    } 
```

//在 Web 浏览器的导航事件中检查访问令牌 //使用 facebook c# sdk 从 url 获取访问令牌

void webBrowser_Navigated（对象发送者，System.Windows.Navigation.NavigationEventArgs e）{

```
 FacebookClient fbClient = new FacebookClient();

            FacebookOAuthResult oauthResult;
            if (fbClient.TryParseOAuthCallbackUrl(e.Uri, out oauthResult))
            {
                // The url is the result of OAuth 2.0 authentication
                if (oauthResult.IsSuccess)
                {

                    App.accessTokens = oauthResult.AccessToken;

                }
                else
                {

                    var errorDescription = oauthResult.ErrorDescription;
                    var errorReason = oauthResult.ErrorReason;
                }
            }
            else
            {
                // The url is NOT the result of OAuth 2.0 authentication.
            }

      } 
```

现在将访问令牌与用于 C#.net 的 facebook sdk 一起使用，以根据需要进行墙贴或任何其他交易。

这种方法的问题是应用程序用户和 facebook 的登录用户可能不同，因此向不同的帐户进行交易。由于 WP7 的 SSO 不可用，这种方法应该可以解决问题。

# c# - 从 NServiceBus 主机发送消息

> ID：10431816
> 
> 赞同：0
> 
> 时间：2012-05-03T12:54:08.307
> 
> 标签：c#, nservicebus, nservicebus3

我们有一个审核消息处理程序，如果在此处理程序中引发任何异常，我们希望它向 LogMessageInputQueue 发送一条日志消息，该消息将由另一个消息处理程序处理。

是否可以从 NServiceBus 主机进程中发送新消息？AuditMessageHandler 在其构造函数中接受处理程序 IBus，但在调用时

```
_bus.Send(new LogFatalMessage(ex)); 
```

没有抛出异常，但消息没有出现在 LogMessageInputQueue 上，似乎只是消失了......

所有的处理程序和队列都在同一台机器上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T13:23:27.653

好的，这一切都是我自己想出来的：）

在 _bus.Send(new LogFatalMessage(ex)) 我们重新抛出原始错误之后，这会导致 NServiceBus 回滚其事务并从 LogMessageInputQueue 中删除消息。

通过将 _bus.Send() 包装在它自己的事务中，我们阻止 NServiceBus 事务的回滚从队列中删除 LogMessage。

```
using (var ts = new TransactionScope(TransactionScopeOption.RequiresNew))
{
    _bus.Send(new LogFatalMessage(ex));
    ts.Complete();
} 
```

# java - 如何在 Netbeans 中使用 Eclipse-Link JPA 应用静态编织 Ant 任务？

> ID：10431819
> 
> 赞同：10
> 
> 时间：2012-05-03T12:54:17.713
> 
> 标签：java, jpa, static, entity, eclipselink

我正在使用 Netbeans 7.1.1 和 Glassfish 3.1.2 服务器。作为 JPA 提供者，我决定使用 Netbeans 附带的 eclipse-link 2.3.0。由于我想使用惰性获取，并且我的项目包含大约 45 个 JPA 实体类，它们之间确实有很多关系，所以我决定使用**静态编织**。此外，@Entity 类位于单独的 Class Lib 项目中，而 persistence.xml 位于 EJB 项目中。

我已经按照这里的说明进行操作：http: [//wiki.eclipse.org/EclipseLink/UserGuide/JPA/Advanced_JPA_Development/Performance/Weaving/Static_Weaving](http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Advanced_JPA_Development/Performance/Weaving/Static_Weaving)

我将 ant-task 放入 build-impl.xml 文件（如下）。使用 Netbeans 时是否正确？这是来自 build-impl.xml 的片段：

```
<target name="-post-jar" description="New task definition for EclipseLink static weaving">
    <taskdef name="weave" classname="org.eclipse.persistence.tools.weaving.jpa.StaticWeaveAntTask"/>
</target>
<target name="weaving" description="perform weaving" depends="-post-jar">
    <weave  source="${dist.jar}\MyProject.jar"
            target="${dist.jar}\MyProject_Weaved.jar"
            persistenceinfo="${dist.jar}..\..\MyProjectEE\MyProject-ejb\build\classes\META-INF\persistence.xml"
            loglevel="FINER">
        <classpath>
            <pathelement path="${dist.jar}\lib\eclipselink-2.3.0.jar"/>
            <pathelement path="${dist.jar}\lib\javaee-api-6.0.jar"/>
            <pathelement path="${dist.jar}\lib\jasypt-1.9.0.jar"/>
            <pathelement path="${dist.jar}\lib\javax.persistence-2.0.jar"/>
            <pathelement path="${dist.jar}\lib\org.eclipse.persistence.jpa.jpql_1.0.0.jar"/>
            <pathelement path="${dist.jar}\lib\joda-time-2.1.jar"/>
            <pathelement path="${dist.jar}\lib\jms.jar"/>
        </classpath>
    </weave>
</target> 
```

pathelement 路径中的所有 jar 文件也作为库包含在 Netbeans IDE 中。当点击“Clean & Build”时，我现在收到以下错误：

```
D:\workspace\MyProject\nbproject\build-impl.xml:703: taskdef class org.eclipse.persistence.tools.weaving.jpa.StaticWeaveAntTask cannot be found
using the classloader AntClassLoader[] 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-11T13:11:15.180

您需要将 eclipselink.jar 和 javax.persistence.jar 添加到 Ant 类路径中。

在 Netbeans 中，转到 Tools / Options / Miscellaneous / Ant，然后在那里编辑类路径。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-11-14T06:31:33.203

我还使用 Netbeans 8.0.1 在 TomEE 1.7.0 中使用 Eclipselink 2.4.2 开发 java ee 项目，我只是将以下内容放入我的**build.xml**中（我从不修改 build-impl.xml，因为 Netbeans 可以在某些情况下覆盖它在配置、构建中修改）：

```
<target name="--weaving-def" description="New task definition for EclipseLink static weaving" depends="dist">
    <taskdef name="weave" classname="org.eclipse.persistence.tools.weaving.jpa.StaticWeaveAntTask"
             classpath="${j2ee.platform.classpath}">
    </taskdef>
</target>
<target name="weaving" description="perform weaving" depends="--weaving-def">
    <weave source="${build.classes.dir}"
           target="${build.classes.dir}"
           loglevel="INFO">
        <classpath path="${j2ee.platform.classpath}:${javac.classpath}"/>  
    </weave>
</target> 
```

可以看到**我只使用了所有 Netbeans Java EE Ant 项目中常用的变量**。我没有直接定义任何 jar 只是项目中已经定义的变量。

在我的实现中，我使用了分解的目录结构，而我的 persistence.xml 位于

```
${build.classes.dir}/META-INF/persistence.xml 
```

**最重要的是正确定义类路径**。

现在如果我跑

```
ant weaving 
```

静态编织将完成。构建需要大约 15 秒，所以我只在测试服务器和生产服务器上构建这种方式，而不是在我的开发环境中。

如果我只是简单地运行（或使用 Netbeans 构建菜单）

```
ant dist 
```

无需编织，建筑物将正​​常。

当然，我的 persistence.xml 中有一个编织定义，如下所示：

```
<persistence-unit name="MY-PU" transaction-type="JTA">
    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <jta-data-source>mydata</jta-data-source>
    <exclude-unlisted-classes>false</exclude-unlisted-classes>
    <properties>
        <property name="eclipselink.logging.logger" value="org.eclipse.persistence.logging.DefaultSessionLog"/>
        <property name="eclipselink.logging.level" value="INFO"/>
        <property name="eclipselink.weaving" value="static"/>
    </properties>
</persistence-unit> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-22T07:26:38.133

我还必须包含**org.eclipse.persistence.jpa.jpql_1.0.1.jar**和**org.eclipse.persistence.jpa.modelgen.processor-2.3.2.jar**才能使编织变得生动。希望这可以帮助。

# c# - Visual Studio自动完成查找文件？

> ID：10431821
> 
> 赞同：0
> 
> 时间：2012-05-03T12:54:19.230
> 
> 标签：c#, visual-studio

在 Visual Studio 中，我们是否有一个工具可以根据文件名在项目中查找文件，例如键入文件开头的几个字母，它会自动完成以显示以该字母开头的所有文件。在 Java Eclipse 中，我们可以使用 Ctrl+Shift+R ，我们在 VS 中有类似的吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:57:55.263

试试 ctrl-spacebar，它是智能感知的正常快捷方式。如果它不适用于文件路径和名称，那么肯定有一个插件可以解决这个问题。

我只使用带有 resharper 的 VS 作为插件，我可以做到这一点，我不知道它的 resharper 是否可以做到这一点，或者它是否是预构建的。

编辑：这样做是更清晰的。如果您打算使用 VS，我建议您使用它，因为它极大地帮助了许多重构和快捷方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T13:01:18.447

是的，有类似的东西。

您可以使用用于正常搜索的**Find**文本框作为**Command Window**的输入。然后在**命令行窗口**中你有`of`搜索文件的命令。

去做吧：

*   `CTRL`+`/`选择查找文本框。
*   然后键入`> of`要搜索的文件名（或部分）。

下拉列表将显示与您的输入匹配的所有文件（因此您不必像`CTRL`+ `SHIFT`+那样知道完整的文件名`R`）。

如果文件列表很长，您可以使用普通的**Find in Files**对话框，只需将**Use**设置为**Wildcards**，在**Find what** type * 中并在**Look at these file types**中写入搜索模式。选中**仅显示文件名**选项。使用**Look in**字段，您可以将搜索限制在当前项目、整个解决方案或任何您需要的范围内。

# version-control - 嵌入差异的历史

> ID：10431826
> 
> 赞同：0
> 
> 时间：2012-05-03T12:54:34.173
> 
> 标签：version-control, powershell, tfs, tf-cli

要查看用户在目录树中完成的每次签入的历史记录，我可以键入：

```
tf history . /recursive /user:name /noprompt /format:detailed 
```

它显示已执行的所有签入“名称”以及签入注释和更改文件的路径。除此之外，我还想显示每个受影响文件的差异。像 /format:extraverbose。有没有办法让 tf 做到这一点？如果没有，您如何创建一个为我执行此操作的 powershell 脚本？

您可以忽略分支和合并之类的东西 - 目录树中没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T19:21:38.887

我认为现在没有命令行，也许您可​​以使用[TFS Powertools CmdLet](http://visualstudiogallery.msdn.microsoft.com/c255a1e4-04ba-4f68-8f4e-cd473d6b971f)创建一个 Powershell 脚本。

否则，您仍然可以使用 TFS API 制作命令行 exe，这比人们想象的要容易。查看[此答案](https://stackoverflow.com/a/10332745/802124)以获取我为某人制作的命令行工具的源文件。

# c++ - 在 C++ 中的 cURL 库请求中设置 Internet Explorer 代理 - Windows

> ID：10431828
> 
> 赞同：2
> 
> 时间：2012-05-03T12:54:39.287
> 
> 标签：c++, windows, curl, libcurl

好吧，我想使用默认的 Internet Explorer 连接代理设置在 C++ 中的 cURL 中发出请求，这是我的示例代码：

```
CURL *curl;
CURLcode result;

curl = curl_easy_init();

char errorBuffer[CURL_ERROR_SIZE];

if (curl)
{
// Now set up all of the curl options
curl_easy_setopt(curl, CURLOPT_ERRORBUFFER, errorBuffer);
curl_easy_setopt(curl, CURLOPT_URL, url);
curl_easy_setopt(curl, CURLOPT_HEADER, 0);
curl_easy_setopt(curl, CURLOPT_FOLLOWLOCATION, 1);
curl_easy_setopt(curl, CURLOPT_COOKIEJAR, "cookies.txt");

// Attempt to retrieve the remote page
result = curl_easy_perform(curl);

// Always cleanup
curl_easy_cleanup(curl);
} 
```

如何检索代理 Internet Explorer 设置，然后传递给我的 cURL，以便它能够使用代理发出请求？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T12:10:58.513

[WinHttpGetIEProxyConfigForCurrentUser 函数检索当前用户的 Internet Explorer 代理配置。](http://msdn.microsoft.com/en-us/library/windows/desktop/aa384096%28v=vs.85%29.aspx)

```
 #include "stdafx.h" 
#include <Windows.h>
#include <Winhttp.h>
#include <iostream>

using namespace std;
void main() 
{ 
    WINHTTP_CURRENT_USER_IE_PROXY_CONFIG MyProxyConfig;

    if(!WinHttpGetIEProxyConfigForCurrentUser(&MyProxyConfig))
    { 
        //check the error DWORD Err = GetLastError(); 
        DWORD Err = GetLastError(); 
        cout << "WinHttpGetIEProxyConfigForCurrentUser failed with the following error number: " << Err << endl;
        switch (Err) 
       {
            case ERROR_FILE_NOT_FOUND: 
            cout << "The error is ERROR_FILE_NOT_FOUND" << endl; 
            break; 
            case ERROR_WINHTTP_INTERNAL_ERROR:
            cout << "ERROR_WINHTTP_INTERNAL_ERROR" << endl; 
            break; 
            case ERROR_NOT_ENOUGH_MEMORY:
            cout << "ERROR_NOT_ENOUGH_MEMORY" << endl; 
            break; 
            default: cout << "Look up error in header file." << endl; 
        }//end switch 
    }//end if 
    else 
    { 
        //no error so check the proxy settings and free any strings 
        cout << "Auto Detect is: " << MyProxyConfig.fAutoDetect << endl; 

        if(NULL != MyProxyConfig.lpszAutoConfigUrl) 
        { 
            wcout << "AutoConfigURL (MyProxyConfig.lpszAutoConfigUrl) is: " << MyProxyConfig.lpszAutoConfigUrl << endl; 
            GlobalFree(MyProxyConfig.lpszAutoConfigUrl);
        } 
        if(NULL != MyProxyConfig.lpszProxy) 
        { 
            wcout << "AutoConfigURL (MyProxyConfig.lpszProxy) is: " << MyProxyConfig.lpszProxy << endl;
            GlobalFree(MyProxyConfig.lpszProxy);
         }
        if(NULL != MyProxyConfig.lpszProxyBypass) 
        {
             wcout << "AutoConfigURL (is: " << MyProxyConfig.lpszProxyBypass << endl;                      
             GlobalFree(MyProxyConfig.lpszProxyBypass); 
        }
    }//end else 
    cout << "finished!"; 
    system("PAUSE");
}//end main 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-30T14:36:45.423

首先，使用 windows api 获取代理服务器，然后使用 curl_easy_setopt 将代理设置为 curl。

获取代理： `WinHttpGetIEProxyConfigForCurrentUser`这个api可以获取代理，但是没有WPAD。如果有人使用“使用自动代理配置”，应该使用`WinHttpGetProxyForUrl`api来获取代理。全部在msdn： http: [//msdn.microsoft.com/en-us/library/windows/desktop/aa384096(v=vs. 85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa384096(v=vs.85).aspx)

设置代理：`curl_easy_setopt(hCurl, CURLOPT_PROXY, astrProxy.c_str());`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T13:06:10.017

您想使用`InternetQueryOption`with `INTERNET_OPTION_PROXY`( [documentation](http://msdn.microsoft.com/en-us/library/ms918374.aspx) ) 来查找当前的代理设置，然后只需[将代理设置正常传递给 curl 即可](https://stackoverflow.com/a/4094447/168175)。

# android - 图形 API 返回错误的 POST_ID 并出现异常 803

> ID：10431830
> 
> 赞同：0
> 
> 时间：2012-05-03T12:54:50.240
> 
> 标签：android, facebook-graph-api, facebook-android-sdk

对 me/home 的 Graph API 查询会返回登录用户新闻源中的所有帖子。在某些情况下，结果会返回多个用户在单个用户时间线上发布的帖子，例如，祝用户生日快乐。

为了更清楚一点：用户**A**和**B在****Z 的**时间线上写了他的生日。

整个应用程序都可以正常工作。但是，在上面的例子中，post_id 是错误的。例如，在上面的示例中，它将“id”返回为**0_10150710912072539**。现在通过大量阅读，以及当用户单击评论或其他内容时应用程序强制关闭的事实，我知道帖子 ID 是错误的。对此有已知的解决方法吗？

对此的任何指导表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T18:51:32.303

据我所知，那些 post_id 为“0_XXXXXXXXXXX”的帖子是您无法互动的虚拟汇总帖子。您可以过滤以这种方式开头的任何帖子，这很容易解决。

作为最佳实践，如果您使用 FQL，您应该`stream.comments.can_post == true`在您的应用尝试发表评论之前查找每个帖子，或者是否存在 `action`where name == 'Comment' 并且使用 API 存在链接。这将防止您的用户尝试在不允许的地方发表评论。

我的信息流中的帖子是来自我订阅的人的汇总事件或项目，但不是所有有`comments.can_post == false`操作和没有操作的朋友。

# c# - DBNull if 语句

> ID：10431835
> 
> 赞同：76
> 
> 时间：2012-05-03T12:55:01.690
> 
> 标签：c#, dbnull

我正在尝试执行一个存储过程，然后使用 if 语句来检查空值，但我做得很短。我是一个 VB 人，所以如果我犯了一个男生语法错误，请多多包涵。

```
objConn = new SqlConnection(strConnection);
objConn.Open();
objCmd = new SqlCommand(strSQL, objConn);
rsData = objCmd.ExecuteReader();
rsData.Read();

if (!(rsData["usr.ursrdaystime"].Equals(System.DBNull.Value)))
        {
            strLevel = rsData["usr.ursrdaystime"].ToString();

        } 
```

这是否允许我检查 SQL 连接是否只返回一个值，如果是，则填充我的字符串？

我习惯于只检查以下内容以查看是否返回了值，但不确定我是否使用 C# 正确执行此操作

If Not IsDBNull(rsData("usr.ursrdaystime"))

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2012-05-03T12:57:48.680

这应该有效。

```
if (rsData["usr.ursrdaystime"] != System.DBNull.Value))
{
    strLevel = rsData["usr.ursrdaystime"].ToString();
} 
```

还需要添加 using 语句，如下所示：

```
using (var objConn = new SqlConnection(strConnection))
     {
        objConn.Open();
        using (var objCmd = new SqlCommand(strSQL, objConn))
        {
           using (var rsData = objCmd.ExecuteReader())
           {
              while (rsData.Read())
              {
                 if (rsData["usr.ursrdaystime"] != System.DBNull.Value)
                 {
                    strLevel = rsData["usr.ursrdaystime"].ToString();
                 }
              }
           }
        }
     } 
```

这将自动处理（关闭）块 { .. } 之外的资源。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-05-03T12:58:01.550

惯用的说法是：

```
if(rsData["usr.ursrdaystime"] != DBNull.Value) {
    strLevel = rsData["usr.ursrdaystime"].ToString();
} 
```

这：

```
rsData = objCmd.ExecuteReader();
rsData.Read(); 
```

让它看起来就像你正在阅读一个值。改为使用`IDbCommand.ExecuteScalar`。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-03T13:03:17.023

与您的 VB 最接近的等价物是（[请参阅此](http://msdn.microsoft.com/en-us/library/system.convert.isdbnull.aspx)）：

```
Convert.IsDBNull() 
```

但是有很多方法可以做到这一点，大多数都[从这里链接](http://msdn.microsoft.com/en-us/library/system.dbnull.value.aspx)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-05-03T12:58:41.847

是的，只是语法问题。试试这个：

```
if (reader["usr.ursrdaystime"] != DBNull.Value) 
```

`.Equals()`正在检查[两个 Object 实例是否相同](http://msdn.microsoft.com/en-us/library/system.object.equals%28v=vs.71%29.aspx)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-03T12:58:48.900

考虑：

```
if(rsData.Read()) {
  int index = rsData.GetOrdinal("columnName"); // I expect, just "ursrdaystime"
  if(rsData.IsDBNull(index)) {
     // is a null
  } else {
     // access the value via any of the rsData.Get*(index) methods
  }
} else {
  // no row returned
} 
```

另外：你需要更多`using`;p

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-03T13:01:30.303

```
if(!rsData.IsDBNull(rsData.GetOrdinal("usr.ursrdaystime")))
{
  strLevel = rsData.GetString("usr.ursrdaystime"); 
} 
```

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.isdbnull.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.isdbnull.aspx)

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.getordinal.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.getordinal.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-11-08T18:22:57.213

我经常使用 String.IsNullorEmpty。这对她有用，因为当 DBNull 设置为 .ToString 时，它返回空。

```
if(!(String.IsNullorEmpty(rsData["usr.ursrdaystime"].toString())){
        strLevel = rsData["usr.ursrdaystime"].toString();
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-10-24T12:48:42.170

三元运算符在这里应该做得很好： **条件？第一个表达式：第二个表达式；**

> strLevel = !Convert.IsDBNull(rsData["usr.ursrdaystime"]) ？Convert.ToString(rsData["usr.ursrdaystime"])：空

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-09-20T17:39:05.380

仍然有这样的替代选择：

```
strLevel = rsData.GetValue(0) is DBNull? "" : rsData.GetString(0); 
```

您需要确切知道哪些列很重要。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2022-03-01T09:44:38.777

只需检查

字符串 val= string.IsNullOrEmpty(rsData["usr.ursrdaystime"]?"":rsData["usr.ursrdaystime"].ToString())

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2012-05-03T13:01:15.227

起初使用 ExecuteScalar

```
 objConn = new SqlConnection(strConnection);
 objConn.Open();
 objCmd = new SqlCommand(strSQL, objConn);
 object result = cmd.ExecuteScalar();
 if(result == null)
     strLevel = "";
 else 
     strLevel = result.ToString(); 
```

# matlab - 如何识别 MATLAB 脚本中的所有未定义函数

> ID：10431839
> 
> 赞同：2
> 
> 时间：2012-05-03T12:55:15.543
> 
> 标签：matlab

我有一个由以前的员工开发的脚本，我需要识别脚本中所有未定义的函数。目前，我正在运行脚本以查找未定义的函数，然后将其注释掉以进入下一个函数。但这是一项非常耗时的工作。有没有更好的办法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T13:14:06.767

是的，我检查了，看起来你想运行依赖关系报告。

# python - TLS v 1.1 MAC 计算

> ID：10431840
> 
> 赞同：2
> 
> 时间：2012-05-03T12:55:21.613
> 
> 标签：python, cryptography, ssl

我正在尝试按照[此处](http://rfc-ref.org/RFC-TEXTS/4346/chapter6.html)第 6.2.3.2 节中给出的详细信息，使用 CBC 计算 TLS v 1.1 Client Finished 数据包的 MAC ！

以下是我编写的函数：

```
def SendSSLPacket(self, hsMsg, seq, renegotiate):
        rec = hsMsg
        recLen = len(rec)
        rec_len_packed = pack('>H', recLen)

                    #
                    # The following initIV is just for testing
                    # Will be replaced by random number later
                    #
        initIV = "\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02"

        rec1 = ""
        for index in range(0, len(rec)):
            rec1 = rec1 + chr(ord(rec[index]) ^ ord(initIV[index]))

        self.seqNum = pack('>Q', seq)

        m = hmac.new(initIV, 
            digestmod=sha1)
        m.update(self.seqNum)
        m.update("\x16")
        m.update("\x03")
        m.update("\x02")
        m.update(rec_len_packed)
        m.update(rec)
        m = m.digest()

        self.HexStrDisplay("Final MAC", Str2HexStr(m))

        currentLength = len(rec + m) + 1
        blockLength = 16
        pad_len = blockLength - \
            (currentLength % blockLength)

        self.log("Padding Length: %s" % (str(pad_len)))

        padding = ''
        for iter in range(0, pad_len + 1):
            padding = padding + \
            struct.pack('B', pad_len)

        self.HexStrDisplay("Padding", Str2HexStr(padding))

        self.sslStruct['recordPlusMAC'] = \
            initIV + rec1 + m + padding
        self.HexStrDisplay("Final Packet", Str2HexStr(
            self.sslStruct['recordPlusMAC']))

        if renegotiate == 1:
            enc_hs_with_reneg = AES.new( self.sslStruct['wKeyPtr'], AES.MODE_CBC, self.sslStruct['wKeyPtr'])
            encryptedData = enc_hs_with_reneg.encrypt(self.sslStruct['recordPlusMAC'])

        if renegotiate == 0:
            enc_hs_wo_reneg = AES.new( self.sslStruct['wKeyPtr'], AES.MODE_CBC, self.sslStruct['wKeyPtr'] )
            encryptedData = enc_hs_wo_reneg.encrypt(self.sslStruct['recordPlusMAC'])

        packLen = len(encryptedData)

        self.sslStruct['encryptedRecordPlusMAC'] = \
            tls11RecHeaderDefault + \
            Pack2Bytes(packLen) + encryptedData
        self.HexStrDisplay("Encrypted Packet",
            Str2HexStr(self.sslStruct['encryptedRecordPlusMAC']))

        self.socket.send(
            self.sslStruct['encryptedRecordPlusMAC']) 
```

服务器虽然抛出以下错误：

```
3079400200:error:1408F119:SSL routines:SSL3_GET_RECORD:decryption failed or bad record mac:s3_pkt.c:496: 
```

如果有人可以帮助我找出问题所在，那就太好了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-04T07:13:44.750

嗯，通过[polarssl](http://www.polarssl.org)代码（看起来简单明了）

以下对我有用：

```
def SendSSLPacket(self, hsMsg, seq, renegotiate):
        rec = hsMsg
        recLen = len(rec)
        rec_len_packed = pack('>H', recLen)

        self.seqNum = pack('>Q', seq)

        #
        # The following initIV is just for testing
        # Will be replaced by random number later
        #
        initIV = "\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x02"

        m = hmac.new(self.sslStruct['wMacPtr'], 
            digestmod=sha1)
        m.update(self.seqNum)
        m.update("\x16")
        m.update("\x03")
        m.update("\x02")
        m.update(rec_len_packed)
        m.update(rec)
        m = m.digest()

        self.HexStrDisplay("Final MAC", Str2HexStr(m))

        currentLength = len(rec + m) + 1
        blockLength = 16
        pad_len = blockLength - \
            (currentLength % blockLength)

        if pad_len == blockLength:
            pad_len = 0

        self.log("Padding Length: %s" % (str(pad_len)))

        padding = ''
        for iter in range(0, pad_len + 1):
            padding = padding + \
            struct.pack('B', pad_len)

        self.HexStrDisplay("Padding", Str2HexStr(padding))

        self.sslStruct['recordPlusMAC'] = \
            initIV + rec + m + padding
        self.HexStrDisplay("Final Packet", Str2HexStr(
            self.sslStruct['recordPlusMAC']))

        if renegotiate == 1:
            enc_hs_with_reneg = AES.new( self.sslStruct['wKeyPtr'], AES.MODE_CBC, self.sslStruct['wIVPtr'])
            encryptedData = enc_hs_with_reneg.encrypt(self.sslStruct['recordPlusMAC'])

        if renegotiate == 0:
            enc_hs_wo_reneg = AES.new( self.sslStruct['wKeyPtr'], AES.MODE_CBC, self.sslStruct['wIVPtr'] )
            encryptedData = enc_hs_wo_reneg.encrypt(self.sslStruct['recordPlusMAC'])

        packLen = len(encryptedData)

        self.sslStruct['encryptedRecordPlusMAC'] = \
            tls11RecHeaderDefault + \
            Pack2Bytes(packLen) + encryptedData
        self.HexStrDisplay("Encrypted Packet",
            Str2HexStr(self.sslStruct['encryptedRecordPlusMAC']))

        self.socket.send(
            self.sslStruct['encryptedRecordPlusMAC']) 
```

# php - 为什么我在 Javascript 中的 onclick 事件处理程序不起作用？

> ID：10431841
> 
> 赞同：0
> 
> 时间：2012-05-03T12:55:26.107
> 
> 标签：php, javascript, window.open

我目前有一个按钮，单击它应该会打开一个新窗口，但我收到此错误：`Uncaught SyntaxError: Unexpected token :`. 我在用`window.open()`

```
$url = "http://www.google.com";
$button .= 
'<input type="button" value="Print Timetable" class="printButton" onclick="window.open('.$url.');"/>'; 
```

我注意到，当我使用不带参数的 window.open() 时，它可以工作，但是当我传入`$url`变量时，一切都变得松散了。我收到语法错误。我试过[http://www.google.com](http://www.google.com)， www.google.com 和 google.com 无济于事！

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T12:58:03.817

因为您缺少封装 url 字符串所需的单引号。

```
$url = "http://www.google.com";
$button .= 
'<input type="button" value="Print Timetable" class="printButton" onclick="window.open(\''.$url.'\');"/>'; 
```

您正在添加一层字符串封装。当您将字符串值传递给函数时，它必须用引号引起来，因为它是一个字符串。

```
doSomething('http://www.ibm.com/'); 
```

当您在 html 中内联执行此操作时，您需要将 javascript 封装在双引号中，使其变为

```
onclick="doSomething('http://www.ibm.com/');"; 
```

然后，如果您希望 PHP 回显它，或者将其分配为变量，您需要将所有这些括在引号中，这样您就可以

```
<?php 
    //encapsulate in double quotes and escape double quotes
    echo " onclick=\"doSomething('http://www.ibm.com/');\" "; 

    //encapsulate in single quotes and escape single quotes
    echo ' onclick="doSomething(\'http://www.ibm.com/\'); '; 
 ?> 
```

任何分解它的方式都需要相互嵌入 3 个字符串封装，因此您必须找到一种方法来区分 JS 中使用的引号和 PHP 中使用的引号。

否则你会有问题。

```
<?php 

    //Houston We have a problem!
    echo " onclick="doSomething('http://www.ibm.com/');\" "; 
         ^         ^                                    ^ ^
 Open Quote       Close Quote                  Open Quote Close Quote 
 ?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T13:00:35.217

这里有几件事是错误的：

您在等号之前有一个句点字符，例如

```
$button .= 
```

应该

```
$button = 
```

你需要转义你的单引号：

```
$url = "http://www.google.com";
$button = '<input type="button" value="Print Timetable" class="printButton" onclick="window.open(''.$url.'');"/>'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T12:59:51.913

我认为它应该是这样的：

```
$url = "http://www.google.com";
$button .= 
'<input type="button" value="Print Timetable" class="printButton" onclick="window.open("'.$url.'");"/>'; 
```

window.open() 需要引号或双引号

# css - 有一个 5 列的行 - 都必须采用相同的高度

> ID：10431844
> 
> 赞同：-1
> 
> 时间：2012-05-03T12:55:48.353
> 
> 标签：css, height, siblings

现在这是一个棘手的问题，担心不使用表格或 JavaScript 来完成此任务。

基本上我有一个**五**列的行，一列采用可以扩展高度的任何类型的内容，但任务是使同级列占用与具有流体内容的列相同的高度。

## 演示：http: [//jsfiddle.net/Mrg5E/](http://jsfiddle.net/Mrg5E/)

正如您在第二行中看到的，它里面有更大的内容占据了高度，但这也打破了兄弟姐妹的高度。

我查看了建议的答案，主要使用表格或 JavaScript - 这是我需要避免的。我还研究了诸如圣杯之类的技巧，但是当我有 5 列（有时是 4 列）时，这主要用于 2-3 列。

CSS中是否有可能修复以匹配所有兄弟姐妹的高度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T13:01:18.197

使用`min-height`属性和跨浏览器解决方案，看看：

[http://css-tricks.com/snippets/css/cross-browser-min-height/](http://css-tricks.com/snippets/css/cross-browser-min-height/)

**[工作示例](http://jsfiddle.net/Mrg5E/4/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T13:07:16.520

如果您不知道具有可变内容高度的一列将是什么，那么不，您不能仅使用 CSS 来做到这一点。您将需要伪造它，或使用 javascript。

如果你有一个固定宽度的布局，你可以试试[仿列](http://www.alistapart.com/articles/fauxcolumns/)技术。那是用垂直平铺的背景图像“伪造”它，给人一种列高度相同的错觉。文中的例子用了两列，但没有理由不能用五列。

另一种方法是使用javascript。如果您使用的是 jquery，[有一个插件](http://www.cssnewbie.com/equalheights-jquery-plugin/)可以帮助您。基本思想是确定最大的列高度，然后将该高度应用于其他列。

# javascript - Node.js - 文件系统获取文件类型，2012 年左右的解决方案

> ID：10431845
> 
> 赞同：27
> 
> 时间：2012-05-03T12:55:50.367
> 
> 标签：javascript, node.js, filesystems, file-type

我需要借助 node.js 获取文件的文件类型来设置内容类型。我知道我可以轻松检查文件扩展名，但我也有没有扩展名的文件，它们应该具有 content type `image/png`，`text/html`aso。

这是我的代码（我知道它没有多大意义，但这是我需要的基础）：

```
var http = require("http"),
    fs = require("fs");
http.createServer(function(req, res) {
    var data = "";
    try {
        /*
         * Do not use this code!
         * It's not async and it has a security issue.
         * The code style is also bad.
         */
        data = fs.readFileSync("/home/path/to/folder" + req.url);
        var type = "???"; // how to get the file type??
        res.writeHead(200, {"Content-Type": type});
    } catch(e) {
        data = "404 Not Found";
        res.writeHead(404, {"Content-Type": "text/plain"});
    }
    res.write(data);
    res.end();
}).listen(7000); 
```

[我还没有在API](http://nodejs.org/api/fs.html)中找到一个函数，所以如果有人能告诉我怎么做，我会很高兴。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-03T13:05:06.947

有一个帮助库用于查找 mime 类型[https://github.com/broofa/node-mime](https://github.com/broofa/node-mime)

```
var mime = require('mime');

mime.getType('/path/to/file.txt');         // => 'text/plain' 
```

但它仍然使用扩展名进行查找

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-05-03T13:06:20.723

看看[mmmagic 模块](https://github.com/mscdex/mmmagic)。它是一个 libmagic 绑定，似乎完全符合您的要求。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-05-03T12:58:53.870

你应该看看命令行工具`file`（Linux）。它尝试根据文件的前几个字节猜测文件类型。您可以使用`child_process.spawn`从节点内运行它。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-05-03T13:02:43.970

你想查找 mime 类型，幸好 node 有一个方便的库来做这件事：

[https://github.com/bentomas/node-mime#readme](https://github.com/bentomas/node-mime#readme)

编辑：

您可能应该查看静态资产服务器，而不是自己设置任何这些东西。您可以使用[express](https://github.com/visionmedia/express#readme)非常轻松地做到这一点，或者有一大堆静态文件模块，例如[ecstatic](https://github.com/jesusabdullah/node-ecstatic)。另一方面，您可能应该使用 nginx 来提供静态文件。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-12-06T11:34:08.620

**2018年解决方案**

接受的答案似乎具有 Python 依赖项，而其他答案要么已过时，要么假定文件名具有某种扩展名。

[请在此处](https://stackoverflow.com/questions/53950321/nodejs-to-get-file-type-of-a-file)找到我的最新答案

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-03-30T08:12:14.317

我用这个：

```
npm install mime-types 
```

并且，在代码内部：

```
var mime = require('mime-types');
tmpImg.contentType = mime.lookup(fileImageTmp); 
```

其中 fileImageTmp 是存储在文件系统上的图像副本（在本例中为 tmp）。

我可以看到的结果是：**image/jpeg**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-04-14T12:36:37.127

我认为最好的方法是使用`file`系统的命令，这样你有三个优点：

1.  没有依赖，
2.  您将通过幻数确保文件具有的内容类型，
3.  您将能够通过魔术文件创建内容类型。

例子：

```
let pathToFile = '/path/to/file';
const child_process = require('child_process');
child_process.exec(`"file" ${path}`, (err, res) => {
  let results = res.replace('\n', '').split(':');
  let stringPath = results[0].trim();
  let typeOfFile = results[1].trim();
  console.log(stringPath, typeOfFile);
}); 
```

文档： [https ://www.man7.org/linux/man-pages/man1/file.1.html](https://www.man7.org/linux/man-pages/man1/file.1.html) [https://nodejs.org/docs/latest-v13.x/api/child_process.html#child_process_child_process_exec_command_options_callback](https://nodejs.org/docs/latest-v13.x/api/child_process.html#child_process_child_process_exec_command_options_callback)

# html - 网页布局问题

> ID：10431846
> 
> 赞同：-1
> 
> 时间：2012-05-03T12:55:56.920
> 
> 标签：html, css, tablelayout

我的网页布局有问题。我有 2 个表，而这 2 个表都在 2 个 div 内。我遇到的问题是，当我的网络浏览器调整大小时，第二个 div 中的内容移动到第一个 div 下方。

谁能告诉我如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T12:57:35.783

解决此问题的一种方法是将表格放在 div 之外。如果表格位于结构 div 内，则调整浏览器大小不会强制一个 div 向下移动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T13:00:54.703

你可以尝试这样的事情：

```
CSS
#leftcolumn { width: 300px; border: 1px solid red; float: left}
#rightcolumn { width: 300px; border: 1px solid red; float: right}

HTML
<div id="leftcolumn"><p>text goes here</p></div>
<div id="rightcolumn"><p>text goes here</p></div> 
```

此外，如果您使用浮动，它会有效地从任何周围的 div 中删除该元素。要解决此问题，请尝试将 'clear' 设置为 'both' 的 div 类添加到您的 html 中。这使得所有的 div 都很好地放在容器中

像这样：

```
CSS
.clear { clear: both;}

HTML
<div id"container">
  <div id="leftcolumn"><p>text goes here</p></div>
  <div id="rightcolumn"><p>text goes here</p></div>
  <div class"clear"></div>
</div> 
```

# android - Admob 停止工作

> ID：10431847
> 
> 赞同：0
> 
> 时间：2012-05-03T12:56:02.267
> 
> 标签：android, admob, ads

我有一个 android 应用程序从 2 月开始工作，没有任何变化，平均每天 10 美元。两周前，它现在显示为红色（在 admob 状态下处于非活动状态）。我的 admob sdk 是 GoogleAdMobAdsSdk-4.3.1.jar （我尝试将其更改为最新版本，结果相同），在 adb logcat 上看起来好像不存在广告库存。

两周前我已经填写了admob表格，到目前为止还没有回复。我该如何联系他们？因为这种事情以前发生过？为什么我到目前为止还没有收到任何收入？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T12:59:53.213

同样的事情发生在我身上。他们不会回答或通知您任何事情。联系他们比联系总统更难。最常见的原因是您以某种方式违反了使用条款，例如激励用户点击广告，或者自己多次点击广告……
仔细查看您的应用，并创建一个新的在 AdMob 中键入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-31T12:20:57.090

也许你的应用程序因违规而被禁用检查你的邮件这发生在我大约三个月后他们禁用它..但我填写了重新启用它的表格..过了一会儿它又恢复工作了

# javascript - JavaScript 中的单元测试

> ID：10431848
> 
> 赞同：2
> 
> 时间：2012-05-03T12:56:05.267
> 
> 标签：javascript, unit-testing, client-side

这是一个菜鸟问题。

我要写一个字符串操作函数，它与网络浏览器无关。现在我想测试该功能。

我知道如何在 Java 中做到这一点`JUnit`：我编写了一些*测试用例*并手动或自动`JUnit`运行*测试用例*（在构建期间）。

如果`Java Script`我可以编写一些测试函数，准备一个调用这些函数的 HTML 页面，然后在浏览器中加载这个页面。

它真的是进行单元测试的唯一选择`Java Script`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T14:51:43.167

您可以尝试使用 jasmine [http://pivotal.github.com/jasmine/](http://pivotal.github.com/jasmine/)它是一个 JavaScript 测试框架，可以在浏览器之外进行测试。不过，您仍然需要在测试环境中使用 javascript 执行堆栈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T23:06:52.853

如果您愿意在网络浏览器中进行测试。我最近写了一个 JS 单元测试类，可以帮助你。您可以单独运行各种测试，也可以使用一个函数执行在数组中定义的多个测试。您可以在 GitHub 上查看使用示例。

[https://github.com/jakesankey/JSTest](https://github.com/jakesankey/JSTest)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T22:06:02.660

不，页面输出不是唯一的选择。还有另一个选项可以将您的结果输出到控制台（大多数浏览器中的 F12 会为您打开它）。在当前版本中输出到控制台的框架之一是[bob.js](http://www.bobjs.com)。

# mongodb - MongoDB中的全文搜索和倒排索引

> ID：10431850
> 
> 赞同：2
> 
> 时间：2012-05-03T12:56:22.330
> 
> 标签：mongodb, full-text-search, b-tree, mongodb-php, inverted-index

我目前正在使用 MongoDB 来看看它有哪些不错的功能。我创建了一个小型测试套件，代表一个简单的博客系统，其中包含帖子、作者和评论，非常基本。

我尝试了一个使用 MongoRegEx 类（PHP 驱动程序）的搜索功能，我只是在“/I”上区分大小写的句子“lorem ipsum”之后搜索所有帖子内容和帖子标题。

我的代码如下所示：

```
$regex = new MongoRegEx('/lorem ipsum/i');  
$query = array('post' => $regex, 'post_title' => $regex); 
```

但我对发生的事情感到困惑和震惊。我检查每个查询的运行时间（在查询之前和之后设置微时间并获得 15 位小数的时间）。

对于我的第一个测试，我添加了 110.000 个博客文档和 5000 个作者，所有内容都是随机生成的。当我进行搜索时，它会找到 6824 个带有“lorem ipsum”句子的帖子，搜索需要 0.000057935714722 秒。这是**在**我重置 MongoDB 服务（使用 Windows）之后，除了 _id 上的默认值之外没有任何索引。

MongoDB 使用 B-tree 索引，这对于全文搜索肯定不是很有效。如果我在我的帖子内容属性上创建一个索引，与上面相同的查询在 0.000150918960571 中运行，这很有趣，这比没有任何索引时要慢（慢，系数为 0.000092983245849）。现在发生这种情况有几个原因，因为它使用了 B 树游标。

但我试图寻找关于它如何如此快速地查询它的解释。我想它可能会将所有内容都保存在我的 RAM 中（我有 4GB，数据库大约 500MB）。这就是为什么我尝试重新启动 mongodb 服务以获得完整结果的原因。

任何有 MongoDB 经验的人都可以帮助我了解这种带或不带索引且绝对没有倒排索引的全文搜索发生了什么吗？

真诚的 - Mestika

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T13:49:31.527

我认为您根本没有迭代结果？仅使用 find()，驱动程序**不会**向服务器发送查询。您需要为此获取至少一个结果。我不相信 MongoDB 这么快，我相信你的错误在你的基准测试中。

其次，对于没有用 锚定在字段值开头的正则表达式搜索，根本*不*`^`使用索引。您应该使用[explain()](http://php.net/manual/en/mongocursor.explain.php)来查看实际发生的情况。

# c# - 序列号锁定程序/进行试用？

> ID：10431860
> 
> 赞同：2
> 
> 时间：2012-05-03T12:56:50.557
> 
> 标签：c#, visual-studio-2010, drm, license-key, serial-number

我正在寻找有关创建系统的指导，该系统将允许我锁定我的程序并将它们置于试用模式。我想要指导的部分是创建/检查密钥的算法，你们对它应该是什么样子有什么建议吗？我正在使用 c#。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T13:11:13.793

您忘记了有一些工具，如[dotPeek](http://www.jetbrains.com/decompiler/)、[JustDecompile](http://www.telerik.com/products/decompiler.aspx)或[.NET Reflector](http://www.reflector.net/)，它们可以轻松地将您的应用程序反汇编为源代码。您的保护很容易被移除。SO上有很多类似的线程，处理混淆，序列号等。这里有两个关于代码混淆的链接。

[https://stackoverflow.com/questions/1988451/net-obfuscation](https://stackoverflow.com/questions/1988451/net-obfuscation)

[.NET 世界中混淆的替代方案](https://stackoverflow.com/questions/7204076/alternative-for-obfuscation-in-the-net-world)

老实说，您将花费大量时间在保护上，最终可能会浪费时间。这是不幸的，但这是现实。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T12:59:53.547

那么最好的方法是实现你自己的真正硬编码的套接字协议，这样黑客就无法解码它，你应该不断地改变它。另外要检查许可证，您应该只联系您的套接字服务器，而套接字服务器可以简单地联系数据库并检查密钥是否有效。

这就是我会做的，它可以很容易地实现

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-01T13:31:35.403

转自：[生成产品激活序列号](https://stackoverflow.com/questions/13843937/generating-a-serial-number-for-product-activation/35035550#35035550)

基本上 - 一旦软件在其他人的计算机上，他们就有能力随心所欲地修改软件，您无法阻止他们，除非采取法律行动，证明反汇编并执行法律处罚。

如果您真的想保护功能，您将保持安全功能在线，并通过 Web 服务调用它。这样他们就被迫付费使用您的 Web 服务。但是，如果您想找到一种生成串行密钥的方法。下面是我写的一篇文章，描述了一种生成“困难”串行密钥的方法，它需要很长时间才能制作，但需要少量时间来验证。使用这种算法，您可以在数据库中预先生成序列密钥，然后将它们分发给客户。唯一的问题是再一次 - 有人可能会反汇编您的应用程序并删除代码的许可部分。我会改为让用户必须拥有有效的序列号才能下载软件并下载所有更新。这将激励成为合法和合法的客户。因此，如何使用这些序列的示例如下：您使用以下代码生成 100 个序列组合。保存它们，然后将它们出售给客户。给他们序列号，产品密钥（数字）。

然后在激活时，他们将其输入您的网站，然后网站将软件发送给他们。

您的网站获取序列号，即他们输入的产品密钥，并将其与软件的密码短语相结合。（下例中的 Alpha）如果 3 个部分联合在一起生成了适当强度/难度的 SHA256 哈希，那么它将认为它是成功注册。此外，您可以检查用户数据库以查看该序列是否与相关客户匹配。如果您想获得真正的安全，您可以创建一个启动器应用程序，为您的产品下载二进制文件，并在成功验证序列密钥后通过 Assembly.Load 加载它们。无论如何-重新发布现在开始。

**转发：**

使用串行密钥，您需要考虑一些事情。

我在狩猎过程中看到了指向使用简单 Guid.NewGuid(); 的链接。方法，然后对字符串进行一些转换以制作自定义样式的序列键。这很容易做到，但产品所有者有责任跟踪数据库中的序列号，最终有人可能会随机找到通过使用 Guid.NewGuid() 工作的序列号；他们自己。如果地球上的每个人都同时开始生成 Guid，那么碰撞的可能性就变得很大。

有一种解决方案可以通过在 Guid.NewGuid() 之上使用更复杂的算法来降低碰撞事件的可能性；

为此，我倾向于使用：

1.  Guid.NewGuid(); （仅前 16 个字符，减去 -（连字符）
2.  一个不断增加或变化的值。（随机数）（一个 int 可以工作：i++ 等）
3.  您将在网络中保持私密和安全的秘密盐。
4.  一个困难因素：从比特币中借用这个原理。

好的，让我们想象一下我正在从 guid 中获取前 16 位数字。然后我将它与 Nonce 和秘密盐结合起来，然后使用 SHA256 从值中派生散列。然后我可以使用难度系数来确定哈希是否以我想要的 0 或其他字符的数量开头。

例如：如果哈希前面有六个 0，那么我将所有数据都保存下来，因为我刚刚找到了一个相当安全的串行密钥。

当我的意思是安全时，我的意思是我找到了一个序列，当它与产品密钥（Nonce）结合使用，然后与秘密 Salt 一起使用时，它会产生一个符合我的生产标准的哈希。

下面是一些示例代码 - 做得非常粗糙，因为我很无聊。

这个想法是您的应用程序可以将产品密钥和序列号发送到激活服务器。服务器知道秘密盐。然后它返回 true 或 false 以确定生成的哈希是否满足安全要求。如果不是：序列号无效，或者对提供的密钥无效。如果它确实有所需的 0：它是一个有效的序列。

```
 Guid theGuid;
    string Hash = "";
    int iAccess = 0;
    string PrivateSalt = "Alpha";
    string SourceString = "";
    string guidString;
    while (true)
    {
        theGuid = Guid.NewGuid();
        guidString = theGuid.ToString().Replace("-", "").Substring(0,16);
        SourceString = guidString + "|" + iAccess.ToString() + "|" + PrivateSalt;
        byte[] data = Encoding.Default.GetBytes(SourceString);
        Hash = Crypto.GenerateSHA256(data);
        if (Hash.StartsWith(GetDiff()))
        {
            break;
        }

        iAccess++;
    }
    Console.WriteLine(SourceString+" Gives hash "+Hash);
    string s1, s2, s3, s4;
    s1 = guidString.Substring(0, 4);
    s2 = guidString.Substring(4, 4);
    s3 = guidString.Substring(8, 4);
    s4 = guidString.Substring(12, 4);
    string serial = s1 + "-" + s2 + "-" + s3 + "-" + s4;

    Console.WriteLine(serial + " :" + SourceString + " Gives hash " + Hash); 
```

GetDiff() 基本上只是一个字符串：“000000”；

此方法的示例输出如下所示：

```
d9c9-f6f0-45be-427a :d9c9f6f045be427a|15135|Alpha Gives hash    000000f718f69c8389d496e01d1e992946fe1b8cf72bc4200a7a2b800b40aa0a
fe49-70b9-08d8-40df :fe4970b908d840df|9096414|Alpha Gives hash  000000e29cfccfb54d1e7edc816feb084f1a2cd11a20c3132a965f9048fc9bf4
7f58-0636-c853-4f0a :7f580636c8534f0a|12297217|Alpha Gives hash 0000007bb44f39a964bbe985885451c3dc0e037fcd12951261404e48819bf89b
6f65-82d3-d95b-4882 :6f6582d3d95b4882|15064854|Alpha Gives hash 000000f1a3bed79e441108cfd26d8733d3fc10f5cd66d234ed35fe2b769663a3
edee-b8b7-9f6f-40ab :edeeb8b79f6f40ab|17782415|Alpha Gives hash 000000b70b96e7b008a96a860efc572fe868154ae81e67b9397249a51f2db71c
0948-4bb3-7de4-4054 :09484bb37de44054|21105690|Alpha Gives hash 000000ec7317eccd5fd9bb701759a2b0e77d37099347d9d665f4b492a69ca3ec
bbf5-5119-bf4e-463c :bbf55119bf4e463c|21715642|Alpha Gives hash 000000a134c886d01606da83cd5e8f672fddb6aa061968e9f08202c781514b16
80f6-c9c5-0ddf-436d :80f6c9c50ddf436d|26450310|Alpha Gives hash 00000092305b2956381c23dacba5b8ff9a37ab994148b37677732dc2a0650386
0a4f-143b-b5f5-48ca :0a4f143bb5f548ca|33691865|Alpha Gives hash 00000054ecdae57c6ec686b6084faf68ae49a78f7c07bbe8e51357d76de63870 
```

您可以通过在前缀中添加更多的 0 来增加难度。这意味着查找串行组合将花费更长的时间，但也使其更加安全。

显然，您会将这些数据组合存储在某个地方，因此在激活期间，您可以比较序列号和产品密钥（Nonce）。

在我的示例中：我正在使用序列密钥（16 位）、递增 int 和单词 Alpha 来表示秘密盐。

这使得生成串行密钥很慢且 CPU 密集，但验证它们的速度非常快。

```
IsSerialValid("edee-b8b7-9f6f-40ab", 17782415);

public bool IsSerialValid(string serialCode, int ProductCode)
        {
            string SourceString = serialCode.Replace("-", "") + "|" + ProductCode.ToString() + "|" + "Alpha";
            byte[] data = Encoding.Default.GetBytes(SourceString);
            string Hash = Crypto.GenerateSHA256(data);
            if (Hash.StartsWith(GetDiff()))
            {
                return true;
            }
            return false;
        } 
```

秘密 Salt 可能是一个代码短语，它映射到您可能正在开发的不同产品。这允许您跨多个产品线重复使用产品密钥 (Nonce) 值。

# wpf - 触发器不想工作。然而，它在风格上效果很好

> ID：10431861
> 
> 赞同：2
> 
> 时间：2012-05-03T12:56:54.933
> 
> 标签：wpf, xaml, triggers

```
<Button Name="btnNewGame" Margin="120,292,450,180" Style="{StaticResource mainLobbyBtnStyle}">
        <Grid Height="35" Width="200">
            ...
            <Line Name="lineNewGame" X1="200" X2="200" Y1="0" Y2="35" ... />
        </Grid>
        <Button.Trigger>
            <Trigger Property="IsMouseOver" Value="true">
                <Setter Property="Content" Value="qwerty"/>
            </Trigger>
        </Button.Triggers>
</Button> 
```

我得到“' *IsMouseOver* ' 成员无效，因为它没有合格的类型名称”。需要帮助来解决这个问题。

第二个问题。我可以在按钮触发器中更改*lineNewGame的参数吗？*如何？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T13:12:52.697

要回答您的第一个问题：

您可以使用`UIElement.IsMouseOver`and`Button.Content`来避免此错误消息。但是接下来你会遇到下一个问题：“触发器集合成员必须是 EventTrigger 类型”。

在`FrameworkElement`您可以使用：

```
EventTrigger 
```

在`Style`,`ControlTemplate`中，`DataTemplate`您可以使用：

```
EventTrigger,
Trigger or MultiTrigger,
DataTrigger or MultiDataTrigger 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T13:39:25.257

@NDQuattro，为什么会很烂？通过在您的代码中再添加 2 行，我得到它为我工作....

```
 <Button Name="btnNewGame" Margin="120,292,450,180">
     <Grid Height="35" Width="200">
         <Line Name="lineNewGame" X1="200" X2="200" Y1="0" Y2="35" ... />
     </Grid>
     <Button.Style>
         <Style TargetType="{x:Type Button}"
                BasedOn="{StaticResource mainLobbyBtnStyle}">
           <Style.Triggers> 
              <Trigger Property="IsMouseOver" Value="true">
                  <Setter Property="Content" Value="qwerty"/>
              </Trigger>
           </Style.Triggers> 
         </Style> 
     </Button.Style>
  </Button> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-03T13:15:53.373

常规触发器和 DataTriggers 都应该在样式中。

您可以像在示例中那样直接使用的唯一一种触发器是 EventTrigger，然后您需要定义一个动画（在情节提要中），该动画将在事件触发时运行。

你可以直接做：

```
<Button>
   <Button.Style>
      <Style Target="Button">
         <Style.Triggers>
            <Trigger Property="IsMouseOver" Value="true">
                <Setter Property="Content" Value="qwerty"/>
            </Trigger>
         </Style.Triggers>
      </Style>
   </Button.Style>
</Button> 
```

# c++ - 弯路捕捉纹理

> ID：10431863
> 
> 赞同：1
> 
> 时间：2012-05-03T12:57:04.483
> 
> 标签：c++, hook, direct3d, detours, apimonitor

有一个赛车游戏，我需要收集遥测和统计数据。并添加一个额外的 HUD

我编译了Detours。并且可以使钩子更改应用程序窗口的名称。例如：

```
LRESULT (WINAPI * TrueSendMessageW)(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam) = SendMessageW;
__declspec(dllexport) LRESULT WINAPI MySendMessageW(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)
{
    if (Msg == WM_SETTEXT)
        return TrueSendMessageW(hWnd, Msg, wParam, (LPARAM)L"new name window");
    return TrueSendMessageW(hWnd, Msg, wParam, lParam);
}
... 
```

并使用 withdll.exe 运行它。一切都好。

但我不知道如何拦截direct3d。在 API Monitor 的帮助下，我发现程序使用`Microsoft.Xna.Framework.Graphics.dll` **`IDirect3DDevice9::SetTexture`**

有人能告诉我如何获得这种纹理吗？一般来说，我想得到类似[链接的东西](http://graphics.stanford.edu/%7Emdfisher/CaptureA/Capture.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-04T18:39:34.403

Detour 拦截 OS API 调用，Direct3D 是通过 COM 对象概念实现的。您可能可以拦截 D3D 设备对象创建的第一步，但在此之后您将不得不处理 COM 对象接口，而 Detour 将无济于事。

# php - 从带有时间戳的表中获取记录/当时间戳差异超过 5 分钟时在行中回显一条消息

> ID：10431867
> 
> 赞同：-2
> 
> 时间：2012-05-03T12:57:18.620
> 
> 标签：php, mysql, sql

我得到一个记录列表，每条记录都是一个问题/答案/时间戳。

我创建了一个基本的 PHP 报告：

```
<?php
$con = mysql_connect("localhost", "login", "pass");
if (!$con) {
    die('Could not connect: ' . mysql_error());
}

mysql_select_db("db", $con);

$result = mysql_query(" SELECT *
                FROM  `experiment` 
                where userid = 73");

while ($row = mysql_fetch_array($result)) {
    echo "question " . $row['question'] . "answer " . $row['answer'] .
         "time " . $row['time'] . "stamp " . $row['createdAt'] . "<br>";
} 
```

我需要一些方法来比较 createdAt 前面的行和 createdAt 之后的行。

如果两行之间的差异大于 2 分钟，则事物应回显“警告”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T13:34:09.947

我会代表你假设几件事情。这可能会改变答案的价值，但您根本没有提供必要的信息来使答案在这一点上可行。

我将假设您正在*遍历*数据记录。您通过声明显示多行来暗示这一点。您的 SQL 查询仅获取一行的数据。我假设您实际上已经获得了整个记录集。因为否则，需要检查数据结构的设计选择。我也在做一个关于如何`userid`在表格中使用的假设，记住，这是我个人的偏见。

随着记录集的收集，它们可以被操纵。您在`mysql_*`这里使用的是古老的方法。我建议您阅读 php 在 5.2.7+ 中可用的 PDO 方法，如果您还没有，请考虑升级您的 php 版本。

操纵可以采取多种形式。

```
$previousRecord = 0;
foreach ($recordSet as $index=>$record){
    $recordSet[$index]['warningTime'] = FALSE;
    if ($previousRecord){
        if (($record['createdAt']-$previousRecord) > 120){
            $recordSet[$index]['warningTime'] = TRUE;
        }
    }
    $previousRecord = $record['createdAt'];
    // Other data manipulation logic for page presentation
} 
```

这应该将警告直接注入数据集中，可以随时显示。为了可维护性，我确实更喜欢功能分离；调用数据库，提取/格式化数据，显示数据。它使将来的更改*变得*更加容易，还允许代码可移植性。您的代码中没有这个，这意味着每当您再次执行此类操作时，您将重新发明轮子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T13:21:59.760

```
$createdAt = null;
while($row = mysql_fetch_array($result)) :
    // initialise on first run
    if ($createdAt === null) :
        $createdAt = $row['createdAt'];
    endif;
    // now $createdAt is the value of the last row... if so, echo warning, else echo nothing
    echo checkCreatedIsOlderThanTwoMinutes($createdAt, $row['createdAt']) === true ? "WARNING!" : "";
    echo "question ". $row['question']. "answer ". $row['answer']. "time ".$row['time']."stamp ". $row['createdAt']."<br>";

endwhile; 
```

我不知道您 createdAt 的格式是什么样的，所以我使用了这个伪函数：

```
function checkCreatedIsOlderThanTwoMinutes($oldCreatedAt, $newCreatedAd)
{
     // check that stuff
} 
```

希望有帮助。

# c# - 从 PictureBox 解锁图像

> ID：10431868
> 
> 赞同：2
> 
> 时间：2012-05-03T12:57:20.910
> 
> 标签：c#, .net, .net-4.0, picturebox

我目前正在开发一个应用程序来帮助在我的工作中扫描和显示图像。

我的应用程序是用多种形式构建的，这里最重要的形式是我`mainForm`显示有关当前扫描的统计信息和具有不同功能的菜单条。我也有`ImageViewerForm`一个`PictureBox`显示在辅助监视器上以查看当前扫描的图像。

我正在使用 a`Timer`来轮询图像扫描到的文件夹。当一个新的图像被扫描并且图像被解锁时，我会把它抓成一个`FileStream`并显示在 中`PictureBox`，见下文：

```
public static void SetPicture(string filename, PictureBox pb)
{
    try
    {
        Image currentImage;

        //currentImage = ImageFast.FromFile(filename);
        using (FileStream fsImage = new FileStream(filename, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
        {
            currentImage = ScaleImage(Image.FromStream(fsImage), new Size(pb.Width, pb.Height));

            if (pb.InvokeRequired)
            {
                pb.Invoke(new MethodInvoker(
                delegate()
                {
                    pb.Image = currentImage;
                }));
            }
            else
            {
                pb.Image = currentImage;
            }
        }
    }
    catch (Exception imageEx)
    {
        throw new ExceptionHandler("Error when showing image", imageEx);
    }
}

public static Image ScaleImage(Image imgToResize, Size size)
{
    int sourceWidth = imgToResize.Width;
    int sourceHeight = imgToResize.Height;

    float nPercent = 0;
    float nPercentW = 0;
    float nPercentH = 0;

    nPercentW = ((float)size.Width / (float)sourceWidth);
    nPercentH = ((float)size.Height / (float)sourceHeight);

    if (nPercentH < nPercentW)
        nPercent = nPercentH;
    else
        nPercent = nPercentW;

    int destWidth = (int)(sourceWidth * nPercent);
    int destHeight = (int)(sourceHeight * nPercent);

    Bitmap b = new Bitmap(destWidth, destHeight);

    using (Graphics g = Graphics.FromImage(b))
    {
        g.InterpolationMode = InterpolationMode.HighQualityBicubic;
        g.DrawImage(imgToResize, 0, 0, destWidth, destHeight);
    }

    return b;
} 
```

这样，`PictureBox`不应锁定中显示的图像，但确实如此。问题是扫描的图像可能必须重新扫描，如果这样做，我会在尝试从扫描软件覆盖图像文件时收到共享冲突错误。

谁有我能做什么的答案？

**解决方案**

感谢@SPFiredrake，我有了一个解决方案来创建一个临时文件以显示在 PictureBox 中，让原始图像保持解锁状态。

```
public static void SetPicture(string filename, PictureBox pb)
{
    try
    {
        Image currentImage;

        //currentImage = ImageFast.FromFile(filename);
        using (FileStream fsImage = new FileStream(CreateTempFile(filename), FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
        {
            currentImage = ScaleImage(Image.FromStream(fsImage), new Size(pb.Width, pb.Height));

            if (pb.InvokeRequired)
            {
                pb.Invoke(new MethodInvoker(
                delegate()
                {
                    pb.Image = currentImage;
                }));
            }
            else
            {
                pb.Image = currentImage;
            }
        }
    }
    catch (Exception imageEx)
    {
        throw new ExceptionHandler("Error when showing image", imageEx);
    }
}

public static string CreateTempFile(string fileName)
{
    if (string.IsNullOrEmpty(fileName))
        throw new ArgumentNullException("fileName");
    if (!File.Exists(fileName))
        throw new ArgumentException("Specified file must exist!", "fileName");
    string tempFile = Path.Combine(Path.GetTempPath(), Guid.NewGuid() + Path.GetExtension(fileName));
    File.Copy(fileName, tempFile);

    Log.New("Temp file created: " + tempFile);

    return tempFile;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-07T13:52:50.060

这里的问题是图像是从 FileStream 加载的，该文件被 PictureBox 锁定，因为它持有对流的引用。您应该首先将图片加载到本地内存（通过 byte[] 数组），然后从 MemoryStream 加载图像。在您的`SetPicture`方法中，您应该尝试以下更改，看看它是否有效：

```
public static void SetPicture(string filename, PictureBox pb)
{
    try
    {
        Image currentImage;
        byte[] imageBytes = File.ReadAllBytes(filename);
        using(MemoryStream msImage = new MemoryStream(imageBytes))
        {
            currentImage = ScaleImage(Image.FromStream(msImage), new Size(pb.Width, pb.Height));
        ....
} 
```

编辑：在我们在 Chat 中进行对话后，使用您最终使用的修复程序进行更新：

```
public static void SetPicture(string filename, PictureBox pb)
{
    try
    {
        Image currentImage;
        string tempFile = Path.Combine(Path.GetTempDirectory(), Guid.NewGuid().ToString() + Path.GetExtension(filename));
        File.Copy(filename, tempFile);
        //currentImage = ImageFast.FromFile(filename);
        using (FileStream fsImage = new FileStream(tempFile, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
        {
            ... 
```

这样您就可以使用临时文件来实际加载图片框，而原始文件保持不变（在初始副本之外）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T14:20:12.120

加载位图后，您将不再保留文件流，因此一切都应该正常工作。但是，如果您正在谈论加载发生的瞬间并且扫描尝试覆盖该文件 - 始终扫描到“临时”或垃圾命名文件（使用 GUID 作为名称）。扫描完成后，将该文件重命名为 JPG - 然后您的显示表单将正确选择并显示该文件。

这样，重新扫描将只涉及尝试使用“等待”多次重命名临时文件，以防止该小区域重叠。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T15:32:47.077

你的代码对我来说很好。我拿了一个精确的副本，并用同一个图像文件反复调用它。

```
SetPicture(@"c:\temp\logo.png", pictureBox1); 
```

其他东西正在锁定文件。你能分享你的电话号码吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T17:08:52.077

我想你现在已经完成了你的工作。
不过，我发帖以防其他人有同样的问题。
我有同样的问题：我在 PictureBox 控件中加载图像

```
picture.Image = new Bitmap(imagePath); 
```

并在尝试移动它时

```
File.Move(source, destination); 
```

mscorlib 抛出异常：
*该进程无法访问该文件，因为它正在被另一个进程使用*

我在这里找到了一个解决方案（虽然在 VB.Net 而不是 C# 中）[PictureBox“锁定”文件，无法移动/删除](http://bytes.com/topic/visual-basic-net/answers/815944-picturebox-locks-file-cannot-move-delete)

帖子的作者克隆了原始图像，并将克隆的图像加载到PictureBox控件中。
我稍微改变了代码并想出了这个：

```
private Bitmap CloneImage(string aImagePath) {  
    // create original image
    Image originalImage = new Bitmap(aImagePath);

    // create an empty clone of the same size of original
    Bitmap clone = new Bitmap(originalImage.Width, originalImage.Height);

    // get the object representing clone's currently empty drawing surface
    Graphics g = Graphics.FromImage(clone);

    g.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.None;
    g.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.NearestNeighbor;
    g.PixelOffsetMode = System.Drawing.Drawing2D.PixelOffsetMode.HighSpeed;

    // copy the original image onto this surface
    g.DrawImage(originalImage, 0, 0, originalImage.Width, originalImage.Height);

    // free graphics and original image
    g.Dispose();
    originalImage.Dispose();

    return clone;
    } 
```

所以，我们的代码将是：

```
picture.Image = (Image)CloneImage(imagePath); 
```

这样做，我在移动文件时没有更多例外。
我认为这是一种很好的替代方法，并且您不需要临时文件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-01T23:41:47.060

这是 Jack 代码，但在 Visual Basic .NET 中，并且转换进入函数内部

```
 Private Function CloneImage(aImagePath As String) As Image
        ' create original image
        Dim originalImage As Image = New Bitmap(aImagePath)

        ' create an empty clone of the same size of original
        Dim clone As Bitmap = New Bitmap(originalImage.Width, originalImage.Height)

        ' get the object representing clone's currently empty drawing surface
        Dim g As Graphics = Graphics.FromImage(clone)

        g.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.None
        g.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.NearestNeighbor
        g.PixelOffsetMode = System.Drawing.Drawing2D.PixelOffsetMode.HighSpeed

        ' copy the original image onto this surface
        g.DrawImage(originalImage, 0, 0, originalImage.Width, originalImage.Height)

        ' free graphics and original image
        g.Dispose()
        originalImage.Dispose()

        Return CType(clone, Image)
    End Function 
```

所以调用将是

```
picture.Image = CloneImage(imagePath) 
```

谢谢杰克，

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-18T15:56:17.237

[MS对这个问题的回应......](https://support.microsoft.com/en-us/kb/309482)

对我来说工作正常...

```
internal void UpdateLastImageDownloaded(string fullfilename)
{
    this.BeginInvoke((MethodInvoker)delegate()
    {
        try
        {
            //pictureBoxImage.Image = Image.FromFile(fullfilename);

            //Bitmap bmp = new Bitmap(fullfilename);
            //pictureBoxImage.Image = bmp;

            System.IO.FileStream fs;
            // Specify a valid picture file path on your computer.
            fs = new System.IO.FileStream(fullfilename, System.IO.FileMode.Open, System.IO.FileAccess.Read);
            pictureBoxImage.Image = System.Drawing.Image.FromStream(fs);
            fs.Close();
        }
        catch (Exception exc)
        {
            Logging.Log.WriteException(exc);
        }
    });
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-05T15:20:22.580

在尝试为我的 C# Windows 窗体找出解决方案时，我遇到了一篇有用的文章，其中提到了如何在图片框中加载图片而不“锁定”原始图片本身，而是它的一个实例。因此，如果您尝试删除、重命名原始文件或对原始文件执行任何操作，您将不会收到一条错误消息通知您“该文件正在被另一个进程使用”或其他任何内容！

这是对文章的[引用](http://csharphelper.com/blog/2014/07/load-images-without-locking-their-files-in-c/)。

总而言之，我相信这个解决方案在处理少量图片时非常有用**，****因为**大量应用这种方法可能会导致内存不足。

# mysql - Mysql - 为什么不考虑 AND 在哪里？

> ID：10431872
> 
> 赞同：0
> 
> 时间：2012-05-03T12:57:38.497
> 
> 标签：mysql

在下面的查询中，即使满足 position 和 category_id 条件，也没有检索到记录。

```
SELECT `jobs`.* FROM `jobs`
WHERE (interview_date >= '2012-05-03 17:54:41 +0530')
  AND (position like '%ROR%'
    AND category_id = '11'
    AND experience_id = '5' 
    AND interview_address like '%%')
ORDER BY interview_date asc 
```

但是对于满足 category_id 和 experience_id 条件的相同查询，我得到了结果。我完全糊涂了。

```
SELECT `jobs`.* FROM `jobs`
WHERE (interview_date >= '2012-05-03 17:55:07 +0530')
  AND (position like '%%'
    AND category_id = '11'
    AND experience_id = '5'
    AND interview_address like '%%')
ORDER BY interview_date asc 
```

我使用了 AND 条件，但是当只满足两个条件时它会返回结果。我在这里错过了什么吗？

谢谢各位。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-03T12:59:40.757

你的另外两个条件：

```
position like '%%' 
```

和

```
interview_address like '%%' 
```

总是真实的。

# android - 如何知道在android中更新了哪个特定联系人？

> ID：10431881
> 
> 赞同：5
> 
> 时间：2012-05-03T12:58:23.577
> 
> 标签：android, contacts, addressbook

我能够收到“联系人数据库发生更改”的通用通知，但我想知道插入、更新或删除的特定记录。

我不想使用查找 URI 概念，因为我不想为每个联系人单独设置查找 URI。我想要一个通用的解决方案，我可以知道何时更新或删除任何联系人。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-03T13:19:26.673

您可以实现一个`Service`来观察数据库状态。

```
import android.app.Service;
import android.content.Intent;
import android.database.ContentObserver;
import android.database.Cursor;
import android.os.Handler;
import android.os.IBinder;
import android.provider.ContactsContract;

public class ContactService extends Service {

private int mContactCount;

@Override
public IBinder onBind(Intent arg0) {
    return null;
}

@Override
public void onCreate() {
    super.onCreate();
    mContactCount = getContactCount();
    this.getContentResolver().registerContentObserver(
            ContactsContract.Contacts.CONTENT_URI, true, mObserver);
}

private int getContactCount() {
    Cursor cursor = null;
    try {
        cursor = getContentResolver().query(
                ContactsContract.Contacts.CONTENT_URI, null, null, null,
                null);
        if (cursor != null) {
            return cursor.getCount();
        } else {
            return 0;
        }
    } catch (Exception ignore) {
    } finally {
        if (cursor != null) {
            cursor.close();
        }
    }
    return 0;
}

private ContentObserver mObserver = new ContentObserver(new Handler()) {

    @Override
    public void onChange(boolean selfChange) {
        super.onChange(selfChange);

        final int currentCount = getContactCount();
        if (currentCount < mContactCount) {
            // DELETE HAPPEN.
        } else if (currentCount == mContactCount) {
            // UPDATE HAPPEN.
        } else {
            // INSERT HAPPEN.
        }
                    mContactCount = currentCount;
    }

};

    @Override
public int onStartCommand(Intent intent, int flags, int startId) {
    return START_STICKY;
}

@Override
public void onDestroy() {
    super.onDestroy();
    getContentResolver().unregisterContentObserver(mObserver);
 }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-09T20:12:35.300

我通过以下方式实现了这个问题：

在安装应用程序期间，我的本地数据库的联系人表正在由给定时间的联系人初始化。然后所有呼叫都由 CallListner 跟踪：如果用户接听/拨打电话，我检查该号码是否在用户的当前电话簿中，如果是，我检索与该号码相关的所有联系信息并更新我的本地数据库。

# android - 当应用程序崩溃并且 logcat 没有显示错误时该怎么办

> ID：10431886
> 
> 赞同：11
> 
> 时间：2012-05-03T12:58:51.397
> 
> 标签：android, logcat

该应用程序在模拟器中运行良好，但在手机上安装后，每次启动时都会崩溃，并且 logcat 没有显示错误。

当这样的事情发生时，我该怎么办？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-03T13:04:39.767

*我的建议是更容易解决您的问题：*

**在电话上以调试**模式从 Eclipse 运行应用程序。它将使其在调试模式下运行。您很可能会获得更多的调试输出。

1.  打开手机中的亚行。
2.  将手机连接到 PC
3.  从 Eclipse 中作为“调试配置”运行。
4.  它应该从您的手机上运行，​​Eclipse 会在运行之前第一次询问您的选择。

* * *

打开*调试模式*（注意：这**不是**我们所指的“ADB 连接”），它将启用应用程序的进一步日志记录，并且不会正常进行垃圾收集。

（如果应用程序被迫在调试模式下工作，您会注意到*“等待调试连接”对话框）。*

例如：它使异步线程继续运行并且不会停止运行。粗鲁且与您的情况无关。但只是作为一个例子。

因此，由于手机中的应用程序**被迫**在调试模式下运行，它会将带有详细错误的 logcat 获取到特定线程。

但是，当它与来自 Eclipse的**“Debug As”运行配置**结合使用时，调试模式会*更好地使用。*请记住，它将*自动*打开该调试应用程序模式（还有对话框），logcat 将向您显示更多详细信息，并且它将在发生的错误处**断点**，按照发生的顺序。

 ****** * *

*关于阿瑞斯所说的，* 当你想直接对一个进程进行调试时，

1.  您可以转到 Eclipse 中的 DDMS 面板，
2.  在右侧选项卡菜单*Devices*上，
3.  选择要调试的进程。并单击绿色符号（说，开始调试过程）
4.  如果您在该 Eclipse 工作空间中有源代码，它将在中断时自动转到源代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-12-04T16:30:10.267

附加提示：

在华为手机上，如果手机处于默认系统设置，logcat 不会显示调试消息和异常。

为了在华为手机上启用 logcat full log，您必须执行以下操作：

*   通过拨号打开出厂设置菜单`*#*#2846579#*#*`
*   导航到项目菜单/后台设置/日志设置

*   在旧手机上：定义日志可用性（日志切换）和级别（日志级别设置）。

*   在从未使用过的手机上：勾选 AP 日志（这似乎通常启用应用程序日志记录）和 CP 日志（似乎启用调试日志记录）
*   使用后退按钮关闭菜单（无需重新启动）

来源：[https ://stackoverflow.com/a/18395092/1075072](https://stackoverflow.com/a/18395092/1075072)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T13:08:00.347

安装一个像[AndroidSystemInfo](https://play.google.com/store/apps/details?id=com.electricsheep.asi)这样的工具，它可以在手机上显示日志文件——即使你远离主机。

Android没有留下任何痕迹是很不寻常的。

您的应用程序是否可能需要手机没有的功能（例如相机、gps 或 nfc）？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-03T13:20:48.453

在 Eclipse 中，您应该转到 DDMS，然后单击`Devices`面板中的设备名称或 android.os。并将您的设备置于调试模式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-25T10:23:56.977

1.  您可以重置 adb（在设备 -> 查看菜单 -> 重置 adb）
2.  点击选中的在线设备/模拟器，显示logcat
3.  断开电缆并重新连接。（或者重启模拟器）
4.  重启 Eclipse

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-03T13:01:56.070

放置您自己的日志来跟踪导致崩溃的代码块，或者只是调试它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-12T05:02:33.977

我重新启动了我的模拟器并清理了我的构建。这消除了我遇到的非日志记录和虚假崩溃*****

# c# - 使用成员变量的堆栈？

> ID：10431895
> 
> 赞同：0
> 
> 时间：2012-05-03T12:59:08.167
> 
> 标签：c#, .net, monodevelop

一般来说，使用堆栈变量或临时成员变量更好（对于性能）？

我有一个“实时”调用的函数，并且需要一些临时变量（各种数据类型）。只使用堆栈变量（即在函数中）还是在类中使用私有成员变量更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T13:02:28.787

我的直觉是堆栈变量会更快，但这是一个真正的微优化。您必须对其进行概要分析才能确定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T13:04:01.723

如果仅在方法内部需要它们，请将它们作为局部方法变量保存在方法中。这主要不是速度问题（尽管“ldloc”可能比“ldarg0，ldfld”组合更省力） - 而是：范围：它减小了对象的**大小**，并且还允许重新进入而不会混淆.

另请注意：并非所有局部方法变量都在堆栈上；p

# c# - 由于堆损坏或加载的 dll，Windows 已触发断点

> ID：10431898
> 
> 赞同：2
> 
> 时间：2012-05-03T12:59:19.443
> 
> 标签：c#, c++

我有一个**C++**文件，其中包含一些我在 C# 中调用的导出函数。其中一个功能是：

```
char segexpc[MAX_SEG_LEN];

extern "C" QUERYSEGMENTATION_API char* fnsegc2Exported()
{
    return segexpc2;
} 
```

在程序的某个地方，我也在做这件事：

```
if(cr1==1)
{
strcpy(segexpc, seg);
} 
```

在我的**C#**程序中，我通过以下方式调用上述内容：

```
[DllImport("QuerySegmentation.dll", EntryPoint = "fnsegcExported", CallingConvention = CallingConvention.Cdecl, CharSet = CharSet.Ansi)]
public static extern StringBuilder fnsegcExported(); 
```

this.stringbuildervar = fnsegcExported();

以前，我没有收到任何错误，但现在我在 Visual Studio 中调试时突然开始收到此错误。

```
Windows has triggered a breakpoint in SampleAppGUI.exe.
This may be due to a corruption of the heap, which indicates a bug in SampleAppGUI.exe or any of the DLLs it has loaded.
This may also be due to the user pressing F12 while SampleAppGUI.exe has focus. 
```

此错误仅在必须显示窗口之前出现在最后。我没有按任何 F12 键，也没有在此处设置任何断点，但我不确定为什么此时会发生错误并中断。 `this.stringbuildervar = fnsegcExported();`
当我按下继续时，会出现带有正确输出的窗口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T14:42:05.263

如果您将外部声明从

```
[DllImport("QuerySegmentation.dll", EntryPoint = "fnsegcExported", CallingConvention = CallingConvention.Cdecl, CharSet = CharSet.Ansi)]
public static extern StringBuilder fnsegcExported(); 
```

到

```
[DllImport("QuerySegmentation.dll", EntryPoint = "fnsegcExported", CallingConvention = CallingConvention.Cdecl, CharSet = CharSet.Ansi)]
public static extern string fnsegcExported(); 
```

然后通过以下方式调用它：

```
this.stringbuildervar = new StringBuilder(fnsegcExported()); 
```

`string`似乎更合适的类型。或者更好的是使用`Marshal`该类将您的非托管 char* 返回编组为托管字符串。

```
[DllImport("QuerySegmentation.dll", EntryPoint = "fnsegcExported", CallingConvention = CallingConvention.Cdecl, CharSet = CharSet.Ansi)]
public static extern IntPtr fnsegcExported();

string managedStr = Marshal.PtrToStringAnsi(fnsegcExported);
this.stringbuildervar = new StringBuilder(managedStr); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T13:16:36.863

您在这一行看到错误的原因是它是您拥有调试信息的最后一个堆栈帧。

幸运的是，就您而言，C++ 端的代码很少。确保它`segexpc`包含一个以零结尾的字符串。

我怀疑因为字符串生成器的默认容量是 16，所以您可能无法以这种方式返回更长的字符串。也许您只想返回字符串。

我还想知道您的 C++ 字符串是否必须是非 Unicode。这将损害每次转换时的性能。

# url - 无法理解 URL 的概念（可能特定于共享点）

> ID：10431910
> 
> 赞同：0
> 
> 时间：2012-05-03T13:00:09.443
> 
> 标签：url, sharepoint-2010, hosts

我遵循了指导我更改 sys32\drivers\etc 中的主机文件以添加 URL 的指南。这个 URL 可能是 127.0.0.1 google.com - 但它会指向什么而不是互联网上的 google.com 搜索引擎？这是共享点开发培训指南的一部分，所以我不确定它是否特定于共享点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T13:05:23.350

不它不是。如果你把它写在你的主机文件中，那么这个 url (google.com) 将指向你自己的机器 (127.0.0.1 = localhost)。

# mysql - 什么时候可以复制数据库数据？

> ID：10431911
> 
> 赞同：1
> 
> 时间：2012-05-03T13:00:10.033
> 
> 标签：mysql, database, database-design

什么时候可以在数据库中存在重复数据？

我正在开发这个应该跟踪用户下载次数的应用程序。从我外行的角度来看，我可以

1.  只需在用户表中有一个列，并在每次用户下载某些内容时递增计数器，或者
2.  有一个计数器表，它有两列，一列用于用户，一列用于下载文件。

正如我所看到的，这两个选项都使我能够跟踪每个用户的下载量。但是，如果这个应用程序看到曙光并且拥有大量用户，那么查询数据库以查看整个计数器表可能会非常昂贵。

我想我的问题是你们都推荐哪个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T13:11:41.340

第二个选项没有数据重复，只是更多的数据。

如果您不想知道下载了哪些文件，我会选择第一个选项（占用空间最少）。如果你是，那就去第二个。

不过，在某些时候，您可能也有兴趣查看随时间推移的下载趋势 :) 您是否考虑过使用 Google Analytics 记录下载？他们在这场比赛中可能比你好得多:)

# mule - 骡子消息的范围是什么？

> ID：10431912
> 
> 赞同：0
> 
> 时间：2012-05-03T13:00:10.587
> 
> 标签：mule

在尝试恢复消息中的原始有效负载时，我遇到了这个问题，这让我对 mule 消息的范围感到困惑。鉴于下面的 mule 配置，我最初假设在`test.Name`vm 端点收到的有效负载将在流程结束时恢复（请参阅配置中的 1\. 和 2.）：

```
<mule  ...>     
    <vm:endpoint name="replacePayloadWithFoo.Name"
            path="replacePayloadWithFoo.Path" />

    <flow name="test">
        <vm:inbound-endpoint name="test.Name" path="test.Path"
            exchange-pattern="request-response" />

        <!-- 1\. Down below, I wanted to restore the payload at this point -->

        <expression-transformer evaluator="string"
            expression="bar" />

        <outbound-endpoint ref="replacePayloadWithFoo.Name"
            exchange-pattern="request-response" />

        <!-- 2\. The transformer below does not restore the payload at 1\. -->            

        <expression-transformer evaluator="groovy"
                expression="message.originalPayload" />
    </flow>

    <flow name="replacePayloadWithFoo">
        <inbound-endpoint ref="replacePayloadWithFoo.Name"
            exchange-pattern="request-response" />

        <expression-transformer evaluator="string"
            expression="foo" />

    </flow>

</mule> 
```

但是，似乎进入`test`流的消息在`replacePayloadWithFoo`出站端点处结束。2\. 处的变压器`"foo"`作为有效载荷离开。

mule 消息的范围是什么？

顺便说一句，[脚本参考文档](http://www.mulesoft.org/documentation/display/MULE3USER/Scripting+Module+Reference)表明`originalPayload`在 groovy 脚本中有一个绑定。但是，如果将 2\. 处的变压器替换为

```
<expression-transformer evaluator="groovy" expression="originalPayload" /> 
```

我得到一个例外：

```
org.mule.api.expression.RequiredValueException: Expression Evaluator "groovy"
with expression "originalPayload" returned null but a value was required. 
```

可能是什么问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T15:46:40.723

除非通过浓缩器执行，否则任何出站交互都会影响当前的飞行消息。这就是对 replacePayloadWithFoo 的调用将原始消息替换为出站交互结果的原因。

这就是说，我无法解释以下之间的差异：

```
<expression-transformer evaluator="groovy" expression="message.originalPayload" /> 
```

和：

```
<expression-transformer evaluator="groovy" expression="originalPayload" /> 
```

因为他们都依赖：

```
event.getMessage().getPayload() 
```

# opencv - 不平滑下采样

> ID：10431919
> 
> 赞同：6
> 
> 时间：2012-05-03T13:00:41.970
> 
> 标签：opencv

是否有内置方法可以在 OpenCV 2.3.1 中对图像进行下采样，而无需事先进行高斯平滑（由 pyrDown C++ 函数执行）。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-03T13:04:40.983

也许您正在寻找[resize()](https://docs.opencv.org/master/da/d54/group__imgproc__transform.html#ga47a974309e9102f5f08231edc7e7529d)。

```
# Python code:
import cv2
large_img = cv2.imread('our_large_image.jpg')
small_to_large_image_size_ratio = 0.2
small_img = cv2.resize(large_img, # original image
                       (0,0), # set fx and fy, not the final size
                       fx=small_to_large_image_size_ratio, 
                       fy=small_to_large_image_size_ratio, 
                       interpolation=cv2.INTER_NEAREST) 
```

`interpolation=cv2.INTER_NEAREST`您可以使用[这些插值方法](https://docs.opencv.org/master/da/d54/group__imgproc__transform.html#ga5bb5a1fea74ea38e1a5445ca803ff121)中的任何一种来代替。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T17:48:47.033

resize() 与插值= INTER_NEAREST。

**编辑**

嗯，如果你自己写函数呢？

```
double factor;
int newcols = round(mat.cols*factor);
int newrows = round(mat.rows*factor);

Mat newmat = Mat(newcol, newrows, mat.type());

for (int i=0;i<mat.cols;i++){
    for (int j=0;j<mat.cols;j++){
        newmat_<yourtype> (round(i*factor), round(j*factor)) = mat_<yourtype>(i, j);
    }
} 
```

我没有检查代码是否有效（很可能不是），但你明白了。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2016-05-21T04:11:26.910

可以使用Image Pyramids：pyrDown，opencv文档的链接是 [http://docs.opencv.org/2.4/doc/tutorials/imgproc/pyramids/pyramids.html](http://docs.opencv.org/2.4/doc/tutorials/imgproc/pyramids/pyramids.html)

# c#-4.0 - 即使字段中的一个是对象，如何动态打印所有对象字段

> ID：10431920
> 
> 赞同：1
> 
> 时间：2012-05-03T13:00:42.657
> 
> 标签：c#-4.0

我想打印对象中的所有字段，如果其中一个字段是对象，我想打印它的字段，然后继续（使用递归）。

我写了函数，但是一旦我进入递归，我就会得到这个错误。

> 在“ConsoleApplication1.StringTest”类型上定义的字段“_str1”不是“System.Reflection.RtFieldInfo”类型的目标对象上的字段。

这是代码：

```
static void OutPutObject(dynamic dyn,Type pType)
        {
            List<string> lFieldsList = new List<string>();

            // Get the type of MyClass.
            Type lType = pType;

            // Get the FieldInfo of MyClass.
            FieldInfo[] myFields = lType.GetFields(BindingFlags.NonPublic | BindingFlags.Instance);
            // Display the values of the fields.
            for (int i = 0; i < myFields.Length; i++)
            {
                if (myFields[i].FieldType.IsClass && myFields[i].FieldType.Name != "String")
                {
                    Type tType = myFields[i].FieldType.GetType();
                    OutPutObject(myFields[i], pType);
                }
                else
                {
                    Console.WriteLine(string.Format("{0}: {1}", myFields[i].Name, myFields[i].GetValue(dyn)));
                }

            }
        }

public class IntTest
{
      private int a = 1;
      private int b = 2;
}

public class StringTest
{
      private string _str1;
      private string _str2;
      private IntTest intl;

      public StringTest()
      {
          _str1 = "str1";
          _str2 = "str2";
      }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-31T09:52:31.217

我已经更改了您的代码，现在它可以工作了！请注意，内部类必须具有默认构造函数。

```
static void OutPutObject(object obj, Type pType, bool isFirst)
        {

            // Get the FieldInfo of MyClass.
            FieldInfo[] myFields = pType.GetFields(BindingFlags.NonPublic | BindingFlags.Instance);
            // Display the values of the fields.
            for (int i = 0; i < myFields.Length; i++)
            {
                if (myFields[i].FieldType.IsPrimitive || myFields[i].FieldType == typeof(Decimal) || myFields[i].FieldType == typeof(String))
                {

                    if (!isFirst)
                    {
                        object temp = Activator.CreateInstance(pType);
                        obj = temp;
                    }
                    Console.WriteLine(string.Format("{0}: {1}", myFields[i].Name, myFields[i].GetValue(obj)));
                }
                else if (myFields[i].FieldType.IsClass)
                {
                    Type tType = myFields[i].FieldType;
                    OutPutObject(myFields[i], tType, false);
                }

            }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T22:15:21.737

您可以使用以下几行来编写对象公共字段。我在 .NET 4.0 上测试过

```
 Type type = obj.GetType();

   foreach (var f in type.GetFields().Where(f => f.IsPublic)) {
       Console.WriteLine("Name: "+f.Name+" Value: "+ f.GetValue(obj) );
   } 
```

# mapping - 如何使用 Doctrine 2 管理 VIEW？

> ID：10431922
> 
> 赞同：5
> 
> 时间：2012-05-03T13:00:50.750
> 
> 标签：mapping, doctrine-orm, sql-view, temp-tables, nativequery

我想用**Doctrine2**映射一个 sql-view 。

此视图是一个**TempTable**，其中包含一些统计信息，无需重写生成视图的 sql 即可显示

我尝试像表一样映射，但更新架构会删除视图并创建表

我也尝试使用 NativeSQL ...

```
public function getMessages(\Project\Bundle\MyBundle\Entity\User $user) {
    $rsm = new \Doctrine\ORM\Query\ResultSetMapping();
    $rsm->addEntityResult('MessageCenter', 'v');
    $rsm->addFieldResult('v', 'user_id', 'user_id');
    $rsm->addFieldResult('v', 'tot', 'tot');
    $rsm->addFieldResult('v', 'read', 'read');
    $rsm->addFieldResult('v', 'to_read', 'to_read');
    $rsm->addFieldResult('v', 'stored', 'stored');
    $rsm->addFieldResult('v', 'spam', 'spam');

    $q = "SELECT * FROM message_stats_view WHERE user_id = ?";
    $rsm = new \Doctrine\ORM\Query\ResultSetMapping;
    $query = $this->getEntityManager()->createNativeQuery($q, $rsm);
    $query->setParameter(1, $user->getId());
    echo $query->getSQL();
    var_dump($query->execute());
    exit;
} 
```

我使用 getter 和 setter 创建实体 MessageCenter，但我的输出是：

```
SELECT * FROM message_stats_view WHERE user_id = ?
array
  empty 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-27T14:40:01.617

（由 OP 在 aq 问题编辑中回答。转录为社区 wiki 答案。请参阅[没有答案的问题，但问题已在评论中解决（或在聊天中扩展）](https://meta.stackoverflow.com/questions/251597/question-with-no-answers-but-issue-solved-in-the-comments)）

OP写道：

> 我解决了！！！！

```
public function getCentroMessaggi(\Project\Bundle\MyBundle\Entity\User $user) {
    $connection = $this->getEntityManager()->getConnection();
    $q = "SELECT * FROM message_stats_view WHERE user_id = :id";
    $stmt = $connection->executeQuery($q, array('id' => $user->getId()));
    return $stmt->fetch();
} 
```

> 这将返回一个数组。完美的！

# asp.net-mvc - 抛出异常或引发域事件？

> ID：10431923
> 
> 赞同：3
> 
> 时间：2012-05-03T13:00:53.560
> 
> 标签：asp.net-mvc, events, notifications, domain-driven-design, entity

考虑以下代码：

```
public class Article : AbstractEntity<Article> {    

    // ...

    public void AppendFeedback(Feedback feedback) {
        var quota = this.FeedbacksQuota ?? this.DefaultFeedbacksQuota;            
        if(this.Feedbacks.Count >= quota) {
            throw new ApplicationException("message");
        }
        this.Feedbacks.Add(feedback);
    }

    // ...
} 
```

所以我不知道当配额超过时我将如何通知用户。抛出异常对我来说似乎很糟糕。它是正确使用的地方`domain events`吗？（示例值得赞赏，尤其是在 的上下文中`ASP.NET MVC application`）。

我应该在哪里收集/处理消息？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T13:18:02.557

如果您的反馈配额是不变的（业务规则），那么例外是可以的。

您始终可以添加一个方法，例如：

```
public bool CanAddFeedback
{
    get { return this.Feedbacks.Count < quota; }
} 
```

在添加之前检查是否允许反馈，以便您可以返回有意义/用户友好的消息。

您*可以*根据添加的反馈引发域事件，其中包含剩余配额等。

# asp.net - 通过单击按钮将网页显示为 pdf

> ID：10431926
> 
> 赞同：0
> 
> 时间：2012-05-03T13:01:07.417
> 
> 标签：asp.net, telerik, pdf-generation, itextsharp, webpage

我有一个新要求，即在我的网页中有一个按钮，点击后，它会将网页显示为 PDF。在研究中，我发现`iTextSharp`用于此目的。但是我的`Telerik`网页中也有很多 ASP 控件。我可以在 PDF 中使用`iTextSharp`吗？

如果是，那么任何人都可以为我提供一个基本链接以开始使用`iTextSharp`，因为我还没有遇到过这个工具。

根据@ahaliav 的回答，我尝试使用以下代码。但是，我没有得到 pdf 上的控件。

```
 protected void btnExport_Click(object sender, EventArgs e)
    {
        Response.ContentType = "application/pdf";
        Response.AddHeader("content-disposition", "attachment;filename=TestPage.pdf");
        Response.Cache.SetCacheability(HttpCacheability.NoCache);

        MemoryStream msOutput = new MemoryStream();
        TextReader reader = new StringReader(HtmlContent);

        // step 1: creation of a document-object
        Document document = new Document(PageSize.A4, 30, 30, 30, 30);
        HTMLWorker worker = new HTMLWorker(document);
        // step 2:
        // we create a writer that listens to the document
        // and directs a XML-stream to a file
        PdfWriter writer = PdfWriter.GetInstance(document, Response.OutputStream);

        // step 3: we create a worker parse the document

        // step 4: we open document and start the worker on the document
        document.Open();
        worker.StartDocument();

        // step 5: parse the html into the document
        worker.Parse(reader);

        // step 6: close the document and the worker
        worker.EndDocument();
        worker.Close();
        document.Close();
        //Response.Write(document);
        //Response.End();

    }
    protected override void Render(HtmlTextWriter writer)
    {
        // setup a TextWriter to capture the markup
        TextWriter tw = new StringWriter();
        HtmlTextWriter htw = new HtmlTextWriter(tw);

        // render the markup into our surrogate TextWriter
        base.Render(htw);

        // get the captured markup as a string
        string pageSource = tw.ToString();

        // render the markup into the output stream verbatim
        writer.Write(pageSource);

        // remove the viewstate field from the captured markup
        HtmlContent = Regex.Replace(pageSource,
            "<input type=\"hidden\" name=\"__VIEWSTATE\" id=\"__VIEWSTATE\" value=\".*?\" />",
            "", RegexOptions.IgnoreCase);

        // the page source, without the viewstate field, is in viewStateRemoved
        // do what you like with it

    } 
```

请帮忙 。我还有其他选择，即当我单击按钮时显示完整网页的图像。谁能指导我解决这两个问题的任何可能方向。

我终于将我的代码更改为：

```
 Response.ContentType = "application/msword";
        Response.AddHeader("content-disposition", "attachment;filename=TestPage.doc");
        Response.Cache.SetCacheability(HttpCacheability.NoCache);
        MemoryStream msOutput = new MemoryStream(); 
```

有了这个，我可以获得包含我所有控件的 msword 文档，但我也收到了一些不需要的文本，如果有人遇到同样的问题，我该如何删除它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T13:04:55.637

一个非常简单的谷歌搜索将我们带到以下论坛主题，其中包含您的“解决方案”： [http ://forums.asp.net/t/1039486.aspx/1](http://forums.asp.net/t/1039486.aspx/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-06T09:14:47.397

经过一些研究，我没有找到任何解决方案来显示 html 中的控件，下面的代码可以正常工作，但没有显示控件，过去我使用过这个[http://www.winnovative-software.com/](http://www.winnovative-software.com/)并且效果很好对于包含所有控件的 html 页面，您也可以单独对其进行测试，“唯一”的问题是您需要为许可证付费

```
protected void btnExportToPdf_Click(object sender, EventArgs e)
    {
        renderPDF = true;
    }

    protected override void Render(HtmlTextWriter writer)
    {           
        if (renderPDF == true)
        {
            MemoryStream mem = new MemoryStream();
            StreamWriter twr = new StreamWriter(mem);
            HtmlTextWriter myWriter = new HtmlTextWriter(twr);
            base.Render(myWriter);
            myWriter.Flush();
            myWriter.Dispose();
            StreamReader strmRdr = new StreamReader(mem);
            strmRdr.BaseStream.Position = 0;
            string pageContent = strmRdr.ReadToEnd();
            strmRdr.Dispose();
            mem.Dispose();
            writer.Write(pageContent);
            CreatePDFDocument(pageContent);
        }
        else
        {
            StringBuilder sb = new StringBuilder();
            HtmlTextWriter tw = new HtmlTextWriter(new System.IO.StringWriter(sb));
            base.Render(tw);
            // get the captured markup as a string
            string pageSource = tw.ToString();
            //Get the rendered content
            string sContent = sb.ToString();
            //Now output it to the page, if you want
            writer.Write(sContent);
        }
    }

    public void CreatePDFDocument(string strHtml)
    {

        string strHTMLpath = Server.MapPath("MyHTML.html");
        StreamWriter strWriter = new StreamWriter(strHTMLpath, false, Encoding.UTF8);
        strWriter.Write(strHtml);
        strWriter.Close();
        string strFileName = HttpContext.Current.Server.MapPath("map1.pdf"); //    strFileName    "C:\\Inetpub\\wwwroot\\Test\\map1.pdf" 
        // step 1: creation of a document-object
        Document document = new Document();
        // step 2:
        // we create a writer that listens to the document
        PdfWriter.GetInstance(document, new FileStream(strFileName, FileMode.Create));
        StringReader se = new StringReader(strHtml);
        TextReader tr = new StreamReader(Server.MapPath("MyHTML.html"));

        //add the collection to the document
        document.Open();                        
        /////////
        iTextSharp.text.html.simpleparser.HTMLWorker worker = new iTextSharp.text.html.simpleparser.HTMLWorker(document);

        worker.StartDocument();

        //// step 5: parse the html into the document
        worker.Parse(tr);

        //// step 6: close the document and the worker
        worker.EndDocument();

        //worker.Parse(tr); // getting error "Illegal characters in path"
        document.Close();
        ShowPdf(strFileName);
    }
    public void ShowPdf(string strFileName)
    {
        Response.ClearContent();
        Response.ClearHeaders();
        Response.AddHeader("Content-Disposition", "inline;filename=" + strFileName);
        Response.ContentType = "application/pdf";
        Response.WriteFile(strFileName);
        Response.Flush();
        Response.Clear();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T13:08:05.517

iTextSharp 附带一个小伙伴：[XML Worker](http://sourceforge.net/projects/itextsharp/files/xmlworker/)

如需演示，请查看[此处](http://demo.itextsupport.com/xmlworker/)

尽管[文档](http://demo.itextsupport.com/xmlworker/itextdoc/index.html)引用了 Java API，但对 C# 的改编应该很简单。

至于 Telerik/ASP 标签，您可以扩展 XMLWorker 并定义如何将这些标签转换为 PDF 元素。

# c# - 将 FileUpload 内容传递到 [WebMethod] 的正确方法？

> ID：10431928
> 
> 赞同：1
> 
> 时间：2012-05-03T13:01:08.210
> 
> 标签：c#, web-services, file-upload, parameter-passing, webmethod

我有一个 [WebMethod] Sendemail 这工作正常，但现在我要升级它以发送附件。我正在使用文件上传。这是我的方法调用。

```
lblEmailSent.Text = Send.Sendemail(txtTo.Text, txtSubject.Text, txtbody.Text, FileUpload1.PostedFile.FileName, FileUpload1.FileContent); 
```

我的呼叫声明以蓝色下划线显示，给出的两个错误如下所示：

> * *1)* * 'WebTestServiceApp.localhost.Service1.Sendemail(string, string, string, string, WebTestServiceApp.localhost.Stream)' 的最佳重载方法匹配有一些无效参数
> 
> * *2)* *参数 5：无法从 'System.IO.Stream' 转换为 'WebTestServiceApp.localhost.Stream'

FileUpload1.PostedFile.FileName 作为字符串传递 FileUpload1.FileContent 作为流传递

这是我的 [WebMethod]，现在你们都可以看到我能看到的一切，我看不出有什么问题，但我不确定 FileUpload1.FileContent 是否应该作为流传递。

```
[WebMethod]
public string Sendemail(String inValueTo, String inValueSub, String inValueBody, String inValueAttachmentPostedfile, Stream inValueAttachemtnFileContent) //, String inValueAttachmentPostedfile, Stream inValueAttachemtnFileContent
{
    try
    {
        String valueTo = inValueTo;
        String valueSub = inValueSub;
        String valueBody = inValueBody;
        String valueAttachmentPostedfile = inValueAttachmentPostedfile; //FileUpload1.PostedFile.FileName
        Stream valueAttachmentFileContent = inValueAttachemtnFileContent;  //FileUpload1.FileContent.fileName

        System.Net.Mail.MailMessage message = new System.Net.Mail.MailMessage(); // Creating new message.

        message.To.Add(valueTo);
        message.Subject = valueSub;
        message.From = new System.Net.Mail.MailAddress("shaunmossop@mweb.co.za");
        message.Body = valueBody;
        message.IsBodyHtml = true;

          string fileName = Path.GetFileName(valueAttachmentPostedfile); // Get attachment file
         Attachment myAttachment =
                         new Attachment(valueAttachmentFileContent, fileName);
          if (fileName != "")
          {
              message.Attachments.Add(myAttachment); // Send attachment
          }

        System.Net.Mail.SmtpClient smtp = new System.Net.Mail.SmtpClient("smtp.gmail.com"); //Properties.Settings.Default.MailSMTPServer

        smtp.Port = 587;
        smtp.EnableSsl = true;
        smtp.UseDefaultCredentials = false;

        NetworkCredential netC = new NetworkCredential(Properties.Settings.Default.username, Properties.Settings.Default.password); // Useing Projects defult settings.
        smtp.Credentials = netC;
        smtp.Send(message);

        return "Message has been sent";
    }
    catch (Exception)
    {
        return "Message faild to send" ;

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-19T14:10:10.260

它给您的第二个错误一针见血，是的，您正在传递字符串字符串字符串字符串，但是您传递了错误类型的流以与之交互，它想要这种 WebTestServiceApp.localhost.Stream 您正在给它这种系统。 IO.Stream

当您使用流时，请尝试在第一次制作时将其显式声明为 WebTestServiceApp.localhost.Stream，这样您就可以传递正确类型的流，您的问题应该会停止！

您会看到两种类型的流，一种用于网络应用程序，一种用于桌面应用程序。

# python - 从多个 GTK 旋转框获取值

> ID：10431931
> 
> 赞同：0
> 
> 时间：2012-05-03T13:01:15.687
> 
> 标签：python, gtk

图片：[http](http://dl.dropbox.com/u/4900888/GUI.png) ://dl.dropbox.com/u/4900888/GUI.png 由于“新用户限制”，源和 UI 在评论中

如果我完全误解了这个网站的内容，我很抱歉，但我有一个问题。

当按下左下角的按钮时，我想从三个旋转框中获取值并将其保存为变量，以便在按钮触发的函数中使用。对于您将如何做到这一点，我真的很空白。任何帮助表示赞赏，如果需要，可以提供其他信息。

编辑：我通过 Glade 使用 Python 和 Gtk+。

PS：Stack Overflow 有没有 pastebin 之类的代码共享站点偏好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T13:54:13.503

简短的回答是：使用旋转按钮的`get_value_as_int()`方法。

但是，我怀疑您的实际问题是引用要调用的旋转按钮`get_value_as_int()`。从[您的代码](http://dl.dropbox.com/u/4900888/Deadliner.py)中，我看到您正在使用它`gtk.Builder`来构建您的 UI。

## 访问小部件

`Handler`在实例中保留对特定小部件的引用：

```
 handler = Handler()
    builder = Gtk.Builder()
    ...
    # Store references to widgets in `handler`
    for widget_name in ('sbtn_days', 'sbtn_hours', 'sbtn_minutes'):
        setattr(handler, widget_name, builder.get_object(widget_name))
    # The above is equivalent to the following:
    handler.sbtn_days = builder.get_object('sbtn_days')
    ...

    # In signal handling code:
    days = self.sbtn_days.get_value_as_int() 
```

或者您可以`builder`在您的`Handler`实例中保留参考：

```
 builder = Gtk.Builder()
    handler = Handler()
    handler.builder = builder
    ...

    # In signal handler code:
    sbtn_days = self.builder.get_object('sbtn_days')
    days = sbtn_days.get_value_as_int() 
```

## 笔记

在上面的代码中，

*   我假设您几天的旋转按钮被命名为`sbtn_days`。根据需要进行调整。
*   我只展示了访问`sbtn_days`及其价值。其他按钮可以以类似的方式访问。

PS您的代码还有许多其他问题使其无法“好”。

# php - php exec() 函数和不同的主机

> ID：10431938
> 
> 赞同：3
> 
> 时间：2012-05-03T13:01:31.457
> 
> 标签：php, exec, command-line-interface

我有一个脚本，它在几个目录中执行一个文件，如下所示：

```
exec("php-cli $file_path > /dev/null 2>/dev/null &"); //php command-line 
```

这适用于大多数主机，但有些主机不喜欢它并且它不会运行，不会产生任何错误。

对于失败的主机，我使用

```
exec("php $file_path > /dev/null 2>/dev/null &"); //notice the -cli is gone 
```

哪个工作正常。

$file_path 是正在执行的文件的完整路径 /home/blah/path/blah.php

我怎样才能使这个统一，以便它适用于所有服务器（至少是 unix）

******编辑* *******

 **好吧，我正在这样做，它（很可能）不是正确的方法，但它确实有效。

我不只是使用 php-cli 或 php，而是同时使用两者，所以如果一个失败，另一个会通过。php 作为 cgi 或 cli 运行，其中之一将捕获，并且由于没有输出，因此也不会出现错误。

```
exec("php-cli $file_path > /dev/null 2>/dev/null &");
exec("php $file_path > /dev/null 2>/dev/null &"); 
```

除非您知道更好的解决方案，否则请告诉我。感谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T14:34:58.967

```
function php_exec($file_path) {
    if (!($binary = which(array('php', 'php5', 'php-cli', 'php-cgi'))))
        return false;

    return exec("$binary $file_path > /dev/null 2>/dev/null &");
}

function which($binaries) {
    if (!($path = getenv('PATH')) && !($path = getenv('Path')))
        return false;

    $arr = preg_split('/[:;]/', $path);

    foreach ($arr as $p) {
        foreach ($binaries as $b) {
            if (file_exists("$p/$b"))
                return "$p/$b";
        }
    }   

    return false;
}

var_dump(php_exec('test.php')); 
```

说明：在大多数系统上，PHP 二进制文件称为 php、php5、php-cli 或 php-cgi。which() 函数检查每个名称的标准路径（*nix 和 windows 都有名为 PATH/Path 的环境变量），如果找到具有该名称的文件，它将返回它。

PATH 变量的格式是：`/bin:/usr/bin:/usr/local/bin:/sbin:/usr/sbin:/usr/local/sbin`对于 *nix (bash)，`C:\Windows\System32\;C:\Windows\;`对于 windows，这就是我使用 preg_split('/[:;]/') 的原因

这个解决方案比你的解决方案更好，因为`false`如果 php_exec() 找不到有效的 php 二进制文件，它将返回。在您的解决方案中，无法知道脚本执行是否失败。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T13:03:55.857

也许是一个简单的问题，但`php-cli`所有主机上都存在吗？我认为它默默失败的原因是因为你告诉它要重定向所有东西。

```
exec("php $file_path > /some/writable/path/output.log 2>/some/writable/path/error.log &"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T13:14:35.473

这取决于 PHP-CLI 二进制文件的编译方式。在大多数系统上，可执行文件仅命名为“php”，我猜有“php-cli”的主机是手动编译的，而其他大多数系统都是通过操作系统包管理器安装的。

您有两种选择可以解决这个问题并使其“通用”：

1.  在每台服务器上，在需要的地方为其中一个添加别名，或者在某处（例如，在您的主目录中）创建指向 PHP 可执行文件的符号链接。
2.  在执行之前，检查其中哪一个存在（通常应该位于 /usr/bin/ 中）并将其设置为变量。**

# c# - Silverlight 不适用于网络的不同 IP 段

> ID：10431940
> 
> 赞同：2
> 
> 时间：2012-05-03T13:01:45.220
> 
> 标签：c#, silverlight, networking, ip

我有一个 Silverlight 应用程序，当它安装在与服务器不同的 IP 段中时无法登录。（客户端在 192.168.77.xx，服务器在 192.168.40.xx）。

当客户端在同一段时，它运行顺利。

客户端可以 ping、telnet 和远程桌面服务器。它还可以从服务器登录其他应用程序，但无法登录我的 Silverlight 应用程序。

有人知道如何使用不同的 IP 段运行 Silverlight 应用程序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T13:35:26.837

为了防止跨站点请求伪造，Silverlight 4（及更高版本）默认情况下只允许对除图像和媒体之外的所有请求进行源站点通信。要使 Silverlight 控件能够访问另一个域中的服务，该服务必须明确选择加入以允许跨域访问。

因此，您应该将Silverlight 应用程序托管在网站的根目录`ClientAccessPolicy.xml`或根目录。`CrossDomain.xml`

这是`ClientAccessPolicy.xml`（允许从任何其他域访问当前域上的所有资源）的示例：

```
<?xml version="1.0" encoding="utf-8"?>
<access-policy>
  <cross-domain-access>
    <policy>
      <allow-from http-request-headers="SOAPAction">
        <domain uri="*"/>
      </allow-from>
      <grant-to>
        <resource path="/" include-subpaths="true"/>
      </grant-to>
    </policy>
  </cross-domain-access>
</access-policy> 
```

这是以下示例`CrossDomain.xml`：

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM "http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
  <allow-http-request-headers-from domain="*" headers="SOAPAction,Content-Type"/>
</cross-domain-policy> 
```

[在此处](http://msdn.microsoft.com/ru-ru/library/cc197955%28v=vs.95%29.aspx)阅读有关跨域边界提供服务的信息。

# jquery - jQuery Validate：向父 div 添加错误或验证类

> ID：10431944
> 
> 赞同：7
> 
> 时间：2012-05-03T13:01:52.183
> 
> 标签：jquery, validation, jquery-validate, twitter-bootstrap

我正在使用 Twitter 的 Bootstrap 作为我正在从事的项目的框架。我正在尝试使用 jQuery Validate 插件验证一个简单的联系表单，但它引起了一些头痛。

我正在寻找向每个表单输入的**父 div添加一个***错误*或*有效*类。这是我的表单代码：

 **```
 <form id="msg-form" class="">
    <fieldset>
        <div class="input-prepend control-group pull-left">
            <span class="add-on">@</span>
            <input class="span3 required email" id="inputEmail" name="msg-email" type="text" placeholder="example@example.com">
        </div>
        <div class="input-prepend control-group pull-left">
            <span class="add-on"><i class="icon-user"></i></span>
            <input class="span3 required" id="inputName" name="msg-name" type="text" placeholder="Joe Bloggs">
        </div>
        <div class="input-prepend control-group">
            <span class="add-on" style="height: 53px;"><i class="icon-pencil"></i></span>
            <textarea class="span3 required" id="textarea" name="msg-comments" rows="2" style="height: 53px" placeholder="Just say hi, or tell us how we can help"></textarea>
        </div>
        <button type="submit" class="btn pull-right">Submit<i class="icon-chevron-right"></i></button>
    </fieldset>
</form> 
```

如您所见，我的*div.control-group*是我想要添加类的 div。我试图使用**突出显示**（如建议的[here](https://stackoverflow.com/questions/9929418/jquery-validate-add-class-to-error-element)，但这根本不起作用）和**errorPlacement**（见下文），但我没有正确地做到这一点。

理想情况下，我希望**在 keyup 上**添加/删除该类，以便它保留插件提供的强大功能。这个简单的代码有效，但它不会删除类并且仅适用于提交表单：

```
$("#msg-form").validate({
    errorPlacement: function(error, element) {
        $(element).parent('div').addClass('error');
    }
}); 
```

谁能建议我应该使用什么选项来实现这一目标？！

在此先感谢 - 我可以在必要时提供任何其他详细信息！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-05-03T13:10:41.297

尝试使用`highlight`and`unhighlight`函数：

```
$("#msg-form").validate({
    highlight: function(element) {
        $(element).parent('div').addClass('error');
    },
    unhighlight: function(element) {
        $(element).parent('div').removeClass('error');
    }
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-07-28T18:41:17.323

[如果使用 jquery 验证发生验证错误，则从](https://stackoverflow.com/a/39737510/1366033)我对将类添加到父 div 的回答中，因为我相信它为这个问题的现有答案增加了价值......

# 访问验证器设置

首要任务是修改`settings`表单验证器上的对象。您可以通过以下任何方式执行此操作：

1.  在通过调用为所有表单加载表单之前[`jQuery.validator.setDefaults()`](https://jqueryvalidation.org/jQuery.validator.setDefaults/)
2.  通过传入选项初始化表单时[`.validate([options])`](https://jqueryvalidation.org/validate/)
3.  通过在表单上定位验证器对象进行初始化后[`$("form").data("validator").settings`](https://stackoverflow.com/a/4764443/1366033)

由于您使用的是 MVC，因此选项 #2 是不可能的，因为[unobtrusive-validation](https://github.com/aspnet/jquery-validation-unobtrusive)将自动初始化表单。所以让我们继续使用选项 3 - 这里的目标只是能够自定义表单上的设置。

# 覆盖默认行为

我们要修改的默认方法是[`highlight`](https://jqueryvalidation.org/validate/#highlight)并且[`unhighlight`](https://jqueryvalidation.org/validate/#unhighlight)将分别*突出显示*无效字段或恢复由突出显示选项所做的更改。[根据源代码，](https://github.com/jquery-validation/jquery-validation/blob/1.16.0/src/core.js#L312)这是它们的默认行为：

```
highlight: function( element, errorClass, validClass ) {
    if ( element.type === "radio" ) {
        this.findByName( element.name ).addClass( errorClass ).removeClass( validClass );
    } else {
        $( element ).addClass( errorClass ).removeClass( validClass );
    }
},
unhighlight: function( element, errorClass, validClass ) {
    if ( element.type === "radio" ) {
        this.findByName( element.name ).removeClass( errorClass ).addClass( validClass );
    } else {
        $( element ).removeClass( errorClass ).addClass( validClass );
    }
} 
```

所以你在这里也有几个选择。

1.  完全替换那些函数，自己写
2.  包装这些函数并像往常一样调用它们，但在之前或之后添加您自己的自定义代码。

### 选项 1 - 替换批发

这条路线很容易。随便在里面写什么就行了。也许来自源代码的种子，也许做你自己的事情。

```
var valSettings = $("form").data("validator").settings
valSettings.highlight = function(element, errorClass, validClass) { ... }
valSettings.unhighlight = function(element, errorClass, validClass) { ... } 
```

### 选项 2 - 包装函数

在大多数情况下，这不太侵入性，因此可能更可取。

由于最终您将替换 的值`valSettings.highlight`，因此您需要访问原始函数的干净原始版本。您可以保存自己的或从全局默认值中获取一个

```
// original highlight function
var highlightOriginal = $("form").data("validator").settings.highlight;
var highlightDefaults = $.validator.defaults.highlight 
```

[在包装 JavaScript 函数方面，这里](https://stackoverflow.com/a/326693/1366033)有几个例子，[这里](https://stackoverflow.com/a/5259530/1366033)和[这里](https://blog.sentry.io/2016/02/03/wrap-javascript-functions.html)）。这是其中之一的解析示例，这将有助于跨函数调用绑定上下文，保留传递的参数的数量，并保留返回值：`this`

```
function wrap(functionToWrap, beforeFunction) {
    return function () {
        var args = Array.prototype.slice.call(arguments),
        beforeFunction.apply(this, args);
        return functionToWrap.apply(this, args);
    };
}; 
```

然后，您还必须快速定义在调用时要触发的任何其他行为。在这种情况下，让我们找到最接近元素的父`div`元素并像这样更新它的类：

```
function highlightDecorator(element, errorClass, validClass) {
    $(element).closest("div").addClass(errorClass).removeClass(validClass);
} 
```

**把它包起来** ^(（看看我在那里做了什么）)

```
$(function () {
  var valSettings = $("form").data("validator").settings
  valSettings.highlight = wrap($.validator.defaults.highlight, highlightDecorator)
  valSettings.unhighlight = wrap($.validator.defaults.unhighlight, unhighlightDecorator)
});

function wrap(functionToWrap, beforeFunction) {
  return function () {
    var args = Array.prototype.slice.call(arguments);
    beforeFunction.apply(this, args);
    return functionToWrap.apply(this, args);
  };
};

function highlightDecorator(element, errorClass, validClass) {
  $(element).closest("div").addClass(errorClass).removeClass(validClass);
}
function unhighlightDecorator(element, errorClass, validClass) {
  $(element).closest("div").addClass(validClass).removeClass(errorClass);
} 
```

因此，当我们结合上述所有功能时，它应该看起来像这样：

## Stack Snippets 和[jsFiddle中的工作演示](https://jsfiddle.net/KyleMit/p2qpn8kg/)

```
$(function () {
  var valSettings = $("form").data("validator").settings
	valSettings.highlight = wrap($.validator.defaults.highlight, highlightDecorator)
  valSettings.unhighlight = wrap($.validator.defaults.unhighlight, unhighlightDecorator)
});

function wrap(functionToWrap, beforeFunction) {
  return function () {
    var args = Array.prototype.slice.call(arguments);
    beforeFunction.apply(this, args);
    return functionToWrap.apply(this, args);
  };
};

function highlightDecorator(element, errorClass, validClass) {
  $(element).closest("div").addClass(errorClass).removeClass(validClass);
}
function unhighlightDecorator(element, errorClass, validClass) {
  $(element).closest("div").addClass(validClass).removeClass(errorClass);
}
```

```
input.input-validation-error  {
  border: solid 1px red;
}
.input-validation-error label {
  color: red;
}
```

```
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.16.0/jquery.validate.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.6/jquery.validate.unobtrusive.min.js"></script>

<form action="/Person" method="post">

  <div class="required">
    <label for="Name">Name <em>*</em></label>           
    <input id="Name" name="Name" type="text" value="" 
           data-val="true" data-val-required="The Name field is required."/>
    <span class="field-validation-valid" 
          data-valmsg-for="Name" data-valmsg-replace="true"></span>
  </div>

  <input type="submit" value="Save" />

</form>
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-20T21:10:46.473

我可能错了，但看起来您需要 .parents('div.control-group') 而不是 .parent()，这会将 .error 添加到错误的 div 中，而不是将 BootStraps 表单颜色更改为红色。

这是因为 JQuery Validate 试图突出显示的输入是 BootStrap 需要 .error 生效的 .control-group 下面的两个。

```
$("#form").validate({
    highlight: function(element, errorClass, validClass){
    $(element).parents("div.control-group").addClass(errorClass).removeClass(validClass);
}, 
```

希望这可以帮助**

# android - 如何获取可以在特定大小的 Screen/TextView 上放置的 N 文本？

> ID：10431945
> 
> 赞同：9
> 
> 时间：2012-05-03T13:01:53.577
> 
> 标签：android, layout, fonts

我有一个字符串格式的大故事。我想在画廊中显示文字。我想要做的是对所有文本进行切片，使我在画廊中的所有视图都显示适合屏幕的文本。

这样我就可以部分地制作我的字符串，每个部分都将显示在屏幕上，每个部分将覆盖整个屏幕。

需要注意的一件事是，用户可以将文本大小更改为大、小，因此屏幕上的文本也会随着大小的变化而变化。

我想知道是否有办法做到这一点。

## 解决方案

非常感谢[userSeven7s](https://stackoverflow.com/users/857361/userseven7s)对我的帮助。根据您的示例，我可以举一个例子。这里是：

```
package com.gsoft.measure.text;

import java.util.Timer;
import java.util.TimerTask;

import android.app.Activity;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.util.Log;
import android.widget.LinearLayout;
import android.widget.TextView;

public class MainScreen extends Activity {

    private final String TAG = "MainScreen";
    private String textToBeShown = "These are the text";
    private String sampleText = "Here are more text";
    private TextView mTextView = null;

    Handler handler = new Handler() {

        public void handleMessage(Message msg) {
            if (msg.what == 1) {
                updateUI();
            }
        };
    };

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        mTextView = (TextView) findViewById(R.id.ui_main_textView);
        mTextView.setTextSize(20f);
        for (int i = 0; i < 100; i++) {
            textToBeShown = textToBeShown + " =" + i + "= " + sampleText;
        }

        // I am using timer as the in UI is not created and
        // we can't get the width.
        TimerTask task = new TimerTask() {

            @Override
            public void run() {
                // So that UI thread can handle UI work
                handler.sendEmptyMessage(1);
            }
        };
        Timer timer = new Timer();
        timer.schedule(task, 1000 * 1);
    }

    @Override
    protected void onResume() {
        super.onResume();

    }

    private void updateUI() {

        // Set text
        mTextView.setText(textToBeShown);
        // Check the width
        Log.e(TAG, "Width = " + mTextView.getWidth());

        // Check height of one line
        Log.e(TAG, "Line height= " + mTextView.getLineHeight());

        // Check total height for TextView
        Log.e(TAG, "Text height= " + mTextView.getHeight());

        // No of line we can show in textview
        int totalLine = mTextView.getHeight() / mTextView.getLineHeight();
        Log.e(TAG, "Total Lines are height= " + totalLine);

        for (int i = 0; i < totalLine; i++) {
            // Get No of characters fit in that textView
            int number = mTextView.getPaint().breakText(textToBeShown, 0, textToBeShown.length(), true,
                    mTextView.getWidth(), null);
            Log.e(TAG, "Number of chracters = " + number);

            // Show the text that fit into line
            Log.e(TAG, textToBeShown.substring(0, number));
            // Update the text to show next
            textToBeShown = textToBeShown.substring(number, textToBeShown.length());
        }
    }
} 
```

这是我的 XML

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/layout_id_for_value"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/black"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/ui_main_textView"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:background="@color/twitter"
        android:textColor="@color/white" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-05T18:27:56.313

You check the `TextView` source code and see how they decide where to ellipsize the string.

The code for `TextView` is [here](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.3.3_r1/android/widget/TextView.java#TextView).

Alternatively, you can use `TextUtils` class's `public static CharSequence ellipsize(CharSequence text, TextPaint p, float avail, TruncateAt where)` method.

`TextPaint p` should be the TextView's paint object.

## Update:

Another alternative is to use `Paint.getTextWidths(char[] text, int index, int count, float[] widths)`.

```
textpaint.getTextWidths(char[] text, int index, int count, float[] widths);

int i = 0;
int prev_i = 0;
while (i < count) {
    textWidth = 0;
    for (int i = prev_i; (i < count) || (textWidth < availableWidth); i++) {
        textWidth += widths[i];
    }
    String textThatFits = mOriginalText.subString(prev_i, i);
    mTextview.setText(textThatFits);
    prev_i = i;
} 
```

`i` is the number of characters that fit in the TextView.
`availableWidth` is the width of the `TextView` in pixels.

This code is approximate and contains syntax errors. You will have to do some minor changes to get it working.

## Update 2:

Another alternative would be to use

```
int breakText (CharSequence text,      
                int start, int end,   
                boolean measureForwards,   
                float maxWidth, float[] measuredWidth). 
```

I think this is the best solution for you. Check its [documentation here.](http://developer.android.com/reference/android/graphics/Paint.html#breakText%28java.lang.CharSequence,%20int,%20int,%20boolean,%20float,%20float%5B%5D%29)

## Update:

Sample code using paint.`breakText` method.

```
paint.setSubpixelText(true);
int prevPos = 0;
while (nextPos  < chars.length) {
    int nextPos = paint.breakText(chars, prevPos, chars.length, maxWidth, null);
    tvStr = str.substring(prevPos, nextPos);
    prevPos = nextPos+1;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-05T17:01:12.337

如果每个部分有不同数量的字符，它们也需要有不同大小的字体。不仅如此，太小的设备也会有太小的字体大小，因为文本需要适应更小的空间。我建议所有部分都使用相同的字体大小，同时如果没有足够的空间允许向下滚动。

为此，您可以在每个页面上使用带有滚动视图的 viewpager，每个页面都包含一个 textview。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-05T17:05:42.067

[Graphics.getFontMetrics](http://docs.oracle.com/javase/6/docs/api/java/awt/Graphics.html#getFontMetrics%28%29)和[FontMetrics.stringWidth](http://docs.oracle.com/javase/6/docs/api/java/awt/FontMetrics.html#stringWidth%28java.lang.String%29)将帮助您确定屏幕上文本的实际大小。根据此计算，您可以确定显示的子字符串应该多长。

# css - CSS 过渡 - 问题

> ID：10431946
> 
> 赞同：2
> 
> 时间：2012-05-03T13:01:53.737
> 
> 标签：css

好的，所以我在 CSS 中让过渡以我希望的方式工作时遇到了一些问题，我希望有一些 CSS 经验的人告诉我如何实现我想要实现的目标。

我得到的实际初始过渡效果很好，但是我在这里遇到了两个问题。

首先，我的导航栏的第二个按钮/链接 - 字符 - 具有三个子链接，当将鼠标悬停在字符按钮上时会显示这些子链接。我想得到它，以便在字符按钮的实际转换发生之前不显示这些子链接。我希望你明白我在说什么。那么，这可能吗？如果可以，怎么做？

其次，目前我所拥有的只是按钮/链接滚动时的过渡，但当它们滚动时却没有。相反，在推出时它会立即回到默认状态，我觉得真的破坏了过渡效果。所以，我想知道是否可以为悬停和悬停设置过渡。

这是我的 HTML 代码：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Home</title>
<link rel="stylesheet" href="complex_1.css"/>
</head>

<body>
  <ul id="navbar">
    <li id="home"><a href="#">Home</a></li>
    <li id="characters"><a href="#">Characters</a>
        <ul>
          <li id="subzero"><a href="#">Sub-Zero</a></li>
          <li id="scorpion"><a href="#">Scorpion</a></li>
          <li id="kano"><a href="#">Kano</a></li>
        </ul>
    </li>
    <li id="about"><a href="#">About</a></li>
    <li id="contact"><a href="#">Contact</a></li>
  </ul>
</body>
</html> 
```

以及有问题的 CSS 代码：

```
ul { /* Sets out the dimensions of the unordered list. */
  font-family:Verdana;
  font-size: 17px; 
  margin: 0px;
  padding: 0px; 
  list-style:none;
  position:absolute;
  letter-spacing:1px;
} 

ul li { /* All list items of unordered lists. */  
  display: block;
  position: relative; 
  text-align:center;
  float: left; /* Makes the navigation bar horizontal instead of vertical. */ 
} 

li ul { 
  display: none; /* Hides the dropdown menu list items by default. */ 
}

ul li a { /* All list items of unordered lists that are links. */ 
  color: #ffffff; 
  background: #000000;
  display:block;
  text-decoration: none;
  border-top: 1px solid #ffffff; 
  padding: 7px 40px 7px 40px; 
  margin-left: 0px; 
  white-space: nowrap; 
} 

ul li a:hover { 
  -moz-transition-property:background-color;
  -moz-transition-duration:400ms;
  -moz-transition-timing-function:ease-in-out; 
  color:#ffffff;
  background: #ff0000;
  } 

li:hover ul { 
  display:block;
  width:182px; 
} 

li:hover li {
  display:block; 
  font-size:10px; 
  float:none;
}

li:hover a { 
  background: #000000;   /* This is where you apply the colour you want for the dropdown list items off the main menu. */
} 

li:hover li a:hover { 
  color: #ffffff;
  background: #ff0000;   /* This is where you apply the colour you want for the hover over the list. */
} 
```

提前感谢任何可以帮助我完成我想做的事情的人，真的非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T04:55:02.993

好的。所以。**回答 1。**

不要将转换属性放在特定的选择器上，而是尝试制作这样的选择器：

```
.trans {
    -webkit-transition:  all 300ms linear;
    -moz-transition:     all 300ms linear;
    -ms-transition:      all 300ms linear;
    transition:          all 300ms linear; 
} 
```

然后你可以在你的 html 锚标签中应用 class="trans" 。

转换只发生在“in”而不是“out”的原因是因为你只将它应用于:hover。您需要将它应用于常规选择器和 :hover 状态。

以上内容简洁明了，但有时您需要不同的过渡时间。

在这种情况下：

```
.my-thing {
    -webkit-transition:  all 300ms linear;
    -moz-transition:     all 300ms linear;
    -ms-transition:      all 300ms linear;
    transition:          all 300ms linear; 
}

.my-thing:hover {
    -webkit-transition:  all 600ms linear;
    -moz-transition:     all 600ms linear;
    -ms-transition:      all 600ms linear;
    transition:          all 600ms linear; 
} 
```

**回答 2。**

您可以延迟过渡。在您的情况下，从 display:none 过渡到 block。

```
.delay {
    transition-delay: 300s;
    -moz-transition-delay: 300s;
    -webkit-transition-delay: 300s;
    -o-transition-delay: 300s;
} 
```

因此，您可以将其应用于 sub ul 或其他内容。

一般来说，我会重新考虑你的选择器。看起来在你的兴奋中，你让事情变得比他们需要的更复杂。

看看[这个 jsFiddle](http://jsfiddle.net/sheriffderek/eCd7P/6/)。

要为下拉菜单设置动画，您可能需要 java 脚本。我似乎无法在 display:none 上进行转换。但是看看小提琴。我认为它回答了您的问题并显示了上述两种解决方案的示例。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T13:22:39.263

试试看这里[webkit 转换示例](http://www.webkit.org/blog/138/css-animation/)。我知道它适用于 webkit，但它可能会有所帮助。

```
div {
    opacity: 1;
    -webkit-transition: opacity 1s linear;
}

div:hover {
    opacity: 0;
} 
```

我们必须为两个状态设置值，常规和：悬停，以便过渡在两个方向上工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-03T13:39:39.473

要回答您问题的第二部分，将转换代码放入`ul li a`而不是`:hover`状态意味着它将适用于所有状态（`:link`, `:hover`, `:focus`, `:active`）。

如果要转换子菜单，请尝试将转换代码放在`ul li ul {}`. 不过，转换`display`属性不会很好，所以你可能也想尝试`opacity`（或其他类似的东西`height`），例如 set `ul li ul {opacity: 0;} ul li:hover ul {opacity: 1;}`。

# ruby-on-rails - Rails 3：AJAX 调用不使用 link_to 刷新 div

> ID：10431947
> 
> 赞同：0
> 
> 时间：2012-05-03T13:01:55.827
> 
> 标签：ruby-on-rails, ruby-on-rails-3, jquery, link-to

我正在使用 Rails 3.0.9 版和 jquery。问题是当你点击链接时，div 没有更新。有两个动作：“显示”和“时间”。初始位置 - 显示。控制器代码是（ajax_controller.rb）：

```
class AjaxController < ApplicationController
  respond_to :html, :js

  def show  
  end

  def time
  end
end 
```

通过点击 div 中的链接应该是加载时间。

下一个代码（show.html.erb）：

```
<h1>Ajax show</h1>
Click this link to show the current 
<%= link_to "time", :url=>{:action => "time"}, :remote => true%>.<br/>
<div id='time_div'>
</div> 
```

此外，还有文件 time.html.erb 和 time.js.erb。按照代码（time.js.erb）：

```
$('#time_div').html('<%= escape_javascript(render :text => "The current time is #{Time.now.to_s}") %>'); 
```

但什么也没有发生。jQuery 连接。可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T13:45:08.207

您可能会遇到路线问题。您的 routes.rb 中有类似的内容吗？

RAILS_ROOT/config/routes.rb

```
get '/time', :to => 'ajax_controller#time', :as => :ajax_time 
```

然后你应该像这样用rails helper调用url

```
<%= link_to "time", ajax_time_path, :remote => true %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T13:24:10.743

您可以查看您的日志以查看 time.js.erb 是否确实呈现。可能会改为呈现 HTML 版本。如果是这种情况，请删除 HTML 版本。

# php - 发送邮件后更新字段

> ID：10431949
> 
> 赞同：0
> 
> 时间：2012-05-03T13:02:09.087
> 
> 标签：php, mysql

我向那些在 30 天后未登录我的网站的人发送了一封提醒邮件。早些时候，我在这个论坛上得到了一个答案，创建了一个单独的字段，然后按照此处所述更新它：[Need help on unix time stamp](https://stackoverflow.com/questions/10384550/need-help-on-unix-time-stamp)。

我创建了一个新字段`lastprelogin`，现在当我为非活动用户发送邮件时如何更新相应的字段。

```
<?php
include("include/data.php");
$query = "SELECT * FROM myusers WHERE DATE_ADD(FROM_UNIXTIME(lastprelogin), INTERVAL 15 DAY) < CURDATE()";
$result = mysql_query($query);
$num = mysql_numrows($result);
$i = 0;
while ($i < $num)
{
    //send mail code
    $sendmail = mail($to,$subject,$msg,$headers);
    $i++;
    if($sendmail) {
        $query1 = "UPDATE myusers SET lastprelogin='".time()."'";
        $result2 = mysql_query($query1);
    }
}
?> 
```

发送邮件后如何更新相应用户的`lastprelogin`字段？

我在这里迷路了，因为我无法理解这部分的逻辑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T13:07:53.197

您需要使用[mysql_fetch_assoc](http://us3.php.net/manual/en/function.mysql-fetch-assoc.php)或类似函数遍历结果。

您的更新查询需要包含您要更新的记录的 ID。

您不应*再*使用这些`mysql_*`功能，因为它们很快就会被弃用。改用[mysqli](http://us3.php.net/manual/en/book.mysqli.php) _

```
<?php
    include("include/data.php");
    $query = "SELECT * FROM myusers WHERE DATE_ADD(FROM_UNIXTIME(lastprelogin), INTERVAL 15 DAY) < CURDATE()";
    $result = mysql_query($query);

    while ($user = mysql_fetch_assoc($result))
    {
        //send mail code
        $sendmail = mail($user['email_address'],$subject,$msg,$headers);
        $i++;
        if($sendmail){
            $query1 = "update myusers set lastprelogin='".time()."' WHERE id = " . $user['id'];
            $result2 = mysql_query($query1);
        }
    }
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T13:16:14.310

您的脚本的逻辑很简单：

*   检索过去 15 天未登录的所有用户
*   向每个用户发送电子邮件
*   如果成功，还更新该用户的字段 lastprelogin

您的脚本中有一些重要错误，应该是这样的：

```
include("include/data.php");
$query = "SELECT * FROM myusers WHERE DATE_ADD(FROM_UNIXTIME(lastprelogin), INTERVAL 15 DAY) < CURDATE()";
$result = mysql_query($query);
while($user = mysql_fetch_assoc($result)) {
    // assuming that myusers table has these columns: user_id, user_name, user_email, lastprelogin
    //send mail code
    if(mail($user['user_email'],'Please log in','Please login to my site',$headers)) {
        $query1 = "update myusers set lastprelogin='".time()."' where user_id = {$user['usri_id']}";
        $result2 = mysql_query($query1);
    }
}
// end. 
```

作为`$headers`变量你可以设置一个`From`标题等。在这里寻找PHP邮件功能：http: [//php.net/mail](http://php.net/mail)

更新的正确查询也应该是这个：

```
"update myusers set lastprelogin='".time()."' where user_id = {$user['user_id']}" 
```

无论如何，您`lastprelogin`每次都会更新所有用户的...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-03T13:08:26.373

您需要`id`从`myuser`表中获取一些并`update`使用`where id = $id`.

# c - popen() 的安全版本？

> ID：10431950
> 
> 赞同：0
> 
> 时间：2012-05-03T13:02:12.120
> 
> 标签：c, process, fork, subprocess, pipe

当命令将用户输入作为其某些参数时，我使用 fork()/exec()/wait() 而不是 system()，因此用户不能输入类似...

```
&rm -rf /home/* && echo HAHA 
```

...作为一个论点。

我假设 popen 和 system() 一样危险，因为它需要一个字符串，而不是像 exec 系列函数那样的字符串列表。

不过，我只能从 exec 函数中获取返回值。是否有一个“安全”版本的 popen 可以使用用户输入运行并在父进程中处理 stdout / stderr ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T13:06:21.033

安全的方法是自己设置必要的管道，直接使用直接`[pipe()](http://linux.die.net/man/2/pipe)`调用。

这就是`popen()`幕后的工作，但它也调用 shell 以运行子进程。跳过这一步应该使它更安全。

# c++ - 光电鼠标作为编码器

> ID：10431952
> 
> 赞同：8
> 
> 时间：2012-05-03T13:02:25.447
> 
> 标签：c++, windows, winapi, mouse

最近我发现了光学鼠标作为增量位置编码器的美妙之处。

光学鼠标通常包含一个组件，其中相机连接到图像处理器，图像处理器连接到 USB 接口。分辨率取决于相机分辨率。在互联网上很容易找到此类组件的数据表，其中还描述了如何使用它们进行读/写。

我首先需要解决的问题是如何确保在不禁用它所连接的 USB 端口的情况下，笔记本电脑/PC 不会将编码器鼠标视为指针设备。我需要使用 2 个编码器，这意味着我的 PC（运行 Windows XP）需要使用 3 个 USB 端口，一个用于鼠标作为指针设备，两个用于鼠标作为编码器。

第二个问题是如何通过 USB 端口从编码器鼠标读取/写入指令/数据？有人可以给我发一个 C++ 教程/示例的链接吗？

首先十分感谢，

斯特凡

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T14:09:13.383

USB 鼠标微控制器可能经过硬编码以发送将自身标识为 HID 设备的 USB 帧。在这种情况下，您几乎没有希望成功阻止 Windows 将其用作鼠标。毕竟这是一只老鼠。

如果您在 DIY，您可以尝试通过拆焊组件/电线来破解鼠标板，并使用您的 arduino 直接控制编码器。这样，Arduino 可以从编码器读取数据并使用自己的 USB 串行端口将其发送到 PC。

看一个例子：

[http://www.martijnthe.nl/2009/07/interfacing-an-optical-mouse-sensor-to-your-arduino/](http://www.martijnthe.nl/2009/07/interfacing-an-optical-mouse-sensor-to-your-arduino/)

有关 HID 设备的更多信息：[http](http://en.wikipedia.org/wiki/USB_human_interface_device_class) ://en.wikipedia.org/wiki/USB_human_interface_device_class 摘录：“与 USB HID 相关的 API 有两个级别：USB 级别和操作系统级别。在 USB 级别，有设备宣布其功能和操作系统解析其获取的数据的协议。然后操作系统为应用程序提供更高级别的视图，这些应用程序不需要包括对单个设备的支持，而是对设备类的支持。这种抽象层允许游戏与任何 USB 控制器一起工作，例如，即使是在游戏之后创建的。”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T16:10:13.353

查看[原始输入](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645536%28v=vs.85%29.aspx)API，看看您是否可以通过这种方式接收事件并阻止 Windows 对其进行操作。

# c# - ICO 中的多个图像

> ID：10431956
> 
> 赞同：0
> 
> 时间：2012-05-03T13:02:34.497
> 
> 标签：c#, winforms, ico

我创建了一个 ICO 文件，其中包含 2 个图像，一个 32*32 和一个 16*16，以便让应用程序选择一个用于进程窗口，一个用于任务栏。然而，它所做的只是对两者都使用图像（其中包含 2 个图像）。我做错什么了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T17:26:57.447

设法做到了。这是完整的指南：

[http://www.photoshopsupport.com/tutorials/jennifer/favicon.html](http://www.photoshopsupport.com/tutorials/jennifer/favicon.html)

# powershell - Powershell 检查本地管理员凭据

> ID：10431964
> 
> 赞同：8
> 
> 时间：2012-05-03T13:02:59.160
> 
> 标签：powershell, powershell-2.0

我正在尝试运行一个需要管理员输入才能处理某些事情的脚本。我没有让脚本运行不成功，而是试图捕获错误并将其扔回凭据中，但是我找不到可以将本地管理员凭据传递给陷阱的命令。有没有人有任何可能有用的东西？

我发现很多会检查域凭据，但这是一个本地管理员帐户。

为了澄清，我正在使用：

`$Cred = Get-Credential`

我需要验证输出是否正确，并且具有管理员访问权限以在脚本中进一步运行内容。

工作解决方案（感谢 User978511）

```
$Cred = Get-Credential 
$Computer = (gwmi Win32_ComputerSystem).Name
$User = $Cred.Username
$Pass = $Cred.GetNetworkCredential().Password
$Users = ("$Computer"+"$User")

Add-Type -assemblyname System.DirectoryServices.AccountManagement 
$DS = New-Object System.DirectoryServices.AccountManagement.PrincipalContext([System.DirectoryServices.AccountManagement.ContextType]::Machine)
$DS.ValidateCredentials($Users, $pass)

if ($Result -ne "True")
{
<Perform Tasks Here>
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T13:12:25.397

```
function Is-Current-User-Admin
{
    return ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-03T13:07:32.877

这将返回您的本地管理员（另一个答案可能更适合这里）：

```
$group =[ADSI]"WinNT://./Administrators" 
$members = @($group.psbase.Invoke("Members")) 
$admins = $members | foreach {$_.GetType().InvokeMember("Name", 'GetProperty', $null, $_, $null)} 
```

这将检查凭据：

```
Add-Type -assemblyname system.DirectoryServices.accountmanagement 
$DS = New-Object System.DirectoryServices.AccountManagement.PrincipalContext([System.DirectoryServices.AccountManagement.ContextType]::Machine)
$DS.ValidateCredentials("test", "password") 
```

您所要做的就是检查凭据是否正常，并且该用户是 Admins 组的成员

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-17T15:52:29.817

```
# Test Local User Account Credentials

Write-Verbose "Prompting for password" 
$pswd = Read-Host "Type password -- VERIFY BEFORE CLICKING RETURN!!!"  -assecurestring
$decodedpswd = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto([System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($pswd))

Foreach ($computer in $computers) { 

$temp = New-Object PSobject 

$username = "variable with local admin user"

Add-Type -AssemblyName System.DirectoryServices.AccountManagement
$obj = New-Object System.DirectoryServices.AccountManagement.PrincipalContext('machine', $computer)

if ($obj.ValidateCredentials($username, $decodedpswd) -eq $True) {

Write-Host "The password of UserName $($username) in Computer $($computer) it is correct" -BackgroundColor Green}

else {

Write-Host "The password of UserName $($username) in Computer $($computer) does not is correct" -BackgroundColor Red}
} 
```

# algorithm - 将板安装到可用长度的算法，最大限度地减少浪费

> ID：10431969
> 
> 赞同：5
> 
> 时间：2012-05-03T13:03:24.213
> 
> 标签：algorithm, mathematical-optimization

我正在编写一个在木材场中使用的应用程序。给定许多板或梁长度，目标是计算所需的板数量，同时最大限度地减少浪费。例如，一个特定维度的购物清单可能如下：

> 3x 2.9 米
> 5x 1.6 米
> 21x 0.9 米

在木材场，人们会检查可用的木板长度并将其输入到应用程序中。假设这个尺寸有 4.8 米的长度。

一个简单的方法是尝试以递减的长度安装剩余的板：

> 2.9 + 2.9 = 5.8 所以不适合 4.8 米的板
> 2.9 + 1.6 = 4.5 所以没关系。

没有长度小于剩余的 0.3 米，所以这个板是“满的”。我们将再安装两个这种类型，然后我们有以下长度可供选择：

> 2x 1.6 米
> 21x 0.9 米

好的，所以这个算法工作得相当好。但是，如果我们不拟合 2.9 + 1.6，而是拟合 2.9 + 0.9 + 0.9 = 4.7 会怎样。然后，我们将每块板产生 0.1 米的废物，而不是 0.3 米。

枚举所有可能组合的一个问题是，每个长度可能在一块板上出现不止一次，并且一块板中适合的长度的数量也会有所不同。有没有一种我可以使用的已知算法来最大程度地减少所有电路板的总浪费？

此外，如果木材场有两个或更多长度可用怎么办？例如 5.4、4.8 和 3.6 米？这肯定会使事情复杂化。可以为每个可用长度运行选定的算法，并选择浪费最少的长度。但最优雅的解决方案是允许混合可用长度，因此最佳答案可能是 1x 5.4、3x 4.8、6x 3.6。但对于初学者来说，我很乐意将答案限制为一个长度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T13:20:06.940

最小化浪费实际上是广义[子集和问题](http://en.wikipedia.org/wiki/Subset_sum_problem)的优化问题，即[**NP-Complete**](http://en.wikipedia.org/wiki/NP-complete)，因此该问题没有已知的多项式时间解，

虽然是 NP-Complete，但可以使用动态规划生成该问题的[伪多项式解决方案，或者将其简化为](http://en.wikipedia.org/wiki/Subset_sum_problem#Pseudo-polynomial_time_dynamic_programming_solution)[背包](http://en.wikipedia.org/wiki/Knapsack_problem)（重量=值=长度，W=板尺寸），并使用其[伪多项式解决方案](http://en.wikipedia.org/wiki/Knapsack_problem#Dynamic_Programming_Algorithm)，这非常相似。

但是，在这里更棘手的是，伪多项式解决方案假定整数，而您的示例表明情况并非如此。您可以通过使用[定点算法](http://en.wikipedia.org/wiki/Fixed-point_arithmetic)来表示长度来解决它（即 4.8 将显示为 48，如果您在每个长度的点后仅使用一位数字，如果您在点后使用 2 位数字，则为 480， ...）。

注意：这个算法会为你最小化浪费，但它不保证最小化浪费的“最小日志数”。

无论如何，由于找到*任何*解决方案都是 NP-Hard，因此找到使用最少对数的解决方案也是 NP-Hard。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-03T19:56:50.620

您的特定问题是所谓的“切割库存”类问题的变体。看看维基百科的“[切割库存问题](http://en.wikipedia.org/wiki/Cutting_stock_problem)”（CSP）页面

我喜欢用简单的英语解释切割库存问题的简单版本。来自[AIMMS](https://www.aimms.com/english/developers/resources/examples/modeling-book-examples/cutting-stock/)：

> “切料问题：如何将长卷材料（称为原料）切割成规定尺寸的较小卷（称为成品），给定每个成品的需求。”

AIMMS 的这个[pdf很好。](https://download.aimms.com/aimms/download/manuals/AIMMS3OM_CuttingStock.pdf)

请注意，研究人员提出的基本切割库存问题有很多变体。这些整数编程讲座记录了[广义切削库存问题](http://www.more.ms.unimelb.edu.au/students/integerprogramming/462_sem1_08_notesHSG.pdf)的良好表述（参见第 17 页）

这些 MILP 问题并不难表述，因为目标函数和约束遵循标准 CSP 的基本模式。关于有效解决这些问题的技术存在大量研究。

如果您可以使用 LP/IP 求解器，例如 CPLEX、R 或 Excel 求解器（针对较小的问题），那么绝对值得制定您的问题并在这些求解器上进行尝试。

希望有帮助。

# ruby-on-rails - 如何将此机架中间件与 Rails 3.x 应用程序一起使用？

> ID：10431970
> 
> 赞同：1
> 
> 时间：2012-05-03T13:03:24.683
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rack, middleware

回复后找到了这个 gem [Rack](https://github.com/oggy/rack_after_reply)，上面写着：

Rack 应用程序的钩子，在发送响应后触发，客户端的套接字已关闭。这是执行可延迟、非后台任务（例如垃圾收集、统计信息收集、刷新日志等）而不影响响应时间的理想时间。

### 用法

只需将您的回调添加到`env['rack_after_reply.callbacks']`.

```
use Rack::ContentLength
use Rack::ContentType, 'text/plain'
run lambda { |env|
  env['rack_after_reply.callbacks'] << lambda { ... }
  [200, {}, ['hi']]
} 
```

但我无法将它放入 Rails3 应用程序中。

谁能说出如何将它与 Rails3 应用程序一起使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-05T22:59:30.213

您需要在实际请求期间将回调添加到 Rack 环境，即在您的控制器中。

`request`您可以使用该对象访问 Rack 环境。

在您的控制器中：

```
def index #or whatever your method is, you could do this in filter
  #normal controller code...

  request.env['rack_after_reply.callbacks'] << lambda do
    $stderr.puts "Hello from callback"
  end
end 
```

回调将在路由到此方法的任何请求之后运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-03T14:27:50.627

只需`config.middleware.use(new_middleware, args)`在 application.rb 或特定 environment.rb 文件中添加这一行。

[http://guides.rubyonrails.org/rails_on_rack.html#configuring-middleware-stack](http://guides.rubyonrails.org/rails_on_rack.html#configuring-middleware-stack)

# javascript - 仅在完全创建时显示工具提示

> ID：10431971
> 
> 赞同：0
> 
> 时间：2012-05-03T13:03:25.763
> 
> 标签：javascript, jquery

我为我的网站创建了很好的工具提示，但是当我用鼠标快速移动时，以及在数据被缓存之前，我遇到了一个问题。

情况如下：我从数据库创建动态工具提示。为此，我进行了 2 次 ajax 调用，创建了很多 dom 以获得我想要的内容等。函数一个一个地调用自己，但结果是在工具提示完全创建之前显示。

要触发显示，我使用一个：

```
$('a').live('mouseenter',function(){
     BuildTooltip(this);
     $('#tooltipdiv').css('visibility','visible');
}); 
```

我希望工具提示仅在 ajax 调用完成时显示，工具提示已完全创建并且不会与以前的或类似的东西重叠。ajax 被缓存时可以正常工作，但在没有缓存时不能正常工作。

我尝试使用 async:false，但它创建的冻结不太友好，工具提示重叠我尝试回调，但它似乎不像我想要的那样工作......或者我做错了。

欢迎任何帮助:)

编辑：

这是我的 BuildTooltip 函数的代码。但是它调用了其他函数，所有内容都在 400 行左右，我不会全部复制:(

```
function BuildTooltip(element){
$('#tooltipdiv').remove();
if(String(element).indexOf('dbitem.php?db=')!=-1){
    url=String(element);
    var db=url.substring(url.indexOf('=')+1,url.indexOf('&'));
    $('body').append('<div class="" id="tooltipdiv"><div class="" id="uctt">\
        <div class="" id="itemttheader"></div><span class="" id="nomitem">\
        </span><div class="" id="imgitem"><img></img></div><div class="" id="type">\
        </div></div><div id="cd"></div><div class="" id="armor"><span class="" id="minarmor">\
        </span><span class="hash">-</span><span class="" id="maxarmor"></span> Armor</div><div class="" id="dmgweap">\
        <span class="" id="min"></span><span class="hash">-</span><span class="" id="max"></span> Damage</div>\
        <div class="" id="dmgweapnorm"><span class="" id="minmin"></span>\
        <span class="hash">-</span><span class="" id="maxmin"></span><span class="hash">-</span><span class="" id="minmax"></span><span class="hash">-</span>\
        <span class="" id="maxmax"></span> Damage</div><div class="" id="dpsnorm">\
        <span class="" id="mindamagepersec"></span> <span class="hash">-</span> <span class="" id="maxdamagepersec">\
        </span><p> Damage Per Second</p></div><div class="" id="dps"><span class="" id="damagepersec">\
        </span><p> Damage Per Second</p></div><div class="" id="attackspeed"><span class="" id="aps">\
        </span> Attacks Per Second</div><div class="" id="effect"></div><div class="" id="effectpsk">\
        </div><span class="" id="slot"></span><div id="useless"></div><div id="set"><span></span><div id="part0" class="part"></div>\
        <div id="part1" class="part"></div><div id="part2" class="part"></div><div id="part3" class="part"></div>\
        <div id="part4" class="part"></div><div id="part5" class="part"></div></div><div class="" id="requiredlevel">Required level : \
        <span class="" id="minlvl"></span></div><div class="" id="rewards">Rewards : \
        <span class="" id="reward"></span></div><div class="" id="points">\
        <span class="" id="point"></span> Points</div><div class="" id="durability">\
        Durability : <span class="" id="duramin"></span><span class="hash">-</span><span class="" id="duramax">\
        </span></div></div></div>');
    var offset=$(element).offset();
    request = $.ajax({
    url: "getphp/gettooltip.php",
    type: "GET",
    data: {db : db, id : url.substring(url.lastIndexOf('=')+1)},
    dataType: "JSON"
    });
    request.done(function(msg){
    FillInTooltip(msg,db)
    });
} 
```

}

FillInTooltip 函数使用 ajax 的结果，对其进行格式化，将其包含在 div 中，如果结果匹配一个条件，它会调用另一个 ajax 等

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-03T13:07:49.533

您可以在 Ajax 请求成功时显示工具提示：

```
$.ajax({
    type: "POST",
    url: URL, // your url
    success: function (html) {
        $('#tooltipdiv').css('visibility','visible');
    }
}); 
```

现在，在 Ajax 请求完成之前，不应显示工具提示。

# git - 变更集批准后 Gerrit 自动提交

> ID：10431973
> 
> 赞同：0
> 
> 时间：2012-05-03T13:03:39.007
> 
> 标签：git, svn, gerrit

我正在为我的团队设置 Gerrit 服务器，该团队是一个更大的 IT 组织的一部分。整个组织都使用中央备份的 SVN 服务器，所以我别无选择，只能连接 Gerrit 和 SVN。到目前为止，这很容易。

我不确定在提交被批准并合并到 gerrit master 后，更改将如何提交到 SVN。是否像编写运行“git svn dcommit”的“更改合并”挂钩一样简单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T14:31:50.960

这是您开始的最佳选择。不幸的是，如果 SVN 存储库发生了变化，而 Gerrit 不知道，您可能会遇到冲突。在这种情况下，您需要更新 Gerrit 中的存储库，然后让用户重新上传他们的补丁。

Gerrit 在这种设置下真的不能很好地工作。之前有人提出过要求，我们正在讨论如何正确处理 Gerrit 不是存储库所有者的情况。

# vba - 基本图表+标题使用vba for ppt

> ID：10431974
> 
> 赞同：0
> 
> 时间：2012-05-03T13:03:48.557
> 
> 标签：vba, powerpoint

我是 vba 的新手。我想生成一个带有图表和标题的ppt。我正在使用以下代码，但有问题。请建议。

```
Set pptobj = CreateObject("PowerPoint.Application")
pptobj.Visible = TRUE
Set presentn= pptobj.Presentations.Add
Dim dirtemp
dirtemp= CreateObject("WScript.Shell").ExpandEnvironmentStrings("%Temp%")
Dim tempImg
tempImg = dirtemp+"\test.gif"
Dim cnt
ind = 1
'my chart is in chartobj
if Not IsNull ( chartobj) then
    presentn.Slides.Add ind, 8
    chartobj.ExportPicture tempImg, "gif"        
    presentn.Slides(ind).Shapes(1).TextFrame.TextRange.Text = "some title"
    presentn.Slides(ind).Shapes(2).AddPicture tempImg, false, true, 50, 50
ind = ind + 1
end if 
```

我正在使用 ppLayoutChart（值 8）。但是，如果我使用 layout = 12 (ppLayoutBlank)，我可以成功生成图表，但是我无法添加标题:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-03T15:37:33.483

在空白布局幻灯片上，将没有形状，因此 .Shapes(1) 不会返回任何内容（当您引用它时会抛出错误，是吗？）

如果您需要为空白幻灯片添加标题，则必须添加文本形状，设置其文本并根据口味设置其格式。

添加虚拟 ppLayoutChart 幻灯片，设置其标题文本，将其复制/粘贴到您的*真实*幻灯片上，然后删除虚拟幻灯片可能会更简单。这将确保“伪标题”按应有的格式格式化。

或者更简单，不要添加空白，添加仅标题的布局幻灯片。

# java - 迭代时从集合中删除元素

> ID：10431981
> 
> 赞同：282
> 
> 时间：2012-05-03T13:03:59.860
> 
> 标签：java, collections, iteration

AFAIK，有两种方法：

1.  遍历集合的副本
2.  使用实际集合的迭代器

例如，

```
List<Foo> fooListCopy = new ArrayList<Foo>(fooList);
for(Foo foo : fooListCopy){
    // modify actual fooList
} 
```

和

```
Iterator<Foo> itr = fooList.iterator();
while(itr.hasNext()){
    // modify actual fooList using itr.remove()
} 
```

有什么理由更喜欢一种方法而不是另一种（例如，出于可读性的简单原因更喜欢第一种方法）？

* * *

## 回答 #1

> 赞同：540
> 
> 时间：2012-05-03T13:09:40.717

让我举几个例子和一些替代方案来避免`ConcurrentModificationException`.

假设我们有以下书籍集合

```
List<Book> books = new ArrayList<Book>();
books.add(new Book(new ISBN("0-201-63361-2")));
books.add(new Book(new ISBN("0-201-63361-3")));
books.add(new Book(new ISBN("0-201-63361-4"))); 
```

**收集和删除**

第一种技术包括收集我们想要删除的所有对象（例如，使用增强的 for 循环），在我们完成迭代后，我们删除所有找到的对象。

```
ISBN isbn = new ISBN("0-201-63361-2");
List<Book> found = new ArrayList<Book>();
for(Book book : books){
    if(book.getIsbn().equals(isbn)){
        found.add(book);
    }
}
books.removeAll(found); 
```

这是假设您要执行的操作是“删除”。

如果您想“添加”这种方法也可以，但我假设您将遍历不同的集合以确定要添加到第二个集合的元素，然后`addAll`在最后发出一个方法。

**使用 ListIterator**

如果您正在使用列表，另一种技术是使用`ListIterator`支持在迭代过程中删除和添加项目的 a。

```
ListIterator<Book> iter = books.listIterator();
while(iter.hasNext()){
    if(iter.next().getIsbn().equals(isbn)){
        iter.remove();
    }
} 
```

同样，我在上面的示例中使用了“删除”方法，这正是您的问题所暗示的，但您也可以使用它的`add`方法在迭代期间添加新元素。

**使用 JDK >= 8**

对于那些使用 Java 8 或更高版本的人，您可以使用其他一些技术来利用它。

您可以在基类中使用新`removeIf`方法：`Collection`

```
ISBN other = new ISBN("0-201-63361-2");
books.removeIf(b -> b.getIsbn().equals(other)); 
```

或者使用新的流 API：

```
ISBN other = new ISBN("0-201-63361-2");
List<Book> filtered = books.stream()
                           .filter(b -> b.getIsbn().equals(other))
                           .collect(Collectors.toList()); 
```

在最后一种情况下，要从集合中过滤元素，您可以将原始引用重新分配给过滤的集合（ie `books = filtered`），或者将过滤的集合用于`removeAll`从原始集合（ie `books.removeAll(filtered)`）中找到的元素。

**使用子列表或子集**

还有其他选择。如果列表已排序，并且您想要删除连续的元素，您可以创建一个子列表，然后将其清除：

```
books.subList(0,5).clear(); 
```

由于子列表由原始列表支持，这将是删除此元素子集合的有效方法。

`NavigableSet.subSet`使用方法的排序集或那里提供的任何切片方法都可以实现类似的效果。

**注意事项：**

您使用什么方法可能取决于您打算做什么

*   收集和`removeAl`技术适用于任何集合（集合、列表、集合等）。
*   该`ListIterator`技术显然只适用于列表，前提是它们的给定`ListIterator`实现支持添加和删除操作。
*   该`Iterator`方法适用于任何类型的集合，但它仅支持删除操作。
*   使用`ListIterator`/`Iterator`方法的明显优势是不必复制任何内容，因为我们在迭代时删除。所以，这是非常有效的。
*   JDK 8 流示例实际上并没有删除任何东西，而是寻找所需的元素，然后我们用新的元素替换原始的收集引用，并让旧的收集引用。因此，我们只对集合进行一次迭代，这样会很有效。
*   在收集和`removeAll`方法中，缺点是我们必须迭代两次。首先，我们在 foo 循环中迭代，寻找一个符合我们移除标准的对象，一旦我们找到它，我们就要求将它从原始集合中移除，这意味着第二次迭代工作来寻找这个项目，以便去掉它。
*   我认为值得一提的是，`Iterator`接口的 remove 方法在 Javadocs 中被标记为“可选”，这意味着如果我们调用 remove 方法，可能会有一些`Iterator`实现抛出。`UnsupportedOperationException`因此，如果我们不能保证迭代器支持删除元素，我会说这种方法不如其他方法安全。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2020-03-26T00:45:47.107

老计时器最爱（它仍然有效）：

```
List<String> list;

for(int i = list.size() - 1; i >= 0; --i) 
{
        if(list.get(i).contains("bad"))
        {
                list.remove(i);
        }
} 
```

好处：

1.  它只遍历列表*一次*
2.  没有创建额外的对象或其他不需要的复杂性
3.  尝试使用已删除项目的索引没有问题，因为......好吧，考虑一下！

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2017-10-04T07:19:48.933

在 Java 8 中，还有另一种方法。[收藏#removeIf](https://docs.oracle.com/javase/8/docs/api/java/util/Collection.html#removeIf-java.util.function.Predicate-)

例如：

```
List<Integer> list = new ArrayList<>();
list.add(1);
list.add(2);
list.add(3);

list.removeIf(i -> i > 2); 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2012-05-03T13:07:22.387

> 是否有任何理由偏爱一种方法而不是另一种方法

第一种方法可以工作，但复制列表的开销明显。

第二种方法不起作用，因为许多容器不允许在迭代期间进行修改。[这包括`ArrayList`](https://stackoverflow.com/questions/3184883/concurrentmodificationexception-for-arraylist).

如果唯一的修改是删除当前元素，则可以通过 using 使第二种方法起作用[`itr.remove()`](http://docs.oracle.com/javase/6/docs/api/java/util/Iterator.html#remove%28%29)（即，使用*iterator*的`remove()`方法，而不是*container*的方法）。**对于支持`remove()`.**

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-05-03T13:07:22.640

只有第二种方法可行。您可以在迭代期间仅使用修改集合`iterator.remove()`。所有其他尝试都会导致`ConcurrentModificationException`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-03T13:12:17.377

你不能做第二个，因为即使你使用[Iterator](http://docs.oracle.com/javase/6/docs/api/java/util/Iterator.html)`remove()`上的方法，[你也会得到一个 Exception throw](http://docs.oracle.com/javase/6/docs/api/java/util/AbstractList.html#iterator%28%29)。

就个人而言，我更喜欢所有`Collection`实例的第一个，尽管额外无意中听到了创建新的`Collection`，但我发现它在其他开发人员编辑期间不太容易出错。在某些 Collection 实现中，`remove()`支持 Iterator，而在其他一些实现中则不支持。[您可以在Iterator](http://docs.oracle.com/javase/6/docs/api/java/util/Iterator.html)的文档中阅读更多内容。

第三种选择是创建一个新的`Collection`，迭代原始的，并将第一个的所有成员添加`Collection`到第二个`Collection`不*准备*删除的所有成员。根据`Collection`删除的大小和数量，与第一种方法相比，这可以显着节省内存。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-03T13:08:27.513

我会选择第二个，因为您不必复制内存并且迭代器工作得更快。因此，您可以节省内存和时间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-27T10:51:41.063

你可以看到这个样本；如果我们认为从列表中删除奇数值：

```
public static void main(String[] args) {
    Predicate<Integer> isOdd = v -> v % 2 == 0;
    List<Integer> listArr = Arrays.asList(5, 7, 90, 11, 55, 60);
    listArr = listArr.stream().filter(isOdd).collect(Collectors.toList());
    listArr.forEach(System.out::println);
} 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2012-05-03T13:41:17.227

为什么不是这个？

```
for( int i = 0; i < Foo.size(); i++ )
{
   if( Foo.get(i).equals( some test ) )
   {
      Foo.remove(i);
   }
} 
```

如果它是一个地图，而不是一个列表，你可以使用 keyset()

# entity-framework - DbContext 仅验证更改的属性

> ID：10431984
> 
> 赞同：1
> 
> 时间：2012-05-03T13:04:11.577
> 
> 标签：entity-framework, entity-framework-4.3

我正在尝试更新实体的属性，而不是先从数据库中获取实体。

问题是我只想更新一些属性，而实体验证器抱怨说即使我没有更新那些不可为空的值也没有被填充。

我唯一的选择是关闭验证器吗？

我不想打开验证器，因为我想验证我正在更新的属性。

```
TestContext context = new TestContext();

LearningResource learningResource = new LearningResource();

learningResource.LearningResourceID = 132;

DbEntityEntry<LearningResource> entry = context.Entry(learningResource); 

context.LearningResources.Attach(learningResource);

entry.State = EntityState.Unchanged;

learningResource.Title = "alex";

entry.Property(e => e.Title).IsModified = true;

//Only seems to work if I do this.
//context.Configuration.ValidateOnSaveEnabled = false;

context.SaveChanges(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-03T13:21:39.843

那是[“一个特点”](http://social.msdn.microsoft.com/Forums/ar/adodotnetentityframework/thread/cacc3156-6b5f-4412-a8b8-a1279d28a536)。您必须关闭全局验证并分别验证每个更改的属性。

```
var result = entry.Property(e => e.Title).GetValidationResult(); 
```

我也不明白为什么这不是开箱即用的。

# c# - 没有从控制台发出命令的 C# 命名管道？

> ID：10431985
> 
> 赞同：0
> 
> 时间：2012-05-03T13:04:16.957
> 
> 标签：c#, stream, console, ipc, named-pipes

我正在使用命名管道与进程通信。我已经能够使用以下代码使其工作。（原始代码在这里找到：[通过archive.org](http://web.archive.org/web/20121207180449/http://www.dijksterhuis.org/using-named-pipes-in-c-windows/)）

```
class ProgramPipeTest
    {

        public void ThreadSenderStartClient(object obj)
        {
            // Ensure that we only start the client after the server has created the pipe
            ManualResetEvent SyncClientServer = (ManualResetEvent)obj;

            using (NamedPipeClientStream pipeStream = new NamedPipeClientStream(".","ToSrvPipe",PipeDirection.Out,PipeOptions.None))
            {
                // The connect function will indefinately wait for the pipe to become available
                // If that is not acceptable specify a maximum waiting time (in ms)
                pipeStream.Connect();

                Console.WriteLine("[Client] Pipe connection established");
                using (StreamWriter sw = new StreamWriter(pipeStream))
                {
                    sw.AutoFlush = true;
                    string temp;
                    Console.WriteLine("Please type a message and press [Enter], or type 'quit' to exit the program");
                    while ((temp = Console.ReadLine()) != null)
                    {
                        if (temp == "quit") break;
                        sw.WriteLine(temp);
                    }
                }
            }
        }

        public void ThreadStartReceiverClient(object obj)
        {
            // Ensure that we only start the client after the server has created the pipe
            ManualResetEvent SyncClientServer = (ManualResetEvent)obj;

            using (NamedPipeClientStream pipeStream = new NamedPipeClientStream(".", "FromSrvPipe", PipeDirection.In, PipeOptions.None))
            {
                // The connect function will indefinately wait for the pipe to become available
                // If that is not acceptable specify a maximum waiting time (in ms)
                pipeStream.Connect();

                Console.WriteLine("[ClientReceiver] Pipe connection established");

                using (StreamReader sr = new StreamReader(pipeStream))
                {
                    // Display the read text to the console
                    string temp;
                    while ((temp = sr.ReadLine()) != null)
                    {
                        Console.WriteLine("Received from server: {0}", temp);
                    }
                }
            }
        }

        static void Main(string[] args)
        {

            // To simplify debugging we are going to create just one process, and have two tasks
            // talk to each other. (Which is a bit like me sending an e-mail to my co-workers)

            ProgramPipeTest Client = new ProgramPipeTest();

            Thread ClientThread = new Thread(Client.ThreadSenderStartClient);
            Thread ReceivedThread = new Thread(Client.ThreadStartReceiverClient);

            ClientThread.Start();
            ReceivedThread.Start();

        }
    } 
```

一切都按预期工作。我能够向我的目标进程（大胆）发出命令。

我的问题是，我基本上想在此代码周围包装一个 C# GUI，但不知道如何修改它以便无需使用控制台即可完成通信，因为命令将通过 GUI 或从代码发出。

我尝试将 streamWriter sw 转换为类变量，通过属性公开它并使用方法调用 sw.WriteLine() ，但这似乎不起作用。

所以我不确定如何在一个对象中很好地来回封装流。

我发现这篇文章似乎很贴切，[Using Named Pipes to Connect a GUI to a Console App in Windows](http://www.drdobbs.com/windows/231903148)，但不幸的是，它似乎没有附带任何代码，而且在我头上没有任何参考。

那么如何在不使用控制台发出命令的情况下使用命名管道呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-03T15:38:21.177

您要做的是从该代码中取出主要的逻辑部分，即发送者和接收者，并将其重写为可重用的类，该类可以像特定用途的包装类一样使用。

也许下面的代码可以作为指导（我没有检查这是否有效，它可能需要稍作改动）

```
public sealed class ResponseReceivedEventArgs : EventArgs
{
    public ResponseReceivedEventArgs(string id, string response)
    {
        Id = id;
        Response = response;
    }

    public string Id
    {
        private set;
        get;
    }

    public string Response
    {
        private set;
        get;
    }
}

public delegate void ResponseReceived(object sender, ResponseReceivedEventArgs e);

public sealed class NamedPipeCommands
{
    private readonly Queue<Tuple<string, string>> _queuedCommands = new Queue<Tuple<string,string>>();
    private string _currentId;

    private readonly Thread _sender;
    private readonly Thread _receiver;

    // Equivalent to receiving a "quit" on the console
    private bool _cancelRequested; 

    // To wait till a response is received for a request and THEN proceed
    private readonly AutoResetEvent _waitForResponse = new AutoResetEvent(false);

    // Lock to modify the command queue safely
    private readonly object _commandQueueLock = new object();

    // Raise an event when a response is received
    private void RaiseResponseReceived(string id, string message)
    {
        if (ResponseReceived != null)
            ResponseReceived(this, new ResponseReceivedEventArgs(id, message));
    }

    // Add a command to queue of outgoing commands
    // Returns the id of the enqueued command
    // So the user can relate it with the corresponding response
    public string EnqueueCommand(string command)
    {
        var resultId = Guid.NewGuid().ToString();
        lock (_commandQueueLock)
        {
            _queuedCommands.Enqueue(Tuple.Create(resultId, command));
        }
        return resultId;
    }

    // Constructor. Please pass in whatever parameters the two pipes need
    // The list below may be incomplete
    public NamedPipeCommands(string servername, string pipeName)
    {
        _sender = new Thread(syncClientServer =>
        {
            // Body of thread
            var waitForResponse = (AutoResetEvent)syncClientServer;

            using (var pipeStream = new NamedPipeClientStream(servername, pipeName, PipeDirection.Out, PipeOptions.None))
            {
                pipeStream.Connect();

                using (var sw = new StreamWriter(pipeStream) { AutoFlush = true })
                    // Do this till Cancel() is called
                    while (!_cancelRequested)
                    {
                        // No commands? Keep waiting
                        // This is a tight loop, perhaps a Thread.Yield or something?
                        if (_queuedCommands.Count == 0)
                            continue;

                        Tuple<string, string> _currentCommand = null;

                        // We're going to modify the command queue, lock it
                        lock (_commandQueueLock)
                            // Check to see if someone else stole our command
                            // before we got here
                            if (_queuedCommands.Count > 0)
                                _currentCommand = _queuedCommands.Dequeue();

                        // Was a command dequeued above?
                        if (_currentCommand != null)
                        {
                            _currentId = _currentCommand.Item1;
                            sw.WriteLine(_currentCommand.Item2);

                            // Wait for the response to this command
                            waitForResponse.WaitOne();
                        }
                    }
            }
        });

        _receiver = new Thread(syncClientServer =>
        {
            var waitForResponse = (AutoResetEvent)syncClientServer;

            using (var pipeStream = new NamedPipeClientStream(servername, pipeName, PipeDirection.In, PipeOptions.None))
            {
                pipeStream.Connect();

                using (var sr = new StreamReader(pipeStream))
                    // Do this till Cancel() is called
                    // Again, this is a tight loop, perhaps a Thread.Yield or something?
                    while (!_cancelRequested)
                        // If there's anything in the stream
                        if (!sr.EndOfStream)
                        {
                            // Read it
                            var response = sr.ReadLine();
                            // Raise the event for processing
                            // Note that this event is being raised from the
                            // receiver thread and you can't access UI here
                            // You will need to Control.BeginInvoke or some such
                            RaiseResponseReceived(_currentId, response);

                            // Proceed with sending subsequent commands
                            waitForResponse.Set();
                        }
            }
        });
    }

    public void Start()
    {
        _sender.Start(_waitForResponse);
        _receiver.Start(_waitForResponse);
    }

    public void Cancel()
    {
        _cancelRequested = true;
    }

    public event ResponseReceived ResponseReceived;
} 
```

您可以看到我为 Console.ReadLine（命令队列）和 Console.WriteLine（事件）创建了抽象。“quit”也是一个布尔变量，现在由“Cancel()”方法设置。显然，这不是最佳/正确的方法——我只是向您展示一种将上面的命令式代码关联到可以重用的包装类的方法。

# javascript - jQuery表格行中的每个循环

> ID：10431987
> 
> 赞同：94
> 
> 时间：2012-05-03T13:04:27.943
> 
> 标签：javascript, jquery, html-table, each, tablerow

我有类似的东西：

```
<table id="tblOne">
            <tbody>
                <tr>
                    <td>
                        <table id="tblTwo">
                            <tbody>
                                <tr>
                                    <td>
                                        Items
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        Prod
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td>
                        Item 1
                    </td>
                </tr>
                <tr>
                    <td>
                        Item 2
                    </td>
                </tr>
            </tbody>
        </table> 
```

我已经编写了 jQuery 来遍历每个 tr，例如：

```
$('#tblOne tr').each(function() {...code...}); 
```

但问题是它循环通过“tblTwo”的“tr”也是我不想要的。任何人都可以建议解决这个问题吗？

* * *

## 回答 #1

> 赞同：237
> 
> 时间：2012-05-03T13:05:36.450

在 jQuery 中只需使用：

```
$('#tblOne > tbody  > tr').each(function() {...code...}); 
```

使用子选择器 ( `>`) 您将遍历所有子代（而不是*所有*后代），例如三行：

```
$('table > tbody  > tr').each(function(index, tr) { 
   console.log(index);
   console.log(tr);
}); 
```

结果：

```
0
<tr>
1 
<tr>
2
<tr> 
```

* * *

在*VanillaJS*中，您可以使用`document.querySelectorAll()`并遍历行`forEach()`

```
[].forEach.call(document.querySelectorAll('#tblOne > tbody  > tr'), function(index, tr) {
    /* console.log(index); */
    /* console.log(tr); */
}); 
```

* * *

## 回答 #2

> 赞同：72
> 
> 时间：2012-05-03T13:14:13.133

只是一个建议：

我推荐使用 DOM 表实现，它非常简单易用，你真的不需要 jQuery 来完成这个任务。

```
var table = document.getElementById('tblOne');

var rowLength = table.rows.length;

for(var i=0; i<rowLength; i+=1){
  var row = table.rows[i];

  //your code goes here, looping over every row.
  //cells are accessed as easy

  var cellLength = row.cells.length;
  for(var y=0; y<cellLength; y+=1){
    var cell = row.cells[y];

    //do something with every cell here
  }
} 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2012-05-03T13:07:02.710

使用[直接子选择器](http://api.jquery.com/child-selector/) `>`：

```
$('#tblOne > tbody  > tr') 
```

> 说明：选择“parent”指定的元素的“child”指定的所有**直接子元素。**

# web-services - oauth 要求

> ID：10431988
> 
> 赞同：1
> 
> 时间：2012-05-03T13:04:29.423
> 
> 标签：web-services, oauth, credentials

我需要使用 webservice 连接到另一个 web 应用程序。该 Web 应用程序使用 OAuth 协议连接到他们的 api。我是 OAuth 的新手，但我确实阅读了文档 :D 。我的问题是，要将我的 Web 应用程序与他们连接起来，我需要从他们那里获得哪些数据？我基本上需要获取资源所有者的所有数据。

我想我需要：

*   1) 来自该 Web 应用程序公司的消费者密钥和消费者密钥
*   2) 来自资源所有者的令牌凭证

我需要这些信息对吗？

我可以保存资源所有者令牌凭证以便将来在没有资源所有者登录的情况下获取数据吗？

在他们的网络应用程序中，它说我可以从他们那里获得以下信息：

*   OAuth 访问令牌和机密 - > 这些是资源所有者的令牌凭据吗？
*   OAuth 服务密钥和秘密 -> 这些是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-03T18:50:31.990

> 我需要这些信息对吗？

是的。您需要资源所有者通过 OAuth 流程授权您的应用程序。这由令牌凭证（过去称为访问令牌）表示。

> 我可以保存资源所有者令牌凭证以便将来在没有资源所有者登录的情况下获取数据吗？

是的。令牌凭证可能在到期时间、您可以访问的资源类型等方面对它们有限制。但如果令牌凭证已过期（或由资源所有者他/​​她自己无效） - 您的请求将不会被接受，您将不得不向资源所有者请求新的授权。

> OAuth 访问令牌和机密 -> 这些是资源所有者的令牌凭据吗？

是的。直到最近，令牌凭证在规范中被称为访问令牌，有关名称更改的信息可以在此处找到：[https ://www.rfc-editor.org/rfc/rfc5849#section-1.1](https://www.rfc-editor.org/rfc/rfc5849#section-1.1)

> OAuth 服务密钥和秘密 -> 这些是什么？

这些很可能是消费者密钥和秘密。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-03T14:41:46.357

我按照本[教程](http://www.codeproject.com/Tips/372422/Secure-WCF-RESTful-service-using-OAUTH)进行操作，很容易理解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-13T22:21:07.313

这是使其全部工作的流程顺序。

1.  在 API Provider（您的案例中的 Web 应用程序）上注册。这将为您生成客户端 ID 和客户端密码。

2.  交换客户端 ID、客户端密码、最终用户 ID/密码（在 http auth 标头中采用 base64 编码格式）、范围、授予 API Provider 的身份验证服务并获取授权码。

3.  使用 API Provider 的令牌服务交换客户端 ID、客户端密码、授权码并获取令牌。

4.  将此令牌与其他查询参数一起使用以继续执行 API 请求。

上述顺序适用于 grant_type=code。如果您要申请任何其他授权类型，则 #2 不适用，而在 #3 中，您提供最终用户 ID/密码以直接获取令牌。

# data-annotations - 实体框架数据注释等效于 .WillCascadeOnDelete(false);

> ID：10431990
> 
> 赞同：16
> 
> 时间：2012-05-03T13:04:34.420
> 
> 标签：data-annotations, entity-framework-4.3, entity-framework-migrations

我目前正在使用启用了迁移的 EF Code First 4.3，但禁用了自动迁移。

我的问题很简单，是否有相当于模型配置的数据注释 .WillCascadeOnDelete(false)

我想装饰我的班级，以便外键关系不会触发级联删除。

代码示例：

```
public class Container
{
    public int ContainerID { get; set; }
    public string Name { get; set; }

    public virtual ICollection<Output> Outputs { get; set; }
}

public class Output
{
    public int ContainerID { get; set; }
    public virtual Container Container { get; set; }

    public int OutputTypeID { get; set; }
    public virtual OutputType OutputType { get; set; }

    public int Quantity { get; set; }
}  

public class OutputType 
{
    public int OutputTypeID { get; set; }
    public string Name { get; set; }
} 
```

我想做这样的事情：

```
public class Output
{
    [CascadeOnDelete(false)]   
    public int ContainerID { get; set; }
    public virtual Container Container { get; set; }

    [CascadeOnDelete(false)]    
    public int OutputTypeID { get; set; }
    public virtual OutputType OutputType { get; set; }

    public int Quantity { get; set; }
} 
```

这样我就可以正确地为迁移搭建脚手架。它将外键关系架设在此刻被级联删除。

除了使用模型配置之外，还有什么想法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-03T13:16:09.903

不，没有这样的等价物。您必须使用 fluent API 选择性地删除级联删除，或者您必须删除`OneToManyCascadeDelete`约定以全局删除它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-31T02:56:39.957

创建一个映射类（流畅的语法）并使用以下代码：

```
// add relationships "Post" and "User" to a "Comment" entity
this.HasRequired(t => t.Post)
    .WithMany(t => t.Comments)
    .HasForeignKey(d => d.PostID)
    .WillCascadeOnDelete(false); // <---

this.HasOptional(t => t.User)
    .WithMany(t => t.Comments)
    .HasForeignKey(d => d.UserID)
    .WillCascadeOnDelete(false); // <--- 
```

如果您需要更多信息，这是一篇关于如何设置流畅映射的[好帖子。](http://www.remondo.net/code-first-fluent-api-entity-type-configuration/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-07T05:47:19.083

只需将 FK 属性设为可空即可防止发生级联删除：

```
public int? OutputTypeID { get; set; } 
```

# php - 如何获取组件参数？

> ID：10431995
> 
> 赞同：33
> 
> 时间：2012-05-03T13:04:42.637
> 
> 标签：php, joomla, joomla2.5, joomla-extensions

我这里有问题，无法解决：-/

我正在开发一个带有后端的 Joomla 组件。在后端我设置了一个参数，`dashboardId`，但我无法在视图中访问它们。我总是得到`data:protected`（当我转储时`params`）。好像我不允许访问该对象。

这是`default.xml`：

```
<?xml version="1.0" encoding="utf-8"?>
<metadata>
    <layout title="Dashboard">
        <message>
            <![CDATA[dashboard LAYOUT DESCRIPTION]]>
        </message>
    </layout>
    <fields name="params">
        <fieldset name="params">
            <field
                name="dashboardId" 
                type="text" 
                label="Dashboard ID"
                description="com_dashboard_desc"
                default="1"
            >   
            </field>
        </fieldset>
    </fields>
</metadata> 
```

现在，在`view.html.php`我尝试访问这样的参数：

```
$app = &JFactory::getApplication();
$params = JComponentHelper::getParams('com_dashboard');
$dashboardId = $params->get('dashboardId');
var_dump($dashboardId); 
```

当我这样做`var_dump($dashboardId);`时，`NULL`但当我转储时`$app`，我可以看到`dashboardID`

每一个帮助将不胜感激！谢谢

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-08-21T16:20:46.687

还有更简单的方法。首先导入Joomla Component Helper：

```
jimport('joomla.application.component.helper'); // not required in Joomla 3.x 
```

然后像这样检索您想要的任何属性：

```
$params = JComponentHelper::getParams('com_dashboard');
$dashboardID = $params->get('dashboardID'); 
```

问候。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-19T02:48:53.907

```
$app = JFactory::getApplication('site');
$componentParams = $app->getParams('com_example');
$param = $componentParams->get('paramName', defaultValue); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-20T15:19:42.857

类似于 LoboX 提供的答案，我建议使用组件助手来获取组件参数：

```
jimport('joomla.application.component.helper'); // Import component helper library
$params = JComponentHelper::getParams(JRequest::getVar('option')); // Get parameter helper (corrected 'JRquest' spelling)
$params->get('parameter_name'); // Get an individual parameter 
```

`JRequest::getVar('option')`返回带有 com_ 前缀的组件名称。除此之外，您似乎正在尝试将一些 1.5/1.6 语法混合到您的配置文件中。如果您还没有看到它，请尝试通读[2.5 版本](http://docs.joomla.org/Developing_a_Model-View-Controller_%28MVC%29_Component_for_Joomla!2.5_-_Part_13)的文档。我希望这会有所帮助！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-05-05T19:33:09.907

这与 JT Blum 的回答类似，但在 Joomla 3.x 中，JRequest 被贬低了。这是获取应用程序参数的另一种方法。

```
 $app = JFactory::getApplication();
    $input = $app ->input;
    $componentName = $input ->get('option');
    $params = JComponentHelper::getParams($componentName);
    print_r($params); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-10-12T19:53:39.050

由于 3.1 版 Joomla 正在弃用所有`J`类，实际上，4.0 版将弃用几乎所有`J`类，从现在开始检索组件参数的推荐方法是调用整个命名空间函数：

```
Joomla\CMS\Component\ComponentHelper::getParams('com_dashboard')->get('dashboardID'); 
```

或者，如果您正在处理模型，则可以调用`use`关键字以导入文件并在文档中使用该类，例如

```
use Joomla\CMS\Component\ComponentHelper;

function myFunction() {
    $param = ComponentHelper::getParams('com_dashboard');
    $dashboardID = $param->get('dashboardID');
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-04-08T12:20:33.720

在所有 Joomla 版本 1.5 / 2.5 /3.x 中获取参数对象的辅助函数

```
class myCompoHelper{

    public static function getParams($option)
    {

        if (version_compare(JVERSION, '1.5', 'g'))
        {
            $application = JFactory::getApplication();
            if ($application->isSite())
            {
                $params = $application->getParams($option);
            }
            else
            {
                jimport('joomla.application.component.helper');
                $params = JComponentHelper::getParams($option);
            }
        }
        else
        {
            jimport('joomla.application.component.helper');
            $params = JComponentHelper::getParams($option);
        }
        return $params;
    }

}

$params=myCompoHelper::getParams('com_mycomponent');
echo $params->get('myParamName',null); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-04-25T10:13:17.490

我有一个类似的问题。我只得到了**data:protected**结果，直到我去配置我的组件并保存它。尽管在文本字段中打印了默认值，但 Joomla 在单击“保存”之前无法读取它们。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-09-28T06:46:09.090

我有同样的问题，解决方案是这样的：

```
$input = JFactory::getApplication()->input;
$parametername = $input->getInt('parametername');
echo $parametername; 
```

这是views tmpl 文件夹中default.xml 中参数的名称。这是xml

```
<?xml version="1.0" encoding="utf-8"?>
<metadata>
    <layout title="Offers">
         <message>This is a component in order to display offers</message>
    </layout>
    <state>
        <name>name</name>
            <description>description</description>

        <url addpath="/administrator/components/com_component/elements">
            <param name="category_id" section="com_component" type="categoriesmenu"  value_field="category_name" label="COM_COMPONENT_CATEGORY_FIELD_SELECT_TITLE" description="COM_COMPONENT_CATEGORY_FIELD_SELECT_TITLE_DESC" />
        </url>
    </state>

    <fields name="request" >
        <fieldset name="request" addfieldpath="/administrator/components/com_component/models/fields">
            <field name="parametername" type="category"
                label="category"
                required="true"
                description="Perigrafh"
            />
        </fieldset>
    </fields>

</metadata> 
```

# haskell - underscore.js 中的链函数是否创建了一个 monad？

> ID：10431999
> 
> 赞同：30
> 
> 时间：2012-05-03T13:04:53.770
> 
> 标签：haskell, functional-programming, monads, underscore.js, comonad

在您找到[的`chain`文档中：](http://underscorejs.org/#chaining)

> 调用`chain`一个包装的对象将导致所有未来的方法调用也返回包装的对象。完成计算后，使用`value`检索最终值。

那么这个[`chain`](http://underscorejs.org/#chain)函数会创建一个单子吗？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-05-04T14:18:35.013

不，不是单子，而是共子！它将一个接受包装对象并返回正常值的函数转换为一个接受并返回包装对象的函数。作为 Haskell 类型签名，它将是：

```
(Wrapped a -> b) -> (Wrapped a -> Wrapped b) 
```

的类型签名`value`是：

```
Wrapped a -> a 
```

这些正是您需要的comonad。通常调用第一个函数，`extend`然后调用第二个函数`extract`。

您可以将comonad 视为具有一些额外上下文的值。当然，这正是`chain`它的作用。

有关comonads 的更多信息，请参阅[这个 Stackoverflow 问题](https://stackoverflow.com/questions/8428554/what-is-the-comonad-typeclass-in-haskell)。