# StackOverflow 问答 000665000-000665999

# php - MySQL 中有没有一种方法可以通过一个查询来反转布尔字段？

> ID：665002
> 
> 赞同：26
> 
> 时间：2009-03-20T04:38:02.570
> 
> 标签：php, mysql

我的表格中有一个标题为“授权”的列。它的默认值为 0。当用户被授权时，它需要更改为 1，但它必须能够重置为 0。我知道我可以通过 2 个查询轻松做到这一点，如下所示：

```
$authorised = Db::query('SELECT authorised FROM users WHERE id=2');

$newAuthValue = ($authorised['authorised']) ? 0 : 1;

Db::query('UPDATE users SET authorised=' . $newAuthValue . ' WHERE id=2'); 
```

我想知道的是，有没有办法用一个查询来做到这一点？反转布尔值？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-03-20T04:42:51.607

```
UPDATE users SET `authorised` = IF (`authorised`, 0, 1) 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-03-20T07:54:58.683

```
UPDATE `users` SET `authorised` = NOT `authorised` WHERE id = 2 
```

此查询也将用于否定字段，并且更符合布尔语法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-20T04:43:33.027

有多种方法可以做到这一点，这里有一个简单的方法：

```
UPDATE users SET authorised = ABS(authorised - 1) WHERE id = 2; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-02-27T10:45:59.727

如果您的“布尔”字段被实现为 TINYINT，也可以使用 XOR：

```
UPDATE users SET authorised = authorised XOR 1 WHERE id = 2; 
```

如果当前为 1，这会将“授权”设置为 0，如果当前为 0，则设置为 1。它还将所有非零值归零，因此如果您（像我一样）使用多个正值来反映各种“ on' 级别，但在 'off' 时始终需要恢复为 0。

# debugging - 调试符号问题

> ID：665003
> 
> 赞同：0
> 
> 时间：2009-03-20T04:38:19.013
> 
> 标签：debugging, windbg, symbols, crash-dumps

当我们使用 Windbg 或 Visual Studio 分析转储文件时，我对使用哪个符号文件感兴趣。假设我的应用程序正在使用一个实用程序库，并且该实用程序库有相关的私有符号文件。当我的应用程序中出现故障转储时，我需要实用程序库的符号来分析完整的调用堆栈。但有时构建/运行时/调试环境安装有不同版本的实用程序库——（肯定）是不同版本的实用程序库符号。

假设我们有一个版本（例如版本 A）的实用程序库（和相关符号）用于构建（链接）我的应用程序，当发生崩溃时，在运行时使用另一个版本（例如版本 B）的实用程序库（和相关符号），并且当我分析故障转储时，在 Windbg 中使用另一个不同版本（例如版本 C）的实用程序库（和相关符号）。

我的问题是，在运行时生成崩溃时，使用版本 B 符号生成崩溃转储（用符号信息填充转储）？但是在Windbg调试环境中使用不同版本的符号C时，会出现符号不匹配的问题？并且使用哪个版本的库来构建无关紧要？我的理解都正确吗？

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T05:06:26.793

It sounds like you want to use a [Symbol Server](http://msdn.microsoft.com/en-us/library/ms681417(VS.85).aspx) so that WinDBG or VS can pull down symbols that correspond to the build of the library you're debugging. If it's a third party component and you have private symbols you can either put them symbols in your own server or see if the third party has a public symbol server.

Windbg won't load symbols if they don't match the dll you're debugging, you can use !sym noisy to see more about the symbol loading process. If you choose not to use a symbol server you can manage all the pdb's by hand and load them manually into windbg (use lm v to get detailed information about a module loaded in your process)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T05:01:11.830

Generally the symbols should be in the same file as the code (that's why debug versions are generally bigger). I can't recall a case where a debugger would pull the symbols from one binary while running another--but then, this is from general knowledge and not from any specialized information about your environment.

# asp.net - ASP.NET 自定义错误，除了 404 错误，

> ID：665005
> 
> 赞同：4
> 
> 时间：2009-03-20T04:40:54.560
> 
> 标签：asp.net

我已经设置自定义错误如下..

```
protected void Application_Error(Object sender, EventArgs e)
{
    Exception ex = HttpContext.Current.Server.GetLastError();
    if (ex is HttpUnhandledException && ex.InnerException != null)
        ex = ex.InnerException;
    if (ex != null)
    {
        try
        {
            Logger.Log(LogEventType.UnhandledException, ex);
        }
        catch
        { }
    }

    HttpContext.Current.Server.ClearError();
    Response.Redirect(MyCustomError);

} 
```

我想知道是否可以检测到这个错误是否是404错误，然后显示默认的404错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T05:13:08.617

我不得不说我真的很困惑为什么你要清除发生的任何错误，然后首先重定向到自定义错误页面。

也许改变：

```
HttpContext.Current.Server.ClearError();
Response.Redirect(MyCustomError);
//to
if (!(ex is HttpException && 404 == ((HttpException)ex).getHttpCode())){
  HttpContext.Current.Server.ClearError();
  Response.Redirect(MyCustomError);
} 
```

否则，不要进行任何这些检查，并留下任何未找到文件的异常。`web.config`让它们由框架中定义的自定义错误处理程序处理。

```
<customErrors mode="RemoteOnly" defaultRedirect="~/Error/500.htm">
    <error statusCode="500" redirect="~/Error/500.htm"/>
    <error statusCode="404" redirect="~/Error/404.htm"/>
</customErrors> 
```

如果您没有看到您想要的处理方式，请将模式更改为“开启”。

如果您需要抛出 404，可能是因为请求的项目的 ID 已从数据库中删除，则抛出相应的 HttpException 错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T04:52:08.810

我很确定对静态文件的请求不会通过 Asp.Net 框架——只有以 .aspx 结尾的文件才会通过。因此，对不存在的静态文件的请求将从 IIS 获得 404，但不会被 asp.net 处理。

您可以执行与本页标题“IIS 自定义 401 错误”下所述类似的操作：

[http://msdn.microsoft.com/en-us/library/ms972958.aspx](http://msdn.microsoft.com/en-us/library/ms972958.aspx)

它的要点是在 iis 中创建一个自定义错误处理程序，将用户发送到某个静态 htm 文件，该文件将他们重定向到您的特殊 404 处理程序 aspx 页面。

# c - K&R C 示例中的指针类型不匹配警告

> ID：665012
> 
> 赞同：6
> 
> 时间：2009-03-20T04:45:28.043
> 
> 标签：c, kernighan-and-ritchie

> **可能重复：**
> [编译 K&R 示例时出现问题](https://stackoverflow.com/questions/616906/problem-compiling-kr-example)

最近我一直在研究 K&R 的 C 编程语言。

在第 5.11 节中，他们介绍了指向函数的指针，并且在输入他们的示例之后——一个快速排序实现，我们提供了一个指向我们想要使用的比较函数的指针——我从编译器那里得到一个警告：条件表达式中的指针类型不匹配. （我的编译器是 OS X 10.5.6 上的 gcc 4.0.1）

示例中触发警告的行是：

```
 qsort((void **) lineptr, 0, nlines-1,
      (int (*)(void*, void*))(numeric ? numcmp : strcmp)); 
```

该程序在没有段错误的情况下执行，但我喜欢尽可能消除所有警告，或者至少了解它们的原因。

numcmp 的函数声明如下所示：

```
 int numcmp(char *, char *); 
```

但是根据手册页， stcmp 有这个签名：

```
 int strcmp(const char *s1, const char *s2); 
```

由于方法签名略有不同，警告是否简单？忽视警告的后果是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T04:57:19.937

Although you can implicitly cast a char* to a void*, you can't do the same for a function pointer with those types (without a warning). The compiler is more careful with type matching on function signatures.

Not to mention that what's happening inside qsort would be the opposite: that is, a void* would be cast to a char* in numcmp and const char* in strcmp.

And the compiler should issue a warning in these cases. If you really have to use a function that doesn't have the same types as parameters, perhaps you should use a wrapper function that does match the types, and then does the appropriate explicit cast when calling the original function.

For instance:

```
static int strcmp_wrapper(void* s1, void* s2) {
  return strcmp((char*)s1, (char*)s2);
}

static int numcmp_wrapper(void* n1, void* n2) {
  return numcmp((char*)n1, (char*)n2);
}

qsort((void **) lineptr, 0, nlines-1,
      (numeric ? numcmp_wrapper : strcmp_wrapper)); 
```

And the modern signature for qsort is

```
void
qsort(void *base, size_t nel, size_t width,
      int (*compar)(const void *, const void *)); 
```

The issue of `const` doesn't seem to come into play in your question, but K&R did not have `const`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-20T04:52:50.897

简短回答：K&R 不知道 C。

冗长的回答：当他们开始的时候，*没有人*知道 C，这使他们受到了阻碍，所以他们在进行过程中有点编造。

（稍微）不那么轻率的长答案形式：自从编写 K&R 以来，该语言已经发展了很多（有些人会说发生了*变化*），但是除非您获得具有动态示例变形的电子书版本，否则您副本中的示例K&R 不会跟上“新的和认可的”（“现在有了更多的 ANSI！”）语言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T04:51:30.230

尝试诊断它的一种方法是查看如果将表达式替换为 ?: 仅使用两者之一会发生什么。

如果它只发生在 strcmp 而不是 numcmp，那么很可能是因为 const char*。我认为虽然 char* 始终可以转换为 void*，但您不能将 const char* 转换为 void* 作为“安全”。

如果两者都有，那么这可能与函数指针有关，其中将 char* 转换为 void* 可以工作，但签名应该相同，并且使用 void 而不是 char 是一个问题。

# vbscript - 我的脚本不会在任务调度程序下运行。为什么？

> ID：665014
> 
> 赞同：15
> 
> 时间：2009-03-20T04:45:58.310
> 
> 标签：vbscript, windows-server-2008, scheduled-tasks

我有一个 vbscript 脚本，当我自己运行它时运行良好。

出于某种原因，当我以管理用户身份在任务计划程序下运行它时，它会运行，但甚至不会写入我的日志文件。它不应该是权限，因为我运行它的用户是管理员。

它是在 Win2008 64 位机器上调用 32 位 dll 的脚本。

C:\windows\SysWOW64\cscript.exe Bob.vbs

我还将本地目录设置为我从中运行它的位置。

具有讽刺意味的是，任务调度程序说“成功完成”了任务的运行。

此外，任务调度程序中还有其他脚本运行良好，它只是这个脚本。

有人有我可以检查的东西的清单吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-12-18T02:37:59.337

我在 Windows 2008 Server 和 Windows 7 上遇到了 DOS 批处理文件和 VB 脚本的问题。在每种情况下，一旦我为计划任务操作设置“开始”文件夹，一切正常。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-20T10:57:24.860

我在我的 SVN 服务器上运行计划任务时遇到了类似的问题。

我的脚本正在写入我认为是当前工作目录（我为任务指定为“开始于”文件夹的目录）。如果我登录到服务器并运行脚本，它工作正常。当作为计划作业运行时，它不会。

在我的情况下，调度程序似乎将工作目录重新分配为`TEMP`环境变量中为用于运行作业的用户帐户指定的目录，而不是我为任务指定的目录（“开始于”文件夹） .

检查该`TEMP`帐户的文件夹，看看您的文件是否在那里。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-10-14T15:53:12.660

如果您正在运行 Win2008 64 位机器：这（最终）在同一台服务器上为我工作。任务调度程序运行一个批处理文件（例如 runvbs.bat）以使用 32 位版本的命令行解释器调用 cscript，如下所示：

```
@echo off
%windir%\syswow64\cmd.exe /C "c:\windows\system32\cscript.exe //B //nologo import_some_data.vbs" 
```

**注意双引号**。

我使用管理员组获得权限并以最高权限运行。

配置：Windows® 7、Windows Server™ 2008 R2

在“编辑操作”对话框中，我有：

行动：启动程序

程序/脚本：runvbs.bat

开始于：c:\inetpub\wwwroot\asp\importstuff\

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-05-23T09:36:04.603

我对此有真正的问题（早上好），并在[这里](https://stackoverflow.com/questions/12628278/how-to-execute-cscript-using-windows-task-schedule)找到了这个解决方案：

在 Windows 任务计划程序中，我必须单击“更改用户或组”按钮并添加“管理员”组。

希望它可以帮助某人。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-03T17:01:35.090

对于 Windows 2008，您可能需要确保任务以管理权限运行。

常规选项卡 - （选中）以最高权限运行

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-03-03T23:03:20.863

解决了同样的问题。连接到数据库时脚本会失败，然后在修复创建 Xls 文件时失败。我创建了一个 bat 文件并将以下内容添加到其中。这个 bat 文件将调用我的 vb 脚本并以 32 位模式运行它。

```
%windir%\SysWoW64\cmd.exe /C "c:\windows\system32\cscript.exe //B //nologo C:\ScheduledJobs\PrimeReconDev\myVBScript.vbs" 
```

我设置了任务计划以执行具有上述内容的我的 bat 文件，并将执行用户划分为管理员。通过在常规选项卡上唱“更改用户或组”选项来执行此操作。一旦完成，我就能够成功执行没有问题。我最初以我的身份执行并且我在管理员组中，但它仍然失败。以内置管理员的身份执行就可以了

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-20T04:49:44.010

过去我遇到过类似的问题，即在调度 vbs 脚本时代码未执行——这可能是有问题的！也很想知道是否有人可以解决这个问题。（顺便说一句，我们通过将代码重写为 C# 控制台应用程序来解决它）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-20T05:03:59.857

当我遇到这个问题时，通常是因为在我的任务上运行的程序出错了，即使已完成任务的返回值没有报告任何问题。

您说它运行但不写入您的日志 - 它是否可能在写入您的日志之前崩溃？

如果您还没有，请在您的脚本中添加错误处理并尝试记录任何错误，或者至少尝试跟踪它在脚本中的进度。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-08-08T14:16:49.447

在我将存储 bat 作业的路径添加到操作选项卡上的**Start in**之前，我遇到了同样的问题。

右键单击任务→属性→操作→编辑开始（可选）

只需填写您的蝙蝠工作的路径。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-07-11T15:34:35.823

我有同样的问题。

我通过使用相对路径（“logs\log”）而不是我之前使用的绝对路径（“U:\workingDirectory\logs\log”）来修复它。

显然，当您通过任务调度程序执行脚本时，您需要使用相对路径。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-03-27T07:03:21.613

我有同样的问题。在 Task -> Run field CMD /C "full path to my VBScript" 中使用下一个字符串，如 CMD /C c:\Test\MyScript.vbs

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-03-30T16:56:30.673

到处寻找这个，但现在我知道了，我会分享。

有在服务器 2003 上运行良好的脚本，尝试移动到服务器 2012 并且部分脚本无法运行。

必须创建一个新任务并在常规选项卡上选择“windows server 2003、Windows XP 或 Windows 2000 的配置。如果您使用基本任务，则此选项不允许用于 2003，您必须使用新任务。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-06-28T20:19:03.223

替代解决方案：

►*仅在用户登录时运行*

在任务管理器中进行选择。

* * *

这就是为我解决的问题（在 3 台单独的计算机上 - Win7 Pro、Win12 Server）

我希望它可以帮助别人。

# java - 如何除以得到十进制值？

> ID：665018
> 
> 赞同：28
> 
> 时间：2009-03-20T04:47:10.147
> 
> 标签：java, math, division, modulus

我想知道如何在 Java 中获取单个值的余数和商。

例子：

> 3/2 我应该得到 1.5 的值。

如果我使用`/`运算符，我只会得到商。如果我使用`%`操作员，我只会得到剩余部分。如何在同一个变量中同时获得两者？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-03-20T04:51:19.187

```
quotient = 3 / 2;
remainder = 3 % 2;

// now you have them both 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-03-20T04:49:50.983

在您的示例中，Java 正在执行*整数*运算，四舍五入除法的结果。

根据您的问题，您想执行浮点运算。为此，您的术语中的至少一项必须指定为（或转换为）浮点数：

指定浮点数：

```
3.0/2
3.0/2.0
3/2.0 
```

转换为浮点数：

```
int a = 2;
int b = 3;
float q = ((float)a)/b; 
```

*或者*

```
double q = ((double)a)/b; 
```

（有关 和 的讨论，请参阅Java陷阱[：double](https://web.archive.org/web/20120529055141/http://firstclassthoughts.co.uk/java/traps/java_double_traps.html)和[Java Floating-Point Number Intricacies](https://web.archive.org/web/20120215130321/http://www.concentric.net/~ttwang/tech/javafloat.htm)）`float``double`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-09-20T12:16:29.017

看看这个：http: [//download.oracle.com/javase/1,5.0/docs/api/java/math/BigDecimal.html#divideAndRemainder%28java.math.BigDecimal%29](http://download.oracle.com/javase/1,5.0/docs/api/java/math/BigDecimal.html#divideAndRemainder%28java.math.BigDecimal%29)

您只需将*int*或*long*变量包装在*BigDecimal*对象中，然后对其调用**divideAndRemainder**方法。返回的数组将包含商和余数（按该顺序）。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-03-20T05:34:09.753

Don't worry about it. In your code, just do the separate / and % operations as you mention, even though it might seem like it's inefficient. **Let the JIT compiler worry** about combining these operations to get both quotient and remainder in a single machine instruction (as far as I recall, it generally does).

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-22T05:36:48.920

如果你将两个参数都初始化为`float`，你肯定会得到实际的分值。例如：

```
float RoomWidth, TileWidth, NumTiles;
RoomWidth = 142;
TileWidth = 8;
NumTiles = RoomWidth/TileWidth; 
```

> 答：17.75。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-02-28T18:42:39.117

你可以这样做，

```
int a = 3;
int b = 2;
int quotient = a / b;
int remainder = a % b; 
```

> 得到实数的商

```
System.out.println((double) a / b); 
```

> 获得整数的商

```
System.out.println("Quotient: " + quotient);
System.out.println("Remainder: " + remainder); 
```

> 得到实数的商，使得小数点后有一个数字

```
System.out.println(a / b + "." + a % b * 10 / b); 
```

> 注意：在最后一种方法中，它不会将小数点后的数字四舍五入。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-02-28T18:13:45.130

我的意思是这很简单。将其设置为双精度。所以让我们说

```
double answer = 3.0/2.0;
System.out.print(answer); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-03-15T04:02:23.393

```
int a = 3;
int b = 2;
float c = ((float)a)/b 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-04-13T06:51:56.957

请将您的输入转换为双倍并除以。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-11-21T21:02:42.600

@recursive 的解决方案（接受的答案）是 100% 正确的。我只是添加一个示例代码供您参考。

我的情况是用两位小数显示价格。这是后端响应的一部分：`"price": 2300, "currencySymbol": "CD", ...`。

这是我的助手类：

```
public class CurrencyUtils
{
    private static final String[] suffix = { "", "K", "M" };

    public static String getCompactStringForDisplay(final int amount)
    {
        int suffixIndex;
        if (amount >= 1_000_000) {
            suffixIndex = 2;
        } else if (amount >= 1_000) {
            suffixIndex = 1;
        } else {
            suffixIndex = 0;
        }

        int quotient;
        int remainder;
        if (amount >= 1_000_000) {
            quotient = amount / 1_000_000;
            remainder = amount % 1_000_000;
        } else if (amount >= 1_000) {
            quotient = amount / 1_000;
            remainder = amount % 1_000;
        } else {
            return String.valueOf(amount);
        }

        if (remainder == 0) {
            return String.valueOf(quotient) + suffix[suffixIndex];
        }

        // Keep two most significant digits
        if (remainder >= 10_000) {
            remainder /= 10_000;
        } else if (remainder >= 1_000) {
            remainder /= 1_000;
        } else if (remainder >= 100) {
            remainder /= 10;
        }

        return String.valueOf(quotient) + '.' + String.valueOf(remainder) + suffix[suffixIndex];
    }
} 
```

这是我的测试类（基于 Junit 4）：

```
public class CurrencyUtilsTest {

    @Test
    public void getCompactStringForDisplay() throws Exception {
        int[] numbers = {0, 5, 999, 1_000, 5_821, 10_500, 101_800, 2_000_000, 7_800_000, 92_150_000, 123_200_000, 9_999_999};
        String[] expected = {"0", "5", "999", "1K", "5.82K", "10.50K", "101.80K", "2M", "7.80M", "92.15M", "123.20M", "9.99M"};

        for (int i = 0; i < numbers.length; i++) {
            int n = numbers[i];
            String formatted = CurrencyUtils.getCompactStringForDisplay(n);
            System.out.println(n + " => " + formatted);

            assertEquals(expected[i], formatted);
        }
    }

} 
```

# winforms - Visual Studio C++/CLI Winforms 项目中的设计器生成代码

> ID：665019
> 
> 赞同：0
> 
> 时间：2009-03-20T04:48:35.993
> 
> 标签：winforms, c++-cli, compilation, windows-forms-designer

C++/CLI 项目中的 Windows 窗体设计器在头文件本身中生成所有事件处理程序的声明和定义。它生成的 .cpp 只是一个存根，它仅包含生成的标头和 stdafx.h。我觉得如果我将所有类方法的实现（即定义）移到它们应该属于的 .cpp 中，我可以减少编译时间。当标头在多个位置#included 时，这一点变得尤为重要。

将我的代码拆分为单独的声明 (.h) 和定义 (.cpp) 文件是否有任何缺点或副作用？建议？最佳实践？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-22T10:39:12.583

如果您手动将初始化方法移动到 .cpp 文件（InitializeComponent 方法），则设计器在尝试构建设计图面时将无法找到它，您将失去使用设计器的能力。

我建议将 InitializeComponent 留在原处。

# javascript - 如何使用 jquery 每 x 秒显示 n 个 json 项目？

> ID：665022
> 
> 赞同：0
> 
> 时间：2009-03-20T04:50:39.593
> 
> 标签：javascript, jquery

我有一个 JSON 对象`items`，其中有一些我想每 2 秒显示 2 个的项目。我该怎么做？因此，它`division1`每隔几秒钟显示一次项目，而不是一次显示所有项目。例如。每 5 秒获取所有项目，每秒显示 4 个项目，共 20 个项目。

```
<table id="division1" >
    <thead>
        <th>Name</th>
        <th>Score</th>
    </thead>
    <tbody></tbody>
</table>

function render_items(division){
    var tablebody ="";
        $.each(division.items, function (i,item){
            var tablerow ="<tr>"
                +"<td>"+item.name+"</td>"
                +"<td>"+item.score+"</td>"
                +"</tr>";
            tablebody = tablebody+tablerow;

           //$('#test').append(division.name+' '+i+' '+robot.name+'<br>');
        }
        );
        $('#'+division.name+" tbody").html(tablebody);  
}

function poll(){
    $.post("data.php", {getvalues: 0}, 
    function (data, status){
        $.each (data.divisions, function(i,division){
            render_items(division);     

        }); 
    },
    'json'
    );
    setTimeout('poll()',5000);
}

$(document).ready(function() {
    poll();

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T05:53:15.620

隐藏所有行可能是最简单的，然后每秒显示一系列行，例如：

```
function startShow(table) {
    var index = 0;
    var trs = table.find("tbody tr");
    function update() {
        if (index >= trs.length) {
            index = 0;
        }
        trs.hide().slice(index, index + 4).show();
        index += 4;
        setTimeout(update, 1000);
    }
    update();
} 
```

然后用

```
startShow($("#division1")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T05:38:17.373

setTimeout 可以将函数作为第一个参数，然后它可以利用闭包变量来跟踪数据和计数。

# mysql - 是什么让 PostgreSQL 比 MySQL 更先进？

> ID：665023
> 
> 赞同：10
> 
> 时间：2009-03-20T04:50:59.280
> 
> 标签：mysql, postgresql

我听说过很多**PostgreSQL**，但我一直想知道为什么你会选择它而不是 MySQL。是什么让它成为“世界上最先进的”，这些“先进”的功能真的很重要吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-20T05:00:55.433

postgres 具有更好的外键支持、更好的引用完整性、事务、视图、子选择等。但这并不意味着 MySQL 没有它的位置。这真的取决于你的需求是什么。数据库的大小和关系的复杂性等。MySQL 的设置和使用非常简单，几乎所有 Web 包都默认提供。

您可以在整个网络上找到这两个之间的大量比较。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T04:53:34.983

这是一个很好的比较页面：[MySQL vs. PostgreSQL](http://www.wikivs.com/wiki/MySQL_vs_PostgreSQL)。

这个问题可能应该被认为是重复的，这个话题已经在这里讨论过很多次了：[Google search for "postgresql mysql" on StackOverflow.com](http://www.google.com/search?q=postgresql+mysql+site%3Astackoverflow.com)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T13:04:18.033

bobince：RE：外键支持、引用完整性、事务、视图、子选择：InnoDB 可能有它们，但它们不像 PostgreSQL 那样符合标准或经过实际测试（正如 MySQL 开发人员多年来声称的那样，这些特性是不需要的）。此外，InnoDB 不是默认表类型，您需要使用非 ACID 表类型进行全文搜索等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-07T12:36:16.593

你应该检查这个：

[http://tweakers.net/reviews/649/7/database-test-sun-ultrasparc-t1-vs-amd-opteron-mysql-vs-postgresql.html](http://tweakers.net/reviews/649/7/database-test-sun-ultrasparc-t1-vs-amd-opteron-mysql-vs-postgresql.html)

这讨论了关于并发和核心数量的结果，数据库测试：Sun UltraSparc T1 vs. AMD Opteron

“PostgreSQL可能被称为多线程良好实现的教科书示例”

# asp.net - 我应该使用 ASP.NET 会话还是避免它们，为什么？

> ID：665029
> 
> 赞同：5
> 
> 时间：2009-03-20T04:52:08.903
> 
> 标签：asp.net, session

我应该使用 ASP.NET 会话还是避免它们，为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T06:52:24.667

对于新的应用程序，[我尽量避免使用它们](https://stackoverflow.com/questions/526697/upgrade-from-net-3-0-to-3-5-sites-set-to-stateserver-revert-to-inproc-when-in-w)，只喜欢加密或签名的 cookie。诚然，这只是一个新发现的个人偏好：仅仅因为它是另一件要打破的事情，并且在努力保持网站 24/7/365 运行两年后，这是唯一一件令人头疼的事情，神秘的方式。也很容易忘记在您的对象上添加 [Serializable] 并在它们尝试存储在进程外会话中时观看它们在运行时爆炸。因此，可以这么说，这是另一个需要磨合的齿轮。

也就是说，我*多年来*一直在使用会话，除了担心保持会话存储始终保持正常运行之外，没有任何重大问题。如果您是 InProc，则必须担心每次应用程序池重新启动时会话都会被破坏，并且可能导致工作进程内存使用量激增，这是另一个缺点；使用其他方法之一，能够向网站发布点更新并且不影响任何客户的当前状态是很好的。

（我个人没有看到扩展会话的问题，即使在多台服务器上也是如此。但是我再次为一家小型企业工作 [大约 3 页面浏览量/秒]。我认为您通常会与数据库交谈，获取会话的成本就是这样。）

所以使用会话不是一个坏的选择，你只需要记住不要被它冲昏了头脑。把它想象成一个服务器端的 cookie，试图将自己限制在一个人为的 4KB 左右的障碍内。对于现有的应用程序，我当然不会打扰它们，但总的来说，我现在更喜欢保持简单并尽量不用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T04:56:43.790

对于 Intranet 应用程序，我使用它们（但实际上并不多）。

对于外部应用程序，如果需要，请使用它们，但前提是您只有一个服务器。

对于具有大量用户的大型应用程序，以及代理平衡器后面的多个 Web 服务器，您可能应该开始考虑如何构建您的站点以避免使用它们。我个人会使用的最佳选择是将加密数据存储在用户 cookie 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T05:00:24.467

[ASP.NET 会话状态常见问题解答](http://www.eggheadcafe.com/articles/20021016.asp)这将回答具有会话变量等的积极方面，等等......我试图避免它们用于某些事情和其他我使用它们的事情......**所以对这样的问题的答案会有所不同**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T06:39:51.467

我经常使用会话变量，但不适用于大型对象。会话变量的问题是您可能会在完成工作时忘记清除它们，您可以在代码中的任何地方硬编码它的关键。由于这些原因，我将会话变量封装在我称为会话变量的对象中。并通过它访问它们。当我需要清除它们时，我在我的对象中定义了一个方法来清除会话中的所有变量。

而不是视图状态或查询字符串，它最适合我遇到的大多数情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T04:59:55.560

我尽量避免会话，但不会影响到应用程序。让我们面对现实吧，有些设计通过会话比试图规避它们更好。但总的来说，我不会将它们用于我可以轻松存储在其他地方的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T06:25:49.863

ASP.NET 的会话管理很好，所以不要试图避免使用它来为自己背锅。ASP.NET 的会话[管理功能](http://msdn.microsoft.com/en-us/library/h6bb9cz9(vs.71).aspx)可以很好地扩展以根据您的需要提供许多不同的解决方案。您还应该关注[Microsoft 的 Velocity](http://msdn.microsoft.com/en-us/data/cc655792.aspx)项目。

凯夫

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-20T06:30:33.410

如果必须，请使用它们。在小范围内，它是一种在页面之间传输数据的简单方法，但永远不要将控件粘贴到会话中，尤其是在页面之间，您只会将自己打开到一个受伤的世界。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-20T08:37:29.407

我经常将它们用于小对象，但随着时间的推移，我最终构建了一个位于会话顶部的简单层，它处理诸如清除会话和转换为正确的类型、管理密钥等事情。这也阻止了冲突的发生。

有些东西我不能存储在查询字符串中，有些东西我不想存储在视图状态中。真正剩下的就是会话。

# java - 可以一次将遗留 servlet 移植到框架一个组件吗？

> ID：665032
> 
> 赞同：1
> 
> 时间：2009-03-20T04:53:13.423
> 
> 标签：java, model-view-controller, refactoring, frameworks

我听说您可以并排运行 ASP.NET 应用程序和 ASP.NET mvc 应用程序，这样您就可以一次移植现有代码。我想知道你是否可以使用 java 框架来做到这一点？

我有一个遗留的 servlet 应用程序，我目前正在重构它。我正在考虑逐步将它变成一个jsp应用程序，因为这相对容易实现（可以从servlet调用jsps）。我想知道我是否可以更进一步，而不是移植到 jsps，而是直接移植到一个框架，比如 struts/jsf/tapestry/whatever。这种事情可能吗？我需要确保它一次以并排的一个组件完成。

是否有任何资源可以处理这个特定问题？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T08:50:54.820

这在很大程度上取决于您要使用的特定框架。

从广义上讲，Web 框架往往分为两类：

1.  面向页面：JSP + plain-servlets、JSP + Spring MVC、struts等
2.  面向组件：JSF、tapestry、wicket 等

由于您的旧应用程序是面向页面的，因此将您的应用程序也移植到面向页面的框架是有意义的，从而减少您（和您的团队）需要学习的新概念的数量（并减少您需要的代码量重写）。

在所有可能的选项中，我建议使用：

*   视图层的 JSP - 类似于您现有的使用 servlet 的方法
*   用于非视图层的[Spring MVC - 与 servlet 非常相似，但开箱即用地解决了许多常见问题。](http://static.springframework.org/spring/docs/2.5.x/reference/mvc.html)
*   还可以选择将[Tiles](http://tiles.apache.org/framework/index.html)与这两个框架一起使用（与 JSP 很好地集成）。[这](http://www.springbyexample.org/examples/dynamic-tiles-spring-mvc-module.html)是这种方法的一个小例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T04:58:58.277

我认为这更多的是配置您的 Web 服务器（apache？）以通过巧妙配置的 mod_proxy 设置将不同的地址路由到不同的 servlet 容器的问题。

但是，可能有一种我不知道的更简单的方法。

# sql-server - sqlserver2000 中旧备份的脚本

> ID：665036
> 
> 赞同：0
> 
> 时间：2009-03-20T04:57:40.217
> 
> 标签：sql-server, scripting

任何人都可以向我发送脚本以自动从磁盘中删除超过 2 天的旧备份文件吗？我正在使用 SQL Server 2000。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T09:21:09.910

[如果您创建维护计划](http://msdn.microsoft.com/en-us/library/aa197136(SQL.80).aspx)来执行备份，这将非常容易。

选项之一是“[删除早于](http://msdn.microsoft.com/en-us/library/aa972273.aspx)”的文件。您可以在此处指定删除超过两天的备份。

# css - 用徽标图像替换 H1 文本：SEO 和可访问性的最佳方法？

> ID：665037
> 
> 赞同：259
> 
> 时间：2009-03-20T04:57:45.690
> 
> 标签：css, xhtml, image, seo

似乎有几种不同的技术，所以我希望能得到一个“明确”的答案......

在网站上，通常的做法是创建一个链接到主页的徽标。我想做同样的事情，同时对搜索引擎、屏幕阅读器、IE 6+ 和禁用 CSS 和/或图像的浏览器进行最佳优化。

**示例一：**不使用 h1 标签。对搜索引擎优化没有那么好，对吧？

```
<div id="logo">
    <a href="">
        <img src="logo.png" alt="Stack Overflow" />
    </a>
</div> 
```

**示例二：**在某个地方找到了这个。CSS 似乎有点 hacky。

```
<h1 id="logo">
    <a href="">Stack Overflow</a>
</h1> 
```

```
/* css */
#logo {
    padding: 70px 0 0 0;
    overflow: hidden;
    background-image: url("logo.png");
    background-repeat: no-repeat;
    height: 0px !important;
    height /**/:70px;
} 
```

**示例三：**相同的 HTML，使用文本缩进的不同方法。这是图像替换的“Phark”方法。

```
<h1 id="logo">
    <a href="">Stack Overflow</a>
</h1> 
```

```
/* css */
#logo {
    background: transparent url("logo.png") no-repeat scroll 0% 0%;
    width: 250px;
    height: 70px;
    text-indent: -3333px;
    border: 0;
    margin: 0;
}

#logo a {
    display: block;
    width: 280px; /* larger than actual image? */
    height: 120px;
    text-decoration: none;
    border: 0;
} 
```

**示例四：** [Leahy-Langridge-Jefferies 方法](http://alicious.com/2009/new-css-image-replacement-jir/)。在图像和/或 css 关闭时显示。

```
<h1 id="logo" class="logo">
    <a href="">Stack Overflow</a>
</h1> 
```

```
/* css */
h1.logo {
    margin-top: 15px; /* for this particular site, set this as you like */
    position: relative; /* allows child element to be placed positioned wrt this one */
    overflow:hidden; /* don’t let content leak beyond the header - not needed as height of anchor will cover whole header */
    padding: 0; /* needed to counter the reset/default styles */
}

h1.logo a {
    position: absolute; /* defaults to top:0, left:0 and so these can be left out */
    height: 0; /* hiding text, prevent it peaking out */
    width: 100%; /* 686px; fill the parent element */
    background-position: left top;
    background-repeat: no-repeat;
}

h1#logo {
    height: 60px; /* height of replacement image */
}

h1#logo a {
    padding-top: 60px; /* height of the replacement image */
    background-image: url("logo.png"); /* the replacement image */
} 
```

什么方法最适合这种事情？请在您的答案中提供 html 和 css。

* * *

## 回答 #1

> 赞同：242
> 
> 时间：2009-03-21T19:41:00.957

您缺少以下选项：

```
<h1>
  <a href="http://stackoverflow.com">
    <img src="logo.png" alt="Stack Overflow" />
  </a>
</h1> 
```

href 和 img 到 h1 的标题非常非常重要！

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-03-20T07:07:26.533

我主要像上面那样做，但出于可访问性的原因，我需要支持在浏览器中禁用图像的可能性。因此，我没有将来自页面链接的文本缩进，而是通过将 绝对定位``<span>``到 的全宽和全高来覆盖它，`<a>`并使用`z-index`它以堆叠顺序将其放置在链接文本的上方。

价格是空的`<span>`，但我愿意把它放在那儿，以换取像`<h1>`.

```
<h1 id="logo">
  <a href="">Stack Overflow<span></span></a>
</h1> 
```

```
#logo a {
   position:relative;
   display:block;
   width:[image width];
   height:[image height]; }

#logo a span {
   display:block;
   position:absolute;
   width:100%;
   height:100%;
   background:#ffffff url(image.png) no-repeat left top;
   z-index:100; /* Places <span> on top of <a> text */  } 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-03-21T19:11:20.747

如果可访问性原因很重要，则使用第一个变体（当客户想要查看没有样式的图像时）

```
<div id="logo">
    <a href="">
        <img src="logo.png" alt="Stack Overflow" />
    </a>
</div> 
```

无需符合想象中的 SEO 要求，因为上面的 HTML 代码具有正确的结构，只有您应该决定这是否适合您的访问者。

您也可以使用更少 HTML 代码的变体

```
<h1 id="logo">
  <a href=""><span>Stack Overflow</span></a>
</h1> 
```

```
/* position code, it may be absolute position or normal - depends on other parts of your site */
#logo {
  ...
}

#logo a {
   display:block;
   width: actual_image_width;
   height: actual_image_height;
   background: url(image.png) no-repeat left top;
}

/* for accessibility reasons - without styles variant*/
#logo a span {display: none} 
```

请注意，我删除了所有其他 CSS 样式和 hack，因为它们与任务不对应。它们可能仅在特定情况下有用。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-09-25T05:15:16.560

在这里说话有点晚，但无法抗拒。

你的问题是有缺陷的。让我解释：

你问题的前半部分，关于图像替换，是一个有效的问题，我的观点是，对于一个标志，一个简单的图像；一个 alt 属性；而CSS对其定位来说就足够了。

您问题的后半部分，关于徽标 H1 的“SEO 价值”，是决定将哪些元素用于不同类型的内容的错误方法。

徽标不是主要标题，甚至根本不是标题，并且使用 H1 元素在您网站的每个页面上标记徽标会对您的排名造成（稍微）弊大于利。从语义上讲，标题 (H1 - H6) 仅适用于：内容的标题和副标题。

在 HTML5 中，每页允许有多个标题，但徽标不值得拥有其中一个。您的徽标可能是模糊的绿色小部件，并且出于某种原因，某些文本位于标题一侧的图像中 - 它有点像“印章”，而不是用于构建内容的分层元素。第一个（是否使用更多取决于您的标题层次结构）您网站每个页面的 H1 应该标题其主题。索引页面的主要标题可能是“纽约市模糊绿色小部件的最佳来源”。另一个页面上的主标题可能是“我们的模糊小部件的运输详细信息”。在另一页上，可能是“关于 Bert's Fuzzy Widgets Inc.”。你明白了。

旁注：尽管听起来令人难以置信，但不要查看 Google 拥有的网络资源的来源以获取正确标记的示例。这本身就是一个完整的帖子。

要从 HTML 及其元素中获得最大的“SEO 价值”，请查看[HTML5 规范](https://www.w3.org/TR/html5/)，并在搜索引擎之前根据 (HTML) 语义和对用户的价值做出标记决策，您将获得更好的成功搜索引擎优化。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-21T19:26:23.597

我想你会对[H1 辩论](http://www.h1debate.com/)感兴趣。这是关于是否将 h1 元素用于页面标题或徽标的争论。

就我个人而言，我会接受你的第一个建议，大致如下：

```
<div id="header">
    <a href="http://example.com/"><img src="images/logo.png" id="site-logo" alt="MyCorp" /></a>
</div>

<!-- or alternatively (with css in a stylesheet ofc-->
<div id="header">
    <div id="logo" style="background: url('logo.png'); display: block; 
        float: left; width: 100px; height: 50px;">
        <a href="#" style="display: block; height: 50px; width: 100px;">
            <span style="visibility: hidden;">Homepage</span>
        </a>
    </div>
    <!-- with css in a stylesheet: -->
    <div id="logo"><a href="#"><span>Homepage</span></a></div>
</div>

<div id="body">
    <h1>About Us</h1>
    <p>MyCorp has been dealing in narcotics for over nine-thousand years...</p>
</div> 
```

当然，这取决于您的设计是否使用页面标题，但这是我对这个问题的立场。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-02-10T10:18:23.883

```
<h1>
  <a href="http://stackoverflow.com">
  Stack Overflow<img src="logo.png" alt="Stack Overflow" />
  </a>
</h1> 
```

这是 SEO 的好选择，因为 SEO 给予 H1 标签高优先级，在 h1 标签内应该是您的网站名称。如果您在 SEO 中搜索网站名称，使用此方法也会显示您的网站徽标。

您想隐藏站点名称或文本，请使用负值的文本缩进。前任

```
h1 a {
 text-indent: -99999px;
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-03-04T05:28:19.103

您错过了`<a>`元素中的标题。

```
<h1 id="logo">
  <a href="#" title="..."><span>Stack Overflow</span></a>
</h1> 
```

我建议将标题放在`<a>`元素中，因为客户想知道该图像的含义。因为您已经设置`text-indent`了测试，`<h1>`所以前端用户可以在他们悬停在徽标上时获取主徽标的信息。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-05-02T10:27:23.890

## W3C 是怎么做的？

只需看看[https://www.w3.org/](https://www.w3.org/)。图像有一个`z-index:1`，文字在这里但在后面，因为`z-index:0`耦合到`position: absolute;`

**原始 HTML：**

```
<h1 class="logo">
    <a tabindex="2" accesskey="1" href="/">
        <img src="/2008/site/images/logo-w3c-mobile-lg" width="90" height="53" alt="W3C">
    </a>
    <span class="alt-logo">W3C</span>
</h1> 
```

**原始CSS：**

```
#w3c_mast h1 a {
    display: block;
    float: left;
    background: url(../images/logo-w3c-screen-lg) no-repeat top left;
    width: 100%;
    height: 107px;
    position: relative;
    z-index: 1;
}
.alt-logo {
    display: block;
    position: absolute;
    left: 20px;
    z-index: 0;
    background-color: #fff;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-04-09T07:40:03.407

没有人提到的一点是 h1 属性应该特定于每个页面，并且使用站点徽标将有效地在站点的每个页面上复制 H1。

我喜欢为每个页面使用 az index hidden h1，因为最好的 SEO h1 通常不是最好的销售或审美价值。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-11-29T20:58:24.623

一种新的（Keller）方法应该比 -9999px 方法提高速度：

```
.hide-text {
text-indent: 100%;
white-space: nowrap;
overflow: hidden;
} 
```

在这里推荐：[http ://www.zeldman.com/2012/03/01/replacing-the-9999px-hack-new-image-replacement/](http://www.zeldman.com/2012/03/01/replacing-the-9999px-hack-new-image-replacement/)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2020-06-15T18:21:02.647

通读上述解决方案后，我使用了 CSS Grid 解决方案。

1.  创建一个包含 h1 文本和图像的 div。
2.  将这两个项目放在同一个单元格中，并使它们都相对定位。
3.  使用旧的[zeldman.com 技术](http://www.zeldman.com/2012/03/01/replacing-the-9999px-hack-new-image-replacement/)，使用 text-indent、white-space 和 overflow 属性隐藏文本。

```
<div class="title-stack">
    <h1 class="title-stack__title">StackOverflow</h1>
    <a href="#" class="title-stack__logo">
        <img src="/images/stack-overflow.png" alt="Stack Overflow">
    </a>
</div> 
```

```
.title-stack {
    display: grid;
}
.title-stack__title, .title-stack__logo {
    grid-area: 1/1/1/1;
    position: relative;
}
.title-stack__title {
    z-index: 0;
    text-indent: 100%;
    white-space: nowrap;
    overflow: hidden;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-02-26T13:59:39.440

我不知道，但这是使用的格式...

```
<h1>
    <span id="site-logo" title="xxx" href="#" target="_self">
        <img src="http://www.xxx.com/images/xxx.png" alt="xxx" width="xxx" height="xxx" />
        <a style="display:none">
            <strong>xxx</strong>
        </a>
    </span>
</h1> 
```

很简单，据我所知，它并没有对我的网站造成任何伤害。你可以对它进行css，但我看不到它加载得更快。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-10-22T20:48:34.283

出于 SEO 原因：

```
<div itemscope itemtype="https://schema.org/Organization">
 <p id="logo"><a href="/"><span itemprop="Brand">Your business</span> <span class="icon fa-stg"></span> - <span itemprop="makesOffer">sell staff</span></a></p>
 </div>
   <h1>Your awesome title</h1> 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2010-02-02T12:24:55.160

```
<div class="logo">
    <h1><a href="index.html"><span>Insert Website Name</span></a></h1>
    <p>Insert Slogan Here</p>
</div> 
```

```
#header .logo h1 {
    background: red; /* replace with image of logo */
    display:block;
    height:40px; /* image height */
    width:220px; /* image width */
}

#header .logo h1 a {
    display:block;
    height:40px; /* image height */
    width:220px; /* image width */
}

#header .logo h1 a span {
    display:none;
} 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2013-03-07T01:25:26.740

```
<h1><a href="/" title="Some title">Name</a></h1> 
```

```
h1 a{
  width: {logo width};
  height: {logo height};
  display:block;
  text-indent:-9999px;
  background:url({ logo url});
} 
```

# complexity-theory - 计算复杂度练习

> ID：665049
> 
> 赞同：4
> 
> 时间：2009-03-20T05:05:37.060
> 
> 标签：complexity-theory, big-o

我正在阅读 Aho、Hopcroft 和 Ullman 的“数据结构和算法”，我对练习 1.12 B 感到困惑：

这个 Pascal 过程的计算复杂度（用大 O 表示法表示）是多少？

```
procedure mysterious( n: integer );
    var
        i, j, k: integer;
    begin
        for i := 1 to n - 1 do
             for j := i + 1 to n do
                 for k := 1 to j do
                    {mysterious statement of O(1)}
    end 
```

请你帮助我好吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T05:07:07.697

它是 O(n ³ )。big-O 显示执行时间（或内存或其他）如何与任务的大小成比例（省略比例系数）。

^(在这种情况下，内部语句的执行次数与 (n 3) )成正比。i 从 1 运行到 (n-1) - 因此外循环内的所有内容都执行 (n-1) 次。j 平均从 (n/2) 到 (n) 运行 - 所以里面的所有东西都被执行 (n-1)* (n/2) 次。k 平均从 1 运行到 (3/4* n)。这将获得 (n-1)* (n/2)* (3/4*n-1) 内部语句的执行。这是 O(n ³ )。

# javascript - jQuery selector context

> ID：665057
> 
> 赞同：12
> 
> 时间：2009-03-20T05:09:39.640
> 
> 标签：javascript, jquery

In the following code, what does `, this` mean?

```
var popup = $(popup**, this**).css('opacity', 0);
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2009-03-20T05:12:26.327

The second argument in the selector is a context for search. `$(a,b)` is the same as `$(b).find(a)`.

More information can be found at *[jQuery(), section "jQuery( selector, [ context ] )"](https://api.jquery.com/jquery/#selector-context)*.

# python - Python：defaultdict 在 2.6 中变成了不可编组的对象？

> ID：665061
> 
> 赞同：9
> 
> 时间：2009-03-20T05:12:27.340
> 
> 标签：python

从 Python 2.6 开始，defaultdict 是否变得不可编组？以下在 2.5 下工作，在 2.6 下失败，OS X 1.5.6 上的“ValueError：unmarshallable object”，python-2.6.1-macosx2008-12-06.dmg 来自 python.org：

```
from collections import defaultdict
import marshal
dd = defaultdict(list)
marshal.dump(dd, file('/tmp/junk.bin','wb') ) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-20T07:50:49.457

[Marshal 被故意更改为不支持内置类型的子类](http://svn.python.org/view?view=rev&revision=58893)。Marshal 从来不应该处理 defaultdicts，但碰巧因为它们是 dict 的子类。 [Marshal**不是**一个通用的“持久性”模块；仅支持无、整数、长整数、浮点数、字符串、Unicode 对象、元组、列表、集合、字典和代码对象](http://docs.python.org/library/marshal.html)。

蟒蛇2.5：

```
>>> marshal.dumps(defaultdict(list))
'{0'
>>> marshal.dumps(dict())
'{0' 
```

如果出于某种原因你真的想编组一个 defaultdict ，你可以先将它转换为一个 dict ，但很可能你应该使用不同的序列化机制，比如[pickling](http://docs.python.org/library/pickle.html)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-03T12:01:32.997

wrt 性能问题.. 编码约 600000 个字典的列表，每个字典有 4 个键/值，其中一个值具有 2 个键/值字典的列表（大约 1-3 长度）：

```
In [27]: timeit(cjson.encode, data)
4.93589496613

In [28]: timeit(cPickle.dumps, data, -1)
141.412974119

In [30]: timeit(marshal.dumps, data, marshal.version)
1.13546991348 
```

# java - 在 grails 控制器中识别 ajax 请求或浏览器请求

> ID：665067
> 
> 赞同：17
> 
> 时间：2009-03-20T05:16:52.977
> 
> 标签：java, ajax, grails, gsp

我正在开发一个使用大量 ajax 的 grails 应用程序。如果请求是 ajax 调用，那么它应该给出响应（这部分正在工作），但是如果我在浏览器中输入 URL，它应该带我到主页/索引页面而不是请求的页面。下面是 ajax 调用的示例 gsp 代码。

```
<g:remoteFunction action="list" controller="todo" update="todo-ajax">

<div id ="todo-ajax">
//ajax call rendered in this area
</div> 
```

如果我们在浏览器 URL 栏中输入[http://localhost:8080/Dash/todo/list](http://localhost:8080/Dash/todo/list)，控制器应该重定向到[http://localhost:8080/Dash/auth/index](http://localhost:8080/Dash/auth/index)

如何在控制器中验证这一点。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-03-20T09:22:14.727

在 BootStrap.init 闭包中添加这个动态方法是很常见的做法：

```
 HttpServletRequest.metaClass.isXhr = {->
         'XMLHttpRequest' == delegate.getHeader('X-Requested-With')
    } 
```

这允许您通过执行以下操作来测试当前请求是否是 ajax 调用：

```
if(request.xhr) { ... } 
```

最简单的解决方案是在您的待办事项操作中添加类似这样的内容：

```
if(!request.xhr) { 
    redirect(controller: 'auth', action: 'index')
    return false
} 
```

您还可以使用过滤器/拦截器。我已经构建了一个解决方案，其中我使用自定义注释注释了所有仅 ajax 的操作，然后在过滤器中验证了这一点。

grails-app/conf/BootStrap.groovy 的完整示例：

```
import javax.servlet.http.HttpServletRequest

class BootStrap {

     def init = { servletContext ->

        HttpServletRequest.metaClass.isXhr = {->
            'XMLHttpRequest' == delegate.getHeader('X-Requested-With')
        }

     }
     def destroy = {
     }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-06-05T08:56:08.380

从 Grails 1.1`xhr`开始，向对象添加了一个属性`request`，允许您检测 AJAX 请求。它的用法示例如下：

```
def MyController {

  def myAction() {
    if (request.xhr) {
      // send response to AJAX request  
    } else {
      // send response to non-AJAX request
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-20T05:19:55.870

常规方法是让 ajax 例程向请求添加标头或查询字符串并进行检测。如果您正在使用 ajax 库，它可能已经提供了这个。

看起来您正在使用原型，它将[X-Requested-With 标头设置为 'XMLHttpRequest'](http://www.prototypejs.org/api/ajax/options)；检测到这可能是你最好的选择。

# browser - 如何从浏览器中下载具有非 HTML 内容类型的文件？

> ID：665073
> 
> 赞同：0
> 
> 时间：2009-03-20T05:20:05.763
> 
> 标签：browser, download, mime-types, content-negotiation

我正在尝试使用内容协商来提供 HTTP 服务器上资源的 HTML 和 RDF/XML 表示。在服务器端这有效，即

```
curl -H "Accept: application/rdf+xml" http://localhost:8182/ontologies/1 
```

将检索正确的版本。我也可以用 JavaScript/Dojo 做同样的事情：

```
function downloadOntologyRDF(ontologyId) {
    dojo.xhrGet( {
        url:"${baseUrl}/ontologies/" + ontologyId,
        headers: {"Accept": "application/rdf+xml"},
        timeout: 5000,
        load: function(response, ioArgs) {
            var preNode = document.createElement("pre");
            preNode.appendChild(document.createTextNode(response));
            var foo = new dijit.Dialog({
                title: "RDF",
                content: preNode,
                style: "overflow: auto;"
            });
            foo.show();
            return response;
        },
        error: function(response, ioArgs) {
            alert("Retrieving the RDF version failed: " + response);
            return response;
        }
    });
} 
```

这将在弹出对话框中显示结果。我被卡住的地方是为用户提供了一种下载此版本的方法。我想在页面上有一个链接，可以在浏览器中将 RDF 显示为页面，或者直接打开保存对话框。如果不求助于查询参数或其他技巧，这是否可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T05:27:34.823

这个页面解释了如何设置一个将在浏览器中显示 RDF 的 aspx 页面。它可能会帮助你。虽然我不能确定，因为您已经指定了您在服务器上运行的内容。

[构建 RSS 提要变得简单](http://www.uberasp.net/getarticle.aspx?id=17)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-07T12:27:57.033

就像 cobbal 提到的那样 - 因为您不能在 URL 本身中设置 Accept 标头，所以您应该有额外的内容协商机制。一些框架允许在表单中设置内容类型

```
http://example.com/resource;format 
```

`format`URL 末尾有 ，用分号隔开。然后，在处理请求时，它会解析出格式部分。

在您的情况下，它可能类似于

```
http://localhost:8182/ontologies/1;rdf 
```

到服务器 rdf，并且没有指定格式来提供您接受标头中的任何内容。

# c# - 在 .NET 中解压缩 gzip 存档时出现问题

> ID：665075
> 
> 赞同：0
> 
> 时间：2009-03-20T05:22:24.010
> 
> 标签：c#, .net, compression, gzip

我从 Internet 的某个地方抓取了以下代码，并使用它来解压缩 gzip 文件，例如[http://wwwmaster.postgresql.org/download/mirrors-ftp/pgadmin3/release/v1.8.4/src/pgadmin3- 1.8.4.tar.gz](http://wwwmaster.postgresql.org/download/mirrors-ftp/pgadmin3/release/v1.8.4/src/pgadmin3-1.8.4.tar.gz)，但是当我运行它时，我得到一个异常，指出幻数不匹配。

```
public byte[] Download(string pUrl) {
    WebClient wc = new WebClient();
    byte[] bytes = wc.DownloadData(pUrl);
    return UnGzip(bytes, 0);
}

private static byte[] UnGzip(byte[] data, int start) {
    int size = BitConverter.ToInt32(data, data.Length - 4);
    byte[] uncompressedData = new byte[size];
    MemoryStream memStream = new MemoryStream(data, start, (data.Length - start));
    memStream.Position = 0;
    GZipStream gzStream = new GZipStream(memStream, CompressionMode.Decompress);

    try {
        gzStream.Read(uncompressedData, 0, size);
    } catch (Exception gzError) {
        throw;
    }

    gzStream.Close();
    return uncompressedData;
} 
```

导致此问题的代码有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T06:37:39.820

问题是您在问题中指定的 URL 实际上并没有提供 gzip 文件。它将浏览器带到您选择镜像的页面。

如果您临时更改`Download`使用方法：

```
string text = wc.DownloadString(pUrl);
Console.WriteLine(text); 
```

您将看到所有用于镜像选择的 HTML。

如果您使用的 URL 是*实际*的gz 文件，例如[http://wwwmaster.postgresql.org/redir/170/h/pgadmin3/release/v1.8.4/src/pgadmin3-1.8.4.tar.gz](http://wwwmaster.postgresql.org/redir/170/h/pgadmin3/release/v1.8.4/src/pgadmin3-1.8.4.tar.gz)那么它工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T05:45:45.903

我无法让 GZipStream 读取您链接的文件，但它似乎可以很好地解压缩其他 GZip 文件。例如：

[ftp://gnu.mirror.iweb.com/gnu/bash/bash-1.14.0-1.14.1.diff.gz](ftp://gnu.mirror.iweb.com/gnu/bash/bash-1.14.0-1.14.1.diff.gz)

[ftp://gnu.mirror.iweb.com/gnu/emacs/elisp-manual-21-2.8.tar.gz](ftp://gnu.mirror.iweb.com/gnu/emacs/elisp-manual-21-2.8.tar.gz)

也许您链接的文件已损坏？或者它可能使用非标准或新的 GZip 格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T05:54:26.023

我在.zip 文件中使用[DotNetZip并取得了一些成功。](http://www.codeplex.com/DotNetZip)根据文档，它也适用于 GZip。你可以试试这个人的图书馆。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-20T05:47:52.793

.NET 不支持[tar](http://en.wikipedia.org/wiki/Tar_%28file_format%29)格式。`gzip`只是一个字节压缩器。Tar 是容器格式。

[ZIP](http://en.wikipedia.org/wiki/ZIP_%28file_format%29)和[RAR](http://en.wikipedia.org/wiki/RAR)等格式为您结合了这两个步骤，但它们不适合流式压缩。

如果我没记错的话，[SharpZipLib](http://www.sharpziplib.com/)支持 tar。

# iphone - How to implement water ripples?

> ID：665076
> 
> 赞同：9
> 
> 时间：2009-03-20T05:25:37.433
> 
> 标签：iphone, opengl-es

I'm working on an iphone game. In that i had to produce water ripples. I dont know how to get that. I heard thatit can be done with openGL. I am very new to this concept. Can any one guide me?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-20T05:47:19.580

以下是我找到的一些资源：

[与语言无关的二维水波纹算法](http://freespace.virgin.net/hugo.elias/graphics/x_water.htm)[（来源：][[virgin.net](http://freespace.virgin.net/hugo.elias/graphics/x_water4.gif)][）][（来源：][[virgin.net](http://freespace.virgin.net/hugo.elias/graphics/ripples.gif)][）]
[![替代文字](https://i.stack.imgur.com/XWafS.gif)](https://i.stack.imgur.com/XWafS.gif)
[![替代文字](https://i.stack.imgur.com/Elhbg.gif)](https://i.stack.imgur.com/Elhbg.gif)

[带有水波纹的 OpenGL 项目（来源）](http://www.sulaco.co.za/opengl/water.jpg)[（来源：][[sulaco.co.za](http://www.sulaco.co.za/opengl/water.jpg)][）]
[![替代文字](https://i.stack.imgur.com/Nm1XM.jpg)](https://i.stack.imgur.com/Nm1XM.jpg)

您可能还想查看[GameDev 的常见问题解答](http://www.gamedev.net/community/forums/showfaq.asp?forum_id=12)。向下滚动到“水渲染”部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T05:47:48.627

杰克：

```
z=sin(x)+cos(y) 
```

更严重的是，Quartz Composer 基本上不作为效果层之一为你做涟漪吗？还是仅针对 iPhone 3.0 SDK 发布的？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T06:10:44.067

我找到了水波纹效应的源代码，所以下面的代码可以实现到您的项目中并解决您的问题。

# 导入“HelloWorldLayer.h”

```
// HelloWorldLayer implementation
@implementation HelloWorldLayer

+(CCScene *) scene
{
    // 'scene' is an autorelease object.
    CCScene *scene = [CCScene node];

    // 'layer' is an autorelease object.
    HelloWorldLayer *layer = [HelloWorldLayer node];

    // add layer as a child to scene
    [scene addChild: layer];

    // return the scene
    return scene;
}

// on "init" you need to initialize your instance
-(id) init
{

    if( (self=[super init])) {

        rippleImage = [ pgeRippleSprite ripplespriteWithFile:@"image_old.png" ];
        [ self addChild:rippleImage ];
        CCLabelTTF *label = [CCLabelTTF labelWithString:@"Hello Cocos2D Forum" fontName:@"Marker Felt" fontSize:16];
        label.position = ccp( 80 , 300 );
        [self addChild: label];
        [ [ CCTouchDispatcher sharedDispatcher ] addTargetedDelegate:self priority:0 swallowsTouches:YES ]; 

        // schedule update
        [ self schedule:@selector( update: ) ];    

    }
    return self;
}

float runtime = 0;

-( BOOL )ccTouchBegan:( UITouch* )touch withEvent:( UIEvent* )event {
    runtime = 0.1f;
    [ self ccTouchMoved:touch withEvent:event ];
    return( YES );
}

-( void )ccTouchMoved:(UITouch *)touch withEvent:(UIEvent *)event {
    CGPoint pos;

    if ( runtime >= 0.1f ) {

        runtime -= 0.1f;

        // get touch position and convert to screen coordinates
        pos = [ touch locationInView: [ touch view ] ];
        pos = [ [ CCDirector sharedDirector ] convertToGL:pos ];

        // [ rippleImage addRipple:pos type:RIPPLE_TYPE_RUBBER strength:1.0f ];    
        [ rippleImage addRipple:pos type:RIPPLE_TYPE_WATER strength:2.0f ];  

    }
}

-( void )update:( ccTime )dt {

    runtime += dt;

    [ rippleImage update:dt ];
}

// on "dealloc" you need to release all your retained objects
- (void) dealloc
{
    // in case you have something to dealloc, do it in this method
    // in this particular example nothing needs to be released.
    // cocos2d will automatically release all the children (Label)

    // don't forget to call "super dealloc"
    [super dealloc];
}
@end 
```

[您也可以从 Git 下载源代码](https://github.com/Birkemose/rippleDemo)

# java - 有人可以指出我在 Java 中一个好的 Canny 边缘检测器实现吗？

> ID：665082
> 
> 赞同：1
> 
> 时间：2009-03-20T05:30:50.760
> 
> 标签：java, image-processing

没有这个的 JAI 实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T05:45:09.803

你在找[这个](http://www.tomgibara.com/computer-vision/canny-edge-detector)吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-09T08:49:27.943

一个很好的实现，带有源代码，虽然可能不是很有效，但可以作为[ImageJ](http://rsbweb.nih.gov/ij/) [插件](http://imagejdocu.tudor.lu/doku.php?id=plugin:filter:edge_detection:start)使用。可以在您自己的代码中使用它，而无需 ImageJ UI。

可操纵滤波器的另一种实现也在[这里](http://bigwww.epfl.ch/demo/steerable/download.html)。

# mysql - Make seems to think a prerequisite is an intermediate file, removes it

> ID：665086
> 
> 赞同：3
> 
> 时间：2009-03-20T05:35:00.127
> 
> 标签：mysql, ssl, makefile

For starters, this exercise in GNU make was admittedly just that: an exercise rather than a practicality, since a simple bash script would have sufficed. *However*, it brought up interesting behavior I don't quite understand.

I've written a seemingly simple Makefile to handle generation of SSL key/cert pairs [as necessary for MySQL](http://dev.mysql.com/doc/refman/5.0/en/secure-create-certs.html). My goal was for `make <name>` to result in `<name>-key.pem`, `<name>-cert.pem`, and any other necessary files (specifically, the CA pair if any of it is missing or needs updating, which leads into another interesting follow-up exercise of handling reverse deps to reissue any certs that had been signed by a missing/updated CA cert).

After executing all rules as expected, make seems to be too aggressive at identifying intermediate files for removal; it removes a file I thought would be "safe" since it should have been generated as a prereq to the main rule I'm invoking. (Humbly translated, I likely have misinterpreted make's [documented behavior](http://www.gnu.org/software/autoconf/manual/make/Chained-Rules.html) to suit my expectation, but don't understand how. ;-)

*Edited (thanks, [Chris](https://stackoverflow.com/users/59198/chris)!)* Adding `%-cert.pem` to `.PRECIOUS` does, of course, prevent the deletion. (I had been using the wrong syntax.)

### Makefile:

```
OPENSSL = /usr/bin/openssl

*# Corrected, thanks Chris!
.PHONY: clean*

default: ca

clean:
        rm -I *.pem

%: %-key.pem %-cert.pem
        @# Placeholder (to make this implicit create a rule and not cancel one)

Makefile:
        @# Prevent the catch-all from matching Makefile

ca-cert.pem: ca-key.pem
        $(OPENSSL) req -new -x509 -nodes -days 1000 -key ca-key.pem > $@

%-key.pem:
        $(OPENSSL) genrsa 2048 > $@

%-cert.pem: %-csr.pem ca-cert.pem ca-key.pem
        $(OPENSSL) x509 -req -in $ $@

```

### Output:

```
$ make host1
/usr/bin/openssl genrsa 2048 > ca-key.pem
/usr/bin/openssl req -new -x509 -nodes -days 1000 -key ca-key.pem > ca-cert.pem
/usr/bin/openssl genrsa 2048 > host1-key.pem
/usr/bin/openssl req -new -days 1000 -nodes -key host1-key.pem > host1-csr.pem
/usr/bin/openssl x509 -req -in host1-csr.pem -days 1000 -CA ca-cert.pem -CAkey ca-key.pem -set_serial 01 > host1-cert.pem
rm host1-csr.pem host1-cert.pem  

```

This is driving me crazy, and I'll happily try any suggestions and post results. If I'm just totally noobing out on this one, feel free to jibe away. You can't possibly hurt my feelings. :)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-03-16T23:59:32.520

[http://www.gnu.org/software/automake/manual/make/Chained-Rules.html#Chained-Rules](http://www.gnu.org/software/automake/manual/make/Chained-Rules.html#Chained-Rules)

> 您可以通过将中间文件标记为辅助文件来防止自动删除它。为此，请将其列为特殊目标 .SECONDARY 的先决条件。当一个文件是次要文件时，make 不会仅仅因为它不存在而创建该文件，但 make 不会自动删除该文件。将文件标记为次要文件也将其标记为中间文件。

[http://www.gnu.org/software/automake/manual/make/Special-Targets.html](http://www.gnu.org/software/automake/manual/make/Special-Targets.html)

> .PRECIOUS 所依赖的目标被给予以下特殊处理：如果 make 在执行其命令期间被杀死或中断，则不会删除目标。请参阅中断或终止 make。此外，如果目标是中间文件，则在不再需要后不会像通常那样将其删除。请参阅隐式规则链。在后一方面，它与 .SECONDARY 特殊目标重叠。
> 
> 您还可以将隐式规则的目标模式（例如 `%.o'）列为特殊目标 .PRECIOUS 的先决条件文件，以保留由目标模式与该文件名匹配的规则创建的中间文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T05:59:37.617

我注意到的第一件事是你的台词：

```
.PHONY = clean 
```

应该：

```
.PHONY : clean 
```

见：[http ://www.gnu.org/software/automake/manual/make/Phony-Targets.html](http://www.gnu.org/software/automake/manual/make/Phony-Targets.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-26T03:50:36.747

请注意，类似的模式规则`%: %-key.pem %-cert.pem`是隐式规则，它应用中间清理规则。

对于真正要构建的目标文件，使它们明确，即不要使用模式规则。

在您的情况下，Makefile 应该是：

```
OPENSSL = /usr/bin/openssl
# Replace this to match your host files
HOSTS=$(wildcard host*) 

# Corrected, thanks Chris!
.PHONY: clean

default: ca-cert.pem

clean:
        rm -I *.pem

ca-cert.pem: ca-key.pem
        $(OPENSSL) req -new -x509 -nodes -days 1000 -key ca-key.pem > $@

$(addsuffix -key.pem,$(HOSTS)): %-key.pem : $(HOSTS)
        $(OPENSSL) genrsa 2048 > $@

$(addsuffix -cert.pem,$(HOSTS)): %-cert.pem: %-csr.pem ca-cert.pem ca-key.pem
        $(OPENSSL) x509 -req -in $ $@ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-02-14T14:43:10.367

尝试：

```
.SECONDARY: $(wildcard *-csr.pem) $(wildcard *-cert.pem) 
```

# asp.net - loading multiple files using Silverlight with asp.net

> ID：665089
> 
> 赞同：0
> 
> 时间：2009-03-20T05:36:58.670
> 
> 标签：asp.net, silverlight, silverlight-2.0

I have developed one project by using silverlight 2 with asp.net.

I have one silverlight application and two .aspx pages (one for login.aspx and another for registration). I have designed login.aspx using silverlight 2 and I have attached .xap file to my login.aspx.

For registration.aspx. I need to developed one more silverlight app.

My question is; if I have 10 .aspx pages do I need to developed 10 silverlight applications?

Thanks

Ravi kumar

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T08:54:07.713

如果您担心 URL 会很好地显示给用户，那么我会考虑使用 ASP.NET MVC 或从两个页面加载相同的 xap 并将参数传递给 SL 应用程序以告诉它是否应该显示登录或注册表单。

[请参阅此处](http://msdn.microsoft.com/en-us/library/cc189004(VS.95).aspx)了解如何将自定义参数从 HTML 页面传递到 SL 应用程序：

# python - 如何运行 Jinja2 的所有单元测试？

> ID：665093
> 
> 赞同：1
> 
> 时间：2009-03-20T05:39:41.190
> 
> 标签：python, unit-testing, jinja2

每当我更改某些内容以确保我没有破坏某些内容时，我都想运行 Jinja2 的单元测试。

有[一个装满单元测试的包](http://dev.pocoo.org/projects/jinja/browser/tests)。基本上它是一个充满 Python 文件的文件夹，名称为“test_xxxxxx.py”

如何在一个命令中运行所有这些测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T05:43:48.013

看起来 Jinja 使用了[py.test 测试工具](http://codespeak.net/py/dist/test.html)。如果是这样，您只需从 tests 子目录中运行*py.test即可运行所有测试。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T14:17:34.707

你也可以看看[鼻子](http://somethingaboutorange.com/mrl/projects/nose/)。它应该是 py.test 的演变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-20T20:09:33.783

注意 Jinja2 包中的“test.py”！-- 这些不是单元测试！那是一组用于检查属性等的实用程序函数。我的测试包假设它们是单元测试，因为名称为“test”——并返回奇怪的消息。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-20T08:51:11.823

尝试“遍历”目录并从“test_xxxxxx.py”等文件中导入所有文件，然后调用 unittest.main()

# apache-flex - 调试 FLEX/AS3 内存泄漏

> ID：665094
> 
> 赞同：6
> 
> 时间：2009-03-20T05:41:52.510
> 
> 标签：apache-flex, actionscript-3, debugging, memory-leaks, papervision3d

我有一个相当大的 Flex & Papervision3D 应用程序，它不断地创建和销毁对象。它还加载和卸载 SWF 资源文件。在运行 SWF 时，它会慢慢消耗内存，直到播放器发出 2GB 左右的声音。显然，我很确定我放弃了对我不再想要的实例的引用，并期望 GC 会完成它的工作。但是我花了很长时间弄清楚问题出在哪里。

我已经尝试使用分析器及其选项来捕获内存快照等 - 但我的问题仍然是回避。我认为使用调试 Flash 播放器也存在已知问题？但是我也不喜欢使用发布版本。

您如何使用 FLEX/AS3 跟踪内存泄漏问题？有哪些用于定位消费的策略、技巧或工具

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T07:21:57.030

我通常在我创建的每个类中实现一个清理方法（因为 AS 没有析构函数）。我注意到 GC 的主要问题是事件侦听器。除了直接说的话，还要尽量避免匿名侦听器函数（因为您不能显式删除它们）。以下是一些您可能会觉得有用的链接：

*   [了解 ActionScript 中的内存泄漏](http://dreamingwell.com/articles/archives/2008/05/understanding-m.php)
*   [使用 Flex 和 Adob​​e Air 进行垃圾收集](http://spreadingfunkyness.com/garbage-collection-with-flex-and-adobe-air/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T13:31:42.960

我偶然发现了一些解释如何在 Flex Builder 中使用 Flex Profiler 的东西，这对我调试内存泄漏有很大帮助。我肯定会建议尝试一下。它非常易于使用。我在分析我的应用程序时发现的一些事情：

避免使用集合（至少 LARGE 集合）作为值对象的属性。我的 Cairngorm 应用程序中有几种类型的值对象类，每个都有一个“子”属性，它是一个`ArrayCollection`，用于过滤。分析时，我发现这些是我最大的内存消耗者之一，所以我更改了我的应用程序，改为将“parentId”存储为 an`int`并使用它进行过滤。使用的内存被大幅削减。像这样的东西：

老办法：

```
public class Owner1
{
    public var id:int;
    public var label:String;
    public var children:ArrayCollection; // Stores any number of Owner2 Objects
}

public class Owner2
{
    public var id:int;
    public var label:String;
    public var children:ArrayCollection; // Stores any number of Owner3 Objects
}

public class Owner3
{
    public var id:int;
    public var label:String;
} 
```

新方法：

```
public class Owner1
{
    public var id:int;
    public var label:String;
}

public class Owner2
{
    public var id:int;
    public var label:String;
    public var parentId:int; // Refers to id of Owner1 Object
}

public class Owner3
{
    public var id:int;
    public var label:String;
    public var parentId:int; // Refers to id of Owner2 Object
} 
```

我还建议在不再需要事件侦听器时删除它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-03-18T19:28:24.437

由于这样的问题，我开发了一个开源库，可以帮助监控您在任何给定时间运行的所有事件。它真的很容易实现，我在 10-15 分钟内重构了项目，将它们转换为使用我开发的 EventController。

基本上，对于您的场景，我将遍历所有事件并将它们替换为： obj.addEventListener(...);

到：EC.add(obj,...);

剩下的就是注册事件并使用 EC.log() 在您想要的任何时候疯狂地轻松查看所有事件；

所有详细信息和文档都在我的网站上，我很想知道这是否对您有帮助，以及您是否开始使用它。如果您有任何好的或不好的反馈，请随时发布，我会调查的！

该网站是： http: [//fla.as/ec/](http://fla.as/ec/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-20T06:18:51.207

如果您的内存泄漏呈指数增长，则可能意味着 GC 未能完成其工作。看看你的代码，看看哪里可以减少对象的引用计数（通过将它们设置为`null`）。使事件处理程序变弱。并重新配置文件。

# c# - ADO.NET 实体框架：QUERY nn 关系

> ID：665106
> 
> 赞同：0
> 
> 时间：2009-03-20T05:48:00.983
> 
> 标签：c#, entity-framework, ado.net

我有四张桌子：

*   具有 PK **ClientID**的客户端。
*   带有 PK **DestinationID**的目的地。
*   带有 PK **LanguageID**的语言。
*   DestinationDetail 与 PK **DestinationID**。
*   **带有 PK 的ClientID**和**DestinationID**的 RL-Client- Destination 。

客户端可能有零个或 n 个目的地。一个目的地有 n 个 DestinationDetails，每个 DestinationDetail 都有一种语言。

行。我需要检索给定客户端和给定语言的所有 DestinationDetails。

我写了这个（我不知道它是否有效），但也许有更好的方法：

```
 ObjectQuery clientQuery =
       guiaContext.Client.Where("it.email = @email",
           new ObjectParameter("email", "xxx@example.com"));

    Client client = clientQuery.First();

    client.Destination.Load();
    EntityCollection destinations = client.Destination;

    ObjectQuery languageQuery =
       guiaContext.Language.Where("it.ds_language = @languageDS",
         new ObjectParameter("languageDS", "en-US"));
    Language language = languageQuery.First();

    foreach (Destination dest in destinations)
    {
        dest.DestinationDetail.Load();
        EntityCollection details = dest.DestinationDetail;
        foreach (DestinationDetail detail in details)
        {
           detail.Language = language;
           Console.WriteLine("Destination: " + detail.ds_destinationName);
        }
     } 

```

我正在学习 ADO.NET 实体框架。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-21T18:41:45.950

这是答案：

```
 var db = new PracticeEntities();
var destinations = db.DestinationDetails.
          Where(dd => dd.Language.Lang == "en-US" &&
          dd.Destination.Client.Any(c => c.Email == "abc@yahoo.com")); 

```

谢谢！

# iphone - NSNumberFormatter 格式化美国电话号码

> ID：665111
> 
> 赞同：8
> 
> 时间：2009-03-20T05:49:59.263
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我正在尝试将用户输入的一串数字转换为 iPhone 上的 Phone.app 之类的性感字符串。这是我正在使用的代码，它不起作用（没有特殊格式出现）并且在一定数量的数字之后它只是开始在字符串的末尾添加“0”。

```
NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
[formatter setNumberStyle:NSNumberFormatterNoStyle];
[formatter setPositiveFormat:@"+# (###) ###-###"];
[formatter setLenient:YES];
NSString *strDigits = [self stringByReplacingOccurrencesOfRegex:@"[^0-9+]" withString:@""];
return [formatter stringFromNumber:[NSNumber numberWithDouble:[strDigits doubleValue]]]; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-04T20:39:36.787

我认为您的问题是`NSNumberFormatter`不支持括号、空格或破折号。我尝试实现与您相同的方法，但它默默地失败了，只是输出了未格式化的文本。

这里的一般问题是 iPhone SDK 没有提供一种方法来以依赖于区域设置的方式格式化电话号码。

我已经向 Apple 提出了以下错误（其中两个是已知问题的重复，因此我已将 Apple 的原始错误 # 包括在内）：

```
#6933244 - Need iPhone SDK interface to format text as locale dependent phone number
#5847381 - UIControl does not support a setFormatter method
#6024985 - Overridden UITextField drawTextInRect method is never called 
```

在一个理想的世界里，Apple 会提供一个`NSPhoneNumberFormatter`，你会调用`setFormatter`你的`UIControl`，所以它会`text`以一种漂亮的方式显示出来。不幸的是，这在 iPhone 上不存在。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-01-22T15:34:30.760

UIPhoneFormats.plist 包含每个语言环境的预定义电话格式。因此，如果您只对美国电话号码感兴趣，则需要考虑以下格式：

> +1 (###) ###-####
> 1 (###) ###-####
> 011 $
> ###-####
> (###) ###-## ##

我不得不做类似的事情，我分享了我在这里得到的结果：http: [//the-lost-beauty.blogspot.com/2010/01/locale-sensitive-phone-number.html](http://the-lost-beauty.blogspot.com/2010/01/locale-sensitive-phone-number.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T05:54:24.383

一个电话号码应该是 10 个字符（11 个以 1 开头），所以你应该从改变这个开始：

```
[formatter setPositiveFormat:@"+# (###) ###-####"]; 
```

说到前导 1，你也需要检查一下。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-12T09:48:26.973

Apple 表示，如果现有格式化程序的功能不够，您可以实现自定义格式化程序：

> NSFormatter 用于子类化。自定义格式化程序可以以新颖的方式限制输入并增强数据的显示。例如，您可以有一个自定义格式化程序，以确保用户输入的序列号符合预定义的格式。在您决定创建自定义格式化程序之前，请确保您无法配置公共子类 NSDateFormatter 和 NSNumberFormatter 以满足您的要求。
> 
> 有关如何创建自己的自定义格式化程序的说明，请参阅创建自定义格式化程序。

请参阅[数据格式指南中的部分](https://developer.apple.com/documentation/Cocoa/Conceptual/DataFormatting/Articles/CreatingACustomFormatter.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-14T00:26:04.300

这里从未提到的一件事是 NSNumberFormatter 将始终将值转换为 NSNumber。如果您想要更通用的 NSFormatter，请将 NSFormatter 子类化并实现创建自定义格式化程序中提到的方法。

# c++ - cout 的缓冲区是如何工作的？

> ID：665112
> 
> 赞同：0
> 
> 时间：2009-03-20T05:51:09.337
> 
> 标签：c++, buffer, cout

我知道cout几天前有缓冲区，当我google它时，据说缓冲区有点像堆栈，从右到左获取cout和printf的输出，然后将它们输出（到控制台或文件) 从上到下。像这样，

```
a = 1; b = 2; c = 3;
cout<<a<<b<<c<<endl;
buffer：|3|2|1|<-   (take “&lt;-” as a poniter)

output：|3|2|<-     (output 1)
        |3|<-       (output 2)
        |<-         (output 3) 
```

然后我在下面写一个代码，

```
#include <iostream> 
using namespace std; 
int c = 6;
int f() 
{   
    c+=1; 
    return c; 
} 

int main() 
{ 
     int i = 0; 
     cout <<"i="<<i<<" i++="<<i++<<" i--="<<i--<<endl; 
     i = 0;
     printf("i=%d i++=%d i--=%d\n" , i , i++ ,i-- );

     cout<<f()<<" "<<f()<<" "<<f()<<endl; 
     c = 6;
     printf("%d %d %d\n" , f() , f() ,f() );
     system("pause");
     return 0; 
} 
```

VS2005下，输出为

```
i=0 i++=-1 i--=0
i=0 i++=-1 i--=0
9 8 7
9 8 7 
```

看来stack的方式是对的~ 不过昨天看了C++ Primer Plus，据说cout是从左到右的，每次都返回一个object(cout)，所以“这就是让你拼接输出的特性通过使用插入”。但是从左到右的方式不能解释 cout<

然后[Alnitak](https://stackoverflow.com/users/6782/alnitak)告诉我，“<< 运算符实际上是 ostream& operator<<(ostream& os, int)，所以另一种写法是： operator<< ( operator<< ( operator<< ( cout, a ), b ）， C ）”，

如果最正确的论点首先被评估，它可以得到一些解释。

现在我对 cout 的缓冲区如何工作感到困惑，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-20T06:10:21.413

你混合了很多东西。迄今为止：

*   实施细则`cout`
*   链式调用
*   调用约定

尝试分别阅读它们。并且不要一口气考虑所有这些。

> printf("i=%d i++=%d i--=%d\n" , i , i++ ,i-- );

上面的行调用了未定义的行为。阅读常见问题解答[3.2](http://c-faq.com/expr/evalorder2.html)。请注意，您观察到的是函数调用约定的副作用以及特定实现（即您的实现）在堆栈中传递参数的方式。如果您在其他机器上工作，则不能保证相同。

我认为您将函数调用的顺序与缓冲混淆了。当您有一个`cout`语句后跟多个插入`<<`时，您实际上是在调用多个函数调用，一个接一个。所以，如果你要写：

```
cout << 42 << 0; 
```

这真的意味着：你打电话，

```
cout = operator<<(cout, 42) 
```

然后在对同一运算符的另一个调用中使用 return：

```
cout = operator<<(cout, 0) 
```

您通过上面测试的内容不会告诉您任何`cout`内部表示。我建议您查看头文件以了解更多信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-20T06:33:54.557

就像一般提示一样，永远不要在同一行中使用 i++ 作为 i 或 i-- 的另一个用法。

问题是函数参数可以按任何顺序计算，所以如果你的函数参数有任何副作用（例如递增和递减操作），你不能保证它们会按照你期望的顺序运行。这是要避免的。

这种情况也是如此，这类似于您的 cout 使用的实际扩展：

函数1（函数2（foo），bar）；

编译器可以在调用 function2 之前自由评估 bar，反之亦然。例如，您可以保证 function2 将在 function1 被调用之前返回，但不能保证它们的参数按特定顺序进行评估。

当您执行以下操作时，这会成为一个问题：

函数1（函数2（i++），i）；

您无法指定是否在“i++”之前或之后评估“i”，因此您可能会得到与预期不同的结果，或者不同编译器甚至相同编译器的不同版本的不同结果.

底线，避免有副作用的陈述。仅当它们是该行中唯一的语句或者您知道您只修改同一个变量一次时才使用它们。（“行”表示单个语句加上分号。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T06:20:19.813

您看到的是未定义的行为。

局部`i`和全局`c`在没有序列点的情况下多次加/减。这意味着您获得的价值可以是任何东西。取决于编译器，可能还取决于处理器架构和内核数量。

`cout`缓冲区可以被认为是队列，所以 Alnitak 是对的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T07:32:57.033

除了正确指出您看到未定义行为的其他答案之外，我想我会提到`std::cout`使用类型对象`std::streambuf`进行其内部缓冲。基本上它是一个代表缓冲区的抽象类（大小特定于实现，对于非缓冲流缓冲区甚至可以为 0）。一个 for`std::cout`是这样写的，当它“溢出”时，它会被刷新到标准输出中。

事实上，您可以更改`std::streambuf`关联的`std::cout`（或任何相关的流）。如果你想做一些聪明的事情，比如让所有`std::cout`调用都以日志文件结尾或其他东西，这通常很有用。

正如[您所说](https://stackoverflow.com/questions/665112/how-the-buffer-of-cout-work/665147#665147)的那样，您将调用约定与其他细节混淆了，它们与 std::cout 的缓冲完全无关。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-22T17:12:22.397

此外，混合输出范例（printf 和 cout）是特定于实现的。

# php - 错误查询 - INNER JOIN

> ID：665115
> 
> 赞同：0
> 
> 时间：2009-03-20T05:53:01.113
> 
> 标签：php, mysql

当我从 SQL 查询中打印出我的数据时，我收到一堆未定义的索引警告，当我删除 INNER JOINS 时，大多数警告都会消失。我不确定是什么导致了该错误。

我的代码在这里：

```
<?php
    $id      = $_GET['id'];
    $sql     = "SELECT * FROM updates INNER JOIN clients ON updates.c_id = clients.c_id INNER JOIN pages ON updates.page = pages.p_id INNER JOIN projects ON updates.p_id = projects.p_id WHERE u_id='$id' LIMIT 1";
    echo $sql;
    $result  = mysql_query($sql) or die(mysql_error());
    $row     = mysql_fetch_assoc($result);

    // put update_id in hidden form and pass it to the next page
    $u_id = $row['u_id'];
?>
<h4>Viewing update for <i><? echo $row['fname'] ." ". $row['lname']  ?></i> for their <i><a href="<? echo $row['p_url']; ?>" title="View <? echo $row['p_title']; ?>"><? echo $row['p_title']; ?></a> project</i></h4>
<h4><b>Posted on: </b> <? echo $row['date_submitted'] = date("F j, Y, g:i a"); ?></h4> 
```

知道我能做什么吗？我有 CLIENTS 的 INNER JOIN 的原因是因为“fname”和“lname”存储在那里

```
clients.c_id = updates.c_id 
```

我有：“p_url”“p_title”这些存储在表项目中，这也是：

```
clients.c_id = projects.c_id 
```

* * *

### 编辑新问题

我的代码在这里：

```
$sql     = "SELECT 
    updates.u_id AS u_id,
    updates.date_submitted AS date_submitted,
    updates.deadline AS deadline,
    updates.description AS description,
    updates.priority AS priority,
    pages.page_name AS page_name,
    clients.fname AS fname,
    clients.lname AS lname,
    projects.p_url AS p_url,
    projects.p_title AS p_title,
    FROM updates INNER JOIN clients ON updates.c_id = clients.c_id INNER JOIN pages ON updates.page = pages.p_id INNER JOIN projects ON updates.p_id = projects.p_id WHERE u_id='$id' LIMIT 1"; 
```

错误是：

> 不是唯一的表/别名：“客户”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T06:00:25.180

编辑答案：

啊，我错误地认为它与 SQL 索引有关。看起来它实际上是一个 PHP 错误，与您试图打印出不存在的数组元素有关。

对于所有包含`$row`(`$row['deadline']`等) 元素的打印，您需要确保查询返回的实际列名。如果没有名为“deadline”的列，则尝试打印它会生成警告。

* * *

**再次编辑**：因为这被撞了，我想我会更详细一点。

首先，正如 bobince 指出的那样，您可以进行 SQL 注入。第一行应该是：

```
$id      = intval($_GET['id']); 
```

如果 $id 将始终是一个整数，`mysql_real_escape_string()`如果它可以是一个字符串。

其次，`SELECT *`通常是不好的形式，尤其是在有连接的情况下。我不确切知道特定字段来自哪些表，但您的查询应该看起来更像这样，您只选择您实际要使用的字段：

```
$sql = "SELECT clients.fname, clients.lname, projects.p_url, projects.p_title, updates.date_submitted ".
        "FROM updates ".
            "INNER JOIN clients ON updates.c_id = clients.c_id ".
            "INNER JOIN pages ON updates.page = pages.p_id ".
            "INNER JOIN projects ON updates.p_id = projects.p_id ".
        "WHERE updates.u_id='$id' ".
        "LIMIT 1"; 
```

接下来，`$u_id`设置为与已有的完全相同的值`$id`，因此它是一种毫无意义的变量。

最后，在最后一行，您有：

```
<? echo $row['date_submitted'] = date("F j, Y, g:i a"); ?> 
```

我不确定你期望它做什么，但它会分配`date("F j, Y, g:i a");`给`$row['date_submitted']`然后最终打印出“true”或“1”或其他东西，这可能不是你想要的。

* * *

**最新问题：**你们都试图从客户中选择，并加入客户，你不能同时做这两个，至少不给其中一个别名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T06:06:42.937

我认为这与 SQL 没有任何关系（但我可能是错的）。你可以先看看[这个](http://forums.mysql.com/read.php?52,126269,126415#msg-126415)线程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T11:21:24.927

> SELECT * FROM 更新 INNER JOIN 客户端

当您“选择 *”时，您会从两个表中获取每一列。因为列可以具有相同的名称，所以由 '*' 自动生成的列名以表名作为前缀。因此，您的关联数组将包含以下索引：

```
updates.u_id
clients.c_id
... 
```

因此，当您尝试使用不带前缀的列名（例如“page_name”）访问数组时，它会失败，因为该索引不存在。

您可以使用完整的列名（'pages.page_name'），也可以通过以下方式明确给出自己的列名：

```
SELECT updates.u_id AS u_id, pages.page_name AS page_name, ...
FROM updates JOIN client ... 
```

> u_id='$id'

糟糕，SQL 注入漏洞。恭喜，您是本周第 1000 位[强制性 xkcd 链接](http://xkcd.com/327/)的获胜者。

mysql_real_escape_string() 是你的朋友。（更好的是：mysqli 参数化查询。）

> <? 回声 $row['deadline']; ?>

糟糕，HTML 注入孔。htmlspecialchars() 是你的朋友。

# php - OpenID——获取用户信息？

> ID：665122
> 
> 赞同：3
> 
> 时间：2009-03-20T05:54:52.947
> 
> 标签：php, openid

我想知道除了来自 Google 的电子邮件之外，是否可以请求更多信息并获取用户名？

我正在使用 JanRain OpenID PHP 脚本。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T06:22:25.097

搜索**OpenID 属性交换**——这就是你想要的。

*   [基本概述](http://blogs.gnome.org/jamesh/2007/11/26/openid-ax/)
*   [正式规范](http://openid.net/specs/openid-attribute-exchange-1_0.html)

我们已经有一段时间没有看它了（6 个月？），但是当我们看的时候它相当粗糙。希望从那时起情况有所改善。

更多资源：

[http://www.google.com/search?q=openid+attribute+exchange](http://www.google.com/search?q=openid+attribute+exchange)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-20T14:11:39.727

不，这是不可能的。Google 只发布用户的电子邮件地址。他们的服务器设置为永远不会提供更多信息：

请参阅他们的 OpenID 页面以供开发人员了解更多信息： [http ://code.google.com/apis/accounts/docs/OpenID.html](http://code.google.com/apis/accounts/docs/OpenID.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-15T06:45:05.307

我通常只有在真正被击败时才阅读手册。3 天来，我尝试了不同的方法从这两个巨大的 OpenID 提供商那里获取用户属性，但只设法从 Google 获取“电子邮件”属性，而从 Yahoo 完全没有。然后我不得不阅读可怕的手册，甚至是那些模糊的 OpenID 规范。

那么为什么要实施一个标准而不是完全支持它呢？如果在信息交换方面大方不与小方合作，为什么要假装 OpenID 有任何生存能力。

我想基本的注册和登录过程毕竟是赢家……谁真的需要了解 XRI 和 URL？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-17T17:06:46.777

无论如何，您不应该依赖任何用户信息。查看它是否是 OP 回复的一部分，如果不是，请向用户提供一个表格，让他可以填写必填字段。

# c# - 在 SQL LIKE 子句中使用 SqlParameter 不起作用

> ID：665129
> 
> 赞同：86
> 
> 时间：2009-03-20T05:58:30.490
> 
> 标签：c#, sql-server, tsql, ado.net, sql-like

我有以下代码：

```
const string Sql = 
    @"select distinct [name] 
      from tblCustomers 
      left outer join tblCustomerInfo on tblCustomers.Id = tblCustomerInfo.CustomerId  
      where (tblCustomer.Name LIKE '%@SEARCH%' OR tblCustomerInfo.Info LIKE '%@SEARCH%');";

using (var command = new SqlCommand(Sql, Connection))
{       
    command.Parameters.AddWithValue("@SEARCH", searchString);
    ...
} 
```

这不起作用，我也试过这个：

```
const string Sql = 
    @"select distinct [name] 
     from tblCustomers 
     left outer join tblCustomerInfo on tblCustomers.Id = tblCustomerInfo.CustomerId  
     where (tblCustomer.Name LIKE @SEARCH OR tblCustomerInfo.Info LIKE @SEARCH );";

using (var command = new SqlCommand(Sql, Connection))
{       
    command.Parameters.AddWithValue("@SEARCH", "'%" + searchString + "%'");
    ...
} 
```

但这也不起作用。出了什么问题？有什么建议么？

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2009-03-20T06:02:02.290

你想要的是：

```
tblCustomerInfo.Info LIKE '%' + @SEARCH + '%' 
```

（或编辑参数值以首先包含 %）。

否则，您要么（第一个示例）搜索*文字*“@SEARCH”（而不是 arg 值），要么将一些额外的引号嵌入到查询中（第二个示例）。

`LIKE @SEARCH`在某些方面，让 TSQL 只使用并在调用者处处理它可能更容易：

```
command.Parameters.AddWithValue("@SEARCH","%" + searchString + "%"); 
```

任何一种方法都应该有效。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-09-10T07:42:01.350

而不是使用：

```
const string Sql = 
@"select distinct [name] 
  from tblCustomers 
  left outer join tblCustomerInfo on tblCustomers.Id = tblCustomerInfo.CustomerId  
  where (tblCustomer.Name LIKE '%@SEARCH%' OR tblCustomerInfo.Info LIKE '%@SEARCH%');"; 
```

使用此代码：

```
const string Sql = 
@"select distinct [name] 
  from tblCustomers 
  left outer join tblCustomerInfo on tblCustomers.Id = tblCustomerInfo.CustomerId  
  where (tblCustomer.Name LIKE '%' + @SEARCH + '%' OR tblCustomerInfo.Info LIKE '%' + @SEARCH + '%');"; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2019-01-31T13:00:45.087

**请注意Add**和**AddWithValue**方法之间的细微差别。当我使用*Add*方法并输入错误的**SqlType**参数时，我遇到了以下问题。

*   **`nchar`**并且**`nvarchar`**可以存储**Unicode**字符。
*   **`char`**并且**不能存储 Unicode**字符。**`varchar`**

 **例如：

```
string query = " ... WHERE stLogin LIKE @LOGIN ";

SqlParameter p = new SqlParameter("@LOGIN", SqlDbType.Char, 255) 
{ 
    Value = "%" + login + "%" 
};

command.Parameters.AddWithValue(p.ParameterName, p.Value); //works fine!!!

command.Parameters.Add(p); // won't work 
```

当我将*SqlType*更改为**NVarChar**时，这两种方法对我来说都很好。

```
SqlParameter p = new SqlParameter("@LOGIN", SqlDbType.NVarChar, 255) 
{ 
    Value = "%" + login + "%" 
};

command.Parameters.AddWithValue(p.ParameterName, p.Value); //worked fine!!!

command.Parameters.Add(p); //worked fine!!! 
```

* * *

## 回答 #4

> 赞同：-7
> 
> 时间：2009-03-20T06:18:01.800

你可以`LIKE @SEARCH`在你的 C# 代码中做

```
searchString = "%" + searchString + "%" 
```

# php - 通过表单发送 AJAX 数据的最佳实践 - 取回值

> ID：665130
> 
> 赞同：1
> 
> 时间：2009-03-20T05:58:35.747
> 
> 标签：php, jquery, mysql, ajax

我有一个小表格，我希望在更改选择框时更新值，这可以通过以下方式完成：

```
$("form#updateclient select").change(function(){ // use one selector for all 3 selects
    $.post("inc/process-update.php",{
        // data to send
        completed: $("select#completed").val(),
        hours:     $("select#hours").val(),
        update_id: $("#u_id").val(),
        who:       $("select#who").val()
    }, function(data) {
        // do callback stuff with the server response 'data' here
    });
}); 
```

但是我有一个输入文本字段，用户可以在其中输入小时数，当他们点击开箱时，然后将该 AJAX 请求发送到 PHP 页面。

#completed 字段现在是一个复选框，它是否与输入一样传递？这将如何与 jQuery 一起使用，所以如果您选中或取消选中发送该信息并更新数据库

我现在一直在尝试研究的是从服务器检索这些值并使用 AJAX 在页面上更新它们的最佳方法是什么。因此，一旦我更新我的下拉列表，它将保持相同的结果。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T11:08:14.410

> #completed 字段现在是一个复选框，它是否与输入一样传递？

不。复选框的 .value（由 jQuery 的 val() 方法使用）始终是 value="..." 属性中的字符串（如果省略，则默认为“on”），无论它是否被勾选。要获得复选框的有效值，您需要查看“.checked”属性。例如。

```
var v= element.checked? element.value : ''; 
```

此外，您不能使用 onchange 处理程序来检测复选框何时更改，因为 IE 不会触发该事件。相反，您必须对该元素使用 onclick。

# php - 在 PHP 中使用 foreach 循环时查找数组的最后一个元素

> ID：665135
> 
> 赞同：241
> 
> 时间：2009-03-20T06:01:27.550
> 
> 标签：php, foreach

我正在使用一些参数编写 SQL 查询创建器。在 Java 中，只需检查当前数组位置和数组长度，就可以很容易地从 for 循环中检测数组的最后一个元素。

```
for(int i=0; i< arr.length;i++){
     boolean isLastElem = i== (arr.length -1) ? true : false;        
} 
```

在 PHP 中，它们具有访问数组的非整数索引。因此，您必须使用 foreach 循环遍历数组。当您需要做出一些决定（在我的情况下，在构建查询时附加或/和参数）时，这会成为问题。

我确信必须有一些标准的方法来做到这一点。

你如何在 PHP 中解决这个问题？

* * *

## 回答 #1

> 赞同：348
> 
> 时间：2009-03-20T06:05:36.153

听起来你想要这样的东西：

```
$numItems = count($arr);
$i = 0;
foreach($arr as $key=>$value) {
  if(++$i === $numItems) {
    echo "last index!";
  }
} 
```

话虽如此，您不必 - 必须 -`foreach`在 php 中使用“数组”进行迭代。

* * *

## 回答 #2

> 赞同：215
> 
> 时间：2009-03-20T06:07:08.613

您可以使用获取数组最后一个键的值`end(array_keys($array))`并将其与当前键进行比较：

```
$last_key = end(array_keys($array));
foreach ($array as $key => $value) {
    if ($key == $last_key) {
        // last element
    } else {
        // not last element
    }
} 
```

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2009-12-14T14:52:04.310

> **注意**：这不起作用，因为调用 next() 会推进数组指针，因此您将跳过循环中的所有其他元素

* * *

为什么这么复杂？

```
foreach($input as $key => $value) {
    $ret .= "$value";
    if (next($input)==true) $ret .= ",";
} 
```

这将在除最后一个值之外的每个值后面添加一个 , ！

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2009-03-20T09:02:01.237

当 toEnd 达到 0 时，意味着它处于循环的最后一次迭代。

```
$toEnd = count($arr);
foreach($arr as $key=>$value) {
  if (0 === --$toEnd) {
    echo "last index! $value";
  }
} 
```

最后一个值在循环之后仍然可用，所以如果你只是想在循环之后将它用于更多的东西，这会更好：

```
foreach($arr as $key=>$value) {
  //something
}
echo "last index! $key => $value"; 
```

如果您不想将最后一个值视为特殊的内部循环。如果您有大型阵列，这应该会更快。（如果在同一范围内的循环之后重用数组，则必须先“复制”数组）。

```
//If you use this in a large global code without namespaces or functions then you can copy the array like this:
//$array = $originalArrayName; //uncomment to copy an array you may use after this loop

//end($array); $lastKey = key($array); //uncomment if you use the keys
$lastValue = array_pop($array);

//do something special with the last value here before you process all the others?
echo "Last is $lastValue", "\n";

foreach ($array as $key => $value) {
    //do something with all values before the last value
    echo "All except last value: $value", "\n";
}

//do something special with the last value here after you process all the others?
echo "Last is $lastValue", "\n"; 
```

并回答您的原始问题“在我的情况下，在构建查询时附加或/和参数”；这将遍历所有值，然后将它们连接到一个字符串中，它们之间有“和”，但不是在第一个值之前或最后一个值之后：

```
$params = [];
foreach ($array as $value) {
    $params[] = doSomething($value);
}
$parameters = implode(" and ", $params); 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2011-10-11T01:25:05.513

已经有很多答案了，但也值得研究一下迭代器，尤其是当它被要求提供一种标准方式时：

```
$arr = range(1, 3);

$it = new CachingIterator(new ArrayIterator($arr));
foreach($it as $key => $value)
{
  if (!$it->hasNext()) echo 'Last:';
  echo $value, "\n";
} 
```

您可能会发现某些东西在其他情况下也更灵活。

* * *

## 回答 #6

> 赞同：21
> 
> 时间：2017-10-18T16:37:42.283

一种方法是检测迭代器是否具有`next`. 如果没有 next 附加到迭代器，则意味着您处于最后一个循环中。

```
foreach ($some_array as $element) {
    if(!next($some_array)) {
         // This is the last $element
    }
} 
```

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2019-07-22T06:37:35.793

从 foreach 数组中获取第一个和最后一个元素

```
foreach($array as $value) {
    if ($value === reset($array)) {
        echo 'FIRST ELEMENT!';
    }

    if ($value === end($array)) {
        echo 'LAST ITEM!';
    }
} 
```

* * *

## 回答 #8

> 赞同：11
> 
> 时间：2020-10-11T17:27:31.710

**自 PHP 7.3 起：**

您可以使用获取数组最后一个键的值`array_key_last($array)`并将其与当前键进行比较：

```
$last_key = array_key_last($array);
foreach ($array as $key => $value) {
    if ($key == $last_key) {
        // last element
    } else {
        // not last element
    }
} 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2012-04-21T07:11:59.833

因此，如果您的数组具有唯一的数组值，那么确定最后一次迭代是微不足道的：

```
foreach($array as $element) {
    if ($element === end($array))
        echo 'LAST ELEMENT!';
} 
```

如您所见，如果最后一个元素在数组中仅出现一次，则此方法有效，否则您会收到误报。如果不是，您必须比较密钥（肯定是唯一的）。

```
foreach($array as $key => $element) {
    end($array);
    if ($key === key($array))
        echo 'LAST ELEMENT!';
} 
```

还要注意严格的比较运算符，这在这种情况下非常重要。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-03-20T06:54:57.717

您仍然可以将该方法与关联数组一起使用：

```
$keys = array_keys($array);
for ($i = 0, $l = count($array); $i < $l; ++$i) {
    $key = $array[$i];
    $value = $array[$key];
    $isLastItem = ($i == ($l - 1));
    // do stuff
}

// or this way...

$i = 0;
$l = count($array);
foreach ($array as $key => $value) {
    $isLastItem = ($i == ($l - 1));
    // do stuff
    ++$i;
} 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2012-10-09T11:38:27.550

假设您将数组存储在变量中...

```
foreach($array as $key=>$value) 
{ 
    echo $value;
    if($key != count($array)-1) { echo ", "; }
} 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2010-03-18T16:25:31.830

如果您需要对除第一个或最后一个元素之外的每个元素执行某些操作，并且仅当数组中有多个元素时，我更喜欢以下解决方案。

我知道上面有很多解决方案，并且比我早几个月/一年发布，但我觉得这本身就相当优雅。检查每个循环也是一个布尔检查，而不是数字“i =（count-1）”检查，这可能会减少开销。

循环的结构可能会让人觉得别扭，但你可以将其与 HTML 表格标签中的 thead（开始）、tfoot（结束）、tbody（当前）的顺序进行比较。

```
$first = true;
foreach($array as $key => $value) {
    if ($first) {
        $first = false;
        // Do what you want to do before the first element
        echo "List of key, value pairs:\n";
    } else {
        // Do what you want to do at the end of every element
        // except the last, assuming the list has more than one element
        echo "\n";
    }
    // Do what you want to do for the current element
    echo $key . ' => ' . $value;
} 
```

例如，在 Web 开发术语中，如果您想为无序列表 (ul) 中**除最后一个元素之外的每个元素添加一个边框底部**，那么您可以**为除第一个元素之外的每个元素添加一个边框顶部**（CSS： IE7+ 和 Firefox/Webkit 支持的 first-child 支持此逻辑，而 IE7 不支持 :last-child）。

您也可以随意为每个嵌套循环重用 $first 变量，并且一切都会正常工作，因为在第一次迭代的第一个过程中每个循环都会使 $first 错误（因此中断/异常不会导致问题） .

```
$first = true;
foreach($array as $key => $subArray) {
    if ($first) {
        $string = "List of key => value array pairs:\n";
        $first = false;
    } else {
        echo "\n";
    }

    $string .= $key . '=>(';
    $first = true;
    foreach($subArray as $key => $value) {
        if ($first) {
            $first = false;
        } else {
            $string .= ', ';
        }
        $string .= $key . '=>' . $value;
    }
    $string .= ')';
}
echo $string; 
```

示例输出：

```
List of key => value array pairs:
key1=>(v1_key1=>v1_val1, v1_key2=>v1_val2)
key2=>(v2_key1=>v2_val1, v2_key2=>v2_val2, v2_key3=>v2_val3)
key3=>(v3_key1=>v3_val1) 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2014-05-22T10:42:32.410

这应该是找到最后一个元素的简单方法：

```
foreach ( $array as $key => $a ) {
    if ( end( array_keys( $array ) ) == $key ) {
        echo "Last element";
     } else {
        echo "Just another element";
     }
} 
```

参考：[链接](http://mattgeri.com/2012/05/find-the-last-element-of-a-php-array-within-a-loop/)

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2018-12-26T14:12:36.103

不要在最后一个值之后添加逗号：

**数组：**

```
$data = ['lorem', 'ipsum', 'dolor', 'sit', 'amet']; 
```

**功能：**

```
$result = "";
foreach($data as $value) {
    $result .= (next($data)) ? "$value, " : $value;
} 
```

**结果：**

```
print $result; 
```

lorem, ipsum, dolor, 坐, amet

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2012-04-21T07:22:18.973

我有一种强烈的感觉，在这个“XY 问题”的根源上，OP 想要的只是`implode()`功能。

* * *

## 回答 #16

> 赞同：3
> 
> 时间：2013-04-06T05:24:21.730

因为您寻找 EOF 数组的意图只是为了胶水。了解以下策略。您不需要 EOF：

```
$given_array = array('column1'=>'value1',
                     'column2'=>'value2',
                     'column3'=>'value3');

$glue = '';
foreach($given_array as $column_name=>$value){
    $where .= " $glue $column_name = $value"; //appending the glue
    $glue   = 'AND';
}
echo $where; 
```

o/p：

```
column1 = value1 AND column2 = value2 AND column3 = value3 
```

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2010-06-08T13:48:07.227

如何使用“结束”？ [http://php.net/manual/en/function.end.php](http://php.net/manual/en/function.end.php)

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2011-09-22T06:38:11.337

**听起来你想要这样的东西：**

```
$array = array(
    'First',
    'Second',
    'Third',
    'Last'
);

foreach($array as $key => $value)
{
    if(end($array) === $value)
    {
       echo "last index!" . $value;
    }
} 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-03-20T06:05:26.853

你可以做一个计数（）。

```
for ($i=0;$i<count(arr);$i++){
    $i == count(arr)-1 ? true : false;
} 
```

或者如果你只寻找最后一个元素，你可以使用 end()。

```
end(arr); 
```

只返回最后一个元素。

而且，事实证明，您可以按整数索引 php 数组。它非常满意

```
arr[1]; 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-03-30T19:14:51.883

你也可以这样做：

```
end( $elements );
$endKey = key($elements);
foreach ($elements as $key => $value)
{
     if ($key == $endKey) // -- this is the last item
     {
          // do something
     }

     // more code
} 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2013-07-16T17:28:16.790

我有点喜欢下面的，因为我觉得它相当整洁。假设我们正在创建一个在所有元素之间带有分隔符的字符串：例如 a,b,c

```
$first = true;
foreach ( $items as $item ) {
    $str = ($first)?$first=false:", ".$item;
} 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2018-09-23T13:10:17.663

```
foreach ($array as $key => $value) {

  $class = ( $key !== count( $array ) -1 ) ? " class='not-last'" : " class='last'";

  echo "<div{$class}>";
  echo "$value['the_title']";
  echo "</div>";

} 
```

[参考](https://dev-notes.eu/2016/09/target-the-last-item-in-a-php-foreach-loop/)

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2021-05-09T16:19:45.560

如果它是一维数组，您可以这样做以保持简短和甜蜜：

```
foreach($items as $idx => $item) {
    if (!isset($items[$idx+1])) {
        print "I am last";
    }
} 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2021-10-08T01:36:55.817

```
$array  = array("dog", "rabbit", "horse", "rat", "cat");
foreach($array as $index => $animal) {
    if ($index === array_key_first($array))
        echo $animal; // output: dog

    if ($index === array_key_last($array))
        echo $animal; // output: cat
} 
```

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-12-09T23:52:31.600

这是另一种方法：

```
$arr = range(1, 10);

$end = end($arr);
reset($arr);

while( list($k, $v) = each($arr) )
{
    if( $n == $end )
    {
        echo 'last!';
    }
    else
    {
        echo sprintf('%s ', $v);
    }
} 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2010-04-08T16:13:41.947

如果我理解你，那么你只需要反转数组并通过 pop 命令获取最后一个元素：

```
 $rev_array = array_reverse($array);

   echo array_pop($rev_array); 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2010-11-05T20:27:45.993

您也可以尝试使用此方法进行查询...此处显示为 INSERT

```
<?php
 $week=array('one'=>'monday','two'=>'tuesday','three'=>'wednesday','four'=>'thursday','five'=>'friday','six'=>'saturday','seven'=>'sunday');
 $keys = array_keys($week);
 $string = "INSERT INTO my_table ('";
 $string .= implode("','", $keys);
 $string .= "') VALUES ('";
 $string .= implode("','", $week);
 $string .= "');";
 echo $string;
?> 
```

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2011-08-09T13:29:14.820

对于 SQL 查询生成脚本，或对第一个或最后一个元素执行不同操作的任何脚本，避免使用不必要的变量检查要快得多（几乎快两倍）。

当前接受的解决方案使用循环和循环内的检查，将进行every_single_iteration，正确（快速）的方法如下：

```
$numItems = count($arr);
$i=0;
$firstitem=$arr[0];
$i++;
while($i<$numItems-1){
    $some_item=$arr[$i];
    $i++;
}
$last_item=$arr[$i];
$i++; 
```

一个自制的小基准测试显示以下内容：

test1：100000 次运行模型 morg

时间：1869.3430423737 毫秒

test2：100000 次运行模型（如果最后）

时间：3235.6359958649 毫秒

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2012-03-11T21:52:28.883

另一种方法是记住之前的循环结果并将其用作最终结果：

```
 $result = $where = "";
    foreach ($conditions as $col => $val) {
        $result = $where .= $this->getAdapter()->quoteInto($col.' = ?', $val);
        $where .=  " AND ";
    }
    return $this->delete($result); 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2012-04-05T09:06:34.223

我个人使用这种结构，可以轻松使用 html < ul > 和 < li > 元素：只需更改其他属性的相等性...

该数组不能包含虚假项目，但所有其他项目都被转换为虚假布尔值。

```
$table = array( 'a' , 'b', 'c');
$it = reset($table);
while( $it !== false ) {
    echo 'all loops';echo $it;
    $nextIt = next($table);
    if ($nextIt === false || $nextIt === $it) {
            echo 'last loop or two identical items';
    }
    $it = $nextIt;
} 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2012-08-16T13:59:23.847

您可以通过以下方式直接获取最后一个索引：

`$numItems = count($arr);`

`echo $arr[$numItems-1];`

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2012-11-21T14:19:01.970

```
<?php foreach($have_comments as $key => $page_comment): ?>
    <?php echo $page_comment;?>
    <?php if($key+1<count($have_comments)): ?> 
        <?php echo ', '; ?>
    <?php endif;?>
<?php endforeach;?> 
```

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2016-10-22T08:04:38.840

这是我的解决方案：只需获取数组的计数，减 1（因为它们从 0 开始）。

```
$lastkey = count($array) - 1;
foreach($array as $k=>$a){
    if($k==$lastkey){
        /*do something*/
    }
} 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2019-02-13T09:56:52.117

试试这个简单的解决方案

```
$test = ['a' => 1, 'b' => 2, 'c' => 3];

$last_array_value = end($test);

foreach ($test as $key => $value) {
   if ($value === $last_array_value) {
      echo $value; // display the last value  
   } else {
     echo $value; // display the values that are not last elements 
   }
} 
```

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2019-02-13T10:10:31.033

更简单的`end()`函数是 PHP 中的一个内置函数，用于查找给定数组的最后一个元素。end() 函数将数组的内部指针更改为指向最后一个元素并返回最后一个元素的值。

下面是一个非整数索引的例子：

```
<?php
    $arr = array(
            'first' => 
                array('id' => 1, 'label' => 'one'), 
            'second' => 
                array('id' => 2, 'label' => 'two'), 
            'last' => 
                array('id' => 9, 'label' => 'nine')
        );
    $lastIndexArr = end($arr);
    print_r($lastIndexArr); 
```

[在此处检查](https://paiza.io/projects/FsJ_K7BHP791_i_p0pptdQ)最后一个数组作为输出。

# c# - 我们如何在设计模式下指定表单的客户区大小？

> ID：665140
> 
> 赞同：2
> 
> 时间：2009-03-20T06:06:29.113
> 
> 标签：c#, winforms

我正在用 c# 设计一个表单。我想在设计器中指定表单的“客户区”。

Size 属性设置整个表单的大小，包括 NC 区域。有没有办法设置客户区大小？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T06:15:43.210

你看过 ClientSize 属性吗？此属性允许您修改控件客户区的大小。似乎是您正在寻找的东西。

[http://msdn.microsoft.com/en-us/library/system.windows.forms.form.clientsize.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.clientsize.aspx)

# .net - 内存使用 + .net

> ID：665144
> 
> 赞同：1
> 
> 时间：2009-03-20T06:07:33.340
> 
> 标签：.net

.net 2005 ide 中是否有办法找出函数内变量的内存使用情况以及垃圾收集器何时释放它们的内存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T07:23:12.067

对于您问题的第一部分：

您可以使用许多工具来分析应用程序的内存占用量 - 直至单独的代码行。我可以推荐以下工具：

*   [CLR 分析器](http://msdn.microsoft.com/en-us/library/ms979205.aspx)（从 Microsoft 免费下载）
*   [来自 RED Gate 的ANTS Profiler](http://www.red-gate.com/Products/ants_profiler/index.htm)（商业但很棒的 GUI）

对于第二部分：.net 中的 GC 不是确定性的。当应用程序没有可用内存时，它会自动调用。没有工具可以告诉您 GC 何时将内存释放回空闲存储区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T06:11:19.257

你看过[这个问题](https://stackoverflow.com/questions/625465/how-do-i-see-memory-allocation-in-a-given-net-application)吗，它有几种方法，包括

```
System.Runtime.InteropServices.Marshal.SizeOf(...) 
```

您可以查看[GC.RegisterForFullGCNotification](http://msdn.microsoft.com/en-us/library/system.gc.registerforfullgcnotification.aspx)以了解如何查看垃圾收集器

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T06:12:57.197

我不确定你在这里问什么。如果您正在寻找特定对象的内存占用，最好的方法是 WinDbg 和 SOS 扩展。

[http://msdn.microsoft.com/en-us/library/bb190764.aspx](http://msdn.microsoft.com/en-us/library/bb190764.aspx)

这可以为您提供有关对象堆的大量信息，包括大小和世代信息。

此处的这篇文章详细介绍了如何使用 WinDbg 获取对象图的大小。这可能是您正在寻找的

[http://www.eggheadcafe.com/articles/20060114.asp](http://www.eggheadcafe.com/articles/20060114.asp)

# html - 使用元标记设置页面左上角 - HTML

> ID：665179
> 
> 赞同：0
> 
> 时间：2009-03-20T06:30:41.677
> 
> 标签：html, meta-tags

我想使用元标签设置我的页面的顶部和左侧位置

请提出一些解决方案

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T06:35:44.270

我不认为您正在寻找元标记，如`<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />`. 您可能正在寻找 CSS 和`<div>`标签：

```
<style type="text/css">
div.topLeft { 
    top:0;
    left:0;
}
</style>
<div class="topLeft">In the top left</div> 
```

CSS 可能最终会出现在通过标签链接的 CSS 文件中`<link ... />`，并且您可能会有其他 HTML，包括`<html>`,`<head>`和`<body>`标签。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T06:35:32.740

我不认为这是可能的。

# makefile - 为什么 make 抱怨循环依赖？

> ID：665180
> 
> 赞同：11
> 
> 时间：2009-03-20T06:31:17.900
> 
> 标签：makefile

我为我的项目构建了一个 make 文件，它可以工作（一切都可以编译），但它给出了这些恼人的错误消息：

```
make: Circular zpr.c <- zpr.o dependency dropped.
gcc -Wall   -c -o zpr.o zpr.c
make: Circular readjpeg.c <- readjpeg.o dependency dropped.
gcc -Wall   -c -o readjpeg.o readjpeg.c
make: Circular readppm.c <- readppm.o dependency dropped.
gcc -Wall   -c -o readppm.o readppm.c
make: Circular SceneNode.cpp <- SceneNode.o dependency dropped.
g++    -c -o SceneNode.o SceneNode.cpp
make: Circular BoundingBoxNode.cpp <- BoundingBoxNode.o dependency dropped.
g++    -c -o BoundingBoxNode.o BoundingBoxNode.cpp
make: Circular GeometryNode.cpp <- GeometryNode.o dependency dropped.
g++    -c -o GeometryNode.o GeometryNode.cpp
make: Circular SceneGraph.cpp <- SceneGraph.o dependency dropped.
g++    -c -o SceneGraph.o SceneGraph.cpp
make: Circular testgraph.cpp <- testgraph.o dependency dropped.
g++    -c -o testgraph.o testgraph.cpp 
```

我的makefile一点也不复杂，所以希望有人能发现错误。

```
GXX=g++
CC=gcc
CFLAGS=-Wall

LIBS=-lGL -lglut -ljpeg

OBJS=helpers.o loadobj.o zpr.o readjpeg.o readppm.o SceneNode.o BoundingBoxNode.o GeometryNode.o SceneGraph.o  testgraph.o
OBJS2=testgraph.o SceneGraph.o GeometryNode.o BoundingBox.o SceneNode.o readppm.o readjpeg.o zpr.o loadobj.o helpers.o
SRCS=testgraph.cpp SceneGraph.cpp SceneNode.cpp

.o.cpp:
    $(GXX) $(CFLAGS) -c $<

.o.c:
    $(CC) $(CFLAGS) -c $<

testgraph: $(OBJS)
    $(GXX) $(LIBS) $(OBJS) -o testgraph

clean:
    rm *.o 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-03-20T06:58:43.903

你的隐含规则是罪魁祸首。它们的扩展名与 make 理解的顺序相反。

```
.o.c: 
```

告诉 make .c 文件是从 .o 文件创建的。由于已经有一条规则说 .o 文件是从 .c 文件创建的，因此您有循环依赖关系，因此会出现错误。

解决方案很简单（或者应该是，假设配置合理）简单。

在非常常见的情况下（例如 C++ 源代码），您（通常）不需要指定自己的编译规则。仅指定以下内容会更简单：

```
CFLAGS=-Wall
LOADLIBES=-lGL -lglut -ljpeg

OBJS=helpers.o loadobj.o zpr.o readjpeg.o readppm.o SceneNode.o \
   BoundingBoxNode.o GeometryNode.o SceneGraph.o  testgraph.o 

all: testgraph

testgraph: $(OBJS) 
```

这也可能帮助您避免两个错误。

1.  您编写的规则说 .o 文件是从 .c 文件创建的，这是向后的。但是几乎所有版本的 make 中都已经存在正确的规则。

2.  您已经在目标文件之前列出了库。这在某些使用 ELF 格式对象的平台上是偶然的。但这仍然是错误的。在对象之后列出库，因为加载库只是为了满足未定义的外部。

# mainframe - 具有Java/OOP/SQL背景的学习大型机和JCL

> ID：665183
> 
> 赞同：8
> 
> 时间：2009-03-20T06:35:13.647
> 
> 标签：mainframe, zos, jcl

在我的整个职业生涯中，我一直在编写和管理 Java 和 ASP.Net 应用程序和服务器。现在我被引导参与大型机，即 z/OS 和 JCL，我发现很难把我的头包起来（他们仍然在谈论打孔卡！）。在完全被现代奢侈品宠坏之后，学习这一切的最佳方式是什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-20T07:00:33.353

现代大型机中没有打孔卡，它们只是让您继续使用。

你会很难过，因为还有很多事情是用“旧”的方式完成的。

*   数据集仍然分配有诸如fixed-block-80、variable-block-255等属性。计划您的文件内容。
*   没有目录。有层次结构级别，每个级别限制为 8 个字符。
*   用户界面是 ISPF，一个来自地狱第七圈的绿屏文本模式用户界面，供不习惯的人使用。
*   大多数作业仍将作为批处理作业提交，您必须使用 SDSF（任务管理器）监控它们的进度。

这是一些坏消息，下面是好消息：

它有一个 USS 子系统 (UNIX)，因此您可以使用这些工具。它与 z/OS 完美集成。它运行 Java，它运行 Websphere，它运行 DB2（真正的 DB2，不是那么小的 Linux/UNIX/Windows 版本），它运行 MQ 等等。许多商店还将运行 z/VM，一个虚拟机管理程序，他们将在它下运行许多 LPAR（逻辑分区），包括 z/OS 本身（有时是多个副本）和 zLinux (SLES/RHEL)。

大型机没有很快消失的危险。世界各地的各个 IBM 实验室仍在进行大量工作，而 64 位操作系统（z/OS、MVS、OS/390、...）已经走过了漫长的道路。事实上，有一点职业机会，因为所有知道它的老人都在 55 岁或以上，所以如果你正确定位自己，预计会在公司阶梯上产生巨大的吸引力。

它仍然在大公司中使用，因为它是唯一可以信任其交易的东西 - System z 中的 z 意味着零停机时间，而这不仅仅是营销炒作。大型机的强大之处不在于它的 CPU 咕噜声（单个处理器没有那么强大，但它们包含 54 个带有热备份的 CPU，并且您可以在单个 System z 机器中运行许多书籍），但事实上CPU所做的只是处理指令。

*其他一切*都被卸载到专业处理器、用于 DB2 的 zIIP、用于 Java 工作负载的 zAAP、用于 I/O 的其他设备（而 I/O 是大型机使用光纤和*非常*大的磁盘阵列杀死所有其他系统的地方）。我不会将它用于蛋白质折叠或基因组测序，但它非常适合它的目标、大规模疯狂级别的事务处理。

正如我所说，z/OS 有一个 UNIX 子系统，z/VM 可以运行 z/OS 和其他操作系统的多个副本——我见过一个 z800 机器同时运行数万个 RHEL 实例。这让所有 PC 制造商的“绿色”声明感到羞耻，并且实例之间的通信速度非常快，使用 HyperSockets（TCP/IP 但使用共享内存而不是通过慢速网络电缆（是的，与 HyperSockets 相比，即使是千兆以太网也爬行）（抱歉嵌套括号:-)))。

它在 Unix 空间中很好地运行 Websphere Application Server 和 Java，同时仍然允许所有遗留（遗产？）的东西也运行。事实上，大型机商店根本不需要购买基于 PC 的服务器，他们只需安装几个 zLinux 虚拟机并在一个机器上运行所有东西。

最近，有传言称 IBM 可能也会为其大型机提供 xSeries（即 PC）插件设备。虽然大多数大型机人会认为这是他们漂亮盒子侧面的一个疣，但它确实为第三方供应商开辟了*很多可能性。*我不确定他们是否能够运行 50,000 个 Windows 实例，但这似乎是他们的目标（一个环来统治它们？）。

如果您有兴趣，有一个名为 Hercules 的 System z 模拟器，我已经看到它在 Windows 机器上以 23 MIPS 运行，它运行最后一个合法可用的 MVS 3.8j 的速度足以让您体验一下。请记住，MVS 3.8j 之于 z/OS 1.10 就像 CP/M 之于 Windows XP。

要为我工作中的一个朋友写的一本书提供一个无耻的插件，请查看[什么是大型机？](https://rads.stackoverflow.com/amzn/click/com/1409225356)大卫斯蒂芬斯 (ISBN-13 = 978-1409225355)。我发现这是非常宝贵的，因为我来自 PC/UNIX 背景，这是一个相当大的范式转变。我认为这本书非常适合您的特定问题。我认为其中的大部分内容都可以在 Google 图书上找到，因此您可以在购买前尝试一下。

关于 JCL，有一种观点认为只编写了一个 JCL 文件，而其他所有文件都是在此之上进行的。看了他们的内容，我就明白了。像 IEBGENER 和 IEFBR14 这样的程序使 Unix 看起来，如果不是冗长的话，至少是可以理解的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-06-30T09:13:15.730

您的第一个误解是相信 JCL 中的“L”。JCL 不是一种编程语言，它实际上是关于程序应该如何运行以及应该使用哪些文件等的静态声明。

通过这种方式，它很像（尽管优于）用于控制诸如 spring、hebernate 和 ant 之类的“现代”软件的 xml config spahetti。

如果你用这些术语来思考它，一切都会变得清晰。

大型机文化是由两个看似不相容的痴迷驱动的。

1.  向后兼容。您仍然可以运行在 1970 年编写和编译的可执行文件。四十年前的 JCL 和脚本仍然可以运行和工作！
2.  流血的边缘性能。您可以在两个数据中心的四台机器上拥有 128 个 CPU，处理单个 DB2 查询。它将比任何其他机器更快地运行最新的 J2EE (Websphere) 应用程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T07:17:45.183

如果您曾经接触过Z/OS 上的[CICS](http://en.wikipedia.org/wiki/CICS)（大型机事务服务器），我会推荐[《Designing and Programming CICS applications》](https://rads.stackoverflow.com/amzn/click/com/1565926765)一书。
这是非常有用的。
[替代文字 http://img18.imageshack.us/img18/7031/designingandprogramming.gif](http://img18.imageshack.us/img18/7031/designingandprogramming.gif)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-06T00:59:57.350

如果您打算参与传统的遗留应用程序开发，请阅读 Steve Eckols 的书籍。他们很好。您需要比较从开放系统到大型机的术语，这将减少您的学习时间。几个示例文件称为大型机上的数据集 JCL 更像是一个 shell 脚本子程序/例程或像常用函数等......祝你好运......

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-04-28T12:04:44.450

一开始手越多越好。我作为实习生在大型机上做过工作，尽管我有相当强的 UNIX 背景，但这并不容易。我建议请在大型机部门工作的人花一两天时间教你基础知识。IBM 培训也可能会有所帮助，但我没有任何经验，因此不能保证会。我已经把我关于学习如何使用大型机的故事放在下面的一些上下文中。决定所有实习生都将学习如何使用大型机作为暑期项目，这将花费 20% 的时间。这是一场彻底的灾难，因为所有实习生都承认我在非大型机区域工作，而且没有人可以越过立方体墙大喊大叫寻求帮助。ISPF 和 JCL 环境对他们来说是陌生的，以便他们快速熟练使用。他们唯一的成功是在 USS 下的基本编程，因为它基本上是 UNIX，大学让他们熟悉了这一点。我有更好的运气有两个原因。一个是我在一个大约 20 名大型机程序员组成的小组中工作，因此能够定期有人坐下来帮助我弄清楚 JCL、提交工作等。第二个我使用[System z 的 Rational 开发人员](http://www-01.ibm.com/software/awdtools/rdz/)当它被命名为 WebSphere Developer for System z 时。这为我提供了一个最实用的 GUI，让我可以执行大多数任务，例如提交作业、编辑数据集、分配数据集、调试程序等。虽然它没有完善，但它足够可用，意味着我不必学习 ISPF。我有一个基于 Eclipsed 的 IDE 来执行基本的大型机任务这一事实显着降低了学习曲线，这意味着我只需要学习 JCL 等新技术，而不是一个全新的环境。作为进一步说明，我现在使用 ISPF，因为在我使用的生产系统之一上没有安装允许 Rational 在大型机上运行所需的软件，因此 ISPF 是唯一的选择。我现在发现 ISPF 比 Rational Developer 更快，而且我使用它的效率更高。这只是因为我能够在以后学习底层技术，例如带有 Rational 的 JCL 和 ISPF 接口。如果我必须同时学习两者，那将更加困难，并且需要更多的一对一指导。

# javascript - 如何沿路线为自定义 Google 地图标记设置动画？

> ID：665193
> 
> 赞同：22
> 
> 时间：2009-03-20T06:42:36.813
> 
> 标签：javascript, google-maps, animation, handheld

我已经使用 JavaScript 和 Google Maps API 为手持设备编写了一个小型应用程序，现在我需要使用计时器功能沿着路线在地图上的任何位置移动我的标记图标。我有一个男人图标，我需要在地图上自动移动它。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-08-25T10:03:31.937

一个很酷的例子在这里：

[http://www.kmcgraphics.com/google/](http://www.kmcgraphics.com/google/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-20T08:39:03.567

不幸的是，官方 GMaps 集合中没有自动标记移动功能。

但是，如果您有 GRoute，则意味着您有一组点。要遍历路线步骤，您可以使用以下内容：

```
for (var c = 0; c < yourroute.getNumSteps(); c++) { 
    yourmarker.setLatLng(yourroute.getStep(c).getLatLng());
} 
```

当然，您可能希望使用计时器异步执行此操作：

```
function moveToStep(yourmarker,yourroute,c) {
    if {yourroute.getNumSteps() > c) {
        yourmarker.setLatLng(yourroute.getStep(c).getLatLng());
        window.setTimeout(function(){
            moveToStep(yourmarker,yourroute,c+1);
        },500);
    }
}

moveToStep(marker,route,0); 
```

为了更平滑的运动，您可以从已有的点中插入点。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-04-26T08:56:15.407

这是我使用 v3 API 的解决方案。这不是以固定速度为标记设置动画，而是基于计算的路线持续时间。有一个速度因素，例如，您可以以比实际速度快 10 倍的速度通过路线。

我试图尽可能简单地做到这一点。随意使用它。

```
var autoDriveSteps = new Array();
var speedFactor = 10; // 10x faster animated drive

function setAnimatedRoute(origin, destination, map) {
    // init routing services
    var directionsService = new google.maps.DirectionsService;
    var directionsRenderer = new google.maps.DirectionsRenderer({
        map: map
    });

    //calculate route
    directionsService.route({
            origin: origin,
            destination: destination,
            travelMode: google.maps.TravelMode.DRIVING
        },
        function(response, status) {
            if (status == google.maps.DirectionsStatus.OK) {
                // display the route
                directionsRenderer.setDirections(response);

                // calculate positions for the animation steps
                // the result is an array of LatLng, stored in autoDriveSteps
                autoDriveSteps = new Array();
                var remainingSeconds = 0;
                var leg = response.routes[0].legs[0]; // supporting single route, single legs currently
                leg.steps.forEach(function(step) {
                    var stepSeconds = step.duration.value;
                    var nextStopSeconds = speedFactor - remainingSeconds;
                    while (nextStopSeconds <= stepSeconds) {
                        var nextStopLatLng = getPointBetween(step.start_location, step.end_location, nextStopSeconds / stepSeconds);
                        autoDriveSteps.push(nextStopLatLng);
                        nextStopSeconds += speedFactor;
                    }
                    remainingSeconds = stepSeconds + speedFactor - nextStopSeconds;
                });
                if (remainingSeconds > 0) {
                    autoDriveSteps.push(leg.end_location);
                }
            } else {
                window.alert('Directions request failed due to ' + status);
            }
        });
}

// helper method to calculate a point between A and B at some ratio
function getPointBetween(a, b, ratio) {
    return new google.maps.LatLng(a.lat() + (b.lat() - a.lat()) * ratio, a.lng() + (b.lng() - a.lng()) * ratio);
}

// start the route simulation   
function startRouteAnimation(marker) {
    var autoDriveTimer = setInterval(function () {
            // stop the timer if the route is finished
            if (autoDriveSteps.length === 0) {
                clearInterval(autoDriveTimer);
            } else {
                // move marker to the next position (always the first in the array)
                marker.setPosition(autoDriveSteps[0]);
                // remove the processed position
                autoDriveSteps.shift();
            }
        },
        1000);
} 
```

用法：

```
setAnimatedRoute("source address or LatLng ...", "destination address or LatLng ...", map);
// start simulation on button click...
$("#simulateRouteButton").click(function() {
    startRouteAnimation(agentMarker);
}); 
```

# sql - SQL 更新查询

> ID：665194
> 
> 赞同：0
> 
> 时间：2009-03-20T06:43:17.620
> 
> 标签：sql, sql-server, sql-update

我们将主键与字段 no、id 和 groupno 组合在一起

在 Access 中，诸如 WHERE 条件的`WHERE no = '' & groupno = ''`执行速度更快，而同样的事情会减慢 SQL 中的更新速度。

一旦我们提供了 no 和 groupno 的单个索引，它会更快吗？

如果我们提供具有 3 个三个字段的主键并且没有基于这些字段的单独索引，它是否将其视为组合键？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T07:01:25.393

一般来说，从快速完成过滤的角度来看，它会更喜欢单个索引（您为最左边的字段提供值）。

此外，您在更新中触摸索引字段的次数越多，将花费更多时间进行索引维护。

小心不要过多地阅读对小型数据集做某事的时间——你可能很容易看到连接开销。

我建议通过 Query Analyzer/SQL Server Management Studio 查看查询计划 - 这将允许您查看它实际使用的索引，因此您不会在黑暗中探索。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T08:48:53.000

什么版本的 SQL？索引不会加快查询 NULL 值的速度，因为它们没有放在索引中，对于 Oracle 来说无论如何。

# iphone - 如何释放 CGImageCreateWithImageInRect 关联的内存

> ID：665198
> 
> 赞同：3
> 
> 时间：2009-03-20T06:49:37.263
> 
> 标签：iphone, objective-c, cocoa-touch

我正在使用`CGImageCreateWithImageInRect()`从背景图像运行时生成一个小图像，它将为每个线程调用（0.01 秒）显示。一旦我开始通过应用程序显示部分图像，`CGImageCreateWithImageInRect`就会开始以非常高的速率消耗内存并在几秒钟内崩溃。消耗的内存达到 20+ MB 并崩溃。普通应用程序将在 2MB 上运行。

```
Image1 = CGImageCreateWithImageInRect(imageRef, CGRectMake(x, y, w, h)); 
```

处理后我做

```
CGImageRelease(Image1); 
```

但这对我没有帮助。

我想知道如何释放与`CGImageCreateWithImageInRect`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-28T15:13:11.440

您的问题的答案实际上是 CGImageRelease；您从代码中摘录的那对行是正确平衡的。你一定是在其他地方泄漏。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2011-01-25T04:24:31.997

实际上，那对线是不平衡的，因为 CGImageCreateWithImageInRect() 保留了原始图像。应该是……</p>

```
CGImageRef Image1 = CGImageCreateWithImageInRect(imageRef, CGRectMake(x, y, w, h));
CGImageRelease(imageRef);
...
CGImageRelease(Image1); 
```

# silverlight - 如何在 Silverlight 3 中将 .NET RIA 服务与 MVVM 相结合？

> ID：665204
> 
> 赞同：2
> 
> 时间：2009-03-20T06:56:34.877
> 
> 标签：silverlight, silverlight-3.0, mvvm, wcf-ria-services

.NET RIA 服务被描述为 Silverlight 的 n 层框架。我一直想知道这个框架和 Model-View-ViewModel 模式之间的关系是什么。它们是否存在冲突，或者你能看到协同组合的潜力吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T15:02:41.290

.NET RIA 服务和 MVVM 是协同的，并且没有冲突。

例如，如果我编写了一个目录域服务，它在服务器上公开产品和类别，并在客户端相应地有一个目录域上下文......那么以下是根据场景使用的选项：

1.  编写一个视图模型来包装目录域上下文并公开分发已加载到产品和类别列表中的数据子集的属性。并公开在目录上翻转和调用方法的操作。

2.  将目录暴露在视图模型之外。这通常非常适合只读场景。

在任何一种情况下，您的视图模型都可以负责初始化目录并自定义其创建、设置等。

希望这可以帮助您开始思考如何有效地结合这些。

我们肯定会在我们推出的未来样本中展示其中的一些工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T15:44:31.160

顺便说一句 - Shawn Wildermuth在 MSDN 杂志 2009 年 3 月号上有一篇简洁的[Silverlight MVVM 文章](http://msdn.microsoft.com/en-us/magazine/dd458800.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-09T09:29:01.280

有关示例，请参见[http://msmvps.com/blogs/theproblemsolver/archive/2009/04/07/using-model-view-viewmodel-with-silverlight.aspx 。](http://msmvps.com/blogs/theproblemsolver/archive/2009/04/07/using-model-view-viewmodel-with-silverlight.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-12-10T14:17:44.953

Shawn Wildermuth 结合 RIA 服务和 MVVM 的示例：

[http://wildermuth.com/2010/04/16/Updated_RIA_Services_MVVM_Example](http://wildermuth.com/2010/04/16/Updated_RIA_Services_MVVM_Example)

此外，codeplex 上的 PRISM 下载有这方面的文档，包括快速入门和 MVVM 和 RIA 服务的参考实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T08:50:39.267

我会问乔纳斯·福勒索。他似乎对 SL 中的 MVVM 很感兴趣。

[http://jonas.follesoe.no/](http://jonas.follesoe.no/)

# jquery - 如何根据初始 .ajax 调用的结果启动另一个 jQuery .ajax 调用？

> ID：665218
> 
> 赞同：0
> 
> 时间：2009-03-20T07:09:27.417
> 
> 标签：jquery, ajax

我有一个 jQuery .ajax 调用：

```
$j.ajax({
    type: "POST",
    url: "/Services/Cart.asmx/UpdateQuantity",
    data: data,
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(msg) {
        var d = msg.d;
        // etc.
    },
    error: function(xhr, msg) {
        var response = JSON.parse(xhr.responseText);
        var cart = $j('#cart');
        if (response.Message) {
            cart.before('<div class="error">' + response.Message + '</div>');
        } else {
            cart.before(' <div class="error">An unexpected error occurred.</div> ');
        }
    },
    complete: function(request, settings) {
        // Some other stuff.
    }

}); // end ajax
alert('Initially thought this would be called after above .ajax call complete. But it is not. Rather, it is called before success etc.'); 
```

但是，根据第一个 ajax 调用返回的一些数据，我想启动第二个 .ajax 调用。似乎由于第一个回调是如何配置的，它不会按顺序发生（即在上面最后一个 alert('Initially...') 行中的位置），所以我无法使用最新更新的客户端 DOM 数据。

如何最好地发送另一个 .ajax 调用？我很快在整个活动中做了一些测试，但这似乎并不成功。

我有“jQuery in Action”坐在这里等着我抽出时间来挖掘它以了解更多幕后发生的事情，但还没有时间！

更新：呃。当显而易见的事情首先没有按预期工作时，问题通常出在椅子和显示器之间。我会把这个当成通宵放屁。原来我最初是如何设置它的（在成功回调中调用第二个 .ajax 调用）显然是正确的，但是我的第二个 .ajax 调用中有一个小的语法错误（因此失败并让我走错了路）。

并且@kgiannakakis 被记录为答案，因为他/她是 a) 首先和 b) 提供了可笑的低调“您可以将调用配置为同步，但这不是推荐的技术。”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T20:06:42.137

如果您想根据第一个结果发出另一个 ajax 请求，您可能应该在另一个函数中有第二个 ajax 请求。其他函数将在 hte 第一个 ajax 请求的成功事件上被调用。像这样的东西，虽然我没有测试过它以确保它是正确的：

```
$j.ajax({
    type: "POST",
    url: "/Services/Cart.asmx/UpdateQuantity",
    data: data,
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: newSuccessFunction(xhr,msg),
    error: function(xhr, msg) {
        var response = JSON.parse(xhr.responseText);
        var cart = $j('#cart');
        if (response.Message) {
            cart.before(' <div class="error">' + response.Message + '</div> ');
        }
        else {
            cart.before(' <div class="error">An unexpected error occurred.</div> ');
        }
    },
    complete: function(request, settings) {
        // Some other stuff.
    }

}); // end ajax

function newSuccessFunction(xhr,msg) {
    var d = msg.d;
    //... etc.
    $.ajax({ //...
           });
    alert('Initially thought this would be called after above .ajax call complete. But it is not. Rather, it is called before success etc.')
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T07:27:09.280

那么警报应该在成功回调中而不是在ajax调用之后。ajax 调用的默认行为是异步的。也就是说，调用会立即返回，而回调会在稍后的某个时间点被调用，此时实际接收到数据。

您可以将调用配置为同步，但这不是推荐的技术。

# java - 如何在jsp中使用JFreeChart显示折线图？

> ID：665222
> 
> 赞同：2
> 
> 时间：2009-03-20T07:12:29.237
> 
> 标签：java, jfreechart, linegraph

大家好：
我正在使用下面来显示折线图。当我运行下面的代码时，我得到了窗口，但它是空白的并且不显示图表。请帮助我，并告诉我如何使用下面的代码在 html 页面中显示折线图。

```
import org.jfree.chart.*;
import org.jfree.chart.plot.PlotOrientation;
import org.jfree.data.xy.*;

public class xyLine {

    public static void main(String arg[]) {
        XYSeries series = new XYSeries("Average Weight");
        series.add(20.0, 20.0);
        series.add(40.0, 25.0);
        series.add(55.0, 50.0);
        series.add(70.0, 65.0);
        XYDataset xyDataset = new XYSeriesCollection(series);
        JFreeChart chart = ChartFactory.createXYLineChart(
            "XYLine Chart using JFreeChart", "Age", "Weight",
            xyDataset, PlotOrientation.VERTICAL, true, true, false);
        ChartFrame frame1 = new ChartFrame("XYLine Chart", chart);
        frame1.setVisible(true);
        frame1.setSize(300, 300);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T07:54:44.170

我前段时间也这样做过，但我也有代码，所以这是线索..

正如 Thorbjørn Ravn Andersen 所说，您必须有一个生成图像而不是网页的 servlet。这意味着您的 servlet 的 processRequest 方法看起来像这样：

```
protected void processRequest(HttpServletRequest request, HttpServletResponse response)
    throws ServletException, IOException {

        response.setContentType("image/png");
        ServletOutputStream os = response.getOutputStream();
        ImageIO.write(getChart(request), "png", os);
        os.close();
    }

private RenderedImage getChart(HttpServletRequest request) {
        String chart = request.getParameter("chart");
        // also you can process other parameters like width or height here
        if (chart.equals("myDesiredChart1")) {
            JFreeChart chart = [create your chart here];
            return chart.createBufferedImage(width, height)
        } 
```

然后您可以将此 servlet 用作其他页面中的图像源，例如这样..

```
<img src="/ChartDrawerServlet?chart=myDesiredChart1&width=..and other processed parameters" ..> 
```

你完成了:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T10:09:45.893

您正在使用在网络设置中不起作用的摇摆方法。您必须生成一个图像，并将其展平为例如 JPEG 字节流，然后将其作为来自您的 servlet 的响应返回，该响应具有正确的 MIME 类型。

我在很多个月前做过这个，但现在没有代码了。

# .net-3.5 - 使用 GAC 时如何获取用于登录生产的堆栈跟踪信息

> ID：665225
> 
> 赞同：0
> 
> 时间：2009-03-20T07:15:31.927
> 
> 标签：.net-3.5, gac, stack-trace, pdb-files, nlog

我想在生产环境中获取用于记录异常等的堆栈跟踪（文件名和行号）信息。DLL 安装在 GAC 中。有没有办法做到这一点？

[本文](http://www.elumenotion.com/Blog/Lists/Posts/Post.aspx?ID=23)介绍了将 PDB 文件放入 GAC：

> 您可以轻松发现这些，因为他们会说您需要将调试符号（.pdb 文件）复制到 GAC。就其本身而言，这是行不通的。

我知道这篇文章是指使用 VS 进行调试，但我认为它也可能适用于记录堆栈跟踪。

除了取消选中他们说是可选的优化代码外，我已经按照说明回答了[这个问题。](https://stackoverflow.com/questions/628565/)

我将 dll 和 pdb 复制到 GAC 中，但仍然没有得到堆栈跟踪信息。这是我在堆栈跟踪的日志文件中得到的内容：

```
OnAuthenticate at offset 161 in file:line:column <filename unknown>:0:0
ValidateUser at offset 427 in file:line:column <filename unknown>:0:0
LogException at offset 218 in file:line:column <filename unknown>:0:0 
```

我正在使用 NLog。

我的 NLog 布局是：

```
layout="${date:format=s}|${level}|${callsite}|${identity}|${message}|${stacktrace:format=Raw}" 
```

${stacktrace:format=Raw} 是相关部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T07:30:15.620

试试小写的 raw：

```
 ${stacktrace:format=raw} 
```

如果这不起作用，请尝试：

```
 ${exception:format=stacktrace} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-21T16:17:29.063

试试这个：

```
StringWriter sw = new StringWriter();
new Throwable().printStackTrace(new PrintWriter(sw));
String stackTrace = sw.toString(); 
```

字符串 stackTrace 将具有当前线程的 stackstrace

# javascript - AJAX 中的访问被拒绝问题

> ID：665232
> 
> 赞同：0
> 
> 时间：2009-03-20T07:23:06.013
> 
> 标签：javascript, html, ajax

我想将一个网页解析到我的页面中，所以我更喜欢在我的代码中使用 AJAX。在使用 AJAX 时，它显示“访问被拒绝” - 在获取指定页面之前。该页面不考虑任何登录信息。

即使我也无法获得谷歌的页面..

请指导我如何使用 AJAX，以便

谢谢，
普拉文

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-20T07:41:48.057

您只能将`XMLHttpRequest`s 发送到您的域。如果您的网站是`example.com`，您只能将`XMLHttpRequest`s 发送到`example.com`. Firefox 3 支持跨域请求，但需要先发送`Access-Control`。

解决方案是向您的域发送请求并通过某种服务器语言（Java、PHP、Python 等）获取跨域内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T15:33:54.077

您还可以使用 hack 通过 CSS 检索数据，包括[http://nb.io/hacks/csshttprequest](http://nb.io/hacks/csshttprequest)

# c# - 以编程方式将 ListViewItem 添加到 WPF 中的 Listview

> ID：665234
> 
> 赞同：6
> 
> 时间：2009-03-20T07:23:19.287
> 
> 标签：c#, wpf, listview

> **可能重复：**
> [WPF ListView - 如何以编程方式添加项目？](https://stackoverflow.com/questions/1305406/wpf-listview-how-to-add-items-programmatically)

如何在 C# 中完成？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T15:48:32.477

这是您如何将`ListViewItem`创建的代码添加到您的`ListView`：

```
myListView.Items.Add(new ListViewItem { Content = "This is an item added programmatically." }); 
```

但是，我同意**MrTelly**的观点，这不应该是必要的，你应该设置`ListView.ItemsSource`一些集合而不是`ListView.Items`直接操作。

如果您向我们提供有关您想要完成的任务的更多详细信息，也许我们可以帮助您以 WPF 方式完成它，这在开始时并不总是那么简单，但从长远来看它会容易*得多。*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-02-07T14:14:02.727

Adding it directly to the ListView in your App isn't necessarily the "WPF-way". Consider this:

```
public class BindableListViewModel 
{

     public IList<TypeOfObjectToDisplay> AllObjectsToDisplay;
     public ICommand AddNewItemToList;

     public BindableListViewModel()
     { 
       AllObjectsToDisplay = new ObservableList<TypeOfObjectToDisplay>();
       AddNewItemToList = new RelayCommand(AddNewItem(), CanAddNewItem());
     }

     public bool CanAddNewItem()
     {
       //logic that determines IF you are allowed to add
       //For now, i'll just say that we can alway add.
        return true;
     }

     public void AddNewItem()
     {
       AllObjectsToDisplay.Add(new TypeOfObjectToDisplay());
     }

} 
```

Then, in XAML all that we need to do is bind the ItemsSource of our ListView to our AllObjectsToDisplay list. This allows us to separate the dependency of adding objects directly to our ListView; we can us WPF's strength of Data Binding to **remove the direct dependency** on HOW we add businesss objects to our UI container we display them in -- a very useful practice!

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-08-20T11:24:31.423

[我在这里](https://stackoverflow.com/questions/1305406/wpf-listview-how-to-bind-single-items)问了完全相同的问题（并回答了自己——我的代码有问题）。希望能帮助到你。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-07T09:46:39.953

（抱歉，还不能发表评论）

正如 MrTelly 正在...

将列表视图绑定到 ObservableCollection

```
ObservableCollection<MyClassItem> lvList = new ObservableCollection<MyClassItem>();
myListview.ItemSource = lvList;

// Add an item
lvList.Add(new MyClassItem("firstname", "lastname")); 
```

这样，当对集合进行更改时，它将自动更新 UI。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T10:17:14.847

如果您按预期使用 ListView，它将绑定到某种对象的底层列表，并且该类应实现 INotifyChanged。在 WPF 中，您不直接从 ListView 添加/删除项目，而是处理绑定的列表结构，它会通知 UI 更改，然后巧妙地使用新项目重新绘制自己。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-15T06:02:22.873

您可以使用附加属性将列动态添加到 ListView。查看**CodeProject**上的这篇文章，它准确地解释了......

[WPF DynamicListView - 绑定到 DataMatrix](http://www.codeproject.com/KB/WPF/WPF_DynamicListView.aspx)

# php - 当用户可能保持登录状态但由于另一个更新而需要更新会话密钥时，处理会话的最佳方法是什么？

> ID：665237
> 
> 赞同：1
> 
> 时间：2009-03-20T07:26:31.480
> 
> 标签：php, session

我正在开发一个网站，只要用户从不关闭浏览器（因此永远不会获得新的会话密钥），从技术上讲，他们可以永远保持登录状态。这是我可以看到的情况：用户在计算机 A 上打开浏览器。然后使用计算机 B，登录并更改存储在会话中的名称。他们注销了 B，但 A 仍处于登录状态，并且仍将其旧名称存储在会话中。因此，他们的姓名将在下次手动注销或关闭浏览器并再次打开并通过记住我功能登录时才会更新。

名称是一个简单的示例，但在我的情况下，他们帐户的订阅级别存储在会话中并且可以更改。

你如何处理这个问题？

我的一些想法是：

1.  10 分钟或更长时间后，会话数据会重新加载。如果用户高度活跃，则可能正好是 10 分钟，因为该功能将在 10 分钟点立即触发，或者如果用户离开并返回然后触发该功能，则可能是 2 小时后。

2.  在会话中存储尽可能少的信息，并在每次页面调用时从数据库中加载其余信息。（我真的不喜欢这个主意。）

3.  使用数据库会话并在所有计算机上使用相同的会话。我喜欢这个，但是当搜索条件存储在会话中时，我会看到它变得令人困惑——相同的条件会显示在两个浏览器/计算机上。

4.  对于信息，即使是用户名或用户名/电子邮件地址，将其存储在会话中，但对于会严重影响他们在网站上的能力的其他信息，不要将其存储在会话中并在需要时加载（尝试每个实例只做一次）。

还有其他更好的方法吗？

-- 另一种选择： 5\. 使用数据库会话，当更新时加载用户的其他会话（只是反序列化），更改相关信息并将它们保存回数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T20:53:40.713

Don't store information likely to change in the session, if you're looking at scenarios like the one you outline. Just get over your dislike of loading user data with every page - it's by far the best idea.

I'm guessing you don't want to load the data from the database because you're concerned about performance issues somehow. Before you try out any of the other solutions, you might want to test how long it takes to actually load a users data from the database, then check that against your number of users - chances are you won't see any performance problems due to loading user profiles on every page.

Regards

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T08:52:39.790

通常你应该做2），但你不喜欢它。也许您可以使用存储在数据库中的会话。当用户更改他的名字时，将该用户的所有会话信息“刷新用户数据”。在下一个请求中，用户数据会再次重新加载到会话中并缓存在那里。这可以通过重用在登录时调用的 loaduserdata 函数来完成。

[php`session_set_save_handler()`](http://php.net/manual/function.session-set-save-handler.php) - 也阅读评论

[php`session_decode()`](http://php.net/manual/function.session-decode.php) - 从会话中读取用户名以将其另外存储到会话数据中。有助于轻松找到用户会话进行更新。

[编辑] 不要忘记：当您在生成页面时（在 session_start 和 session_write_close 之间）更新所有会话时，您的更改可能会丢失。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T09:19:17.183

我会选择数字 1 或数字 4。如果您存储上次更新信息的时间，您甚至可以在每次请求时询问日期是否已更新。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-21T14:24:33.637

我会选择选项 6：只在他的会话中存储用户 ID 和会话特定的东西（搜索条件），并将其余部分放入 APC/xcache（如果您使用多个服务器，则为 memcached）。

这样，您只需第一次访问数据库（并且在缓存过期后），您仍然可以在用户会话之间共享任何数据。

# java - JApplet 中的“J”是什么意思？

> ID：665239
> 
> 赞同：3
> 
> 时间：2009-03-20T07:27:50.243
> 
> 标签：java, applet

JApplet 中的“J”是什么意思？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-20T07:33:06.580

当 Sun 开始研究 Swing 时，他们有 javax.swing.Button 之类的东西。这会导致使用 java.awt.Button 的程序出现问题。如果我没记错的话，主要问题是编译器错误消息令人困惑。

Sun 决定在所有 Swing 组件前加上 J 来消除这个问题。

最初 swing 被称为 JFC - Java Foundation Classes……大概 J 就是从那里来的。

[来自 Netscape 的 IFC](http://www.phdcc.com/javaart2.html)是 JFC 的基础……同一个团队开发了这两者。
该团队从 Netscape 转到 Sun。
J 在第一次向被许可人投放源时就在那里（我是我公司收到下降的人）。

JClass [BWT](http://sciencedesk.arc.nasa.gov/jclass/bwt-doc/faq_bwt.html#bg10)和 IFC（后来成为 JFC，后来成为 Swing）也不兼容……“[我可以在 IFC 环境中使用 BWT 控件吗？](http://sciencedesk.arc.nasa.gov/jclass/bwt-doc/faq_bwt.html#bg42) ”

编辑：回复来自 Swing 团队成员的电子邮件...

> “非 J 的名称已被 AWT 采用，我们认为使用通用前缀将“组件”与包中的其他类区分开来很有用。”

已经参与的部分与我所说的编译器匹配，但没有确认。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-20T07:35:26.420

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-26T02:34:01.570

J 出现在 Swing 类中使用的约定之后。

根据[javadoc](http://java.sun.com/javase/6/docs/api/javax/swing/JApplet.html)：

> *java.applet.Applet 的扩展版本，增加了对[JFC/Swing 组件架构的支持](http://java.sun.com/products/jfc/tsc/articles/architecture/)*

JFC/Swing 架构不同于 AWT 架构。

有几个不同之处，但最重要的是，AWT 使用本机代码来呈现小部件（[SWT](http://www.eclipse.org/swt/)也是如此），而 Swing 是“轻量级的”，因为所有这些都是使用 Java 绘制的。

所以你的问题的答案

> *JApplet 中的“J”是什么意思？*

这意味着它是一个支持 Swing 架构的 Applet。

我认为[TofuBeer](https://stackoverflow.com/questions/665239/what-does-the-j-in-japplet-mean/665249#665249)和[VonC](https://stackoverflow.com/questions/665239/what-does-the-j-in-japplet-mean/665252#665252)是很好的答案，但它们并没有（至少直接）解决您的问题。相反，他们进一步解释了为什么摆动组件中的 J 不应与 Sun 以外的其他类前面的大量其他 J 混淆。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T07:32:15.303

J 代表 Java。JSomeName 类与其“以前的”版本之间的主要区别在于，J-ones 设计用于与 Swing（或任何其他图形工具包）一起使用，而其他的则从那时起只有 AWT 可用。

> ID：665240
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665241
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665242
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665243
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665244
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665245
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665246
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665247
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665248
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665249
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665250
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665251
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665252
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665253
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665254
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665255
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665256
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665257
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665258
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665259
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665260
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665261
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665262
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665263
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665264
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665265
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665266
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665267
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665268
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665269
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665270
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665271
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665272
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665273
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665274
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665275
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665276
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665277
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665278
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665279
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665280
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665281
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665282
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665283
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665284
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665285
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665286
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665287
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665288
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665289
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665290
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665291
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665292
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665293
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665294
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665295
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665296
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665297
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665298
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665299
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665300
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665301
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665302
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665303
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665304
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665305
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665306
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665307
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665308
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665309
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665310
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665311
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665312
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665313
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665314
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665315
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665316
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665317
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665318
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665319
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665320
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665321
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665322
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665323
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665324
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665325
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665326
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665327
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665328
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665329
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665330
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665331
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665332
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665333
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665334
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665335
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665337
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665338
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

> ID：665342
> 
> 赞同：
> 
> 时间：
> 
> 标签：

None

# asp.net - 从 poco 对象生成表单

> ID：665351
> 
> 赞同：1
> 
> 时间：2009-03-20T08:33:49.913
> 
> 标签：asp.net

假设你有一个配置对象

```
public class MyConfig{
 public int PageSize{get;set;}
 public string Title{get;set;}
} 
```

并且您想自动生成一个 asp.net 表单来编辑此对象的属性。

您是否知道任何自动执行此操作的框架？

我知道 MS 动态数据，但似乎我需要拥有整个堆栈（数据库、linq、对象）才能启动并运行它。所以我在想一些更简单的东西..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-23T16:38:46.310

抱歉迟到了。有几种方法可以将动态数据与 POCO 结合使用。

1.  从 2008 年 7 月的 Futures 开始，使用动态数据的 Futures 和 Preview 版本中的 DynamicObjectDataSource。查看预览版时，它包含一个 Futures 程序集 Microsoft.Web.DynamicData.dll。

2.  使用 ASP.NET 4.0（现在处于 Beta 版）时，您可以调用新的扩展方法 EnableDynamicData()。请参阅 DD Preview 4 及更高版本附带的“SimpleDynamicDataSamples”项目。

这是该代码中的一个示例，它使用 ObjectDataSource 和名为“Product”的 POCO 类。

```
[MetadataType(typeof(Product.Metadata))]
public partial class Product {
    public class Metadata {
        [Required]
        public string ProductName { get; set; }
        [Range(0, 100)]
        public decimal UnitPrice { get; set; }
    }
}

public partial class ObjectDataSourceSample : System.Web.UI.Page {
    protected void Page_Init() {
        // Extension method syntax
        ProductsList.EnableDynamicData(typeof(Product));

        // Explicit syntax
        // MetaTable table = MetaTable.CreateTable(typeof(Product));
        // MetaTable.MapControl(ProductsList, table);
        // ProductsList.ColumnsGenerator = new DefaultAutoFieldGenerator(table);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T08:47:36.013

我的印象是您可以修改动态数据使用的 T4 模板（不确定是否可以删除数据访问部分）。

您是否看过仅单独使用 T4。

# c# - 我的网址编码有什么问题？

> ID：665354
> 
> 赞同：4
> 
> 时间：2009-03-20T08:38:15.863
> 
> 标签：c#, .net, asp.net-mvc, encoding

在我的 asp.net mvc 应用程序中，我创建了以下链接：

```
http://localhost:2689/en/Formula.mvc/351702++LYS+GRONN+5G+9%252f2++fds 
```

我收到错误 400（错误请求）。

我认为它在 %25 （正斜杠）处阻塞。
我究竟做错了什么？

**--EDIT 3--**
我尝试不编码任何东西，而是依赖 Url.RouteUrl() 的默认编码。
由于某种原因，这似乎没有对“/”进行编码。
如果我先自己编码，我最终会得到双重编码的 %252f。出于某种原因，这给了我一个不好的要求。为什么？！

**--EDIT 2--**
我生成了 URI 的最后一部分，如下所示：

1.  取 id.toString
2.  取 HttpUtility.UrlEncode(name)
3.  取 HttpUtility.UrlEncode(code)
4.  String.Format("{0}--{1}--{2}") 与前面部分的值
5.  将其作为参数添加到 Url.RouteUrl()

之后，我的操作再次获取此参数，将其拆分为 -- 并将 HttpUtility.Decode() 值返回。

我这样做是因为最后两个参数是可选的，但是是功能参数。如果它们是在上一步中定义的，则必须将它们带到其他页面。
不那么抽象：一种颜色可以有多个名称，但如果用户通过特定名称选择它，则应在所有其他页面中保留它。

**--EDIT 1--**
看起来 HttpUtility.UrlEncode() 和 Url.Encode() 返回不同的结果：S

如果我不编码“/”，它就充当分隔符=>那里没有运气。如果我用 Url.Encode() 编码它，我最终得到 %2F => Code 400 如果我用 HttpUtility.UrlEncode() 编码它，我最终得到 %25 => code 400

因为 400 甚至不让它通过 asp.net-mvc，所以路由调试器没有用:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-21T00:03:40.023

几天前我在那里。如果您可以在 URL 中接受不可读的路由值，请尝试以下操作： [URL-encoded slash in URL](https://stackoverflow.com/questions/591694/url-encoded-slash-in-url)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T08:53:57.370

`%25`实际上编码为“%”，因此`%252f`编码为“%2f”。

`%2f`（编码为“/”）在 URL 中是不允许的，除非您在网络服务器的配置中明确允许它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T08:44:17.893

你有没有运行路由调试器：http: [//haacked.com/archive/2008/03/13/url-routing-debugger.aspx](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T08:45:48.387

我没有过多地研究编码 - 但请注意，如果要将其*存储*在某个地方（或以某种方式采取行动），那么 POST 会更合适。如果右侧的文本实际上代表 id 为 351702 的数据（一个虚 url，很像`/665354/whats-wrong-with-my-url-encoding`），那么您应该对文本进行人性化处理。就像上面的空格一样。将其作为简单丢弃的路由中的单独级别也很常见。

通常，MVC url 应该是可理解的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T08:58:49.387

您不能使用正斜杠作为 URL 中的值。这是一篇关于创建浏览器和 SEO 友好 URLS 的好帖子 => [http://www.domincpettifer.co.uk/displayBlog.aspx?id=34](http://www.dominicpettifer.co.uk/displayBlog.aspx?id=34)

[编辑] 每当您创建路由时，都会将其与 URL 模式相关联（默认模式是 {controller}/{action}/{id}）。在这个 url 模式中，您应该使用正斜杠来分隔不同的标记。希望有帮助

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T09:06:44.110

W3Schools 工作正常：[http ://www.w3schools.com/TAGS/html_form_submit.asp?text=hello/world](http://www.w3schools.com/TAGS/html_form_submit.asp?text=hello/world)

这是 URL 编码参考：[http ://www.w3schools.com/TAGS/ref_urlencode.asp](http://www.w3schools.com/TAGS/ref_urlencode.asp)

# tags - 如何向我的博客软件添加标签建议功能？

> ID：665360
> 
> 赞同：0
> 
> 时间：2009-03-20T08:43:32.933
> 
> 标签：tags

我正在为在 cms 上运行的网站创建博客功能。

我的要求是这样的：

当一个人写了一篇文章时，他必须自动提供“建议标签”。这些话一定来自文章。我怎样才能实现这个功能？

我想到了一些想法。像：

1.  建议最长的单词。使用它，我可以过滤掉“a”、“of”、“my”等，但不能过滤掉“because”。
2.  创建单词黑名单。但是我找不到任何这样的现成列表，创建这样的列表需要很长时间。

那么，还有其他想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T09:00:11.257

你可以做[贝叶斯分类](http://en.wikipedia.org/wiki/Naive_Bayesian_classification)，看看会发生什么。这是一些[示例代码](http://jtauber.com/blog/2008/11/29/bayesian_classification_of_pages_on_this_site/)。

更新：这假设您有一些标签可供分类器选择。如果您需要初始化标签列表，这是一个从文本中提取关键字的[简单算法。](http://www.find-keyword.com/keyword_relevancy/)

# java - 有谁知道如何在 java j2me 中将日期字段转换为字符串？

> ID：665362
> 
> 赞同：1
> 
> 时间：2009-03-20T08:44:01.653
> 
> 标签：java, java-me

我需要从日期字段日历中获取数据，并能够将其显示在字符串中，然后将其存储在记录存储中。我尝试了 toString() 方法，但运行后出现错误。

```
 StartDate = new DateField("Start Date ", DateField.DATE);
        StartDate.setDate(Calendar.getInstance().getTime()); 
```

我现在有这个代码

```
 public static String dateToString (long date)
    {

     Calendar c = Calendar.getInstance() ;

     c.setTime(new Date(date));
     int y = c.get(Calendar.YEAR);
     int m = c.get(Calendar.MONTH) + 1; 
     int d = c.get(Calendar.DATE);
     String t = (y<10? "0": "")+y+"-"+(m<10? "0": "")+m+"-"+(d<10?
     "0": "")+d;
     return t;  
      } 
```

我怎样才能改变它，以便从 Startdate 获取日期并使其成为 t.？

如果有人可以帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T08:53:11.133

有一些[示例实现](http://www.velocityreviews.com/forums/t126578-p2-convert-date-to-string-with-j2me.html)可以帮助您入门，因为您的运行时似乎没有提供有用的`toString`实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T08:56:49.017

[这](http://www.roseindia.net/j2me/date-string.shtml)能解决你的问题吗？

> ```
> ...
>   date = new Date();
>   currentDate = new DateField("", DateField.DATE_TIME);
>   currentDate.setDate(date);
>   dateinstring = date.toString();
>   System.out.println("Date And Time Is In String Format: "+dateinstring);
> ... 
> ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T10:10:49.340

尝试使用这样的东西

```
 ...
   Calendar c = Calendar.getInstance() ;

   c.setTime(new Date(date));
   int y = c.get(Calendar.YEAR);
   int m = c.get(Calendar.MONTH) + 1; 
   int d = c.get(Calendar.DATE);

   Date t = c.getTime();
   String str = t.format("YY-MM-dd");
... 

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-23T14:14:09.577

首先需要将dateToString的参数类型改为Date： Public static String dateToString(Date date)

然后在 StartDate.setDate(Calendar.getInstance().getTime(); 之后添加这一行： String dateString = dateToString(StartDate.getDate());

好吧，至少这在我的 MIDlet 中有效。希望这会有所帮助。

问候，

瓦鱼阿

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-02T16:36:03.813

你可能想用这个：

> 公共字符串getDateFormat（日期inDate）{

```
String stDate = null;
String dd = null;
String mm = null;
String yyyy = null;
Calendar cd = Calendar.getInstance();
cd.setTime(inputDT);
int iD = cd.get( Calendar.DAY_OF_MONTH );
if (iD < 10){ dd = "0" + String.valueOf(iD); }
    else { dd = String.valueOf(iD); }
int iM = cd.get( Calendar.MONTH )+1;
    if (iM < 10){ mm = "0" + String.valueOf(iM); }
    else { mm = String.valueOf(iM); }
int iY = cd.get( Calendar.YEAR );
    yyyy = String.valueOf(iY);
stDate = yyyy+"-"+mm+"-"+dd;
return stDate; 
```

> }

要使“长”变量变为“日期”，请使用 java.util.Date 中的日期（长日期）}

# c# - 如何关闭计算机？

> ID：665385
> 
> 赞同：6
> 
> 时间：2009-03-20T08:55:29.893
> 
> 标签：c#, .net, windows, shutdown

如何使用 C# 关闭我的计算机？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-20T08:59:39.027

一个简单的方法：使用 Process.Start 运行 shutdown.exe。

```
 shutdown /s /t 0 
```

编程方式：P/Invoke 对[ExitWindowsEx的调用](http://msdn.microsoft.com/en-us/library/aa376868(VS.85).aspx)

这将是 P/Invoke 签名：

```
[DllImport("aygshell.dll", SetLastError="true")]
private static extern bool ExitWindowsEx(uint dwFlags, uint dwReserved); 
```

在任何情况下，运行代码的用户都需要关闭系统权限（通常不是问题，但需要记住的重要一点）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T09:15:50.220

不同的方法：

A. System.Diagnostics.Process.Start("关机", "-s -t 10");

B. Windows 管理规范 (WMI)

[http://www.csharpfriends.com/Forums/ShowPost.aspx?PostID=36953](http://www.csharpfriends.com/Forums/ShowPost.aspx?PostID=36953)

[http://www.dreamincode.net/forums/showtopic33948.htm](http://www.dreamincode.net/forums/showtopic33948.htm)

C. System.Runtime.InteropServices Pinvoke

[http://bytes.com/groups/net-c/251367-shutdown-my-computer-using-c](http://bytes.com/groups/net-c/251367-shutdown-my-computer-using-c)

D. 系统管理

[http://www.geekpedia.com/code36_Shut-down-system-using-Csharp.html](http://www.geekpedia.com/code36_Shut-down-system-using-Csharp.html)

投稿后，看到好多人也发了。。。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-20T09:21:27.070

[WindowsController](http://www.mentalis.org/soft/class.qpx?id=7)是 ExitWindowsEx 周围的 ac# 包装类。

> 有时您需要从应用程序中重新启动或关闭操作系统（例如，在安装程序之后）。.NET 框架为您提供了一种通过 System.Management 命名空间中的 Windows Management Instrumentation (WMI) 类重新启动计算机的间接方法，但是，它们的实现似乎存在一些问题。
> 
> 这就是我们创建 WindowsController 类的原因，该类实现了一些 API 函数来重新启动和关闭 Windows。它支持所有 ExitWindowsEx 模式，还可以休眠和挂起系统。
> 
> 此类在 C# 和 VB.NET 版本中可用。它可以编译为 .NET 模块或库，以便从其他 .NET 语言中使用。由于它依赖于 Windows API，因此无法在 Linux 或 FreeBSD 上运行。
> 
> (mentalis.org)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T09:03:44.680

使用[此处](https://stackoverflow.com/questions/484278/log-off-user-from-win-xp-programmatically-in-c/484360)显示的“用户注销”代码的变体。

该代码使用`ExitWindowsEx`API 调用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T09:00:12.253

猜测（未经测试）：

```
Process.Start("shutdown", "-s -t 0"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T09:07:12.457

艰难的方式，完美地在笔记本电脑上工作，虽然它需要一些时间：

```
Spawn a couple endless loops in more threads than cpu cores.
Wait for overheat which will automatically shutdown a computer. 
```

:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-11-04T12:22:02.993

您也可以使用 InitiateSystemShutdown

[http://www.pinvoke.net/default.aspx/advapi32.initiatesystemshutdown](http://www.pinvoke.net/default.aspx/advapi32.initiatesystemshutdown)

```
using System;
using System.Runtime.InteropServices;
using System.Text;

public class Program
{
    [DllImport( "advapi32.dll" ) ]
    public static extern bool InitiateSystemShutdown( string MachineName , string Message , uint Timeout , bool AppsClosed , bool Restart );

    [DllImport( "kernel32.dll" ) ]
    public static extern uint GetLastError();

    [DllImport( "kernel32.dll" ) ]
    public static extern uint FormatMessage( uint Flags , IntPtr Source , uint MessageID , uint LanguageID , StringBuilder Buffer , uint Size , IntPtr Args );

    public static void Main()
    {
        InitiateSystemShutdown(System.Environment.MachineName, "hello", 0, false, false);
        //InitiateSystemShutdown("localhost", "hello", 0, false, false);

    }
} 
```

# c# - 如何为多个 Web 应用程序使用单一登录

> ID：665386
> 
> 赞同：2
> 
> 时间：2009-03-20T08:56:08.253
> 
> 标签：c#, asp.net, membership, single-sign-on

我想登录 1 个应用程序并使用相同的登录令牌对第二个应用程序进行身份验证。我使用了相同的应用程序名称，因此两个应用程序都使用相同的成员资格提供程序.....

我有 2 个 Web 应用程序，使用 IIS 7.0 中托管的 asp.net 3.5、c#。我使用 aspnet_membership 提供程序进行身份验证/授权

它们作为 2 个单独的应用程序并排托管。问题是我可以登录一个应用程序并使用相同的登录对另一个应用程序进行身份验证......

提前致谢

斯图尔特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T09:05:15.737

单点登录解决方案背后的技术无法用几行代码来解释，它需要一些阅读/研究才能了解替代方案以及如何实现它们。

例如，您可以查看[这篇](http://msdn.microsoft.com/en-us/magazine/cc163520.aspx)关于 Single Sign-On using [Active Directory Federation Services](http://technet.microsoft.com/en-us/library/cc736690.aspx)的文章。

**更新：**
这是一篇[关于使用表单身份验证的单点登录](http://weblogs.asp.net/hernandl/archive/2004/06/09/ssoformsauth.aspx)的博文。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T09:19:22.613

它称为单点登录 - SSO，如果您的应用程序托管在同一个域（app1.domain.com 和 app2.domain.com - 或 - domain.com/app1 和 domain.com/app2）上，它的操作相当简单，这样做相当简单。

当您使用表单身份验证创建 cookie 时，将域设置为“.domain.com”。此外，两个应用程序都必须在 web.config 中使用相同的机器密钥。

查看[http://www.codeproject.com/KB/web-security/aspnetsinglesignon.aspx](http://www.codeproject.com/KB/web-security/aspnetsinglesignon.aspx)和[http://weblogs.asp.net/hernandl/archive/2004/06/09/ssoformsauth.aspx](http://weblogs.asp.net/hernandl/archive/2004/06/09/ssoformsauth.aspx)

# ruby-on-rails - 在导轨下使用 rspec 切换 test::unit

> ID：665387
> 
> 赞同：4
> 
> 时间：2009-03-20T08:56:47.380
> 
> 标签：ruby-on-rails, ruby, unit-testing, testing, rspec

> **可能重复：**
> [如何删除单元测试并用 rspec 替换它？](https://stackoverflow.com/questions/5072662/how-to-remove-unit-test-and-replace-it-with-rspec)

这里有点奇怪的问题：当您使用 rpsec 而不是 test::unit on rails 时，您如何处理测试目录？保留它（可能有任何兼容性问题？）或删除它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T11:37:09.460

我一直保留它，以防某些插件或生成器希望在那里找到它。

如果您不喜欢 test 目录，我建议您尝试将其删除，看看它是否有效。如果您发现需要它，您可以随时重新创建它。

# c# - 是否可以在运行时修改配置 ConnectionStrings？

> ID：665392
> 
> 赞同：1
> 
> 时间：2009-03-20T08:59:06.220
> 
> 标签：c#, configuration, web-config, app-config, connection-string

是否可以在运行时修改 app.config/web.config 中定义的连接字符串？我想根据运行应用程序/站点的机器使用不同的配置文件（当然，仅用于调试目的。我们将在部署时使用常规配置文件）。

我可以编写 AppSettings，但不能编写 ConnectionStrings (AFAIK)。或者我可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T10:35:27.143

是的，这是可能的，但 AFAIK 只能通过反射。以下代码应该可以满足您的需求（请阅读下文了解用法）：

```
public static string SetConnectionString(Type assemblyMember,
                                         Type settingsClass,
                                         string newConnectionString,
                                         string connectionStringKey)
{
  Type typSettings = Type.GetType(Assembly.CreateQualifiedName(assemblyMember.Assembly.FullName, settingsClass.FullName));

  if (typSettings == null)
  {
    return null;
  }

  PropertyInfo prpDefault = typSettings.GetProperty("Default", BindingFlags.Static | BindingFlags.Public);

  if (prpDefault == null)
  {
    return null;
  }

  object objSettings = prpDefault.GetValue(null, null);

  if (objSettings == null)
  {
    return null;
  }

  // the default property, this[], is actually named Item
  PropertyInfo prpItem = objSettings.GetType().GetProperty("Item", BindingFlags.Instance | BindingFlags.Public);

  if (prpItem == null)
  {
    return null;
  }

  object[] indexerName = { connectionStringKey };
  string oldConnectionString = (string)prpItem.GetValue(objSettings, indexerName);

  prpItem.SetValue(objSettings, newConnectionString, indexerName);

  return oldConnectionString;
} 
```

`assemblyMember` 是调用类型
`settingsClass` 是您的设置类型是要设置
`newConnectionString`的完整字符串
`connectionStringKey`是您在应用程序设置中定义的连接字符串的名称

您应该在应用程序启动后尽快调用此方法，最好是在 Main() 方法中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T09:22:08.987

您无法真正编辑正在运行的进程的配置文件。

一种选择（有利有弊）是在 machine.config 或主 web.config 中使用配置数据（对于“站点”，您使用“位置”节点）——不过，这不是一个匆忙的选项。

处理此问题的更好方法是将配置文件作为构建/部署过程的一部分进行交换，理想情况下是自动化的。这样，一切都是独立的，您可以“robocopy”到普通服务器并让它工作。

* * *

重新考虑您的“每个开发人员”点；我发现最简单的方法是标准化配置并调整机器。例如，我们在 VM 上运行本地 Web 服务器；我们不是针对每台机器编写代码，而是对“localserver”进行标准化（镜像“localhost”），并向开发人员可以控制的每台机器添加本地 DNS 记录。请注意，这需要固定的 IP 地址（或者可能是 DHCP 预留）以防止它随着时间的推移而改变！

同上数据库；本地服务器可以使用“.”；远程服务器可以在机器上使用别名，因此“devserver”指向用户想要的任何内容。

只是一个想法...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T09:31:59.807

我在我的项目中尝试过一次以进行调试但无法做到，问题（我想，如果我错了，请纠正我）是在应用程序启动时 app.config 被加载到内存中，对 app.config 的任何更改在应用程序运行时不会得到反映。

为了克服这个问题，我在 app.config 中定义了所有连接字符串，然后在程序像这样运行时调用所需的连接字符串。

例如，假设您在 app.config 中定义了您的连接字符串，如下所示。

```
<connectionStrings>
    <add name="YourNameSpace.Properties.Settings.ConnectionString_1"
        connectionString="Provider=Microsoft.Jet.OLEDB.4.0;Data  
        Source=|DataDirectory|\file.mdb"
        providerName="System.Data.OleDb"/>

    <add name="YourNameSpace.Properties.Settings.ConnectionString_2"
        connectionString="Provider=Microsoft.Jet.OLEDB.4.0;Data  
        Source=|DataDirectory|\file.mdb"
        providerName="System.Data.OleDb"/>

</connectionStrings> 
```

定义任意数量（您正在调试正确:-)）然后在代码中调用这些连接设置执行以下操作：

YourNameSpace.Properties.Settings foo = new YourNameSapce.Properties.Settings();

foo.ConnectionString_1;

高温高压

最好的祝福

@nand

PS：这个回复是针对C#的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T09:53:29.410

安装网站时，您可以在 NAnt 脚本中运行 xmlpoke。

例如

1.  使用网站部署 NAnt。
2.  创建一个调用 NAnt 的 go.bat，它会安装站点并执行 xmlpoke 以使用基于服务器名称或其他一些参数的设置来修改 web.config。

# javascript - 如何阻止“返回”和“刷新”按钮重新提交我的表单？

> ID：665399
> 
> 赞同：26
> 
> 时间：2009-03-20T09:01:29.303
> 
> 标签：javascript, browser, double-submit-prevention

我正在做网络开发。

我有一个与信用卡有关的页面，当用户单击“刷新”或“返回”时，交易将再执行一次，这是不需要的。

这包括浏览器左上角的“返回”和“刷新”按钮，“右键单击->刷新/返回”，按“F5”键。这只能在某些 cgi 页面上完成，而不是全部。

这可以使用Javascript来完成吗？还是有什么其他方法？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-03-20T09:03:38.860

[标准方法](http://en.wikipedia.org/wiki/Post/Redirect/Get)是分 3 步完成。

1.  表单页面提交字段到处理页面
2.  处理页面处理数据并重定向到结果页面
3.  结果页面只显示结果，重新加载它不会造成任何伤害。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-20T09:15:27.320

这打破了基本的浏览器用户体验模型......用户应该始终能够在他们的浏览器中使用刷新和返回按钮。建议您以另一种方式修复您的页面。

如果您更新您的问题以包含您正在使用的服务器语言/平台/技术，那么有人可能会提出解决方案。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-03-20T09:20:05.247

重新提交表单会产生重复交易这一简单事实令人担忧。您应该进行某种检查以确保每次提交的表单数据都是唯一的。

例如，提交表单的页面应该被赋予一个与表单一起提交的唯一 ID。然后业务逻辑应该能够识别出提交的表单已经被处理（因为（不再）唯一 ID 将是相同的），因此忽略第二次尝试。

“标准方式”仍然不会阻止客户两次单击后退按钮......甚至如果他们不认为（无论出于何种原因）它已被处理，则返回并重新提交表单。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-08-08T12:47:14.097

1.  生成一个随机字符串并将其存储在会话中，

2.  然后将其作为隐藏值输出到您的表单中，

3.  检查提交和存储变量，如果匹配处理您的请求，

4.  转到 1。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-08T01:37:46.963

将此代码放在表单页面上

```
Response.Cache.SetCacheability(HttpCacheability.NoCache);

Response.Cache.SetExpires(DateTime.Now-new TimeSpan(1,0,0));

Response.Cache.SetLastModified(DateTime.Now);

Response.Cache.SetAllowResponseInBrowserHistory(false); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-20T09:18:34.050

您不应该尝试“阻止”这些操作。您应该做的是确保当有人“双重提交”表单时不会发生任何事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-20T09:20:07.667

在某些浏览器中你甚至不能这样做，这很好！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-20T09:21:19.240

最好的方法是拥有足够的会话处理逻辑，您可以将第二次（及以后）尝试识别为“这只是重新提交”并忽略它。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-05-22T23:59:31.627

我没有在这里看到这个，所以在这里。

1.  在表单中放置一个唯一的令牌。
2.  提交按钮触发对服务器的 xmlhttp(ajax) 请求，以创建一个以令牌命名的会话变量，其存储值为 1。
3.  ajax 请求在收到肯定的状态更改后提交表单。
4.  表单处理脚本检查存储值为 1 的会话变量。
5.  该脚本删除会话变量并处理表单。

如果未找到会话变量，则不会处理该表单。由于该变量一经发现就被删除，因此只能通过按下提交按钮来运行该表单。刷新和返回不会提交表单。这将在不使用重定向的情况下工作。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-11-22T01:21:25.753

我发现上面的 Post/Redirect/Get 解释有点模棱两可

这是我所遵循的，希望它对将来的人有所帮助

[http://wordsideasandthings.blogspot.ca/2013/04/post-redirect-get-pattern-in-php.html](http://wordsideasandthings.blogspot.ca/2013/04/post-redirect-get-pattern-in-php.html)

基本上基于上述解决方案的过程是：

1.  从 FORM 页面提交到处理页面（或自身）
2.  处理数据库或支付处理等
3.  *如果需要，将用户反馈消息、可能的错误消息等存储在会话变量中*
4.  将标题重定向到结果页面（或原始表单页面）。*如果需要，从处理页面显示自定义消息。如“错误信用卡支付被拒绝”*，并重置会话变量。

使用以下内容重定向：

```
header("HTTP/1.1 303 See Other");
header("Location: http://$_SERVER[HTTP_HOST]/yourfilehere.php");
die(); 
```

标头重定向将在“yourfilehere.php”上发起`GET`请求，因为重定向只是从服务器获取数据的“请求”，而不是向`POST`服务器提交数据的“请求”。因此，重定向/`GET`防止在刷新后发生任何进一步的 DB/支付处理。错误状态将`301`有助于按下后退按钮。

有用的阅读：

1.  [http://en.wikipedia.org/wiki/URL_redirection#HTTP_status_codes_3xx](http://en.wikipedia.org/wiki/URL_redirection#HTTP_status_codes_3xx)
2.  [http://www.theserverside.com/news/1365146/Redirect-After-Post](http://www.theserverside.com/news/1365146/Redirect-After-Post)
3.  [http://wordsideasandthings.blogspot.ca/2013/04/post-redirect-get-pattern-in-php.html](http://wordsideasandthings.blogspot.ca/2013/04/post-redirect-get-pattern-in-php.html)
4.  [https://en.wikipedia.org/wiki/HTTP#Request_methods](https://en.wikipedia.org/wiki/HTTP#Request_methods)
5.  [http://en.wikipedia.org/wiki/Post/Redirect/Get](http://en.wikipedia.org/wiki/Post/Redirect/Get)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-20T09:16:33.057

vartec:s 解决方案解决了重新加载问题，而不是返回问题，所以这里有一个解决方案：

1.  表单页面设置会话变量，例如 session("fromformpage")=1
2.  处理页面检查会话变量，如果其=“1”，则处理数据并重定向到结果页面，如果不是=“1”，则仅重定向到结果页面。
3.  结果页面将会话变量设置为“”。

然后如果用户按下返回按钮，处理页面将不再进行处理，只会重定向到处理页面。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-12-17T10:21:46.147

只需将此javascript放在头部分上方的aspx页面的html部分

```
<script type = "text/javascript" >
function disableBackButton()
{
window.history.forward();
}
setTimeout("disableBackButton()", 0);
</script> 
```

我们需要把它放在我们想要阻止用户通过点击后退按钮访问的页面的 html 部分

页面的完整代码如下所示

```
<%@ Page Language="C#" AutoEventWireup="true"
CodeFile="Default.aspx.cs" Inherits="_Default" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
<title>Untitled Page</title>
<script type = "text/javascript" >
function disableBackButton()
{
window.history.forward();
}
setTimeout("disableBackButton()", 0);
</script>
</head>
<body onload="disableBackButton()">
<form id="form1" runat="server">
<div>
This is First page <br />
<br />
Go to Second page
<br />
<br />
<asp:LinkButton ID="LinkButton1" runat="server"
PostBackUrl="~/Default2.aspx">Go to Second Page
</asp:LinkButton></div>
</form>
</body>
</html> 
```

> 如果您使用的是 firefox，请使用而不是 onload

**如果要使用 aspx 页面后面的代码禁用后退按钮，则需要在后面编写下面提到的代码 C# 代码**

```
protected override void OnPreRender(EventArgs e)
{
base.OnPreRender(e);
string strDisAbleBackButton;
strDisAbleBackButton = "<script language="javascript">\n";
strDisAbleBackButton += "window.history.forward(1);\n";
strDisAbleBackButton += "\n</script>";
ClientScript.RegisterClientScriptBlock(this.Page.GetType(), "clientScript", strDisAbleBackButton);
} 
```

**我们也可以通过在 Page_load 事件或 Page_Init 事件中编写这行代码来禁用浏览器缓存或缓存来实现这一点**

```
protected void Page_Init(object Sender, EventArgs e)
{
Response.Cache.SetCacheability(HttpCacheability.NoCache);
Response.Cache.SetExpires(DateTime.Now.AddSeconds(-1));
Response.Cache.SetNoStore();
} 
```

> 这样做，用户将在点击浏览器的返回按钮时收到页面已过期消息

演示是：

![在此处输入图像描述](https://i.stack.imgur.com/z4Utl.gif)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-07-25T12:16:57.197

此代码适用于不从当前页面返回我..

在这里，我放了一个可以帮助您的代码，而不是打开上下文菜单，并且在浏览器重新加载时询问您是否离开页面...

我正在尝试询问单击浏览器后退按钮

```
jQuery( document ).ready(function() {

    document.onkeydown = fkey;
    document.onkeypress = fkey
    document.onkeyup = fkey;

    var wasPressed = false;

    function fkey(e){
        e = e || window.event;
        //alert(e.keyCode);
        if( wasPressed ) return; 

        if (e.keyCode == 116 || e.keyCode == 8 || e.keyCode == 17) {
                     // alert("f5 pressed");
                      window.onbeforeunload = null;
                      return true;
                 }

    }
window.onbeforeunload = function (event) {
    var message = ''; // Type message here

    if (typeof event == 'undefined') {
        event = window.event;
    }
    if (event) {
        event.returnValue = message;
    }

    return message;
};

jQuery(function () {

    jQuery("a").click(function () {
        window.onbeforeunload = null;
    });

    jQuery(".btn").click(function () {
        window.onbeforeunload = null;
    });

    //Disable part of page
    $(document).on("contextmenu",function(e){
        return false;
    });
});}); 
```

谢谢，

# database - Linq 到具有大数据库的实体

> ID：665402
> 
> 赞同：1
> 
> 时间：2009-03-20T09:03:17.597
> 
> 标签：database, nhibernate, entity-framework, ms-access, linq-to-entities

我们即将开始一个项目，该项目涉及使用具有数十万条记录的 Sql Server 2005。过去我使用 NHibernate 取得了不错的效果。但现在我正在评估 Linq 到实体的数据访问。我有这些关于 L2E 的问题，

1.  L2E 的缓存与 NHibernate 相比有多好（基本上性能如何）？
2.  使用单个 .edmx 文件有多容易（我们可能有多个开发人员同时处理这些文件）？如果我们决定拆分文件，这样做有多容易，有什么缺点？
3.  模拟生成的类有多容易？
4.  是否支持 MS Access？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T09:18:24.970

1.  Linq2Entities 不做任何隐式缓存。当您运行查询时，它会将 Linq 转换为 SQL 查询，执行它并返回结果。就是这么简单。

2.  您不能将模型拆分为多个 EDMX 文件。好吧，你可以，但你会失去实体之间的关系。如果您的数据库包含多个不相互依赖的实体组，您可以这样做。

3.  不是特别的。我们有一个模拟出`ObjectContext`拦截调用的系统（我们使用一个接口来进行实体访问，它`ObjectContext`在运行时映射到真实，在单元测试时映射到模拟`ObjectContext`。

4.  确实如此，但您必须自己创建实体（您不能从数据库中生成它们）。

# java - 如何在 BufferedImage 中使颜色透明并另存为 PNG

> ID：665406
> 
> 赞同：29
> 
> 时间：2009-03-20T09:03:55.053
> 
> 标签：java, image, colors, png, transparent

我一直在网上搜索这个，但我没有找到任何体面的帮助。

我有一个 BufferedImage，我用 ImageIO 读过它。现在我想将该图像中的某种颜色设置为透明，并将图像保存为PNG。

我知道出于显而易见的原因我不能仅仅“绘制”透明颜色，所以我猜我需要某种过滤器。

有人为此提供了一些示例代码吗？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-03-20T09:12:38.480

我最近这样做是为了回答我的项目经理的一个问题。
将灰色转换为透明度的函数是：

```
 private Image TransformGrayToTransparency(BufferedImage image)
  {
    ImageFilter filter = new RGBImageFilter()
    {
      public final int filterRGB(int x, int y, int rgb)
      {
        return (rgb << 8) & 0xFF000000;
      }
    };

    ImageProducer ip = new FilteredImageSource(image.getSource(), filter);
    return Toolkit.getDefaultToolkit().createImage(ip);
  } 
```

实际上，它作用于灰度图像，所以我只是将一个 RGB 分量（R 分量）复制到 alpha，丢弃与我的情况相同的其他分量。
您可以调整它以过滤特定颜色，例如。用相等或范围等测试。
当然，BufferedImage 必须是 BufferedImage.TYPE_INT_ARGB 类型。

我不解决保存的问题，因为它非常简单，但我也可以添加此代码页。

[编辑] 将图像转换为 BufferedImage：

```
BufferedImage dest = new BufferedImage(
    imageWidth, imageHeight,
    BufferedImage.TYPE_INT_ARGB);
Graphics2D g2 = dest.createGraphics();
g2.drawImage(image, 0, 0, null);
g2.dispose(); 
```

[编辑 2] 我是在 Christoffer 发布他的完整解决方案之后来的，但这是我的，我展示了如何使一系列颜色透明。可以改进，例如。而是使用 HSB 组件。

```
import java.awt.*;
import java.awt.image.BufferedImage;
import java.awt.image.FilteredImageSource;
import java.awt.image.ImageFilter;
import java.awt.image.ImageProducer;
import java.awt.image.RGBImageFilter;
import java.io.*;

import javax.imageio.ImageIO;

public class AddTransparency
{
  AddTransparency() throws IOException
  {
    String imagePath = "E:/Documents/images/";
    File inFile = new File(imagePath, "map.png");
    BufferedImage image = ImageIO.read(inFile);

    Image transpImg1 = TransformGrayToTransparency(image);
    BufferedImage resultImage1 = ImageToBufferedImage(transpImg1, image.getWidth(), image.getHeight());

    File outFile1 = new File(imagePath, "map_with_transparency1.png");
    ImageIO.write(resultImage1, "PNG", outFile1);

    Image transpImg2 = TransformColorToTransparency(image, new Color(0, 50, 77), new Color(200, 200, 255));
    BufferedImage resultImage2 = ImageToBufferedImage(transpImg2, image.getWidth(), image.getHeight());

    File outFile2 = new File(imagePath, "map_with_transparency2.png");
    ImageIO.write(resultImage2, "PNG", outFile2);
  }

  private Image TransformGrayToTransparency(BufferedImage image)
  {
    ImageFilter filter = new RGBImageFilter()
    {
      public final int filterRGB(int x, int y, int rgb)
      {
        return (rgb << 8) & 0xFF000000;
      }
    };

    ImageProducer ip = new FilteredImageSource(image.getSource(), filter);
      return Toolkit.getDefaultToolkit().createImage(ip);
  }

  private Image TransformColorToTransparency(BufferedImage image, Color c1, Color c2)
  {
    // Primitive test, just an example
    final int r1 = c1.getRed();
    final int g1 = c1.getGreen();
    final int b1 = c1.getBlue();
    final int r2 = c2.getRed();
    final int g2 = c2.getGreen();
    final int b2 = c2.getBlue();
    ImageFilter filter = new RGBImageFilter()
    {
      public final int filterRGB(int x, int y, int rgb)
      {
        int r = (rgb & 0xFF0000) >> 16;
        int g = (rgb & 0xFF00) >> 8;
        int b = rgb & 0xFF;
        if (r >= r1 && r <= r2 &&
            g >= g1 && g <= g2 &&
            b >= b1 && b <= b2)
        {
          // Set fully transparent but keep color
          return rgb & 0xFFFFFF;
        }
        return rgb;
      }
    };

    ImageProducer ip = new FilteredImageSource(image.getSource(), filter);
      return Toolkit.getDefaultToolkit().createImage(ip);
  }

  private BufferedImage ImageToBufferedImage(Image image, int width, int height)
  {
    BufferedImage dest = new BufferedImage(
        width, height, BufferedImage.TYPE_INT_ARGB);
    Graphics2D g2 = dest.createGraphics();
    g2.drawImage(image, 0, 0, null);
    g2.dispose();
    return dest;
  }

  public static void main(String[] args) throws IOException
  {
    AddTransparency at = new AddTransparency();
  }
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-20T09:33:29.303

感谢 PhilLo，这里是我的演示应用程序的完整解决方案。

```
public static void main(String[] args) throws Exception {

        File in = new File("C:\\Users\\Christoffer\\Desktop\\christoffer.jpg");
        BufferedImage source = ImageIO.read(in);

        int color = source.getRGB(0, 0);

        Image image = makeColorTransparent(source, new Color(color));

        BufferedImage transparent = imageToBufferedImage(image);

        File out = new File("C:\\Users\\Christoffer\\Desktop\\trans.PNG");
        ImageIO.write(transparent, "PNG", out);

    }

    private static BufferedImage imageToBufferedImage(Image image) {

        BufferedImage bufferedImage = new BufferedImage(image.getWidth(null), image.getHeight(null), BufferedImage.TYPE_INT_ARGB);
        Graphics2D g2 = bufferedImage.createGraphics();
        g2.drawImage(image, 0, 0, null);
        g2.dispose();

        return bufferedImage;

    }

    public static Image makeColorTransparent(BufferedImage im, final Color color) {
        ImageFilter filter = new RGBImageFilter() {

            // the color we are looking for... Alpha bits are set to opaque
            public int markerRGB = color.getRGB() | 0xFF000000;

            public final int filterRGB(int x, int y, int rgb) {
                if ((rgb | 0xFF000000) == markerRGB) {
                    // Mark the alpha bits as zero - transparent
                    return 0x00FFFFFF & rgb;
                } else {
                    // nothing to do
                    return rgb;
                }
            }
        };

        ImageProducer ip = new FilteredImageSource(im.getSource(), filter);
        return Toolkit.getDefaultToolkit().createImage(ip);
    } 
```

# jasper-reports - Jasper 报告使用相同的模板以 CSV 和 PDF 格式呈现

> ID：665412
> 
> 赞同：3
> 
> 时间：2009-03-20T09:06:17.620
> 
> 标签：jasper-reports

我们使用一个模板以 CSV 和 PDF 格式呈现报告。但问题是我们需要将报告拆分为 PDF 格式的页面，而不是 CSV 格式的页面。是否可以根据一个模板中的格式更改呈现选项。这样我们就有了没有分页信息的CSV和分页的PDF。在这种情况下，应该使用 2 个单独的模板，一个用于 CSV，一个用于 PDF？或者这可以使用一个模板来实现？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T05:49:51.800

终于找到了答案。在模板中需要设置以下属性

```
<property name="net.sf.jasperreports.export.csv.exclude.origin.keep.first.band.columnHeader" value="columnHeader" />
<property name="net.sf.jasperreports.export.csv.exclude.origin.band.columnFooter" value="columnFooter" />
<property name="net.sf.jasperreports.export.csv.exclude.origin.band.pageFooter" value="pageFooter" />
<property name="net.sf.jasperreports.export.csv.exclude.origin.band.lastPageFooter" value="lastPageFooter" />
<property name="net.sf.jasperreports.export.csv.exclude.origin.band.summary" value="summary" /> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-13T10:43:35.350

使用[JRCsvMetadataExporter](http://jasperreports.sourceforge.net/api/net/sf/jasperreports/engine/export/JRCsvMetadataExporter.html)解决了类似的问题。此类从模板中提取数据，忽略渲染部分。[在此处](http://jasperreports.sourceforge.net/sample.reference/jasper/index.html#csvmetadataexport)查看示例

# c# - 我们的 SQL 或实体框架中的错误？

> ID：665413
> 
> 赞同：2
> 
> 时间：2009-03-20T09:06:37.620
> 
> 标签：c#, sql-server-2005, entity-framework

我有一些来自我们的 DBA 的 SQL，我只是在检查它是否正确，因为 EF 似乎没有将实体完全链接在一起。它知道存在关系，但不执行 FK 到 PK 链接。

任何想法或想法（而不是使用 NHibernate！）都值得赞赏。

```
1 创建表 [dbo].[雇员](
2 [ID] [int] IDENTITY(1,1) NOT FOR REPLICATION NOT NULL,
3 [PersonID] [int] 非空，
4 [性别ID] [int] NULL，
5 [EthnicOriginID] [int] NULL，
6 [婚姻状态ID] [int] NULL，
7 [出生日期] [日期时间] NULL，
8 [离开日期] [日期时间] NULL，
9 [OptOut] [bit] NULL CONSTRAINT [DF_employee_OptOut] DEFAULT (0),
10 [OptOutDate] [日期时间] NULL，
11 [PassportNumber] [nvarchar](50) NULL，
12 [WorkPermitNumber] [nvarchar](50) 空值，
13 [WorkPermitExpiryDate] [日期时间] NULL，
14 [PayrollNumber] [nvarchar](50) NULL，
15 [NINumber] [nvarchar](50) 空值，
16 [Visa] [bit] NULL CONSTRAINT [DF_employee_Visa] DEFAULT (0),
17 [VisaNumber] [nvarchar](50) 空值，
18 [VisaExpiryDate] [smalldatetime] NULL，
19 [GuaranteeAmount] [money] NULL,
20 [GuaranteeDuration] [int] NULL，
21 [保证结束日期] [日期时间] NULL，
22 [GuaranteePeriod] [int] NULL，
23 [IsDisabled] [bit] NULL 约束 [DF_employee_IsDisabled] 默认 (0)，
24 [DisabilityReferenceNumber] [nvarchar](20) NULL，
25 [IsActive] [bit] NULL 约束 [DF_employee_Active] 默认 (1),
26 [IsUKResident] [位] NULL，
27 [银行帐户] [nvarchar](100) NULL，
28 约束 [PK_employee] 主键集群  
29 (
30 [ID] ASC
31）与（PAD_INDEX = OFF，STATISTICS_NORECOMPUTE = OFF，IGNORE_DUP_KEY = OFF，ALLOW_ROW_LOCKS = ON，ALLOW_PAGE_LOCKS = ON）ON [PRIMARY]，
32 约束 [IX_employee] 唯一非集群  
33 (
34 [ID] ASC
35）与（PAD_INDEX = OFF，STATISTICS_NORECOMPUTE = OFF，IGNORE_DUP_KEY = OFF，ALLOW_ROW_LOCKS = ON，ALLOW_PAGE_LOCKS = ON）ON [主要]
36) 开 [主要]
37   
38 去
39 ALTER TABLE [dbo].[Employee] WITH NOCHECK ADD CONSTRAINT [FK_Employee_People] 外键（[PersonID]）
40 参考文献 [dbo].[Person] ([Id])
41 不可复制  
42 去
43 ALTER TABLE [dbo].[Employee] NOCHECK 约束 [FK_Employee_People]
44   
45   
46 ----
47   
48 创建表 [dbo].[EmployeeWorkHistory](
49 [id] [int] IDENTITY(1,1) NOT FOR REPLICATION NOT NULL,
50 [EmployeeId] [int] 非空，
51 [职位名称] [nvarchar](50) 空值，
52 [OfficeId] [int] NULL，
53 [部门ID] [int] NULL，
54 [开始日期] [小日期时间] NULL，
55 [结束日期] [小日期时间] NULL，
56 [工资] [十进制](18, 0) NULL,
57 [ContractTypeId] [int] NULL，
58 [评论ID] [int] NULL，
59 [工作时间] [浮点数] NULL，
60 [ManagerEmployeeID] [int] NULL，
61 [EmployeeTypeID] [int] NULL，
62 [LastWorkingDay] [smalldatetime] NULL，
63 [GardenLeave] [位] NULL 约束 [DF_employeeWorkHistory_GardenLeave] 默认 (0)，
64 [WorkingHours] [nvarchar](20) 空约束 [DF_EmployeeWorkHistory_WorkingHours] 默认（'8.30am - 5.30pm'），
65 [WorkingDays] [nvarchar](100) NULL CONSTRAINT [DF_EmployeeWorkHistory_WorkingDays] DEFAULT ('Monday to Friday'),
66 [TerminationId] [int] NULL，
67 [终止日期] [小日期时间] NULL，
68 约束 [PK_employeeWorkHistory] ​​主键集群  
69 (
70 [编号] ASC
71）与（PAD_INDEX = OFF，STATISTICS_NORECOMPUTE = OFF，IGNORE_DUP_KEY = OFF，ALLOW_ROW_LOCKS = ON，ALLOW_PAGE_LOCKS = ON）ON [主要]
72) 开 [主要]
73   
74 去
75 EXEC sys.sp_addextendedproperty @name=N'MS_Description'，@value=N''，@level0type=N'SCHEMA'，@level0name=N'dbo'，@level1type=N'TABLE'，@level1name=N'EmployeeWorkHistory ', @level2type=N'COLUMN',@level2name=N'WorkingHours'
76 去
77 ALTER TABLE [dbo].[EmployeeWorkHistory] ​​WITH NOCHECK 添加约束 [FK_EmployeeWorkHistory_ContractType] 外键（[ContractTypeId]）
78 参考 [dbo].[ContractType] ([Id])
79 不可复制  
80 去
81 ALTER TABLE [dbo].[EmployeeWorkHistory] ​​检查约束 [FK_EmployeeWorkHistory_ContractType]
82 去
83 ALTER TABLE [dbo].[EmployeeWorkHistory] ​​WITH NOCHECK 添加约束 [FK_EmployeeWorkHistory_Employee] 外键（[EmployeeId]）
84 参考 [dbo].[雇员] ([ID])
85 不可复制  
86 去
87 ALTER TABLE [dbo].[EmployeeWorkHistory] ​​检查约束 [FK_EmployeeWorkHistory_Employee]
88 去
89   
90   
91 ------
92   
93   
94 创建表[dbo].[合同类型]（
95 [Id] [int] IDENTITY(1,1) NOT FOR REPLICATION NOT NULL,
96 [文本] [nvarchar](50) 非空，
97 [IsActive] [bit] 非空约束 [DF_ContractType_IsActive] 默认 (1)，
98 约束 [PK_ContractType] 主键集群  
99 (
100 [编号] ASC
101）与（PAD_INDEX = OFF，STATISTICS_NORECOMPUTE = OFF，IGNORE_DUP_KEY = OFF，ALLOW_ROW_LOCKS = ON，ALLOW_PAGE_LOCKS = ON，FILLFACTOR = 100）ON [主要]
102) 开 [主要]
103  
104 --
105  
106 创建表 [dbo].[EmployeeReference]（
107 [ID] [int] IDENTITY(1,1) 非空，
108 [EmployeeID] [int] 非空，
109 [RefereePersonID] [int] 非空，
110 [公司] [nvarchar](200) 空值，
111 [评论ID] [int] NULL，
112 [日期请求] [小日期时间] NULL，
113 [日期接收] [小日期时间] NULL，
114 [TimeKnownFor] [nvarchar](100) 空值，
115 [参考文档] [nvarchar]（500）NULL，
116 [ReferenceTypeID] [int] 非空，
117 [文件附件ID] [int] NULL，
118 [ContactDetailId] [int] NULL，
119 约束 [PK_EmployeeReference] 主键集群  
120 (
121 [ID] ASC
122）与（PAD_INDEX = OFF，STATISTICS_NORECOMPUTE = OFF，IGNORE_DUP_KEY = OFF，ALLOW_ROW_LOCKS = ON，ALLOW_PAGE_LOCKS = ON）ON [主要]
123）开[主要]
124  
125 去
126 ALTER TABLE [dbo].[EmployeeReference] WITH NOCHECK 添加约束 [FK_EmployeeReference_Person] 外键（[RefereePersonID]）
127 参考文献 [dbo].[Person] ([Id])
128 不可复制  
129 去
130 更改表 [dbo].[EmployeeReference] NOCHECK 约束 [FK_EmployeeReference_Person]
131 去
132 ALTER TABLE [dbo].[EmployeeReference] WITH NOCHECK 添加约束 [FK_EmployeeReferenceMapping_Employee] 外键（[EmployeeID]）
133 参考 [dbo].[雇员] ([ID])
134 不可复制  
135 去
136 ALTER TABLE [dbo].[EmployeeReference] NOCHECK 约束 [FK_EmployeeReferenceMapping_Employee]
137  
138——
139  
140  
141创建表[dbo]。[人]（
142 [Id] [int] IDENTITY(1,1) NOT FOR REPLICATION NOT NULL,
第143章
144 [名字] [nvarchar]（50）空，
145 [中间名] [nvarchar](50) NULL，
146 [姓氏] [nvarchar]（50）NULL，
147 [首选名称] [nvarchar]（50）NULL，
148 [ContactDetailId] [int] NULL，
第149章
150 [IsActive] [位] 非空约束 [DF_people_Active] 默认 (1)，
151 [EnteredBy] [int] NULL，
152 [输入日期] [日期时间] NULL，
153 [更新者] [int] NULL，
154 [更新日期] [日期时间] NULL，
155约束[PK_person]主键集群  
156 (
第157章
158）WITH（PAD_INDEX = OFF，STATISTICS_NORECOMPUTE = OFF，IGNORE_DUP_KEY = OFF，ALLOW_ROW_LOCKS = ON，ALLOW_PAGE_LOCKS = ON）ON [PRIMARY]
第159章
160  
161 去
第162章
163  

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T09:12:47.980

您已经在外键约束上定义了 NOCHECK

```
 ALTER TABLE [dbo].[Employee] NOCHECK CONSTRAINT [FK_Employee_People] 
```

另外，您在 Employee 上有一个重复的索引。

# .net - Linq-to-Sql 中的顺序 GUID？

> ID：665417
> 
> 赞同：20
> 
> 时间：2009-03-20T09:07:28.663
> 
> 标签：.net, nhibernate, linq-to-sql, guid

我刚刚阅读了[一篇](http://devlicious.com/blogs/tuna_toksoz/archive/2009/03/20/nhibernate-poid-generators-revealed.aspx)关于 NHibernate 从系统时间 (Guid.Comb) 创建 GUID 的能力的博客文章，从而避免了大量的数据库碎片。您可以将其称为与 SQL Server 顺序 ID 等效的客户端。

有没有办法可以在我的 Linq-to-Sql 项目中使用类似的策略（通过在代码中生成 Guid）？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2010-02-02T21:37:18.953

C#（安全）代码（NHibernate Guid Comb Generator 的赞美）

```
Guid GenerateComb()
{
    byte[] destinationArray = Guid.NewGuid().ToByteArray();
    DateTime time = new DateTime(0x76c, 1, 1);
    DateTime now = DateTime.Now;
    TimeSpan span = new TimeSpan(now.Ticks - time.Ticks);
    TimeSpan timeOfDay = now.TimeOfDay;
    byte[] bytes = BitConverter.GetBytes(span.Days);
    byte[] array = BitConverter.GetBytes((long) (timeOfDay.TotalMilliseconds / 3.333333));
    Array.Reverse(bytes);
    Array.Reverse(array);
    Array.Copy(bytes, bytes.Length - 2, destinationArray, destinationArray.Length - 6, 2);
    Array.Copy(array, array.Length - 4, destinationArray, destinationArray.Length - 4, 4);
    return new Guid(destinationArray);
} 
```

github上的源链接： [https ://github.com/nhibernate/nhibernate-core/blob/master/src/NHibernate/Id/GuidCombGenerator.cs](https://github.com/nhibernate/nhibernate-core/blob/master/src/NHibernate/Id/GuidCombGenerator.cs)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-03-20T09:53:22.190

COMB 的生成方式如下：

```
DECLARE @aGuid UNIQUEIDENTIFIER

SET @aGuid = CAST(CAST(NEWID() AS BINARY(10)) + CAST(GETDATE() AS BINARY(6)) AS UNIQUEIDENTIFIER) 
```

转录成 C# 的内容如下所示：

```
 public static unsafe Guid CombGuid()
    {
        Guid guid = Guid.NewGuid();
        byte[] bytes = guid.ToByteArray();
        long ticks = DateTime.Now.Ticks;
        fixed( byte* pByte = bytes )
        {
            int*    pFirst  = (int *)(pByte + 10);
            short* pNext    = (short*)(pByte + 14);
            *pFirst = (int)(ticks & 0xFFFFFF00);
            *pNext  = (short)ticks;
        }

        return new Guid( bytes );
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-20T09:40:10.817

好吧，您可以`Guid`手动生成。但是， a 的优点之一`Guid`是它不可猜测 - 即给定记录`0000-...-0005`，通常没有意义（来自攻击者）检查记录`0000-....-0004`等。

还有——重新碎片化？只要您对此数据有一个非聚集索引，我就不确定这是一个问题。您通常不会在 a 上放置聚集索引`Guid`，因此该表将是一个堆（除非您有单独的聚集索引，例如`IDENTITY`int）。在这种情况下，您将添加到末尾，并将新`Guid`的插入到非聚集索引中。没有真正的痛苦。

（编辑）直接使用时间的一个问题是你会引入更多的碰撞风险；您需要担心紧密循环的`Guid`创建（即在按顺序创建几个时避免重复），这意味着同步等 - 如果多台机器并行密集工作，它会变得更加麻烦 - 你很可能会得到重复.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-02-03T06:10:08.213

你可以随时调用 UuidCreateSequential; 这是“旧”的 guid 生成器（2000 年以前，当 MSFT 将其更改为我们今天习惯的更随机的样式 guid 时）。他们将旧的 UuidCreate 重命名为 UuidCreateSequential，并将新的 guid 生成器放入 UuidCreate 的新实现中。UuidCreateSequential 也是 SQL Server 在 NewSequentialID() 中使用的，它与普通 guid 一样独特，但如果您在同一进程中连续创建一堆它们，它们的好处是它们是连续的。

```
using System;
using System.Runtime.InteropServices;

namespace System
{
    public static class GuidEx
    {
        [DllImport("rpcrt4.dll", SetLastError = true)]
        private static extern int UuidCreateSequential(out Guid guid);
        private const int RPC_S_OK = 0;

        /// <summary>
        /// Generate a new sequential GUID. If UuidCreateSequential fails, it will fall back on standard random guids.
        /// </summary>
        /// <returns>A GUID</returns>
        public static Guid NewSeqGuid()
        {
            Guid sequentialGuid;
            int hResult = UuidCreateSequential(out sequentialGuid);
            if (hResult == RPC_S_OK)
            {
                return sequentialGuid;
            }
            else
            {
                //couldn't create sequential guid, fall back on random guid
                return Guid.NewGuid();
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-06-07T07:01:25.220

@arul，@Doug

为什么将时间部分放在 GUID 的末尾？

我认为前导字节对于排序更重要，而排序是首先引入时间部分以防止索引碎片的原因。

好的，我找到了[答案](http://developmenttips.blogspot.com/2008/03/generate-sequential-guids-for-sql.html)，这个[答案来自 Bernhard Kircher](https://stackoverflow.com/questions/170346/what-are-the-performance-improvement-of-sequential-guid-over-standard-guid/170363#170363)和他引用的网站[Comparing GUID and uniqueidentifier Values (ADO.NET) 。](http://msdn.microsoft.com/en-us/library/ms254976%28VS.100%29.aspx)

因此，以这种方式生成的 GUID 在 MS SQL-Server 以外的其他数据库上的工作方式不同，但这与 LINQ-to-SQL 无关。

对于变形的 URL 感到抱歉，但我没有足够的声誉来发布更多链接。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-20T15:34:56.440

我们首先使用了与 Doug 在上面的实体框架模型中发布的方法类似的方法，因此您也必须能够使用 Linq to SQL 来完成。

While doing this we needed a comb guid generator for testing, and ended up building this little tool to generate comb guids online

[http://www.webdesigncompany.co.uk/comb-guid/](http://www.webdesigncompany.co.uk/comb-guid/)

Hopefully it will help you too.

# c# - 在 C# 中使用 CodeDom 根据其签名为方法生成测试用例

> ID：665419
> 
> 赞同：0
> 
> 时间：2009-03-20T09:08:24.480
> 
> 标签：c#

考虑以下代码片段，

```
Assembly asm = Assembly.LoadFile(DLL_Path);
Type t = asm.GetType(DLL_NameSpace.MyClass, false, true);
clsMethodInvoke mi = new clsMethodInvoke();
foreach (MemberInfo oMember in t.GetMembers(mi.GetFilter()))
{
                                //code here
} 
```

这些是以下变量中的值，

```
t = {Name = "Class1" FullName = "a.Class1"}
oMember = {Int32 add(Int32, Int32)} 
```

现在从这些值我需要生成基于 NUnit 的测试用例，如下所示，

```
[Test()]
public virtual void Testadd1() {
    Class1 Class1 = new Class1();

    int a = -1; //random values are stored here
    int b = 2147483647; //random values are stored here

} 
```

因此，在程序集中拥有类的类型，我想为每种方法生成测试用例，如上所示。我怎样才能生成这样的测试用例。？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T09:21:02.563

你看过使用T4吗？

文章： [http ://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx](http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx)

模板： http: [//www.codeplex.com/t4toolbox](http://www.codeplex.com/t4toolbox)

编辑： http: [//www.visualt4.com/](http://www.visualt4.com/)

关于如何构建代码的技术细节，我不确定您指的是什么意思：

```
Assembly asm = Assembly.LoadFile(DLL_Path);
Type t = asm.GetType(DLL_NameSpace.MyClass, false, true);
clsMethodInvoke mi = new clsMethodInvoke();
foreach (MemberInfo oMember in t.GetMembers(mi.GetFilter()))
{
    string parameters = GetParameters(oMember);
    string test = String.Format(testTemplate, t.Name, m.Name, parameters);
    // Feed test string to T4.
} 
```

那么 testTemplate 将是：

```
[Test()]
public virtual void Test{0}{1}() {
    {0} test{0} = new {0}();

    {2}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T09:21:48.567

看看[Pex](http://www.codeplex.com/Pex)，它是一个从代码分析中生成单元测试的工具。

# sql - Silverlight 2.0 中的数据访问

> ID：665421
> 
> 赞同：0
> 
> 时间：2009-03-20T09:09:25.883
> 
> 标签：sql, sql-server, silverlight, data-binding

我是silverlight 的新手，我正在从asp.net 2.0 移植。我在 asp.net 中完成了许多数据绑定应用程序，我使用 sql server 2005 并使用它的表并通过 sqlconnection 对象访问它们并执行各种与数据库相关的功能。谁能告诉silverlight 2.0是否支持这种设施。如果可以，我可以使用任何数据库服务器，如果不能，是通过 Web 服务吗？谁能指出我一些好的起点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T09:27:05.560

不，您不能直接连接到数据库服务器。您需要使用网络服务。但是，为了简化事情，您可以调用数据 Web 服务，例如 SQL Server Data Services 或 Amazon S3。否则使用[REST](http://en.wikipedia.org/wiki/Representational_State_Transfer)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T09:30:44.787

Silverlight 是一种客户端技术。您不能直接访问服务器上的数据库。您必须在两者之间使用一个层，例如 Web 服务。有关如何做到这一点的好教程，请查看[http://weblogs.asp.net/scottgu/pages/silverlight-2-end-to-end-tutorial-building-a-digg-search-client.aspx](http://weblogs.asp.net/scottgu/pages/silverlight-2-end-to-end-tutorial-building-a-digg-search-client.aspx)

# actionscript-3 - 在 Actionscript 3.0 中设置文本轮廓/边框

> ID：665425
> 
> 赞同：5
> 
> 时间：2009-03-20T09:10:11.090
> 
> 标签：actionscript-3, actionscript, text, outline

如何在 AS3 中为一行文本中的每个字符设置文本轮廓/边框的属性？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-03-24T11:25:00.173

我不认为你可以。您可以做的是使用模糊滤镜来模仿轮廓的外观。只需将其粘贴到一个空的 AS3 电影中：

```
var txt:TextField = new TextField();
this.addChild(txt);
txt.appendText('Lorem ipsum');
txt.autoSize = TextFieldAutoSize.LEFT;
txt.antiAliasType = flash.text.AntiAliasType.NORMAL;
txt.selectable = false;

var txtFormat:TextFormat = new TextFormat();
txtFormat.size = 40;
txtFormat.font = 'Helvetica';
txt.setTextFormat(txtFormat);
txt.defaultTextFormat = txtFormat;

var outline:GlowFilter = new GlowFilter();
outline.blurX = outline.blurY = 1;
outline.color = 0xFF0000;
outline.quality = BitmapFilterQuality.HIGH;
outline.strength = 100;

var filterArray:Array = new Array();
filterArray.push(outline);
txt.filters = filterArray; 
```

尝试使用 strength、blurX、blurY 和 quality 属性，以获得不同的外观。我认为这是最接近文本大纲的方法。

PS：字体嵌入将大大提高效果的质量，以及使抗锯齿正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-21T07:09:42.497

我不是岸我明白，但你可以在测试箱上使用相同类型的
过滤器，这样你可以
在每个字母中获得相同类型的边框

# nhibernate - NHibernate 多对一多次获取相同的项目

> ID：665426
> 
> 赞同：0
> 
> 时间：2009-03-20T09:11:32.163
> 
> 标签：nhibernate, orm, nhibernate-mapping

在我的模型中，我有游戏。每个游戏都有一个与之关联的事件，它被映射为多对一的关联。

当我查询游戏时，在具有给定 EventId（与其 DB-PrimaryKey-id 不同）的事件中，NHibernate 为每个游戏发出以下查询：

```
NHibernate: SELECT event0_.Id as Id8_0_, event0_.EventId as EventId8_0_ FROM Events event0_ WHERE event0_.EventId=@p0; @p0 = '4' 
```

在我的映射中（以及在从映射生成的数据库中）EventId 具有唯一约束。我如何告诉 NHibernate 它应该只为给定的 EventId 获取一次事件，而不是为 N 个游戏发出 N 次相同的确切查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T10:49:21.493

固定的。问题是外键设置在“一个”表的非主键上。改变它解决了这个问题。

# javascript - 禁用浏览器中的“返回”和“刷新”按钮

> ID：665430
> 
> 赞同：0
> 
> 时间：2009-03-20T09:13:31.800
> 
> 标签：javascript, browser, double-submit-prevention

我正在做网络开发。我有一个与信用卡有关的页面，当用户单击“刷新”或“返回”时，交易将再执行一次，这是不需要的。这包括浏览器左上角的“返回”和“刷新”按钮，“右键单击->刷新/返回”，按“F5”键。这只能在某些 cgi 页面上完成，而不是全部。这可以使用Javascript来完成吗？还是有什么其他方法？

谢谢，西提

**完全重复**：[如何阻止“返回”和“刷新”按钮重新提交我的表单？](https://stackoverflow.com/questions/665399)

# asp.net - 如何使 ASP.NET MVC 应用程序成为多语言？

> ID：665435
> 
> 赞同：12
> 
> 时间：2009-03-20T09:16:01.013
> 
> 标签：asp.net, localization, multilingual

如何在 ASp.NET MVC 中做多语言应用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-20T09:35:28.270

看：

[ASP.NET MVC 应用程序中的多种语言](https://stackoverflow.com/questions/4034/multiple-languages-in-an-aspnet-mvc-application)

和

[使用 ASP.NET MVC 的多语言网站](https://stackoverflow.com/questions/291405/multi-lingual-websites-with-asp-net-mvc)

在这个网站上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T09:31:55.627

你可以用资源文件来做

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-05-20T11:56:06.567

Alex Adamyan 有一篇关于 ASP.NET MVC 2 本地化的精彩博客文章。

您可以从此处查看此博客文章：

[http://adamyan.blogspot.com/2010/07/addition-to-aspnet-mvc-localization.html](http://adamyan.blogspot.com/2010/07/addition-to-aspnet-mvc-localization.html)

# javascript - 纯粹作为一个实验，我试图让除了在输入字段中输入更多数据之外绝对不可能做任何事情；可行的？

> ID：665437
> 
> 赞同：1
> 
> 时间：2009-03-20T09:17:05.800
> 
> 标签：javascript, event-handling

我认为我已经非常接近了，但似乎无法涵盖下面列出的每一个方面*：*

*   出于各种原因禁用退格、删除、左箭头键、主页键和 ctrl（一旦您考虑到同时按住两个键引起的混乱，所有这些都被证明是困难的）
*   确保用户不能退出该字段，然后重新进入结尾以外的位置（`onfocus`并且`onclick`属性涵盖了这一点）
*   坚韧：每次成功添加字符时记住该值，这样如果用户决定使用通过位置栏注入的JavaScript代码修改该值，则可以恢复原始数据

鉴于对此的实际用途很少（说实话，为零），我只是将其作为知识的证明。唉，看来我还不够；尽管如此，这是我目前正在使用的代码以供参考：

```
<input id="test" />
<script>
var d = '', kd = 0;
cancel = function(event)
 {
    event.target.value = '';
    event.target.value = d;
 };
handle_up = function(event)
 {
    if (event.keyCode == 36 || event.keyCode == 37) // home, left
     {
        kd = 0;
        cancel(event);
        event.target.value = d;
     }
    if (event.keyCode != 8 && event.keyCode != 46)  // backspace and delete
        d = event.target.value;
    else    // backspace
        event.target.value = d; // set to stored ("cached") value
 };
handle_down = function(event)
 {
    if (kd == 1)
     {
        cancel(event);
        return false;
     }
    if (event.keyCode == 36 || event.keyCode == 37)
     {
        kd = 1;
        cancel(event);
     }
    if (event.keyCode == 8 || event.keyCode == 46)
     {
        kd = 1;
        cancel(event);
     }
 };
HTMLElement.prototype.perma = function()
 {
    this.setAttribute('onfocus', 'cancel(event)');
    this.setAttribute('onclick', 'cancel(event)');
    this.setAttribute('onkeyup', 'handle_up(event)');
    this.setAttribute('onkeydown', 'handle_down(event)');
 };
$('#test').perma();
</script> 
```

同样，即使只是为了新颖，我认为看到获得输入框以拒绝除数据输入之外的任何操作所需的聪明才智真的很酷。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T10:23:22.913

要考虑的另一件事是，验证方案（例如您描述的方案）不应纯粹在客户端进行。

例如，如果禁用了 javascript，则某人可能会提交未经验证的数据。如果发生这种情况，服务器端代码将使用它，而您正在测试的条件将被忽视。

始终使用服务器上的相同验证备份客户端验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T09:25:06.377

顺便说一句，因为这是为了好玩。您是否尝试过将您可以输入的内容列入白名单，而不是将您不能执行的内容列入黑名单。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T09:46:15.093

检查输入的数据，对新的输入进行比较，拒绝任何不是已经存在的扩展的东西怎么样？也许有点冗长，尤其是当字段变得更长时，但有效吗？

# c# - 捕获“超出最大请求长度”

> ID：665453
> 
> 赞同：113
> 
> 时间：2009-03-20T09:23:08.563
> 
> 标签：c#, asp.net, httpexception

我正在编写一个上传函数，并且在文件大于`httpRuntime`web.config 中指定的最大大小（最大大小设置为 5120）的情况下捕获“System.Web.HttpException：超出最大请求长度”时遇到问题。我正在使用一个简单`<input>`的文件。

问题是在上传按钮的点击事件之前引发了异常，并且在我的代码运行之前发生了异常。那么如何捕获和处理异常呢？

**编辑：**异常会立即抛出，所以我很确定这不是由于连接速度慢而导致的超时问题。

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2009-03-20T10:20:17.413

不幸的是，没有简单的方法来捕捉这种异常。我所做的是要么覆盖页面级别的 OnError 方法，要么覆盖 global.asax 中的 Application_Error，然后检查它是否是 Max Request 失败，如果是，则转移到错误页面。

```
protected override void OnError(EventArgs e) .....

private void Application_Error(object sender, EventArgs e)
{
    if (GlobalHelper.IsMaxRequestExceededException(this.Server.GetLastError()))
    {
        this.Server.ClearError();
        this.Server.Transfer("~/error/UploadTooLarge.aspx");
    }
} 
```

这是一个黑客，但下面的代码对我有用

```
const int TimedOutExceptionCode = -2147467259;
public static bool IsMaxRequestExceededException(Exception e)
{
    // unhandled errors = caught at global.ascx level
    // http exception = caught at page level

    Exception main;
    var unhandled = e as HttpUnhandledException;

    if (unhandled != null && unhandled.ErrorCode == TimedOutExceptionCode)
    {
        main = unhandled.InnerException;
    }
    else
    {
        main = e;
    }

    var http = main as HttpException;

    if (http != null && http.ErrorCode == TimedOutExceptionCode)
    {
        // hack: no real method of identifying if the error is max request exceeded as 
        // it is treated as a timeout exception
        if (http.StackTrace.Contains("GetEntireRawContent"))
        {
            // MAX REQUEST HAS BEEN EXCEEDED
            return true;
        }
    }

    return false;
} 
```

* * *

## 回答 #2

> 赞同：58
> 
> 时间：2009-03-20T09:47:33.340

正如 GateKiller 所说，您需要更改 maxRequestLength。如果上传速度太慢，您可能还需要更改 executionTimeout。请注意，您不希望这些设置中的任何一个太大，否则您将容易受到 DOS 攻击。

executionTimeout 的默认值为 360 秒或 6 分钟。

[您可以使用httpRuntime 元素](http://msdn.microsoft.com/en-us/library/e1f13641%28v=VS.100%29.aspx)更改 maxRequestLength 和 executionTimeout 。

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <system.web>
        <httpRuntime maxRequestLength="102400" executionTimeout="1200" />
    </system.web>
</configuration> 
```

编辑：

如果您想处理异常，那么正如已经说明的那样，您需要在 Global.asax 中处理它。这是一个[代码示例](http://geekswithblogs.net/sglima/archive/2011/09/20/how-to-handle-maximum-request-length-exceeded-exception.aspx)的链接。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-03-20T09:34:36.617

您可以通过增加 web.config 中的最大请求长度来解决此问题：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <system.web>
        <httpRuntime maxRequestLength="102400" />
    </system.web>
</configuration> 
```

上面的示例适用于 100Mb 的限制。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2011-07-05T10:56:02.760

如果您还想要客户端验证，这样您就不需要抛出异常，您可以尝试实现客户端文件大小验证。

注意：这仅适用于支持 HTML5 的浏览器。 [http://www.html5rocks.com/en/tutorials/file/dndfiles/](http://www.html5rocks.com/en/tutorials/file/dndfiles/)

```
<form id="FormID" action="post" name="FormID">
    <input id="target" name="target" class="target" type="file" />
</form>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js" type="text/javascript"></script>

<script type="text/javascript" language="javascript">

    $('.target').change(function () {

        if (typeof FileReader !== "undefined") {
            var size = document.getElementById('target').files[0].size;
            // check file size

            if (size > 100000) {

                $(this).val("");

            }
        }

    });

</script> 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2010-07-07T12:22:55.960

嗨 Damien McGivern 提到的解决方案，仅适用于 IIS6，

它不适用于 IIS7 和 ASP.NET 开发服务器。我的页面显示“404 - 找不到文件或目录”。

有任何想法吗？

**编辑：**

明白了......这个解决方案仍然不能在 ASP.NET 开发服务器上运行，但我知道它在我的情况下不能在 IIS7 上运行的原因。

原因是 IIS7 有一个内置的请求扫描，它强制上传文件上限，默认为 30000000 字节（略小于 30MB）。

我试图上传大小为 100 MB 的文件来测试 Damien McGivern 提到的解决方案（在 web.config 中使用 maxRequestLength="10240" 即 10MB）。现在，如果我上传大小 > 10MB 且 < 30 MB 的文件，则页面将重定向到指定的错误页面。但如果文件大小 > 30MB，那么它会显示丑陋的内置错误页面，显示“404 - 找不到文件或目录”。

因此，为避免这种情况，您必须增加最大值。您的网站在 IIS7 中允许的请求内容长度。这可以使用以下命令来完成，

```
appcmd set config "SiteName" -section:requestFiltering -requestLimits.maxAllowedContentLength:209715200 -commitpath:apphost 
```

我已经设置了最大值。内容长度为 200MB。

完成此设置后，当我尝试上传 100MB 的文件时，页面成功重定向到我的错误页面

有关详细信息，请参阅[http://weblogs.asp.net/jgalloway/archive/2008/01/08/large-file-uploads-in-asp-net.aspx](http://weblogs.asp.net/jgalloway/archive/2008/01/08/large-file-uploads-in-asp-net.aspx)。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-05-23T20:00:53.673

这是另一种方法，它不涉及任何“黑客”，但需要 ASP.NET 4.0 或更高版本：

```
//Global.asax
private void Application_Error(object sender, EventArgs e)
{
    var ex = Server.GetLastError();
    var httpException = ex as HttpException ?? ex.InnerException as HttpException;
    if(httpException == null) return;

    if(httpException.WebEventCode == WebEventCodes.RuntimeErrorPostTooLarge)
    {
        //handle the error
        Response.Write("Sorry, file is too big"); //show this message for instance
    }
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2012-09-14T22:12:50.923

一种方法是在 web.config 中设置最大大小，如上文所述，例如

```
<system.web>         
    <httpRuntime maxRequestLength="102400" />     
</system.web> 
```

然后当您处理上传事件时，检查大小，如果超过特定数量，您可以捕获它，例如

```
protected void btnUploadImage_OnClick(object sender, EventArgs e)
{
    if (fil.FileBytes.Length > 51200)
    {
         TextBoxMsg.Text = "file size must be less than 50KB";
    }
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-09-24T13:07:32.757

适用于 IIS7 及更高版本的解决方案：[当文件上传超出 ASP.NET MVC 中允许的大小时显示自定义错误页面](https://stackoverflow.com/questions/2759193/display-custom-error-page-when-file-upload-exceeds-allowed-size-in-asp-net-mvc2/3787284#3787284)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-06-23T11:26:12.710

在 IIS 7 及更高版本中：

web.config 文件：

```
<system.webServer>
  <security >
    <requestFiltering>
      <requestLimits maxAllowedContentLength="[Size In Bytes]" />
    </requestFiltering>
  </security>
</system.webServer> 
```

然后，您可以签入后面的代码，如下所示：

```
If FileUpload1.PostedFile.ContentLength > 2097152 Then ' (2097152 = 2 Mb)
  ' Exceeded the 2 Mb limit
  ' Do something
End If 
```

只要确保 web.config 中的 [Size In Bytes] 大于您要上传的文件的大小，您就不会收到 404 错误。然后，您可以使用 ContentLength 在后面的代码中检查文件大小，这会更好

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-12-22T10:30:58.797

您可能知道，最大请求长度配置在**两个**地方。

1.  `maxRequestLength`- 在 ASP.NET 应用程序级别控制
2.  `maxAllowedContentLength`- under `<system.webServer>`, 在 IIS 级别控制

该问题的其他答案涵盖了第一种情况。

要赶上**第二个**，您需要在 global.asax 中执行此操作：

```
protected void Application_EndRequest(object sender, EventArgs e)
{
    //check for the "file is too big" exception if thrown at the IIS level
    if (Response.StatusCode == 404 && Response.SubStatusCode == 13)
    {
        Response.Write("Too big a file"); //just an example
        Response.End();
    }
} 
```

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-09-29T16:25:22.207

我正在使用 FileUpload 控件和客户端脚本来检查文件大小。
HTML（注意 OnClientClick - 在 OnClick 之前执行）：

```
<asp:FileUpload ID="FileUploader" runat="server" />
<br />
<asp:Button ID="btnUpload" Text="Upload" runat="server" OnClientClick="return checkFileSize()" OnClick="UploadFile" />
<br />
<asp:Label ID="lblMessage" runat="server" CssClass="lblMessage"></asp:Label> 
```

然后是脚本（如果尺寸太大，请注意'return false'：这是取消 OnClick）：

```
function checkFileSize() 
{
    var input = document.getElementById("FileUploader");
    var lbl = document.getElementById("lblMessage");
    if (input.files[0].size < 4194304)
    {
        lbl.className = "lblMessage";
        lbl.innerText = "File was uploaded";
    }
    else
    {
        lbl.className = "lblError";
        lbl.innerText = "Your file cannot be uploaded because it is too big (4 MB max.)";
        return false;
    }
} 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-04-05T18:44:52.407

标记后

```
<security>
     <requestFiltering>
         <requestLimits maxAllowedContentLength="4500000" />
     </requestFiltering>
</security> 
```

添加以下标签

```
 <httpErrors errorMode="Custom" existingResponse="Replace">
  <remove statusCode="404" subStatusCode="13" />
  <error statusCode="404" subStatusCode="13" prefixLanguageFilePath="" path="http://localhost/ErrorPage.aspx" responseMode="Redirect" />
</httpErrors> 
```

您可以将 URL 添加到错误页面...

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-06-24T07:19:33.427

您可以通过增加 web.config 中的最大请求长度和执行超时来解决此问题：

-请澄清最大执行时间超过 1200

```
<?xml version="1.0" encoding="utf-8"?> <configuration> <system.web> <httpRuntime maxRequestLength="102400" executionTimeout="1200" /> </system.web> </configuration> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-04-22T16:04:09.983

在 EndRequest 事件中抓住它怎么样？

```
protected void Application_EndRequest(object sender, EventArgs e)
    {
        HttpRequest request = HttpContext.Current.Request;
        HttpResponse response = HttpContext.Current.Response;
        if ((request.HttpMethod == "POST") &&
            (response.StatusCode == 404 && response.SubStatusCode == 13))
        {
            // Clear the response header but do not clear errors and
            // transfer back to requesting page to handle error
            response.ClearHeaders();
            HttpContext.Current.Server.Transfer(request.AppRelativeCurrentExecutionFilePath);
        }
    } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2019-03-25T08:06:42.773

可以通过以下方式检查：

```
 var httpException = ex as HttpException;
        if (httpException != null)
        {
            if (httpException.WebEventCode == System.Web.Management.WebEventCodes.RuntimeErrorPostTooLarge)
            {
                // Request too large

                return;

            }
        } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-07-29T15:51:35.900

跟进 Martin van Bergeijk 的回答，我添加了一个额外的 if 块来检查他们是否在提交之前实际选择了一个文件。

```
if(input.files[0] == null)
{lbl.innertext = "You must select a file before selecting Submit"}
return false; 
```

# c# - C#：在这种情况下我应该费心检查 null 吗？

> ID：665454
> 
> 赞同：5
> 
> 时间：2009-03-20T09:23:16.007
> 
> 标签：c#

可以说我有这种扩展方法：

```
public static bool HasFive<T>(this IEnumerable<T> subjects)
{
    if(subjects == null)
        throw new ArgumentNullException("subjects");

    return subjects.Count() == 5;
} 
```

你认为这种空检查和异常抛出真的有必要吗？我的意思是，当我使用该`Count`方法时，`ArgumentNullException`无论如何都会抛出 an ，对吗？

我可能会想到一个我应该这样做的原因，但只是想听听其他人对此的看法。是的，我问这个问题的部分原因是懒惰（想尽可能少写），但也因为我有点认为一堆空检查和异常抛出会使方法变得混乱，这些方法通常最终是两倍长他们真的需要。有人应该比将 null 发送到方法中更好：p

无论如何，你们怎么看？

* * *

**注意：** `Count()`是一个扩展方法，*会*抛出一个`ArgumentNullException`，而不是一个`NullReferenceException`. 见[`Enumerable.Count<TSource> Method (IEnumerable<TSource>)`](http://msdn.microsoft.com/en-us/library/bb338038.aspx)。不信你自己试试 =)

* * *

**注意2：**在这里给出的答案之后，我被说服开始检查更多的空值。不过我还是很懒，所以我开始使用[Lokad Shared Libraries](http://abdullin.com/shared-libraries/)`Enforce`中的类。可以推荐看看。而不是我的例子，我可以这样做：

```
public static bool HasFive<T>(this IEnumerable<T> subjects)
{
    Enforce.Argument(() => subjects);
    return subjects.Count() == 5;
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-20T09:29:53.493

是的，它会抛出一个`ArgumentNullException`. 我可以想到两个原因进行额外检查：

*   如果您稍后返回并更改方法以在调用之前执行某些操作`subjects.Count()`并忘记在该点进行检查，那么您可能会在抛出异常之前产生副作用，这不是很好。
*   目前，堆栈跟踪将显示`subjects.Count()`在顶部，并且可能带有`source`参数名称的消息。`HasFive`这可能会使谁可以看到`subjects`参数名称的调用者感到困惑。

编辑：只是为了节省我不得不在别处再次写它：

调用`subjects.Count()`将抛出一个`ArgumentNullException`，*而不是*一个`NullReferenceException`。`Count()`是这里的另一种扩展方法，假设`System.Linq.Enumerable`正在使用 in 中的实现，则记录（正确）以抛出`ArgumentNullException`. 如果您不相信我，请尝试一下。

编辑：让这更容易......

如果你做了很多这样的检查，你可能想让这样做更简单。我喜欢以下扩展方法：

```
internal static void ThrowIfNull<T>(this T argument, string name)
    where T : class
{
    if (argument == null)
    {
        throw new ArgumentNullException(name);
    }
} 
```

问题中的示例方法可以变成：

```
public static bool HasFive<T>(this IEnumerable<T> subjects)
{
    subjects.ThrowIfNull("subjects");    
    return subjects.Count() == 5;
} 
```

另一种选择是编写一个检查值*并返回它*的版本，如下所示：

```
internal static T NullGuard<T>(this T argument, string name)
    where T : class
{
    if (argument == null)
    {
        throw new ArgumentNullException(name);
    }
    return argument;
} 
```

然后你就可以流利地调用它了：

```
public static bool HasFive<T>(this IEnumerable<T> subjects)
{
    return subjects.NullGuard("subjects").Count() == 5;
} 
```

这对于在构造函数等中复制参数也很有帮助：

```
public Person(string name, int age)
{
    this.name = name.NullGuard("name");
    this.age = age;
} 
```

（对于不重要的地方，您可能想要一个没有参数名称的重载。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T09:56:21.887

我认为@Jon Skeet 绝对是正确的，但是我想添加以下想法：-

*   提供有意义的错误消息对于调试、日志记录和异常报告很有用。BCL 抛出的异常不太可能描述异常 WRT 您的代码库的具体情况。也许这不是空检查的问题，它（大多数时候）不一定能给你很多特定于域的信息——“我意外地传递了一个空值，不知道为什么”几乎是你能做的最好的事情但有时您可以提供更多信息，显然这在处理其他异常类型时更有可能相关。
*   空值检查清楚地向其他开发人员和您展示了一种文档形式，如果/当您在一年后回到代码时，*有人可能会传递空值，如果他们这样做就会有问题*。
*   扩展 Jon 的优秀观点——你可能会在获取 null 之前做一些事情——我认为参与[防御性编程](http://en.wikipedia.org/wiki/Defensive_programming)非常重要。在运行其他代码之前检查异常是一种防御性编程形式，因为您考虑到的事情可能不会按您预期的方式工作（或者将来可能会进行您没想到的更改）并确保无论如何发生（假设您的空检查未删除）此类问题不会出现。
*   这是一种运行时[断言](http://en.wikipedia.org/wiki/Assert)，您的参数不为空。你可以假设它不是。
*   上述假设可能会导致代码更精简，您在知道参数不为空的情况下编写其余代码，从而减少无关的后续空检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T09:28:17.193

在我看来，您应该检查空值。想到两件事。

它明确了运行时可能发生的错误。

它还使您有机会抛出更好的异常而不是通用的 ArgumentNullException。因此，使异常的原因更加明确。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T09:28:45.820

您将被抛出的异常将是未设置为对象实例的对象引用。

在追踪问题时，这不是最有用的异常。

通过明确说明您的主题引用为空，您拥有它的方式将为您提供更多有用的信息。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T09:30:09.857

我认为在函数顶部进行前置条件检查是一个好习惯。也许只是我的代码充满了错误，但这种做法为我捕获了很多错误。

此外，如果您得到一个带有参数名称的 ArgumentNullException（从最相关的堆栈帧中抛出），那么找出问题的根源要容易得多。此外，函数主体中的代码可能会随着时间而改变，因此我不会依赖它来捕获未来的前置条件问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-20T09:31:19.653

它总是取决于上下文（在我看来）。

例如，在编写库（供其他人使用）时，完全检查每个参数并抛出适当的异常当然是有意义的。

在编写项目内部使用的方法时，我通常会跳过这些检查，试图减少代码库的大小。但即使在这种情况下，也可能存在一个级别（在应用程序层之间），您仍然可以在其中进行此类检查。这取决于环境、项目的规模、工作团队的规模……

对于一个人构建的小项目来说，这样做当然没有意义:)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-20T12:15:21.350

这取决于具体的方法。在这种情况下-我认为，如果扩展方法可以处理 null，则不需要异常，并且更好的用法将是。

```
public static bool HasFive<T>(this IEnumerable<T> subjects) {
    if ( object.ReferenceEquals( subjects, null ) ) { return false; }

    return subjects.Count() == 5;
} 
```

如果您调用“items.HasFive()”并且“items”为空，那么确实 item 没有五个项目。

但是如果你有扩展方法：

```
public static T GetFift<T>(this IEnumerable<T> subjects) {
    ...
} 
```

应该调用“subjects == null”的异常，因为没有有效的方法，如何处理。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-20T09:49:32.790

如果您查看 Enumerable 类 (System.Core.dll) 的源代码，其中为 IEnumerables 类定义了许多默认扩展方法，您可以看到它们都使用参数检查空引用。

```
public static IEnumerable<TSource> Skip<TSource>(this IEnumerable<TSource> source, int count)
{
    if (source == null)
    {
        throw Error.ArgumentNull("source");
    }
    return SkipIterator<TSource>(source, count);
} 
```

这一点很明显，但我倾向于遵循我在基本框架库源中找到的内容，因为您知道这很可能是最佳实践。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-20T09:54:23.373

是的，有两个原因：

首先，IEnumerable 上的其他扩展方法和代码的使用者可以期望您的代码也这样做，但其次，更重要的是，如果您的查询中有很长的运算符链，那么知道**哪个**引发了异常是有用的信息.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-20T09:55:10.220

在我看来，应该检查以后会引发错误的已知条件（至少对于公共方法）。这样更容易发现问题的根源。

我会提出一个更具信息性的异常，例如：

```
if (subjects == null)
{
     throw new ArgumentNullException("subjects ", "subjects is null.");
} 
```

# smalltalk - Smalltalk 和断言

> ID：665455
> 
> 赞同：2
> 
> 时间：2009-03-20T09:23:16.253
> 
> 标签：smalltalk, assertions, gnu-smalltalk

尝试一些 smalltalk + TDD + “良好实践” 我遇到了一个丑陋的块：

如何在 GNU Smalltalk 中进行断言？

我只是在寻找一种简单`ifFalse: [Die]`的东西

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T09:27:14.560

这是断言的代码：来自[Squeak](http://www.squeak.org/)（我建议您使用它而不是 GNU）：

```
assert: aBlock 
    "Throw an assertion error if aBlock does not evaluates to true."
    aBlock value
        ifFalse: [AssertionFailure signal: 'Assertion failed'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T09:39:50.303

以及自我断言：[ ... some block ]

适用于块和非块，因为向 Object 发送 #value 会返回 self。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T09:31:50.837

很简单。在您的测试方法中，您编写：

```
self assert: 1 + 1 = 2 
```

但首先您需要创建一个测试类作为 TestCase 的子类（在 Squeak 中），例如：

```
TestCase subclass: #MyTest 
```

在这里，您编写测试方法，其名称必须始终以“test”开头，例如：

```
testBasicArithmetics

self assert: 1 + 1 = 2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T13:10:27.440

上面已建议添加`#assert:`到`Object`，但我会添加`#assert`到`BlockClosure`（或`[] class`GNU Smalltalk 中的任何内容）。

```
assert
    this value ifFalse: [AssertionFailure signal: 'Assertion failed'] 
```

并因此使用

```
[ value notNil ] assert.
[ value > 0 ] assert.
[ list isEmpty not ] assert. 
```

等等。

# sql-server - 使用存储过程执行 SELECT、UPDATE、INSTERT 的任何禁忌症

> ID：665461
> 
> 赞同：1
> 
> 时间：2009-03-20T09:27:44.013
> 
> 标签：sql-server, performance, stored-procedures

我正在使用一个 SP 执行所有 CRUD 操作
所以，基本上我正在执行相同的 SP，具体取决于所需的操作：

例如

```
-- for select
exec USP_ORDER @MODE='S', @ORDER_DATE='2009/01/01'
-- for update
exec USP_ORDER @MODE='U', @other_params
-- for insert
exec USP_ORDER @MODE='I', @other_params
-- for delete
exec USP_ORDER @MODE='D', @ID=100 
```

感谢我每 1 个业务对象只有 1 个 SP，这使我的数据库保持有序。但最近我遇到了性能问题。鉴于此，我的**问题**是：
这种方法正确吗？它会对性能/适当的执行产生影响吗？计划？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T10:14:52.730

我认为这更像是一个编码/设计偏好问题。

就个人而言，我非常喜欢保持简单，因此我建议您将操作分解为单独的存储过程。

这将更加透明，也有助于您将来可能需要进行的任何性能调整，即如果您的更新过程/逻辑执行缓慢，您可以立即将其隔离为原因，而如果逻辑是更大过程的一部分不同的 CRUD 操作，问题的根本原因不会那么明显。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T10:02:23.557

由于可能缓存“错误”的查询计划，它可能会对性能产生影响。查看主题[“参数嗅探”](http://blogs.msdn.com/queryoptteam/archive/2006/03/31/565991.aspx)和[查询计划缓存](http://msdn.microsoft.com/en-us/library/ms181055.aspx)。

编辑：响应约翰的评论，您还可以让您的顶级 SP 决定调用哪个 CRUD SP，然后每个人都会获得自己的缓存查询计划。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T12:24:05.947

I'm also fan of simplification (if possible).

But the reason I've decided on that way: currently I have ~80 SPs If I divide all by function they serve (eg. USP_Sample_Insert, USP_Sample_Select1, USP_Sample_Select2, USP_Sample_Delete) I will have ~400 SPs!

Managing, navigating, updating, sync parameters between such huge amount if SP instances would be nightmare to me.

For me - only reasonable case to do it is performance....

# asp.net - 自定义 HttpHandlers 和不同的处理程序类型

> ID：665462
> 
> 赞同：0
> 
> 时间：2009-03-20T09:27:46.243
> 
> 标签：asp.net, httphandler

我看到的关于创建自定义处理程序的所有文献都涉及将扩展与处理程序相关联，例如，如果我想要 Ajax 请求的处理程序，我可以在 AjaxHandler 类中实现 IHttpHandler 接口。

现在，要拥有 AjaxHandler 的各个实例，例如 DocAjaxHander、PersonAjaxHandler 等。我将如何在不注册每个单独的 *.ajax 页面的情况下派生我的 AjaxHandler 类的基本 AJAX 处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T09:38:57.467

您可以通过多种方式自动处理 AJAX 请求。以下是使用 Web 服务的方法：

[http://www.asp.net/AJAX/Documentation/Live/Tutorials/ConsumingWebServicesWithAJAXTutorial.aspx](http://www.asp.net/AJAX/Documentation/Live/Tutorials/ConsumingWebServicesWithAJAXTutorial.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T22:16:11.350

好吧，一种方法是通过查询字符串参数...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-25T13:35:57.213

听起来您假设 1 个 HttpHandler = 1 个页面或 1 个控件，但据我了解，1 个 HttpHandler 可以处理某个文件扩展名的所有页面。

你的问题不是很清楚，你对另一个回答者的回答毫无意义......

“事实上，在我看来，这很像我在询问 Http 处理程序，以 .ajax 处理程序为例。”

但我假设您认为应该分别为“DocAjaxControl”和“PersonAjaxControl”创建“DocAjaxHander”和“PersonAjaxHandler”。我不认为这是必要的，如果您选择这样做，1 个处理程序应该能够处理您所有的 ajax 请求，但无论如何，它对我来说并不是最直观的解决方案（使用 HttpHandlers）细节...

每个 IHttpHandler 对象都需要实现：

```
public void ProcessRequest(HttpContext context) 
```

这使得 ：

```
context.Response.Write("Your JSON Response in here"); 
```

但是在“ProcessRequest()”级别，您无法访问创建 ajax 调用的控件实例，也无法访问包含该控件的“System.Web.UI.Page”对象或任何东西。

```
context.Request 
```

救援！使用上面的 Request 对象，您可以读取 QueryStrings、Sessions，并且您可以确定原始 HttpRequest 的路径（即 PersonAjaxObject 可能对其 JSON 数据进行 ajax 调用到 'myPersonobjPage.ajax'，但 '.ajax' 扩展名在您的自定义 http 处理程序中请求，它是 ProcessRequest 方法。）

如果我是你，并且我打算在我的 ajax 调用中使用 HttpHandler，我会使用查询字符串数据来为我的处理程序提供足够的信息，以了解“我也在响应什么类型的对象”以及“什么数据”是那个对象请求'。

希望有帮助。

# iphone - 如何在没有任何中断的情况下循环播放音频文件？

> ID：665464
> 
> 赞同：1
> 
> 时间：2009-03-20T09:28:06.133
> 
> 标签：iphone, objective-c

我正在尝试开发一个简单的 iPhone 应用程序。我需要在循环中播放声音。如何在没有任何中断的情况下循环播放音频文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-26T19:15:21.697

看看 2.2 版本中新的 AVAudioPlayer 类：

[http://developer.apple.com/iphone/library/documentation/AVFoundation/Reference/AVAudioPlayerClassReference/Reference/Reference.html](http://developer.apple.com/iphone/library/documentation/AVFoundation/Reference/AVAudioPlayerClassReference/Reference/Reference.html)

它具有循环声音的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T09:39:04.890

我真的根本不知道 iPhone SDK，但这应该很快：尝试让声音本身循环播放。这样一来，您应该只需一个呼叫即可播放它，并且无需担心正确计时重复以在正确的时刻重新启动它。

例如，[WAV 文件](http://www.sonicspot.com/guide/wavefiles.html#plst)对循环有非常灵活的支持，任何体面的音频编辑器都应该让您设置循环点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-21T06:17:50.870

AVAudioPlayer 具有 numberOfLoops 属性，您可以在其中指定希望音频循环的次数。

# vbscript - VB脚本GetObject方法错误...请帮助WMI

> ID：665465
> 
> 赞同：1
> 
> 时间：2009-03-20T09:28:14.713
> 
> 标签：vbscript, wmi

此时我收到错误消息：

```
Set objWMI = GetObject("winmgmts:" _
          & "{impersonationLevel=impersonate}!\\" _
          & strComputer & "\root\cimv2") 
```

* * *

```
Error: Invalid procedure call or Argument: "GetObject"
Code: 800A005
Source: Microsoft VBScript Runtime error 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T09:50:00.747

完全重写。

这是由[WMI Code Creator](http://www.microsoft.com/downloads/details.aspx?familyid=2cc30a64-ea15-4661-8da4-55bbc145c30e&displaylang=en)生成的代码，进行了非常小的编辑。

```
strComputer = "." 
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\CIMV2") 
Set colItems = objWMIService.ExecQuery( _
    "SELECT * FROM Win32_ComputerSystem",,48) 
For Each objItem in colItems 
    MsgBox "CurrentTimeZone: " & objItem.CurrentTimeZone
Next 
```

# javascript - 如果验证为假，如何不提交表单

> ID：665470
> 
> 赞同：5
> 
> 时间：2009-03-20T09:29:26.897
> 
> 标签：javascript, jquery, submit

如果其中一项验证为假，我如何确保表单不会提交？

```
$('#form').submit(function(){
    validateForm1();
    validateForm(document.forms['dpart2']);
    validateForm(document.forms['dpart3']);                     
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-20T09:34:56.103

```
$('#form').submit(function(){
    return (validateForm1() &&
            validateForm(document.forms['dpart2']) &&
            validateForm(document.forms['dpart3']))
}); 
```

基本上，您在事件处理函数中返回 false。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-20T09:34:03.373

如果函数返回 false，则不会提交表单。

```
$('#form').submit(function(){
    return  validateForm1() 
            && validateForm(document.forms['dpart2']) 
            && validateForm(document.forms['dpart3']);                                         
              }
}); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-20T21:43:39.627

好的，其他一些解决方案会出现延迟失败......您可能希望运行所有验证，以便显示所有错误。假设您的验证方法如果失败将返回 false。

```
$("#myform").submit(function() {

    var ret = true;
    ret = validateForm1() && ret;
    ret = validateForm(document.forms['dpart2']) && ret
    ret = validateForm(document.forms['dpart3'])) && ret
    return ret;

});
```

这样，您的所有验证器都将被调用，但任何失败的布尔值都会导致失败。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-20T09:33:45.760

如果 validateForm(...) 和 validateForm1() 返回一个布尔值（true 表示没有发生验证错误），那么您尝试这样做：

```
$('#form').submit(function(){
    if (!validateForm1() || !validateForm(document.forms['dpart2']) || !validateForm(document.forms['dpart3'])) {
        return false;
    }
}); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-20T12:33:00.497

一个自动出现的想法：即使您实施了彻底的客户端验证，也要准备好在服务器上接收您可以想象的任何无效请求数据。

客户端验证永远不会让您远离服务器端验证。这只是可用性的一个奖励。

# c# - 如何处理 WCF 客户端断开连接

> ID：665473
> 
> 赞同：5
> 
> 时间：2009-03-20T09:30:00.233
> 
> 标签：c#, wcf

如何处理 WCF 客户端断开连接？

我尝试了回调，但它似乎仅在客户端通过使用“断开连接”按钮“清楚地”断开连接时才有效。

我希望在客户端断开连接时通知我的服务器，即使在手动断开连接或客户端进程崩溃时也是如此。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-01-05T09:54:15.300

使用 OperationContext.Current.Channel.Faulted 和 OperationContext.Current.Channel.Closed 事件。

当客户端出于某种原因断开连接时，将触发这些事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-31T12:59:02.837

轮询的一种变体是使用消息传递。客户端可以发布“我在这里”消息，然后在断开连接时删除该消息。服务器可以监视队列的断开连接。另一种选择是使用[BOSH](http://xmpp.org/extensions/xep-0124.html)双向 HTTP 通信。这是网络聊天客户端使用的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T10:06:01.720

为什么不创建一个循环，让客户端每隔一秒左右对服务执行一次 ping 操作，然后进行回调。当回调失败时，客户端已断开连接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-05T10:06:49.720

我会说，如果客户端以异常方式断开连接，则无法确保服务器会意识到这一点。它很像 HTTP。如果我们关闭浏览器，比如说强制退出，浏览器不会向服务器发送任何内容。

这是我们有会话超时的众多原因之一。断开客户端并在服务器端清理正在使用的所有内容，如果客户端出现错误（例如操作太长）或在不让服务器知道的情况下断开连接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-26T11:53:31.803

```
if (HttpContext.Current.Response.IsClientConnected == false)
{
..} 
```

它可以帮助你

# c# - Why Func instead of Predicate ?

> ID：665494
> 
> 赞同：218
> 
> 时间：2009-03-20T09:39:31.037
> 
> 标签：c#, .net, predicate, func

This is just a curiosity question I was wondering if anyone had a good answer to:

In the .NET Framework Class Library we have for example these two methods:

```
public static IQueryable<TSource> Where<TSource>(
    this IQueryable<TSource> source,
    Expression<Func<TSource, bool>> predicate
)

public static IEnumerable<TSource> Where<TSource>(
    this IEnumerable<TSource> source,
    Func<TSource, bool> predicate
) 
```

Why do they use `Func<TSource, bool>` instead of `Predicate<TSource>`? Seems like the `Predicate<TSource>` is only used by `List<T>` and `Array<T>`, while `Func<TSource, bool>` is used by pretty much all `Queryable` and `Enumerable` methods and extension methods... what's up with that?

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2009-03-20T09:47:46.803

While `Predicate` has been introduced at the same time that `List<T>` and `Array<T>`, in .net 2.0, the different `Func` and `Action` variants come from .net 3.5.

So those `Func` predicates are used mainly for consistency in the LINQ operators. As of .net 3.5, about using `Func<T>` and `Action<T>` the [guideline states](https://docs.microsoft.com/en-us/archive/blogs/mirceat/linq-framework-design-guidelines#2-extension-methods-func-action-and-expression):

> Do use the new LINQ types `Func<>` and `Expression<>` instead of custom delegates and predicates

* * *

## 回答 #2

> 赞同：118
> 
> 时间：2009-03-20T09:51:25.827

I've wondered this before. I like the `Predicate<T>` delegate - it's nice and descriptive. However, you need to consider the overloads of `Where`:

```
Where<T>(IEnumerable<T>, Func<T, bool>)
Where<T>(IEnumerable<T>, Func<T, int, bool>) 
```

That allows you to filter based on the index of the entry as well. That's nice and consistent, whereas:

```
Where<T>(IEnumerable<T>, Predicate<T>)
Where<T>(IEnumerable<T>, Func<T, int, bool>) 
```

wouldn't be.

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-03-20T10:12:05.343

Surely the actual reason for using `Func` instead of a specific delegate is that C# treats separately declared delegates as totally different types.

Even though `Func<int, bool>` and `Predicate<int>` both have identical argument and return types, they are not assignment-compatible. So if every library declared its own delegate type for each delegate pattern, those libraries would not be able to interoperate unless the user inserts "bridging" delegates to perform conversions.

```
 // declare two delegate types, completely identical but different names:
    public delegate void ExceptionHandler1(Exception x);
    public delegate void ExceptionHandler2(Exception x);

    // a method that is compatible with either of them:
    public static void MyExceptionHandler(Exception x)
    {
        Console.WriteLine(x.Message);
    }

    static void Main(string[] args)
    {
        // can assign any method having the right pattern
        ExceptionHandler1 x1 = MyExceptionHandler; 

        // and yet cannot assign a delegate with identical declaration!
        ExceptionHandler2 x2 = x1; // error at compile time
    } 
```

By encouraging everyone to use Func, Microsoft is hoping that this will alleviate the problem of incompatible delegate types. Everyone's delegates will play nicely together, because they will just be matched up based on their parameter/return types.

It doesn't solve all problems, because `Func` (and `Action`) can't have `out` or `ref` parameters, but those are less commonly used.

**Update:** in the comments Svish says:

> Still, switching a parameter type from Func to Predicate and back, doesn't seem to make any difference? At least it still compiles without any problems.

Yes, as long as your program only assigns methods to delegates, as in the first line of my `Main` function. The compiler silently generates code to new a delegate object that forwards on to the method. So in my `Main` function, I could change `x1` to be of type `ExceptionHandler2` without causing a problem.

However, on the second line I try to assign the first delegate to another delegate. Even thought that 2nd delegate type has exactly the same parameter and return types, the compiler gives error `CS0029: Cannot implicitly convert type 'ExceptionHandler1' to 'ExceptionHandler2'`.

Maybe this will make it clearer:

```
public static bool IsNegative(int x)
{
    return x < 0;
}

static void Main(string[] args)
{
    Predicate<int> p = IsNegative;
    Func<int, bool> f = IsNegative;

    p = f; // Not allowed
} 
```

My method `IsNegative` is a perfectly good thing to assign to the `p` and `f` variables, as long as I do so directly. But then I can't assign one of those variables to the other.

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2009-03-20T09:56:34.367

The advice (in 3.5 and above) is to use the `Action<...>` and `Func<...>` - for the "why?" - one advantage is that "`Predicate<T>`" is only meaningful if you know what "predicate" means - otherwise you need to look at object-browser (etc) to find the signatute.

Conversely `Func<T,bool>` follows a standard pattern; I can immediately tell that this is a function that takes a `T` and returns a `bool` - don't need to understand any terminology - just apply my truth test.

For "predicate" this might have been OK, but I appreciate the attempt to standardise. It also allows a lot of parity with the related methods in that area.

# c# - 如何在运行时为控件带来拖放操作？

> ID：665495
> 
> 赞同：0
> 
> 时间：2009-03-20T09:39:34.267
> 
> 标签：c#, asp.net

例如，我开发了一个网站，其中包含一些控件，如按钮、树视图等......那么我如何拖放这些控件......同时运行该应用程序......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T10:01:00.220

我会选择 JQuery。这是一个演示：http: [//jqueryui.com/demos/draggable/](http://jqueryui.com/demos/draggable/)

唯一的问题可能是保存控件的位置。

# .net - string 是不可变的，而 stringbuilder 是可变的

> ID：665499
> 
> 赞同：2
> 
> 时间：2009-03-20T09:42:03.340
> 
> 标签：.net

任何人都可以用例子来解释

* * *

相关讨论： [连接字符串的最有效方法？](https://stackoverflow.com/questions/21078/whats-the-best-string-concatenation-method-using-c)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-20T09:44:48.200

```
string s = "a";

s += "b"; // this will create a new string object

StringBuilder sb = new StringBuild();
sb.Append("a");
sb.Append("b"); // appends to existing StringBuilder 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-20T09:50:07.687

您不能编辑字符串的值，字符串对象的每个方法都返回一个新字符串，而不是更改原始字符串。另一方面，StringBuilder 可以更改其内容（例如添加新字符串）。

```
string original = "the brown fox jumped over the lazy dog";
string altered = original.Insert(original.IndexOf("fox"), "cat");
// altered = the brown cat jumped over the lazy dog 
```

除非创建新字符串或将实例重新引用到另一个字符串对象，否则无法更改原始字符串的内容。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-20T10:08:32.963

字符串对象是不可变的，一旦创建就无法更改

```
string str;
//new string object constructed. str= new string("string1");
str="string1";
//again new object will be constructed str=new string("string1string2");
str=str+"string2" 
since a new object is created for every assignment, there is an overhead. 
```

但是，字符串生成器类提供了一种将字符串重复附加到已构造对象的有效方法。

```
StringBuilder str=new StringBuilder();
str.Append("string1");
str.Append("string2"); 
```

性能差异将太小，无法在较少的赋值和连接操作上进行比较，但如果我们有更多这些字符串操作，则通过从字符串切换到字符串构建器可以获得显着的性能提升。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-10-14T04:04:37.213

即使是一个老问题，我想我仍然会回答。

**字符串（引用类型存储）**

将字符串的值放在托管堆上，并使用指针指向它。如果更改字符串的值，则新值将存储在托管堆中的另一个位置，并且指针将更改为指向新位置。旧值保留在堆上，没有任何指向其位置的指针。最终可能会耗尽堆内存。

这是一种安全保障。它确保除非程序员在物理上更改字符串（实际上是在堆栈上放置一个新值并更改指针），否则系统不能更改字符串。我认为没有办法将指针从堆上的新值更改为堆上的旧值。

* * *

2010 年 10 月 20 日已编辑

> **StringBuilder（值类型存储）** <<< INCORRECT
> 
> 不使用托管堆，因此不使用指向值的指针。它在一个位置创造了一个价值。可以通过多种不同方式操纵该单个位置中的值。

**StringBuilder（引用型存储）**

将一个对象放在托管堆上，并使用指针指向它。值通过指针放置在对象中。该值可以通过指针进行操作。我认为这意味着如果值发生变化，堆上的地址空间将被分配以适应值的扩展或收缩。

* * *

**权衡取舍**

Stringbuilder 使用更多的处理时间，更少的内存用于存储[在堆上]，并且它的值可以按字节操作。

String 使用更少的处理时间和更多的内存用于存储，因为它不能更改它的旧值，也不能处理它们。为字符串分配新值只是将指针指向堆上的另一个位置，并将新值存储在那里。旧值永远留在堆上，没有指针。

引用类型存储和值类型存储的比较。

![替代文字](https://i.stack.imgur.com/UrWoi.gif)

**经验法则**

*   System.ValueType 中的任何内容都是值类型。
*   system.ValueType 之外的任何内容都是引用类型。

最后，一篇文章展示[了一些代码测试来证明这些观点](http://www.rvenables.com/tag/reference-types)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-20T10:06:27.057

在 C++ 中，您可以这样做：

```
std::string hello = "Hello, world!\r\n";
hello[7] = 'W'; 
```

在 C# 中，您不能这样做。字符串不能更改。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-20T10:05:49.710

它们被设为不可变的一些原因：

*   不可变类型是线程安全的，这意味着您可以传递一个字符串而不必担心它已被更改。
*   如果可以更改字符串，则安全性更受关注。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-26T12:41:17.970

字符串是不可变的 ,,

这意味着一旦声明我们就不能更改字符串。

字符串生成器是可变的

这是可以执行的品种操作。我们可以更改字符串..

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-02-26T17:57:48.277

字符串的不变性[实例是只读的]

```
 string s="hi";
    //now let s be address 1000
    s+=" there"; 
    //above concatination causes creation of new instance in address location other than 1000
    //with modified value "hi there" 
```

stringbuilder的可变性[实例可以修改]

```
 StringBuilder sbr = new StringBuilder("My Favourite Programming Font is ");
    sbr.Append("Inconsolata")
//append operation only modifies existing instance of sbr rather than creating new instance 
```

更多有趣的例子和详细的讨论强烈推荐关注[这个链接](http://dotnetmob.com/difference-between-string-and-stringbuilder-in-csharp/)

### 字符串与字符串生成器

*   细绳

1.  在系统命名空间下
2.  不可变（只读）实例
3.  当值发生连续变化时性能会下降
4.  线程安全

*   StringBuilder（可变字符串）

1.  在 System.Text 命名空间下
2.  可变实例
3.  由于对现有实例进行了新的更改，因此表现出更好的性能

> 有关此主题的描述性文章，其中包含大量使用 [ObjectIDGenerator](https://www.google.co.in/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&uact=8&ved=0CB0QFjAA&url=https%3A%2F%2Fmsdn.microsoft.com%2Fen-us%2Flibrary%2Fsystem.runtime.serialization.objectidgenerator%2528v%3Dvs.110%2529.aspx&ei=zureVJ2TGIumuQST24LgDw&usg=AFQjCNEVVMd831zB0C4a6uD6LQfNkpcbpw&sig2=ovdkA2I70n7Z6SAoKSKmZQ)的示例，请点击[此链接](http://dotnetmob.com/csharp-article/difference-string-stringbuilder-c/)
> 
> 相关 Stackeoverflow 问题：[当字符串在 C# 中不变时字符串的可变性？](https://stackoverflow.com/questions/28511598/mutability-of-string-when-string-doesnt-change-in-c/28511709#28511709)

# python - Python中移位和大写锁定的状态

> ID：665502
> 
> 赞同：2
> 
> 时间：2009-03-20T09:43:04.413
> 
> 标签：python, tkinter

我正在使用 Python 2.5 编写一个 TkInter 应用程序，我需要找出大写锁定和 shift 键的状态（真或假）。我已经搜索了整个网络，但找不到解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T10:16:34.457

Tkinter 中的键盘事件可能很棘手。

我建议您按顺序查看以下内容：

*   [http://effbot.org/tkinterbook/tkinter-events-and-bindings.htm](http://effbot.org/tkinterbook/tkinter-events-and-bindings.htm)
*   [http://infohost.nmt.edu/tcc/help/pubs/tkinter/events.html](http://infohost.nmt.edu/tcc/help/pubs/tkinter/events.html)（阅读有关事件的整章）
*   [http://www.faqts.com/knowledge_base/view.phtml/aid/4281](http://www.faqts.com/knowledge_base/view.phtml/aid/4281)

这是一个显示 keycode 和 state 事件参数值的程序。你可以用它来做实验。单击窗口，然后敲击键盘。

```
from Tkinter import *
root = Tk()

def key(event):
    print "Keycode:", event.keycode, "State:", event.state

def callback(event):
    frame.focus_set()
    print "clicked at", event.x, event.y

frame = Frame(root, width=100, height=100)
frame.bind("<Key>", key)
frame.bind("<Button-1>", callback)
frame.pack()

root.mainloop() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T10:08:20.843

`Lock`和`Shift`事件修饰符：

[http://infohost.nmt.edu/tcc/help/pubs/tkinter/event-modifiers.html](http://infohost.nmt.edu/tcc/help/pubs/tkinter/event-modifiers.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T10:11:50.380

我用谷歌搜索了一个..我不确定它是否适用于所有键...

[http://www.java2s.com/Code/Python/Event/KeyactionFunctionKeyALtControlShift.htm](http://www.java2s.com/Code/Python/Event/KeyactionFunctionKeyALtControlShift.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-02T17:13:19.907

利用：

```
from Tkinter import *
root = Tk()
caps_lock_on = False
def CAPSLOCK_STATE():
    import ctypes
    hllDll = ctypes.WinDLL ("User32.dll")
    VK_CAPITAL = 0x14
    return hllDll.GetKeyState(VK_CAPITAL)

CAPSLOCK = CAPSLOCK_STATE()
if ((CAPSLOCK) & 0xffff) != 0:
    print "\nCaps lock is on\n"
    caps_key_on = True
else:
    caps_key_on = False
    print 'Caps lock is off'

def caps_lock_pressed(event=''):
    global caps_lock_on
    if caps_lock_on == False:
        caps_lock_on = True
        print 'Caps lock is on'
    else:
        caps_lock_on = False
        print 'Caps lock is off'

#Changes if shift key is on and off 
def shift_key_pressed(event=''):
    global shift_key_on
    shift_key_on = True
    print 'Shift is being holded' 

def shift_key_released(event=''):
    global shift_key_on
    shift_key_on = False
    print 'Shift has been released'

root.bind('<Caps_Lock>',caps_lock_pressed)
root.bind('<Shift_L>',shift_key_pressed)
root.bind('<Shift_R>',shift_key_pressed)
root.bind('<KeyRelease-Shift_R>',shift_key_released)
root.bind('<KeyRelease-Shift_L>',shift_key_released)
root.mainloop() 
```

这将检查它的大写锁定，然后它将绑定大写锁定并转换以更改状态。大写锁定检测系统是借用的。

# c++ - 将标准输出重定向到系统日志

> ID：665509
> 
> 赞同：14
> 
> 时间：2009-03-20T09:46:12.207
> 
> 标签：c++, unix, redirect, daemon, syslog

我打算为 Debian 打包[OpenTibia Server](http://opentibia.svn.sf.net/svnroot/opentibia/otserv/trunk/)。我想做的一件事是添加启动方式`/etc/init.d`和进程的守护`otserv`进程。

问题是，我们可能应该将输出重定向到 syslog。这通常通过`syslog()`函数完成。目前，代码中充斥着：

```
std::cout << "Stuff to printout" << std::endl; 
```

是否有一种适当的、易于添加的方法将标准输出和标准错误输出重定向到 syslog 中，而无需替换对 std::cout 和朋友的每一个“调用”？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-20T09:50:12.493

您可以使用以下命令通过管道`stdout`传输到：`syslog``logger`

> **姓名**
> 
> ```
>  logger - a shell command interface to the syslog(3) system log module 
> ```
> 
> **概要**
> 
> ```
>  logger [-isd] [-f file] [-p pri] [-t tag] [-u socket] [message ...] 
> ```
> 
> **描述**
> 
> ```
>  Logger makes entries in the system log.  It provides a shell command
>  interface to the syslog(3) system log module. 
> ```

如果您未在命令行上提供消息，则会显示`stdin`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T10:50:33.377

您可以通过 rdbuf() 命令重定向 C++ 中的任何流。这实现起来有点复杂，但并不难。

您需要编写一个将在溢出（）上输出到 syslog 的 streambuf，并用您的 streambuf 替换 std::cout rdbuf。

一个示例，将输出到文件（无错误处理，未经测试的代码）

```
#include <iostream>
#include <fstream>
using namespace std;

int main (int argc, char** argv) {
   streambuf * yourStreamBuffer = NULL;
   ofstream outputFileStream;
   outputFileStream.open ("theOutputFile.txt");

   yourStreamBuffer = outputFileStream.rdbuf();
   cout.rdbuf(yourStreamBuffer);

   cout << "Ends up in the file, not std::cout!";

   outputFileStream.close();

   return 0;
 } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-10-22T06:02:06.230

不确定直接的“C”答案是否足够；但在“C”中，您可以使用底层 stdio 功能将 (FILE*) 直接插入系统日志调用，而无需干预“记录器”进程。查看 [http://mischasan.wordpress.com/2011/05/25/redirecting-stderr-to-syslog/](http://mischasan.wordpress.com/2011/05/25/redirecting-stderr-to-syslog/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-20T09:49:46.283

尝试使用合适的脚本包装二进制文件的执行，该脚本只读取 stdout 和 stderr，并使用`syslog()`. 这应该可以在包装应用程序中没有任何代码更改的情况下工作，并且非常容易。

不确定是否有现有的脚本可以输入，但如果没有的话，编写一个应该不难。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-26T20:40:12.727

我刚刚写了一些代码来做到这一点。它使用 ASL 而不是 syslog，并且使用 kevents，因此您可能需要将其移植到系统的不同 API（syslog 而不是 ASL 和 poll/select 而不是 kevent）

[http://cgit.freedesktop.org/xorg/app/xinit/tree/launchd/console_redirect.c](http://cgit.freedesktop.org/xorg/app/xinit/tree/launchd/console_redirect.c)

此外，我基本上将它添加到 Mountain Lion 上的 libsystem_asl 中。查看 asl_log_descriptor 的手册页。

例子：

```
#include <asl.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int main() {
    asl_log_descriptor(NULL, NULL, ASL_LEVEL_INFO, STDOUT_FILENO, ASL_LOG_DESCRIPTOR_WRITE);
    asl_log_descriptor(NULL, NULL, ASL_LEVEL_NOTICE, STDERR_FILENO, ASL_LOG_DESCRIPTOR_WRITE);
    fprintf(stdout, "This is written to stdout which will be at log level info.");
    fprintf(stderr, "This is written to stderr which will be at log level notice.");
    return 0;
} 
```

# architecture - 架构模式 Pub/Sub 扩展和灾难恢复

> ID：665515
> 
> 赞同：2
> 
> 时间：2009-03-20T09:48:47.753
> 
> 标签：architecture, scalability, load-balancing, publish-subscribe

我们将有一个源系统通过符合 JMS 的发布/订阅基础设施广播消息。对于大多数发布的消息，订阅者将是使用消息中的数据更新屏幕的 GUI 应用程序。

然而，其中一个订阅者将是翻译服务。对于发布的某些消息，翻译服务会将消息翻译成不同的格式，并将其发布到企业不同部分拥有的辅助消息传递基础架构上。

如何扩展我的翻译服务并在理想情况下提供主动-主动容错？一些注意事项：

*   消息需要按顺序发布到辅助消息传递基础架构上。
*   消息只能在辅助消息传递基础架构上发布一次。

基本上，我如何确保只有 1 个翻译服务订阅者响应消息？我是否需要切换到基于队列的系统（但我的 GUI 仍需要发布/订阅语义）？

请注意，翻译服务将押注托管在 Windows Server 2003 中的 .Net 3.5 应用程序。我们提供 F5 Network 的 BigIP LTM/GTM。

需要更多详细信息，请询问/评论。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T09:58:28.057

这可能会有所帮助：[http ://www.enterpriseintegrationpatterns.com/toc.html](http://www.enterpriseintegrationpatterns.com/toc.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-12T12:24:36.390

查看 wcf 中的可靠消息传递。也许它有帮助

# linq-to-xml - LINQ over XML：查找顶级父级

> ID：665523
> 
> 赞同：1
> 
> 时间：2009-03-20T09:51:01.103
> 
> 标签：linq-to-xml

我正在使用 C# 和 LINQ 来遍历我的 XDocument。

假设我有这样的 XML：

```
<Root>
  <Element ID="1">
    <Element ID="2">
      <Element ID="3" />
      ...
    </Element>
    <Element ID="50">
      ...
    </Element>
  </Element>
  <Element ID="x">
    ...
  </Element>
</Root> 
```

现在假设我有 ID 3，并设法找到具有该 ID 的元素。此时，我想找到顶级父节点的ID（它是父节点，比Root低一级）。在这种情况下，我想找到 ID 为 1 的元素。我可以这样做：

myElement.Parent.Parent

但我不知道它可能有多少级 - 所以我可能需要递归。但是，我记得 XDocument 是只读的。以递归方式找到父对象的成本是多少？做这个的最好方式是什么？

我的 XML 文件可能高达 500k 大。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T09:53:27.367

不，`XDocument`不只是转发。你在想`XStreamingElement`吗？

我相信父级作为字段存储为 的一部分`XObject`，因此递归获取它很便宜。

# ant - 如何获取以下标签文件集中包含的信息？

> ID：665531
> 
> 赞同：0
> 
> 时间：2009-03-20T09:53:55.963
> 
> 标签：ant

如何获取以下标签“fileset”中包含的信息？

事实上，我希望在以下 refid“files.to.copy”上使用 Ant 指令“copy”：

```
<publication>
    <TARGET_ONE>
        <path id="files.to.copy">
            <fileset dir="lib">
                <filename name="idl.zip"/>
                <filename name="AEX_IDXClient.jar"/>
            </fileset>
            <fileset dir="src">
                <filename name="AEX_IDXClientCpp.zip"/>
                <filename name="AEX_IDXClient-src.jar"/>
            </fileset>
        </path>
    </TARGET_ONE>
</publication> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T09:59:58.477

看看[http://ant.apache.org/manual/Tasks/copy.html](http://ant.apache.org/manual/Tasks/copy.html)

像这样使用它：

```
<copy todir="...">
    <fileset dir="lib">
            <filename name="idl.zip"/>
            <filename name="AEX_IDXClient.jar"/>
    </fileset>
    <fileset dir="src">
            <filename name="AEX_IDXClientCpp.zip"/>
            <filename name="AEX_IDXClient-src.jar"/>
    </fileset>
</copy> 
```

# python - 如何编写一个程序来使用 python 发送和接收短信？

> ID：665536
> 
> 赞同：6
> 
> 时间：2009-03-20T09:55:15.617
> 
> 标签：python, sms, gsm, at-command

我已经在网上寻找一个好的库来使用 python 发送和接收短信，但都是徒劳的！

那里有用于 python 的 GSM 库吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T10:09:01.323

你看过[py-sms](http://code.google.com/p/py-sms/)吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T10:15:01.450

[Gammu](http://en.wikipedia.org/wiki/Gammu_(software))的[Python 绑定](http://www.gammu.org/wiki/index.php?title=Gammu:Python-gammu)可能吗？

顺便提一句。它的 GUI 版本（[Wammu](http://en.wikipedia.org/wiki/Wammu)）是用 wxPython 编写的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T12:10:32.670

我最近编写了一些代码，用于在 python 中与华为 3G USB 调制解调器进行交互。

我最初的原型直接使用 pyserial，然后我的生产代码使用了 Twisted 的 Serial 支持，因此我可以异步访问调制解调器。

我发现通过使用串行端口以编程方式访问调制解调器，我能够使用 Hayes AT 命令和 AT 命令集的扩展访问发送和接收 SMS 消息所需的所有功能。

这是我能够在该主题上找到[的参考资料之一，它列出了以下命令：](http://wiki.forum.nokia.com/index.php/AT_Commands)

```
AT+CMGL      List Messages
AT+CMGR     Read message
AT+CMGS     Send message
AT+CMGW     Write message to memory 
```

它们是复杂的命令并带有参数，您必须自己解析结果。

[互联网上有更多参考资料](http://www.developershome.com/sms/cmgsCommand.asp)，您可以通过 google 来参考这 4 个命令，让您了解调制解调器的工作原理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-07-01T21:38:08.467

[我在这里](https://stackoverflow.com/questions/716946/how-do-i-enable-sms-notifications-in-my-web-app/1071496#1071496)提供了一个类似问题的详细答案。我提到了 TextMagic 提供的 SMS 网关的 Python 接口。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T12:48:32.937

Also check [PyKannel](http://mobilehacking.org/index.php/PyKannel).

There's also a web service for sending and receiving SMS (non-free, of course), but I don't have URL at hand. :(

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-15T23:18:47.987

我参加了一个黑客日，我们可以免费访问一些 API，包括[twillio](http://www.twilio.com/)。使用他们的 python 库发送和接收短信非常容易，我们在大约 3 小时内围绕它构建了一个应用程序（twillio 集成大约需要 15 分钟）。

# c# - 扩展 C# Coalesce 运算符

> ID：665554
> 
> 赞同：14
> 
> 时间：2009-03-20T10:05:15.077
> 
> 标签：c#, extension-methods

在我解释我想要做什么之前，如果你看下面的代码，你会明白它应该做什么吗？*（更新 - 见下文）*

```
Console.WriteLine(
  Coalesce.UntilNull(getSomeFoo(), f => f.Value) ?? "default value"); 
```

C# 已经有一个空合并运算符，它在简单对象上工作得很好，但如果您需要访问该对象的成员，它就无济于事了。

例如

```
Console.WriteLine(getSomeString()??"default"); 
```

效果很好，但在这里对您没有帮助：

```
public class Foo
{
  public Foo(string value) { Value=value; }
  public string Value { get; private set; }
}

// this will obviously fail if null was returned
Console.WriteLine(getSomeFoo().Value??"default"); 

// this was the intention
Foo foo=getSomeFoo();
Console.WriteLine(foo!=null?foo.Value:"default"); 
```

由于这是我经常遇到的事情，所以我考虑过使用扩展方法*（旧版本）*：

```
public static class Extension
{
  public static TResult Coalesce<T, TResult>(this T obj, Func<T, TResult> func, TResult defaultValue)
  {
    if (obj!=null) return func(obj);
    else return defaultValue;
  }

  public static TResult Coalesce<T, TResult>(this T obj, Func<T, TResult> func, Func<TResult> defaultFunc)
  {
    if (obj!=null) return func(obj);
    else return defaultFunc();
  }
} 
```

这让我可以写：

```
Console.WriteLine(getSomeFoo().Coalesce(f => f.Value, "default value")); 
```

那么你会认为这段代码是可读的吗？Coalesce 是个好名字吗？

编辑 1：按照 Marc 的建议删除了括号

## 更新

我真的很喜欢 lassevk 的建议和 Groo 的反馈。所以我添加了重载，并没有将其实现为扩展方法。我还认为 defaultValue 是多余的，因为您可以只使用现有的 ?? 运营商。

这是修改后的课程：

```
public static class Coalesce
{
  public static TResult UntilNull<T, TResult>(T obj, Func<T, TResult> func) where TResult : class
  {
    if (obj!=null) return func(obj);
    else return null;
  }

  public static TResult UntilNull<T1, T2, TResult>(T1 obj, Func<T1, T2> func1, Func<T2, TResult> func2) where TResult : class
  {
    if (obj!=null) return UntilNull(func1(obj), func2);
    else return null;
  }

  public static TResult UntilNull<T1, T2, T3, TResult>(T1 obj, Func<T1, T2> func1, Func<T2, T3> func2, Func<T3, TResult> func3) where TResult : class
  {
    if (obj!=null) return UntilNull(func1(obj), func2, func3);
    else return null;
  }

  public static TResult UntilNull<T1, T2, T3, T4, TResult>(T1 obj, Func<T1, T2> func1, Func<T2, T3> func2, Func<T3, T4> func3, Func<T4, TResult> func4) where TResult : class
  {
    if (obj!=null) return UntilNull(func1(obj), func2, func3, func4);
    else return null;
  }
} 
```

示例用法：

```
Console.WriteLine(
  Coalesce.UntilNull(getSomeFoo(), f => f.Value) ?? "default value"); 
```

另一个样本：

```
public class Bar
{
  public Bar Child { get; set; }
  public Foo Foo { get; set; }
}

Bar bar=new Bar { Child=new Bar { Foo=new Foo("value") } };

// prints "value":
Console.WriteLine(
  Coalesce.UntilNull(bar, b => b.Child, b => b.Foo, f => f.Value) ?? "null");

// prints "null":
Console.WriteLine(
  Coalesce.UntilNull(bar, b => b.Foo, f => f.Value) ?? "null"); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-20T10:09:01.637

是的，我会理解的。是的，coalesce 是个好名字。是的，如果 C# 有一个像 Groovy 和其他一些语言这样的空安全解引用运算符会更好:)

**更新**

C# 6 就有这样一个运算符 - null 条件运算符，`?.`例如：

```
var street = customer?.PrimaryAddress?.Street; 
```

如果您仍需要默认值，请将其与原始空合并运算符一起使用。例如：

```
var street = customer?.PrimaryAddress?.Street ?? "(no address given)"; 
```

或者，基于问题中的原始代码：

```
Console.WriteLine(getSomeFoo()?.Value ?? "default"); 
```

当然，请注意，以这种方式提供默认值仅在可以使用该默认值的情况下才有效，即使最终属性值可用但由于某种原因设置为 null 也是如此。

表达式的结果`x?.y`是`null`if`x`计算结果为 null；否则是 的结果`x.y`。哦，您也可以将它用于条件方法调用：

```
possiblyNull?.SomeMethod(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-20T10:10:02.787

它已经让我感到困惑了...通常，您会想到对其*值*起作用的合并-我想象 , 的第一个非 null会被返回`(f) => f.Value`，`"default value"`但事实并非如此（空测试在原始实例上）。

注意没有括号会更清楚吗？

```
f => f.Value 
```

你实际上在做的事情类似于`Select`- 所以类似的东西*会* `SafeSelect`是一个好名字，IMO（但可能不完全是......）。

甚至简单地说`Dereference`，只要参数名称（等）明确第二个参数的用途。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-20T13:38:15.690

这也可以很容易地扩展：

```
public static TResult Coalesce<T, TResult>(this T obj, Func<T, TResult> func, TResult defaultValue)
{
    if (obj == null)
        return defaultValue;

    return func(obj);
}

public static TResult Coalesce<T1, T2, TResult>(this T1 obj, Func<T1, T2> func1, Func<T2, TResult> func2, TResult defaultValue)
{
    if (obj == null)
        return defaultValue;

    T2 obj2 = func1(obj);
    if (obj2 == null)
        return defaultValue;

    return func2(obj2);
}

public static TResult Coalesce<T1, T2, T3, TResult>(this T1 obj, Func<T1, T2> func1, Func<T2, T3> func2, Func<T3, TResult> func3, TResult defaultValue)
{
    if (obj == null)
        return defaultValue;

    T2 obj2 = func1(obj);
    if (obj2 == null)
        return defaultValue;

    T3 obj3 = func2(obj2);
    if (obj3 == null)
        return defaultValue;

    return func3(obj3);
}

public static TResult Coalesce<T1, T2, T3, T4, TResult>(this T1 obj, Func<T1, T2> func1, Func<T2, T3> func2, Func<T3, T4> func3, Func<T4, TResult> func4, TResult defaultValue)
{
    if (obj == null)
        return defaultValue;

    T2 obj2 = func1(obj);
    if (obj2 == null)
        return defaultValue;

    T3 obj3 = func2(obj2);
    if (obj3 == null)
        return defaultValue;

    T4 obj4 = func3(obj3);
    if (obj4 == null)
        return defaultValue;

    return func4(obj4);
} 
```

可以这样使用：

```
BinaryTreeNode node = LocateNode(someKey);
BinaryTreeNode grandFatherNode = node.Coalesce(n1 => n1.Parent, n2 => n2.Parent, null); 
```

这将取代：

```
BinaryTreeNode grandFatherNode = node.Parent.Parent; // or null if none 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-20T10:33:48.847

看起来足够可读，虽然它仍然有点笨拙。

不过，这似乎是实现[空对象模式](http://en.wikipedia.org/wiki/Null_Object_pattern)的绝佳机会。

考虑：

```
public class Foo
{
  public Foo(string value) { Value=value; }
  public string Value { get; private set; }
  private static Foo nullFoo = new Foo("default value");
  public static Foo NullFoo { get { return nullFoo; } }
} 
```

然后让 getSomeFoo() 返回 Foo.NullFoo 而不是 null。它需要一些额外的思考，但通常会产生更好的代码。

更新以回应评论：

假设您不控制 Foo，您仍然可以（经常）执行此操作（无论如何，这都是您想要实现的方式）：

```
public class NullFoo : Foo
{
    private NullFoo() : base("default value") { }
    private static NullFoo instance = new NullFoo();
    public static Foo Instance { get { return instance; } }
} 
```

然后从 getSomeFoo() 返回 NullFoo.Instance。如果您也不控制 getSomeFoo()，您仍然可以选择执行此操作：

```
Console.WriteLine((getSomeFoo() ?? NullFoo.Instance).Value); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T10:49:32.380

如果你经常在代码库中使用它，我认为它很好，因为它在第一次阅读时并不太难理解，并且减少了代码的大小——这样可以帮助我从树上看到木头。

但是 if 只使用 1 或 2 次，我认为“in line” *if*会更好，因为我第一次看到它时不会考虑“if”的含义。

“in line” if - 我的意思是一个正常的 if 语句，它没有隐藏在单独的方法中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-02-01T21:39:30.897

好帖子！我更新了您的代码以支持返回 Nullable，因为 Nullable 是作为结构实现的。

```
 public static class Coalesce
    {
        public static TResult UntilNull<T, TResult>(T obj, Func<T, TResult> func) where TResult : class
        {
            if (obj != null) return func(obj);
            else return null;
        }

        public static TResult UntilNull<T1, T2, TResult>(T1 obj, Func<T1, T2> func1, Func<T2, TResult> func2) where TResult : class
        {
            if (obj != null) return UntilNull(func1(obj), func2);
            else return null;
        }

        public static TResult UntilNull<T1, T2, T3, TResult>(T1 obj, Func<T1, T2> func1, Func<T2, T3> func2, Func<T3, TResult> func3) where TResult : class
        {
            if (obj != null) return UntilNull(func1(obj), func2, func3);
            else return null;
        }

        public static TResult UntilNull<T1, T2, T3, T4, TResult>(T1 obj, Func<T1, T2> func1, Func<T2, T3> func2, Func<T3, T4> func3, Func<T4, TResult> func4) where TResult : class
        {
            if (obj != null) return UntilNull(func1(obj), func2, func3, func4);
            else return null;
        }

        public static Nullable<TResult> UntilNull<T, TResult>(T obj, Func<T, Nullable<TResult>> func) where TResult : struct
        {
            if (obj != null) return func(obj);
            else return new Nullable<TResult>();
        }

        public static Nullable<TResult> UntilNull<T1, T2, TResult>(T1 obj, Func<T1, T2> func1, Func<T2, Nullable<TResult>> func2) where TResult : struct
        {
            if (obj != null) return UntilNull(func1(obj), func2);
            else return new Nullable<TResult>();
        }

        public static Nullable<TResult> UntilNull<T1, T2, T3, TResult>(T1 obj, Func<T1, T2> func1, Func<T2, T3> func2, Func<T3, Nullable<TResult>> func3) where TResult : struct
        {
            if (obj != null) return UntilNull(func1(obj), func2, func3);
            else return new Nullable<TResult>();
        }

        public static Nullable<TResult> UntilNull<T1, T2, T3, T4, TResult>(T1 obj, Func<T1, T2> func1, Func<T2, T3> func2, Func<T3, T4> func3, Func<T4, Nullable<TResult>> func4) where TResult : struct
        {
            if (obj != null) return UntilNull(func1(obj), func2, func3, func4);
            else return new Nullable<TResult>();
        }
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-01-26T13:32:38.287

为什么不写下正常的合并函数，然后你可以这样使用它：

```
coalesce(something, something_else, "default"); 
```

换句话说——你需要 lambdas 做什么？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-07-21T13:48:11.703

六年后，[**空条件运算符**](https://github.com/dotnet/roslyn/wiki/New-Language-Features-in-C%23-6#null-conditional-operators)出现了：

> 有时代码往往会淹没在空检查中。空条件运算符允许您仅在接收者不为空时访问成员和元素，否则提供空结果：
> 
> ```
> int? length = customers?.Length; // null if customers is null Customer
> first = customers?[0];  // null if customers is null 
> ```
> 
> 空条件运算符可以方便地与空合并运算符 ?? 一起使用：
> 
> ```
> int length = customers?.Length ?? 0; // 0 if customers is null 
> ```
> 
> 空条件运算符表现出短路行为，其中紧随其后的成员访问链、元素访问和调用仅在原始接收者不为空时才会执行：
> 
> ```
> int? first = customers?[0].Orders.Count(); 
> ```
> 
> 这个例子本质上等同于：
> 
> ```
> int? first = (customers != null) ? customers[0].Orders.Count() : null; 
> ```
> 
> 除了客户只被评估一次。没有紧跟在 ? 之后的成员访问、元素访问和调用。除非客户具有非空值，否则将执行。
> 
> 当然，空条件运算符本身可以被链接起来，以防需要在链中多次检查 null：
> 
> ```
> int? first = customers?[0].Orders?.Count(); 
> ```
> 
> 请注意，调用（带括号的参数列表）不能立即跟在 ? 运算符——这会导致太多的语法歧义。因此，仅当委托存在时才调用委托的直接方式是行不通的。但是，您可以通过委托上的 Invoke 方法来执行此操作：
> 
> ```
> if (predicate?.Invoke(e) ?? false) { … } 
> ```
> 
> 我们希望这种模式的一个非常常见的用途是触发事件：
> 
> ```
> PropertyChanged?.Invoke(this, args); 
> ```
> 
> 这是在触发事件之前检查 null 的简单且线程安全的方法。它是线程安全的原因是该功能仅评估左侧一次，并将其保存在临时变量中。

# asp.net - ASP.NET + VB.NET 中的 Excel 导出错误

> ID：665558
> 
> 赞同：2
> 
> 时间：2009-03-20T10:08:02.590
> 
> 标签：asp.net, vb.net

我们在我们的应用程序代码中使用一小部分 excel 导出代码，使用以下代码将 XML 控件从我们的 ASP 页面导出为 excel 格式：

```
 Public Shared Sub Export(ByRef xml As Xml, ByVal filename As String)
    Dim response As HttpResponse = HttpContext.Current.Response()
    response.Clear()
    response.AddHeader("content-disposition", "attachment;filename=" & filename & ".xls")
    response.ContentType = "application/vnd.ms-excel"
    Dim s As System.IO.StringWriter = New System.IO.StringWriter
    Dim htw As HtmlTextWriter = New HtmlTextWriter(s)
    xml.RenderControl(htw)
    response.Write(s.ToString)
    response.End()
  End Sub 
```

这一切都很好，除了我们遇到了一个相当令人沮丧的错误。如果 XML 控件中有链接，则再次调用导出代码。我们有一个按钮，它会从 .aspx 页面中显示“导出到 Excel”，它只是`ExcelExport.Export(Xml1, "MyFileName")`在`LinkButton`单击事件中调用它。

这是基于表单提交的事件顺序（选择过滤器）

*   输入过滤器
*   提交表格
*   Page_Load 发生
*   提交按钮点击事件发生

点击导出按钮

*   Page_Load
*   导出链接按钮点击事件

到目前为止的快乐日子，但紧接着上一个事件之后，当您单击 XML 控件（呈现的 XSLT 页面）中的超链接时，就会发生这种情况

*   Page_Load
*   导出链接按钮点击事件

因此，用户提交了一个表单，该表单在一个漂亮的可视 XSLT 页面中加载了 XML 控件。然后他们单击“导出到 excel”，这将为他们提供 excel 中的页面，然后他们单击 XSLT 页面，例如一个链接，但 excel 的保存对话框再次出现。我们已经经历了一系列事件，如果我们不调用 excel 导出器，它会像往常一样经历一系列事件。如果我们调用 excel 导出器，它将通过页面加载事件并意外地进入链接按钮单击事件。

我们已经尝试了我们能想到的一切来尝试修复这个错误，但没有任何运气。关于为什么会发生这种情况的任何想法？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-09-01T17:44:13.700

您可以将数据导出为 .csv 文件格式。您可以像这样导出数据：

```
response.Clear()

response.AddHeader("content-disposition", "attachment;filename=" & filename & ".csv")

response.write "1,""John"",""Smith"",1976"+vbcrlf
response.write "2,""Joe"",""Black"",1963"+vbcrlf
response.write "1,""Morgan"",""Smith"",2003"+vbcrlf

response.End() 
```

# java - 在 Java Eclipse 项目中查找未使用的类

> ID：665563
> 
> 赞同：73
> 
> 时间：2009-03-20T10:09:23.460
> 
> 标签：java, eclipse, refactoring

我有一个大型 Eclipse 项目，其中存在几个类，尽管它们已不再在任何地方使用，但从未标记为 @Deprecated。

我怎样才能轻松找到所有这些？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2009-03-20T11:38:49.953

我也喜欢使用[**UCDetector**](http://www.ucdetector.org/index.html)：

![截屏](https://i.stack.imgur.com/NBA01.png)

> UCDetector (Unecessary Code Detector) 是一个开源 eclipse 插件工具，用于查找不必要（死）的公共 java 代码。它还尝试使代码成为最终的、受保护的或私有的。

奖励：它还可以找到类之间的循环依赖关系

（还有[许多其他工具](https://stackoverflow.com/questions/62276/java-package-cycle-detection-how-to-find-the-specific-classes-involved)——包括 Findbugs——也知道如何做到这一点）

* * *

**警告**：[Cid](https://stackoverflow.com/users/966078/cid)[在评论](https://stackoverflow.com/questions/665563/find-unused-classes-in-a-java-eclipse-project/665778#comment16413500_665778)中提到：

> 如果存在仅在运行时才知道的接口实现，则 UCDetector 将不起作用。
> 它错误地将实现类标记为未使用。

* * *

2017 年更新：静态代码分析在 8 年内发生了相当大的变化。
使用[SonarLint for Eclipse](https://www.sonarlint.org/eclipse/)，您可以使用最新的[SonarJava 4.6 插件](https://docs.sonarqube.org/display/PLUG/SonarJava)来分析您的代码。
它会[找到死代码](https://jira.sonarsource.com/browse/RSPEC-901)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-18T11:33:05.997

**[ProGuard](http://proguard.sourceforge.net/#manual/examples.html)**可用于打印未使用的类/方法的报告。但是，向它提供所有依赖的 jar 是一件很痛苦的事情。

这些选项列出了应用程序 mypackage.MyApplication 中未使用的类、字段和方法：

```
-injars      in.jar
-libraryjars <java.home>/lib/rt.jar

-dontoptimize
-dontobfuscate
-dontpreverify
-printusage

-keep public class mypackage.MyApplication {
    public static void main(java.lang.String[]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-26T01:40:54.890

只需使用分析 | 在启用适当检查的情况下检查代码（声明冗余组下的未使用声明）。

使用 IntelliJ 11 CE，您现在可以“分析 | 按名称运行检查 ... | 未使用的声明”

# python - 将命令行结果重定向到 tkinter GUI

> ID：665566
> 
> 赞同：24
> 
> 时间：2009-03-20T10:10:19.060
> 
> 标签：python, user-interface, tkinter

我创建了一个在命令行上打印结果的程序。（它是服务器，它在命令行上打印日志。）

现在，我想看到与 GUI 相同的结果。

**如何将命令行结果重定向到 GUI？**

请提出一个将控制台应用程序轻松转换为简单 GUI 的技巧。

请注意，它应该适用于 Linux 和 Windows。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-03-20T10:23:53.083

您可以创建一个脚本包装器，将命令行程序作为子进程运行，然后将输出添加到文本小部件之类的东西中。

```
from tkinter import *
import subprocess as sub
p = sub.Popen('./script',stdout=sub.PIPE,stderr=sub.PIPE)
output, errors = p.communicate()

root = Tk()
text = Text(root)
text.pack()
text.insert(END, output)
root.mainloop() 
```

其中 script 是您的程序。您显然可以用不同的颜色或类似的颜色打印错误。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-09-20T17:55:36.453

要在 GUI*仍在运行时*显示子进程的输出，适用于 Python 2 和 3 的可移植 stdlib-only 解决方案必须使用后台线程：

```
#!/usr/bin/python
"""
- read output from a subprocess in a background thread
- show the output in the GUI
"""
import sys
from itertools import islice
from subprocess import Popen, PIPE
from textwrap import dedent
from threading import Thread

try:
    import Tkinter as tk
    from Queue import Queue, Empty
except ImportError:
    import tkinter as tk # Python 3
    from queue import Queue, Empty # Python 3

def iter_except(function, exception):
    """Works like builtin 2-argument `iter()`, but stops on `exception`."""
    try:
        while True:
            yield function()
    except exception:
        return

class DisplaySubprocessOutputDemo:
    def __init__(self, root):
        self.root = root

        # start dummy subprocess to generate some output
        self.process = Popen([sys.executable, "-u", "-c", dedent("""
            import itertools, time

            for i in itertools.count():
                print("%d.%d" % divmod(i, 10))
                time.sleep(0.1)
            """)], stdout=PIPE)

        # launch thread to read the subprocess output
        #   (put the subprocess output into the queue in a background thread,
        #    get output from the queue in the GUI thread.
        #    Output chain: process.readline -> queue -> label)
        q = Queue(maxsize=1024)  # limit output buffering (may stall subprocess)
        t = Thread(target=self.reader_thread, args=[q])
        t.daemon = True # close pipe if GUI process exits
        t.start()

        # show subprocess' stdout in GUI
        self.label = tk.Label(root, text="  ", font=(None, 200))
        self.label.pack(ipadx=4, padx=4, ipady=4, pady=4, fill='both')
        self.update(q) # start update loop

    def reader_thread(self, q):
        """Read subprocess output and put it into the queue."""
        try:
            with self.process.stdout as pipe:
                for line in iter(pipe.readline, b''):
                    q.put(line)
        finally:
            q.put(None)

    def update(self, q):
        """Update GUI with items from the queue."""
        for line in iter_except(q.get_nowait, Empty): # display all content
            if line is None:
                self.quit()
                return
            else:
                self.label['text'] = line # update GUI
                break # display no more than one line per 40 milliseconds
        self.root.after(40, self.update, q) # schedule next update

    def quit(self):
        self.process.kill() # exit subprocess if GUI is closed (zombie!)
        self.root.destroy()

root = tk.Tk()
app = DisplaySubprocessOutputDemo(root)
root.protocol("WM_DELETE_WINDOW", app.quit)
# center window
root.eval('tk::PlaceWindow %s center' % root.winfo_pathname(root.winfo_id()))
root.mainloop() 
```

解决方案的本质是：

*   将子进程输出放入后台线程的队列中
*   从 GUI 线程中的队列中获取输出。

即，`process.readline()`在后台线程中调用-> 队列-> 在主线程中更新GUI 标签。相关[`kill-process.py`](https://gist.github.com/zed/42324397516310c86288)（无轮询——`event_generate`在后台线程中使用的便携性较差的解决方案）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-20T12:01:36.700

将标准输出重定向到更新您的 gui 的 write() 方法是一种方法，并且可能是最快的方法 - 尽管运行子进程可能是一种更优雅的解决方案。

但是，只有在您真正确信它已启动并正常工作时才重定向 stderr！

实施示例（gui 文件和测试脚本）：

test_gui.py：

```
from Tkinter import *
import sys
sys.path.append("/path/to/script/file/directory/")

class App(Frame):
    def run_script(self):
        sys.stdout = self
        ## sys.stderr = self
        try:
            del(sys.modules["test_script"])
        except:
            ## Yeah, it's a real ugly solution...
            pass
        import test_script
        test_script.HelloWorld()
        sys.stdout = sys.__stdout__
        ## sys.stderr = __stderr__

    def build_widgets(self):
        self.text1 = Text(self)
        self.text1.pack(side=TOP)
        self.button = Button(self)
        self.button["text"] = "Trigger script"
        self.button["command"] = self.run_script
        self.button.pack(side=TOP)

    def write(self, txt):
        self.text1.insert(INSERT, txt)

    def __init__(self, master=None):
        Frame.__init__(self, master)
        self.pack()
        self.build_widgets()

root = Tk()
app = App(master = root)
app.mainloop() 
```

test_script.py：

```
print "Hello world!"

def HelloWorld():
    print "HelloWorldFromDef!" 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-04-09T22:40:18.050

对不起，我的英语不好。实际上，我使用了一种不同的方式将命令提示符输出打印到我的新自动化工具中。请在下面找到这些步骤。

1> 创建一个 Bat 文件并将其输出重定向到一个 LOG 文件。命令提示符命令：`tasklist /svc`

2> 使用 Python 3.x 读取该文件。`processedFile = open('D:\LOG\taskLog.txt', 'r')

3> 压轴步骤。 `ttk.Label(Tab4, text=[ProcessFile.read()]).place(x=0, y=27)`

**因此请注意，我尚未在此代码中包含滚动条。

发布截图：

[![在此处输入图像描述](https://i.stack.imgur.com/ft3l3.png)](https://i.stack.imgur.com/ft3l3.png)

# c# - C# 结构中的多维数组

> ID：665573
> 
> 赞同：5
> 
> 时间：2009-03-20T10:12:49.490
> 
> 标签：c#, arrays, multidimensional-array

我正在尝试将以下内容（为便于阅读而缩短）转换为 C# 并遇到问题

```
#define DISTMAX 10
struct Distort {
  int    a_order;
  double a[DISTMAX][DISTMAX];
}; 
```

我认为在结构中这是使用“固定”的简单案例，但是我仍然遇到问题。

这是我所拥有的（在页面上方有一个定义）：

```
const int DISTMAX = 10;
struct Distort
{
        int a_order;
        fixed double a[DISTMAX,DISTMAX];
} 
```

我得到的错误是由于我期望是单维数组的限制而导致 ] 和 [ 的语法错误。

有没有解决的办法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-20T10:19:13.453

固定大小的缓冲区只能是一维的。您需要使用：

```
unsafe struct Distort
{
     int a_order;
     fixed double a[DISTMAX * DISTMAX];
} 
```

然后进行适当的算术运算以获得各个值。

# ruby - Ruby 中的那些管道符号是什么？

> ID：665576
> 
> 赞同：75
> 
> 时间：2009-03-20T10:13:29.457
> 
> 标签：ruby, syntax

Ruby 中的管道符号是什么？

我正在学习 Ruby 和 RoR，来自 PHP 和 Java 背景，但我不断遇到这样的代码：

```
def new 
  @post = Post.new

  respond_to do |format|
    format.html # new.html.erb
    format.xml { render :xml => @post }
  end
end 
```

该`|format|`部分在做什么？PHP/Java 中这些管道符号的等效语法是什么？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-03-20T11:10:56.963

它们是产生给块的变量。

```
def this_method_takes_a_block
  yield(5)
end

this_method_takes_a_block do |num|
  puts num
end 
```

输出“5”。一个更神秘的例子：

```
def this_silly_method_too(num)
  yield(num + 5)
end

this_silly_method_too(3) do |wtf|
  puts wtf + 1
end 
```

输出为“9”。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-07-23T20:56:56.547

一开始这对我来说也很奇怪，但我希望这个解释/演练对你有所帮助。

文档以一种非常好的方式[触及了主题](http://www.ruby-lang.org/en/documentation/quickstart/4/)- 如果我的回答没有帮助，我相信他们的指南会。

首先，通过键入`irb`您的 shell 并点击.启动交互式 Ruby 解释器`Enter`。

输入类似：

```
the_numbers = ['ett','tva','tre','fyra','fem'] # congratulations! You now know how to count to five in Swedish. 
```

只是为了让我们有一个数组可以玩。然后我们创建循环：

```
the_numbers.each do |linustorvalds|
    puts linustorvalds
end 
```

它将输出所有数字，以换行符分隔。

在其他语言中，您必须编写如下内容：

```
for (i = 0; i < the_numbers.length; i++) {
    linustorvalds = the_numbers[i]
    print linustorvalds;
} 
```

需要注意的重要一点是，`|thing_inside_the_pipes|`只要您始终如一地使用它，它就可以是任何东西。并且理解我们正在谈论的是循环，这是我直到后来才得到的东西。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-03-05T03:46:50.577

```
@names.each do |name|
  puts "Hello #{name}!"
end 
```

在[http://www.ruby-lang.org/en/documentation/quickstart/4/](http://www.ruby-lang.org/en/documentation/quickstart/4/)附有这样的解释：

> `each`是一种接受代码块的方法，然后为列表中的每个元素运行该代码块，并且 和 之间的位`do`就是`end`这样一个块。块就像一个匿名函数或`lambda`. 竖线字符之间的变量是此块的参数。
> 
> 这里发生的是，对于列表中的每个条目，`name`都绑定到该列表元素，然后`puts "Hello #{name}!"`使用该名称运行表达式。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-20T10:18:33.830

从`do`到的代码`end`定义了一个[Ruby 块](http://en.wikipedia.org/wiki/Ruby_%28programming_language%29#Blocks_and_iterators)。这个词`format`是块的参数。块与方法调用一起传递，被调用的方法可以`yield`为块赋值。

有关详细信息，请参阅任何有关 Ruby 的文本，这是 Ruby 的核心功能，您将一直看到。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-03-20T10:45:19.083

Java中的等价物类似于

```
// Prior definitions

interface RespondToHandler
{
    public void doFormatting(FormatThingummy format);
}

void respondTo(RespondToHandler)
{
    // ...
}

// Equivalent of your quoted code

respondTo(new RespondToHandler(){
    public void doFormatting(FormatThingummy format)
    {
        format.html();
        format.xml();
    }
}); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-03-20T11:01:35.847

块的参数位于`|`符号之间。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-04-27T00:57:51.507

如果需要，为了使其更加清晰：

管道栏本质上是创建一个新变量来保存从之前的方法调用生成的值。类似于：

*您的方法的原始定义：*

```
def example_method_a(argumentPassedIn)
     yield(argumentPassedIn + 200)
end 
```

*如何使用：*

```
example_method_a(100) do |newVariable|
    puts newVariable;
end 
```

这几乎和写这个一样：

```
newVariable = example_method_a(100) 
puts newVariable 
```

其中，newVariable = 200 + 100 = 300：D！

# sql - DB2 - 修改 SQL 数据

> ID：665585
> 
> 赞同：2
> 
> 时间：2009-03-20T10:17:35.033
> 
> 标签：sql, db2

我在 db2 中有一个导致 sqlcode=-577 错误的存储过程。我认为这样做的原因是我没有在我的过程中设置“修改 sql 数据”子句。有没有办法做一个改变程序来设置这个子句，还是我必须删除并重新创建这个程序？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T10:25:31.300

恐怕您将不得不重新创建该过程，因为**[ALTER PROCEDURE](http://publib.boulder.ibm.com/infocenter/db2luw/v8/topic/com.ibm.db2.udb.doc/admin/r0008168.htm)**无法设置该位。幸运的是，这样做并不复杂。

# vb.net - 如何在GridView的所有事件中获取DataTable

> ID：665587
> 
> 赞同：0
> 
> 时间：2009-03-20T10:18:39.210
> 
> 标签：vb.net

我的表单中有一个gridview。页面加载中的FirstTime 通过调用函数“FillgridFileExpenses()”加载gridview。

```
Sub FillgridFileExpenses()
        If txtInvFileNo.Text = String.Empty Then
            objinvoiceT.intfileID = 0
        Else
            objinvoiceT.intfileID = Convert.ToInt32(txtInvFileNo.Text)
        End If
        temptab1 = objinvoiceT.selFileExpensesView()
        temptab1.Columns.Add("AllInRate")
    If (temptab1.Rows.Count > 0) Then
        GridViewInvoiceT.DataSource = temptab1
        dtInvoice = temptab1
        'dtInvoice.Columns.Add("AllInRate")
        GridViewInvoiceT.DataBind()
        GridViewInvoiceT.Columns.Item(10).Visible = True
    Else
        temptab1.Rows.Add(temptab1.NewRow())
        GridViewInvoiceT.DataSource = temptab1
        dtInvoice = temptab1
        GridViewInvoiceT.DataBind()
        Dim TotalColumns As Integer
        TotalColumns = GridViewInvoiceT.Rows(0).Cells.Count
        GridViewInvoiceT.Rows(0).Cells.Clear()
        GridViewInvoiceT.Rows(0).Cells.Add(New TableCell())
        GridViewInvoiceT.Rows(0).Cells(0).ColumnSpan = TotalColumns
        If txtInvFileNo.Text = String.Empty Then
            GridViewInvoiceT.Rows(0).Cells(0).Text = "No Record Found, Must Select a File Number "
        Else
            GridViewInvoiceT.Rows(0).Cells(0).Text = "No Record Found For File Number : " + " " + txtInvFileNo.Text
        End If
    End If
End Sub 
```

在上面的代码中，我使用了一个名为 dtInvoice 的数据表。无论我在 gridview 事件中所做的任何更改，例如删除或更新或添加新行，所有这些都应该反映在 dtInvoice 中而不是数据库中。我在更新事件中获取 dtInvoice，但在删除时dtInvoice 没有行并出现错误。以下是我用于更新和删除的代码

```
Protected Sub GridViewInvoiceT_RowUpdating(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewUpdateEventArgs) Handles GridViewInvoiceT.RowUpdating
    cmbChargeName = CType(GridViewInvoiceT.Rows(e.RowIndex).FindControl("cmbChargeName"), DropDownList)
    cmbInvCurency = CType(GridViewInvoiceT.Rows(e.RowIndex).FindControl("cmbInvCurency"), DropDownList)
    txtInvoiceNo1 = CType(GridViewInvoiceT.Rows(e.RowIndex).FindControl("txtInvoiceNo1"), TextBox)
    txtInvoiceDate1 = CType(GridViewInvoiceT.Rows(e.RowIndex).FindControl("txtInvoiceDate1"), TextBox)
    txtInvAmount1 = CType(GridViewInvoiceT.Rows(e.RowIndex).FindControl("txtInvAmount1"), TextBox)
    txtInvExRate1 = CType(GridViewInvoiceT.Rows(e.RowIndex).FindControl("txtInvExRate1"), TextBox)
    txtInvRemarks1 = CType(GridViewInvoiceT.Rows(e.RowIndex).FindControl("txtInvRemarks1"), TextBox)
    cmbAllinRight = CType(GridViewInvoiceT.Rows(e.RowIndex).FindControl("ddAllInRate"), DropDownList)
    Dim lblAllInRate As Label = CType(GridViewInvoiceT.Rows(e.RowIndex).FindControl("lblAllInRate"), Label)
    objinvoiceT.intfileID = Convert.ToInt32(txtInvFileNo.Text)
     dtInvoice.Rows(e.RowIndex).Item("AllInRate") = cmbAllinRight.SelectedItem
    dtInvoice.Rows(e.RowIndex).Item("ChargeName") = cmbChargeName.SelectedItem
    dtInvoice.Rows(e.RowIndex).Item("InvoiceNo") = txtInvoiceNo1.Text
    If txtInvoiceDate1.Text = String.Empty Then
        dtInvoice.Rows(e.RowIndex).Item("InvoiceDate") = Convert.ToDateTime("1/1/1800")
    Else
        dtInvoice.Rows(e.RowIndex).Item("InvoiceDate") = Convert.ToDateTime(txtInvoiceDate1.Text)
    End If
    dtInvoice.Rows(e.RowIndex).Item("Currency") = cmbInvCurency.SelectedItem
    dtInvoice.Rows(e.RowIndex).Item("InvAmount") = txtInvAmount1.Text
    dtInvoice.Rows(e.RowIndex).Item("InvExRate") = txtInvExRate1.Text
    dtInvoice.Rows(e.RowIndex).Item("InvRemarks") = txtInvRemarks1.Text
    GridViewInvoiceT.EditIndex = -1
    GridViewInvoiceT.DataSource = dtInvoice
    GridViewInvoiceT.DataBind()
    FillInvoice()

End Sub

Protected Sub GridViewInvoiceT_RowDeleting(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewDeleteEventArgs) Handles GridViewInvoiceT.RowDeleting
          dtInvoice.Rows.Remove(GridViewInvoiceT.DataKeys(e.RowIndex).Value)
    GridViewInvoiceT.DataSource = dtInvoice
    GridViewInvoiceT.DataBind()
End Sub 
```

End Sub Sub FillInvoice()

```
 GridViewInvoiceT.DataSource = dtInvoice
    GridViewInvoiceT.DataBind()
End Sub 
```

任何人都可以通过我在删除更新中所做的反射更改来帮助获取 dtInvoice 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T08:53:41.180

在您的 GridViewInvoiceT_RowDeleting 方法中，更改；

```
dtInvoice.Rows.Remove(GridViewInvoiceT.DataKeys(e.RowIndex).Value) 
```

在 DataRow 上使用“删除”方法。

删除 - 删除数据表的行，使您的数据提供者不再注意到该行。通过使用 delete，您将**标记**要删除的行，因此您的提供程序代码会注意到删除，并请求从数据库中删除该行。

# asp.net - 使用 VB.net 和 JavaScript 在标准 .net 2.0 GridView 中选择行

> ID：665590
> 
> 赞同：0
> 
> 时间：2009-03-20T10:19:42.623
> 
> 标签：asp.net, vb.net, gridview, .net-2.0, grid

有谁知道我如何通过单击行中的任何单元格来让网格选择一行？

目前我能做到这一点的唯一方法是将 AutoGenerateSelectButton 属性设置为 True，但这会在网格中添加一个带有粗略“选择”超链接的列，并且只有在单击“选择”一词时才会选择该行。

当然必须有更好的方法！？！？

注意 - 我不使用 C#

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T10:29:48.483

您需要在行中添加一些 javascript`RowDataBound`

```
 e.Row.Attributes["onclick"] = 
                    ClientScript.GetPostBackClientHyperlink
                        (this.GridView1, "Select$" + e.Row.RowIndex); 
```

[这里](http://www.codeproject.com/KB/webforms/JavaRowSelect.aspx)有一篇关于它的 CodeProject 文章，其中更详细。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T19:25:31.780

这是古老的，但这是 VB.NET 的等价物：

```
Dim cs As ClientScriptManager = Page.ClientScript
Dim postbacklink As String = cs.GetPostBackClientHyperlink(lbtnSelectRow, "") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T11:33:40.513

如果不想编写任何代码，请查看[Telerik 网格](http://demos.telerik.com/aspnet-ajax/grid/examples/client/selecting/defaultcs.aspx)的客户端选择。在我的 Web 开发过程中使用它时，我很满意。

# java - 如何在 Java 中执行键值映射的线程安全时间点快照？

> ID：665592
> 
> 赞同：4
> 
> 时间：2009-03-20T10:20:18.457
> 
> 标签：java, serialization, concurrency

在我的应用程序中，我有一个键值映射，它用作存储数据的中央存储库，用于在崩溃或重新启动（检查点）后返回到定义的状态。

该应用程序是多线程的，并且多个线程可以将键值对放入该映射中。一个线程负责定期创建检查点，即将映射序列化到持久存储。

在写入检查点时，地图应保持不变。避免添加新项目相当容易，但是其他线程更改地图内“他们的”对象的成员呢？

我可以有一个对象，它的监视器在检查点开始时被占用，并将对映射的任何成员及其成员的所有写访问包装在与该对象同步的块中。这对我来说似乎很容易出错和乏味。

我还可以将地图设为检查点私有，并且只将提交的对象的副本放入其中。但是我必须确保副本是深层副本，并且我将无法自动更新地图中的数据，每次对提交的对象进行更改时，提交者都必须重新提交它们。这似乎有很多开销并且容易出错，因为我必须记住将重新提交代码放在所有正确的地方。

什么是解决这个问题的优雅可靠的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T10:35:27.360

> 其他线程如何更改地图内“他们的”对象的成员

在这里你有一个问题:) 任何类型的地图都无法解决它......

一种解决方案是在 Map 中只允许不可变对象，但这对您来说可能是不可能的。

否则，您必须为所有可能更改地图引用的数据的线程共享一个锁，并在快照期间将它们全部阻塞；但这是一个停止世界的方法......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T14:24:23.643

pgras 是正确的，不变性可以解决问题，但这也很困难。你可以锁定整个东西，但这可能是一个性能问题。我能想到两个好主意。

首先是使用[ReadWriteLock](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/locks/ReadWriteLock.html)（需要 1.5 或更高版本）。由于您的检查点可以获取读取锁，因此可以确保事情是安全的，但是当没有人读取时，性能应该是相当不错的。这仍然是一个相当粗糙的锁，所以你可能还想做#2 ...

二是拆散东西。程序的每个区域都可以保留自己的地图（GUI 的地图、用户设置的地图、硬件设置的地图等等）。每个人都会有一把锁，事情会照常进行。当需要检查点时，检查点会抓住所有的锁（所以事情是一致的），然后完成它的工作。这里的问题是你已经定义了一个锁定的顺序（比如按字母顺序），否则你最终会出现死锁。

如果地图彼此正交（对一个地图的更新不需要对另一个地图的更新保持一致），那么最简单的方法可能是将更新推送到检查点中的中央“备份”地图，与您描述的内容不同。

我对您最大的问题是，这有多大问题（性能方面）？更新非常频繁，还是很少见？这将有助于就某些事情提供建议，因为我的最后一个想法（上一段）可能很慢，但这很容易而且可能并不重要。

有一本很棒的书叫做[Java Concurrency in Practice](http://jcip.net/)，它基本上是 Java 线程的圣经。它讨论了如何找出这类东西和策略来避免问题或使解决问题更容易。如果你打算做更多的线程，这是一本非常有用的读物​​。

实际上，如果您的键值彼此正交，那么事情就很容易了。[ConcurrentMap](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ConcurrentMap.html)接口（有诸如[ConcurrentHashMap](http://java.sun.com/j2se/1.5.0/docs/api/java/util/concurrent/ConcurrentHashMap.html)之类的实现）可以解决您的问题，因为它们可以原子地进行更改，因此读者不会看到不一致的数据。但是，如果您有任何两个（或更多）必须同时更新的密钥，则不会涵盖您。

我希望这有帮助。对共享数据结构的线程访问是复杂的东西。

# sharepoint - 获取多页会议工作区的页面

> ID：665595
> 
> 赞同：0
> 
> 时间：2009-03-20T10:23:01.213
> 
> 标签：sharepoint, moss, sitetemplate

我目前对多页会议工作区模板进行了一些测试，以检查它是否符合我们作为项目基础模板的需求。

您可能知道，多页会议工作区旨在能够管理单个工作区中的多个日期，并显示仅与特定日期相关的页面或应在每个日期出现的页面。

如果您使用 SharePoint Designer 检查多页会议工作区，您会看到有一个包含工作区所有页面的库。在每个日期显示的页面存储在根文件夹中，仅在单个日期显示的页面存储在以相应日期命名的文件夹中。

所以现在我们来解决我的问题。为了设置每个日期显示的单个页面的权限，我遍历页面库以找到我想要更改权限的页面。奇怪的是，库的 ListItemCollection 假装包含我期望它包含的页数。但是当我然后迭代集合时，它只返回附加到实际日期的页面。它既不返回应该在每个日期显示的页面，也不返回其他日期的页面。

我已经尝试通过使用 SPSecruity.RunWithElevatedPrivilges() 并模拟作为系统帐户来获取页面。我还尝试在不使用任何上下文信息的情况下通过命令行应用程序获取它们。似乎只能获取与特定日期相关的项目的行为也遵循对象模型。

那么，无论实际日期如何，我如何才能获得多页会议工作区的所有页面？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T15:24:40.420

您可以在工作区创建时刻和以编程方式设置权限时捕获事件。您可能想了解有关[事件接收器](http://www.davehunter.co.uk/Blog/Lists/Posts/Post.aspx?List=f0e16a1a-6fa9-4130-bcab-baeb97ccc4ff&ID=69)或以[编程方式设置权限](http://blogs.msdn.com/robgruen/archive/2007/11/15/how-to-programmatically-set-permissions-on-files-folders-in-a-sharepoint-document-library.aspx)的更多信息。

您提到的那些页面是添加到名为“会议系列”的列表中的项目 [alt text http://img22.imageshack.us/img22/8963/ss20090528181724.png](http://img22.imageshack.us/img22/8963/ss20090528181724.png)

它包含以下字段：

[替代文字 http://img22.imageshack.us/img22/351/ss20090528181819.png](http://img22.imageshack.us/img22/351/ss20090528181819.png) [替代文字 http://img22.imageshack.us/img22/7857/ss20090528181852.png](http://img22.imageshack.us/img22/7857/ss20090528181852.png)

来自 1 项的示例数据（未按列的顺序排列）：

```
3   0x001C4383A41E441842A2A27CA249FED28F    Meeting Series  Recurrence  2009-05-28 18:11:20 2009-05-28 18:11:12 1073741823;#Sistēmas konts  1073741823;#Sistēmas konts  1   1   512 1.0 0   0   Recurrence  Recurrence  3   100.000000000000    {A6E54DB5-3A60-464B-A9A0-D314B49C41E8}  3;#test2/Recurrence/Lists/Meeting Series/1_2.000    3;#test2/Recurrence/Lists/Meeting Series    3;#2009-05-28 18:11:20  3;#2009-05-28 18:11:20  3;#0    0x7fffffffffffffff  3;#1_2.000  3;#{6BE299E5-E81F-40A8-80B2-41494DF0353C}   3;# 3;#{965D0DB3-1AE0-4C23-B006-FB4FC1FE1AB7}   1_2.000 3   1_2.000 1_2.000 /test2/Recurrence/Lists/Meeting Series/1_2.000  http://test:10000/test2/Recurrence/Lists/Meeting%20Series/1_2.000   1_2 3;# 1   1   2   {D8839339-6DDA-48A6-B3B7-FBCA58C8B436}  2009-06-03 19:00:00 2009-06-03 19:00:00 (null)  (null)  (null)  0   1   (null)  0   0   0   2009-05-28 18:10:57 (null)  http://test:10000/test2/Lists/Calendar, Kalendārs   2009-06-03 19:00:00 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T16:43:33.247

此类事件的页面仅在用户尝试访问它们时才会创建。这是设计使然，我发现的唯一解决方案是尝试通过网站（或某些仿真）访问页面，然后尝试通过代码访问它们。

关于 Flo 的评论，我在 Microsoft Sharepoint 2007 Development unleashed (sams, ISBN 0-672-32903-4) 上找到了它的来源。在第 101 页上说：

> 警告
> 
> 从定期会议中获取数据可能很棘手。您可能会遇到代码尝试访问尚未在会议系列列表中配置的会议事件的列表项的情况。为确保已创建单个实例，您可以向实例的主页发出虚拟 Web 请求，例如： [http://server/sites/mymeeting/default.aspx?InstanceID=20061012](http://server/sites/mymeeting/default.aspx?InstanceID=20061012)

如果您找到其他方法，请发布它会为我们节省很多精力！

# git - 在 git 中切换分支时，如何让 Emacs 恢复所有未更改的缓冲区？

> ID：665600
> 
> 赞同：55
> 
> 时间：2009-03-20T10:24:24.470
> 
> 标签：git, emacs, elisp, aquamacs

通常，当我在 git 中切换分支时，如果文件在 emacs 中打开，那么即使内容相同，emacs 也会询问我是否要还原它们（因为它认为它们在磁盘上已更改）。

首先，如果磁盘上的内容与缓冲区中的内容相同，我想找到一种让emacs根本不问我的方法。

其次，我想要一个命令，它可以还原（不查询）我所有没有未保存更改的打开缓冲区，并询问我那些确实有未保存更改的缓冲区。

或者，我愿意接受有关我可以尝试的其他解决方案、工作方式等的建议。如果人们可以指点我从哪里开始，我会很高兴编写 emacs-lisp。

PS 如果这很重要，我在 OSX 上使用 Aquamacs。

编辑：

好吧，我发现 revbuffs 包几乎是我所需要的。当然足以阻止我想尝试自己写任何新东西。（我将 revbuffs 映射到 Cmd-R，效果很好。有点类似于其他 Mac 应用程序中的 Cmd-R）。

全局自动还原模式将是一个非常好的解决方案，我希望我可以选择两个答案。我更喜欢 revbuffs 仅仅是因为一种可能是非理性的想要控制所发生的事情的感觉。

我有点猜测，如果我从 emacs 中访问 git，那么它可能会更容易处理，但我目前更喜欢通过命令行访问 git。（我使用 emacs 的时间还不够长，无法将其作为我的操作系统）。不过，我会更彻底地调查 magit。

编辑2：

我已经使用 magit 一年了，强烈推荐它在 emacs 中处理 git。但是，每当我在 emacs 之外进行 rebase 时，我仍然使用 revbuffs。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-03-20T11:43:54.873

也许您想要全局自动恢复模式。尝试运行`global-auto-revert-mode`，如果你喜欢它，你可以添加`(global-auto-revert-mode)`到你的 ~/.emacs 文件中。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-20T12:49:57.850

试试[revbufs 包](http://www.neilvandyke.org/revbufs/)：

> `revbufs.el`是一个很小的 ​​Emacs 包，当您在 Emacs 中和通过外部工具（例如，代码生成器，如[Jomtool](http://www.neilvandyke.org/jomtool/)）编辑文件时，它可以安全地恢复缓冲区...

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-20T11:16:48.230

Magit 包会在您激活时自动执行此操作[`magit-ionotify-mode`](http://www.emacswiki.org/emacs/Magit#toc6)（Linux 上的 inotify 需要 emacs 24.4）。你可以在[这里](http://xtalk.msk.su/~ott/en/writings/emacs-vcs/EmacsGit.html#sec12)找到它的描述。

# asp.net - ASP.NET：如何更改验证失败的控件的背景颜色？

> ID：665603
> 
> 赞同：3
> 
> 时间：2009-03-20T10:24:32.877
> 
> 标签：asp.net, validation

我们以下面这个简单的站点为例：

```
<asp:TextBox id="TextBox1" 
runat="server"></asp:TextBox>
&nbsp; 
<asp:RequiredFieldValidator 
id="RequiredFieldValidator1" runat="server" 
ErrorMessage="Required!" 
ControlToValidate="TextBox1">
</asp:RequiredFieldValidator> 
```

现在，我希望在验证失败时`TextBox1`将其更改为黄色。`BackColor`有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-20T11:03:26.543

Page.Validators 是一个 ValidatorCollection。您可以迭代此集合，将每个成员转换为 BaseValidator。检查 BaseValidator.IsValid 并从 BaseValidator.ControlToValidate 获取控件的名称。使用 this.FindControl(control name) 获取对控件的引用（这将返回一个 Control 对象）。执行您需要执行的任何类型检查和转换，然后如果您可以将控件转换为 TextBox 或其他包含 BackColor 属性的控件，请对其进行转换并设置 BackColor。

这是一个简化版本：

```
 private void setInvalidControlsBackColor()
    {
        Control c;
        TextBox t;
        foreach (BaseValidator v in Page.Validators)
        {
            if (!v.IsValid)
            {
                c = (Control)this.FindControl(v.ControlToValidate);
                // check the type, make sure you can cast this...
                t = (TextBox)c;
                t.BackColor = Color.Yellow;
                // or however else you want to handle this...
            }
        }
    } 
```

我没有包含类型检查代码的原因是因为您可能希望以不同方式处理不同的控件类型等。此外，如果您没有在验证器上使用 ToolTip 字段，则可以使用此字段来存储附加信息（有点像 Tag 属性）。这可能被认为是丑陋的做法，但如果你需要它，它就在那里……可以用作提示如何处理有效/无效状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T11:33:59.403

更好的选择是从系统验证器继承并创建自己的验证器。您可以覆盖默认行为以更改 ControlToValidate 字段的背景颜色。对于大多数不需要检查类型的控件，只需将样式值设置为“背景颜色：黄色”即可。

# groovy - 我可以在 Groovy 中使用 AST 转换来扩展其语法吗？

> ID：665609
> 
> 赞同：1
> 
> 时间：2009-03-20T10:27:42.793
> 
> 标签：groovy, abstract-syntax-tree

我已经看到了如何使用 Groovy AST 转换来扩展语言的示例，例如在方法调用之前和之后进行记录，如此[处所示](http://groovy.codehaus.org/Local+AST+Transformations)。但是，是否也可以使用这个框架来扩展语言本身的语法？例如，如果我希望能够将以下内容解析并转换为 AST，然后生成一组语句，该怎么办：

```
newClassKeyword C { /* something here */ } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-23T01:42:17.057

我不是 Groovy 专家，但我一直在研究 1.6 版本中出现的一些新框架，我特别感兴趣的是[Spock](http://code.google.com/p/spock/)。这可能正是您正在寻找的，因为他们使用 AST 转换来定义用于测试的整个规范语言。

我忘了补充一点，InfoQ[有一篇文章](http://www.infoq.com/articles/groovy-1-6)概述了 Groovy 1.6 的新特性。Guillaume LaForge 撰写了这篇文章，并在其中描述了一些关于 AST 的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-31T00:20:13.037

您无法使用 AST 转换来扩展 Groovy 的语法，但您可以为现有语法赋予全新的语义。因为 Groovy 的语法非常灵活，这可以让您走得很远。

# sql - 有效存储 7.300.000.000 行

> ID：665614
> 
> 赞同：23
> 
> 时间：2009-03-20T10:32:09.537
> 
> 标签：sql, mysql, database, data-warehouse, large-data-volumes

您将如何解决以下存储和检索问题？

每天（365 天/年）将添加大约 2.000.000 行，每行包含以下信息：

*   id（唯一的行标识符）
*   entity_id（取值介于 1 和 2.000.000 之间）
*   date_id（每天递增一个 - 取值在 1 到 3.650 之间（十年：1*365*10））
*   value_1（取值介于 1 和 1.000.000 之间）
*   value_2（取值介于 1 和 1.000.000 之间）

entity_id 与 date_id 结合是唯一的。因此，每个实体和日期最多可以添加一行到表中。数据库必须能够保存 10 年的每日数据（7.300.000.000 行 (3.650*2.000.000)）。

上面描述的是写入模式。读取模式很简单：所有查询都将针对特定的 entity_id 进行。即检索所有描述 entity_id = 12345 的行。

不需要事务支持，但存储解决方案必须是开源的。理想情况下，我想使用 MySQL，但我愿意接受建议。

现在 - 你将如何解决所描述的问题？

**更新：**我被要求详细说明读写模式。每天将在一批中完成对表的写入，其中将一次性添加新的 2M 条目。读取将连续进行，每秒读取一次。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-03-20T10:44:49.787

**“现在——你将如何解决所描述的问题？”**

使用简单的平面文件。

这就是为什么

> “所有查询都将针对特定的 entity_id 进行。即检索所有描述 entity_id = 12345 的行。”

您有 2.000.000 个实体。基于实体编号的分区：

```
level1= entity/10000
level2= (entity/100)%100
level3= entity%100 
```

每个数据文件是`level1/level2/level3/batch_of_data`

然后，您可以读取目录给定部分中的所有文件以返回样本进行处理。

如果有人想要一个关系数据库，那么将给定 entity_id 的文件加载到数据库中供他们使用。

* * *

**编辑** 日期数。

1.  `date_id`/`entity_id`唯一性规则*不是*必须处理的。它（a）微不足道地强加在文件名上，并且（b）与查询无关。

2.  “`date_id`翻转”没有任何意义——没有查询，所以没有必要重命名任何东西。应该从`date_id`纪元日期开始不受约束地增长。如果要清除旧数据，请删除旧文件。

由于没有查询依赖于`date_id`，因此无需对其进行任何操作。它可以是所有重要的文件名。

要将 包含`date_id`在结果集中，请将其与文件每一行中的其他四个属性一起写入文件中。

* * *

**编辑**打开/关闭

对于写作，您必须让文件保持打开状态。您会定期刷新（或关闭/重新打开）以确保这些东西真的会进入磁盘。

对于您的作家的架构，您有两种选择。

1.  有一个单一的“编写者”进程来整合来自不同来源的数据。如果查询相对频繁，这将很有帮助。您需要为在写入时合并数据付费。

2.  同时打开多个文件进行写入。查询时，将这些文件合并为一个结果。这很有帮助，因为查询相对较少。您需要为在查询时合并数据付费。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-20T10:36:56.187

使用[分区](http://dev.mysql.com/doc/refman/5.1/en/partitioning.html)。使用您的读取模式，您希望按`entity_id`哈希进行分区。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-20T10:36:42.537

你可能想看看这些问题：

[大主键：1+ 十亿行 MySQL + InnoDB？](https://stackoverflow.com/questions/365380/large-primary-key-1-billion-rows-mysql-innodb)

[大型 MySQL 表](https://stackoverflow.com/questions/354020/large-mysql-tables)

就个人而言，我还考虑计算你的行宽，让你了解你的表有多大（根据第一个链接中的分区说明）。

HTH.,

小号

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-03-21T03:51:33.143

您的应用程序似乎与我的应用程序具有相同的特征。我写了一个 MySQL 自定义存储引擎来有效地解决这个问题。描述[here](http://blog.coldlogic.com:80/categories/coldstore/)

想象一下，您的数据以 2M 固定长度条目（每个实体一个）的数组形式排列在磁盘上，每个条目包含 3650 行（每天一个）20 字节（每天一个实体的行）。

您的阅读模式读取一个实体。它在磁盘上是连续的，因此需要 1 次搜索（大约 8 毫升秒）并以 100MB/秒的速度读取 3650x20 = 大约 80K ......所以它在几分之一秒内完成，轻松满足您每秒 1 次查询的读取图案。

更新必须在磁盘上 2M 个不同的位置写入 20 个字节。在最简单的情况下，这需要 2M 次查找，每次查找大约需要 8 毫秒，因此需要 2M*8ms = 4.5 小时。如果将数据分布在 4 个“raid0”磁盘上，则可能需要 1.125 小时。

然而，这些地方相距仅 80K。这意味着在 16MB 块（典型的磁盘缓存大小）内有 200 个这样的位置，因此它可以以高达 200 倍的速度运行。（1 分钟）现实介于两者之间。

我的存储引擎就是按照这种理念运行的，尽管它比固定长度的数组更通用一点。

您可以完全按照我的描述编写代码。将代码放入 MySQL 可插拔存储引擎意味着您可以使用 MySQL 通过各种报告生成器等查询数据。

顺便说一句，您可以从存储的行中删除日期和实体 id（因为它们是数组索引）并且可能是唯一的 id - 如果您真的不需要它，因为 (entity id, date) 是唯一的，并且将 2 个值存储为 3 字节 int。那么您存储的行是 6 个字节，每 16M 有 700 次更新，因此插入速度更快，文件更小。

**编辑**与平面文件比较

我注意到评论普遍偏爱平面文件。不要忘记目录只是文件系统实现的索引，它们通常针对相对较少的相对较大的项目进行优化。对文件的访问通常经过优化，因此它期望打开的文件数量相对较少，并且打开和关闭以及每个打开的文件的开销都相对较高。所有这些“相对”都与数据库的典型使用有关。

使用文件系统名称作为我认为是 1 到 2Million 的非稀疏整数的实体 ID 的索引是违反直觉的。例如，在编程中，您将使用数组，而不是哈希表，并且您不可避免地会为昂贵的访问路径带来大量开销，而访问路径可能只是数组 indeing 操作。

因此，如果您使用平面文件，为什么不只使用**一个平面文件**并对其进行索引呢？

**性能**编辑****

 **该应用程序的性能将取决于磁盘寻道时间。我在上面所做的计算确定了你能做的最好的事情（尽管你可以通过减慢 SELECT 来加快 INSERT - 你不能让它们都变得更好）。无论您使用数据库、平面文件还是一个平面文件都没有关系，**只是**您可以添加更多您并不真正需要的搜索并进一步减慢速度。例如，与“查找数组”相比，索引（无论是文件系统索引还是数据库索引）会导致额外的 I/O，这些会减慢您的速度。

**编辑**基准测量

我有一张看起来很像你的桌子（或者几乎完全像你的一个分区）。它是 64K 实体而不是 2M（你的 1/32）和 2788 个“天”。该表的创建顺序与您的插入顺序相同，并且具有相同的索引 (entity_id,day)。一个实体上的 SELECT 需要 20.3 秒来检查 2788 天，这大约是预期的每秒 130 次寻道（在 8 毫秒平均寻道时间的磁盘上）。SELECT 时间将与天数成正比，而不太依赖于实体的数量。（它在具有更快寻道时间的磁盘上会更快。我在 RAID0 中使用了一对 SATA2，但这并没有太大区别）。

如果您将表重新排序为实体顺序 ALTER TABLE x ORDER BY (ENTITY,DAY) 则相同的 SELECT 需要 198 毫秒（因为它是在单个磁盘访问中读取订单实体）。但是，ALTER TABLE 操作需要 13.98 天才能完成（对于 182M 行）。

测量结果告诉您其他一些事情 1\. 您的索引文件将与您的数据文件一样大。此示例表为 3GB。这意味着（在我的系统上）所有索引都以磁盘速度而不是内存速度。

2.您的 INSERT 率将呈对数下降。插入数据文件是线性的，但插入索引的键是 log。在 180M 记录时，我每秒获得 153 次 INSERT，这也非常接近搜索速率。它表明 MySQL 正在为几乎每个 INSERT 更新一个叶索引块（正如您所期望的，因为它是在实体上编制索引但按天顺序插入的。）。因此，您正在查看 2M/153 秒 = 3.6 小时来完成 2M 行的每日插入。（除以您可以通过跨系统或磁盘分区获得的任何效果）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-20T10:46:29.143

我有[类似的问题](https://stackoverflow.com/questions/397410/database-design-question)（尽管规模更大 - 关于您每天的年度使用量）

使用一张大桌子让我停下来——你可以拉几个月，但我想你最终会把它分区。

不要忘记为表建立索引，否则每次查询都会弄乱微小的数据；哦，如果您想进行大量查询，请[使用平面文件](https://stackoverflow.com/questions/436251/mysql-performance-bottlenecks)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-20T10:43:17.497

您对阅读模式的描述不充分。您需要描述将检索的数据量、查询的频率和偏差程度。

这将允许您考虑对某些列进行压缩。

还要考虑归档和分区。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-10-24T04:07:42.883

如果要处理数百万行的海量数据，可以认为它类似于时间序列数据库，它记录时间并将数据保存到数据库中。一些存储数据的方法是使用 InfluxDB 和 MongoDB。

# sql-server - 如何创建 SQL Server 2005 CTE 以返回父子记录，用于具有多个父项的子项

> ID：665617
> 
> 赞同：4
> 
> 时间：2009-03-20T10:32:32.360
> 
> 标签：sql-server, sql-server-2005, common-table-expression, parents

我正在 SQL Server 中试验 CTE，但在使以下场景正常工作时已经走到了死胡同。我有一个类似于这样的层次结构表：

```
Node(ID:439)
  Node(ID:123)
    Node(ID:900)        
  Node(ID:56)
    Node(ID:900) 
```

预期成绩：

```
NodeID ParentNodeID
439    0
123    439
900    123
56     439
900    56 
```

所以基本上我们有一个父子层次表，有一个细微的区别。每个孩子可能有不止一个父母。我研究了许多博客文章和 StackOverflow 帖子，关于创建返回父子记录的 CTE，但它们并没有返回孩子的所有父母，只是它找到的第一个。

这是我尝试的示例 CTE：

```
WITH Hierarchy(NodeID, ParentNodeID)
AS
(
    SELECT 
        T1.NodeID,
          T1.ParentNodeID
    FROM
        ParentChildTable T1
    WHERE
        T1.NodeID = 439

    UNION ALL
    SELECT 
        T1.NodeID,
        T1.ParentNodeID
    FROM
        Heirarchy T1
        INNER JOIN Heirarchy TH ON TH.NodeID = T1.ParentNodeID
) 
```

（注：为保护隐私，上述 CTE 中的表名和列名已从原始更改。）

上面的 CTE 工作正常，它找到了从 ID:439 开始的所有父子记录，但它只找到了 ID:900 的一个父项，即使它有两个父项。

有人可以让我知道这是否可以使用 CTE，或者是否有另一种 SQL 方法可以做到这一点？

干杯。贾斯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-20T10:54:35.630

一旦我更正了 CTE 中的语法错误，这对我来说似乎可以正常工作：

```
create table #ParentChildTable 
(nodeID int not null
,parentNodeID int not null
)

insert #ParentChildTable 
select 900,56
union all select 900,123
union all select 123,439
union all select 56,439
union all select 439,0

;WITH Heirarchy
AS
(
    SELECT 
        T1.NodeID,
          T1.ParentNodeID
    FROM
        #ParentChildTable T1
    WHERE
        T1.NodeID = 439

    UNION ALL
    SELECT 
        T1.NodeID,
        T1.ParentNodeID
    FROM
        #ParentChildTable T1
        INNER JOIN Heirarchy TH ON TH.NodeID = T1.ParentNodeID
)
select *
from Heirarchy 
```

返回结果：

```
NodeID      ParentNodeID
----------- ------------
439         0
123         439
56          439
900         56
900         123 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T01:33:24.747

这是我用来寻找解决方案的链接..

[http://wiki.lessthandot.com/index.php/Using_Common_Table_Expressions_for_Parent-Child_Relationships](http://wiki.lessthandot.com/index.php/Using_Common_Table_Expressions_for_Parent-Child_Relationships)

编辑 - @Pshimo - 谢谢。这是链接中的指南。

使用 SQL 2005 虽然这是一个梦想。假设您有以下示例数据：

```
declare @test table (bunchof uniqueidentifier default newid(), columns uniqueidentifier default newid(), Id int, ParentID int)

insert @test (Id, ParentId)
select 1, null
union all select 5, 1
union all select 15, 2
union all select 16, 5
union all select 27, 16 
```

并且您想获取 1 的所有子行（因此 ItemId 5、16、27）

```
 declare @parentId int
    set @parentId = 1

    ;--last statement MUST be semicolon-terminated to use a CTE
    with CTE (bunchof, columns, Id, ParentId) as
    (
        select bunchof, columns, Id, ParentId
        from @test
        where ParentId = @parentId
        union all
        select a.bunchof, a.columns, a.Id, a.ParentId
        from @test as a
        inner join CTE as b on a.ParentId = b.Id
    )
    select * from CTE 
```

如果你想包括父母：

```
declare @Id int
set @Id = 1

;--last statement MUST be semicolon-terminated to use a CTE
with CTE (bunchof, columns, Id, ParentId) as
(
    select bunchof, columns, Id, ParentId
    from @test
    where Id = @Id
    union all
    select a.bunchof, a.columns, a.Id, a.ParentId
    from @test as a
    inner join CTE as b on a.ParentId = b.Id
)
select * from CTE 
```

如果您喜欢这种情况，您也可以在层次结构中选择深度：

```
declare @Id int
set @Id = 1

;--last statement MUST be semicolon-terminated to use a CTE
with CTE (bunchof, columns, Id, ParentId, Depth) as
(
    select bunchof, columns, Id, ParentId, 0
    from @test
    where Id = @Id
    union all
    select a.bunchof, a.columns, a.Id, a.ParentId, b.Depth + 1
    from @test as a
    inner join CTE as b on a.ParentId = b.Id
)
select * from CTE 
```

如您所见，您在这里所做的是首先选择您的初始记录集，其中包含父 ID 参数的所有子行。然后，您可以联合到另一个连接到 CTE 本身的查询，以获取孩子的孩子（和他们的孙辈，等等，直到您到达最后一个后代行。重要的是要注意默认递归限制为 100，所以请支付使用这些时要注意层次结构的深度。您可以使用 OPTION (MAXRECURSION) 更改递归限制

```
 WITH CTE AS (
    ...
    )
    SELECT * FROM CTE OPTION (MAXRECURSION 1000) 
```

# java - 从命令行编译java

> ID：665619
> 
> 赞同：0
> 
> 时间：2009-03-20T10:33:41.500
> 
> 标签：java, compilation

我有一个名为 studentServer 的包，其中包含两个子包 student 和 common。公共文件夹有对学生包的引用，我希望能够编译它。我怎么能这样做？

```
javac student\*.java - compiles the student package 
```

但是当我尝试与常见包错误类似的东西时 - 我知道这与类路径有关

```
javac -verbose -classpath "\student" common\*.java 
```

但我无法让这个工作。任何帮助都会很棒。

[http://pastebin.com/m2a2f5d5d](http://pastebin.com/m2a2f5d5d) - 这是编译器的输出

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-20T10:36:13.117

这有点含糊，但我怀疑学生代码的类路径是错误的。尝试不使用前导反斜杠。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T10:49:48.497

如果你有一个目录结构

```
source/
      studentServer/
                   student/
                   common/
classes/ 
```

并且您位于源代码上方的目录中，然后您想使用 -sourcepath 选项将源路径设置为“源”。您可能还想使用 -d 选项告诉 javac 将编译的类放在哪里，这样它们就不会全部与源代码混淆：

```
java -d classes -sourcepath source source/studentServer/student/*.java source/studentServer/common/*.java 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-12-02T11:46:13.170

像这样去

`c:\>` 使用更改目录命令 cd 直到获得所需的目录（例如`c:\javaEx\proj1\`：）

现在

`cd javaEx`像这样去

`c:\javaEx\proj1\javac *.java`

现在在 proj1 目录中的所有 java 文件中完成编译。

# sockets - 套接字连接可以多路复用吗？

> ID：665625
> 
> 赞同：5
> 
> 时间：2009-03-20T10:35:46.143
> 
> 标签：sockets, multiplexing

是否可以复用 sa 套接字连接？

我需要建立到 yahoo messenger 的多个连接，并且我正在寻找一种方法来有效地做到这一点，而不必为每个客户端连接打开一个套接字。

到目前为止，我必须为每个客户端使用一个套接字，但这并不能很好地扩展到超过 50,000 个连接。

哦，我的解决方案是针对电信公司的，所以我需要至少达到 250,000 到 500,000 个连接

我计划将多个 IP 地址绑定到单个 NIC，以克服每个 IP 地址的 65k 端口限制。

请我有任何帮助，我能得到的见解。

**我在这个网站上的大多数其他问题都没有得到解答:) **

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T10:53:38.503

虽然您可以在套接字上侦听多个传入连接请求，但在建立连接时，它将服务器上的唯一端口连接到客户端上的唯一端口。为了多路复用连接，您需要控制管道的两端并拥有一个协议，该协议允许您将上下文从一个虚拟连接切换到另一个虚拟连接，或者使用不关心客户端身份的无状态协议。在前一种情况下，您需要在应用程序层中实现它，以便您可以重用现有连接。在后一种情况下，您可以通过使用跟踪哪个服务器响应到哪个客户端的代理来获得。既然你连接到雅虎通，我不认为你'

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T11:30:26.620

这是一个关于在严重情况下扩展的有趣问题。

您实质上是在问，“我如何建立到 Internet 服务的 N 个连接，其中 N >= 250,000”。

有效且高效地做到这一点的唯一方法是集群。您不能在单个主机上执行此操作，因此您需要能够将您的客户端群分割和划分为多个不同的服务器，以便每个服务器只处理一个子集。

这个想法是让单个服务器保持打开尽可能少的连接（均匀地分散连接），同时保持足够的连接以通过将服务器间通信保持在最低水平来使您托管的任何服务都可行。这意味着任何两个相关的连接（例如两个经常互相交谈的帐户）都必须位于同一主机上。

您将需要可以处理此问题的服务器和网络基础设施。您将需要一个 IP 地址子网，每台服务器都必须与 Internet 进行无状态通信（即您的路由器不会进行任何 NAT 以便不必跟踪 250,000 多个连接）。

您将不得不与 AOL 交谈。如果不考虑切断您的连接，AOL 将无法处理这种级别的连接。这种规模的任何服务都必须与 AOL 协商，以便您和他们都能够处理连接。

您应该研究一些 i/o 多路复用技术。想到了 Kqueue 和 epoll。

为了编写这个大规模并发和电信级的解决方案，我建议研究 erlang。Erlang 专为诸如此类的情况而设计（多服务器、大规模多客户端、大规模多线程电信级软件）。它目前用于运行爱立信电话交换机。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T10:51:48.243

如果另一端支持这样的操作，您只能在一个套接字上多路复用多个连接。换句话说，它是一个函数协议——套接字对它没有任何原生支持。

我怀疑 yahoo messenger 协议对它有任何支持。

另一种方法（单个 NIC 上的多个 IP）是设计自己的多路复用协议，并拥有从多路复用协议转换为 yahoo 协议的卫星服务器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T23:23:43.037

我将介绍您可以考虑的另一种方法（取决于您的绝望程度）。

请注意，操作系统 TCP/IP 实现必须是通用的，但您只对非常具体的用例感兴趣。因此，在您的应用程序代码中实现 TCP/IP 的精简版本（它只处理您的用例，但做得很好）可能是有意义的。

例如，如果您使用的是 Linux，您可以将几个 IP 地址路由到一个 tun 接口，并让您的应用程序处理该 tun 接口的 IP 数据包。这样，您可以完全在您的应用程序中实现 TCP/IP（针对您的用例进行了优化），并避免任何操作系统对打开连接数的限制。

当然，自己做 TCP/IP 是一项相当多的工作，但这真的取决于你有多绝望——即你能负担得起多少硬件来解决这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T23:42:15.083

500,000 个任意 yahoo messenger 连接 - 您的电信公司是否代表 Yahoo 执行此操作？似乎多年来已经存在的任何解决方案都应该在摩尔定律的帮助下具有可扩展性 - 据我所知，所有 IM 客户端在很长一段时间内都非常有效，并且没有迫切的需求增长我能想到。

为什么这不是一个用硬件加传统解决方案来解决的合理问题？

# .net - 如何使用 XML 文档文件

> ID：665626
> 
> 赞同：19
> 
> 时间：2009-03-20T10:35:50.450
> 
> 标签：.net, visual-studio-2008, xml-documentation

1.  使用带有 XML 文档文件的外部程序集时，如何让 Visual Studio 找到它？

2.  当有一个 XML 文档文件时，是否有一个程序或 xml 转换文件或我可以用来以一种很好的方式查看它的东西？不一定像 msdn 文档查看器那样复杂，但至少比纯 xml 更好...

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-20T10:41:08.533

1：您只需将其放在与 dll 相同的文件夹中

2：需要坚持吗？对于“实时”使用，VS IDE 和“反射器”都允许您查看文档（针对类型/成员/等）。有工具可以改变它，但我从来没有打扰过。[沙堡](http://www.codeplex.com/Sandcastle/)可能值得一看，但它对我来说从来都不是好事；-p

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-26T08:17:41.537

关于 2：您应该能够使用对象浏览器（视图 > 对象浏览器 (Ctrl W + J)）查看文档的“漂亮版本”，然后浏览到要查看文档的类。我使用对象浏览器来查看我自己的文档，因为它比 xml 文件或评论更易于阅读。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T10:40:17.427

回答您的第一个问题：xml 应该与程序集同名并且就在它旁边。因此，如果您有一个名为 Svish.dll 的程序集，那么您的文档文件应该是 Svish.xml 并位于同一目录中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T10:42:01.057

1) 文档文件必须与程序集名称相同，并添加扩展名“.xml”，并与相应程序集位于同一目录中。例如，您在同一目录中有一个“MyCompany.MyNamespace.dll”和一个“MyCompany.MyNamespace.dll.xml”文件。

2) [NDOC](http://ndoc.sourceforge.net/)可以生成一些直接格式的文档。

# oauth - OAuth 可以与手机应用程序一起使用吗？

> ID：665630
> 
> 赞同：5
> 
> 时间：2009-03-20T10:36:42.617
> 
> 标签：oauth, mobile-phones

我们可以在没有可用浏览器的手机上的应用程序中使用 OAuth 吗？

如果没有浏览器，用户是否仍然可以批准令牌请求（以便消费者可以继续从服务提供者那里获取受保护的资源）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-06-20T18:56:54.527

[该线程](https://stackoverflow.com/questions/1934187/oauth-secrets-in-mobile-apps)还对在移动应用程序中使用 oauth 有一些见解。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T08:32:49.907

[Chris Messina 回答了这个问题](http://getsatisfaction.com/oauth/topics/can_we_make_oauth_work_from_applications_on_mobile_phones_where_there_is_no_browser_available?utm_medium=widget&utm_source=widget_oauth)，指的是解释这些可能性的[博客文章。](http://www.hueniverse.com/hueniverse/2009/02/beyond-the-oauth-web-redirection-flow.html)

# .net - 绑定到指定的 XML 元素

> ID：665632
> 
> 赞同：0
> 
> 时间：2009-03-20T10:36:57.153
> 
> 标签：.net, wpf, data-binding, xaml, xpath

简而言之：我想定义用于 XAML 按钮的 XML ButtonSettings 元素，并在应用于该按钮的样式中使用所选 ButtonSettings 元素的子元素。

这可能吗？

XML 示例：

```
<Buttons>
  <ButtonSettings ID="Bye">
    <Text lang="NL">Doei!</Text>
    <Text lang="DE">Tsusch!</Text>
    <Text lang="FR">Bonjour</Text>
    <Text lang="EN">CU</Text>
    <Image>D:\bye.PNG</Image>
  </ButtonSettings>
</Buttons> 
```

对于每个按钮，我想选择要使用的 ButtonSettings，并指定它的 ID。然后，我想将该 ButtonSettings 元素作为绑定或数据上下文传递给样式。所选元素（例如文本和图像）的子元素将在样式中使用。

只要我直接在按钮上而不是在样式中定义它，选择和定义按钮的内容就可以完美地工作。这是我为单个按钮提供的 XAML：

```
<Button
            x:Name="ByeButton" 
            DataContext="{StaticResource dataProvider}">
            <Button.Content>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition/>
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0">
                        <TextBlock.Text>
                            <Binding XPath="//ButtonSettings[@ID='Bye']/Text[@lang='FR']" />
                        </TextBlock.Text>                        
                    </TextBlock>
                    <Image Grid.Row="1" Width="20" Height="20">
                        <Image.Source>
                            <Binding XPath="//ButtonSettings[@ID='Bye']/Image" />
                        </Image.Source>
                    </Image>
                </Grid>
            </Button.Content>
        </Button> 
```

我希望能够为每个按钮定义 //ButtonSettings[@ID='id'] 并让样式处理其余的按钮布局以及将内容和文本放入其中。可以这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T17:29:56.523

我认为您正在寻找一个 ItemsControl 并将您的按钮放在针对您的 DataType 的 DataTemplate 中。

# c# - 在 C# 运行时创建一个 Excel 工作表函数 (UDF)

> ID：665633
> 
> 赞同：1
> 
> 时间：2009-03-20T10:39:29.333
> 
> 标签：c#, excel, user-defined-functions, xll

是否可以在 C# 中动态创建工作表函数，即不使用方法属性方法？或者这是仅使用 XLL 支持的东西？

我要实现的是从源中检索函数列表（连同参数）并注册这些函数。这些函数只是作为对服务器的调用，所以这些函数的内容不是什么大问题。

感谢您的投入！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-21T09:42:43.827

ExcelDna（在[CodePlex](http://exceldna.codeplex.com)或[Google Groups](http://groups.google.com/group/exceldna)上）支持您的方案，这是一个免费库，用于使用 .Net 创建 Excel 用户定义的函数加载项。它还允许您即时创建导出的函数和宏。这些函数可以位于您使用反射定位和加载的程序集中，也可以使用 DynamicMethods 动态生成函数。

但是，ExcelDna 是作为 .xll 加载项实现的，与自动化加载项相比，它有几个优点。所以这并不能完全回答你的问题。应该可以使用反射创建和注册自动化加载项，但我不确定 ExcelDna 实现的优势是什么。

--政府--

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-02T11:17:53.097

事实证明，它不是。

只有 XLL 加载项使您能够在运行时注册函数。

# svn - 如何在 SVN 上强制您的本地版本为最新版本

> ID：665644
> 
> 赞同：5
> 
> 时间：2009-03-20T10:45:48.880
> 
> 标签：svn, merge

我做了一些更改并将它们提交（到版本 2），并在几分钟后发现它们在我的程序中引入了新的错误。所以我将一些文件切换到旧版本，以便在我的本地平台上将一些文件恢复到版本 1。从那以后，我做了很多我不想丢失的更改，并且我使用提交（版本 3）在服务器上获取我的本地更改。

我在本地拥有的版本正是我想要在存储库中作为主要修订版的版本，即使某些文件仍然正式在“版本 1”上。我认为我应该以某种方式使用 SVN 合并，但我不确定该怎么做。有什么建议吗？

编辑：当我使用 diff 时，它显示从本地版本到代表版本的更改。我可以进行更新，但随后我将再次在本地获得一个非工作版本。所以我想要的是某种强制提交，只是说“这是最新版本，期间”。

edit2：在执行“提交”时，SVN 报告没有更改。感谢 Neil Butterworth 的提问。

**编辑3：**我最后做了什么，仅供参考：我应该只是使用蒂姆的建议，但我愚蠢到可以在没有真正考虑我在做什么的情况下进行更新。当然，那时一切都变得一团糟，无法修复。所以我最后做的就是将项目导出到一个新目录。这显然不是你应该这样做的方式，但我不想再弄乱这些东西了。最后，我不得不重新开始在实际项目上取得实际进展；-) 我知道当我在一个更大的团队中工作时，我不能做那样的事情，但我不是:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-20T10:53:28.660

蛮力方式：

1.  制作本地文件的副本。
2.  删除所有目录中的所有 .svn 文件
3.  查看 HEAD 版本。
4.  将本地文件复制到签出的 HEAD 上。
5.  将本地文件检查回存储库。

如果操作正确，SVN 客户端应该将更改的文件解释为对存储库的更新。但是，这将覆盖您可能希望保留的其他人所做的任何更改。如果您想保留这些更改，请先对所有文件进行比较并合并所有最近的更改，然后再进行最终提交。

反向合并回原始版本：

*   对于每个更改的文件，
    1.  比较差异，记下您想要保留的更改，并相应地更改您的本地副本。
    2.  制作本地文件的副本。
    3.  将 HEAD 反向合并回所需的原始版本。
    4.  将本地文件的副本粘贴到合并的本地副本上。（先删除.svn）
    5.  犯罪

这可能更手动，除非您只是在不检查任何更改的情况下恢复所有内容。

Subversion，AFAIK，还没有提供删除命令，所以所有更改总是发生在 HEAD 的本地副本上。

还原只是反向合并，所有合并总是发生在您的本地副本上。在理想的系统中，merge 会被跟踪，但是 Subversion 不会跟踪 merge 信息，所以你不妨做方法 1，在提交日志中做一个注释。

一些要查找的 URL：

*   [Nabble - Subversion 用户 - Newb 帮助移动到文件的旧版本](http://www.nabble.com/Newb-help-moving-to-older-revision-of-file-td14936921.html)
*   [在分支之间复制更改](http://svnbook.red-bean.com/en/1.0/ch04s03.html)
*   [合并的常见用例](http://svnbook.red-bean.com/en/1.0/ch04s04.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-20T10:55:05.583

这里有两种可能：

*   你有效地切换到了以前版本的 repo，所以你在第 1 版上工作；
*   或者您在版本 2 上检出旧版本的文件，更改它们并作为新版本提交。

无论如何，如果您成功提交了更改，那么这就是服务器上应该有的内容。

但是，如果您不确定，我建议：

*   保留当前文件的备份；
*   查看 repo 的新副本；
*   如果您看到它与您的副本相同，则无需执行其他操作。
*   如果没有，请用您的备份覆盖新副本中的所有文件（隐藏的 .svn 文件夹除外！）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T11:13:46.347

> 所以我将一些文件切换到旧版本，以便在我的本地平台上将一些文件恢复到版本 1。

取而代之的是，您应该从特定修订中恢复更改。在那之后，您应该仍然能够更新和恢复该修订版的更改。

# mysql - 将用户 ID 列表保存到 mysql 表

> ID：665645
> 
> 赞同：2
> 
> 时间：2009-03-20T10:46:03.357
> 
> 标签：mysql, arrays

我需要保存查看页面、播放歌曲和/或下载歌曲的用户 ID 列表。我对列表所做的就是添加并显示它。我真的不需要保存更多信息，我想出了两个解决方案。哪个更好，或者我错过了更好的解决方案：

1.  KISS 解决方案 - 1 个表，主键是歌曲 ID，以及上面三个交互（查看、下载、流）中的每一个的文本字段，其中将有一个逗号分隔的用户 ID 列表。添加到它只是一个连接操作。

2.  “最佳实践”解决方案 - 有 3 个表，主键是歌曲 id 和一个进行交互的用户 id 字段。每行都有一个用户 ID，我可以添加日期和其他内容。

让我倾向于选项 2 的一件事是，检查用户是否已经对歌曲进行了投票可能更容易？

* * *

tl; dr 版本 - 使用文本字段将数组保存为逗号分隔值更好，还是将数组中的每个项目放在单独的表格行中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T10:50:00.117

绝对是第2个：

*   随着应用程序的增长，您将能够对其进行扩展
*   它将减少对编程语言的依赖
*   您将能够更快、更清晰地进行查询
*   **以后对任何其他程序员编码/调试您的应用程序将不那么痛苦**

此外，我会添加一个名为“操作”的新表及其 ID，因此您可以在以后需要时添加不同的操作，将操作 ID 而不是字符串存储在每一行（“view”、“download”、“stream ”）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T10:53:53.587

将每个项目放在单独的行中肯定会更好。操作文本字段本身就有性能劣势。但是，如果您想知道用户 1234 看过/听过/等等的歌曲，您必须执行类似的操作

```
SELECT * FROM songactions WHERE userlist LIKE '%,1234,%' OR userlist LIKE '1234,%' OR userlist LIKE '%,1234' OR userlist='1234'; 
```

这将是可怕的，可怕的痛苦。

# sql-server-2008 - 在 sys.servers 中找不到服务器“dbo”

> ID：665646
> 
> 赞同：13
> 
> 时间：2009-03-20T10:46:17.757
> 
> 标签：sql-server-2008, stored-procedures, subsonic

我有很多查询数据库的服务。它们都工作正常，但调用存储过程的一项服务给了我以下错误：

> 在 sys.servers 中找不到服务器“dbo”。验证是否指定了正确的服务器名称。如有必要，执行存储过程 sp_addlinkedserver 将服务器添加到 sys.servers。

我不知道为什么所有其他存储过程都可以正常工作而这个不是...

顺便说一句，我使用 SubSonic 作为数据访问层。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-04-26T10:19:00.683

请`select name from sys.servers`从您在配置文件中提到的作为默认服务器的服务器运行。

这里的名称列值应与您在报告查询中使用的服务器名称相匹配。

例如`serverXXX.databasename.schema.tablename`

serverXXX 应该在结果中，`select name from sys.servers`否则它会给出错误。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-20T10:52:23.187

听起来好像多了一个“。” （或两个）在映射 - 即它试图找到 server.database.schema.object。检查您的映射是否有杂散点/可疑条目。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-05-31T18:58:54.530

还要确保服务器名称与您认为的一致。如果重命名运行 SQL Server 的主机，则还需要重命名 SQL Server。

[http://www.techrepublic.com/blog/datacenter/changeing-the-name-of-your-sql-server/192](http://www.techrepublic.com/blog/datacenter/changing-the-name-of-your-sql-server/192)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-10T14:47:28.037

我遇到了同样的例外的另一个问题，所以如果有人偶然发现它，我会在这里发布：

如果您在同义词中指定服务器名称，请小心。我的登台机器和生产设备上的服务器名称不同，它导致了相同的“找不到服务器”错误。

（猜想你不应该过多使用同义词，但它在某些迁移场景中很有用）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-04T13:12:02.920

就我而言，我在关注以下问题时遇到了同样的问题，

```
 SqlCommand command = new SqlCommand("uspx_GetTemplate", connection); 
```

但是在将方括号添加到存储过程名称后，它就得到了解决。

```
SqlCommand command = new SqlCommand("[uspx_GetTemplate]", connection); 
```

# asp.net - 如何在 ASP.NET 中禁用视图状态和其他隐藏字段

> ID：665649
> 
> 赞同：1
> 
> 时间：2009-03-20T10:47:00.047
> 
> 标签：asp.net, viewstate

我想删除我的 ASP.NET 页面中的这些隐藏字段。或者更改名称或确保服务器代码忽略它们。

（我知道我会失去一些功能，但我认为处理它比删除'runat = server'更好。我唯一担心的是我真正需要的Updatepanel）

（以上是完整的，[进一步的背景在这里](https://stackoverflow.com/questions/655715/changing-name-of-viewstate/655727) ）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T14:27:22.857

据我所知，您无法完全摆脱 ViewState - 即您无法摆脱名为 __VIEWSTATE 的隐藏输入字段。

当 ViewState 被禁用时，控件仍然可以访问[ControlState 。](http://msdn.microsoft.com/en-us/library/1whwt1k7.aspx)ControlState 实际上是存储在 ViewState 中的，所以它会在 __VIEWSTATE 隐藏字段中结束。

因此，关闭整个页面的 ViewState 只会使这个隐藏字段更小 - 它不会完全摆脱它。

我相信 .NET 也将少量自己的秘密信息放在那里，所以如果你真的破解它并覆盖页面呈现方式以完全摆脱这个隐藏字段，你可能会发现你的网站停止工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-02-06T14:26:14.860

您也可以从 aspx 中删除“表单”标签，但服务器控件回发将不起作用。我在 Ajax 加载的 popup.aspx 中使用它并显示 OK。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T10:53:50.437

您还没有提到 ViewState 到底是什么让您感到困扰以及您为什么要忽略该字段，因此如果不了解问题的上下文就很难提供更好的解决方案。

`EnableViewState`您可以通过将Page 指令的属性设置为 false 在页面级别禁用 ViewState 。

```
<%@ Page enableViewState="false" %> 
```

`EnableViewState`或者，您可以通过将相应控件的属性设置为 false来关闭服务器控件的 ViewState 。

# python - 从python中的列表中提取数组

> ID：665652
> 
> 赞同：4
> 
> 时间：2009-03-20T10:48:18.110
> 
> 标签：python, arrays, list

如果我有这样的列表：

`>>> data = [(1,2),(40,2),(9,80)]`

如何提取两个列表 [1,40,9] 和 [2,2,80] ？当然我可以自己迭代和提取数字，但我想有更好的方法吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-03-20T10:58:18.537

解压操作是：

```
In [1]: data = [(1,2),(40,2),(9,80)]
In [2]: zip(*data)
Out[2]: [(1, 40, 9), (2, 2, 80)] 
```

编辑：您可以分解分配的结果列表：

```
In [3]: first_elements, second_elements = zip(*data) 
```

如果你真的需要列表作为结果：

```
In [4]: first_elements, second_elements = map(list, zip(*data)) 
```

为了更好地理解为什么会这样：

```
zip(*data) 
```

相当于

```
zip((1,2), (40,2), (9,80)) 
```

结果列表中的两个元组是根据 zip() 参数的第一个元素和 zip() 参数的第二个元素构建的。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-20T10:50:37.917

列表推导节省了一天的时间：

```
first = [x for (x,y) in data]
second = [y for (x,y) in data] 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-20T12:27:08.963

还有

```
In [1]: data = [(1,2),(40,2),(9,80)]
In [2]: x=map(None, *data)
Out[2]: [(1, 40, 9), (2, 2, 80)]
In [3]: map(None,*x)
Out[3]: [(1, 2), (40, 2), (9, 80)] 
```

# flash - flash 10 正交投影

> ID：665653
> 
> 赞同：2
> 
> 时间：2009-03-20T10:48:18.173
> 
> 标签：flash, actionscript-3, projection, orthographic

我一直在玩一些新的 flash 10 3d 可能性，发现在 3d 中旋转精灵相当容易：

```
var card:Sprite = new MyCard()
card.x = 100
card.y = 100
card.z = 200
card.rotationX = -60
addChild(card) 
```

简单而有效，这显示了卡片的透视旋转。

现在我想使用正交投影，但我不知道从哪里开始。DisplayObject 确实有一个 perspectiveProjection 成员，但它当然只能进行透视投影。也许我应该使用 transform.matrix3D？

我认为这应该不会太难，但我不知道如何解决这个问题。

更新：正如其中一条评论所暗示的：将perspectiveProjection.fieldOfView 设置为接近0（10 实际上在我的设置中产生比0.1 更好的结果）你会得到一个几乎正交的投影，这可能已经足够好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-01T14:00:42.887

我终于让它工作了。

```
 var m:Matrix3D = new Matrix3D()
        var v3:Vector.<Vector3D> = new Vector.<Vector3D>(3);
        v3 = m.decompose();
        v3[2] = new Vector3D(1,1,0);
        m.recompose(v3)
        transform.matrix3D.appendRotation( -90, Vector3D.X_AXIS );
        transform.matrix3D.appendRotation( -45, Vector3D.Y_AXIS );
        transform.matrix3D.appendRotation( 35.264, Vector3D.X_AXIS );
        transform.matrix3D.append(m) 
```

现在，任何添加到应用了此变换的精灵的元素都将显示在等距投影中。（那个 35.264 是一个近似值，请参见[http://en.wikipedia.org/wiki/Isometric_projection](http://en.wikipedia.org/wiki/Isometric_projection)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T11:03:32.240

您可以将 PerspectiveProjection 的 fieldOfView 属性设置为 NEAR 0。我不确定这是否是最好的方法。

参考：[http ://thebackbutton.com/misc/f10api/flash/geom/PerspectiveProjection.html](http://thebackbutton.com/misc/f10api/flash/geom/PerspectiveProjection.html)

# c# - C#中AppDomain的使用

> ID：665668
> 
> 赞同：76
> 
> 时间：2009-03-20T10:52:40.813
> 
> 标签：c#, remoting, appdomain

C# 中 AppDomain 最重要的用途是什么？

* * *

## 回答 #1

> 赞同：80
> 
> 时间：2009-03-20T11:02:05.080

**最重要**的一个用途是您的代码*必须有一个*- 即您用 C# 编写的所有内容都在`AppDomain`. 这很重要;-p

如果您指的是*其他*应用程序域：

使用插件和其他不受信任的代码时，它允许您进行隔离和卸载它们的能力（您不能卸载程序集 - 只能卸载整个应用程序域）。

我目前正在使用它来加载动态生成的 dll，以便我可以卸载它们。

它们还允许您设置不同的配置文件、信任级别等 - 但具有相关的复杂性和远程处理成本。

[MSDN 在此处](http://msdn.microsoft.com/en-us/library/yb506139.aspx)有一个关于应用程序域的部分。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-03-20T11:03:58.027

我不能告诉你最重要的用途是什么，因为这取决于具体情况。

AppDomains 对于应用程序的沙箱部分很有用。您可以在 AppDomain 中加载扩展并再次卸载它们 - 这是您无法做到的。您可以将特定权限分配给 AppDomain。默认情况下，不同 AppDomain 中的对象不能相互访问。

AppDomain 可以被视为轻量级进程，因为它们为您提供了许多相同的功能。但是，与 Process 不同，新 AppDomain 默认没有自己的线程。您必须自己管理 AppDomain 和线程。

此外，AppDomain 都共享相同的托管堆。这通常不是问题，但它可能会产生令人惊讶的效果，因为某些实例（如字符串）在 AppDomain 之间共享。对于常规使用，这不是问题，但如果您使用字符串进行锁定，不同 AppDomain 中的线程可能会相互影响。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-03-20T13:25:21.057

一般来说，使用 AppDomain 并不是日常的编码实践，这可以被认为是一个高级概念。但是，从这个简单的事情开始，更好地理解“AppDomain”这个词背后的概念是很重要的。

在架构方面，尽可能简单，AppDomain 是一个隔离容器，即使在内存寻址方面也是如此，在其中加载和执行应用程序所需的所有程序集，即使这个概念更复杂地解释细节（我希望这不是关于你的问题要深入）。

从那里开始，AppDomain 类首先用于获取对应用程序相关执行应用程序域的访问，这可以通过 Singleton 属性实现来完成`AppDomain.CurrentDomain`。通过这种方式，可以：

1.  获取已加载程序集的访问权限；
2.  获得对 appdomain 共享数据槽的访问权限；
3.  intems marshalling，在从创建域中加载的程序集中解包创建的实例方面。

然后，AppDomain 类用于：

1.  在同一过程中创建更多“域”；
2.  在进程中执行程序集；
3.  管理 appdomain 的加载/卸载过程。

查看新的 Microsoft 框架（尚未发布）[MEF（托管可扩展性框架）](http://mef.codeplex.com/)的代码可能很有用，它真正基于 AppDomains 创建和卸载、动态加载的程序集等概念。

作为一个简单的例子和​​你可以用 AppDomains 做什么的例子，我可以分享这个[链接](http://www.java2s.com/Tutorial/CSharp/0240__Assembly/0020__AppDomain.htm)。

我希望我回答了你的问题。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2016-12-31T16:46:27.650

*AC# AppDomain 是一个逻辑隔离的容器，在其中运行 .NET 代码。当您运行任何 .NET 代码时，它始终在默认应用程序域中运行。*

请观看这个 30 分钟的 youtube 视频[什么是 C# AppDomain ？](https://www.youtube.com/watch?v=DUq84e3cZyo)其中更详细地解释了 AppDomain。

[![C# 应用程序域](https://i.stack.imgur.com/jnYRF.png)](https://i.stack.imgur.com/jnYRF.png)

但是，让我仍然尝试更详细地解释。假设您获得了第三方 DLL，并且您想在您的应用程序中使用它。但是您也怀疑第三方可能有一些恶意代码，因此您希望在受限环境中运行第三方 DLL。比如你不想让第三方访问你的c:盘或者删除文件等等。

因此，您可以创建两个 AppDomain，一个用于第三方，一个用于您自己的 C# 类。对于第三方应用程序域，您将应用它无法访问 c: 驱动器的安全约束，而对于您的 C# DLL，您将拥有一个不受限制的应用程序域。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-06-02T22:42:48.820

请阅读我的博客，了解运行时加载 DLL 和使用 AppDomain 进行交叉通信的标准应用程序。[https://blog.vcillusion.co.in/sending-events-through-application-domain-boundary/](https://blog.vcillusion.co.in/sending-events-through-application-domain-boundary/)

1.  **DLL 的运行时加载和卸载**：我从事过一个项目，其中 DLL 由用户在运行时加载，在程序执行期间，方法使用反射执行并在程序运行期间卸载。
2.  **保护我的主执行程序**：我们正在动态加载 DLL，因此动态加载的 DLL 中发生的任何异常都不会影响我的主 AppDomain。如果出现损坏情况，我们可以选择再次有效地卸载和加载 DLL。
3.  **跨 AppDomain 通信**：我们可以在运行时动态加载任意两个 DLL 在不同的 AppDomain 中，并使它们相互通信。

# javascript - 在 Firefox 中，修改从选择中克隆的范围会在第一次清除选择

> ID：665676
> 
> 赞同：2
> 
> 时间：2009-03-20T10:55:15.877
> 
> 标签：javascript, firefox

```
<script>
    var is_gecko = /gecko/i.test(navigator.userAgent);
    var is_ie    = /MSIE/.test(navigator.userAgent);

    function insertNodeAtSelStart()
    {
        if(is_gecko)
        {
            var S = window.getSelection();
            if(!S.isCollapsed)
            {
                var R = S.getRangeAt(0);
                var R1 = R.cloneRange();
                var NN = document.createElement("startMarker");
                R1.insertNode(NN);
                NN.parentNode.removeChild(NN);
            }
        }

        if(is_ie)
        {
            // IE-specific code
        }
    }
</script>

<div>
    <span>one two three</span>
</div>

<input type="button" value="Insert node at selection start" onclick="insertNodeAtSelStart();" /> 
```

在加载页面并选择一些文本后第一次单击按钮时，Firefox 会清除选择。随后，它没有。这是我的代码或 Firefox 中的错误吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T14:17:04.253

当您成功将节点插入其起点内时，Firefox 会清除选择。

*对我来说，有时*第二次单击（取决于选择的文本范围）会失败，并显示：

```
Error: uncaught exception: [Exception... "Index or size is negative or greater than the allowed amount"  code: "1" nsresult: "0x80530001 (NS_ERROR_DOM_INDEX_SIZE_ERR)"  location: "..."] 
```

在 insertNode 调用上。由于插入不成功，因此不会清除选择。大概这就是你正在发生的事情——检查你的错误控制台。

此故障似乎是 Firefox 错误。我无法完全追踪触发它的确切条件，但这与选择中的节点边界有关。

我可以通过调用 document.body.normalize() 使您的示例始终有效（并清除选择），以便在插入/删除循环拆分后将整个跨度内容返回到单个 Text 节点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T16:49:47.820

确实，您偶然发现了一个丑陋的 Gecko 错误，该错误多年来一直在爬行：（是的，最新的开发版本仍然存在此错误。

无论如何，如果您不想等待 Mozilla 的修复，更简单/更快的解决方法是在插入新节点之前折叠范围。

为了符合要求，这是用于测试代码的（以某种方式简化的）示例：

```
<p id="para">select two or more letters, then </p>
<input id="butt" type="button" value="click me">
<script type="text/javascript">
  if (!window.getSelection)
    throw new Error("MSIE, you're not welcome!");

  var marker = document.createElement('span');
  marker.style.color = '#6C6';
  marker.appendChild(document.createTextNode('|'));

  function insertNodeAtSelStart() {
    // window.getSelection().getRangeAt(0).insertNode(marker.cloneNode(true));
    var r = window.getSelection().getRangeAt(0);
    var n = marker.cloneNode(true);
    r.collapse(true); // workaround for Gecko :(
    r.insertNode(n);  // Gecko sometimes(?!) fails with NS_ERROR_DOM_INDEX_SIZE_ERR
  }
  document.getElementById('butt').onclick = insertNodeAtSelStart;
</script> 
```

OT，这不是“is _ gecko”，“is _ not _ ie”会更合适，因为此代码应在除 MSIE 之外的所有浏览器上按预期运行；-)

# jquery - jquery验证插件在modalbox中不起作用

> ID：665680
> 
> 赞同：2
> 
> 时间：2009-03-20T10:57:10.337
> 
> 标签：jquery

我正在尝试验证 modalbox 中的字段，但它在下面不起作用是我的验证代码

```
$("#formapplication").validate({
rules: {
        tb_name:{ required: true },
        tb_url: {required: true},
        tb_tag: {required: true},
        tb_desc: {required: true},
        tb_catg: {required: true}
        },
messages:{
        tb_name:{ required: "Please Enter Full name" },
        tb_url: {required: "Please Enter URL"},
        tb_tag: {required: "Please Enter Tag."},
        tb_desc: {required: "Please Enter Description."},
        tb_catg: {required: "Please Select Category."}
        }
    }); 
```

jquery 验证插件支持 modalbox，但它的简单 html 我写在同一页面上，而不是使用 ajax 调用任何想法 pelase 帮助。

下面是xhtml

```
<div id="submitapplication" style="display:none">
<form action="" id="formapplication" name="formapplication" method="post">
<div class="submitapplicationbox">
<label>Name<input type="text" name="tb_name" id="tb_name" /></label>
<label>Url<input type="text" name="tb_url" id="tb_url" /></label>
<label>Tags<input type="text" name="tb_tag" id="tb_tag" /></label>
<label>Category<select name="select" id="tb_catg">
  <option value=""></option>
  </select></label>
<label>Description
<textarea cols="" rows="" name="tb_desc" id="tb_desc" ></textarea></label>
</div>
<div class="twiteraccountinfobox">
<label>Name<input type="text" name="tb_twaccount" id="tb_twaccount" /></label>
<div style="margin-top:20px;"><input type="button" id="submitapp" value="Submit Application" /></div>
<div id="response" style="display:none;"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T13:14:50.927

我缺少用于验证的所有输入所需的类

```
<input type="text" id="tb_name" class="required" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T11:53:25.847

啊，首先，在您的表单操作中添加一个 #，这样它就是`form action="#"`. # 不能解决它，但我之前遇到过 IE 问题，而表单中没有散列。

另外，尝试在验证下方添加一行：

```
$("#formapplication").valid(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-12-09T02:57:57.970

1.  首先，正如 Seb 所说，您需要在字段名称周围加上引号。
2.  **其次，据我了解文档中的规则和消息散列，您需要通过name**属性而不是**id**属性来引用元素。所以不是 `"tb_catg": {required: true}`我认为你想要`"select": {required: true}`的，因为你的 HTML 说`<select name="select" id="tb_catg">`

# quickfix - 奇怪的 QuickFix 引擎对执行报告消息的响应

> ID：665681
> 
> 赞同：3
> 
> 时间：2009-03-20T10:57:16.717
> 
> 标签：quickfix

我目前在使用开源 QuickFix 引擎时遇到了一个奇怪的问题。我们的经纪人正在发送一些 MsgType = 8（执行报告）的测试交易，我们的 QuickFix 引擎立即回复一个异常，说“不支持的消息类型”。经纪人消息中的所有标签似乎都是合法的。

为什么会发生这种情况，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-14T18:19:45.997

我无法读心，但听起来您可能已经将您的应用程序实现为[MessageCracker](http://quickfixengine.org/quickfix/doc/html/class_f_i_x_1_1_message_cracker.html)但忘记覆盖适当的`onMessage`功能。请注意，消息类型的每个 FIX 版本都有一个单独的`onMessage`重载，例如：

```
onMessage (const FIX40::ExecutionReport&, const FIX::SessionID&) 
onMessage (const FIX41::ExecutionReport&, const FIX::SessionID&) 
onMessage (const FIX42::ExecutionReport&, const FIX::SessionID&) 
onMessage (const FIX43::ExecutionReport&, const FIX::SessionID&) 
onMessage (const FIX44::ExecutionReport&, const FIX::SessionID&) 
```

所有这些方法的默认实现都会引发`UnsupportedMessageType`异常，这听起来就像您所看到的那样。

# file - iexpress 提取文件然后运行引用提取文件的脚本

> ID：665683
> 
> 赞同：6
> 
> 时间：2009-03-20T10:57:41.957
> 
> 标签：file, scripting, path, iexpress

我试图用 IExpress 部署我的项目。我有以下情况。我想将一些文件提取到一个位置，最好是 c:\program files\。然后在它复制所有文件之后，我希望它运行一个 .cmd 文件（这是一个脚本）。该脚本也被添加到项目本身中，它将引用由 IExpress 复制的文件。现在如何访问提取文件的路径。这样我就可以在我的脚本中访问它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-01T18:01:05.600

如果脚本在项目本身中，因此在您将文件发送到时被提取到同一目录中，那么它应该在同一目录中启动。

简单测试一下，做一个这样的cmd：

**cmdsetup.cmd：**

@echo 源路径：%~dp0 >> %temp%\%~n0.log

把它放在你的包中，完成后，去检查 %temp% 目录，找到 cmdsetup.log 文件并查看它。这应该是您的文件所在的路径。
如果是这样，请从那里开始。如果我弄错了，请回来发表评论，并修改您的问题以使其更清楚。

我希望这有帮助。

Ps：投了这个问题，因为我不明白为什么会投反对票。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-12-28T22:29:45.160

答案是使用这种格式：

```
start /wait .\hello.cmd 
```

我用以下两个文件做到了这一点。一件关键的事情是我调用的文件必须是 8.3 格式。换句话说，它第一次找不到 hello.cmd，因为我将其命名为 hello.world.cmd。

### 第一个文件（start.cmd）

```
@echo off
cls
echo this is start.cmd
pause
dir
pause
echo going to hello world
start /wait .\hello.cmd
echo back in start.cmd
pause 
```

### 第二个文件（hello.cmd）

```
@echo off
echo HELLO WORLD!
pause
exit 
```

### 方向

使用 IEXPRESS 创建一个包含上述两个文件的包。让它启动 START.CMD。

# jsf - JSF MethodExpression 没有触发我的支持 bean 操作

> ID：665685
> 
> 赞同：2
> 
> 时间：2009-03-20T10:58:53.687
> 
> 标签：jsf, methods, uicomponents

我的问题是我的代码没有触发支持 bean 中的操作。代码如下：

```
HtmlCommandButton replyCommentButton = new HtmlCommandButton();
replyCommentButton.setId("replyCommentButton" + commentCounter);
replyCommentButton.setValue("Create reply");
String action = "#{Handler.action_replyToComment}";
MethodExpression methodExpression =  
FacesContext.getCurrentInstance().getApplication().getExpressionFactory().
createMethodExpression(FacesContext.getCurrentInstance().getELContext(), action, null,
new Class<?>[0]);
replyCommentButton.setActionExpression(methodExpression); 
```

在我的名为 RequestHandlerBean 的支持 bean 中，在 FacesConfig 中定义为 Handler，我有以下代码：

```
public void action_replyToComment() {
logger.info("Homemade action called!!!");
System.out.println("Homemade action called!!!");
} 
```

有没有人发现为什么当我单击按钮时什么都没有发生？它没有正确触发事件。html代码的来源如下：

```
<input id="replyCommentButton1" type="submit" value="Create reply"   
name="replyCommentButton1"/> 
```

正如我们所见，HTML 中没有定义任何动作。

**编辑 2：**我刚刚在 Javadoc 中发现我的操作方法必须是公共字符串。我现在在我的支持 bean 中改变了这个，所以我的支持 bean 中的代码是：

```
public String action_replyToComment() {
logger.info("Homemade action called!!!");
System.out.println("Homemade action called!!!");
return null;
} 
```

* * *

Edit2：我还确保将它封装在标签中，但仍然没有运气。元素上不应该有一个动作属性吗？

* * *

**Edit3：我的 bean 在我的 faces-config 中定义，如下所示：**

```
<managed-bean>
<description>
Handles the specific request.
</description>
<managed-bean-name>Handler</managed-bean-name>
<managed-bean-class>no.ngt.tech.rt2.beans.RequestHandlerBean</managed-bean-class>
<managed-bean-scope>request</managed-bean-scope>
</managed-bean> 
```

此外，如果我选择像这样在我的 JSF 页面中输出：

```
<a4j:commandButton action="#{Handler.action_replyToComment}" value="Reply" /> 
```

这完美地工作

**编辑 4 - 我的 JSP 页面** 注意我现在也尝试使用折旧的 setAction(methodBinding)，但遗憾的是它也没有工作。

```
<%@ include file="_includes.jsp" %>
<f:view>
<html>
<head>
<title><h:outputText value="#{msgs.title}" /></title>
</head>
<body>
<br /><br /><br />

<%@ include file="_menu.jsp" %>

<rich:tabPanel switchType="client">

<rich:tab id="commentsTab" label="Comments" rendered="#{Handler.editRequest}">
<h:form>
         <ngt:commentTree binding="#{Handler.commentTree}" value="#{Handler.comments}"  />

         <br />

         <a4j:commandButton action="#{Handler.action_replyToComment}" value="testbutton" />
</h:form>    
</rich:tab>

</rich:tabPanel>

</body>
</html>
</f:view> 
```

**菜单.jsp：**

```
<h:form>
    <rich:toolBar itemSeparator="line" styleClass="toolbar" contentClass="toolbar" height="22">
        <rich:toolBarGroup>
            <rich:menuItem submitMode="server" value="Front" action="#{newRT.action_showFront}" />
        </rich:toolBarGroup>
        <rich:toolBarGroup>
            <rich:menuItem submitMode="server" value="New request" action="#{Step.action_showSteps}" />
        </rich:toolBarGroup>
        <rich:toolBarGroup>
            <rich:menuItem submitMode="server" value="Requests" action="#{Handler.action_showRequestsView}" />
        </rich:toolBarGroup>
        <rich:toolBarGroup>
            <rich:menuItem submitMode="server" value="Control-panel" action="#" />
        </rich:toolBarGroup>
        <rich:toolBarGroup location="right">
            <h:inputText styleClass="barsearch" value="#{Handler.search}" />
            <a4j:commandButton styleClass="barsearchbutton" action="#{Handler.action_GetRequestFromID}"  value="Search" />
        </rich:toolBarGroup>
    </rich:toolBar>
</h:form>

<br/><br/> 
```

**包括.jsp**

```
<%@ taglib prefix="h" uri="http://java.sun.com/jsf/html" %>
<%@ taglib prefix="f" uri="http://java.sun.com/jsf/core" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="a4j" uri="http://richfaces.org/a4j" %>
<%@ taglib prefix="rich" uri="http://richfaces.org/rich"%>
<%@ taglib prefix="ngt" uri="http://MySpecialTagLib.no/"%> 
```

**编辑 7 - UIComponent 的 Java 代码：**

这是 CommentsTreeUI.java：

```
public class CommentsTreeUI extends UIOutput {

    private static Logger logger = Logger.getLogger(CommentsTreeUI.class.getName());

    @Override
    public void encodeBegin(FacesContext context) throws IOException {

        List<CommentTag> value = (List<CommentTag>) getAttributes().get("value");
        int commentCounter = 0;

        if (value != null) {
            for (CommentTag comment : value) {
                commentCounter++;
                ResponseWriter commentContainerWriter = context.getResponseWriter();
                commentContainerWriter.startElement("div", this);
                commentContainerWriter.writeAttribute("id", "Comment" + commentCounter, null);

                String width = comment.getWidth();
                String height = comment.getHeight();

                String style = comment.getStyle();

                style = (style != null) ? style + ";" : "";

                if (width != null) {
                    style += "width:" + width + ";";
                }
                if (height != null) {
                    style += "height:" + height + ";";
                }

                commentContainerWriter.writeAttribute("style", style, null);

                String newComment = comment.getNewComment();
                if (newComment == null) {
                    newComment = "false";
                }

                String level = comment.getLevel();

                if (level != null) {
                    level = "commentContainerLevel" + level + newComment;
                }
                commentContainerWriter.writeAttribute("class", level, null);

                String title = comment.getTitle();
                if (title != null) {
                    commentContainerWriter.writeAttribute("title", title, null);
                }

                String titleText = comment.getTitleText();
                if (titleText != null) {
                    ResponseWriter titleTextWriter = context.getResponseWriter();
                    UIOutput titleTextComponent = new UIOutput();
                    titleTextWriter.startElement("div", titleTextComponent);
                    titleTextWriter.writeAttribute("class", "commentHeaderText" + newComment, null);
                    titleTextWriter.writeText(titleText + " | ", null);
                    titleTextWriter.startElement("a", titleTextComponent);
                    titleTextWriter.writeAttribute("onclick", "showCommentReply('CommentReply" + commentCounter + "')", null);
                    titleTextWriter.writeAttribute("class", "reply", null);
                    titleTextWriter.writeText("Reply", null);
                    titleTextWriter.endElement("a"); 
                    titleTextWriter.endElement("div");
                }

                String commentBody = comment.getCommentBody();
                if (commentBody != null) {
                    ResponseWriter commentBodyWriter = context.getResponseWriter();
                    UIOutput commentBodyComponent = new UIOutput();
                    commentBodyWriter.startElement("div", commentBodyComponent);
                    commentBodyWriter.writeText(commentBody, null);
                    commentBodyWriter.endElement("div");
                }

                ResponseWriter replyContainerWriter = context.getResponseWriter();
                UIOutput replyContainerComponent = new UIOutput();
                replyContainerWriter.startElement("div", replyContainerComponent);
                commentContainerWriter.writeAttribute("id", "CommentReply" + commentCounter, null);
                replyContainerWriter.writeAttribute("class", "replyContainer", null);

                ResponseWriter replyHeaderWriter = context.getResponseWriter();
                UIOutput replyHeaderComponent = new UIOutput();
                replyHeaderWriter.startElement("div", replyHeaderComponent);
                replyHeaderWriter.writeAttribute("class", "replyHeaderContainer", null);
                replyHeaderWriter.endElement("div");

                ResponseWriter replyFormWriter = context.getResponseWriter();
                UIInput replyFormComponent = new UIInput();
                replyFormWriter.startElement("fieldset", replyFormComponent);
                replyFormWriter.startElement("textarea", replyFormComponent);
                replyFormWriter.writeAttribute("type", "textarea", null);
                replyFormWriter.writeAttribute("rows", "5", null);
                replyFormWriter.writeAttribute("cols", "76", null);
                replyFormWriter.writeText("Write your answer here", null);
                replyFormWriter.endElement("textarea");

                //TODO: Fix so button has action to backing bean
                HtmlAjaxCommandButton replyCommentButton = new HtmlAjaxCommandButton();
                replyCommentButton.setId("replyCommentButton" + commentCounter);
                replyCommentButton.setValue("Create reply");
                String action = "#{RequestHandlerBean.action_replyToComment}";
                //replyCommentButton.setReRender("commentsTree");
                ExpressionFactory factory = context.getApplication().getExpressionFactory();
                Class [] argtypes=new Class[1];
                argtypes[0]=ActionEvent.class;

                MethodExpression replyActionExpression = factory.createMethodExpression(context.getELContext(), action, null, argtypes);
                replyCommentButton.setActionExpression(replyActionExpression);

                MethodExpression methodExpression = context.getCurrentInstance().getApplication().getExpressionFactory().
                        createMethodExpression(context.getCurrentInstance().getELContext(), action, null, new Class<?>[0]);
                replyCommentButton.setActionExpression(methodExpression);
                /*
                replyCommentButton.setAction(context.getApplication().createMethodBinding(action, argtypes));
                */

                replyCommentButton.encodeAll(context);
                //Todo above

                replyFormWriter.writeText(" ", null);
                replyFormWriter.startElement("input", replyFormComponent);
                replyFormWriter.writeAttribute("type", "button", null);
                replyFormWriter.writeAttribute("value", "Cancel ", null);
                replyFormWriter.writeAttribute("onclick", "hideCommentReply('CommentReply" + commentCounter + "')", title);
                replyFormWriter.endElement("input");
                replyFormWriter.endElement("fieldset");
                replyContainerWriter.endElement("div");
                commentContainerWriter.endElement("div");
            }
        } else { //value==null
            ResponseWriter writer = context.getResponseWriter();
            writer.startElement("div", this);

            writer.writeAttribute("id", getClientId(context), null);

            String width = (String) getAttributes().get("width");
            String height = (String) getAttributes().get("height");

            String style = (String) getAttributes().get("style");

            style = (style != null) ? style + ";" : "";

            if (width != null) {
                style += "width:" + width + ";";
            }
            if (height != null) {
                style += "height:" + height + ";";
            }

            writer.writeAttribute("style", style, null);

            String styleClass = (String) getAttributes().get("styleClass");
            if (styleClass != null) {
                writer.writeAttribute("class", styleClass, null);
            }

            String title = (String) getAttributes().get("title");
            if (title != null) {
                writer.writeAttribute("title", title, null);
            }

        }
    }

    @Override
    public void encodeEnd(FacesContext context) throws IOException {
        ResponseWriter writer = context.getResponseWriter();
        writer.endElement("div");
    } 
```

这是 CommenstTreeTag：

```
public class CommentsTreeTag extends UIComponentTag {

    String style;
    String styleClass;
    String title;
    String width;
    String height;
    String value;
    Long parentId;

    public void release() {
        // the super class method should be called
        super.release();
        style = null;
        styleClass = null;
        title = null;
        height = null;
        width = null;
        parentId = null;
        value = null;
    }

    @Override
    protected void setProperties(UIComponent component) {
        // the super class method should be called
        super.setProperties(component);

        if (style != null) {
            component.getAttributes().put("style", style);
        }

        if (styleClass != null) {
            component.getAttributes().put("styleClass", styleClass);
        }

        if (width != null) {
            component.getAttributes().put("width", width);
        }

        if (height != null) {
            component.getAttributes().put("height", height);
        }

        if (title != null) {
            if (isValueReference(title)) {
                ValueBinding vb =
                        getFacesContext().getApplication().createValueBinding(title);
                component.setValueBinding("title", vb);
            } else {
                component.getAttributes().put("title", title);
            }
        }
        if (value != null) {
            if (isValueReference(value)) {
                ValueBinding vb =
                        getFacesContext().getApplication().createValueBinding(value);
                component.setValueBinding("value", vb);
                getFacesContext().getApplication().createValueBinding(value);

            } else {
                component.getAttributes().put("value", value);
            }
        }
        if (parentId != null) {
            component.getAttributes().put("parentId", parentId);
        }
    }

    public String getComponentType() {
        return "commentTree";
    }

    public String getRendererType() {
        // null means the component renders itself
        return null;
    }

    public String getHeight() {
        return height;
    }

    public void setHeight(String height) {
        this.height = height;
    }

    public String getWidth() {
        return width;
    }

    public void setWidth(String width) {
        this.width = width;
    }

    public String getStyle() {
        return style;
    }

    public void setStyle(String style) {
        this.style = style;
    }

    public String getStyleClass() {
        return styleClass;
    }

    public void setStyleClass(String styleClass) {
        this.styleClass = styleClass;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getValue() {
        return value;
    }

    public void setValue(String value) {
        this.value = value;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-24T10:16:04.923

我认为您遇到的问题是由于您在 JSF 组件树中添加 commandButton 的方式，或者更准确地说，您不将它添加到组件树中的方式。

由于您没有将 commandButton 附加到 JSF 组件树，因此在呈现此组件时（通过调用 .encodeAll() 方法），它不会找到该组件嵌套的表单。因此，没有正确创建 HTML 输入。

也许您可以尝试在要求渲染之前将创建的 commandButton 直接添加到表单中。您可以使用以下代码执行此操作：

```
// Search for the component HtmlForm that is a (in)direct parent of the current component
private UIComponent getCurrentForm(UIComponent currentComponent) {
    UIComponent parent = currentComponent.getParent();
    while ((parent != null) && !(parent instanceof HtmlForm)) {
        parent = parent.getParent();
    }
    return parent;
}

public void encodeBegin(FacesContext context) throws IOException {
    ...
    HtmlAjaxCommandButton replyCommentButton = new HtmlAjaxCommandButton();
    ...

    // Add the command button in the form that contains your custom component...
    UIComponent form = getCurrentForm(this);
    if (form != null) {
        form.getChildren().add(replyCommentButton);
    }
    replyCommentButton.encodeAll(context);
    ...
} 
```

*请注意，我已经测试过这段代码，所以也许你需要稍微修改一下......*

如果它仍然不起作用，也许您需要检查您的代码以便在渲染类之外或 encodeBegin 之外创建命令按钮...我认为在此期间修改 JSF 组件树不是一个好主意渲染阶段...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T11:13:45.537

您的代码似乎是正确的（确实，该方法必须返回一个字符串，但它也可以返回 void，即使不建议编写这样的操作方法）。

您确定创建的 commandButton 嵌套在组件中吗？否则，它将无法正常工作。这么说，我的意思是（在 Java 或 JSF 中创建的页面，不管），必须有一个直接或间接的父级（在 JSF 组件树中）一个组件。例如：

```
<h:form>
  ...
  <h:commandButton .../>
  ...
</h:form> 
```

单击问题时是否有任何 Javascript 错误？

编辑有关评论。

编辑 2，关于我对主帖的评论：

也许您可以尝试使用旧方式在按钮上附加操作（好吧，它已被弃用，但试一试）：

```
replyCommandButton.setAction(context.getApplication().createMethodBinding("#{Handler.action_replyToComment}", null)); 
```

# .net - 面板访问

> ID：665687
> 
> 赞同：0
> 
> 时间：2009-03-20T11:00:17.863
> 
> 标签：.net

我有多层面板。我需要将外面板设置为启用假，将内面板设置为启用真。我能怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T11:13:06.367

据我所知，你不能。

我能提供的最佳解决方案是禁用外部面板上除内部面板之外的所有其他控件。这将给出与禁用外部面板相同的印象。

# c++ - 立体视觉（3D 立体）正在卷土重来吗？

> ID：665688
> 
> 赞同：2
> 
> 时间：2009-03-20T11:00:21.450
> 
> 标签：c++, opengl, nvidia, stereo-3d, stereoscopy

我正在使用 C++ 和 OpenGL 开发立体镜应用程序（用于医学图像可视化）。据我了解，这项技术大约在 10 年前是相当大的新闻，但从那以后它似乎已经不复存在了。现在，许多公司似乎都在投资这项技术……[包括 nVidia 似乎](http://www.nvidia.co.uk/object/force_within_uk.html)。

立体镜也被称为“3D立体”，主要由nVidia（我认为）。

就我们如何可视化事物而言，有人将立体视觉视为一项主要技术吗？我说的是娱乐和专业的身份。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T11:09:21.897

使用[nVidia 的 3D 套件](http://www.nvidia.com/object/GeForce_3D_Vision_Main.html)，您无需“制作立体应用程序”，驱动程序和视频卡即可完成。10 年前，有使用偏光眼镜和极其昂贵的显示器的高质量立体检查和使用[红/青色眼镜](http://en.wikipedia.org/wiki/Anaglyph_image)的低质量立体检查。你现在拥有的东西既便宜又好。现在你只需要 120Hz LCD、入门级显卡和 100 美元的[快门眼镜](http://en.wikipedia.org/wiki/LCD_shutter_glasses)。

所以毫无疑问，这将是下一件大事。至少在娱乐方面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T11:08:53.020

它可能会卷土重来的一个原因是我们知道屏幕具有足够高的刷新率，因此可以实现 3D。我想我读到 3D 电视需要大约 100Hz 的频率。因此，不再需要笨重的眼镜。

**编辑**：重申：您不再需要眼镜才能拥有 3D 电视。这篇文章几周前发表在瑞典杂志上：[http://www.nyteknik.se/nyheter/it_telekom/tv/article510136.ece](http://www.nyteknik.se/nyheter/it_telekom/tv/article510136.ece)。

它所说的基本上是在屏幕上使用带有垂直镜片的技术来代替眼镜。CRT 的问题是它们不平坦。我们更现代的平面屏幕显然没有这个问题。第二个问题是您需要高频率（至少 100 Hz，因为这会使眼睛每秒获得 50 帧）和大量像素，因为每只眼睛只能获得一半像素。

自 2005 年以来，各种公司都在销售支持 3D**不戴眼镜**的电视机。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T12:36:29.910

对立体显示的热情似乎在炒作和失望的循环中来来去去（例如[电影院](http://www.sensio.tv/en/3d/3d_history/default.3d)）。我不认为电视和个人电脑会有任何不同。

对于医学可视化来说，如果它有用的话，就会有大批临床医生坐在昂贵的显示器前，戴着快门眼镜。大提示：没有。而且该市场不需要 3D 显示技术作为推动因素来达到“冲动购买”定价水平。

# php - Zend 框架表单与 jquery

> ID：665690
> 
> 赞同：12
> 
> 时间：2009-03-20T11:01:29.297
> 
> 标签：php, jquery, validation, zend-framework, zend-form

有人知道如何使用 Zend_Form 和 jquery 简单地创建一个表单吗？我想使用 Zend_Form 来验证表单，因此我不必在 JavaScript 和 PHP 中编写表单的双重脚本。

谢谢，

伊沃·特罗珀特

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-24T15:19:35.943

那里没问题。

如果您使用自动加载，请将 ZendX_JQuery 添加到您的库中。

然后根据您的需要扩展 ZendX_JQuery_Form。在你的类的 init() 方法中做你的事情。

例如，我能够创建一个具有常规 Zend_Form 验证和 JQuery 行为的 AutoComplete 字段，如下所示：

```
$elem = new ZendX_JQuery_Form_Element_AutoComplete(
    'query',
     array('Label' => 'Search',
           'required'=>true,
           'filters'=>array('StripTags'),
           'validators'=>array(
                            array('validator'=>'StringLength',
                                'options'=>array('min'=>'3'),
                                'breakChainOnFailure'=>true
                                ),
                            array('Alnum')
                )
        )
    );

$elem->setJQueryParams(array('data' => array(),
    'url' => 'my_autocomplete_callback.php',
    'minChars' => 1,
    'onChangeInterval' => 500,
    )
); 
```

然后我什至像这样更改了默认装饰器：

```
$elementDecorators = array(
    array('UiWidgetElement', array('tag' => '')),
    array('Errors', array('tag' => 'div', 'class'=>'error')),
    array('Label'),
    array('HtmlTag', array('tag' => 'div')),
);
$elem->setDecorators($elementDecorators); 
```

最后添加到我的表单中（记住我在 init() 中，所以我将通过 $this 解决它）：

```
$this->addElement($elem); 
```

你来了，魔法完成了。

PS：不要忘记在引导程序中添加以下内容：

```
$view->addHelperPath('ZendX/JQuery/View/Helper/', 'ZendX_JQuery_View_Helper'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T11:07:26.253

好吧，Zend_Form 不会为您生成任何客户端 JavaScript 验证器，如果这就是您的意思的话。

但是：您可以只在服务器上进行所有验证，并使用 jQuery 挂钩字段的更改事件，并对表单验证进行 AJAX 化。

检查[那个](http://www.whitewashing.de/blog/articles/92)样本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-03T19:53:11.793

[http://web.archive.org/web/20100814175334/http://steven.macintyre.name/zend-framework-jquery-form-validation-plugins/](http://web.archive.org/web/20100814175334/http://steven.macintyre.name/zend-framework-jquery-form-validation-plugins/) 这里我们展示了如何在 Zend 框架中添加一个插件来处理客户端验证

# c# - 如何在我的 C# Visual Studio 项目中添加 VC++ DLL 作为引用？

> ID：665698
> 
> 赞同：4
> 
> 时间：2009-03-20T11:07:12.933
> 
> 标签：c#, .net, visual-studio, interop

我想在我的 C# Visual Studio 项目中添加一个 VC++ DLL 引用。但是当我尝试添加它时，我看到“它不是有效的程序集或 COM 组件”。

请建议我如何在 C# 项目中使用 VC++ DLL 作为参考。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T11:14:12.353

您只能在 C# 中使用准备好使用的 C++ 组件，例如使用 C++/CLI 编写或编写为 COM 服务器。

如果你的组件是一个普通的 C++ dll，你需要编写一些包装代码，最好是 C++/Cli

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T11:14:32.057

从 C# 使用 C++ DLL 有两种选择：COM 互操作或 P/Invoke。COM 互操作涉及在 C++ DLL 中创建一个 COM 对象，然后将其添加为引用。此时，您可以像使用 C# 对象（大部分情况下）一样使用 COM 对象。

P/Invoke 允许您从 C# 调用导出的函数（想想从 C# 调用标准 Win32 API 函数）。这可能更容易设置，因为您需要做的就是导出一个函数，但是这可能会导致您在 C++ DLL 中重构您的代码，因为它不是一种非常 OOP 的做事方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T11:18:55.603

我不确定这是否解决..

跑：

tlbimp /out:MyOldCom.dll MyNewAssembly.tlb

然后像使用任何其他程序集一样使用它。

请参考

[http://msdn.microsoft.com/en-us/library/aa302324.aspx](http://msdn.microsoft.com/en-us/library/aa302324.aspx)

[http://msdn.microsoft.com/en-us/magazine/cc301501.aspx](http://msdn.microsoft.com/en-us/magazine/cc301501.aspx)

IE）

一种方法是将您的 DLL 打包为 COM 类，另一种方法是使用 DllImport

# c# - 当构造函数使用赋予第一个构造函数的对象调用另一个构造函数时，您可以检查 null 吗？

> ID：665705
> 
> 赞同：4
> 
> 时间：2009-03-20T11:10:34.547
> 
> 标签：c#, constructor

如果我有一个具有两个构造函数的类，如下所示：

```
class Foo
{
    public Foo(string name)
    {...}

    public Foo(Bar bar): base(bar.name)
    {...}
} 
```

有什么方法可以在我得到空引用异常之前检查 bar 是否为空？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T11:14:28.233

您可以使用**静态**方法来执行此操作：

```
class Foo
{
    public Foo(string name) {
        ...
    }

    public Foo(Bar bar): base(GetName(bar)) {
        ...
    }

    static string GetName(Bar bar) {
        if(bar == null) {
            // or whatever you want ...
            throw new ArgumentNullException("bar");
        }
        return bar.Name;
    } 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-20T11:16:16.653

```
class Foo
{
    public Foo(Bar bar): base(bar == null ? default(string) : bar.name)
    {
        // ...
    }
} 
```

或者让 bar-class 使用 bar-class 的对象处理，如果您愿意，则抛出 ArgumentNullException

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T11:14:07.017

```
public Foo(Bar bar): base(bar == null ? "" : bar.name)
{...} 
```

# asp.net - 如何从 asp.net 中的不同程序集加载配置文件？

> ID：665708
> 
> 赞同：0
> 
> 时间：2009-03-20T11:12:39.720
> 
> 标签：asp.net, validation, configuration, assemblies

我正在使用 Enterprise Lib 中的验证应用程序块，并在与实体对象位于同一程序集中的 validation.config 中定义了我的验证规则（因此我可以在后端和网站上使用相同的规则）。

但是如何从实体程序集获取validation.config 到网站程序集的web.config 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T17:31:54.910

如果您的问题是关于加载不是标准 App.config 或 web.config 文件的配置文件，ConfigurationManager 有一个您可以使用的方法。

```
System.Configuration.Configuration config =
     ConfigurationManager.OpenExeConfiguration(@"pathToFile\Config.dll"); 
```

这将尝试加载一个名为 Config.dll.config 的文件。

# c# - 如何在 asp.net C# 中使用 Web 部件？

> ID：665710
> 
> 赞同：2
> 
> 时间：2009-03-20T11:13:15.087
> 
> 标签：c#, asp.net

如何使用 Web 部件执行拖放操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T11:21:15.723

这是 ASP.NET WebParts 的官方[MSDN 文档](http://msdn.microsoft.com/en-us/library/e0s9t4ck.aspx)。这是开篇文章，其中包含指向后续章节的所有链接，可帮助您进一步了解 WebPart 并将其实现到 ASP.NET 应用程序中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T15:40:15.287

还有专门针对 Web 部件的书籍，例如[ASP.NET 2.0 Web Parts in Action: Building Dynamic Web Portals](http://my.safaribooksonline.com/9781932394771) (APress)。

# c# - 是否可以通过比较项目的属性来自动处理 List.Contains？

> ID：665713
> 
> 赞同：1
> 
> 时间：2009-03-20T11:13:59.437
> 
> 标签：c#, list, equals, contains, iequatable

我们可以做一些类似的事情`List.Contains(myItem)`来检查列表中某个项目的属性是否等于`myItem`.

（我们已经考虑过`Contains`和`Exists`，类似于：

```
if (orderLines.Contains(myLine)) { ... }

```

但无法得到简单的表达。）

我们想要如下简单的东西：

```
if (orderLines.[MethodName](myLine))
{
}

```

如果至少有一项`orderLines[i]`满足，则此方法应自动返回 true：

```
myLine.Product.Equals(orderLines[i].Product)

```

我们已经实现`IEquatable<OrderLine>`了which equals by the `Product`property，但找不到从那里开始的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-20T11:17:20.240

您使用的是 .NET 3.5 吗？如果是这样，请使用 LINQ：

```
if (orderLines.Any(order => order.Product == myLine.Product))
{
    ...
} 
```

# wpf - WPF - 动画 ListBox.ScrollViewer.Horizo ntalOffset？

> ID：665719
> 
> 赞同：13
> 
> 时间：2009-03-20T11:15:09.277
> 
> 标签：wpf, animation, listbox, scrollviewer, horizontaloffset

我在 a 中有一个`Visual`s集合`ListBox`。我需要在其中找到`XPosition`一个元素的 ，然后对 的 进行动画`HorizontalOffset`处理。本质上我想创建一个动画方法。`ListBox``ScrollViewer``ScrollIntoView`

这给了我几个问题。首先，如何获得对`ListBox`s 滚动查看器的引用？其次，我怎样才能获得中任意元素的相对`XPosition`或？`HozintalOfffset``ListBox`

我没有回应任何关于`ListBox`自身的输入，所以我不能使用`Mouse`相关的属性。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-03-20T11:45:45.383

我认为您不能将 WPF 故事板用于动画，因为故事板会为 WPF 依赖属性设置动画。你需要打电话`ScrollViewer.ScrollToHorizontalOffset(double)`来滚动。

您可以尝试在 OnDependencyPropertyChanged() 函数中创建一个调用 SetHorizo​​ntalOffset 的自定义依赖项属性。然后你可以为这个属性设置动画。

```
public static readonly DependencyProperty ScrollOffsetProperty =
   DependencyProperty.Register("ScrollOffset", typeof(double), typeof(YOUR_TYPE),
   new FrameworkPropertyMetadata(0.0, new PropertyChangedCallback(OnScrollOffsetChanged)));

public double ScrollOffset
{
   get { return (double)GetValue(ScrollOffsetProperty); }
   set { SetValue(ScrollOffsetProperty, value); }
}

private static void OnScrollOffsetChanged(DependencyObject obj, DependencyPropertyChangedEventArgs args)
{
   YOUR_TYPE myObj = obj as YOUR_TYPE;

   if (myObj != null)
      myObj.SCROLL_VIEWER.ScrollToHorizontalOffset(myObj.ScrollOffset);
} 
```

要获得滚动查看器，您可以使用 VisualTreeHelper 搜索 ListBox 的可视子项。保存对 ScrollViewer 的引用，因为稍后您将需要它。试试这个：

```
public static childItem FindVisualChild<childItem>(DependencyObject obj)
   where childItem : DependencyObject
{
   // Iterate through all immediate children
   for (int i = 0; i < VisualTreeHelper.GetChildrenCount(obj); i++)
   {
      DependencyObject child = VisualTreeHelper.GetChild(obj, i);

      if (child != null && child is childItem)
         return (childItem)child;

      else
      {
         childItem childOfChild = FindVisualChild<childItem>(child);

         if (childOfChild != null)
            return childOfChild;
      }
   }

   return null;
} 
```

此函数返回参数类型的第一个可视子项。调用`FindVisualChild<ScrollViewer>(ListBox)`以获取 ScrollViewer。

最后，尝试使用`UIElement.TranslatePoint(Point, UIElement)`获取项目的 X 位置。在item上调用这个函数，传入0,0作为point，传入ScrollViewer。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-09T10:00:24.833

我不确定我的方法是否是好的做法，但在有限的时间内我似乎可以正常工作。我没有使用故事板，而是使用了 DispatcherTimer。

```
ScrollLeftButtonCommand = new DelegateCommand(
    o =>
       {
           var scrollViewer = (ScrollViewer)o;

           scrollTimer = new DispatcherTimer();

           scrollTimer.Start();

           scrollTimer.Interval = TimeSpan.FromMilliseconds(30);

           scrollTimer.Tick += (s, e) =>
           {          
               scrollViewer.ScrollToHorizontalOffset(scrollViewer.HorizontalOffset - 50);

               if (scrollViewer.HorizontalOffset <= 0)
               {
                   scrollTimer.Stop();
               }
           };
       }); 
```

确保它是 DispatchTimer，以便线程能够控制 UI 元素

还要记住在您的视图中绑定到您的对象！

```
<Button CommandParameter="{Binding ElementName=MyScrollViewer }"
        Command="{Binding ScrollLeftButtonCommand }"/> 
```

# c# - Windows 窗体编辑器中的错误

> ID：665720
> 
> 赞同：1
> 
> 时间：2009-03-20T11:16:01.337
> 
> 标签：c#, winforms, exception

我目前正在为一个项目使用 Microsoft Visual C# Express Edition（带有 SP1）。编辑一个特定表单时，我在表单编辑器中遇到一些奇怪的错误，消息显示：

> 在程序集“System.Windows.Forms，Version=2.0.0.0，Culture=neutral，PublicKeyToken=b77a5c561934e089”中键入“System.Windows.Forms.Control”未标记为可序列化。

它出现在尝试保存表单时。它通常连续出现 3 到 5 次，但有时也会每隔几秒钟不间断地弹出，直到我终止应用程序。

我相信它是在我尝试添加一些应用程序设置时开始的，但我似乎无法重现它。

任何如何发现错误的想法将不胜感激，谢谢。

* * *

编辑：保存表单意味着单击 Visual C# Express 中的“保存”按钮。我不想手动序列化它，在 IDE 中编辑表单时会弹出错误。

编辑：这是一个屏幕截图 - 当我保存表单时会弹出。
[http://img10.imageshack.us/my.php?image=notserializable.png](http://img10.imageshack.us/my.php?image=notserializable.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T12:43:21.890

Windows 窗体设计器在您编辑窗体时将其序列化，在`.Designer.cs`. 这就是为什么您在编辑表单时经常看到错误的原因。

通常，您编辑派生自`UserControl`或`Form`在设计器中的类。您的错误似乎表明它正在尝试序列化控件。您是否将 MainForm 的基类更改为 Control？

还是您手动编辑了 MainForm.Designer.cs 文件？我强烈建议不要直接编辑 .Designer.cs 文件，因为如果这样做，很容易破坏 Windows 窗体设计器的支持。

# c# - 如果 IIS 支持应用程序池，我如何以编程方式签入 C# 安装程序类？

> ID：665721
> 
> 赞同：2
> 
> 时间：2009-03-20T11:16:08.370
> 
> 标签：c#, .net, iis, installation

我正在编写一个安装程序类，我正在其中创建一个新的应用程序池。这显然不适用于 IIS <6.0。在尝试添加应用程序池之前，如何安全地检查（在 .Net 中以编程方式）IIS 是否支持应用程序池？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T11:23:36.013

如果您愿意依赖该版本，它在注册表中

```
Key: \HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\InetStp
Value Name: MajorVersion 
```

# c++ - C++/Qt：绘制插入符号

> ID：665741
> 
> 赞同：5
> 
> 时间：2009-03-20T11:24:29.117
> 
> 标签：c++, qt, caret, paint

我正在学习Qt。我刚刚开始通过继承 QAbstractScrollArea 从头开始​​编写文本编辑器。我这样做只是为了练习。但现在我面临显示插入符号的问题。我想到的是`painter.drawLine`和`QTimer`。您能否就此提出一些建议。我也很高兴听到一些实施块和下划线插入符号的策略。

题外话：这是一个错误吗？StackOverflow 说这个问题有两个答案，但我只看到一个！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-20T11:41:48.357

看看[QLineEdit](http://doc.qt.io/qt-5/qlineedit.html)中的paintEvent() 。它有一个计时器，可以打开和关闭光标。真正的光标绘制是通过[QTextLayout::drawCursor](http://doc.qt.io/qt-4.8/qtextlayout.html#drawCursor-2)完成的。

对于一般的文本编辑器，请查看[QPlainTextEdit](http://doc.qt.io/qt-5/qplaintextedit.html)和[QTextEdit](http://doc.qt.io/qt-4.8/qtextedit.html)。

# c - 使用无符号索引执行反向“for”循环的最佳方法是什么？

> ID：665745
> 
> 赞同：67
> 
> 时间：2009-03-20T11:26:08.860
> 
> 标签：c, for-loop

我第一次尝试执行 n 次的**反向 for 循环**是这样的：

```
for ( unsigned int i = n-1; i >= 0; i-- ) {
    ...     
} 
```

这**失败**了，因为在*无符号算术* `i`中保证始终大于或等于零，因此循环条件将始终为真。幸运的是，在我不得不怀疑为什么循环无限执行之前，gcc 编译器警告我“毫无意义的比较”。

* * *

我正在寻找一种解决此问题的优雅方法，请记住：

1.  它应该是一个向后的for循环。
2.  循环索引应该是无符号的。
3.  n 是无符号常数。
4.  它不应该基于无符号整数的“晦涩”环算术。

有任何想法吗？谢谢 ：）

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2009-03-20T11:35:59.477

怎么样：

```
for (unsigned i = n ; i-- > 0 ; )
{
  // do stuff with i
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-03-20T11:30:53.297

```
for ( unsigned int loopIndex = n; loopIndex > 0; --loopIndex ) {
    unsigned int i = loopIndex - 1;
    ...
} 
```

或者

```
for ( unsigned int loopIndex = 0; loopIndex < n; ++loopIndex ) {
    unsigned int i = n - loopIndex - 1;
    ...
} 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-03-20T11:29:46.280

```
for ( unsigned int i = n; i != 0; i-- ) {
    // do something with i - 1
    ...     
} 
```

请注意，如果您同时使用 C++ 和 C，当您切换到使用迭代器时，使用 != 是一个好习惯，其中 <= 等可能不可用。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2011-05-11T07:30:40.407

为什么不简单：

```
unsigned int i = n;
while(i--)
{ 
    // use i
} 
```

这符合问题正文中列举的所有要求。它不使用任何可能导致代码审查失败或违反编码标准的东西。我能看到的唯一反对意见是，如果 OP 真的坚持`for`循环而不是生成 i = (n-1) .. 0 的直接方式。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-03-20T11:44:44.650

我倾向于使用

```
 for ( unsigned int i = n; i > 0; )  {
    --i;
    ...     
 } 
```

它与skizz的答案几乎相同，（它错过了最终不必要的递减，但编译器应该优化掉它），实际上会通过代码审查。我必须使用的每个编码标准在条件规则中都没有变化。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-03-20T11:30:10.210

```
for ( unsigned int i = n; i > 0; i-- ) {
    ...  
    i-1 //wherever you've been using i   
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-03-20T11:52:18.143

也许这样？恕我直言，它清晰易读。如果以某种方式隐含地知道 if(n>=1)，则可以省略它。

```
if(n>=1) {
    // Start the loop at last index
    unsigned int i = n-1;
    do {
       // a plus: you can use i, not i-1 here
    } while( i-- != 0 );
} 
```

另一个版本：

```
if(n>=1) {
    unsigned int i = n;
    do {
       i--;

    } while( i != 0 );
} 
```

第一个没有 if 语句的代码如下所示：

```
unsigned int i = n-1;
do {

} while( i-- != 0 ); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-03-20T12:34:38.027

```
for (unsigned int i = n-1; i<(unsigned int)-1; i--) 
```

好的，它的“晦涩的环算术”。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-03-20T13:05:42.133

`unsigned int`或者，如果您需要从 n-1 到 0 的索引，您可以依赖包装行为

```
for(unsigned int i = n-1; i < n; i--) {
    ...
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-03-20T11:32:00.547

```
for ( unsigned int i = n; i > 0; i-- ) {
    unsigned int x = i - 1;
    // do whatever you want with x    
} 
```

当然不优雅，但它的工作原理。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-03-20T13:08:40.643

我提到这个选项的唯一原因是因为我没有在列表中看到它。

```
for ( unsigned int i = n-1; i < n; i-- ) {
... 
} 
```

完全违背直觉，但它确实有效。它起作用的原因是因为从 0 中减去 1 会产生可以用无符号整数表示的最大数字。

一般来说，我不认为使用无符号整数和算术是一个好主意，尤其是在减法时。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-09-06T21:56:26.763

很简单，只需在 -1 处停止：

```
for( unsigned int i = n; i != -1; --i )
{
 /* do stuff with i */
} 
```

编辑：不知道为什么这会被否决。它有效，并且比上述任何一种都更简单、更明显。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-03-20T11:31:16.120

```
for ( unsigned int i = n; i > 0; i-- ) {
    ...     
} 
```

应该可以正常工作。如果您需要将`i`变量用作数组的索引，请执行以下操作：

```
array[i-1]; 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-03-20T11:39:29.983

嗯。以下是您的选择：

1.  `i=0`用作您的中断条件 - 当 i 达到 0 时循环不会执行，因此在循环退出后执行循环内容的 1 次迭代`i=0`。

```
for ( unsigned int i = n-1; i > 0; i-- ) {
    doStuff(i);
}
doStuff(0); 
```

2.  在循环中，测试`i=0`和`break`输出。不推荐，因为现在您要在循环中两次测试 i 的值。在循环中使用 break 通常也被视为不好的做法。

```
for ( unsigned int i = n-1; i >= 0; i-- ) {
    doStuff(i);
    if (i=0) break;
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-03-20T14:20:55.977

```
unsigned index;
for (unsigned i=0; i<n; i++)
{
    index = n-1 - i; // {i == 0..n-1} => {index == n-1..0}
} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-20T12:25:17.517

由于这不是循环的标准，我可能会使用 while 循环，例如：

```
unsigned int i = n - 1;
while (1)
{
    /* do stuff  with i */

     if (i == 0)
    {
        break;
    }
    i--;
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-03-20T12:32:42.710

这是未经测试的，但您可以执行以下操作：

```
for (unsigned int i, j = 0; j < n; i = (n - ++j)) {
    /* do stuff with i */
} 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-03-21T17:15:16.643

*使用两个变量，一个用于向上*计数，另一个用于数组索引：

```
unsigned int Index = MAX - 1;
unsigned int Counter;
for(Counter = 0; Counter < MAX; Counter++)
{
    // Use Index
    Index--;
} 
```

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2009-03-20T11:32:49.827

```
for ( unsigned int i = n-1; (n-i) >= 0; i-- ) {
    // n-i will be negative when the loop should stop.
    ...     
} 
```

* * *

## 回答 #20

> 赞同：-6
> 
> 时间：2009-09-06T22:20:41.120

埃兹：

```
#define unsigned signed

for ( unsigned int i = n-1; i >= 0; i-- ) { ... 
} 
```

# c# - RabbitMQ C# 客户端不与 Apache Qpid Java Broker 对话

> ID：665746
> 
> 赞同：0
> 
> 时间：2009-03-20T11:26:11.873
> 
> 标签：c#, java, amqp

我在 Windows 机器上安装了 Apache Qpid Java 代理的 M4 版本，并使用开箱即用的配置（通过 qpid-server.bat 脚本）启动它。

我现在正在尝试使用 RabbitMQ C# 客户端库（版本 1.5.3，为 .NET 3.0 编译）将消息发布到队列；我的代码是：

```
public void PublishMessage(string message)
{
    ConnectionFactory factory = new ConnectionFactory();
    factory.Parameters.VirtualHost = "...";
    IProtocol protocol = Protocols.FromEnvironment();
    using (IConnection conn = factory.CreateConnection(protocol, "localhost", 5672))
    {
        using (IModel ch = conn.CreateModel())
        {
            string exchange = "...";
            string routingKey = "...";
            ch.BasicPublish(exchange, routingKey, null, Encoding.UTF8.GetBytes(message));
        }
    }
} 
```

基本上，我不确定要使用什么值`factory.Parameters.VirtualHost`以及字符串`exchange`和`routingKey`. 我尝试了各种组合，但似乎没有任何效果 - 我最接近的是在 Qpid 服务器日志中看到以下内容：

```
2009-03-19 17:11:04,248 WARN  [pool-1-thread-1] queue.IncomingMessage (IncomingMessage.java:198) - MESSAGE DISCARDED: No routes for message - Message[(HC:896033 ID:1 Ref:1)]: 1; ref count: 1 
```

看起来好像 Qpid 服务器正在接收消息，但不知道如何处理它。

任何关于我在客户端代码中需要什么配置值的建议（请记住我在 virtualhosts.xml 中使用默认的 Qpid 配置）将不胜感激。有关虚拟主机、交换器、队列和路由键以及 Qpid 如何将它们链接在一起的更多一般信息也将非常有用。

先感谢您，

艾伦

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-23T10:43:14.603

仅供参考，我最终设法让它工作。下面的代码向 localhost 虚拟主机上的 test.direct 交换中的队列 test-queue 发送一条消息（所有默认 Qpid 代理配置的一部分）：

```
public void PublishMessage(string message)
{
    ConnectionFactory factory = new ConnectionFactory();
    factory.Parameters.VirtualHost = "/localhost";
    IProtocol protocol = Protocols.AMQP_0_8_QPID;
    using (IConnection conn = factory.CreateConnection(protocol, "localhost", 5672))
    {
        using (IModel ch = conn.CreateModel())
        {
            ch.ExchangeDeclare("test.direct", "direct");
            ch.QueueDeclare("test-queue");
            ch.QueueBind("test-queue", "test.direct", "TEST", false, null);
            ch.BasicPublish("test.direct", "TEST", null, Encoding.UTF8.GetBytes(message));
        }
    }
} 
```

# vb.net - 在 Visual Studio 2008 中禁用 Visual Basic 后台编译器

> ID：665747
> 
> 赞同：6
> 
> 时间：2009-03-20T11:26:47.177
> 
> 标签：vb.net, visual-studio-2008

如何在 Visual Studio 2008 中禁用 Visual Basic 的后台编译器？

对于我的罪过，我必须在一个大型 VB.NET 项目上工作，而且它经常一次锁定 20 秒，同时进行*非常有用*的后台编译，这**非常**令人沮丧。

我宁愿在编译之间盲目地工作并且能够做一些工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T13:33:27.480

不，没有办法禁用后台编译器。

您是否安装了 Visual Studio 2008 **SP1**。我们在 VS 2008 的 RTM 版本中修复了几个错误，这些错误可能导致 IDE 在某些情况下挂起。

我们非常重视后台编译器的问题。如果你能给我们一个问题的重现，它肯定会被调查。如果您可以在 IDE 锁定时生成这样的复制品甚至向我们发送内存转储，请在 Connect 上提交错误：[https ://connect.microsoft.com/VisualStudio](https://connect.microsoft.com/VisualStudio)

您可以采取其他几个步骤。你在VS中安装了任何插件吗？如果是这样，请尝试一次卸载 1 个。我见过几个案例，其中第 3 方加载项导致 IDE 中的锁定与 C#/VB 框架完全无关。

# sql-server - 重命名数据库字段

> ID：665748
> 
> 赞同：0
> 
> 时间：2009-03-20T11:27:25.193
> 
> 标签：sql-server, sql-server-2005, refactoring

我有一个数据库，其中主表有一个非常糟糕的主键字段，我想重命名它。该主键字段被大约 20 个其他表和大约 15 个存储过程引用。

在整个数据库中引用该字段的任何地方重命名此字段的最简单方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T11:35:05.500

存在数据库重构工具来执行您需要的那种操作。只需在谷歌上搜索“数据库重构工具”，然后选择适合您特定品牌的数据库的东西。DB Deploy 就是这样一个工具[http://dbdeploy.com/](http://dbdeploy.com/)的一个例子。

如果出于某种原因您想手动执行此操作并且您没有处理庞大的数据库，我可能会导出数据库（ddl 和数据）的文本，然后忙于查找和替换。

编辑：此外，Redgate（[http://www.red-gate.com/](http://www.red-gate.com/)）的软件评价很高，但要花钱。就我个人而言，我认为他们的产品非常好，考虑到他们可以节省的时间，每一分钱都值得。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T11:44:45.260

如果是我，我会使用 Managment Studio 手动完成；选择数据库，然后右键单击以获取任务-> 生成脚本并选择数据库中的所有对象以将 DDL 导出到新的查询窗口或您选择的编辑器中，然后使用“查找”命令查找每个实例密钥存在的地方，然后使用 management studio 直接对数据库进行相应的更改。

确保你备份你有一个备份数据库以防万一。

# jquery - 在 Firefox 中，如何强制光标停留在最后输入的字符上？

> ID：665750
> 
> 赞同：4
> 
> 时间：2009-03-20T11:28:26.140
> 
> 标签：jquery, css, forms, input, text-cursor

我有一个输入字段，将在其中输入序列号。设置允许的字符数。

问题是由于字母间距，在 Firefox 中键入字符时，光标会跳到您将键入下一个字符的位置（即使设置了 maxlength），字符会从它们所在的小方框中分离出来应该坐进去

IE 显示它'正确'。

如何强制 Firefox*不在*字母间距*之后*放置光标？（如果可能/需要 JS，jQuery 会很好）

这是我的代码：

```
#serial {
    background:transparent url(../images/bg_serial.gif) no-repeat scroll 0 50%;
    border:0 none;
    color:#FFFFFF;
    font:bold 16px Courier New;
    height:22px;
    letter-spacing:14px;
    line-height:normal;
    padding:4px 0 0 6px;
    text-transform:uppercase;
    width:208px;
} 
```

```
<form id="serialForm">
<label for="serial">Serial:</label>
<input id="serial" type="text" name="serial" maxlength="9" />
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-24T13:38:57.557

`letter-spacing`看来，FireFox 的处理方式与 Internet Explorer 和其他浏览器不同。

如果`width`将输入元素的 更改为 220 像素，则不会导致任何文本溢出。而且由于您有效地隐藏了输入，因此额外的宽度无关紧要。

我已经在 Chrome build 1.0.154.53、FireFox 3.0.7 和 Internext Explorer 8.0.6001 中测试了这个解决方案。18372。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T13:36:40.390

我担心firefox实际上会像它应该处理的那样处理这个问题，因为现在字符被右填充以匹配字母间距。Safari 也这样做。IE 做错了，它假装字符比实际小。

我建议只是使输入框的宽度变大...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T14:35:04.540

您如何检查序列号的长度，如果它达到正确的长度，它将把焦点移到另一个元素，从而避免溢出？

```
<script type="text/javascript">
function CheckLength(myBox){
var myValue= myBox.Value;
var myLength myValue.Length;
if(myLength == 9){
document.getElementById("Submit").Focus();
}
</script>
<form id="serialForm">
<label for="serial">Serial:</label>
<input id="serial" type="text" name="serial" maxlength="9" onkeyup="CheckLength(this);" />
<input type="submit" id="Submit" value="Submit"/>
</form> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T14:39:43.327

您可以将背景图像的 x 位置偏移一定量，以便背景与 Firefox/Safari 等中的字符对齐，然后使用条件 IE CSS 语句让 IE 恢复到您的 0 50 % 定位。

编辑：误解了问题只出现在最后一个字符上。如果在布局的其余部分中像素精度不是必需的，则在 IE 和 Firefox 中将#serial 的宽度设置为大约 width:230px 对我有用。

# asp.net - 如何在 RowDeleting 事件期间从 GridView 中删除一行？

> ID：665751
> 
> 赞同：0
> 
> 时间：2009-03-20T11:29:30.757
> 
> 标签：asp.net, .net, vb.net, gridview

我有一个 GridView，它的 DataSource 是`datatable.OnRowDeleting`Gridview 的事件。当我单击调用事件以删除行的“删除”按钮时，我似乎无法删除该行。

`RowDeleting`我的代码在GridView 事件中是这样的：

```
DataTable.Rows.Remove(GridView.DataKeys(e.rowindex).value) 
```

我得到错误：

> `"Cannot type cast from System.Int32 To System.Data.DataRow"`

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T11:32:19.597

`RowDeleting`您可以通过查看在事件中找到要删除的行

```
e.RowIndex 
```

然后，您可以使用.databind() 在 .data`e.RowIndex`中找到正确的行`DataTable`，删除该行，然后`gridview`再次调用 .databind() 来刷新您的`DataTable`.

**例子：**

```
DataTable1.Rows(e.RowIndex).Delete()
GridView1.DataSource = DataTable1
GridView1.DataBind() 
```

# c - 组合静态库

> ID：665752
> 
> 赞同：14
> 
> 时间：2009-03-20T11:29:32.270
> 
> 标签：c, linux, static-libraries, static-linking, unix-ar

假设我有三个**C**静态库，说*libColor.a*取决于 *libRGB.*a ，而后者又取决于*libPixel.a*。据说库*libColor.a依赖于库**libRGB.a*，因为在 libColor.a 中有一些对*libRGB.a*中定义的一些符号的*引用*。如何将上述所有库组合成一个独立的新*libNewColor.a*？

独立意味着新库应该定义所有符号。因此，在链接时，我只需要提供**-lNewColor**。新库的大小应该是最小的，即它不应该包含*libColor.a*等未使用的 libRGB.a 中的*任何*符号。我在**ar**命令中使用了各种选项（用于创建和更新静态库/档案） ）。

 **** * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-09-03T17:36:03.403

GNU 归档器的一个小用处是归档脚本，它是一个简单但功能强大的界面，它可以做你想做的事，例如，如果下面的脚本被称为 script.ar：

```
CREATE libNewColor.a
ADDLIB libColor.a
ADDLIB libRGB.a
ADDLIB libPixel.a
SAVE
END 
```

然后你可以调用 ar 如下：

```
ar -M < script.ar 
```

你会得到 libNewColor.a，其中包含来自 libColor.a、libRGB.a 和 libPixel.a 的所有 .o 文件。

此外，您还可以使用 ADDMOD 命令添加常规 .o 文件：

```
CREATE libNewColor.a
ADDLIB libColor.a
ADDLIB libRGB.a
ADDLIB libPixel.a
ADDMOD someRandomCompiledFile.o
SAVE
END 
```

此外，在 Makefiles 中生成这些脚本非常容易，因此我通常创建一个通用的 makefile 规则来创建实际生成脚本并在脚本上调用 ar 的档案。像这样的东西：

```
$(OUTARC): $(OBJECTS)
    $(SILENT)echo "CREATE $@" > $(ODIR)/$(ARSCRIPT)
    $(SILENT)for a in $(ARCHIVES); do (echo "ADDLIB $$a" >> $(ODIR)/$(ARSCRIPT)); done
    $(SILENT)echo "ADDMOD $(OBJECTS)" >> $(ODIR)/$(ARSCRIPT)
    $(SILENT)echo "SAVE" >> $(ODIR)/$(ARSCRIPT)
    $(SILENT)echo "END" >> $(ODIR)/$(ARSCRIPT)
    $(SILENT)$(AR) -M < $(ODIR)/$(ARSCRIPT) 
```

虽然现在我看它，但我想如果 $(OBJECTS) 为空（即，如果您只想合并档案而不添加额外的目标文件）它不起作用，但我将把它作为练习留给读者修复它如果需要，问题...：D

以下是此功能的文档：

[https://sourceware.org/binutils/docs/binutils/ar-scripts.html#ar-scripts](https://sourceware.org/binutils/docs/binutils/ar-scripts.html#ar-scripts)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-03-20T11:47:02.027

1/ 从每个库中提取所有目标文件（使用`ar`）并尝试在没有库或任何目标文件的情况下编译您的代码。您可能会得到大量未定义的符号。如果您没有得到未定义的符号，请转到第 5 步。

2/ 获取第一个并找出哪个目标文件满足该符号（使用`nm`）。

3/ 写下那个目标文件然后编译你的代码，包括新的目标文件。您将获得一个新的未定义符号列表，如果没有，请转到第 5 步。

4/ 转到第 2 步。

5/ 将列表中的所有目标文件（如果有）合并到一个库中（再次使用`ar`）。

砰! 你有它。尝试在没有任何对象但*使用*新库的情况下链接您的代码。

这整个事情可以相对容易地使用 shell 脚本自动化。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-20T11:41:59.167

静态库只不过是一些目标文件 (.o) 的存档。您可以做的是提取两个库中的所有对象（使用“ar x”），然后使用“ar”将它们链接到一个新库中。

# c# - C#中DataTables的内连接

> ID：665754
> 
> 赞同：43
> 
> 时间：2009-03-20T11:29:58.913
> 
> 标签：c#, join, datatable, inner-join

让 T1 和 T2 是`DataTable`具有以下字段的 s

```
T1(CustID, ColX, ColY)

T2(CustID, ColZ) 
```

我需要联表

```
TJ (CustID, ColX, ColY, ColZ) 
```

如何以简单的方式在 C# 代码中完成此操作？谢谢。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-03-20T12:01:24.767

如果允许您使用 LINQ，请查看以下示例。它创建两个具有整数列的 DataTable，用一些记录填充它们，使用 LINQ 查询连接它们并将它们输出到控制台。

```
 DataTable dt1 = new DataTable();
    dt1.Columns.Add("CustID", typeof(int));
    dt1.Columns.Add("ColX", typeof(int));
    dt1.Columns.Add("ColY", typeof(int));

    DataTable dt2 = new DataTable();
    dt2.Columns.Add("CustID", typeof(int));
    dt2.Columns.Add("ColZ", typeof(int));

    for (int i = 1; i <= 5; i++)
    {
        DataRow row = dt1.NewRow();
        row["CustID"] = i;
        row["ColX"] = 10 + i;
        row["ColY"] = 20 + i;
        dt1.Rows.Add(row);

        row = dt2.NewRow();
        row["CustID"] = i;
        row["ColZ"] = 30 + i;
        dt2.Rows.Add(row);
    }

    var results = from table1 in dt1.AsEnumerable()
                 join table2 in dt2.AsEnumerable() on (int)table1["CustID"] equals (int)table2["CustID"]
                 select new
                 {
                     CustID = (int)table1["CustID"],
                     ColX = (int)table1["ColX"],
                     ColY = (int)table1["ColY"],
                     ColZ = (int)table2["ColZ"]
                 };
    foreach (var item in results)
    {
        Console.WriteLine(String.Format("ID = {0}, ColX = {1}, ColY = {2}, ColZ = {3}", item.CustID, item.ColX, item.ColY, item.ColZ));
    }
    Console.ReadLine();

// Output:
// ID = 1, ColX = 11, ColY = 21, ColZ = 31
// ID = 2, ColX = 12, ColY = 22, ColZ = 32
// ID = 3, ColX = 13, ColY = 23, ColZ = 33
// ID = 4, ColX = 14, ColY = 24, ColZ = 34
// ID = 5, ColX = 15, ColY = 25, ColZ = 35 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2012-07-16T13:56:51.277

我想要一个无需您使用匿名类型选择器定义列即可连接表的函数，但很难找到任何列。我最终不得不自己做。希望这将有助于将来搜索此内容的任何人：

```
private DataTable JoinDataTables(DataTable t1, DataTable t2, params Func<DataRow, DataRow, bool>[] joinOn)
{
    DataTable result = new DataTable();
    foreach (DataColumn col in t1.Columns)
    {
        if (result.Columns[col.ColumnName] == null)
            result.Columns.Add(col.ColumnName, col.DataType);
    }
    foreach (DataColumn col in t2.Columns)
    {
        if (result.Columns[col.ColumnName] == null)
            result.Columns.Add(col.ColumnName, col.DataType);
    }
    foreach (DataRow row1 in t1.Rows)
    {
        var joinRows = t2.AsEnumerable().Where(row2 =>
            {
                foreach (var parameter in joinOn)
                {
                    if (!parameter(row1, row2)) return false;
                }
                return true;
            });
        foreach (DataRow fromRow in joinRows)
        {
            DataRow insertRow = result.NewRow();
            foreach (DataColumn col1 in t1.Columns)
            {
                insertRow[col1.ColumnName] = row1[col1.ColumnName];
            }
            foreach (DataColumn col2 in t2.Columns)
            {
                insertRow[col2.ColumnName] = fromRow[col2.ColumnName];
            }
            result.Rows.Add(insertRow);
        }
    }
    return result;
} 
```

您可以如何使用它的一个示例：

```
var test = JoinDataTables(transactionInfo, transactionItems,
               (row1, row2) =>
               row1.Field<int>("TransactionID") == row2.Field<int>("TransactionID")); 
```

一个警告：这肯定不是优化的，所以当行数超过 20k 时要注意。如果您知道一张桌子会比另一张大，请尝试将较小的一张放在第一位，然后将较大的一张放在第二位。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-07-19T09:13:41.863

这是我的代码。不完美，但工作良好。我希望它可以帮助某人：

```
 static System.Data.DataTable DtTbl (System.Data.DataTable[] dtToJoin)
    {
        System.Data.DataTable dtJoined = new System.Data.DataTable();

        foreach (System.Data.DataColumn dc in dtToJoin[0].Columns)
            dtJoined.Columns.Add(dc.ColumnName);

        foreach (System.Data.DataTable dt in dtToJoin)
            foreach (System.Data.DataRow dr1 in dt.Rows)
            {
                System.Data.DataRow dr = dtJoined.NewRow();
                foreach (System.Data.DataColumn dc in dtToJoin[0].Columns)
                    dr[dc.ColumnName] = dr1[dc.ColumnName];

                dtJoined.Rows.Add(dr);
            }

        return dtJoined;
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-18T12:16:06.420

此函数将使用已知的连接字段连接 2 个表，但这不能允许两个表上的 2 个具有相同名称的字段，除了连接字段，一个简单的修改是保存带有计数器的字典，只需将数字添加到同名领域。

```
public static DataTable JoinDataTable(DataTable dataTable1, DataTable dataTable2, string joinField)
{
    var dt = new DataTable();
    var joinTable = from t1 in dataTable1.AsEnumerable()
                            join t2 in dataTable2.AsEnumerable()
                                on t1[joinField] equals t2[joinField]
                            select new { t1, t2 };

    foreach (DataColumn col in dataTable1.Columns)
        dt.Columns.Add(col.ColumnName, typeof(string));

    dt.Columns.Remove(joinField);

    foreach (DataColumn col in dataTable2.Columns)
        dt.Columns.Add(col.ColumnName, typeof(string));

    foreach (var row in joinTable)
    {
        var newRow = dt.NewRow();
        newRow.ItemArray = row.t1.ItemArray.Union(row.t2.ItemArray).ToArray();
        dt.Rows.Add(newRow);
    }
    return dt;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-22T16:07:57.383

我试着用下一种方式做到这一点

```
public static DataTable JoinTwoTables(DataTable innerTable, DataTable outerTable)
        {
            DataTable resultTable = new DataTable();
            var innerTableColumns = new List<string>();
            foreach (DataColumn column in innerTable.Columns)
            {
                innerTableColumns.Add(column.ColumnName);
                resultTable.Columns.Add(column.ColumnName);
            }

            var outerTableColumns = new List<string>();
            foreach (DataColumn column in outerTable.Columns)
            {
                if (!innerTableColumns.Contains(column.ColumnName))
                {
                    outerTableColumns.Add(column.ColumnName);
                    resultTable.Columns.Add(column.ColumnName);
                }                    
            }

            for (int i = 0; i < innerTable.Rows.Count; i++)
            {
                var row = resultTable.NewRow();
                innerTableColumns.ForEach(x =>
                {
                    row[x] = innerTable.Rows[i][x];
                });
                outerTableColumns.ForEach(x => 
                {
                    row[x] = outerTable.Rows[i][x];
                });
                resultTable.Rows.Add(row);
            }
            return resultTable;
        } 
```

# c# - 如何从资源中获取字符串以在 xaml 的 WPF 资源部分中分配

> ID：665764
> 
> 赞同：13
> 
> 时间：2009-03-20T11:33:14.273
> 
> 标签：c#, wpf, localization, xbap

我有一个具有以下用户控件的 XBAP 应用程序：

```
 <UserControl x:Class="XXX.UsersGrid"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Height="Auto" Width="Auto">

        <UserControl.Resources>
            <DataTemplate x:Key="UpArrowUsers">
                <DockPanel>
                    <TextBlock Text="xxUser" x:Name="upArrowUsersHeader" HorizontalAlignment="Center"></TextBlock>
                    <Path x:Name="arrow" StrokeThickness = "1" Fill= "gray" Data= "M 5,10 L 15,10 L 10,5 L 5,10"/>
                </DockPanel>
            </DataTemplate>
    </UserControl>
    ... 
```

现在我想从作为资源嵌入到应用程序中的 resx 文件中获取字符串“xxUser”我该如何实现？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2010-01-31T02:45:06.190

我能够在一个程序中做到这一点：

```
<TextBlock VerticalAlignment="Center" Margin="3"
           Text="{x:Static prop:Resources.OpenButton}"
           Visibility="{Binding Source={x:Static prop:Settings.Default}, Path=ShowButtonText, 
           Converter={StaticResource BoolToVis}}"></TextBlock> 
```

我还必须在我的 xaml 中包含 .Properties 命名空间，如下所示：

```
xmlns:prop="clr-namespace:MyProjectNamespace.Properties" 
```

这使我不仅可以使用为我的项目定义的字符串资源进行全球化，而且我还能够（两种方式）绑定到我的应用程序的设置。这让我*很容易*记住窗口的位置、大小等。如您所见，使用设置。用于设置和资源。对于资源。

正如 Steven 所提到的，我认为“官方”方式或“最佳”方式是将 x:Uid 粘贴在您想要全球化的所有内容上，但我没有这样做，而且它没有任何问题。我认为如果您使用自动化工具或像在大型项目中那样分解翻译任务，则最需要 x:Uid 东西。我只是在 VS 中手动完成了我自己的所有工作，所以也许没问题。

本

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-01-31T04:36:44.347

我在上面“我能够做到……”中忘记提到的另外两点：

1.  您不必自己包装 Properties.Resources 对象。您可以直接访问它，就像我在上面的示例中所做的那样。我认为包装对象是一种获得与我在第二点中讨论的相同结果的方法。
2.  默认情况下，资源文件是使用“ResXFileCodeGenerator”构建的。这使得它们在生成代码文件时成为内部文件，因此 xaml 无法访问它。您必须将其更改为“ **PublicResXFileCodeGenerator** ”，它会生成公共类。您可以通过单击解决方案资源管理器中的资源文件并编辑“自定义工具”属性来更改此设置。

（对不起，我不能编辑我的上面的帖子，因为我当时是临时会员。）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-02T05:47:07.533

正如[本](https://stackoverflow.com/a/2170357/419348)所说，我找到[了另一个教程](http://www.rhyous.com/2010/10/20/using-resources-resx-for-strings-in-a-wpf-application-a-technique-to-prepare-for-localization/)。的应该从更改`access modifier`为。我失败了很多次，在更改为之后，它确实有效。`Resources.resx``Internal``Public``access modifier``Public`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-03-20T13:35:17.897

创建一个静态类，使资源可用作属性：

```
public static class Resources
{
   public string Resource
   {
      return Properties.Resources.ResourceManager.GetString("Resource");
   }
} 
```

然后你可以将你的 TextBox 绑定到这个：

```
<TextBlock Text="{Binding Source={x:Static local:Resources}, Path=Resource}" x:Name="upArrowUsersHeader" HorizontalAlignment="Center"
   xmlns:local="clr-namespace:MY_NAMESPACE;assembly=MY_ASSEMBLY"> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-20T17:24:52.120

这些答案都不是你想要的。我将从阅读 WPF 中的本地化开始。您会发现，如果您使用 WPF 进行本地化，您需要在应用程序的每个节点上定义 x:Uid。

[http://msdn.microsoft.com/en-us/library/ms788718.aspx](http://msdn.microsoft.com/en-us/library/ms788718.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-20T12:37:41.000

我不知道这是否可以直接在 XAML 中完成，但如果您围绕 ResourceManager 编写自己的包装类并改用它。请注意，该类继承自 TextBlock：

```
public class ResourceContentTextBlock : TextBlock
{
    public string ResourceName 
    {
        set
        {
            this.Text = Properties.Resources.ResourceManager.GetString(value);
        }
    }
} 
```

然后，您可以在 XAML 中使用 TextBlock 的任何地方使用 ResourceContentTextBlock：

```
<Window x:Class="WpfApplication3.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:client="clr-namespace:WpfApplication3" 
    >
        <client:ResourceContentTextBlock ResourceName="String1" />
</Window> 
```

# ios - 如何在 iOS 中拨打电话？

> ID：665769
> 
> 赞同：45
> 
> 时间：2009-03-20T11:35:03.787
> 
> 标签：ios, objective-c, iphone

如何在 Objective-C 中拨打电话？

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2009-03-20T11:48:02.053

您可以拨打电话

[https://developer.apple.com/library/archive/featuredarticles/iPhoneURLScheme_Reference/PhoneLinks/PhoneLinks.html](https://developer.apple.com/library/archive/featuredarticles/iPhoneURLScheme_Reference/PhoneLinks/PhoneLinks.html)

所以这可能会起作用：

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"tel:12125551212"]  options:@{} completionHandler:nil]; 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-03-20T17:18:12.743

这是从我做的一个项目中剪下来的：

```
NSString *phoneStr = [NSString stringWithFormat:@"tel:%@",phone_number];
NSURL *phoneURL = [NSURL URLWithString:phoneStr];
[[UIApplication sharedApplication] openURL:phoneURL]; 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2013-11-29T19:07:38.893

了解如何提示用户拨打号码也可能会有所帮助：

```
NSURL *phoneNumber = [NSURL URLWithString:@"telprompt://13232222222"];
[[UIApplication sharedApplication] openURL:phoneNumber]; 
```

`telprompt`让用户可以选择在电话拨号之前拨打电话或取消拨打电话。冒号后面的两个正斜杠是可选的。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-03-20T11:53:27.830

好吧，如果您正在谈论使用objective-c在iphone上拨打电话，那么您可以执行以下操作：

```
NSURL *phoneNumber = [[NSURL alloc] initWithString: @"tel:867-5309"];
[[UIApplication sharedApplication] openURL: phoneNumber]; 
```

如果您正在谈论在 Mac 上执行此操作，那么就像其他人提到的那样，这取决于诸如如果您使用的是 voip、调制解调器、通过星号盒之类的东西进行连接等等。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-06-09T21:30:46.843

openURL 已弃用。

现在使用这个：

```
UIApplication *application = [UIApplication sharedApplication];
[application openURL:[NSURL URLWithString: @"tel:12125551212"] options:@{} completionHandler:nil]; 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-09-23T06:12:35.117

**删除电话号码中的空白**

```
NSString *phoneNumberString = @"123 456";
phoneNumberString = [phoneNumberString stringByReplacingOccurrencesOfString:@" " withString:@""];
phoneNumberString = [NSString stringWithFormat@"tel:%@", phoneNumberString];
NSURL *phoneNumberURL = [NSURL URLWithString:phoneNumberString]];
[[UIApplication sharedApplication] openURL:phoneNumberURL]; 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2015-05-26T11:45:56.623

```
NSString *phoneNumber = @"Phone number here";
UIWebView *webView = [[UIWebView alloc] init];
NSURL *url = [NSURL URLWithString:numberString];        
NSURLRequest *requestURL = [NSURLRequest requestWithURL:url]; 
webView.dataDetectorTypes = UIDataDetectorTypeNone;
[webView loadRequest:requestURL]; 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-03-20T11:48:21.617

这将是非常特定于平台的，或者您必须使用包装库来解释平台之间的差异，因此您最好说明它适用于哪个平台。通常，大多数平台上都有各种电话 API。

例如，在 Windows 系统上，有“TAPI”，如果您的目标是 ISDN 等数字电话系统，情况也可能有所不同，因为还有其他 API 可用。

# c# - 分配问题

> ID：665770
> 
> 赞同：0
> 
> 时间：2009-03-20T11:35:05.220
> 
> 标签：c#

ag = logss_EventAnalyzer.tabEventsString[0];

**ag**是一个静态字符串，

**logss_EventAnalyzer**是一个类，

**tabEventString**是一个静态字符串数组。

在调试过程中，我看到 logss_EventAnalyzer.tabEventsString[0] 包含一些字符串，但它没有分配给 ag。它的值为空。

这里有什么问题，解决方案是什么？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T11:42:57.167

你说“在调试期间”；*分配 ag 时是否*包含`logss_EventAnalyzer.tabEventsString[0]`（非空）字符串？

 *请注意，分配并不意味着对 的更改`tabEventsString[0]`将反映在 中`ag`，因为`string`它是不可变的，并且对 的任何更改`tabEventsString[0]`实际上都是在创建*新*字符串。如果你想要这种类型的行为，你需要使用某个类的成员：

```
public class Foo {
    public string Bar {get;set;}
}
static Foo ag;
static Foo[] tabEventsString;
...
ag = logss_EventAnalyzer.tabEventsString[0];
... 
```

现在`ag.Bar`将永远与`tabEventsString[0].Bar`

* * *

另外-您是否有一个名为的局部变量`ag`？这将优先。

您可以发布演示此问题发生的代码吗？

作为旁白; 请注意，如果您的应用程序变得复杂，则静态字段和数组都具有各种相关的复杂性……您可能需要考虑重构它们。

以下工作正常：

```
static class logss_EventAnalyzer {
    static string[] tabEventsString = {"abc","def","ghi"};
    static string ag;   
    static void Main() {
        ag = logss_EventAnalyzer.tabEventsString[0];
        System.Console.WriteLine(ag);
    }
} 
```

如果你正在做一些完全不同的事情，你将不得不给我们一个线索......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T11:42:42.660

当您在有问题的行上有一个断点时，是否`ag`会分配一个值？

我怀疑在代码的其他部分中，您`ag`无意中将其设置为 null，或者您`ag`之前分配的值可能`logss_EventAnalyzer.tabEventsString[0]`是非 null 值。

如果您提供更多详细信息，我可以给出更好的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T11:58:41.153

logss_EventAnalyzer.tabEventsString 的第一个条目包含一个分配给空值的字符串。您必须查看堆栈跟踪以查看将哪个对象添加为第一个条目。该对象可以分配为空。

# sharepoint - 具有 SharePoint 用户组的 Fba 角色

> ID：665779
> 
> 赞同：1
> 
> 时间：2009-03-20T11:39:20.750
> 
> 标签：sharepoint, moss, forms-authentication

我已经建立了自定义成员资格和角色提供程序。用户是属于公司的一些客户，我使用公司作为角色。

我想创建 SharePoint Group 并向其中添加更多公司（例如行业类型），然后由 SPGroup 进行重定向和安全性。

如何检索当前登录用户的 SPGroup？
我想在我的自定义登录页面中这样做，所以另一个问题是如何在知道登录名的情况下检索 SPUser 或 SPGroup ？

这就是我现在所拥有的：

```
 private List GetGroupsForUser(List roleAccounts)
{
    List groups = new List();
    SPSecurity.RunWithElevatedPrivileges(
     delegate()
     {
         using (SPSite site = new SPSite(SPContext.Current.Web.Site.ID))
         {
             SPUserCollection users = site.RootWeb.SiteUsers;
             foreach (string account in roleAccounts)
             {
                 SPGroupCollection accGroups = users[account].Groups;
                 foreach (SPGroup spg in groups)
                 {
                     groups.Add(spg);
                 }
             }
         }
     }
     );

    return groups;

}

private string GetRoleManagerName()
{
    foreach (KeyValuePair setting in SPContext.Current.Site.WebApplication.IisSettings)
    {
        if (string.IsNullOrEmpty(setting.Value.RoleManager) == false)
            return setting.Value.RoleManager.ToLower();
    }
    return null;
}

private List GetSpAccounts()
{
    List roleAccounts = new List();
    string roleProviderName = GetRoleManagerName();
    foreach (string role in Roles.GetRolesForUser(login.UserName))
    {
        roleAccounts.Add(roleProviderName + ":" + role.ToLower());
    }

    return roleAccounts;
}

// and now I can use it
List roleAccounts = GetSpAccounts();
List groups = GetGroupsForUser(roleAccounts); 
```

但是我有一种感觉，我不应该像这样手动执行此操作。如果只将角色添加到组中，目标受众将如何工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T12:48:25.480

~~Use the OwnedGroups property of the SPUser class to return the collection of groups owned by a user.~~

~~Update misunderstood the question:~~

~~*   Get the currently logged in user: SPContext.Current.Web.CurrentUser~~
2.  ~~Add that use to a group: SPGroup.Users.Add([username],[email],[name],[notes]);~~

Update, third times the charm. So you want to find out what group the user is in based on the roles they have? It's a bit of a combination of the above two attempts at answering it:

```
var matched = from r in SPContext.Current.Web.CurrentUser.Roles
              where r.Name = [Role]
              select r.Groups; 
```

Important note that the Roles property won't work in the next version of SharePoint! Personally I think SPContext.Current.Web.CurrentUser.Groups would be an easier way to figure out what groups the user is in, but it ignores your role requirementment.

# c++ - 从函数返回对象时调用C ++中的复制构造函数？

> ID：665781
> 
> 赞同：29
> 
> 时间：2009-03-20T11:41:34.753
> 
> 标签：c++, constructor, copy-constructor

我知道在三个实例上调用了复制构造函数

1.  当实例化一个对象并使用另一个对象的值对其进行初始化时。
2.  按值传递对象时。

**3\. 当一个对象按值从函数中返回时。**

如果在返回对象值时调用复制构造函数，我对 no.3 有疑问，如果在函数中本地声明对象，它是否会产生问题。

我的意思是复制构造函数是一个深拷贝，并将对象的引用作为参数

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-20T11:43:15.187

正是为了避免问题而调用它。作为结果的新对象从本地定义的对象中初始化，然后本地定义的对象被销毁。

在深拷贝用户定义的构造函数的情况下，它都是一样的。首先为将作为结果的对象分配存储空间，然后调用复制构造函数。它使用传递的引用来访问本地定义的对象并将所需的内容复制到新对象。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-03-20T11:44:12.593

复制在被调用函数退出之前完成，并将当时存在的局部变量复制到返回值中。

被调用的函数可以访问返回值将占用的内存，即使在复制时该内存不在“范围内”，它仍然可用。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-03-20T12:24:05.320

根据对我的问题[的回答](https://stackoverflow.com/questions/665825/copy-constructor-vs-return-value-optimization/665854#665854)，复制构造函数甚至*可能被调用*两次：一次将本地对象复制到返回“对象”上，一次将返回对象复制到分配给它的变量上。

不过，*大可不必*！编译器可以优化这两种复制结构。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T11:42:39.447

不，它会在当地人被摧毁之前调用它。您可以使用记录破坏和复制构造的对象或查看生成的汇编代码来测试它。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-22T08:01:03.487

调用复制构造函数的一般情况有以下三种：

1.  当实例化一个对象并使用来自另一个对象（相同类型）的值对其进行初始化时。
2.  按值传递对象时。
3.  当对象按值从函数返回时。

# javascript - 如何在 Firefox 插件中使用 jQuery？

> ID：665785
> 
> 赞同：2
> 
> 时间：2009-03-20T11:42:36.933
> 
> 标签：javascript, jquery, firefox, plugins

我正在尝试创建一个 Firefox 插件，并且我想使用一些 jQuery 函数。如何包含所需的 jQuery 库？将库包含到插件本身的某种方式？

当用户单击注入页面的链接时，我需要在各种网站上显示一个 jQuery Dialog 类型的窗口。

谢谢您的回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T12:05:21.387

在您的`overlay.xul`文件中，就像包含任何其他 Javascript 文件一样包含它：

```
<script type="application/x-javascript" src="chrome://my-firefox-extension/content/path/to/jquery.js" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T12:38:34.397

我建议使用 chrome 对话框而不是 jQuery。我写了一个类似的扩展，虽然我没有使用jQuery，而是我自己编写的对话框代码。问题是，当您在某个随机页面中注入 html 对话框时，在许多情况下，由于与加载的站点 CSS 发生不可预测的冲突，它会失真。即使使用内联样式和所有其他技巧。

最后，我查看了谷歌笔记本扩展是如何实现的，并使用了相同的想法。效果很好。

# security - 使用解决方案框架在 Sharepoint 中部署 CAS 策略

> ID：665792
> 
> 赞同：1
> 
> 时间：2009-03-20T11:43:56.573
> 
> 标签：security, sharepoint, manifest, solution, code-access-security

我正在使用共享点解决方案机制部署我的 Web 部件。Untul 现在，一切正常，但是当我将 CAS 策略添加到 manifest.xml 文件时，部署无法正常工作。使用 CAS 策略部署解决方案时，没有错误，但没有创建策略文件，没有复制 dll，也没有将 SafeControls 条目添加到 web.config。我的 manifest.xml 文件如下所示：

```
<Solution SolutionId="{8099F953-02F2-49e1-B620-06B9050515A3}"
          xmlns="http://schemas.microsoft.com/sharepoint/">

  <FeatureManifests>
    <FeatureManifest Location="Przydzialy\feature.xml" />
  </FeatureManifests>

  <TemplateFiles>
    <TemplateFile Location="FEATURES\Przydzialy\AjaxWebPart.dwp" />
    <TemplateFile Location="FEATURES\Przydzialy\UserControlContainer.dwp" />
  </TemplateFiles>

  <Assemblies>
    <Assembly DeploymentTarget="WebApplication" Location="Package.WebParts.dll">
      <SafeControls>
        <SafeControl Assembly="Package.WebParts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9a8b1f3d028b8494" Namespace="Package.WebParts" TypeName="UserControlContainer" Safe="True" />
        <SafeControl Assembly="Package.WebParts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9a8b1f3d028b8494" Namespace="Package.WebParts" TypeName="AjaxWebPart" Safe="True" />
        <SafeControl Assembly="Package.WebParts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9a8b1f3d028b8494" Namespace="Package.WebParts" TypeName="ProgressTemplate" Safe="True" />
        <SafeControl Assembly="Package.WebParts, Version=1.0.0.0, Culture=neutral, PublicKeyToken=9a8b1f3d028b8494" Namespace="Package.WebParts.SmartWebPart" TypeName="UserControlContainerToolPart" Safe="True" />
      </SafeControls>
    </Assembly>
  </Assemblies>

  <CodeAccessSecurity>
    <PolicyItem>
      <PermissionSet class="NamedPermissionSet" version="1" Description="Permission set for Package.WebParts">
        <IPermission class="AspNetHostingPermission" version="1" Level="Medium" />
      </PermissionSet>
      <Assemblies>
        <Assembly Name="Package.WebParts" />
      </Assemblies>
    </PolicyItem>
  </CodeAccessSecurity>

</Solution> 
```

以前有人遇到过这样的问题吗？在这一点上我已经没有想法了，所以我愿意接受建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T19:30:21.863

检查您的 web.config 并确保信任级别未设置为完整。如果您尚未部署任何 CAS 策略，则应将其设置为 WSS_Minimal；如果您已经部署了某些内容，则应将其设置为 WSS_Custom。确保您的解决方案包中没有任何只读文件，因为这会导致问题。

最后，您是通过 Central Admin 还是 stsadm 部署解决方案？如果您通过 stsadm 进行部署，请转到中央管理员并查看部署解决方案时是否显示任何错误。

您很可能还需要更多的权限集，请查看我的帖子，了解更多关于[代码访问安全](http://www.dotnetmafia.com/Home/tabid/37/EntryID/90/Default.aspx)的信息。

# firefox - 更快地显示 Firefox 选项卡工具提示

> ID：665795
> 
> 赞同：6
> 
> 时间：2009-03-20T11:44:36.180
> 
> 标签：firefox, tabs, firefox-addon

如何使选项卡的提示/天桥显示得更快？有太多的反应时间，需要很长时间才能浏览其中的许多内容。

大多数时候，我在 Firefox 中打开了 100 个标签（我正在使用标签混合加插件 - “tmp”）。

要查看不同浏览器窗口中的内容，我不会激活它们，而是将鼠标移到选项卡上。

几毫秒后出现一个工具提示/浮标（鼠标指针上的一个小框绘制在下面的所有内容之上），它包含来自属于该选项卡的网页标题的信息。但是在显示之前会有几毫秒的暂停。

如果没有特定的 about:config 变量，我也会对如何更改 firefox 代码感兴趣（因为我假设这不是 tmp 内置的，我在选项中没有找到它）

我不使用 tmp 功能“通过指向 xxx ms 后选择选项卡”，这可能会干扰。

谢谢你

卡尔

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-14T19:42:35.290

它可能不像其他一些人声称的那样真正是一个系统范围的问题。对于我的网站，我注意到 Firefox 中的工具提示延迟远高于 Chrome。所以我研究了一下，幸运的是它很容易修复。

只需在 Firefox 中打开 about:config，然后右键单击，新建-> 整数值。将此名称赋予首选项： **ui.tooltipDelay**

给它你喜欢的值，我刚刚将它设置为 100，现在效果很好（它们的默认值为 500）。

来源：[https ://developer.mozilla.org/en-US/docs/Mozilla/Preferences/Preference_reference/ui.tooltipDelay](https://developer.mozilla.org/en-US/docs/Mozilla/Preferences/Preference_reference/ui.tooltipDelay)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T12:02:25.357

工具提示延迟变量不在 Firefox 的 about:config 中，因为它是系统范围的变量。如果您使用的是 OS X，您可以在终端中使用以下命令对其进行更改：

```
// make the change global (applies to all apps)
defaults write -g NSInitialToolTipDelay -int 500 

// just for firefox
defaults write org.mozilla.firefox NSInitialToolTipDelay -int 500 
```

我不知道如何在windows下做到这一点。（也许是注册表项或其他东西

编辑：我刚找到[这个](http://www.microsoft.com/windowsxp/Downloads/powertoys/Xppowertoys.mspx)/[维基百科](http://en.wikipedia.org/wiki/TweakUI)。也许你可以试一试？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T21:05:46.180

我相信Microsoft PowerToys 的[Tweak UI](http://www.microsoft.com/windowsxp/Downloads/powertoys/Xppowertoys.mspx)具有在 Windows 上更改此设置的设置。在页面右侧大约一半的地方寻找下载。

# apache - LocationMatch 和 DAV svn

> ID：665799
> 
> 赞同：2
> 
> 时间：2009-03-20T11:45:46.490
> 
> 标签：apache, svn, apache2, webdav, mod-dav-svn

我正在尝试通过多个 URL 访问我们的 Subversion 存储库。为此，我正在考虑使用 LocationMatch 指令。我的配置是：

```
<Location ~ "/(svn|repository)">
  DAV svn
  SVNPath /opt/svn
  AuthzSVNAccessFile /etc/subversion/access
</Location> 
```

上述配置不起作用。奇怪的是，如果我使用例如这个配置，它适用于两个 URL：

```
<Location ~ "/(svn|repository)">
  SetHandler server-status
</Location> 
```

对我来说，看起来 DAV svn 和 LocationMatch 的组合并没有真正起作用，还是我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-03-01T20:50:10.247

我也遇到了问题，因为我想使用正则表达式来避免其他子路径被我的匹配捕获。

例如

```
<LocationMatch "^/test/.*$> 
```

不一样

```
<Location "/test"> 
```

与后者一样，[http://site.com/newproduct/test](http://site.com/newproduct/test)会被最后一个捕获，但不会被第一个捕获。[http://site.com/test/scripts](http://site.com/test/scripts)也是如此。这就是 LocationMatch 存在的原因，但是每当我输入正则表达式时它都会失败。如果我使用 LocationMatch 没有任何正则表达式，它似乎可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-02T13:56:15.367

问题似乎是，当您在`Location`or`LocationMatch`部分中使用正则表达式时，Apache 服务器正在使用正则表达式的内容重写请求中的一些元数据（可能是为了让接受此请求的处理程序将其作为正则表达式的目标）表达）。

当 dav_svn 处理程序收到请求时，它会查阅此元数据以解析获取所请求资源所需的路径。因为正则表达式不是真正的路径，所以会出现如下错误：

```
svn: PROPFIND of '%5E/(svn%7Crepository)/!svn/vcc/default': Could not parse response status line 
```

我对此没有任何修复，除了不使用带有 dav_svn 的正则表达式：在我的情况下，我想使用 XSLT 格式化程序在使用 Web 浏览器访问 subversion 存储库时为它显示一个漂亮的 UI，并且 XSL 资源是应该在托管颠覆存储库的同一主机名上的不同路径上访问，所以我想使用正则表达式`Location`来使 XSL 资源的路径不会命中 dav_svn 处理程序。这是一个失败，所以我只是在不同的主机名上部署了 websvn，就是这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-20T13:03:19.440

快速有效的解决方案：只需添加您对每个虚拟主机的引用，您想让 svn repro 可访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-04T16:55:48.183

客户端是否收到错误，HTTP 错误日志中是否有错误？

将多个位置映射到单个 SVN 存储库时，SVN 可能会感到困惑。请参阅[http://subversion.apache.org/faq.html#http-301-error](http://subversion.apache.org/faq.html#http-301-error)。我现在正在解决另一个问题。

如果删除正则表达式是否有效？我会假设是的，但我想验证一下。

```
<Location "/svn"> 
```

# php - 存储上传文件的直接位置

> ID：665800
> 
> 赞同：1
> 
> 时间：2009-03-20T11:46:02.167
> 
> 标签：php, web-applications

当我上传一个文件时，该文件在网络服务器上的直接位置是什么？反正有配置这个地方吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-20T11:55:18.027

如果是 PHP，它们会转到[`upload_tmp_dir`](http://www.php.net/manual/en/ini.core.php#ini.upload-tmp-dir)系统默认值（通常是 /tmp）。

见[http://www.php.net/manual/en/features.file-upload.post-method.php](http://www.php.net/manual/en/features.file-upload.post-method.php)

# javascript - 不错的 JavaScript IDE

> ID：665810
> 
> 赞同：10
> 
> 时间：2009-03-20T11:48:15.203
> 
> 标签：javascript, ide, rhino

什么是用于开发 JavaScript 的体面的 IDE，我将编写客户端的东西并为 Rhino 编写。理想情况下，它需要在 Mac OSX 上运行，尽管在 Windows 上运行的东西也很好。

**额外的：**

在玩过 js2 和 Aptana 之后，我想我会继续使用 Aptana。主要是因为我发现 emacs 有点难以理解，尽管我确实认为 js2 中的错误高亮比 Aptana 中的要好。

我仍在寻找一种方法来直观地调试我在 Rhino 上运行的 js 代码......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-20T12:04:30.970

绝对是 Aptana IDE。对所有主要 javascript 库、非常好的 css 和 html 编辑器的稳定、出色的语法支持。对 php、air、ruby on rails 和 iPhone 应用程序开发也有很好的支持（我从未测试过这个）。Aptana 还可以通过 ftp（专业版中的 sftp）和 svn 和 cvs 存储库连接到远程站点。它基于 Eclipse，因此它并不是一个轻量级应用程序。但这真的，真的很好。如果你开发 java wab 应用程序，你也可以将它用作 Eclipse 插件，但是当我在这个版本中测试它时，大约 1 年前，它并不稳定。使用独立版本要好得多。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-20T12:13:34.490

如果您熟悉 Emacs，Steve Yegge 的[`js2-mode`](http://code.google.com/p/js2-mode/)可能值得一看。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-20T11:52:52.493

Aptana Studio，独立版本和 Eclipse 插件版本在我上次使用时都很好。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-03-20T11:50:12.190

我发现[Spket Eclipse 插件](http://spket.com/)非常有用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-06-11T13:23:03.123

看看[WebStorm HTML/JavaScript Editor](http://www.jetbrains.com/webstorm/)。它是轻量级的，可在 MacOS 上运行。它支持直接从 IDE 调试和运行您的代码，并且具有非常智能的基于 DOM 和基于浏览器的 JavaScript 的自动完成功能。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-20T12:06:13.117

[Komodo Edit/IDE](http://www.activestate.com/komodo_edit/)绝对是用于开发 JavaScript 的最佳 IDE/编辑器（我用过的）。

值得注意的功能包括所有主要框架的实时错误报告、JavaScript 宏和语法自动完成！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-20T12:31:56.877

如果您有一个用 Javascript 编写的非常大的应用程序，那么只有 IntelliJ Idea。它解析多个 Javascript 文件，不仅突出语法错误，还突出显示未声明的变量和函数，允许从函数调用跳转到函数定义等等。

我已经尝试过 Emacs（因为那是我最喜欢的编辑器）和 Komodo，但它们并没有接近。我想这对 Eclipse 来说是一样的。

就我个人而言，我认为只有在处理糟糕的无文档代码时才需要 Idea 的卓越解析和导航能力，否则我很乐意使用 js2 模式在 Emacs 中编写代码，但我正在处理大量文档不足和错误的框架，并且能够跳转到函数或超类的源代码以检查它们的工作方式确实很有帮助。

# sql-server - 微软报告服务器

> ID：665816
> 
> 赞同：0
> 
> 时间：2009-03-20T11:51:49.797
> 
> 标签：sql-server, reporting-services, reporting

我想从头开始学习有关报告服务器的所有内容，您能告诉我所需的实际步骤吗，，，是否有任何视频教程可以学习

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T11:53:54.083

如果您在谈论 SSRS，我会从这里开始[http://www.microsoft.com/Sqlserver/2005/en/us/reporting-services.aspx](http://www.microsoft.com/Sqlserver/2005/en/us/reporting-services.aspx)

[Professional SQLServer Reporting Services](https://rads.stackoverflow.com/amzn/click/com/0764568787)是一本让我前进的好书。

本质上，SSRS 是以 xml 格式 (.rdl) 表示的 SQL 数据驱动报告。它们托管在 Web 报表服务器上并在其上运行。除了在 html 中呈现之外，您还可以在 excel、pdf、tiff 等中开箱即用地呈现它们。

[这里](http://www.youtube.com/watch?v=aafHygddNqc)有一个介绍视频

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T11:54:52.350

这是我使用的参考：[http](https://rads.stackoverflow.com/amzn/click/com/0072262397) ://www.amazon.com/Microsoft-Server-2005-Reporting-Services/dp/0072262397/ref=pd_bbs_sr_1?ie=UTF8&s=books&qid=1237550043&sr=8-1 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-23T16:45:12.267

DNR TV 上有几个截屏视频。我发现它们对于入门非常有用。他们在

[http://www.dnrtv.com/default.aspx?showNum=26](http://www.dnrtv.com/default.aspx?showNum=26)

[http://www.dnrtv.com/default.aspx?showNum=27](http://www.dnrtv.com/default.aspx?showNum=27)

[http://www.dnrtv.com/default.aspx?showNum=28](http://www.dnrtv.com/default.aspx?showNum=28)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T11:04:09.067

关于该主题的最佳书籍是“sql server 报告服务 2000 搭便车指南”

虽然这看起来是针对旧版本的产品，但你要记住的是，RS 不是随 SQL 2000 发布的，而是在几个月后出现在 SQL 2005 之前，在 SQL2K Sp2 中仓促发布的，所以产品差异是次要的

这将作为一个良好的基础

[http://www.amazon.co.uk/Hitchhikers-Reporting-Services-Microsoft-Windows/dp/0321268288](http://www.amazon.co.uk/Hitchhikers-Reporting-Services-Microsoft-Windows/dp/0321268288)

# java - 将Java小程序项目导入netbeans不起作用，Netbeans即使手动设置也拒绝识别甚至找不到主类

> ID：665820
> 
> 赞同：1
> 
> 时间：2009-03-20T11:53:05.210
> 
> 标签：java, class, ide, netbeans, main

我正在尝试将 netbeans 中的主类设置为它在它所在的最后一个环境中的主类，但是程序坚持它找不到主类本身，并且当我将它设置为主类的名称时项目属性中的类它说该类不存在（即使它存在）。

当我用主类右键单击源文件并点击“运行[文件]”时，它可以工作（尽管与资产相关的错误我可以稍后修复，但与代码本身无关。

我现在所做的只是将代码从上一个项目复制并粘贴到 netbeans 中，所以我会在这里忽略任何东西吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-20T12:44:12.323

小程序在 Netbeans 中的工作方式让我很烦。帮助中的建议用法是按照您的指示运行小程序（运行文件）。NetBeans 将在引用小程序的 build/classes 下生成一个 HTML 文件。然后，您将 HTML 文件复制到您的类所在的 src 中。然后，您可以调整 HTML，在随后的运行中，NetBeans 将使用您的 HTML 文件而不是生成它。每次运行该文件时，NetBeans 都会打开 Java 附带的 applet 查看器程序。您无法控制传递给小程序查看器的任何参数。它会忽略您在项目中配置的运行时参数。要更改传递给小程序的参数，您必须手动编辑 HTML 文件。

更好的方法是使用在 BlueJ 项目中创建的 AppletWindow 类。它允许您在 JFrame 上托管一个小程序，这意味着您可以制作一个小型的独立 Swing 应用程序来调用您的小程序。然后程序有一个 main 方法，您可以启动一个带有按钮和文本控件的额外 Swing 窗口来模拟对小程序的 javascript 调用，您可以调整在运行时传递给小程序的属性。在您的代码中尝试新事物非常好。

链接：

*   [AppletWindow 下载](http://www.bluej.org/resources/classes/appletwn.jar)：此 jar 包含已编译的 .class 文件和源代码。
*   [有关 BlueJ 和其他资源的更多信息](http://www.bluej.org/resources/classes.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T12:03:00.130

你真的在谈论小程序吗？Applet 没有主类（可以，但不是必须的）。因此，您可能可以选择在 Netbeans 中将项目导入为 applet-project，而不是作为standalone-java-app。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-06T13:28:36.603

Shift + F6 在 NetBeans 7.3.1 中为我工作

我编辑以首先允许 webstart 在属性中。

我使用来自 Schiltds 的单个小程序完整的 Java 第 7 版第 626 页简单的横幅小程序。

我很高兴回馈一点。

# c++ - 复制构造函数与返回值优化

> ID：665825
> 
> 赞同：7
> 
> 时间：2009-03-20T11:54:08.280
> 
> 标签：c++, copy-constructor, return-value-optimization

在[上一个问题](https://stackoverflow.com/questions/665781/copy-constructor-in-c-is-called-when-object-is-returned-from-a-function)中，一个普通的按值返回函数似乎总是将其`return`参数复制到从它分配的变量中。

这是标准要求的，还是可以通过在函数体内构造“分配给”变量来优化函数？

```
struct C { int i; double d; };

C f( int i, int d ) {
    return C(i,d); // construct _and_ copy-construct?
}

int main() {
    C c = f( 1, 2 ); 
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-20T12:02:50.753

该标准允许在此处进行任何级别的复制遗漏：

*   构造一个本地临时，将其复制构造为返回值，并将返回值复制构造到本地“c”中。**或者**
*   构造一个本地临时文件，并将其复制构造到“c”中。**或者**
*   用参数“i,d”构造“c”

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-20T12:02:46.853

该标准说不需要使用复制构造函数 - 请参阅第 12.8/15 节：

> 15 每当使用复制构造函数复制临时类对象，并且该对象和副本具有相同的 cv 非限定类型时，允许实现将原始类对象和副本视为引用同一对象的两种不同方式，而不是完全执行复制，即使类复制构造函数或析构函数有副作用。

还有更多类似的情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T12:40:45.767

方式不通过引用传递参数并将结果分配给它？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-03-20T12:04:07.927

有一种非常简单且很好的方法可以完全避免此类考虑 - 您可以考虑将 boost::shared_ptr 返回到创建的对象 - 在可用性方面它实际上是相同的，但您的对象肯定不会被不必要地复制 - 而且它如果您通过几层函数调用返回它，这也是正确的。

# sql - Access SQL 多对多查询

> ID：665830
> 
> 赞同：1
> 
> 时间：2009-03-20T11:55:36.247
> 
> 标签：sql, ms-access, ms-access-2007

我有三张桌子：

```
Author(AID, Name)
Title(TID, Name)
AuthorOfTitle(ID, AID, TID) 
```

我的问题是我如何才能只看到没有标题的作者，即在 AuthorOfTitle 中没有记录的作者。如何在 SQL 中执行此操作。顺便说一句，我正在使用 MS Access 2007。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T11:59:57.890

这应该这样做：

```
SELECT A.*
FROM Author A LEFT JOIN AuthorOfTitle T ON A.AID = T.AID
WHERE T.ID IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T12:01:15.330

您可以使用`foo not in (select ... from bar)`SQL 子查询表达式来执行此操作。

```
SELECT AID, Name FROM Author 
WHERE Author.AID NOT IN (SELECT AuthorOfTitle.AID FROM AuthorOfTitle) 
```

# symfony1 - symfony：更改应用程序目录

> ID：665842
> 
> 赞同：0
> 
> 时间：2009-03-20T12:00:44.910
> 
> 标签：symfony1

我有序号 symfony 项目，其中包括 2 个应用程序：公共和管理部分。我需要将管理应用程序文件移动到 project_path/web/admin。因此，如果我调用 www.project.com/admin，将显示管理项目。我应该如何配置项目以允许这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-23T20:52:11.940

将应用程序移动到文档根目录会造成安全漏洞，因为如果您不以任何方式保护它们，任何人都可以访问您的所有应用程序文件。如果你不喜欢默认的 symfony 项目设置，它只对单个应用程序使用 url 重写（通常是公共应用程序）并且希望在其他应用程序中也有“干净的 url”，你可以为它们创建子域并设置“no_script_name "settings.yml 中的参数设置为 "on"。例如，通过这种方式，您可以拥有像[http://myap.domain.com/nice/url/here](http://myap.domain.com/nice/url/here)这样的网址。在您的情况下，公共应用程序可能位于 domain.com 上，而管理应用程序位于 admin.domain.com 上。当然，您必须相应地配置您的 Apache 虚拟主机——这不是 symfony 开箱即用为您做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-23T21:28:49.653

绝对不要将您的文件移动到 web/admin

您的问题的解决方案很可能在 project_path/apps/frontend/config/routing.yml 中找到

我之前也遇到过类似的问题。我创建了一个前端模块并将其命名为“admin”，然后在其中放入链接到 myproject/backend.php/table 等的链接......

您可以使用路由文件使 www.project.com/admin 工作

要了解更多信息：[http ://www.symfony-project.org/book/1_2/09-Links-and-the-Routing-System](http://www.symfony-project.org/book/1_2/09-Links-and-the-Routing-System)

记得在你的 http.conf 中启用 module_rewrite

# python - 关于 python 网络“管道”的最佳持续更新资源

> ID：665848
> 
> 赞同：3
> 
> 时间：2009-03-20T12:02:10.583
> 
> 标签：python, wsgi, flup

我是一名 Python 程序员，从事 Web 应用程序。我对应用程序级别有所了解。但我发现自己必须配置或调试的底层“管道”并没有那么多。

我正在考虑从使用 memcached 到 Flup、fcgi、WSGI 等的一切。

在在线查找有关这些信息时，Google 通常会提供较旧的文档（例如 2007 年之前的教程）、可能已解决或未解决的问题片段等。

是否有任何好的综合和最新资源来学习如何组装现代、高性能的服务器？一个解释架构原理和实际包的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T12:35:27.323

*   General info about highly efficient web architecture: [http://highscalability.com/](http://highscalability.com/)
*   Interesting Python related articles: [http://www.onlamp.com/python/](http://www.onlamp.com/python/)
*   Printed magazine: [http://pythonmagazine.com/](http://pythonmagazine.com/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T12:05:30.063

买这个。 [http://www.amazon.com/Scalable-Internet-Architectures-Developers-Library/dp/067232699X](https://rads.stackoverflow.com/amzn/click/com/067232699X)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T12:33:53.160

*Zope* is a still evolving framework, written in *Python* and is documented online. For a start, see [Zope Concepts and Architecture](http://docs.zope.org/zope2/zope2book/source/ZopeArchitecture.html). Like other *Python* based web frameworks, the [source](http://www.zope.org/DevHome/Subversion/FrontPage) is your best reference.

Note that *Zope* is not easy to grasp, and is different from frameworks like *Django*.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T18:10:45.177

您可以使用此术语将搜索结果限制为过去一年：

[http://www.tech-recipes.com/rx/2860/google_how_to_access_filter_by_date_dropdown_box/](http://www.tech-recipes.com/rx/2860/google_how_to_access_filter_by_date_dropdown_box/)

# java - 深度克隆实用程序推荐

> ID：665860
> 
> 赞同：76
> 
> 时间：2009-03-20T12:03:41.110
> 
> 标签：java, clone

是否有任何用于深度克隆 java 集合的实用程序：

*   数组
*   列表
*   地图

注意：更喜欢一些不使用序列化但使用 Object.clone() 方法的解决方案。我可以确定我的自定义对象将实现 clone() 方法，并且将仅使用可克隆的 java 标准类...

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-08-06T20:07:50.177

**我认为以前的绿色答案很糟糕**，您为什么会问？

*   它添加了很多代码
*   它要求您列出要复制的所有字段并执行此操作
*   使用 clone() 时，这对列表不起作用（这就是 HashMap 的 clone() 所说：返回此 HashMap 实例的浅表副本：键和值本身没有被克隆。）所以你最终手动完成（这使得我哭了）

哦，顺便说一句，序列化也很糟糕，你可能不得不到处添加 Serializable （这也让我哭了）。

**那么解决方案是什么：**

Java 深度克隆库 *克隆库*是一个小型的开源（apache 许可证）Java 库，它可以深度克隆对象。对象不必实现 Cloneable 接口。实际上，这个库可以克隆任何 java 对象。如果您不希望修改缓存的对象或想要创建对象的深层副本，则可以在缓存实现中使用它。

```
Cloner cloner=new Cloner();
XX clone = cloner.deepClone(someObjectOfTypeXX); 
```

[在https://github.com/kostaskougios/cloning](https://github.com/kostaskougios/cloning)上查看

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-03-20T13:52:16.887

在 Java 中复制对象的所有方法都有严重的缺陷：

**克隆**

1.  clone() 方法是受保护的，因此您不能直接调用它，除非相关类使用公共方法覆盖它。
2.  clone() 不调用构造函数。任何构造函数。它将分配内存，分配内部`class`字段（您可以通过 读取`getClass()`）并复制原始字段。

有关 clone() 的更多问题，请参阅 Joshua Bloch 的书“ [Effective Java, Second Edition](https://rads.stackoverflow.com/amzn/click/com/0321356683) ”的第 11 项

**连载**

序列化更糟糕；它有许多缺陷，`clone()`然后是一些缺陷。Joshua 有一个完整的章节，仅此主题就有四个项目。

**我的解决方案**

我的解决方案是为我的项目添加一个新界面：

```
public interface Copyable<T> {
    T copy ();
    T createForCopy ();
    void copyTo (T dest);
} 
```

代码如下所示：

```
class Demo implements Copyable<Demo> {
    public Demo copy () {
        Demo copy = createForCopy ();
        copyTo (copy);
        return copy;
    }
    public Demo createForCopy () {
        return new Demo ();
    }
    public void copyTo (Demo dest)
        super.copyTo (dest);
        ...copy fields of Demo here...
    }
} 
```

不幸的是，我必须将此代码复制到我的所有对象中，但它始终是相同的代码，因此我可以使用 Eclipse 编辑器模板。好处：

1.  我可以决定调用哪个构造函数以及如何初始化哪个字段。
2.  初始化以确定的顺序发生（根类到实例类）
3.  我可以重用现有对象并覆盖它们
4.  键入安全
5.  单身人士保持单身人士

对于标准 Java 类型（如集合等），我使用可以复制它们的实用程序类。这些方法有标志和回调，所以我可以控制副本的深度。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-08-06T20:59:46.780

对集合进行浅克隆很容易，但如果您想进行深度克隆，库可能比手动编码更好（因为您也想克隆集合中的元素*）*。

就像[这个答案](https://stackoverflow.com/a/1241100/152061)一样，我使用了[Cloner 库](https://github.com/kostaskougios/cloning)，并专门针对 XStream（它可以通过序列化然后反序列化来“克隆”）和二进制序列化对其进行了性能测试。虽然 XStream 在序列化到/从 xml 方面非常快，但 Cloner 在克隆方面要快得多：

0.0851 毫秒：xstream（通过序列化/反序列化克隆）
0.0223 毫秒：二进制序列化（通过序列化/反序列化克隆）
0.0017 毫秒：克隆器
**克隆一个简单对象（两个字段）的平均时间，并且没有默认的公共构造函数。运行 10,000 次。*

除了速度快之外，还有更多选择克隆器的理由：

1.  执行任何对象的深度克隆（即使是您自己不编写的对象）
2.  您不必在每次添加字段时都保持您的 clone() 方法是最新的
3.  您可以克隆没有默认公共构造函数的对象
4.  与春天一起工作
5.  （优化）不会克隆已知的不可变对象（如 Integer、String 等）
6.  便于使用。例子：

    cloner.deepClone(anyObject);

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2009-10-27T22:48:13.030

我是 Brad 提出的克隆器库的创建者。这是一种无需编写任何额外代码即可克隆对象的解决方案（无需可序列化对象或 impl clone() 方法）

正如布拉德所说，它非常快，最近我上传了一个更快的版本。请注意，手动实现 clone() 方法将比克隆 lib 更快，但是您需要再次编写大量代码。

Cloner lib 对我来说工作得很好，因为我在一个流量非常大的站点（每天大约 100 万个请求）的缓存实现中使用它。每个请求缓存应该克隆大约 10 个对象。它非常可靠和稳定。但请注意，克隆并非没有风险。该库可以配置为打印它在开发期间克隆的每个类实例。通过这种方式，您可以检查它是否克隆了您认为应该克隆的内容 - 对象图可能非常深，并且可能包含对大量对象的引用。使用克隆库，您可以指示它不要克隆您不想要的对象，即单例。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-03-20T12:09:29.477

**深度克隆任意集合的一种通用方法是将其序列化为流，然后将其读回新集合中。**您将补充与旧对象没有任何关系的全新对象，而不是相同的副本。

查看**Bruno 的答案以获取**[**Apache Commons 序列化实用程序类**](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/SerializationUtils.html)的链接，如果这是您决定采用的路线，这将非常有帮助。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-03-20T12:10:01.893

一种可能性是使用**序列化**：

Apache Commons 提供[SerializationUtils](https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/SerializationUtils.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-04-09T19:28:01.040

我使用过这个[克隆](http://code.google.com/p/cloning/)库，发现它非常有用。由于它有一些限制（我需要对克隆过程进行更细粒度的控制：应该克隆哪个字段、在什么上下文中以及克隆的深度等），我创建了它的扩展版本。您可以通过在实体类中注释字段来控制字段的克隆。

只是为了了解它，这里是一个示例类：

```
public class CloneMePlease {
    @Clone(Skip.class)
    String id3 = UUID.randomUUID().toString();

    @Clone(Null.class)
    String id4 = UUID.randomUUID().toString();

    @Clone(value = RandomUUID.class, groups=CustomActivationGroup1.class)
    String id5 = UUID.randomUUID().toString();

    @Clone.List({
            @Clone(groups=CustomActivationGroup2.class, value=Skip.class),
            @Clone(groups=CustomActivationGroup3.class, value=Copy.class)})
    Object activationGroupOrderTest = new Object();

    @Clone(LongIncrement.class)
    long version = 1l;

    @PostClone
    private void postClone(CloneMePlease original, @CloneInject CloneInjectedService service){
         //do stuff with the original source object in the context of the cloned object
         //you can inject whatewer service you want, from spring/guice to perform custom logic here
    }
} 
```

更多细节在这里： [https ://github.com/mnorbi/fluidity-cloning](https://github.com/mnorbi/fluidity-cloning)

如果需要，还有一个特定于休眠的扩展。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-20T12:11:32.793

使用序列化然后反序列化，但请注意，此方法仅适用于没有瞬态字段的 Serializable 类。此外，您的单身人士将不再是单身人士。

# linux - 我在哪里可以获得 Psiphon 源代码以及如何在 CentOS 5 上编译它？

> ID：665872
> 
> 赞同：3
> 
> 时间：2009-03-20T12:07:14.597
> 
> 标签：linux

不管我用多少谷歌搜索，我似乎都找不到赛风源代码（psiphon.ca 上的下载页面给了我一个“404”）。此外，似乎不存在 linux 安装说明。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T04:29:15.337

在[psiphon3.com](http://psiphon3.com)他们告诉它的来源在[这里](https://bitbucket.org/psiphon/psiphon-circumvention-system/overview)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T12:24:23.620

它是开源的，可通过 BitBucket 在项目页面上获得

[https://bitbucket.org/psiphon/psiphon-circumvention-system](https://bitbucket.org/psiphon/psiphon-circumvention-system)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T12:23:33.170

我能想到的最好的办法就是在此处发布您的问题：

[http://psiphon.civisec.org/forum/index.php](http://psiphon.civisec.org/forum/index.php)

编辑：

看起来这个链接也有效：

[http://psiphon.ca/download.php](http://psiphon.ca/download.php)

# eclipse - JSF 验证未找到自定义 ResourceBundle 类

> ID：665873
> 
> 赞同：6
> 
> 时间：2009-03-20T12:07:25.113
> 
> 标签：eclipse, jsf, resourcebundle

我有一个自定义的 ResourceBundle 类 org.example.web.UILabels.java，它**在运行代码时运行良好，**但 Eclipse 中的 JSF 编辑器没有找到它，我假设编辑器/验证器只是按名称查找属性文件。这也意味着我不再能够提前找到非常好的资源。

有什么想法可以纠正吗？

```
<f:loadBundle basename="org.example.web.UILabels" var="uiLabels"/>
...
<h:outputText value="#{uiLabels.someTextValue}" />
... 
```

我收到错误消息（在问题错误列表中）

在类路径中找不到资源包 org.example.web.UILabels

类型=JSF 问题

带有 WebStandardTools 版本的 Eclipse3.4.0

*   版本：1.4.0.v200802280619-13-7w311917141518
*   版本：1.5.1.v200802280619-1407w311917141519
*   版本：3.0.0.v200806092130-7A-8Y8QqN2lf4VSWrI2ek5Pf4k7s

有关我为什么使用 ResourceBundle 类而不仅仅是属性文件的更多信息，请参阅[问题 653682 how-to-override-some-resources-from-a-propertyresourcebundle](https://stackoverflow.com/questions/653682/how-to-override-some-resources-from-a-propertyresourcebundle)

谢谢你的时间，大卫沃特斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T12:16:40.067

resource-bundle 元素比 f:loadBundle 操作更有效，因为可以为整个应用程序创建一次包。然而它是一个 JSF 1.2 特性，如果你想与 JSF 1.1 兼容，你必须使用 JSF 1.1。如果您使用 JSF 1.2，这是一个示例：在 faces-config.xml 中定义它，如下所示：

```
<application>
<resource-bundle>
<base-name>org.example.web.UILabels</basename>
<var>uiLabels</var>
</resource-bundle>
</application> 
```

很抱歉没有回答您的问题，但我没有 Eclipse 的第一手经验。我也首先误解了你的问题，因此我编辑了我的原始答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-23T09:42:27.440

我遇到了同样的问题，我终于找到了这个解决方案：Eclipse 只搜索默认属性，您的项目必须有一个没有语言环境的属性，例如：

```
<f:loadBundle basename="i18n.messages" var="msg" /> 
```

Eclipse 只会搜索“ `i18n/messages.properties`”。

# c# - 当两个文本框都为空时运行代码

> ID：665874
> 
> 赞同：0
> 
> 时间：2009-03-20T12:07:40.603
> 
> 标签：c#, asp.net

在 C# 中，如果两个文本框都是空的，如何显示错误消息？是否有可以使用的代码示例或验证器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-20T12:18:48.377

您将需要使用[CustomValidator](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.customvalidator.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T12:12:58.640

RequiredFieldValidator 应该做的工作？如果您想了解有关验证器的更多信息，请查看此处[http://www.codeproject.com/KB/validation/aspnetvalidation.aspx](http://www.codeproject.com/KB/validation/aspnetvalidation.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T12:14:17.123

```
protected submit_click()
{
if((TextBox1.Text=="")||(TextBox2.Text==""))
  {
   print that error message
   }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T12:15:55.857

```
if (TextBox1.Text == String.Empty && TextBox2.Text == String.Empty)
{
Label1.Text = "Your error message here";
}
else
{
//continue your logic here
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T12:20:22.163

CustomValidator 给你一个回调方法。您可以像使用任何其他验证器一样使用它，并在 [控件名称]_ServerValidate 方法中编写以下代码：

```
args.IsValid = TextBox1.Text.Length > 0 && TextBox2.Text.Length > 0; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T12:27:59.260

抽象为一个可扩展的函数：

```
private bool Validate(params TextBox[] boxes) {
    foreach (var box in boxes) 
        if (string.IsNullOrEmpty(box.Text))
            return false;
    return true;            
} 
```

然后打电话给

```
if(Validate(TextBox1, TextBox2, ...)) { 
    /// Do the good stuff 
} else { 
    /// throw error 
} 
```

# vbscript - 停止测试运 行后如何执行任务？

> ID：665894
> 
> 赞同：1
> 
> 时间：2009-03-20T12:15:21.350
> 
> 标签：vbscript, qtp

在我停止 QTP 中的测试运行后，我只是想执行一项任务。

实际场景是这样的：

我想登录某个站点（项目内部），执行某些任务，当我停止测试运​​行时，它应该会自动从该站点注销。

网页上也有一个注销按钮。

但挑战在于我们必须在停止测试之后而不是在停止测试运​​行之前注销。

请帮助我，我尝试了很多，但我无法做到这一点。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-24T08:36:30.373

我不确定我是否理解您为什么要在测试停止后注销，为什么不注销测试的最后一步？

同样从您的问题来看，您似乎在谈论**手动**停止测试

> 当我停止测试运​​行时，它应该会自动从站点注销

这似乎是一个无趣的案例，如果您手动停止测试，那么您可以手动注销，并且自动测试运行（这是自动测试的点）按要求行事（在最后一步注销ETC。）

QTP**确实**支持在测试运行后（当测试关闭时）关闭浏览器，这是从`Record and Run Settings`对话框中完成的。

这里所说的所有这些都是获取（我认为）您正在寻找的东西的一种hacky方式，将其作为测试的最后一步：

```
Browser("Br").Navigate "javascript:setTimeout('document.getElementById(""logout"").click();', 5000); void(0)" 
```

这样做是告诉浏览器在 5 秒（5000 毫秒）后调用[特定函数](http://www.w3schools.com/js/js_timing.asp)（使用[bookmaklet](http://en.wikipedia.org/wiki/Bookmarklet)），在 5 秒后调用的代码单击注销按钮（您必须使用正确的`id`或以其他方式定位当然是按钮）。

正如我所说，我不确定我是否理解您的问题，所以我不知道这会有多大帮助。

# filesystems - 在 POSIX 系统上修改多个文件的安全有效的方法？

> ID：665898
> 
> 赞同：8
> 
> 时间：2009-03-20T12:15:59.927
> 
> 标签：filesystems, posix

我一直在关注关于 EXT4 上的“错误”的讨论，如果使用“创建临时文件，写入临时文件，将临时文件重命名为目标文件”过程，会导致文件在崩溃中归零。POSIX 表示，除非调用 fsync()，否则您无法确定数据是否已刷新到硬盘。

显然在做：

```
0) get the file contents (read it or make it somehow)
1) open original file and truncate it
2) write new contents
3) close file 
```

即使使用 fsync() 也不好，因为计算机可能会在 2) 或 fsync() 期间崩溃，并且您最终会得到部分写入的文件。

通常人们认为这是非常安全的：

```
0) get the file contents (read it or make it somehow)
1) open temp file
2) write contents to temp file
3) close temp file
4) rename temp file to original file 
```

不幸的是，事实并非如此。为了使其在 EXT4 上安全，您需要执行以下操作：

```
0) get the file contents (read it or make it somehow)
1) open temp file
2) write contents to temp file
3) fsync()
4) close temp file
5) rename temp file to original file 
```

这将是安全的，并且在崩溃时，您应该拥有新文件内容或旧的、从未归零的内容或部分内容。但是如果应用程序使用大量文件，每次写入后的 fsync() 会很慢。

所以我的问题是，如何在需要 fsync() 以确保更改已保存到磁盘的系统上有效地修改多个文件？我的意思是修改许多文件，如数千个文件。修改两个文件并在每个文件之后执行 fsync() 不会太糟糕，但是 fsync() 在修改多个文件时确实会减慢速度。

编辑：将 fsync() 关闭临时文件更改为正确顺序，增加了对编写许多许多文件的重视。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T13:29:05.710

简短的回答是：在应用层解决这个问题是错误的。EXT4一定要保证我关闭文件后及时写入数据。就像现在一样，EXT4“优化”了这种写入，以便能够收集更多的写入请求并一次性将它们爆发出来。

问题很明显：无论您做什么，都无法确定您的数据是否在磁盘上结束。手动调用 fdisk() 只会让事情变得更糟：您基本上会妨碍 EXT4 的优化，从而减慢整个系统的速度。

OTOH，EXT4 具有在需要将数据写入磁盘时做出有根据的猜测所需的所有信息。在这种情况下，我将临时文件重命名为现有文件的名称。对于 EXT4，这意味着它必须要么推迟重命名（因此原始文件的数据在崩溃后保持不变）要么必须立即刷新。由于它不能推迟重命名（下一个进程可能想要查看新数据），因此重命名隐式意味着刷新，并且刷新必须发生在 FS 层，而不是应用层。

EXT4 可能会创建文件系统的虚拟副本，其中包含磁盘未修改（尚未）的更改。但这并不影响最终目标：应用程序无法知道 FS 如果要进行哪些优化，因此 FS 必须确保它完成其工作。

在这种情况下，无情的优化已经走得太远并破坏了结果。黄金法则：优化绝不能改变最终结果。如果你不能保持这一点，你就不能优化。

只要 Tso 认为拥有一个快速的 FS 比一个行为正确的 FS 更重要，我建议不要升级到 EXT4 并关闭所有关于“按照 Tso 设计的工作”的错误报告。

[编辑] 关于这个的更多想法。您可以使用数据库而不是文件。让我们暂时忽略资源浪费。谁能保证数据库使用的文件不会因崩溃而损坏？大概。数据库可以每分钟左右写入数据并调用 fsync()。但是，您也可以这样做：

```
while True; do sync ; sleep 60 ; done 
```

同样，FS 中的错误会阻止它在任何情况下都有效。否则，人们就不会被这个错误所困扰。

您可以使用诸如 Windows 注册表之类的后台配置守护进程。守护进程会将所有配置写入一个大文件中。它可以在写完所有内容后调用 fsync() 。问题解决了......为您的配置。现在您需要对您的应用程序编写的所有其他内容执行相同的操作：文本文档、图像等等。我的意思是几乎所有 Unix 进程都会创建一个文件。这是整个 Unix 理念的基础！

显然，这不是一条可行的道路。所以答案仍然存在：您这边没有解决方案。继续打扰 Tso 和其他 FS 开发人员，直到他们修复他们的错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T12:39:59.153

My own answer would be to keep to the modifications on temp files, and after finishing writing them all, do one fsync() and then do rename on them all.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T12:26:39.607

You need to swap 3 & 4 in your last listing - [`fsync(fd)`](http://linux.die.net/man/2/fsync) uses the file descriptor. and I don't see why that would be particularly costly - you want the data written to disk by the close() anyway. So the cost will be the same between what you want to happen and what will happen with `fsync()`.

If the cost is too much, (and you have it) [`fdatasync(2)`](http://linux.die.net/man/2/fdatasync) avoid syncing the meta-data, so should be lighter cost.

EDIT: So I wrote some extremely hacky test code:

```
#include <unistd.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <sys/time.h>
#include <time.h>
#include <stdio.h>
#include <string.h>

static void testBasic()
{
    int fd;
    const char* text = "This is some text";

    fd = open("temp.tmp", O_WRONLY | O_CREAT);
    write(fd,text,strlen(text));
    close(fd);
    rename("temp.tmp","temp");
}

static void testFsync()
{
    int fd;
    const char* text = "This is some text";

    fd = open("temp1", O_WRONLY | O_CREAT);
    write(fd,text,strlen(text));
    fsync(fd);
    close(fd);
    rename("temp.tmp","temp");
}

static void testFdatasync()
{
    int fd;
    const char* text = "This is some text";

    fd = open("temp1", O_WRONLY | O_CREAT);
    write(fd,text,strlen(text));
    fdatasync(fd);
    close(fd);
    rename("temp.tmp","temp");
}

#define ITERATIONS 10000

static void testLoop(int type)
{
    struct timeval before;
    struct timeval after;
    long seconds;
    long usec;
    int i;

    gettimeofday(&before,NULL);
    if (type == 1)
    {
        for (i = 0; i < ITERATIONS; i++)
        {
            testBasic();
        }
    }
    if (type == 2)
    {
        for (i = 0; i < ITERATIONS; i++)
        {
            testFsync();
        }
    }
    if (type == 3)
    {
        for (i = 0; i < ITERATIONS; i++)
        {
            testFdatasync();
        }
    }
    gettimeofday(&after,NULL);

    seconds = (long)(after.tv_sec - before.tv_sec);
    usec = (long)(after.tv_usec - before.tv_usec);
    if (usec < 0)
    {
        seconds--;
        usec += 1000000;
    }

    printf("%ld.%06ld\n",seconds,usec);
}

int main()
{
    testLoop(1);
    testLoop(2);
    testLoop(3);
    return 0;
} 
```

On my laptop that produces:

```
0.595782
6.338329
6.116894 
```

Which suggests doing the `fsync()` is ~10 times more expensive. and `fdatasync()` is slightly cheaper.

I guess the problem I see is that *every* application is going to think it's data is important enough to fsync(), so the performance advantages of merging writes over a minute will be eliminated.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-19T13:30:12.043

您提到的问题已经过充分研究，您一定要阅读以下内容： [https ://www.academia.edu/9846821/Towards_Efficient_Portable_Application-Level_Consistency](https://www.academia.edu/9846821/Towards_Efficient_Portable_Application-Level_Consistency)

*在安全重命名*行为下可以跳过 Fsync，在*安全新文件*行为下可以跳过目录 fsync 。两者都是特定于实现的，POSIX 不保证。

# sql-server - 从 Oracle 迁移到 Sql Server

> ID：665903
> 
> 赞同：5
> 
> 时间：2009-03-20T12:19:39.933
> 
> 标签：sql-server, oracle, migration

我需要在**SQL Server**中创建一个新数据库，并将一些数据从**Oracle**数据库移动到这个 SQLServer 数据库；

我读到这个功能可以通过使用**SSIS**或**SQL Server Migration Assistant for Oracle**来实现；

我想知道是否有人可以将我指向一个教程或文档，我可以在其中看到如何逐步执行此任务

从**Oracle** db 移动的数据每天都会更新，因此移动的数据必须定期更新。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-20T12:25:36.893

Have you looked at the [SQL Server Migration Assistant for Oracle](http://www.microsoft.com/sqlserver/2005/en/us/migration-oracle.aspx)?

[Step by step document on how to use it](http://download.microsoft.com/download/e/c/8/ec8d5025-7ef7-4dcc-a9f3-9c297cf5350e/SSMAOracle.docx).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-20T13:19:50.710

这个怎么样：

[http://aspalliance.com/947_building_a_sql_server_2005_integration_services_package_using_visual_studio_2005](http://aspalliance.com/947_building_a_sql_server_2005_integration_services_package_using_visual_studio_2005)

和这个：

[http://msdn.microsoft.com/en-us/library/ms169917.aspx](http://msdn.microsoft.com/en-us/library/ms169917.aspx)

# vb.net - 从 vb.net 中的 Datatable 中删除行

> ID：665905
> 
> 赞同：0
> 
> 时间：2009-03-20T12:19:55.550
> 
> 标签：vb.net

**重复的** [如何在 RowDeleting 事件期间从 GridView 中删除一行？](https://stackoverflow.com/questions/665751/deletion-from-datatable)

你好，

我在 vb.net 的代码中有一个数据表。我需要从数据表中删除行。我的 Datatable 的名称是“temptable”。在我的 Gridview 控件的 rowdeleting 事件中。我编写的代码如下：

在 Gridview 的 Row_Deleting 事件中：

temptable.Rows.Remove(Gridview1.Datakeys(e.RowIndex).value)

但是，它显示如下错误：

“无法将 System.Int32 转换为 System.Data.Datarow”。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-20T12:28:27.480

`temptable.Rows[e.RowIndex].Delete()`

它解决了你的问题吗？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2010-02-17T03:07:18.507

```
Dim intans As Integer
Dim ssql As ADODB.Command
intans = MsgBox("ARE YOU SURE YOU ", vbYesNo, "CONFIRM")
If intans = vbYes Then
    ssql = "delete * from supplier_table where id=" & cbocid.Text & ""
    conn.Execute (ssql)
    rs.MoveNext
        If rs.EOF Then
        rs.MovePrevious
            If rs.BOF Then
            MsgBox "No record exit in the table", vbExclamation, "No Record"
            End If
        End If

MsgBox "RECORD SUCCESSFULLY DELETED", vbInformation, "INFO"

cmdfirst_Click
cbocid.Clear
Do Until rs.EOF
cbocid.AddItem rs.Fields(0).Value
rs.MoveNext
Loop

End If 
```

# jquery - Jquery UI effective tutorial

> ID：665912
> 
> 赞同：4
> 
> 时间：2009-03-20T12:21:45.747
> 
> 标签：jquery, jquery-ui, resources, drag-and-drop, jquery-ui-draggable

Does anyone know a detailed and effective jQuery UI 1.7 tutorial out there? I just can't do it with the demo page alone.

I can't figure out the drag and drop.. With just doing the `('div#item').draggable();`

Thanks

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-03-20T12:26:35.143

i like this one:

[http://www.learningjquery.com/2008/07/introduction-to-jquery-ui](http://www.learningjquery.com/2008/07/introduction-to-jquery-ui)

also, try

```
$('div#item').draggable(): 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T12:31:14.820

To use jQuery draggable, you need to :

1.  Include jquery.js, jquery.ui.core.js and jquery.draggable in your page
2.  Declare a `<div id="item">Some content</div>`
3.  Set a width and height to your div in your css : `#item { width: 100px; height: 100px; }`
4.  Call the jQuery draggable() extension : `$('div#item').draggable();`

Of course, 2 and 3 can be done together:

```
<div id="item" style="width: 100px; height: 100px;">Some content</div> 
```

# network-protocols - Need specific information on NTRIP protocol

> ID：665913
> 
> 赞同：0
> 
> 时间：2009-03-20T12:23:00.847
> 
> 标签：network-protocols

I am developing an application that use NTRIP protocol. I need the packet that is sent by the NTRIP client to the server. The application I am building uses the HTTP stream. The client will connect to this application and send data using HTTP from which I will extract certain information and process it. I need the sample data that the client will send.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-23T01:47:44.367

旧线程，但是...如果您想查看数据对话的进展情况，您可以获取 GNSS Internet Radio 的副本并将其连接到 NTRIP Caster，同时运行数据包嗅探器以捕获数据。

如果您只是在寻找 NTRIP 客户端，我在 VB.Net 中编写了一个开源客户端。您可以使用它来查看连接握手的工作原理。 [http://lefebure.com/software/](http://lefebure.com/software/)

# sql-server - Understanding SQL Profiler trace

> ID：665926
> 
> 赞同：4
> 
> 时间：2009-03-20T12:27:00.900
> 
> 标签：sql-server, sql-server-profiler

I'm currently experiencing some problems on my DotNetNuke SQL Server 2005 Express site on Win2k8 Server. It runs smoothly for most of the time. However, occasionally (order once or twice an hour) it runs very slowly indeed - from a user perspective it's almost like there's a deadlock of some description when this occurs.

To try to work out what the problem is I've run SQL Profiler against the SQL Express database.

Looking at the results, some specific questions I have are:

1.  The SQL trace shows an Audit Logon and Audit Logoff for every RPC:Completed - does this mean Connection Pooling isn't working?

2.  When I look in Performance Monitor at ".NET CLR Data", then none of the "SQL client" counters have any instances - is this just a SQL Express lack-of-functionality problem or does it suggest I have something misconfigured?

3.  The queries running when the slowness occur don't yet seem unusual - they run fast at other times. What other perfmon counters or other trace/log files can you suggest as useful tools for my further investigation.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-22T13:10:51.153

直接跳到 Profiler 可能是错误的第一步。首先，尝试检查服务器上的 Perfmon 统计信息。我这里有一个在线教程：

[http://www.brentozar.com/perfmon](http://www.brentozar.com/perfmon)

开始捕获这些指标，然后在经历了其中一种减速之后，停止收集。查看当时的性能指标，瓶颈就会出现。如果您想通过 brento@brentozar.com 将 Perfmon 的 csv 输出发送给我，我可以让您了解正在发生的事情。

之后您可能仍需要运行 Profiler，但我会先排除操作系统和硬件。另外，只是想一想-您是否检查了服务器的系统和应用程序事件日志以确保在这些时间没有发生任何事情？我见过这样的情况，例如，防病毒客户端过于频繁地下载新补丁，并在每次更新后进行轻度扫描。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T13:16:26.273

我的蜘蛛侠感觉告诉我，您可能遇到了 SQL Server 阻塞问题。阅读[本文](http://support.microsoft.com/kb/271509)以帮助您监控服务器上的阻塞以检查其原因。

如果您认为问题可能与性能有关并且想查看您的硬件瓶颈是什么，那么您应该使用 perfmon 收集一些 cpu、磁盘和内存统计信息，然后[将它们](http://www.mssqltips.com/tip.asp?tip=1212)与您的分析器跟踪相关联，以查看慢响应是否相关.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T12:33:28.497

1.  no
2.  nothing wrong with that...it shows that you're not using the .NET functionality embed in SQL Server.
3.  You can check [http://www.xsqlsoftware.com/Product/xSQL_Profiler.aspx](http://www.xsqlsoftware.com/Product/xSQL_Profiler.aspx) for more detailed analysis of profiler trace. It has reports that show top queries by time or CPU (Not one single query, but sum of all execution of a single query).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-24T23:27:27.237

其他一些需要检查的事情：

*   确保您的数据文件或日志文件没有自动扩展。

*   确保您的防病毒软件设置为忽略您的 sql 数据和日志文件。

*   查看分析器输出时，请确保检查在您的目标之前完成的查询，它们可能已被阻塞。

*   确保您已关闭数据库上的自动关闭；关闭后重新打开需要一些
    时间。

# c# - 你如何命名构造函数参数和成员变量？

> ID：665934
> 
> 赞同：9
> 
> 时间：2009-03-20T12:29:49.550
> 
> 标签：c#, naming-conventions

我在命名类的内部变量时不使用前缀（我知道有些人这样做，但我没有开始“你为什么……”辩论）。我只是喜欢这样。问题是有时在构造函数中传递相同的参数，我最终对如何命名它们感到困惑。例如：

```
公共类 SampleClass
{
    私有 int 类 ID；
    私有字符串类名；

    公共 SampleClass (int XclassIdX, string XclassNameX) {
        classId = XclassIdX;
        类名 = X类名X；
    }
}

```

如何命名 XclassIdX 和 XclassNameX？

可能可以做的一件事是：

```
公共类 SampleClass
{
    私有 int 类 ID；
    私有字符串类名；

    公共 SampleClass (int classId, string className) {
        this.classId = classId;
        this.className = 类名；
    }
}

```

只是不确定这是一个好主意还是有其他更优雅的方式？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-03-20T12:31:55.880

我认为您所描述的解决方案，其中构造函数参数的名称相同，并且您在类成员前面加上`this`，就可以了。很清楚，很简洁，你的意思没有混淆。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T12:32:29.200

我只是使用这种`this`方法；那么我所有的变量和字段都反映了他们的意图。不要做那`X`件事——那太丑了；-p

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-20T12:33:38.263

我的情况是这样的，我认为没有一种方法比其他方法更好。但是为了其他可能需要维护您的代码的人（以及您自己），我会说只选择一种方法并保持一致。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-14T19:28:34.463

## 简短的回答：

如果成员是静态的，则为**成员**和**参数**添加前缀“ `m_`”和“ `p_`”，或“ ”。`s_`

不要装饰**属性**或**局部变量**，当您觉得必须将它们命名为相同（忽略大小写）时，请通过在属性前加上“this.”来解决冲突。

## 解释：

考虑到至少有四（4）个不同类别的可读/可分配名称需要区分：**局部变量**、**成员变量**（实例和静态）、**属性**和方法**参数**。所有四个类别都可能出现在一个代码块中，因此它们都需要明确的区分特征。

有意义的前缀可以同时区分变量*并*显示其范围，例如 m_(member)、s_(static)、p_(parameter)，使公共属性和局部变量保持简单，无需前缀，无需担心区分大小写。如果由于某种原因您必须将本地名称命名为与属性相同的名称而不考虑大小写，那么只需在属性前面加上“this”即可。

**不会发生局部变量**和**参数**之间的命名冲突，因为它们不能被命名为相同的东西（编译器会捕获重复的定义）。**成员变量**和**属性**也是如此。分别以“p_”和“m_”为前缀的参数和成员不会冲突，不带前缀的locals和properties之间的冲突可以通过添加“this”来解决。到属性。

我的建议的替代方案并不漂亮：区分大小写（坏主意，因为并非所有 CLR 语言都区分大小写），单独使用下划线（也很糟糕，因为它可能与标准冲突并且不会告诉您该死的事情） , 或完全使用不同的名称（可能很耗时、很困难，而且看起来很随意）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T12:33:28.170

为什么不为您的私有成员变量添加下划线或单字母前缀。如果您不喜欢这个想法，那么您在第二个代码块中所做的一切都可以。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T12:41:23.253

像这样把 X 放在你的参数上是不好的。构造函数是类的公共接口的一部分，它只会让类的用户感到困惑。有些人喜欢在成员变量前加上下划线，这样会更好，因为它只对类的实现者可见。否则，在第二个示例中使用它就足够了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-20T13:18:22.600

`m_foo`用于参数和局部变量
`Foo`的公共属性的私有成员。
`foo`

我更喜欢将块作用域与扩展作用域成员区分开来，这就是我坚持使用前缀的原因。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-20T13:30:11.980

您需要以某种方式将它们分开。使用“这个”。是匈牙利符号的弱形式，因此您不妨硬着头皮使用下划线或 'm_' 。

我也感觉到“这个”。实际上更糟，因为在极端情况下（即大型方法）可能是“this”。将被忽略，并且将引用错误的变量。我知道大型方法不好，但它们确实会自然地出现在具有不同技能的开发人员的实际业务应用程序中。为私有字段使用前缀将防止这种情况。

很容易争辩说，下划线可能会像“this”一样被遗忘。将。但这是不正确的，因为下划线改变了变量的名称，所以唯一可能忘记的地方是定义处，而不是文件中的使用处。而用“这个”。如果您在使用过程中忘记了前缀，则不会出现编译器错误。

无论您选择什么，在这种情况下，无论您使用“this”，都无法避免使用匈牙利语。或下划线。无论如何，这还不错，按照惯例，我们被迫使用匈牙利语作为接口名称、控件名称以及我现在想不到的其他地方。

# java - 有什么方法可以在tomcat中的不同应用程序之间共享会话状态？

> ID：665941
> 
> 赞同：51
> 
> 时间：2009-03-20T12:32:18.657
> 
> 标签：java, session, tomcat, jakarta-ee

我们希望将一个工作应用程序拆分为两个不同的`.war`文件，以便能够更新一个应用程序而不影响另一个应用程序。每个 webapp 都会有不同的 UI、不同的用户和不同的部署计划。

最简单的路径似乎是共享同一个会话，所以如果应用 A 设置`session.setAttribute("foo", "bar")`应用 B 将能够看到它。

有没有办法`HttpSession`在同一个 Tomcat 实例中共享两个应用程序的状态？

我们的应用程序在专用的 Tomcat 5.5 上运行，没有其他应用程序在同一个 Tomcat 实例上运行，因此有关会话共享的任何安全问题都不是问题。我们正在运行多个 Tomcat 实例，但平衡器正在使用粘性会话。

如果不可能或此*会话共享*是一个非常糟糕的主意，请发表评论。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-03-20T13:11:42.400

你不应该共享 HttpSession；但您可以共享其他对象。例如，您可以[通过 JNDI 注册一个对象](http://tomcat.apache.org/tomcat-5.5-doc/jndi-resources-howto.html)并在所有应用程序中访问同一个对象（数据库使用它来池连接）。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-22T02:54:58.090

需要注意的一件事是，两个 Web 应用程序将使用不同的类加载器。如果你想共享对象，他们需要使用来自同一个类加载器的相同版本的类（否则你会得到 LinkageErrors）。这意味着要么将它们放在由两个 Web 应用程序共享的类加载器中（例如系统类路径），要么使用序列化来有效地耗尽并用正确的类版本重新构建正确的类加载器中的对象。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-01-15T11:19:45.913

如果你想使用 Spring，有一个名为**[Spring Session](http://projects.spring.io/spring-session/)**的项目： [https ://github.com/spring-projects/spring-session](https://github.com/spring-projects/spring-session)

引用：**“HttpSession - 允许在应用程序容器（即 Tomcat）中性方式中替换 HttpSession”**

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2019-04-25T05:55:19.217

对于 Tomcat 8，我使用以下配置在 2 个 Web 应用程序之间共享会话：

**conf/context.xml**

```
<Context sessionCookiePath="/">
    <Valve className="org.apache.catalina.valves.PersistentValve"/>
    <Manager className="org.apache.catalina.session.PersistentManager">
        <Store className="org.apache.catalina.session.FileStore" directory="${catalina.base}/temp/sessions"/>
    </Manager>
    ...
</Context> 
```

我两次部署相同的简单 webapp **log.war**和**log2.war**：

```
/log
/log2 
```

我现在可以登录`/log`并让用户显示在 中`/log2`，这不适用于 tomcat 默认配置。

[![在此处输入图像描述](https://i.stack.imgur.com/7baeC.jpg)](https://i.stack.imgur.com/7baeC.jpg)

设置和读取会话值：

```
HttpSession session=request.getSession();  
session.setAttribute("name",name);

HttpSession session=request.getSession(false);  
String name=(String)session.getAttribute("name"); 
```

我以这个项目为例：[https ://www.javatpoint.com/servlet-http-session-login-and-logout-example](https://www.javatpoint.com/servlet-http-session-login-and-logout-example)

大多数示例/解决方案使用需要更多设置工作的内存数据库：

*   [雷迪斯](https://redis.io/)
*   [榛树](https://hazelcast.com/)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-03-20T14:23:34.113

如果这两个 webapp 如此紧密耦合以至于它们需要共享对象，那你为什么要把它一分为二呢？即使您在某种程度上独立地管理它们，任何体面的构建管理系统都应该能够创建一个用于部署的 WAR 文件。

像 Aaron 建议的使用 JNDI 的解决方案将起作用，但前提是两个 web 应用程序都在同一台服务器上运行。如果这些单元是紧密耦合的，并且无论如何您都将在同一台服务器上运行它……还不如有一个 WAR。

如果您真的希望他们独立站立，我会认真检查两者之间的数据交换。理想情况下，您希望他们只彼此共享相关数据。这些数据可以通过 POST（或 GET，如果更合适）参数来回传递，您甚至可以考虑使用 cookie。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2011-10-17T15:26:49.987

此博客文章中描述了执行此操作的一种方法：[Apache Tomcat 中的会话共享](http://lukaszbudnik.blogspot.com/2009/06/session-sharing-in-apache-tomcat.html)

总结：在Connector配置中添加emptySessionPath，在Context中添加crossContext

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-05-20T08:47:22.787

**conf/context.xml**

```
<Context sessionCookiePath="/">
  ...
  <Manager className="org.redisson.tomcat.RedissonSessionManager"
               configPath="${catalina.base}/conf/redisson.yml"
               readMode="REDIS" />
</Context> 
```

**conf/redisson.yml**

```
singleServerConfig:
  address: "redis://<host>:6379" 
```

***雷迪森[下载](https://github.com/redisson/redisson)***

`sessionCookiePath="/"`使 Tomcat 对不同的 Web 应用程序使用相同的会话 ID。 `RedissonSessionManager`使会话保持在“共享空间”中

* * *

我无法`org.apache.catalina.session.FileStore` `PersistentManager`在共享 context.xml 中获得预期的结果，我在后台过期监视器线程中遇到了会话反序列化问题。它未能对会话进行反序列化，因为它在类路径中使用了没有 webapp 可序列化模型的通用类加载器。理论上`PersistentManager`可以在 WEB-INF/context.xml 中为每个 Web 应用程序单独配置（以具有正确的类路径），但我未能使其工作。

`org.apache.catalina.session.JDBCStore` `PersistentManage`很有希望，因为它公开`last_access`了会话的列，因此不需要反序列化`session_data`，但它一直在节省`app_name`时间，导致相同的会话 ID 被写入不同的 Web 应用程序的不同行。因此会话数据没有存储在共享位置。

Spring Session 有自己的方式来创建会话 ID。我无法找到强制 Spring Session 为不同的 Web 应用程序创建相同的会话 ID 的解决方案。

具有核心 tomcat 会话 ID 生成的解决方案（能够为不同的 Web 应用程序生成相同的会话 ID，并且`RedissonSessionManager`（使用会话 ID 作为唯一键存储数据并具有自己的过期机制）最终对我有用。该解决方案与**Spring bean****完美配合。`@SessionScope`**

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-30T14:31:11.623

您可以通过上下文根获取 servlet 上下文。

用于检索变量。

```
request.getSession().getServletContext().getContext("/{applicationContextRoot}").getAttribute(variableName) 
```

对于设置变量：

```
request.getSession().getServletContext().getContext("/{applicationContextRoot}").setAttribute(variableName,variableValue) 
```

**注意：** 这两个应用程序应部署在同一台服务器上。

如果您发现任何问题，请告诉我

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-06-27T02:25:13.337

Tomcat 8：我必须这样做：`<Context crossContext="true" sessionCookiePath="/">`在 conf/context.xml

有关配置属性的更多详细信息[here](https://tomcat.apache.org/tomcat-8.0-doc/config/context.html)

然后设置值（如@Qazi's answer）：

```
ServletContext servletContext =request.getSession().getServletContext().getContext("contextPath")
servletContext.setAttribute(variableName,variableValue) 
```

获取值：

```
ServletContext servletContext =request.getSession().getServletContext().getContext("contextPath")
servletContext.getAttribute("user"); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-06-04T09:44:26.433

我使用python为tomcat开发了[会话状态服务器](https://github.com/rover886/tomcat-pysession-server)。

因此，我不需要更改已经为创建/访问和销毁会话而编写的代码。此外，由于有单独的服务器/服务正在处理和存储会话，因此不需要主集群。在这种情况下，没有会话复制（如在 tomcat 集群中），而是网络农场之间的会话共享。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2009-03-22T03:44:39.110

您不应该为了获得高可用性而以这种方式拆分您的应用程序。您可以将整个应用程序部署在许多 tomcat 实例上。

# python - How to write a function that takes a string and prints the letters in decreasing order of frequency?

> ID：665942
> 
> 赞同：4
> 
> 时间：2009-03-20T12:32:19.437
> 
> 标签：python

I got this far:

```
def most_frequent(string):
    d = dict()
    for key in string:
        if key not in d:
            d[key] = 1
        else:
            d[key] += 1
    return d

print most_frequent('aabbbc') 
```

Returning:

```
{'a': 2, 'c': 1, 'b': 3} 
```

Now I need to:

1.  reverse the pair
2.  sort by number by decreasing order
3.  only print the letters out

Should I convert this dictionary to tuples or list?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-20T12:47:42.893

Here's a one line answer

```
sortedLetters = sorted(d.iteritems(), key=lambda (k,v): (v,k)) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T12:44:10.343

This should do it nicely.

```
def frequency_analysis(string):
    d = dict()
    for key in string:
        d[key] = d.get(key, 0) + 1
    return d

def letters_in_order_of_frequency(string):
    frequencies = frequency_analysis(string)
    # frequencies is of bounded size because number of letters is bounded by the dictionary, not the input size 
    frequency_list = [(freq, letter) for (letter, freq) in frequencies.iteritems()]
    frequency_list.sort(reverse=True)
    return [letter for freq, letter in frequency_list]

string = 'aabbbc'
print letters_in_order_of_frequency(string) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-11-14T06:06:40.107

Python 2.7 直接支持这个用例：

```
>>> from collections import Counter
>>> Counter('abracadabra').most_common()
[('a', 5), ('r', 2), ('b', 2), ('c', 1), ('d', 1)] 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-20T12:49:48.520

这是返回元组列表而不是字典的内容：

```
import operator

if __name__ == '__main__':

    test_string = 'cnaa'

    string_dict = dict()
    for letter in test_string:
        if letter not in string_dict:
            string_dict[letter] = test_string.count(letter)

    # Sort dictionary by values, credits go here http://stackoverflow.com/questions/613183/sort-a-dictionary-in-python-by-the-value/613218#613218
    ordered_answer = sorted(string_dict.items(), key=operator.itemgetter(1), reverse=True)
    print ordered_answer 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-20T13:04:36.067

我认为 chills42 lambda 函数获胜，但作为替代方案，如何生成以计数作为键的字典呢？

```
def count_chars(string):
    distinct = set(string)
    dictionary = {}
    for s in distinct:
        num = len(string.split(s)) - 1
        dictionary[num] = s
    return dictionary

def print_dict_in_reverse_order(d):
    _list = d.keys()
    _list.sort()
    _list.reverse()
    for s in _list:
        print d[s] 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-03-20T13:05:26.360

**编辑**这将做你想要的。我正在窃取**chills42**行并添加另一个：

```
sortedLetters = sorted(d.iteritems(), key=lambda (k,v): (v,k))
sortedString = ''.join([c[0] for c in reversed(sortedLetters)]) 
```

------------*原始答案*------------

要打印出排序后的字符串，请在**chills42** one-liner 中添加另一行：

```
''.join(map(lambda c: str(c[0]*c[1]), reversed(sortedLetters))) 
```

这打印出'bbbaac'

如果你想要单个字母，'bac' 使用这个：

```
''.join([c[0] for c in reversed(sortedLetters)]) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-03-20T13:25:24.113

```
from collections import defaultdict

def most_frequent(s):
    d = defaultdict(int)
    for c in s:
        d[c] += 1

    return "".join([
        k for k, v in sorted(
        d.iteritems(), reverse=True, key=lambda (k, v): v)
    ]) 
```

**编辑：**

这是我的一个班轮：

```
def most_frequent(s):
    return "".join([
        c for frequency, c in sorted(
            [(s.count(c), c) for c in set(s)], reverse=True
        )
    ]) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-03-23T11:36:23.693

这是您的`most_frequent`函数的代码：

```
>>> a = 'aabbbc'
>>> {i: a.count(i) for i in set(a)}
{'a': 2, 'c': 1, 'b': 3} 
```

这种特殊的语法适用于 py3k，但使用以前版本的语法很容易编写类似的东西。在我看来，它比你的更具可读性。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-20T14:23:09.123

这是**固定版本**（感谢您指出错误）

```
def frequency(s):
    return ''.join(
        [k for k, v in
        sorted(
            reduce(
                lambda d, c: d.update([[c, d.get(c, 0) + 1]]) or d, 
                list(s), 
                dict()).items(),
            lambda a, b: cmp(a[1], b[1]),
            reverse=True)]) 
```

我认为与`reduce`其他解决方案相比，这种解决方案的使用有所不同......

在行动：

```
>>> from frequency import frequency
>>> frequency('abbbccddddxxxyyyyyz')
'ydbxcaz' 
```

这**也包括提取密钥（并计算它们）**！！！另一个不错的属性是在同一行上初始化字典:)

另外：**没有包含**，只有内置。

该`reduce`函数有点难以理解，并且在 a 中设置字典值在`lambda`python 中也有点麻烦，但是，嗯，它可以工作！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-03-20T13:31:16.750

```
def reversedSortedFrequency(string)
   from collections import defaultdict
   d = defaultdict(int)
   for c in string:
     d[c]+=1
   return sorted([(v,k) for k,v in d.items()], key=lambda (k,v): -k) 
```

# sql - Informix：选择空问题

> ID：665944
> 
> 赞同：5
> 
> 时间：2009-03-20T12:32:38.000
> 
> 标签：sql, select, informix

使用 Informix，我创建了一个临时表，我试图从 select 语句中填充它。在此之后，我想进行更新，以填充临时表中的更多字段。

所以我正在做类似的事情；

```
create temp table _results (group_ser int, item_ser int, restype char(4));

insert into _results (group_ser, item_ser)
select 
      group_ser, item_ser, null
from
      sometable 
```

但是你不能选择null。

例如;

```
select first 1 current from systables 
```

有效，但

```
select first 1 null from systables 
```

失败！

（不要让我开始解释为什么我不能像“选择当前”这样没有指定表的 SQL Server！）

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-03-20T22:58:35.280

您不必编写存储过程；您只需告诉 IDS NULL 是什么类型。假设您没有使用 IDS 7.31（它不支持任何强制转换符号），您可以编写：

```
SELECT NULL::INTEGER FROM dual;

SELECT CAST(NULL AS INTEGER) FROM dual; 
```

而且，如果您没有`dual`表格（您可能没有），您可以执行以下操作之一：

```
CREATE SYNONYM dual FOR sysmaster:"informix".sysdual; 
```

'sysdual' 表是最近才添加的（IDS 11.10，IIRC），所以如果您使用的是旧版本，它将不存在。以下适用于任何版本的 IDS - 这是我使用的。

```
-- @(#)$Id: dual.sql,v 2.1 2004/11/01 18:16:32 jleffler Exp $
-- Create table DUAL - structurally equivalent to Oracle's similarly named table.
-- It contains one row of data.

CREATE TABLE dual
(
    dummy CHAR(1) DEFAULT 'x' NOT NULL CHECK (dummy = 'x') PRIMARY KEY
) EXTENT SIZE 8 NEXT SIZE 8;
INSERT INTO dual VALUES('x');

REVOKE ALL ON dual FROM PUBLIC;
GRANT SELECT ON dual TO PUBLIC; 
```

习惯上，如果您要从 Systables 中 SELECT 以获取单行，则应包括 ' `WHERE tabid = 1`'; 这是 Systables 本身的条目，如果缺少它，您的 SELECT 语句确实返回任何数据这一事实是您最不麻烦的事情。（不过，我从未将其视为错误。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-03-20T12:42:40.300

[这个页面](http://www.geocities.com/SiliconValley/Bridge/4578/faq.html)说你不能这样做的原因是因为“NULL”没有类型。因此，解决方法是创建一个 sproc，它只以您想要的类型返回 NULL。

不过，这听起来对我来说是一个非常糟糕的解决方案。也许您可以在脚本中创建一个变量，将其设置为 null，然后选择该变量？像这样的东西：

```
DEFINE dummy INT;
LET dummy = NULL;

SELECT group_ser, item_ser, dummy
FROM sometable 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-14T17:28:12.643

```
SELECT group_ser, item_ser, replace(null,null) as my_null_column
FROM sometable 
```

或者您可以使用`nvl(null,null)`为您的选择语句返回空值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-06T16:59:24.483

有什么理由去一张实际的桌子吗？我一直在使用

```
select blah from table(set{1}) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-31T07:35:56.380

```
select blah from table(set{1}) 
```

当您使用 10.x 数据库时很好。该语句不涉及数据库。读/写操作量等于0，

但

当您使用 11.x 时，它将花费您至少 4500 次缓冲区读取，因为此版本的 Informix 在内存中创建此表并对其执行查询。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-15T16:01:57.807

```
select to_date(null) from table; 
```

当我想获得一个空值的日期时，这很有效

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-17T14:36:08.137

您可以在 SELECT 列表上使用此表达式 (''+1)，而不是 null 关键字。它评估为 DECIMAL(2,0) 类型的 NULL 值。

这 (''+1.0001) 的计算结果为 DECIMAL(16,4)。等等。

如果您想要 DATE 类型，请使用 DATE(''+1) 来获取 DATE 类型的空值。

(''+1)||' ' 计算为 VARCHAR(1) 类型的空字符串。

要获得 VARCHAR(1) 类型的 NULL 值，请使用以下表达式：DATE(''+1)||' '

适用于 9.x 和 11.x。

# asp.net - 做太多事情的网页

> ID：665956
> 
> 赞同：6
> 
> 时间：2009-03-20T12:37:17.473
> 
> 标签：asp.net, web-applications, application-design

关于构建 Web 应用程序的页面：

最近，我发现自己创建的网页比以前更简单。以前，我会尝试将尽可能多的功能塞进一个页面中，以防止出现大量页面。

我开始意识到这只是让事情变得比它必须的更复杂、令人费解和令人困惑。为什么没有更多的页面？我认为我这样做的原因是因为我不希望用户必须浏览其他页面；只是为了在一个页面上拥有他们需要的所有功能。

好吧，这些良好的意图变成了对用户来说过于混乱的界面和非常难以管理的源代码。我是一名新开发人员，我正在努力反思我正在做的事情，以便我可以改进。如果它有所作为，我正在 ASP.net 中开发（尽管这些可能是任何平台的考虑因素）。

我的问题是：

*   我是不是在想这些事情？
*   有没有其他人发现自己这样做？
*   快乐的媒介在哪里？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-20T13:30:31.543

没有专家可以给你一个在任何时候都适用于所有地方的规则。多年来，我在行业中以“简单”的界面而闻名，我们为此赢得了大量业务（以及 5 个“同类最佳”奖）。我公司内部和外部的人也告诉我——多年来——他们喜欢我的工作，但希望我能用更多的图形等“让它变得活跃”。总是让我感到惊讶的是，人们看到两者之间的联系是如此之少。

所以......一些经验法则：

1.  一个页面应该做一件*主要*的事情。
2.  一个页面可能有多个与主要内容相关的链接
3.  菜单和链接布局应在页面之间保持一致
4.  简单比复杂好
5.  页面应该具有视觉吸引力和吸引力
6.  规则 4 比规则 5 更重要。

例如，我的产品提供了一个界面，让人们可以定义要在日历中显示的类和事件。我*可以*有一页让您查看、添加、更新、删除和编辑课程。事实上，在一些更简单的领域，我使用了 gridview 来让人们管理网格中的所有内容。然而，类有太多的信息来做到这一点，仍然遵循上述规则。

所以，

1.  *主要思想*是：“这是该位置的类列表”
2.  链接是上方和网格右侧显示的“添加新”，更改和删除是每行中的链接。这在整个应用程序中是一致的。
3.  整个系统的菜单始终位于右侧/顶部。除了所有页面共有的标准元素（徽标、页眉、页脚）外，类/事件页面上没有其他内容。
4.  网格的样式很好，但没有虚假的图形 (4,5,6)

* * *

关于 UI 和图形设计的最后几件事。

首先，制定自己的愿景，并在页面和应用程序之间保持一致。

第二，不要害怕[简单](http://www.alistapart.com)。

接下来，在向他人征求建议时，请记住，您不需要他们的建议——您需要他们的印象：您想了解他们对界面的*看法。*建议有时是好的，但更多时候实际上是有害的。根据我的经验，每个人都认为自己是 UI 专家。

当你进行走廊（或正式）可用性测试时，你应该忽略几乎所有的建议，大意是“你应该让它**更加**突出”。如您所见，它很快就会变成“and **that** ”、“and **that** ”、“and **the other** ”。如果你遵循这个建议，由于 Brittingham 的第一条设计规则，你最终会陷入混乱：*如果一切都很重要，那么什么都不重要。*（你去吧：在解释为什么你不能让某人更加突出时，只需告诉他们“这违反了 Brittingham 的第一条设计规则！”）

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T12:50:12.437

你击中了要害。使用 KISS 原则。（保持简单愚蠢）我过去也这样做过，它不仅使用户界面变得丑陋，而且由于功能太多，您可以在页面上执行哪些操作令人困惑。我在测试中经常发现，我没有足够的检查来查看用户是否可以根据数据的状态执行某个操作。

在 ASP.Net 中很容易编写几个执行简单任务的页面，然后将它们与 Response.Redirect 或 Server.Transfer 链接在一起。现在，我试图在任何给定页面上实现的只是设计规范所说的。所以如果我的页面只是一个搜索页面，这就是我给出的全部。如果用户想要查看在搜索中返回的项目的详细信息，那么我会将它们发送到 itemDetails.aspx 页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T13:00:03.940

您已经打破了大多数软件开发人员所拥有的一堵墙，这堵墙之前阻碍了您对可用性的看法。许多开发人员并没有真正考虑它，而是试图通过在一个窗口、网页或其他任何东西中填充功能来让他们更容易。

问题是一旦你开始从用户的角度设计软件，即让它变得更容易，几件事情开始变得清晰。一个是代码维护问题，如果你不把所有东西都塞进一个巨大的类或者你一直在做的任何讽刺中，那么代码更容易处理。另一个是可用性本身，您开始思考用户如何通过图形界面实际使用您的应用程序。第三是避免停止开发用户不需要的功能的需求或范围蔓延。

我们作为用户想要简单，部分原因是我们不想花大部分时间在糟糕的 UI 上蒙混过关，因为我们可以通过简单而流畅的 UI 更快地完成工作。这让我们的软件开发人员做正确的事，从各个层面思考你的设计……那和**规格总是在说谎**。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T14:00:24.047

绝对同意：大多数尝试编写过多的页面/表单都导致

*   bugs and rewrites. Problems occur with keeping all parts valid/synchronized,
*   excess managing of users' expectations ("*I've entered a bill number here and clicked "find person" there but it gives an error message. Why?*") when the two are logically separate. These questions cannot arise if only the valid options are visible,
*   Formatting/layout issues: In ASP.NET pages, trying to layout independent User Controls turns out to be a nightmare ("*But we really want all the buttons vertically aligned!*" in separate user controls. Good luck with that.)

I'd consider webpages with more than one functionality only if the target audience consists of domain experts, i.e. people that need lots of functionality on one page for better productivity (think data-entry or financial software with lots of variables).

Even then, most of the time, it's possible separate pages into single units.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T12:52:37.437

1.  不
2.  是我
3.  我发现快乐的媒介是使用 Masterpages，并以 IFrame 熟悉的方式使用它。我可以将很多功能很好地结合在一起。使用 WPF/Silverlight 有一种更有趣的方法，称为[Prism](http://msdn.microsoft.com/en-us/magazine/cc785479.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T12:55:34.340

页面上的功能数量通常不是由您决定，而是由您的客户决定。如果客户需要一个页面来更新 some `VeryComplexObject`，那么您最终可能会得到一个包含大量行的 aspx 页面。主要原因是您对页面上的所有操作都有很多事件处理程序。

该页面是否复杂完全取决于您。您应该始终尝试使您的代码隐藏文件尽可能简单和干净。在这个方向上的一些建议：

*   将所有业务代码移至另一个应用层。
*   用于`ObjectDataSource`向数据绑定控件提供数据，例如`ListView`, `GridView`, `Repeater`, ... 将数据加载委托给专用对象可防止您的 aspx.cs 文件中出现大量开销。

另一个建议是使用用户控件来实现页面的某些部分。通常只有在可以重用用户控件时才这样做，但它也可以极大地帮助降低页面复杂性（包括代码隐藏文件和 aspx）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-20T13:13:53.877

有时我认为我们都为忘记了我们为谁开发应用程序而感到内疚。作为开发人员，能够退后一步并像用户那样查看您的应用程序并不总是那么容易。这就是为什么大公司雇佣数百人为他们做这件事，但他们并不总是做对。

可用性是一个庞大的主题，但它绝对是所有开发人员都需要牢记的事情。我花了很长时间来学习这一点，但是在处理任何开发任务时，我总是尝试考虑我的用户将如何与我正在编写的内容进行交互。这将对您的所有发展水平产生影响。

我建议阅读[Steve Krug 的 Don't Make Me Think](http://www.amazon.co.uk/Dont-Make-Me-Think-Usability/dp/0321344758/ref=sr_1_1?ie=UTF8&s=books&qid=1237554327&sr=8-1)。这本书不会花你很长时间才能阅读，它提出了一些奇妙的想法，可以帮助你开发更容易使用和理解的应用程序。

我总是发现，一旦我考虑了用户体验，关于我的网页将要做什么以及它们将如何交互的决定就容易得多。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-20T14:35:41.137

Maybe you should ask the people who are using your site. Or better yet, just watch people use your site. I think that would tell you if your site is designed well, or if you need to change it.

# c# - 空“;”的性能问题 C#中的语句

> ID：665959
> 
> 赞同：3
> 
> 时间：2009-03-20T12:38:03.540
> 
> 标签：c#, performance

平台：x32 上的 .NET Framework 3.5 SP1

在代码中留下空语句（“;”本身）是否存在任何性能问题？

为了被标记为答案，你还会教一个人（我？和其他阅读本文的人）钓鱼吗？意思是，如何找出它存在性能问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-20T12:41:24.390

1) 使用 ildasm 或 .NET Reflector 之类的工具查看生成的程序集的内部，并查看哪些 IL 指令与“;”相关联 空语句（如果有的话；它们可能会被优化为一无所有。）

2) 使用探查器运行一个巨大的循环，其中包含其他代码中的一堆“;”，然后在没有“;”的情况下尝试它，看看是否有区别。

（如果不做这其中任何一个，我敢打赌它会被优化掉并且不会产生 IL（或某种无操作指令——请原谅我对 IL 的无知。））

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-03-20T12:43:22.233

空语句产生 nop IL 代码，因此您可以拥有任意数量的 JIT 编译器删除的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-20T12:45:52.977

衡量性能的最简单方法是编写代码并在计时的同时多次运行它。

对于这种情况，我不相信您会因为空行而失去任何代码性能，但是，它可能会影响您的编译时间（尽管可以忽略不计）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-20T12:40:55.077

查看是否存在性能问题（因为我认为不会存在）的最简单方法是运行调试器并查看该行是否已执行。如果它被执行，请尝试访问该语句后面的程序集，因为这会告诉您该语句产生了多少条指令。但很有可能，它是一个空操作，只是一个时钟滴答。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T13:16:55.880

作为测试性能的另一种方法：

从以下开始：

```
// breakpoint here
int breakpoint1 = 0;

for (int i = 0; i <= 1000; i++)
{
   // test operation here
   ;
}

// breakpoint here
int breakpoint2 = 0; 
```

跑到第一个断点，然后按 F5 并在脑海中数数。如果速度太快，则将循环更改为 10,000 并重试。如果速度太快，将其增加到 100,000，然后重试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-20T12:40:12.817

我无法想象编译器不会简单地优化空语句的任何情况。它当然不会生成除了“什么都不做”之外的任何指令。如果您认为这存在性能问题，那么很有可能是其他问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-03-20T12:45:50.603

我不希望性能受到影响。

您可以通过检查生成的带有和不带有空语句的 C# 程序的 IL 代码来检查这一点。您可以使用 .NET 反射器 (www.redgate.com) 来检查 IL。如果生成相同的 IL，则不会影响性能。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-20T12:51:21.277

本着教你钓鱼的精神，

1）按照建议检查组件

2）运行一个大循环并计时（手表是一个非常好的工具）

3）在反汇编窗口中单步执行它（类似于1）。

如果您担心性能，那么错误的做法是开始猜测语言结构。正确的做法是诊断，让程序告诉你什么是需要时间的，如

4）[我最喜欢的方法](https://stackoverflow.com/questions/375913/what-can-i-use-to-profile-c-code-in-linux/378024#378024)

# jquery-ui - jQuery UI 与 Scriptaculous？

> ID：665969
> 
> 赞同：11
> 
> 时间：2009-03-20T12:41:03.767
> 
> 标签：jquery-ui, user-interface, scriptaculous

哪个更适合 UI 开发。这两个 UI 工具包之间有什么区别吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-20T12:52:32.803

我目前使用 Prototype/Scriptaculous，但我希望迁移到 jQuery。我的主要原因是 Prototype/Scriptaculous 背后的开发者和社区似乎已经消失了；好久没有新版本了，有几个功能还是有点BUG。jQuery 和 jQuery UI 团队似乎非常投入、更加开放（例如，请参阅[此](http://jqueryui.pbwiki.com/)），并且拥有更大、更活跃的社区。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-03-21T20:18:54.593

jQuery更好，

1.  它没有允许您轻松迁移的 noConflict 方法，包括原型/scriptaculous 和 jquery 库

2.  jQuery 是轻量级的，尤其是与 scriptaculous 相比

3.  jQuery 生成非常简单的代码，易于测试/审查

4.  jQuery 支持 CSS 2/3 选择器，即使浏览器不支持

5.  对于 ROR，有一个插件 jRails

问候， 帕维尔

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-03-20T12:47:47.730

JQuery 将在 Visual Studio 2010 中得到支持，使其成为 .NET 开发人员的理想选择。

[检查此链接 - jQuery 和 Microsoft](http://weblogs.asp.net/scottgu/archive/2008/09/28/jquery-and-microsoft.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-20T12:45:52.290

查看功能比较：[http ://wiki.freaks-unidos.net/javascript-libraries](http://wiki.freaks-unidos.net/javascript-libraries)

jQuery 非常流行并且很好地集成在许多框架中，而唯一集成了 scriptaculous 的框架是 Ruby on Rails。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-03-20T13:28:47.427

我刚刚将所有客户端脚本从 Prototype / Scriptaculous 迁移到 jQuery。结果是更好的性能（更少的编码 + 更小的占用空间）并且整个应用程序看起来更丰富。jQuery 开发确实有一些令人满意的地方。

Prototype 是一个很棒的库，但我有点沮丧，正如 DNS 指出的那样，开发人员和社区似乎已经睡着了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-06-30T17:22:37.963

嗯，我发现 scriptaculous 比 JQ 更容易使用，因为它看起来更像 javascript，并且具有更多核心效果......我喜欢它，但是是的，它有点错误，社区已经开始转向 JQuery......但是我真的不喜欢 JQ，因为它就像从头开始学习一门新语言……它看起来一点也不像 javascript

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-10-29T21:04:45.100

我一直在使用 jQuery。使用 scriptaculous 时，我发现很难找到合适的插件。他们中的大多数都有错误或缺乏良好的文档。例如，我浏览了 3 个幻灯片，包括在 Scriptaculous 中编写自己的幻灯片，然后才适应并修改其中一个以满足我的需要。使用 jQuery，我只需要浏览 1 个幻灯片插件，因为它们太多了，一个肯定能满足我的需要。

# php - 如何在页面上查找 url

> ID：665972
> 
> 赞同：2
> 
> 时间：2009-03-20T12:41:31.643
> 
> 标签：php, url, lookup

我是正则表达式和类似的东西的新手。我只有很少的知识，我认为我目前的问题是关于他们的。

我有一个网页，其中包含文本。我想从只有在`SPAN`s 中的网页中获取链接`class="img"`。

我经历了这些步骤。

1.  抓住所有`SPAN`标有“img”类的s（这是我正在寻找的艰难步骤）
2.  将那些`SPAN`s 移动到一个新变量
3.  解析变量以获取带有链接的数组（每个`SPAN`只有 1 个链接，所以这很容易）

我正在使用 PHP，但任何其他语言都无所谓，我正在寻找如何处理第一步。有人有建议吗？感谢：D

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-03-20T12:49:20.860

结合使用 PHPs [DOMDocument](http://php.net/manual/en/class.domdocument.php) -class 和[DOMXPath](http://php.net/manual/en/class.domxpath.php) -class 来导航到您需要的元素，如下所示：

```
`<?php
$dom = new DOMDocument();
$dom->loadHTML(file_get_contents('[http://foo.bar](http://foo.bar)'));
$xpath = new DOMXPath($dom);

$elements = $xpath->query("/html/body//span[@class='img']//a");
foreach ($elements as $a)
{
    echo $a->getAttribute('href'), "\n";
}` 
```

`[您可以在 W3C 页面上了解有关 XPath 语言的更多信息。](http://www.w3.org/TR/xpath)`

 `* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-20T13:09:40.267

像这样的模式`<span.* class="img".*>([^<]*)</span>`应该可以正常工作。假设您的代码看起来像

```
<span class="img">http://www.img.com/img.jpg</span>
<span alt="yada" class="img">animage.png</span>
<span alt="yada" class="img" title="still works">link.txt</span>
<span>not an img class</span>

<?php

$pattern = '@<span.* class="img".*>([^<]*)</span>@i';

//$subject = html code above

preg_match_all($pattern, $subject, $matches);

print_r($matches);

?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T14:20:22.127

> 我正在使用 PHP，但任何其他语言都无所谓，我正在寻找如何处理第一步。有人有建议吗？

我们……呃……

```
import urllib
from BeautifulSoup import BeautifulSoup, SoupStrainer

html = urllib.urlopen(url).read()
sieve = SoupStrainer(name='span', attrs={'class': 'img'})
tag_soup = BeautifulSoup(html, parseOnlyThese=sieve)
for link in tag_soup('a'):
    print link['href'] 
```

（那是 python，使用[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/) - 应该适用于大多数文件，无论格式是否正确）。

# silverlight - How to notify the user about binding errors in silverlight?

> ID：665973
> 
> 赞同：0
> 
> 时间：2009-03-20T12:41:53.577
> 
> 标签：silverlight, data-binding, exception

To my understanding, binding errors are displayed only during debug mode in Visual Studio's Output window. However, I want to know about broken bindings when the user runs my app, and I want to notify him that something is not working quite right.

Is there a way to handle binding exceptions from code, when the datacontext is set, and some bindings are broken?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-13T13:00:33.640

可以在所有属性设置器中捕获所有 Silverlight 绑定异常。见[这里](https://stackoverflow.com/a/23624349/901333)。

# c# - 在 javascript 中访问 C# 变量

> ID：665995
> 
> 赞同：4
> 
> 时间：2009-03-20T12:48:51.737
> 
> 标签：c#, asp.net, javascript

我打算用 C#.NET 为 DMS（教育领域）设计一个网站，我是新手。

根据`accessright`.

`accessright`存储在数据库表中作为 SQL 服务器中的`login`一个属性，我想将其检索`accessright`到一个 C# 变量并希望在 JavaScript 中访问该变量。

如果有另一种可能的方法，请告诉。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-03-20T13:15:34.667

好吧，我们在 ASP 时代曾经使用过一个快捷方式，这仍然适用于 ASP.NET
在页面代码隐藏中声明一个公共属性说`public int MyInteger`
在 aspx 中放这个

```
<script>
    function GetMyValue()
    {
     var someVar = <%=this.MyInteger%>;
     //Do something
    }
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-16T07:26:29.133

我在将服务器 silde 变量传递给 Javascript 变量的问题中发现了这一点。最好的方法是使用`eval()`javascript 方法：

```
function GetMyValue(){      
    eval("var someVar = " + parseInt<%=this.MyInteger%>"));
    //Do something     
} 
```

使用它并享受它。;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-20T13:01:35.823

这是我快速搜索的示例代码。[http://www.eggheadcafe.com/community/aspnet/7/63763/using-c-variable-in-java.aspx](http://www.eggheadcafe.com/community/aspnet/7/63763/using-c-variable-in-java.aspx)它应该为您指明正确的方向。strvariable 是您的 C# 变量。

```
 <INPUT id="hd" style="Z-INDEX: 101; LEFT: 16px; POSITION: absolute; TOP: 144px" type="hidden"  value="<%=strvariable %>">

<script language="javascript">
function Button_Click()
{
    alert(document.getElementById('hd').value); 
}
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-20T13:44:05.737

在我们的代码库中，我们实现了一项名为[RemoteInvoke](http://www.atalasoft.com/cs/blogs/support/archive/2008/11/21/remoteinvokes-invoke-remotely.aspx)的技术，通过这种技术，javascript 可以调用服务器上的方法而无需回发。实际上，它是在服务器端具有动态绑定的名称调用。

方法的名称及其 javascript 参数被捆绑并传递给服务器，服务器展开它们并找到要调用的最佳匹配方法。规则是您只能调用具有 RemoteInvokable 属性的方法，并且允许的数据类型是数字、字符串和布尔值。处理调用委托的代码将在可能的情况下进行近似匹配的签名匹配（即，如果您将浮点数作为 arg 传递，它将支持具有该名称和签名的方法，但如果没有，它将找到一个具有匹配的积分参数。

访问服务器端变量可以通过 RemoteInvoke 实现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-20T12:57:53.807

您不能在客户端代码中访问服务器端变量。唯一的方法是使用 AJAX 库或将变量作为客户端脚本注入页面。

像这样将变量的值注入页面：

```
string script = string.Format("var myVariable = '{0}';", vaiable.ToString());
if (!ClientScript.IsClientScriptBlockRegistered("myScript"))
{
    ClientScript.RegisterClientScriptBlock(typeof(_Default), "myScript", script, true);
} 
```

并在您的 javascript 函数中使用**myVariable**作为您的服务器端变量。

但我认为你应该从[客户端或服务器端的](http://websiteowner.info/articles/cgi/whichside.asp)概念开始。

# twitter - Twitter 应用程序开发最佳实践？

> ID：665997
> 
> 赞同：7
> 
> 时间：2009-03-20T12:49:45.807
> 
> 标签：twitter

让我们想象一下应用程序，它不仅仅是发布推文的另一种方式，而是类似于聚合器的东西，需要存储/访问通过t发布的推文。

由于 twitter 为 API 调用添加了限制，应用程序应该/可能使用一些缓存，然后它应该定期检查推文是否没有被删除等。

你如何管理限制？您如何看待没有列入白名单的优质流量应用程序？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-20T12:57:04.713

仅举几例。

*   积极缓存。除非必须，否则不要调用 API。
    *   我通常会提前尽可能多地提取数据并将其存储在某个地方。然后我在本地商店经营，直到它用完并需要刷新。
*   避免实时做事。将请求排队并在计时器上进行。
    *   如果你在 Linux 上，cronjobs 是最简单的方法。
*   尽可能组合请求。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-20T12:58:31.027

好吧，您每小时有 100 个请求，所以问题是您如何在各种类型的请求之间进行平衡。我认为最好的选择是[TweetDeck](http://www.tweetdeck.com/)的方式，它允许您设置百分比并保存其余的 % 以供发布（因为这也很重要）：（ [来源：][[livefilestore.com](https://5ctkwq.bay.livefilestore.com/y1p9A3s3ZGSYGPv3lWttZ_rjLNsk2ZscORZSNekSOjq0r5SmR_hGs2jhIz3LOb458Qw-_HbiUp2Lf1JrP4RB3C--Q/twitter01.png)][）][![替代文字](https://i.stack.imgur.com/o3GEZ.png)](https://i.stack.imgur.com/o3GEZ.png)

围绕缓存建立一个数据库会很好，我会忽略已删除的数据库——一旦你下载了推文，它是否被删除就无关紧要了。如果您愿意，理论上您可以尝试打开带有推文的页面，如果您收到 404，则它已被删除。这意味着 API 没有成本。`********