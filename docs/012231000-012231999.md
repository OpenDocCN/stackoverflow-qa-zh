# StackOverflow 问答 12231000-12231999

# facebook-like - 喜欢打字板上的固定链接？

> ID：12231001
> 
> 赞同：-1
> 
> 时间：2012-09-01T20:06:34.427
> 
> 标签：facebook-like, blogs

我遇到了[http://blogs.salesforce.com](http://blogs.salesforce.com)的问题。喜欢按钮应该喜欢目标博客，但它实际上并没有在 facebook 上共享页面或为此做任何事情。

任何帮助是极大的赞赏。谢谢！埃里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T23:31:17.060

Eric，通过[调试器工具](https://developers.facebook.com/tools/debug/og/object?q=http://blogs.salesforce.com/company/2012/08/how-best-in-class-teams-win.html)
运行其中一篇博文显示 og:url 标记存在问题。它不能为空，并且应该指向一个有效的 url（当前 url），与描述相同。否则，博客上的“赞”将起作用，但无法在 Facebook 上共享。

# joomla - Joomla 投票不保存

> ID：12231003
> 
> 赞同：0
> 
> 时间：2012-09-01T20:07:07.513
> 
> 标签：joomla

我有一个我想不通的问题。当我启动该网站时，投票系统工作......但现在很多小时后它不再保存投票了。

我希望你们中的一些人已经尝试过相同的方法，或者对可能出现的问题有所了解。

你可以在我的网站上看到一篇文章：http: [//secretinvizimals.com/index.php/10-invizimals-the-lost-tribes/39-lizard-queen](http://secretinvizimals.com/index.php/10-invizimals-the-lost-tribes/39-lizard-queen)

BR

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:25:48.403

仅通过查看它并且无法访问代码很难判断，所以这些是我唯一可以建议的事情。

1.  确保您拥有最新的 Joomla 版本 (2.5.6)
2.  切换到默认的 Joomla 模板并再次尝试投票。
3.  安装 JDump 以查看它是否与 PHP 相关的问题。
4.  在子域上安装 Joomla 和您的模板的新副本，并在您安装每个扩展程序后，测试投票。

# netbeans - 320 x 240 netbeans 模拟器

> ID：12231004
> 
> 赞同：0
> 
> 时间：2012-09-01T20:07:08.207
> 
> 标签：netbeans, java-me, emulation, midp

有谁知道我在哪里可以得到一个用于[netbeans](http://www.netbeans.org)的 320 x 240 屏幕尺寸的 java me 模拟器，以及如何安装它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:29:54.463

您可以从 Internet 下载任何最新版本的 netbeans IDE。320 x 240 通常是模拟器的默认值。虽然您可以在

> 项目的属性-> 能力-> 屏幕高度/屏幕宽度。

# linkedin - LinkedIn 分享按钮与其计数区域不对齐

> ID：12231006
> 
> 赞同：2
> 
> 时间：2012-09-01T20:07:35.650
> 
> 标签：linkedin

有谁知道为什么 LinkedIn 共享按钮与其自己的计数框不对齐？

我的意思不是将它与 Facebook 或 Twitter 等其他共享按钮对齐。

LinkedIn 共享按钮未与其自己的计数器框对齐。

这里：[http ://www.bbi.net.br/galeria/gal1.html](http://www.bbi.net.br/galeria/gal1.html)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-10T12:58:56.907

我遇到了同样的问题，用萤火虫潜水更深一点，我发现我在导致问题的锚点上有一种风格。要修复它，请添加：

```
.IN-widget a { 
    font-size: 100%;
    color: inherit;
    line-height: 1;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T14:42:02.107

请检查您用于 jQuery 的版本是什么。由于 LinkedIn Button 也使用 jQuery 库，因此您自己的库可能会导致冲突。尝试使您的 jQuery 成为最新的。

也许有帮助： [https ://stackoverflow.com/questions/15388054/linkedin-button-goes-to-the-end-bottom-of-the-page](https://stackoverflow.com/questions/15388054/linkedin-button-goes-to-the-end-bottom-of-the-page)

祝你好运。

# forms - 如何通过表单中的索引访问会话 ArrayList？

> ID：12231009
> 
> 赞同：3
> 
> 时间：2012-09-01T20:07:48.410
> 
> 标签：forms, session, struts2, arraylist

我有一个 ArrayList 类型的会话变量。在 jsp 页面中，我需要通过索引访问它以动态创建表单，但是在提交表单后，我发现会话 ArrayList 的元素值没有改变。

这是我在 JSP 页面上尝试过的（我使用 struts2 框架）：

```
<s:iterator value="anotherArray" status="RowsIterator">
 <tr>
  <td>
   <s:iterator value="actionOptionsArray" status="iter">
    <s:radio
     name="#session.chosenActionsArray[%{#RowsIterator.index}]" <!-- The concerned line -->
     list="%{actionOptionsArray[#iter.index]}"
     value="#{actionOptionsArray[0]}"
     theme="simple" />
    <br>
   </s:iterator>
  </td>
  <!-- other fields--> 
 </tr>
</s:iterator> 
```

**anotherArray**和**#session.chosenActionsArray**具有相同的大小。

我想我错误地迭代它，但在我的情况下，按索引迭代它是一种义务。非常感谢你:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:57:58.090

您需要通过操作访问会话，会话可以从 jsp 访问，但不能通过这种方式直接从外部世界访问。

让您提交表单的操作来实现 SessionAware。我将为 ArrayList 创建一个 getter/setter 以及适当的验证，然后通过 execute 方法将这些值移动到会话中。我不喜欢将您的会话直接暴露给外界（为您的操作中的会话提供设置器）......如果您这样做，您需要注意您可能已经让恶意用户访问您的东西可能没想到。

**编辑**

假设您的操作中有一个名为“matrix”的字符串的 ArrayList 的 ArrayList……您可以通过以下方式迭代属性：

```
<s:iterator value="matrix">
  <s:iterator>
    <s:property/>
  </s:iterator>
</s:iterator> 
```

外部迭代器迭代“矩阵”，将每个实例推到值堆栈的顶部。默认情况下，内部迭代器将使用与属性标签相同的堆栈顶部的内容。将 tr's 和 td 元素放在正确的位置，您可以呈现表格。

要为输入元素（可能是隐藏元素）生成正确的名称属性，您可能希望它们采用矩阵 [i][j] 的形式，其中 i 和 j 是整数并定义适当的矩阵。正如您所做的那样使用迭代器的状态属性将是生成索引的好方法。

# java - 如何避免 Java 中的 else if 马拉松？

> ID：12231011
> 
> 赞同：2
> 
> 时间：2012-09-01T20:08:08.840
> 
> 标签：java, if-statement

我正在开始 Java 编程，并且我编写了一个程序来测试每个行星有多少颗卫星。这是一个只有四个行星的缩短版本。

```
import java.util.Scanner;
import java.util.Random;

public class one {
    public static void main(String args[]){
        //SET VARIABLES
        String zero="Mercury", one="Venus", two="Earth", three="Mars";
        //SET VARIABLES
        for (int x=1; x<=1000; x++){
            System.out.println("Moons");
            Random r = new Random();
            for (int y=1; y<=1; y++){
                int rI = r.nextInt(4);
                if (rI == 0){
                question(zero,0);
                }
                else if (rI == 1){
                question(one, 0);
                }
                else if (rI == 2){
                question(two, 1);
                }
                else if (rI == 3){
                question(three, 2);
                }
            }
        }
    }

    public static void question(String n, int num){
    Scanner input = new Scanner(System.in);
    System.out.print("How many moons does " + n + " have? ");
    int ans = input.nextInt();
    if (ans == num){
        System.out.println("Correct!");
    }
    else if (ans != num){
        System.out.println("Incorrect!");
        question(n, num);
    }
    }
} 
```

我将如何不必多次写“else if”？随着更多的陈述，这变得非常乏味。请记住，我是一个初学者，这段代码是关于我目前能力的限制。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T20:16:52.273

你可以像这样使用数组：

```
String[] planets = { "Mercury", "Venus", "Earth", "Mars" };
int moons[] = { 0, 0, 1, 2 }; 
```

并致电：

```
if (rI >= 0 && rI < planets.length) {
    question(planets[rI], moons[rI]);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T20:19:44.497

编写此代码的更好方法。它更具可读性，并且很容易进行任何更新。

```
import java.util.Scanner;
import java.util.Random;

public class one {
    public static void main(String args[]){
        //SET VARIABLES
        String planets []=new String[4];
        planets[0]="Mercury";
        planets[1]="Venus";
        planets[2]="Earth";
        planets[3]="Mars";
        int moons []=new int[4];
        moons[0]=0;
        moons[1]=0;
        moons[2]=1;
        moons[3]=2;
        //SET VARIABLES
        while(true){
            System.out.println("Moons");
            Random r = new Random();
            int rI = r.nextInt(4);
            question(planets[rI],moons[rI]);
        }
    }

    public static void question(String n, int num){
        Scanner input = new Scanner(System.in);
        System.out.print("How many moons does " + n + " have? ");
        int ans = input.nextInt();
        if (ans == num){
            System.out.println("Correct!");
        }
        else if (ans != num){
            System.out.println("Incorrect!");
            question(n, num);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T20:20:11.620

只要您的逻辑没有发展，您就可以使用 switch 或 if-else。否则你需要开始**面向对象编程**。为从 Planet 继承的每个行星创建一个类“Planet”和另一个类，并将行星特定信息添加到每个行星。然后，当您计划为行星添加更多问题时，您对未来有好处。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T20:16:15.977

看一下`switch`Java中的语句。这旨在帮助克服一个棘手的 if-elseif-elseif-elseif-else 块：

```
switch(rI){
    case 2: question(two, 1);
            break;
    case 3: question(three, 2);
            break;
    default: doSomethingClever(...);
} 
```

您可以使用其他一些清理方法，但是将那个 switch 块放在适当的位置可以解决您的初始评论。祝你好运。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-01T20:16:25.177

您可以尝试使用`switch`而不是长`if-else`梯。

有关`switch`阅读[java 文档的更多信息](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html)

在你的情况下，它可能是这样的：

```
switch (rI) {
    case 0:
        question(zero, 0);
        break;
    case 1:
        question(one, 0);
        break;
    case 2:
        question(two, 1);
        break;
    case 3:
        question(three, 2);
        break;
    default:
        break;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-01T20:16:32.687

您可以使用以下`[switch](http://en.wikipedia.org/wiki/Switch_statement)`关键字：

```
switch (rI) {
    case 0:
        question(zero, 0);
        break;
    case 1:
        question(one, 0);
        break;
    case 2:
        question(two, 1);
        break;
    case 3:
        question(three, 2);
        break;
    default:
        // do something
} 
```

`default`找不到匹配项时执行下面的代码。

您还可以使用[数组](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/arrays.html)：

```
String[] planets = new String[]{"Mercury", "Venus", "Earth", "Mars"};
int[] nums = new int[]{0, 0, 1, 2};
...
// in the loop:
question(planets[rI], nums[rI]); 
```

当然，还有其他方法可以解决这个问题，但我认为对于刚刚学习这些的人来说应该可以解决问题。但是，您可能想要研究的一件事（一旦您深入了解 Java）是 a 的概念`[Map](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html)`，很像 Python 中的字典。您可以维护一张将行星（字符串）映射到其拥有的卫星数量（int）的地图。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-01T20:35:26.557

我会从忘记那个向量开始，将行星和它们的卫星放在一个 POJO（普通旧 Java 对象）中，然后将这些对象放入数组中：

```
class Planet {

    int moons;
    String name;

    Planet(String name, int moons) {
         this.name = name;
         this.moons = moons;
    }

    public String getName() {
        return this.name;
    }

    public getMoons() {
        return this.moons;
    }

    public void question(){
        Scanner input = new Scanner(System.in);
        System.out.print("How many moons does " + this.name + " have? ");
        int ans = input.nextInt();
        if (ans == this.moons){
            System.out.println("Correct!");
        }
        else {
            System.out.println("Incorrect!");
        }
    }
}

public class one {
    public static void main(String args[]){
        //SET VARIABLES
        List<Planet> planets = new ArrayList<Planets>();
        Planet earth = new Planet("Earth", 1);
        // put other planets
        //SET VARIABLES
        for (int x=1; x<=1000; x++) {
            System.out.println("Moons");
            Random r = new Random();
            int rI = r.nextInt(planets.size());
            Planet p = planets.get(rI);
            p.question();
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-01T20:36:41.613

我更喜欢枚举而不是数组。请参阅此[枚举教程](http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html)（尤其是行星示例；））。为月球计数添加另一个字段（就像质量和半径一样）。

# objective-c - cocos2d ccTintTo，实现无限变化的颜色标签

> ID：12231012
> 
> 赞同：2
> 
> 时间：2012-09-01T20:08:09.783
> 
> 标签：objective-c, cocos2d-iphone

而不是在 HelloWorldLayer 的 init 方法中编写所有这些行：

```
 CCTintTo* tint1 = [CCTintTo actionWithDuration:2 red:255 green:0 blue:0];
 CCTintTo* tint2 = [CCTintTo actionWithDuration:2 red:0 green:0 blue:255];
 ....
 CCSequence* sequence = [CCSequence actions:tint1, tint2, nil];
 [label runAction:sequence]; 
```

我试图让标签永远改变颜色但卡住了：
我不知道在哪里放置相关命令+处理整数 x、y、z
我试图在更新方法中进行随机化过程，但没有任何访问标签，任何想法？

```
//  HelloWorldLayer.h
//  Essentials
//
//  Created by Steffen Itterheim on 14.07.10.
//  Copyright Steffen Itterheim 2010\. All rights reserved.
//

#import "cocos2d.h"

@interface HelloWorld : CCLayer

{
    CCTintTo* tint1;
    CCSequence* sequence1;
   // CCLabelTTF* label; even tried property
}

// returns a Scene that contains the HelloWorld as the only child
+(id) scene;

@end 
```

* * *

```
//
//  HelloWorldLayer.m
//  Essentials
//
//  Created by Steffen Itterheim on 14.07.10.
//  Copyright Steffen Itterheim 2010\. All rights reserved.
//

#import "HelloWorldScene.h"

#import "MenuScene.h"
 integer_t x;
 integer_t y;
 integer_t z;

@implementation HelloWorld

+(id) scene
{
    CCScene* scene = [CCScene node];
    CCLayer* layer = [HelloWorld node];
    [scene addChild:layer];
    return scene;
}

-(id) init
{
    if ((self = [super init]))
    {

        CCLOG(@"init %@", self);

        // enable touch input
        self.isTouchEnabled = YES;

        CGSize size = [[CCDirector sharedDirector] winSize];

        // add the "touch to continue" label
        CCLabelTTF* label = [CCLabelTTF labelWithString:@"Touch Screen For Awesome" fontName:@"AmericanTypewriter-Bold" fontSize:30];
        label.position = CGPointMake(size.width / 2, size.height / 8);
        [self addChild:label];

        [self schedule:@selector(update:) interval:1/60.0f];
/*
        tint1 = [CCTintTo actionWithDuration:2 red:x green:y blue:z];
        sequence1 = [CCSequence actions:tint1, nil ];
        id goaction=[CCRepeatForever actionWithAction:sequence1];
        [label runAction:goaction];

    */
   }
    return self;
}

-(void) registerWithTouchDispatcher
{
    // call the base implementation (default touch handler)
    [super registerWithTouchDispatcher];
    //[[CCTouchDispatcher sharedDispatcher] addTargetedDelegate:self priority:INT_MIN+1 swallowsTouches:YES];
}

-(void) update:(ccTime)delta
{

    x=(integer_t )(CCRANDOM_0_1()*255); y=(integer_t )(CCRANDOM_0_1()*255); z=(integer_t )(CCRANDOM_0_1()*255);
    tint1 = [CCTintTo actionWithDuration:2 red:x green:y blue:z ];
    sequence1 = [CCSequence actions:tint1, nil ];
    [HelloWorld.label runAction:goaction]; //property label not found on object of type 'HelloWorld'

}

// Touch Input Events
-(CGPoint) locationFromTouches:(NSSet *)touches
{
    UITouch *touch = [touches anyObject];
    CGPoint touchLocation = [touch locationInView: [touch view]];
    return [[CCDirector sharedDirector] convertToGL:touchLocation];
}

-(void) ccTouchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
}

-(void) ccTouchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    CGPoint location = [self locationFromTouches:touches];
    CCLOG(@"touch moved to: %.0f, %.0f", location.x, location.y);
}

-(void) ccTouchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    // the scene we want to see next
    CCScene* scene = [MenuScene scene];
    CCTransitionSlideInR* transitionScene = [CCTransitionSlideInR transitionWithDuration:3 scene:scene];
    [[CCDirector sharedDirector] replaceScene:transitionScene];

}

-(void) ccTouchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event
{

}

-(void) dealloc
{
    CCLOG(@"dealloc: %@", self);

    // always call [super dealloc] at the end of every dealloc method
    [super dealloc];
}
@end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T03:50:23.790

如果您希望每次的 tint 颜色是随机的，那么您不能`CCTintTo`直接在 inside中使用`CCRepeatForever`。您需要重新随机化每个`CCTintTo`操作的 RGB 值。因此，您需要使用 block 将随机化过程嵌入到动作中。方法如下：

```
// do this in init method

__block void (^changeTint)(CCNode*) = [[^(CCNode *node) {
    GLubyte x = (integer_t)(CCRANDOM_0_1()*255), y = (integer_t)(CCRANDOM_0_1()*255), z = (integer_t)(CCRANDOM_0_1()*255);
    [node runAction:[CCSequence actionOne:[CCTintTo actionWithDuration:2 red:x green:y blue:z]
                                      two:[CCCallBlockN actionWithBlock:changeTint]]];
} copy] autorelease];

changeTint(label); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T02:46:03.037

你应该看`CCRepeatForever`行动。顾名思义，它将永远重复它所指向的动作。因此，您应该删除更改颜色的更新方法，并返回`CCSequence`您拥有的代码，并将其嵌入到`CCRepeatForever`操作中：

```
CCTintTo* tint1 = [CCTintTo actionWithDuration:2 red:255 green:0 blue:0];
CCTintTo* tint2 = [CCTintTo actionWithDuration:2 red:0 green:0 blue:255];
....
CCSequence* sequence = [CCSequence actions:tint1, tint2, nil];
CCAction* repeat  = [CCRepeatForever actionWithAction:sequence];
[label runAction:repeat]; 
```

# java - Apache POI 格式问题

> ID：12231018
> 
> 赞同：0
> 
> 时间：2012-09-01T20:08:49.167
> 
> 标签：java, apache-poi

我想知道是否有人可以帮助我弄清楚为什么当我阅读 .doc 文件时我的文本没有对齐。到目前为止，在我的代码中，我使用的是 WordExtractor，但我遇到了格式问题，内容排列不正确。这是我使用 Java 1.7 编写的代码。

```
public class Doc {
 File docFile = null;
 WordExtractor docExtractor = null ;
 WordExtractor exprExtractor = null ;
 public void read(){
  docFile = new File("blue.doc");
   try{
     FileInputStream fis = new FileInputStream(docFile.getAbsolutePath());
     HWPFDocument doc=new HWPFDocument(fis);
     docExtractor = new WordExtractor(doc);
     }catch(Exception e){
     System.out.println(e.getMessage());
  }

 System.out.println(docExtractor.getText());

  }
 } 
```

程序如何显示文档。

```
 A                                                                      E
I'm stuck in Folsom Prison, and time keeps draggin on. 
```

它应该像这样显示

```
 A                                              E
 I'm stuck in Folsom Prison, and time keeps draggin on. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:58:44.797

当然，这是行不通的。您正在将文档文件的内容提取到字符串变量中（这会将格式扭曲为段落等文档）。此外，您将文本打印到控制台，然后您希望它看起来与 Microsoft Word 中的完全一样？

接下来，你应该想想你想做什么。假设您要验证文档的格式和内容，我的回答如下。使用将文档转换为纯文本`getText()`将为您提供扭曲格式的文档内容，这对您没有帮助。通过使用 POI 库，您应该尝试访问文档中的每个段落和表格并验证/读取/写入您想要的任何内容。

`doc.getRange()`会给你一个 Range 对象。通过参考[http://poi.apache.org/apidocs/org/apache/poi/hwpf/usermodel/Range.html](http://poi.apache.org/apidocs/org/apache/poi/hwpf/usermodel/Range.html)来玩这个对象，您将能够访问文档中的所有段落、表格和部分。那应该可以帮助您通过程序编写word文档。

# java - java中检查数组元素是否填充

> ID：12231019
> 
> 赞同：5
> 
> 时间：2012-09-01T20:09:13.073
> 
> 标签：java, arrays

我正在开发一个包含 10 个元素（座位）的简单预订系统。我想检查是否设置了 1 到 5 的元素。如果是，则将元素设置为 6 到 10（反之亦然）。

一个元素不应被多次赋值。到目前为止我的代码。

```
 boolean[] seats = new boolean[10];

    Scanner input = new Scanner(System.in);
    System.out.print("Choose FirstClass(1) / Economy(2): ");
    int flightClass = input.nextInt();

    for (int j = 0; j < seats.length; j++) {
        System.out.println("\nEnter Seat Number: ");
        int enterSeat = input.nextInt();
        if (flightClass == 1) {
            if (enterSeat >= 0 && enterSeat <= 5) {
                System.out.println("You're in the First Class.");

                seats[enterSeat] = true;
                System.out.printf("You're Seat Number is %d\n", enterSeat);

            }

        } else if (flightClass == 2) {
            if (enterSeat >= 6 && enterSeat <= 10) {
                System.out.println("You're in the Economy.");

                seats[enterSeat] = true;
                System.out.printf("You're Seat Number is %d\n", enterSeat);
            }

        } 
```

我的问题：如何检查是否设置了 1 到 5 的元素，如果有，将元素设置为 6 到 10，反之亦然？

例如：

输入座位号 预定：1

输入座位号 预定：2

输入座位号 预定：3

输入座位号 预定：4

输入座位号 预定：5

所有头等舱座位（1-5）已设置完毕。现在剩下的座位是6-10。

输入座位号 预定：6等...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T20:17:38.640

Java ¹中的数组是从零开始索引的，而不是从一开始。因此，您检查`>=1`and的代码`<=10`应更改为`>=0`and `<=9`，或使用²

```
seats[enterSeat-1] 
```

代替

```
seats[enterSeat] 
```

要从子数组的元素中查找下一个可用元素，可以使用以下循环：

```
int firstFree = -1;
for (int j = 0 ; j != 5 ; i++) {
    if (!seat[j]) {
        firstFreeSeat = j;
        break;
    }
}
if (firstFreeSeat == -1) {
    System.out.printl("Sorry!");
} 
```

* * *

¹以及 C、C++、C#、Objective C 和许多其他语言

²如果您希望用户输入数字 1 到 10 而不是 0 到 9，这可能是您想要做的事情 - 这是座位编号的更自然选择。

# r - 大型数据集上的 reshape2 dcast 错误

> ID：12231020
> 
> 赞同：3
> 
> 时间：2012-09-01T20:09:25.337
> 
> 标签：r, reshape, reshape2

我有一个包含大约 1,800,000 行的 search_query[factor]、movie_name[factor]、clicks[int] 列的数据集。当我使用 reshape2 包中的 dcast 函数尝试从搜索查询和电影名称创建矩阵时，以 click 作为值，我收到此错误：

```
 train.matrix <- dcast(train, query ~ movie, value.var = "clicks")

    Aggregation function missing: defaulting to length
    Error in .Call("split_indices", index, group, as.integer(n)) : 
       negative length vectors are not allowed
    In addition: Warning message:
    In split_indices(seq_along(.value), .group, .n) :
      NAs introduced by coercion 
```

如果我将数据子集为 100,000 行，那么我可以从 reshape2 包中运行 dcast 就好了。

```
 train.matrix <- dcast(train[1:100000,], query ~ movie, value.var = "clicks") 
```

电影的值为 69,598，点击值都是正数，没有 NA。运行 R 的 2.15.1 版本。

可能是什么问题，数据集是否太大？如果是这样，我怎样才能用这个数据集实现相同的结果？

提前非常感谢！

# node.js - 将 Express 2.0 升级到 3.0 项目

> ID：12231024
> 
> 赞同：2
> 
> 时间：2012-09-01T20:10:38.250
> 
> 标签：node.js, express

我对节点编程有点陌生，并试图遵循一些教程。它们几乎都是为 2.5.x 编写的。我已经阅读了Express 的[迁移页面](https://github.com/visionmedia/express/wiki/Migrating-from-2.x-to-3.x)，但是对于新手来说没有明确的工作示例。我的问题是针对以下领域：

*   req.flash()
*   布局和局部
*   动态助手

对于“旧方式”与“新方式”示例，而不仅仅是片段或其他模块，以使旧版本代码仍然有效，因为我想使用新的 Express 工作方式。提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T20:32:26.837

正如您已经找到了旧方式的示例，这里是“新”方式：

**'新' req.flash：**

```
// insert in app.js as middleware, after express.static
app.use(function(req, res, next) {
  var msgs = req.session.messages || [];
  res.locals({
    messages: msgs,
    hasMessages: !! msgs.length
  });
  req.session.messages = [];
  next();
});

// save a message
res.message('error', 'message');

// output
<% if (hasMessages) { %>
  <ul id="messages">
    <% messages.forEach(function(msg){ %>
      <li class="<%= msg.type %>"><%= msg.msg %></li>
    <% }) %>
  </ul>
<% } %> 
```

**'新部分'：**

```
// install
npm install express-partials

// app.js
var partials = require('express-partials');
app.use(partials());

// usage
<%- body %> 
```

**“新”动态助手：**

```
// middleware
app.use(function(req, res, next) {
  res.locals.user = req.user;
  next();
});

// usage
<%= user %> 
```

# objective-c - openssl 等效于 AES256EncryptWithKey 方法

> ID：12231033
> 
> 赞同：2
> 
> 时间：2012-09-01T20:12:16.840
> 
> 标签：objective-c, command-line, openssl, aes, equivalent

如何使用命令行 openssl 获得与以下objective-c 加密方法相同的结果？

```
- (NSData *)AES256EncryptWithKey:(NSString *)key {
    NSData *returnData = nil;

    char keyPtr[kCCKeySizeAES256+1];
    bzero(keyPtr, sizeof(keyPtr));
    [key getCString:keyPtr maxLength:sizeof(keyPtr) encoding:NSUTF8StringEncoding];

    NSUInteger dataLength = [self length];
    size_t bufferSize = dataLength + kCCBlockSizeAES128;
    void *buffer = malloc(bufferSize);

    size_t numBytesEncrypted = 0;
    CCCryptorStatus cryptStatus = CCCrypt(kCCEncrypt,
                                          kCCAlgorithmAES128,
                                          kCCOptionPKCS7Padding | kCCOptionECBMode,
                                          keyPtr,
                                          kCCBlockSizeAES128,
                                          NULL,
                                          [self bytes],
                                          dataLength,
                                          buffer,
                                          bufferSize,
                                          &numBytesEncrypted);

    if (cryptStatus == kCCSuccess) {
        returnData  = [[NSData alloc] initWithBytes:buffer length:numBytesEncrypted];
    }

    free(buffer);

    return returnData;
} 
```

我尝试了以下方法（有和没有 -nosalt），但没有成功：

```
openssl aes-256-ecb -nosalt -in original.txt -out encrypted.txt
openssl aes-128-ecb -nosalt -in original.txt -out encrypted.txt 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T23:56:46.127

虽然有可能，但您不应该这样做。这个 ObjC 加密代码很破。它错误地创建了密钥，这就是为什么您在使用 OpenSSL 时遇到问题的原因（它也很差地创建了密钥，但更好，并且以不同的方式）。如果您想要与 OpenSSL 兼容的 ObjC 加密模块，请参阅旨在处理此问题的[RNCryptor 。](https://github.com/rnapier/RNCryptor)如果可能的话，我会避免使用 OpenSSL，但目前没有我推荐的简单命令行替代品。

请参阅 RNCryptor 的文档了解为什么这个 ObjC 代码被破坏，以及 OpenSSl 的 aes 加密例程的问题。

# ruby-on-rails - 来自 Safari 扩展的 Rails 设计 401

> ID：12231035
> 
> 赞同：0
> 
> 时间：2012-09-01T20:12:26.890
> 
> 标签：ruby-on-rails, ruby, ajax, safari-extension

我正在尝试向本地运行的 Rails 应用程序发出一个简单的 $.ajax 请求。

该请求在控制台没有任何问题，但是当我从 safari 扩展程序进行调用时，应用程序返回 401 Unauthorized。我不确定是否需要为每个用户创建一个 api 令牌并将其传递到 url 字符串中以进行身份​​验证，或者即使我已登录，devise 也没有处理请求是否有一个简单的原因。我的猜测是罪魁祸首是我的控制器上的前置过滤器，它看起来像这样：

```
before_filter: authenticate_user! 
```

但是，当我登录应用程序时，我再次收到 401。仅供参考，这是我从扩展中拨打的电话：

```
$.ajax({                                                                                                                                                                                                        
                type: 'GET',                                                                                                                                                                                                 
                url: 'http://localhost:3000/playlists.json?callback=?,                                                                                                                                              
                dataType: 'jsonp',                                                                                                                                                                                                
                success: function(data) { console.log(data); },                                                                                                                                                                                       
                error: function() { console.log('Uh Oh!'); },
                jsonp: 'jsonp', 
                crossdomain: true                                                                                                                                               
            }); 
```

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T21:02:40.353

好的，想通了。正在设置的 cookie 设置为在“会话”之后过期，这基本上意味着一旦您离开页面，会话就不再存在。因此，扩展程序无权访问此扩展程序 cookie。关键是在会话 cookie 上默认设置过期日期，您可以在 config/initializers/session_store.rb 中这样做：

```
 YourApp::Application.config.session_store :cookie_store, { 
    :key => '_yourapp_session',
    :expire_after => 60*24*60*60
} 
```

您可以在此处阅读有关 cookie 类型的更多信息：[http ://en.wikipedia.org/wiki/HTTP_cookie#Session_cookie](http://en.wikipedia.org/wiki/HTTP_cookie#Session_cookie)

# java - 如果我让字符串引用转义，这会阻止包含对象被垃圾收集吗？

> ID：12231040
> 
> 赞同：0
> 
> 时间：2012-09-01T20:13:49.877
> 
> 标签：java, garbage-collection

假设我有一个包含如下字符串的对象：

```
class SomeObject  {
   private final String s;
   private final int i;

   SomeObject(String s, int i) {
      this.s = s;
      this.i = i;
   }

   String getString() {
      return s;
   }
} 
```

因此，如果我只使用没有 的引用`SomeObject`，例如我用来构建另一个对象并且我不需要`i`任何其他可能的字段，它会被垃圾收集吗？

编辑：我很抱歉不清楚。假设我有一个名为 someObject 的 SomeObject 实例，如果我让 s 引用使用 getString() 方法转义，即 someObject.getString() 并使用返回的引用来构建其他对象，例如不是 SomeObject 实例， someObject 是否可以被垃圾收集？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T20:16:27.787

我想你指的是`s`？是的，实例`SomeObject`将免费用于垃圾收集。The`String`没有引用`SomeObject`它的来源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T20:26:55.437

`getString()`会返回`s`，但不会从当前的`SomeObject`. 如果一个值`x`被分配给`s`

```
s = x; 
```

`x``y`如果您分配一个新值，只会被垃圾收集`s`

```
s = y; 
```

并且没有提到`x`left。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-01T20:36:28.040

让我问你一下。

```
final class Foo {
  String value = "initial";
} 
```

假设您执行如下代码...

```
final Foo foo = new Foo();
final String val = foo.value;
foo.value = "replaced"; 
```

现在，你认为`val`现在会相等`"replaced"`吗？希望不会，因为它不会；看来您对参考是什么有一些误解。使用`val = foo.value`，您将字段的值复制`foo.value`到`val`; 该值是对字符串的引用`"initial"`。它*不是*对该字段的引用`foo.value`。坚持对 to 的引用`"initial"`并不能防止`foo`被垃圾收集。

# sql - SQL 更新函数不会抛出任何错误消息，但它不会返回任何行

> ID：12231042
> 
> 赞同：0
> 
> 时间：2012-09-01T20:14:07.030
> 
> 标签：sql

我正在尝试从另一个表更新表值。我想从`pstatus`更新`productcode`。

这是我的代码（没有错误并且结果为 0 行）：

```
UPDATE pstatus
SET code=(select code FROM productcode) 
```

除此之外，我无法在 sql 中重新运行任何更新 - 它没有给出错误，但返回 0 行（我在表中有超过 5 行`productcode`）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:21:32.773

更新语句不返回行。你应该使用更多类似的东西

```
Update pstatus
   Set code=a.code
  from productcode a
 where a.*somekeyfield* = *value* 
```

您必须确定您希望使用 productcode 中的哪条记录作为更新的基础。*somekeyfield*应该是什么是您需要确定的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T20:24:43.100

更新语句不添加记录，它只更新表中已经存在的记录。

该`update`查询确实更新了表中的所有记录，但由于没有记录，更新的记录数为零。

如果要添加记录，则应`insert`改为使用查询：

```
insert into pstatus (code)
select code from productcode 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T20:27:40.633

在这种情况下，您有两个问题

1.  你说如果表中没有记录，你在 pstatus 中没有任何行，如何更新表行？

2.  您的内部查询`select code FROM productcode`返回多于一行然后 sql 如何决定在哪个字段中设置值？

# python - 如何使用 Oauth 在 django 的 Twitter 上更新状态

> ID：12231043
> 
> 赞同：0
> 
> 时间：2012-09-01T20:14:21.943
> 
> 标签：python, django, twitter, oauth-2.0

感谢 omab 的 social_auth 项目，我添加了我的网站 twitter 登录。它运作良好。

但我想让经过身份验证的用户在我的网站上分享推特成为可能。

我该怎么做这个要求？

任何帮助和想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:48:30.747

我不确定`social_auth`，但`django-allauth`在每次登录时存储（和更新）令牌，在：

[https://github.com/pennersr/django-allauth/blob/master/allauth/socialaccount/models.py#L82](https://github.com/pennersr/django-allauth/blob/master/allauth/socialaccount/models.py#L82)

然后只需将该令牌提供给例如`Tweepy`（http://tweepy.github.com），以便代表用户发布推文。

# jsp - 如何使用 Twitter api 知道用户在 jsp servlet 中的位置

> ID：12231044
> 
> 赞同：0
> 
> 时间：2012-09-01T20:14:30.057
> 
> 标签：jsp, servlets, twitter

我想使用 Twitter API 来了解用户的位置。我正在使用 jsp，但无法了解如何调用 Twitter API。请问有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T21:03:51.187

**查询单个用户**时可以找到用户的位置：

[https://dev.twitter.com/docs/api/1/get/users/show](https://dev.twitter.com/docs/api/1/get/users/show)

或者在查询**多个用户**时：

[https://dev.twitter.com/docs/api/1/get/users/lookup](https://dev.twitter.com/docs/api/1/get/users/lookup)

为了通过您的 JSP 获取此数据，您可以使用**JSON 或 XML 解析器**。如果您正在寻找**图书馆**，请在此处查看：

[http://dev.twitter.com/pages/libraries#java](http://dev.twitter.com/pages/libraries#java)

# html - W3C Widgets 死了吗？

> ID：12231045
> 
> 赞同：9
> 
> 时间：2012-09-01T20:14:43.740
> 
> 标签：html, web-applications, w3c, application-cache, web-widget

最近有人指导我查看 W3C 小部件规范：

[http://www.w3.org/TR/widgets/](http://www.w3.org/TR/widgets/)

开发人员可以通过浏览器的应用程序缓存使 Web 应用程序脱机工作。我曾问过用户应该如何知道他们可以离线使用某些网站，这是该人提出小部件规范的时候。将应用程序的包装与其离线存储能力分开是有意义的。然而，在谷歌搜索和阅读小部件之后，我找不到任何关于该主题的最新文章（大多数文章似乎来自 2010 年左右）。最终我找到了 Opera 的 SDK，但一开始有一条消息表明他们正在删除该功能：

> 从 Opera 12 开始，Opera Widgets 将对新用户关闭，并在以后的版本中完全删除。
> 
> 来源：[http ://dev.opera.com/articles/view/creating-your-first-opera-widget/](http://dev.opera.com/articles/view/creating-your-first-opera-widget/)

W3C 小部件是一种死技术吗？如果是这样，是否有任何跨浏览器技术正在开发用于 Web 应用程序的打包？我很好奇，因为我认为离线存储很有趣，但不知道用户如何知道即使他们没有互联网连接，他们也可以浏览到特定的 URL 并让它工作，除非浏览器告诉他们他们安装了哪些应用程序（或者除非每个支持离线存储的网站都向他们解释过）。

# python - Django：管理登录页面重定向到自身

> ID：12231053
> 
> 赞同：0
> 
> 时间：2012-09-01T20:16:15.817
> 
> 标签：python, django, django-admin

我有一个奇怪的问题。我有一个带有管理部分的标准 django 1.4 网站。

本地一切正常，但是当我在线部署时，第一次登录到管理部分后，它就可以工作了。我注销然后再次登录，然后我被重定向到同一个登录页面！

如果我使用不正确的凭据登录，那么肯定会显示正确的错误。如果我重新启动 apache 生产服务器，那么登录/注销到管理部分只能工作一次，然后从那时起每次登录都会产生同样的问题。

有没有人有过这个？它与cookies或缓存问题有关吗？

注意：该应用只有一个 url 重定向到管理员，没有其他视图。生产也是使用http而不是https。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T23:37:42.970

好吧，另一个！TEMPLATE_DIRS 条目中的 setting.py 文件中存在拼写错误。这似乎是问题的根源。

# php - JavaScript 到 PHP 时间戳失败，增加了大约一个半月的时间

> ID：12231062
> 
> 赞同：4
> 
> 时间：2012-09-01T20:16:53.200
> 
> 标签：php, javascript, jquery, datetime, timestamp

好的，我试图将 javascript 时间戳转换为 php 等价物，我已经在堆栈上浏览了这里的帖子以获得一个体面的答案以及其他各种网站，所以尽管知道我可能会否决选票，但这个问题是最后的努力，有人告诉我这只是来自其他地方的欺骗问题。所以尽管如此..

这是我迄今为止的一次尝试失败。请注意我使用的是 jQuery，因此没有冲突，`j`而不是`$`

```
var yr = j('#time_year :selected').val();//year
var mn = j('#time_month :selected').val();//month
var dy = j('#time_day :selected').val();//day
var hr = j('#time_hour :selected').val();//hour
var min = j('#time_minute :selected').val();//minute
var sc = j('#time_second :selected').val();//second

if(j('#time_ampm :selected').val() == 12 && j('#time_hour :selected').val() < 12){hr = j('#time_hour :selected').val()+12;}
if(j('#time_ampm :selected').val() == 0 && j('#time_hour :selected').val() == 12){hr = 0;}

var theDate = new Date(yr, mn, dy, hr, min, sc).getTime();
setTimeStamps(theDate);
j('#timestamp_now_js').html(" "+theTime);
j('#timestamp_now_php').html(" "+Math.round(theTime / 1000)); 
```

顶部的选择值基于[Mozilla.org 日期参考](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date?redirectlocale=en-US&redirectslug=Core_JavaScript_1.5_Reference/Objects/Date)，使用 0-nn 描述。am/pm if-else 本质上是为了在所选时间上增加 12 小时，因为网站上显示的时间是 12 小时格式。Javascript 使用 24 小时制。如果选择 am 并使用 12，它也会将 12 转换为 0 以匹配 24 小时格式概念。

目前似乎正在发生的事情是，尽管它似乎有效，但当我运行通过 php`date()`函数给出的时间戳时，它显示的日期大约是一个月 2 周和几天是我正在测试的日期，这是相当于现在

我会创建一个包含整个 html 的 jsFiddle，但我使用 php 来生成我的选择框。因此，如果您想查看我的“实时”内容，请访问[http://7pz.net/timestamps.php](http://7pz.net/timestamps.php)，因为这就是我正在测试这个概念的地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T20:28:10.757

这是因为在 Javascript 的`Date`对象中，月份范围是 0-11，而不是 1-12。这是“月”部分。试试这个：

```
var mn = j('#time_month :selected').val() - 1; //month 
```

或者更好的是，生成`<option>`值从 0 到 11 的 s。

另外，这个声明：

```
hr = j('#time_hour :selected').val()+12; 
```

请记住，这`j('#time_hour :selected').val()`是一个*字符串*，而不是数字，因此您必须在添加 12 之前对其进行转换，否则您会得到类似`"0412"`. 您正在创建一个小时数设置为 412 的日期，即 17 天零 4 小时。天数增加了 17 天。

像这样修复它：

```
hr = +j('#time_hour :selected').val() + 12; 
```

我使用了[加一元运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Arithmetic_Operators#.2B_%28Unary_Plus%29)。

（PS：你的代码还有很大的改进空间，从可读性和 jQuery 对象缓存开始。在习惯一些不好的做法之前，花一些时间提高你的 Javascript 编码技能。）

# android - 如何在内部存储中存储和读取整数

> ID：12231064
> 
> 赞同：0
> 
> 时间：2012-09-01T20:16:58.157
> 
> 标签：android, int, storage, internal

过去几个小时我一直在研究如何在内部存储器中存储数据，但是由于某种原因我不能存储整数。

我想知道如何在文件中存储一个 int 值以及如何读取它。请提供一个简短的示例，说明我如何实现这一点，是否最好使用 SharedPreferences 类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:22:42.353

是的，我认为`SharedPreferences`这是最简单的方法：

```
SharedPrefrences prefs=PreferenceManager.getDefaultSharedPreferences(context);
Editor editor=prefs.edit();
editor.putInt("MYINT",intValue);
editor.commit(); 
```

要检索`int`使用：

```
PreferenceManger.getDefaultSharedPreferences(context).getInt("MYINT",-1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T20:23:25.343

如果它只是一个 int 值，最好使用[SharedPreference ：](http://developer.android.com/guide/topics/data/data-storage.html#pref)

```
public int getValue() {
    SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
    return prefs.getInt("value_key", 0);
}

public void setValue(int newValue) {
    SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
    SharedPreferences.Editor editor = prefs.edit();
    editor.putInt("value_key", newValue);
    editor.commit();
} 
```

# jquery - 平滑滚动 jQuery 不适用于我的绝对定位按钮

> ID：12231065
> 
> 赞同：0
> 
> 时间：2012-09-01T20:17:05.103
> 
> 标签：jquery, html, smooth-scrolling

我目前在我的主导航上使用 JS SmoothScroll 在一个单页网站上顺畅地导航。您可以在主导航上[看到](http://www.jamesperrett.co.uk/testsite)它工作正常。通过将 class="scroll" 添加到链接来调用它。脚本可以在[这里](http://www.jamesperrett.co.uk/testsite/js/smoothscroll.js)看到。

我正在尝试为我的“返回顶部”功能使用相同的 javascript。目前，返回顶部功能运行良好，但它只是“捕捉”到顶部，所以我希望它像我的其他导航一样滚动。

但是，当我将 class="scroll" 添加到该链接时，它完全停止工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:19:40.590

您链接到的 jQuery 脚本只会滚动到一个元素`name`，并且您使用的是`id`. 修改脚本以通过 滚动到元素`id`，或者将顶部元素更改为具有 a `name`。

```
$('[name="'+this.hash.substring(1)+'"]') //Select elements by name 
```

请注意，`name`通常不赞成将属性用作锚点，因此我建议更新 jQuery 以使用`id`，并更新页面上的所有其他锚点以使其也具有`id`属性。

# php - Facebook API 时区

> ID：12231066
> 
> 赞同：0
> 
> 时间：2012-09-01T20:17:23.677
> 
> 标签：php, facebook, facebook-graph-api

我使用以下代码将过去事件的列表记录到 Facebook 粉丝页面的墙上：

```
$args = array(
    'title'     => $info,
    'description'   => $info,
    'start_time'    => $year.'-'.$month.'-'.$day,
    'access_token'  => $access_token
);
$milestone_id = $facebook->api("/$USER_ID/milestones", "post", $args); 
```

它工作正常。但是，当我查看粉丝页面时，我发现所有里程碑的日期都提前了一天。如果我记录一个日期为 2012-08-06 的里程碑，我会看到这个里程碑的日期是 2012 年 8 月 5 日。

我应该在记录里程碑时传递时区偏移量吗？或者以其他格式给出日期？

由于它们是过去的历史事件，我希望世界上的每个人都在同一日期看到这些事件。向欧洲人和美国人展示不同的日期是没有意义的。

# spotify - 可以在没有 Spotify 帐户的情况下使用 cocoalibspotify 元数据方法吗？

> ID：12231074
> 
> 赞同：1
> 
> 时间：2012-09-01T20:18:58.513
> 
> 标签：spotify, cocoalibspotify-2.0

这似乎是在一年前最后一次在这里解决： [Accessing Spotify Metadata API from inside a Spotify app?](https://stackoverflow.com/questions/8408581/accessing-spotify-metadata-api-from-within-a-spotify-app)

从那时起，cocoalibspotify API 似乎已经做了很多工作，但有人可以确认我们仍然必须在 iOS 中使用[Spotify Web API](https://developer.spotify.com/technologies/web-api/)，以便没有 Spotify 帐户的用户能够搜索和查看专辑的元数据和艺术家？

当用户通过 API 登录时（使用 [SPSession attemptLoginWithUserName]），一切似乎都正常工作，但是当在 SPTrack 上执行例如 [SPAsyncLoading waitUntilLoaded] 时，除非您登录，否则它会超时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T10:14:25.753

不，要让 CocoaLibSpotify 正常工作，您需要有一个登录用户。Web API 是在没有此功能的情况下访问元数据的唯一方法。

# android - 下拉 ListView 时显示 TextView

> ID：12231075
> 
> 赞同：1
> 
> 时间：2012-09-01T20:19:01.433
> 
> 标签：android

我不确定这是否可能，但我想显示一个位于 ListView 顶部但未显示的 TextView，当我拉下 ListView 时，TextView 会显示自己，如果我放手 TextView 再次隐藏。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T20:48:37.097

实现这一目标的唯一方法是使用自定义视图或构建您的视图。ListView 不支持此功能。

如果您考虑使用自定义视图，那么您应该查看这个[Android-PullToRefresh](https://github.com/chrisbanes/Android-PullToRefresh)小部件。它：

*   支持 ListView、ExpandableListView GridView 和 WebView！
*   由伟大的应用程序使用，例如：Friendcaster、TweetCaster、Plume 和 The Verge。
*   支持下拉和上拉。
*   非常可定制。

# ruby - Ruby 每个循环 x 到变量替换

> ID：12231076
> 
> 赞同：0
> 
> 时间：2012-09-01T20:19:02.417
> 
> 标签：ruby, variables, loops, each, variable-substitution

```
<% @parts.each do|x| %>

<% @bbb = Relation.where(part: "#{x}") %>
<%= **@"#{x}"** = @bbb.collect {|x| x.car} %>

<% end %> 
```

我正在尝试将第 3 行中的变量设置为 x 部分值 @"#{x}"。我找不到正确的语法。我知道 send(x) 和 x.to_sym。但我需要知道如何将每个循环中的 x 设置为带有 @ 的 @variable。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T20:42:22.080

所以你正在寻找 instance_variable_set

`instance_variable_set "@#{x}", @bbb.collect { |x| x.car }`

但这可能不是处理此问题的最佳方法。没有看到使用它的代码，很难说，但也许考虑将结果放入哈希中：`result[x] = @bbb.collect { |x| x.car }`

另请注意，`"#{x}"`与`x.to_s`

此外，最好避免直接在视图中查询模型（假设您在这里使用 Rails，因为您似乎在使用 ActiveRecord），因为它将演示与代码混合在一起（您不能将它们作为单独的部分。它有一个变得非常丑陋的趋势），它将您的视图与您最初拥有的一个用例结合起来（即使应该以相同的方式呈现，也不能在同一视图中呈现不同的数据）。考虑将此代码移动到您的控制器（甚至是其他负责管理此数据查询的对象中，让您的控制器职责仅处理请求。

# java - 使用滚动窗格

> ID：12231087
> 
> 赞同：1
> 
> 时间：2012-09-01T20:20:45.393
> 
> 标签：java, swing, scrollpane

我正在尝试让滚动条工作。

代码显示我选择的图像。而且我刚刚（在stackoverflow上）阅读了有关将图像添加到面板，然后将面板添加到滚动窗格，以及将滚动窗格添加到框架的信息。所以我试着这样做。

但我仍然无法显示滚动条。即使图像大于 JFrame 窗口。

任何人都可以帮忙吗？我试过重新验证，但它没有用，所以我把它拿出来了。

```
 import java.awt.*;
import java.io.File;
import java.io.IOException;

import javax.imageio.ImageIO;
import javax.swing.*;
import javax.swing.filechooser.FileNameExtensionFilter;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;

public class MakeResizedImage {
    private JFrame frame;
    private JFileChooser fc;
    private File file;
    private int r;
    private JTextField textField;
    private Image img;
    JScrollPane scrollPane;
    ImagePanel panel_2;

    public static void main(String[] args) {
        MakeResizedImage MRI = new MakeResizedImage();
        MRI.BuildJFrameGui();
    }

    private MakeResizedImage() {
    }

    private void BuildJFrameGui() {
        JPanel panel = new JPanel();
        panel.setLayout(null);

        frame = new JFrame("View/Resize a png, jpg or gif image");
        frame.setSize(400, 400);

        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setLocationRelativeTo(null);

        JPanel panel_1 = new JPanel();
        frame.getContentPane().add(panel_1, BorderLayout.NORTH);

        JLabel lblNewLabel = new JLabel("Image:");
        lblNewLabel.setHorizontalAlignment(SwingConstants.LEFT);
        panel_1.add(lblNewLabel);

        textField = new JTextField();
        panel_1.add(textField);
        textField.setColumns(10);

        JLabel lblNewLabel_1 = new JLabel("Width:");
        panel_1.add(lblNewLabel_1);

        Dimension Dim = new Dimension(45, 20);
        JSpinner spinner = new JSpinner();
        spinner.setModel(new SpinnerNumberModel(new Integer(0), new Integer(0),
                null, new Integer(1)));
        spinner.setPreferredSize(Dim);
        panel_1.add(spinner);

        JLabel lblHeight = new JLabel("Height:");
        panel_1.add(lblHeight);

        JSpinner spinner_1 = new JSpinner();
        spinner_1.setModel(new SpinnerNumberModel(new Integer(0),
                new Integer(0), null, new Integer(1)));
        spinner_1.setPreferredSize(Dim);
        panel_1.add(spinner_1);

        JPanel panel_3 = new JPanel();

        JButton btnNewButton = new JButton("Open");
        btnNewButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent arg0) {
                chooseFile();
            }
        });

        panel_3.add(btnNewButton);

        JButton btnNewButton_1 = new JButton("Cancel");
        btnNewButton_1.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent arg0) {
                System.exit(0);
            }
        });
        panel_3.add(btnNewButton_1);

        JButton btnSave = new JButton("Save");
        panel_3.add(btnSave);

        frame.getContentPane().add(panel_3, BorderLayout.SOUTH);

        scrollPane = new JScrollPane();
        frame.getContentPane().add(scrollPane, BorderLayout.CENTER);

        panel_2 = new ImagePanel();
        scrollPane.setViewportView(panel_2);

        frame.setVisible(true);
    }

    public void chooseFile() {
        if (aFileChosen()) {
            file = fc.getSelectedFile();
            if (file.exists()) {
                textField.setText(fc.getName());
                try {
                    img = ImageIO.read(file);
                    panel_2.setImg(img);
                } catch (IOException e) {
                }
            }
        } else
            JOptionPane.showMessageDialog(frame, "No file was chosen");
    }

    public boolean aFileChosen() {
        fc = new JFileChooser();
        FileNameExtensionFilter filter = new FileNameExtensionFilter(
                "PNG, JPG & GIF Images", "png", "jpg", "gif");
        fc.setFileFilter(filter);
        fc.setApproveButtonText("Choose");
        fc.setApproveButtonToolTipText("Selects the image you want to resize");
        r = fc.showOpenDialog(frame);
        if (r == JFileChooser.APPROVE_OPTION)
            return true;
        return false;
    }

    class ImagePanel extends JPanel {

        private static final long serialVersionUID = 1L;
        private Image img;

        ImagePanel() {
        };

        ImagePanel(Image img) {
            this.img = img;
        }

        public void setImg(Image img) {
            this.img = img;

            repaint();
        }

        @Override
        public Dimension getPreferredSize() {
            return (new Dimension(300, 300));
        }

        @Override
        public void paintComponent(Graphics g) {
            super.paintComponent(g);

            // Clears the previously drawn image.     
            g.clearRect(0, 0, getWidth(), getHeight());
            //and draws the new one...
            g.drawImage(img, 0, 0, this);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T20:29:42.270

使用另一个构造函数，即包装另一个组件的构造函数：[JScrollPane(Component)](http://docs.oracle.com/javase/7/docs/api/javax/swing/JScrollPane.html#JScrollPane%28java.awt.Component%29)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-28T10:02:18.273

```
 import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.FlowLayout;
import java.awt.Rectangle;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.SwingUtilities;
import javax.swing.table.DefaultTableModel;

/**
 * This Swing program demonstrates how to scroll a table row to visible area
 * programmatically.
 * @author www.codejava.net
 *
 */
public class JTableRowScrollingExample extends JFrame implements ActionListener {

    private JTable table = new JTable();
    private JLabel label = new JLabel("Row number: ");
    private JTextField fieldRowNumber = new JTextField(5);
    private JButton buttonScroll = new JButton("Scroll to");

    public JTableRowScrollingExample() {
        super("JTable Row Scrolling Example");

        String columnNames[] = {"No#", "Name", "Age", "Job"};
        String[][] data = {
                {"1", "John", "30", "Developer"},
                {"2", "Jane", "31", "Designer"},
                {"3", "Peter", "28", "Programmer"},
                {"4", "Mary", "35", "Consultant"},
                {"5", "Kim", "27", "Developer"},
                {"6", "Geogre", "32", "Leader"},
                {"7", "Dash", "36", "Analyst"},
                {"8", "Tim", "25", "Designer"},
                {"9", "Ana", "29", "Developer"},
                {"10", "Tom", "41", "Manager"},
                {"11", "Sam", "40", "Consultant"},
                {"12", "Patrick", "38", "Manager"},
                {"13", "Jeremy", "24", "Programmer"},
                {"14", "David", "25", "Programmer"},
                {"15", "Steve", "26", "Designer"},
        };

        DefaultTableModel model = new DefaultTableModel(data, columnNames);
        table.setModel(model);

        JScrollPane scrollpane = new JScrollPane(table);
        scrollpane.setPreferredSize(new Dimension(300, 150));

        add(scrollpane, BorderLayout.CENTER);

        JPanel panel = new JPanel();
        panel.setLayout(new FlowLayout());
        panel.add(label);
        panel.add(fieldRowNumber);
        panel.add(buttonScroll);

        add(panel, BorderLayout.NORTH);

        buttonScroll.addActionListener(this);

        pack();
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLocationRelativeTo(null);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new JTableRowScrollingExample().setVisible(true);
            }
        });
    }

    @Override
    public void actionPerformed(ActionEvent event) {
        int rowNumber = Integer.parseInt(fieldRowNumber.getText());
        Rectangle cellRect = table.getCellRect(rowNumber, 0, false);
        System.out.println(cellRect);
        table.scrollRectToVisible(cellRect);
    }

} 
```

# ios - 如何防止 WebView 裁剪 Web 内容？

> ID：12231089
> 
> 赞同：0
> 
> 时间：2012-09-01T20:21:03.280
> 
> 标签：ios, webview

我认为内容会换行以适合 WebView，但右侧被剪掉了。很抱歉问了这样一个菜鸟问题（WV 应该只是换行！）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:33:55.173

包装将在**HTML5 网页**中完成，因为它了解设备（PC 或移动设备）并相应地表现，对于其他人你需要特殊的网页，例如（**m.facebook.com**充当移动设备的界面和 www.facebook.com 用于 PC ）。

要在单屏 web 视图中显示完整屏幕（按比例缩小），请使用以下代码

```
yourWebView.scalesPageToFit = YES; 
```

# database - 设计实时统计系统时涉及哪些广泛的概念？

> ID：12231093
> 
> 赞同：0
> 
> 时间：2012-09-01T20:21:34.597
> 
> 标签：database, nosql, real-time

我需要为一个在线广告项目设计一个实时统计系统。我需要存储一个 url 的展示次数、点击次数、每次展示显示的关键字数量等计数器。流量可以假设为每秒大约 15000 次展示，但应该可以扩展到 > 100000 次展示第二。数据库操作显然是高度写入密集型的，需要快速的并发写入。我应该使用什么样的数据库，我将如何设计数据库架构？

我是这个领域的真正菜鸟，我不确定如何进行。我对 NoSql 数据库没有太多经验，我不确定这种规模的操作是否可以通过 MySql 或 MS SQL Server 之类的关系数据库来实现。

任何帮助将不胜感激！

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:55:55.360

> 我应该使用什么样的数据库

在运行 Windows 的 4 年旧台式 PC 中，ESENT NoSQL[能够每秒进行 70k 插入](http://blogs.msdn.com/b/laurionb/archive/2008/11/07/some-basic-esent-performance-measurements.aspx)（对于小记录）。进行快速并发写入肯定没问题。它甚至具有“托管更新列”功能，允许您在不锁定记录的情况下更新 int32 列值，即同时更新。

数据库架构仅取决于您要收集的确切数据。

PS你的任务对我来说听起来很难。一个问题是可扩展性：您最好尽早决定是否要水平扩展，即通过添加服务器。如果是，它将对架构产生很大影响。另外，你将如何获得*这么*多的数据？Web 服务器无法处理 100k 请求/秒。

# javascript - twitter-bootstrap Collapse 在第一次点击后停止工作

> ID：12231095
> 
> 赞同：1
> 
> 时间：2012-09-01T20:21:45.313
> 
> 标签：javascript, jquery-plugins, twitter-bootstrap

首先，我要感谢 TwitterBootsrap 团队正在制作的东西，但文档需要更多的工作。

我在我的网站上有网站示例的代码：

```
<div class="accordion" id="accordion2">
                <div class="accordion-group">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne">Collapsible Group Item #1</a>
                  </div>
                  <div id="collapseOne" class="accordion-body collapse in">
                    <div class="accordion-inner">
                      Sentence 1
                    </div>
                  </div>
                </div>
                <div class="accordion-group">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo">Collapsible Group Item #2</a>
                  </div>
                  <div id="collapseTwo" class="accordion-body collapse">
                    <div class="accordion-inner">
                      Sentence2
                    </div>
                  </div>
                </div>
                <div class="accordion-group">
                  <div class="accordion-heading">
                    <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseThree">Collapsible Group Item #3</a>
                  </div>
                  <div id="collapseThree" class="accordion-body collapse">
                    <div class="accordion-inner">
                      Sentence3
                    </div>
                  </div>
                </div>
              </div> 
```

问题是手风琴的每一行只打开和关闭一次，然后手风琴就变得没用了。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T09:48:06.237

我有同样的问题。将 jQuery 更新到最新版本 (1.9.1) 修复了它。

# c++ - Boost::Lambda 中的 ref()？

> ID：12231096
> 
> 赞同：0
> 
> 时间：2012-09-01T20:22:19.433
> 
> 标签：c++, ref, boost-lambda, boost-phoenix

`ref`Boost::Lambda 中的 Boost::Phoenix 的等价物是什么？我在在线文档中找不到它。

```
#include <algorithm>
#include <string>
#include <boost/lambda/bind.hpp>
using namespace boost::lambda;

int main()
{
    std::string a, b;
    std::for_each(b.begin(), b.end(), ref(a) += _1);  // how do I do this?
} 
```

`boost::ref`并且`boost::lambda::var`似乎不起作用（显然，它们没有运算符重载）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:39:07.270

哦，我刚刚想通了...

### 只是`#include <boost/lambda/lambda.hpp>`然后`var`会工作！

# mysql - MySQL 聚合？

> ID：12231103
> 
> 赞同：0
> 
> 时间：2012-09-01T20:23:36.503
> 
> 标签：mysql

我有以下两张表

```
Table: items
ID  |  TITLE
249 | One
250 | Two
251 | Three 
```

我对这些投票：

```
Table: votes
VID | IID | userid | votes
01  | 249 |    6   | 5
02  | 249 |    7   | -5
03  | 249 |    8   | 5
04  | 249 |    9   | 5
05  | 250 |    6   | -5
06  | 250 |    7   | -5
07  | 250 |    8   | 5 
```

-5 表示投反对票，+5 表示投赞成票。假设我以用户 6 身份登录，SQL 查询会给我什么：

```
Table: result
ID  |  TITLE | TOTALVOTES | UPVOTES | DOWNVOTES | CURRENTUSERVOTED
249 | One    | 4          | 3       | 1         | 1
250 | Two    | 3          | 1       | 2         | 1
251 | Three  | 0          | 0       | 0         | 0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T20:31:06.353

`CASE`在聚合函数中使用表达式：

```
SELECT    a.ID,
          a.TITLE,
          COUNT(b.IID) AS TOTALVOTES,
          COUNT(CASE WHEN b.votes =  5 THEN 1 END) AS UPVOTES,
          COUNT(CASE WHEN b.votes = -5 THEN 1 END) AS DOWNVOTES,
          COUNT(CASE WHEN b.userid = 6 THEN 1 END) AS CURRENTUSERVOTED
FROM      items a
LEFT JOIN votes b ON a.ID = b.IID
GROUP BY  a.ID,
          a.TITLE 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T20:30:53.727

这应该工作

```
select I.Id, I.Title, count(*) as TotalVotes,
sum(case when votes > 0 then 1 else 0 end) as UPVOTES, 
sum(case when votes < 0 then 1 else 0 end) as DOWNVOTES,
case when sum(Case when userid = @userloged then 1 else 0 end) = 1 then 1 else 0 end as CURRENTUSERVOTED
from items I
LEFT JOIN Votes V
on I.Id = V.IID
group by I.ID, I.Title 
```

可能是获得 CURRENTUSERVOTED 的更好方法

# android - 定位服务在模拟器上工作，但在真正的安卓设备上不工作

> ID：12231104
> 
> 赞同：0
> 
> 时间：2012-09-01T20:23:36.877
> 
> 标签：android

我想获取用户的位置，所以我有这个代码：

```
LocationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
        // Register the listener with the Location Manager to receive location updates
        locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, MINIMUM_TIME_BETWEEN_UPDATES,
                MINIMUM_DISTANCE_CHANGE_FOR_UPDATES, this);

        Log.d("locationManager ", "locationManager ");

        /*
         * try to get last know location
         */
        Location location = locationManager
                .getLastKnownLocation(LocationManager.GPS_PROVIDER);

public void onLocationChanged(Location location) {
    this.location=location; 
```

}

然后我发送 geot fix：

```
geo fix -122.41914 37.77919 
```

它在模拟器中运行良好，但是当我在真实设备上尝试时。它不起作用，我看到设备上的 GPS 图标闪烁。注意：设备上启用了 GPS。

# c# - 蛮力或算法

> ID：12231109
> 
> 赞同：0
> 
> 时间：2012-09-01T20:25:00.883
> 
> 标签：c#, algorithm, sorting, restrictions

我不确定需要哪种方法，但让我描述一下问题：

1.  给定任意数量的工人（2 名或更多）计划在任何给定月份（包括周末）工作。
2.  只有一名工人可以在指定的日期工作。2a。该工人可能在前一天或后一天不工作。
3.  工人也在周末工作，如果可能的话，平均分配给工人的数量。3a。周六和周日的权重相同。
4.  分配可能的假期4a。对连续天数没有限制 4b。可能不会放太多会干扰规则 #2 和 #3 的假期

对这些标准进行排序的最灵活方法是什么。这种类型的问题叫什么？

有人可以指出我正确的方向，以便我可以阅读和了解它。显然，如果这是已经通过算法解决的问题，请将我指向正确的论文或书籍，以便我可以阅读和理解它。

澄清：我不是在寻找每个工人将工作多少天和周末，而是一种[平均]分配当月工作天数的方法。

例如工人ABC；请求的假期 17 到 20

显然，除了我在下面列出的示例之外，还有其他排列。

```
 M  T  W  Th F  Sa Su
        ====================
October 1  2  3  4  5  6  7
2012    A  B  C  A  B  C  A

        8  9 10 11 12 13 14
        B  C  A  B  C  A  B

       15 16 17 18 19 20 21
        C  A  B  C  B  C  A

       22 23 24 25 26 27 28
        B  A  C  A  C  B  C

       29 30 31
        A  B  A 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:38:32.353

使用单纯形算法。您可以这样编程约束：

每天需要由一个人填补 对于每一天，对于每个工人，他们应该在每三天的时间段中至少工作一次不超过1层（周末轮班/工人）

# html - 为什么

> ID：12231112
> 
> 赞同：4
> 
> 时间：2012-09-01T20:26:09.853
> 
> 标签：html, header

我刚刚完成了 Code School 的[Functional HTML5 & CSS3](http://www.codeschool.com/courses/functional-html5-css3)，我注意到他们多次强调`<header>`元素应该包含`<h1>`标题（不是`<h2>`等`<h3>`），但他们没有解释原因。

这是为什么？是什么`<h1>`让它如此特别以至于我们应该包括在内`<header>`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T20:29:27.603

页面的`header`标题就像文档的标题，您通常会在此处找到文档的主标题。网页的主标题通常放在 h1 中，但标题可以包含许多其他内容，例如徽标、发布日期和其他元数据。在许多网站上，网站的标题也包含它的导航。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T20:30:57.740

`h1`是主要（即：最重要的）标题。

该`header`标签不仅限于包含`h1`，而且由于它是页面上最重要的标题，因此可能经常出现这种情况。

# objective-c - OSX CoreData 数据问题

> ID：12231116
> 
> 赞同：0
> 
> 时间：2012-09-01T20:26:58.120
> 
> 标签：objective-c, macos, core-data, nstableview

我有一个`NSTableView`我使用绑定到一个的`ArrayController`，我能够打开一个目录并在表中显示文件就好了。我还有一个包含图像的列。我退出应用程序并返回，文件列表仍然存在，这就是我想要的！

现在我遇到问题的部分是，我在按下按钮时更改图像并关闭应用程序并重新打开它，旧图像在那里而不是新图像。图像名称也为空。

这就是我更新 CoreData 中的图像的方式

```
NSEntityDescription *entity = [NSEntityDescription entityForName:@"File" inManagedObjectContext:[self managedObjectContext]];

    [request setEntity:entity];
    NSError *error = nil;

    NSArray *fetchedObjects =[_managedObjectContext executeFetchRequest:request error:&error];
    NSManagedObject *object = [fetchedObjects objectAtIndex:currentAudioIndex];

    NSImage *image = [object valueForKey:@"taggedImage"];

    if ([[image name] isEqualToString:@"tag_green"]) {
        NSImage *tagImage = [NSImage imageNamed:@"tag_red.png"];
        [object setValue:tagImage forKey:@"taggedImage"];
    } 
```

打开目录并获取文件列表时，我可以更改图像并更新表格，但是当我关闭应用程序并重新打开它时，文件在那里，更改的图像不存在，当我尝试更改图像时上面的代码说图像名称是`NULL`.

# django - Django-nonrel 与 MongoDB 中的合理 URL 模式

> ID：12231118
> 
> 赞同：0
> 
> 时间：2012-09-01T20:27:23.213
> 
> 标签：django, mongodb, django-nonrel, url-pattern

许多新闻网站的常见做法是在 URL 中同时包含 ID 和 slug。ID 用于查找实际文章，并且包含 slug 用于 SEO 目的。这样，可以更改 slug 以匹配文章标题的更改，而不会使任何以前的书签变得无用。

在 URL 中使用 MongoDB ObjectId 很麻烦，因为它会创建非常长的 URL (http://www.mysite.com/article-504119a051e2726c9aa28ea1/my-article-title.html) - 有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T03:25:03.940

如果有更适合您的用例的选择，则不必使用 MongoDB 的[默认 ObjectID 。](http://www.mongodb.org/display/DOCS/Object+IDs#ObjectIDs-BSONObjectIDSpecification)例如，您可以`_id`使用更短的值（例如时间戳或递​​增计数器）定义自定义字段（请参阅：[如何制作自动递增的 id 字段](http://www.mongodb.org/display/DOCS/How+to+Make+an+Auto+Incrementing+Field)）。如果您的用例正在发布文章并且每分钟没有数百篇文章，那么您可能会获得一个`_id`带有随机值连接的 unix 时间戳的合理唯一性。

如果您的 slug 是唯一的（或者您可以接受此限制），您可能会使用 slug 作为`_id`更短的 url。s的警告`_id`是它们不能更改，因此单独索引的`slug`字段将为您提供更大的灵活性。

鉴于您将 slug 用于 SEO 的目标，您可能需要添加一些技巧，以便在提供替代 slug 的情况下将 302 重定向到当前的“规范 url”（具有正确的 slug 字段）。`id`否则，如果仅检查 URL 的一部分，您可能会因重复内容而招致潜在的 SEO 处罚。

# javascript - 从 jQuery click 事件中访问属性和对象在同一个对象中创建

> ID：12231120
> 
> 赞同：1
> 
> 时间：2012-09-01T20:27:41.327
> 
> 标签：javascript, jquery

我有一个 jscript 对象。我在 div 中插入了一些 html，并尝试将事件单击附加到 html 标签，全部嵌入对象，如何访问 jquery click 事件函数中对象的方法和属性？

HTML 代码：

```
<div id="content"></div> 
```

JAVASCRIPT代码：

```
<SCRIPT ...
jQuery().ready(function (){
    obj=new myobject("myobject1","#content"); //create object instance
    obj.dohtml(); //call method dohtml
});

//object I pass an objectname and a id from an html element 
function myobject(objectname,htmlid){

    this.name=objectname; //name of object 
    this.htmlid=htmlid;   //id where i try to create some html

    //say hello
    this.hello=function(){
       alert(hello); 
    }

    //do something with html
    this.dohtml=function(){

    //create an <p> element in a the html with id=htmlid 
    $(this.htmlid).html('<p id="'+this.name+'_myp" > my text </p>')     

    //click event on <p> id= this.name+'_myp"
    $("#"+this.name+'_myp').click(function(){
        alert(this.name); //i try to access property this.name in the object and dont work
        //how can access to this property from here

        this.hello(); //how can access to this method from here

    });

    $("#"+this.name+'_myp').click(this.hello()); //this dont work too why?

 } 

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T20:29:29.490

您的范围在`click`回调中发生变化..所以您需要保存`this`var 存储：

```
var that = this;
$("#"+this.name+'_myp').click(function(){
    alert(that.name); //i try to access property this.name in the object and dont work
    that.hello(); //how can access to this method from here
}); 
```

### 对于第二部分：

您正在执行该函数并在执行时传递返回值`this.hello()`，如果您只想传递该函数，则可以不`this.hello`传递`()`

```
$("#"+this.name+'_myp').click(this.hello); 
```

它适用，`this`因为您仍在范围内。

# android - 如何在 AndEngine 中更改场景

> ID：12231125
> 
> 赞同：2
> 
> 时间：2012-09-01T20:28:54.843
> 
> 标签：android, andengine

我正在 AndEngine Gles2 中开发游戏。我有飞溅场景、加载场景、菜单场景和 Level1 场景。我正在使用屏幕管理器来管理所有场景，通过这些场景我可以轻松地在启动画面、加载和菜单场景之间切换，level1 场景也完美地从菜单加载，但是当我在完成关卡、屏幕后返回菜单场景时出现问题变成黑色，之后没有任何显示。我认为问题在于卸载Level1的资源，因为其他场景之间的切换非常完美。我不能给出完整的代码，因为它太长了。

我正在使用 bitmapTexture 区域、Sprites、bodys、物理 Word、hud 和固定装置等。这是我的卸载方法.. 当我在 1 级屏幕结束时加载菜单场景时，还有 1 件事变成黑色，但播放的音乐和所有日志都显示在我在菜单场景中设置的 logcat 中。

```
unload(){
setChildrenIgnorUpdate();
clearChildScene();
clearEntityModifier();
clearTouchAreas();
clearUpdateHandler();
BitmapTextureManager.getInstance().destroyInstance();
destroyPhysics();
} 
```

请任何帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T16:36:03.967

我认为卸载纹理会给您带来问题。

根据我的意见，在加载场景时加载游戏的所有图形。然后不要卸载图形。我想说只有每个级别都在变化的游戏场景图形只需要卸载并再次加载它。

不要卸载所有图形并再次加载。只加载一次为游戏修复并保存在设备的图形内存中。

图形内存溢出会产生这种异常行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T23:32:29.887

我认为你的问题在这里

```
BitmapTextureManager.getInstance().destroyInstance(); 
```

返回菜单场景时是否重新初始化纹理资源？因为听起来好像一切正​​常，但你的纹理被破坏了。

# jquery - 类选择器不起作用

> ID：12231127
> 
> 赞同：1
> 
> 时间：2012-09-01T20:29:22.253
> 
> 标签：jquery

我正在按类进行 z-index 管理 .. 所以活动对象获得最顶层的类 ..

```
function topmost() {
    $(".topmost").removeClass("topmost");
    $("#thing").addClass("topmost");
} 
```

这段代码似乎不起作用，我无法理解为什么..

== 编辑 ==

问题是`$(".topmost").removeClass("topmost");`当页面上有多个结果时找到零结果。我经常使用这个类选择器，从来没有遇到过这个问题。该类首先由 jQuery 添加，但无论如何它都应该看到它。我查看我的检查器并记录选择，当我可以看到该类的至少 3 个 div 时，它会出现零。它是嵌套在对象中的函数，有问题吗？它可以超出对象的范围并搜索整个 DOM 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T20:53:44.860

如果我理解正确，您是在 dom 加载后插入元素吗？如果是这样，您需要将事件委托给 dom 中存在的父元素。

```
$('body').on('click','div', function() {
    $('.topmost').removeClass();
    $(this).addClass('topmost');
}); 
```

`body`可以用 dom 上存在的最接近的父元素替换

最后一件事，始终将事件绑定包装在一个`$(document).ready`函数中，或者将脚本放在 html 代码的底部，以确保元素在绑定时存在。

这是它工作的示例小提琴

[http://jsfiddle.net/MPT3z/](http://jsfiddle.net/MPT3z/)

以下是如何将点击事件应用于所有元素

```
$('body').on('click','*', function() {
    $('.topmost').removeClass();
    $(this).addClass('topmost');
}); 
```

[http://jsfiddle.net/eLDpn/](http://jsfiddle.net/eLDpn/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T20:35:39.783

试试这个

```
 $(document).on('click', '#SELECTOR', function(){
             $(".topmost").removeClass("topmost");
              $(this).addClass("topmost");
         }); 
```

我在哪里放置 #SELECTOR ，将其更改为您希望它适用的任何元素

对象甚至可以去那里，假设它被正确定义以选择你想要的东西

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T20:58:00.640

这很容易解决。给元素一个ID。并使用 ID 作为选择器。

```
function topmost() {
    $("#myDiv").removeClass("topmost");
    $("#myDiv").addClass("topmost");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T21:00:25.283

试试这个：

```
function topmost(el) {
    $(".topmost").removeClass("topmost");
    if ($(el).length > 0) {
       $(el).addClass("topmost");
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-01T21:56:33.770

有时，如果将 .each 添加到选择器中，调试起来会更容易：

```
function topmost() {
  $(".topmost").each(function() {
    console.log("yo");
    $(this).removeClass("topmost");
  });
  $("#thing").addClass("topmost");
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-04T22:27:32.000

调用此函数时页面上是否发生回发？

# php - 使用 Mustache 转换 Web 应用程序

> ID：12231128
> 
> 赞同：0
> 
> 时间：2012-09-01T20:29:25.700
> 
> 标签：php, html, templates, web-applications, mustache

**问题：**
添加一个模板引擎，如 Mustache，它已被转换为多种不同的语言，是否有助于为 Web 应用程序做同样的事情？

**背景：**
我正在完成一个可以重复使用很多次的产品。现在我已经用 php 编写了后端。我想知道 mustache.php 或 mustache.js 是否有利于添加到 Web 应用程序，而不会显着降低性能。我计划让转换为 JSP/Servlets 和 ASP.NET/C# 变得更容易。现在，用户设置的变量（例如徽标和公司名称）散布在整个页面中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T02:46:32.450

选择任何模板语言都会对您的应用程序有益。它将帮助您划分逻辑，提高代码（和输出）的可测试性，并且通过限制您在任何给定层中可以执行的操作，帮助您编写客观上更好的代码。

所以是的，无论如何，使用模板语言。

Mustache(.php|.js) 是正确的模板语言吗？在我看来（作为一个编写了两个库之一的人），它们是一个非常可靠的选择。实现之间的可移植性在这方面发挥了重要作用，但 Mustache 还有许多其他不那么明显的好处。

[@kneath 就此事写了一篇值得一读的博文](http://warpspire.com/posts/mustache-style-erb/)。你应该检查一下。

并且要回答您隐含但未提出的问题，您不会牺牲性能。Mustache.php 相当快。你几乎不会注意到区别:)

# c++ - 关于 C/C++ 中使用的 header-guards 和 header-file 包含的说明

> ID：12231132
> 
> 赞同：1
> 
> 时间：2012-09-01T20:29:32.907
> 
> 标签：c++, c, header

我知道人们建议在头文件中包含头文件保护，以防止头文件内容被预处理器多次插入源代码文件。

但请考虑以下情况：

假设我有文件`main.cpp`,`stuff.cpp`和`commonheader.h`,`.h`文件有它的标题保护。

如果任一`.cpp`文件尝试包含`commonheader.h`多次，则预处理器将阻止这种情况发生，并且在编译为目标代码后，我们得到，

`main.o`只包含一次 commonheader.h 的内容**。**

`stuff.o`只包含一次 commonheader.h 的内容**。**

请注意，commonheader 的内容已在文件中重复，但不在同一个`.o`文件中。

那么在链接步骤中会发生什么？由于 .o 文件被融合到一个可执行文件中，我们必须再次确保**commonheader**的内容不会重复。编译器会处理这个吗？如果不是，那么当我们处理巨大的头文件时，这不是一个问题，会导致文件之间的代码重复并导致较大的可执行文件大小。

如果我在问题的任何地方都犯了一些概念上的错误，请纠正我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T20:32:49.490

通常，您的头文件实际上不应**定义**任何符号，而应仅**声明**它们。所以 commonheader.h 看起来像这样（省略包含守卫）：

```
void commonFunc1(void);
void commonFunc2(void); 
```

在这种情况下，没有问题。如果你调用and `commonFunc1`，两个and都会知道他们想要链接一个名为的符号，并且链接器会尝试找到那个符号。如果链接器没有找到该符号，则会收到未定义的引用错误。的实际定义需要在某个 cpp 文件中。`main.cpp``stuff.cpp``main.o``stuff.o``commonFunc1``commonFunc1`

如果您真的想在头文件中定义函数，请使用`static`以使链接器看不到它们。所以你的 commonheader.h 可能看起来像：

```
static void commonFunc1()
{
    /* ... do stuff ... */
} 
```

在这种情况下，链接器不知道`commonFunc1`并且不会发生错误。不过，这可能会增加可执行文件的大小；您最终可能会得到两份`commonFunc1`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T20:49:34.927

扩展格雷森的答案以涵盖变量。如果你想在头文件中声明一个变量，你应该使用 extern 关键字。这是处理全局变量的一种方法。

在头文件 global.h 中，您可以这样写：

```
extern Globals globals; 
```

那么你可以在包括 global.h 在内的任何文件中使用 foo，而在 global.cpp 中你可以编写

```
#include "globalstype.h"
Globals globals; 
```

请注意，global.cpp 不需要包含 global.h，但是您需要确保将 global.cpp 编译到每个用法中，否则链接器会抱怨。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T20:50:54.677

头文件通常包含*声明性代码*而不是*确定性代码*。那就是他们声明必须存在一次的东西的存在。宏和内联函数是允许的，并且无论在何处使用它们都必须重复。

编译器使用这些声明将未解析的链接（或引用）插入到目标代码中。链接器的工作是通过将引用与单个定义匹配来解析这些链接。

如果您省略包含保护，在*单个翻译单元*中包含多个包含，您将得到一个现有符号的多个*声明的**编译器错误。*但是，如果您的标头错误地包含定义，并且标头包含在多个翻译单元中，则将有多个目标文件具有定义-这反而会导致多*定义的**链接器错误*。

 ***所以虽然：

```
extern int b ;  // declaration, may occur in multiple translation units 
```

在头文件中是 fin，

```
int b ; // definition, must occur in only object file. 
```

不是。

不是声明不包含在目标代码中，而是编译器使用它们来创建链接器将解析的引用，如果编译器尚未使用定义并已经解析它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T21:18:12.293

是的，这可能是个问题。您最终可能会得到多个定义或冗余副本。

C 在这方面非常简单。你有静态、外部和内联——编译器还定义了几种改变可见性的方法。我认为其他答案已经涵盖了很多内容。

然而，C++ 完全不同。有很多信息，也有隐式定义（例如，编译器可能会发出一个复制构造函数或 RTTI）。

对于 C++，定义出现在头文件中的可能性更大——考虑模板、类声明中定义的方法等等。C++ 默认使用单一定义规则。你会想更详细地阅读它，但它基本上指出某些类别的符号可能是多重定义的；根据声明的装饰和位置/范围，在许多情况下，允许链接器假设每个主体（定义）都是相同的，并且可以随意丢弃它遇到的任何副本（在二进制文件中留下一个定义）。所以这确实减少了生成的二进制文件的*大小*，除非你指定要生成一个副本。

但是，在头文件中包含这些定义肯定会增加编译时间、编译每个文件所需的内存和文件、可见的依赖关系，并且会增加在编辑定义时必须重新编译的文件数量。

当然，该语言仍然允许使用错误的形式，并且如果您一遍又一遍地反复陈述并在多个翻译中包含*必须*为每个翻译复制的定义，也不会抱怨。然后你肯定会以很多膨胀结束。

这可能是一个很好的介绍： [http ://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=386](http://www.informit.com/guides/content.aspx?g=cplusplus&seqNum=386)***

# ruby - 为什么自动加载无法为 gems 加载文件

> ID：12231134
> 
> 赞同：1
> 
> 时间：2012-09-01T20:29:47.950
> 
> 标签：ruby, email, rubygems, gmail

我正在尝试使用这个[gmail gem](https://github.com/nu7hatch/gmail)阅读 ruby​​ 中的电子邮件。

当我`require 'gmail'`在 IRB 或脚本中时，我收到此错误：

`/Library/Ruby/Gems/1.8/gems/gmail-0.4.0/lib/gmail.rb:70:in connect_with_proper_client': no such file to load -- gmail/client (LoadError) from /Library/Ruby/Gems/1.8/gems/gmail-0.4.0/lib/gmail.rb:48:in new`

发生这种情况是因为自动加载无法归档“gmail/client”文件。

当我`require 'gmail/client'`手动添加时，问题就会消失，直到下一次自动加载调用。这个解决方案是不可接受的，因为我无法提前预测要添加哪些文件。

我发现了一个[类似的问题](https://stackoverflow.com/questions/849622/autoload-raises-an-error-but-require-does-not-ruby)，但它并没有解决我的问题。

# python - 如何理解这个结果？

> ID：12231136
> 
> 赞同：5
> 
> 时间：2012-09-01T20:30:08.373
> 
> 标签：python, tuples

我是 Python 新手。这是我关于列表的一个问题：据说列表是可变的，而元组是不可变的。但是当我写以下内容时：

```
L1 = [1, 2, 3]
L2 = (L1, L1)
L1[1] = 5
print L2 
```

结果是

```
([1, 5, 3], [1, 5, 3]) 
```

代替

```
([1, 2, 3], [1, 2, 3]) 
```

但是`L2`是元组，元组是不可变的。为什么当我改变 的值时`L1`， 的值`L2`也会改变？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-01T20:33:08.397

在 Python 文档 (http://docs.python.org/reference/datamodel.html) 中，请注意：

> 包含对可变对象的引用的不可变容器对象的值可以在后者的值更改时更改；但是容器仍然被认为是不可变的，因为它包含的对象集合不能更改。因此，不变性与具有不可更改的值并不严格相同，它更微妙。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-01T20:32:25.973

元组是不可变的，但元组内的列表是可变的。您更改了 L1（列表），而不是元组。元组包含 L1 的两个副本，因此它们都显示了更改，因为它们实际上是同一个列表。

如果一个对象是“不可变的”，那并不意味着它所接触的一切都是不可变的。您可以将可变对象放在不可变对象中，这不会阻止您继续改变可变对象。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-01T20:32:29.740

元组没有被修改，它仍然包含与您给它的列表相同的重复引用。

您修改了一个*列表*( `L1`)，*而不是*元组（或者更准确地说，不是对元组中列表的*引用*）。

例如，您将*无法*做到

```
 L2[1] = 5 
```

因为正如您正确陈述的那样，元组*是不可变的。*

所以元组没有改变，但是元组包含引用的列表被修改了（因为两个条目都是对同一个列表的引用，所以输出中的两个值都更改为`5`）。元组中的值没有改变。

如果您在这种情况下将引用视为“指针”，这可能会有所帮助。

**编辑**（基于 OP 在下面的评论中提出的问题）：

关于参考文献、列表和副本，也许这些例子会有所帮助：

```
L=range(5)
s = (L, L[:]) # a reference to the original list and a copy

s
([0, 1, 2, 3, 4], [0, 1, 2, 3, 4]) 
```

然后改变 L[2]

```
L[2] = 'a' 
```

给出：

```
s
([0, 1, 'a', 3, 4], [0, 1, 2, 3, 4])  # copy is not changed 
```

请注意，“第二个”列表没有改变，因为它包含一个副本。

现在，

```
L=range(5) 
```

我们正在创建列表的两个副本并提供对元组的引用

```
s = (L[:], L[:])

now 
L[2] = 'a' 
```

除了原始列表 L 之外不影响任何内容

```
s
 ([0, 1, 2, 3, 4], [0, 1, 2, 3, 4]) 
```

希望这会有所帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-01T20:35:19.393

你说得对，元组是不可变的：L2 是对 L1 的两个引用的不可变元组（不像它可能首先出现的那样，是两个列表的元组），并且 L1 不是不可变的。当你改变 L1 时，你并没有改变 L2，只是改变了 L2 引用的对象。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-01T20:39:47.247

使用**deepcopy**而不是`=`：

> > 从复制导入 deepcopy
> > L2 = deepcopy(L1)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-01T20:32:50.813

元组包含两个引用，每个引用指向同一个列表（不是列表的副本，如您所料）。因此，列表中的更改仍将显示在元组中（因为元组仅包含引用），但元组本身不会更改。因此，它的不变性没有被违反。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-02T17:22:29.443

元组不可变只意味着一件事——一旦你构造了一个元组，就不可能修改它。另一方面，列表可以添加元素，删除元素。但是，元组和列表都关心它们包含的元素，而不关心这些元素是什么。

在 Python 中，这与元组或列表无关，当您添加一个简单值（如 int）时，它会按原样表示，但任何复杂值（如列表、元组或任何其他类类型对象）都是**始终**作为参考存储。

如果您要将元组转换为 a `set()`，您会收到一条可能会让您感到惊讶的错误消息，但鉴于上述情况，它应该是有意义的：

```
>>> L=range(5)
>>> s = (L, L[:]) # a reference to the original list and a copy
>>> set(1, 2, s)
>>> set((1, 2, s))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unhashable type: 'list' 
```

由于 a 的值`set`一旦添加到集合中就永远不会改变，因此包含在不可变元组中的任何可变值`s`都会 raise `TypeError`。

# android - ImageView 后面的 ImageButton 和偏移量

> ID：12231138
> 
> 赞同：2
> 
> 时间：2012-09-01T20:30:15.350
> 
> 标签：android, android-layout, imageview, android-linearlayout

所以我正在为我的应用程序进行设计，我需要在图像视图的正下方放置一个图像按钮。但是由于我的 imageview 周围有一个带有阴影的边框，所以我需要在 imageview 后面隐藏（向上移动）我的 imagebutton 的 10 个像素。这是我想要的快速绘图。

![例子](../Images/461c3215c381bdc2a63fc25cf4ca06cd.png)

我希望这是有道理的。我一直在搞各种不同的安排，但我无法得到我想要的。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T20:36:00.377

首先使用一个`RelativeLayout`. 先添加`ImageButton`再添加`ImageView`，这样`ImageView`就会在你的`ImageButton`. 然后，您应该设置`ImageButton`以下内容：

```
<ImageButton
    ....
    android:layout_below="@id/ImageViewId"
    android:layout_marginTop="-10px" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T20:46:27.893

如上所述使用相对布局。有关更多位置和简单设计，请参阅 [http://developer.android.com/reference/android/widget/RelativeLayout.LayoutParams.html](http://developer.android.com/reference/android/widget/RelativeLayout.LayoutParams.html) 。

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="fill_parent"
android:layout_height="wrap_content" >

    <Button
    android:id="@+id/button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/Imageview"
    android:layout_marginTop="-16dp" />

<ImageView
    android:id="@+id/Imageview"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="46dp"
    android:adjustViewBounds="true"
    android:contentDescription="@string/description_logo"
    android:src="@drawable/imagename" />

    </RelativeLayout> 
```

# javascript - 如何为 Chrome 开发工具中的自定义类计算 javascript 类名？

> ID：12231139
> 
> 赞同：6
> 
> 时间：2012-09-01T20:30:20.980
> 
> 标签：javascript, google-chrome-devtools, google-closure-compiler

我正在尝试确定在 javascript 中生成类名的规则。我将此脚本粘贴到 Chrome 开发工具控制台中：

```
var obj = { 
    Constr : function() {  }
};

var obj2 = obj;
console.log(new obj.Constr());
console.log(new obj2.Constr());

obj2.Constr2 = function() {  };
console.log(new obj.Constr2());
console.log(new obj2.Constr2()); 
```

以下是控制台中的结果：

```
obj.Constr
obj.Constr
obj2.Constr2
obj2.Constr2 
```

似乎类的名称是由构造函数最初分配给的变量决定的。我正在寻找 CDT 用于生成此名称的精确规则。此外，这与 Google Closure Compiler 识别的名称相同吗？

我试图看看我是否可以在 Firebug 中重现类似的行为，但我似乎无法在控制台中打印出类名。作为第二个问题，有谁知道如何在萤火虫中看到这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T21:54:42.217

Javascript 中没有类，因为它是基于原型的 OOP，而不是基于类的。Chrome 显然做了一些推断，以便在控制台中打印对象的一些描述，但这不是标准的 Javascript——在标准中，对象没有命名类，你无法弄清楚对象所属的类的名称，因为唯一的继承是通过实际的`[[Prototype]]`内部伪属性完成的，它本身也是一个对象，没有名称或“类”。通常，您可以通过查看来推断出类似于类名的`object.__proto__.constructor.name`内容，这将返回函数的名称，该函数是实例化对象的构造函数；*但是*这个函数可能是匿名的，*或者*你的浏览器可能不支持非标准`__proto__`属性，*或者*对象的原型可能不包含对其构造函数的正确引用。一般来说，你无法知道 JS 中一个对象的“类”；您只能测试后代（`object instanceof Constructor`），但这仍然是根据`constructor`对象原型中的属性实现的，这*可能*是不正确的。

# sql - 我的 Postgres 数据库没有使用我的索引；我解决了，但不明白解决方法，谁能解释发生了什么？

> ID：12231140
> 
> 赞同：1
> 
> 时间：2012-09-01T20:30:27.827
> 
> 标签：sql, database, postgresql

我在相关部分的数据库模式是有一个名为 User 的表，它有一个布尔字段 Admin。此字段 Admin 上有一个索引。

前一天我将完整的生产数据库恢复到我的开发机器上，然后只对数据库进行了非常小的更改，所以它们应该非常相似。

当我在我的开发机器上运行以下命令时，我得到了预期的结果：

```
EXPLAIN SELECT * FROM user WHERE admin IS TRUE;

Index Scan using index_user_on_admin on user (cost=0.00..9.14 rows=165 width=3658)
Index Cond: (admin = true)
Filter: (admin IS TRUE) 
```

但是，当我在生产机器上运行完全相同的命令时，我得到了这个：

```
Seq Scan on user  (cost=0.00..620794.93 rows=4966489 width=3871)
Filter: (admin IS TRUE) 
```

因此，它没有使用与查询完美匹配的精确索引，而是使用了近 500 万行的顺序扫描！

然后我尝试运行`EXPLAIN ANALYZE SELECT * FROM user WHERE admin IS TRUE;`，希望`ANALYZE`能让 Postgres 意识到顺序扫描 500 万行不如使用索引好，但这并没有改变任何东西。

我还尝试运行`REINDEX INDEX index_user_on_admin`以防索引损坏，但没有任何好处。

最后，我打了电话`VACUUM ANALYZE user`，很快就解决了问题。

我对真空的主要理解是它用于回收浪费的空间。可能发生了什么会导致我的索引行为不端如此糟糕，为什么真空修复它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T22:02:59.157

1.  `ANALYZE`通过更新计划器使用的数据统计信息来确定运行查询的最佳方式，这很可能是有帮助的。`VACUUM ANALYZE`只需按顺序运行这两个命令，`VACUUM`第一，`ANALYZE`第二，但`ANALYZE`它本身可能就足以提供帮助。

2.  `ANALYZE`选项与命令`EXPLAIN`完全无关`ANALYZE`。它只是导致 Postgres 运行查询并报告实际运行时间，以便可以将它们与规划器预测进行比较（`EXPLAIN`没有`ANALYZE`只显示查询计划和规划器认为它将花费多少，但实际上并不运行查询） . 所以`EXPLAIN ANALYZE`没有帮助，因为它没有更新统计数据。`ANALYZE`并且`EXPLAIN ANALYZE`是两个完全不同的动作，只是碰巧使用了同一个词。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T20:33:39.923

PostgreSQL 保留了许多关于表条件、索引条件、数据等的高级统计信息……这有时会不同步。运行`VACUUM`将纠正问题。

当您在开发时从头开始重新加载表时，可能会产生相同的效果。

看看这个：

[http://www.postgresql.org/docs/current/static/maintenance.html#VACUUM-FOR-STATISTICS](http://www.postgresql.org/docs/current/static/maintenance.html#VACUUM-FOR-STATISTICS)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T22:30:44.403

对于您的问题，[部分索引](http://www.postgresql.org/docs/8.0/static/indexes-partial.html)似乎是一个很好的解决方案：

```
CREATE INDEX admin_users_ix ON users (admin)
    WHERE admin IS TRUE;; 
```

在同一字段上索引大量元组是没有意义的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T02:04:24.523

这是我认为最有可能的解释。

您的索引仅在返回非常少量的行时才有用（顺便说一句，我不喜欢索引 bools 出于这个原因 - 您可以考虑使用部分索引，或者甚至添加一个 where admin is true ，因为这将仅将索引保留在无论如何可能可用的情况下）。

如果要检索超过 iirc 表中 10% 的页面，则规划器可能会选择大量的顺序磁盘 I/O 而不是少量的随机磁盘 I/O，因为那样你不会'不必等待盘片转动。寻道速度是一个大问题，PostgreSQL 将倾向于尝试平衡从关系中检索的实际数据量。

您收集的统计数据表明该表要么比它小，要么作为用户的一部分管理员比您拥有的多，因此规划者使用了错误的信息来做出决定。

VACUUM ANALYZE 做了三件事。首先，它冻结对所有事务可见的元组，以便事务回绕不是问题。然后它将对没有事务可见的元组分配为可用空间。这些都没有影响您的问题。然而第三个是它分析表格并收集表格的统计信息。请记住，这是随机抽样，因此有时可能会关闭。我的猜测是，上一次运行时，它抓取了有很多管理员的页面，因此严重高估了系统管理员的数量。

这可能是仔细检查您的 autovacuum 设置的好时机，因为其他地方的统计数据也可能非常过时，但这还远不能确定。特别是，基于成本的真空设置具有默认设置，有时会导致真空无法完全赶上。

# c# - 如何使用 ListBox 中的项目列表提示 GridView 的标题

> ID：12231144
> 
> 赞同：0
> 
> 时间：2012-09-01T20:31:19.240
> 
> 标签：c#, asp.net, gridview

我有一个`GridView`和一个项目列表`ListBox`。不包括 中的第一列`GridView`。

我想用`ListBox`. 我的意思是`GridView2.Columns[i].HeaderText = ListBox.Items[i].Tostring()`.

这是我尝试过的：

```
protected void GridView2_RowDataBound(object sender, GridViewRowEventArgs e)
    {
        if (e.Row.RowType == DataControlRowType.Header)
        {
            for (int i = 1; i < GridView2.Columns.Count; i++)
            {
                String header = GridView2.Columns[i].HeaderText; 

                if (header.Length != 0)
                {
                   e.Row.Cells[i].ToolTip = ListBox4.Items[i].ToString().Trim();
                }
            }
        }
    } 
```

这给了我一个异常错误：索引超出范围。必须是非负数且小于集合的大小。

请帮忙。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-08T15:12:52.127

```
protected void GridView2_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.Header)
    {
        for (int i = 1; i < GridView2.Columns.Count; i++)
        {
            String header = GridView2.Columns[i].HeaderText; 

            if (header.Length != 0)
            {
               e.Row.Cells[i+1].ToolTip = ListBox4.Items[i].ToString().Trim();
            }
        }
    }
} 
```

假设使用**Cells[i+1]**而不是**Cells[i]**

# jquery - 未正确检测到 jQuery mouseup

> ID：12231147
> 
> 赞同：3
> 
> 时间：2012-09-01T20:31:39.453
> 
> 标签：jquery, events, mousedown, event-propagation, mouseup

我有一个包含跨度的 div。我有一个 mouseup 和 mousedown 事件，在按下 div 时应该触发。但是它不能正常工作。

请去这个小提琴：http: [//jsfiddle.net/Ym7rM/](http://jsfiddle.net/Ym7rM/)

如果您选择文本然后尝试拖动它，它只会检测到 mousedown 事件，而不是 mouseup。

我究竟做错了什么？我正在使用 Chrome。

谢谢

**编辑：**

抱歉，我简化了问题，请参阅新小提琴。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-01T20:43:02.463

正确检测到 mouseup 事件；只是在您执行拖动后浏览器没有触发 mouseup 事件。这是浏览器的故意行为。如果您想包含您现在想要的行为，您还应该监听 dragend 事件。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-01T20:53:04.190

mouseup 事件仅在橙色 div 内触发。这就是你编码的。试试这个[http://jsfiddle.net/ur8J9/5/](http://jsfiddle.net/ur8J9/5/)

# c++ - 沉默-括号-相等错误

> ID：12231151
> 
> 赞同：6
> 
> 时间：2012-09-01T20:32:08.373
> 
> 标签：c++, boost, compiler-construction

我在 osx 10.8 和 gcc 版本 4.2.1 上使用 boost 1.48 构建 som 软件，我已经开始收到`-Wparentheses-equality`一些 boost 源的警告。

```
 equality comparison with extraneous parentheses
  [-Werror,-Wparentheses-equality]
        else if((state->type == syntax_element_long_set_rep)) 
```

我会更改代码，但我不想修改库，我将如何使警告静音并使编译器继续？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-01T20:50:46.620

从[GCC 手册](http://gcc.gnu.org/onlinedocs/gcc-4.7.1/gcc/Invoking-GCC.html#Invoking-GCC)：

> 其中大部分既有正面形式也有负面形式；的否定形式`-ffoo`是`-fno-foo`.

试试`-Wno-parentheses-equality`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-06T18:01:58.447

作为简单禁用警告的替代方法，您还可以指定某些路径以计为“系统”路径。系统标头的警告被禁止，因此您可以声明特定库的标头是“系统”标头，并且您不关心其中的警告。

clang对此的论点是`--system-header-prefix=<prefix>`

所以例如你可能会说`"--system-header-prefix=boost/"`

[http://clang.llvm.org/docs/UsersManual.html#controlling-diagnostics-in-system-headers](http://clang.llvm.org/docs/UsersManual.html#controlling-diagnostics-in-system-headers)

根据错误消息判断，您实际上使用的是 clang 而不是 gcc。

# backbone.js - Backbone.js 视图内容不断增加而不是清除

> ID：12231163
> 
> 赞同：0
> 
> 时间：2012-09-01T20:33:26.600
> 
> 标签：backbone.js, backbone-views

我是 Backbone.js 的新手，这个问题真的让我很难过。

一个视图是从一个集合构建的，集合结果被过滤以将每组结果放入它们自己的数组中，然后我从每个数组中创建另一个数组，这些是显示的 4 个项目。

这在第一次呈现页面时工作正常，但是当我离开此页面然后返回页面时，现在有 8 个项目，每次我重新访问页面时，这种添加 4 的模式都会继续。

```
 // Locatore List Wrapper
    var LocatorPageView = Backbone.View.extend({

        postshop: [],
        postbox: [],
        postboxlobby: [],
        postboxother: [],
        closestPlaces: [],

        el: '<ul id="locator-list">',

        initialize:function () {        
            this.model.bind("reset", this.render, this);        
        },

        render:function (eventName) {
           //console.log(this)

        // Loop over collecion, assigining each type into its own array
            this.model.models.map(function(item){
                var posttype = item.get('type').toLowerCase();
                switch(posttype) {
                    case 'postshop':                              
                      this.postshop.push(item);
                      break;
                    case 'postbox':
                      this.postbox.push(item);
                      break;
                    case 'postbox lobby':
                      this.postboxlobby.push(item);
                      break;                          
                    default:
                      this.postother.push(item);
                }                     
              return ;
            }, this);   

        // Create a closest Places array of objects from the first item of each type which will be the closest item
            if (this.postshop && this.postshop.length > 0) {
                this.closestPlaces.push(this.postshop[0]);                      
            }
            if (this.postbox && this.postbox.length > 0) {
                this.closestPlaces.push(this.postbox[0]);
            }
            if (this.postboxlobby && this.postboxlobby.length > 0) {
                this.closestPlaces.push(this.postboxlobby[0]);
            }
            if (this.postother && this.postother.length > 0) {
                this.closestPlaces.push(this.postother[0]);
            }

        // Loop over the Closest Places array and append items to the <ul> contianer    
            _.each(this.closestPlaces, function (wine) {
                $(this.el).append(new LocatorItemView({
                    model:wine
                }).render().el);

            }, this);
            return this;
        }

    })

    // Locator single item
    var LocatorItemView = Backbone.View.extend({

        tagName:"li",

        template:_.template($('#singleLocatorTemplate').html()),

        render:function (eventName) {
            $(this.el).html(this.template(this.model.toJSON()));
            return this;
        },

        events: {
            "click .locator-map": "loadMap"
        },

        loadMap: function(e) {

            e.preventDefault();             
            // Instantiate new map
            var setMap = new MapPageView({
                model: this.model,
                collection: this.collection
            });

            var maptype = setMap.model.toJSON().type;
            App.navigate('mappage', {trigger:true,  replace: true});

            setMap.render();
            App.previousPage = 'locator';

        }   

    });

window.App = Backbone.Router.extend({               
    $body: $('body'),
    $wrapper: $('#wrapper'),
    $header: $('#header'),
    $page: $('#pages'),

    routes: {
               '' : '',
         'locator': 'locator'
    },          

    locator:function () {
        this.$page.empty();                                             // Empty Page

        this.places = new LocatorPageCollection();                      // New Collection
        this.placeListView = new LocatorPageView({model:this.places});  // Add data models to the collection

        this.places.fetch();

        this.$page.html(this.placeListView.render().el);                // Append the renderd content to the page
        header.set({title: 'Locator'});                                 // Set the page title
        this.$body.attr('data-page', 'locator');                        // Change the body class name
        this.previousPage = '';                                         // Set previous page for back button

    }

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:00:18.547

您参数中的所有属性`Backbone.View.extend`都附加到视图的原型。特别是，这些属性：

```
 postshop: [],
    postbox: [],
    postboxlobby: [],
    postboxother: [],
    closestPlaces: [], 
```

最终附加到，`LocatorPageView.prototype`因此每个`LocatorPageView`实例共享同一组数组，并且每次使用 a`LocatorPageView`时，都会将更多内容推送到同一组共享数组中。

如果您在 Backbone 视图中需要任何可变属性（即数组或对象），则必须在构造函数中设置它们：

```
initialize: function() {
    this.postshop      = [ ];
    this.postbox       = [ ];
    this.postboxlobby  = [ ];
    this.postboxother  = [ ];
    this.closestPlaces = [ ];
} 
```

现在每个实例都有自己的一组数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T20:57:06.280

这听起来像是一个经典的僵尸视图问题。基本上当你这样做时：

```
this.model.bind("reset", this.render, this); 
```

在你看来，你永远不会解绑它。因此，视图对象仍然绑定到模型并且不能从内存中删除。当您创建新视图并重置时，该侦听器仍处于活动状态，这就是您看到重复视图生成的原因。每次关闭并重做视图时，您都会积累听众，这就是它以 4 的倍数增加的原因。

`unbind`当您关闭视图并摆脱程序绑定时，您想要做的是您的听众。

```
this.model.unbind("reset", this.render, this); 
```

这应该消除讨厌的僵尸。当我找到它时，我会添加一个包含更详细信息的链接。

**更新 - 添加了有用的参考资料**

不久前我也遇到了这个问题。这是 Backbone 的常见问题。@Derick Bailey 有一个非常好的解决方案，效果很好并且解释得很好。我已经包含了下面的链接。看看他在他的历史中提供的一些答案。都是好书。

[僵尸！跑！](http://lostechies.com/derickbailey/2011/09/15/zombies-run-managing-page-transitions-in-backbone-apps/)

[骨干网、JS 和垃圾收集](http://lostechies.com/derickbailey/2012/03/19/backbone-js-and-javascript-garbage-collection/)

# javascript - 如何根据显示的用户文本禁用输入字段？

> ID：12231164
> 
> 赞同：1
> 
> 时间：2012-09-01T20:33:29.767
> 
> 标签：javascript, greasemonkey, firefox2

我有这个有效的代码片段：

```
var oldInput = document.getElementsByName ("prio");
oldInput[0].setAttribute ("disabled", "disabled"); 
```

这是相关的目标页面 HTML（已**更正**）：

```
<div id="content">
    <p>(CONTENT)</p>
    <form>
      <p>Priority: <input name="prio" type="text" value="285"></p>
      <p>Success: <input name="succ" type="text" value="6"></p>
    </form>
</div>
<table border="0" cellspacing="0" width="100%">
    <tbody>
        <tr>
            <td class="user">
            &nbsp;
            <a href="#" class="nav" title="Logout John">Logout</a>

            &nbsp;(User: John)
            </td>
        </tr>
    </tbody>
</table> 
```

在[jsfiddle.net/Kc3BB/3](http://jsfiddle.net/Kc3BB/3/)上查看。

我有许多用户的 1 个接入点。但我希望 5 个用户能够更改`prio`值。您可以看到用户名在页脚中。

是否可以在 javascript 中使用上面的 Firefox 2.x 代码而不使用 jQuery 来做到这一点？

例子：

```
if USER (from footer) == JOHN || LUKE || JEFF || MAX || ANDY
do nothing

else
disable PRIO BOX (from content) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:52:22.940

试试这个：

```
var tds = document.getElementsByTagName("TD",
    footerText = tds[tds - 1].textContent,
    user = footerText.match(/\(User: ([^\)]*\))/)[1].toUpperCase();

if (" JOHN LUKE JEFF MAX ANDY ".indexOf(" " + user + " ") !== -1) {
    // Do stuff
} else {
    // Do else stuff
    var oldInput = document.getElementsByName("prio");
    oldInput[0].setAttribute("disabled", "disabled");
} 
```

*注意*：您的伪代码与您所说的完全相反。根据您的实际需求修复上述代码。

**编辑**：我不记得 Firefox 2 是否支持`indexOf`数组。确实如此。所以你可以改用这条线：

```
if (["JOHN", "LUKE", "JEFF", "MAX", "ANDY"].indexOf(user) !== -1) { 
```

**编辑2**：我刚刚看到您的编辑并相应地更改了答案。我希望您的 HTML 片段实际上反映了页面的源代码，否则发现页脚元素将需要另一种方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T20:53:35.423

```
var allowed_users = ['John', 'Luke', 'Jeff', 'Max', 'Andy'];
var user = /\(User: ([^)]*)\)/.exec(document.getElementById('footer').textContent​​​​​​​​)[1];
if(allowed_users.indexOf(user) === -1) // user not in allowed_users array, disable priority
{
    var oldInput = document.getElementsByName('prio')[0];
    oldInput.setAttribute('disabled', 'disabled');
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T21:06:15.420

这*应该*适用于 Firefox 2.0：

```
//--- Make sure this list of names is all uppercase.
var usersWhoCanSetPriority = ['JOHN', 'LUKE', 'JEFF', 'MAX', 'ANDY'];

var bDisablePrio    = true;
var tdNodes         = document.getElementsByTagName ("TD");
for (var J = tdNodes.length - 1;  J >= 0;  --J) {
    var tdNode      = tdNodes[J];
    if (tdNode.className == "user") {
        var userName        = tdNode.textContent.replace (
            /^(?:.|\n|\r)+\(User:\s+([^)]+)\)(?:.|\n|\r)+$/i, "$1"
        ).toUpperCase ();

        if (usersWhoCanSetPriority.indexOf (userName) > -1) {
            bDisablePrio    = false;
        }
    }
}

if (bDisablePrio) {
    var oldInput = document.getElementsByName ("prio");
    oldInput[0].setAttribute ("disabled", "disabled");
} 
```

请参阅[更新的 Fiddle](http://jsfiddle.net/Kc3BB/5/)。

# c++ - 计时算法：C++ 中的clock() vs time()

> ID：12231166
> 
> 赞同：64
> 
> 时间：2012-09-01T20:33:35.820
> 
> 标签：c++, clock, timing

对于算法的计时（大约以毫秒为单位），这两种方法中的哪一种更好：

```
clock_t start = clock();
algorithm();
clock_t end = clock();
double time = (double) (end-start) / CLOCKS_PER_SEC * 1000.0; 
```

或者，

```
time_t start = time(0);
algorithm();
time_t end = time(0);
double time = difftime(end, start) * 1000.0; 
```

此外，从 Freenode 的 C++ 频道的一些讨论中，我知道时钟的分辨率非常差，因此对于（相对）快速算法而言，时间将为零。但是，哪个具有更好的分辨率 time() 或 clock()？还是一样？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-09-01T20:42:20.113

`<chrono>`如果您使用的是 C++11，那将是一个更好的库。

```
#include <iostream>
#include <chrono>
#include <thread>

void f()
{
    std::this_thread::sleep_for(std::chrono::seconds(1));
}

int main()
{
    auto t1 = std::chrono::high_resolution_clock::now();
    f();
    auto t2 = std::chrono::high_resolution_clock::now();
    std::cout << "f() took "
              << std::chrono::duration_cast<std::chrono::milliseconds>(t2-t1).count()
              << " milliseconds\n";
} 
```

示例取自[这里](http://en.cppreference.com/w/cpp/chrono/duration/duration_cast)。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-09-01T20:42:13.460

这取决于您想要什么：`time`测量实时时间，同时`clock`测量当前进程所花费的处理时间。如果您的进程休眠了相当长的时间，或者系统正忙于其他进程，那么两者将非常不同。

[http://en.cppreference.com/w/cpp/chrono/c/clock](http://en.cppreference.com/w/cpp/chrono/c/clock)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-09-01T20:46:31.003

time_t 结构可能是一个整数，这意味着它的分辨率为秒。

第一段代码：它只会计算 CPU 做某事的时间，所以当你执行 sleep() 时，它不会计算任何东西。可以通过计算 sleep() 的时间来绕过它，但它可能会在一段时间后开始漂移。

第二部分：只有秒级的分辨率，如果您需要亚秒级时间读数，则不是很好。

对于您可以获得的最佳分辨率的时间读数，您应该执行以下操作：

```
double getUnixTime(void)
{
    struct timespec tv;

    if(clock_gettime(CLOCK_REALTIME, &tv) != 0) return 0;

    return (tv.tv_sec + (tv.tv_nsec / 1000000000.0));
}

double start_time = getUnixTime();
double stop_time, difference;

doYourStuff();

stop_time = getUnixTime();
difference = stop_time - start_time; 
```

在大多数系统上，它的分辨率会下降到几微秒，但它会随着不同的 CPU 甚至主要内核版本而变化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-08T01:46:50.213

`<chrono>`是最好的。Visual Studio 2013 提供了此功能。就个人而言，我已经尝试了上面提到的所有方法。我强烈建议您使用该`<chrono>`库。它可以跟踪挂墙时间，同时具有良好的分辨率（远小于一秒）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-01T09:16:33.010

怎么样`gettimeofday()`？当它被调用时，它会使用时间信息更新两个结构（`timeval`和`timezone`）。通常，传递一个`timeval`结构就足够了，`timezone`结构可以设置为`NULL`. 更新后的`timeval`结构将有两个成员`tv_sec`和`tv_usec`. `tv_sec`是自 1970 年 1 月 1 日（Unix 纪元）00:00:00 以来的秒数，`tv_usec`是 wrt 的附加微秒数`tv_sec`。因此，可以得到以非常好的分辨率表示的时间。

它可以按如下方式使用：

```
#include <time.h>

struct timeval start_time;
double mtime, seconds, useconds;
gettimeofday(&start_time, NULL); //timeval is usually enough
int seconds  = start_time.tv_sec; //time in seconds
int useconds = start_time.tv_usec; //further time in microseconds
int desired_time = seconds * 1000000 + useconds; //time in microseconds 
```

# scripting - 相同的脚本，不同的行为

> ID：12231172
> 
> 赞同：0
> 
> 时间：2012-09-01T20:11:50.253
> 
> 标签：scripting, shell

我刚刚偶然发现了一个有趣的错误......仍在试图弄清楚到底发生了什么。也许你可以帮忙。

首先，语境。我目前正在构建另一个人到 html 转换器（出于某些原因，我不会在这里激励，但我需要它）。

因此，请查看下面的屏幕截图（请参阅链接），更准确地说是在概述的位置。看？在上壳上，我有 < ; 和>，即转义的html。在下面的外壳上，我有 < 和 > 直接。

但是正如你所看到的（或者我真的需要镜子吗？），`man 2 semget | webmanner`两边的命令是一样的，就像`which webmanner`. 两者大致同时执行，中间没有对脚本进行任何修改。

[哎呀，还不能发图……链接来了]

[http://aspyct.org/media/webmanner-bug.png](http://aspyct.org/media/webmanner-bug.png)

但是下面的外壳比较旧（大约 1 小时前打开）。较新的 shell 都打印出 < ;。所以我的第一个猜测是它以某种方式缓存了对文件的旧 inode 或旧块或其他内容的引用。

所以我在开始和结束时修改了部分脚本，以打印不同的消息。而且，令人惊讶的是，消息显示在两个终端上。但是， < ; 之间的差异仍然相同 和 <。

我很困惑......如何解释这种行为？我正在使用 OSX 10.8 (Mountain Lion)

编辑：好的，有一个很大的区别：下面的外壳使用 ruby​​ 1.9.3，而上面的是 1.8.7。两个版本之间的字符串处理是否有任何已知差异？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:50:45.607

你在使用 htmlentities 库吗？如果是这样，那么这个错误修复可能就是您所看到的

> Ruby 1.9.3 与 1.9.2 的行为略有不同：即使只包含 ASCII 字符，编码的结果也不是 ASCII。这可能并不重要，但这种变化会使两个版本产生相同的结果。

[https://github.com/threedaymonk/htmlentities/commit/46dafc959de03a02d0c1705bef7f1b157b350025](https://github.com/threedaymonk/htmlentities/commit/46dafc959de03a02d0c1705bef7f1b157b350025)

# android - android - imagebutton - 放置顶部和底部？

> ID：12231173
> 
> 赞同：0
> 
> 时间：2012-09-01T20:34:13.823
> 
> 标签：android, layout

我想要，第一个 imagebutton 填充顶部位置，第二个 imagebutton 填充底部位置。我是不是忘记了什么？

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<ImageButton
    android:id="@+id/imageButton1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    android:background="@color/white"
    android:src="@android:drawable/btn_star"
    android:layout_gravity="top" />

<ImageButton
    android:id="@+id/imageButton2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:layout_alignParentRight="true"
    android:background="@color/white"
    android:src="@android:drawable/btn_star"
    android:layout_gravity="bottom" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:39:06.770

问题是您需要使用`RelativeLayout`Try：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<ImageButton
    android:id="@+id/imageButton1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    android:background="#ffffff"
    android:src="@android:drawable/btn_star"
    android:layout_gravity="top" />

<ImageButton
    android:id="@+id/imageButton2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:layout_alignParentRight="true"
    android:background="#ffffff"
    android:src="@android:drawable/btn_star"
    android:layout_gravity="bottom" />

</RelativeLayout> 
```

![在此处输入图像描述](../Images/ecd54296fcbca27bc572789c38e00354.png)

希望有帮助。告诉我这是否是您想要完成的任务，或者您是否希望两个按钮均等地填充一半的屏幕高度。

如果是第二个选项，那么试试这个：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<ImageButton
    android:id="@+id/imageButton1"
    android:layout_weight="1"
    android:layout_width="match_parent"
    android:layout_height="0dp"
    android:background="#ffffff"
    android:src="@drawable/icon"
 />

<ImageButton
    android:id="@+id/imageButton2"
    android:layout_weight="1"
    android:layout_width="match_parent"
    android:layout_height="0dp"
    android:background="#ffffff"
    android:src="@drawable/icon"
 />

</LinearLayout> 
```

看起来像这样：

![在此处输入图像描述](../Images/4f42dc0881647dca68095f29fa343b21.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T20:37:31.540

如果“填充”是指它应该采用全宽，请使用`fill_parent`而不是`wrap_content`for `android:layout_width`。否则你应该使用`RelativeLayout`你的容器而不是`LinearLayout`：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<ImageButton
    ...
    android:layout_gravity="top" />

<ImageButton
    ...
    android:layout_gravity="bottom" />

</RelativeLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T20:40:26.617

尝试使用相对布局。使用它，您可以更轻松地指定按钮的位置。

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="fill_parent"
android:layout_height="wrap_content" >

<ImageButton
android:id="@+id/imageButton1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignParentLeft="true"
android:layout_alignParentRight="true"
android:layout_alignParentTop="true"
android:background="@color/white"
android:src="@android:drawable/btn_star"
android:layout_gravity="top" />

<ImageButton
android:id="@+id/imageButton2"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignParentBottom="true"
android:layout_alignParentLeft="true"
android:layout_alignParentRight="true"
android:layout_below="@+id/imageButton1"
android:background="@color/white"
android:src="@android:drawable/btn_star"
android:layout_gravity="bottom" />
    </RelativeLayout> 
```

您可以使用更多位置，例如 layout_below，并且更容易对齐。

更多职位，[http://developer.android.com/reference/android/widget/RelativeLayout.LayoutParams.html](http://developer.android.com/reference/android/widget/RelativeLayout.LayoutParams.html)

# c++ - MinGW 找不到 XInput.h 标头

> ID：12231176
> 
> 赞同：0
> 
> 时间：2012-09-01T20:35:26.677
> 
> 标签：c++, c, mingw, header-files

我正在尝试通过 .bat 文件将这个 main.cpp 文件编译成带有 MinGW 的 DLL。我在 Windows 上，而不是 Linux 顺便说一句。

compile.bat mingw\bin\g++ "srcdll\main.cpp" -O3 -DNDEBUG -s -shared -o "D:\CPP\output\main.dll"

但编译器一直说找不到 XInput.h。我也安装了 DirectX SDK，并且 include 和 lib 目录在我的 PATH 环境变量中。

主文件

```
#include <windows.h>
#include <XInput.h>

#define EXPORTREAL extern "C" __declspec(dllexport) double __cdecl
#define EXPORTSTRING extern "C" __declspec(dllexport) LPSTR __cdecl

EXPORTREAL setRumble(double index, double left, double right)
{
    XINPUT_VIBRATION vibration;

    vibration.wLeftMotorSpeed = left;
    vibration.wRightMotorSpeed = right;

    XInputSetState(index,&vibration);

    return index;
}

EXPORTREAL leftTrigger(double index)
{
    XINPUT_STATE state;

    XInputGetState(index,&state);
    return state.Gamepad.bLeftTrigger;
}

EXPORTREAL rightTrigger(double index)
{
    XINPUT_STATE state;

    XInputGetState(index,&state);
    return state.Gamepad.bRightTrigger;
}

EXPORTREAL leftThumbX(double index)
{
    XINPUT_STATE state;

    XInputGetState(index,&state);
    return state.Gamepad.sThumbLX;
}

EXPORTREAL leftThumbY(double index)
{
    XINPUT_STATE state;

    XInputGetState(index,&state);
    return state.Gamepad.sThumbLY;
}

EXPORTREAL rightThumbX(double index)
{
    XINPUT_STATE state;

    XInputGetState(index,&state);
    return state.Gamepad.sThumbRX;
}

EXPORTREAL rightThumbY(double index)
{
    XINPUT_STATE state;

    XInputGetState(index,&state);
    return state.Gamepad.sThumbRY;
}

EXPORTREAL getButtonState(double index)
{
    XINPUT_STATE state;

    XInputGetState(index,&state);
    return state.Gamepad.wButtons;
}

EXPORTREAL checkButton(double index, double button)
{
    WORD buttonWord;
    XINPUT_STATE state;

    buttonWord = button;

    XInputGetState(index,&state);
    return (state.Gamepad.wButtons & buttonWord) ? 1 : 0;
}

EXPORTREAL getCtrlState(double index)
{
    XINPUT_STATE state;

    return XInputGetState(index,&state);
}

BOOL APIENTRY DllMain( HMODULE hModule,
                       DWORD  ul_reason_for_call,
                       LPVOID lpReserved
                     )
{
    XINPUT_VIBRATION vibration;

    vibration.wLeftMotorSpeed = 0;
    vibration.wRightMotorSpeed = 0;

    XInputSetState(0,&vibration);

    return TRUE;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T23:00:17.653

1.  将标题路径添加到命令行
2.  错误（未定义的引用）来自链接。您应该在链接行中添加 .a/.o 的路径

# java - 使用 Flash Builder 4.6 调试 Java 应用程序

> ID：12231179
> 
> 赞同：1
> 
> 时间：2012-09-01T20:35:35.090
> 
> 标签：java, apache-flex, debugging, stateful

我有一个带有 Java 服务器的 Flex 应用程序。我有一些无状态和有状态的 Java bean。我想用 Flash Builder 4.6 调试 Flex 端。

每次调试启动时，我的 Java JSESSIONID 都会重新生成，因此我无法正确重新加载我的有状态 bean。在使用独立播放器进行调试或在 FB 4.6 中进行基于 Web 的调试时会出现此行为。

当我在浏览器中直接在 FB 之外启动我的应用程序时，JSESSIONID 没有按应有的方式重新生成，但我无法调试......

是否有在不重新生成 JSESSIONID 的情况下使用 FB 进行调试的技巧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T12:48:56.103

我假设 JSessionID 与浏览器 cookie 相关，可能不会在浏览器会话之间持续存在。因此，如果您可以将浏览器配置为每次打开新窗口或选项卡时不启动新会话，这可能会起作用。

除此之外; 您可以通过右键单击 Flash 实例并选择“调试器”将 Flash 实例连接到调试器会话。 [这个答案告诉您如何在不启动浏览器实例的情况下创建调试会话](https://stackoverflow.com/a/1894238/133840)。

引用相关文章：

> 您可以修改启动配置以引用任何不包含 SWF 的 URL；但我只是想补充一点，您还可以使用 URL“about:blank”，它的优点是（从 Flash Builder 4 开始）Flash Builder 甚至不会费心打开浏览器页面——它只会开始监听插座。

我经常使用这种方法来调试另一台计算机上的鼠标和键盘事件。一台计算机运行该应用程序；另一台计算机运行调试会话。

# php - MySQL 回调到 web-app

> ID：12231184
> 
> 赞同：2
> 
> 时间：2012-09-01T20:35:48.460
> 
> 标签：php, jquery, mysql

我试图找出最好的方法来通知我的网络应用程序数据库更改。我现在这样做的方式是，我有一个带有计数器的单独的 MySQL 表。

现在，当表 Foo 中发生某些数据库操作时，触发器正在累加计数器。然后，Web 应用程序每 5 秒轮询一次服务器以检查是否发生了某些事情（计数器编号已更改），如果是，则刷新应用程序中的数据。

我想要的是，我将能够从 MySQL 到服务器以及从那里到 Web 应用程序进行回调/通知，这样我就不需要经常轮询服务器。这有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:52:50.460

[facebook、gmail如何发送实时通知？](https://stackoverflow.com/questions/1086380/how-does-facebook-gmail-send-the-real-time-notification) 您不能直接从 MySQL 通知您的应用程序，但有一些解决方案可以节省服务器的带宽和负载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T23:38:04.627

处理此问题的一种方法 - 要么自己实现观察者模式，要么简单地使用 pubsub 消息传递选项（ZMQ/AMQ/RabbitMQ/Redis 等） - 当初始数据库操作发生时（确保事务已提交），发布pubusb 工具上主题的消息 - 您的应用程序可以订阅 pubsub 工具并在数据库更改时接收消息。

希望能帮助到你。

# iphone - 将 UILabel 转换为 UIImage 时的大小差异

> ID：12231185
> 
> 赞同：0
> 
> 时间：2012-09-01T20:35:53.343
> 
> 标签：iphone, ios, ipad, core-graphics, uilabel

我正在将 UILabel 绘制到 UIImage。
UILabel 的宽度为 193.5，而下面代码生成的 UIImage 为 194 宽。
为什么是这样？

```
UIGraphicsBeginImageContextWithOptions(label.bounds.size, YES, [[UIScreen mainScreen] scale]);
[label.layer renderInContext:UIGraphicsGetCurrentContext()];
UIImage *img = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:50:01.583

考虑一下 - 没有办法真正渲染半个像素。我想你可以在技术上将一个像素与另一个像素混合，但你仍然需要一个完整的像素。所以它必须四舍五入。我认为为您的任何 UI 元素坐标设置一个非整数值是错误的 - 您最终会得到一个看起来模糊的 UI。所以试着弄清楚如何解决半像素问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T20:43:07.680

你是如何设法获得 UILabel 宽度的半个像素的？它可能看到了这一点，并自动将其四舍五入为 194。

# c++ - C++ 如何将命令行参数转换为数组？

> ID：12231186
> 
> 赞同：3
> 
> 时间：2012-09-01T20:35:54.980
> 
> 标签：c++, arrays, assembly, command-line-arguments

我想知道 C++ 如何实际将命令行参数转换为 char 数组？这是什么“秘密”代码？我在哪里可以查看执行此操作的代码（即使它在汇编中，我也知道一些汇编）？我正在使用 Linux，如果有帮助的话。

谢谢你

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-01T20:43:19.183

在大多数（全部？）基于 Unix 的操作系统中，它们已经是一个数组。这就是操作系统在那里执行进程的方式——当一个进程启动时，已经有一组参数可供它使用。

将命令行转换为数组的代码位于 shell（如 bash）或启动另一个程序的任何其他程序中。`bash`它的资源是否可用，其他程序 - 它是不同的。

在 Windows 中，它们是一个字符串（您可以使用`GetCommandLine()`API 调用未修改），由 C 运行时库解析以将其转换为数组，因为语言规范要求它们以数组的形式出现。

对于使用 Visual C++ 编译的程序，执行此操作的代码包含在 Visual Studio 发行版中。您可能必须在安装程序中打开一个显示“包含 C 运行时库源”之类的复选框才能安装它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T21:31:44.703

管理命令行参数并在进程创建期间将其放入堆栈是一项操作系统工作。

对于 POSIX 系统，执行路径是：

1.  在您的程序中，您调用 execle/execve/... 系统调用，将路径传递给新进程可执行文件和命令行参数。
2.  这些数据进入内核
3.  内核更新其内部结构以考虑新进程标识并为新进程分配地址空间（如果不再需要，内核也会清除旧地址空间）。内核用零初始化进程内存，将信息从旧内存复制到堆栈顶部的新地址空间。
4.  内核将新进程放入调度队列并从`exec()`系统调用返回，将执行路径传输到用户空间并最终到达进程的入口点（这通常是`crt0.o`目标文件中的例程，默认情况下链接到每个可执行文件 -这个例程调用`main()`）。

对于 Linux，您可以在此处查看此代码： [http](http://www.cs.fsu.edu/~baker/devices/lxr/http/source/linux/fs/exec.c#L383) ://www.cs.fsu.edu/~baker/devices/lxr/http/source/linux/fs/exec.c#L383 ：

```
383 /*
384  * 'copy_strings()' copies argument/environment strings from the old
385  * processes's memory to the new process's stack.  The call to get_user_pages()
386  * ensures the destination page is created and not swapped out.
387  */ 
```

在`do_execve()`用户空间系统调用的内核对应部分中`execve()`，在第 1345 行，调用了`copy_strings()`'s，并且`copy_strings()`例程实际上完成了您所询问的工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-01T20:38:25.663

这通常由操作系统在为程序创建进程时处理。这段代码很可能用 C 语言编写（例如，如果操作系统是用 C 语言编写的），也可以是汇编语言。要找到此代码，您可能必须查看操作系统代码。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T20:37:31.197

它是 c 运行时库的一部分。如果您想知道那是什么，请看这里：[什么是 C 运行时库？](https://stackoverflow.com/questions/2766233/what-is-the-c-runtime-library)

我刚刚使用 Microsoft Visual Studio 创建了一个基本的 C++ 控制台应用程序，并在程序的第一行设置了一个断点。调试时，程序在该行停止，您调用查找调用堆栈以查看调用“main”的函数。调用函数是 c 运行时的一部分，它似乎包含一些操作命令行的代码……我没有仔细看，但这可能是你应该开始的地方。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-01T20:38:39.510

有时它不是`main()`首先执行的实际。例如，在 Visual Studio 上`mainCRTStartup()`，作为入口点的函数调用 Windows API 来检索和解析命令行（如果使用调试器，您可以看到这一点）。

# python - Python按开始和结束字符分割字符串

> ID：12231193
> 
> 赞同：5
> 
> 时间：2012-09-01T20:36:51.000
> 
> 标签：python, string, list

假设你有一个这样的字符串：`"(hello) (yes) (yo diddly)"`.

你想要一个这样的列表：`["hello", "yes", "yo diddly"]`

你会如何用 Python 做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-01T20:59:50.710

```
import re
pattern = re.compile(r'\(([^)]*)\)') 
```

该模式与您的字符串 ( `\(...\)`) 中的括号匹配，这些需要被转义。
然后它定义了一个子组 ( `(...)`) - 这些括号是正则表达式语法的一部分。
子组匹配除右括号 ( `[^)]*`)之外的所有字符

```
s = "(hello) (yes) (yo diddly)"
pattern.findall(s) 
```

给

```
['hello', 'yes', 'yo diddly'] 
```

**更新：**
使用`[^)]+`而不是`[^)]*`. 后者也将匹配一个空字符串。

正如 DSM 所建议的那样，使用非贪婪修饰符可能会使该模式更好地阅读：`pattern = re.compile(r'\((.+?)\)')`

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-01T20:39:58.157

我会这样做：

```
"(hello) (yes) (yo diddly)"[1:-1].split(") (") 
```

首先，我们切断了第一个和最后一个字符（因为无论如何都应该删除它们）。接下来，我们使用 ") (" 作为分隔符拆分结果字符串，给出所需的列表。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-01T20:45:01.953

这将为您提供任何字符串中的单词：

```
>>> s="(hello) (yes) (yo diddly)"
>>> import re
>>> words = re.findall(r'\((.*?\))',s)
>>> words
['hello', 'yes', 'yo diddly'] 
```

正如帝斯曼所说。

`?`在正则表达式中使其不贪婪。

# c++ - Xcode 3 ctime 声明问题

> ID：12231194
> 
> 赞同：0
> 
> 时间：2012-09-01T20:36:55.090
> 
> 标签：c++, xcode, macos

我正在将我的 c++ 引擎移植到 mac，所以我使用 premake 生成了一个 xcode 项目，它做得很好。

Box2D 内置于引擎中，其中一个文件“b2Broadphase.h”包含来自 c++ 标准库的算法。

这给出了这些错误：对于ctime 文件中的`::clock_t has not been declared`所有命令，依此类推。`using`

我无法弄清楚这一点，因为当使用 premake 构建 make 文件时，它运行良好并在 OSX 上构建了一个完美的库。它唯一的 Xcode 给出了这些错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:49:53.750

我的猜测是 Xcode 尚未配置为包含*实现*文件（.m 或 .cpp），或者尚未配置为链接到您正在使用的库。通常，您需要做两件事：1\. 包含头文件 2\. 使用实际可执行对象链接库。

在 Xcode 中，您可以通过在左侧的文件浏览器面板中选择项目（最顶部的项目）来执行此操作，并且主区域中有一个部分可以选择要链接到的库。您必须明确告诉它链接到您正在使用的任何库，即使您已经导入了它们的标头。

对于 .cpp 或 .m 实现文件，您需要告诉它将该文件包含在目标中以进行编译。这可以在构建设置（类似于 lib 包含的位置）中完成，或者当您选择文件时，右侧的检查器面板有一个小区域供您选择要包含文件的目标。（您只需要像这样“包含”实现文件，而不是 .h 文件）

# c# - 如何在桌面应用程序上使用 .Net Framework 4 对代码进行基准测试

> ID：12231195
> 
> 赞同：0
> 
> 时间：2012-09-01T20:37:11.163
> 
> 标签：c#, desktop-application, benchmarking

我已经编写了我的桌面应用程序，但有时它有点慢，所以我试图尽可能地优化它。问题是我不知道怎么做。

这是我有疑问的代码

```
if (((mainRibbonForm)Parent.Parent.Parent.Parent.Parent.Parent.Parent)).myParentScopeVar == false)
{
   //something goes here

}

//VS

if (myLocalScopeVar == false)
{
    //something goes here
} 
```

所有对象都是在 mainRibbonForm 中创建并分配的，看来我不能这样调用。

```
mainRibbonForm.myparentScopeVar == false 
```

因此，在最后一个对象中，我只是向后走，使用 Parent 命令变量来获取变量。

我不确定是否应该始终查看变量的父范围或将变量作为局部范围分配给最后一个控件，并且仅在父范围变量更改时才更新它，这并不经常发生，但确实发生了变化。

我在计时器中有一些这些，并且在代码中的每个地方都有。我对 C# 非常陌生，我将所有内容从 VB.Net 翻译成 C# 我只是想学习正确或最佳的 C# 编程实践

哪个更快并且使用更少的资源？

下次我如何自己进行基准测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:04:26.247

我认为这段代码太过分了，而且看起来很可怕：

```
if (((mainRibbonForm)Parent.Parent.Parent.Parent.Parent.Parent.Parent)).myParentScopeVar == false)
{
   //something goes here   
} 
```

而不是这个，我更喜欢使用静态变量，然后使用`mainRibbonForm.myParentScopeVar`. 所以你可以在你的类中插入这个：

```
public static bool myParentScopeVar; 
```

或者你可以通过构造函数传递这个布尔值。

* * *

如果您想进行基准测试，请使用作为[`Stopwatch`](http://msdn.microsoft.com/en-us/library/system.diagnostics.stopwatch.aspx)高分辨率计时器的类来测量您的代码将运行多长时间并循环您正在测试的代码更多次以获得包括他的最佳和最差性能的中等时间：

```
Stopwatch timer = new Stopwatch();
timer.Start();

for(int i = 0; i < 1000; i++)
{
    if (((mainRibbonForm)Parent.Parent.Parent.Parent.Parent.Parent.Parent)).myParentScopeVar == false)
    {
         //something goes here   
    }
}

timer.Stop();  
TimeSpan timespan = timer.Elapsed;

MessageBox.Show(String.Format("{0:00}:{1:00}:{2:00}", timespan.Minutes, timespan.Seconds, timespan.Milliseconds / 10));    

timer.Restart();

for(int i = 0; i < 1000; i++)
{
    if (myLocalScopeVar == false)
    {
         //something goes here
    }
}

timer.Stop();  
TimeSpan timespan = timer.Elapsed;

MessageBox.Show(String.Format("{0:00}:{1:00}:{2:00}", timespan.Minutes, timespan.Seconds, timespan.Milliseconds / 10)); 
```

我认为我的解决方案和您使用的第二个解决方案`myLocalScopeVar`更有效。

# dynamic - Go 中的即插即用包？

> ID：12231196
> 
> 赞同：1
> 
> 时间：2012-09-01T20:37:14.433
> 
> 标签：dynamic, go, load-time

我将如何让包在加载时将一些对象（例如函数）注册到注册表，以便向程序添加新包将自动向程序添加新功能，而无需修改其他包中的代码？

这是一个代码示例，应该说明我正在尝试做的事情。

src/say/say.go：

```
package main

import (
    "os"
    "reg"
)

func main() {
    if len(os.Args) != 2 {
        os.Stderr.WriteString("usage:\n    say <what_to_say>\n")
        os.Exit(1)
    }

    cmd, ok := reg.GetFunc(os.Args[1])
    if ok {
        os.Stdout.WriteString(cmd())
        os.Stdout.Write([]byte{'\n'})
    } else {
        os.Stderr.WriteString("I can't say that!\n")
        os.Exit(1)
    }
} 
```

src/reg/reg.go：

```
package reg

var registry = make(map[string]func() string)

func Register(name string, f func() string) {
    registry[name] = f
}

func GetFunc(name string) (func() string, bool) {
    f, ok := registry[name]
    return f, ok
} 
```

src/hi/hi.go:

```
package hi

import (
    "reg"
}

func init() {
    reg.Register("hi", func() string {
        return "Hello there!"
    })
} 
```

在编写代码时，我天真地认为 go 编译器可能会找到包“hi”并编译成二进制文件。然后，在加载时，init() 函数将运行。如果事情是这样的，我就可以加入如下内容来添加一个新的“say no”命令：

src/no/no.go:

```
package no

import (
    "reg"
)

func init() {
    reg.Register("no", func() string {
        return "Not a chance, bub."
    })
} 
```

但是，它似乎不是那样工作的。

我可能只是通过 Pythonic 的镜头来思考这个问题太多，但是有什么方法可以完成一些有点像我正在拍摄的事情吗？如果没有，我会改变我的策略，我会学到一些关于 Go 做事方式的新知识。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T06:40:46.657

由于您必须使用`import`以便编译器添加一个包，我的建议是执行以下操作：

您可以只使用一个包含多个插入*文件*的单个包，而不是使用多个插入*包*。每个命令文件都放在同一个包文件夹 (cmds) 中。这是可能的，因为您可以在一个包中包含多个，并且无论您添加多少新的插入文件，您都不必对 进行任何编辑。*`init``say.go`*

 *```
package main

import (
    "os"
    "reg"
    _ "cmds"
)
.... 
```

和以前的包没有

```
// Command no
package cmds

import (
    "reg"
)

func init() {
    reg.Register("no", func() string {
        return "Not a chance, bub."
    })
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T20:49:57.010

根据我读到的有关[init 函数](http://golang.org/doc/effective_go.html#init)的内容，我认为如果您只是将“hi”和“no”添加到要导入的包列表中，那么您的示例将起作用`say.go`。如果你这样做，它会起作用吗？

我知道您不想更改 中的代码`say.go`，所以我认为这并不是真正的解决方案。*

# c++ - 如何隐藏窗口的菜单栏？

> ID：12231199
> 
> 赞同：4
> 
> 时间：2012-09-01T20:37:58.360
> 
> 标签：c++, windows, winapi, visual-c++, menu

我正在尝试使用 Windows API 隐藏 C++ 应用程序中的菜单栏。我正在使用[AppendMenu / RemoveMenu](http://msdn.microsoft.com/en-us/library/windows/desktop/ms647629%28v=vs.85%29.aspx)来编辑项目。但我厌倦了整个基于菜单的界面，我只想隐藏整个应用程序菜单栏。如何使用 Windows API 做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-01T20:41:27.363

根据文档，使用 NULL参数调用[SetMenu 。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms647995%28v=vs.85%29.aspx)`HWND`

# vlc - VLC screen:// 不会使用 :sout= 生成文件

> ID：12231200
> 
> 赞同：2
> 
> 时间：2012-09-01T20:38:04.340
> 
> 标签：vlc

为什么这不会产生文件？它做的一切都是正确的，但保存到一个实际的文件.. 我使用的是 Linux，Vlc 1.1.9，编译时没有 skins2，qt 或 ncurses 接口......

```
vlc :sout=#transcode{vcodec=mp4,acodec=mp4a,vb=800,scale=1}:std{access=file,mux=mp4,dst="~/file.mp4"} screen:// screen-fps=12 screen-caching=100 
```

请注意，这也做同样的事情 - 显示 screen:// 正常，但不会输出到文件：

```
vlc :sout=#transcode{vcodec=h264,acodec=none,vb=800}:std{access=file,mux=avi,dst="/root/file.avi"} screen:// screen-fps=12 screen-caching=100 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-16T20:36:27.103

尝试这个

> vlc -vvv (PORT (UDP, HTTP)) --ts-dump-file video.ts 并添加更多命令 vlc -vvv (PORT (UDP, HTTP)) --sout-all file/ogg,mpg,ts:filename并添加更多命令

以上代码应该可以工作！

# c# - 整数格式首先作为千位分隔符，然后是百位分隔符

> ID：12231201
> 
> 赞同：2
> 
> 时间：2012-09-01T20:38:17.750
> 
> 标签：c#

我想格式化一个整数，使其首先出现在 1000 的分隔符 (,) 中，但之后出现 100 的分隔符 (,)

输入：123456789 输出：12,34,56,789

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T20:56:34.443

您可以创建一个`NumberFormatInfo`具有`NumberGroupSizes`为您提供该格式的数组的数组：

```
NumberFormatInfo info = new NumberFormatInfo();
info.NumberGroupSizes = new int[]{3,2};

Console.WriteLine(123456789.ToString("#,#", info)); 
```

输出：

```
12,34,56,789 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T20:52:59.830

这可以帮助您：1\. 取决于文化的货币，2\. 您想要的格式的货币，没有任何现金标记

```
int iValue = 2879068;
string sValue1 = String.Format("{0:C}", iValue);
string sValue2 = String.Format("{0:#,#.}", iValue); 
```

但如果你想要一些现金标记，只需执行以下操作：

```
{0:$#,#.}//or
{0:#,#.€} 
```

希望能帮助到你，

# javascript - 动态更改Javascript类对象的颜色？

> ID：12231215
> 
> 赞同：0
> 
> 时间：2012-09-01T20:39:58.650
> 
> 标签：javascript, jquery, css, collision-detection, euclidean-distance

我想在它们碰撞时将球的颜色更改为红色。我尝试使用我的函数`check()`来改变球碰撞时的颜色，`balls[i].color`但是我怎么知道球在碰撞时要比较的位置？

```
function randomXToY(minVal,maxVal,floatVal)
{
  var randVal = minVal+(Math.random()*(maxVal-minVal));
  return typeof floatVal=='undefined'?Math.round(randVal):randVal.toFixed(floatVal);
}

// The Ball class
Ball = (function() {

  // constructor
  function Ball(x,y,radius,color){
    this.center = {x:x, y:y};  
    this.radius = radius;               
    this.color = color;
    this.dx = 2;               
    this.dy = 2;        
    this.boundaryHeight = $('#ground').height();
    this.boundaryWidth = $('#ground').width();

    this.dom  = $('<p class="circle"></p>').appendTo('#ground');

    // the rectange div a circle
    this.dom.width(radius*2);
    this.dom.height(radius*2);
    this.dom.css({'border-radius':radius,background:color});

    this.placeAtCenter(x,y);         
  }

  // Place the ball at center x, y
  Ball.prototype.placeAtCenter = function(x,y){
    this.dom.css({top: Math.round(y- this.radius), left: Math.round(x - this.radius)});
    this.center.x = Math.round(x);        
    this.center.y = Math.round(y);             
  };

  Ball.prototype.setColor = function(color) {
    if(color) {
      this.dom.css('background',color);
    } else {
      this.dom.css('background',this.color);
    }           
  };

  // move and bounce the ball
  Ball.prototype.move = function(){
    var diameter = this.radius * 2;                                               
    var radius = this.radius;  
    if (this.center.x - radius < 0 || this.center.x + radius > this.boundaryWidth ) {
      this.dx = -this.dx;
    }
    if (this.center.y - radius < 0 || this.center.y  + radius > this.boundaryHeight ) {
      this.dy = -this.dy;
    }
    this.placeAtCenter(this.center.x + this.dx ,this.center.y +this.dy);

  };

  return Ball;
})();

var number_of_balls = 5;
var  balls = [];   
  var x; 
var y;
$('document').ready(function(){
  for (i = 0; i < number_of_balls; i++) { 
    var boundaryHeight = $('#ground').height();
    var boundaryWidth = $('#ground').width();
     y = randomXToY(30,boundaryHeight - 50);
     x = randomXToY(30,boundaryWidth - 50);
    var radius = randomXToY(15,30);
    balls.push(new Ball(x,y,radius, '#'+Math.floor(Math.random()*16777215).toString(16))); 
  }
  loop(); 
  check();

});

check = function(){
  for (var i = 0; i < balls.length; i++){

  for(var j=0;j<balls.length;j++){
      if(x==y){
      balls[i].color='#ff0000';
       alert("y");         
 }
    else{
    }
    }}

   setTimeout(check,8);  
};

loop = function(){
  for (var i = 0; i < balls.length; i++){
    balls[i].move();
  }

  setTimeout(loop, 8);    
}; 
```

[http://jsbin.com/imofat/743/edit](http://jsbin.com/imofat/743/edit)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T21:00:57.080

计算每个球的中心之间的[欧几里德距离。](http://en.wikipedia.org/wiki/Distance)然后，当这个距离小于或等于它们的半径之和时，就会发生碰撞：

![在此处输入图像描述](../Images/7589517352babfef505e98582e8b2aa9.png)

```
check = function() {
  for (var i = 0; i < balls.length; i++) {
    for(var j = 0; j < balls.length; j++) {
      if (i != j) { // ignore self-collision
        if (Math.pow(balls[j].center.x - balls[i].center.x, 2) + Math.pow(balls[j].center.y - balls[i].center.y, 2) <= Math.pow(balls[i].radius + balls[j].radius, 2)) {
          balls[j].setColor('red');
        } else {
          balls[j].setColor(balls[j].color);
       } 
    }
 }} 
```

这是一个**[演示](http://jsbin.com/imofat/753/edit)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T20:46:53.367

### 编辑：

对于与其他球的碰撞，它需要更多的工作..查看这篇文章：[Ball to Ball Collision](https://stackoverflow.com/q/345838/1633510)

* * *

就`setColor`在方向改变时，假设“碰撞”的意思是“撞墙”：

```
// move and bounce the ball
Ball.prototype.move = function(){
  var diameter = this.radius * 2;                                               
  var radius = this.radius;  
  if (this.center.x - radius < 0 || this.center.x + radius > this.boundaryWidth ) {
    this.dx = -this.dx;
    this.setColor( 'red' );
  }
  if (this.center.y - radius < 0 || this.center.y  + radius > this.boundaryHeight ) {
    this.dy = -this.dy;
    this.setColor( 'red' );
  }
  this.placeAtCenter(this.center.x + this.dx ,this.center.y +this.dy);
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T20:59:17.590

我在 check 方法中添加了一个实际的球碰撞检查：

```
check = function(){
  var dx, dy;
  var x1, x2, y1, y2, r1, r2;
  for (var i = 0; i < balls.length; i++){
      x1 = balls[i].center.x;y1=balls[i].center.y;r1=balls[i].radius;
      for(var j=0;j<balls.length;j++){
          if (i===j) {continue;} // collision with self

          x2 = balls[j].center.x;y2=balls[j].center.y;r2=balls[j].radius;

          if( Math.sqrt((x1-x2)*(x1-x2) +  (y1-y2)*(y1-y2)) <=(r1+r2)  ){ // check collision
              balls[i].setColor('#ff0000');
          }
          else{
          }
      }
  }

  setTimeout(check,8);  
}; 
```

# javascript - YUI 自动完成............需要从 javascript 更改 z-index 值

> ID：12231217
> 
> 赞同：1
> 
> 时间：2012-09-01T20:40:10.663
> 
> 标签：javascript, yui

我是 YUI 的新手，我正在做一些 SugarCRM PHP 修改。我需要更改此类的 z-index

.yui3-aclist { z-index: 100; }

我如何从 JAVASCRIPT/YUI 中做到这一点？？？

API 不允许我访问 .css 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T20:57:33.277

设置 zIndex 实际上不会做任何事情，因为 AutoCompleteList 没有从 WidgetStack 继承（从 YUI 3.4.0 开始，无论如何）。

相反，您可以直接在 AutoComplete 插件的边界框上设置它：

```
var node = Y.one('#ac-input');
node.plug( Y.Plugin.AutoComplete, { ... });
node.ac.get('boundingBox').setStyle('zIndex', 50); 
```

你可以在这里看到一个工作示例：

[http://jsbin.com/amayux/1/edit](http://jsbin.com/amayux/1/edit)

# wpf - WPF DevExpress LookUpEdit 弹出窗口太高

> ID：12231220
> 
> 赞同：1
> 
> 时间：2012-09-01T20:40:25.943
> 
> 标签：wpf, devexpress

我在 WPF 用户控件中使用 DevExpress LookUpEdit 组件。我的问题是弹出矩形总是比 PopupContentTemplate 中项目的内容大得多。我似乎找不到管理这个的属性，或者我可能会不正确地使用控件（？）。

谢谢

![在此处输入图像描述](../Images/7cfbbc950909b8edfbbd4dacb6c96f04.png)

```
<UserControl xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"  
    x:Class="FTI_Opp_WPF.Views.UserControls.ViewSelector"
    xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    mc:Ignorable="d">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary
                    Source="../../Common/Styles.xaml" />
                <ResourceDictionary
                    Source="../../Common/Strings.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Label Grid.Column="0" FontSize="12" Foreground="gray" Margin="0,-2,1,0">View:</Label>

        <dxg:LookUpEdit
            Grid.Column="1"
            dx:ThemeManager.ThemeName="MetropolisLight"
            Name="viewLookupEdit"
            AutoPopulateColumns="False"
            AutoComplete="True"
            IncrementalFiltering="True"
            ImmediatePopup="True"
            IsReadOnly="True"
            HorizontalAlignment="Right"
            VerticalAlignment="Top"
            Text="{Binding SelectedViewName}"
            ShowSizeGrip="false"
            MinWidth="200">
            <dxg:LookUpEdit.PopupContentTemplate>
                <ControlTemplate>
                    <StackPanel Orientation="Vertical" Height="auto">
                        <ListBox Name="lstMain" 
                                 ItemsSource="{Binding Path=GridViews}" 
                                 HorizontalAlignment="Stretch"
                                 BorderThickness="1"
                                 MouseUp="OnRowMouseUp">
                            <ListBox.ItemContainerStyle>
                                <Style
                                    TargetType="{x:Type ListBoxItem}">
                                    <Setter Property="BorderThickness">
                                        <Setter.Value>1</Setter.Value>
                                    </Setter>
                                    <Setter
                                        Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate
                                                TargetType="{x:Type ListBoxItem}">
                                                <Grid Name="gridView" Height="25">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="14"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>

                                                    <Image Grid.Column="0"
                                                        Margin="0,-2,0,0"
                                                        Visibility="Visible"
                                                        Source="..\..\Images\globe.png"
                                                        Height="12"
                                                        Width="12" />

                                                    <TextBlock 
                                                        Margin="2,3,0,0" 
                                                        Grid.Column="1" 
                                                        Name="viewName" 
                                                        VerticalAlignment="Stretch"  
                                                        Text="{Binding Path=Name}"/>
                                                </Grid>
                                                <ControlTemplate.Triggers>
                                                    <Trigger
                                                        Property="IsMouseOver"
                                                        Value="true">
                                                        <Setter
                                                            TargetName="gridView"
                                                            Property="Background" Value="{Binding Converter={StaticResource StyleConverter},ConverterParameter=HOVER_BACKGROUND_COLOR}">
                                                        </Setter>
                                                        <Setter
                                                            TargetName="viewName"
                                                            Property="Foreground" Value="White">
                                                        </Setter>
                                                        <Setter
                                                            TargetName="viewName"
                                                            Property="FontWeight" Value="BOLD">
                                                        </Setter>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>

                                    <Style.Triggers>
                                        <DataTrigger
                                            Binding="{Binding Path=IsEnabled}"
                                            Value="False">
                                            <Setter
                                                Property="IsEnabled"
                                                Value="{Binding Path=IsEnabled}" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ListBox.ItemContainerStyle>
                        </ListBox>
                        <Button
                            Name="btnAdvanced"
                            Margin="10,0,0,0"
                            Style="{StaticResource Link}"
                            Content="manage views"
                            Click="OnManageViewsClick" />

                    </StackPanel>
                </ControlTemplate>
            </dxg:LookUpEdit.PopupContentTemplate>
        </dxg:LookUpEdit>
    </Grid>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T11:25:01.190

DX 不提供“自动调整大小以弹出内容”功能。您需要使用 PopupMinHeight / PopupMaxHeight / PopupHeight。

请参阅此链接： http: [//www.devexpress.com/Support/Center/p/Q428449.aspx](http://www.devexpress.com/Support/Center/p/Q428449.aspx)

# c++ - C++ stl，没有返回类型的函数

> ID：12231226
> 
> 赞同：2
> 
> 时间：2012-09-01T20:41:05.057
> 
> 标签：c++, stl

```
template<typename _Tp1>
operator auto_ptr_ref<_Tp1>() throw()
{ return auto_ptr_ref<_Tp1>(this->release()); }

template<typename _Tp1>
operator auto_ptr<_Tp1>() throw()
{ return auto_ptr<_Tp1>(this->release()); } 
```

我在 stl 类 auto_ptr 中找到了这两种方法的定义。

有人可以解释一下，构造函数以外的函数如何没有返回类型？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T20:41:59.397

因为它们是分别返回`auto_ptr_ref<_Tp1>`和的隐式转换运算符`auto_ptr<_Tp1>`。这些本身用作*返回类型*声明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T20:42:20.113

将运算符转换为类型`auto_ptr_ref`和`auto_ptr`

n3337 12.3.2/1

> 类 X 的成员函数，没有参数，名称为
> 
> 转换函数 ID：运算符转换类型 ID
> 
> 转换类型 ID：类型说明符序列转换声明器选择
> 
> 转换声明符：ptr 运算符转换声明符opt
> 
> 指定**从 X 到由 conversion-type-id 指定的类型的转换**。

# visual-c++ - 未捕获 Visual C++/STL 异常

> ID：12231229
> 
> 赞同：1
> 
> 时间：2012-09-01T20:41:41.057
> 
> 标签：visual-c++

以下方法（在 Visual Studio 2008 ref 类中）包含一个我认为会被捕获的简单错误 - 但它会导致进程以“调试断言失败！”而中止。消息框（msg 包括有问题的 STL 向量 src 行#）。无论是在 Debug 还是 Release 模式下编译，都会发生这种情况。本例中的进程是 Excel.exe，该方法通过 COM 互操作访问。

有人能告诉我为什么这个错误没有被困住吗？

```
 String^ FOO()
    {
        try {
            std::vector<int> vfoo;
            vfoo.push_back(999);
            return vfoo[1].ToString();  //!!!! error: index 1 not valid
        }
        catch(std::exception& stdE) { // not catching
            return "Unhandled STL exception";
        }
        catch(System::Exception^ E) { // not catching
            return "Unhandled .NET exception: " + E->Message;
        }
        catch(...) { // not even this is catching
            return "Unhandled exception";
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T21:53:38.857

在调试配置中，您将获得一个由迭代器调试功能启用的断言。旨在帮助您在使用标准 C++ 库时发现错误。您可以使用调用堆栈窗口追溯代码中触发断言的语句。该功能由 _HAS_ITERATOR_DEBUGGING 宏控制，很少有理由在调试版本中将其关闭。嗯，没有。

在发布配置中，您将遇到 Checked Iterators 功能，这是 VS2005 引入的 Secure CRT Library 计划的一部分，由 _SECURE_SCL 宏控制。它有一个内置的钩子让调试器停止，就像上面一样，向你展示它为什么会被炸毁。但并非没有调试器，如果没有附加调试器，它会立即终止您的程序，并带有 SEH 异常代码 0xc0000417。这就是降压停止的地方，CRT 的 DLL 版本是使用 _SECURE_SCL 构建的，当您编写托管代码时，您无法选择不使用该 DLL。使用 /MT 构建需要完全关闭它，而这在 C++/CLI 中是不可能的。

这往往会使 C++ 程序员变得非常疯狂，catch (...) {} 是一种有福的语言功能，即使恢复程序状态的几率非常接近于零。但是有一个后门（总是有一个后门），参数验证代码通过函数指针发出错误条件。默认处理程序立即中止程序，无法捕获它，即使使用 SetUnhandledExceptionFilter() 也不行。您可以使用 _set_invalid_parameter_handler() 函数替换处理程序。这需要通过您的 Main() 方法完成，如下所示：

```
#include "stdafx.h"
#include <stdlib.h>

using namespace System;

#pragma managed(push, off)
void no_invalid_parameter_exit(const wchar_t * expression, const wchar_t * function, 
                               const wchar_t * file, unsigned int line, uintptr_t pReserved) {
    throw new std::invalid_argument("invalid argument");
}
#pragma managed(pop)

int main(array<System::String ^> ^args)
{
    _set_invalid_parameter_handler(no_invalid_parameter_exit);
    // etc...
} 
```

它将运行您的一个捕获处理程序。管理的，没有留下像样的面包屑来显示发生了什么，但这对于本机 C++ 异常来说是正常的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T21:04:14.623

“调试断言失败！” 听起来像是一个类似 assert() 的检查。这些不是例外。

我实际上使用 assert() 样式检查构成编程错误的所有内容，并对运行时错误使用异常。也许微软遵循类似的政策；“索引越界”显然是一个编程错误，而不是由例如您的磁盘已满引起的。

# c# - 如何使用 C# 测试代理？

> ID：12231236
> 
> 赞同：0
> 
> 时间：2012-09-01T20:42:39.487
> 
> 标签：c#, testing, proxy

> **可能重复：**
> [C# 通过代理连接](https://stackoverflow.com/questions/1938990/c-sharp-connecting-through-proxy)

我已经尝试了很长时间以多种不同的方式执行此操作，但似乎没有任何效果。本质上，我想在 C# 中创建一个代理检查器，通过实际转到一个页面（例如[http://google.com/ncr](http://google.com/ncr)）来检查它，并从那里确定它是否到达那里。

这甚至可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:48:17.237

如果是http代理

```
bool OK = false;
try
{
    WebClient wc = new WebClient();
    wc.Proxy = new WebProxy(Host, Port);
    wc.DownloadString("http://google.com/ncr");
    OK = true;
}
catch{} 
```

# css - 单击透明选择在Firefox上不起作用

> ID：12231237
> 
> 赞同：0
> 
> 时间：2012-09-01T20:42:41.657
> 
> 标签：css, firefox, event-handling, cross-browser

我试图摆脱默认选择以使用更符合我网站风格的东西。

我创建了一个`<button>`来包装选择。给它 opacity: 0 和绝对定位和大小以使其适合按钮。使用一些 jquery，我做到了，以便活动选项也显示为按钮的文本，在`<span>`. 它看起来很不错。

问题是在 chrome 和 safari 上完美运行，而在 firefox 上却完全不行！

webkit即使不可见也会听选择的点击，moz不要（对IE和opera很好奇）。我真的不知道如何解决这个问题......

这里是一个重现问题的小提琴：http: [//jsfiddle.net/bakaburg1/YyvRf/2/](http://jsfiddle.net/bakaburg1/YyvRf/2/)

欢迎任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:55:48.897

您可以使用`<div>`而不是`<button>`

HTML：

```
<div class="btn btn-small select-container">
    <select>
        <option>title</option>
        <option>date</option>
        <option>author</option>
    </select>
</div> 
```

CSS：

```
.btn.btn-small{
  padding-bottom: 2px;
  padding-top: 2px;
  color: #737373;
  font-family: 'Lucida Sans Unicode', 'Lucida Grande', sans-serif;
  font-size: 14px !important;
  font-variant: small-caps;
  font-weight: bold;
}

.btn.select-container {
  position: relative;
  padding-right: 24px;
}

.btn.select-container select {
  position: absolute;
  top: -1px;
  left: 0;
  height: 117%;
  width: 100%;
  opacity: 0;
  filter: alpha(opacity=0);
  z-index: 1000;
}

select.btn {
  width: initial;
  height: 23px;
  padding-right: 20px;
  -webkit-appearance: none;
}

select.btn:focus {
  outline: none;
}

.select-container {
  position: relative;
} 
```

在这里看到它：http: [//jsfiddle.net/YyvRf/3/](http://jsfiddle.net/YyvRf/3/)

# language-agnostic - 为什么'bicrement'不可能像这样？

> ID：12231261
> 
> 赞同：1
> 
> 时间：2012-09-01T20:46:54.900
> 
> 标签：language-agnostic, increment

为什么这是不可能的？

```
int c = 0;
++c++; 
```

或者在 PHP 中：

```
$c = 0;
++$c++; 
```

我希望它将变量 c 增加 2，或者可能会做一些奇怪的事情，但是它在编译时会出错。我试图想出一个理由，但实际上一无所获……我的理由是：

1.  编译器读取 ++
2.  它读取变量
3.  它会做任何事情来使变量的值递增，然后在执行应用程序时返回
4.  它遇到另一个++
5.  它使用前一个变量以便在增加值之前返回它
6.  这就是令人困惑的地方：它是使用变量 c，还是尝试读取 (++c) 返回的值？或者，由于您只能执行 varname++（而不是 2++），它是否将 (++c) 视为指针，然后尝试读取该内存位置？不管它做什么，为什么它会给出一个编译错误？或者是错误预防，因为编译器的程序员知道它不会做任何有用的事情？

我并不是真的想使用它，当然也不是用于非一次性使用的代码，但我只是好奇。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T20:48:15.043

出于同样的原因，您不能这样做：

```
c++ = 5; 
```

它返回一个值，该值不能修改也不能赋值。这也不是运行时错误 - 那是编译错误。[（像这个。）](http://codepad.org/zJKPMfOO)

返回引用也没有意义，因为那时：

```
$a = 1;
$b = $a++; // How can it be a reference if b should be 1 and a should be 2? 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T00:52:50.977

这*不一定*与语言无关，尽管看到一种不同的语言我会有点惊讶。

在 C 中（因此我假设在所有基于 C 的非烦人语言中），运算符优先级意味着您的表达式等同于`++(c++)`. 根据您的逐步说明，您期望它等同于`(++c)++`，但事实并非如此。后缀`++`比前缀“绑定更紧密” `++`。

就像大家说的那样，表达式`c++`产生一个值，而不是一个可修改的对象（C 中引用一个对象的表达式称为左值）。这是必要的，因为对象`c`不再包含表达式计算的值——没有`c++`可以引用的对象。

在 C++ 中（不要与`c++`! 混淆），`++c` *是*一个左值。它指的是`c`现在具有新值的对象。

所以在 C++`(++c)++`中是语法正确的。`c`如果is 是类型，它恰好具有未定义的行为`int`（至少，它在 C++03 中做到了：C++11 定义了一些以前未定义的东西，而我对这些更改不是最新的）。

因此，如果您想象（或继续发明）一种类似 C++ 的语言，其中运算符优先级是您所期望的，那么您*可以*安排`++c++`它是有效的。大概它会增加`c`两次，并评估为旧值和新值之间的值。从某种意义上说，这种想象中的语言会“令人讨厌”，因为它与 C++ 略有不同，这往往会让人感到困惑。

`++c++``c`如果是重载两个增量运算符的用户定义类型的实例，则在 C++ 中也有效。原因是用户定义类型的右值*是*一个对象（“临时对象”），可以修改。但是一旦表达式被求值，临时的就被破坏了，修改也丢失了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T21:05:33.363

解释这一点的另一种方法是`++`运算符仅对左值进行操作。但是当你组合它们时，它被解析为`++(c++)`或者`(++c)++`- 在任何一种情况下，括号外的运算符的参数是一个右值（`c`在增量之前或之后的值），而不是一个左值。

# ios - 关闭 UiTableView 上 UITextField 的数字键盘的最优雅方法

> ID：12231263
> 
> 赞同：1
> 
> 时间：2012-09-01T20:47:04.733
> 
> 标签：ios, uitableview

我在 UITableView 上有一个 UITextField，并且我使用的是数字键盘，但是我希望当用户单击除 UiTextField 之外的任何内容时将其关闭。

我见过几种解决方案，但似乎没有一个明确的答案。例如，一些关于手势的讨论，当我实现它们时，它们似乎无法使用下面的代码工作：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {

    [[self view] endEditing:TRUE];

} 
```

如您所见，我正在尝试，但似乎没有一种方法可行。有人可以指导我吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T20:54:36.980

您应该改用 resignFirstResponder ：

```
[textField resignFirstResponder]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T20:55:37.993

通常，您会希望对不应关闭键盘的区域进行点击测试；但一般来说，要求是告诉当前处于焦点的控件“退出”它的状态为“firstResponder”。它可能看起来像这样：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
 [self.userInput resignFirstResponder];
} 
```

但是，您可能还需要为此考虑一个特殊的手势识别器，这样您就不必从长远来看过度分析触摸的 NSSet（将确定实际“解雇请求”之间差异的任务委托给 GestureRecognizer ！”点击和“我可以滚动这个吗？”滑动。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-01T20:56:56.637

使用以下代码

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
  UITouch *touch = [[event allTouches] anyObject];
  // Note the '!':
  if(![[touch view] class] isKindOfClass [UITableViewController class]]){
    // It's not a bubble they touched, dismiss the keyboard:
    [self.view endEditing:YES];
  }
  [super touchesBegan:touches withEvent:event];
} 
```

要不然

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
  UITouch *touch = [[event allTouches] anyObject];
  // Note the '!':
  if(![[touch view] class] isKindOfClass [UITableViewController class]]){
    // It's not a bubble they touched, dismiss the keyboard:
    [textField resignFirstResponder];

  }
  [super touchesBegan:touches withEvent:event];
} 
```

这有助于做你想做的事

# java - java.sql.SQLException：靠近“。”：语法错误

> ID：12231265
> 
> 赞同：2
> 
> 时间：2012-09-01T20:47:07.520
> 
> 标签：java, sql, sqlite, jdbc

我找到了我搜索的 SQL 来更新一些字段，但我得到了标题的错误：

```
UPDATE a
SET a.json = 'ex', a.last_save = 'ex', a.carte = 'ex'
FROM partie_l AS a
INNER JOIN carte AS b
ON a.start_carte = b.hash
WHERE b.json = 'ex' AND a.start_joueurs = 'ex' AND a.param = 'ex' 
```

我已经用 ex 替换了我的数据，否则它会太长。

这是我的表格的结构。

```
CREATE TABLE "carte" ("hash" TEXT  NOT NULL PRIMARY KEY ,"json" TEXT NOT NULL ,"nb_jrs" INTEGER,"preview" BLOB, "creator" TEXT DEFAULT atoll, "name" TEXT, "tetra" BOOL)

CREATE TABLE "partie_l" ("id" INTEGER PRIMARY KEY  NOT NULL ,"json" TEXT,"create" DATETIME,"last_save" DATETIME,"start_carte" TEXT,"preview" BLOB,"param" TEXT,"start_joueurs" TEXT,"carte" TEXT, "name" TEXT) 
```

编辑：Sqlite 不支持内连接

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T20:48:34.220

尽量不要使用要更新的表的表别名。

```
UPDATE partie_l 
SET json = 'ex', 
    last_save = 'ex',
    carte = 'ex' 
FROM partie_l 
    INNER JOIN carte AS b 
    ON partie_l.start_carte = b.hash 
WHERE b.json = 'ex' AND partie_l.start_joueurs = 'ex' AND partie_l.param = 'ex' 
```

对于 SQLite 尝试

```
UPDATE partie_l 
SET json = 'ex', 
    last_save = 'ex',
    carte = 'ex' 
WHERE partie_l.start_joueurs = 'ex' 
AND partie_l.param = 'ex' 
AND partie_l.start_carte IN (SELECT hash FROM carte WHERE json='ex') 
```

# c++ - Qt 编译错误：“内存不足分配 134 MB”“cc1plus.exe 未找到”

> ID：12231266
> 
> 赞同：8
> 
> 时间：2012-09-01T20:47:39.703
> 
> 标签：c++, qt

我正在开发一个需要大量不同图像的 Windows 游戏，我将它们放入 resources.qrc 中，它们都在里面。14 MB。

当我尝试编译时，唯一的错误是：“内存不足分配 134 MB”“cc1plus.exe 未找到”。

我该如何处理？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2017-08-04T09:25:16.687

Windows 7SP1 x86 4 GB 内存

Qt 5.7.0

当我在 Qt 的资源中添加大文件时，我遇到了同样的问题。我有错误：

> cc1plus.exe:-1: 错误：分配 1073745919 字节的内存不足

解决方案：

添加`CONFIG += resources_big`到`*.pro`文件中。

我把它放在这里：*[cc1plus.exe：内存不足| 60MB加密资源文件](https://forum.qt.io/topic/62655/cc1plus-exe-out-of-memory-60mb-encrypted-resource-file/8)*

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-01T21:22:06.187

Don't put them in the qrc, keep them as individual resources (or a new qrc file for each of the image), and just load them on application startup. Qt generates a qrc_XXXXX.cpp file where it effectively inserts the binary data in form of char array of ALL your resources in the resource fileXXXXX in this file (yes, ONE array for your images of 14MB, ie: 14680064 bytes (written as hex (0xXX) bytes into 1 file... it will be big!), highly possibly poor compiler just coughs on them...

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-10-14T11:52:23.873

嗯，我也有这个问题。但在我的情况下，投入所有资源`.exe`是必要的。

在这个错误之后，我购买了额外的 RAM（项目非常重要），然后我的 RAM 变成了 12 GB（从 6 GB）。

但是当错误没有消失时，我感到非常惊讶:) 经过一番谷歌搜索，终于，我在[那里](https://sysprogs.com/w/forums/topic/cc1plus-exe-out-of-memory-allocating-65536-bytes/)找到了答案。问题是`cc1plus.exe`可执行内存限制。因此，在 Qt 的情况下，可以通过以下步骤解决此问题（对于 Windows 7，MinGW32 4.9.2，对于其他可能只需要更改路径）：

1.  如果您的操作系统是 32 位，则在 cmd（作为管理员）中输入`bcdedit /set IncreaseUserVa 3072`
2.  安装[masm32](http://masm32.com/download.htm)；
3.  打开 cmd （也以管理员身份）；
4.  放`cd C:\Qt\Tools\mingw492_32\libexec\gcc\i686-w64-mingw32\4.9.2`
5.  放`C:\masm32\bin\editbin.exe /LARGEADDRESSAWARE cc1plus.exe`

就这样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-09-13T14:53:40.587

也不要忘记显而易见的事情：该消息可能实际上是真实的，并且您确实没有足够的内存，或者无法为需要它的进程提供内存。

我的系统上有 16GB 的 RAM，对于我的小型应用程序来说应该足够了。“不可能是这样的。” 我想……但我的机器已经好几个星期没有重新启动了。

只需重新启动系统即可为我修复此错误。

# fpdf - 图像过多导致内存泄漏

> ID：12231274
> 
> 赞同：0
> 
> 时间：2012-09-01T20:48:32.137
> 
> 标签：fpdf

我有这个脚本

```
set_time_limit(0);
require('fpdf.php');
$pdf=new FPDF();
for($x=0;$x<5000;$x++)
{
    $pdf->AddPage('P',array(500,1000));
    $pdf->Image("image".$x,0,0);
}
$pdf->Output(); 
```

我`memory_limit=1000MB`进去了，`php.ini`但什么也没发生。

如果我停止`for`20 次之后，它会起作用。

为什么？我怎样才能让它工作 5000 次？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:52:25.450

我没有使用过 FPDF，它的文档很糟糕，但我想你可以 $pdf->Close() 并重新开始。您也可以尝试**FPDF::Close**它应该释放内存。

如果没有内存池，我认为使用 php 是不可能的，您将不得不大量新建/删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T14:47:55.503

我终于找到了答案！

您必须`memory_limit`在`php.ini`.

（默认情况下，该行类似于“memory_limit=8M;”）。

PS：别忘了重启apache。

# c# - 创建引用第 3 方 DLL 的独立 C# 可执行文件？

> ID：12231279
> 
> 赞同：1
> 
> 时间：2012-09-01T20:49:02.337
> 
> 标签：c#, dll, exe

> **可能重复：**
> [在编译的可执行文件中嵌入 DLL](https://stackoverflow.com/questions/189549/embedding-dlls-in-a-compiled-executable)

我想用 C# 制作一个独立的程序，我有一个引用的 dll，所以我不能只从 bin/release/.exe 复制 exe，我必须复制 exe 和 dll。

我希望用户能够下载和运行 exe，而不是 exe 和 dll。独立我的意思是只有exe，没有安装程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T20:51:01.087

看看[ILMERGE](http://research.microsoft.com/en-us/people/mbarnett/ilmerge.aspx)（并[下载](http://www.microsoft.com/en-gb/download/details.aspx?id=17630)）：

> ILMerge 是一个用于将多个 .NET 程序集合并到一个 .NET 程序集的实用程序。它适用于可执行文件和 DLL，并带有几个用于控制输出处理和格式的选项。有关详细信息，请参阅随附的文档。

* * *

或者，查看其他部署选项，例如[ClickOnce](http://en.wikipedia.org/wiki/ClickOnce)：

> ClickOnce 是一项 Microsoft 技术，使用户能够通过单击网页中的链接来安装和运行 Windows 应用程序。（此类应用程序称为智能客户端。） ClickOnce 是 Microsoft .NET Framework 2.0 及更高版本的组件，支持部署使用 Windows 窗体或 Windows Presentation Foundation 制作的应用程序。

* * *

第三种选择是创建安装程序 - 使用[安装项目](http://msdn.microsoft.com/en-us/library/19x10e5c%28v=vs.100%29.aspx)或第三方安装程序（有很多）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T20:52:17.297

将您的 dll 作为资源嵌入到您的可执行文件中，

附加到`AppDomain.CurrentDomain.AssemblyResolve`事件，

并从资源中读取您的 dll 并在事件中返回它。

# html - 字体更改和自动调整大小加上填充

> ID：12231280
> 
> 赞同：0
> 
> 时间：2012-09-01T20:49:25.443
> 
> 标签：html, css

我有一个页脚定义为

```
div#footer { 
    width:100%;  
    bottom:0; 
    background:url(../images/bg_footer0.png) repeat-x;
} 
```

其 html 正文设计为

```
html,body {
    margin:0;
    padding:0;
    height:100%;
    font-family:arial, Helvetica, sans-serif;
    color:#666;
    background:url(../images/bg_body.png) repeat-x;
    font-size:12px;
} 
```

但是当我更改`arial`为`serif`字体系列时，页脚从底部开始填充，我想这在所有字体更改中都很常见。但是，无论发生什么变化，为什么以及如何始终将页脚真正添加到底部？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:54:18.540

试试这个

```
 div#footer { 
          width:100%;  
          bottom:0; 
          background:url(../images/bg_footer0.png) repeat-x;
          position: absolute;
         } 
```

实际上你可以选择它

```
 #footer{} 
```

除非您有其他类型的元素具有相同的页脚 id，否则会很糟糕

# python - Django 中的 Mysql_query

> ID：12231283
> 
> 赞同：0
> 
> 时间：2012-09-01T20:49:37.697
> 
> 标签：python, django, django-views

我在 Django 中有一个项目，该项目连接到一个名为 billing 的 mysql 数据库。我想知道是否可以进行如下查询：

```
SELECT * from cdr where accountcode = 'MARY' 
```

并将结果显示在一个页面中，我的问题是创建表cdr的数据库与我的项目不一样，它只是在同一台服务器中。

是否可以？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:22:39.993

是的，这是可能的。

[多个数据库的文档](https://docs.djangoproject.com/en/dev/topics/db/multi-db/)

[有关原始 SQL 查询的文档](https://docs.djangoproject.com/en/dev/topics/db/sql/)

# ruby-on-rails - 资产内容（图像、js 和 css）随不同请求随机切换

> ID：12231285
> 
> 赞同：3
> 
> 时间：2012-09-01T20:49:45.240
> 
> 标签：ruby-on-rails, heroku

我的应用程序 - cloudlist (cloudli.st) - 使用 Heroku、rails 3.2 和一堆宝石。在过去的几天里，我们开始看到我们的布局在部署后几个小时就中断了。

奇怪的是，一个文件的内容会根据不同的请求随机切换。我们使用所有默认值的 rails 资产管道，没有任何改变。部署后一切正常。一段时间后（通常是几个小时），布局开始在某些区域中断。有时只有一张图片有不同的内容，有时甚至 JS 或 CSS 文件也有不同的内容。我们还看到了完全混淆的文件。这一切都很奇怪，我在网上找不到任何东西。

为了说明问题，请参见下图，其中包含错误内容的精灵。

![在此处输入图像描述](../Images/84658da0d92ffed451dd8bc2aa4f6c31.png)

另请参阅文件 frame.png 的内容。它应该显示一个瓷砖的框架，但有时它会显示奖项提名徽章。

![在此处输入图像描述](../Images/2331bff6b1b349f68fb20b01c428451c.png)

**有没有人见过类似的东西，或者你知道如何解决这个问题吗？**

如果这种情况继续下去，我们需要从 Heroku 迁移并使用另一个基础架构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T08:44:45.167

根据heroku（https://devcenter.heroku.com/articles/rack-cache-memcached-rails31）给出的建议，这里是结果。

**简而言之：**它没有帮助。

**长版：**

我不使用 memcached 进行缓存。我既不使用片段缓存，也不使用动作缓存。至少我在我的应用程序中根本不使用缓存。

唯一被缓存的是配置参数完成的事情

**config.action_controller.perform_caching = false**

在生产环境中。

我浏览了这篇文章并检查了每个参数。我唯一不同的是**config.serve_static_assets**是**false**。我将其设置为 true，重新部署（启用缓存）并在几个小时后遇到相同的问题。

我不知道出了什么问题，但由于我的文件中的内容与预期不符，我不得不得出结论，这是您的基础架构中的某些内容。例如，我请求**application-(any-digest).css**并得到**sprite-(any-digest).png**或**application-(any-digest).js**

# javascript - 逗号分隔字符串的正则表达式

> ID：12231286
> 
> 赞同：0
> 
> 时间：2012-09-01T20:49:46.923
> 
> 标签：javascript, regex

我不是正则表达式大师，但我正在寻找一个可以在 js 中给出这个结果的正则表达式：

```
var regex = ...;
var result = '"a b", "c, d", e f, g, "h"'.match(regex); 
```

结果是

```
['"a b"', '"c, d"', 'e f', 'g', '"h"'] 
```

编辑：

转义引号不需要处理。它用于标记字段，用户必须能够输入：

标签1，标签2

但是也

“美国纽约”、“美国波士顿”

EDIT2：感谢您以惊人的速度回答 minitech，这成功了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T20:57:49.513

我只是使用一个循环：

```
function splitCSVFields(row) {
    var result = [];
    var i, c, q = false;
    var current = '';

    for(i = 0; c = row.charAt(i); i++) {
        if(c === '"') {
            current += c;
            q = !q;
        } else if(c === ',' && !q) {
            result.push(current.trim());
            current = '';
        } else {
            current += c;
        }
    }

    if(row.length > 0) {
        result.push(current.trim());
    }

    return result;
} 
```

注意： requires `String#trim`，您可以按如下方式对其进行 shiv：

```
if(!String.prototype.trim) {
    String.prototype.trim = function() {
        return this.replace(/^\s+/, '').replace(/\s+$/, '');
    };
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T20:57:15.373

正则表达式可能不是完成此任务的最佳工具。您可能希望通过遍历字符并决定要做什么来代替。这是一些可以做到这一点的伪代码：

*   循环遍历字符：
    *   是报价单吗？
        *   切换报价标志。
    *   未设置引用标志时是否为逗号？
        *   将累积的字符串添加到数组中。
        *   清除累积的字符串。
        *   跳过此迭代中的剩余步骤。
    *   将当前字符添加到正在累积的字符串中。
*   累积的字符串不为空吗？
    *   将累积的字符串添加到数组中。
*   （可选）从数组中的所有字符串中去除空格。
    这也可以在将字符串添加到数组时完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T21:20:50.270

```
var result = input.match(/(?:(?:"((?:[^"]|"")*)")|([^",\n]*))/g);
for (var i = 0; i < result.length; i++) {
  result[i] = result[i].replace(/^\s*/, "").replace(/\s*$/, "");
  if (result[i].length === 0) {
    result.splice(i--, 1);
  }
} 
```

[在此处](http://jsfiddle.net/MBvJr/)测试此代码。

# java - beanshell新手-运行简单脚本时出错

> ID：12231293
> 
> 赞同：3
> 
> 时间：2012-09-01T20:50:46.133
> 
> 标签：java, beanshell

我正在尝试在 Beanshell 中运行一个简单的 switch-case 语句

这是我试图运行的代码——

```
temp = assignee.toString();
switch( temp.toString() ) 
 {
case 'missing' : check = "missing"; break;
case '404' : check = "404"; break;
default: check = "data"; break;
} 
```

但我收到以下错误 -

```
 ERROR - Error during script execution: Sourced file: inline evaluation of: ``temp = assignee.toString(); switch( temp.toString() ) { case 'missing' : check = . . . '' Token Parsing Error: Lexical error at line 3, column 8\.  Encountered: "i" (105), after : "\'m"
 org.webharvest.exception.ScriptException: Error during script execution: Sourced file: inline evaluation of: ``temp = assignee.toString(); switch( temp.toString() ) { case 'missing' : check = . . . '' Token Parsing Error: Lexical error at line 3, column 8\.  
Encountered: "i" (105), after : "\'m"
at org.webharvest.runtime.scripting.BeanShellScriptEngine.eval(Unknown Source) 
```

我在这里做错了什么？如何解决此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:00:48.327

BeanShell 中的字符串文字，就像在 Java 中一样，必须使用双引号，而不是单引号：

```
bsh % x = '失踪';
// 错误：解析输入错误：bsh.TokenMgrError：第 1 行第 37 列出现词法错误。遇到：“i”（105），后：“\'m”
bsh % x = "失踪";
bsh % 打印（x）；
失踪
百分百

```

单引号用于字符文字。对多字符字符串使用单引号会给您一个错误，例如`Encountered: "i" (105), after : "\'m"`, 这是因为 BeanShell在（结束字符文字）`'`之后期待另一个错误，但它却得到了。`m``i`

# tcp - 浏览器在什么协议层上工作？

> ID：12231315
> 
> 赞同：-3
> 
> 时间：2012-09-01T20:52:54.037
> 
> 标签：tcp, udp

假设我们的浏览器使用的是 UDP 协议；然后向服务器请求，它是通过所有较低的较低层还是直接到达接收端...如果它通过所有层，那么它使用物理链路；那么它怎么可能是一个无连接协议呢？无线使用 TCP 还是 UDP？请回答我……我完全对这个概念感到困惑……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T21:00:36.640

每个应用程序协议都指定它使用的传输协议。

TCP 用于与 Web 服务器的 HTTP 连接。UDP 通常用于执行 DNS 查询，尽管在某些情况下它可以切换到 TCP。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-02T03:49:59.963

浏览器使用 HTTP，这是一种基于 TCP 的应用协议，它是一种面向连接的协议。否则它使用 HTTPS，即 HTTP over SSL over TCP。

您对 UDP 的评论既不合逻辑也不相关。

# android - 为 Fragment/ViewPager 设置设置默认选项卡

> ID：12231318
> 
> 赞同：40
> 
> 时间：2012-09-01T20:53:05.030
> 
> 标签：android, android-fragments, android-tabs

首次创建 FragmentActivity 时如何设置默认选项卡？我有 5 个选项卡，希望它打开到选项卡 2，而不是 1。看起来它应该比它容易得多！

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.fragment_layout);

        mSectionsPagerAdapter = new SectionsPagerAdapter(
                getSupportFragmentManager());

        final ActionBar actionBar = getActionBar();
        actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

        mViewPager = (ViewPager) findViewById(R.id.viewpager);
        mViewPager.setAdapter(mSectionsPagerAdapter);

        mViewPager
                .setOnPageChangeListener(new ViewPager.SimpleOnPageChangeListener() {
                    @Override
                    public void onPageSelected(int position) {
                        actionBar.setSelectedNavigationItem(position);

                    }
                });

        for (int i = 0; i < mSectionsPagerAdapter.getCount(); i++) {
            actionBar.addTab(actionBar.newTab()
                    .setText(mSectionsPagerAdapter.getPageTitle(i))
                    .setTabListener(this));
        }

    }

    public void onTabUnselected(ActionBar.Tab tab,
            FragmentTransaction fragmentTransaction) {

    }

    @Override
    public void onSaveInstanceState(Bundle savedInstanceState) {
        super.onSaveInstanceState(savedInstanceState);
    }

    @Override
    public void onRestoreInstanceState(Bundle savedInstanceState) {
        super.onRestoreInstanceState(savedInstanceState);

    }

    public void onTabSelected(ActionBar.Tab tab, FragmentTransaction ft) {
        mViewPager.setCurrentItem(tab.getPosition());
    }

    public void onTabReselected(ActionBar.Tab tab,
            FragmentTransaction fragmentTransaction) {
    }

    public class SectionsPagerAdapter extends FragmentPagerAdapter {

        public SectionsPagerAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override
        public Fragment getItem(int position) {
            Fragment f = null;
            switch (position) {
            case 0: {
                f = new MasterFrag();
                Bundle args = new Bundle();

                f.setArguments(args);
                break;
            }

                 // case 1 - 3 edited out; i'd like default view "case 1".

        default:
                throw new IllegalArgumentException("not this many fragments: "
                        + position);
            }

            return f;

        }

        @Override
        public int getCount() {
            return 4;
        }

        @Override
        public CharSequence getPageTitle(int position) {
            switch (position) {
            case 0:
                return getString(R.string.mastercattab1).toUpperCase();

                     // case 1- 3 edited out

            }
            return null;
        }
    } 
```

还有我的 XML

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TabHost
        android:id="@android:id/tabhost"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:orientation="vertical" >

            <TabWidget
                android:id="@android:id/tabs"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_weight="0"
                android:orientation="horizontal" />

            <FrameLayout
                android:id="@android:id/tabcontent"
                android:layout_width="0dp"
                android:layout_height="0dp"
                android:layout_weight="0" />

            <android.support.v4.view.ViewPager
                android:id="@+id/viewpager"
                android:layout_width="fill_parent"
                android:layout_height="0dp"
                android:layout_weight="1" />
        </LinearLayout>
    </TabHost>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2012-09-02T00:59:17.363

您是否尝试过`mViewPager.setCurrentItem(tab.getPosition());`在结束时调用`onCreate()`？

# postgresql - 查找员工的所有主管

> ID：12231322
> 
> 赞同：6
> 
> 时间：2012-09-01T20:53:56.647
> 
> 标签：postgresql, recursive-query

我知道答案似乎是根据[这篇文章](https://stackoverflow.com/questions/10191746/recursive-select)使用“WITH RECURSIVE”，但我就是不明白。

我有一张名为 的表`people`，还有一张名为 的表`position_hierarchy`。该`people`表有一个唯一的 id`uperson_id`和我们调用的位置 id`pcn`和一个`enabled`标志（因为当有人离开并被替换时，他们的替换得到相同的`pcn`）。有`position_hierarchy`列`pcn`，另一列`reports_to`是`pcn`层次结构中高于他们的人的列。我想要做的是给一个人，并在层次结构中`uperson_id`找到`uperson_id`他们之上的所有人，和/或给一个`uperson_id`人和另一个人`uperson_id`，并告诉第二个人是否有人对第一个有监督职位。

标明公司总裁是因为他们`pcn`和他们一样`reports_to`。（不是我的决定 - 我会使用 null `reports_to`）

到目前为止我想出的是：

```
with recursive parents (uperson_id, pcn, reports_to) as
(
 select p1.uperson_id, ph1.pcn, ph1.reports_to
 from people p1
 join position_hierarchy ph1 on ph1.pcn = p1.pcn
 where reports_to != ph1.pcn and active_revoke_flag = '0'

 union all

 select p2.uperson_id, ph2.pcn, ph2.reports_to
 from people p2
 join position_hierarchy ph2 on p2.pcn = ph2.pcn
 join parents pp on pp.pcn = ph2.reports_to
)
select parents.* from parents where uperson_id = 'aaa3644'; 
```

但这会返回具有相同 uperson_id、pcn 和 reports_to 的 5 行（这似乎是正确的行数，但我想要主管的 uperson_id 在每个级别。我觉得我错过了一些非常基本的东西，我可能会打耳光当你告诉我我做错了什么时，我的头。

**我做了什么**

根据[Erwin Brandstetter 的回答](https://stackoverflow.com/a/12231470/3333)，我修复了一些问题（主要是因为我没有弄清楚该表在哪个表`active_revoke_flag`中）并提出：

```
with recursive p as (
    select pcn, reports_to
    from   position_hierarchy
    where  pcn = (SELECT pcn FROM people WHERE uperson_id = 'aaa3644')
    union all
    select ph2.pcn, ph2.reports_to
    from   p
    join   position_hierarchy ph2 ON ph2.pcn = p.reports_to AND
           p.pcn != p.reports_to
)
select p2.uperson_id, p2.active_revoke_flag, p.*
from   p
join   people p2 USING (pcn)
where  p2.active_revoke_flag = '0'; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T21:15:12.103

我会尝试这种自下而上的方法，从感兴趣的人开始，然后逐步向上：

```
with recursive p as (
    select p1.uperson_id, p1.pcn, ph1.reports_to
    from   people p1
    join   position_hierarchy ph1 USING (pcn)
    where  ph1.active_revoke_flag = '0'
    and    p1.uperson_id = 'aaa3644'

    union all

    select p2.uperson_id, p2.pcn, ph2.reports_to
    from   p
    join   position_hierarchy ph2 ON ph2.pcn = p.reports_to
                                 AND ph2.active_revoke_flag = '0'
    join   people p2 ON p2.pcn = ph2.pcn
)
select * from p; 
```

或者，更快，因为我们只加入`person`一次：

```
with recursive p as (
    select pcn, reports_to
    from   position_hierarchy
    where  active_revoke_flag = '0'
    and    pcn = (SELECT pcn FROM person WHERE uperson_id = 'aaa3644')

    union all

    select ph2.pcn, ph2.reports_to
    from   p
    join   position_hierarchy ph2 ON ph2.pcn = p.reports_to
                                 AND ph2.active_revoke_flag = '0'
)
select p2.uperson_id, p.*
from   p
join   people p2 USING (pcn); -- assuming pcn is unique in table person 
```

顺便说一句：我确实发现您的重复设计`pcn`有些可疑。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-01T21:27:59.380

如果您知道最大树深度，则可以将其合并到单个查询中；否则，您需要阅读 Joe Chelko 并重组您的表格。

最大深度为 5 的单个查询可能如下所示（未经测试）：

```
选择不同的 ph1.pcn
来自 position_hierarchy ph1
在 ph1.pcn = ph2.reports_to 上加入 position_hierarchy ph2
left join position_hierarchy ph3 on ph2.pcn = ph3.reports_to
在 p3.pcn = ph4.reports_to 上左连接 position_hierarchy ph4
left join position_hierarchy ph5 on ph4.pcn = ph5.reports_to
其中 ph2.pcn = @my_pcn
或 ph3.pcn = @my_pcn
或 ph4.pcn = @my_pcn
或 ph5.pcn = @my_pcn;

```

结果将是所有@my_pcn 上级的 pcn 列表。您还可以添加一些东西来测试公司总裁的边缘情况。

Chelko wrote the book on hierarchies in SQL, literally: [http://books.google.ca/books/about/Joe_Celko_s_Trees_and_Hierarchies_in_SQL.html?id=Jy4e8SbYO6sC](http://books.google.ca/books/about/Joe_Celko_s_Trees_and_Hierarchies_in_SQL.html?id=Jy4e8SbYO6sC)

# android - Android SDK：更新平台工具

> ID：12231326
> 
> 赞同：0
> 
> 时间：2012-09-01T20:54:51.663
> 
> 标签：android, eclipse

我目前安装了 Android SDK Platform-tools 14。*（编辑：似乎是当前版本）*

由于这有一个使 Logcat 无法使用的错误，并且它似乎已在较新的版本中得到[修复，因此我想对其进行更新。](https://stackoverflow.com/questions/7829487/how-can-i-stop-the-logcat-output-from-scrolling-automatically-in-eclipse)

如何才能做到这一点？

SDK Mangager.exe 没有找到比 14 更新的版本。我多次重新启动它并安装了所有可用的更新。[android页面](http://developer.android.com/tools/sdk/tools-notes.html)说当前版本是20，但他们不提供下载。安装最新的 SDK 启动包并不能解决问题。

截屏：

![在此处输入图像描述](../Images/b4a38d3a4500da79785c6ec17afd547b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T20:59:00.640

启动独立的 SDK 管理器，而不是从 Eclipse。然后它应该获取可用包的列表并让您更新所有旧包，因为您的 ADT v14 非常古老。

或者，如果其他一切都失败了，您总是可以从[http://tools.android.com](http://tools.android.com)手动获取 ADT ，将工具解压缩到您的 ，替换旧的东西，然后安装 Eclipse 插件。请注意，您需要同时下载并安装，因为最新版本不适用于过时的软件包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T21:12:44.080

谷歌页面谈论的工具不是平台工具。实际上SDK中有两个不同的文件夹，一个是工具，一个是平台工具，所以根据最新版本，最新版本是

对于平台工具：[平台工具](http://dl.google.com/android/repository/platform-tools_r14-windows.zip)

工具：[工具](http://dl.google.com/android/repository/tools_r20-windows.zip)

因此，如果您遇到问题，只需下载 zip 并安装新的替换旧的。

如果您对新的目录有问题，请使用旧目录（LogCat-Deprecated）。

# macos - 任何命令的 NPM 错误

> ID：12231328
> 
> 赞同：6
> 
> 时间：2012-09-01T20:54:54.893
> 
> 标签：macos, node.js, npm

我下载了最新版本的 Node.js (0.8.8)，它工作得很好而且很漂亮，但是与 Node.js 安装一起打包的 NPM 现在失败了。当我有一个过时版本的 Node.js (0.5.x) 并且我可以输入类似的命令时，它可以工作

```
npm --version 
```

它会返回当前版本的 NPM。但是，当我执行任何命令（甚至是上面的命令）时，我都会收到此错误

```
$ npm -v

/usr/lib/node_modules/npm/lib/utils/config-defs.js:5
  , stdio = process.binding("stdio")
                ^
Error: No such module
  at Object.<anonymous> (/usr/lib/node_modules/npm/lib/utils/config-defs.js:5:21)
  at Module._compile (module.js:449:26)
  at Object.Module._extensions..js (module.js:467:10)
  at Module.load (module.js:356:32)
  at Function.Module._load (module.js:312:12)
  at Module.require (module.js:362:17)
  at require (module.js:378:17)
  at Object.<anonymous> (/usr/lib/node_modules/npm/lib/utils/ini.js:43:18)
  at Module._compile (module.js:449:26)
  at Object.Module._extensions..js (module.js:467:10) 
```

我正在使用 NPM 版本 1.1.59

**注意：**我尝试过更新 NPM

```
$ curl -L curl http://npmjs.org/install.sh | sudo sh 
```

但这也没有用。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-01T21:05:22.377

感谢[Sean 在他自己的帖子中对答案的评论](https://stackoverflow.com/a/12199083/863186)，我明白了。在我从中删除 npm 模块后

```
/usr/lib/node_modules/ 
```

和来自的二进制文件

```
/usr/bin/ 
```

现在一切正常。

我认为在安装最新的 Node.js 后可能会发生冲突，因为两条路径都是全局的。希望这对将来的任何人都有帮助:-)

# java - 如何在关闭浏览器时从数据库中删除数据

> ID：12231340
> 
> 赞同：4
> 
> 时间：2012-09-01T20:56:35.997
> 
> 标签：java, sql, jsp, session, servlets

当用户登录到我的 Web 应用程序时，我会创建一个会话：

```
session.setAttribute("SessionNumber","100"); 
```

并且他的用户名被添加到一个名为`ONLINE_USERS.` Other Online users 的表中就能看到他，他们看到所有在线用户

当用户单击注销按钮时，我从表中删除该行，然后使用以下命令删除会话：

```
session.invalidate(); 
```

但是假设用户存在浏览器，他的会话将消失，但该行将作为在线用户留在数据库中，如何避免这种情况？

我在 Netbeans 上使用 JSP-Servlets。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T21:05:35.193

您可以启用自定义`HttpSessionListener`以在会话失效时删除表行。

```
public class YourHttpSessionListener implements HttpSessionListener {       
   public void sessionCreated(HttpSessionEvent event) {
   //put row in the database
   }

   public void sessionDestroyed(HttpSessionEvent event) {
     //delete the row from database     
   }
} 
```

在 web.xml 中声明监听器：

```
<listener>
    <listener-class>YourHttpSessionListener</listener-class>
</listener> 
```

请注意，在用户退出浏览器和他的会话在服务器上过期之间会有延迟。但是会话过期时间是可配置的。你应该找到一个合适的过期时间：不要太长，这样你就不会将太多的离线用户显示为在线，但不要太短，让连接的用户有空闲时间。

`servlet`我认为这对于使用基础和`jsp`技术开发的聊天应用程序来说是一个很好的权衡。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T23:16:39.480

据我了解，您希望看到目前正在网站上操作的用户，HttpSessionListener 的问题是会话在其被销毁之前可以存活很长时间，因此用户可能会在被销毁时长时间不使用该网站. （见[http://www.smartsoftwarebits.com/qaa/46-misc/82-how-to-set-session-timeout-for-tomcat](http://www.smartsoftwarebits.com/qaa/46-misc/82-how-to-set-session-timeout-for-tomcat)）

**解决方案**：您可以在数据库中添加一列，您将在其中存储用户发出的最后一次请求的时间戳。要使此列保持最新，请使用 servlet 过滤器。（[http://docs.oracle.com/javaee/6/api/javax/servlet/Filter.html](http://docs.oracle.com/javaee/6/api/javax/servlet/Filter.html)）

要清除在线用户，请添加一个计时器作业（例如使用石英），您将在其中删除早于（例如）5 分钟的行（在线用户）（因此当最后一次交互超过 5 分钟时）（[http://石英调度器.org/](http://quartz-scheduler.org/)）

使用它，您现在可以非常准确地判断是否有用户“仍然存在”。

此外，您可以向客户端 javascript 添加一个计时器，以定期进行 ajax 调用。您可以通过这种方式处理用户没有关闭浏览器只是暂时处于非活动状态的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T12:45:14.357

首先是在浏览器关闭时捕获事件

您可以尝试在您的 jsp 中使用下面的代码片段来命中一个 js 函数，该函数将调用一个 ajax 函数来命中服务器端组件。然后只需使用会话 API 使会话无效并添加代码以从表中删除记录。

```
window.onbeforeunload = WindowClose; 

function WindowClose() { 

  //Write a AJAx request here to hit the server side servlet  to invalidate the session

} 
```

或使用

```
<body onunload="WindowClose(); > 
```

在服务器端代码中，使用

HttpSession 会话 = request.getsession(); session.setMaxInactiveInterval(0); //或 session.invalidate();

在 web.xml 中定义默认会话超时值将是一个很好的方法，以便在浏览器崩溃时，会话将在规定的时间过去后失效。

```
<session-config>
<session-timeout>30</session-timeout>
</session-config> 
```

# coffeescript - 从咖啡脚本生成 Javascript 相当于 _.each 下划线中的手动 javascript

> ID：12231341
> 
> 赞同：0
> 
> 时间：2012-09-01T20:56:42.003
> 
> 标签：coffeescript, underscore.js

我在Javascript中有一个代码：

```
 _.each(this.collection.models, function (student) {
            $(this.el).append(new StudCloneItemView({ model: student }).el);
        }, this); 
```

当我在咖啡中写这个时

```
_.each this.collection.models  , (student) => 
$(@el).append new Item ({ model:student }).el 
```

这会产生

```
_.each(this.collection.models, function(student) {
      return $(_this.el).append(new Item({
        model: student
      }.el));
    }); 
```

根据我的要求，这是不可取的。生成的 javascript 中缺少“this”元素的最后一段。这很重要。

我将如何使用我为 _.each 提到的咖啡脚本生成上面提到的 javascript ????

反正有这样做吗？还是我缺少任何语法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:00:01.067

像这样：

```
_.each @collection.models, ((student) ->
  $(@el).append new StudCloneItemView(model: student).el
), this 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T21:26:30.410

你的 JavaScript：

```
_.each(this.collection.models, function (student) {
    $(this.el).append(new StudCloneItemView({ model: student }).el);
}, this); 
```

以及您的[`=>`](http://coffeescript.org/#fat_arrow)CoffeeScript 产生的内容：

```
var _this = this; // This is somewhere above your _.each in the generated JS
_.each(this.collection.models, function(student) {
    return $(_this.el).append(new Item({
        model: student
    }.el));
}); 
```

在功能上是等效的。您不需要 context 参数，[`_.each`](http://underscorejs.org/#each)因为它会为（称为）`=>`生成一个别名，该别名在回调中使用。`this``_this`

* * *

顺便说一句，Backbone 集合[混合了各种 Underscore 方法，](http://backbonejs.org/#Collection-Underscore-Methods)所以你不必说`_.each(@collection.models, ...)`，你可以`each`直接在集合上使用：

```
@collection.each (student) =>
    @$el.append(new StudCloneItemView(model: student).el) 
```

我还切换到[`$el`](http://backbonejs.org/#View-%24el)您的视图已经拥有的预构建，无需在每次迭代时构建新的 jQuery 对象。

# algorithm - 跳过列表中的插入和移除时间

> ID：12231344
> 
> 赞同：1
> 
> 时间：2012-09-01T20:57:12.253
> 
> 标签：algorithm, insertion, skip-lists

我对从跳过列表中插入或删除元素所需的时间有点困惑。

假设有一个高度为 H 的跳过列表，每个级别包含 n/2^i 个条目。
n = 键值对总数
i = 跳过列表的级别 i<= H

现在，根据理论，插入操作将执行以下操作
1\. 找到一个键 <= 正在插入的键。
2\. 插入此键
3\. 在基础级别以上的级别中随机创建此条目。

让我们假设 Skip 列表基于链表。
第 1 步：应该取 O(n)。
第 2 步：应该是 O(1)。
第 3 步：应该是 O(log n) 时间。我仍然对这个逻辑感到困惑，它将成为下面问题的一部分

**问题**

1.  基于上述事实，插入时间不应该是 O(n) + O(1) + O(log n) 吗？忽略低阶项，它应该是 O(n) + O(log n)？

2.  第 3 步再次应该花费 O(n) 时间来搜索要插入的密钥 <= 密钥，然后需要 o(1) 时间来插入。导致非常复杂的插入运行时间？

书上说插入跳过列表需要 O(log n) 时间。我一定错过了一些重要的信息，请你帮我很好地理解这个概念。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:17:16.677

由于跳过列表用于存储已排序的数据，因此在查找插入新元素的位置时，您可以执行比线性搜索更智能的操作。

基本上，您可以使用更高级别的指针执行类似于二进制搜索的操作。例如，通过检查`log n - 1`第 th 级的链接，您可以将新项目与列表中间的项目进行比较，从而确定它应该插入到列表的前半部分还是后半部分。然后您继续这样，每次查看较低级别的链接以获得更好的精度。这将算法中步骤 1 的复杂度降低到`O(log n)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T21:18:21.230

跳过列表的全部意义在于不必遍历整个列表来查找项目。您首先在上面的列表中搜索，然后向下一层，依此类推，直到到达基本列表。

假设顶部列表包含 2 个项目，第一个项目和一个在中间的某个位置。当您搜索您的项目时，该列表已被减半。每个级别都会将列表大约减半。这就是插入 O(log n) 的原因。

# c# - GDI+ 中出现一般错误

> ID：12231345
> 
> 赞同：0
> 
> 时间：2012-09-01T20:57:13.300
> 
> 标签：c#, asp.net

我当时在保存图像时已将 imgpaths 使用到 server.mappath()
中，我在 GDI+ 错误中发生了一般错误。

```
 Graphics Grfx = Graphics.FromImage(bitmap);
            Grfx.InterpolationMode = System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic;
            Grfx.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.HighQuality;
            Grfx.PixelOffsetMode = System.Drawing.Drawing2D.PixelOffsetMode.HighQuality;
            Grfx.CompositingQuality = System.Drawing.Drawing2D.CompositingQuality.HighQuality;
            Grfx.DrawImage(bitmap, 0, 0, wb.Width, wb.Height);

            using (Bitmap img = bitmap.Clone() as Bitmap)
            {
                Bitmap newimage = img.Clone(new System.Drawing.Rectangle(0, 0, bitmap.Width, bitmap.Height), img.PixelFormat);
                newimage.Save(imgpaths, System.Drawing.Imaging.ImageFormat.Jpeg);  //Error:A generic error occurred in GDI+.
            }

            wb.Dispose(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:06:26.683

从文件中读取图像时，只要该图像对象存在，文件就会保持打开状态。

您必须先处理原始图像对象，然后才能使用相同的文件名保存图像。

# html - 如何使文本站在 div 之上？

> ID：12231354
> 
> 赞同：1
> 
> 时间：2012-09-01T20:58:41.900
> 
> 标签：html, css

我想在 div 上创建一个菜单，所以基本上文本就在它上面（参见示例）。我想让菜单的文本在同一个 div 中，所以 html 是这样的：

```
<div id="text">
            <div id="menu">Portfolio &nbsp;|&nbsp; About us</div>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
</div> 
```

提前致谢。

![在此处输入图像描述](../Images/ed7dbcfafc84c909c1ffbd9b7aca94f0.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T21:00:35.393

将 div 相对定位 ( `position: relative;`)，然后将文本绝对定位 ( `position:absolute;`)。确保文本在 div 内的元素内，然后将嵌套元素的`top`位置设置为负数，直到它定位到您喜欢的位置。

要将其居中，您将需要处理`left`和`right`属性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T21:06:13.470

[这个 JSFiddle](http://jsfiddle.net/uPkhW/)只是模仿你的截图。

我不得不将此添加到`#menu`样式中：

```
margin-bottom: 0;
padding-bottom: 0;
line-height: 1em; 
```

然后这是`#text p`：

```
margin-top: 0; 
```

这就是诀窍。

让它全部居中就像这样简单：

```
#text {
    width: 500px;
    margin: 0 auto;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T21:04:21.970

您可以使用相对/绝对定位或尝试类似的方法

```
 <div id="text">
          <div id="menu">Portfolio &nbsp;|&nbsp; About us</div>
          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>
    </div> 
```

在你的 CSS 中：

```
 #text{
       text-align:center;
    }
    #menu{
      margin-top:-20px;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T21:13:14.147

见[http://jsfiddle.net/rVjCB/](http://jsfiddle.net/rVjCB/)

HTML：

```
<div class="menu">
    <ul class="top">
        <li>Portfolio</li>
        <li>About us</li>
    </ul>
    Text
</div> 
```

CSS：

```
.menu{
    background:#957F00;
    max-width:500px;
    margin:0 auto;
    color:white;
}
.menu>.top{
    background:white;
    overflow:hidden;
    color:black;
}

.menu>.top>li{
    float:left;
    width:50%;
    border-left:3px solid #957F00;
    margin-left:-3px;
    text-align:center;
} 
```

# html - 为什么固定导航框阴影在 Firefox 和 IE 中无法正常显示？

> ID：12231357
> 
> 赞同：0
> 
> 时间：2012-09-01T20:58:57.417
> 
> 标签：html, css, firefox

据我所知，一切似乎都在 Chrome、Opera 和 Safari 中运行。

但正如您所见，在 IE 和 Firefox 中，标题部分下方的框阴影是错误的。

此外，请尝试单击 Firefox 中的导航链接。该网站水平和垂直滚动，我不确定是什么原因造成的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:14:07.067

根据您的标题 CSS：

```
header {
    position: fixed;
    top: 0;
    width: 100%;
    z-index: 999;
    box-shadow: 0px 2px 20px #000;
} 
```

您需要`-moz-box-shadow`为盒子阴影添加属性才能在旧版本的 FF（FF13 之前）中工作。

不要忘记指定高度：114px；在标题中。

# c++ - C/C++ 大数计算

> ID：12231366
> 
> 赞同：4
> 
> 时间：2012-09-01T20:59:52.143
> 
> 标签：c++, c, math, numbers, modulo

我正在尝试在 C 程序中计算以下数字：

```
result = (3 * pow(2,500000000) - 2 ) % 1000000000 
```

2 的幂对于正确处理来说太大了=> 我的印象是我可以使用模数将计算分成多个步骤以减小结果大小。有人有这样做的策略吗？还有其他想法吗？

提前感谢

马努

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-01T21:06:10.087

最简单的方法是通过在每个步骤中通过模数重复平方减少来求幂。

```
unsigned long long mod_pow(unsigned long long base, unsigned long long exponent, unsigned long long modulus)
{
    if (exponent == 0) return 1;
    unsigned long long aux = 1;
    while(exponent > 1) {
        if (exponent % 2 != 0) {
            aux *= base;
            aux %= modulus;
        }
        base *= base;
        base %= modulus;
        exponent /= 2;
    }
    return (base*aux) % modulus;
} 
```

然后你可以用它来计算

```
result = (3*mod_pow(2,500000000,1000000000) - 2) % 1000000000; 
```

该函数假设模数的平方不超过 64 位范围。对于更大的模数，事情就更复杂了。

# iphone - 使用 Core Data 在 UITableView 中显示“未找到行”消息

> ID：12231373
> 
> 赞同：7
> 
> 时间：2012-09-01T21:00:43.033
> 
> 标签：iphone, core-data, uitableview, nsfetchedresultscontroller

我已经实现了一个使用 UITableViewController/UITableView 和核心数据的 iPhone 应用程序。此外，我使用 NSFetchedResultsController 来管理表数据。这一切都非常简单，而且效果很好。然后我决定当没有找到/检索到行时，我应该在 UITableView 中显示一条消息。在对此进行研究之后，似乎最好的方法（也许是唯一的方法）是返回一个包含消息的“虚拟”单元格。但是，当我这样做时，我从运行时系统中得到一个讨厌的图，它抱怨（并且理所当然地）数据不一致：“无效更新：无效的节数。表视图中包含的节数......”。以下是相关代码：

```
- (NSInteger) numberOfSectionsInTableView: (UITableView *)tableView
{
    if ([[self.fetchedResultsController fetchedObjects] count] == 0) return 1;
    return [[self.fetchedResultsController sections] count];
}

- (NSInteger) tableView: (UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    if ([[self.fetchedResultsController fetchedObjects] count] == 0) return 1;
    id <NSFetchedResultsSectionInfo> sectionInfo = [[self.fetchedResultsController sections] objectAtIndex: section];
    return [sectionInfo numberOfObjects];
}

- (UITableViewCell *) tableView: (UITableView *)tableView cellForRowAtIndexPath: (NSIndexPath *)indexPath
{
    if ([[self.fetchedResultsController fetchedObjects] count] == 0) {
        UITableViewCell *cell = [[UITableViewCell alloc] init];
        cell.textLabel.text = @"No widgets found.";
        return cell;
    }

    STCellView *cell = (STCellView *)[tableView dequeueReusableCellWithIdentifier: @"ShieldCell"];
    [self configureCell: cell atIndexPath: indexPath];
    return cell;
} 
```

我已经阅读了类似问题的回复，看来我应该使用

```
insertRowsAtIndexPaths: withRowAnimation: 
```

将“虚拟”消息行插入我的表中。但是，这也意味着在插入真实行时删除“虚拟”行。我可以做到这一点，但似乎应该有一种更简单的方法来实现这一点。我要做的就是显示一条消息，指示表中没有行（够简单吗？）。所以，我的问题是：有没有办法在 UITableView 中显示一条消息而不使用“虚拟”单元格方法，或者有没有办法让 UITableViewController/NSFetchResulsController 相信这只是一个“虚拟”行，他们不应该得到因为它不是表格中的真实行（从我的角度来看），所以对此感到不安？

您可以提供的任何帮助将不胜感激（我是 iPhone 开发的一个苦苦挣扎的新手，我想学习最佳实践）。谢谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-03T22:46:20.060

与其使用 tableview 数据源来获取预期的 UI，不如将“No rows found”消息添加到 tableview 标题中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-04-10T07:24:50.127

我在 viewDidLoad 中做了如下操作。

```
UILabel *label = [[UILabel alloc] init];
[label setTextColor:[UIColor lightGrayColor]];
[label setText:@"No widgets found."];
[label sizeToFit];
label.frame = CGRectMake((self.tableView.bounds.size.width - label.bounds.size.width) / 2.0f,
                         (self.tableView.rowHeight - label.bounds.size.height) / 2.0f,
                         label.bounds.size.width,
                         label.bounds.size.height);
[self.tableView insertSubview:label atIndex:0]; 
```

在这种情况下，每个 TableViewCells 必须是不透明的才能隐藏标签。或者需要根据行数来切换标签的隐藏属性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T10:28:56.030

我之前使用的另一种方法是使用 Core Data 为您管理更新，方法是在模型类中未检测到行的部分插入“无行”实体，该部分处理数据更新。

有许多方法可以实现这一点，例如将名称/标题字段设置为已知状态消息或实体内的标志。插入后，您可以在 cellForRowAtIndexPath 委托方法中检测到“无行”实体，并插入替代表格单元格以显示消息。

只需在刷新该部分的数据之前删除“无行”实体。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T10:10:05.410

我显示空消息的简单建议是将您的控制器重新排列为简单的`UIViewController`（而不是 a `UITableViewController`）。

这`UIViewController`由 a `UITableView`（控制器是数据源和表的委托）和显示空行消息的 a `UILabel`（或`UIView`包含 a 的 a ）组成。`UILabel`

通过这种方式，您可以根据检索到的行来控制表和标签的可见性。

这种方法可能很费力，但我认为避免黑客攻击`NSFetchResultsController`和数据源是件好事。此外，您可以完全控制安排空消息的位置。

正如@Rog 建议的那样，您还可以使用表格视图标题来显示该消息。根据你喜欢的。

希望能帮助到你。

# php - PDO：使用 bindParam 时，类似条件不起作用

> ID：12231376
> 
> 赞同：0
> 
> 时间：2012-09-01T21:01:02.803
> 
> 标签：php, sql, pdo

好吧...为什么这个sql语句不起作用？

```
public function searchProfile() {

    $termino = $this->term;
    $termino = "%".$termino."%";

    $sql = "SELECT * FROM cat_perfiles WHERE UPPER(Nombre) LIKE UPPER(:term)";

    $result = $this->dbConnect->prepare($sql) or die ($sql);
    $result->bindParam(':term',$termino,PDO::PARAM_STR);

    $numrows = $result->rowCount();
    $jsonSearchProfile = array();

    if ($numrows > 0) {
        while($row = $result->fetch(PDO::FETCH_ASSOC)) {
            $jsonSearchProfile[] = array(
                'IdPerfil' => $row['Id'],
                'NomPerfil' => $row['Nombre'],
                'DesPerfil' => $row['Descripcion'],
                'EdoPerfil' => $row['Activo']
            );
        }
        $jsonSearchProfile['success'] = 'success';
        return $jsonSearchProfile;
    } else {
        return false;
    }
} 
```

我检查了 $this->term 中的数据并且是正确的！但是当与 LIKE 比较时不起作用。

我希望能帮助我！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T21:04:28.963

您忘记执行查询

```
$result->execute(); 
```

# c# - 一次调用 RunWorkerAsync 时，BackgroundWorker 的 DoWork 被调用两次？

> ID：12231379
> 
> 赞同：16
> 
> 时间：2012-09-01T21:01:33.733
> 
> 标签：c#

我在一个可以工作的类中创建了一个后台工作人员，但是如果我打电话并等到最后运行，第二次调用它，它将执行两次相同的过程

我认为**bw.DoWork +=有问题**

```
private void button1_Click(object sender, EventArgs e)
{
    nptest.test.start("null", "null");    
}

namespace nptest
{
    class test
    {
        public static void start(string str, string strb)
        {
            if (bw.IsBusy != true)
            {
                bw.WorkerSupportsCancellation = true;
                bw.DoWork += (obj, e) => bw_DoWork(str, strb);
                bw.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bw_RunWorkerCompleted);
                bw.RunWorkerAsync();
            }
        }
        private static BackgroundWorker bw = new BackgroundWorker();
        private static void bw_DoWork(string str, string strb)
        {
            System.Windows.Forms.MessageBox.Show("initializing BackgroundWorker");
        }
        private static void bw_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            if ((e.Cancelled == true))
            {
                Console.WriteLine("Canceled");
            }
            else if (!(e.Error == null))
            {
                Console.WriteLine("Error: " + e.Error.Message);
            }
            bw.Dispose();

        }
    }
} 
```

**问题解决了**

```
 class test
    {
        private static List<object> arguments = new List<object>();

        // initializing with program startup
        public static void bwinitializing()
        {
            bw.WorkerSupportsCancellation = true;
            bw.DoWork += new DoWorkEventHandler(bw_DoWork);
            bw.RunWorkerCompleted += new RunWorkerCompletedEventHandler(bw_RunWorkerCompleted);
        }

        public static void start(string str, string strb)
        {
            if (bw.IsBusy != true)
            {
                arguments.Clear();
                arguments.Add(str);
                arguments.Add(strb);
                bw.RunWorkerAsync(arguments);
            }
        }
        private static BackgroundWorker bw = new BackgroundWorker();
        private static void bw_DoWork(object sender, DoWorkEventArgs e)
        {
            List<object> genericlist = e.Argument as List<object>;
            System.Windows.Forms.MessageBox.Show("BackgroundWorker " + genericlist[0]);

        } 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-01T21:09:16.260

我怀疑无意中添加了*多个* `DoWork`事件。

也就是说，*每次*调用该`start`方法时，它都会注册一个*新* `DoWork`的事件处理程序。这*会添加*而*不是替换*现有的处理程序处理`DoWork`程序。所以会有多个`DoWork`处理程序被称为后续时间.. 1、2、3等。

```
// creates a NEW delegate and adds a NEW handler
bw.DoWork += (obj, e) => bw_DoWork(str, strb); 
```

我建议*不要*在这里使用闭包，而只是使用方法组（隐式转换为委托），然后将数据传递给`RunWorkerAsync`调用（有一个表单接受数据的参数）。

该`RunWorkerCompleted +=`行不存在此问题，因为它传递了来自方法组的委托（保证始终评估为相同的委托对象¹）。因此，对该行的重复`+=`调用*将*替换处理程序。

* * *

例子：

```
class MyData {
   public string StrA { get; set; }
}

// These only need to be setup once (and should be for clarity).
// However it will be "ok" now if they are called multiple times
// as, since the delegates are the same, the += will
// act as a replacement (as it replaces the previous delegate with itself).
bw.WorkerSupportsCancellation = true;
bw.DoWork += bw_DoWork;
bw.RunWorkerCompleted += bw_RunWorkerCompleted;

// Pass data via argument
bw.RunWorkerAsync(new MyData {
    StrA = str,
});

void bw_DoWork (object sender, DoWorkEventArgs e) {
    var data = (MyData)e.Argument;
    var str = data.StrA;
    // stuff
} 
```

* * *

¹我不确定它是否保证引用等于相等，但使用这种方法可以稳定地调用方法组`+=`的`-=`委托，即使是通过`new DelegateType(MethodGroup)`.

写。*我在主帖中的评论：如果 UI 元素是从未*创建它们的线程访问的，那么将会有有趣的“跨线程操作异常”。我相信消息框的这种用法是“好的”（当不是用另一个线程的所有者创建时），但是在 BackgroundWorker 的 DoWork 中访问 UI 的做法通常是可疑的。

* * *

另外，*不要*在这里打电话`bw.Dispose()`；将其与拥有的容器或上下文一起处理。在这种情况下，它似乎是好的和良性的，但只有在该 BGW 实例将*不再*被使用时才这样做。从事件处理程序调用它也是可疑的，因为 BGW 仍然是“活动的”。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-22T08:15:19.713

我遇到了与上述评论者“Power-Mosfet”相同的问题

最后，添加一个`new BackgroundWorker()`然后分配给全局 bw 值将解决我的问题。

代码是，从改变：

```
private BackgroundWorker gBgwDownload;

private void yourFunction_bw(xxx)
{
    // Create a background thread
    gBgwDownload.DoWork += bgwDownload_DoWork;
    gBgwDownload.RunWorkerCompleted += bgwDownload_RunWorkerCompleted;
    //omited some code
    gBgwDownload.RunWorkerAsync(paraObj);
} 
```

至：

```
private BackgroundWorker gBgwDownload;

private void yourFunction_bw(xxx)
{
    // Create a background thread
    gBgwDownload = new BackgroundWorker(); /* added this line will fix problem */
    gBgwDownload.DoWork += bgwDownload_DoWork;
    gBgwDownload.RunWorkerCompleted += bgwDownload_RunWorkerCompleted;
    //omited some code
    gBgwDownload.RunWorkerAsync(paraObj);

} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-01-10T03:11:37.827

还有另一个原因。`DoWorkEventHandler`在其生成的代码中查找`InitializeComponent()`是否通过组件 UI 属性生成它并自己注册。

因为如果您再次注册它，它不会覆盖前一个，而是会添加另一个事件并调用两次。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-05-27T15:15:22.913

就我而言，BackgroundWorker 运行了两次，因为在我的表单的构造函数类中，我声明了 DoWork、ProgressChanged 和 RunWorkerCompleted 事件处理程序，但 Visual Studio 2013 已经在此表单类的设计器部分声明了它。

所以，我刚刚删除了我的声明，它工作得很好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-22T15:44:41.253

我今天遇到了这个问题，当我注意到每次我显示表单时，后台工作人员 RunWorkerCompleted 事件被多次调用时，我将一个后台工作人员放在一个正在执行长时间运行任务的弹出表单上。

我的问题是我在关闭表单后没有处理它，这意味着每次我显示表单时，它每次都会添加另一个处理程序。

完成后处理表格解决了我的问题。只是想在这里提一下，因为我在为我的情况寻找解决方案时遇到了这个页面。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T06:43:07.473

谢谢……这段代码运行良好……为 backroundworker 创建新实例是个好主意……现在我们可以在 for/while 循环中调用这个函数，并且可以运行多个 backgroundworker 进程。

当按钮单击完成时，我这样编码.. 不分散主线程流......多个进程将在后面运行......我只是使用消息框弹出......但我们可以做计时过程来运行“ bgwDownload_DoWork" 函数...并且将创建多个进程...并且我们不需要检查BackgroundWorker是否忙...

```
private void button1_Click(object sender, EventArgs e)
{
   for (int i = 0; i < 3; i++)
     yourFunction_bw(i);

 }
private BackgroundWorker gBgwDownload;

private void yourFunction_bw(int i)
{
    // Create a background thread
    gBgwDownload = new BackgroundWorker(); // added this line will fix problem 
    gBgwDownload.DoWork += bgwDownload_DoWork;
    gBgwDownload.RunWorkerAsync(i);

}

private void bgwDownload_DoWork(object sender, DoWorkEventArgs e)
{
  int stre = (int)e.Argument;
  MessageBox.Show(stre.ToString ()); // time taken process can be added here
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-31T08:48:58.247

我从设计器中删除了控件并在代码中实例化了一个新的 WorkerProcess：

例如： var bwProcess = new BackgroundWorker();

bwProcess.DoWork += 新 DoWorkEventHandler(bwProcess_DoWork);

bwProcess.RunWorkerCompleted += bwProcess_RunWorkerCompleted;

# javascript - 在 Javascript 中，toFixed() 对于货币是否足够准确？

> ID：12231386
> 
> 赞同：4
> 
> 时间：2012-09-01T21:03:03.860
> 
> 标签：javascript, currency, rounding, tofixed

我正在创建一个用于计算订单总额的脚本。有一些变量可以改变价格，因此会出现一些长位数的小数。

是否`toFixed()`足够精确以四舍五入这些数字并始终得到相同的结果？

编辑：我想出的解决方案是使用这个：

```
Number.prototype.toCurrency = function(){
    return Math.round(this*100)/100;
} 
```

这足以保持一致性吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:11:11.763

您不应该使用`toFixed`它，因为它不能在浏览器中始终如一地工作。

Javascript 中的所有数字都是双精度浮点数。浮点数根据定义并不精确，因此数字表示本身不够精确，无法始终获得准确的结果。

如果您希望在 Javascript 中获得可预测的结果，则必须牢记数字的精度限制，以便始终有足够大的余量来正确舍入数字。

# android - android 4.0 中的 android 对话框泄漏窗口，但 2.3 中没有

> ID：12231389
> 
> 赞同：0
> 
> 时间：2012-09-01T21:03:30.550
> 
> 标签：android, dialog

我有一个带有继续按钮的警报对话框。当单击按钮时，对话框应该关闭并午餐一个新的意图。由于某种原因在 Android 2.3 中它运行良好，但在 Android 4.0 中我得到窗口泄漏......这是我的代码：

```
 continueButton.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                if (cls != null)
                {
                    dismiss();
                    Intent i = new Intent(activity,cls);
                    activity.startActivity(i);
                }
             }
        }); 
```

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T00:55:28.163

您是指 AlertDialog 视图中的按钮吗？如果没有，您可以使用 AlertDialogue.Builder.setPositivebutton /negative /neutral 移出对话。单击这些按钮会自动关闭对话框。

# c# - 将 VM 物理路径映射到 Azure Blob 存储

> ID：12231405
> 
> 赞同：2
> 
> 时间：2012-09-01T21:05:55.703
> 
> 标签：c#, azure, azure-storage, azure-blob-storage

我想知道我是否可以将托管我的应用程序的虚拟机的物理路径（C、D 或 E 驱动器）映射到 Azure Blob 存储。

问候， 维维克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:25:28.710

您不能将 Blob 容器挂载为磁盘驱动器或以相反的方式进行。您可以做的是将 VHD 作为页 blob 存储在 blob 容器中。

如果您使用的是虚拟机 (IaaS)，则每个持久磁盘都存储为一个页 blob。您无需为此做任何事情（[添加数据盘](http://www.windowsazure.com/en-us/manage/windows/how-to-guides/attach-a-disk/)或使用系统盘除外）。

在您的云服务中，您可以使用[Windows Azure Drive (X-Drive)](http://blog.maartenballiauw.be/post/2010/02/02/Using-Windows-Azure-Drive-%28aka-X-Drive%29.aspx)来挂载一个新的驱动器号，该驱动器号将其数据作为 VHD 存储在 blob 存储中。

请注意，在这两种情况下，当您使用 Cerebrata、Cloud Storage Studio 等任何工具查看您的 blob 存储时，您将看到 1 个单个文件（VHD）。

**注意：**您可以恢复为自定义解决方案，例如[FTP 到 Azure Blob 存储桥](http://ftp2azure.codeplex.com/)

# c++ - 复制构造函数的动机 - 为什么我的程序不会崩溃？

> ID：12231407
> 
> 赞同：-3
> 
> 时间：2012-09-01T21:06:07.040
> 
> 标签：c++, copy-constructor

我了解到使用复制构造函数的动机之一是避免程序中的后续崩溃 -

```
#include <iostream>
using namespace std;

class Employee {
public:
    Employee(int ID,char const * name){...};
    ~Employee(){...};

    // Methods
    void Print();

private:
    // members
    int m_ID;
    char* m_name;
};

void MyFunc(Employee emp) {

    cout << "in MyFunc \n ";

}

int main() {
    Employee One(1,"Garen Torosian");

// calling copy constructor
    MyFunc(One);

    cout << "In the end of main \n";

// Here the program crashes!
    return 0;
} 
```

如您所见，该程序应该在之前崩溃`return 0;`，但是当我运行该程序时，它运行正常并且正常终止，为什么？

**编辑：**在这种情况下，程序确实崩溃了-

```
// Employee.h
#include <iostream>
using namespace std;

class Employee {
public:
   Employee(int ID, 
                   const char* name);
  ~Employee();

  // Methods
  void Print();

private:
  // members
  int   m_ID;
  char* m_name;
}; 
```

* * *

```
// Employee.cpp
#include "Employee.h“

Employee::Employee(int iID, const char *name){ // Ctor
  cout << "Constructor called" << endl;
  m_ID = iID;
  m_name = new char [strlen(name) +1];
  strcpy(m_name, name);
  Print();
}
void Employee::Print() { // Print
cout << "ID: " << m_ID << ",Name:” << m_name
<< " ,Address(pointer):0x" << hex << (int) m_name<< endl;
}
Employee::~Employee() { // Dtor
  cout << "Destructor called"<<endl;
  Print();
  delete [] m_name;
  m_name=NULL;
} 
```

* * *

```
void MyFunc(Employee emp) {

  cout << "in MyFunc \n ";    

}

int main()
{
    Employee One(1,"Eli Rachamim");

// calling copy constructor
MyFunc(One);

cout<< "In the end of main \n“;

// Here the program crashes! 
return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:15:58.123

如果你`d-tor`喜欢

```
~Employee(){ delete[] name; } 
```

并且你为你的`char*`指针分配内存，并且你没有`copy c-tor`，而不是`copy c-tor`编译器生成的，`memberwise-copy`当你复制对象时会调用它。因此，`double-free`在大多数情况下都会给你`memory dump`（在实际调用析构函数来已经破坏的对象是`UB`并且调用`delete[]`已经删除的对象也是`UB`）。但是如果你不使用内存 - `copy c-tor`，编译器生成的效果很好。

**编辑。**

因此，您的第二个示例演示了`d-tor`对已销毁对象的调用以及`double-free`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T21:09:34.277

为什么你认为它应该崩溃？

如果你不提供一个自动生成的复制构造函数，C++ 有一个不幸的特性，而你的 MyFunc() 并没有真正做任何会被自动生成的副本搞砸的事情。

# php - PHP“取消”代码行

> ID：12231412
> 
> 赞同：4
> 
> 时间：2012-09-01T21:06:31.810
> 
> 标签：php, python

我正在使用 phpseclib 连接到我的服务器并运行 python 脚本。python 脚本是一个无限循环，因此它会一直运行直到您停止它。当我使用 phpseclib 通过 ssh 执行 python script.py 时，它可以工作，但页面只是永远加载。它这样做是因为 phpseclib 认为运行无限循环脚本的代码行没有“完成”，因此它挂在该行上。我曾尝试在该行之后使用 exit 和 die，但当然，它不起作用，因为它挂在之前的行上，即执行命令的行。有没有人对如何在不修改 python 文件的情况下解决这个问题有任何想法？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T21:12:46.440

假设命令将由 shell 运行，您可以让它执行以下命令来启动它：

```
nohup python myscript.py > /dev/null 2>&1 & 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T18:58:42.133

您还可以做的其他事情：

```
$ssh->setTimeout(1); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T21:25:47.457

如果您在任何 shell 命令的末尾加上 & ，它将在后台运行并立即返回，这就是您真正需要的。

# php - 在 googledrive 的特定文件夹中上传文件

> ID：12231421
> 
> 赞同：1
> 
> 时间：2012-09-01T21:07:43.670
> 
> 标签：php, google-drive-api

我已使用以下 url 在 php 中使用 curl 将文件上传到 Googleddrive

```
https://www.googleapis.com/upload/drive/v2/files?uploadType=media. 
```

在主要外部文件夹（即驱动器）中上传文件可以正常工作。但是如何在特定文件夹中上传文件。我有 folderid。

我尝试按照 url 上传内部文件夹中的文件，但它不起作用：-

```
https://www.googleapis.com/upload/drive/v2/files/{folderid}?uploadType=media. 
```

如果有人可以帮助我。我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T02:53:41.247

您必须在元数据的父集合中设置目标文件夹的 ID：

```
{
  "title" : "My document",
  "mimeType" : "image/jpeg",
  "parents": [{
    "kind": "drive#file",
    "id": "<folderId>"
  }]
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T22:10:01.677

您为此使用PHP吗？如果是这样，那么我会推荐使用 Google 的 PHP API 客户端，因为他们会为您完成繁重的工作。

# c# - 存储用户时区首选项

> ID：12231422
> 
> 赞同：9
> 
> 时间：2012-09-01T21:08:00.317
> 
> 标签：c#, .net, timezone

我在这里的要求是相当标准的；我需要允许用户选择他们当前的时区并将其保存到他们的帐户中。然后，我将使用此值将存储`DateTime`的值转换为本地时间。

我目前的想法是，我将允许用户从列表中选择一个 .NET `TimeZoneInfo.Id`（保存在数据库中以允许更友好的描述，但使用 构造`TimeZoneInfo.GetSystemTimeZones()`） - 然后我将使用此值返回相关`TimeZoneInfo`实例`TimeZoneInfo.FindSystemTimeZoneById()`并执行转换。我在这里看到的主要问题是它`TimeZoneInfo.Id`是注册表中保存的值，而不是“标准”ID（例如，与 Olson 相比）。因此，服务器更新/迁移可能会使存储的 Id 完全无效并破坏转换。

简而言之-这种方法有效/安全吗？如果没有，是否有更好的方法来存储用户时区偏好，同时处理夏令时等，而无需大量额外的逻辑？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-21T21:42:32.517

我刚刚发现了这个古老的未回答的问题，所以我想我应该试一试。

> 简而言之-这种方法有效/安全吗？

这一切都取决于你打算用它们做什么。

如果您只是在服务器端代码中使用它，那么可以。您只需存储`Id`时区的 ，并向用户显示相应的`DisplayName`. `FindSystemTimeZoneById`并且`GetSystemTimeZones`对此完全有效。

请记住，虽然`Id`值始终相同，但`DisplayName`属性将根据您运行代码的 Windows 操作系统的语言而有所不同。该实现*不*支持文化，因此仅在 .Net 中设置不同的目标文化不会更改`DisplayName`字符串。

Microsoft Windows 时区数据库中的记录相当稳定，并通过 Windows Update 保持更新。 *一些*信息来自注册表，但本地化的资源字符串来自`tzres.dll`. 当然，所有这些都被`TimeZoneInfo`相关类隐藏起来。

但是，如果您将这些时区`Id`值传递给其他系统 - 请注意。与以前的 Windows 版本存在一些差异。例如，我知道过去的显示名称都说“GMT”，现在更正确地说是“UTC”。值是相同的`Id`，但谁知道还有什么不一致。特别是如果目标计算机没有收到与您相同的一组 Windows 更新。顺便说一下，更新在[这里](http://support.microsoft.com/gp/cp_dst)公布。

您还应该了解一些有关 Windows 时区数据库的信息：

*   它不能代表每个日历年超过两个 DST 转换。例如 - [2010 年，埃及开罗有*四次*转型](http://www.timeanddate.com/worldclock/clockchange.html?n=53&year=2010)。微软发布[了一个修补程序](http://support.microsoft.com/kb/2297272)，但这只是一个妥协的修正，而不是历史上准确的修正。还有其他区域具有这样的历史变化，无法正确表示。

*   Windows XP/2003 和 Vista/2008 之间发生了一些变化。[这里](http://blogs.msdn.com/b/bclteam/archive/2007/06/07/exploring-windows-time-zones-with-system-timezoneinfo-josh-free.aspx)有一些非常好的信息，以及关于如何使用注册表的很多细节。

*   微软是*唯一*拥有自己时区数据库的主要参与者。世界其他地区使用[IANA/Olson 数据库](http://www.iana.org/time-zones)。这会导致互操作性问题。[我在时区标签 wiki](https://stackoverflow.com/tags/timezone/info)中有一篇不错的文章。

您还应该知道，它与和类`TimeZoneInfo`有着千丝万缕的联系。这些都有自己的一套怪癖。 有点用，但充满了细微差别。读：`DateTime``DateTimeOffset``DateTimeOffset``DateTime`

*   [无论如何，DateTime 有什么问题？](http://noda-time.blogspot.com/2011/08/what-wrong-with-datetime-anyway.html)通过乔恩斯基特
*   [针对 DateTime.Now 的案件，](http://codeofmatt.com/2013/04/25/the-case-against-datetime-now/)作者：Matt Johnson（我）

.Net 中日期和时间的*更好*解决方案是使用[NodaTime](https://code.google.com/p/noda-time/)。这个库实现*了两个*时区数据库，包括它们之间的 CLDR 映射。它还提供了一个更安全的 API，不会让您陷入麻烦。这可能需要重新学习，但在不知不觉中，您将使用诸如`LocalDateTime`、和之类`ZonedDateTime`的类。`OffsetDateTime``Instant`

您仍然存在时区数据库经常更新的问题，因为我们将计时规则留给政客。但是[TZDB 人员](http://mm.icann.org/pipermail/tz/)在保持数据库历史准确性方面做得很好，并在区域名称更改时提供别名/链接。[您可以在此处](http://en.wikipedia.org/wiki/List_of_tz_database_time_zones)查看 tz 名称列表。

此外，如果您使用 NodaTime，您可以选择坚持使用编译到发行版中的 TZDB 副本，或者您可以将自己的副本与您的应用程序一起发布。您可以（理论上）编写自己的代码以从 IANA 下载最新版本并保持应用程序更新——所有这些都无需依赖主机操作系统。

# mysql - 获取线程中的第一个和最后一个帖子

> ID：12231424
> 
> 赞同：0
> 
> 时间：2012-09-01T21:08:07.423
> 
> 标签：mysql, sql, database

我正在尝试编写一个论坛网站，我想显示一个线程列表。每个线程都应附有关于第一个帖子（线程的“头部”）以及最后一个帖子的信息。我当前的数据库结构如下：

```
threads table:
id   - int, PK, not NULL, auto-increment
name - varchar(255)

posts table:
id        - int, PK, not NULL, auto-increment
thread_id - FK for threads 
```

这些表也有其他字段，但它们与查询无关。我有兴趣查询`threads`并以某种方式`JOIN`使用，`posts`以便在单个查询中获得每个线程的第一篇和最后一篇文章（没有子查询）。到目前为止，我可以使用多个查询来做到这一点，并且我将第一篇文章定义为：

```
SELECT *
FROM threads t
LEFT JOIN posts p ON t.id = p.thread_id
ORDER BY p.id
LIMIT 0, 1 
```

最后一个帖子几乎相同，除了`ORDER BY id DESC`。现在，我可以通过执行以下操作选择多个线程及其第一篇*或*最后一篇文章：

```
SELECT *
FROM threads t
LEFT JOIN posts p ON t.id = p.thread_id
ORDER BY p.id
GROUP BY t.id 
```

但是我当然不能同时得到两者，因为我需要同时对两者进行`ASC`排序`DESC`。
这里的解决方案是什么？甚至可以使用单个查询吗？有什么办法可以改变我的表格结构来促进这一点？如果这不可行，那么您能给我什么提示来提高这种特殊情况下的查询性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:37:23.147

您可以使用子查询和连接做一些事情：

```
SELECT first.text as first_post_text, last.text as last_post_text
FROM
  (SELECT MAX(id) as max_id, MIN(id) as min_id FROM posts WHERE thread_id = 1234) as sub
JOIN posts first ON (sub.max_id = first.id)
JOIN posts last ON (sub.min_id = last.id) 
```

但这并不能解决您在没有子查询的情况下执行此操作的问题。

您可以在线程表中添加列，以便保留每个线程的第一个和最后一个帖子的 ID。第一篇文章永远不会改变，但是每次添加新文章时，您都必须更新线程表中的该记录，这样会使您的写入翻倍，并且您可能需要使用事务来避免竞争条件。

或者，您甚至可以在主题行中复制有关第一个和最后一个帖子的信息。假设您需要发布者的 user_id、发布的时间戳以及帖子的前 100 个字符。您可以在线程表中创建 6 个新列来包含第一篇和最后一篇文章的这些数据。它会复制数据，但这意味着您可以显示线程列表，而根本不需要查询帖子表。

# php - 未传递给函数的变量

> ID：12231426
> 
> 赞同：1
> 
> 时间：2012-09-01T21:08:28.220
> 
> 标签：php, variables

我刚刚回到 PHP 编程，我似乎无法弄清楚这一点。

我只是想写一个简单的登录屏幕，但我似乎无法将变量传递给我的“登录”函数。

所以这是我在帖子页面上调用的代码......

```
$Email = $_POST["Email_Address"];
    $Password = $_POST["Password"];

    // check to see if the login is valid
    $ValidLogin = ValidateLogin($Email, $Password, $ErrorMessage); 
```

我之前在一个单独的包含文件中声明了 ValidateLogin，该文件在此代码之前调用。

```
function ValidateLogin($EmailAddress, $Password, &$ErrorMessage){

    $ErrorMessage = ""; 

} 
```

当我查看 ValidateLogin 函数中的变量时，它们是空白的？我让这段代码在另一个项目上工作，但不明白为什么它在这里不起作用。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:17:32.353

就个人而言，我不会使用引用变量——**因为引用比其他语言少得多**。由于这个事实，通过引用参数声明往往会产生丑陋的问题。

在那里我会写这个方法，它**返回一个逻辑值和一个错误消息**：

```
/**
*
* Checks email-address and password vs. the list of all valid user credentials.
* Returns an array, with two elements
*  [0]  -> TRUE iff. credentials are valid
*  [1]  -> An error-message, which may be posted to the result web-page
*
* @param string $EmailAddress - An email-address
* @param string $Password - A password
* @returns array - array( bool, string )
*/
function ValidateLogin( $EmailAddress, $Password ){

   // Do whatever is possible to verify credentials
   return array( TRUE, 'this is a message' );

} 
```

你会像这样使用这个方法：

```
$Email = $_POST["Email_Address"];
$Password = $_POST["Password"];

// check to see if the login is valid
list( $ValidLogin, $errorMessage ) = ValidateLogin( $Email, $Password ); 
```

请注意，这`list()`是一种语言结构，用于拆分列表。在此处查找[文档](http://php.net/manual/en/function.list.php)。

**FORM 元素的 POST 方法**

请不要，您的表单需要像这样读取才能将值传递`$_POST`给 PHP：

```
<form action="theActualScriptname.php" method="post">
   ... form elements ..
</form> 
```

不要忘记：元素的`method`属性`form`是必不可少的！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:22:50.677

回到原来的问题，我确实让它工作了。这似乎是一个范围问题，该函数是在一个 Switch 块中声明的，在该块中我包含带有函数声明的文件（在本例中为 ValidateLogin()）。该函数在 Switch Block 之外被调用。当我移动函数声明时，它起作用了。

我觉得很奇怪，它无论如何都运行了函数，但只是没有传递参数，它们都是空白的。我使用 Eclipse/XDebug 单步执行代码，我可以看到参数，一旦我单步执行该函数就会消失。

也许有人可以告诉我为什么会这样？为什么它调用函数，但不传递参数。

# php - 匹配两个mysql结果

> ID：12231434
> 
> 赞同：2
> 
> 时间：2012-09-01T21:09:49.003
> 
> 标签：php, mysql, arrays, loops

这是一个初学者 php/mysql 问题，我已经用各种循环搞砸了几个小时，但我还没有达到目标。我在数据库中有两个表。一个包含书籍，一个包含书籍的库存信息。像这样：

```
id  title
1   A book
2   Another book
3   A third book 
```

对于股票（book_stock）

```
id  book_id   warehouse_id   qty
1   1         1              12
2   1         2              45
3   2         3              22
4   3         1              78
5   1         3              15 
```

我想读取表格，将 book 表中的 id 与 stock 表中的 book_id 匹配，然后在 html 表中输出摘要，显示书名以及不同仓库中每本书的数量。到目前为止，我尝试过的涉及循环 mysql 请求，这似乎会崩溃，因为它没有输出任何结果。我觉得解决方案很简单并且涉及数组，但我的技能缺乏......

这是我的非工作代码。该函数适用于手动输入的 1、2 甚至 20 个结果，但在循环时仅输出空白表格单元格。

```
//function to get stock based on book id number
function get_stock($book_row_number)
{
    //get BOOK from db
    $book_query="SELECT * FROM book";
    $book_result=mysql_query($book_query);

    //determine book info
    $book_id=mysql_result($book_result,$book_row_number,"id");
    $book_title=mysql_result($book_result,$book_row_number,"title");

    //get LONDON stock for this book from db
    $stock_query="SELECT qty FROM book_stock WHERE book_id='$book_id' AND warehouse_id='1'";
    $stock_result=mysql_query($stock_query);
    $stock_london=mysql_result($stock_result,0,"qty");

    //get USA stock for this book from db
    $stock_query="SELECT qty FROM book_stock WHERE book_id='$book_id' AND warehouse_id='2'";
    $stock_result=mysql_query($stock_query);
    $stock_usa=mysql_result($stock_result,0,"qty");

    //get GERMANY stock for this book from db
    $stock_query="SELECT qty FROM book_stock WHERE book_id='$book_id' AND warehouse_id='4'";
    $stock_result=mysql_query($stock_query);
    $stock_germany=mysql_result($stock_result,0,"qty");

    echo "<tr><td>$book_title</td><td>$stock_london</td><td>$stock_usa</td><td>$stock_germany</td></tr>\n";
}

//find number of rows in book list
$all_query="SELECT * FROM book";
$all_result=mysql_query($all_query);
$all_rows=mysql_numrows($all_result);

// run the function on all the rows
$i=0;
while ($i < $all_rows) {
    get_stock('$all_rows');
    $i++;
} 
```

编辑：现在的代码

```
<?php

//set up connection
$user="username";
$password="paswd";
$database="database";
mysql_connect("localhost",$user,$password);
@mysql_select_db($database) or die( "Unable to select database");

//query
$book_query="SELECT
book_id,
title,
SUM(CASE WHEN warehouse_id = 1 THEN book_stock.qty ELSE 0 END) AS warehouse1,
SUM(CASE WHEN warehouse_id = 2 THEN book_stock.qty ELSE 0 END) AS warehouse2,
SUM(CASE WHEN warehouse_id = 3 THEN book_stock.qty ELSE 0 END) AS warehouse3,
SUM(CASE WHEN warehouse_id = 4 THEN book_stock.qty ELSE 0 END) AS warehouse4
FROM
book_stock
JOIN book ON book.id = book_stock.book_id
GROUP BY book_id, title";

//loop
$result = mysql_query($book_query);
if ($result) {
  while ($row = mysql_fetch_assoc($row)) {
    echo "<tr><td>" . htmlspecialchars($row['title']) . "</td><td>{$row['warehouse1']}</td><td>{$row['warehouse2']}</td><td>{$row['warehouse3']}</td><td>{$row['warehouse4']}</td></tr>";
  }
}
else echo mysql_error();

//close database
mysql_close();
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:14:00.563

如果将其构建为数据透视表，则可以在单个查询中执行此操作。这个想法是聚合将匹配`SUM()`的值加在一起，或者当每行不匹配时为 0，将所有仓库折叠成一行。`qty``warehouse_id`

```
SELECT
  SUM(CASE WHEN warehouse_id = 1 THEN qty ELSE 0 END) AS warehouse1,
  SUM(CASE WHEN warehouse_id = 2 THEN qty ELSE 0 END) AS warehouse2,
  SUM(CASE WHEN warehouse_id = 3 THEN qty ELSE 0 END) AS warehouse3,
  SUM(CASE WHEN warehouse_id = 4 THEN qty ELSE 0 END) AS warehouse4
FROM
  book_stock
WHERE book_id = $book_id 
```

对于`book_id = 1`，这会产生如下结果：

```
warehouse1 warehouse2 warehouse3 warehouse4
       12        45          15          0 
```

要为所有行中的书籍获取它，请添加`GROUP BY`：

```
SELECT
  book_id,
  title,
  SUM(CASE WHEN warehouse_id = 1 THEN qty ELSE 0 END) AS warehouse1,
  SUM(CASE WHEN warehouse_id = 2 THEN qty ELSE 0 END) AS warehouse2,
  SUM(CASE WHEN warehouse_id = 3 THEN qty ELSE 0 END) AS warehouse3,
  SUM(CASE WHEN warehouse_id = 4 THEN qty ELSE 0 END) AS warehouse4
FROM
  book_stock
  JOIN book ON book.id = book_stock.book_id
GROUP BY book_id, title 
```

然后 PHP 的输出是一个简单的`while`循环：

```
// Assuming you already opened your <table>
$result = mysql_query($the_big_query_above);
if ($result) {
  while ($row = mysql_fetch_assoc($result)) {
    echo "<tr><td>" . htmlspecialchars($row['title']) . "</td><td>{$row['warehouse1']}</td><td>{$row['warehouse2']}</td><td>{$row['warehouse3']}</td><td>{$row['warehouse4']}</td></tr>";
  }
}
else echo mysql_error();

// Then don't forget to close your </table> 
```

# vba - VBA 中 msoTextOrientationHorizo ntal 的常量值是多少？

> ID：12231435
> 
> 赞同：2
> 
> 时间：2012-09-01T21:10:08.410
> 
> 标签：vba, com, constants, powerpoint, late-binding

深夜的简单问题......就像标题所说的那样，什么是 msoTextOrientationHorizo​​ntal？

我希望后期绑定用于在 VBA 中控制 MS PowerPoint 的代码，但似乎无法从 PowerPoint 11.0 库中找到 msoTextOrientationHorizo​​ntal 的常量值。

```
Dim objPPTApp As Object
Dim oPPSlide As Object
Dim oPPShape As Object
Const ppLayoutBlank = 12

Set objPPTApp = CreateObject("Powerpoint.Application")
Set oPPSlide = objPPTApp.ActivePresentation.Slides.Add(1, ppLayoutBlank)
Set oPPShape = oPPSlide.Shapes.AddTextbox(msoTextOrientationHorizontal, 10, 10, 256, 28) 
```

类似于

```
Dim objPPTApp As Object
Dim oPPSlide As Object
Dim oPPShape As Object
Const ppLayoutBlank = 12
Const msoTextOrientationHorizontal= 0 '## Value needed 

Set objPPTApp = CreateObject("Powerpoint.Application")
Set oPPSlide = objPPTApp.ActivePresentation.Slides.Add(1, 12)
Set oPPShape = oPPSlide.Shapes.AddTextbox(msoTextOrientationHorizontal, 10, 10, 256, 28) 
```

感谢您的支持！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T14:40:31.390

来自“Microsoft Office 14.0 对象库”：

```
typedef enum {
    msoTextOrientationMixed = 0xfffffffe, // -2
    msoTextOrientationHorizontal = 1, // <<-- This is the one you need
    msoTextOrientationUpward = 2,
    msoTextOrientationDownward = 3,
    msoTextOrientationVerticalFarEast = 4,
    msoTextOrientationVertical = 5,
    msoTextOrientationHorizontalRotatedFarEast = 6
} MsoTextOrientation; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T16:30:18.350

更一般地说，您了解对象浏览器吗？打开要自动化的应用程序（或设置对其的引用），然后在 IDE 中按 F2。您将能够搜索您所追求的常量并在最底部的窗格中找到它的值。

# asp.net - 处理来自 DataReader 的空值

> ID：12231438
> 
> 赞同：0
> 
> 时间：2012-09-01T21:10:27.033
> 
> 标签：asp.net, vb.net, dataset

我过去曾这样做过，但我不记得处理 DBNULLS 的正确方法。

这是 vb.net

我得到的错误是从“DBNull”类型到“Integer”类型的转换无效。

这是代码。

```
Dim reader As MySqlDataReader = command.ExecuteReader
Do While reader.Read
Dim item As New clsProvider(reader.Item("MasterAccountID"), reader.Item("CompanyName"), reader.Item("Address"), reader.Item("Postcode"), reader.Item("Telephone"), reader.Item("Fax"), reader.Item("Number_of_Companies"), reader.Item("Total_Number_of_employees"), reader.Item("MainContactName"), reader.Item("MainContactPhone"), reader.Item("MainContactEmail"), reader.Item("Fee"), Convert.ToString(reader.Item("Notes")))
            list.Add(item)
Loop
reader.Close() 
```

我遇到的问题是数据库中的某些项目可能为空。我确定过去我做过类似的事情

```
convert.ToString(reader.item("Something") 
```

但对于我的生活，我不记得了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:24:32.387

如果该列可以为空，那么您应该检查是否为空：

```
If (reader.IsDBNull(ordinal)) 
```

请参见[IsDBNull](http://msdn.microsoft.com/en-us/library/system.data.common.dbdatareader.isdbnull.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T21:18:27.663

Perhaps

```
 reader.item("Something").ToString() 
```

is what you've done before?

This isn't necessarily *correct* but it does deal with null strings quite effectively.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T21:23:08.453

Perhaps:

```
IFF(reader.item("Something") != DBNull.Value, reader.item("Something"), "") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T21:23:50.797

您必须首先检查列值是否为空（检查 DBNull 的传入值）。一旦您知道您可以决定下一步该做什么 - 将 null 或其他一些默认值分配给您的变量。

我不确定我的 VB.Net 是否仍然符合要求，但这样的事情应该会有所帮助：

```
Dim item As New clsProvider
item.AccountId = TryCast(reader.Item("MasterAccountID"), String)
item.SomeInt= If(TryCast(reader.Item("SomeInt"), System.Nullable(Of Integer)), 0) 
```

用于`TryCast`检查是否可以进行投射。

# sql-server - 需要更快地连接 sql server 表中的列

> ID：12231439
> 
> 赞同：2
> 
> 时间：2012-09-01T21:10:39.737
> 
> 标签：sql-server, tsql

在 200,000 多条记录的 sqlserver 表中，我需要帮助更快地连接按其他列分组的某些列数据。例如，**示例数据和预期结果如下所示**。

在这里，我需要将最后一列连接`ColumnA, ColumnB, ColumnC`为管道分隔的字符串，以便将这四列组合起来：

```
where KeyNumber=@strKeyNumber  and  Action=@strAction  and  Type=@strType  and  Code=@strCode 
```

这四个是不同的组合。

我使用 t-sql STUFF 函数对此进行了编码，但它太慢了。我还使用 while 循环进行了不同的编码，但即使这样也太慢了。

所以我需要帮助来获得更快的结果。

这些列 A、B、C 中的数据是长字符串，因此连接的字符串应该是类型`nvarchar(max)`。

**表中的原始数据（某些列中可能存在重复）：**

```
ID  KeyNumber   Action  Type    Code    ColumnA     ColumnB     ColumnC  
1   1111111111  AC1     TYPE1   CODE1   ValueA1     ValueB1     ValueC1 
2   1111111111  AC1     TYPE1   CODE1   ValueA2     ValueB2     ValueC2 
3   1111111111  AC1     TYPE1   CODE1   ValueA2     ValueB2     ValueC3 
4   1111111111  AC1     TYPE1   CODE1   ValueA3     ValueB3     ValueC4
5   2222222222  AC2     TYPE2   CODE2   ValA1       ValB1       ValC1   
6   2222222222  AC2     TYPE2   CODE2   ValA2       ValB2       ValC2
7   2222222222  AC2     TYPE2   CODE2   ValA3       ValB3       ValC3
8   2222222222  AC2     TYPE2   CODE2   ValA4       ValB4       ValC4
9   2222222222  AC2     TYPE2   CODE2   ValA4       ValB5       ValC4 
```

**需要将结果数据放入如下新表中（上表中的重复值不应在此重复）：**

```
ID  KeyNumber   Action  Type    Code    ColumnA                 ColumnB                         ColumnC  
1   1111111111  AC1     TYPE1   CODE1   ValueA1|ValueA2|ValueA3 ValueB1|ValueB2|ValueB3         ValueC1|ValueC2|ValueC3|ValueC4 
2   2222222222  AC2     TYPE2   CODE2   ValA1|ValA2|ValA3|ValA4 ValB1|ValB2|ValB3|ValB4|ValB5   ValC1|ValC2|ValC3|ValC4 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:15:48.393

你可以检查这个：

```
DECLARE @Table TABLE
(
    ID BIGINT,
    Keynumber BIGINT,
    [Action] CHAR(3),
    [Type] CHAR(5),
    Code CHAR(5),
    ColumnA NVARCHAR(MAX),
    ColumnB NVARCHAR(MAX),
    ColumnC NVARCHAR(MAX)
)

INSERT INTO @TABLE(ID,Keynumber,[Action],[Type],Code,ColumnA,ColumnB,ColumnC)
VALUES   (1,1111111111,'AC1','TYPE1','CODE1','ValueA1','ValueB1','ValueC1') 
        ,(2,1111111111,'AC1','TYPE1','CODE1','ValueA2','ValueB2','ValueC2')
        ,(3,1111111111,'AC1','TYPE1','CODE1','ValueA2','ValueB2','ValueC3')
        ,(4,1111111111,'AC1','TYPE1','CODE1','ValueA3','ValueB3','ValueC4')
        ,(5,2222222222,'AC2','TYPE2','CODE2','ValA1','ValB1','ValC1')
        ,(6,2222222222,'AC2','TYPE2','CODE2','ValA2','ValB2','ValC2')
        ,(7,2222222222,'AC2','TYPE2','CODE2','ValA3','ValB3','ValC3')
        ,(8,2222222222,'AC2','TYPE2','CODE2','ValA4','ValB4','ValC4')
        ,(9,2222222222,'AC2','TYPE2','CODE2','ValA4','ValB5','ValC4')

SELECT   Keynumber
        ,[Action]
        ,[Type]
        ,Code
        ,(
             SELECT  ColumnA AS [text()]
             FROM    @Table TableOne
             WHERE    TableOne.Keynumber = TableTwo.Keynumber and  TableOne.[Action] = TableTwo.[Action] and  TableOne.[Type] = TableTwo.[Type]
             ORDER BY TableOne.ColumnA
             FOR XML PATH(''), TYPE
        ).value('/', 'NVARCHAR(MAX)') AS ColumnA
        ,(
             SELECT  ColumnB AS [text()]
             FROM     @Table TableOne
             WHERE    TableOne.Keynumber = TableTwo.Keynumber and  TableOne.[Action] = TableTwo.[Action] and  TableOne.[Type] = TableTwo.[Type]
             ORDER BY TableOne.ColumnB
             FOR XML PATH(''), TYPE
        ).value('/', 'NVARCHAR(MAX)') AS ColumnB
        ,(
            SELECT   ColumnC AS [text()]
            FROM     @Table TableOne
            WHERE    TableOne.Keynumber = TableTwo.Keynumber and  TableOne.[Action] = TableTwo.[Action] and  TableOne.[Type] = TableTwo.[Type]
            ORDER BY TableOne.ColumnC
            FOR XML PATH(''), TYPE
        ).value('/', 'NVARCHAR(MAX)') AS ColumnC

FROM(
        SELECT  DISTINCT Keynumber,[Action],[Type],Code
        FROM    @Table
    ) TableTwo 
```

另外，我不确定您使用的是哪种字符串连接方法。您可以查看此站点以了解其他技术：

[http://www.simple-talk.com/sql/t-sql-programming/concatenating-row-values-in-transact-sql/](http://www.simple-talk.com/sql/t-sql-programming/concatenating-row-values-in-transact-sql/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T03:40:17.193

**您是否知道 CodePlex 具有用户定义的聚合GROUP_CONCAT**的开源 CLR 实现。安装就像在您的服务器上运行 SQL 脚本一样简单。

[http://groupconcat.codeplex.com/](http://groupconcat.codeplex.com/)

它有 4 个 group_concat 实现并且是返回 NVARCHAR(MAX)

*   GROUP_CONCAT --默认分隔符是 ,（逗号）

*   GROUP_CONCAT_D -- 你可以指定分隔符

*   GROUP_CONCAT_DS - 您可以指定分隔符，排序顺序（1 为 asc 顺序，2 为 desc 顺序）

*   GROUP_CONCAT_S -- 你可以指定排序顺序

    我认为这在性能方面非常好。

![在此处输入图像描述](../Images/b79196ceeb1700585445dcab945a9635.png)

在您的示例中，您将像这样使用它

```
SELECT   Keynumber
    ,[Action]
    ,[Type]
    ,Code
    ,dbo.GROUP_CONCAT_DS(ColumnA,'|',1) AS ColumnA
    ,dbo.GROUP_CONCAT_DS(ColumnB,'|',1) AS ColumnB
    ,dbo.GROUP_CONCAT_DS(ColumnC,'|',1) AS ColumnC 
FROM YourTable
GROUP BY
     Keynumber
    ,[Action]
    ,[Type]
    ,Code 
```

# jquery - 使侧边栏高度与正文高度相等

> ID：12231440
> 
> 赞同：2
> 
> 时间：2012-09-01T21:10:43.827
> 
> 标签：jquery, css

我是 CSS 新手，但遇到了问题。我想让侧边栏内容高度与正文匹配或等于相同高度。我目前正在使用，但这仅适用于声明高度：

```
 min-height: 240px; 
```

您可以在这里找到该网站：http: [//jsfiddle.net/ZPvLb/](http://jsfiddle.net/ZPvLb/)

向下滚动页面，直到看到正文，右侧是侧边栏。看到不同？

关于我如何做到这一点的任何建议或帮助？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:46:54.917

我不敢相信人们真的关心 Javascript 被禁用。这是一个不存在的问题。我同意弗兰克的观点。禁用 JS 甚至不应该是一个选项。

永远不要担心用户没有启用 JS，应该让它休息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T21:19:39.760

Since you tagged jQuery it's possible to do this using javascript.

```
<script type="text/javascript">
    $(document).ready( function() {
        $('.content', '#side').height($('.content', '#main').height());
    });
</script> 
```

That will match the sidebar content height to the main content height. Put that inside the head tag, and be sure to include the jQuery library.

A pure CSS solution is going to take much more work as already pointed out.

Here's the changes included in the [jsfiddle](http://jsfiddle.net/ZPvLb/3/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T21:14:36.690

这被一些 CSS 的“圣杯”称为，并且有充分的理由：这样做非常不直观，主要是由于 CSS 高度的工作方式。

不过还是有希望的：Matthew Taylor 就这个问题写了一篇出色的文章，尽管我怀疑要使用他的解决方案，您需要稍微编辑一下您的结构。

[http://matthewjamestaylor.com/blog/perfect-2-column-left-menu.htm](http://matthewjamestaylor.com/blog/perfect-2-column-left-menu.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-11T01:20:15.990

那里的许多解决方案都不起作用或太复杂。（令人沮丧，考虑到这对表格来说很容易。）

通常是主页被破坏，因为字体和图像在调整侧边栏大小之前没有机会加载，尤其是在连接速度较慢的情况下。

首先，使用 CSS 明确定义所有图像的宽度和高度。如果您不指定图像的大小，浏览器将无法知道页面的高度或宽度（用于换行）。

接下来，就网络字体而言，这是我的解决方案。只需使用 jQuery 将您的内容“滑动”到位。这只需要在主页上发生一次。

```
$(function() {
    $("#content").slideDown('slow').promise().always(function(){
        $("#sidebar").height($("#content").height()); // drop sidebar down
    }); // Just show homepage content
}); 
```

当然，您的页面会有所不同。这是一个更完整的[例子](http://linkedexpertsalliance.com/linkedin-consultant.html)。

本质上，您的侧边栏在滑入到位*后会调整大小。*这可以防止您的侧边栏在您的字体有机会加载之前将其自身调整得太短。

# xcode4 - XCode 4 Unimotion

> ID：12231441
> 
> 赞同：0
> 
> 时间：2012-09-01T21:10:45.150
> 
> 标签：xcode4, accelerometer

我使用 Xcode 4，我目前没有任何 iDevice 能够在我的应用程序中测试加速度计，所以我搜索了一段时间并找到名为“unimotion”的实用程序。为 Unimotion 阅读我的文件说：“包含一个 Makefile，所以你所要做的就是 cd 到 'unimotion' 目录并输入 'make'。” 所以我尝试了，但终端给我一条消息

> ls: /Developer/SDKs: 没有这样的文件或目录 cc -Wall -Os -g -isysroot /Developer/SDKs/ -arch i386 -arch ppc -fconstant-cfstrings -c -o unimotion.o unimotion.c clang: 警告：未对“powerpc”架构使用 clang 编译器 unimotion.c:72:10：致命错误：未找到“IOKit/IOKitLib.h”文件
> 
> # 包括 IOKit/IOKitLib.h>
> 
> *产生 1 个错误。*制作[1]：*** [unimotion.o] 错误 1 ​​制作：*** [sub-unimotion] 错误 2

一次又一次。

那么，我做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T13:57:45.343

用**_** _ `/Developer/SDKs/`_

```
/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/ 
```

那应该对你有帮助。如果您使用的是 Xcode 4，您可能还会收到更多错误

```
llvm-gcc-4.2: error trying to exec '/usr/bin/../llvm-gcc-4.2/bin/powerpc-apple-darwin11-llvm-gcc-4.2': execvp: No such file or directory 
```

因为`-arch ppc`那里不再支持。只需删除 Makefile 中的每一个出现`-arch ppc`，它就会起作用。

# xtk - xtk 2D 渲染器与 onMousedown 位置链接

> ID：12231442
> 
> 赞同：0
> 
> 时间：2012-09-01T21:10:51.670
> 
> 标签：xtk

有没有办法将三个 2D 渲染器链接在一起，以便在单击其他两个渲染器时移动到单击点的切片？[这是我的意思的一个例子](http://ric.uthscsa.edu/mango/MangoKiosk.html)。

2drenderer 中当前的 onMousedown 行为是调整窗口级别，可以关闭、打开或修改此行为吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T01:58:49.413

目前这是不可能的。有一些关于取消投影 3D 场景以从屏幕坐标到世界坐标的工作。请参阅[https://github.com/xtk/X/issues/78](https://github.com/xtk/X/issues/78)不幸的是，它还没有进入头脑。

这是第一步，然后我们必须将 3D 坐标转移到体积空间。

而对于 2D，这甚至是另一回事。很遗憾，现在不可能，但会是一个很棒的功能，欢迎任何贡献：D

# udp - 编辑特定端口上的传入数据包

> ID：12231444
> 
> 赞同：0
> 
> 时间：2012-09-01T21:11:05.020
> 
> 标签：udp, packet-sniffers, packets, tcp-ip

我知道有各种程序可以嗅探数据包，例如 WireShark，但我很确定您只能查看数据。我想知道是否可以*编辑*传入的数据包。我不确定数据包是否是正确的术语。我只想编辑通过互联网接收的传入数据，并且谁的目的地是特定应用程序。假设我正在玩在线游戏。当它加载我的电脑时，它正在接收诸如“这个人的钱袋里有 10 个硬币”之类的信息。显然不完全*一样*但你明白了。我希望能够更改数据，所以说是 100 而不是 10。我知道如果你这样做是可能的：想象我的计算机通过以太网线连接到互联网。有一个连接到以太网线的设备接收数据并更改它，然后让它继续到我的计算机。我只想知道这是否可能，以及如何实现。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:53:32.803

我这样做的方式是两种方式之一：1。

1.  如果您的应用程序支持它，请在您的机器上设置一个 HTTP 代理，您可以使用 burp / Fiddler 之类的软件来处理数据

2.  如果不是（协议不是 HTTP），您可以使用我尝试过的 2 个选项之一[都基于将 API 调用从应用程序连接到操作系统]：

    *   允许搞乱数据包的 EchoMirage 软件
    *   [更高级：] 有一个名为 OllyDbg 的调试器，它有一个名为 Universal Hooker 的插件；它可以挂钩任何窗口 API 函数并根据需要执行 python 脚本。uHooker 包含有关如何挂钩 WSASend 和 WSARecive（它们是 Windows 套接字中使用的 API 函数）的示例。

# android - 如何从线程打开 AsyncTask

> ID：12231446
> 
> 赞同：-2
> 
> 时间：2012-09-01T21:11:40.627
> 
> 标签：android, multithreading, android-activity, android-asynctask

在我的应用程序中，我创建了一个`SplashScreen`将 b 显示 5 秒的 a，然后根据存储在 Preference 文件中的值执行 if else case。如果首选项文件包含值，则`AsyncTask`代码将运行，否则将加载登录表单。当我尝试运行我的应用程序时。该线程将在意图的帮助下进入登录表单，但是当涉及到`AsyncTask`我的应用程序时，会显示强制关闭错误消息。

这是我的`SplashScreen`代码：

```
public class SplashScreen extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.splashscreen);

    Thread timer = new Thread()
    {
        public void run()
        {
            try
            {
                sleep(5000);
            }
            catch(InterruptedException e)
            {
                e.printStackTrace();
            }
            finally
            {
                if(GoGolfPref.getEmail(SplashScreen.this)!=null && GoGolfPref.getPass(SplashScreen.this)!=null)
                {
                    new LoadingScreen(SplashScreen.this, SplashScreen.this).execute("login_page", Login.url+GoGolfPref.getEmail(SplashScreen.this)+"/"+GoGolfPref.getPass(SplashScreen.this));
                }
                else
                {
                    Intent in = new Intent(SplashScreen.this, Login.class);
                    startActivity(in);
                    finish();
                }
            }
        }
    };
    timer.start();
} 
```

}

这是我得到的错误：

```
08-29 07:25:58.040: E/AndroidRuntime(2365): FATAL EXCEPTION: Thread-10
08-29 07:25:58.040: E/AndroidRuntime(2365): java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare()
08-29 07:25:58.040: E/AndroidRuntime(2365):     at android.os.Handler.<init>(Handler.java:121)
08-29 07:25:58.040: E/AndroidRuntime(2365):     at android.app.Dialog.<init>(Dialog.java:101)
08-29 07:25:58.040: E/AndroidRuntime(2365):     at android.app.AlertDialog.<init>(AlertDialog.java:63)
08-29 07:25:58.040: E/AndroidRuntime(2365):     at android.app.ProgressDialog.<init>(ProgressDialog.java:80)
08-29 07:25:58.040: E/AndroidRuntime(2365):     at android.app.ProgressDialog.<init>(ProgressDialog.java:76)
08-29 07:25:58.040: E/AndroidRuntime(2365):     at com.pnf.gogolf.LoadingScreen.<init>(LoadingScreen.java:130)
08-29 07:25:58.040: E/AndroidRuntime(2365):     at com.pnf.gogolf.SplashScreen$1.run(SplashScreen.java:32) 
```

如何让这个工作？

提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:19:28.380

The problem is you're making changes to the UI somewhere, but they're not being done on the UI thread. Anything to do with the user interface has to be done on the UI thread. You do that by encapsulating your code in another runnable and calling runOnUiThread():

```
runOnUiThread(new Runnable() {
  @Override
  public void run() {
   // set some text views or something
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T21:34:10.023

使用处理程序而不是线程的最佳实践，因为处理程序可以在执行期间在 UI 中更改以了解有关处理程序和线程的更多信息，只需[在 Android 中检查此处理程序和线程](http://www.vogella.com/articles/AndroidPerformance/article.html)

# java - 在 Java 中创建二维数组的语法

> ID：12231453
> 
> 赞同：460
> 
> 时间：2012-09-01T21:12:49.720
> 
> 标签：java, multidimensional-array

考虑：

```
int[][] multD = new int[5][];
multD[0] = new int[10]; 
```

这就是你创建一个 5 行 10 列的二维数组的方式吗？

我在网上看到了这段代码，但语法没有意义。

* * *

## 回答 #1

> 赞同：858
> 
> 时间：2012-09-01T21:15:28.990

尝试以下操作：

```
int[][] multi = new int[5][10]; 
```

...这是这样的简写：

```
int[][] multi = new int[5][];
multi[0] = new int[10];
multi[1] = new int[10];
multi[2] = new int[10];
multi[3] = new int[10];
multi[4] = new int[10]; 
```

请注意，每个元素都将被初始化为 , 的默认值`int`，`0`因此上面也等价于：

```
int[][] multi = new int[][]{
  { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
  { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
  { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
  { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 },
  { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 }
}; 
```

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2013-08-05T07:07:13.723

我们可以声明一个二维数组，并在声明时直接存储元素为：

```
int marks[][]={{50,60,55,67,70},{62,65,70,70,81},{72,66,77,80,69}}; 
```

这里*int*表示存储在数组中的整数类型元素，数组名称为 'marks'。*int*是“{”和“}”大括号内表示的所有元素的数据类型，因为数组是具有相同数据类型的元素的集合。

回到我们上面写的语句：每一行元素都应该写在花括号内。行和每行中的元素应以逗号分隔。

现在观察语句：可以得到 3 行 5 列，因此 JVM 创建 3 * 5 = 15 块内存。这些块可以单独称为：

```
marks[0][0]  marks[0][1]  marks[0][2]  marks[0][3]  marks[0][4]
marks[1][0]  marks[1][1]  marks[1][2]  marks[1][3]  marks[1][4]
marks[2][0]  marks[2][1]  marks[2][2]  marks[2][3]  marks[2][4] 
```

注意：
如果要存储*n 个*元素，则数组索引从零开始，到*n-1*结束。创建二维数组的另一种方法是先声明数组，然后使用 new 运算符为其分配内存。

```
int marks[][];           // declare marks array
marks = new int[3][5];   // allocate memory for storing 15 elements 
```

结合以上两者，我们可以写出：

```
int marks[][] = new int[3][5]; 
```

* * *

## 回答 #3

> 赞同：53
> 
> 时间：2012-09-01T21:23:58.527

您可以按照其他人提到的方式创建它们。还有一点要补充：您甚至可以为每一行创建一个倾斜的二维数组，不一定具有相同数量的列，如下所示：

```
int array[][] = new int[3][];
array[0] = new int[3];
array[1] = new int[2];
array[2] = new int[5]; 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2012-09-01T21:14:43.833

**创建5**行**10**列的二维数组的最常见习惯用法是：

```
int[][] multD = new int[5][10]; 
```

[或者，您可以使用以下内容，这与您所拥有的更相似，但您需要显式初始化每一行：]

```
int[][] multD = new int[5][];
for (int i = 0; i < 5; i++) {
  multD[i] = new int[10];
} 
```

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2015-01-23T09:04:10.663

也可以通过以下方式声明它。这不是好的设计，但它确实有效。

```
int[] twoDimIntArray[] = new int[5][10]; 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2012-09-01T21:15:12.440

尝试：

```
int[][] multD = new int[5][10]; 
```

请注意，在您的代码中，只有 2D 数组的第一行被初始化为 0。第 2 到 5 行甚至不存在。如果您尝试打印它们，您将得到`null`每个人的。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-11-21T12:25:21.640

```
int [][] twoDim = new int [5][5];

int a = (twoDim.length);//5
int b = (twoDim[0].length);//5

for(int i = 0; i < a; i++){ // 1 2 3 4 5
    for(int j = 0; j <b; j++) { // 1 2 3 4 5
        int x = (i+1)*(j+1);
        twoDim[i][j] = x;
        if (x<10) {
            System.out.print(" " + x + " ");
        } else {
            System.out.print(x + " ");
        }
    }//end of for J
    System.out.println();
}//end of for i 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2014-06-24T16:23:32.180

在 Java 中，可以将二维数组声明为与一维数组相同。在一个一维数组中，你可以这样写

```
 int array[] = new int[5]; 
```

其中 int 是一种数据类型，array[] 是一个数组声明，并且`new array`是一个包含五个索引的对象的数组。

像这样，您可以编写一个二维数组，如下所示。

```
 int array[][];
  array = new int[3][4]; 
```

这`array`是一个 int 数据类型。我首先声明了该类型的一维数组，然后创建了一个 3 行 4 列数组。

在您的代码中

```
int[][] multD = new int[5][];
multD[0] = new int[10]; 
```

表示您创建了一个二维数组，有五行。第一行有 10 列。在 Java 中，您可以根据需要为每一行选择列大小。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2014-06-23T11:28:41.877

```
int rows = 5;
int cols = 10;

int[] multD = new int[rows * cols];

for (int r = 0; r < rows; r++)
{
  for (int c = 0; c < cols; c++)
  {
     int index = r * cols + c;
     multD[index] = index * 2;
  }
} 
```

享受！

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-09-30T06:13:11.450

试试这个方法：

```
int a[][] = {{1,2}, {3,4}};

int b[] = {1, 2, 3, 4}; 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2017-07-13T09:19:01.247

这些类型的数组在 Java 中称为锯齿状数组：

```
int[][] multD = new int[3][];
multD[0] = new int[3];
multD[1] = new int[2];
multD[2] = new int[5]; 
```

在这种情况下，数组的每一行都包含不同数量的列。在上面的示例中，第一行将包含三列，第二行将包含两列，第三行将包含五列。您可以在编译时初始化此数组，如下所示：

```
 int[][] multD = {{2, 4, 1}, {6, 8}, {7, 3, 6, 5, 1}}; 
```

您可以轻松地迭代数组中的所有元素：

```
for (int i = 0; i<multD.length; i++) {
    for (int j = 0; j<multD[i].length; j++) {
        System.out.print(multD[i][j] + "\t");
    }
    System.out.println();
} 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-04-01T10:31:15.797

实际上Java没有数学意义上的多维数组。Java 所拥有的只是数组数组，一个数组，其中每个元素也是一个数组。这就是为什么初始化它的绝对要求是第一维的大小。如果指定了其余部分，则它将创建一个填充有默认值的数组。

```
int[][]   ar  = new int[2][];
int[][][] ar  = new int[2][][];
int[][]   ar  = new int[2][2]; // 2x2 array with zeros 
```

它也给了我们一个怪癖。子数组的大小不能通过添加更多元素来改变，但我们可以通过分配一个任意大小的新数组来做到这一点。

```
int[][]   ar  = new int[2][2];
ar[1][3] = 10; // index out of bound
ar[1]    = new int[] {1,2,3,4,5,6}; // works 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-02-17T22:02:51.740

如果你想要动态和灵活的东西（即你可以添加或删除列和行的地方），你可以尝试“ArrayList of ArrayList”：

```
public static void main(String[] args) {

    ArrayList<ArrayList<String>> arrayListOfArrayList = new ArrayList<>();

    arrayListOfArrayList.add(new ArrayList<>(List.of("First", "Second", "Third")));
    arrayListOfArrayList.add(new ArrayList<>(List.of("Fourth", "Fifth", "Sixth")));
    arrayListOfArrayList.add(new ArrayList<>(List.of("Seventh", "Eighth", "Ninth")));
    arrayListOfArrayList.add(new ArrayList<>(List.of("Tenth", "Eleventh", "Twelfth")));

    displayArrayOfArray(arrayListOfArrayList);
    addNewColumn(arrayListOfArrayList);
    displayArrayOfArray(arrayListOfArrayList);
    arrayListOfArrayList.remove(2);
    displayArrayOfArray(arrayListOfArrayList);
}

private static void displayArrayOfArray(ArrayList<ArrayList<String>> arrayListOfArrayList) {
    for (int row = 0; row < arrayListOfArrayList.size(); row++) {
        for (int col = 0; col < arrayListOfArrayList.get(row).size(); col++) {
            System.out.printf("%-10s", arrayListOfArrayList.get(row).get(col));
        }
        System.out.println("");
    }
    System.out.println("");
}

private static void addNewColumn(ArrayList<ArrayList<String>> arrayListOfArrayList) {
    for (int row = 0; row < arrayListOfArrayList.size(); row++) {
        arrayListOfArrayList.get(row).add("added" + row);
    }
} 
```

输出：

```
First     Second    Third     
Fourth    Fifth     Sixth     
Seventh   Eighth    Ninth     
Tenth     Eleventh  Twelfth   

First     Second    Third     added0    
Fourth    Fifth     Sixth     added1    
Seventh   Eighth    Ninth     added2    
Tenth     Eleventh  Twelfth   added3    

First     Second    Third     added0    
Fourth    Fifth     Sixth     added1    
Tenth     Eleventh  Twelfth   added3 
```

# java - 带有 birt 的 tomcat6 上的 jdbc 问题

> ID：12231457
> 
> 赞同：0
> 
> 时间：2012-09-01T21:13:44.990
> 
> 标签：java, linux, tomcat, jdbc, driver

首先，我对tomcat6知之甚少，而且我已经很久没有做过复杂的java工作了。

所以我朋友的服务器出现故障，我正试图让事情在一个新系统上运行（Ubuntu 12.04，带有 Tomcat6）。

他的网站有一些 birt 报告的链接，但它们不起作用。看起来 jdbc mysql 驱动程序有问题。

这是我所拥有的：在 catalina.sh 中，我拥有

```
CLASSPATH=$CLASSPATH:/usr/share/java 
```

在那个目录中，我有（显然，这里不仅仅是这些东西）：

```
mysql-connector-java-5.1.16.jar
mysql-connector-java.jar
mysql.jar 
```

birt 的东西部署在 /var/lib/tomcat6/webapps/WebViewerExample 中，在那里我看到了 WEB-INF/lib 目录，我还复制了 mysql-connector jar 文件。

我设置了 birt 以便它记录东西，这是它给我的错误：

```
Sep 1, 2012 3:49:51 PM org.eclipse.birt.report.data.oda.jdbc.JDBCDriverManager loadExtraDriver
SEVERE: refreshUrlsWhenFail: true
Sep 1, 2012 3:49:51 PM org.eclipse.birt.report.data.oda.jdbc.JDBCDriverManager loadExtraDriver
SEVERE: driverClassPath: null
Sep 1, 2012 3:49:51 PM org.eclipse.birt.report.data.oda.jdbc.JDBCDriverManager loadExtraDriver
SEVERE: Registered URLs:
Sep 1, 2012 3:49:51 PM org.eclipse.birt.report.data.oda.jdbc.JDBCDriverManager findDriver
WARNING: Failed to load JDBC driver class: com.mysql.jdbc.Driver
Sep 1, 2012 3:49:51 PM org.eclipse.birt.data.engine.odaconsumer.ConnectionManager openConnection
SEVERE: Unable to open connection.
org.eclipse.birt.report.data.oda.jdbc.JDBCException: Cannot load JDBC Driver class: com.mysql.jdbc.Driver.
    at org.eclipse.birt.report.data.oda.jdbc.JDBCDriverManager.findDriver(JDBCDriverManager.java:782)
.... Huge stack trace... 
```

所以我对java和tomcat不太了解。关于我能做些什么来让它发挥作用的任何线索？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T23:09:18.770

像驱动程序这样的罐子`JDBC`应该添加到全局类路径中。你需要把它放到`mysql-connector-java-5.1.16.jar`tomcat的lib目录下。将其放入`${tomcat.dir}/lib`文件夹并从中删除`mysql`jar `WEB-INF/lib`。

# c# - 如何检测崩溃的标签式网络浏览器并进行处理？

> ID：12231471
> 
> 赞同：0
> 
> 时间：2012-09-01T21:15:17.460
> 
> 标签：c#, tabs, crash, browser

我有一个带有选项卡控件的桌面应用程序（表单），我分配了一个选项卡和一个新的自定义 webbrowser 控件。我打开了大约 10 个这样的选项卡。每个人访问大约 100 - 500 个不同的页面。

问题在于，如果 1 个网络浏览器控件出现问题，它会关闭整个程序。

我希望能够关闭有问题的 webbrowser 控件并在其位置打开一个新控件。

是否有任何事件需要我订阅才能捕获崩溃或无响应的网络浏览器控件？

我在 Windows 7（窗体）、.NET 框架 v4 上使用 C#

==================================================== ==============

# **更新：1 - 选项卡式 WebBrowser 示例**

这是我拥有的代码以及我如何以最基本的方式使用 webbrowser 控件。

1.  创建一个新的表单项目并将其命名为 SimpleWeb
2.  添加一个新类并将其命名为 myWeb.cs，这是要使用的代码。

> ```
> using System;
> using System.Collections.Generic;
> using System.Linq;
> using System.Text;
> using System.Windows.Forms;
> using System.Security.Policy;
> 
> namespace SimpleWeb
> {
>     //inhert all of webbrowser
>     class myWeb : WebBrowser
>     {
> 
>         public myWeb()
>         {
>             //no javascript errors
>             this.ScriptErrorsSuppressed = true;
> 
>             //Something we want set?
>             AssignEvents();
>         }
> 
>         //keep near the top
>         private void AssignEvents()
>         {
> 
>             //assign WebBrowser events to our custom methods
>             Navigated += myWeb_Navigated;
>             DocumentCompleted += myWeb_DocumentCompleted;
>             Navigating += myWeb_Navigating;
>             NewWindow += myWeb_NewWindow;
> 
>         }
> 
>         #region Events
>         //List of events:http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser_events%28v=vs.100%29.aspx
> 
>         //Fired when a new windows opens
>         private void myWeb_NewWindow(object sender, System.ComponentModel.CancelEventArgs e)
>         {
>             //cancel all popup windows
>             e.Cancel = true;
>             //beep to let you know canceled new window
>             Console.Beep(9000, 200);
>         }
> 
>         //Fired before page is navigated (not sure if its before or during?)
>         private void myWeb_Navigating(object sender, System.Windows.Forms.WebBrowserNavigatingEventArgs args)
>         {
> 
>         }
> 
>         //Fired after page is navigated (but not loaded)
>         private void myWeb_Navigated(object sender, System.Windows.Forms.WebBrowserNavigatedEventArgs args)
>         {
> 
>         }
> 
>         //Fired after page is loaded (Catch 22 - Iframes could be considered a page, can fire more than once. Ads are good examples)
>         private void myWeb_DocumentCompleted(System.Object sender, System.Windows.Forms.WebBrowserDocumentCompletedEventArgs args)
>         {
> 
>         }
> 
>         #endregion
> 
>         //Answer supplied by mo. (modified)?
>         public void OpenUrl(string url)
>         {
>             try
>             {
>                 //this.OpenUrl(url);
>                 this.Navigate(url);
>             }
>             catch (Exception ex)
>             {
>                 MessageBox.Show("Your App Crashed! Because = " + ex.ToString());
>                 //MyApplication.HandleException(ex);
>             }
>         }
> 
>         //Keep near the bottom
>         private void RemoveEvents()
>         {
>             //Remove Events
>             Navigated -= myWeb_Navigated;
>             DocumentCompleted -= myWeb_DocumentCompleted;
>             Navigating -= myWeb_Navigating;
>             NewWindow -= myWeb_NewWindow;
>         }
>     }
> } 
> ```

1.  在 Form1 上拖动标准 tabControl 并将停靠栏设置为填充，您可以进入选项卡集合并根据需要删除预填充的选项卡。

2.  右键单击 Form1 并选择“查看代码”并将其替换为此代码。

> ```
> using System;
> using System.Collections.Generic;
> using System.ComponentModel;
> using System.Data;
> using System.Drawing;
> using System.Linq;
> using System.Text;
> using System.Windows.Forms;
> using mshtml;
> 
> namespace SimpleWeb
> {
>     public partial class Form1 : Form
>     {
>         public Form1()
>         {
>             InitializeComponent();
> 
>             //Load Up 10 Tabs
>             for (int i = 0; i <= 10; i++)
>             {
>                 newTab("Test_" + i, "http://wwww.yahoo.com");
> 
>             }
>         }
> 
>         private void newTab(string Title, String Url)
>         {
> 
>             //Create a new Tab
>             TabPage newTab = new TabPage();
>             newTab.Name = Title;
>             newTab.Text = Title;
> 
>             //create webbrowser Instance
>             myWeb newWeb = new myWeb();
> 
>             //Add webbrowser to new tab
>             newTab.Controls.Add(newWeb);
>             newWeb.Dock = DockStyle.Fill;
> 
>             //Add New Tab to Tab Pages
>             tabControl1.TabPages.Add(newTab);
> 
>             newWeb.OpenUrl(Url);
> 
>         }
>     }
> } 
> ```

保存并运行项目。

使用下面的答案。，您可以毫无问题地浏览第一个网址，但是用户点击的所有网址呢？我们如何检查这些？

我不喜欢向页面上的每个 html 元素添加事件，必须有一种方法可以在导航之前通过函数 OpenUrl 运行新的 url，而不会出现无限循环。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:25:01.870

您可以使用[`AppDomain.UnhandledException`](http://msdn.microsoft.com/de-de/library/system.appdomain.unhandledexception)or[`Application.ThreadException`](http://msdn.microsoft.com/de-de/library/system.windows.forms.application.threadexception)事件。

但是以这种方式处理异常可能最终导致您的应用程序处于**无效状态**。

您能否描述一下，这些异常何时发生。
它们是执行方法的结果吗？

那么在调用方法中处理错误会好得多。

```
void OpenUrl(Url url)
{
   try
   {
       var webBrowser = GetWebBrowser(tabControl.SelectedTab);
       webBrowser.OpenUrl(url);
   }
   catch(SpecificException ex)
   {
       MyApplication.HandleException(ex);
   }
} 
```

关于你的评论，试试这个：

```
try
{
   myCustomWebbrowser.Navigate("yahoo.com");
}
catch(Exception ex) //catch specific exceptions here (catch all is a bad practice)
{
   MessageBox.Alert(ex.Message); //just for testing.
} 
```

[这篇文章](http://www.codeproject.com/Articles/13598/Extended-NET-2-0-WebBrowser-Control)应该可以帮助你：

```
private void AssignEvents()
{
  Navigated += myWeb_Navigated;
  DocumentCompleted += myWeb_DocumentCompleted;
  Navigating += myWeb_Navigating;
  NewWindow += myWeb_NewWindow;
  DownloadComplete += myWen_DownloadComplete;
}

void myWen_DownloadComplete(object sender, EventArgs e)
{
  // Check wheter the document is available (it should be)
  if (Document != null)
    // Subscribe to the Error event
    Document.Window.Error += myWeb_Window_Error;
}

void myWeb_Window_Error(object sender, HtmlElementErrorEventArgs e)
{
  // We got a script error, record it
  ScriptErrorManager.Instance.RegisterScriptError(e.Url, 
                           e.Description, e.LineNumber);
  // Let the browser know we handled this error.
  e.Handled = true;
} 
```

# javascript - 我怎样才能使它不能拖动图像？

> ID：12231478
> 
> 赞同：-5
> 
> 时间：2012-09-01T21:16:05.187
> 
> 标签：javascript, html, css, drag

> **可能重复：**
> [在 HTML 元素上禁用拖放？](https://stackoverflow.com/questions/704564/disable-drag-and-drop-on-html-elements)

我想知道是否有办法制作某些图像以便它们不能被拖动？我认为会有一个css属性但是我找不到任何东西。

这是我正在处理的网站：http: [//i.imgur.com/6mzvC.png](https://i.imgur.com/6mzvC.png) 我的目标是让它不能拖动徽标。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-09-01T21:29:55.867

这是如何启用和禁用拖动效果

```
$("#imageid").draggable('disable'); //disable
$("#imageid").draggable();  //enable 
```

现在这真的取决于你要这样做。

# jquery - $(document).ready(function(){}); 在 IE9 上失败

> ID：12231479
> 
> 赞同：4
> 
> 时间：2012-09-01T21:16:11.603
> 
> 标签：jquery, internet-explorer-9

我正在为多个 php 页面使用单个 js 文件。在每个 php 的末尾，我创建一个 javascript 变量来识别它，如下所示：

```
<div>    
.
.
.
</div>

<script>
var idp = 1;
</script>

</body>
</html> 
```

然后在我的 js 文件中，我有：

```
$(document).ready(function() {
    .
    .
    .
    if (idp == 1) {
       FunctionWithTheCodeForPage1();
    }
    if (idp == 2) {
       FunctionWithTheCodeForPage2();
    }
}); 
```

它在 Chrome 和 Firefox 上运行良好，但在 IE9 中，有时它似乎无法获取 idp 变量的值，有时它不会执行我在“if”语句之前拥有的一些 jquery 代码，似乎问题出在 $(document ）。准备好（）; 因为我已经设置了 FunctionWithTheCodeForPage1(); 直接在第 1 页的 php 中，它可以工作，但 $(document).ready(); 中的其余代码；才不是。

这是我正在使用的库：

```
<script type='text/javascript' src="Scripts/Popcalendar.js"></script>
<script type='text/javascript' src='Scripts/jquery-latest.js'></script>
<script type='text/javascript' src='Scripts/jquery.lightbox_me.js'></script>
<script type='text/javascript' src='Scripts/MyJS.js'></script> 
```

此问题并非一直发生，有时页面加载正确，有时会出现此错误，但主要是错误。IE9是否存在兼容性问题？我错过了什么？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:25:12.390

由于您已经准备好几个函数，只需将它们直接传递给 jQuery，而不是绕过一些 ID 变量。

如果您将一个函数传递给 jQuery，它将在页面准备好后立即执行。通常这是使用匿名函数完成的，如下所示：

```
$(function() {   // or $(document).ready(function() {
  // ...
}); 
```

但您也可以只传递您之前定义的现有函数。

```
$(FunctionWithTheCodeForPage1); 
```

您还可以为实体定义一个唯一 ID 并具有一个功能：

```
$(function () {
  $("body#page1").each(function () {
    // page1 specific;
  });
  $("body#page2").each(function () {
    // page2 specific;
  });
}); 
```

这样您就不必在页面中添加*任何*额外的脚本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T07:53:01.620

我有同样的问题，`$(document).ready(function() {...}`没有被 IE9 调用。

原来 IE9 是在“Quirks”模式下工作的。（使用 F12 菜单了解更多信息）。

我只是将以下（html5 doctype）添加到页面顶部......

```
<!DOCTYPE html> 
```

而下面的标题...

```
<meta http-equiv="X-UA-Compatible" content="IE=9" > 
```

IE9 开始玩得很好！希望这可以帮助...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T21:24:02.593

做一件事。

`var idp`使用 php设置该值，而不是对其进行硬编码。IT 将确保填充它。

笔记：

您还可以使用 php 填充隐藏字段并获取它的值。

# web - 从网络连接到家庭服务器

> ID：12231481
> 
> 赞同：0
> 
> 时间：2012-09-01T21:16:43.633
> 
> 标签：web, iptables

我在家里有一台 CentOS 服务器，我正试图在上面放置一个网站。我将 index.html 放在 /var/www/html/ 文件夹中，并且可以从本地网络上的另一台计算机（使用“http://192.168.etc”）访问它。当我尝试使用我的 ip (http://34.52.xx.xx) 从网络访问它时，问题就来了。当我尝试访问 iptables 以排除防火墙问题但没有成功时，我关闭了它。我使用 Comcast 并读到他们有时会阻塞端口 80，所以我编辑了 /etc/httpd/conf/httpd.conf 以侦听端口 8000 以及 80 以防端口 80 被阻塞（httpd 在更改后重新启动）。当我在 iptables 下输入“http://myIP:8000”时，我仍然没有显示我的页面。

我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T23:13:45.313

你肯定有一个公共 IP 地址，比如说 34.52.01.01，你肯定有“几个”私有 IP 地址 192.168.1.1/192.168.1.2 ...

在这两个世界之间，您的路由器调用 NAT（网络地址转换）中有一个层，它允许从假设 192.168.1.2 开始的请求到达外部世界（比如说 google.com），而外部世界为这样的请求是您的路由器 NAT 知道该答案必须路由回 192.168.1.2

但是，如果您有一个来自外部世界的请求，指向 34.52.01.01，那么您在该地址上没有 HTTP 服务器，那么您需要在路由器中设置一些转发规则，说明如果您在端口 80 中收到 TCP 请求，请将其路由到192.168.1.5 是您的 HTTP 服务器的内部地址……</p>

您需要将端口转发添加到您的路由器...</p>

# c++ - VoIP C++ 参考资料

> ID：12231483
> 
> 赞同：0
> 
> 时间：2012-09-01T21:17:12.657
> 
> 标签：c++, voip

我在查找简单 VoIP 应用程序外观的教程/示例时遇到了麻烦。我在网上搜索并找到了一个过时的分步教程，所以它没有太大帮助，这就是考虑教程。但是，我设法找到了一些不错的 API，例如 libosip ( oSIP )。如果有人知道任何好的教程，那将是一件很棒的事情；或者如果有任何我可以结帐的小型 VoIP 开源应用程序。如果没有评论/解释，我在理解别人的代码方面真的没有任何麻烦。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T21:32:14.540

有一个很棒的 sip 框架，叫做[PJSIP](http://www.pjsip.org/)。看[这个例子](http://www.pjsip.org/pjsip/docs/html/page_pjsip_sample_simple_pjsuaua_c.htm)是一个简短但完整的演示。另请查看[PJSUA API](http://www.pjsip.org/pjsip/docs/html/group__PJSUA__LIB.htm)。

# ruby-on-rails - 在 ruby 中，如何包装内部对象的所有实例方法？类似于 python 的 getattr()

> ID：12231486
> 
> 赞同：0
> 
> 时间：2012-09-01T21:17:29.550
> 
> 标签：ruby-on-rails, ruby

我有一个包含许多实例方法的现有类。我想封装（或子类）该类，以便新类可以调用所有这些原始实例方法，并简单地委托给内部（或父）类，但也可以在前后调用自己的代码代表团。

例如，这是我正在寻找的一些伪代码：

```
class Wrapper
  def initialize(inner)
    @inner = inner
  end

  def __getattr__(method_name, *method_args) # <-- made up syntax
    # do something before
    ret = @inner.method_name(*method_args) # <-- made up syntax, call method on inner
    # do something after
    ret
  end 
```

在 ruby​​ 中实现这一点的最佳方法是什么？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:29:36.820

就像是：

```
def method_missing(method_name, *method_args, &block) # <-- made up syntax
  if @inner.respond_to? method_name
    # do something before
    ret = @inner.send(method_name, *method_args, &block) # <-- made up syntax, call method on inner
    # do something after
    ret
  else
    super(method_name, *method_args, &block)
  end
end 
```

应该做的伎俩。

# string - 面试街字符串相似性挑战的 Haskell 解决方案

> ID：12231495
> 
> 赞同：3
> 
> 时间：2012-09-01T21:18:35.927
> 
> 标签：string, algorithm, haskell

这是我为 InterviewStreet解决[字符串相似性](https://www.interviewstreet.com/challenges/dashboard/#problem/4edb8abd7cacd)挑战的最佳尝试。

```
import Control.Monad
import Data.Text as T
import qualified Data.Text.IO as TIO

sumSimilarities s = (T.length s) + (sum $ Prelude.map (similarity s) (Prelude.tail $ tails s))

similarity :: Text -> Text -> Int
similarity a b = case commonPrefixes a b of
                     Just (x,_,_) -> T.length x
                     Nothing -> 0

main = do
    cases <- fmap read getLine
    inputs <- replicateM cases TIO.getLine
    forM_ inputs $ print . sumSimilarities 
```

它只通过了 7/10 的测试用例。测试用例 7、8 和 9 失败，因为它们超过了分配的执行时间。

我一半试图验证这确实可以在 Haskell 中解决，一半在寻找优化的 Haskell 程序的样子。

谢谢！泰勒

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T00:20:42.470

像[user5402](https://stackoverflow.com/users/866915/user5402)一样，我很好奇等效（对于某些等效值）C 程序是否会在时间限制内完成或超时。`ByteString`如果可以的话，看看使用s的等效程序是否能及时完成会很有趣。- 并不是说`ByteString`​​ s 本身比 快`Text`，但由于输入必须转换为`Text`while的内部表示`ByteString`，因此可能会有所不同。`ByteString`s 可能更快的另一个可能原因（如果测试机器具有 32 位 GHC）是该[文本](http://hackage.haskell.org/package/text)的 fusion 至少过去需要比 32 位架构上通常可用的更多寄存器才能获得全部利润[很久以前，在 text-0.5 到 text-0.7 的日子里，在我的 32 位盒子上，[字节串](http://hackage.haskell.org/package/bytestring)曾经是快了很多，不知道这是否仍然适用于较新的[文本](http://hackage.haskell.org/package/text)版本]。

好的，因为[user5402](https://stackoverflow.com/users/866915/user5402)已经验证了 naïve 算法在 C 中足够快，所以我继续使用`ByteString`s编写了 naïve 算法的实现

```
{-# LANGUAGE BangPatterns #-}
module Main (main) where

import qualified Data.ByteString as B
import qualified Data.ByteString.Char8 as C
import qualified Data.ByteString.Unsafe as U
import Control.Monad
import Data.Word

main :: IO ()
main = do
    cl <- C.getLine
    case C.readInt cl of
      Just (cases,_) -> replicateM_ cases (C.getLine >>= print . similarity)
      Nothing -> return ()

-- Just to keep the condition readable.
(?) :: B.ByteString -> Int -> Word8
(?) = U.unsafeIndex

similarity :: B.ByteString -> Int
similarity bs
    | len == 0  = 0
    | otherwise = go len 1
      where
        !len = B.length bs
        go !acc i
            | i < len   = go (acc + prf 0 i) (i+1)
            | otherwise = acc
        prf !k j
            | j < len && bs ? k == bs ? j   = prf (k+1) (j+1)
            | otherwise = k 
```

并将其与`Text`一些不良情况下的 OP 版本进行比较。在我的机器上，这比`Text`版本快四倍多，所以它是否足够快会很有趣（C 版本又快了 4.5 倍，所以很可能不是）。

但是，我认为由于使用具有二次最坏情况行为的朴素算法，超过时间限制的可能性更大。可能有一些测试用例会唤起朴素算法的最坏情况。

所以解决方案是使用一种可以更好地扩展、最佳线性的算法。一种计算字符串相似度的线性算法是[Z 算法](http://codeforces.com/blog/entry/3107)。

这个想法很简单（但是，像大多数好想法一样，不容易拥有）。让我们将一个（非空）子字符串称为前缀子字符串，它也是字符串的前缀。为了避免重新计算，该算法使用前缀子字符串的窗口，该窗口在当前考虑的索引之前开始，向右延伸最远（最初，该窗口是空的）。

使用的变量和算法的不变量：

*   `i`，所考虑的索引，从 1 开始（对于基于 0 的索引；不考虑整个字符串）并递增到`length - 1`
*   `left`和`right`，前缀子字符串窗口的第一个和最后一个索引；不变量：
    1.  `left < i`, `left <= right < length(S)`,`left > 0`或者`right < 1`,
    2.  如果`left > 0`, 那么`S[left .. right]`是 and 的最大公共`S`前缀`S[left .. ]`,
    3.  如果`1 <= j < i`和`S[j .. k]`是 的前缀`S`，则`k <= right`
*   一个数组`Z`，不变量： for `1 <= k < i`，包含and`Z[k]`的最长公共前缀的长度。`S[k .. ]``S`

算法：

1.  设置`i = 1`, `left = right = 0`（`left <= right < 1`允许任何值），并`Z[j] = 0`为所有索引设置`1 <= j < length(S)`。
2.  如果`i == length(S)`，停止。
3.  如果`i > right`，求和`l`的最长公共前缀的长度`S`，`S[i .. ]`将其存储在 中`Z[i]`。如果`l > 0`我们发现一个窗口比前一个窗口延伸得更远，则设置`left = i`and `right = i+l-1`，否则保持不变。递增`i`并转到 2。
4.  在这里`left < i <= right`，子串`S[i .. right]`是已知的——因为它`S[left .. right]`是 的前缀`S`，所以它等于`S[i-left .. right-left]`。

    `S`现在考虑从 index 开始的子字符串的最长公共前缀`i - left`。它的长度是`Z[i-left]`，因此`S[k] = S[i-left + k]`对于`0 <= k < Z[i-left]`和
    `S[Z[i-left]] ≠ S[i-left+Z[i-left]]`。现在，如果`Z[i-left] <= right-i`，则`i + Z[i-left]`在已知窗口内，因此

    ```
    S[i + Z[i-left]] = S[i-left + Z[i-left]] ≠ S[Z[i-left]]
    S[i + k]         = S[i-left + k]         = S[k]   for 0 <= k < Z[i-left] 
    ```

    我们看到 和 的最长公共前缀的`S`长度`S[i .. ]`有 length `Z[i-left]`。然后设置`Z[i] = Z[i-left]`，递增`i`，然后转到 2。

    否则，`S[i .. right]`是 的前缀，`S`我们检查它的扩展范围，开始比较索引处的字符`right+1`和`right+1 - i`。设长度为`l`。设置`Z[i] = l`, `left = i`, `right = i + l - 1`, increment `i`，然后转到 2。

由于窗口从不向左移动，并且比较总是在窗口结束后开始，因此字符串中的每个字符最多与字符串中较早的字符比较一次成功，并且对于每个起始索引，最多有一个不成功的比较，因此该算法是线性的。

代码（`ByteString`出于习惯使用，应该可以轻松移植到`Text`）：

```
{-# LANGUAGE BangPatterns #-}
module Main (main) where

import qualified Data.ByteString as B
import qualified Data.ByteString.Char8 as C
import qualified Data.ByteString.Unsafe as U
import Data.Array.ST
import Data.Array.Base
import Control.Monad.ST
import Control.Monad
import Data.Word

main :: IO ()
main = do
    cl <- C.getLine
    case C.readInt cl of
      Just (cases,_) -> replicateM_ cases (C.getLine >>= print . similarity)
      Nothing -> return ()

-- Just to keep the condition readable.
(?) :: B.ByteString -> Int -> Word8
(?) = U.unsafeIndex

-- Calculate the similarity of a string using the Z-algorithm
similarity :: B.ByteString -> Int
similarity bs
    | len == 0  = 0
    | otherwise = runST getSim
      where
        !len = B.length bs
        getSim = do
            za <- newArray (0,len-1) 0 :: ST s (STUArray s Int Int)
            -- The common prefix of the string with itself is entire string.
            unsafeWrite za 0 len
            let -- Find the length of the common prefix.
                go !k j
                    | j < len && (bs ? j == bs ? k) = go (k+1) (j+1)
                    | otherwise = return k
                -- The window with indices in [left .. right] is the prefix-substring
                -- starting before i that extends farthest.
                loop !left !right i
                    | i >= len  = count 0 0 -- when done, sum
                    | i > right = do
                        -- We're outside the window, simply
                        -- find the length of the common prefix
                        -- and store it in the Z-array.
                        w <- go 0 i
                        unsafeWrite za i w
                        if w > 0
                          -- We got a non-empty common prefix and a new window.
                          then loop i (i+w-1) (i+1)
                          -- No new window, same procedure at next index.
                          else loop left right (i+1)
                    | otherwise = do
                        -- We're inside the window, so the substring starting at
                        -- (i - left) has a common prefix with the substring
                        -- starting at i of length at least (right - i + 1)
                        -- (since the [left .. right] window is a prefix of bs).
                        -- But we already know how long the common prefix
                        -- starting at (i - left) is.
                        z <- unsafeRead za (i-left)
                        let !s = right-i+1 -- length of known prefix starting at i
                        if z < s
                          -- If the common prefix of the substring starting at
                          -- (i - left) is shorter than the rest of the window,
                          -- the common prefix of the substring starting at i
                          -- is the same. Store it and move on with the same window.
                          then do
                              unsafeWrite za i z
                              loop left right (i+1)
                          else do
                              -- Otherwise, find out how far the common prefix
                              -- extends, starting at (right + 1) == s + i.
                              w <- go s (s+i)
                              unsafeWrite za i w
                              loop i (i+w-1) (i+1)
                count !acc i
                    | i == len  = return acc
                    | otherwise = do
                        n <- unsafeRead za i
                        count (acc+n) (i+1)
            loop 0 0 1 
```

# php - 使用 Setter 和 Getter 更改类的静态属性的值

> ID：12231498
> 
> 赞同：5
> 
> 时间：2012-09-01T21:19:06.490
> 
> 标签：php

我想扩展这个类（我下载的）以满足我自己的需要。当我运行调用这个类时，我收到一个错误，抱怨`=`构造函数中有意外。

```
define("HIT_OLD_AFTER_SECONDS", 4 * 7 * 24 * 3600);
class PHPCount extends DatabaseObject {

    protected static $table_name = "hits";
    protected static $db_fields = array('pageid','isunique', 'hitcount','english_id');
    public $pageid;
    public $isunique;
    public $hitcount;
    public $english_id;
    public static $article_id;

    function __construct(){
        return  PHPCount::article_id = PHPCount::get_article_id();
    }
    public static function set_article_id($articleid){
        PHPCount::article_id = $articleid;
    }
    public static function get_article_id(){
        return PHPCount::article_id;
    }
    public static function AddHit($pageID, $visitorID){

        HitTest::Cleanup();
        self::CreateCountsIfNotPresent($pageID);
        if(HitTest::UniqueHit($pageID, $visitorID)){
            self::CountHit($pageID, true);
            HitTest::LogHit($pageID, $visitorID);
        }
        self::CountHit($pageID, false);
    }

    /*
     * Returns (int) the amount of hits a page has
     * $pageID - the page identifier
     * $unique - true if you want unique hit count
     */
    public static function GetHits($pageID, $unique = false){
        global $database;
        self::CreateCountsIfNotPresent($pageID);
        $pageID = $database->escape_value($pageID);
        $unique = $unique ? '1' : '0';
        $q  = "SELECT hitcount FROM hits WHERE ";
        $q .= get_article_id()=$pageID;
        $q .=" AND isunique={$unique}";
        $getHitCount = static::find_by_sql($q);
        if(sizeof($getHitCount) >= 1){
            foreach($getHitCount as $hit){
                return (int)$hit->hitcount;
            }
        }else{
            die("Fatal: Missing hit count from database!");
        }
    }

    /*
     * Returns the total amount of hits to the entire website
     * When $unique is FALSE, it returns the sum of all non-unique hit counts
     * for every page. When $unique is TRUE, it returns the sum of all unique
     * hit counts for every page, so the value that's returned IS NOT the 
     * amount of site-wide unique hits, it is the sum of each page's unique
     * hit count.
     */
    public static function GetTotalHits($unique = false){
        //global $phpcount_con;
        $total = 0;
        $unique = $unique ? '1' : '0';
        $q = "SELECT hitcount FROM hits WHERE isunique={$unique}";
        $count = static::find_by_sql($q);
        foreach($count as $hit){
            $total += (int)$hit->hitcount;
        }
        return $total;
    }

    private static function CountHit($pageID, $unique){
        global $database;
        $unique = $unique ? '1' : '0';
        $safeID = $database->escape_value($pageID);
        $q ="UPDATE hits SET hitcount = hitcount + 1 WHERE ";
        $q .=get_article_id()=$safeID;
        $q .=" AND isunique={$unique}";
        mysqli_query($database->connection,$q);
    }

    private static function CreateCountsIfNotPresent($pageID){
        global $database;
        $pageID = $database->escape_value($pageID);
        $q = "SELECT pageid FROM hits WHERE ";
        $q .=get_article_id()=$pageID;
        $q .=" AND isunique='0'";
        $createCount = static::find_by_sql($q);
        if($q === false || sizeof($createCount) < 1){
            $sql ="INSERT INTO hits(";
            $sql .=get_article_id();
            $sql .=", isunique, hitcount) VALUES(";
            $sql .=$pageID;
            $sql .=", '0', '0')";
            mysqli_query($database->connection,$sql);
        }

        //check unique row
        $q ="SELECT "get_article_id();
        $q .=" FROM hits WHERE ";
        $q .=get_article_id()=$pageID;
        $q .=" AND isunique='1'";
        $createCount = static::find_by_sql($q);
        if($q === false || sizeof($createCount) < 1){
            $sql ="INSERT INTO hits (";
            $sql .=get_article_id();
            $sql .=", isunique, hitcount) VALUES('$pageID', '1', '0')"
            mysqli_query($database->connection,$sql);
            echo mysqli_error($database->connection);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T21:38:13.500

访问**静态类变量**需要一个**$ 符号**，如下所示：

```
PHPCount::$article_id 
```

因此，**至少这些方法**需要改变。

```
// I'd propose to pass the article ID as a parameter here
function __construct( $theArticleID ){
    PHPCount::$article_id = $theArticleID;         
}
public static function set_article_id($articleid){
   PHPCount::$article_id = $articleid;
}
public static function get_article_id(){
   return PHPCount::$article_id;
} 
```

# java - Do "if" statements affect in the time complexity analysis?

> ID：12231499
> 
> 赞同：7
> 
> 时间：2012-09-01T21:19:21.163
> 
> 标签：java, algorithm, complexity-theory

According to my analysis, the running time of this algorithm should be N², because each of the loops goes once through all the elements. I am not sure whether the presence of the `if` statement changes the time complexity?

```
for(int i=0; i<N; i++){
    for(int j=1; j<N; j++){

        System.out.println("Yayyyy");
        if(i<=j){
            System.out.println("Yayyy not");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-01T21:46:21.110

*   *Tp*：将常量文本打印到标准输出所需的时间。
*   *Ti*：内部循环内所有其他操作（谓词评估等）所花费的时间。
*   *To*：除执行内循环（初始化计数器等）外，外循环内所有操作所需的时间。
*   *Tc*：设置流程和其他所有簿记所需的时间

总运行时间将为*Tc + N x (To + NxTi + N/2xTp)*。

这等于*Tc + NxTo + (Nx(N/2)) x (2Ti + Tp)* ，当*N*趋于无穷大时， *K > Ti + Tp/2*的值以*K x (N^2)*为界。这个边界使得时间复杂度仍然是*O(N^2)*。

 ***不，*if*语句不会更改此示例中的时间复杂度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T22:25:20.977

不。考虑到时间复杂度渐近地描述时间——我们将较低的时间复杂度吸收到较高的时间复杂度中。

`O(n²)`意味着`k × n² + c`假设它`c`是如此之低以至于我们不关心它。

这些是恒定的影响，整个事物（c）的一定数量的开销以及无论我们的复杂性是什么的一定数量的成本。如果一个算法有一个 lower ，或者如果它们相等，一个 lower ，它`n²`就会击败另一个算法。此外，对于足够低的 n 值，O(n²) 与 O(1) 相同（我们通常不会在意，但每个可能会有很大不同，而且如果我们每做一次 m 次，那么 O( n²m) 优于 O(m)，如果 n 很低，那不是真正比较的)..`n²``k``c``k`

无论如何，这是故意的过度简化，因为`k`并且`c`可能不是真的恒定，就像恒定一样好。因此，如果某件事是真的`O(n² + log(n))`，我们会称它为，因为当我们需要担心的时候`O(n²)`，谁会在乎这点小事呢？`log(n)``n²`

所以。看着你的情况。我们做外循环，`n`次。对于其中的每一个，我们都会进行内部循环`n-1`时间。对于每个内部循环，我们进行第一次打印（成本的任何差异都与任何方式无关`n`，因此基本上是恒定的）和测试。测试成功的时间大约有一半，导致第二次打印的成本经常如此。

所以总成本为：

```
cost of setting up everything +
n × cost of looping + 
(n - 1) × cost of loop +
(n × (n - 1)) × cost of print +
(n × (n - 1)) × cost of test +
(n × (n - 1)) / 2 × cost of print. 
```

为上面的常量赋值，我们得到：

```
k +
n × a +
(n - 1) × b +
(n × (n - 1)) × c +
(n × (n - 1)) × d +
(n × (n - 1)) / 2 × e.

=

k +
n × a +
(n - 1) × b +
(n × (n - 1)) × (c + d + (e / 2)) 
```

现在，因为`c + d + e / 2`它本身是常数，所以可以变成：

```
n × a + (n - 1) × b + (n × (n - 1)) × c + k 
```

或重新排序，按最高顺序排列：

```
(n × (n - 1)) × c + (n - 1) × b + n × a + k 
```

如果 n 高到足以让我们该死，那么 n 在比例上如此接近 n - 1，以至于我们不妨认为它们是相同的（时间复杂度的另一个方面是渐近地描述事物，即当 n 接近 ∞ 时，因此n² 和 (n × (n - 1)) 之间的差异接近 0)。因此：

```
n² × c + n × b + n × a = n² × c + n × (b + a) + k 
```

同样， b + a 本身是常数，所以它等价于：

```
n² × k + n × c + a 
```

现在我们做了前面提到的吸收较低时间订单的事情，谁在乎`n × c`，没关系？如果 n 高到足以让我们完全关心，那么一切都是关于 的`n²`。相比之下，我们不妨将总体开销的差异视为噪声，并将其视为：

```
n² × k + c 
```

或者换句话说，如：

```
O(n²) 
```

所以是的，你一开始就很努力，if 语句不会影响复杂性。

考虑到这一点，我们可以注意到时间复杂度有可能隐藏我们真正关心的内容。例如，如果我们有一个 O(n²) 算法，如果这种分析发现时间成本`n² × k + n × c`为 k 为 200µs，c 为 15s，那么在 n 大于 750000 之前，它实际上是每 n 位的成本，而不是每 n² 位。在较低的 n 处，它更接近我们对 O(n) 的期望，而不是 O(n²)。

时间复杂度有用的原因是，如此大的差异是罕见的，我们关心时间，因此关心时间复杂度，当 n 变高时（你可以隐藏一些可怕的 O(n!) 怪物在您在蓝月亮中调用一次的代码中，包含三个元素，只是不在乎）。因此，为了实现现实世界的改进，我们理想地希望降低时间复杂度，或者如果未能降低最高级别的常数 k（或者换句话说，如果你可以开始做 n log n 次而不是 n² 次，那么就做，否则减少你正在做 n² 次而不是你正在做 n 次的其他事情的成本）。

换句话说，它帮助我们专注于通常重要的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T21:46:56.960

简短的回答：运行时间仍然是 O(N^2)。

长答案：条件检查的成本可以安全地“添加”到 println 操作的权重中，就像您有两个 println() 而不是执行一个 println() 一样。（关于这个例子，请记住，像 println 这样的 I/O 操作的成本大大超过了简单的整数比较。）

也许您可以说 println() 调用花费“1 次操作”，而比较是“0.0001 次操作”，因此总成本将是“（1.0001 * N）^2 次操作，而不仅仅是 N^2。你已经还将 println() 的数量减少了一半，所以我们可以说你在 (1.0001 * N) ^ 2 / 2 次操作。这仍然是 O(N^2)，即使对于给定的值N 您可能通过仅打印一半条目将运行时间减半。

一般来说，比较的成本应该添加到由比较产生的分支内的操作成本中。当 if() {} 和 else {} 都存在时，测量运行时可能会更加困难。这里的一个策略是估计运行时间，就好像*每次都*发生最昂贵的操作一样；或者，如果单个分支的运行时间不是很容易知道的，则估计*两个*操作都在每次循环迭代中发生。如果这些操作都是 O(1)，那么你的运行时间的顺序仍然是 O(N^2)，因为你是线性缩放的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T21:22:05.010

No, the if doesn't affect the complexity.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-01T21:22:13.730

The time complexity is the same, you will print Yayyyy N^2 times.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-01T21:22:04.727

of course, if you are working with comparison based algorithm, that s what u count right?

so in your case, you are looking at O(n²), because your if statement is being executed almost n² times.

For non comparison algorithms you count whatever is your main operation.***

# django - Remember form selection

> ID：12231502
> 
> 赞同：1
> 
> 时间：2012-09-01T21:19:37.410
> 
> 标签：django, drop-down-menu, django-templates

How to "remember" form selection value in Django?

```
{% load i18n %}
<form action="." method="GET" name="perpage" >
<select name="perpage">
    {% for choice in choices %}
    <option value="{{choice}}" {% if 'choice' == choice %} selected="selected" {% endif %}>
        {% if choice == 0 %}{% trans "All" %}{% else %}{{choice}}{% endif %}</option>
    {% endfor %}
</select>
<input type="submit" value="{% trans 'Select' %}" />
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:04:17.343

对不起我的话，但这似乎是一个不好的方法。django 的处理方式是一个简单的表单，为您选择的选项[设置一个初始值。](https://docs.djangoproject.com/en/dev/ref/forms/api/#dynamic-initial-values)如果您不相信我，并且您坚持这种方式，那么请更改您的[模板，如果](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#operator)：

```
{% if choice == myInitChoice %} 
```

不要忘记发送`myInitChoice`到上下文。

```
c = RequestContext(request, {
    'myInitChoice': request.session.get( 'yourInitValue', None ),
})
return HttpResponse(t.render(c)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T17:45:53.430

通常，当您遇到常见任务时，可能有一种简单的方法可以在 django 中完成。

```
from django import forms
from django.shortcuts import render, redirect

FIELD_CHOICES=((5,"Five"),(10,"Ten"),(20,"20"))

class MyForm(froms.Form):
    perpage = forms.ChoiceField(choices=FIELD_CHOICES)

def show_form(request):
     if request.method == 'POST':
         form = MyForm(request.POST)
         if form.is_valid():
             return redirect('/thank-you')
          else:
              return render(request,'form.html',{'form':form})
      else:
          form = MyForm()
           return render(request,'form.html',{'form':form}) 
```

在您的模板中：

```
{% if form.errors %}
    {{ form.errors }}
{% endif %}

<form method="POST" action=".">
  {% csrf_token %}
   {{ form }}
   <input type="submit" />
</form> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-04T16:50:18.057

```
@register.inclusion_tag('pagination/perpageselect.html', takes_context='True')
def perpageselect (context, *args):
  """
  Reads the arguments to the perpageselect tag and formats them correctly.
  """
  try:
      choices = [int(x) for x in args]
      perpage = int(context['request'].perpage)
      return {'choices': choices, 'perpage': perpage}
  except(TypeError, ValueError):
      raise template.TemplateSyntaxError(u'Got %s, but expected integer.' % args) 
```

我刚刚添加`takes_context='True'`并从上下文中获取值。我编辑为的模板

```
{% load i18n %}
 <form action="." method="GET" name="perpage" >
 <select name="perpage">
    {% for choice in choices %}
    <option value="{{choice}}" {% if perpage = choice %} selected="selected" {% endif%}>
        {% if choice == 0 %}{% trans "All" %}{% else %}{{choice}}{% endif %}</option>
    {% endfor %}
</select>
<input type="submit" value="{% trans 'Select' %}" />
</form> 
```

# scala - Alternative to List.sliding?

> ID：12231505
> 
> 赞同：1
> 
> 时间：2012-09-01T21:20:29.953
> 
> 标签：scala, functional-programming

I'm trying to get more familiar with functional programming and I was wondering if there is a more elegant way to group a list into pairs of 2 and apply a function to those pairs.

```
case class Line(start: Vector, end: Vector) {
  def isLeftOf(v: Vector) = (end - start).cross(v - start) < 0
}

case class Polygon(vertices: List[Vector]) {
  def edges = (vertices.sliding(2).toList :+ List(vertices.last,vertices.head)).map(l => Line(l(0), l(1)))
  def contains(v: Vector) = {
    edges.map(_.isLeftOf(v)).forall(_ == true)
  }
} 
```

I'm talking about this line

```
def edges = (vertices.sliding(2).toList :+ List(vertices.last,vertices.head)).map(l => Line(l(0), l(1))) 
```

Is there a better way to write this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T23:30:12.500

```
val edges = (vertices, vertices.tail :+ vertices.head).zipped map Line 
```

另请参阅以下问题：

[你如何将 Scala 列表变成对？](https://stackoverflow.com/questions/11248739/how-do-you-turn-a-scala-list-into-pairs/11249285#11249285)

[最简洁的序列元素组合方式](https://stackoverflow.com/questions/7068031/most-concise-way-to-combine-sequence-elements)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T21:33:50.953

那么你可以通过这样做来简化一点：

```
case class Polygon(vertices: List[Vector]) {
  def edges = Line(vertices.last, vertices.head) :: vertices.sliding(2).map(l => Line(l(0), l(1))).toList
  def contains(v: Vector) = edges.forall(_.isLeftOf(v))
} 
```

我做了三件事：

1.  拉出最后/标题线，使其不属于`map`
2.  移到`toList`之后`map`，以便您映射迭代器，从而避免构建两个列表。
3.  简化`contains`为简单地`forall`使用谓词调用。

# javascript - one click, two 'click' event fired

> ID：12231507
> 
> 赞同：0
> 
> 时间：2012-09-01T21:20:52.653
> 
> 标签：javascript, jquery, toggle

I just want to toggle some elements when a link is clicked:

This is how i am trying (But i don't really think that it matters much for this question what's inside the event function callback):

```
/* mostrar exceso de comentarios a peticion del usuario*/
$('.toggleComments').click(function(){
        console.log('.toggleComments');
        if($(this).parents('.helpContent').find('.commentHideble:visible').length > 0){
            $(this).text('+ <?=get_texto_clave('show_old_comments')?>').removeClass('toggleCommentsActive').append(' ('+$(this).parents('.helpContent').find('.commentHideble:not:visible').length+'+)');
        }else{
            $(this).text('- <?=get_texto_clave('hide_old_comments')?>').addClass('toggleCommentsActive');
        }
        $(this).parents('.helpContent').find('.commentHideble').slideToggle(100);

}); 
```

I even tried a boolean but gave me same result

```
/* mostrar exceso de comentarios a peticion del usuario*/

var ctoggle = false;
$('.toggleComments').click(function(){
    if(ctoggle == false){
        ctoggle = true;
        console.log('.toggleComments');
        if($(this).parents('.helpContent').find('.commentHideble:visible').length > 0){
            $(this).text('+ <?=get_texto_clave('show_old_comments')?>').removeClass('toggleCommentsActive').append(' ('+$(this).parents('.helpContent').find('.commentHideble:not:visible').length+'+)');
        }else{
            $(this).text('- <?=get_texto_clave('hide_old_comments')?>').addClass('toggleCommentsActive');
        }
        $(this).parents('.helpContent').find('.commentHideble').slideToggle(100);
        ctoggle = false;
    }
}); 
```

Why the log is being fired twice by click?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:35:22.753

看起来您在页面中有两次相同的 jQuery 块。两次绑定=两次火灾。

第 499 和 1481 行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T21:33:26.667

由于您使用的是类选择器，因此单击事件不太可能在多个元素上冒泡/传播，所有元素都与`toggleComments`类有关。`e.stopPropagation()`应该对你的情况有所帮助。

`preventDefault`停止单击本身，因此如果元素是超链接，最好不要使用该方法。如果它只是一个 div、span 或其他什么，你总是可以返回 false。在 jQuery 中，返回 false 会停止事件传播/冒泡*并*防止默认值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T21:26:32.127

一个 jsfiddle 页面可能会有所帮助，但同时你可以试试这个：

```
$('.toggleComments').click(function(e){

    e.stopPropagation(); 

    console.log('.toggleComments');
    if($(this).parents('.helpContent').find('.commentHideble:visible').length > 0){
        $(this).text('+ <?=get_texto_clave('show_old_comments')?>').removeClass('toggleCommentsActive').append(' ('+$(this).parents('.helpContent').find('.commentHideble:not:visible').length+'+)');
    }else{
        $(this).text('- <?=get_texto_clave('hide_old_comments')?>').addClass('toggleCommentsActive');
    }
    $(this).parents('.helpContent').find('.commentHideble').slideToggle(100);
} 
```

# php - xPath retrieve onclick value

> ID：12231513
> 
> 赞同：1
> 
> 时间：2012-09-01T21:22:31.023
> 
> 标签：php, xpath

I'm trying to retrieve the onclick value on a `td` element. This is what I have so far.

```
$xpath = new DOMXPath($dom);
$trs = $xpath->query("/html/body//table/tr");

foreach ($trs as $tr){
    $tds = $xpath->query("td", $tr);
    foreach ($tds as $td) {
        $a = $xpath->query("@onclick", $td);
        echo $a->nodeValue;
        echo $td->nodeValue;
    }
} 
```

This doesn't seem to be working though.

Here's the structure

```
<table>
   <tr>
       <td>Name</td>
       <td onclick="blahblah">Author</td>
       <td>Title</td>
   </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T21:43:49.517

$a 是一个 NodeList，你必须选择一个项目：

```
 @print($a->item(0)->nodeValue); 
```

# floating-point - How can an MCU without floating point find sqrt(2)?

> ID：12231515
> 
> 赞同：0
> 
> 时间：2012-09-01T21:22:41.827
> 
> 标签：floating-point, embedded

I got asked this question last interview and expect it again. The interview was for firmware engineer that program embedded systems. The microprocessors and micro controllers available for these applications are not very powerful usually and the simpler ones do not have capability to do floating point calculations (no multiplier or divider present inside).

So what are the possible answers to this question than and what (if anything) does fixed point arithmetic have to do with this?

Is it possible to use the Newton-Raphson method to do this calculation at all? How?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-02T10:12:52.467

与任何诸如此类的面试问题一样，明智的反应是提出反问。旨在澄清和消除问题的聪明问题表明您可以思考而不是简单地喷出所接受的智慧或教条，并且还会缩小问题的范围，使您的答案更可能适用。*在这种情况下，没有浮点的MCU*和*不使用浮点的软件实现*之间可能存在区别。如果是后者，那么定点肯定是相关的，但在许多应用中是[整数平方](http://en.wikipedia.org/wiki/Integer_square_root)root 可能就足够了 - 您可能会问这个问题，但在这种情况下， isqrt(2) == 1 似乎不太可能足够。对于前者，这种情况并不排除使用浮点数。

通常，嵌入式系统中使用浮点时的问题是缺少浮点单元 (FPU)，从而导致在软件中实现的浮点运算要慢得多且确定性较差。缺少 FPU 甚至硬件整数乘法或除法并不排除使用浮点，它只是意味着此类操作要慢得多并且需要更大的代码空间。

在大多数系统上，即使没有硬件浮点支持，标准库数学函数仍然会受到软件浮点的支持，并且可以正常使用——即使在 8 位系统上——但不要指望[Mega-FLOPS](http://en.wikipedia.org/wiki/FLOPS)性能。在某些情况下，性能下降以及库实现的不确定性可能会阻止其使用，在这种情况下，有许多算法可以返回更快或更确定性的性能。

如果要求根的值很大并且整数结果足够精确，那么纯整数解决方案将是最快的，但是对于一般情况，有许多解决方案，其中 Newton-Raphson 是其中之一，但不太可能是最优的 -它是*平方根算法的冒泡算法*；使用它是因为它易于教授和理解，而不是因为它的性能。

使用定点是可能的，但不是内在数据类型，代码可能变得不那么容易编写和调试。我使用[Anthony Williams 编写的库](http://www.drdobbs.com/cpp/optimizing-math-intensive-applications-w/207000448)；它是用 C++ 编写的并定义了一个`fixed`类；C++ 的函数和运算符重载能力意味着大多数浮点代码可以简单地通过替换`float`或`double`来移植`fixed`。在 ARM 处理器上，`fixed`该类的执行速度大约是软件浮点的五倍。然而，Anthony 的 sqrt 算法可以改进，正如我在[这里](https://stackoverflow.com/questions/8721022/how-to-improve-fixed-point-square-root-for-small-values)描述的那样，使用基于文章*[The Neglected Art of Fixed Point Arithmetic的实现](http://jet.ro/2006/08/07/neglected-art-of-fixed-point-arithmetic/)*- 那篇文章中的代码是用 C 语言编写的，因此可能更普遍适用（其中 C++ 不可用或不实用 - 尽管这是一个不同的论点！）。

[*Jack Crenshaw 在他的《用于实时编程的数学工具包》*](http://books.google.co.uk/books/about/Math_Toolkit_for_Real_Time_Programming.html?id=kqW8Lrp7NRYC)一书中用了一整章的篇幅介绍了 sqrt() 函数，他从一个朴素的 Newton-Raphson 实现开始并逐渐对其进行改进。他还提出了一个整数解，但有趣的是不是定点的。杰克在书中包含的一些内容已经出现在他的期刊文章中；例如他对[*整数平方根*](http://eetimes.com/discussion/other/4219659/Integer-Square-Roots)的处理。

无论哪种方式，我都可以这样回答这个问题：

> 我会评估标准库软件的浮点性能、精度和对代码大小的影响，只有当我发现它不足以满足应用程序要求时，我才会考虑使用已建立的算法和可能的定点算术的优化解决方案。

请注意我使用的术语*“既定算法”*；它有效地忽略了这样一个事实，即我可能不知道或不记得任何特定算法的名称，而我真正想说的是我不知道哪种算法是合适的，但我没有愚蠢到重新发明轮子，因为我不太可能想出比目前还没有的东西更好的东西，并且通过仔细的研究和评估，如果可行的话，我会达到预期的结果。如果一位受访者事先提出了这个答案并提出了一些聪明的问题，我会发现这完全可以接受。当然，面试官可能没有你那么聪明，而且心里可能有一个他认为“*正确”的答案*“一；你可能不想在一个有这种教条反应的组织中工作。面试是一个双向的过程——你正在面试这个组织，看看你是否想给你的服务带来好处。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-01T23:44:20.877

是的，您可以使用 Newton-Raphson 计算平方根。通常它是这样完成的：

设 x 为数字。我们将首先近似 1/sqrt(x)，然后将其乘以 x 以产生 x/sqrt(x)，即 sqrt(x)。

给定 x，创建 1/sqrt(x) 的粗略估计。通常，这是通过一个小的查找表来完成的，但任何合理的估计就足够了（包括 1）。调用初始估计 e [0]。

根据需要重复此步骤多次：根据当前估计值 e [i]，创建新估计值 e [i+1] = 1/2·e [i] ·(3−x·e [i] ² )。通常，所需的步数可以通过数值分析、1/sqrt(x) 的初始估计的质量以及应用程序所需的精度提前确定。

最后，返回最后一个 e [i] ·x 以估计 sqrt(x)。

该序列收敛速度非常快，通常用于计算平方根。您可以从[牛顿方法的维基百科页面](http://en.wikipedia.org/wiki/Newton%27s_method)开始，了解如何推导出平方根倒数的序列。另请注意，它不使用除法，这通常是一个缓慢的操作。

您将使用定点进行这些计算，因为您需要比整数提供的精度更高的精度，但浮点不可用。

本质上，面试官是想看看你是否有嵌入式处理器上的数值算法经验。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-01T21:44:05.873

ENIAC 仅使用加法和减法计算平方根。它基于公式，前n个奇数之和是n的平方。

要计算 m 的平方根，求前 n 个奇数之和超过 m 的最小整数 n。这可以通过从 m 中减去连续的奇数整数来完成，直到获得负结果。如果 n 是最小整数，`m - (1 + 3 + 5 + ... + 2n-1) < 0`则`(n - 1)^2 <= m < n^2`. 令 a 等于第 n 个奇数，求解`2n - 1`双不等式`(n-1) <= sqrt(m) < n`

```
a - 1 <= 2*sqrt(m) < a + 1 
```

或者

```
(a - 1)/2 <= sqrt(m) < (a + 1)/2 
```

资料来源： [http ://www4.wittenberg.edu/academics/mathcomp/bjsdir/ENIACSquareRoot.htm](http://www4.wittenberg.edu/academics/mathcomp/bjsdir/ENIACSquareRoot.htm)

但是，这实际上不适用于 m = 2，仅适用于大数。

# java - Adding a JLabel to a JPanel creates a NullPointerException

> ID：12231517
> 
> 赞同：1
> 
> 时间：2012-09-01T21:23:00.827
> 
> 标签：java, swing, nullpointerexception, jpanel, jlabel

Sorry to ask such a dumb question, but I can't figure out why this is crashing. I'm just trying to add a JLabel on top of my JPanel. The JLabel simply is there to display an image. I'm getting a NullPointerException.

(prediction: this is going to wind up being one of those "duh" moments.)

```
public JDlgTable() {
        ImageIcon myImg = new ImageIcon("image.png");
        JLabel myLabel = new JLabel(myImg);        
        myPanel.add(myLabel);   <-- error happens here
    } 
```

Thanks.

# javascript - 如何存储 DOM 节点？

> ID：12231518
> 
> 赞同：0
> 
> 时间：2012-09-01T21:23:00.847
> 
> 标签：javascript, html, dom, local-storage, store

例如，我想使用 JS/JQuery 存储一个`<table>`（我的 DOM 的节点 - 使用 HTML5 构建）。为什么？

我喜欢更新表，但将旧表与其中包含的值一起存储。我认为稍后用存储的表（节点）替换现有表（节点）会很快，而不是再次构建它并解析旧数据。

（解析数据>建表；更新表：解析新数据>存储旧表>用新表替换旧表；稍后：用旧表替换新表）

如果发现例如该问题：[Chrome sendrequest 错误：TypeError：将循环结构转换为 JSON](https://stackoverflow.com/questions/4816099/chrome-sendrequest-error-typeerror-converting-circular-structure-to-json) （我还尝试通过 JSON 转换我的表，将其保存在给定的 localStorage 中）

是否建议将这样的 DOM 节点存储在变量或本地存储中？

我很高兴有任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T21:34:06.253

您可以将 dom 存储在变量中。

```
var myTable = $('#content'); 
```

如果您想在客户端存储 dom 树，则本地存储 api 不适用于旧浏览器，您可以使用 cookie，但我不推荐它。

# php - group by and count is not counting correct in codeigniter

> ID：12231520
> 
> 赞同：0
> 
> 时间：2012-09-01T21:23:22.340
> 
> 标签：php, mysql, codeigniter

I am having problem to display correct numbers of count(field). I am trying to group by field and want to return order by group and count of them.

controller is

```
 $this->load->library('pagination');

    $query = "SELECT usercode,count(usercode) AS co FROM tabs
    GROUP BY usercode ORDER BY co desc";

    $config['total_rows'] = $this->db->query($query)->num_rows();
    $config['num_links'] = '25';
    $config['uri_segment'] = 3;
    $config['base_url'] = base_url() . "/user/topCreators/";
    $config['per_page'] = '25';
    $config['anchor_class'] = " class=\"number\" ";
    $config['cur_tag_open'] = "<a href=\"#\" class=\"number 
    current\" title=\"Current Page\">";
    $config['cur_tag_close'] = "</a>";

    $this->pagination->initialize($config);
    if ($this->uri->segment(3) == FALSE){
        $offset = 0;
    }
    else
    {
        $offset = $this->uri->segment(4);
    }

    $limit = $config['per_page'];
    $data["total_records"] = $config['total_rows'];
    $data["page_links"] = $config["per_page"];

    $data["query"] = $this->db->query($query . " LIMIT $limit OFFSET $offset");

    $this->load->view("top_creators", $data); 
```

my view file is

```
 <?php foreach($query->result() as $me) {?>
   <?= $me->co?>  

   <?php }?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:28:29.093

`co`每个结果的数字都是相同的，因为您正在计算表格选项卡中的所有用户代码，因此您的订购将不起作用。它也使执行变得多余，`$this->db->query($query)->num_rows();`因为它的值与`co`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T22:50:22.250

您应该更详细地解释在您的情况下什么不起作用。

* * *

在我看来，处理分页的最佳做法是使用[**SQL_CALC_FOUND_ROWS**](http://dev.mysql.com/doc/refman/5.0/en/information-functions.html#function_found-rows)。

基本上，这使您可以运行*一个*查询并通过

```
// Main query with SQL_CALC_FOUND_ROWS

$row = $this->db->query("SELECT FOUND_ROWS() AS found")->row();
$config['total_rows'] = $row->found; 
```

**SQL_CALC_FOUND_ROWS**计算所有行，但仅返回**LIMIT**内的行。这可以让您对系统进行更少的查询（更少的延迟），并且*总是*会给出正确的 total_rows，因为您从同一查询中获取值。

# asp.net - ASP.NET 在运行时创建资源

> ID：12231527
> 
> 赞同：3
> 
> 时间：2012-09-01T21:24:10.827
> 
> 标签：asp.net, resources, copy, multilingual

我正在开发一个 ASP.NET webapp，它具有多语言功能，允许网站管理员在运行时创建新语言。

我正在考虑的方法如下：

1.  用户选择一种可用的（未创建的）语言。
2.  当用户确认时，应用程序会自动复制一组现有资源，将文件名替换为新的文化。例如：default.aspx.en-us.resx 到 default.aspx.es-ar.resx。
3.  用户编辑最近创建的资源。

目前我在第 2 步遇到问题。我已经实现了复制资源，但是这些新资源被忽略了。我认为发生这种情况是因为新资源未包含在正在运行的程序集中，因此被忽略了。

当我在本地项目中测试以下代码时，我必须手动将新资源添加到解决方案中，然后重新编译以使其工作。

有谁知道如何使这项工作？

这是提到的副本的代码。

```
string _dir = path_ + "App_LocalResources\\\\";
DirectoryInfo _dirInfo = new DirectoryInfo(_dir);

foreach (FileInfo _file in _dirInfo.GetFiles("*en-us.resx")) {
_file.CopyTo(_dir + _file.Name.Replace("en-us", idioma_.Cultura));

}

string _dir2 = path_ + "App_GlobalResources\\\\";
_dirInfo = new DirectoryInfo(_dir2);

foreach (FileInfo _file in _dirInfo.GetFiles("*en-us.resx")) {
_file.CopyTo(_dir2 + _file.Name.Replace("en-us", idioma_.Cultura));
} 
```

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T12:44:44.630

创建或编辑资源文件的方式与读取数据不同。为了创建或编辑资源文件，您应该以与创建或编辑 XML 文件相同的方式进行操作，因为资源文件具有特定的结构化 XML 元素。

也许这篇[文章](http://www.codeproject.com/Articles/18368/Editing-a-Resource-File-Treating-It-as-an-XML-File)会帮助你...

# scala - Scala中不同的覆盖方法有什么区别？

> ID：12231534
> 
> 赞同：12
> 
> 时间：2012-09-01T21:25:06.050
> 
> 标签：scala, overriding

Scala 允许您以两种合法的方式覆盖方法：

给定超类：

```
class A {
  def a = "A"
} 
```

我们可以通过以下方式覆盖方法“a”：

```
class B extends A {
  override def a = "B"
} 
```

和

```
class B extends A {
  override def a() = "B"
} 
```

两者似乎都正确地覆盖了方法“a”。这背后的设计决策是什么？为什么允许 B 中的“a()”覆盖 A 中的“a”？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-01T23:34:06.170

情况并非总是如此（来自[语言规范](http://www.scala-lang.org/docu/files/ScalaReference.pdf)的更改日志）：

> Scala 2.0 版还放宽了关于空参数列表的覆盖规则。*匹配成员*的修订定义 （第 5.1.3 节）现在可以使用无参数方法覆盖具有显式但空参数列表`()`的方法，*反之亦然*。

你说得对，这似乎是一个奇怪的设计决定，因为无参数方法和具有空参数列表的方法之间存在明显的差异。例如，假设您有以下内容：

```
class A { def a = "A" }
class B extends A { override def a = "B" }
class C extends A { override def a() = "C" } 
```

现在我们可以按预期编写以下内容：

```
scala> (new B).a
res0: java.lang.String = B

scala> (new C).a
res1: java.lang.String = C 
```

还有这个：

```
scala> (new C).a()
res2: java.lang.String = C 
```

但不是这个：

```
scala> (new B).a()
<console>:10: error: not enough arguments for method apply: (index: Int)Char in class StringOps.
Unspecified value parameter index.
              (new B).a() 
```

所以Scala确实对两者进行了区分，这显然必须体现在字节码中。假设我们编译以下内容：

```
class A { def a = "A" }
class B extends A { override def a = "B" } 
```

然后运行：

```
javap -verbose B > noArgList.txt 
```

然后把代码改成这样：

```
class A { def a = "A" }
class B extends A { override def a() = "B" } 
```

重新编译，运行：

```
javap -verbose B > emptyArgList.txt 
```

最后检查差异：

```
<   MD5 checksum 88aeebf57b645fce2b2fcd2f81acdbbd
---
>   MD5 checksum 3733b3e4181b4b2f4993503d4c05770e
32c32
<   #18 = Utf8               }1A!
                                 \t\t!ICaT-9uszaE\r)\"a\tI!!\"1Q!Dg
jiz\"a\tAQ!BY\t!Y                                                  G.Y11bU2bY|%M[3di\")C%1A(
                 /A$H3)!dGYtwMCQM^1\nyI\"AB*ue&tw\r
---
>   #18 = Utf8               }1A!
                                 \t\t!ICaT-9uszaE\r)\"a\tI!!\"1Q!Dg
jiz\"a\tAQ!BY\t!                                                   G.Y11bU2bY|%M[3di\")C%1A(
                /A$H3)!dGYtwMCQM^1\nyI\"AB*ue&tw\r 
```

所以有一个区别——两个版本的`ScalaSignature`注释值不同。

至于*为什么*在 Scala 2.0 中进行更改：规范指出它允许这样做：

```
class C {
    override def toString: String = ...
} 
```

我的猜测是，语言设计者只是没有看到要求用户记住在这种情况下使用的覆盖方法的理由。

# c# - 如何判断相机按钮是否半按

> ID：12231536
> 
> 赞同：0
> 
> 时间：2012-09-01T21:25:12.643
> 
> 标签：c#, windows-phone-7

我正在创建一个小型测试相机应用程序，我希望能够实现一个功能，当硬件相机按钮被按下一半时，允许焦点文本栏出现在屏幕上。我创建了一个 camera_ButtonHalfPress 事件来执行焦点操作，但我不确定如何相应地切换我想在屏幕上显示的文本栏。本质上，我的目标是在半按相机按钮时显示文本栏，然后在完全按下按钮或在完全按下之前释放按钮时将其删除。被释放的按钮是我遇到问题的部分。我所拥有的如下：

MainPage.xaml.cs

```
 protected override void OnNavigatedTo(NavigationEventArgs e)
    {
        base.OnNavigatedTo(e);

         ...

         //Event is fired when the button is half pressed
         CameraButtons.ShutterKeyHalfPressed += camera_ButtonHalfPress;

         //Event is fired when the button is fully pressed
         CameraButtons.ShutterKeyPressed += camera_ButtonFullPress;                   

     }

    private void camera_ButtonHalfPress(object sender, EventArgs e)
    {
        //camera.Focus();

        // Show the focus brackets.
        focusBrackets.Visibility = Visibility.Visible;
        }
    }

    private void camera_ButtonFullPress(object sender, EventArgs e)
    {
        // Hide the focus brackets.
        focusBrackets.Visibility = Visibility.Collapsed;

        camera.CaptureImage();
        }
    } 
```

目前，如果用户决定在完全按下相机按钮之前释放它，则焦点括号会保留在屏幕上。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T21:35:04.077

只需订阅`CameraButtons.ShutterKeyHalfPressed`相机的事件，并将文本栏隐藏在里面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T02:04:10.887

如果在 OnNavigatedTo 事件中添加 CameraButtons.ShutterKeyReleased，那么问题就解决了！

```
protected override void OnNavigatedTo(NavigationEventArgs e)  
{  
    base.OnNavigatedTo(e);  

     ...  

     CameraButtons.ShutterKeyReleased -= camera_ButtonReleased;  //add corresponding event handler elsewhere

     ...                

 } 
```

# python - 龙卷风不接受 POST 方法

> ID：12231540
> 
> 赞同：2
> 
> 时间：2012-09-01T21:26:23.700
> 
> 标签：python, forms, mongodb, post, tornado

我得到 405: Method Not Allowed，所以问题出在哪里，这是一个 post 方法，因为我想将数据发送到服务器

```
class VendreHandler(BaseHandler): 
    @tornado.web.authenticated 
    def post(self): 
        self.db = conn["essog"] 
        user = self.get_secure_cookie("mechtari") 
        info = tornado.escape.json_decode(user) 
        email = info["email"] 
        namep = self.get_argument("namep") 
        prix = self.get_argument("prix") 
        description = self.get_argument("description") 
        date = datetime.datetime.now().date() 
        try: 
            photo = self.request.files['photo'][0]["body"] 
            try: 
                avctype = self.request.files['avatar'][0]["content_type"] 
                image = Image.open(StringIO.StringIO(buf=avat)) 
                type = image.format 
                (x, y) = image.size 
                if x < y: 
                   orientation = "portrait" 
                else: 
                   orientation = "paysage" 
                pref = str(time.time())
                nomfi = pref.replace(".", "") 
                nomfich = nomfi + "-" + self.request.files['avatar'][0]["filename"] 
                self.fs = GridFS(self.db) 
                avatar_id = self.fs.put(avat, content_type=avctype,filename=nomfich) 
            except IOError, TypeError: 
                self.redirect("/error-im") 
        except KeyError: 
            nomfich = "nofile" 
            orientation = "paysage" 
            avctype = "image/jpeg" 
            avatar_id = '503ae8553a5f3a0dd8b9cb4c' 
    self.db.users.update({"email":email}, {"$set":{"produit_up.namep":namep,"produit_up.prix":prix,"produit_up.photo":photo_id, "produit_up.description":description,"produit_up.date":date, "produit_up.vendu":False}}) 
    self.redirect("/success") 
```

和模板：

```
<form id="formvente" name="formvente"  method="post" action="/vendre" enctype="multipart/form-data"> 
{% raw xsrf_form_html() %} 
<label for="namep">Le nom du Produit</label> 
<input type="text" name="namep" required title="vous devez mettre le nom du produit" placeholder="exemple: peugeot 206"> 
<label for="prix">Son prix (en Dinars Alg&eacute;rien)</label> 
<input type="number" name="prix" required title="vous devez mettre le prix en chiffre (en Dinars Alg&eacute;rien)" placeholder="exemple: 800000"> 
<label for="photo">Une photo de votre produit</label> 
<input name="photo" type="file"> 
<label for="description">Veuillez donner une d&eacute;scription du produit (maximum 160 caract&egrave;res)</label> 
<textarea name="description" id="description" rows="3" cols="60" required title="vous devez mettre une petite description" placeholder="escence, 2006, roulant 100000km, toutes options, siege en cuir"                                 onKeyDown="textCounter(document.formvente.description,160)"                                        onKeyUp="textCounter(document.formvente.description, 160)"></textarea> 
<meter name="shower" min="1" max="160" value="1"id="shower" low="30" high="140">afficher son etat</meter> 
<input id="vendre" type="submit" value="Mettre en Vente"/> 
                            </form> 
```

我已经将处理程序简化为此

```
class VendreHandler(tornado.web.RequestHandler): 
    def post(self): 
        namep = 1 
        prix = 3 
        description = 43 
        date = 345 
        self.db = conn["essog"] 
        self.db.users.update({"email":email}, {"$set":{"produit_up.namep":namep,"produit_up.prix":prix, "produit_up.photo":photo_id, "produit_up.description":description,"produit_up.date":date, "produit_up.vendu":False}}) 
        self.redirect("/profil#vendu") 
```

总是它根本没有检查处理程序内容的方法错误（否则它会在找不到电子邮件时引发和错误）！

*   注意：是因为我使用了手风琴效果（CSS3）吗？该页面包含 3 个部分：个人资料、上传产品和搜索产品，当然每个部分都有自己的处理程序；所以profile会调用GET获取用户信息和头像，上传产品会做POST写产品信息到服务器，最后搜索会做GET到服务器搜索产品。所以，我犯错了吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T16:03:07.757

解决了！似乎问题来自图片处理程序；在 URLSpec 中，它必须是列表中的最后一个

```
url = [
...,
...,
...,
(r"/(?P<picture>.*)", handlers.PictureHandler)] 
```

这就是为什么在使用 GET 方法时返回有关图片的错误！希望这会有所帮助，谢谢你:)

# iphone - NSPredicate 用于一对多关系

> ID：12231546
> 
> 赞同：1
> 
> 时间：2012-09-01T21:27:01.503
> 
> 标签：iphone, ios, core-data, nspredicate

*   假设**Department**实体和**Employee**实体具有一对多关系
*   假设关系称为**部门**的员工 和**员工的部门**
***   假设 Employee 有一个属性**名****

 **我需要获取所有没有名为“Bob”的员工的部门

根据我读过的关于 SO 的其他答案，我试过这个：

```
name = @"Bob";
predicate = [NSPredicate predicateWithFormat:@"ALL employees.name != %@", name]; 
```

但它似乎不起作用。有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T05:29:29.670

这里不需要子查询：

```
name = @"Bob";
predicate = [NSPredicate predicateWithFormat:@"NOT ANY employees.name == %@", name]; 
```

出于某种原因，“ALL”聚合不适用于对多关系，但“ANY”聚合有效。**

# c++ - C++。当我运行它时程序selfkills

> ID：12231547
> 
> 赞同：1
> 
> 时间：2012-09-01T21:27:12.540
> 
> 标签：c++, runtime-error

> **可能重复：**
> [如何阻止 C++ 控制台应用程序立即退出？](https://stackoverflow.com/questions/2529617/how-to-stop-c-console-application-from-exiting-immediately)

我是 C++ 的新手。按照教程，我的程序在执行完简单的命令（如 cout ans 的东西）后会自我杀死。我发现了避免这种情况的 get.cin() 函数。但是，每当我使用“cin”命令插入变量时，程序在接收到输入并执行工作后就会自我终止。有没有办法避免这种情况？多谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:32:05.750

即使您正在使用程序，当您的程序接收到输入时它退出的原因`std::cin.get()`是因为每当`cin`读取输入时，都有可能留下一些垃圾；当你打电话时`std::cin.get()`，你会得到那个垃圾。

您需要做的是清除`cin`任何不需要的数据，例如`std::cin.get()`没有可读取的内容并且需要等待新的输入。

```
...
std::cin.clear();
std::cin.get();
return 0; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T21:33:07.650

程序不会“自杀”。它只是在完成它应该做的所有事情后*退出*`main`（即，当你从 回来时）。

您可以自行设置工作环境，以便查看程序的输出。例如，如果您在 Windows 中，您可以打开自己的命令行 (run `cmd`) 并从那里运行您的程序；或指示您的 IDE 在程序退出后不要关闭终端窗口。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T22:12:03.780

您的程序在执行后不会自杀，它只是结束它。

简单的例子：

```
#include <iostream>
int main( int argc, const char* argv[] )
{
    std::cout << "Hello, World" << std::endl;
    return 0; // End of execution
} 
```

在那个例子中，一个小窗口打开然后很快关闭，因为代码的逻辑是这样说的，但是在下一个例子中：

```
#include <iostream>
int main( int argc, const char* argv[])
{
     std::cout <<"Hello, World!" << std::endl;
     std::cin.get();
     return 0;
} 
```

您的应用程序仍将显示在屏幕上，直到您按下回车键，然后它才会退出。

如果您使用的是*Windows 操作系统*，请考虑下一个示例：

```
#include <iostream>
int main( int argc, const char* argv[])
{
     std::cout << "Hello, World!" << std::endl;
     system("PAUSE");
     return 0;
} 
```

请注意，`system("PAUSE")`它仅适用于 Windows，不会在其他操作系统上运行。

这里还有一件事值得一提，除了这些，还有***很多方法可以使用***，但我写的是最常用的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T21:54:15.740

在某些窗口系统中，当您的程序执行时会创建一个控制台窗口。当您的程序完成时，此控制台窗口会消失。

我总是向新手推荐“暂停”模式：

```
cout << "Paused. Press ENTER to continue.\n");
cin.ignore(10000, '\n'); // Ignore until 100000 characters are entered or a newline is entered. 
```

有时，我把它变成一个函数：

```
void Pause(void)
{
    cout << "Paused. Press ENTER to continue.\n");
    cin.ignore(10000, '\n'); // Ignore until 100000 characters are entered or a newline is entered.
} 
```

希望这可以帮助，

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-01T22:06:09.860

`std::cin.get()`运行良好，它的使用非常简单，但它希望用户按下回车键。我曾经使用 结束我的程序`ESC`，所以它对我不起作用，所以我使用它

```
#ifdef _WIN32
std::system( "pause" );
#else
std::system( "read -n1 -r -p \"Press any key to continue...\"" );
#endif 
```

它会打印“按任意键继续...”并按任意键继续执行，这样我就可以使用我可爱的`ESC`

# f# - 为什么 F# 中的 Option 类型上有 Value 属性？

> ID：12231548
> 
> 赞同：3
> 
> 时间：2012-09-01T21:27:39.817
> 
> 标签：f#

根据以下文档`Option.Value<'T>`：

> 获取 Some 选项的值。如果选项为 None，则会引发 NullReferenceException。

和

> 此函数供编译的 F# 代码使用，不应直接使用。

最后一句话是否暗示它是由于互操作？如果是这样，用例是什么？否则，这似乎很奇怪，因为该`Option`类型的全部目的是使未定义值的可能性显式并鼓励对它们的处理，这很容易被规避：

```
let none : int option = None
let value = none.Value 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T21:45:23.080

我想它在那里

```
match v with 
|Some(t) -> t 
```

工作 - 如果没有该`Value`属性，您将无法`t`使用 F# 代码可用的任何函数获得 如果您知道该选项是`Some`因为如果您`value`直接使用则不检查它，也可能会有一些非常小的速度优势

# c# - 在 Windows 8 中本地化不间断空间

> ID：12231552
> 
> 赞同：2
> 
> 时间：2012-09-01T21:28:16.727
> 
> 标签：c#, windows-8, windows-runtime, winrt-xaml

我正在尝试按照[MSDN 上的指南](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/Hh965329%28v=win.10%29.aspx)中的说明本地化 Windows 8 Metro 风格的应用程序。到目前为止，这工作得很好，但现在我正在尝试本地化包含出现在 XAML 文件中的不间断空格的字符串（最初为十六进制 xml 转义字符串： ）。只是将上面的字符串放入 Resources.resw 文件是行不通的，它显示为  。我必须做些什么才能在本地化中获得不间断的空间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T23:10:40.167

�a0 是一个 XML 字符文字，这意味着 <foo>�a0</foo> 的内部文本等于字符串“\x00a0”。

对您来说最好的办法可能是动态引用字符串并执行替换：

```
var loader = new Windows.ApplicationModel.Resources.ResourceLoader();
var str = loader.GetString('Farewell');
var modstring = str.Replace("&#00a0", "\x00a0");
myControl.Text = modstring; 
```

# haskell - Haskell：“通用”类型的表达

> ID：12231553
> 
> 赞同：0
> 
> 时间：2012-09-01T21:28:26.063
> 
> 标签：haskell, types, type-inference, variable-types

在与[此问题](https://stackoverflow.com/questions/12230820/haskell-example-of-function-of-type-a-a-same-as-the-identity)中显示的问题类似的问题中，是否有可能具有“通用”类型 a 的 Haskell 表达式？就像是，

`myExpression :: a`

我是 Haskell 的新手，但从我所看到的情况来看，这是无法实现的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-01T21:36:25.440

不，除了底部之外，没有什么可以满足的，例如

```
myExpression = myExpression

-- or,

myExpression = undefined 
```

* * *

有什么合理的方法*可以*实现吗？`Integer`一些既是 an又是类型的非底部表达式`Maybe (String -> IO ())`（例如）。

* * *

此外，鉴于[您提到的问题](https://stackoverflow.com/questions/12230820/haskell-example-of-function-of-type-a-a-same-as-the-identity)，其中一个答案证明了唯一具有类型签名的非底部函数`a -> a`是`id`，我们有一个证明不能有非底部表达式类型`a`。如果有，那么

```
f _ = myExpression 
```

可以有 type `a -> a`，这既不是`id`也不是底部，即矛盾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T05:38:35.737

您可以将该类型签名读作“对于所有类型**a**， myExpression 属于**a**类型”。这意味着 myExpression 必须是所有类型中都存在的某个值。

从数学上讲，不存在这样的值，因为**a**可能是“獾”或“不是獾的东西”，这两个集合必然是不同的。

在 Haskell 类型系统中，myExpression 的唯一有效值是**undefined**，也就是底部。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T07:21:07.267

虽然抽象地只有一个值的类型为“a”，但在运行时有多种可能的解释。

```
myExpression = myExpression 
```

这永远不会终止。

```
myExpression = undefined 
```

这将（使用 GHC 时）打印“ *** Exception: Prelude.undefined”

```
myExpression = error "Hello! 
```

这将打印“ *** Exception: Hello！”

```
myExpression = unsafePerformIO (launchNukes >> fail "BOOM") 
```

这个版本的底部的行为取决于你导入了哪些库。

由于您询问“通用”类型，因此您可能指的是可以有用地包含任何值的事物的类型。在这种情况下，请查看[Data.Dynamic](http://hackage.haskell.org/packages/archive/base/4.5.1.0/doc/html/Data-Dynamic.html)，它允许您将任何具有内存表示的内容转换为“动态”类型的值。稍后，当使用“动态”类型的值时，您可以尝试将其转换为更具体的类型，您可以实际使用它来做一些有用的事情。

# php - 是否可以从文章表单中提取信息链接，例如边缘

> ID：12231558
> 
> 赞同：0
> 
> 时间：2012-09-01T21:29:28.240
> 
> 标签：php, xml, rss, xml-parsing, simplepie

我正在尝试制作一些东西，您可以在文章中添加链接，然后将文章显示为标题，描述，...这可能吗，我认为有一种方法，因为有些网站可以做到。而且我认为它只与RSS阅读器可以阅读的网站兼容。有人可以帮助我或给我一些帮助，例如如何用简单的馅饼来做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T21:42:34.117

这就是 RSS 存在的原因 - 一种以标准化方式读取信息的方法。
在 html5 之前的时代，每个 Web 开发人员或多或少都在发明自己的格式，因为 xhtml、html4 没有合适的语义元素。

几个例子：

```
<div class="article">
   <h1>Article</h1>
   <p>Content Content Content Content Content</p>
</div>

<div class="article">
   <span class="arcticleHeader">Article</span>
   <div class="left">Content Content Content Content Content</div>
</div> 
```

与 html5 不同。还有更多的语义元素，如`<article>`, `<header>`, `<footer>`.

但是您仍然无法知道内容的实际结构。

您应该为此使用定义明确的格式，例如[RSS](http://feed2.w3.org/docs/rss2.html)、[ATOM](https://www.rfc-editor.org/rfc/rfc4287)、[RDF](http://de.wikipedia.org/wiki/Resource_Description_Framework)。
[维基百科很好地描述了这个问题](http://en.wikipedia.org/wiki/RSS)

> 标准化的 XML 文件格式允许信息发布一次并由许多不同的程序查看。

# c - 获取 INT_MIN 绝对值的正确方法

> ID：12231560
> 
> 赞同：18
> 
> 时间：2012-09-01T21:29:52.123
> 
> 标签：c

我想在无符号中执行一些算术运算，并且需要取负整数的绝对值，例如

```
do_some_arithmetic_in_unsigned_mode(int some_signed_value)
{
   unsigned int magnitude;
   int negative;
   if(some_signed_value<0) {
       magnitude = 0 - some_signed_value;
       negative = 1;
    } else {
       magnitude = some_signed_value;
       negative = 0;
    }
   ...snip...
} 
```

但是 INT_MIN 可能有问题，如果在有符号算术中执行，0 - INT_MIN 是 UB。在 C 中执行此操作的标准/稳健/安全/有效的方法是什么？

编辑：

如果我们知道我们在 2-complement 中，那么隐式转换和显式位操作可能是标准的吗？如果可能的话，我想避免这种假设。

```
do_some_arithmetic_in_unsigned_mode(int some_signed_value)
{
   unsigned int magnitude=some_signed_value;
   int negative=some_signed_value<0;
   if (negative) {
       magnitude = (~magnitude) + 1;
    }
   ...snip...
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-01T21:36:14.217

从有符号到无符号的转换是明确定义的：您得到相应的代表模 2 ^(*N*)。因此，以下将为您提供正确的绝对值`n`：

```
int n = /* ... */;

unsigned int abs_n = n < 0 ? UINT_MAX - ((unsigned int)(n)) + 1U
                           : (unsigned int)(n); 
```

*更新：*正如@a​​ka.nice 建议的那样，我们实际上可以替换`UINT_MAX + 1U`为`0U`：

```
unsigned int abs_n = n < 0 ? -((unsigned int)(n))
                           : +((unsigned int)(n)); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-01T21:49:45.833

在否定的情况下，取`some_signed_value+1`。否定它（这是安全的，因为它不可能`INT_MIN`）。转换为无符号。然后加一个；

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-01T21:36:29.137

你总是可以测试`>= -INT_MAX`，这总是很好定义的。对您来说唯一有趣的情况是 if`INT_MIN < -INT_MAX`和 that `some_signed_value == INT_MIN`。您必须单独测试该案例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-04-15T19:28:12.543

> 我想在 中执行一些算术运算`unsigned`，并且需要取负的绝对值`int`，...

处理迂腐案件：

1有一些特殊情况`|SOME_INT_MIN|`^：

**1\. 非二进制补码**

这些天很少看到一个人的补码和符号大小。

`SOME_INT_MIN == -SOME_INT_MAX`并且`some_abs(some_int)`定义明确。这是简单的情况。

```
#if INT_MIN == -INT_MAX
some_abs(x);  // use matching abs, labs, llabs, imaxabs
#endif 
```

**2\. `SOME_INT_MAX == SOME_UINT_MAX`, 2 的补码**

C 允许整数类型的有*符号*和*无符号版本的最大值相同。*这些天很少见到这种情况。

2 种方法：
1）使用更广泛的整数类型（如果存在）。

```
#if -INTMAX_MAX <= SOME_INT_MIN
imaxabs((intmax_t)x)
#endif 
```

2）使用宽（st）浮点（FP）类型。
转换为宽 FP 将适用于`SOME_INT_MIN`(2 的补码)，因为该值为 -(power-of-2)。对于其他较大的负数，转换可能会丢失宽整数而不是宽的精度`long double`。例如 64 位`long long`和 64 位`long double`。

```
fabsl(x);  // see restriction above. 
```

**3.`SOME_INT_MAX < SOME_UINT_MAX`**

这是[@Kerrek SB](https://stackoverflow.com/a/12231604/2410359)回答的常见情况。下面也处理案例 1。

```
x < 0 ? -((unsigned) x) : ((unsigned) x); 
```

* * *

**更高级别的替代方案**

在代码执行的情况下`.... + abs(x)`，一个明确定义的替代方法是减去负绝对值：`.... - nabs(x)`. 或如中`abs(x) < 100`，使用`nabs > -100`.

```
// This is always well defined.
int nabs(int x) {
  return (x < 0) x : -x;
} 
```

* * *

¹ `SOME_INT`表示`int`、或。`long`_`long long``intmax_t`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-05T18:50:50.617

```
 static unsigned absolute(int x)
 {
          if (INT_MIN == x) {
                  /* Avoid tricky arithmetic overflow possibilities */
                  return ((unsigned) -(INT_MIN + 1)) + 1U;
          } else if (x < 0) {
                  return -x;
          } else {
                  return x;
          }
 } 
```

# javascript - JavaScript addEventListener 添加对当前对象的引用

> ID：12231561
> 
> 赞同：0
> 
> 时间：2012-09-01T21:29:52.030
> 
> 标签：javascript, scope, dom-events

我已经简化了我的代码来说明问题。

```
function SnakeGame ()
{
    this.snakeDirection         = 'right';

    this.Init = function ()
    {
        window.addEventListener('keydown', this.keyboardInput, false);
    }

    this.keyboardInput = function (event, SnakeGameObject)
    {
        console.log(SnakeGameObject); //Error since I can't pass this variable...
        console.log(event.keyCode); //Works
    }
} 
```

在 this.keyboardInput 函数中，我尝试更改变量 this.snakeDirection; 问题是我无法获得对 SnakeGame 对象的引用。在keyboardInput 函数中，this 指的是window。我明白为什么它指的是窗口，但我想不出一个解决方案......

完整的代码可以在这里看到：http: [//eriknijland.nl/stackoverflow/snake_event_listener/](http://eriknijland.nl/stackoverflow/snake_event_listener/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:47:02.980

虽然 Mythril 的回答是正确的，但我建议您不要将方法用作事件回调。因为：a）它们是公开的，所以一旦你的代码变大就可以很容易地被否决，并且 b）它们可以公开访问：

```
var snakeInstance = new SnakeGame();
var otherObject = new SomethingElse();
snakeInstance.keyboardInput.apply(otherObject,[]);//invokes method, uses self, though self !== otherObject, but snakeInstance. 
```

所以我会使用一个闭包：

```
function SnakeGame()
{
    this.snakeDirection = 'right';
    var keyBoardInput = (function(that)
    {
        return function(e)
        {
            console.log(that);
            console.log(e.keyCode);
        }
    })(this);
    this.Init = function()
    {
        document.body.addEventListener('keydown',keyboardInput,false);
    }
} 
```

另请记住，您的代码与 X 浏览器不完全兼容（addEventListener && attachEvent？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T21:52:15.940

如果目标是 ES5（你应该是），你应该写：

```
window.addEventListener('keydown', this.keyboardInput.bind(this), false); 
```

这将确保回调始终`this`作为其上下文调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T21:33:07.507

试试这个：

```
function SnakeGame ()
{
    var self = this;
    this.snakeDirection         = 'right';

    this.Init = function ()
    {
        window.addEventListener('keydown', this.keyboardInput, false);
    }

    this.keyboardInput = function (event)
    {
        console.log(self); 
        console.log(event.keyCode); //Works
    }
} 
```

# .net - .NET 监控 NAS 上的文件操作

> ID：12231563
> 
> 赞同：0
> 
> 时间：2012-09-01T21:29:57.210
> 
> 标签：.net, windows-services, monitoring, filesystemwatcher, polling

我正在寻找一种良好且稳定的方法来监控 NAS（作为共享安装）上的文件更改（创建/删除/重命名等）。

我知道.NET 提供了一个*FileSystemWatcher* -Object，但我听说它在远程存储设备上不可靠。

我正在考虑轮询远程设备并检查这些文件是否已更改（与以前收集的文件属性不同）。

**编辑：具体要求：**

*   监控 NAS 上目录上的文件/文件夹更改（给定路径，可能还有某种过滤器）
*   记录更改：最好是在文件级别，说“文件-x 重命名/创建/删除”，但也可以在文件夹级别，说“文件夹-x 中的某些内容发生了变化”
*   能够运行外部可执行文件
*   在 WinServer 上作为 Windows 服务运行（不需要特定的 .NET 版本）

是否有任何通用技术或最佳实践来解决这个问题？

**编辑：如何唯一标识一个文件？**

无法通过名称识别文件（因为它可以更改）。

但是是否可以像 Onkelborg 建议的那样使用最后修改/创建的时间戳（毫秒，以 64 位整数表示）唯一地标识文件？或者你还有其他想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:43:04.123

您希望保持目录和文件的数量非常少 - 您需要遍历您感兴趣的每个目录，并获取每个文件的某种“标签”。您需要保留所有文件及其“标签”的列表，以便进行比较。“标签”可以是“最后修改日期”或文件长度，或两者兼而有之。（我推荐“最后修改日期”。我不推荐文件长度。）

我认为您应该更具体一些，您的要求是什么？有什么特别的吗？如果没有，我写的就是你需要的：递归构建树，等待，再次构建，比较，迭代。

# c# - C# 中是否有 List 的方法 就像在 C++ 中为矢量调整大小

> ID：12231569
> 
> 赞同：33
> 
> 时间：2012-09-01T21:30:39.413
> 
> 标签：c#, c++, list, vector

当我`resize(int newsize)`在 C++ 中使用 for`vector<T>`时，这意味着`size`this`vector`设置为`newsize`并且索引在 range 中运行`[0..newsize)`。如何在 C# for 中做同样的事情`List<T>`？
更改`List<T>`属性`Capacity`只会更改`Capacity`但保持`Count`不变，此外索引仍在范围内`[0..Count)`。请帮帮我。

PS想象一下我有`vector<T> tmp`一个`tmp.size() == 5`我无法引用的`tmp[9]`，但是当我使用时`tmp.resize(10)`我可能会引用`tmp[9]`。在 C# 中，如果我有`List<T> tmp`with`tmp.Count == 5`我不能引用`tmp[9]`( `IndexOutOfRangeException`)，但即使我设置了`tmp.Capacity=10`我也无法引用`tmp[9]`coz of`tmp.Count`仍然是 5。我想在 C# 中找到一些 resize 的类比。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-09-01T23:10:33.433

不，但您可以使用扩展方法添加您自己的。以下具有与 相同的行为`std::vector<T>::resize()`，包括相同的时间复杂度。唯一的区别是，在 C++ 中，我们可以定义一个默认值，`void resize ( size_type sz, T c = T() )`模板的工作方式意味着如果我们在`T`没有可访问的无参数构造函数的 a 的默认值的情况下调用它，那很好。在 C# 中我们不能这样做，因此我们必须创建一个没有与非默认使用情况匹配的约束的方法，以及另一个具有`where new()`调用它的约束的方法。

```
public static class ListExtra
{
    public static void Resize<T>(this List<T> list, int sz, T c)
    {
        int cur = list.Count;
        if(sz < cur)
            list.RemoveRange(sz, cur - sz);
        else if(sz > cur)
        {
            if(sz > list.Capacity)//this bit is purely an optimisation, to avoid multiple automatic capacity changes.
              list.Capacity = sz;
            list.AddRange(Enumerable.Repeat(c, sz - cur));
        }
    }
    public static void Resize<T>(this List<T> list, int sz) where T : new()
    {
        Resize(list, sz, new T());
    }
} 
```

现在，`myList.Resize(23)`或`myList.Resize(23, myDefaultValue)`将符合人们对 C++ 向量的期望。我会注意到，有时在 C++ 中你会有一个指针向量，在 C# 中你会有一个引用类型的列表。因此，在 C++`T()`生成空指针（因为它是指针）的情况下，我们期望它调用无参数构造函数。出于这个原因，您可能会发现它更接近您习惯用以下方法替换第二种方法的行为：

```
 public static void Resize<T>(this List<T> list, int sz)
  {
      Resize(list, sz, default(T));
  } 
```

这与值类型（调用无参数构造函数）具有相同的效果，但对于引用类型，它将填充空值。在这种情况下，我们可以将整个类重写为：

```
public static class ListExtra
{
    public static void Resize<T>(this List<T> list, int sz, T c = default(T))
    {
        int cur = list.Count;
        if(sz < cur)
            list.RemoveRange(sz, cur - sz);
        else if(sz > cur)
            list.AddRange(Enumerable.Repeat(c, sz - cur));
    }
} 
```

请注意，这与其说是关于 C++ 和 C# 中指针使用方式之间的差异`std::vector<T>`，不如说是关于指针使用方式的差异。`List<T>`

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-07-28T02:51:39.880

只是为了让[乔恩汉娜的答案](https://stackoverflow.com/a/12232162/968095)更具可读性：

```
public static class ListExtras
{
    //    list: List<T> to resize
    //    size: desired new size
    // element: default value to insert

    public static void Resize<T>(this List<T> list, int size, T element = default(T))
    {
        int count = list.Count;

        if (size < count)
        {
            list.RemoveRange(size, count - size);
        }
        else if (size > count)
        {
            if (size > list.Capacity)   // Optimization
                list.Capacity = size;

            list.AddRange(Enumerable.Repeat(element, size - count));
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T21:33:42.240

设置`List<T>.Capacity`就像使用`std::vector<T>.reserve(..)`. 也许`List<T>.AddRange(..)`适合您的需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T21:36:08.040

对不起。这是你需要的吗？ [List.TrimExcess()](http://msdn.microsoft.com/en-us/library/ms132207.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-28T06:40:10.173

这是我的解决方案。

```
private void listResize<T>(List<T> list, int size)
{
   if (size > list.Count)
      while (size - list.Count > 0)
         list.Add(default<T>);    
   else if (size < list.Count)
      while (list.Count - size > 0)
         list.RemoveAt(list.Count-1);
} 
```

当`size`和`list.Count`相同时，无需调整列表大小。

该`default(T)`参数用于代替`null`、`""`或`0`其他可为空的类型来填充列表中的空项，因为我们不知道类型`<T>`是什么（引用、值、结构等）。

> PS我使用`for`循环而不是`while`循环，我遇到了问题。列表的大小并不总是我要求的。它更小。有什么想法为什么？
> 
> 核实：
> 
> ```
> private void listResize<T>(List<T> list, int size)
> {
>    if (size > list.Count)
>       for (int i = 0; i <= size - list.Count; i++)
>          list.Add(default(T));
>    else if (size < list.Count)
>       for (int i = 0; i <= list.Count - size; i++)
>          list.RemoveAt(list.Count-1);
> } 
> ```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-09-01T21:37:59.943

你没有在 MSDN 上阅读过：-

> 列表是**可调整大小的项目集合**。列表可以通过多种方式构建，但最有用的类是 List。这允许您强烈键入您的列表，包括处理集合的所有基本功能，并且可以轻松搜索。

更远：-

> *容量* 是在需要调整大小之前 List 可以存储的元素数，而 Count 是实际在 List 中的元素数。
> 
> **容量始终大于或等于 Count。如果在添加元素时 Count 超过了容量，则通过在复制旧元素和添加新元素之前自动重新分配内部数组来增加容量**。

* * *

## 回答 #7

> 赞同：-7
> 
> 时间：2012-09-01T21:33:24.713

列表没有有限的大小。

尺寸对您很重要有什么原因吗？

也许数组或字典更接近您的要求

# javascript - HTML/CSS/JS - 自适应网格布局？

> ID：12231570
> 
> 赞同：0
> 
> 时间：2012-09-01T21:30:58.067
> 
> 标签：javascript, html, css

我有一些（未知高度）元素可以使用 进行水平调整`float: left;`，但如果其中一个元素更高，则在下一行的元素上方有一个空格。我想将该元素移动到其上方的空白处。这是问题的图片：![元素上方的空白空间，必须将其移到那里](../Images/de6fc1ece5be7d1123d3d96f7835cb38.png) 是否可以在没有 JavaScript 的情况下做到这一点？无论哪种方式，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:46:27.410

在没有 JS 的 CSS 中：

*   你可以让“Fotos”相对于“Contato”垂直对齐`display: inline-block`（空白有点烦人，如果需要，IE6/7 有一个等价物）

*   您可以使用*假列*`table`或 CSS 表格布局在每条“行”上拥有相等高度的块（与带有,`tr`和元素的无语义 HTML 表格布局无关`td`。这里是您选择的元素的*布局）*

*   如果您想堆叠尽可能多的块，那么您必须创建 2 列，将它们浮动并用您的块填充它们。这将改变它们在您的 HTML 代码中的顺序，因为它们将从上到下然后从左到右编写（“Fotos”将紧随 HTML 代码中的“Home”之后）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T21:52:17.763

只需使用javascript！jquery masonry 就是为此而生的！

[http://masonry.desandro.com/](http://masonry.desandro.com/)

# android - 如何在 Android 上创建下雨效果（粒子）？

> ID：12231571
> 
> 赞同：2
> 
> 时间：2012-09-01T21:31:06.797
> 
> 标签：android, algorithm, particle-system

我正在开发一个 2d android 策略游戏，它在 SurfaceView 上运行，所以我不能（或者我可以？）使用 LibGdx 的粒子系统。我想做一个下雨的效果，我的目标是这样的（[http://ridingwiththeriver.files.wordpress.com/2010/09/rain-fall-animation.gif](http://ridingwiththeriver.files.wordpress.com/2010/09/rain-fall-animation.gif)），我不需要飞溅最终效果（虽然那会很棒，但可能会占用大量系统资源）。我怎样才能达到那种下雨的效果？有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T23:32:48.260

![在此处输入图像描述](../Images/48741714db6acd35f8b3347493d3cd57.png)有一个类似的代码来自`JakeWharton`称为 DroidFlake。看起来像降雪效果，但值得检查[DroidFlake](https://github.com/JakeWharton/NineOldAndroids/tree/master/sample/src/com/jakewharton/nineoldandroids/sample/droidflakes)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T22:35:53.500

最简单的方法是将雨滴放入带有 alpha 的 PNG 并在最后显示。您只需要几帧即可使其平滑，但如果这是全屏图像，它会占用一些资源。

如果您负担不起，您可以将每个不同的雨滴放在一个较小的带有 alpha 的 PNG 文件中，然后多次显示这个（这些）单个 PNG。这将大大减少内存的使用，尽管您的渲染代码会变得更加复杂，并且取决于您有多少滴，它可能会影响性能。

两者之间的权衡是要有一个包含更多滴的PNG文件，但不是全屏，并显示几次。

您可以在雨滴溅起的另一帧（或多个帧）中显示，您可以在结束每个水滴的动画之前显示它，或者您可以让大 PNG 中的最后一帧包含飞溅。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T22:39:40.237

有很多方法可以做到这一点。您可以创建一个精灵表，如： ![](../Images/191a6ab86fb76f9a541fdb9c6f4e0530.png)

在该精灵表中，您可以简单地在每一帧中推进一滴水，直到它到达底部并创建飞溅效果。然后，您需要能够对其进行动画处理（非常简单）。然后，您可以创建图像的多个实例，或多次绘制一个图像以创建暴雨。

# macos - 在 Mountain Lion 中使用 IKImageView 和 NSScrollView 进行两指拖动

> ID：12231573
> 
> 赞同：0
> 
> 时间：2012-09-01T21:31:34.280
> 
> 标签：macos, cocoa, osx-mountain-lion, nsscrollview, ikimageview

我有一个 Mac 应用程序，它在应用程序商店中已经存在一年左右了。它首次与目标 SDK 10.7 Lion 一起发布。在更新到 Mountain Lion 后，它不再有效。

该应用程序在嵌入在 NSScrollView 中的 IKImageView 中显示大图像。将其放入滚动视图的目的是让两根手指拖动工作，而不是用户必须单击拖动。使用 Nicholas Riley 的 ScrollViewWorkaround，我能够在用户放大后使用两根手指滚动来显示剪辑的内容。就像您在 Preview 应用程序中看到的一样。

Nicholas Riley 的解决方案： [IKImageView 和滚动条](https://stackoverflow.com/questions/2060614/ikimageview-and-scroll-bars)

现在在山狮这行不通。放大、捏合或缩放按钮后，图像被锁定在图像的左下方。它不会滚动。

所以问题是，在 IKImageView 中显示大图像并用两根手指拖动缩放图像的合适方法是什么？

谢谢，
有状态的

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-25T00:31:02.087

好吧，Nicholas Riley 的解决方案是一个丑陋的 hack，因为它解决了错误的类；问题不**在于 NSClipView**（他对其进行了子类化，但按原样工作得很好），而**在于 IKImageView**。

**IKImageView**的问题实际上很简单（天知道为什么 Apple 还没有解决这个问题？...... 7 年......）：它的大小不适应它显示的图像的大小。**现在，当您在NSScrollView**中嵌入**IKImageView**时，滚动视图显然只能相对于嵌入的**IKImageView**的大小调整其滚动条，而不是它包含的图像。而且由于**IKImageView**的大小始终保持不变，滚动条不会按预期工作。

以下代码子类**化了 IKImageView**并修复了此行为。唉，它无法解决**IKImageView**在 Mountain Lion 中一旦缩放就容易崩溃的事实……</p>

```
///////////////////// HEADER FILE - FixedIKImageView.h

#import <Quartz/Quartz.h>

@interface FixedIKImageView : IKImageView
@end

///////////////////// IMPLEMENTATION FILE - FixedIKImageView.m

#import "FixedIKImageView.h"

@implementation FixedIKImageView

- (void)awakeFromNib
    {
        [self setTranslatesAutoresizingMaskIntoConstraints:NO]; // compatibility with Auto Layout; without this, there could be Auto Layout error messages when we are resized (delete this line if your app does not use Auto Layout)
    }

// FixedIKImageView must *only* be used embedded within an NSScrollView. This means that setFrame: should never be called explicitly from outside the scroll view. Instead, this method is overwritten here to provide the correct behavior within a scroll view. The new implementation ignores the frameRect parameter.
- (void)setFrame:(NSRect)frameRect
    {
        NSSize  imageSize = [self imageSize];
        CGFloat zoomFactor = [self zoomFactor];
        NSSize  clipViewSize = [[self superview] frame].size;

        // The content of our scroll view (which is ourselves) should stay at least as large as the scroll clip view, so we make ourselves as large as the clip view in case our (zoomed) image is smaller. However, if our image is larger than the clip view, we make ourselves as large as the image, to make the scrollbars appear and scale appropriately.
        CGFloat newWidth = (imageSize.width * zoomFactor < clipViewSize.width)?  clipViewSize.width : imageSize.width * zoomFactor;
        CGFloat newHeight = (imageSize.height * zoomFactor < clipViewSize.height)?  clipViewSize.height : imageSize.height * zoomFactor;

        [super setFrame:NSMakeRect(0, 0, newWidth - 2, newHeight - 2)]; // actually, the clip view is 1 pixel larger than the content view on each side, so we must take that into account
    }

//// We forward size affecting messages to our superclass, but add [self setFrame:NSZeroRect] to update the scroll bars. We also add [self setAutoresizes:NO]. Since IKImageView, instead of using [self setAutoresizes:NO], seems to set the autoresizes instance variable to NO directly, the scrollers would not be activated again without invoking [self setAutoresizes:NO] ourselves when these methods are invoked.

- (void)setZoomFactor:(CGFloat)zoomFactor
    {
        [super setZoomFactor:zoomFactor];
        [self setFrame:NSZeroRect];
        [self setAutoresizes:NO];
    }

- (void)zoomImageToRect:(NSRect)rect
    {
        [super zoomImageToRect:rect];
        [self setFrame:NSZeroRect];
        [self setAutoresizes:NO];
    }

- (void)zoomIn:(id)sender
    {
        [super zoomIn:self];
        [self setFrame:NSZeroRect];
        [self setAutoresizes:NO];
    }

- (void)zoomOut:(id)sender
    {
        [super zoomOut:self];
        [self setFrame:NSZeroRect];
        [self setAutoresizes:NO];
    }

- (void)zoomImageToActualSize:(id)sender
    {
        [super zoomImageToActualSize:sender];
        [self setFrame:NSZeroRect];
        [self setAutoresizes:NO];
    }

- (void)zoomImageToFit:(id)sender
    {
        [self setAutoresizes:YES];  // instead of invoking super's zoomImageToFit: method, which has problems of its own, we invoke setAutoresizes:YES, which does the same thing, but also makes sure the image stays zoomed to fit even if the scroll view is resized, which is the most intuitive behavior, anyway. Since there are no scroll bars in autoresize mode, we need not add [self setFrame:NSZeroRect].
    }

- (void)setAutoresizes:(BOOL)autoresizes    // As long as we autoresize, make sure that no scrollers flicker up occasionally during live update.
    {
        [self setHasHorizontalScroller:!autoresizes];
        [self setHasVerticalScroller:!autoresizes];
        [super setAutoresizes:autoresizes];
    }

@end 
```

# jquery - $.GET jQuery 将我发送到 root.com/4

> ID：12231576
> 
> 赞同：1
> 
> 时间：2012-09-01T21:31:51.110
> 
> 标签：jquery

当用户按下friendConfirm 按钮时，我正在尝试从我的jquery 应用程序运行更新脚本。发生的事情是，当我按下此按钮时，我的服务器被重定向到编号为 4 的域的根目录。（cca:8888/4）我不太清楚为什么会发生这种情况以及我做错了什么之后对 jquery 手册和在线教程的一些调查。

这是我的代码：

```
$(document).ready(function(){
$(".friendAdded").css('display', 'none');
var frid = $(".friendRequest").attr('id');
$(".friendConfirm#"+frid).click(function(){
    $.get("JSON/addFriend.php?fid="+frid,
        function(data){
        $(".friendAdded").append(data);
        $(".friendAdded").show() })
});

}); 
```

这是按钮的来源

```
 $requestInfo .= "<div class='friendRequest'id='{$rowID}'>";
        $requestInfo .= "<img src='{$row['fb_pic']}' alt='{$row['fn']}'/> ";
        $requestInfo .= $row['fn'];
        $requestInfo .= "<a id='{$rowID}'class='friendConfirm'href='{$row['fb_id']}' style='border:1px solid #dadada; 
        background:#fff; margin-left: 10px;
        line-height: 60px; padding: 4px 4px; color:gray; 
        text-decoration:none;'>Confirm</a></br></div>";
        $rowID += $rowID; 
```

HTML

```
 <div class="friendAdded"
style="position: fixed; top:25%; background-color: gray; left:30%; right:50%; width: 300px; text-align: center;">
You have added whatever as a friend.
</div>
<h3>Pending Friend Requests:</h3><div class='friendRequest' id='0'><img src='[url]' alt='Charles Williamson'/> Charles Williamson<a id='4' class='friendConfirm' href='#' 
        style='border:1px solid #dadada; background:#fff; margin-left: 
        10px; line-height: 60px; padding: 4px 4px; color:gray; text-decoration:none;'>
        Confirm</a></br></div><h3>Friends</h3>
<img src ='[url]' alt = 'Marc Foster' /></img>  Marc Foster</br><img src ='[url]' alt = 'James Bond' /></img>  James Bond</br><img src ='[url]' alt = 'Rachel Cole' /></img>  Rachel Cole</br></b|||o|dy> 
```

谢谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:39:35.560

试试这个

```
$(".friendConfirm#"+frid).click(function(e){
    e.preventDefault(); // prevents the default action
    // Rest of your code
}); 
```

你也有一些错误`$requestInfo string`，使它看起来如下

```
$requestInfo .= "<div class='friendRequest' id='".$rowID."'>";
$requestInfo .= "<img src='".$row['fb_pic']."' alt='".$row['fn']."'/> ";
$requestInfo .= $row['fn'];
$requestInfo .= "<a id='".$rowID."' class='friendConfirm' href='".$row['fb_id']."' style='border:1px solid #dadada; background:#fff; margin-left: 10px; line-height: 60px; padding: 4px 4px; color:gray; text-decoration:none;'>Confirm</a></br></div>";
$rowID += $rowID; 
```

# html - 调整图像显示的大小

> ID：12231578
> 
> 赞同：0
> 
> 时间：2012-09-01T21:31:58.933
> 
> 标签：html, css

我不将其显示为缩略图，但 CSS 可以帮助将 1000x1000 大小的图像压缩成 500x500 大小的图像吗？

我的图像 CSS 如下所示：

```
.images {
  background:url("image.png") no-repeat scroll; // this is a 1000x1000 sized image
} 
```

我该如何覆盖这个？我不想生成另一个大小为 500x500 的图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:37:52.080

```
background-size: 500px 500px; 
```

但是ie7和ie8不支持。

如果要将其显示在图像标签中，则可以将宽度和高度设置为图像标签。您可以通过绝对定位图像来伪造背景。

```
<img width="500" src="..." /> 
```

如果您已经在其他地方使用该图像，那么重用和调整它的大小可能是个好主意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T21:34:18.463

您可以使用 CSS3 [`background-size`](https://developer.mozilla.org/en-US/docs/CSS/background-size)：

```
.images{
    background:url("image.png") no-repeat scroll;
    background-size:500px 500px;
} 
```

但这将在下载**后**调整图像大小。**最好的方法是在用户下载图像之前**使用 PHP（或类似的）调整图像大小。

如果你不能在服务器端调整它的大小并且你希望它是跨浏览器的，你也可以使用

HTML：

```
<div class="images">
    <img class="bg" src="image.png" alt="My image" />
    Content
</div> 
```

CSS：

```
.images{
   position:relative;
}
.images>.bg{
   height:500px;
   width:500px;
   position:absolute;
   top:0;
   left:0;
   z-index:-1;
} 
```

（您可以同时设置两者`height`，`width`但只需要其中一个）。

# javascript - 如何打开一个新窗口或选项卡并输入 javascript 来执行？

> ID：12231579
> 
> 赞同：1
> 
> 时间：2012-09-01T21:32:01.823
> 
> 标签：javascript, browser, window.open

我做了一个游戏，我希望它给出所有存储在地图数组中的地图数据。我知道如何让 javascript 将对象或数组打印到正文，因此它是复制/可粘贴的 javascript。

当您按下按钮时，我想打开一个新窗口或选项卡以显示地图数据。

这是地图加载器的内容，然后将其打印到文档中。 [http://jsfiddle.net/Tgwizman/Cx2eF/](http://jsfiddle.net/Tgwizman/Cx2eF/)

我只是想让它在新窗口或标签中显示，而不必创建新页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T21:42:24.133

一种方法：（确保启用弹出窗口）

它会自动打开一个新窗口。我会让你弄清楚按钮按下的部分。

[http://jsfiddle.net/Cx2eF/3/](http://jsfiddle.net/Cx2eF/3/)

```
sampleWindow = window.open("", "myWindow", "location=no,menubar=yes,resizable=yes,scrollbars=yes,height=640,width=800");
sampleWindow.document.writeln(mapExport);
sampleWindow.document.close();
​ 
```

# internet-explorer - 程序下载 - IE CHROME - “不经常下载，可能很危险。”

> ID：12231581
> 
> 赞同：31
> 
> 时间：2012-09-01T21:32:09.670
> 
> 标签：internet-explorer, google-chrome, download, message, false-positive

我有一个 C# 程序的安装程序，我将它上传到我的网站，但每当我尝试在 chrome 或 IE 中下载它时，我都会收到“**我的文件 ***不常被下载并且可能很危险”。只有单击一个小箭头并从菜单中选择“保留”，才能保留它。只有十分之一的用户能够获得我的程序。我该如何解决这个问题？我听说过数字代码签名，但每年要花费数百美元。这对我来说真的不是一个选择。制作 MSI 安装程序或将其放在软件网站上会有帮助吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-02T01:19:38.360

最好的资源是[这篇博](http://blogs.msdn.com/b/ieinternals/archive/2011/03/22/authenticode-code-signing-for-developers-for-file-downloads-building-smartscreen-application-reputation.aspx)文和[这篇博](http://blogs.msdn.com/b/ie/archive/2011/03/22/smartscreen-174-application-reputation-building-reputation.aspx)文。

总结一下：

1.  使用验证码签名对您的包进行签名。
2.  不要成为恶意软件（我相信你已经知道了）。
3.  [标记](http://msdn.microsoft.com/en-us/windows/dd203105.aspx)您的软件（如果它不是浏览器插件）。

这可能是一个令人沮丧的过程，所以坚持下去。微软没有透露建立声誉需要多少下载量，但实际上，一旦您停止更改软件包（哈希是声誉的一部分），您就可以很快克服这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-02-08T15:07:02.043

我已通过将文件上传到 Google Drive 来解决此问题（您可以使用某些在线转换器将 Google Drive 共享链接转换为直接下载链接）。

现在我的可执行文件下载没有警告。愚蠢，但它有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-21T00:22:41.667

我今天（再次）遇到了问题

`file is not commonly downloaded (keep/discart)`

我进行了许多测试，包括将 zip 移动到另一台服务器上，使用其他软件重新压缩 zip 文件等。我得出的结论是**Google Chrome 不喜欢该 zip 文件中包含 .url 快捷方式文件**（指向我的网站的链接）。我从我的 zip 中删除了 .url，然后它可以正常工作而没有下载错误。

我不得不在两个站点上更改约 5000 个 zip 文件中的内容，一个不错的谷歌。

顺便说一句：该站点在任何地方都没有被列为恶意软件，并且 zip 中的文件在一个站点上主要是 .psd，在另一个站点上是 .swf，没有 exe 或任何东西。

以前当我遇到这个问题时，是因为下载文件时设置了一些错误的标题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-23T12:13:29.607

事实上，在我的情况下，帮助解决方案要简单得多。我刚刚将文件移动到[Amazon S3 存储](http://aws.amazon.com/s3/)上，警告立即消失了。

考虑在购买证书之前尝试一下。

**编辑：** **不再工作。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-16T18:17:32.733

类似于怀斯曼的建议。我在创建的新网站上下载时遇到了这个问题。我注意到从我已经存在多年的原始网站下载相同的文件下载时，Chrome 中没有显示警告。所以我只是将我在新网站上的下载链接到我放在旧网站服务器上的文件。即使使用较新的文件，它们也不再显示警告。我假设是因为我的旧网站已建立并被 google/chrome 视为“信任”。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-12-22T11:27:37.387

就我而言，我使用以下一组标题解决了它：

```
Cache-Control: max-age=864000
Content-type: application/octet-stream
Content-Disposition: attachment; filename="....zip"
Content-Transfer-Encoding: binary
Last-Modified: ...
Etag: ...
Content-Length: ... 
```

格外注意 Content-Type、Cache-Control、Last-Modified 和 Etag，它们似乎对我很有帮助。

# javascript - 在MVC中使用javascript调用控制器方法

> ID：12231583
> 
> 赞同：4
> 
> 时间：2012-09-01T21:32:35.427
> 
> 标签：javascript, jquery, ajax, asp.net-mvc

我试图让一个表格行作为我的 mvc 网站中另一个视图的链接。我不想使用自动生成的表格列表提供的标准“详细信息”链接，而是使用表格行作为“详细信息”视图的链接。所以我需要以某种方式使该行作为链接工作。每个 rom 都有一个唯一的 id，我需要将其传递给控制器​​方法。我尝试了不同的解决方案，但注意到当我按下表格行时会发生......

到目前为止，这就是我所拥有的：

```
<script type="text/javascript">
$(document).ready(function(){
    $('#customers tr').click(function () {
        var id = $(this).attr('id');
        $.ajax({
            url: "Customer/Details" + id,
            succes: function () { }
        });
    })
})
</script> 
```

我的控制器方法：

```
public ActionResult Details(int id)
{
    Customer model = new Customer();
    model = this.dbEntities.Customers.Where(c => c.Customer_ID == id).Single();
    return View(model);
} 
```

全球.asax：

```
public static void RegisterGlobalFilters(GlobalFilterCollection filters)
{
    filters.Add(new HandleErrorAttribute());
}

public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    routes.MapRoute(
        "Default", // Route name
        "{controller}/{action}/{id}", // URL with parameters
        new { controller = "Home", action = "Index", id = UrlParameter.Optional }     
    );

    routes.MapRoute(
        "CustomerDetails",
        "Customer/Details/{id}",
        new { controller = "Customer", action = "Details", id = "" }
    );
}

protected void Application_Start()
{
    AreaRegistration.RegisterAllAreas();

    // Use LocalDB for Entity Framework by default
    Database.DefaultConnectionFactory = new SqlConnectionFactory(@"Data Source=(localdb)\v11.0; Integrated Security=True; MultipleActiveResultSets=True");

    RegisterGlobalFilters(GlobalFilters.Filters);
    RegisterRoutes(RouteTable.Routes);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T22:28:33.990

这是我要做的：

```
<tr data-id='@SomeRazorDataId' class="MyAction">foo</tr> 
```

接着：

```
$(document).ready(function(){
    $('.MyAction').live("click",function () {
        var id = $(this).attr('data-id');
        window.location = "Customer/Details/" + id;
    })
}); 
```

如果你使用 jQuery 1.7+，你应该使用`on()`方法而不是`live()`方法。

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T21:35:21.253

您的代码中有*错字*；

```
success:
//----^ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-01T21:39:53.647

有几件事：

1.  在操作和参数之间添加一个**斜杠**( ): ，否则，您将调用一个被调用的，例如，它不存在；`/``url: "Customer/Details/" + id``Action``Details123`
2.  确保您在 Global.asax 中配置了**路由**以支持`id`，即`Customer/Details/{id}`：
3.  就像@undefined 所说，回调的名称是**`success`**，而不是`succes`。

你`Global.asax`应该有这些方面的东西：

```
routes.MapRoute(
  "CustomerDetails",
  "Customer/Details/{id}",
  new { controller = "Customer", action = "Details", id = ""}
); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-01T22:01:06.707

I had this type of situation lately and opted to use the Ajax helper class:

```
 @Ajax.ActionLink("Details", "Details", 
        new
        {
            id = Model.Id
        }, null) 
```

In this example it would assume that you want a link saying 'details' and you're already in the Customer controller.

Either way, look at the helper classes if all you want to do is fire a controller action from a link, gives you a bit more strong typing in terms of how to pass/handle the id value etc

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-20T08:06:40.510

您尝试调用的 url 无效：

“客户/详细信息”+ id，

相反，它应该是**"Customer/Details&id=" + id**

（或者）

使用“数据”

$.ajax({ url: "客户/详细信息", data:{id:id}, succes: function () { } });

# c++ - 带参数的 C++ 简单线程（无 .net）

> ID：12231595
> 
> 赞同：2
> 
> 时间：2012-09-01T21:34:36.027
> 
> 标签：c++, windows, linux, multithreading, winapi

我已经在互联网上搜索了一段时间，找到了不同的解决方案，但后来都没有真正起作用，或者对我的使用来说太复杂了。直到 2 年前我才使用 C++，所以它可能有点生疏：D

我目前正在编写一个将数据发布到 URL 的程序。它只发布数据，没有别的。为了发布我使用 curl 的数据，但它阻塞了主线程，当第一个帖子仍在运行时，将会有第二个帖子应该开始。最终，大约有 5-6 个后期操作同时运行。

现在我想将带有 curl 的帖子推送到另一个线程中。每个帖子一个线程。线程应该获取一个字符串参数，其中包含要推送的内容。

我目前坚持这一点。尝试了 Windows 的 WINAPI，但在读取参数时崩溃。（在我的示例中，第二个线程仍在运行，而主线程结束（等待系统（“暂停”））。

有一个多平台解决方案会很好，因为它可以在 windows 和 linux 下运行！

这是我当前的代码：

```
#define CURL_STATICLIB
#include <curl/curl.h>
#include <curl/easy.h>
#include <cstdlib>
#include <iostream>
#include <stdio.h>
#include <stdlib.h>
#include <string>
#if defined(WIN32)
    #include <windows.h>
#else
    //#include <pthread.h>
#endif

using namespace std;

void post(string post) { // Function to post it to url
    CURL *curl; // curl object
    CURLcode res; // CURLcode object
    curl = curl_easy_init(); // init curl
    if(curl) { // is curl init
        curl_easy_setopt(curl, CURLOPT_URL, "http://10.8.27.101/api.aspx"); // set url
        string data = "api=" + post; // concat post data strings
        curl_easy_setopt(curl, CURLOPT_POSTFIELDS, data.c_str()); // post data
        res = curl_easy_perform(curl); // execute
        curl_easy_cleanup(curl); // cleanup
    } else {
        cerr << "Failed to create curl handle!\n";
    }
}

#if defined(WIN32)
    DWORD WINAPI thread(LPVOID data) { // WINAPI Thread
        string pData = *((string*)data); // convert LPVOID to string [THIS FAILES]
        post(pData); // post it with curl
    }
#else
    // Linux version
#endif

void startThread(string data) { // FUnction to start the thread
    string pData = data; // some Test
    #if defined(WIN32)
        CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)thread, &pData, 0, NULL); // Start a Windows thread with winapi
    #else
        // Linux version
    #endif
}

int main(int argc, char *argv[]) {
    // The post data to send
    string postData = "test1234567890";
    startThread(postData); // Start the thread
    system("PAUSE"); // Dont close the console window
    return EXIT_SUCCESS;
} 
```

有人建议吗？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T21:38:49.433

考虑使用[Boost.Thread](http://www.boost.org/libs/thread)或新的[C++11 线程工具](http://en.cppreference.com/w/cpp/thread)（如`std::thread`等）。

对最初问题的代码的一些评论：

*   如果远离 std::thread 或 boost::thread，请使用[_beginthreadex(..)](http://msdn.microsoft.com/en-us/library/kdzttdcb.aspx)而不是[CreateThread(..)](http://msdn.microsoft.com/en-us/library/ms682453.aspx)，因为后者如果与 C 运行时的某些函数一起使用会导致资源泄漏。

*   使用[CreateThread(..)](http://msdn.microsoft.com/en-us/library/ms682453.aspx)时，`LPTHREAD_START_ROUTINE`如果传递函数的签名正确，则不需要强制转换。所以铸造它是完全错误的。

*   已经有一些关于堆栈分配变量的生命周期的评论，以及如果将这些变量的地址传递给线程函数会发生什么。

*   不要`system("PAUSE")`为了保持代码的可移植性而使用。而是使用以下代码段：

```
    无效 wait_for_key_press()
    {
        std::cin.clear();
        std::cin.ignore(std::cin.rdbuf()->in_avail());
        std::cin.get();
    }

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T21:44:57.010

`libcurl`您可能希望通过使用的[多](http://curl.haxx.se/libcurl/c/libcurl-multi.html)操作接口来避免多线程，这使您能够在同一个（单个）线程中运行多个并发 HTTP 请求。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T21:38:52.710

用于`std::thread`线程。这是一个相对较新的东西，是最新 C++11 标准的一部分，但在不久的将来它可能是最便携的线程处理方式。

看看让 5 个线程忙等待是多么容易（除非经过编译器优化）：

```
#include<thread>
#include<vector>

int main()
{
    std::vector<std::thread> threads;
    for (int i=0; i< 5; i++)
    {
         threads.push_back(std::thread([] () {
              for (long long j=0; j < 1000000000000LL; j++) ;
         }));
    }

    for (auto & thread : threads)
    {
         thread.join();
    }
} 
```

# javascript - HTML 5 Canvas - 获取路径的像素数据

> ID：12231597
> 
> 赞同：2
> 
> 时间：2012-09-01T21:35:05.090
> 
> 标签：javascript, html, canvas

我想知道是否有任何方法可以获取画布标签中当前绘制路径的像素数据。

在绘制正方形或线条等简单形状时，我可以自己计算像素数据，但是对于椭圆甚至简单的圆形等更复杂的形状，事情会变得一团糟。

我问这个的原因是因为我正在开发一个 Web 应用程序，当我向画布添加路径时，它涉及将画布像素数据发送到服务器。服务器需要保留它自己的整个画布副本，我真的不想每次更改都发送整个画布图像，但出于效率原因只发送增量......

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:49:55.487

第 1 步：将路径绘制到与原始大小相同的第二个画布上，我们称之为“路径画布”。

第 2 步：将路径画布的 globalCompositeOperation 设置为“destination-in”。

第 3 步：将原始画布绘制到路径画布上

第 4 步：遍历路径画布的所有像素，并将不透明的像素以您发送到服务器的任何格式存储。

# ios - 非线性路径上的 UIView 动画

> ID：12231600
> 
> 赞同：1
> 
> 时间：2012-09-01T21:35:25.263
> 
> 标签：ios, animation, uiimageview

> **可能重复：**
> [如何为视图或图像沿弯曲路径的移动设置动画？](https://stackoverflow.com/questions/1142727/how-can-i-animate-the-movement-of-a-view-or-image-along-a-curved-path)

我有一个 iOS 应用程序，我想为一片落叶（或几片）制作动画。我有我的叶子图像，`ImageView`我从文档中找到了一个简单的动画：

```
[UIView animateWithDuration:4.0f
                          delay:0
                          options:UIViewAnimationTransitionFlipFromLeft
                          animations:^(void)
                          {
                              leaf1ImageView.frame = CGRectMake(320, 480, leaf1ImageView.frame.size.width,leaf1ImageView.frame.size.height);
                          }
                          completion:NULL]; 
```

这将使叶子从其起始位置直线移动到右下角。我将如何对其进行动画处理以遵循抛物线或正弦曲线等路径或曲线，甚至可能旋转图像或视图？这会在动画块中完成吗？提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-01T22:01:43.110

You can do this with a [CAKeyframeAnimation](https://developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CAKeyframeAnimation_class/Introduction/Introduction.html) and a [CGPath](http://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CGPath/Reference/reference.html). The code looks something like this:

```
CAKeyframeAnimation *leafAnimation = [CAKeyframeAnimation animationWithKeyPath:@"position"];
leafAnimation.duration = 10.0;
leafAnimation.path = /* your CGPathRef */;
[leaf1ImageView.layer addAnimation:leafAnimation forKey:@"leafAnimation"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T22:07:04.367

您正在寻找的东西是沿着 Bezier CGPath 制作动画。有关更多详细信息，请参阅此问题：

[如何为视图或图像沿弯曲路径的移动设置动画？](https://stackoverflow.com/questions/1142727/how-can-i-animate-the-movement-of-a-view-or-image-along-a-curved-path)

不过，在代码中创建贝塞尔路径相当困难，为了更简单的方法来创建贝塞尔曲线以沿此处查看问题的答案进行动画处理：

[在 iOS 中用手指绘制贝塞尔曲线？](https://stackoverflow.com/questions/4672646/drawing-bezier-curves-with-my-finger-in-ios)

# python - urllib open - 如何控制重试次数

> ID：12231607
> 
> 赞同：2
> 
> 时间：2012-09-01T21:36:16.790
> 
> 标签：python, python-3.x, urllib

如何控制重试次数`opener.open`？

在下面的代码中，它将`GET`在引发异常或代码成功之前发送大约 6 个 HTTP 请求（我在 Wireshark 嗅探器中看到了它）。

```
password_mgr = urllib.request.HTTPPasswordMgrWithDefaultRealm()
password_mgr.add_password(None,url, username, password)
handler = urllib.request.HTTPBasicAuthHandler(password_mgr)
opener = urllib.request.build_opener(handler)

try: 
    resp = opener.open(url,None,1)

except urllib.error.URLError as e:
    print ("no success")
else:
    print ("success!") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T20:00:26.690

`urllib`用于`httplib`处理 HTTP 连接。如果您查看`httplib.py`源代码并分析`HTTPConnection`类，您将了解`connect`方法的工作原理。

```
def connect(self):
    """Connect to the host and port specified in __init__."""
    msg = "getaddrinfo returns an empty list"
    for res in socket.getaddrinfo(self.host, self.port, 0, socket.SOCK_STREAM):
        af, socktype, proto, canonname, sa = res
        try:
            self.sock = socket.socket(af, socktype, proto)
            if self.debuglevel > 0:
                print "connect: (%s, %s)" % (self.host, self.port)
            self.sock.connect(sa)
        except socket.error, msg:
            if self.debuglevel > 0:
                print 'connect fail:', (self.host, self.port)
            if self.sock:
                self.sock.close()
            self.sock = None
            continue
        break

    if not self.sock:
        raise socket.error, msg 
```

实际上，尝试次数取决于[socket.getaddrinfo](http://docs.python.org/library/socket.html#socket.getaddrinfo)返回的列表的长度。该代码遍历所有可用的套接字选项来设置连接。

我怀疑减少尝试次数是否有意义。但是你可以像下面这样增加这个数字：

```
maxtries = 3
delay = 3
n = 0
while n < maxtries:
    try: 
        resp = opener.open(url,None,1)
    except e:
        print ("no success")
        n += 1
        sleep(delay)
    else:
        print ("success!")
        break 
```

# ruby-on-rails - 在 ruby 中路由页面时遇到问题

> ID：12231610
> 
> 赞同：0
> 
> 时间：2012-09-01T21:36:39.143
> 
> 标签：ruby-on-rails

我目前有一个用户模型和控制器，每当创建用户时，它都会在 example.com/users/userid 上创建个人资料 url。我还有一个用户/新页面和一个用户/索引页面。问题是当我尝试创建用户/选定用户页面时，rails 认为它​​是用户 ID 并给了我这个错误。“找不到 id=selectedusers 的用户。” 我以前可以通过直接调用控制器中的页面（例如索引或新页面）来解决此问题，但我不确定如何处理在控制器中没有功能的页面。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:45:24.203

这是关于路线的顺序。如果你把定义`selected`路由的代码放在前面`resources :users`，那么一切都应该没问题。

`users/selected`路线指向哪里？因为你可以这样定义你的路线：

```
resources :users do
    collection do
        get :selected
    end
end 
```

`selected`并在您的控制器中有一个方法。

# vim - 修复 Vim 中过长的注释行

> ID：12231613
> 
> 赞同：5
> 
> 时间：2012-09-01T21:37:08.230
> 
> 标签：vim

我正在寻找一种方便的方法来修复行长超过 Vim 中特定字符数的注释。我可以使用代码手动执行此操作，特别是因为它不那么频繁，加上重构长行通常是语言，甚至是代码样式依赖，但使用注释这纯粹是苦差事。

发生的情况是，我经常在评论中发现一些问题，调整一两个词，然后该行超出了 80 个字符的限制。我将最后一个单词移到下一行，然后下一行溢出，依此类推。有谁知道在 Vim 中自动执行此操作的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T23:30:44.347

如果这是一个常规问题，我建议将以下内容放入您的 vimrc：

```
nnoremap <leader>f gqip 
```

这将前导 f 快捷方式（f 表示“格式”）映射为使用 gq 格式化注释（在设置一些格式选项标志后考虑一个段落），将注释格式化为当前设置`textwidth`或`tw`选项的宽度。你应该在你的 .vimrc 中设置 textwidth `textwidth=80`。

Formatoptions 是您应该摆弄的另一件事，特别是在您的情况下，通过添加`acq`带有`formatoptions+=acq`. 小心删除`t`标志，`formatoptions-=t`因为它会自动包装你的所有代码，而不仅仅是识别的注释。完成所有这些操作后，您应该能够只在注释内点击 f 和格式，无论是否被空行包围。

这是有关格式选项的相关信息，因此您可以做出自己的选择。

```
t       Auto-wrap text using textwidth

c       Auto-wrap comments using textwidth, inserting the current comment
    leader automatically.

r       Automatically insert the current comment leader after hitting
    <Enter> in Insert mode.

o       Automatically insert the current comment leader after hitting 'o' or
    'O' in Normal mode.

q       Allow formatting of comments with "gq".
    Note that formatting will not change blank lines or lines containing
    only the comment leader.  A new paragraph starts after such a line,
    or when the comment leader changes.

w       Trailing white space indicates a paragraph continues in the next line.
    A line that ends in a non-white character ends a paragraph.

a       Automatic formatting of paragraphs.  Every time text is inserted or
    deleted the paragraph will be reformatted.  See |auto-format|.
    When the 'c' flag is present this only happens for recognized
    comments. 
```

# sql - 在 .csv 文件中显示数据集中的所有记录

> ID：12231616
> 
> 赞同：0
> 
> 时间：2012-09-01T21:37:33.107
> 
> 标签：sql, vb.net, datatable, dataset

我有一个运行查询的 VB.net 程序。该查询有时会提取数十万条记录。到目前为止，我已经向 reportviewer 报告了查询报告，然后我在表单上有第二个按钮，用于将数据集导出到 .csv 文件。这一切都像宣传的那样工作，但它并未显示所有记录。如果我运行查询而不将信息存储在数据集中，我会得到超过 1,000 个结果。

当我运行程序时，我只得到 568 个结果。我的假设是使用程序中的“填充”命令此信息太大。如何更改它以显示数据集中的所有记录，无论是在报告查看器中，还是在选择“导出”按钮时。

这是我的查询：

```
SELECT        Invoice_Tb.Customer_First_Name AS firstname, Invoice_Tb.Customer_Last_Name AS lastname, Invoice_Tb.Customer_Address AS add1, Invoice_Tb.City, 
                         Invoice_Tb.Customer_State AS State, LEFT(Invoice_Tb.ZIP_Code, 5) AS ZIP, Invoice_Tb.Customer_Email_Address AS [Email Address], 
                         Invoice_Tb.Vehicle_Mileage AS [Vehicle Mileage], Invoice_Tb.Invoice_Date AS [Date Of Service], Invoice_Tb.Store_Number, @startdate AS Start_Date, 
                         @enddate AS End_Date
FROM            Invoice_Detail_Tb INNER JOIN
                         Invoice_Tb ON Invoice_Detail_Tb.Invoice_Number = Invoice_Tb.Invoice_Number AND Invoice_Detail_Tb.Invoice_Date = Invoice_Tb.Invoice_Date
WHERE        (Invoice_Detail_Tb.Store_Category_Code = 'FS') AND (Invoice_Tb.Invoice_Date BETWEEN CONVERT(DATETIME, @startdate, 102) AND CONVERT(Datetime, 
                         @enddate, 102)) AND (Invoice_Tb.Reminder_Mail_Flag = 'Y') 
```

这是我将结果拉到报表查看器的按钮代码：

```
Me.Invoice_TbTableAdapter.Fill(Me.DataDeliveryServiceDataSet.Invoice_Tb, startdatepicker.Value, enddatepicker.Value)

        Me.ReportViewer1.RefreshReport() 
```

这是我的“导出”到 csv 按钮代码：

```
Dim str As New StringBuilder

        For Each dr As DataRow In Me.DataDeliveryServiceDataSet.Invoice_Tb

            For Each field As Object In dr.ItemArray

                str.Append(field.ToString & ",")

            Next

            str.Replace(",", vbNewLine, str.Length - 1, 1)

        Next

        Try

            My.Computer.FileSystem.WriteAllText("C:\temp\testcsv.csv", str.ToString, False)

        Catch ex As Exception

            MessageBox.Show("Write Error")

        End Try 
```

知道如何让所有记录显示吗？

# optimization - OpenCL汇编优化“添加后测试进位标志”

> ID：12231622
> 
> 赞同：0
> 
> 时间：2012-09-01T21:38:28.920
> 
> 标签：optimization, assembly, opencl, carryflag

在我的`OpenCL`内核中，我发现：

```
error += y;
++y;
error += y;
// The following test may be implemented in assembly language in
// most machines by testing the carry flag after adding 'y' to
// the value of 'error' in the previous step, since 'error'
// nominally has a negative value.
if (error >= 0)
{
    error -= x;
    --x;
    error -= x;
} 
```

显然，可以使用一些漂亮的汇编指令轻松优化这些操作。如何优化此代码`OpenCL`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T01:11:47.867

你没有。OpenCL 编译器根据目标硬件和优化设置决定如何处理代码，在构建内核时可以将其设置为编译指示或参数。如果它足够聪明，它会为要运行内核的平台使用漂亮的汇编指令。如果没有，好吧，它不会。

您必须记住，OpenCL 是适用于许多设备的通用框架，而不仅仅是您的标准消费级处理器，因此由于汇编指令的差异（即 OpenCL 旨在便携，如果您开始在内核中编写 x86 操作码，例如，它将如何在显卡上运行？）

如果您需要在特定设备上获得绝对的最大性能，那么您不应该使用 OpenCL，恕我直言。

# linux - Linux TCP 堆栈中的初始序列号生成

> ID：12231623
> 
> 赞同：5
> 
> 时间：2012-09-01T21:38:43.763
> 
> 标签：linux, tcp, linux-kernel

在 LINUX tcp/ip 协议中生成初始序列号 (ISN) 的过程是什么。[我知道在将隐蔽通道嵌入 TCP/IP](http://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CC0QFjAA&url=http%3A%2F%2Fteam.gray-world.net%2Fpapers%2Fih05coverttcp.pdf&ei=WnxCUPzSNYbP0QWy9YDQDw&usg=AFQjCNFL-Vgx4GP10anGYGsrJDo9vwssRg&sig2=wJd0SxLHGm2ORptWusTs0A)第 7 页和第 8 页中描述的 LINUX 内核 2.4 到 2.6 中生成 ISN 的过程 。我在后来的内核中搜索过类似的程序，但令我沮丧的是，我找不到任何程序。我了解由于与安全相关的明显原因，可能无法提供很多详细信息。当我正在验证在以后的 Linux 内核中实现类似的隐写术方案（如链接中所述）的可能性时，我非常需要一些信息。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T23:03:08.227

在此处阅读我的答案： [在 TCP 标头中操作 ISN 编号的最有效方法](https://stackoverflow.com/questions/12223002/most-efficient-way-to-manipulate-isn-numbers-in-tcp-headers/12223914#12223914)

该算法用于最新的内核 TCP Stack ( `3.5`)。

**编辑**：请参阅下图以查看所有相关的内核版本![在此处输入图像描述](../Images/f1922e39f830108d0b10e4a5b101e3f4.png)

**EDIT2**：查看内核源代码以获取旧版本的函数`secure_tcp_sequence_number`：

[内核 2.4.22](http://fxr.watson.org/fxr/source/drivers/char/random.c?v=linux-2.4.22#L2139)

[内核 2.6.30](http://lxr.free-electrons.com/source/drivers/char/random.c?v=2.6.30#L1562)

[内核 2.6.39](http://lxr.free-electrons.com/source/drivers/char/random.c?v=2.6.39#L1528)

[内核 3.0](http://lxr.free-electrons.com/source/drivers/char/random.c?v=3.0#L1528)

[Kernel 3.1](http://lxr.free-electrons.com/source/net/core/secure_seq.c?v=3.1#L104) : (MD5 已取代 half-MD4)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T21:58:32.563

在更仔细地阅读了[RFC6528](http://www.rfc-editor.org/rfc/rfc6528.txt)和[RFC1948](http://www.rfc-editor.org/rfc/rfc1948.txt)之后，我得出一个结论，即 RFC1948 中指定的生成初始序列号（ISN）的算法：

```
 ISN = M + F(LocalIP, LocalPort, RemoteIP, RemotePort, Secretkey) 
```

没有改变。取而代之的是，Bellovin SM 在 RFC1948 中提出的算法被正式指定并纳入了由 Bellovin SM 和 Gont 共同编写的 RFC6528 中的 Standards Track（根据[RFC2119 ）。](http://www.rfc-editor.org/rfc/rfc2119.txt)F.. 由于现在已经过时的 RFC1948 不能在任何文档中使用，RFC6528 已经取代了它。

但正如我最初问题的答案中所指出的那样，MD5 已将 half-MD4 替换为内核 3.1 中的哈希函数。RFC6528 完全证明了这一点，因为它确实提供了更改作为伪随机函数的 F() 的灵活性。（请查看链接以获取更多详细信息）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-05-21T12:31:45.130

更新到以前的答案以表示当前状态（2019 年和 Linux 内核 5.1.3），因为`ISN`在内核中生成 s 的算法再次更改为更安全。

[secure_tcp_seq](https://elixir.bootlin.com/linux/v5.1.3/source/net/core/secure_seq.c#L132)现在使用`SipHash`(add–rotate–xor) 函数根据初始密钥、源和目标 IP 地址和端口生成 ISN。我想这种变化与哈希冲突漏洞导致[哈希泛洪](https://www.securityweek.com/hash-table-collision-attacks-could-trigger-ddos-massive-scale)攻击有关。

# php - ImageMagick - 文本变成矩形

> ID：12231624
> 
> 赞同：5
> 
> 时间：2012-09-01T21:38:45.217
> 
> 标签：php, image-processing, imagemagick

我对 ImageMagick 很陌生 - 我已经阅读了一些文档，现在我来到了第一个真实世界的情况。我有图像（300 * 500），并且我有一些文本需要尽可能地（最大可能）适合最顶部图像的 20%。所以文本必须在 300*100 矩形中，图像的其余部分保持不变。这甚至可以通过图像魔术实现吗？什么是最好的方法来做到这一点

我正在寻找命令行或 php 扩展解决方案。下面的简单图解

![简单的插图](../Images/332b10d9646bc74a8ebe74c0c563da85.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-01T23:38:41.470

由于您没有提供用于测试和应用一些文本的示例图像，因此我使用以下命令创建了一个：

```
convert                               \
   http://i.stack.imgur.com/RfJG6.png \
  -crop 312x513+579+0 +repage         \
   so#12231624-right.png 
```

使用生成的图像作为输入，运行这三个命令来查看它是如何工作的（在 Linux 或 Mac OS X 上）：

```
width=$(identify -format %W so#12231624-right.png)

convert                  \
  -background '#0008'    \
  -gravity center        \
  -fill white            \
  -size ${width}x100     \
   caption:"This is a sample text to test \
the automatic sizing of fonts by ImageMagick." \
   so#12231624-right.png \
 +swap                   \
 -gravity north          \
 -composite              \
  output1.png

convert                  \
  -background '#0008'    \
  -gravity center        \
  -fill white            \
  -size ${width}x100     \
   caption:"This is a even longer sample text. \
It also serves to test if automatic sizing of fonts \
by ImageMagick works as expected: just don't specify \
any fontsize, and let ImageMagick go for the best fit..." \
   so#12231624-right.png \
 +swap                   \
 -gravity north          \
 -composite              \
  output2.png 
```

**结果图像：**

![输出示例 1](../Images/3176e8a4390bc4e46eab2b90c6a305d8.png) ![输出示例 2](../Images/91621b173613a80078eb27900955fd72.png)

（输出与您给定的帧不完全匹配——但这只是因为我的测试文件仍然有一个白色的、未填充的边框（作为图像的一部分），我没有费心去删除它......）

**换句话说：只是不要费心使用`-fontsize`. 只给出应该有文本注释的区域的大小。然后 ImageMagick 会自动选择最匹配的字体大小并使用它。**

# php - 将同一个人在不同轨道上的最快分数（分）相加

> ID：12231629
> 
> 赞同：0
> 
> 时间：2012-09-01T21:39:16.633
> 
> 标签：php, mysql, sum, points

`cn_category.category_points`我需要计算每个玩家（`cn_players`记录）的总分（ ）。这是由`cn_records`包含当前和过时记录的 table 驱动的。我只需要总结所有类别（`cn_category`记录）、地图（`cn_maps`记录；未在下面显示）和游戏（`cn_wads`记录；未在下面显示）的最佳时间。*此外，对于 #9、#10 和 #11 类别，将根据三个*最佳分数/记录授予积分，而不仅仅是最好的。

到目前为止，我有这个查询，但它同时计算了当前和过时的记录：

```
SELECT *, MIN(r.record_time), SUM(cn_category.category_points)
FROM (select * from cn_records as r order by r.record_time ASC) AS r
LEFT JOIN cn_players ON r.player1_id = cn_players.player_id
LEFT JOIN cn_category ON r.category_id = cn_category.category_id
WHERE r.category_id BETWEEN 1 AND 25
GROUP BY r.player1_id
ORDER BY SUM(category_points), r.player1_id DESC 
```

（注意：以上不是完整的查询。`WHERE`为简单起见，删除了一些连接和子句条件。）

类别在`cn_category`表中：

```
 category_id | category_points | ...
-------------+-----------------+-----
           1 |             1.0 | ...
           9 |             5.0 | ...
         ... |             ... | ... 
```

玩家在`cn_players`表中：

```
 player_id | ...
-----------+-----
         1 | ...
         2 | ...
       ... | ... 
```

“记录”在`cn_records`表中（有数千行）：

```
 record_id | category_id | player1_id | record_time | ...
-----------+-------------+------------+-------------+-----
         1 |           1 |        143 |    00:00:00 | ...
         2 |           1 |        145 |    00:00:00 | ...
         3 |           1 |         41 |    00:00:00 | ...
         4 |           1 |         41 |    00:00:00 | ...
         5 |           1 |        141 |    00:00:00 | ...
         6 |           1 |         41 |    00:00:00 | ...
       ... |         ... |        ... |         ... | ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T09:53:50.263

像这样的东西？您首先从 cn_records 表中选择每个类别的最大点数。然后您可以再次加入 cn_records 表以仅选择每个类别的实际记录（与最大点匹配的记录）。

之后，您可以加入播放器和类别详细信息，并根据需要进行额外的分组和过滤。困难的部分已经完成。:)

```
SELECT
    p.player_id,
    p.player_name,
    sum(c.category_points) AS total_points
FROM
    /* Select the max points per category */
    (SELECT
      r.category_id,
      min(r.record_time) AS best_time
    FROM
      cn_records r
    GROUP BY
      r.category_id) ar /* Actual records */
    /* Join the records table to find the records that match the max points.
       These are the only records to investigate */
    INNER JOIN cn_records r 
      ON r.category_id = ar.category_id 
      AND r.record_time = ar.best_time
    /* Inner (don't left) join player. What is a record without player */
    INNER JOIN cn_players p ON r.player1_id = p.player_id
    INNER JOIN cn_category c ON r.category_id = c.category_id
GROUP BY
    r.category_id 
```

# apache-tika - 如何在服务器模式下使用 Tika

> ID：12231630
> 
> 赞同：27
> 
> 时间：2012-09-01T21:39:18.107
> 
> 标签：apache-tika

在 Tika 的网站上，它说（关于 tika-app-1.2.jar）它可以在服务器模式下使用。有谁知道如何在该服务器运行后发送文档和接收解析的文本？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-09-02T06:09:32.347

Tika 支持两种“服务器”模式。更简单和原始的是`--server`Tika-App的旗帜。[JAX-RS JSR-311 server component](http://wiki.apache.org/tika/TikaJAXRS)功能更强大，但也是更新的，它是一个附加的 jar。

Tika-App 网络服务器使用起来非常简单。只需使用标志启动 Tika-App `--server`，并使用`--port ###`标志告诉它要监听的端口。然后，连接到该端口并发送一个文件。您将获得 html 版本。`java -jar tika-app.jar --server --port 12345`NetCat很好地解决了这个问题，类似的东西`nc 127.0.0.1 12345 < MyFileToExtract`会让你回到 html

[JAX-RS JSR-311 服务器组件](http://wiki.apache.org/tika/TikaJAXRS)支持几个不同的 url，用于元数据、纯文本等。您使用 启动服务器，`java -jar tika-server.jar`然后使用输入文档对适当的 url 进行 HTTP 调用，您将获得资源背部。[wiki 页面](http://wiki.apache.org/tika/TikaJAXRS)上有大量详细信息和示例（包括使用 curl 进行测试）

Tika App Network Server 相当简单，仅支持一种模式（提取到 HTML），通常用于测试/演示/原型制作等[。Tika JAXRS Server](http://wiki.apache.org/tika/TikaJAXRS)是一个完全 RESTful 服务，它与 HTTP 通信，并且暴露范围很广蒂卡的模式。如今，这是通过网络和/或非 Java 堆栈与 Tika 交互的普遍推荐方式。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2015-01-18T04:27:49.180

只是添加到@Gagravarr 的好答案。

在服务器模式下谈论 Tika 时，区分两个版本很重要，否则会引起混淆：

*   tika-app.jar 有 --server --port 9998 选项来启动一个简单的服务器
*   tika-server.jar 是使用 JAX-RS 的单独组件

第一个选项仅提供文本提取并将内容作为 HTML 返回。最有可能的是，您真正想要的是第二个选项，它是一个 RESTful 服务，它公开了 Tika 的更多功能。

您可以简单地从 Tika 项目站点[下载 tika-server.jar 。](http://tika.apache.org/download.html)使用启动服务器

```
java -jar tika-server-x.x.jar -h 0.0.0.0 
```

-h 0.0.0.0 (host) 选项使服务器监听任何传入的请求，否则它只会监听来自本地主机的请求。也可以加上 -p 选项来更改端口，否则默认为 9998。

然后，一旦服务器启动，您就可以使用浏览器轻松访问它。它将列出所有可用的端点。

最后，要从文件中提取元数据，您可以像这样使用 cURL：

```
curl -T testWORD.doc http://example.com:9998/meta 
```

将元数据作为键/值对返回，每行一个。您还可以通过添加正确的接受标头让 Tika 以 JSON 格式返回结果：

```
curl -H "Accept: application/json" -T testWORD.doc http://example.com:9998/meta 
```

[2015-01-19 更新] 之前的评论说 tika-server.jar 无法下载。修复了这个问题，因为它确实以二进制下载的形式存在。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-18T16:15:37.663

增强 Gagravarr 完美答案：

*   如果您的文档来自 WEB 服务器 => curl -u "http:// *myserver-domain* /*path-to-doc*/ *doc-name.extension* " | 数控 127.0.0.1 12345
*   如果文档有密码保护就更好了 => curl -u *login* :*password* "http:// *myserver-domain* /*path-to-doc*/ *doc-name.extension* " | 数控 127.0.0.1 12345

# jquery - jQuery从CSS获取高度还是动态切换？

> ID：12231635
> 
> 赞同：0
> 
> 时间：2012-09-01T21:40:36.603
> 
> 标签：jquery, css, height, toggle

我有以下代码，但我正在构建一个响应式站点，因此高度需要对内容是动态的。它设置为 0，因此 div 显示为关闭，然后单击它需要设置高度。我可以在 CSS 中设置它（使用不同的高度和媒体查询）并将其拉入吗？

```
$("#contactArea").css('height', '0px');

$("a.contact").toggle( 
            function () { 
                $("#contactArea").animate({height: "180px"}, {queue:false, duration: 800, easing: 'easeOutBack'}) 
            }, 
            function () { 
                $("#contactArea").animate({height: "0px"}, {queue:false, duration: 800, easing: 'easeOutBack'})  
            } 
    ); 
```

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:48:28.410

一个简单的方法是为关闭和打开的 div 定义一个类，并将响应 css 分配给开放类 div。然后onclick你可以使用jQuery通过这样的命令来改变div的类

```
$("#contactArea").attr('class', 'newClass'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T22:25:57.300

首先，是的，你可以！

要将高度设置为设置的 CSS 高度，请使用“切换”选项：

```
$("#contactArea").animate({height: 'toggle'},0);

$("a.contact").on('click', function(e) {
    e.preventDefault();
    $("#contactArea").animate({height: "toggle"}, {queue:false, duration: 800, easing: 'easeOutBack'})     
}); ​ 
```

其次，`click()`不要使用后者，`toggle(with two functions)`因为后者已被弃用。

[**小提琴**](http://jsfiddle.net/ZyEsq/1/)

# xcode - 驯服 Xcode 故事板

> ID：12231637
> 
> 赞同：1
> 
> 时间：2012-09-01T21:40:42.233
> 
> 标签：xcode, xcode4, uistoryboard

我继承了一个使用约 100 个 Xcode 故事板场景的项目。由于以下原因，尝试添加到这个项目一直是一场噩梦：

*   我的机器（2011 年末 Macbook Pro 13 英寸，非 SSD 驱动器 16GB，运行 10.8 + XCode 4.4）在情节提要上爬行停止。在某些情况下，我会移动一个场景，更新它的位置需要 10 秒。

*   在某些情况下，当我修改场景（在两个场景之间创建转场等）时，所有场景都会消失。我必须在侧边栏上做一个“全选”才能让他们回来。

*   浏览特定的故事板场景绝对令人沮丧。没有明显的方法可以按名称对故事板场景进行排序。

*   场景侧边栏下方的过滤器功能可以让我找到我正在寻找的场景，但具有过滤掉我正在寻找的特定场景的属性（segues、视图等）的令人沮丧的副作用。因此，如果我需要为“Person View Controller”修改“add_new_guy”segue，并在过滤器中键入“Person”，我会得到 Person View Controller 没有 add_new_guy segue。如果我删除过滤器中的文本以使转场出现，我将被带回场景列表的顶部，并且（很可能）远离另一端的 Person View Controller。我最终手动向下滚动场景列表以查找我想要更改的特定场景。

我花了几个小时在谷歌上搜索解决方案，但没有出现任何有用的东西。关于如何改善情节提要情况或指向我愚蠢地忽略的 XCode 中的东西的任何建议？

免责声明：

a) 我很清楚转移到 nibs 可以解决问题，而且 100 个故事板场景很疯狂，但我已经继承了代码，预计至少明年我会做故事板。

b) 我知道可以将项目分成几个故事板。如果我有时间，我可能会研究一下。

c) 我听说同时打开两个故事板可能会导致一些问题，我已尽量避免这种情况。

d) 向 Apple 提交关于故事板的错误已经在我的待办事项清单上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-10T00:07:26.547

首先，将你的故事板拆分成更小的故事板。我建议每个故事板最多使用 4-5 个视图控制器。一开始会很头疼，慢慢来吧。看一下[RBStoryboardLink](https://github.com/rob-brown/RBStoryboardLink)，它允许您“通过允许 UIStoryboards 之间的'伪segues'来连接它们。这些segues 可以在不离开Interface Builder 并且不编写任何额外代码的情况下构建”。这会给你：

1.  在情节提要中为非常相似的视图控制器创建抽象超类的能力
2.  更小、更易于管理的文件，不会让您的计算机停止运行
3.  作为团队的一部分工作时合并冲突更少（假设您的项目处于版本控制之下）

其次，告诉你的老板立即为你购买一台新的、更好的开发计算机。他们将在几天内以更高效的开发时间收回 3 到 4,000 美元。（或者，如果这是合同工作......自己买一个新的。）

而且，请放纵我稍微偏离主题的评论。

关于此声明：

> 我预计至少在明年做故事板

工作期望总是可以协商的。你的老板可能认为“从故事板切换到代码所花费的时间比节省的时间要多”。如果这不是真的，请说出来。

# c++ - 对分析结果感到困惑

> ID：12231638
> 
> 赞同：0
> 
> 时间：2012-09-01T21:40:57.277
> 
> 标签：c++, profiling, valgrind, kcachegrind, callgrind

我已经用“ `-g -O2`”构建了我的程序并运行了`valgrind`+cachegrind。我不确定如何解释输出。这是输出：

[http://daviddoria.com/Uploads/callgrind.CacheMisses](http://daviddoria.com/Uploads/callgrind.CacheMisses)

我的“整个程序”是`InpaintingAlgorithm`“主要”的 98.4% 的功能。到目前为止，一切都很好。现在看看`InpaintingAlgorithm`92.9% 的被调用者`InpaintingAlgorithm`是`LinearSearchKNNProperty::operator()`. 这是我的“内循环”，我再次期待大量的时间花在这里。

现在这是我感到困惑的地方。看看 的被调用者`LinearSearchKNNProperty::operator()`，真的什么都没有？？最大的函数只有7.64%，其余的<0.25%。我不明白所有被调用者的总和如何只增加了大约 8%。剩下的 92% 在哪里？（大概是我要找的东西让它跑得更快！）

如果有人能指出我在阅读这些结果时的错误，我将不胜感激！

# javascript - JS替换不适用于字符串

> ID：12231644
> 
> 赞同：41
> 
> 时间：2012-09-01T21:41:29.963
> 
> 标签：javascript, jquery

尝试用变量替换字符串中的所有 # 实例。它不起作用，但也没有重新调整任何错误。

```
answer_form = '<textarea name="answer_#" rows="5"></textarea>'+
              '<input type="file" name="img_#" />';

question_num = 5;

answer_form.replace(/#/g, question_num); 
```

哈希仍然存在。

不确定我错过了什么？

* * *

## 回答 #1

> 赞同：165
> 
> 时间：2012-09-01T21:42:33.650

`.replace()`返回一个新字符串（它不会修改现有字符串），因此您需要：

```
answer_form = answer_form.replace(/#/g, question_num); 
```

您可能还应该创建`question_num`一个字符串，尽管自动类型转换可能会为您处理。

工作示例：http: [//jsfiddle.net/jfriend00/4cAz5/](http://jsfiddle.net/jfriend00/4cAz5/)

仅供参考，在 Javascript 中，字符串是不可变的 - 现有的字符串永远不会被修改。因此，任何对字符串进行修改的方法（如`concat`, `replace`, `slice`, `substr`, `substring`, `toLowerCase`, `toUpperCase`, 等）总是返回一个新字符串。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-01T21:44:48.870

你的代码是正确的。只需像这样将值添加到变量中：

```
answer_form = '<textarea name="answer_#" rows="5"></textarea>'+
              '<input type="file" name="img_#" />';

question_num = 5;

answer_form = answer_form.replace(/#/g, question_num); 
```

# java - Ehcache 丢失对象

> ID：12231646
> 
> 赞同：6
> 
> 时间：2012-09-01T21:42:20.373
> 
> 标签：java, spring, ehcache

我正在使用 Ehcache 来缓存在我的应用程序中加载非常昂贵的对象。在启动时，我缓存了所有需要的对象，并且它们每天通过一个单独的进程刷新一次。

但是，似乎在我将对象添加到缓存后不久，它们就消失了。没有报告被驱逐，但由于某种原因，这些对象没有在缓存中持久存在。当我运行 ObjectLoader.loadCache() 这是我收到的输出：

```
2012-09-01 17:25:37,121 [main] DEBUG ObjectLoader.getObject():65 - ************************************
2012-09-01 17:25:37,121 [main] DEBUG ObjectLoader.getObject():66 - Number of objects in cache: 0
2012-09-01 17:25:37,121 [main] DEBUG ObjectLoader.getObject():72 - Object not in cache | 501
2012-09-01 17:26:17,271 [main] DEBUG ObjectLoader.getObject():80 - Number of objects in cache: 1
2012-09-01 17:26:17,271 [main] DEBUG ObjectLoader.getObject():81 - Number of objects evicted from cache: 0
2012-09-01 17:26:17,274 [main] DEBUG ObjectLoader.getObject():83 - Object key found: 501
2012-09-01 17:26:17,274 [main] DEBUG ObjectLoader.getObject():65 - ************************************
2012-09-01 17:26:17,274 [main] DEBUG ObjectLoader.getObject():66 - Number of objects in cache: 1
2012-09-01 17:26:17,274 [main] DEBUG ObjectLoader.getObject():72 - Object not in cache | 518
2012-09-01 17:26:35,894 [main] DEBUG ObjectLoader.getObject():80 - Number of objects in cache: 1
2012-09-01 17:26:35,895 [main] DEBUG ObjectLoader.getObject():81 - Number of objects evicted from cache: 0
2012-09-01 17:26:35,895 [main] DEBUG ObjectLoader.getObject():83 - Object key found: 518
2012-09-01 17:26:35,895 [main] DEBUG ObjectLoader.getObject():65 - ************************************
2012-09-01 17:26:35,895 [main] DEBUG ObjectLoader.getObject():66 - Number of objects in cache: 1
2012-09-01 17:26:35,895 [main] DEBUG ObjectLoader.getObject():72 - Object not in cache | 516
2012-09-01 17:27:31,997 [main] DEBUG ObjectLoader.getObject():80 - Number of objects in cache: 1
2012-09-01 17:27:31,998 [main] DEBUG ObjectLoader.getObject():81 - Number of objects evicted from cache: 0
2012-09-01 17:27:31,998 [main] DEBUG ObjectLoader.getObject():83 - Object key found: 516
2012-09-01 17:27:31,998 [main] DEBUG ObjectLoader.getObject():65 - ************************************
2012-09-01 17:27:31,998 [main] DEBUG ObjectLoader.getObject():66 - Number of objects in cache: 1
2012-09-01 17:27:31,998 [main] DEBUG ObjectLoader.getObject():72 - Object not in cache | 515
2012-09-01 17:28:20,343 [main] DEBUG ObjectLoader.getObject():80 - Number of objects in cache: 1
2012-09-01 17:28:20,343 [main] DEBUG ObjectLoader.getObject():81 - Number of objects evicted from cache: 0
2012-09-01 17:28:20,344 [main] DEBUG ObjectLoader.getObject():83 - Object key found: 515
2012-09-01 17:28:20,344 [main] DEBUG ObjectLoader.getObject():65 - ************************************
2012-09-01 17:28:20,344 [main] DEBUG ObjectLoader.getObject():66 - Number of objects in cache: 1
2012-09-01 17:28:20,344 [main] DEBUG ObjectLoader.getObject():72 - Object not in cache | 525
2012-09-01 17:29:05,616 [main] DEBUG ObjectLoader.getObject():80 - Number of objects in cache: 1
2012-09-01 17:29:05,617 [main] DEBUG ObjectLoader.getObject():81 - Number of objects evicted from cache: 0
2012-09-01 17:29:05,617 [main] DEBUG ObjectLoader.getObject():83 - Object key found: 525
2012-09-01 17:29:05,617 [main] DEBUG ObjectLoader.getObject():65 - ************************************
2012-09-01 17:29:05,617 [main] DEBUG ObjectLoader.getObject():66 - Number of objects in cache: 1
2012-09-01 17:29:05,618 [main] DEBUG ObjectLoader.getObject():72 - Object not in cache | 512
2012-09-01 17:29:38,790 [main] DEBUG ObjectLoader.getObject():80 - Number of objects in cache: 1
2012-09-01 17:29:38,790 [main] DEBUG ObjectLoader.getObject():81 - Number of objects evicted from cache: 0
2012-09-01 17:29:38,790 [main] DEBUG ObjectLoader.getObject():83 - Object key found: 512 
```

是我的 ehcache 配置错误还是我的代码中有错误？任何帮助，将不胜感激。谢谢。

我正在使用 spring 3.1.0、ehcache-spring-annotations 1.1.2 和 ehcache 2.4.2

**ObjectCacheFacade.java**

```
@Component()
public class ObjectCacheFacade {
    private static final String CACHE_KEY = "myObjectCache";

    @Resource
    private CacheManager cacheManager;
    private Cache cache;

    public ObjectCacheFacade() {
        cacheManager = CacheManager.getInstance();
        this.cache = cacheManager.getCache(CACHE_KEY);
    }

    public Object getObjectFromCache(String objectId) {
        Object result = null;
        Element element = cache.get(objectId);

        if (element != null && element.getValue() != null) {
            result = element.getObjectValue();
        } 

        return result;
    }

    public void putObjectIntoCache(String objectId, Object object) {
        Element element = new Element(objectId, object);
        cache.put(element);
    }

    public int getSize() {
        return cache.getSize();
    }

    public void removeObjectFromCache(String objectId) {
        cache.remove(objectId);
    }

    public void flushCache() {
        cache.removeAll();
    }

    public Cache getCache() {
        return cache;
    }
} 
```

**对象加载器.java**

```
@Service
public class ObjectLoader {
    private static final Logger log = Logger.getLogger(ObjectLoader.class);

    @Resource
    protected ObjectDao objectDao;
    @Resource
    protected ObjectCacheFacade objectCache;

    public void loadCache() {
        List<String> objectIds = objectDao.getObjectIds();

        for (String objectId : objectIds) {
            loadObject(objectId);
        }
    }

    public Object getObject(String objectId) {
        log.debug("************************************");
        log.debug("Number of objects in cache: " + objectCache.getSize());

        Object object = objectCache.getObjectFromCache(objectId);

        if (object == null) {
            log.debug("Object not in cache | " + objectId);
            object = objectDao.getObject(objectId);

            if (object != null) {
                objectCache.putObjectIntoCache(objectId, object);

                log.debug("Number of objects in cache: " + objectCache.getSize());
                log.debug("Number of objects evicted from cache: " + objectCache.getCache().getCacheEventNotificationService().getElementsEvictedCounter());
                for (Object key : objectCache.getCache().getKeys()) {
                    log.debug("Object key found: " + key);
                }
            } 
        } 

        return object;
    }
} 
```

**ehcache.xml**

```
<ehcache>
    <diskStore path="java.io.tmpdir"/>

    <defaultCache
        maxElementsInMemory="1000"
        eternal="false"
        timeToIdleSeconds="60"
        timeToLiveSeconds="300"
        overflowToDisk="false"
        memoryStoreEvictionPolicy="LRU"
       />

    <cache
        name="myObjectCache"
        maxElementsInMemory="1000"
        eternal="true"
        timeToIdleSeconds="0"
        timeToLiveSeconds="0"
        overflowToDisk="false"
        diskPersistent="true"
        memoryStoreEvictionPolicy="LRU"
       />

</ehcache> 
```

**应用程序上下文.xml**

```
<bean id="cacheManager" class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean" /> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T11:54:06.507

由于`diskPersistent`设置为 true`Ehcache`是在将对象添加到缓存后尝试将其写入磁盘。但是，主缓存对象中的一个嵌套对象没有实现`Serializable`，因此它在磁盘写入时引发异常，然后将对象从缓存中逐出。此驱逐未显示在缓存统计信息中，因为它没有被`memoryStoreEvictionPolicy`.

这应该是一个很容易找到的错误，但是该项目不包含该`slf4j-log4j12`库，因此异常被吞没而不是被写入日志。一旦日志处理得当，问题出在哪里就很明显了。

哦，好吧，生活和学习，我猜...

# php - 如何使用 Apache Mod_rewrite 删除 php 扩展，同时保留 GET 参数？

> ID：12231650
> 
> 赞同：5
> 
> 时间：2012-09-01T21:42:28.263
> 
> 标签：php, apache, mod-rewrite, parameters

我试图从我的网站中删除 PHP 扩展。当用户请求一个 PHP 文件时，PHP 将被删除并重定向用户，当用户键入一个没有 PHP 的 URL 时，将提供实际的 PHP 文件。这很好用，除非 URL 中有 GET 参数。我的规则如下：

```
# remove .php ONLY if requested directly
RewriteCond %{THE_REQUEST} (\.php\sHTTP/1)
RewriteRule ^(.+)\.php$ /$1 [R=301,L,QSA]

# remove trailing slash ONLY if it is not an existing folder
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)/$ /$1 [L,R=301]

# rewrite to FILENAME.php if such file does exist and is not a folder
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ /$1.php [L,QSA] 
```

我认为即使有任何 GET 参数，这也应该已经能够删除 php，但它失败了。我也尝试过这样的事情：

```
RewriteCond %{THE_REQUEST} (\.php\sHTTP/1)
RewriteRule ^(.)\.php(.)$ $1$2 [R=301,L,QSA] 
```

它也没有工作，php仍然存在。但如果我尝试：

```
RewriteRule ^(.)\.php(.)$ $1$2 [R=301,L,QSA] 
```

即，删除 RewriteCond，php 扩展被删除，参数被保留，但页面不会被提供，因为浏览器说有太多的重定向。

请问有人有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T18:21:04.873

感谢 SteAp 的回答。刚才正好想出了一个处理方法，在这里分享一下，以防其他人遇到类似的问题。

在我的规则中，我有

```
# remove .php ONLY if requested directly
RewriteCond %{THE_REQUEST} (\.php\sHTTP/1)
RewriteRule ^(.+)\.php$ /$1 [R=301,L,QSA] 
```

在用户请求 PHP 文件时执行外部重定向。这里的 RewriteCond 是为了防止重定向循环 - 即由于不正确的内部重写和外部重定向导致的无限重定向（删除 php，然后添加 php，然后再次删除，...）

当有参数时，实际的标头是[http://domain.com/file.php](http://domain.com/file.php) ?.... HTTP/1.1 这样的东西，所以 RewriteCond 中的模式不起作用，因为它没有带参数考虑到。

要解决它，只需将上面的代码替换为：

```
# remove .php ONLY if requested directly
RewriteCond %{THE_REQUEST} (\.php(.*)\sHTTP/1)
RewriteRule ^(.+)\.php$ /$1 [R=301,L,QSA] 
```

通过这样做，参数可以通过模式匹配，现在一切正常。

希望这会帮助有类似问题的人（或者只是像我这样的菜鸟？哈哈）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T22:29:41.337

您可能希望使用[此处](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html)`%{QUERY_STRING}`记录的参数。

有用的阅读[here](http://statichtml.com/2010/mod-rewrite-baseon-on-query-string.html)和[here](http://niallohiggins.com/2009/05/01/apache-mod_rewrite-rewriterule-with-query-string/)。

# python - 调用 socket.connect(...) 时出现 TypeError

> ID：12231658
> 
> 赞同：0
> 
> 时间：2012-09-01T21:43:04.137
> 
> 标签：python, sockets, typeerror

运行相对简单的 TCP 客户端时，我不断收到错误消息。麻烦的线是对 socket.connect(..) 的调用，它通过 TypeError 查找。任何想法为什么？我现在已经为主机和端口输入了硬编码值。

```
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/logging/__init__.py", line 846, in emit
    msg = self.format(record)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/logging/__init__.py", line 723, in format
    return fmt.format(record)
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/logging/__init__.py", line 464, in format
    record.message = record.getMessage()
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/logging/__init__.py", line 328, in getMessage
    msg = msg % self.args
TypeError: not all arguments converted during string formatting
Logged from file run_42bets.py, line 70

# ------

#!/usr/bin/python

import importlib
import logging
import optparse
import os
import socket

SCRIPT_NAME = os.path.basename(__file__)
VERSION = SCRIPT_NAME + ' 1.0'

class TCPCommandSender:
    """Wrapper around TCP client for sending commands"""
    def __init__(self, host, port):
        """Setup connection to host:port"""
        logging.info("Connecting to server %s:%s", host, port)

        self.__host = host
        self.__port = port

        self.__socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.__socket.connect(("127.0.0.1", 2000))

    def __enter__(self):
        """Return TCPCommandSender instance"""
        return TCPCommandSender

    def __exit__(self, type, value, traceback):
        """Tear down connection if connected"""
        if self.__socket:
           logging.info("Disconnecting from server %s:%s", self.__host, self.__port)
           self.__socket.close()

    def send(self, cmd):
        """Send admin command to server and return received message"""
        try:
            self.__socket.sendall(cmd)
            return self.__socket.recv(1024)
        except socket.error, msg:
            logging.critical("Failed to send admin cmd; reason=%s", msg)
            return "ERROR"

def main():
    #customise logging
    logging.basicConfig(filename=SCRIPT_NAME + '.log', 
                        filemode='a',
                        format='%(asctime)s %(levelname)s %(message)s',
                        datefmt='%Y-%m-%d %H:%M:%S',
                        level=logging.INFO) 

    logging.info("Starting %s", SCRIPT_NAME)

    #define command line arguments
    parser = optparse.OptionParser("Usage: %prog [options]", version=VERSION)
    parser.add_option('--host', dest='host', help='Server to send commands to', type='string')
    parser.add_option('--port', dest='port', help='Server admin port to send commands to', type='int')
    parser.add_option('--config', dest='config', help='Python configuration module to configure algo', metavar='FILE')
    (options, args) = parser.parse_args()

    #check we have all required command line arguments
    if options.host and options.port and options.config:
        try:
            with TCPCommandSender(options.host, options.port) as cmd_sender:
                try:
                    logging.info("Running configuration module %s", options.config)
                    logging.info("Finished configuration module %s", options.config)
                except:
                    logging.critical("Error while running configuration module %s", options.config)
        except EnvironmentError, msg:
            logging.critical("Failed to connect to server %s:%s", options.host, options.port, msg)
    else:
        parser.error("Incorrect number/set of arguments provided, see --help")  

    logging.info("Ending %s", SCRIPT_NAME)

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:47:35.593

你的问题是这一行：

```
logging.critical("Failed to connect to server %s:%s", options.host, options.port, msg) 
```

Python 抱怨你给了它三个东西放在字符串中（`options.host`,`options.port`和`msg`），但是你只给了它两个地方来放它们（只有两个`%s`）。

# javascript - 为新元素动态添加 javascript

> ID：12231660
> 
> 赞同：0
> 
> 时间：2012-09-01T21:43:35.157
> 
> 标签：javascript, html, ajax

我正在尝试为我获得的新元素动态添加javascript并通过ajax添加到页面中。因此，我可以使用 createElement("script") 和 appendChild 为页面上已有的元素动态添加 javascript，但对于我刚刚通过 ajax 添加的新元素，这似乎不起作用。有什么建议可以实现吗？

顺便说一句，我使用 .innerHTML += 而不是 appendchild 为每个元素添加新的 DOM 元素，因为有很多新元素。这有关系吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T23:50:34.170

最好借助像[jQuery](http://jquery.com/)这样的框架。

在 jQuery 的帮助下，跟踪和处理动态添加的 DOM 元素的工作变得微不足道：

$.(document).on("click","#MyElement",function(){ //do stuff });

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T21:48:30.303

而不是动态添加 javascript，您应该`<script>`在标题中的部分中留出专用函数或作为单独来源的文件。添加元素后，您应该添加调用这些专用函数的事件处理程序，而无需动态添加 javascript。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T23:46:55.837

假设您已将内容加载到一个名为的容器中，`id="container"`您可能想使用类似的选择器

`$("#container img")`

获取元素并设置事件处理程序。

这是一个例子：http: [//jsfiddle.net/PTcw8/5/](http://jsfiddle.net/PTcw8/5/)

# java - Google GCM 无法为 Java SSL 服务器进行 SSL 握手

> ID：12231665
> 
> 赞同：1
> 
> 时间：2012-09-01T21:44:28.657
> 
> 标签：java, android, security, ssl, handshake

我最近发现了适用于 Android 的 Google Cloud Messaging，我想集成我的应用程序以使用它。我让项目的 Android 端正常工作，并且应用程序已正确注册到服务器。问题是我的服务器似乎无法对 GCM 服务器进行身份验证，因此它可以与它们对话。这就是我的意思：

目前，我的服务器是一个简单的基于 Java 的 SSL 服务器，带有一个密钥库和一个信任库。信任库包含客户端的密钥（即应用程序的密钥），反之亦然，客户端/服务器可以通过 SSL 相互通信而不会出现任何问题。我用来向应用程序发送消息的代码是这样的：

```
Sender sender = new Sender( "API_KEY" );
Message message = new Message.Builder().addData( "message", description ).build();
Result result = sender.send( message, ID, 1 ); 
```

它给了我以下例外：

```
javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target 
```

当我启动我的服务器时，我传入信任/密钥库的名称及其密码并加载它们，以便它们可以用于与客户端对话。我怀疑问题在于当前信任库仅包含客户端的密钥，因此服务器只能与客户端交谈，而不能与其他人交谈。这是正确的吗，如果是，任何人都知道如何将 GCM 证书添加到信任库或其他东西？

非常感谢，非常感谢任何帮助:)

PS我尝试在服务器中加载信任库*之前向客户端发送一条消息，并且应用程序成功接收到它。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T05:14:54.367

使用 Google Cloud Messaging，您的服务器不会直接与客户端对话。它首先经过“云”部分。因此，将客户端证书放在服务器的信任管理器中是行不通的。

相反，您的服务器必须验证 Google 云消息服务器的 SSL 证书。这些由操作系统默认 CA 列表中的证书颁发机构提供支持，因此在添加信任库之前向客户端发送消息就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T10:28:58.310

弄清楚了。正如 kroot 所建议的那样，问题在于服务器无法验证 GCM 服务器，因为它们的证书不在其信任库中（我使用自己的信任库，而不是系统的信任库）。因此，我通过简单地从 Java 安全文件夹中复制 cacerts 文件，在其中添加 Android 应用程序的自定义客户端证书，并将该文件用作我的信任库来更改它，因为它已经具有系统的默认信任证书。很简单，但花了我半天时间才弄清楚。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T01:41:31.230

服务器的 trustStore 不信任客户端的证书。检查它包含的内容，以及您是否确实在使用该 trustStore。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-14T15:15:38.990

我创建了一个独立的 java 程序，它充当“服务器”，可以将消息推送到 GCM 服务器，而 GCM 服务器又可以将消息传递到我的手机应用程序。

我不必在我的 jre\lib\security\cacerts 文件中安装任何证书，因为随附的受信任条目足以连接到 GCM 服务器。

唯一的依赖项如下

```
 <dependency>
        <groupId>com.google</groupId>
        <artifactId>gcm-server</artifactId>
        <version>1.0.1</version>
    </dependency>
    <dependency>
        <groupId>com.googlecode.json-simple</groupId>
        <artifactId>json-simple</artifactId>
        <version>1.1.1</version>
    </dependency> 
```

# ios - IOS；视频有时黑屏

> ID：12231666
> 
> 赞同：2
> 
> 时间：2012-09-01T21:44:38.760
> 
> 标签：ios, video

使用 MPMoviePlayerController 显示视频时，有时会出现黑屏。我使用 UIImagePickerController 创建一个新视频或选择一个保存的视频。

我在下面的 imagePickerController:: 中创建了 MPMoviePlayerController。我在 viewDidAppear: 中下棋。

如果创建了新电影，则该电影可以正常播放，但在选择现有电影时会出现黑屏。在这两种情况下，我都有一部有效的电影要上传。

我已经尝试过播放消息和没有播放消息。有任何想法吗？

```
-(void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{

NSString *mediaType = [info objectForKey: UIImagePickerControllerMediaType];
UIImage *originalImage, *editedImage;

// Handle a still image picked from a photo album
if (CFStringCompare ((__bridge CFStringRef) mediaType, kUTTypeImage, 0) == kCFCompareEqualTo) 
{

    editedImage =   (UIImage *) [info objectForKey: UIImagePickerControllerEditedImage];
    originalImage = (UIImage *) [info objectForKey: UIImagePickerControllerOriginalImage];

    _image = (editedImage == nil) ? originalImage : editedImage;
    _imageView.image = _image;
    _imageParentView.hidden = NO;
}

// Handle a video picked from a photo album
if (CFStringCompare ((__bridge CFStringRef) mediaType, kUTTypeMovie, 0) == kCFCompareEqualTo) 
{
    _rawVideoURL = [info objectForKey: UIImagePickerControllerMediaURL];
    _videoParentView.hidden = NO;

    _player = [[MPMoviePlayerController alloc] initWithContentURL: _rawVideoURL];
}

[self dismissModalViewControllerAnimated: YES];
}

-(void)viewDidAppear:(BOOL)animated
{
[super viewDidAppear:animated];

if (_player != nil)
{
    [_player prepareToPlay];
    [_player.view setFrame: _videoView.bounds];  // player's frame must match parent's
    [_videoView addSubview: _player.view];
    _player.repeatMode = MPMovieRepeatModeOne;
    _player.scalingMode = MPMovieScalingModeAspectFit;

    [_player play];
}
} 
```

# javascript - !0 和 !1 不仅仅是真/假的简写吗？

> ID：12231671
> 
> 赞同：10
> 
> 时间：2012-09-01T21:45:32.790
> 
> 标签：javascript, boolean, shorthand

阅读一些代码，我发现了`!0`and的用法`!1`。我意识到这些是较短的写作方式`true`和`false`.

```
!0 === true
!1 === false 
```

这当然节省了几个字节，但是还有其他使用它的理由吗？

这种写法有名字吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-01T21:47:53.140

大多数 JavaScript**缩小工具**，例如[UglifyJS](http://marijnhaverbeke.nl/uglifyjs)，都会*生成*该代码，因为它更短且语义等效。例如，给定：

```
var x = true;
if (x) { 
  alert(x); 
} 
```

UglifyJS 将生成`var x=!0;x&&alert(x)`.

通常，您不需要使用这种风格编写代码；让*缩小器*做*他们的*工作:-)。

# jquery - Bootstrap 2.1.0 和谷歌地图

> ID：12231683
> 
> 赞同：4
> 
> 时间：2012-09-01T21:46:40.180
> 
> 标签：jquery, google-maps, twitter-bootstrap

我无法让谷歌地图在 bootstrap 2.1.0 上运行。

*   地图大小不合适
*   它没有居中

任何提示？

请不要回答

```
#map_canvas img { 
  max-width: none; 
} 
```

因为这在引导程序 2.0.4 中已修复

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T20:54:45.210

我总是给地图画布绝对尺寸以使地图出现。例如，我使用此代码使地图填充整个文档显示区域：

```
var wnd = $(window);
var jMap = $("#map");
var map = new google.maps.Map(jMap[0],
{
    zoom: 10,
    center: new google.maps.LatLng(50.50714570, 5.419846499999999),
    mapTypeId: google.maps.MapTypeId.ROADMAP
});

function resize()
{
    jMap.width(wnd.width());
    jMap.height(wnd.height());
    google.maps.event.trigger(map, "resize");
}

wnd.resize(resize);
resize(); // Initial resize 
```

`map`地图div的id在哪里

# java - 如何在 jar 中编辑代码？

> ID：12231686
> 
> 赞同：1
> 
> 时间：2012-09-01T21:46:55.167
> 
> 标签：java, jar, decompiling, reflector, reflexil

> **可能重复：**
> [从 jar 文件更改类的代码](https://stackoverflow.com/questions/11848161/changing-the-code-of-the-class-from-jar-file)

我是从 .Net 来的，那里有 Reflector 和 Reflexil，使我能够打开程序集并编辑其代码，而无需重新编译它。我做了一些研究，发现了 jd-gui，它可以让我查看 jar 中的 java 代码，但我找不到任何类似于 reflexil 的东西。

是否有任何软件可以让我修改 jar 而无需重新编译它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T21:53:44.397

实际上，jar 只是一个 zip，因此无需重新编译。只需解压它（使用 jar xf），添加、替换或删除一些文件或目录，然后再次 jar （使用 jar cf）。

# android - Android MapView 获取 stackoverflow，而不会引发异常

> ID：12231690
> 
> 赞同：0
> 
> 时间：2012-09-01T21:46:58.970
> 
> 标签：android, android-mapview, android-maps

我已经动态添加了一个 MapView，但我做错了。

在布局 XML 中添加 MapView 时，一切正常，但是当我动态添加它时，MapView 似乎在 stackoverflow 中捕获 UI 线程，它从不抛出异常，并且应用程序不再可调试。堆栈主要集中在 Tile 对象上，它在 getTile(...) 方法和其他一些方法上来回移动。

有任何想法吗？

谢谢，亚当。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T02:52:37.060

我不确定如何，但是我拥有的用于调试和发布的 api-keys 已经过时了......一旦我设置了新的密钥，它就再次像一个魅力......

# c# - 我使用richTextBox 来查看日志，但我如何让它不每次都下移到新行？

> ID：12231696
> 
> 赞同：0
> 
> 时间：2012-09-01T21:47:41.083
> 
> 标签：c#

这就是我在计时器滴答事件中使用它的方式：

```
private void timer1_Tick(object sender, EventArgs e)
        {
            memUsage = theMemCounter.NextValue();
            label1.Text = memUsage.ToString();
            Logger.Write("Memory Usage   " + memUsage.ToString());
            AppendText(richTextBox1, "Memory Usage   " + memUsage.ToString() + Environment.NewLine, Color.Red);
            cpuUsage = this.theCPUCounter.NextValue();
            label2.Text = cpuUsage.ToString();
            Logger.Write("Cpu Usage   " + this.cpuUsage.ToString());
            AppendText(richTextBox1, "Cpu Usage   " + cpuUsage.ToString() + Environment.NewLine, Color.Blue);
            Values.Add(cpuUsage);
            isProcessRunning();
            if (alreadyRun == true)
            {
                processValues.Add(cpuUsage);
            }

        } 
```

这是 AppendText 函数：

```
public  void AppendText( RichTextBox box, string text, Color color)
        {
            box.SelectionStart = box.TextLength;
            box.SelectionLength = 0;

            box.SelectionColor = color;
            box.AppendText(text);
            box.SelectionColor = box.ForeColor;
        } 
```

如果在计时器滴答声中我不会使用 Environment.NewLine 那么我只会看到唯一的内存使用中的一行重复它自己。

如果我使用 Environment.NewLine 那么我每次都会看到内存使用情况和 cpu 使用情况下降到一个新行，例如：

内存使用率 --- 3 Cpu 使用率 --- 0.4565 内存使用率 --- 3.6 Cpu 使用率 --- 47

相反，我想查看一行内存使用情况和一行 cpu uage，并一遍又一遍地更新这两行，而不是为它们创建新行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T23:22:56.543

如果您尝试仅更新 2 行，请尝试以下操作：

```
private void timer1_Tick(object sender, EventArgs e)
{
    richTextBox1.Text = "";
    // Add the rest of the code here
} 
```

这样它将显示 2 行（内存和 cpu 使用情况），并且在打勾后，它将清除文本，然后设置这 2 行。这看起来好像正在更新。

希望这可以帮助！

# iphone - 通过谷歌解析天气

> ID：12231698
> 
> 赞同：0
> 
> 时间：2012-09-01T21:47:57.593
> 
> 标签：iphone, ios, xcode, weather

我一直在使用 ICB_WeatherConditions 类来获取我的应用程序的本地条件。它一直运行良好，但最近一切都恢复为空。当我在计算机上访问该站点时，它会阻止它并警告我的计算机可能正在发送自动查询。关于这是否不再是执行此操作的有效方法，或者只是服务器的临时错误的任何想法？

[http://www.google.com/ig/api?weather=%@](http://www.google.com/ig/api?weather=%@) , %@=邮政编码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T21:54:23.443

我猜你达到了配额。查看 Google 条款和条件以了解该服务的使用情况：尽可能多的 Google 服务可能允许使用达到有限配额（每小时 N 个请求或类似），这通常足以满足一般需求，但需要您付费如果您真的想在短时间内发出更多请求（以避免他们的服务器受到 DDoS 攻击，尤其是来自盗版者的攻击，他们会向他们的服务器发送大量请求）

# javascript - HTML5 / CSS3 动画

> ID：12231700
> 
> 赞同：1
> 
> 时间：2012-09-01T21:48:05.237
> 
> 标签：javascript, html, css

那天晚上，我播放了 iTunes Visualizer（新的而非经典的）。我开始思考并想知道是否可以创建类似样式类型的效果，用于过渡`div`或其他标签以创建华丽的效果。这里有一个问题，虽然我认为可以在 Flash 中完成这类事情，是否可以在*没有*Flash 的情况下使用 HTML5、CSS3、Javascript 等来完成？

我知道可以创造一些惊人的效果。经过一番搜索，我没有找到任何东西，但我在这里问了两个问题：

1.  可以完成类似于 iTunes 可视化工具的操作吗？
2.  如果可能，如何？

（注意：虽然我很想支持我正在寻找的所有浏览器，但即使不是所有浏览器都支持。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T22:56:56.560

这是一个关于使用 HTML5 创建视觉效果的好教程：

[http://thecodeplayer.com/walkthrough/make-a-particle-system-in-html5-canvas](http://thecodeplayer.com/walkthrough/make-a-particle-system-in-html5-canvas)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T23:05:51.273

是的，这一切都可以在没有 Flash 的情况下完成（可能更好）。

看看[CSS3 转换](http://www.w3.org/TR/css3-transforms/)、[Raphael.JS](http://raphaeljs.com/)和[HTML5 Canvas](http://www.html5canvastutorials.com/advanced/html5-canvas-animation-stage/)。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T23:08:19.993

iTunes 可视化器非常华丽。这是一个难以下咽的大药丸，但你最好还是看看[WebGL](http://www.chromeexperiments.com/webgl/)。您可能非常喜欢研究[Three.js](https://github.com/mrdoob/three.js/)。

# c++ - 沿圆形绘制时，寻找角度矩形将占据（见图）

> ID：12231701
> 
> 赞同：2
> 
> 时间：2012-09-01T21:48:05.220
> 
> 标签：c++, algorithm, geometry

这就是我想要做的。我有一个字体，基本上是每个字形的位图矩形。我正在尝试获得这样的弧形文本效果：

![在此处输入图像描述](../Images/ff0c37d8f15ceca7e078822c6757a3f4.png)

我的计划是，给定一个中心和一个半径，我将求解每个字形的位置和角度。

我有一个可以找到位置的功能：

```
Vec2 Math::positionFromCenterToLineAt( Vec2 center, float dist,
        float totalAngular, float angularDistance, float angularOffset )
    {
        float startAngle = -((totalAngular) / 2.0f);
        float curAngle = startAngle + angularDistance;
        curAngle -= angularOffset;
        curAngle += angularDistance / 2.0f;
        curAngle += CGE_PI;

        Vec2 retVec = center;
        Vec2 angVec = Vec2(sin(curAngle),cos(curAngle));
        angVec *= dist;
        retVec += angVec;

        return retVec;
    } 
```

它需要我知道弧度将占据多少圆，并且需要从当前字形绘制的起始角度开始多少度。

我想不出的是一个函数，可以在给定字形的半径、中心、宽度和高度的情况下找到给定字形将占据的角度。每个字形可以有不同的维度。

看到这个： ![在此处输入图像描述](../Images/a6dacb0c58985414662dde4683864768.png)

如您所见，我正在寻找弧度，即圆的那个扇区。

我怎么计算呢？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T21:55:54.677

```
2*pi*radius equals the circumference
You know radius as a pixel base(lets say it is 40 pixels)
You can find circumference(lets say it is 251 pixels)
Then, if you get width of a char(lets say it is 8)
You know the angle of arc: angle=2*pi*(8/251)=2*pi*0.03=0.2 radians
0.2 radians * 57.3 = 11.5 degrees 
```

如何根据当前字体查找字符的宽度？

```
LOGFONT lf;
int width=lf.lfWidth; //beware! this is average 
```

你想要精确的选择吗？

```
GetTextExtentPoint32() // search usage of this!

Its structure type is:

 BOOL GetTextExtentPoint32(
  __in   HDC hdc,
  __in   LPCTSTR lpString,
  __in   int c,
  __out  LPSIZE lpSize
); 
```

# scala - 使用伴生对象时的方法名称限定

> ID：12231702
> 
> 赞同：0
> 
> 时间：2012-09-01T21:48:09.470
> 
> 标签：scala, methods, companion-object

我只是在学习 Scala。我创建了一个伴随对象（参见下面的代码片段），其中定义了一个运算符 , `^`（表示复杂共轭）。我必须使用关联类中的伴随对象名称来限定它。我的印象是我应该无条件地访问同伴的方法。如果我做错了什么，有人可以告诉我吗？

```
class CQ(val r: Q, val i:Q) {

  def +(z : CQ): CQ = {
    return new CQ(r + z.r, i + z.i)
  }

  def -(z: CQ): CQ = {
    return new CQ(r - z.r, i-z.i)
  }

  def *(z: CQ): CQ = {
    return new CQ(r*z.r - i*z.i, r*z.i + i*z.r)
  }

  def /(z: CQ): CQ = {
    val d = z.r * z.r + z.i * z.i
    val n = this * CQ.^(z) // that I needed to qualify "^" is what I don't get
    return new CQ(n.r / d, n.i /d)
  }

  override def toString = r + " + " + i + "i"
}
object CQ {

  def ^(z : CQ) : CQ = {
    return new CQ(z.r, Q.NEGONE*z.i)
  }

  val ONE = new CQ(Q.ONE,Q.ZERO)
  val ZERO = new CQ(Q.ZERO, Q.ZERO)
  val I = new CQ(Q.ZERO, Q.ONE)
  val NEGONE = I * I
} 
```

注意：这里使用了另一个类 Q，但未列出。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T22:35:55.483

对象和类的成员在不同的范围内，不会自动导入到同伴中。所以是的，您需要使用合格的访问权限或导入您需要的成员。

您可能会将其与私有访问混淆：您可以访问同伴的私有成员（但只能通过合格访问或在导入之后）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T21:50:03.783

您需要导入该函数，使其在范围内：

```
import CQ.^ 
```

或者，从伴随对象导入所有内容：

```
import CQ._ 
```

一个例子：

```
class A(x: Int) {
  import A.^
  def f(y: Int) = x * ^(y)
}
object A {
  def ^(a: Int) = a - 1
}

println(new A(4).f(3)) 
```

该`import`行可以在类定义内部或外部，具体取决于您的偏好。

# wordpress - 查询帖子在 Wordpress 短代码中不起作用

> ID：12231706
> 
> 赞同：0
> 
> 时间：2012-09-01T21:49:12.577
> 
> 标签：wordpress, shortcode

好吧，我已经尝试了很多简码片段来在我的帖子（不是页面）中显示 3 个最近的帖子作为简码。

喜欢：

```
function posts_shortcode() {
$the_query = new WP_Query(array('posts_per_page' => 3));

// The Loop
while ( $the_query->have_posts() ) : $the_query->the_post();
    echo '<li>';
    the_title();
    echo '</li>';
endwhile;

// Reset Post Data
wp_reset_postdata();

}

add_shortcode('posts', 'posts_shortcode'); 
```

和

```
function posts_shortcode() { // From Smashingmagazine
query_posts(array('orderby' => 'date', 'order' => 'DESC' , 'showposts' => 3));
   if (have_posts()) :
      while (have_posts()) : the_post();
         $return_string = '<a href="'.get_permalink().'">'.get_the_title().'</a>';
      endwhile;
   endif;
   wp_reset_query();
   return $return_string;
}

function register_shortcodes(){
   add_shortcode('posts', 'posts_shortcode'); 
} 
```

乃至

```
function wptuts_recentpost($atts, $content=null){ // From WP Tuts+

    $getpost = get_posts( array('number' => 1) );

    $getpost = $getpost[0];

    $return = $getpost->post_title . "<br />" . $getpost->post_excerpt . "…";

    $return .= "<br /><a href='" . get_permalink($getpost->ID) . "'><em>read more →&lt;/em></a>";

    return $return;

}
add_shortcode('newestpost', 'wptuts_recentpost'); 
```

所有这些似乎都不起作用。我怀疑它与循环或其他东西有关。如果我删除循环并且只做类似的事情

```
return 'hey there'; 
```

在函数（）中，那么它工作得很好。

有任何想法吗？

**编辑：** 使用以下简码：

```
function posts_shortcode() { // From Smashingmagazine
query_posts($args);
   if (have_posts()) :
      while (have_posts()) : the_post();
        $return_string = '<a href="'.get_permalink().'">'.get_the_title().'</a>';
      endwhile;
   endif;
   wp_reset_query();
   return $return_string;

}

add_shortcode('posts', 'posts_shortcode'); 
```

我设法得到了一些结果，但它现在显示带有指向我的首页的链接的文本主页。首先，我不明白为什么......其次，当我用'posts_per_page = 5'替换$args时，它又消失了。我真的认为由于某种原因循环有问题..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T22:54:37.873

不要使用第一个。您永远不应该在简码函数中回显任何内容。

最后一个只会打印一篇文章。此外，我认为它应该是 array('numberposts' => 1) ，而不是 array('number' => 1)。

第二个应该可以工作，但是您将 add_shortcode 包装在一个函数中，因此您需要在某个时候调用它。例如 add_action( 'init', 'register_shortcodes' ); 或将 add_shortcode 直接放入functions.php。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-25T15:58:13.867

这对我来说很好用

```
add_shortcode( 'objectx-pages-list', 'objectx_pages_list_func' );
function objectx_pages_list_func( $atts ) {
global $post;
ob_start();
extract( shortcode_atts( array('ids' => '1186'), $atts ) );
$id_array = explode(',', $ids); 
$pages_query = new WP_Query( array(
    'post_type' => 'page',
    'post__in' => $id_array,
    'order' => 'ASC',
    'orderby' => 'title',
) );
if ( $pages_query->have_posts() ) { ?>
<div class="carousel-wrapper">
<div class="owl-carousel owl-theme carousel-1" id="carousel-rooms">
<?php while ( $pages_query->have_posts() ) : $pages_query->the_post();
$featured_image = wp_get_attachment_url( get_post_thumbnail_id($post->ID) );
?>
<div <?php post_class('item'); ?> id="post-<?php the_ID(); ?>">
    <div class="row">
        <div class="col-md-7">
            <div class="img-rooms">
                <a href="<?php the_permalink(); ?>">
                <img class="img-responsive wp-post-image" src="<?php echo $featured_image; ?>"></a>
            </div>
        </div>
    <div class="col-md-5">
        <div class="detail-rooms">
            <h2 class="title-room "><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h2>
            <?php the_excerpt(); ?> 
        </div>
    </div>
    </div>
</div>
<?php endwhile; ?>
</div>
</div>
<?php $myvariable_pages = ob_get_clean();
wp_reset_postdata();
return $myvariable_pages;
    }
} 
```

**短代码**

```
[objectx-pages-list id="15,16,17"] 
```

# c++ - 向量下标超出范围 - 冒泡排序 - 改进

> ID：12231707
> 
> 赞同：0
> 
> 时间：2012-09-01T21:49:13.317
> 
> 标签：c++, vector, sorting

我有这段代码实现了数组的冒泡排序。在 MS VS 2012 中编译它可以工作到一定程度：

UPD：我添加了很多检查来跟踪发生崩溃的确切位置，就像这样：它交换数组的前两个元素，打印出交换了这些元素的数组，然后打印出“正在检查”并因“向量下标超出范围”而崩溃

```
#include "stdafx.h"
#include <stdio.h>
#include <iostream>
#include <stdlib.h>
#include <vector>
using namespace std;

int Check(vector<int> Array)
{
printf ("Checking: \n");
for (int i = 0; i < Array.size(); i++)
    if((int*) Array[i] == NULL)
    {
        cerr << "Array [" << i << "] is fubared";
        return -1;
    }
}

int PrintOut(vector<int> Array)
{
printf ("Your array appears to be as follows: \n");
for (int i = 0; i < Array.size(); i++)
    printf("%d  ", Array[i]);
return 0;
}

int bubble_sort()
{
int or_size = 2;
int i, j, size, temp;

printf("Specify array size\n");
scanf_s("%d", &size);
printf(" Now, input all elements of the array \n");

vector<int> Array(size, 0);
if (size > or_size)
    Array.resize(size);

for (i = 0; i < size; i++)
{
    printf("Array [%d] is now re-initialised as ", i);
    scanf_s("%d", &temp);
    printf("\n");
    Array[i] = temp;
}

Check(Array);

PrintOut(Array);

for (i = 1; i < size; i++)
    for (j = 0; j < size-i ; j--)
    {
        printf ("Attempting to swap Array[%d], which = %d, and Array [%d], which = %d \n",j, Array[j], j+1, Array[j+1]);
        if (Array[j] > Array[j+1])
        {
            Array[j]+=Array[j+1];
            Array[j+1] = Array[j] - Array[j+1];
            Array[j] = Array[j] - Array[j+1];
            printf("Swapped \n");
        }
        PrintOut(Array);
        Check(Array);
    }

printf ("\n Your Array has been bubble_sorted and should know look like this: \n");
for (i = 0; i < size; i++)
    printf("%d ", Array[i]);

Array.clear();

return 0;
}

int main()
{
    bubble_sort();
    return 0;
} 
```

它一定很简单，但我无法触及。

PS现在没有尴尬的_asm ;-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:15:02.993

您的代码对我来说有点奇怪，使用`cout`and`cin`而不是`printf`and`scanf`但除此之外，您还有以下内容：

```
for (j = 0; j < size-i ; j--) {...} 
```

因此，对于第一项`j`为 0，然后它将递减为 -1，并且由于`operator[]`take`vector`并且`std::size_t`它是无符号类型，它将被解释为 0xFFFFFFFF，这是一个非常大的值和比您的向量大小大得多的大索引，因此您得到“向量下标超出范围”

# rally - SDK2 p3：当前跨应用消息传递的解决方案

> ID：12231708
> 
> 赞同：2
> 
> 时间：2012-09-01T21:49:20.130
> 
> 标签：rally

当前在 2.0p3 中跨 Rally 应用程序的消息传递解决方案是什么？

[根据这个（可能现在已弃用）示例](https://gist.github.com/2845161)，Rally.Messages 或 window.parent.Rally.Messages 似乎都不再可用

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T01:28:44.827

没错，API 在 2.0p3 中已更改为获取 MessageBus 实例。您现在可以调用 Rally.environment.getMessageBus() 来获取它。伴随着这一变化而来的是不同应用程序相互发送和接收消息的能力。

*   马特

# javascript - 何时使用 Meteor.methods 和使用存根

> ID：12231712
> 
> 赞同：33
> 
> 时间：2012-09-01T21:51:25.947
> 
> 标签：javascript, node.js, meteor, stubs

使用 Meteor，我试图了解何时使用服务器端`Meteor.methods()`，同时仍保留即时 UI 更新。

从 Andrew Scala 的[介绍性教程](http://andrewscala.com/meteor/)中，他声称`Meteor.methods()`当您想要更新和修改数据库文档时应该使用它：

> 这个想法是您在服务器上定义所有执行危险操作（如修改和更新数据）的函数，然后让客户端调用这些函数并像常规函数一样获取返回值。客户永远不会看到实现，也不会亲自修改数据。服务器完成所有工作。

并按照这个建议，我在我的代码中实现了这个：

服务器端：

```
Meteor.methods({

  addMovie: function(data) {
    var movie = Movies.insert({name: data});
    return movie;
  },

  ... 
```

客户端：

```
Template.movies.events = ({

  'click #add-movie': function(e) {

    var name = document.getElementById('movie-name').value;
    Meteor.call('addMovie', name);

    return false;

  }, 

  ... 
```

这有效，但速度很慢。UI 不会像您`Movies.insert()`在客户端调用时那样立即更新。[文档](http://docs.meteor.com/#meteor_methods)表明，要纠正问题，您可以在客户端创建存根：

> 在客户端调用方法定义了与同名服务器方法关联的存根函数。如果您不想，您不必为您的方法定义存根。在这种情况下，方法调用就像其他系统中的远程过程调用一样，您必须等待来自服务器的结果。

但是这些存根应该是什么样子？它应该基本上看起来与服务器端方法相同吗？如果是这样，有什么意义？我正在寻找对 的用途和目的`Meteor.methods()`、存根的要点/用途及其实现的更全面的解释。

**编辑：大卫格林斯潘帮助澄清了 Meteor.methods() 和[流星谈话上的](https://groups.google.com/forum/#!topic/meteor-talk/BB-AfAYY52g)存根的使用。**

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-30T18:27:36.140

这是另一个例子。

假设您正在编写宾果游戏，然后单击按钮调用“house！”.. 在单击事件中，您可能会调用方法，例如

```
Method.call("callHouse"); 
```

这将调用服务器方法：

```
// on the server
Meteor.methods({
  callHouse: function () {
    if (currentGame.isInProgress) {
      currentGame.winner = this.userId;
      currentGame.end();
    }
  }
}); 
```

如果您是第一个调用“house”的人，该方法会将您标记为获胜者.. 但是，让我们假设该方法非常慢并且您的客户端应用程序正在等待.. 您有 99% 的把握服务器会确认您是获胜者-您只想更新用户的屏幕而无需等待..在这种情况下实现客户端存根：

```
// on the client
Meteor.methods({
  callHouse: function () {
    currentGame.winner = Meteor.userId();
    // add any other side-effects you expect to occur here
  }
}); 
```

当服务器结果返回时，如果返回的数据与你在存根中设置的不同，它会更正它并相应地刷新屏幕。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-10-25T04:19:41.627

简而言之 ：

在推送到服务器的文件中定义一些方法（Meteor.methods）将在服务器上执行实际工作，在推送到客户端的文件中定义一些方法（Meteor.methods）以获得客户端上的“即时”行为（例如加载指示器），直到服务器将生成的更改推送回客户端

这是大卫的原始帖子：

> 嗨，本，
> 
> 原则上，一种方法可以在客户端和服务器上执行完全不同的操作，例如在客户端上显示加载指示器并与服务器上的远程 API 对话。在客户端调用 Meteor.methods 定义客户端行为，在服务器调用 Meteor.methods 定义服务器行为。
> 
> 对于在数据库上操作的方法，通常相同的实现将适用于两者。客户端版本影响客户端数据库（订阅文档的浏览器端“缓存”），服务器端版本影响真实数据库。当客户端收到回复时，它会“捕捉”到服务器端突变的结果；客户端数据库突变被丢弃（或撤消，取决于您如何看待它）。如果客户端方法调用其他方法，这些辅助调用*不会*远程到服务器。服务器端版本将在服务器上调用相同的方法，或者不调用它认为合适的方法。
> 
> 因此，您提供的任何客户端方法 impl 都只是一个“模拟”，并且不必是准确的（它可能无法准确）。希望您通常免费获得模拟 impl，因为它与服务器 impl 相同！
> 
> 这回答了你的问题了吗？
> 
> - 大卫

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-07-21T00:10:52.900

如果您在客户端/服务器共享的文件上定义一个方法，就像`/collections`它不会被两者访问并自动存根？

所以：

`/collections/houses.js`

```
Meteor.methods({
  callHouse: function () {
    if (currentGame.isInProgress) {
      currentGame.winner = this.userId;
      currentGame.end();
    }
  }
}); 
```

这对客户端和服务器都可用。如果没有通过，服务器将自动拒绝客户端更新/恢复它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-08-12T21:05:22.323

正如丹尼尔所说，您可以在文件上定义一个方法，该方法不在客户端或服务器目录中，并且在双方都可用。您还可以使用`isSimulation`布尔值进行额外检查。例如，它可能看起来像这样：

```
Meteor.methods({
  addMovie: function (movieData) {
    if (!this.isSimulation) {
      check(movieData, someAdditionaCheckinFunc);
    }
    Movies.insert(movieData);
  }
}) 
```

因此条件分支中的代码将仅在服务器上执行。

# c++ - struct里面的C++数组，怎么处理？

> ID：12231717
> 
> 赞同：1
> 
> 时间：2012-09-01T21:52:07.063
> 
> 标签：c++, struct

我有以下结构：

```
struct Node 
{
    double linkCost[8];
    int val;
    Node *prevNode;
}
nodeBuf = new Node(); 
```

我可以通过以下方式访问 Node.val：

```
nodeBuf->val 
```

但 linkCost 不是那样工作的。我应该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T21:54:08.377

```
nodeBuf->linkCost[index] = value 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T22:00:53.730

```
struct Node 
{
    double linkCost[8];
    int val;
    Node *prevNode;
} 
```

尝试这样声明它以获得更好的对齐：

```
struct Node 
{

    int val;
    Node *prevNode;
   double linkCost[8];
}

nodeBuf = new Node();
nodeBuf->linkcost[i] = 3.14; //set the i element. to pi 
```

# javascript - Javascript中的Google Maps API，绘制圆的半径？

> ID：12231725
> 
> 赞同：8
> 
> 时间：2012-09-01T21:53:24.600
> 
> 标签：javascript, google-maps, geometry

我正在寻找一种方法来绘制圆的半径或从圆心到圆的边缘的线（以度为单位的精确坐标）。

是否可以？如何？

目前，我用 API 从地图中心画了一个圆圈。我不认为它有帮助......

我会做的例子：http: [//twitpic.com/aq40vv](http://twitpic.com/aq40vv)

```
var sunCircle = {
          strokeColor: "#c3fc49",
          strokeOpacity: 0.8,
          strokeWeight: 2,
          fillColor: "#c3fc49",
          fillOpacity: 0.35,
          map: map,
          center: latlng,
          radius: 1500
        };
        cityCircle = new google.maps.Circle(sunCircle) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-02T00:56:05.697

试试这个（不确定这是否是你要求的）

**HTML：**

```
<div id="map_canvas"></div>​ 
```

**JS：**

```
var map;
var latlng = new google.maps.LatLng(-34.397, 150.644);
function initialize() {
    var mapOptions = {
        center: latlng,
        zoom: 9,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    var el=document.getElementById("map_canvas");
    map = new google.maps.Map(el, mapOptions);

    var marker = new google.maps.Marker({
        map: map,
        position: latlng
    });

    var sunCircle = {
        strokeColor: "#c3fc49",
        strokeOpacity: 0.8,
        strokeWeight: 2,
        fillColor: "#c3fc49",
        fillOpacity: 0.35,
        map: map,
        center: latlng,
        radius: 15000 // in meters
    };
    cityCircle = new google.maps.Circle(sunCircle)
    cityCircle.bindTo('center', marker, 'position');
}
initialize(); 
```

[**演示**](http://jsfiddle.net/ty3PY/32/)。

**参考：** [**这里**](https://developers.google.com/maps/documentation/javascript/reference#Circle)和[**这**](http://florent.clairambault.fr/add-a-circle-overlay-to-google-maps-api-v3)也可能有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T00:48:00.990

最完美的是命名空间中的`computeOffset(from:LatLng, distance:number, heading:number, radius?:number)`函数，如[文档](https://developers.google.com/maps/documentation/javascript/reference#spherical)`google.maps.geometry.spherical`中所引用

从那里开始，只需从圆心创建一条折线，以自身的半径作为偏移量，您可以查看我在[此处](http://evalfunction.com/samples/radius_line.html)制作的一个快速示例（只需在地图上单击以查看它的工作原理）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-04-14T10:09:15.040

我同意@The Alpha

```
 // The marker
        var marker = new google.maps.Marker({
            position: startLatLng,
            map: map,
            icon: './img/marker.png'
        });

        var circle = {
            center: startLatLng,
            map: map,
            strokeColor: "#F26836",
            strokeOpacity: 0.2,
            strokeWeight: 2,
            fillColor: "#322F6A",
            fillOpacity: 0.2,
            radius: 50 // in meters
        };

        mapCircle = new google.maps.Circle(circle)
        mapCircle.bindTo('center', marker, 'position'); 
```

# javascript - 如何为论坛中的永久链接生成二维码？

> ID：12231730
> 
> 赞同：1
> 
> 时间：2012-09-01T21:53:56.303
> 
> 标签：javascript, greasemonkey, qr-code, permalinks, userscripts

我想使用 QR 码来简化使用我的 android 智能手机浏览某些论坛的过程。

我正在寻找一个 Greasemonkey 脚本，它在论坛主题的每个永久链接、每个帖子的每个永久链接旁边放置一个 QR 码。

我有一些模板可以使用，YouTube 'share' QR 脚本：

```
var shareBoxCheckInterval   = setInterval (AddQR_Code, 200);

function AddQR_Code () {
var shareDiv    = document.querySelector ('.share-option-container .ytg-box');
if (shareDiv) {
    var qrIMG   = 'http://chart.googleapis.com/chart?chl=' 
                + window.location.href + '&chld=M%7C0&cht=qr&chs=125x125';
    var img     = document.createElement ('img');
    img.src     = qrIMG;
    img.width   = 125;
    img.height  = 125;
    shareDiv.appendChild (img);
    clearInterval (shareBoxCheckInterval);
    }
} 
```

它的作用是在 Youtube 的分享框中添加一个二维码，如下所示：

![二维码示例结果](../Images/c009596bb1695e75e5ff1587f0d1c0a8.png)

轻松将视频从 PC 传输到手机。

如何调整此代码以使用论坛永久链接，并将链接的文本*替换*为 QR 代码图像？

例如，在[Minecraft 论坛上的这个帖子中](http://www.minecraftforum.net/topic/773756-beginner-guide-and-faq/)，每条帖子的右上角都有一个小链接，上面写着“#1”、“#2”、“#3”，无穷无尽——它链接到那个特定的帖子。

用户脚本的作用是将“#1”的文字替换为链接到该帖子的二维码图像（由 Google API 生成），同时也是可点击的超链接图像（也链接到该帖子）。

然后它将为页面上的每个永久链接重复此操作。

这可能吗？如果可以，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T06:31:37.603

好的，这是**一个完整的脚本**，它遍历帖子书签并添加 QR 码。

我留下了帖子编号，因为它们在我使用的论坛上对我有用。如果您真的希望它们消失，请在该行`$(this).text (" ");`之前添加。`$(this).append (...`

注意 CSS 用于样式（好），而不是标签属性（坏）。

该脚本略微复杂，需要`withPages_jQuery`结构使其与 Google Chrome 兼容（如[userscripts](/questions/tagged/userscripts "显示标记为“用户脚本”的问题")标签所示）。

```
// ==UserScript==
// @name        _Minecraft Forum, post barcodizer
// @namespace   _pc
// @include     http://www.minecraftforum.net/topic/*
// @grant       GM_addStyle
// ==/UserScript==

function GM_scriptMain ($) {
    var postBkMarks = $("div.post_block div.post_wrap h3 span.post_id a");
    postBkMarks.each ( function () {
        var qrIMG   = 'http://chart.googleapis.com/chart?chl='
                    + encodeURIComponent (this.href)
                    + '&chld=M%7C0&cht=qr&chs=125x125'
                    ;
        $(this).append ('<img src="' + qrIMG + '">');
    } );
}

withPages_jQuery (GM_scriptMain);

GM_addStyle (
    "h3 span.post_id a img {width: 125px; height: 125px;}"
);

function withPages_jQuery (NAMED_FunctionToRun) {
    //--- Use named functions for clarity and debugging...
    var funcText        = NAMED_FunctionToRun.toString ();
    var funcName        = funcText.replace (/^function\s+(\w+)\s*\((.|\n|\r)+$/, "$1");
    var script          = document.createElement ("script");
    script.textContent  = funcText + "\n\n";
    script.textContent += 'jQuery(document).ready(function() {'+funcName+'(jQuery);});';
    document.body.appendChild (script);
}; 
```

（适用于 FF/GM、Chrome、Tampermonkey 和其他浏览器）。

* * *

* * *

**Firefox (Greasemonkey) - 唯一**版本（可能还有Tampermonkey）更简单：

```
// ==UserScript==
// @name        _Minecraft Forum, post barcodizer
// @namespace   _pc
// @include     http://www.minecraftforum.net/topic/*
// @require     http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js
// @grant       GM_addStyle
// ==/UserScript==

var postBkMarks = $("div.post_block div.post_wrap h3 span.post_id a");
postBkMarks.each ( function () {
    var qrIMG   = 'http://chart.googleapis.com/chart?chl='
                + encodeURIComponent (this.href)
                + '&chld=M%7C0&cht=qr&chs=125x125'
                ;
    $(this).append ('<img src="' + qrIMG + '">');
} );

GM_addStyle (
    "h3 span.post_id a img {width: 125px; height: 125px;}"
); 
```

# python - 只允许一个 python 脚本实例？

> ID：12231733
> 
> 赞同：8
> 
> 时间：2012-09-01T21:54:12.470
> 
> 标签：python, linux, locking, singleton, centos

我有一个 python 脚本，我只想允许在机器上运行一次。如果它已经在运行，无论它是在后台运行还是在不同的 ssh 会话中运行，我希望它打印类似“错误，已经在运行”之类的内容。我该怎么做？这是我的脚本。

```
import urllib, urllib2, sys
num = sys.argv[1]
print 'Calling'
phones = [
'http://phone1/index.htm',
'http://phone2/index.htm',
'https://phone3/index.htm',
'https://phone4/index.htm',
'https://phone5/index.htm'
]
data = urllib.urlencode({"NUMBER":num, "DIAL":"Dial", "active_line":1})
while 1: 
    for phone in phones:
        try:
            urllib2.urlopen(phone,data) # make call
            urllib2.urlopen(phone+"?dialeddel=0") # clear logs
        except: pass 
```

PS 如果这很重要，我正在使用 CentOS 5。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T21:57:35.930

1.  您可以对文件实施锁定。
2.  在执行开始时创建一个临时文件，并在运行脚本之前检查该文件是否存在。

请参阅此帖子以获取答案[- 检查 python 脚本是否正在运行](https://stackoverflow.com/questions/788411/check-to-see-if-python-script-is-running)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T23:00:01.977

您可以安装[单个](http://pypi.python.org/pypi/single/)软件包，`pip install single`该软件包将使用咨询锁来确保只有一个命令实例将运行，而不会留下陈旧的锁文件。

您可以像这样在脚本上调用它：

```
single.py -c long-running-script arg1 arg2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T22:06:18.797

您可以在脚本开始时使用例如[flock](http://docs.python.org/library/fcntl.html#fcntl.flock)锁定现有文件。然后，如果相同的脚本运行两次，最新启动的将阻塞。另请参阅[此问题](https://stackoverflow.com/questions/3918385/flock-question)。

# mysql - mysql“在哪里”自动区分？

> ID：12231740
> 
> 赞同：0
> 
> 时间：2012-09-01T21:54:46.897
> 
> 标签：mysql, where

我有点失落。这是我的查询：

```
SELECT id, title FROM products WHERE id IN (4,2,6,4,2); 
```

查询将只产生 3 条记录。

如何获取所有 5 条记录（在这种情况下，我确实想查看重复项）。

非常感谢。

**更新：** 抱歉不够准确。感谢您的评论，确实我没有正确理解“IN”。

这是我的数据：

```
---------------------
|  id |  title      |
---------------------
|  2  |  product_2  |
---------------------
|  4  |  product_4  |
---------------------
|  6  |  product_6  |
--------------------- 
```

我的意图是接收以下数据，因为我有一个 id 列表：

```
---------------------
|  id |  title      |
---------------------
|  4  |  product_4  |
---------------------
|  2  |  product_2  |
---------------------
|  6  |  product_6  |
---------------------
|  4  |  product_4  |
---------------------
|  2  |  product_2  |
--------------------- 
```

所以我有一个 id 列表并希望收到产品的标题。理想情况下，甚至应该保留订单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:02:01.917

我觉得你的概念有问题`In`

假设您有一个包含此值的简单表

```
id
--
1
2
3
4
5 
```

如果你这样做

```
select id from simplyTable where id in (2,3,4,2,3,4) 
```

你会得到

```
id
2
3
4 
```

那是因为`IN`语句 in`where`是一个过滤器，决定显示或不显示一行。如果您输入重复值，SQL 将忽略它，因为当找到第一个值并检查匹配时，它将显示该行，并且不会继续检查其他值所以，您需要为每个数字输入一次时间，如果你把它重复，它不会显示更多次。

如果您需要重复某些值，一种方法是使用`UNION ALL`

```
select id from simplyTable where id in (2,3,4)
union all
select id from simplyTable where id in (2,3,4) 
```

这将返回您：

```
id
2
3
4
2
3
4 
```

不要`UNION` 只使用，因为它会应用一个不同的，并且每个值只会返回一次。 `UNION`将让您显示重复的值，因为您在一个结果中显示查询的结果，我认为这就是您所期望的。

在这种情况下，您的查询将是：

```
SELECT id, title FROM products WHERE id IN (4,2,6);
UNION ALL
SELECT id, title FROM products WHERE id IN (4,2) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T01:33:18.460

## 加入临时表

[**SqlFiddle**](http://sqlfiddle.com/#!2/4280c/3/0)：

```
DROP   TABLE IF EXISTS num;
CREATE TABLE num (i INT);    
INSERT INTO  num (i) VALUES (4),(2),(6),(4),(2);

SELECT id, title
FROM   num, products
WHERE  id = i; 
```

灵感来自[另一个答案](https://stackoverflow.com/a/273703/471214)。

# javascript - 关于同源政策的关于：空白的起源

> ID：12231741
> 
> 赞同：5
> 
> 时间：2012-09-01T21:54:53.967
> 
> 标签：javascript, google-chrome

同源策略规定如果两个页面共享协议、主机和端口，则它们可以共享 JavaScript 资源。

`about:blank`Chrome中页面的来源是什么？即页面的协议、主机和端口是什么？它可以与哪些页面共享 JavaScript 资源？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T22:19:13.710

该`about:`方案被认为是为了创建[一个唯一的来源](http://code.google.com/searchframe#OAMlx_jo-ck/src/third_party/WebKit/Source/WebCore/platform/SchemeRegistry.cpp&exact_package=chromium&type=cs&l=68)，它[不允许](http://code.google.com/searchframe#OAMlx_jo-ck/src/third_party/WebKit/Source/WebCore/loader/CrossOriginAccessControl.cpp&exact_package=chromium&type=cs&l=146)访问*任何*资源——甚至`about:blank`是它自己。

# php - 如何在 php/mysql 中使用 while 循环从特定列中获取值？

> ID：12231742
> 
> 赞同：3
> 
> 时间：2012-09-01T21:55:03.367
> 
> 标签：php, mysql

我再次为我的 PHP 结构而苦苦挣扎，你们给了我很多帮助。提前致谢。现在我对自己有了新的挑战。我的数据库中有下表：

```
 id |     htl_name    |      city_zone     |   price    |   given_date
------------------------------------------------------------------------
  1  | Hotel Beach Inn |   Cityzone1        |  10.00     |   2012-09-01
  2  | Hotel Beach Inn |   Cityzone1        |  10.00     |   2012-09-02
  3  | Hotel Beach Inn |   Cityzone1        |  10.00     |   2012-09-03
  4  | Hotel Beach Inn |   Cityzone1        |  11.00     |   2012-09-04
  5  | Hotel Beach Inn |   Cityzone1        |  11.00     |   2012-09-05
  6  | Hotel City Inn  |   Cityzone1        |  15.00     |   2012-09-01
  7  | Hotel City Inn  |   Cityzone1        |  15.00     |   2012-09-02 
  8  | Hotel City Inn  |   Cityzone1        |  16.00     |   2012-09-03
  9  | Hotel City Inn  |   Cityzone1        |  16.00     |   2012-09-04
 10  | Hotel City Inn  |   Cityzone1        |  16.00     |   2012-09-05
------------------------------------------------------------------------- 
```

当用户输入入住日期、退房日期并选择城市区时，脚本将使用 PHP/MySQL 结构过滤所需的城市区和输入期间内的日期。到目前为止一切顺利，但让我们假设用户输入：

入住时间：2012-09-01

退房时间：2012-09-05

城市区域：Cityzone1

**输出应该是：**

**结果 1**

酒店：海滩旅馆

晚：4

入住时间：2012-09-01

退房时间：2012-09-05

Total Rate: 42.00 --> 这不包括第一晚的价格，因为晚上的数量从第二晚开始计算

**结果 2**

酒店：城市客栈

晚：4

入住时间：2012-09-01

退房时间：2012-09-05

Total Rate: 67.00 --> 这不包括第一晚的价格，因为晚上的数量从第二晚开始计算

到目前为止，我已经完成了以下脚本：

```
//MySQL Select structure that apply filter on user's entered information

$filter1=mysql_query("SELECT * FROM.........  ORDER BY htl_name, city_zone, given_date LIMIT 1");
$filtern=mysql_num_rows($filter1);
...
if($filtern>=1){
  While($row=mysql_fetch_array($filter1){
     $first_hotel_found=$row['htl_name'];
  }

  // New filter but listing everything within the date period

  $new_filter=mysql_query("SELECT * FROM ........ORDER BY htl_name, city_zone, given_date");
  $final_price=0; 
  $output="";
  while($row=mysql_fetch_array($new_filter){
     $htl_name=$row['htl_name'];
     $price=$row['price'];

     $final_price=$final_price+$price;

     if($htl_name!==$first_hotel_found){
        output .='Hotel:'.$htl_name.'<br/>';
        ... NO WORRIES WITH NUMBER OF NIGHTS AND CHECK-IN / CHECK-OUT DATES
        output .='Total Rate:'.$final_price.'<br/>';
        //after output the result go back clean up the $final_price and start adding again for the new Hotel
        $final_price=0;
        //$first_hotel_found assumes the actual $row
        $first_hotel_found=$row['htl_name'];
      }

    } // End of the while

}else{
     echo "There are no rates available for the information entered!";
     } 
```

}

```
.... HTML portion ....

<body>
  <?php echo $output; ?>
</body>
</html> 
```

问题是输出没有列出两家酒店，而是列出了最后一家酒店的名称和第一家酒店的总价格：

酒店：城市客栈

晚：4

入住时间：2012-09-01

退房时间：2012-09-05

总价：42.00

我将不胜感激任何能引导我完成项目的帮助。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T22:38:10.683

这个条件

```
if($htl_name!==$first_hotel_found){ 
```

当 $htl_name 第一次是 Hotel City Inn 时（如果第一家酒店是 Hotel Beach Inn），则为真。您应该打印 $htl_name 而不是 $first_hotel_found。

您将永远不会打印有关第二家酒店的信息，因为同样的情况将永远不会再次成立。如果您添加第三家酒店，那么当 $htl_name 第一次是该酒店时，它将是正确的。为了解决这个问题，您也可以将创建输出的代码复制到循环外部，以最后一次执行它：

```
output .='Hotel:'.$htl_name.'<br/>';
... NO WORRIES WITH NUMBER OF NIGHTS AND CHECK-IN / CHECK-OUT DATES
output .='Total Rate:'.$final_price.'<br/>';
//after output the result go back clean up the $final_price and start adding again for the new Hotel
$final_price=0;
//$first_hotel_found assumes the actual $row
$first_hotel_found=$row['htl_name']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T22:28:21.423

这里：

```
if($filtern>=1){
  While($row=mysql_fetch_array($filter1){
   $first_hotel_found=$row['htl_name'];
} 
```

您正在设置第一家酒店，`$first_hotel_found`稍后您将进入该循环：

```
 while($row=mysql_fetch_array($new_filter){ 
```

你有里面`if($htl_name!==$first_hotel_found)`

由于上面您已经设置了`$first_hotel_found`与第一个结果的比较是错误的，并且第一家酒店没有显示在结果中。

# c# - 为什么我的控件无法在代码隐藏中访问？

> ID：12231743
> 
> 赞同：2
> 
> 时间：2012-09-01T21:55:43.037
> 
> 标签：c#, wpf, visual-studio-2012

当我在 VS 2010 中创建 WPF 应用程序并在 Grid 中放置一个按钮时，我可以从 C# 代码访问控件。我的按钮类实例变量与 XAML“名称”字段中的名称相同。但是当我使用 VS 2012 RC 创建 WPF 项目时，我看不到控件的实例。可能是什么问题？VS 2010 和 2012 之间是否有任何默认项目设置差异？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T22:10:23.377

如果您正在谈论代码隐藏，那么您应该能够访问该按钮**而无需** 再次声明它只需使用它的`x:name`属性。现在，如果您在谈论 MVVM，那么您应该在使用按钮之前设置您的数据上下文。

当我使用 2012 (Release Candidate) 时，当我尝试访问在 xaml 中声明的元素时，我没有得到代码隐藏 cs 文件的智能感知（我必须在没有它的情况下编写代码），它甚至暗示没有该名称的元素，**但项目编译和工作**。所以我建议你尝试在没有智能感知的情况下编写代码并编译它。

```
YourButton.IsEnabled = false; 
```

我想这是默认情况下在 VS 2012 中鼓励使用 MVVM 的，但这只是想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T20:42:19.337

您需要确保您没有以静态方法访问控件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T17:12:17.070

我有同样问题的另一种经历。

当我尝试从后面的代码中访问元素时，没有智能感知显示它，我也无法使用它的方法。所以我尝试调试该项目，我发现有一个问题是合乎逻辑的并且不是语法错误，因此它没有显示在 XAML 代码或任何地方。我修复了它，然后我能够从后面的代码中访问它。确保您尝试访问的元素已正确定义并且具有逻辑正确的属性。

```
<ComboBox x:Name="_days" Selected="0"  Width="50"/> 
```

这是代码，Selected 属性在逻辑上不正确，因为组合框中没有元素，您不能选择第 0 个元素。

# android - 如何在 onActivityResult 中调用 startActivityForResult？

> ID：12231744
> 
> 赞同：2
> 
> 时间：2012-09-01T21:55:50.267
> 
> 标签：android, android-intent, onactivityresult, startactivityforresult, activitynotfoundexception

打电话`startActivityForResult`给我`ActivityNotFoundException`。我想知道是否可以在`startActivityForResult`里面打电话`onActivityResult`？如果是，那么我的代码可能有什么问题：

这是代码：

```
OnPreferenceClickListener selectListener = new OnPreferenceClickListener() {

        public boolean onPreferenceClick(Preference preference) {
            Intent photoPickerIntent = new Intent(Intent.ACTION_PICK);
            photoPickerIntent.setType("image/*");
            photoPickerIntent.putExtra("crop","true");
            startActivityForResult(photoPickerIntent, 123);
            return false;
        }

    };

    protected void onActivityResult(int requestCode, int resultCode, Intent resultIntent) { 
        super.onActivityResult(requestCode, resultCode, resultIntent);

        if(requestCode == 123){
            if(resultCode == RESULT_OK){
                Uri selectedImage = resultIntent.getData(); // uri from user selection.
                File tempFile; // temporary File
                Uri tempUri; // temporary Uri

                try {
                    // initializing File
                    tempFile = File.createTempFile("crop", ".png", Environment.getExternalStorageDirectory());
                } catch (IOException e1) {
                    tempFile = null;
                }

                if(tempFile != null){
                    // initializing Uri
                tempUri = Uri.fromFile(tempFile);   
                }else{
                    tempUri = selectedImage;
                }

                Display display = getWindowManager().getDefaultDisplay(); 
                int width = display.getWidth();
                int height = display.getHeight();

                // creating new crop intent
                final Intent cropIntent = new Intent("com.android.camera.action.CROP");
                cropIntent.setData(selectedImage); // original image Uri
                cropIntent.putExtra("outputX", width);
                cropIntent.putExtra("outputY", height);
                cropIntent.putExtra("aspectX", width);
                cropIntent.putExtra("aspectY", height);
                cropIntent.putExtra("scale", true);
                cropIntent.putExtra("noFaceDetection", true);
                cropIntent.putExtra("output", tempUri);  // cropped image Uri
                cropIntent.putExtra("outputFormat", "png");
                startActivityForResult(cropIntent, 456);
            }

        if(requestCode == 456){
            if(resultCode == RESULT_OK){
                System.out.println("inside request code 456");
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T22:10:36.147

我已经通过删除解决了这个错误`photoPickerIntent.putExtra("crop","true");`。

# machine-learning - 如何使用训练集评估 NMF？

> ID：12231746
> 
> 赞同：0
> 
> 时间：2012-09-01T21:55:58.950
> 
> 标签：machine-learning, evaluation, collaborative-filtering, factorization

测试非负矩阵分解预测的正确方法是什么？假设数据集是一个包含用户和观看电影（没有评分）的矩阵。首先，我将矩阵拆分为训练集和测试集（40% 的测试集）。然后我用 NMF 分解训练矩阵。然后我取测试矩阵，删除所有电影条目的一半，看看真实的测试矩阵重建得有多好。

NMF 还使用了哪些其他评估方法？有没有比删除测试集中的电影条目更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T22:06:56.810

我认为这与您上次提出的问题基本相同。NNMF 只是实现协同过滤的一种手段。评估低秩矩阵分解的保真度不是评估协同过滤结果的方法。低秩分解的要点在于它与输入并不完全相同。

您使用您已经熟悉的精度、召回率、AUC 等度量。您不会进一步拆分测试集，不 - 您没有制作交叉验证集或任何东西。所以我不知道这个点是什么。只需按原样使用测试集作为您的“相关”数据集。

# php - 用手指在移动 Web 应用程序中滑动页面

> ID：12231748
> 
> 赞同：1
> 
> 时间：2012-09-01T21:56:33.400
> 
> 标签：php, android, mysql, jquery-mobile, uislider

有没有办法在移动 Web 应用程序的页面之间滑动而不是单击按钮或链接？我做了很多搜索，没有一个移动网络框架有这个功能。那怎么可能呢？或者我可以直接从没有（webview）的Android应用程序连接到我的PHP或我的（MYSQL）数据库吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:13:31.670

看看[jQuery Mobile 站点](http://jquerymobile.com)（尤其是[事件部分](http://jquerymobile.com/demos/1.1.1/docs/api/events.html)）或它的老大哥[jQuery](http://jquery.com)。

此外，[Apache Cordova](http://www.phonegap.com) - 以前称为**PhoneGap** - 可能会有所帮助。

# java - JTextField 和 HTML 标签

> ID：12231750
> 
> 赞同：4
> 
> 时间：2012-09-01T21:56:37.083
> 
> 标签：java, html, swing, jtextfield

我正在研究 Java 7。我正在尝试使用 HTML 标记来格式化文本。我将文本传入

```
JTextField text = new JTextField();
text.setText("<html><body><p>The program performs encryption operations on the following ciphers: </p></body></html>"); 
```

但是程序也会打印 HTML 标签。该文本示例只是一个示例。可能是什么问题？干杯

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-01T22:05:30.913

`JTextField`不[支持 HTML](https://stackoverflow.com/questions/5915061/html-in-jtextarea-of-jeditorpane-jtextpane)。您可以`JTextPane`改用：

```
JTextPane text = new JTextPane();
text.setContentType("text/html");
text.setText("<html><body><p>The program performs encryption operations on the following ciphers: </p></body></html>"); 
```

# database - Google App Engine 数据库代码 - 独立于网站运行

> ID：12231751
> 
> 赞同：-1
> 
> 时间：2012-09-01T21:56:43.170
> 
> 标签：database, google-app-engine

如何在没有人向服务器发送 GET 请求的情况下，任意间隔执行 Python 代码？

收集和维护用户数据的正确方法是什么？

我编写了一个网站，可以让您创建音乐博客。我现在没有从用户那里收集太多数据。例如，每个博客都没有最后更新的字段。但是现在网站已经上线，我想开始生成其中的一些东西。

例如，我所要做的就是为每个博客，查看所有歌曲，排序`date added`，然后那将是最后一次修改。但我敢肯定这是一项成本略高的手术，所以我可能只想每天做一次。

我应该如何处理？

构建了一个涵盖所有内容的处理程序，然后编写一个 Python 机器人，例如连接到`www.mywebsite.com/admin/updateDbInfo`？似乎不优雅。

我在 Google App Engine 中遗漏了什么可以让您每隔一段时间任意执行代码吗？

这是人们收集数据的方式吗？吨

明智的做法是在我设计网站时将所有这些构建到模型中。我明白了，但这是一次学习经历，而我没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T22:33:37.880

AppEngine 允许您设置计划任务，以您选择的频率运行：[Python](https://developers.google.com/appengine/docs/python/config/cron)文档和[Java](https://developers.google.com/appengine/docs/java/config/cron)文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T22:49:54.177

你在正确的轨道上！阅读有关[cron 作业](https://developers.google.com/appengine/docs/python/config/cron)和[后端](https://developers.google.com/appengine/docs/python/backends/)的信息。首先编写一个处理程序来检索和分析您想要查看的任何数据，并将其映射到一个 URL，就像其他任何数据一样。然后，您可以通过将其添加到根目录中的文件来安排它作为[cron 作业运行。](https://developers.google.com/appengine/docs/python/config/cron)`cron.yaml`确保您[保护 URL](https://developers.google.com/appengine/docs/python/config/cron#Securing_URLs_for_Cron)，以便未经授权的用户无法调用处理程序。

如果您的工作需要长时间运行，您应该使用[后端](https://developers.google.com/appengine/docs/python/backends/)，它可以在后台运行而没有请求截止日期。您可以设置 cron 作业来启动和停止后端进程。

这`cron.yaml`是我[自己的项目之一](https://github.com/ecmendenhall/Kicksaver/blob/master/cron.yaml)，以及它调用的[两个](https://github.com/ecmendenhall/Kicksaver/blob/master/kickparser.py) [脚本](https://github.com/ecmendenhall/Kicksaver/blob/master/twitterscript.py)作为示例。

# javascript - 为什么 Math.pow(1, Infinity) 返回 NaN？

> ID：12231752
> 
> 赞同：8
> 
> 时间：2012-09-01T21:57:12.757
> 
> 标签：javascript

我一直认为 1 的任何幂等于 1，但`Math.pow(1, Infinity)`返回 NaN。为什么不是1？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T22:08:21.397

这更像是一个数学问题而不是 Javascript 问题，因此您可以使用以下数学解释 ( [http://mathforum.org/library/drmath/view/53372.html](http://mathforum.org/library/drmath/view/53372.html) )：

> 当你有类似“无穷大”的东西时，你必须意识到它不是一个数字。通常你的意思是某种限制过程。因此，如果您有“1^infinity”，那么您真正拥有的是某种限制：底数并不是真正的 1，而是可能越来越接近 1，而指数可能会越来越大，例如 (x+ 1)^(1/x) 为 x->0+。
> 
> 问题是，哪个发生得更快，基数接近 1 还是指数变大？要找出答案，让我们致电：
> 
> L = lim x->0 of (x+1)^(1/x)
> 
> 然后：
> 
> ln L = lim x->0 of (1/x) ln (x+1) = lim x->0 of ln(x+1) / x
> 
> 那是什么？因为 x->0 它是 0/0 形式，所以取顶部和底部的导数。然后我们得到 lim x->0 of 1/(x+1) / 1，这 = 1。所以 ln L = 1，并且 L = e。凉爽的！
> 
> 这是真的吗？尝试插入一个很大的 x 值。或者将此限制视为 e 定义的变体。不管怎样，这是真的。极限是 1^infinity 形式，但在这种情况下它是 e，而不是 1。尝试在指数中使用 (2/x) 或 (1/x^2) 或 1/(sqrt 重复工作(x))，看看这如何改变答案。
> 
> 这就是我们称之为不确定的原因——所有这些不同版本的极限都接近 1^infinity，但最终答案可以是任何数字，例如 1、或无穷大或未定义。您需要做更多的工作来确定答案，因此 1^infinity 本身尚未确定。换句话说，1 只是 1^infinity 的答案之一。

“不确定”的答案不是数字。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T21:59:04.253

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T01:58:35.763

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-24T15:12:09.090

IEEE 754-2008 定义： `1^(+-)Inf = +1`

您使用的语言不符合标准。

# mysql - mysql数据文件夹权限

> ID：12231755
> 
> 赞同：0
> 
> 时间：2012-09-01T21:58:30.033
> 
> 标签：mysql, permissions

当我尝试启动服务 MySQL55 时，我收到一条错误消息：

> 无法在本地计算机上启动 MySQL55 服务
> 错误 1067：进程意外终止

我运行了进程监视器，它向我显示拒绝访问：

```
 C:\Documents and Settings\All Users\Application Data\MySQL Server 5.5\data\JIMSDESKTOP.PID 
```

这是我拥有的当前权限设置：

```
 FILEACL "C:\Documents and Settings\All Users\Application Data\MySQL\MySQL Server 5.5\data" /S "JIMSDESKTOP\Administrator":RrRaRepWwAWaWePXDDcO /S "JIMSDESKTOP\ASPNET":RrRaRepWwAWaWe /S "JIMSDESKTOP\IUSR_JIMSDESKTOP":RrRaRepWwAWaWe /S "JIMSDESKTOP\Jim":RrRaRepWwAWaWePXDDcO /S "NT AUTHORITY\NETWORK SERVICE":RrRaRepWwAWaWe /S "NT AUTHORITY\SYSTEM":RrRaRepWwAWaWePXDDcO /REPLACE /PROTECT 
```

MySQL 使用什么用户来尝试访问 JIMSDESKTOP.PID ？

如何确保 MySQL 具有适当的权限？

在进程监视器中，我应该过滤除 mysqld.exe 之外的其他内容吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T01:18:25.553

我发现 Process Monitor 允许我添加另一个名为 User 的列。在说访问被拒绝的行上，它说用户是 NT Authority\System。我意识到这是一个特殊的权限，我认为我不能将它添加到目录权限中。我添加了网络（完全控制）和系统（完全控制）。如您所见，我让用户 Jim 拥有完全控制权，ASPNET 拥有完全控制权，管理员拥有完全控制权。并且具有完全控制权的 IUSR_JIMSDESKTOP。我重新启动了电脑。该服务仍然失败并出现相同的错误。我对 MySQL 进行了修复并重新启动。我在启动 MySQL55 服务时收到了同样的错误。只是为了好玩，我将所有人添加到数据文件夹的权限并启动了服务。我意识到我不应该

# android - Linkify - 用于非 Web（内部）事件控制的链接方案

> ID：12231757
> 
> 赞同：2
> 
> 时间：2012-09-01T21:58:48.050
> 
> 标签：android, url-scheme, linkify

我正在使用 Linkify(text, pattern, scheme) 来识别对话框中显示的文本中的正则表达式。我希望这些链接能够将用户引导到我程序的其他部分。

一点背景：

我的应用程序是字典式应用程序。术语的 ListView 被散列到定义列表中。当用户点击一个术语时，定义会在 AlertDialog 中弹出。其中一些定义本身实际上包含其他术语。例子：

```
term: "dog"
definition: "A mid-sized furry domesticated animal. Not to be confused with [cat]s." 
```

在上述情况下，用户将能够单击单词“cat”，这将导致对话框关闭，并在其位置出现“cat”的定义。

问题是，Linkify() 的唯一文档谈到了打开 Web URL。我需要链接来指示程序需要转到另一个定义。

目前，我这样称呼定义：

```
 ListView lv = getListView();

  lv.setOnItemClickListener(new OnItemClickListener() { // when an item is clicked on...
    public void onItemClick(AdapterView<?> parent, View view,
        int position, long id) {

        // Linkify parameters
        Pattern pattern = Pattern.compile("\\[[^]]*]"); // defines the fact that links are bound by [square brackets]
        String scheme = ""; // *** THIS IS WHERE I NEED TO ADD A PROPER SCHEME ***

        AlertDialog alertDialog = new AlertDialog.Builder(ListProjectActivity.this).create(); // create a dialog box in memory
        alertDialog.setTitle(((TextView) view).getText()); // set title of dialog box to term name
        SpannableString definition = new SpannableString(dictionaryMap.get(((TextView) view).getText())); // grab the definition by checking against the dictionary map hash
        Linkify.addLinks(definition, pattern, scheme); // add links to definition
        alertDialog.setMessage(definition); // set dialog box message to term definition
        alertDialog.show(); // actually display the dialog box
    } 
```

我怎样才能让 Linkify() 链接调用另一个 AlertDialog？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T00:12:31.063

我认为您需要使用[ClickableSpan](http://developer.android.com/reference/android/text/style/ClickableSpan.html)。在 OnClick 方法中你可以设置你想要实现的功能。

# php - 从需要发布数据的网站获取数据

> ID：12231760
> 
> 赞同：0
> 
> 时间：2012-09-01T21:59:33.883
> 
> 标签：php, html-parsing

我是 php 新手，所以请耐心等待。

我想从网站解析一些 html 数据，我可以用[http://simplehtmldom.sourceforge.net/](http://simplehtmldom.sourceforge.net/)很容易地做到这一点。问题是我需要从网站获取数据，我需要在其中发布一些数据，这意味着我不能只使用库需要的 url。我可以使用操作并发布 ia 表单重定向到网站，但我无法获取信息。你能帮我吗？

问候杰斯珀

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:03:27.733

此代码使用[CURL](https://stackoverflow.com/questions/4947025/post-data-and-retrieve-the-response-using-php-curl)**为您的问题查询 stackoverflow**：

```
$url = 'https://stackoverflow.com/search';

$params = preparePostFields( array(
     'q' => 'Getting data from a website where posted data is required',
   ));

$ch = curl_init($url);

curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $params);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$result = curl_exec($ch);

curl_close($ch);

echo $result;

exit;

function preparePostFields($array) {
  $params = array();

  foreach ($array as $key => $value) {
    $params[] = $key . '=' . urlencode($value);
  }

  return implode('&', $params);
} 
```

关于`CURLOPT_POSTFIELDS`，请查看此[手册页](http://php.net/manual/en/function.curl-setopt.php)：

# c# - StreamReader 无法正常工作

> ID：12231764
> 
> 赞同：1
> 
> 时间：2012-09-01T22:00:39.230
> 
> 标签：c#, winforms

有人可以解释一下会发生什么吗？

温我用这个 url 代码在我的一个里面工作 Label1 post remote page

```
string url = "http://ireland.angloinfo.com/"; 
```

但是这个不是 Label1 空的

```
string url = "http://cyprus.angloinfo.com/";

string html = string.Empty;
HttpWebRequest myHttpWebRequest = (HttpWebRequest)HttpWebRequest.Create(url);
HttpWebResponse myHttpWebResponse = (HttpWebResponse)myHttpWebRequest.GetResponse();
StreamReader myStreamReader = new StreamReader(myHttpWebResponse.GetResponseStream());
html = myStreamReader.ReadToEnd();

Label1.Text = html; 
```

什么地方出了错 ？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T22:21:16.330

在收到响应之前添加以下内容：

```
 HttpWebRequest myHttpWebRequest = (HttpWebRequest)HttpWebRequest.Create(url);
    myHttpWebRequest.UserAgent = "Mozilla/5.0"; 
```

您的代码是正确的，但似乎网络服务器对`User-Agent`请求标头中未指定字段的请求返回空响应。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T22:25:08.230

我刚刚检查过，您的代码返回一个 myhttpWebResponse，Status = "OK" 和 ContentLenght = 0，所以一切正常 - 它只是返回 no-data-at-all 的服务器。问题是，为什么。也许您没有添加一些它需要的标题？

我刚刚尝试过设置：

```
string url = "http://cyprus.angloinfo.com/";

string html = string.Empty;
HttpWebRequest myHttpWebRequest = (HttpWebRequest)HttpWebRequest.Create(url);
myHttpWebRequest.UserAgent = "yummy";
HttpWebResponse myHttpWebResponse = (HttpWebResponse)myHttpWebRequest.GetResponse();
StreamReader myStreamReader = new StreamReader(myHttpWebResponse.GetResponseStream());
html = myStreamReader.ReadToEnd();

Label1.Text = html; 
```

并且页面似乎可以正确下载。顺便提一句。你为什么不使用`WebClient`类呢？在会话和重定向的情况下你会遇到更少的问题..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T22:15:56.350

这段代码怎么样：

```
 List<string> lines = new List<string>();
 StreamReader reader = new StreamReader(WebRequest.Create("http://cyprus.angloinfo.com/").GetResponse().GetResponseStream());
  string line;
  while ((line = reader.ReadLine()) != null)
  {
      lines.Add(line);
  }
  label1.Text = String.Join(" ", lines.ToArray()); 
```

# css - 设置引导无响应的 div

> ID：12231769
> 
> 赞同：0
> 
> 时间：2012-09-01T22:01:18.297
> 
> 标签：css, twitter-bootstrap

我已经从 中删除了*bootstrap-responsive.css*链接`<head>`，但我的页面仍然是响应式的。我有三个`<div class"row">`，每个都有树`<div class="span4">`来保存一些数据，一切看起来像一个 3x3 的正方形。我的分辨率是 1600x872，“正方形”看起来很完美，但是当我调整浏览器窗口的大小时，div 变得疯狂，看起来像一个矩形。我只想让 div 保持它们的位置，这意味着当我调整窗口大小时，会出现滚动条。你有解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T13:14:31.730

您是否将行包装在`.container`div 中？

当你不使用 时`.container`，当你减小屏幕宽度时，行中的`.span4`元素会给你一个“矩形”的效果。

您可以在这个 jsbin 示例上对其进行测试。顶行没有包裹在 a 内`.container`，但底行是。

[http://jsbin.com/ogogis/1](http://jsbin.com/okogis/1)

[http://jsbin.com/ogogis/1/edit](http://jsbin.com/okogis/1/edit)

```
 <!-- this row has no .container, and will 
look like a rectangle when you reduce screen width -->
       <h4>NO .container</h4>  
        <div class="row">
          <div class="span4">
            <div class="spacer200 a1"></div>
          </div>
            <div class="span4">
             <div class="spacer200 a2"></div>
          </div>
            <div class="span4">
              <div class="spacer200 a3"></div>
          </div>
        </div>  

          <div class="spacer50"></div> 

        <!-- this row does have a .container, 
             and will not give the rectangle effect -->
        <div class="container">
          <h4>.container wrapping the row</h4>  
          <div class="row">
            <div class="span4">
              <div class="spacer200 a1"></div>
            </div>
              <div class="span4">
               <div class="spacer200 a2"></div>
            </div>
              <div class="span4">
                <div class="spacer200 a3"></div>
            </div>
          </div> 
        </div> 
```

# oop - 自动将对象扩展到某个继承类

> ID：12231771
> 
> 赞同：4
> 
> 时间：2012-09-01T22:01:54.833
> 
> 标签：oop, inheritance, casting

假设我有以下声明：

```
public class ClassA
{
  public string FieldA = "Something first";
}

public class ClassB : ClassA
{
  public string FieldB = "Something second";
} 
```

众所周知，object`ClassB`可以在任何需要的地方`ClassA`使用。例如一个方法

```
public void DoSthWithObject(ClassA a); 
```

可以这样调用：

```
ClassB b = new ClassB();
DoSthWithObject(b); 
```

也可以将继承的类型转换为父类型：

```
ClassA a = (b as ClassA); 
```

所以编译器/框架知道如何“使用”`ClassB`需要的数据`ClassA`。

现在的问题是：**是否有可能以某种方式反其道而行之？**假设我有一个类型的变量，`ClassA`我想开始使用它，`ClassB`但同时保留所有`ClassB`继承自的字段`ClassA`并且不实例化新对象？我知道这将需要扩展为对象分配的内存`ClassA`以容纳`ClassB`.

简单地说，我想做这样的事情：

```
ClassA a = new ClassA();
ClassB b = (a as ClassB); // some magic happens here 
```

（我知道我可以实现`IConvertible`和使用`Convert`或提供一些克隆机制，但我想避免这样的解决方案。）

**编辑**

由于似乎答案集中在提出替代解决方案或警告我什至想按照我的意愿去做，我决定稍微改变我的问题并提出赏金，这样也许我可以获得更好的答案。

首先，我希望这与语言无关。

第二：我真的**明白**，*不是每个工具都是锤子*，我可以（我希望）将*Jack*和*Jane*区分开来。我也不需要关于基本 OOP 的课程（除非有人实际上可以证明我犯了一个基本的概念错误，而我目前显然没有意识到这一点）。我想知道的是**，自动父类到子类的转换是否以及为什么在逻辑上是不可能的**，如果它是可能的（从评论看来，有可能的语言*）*那么**为什么它是危险的/充满缺陷**。这也是非常有趣的，它实际上是如何用这些语言在技术上完成的，“支持”它（或者至少不禁止它）。

但我确实期待真正的编程示例，而不仅仅是隐喻。

只是为了说清楚：我不是在寻找有关向下转换先前向上转换的对象的信息。这不是这里的情况。

如果我是一个希望在同一个表列上同时聚合和分组的人 - 请给我看这个。我知道我很聪明，可以理解。:-) 我只是不想让这个问题留下我没有理解的关于 OOP 的基本内容的感觉。

**注意**

在大卫的回答下的评论中，我提到了*浮点数*，但实际上指的是*实数*（数学术语）。这是因为我的英语不太好。请停止挑剔。:]

**谢谢你**

我要感谢大家的回答。我决定悬赏史蒂夫，但这并不意味着我认为这个问题已经结束。我仍在寻找反对自动对象转换的论据。我必须管理，我感到有点失望的是，那些警告我最多的人无法提供与转换相关的明确示例（与铸造无关）。

根据我自己的研究，我决定在单独的答案中指出一些事情（以防有人发现它们有用）。请随时编辑和扩展列表。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T22:07:24.923

不！从类的基本描述来看，ClassA**不是**ClassB。您描述的关系不是对称/自反的。可以这样想：每个锤子都是工具，但不是每个工具都是锤子。如果您需要转动螺丝，则需要工具，但锤子无法完成这项工作。用这个类比替换上面的类定义，我认为从表面上看，为什么这种关系不起作用已经很清楚了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T22:26:40.070

我和@DavidW 在一起。
但有时继承的问题可以通过组合来解决。

请阅读这篇[维基百科文章](http://en.wikipedia.org/wiki/Composition_over_inheritance)

另一种选择是使用接口。

```
public interface IProvideSomeData
{
    string Data { get; }
}

public class ClassA, IProvideSomeData
{
  public string FieldA = "Something first";

  string IProvideSomeData.Data { 
     get { return FieldA; }
  }
}

public class ClassB : ClassA, IProvideSomeData
{
  public string FieldB = "Something second";

  string IProvideSomeData.Data { 
     get { return FieldB; }
  }
}

public class ClassC : IProvideSomeData
{
  public string FieldC = "Something second";

  string IProvideSomeData.Data { 
     get { return FieldC; }
  }
}    

public void DoSthWithObject(IProvideSomeData a); 
```

这种方式`DoSthWithObject`取决于接口，因此可重用性更高。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-04T17:00:17.463

这是特定语言的实现细节，而不是面向对象思维的固有限制。我可以想象许多需要这种行为的场景——也许 Shape 是 Rectangle，但我们决定将其更改为 Square（因为正方形是矩形的一种）。正如您所指出的，在 Java 或 C# 等经典 OO 语言中做这种事情是很痛苦的。

语言设计都是关于权衡的，而这个特殊的特性在 C# 或 Java 和许多其他 OO 语言中并没有被削减。要看看为什么...

让我们考虑一下我的 Rectangle => Square 示例。也许在我的新语言 Z## 中，我选择在内部将对象实例存储为它们所继承的对象的组合。所以我的 Rectangle 是内存中的一个 Shape 实例，+一些属性和方法。那么 Square 只是一个 Rectangle 形状实例 + 一些属性和方法。将 Rectangle 更改为 Square 很容易，因为我不需要转换任何东西 - 只需在实例化 Square 时提供现成的 Rectangle 即可。

像 C# 和 Java 这样的语言实际上并没有这样做——它们存储“扁平化”的对象实例——在 C# 中，Square 实例**在内存中****不**包含 Rectangle 实例——它只是共享 Rectangle 的**接口**。所以在这些语言中实现这个特性要慢得多，因为它们实际上必须将整个扁平结构复制到新的内存位置。

 ***** * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-10T13:57:23.500

我在 C# 中尝试解决您的问题。我尝试使用泛型（但可以使用类型参数和强制类型转换）来实现语言不可知（没有 c# 静态扩展方法）。

对于这样的全自动系统，应该使用以下逻辑创建一个新的泛型类并将其用于所有类属性：如果存在则搜索内部类，如果不存在则返回私有类（可能还需要一些自省）。

我尝试回答的场景是您第一次提交的场景：

> ClassA a = new ClassA(); ClassB b = (a as ClassB); // 这里发生了一些神奇的事情

```
using System;
namespace test
{
/// <summary>
/// Base class A
/// </summary>
public class ClassA
{
    private string prop1;

    public ClassA InternalClassA { get; set; }

    public string Prop1
    {
        get
        {
            if (this.InternalClassA == null)
            {
                return prop1;
            }
            else
            {
                return this.InternalClassA.Prop1;
            }
        }

        set
        {
            if (this.InternalClassA == null)
            {
                this.prop1 = value;
            }
            else
            {
                this.InternalClassA.Prop1 = value;
            }
        }
    }

    public T AsClass<T>() where T : ClassA
    {
        T obj = Activator.CreateInstance<T>();
        obj.InternalClassA = this;
        return obj;
    }
}
}

namespace test
{
    /// <summary>
    /// Child class B
    /// </summary>
    public class ClassB : ClassA
    {
        public string Prop2 { get; set; }
    }
}

using System;
namespace test
{
    class Program
    {
        static void Main(string[] args)
        {
            // Instantiate A
            ClassA a = new ClassA();
            a.Prop1 = "foo";

            Console.WriteLine("Base a.prop1: " + a.Prop1);
            // a as ClassB
            ClassB b = a.AsClass<ClassB>();
            b.Prop2 = "bar";

            Console.WriteLine("Base b.prop1: " + b.Prop1);
            Console.WriteLine("Base b.prop2: " + b.Prop2);

            // Share memory
            b.Prop1 = "foo2";

            Console.WriteLine("Modified a.prop1: " + a.Prop1);
            Console.WriteLine("Modified b.prop1: " + b.Prop1);
            Console.Read();
        }
    }
} 
```

结果：

```
Base a.prop1: foo
Base b.prop1: foo
Base b.prop2: bar
Modified a.prop1: foo2
Modified b.prop1: foo2 
```

我希望它会给你一些想法来实现你想要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T08:28:22.267

这里的问题是您要实现的目标与继承关系不大。

事实上，假设你有这个：

```
class A {

    int a;

    public A(int a){

        this.a = a;

    }

    public int get(){

        return a;

    }

    public String whoAmI(){

       return "I am class A";

    }

}

class B extends A {

    int b;

    public B(int a, int b){

        super(a);

        this.b = b;

    }

    public int getA(){

        return super.get();

    }

    public int getB(){

        return b;

    }

    public String whoAmI(){

       return "I am class B";

    }

} 
```

所以现在你可以做一些休闲的事情：

```
A a = new A(2); // Create a new instance of A 
```

**或者**

```
B b = new B(3,2); // Create a new instance of B 
```

请注意，创建 B 的新实例还必须传递用于创建超 A 类的参数，就好像同时实例化它们一样。这就是继承的意思，构建 B 你实际上是在构建一个新的 A 元素以及 B 特有的一些扩展特征。

你想做的更像是：

```
A a = new A(2);
B b = new B(3,a); 
```

让我们看看 B 类的样子：

```
class B {

    A a;
    int b;

    public B(int b, A a){

        this.b = b;

        this.a = a;

    }

    public int getA(){

        return a.get();

    }

    public int getB(){

        return b;

    }

    public String whoAmI(){

        return "I am class B";

    }

} 
```

在这里你看到你可以实现你想要的东西，但在这种情况下 B 不是 A 的孩子，它更像是它的包装器，A 只是一个 B 属性。您还可以向 B 添加如下方法：

```
public A a(){

    return a;

} 
```

然后只需调用：

```
b.a.get(); // which would be just like calling  b.getA() 
```

看到这与继承无关，因为后者更多地是关于“当我创建一个子类时，我实际上也在创建一个父类，因此能够在任何地方使用子类**，就好像**它是一个父类一样”......

**编辑**

好的，我想出了一个示例，以在代码中显示@David W 在他的回答中所说的内容：

```
class Tool {

    int age;

    int value;

    public Tool(int age, int value){

        this.age = age;
        this.value = value;

    }

    public void use(){

        this.age++;
        this.value--;

    }

}

class ScrewDriver extends Tool{

    boolean starTip;

    int tipJamming = 0;

    public ScrewDriver(int age, int value, boolean starTip){

        super(age,value);
        this.starTip = starTip;

    }

    public void screw(){

        super.use();

        this.tipJamming++;

    }

}

class Hammer extends Tool{

    int weight;

    public Hammer(int age, int value, int weight){

        super(age,value);
        this.weight = weight;

    }

    public void hammer(){

        super.use();

    }

} 
```

所以你有一个父类 Tool 和两个子类 ScrewDriver 和 Hammer。如果你说的是可能的，那么你可以这样写：

```
Tool screwDriver = new screwDriver(1,10,true); //simple inheritance polymorphism
// Now if you could cast Tool to Hammer you could write
((Hammer)screwDriver).hammer(); 
```

这意味着您实际上将螺丝刀用作锤子，但这实际上打破了继承背后的所有想法，因为如果您可以将任何工具用作彼此，那么定义它们不同的工具有什么需要呢？您可以在 Tool 类中实现您需要的所有方法，并在需要时根据上下文使用它们，例如：

```
class Tool{

    ... attributes and constructor ...

    pulic void use(){

        this.age++;
        this.value--;

    }

    public void screw(){

        use();
        this.tipJamming++;

    }

    public void hammer(){

        use();

    }

} 
```

进而

```
Tool screwDriver = new Tool(...);
Tool hammer = new Tool(...);

screwDriver.screw();
hammer.hammer(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-07T15:14:07.613

`ClassB`在某些情况下，`ClassA`将需要不会提供的施工信息。

要扩展您的示例：

```
class ClassA {
  int member;
}

class ClassB : ClassA {
  int bs_special_member;
} 
```

有两种方法可以实现您想要实现的目标，这两种方法都被普遍接受（至少据我所知）。

**1**动态演员表。我假设您知道，但如果不是，它仅在您实际拥有的基本类型引用已经引用了正确类型的对象时才有效。例如，您已经这样做了：

```
ClassA a = new ClassB();
((dynamic_cast)a).bs_special_member; 
```

我不知道这是否与语言无关，但我见过的大多数语言都有一些类似的实现。

**2**构造函数。

如果你有一个实例`ClassA`实际上*只是*a`ClassA`并且不知道`bs_special_member`应该是什么值，那么你必须在构造时提供这个值`ClassB`。

我会这样做（在 c++ 中，我认为你可以用几乎任何适当的 oo 语言做同样的事情）：

```
class ClassB : ClassA {
  int bs_special_member;
  ClassB(ClassA base) {
    member = base.member;

    // Apply default value
    bs_special_member = 456;
  }
  ClassB(ClassA base, int value_for_bs_special_member) {
    member = base.member;
    bs_special_member = value_for_bs_special_member;
  }
}; 
```

这将允许您编写：

```
ClassA a;
a.member = 672;
ClassB b(a);
print(b.bs_special_member);
ClassB b2(a, 35);
print(b2.bs_special_member); 
```

在大多数语言中，第一个构造函数将允许转换自动发生，第二个构造函数只是为了方便。如果您不能允许默认值，那么您做错了什么。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-09T15:08:04.773

我不知道你会如何在 C++ 中做这样的事情（这是你正在使用的吗？），但你可能想要阅读 / google 以获得更多信息的概念被称为“协方差”和“逆变。” 最近我一直在做很多 Scala，它有一个强大的（虽然有点令人困惑）类型系统，它允许更复杂的类型规范，包括接受指定类型的父级的方法参数。

例如，在 Scala 中，我可以定义一个带有类型参数的方法，有点像 C++ 模板，如下所示：

```
def myFunction[T <: MyClass]( a:T ):T ={
  //this method accepts an instance of any subclass of MyClass as a parameter,
  //and returns an object of the same type, whatever that type may be.
  return a
}
def myFunction[T >: MyClass]( a:T ):T ={
  //this method accepts an instance of any *parent* class of MyClass as a parameter,
  //and returns an object of the same type, whatever that type may be.
  return a
} 
```

您还可以指定多个类型参数，并指定它们之间的关系。例如，如果我有一个“Dog”对象列表，并且我附加了一个“Cat”对象，我应该返回一个“Animal”对象列表。在列表的情况下，返回类型将始终是参数的相同类型或超类型，但如果需要，scala 还允许您在自己的函数中指定相反的类型。

当然，如果该函数在编译时不知道您正在使用哪个特定子类，那么您将无法在该上下文中使用该子类中的方法......但由于它在 scala 中工作，调用时的客户端代码这样的函数可以检索一个未指定的窄类型的实例作为返回类型，因此可以在函数中执行操作后继续使用子类的方法。

它也可以在以下情况下工作，例如，如果您尝试在 Cat 类中覆盖返回动物列表的方法，您可以以允许子类返回类型列表的方式参数化您的类型'Cat' 不违反父接口的约定。在这种情况下，覆盖子类的实现将可以访问 Cat 的方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-10T12:14:53.623

实现这一点的唯一一致方法是让继承的类有一个包含基类的构造函数。如果你不这样做，你最终会遇到各种潜在的溢出问题，因为对象的内存打印现在与最初创建的不同。

如果不这样做，您会遇到以下问题：

```
ClassA
{
    int A;
}

ClassB : ClassA
{
    int B;
}

ClassA a1 = new ClassA();
a1.A = 1;

ClassA a2 = new ClassA();
a2.A = 2;

ClassB b = (ClassB)a;  
b.B = 3; 
```

在这种情况下，您可能会遇到 a2.A 突然取值为 3 的问题...

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-10T13:03:23.353

只是我自己研究中可能存在的自动转换缺陷的一些注释。如果我不精确或说 BS，请原谅我。:]

1.  如果我们将 into 的原子化转换定义为 then`A`的`B : A`简写`create B and pass A as argument so B may copy all data from A into B`：

    *   它要么是一种合成糖，对实际的克隆过程几乎没有控制；
    *   或者（如果要通过扩展为 分配的内存来就地转换对象`A`）它的效率低于实例化`B`、复制数据和丢弃`A`。
2.  如果`B`有它自己的构造函数（无论是否调用超级构造函数），`B`那么`B`从`A`.

3.  如果在某些情况下`B`和`A`行为不同，并且 a`C`持有对 的引用`A`，那么（在`A`转换为之后`B`）被引用对象的行为可能会改变 - 令人惊讶的是`C`这里的预期一致性。

4.  某些语言（例如 C#）允许重新引入继承的成员。看来这里可能会导致逻辑上的不一致（`int a`in `A`is **not** `new int a` in `B`）。

5.  这种转换可能会从外部代码（而不是从内部代码）改变对象的状态，因此它反对封装。

6.  每个对象都应该是`A`或`B`（而不是介于两者之间），因此转换应该是原子操作。这导致了一个规则，即`A`在转换为`B`. 我不确定是否可以实现这样的自动锁定。（这类似于具有不完全构造对象的竞争条件）。

尽管对于主要设计为数据包装器（结构、ORM 类）并公开与状态无关的方法的类来说，自动转换是一个不错的主意。但这似乎很容易通过反射来实现（在支持它的语言中）。****

# jquery - jQuery获取项目值

> ID：12231778
> 
> 赞同：1
> 
> 时间：2012-09-01T22:02:42.587
> 
> 标签：jquery

我正在使用 ajax 的 wordpress 博客上制作表格。我试图从表单中获取一些值，当我调用时：

`var name = jQuery("#name").val();`

它是空的。那是除非我对值进行硬编码，例如：

`<input type="text" name="name" id="name" value="myname"/>`这是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T22:11:11.897

你什么时候运行你的`var name = jQuery("#name").val();`？点击一下？DOM 准备好了吗？在尝试获取数据之前确保数据存在；）

# erlang - Couchdb {"init 终止于 do_boot",{{badmatch,{error,{shutdown

> ID：12231780
> 
> 赞同：1
> 
> 时间：2012-09-01T22:03:13.450
> 
> 标签：erlang, couchdb

用 Erlang 编写的用于加密货币的矿池挖掘软件。 [https://github.com/p2k/ecoinpool](https://github.com/p2k/ecoinpool)

我目前尝试在 debian 服务器上安装此软件，但遇到如下所述的错误。我对linux真的很陌生，所以如果这是一个非常简单的问题，请原谅。

```
root@j064:~/ecoinpool# ./test_launch.sh
==> ecoinpool (compile)
==> ebitcoin (compile)
==> rel (compile)
==> ecoinpool (compile)
Erlang R15B01 (erts-5.9.1) [source] [64-bit] [smp:4:4] [async-threads:0] [kernel-poll:true]

Eshell V5.9.1  (abort with ^G)
(ecoinpool_test@j064)1> {"init terminating in do_boot",{{badmatch,{error,{shutdown,{ebitcoin_app,start,[normal,[]]}}}},[{ecoinpool_test_launch,start,0,[{file,"src/ecoinpool_test_launch.erl"},{line,34}]},{init,start_it,1,[]},{init,start_em,1,[]}]}}

Crash dump was written to: erl_crash.dump
init terminating in do_boot ()
root@j064:~/ecoinpool# 
```

我的 ecoinconfig 看起来像这样：

```
% This is an example configuration file. Lists are denoted with [...] and tuples
% are denoted with {...}. Together they form a nested structure of names and
% parameters. If you make changes and add or remove options, make sure not to
% have a comma before a closing bracket or curly brace.

[
    % SASL is Erlang's internal error and crash logger; it also logs starting
    % and stopping of certain processes. I set it to "error" here so it won't
    % pollute stdout/stderr.
    {sasl, [
        {errlog_type, error}
    ]},

    % This is ecoinpool's main configuration. The CouchDB connection is
    % configured here.
    {ecoinpool, [
        % The following commented lines are default settings.
        {db_host, "127.0.0.1"},
        % {db_port, 5984},
        % {db_prefix, ""},

        % The next line should be changed, depending on your CouchDB
        % authentication settings:         
        {db_options, [{basic_auth, {"dbuser", "dbpass"}}]},

        % Here you can change ecoinpool's HTTP service port, currently used to
        % serve global RPC functions used by the frontend.
        %{service_port, 8080},

        % The last line in this section contains your blowfish secret key, share
        % this among your servers and don't tell it to anyone else. Minimum key
        % length is 4 bytes, maximum is 56 bytes.
        % If you have pwgen (a password generator), try "pwgen -s 56 1" to get
        % 56 random characters.
        {blowfish_secret, "9Zx95ZQ2P0682MtbSGw8RNLrYhmCBD7jFwzejlv54oLXzB9gGbCfWQUc"}
    ]},

    % This is the ebitcoin configuration. ebitcoin forms a separate application,
    % thus it doesn't share ecoinpool's database settings. If you use the same
    % CouchDB server and authentication, copy it from above.
    {ebitcoin, [
        % You can also disable ebitcoin altogether by uncommenting the following
        % line. Note that you will fall back to the polling system then.
        % {enabled, false},

        {db_host, "127.0.0.1"},
        % {db_port, 5984},
        % {db_prefix, ""},
        {db_options, [{basic_auth, {"dbuser", "dbpass"}}]}
    ]},

    % The third separate application (it also has to be started separately) is
    % the MySQL Replicator. It is used to bridge legacy MySQL worker tables to
    % CouchDB and also stores copies of the shares into a MySQL table.
    {ecoinpool_mysql_replicator, [
        % Again, commented lines are default settings.
        {couchdb_host, "127.0.0.1"},
        %{couchdb_port, 5984},
        %{couchdb_prefix, ""},
        {couchdb_options, [{basic_auth, {"dbuser", "dbpass"}}]},
        %{couchdb_database, "ecoinpool"},

        %{mysql_host, "localhost"},
        %{mysql_port, 3306},
        %{mysql_prefix, ""},
        {mysql_options, [{auth, {"unchanged", "unchanged"}}]},
        %{mysql_database, "ecoinpool"},

        % This is a setting that certainly has to be changed. Configure one or
        % more worker table replicators here (if you have multiple sub-pools).
        % Please only connect one sub-pool to one table or things get jammed up.
        {replicator_configs, [
            % Format: {<ecoinpool sub-pool ID>, <MySQL worker table>, <MySQL sync interval in seconds, 1 or more>}
            {"24aa68ec6c910de0850ed0c575621ec9", "pool_worker", 15}
        ]},

        % Next is your blowfish secret key. Copy it from above.
        {blowfish_secret, "Replace me!"},

        % And the last one, also to be likely changed, is the shares deployer
        % configuration. There are two possible formats here, one with and one
        % without using merged mining. The config ID is used as basename for
        % saving the deployment state file and for the "source" column.
        {share_deployer_configs, [
            % Non-MM Format: {<config ID string>, <pool name>, <MySQL shares table>, <MySQL write interval in seconds, 0 allowed>}
            {"ltc_test_shares", "ltc-test", "shares", 60},
            % MM Format: {<config ID string>, <main pool name>, <aux pool name>, <MySQL shares table>, <MySQL write interval in seconds, 0 allowed>}
            {"btc_nmc_test_shares", "btc-test", "nmc-test", "shares", 60}
        ]}
    ]}
]. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T18:40:28.963

此处已发布解决方案：[https](https://bitcointalk.org/index.php?topic=56068.msg1200054#msg1200054) ://bitcointalk.org/index.php?topic=56068.msg1200054#msg1200054 ：

> 万一其他人遇到同样的问题，这似乎是源代码萎缩的情况。ecoinpool 依赖项的最新版本不再按预期协同工作。在 p2k 上次提交的同时将依赖项与版本挂钩为我解决了这个问题：
> 
> 代码：（rebar.config）
> 
> ```
> {sub_dirs, ["apps/ecoinpool", "apps/ebitcoin", "rel"]}.
> 
> {deps, [
>     {protobuffs, ".*", {git, "git://github.com/basho/erlang_protobuffs.git", "e0f5f6ea4c3dcb4e7b824496d2b48333fbd5a8c8"}},
>     {ejson, ".*", {git, "git://github.com/benoitc/ejson.git", "820ff1725008e664293b88e13c16193857afc072"}},
>     {oauth, ".*", {git, "git://github.com/refuge/erlang-oauth.git", "f332b77371d334d0faa13e106d0c36f948b325b6"}},
>     {ibrowse, ".*", {git, "git://github.com/cmullaparthi/ibrowse.git", "eb8b62cf84ccae141700c8fd251277df8be27f28"}},
>     {mochiweb, ".*", {git, "git://github.com/mochi/mochiweb.git", "b7f3693a9008de6d31a67174f7184fe24093a1b4"}},
>     {couchbeam, ".*", {git, "git://github.com/benoitc/couchbeam.git", "7148bbdb19aca91b7b74e5392a23c94d33ca4e27"}},
>     {log4erl, ".*", {git, "git://github.com/SemanticSugar/log4erl.git", "ec580f75ef9e28dfcfac92dc0d42c435520bd3d7"}},
>     {mysql, ".*", {git, "git://github.com/elbrujohalcon/erlang-mysql-driver.git", "1dd4e22a80546fa1bda81607d6397a549fd791ae"}},
>     {epgsql, ".*", {git, "git://github.com/wg/epgsql.git", "fc434772276475ac4e5b0bed6b18ed4732502156"}}
> ]}. 
> ```

# python - 如何使用 break、continue 和 return 语句来避免 Python 中深度嵌套的代码？

> ID：12231781
> 
> 赞同：2
> 
> 时间：2012-09-01T22:03:20.230
> 
> 标签：python, coding-style, nested

Pocoo[风格指南](http://www.pocoo.org/internal/styleguide/)建议使用`break`,`continue`和`return`语句来避免深度嵌套的代码。你会怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T22:13:15.120

一个简单的例子是，而不是这个：

```
for item in seq:
    if someCondition:
       # Here is our code block
       if blah:
           more.stuff() 
```

你可以这样做

```
for item in seq:
    if not someCondition:
       continue
   # Now our code block is here
   if blah:
       more.stuff() 
```

请注意，后者保存了缩进级别。显然你不能总是这样做，但在某些情况下，它提高了在开始时处理“如果 X 则立即停止”条件的可读性，而不必将一大段代码包装在一个`if`块中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T22:14:54.683

例如，不要写：

```
if param1Valid:
    if param2Valid:
        .... 
```

您可以使用保护条款：

```
if not param1Valid:
    return
if not param2Valid:
    return
.... 
```

许多文章颂扬了保护条款的优点：

*   [http://blog.mafr.de/2009/06/12/a-case-for-guard-clauses/](http://blog.mafr.de/2009/06/12/a-case-for-guard-clauses/)
*   [http://www.codinghorror.com/blog/2006/01/flattening-arrow-code.html](http://www.codinghorror.com/blog/2006/01/flattening-arrow-code.html)
*   [http://sourcemaking.com/implementation-patterns/guard-clause](http://sourcemaking.com/implementation-patterns/guard-clause)

You can use the exact same approach inside a loop with the continue keyword.

# emacs - 在 emacs 中，当我执行 grep-find 时，如何让显示给我的文件在与 grep 输出相同的框架中打开，而不是在不同的框架中打开？

> ID：12231783
> 
> 赞同：3
> 
> 时间：2012-09-01T22:03:54.010
> 
> 标签：emacs

我添加`add-to-list 'same-window-buffer-names "*grep*"`到我的 .emacs 以便从`grep-find`我的同一个缓冲区中获取输出`M-x grep find`。但是在我得到 grep 的输出之后，说：

```
-*- mode: grep; default-directory: "~/sandbox/" -*-
Grep started at Sat Sep  1 17:01:38

find . -type f -print0 | xargs -0 -e grep -nH -e vector
./main.cpp:4:#include <vector>
./typelist.cpp:2:#include <vector>
./main.cpp.eulerbak:4:#include <vector> 
```

如果我在其中一个上按 Enter 键，比如 typelist.cpp:2，它将水平拆分我的缓冲区并在那里打开它，用包含切换指向该文件中的行..有没有办法让它不拆分我的缓冲区，然后在 grep 缓冲区上打开它？这将使我很容易然后杀死缓冲区并退回到 grep 结果..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T05:00:25.940

将此添加到您的初始化文件中。

```
(eval-when-compile (require 'cl))
(defun kill-grep-window ()
  (destructuring-bind (window major-mode)
      (with-selected-window (next-window (selected-window))
        (list (selected-window) major-mode))
    (when (eq major-mode 'grep-mode)
      (delete-window window))))

(add-hook 'next-error-hook 'kill-grep-window) 
```

# exception - 为什么 MASM 中的“DIV EDX”总是产生处理器异常？

> ID：12231784
> 
> 赞同：5
> 
> 时间：2012-09-01T22:04:05.300
> 
> 标签：exception, assembly, x86, division

上学期我在计算机体系结构信息学考试中遇到了这个问题： *“为什么 MASM 中的 'DIV EDX' 总是产生处理器异常？”*
产生异常的机制是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-01T22:13:45.177

在 x86 CPU 上进行 1 操作数除法时，EDX:EAX（64 位）除以第一个操作数（32 位）。结果存储在 EAX（32 位）中。

因此，当您除以 EDX:EAX 除以 EDX 时，您基本上得到的是 (EDX * 0x100000000 + EAX) / EDX，其结果始终高于 0x100000000 并且不适合目标寄存器或除数为零。在这两种情况下都会发生除法异常。

另请参阅[此页面](https://web.archive.org/web/20120606081847/http://siyobik.info.gf/main/reference/instruction/DIV)（来自英特尔开发人员手册）。

请注意，这不是特定于汇编程序 (MASM)，而是特定于本例中的平台。

# php - 如何将新的 RSS 项目行写到顶部

> ID：12231785
> 
> 赞同：0
> 
> 时间：2012-09-01T22:04:05.190
> 
> 标签：php, rss, fopen, fwrite, fseek

我将一些代码拼凑在一起，它可能可以写得更好——但它确实有效，而且我学会了不要对函数式代码挑剔。无论如何，我这里有一些代码会自动更新 sitemap.xml 文件和“问题——我在这里发布问题的原因”一个 RSS 提要文件。

写入 sitemap.xml 文件效果很好！我很满意。这很容易，因为它在文件底部写入新数据并通过写入`</urlset>`.

但是，对于 rss 提要文件，我需要将新项目放在顶部。我似乎无法弄清楚如何做到这一点。所以，这里附上我的代码的当前副本。基本上，标题为 RSS FEED WRITER 的第二部分是标题为 SITEMAP.XML WRITER 的第一部分的副本。我需要如何将代码更改为第二部分，以便将新项目直接写入此行下方的顶部：`<atom:link href="http://mydomainname.com/index.rss" rel="self" type="application/rss+xml" />`在 index.rss 文件上。

非常感谢任何愿意帮助我的人。下面是代码：

```
//
// SITEMAP.XML WRITER
//
$sitemapurl = "<url>";
$sitemaploc = "<loc>";
$sitemaplocation = "http://mydomainname.com/$url.php";
$sitemaploc1 = "</loc>";
$sitemappri = "<priority>";
$sitemappriority = "1.0";
$sitemappri1 = "</priority>";
$sitemapcha = "<changefreq>";
$sitemapchange = "daily";
$sitemapcha1 = "</changefreq>";
$sitemapurl1 = "</url>";

$sitemapurlset = "\n</urlset>";
$sitemaplength_end_string = strlen($sitemapurlset);

$sitemapfp =
fopen("sitemap.xml","r+") or die("can't open file");
fseek($sitemapfp, -$sitemaplength_end_string, SEEK_END); 
fwrite ($sitemapfp, "\n".$sitemapurl."\n".$sitemaploc."".$sitemaplocation."".$sitemaploc1."\n".$sitemappri."".$sitemappriority."".$sitemappri1."\n".$sitemapcha."".$sitemapchange."".$sitemapcha1."\n".$sitemapurl1."".$sitemapurlset."\n"); //added url set to here
      fclose($sitemapfp); 

//
// RSS FEED WRITER
//

$rssitem = "<item>";
$rsstitle = "<title>$title</title>";
$rsslink = "<link>http://mydomainname.com/$url.php</link>";
$rssguid = "<guid isPermalink=\"true\">http://mydomainname.com/$url.php</guid>";
$rsspubdate = "<pubDate>".date('D, d M Y H:i:s O')."</pubDate>";
$rssdescription = "<description>$metadescription</description>";
$rssitem1 = "</item>";
$rsschannelrssset = "\n</channel>\n</rss>";
$rsslength_end_string = strlen($rsschannelrssset);
$rssfp =
fopen("index.rss","r+") or die("can't open file");
fseek($rssfp, -$rsslength_end_string, SEEK_END);
fwrite ($rssfp, "".$rssitem."\n".$rsstitle."\n".$rsslink."\n".$rssguid."\n".$rsspubdate."\n".$rssdescription."\n".$rssitem1."\n".$rsschannelrssset."\n");
fclose($rssfp); 
```

编辑：添加 index.rss 文件的顶部：

```
<?xml version="1.0" encoding="utf-8"?>
<rss version='2.0' xmlns:lj='http://www.livejournal.org/rss/lj/1.0/' xmlns:atom="http://www.w3.org/2005/Atom">
<channel>
<title>My Domain Name RSS Feed</title>
<description>Description of My Domain Name RSS Feed</description>
<link>http://mydomainname.com/</link>
<atom:link href="http://mydomainname.com/index.rss" rel="self" type="application/rss+xml" /> 
```

然后我尝试了这段代码，但它不起作用：

```
//
// RSS FEED WRITER
//

$rssitem = "<item>";
$rsstitle = "<title>$title</title>";
$rsslink = "<link>http://mydomainname.com/$url.php</link>";
$rssguid = "<guid isPermalink=\"true\">http://mydomainnanme.com/$url.php</guid>";
$rsspubdate = "<pubDate>".date('D, d M Y H:i:s O')."</pubDate>";
$rssdescription = "<description>$metadescription</description>";
$rssitem1 = "</item>";
$rssatomlink = "<atom:link href=\"http://mydomainname.com/index.rss\" rel=\"self\" type=\"application/rss+xml\" />";
$rsslength_end_string = strlen($rssatomlink);
$rssfp =
fopen("index.rss","r+") or die("can't open file");
fseek($rssfp, -$rsslength_end_string, SEEK_END);
fwrite ($rssfp, "".$rssitem."\n".$rsstitle."\n".$rsslink."\n".$rssguid."\n".$rsspubdate."\n".$rssdescription."\n".$rssitem1."\n");
fclose($rssfp); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T22:19:28.893

看看[PHP Universal Feed Generator](http://ajaxray.com/blog/php-universal-feed-generator-supports-rss-10-rss-20-and-atom)。它支持 RSS 1.0 / 2.0 和 ATOM 1.0。

# c# - 取消阻塞 AcceptTcpClient 调用

> ID：12231789
> 
> 赞同：14
> 
> 时间：2012-09-01T22:04:30.917
> 
> 标签：c#, task, blocked-threads

大家可能已经知道，在 C# 中接受传入 TCP 连接的最简单方法是循环 TcpListener.AcceptTcpClient()。此外，这种方式将阻止代码执行，直到获得连接。这对 GUI 极为有限，因此我想在单独的线程或任务中监听连接。

有人告诉我，线程有几个缺点，但是没有人向我解释这些是什么。所以我没有使用线程，而是使用了任务。这很好用，但是由于 AcceptTcpClient 方法阻止执行，我找不到任何处理任务取消的方法。

目前代码看起来像这样，但我不知道当我希望程序停止侦听连接时如何取消任务。

首先关闭任务中执行的函数：

```
static void Listen () {
// Create listener object
TcpListener serverSocket = new TcpListener ( serverAddr, serverPort );

// Begin listening for connections
while ( true ) {
    try {
        serverSocket.Start ();
    } catch ( SocketException ) {
        MessageBox.Show ( "Another server is currently listening at port " + serverPort );
    }

    // Block and wait for incoming connection
    if ( serverSocket.Pending() ) {
        TcpClient serverClient = serverSocket.AcceptTcpClient ();
        // Retrieve data from network stream
        NetworkStream serverStream = serverClient.GetStream ();
        serverStream.Read ( data, 0, data.Length );
        string serverMsg = ascii.GetString ( data );
        MessageBox.Show ( "Message recieved: " + serverMsg );

        // Close stream and TcpClient connection
        serverClient.Close ();
        serverStream.Close ();

        // Empty buffer
        data = new Byte[256];
        serverMsg = null;
    }
} 
```

二、启动和停止监听服务的功能：

```
private void btnListen_Click (object sender, EventArgs e) {
    btnListen.Enabled = false;
    btnStop.Enabled = true;
    Task listenTask = new Task ( Listen );
    listenTask.Start();
}

private void btnStop_Click ( object sender, EventArgs e ) {
    btnListen.Enabled = true;
    btnStop.Enabled = false;
    //listenTask.Abort();
} 
```

我只需要一些东西来替换 listenTask.Abort() 调用（我将其注释掉，因为该方法不存在）

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-05-30T21:41:03.827

**取消 AcceptTcpClient**

取消阻塞操作的最佳选择`AcceptTcpClient`是调用[TcpListener.Stop](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener.stop.aspx)，这将抛出一个[SocketException](http://msdn.microsoft.com/en-us/library/system.net.sockets.socketexception.aspx)，如果您想明确检查操作是否已取消，您可以捕获该异常。

```
 TcpListener serverSocket = new TcpListener ( serverAddr, serverPort );

       ...

       try
       {
           TcpClient serverClient = serverSocket.AcceptTcpClient ();
           // do something
       }
       catch (SocketException e)
       {
           if ((e.SocketErrorCode == SocketError.Interrupted))
           // a blocking listen has been cancelled
       }

       ...

       // somewhere else your code will stop the blocking listen:
       serverSocket.Stop(); 
```

任何想要在 TcpListener 上调用 Stop 的东西都需要对它进行某种级别的访问，因此您可以将其范围限定在 Listen 方法之外，或者将侦听器逻辑包装在管理 TcpListener 并公开 Start 和 Stop 方法的对象内（使用 Stop打电话`TcpListener.Stop()`）。

**异步终止**

因为接受的答案用于`Thread.Abort()`终止线程，所以在此处注意终止异步操作的最佳方法是通过协作取消而不是硬中止可能会有所帮助。

在协作模型中，目标操作可以监视由终止器发出信号的取消指示符。这允许目标检测取消请求，根据需要进行清理，然后在适当的时间将终止的状态传回给终止器。如果没有这样的方法，操作的突然终止可能会使线程的资源甚至可能使托管进程或应用程序域处于损坏状态。

从 .NET 4.0 开始，实现此模式的最佳方式是使用[CancellationToken](http://msdn.microsoft.com/en-us/library/dd384802.aspx)。使用线程时，令牌可以作为参数传递给在线程上执行的方法。使用 Tasks，对 CancellationTokens 的支持内置于多个[Task 构造函数](http://msdn.microsoft.com/en-us/library/dd235664.aspx)中。[此MSDN 文章](http://msdn.microsoft.com/en-us/library/dd997364.aspx)中更详细地讨论了取消令牌。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-06-15T22:43:19.350

[为了完整起见，上述答案](https://stackoverflow.com/a/16846330/276994)的异步对应物，使用@Mitch 的建议（[在此处](https://stackoverflow.com/q/14524209/276994)确认确认）。

与 awaiting 的同步函数相比，它`AcceptTcpClientAsync`似乎会抛出（无论如何我们都`ObjectDisposedException`在`Stop`调用它），所以 catch 也是有意义的`ObjectDisposedException`：

```
async Task<TcpClient> AcceptAsync(TcpListener listener, CancellationToken ct)
{
    using (ct.Register(listener.Stop))
    {
        try
        {
            return await listener.AcceptTcpClientAsync();
        }
        catch (SocketException e) when (e.SocketErrorCode == SocketError.Interrupted)
        {
            throw new OperationCanceledException(ct);
        }
        catch (ObjectDisposedException) when (ct.IsCancellationRequested)
        {
            throw new OperationCanceledException(ct);
        }
    }
} 
```

* * *

2021 年更新：.NET 5 抛出`SocketException`.NET Framework（使用 4.5-4.8 版本测试）和 .NET Core 2.x-3.x 抛出`ObjectDisposedException`. 所以截至今天，正确的代码是

```
#if NET5_0 //_OR_GREATER?
catch (SocketException ex) when (ct.IsCancellationRequested &&
                                 ex.SocketErrorCode == SocketError.OperationAborted)
#elif (NETFRAMEWORK && NET40_OR_GREATER) || NETCOREAPP2_0_OR_GREATER
catch (ObjectDisposedException ex) when (ct.IsCancellationRequested)
#else
#error Untested target framework
#endif
{
    throw new OperationCanceledException(ct);
} 
```

同步对应项 ( )与`listener.AcceptTcpClient()`一致地抛出，因此在 .NET 5.0 之前的所有框架中都可以执行以下操作：`SocketException``SocketErrorCode == Interrupted`

```
try
{
    return serverSocket.AcceptTcpClient();
}
catch (SocketException e) when (e.SocketErrorCode == SocketError.Interrupted)
{
    throw new OperationCanceledException(ct);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-26T07:33:04.460

`isRunning`好吧，在正确工作异步套接字之前的过去（今天最好的方法，BitMask 谈到了这一点），我们使用了一个简单的*技巧*`CancellationToken`：将线程安全的方式来终止后台工作者:)) 并为自己开始一个新的 - 这将使您从调用中返回，您可以优雅地终止。`public static bool isRunning;`*`TcpClient.Connect``Accept`*

 *正如 BitMask 已经说过的，`Thread.Abort`在终止时绝对不是一种安全的方法。事实上，它根本不起作用，因为它`Accept`是由本地代码处理的，`Thread.Abort`没有权力。它起作用的唯一原因是因为您实际上并没有在 I/O 中阻塞，而是在检查`Pending`（非阻塞调用）时运行无限循环。这看起来是在一个内核上拥有 100% 的 CPU 使用率的好方法 :)

您的代码也有很多其他问题，这些问题不会仅仅因为您正在做非常简单的事情，而且因为 .NET 相当不错而在您面前爆发。例如，你总是在`GetString`你正在读入的整个缓冲区上做 - 但这是错误的。事实上，这是 C++ 中缓冲区溢出的教科书示例 - 它似乎在 C# 中起作用的唯一原因是因为它会将缓冲区预置零，因此会`GetString`忽略您读取的“真实”字符串之后的数据。相反，您需要获取`Read`调用的返回值——它告诉您已经读取了多少字节，因此需要解码多少字节。

另一个非常重要的好处是它意味着您不再需要`byte[]`在每次读取后重新创建 - 您可以简单地一遍又一遍地重用缓冲区。

*不要*使用 GUI 线程以外的其他线程中的 GUI（是的，您`Task`正在单独的线程池线程中运行）。`MessageBox.Show`是一个肮脏的黑客，实际上可以从其他线程工作，但这真的不是你想要的。您需要在 GUI 线程上调用 GUI 操作（例如使用 Form.Invoke，或通过使用在 GUI 线程上具有同步上下文的任务）。这意味着消息框将是您期望的正确对话框。

您发布的代码段还有更多问题，但鉴于这不是代码审查，而且它是一个旧线程，我不会再做这个了:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-08-09T14:58:46.200

这就是我克服这个问题的方法。希望这有帮助。可能不是最干净的，但对我有用

```
 public class consoleService {
    private CancellationTokenSource cts;
    private TcpListener listener;
    private frmMain main;
    public bool started = false;
    public bool stopped = false;

   public void start() {
        try {
            if (started) {
                stop();
            }
            cts = new CancellationTokenSource();
            listener = new TcpListener(IPAddress.Any, CFDPInstanceData.Settings.RemoteConsolePort);
            listener.Start();
            Task.Run(() => {
                AcceptClientsTask(listener, cts.Token);
            });

            started = true;
            stopped = false;
            functions.Logger.log("Started Remote Console on port " + CFDPInstanceData.Settings.RemoteConsolePort, "RemoteConsole", "General", LOGLEVEL.INFO);

        } catch (Exception E) {
            functions.Logger.log("Error starting remote console socket: " + E.Message, "RemoteConsole", "General", LOGLEVEL.ERROR);
        }
    }

    public void stop() {
        try {
            if (!started) { return; }
            stopped = false;
            cts.Cancel();
            listener.Stop();
            int attempt = 0;
            while (!stopped && attempt < GlobalSettings.ConsoleStopAttempts) {
                attempt++;
                Thread.Sleep(GlobalSettings.ConsoleStopAttemptsDelayMS);
            }

        } catch (Exception E) {
            functions.Logger.log("Error stopping remote console socket: " + E.Message, "RemoteConsole", "General", LOGLEVEL.ERROR);
        } finally {
            started = false;
        }
    }

     void AcceptClientsTask(TcpListener listener, CancellationToken ct) {

        try {
            while (!ct.IsCancellationRequested) {
                try {
                    TcpClient client = listener.AcceptTcpClient();
                    if (!ct.IsCancellationRequested) {
                        functions.Logger.log("Client connected from " + client.Client.RemoteEndPoint.ToString(), "RemoteConsole", "General", LOGLEVEL.DEBUG);
                        ParseAndReply(client, ct);
                    }

                } catch (SocketException e) {
                    if (e.SocketErrorCode == SocketError.Interrupted) {
                        break;
                    } else {
                        throw e;
                    }
                 } catch (Exception E) {
                    functions.Logger.log("Error in Remote Console Loop: " + E.Message, "RemoteConsole", "General", LOGLEVEL.ERROR);
                }

            }
            functions.Logger.log("Stopping Remote Console Loop", "RemoteConsole", "General", LOGLEVEL.DEBUG); 

        } catch (Exception E) {
            functions.Logger.log("Error in Remote Console: " + E.Message, "RemoteConsole", "General", LOGLEVEL.ERROR);
        } finally {
            stopped = true;

        }
        functions.Logger.log("Stopping Remote Console", "RemoteConsole", "General", LOGLEVEL.INFO);

    }
    } 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2012-09-19T05:57:57.417

当 isRunning 变量变为 false 时，以下代码将关闭/中止 AcceptTcpClient

```
public static bool isRunning;

delegate void mThread(ref book isRunning);
delegate void AccptTcpClnt(ref TcpClient client, TcpListener listener);

public static main()
{
   isRunning = true;
   mThread t = new mThread(StartListening);
   Thread masterThread = new Thread(() => t(this, ref isRunning));
   masterThread.IsBackground = true; //better to run it as a background thread
   masterThread.Start();
}

public static void AccptClnt(ref TcpClient client, TcpListener listener)
{
  if(client == null)
    client = listener.AcceptTcpClient(); 
}

public static void StartListening(ref bool isRunning)
{
  TcpListener listener = new TcpListener(new IPEndPoint(IPAddress.Any, portNum));

  try
  {
     listener.Start();

     TcpClient handler = null;
     while (isRunning)
     {
        AccptTcpClnt t = new AccptTcpClnt(AccptClnt);

        Thread tt = new Thread(() => t(ref handler, listener));
        tt.IsBackground = true;
        // the AcceptTcpClient() is a blocking method, so we are invoking it
        // in a separate dedicated thread 
        tt.Start(); 
        while (isRunning && tt.IsAlive && handler == null) 
        Thread.Sleep(500); //change the time as you prefer

        if (handler != null)
        {
           //handle the accepted connection here
        }        
        // as was suggested in comments, aborting the thread this way
        // is not a good practice. so we can omit the else if block
        // else if (!isRunning && tt.IsAlive)
        // {
        //   tt.Abort();
        //}                   
     }
     // when isRunning is set to false, the code exits the while(isRunning)
     // and listner.Stop() is called which throws SocketException 
     listener.Stop();           
  }
  // catching the SocketException as was suggested by the most
  // voted answer
  catch (SocketException e)
  {

  }

} 
```*

# bash - echo 命令，然后运行呢？（如制作）

> ID：12231792
> 
> 赞同：20
> 
> 时间：2012-09-01T22:04:44.963
> 
> 标签：bash, shell, makefile, echo

有没有办法让 bash 进入一种冗长的模式，这样，当它运行一个 shell 脚本时，它会在运行它之前回显它要运行的命令？也就是说，这样就可以看到已运行的命令（以及它们的输出），类似于`make`?的输出。

也就是说，如果运行类似的 shell 脚本

```
echo "Hello, World" 
```

我想要以下输出

```
echo "Hello, World"
Hello, World 
```

或者，是否可以编写一个名为 bash 的函数`echo_and_run`来输出命令然后运行它？

```
$ echo_and_run echo "Hello, World"
echo "Hello, World"
Hello, World 
```

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-09-01T22:09:50.187

您可以`echo`在调用`eval`.

Bash 还具有调试功能。一旦你`set -x`bash 将在执行之前显示每个命令。

```
cnicutar@shell:~/dir$ set -x
cnicutar@shell:~/dir$ ls
+ ls --color=auto
a  b  c  d  e  f 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-09-03T00:42:50.327

要回答您问题的第二部分，这里有一个 shell 函数可以满足您的要求：

```
echo_and_run() { echo "$*" ; "$@" ; } 
```

我使用类似的东西：

```
echo_and_run() { echo "\$ $*" ; "$@" ; } 
```

它打印`$`在命令的前面（它看起来像一个 shell 提示符，并且更清楚地表明它是一个命令）。当我想显示它正在执行的一些（但不是全部）命令时，我有时会在脚本中使用它。

正如其他人所提到的，它确实丢失了引号：

```
$ echo_and_run echo "Hello, world"
$ echo Hello, world
Hello, world
$ 
```

但我认为没有什么好的方法可以避免这种情况；`echo_and_run`在有机会看到它们之前，shell 会去掉引号。您可以编写一个脚本来检查包含空格和其他 shell 元字符的参数，并根据需要添加引号（这仍然不一定与您实际键入的引号匹配）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-04-22T21:58:39.007

可以将 bash`printf`与`%q`格式说明符结合使用来转义参数，以便保留空格：

```
function echo_and_run {
  echo "$" "$@"
  eval $(printf '%q ' "$@") < /dev/tty
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-06-29T17:26:23.520

有关额外的时间戳和 I/O 信息，请考虑*Debian*的[**devscripts**](https://packages.debian.org/unstable/devscripts)[包](https://packages.debian.org/unstable/devscripts)`annotate-output`中的命令：*[](https://packages.debian.org/unstable/devscripts)*

 ***```
annotate-output echo hello 
```

输出：

```
13:19:08 I: Started echo hello
13:19:08 O: hello
13:19:08 I: Finished with exitcode 0 
```

现在查找一个*不存在*的文件，并注意**E:** for *STDERR*输出：

```
annotate-output ls nosuchfile 
```

输出：

```
13:19:48 I: Started ls nosuchfile
13:19:48 E: ls: cannot access 'nosuchfile': No such file or directory
13:19:48 I: Finished with exitcode 2 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-29T17:17:50.720

两个有用的 shell 选项可以添加到`bash`命令行或通过`set`脚本或交互式会话中的命令：

> *   **-v** 在读取 shell 输入行时打印它们。
> *   **-x** 在展开每个简单命令、`for`命令、`case`命令、`select`命令或算术`for`命令后，显示 的扩展值`PS4`，后跟命令及其扩展参数或相关单词列表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-29T16:34:31.737

为了添加到其他人的实现中，这是我的基本脚本样板，包括参数解析（如果您要切换详细级别，这很重要）。

```
#!/bin/sh

# Control verbosity
VERBOSE=0

# For use in usage() and in log messages
SCRIPT_NAME="$(basename $0)"

ARGS=()

# Usage function: tells the user what's up, then exits.  ALWAYS implement this.
# Optionally, prints an error message
# usage [{errorLevel} {message...}
function usage() {
    local RET=0
    if [ $# -gt 0 ]; then
        RET=$1; shift;
    fi
    if [ $# -gt 0 ]; then
        log "[$SCRIPT_NAME] ${@}"
    fi
    log "Describe this script"
    log "Usage: $SCRIPT_NAME [-v|-q]" # List further options here
    log "   -v|--verbose    Be more verbose"
    log "   -q|--quiet      Be less verbose"
    exit $RET
}

# Write a message to stderr
# log {message...}
function log() {
    echo "${@}" >&2
}

# Write an informative message with decoration
# info {message...}
function info() {
    if [ $VERBOSE -gt 0 ]; then
        log "[$SCRIPT_NAME] ${@}"
    fi
}

# Write an warning message with decoration
# warn {message...}
function warn() {
    if [ $VERBOSE -gt 0 ]; then
        log "[$SCRIPT_NAME] Warning: ${@}"
    fi
}

# Write an error and exit
# error {errorLevel} {message...}
function error() {
    local LEVEL=$1; shift
    if [ $VERBOSE -gt -1 ]; then
        log "[$SCRIPT_NAME] Error: ${@}"
    fi
    exit $LEVEL
}

# Write out a command and run it
# vexec {minVerbosity} {prefixMessage} {command...}
function vexec() {
    local LEVEL=$1; shift
    local MSG="$1"; shift
    if [ $VERBOSE -ge $LEVEL ]; then
        echo -n "$MSG: "
        local CMD=( )
        for i in "${@}"; do
            # Replace argument's spaces with ''; if different, quote the string
            if [ "$i" != "${i/ /}" ]; then
                CMD=( ${CMD[@]} "'${i}'" )
            else
                CMD=( ${CMD[@]} $i )
            fi
        done
        echo "${CMD[@]}"
    fi
    ${@}
}

# Loop over arguments; we'll be shifting the list as we go,
# so we keep going until $1 is empty
while [ -n "$1" ]; do
    # Capture and shift the argument.
    ARG="$1"
    shift
    case "$ARG" in
        # User requested help; sometimes they do this at the end of a command
        # while they're building it.  By capturing and exiting, we avoid doing
        # work before it's intended.
        -h|-\?|-help|--help)
            usage 0
            ;;
        # Make the script more verbose
        -v|--verbose)
            VERBOSE=$((VERBOSE + 1))
            ;;
        # Make the script quieter
        -q|--quiet)
            VERBOSE=$((VERBOSE - 1))
            ;;
        # All arguments that follow are non-flags
        # This should be in all of your scripts, to more easily support filenames
        # that start with hyphens.  Break will bail from the `for` loop above.
        --)
            break
            ;;
        # Something that looks like a flag, but is not; report an error and die
        -?*)
            usage 1 "Unknown option: '$ARG'" >&2
            ;;
        #
        # All other arguments are added to the ARGS array.
        *)
            ARGS=(${ARGS[@]} "$ARG")
            ;;
    esac
done
# If the above script found a '--' argument, there will still be items in $*;
# move them into ARGS
while [ -n "$1" ]; do
    ARGS=(${ARGS[@]} "$1")
    shift
done

# Main script goes here. 
```

之后...

```
vexec 1 "Building myapp.c" \
    gcc -c myapp.c -o build/myapp.o ${CFLAGS} 
```

注意：这不包括管道命令；你需要 bash -c 那些东西，或者把它们分解成中间变量或文件。***

# python - 原始模式下的 Python 标准输入打印添加空格

> ID：12231794
> 
> 赞同：10
> 
> 时间：2012-09-01T22:05:31.633
> 
> 标签：python, linux, stdin, buffering

我需要在 Python 中将标准输入切换到非缓冲模式，这样我就可以从中读取单个字符。我设法让它工作，但现在标准输出被破坏了：不知何故，似乎在换行符之后，发出了一些空格字符，第一行为零，第二行为 3，第三行为 6，等等，像这样：

```
ASD
   ASD
      ASD 
```

操作系统为 Ubuntu Linux 12.04，64 位版本，Python 版本为 3.2.3。

我怎样才能摆脱这种行为？

下面是我使用的代码：

```
import sys
import tty
import termios

fd = sys.stdin.fileno()
old_settings = termios.tcgetattr(fd)
tty.setraw(sys.stdin)

for i in range(0, 10):
    print("ASD")

termios.tcsetattr(fd, termios.TCSADRAIN, old_settings) 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2017-05-12T05:15:16.683

您遇到的问题是“raw”、“cooked”和“cbreak”模式之间的区别。这些模式是内核级终端驱动程序的模式，而不是您的应用程序代码或标准库或用户空间中的任何其他模式。这是引用这些的老式 Unix 方式。Posix 用一组更细粒度的属性取代了它们，尽管 Posix 属性通常与辅助函数一起以模仿旧的“raw”、“cooked”和“cbreak”模式的方式翻转。

在熟模式下，终端驱动程序本身具有内置的原始行编辑功能。它处理退格、单词擦除（基本上一次退格整个单词）和类似的事情。没有什么比处理箭头键或历史记录或类似的东西更复杂了。很原始。在这种模式下，您的程序在发送行尾 (eol) 字符之前永远不会从终端看到任何内容，然后您的程序会得到一整行，并且`\n`无论终端实际是什么，都会将行结尾转换为 Unix 标准做。此外，作为其中的一部分，终端驱动程序将输入的字符回显到终端，以便用户可以看到他们正在输入的内容。

在 'cooked' 模式下，内核级终端驱动程序也会进行一些输出转换。如果需要，其中一部分会`\n`变成。`\r\n`

此外，在“熟”模式下，终端驱动程序处理特殊字符，如 Control-C（向控制进程组发送 SIGINT（由 CPython 转换为 KeyboardInterrupt 异常））和 Control-Z（发送 SIGTSTP（如 SIGSTOP，但可以被捕获）到控制进程组）。

在“cbreak”模式下，不再进行行编辑。终端驱动程序立即将每个字符（或短字符序列，如箭头键的转义序列）提供给程序。这些字符不会回显到屏幕上，因此除非您的程序随后打印它们，否则用户将看不到它们。尽管终端驱动程序仍然处理特殊字符，如 Control-C 和 Control-Z，但它不再处理行编辑字符，如退格或字擦除字符（通常是 Control-W）。此外，一些输出处理仍然完成，因此驱动程序将 a`\n`变为 a `\r\n`。

在“原始”模式下，不对输入或输出进行任何处理。没有特殊的字符处理，没有回显，没有转换`\n`成`\r\n`，没有对 Control-Z 的处理，什么都没有。这取决于将终端置于原始模式的程序来完成这一切。

现在，您正在设置 的属性，`sys.stdin`因此您可能认为这不应该影响`sys.stdout`. 但是，事实上，您的两个文件描述符都会导致终端驱动程序的完全相同的“实例”。决定发生什么的是终端驱动程序的设置。`sys.stdin`因此，如果您通过、`sys.stdout`或什至更改这些设置都没有关系`sys.stderr`，它们都会更改相同的底层终端驱动程序实例，并且它们会影响所有其他设置。

当然，对于在程序启动之前由 shell 重定向的文件描述符来说，情况并非如此。

附带说明一下，您可以`stty -a`在命令行上使用 来查看所有这些标志的完整读数（包括哪些控制字符导致了cbreak 和cbreak 模式下的哪些信号）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-05-21T03:44:32.413

当我在寻找同样问题的答案时，谷歌把我带到了这里。没有回车的halex分享的线索帮助我寻找真相。我在 Chris 的 Wiki 上的帖子中找到了我的答案： [https](https://utcc.utoronto.ca/~cks/space/blog/unix/CBreakAndRaw) : //utcc.utoronto.ca/~cks/space/blog/unix/CBreakAndRaw，这让我在这里阅读了 tty.py 的来源：[https://hg。 python.org/cpython/file/618ea5612e83/Lib/tty.py](https://hg.python.org/cpython/file/618ea5612e83/Lib/tty.py) 这让我得出结论，如果目标是读取单个字符，而不是：

```
tty.setraw() 
```

采用：

```
tty.setcbreak() 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-01T22:12:38.727

看起来你只做换行但没有回车。将您的打印更改为

```
print("ASD", end="\r\n") 
```

# eclipse - SLF4J Logger for Eclipse Juno with Mountain Lion

> ID：12231796
> 
> 赞同：1
> 
> 时间：2012-09-01T22:05:57.533
> 
> 标签：eclipse, macos, logging, slf4j

我在 Eclipse Juno 中遇到了 slf4j 记录器系统的问题。我很确定我已将它包含在我的类路径中，并且我还将它包含在 Maven 依赖项中，但我仍然遇到问题。我已经阅读了有关此问题的类似问题，但它们似乎都已过时，因为它们在我的 Eclipse 实例中不起作用。这是错误消息：

```
 SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
    SLF4J: Defaulting to no-operation (NOP) logger implementation
    SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details. 
```

我在带有 Java JDK 1.7.0_07 和 Apache Maven 3.03 的 Mac OS X Mountain Lion 10.8.1 上运行它。再一次，我正在使用 Eclipse Juno。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T12:32:27.833

Eclipse Juno 和 Indigo 在使用捆绑的 maven 版本 (m2e) 时，不会抑制消息 SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder"。此行为从 m2e 版本 1.1.0.20120530-0009 及更高版本开始存在。

虽然，这被指示为错误，您的日志将正常保存。在修复此错误之前，突出显示的错误仍将存在。[在m2e 支持站点](https://bugs.eclipse.org/bugs/show_bug.cgi?id=387064)中了解更多信息。

当前可用的解决方案是使用外部 maven 版本而不是 Eclipse 的捆绑版本。您可以在下面的问题中找到有关此解决方案以及有关此错误的更多详细信息，这与您面临的问题完全相同。

[SLF4J：无法加载类“org.slf4j.impl.StaticLoggerBinder”。错误](https://stackoverflow.com/questions/11916706/slf4j-failed-to-load-class-org-slf4j-impl-staticloggerbinder-error)

# c - 在c中快速读取大于内存的文件

> ID：12231798
> 
> 赞同：1
> 
> 时间：2012-09-01T22:06:16.333
> 
> 标签：c, file, file-io

我想从几个文件中读取行，而不是每行。这些文件不适合内存，所以我必须从磁盘读取。在 C 中以最佳性能从多个文件中读取特定行的最佳方法是什么？

例子：

*   文件 4 的第 1 行
*   文件 2 的第 5 行
*   文件 4 中的第 5 行 ....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:10:39.203

[在 Linux 上，您可以使用mmap(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/mmap.2.html)系统调用，可能使用[madvise(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/madvise.2.html)和（在另一个线程中）[readhahead(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/readahead.2.html)系统调用，读取和存储数兆字节的文件。

但瓶颈可能是你的硬件。考虑使用 SSD 或速度非常快的磁盘。

[如果您对行边界感兴趣，您应该明确地管理它们（并记住它们），也许要记住一些换行符的一些偏移量。]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T22:16:10.067

如果您使用的是 Linux 或 Windows，则可以创建文件的文件映射。这不会放入内存，并且可以让您快速访问文件的缓冲区。

在 linux 中，您可以查看 man 中的“mmap”。

在 Windows 中我不记得了，但你可以 google 一下：windows 上的文件映射。

关于逐行读取，你可以使用 fscanf 或实现你自己的函数，记住：在 linux 中读取到 "\n"，在 windows 中读取到 "\r\n"。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T22:53:04.240

你的问题是没有读取文件。您的问题是知道要读取文件的哪一部分。

为此，您必须提前准备一个索引表，其中包含每行开头的位置。

当然，你可以用懒惰的方式构造它，那么就需要第 N 行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T22:40:59.150

不知道您使用的是哪个文件系统，但几乎可以肯定它无法自动跟踪断行符在为文件保留的内存中的位置。

也就是说，为了有一种方法可以快速访问特定行的文件，您需要建立行的索引，如果您正在处理的文件没有任何已知的适当性，您将需要至少一次完全扫描文件以构建此类索引。

显然，如果文件大于系统 RAM，您将需要在执行构建索引所需的扫描时实施明智的内存管理。

创建索引后，您只需访问要读取的唯一内存部分。

# python - 在Python中编码有向图的布尔邻接矩阵

> ID：12231808
> 
> 赞同：1
> 
> 时间：2012-09-01T22:08:27.823
> 
> 标签：python, list, encoding, matrix

我有一个 2D 布尔值列表，它表示 Python 中有向图的邻接矩阵。我正在尝试将此矩阵写入文件，但矩阵本身非常大，因此我试图在将其写入文件之前想出一些对其进行编码的方法。

我想我可以将每一列视为二进制数 - 所以我可以将其转换为十进制数并将其写入文件。但是，首先，我会写下节点的数量以确保每个编码都是唯一的。

因此，例如，如果矩阵是`[[False, True], [True, True]]`，我的文件将如下所示：

> 2（节点数）
> 1（十进制为 01）
> 3（十进制为 11）

当然，没有括号内的文字。

我的**问题**是：是否有另一种更节省空间（如生成的文件会更小）的方式来编码这个矩阵？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T23:32:39.563

您需要在数据中有一些模式才能更好地压缩它。更多模式 = 更多压缩。您根据模式组成数据。

如果你有一个随机的数据集矩阵，你可以使用**rank**方法来压缩它。好好看看[这个答案](https://stackoverflow.com/a/6051707/808255)

关于这个主题的一篇好[论文](http://siam.omnibooksonline.com/2011datamining/data/papers/014.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T23:56:37.823

对于图的邻接矩阵，它可能非常稀疏，因此只需将矩阵转换为[Scipy 稀疏矩阵](http://docs.scipy.org/doc/scipy/reference/sparse.html)并[腌制](http://docs.python.org/library/pickle.html)它（无需设计自己的文件格式）。

# java - 我的 JScrollPane 滚动到 JTable 的倒数第二行，而不是最后一行

> ID：12231809
> 
> 赞同：1
> 
> 时间：2012-09-01T22:08:52.770
> 
> 标签：java, swing, jtable, jscrollpane, vertical-scrolling

正如我在标题中所描述的，我的 java 方法不会垂直滚动我的 jtable，到最后插入的行。那是（我认为）因为执行我的编程滚动代码（如下）时未显示行：

```
private void message(String text) { 
    infoTableModel.addRow(new Object[] { text });   
    infoScrollPane.getVerticalScrollBar()
       .setValue(infoScrollPane.getVerticalScrollBar().getMaximum()); 
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T22:44:40.957

更好用`JTable.scrollRectToVisible`：

```
table.scrollRectToVisible(table.getCellRect(table.getRowCount() - 1, 0, true)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T00:18:29.480

这是一个功能解决方案，它也是基于我的理论，但我自己无法解决。

[如何滚动到 JTable 中的最后一行](https://stackoverflow.com/questions/4890282/howto-to-scroll-to-last-row-on-jtable)

感谢您所有的帮助。

祝你好运！

# javascript - 在 Three.js 中为场景添加相机的原因？

> ID：12231811
> 
> 赞同：6
> 
> 时间：2012-09-01T22:09:29.250
> 
> 标签：javascript, three.js, camera

为什么我应该在场景中添加相机，虽然我已经将它传递给我的渲染方法？我在存储库中看到的每个示例都将相机添加到场景中，例如[weggl_geometries](https://github.com/mrdoob/three.js/blob/master/examples/webgl_geometries.html)。但是删除后`scene.add( camera )`仍然可以使用...

## 初始化函数

```
camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 2000 );
camera.position.y = 400;
scene.add( camera ); 
```

## 渲染函数

```
renderer.render( scene, camera ); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-01T22:30:38.797

当您在未将相机添加到场景中的情况下进行渲染时，它会自动添加。将它放在场景中的关键在于，在更新版本的库中，您可以将相机添加为场景的另一个对象（最终动画）的子对象。

以下是 Three.js 开发人员回答的一些问题[https://github.com/mrdoob/three.js/issues/1046](https://github.com/mrdoob/three.js/issues/1046)

# php - 将数据库中的音频文件保存为 BLOB 还是文件系统？

> ID：12231814
> 
> 赞同：0
> 
> 时间：2012-09-01T22:10:19.693
> 
> 标签：php, android, android-sqlite, android-mediarecorder, blobstorage

我正在编写一个应用程序，其中一个功能是允许用户录制简短的短语并在以后收听它们。录制完成后，音轨将通过 Internet 发送并存储在服务器中。我的问题是将音频存储在 android 应用程序和服务器中的最佳方式是什么。我考虑将它作为 android 端的 blob 存储在 SQLite 数据库中，然后发出 HTTP 请求以在服务器中运行 php 脚本，该脚本还将在外部数据库中插入 blob。或者我应该将文件存储在客户端和服务器端的文件系统中，并且在数据库中只保留对文件的引用？请指教。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T22:25:47.260

根据我在您的问题中读到的内容，没有理由将文件发送到您的外部服务器的数据库（除非您打算收听它...... teehee）。

最好将音频作为实际文件存储在用户的 SD 卡上，然后在 Android 手机上的 SQLlitee 数据库中保存对音频文件的引用。根据您所说，我不明白您为什么需要外部服务器数据库中的信息，但您也可以将文件名、目录和 ID 保存在外部数据库中。

您可以将音频存储在 SQLlite 数据库中的 BLOB 中，但请注意，如果录音太长，文件会很大，并且您可能会遇到插入和从数据库中检索的问题。您可以将文件分成更小的 500KB 部分并将它们存储在数据库中，根据它们的 ID 检索它们，将它们组合在一起并播放。

每次用户想要录制或播放录音时，在两个不同的服务器之间来回传输音频文件是不必要和荒谬的。

# visual-studio-2010 - 为什么在运行此 OpenCV 程序时出现此异常？

> ID：12231819
> 
> 赞同：0
> 
> 时间：2012-09-01T22:10:48.547
> 
> 标签：visual-studio-2010, opencv

我使用 Visual Studio 2010 和 OpenCV 2.3.0。

```
#include "stdafx.h"
#include <cv.h>
#include <ml.h>
#include <highgui.h>
#include <iostream>
#include <stdlib.h>

template<class T> class Image {
  private:
  IplImage* imgp;

  public:
  Image(IplImage* img = 0) {
      imgp = img;
  }

  ~Image() {
      imgp = 0;
  }

  void operator=(IplImage* img) {
      imgp = img;
  }

  inline T* operator[](const int rowIndx) {
      return ((T *)(imgp->imageData + rowIndx * imgp->widthStep));
  }
};

typedef struct {
  unsigned char b,g,r;
} RgbPixel;

typedef struct {
  float b,g,r;
} RgbPixelFloat;

//typedef Image<RgbPixel>       RgbImage;
//typedef Image<RgbPixelFloat>  RgbImageFloat;
typedef Image<unsigned char>  BwImage;
//typedef Image<float>          BwImageFloat;

double crossCorrelation( IplImage* img1, IplImage* img2 ) {
    double corr;
    int M = img1->width;
    int N = img1->height;

    BwImage img_1( img1 );
    BwImage img_2( img2 );

    CvScalar img1_avg = cvAvg( img1, NULL );
    CvScalar img2_avg = cvAvg( img2, NULL );

    double sum_img1_img2 = 0;
    double sum_img1_2    = 0;
    double sum_img2_2    = 0;

    for( int m = 0; m < M; ++m ) {
        for( int n = 0; n < N; ++n ) {
            sum_img1_img2   = sum_img1_img2 + (img_1[m][n] - img1_avg.val[0]) * (img_2[m][n] - img2_avg.val[0]);
            sum_img1_2      = sum_img1_2    + (img_1[m][n] - img1_avg.val[0]) * (img_1[m][n] - img1_avg.val[0]);
            sum_img2_2      = sum_img2_2    + (img_2[m][n] - img2_avg.val[0]) * (img_2[m][n] - img2_avg.val[0]);
        }
    }

    corr = sum_img1_img2/sqrt(sum_img1_2*sum_img2_2);
    return corr;
}

int _tmain(int argc, _TCHAR* argv[]) {
    IplImage *img1 = cvLoadImage("C:/Users/ANIMES~1/Documents/VISUAL~3/Projects/tutOpencv/tutOpencv/38.png", CV_LOAD_IMAGE_COLOR);
    IplImage *img2 = cvLoadImage("C:/Users/ANIMES~1/Documents/VISUAL~3/Projects/tutOpencv/tutOpencv/39.png", CV_LOAD_IMAGE_COLOR);
    IplImage *img1g = cvCreateImage( cvSize( img1->width, img1->height ), IPL_DEPTH_8U, 1 );
    IplImage *img2g = cvCreateImage( cvSize( img2->width, img2->height ), IPL_DEPTH_8U, 1 );
    std::cout << (double)crossCorrelation(img1g, img2g) << std::endl;
    std::system("Pause");
    return 0;
} 
```

当我调试时，我总是得到这个异常：

> tutOpencv.exe 中 0x013e157f 处的未处理异常：0xC0000005：访问冲突读取位置 0x00f3b00c。

我无法弄清楚，这个错误来自哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T22:18:41.963

添加一些断点以找出程序崩溃的位置

# iphone - iPhone 版 Google Weather API 的替代品

> ID：12231824
> 
> 赞同：1
> 
> 时间：2012-09-01T22:11:50.787
> 
> 标签：iphone, xml, parsing, weather

我使用文章[http://www.icodeblog.com/2010/09/29/adding-local-weather-conditions-to-your-app-part-22-accessing-googles-xml-weather-api/](http://www.icodeblog.com/2010/09/29/adding-local-weather-conditions-to-your-app-part-22-accessing-googles-xml-weather-api/)添加我的应用程序的一些真正的基本天气功能，主要是当前的温度和条件。然而，看起来在 8 月底，Google 关闭了他们的 weatherAPI，而新的 iGoogle 不再使用 XML。那么，是否有任何相当简单的选项可以让我获得 1 组邮政编码的当前温度和条件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:44:16.690

[Wunderground API](http://www.wunderground.com/weather/api/)具有 XML 和 JSON 端点以及相当可用的免费计划。我自己用过，非常喜欢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T22:35:33.047

我知道 NOAA 运行[SOAP Web 服务](http://graphical.weather.gov/xml/)。也许这会有用？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T00:35:42.400

为什么不使用免费的 YQL 表：[wunderground](http://developer.yahoo.com/yql/console/?q=select%20%2a%20from%20wunderground.forecast%20where%20location=%27Chicago%27;&env=store://datatables.org/alltableswithkeys)或[yahoo weather](http://developer.yahoo.com/yql/console/?q=select%20%2a%20from%20weather.bylocation%20where%20location=%27Chicago%27%20and%20unit=%27c%27;&env=store://datatables.org/alltableswithkeys)。它讲 XML 和 JSON(P)。

# x86 - IA-32 中的基本数据类型是什么？

> ID：12231830
> 
> 赞同：3
> 
> 时间：2012-09-01T22:13:23.883
> 
> 标签：x86

我想知道英特尔 IA-32 架构的基本数据类型是什么。

我知道其中四个——字节（8 位）、字（16 位）、双字（32 位）和四字（64 位）。还有其他人吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T22:14:32.993

是的，您又错过了一个 --> `double quadwords [8 bytes](128 bits)`。

来自英特尔手册：-

> 基本数据类型是字节、字、双字、四字和双四字（见图 4-1）。一个字节为 8 位，一个字为 2 字节（16 位），双字为 4 字节（32 位），四字为 8 字节（64 位），双四字为 16 字节（128 位）。IA-32 体系结构指令的一个子集对这些基本数据类型进行操作，无需任何额外的操作数类型。

![基本类型](../Images/d715aab9b12ec3d51f3312760b6102c1.png)

> 在Intel486处理器的IA-32架构中引入了四字数据类型；**双四字数据类型是在具有 SSE 扩展的 Pentium III 处理器中引入的**。

# vim - Vim 抛出“不是编辑器命令：JSHint”错误

> ID：12231833
> 
> 赞同：0
> 
> 时间：2012-09-01T22:13:37.380
> 
> 标签：vim, jshint

我已经安装了 JSHint 并在 vim 中工作，事实证明，当我保存文件时，我可以看到它指出代码中的错误。

但是当我在命令行输入 :JSHint 时，它说它不是命令。

我正在使用pathogen.vim 插件，但在我安装pathogen 之前它也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:16:42.180

好的，我认为问题在于我为 vim 下载了一种没有 JSHint 命令的 JSHint。

这是我下载的：[https ://github.com/vim-scripts/jshint.vim--Stelmach](https://github.com/vim-scripts/jshint.vim--Stelmach)

我正在阅读[http://www.vim.org/scripts/script.php?script_id=3576上的文档](http://www.vim.org/scripts/script.php?script_id=3576)

# android - 如何获取 GridView 的行数？

> ID：12231835
> 
> 赞同：12
> 
> 时间：2012-09-01T22:13:44.623
> 
> 标签：android, gridview

有没有办法获取 Android API Level 8 的 GridView 的行数？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-22T13:56:52.867

我昨晚不得不解决这个问题，它对我有用。它查找孩子的宽度并假设所有单元格具有相同的宽度，将 GridView 的宽度除以孩子的宽度。（`getColumnWidth()`在早期的 API 中也不可用，因此是解决方法）。

```
private int getNumColumnsCompat() {
    if (Build.VERSION.SDK_INT >= 11) {
        return getNumColumnsCompat11();

    } else {
        int columns = 0;
        int children = getChildCount();
        if (children > 0) {
            int width = getChildAt(0).getMeasuredWidth();
            if (width > 0) {
                columns = getWidth() / width;
            }
        }
        return columns > 0 ? columns : AUTO_FIT;
    }
}

@TargetApi(Build.VERSION_CODES.HONEYCOMB)
private int getNumColumnsCompat11() {
    return getNumColumns();
} 
```

但是，有一些重要的限制需要注意。

*   它只会在 GridView 布局之后并且只有当它实际上添加了一些视图时才会起作用。
*   这不考虑添加的任何单元格间距`setHorizontalSpacing()`。如果您使用水平间距，您可能需要调整它以解决它。
*   就我而言，我没有任何填充或额外的宽度需要考虑。如果你这样做了，你需要调整它以确保除法最终得到正确的答案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-07T17:16:28.767

我解决了 V8 中缺少 getNumColumns 的问题，在资源中指定列数的情况下，通过声明一个整数资源并在 GridView 资源和代码中使用它。

```
<integer name="num_grid_columns">2</integer>

<android.support.v7.widget.GridLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:scrollbars="vertical"
    app:columnCount="@integer/num_grid_columns"
    app:orientation="horizontal" >

int cols = getResources().getInteger(R.integer.num_grid_columns); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-01T22:27:19.343

试试这个：

```
Math.ceil( (double)gridView.getCount() / (double)gridView.getNumColumns() ); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-06-14T19:54:58.483

因为我最初回答了一个[重复](https://stackoverflow.com/questions/14879394/getnumcolumns-for-api-8/24223714#24223714)的问题，所以在这里添加重复的答案。

我在我的一个自定义 GridView 子类上添加了这个实现，它按预期工作。我检查了 GridView 类的声明字段，至少在 API 8 上，它们确实已经有一个名为的字段`mNumColumns`（这是 API 18 返回的内容`getNumColumns()`）。他们可能没有将字段名称更改为其他名称，然后又在 API 8 和 18 之间更改，但我没有检查。

```
@Override
public int getNumColumns() {
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
        return super.getNumColumns();
    } else {
        try {
            Field numColumns = getClass().getSuperclass().getDeclaredField("mNumColumns");
            numColumns.setAccessible(true);
            return numColumns.getInt(this);
        } catch (Exception e) {
            return 1;
        }
    }
} 
```

@Override 不会导致任何错误，因为它只是一个安全检查注释 AFAIK。

我也不知道是否有任何反对建议这样做而不是使用单独的`getNumColumnsCompat()`方法（如@cottonBallPaws 回答），但我发现它像这样非常整洁。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-01T22:26:36.997

如果您查看Android *API Guide中的*[GridView](http://developer.android.com/guide/topics/ui/layout/gridview.html)页面，您会看到有一个名为 的方法，其中一个参数是位置。随着也许你可以得到行数。*`onItemClickListener``getNumColumns()`*

# python - Linregress 给出不正确的结果

> ID：12231836
> 
> 赞同：2
> 
> 时间：2012-09-01T22:13:58.410
> 
> 标签：python, statistics, scipy, linear-regression

我是 Stack Overflow 的忠实粉丝，我相信我的问题会在这里得到解答。我正在使用 Scipy 进行线性回归。但是在一组特定的输入中，我没有得到正确的输出。（Python 2.5、SciPy 0.10.1 Windows 7 32 位）

```
from scipy.stats import linregress
from numpy import arange
x = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,1,2,0,0,2]
y = arange(1,36)
s,i,r,p,st = linregress(x,y) 
```

这里 s 的值为 9.241573，但 Excel 报告斜率为 0.026。

我错过了什么吗？帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T23:14:58.967

您似乎有错误的论点：

```
s,i,r,p,st = linregress(y,x) 
```

给`s = 0.026330532212885151`. Excel 和 Scipy 的参数顺序相反。

# macos - 如何在 Mac OS X 中放置全屏图像

> ID：12231838
> 
> 赞同：1
> 
> 时间：2012-09-01T22:14:10.217
> 
> 标签：macos, cocoa, fullscreen

我想知道是否有办法“隐藏”Mac桌面，并在操作正在进行时显示加载屏幕之类的东西，然后将其删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T22:58:06.187

你可以创建一个[NSImageView](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSImageView_Class/Reference/Reference.html)对象，并通过发送[enterFullScreenMode:withOptions 来全屏显示它：](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSView_Class/Reference/NSView.html#//apple_ref/doc/uid/20000014-SW5)

# c++ - 计时码“C2440：”中的一个奇怪错误 ' : 无法从 '_CR' 转换为 'std::chrono::milliseconds'"

> ID：12231843
> 
> 赞同：5
> 
> 时间：2012-09-01T22:15:17.287
> 
> 标签：c++, visual-c++, c++11, visual-studio-2012, chrono

我偶然发现了一个奇怪的错误

> C2440：“”：无法从“_CR”转换为“std::chrono::milliseconds”

基本上相当于[Howard Hinnant在](https://stackoverflow.com/users/576911/howard-hinnant)[另一个问题](https://stackoverflow.com/questions/9541450/estimating-time-left-in-c11)中的代码。

这应该在 Visual Studio 2012 RC 上编译吗？这个问题的原因是什么？修复或解决方法怎么样？我的目标只是创建一个简单的计时器（没什么大不了的），所以如果存在某种结果，就会采取行动——以及其他实现线索。

有问题的代码如下。用法：

```
 timers::stopwatch w;
  w.start();
  std::cout << to_milliseconds(w.elapsed()) << std::endl; 
```

头文件是（为简洁起见省略了实现）

```
namespace timers
{
    class stopwatch
    {
        public:
            typedef std::chrono::high_resolution_clock clock;
            typedef clock::time_point time_point;
            typedef clock::period period;
            typedef std::chrono::duration<float, period> duration;

            stopwatch();
            ~stopwatch();

            void start();
            void stop();
            void restart();
            void reset();

            duration elapsed() const;
       private:
            clock timer_;
            time_point start_point_;
            time_point end_point_;
            bool is_running_;

            void start_measuring();
            void stop_measuring();
     };
}

//Some convenience stuff...
namespace
{       
    long long to_milliseconds(timers::stopwatch::duration const& duration) { return   std::chrono::duration_cast<std::chrono::milliseconds>(duration).count(); }
    long long to_nanoseconds(timers::stopwatch::duration const& duration) { return std::chrono::duration_cast<std::chrono::nanoseconds>(duration).count(); }
    long long to_seconds(timers::stopwatch::duration const& duration) { return std::chrono::duration_cast<std::chrono::seconds>(duration).count(); } 
```

}

### 编辑

根据 Howard Hinnant 的说明，`#include <chrono>`在头文件、实现文件和调用文件中有。错误指向 MS`<chrono>`标头，错误在此代码中触发

```
// duration_cast
template<class _To,
    class _Rep,
    class _Period> inline
    typename enable_if<_Is_duration<_To>::value,
        _To>::type
        duration_cast(const duration<_Rep, _Period>& _Dur)
        {    // convert duration to another duration
            typedef typename ratio_divide<_Period, typename _To::period>::type _CF;
            typedef typename common_type<
            typename common_type<typename _To::rep, _Rep>::type,
                intmax_t>::type _CR;
                if (_CF::num == 1 && _CF::den == 1)
                    return (_To(static_cast<typename _To::rep>(_Dur.count())));
                else if (_CF::num != 1 && _CF::den == 1)
                    return (_To(static_cast<typename _To::rep>(static_cast<_CR>(_Dur.count())) * static_cast<_CR>(_CF::num)));
                else if (_CF::num == 1 && _CF::den != 1)
            return (_To(static_cast<typename _To::rep>(static_cast<_CR>(_Dur.count()) / static_cast<_CR>(_CF::den))));
                else
                    return (_To(static_cast<typename _To::rep>(xtatic_cast<_CR> _Dur.count()) * static_cast<_CR>(_CF::num) / static_cast<_CR>(_CF::den))));
} 
```

特别是在第 573 行`<chrono>`，在前面提到的是

```
 [...]
 else if (_CF::num != 1 && _CF::den == 1)
     return (_To(static_cast<typename _To::rep>(static_cast<_CR>(_Dur.count())) * static_cast<_CR>(_CF::num))); 
```

如果它在我的代码中的某处或 VC++ 标头中，我不能真正遵循所有这些代码的目的（至少）有一个明确的意见`<chrono>`。我认识一些来自[TC1/SC22/WG21 n2661](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2661.htm)的命名。无论如何，我稍后会回到计算机上，看看将`stopwatch`其隔离到自己的项目是否会影响此错误的发生。

### 编辑 2

我把代码放到一个空项目中，问题依旧。作为补充说明，对于三个 to_*seconds 调用，有六个编译器错误。如果我将便利方法放在注释中，代码就会编译并运行。

嗯，我想知道什么是一个好的解决方法（或修复）..？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T11:07:13.047

我认为编译时错误是由于 Visual Studio 2012 RC 中的这个错误：

[https://connect.microsoft.com/VisualStudio/feedback/details/752794/std-chrono-duration-cast-lacks-double-support](https://connect.microsoft.com/VisualStudio/feedback/details/752794/std-chrono-duration-cast-lacks-double-support)

要解决此问题，请使用基于整数类型而不是浮点的持续时间：

```
#include <cstdint>
//...
typedef std::chrono::duration<std::uint64_t, period> duration; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T00:14:46.567

如果我添加，您的代码将为我编译：

```
#include <chrono> 
```

给它。我无权访问 Visual Studio 2012 RC，因此我无法调查此错误的原因，甚至无法确定它发生在哪里。

# node.js - npm 不会安装 express 吗？

> ID：12231846
> 
> 赞同：47
> 
> 时间：2012-09-01T22:15:33.010
> 
> 标签：node.js, express

我目前安装了 node.js 版本 0.8.8 和 npm 1.1.59。

每当我跑步时：

```
$ npm install -g express 
```

我得到这个作为回报：

```
npm ERR! Error: EACCES, open '/Users/devinandrews/.npm/64a534c1-express.lock'
npm ERR!  { [Error: EACCES, open '/Users/devinandrews/.npm/64a534c1-express.lock']
npm ERR!   errno: 3,
npm ERR!   code: 'EACCES',
npm ERR!   path: '/Users/devinandrews/.npm/64a534c1-express.lock' }
npm ERR! 
npm ERR! Please try running this command again as root/Administrator.

npm ERR! System Darwin 12.1.0
npm ERR! command "node" "/usr/local/bin/npm" "install" "-g" "express"
npm ERR! cwd /Users/devinandrews
npm ERR! node -v v0.8.8
npm ERR! npm -v 1.1.59
npm ERR! path /Users/devinandrews/.npm/64a534c1-express.lock
npm ERR! code EACCES
npm ERR! errno 3
npm ERR! stack Error: EACCES, open '/Users/devinandrews/.npm/64a534c1-express.lock'
npm ERR! 
npm ERR! Additional logging details can be found in:
npm ERR!     /Users/devinandrews/npm-debug.log
npm ERR! not ok code 0 
```

我现在正在拔头发试图弄清楚这一点。

更新：

我跑了

```
$ npm -g ls 
```

看看我的 npm 全局安装了什么：

```
/usr/local/lib
├─┬ express@3.0.0rc4
│ ├── commander@0.6.1
│ ├─┬ connect@2.4.4
│ │ ├── bytes@0.1.0
│ │ ├── formidable@1.0.11
│ │ ├── pause@0.0.1
│ │ └── qs@0.4.2
│ ├── cookie@0.0.4
│ ├── crc@0.2.0
│ ├── debug@0.7.0
│ ├── fresh@0.1.0
│ ├── methods@0.0.1
│ ├── mkdirp@0.3.3
│ ├── range-parser@0.0.4
│ └─┬ send@0.0.4
│   └── mime@1.2.6
└─┬ npm@1.1.59
  ├── abbrev@1.0.3
  ├── ansi@0.1.2
  ├── archy@0.0.2
  ├── block-stream@0.0.6
  ├── chownr@0.0.1
  ├── couch-login@0.1.10
  ├── fstream@0.1.18
  ├─┬ fstream-npm@0.1.1
  │ └── fstream-ignore@0.0.5
  ├── glob@3.1.12
  ├── graceful-fs@1.1.10
  ├── inherits@1.0.0
  ├── ini@1.0.4
  ├─┬ init-package-json@0.0.5
  │ └── promzard@0.2.0
  ├── lockfile@0.2.1
  ├── lru-cache@2.0.1
  ├── minimatch@0.2.6
  ├── mkdirp@0.3.4
  ├── node-gyp@0.6.7
  ├── nopt@2.0.0
  ├── npm-registry-client@0.2.6
  ├─┬ npmconf@0.0.11
  │ └─┬ config-chain@1.1.1
  │   └── proto-list@1.2.2
  ├── npmlog@0.0.2
  ├── once@1.1.1
  ├── osenv@0.0.3
  ├─┬ read@1.0.4
  │ └── mute-stream@0.0.3
  ├── read-installed@0.0.2
  ├── read-package-json@0.1.4
  ├── request@2.9.203
  ├── retry@0.6.0
  ├── rimraf@2.0.2
  ├── semver@1.0.14
  ├── slide@1.1.3
  ├── tar@0.1.13
  ├── uid-number@0.0.3
  └── which@1.0.5 
```

但如果我运行：

```
$ npm ls 
```

它返回空？

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2012-12-08T01:31:34.480

我有同样的问题，并`npm cache clear`没有解决它。此问题是因为`.npm`您的主目录中的目录是使用 root 权限创建的。您运行的第一个 npm 命令很可能是`sudo npm -g`现在您尝试`npm install`在本地目录中。

要解决：

*   `sudo chown -R yourusername ~/.npm`
*   这可能没有必要，但我也不得不`rmdir ~/tmp`

`npm install`来自 package.json 应该在此之后工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-17T19:14:36.713

我遇到了同样的问题，这个问题是因为你的主目录中的 .npm 目录是用 root 权限创建的。

利用 ：

```
$sudo npm install -g express 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-02T15:14:34.257

运行`npm cache clean` 并尝试再次安装

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-21T01:14:46.677

如果您看不出使用 sudo 有什么问题`npm install -g package_name`。并且在输入密码时遇到问题，您始终可以将自己添加到 sudoers 文件或`npm`可执行文件所属的同一组中。

因此，要将自己添加到 sudoers 以进行 npm 编辑`/etc/sudoers`，请在文件底部添加如下内容：

```
your_username  localhost=/usr/local/bin/npm 
```

[如果您需要更多详细信息，这](http://blog.i-evaluation.com/2013/11/21/npm-err-please-try-running-this-command-again-as-rootadministrator/)是有关如何实现这一目标的分步指南。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-10T02:13:35.570

在我的例子中，不是 root 拥有 ~/.npm 目录，而是 ~/tmp，直到其中一条错误消息最终让我找到它，我才想到要检查它。修复过程很简单，因为它是一个 tmp 目录，我们可以把它吹走，然后从你拥有的一个重新开始。

```
sudo rmdir ~/tmp
mkdir ~/tmp 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-28T16:25:31.050

解决方案是：

1 - chown 给您的用户 .npm 文件夹：

```
sudo chown -R Webmaste /Users/webmaste/.npm/ 
```

2 - 在您的测试文件夹或您的文件夹中：

```
sudo npm install -g express@2.5.8 
```

3 - 从您的实际位置调用快递：

```
/usr/local/share/npm/bin/express 
```

4 -

```
sudo cd . && npm install 
```

5 - 最后：

```
node app 
```

* * *

控制台中的最终消息应如下所示：

```
Express server listening on port 3000 in development mode 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-09-30T18:58:12.120

以管理员身份运行powershell，然后输入：

```
Set-ExecutionPolicy RemoteSigned 
```

然后再次尝试安装。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-07-22T10:47:20.193

作为旁注，如果您的其他解决方案没有帮助，我遇到了同样的问题并意识到出了什么问题——这可能在这里感兴趣。

我让 nodemon 在另一个项目上运行——当我在本地安装 express 时。检查您没有在另一个项目上运行 express 并尝试在新项目上安装 express。只是一个抬头，希望它有所帮助。顺便说一句，刚刚从包文件中复制了依赖项，并粘贴到我的新项目中并运行 npm install 并检查，express 安装好了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-04-05T16:24:40.600

转到 C:\Users\User_Name\AppData\Roaming\npm-cache_logs 并删除所有文件

然后再次运行：

```
npm install 
```

或者你重新安装 Nodejs 并勾选**Chocolatey**

您可以安装旧版本的 Nodejs 以与您正在构建的组件版本兼容[https://nodejs.org/en/download/releases/](https://nodejs.org/en/download/releases/)

# r - 如何在 Spot 实例处于活动状态后立即执行脚本？

> ID：12231847
> 
> 赞同：2
> 
> 时间：2012-09-01T22:15:44.247
> 
> 标签：r, amazon-ec2, amazon-web-services

首先，我想澄清一下，我是 AWS 的新手，特别是 Spot 实例，所以请原谅我缺乏特定的语言。

我必须实现以下设置：

*   每 8 小时创建一个 Spot 实例
*   每次运行一个 R 脚本（运行大约需要 35 分钟）
*   将结果写回我拥有的 RDS 持久实例（这发生在 R 脚本中）
*   关闭现场实例

到目前为止，我已经通过 AWS 开发工具包和自定义脚本工作了“每 8 小时创建一个现场实例”部分。

我遇到的问题是，我不确定如何在 Spot 实例中运行 R 脚本，一旦它变为“活动”。

我了解如何检查实例的状态，但不了解如何“调用”文件。

我想在另一台机器上运行一个 cron 作业，它会检查实例是否处于活动状态并调用该文件。

这是要走的路吗？如果是，我如何获取实例地址以便调用它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T10:12:26.833

有可用的[CloudInit 包](https://help.ubuntu.com/community/CloudInit)（至少在基于 Ubuntu 的 AMI 上）可以在实例启动时执行各种任务。您可以编写一个 shellscript 并将其放在 User-data 部分以在启动时执行它，调用您的 R 脚本。这应该比从另一台机器检查实例状态更容易。

# jquery - 如何通过 jquery 更新数据库

> ID：12231852
> 
> 赞同：0
> 
> 时间：2012-09-01T22:16:37.753
> 
> 标签：jquery, mysql

我最近开始学习 jquery 来运行我的游戏（以获得经验），我目前正在页面上使用自动刷新，这在我希望更新 mysql 服务器之前工作正常，我该怎么做？

我在 jquery 之前使用的方法只是让玩家按下一个按钮来加载一个新页面，在这个新页面上 PHP 代码将更新数据库，然后使用数据库中的新数据重新加载游戏页面。因此，新方法是只需按一下按钮即可更新数据库。

詹姆士

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T22:19:28.983

您仍将使用服务器端语言（如您习惯的 PHP）来访问数据库。您将使用 jQuery 进行 AJAX 调用，将您要保存的数据发送到 PHP 文件，该文件依次对其进行验证和清理，然后将其写入 DB。

您可以使用[`$.post()`](http://api.jquery.com/jQuery.post/), 通过 HTTP POST 请求发送数据，或者[`$.ajax()`](http://api.jquery.com/jQuery.ajax/)如果您需要更大的灵活性，也可以使用。

**一个非常简单的例子：**

```
$.post("/my-file-that-access-the-db.php", {
   someVariable: "some data"
}); 
```

在您的 PHP 文件中，您可以像访问任何其他 HTTP POST 请求一样访问数据：

```
$_POST["someVariable"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T22:30:42.700

你可以这样做：

```
var 1 = 'foo';
var 2 = 'bar';

$.post("scripts/php/write_to_db.php", {name: foo, email: bar}, function(data){

 ---handle echoed response from php script here---

}); 
```

然后，您将在 php 脚本中捕获 $_POST['name'] 和 $_POST['email']，这是我在本示例中发明的 url。

如果您需要更多说明，请告诉我...

斯科特

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T22:19:59.793

您仍然需要 PHPscript，而是调用 php 来使用 ajax/jQuery 更新数据库

```
$.get('update.php',data); 
```

或者 $.post 当然...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T22:21:07.770

据我所知，jquery 是一个基于 javascript 的 web 函数集，与 javascript 中的 MySQL 支持无关......你应该尝试使用 PHP（在 WEB 环境中）或在服务器端执行的其他一些语言来处理它。

如果要从 jquery 获取/发布 php 脚本，可以使用：[http ://api.jquery.com/jQuery.get/](http://api.jquery.com/jQuery.get/)

祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-01T22:22:16.423

Javascript 是一种客户端语言，因此您不能通过 jquery 更新数据库。

您将需要发布到为您进行更新的 php 文件。帖子可以通过 $.post 或 $.get 完成

# recursion - 在递归 Lua 函数中重置变量

> ID：12231855
> 
> 赞同：2
> 
> 时间：2012-09-01T22:17:24.870
> 
> 标签：recursion, lua, scope

我正在用 Lua 编写一个非常简单的程序，以了解有关遗传编程的更多信息。下面是一个 mutate 函数，用于转到`nodeNum`树 ( ) 中的编号节点 ( `pop`) 以及：将 add 与 sub 交换（反之亦然）或用随机数 1-100 替换节点。

```
local count = 0
function mutate(pop, nodeNum)
    for k,v in ipairs(pop) do
        if type(v) == "table" then
            mutate(v, nodeNum)
        else
            count = count + 1
        end

        if count == nodeNum and k == 1 then -- correct node
            if type(v) == "function" then
                if v == add then
                    pop[k] = sub
                else
                    pop[k] = add
                end
            else
                pop[k] = math.random(100)
            end
        end
    end
end 
```

我的问题是`count`. 调用这个函数很尴尬，因为`count`每次都必须重置：

```
-- mutate the first 3 elements in program tree t 
mutate(t,1)
count = 0
mutate(t, 2)
count = 0
mutate(t, 3) 
```

我尝试过使用`do ... end`类似的变化：

```
do
    local count
    function mutate(pop, nodeNum)
    if not count then
        count = 0
    ...
end 
```

我也尝试给 mutate 一个额外的参数`mutate(pop, nodeNum, count)`并调用它，`mutate(t, 1, 0)`但我无法让任何一种方法正常工作。

我可能遗漏了一些非常明显的东西，有人能看到更优雅的解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T03:43:37.770

```
function mutate(pop, nodeNum, count)
    count = count or 0

    for k,v in ipairs(pop) do
        if type(v) == "table" then
            mutate(v, nodeNum, count)
        else
            count = count + 1
        end

        if count == nodeNum and k == 1 then -- correct node
            if type(v) == "function" then
                if v == add then
                    pop[k] = sub
                else
                    pop[k] = add
                end
            else
                pop[k] = math.random(100)
            end
        end
    end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T22:24:12.467

我并没有真正使用 Lua，但是，最简单的方法可能不是创建另一个调用这个函数的函数，它在当前方法返回后将 count 设置为零？前任：

```
function mutateExample(pop, nodeNum)
    mutate(pop, nodeNum)
    count = 0;
end 
```

这样， mutate 可以递归地调用它自己，然后 count 将在完成后重置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T22:29:37.350

`count`必须是函数*内部*的局部变量，而不是函数外部。它是一个堆栈变量，所以把它放在函数的堆栈中：

```
function mutate(pop, nodeNum)
    local count = 0

    for k,v in ipairs(pop) do
        if type(v) == "table" then
            mutate(v, nodeNum)
        else
            count = count + 1
        end

        if count == nodeNum and k == 1 then -- correct node
            if type(v) == "function" then
                if v == add then
                    pop[k] = sub
                else
                    pop[k] = add
                end
            else
                pop[k] = math.random(100)
            end
        end
    end
end 
```

`local`如果您希望多个函数调用*共享*变量，则仅使用外部变量。

# deployment - 如何制作玩！框架 dist 命令将一些文件/文件夹添加到最终包中？

> ID：12231862
> 
> 赞同：25
> 
> 时间：2012-09-01T22:19:14.273
> 
> 标签：deployment, playframework, playframework-2.0

我想要戏剧！框架`dist`命令将一些文件夹和文件添加到最终的 zip 文件中。它们是应用程序工作所必需的。

有没有神奇的`project/Build.scala`配置可以让它成为可能？我在Play中找不到它！[文档](http://www.playframework.org/documentation/2.0/SBTSettings)。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-10-24T14:38:28.230

Play 使用[sbt-native-packager](http://www.scala-sbt.org/sbt-native-packager/)，它支持通过将任意文件添加到映射来包含它们：

```
mappings in Universal ++=
  (baseDirectory.value / "scripts" * "*" get) map
    (x => x -> ("scripts/" + x.getName)) 
```

语法假定 Play 2.2.x。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-29T20:26:28.807

我的 Play 应用程序不包括可分发的模板文件（在 app/views/ 中），我在 Build.scala 中添加了它们：

```
val main = play.Project(appName, appVersion, appDependencies).settings(
  // Add your own project settings here   
  playAssetsDirectories <+= baseDirectory / "app/views"
) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T12:14:24.950

通过查看`dist` [源代码](https://github.com/playframework/Play20/blob/master/framework/src/sbt-plugin/src/main/scala/PlayCommands.scala#L174)，我认为这是不可能的。

但是您可以使用该`play clean compile stage`命令来打包应用程序及其依赖项（来自[doc](https://github.com/playframework/Play20/wiki/Production)）：

> 这会清理并编译您的应用程序，检索所需的依赖项并将它们复制到目标/暂存目录。它还创建了一个运行 Play 服务器的目标/启动脚本。

然后，您必须编写自己的脚本来添加目录并构建 zip。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-05-23T10:56:37.707

不确定从哪个 Play 版本开始支持，但[Play！2.5 文档](https://www.playframework.com/documentation/2.5.x/Anatomy)建议您可以在“dist”文件夹（位于项目的根目录）下添加要打包的任意文件。我正在使用 SBT 原生打包程序将我的项目构建到 RPM 中，并且它可以完美地开箱即用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-02T17:00:32.843

我敢打赌，我不会让你满意，但也许你不会浪费时间去寻找。正如**Nico**指出的那样，没有这种可能性，您可以使用的最快方法是编写一个 bash 脚本（或 *.bat 文件）来做到这一点。

我花了一个小时来寻找解决方案……还有 15 分钟用于编写解压缩、修改、压缩文件并将文件发送到远程目的地的脚本，因此请考虑它是否也不是更好的选择。

# model-view-controller - 是否有内置 Zend 框架弹出窗口？

> ID：12231866
> 
> 赞同：1
> 
> 时间：2012-09-01T22:19:41.230
> 
> 标签：model-view-controller, zend-framework, popup

**是否有内置 Zend 框架弹出窗口？**

我想知道zend框架中是否有一个特性，当你点击一个链接时，它会在一个漂亮的弹出窗口中打开一个动作，比如smoothbox、lightbox等？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T02:50:42.950

理想情况下，它应该有。

但是，答案是否定的，它没有。

**为什么它应该有？**

Zend Framework 是一套完整的工具，用于创建网站的后端和前端。当程序员使用 Zend* 函数创建整个网站时，zend 服务器上的解析是有效的。在 Apache 服务器上，它只是一个 Web 应用程序，它将整个代码作为应用程序运行并编译所有库。在 Zend 服务器上，它已经具有已编译的库堆栈，编译所需的只是您的代码（应用程序/），仅此而已，一切就绪。这就是为什么部分前端由 Zend_Form* 函数和那些认为 ZF 与前端无关的人负责的原因，那么该框架将是不完整的！我们不仅有视图/脚本或视图/助手，我们甚至还有布局和许多功能来支持前端。

**为什么它没有？**

Zend 创建了框架来完成许多事情，然而，并非一切皆有可能，即使在今天我们也有 jQuery 仇敌！所以编译开发人员*可能*使用的东西列表有点问题。然而，他们为开发人员提供了直接将 HTML 编辑到视图中的能力，并为 Zend_Form* 下的一个类提供了装饰器。

**你应该怎么做？** 获取添加类的自定义代码并使用 Javascript 进行弹出。（就我个人而言，我更喜欢灯箱）而不是通过弹出一个窗口来惹恼用户！

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T07:14:23.707

实际上*Zend Framework*确实有一些可用的组件可供您使用。

If you have downloaded the *"Full Package"* version of ZF it includes the *Dojo Toolkit* which is supported by the core `Zend_Dojo` component. While `Zend_Dojo` appears to be primarily designed for working with form elements, there does appear to be some support for more advanced options. The Dojo Toolkit can be located at the path `\ZendFramework\externals\dojo`.

Also with the the *"Full Package"* is the *ZendX* library, located at `\ZendFramework\extras\library\ZendX` which includes a component to help integrate Jquery with ZF applications.

I do not as yet use javascript much so I have no idea how complete and useful these components are, I just know they exist.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T22:25:25.793

不，弹出窗口由 Javascript 处理，您只需命名几个包（如“lightbox”）来获得这种效果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T22:33:25.417

甚至没有内置的`href`生成器。我是说`<a>`标签。相反，您拥有生成 url 的 url 助手，以便在`<a href="...">`

**Zend Framework 运行在服务器端**，视图模板本身呈现在客户端。服务器端没有弹出窗口，但您可以使用视图助手来实现，以便生成具有 JS 组件（即 ligthbox）使用的必要属性的标签

请参阅[http://framework.zend.com/manual/en/zend.view.helpers.html](http://framework.zend.com/manual/en/zend.view.helpers.html)

# c++ - C++，结构初始化多个实例

> ID：12231871
> 
> 赞同：1
> 
> 时间：2012-09-01T22:20:21.493
> 
> 标签：c++, struct

我有一个结构初始化：

```
nodeBuf = new Node[num](); //num is some number of different instances of this struct 
```

我知道这会创建我的结构的 num 个实例。但我不确定如何访问每个实例。

我试过nodeBuf [num]，不工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:29:43.460

如果`num > 0`只有`nodeBuf[0]`直到`nodeBuf[num -1]`有效。如果`num == 0`则不允许通过索引运算符访问元素（= UB）。

样本：

```
结构节点
{
  标准::字符串名称；
};

无效 f()
{
  整数 = 4;
  Node* nodeBuf = new Node[num];
  nodeBuf[1].name = "测试";
  删除[] 节点缓冲区；
}

```

# c# - 有人看到这个（COM）错误号吗？(80040214) 从 UPnP.dll 调用 .QueryStateVariable 时？

> ID：12231873
> 
> 赞同：1
> 
> 时间：2012-09-01T22:20:39.030
> 
> 标签：c#, vb.net, visual-studio, vb6, upnp

*[虽然我在下面使用 VB6，但我很乐意接受 VB.NET 或 C# 中的解决方案，因为我可以用这两种方式编写]*

我正在尝试使用函数 QueryStateVariable() ，它只接受一个参数（一个描述要检索值的变量的名称的字符串），所以你像这样运行它：

```
Dim vReturn As Variant
vReturn = Service.QueryStateVariable("ExternalPort") 
```

服务对象正确设置为 UPnPService (WanIPConnection)。这发生在 WanIPConnection 服务下（直接在 Wan 连接设备下），我只能读取 17 个状态变量中的 4 个（我只是使用“ExternalPort”作为示例变量名）。其他所有变量都返回此错误号 -2147220972 (80040214)，并带有通用的“失败”描述消息：即：

```
Run-time error '-2147220972 (80040214)':
Method 'QueryStateVariable' of object 'IUPnPService' failed 
```

目前，我只是忽略它（忽略异常）并返回一个空字符串，但如果有人知道这可能意味着什么，或者只是我可以跟进的线索，那将是一个很大的帮助. 也许有人知道这个错误号是什么意思或指的是什么？或者，有没有人看到这个或者正在收到这个错误号或者以前遇到过它？它在 COM 世界中可能具有通用含义，但我无法在 google 上找到它。

如果你在google上搜索-2147220972没有命中，如果你去掉-符号，有几个但都指向不同的含义，如果你把单词upnp放在它旁边你得到0命中！现在，如果您搜索“80040214 upnp”（当然不带引号），您会得到 8 次点击，这几乎完全是用户在使用支持 UPnP 的软件并复制/粘贴他们的错误日志时遇到错误。不是程序员报告错误号并寻求帮助并获得解决方案或答案（本来会很棒）。

**更新：**我已经找到了这个错误代码的定义，但仍然没有接近解决它，因为描述非常笼统，并没有为我提供如何解决它的任何线索，但为了您的信息，here它是（也许对你们中的一些人更有意义）：

**UPNP_E_DEVICE_ERROR 的定义：**

**“变量未发生事件，远程查询返回错误代码。这不是传输错误；设备收到请求，但返回错误”。**

.

.

****下面写的附加文本不是解释此问题的必要阅读，但包括那些对附加信息感兴趣的人：* ***

我已经从我的程序中生成了一个日志作为输出，因此我可以将 17 个变量中的每一个的结果（并尝试获取它们的值）粘贴到 StackOverflow 中。回顾一下，WanIPConnection 服务有 17 个变量，所以我已经尝试并记录了所有变量（只有 4 次成功尝试，其余是运行时错误）和 WanPPPConnection 服务（与 WanIPConnection 服务非常相似）但总共有19 个状态变量（仅比 WanIPConnection 多 2 个）。我已经尝试（并记录了）所有 19 次变量检索尝试，并且只收到了 4 次成功的值返回（所有其他都以运行时错误结束） - 所以，我从 WanIPConnection 和 WanPPPConnection 获得了 4 次成功。

这是我的日志，我的真实 IP 地址已更改（因为我知道如果我不大声笑，我会被激怒），并且当前设置的设备和服务在两个日志中的每一个的开头都说明（显示），在这里是：

*[注意避免混淆：我*在检索到的值周围放置星号（

**第一个日志（WanIPConnection，17 个状态变量）：**

> 设置uDevice（当前设置的设备）为：WAN Connection Device，NETGEAR WNR1000v3 N150 Wireless Router，urn:schemas-upnp-org:device:WANConnectionDevice:1
> 
> 设置uService（当前设置服务）为：urn:schemas-upnp-org:service:WANIPConnection:1
> 
> 1 次（共 1 次）尝试完成 GetQSV（用于 ConnectionStatus）。QSV 的长度为 9（大于 0）。返回值为已*连接*（非空）。
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（对于 ConnectionType）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 1 次（共 1 次）尝试完成 GetQSV（用于 ExternalIPAddress）。QSV 的长度为 13（大于 0）。返回值为*110.122.16.83*（非空）。
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（用于 ExternalPort）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 1 次（共 1 次）尝试完成 GetQSV（用于 InternalClient）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（用于 InternalPort）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（针对 LastConnectionError）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 (of 1) 次尝试中完成 GetQSV（用于 NATEnabled）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 (of 1) 次尝试中完成 GetQSV（用于 PortMappingDescription）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 1 次（共 1 次）尝试完成 GetQSV（用于 PortMappingEnabled）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（用于 PortMappingLeaseDuration）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 (of 1) 次尝试中完成 GetQSV（用于 PortMappingNumberOfEntries）。QSV 的长度为 1（大于 0）。返回值为*2*（非空）。
> 
> 在 1 (of 1) 次尝试中完成 GetQSV（用于 PortMappingProtocol）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（对于 PossibleConnectionTypes）。QSV 的长度为 9（大于 0）。返回值为 *IP_Routed*（非空）。
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（用于 RemoteHost）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 (of 1) 次尝试中完成 GetQSV（对于 RSIPAvailable）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（用于正常运行时间）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0

**第二个日志（WanPPPConnection，19 个状态变量）：**

> 设置uDevice（当前设置的设备）为：WAN Connection Device，NETGEAR WNR1000v3 N150 Wireless Router，urn:schemas-upnp-org:device:WANConnectionDevice:1
> 
> 设置uService（当前设置服务）为：urn:schemas-upnp-org:service:WANPPPConnection:1
> 
> 在 1 (of 1) 次尝试中完成 GetQSV（用于 DownstreamMaxBitRate）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 (of 1) 次尝试中完成 GetQSV（对于 UpstreamMaxBitRate）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 1 次（共 1 次）尝试完成 GetQSV（用于 ConnectionStatus）。QSV 的长度为 9（大于 0）。返回值为已*连接*（非空）。
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（对于 ConnectionType）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 1 次（共 1 次）尝试完成 GetQSV（用于 ExternalIPAddress）。QSV 的长度为 13（大于 0）。返回值为*110.122.16.83*（非空）。
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（用于 ExternalPort）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 1 次（共 1 次）尝试完成 GetQSV（用于 InternalClient）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（用于 InternalPort）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（针对 LastConnectionError）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 (of 1) 次尝试中完成 GetQSV（用于 NATEnabled）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 (of 1) 次尝试中完成 GetQSV（用于 PortMappingDescription）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 1 次（共 1 次）尝试完成 GetQSV（用于 PortMappingEnabled）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（用于 PortMappingLeaseDuration）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 (of 1) 次尝试中完成 GetQSV（用于 PortMappingNumberOfEntries）。QSV 的长度为 1（大于 0）。返回值为*2*（非空）。
> 
> 在 1 (of 1) 次尝试中完成 GetQSV（用于 PortMappingProtocol）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（对于 PossibleConnectionTypes）。QSV 的长度为 9（大于 0）。返回值为 *IP_Routed*（非空）。
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（用于 RemoteHost）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 (of 1) 次尝试中完成 GetQSV（对于 RSIPAvailable）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0
> 
> 在 1 次（共 1 次）尝试中完成 GetQSV（用于正常运行时间）。QSV 的长度为 0（长度检查失败）。返回值为**（非空）。[-2147220972] 对象 'IUPnPService' 的方法 'QueryStateVariable' 失败 LastDllError: 0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T14:00:06.923

我认为您已经找到的文档说得很清楚：

> 变量未发生事件，远程查询返回错误代码。...此方法从服务对象的本地缓存中检索事件变量的值。缓存包含最后一个事件通知中指示的每个变量的值。

快速查看 UPnP 规范可以`InternetGateway.WANIPConnection`确认您失败的变量确实**不是 evented**。这意味着“服务对象的本地缓存”不能包含这些变量的任何值。设备根本没有提供任何东西。**您成功获得的变量只是事件变量**。

微软文档甚至在“备注”部分说：

> UPnP 论坛不鼓励使用这种方法。如果可能，请使用特定于服务的操作（如果已提供）。

“特定于服务的操作”主要命名为“Get[TheVariableName]”。我不熟悉这个特定的 SCPD，但再次快速查看 UPnP 规范会得出：

```
ConnectionType = GetConnectionTypeInfo
ExternalPort,InternalClient,InternalPort = GetGenericPortMappingEntry
LastConnectionError = GetStatusInfo 
```

等等

# java - 何时使用字节流或字符流来读/写文本

> ID：12231874
> 
> 赞同：1
> 
> 时间：2012-09-01T22:20:50.153
> 
> 标签：java, character, byte

我是一个java新手。

我知道必须使用字符流来读/写字符和字节流来读/写字节。

但是，我也可以使用字节流来读/写字符。

我也明白，在使用国际通用的应用程序时，字符流是首选。

1.  您能否就在读取/写入“文本”数据时何时使用字符流和字节流提供一些建议？

2.  word/excel/pdf 文档中的文本可以使用字符流简单地读取吗？

3.  在读取外部创建的文本数据时，何时以及如何知道何时使用 UTF-8/Western/ISO 等字符编码？（我很抱歉这是一个模糊的问题......但请帮忙）

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T01:52:37.147

1.  当您知道数据是文本时，请使用 Readers 和 Writers。否则使用流。

2.  不，您不知道数据是文本，因此请参阅 (1)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-01T23:20:29.023

通常，如果您只想读取这样的文件并将其发送到其他地方，或者guardrlo 总是最好用于字节。

对于处理字节的文件，建议使用缓冲区，例如“BufferedOutputStream”。

另一方面，如果您需要使用文本来阅读内容，则始终建议您了解“编码”您将获得的信息。最通用的选项是“BufferedReader”，使用此选项，您将使用具有 java.util 的“encode”默认值。

最后评论说您无法直接读取文件 Work、Excel 等...因为它们已格式化，您需要允许您阅读的工具，我使用“Apache POI”。

问候，

# java - 将 SpannableString 传递给函数，返回 SpannableString

> ID：12231881
> 
> 赞同：1
> 
> 时间：2012-09-01T22:21:44.130
> 
> 标签：java, spannablestring

我正在使用一段代码，它通过 SpannableString 文本寻找正则表达式并删除该表达式的任何实例的第一个和最后一个字符 - 在本例中，文本由 [方括号] 绑定。

输出应该是相同的 SpannableString，但没有括号。例如：

```
input: Text [that] looks [like this]
output: Text that looks like this 
```

但是，我无法正确调用函数并以 SpannableString 格式返回文本。

这是进行转换的代码片段：

```
public static CharSequence removeSquareBracketsFromText(CharSequence text) {

    SpannableStringBuilder outputText = new SpannableStringBuilder( text );

    if( pattern != null )
    {
        Matcher matcher = pattern.matcher( text );
        int matchesSoFar = 0;
        while( matcher.find() )
        {
            int start = matcher.start() - (matchesSoFar * 2);
            int end = matcher.end() - (matchesSoFar * 2);
            outputText.setSpan( text, start + 1, end - 1, 0 );
            outputText.delete(start, start + 1);
            outputText.delete(end - 2, end -1);
            matchesSoFar++;
        }
    }
    return outputText;
} 
```

当我将 SpannableString 传递给函数时，我（尝试）这样做：

```
SpannableString outputText= removeSquareBracketsFromText(inputText); 
```

我怀疑错误出在我调用函数的方式的语法中，但我不确定。我的 IDE（Eclipse）告诉我错误出现在单词中（removeSquareBracketsFromText'：“类型不匹配：无法从 CharSequence 转换为 SpannableString”。

任何帮助表示赞赏。正如您可能知道的那样，我对 Java 相当陌生，并且习惯于在后台处理变量类型转换的 MATLAB。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T22:52:31.320

将方法声明更改为此：

```
public static SpannableString removeSquareBracketsFromText(CharSequence text) { 
```

并将返回语句更改为：

```
 return new SpannableString(outputText); 
```

# php - 国际化 CakePHP 1.3 未更新

> ID：12231882
> 
> 赞同：0
> 
> 时间：2012-09-01T22:22:01.447
> 
> 标签：php, cakephp, cakephp-1.3, poedit

很久以前我正在开发这个项目，现在我又回来了。国际化工作正常，从`C:\...\cake\app\locale\por\LC_MESSAGES`我有 2 个文件的文件夹中获取翻译：

```
default.mo
default.po 
```

我编辑了 po 文件，手动插入了一些新的关键字，例如：

```
msgid "id"
msgstr "Código" 
```

然后，我打开 Poedit，验证所有内容，然后单击“保存”，因此 Poedit 会自动创建 .mo 文件。

之后我重新启动了 WAMP，并清除了我的缓存。

我做了很多次，但结果总是一样：旧词翻译得很好，但我最近添加的新词不翻译。

旧的和新的，我在我的 CakePHP 1.3 项目中以这种方式使用：

```
<?php __('id'); ?> 
```

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T08:37:42.253

使用替代编辑器。我建议使用[https://poeditor.com/](https://poeditor.com/) 这是在线解决方案，易于使用。还具有导入和导出选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-31T08:45:30.350

.mo 文件是编译后的翻译，可能会被`gettext`引擎缓存。

您应该禁用 .mo 文件的生成（至少在开发期间），以便始终获取翻译中的更改。

# ios - UITableView 自定义单元格不刷新

> ID：12231884
> 
> 赞同：4
> 
> 时间：2012-09-01T22:22:21.560
> 
> 标签：ios, uitableview

关于刷新自定义表格单元格有很多问题，但这个问题很奇怪。我有一个 tableView，每个单元格现在都有一个自定义`UILabel`和`UIImageView`.

目前只有2个细胞。第一个显示日期。当表格首次加载时，它将当前日期显示为第一个单元格中的字符串`UILabel`。

当我选择第一个单元格时，我会展示一个处理所有日期选择的自定义类。一旦选择了日期，就会弹出这个视图，然后我会返回到表格视图。

在 上`-(void)viewDidAppear`，tableviews 数据被重新加载，并且应该出现新的选定日期。

但是，第一个单元格中的标签不会更新。

令人困惑的是，如果我有多个单元格都显示相同的数据，那么这些单元格都会按预期刷新并显示新日期。似乎 index: 0 处的单元格行不会刷新。

更令人困惑的是，当我查询`UILabel`单元格的字符串值时，它返回正确的日期。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

        // 
        // clears the grouped style border from each table cell
        //

        UIView *clearBgView = [[UIView alloc]initWithFrame:CGRectZero];
        [cell setBackgroundView:clearBgView];

        // label
        UILabel *dl = [[UILabel alloc]initWithFrame:CGRectMake(70.0f, 10.0f, screenWidth-100, 50)];
        [self setDetailsLabel:dl];
        dl = nil;

        [[self detailsLabel] setBackgroundColor:[UIColor colorWithRed:.1 green:.1 blue:.1 alpha:.1  ]];
        [[self detailsLabel] setTextColor:[UIColor colorWithRed:1.0f green:1.0f blue:1.0f alpha:.3f]];

        //icon for each cell
        UIImageView *ci = [[UIImageView alloc]initWithFrame:CGRectMake(10.0f, 10.0f, 50.0f, 50.0f)];
        [ci setBackgroundColor:[UIColor colorWithRed:.2 green:.2 blue:.2 alpha:.2]];
        [self setCellIcon:ci];
        ci = nil;

        //
        // set up views
        //

        [cell addSubview:[self cellIcon]];
        [cell addSubview:[self detailsLabel]];
    }

    // Configure the cell...
    [cell setSelectionStyle:UITableViewCellSelectionStyleNone];

    //populate each by row.
    NSString *dateDisplay = [self formatDate:[self dateCaught]];
    NSLog (@"date is %@", dateDisplay);
   [[self detailsLabel] setText:[self formatDate:[self dateCaught]]];

    switch (indexPath.row) { //this needs to be an integer, so return the row of the indexPath.
        case 0:
            NSLog (@"text for the cell is %@",[[self detailsLabel]text]);
            break;

        default:
            break;
    }

return cell; 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T22:33:00.363

问题与您通过`detailsLabel`周围的方式有关。你把它保存在一个属性或一个 ivar 上`self`

```
[self setDetailsLabel:dl]; 
```

但仅当单元格*不可*重用时才设置它。当您重复使用单元格时，`detailsLabel`on`self`会设置为之前运行的标签，从而导致您出现各种问题。

The cleanest solution is to create your own class deriving from `UITableViewCell`, move the initialization code that creates labels, icons, background colors, and so on into the designated initializer, and create properties for setting label texts. With this class in place, you would be able to simplify your code as follows:

```
UIMyCustomTableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[UIMyCustomTableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
}
[cell setSelectionStyle:UITableViewCellSelectionStyleNone];
[[cell detailsLabel] setText:[self formatDate:[self dateCaught]]];
// ^--- detailsLabel can be moved to UIMyCustomTableViewCell now 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T22:38:08.997

The solution is, to not use a member variable like `@property detailsLabel`, but instead tags for all custom subviews. Change your code like this:

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        static NSString *CellIdentifier = @"Cell";
        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
        if (cell == nil) {
            [...]

            // label
            UILabel *dl = [[UILabel alloc]initWithFrame:...];
            dl.tag = 99;
            [cell.contentView addSubview: dl];

            [...]
        }

        [...]

       UILabel *dl = [cell.contentView viewWithTag: 99];
       [dl setText:[self formatDate:[self dateCaught]]];

       [...]
       return cell;
} 
```

# python - 通过数据python引用列表对象

> ID：12231891
> 
> 赞同：-2
> 
> 时间：2012-09-01T22:24:02.537
> 
> 标签：python, list

他们有什么方法可以通过数据直接引用 Python 中的列表对象吗？

在 list[{'id':'', 'value':{}},{}] 我想设置一个 'id' 的值，而不是迭代列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T22:27:34.833

如果给定

```
mylist = ['id', value] 
```

您可以`value`通过分配来更改

```
mylist[1] = new_value 
```

虽然这个问题对我来说不是很清楚，但听起来你几乎想要在这里使用字典而不是列表，如果你要拥有标识符/值对。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T22:49:14.527

不，你不能。您只能通过引用而不是数据来引用某些内容。在你的情况下：

```
mylist = ['id', value] 
```

`mylist[1]`是对内存中某个点的引用（指针），其中包含数据`value`。您不能单独引用数据（好吧，从技术上讲，您可以，只是没有任何意义）。

但是，您可以通过以下方式*获得*对数据的引用

```
mylist[mylist.index(value)] 
```

在这种情况下，`mylist.index(value)`获取第一次出现的索引`value`而不“遍历列表”。但是，您应该知道，即使这样，Python 也在底层“迭代列表”（取决于 Python 的实现）。这只是数组在二进制级别上的工作方式；你必须在某个时候迭代。（见[http://docs.python.org/py3k/library/stdtypes.html#sequence-types-str-bytes-bytearray-list-tuple-range](http://docs.python.org/py3k/library/stdtypes.html#sequence-types-str-bytes-bytearray-list-tuple-range)）

# php - Codeigniter 购物车：再次添加相同的产品

> ID：12231892
> 
> 赞同：4
> 
> 时间：2012-09-01T22:24:03.690
> 
> 标签：php, codeigniter, shopping-cart

我是第一次尝试 CodeIgniter 的购物车库。我已经设置了所有会话，当我将商品添加到购物车时，它会出现在 $this->cart->contents(); 到现在为止还挺好。添加看起来像这样：

```
$data = array( 'id'      => 1,
               'qty'     => 1,
               'price'   => 20,
               'name'    => "Item1");

$rowid = $this->cart->insert($data); 
```

但是当我再次尝试添加相同的商品时，它不会增加购物车中该商品的数量。我想象执行相同的插入会再增加一个，将该行的数量增加到 2，但事实并非如此。

如果我添加不同的产品，它会出现在第一个产品旁边。但同样，尝试添加另一个该产品未能增加计数。

我当然错过了一些东西。也许你知道它是什么。

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T22:35:39.583

我相信仅添加两个项目不会将它们加在一起以获得新的数量。

您实际上可以使用新的数量 [qty] 值更新购物车。请参阅此页面的“更新购物车”部分：http: [//codeigniter.com/user_guide/libraries/cart.html](http://codeigniter.com/user_guide/libraries/cart.html)

注意：您可能需要执行以下操作：

1.  `$this->cart->product_options($rowid);`使用或通过遍历所有项目并找到正确的项目来获取产品详细信息`$this->cart->contents();`
2.  从该数组中获取数量
3.  数量加一
4.  `$rowid`用新的数量值更新它

希望有帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T23:31:05.187

不久前我在我的应用程序中需要类似的东西，所以我编辑了一些 CI 购物车功能。看看这个线程。

[Codeigniter 购物车](https://stackoverflow.com/questions/12216039/codeigniter-shopping-cart/12217482#12217482)

我希望您可以使用其中的一些代码，至少它会为您指明正确的方向。

# python - 在 Python 中重载 str

> ID：12231894
> 
> 赞同：0
> 
> 时间：2012-09-01T22:24:17.207
> 
> 标签：python

我的代码如下所示：

```
class C(str):
    def __init__(self, a, b):
        print('init was called!')
        super().__init__(b)

        self.a = a

c = C(12, 'c') 
```

当我尝试运行它时，它给了我以下错误：

```
Traceback (most recent call last):
  File "C:\Users\math4tots\eclipseMeta\hemi\SalgebraPL\sapl.py", line 15, in <module>
    c = C(12, 'c')
TypeError: coercing to str: need bytes, bytearray or buffer-like object, int found 
```

我很困惑。甚至似乎都没有调用我的 init 方法。这是怎么回事？

我不确定它是否相关，但我使用的是 Python 3.2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:27:08.290

我不确定您为什么会收到您遇到的特定错误，但无论如何您都需要`__new__`覆盖`__init__`.

# linux - 启动 VLC 后如何运行其余脚本？

> ID：12231896
> 
> 赞同：1
> 
> 时间：2012-09-01T22:24:43.480
> 
> 标签：linux, bash, shell, vlc

启动 VLC 后，终端似乎被锁定。我什至无法回应任何东西。我尝试过分叉 VLC 的启动，但这似乎也使整个脚本崩溃。 **还有其他选择吗？** 顺便说一句，我正在使用 cvlc，因为我不关心用户界面。我的其他尝试用标签注释掉了：

```
echo "launching VLC player..."
# cvlc v412://dev/video1:standard=NTSC:width=640:height=480 &
# cvlc v412://dev/video1:standard=NTSC:width=640:height=480&
# cvlc & v412://dev/video1:standard=NTSC:width=640:height=480
cvlc v412://dev/video1:standard=NTSC:width=640:height=480

echo "can i see this in terminal?" 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:41:20.277

发送`cvlc`到后台`&`为我工作。

```
echo "launching VLC player..."
cvlc v412://dev/video1:standard=NTSC:width=640:height=480 &
echo "can i see this in terminal?" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-25T19:40:43.863

我找到了这个：追加`vlc://quit`到命令的末尾。不知道为什么它有效，但它确实有效。例如：

```
cvlc rtsp://$IP/$CAM_STRING --sout file/avi:$(date +%Y%m%d%H%M).avi --run-time=$RUN_TIME --stop-time=$RUN_TIME vlc://quit 
```

# css - 字体大小会影响连字的呈现吗？

> ID：12231904
> 
> 赞同：5
> 
> 时间：2012-09-01T22:25:53.680
> 
> 标签：css, webkit, gecko, text-rendering, ligature

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T23:33:22.837

Firefox 支持一个首选项`browser.display.auto_quality_min_font_size`，允许您调整它用来决定是否选择其字体呈现路径的值。然而，在当前版本的 Firefox 中，唯一仍然支持这一点的代码部分是在 Windows XP 上，其中小字体或显式`text-rendering: optimizeSpeed`将使用 GDI 而不是 Uniscribe 呈现。

请注意，Thunderbird 出于某种原因将该首选项的值设置为零。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T14:21:08.063

你的分析是正确的。一些额外的观察：

显然[CSS3 字体](http://www.w3.org/TR/css3-fonts/)`font-variant-ligatures`中描述的属性还没有实现。相反，Firefox 使用前缀 实现了低级属性，因此您实际上可以通过设置来阻止 Firefox 应用连字`font-feature-settings``-moz-`

```
-moz-font-feature-settings: 'liga' 0 
```

在一个元素上。

如果您希望防止在特定情况下出现连字，您可以在可能被连字的字符之间插入 ZERO-WIDTH NON-JOINER (ZWNJ)，例如，`f&zwnj;i`而不是`fi`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-01T22:41:34.177

实际上，MDN 页面说 20px 或更高的文本会以任何一种方式获得连字，其中 optimizeLegibility 会覆盖它。

更一般地说，使用连字是否值得（以及影响易读性的其他因素，例如任何两个特定字形之间的特定字距调整）不仅因大小而异，而且因字体而异。发现随着版本的迅速变化，我不会感到惊讶。当然，底层技术并没有停滞不前。

# javascript - 关闭中的 Javascript 值

> ID：12231905
> 
> 赞同：1
> 
> 时间：2012-09-01T22:25:54.203
> 
> 标签：javascript, closures

我真的无法解释为什么我无法创建一个闭包，我得到`undefined`了下面的代码：

```
function A() {
 this.p1=1;
 this.p2=2;
 this.f1=function(){
    alert(this.p1);
 }
 this.f2=function(){
    alert(this.p2);
    }
 this.action=function(param){
    if (param=='1')
        return this.f1;//by case
    else if (param=='2')
        return this.f2;
    };
}

var v=new A();
v.action("1")(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T22:31:02.203

这与闭包无关。

您正在从该方法返回一个函数引用，当您调用它时，您希望它作为对象中的方法执行，但它是作为具有全局范围作为上下文的函数执行的。

使用[`call`方法](http://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)在对象的上下文中调用函数：

```
v.action("1").call(v); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T22:36:36.410

函数没有绑定到特定的 this，也就是说：

```
(function() { console.log(this) })(); // Window 
```

您可以使用 call 方法，或者（更好）使用 .bind 方法（确保为旧浏览器使用 polyfill）：

```
function A() {
 this.p1 = 1;
 this.p2 = 2;
}
A.prototype.f1 = function() {alert(this.p1)};
A.prototype.f2 = function() {alert(this.p2)};
A.prototype.action = function(param) {
  if ('1' == param) {
    return this.f1.bind(this);
  } else if (param == '2') {
    return this.f2.bind(this);
  }
};

var v = new A();
v.action("1")(); // 1 
```

bind 方法返回一个新函数，该函数调用原始函数，并将 this 设置为 bind 的参数。[MDN 上的 Function.prototype.bind 文档](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)

`v.action("1")`大致相同`action.call(v, "1")`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-01T22:40:08.790

在我看来，您不能 100% 确定闭包是什么……从您的代码开始：

```
function A()
{
    this.p1=1;//public
    var p2=2;//private
    this.f1=function()
    {
        alert(this.p1);
    };
    this.f2=function()
    {
        alert(p2);
    }; 
```

在这里，我定义`p2`了一个变量，在构造函数的范围内是本地的，但是公共方法`f2` *可以*访问它的值，甚至可以改变它。这是一个闭包：代码/数据包含在它自己的特定范围内。您正在使用以下代码做什么：

```
 this.action=function(param)
    {
        if (param=='1')
        {
            return this.f1;
        }
        return this.f2;
    };
}
var v=new A();
v.action("1")(); 
```

与闭包几乎没有关系，您正在返回对函数的引用（在这种特定情况下恰好是对象方法）。为什么，那么这不是`point`它来自的对象吗？简单的：

```
var foo = {name:'someObject'};
foo.retVal = v.action('1');//returns function
//much later:
foo.retVal(); 
```

您是否仍然希望`this`指向`v`？调试起来不是很糟糕吗？在调用函数（方法与否）时，`this`将是调用函数的上下文对象的指针。一旦`v.action('1')`返回，在您的示例中，该函数将返回到全局对象，因此 this 将指向`this`或`window`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T22:56:32.260

如你所愿

```
v.action("1") 
```

返回定义为的函数

```
function(){
    alert(this.p1);
} 
```

您也可以通过添加一对括号来调用它，就像您所做的那样。但是`this`，该函数中的 将绑定到全局对象（在浏览器中是`window`）。并且`window.p1`是`undefined`。这就是你得到的输出。

如前所述，您可以通过使用而不是方括号来决定`this`函数中应该包含的内容：`call`

```
v.action("1").call(v); 
```

`this`JavaScript 中的含义非常令人困惑。帮助我理解的解释可以在第*3.3节中找到***[Javascript 在十分钟内](https://github.com/spencertipping/js-in-ten-minutes/blob/master/js-in-ten-minutes.pdf?raw=true)***的这个（令人震惊的灾难）的含义（***尽管整个文档需要十多分钟，但值得一读）。**

 *** * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-01T22:34:12.697

在这样的闭包内部，“this”实际上是指稍后调用的 Window。为了避免这种情况，您需要将“this”分配给另一个变量，例如“that”：

```
function A() {
var that = this;
 that.p1=1;
 that.p2=2;
 that.f1=function(){
    alert(that.p1);
 }
 that.f2=function(){
    alert(that.p2);
    }
 that.action=function(param){
    if (param=='1')
        return that.f1;//by case
    else if (param=='2')
        return that.f2;
    };
}

var v=new A();
v.action("1")(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-01T22:34:28.187

在您的嵌套函数内部`this`还有另一个含义。尝试使用变量在内部传递引用，请参阅[jsfiddle](http://jsfiddle.net/2VyyG/)。**

# iphone - 在没有核心位置的情况下查找用户所在城市

> ID：12231910
> 
> 赞同：0
> 
> 时间：2012-09-01T22:26:36.513
> 
> 标签：iphone, ios, location, core-location

在我正在开发的应用程序中，我只需要知道用户所在的城市，我不需要确切的位置。我可以用手机信号知道这个城市吗？

另外，每次我使用 coreLocation 框架时，应用程序会询问用户的权限吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T22:31:27.693

如果您告诉它获取不准确的位置，核心位置将为您使用电话信号。

只是设置`desiredAccuracy`了十公里，它不会使用 GPS。

# web-services - Web Service调用如何等待N秒并中止

> ID：12231914
> 
> 赞同：1
> 
> 时间：2012-09-01T22:26:52.240
> 
> 标签：web-services, c#-3.0

我们有一个 SLA，第三方 RESTfull Web 服务必须在 5 秒内返回响应。否则我们需要中止服务调用并执行其他部分的业务逻辑。

有人可以帮助我了解如何使用 C#.Net。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T23:41:38.163

如果您使用 WCF 调用外部 Web 服务，则只需将客户端端点绑定配置中的 sendTimeout 值配置为 5 秒。然后，如果客户端代理对象没有从外部服务获得回复，则会抛出 TImeoutException，您可以处理并继续。示例绑定配置如下所示：

```
<system.serviceModel>
  <bindings>
    <basicHttpBinding>
      <binding name="myExternalBindingConfig"
               openTimeout="00:01:00"
               closeTimeout="00:01:00"
               sendTimeout="00:05:00"
               receiveTimeout="00:01:00">
       </binding>
    </basicHttpBinding>
  </bindings>
</system.serviceModel> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T23:34:59.277

让我先提供“标准免责声明”作为我的回答的序言，我将在这里提供的部分实践被认为是*不好的*，因为可能存在处理非托管代码的问题。话虽如此，这里有一个答案：

```
void InitializeWebServiceCall(){

    Thread webServiceCallThread = new Thread(ExecuteWebService);
    webServiceCallThread.Start();
    Thread.Sleep(5000); // make the current thread wait 5 seconds
    if (webServiceCallThread.IsAlive()){
      webServiceCallThread.Abort(); // warning for deprecated/bad practice call!!
    }
}

static void ExecuteWebService(){

    // the details of this are left to the consumer of the method
    int x = WebServiceProxy.CallWebServiceMethodOfInterest();
    // do something fascinating with the result

} 
```

调用 Thread.Abort() 自 .NET 2.0 起已弃用，并且通常被认为是一种糟糕的编程实践，主要是因为可能与非托管代码进行不利交互。当然，与使用代码相关的风险是由您来评估的。

# python - Pyglet 处理程序和删除的对象

> ID：12231929
> 
> 赞同：2
> 
> 时间：2012-09-01T22:29:05.303
> 
> 标签：python, pyglet

在我使用 Python 和 pyglet 的游戏中，我有一些组将事件向下传播到其成员：

```
class Group(EventDispatcher):
    def __init__(self):
        self.members = []
    def add(self, member):
        self.members.append(member)
        self.push_handlers(member)
    def remove(self, member):
        self.members.remove(member)
        # and then what???
Group.register_event('on_event') 
```

如果我`del`所有对成员的引用并 remove() 它，Group 中的处理程序会阻止对象被垃圾收集吗？处理程序会消失（weakref）吗？如果没有，我该如何清理处理程序？

编辑：我跑了我的测试会话，看看会发生什么：

```
>>> from pyglet.event import EventDispatcher
>>> class Group(EventDispatcher):
...  pass
... 
>>> Group.register_event_type('on_tick')
'on_tick'
>>> g = Group()
>>> class Members:
...  def on_tick(self):
...   print('tick')
... 
>>> m = Members()
>>> g.push_handlers(m)
>>> g.dispatch_event('on_tick')
tick
>>> del m
>>> g.dispatch_event('on_tick')
tick
>>> class B:
...  def on_tick(self):
...   print(self.x)
... 
>>> m = B()
>>> g.push_handlers(m)
>>> g.dispatch_event('on_tick')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python3.2/site-packages/pyglet/event.py", line 355, in dispatch_event
    if handler(*args):
  File "<stdin>", line 3, in on_tick
AttributeError: 'B' object has no attribute 'x'
>>> m.x = 3
>>> g.dispatch_event('on_tick')
3
tick
>>> del m
>>> g.dispatch_event('on_tick')
3
tick 
```

所以我猜 EventDispatcher 仍然保留对处理程序的引用。因此，问题变成了如何清理处理程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T05:09:16.517

EventDispatcher.remove_handlers 与 push_handlers 相反。所以调用 remove_handlers(m) 然后 del m 将允许 m 被垃圾收集。

# c++ - OpenGL，C++，为什么 glutReshapeFunc 函数会给出黑色的 opengl 屏幕？

> ID：12231936
> 
> 赞同：0
> 
> 时间：2012-09-01T22:29:55.433
> 
> 标签：c++, linux, function, opengl, window-resize

我一直在关注 opengl 教程，但由于某种原因，当我添加了重塑功能（用于调整窗口大小以修复比率）时。opengl 窗口根本不显示对象（形状），只是一个黑屏。我不知道我是否拼写错误或其他什么。

重塑功能是否搞砸了？

```
#include <GL/gl.h>
#include <GL/glut.h>

void renderScene(void);
void changeSize(int w, int h);

int main(int argc, char **argv){

// init GLUT and create window
glutInit(&argc, argv);
glutInitDisplayMode(GLUT_DEPTH | GLUT_DOUBLE | GLUT_RGBA);
glutInitWindowPosition(100,100);
glutInitWindowSize(320,320);
glutCreateWindow("Testing");

// register callbacks
glutDisplayFunc(renderScene);

// animation in reshaping
glutReshapeFunc(changeSize);

// enter GLUT event processing cycle
glutMainLoop();

return 1;
}

void renderScene(void){

glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

glBegin(GL_TRIANGLES);
    glVertex3f(-0.5,-0.5,0.0);
    glVertex3f(0.5,0.0,0.0);
    glVertex3f(0.0,0.5,0.0);
glEnd();

glutSwapBuffers();
}

void changeSize(int w, int h){

if (h==0)
    h = 1;
float ratio = 1.0*w/h;

// use the projection matrix
glMatrixMode(GL_PROJECTION);

//reset matrix
glLoadIdentity();

// set the viewpoint to be the entire window
glViewport(0,0,w,h);

// set the correct perspective
gluPerspective(45, ratio, 1, 1000);

// get back to the modelview
glMatrixMode(GL_MODELVIEW);
} 
```

谢谢你的帮助！这是来自 Lighthouse3d 教程。

PS：如果我取出重塑功能，三角形就会出现（工作正常）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T22:48:52.343

从您使用 gluPerspective 定义的投影矩阵中看不到您的三角形。

该矩阵定义了一个视锥，指向 -z 方向，近平面在 z=-1，远平面在 z=-1000。

您的三角形位于 z=0 平面上，因此不可见。

您可以：

1.  在 z 方向上将三角形进一步向后移动（`glTranslate(0,0,-2)`或手动移动顶点）。

2.  使用将相机移离 (0,0,0) 的视图矩阵，例如使用`gluLookAt`

3.  使用包含 z=0 平面的正交投影矩阵，例如`glOrtho(-1, 1, -1, 1, -1, 1)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T00:14:36.987

如我所见，您要么将黑色三角形渲染到场景中，要么将其渲染到视野之外（例如，在摄像机后面），或者两者兼而有之。要诊断它，首先尝试一种与光照无关的方法来渲染三角形；在第一次调用`glColor3f(1.0,1.0,1.0);`之前的某处添加语句。`glVertex()`如果你看到一个白色的三角形，问题就解决了。如果它仍然是黑色的，请将其放在上述代码之前/之后：

```
glPushMatrix(); //save the modelview
glTranslatef(0.0,0.0,-10); //move the rendering coords

glBegin(GL_TRIANGLES);
  glColor3f(1.0,1.0,1.0);
  glVertex3f(-0.5,-0.5,0.0);
  glVertex3f(0.5,0.0,0.0);
  glVertex3f(0.0,0.5,0.0);
glEnd();

glPopMatrix();//restore the view matrix to the original 
```

如果这`glTranslatef`不起作用，请尝试将不同的值代入 xyz 参数（一个在拼贴处，例如 0、-10、0）。您也可以尝试`glDrawBuffer(GL_FRONT_AND_BACK);`在初始化例程中放置某个位置，但这可能是默认设置。

**编辑** 我刚刚注意到三角形位于沿 xz 平面的原点 (0,0,0) 上，这是相机默认的位置（因此它在近剪裁平面后面 1 个单位）。您肯定需要将三角形转换为视图，或修改模型视图矩阵以模拟相同（例如通过lookAt；两种方法基本相同）。也有可能您正在查看三角形边缘，这会使它不可见。在这种情况下，插入 glRotatef(90,1,0,0); *之后*的指令*上面的 glTranslate 将三角形“旋转”到正确的角度。请注意，平移、缩放和旋转是对空间本身进行操作，而不是对其中的对象进行操作，因此它们都是反向操作的。通常，您会先缩放一个对象，然后旋转它，然后将其平移到任何位置。在 OpenGL 中，您可以平移坐标、旋转坐标、然后缩放。然后 GL 在它认为 '0,0,0' 所在的位置绘制对象，该对象现在位于修改后的位置。*

# php - 教义关联映射和arrayCollection持续错误

> ID：12231937
> 
> 赞同：3
> 
> 时间：2012-09-01T22:30:02.197
> 
> 标签：php, mysql, database, doctrine-orm

考虑以下问题：
我在和之间存在*多对一*关联。 `Article``Author`

```
class Author{
  /**
   * ...
   *@var ArrayCollection_of_Article
   */
   public $articles;
}

class Article{
   /**
   * ...
   *@var Author
   */
   public $author;
} 
```

制作一个新的`Article`我有两种类型的代码：
**第一种：**

```
$author = ORM::Find("Author",12); // fetch an Author with ID=12
$art = new Article();
$art->author=$author;
$author->articles->add($art);
ORM::Persist($art); // persist it to write to database 
```

**第二个：（**省略第4行）

```
$author = ORM::Find("Author",12); // fetch an Author with ID=12
$art = new Article();
$art->author=$author;
ORM::Persist($art); // persist it to write to database 
```

哪一个是正确的？
第一个工作正常。但是第二个会导致错误，例如有时会出现以下错误：

```
A new entity was found through a relationship that was not configured to cascade persist operations 
```

我想知道第二个是否可能，否则它**总是**会导致 sql 错误。
谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-09T14:47:39.287

您必须使用 getter 和 setter 访问关系，这是因为 Doctrine 构建了一个从您的 Entity 类扩展的代理类并覆盖您的 getter 以提供延迟加载。

# iphone - 故事板自定义表格标题

> ID：12231943
> 
> 赞同：0
> 
> 时间：2012-09-01T22:31:05.443
> 
> 标签：iphone, objective-c, ios

我仍在尝试找出将自定义标题添加到情节提要中的表格视图的正确方法。

我知道我会使用这种方法，而不使用 Storyboards，我还应该使用它吗？

```
- (UIView *) tableView:(UITableView *)tableView
viewForHeaderInSection:(NSInteger)section
{

} 
```

![在此处输入图像描述](../Images/719ac7947e310be5dac2bb08d4fc18e0.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T22:47:40.040

是的，即使您使用丑陋的 InterfaceBuilder-hackery 来创建您的 UI，您仍然可以利用任何编程方法 - 在这种情况下，只需确保您正确设置了 table view 的委托和数据源。

# linux - 粘贴在unix中执行命令

> ID：12231947
> 
> 赞同：2
> 
> 时间：2012-09-01T22:31:33.757
> 
> 标签：linux, terminal

有时在 Unix 类型的操作系统中，只需在终端中粘贴命令即可执行命令，而不是粘贴并按 Enter 键。这种行为有什么特殊原因吗？为什么这很有用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-01T22:32:45.097

*您*必须小心复制（突出显示）命令的方式。如果您越过命令的末尾（或下一行），您也在复制换行符，因此当您粘贴它时，您会得到换行符的作用就像`<enter>`键一样。

一旦您知道这一点，此功能实际上会非常好.. 特别是如果您*确实*希望每次粘贴时都执行该命令。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-01T22:33:11.400

你粘贴了一个换行符来执行命令

# c# - ADO.net 实体回发 Gridview 数据源

> ID：12231954
> 
> 赞同：1
> 
> 时间：2012-09-01T22:32:56.103
> 
> 标签：c#, entity-framework, ado.net, linq-to-entities

我正在尝试将 ADO 实体查询绑定到 gridview，但 gridview 触发的每个事件都会导致页面回发。每次页面回发时，数据源都是空的，我必须再次绑定查询。

除 rowupdating 事件外，所有代码都可用于显示和编辑数据。

我的问题在于，当 rowupdating 事件触发时，页面会回发，我必须再次绑定数据，丢失我想要更新数据库的选定值。如果我不再次绑定数据，则数据源为 null，并且我的 .findcontrol 返回 ArgumentOutOfRange 异常。

我通过以下方式测试 rowupdating 事件中的其余代码：

1) 在 rowupdating 事件上设置断点

2）点击更新超链接

3) 使用 SQL Server Management Studio 更改表中的数据

4) 继续代码执行

5) 重新执行 SQL SMS 中的查询

在此之后，表中的数据更新为旧值

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using HCA_QualityModel;

public partial class Admin : System.Web.UI.Page
{
    static HCA_QualityEntities database = new HCA_QualityEntities();
    static object grvMachinesQuery = (from m in database.Machines
                                      from d in database.Workcenters
                                      where m.WorkcenterFK == d.id
                                      select
                                          new { id = m.id, MachineName = m.MachineName, WorkCenterFK = d.WorkCenterName });
    protected void Page_Load(object sender, EventArgs e)
    {
        //bind the gridview on intial page load
        if (!Page.IsPostBack) bindGridViewData();
    }
    protected void bindGridViewData()
    {
        //Data binds for gridviews and ddl's

        grvMachines.DataSource = grvMachinesQuery;
        grvWorkCenters.DataSource = (from w in database.Workcenters select w);
        grvUsers.DataSource = (from u in database.Users select u);
        ddlAddDept.DataSource = grvWorkCenters.DataSource;
        ddlAddDept.DataValueField = "id";
        ddlAddDept.DataTextField = "WorkCenterName";
        DataBind();
    }
    //Adds new data to the db, then rebinds the griviews to the db
    #region Submit Buttons
    protected void btnSubmitMachine_Click(object sender, EventArgs e)
    {
        //add new machine to the database

        Machine temp = new Machine();
        temp.MachineName = txtAddMachine.Text;
        temp.WorkcenterFK = Int32.Parse(ddlAddDept.SelectedValue);
        database.Machines.AddObject(temp);
        database.SaveChanges();
        bindGridViewData();

    }
    protected void btnSubmitDept_Click(object sender, EventArgs e)
    {
        //add new workcenter to database

        Workcenter temp = new Workcenter();
        temp.WorkCenterName = txtAddDept.Text;
        database.Workcenters.AddObject(temp);
        database.SaveChanges();
        bindGridViewData();
    }
    protected void btnUserSubmit_Click(object sender, EventArgs e)
    {
        //add new user to the database

        HCA_QualityModel.User temp = new User();
        temp.Username = txtAddUser.Text;
        temp.Password = txtAddPassword.Text;
        database.Users.AddObject(temp);
        database.SaveChanges();
        bindGridViewData();
    }
    #endregion
    //Handles Updating, editing, and deleting Gridview Controls
    #region Gridview machines
    protected void grvMachines_RowDataBound(object sender, GridViewRowEventArgs e)
    {

        DropDownList temp = (DropDownList)(e.Row.FindControl("ddlDept"));
        if (temp != null)
        {
            temp.DataSource = (from w in database.Workcenters select w);
            temp.DataTextField = "WorkCenterName";
            temp.DataValueField = "id";
            temp.DataBind();
        }

    }
    protected void grvMachines_RowDeleting(object sender, GridViewDeleteEventArgs e)
    {

        int id = Int32.Parse(((Label)grvMachines.Rows[e.RowIndex].FindControl("lblId") as Label).Text);
        database.Machines.DeleteObject(((Machine)(from m in database.Machines where m.id == id select m).Single()));
        database.SaveChanges();
        bindGridViewData();
    }
    protected void grvMachines_RowCancelingEdit(object sender, GridViewCancelEditEventArgs e)
    {

        grvMachines.EditIndex = -1;
        bindGridViewData();
    }
    protected void grvMachines_RowEditing(object sender, GridViewEditEventArgs e)
    {
        grvMachines.EditIndex = e.NewEditIndex;
        bindGridViewData();
    }
    protected void grvMachines_RowUpdating(object sender, GridViewUpdateEventArgs e)
    {

        //Gridviews have no data on postback from events, rebinding looses the selected values from edit mode.

        bindGridViewData();

        DropDownList dept = (DropDownList)grvMachines.Rows[grvMachines.EditIndex].FindControl("ddlDept");
        TextBox name = (TextBox)grvMachines.Rows[grvMachines.EditIndex].FindControl("txtMachine");
        Int32 id = (Convert.ToInt32(((Label)grvMachines.Rows[grvMachines.EditIndex].FindControl("lblId")).Text));

        //Working Code to update the database, recieving incorrect data from controls due to rebinding 
        HCA_QualityEntities database = new HCA_QualityEntities();
        Machine temp = (from m in database.Machines where m.id == id select m).First();
        temp.MachineName = (name.Text);
        temp.WorkcenterFK = Int32.Parse(dept.SelectedValue);
        database.SaveChanges();
        grvMachines.EditIndex = -1;
        bindGridViewData();
    }
    #endregion
} 
```

ASP代码

```
<%@ Page Title="" Language="C#" MasterPageFile="~/site.master" AutoEventWireup="true"
    CodeFile="Admin.aspx.cs" Inherits="Admin" %>

<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="Server">
</asp:Content>
<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" runat="Server">
      <table style="width:800px; vertical-align:top;">
        <tr style="width:800px;">
           <td style="width:230px; height:90px;">
                Add New Machine:
                <br />
                &nbsp;Machine&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dept
                <br />
                <asp:TextBox ID="txtAddMachine" runat="server" Width="70px"></asp:TextBox>
                <asp:DropDownList ID="ddlAddDept" runat="server" Width="110px">
                </asp:DropDownList>
                <br />
                <asp:Button ID="btnSubmitMachine" runat="server" Text="Submit" 
                onclick="btnSubmitMachine_Click" />
           </td>
           <td style="width:190px; height:90px;">
                Add New Dept:
                <br />
                Dept Name
                <br />
                <asp:TextBox ID="txtAddDept" runat="server" Width="100px"></asp:TextBox>
                <br />
                <asp:Button ID="btnSubmitDept" runat="server" Text="Submit" 
                onclick="btnSubmitDept_Click" />
           </td>
           <td style="width:250px; height:90px;"> 
                Add New User:
                <br />
                &nbsp;Username&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Password
                <br />
                <asp:TextBox ID="txtAddUser" runat="server" Width="90px"></asp:TextBox>
                <asp:TextBox ID="txtAddPassword" runat="server" Width="90px"></asp:TextBox>
                <br />
                <asp:Button ID="btnUserSubmit" runat="server" Text="Submit" 
                onclick="btnUserSubmit_Click" />
           </td>
        </tr>
        <tr style="width:800px; vertical-align:top;">
           <td style="width:230px;">
                <asp:GridView ID="grvMachines" runat="server" AutoGenerateColumns="False" 
                    Width="230px" onrowdeleting="grvMachines_RowDeleting" 
                    onrowediting="grvMachines_RowEditing" 
                    onrowcancelingedit="grvMachines_RowCancelingEdit" 
                    onrowupdating="grvMachines_RowUpdating" 
                    onrowdatabound="grvMachines_RowDataBound" 
                    EnableViewState="False">
                    <Columns>
                        <asp:TemplateField Visible="false">
                            <ItemTemplate>
                                <asp:Label ID="lblId" runat="server" Text='<%# Eval("id") %>'></asp:Label>
                            </ItemTemplate>
                            <EditItemTemplate>
                                <asp:Label ID="lblId" runat="server" Text='<%# Eval("id") %>'></asp:Label>
                            </EditItemTemplate>
                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="Machine">
                            <ItemTemplate>
                                <asp:Label ID="lblMachine" runat="server" Text='<%# Eval("MachineName") %>'></asp:Label>
                            </ItemTemplate>
                            <EditItemTemplate>
                                <asp:TextBox ID="txtMachine" runat="server" Text='<%# Eval("MachineName") %>'></asp:TextBox>
                            </EditItemTemplate>
                            <ControlStyle Width="50px" />
                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="Dept">
                            <ItemTemplate>
                                <asp:Label ID="lblDept" runat="server" Text='<%# Eval("WorkcenterFK") %>'></asp:Label>
                            </ItemTemplate>
                            <EditItemTemplate>
                                <asp:DropDownList ID="ddldept" runat="server">
                                </asp:DropDownList>
                            </EditItemTemplate>
                            <ControlStyle Width="120px" />
                        </asp:TemplateField>
                        <asp:CommandField HeaderText="Actions" ShowEditButton="true" ShowDeleteButton="True"
                            ControlStyle-Width="50px" CausesValidation="False" >
                        </asp:CommandField>
                    </Columns>
                </asp:GridView>
           </td>
           <td style="width:170px;">
                <asp:GridView ID="grvWorkCenters" runat="server" AutoGenerateColumns="False" 
                    Width="170px">
                    <Columns>
                        <asp:TemplateField HeaderText="id" Visible="false">
                            <ItemTemplate>
                                <asp:Label ID="lblId" runat="server" Text='<%# Eval("id") %>'></asp:Label>
                            </ItemTemplate>
                            <EditItemTemplate>
                                <asp:Label ID="lblId" runat="server" Text='<%# Eval("id") %>'></asp:Label>
                            </EditItemTemplate>
                        </asp:TemplateField>
                        <asp:TemplateField HeaderText="WorkCenter">
                            <ItemTemplate>
                                <asp:Label ID="lblWorkcenter" runat="server" Text='<%# Eval("WorkCenterName") %>'></asp:Label>
                            </ItemTemplate>
                            <EditItemTemplate>
                                <asp:TextBox ID="txtWorkcenter" runat="server" Text='<%# Eval("WorkCenterName") %>'></asp:TextBox>
                            </EditItemTemplate>
                            <ControlStyle Width="75px" />
                        </asp:TemplateField>
                        <asp:CommandField HeaderText="Actions" ShowEditButton="true" ShowDeleteButton="true"
                            ControlStyle-Width="50px" CausesValidation="False" />
                    </Columns>
                </asp:GridView>
           </td>
           <td style="width:290px;"> 
                <asp:GridView ID="grvUsers" runat="server" AutoGenerateColumns="False" 
                    Width="290px">
                <Columns>
                    <asp:TemplateField HeaderText="id" Visible="false">
                        <ItemTemplate>
                            <asp:Label ID="lblId" runat="server" Text='<%# Eval("id") %>'></asp:Label>
                        </ItemTemplate>
                        <EditItemTemplate>
                            <asp:TextBox ID="txtId" runat="server" Text='<%# Eval("id") %>'></asp:TextBox>
                        </EditItemTemplate>
                    </asp:TemplateField>
                    <asp:TemplateField HeaderText="User">
                        <ItemTemplate>
                            <asp:Label ID="lblUser" runat="server" Text='<%# Eval("Username") %>'></asp:Label>
                        </ItemTemplate>
                        <EditItemTemplate>
                            <asp:TextBox ID="txtUser" runat="server" Text='<%# Eval("Username") %>'></asp:TextBox>
                        </EditItemTemplate>
                        <ControlStyle Width="120px" />
                    </asp:TemplateField>
                    <asp:TemplateField HeaderText="Password">
                        <ItemTemplate>
                            <asp:Label ID="lblPassword" runat="server" Text='<%# Eval("Password") %>'></asp:Label>
                        </ItemTemplate>
                        <EditItemTemplate>
                            <asp:TextBox ID="txtPassword" runat="server" Text='<%# Eval("Password") %>'></asp:TextBox>
                        </EditItemTemplate>
                        <ControlStyle Width="120px" />
                    </asp:TemplateField>
                    <asp:CommandField HeaderText="Actions" ShowEditButton="true" ShowDeleteButton="true"
                        ControlStyle-Width="50px" CausesValidation="false" />
                </Columns>
            </asp:GridView>
           </td>
        </tr>
      </table>

</asp:Content> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T13:47:27.607

您可以暂时断开事件处理程序吗？

```
myGridView.rowUpdating -= myGridView_rowUpdating;
//code to populate
myGridView.rowUpdating += myGridView_rowupdating; 
```

或[C# 禁用事件处理程序问题](https://stackoverflow.com/questions/3288195/c-sharp-disable-event-handler-problem)

我有一个不稳定的验证块，我试图重构一个工作，当我不希望它们刷新时，我的 dataBindings 刷新并导致它们重新绑定，然后重新绑定，然后我最终陷入了这个递归-y 汤。我只有一个实例，所以我只是关闭了事件处理程序并将其重新打开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T00:41:33.990

我已经重构了你的源代码，现在它应该可以工作了。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using HCA_QualityModel;

public partial class Admin : System.Web.UI.Page
{
static HCA_QualityEntities database = new HCA_QualityEntities();
   protected void Page_Load(object sender, EventArgs e)
{
    //bind the gridview on intial page load
    if (!Page.IsPostBack) bindGridViewData();
}
protected void bindGridViewData()
{

 static object grvMachinesQuery = (from m in database.Machines
                                  from d in database.Workcenters
                                  where m.WorkcenterFK == d.id
                                  select
                                      new { id = m.id, MachineName = m.MachineName,  WorkCenterFK = d.WorkCenterName });

    //Data binds for gridviews and ddl's

    grvMachines.DataSource = grvMachinesQuery;
    grvWorkCenters.DataSource = (from w in database.Workcenters select w);
    grvUsers.DataSource = (from u in database.Users select u);
    ddlAddDept.DataSource = grvWorkCenters.DataSource;
    ddlAddDept.DataValueField = "id";
    ddlAddDept.DataTextField = "WorkCenterName";
    DataBind();
}

//Adds new data to the db, then rebinds the griviews to the db
#region Submit Buttons
protected void btnSubmitMachine_Click(object sender, EventArgs e)
{
    //add new machine to the database

    Machine temp = new Machine();
    temp.MachineName = txtAddMachine.Text;
    temp.WorkcenterFK = Int32.Parse(ddlAddDept.SelectedValue);
    database.Machines.AddObject(temp);
    database.SaveChanges();
    bindGridViewData();

}
protected void btnSubmitDept_Click(object sender, EventArgs e)
{
    //add new workcenter to database

    Workcenter temp = new Workcenter();
    temp.WorkCenterName = txtAddDept.Text;
    database.Workcenters.AddObject(temp);
    database.SaveChanges();
    bindGridViewData();
}
protected void btnUserSubmit_Click(object sender, EventArgs e)
{
    //add new user to the database

    HCA_QualityModel.User temp = new User();
    temp.Username = txtAddUser.Text;
    temp.Password = txtAddPassword.Text;
    database.Users.AddObject(temp);
    database.SaveChanges();
    bindGridViewData();
}
#endregion
//Handles Updating, editing, and deleting Gridview Controls
#region Gridview machines
protected void grvMachines_RowDataBound(object sender, GridViewRowEventArgs e)
{

    DropDownList temp = (DropDownList)(e.Row.FindControl("ddlDept"));
    if (temp != null)
    {
        temp.DataSource = (from w in database.Workcenters select w);
        temp.DataTextField = "WorkCenterName";
        temp.DataValueField = "id";
        temp.DataBind();
    }

}
protected void grvMachines_RowDeleting(object sender, GridViewDeleteEventArgs e)
{

    int id = Int32.Parse(((Label)grvMachines.Rows[e.RowIndex].FindControl("lblId") as Label).Text);
    database.Machines.DeleteObject(((Machine)(from m in database.Machines where m.id == id select m).Single()));
    database.SaveChanges();
    bindGridViewData();
}
protected void grvMachines_RowCancelingEdit(object sender, GridViewCancelEditEventArgs e)
{

    grvMachines.EditIndex = -1;
    bindGridViewData();
}
protected void grvMachines_RowEditing(object sender, GridViewEditEventArgs e)
{
    grvMachines.EditIndex = e.NewEditIndex;
    bindGridViewData();
}
protected void grvMachines_RowUpdating(object sender, GridViewUpdateEventArgs e)
{

    //Gridviews have no data on postback from events, rebinding looses the selected values from edit mode.

    bindGridViewData();

    DropDownList dept = (DropDownList)grvMachines.Rows[grvMachines.EditIndex].FindControl("ddlDept");
    TextBox name = (TextBox)grvMachines.Rows[grvMachines.EditIndex].FindControl("txtMachine");
    Int32 id = (Convert.ToInt32(((Label)grvMachines.Rows[grvMachines.EditIndex].FindControl("lblId")).Text));

    //Working Code to update the database, recieving incorrect data from controls due to rebinding 
    HCA_QualityEntities database = new HCA_QualityEntities();
    Machine temp = (from m in database.Machines where m.id == id select m).First();
    temp.MachineName = (name.Text);
    temp.WorkcenterFK = Int32.Parse(dept.SelectedValue);
    database.SaveChanges();
    grvMachines.EditIndex = -1;
    bindGridViewData();
}
#endregion 
```

}

# php - 链接到另一个动作

> ID：12231956
> 
> 赞同：2
> 
> 时间：2012-09-01T22:33:02.947
> 
> 标签：php, .htaccess, zend-framework, hyperlink, zend-framework-routing

我正在取消 zend 框架。我有一个链接到控制器的视图，家庭，

所以：

```
application>controllers>HomeController.php

application>views>scripts>home>index.phtml 
```

在 index.phtml 页面中，我有一个指向同一控制器中的操作的链接：

```
application>views>scripts>home>add.phtml 
```

链接的代码是：

```
<a href="../application/controllers/home/add">add</a> 
```

这不仅不起作用，而且我确信它不是在 zend 框架中执行此操作的最佳方法。

请注意我正在使用 wamp

```
http://localhost/sites/url/public/home/add 
```

使用时：

```
<?php
    echo '<a href="' . $this->url(array('controller' => 'home', 'action' => 'add')) . '">Add Job</a>';  
?> 
```

我收到此错误消息：

```
Message: Invalid controller specified (sites) 
```

这是我的 htaccess 中的内容

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ index.php [NC,L] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T22:42:49.947

为此使用 url 助手：

[http://framework.zend.com/manual/en/zend.view.helpers.html](http://framework.zend.com/manual/en/zend.view.helpers.html)

```
<a href="<?php echo $this->url(array('controller' => 'index', 
                                     'action' => 'index', 
                                     'module' => 'module1')); ?>" title="test"> 
```

**更新**

这是您`.htaccess`应该喜欢的方式：

```
SetEnv ENVIRONMENT development

RewriteEngine On
RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]
RewriteCond %{REQUEST_URI} !\.(css|gif|ico|jpg|js|png|swf|txt)$
RewriteRule ^.*$ index.php [NC,L] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T06:51:11.083

在 ZF 中使用相对和绝对链接时，它的工作方式与 ZF 外部几乎相同，只是所有请求都通过 index.php 路由，因此您实际上并没有路由到目录，您只是告诉路由器链接的位置：

```
<a href="/home/add">add</a> 
```

或者

```
<a href="http://mysite.com/home/add">add</a> 
```

url helper 将是执行此操作的首选方法，并且应该有效。在您的情况下，我怀疑 localhost 路径操作系统对您的网址造成了困难，我知道它总是对我的。

为每个项目设置一个虚拟主机将使这个问题消失。如果您在虚拟主机设置方面需要帮助，那么这里有一些很好的资源。

[http://blog.srmklive.com/2010/12/27/how-to-create-virtual-hosts-using-zend-server-ce/](http://blog.srmklive.com/2010/12/27/how-to-create-virtual-hosts-using-zend-server-ce/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T22:37:50.327

您不必`application`在链接中引用该文件夹，因为该文件夹可以位于您的`htdocs`/ `www`/`public_html`文件夹之外。

该链接应如下所示：`http://yourdomain.com/home/add`或`http://localhost/home/add`，具体取决于您安装应用程序的位置。

在我看来，最好的方法是使用该`$this->baseUrl()`方法（仅适用于视图，而不是控制器），或者您可以在 bootstrap.php 中定义一个常量，该常量包含您的 baseUrl。

# javascript - 同一件事的两个功能，一个崩溃，另一个不崩溃，为什么？

> ID：12231967
> 
> 赞同：2
> 
> 时间：2012-09-01T22:35:00.913
> 
> 标签：javascript

我想要一个名为 findFirst 的函数，它接受参数 n 和 q 并返回除以 n 且大于或等于 q 的最小素数。所以首先我写了一个函数来判断一个数字是否是素数。

```
var isPrime = function(n){
    if(n === 1){
        return false;
    }
    else if (n === 2 || n === 3){
        return true;
    }
    else {
        for(i=2; i < n; i++){
            if(i * i >= n){
            for(j=2; j<=i; j++){
                    if(n % j === 0){
                        return false;
                    }
                }
            return true;
            } 
        }
    }
}; 
```

可能还有其他方法可以提高效率，但我很确定这个功能不是问题。

所以有了这个函数，我第一次尝试编写 findFirst：

```
var findFirst = function(n,q){
    var p = q;
        while(n % p !== 0 || isPrime(p) === false){
            p++;
        }
    return p;
}; 
```

此函数有效，但如果数量很大，它会崩溃，例如它在输入时崩溃 (6310545154, 3)。顺便说一下，6310545154 的主幂分解为 2 * 3155272577

所以我写了另一个函数，它首先列出一个数字的质因数：

```
var getFactors = function(n){
    var factors = [];
    var k = n;
    var p = 2;
    while(isPrime(k) === false && k !== 1){
        while(k % p !== 0 || isPrime(p) === false){
            p = p+1;
        }
        while(k % p === 0){
            k = k/p;
        }
        factors.push(p);
    }
    if(isPrime(k) === true){
        factors.push(k);
        return factors;
    }
    if(k === 1){
        return factors; 
    }
}; 
```

现在我在 findFirst 的第二次尝试是：

```
var findFirst = function(n,q){
    var array = getFactors(n);
    var p = 0;
    for(i = 0; i < array.length; i++){
        if(array[i] >= q && p === 0){
            p = array[i];
        }
    }
    return p;
}; 
```

这个效果很好。它不会在上面的那个大数字上崩溃并立即计算结果。谁能明白为什么会发生这种情况？我最初尝试中的“while”循环似乎与 getFactors 函数中的“while”循环之一非常相似。第二次尝试看起来要复杂得多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-01T23:17:17.043

第二个程序返回得非常快，因为你的数字只有一个大素数；一旦找到（所有）小素数，它就会迅速退出循环。第一个程序必须从 3 一直数到 3155272577，然后才能发现它是一个因素。在 2147483647 之后，它必须从整数转换为浮点运算，这使得它变得更慢。

注意

```
var isPrime = function(n) {
    ...
}; 
```

是创建函数的一种不寻常的方式；通常你会写

```
function isPrime(n) {
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T23:17:00.760

你有很多错误，在代码中 - 例如，这种方式`i`是全局变量

```
for(i=2; i < n; i++){ 
```

你想做的是

```
for(var i=2; i < n; i++){ 
```

然后稍后

```
factors[i] = k; 
```

哪里`i`没有定义等等。

首先通过 jslint 或 jshint 运行您的代码以使其完全正确。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-01T23:29:11.483

您可以使用正则表达式快速检查素数。

```
function isPrimeNumber(n) {
    return !/^1?$|^(11+?)\1+$/.test((new Array(++n)).join('1'));
} 
```

阅读更多关于[这篇文章](http://www.noulakaz.net/weblog/2007/03/18/a-regular-expression-to-check-for-prime-numbers/)。

**编辑：**虽然可能不是大数字的最佳选择。更像是一个快速的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-01T23:37:59.493

这并没有直接解决这个问题，但我认为重要的是要强调**一个无响应的选项卡与崩溃不同。**无响应仅仅意味着页面已经执行 JavaScript 很长时间了。

请记住，浏览器无法确定脚本是否会在不运行脚本的情况下完成——这被称为**停止问题，**对于图灵完备的编程语言来说，它是无法解决的。浏览器杀死脚本的提议是基于**猜测**，无论所讨论的脚本是什么，这都是正确的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-09T23:12:21.780

第二次尝试从不执行`p = p+1;`，实际上`while`在这`getFactors`部分只执行了 2 次：

```
 while(k % p !== 0 || isPrime(p) === false){
        p = p+1;
    } 
```

与第一次尝试不同，第一次尝试必须测试`p`从 '3' 到 第一次尝试`3155272577`的素数和因子的每个数量`n`：

```
 while(n % p !== 0 || isPrime(p) === false){
        p++;
    } 
```

**为什么？**
第二次尝试以 and 开始， `var p = 2;`这 `var k = n;`意味着`(k % p === 0)`和`isPrime(p)`都是`true`（当`n=6310545154`）

```
while(isPrime(k) === false && k !== 1){
    while(k % p !== 0 || isPrime(p) === false){
        p = p+1;                                               /*  this is never executed for findFirst(6310545154, 3)  */
    }
    while(k % p === 0){
        k = k/p;
    }
    ... 
```

然后`k = k/p;`立即减少 `k`到`3155272577`终止外部`while(isPrime(k) === false ...`

要在第二次尝试中观察相同的异常时间行为，请使用:
`var factors = [2];`和`var p = 3;`.

ref: [Eratosthenes Sieve - 维基百科](http://en.wikipedia.org/wiki/Sieve_of_Eratosthenes)

# jquery - jQuery 验证：日期 - mysql 格式

> ID：12231968
> 
> 赞同：1
> 
> 时间：2012-09-01T22:35:09.657
> 
> 标签：jquery, mysql, jquery-validate

如何将 jQuery 验证“日期”更改为 mysql 格式？使用当前日期，我的 MySql 日期无效。

MySQL 日期格式 -`YYYY-MM-DD`

另外，是否有本地“时间”验证器？还是您必须为此添加自己的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T22:48:04.083

Mysql 可以生成 ISO 日期 .. 如果你“使用严格”，你应该可以在未来使用 Date.parse 但现在检查一下：[https](https://github.com/csnover/js-iso8601) ://github.com/csnover/js-iso8601并使用 ISO 函数日期解析。要从 javascript 日期对象生成 ISO，请检查以下问题：[How do I output an ISO 8601 formatted string in JavaScript?](https://stackoverflow.com/questions/2573521/how-do-i-output-an-iso-8601-formatted-string-in-javascript)

祝你好运！

# c# - 可以使用收益返回“实时”返回 JSON 吗？

> ID：12231970
> 
> 赞同：7
> 
> 时间：2012-09-01T22:35:28.707
> 
> 标签：c#, asp.net-mvc, json, asp.net-web-api

这是情况。

我正在使用什么： - ASP.NET MVC 4 Web API - IIS 7.0 来托管应用程序 - C#

我有 Web API，可以从 Intranet 上的远程机器获取性能数据，并且正在测试通过 URL 调用调用 API，这将返回 JSON。但是，它必须先完成执行才能返回 JSON。例如，如果我返回性能监控 10 秒，我将不得不等待 10 秒才能显示所有数据值。

我想要做的是让它活起来，这样当它每秒读取性能计数器并以 JSON 格式显示它时，它会返回一个值，而不是等待所有内容都被检索到然后一次全部列出。我正在尝试使用 YIELD 关键字来完成此操作，但它仍然无法正常工作。在该方法完全完成之前，JSON 不会显示在浏览器中。

这是存储库方法和协调控制器操作的代码：

从 LogDBRepository.cs ：

```
public IEnumerable<DataValueInfo> LogTimedPerfDataLive(string macName, string categoryName, string counterName,
                                          string instanceName, string logName, long? seconds)
    {
        iModsDBRepository modsDB = new iModsDBRepository();
        List<MachineInfo> theMac = modsDB.GetMachineByName(macName);

        if (theMac.Count == 0)
            yield break;

        else if (instanceName == null)
        {
            if (!PerformanceCounterCategory.Exists(categoryName, macName) ||
                !PerformanceCounterCategory.CounterExists(counterName, categoryName, macName))
            {
                yield break;
            }
        }
        else if (instanceName != null)
        {
            if (!PerformanceCounterCategory.Exists(categoryName, macName) ||
                !PerformanceCounterCategory.CounterExists(counterName, categoryName, macName) ||
                !PerformanceCounterCategory.InstanceExists(instanceName, categoryName, macName))
            {
                yield break;
            }
        }
        else if (logName == null)
        {
            yield break;
        }

        // Check if entered log name is a duplicate for the authenticated user
        List<LogInfo> checkDuplicateLog = this.GetSingleLog(logName);
        if (checkDuplicateLog.Count > 0)
        {
            yield break;
        }

        PerformanceCounterCategory category = new PerformanceCounterCategory(categoryName, theMac[0].MachineName);
        if (category.CategoryName == null || category.MachineName == null)
        {
            yield break;
        }

        List<LogInfo> logIt = new List<LogInfo>();
        if (category.CategoryType != PerformanceCounterCategoryType.SingleInstance)
        {
            List<InstanceInfo> instances = modsDB.GetInstancesFromCatMacName(theMac[0].MachineName, category.CategoryName);

            foreach (InstanceInfo inst in instances)
            {
                if (!category.InstanceExists(inst.InstanceName))
                {
                    continue;
                }
                else if (inst.InstanceName.Equals(instanceName, StringComparison.OrdinalIgnoreCase))
                {
                    PerformanceCounter perfCounter = new PerformanceCounter(categoryName, counterName,
                                                                        inst.InstanceName, theMac[0].MachineName);

                    //CounterSample data = perfCounter.NextSample();
                    //double value = CounterSample.Calculate(data, perfCounter.NextSample());
                    string data = "";
                    List<UserInfo> currUser = this.GetUserByName(WindowsIdentity.GetCurrent().Name);

                    string timeStarted = DateTime.Now.ToString("MM/dd/yyyy - h:mm:ss tt");

                    List<string> dataValues = new List<string>();
                    for (int i = 0; i < seconds; i++)
                    {
                        data = "Value " + i + ": " + perfCounter.NextValue().ToString();
                        DataValueInfo datItUp = new DataValueInfo
                        {
                            Value = data
                        };
                        yield return datItUp;
                        dataValues.Add(data);
                        Thread.Sleep(1000);
                    }
                    string timeFinished = DateTime.Now.ToString("MM/dd/yyyy - h:mm:ss tt");

                    Log log = new Log
                    {
                        LogName = logName,
                        CounterName = perfCounter.CounterName,
                        InstanceName = perfCounter.InstanceName,
                        CategoryName = perfCounter.CategoryName,
                        MachineName = perfCounter.MachineName,
                        TimeStarted = timeStarted,
                        TimeFinished = timeFinished,
                        PerformanceData = string.Join(",", dataValues),
                        UserID = currUser[0].UserID
                    };
                    this.CreateLog(log);
                    break;
                }
            }
        }
        else
        {
            PerformanceCounter perfCounter = new PerformanceCounter(categoryName, counterName,
                                                                        "", theMac[0].MachineName);

            string data = "";
            List<UserInfo> currUser = this.GetUserByName(WindowsIdentity.GetCurrent().Name);

            string timeStarted = DateTime.Now.ToString("MM/dd/yyyy - h:mm:ss tt");

            List<string> dataValues = new List<string>();

            for (int i = 0; i < seconds; i++)
            {
                data = "Value " + i + ": " + perfCounter.NextValue().ToString();
                DataValueInfo datItUp = new DataValueInfo
                {
                    Value = data
                };
                yield return datItUp;
                dataValues.Add(data);
                Thread.Sleep(1000);
            }
            string timeFinished = DateTime.Now.ToString("MM/dd/yyyy - h:mm:ss tt");

            Log log = new Log
            {
                LogName = logName,
                CounterName = perfCounter.CounterName,
                InstanceName = perfCounter.InstanceName,
                CategoryName = perfCounter.CategoryName,
                MachineName = perfCounter.MachineName,
                TimeStarted = timeStarted,
                TimeFinished = timeFinished,
                PerformanceData = string.Join(",", dataValues),
                UserID = currUser[0].UserID
            };
            this.CreateLog(log);
        }

    } 
```

从 LogController.cs ：

```
[AcceptVerbs("GET", "POST")]
    public IEnumerable<DataValueInfo> Log_Perf_Data(string machine_name, string category_name, string counter_name, string instance_name,
                                   string log_name, long? seconds, string live, string enforceQuery)
    {
        LogController.CheckUser();

        // POST api/log/post_data?machine_name=&category_name=&counter_name=&instance_name=&log_name=&seconds=
        if (machine_name != null && category_name != null && counter_name != null && log_name != null && seconds.HasValue && enforceQuery == null)
        {
            List<DataValueInfo> dataVal = logDB.LogTimedPerfDataLive(machine_name, category_name, counter_name, instance_name,
                                   log_name, seconds).ToList();
            logDB.SaveChanges();
            foreach (var val in dataVal)
                yield return val;
        }

        yield break;   
    } 
```

感谢您的时间和考虑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-01T22:53:56.680

yield 仅在刷新响应时创建要返回的内存对象。

可能最简单的方法是将服务器上的 json 保存在同步（静态？）变量中，当您请求显示您创建 json 的性能数据时，启动后台工作程序（google for web backgrounder nuget）将数据填充到 json对象，设置运行标志并返回 json 对象（开始时可能为空）。

然后，使用浏览器中的 setInterval 每秒调用服务器来刷新这些数据，所以每次你得到越来越多的数据的响应。当后台线程完成时，您将运行标志设置为 false，然后在下一次调用中，您在 json 中返回该信息，因此您可以停止从客户端刷新。

这**不是**最好的方法，但可能最容易实现。

# css - 单选按钮切换开关以更改样式表

> ID：12231971
> 
> 赞同：0
> 
> 时间：2012-09-01T22:35:29.220
> 
> 标签：css, radio-button, toggle

我在我的网站上制作了 2 个样式表（白天和黑夜，因为我发现晚上在漆黑的房间里很难阅读全白背景样式）

我找到了样式切换开关，我希望在 css 切换器上使用它们。

```
<div class="switch switch-blue">
<input type="radio" class="switch-input" name="view2" value="week2" id="week2" checked>
<label for="week2" class="switch-label switch-label-off">Week</label>
<input type="radio" class="switch-input" name="view2" value="month2" id="month2">
<label for="month2" class="switch-label switch-label-on">Month</label>
<span class="switch-selection"></span>
</div> 
```

如果我在文档中加载两个样式表

```
<a href="#" onclick="setActiveStyleSheet('default'); return false;">style 1</a> 
<a href="#" onclick="setActiveStyleSheet('alternate 1'); return false;">style 2</a> 
```

如何使单选按钮在这两者之间切换？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T23:09:56.267

您想将（例如）添加`onclick="setActiveStyleSheet('default');"`到您的`<input type="radio">`. 请注意，您不应该`return false;`在这种情况下使用，因为它会阻止收音机具有选定的外观。

# php - FuelPHP 中的唯一键/索引

> ID：12231976
> 
> 赞同：2
> 
> 时间：2012-09-01T22:35:56.177
> 
> 标签：php, fuelphp

我目前正在第一次尝试使用 FuelPHP，我想知道如何在模型中标记某些键（例如用户名），以及是否可以使用 oil 来标记。特别是在模型中的验证方面，例如：

```
protected static $_properties = array(
  'id',
  'name' => array(
     'data_type' => 'string',
     'label' => 'Name',
     'validation' => array('required', 'max_length'=>array(100), 'min_length'=>array(10)) //validation rules
  ),
  'username' => array(
     'data_type' => 'string',
     'label' => 'Username',
     'validation' => array('required', 'unique') // does this work?
  )
) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-03T12:04:30.630

如果有一个称为“唯一”的框架定义的验证规则，那将起作用。但是没有。

文档 (http://docs.fuelphp.com/classes/validation/validation.html#/extending_validation) 中有一个示例，它解释了如何添加自定义规则，并使用“唯一”作为示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T20:20:49.520

除了我正在更新的当前记录之外，我遇到了这个问题。所以为了解决这个问题，我稍微“破解”了它。

这适用于 Model_Crud，它应该适用于稍加调整的其他人。

# 规则（在 model/mymodel.php 中）：

```
protected static $_rules = array(
  'uniqueField' => 'unique[Model_Product,code]', //unique[Model,fieldToCheck]
); 
```

# 方法（在 myvalidation.php 中）：

```
public static function _validation_unique($val, $model, $field)
{
  if (empty($val))
    return true;

  $findOpts = array(
    'where' => array(
      array($field, '=', $val)
    )
  );

  $input = \Validation::active()->input();

  if (! empty($input['id']))
    $findOpts['where'][] = array('id', '<>', $input['id']);

  \Validation::active()->set_message('unique', 'The field :label must be unique, but :value has already been used');

  //Model_Crud provides a find method which I use to find any of the duplicates
  $obj = call_user_func(array($model, 'find'), $findOpts);

  return ! count($obj) > 0;
} 
```

# php - 防止从配置文件中删除图像

> ID：12231977
> 
> 赞同：0
> 
> 时间：2012-09-01T22:36:19.243
> 
> 标签：php, sql

我正在整理的网站存在问题。

我了解问题所在，但不确定如何解决。

我拥有的是个人资料网站，我正在向该网站添加照片。

现在，当您进入编辑配置文件时，如果您没有为配置文件提供图像，则 $FILE[] 数组为空，因此它使用空白值填充数据库，实际上删除了我的照片。

我想做类似的事情：

```
if $uploadfile = " " DO NOT WRITE ANYTHING TO THE DB. 
```

你知道，$uploadfile = $_FILES['upload']['tmp_name'];

我的代码如下所示：

```
if (isset($_POST['action']) and $_POST['action'] == 'upload')
{
  $uploadfile = $_FILES['upload']['tmp_name'];
  $uploadname = $_FILES['upload']['name'];
  $uploadtype = $_FILES['upload']['type'];
  $uploaddata = file_get_contents($uploadfile);
} 
```

和编辑代码看起来像这样

```
 // EDIT A PLAYER PROFILE

    if (isset($_POST['action']) and $_POST['action'] == 'Edit' )
    {
        include $_SERVER['DOCUMENT_ROOT'] . '/includes/db.inc.php';
        try
        {
            // $sql = 'SELECT id, name, age, position, height, weight, satscore, gpa FROM player WHERE id = :id';
            $sql = 'SELECT player.id, player.name AS name, age, position, height, weight, previousclubs.id AS previousclubsid, GROUP_CONCAT(distinct previousclubs.name) previousclubs, 
                satscore, gpa, GROUP_CONCAT(distinct link) link, email, filename, mimetype, filedata
                FROM player INNER JOIN playerpreviousclubs
                    ON player.id = playerid
                INNER JOIN previousclubs
                    ON previousclubid = previousclubs.id
                INNER JOIN links
                    ON links.playerid = player.id
                WHERE player.id = :id';
            $s = $pdo->prepare($sql);
            $s->bindValue(':id', $_POST['id']);
            $s->execute();
        }
        catch (PDOException $e)
        {
            $error = 'Error fetching profile details.' . $e->getMessage();
            include 'error.html.php';
            exit();
        }

        $row = $s->fetch();
        $pageTitle = 'Edit Profile';
        $action = 'editform';
        $name = $row['name'];
        $age = $row['age']; 
        $position = $row['position'];
        $height = $row['height'];
        $weight = $row['weight'];
        $satscore = $row['satscore'];
        $gpa = $row['gpa'];
        $previousclubs = $row['previousclubs'];
        $previousclubsid = $row['previousclubsid'];
        $link = $row['link'];
        $email = $row['email'];
        $filename = $row['filename'];
        $mimetype = $row['mimetype'];
        $filedata = $row['filedata'];
        $id = $row['id'];
        $button = 'Update Profile';

        include 'addplayerprofile.html.php';
        exit();
    }

    if (isset($_GET['editform']))
    {
        include $_SERVER['DOCUMENT_ROOT'] . '/includes/db.inc.php';

        // UPDATE MAIN PLAYER PROFILE DETAILS
        try
        {
            $sql = "UPDATE player SET
                name = :name,
                age = :age,
                position = :position,
                height = :height,
                weight = :weight,
                satscore = :satscore,
                gpa = :gpa,
                email = :email,
                    filename = :filename,
                    mimetype = :mimetype,
                    filedata = :filedata
                WHERE id = :id";
            $s = $pdo->prepare($sql);
            $s->bindValue(':id', $_POST['id']);
            $s->bindValue(':name', $_POST['name']);
            $s->bindValue(':age', $_POST['age']);
            $s->bindValue(':position', $_POST['position']);
            $s->bindValue(':height', $_POST['height']);
            $s->bindValue(':weight', $_POST['weight']);
            $s->bindValue(':satscore', $_POST['satscore']);
            $s->bindValue(':gpa', $_POST['gpa']);
            $s->bindValue(':email', $_POST['email']);
                    $s->bindValue(':filename',  $uploadname);
                    $s->bindValue(':mimetype',   $uploadtype);
                    $s->bindValue(':filedata',   $uploaddata);
            $s->execute();
        }
        catch (PDOException $e)
        {
            $error = 'Error editing player profile main details.' . $e->getMessage();
            include 'error.html.php';
            exit();
        }

        // UPDATE PREVIOUS CLUBS
        try
        {
            $sql = 'UPDATE previousclubs SET
                name = :previousclubs
                WHERE id = :previousclubsid';
            $s = $pdo->prepare($sql);
            $s->bindValue(':previousclubs', $_POST['previousclubs']);
            $s->bindValue(':previousclubsid', $_POST['previousclubsid']);
            $s->execute();
        }
        catch (PDOException $e)
        {
            $error = 'Error editing player previous clubs.' . $e->getMessage();
            include 'error.html.php';
            exit();
        }   

header('Location: .');
exit();
} 
```

感谢您的任何帮助或指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T22:52:51.250

不确定，但如果您只想检查文件是否已上传，您可以将第一行替换为：

```
if (isset($_POST['action']) && $_POST['action'] == 'upload' && isset($_FILES['upload'])) 
```

或者，如果您想在数据库更新之外正常执行代码：

```
if (isset($_POST['action']) && $_POST['action'] == 'upload') {
    // Some code
    if (isset($_FILES['upload'])) {
        // Database Update
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T22:49:08.823

只需在此处放一个简单的`if`声明：

```
try
    {
        $photo_string = (isset($uploadfile)) ? ",
                filename = :filename,
                mimetype = :mimetype,
                filedata = :filedata" : null;

        $sql = "UPDATE player SET
            name = :name,
            age = :age,
            position = :position,
            height = :height,
            weight = :weight,
            satscore = :satscore,
            gpa = :gpa,
            email = :email
            WHERE id = :id $photo_string";
        $s = $pdo->prepare($sql);
        $s->bindValue(':id', $_POST['id']);
        $s->bindValue(':name', $_POST['name']);
        $s->bindValue(':age', $_POST['age']);
        $s->bindValue(':position', $_POST['position']);
        $s->bindValue(':height', $_POST['height']);
        $s->bindValue(':weight', $_POST['weight']);
        $s->bindValue(':satscore', $_POST['satscore']);
        $s->bindValue(':gpa', $_POST['gpa']);
        $s->bindValue(':email', $_POST['email']);
        if (isset($uploadfile)) {
                $s->bindValue(':filename',  $uploadname);
                $s->bindValue(':mimetype',   $uploadtype);
                $s->bindValue(':filedata',   $uploaddata);
        }
        $s->execute();
    } 
```

# ruby-on-rails - undefined method `yaml' for nil:NilClass when trying to save duplicated object

> ID：12231978
> 
> 赞同：0
> 
> 时间：2012-09-01T22:36:25.430
> 
> 标签：ruby-on-rails

I have an Active Record model object called Event, which has many event_things. I want to be able to duplicate the event, so that it gets a new id. I'm using Rails 3.2 and in rails console am able to successfully call

```
event_copy = event.dup
event_copy.save 
```

However, I also want to duplicate each of the Event's event_things.

```
copy = event_thing.dup
copy.event_id = event_copy.id
copy.save 
```

But that gives me this error stack:

```
NoMethodError: undefined method `yaml' for nil:NilClass
    from /Users/Ed/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/psych.rb:204:in `dump_stream'
    from /Users/Ed/.rvm/rubies/ruby-1.9.3-p125/lib/ruby/1.9.1/psych/core_ext.rb:35:in `psych_y'
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/activemodel-3.2.6/lib/active_model/dirty.rb:143:in `attribute_change'
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/activemodel-3.2.6/lib/active_model/dirty.rb:117:in `block in changes'
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/activemodel-3.2.6/lib/active_model/dirty.rb:117:in `map'
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/activemodel-3.2.6/lib/active_model/dirty.rb:117:in `changes'
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.6/lib/active_record/attribute_methods/dirty.rb:23:in `save'
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.6/lib/active_record/transactions.rb:241:in `block (2 levels) in save'
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.6/lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.6/lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.6/lib/active_record/transactions.rb:208:in `transaction'
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.6/lib/active_record/transactions.rb:293:in `with_transaction_returning_status'
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.6/lib/active_record/transactions.rb:241:in `block in save'
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.6/lib/active_record/transactions.rb:252:in `rollback_active_record_state!'
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/activerecord-3.2.6/lib/active_record/transactions.rb:240:in `save'
    from (irb):18
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/railties-3.2.6/lib/rails/commands/console.rb:47:in `start'
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/railties-3.2.6/lib/rails/commands/console.rb:8:in `start'
    from /Users/Ed/.rvm/gems/ruby-1.9.3-p125/gems/railties-3.2.6/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-28T22:29:38.047

I ran into the same issue as this. It turns out that there's a `Kernel.y` extension method that is getting in your way, based on [this article](https://stackoverflow.com/questions/11571801/rails-console-y-helper-returns-nameerror-rather-than-yaml-formatting-output). Here is what I did to fix my problem:

```
class Event < ActiveRecord::Base
  # alias the attributes
  alias_attribute :x_pos, :x
  alias_attribute :y_pos, :y

  after_initialize :init

  # after_initialize will still work, with the aliases
  def init
    self.x_pos ||= 0
    self.y_pos ||= 0
  end

  # override Kernel.y
  def y; end

  # override self.y_pos to read out of the :attributes, since we blew away :y
  def y_pos
    attribute['y']
  end
end 
```

After doing this, I was finally able to use my model without having to rename the `y` database column.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T08:16:40.193

While I normally don't advocate using gems liberally, if you have a lot of relations that need to be preserved in the duplication, or find yourself doing these manual duplications a lot, take a look at [deep_clonable](https://github.com/moiristo/deep_cloneable).

As for your specific error, try surrounding each line of code with a nil check (one line at a time). I'm sure there's just some case where you're ending up with a nil object that you're overlooking.

# qt - 仅用于字母字符的 QString 函数？

> ID：12231980
> 
> 赞同：1
> 
> 时间：2012-09-01T22:36:49.977
> 
> 标签：qt, qstring

我是 QT(4.7.4) 的新手，我正在搜索函数，它检查 QString 中的字母字符，如果在这个 QString 中只包含字符，则返回“true”。我应该自己写这个简单的函数吗？:( 我希望它在 VBA 中存在 isText() 之类的功能，但在 Google 和文档中我还没有找到它。

感谢您的回答，对不起我的英语:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T22:40:08.790

您可以简单地使用与字母数字字符串匹配的 QRegExp 类来验证字符串。我建议将它与 QValidator 一起使用更清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T22:44:32.180

你可以使用这样的东西（如果你的目标是只接受包含单个字符的字符串）：

```
bool containsOnly(QString str, QChar c)
{
    for(int i=0; i<str.length(); i++)
        if(str.at(i)!=c)
            return false;
    return true;
} 
```

并在使用中：

```
bool b = containsOnly("String", 'a'); 
```

# wpf - 未引用程序集中的 C#/WPF UserControl 绑定

> ID：12231981
> 
> 赞同：0
> 
> 时间：2012-09-01T22:37:26.927
> 
> 标签：wpf, dll, binding, user-controls

我有一个动态加载的用户控件库。从那个库中，我将一个 Tabitem 插入到 TabControl 中。我可以加载标签并显示它而不会出错。但是，我似乎无法使控件上的绑定起作用。

这是我用来加载它并将其添加到 TabControl 的代码：

```
 Assembly moduleAssembly = Assembly.Load("ControlLib");            
    UserControl uc = (UserControl)Application.LoadComponent(new System.Uri("/ControlLib;component/UserControl1.xaml", UriKind.RelativeOrAbsolute));
    TabControl itemsTab = (TabControl)this.FindName("mainTabControl");
    TabItem newTab = new TabItem();
    newTab.Content = uc;
    newTab.Header = "Test";
    itemsTab.Items.Add(newTab);
    itemsTab.SelectedItem = newTab; 
```

这是控件的 C# 代码：

```
public partial class UserControl1 : UserControl
{        
    public static readonly DependencyProperty TestStringProperty = 
        DependencyProperty.Register("TestString", typeof(string), typeof(UserControl1));

    public string TestString { get; set; }

    public UserControl1()
    {
        InitializeComponent();

        TestString = "Hello World";
    }
} 
```

这是控件的 XAML 代码：

```
<UserControl x:Class="ControlLib.UserControl1"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="300" d:DesignWidth="300">
    <Grid>        
        <TextBox Height="30" Width="100" HorizontalAlignment="Left" VerticalAlignment="Bottom" Text="{Binding Path=TestString, Mode=TwoWay}" />
    </Grid>
</UserControl> 
```

当标签显示所有内容时，我看到文本框中的空白而不是“ Hello World”

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-01T23:26:37.370

您仍然会将用户控件的 DataContext 设置为类的实例。您创建该实例的方式不同，因为您将加载该 dll 运行时。但从根本上说，绑定设置保持不变。

```
 var assembly = Assembly.LoadFrom(@"yourdllname.dll");
    Type type = assembly.GetType("ClassLibrary1.SampleViewModel"); 
    object instanceOfMyType = Activator.CreateInstance(type);

    DataContext = instanceOfMyType; 
```

有关基本数据绑定的工作原理，请阅读 MSDN [文档](http://msdn.microsoft.com/en-us/library/ms752347.aspx)。

确保在屏幕顶部选择正确的框架。

编辑

通常这被创建为一个单独的类（MVVM 模式中的 ViewModel）。

```
 public partial class Window3 : Window, INotifyPropertyChanged
    {
        public Window3()
        {
            InitializeComponent();

            DataContext = this;
            TestString = "Hello World.";
        }

        string _testString;
        ///<summary>Gets or sets TestString.</summary>            
        public string TestString
        {
            get { return _testString; }
            set { _testString = value; OnPropertyChanged("TestString"); }
        }

        public event PropertyChangedEventHandler PropertyChanged;

        public void OnPropertyChanged(string propertyName)
        {
            if (PropertyChanged != null)
            {
                var e = new PropertyChangedEventArgs(propertyName);
                PropertyChanged(this, e);
            }
        }
    } 
```

# php - Mysqli 和使用会话用户 ID 登录

> ID：12231982
> 
> 赞同：3
> 
> 时间：2012-09-01T22:37:48.260
> 
> 标签：php, mysqli

我昨晚刚开始学习 mysqli，目前我创建的函数有问题。该功能应登录用户。但是，当我使用真实密码或编造密码输入现有用户名时，登录页面会重新加载并显示`$user_id`. 我对出了什么问题感到迷茫。我有mysql的时候没有这个问题。

```
/** 
 * Returns FALSE, if no valid user found
 * Returns user_id of matching user with $username and $password
 */
function login ($mysqli, $username, $password) {

    // not required at all
    // $user_id = user_id_from_username($mysqli, $username);

    // initialize, in case we do not get a mysqli-statement
    $userID = FALSE;
    $password = md5($password);
    $stmt = $mysqli->prepare(
                     "SELECT `user_id`          "
                   . "  FROM `users`            "
                   . " WHERE ( `username` = ? ) "
                   . "   AND ( `password` = ? ) "
            );

    if ( $stmt ) {
        $stmt->bind_param('ss', $username, $password);  
        $stmt->execute();
        $stmt->bind_result($userID);
        if ( TRUE !== $stmt->fetch()) {
            $userID = FALSE;
        }
    }
    $stmt->close();
    return $userID; 
} 
```

这是我在登录页面中调用函数登录的时候。`$mysqli`是包含与数据库的连接的变量。

```
// Now, needs to check against FALSE to work [changed by @SteAp]

//   var_dump( $login ); returns with int(1) 
//   and this is what I want, the integer 1

//Sends me to start.php but start.php does not recognize 
//the variable $_SESSION['user_id']
if ( FALSE === ($login = login($mysqli, $username, $password)) ) {  
  $errors[] = 'That username/password combination is incorrect';
} else {
  $_SESSION['user_id'] = $login;
  header('Location: start.php');
  exit();
}

if (empty($errors) === false) {
  echo '<div>'. output_errors($errors) . '</div>';
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-01T22:40:26.017

替换以下行：

```
if ($return == 1) {echo $user_id;} else {return false;} 
```

和

```
if ($return == 1) {return $user_id;} else {return false;} 
```

在您的示例中，您正在`$user_id`浏览器中编写变量，而不是将其返回给调用它的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T22:42:23.800

返回 user_id，而不是计数：

```
if ($stmt = $mysqli->prepare("SELECT `user_id` FROM `users` WHERE `username` = ? 
```

然后像这样使用它：

```
$stmt->bind_result($return);

if ( TRUE !== $stmt->fetch() ) {
  $return = FALSE
}

$stmt->close();

return $return; 
```

现在，`$return`如果找到记录中的一个`FALSE`或一个。`user_id`

而且，当然，**您需要在****对 $_SESSION 的**任何分配传递之前**[启动一个会话](http://php.net/manual/en/function.session-start.php)**。[PHP手册](http://php.net/manual/en/function.session-start.php)中的示例：

**page1.php**

```
session_start();

echo 'Welcome to page #1';

$_SESSION['favcolor'] = 'green';
$_SESSION['animal']   = 'cat';
$_SESSION['time']     = time();

// Works if session cookie was accepted
echo '<br /><a href="page2.php">page 2</a>'; 
```

**page2.php**

```
session_start();

echo 'Welcome to page #2<br />';

echo $_SESSION['favcolor']; // green
echo $_SESSION['animal'];   // cat
echo date('Y m d H:i:s', $_SESSION['time']);

// You may want to use SID here, like we did in page1.php
echo '<br /><a href="page1.php">page 1</a>'; 
```

# asp.net - 如果我选择一行

> ID：12231989
> 
> 赞同：0
> 
> 时间：2012-09-01T22:38:43.460
> 
> 标签：asp.net, vb.net, sql-server-2008, visual-web-developer

我将尽我所能解释这一点，尽管我承认我几个月来没有做太多尝试，所以我不仅生疏，而且不适合相处。

我正在使用可视化 Web 开发人员和 asp，vb 是带有 sql db 的代码。

如果我从表中选择一列，例如：

```
sqlCmd.CommandText = "SELECT Username, W1, W2, W3, W4 FROM tablename" 
```

假设此表中有多行，这些列中有数据。

当我做一个数据阅读器，或者我是如何被展示的时候，我声明 dr 像：

```
Dim dr As Data.SqlClient.SqlDataReader 
```

我可以使用选定的项目，例如：

```
dr.item(0)
dr.item(1) 
```

等等

但我可以使用的唯一项目是选择的第一行项目。如何选择表中的所有行。或者我如何使用 dr.item 处理来自多行的数据，或者以某种方式告诉它移动到下一行，以便 dr.item(0) 成为表中第二行的用户名。

我希望这是有道理的，如果这是一个愚蠢的问题，我很抱歉。我很感谢您提前花时间和帮助。多谢你们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-01T22:44:19.930

[`SqlDataReader.Read`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.read.aspx)将阅读器推进到下一条记录，并`true`在至少有另一行时返回：

```
Using conn = New SqlClient.SqlConnection(connString)
    Using cmd = New SqlClient.SqlCommand("SELECT Username, W1, W2, W3, W4 FROM tablename", conn)
        conn.Open()
        Using dr = cmd.ExecuteReader()
            While dr.Read()
                Dim UserName As String = dr.GetString(0)
                ' ... '
            End While
        End Using
    End Using        
End Using 
```

用于`Using`尽快处置任何实施`IDisposable`。它还将隐式关闭连接。

**编辑**：使用[`DataTable`](http://msdn.microsoft.com/en-us/library/system.data.datatable.aspx)

> 如何选择表格中的所有行

上面的`DataReader`方法效果很好，但是如果你想选择所有行并且可以全部加载到内存中，你可以使用 a`DataTable`代替。然后您还可以通过索引器访问每一行，如数组或列表：

```
Dim tblUsers = New DataTable()
Using conn = New SqlClient.SqlConnection(connString)
    Using da = New SqlClient.SqlDataAdapter("SELECT Username, W1, W2, W3, W4 FROM tablename", conn)
        da.Fill(tblUsers)
    End Using
End Using
' access a row via index: '
Dim row10 As DataRow = tblUsers.Rows(9)
Dim user10 = row10.Field(Of String)("Username")
' of course you can also iterate all rows: '
For Each row As DataRow In tblUsers.Rows
    Dim userName = row.Field(Of String)("Username")
Next 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-01T22:53:37.397

要遍历数据表的行，您需要使用以下方法：

```
while dr.read()
 Dim col1=dr.item(0)
 Dim col2=dr.item(1)
End while 
```

这样您就可以拥有所有行的每个属性。

# jquery - 多个表单的jquery验证

> ID：12231996
> 
> 赞同：0
> 
> 时间：2012-09-01T22:40:02.697
> 
> 标签：jquery, validation

我正在尝试对具有相同名称的多个表单进行验证，但我失败了这是我的代码

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.9/jquery.validate.min.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $("input.email").each(function(){
    $.validator.addMethod("email", function(value, element) {  
    return this.optional(element) || /^[a-zA-Z0-9._-]+@[a-zA-Z0-9-]+\.[a-zA-Z.]{2,5}$/i.test(value);  
    }, "Please enter a valid email address.");               
        });
        $("#signup").validate({
                rules: {
                        email: "required email",

                },
 });
    });

</script>

<form method="post" action="jqueryregthank.html" name="signup" id="signup">
<input type="text" name="email[]" id='email'/><br />
<input type="text" name="email[]" id='email'/><br />
<input type="text" name="email[]" id='email'/><br />
<input type="submit" value=" Sign-UP " name='SUBMIT' id="SUBMIT"/>
</form> 
```

我希望有一个人可以帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T04:01:03.323

很简单，只需在 $.each 选择器中指定要验证的字段。

```
$("input[name=email]").each(function(){ 
```

此外，HTML ID 标记必须是唯一的，否则您的页面会显得很时髦。一个名为的*类*`email`将更适合您的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-01T22:46:24.317

首先，在一个网页中，不能有两个 ID 相同的元素。所以改成

```
<input type="text" name="email[]" class='email'/><br /> 
```

这将起作用