# StackOverflow 问答 10936000-10936999

# ember.js - 恢复对 ember 数据模型的更改

> ID：10936007
> 
> 赞同：14
> 
> 时间：2012-06-07T16:33:14.020
> 
> 标签：ember.js, ember-data

有没有办法轻松恢复对 Ember Data 模型的更改？

我有一个绑定到编辑视图的模型。此视图使用户能够取消编辑，此时我想恢复对模型的更改。有没有一种简单的方法可以在不克隆所有值的情况下做到这一点？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2016-01-29T14:36:27.300

从 Ember Data 版本 2 开始，不再有事务，但您可以使用以下命令将模型重置为保存版本之前的最后状态：

```
model.rollbackAttributes(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-07T18:50:47.797

Ember Data 支持事务的概念。我们可以创建一个事务并将 Ember 数据记录分配给它们，如果我们想要撤消更改，我们可以调用事务 rollback() 方法。此外，如果我们不创建显式事务，则将记录分配给默认事务，可以通过调用 DS.store 对象本身的 rollback() 方法来回滚。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-07T22:02:31.443

默认事务的名称名为“defaultTransaction”。事实上，当 Embers 提交时，它使用这个默认事务。我不能直接在商店上直接使用回滚。

而不是使用 store.rollback，你应该有类似的东西：

```
store.get('defaultTransaction').rollback() 
```

或（如果您在路由器事件管理器中）

```
event.get('store.defaultTransaction').rollback() 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-01-12T10:59:45.487

如果模型处于“isDirty”状态，您也可以对模型本身进行[回滚。](http://emberjs.com/api/data/classes/DS.Model.html#method_rollback)

```
this.get('model').rollback(); 
```

例子

```
export default Ember.ObjectController.extend({

 actions: {
    cancelEditModel: function(){

        this.get('model').rollback();

        this.transitionToRoute('...');

        return false;
    }
  }
}); 
```

# c++ - 不允许使用 C++ 数据成员初始化程序

> ID：10936009
> 
> 赞同：12
> 
> 时间：2012-06-07T16:33:29.583
> 
> 标签：c++, arrays

我对 C++ 完全陌生，所以请耐心等待。我想用一个静态数组创建一个类，并从主数组访问这个数组。这是我想在 C# 中做的事情。

```
 namespace ConsoleApplication1
    {
        class Program
        {
            static void Main(string[] args)
            {
                Class a = new Class();
                Console.WriteLine(a.arr[1]);

            }
        }
    }

    =====================

    namespace ConsoleApplication1
    {
        class Class
        {       
            public static string[] s_strHands = new string[]{"one","two","three"};
        }
    } 
```

这是我尝试过的：

```
// justfoolin.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include <string>
#include <iostream>
using namespace std;

class Class {

  public:
      static string arr[3] = {"one", "two", "three"};
};

int _tmain(int argc, _TCHAR* argv[])
{
    Class x;
    cout << x.arr[2] << endl;
    return 0;
} 
```

但我得到了：IntelliSense：不允许数据成员初始化程序

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-07T16:36:51.323

您需要稍后执行初始化；您不能在类定义中初始化类成员。（如果可以，那么在头文件中定义的类将导致每个翻译单元定义自己的成员副本，从而使链接器变得一团糟。）

```
class Class {
  public:
      static string arr[];
};

string Class::arr[3] = {"one", "two", "three"}; 
```

类定义定义了与*实现*分开的*接口*。

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T16:38:16.833

您必须在类之外初始化静态成员，就好像它是一个全局变量一样，如下所示：

```
class Class { 

  public: 
      static string arr[3];
}; 

string Class::arr = {"one", "two", "three"}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T16:37:26.390

只能在类定义中初始化静态的整数类型数据成员。您的静态数据成员类型为`string`，因此无法内联初始化。

您必须在类*定义* `arr`之外进行定义，并在那里对其进行初始化。您应该从声明中删除初始化程序，并在您的课程之后删除以下内容：

```
string Class::arr[3] = {"one", "two", "three"}; 
```

如果您的类是在头文件中定义的，则其静态数据成员应仅在一个源 (.cpp) 文件中定义。

另请注意，并非所有出现在 Visual Studio 错误列表中的错误都是生成错误。值得注意的是，以“IntelliSense:”开头的错误是 IntelliSense 检测到的错误。IntelliSense 和编译器并不总是一致。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T16:38:12.057

您必须在类声明之外初始化您的静态成员：

```
string Class::arr[3] = {"one", "two", "three"}; 
```*

# visual-studio - 快速测试作为大型 DLL 项目一部分的函数

> ID：10936014
> 
> 赞同：4
> 
> 时间：2012-06-07T16:33:59.000
> 
> 标签：visual-studio

我使用 VS2010 进行 C++ 开发，我经常最终在一些 dll 项目中工作，并且在一切都编译好之后，我想尝试在某些类上运行虚拟数据，但事实上它是一个 dll 而不是一个 exe main 让它成为不可能。那么有没有一种简单的方法来做我想做的事，或者我被诅咒直到永远将一个大项目的部分 c/p 变成一个小测试？Ofc 更改项目的类型也可以，但我想有一些几乎像迭代 shell 测试功能的方式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-20T03:48:29.487

我知道这不是一个库或任何东西，但如果你想在 Windows 上运行 dll 而不将其构建成任何东西或编写脚本，你可以在 Windows 中使用 rundll32.exe。它允许您在 dll 中运行任何导出的函数。语法应该类似于：

`rundll32.exe PathAndNameofDll,exportedFunctionName [ArgsToTheExportedFunction]`

[http://best-windows.vlaurie.com/rundll32.html](http://best-windows.vlaurie.com/rundll32.html) - 是一个关于如何使用这个二进制文件的很好的简单但相关的教程。它有一些很酷的技巧，可能会让你大吃一惊。

如果您想知道 64 位版本，它具有相同的名称（真的是微软？）在这里查看： [rundll32.exe 等效于 64 位 DLL](https://stackoverflow.com/questions/4703635/rundll32-exe-equivalent-for-64-bit-dlls)

此外，如果你想进入低级别，理论上你可以使用[OllyDbg](http://www.ollydbg.de)，它带有一个 DLL 加载器来运行你想要调试的 DLL（在汇编中），你可以在其中做相同类型的事情（调用导出的函数并传递args），但调试器更多的是用于逆向工程而不是代码调试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-14T01:19:23.657

我认为您基本上有两种选择。

首先，是对函数使用某种单元测试。对于 C++，你可以找到各种实现，看看[CppUnit](http://sourceforge.net/projects/cppunit/)

第二种选择是打开 DLL，通过 Win32API 获取函数并以这种方式调用它（这在某种程度上仍然符合单元测试的条件）。您可以通过创建执行上述参数化所需信息（例如 dll 路径、函数名称）的可执行文件来概括这种方法，以实现您提到的“交互式外壳”——如果您决定采用此路径，您可以查看[这篇](http://www.codeproject.com/Articles/6242/Step-by-Step-Calling-C-DLLs-from-VC-and-VB-Part-1)关于从 C++ 加载 DLL 的CodeProject 文章

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-19T20:57:57.327

除了使用 CppUnit 提供的单元测试外，您还可以编写自己的小型测试框架。这样你就可以根据需要设置你的 Dll 项目，加载它，链接它，无论你想要什么，并用一些你喜欢的简单数据来证明它。

如果您有许多相互依赖的 Dll 来完成某项工作，这是很有价值的。（根据我的经验，C++ 中的遗留 Dlls 项目往往难以测试）。

完成一些框架应用程序后，您还可以检查 CppUnit 提供给您的可能性并将其与您的测试框架结合起来。

这样你最终会得到一套很好的自动化测试，它们仍然是有价值的单元测试。如果项目已经有一定规模，开始进行单元测试有点困难。拥有自己的框架可以让您在对 dll 进行一些更改时编写测试。只需将其插入您的框架，测试您期望它做什么并越来越多地增强您的框架。

基本思想是将测试、测试运行程序、测试数据和要进行的断言分开。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-19T12:13:21.313

我正在使用 python + ctypes 为我的 DLL 应用程序构建快速测试例程。

如果您使用扩展属性语法，对您来说会很容易。

Google for Python + ctypes + test unit 你会发现几个例子。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-20T14:25:24.107

我会推荐 Window Powershell 命令行开关。

如果您查看此处的文章 - [http://msdn.microsoft.com/en-us/magazine/cc163430.aspx](http://msdn.microsoft.com/en-us/magazine/cc163430.aspx)，您会发现设置起来是多么容易。当然，这篇文章主要是关于测试 C# 代码，但你可以看到他们是如何谈论能够以同样的方式加载任何启用 COM 的 DLL。

在这里您可以看到如何加载 COM 程序集 - [http://blogs.technet.com/b/heyscriptingguy/archive/2009/01/26/how-do-i-use-windows-powershell-to-work-with -junk-e-mail-in-office-outlook.aspx](http://blogs.technet.com/b/heyscriptingguy/archive/2009/01/26/how-do-i-use-windows-powershell-to-work-with-junk-e-mail-in-office-outlook.aspx)

编辑：我认识一家非常成功的存储虚拟化软件公司，它广泛使用 Powershell 来测试它的托管和非托管（驱动程序）代码。

# facebook-opengraph - Spotify 与 Facebook OpenGraph 的集成

> ID：10936016
> 
> 赞同：1
> 
> 时间：2012-06-07T16:34:12.340
> 
> 标签：facebook-opengraph, spotify

我正在尝试重现 Spotify opengraph 集成的一些很酷的东西，但我了解它们是如何做的一件事：

当您访问您的 Spotify 应用配置文件（我的：[https](https://www.facebook.com/antonio.mendespinto/music) ://www.facebook.com/antonio.mendespinto/music ）时，您可以看到音乐家链接指向 facebook 页面而不是 Spotify 网页（http:// open.spotify.com/artist/7CajNmpbOovFooOoasH2HaY）。他们是怎么做到的。

此外，这是否让 Facebook 在幕后制作艺术家页面[https://www.facebook.com/ogp/464730384564/](https://www.facebook.com/ogp/464730384564/)顶部的漂亮框，显示朋友与艺术家的互动并确定朋友互动。

一切似乎都指向 facebook 页面而不是 spotify 页面。他们是怎么做到的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T20:37:40.630

Open Graph 工件内链接的目的地由开发人员自行决定。假设您正在编写一个让人们分享餐厅小贴士的应用程序。当您向 OG 发布“提示”对象时，您自然会包含指向餐厅的链接。作为应用程序开发人员，您可以选择餐厅的网页、Yelp 页面、OpenTable 页面、您自己在网站上的餐厅页面或互联网上的任何其他网页。:-)

面对类似的情况，我选择使用*我自己的应用程序的*网页来表示一家餐馆。我尝试使用餐厅的 Facebook 页面（我必须使用 Graph API 进行搜索）以及第三方餐厅信息提供商，例如 Yelp。使用 Facebook 页面，我的应用程序感觉与 Facebook 的集成更加紧密，但我没有享受拥有自己的 Facebook 应用程序元数据的奢侈。因为我选择链接到我自己的餐厅页面，所以我能够设置和检索我想要的任何元数据，当我开始配置聚合时，这些元数据真的派上了用场。

我不知道 Spotify 数据如何出现在艺术家页面上，也不知道他们如何设法将歌曲和专辑对象塞进 OpenGraph 上的每个收听帖子中，例如：“Chris**在 Main Street**上的Exile 上听了**Torn and** Frayed 。” 我只能得到**一个与动作相关联的对象，例如“克里斯在****加利福尼亚披萨厨房**留下了小费”。我的假设是，由于他们是（如果不是唯一的）Facebook Open Graph 发布合作伙伴之一，他们可能得到了一些内部帮助。

 ******* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T21:19:29.743

是的，Spotify 使用 Facebook Open Graph Music，这是一组预定义的音乐对象和属性。

[https://developers.facebook.com/docs/opengraph/music/](https://developers.facebook.com/docs/opengraph/music/)

然后我猜想 Spotify 帐户的标记方式使其可用。这可能是 Facebook 在艺术家页面中显示漂亮框的原因。

我在 Spotify 工作，但我不确定这一切的所有细节。我知道其他音乐流媒体服务也使用这个，但我不确定它是否仍然需要一个特殊帐户。一开始就这样。Spotify 是 Open Graph 的首批用户之一。******

# tcp - 是否使用相当于本地IP地址的环回地址？

> ID：10936020
> 
> 赞同：0
> 
> 时间：2012-06-07T16:34:27.317
> 
> 标签：tcp, ip, localhost, loopback, nic

使用环回地址 127.0.0.1 将绕过 NIC。如果本地机器分配了其他 IP 地址，从该机器到使用该 IP 地址的同一台机器的流量是否会命中 nic？如果有，这对性能有什么影响（如果有的话）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:38:17.970

不，它不会触及 NIC。性能影响可以忽略不计。

当然，除非您正在运行一个非常愚蠢的操作系统。

# javascript - 隐藏javascript代码或将其放在根文件夹之外？

> ID：10936025
> 
> 赞同：0
> 
> 时间：2012-06-07T16:34:35.610
> 
> 标签：javascript, apache, hide, root

我正在开发一个应用程序，并且在代码中包含一些重要信息，例如 IP 和必须是私有的东西。我使用 apache web 服务器作为服务器，想知道是否有任何方法隐藏 javascript 代码或将其移动到根文件夹之外？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T16:36:44.773

不，根据定义。Javascript 代码在*客户端*计算机上运行。这意味着客户端必须有权访问 Javascript 源代码才能正常工作。您可以使用 AJAX 隐藏某些数据，直到需要它，但即使这样，客户端（以及任何使用 Firebug 的用户）也能够查看它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:37:16.033

“隐藏”它的唯一方法是通过某种混淆实用程序或缩小 javascript。但是，不幸的是，一旦 javascript 代码进入浏览器。您对此无能为力。

# macos - Mac App Store 沙盒应用程序可以使用 CGEventPost 吗？

> ID：10936028
> 
> 赞同：3
> 
> 时间：2012-06-07T16:35:00.123
> 
> 标签：macos, events, sandbox, mac-app-store, appstore-sandbox

对于我正在开发的应用程序，我`CGEventPost`用来发布一些关键事件，我注意到它在启用沙盒的情况下停止工作，即使我打开了“启用辅助设备访问”系统首选项。

是否有权允许使用`CGEventPost`? 或者，是否有其他方法可以通过提交到 Mac App Store 的应用发布关键事件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T23:59:40.137

> Mac App Store 沙盒应用程序可以使用 CGEventPost 吗？

不。

> CGEventPost 有权利吗？或者有什么方法可以通过提交到 Mac App Store 的应用发布关键事件？

不。

如果您查看开发者论坛，Apple 已经明确表示他们永远不会为此启用权利，因为它允许任何应用程序以明显的方式逃离沙箱。

如果您有一些可以证明的更具体的需求（不是“发布一些关键事件”而是“让 iPhoto 对 XXX 进行操作，据我所知，这只能通过在其中发布事件 YYY 来完成”），提交错误报告，并在开发论坛上发布主题。

这将做两件事：

1.  Apple 的某个人可能会建议一种解决方法 - 可能是其他人无法告诉您的私人解决方案和/或 App Store 通常不允许使用但如果您被告知使用它会被接受的解决方案。
2.  它增加了 Apple 在未来发明一些更好的方法来做你想做的事情的机会。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-10T20:59:46.160

老问题，但接受的答案是错误的。Mac App Store 中有一些应用程序使用 CGEventPost 来模拟事件。例如应用程序“Remote Mouse”和“Mobile Mouse Server”就是这样做的。他们可以将输入发送到任何其他应用程序，并且基于这些应用程序中的符号，他们显然正在使用 CGEventPost 函数。我想知道他们是怎么做到的。

# ms-office - 直接在 Office 中从网页打开文档

> ID：10936029
> 
> 赞同：0
> 
> 时间：2012-06-07T16:35:03.963
> 
> 标签：ms-office, webdav, alfresco, dms

我有一个简单的 asp.net mvc Web 应用程序，它通过 CMIS api（soap）与 Alfresco DMS 进行通信。我希望能够直接从我的网页在 Microsoft Office（比如说 2007 版及更高版本）中打开文档，在 Office 中编辑此文档并通过 Office 中的“保存”按钮将文档保存到露天存储库。

无论如何通过WebDAV协议来解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T20:31:09.510

将评论推广到答案

如果您想从 Microsoft Office 中与 Alfresco 集成，那么有一种非常简单的方法可以做到这一点，但它不是常规的 WebDav。相反，您需要的是[SharePoint 协议集成](http://docs.alfresco.com/4.0/topic/com.alfresco.enterprise.doc/concepts/SharePoint-intro.html)。有了这个，Alfresco 将 Office 伪装成 SharePoint。您通常在 Office 和 SharePoint 之间获得的所有集成都可以在 Office 和 Alfresco 之间进行。

一旦您安装了 SPP/Vti 放大器并对其进行了[适当的配置](http://docs.alfresco.com/4.0/topic/com.alfresco.enterprise.doc/concepts/SharePoint-intro.html)，然后在 Share 中您应该能够为文档选择“在线编辑”。这将启动 Office，它会与 Alfresco 对话以加载、保存等文件。然后，您可以在办公室内处理文档，并在完成后将其保存回 Alfresco，就像您拥有 SharePoint 时所做的那样。

# php - 在 CGridView 上使用 Yii 模型和标准

> ID：10936031
> 
> 赞同：0
> 
> 时间：2012-06-07T16:35:07.193
> 
> 标签：php, yii, cgridview, zii-widgets

我正在尝试使用我的模型替换搜索（自定义搜索功能）：

```
public function combineCampInputByDate($startDate,$endDate) {

$criteria=new CDbCriteria;
$criteria->select   = 'food.*,SUM(customer) AS customer, SUM(money) AS money';
$criteria->join     = 'JOIN foodType food ON foodtype = food.foodtype ';     
$criteria->condition = "date BETWEEN '$startDate' AND '$endDate'";
$criteria->group        = 'foodtype ';
return new CActiveDataProvider($this, array(
            'criteria'=>$criteria,
    ));
} 
```

结果将是模型+另一个表的属性。

我正在尝试在视图中显示它们，但它没有声明诸如 .... 之类的属性（这很清楚，因为模型没有来自另一个表的属性）

那么我如何在模型结果上使用下面的小部件？

令人沮丧，但依靠专家:) 丹尼

* * *

编辑：1.控制器 -

```
public function actionIndex()
{
if (isset($_POST['Filter']) && !empty($_POST['Filter']['date']) ) {
$GetDates = new GetDates();
$this->dates = $GetDates->getDatesFromPostWidget($_POST);
$model = new Campaigns;
}
else 
$model=NULL;
$this->render('index',array(
'model' => $model, 'dates' => $this->dates,
)); 
} 
```

模型 -

```
public function combineCampInputByDate($startDate,$endDate) {

$criteria=new CDbCriteria;
$criteria->select = 'food.*,SUM(customer) AS customer, SUM(money) AS money';
$criteria->join = 'JOIN foodType food ON foodtype = food.foodtype '; 
$criteria->condition = "date BETWEEN '$startDate' AND '$endDate'";
$criteria->group = 'foodtype ';
return new CActiveDataProvider($this, array(
'criteria'=>$criteria,
));
} 
```

看法

```
$this->widget('zii.widgets.grid.CGridView', array(
'id'=>'bo-campaigns-grid',
'dataProvider'=>$model->combineCampInputByDate($dates['startDate'],$dates['endDate']),
'filter'=>$model,  
),
));
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T18:12:48.377

在您的模型类中创建两个属性：`public $customer`和`public $money`.

您可以拥有任意数量的自定义属性，只要与命名保持一致即可。`fieldname AS something`（如果没有先有`something`model属性就不能使用SQL ）

编辑：您还应该告诉[CGridView](http://www.yiiframework.com/doc/api/1.1/CGridView/)要显示哪些[列](http://www.yiiframework.com/doc/api/1.1/CGridView/#columns-detail)，像这样

```
$this->widget('zii.widgets.grid.CGridView', array(
     'id'=>'bo-campaigns-grid',
     'dataProvider'=>$model->combineCampInputByDate($dates['startDate'],$dates['endDate']),
     'filter'=>$model,
     'columns'=>array(
        'customer',
        'money',
       //etc. for more detailed customization, check the links above
     ),    
   ),
));
} 
```

# jquery - 如何选择php脚本生成的动态id

> ID：10936033
> 
> 赞同：1
> 
> 时间：2012-06-07T16:35:12.857
> 
> 标签：jquery, jquery-selectors

这很奇怪，但我发现所有文章都不适合我。我的表单中有 ID，例如由 PHP 脚本生成的 formup_1、formup_2。现在我无法选择特定的 ID。我怎样才能做到这一点。我必须使用 live 来绑定事件吗？

我试着这样做：

```
var vvv=$("form[id^='rating_formup_']");

<form id="rating_formup_1">
<input type="submit" name="n" value="">
</form>
<form id="rating_formup_2">
<input type="submit" name="n" value="">
</form>
.
.
. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T16:36:28.560

```
$('form[id^="rating_formup_"]').foo(); 
```

它将选择所有以`<form>`它们`id`开头的元素`formup`

您还可以使用：

```
$('form').filter(function(){
    return /^rating_formup_/.test(this.id);
}); 
```

这可能会快一点。

如果你这样做并且它仍然无法正常工作：

1.  检查错别字。
2.  确保 DOM 已准备就绪。
3.  如果`<form>`是动态创建的，请确保在将它们插入DOM**后查询 DOM。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:43:55.283

试试这个

```
$('form[id^="rating_formup_"]'); // select any form id start with rating_formup_ 
```

要绑定事件，您可以尝试

```
$('form[id^="rating_formup_"]').on('click', function() {
 // your stuff
}); 
```

**或者**

```
$('form[id^="rating_formup_"]').each(function() {
  $(this).on('click', function() {
    // do something 
  });
}); 
```

### 余

*   重新检查输入错误

*   不要忘记包含 jQuery 库

*   `$(document).ready(function() {...})`简而言之，将您的代码放在`$(function() {..})`.

# ruby-on-rails - 无法使用 ruby -oci8 连接到远程 oracle 数据库，ORA-06401

> ID：10936037
> 
> 赞同：1
> 
> 时间：2012-06-07T16:35:34.820
> 
> 标签：ruby-on-rails, ruby, oracle, oci8

我正在尝试在我的 rails 应用程序中使用远程数据库。为此，我按照以下说明使用 ruby​​-oci8：[http ://www.pixellatedvisions.com/2009/03/26/rails-on-oracle-part-2-setting-up-rails-to-connect-到 Oracle 数据库](http://www.pixellatedvisions.com/2009/03/26/rails-on-oracle-part-2-setting-up-rails-to-connect-to-an-oracle-database)

我对第 1 部分没有任何问题，通过 sqlplus 连接到远程数据库，但是当我尝试使用 oci8 时：

```
ruby -r oci8 -e "OCI8.new('user', 'pass', 'host_ip:port/sid').exec('SELECT * FROM table') {|r| puts ' | ' r.join}" 
```

我得到：

```
oci8.c:267:in oci8lib_191.so: ORA-06401: NETCMN: invalid driver designator (OCIError)
        from -e:1:in `new'
        from -e:1:in `<main>' 
```

谷歌搜索这个错误我读了这个[http://www.dba-oracle.com/t_ora_06401_netcmn_invalid_driver_designator.htm](http://www.dba-oracle.com/t_ora_06401_netcmn_invalid_driver_designator.htm)这对我的情况没有任何帮助。我还读到我应该有一个 TNSNAMES.ORA 文件，但我没有……所以我创建了一个没有任何运气的文件。

顺便说一句，我正在使用 ruby​​-oci8-2.0.6-x86-mingw32.gem（因为我在 Windows 中）、ruby 1.9.3 和 rails 3.2.3

有什么线索吗？

**编辑**

谷歌搜索了一下，发现：

*   问题描述：无法在她的某些数据库上运行健康检查。出现错误“ORA-06401: NETCMN: invalid driver designator”，然后运行状况检查显示“连接失败 (1)”的注释。直接从 Toad 的连接窗口连接到该数据库没有问题。
*   原因：特定于在 9i 客户端上使用直接连接并在运行状况检查中选择直接连接数据库的问题。
*   解决方案：解决方案 1：使用不同的方法连接，选择作为 TNS 连接而不是直接连接。在这种情况下，您可以使用 9i 客户端。解决方案 2：使用不同的客户端连接，如果需要使用直接连接，请升级到 10g 或 11g 客户端。

# java - 如何使用 JavaCompiler API 一次性编译多个 Java 类

> ID：10936039
> 
> 赞同：4
> 
> 时间：2012-06-07T16:35:39.860
> 
> 标签：java, compilation, java-compiler-api

我是 Java 新手，我正在关注[本教程](http://www.javabeat.net/2007/04/the-java-6-0-compiler-api/)，因为它提供的信息非常丰富，并且非常详细地解释了所有内容。在教程的底部，它解释了如何使用 JavaFileManager 编译多个 java 文件并给出了一些例子，但我仍然无法自己编译多个文件

另一个问题是，在示例中，它只显示了如何编译一个 java 文件（我已经可以开始工作了），但我遇到了多个文件，因为我希望能够编译由我自己系统中的多个java类

这就是我现在所要做的：

```
public static void main(String[] args) throws Exception {
    JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();
    // Line 1.
    MyDiagnosticListener listener = new MyDiagnosticListener(); // Line 2.
    StandardJavaFileManager fileManager = compiler.getStandardFileManager(
            listener, null, null); // Line 3.
    String fileToCompile = "test" + File.separator + "ManyErrors.java";
    // Line 4
    Iterable fileObjects = fileManager.getJavaFileObjectsFromStrings(Arrays
            .asList(fileToCompile)); // Line 5
    CompilationTask task = compiler.getTask(null, fileManager, listener,
            null, null, fileObjects); // Line 6
    Boolean result = task.call(); // Line 7
    if (result == true) {
        System.out.println("Compilation has succeeded");
    }
}

class MyDiagnosticListener implements DiagnosticListener {
public void report(Diagnostic diagnostic) {
    System.out.println("Code->" + diagnostic.getCode());
    System.out.println("Column Number->" + diagnostic.getColumnNumber());
    System.out.println("End Position->" + diagnostic.getEndPosition());
    System.out.println("Kind->" + diagnostic.getKind());
    System.out.println("Line Number->" + diagnostic.getLineNumber());
    System.out.println("Message->" + diagnostic.getMessage(Locale.ENGLISH));
    System.out.println("Position->" + diagnostic.getPosition());
    System.out.println("Source" + diagnostic.getSource());
    System.out.println("Start Position->" + diagnostic.getStartPosition());
    System.out.println("\n");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:07:06.130

[getJavaFileObjectsFromStrings](http://docs.oracle.com/javase/7/docs/api/javax/tools/StandardJavaFileManager.html#getJavaFileObjectsFromStrings%28java.lang.Iterable%29) from`StandardJavaFileManager`需要一个`Iterable<String>`.

这意味着您可以将任何可迭代的字符串集合传递给它以获取`Iterable<? extends JavaFileObject>`，然后将其传递给实现该接口的任何类的[getTask 方法。](http://docs.oracle.com/javase/7/docs/api/javax/tools/JavaCompiler.html#getTask%28java.io.Writer%2C%20javax.tools.JavaFileManager%2C%20javax.tools.DiagnosticListener%2C%20java.lang.Iterable%2C%20java.lang.Iterable%2C%20java.lang.Iterable%29)`JavaCompiler`

* * *

这与答案无关，但我想补充一点，如果您的目标是熟悉 Java，那么您可能走错了路。Java 类的过程编译是一个相当高级的主题，您似乎没有完全理解您发布的代码，因为您的问题的答案就在其中：`Arrays.asList(fileToCompile)`调用创建了一个字符串数组，其中只有一个字符串；即使没有文档，也应该很容易推断出`getJavaFileObjectsFromStrings`对应于文件名的字符串数组。所以我真的不会尝试走这条路，而是首先让自己熟悉 Java 文档和更简单的概念。特别是如果您不熟悉 OO 概念。

# android - Android小部件获取触摸位置

> ID：10936040
> 
> 赞同：1
> 
> 时间：2012-06-07T16:35:46.953
> 
> 标签：android, widget, touch, homescreen

当用户在主屏幕上触摸我的小部件时，是否可以获得触摸位置？TIA

编辑：我的小部件代码：

```
public class MyWidgetProvider extends AppWidgetProvider {
public static String ACTION_WIDGET_MEMO = "comNgarsideMemoActionWidgetMemo";
public static String ACTION_WIDGET_PEN = "comNgarsideMemoActionWidgetPen";
public static String ACTION_WIDGET_ERASER = "comNgarsideMemoActionWidgetEraser";
public static String ACTION_WIDGET_UNDO = "comNgarsideMemoActionWidgetUndo";
public static String ACTION_WIDGET_REDO = "comNgarsideMemoActionWidgetRedo";
public static String ACTION_WIDGET_SAVE = "comNgarsideMemoActionWidgetSave";
@Override
public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
    RemoteViews remoteViews = new RemoteViews(context.getPackageName(), R.layout.widget_layout);
    Intent memoIntent = new Intent(context, ListActivity.class);
    memoIntent.setAction(ACTION_WIDGET_MEMO);
    Intent penIntent = new Intent(context, MyWidgetProvider.class);
    penIntent.setAction(ACTION_WIDGET_PEN);
    Intent eraserIntent = new Intent(context, MyWidgetProvider.class);
    eraserIntent.setAction(ACTION_WIDGET_ERASER);
    Intent undoIntent = new Intent(context, MyWidgetProvider.class);
    undoIntent.setAction(ACTION_WIDGET_UNDO);
    Intent redoIntent = new Intent(context, MyWidgetProvider.class);
    redoIntent.setAction(ACTION_WIDGET_REDO);
    Intent saveIntent = new Intent(context, MyWidgetProvider.class);
    saveIntent.setAction(ACTION_WIDGET_SAVE);
    PendingIntent memoPendingIntent = PendingIntent.getActivity(context, 0, memoIntent, 0);
    PendingIntent penPendingIntent = PendingIntent.getBroadcast(context, 0, penIntent, 0);
    PendingIntent eraserPendingIntent = PendingIntent.getBroadcast(context, 0, eraserIntent, 0);
    PendingIntent undoPendingIntent = PendingIntent.getBroadcast(context, 0, undoIntent, 0);
    PendingIntent redoPendingIntent = PendingIntent.getBroadcast(context, 0, redoIntent, 0);
    PendingIntent savePendingIntent = PendingIntent.getBroadcast(context, 0, saveIntent, 0);
    remoteViews.setOnClickPendingIntent(R.id.iconBtn, memoPendingIntent);
    remoteViews.setOnClickPendingIntent(R.id.penBtn, penPendingIntent);
    remoteViews.setOnClickPendingIntent(R.id.eraserBtn, eraserPendingIntent);
    remoteViews.setOnClickPendingIntent(R.id.undoBtn, undoPendingIntent);
    remoteViews.setOnClickPendingIntent(R.id.redoBtn, redoPendingIntent);
    remoteViews.setOnClickPendingIntent(R.id.saveBtn, savePendingIntent);
    appWidgetManager.updateAppWidget(appWidgetIds, remoteViews);
}

@Override
public void onReceive(Context context, Intent intent) {
    final String action = intent.getAction();
    if (AppWidgetManager.ACTION_APPWIDGET_DELETED.equals(action)) {
            final int appWidgetId = intent.getExtras().getInt(AppWidgetManager.EXTRA_APPWIDGET_ID, AppWidgetManager.INVALID_APPWIDGET_ID);
        if (appWidgetId != AppWidgetManager.INVALID_APPWIDGET_ID) {
            this.onDeleted(context, new int[] { appWidgetId });
        }
    } else {
        if (intent.getAction().equals(ACTION_WIDGET_PEN)) {
        } else if (intent.getAction().equals(ACTION_WIDGET_ERASER)) {
        } else if (intent.getAction().equals(ACTION_WIDGET_UNDO)) {
        } else if (intent.getAction().equals(ACTION_WIDGET_REDO)) {
        } else if (intent.getAction().equals(ACTION_WIDGET_SAVE)) {
        }
        super.onReceive(context, intent);
    }
} 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T16:45:17.717

也许这会给你一个想法......

**压力动力学.java**

```
import java.io.FileDescriptor;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.Collection;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import android.content.Context;
import android.util.Log;

/**
 * Keyboard sensor
 */
public class PressureDynamics extends Thread implements FeatureExtractor{

    public static final String AVG_TOUCH_PRESSURE = "Avg_Touch_Pressure";

    public static final String AVG_TOUCH_AREA = "Avg_Touch_Area";

    private static final int EVENT_BYTE_SIZE = 16;

    private InputStream _fis = null;

    private boolean _shouldRun;

    private Map<String, TouchScreenSensor> _sensors;

    public PressureDynamics(Context context, Collection<FeatureInfo> featureInfos,
        Long timeStamp){
        super("Pressure Dynamics Feature Extractor Thread");
        _shouldRun = true;

        _sensors = new HashMap<String, TouchScreenSensor>();

        int featureCount = 0;
        for (FeatureInfo featureInfo : featureInfos){
            String name = featureInfo.name;

            try{
                if (name.equalsIgnoreCase(AVG_TOUCH_PRESSURE)){
                    TouchScreenSensor s = new AvgTouchPressureSensor(featureInfo);
                    _sensors.put(AVG_TOUCH_PRESSURE, s);
                }else if (name.equalsIgnoreCase(AVG_TOUCH_AREA)){
                    TouchScreenSensor s = new AvgTouchAreaSensor(featureInfo);
                    _sensors.put(AVG_TOUCH_AREA, s);
                }else{
                    Log.e(FE_TAG, "Unhandled feature by " + getClass().getCanonicalName()
                            + ": " + name);
                    continue;
                }
                ++featureCount;
            }catch(RuntimeException e){
                Log.e(FE_TAG, "Unable to initialize feature: " + name, e);
            }
        }

        if (featureCount == 0){
            throw new FeatureExtractorInitException("No features of "
                    + getClass().getCanonicalName() + " could be initialized");
        }

        _fis = openTouchScreenInputStream();

        start();
    }

    private static InputStream openTouchScreenInputStream(){
        final String HTC_TOUCH_SCREEN_INPUT_FILEPATH = "/dev/input/event1";

        LocalServerConn localServerConn;
        try{
            localServerConn = LocalServerConn.getInstance();
            localServerConn.runLocalServer();
        }catch(Exception e){
            throw new FeatureExtractorInitException(
                    "Unable to collect Touch Screen features", e);
        }

        try{
            FileDescriptor[] fdArr = localServerConn
                    .sendFileDescriptorReq(HTC_TOUCH_SCREEN_INPUT_FILEPATH);

            if (fdArr == null || fdArr.length == 0){
                throw new FeatureExtractorInitException("Can't open keyboard device");
            }
            return new FileInputStream(fdArr[0]);
        }catch(IOException e){
            throw new FeatureExtractorInitException("Can't open keyboard input stream: "
                    + e.getMessage(), e);
        }
    }

    public void close(){
        _shouldRun = false;
    }

    public void collectData(List<MonitoredData> monitoredData, ParcelableDate endTime){
        for (Sensor s : _sensors.values()){
            s.collectData(monitoredData, endTime);
        }
    }

    public void run(){
        int n;
        int pos = 0;
        byte[] buffer = new byte[256];

        for (;;){
            try{
                n = _fis.read(buffer, pos, EVENT_BYTE_SIZE);
                /*
                 * check if we are shutting down - this may have the thread hanging around
                 * until the next touch event comes in
                 */
                if (_shouldRun == false){
                    break;
                }
                pos += n;
                // Log.v(FE_TAG, "read touch screen event: " + n + " bytes\n");
                if (pos >= EVENT_BYTE_SIZE){
                    long currentTimeMillis = System.currentTimeMillis();
                    TouchEvent touchScreenEvent = new TouchEvent(buffer,
                            currentTimeMillis);
                    updateSensors(touchScreenEvent, currentTimeMillis);
                    pos -= EVENT_BYTE_SIZE;
                }
            }catch(IOException e){
                Log.e(FE_TAG, e.getMessage(), e);
            }
        }
    }

    private void updateSensors(TouchEvent touchScreenEvent, long currentTimeMillis){
        try{
            // currently filter out all non preassure event types
            // 
            switch ((int)touchScreenEvent.getCode()){
                case TouchEvent.X_POS_EVENT:
                case TouchEvent.Y_POS_EVENT:
                case TouchEvent.TOUCH_DEVICE_TYPE_EVENT:
                    break;
                case TouchEvent.ABS_PRESSURE_EVENT:
                    _sensors.get(AVG_TOUCH_PRESSURE).updateSensor(touchScreenEvent,
                        currentTimeMillis);
                    break;
                case TouchEvent.ABS_TOOL_WIDTH_EVENT:
                    _sensors.get(AVG_TOUCH_AREA).updateSensor(touchScreenEvent,
                        currentTimeMillis);
                    break;
                default:
                    Log.e(FE_TAG, "unrecognized touch event code :"
                            + touchScreenEvent.getCode());
                    break;
            }
        }catch(Exception e){
            Log.e(FE_TAG, e.getMessage(), e);
        }
    }

    public String toString(){
        return getClass().getSimpleName();
    }

    private static abstract class TouchScreenSensor extends Sensor{
        private TouchScreenSensor(String name, FeatureInfo info){
            //super(name, info.getValueTimeout());
            super(name);
        }

        public abstract void updateSensor(TouchEvent event, long currentTimeMillis);
    }

    private static class AvgTouchPressureSensor extends TouchScreenSensor{
        public AvgTouchPressureSensor(FeatureInfo info){
            super(AVG_TOUCH_PRESSURE, info);
        }

        public void updateSensor(TouchEvent event, long currentTimeMillis){
            addToAvg(event.getValue(), currentTimeMillis);
        }
    }

    private static class AvgTouchAreaSensor extends TouchScreenSensor{
        public AvgTouchAreaSensor(FeatureInfo info){
            super(AVG_TOUCH_AREA, info);
        }

        public void updateSensor(TouchEvent event, long currentTimeMillis){
            addToAvg(event.getValue(), currentTimeMillis);
        }
    }
} 
```

**传感器.java**

```
import java.util.List;

public class Sensor{
    private final String _name;

    private Double _avg;

    private int _count;

    private long _lastValueUpdateTime;

    /**
     * Constructor
     * 
     * @param name The name of the feature that is collected by this sensor
     * @param valueTimeout The time period of no value changes it takes for the current
     *        value to reset to the initial value (in millis)
     */
    public Sensor(String name){
        _lastValueUpdateTime = 0;
        _name = name;
        _avg = null;
        _count = 0;
    }

    public void collectData(List<MonitoredData> monitoredData, ParcelableDate endTime){
        Double value = getValue(endTime.getTime());

        if (value != null){
            value = Utils.truncateDouble(value);
        }

        monitoredData.add(new MonitoredData(_name, value, endTime));
    }

    public Double getValue(long time){
        if (time - _lastValueUpdateTime > MainActivity.getAgentLoopTime()){
            _avg = null;
            _count = 0;
        }

        return _avg;
    }

    public String getName(){
        return _name;
    }

    public void addToAvg(double value, long time){      
        Double avg = getValue(time);

        if (avg == null){
            avg = value; // Initial value
        }else{
            value = (avg * _count + value) / (_count + 1);
        }   
        ++_count;

        _avg = value;
        _lastValueUpdateTime = time;
    }

    @Override
    public String toString(){
        return _name;
    }
} 
```

**触摸事件.java**

```
import android.util.Log;
import dt.util.Utils;

    public class TouchEvent{

        public static final int ABS_PRESSURE_EVENT = 0x18;

        public static final int ABS_TOOL_WIDTH_EVENT = 0x1c;

        public static final int X_POS_EVENT = 0x0;

        public static final int Y_POS_EVENT = 0x1;

        /* type of touching device ie. finger, stylus etc. */
        public static final int TOUCH_DEVICE_TYPE_EVENT = 0x14a;

        // private final long _timeStamp;

        // private final int _sec;

        // private final int _usec;

        // 3, 1, 0 - ?
        // private final long _type;

        // different event types have different codes
        private final long _code;

        private final int _value;

        // 
        public TouchEvent(byte[] _buffer, long currentTimeMillis){
            int pos;
            byte b[] = new byte[4];
            byte s[] = new byte[2];

            // _timeStamp = currentTimeMillis;

            pos = 0;
            // _sec = Utils.LittleEndianBytesToInt(_buffer);
            pos += 4;
            System.arraycopy(_buffer, pos, b, 0, 4);
            // _usec = Utils.LittleEndianBytesToInt(b);
            pos += 4;
            // _type = Utils.LittleEndianBytesToUShort(s);
            pos += 2;
            System.arraycopy(_buffer, pos, s, 0, 2);
            _code = Utils.littleEndianBytesToUShort(s);
            pos += 2;
            System.arraycopy(_buffer, pos, b, 0, 4);
            _value = Utils.littleEndianBytesToInt(b);

            if (_code != X_POS_EVENT && _code != Y_POS_EVENT
                    && _code != TOUCH_DEVICE_TYPE_EVENT && _code != ABS_PRESSURE_EVENT
                    && _code != ABS_TOOL_WIDTH_EVENT){
                Log.d(FE_TAG, "unrecognized touch event code :" + _code);
            }
        }

        public long getCode(){
            return _code;
        }

        public double getValue(){
            return _value;
        }
    } 
```

**特征信息.java**

```
import java.util.HashMap;

public class FeatureInfo{
    /** The name of the feature */
    public final String name;

    /** The parameters relevant to the feature */
    public final HashMap<String, String> params;

    /**
     * Constructs a FeatureInfo object from the given parameters
     * 
     * @param name The name of the feature
     * @param params The parameters relevant to the feature
     */
    public FeatureInfo(String name, HashMap<String, String> params){
        this.name = name;
        this.params = (params == null) ? new HashMap<String, String>() : params;
    }

    @Override
    public String toString(){
        return name;
    }

    public int getTimeWindow() throws IllegalArgumentException{
        final String paramName = "Time_Window";
        try{
            int timeWindow = Integer.parseInt(params.get(paramName)) * 1000;
            if (timeWindow <= 0){
                throw new IllegalArgumentException("Must be a positive integer");
            }
            return timeWindow;
        }catch(Exception e){// NullPointer or Parsing
            throw new IllegalArgumentException("Corrupt parameter: " + paramName
                    + " in feature " + name, e);
        }
    }

//  public int getTimeWindow() throws IllegalArgumentException{
//      final String paramName = "Time_Window";
//      try{
//          int timeWindow = Integer.parseInt(params.get(paramName)) * 1000;
//          if (timeWindow <= 0){
//              throw new IllegalArgumentException("Must be a positive integer");
//          }
//          return timeWindow;
//      }catch(Exception e){// NullPointer or Parsing
//          throw new IllegalArgumentException("Corrupt parameter: " + paramName
//                  + " in feature " + name, e);
//      }
//  }

    public int getValueTimeout() throws IllegalArgumentException{
        final String paramName = "Value_Timeout";
        try{
            int valueTimeout = Integer.parseInt(params.get(paramName)) * 1000;
            if (valueTimeout <= 0){
                throw new IllegalArgumentException("Must be a positive integer");
            }
            return valueTimeout;
        }catch(Exception e){// NullPointer or Parsing
            throw new IllegalArgumentException("Corrupt parameter: " + paramName
                    + " in feature " + name, e);
        }
    }

    public double getMovieAverageWeight() throws IllegalArgumentException{
        final String paramName = "Moving_Average_Weight";
        try{
            double movingAverageWeight = Double.parseDouble(params.get(paramName));
            if (movingAverageWeight < 0 || movingAverageWeight > 1){
                throw new IllegalArgumentException("Must be positive and 1.0 at most");
            }
            return movingAverageWeight;
        }catch(Exception e){// NullPointer or Parsing
            throw new IllegalArgumentException("Corrupt parameter: " + paramName
                    + " in feature " + name, e);
        }
    }

    public boolean getIncludeEventTimes(){
        final String paramName = "Include_Event_Times";
        return Boolean.parseBoolean(params
            .get(paramName));
    }

    public boolean getIncludeMaximalEntity(){
        final String paramName = "Include_Maximal_Entity";
        return Boolean.parseBoolean(params
            .get(paramName));
    }
} 
```

**监控数据.java**

```
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Collection;
import java.util.Collections;
import java.util.Date;
import java.util.Map;
import java.util.Set;
import java.util.TreeMap;

import android.os.Bundle;
import android.os.Parcel;
import android.os.Parcelable;

@SuppressWarnings("unchecked")
public class MonitoredData implements Map, Parcelable{
    public static final int DEFAULT = 0;

    public static final int HAS_EXTRAS = 1;

    protected String _name;

    protected ParcelableDate _startTime, _endTime;

    protected Object _value;

    protected Bundle _extras;

    public static final Parcelable.Creator<MonitoredData> CREATOR = new Parcelable.Creator<MonitoredData>(){
        public MonitoredData createFromParcel(Parcel in){
            ClassLoader cl = ParcelableDate.class.getClassLoader();
            String name = in.readString();
            Object value = in.readValue(null);
            ParcelableDate startTime = (ParcelableDate)in.readParcelable(cl);
            ParcelableDate endTime = (ParcelableDate)in.readParcelable(cl);
            Bundle extras = in.readBundle();
            MonitoredData monitoredData = new MonitoredData(name, value, startTime,
                    endTime);
            if (extras != null){
                monitoredData.setExtras(extras);
            }
            return monitoredData;
        }

        public MonitoredData[] newArray(int size){
            return new MonitoredData[size];
        }
    };

    private static DateFormat _sdf = new SimpleDateFormat("dd/MM/yyyy hh:mm:ss");

    public MonitoredData(String name, Object value, Date endTime){
        this(name, value, new ParcelableDate(endTime), new ParcelableDate(endTime));
    }

    public MonitoredData(String name, Object value, ParcelableDate endTime){
        this(name, value, endTime, endTime);
    }

    public MonitoredData(String name, Object value, Date startTime, Date endTime){
        this(name, value, new ParcelableDate(startTime), new ParcelableDate(endTime));
    }

    public MonitoredData(String name, Object value, Date startTime, ParcelableDate endTime){
        this(name, value, new ParcelableDate(startTime), endTime);
    }

    public MonitoredData(String name, Object value, ParcelableDate startTime,
        ParcelableDate endTime){
        _name = name;
        _startTime = startTime;
        _endTime = endTime;
        _value = value;
        _extras = null;
    }

    public void setExtras(Bundle extras){
        _extras = extras;
    }

    public Map<String, Object> toMap(){
        TreeMap<String, Object> map = new TreeMap<String, Object>();
        map.put("Name", _name);
        map.put("StartTime", _startTime);
        map.put("EndTime", _endTime);
        map.put("Value", _value);
        return map;
    }

    public String conciseToString(){
        String extrasToString = (_extras != null && !_extras.isEmpty()) ? " - "
                + _extras.toString() : "";
        return "{" + getName() + " = " + getValue() + "}" + extrasToString;
    }

    public int describeContents(){
        return (_extras == null || _extras.isEmpty()) ? DEFAULT : HAS_EXTRAS;
    }

    public ParcelableDate getEndTime(){
        return _endTime;
    }

    public String getName(){
        return _name;
    }

    public ParcelableDate getStartTime(){
        return _startTime;
    }

    public Object getValue(){
        return _value;
    }

    public Bundle getExtras(){
        return _extras;
    }

    public String toString(){
        StringBuilder sb = new StringBuilder("{");
        sb.append("Name = " + getName() + ", ");
        sb.append("Value = " + getValue() + ", ");
        sb.append("StartTime = " + _sdf.format(getStartTime()) + ", ");
        sb.append("EndTime = " + _sdf.format(getEndTime()));
        sb.append("}");
        return sb.toString();
    }

    public void writeToParcel(Parcel dest, int flags){
        dest.writeString(getName());
        dest.writeValue(getValue());
        dest.writeParcelable(getStartTime(), 0);
        dest.writeParcelable(getEndTime(), 0);
        dest.writeBundle(_extras);
    }

    public void clear(){
        throw new UnsupportedOperationException();
    }

    public boolean containsKey(Object key){
        throw new UnsupportedOperationException();
    }

    public boolean containsValue(Object value){
        throw new UnsupportedOperationException();
    }

    public Set entrySet(){
        return Collections.unmodifiableSet(toMap().entrySet());
    }

    public Object get(Object key){
        throw new UnsupportedOperationException();
    }

    public boolean isEmpty(){
        throw new UnsupportedOperationException();
    }

    public Set keySet(){
        throw new UnsupportedOperationException();
    }

    public Object put(Object key, Object value){
        throw new UnsupportedOperationException();
    }

    public void putAll(Map arg0){
        throw new UnsupportedOperationException();
    }

    public Object remove(Object key){
        throw new UnsupportedOperationException();
    }

    public int size(){
        throw new UnsupportedOperationException();
    }

    public Collection values(){
        throw new UnsupportedOperationException();
    }

    /**
     * Returns the value of the monitored data as a Double. 
     * Null is returned if the value is null or is can not be converted to double.
     * 
     * @return The value as double if possible, null otherwise
     */
    public Double mdToDouble(){
        Double sample;
        Object val = getValue();
        if (val instanceof Double){
            sample = ((Double)val).doubleValue();
        }else if (val instanceof Long){
            sample = ((Long)val).doubleValue();
        }else if (val instanceof Integer){
            sample = ((Integer)val).doubleValue();
        }else{
            sample = null;
        }
        return sample;
    }
} 
```

**实用程序.java**

```
import java.io.BufferedReader;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.PrintWriter;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.Formatter;
import java.util.List;

import org.xmlpull.v1.XmlPullParser;
import org.xmlpull.v1.XmlPullParserException;
import org.xmlpull.v1.XmlPullParserFactory;

import android.content.Context;
import android.content.res.Resources;
import android.os.Environment;
import android.widget.Toast;

public class Utils{
    public static byte[] append(byte[] first, byte[] second){
        byte[] bytes;

        bytes = new byte[first.length + second.length];
        System.arraycopy(first, 0, bytes, 0, first.length);
        System.arraycopy(second, 0, bytes, first.length, second.length);

        return bytes;
    }

    public static int bytesToInt(byte[] bytes){
        return (bytes[3] & 0xFF) | ((bytes[2] & 0xFF) << 8) | ((bytes[1] & 0xFF) << 16)
                | ((bytes[0] & 0xFF) << 24);
    }

    public static int littleEndianBytesToInt(byte[] bytes){
        return (bytes[0] & 0xFF) | ((bytes[1] & 0xFF) << 8) | ((bytes[2] & 0xFF) << 16)
                | ((bytes[3] & 0xFF) << 24);
    }

    public static long littleEndianBytesToUShort(byte[] arr){
        return (arr[1] << 8) | arr[0];
    }

    public static void displayShortAlert(Context context, String message){
        Toast.makeText(context, message, Toast.LENGTH_SHORT).show();
    }

    public static XmlPullParser getXPP(Context context, int resourceId, boolean isBinary){
        XmlPullParser xpp;
        Resources resources = context.getResources();

        if (isBinary){
            return resources.getXml(resourceId);
        }else{
            try{
                XmlPullParserFactory factory = XmlPullParserFactory.newInstance();
                xpp = factory.newPullParser();
                xpp.setInput(resources.openRawResource(resourceId), null);
            }catch(XmlPullParserException e){
                xpp = null;
            }
            return xpp;
        }
    }

    public static byte[] intToBytes(int i){
        byte[] bytes = new byte[]{(byte)((i >> 24) & 0xff), (byte)((i >> 16) & 0xff),
                (byte)((i >> 8) & 0xff), (byte)((i) & 0xff)};
        return bytes;
    }

    /*
     * debugging
     */
    public static String printByteArray(byte[] bytes, int len){
        StringBuilder sb = new StringBuilder();
        sb.append("msg len: " + len + " :");
        Formatter f = new Formatter(sb);
        for (int i = 0; i < len; i++){
            f.format("%2x", bytes[i]);
        }
        sb.append("\n");
        return sb.toString();
    }

    public static List<Integer> getPids(String fileName){
        String line;
        int pidIndex = -1;

        try{
            Process p = Runtime.getRuntime().exec("ps " + fileName);
            p.waitFor();

            BufferedReader br = new BufferedReader(new InputStreamReader(p.getInputStream()), 256);
            if ((line = br.readLine()) == null){
                throw new IllegalStateException("Unable to read ps output");
            }
            String[] tokens = line.split(" +");
            for (int i = 0; i < tokens.length; ++i){
                if (tokens[i].equalsIgnoreCase("pid")){
                    pidIndex = i;
                }
            }
            if (pidIndex < 0){
                throw new IllegalStateException("Unable to locate pid field in ps output");
            }

            List<Integer> pids = new ArrayList<Integer>();
            while ((line = br.readLine()) != null){
                tokens = line.split(" +");
                assert tokens.length < 9;

                try{
                    pids.add(Integer.parseInt(tokens[pidIndex]));
                }catch(NumberFormatException e){
                    throw new IllegalStateException("Pid is not an integer");
                }
            }

            br.close();
            return pids;
        }catch(Exception e){
            throw new IllegalStateException("Unable to read running process through ps: "
                    + e.getMessage(), e);
        }

    }

    public static void killProcesses(List<Integer> pids){
        for (Integer pid : pids){
            android.os.Process.killProcess(pid);
        }
    }

    public static void killProcesses(String processName){
        killProcesses(getPids(processName));
    }

    public static void suKillProcesses(List<Integer> pids){
        StringBuilder cmd = new StringBuilder("kill");
        for (Integer pid : pids){
            cmd.append(" ").append(pid);
        }
        try{
            Runtime.getRuntime().exec(new String[]{"su", "-c", cmd.toString()});
        }catch(IOException e){
            e.printStackTrace();
        }
    }

    public static void suKillProcess(int pid){
        try{
            Runtime.getRuntime().exec(new String[]{"su", "-c", "kill " + pid});
        }catch(IOException e){
            e.printStackTrace();
        }
    }

    public static void suKillProcesses(String processName){
        suKillProcesses(getPids(processName));
    }

    public static double truncateDouble(double d){
        long l = Math.round(d * 100);
        return l / 100.0;
    }

    public static double calcMovingAvg(double oldVal, double newVal, double newValWeight){
        return (oldVal * (1.0 - newValWeight)) + (newValWeight * newVal);
    }

    public static double calcAvg(double oldAvg, int count, double newVal){
        return (oldAvg * count + newVal) / (count + 1);
    }

    public static void writeLogToFile(Context context, boolean onSdcard, String prefix, int timeWindowInSeconds) throws Exception{
        final SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd'T'HH-mm-ss");
        final DateFormat logDF = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.SSS");
        final long currentTime = System.currentTimeMillis();
        final long startTime = currentTime - timeWindowInSeconds * 1000;
        final String currentYear = Calendar.getInstance().get(Calendar.YEAR) + "-";
        final String logFileName = prefix + sdf.format(new Date(currentTime)) + ".log";
        BufferedReader logcatIn;
        Process logcat;
        OutputStream logFile;

        try{
            logcat = Runtime.getRuntime().exec("logcat -v time -d *:d");
            logcatIn = new BufferedReader(new InputStreamReader(logcat
                    .getInputStream()), 1024);
        }catch(IOException e){
            throw new Exception("Unable to launch logcat: " + e.getMessage(), e);
        }

        try{
            if (onSdcard){
                logFile = new FileOutputStream(new File(Environment.getExternalStorageDirectory(), logFileName));
            }else{
                logFile = context.openFileOutput(logFileName, 0);               
            }
        }catch(IOException e){
            throw new Exception("Unable to create log file: " + e.getMessage(), e);         
        }
        PrintWriter pw = new PrintWriter(logFile, false);

        String line;
        long logLineTime;
        while ((line = logcatIn.readLine()) != null){
            logLineTime = logDF.parse(currentYear + line.substring(0, line.indexOf(".") + 4)).getTime();
            if (logLineTime >= startTime){
                pw.println(line);
            }
        }

        pw.flush();
        pw.close();
        logcatIn.close();
        logcat.destroy();
    }
} 
```

**特征提取器.java**

```
import java.util.List;

/**
 * A class capable of extracting one or more features. It MUST have a public constructor
 * with the following parameters in this order:
 * <ul>
 * <li>Context context</li>
 * <li>Collection&lt;FeatureInfo&gt; featureInfos</li>
 * <li>Long timeStamp</li>
 * </ul>
 * 
 */
public interface FeatureExtractor{
    /**
     * Invoked during a data collection. It is up to the extractor to add the data
     * relevant to it's monitored features to the monitoredData list.
     * 
     * @param monitoredData The overall collected data (from all extractors) so far
     * @param endTime The time of the current data collection
     */
    public void collectData(List<MonitoredData> monitoredData, ParcelableDate endTime);

    /**
     * Invoked when the feature extractor is no longer needed. This is the place to
     * release any resources, unregister any listeners, close any threads, etc.
     */
    public void close();
} 
```

**FeatureExtractorInitException.java**

```
public class FeatureExtractorInitException extends RuntimeException{
    private static final long serialVersionUID = 1L;

    public FeatureExtractorInitException(String message){
        super(message);
    }

    public FeatureExtractorInitException(String message, Throwable t){
        super(message, t);
    }

    public FeatureExtractorInitException(Throwable t){
        super(t);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T19:49:11.173

例如，如果您有一个 imageView 获取坐标的一种方法是......

```
imageView.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View view) {
            int[] values = new int[2]; 
            view.getLocationOnScreen(values);
            Log.d("X & Y",values[0]+" "+values[1]);
        }
    }); 
```

查看这些 ST 线程：

*   [如何在android中的onTouchEvent（MotionEvent事件）中获取imageView](https://stackoverflow.com/questions/10251002/how-to-get-imageview-inside-ontoucheventmotionevent-event-in-android)
*   [Android：如何获取图像/ImageView 中的 xy 坐标？](https://stackoverflow.com/questions/8909835/android-how-do-i-get-the-x-y-coordinates-within-an-image-imageview)
*   [OnClickListener - 事件的 x,y 位置？](https://stackoverflow.com/questions/1967039/onclicklistener-x-y-location-of-event)
*   [使用 x,y 坐标查找布局](https://stackoverflow.com/questions/8329993/find-layout-with-x-y-coordinate)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T07:56:20.033

如果您使用 reuf 代码，则需要使用。我添加了在[这里](http://www.java2s.com/Open-Source/Android/Client/moloko/dev/drsoran/moloko/service/parcel/ParcelableDate.java.htm)`ParcelableData.java`找到的 ParcelableData 类，希望能节省您的时间：

```
package dev.drsoran.moloko.service.parcel;

import java.util.Date;

import android.os.Parcel;
import android.os.Parcelable;

public class ParcelableDate implements Parcelable
{

   public static final Parcelable.Creator< ParcelableDate > CREATOR = new Parcelable.Creator< ParcelableDate >()
   {

      public ParcelableDate createFromParcel( Parcel source )
      {
         return new ParcelableDate( source );
      }

      public ParcelableDate[] newArray( int size )
      {
         return new ParcelableDate[ size ];
      }

   };

   private final Date date;

   public ParcelableDate( final Date date )
   {
      this.date = date;
   }

   public ParcelableDate( long millis )
   {
      this.date = new Date( millis );
   }

   public ParcelableDate( Parcel source )
   {
      date = new Date( source.readLong() );
   }

   public Date getDate()
   {
      return date;
   }

   @Override
   public String toString()
   {
      return date.toString();
   }

   public int describeContents()
   {
      return 0;
   }

   public void writeToParcel( Parcel dest, int flags )
   {
      dest.writeLong( date.getTime() );
   }

} 
```

# android - 如何在按钮单击时打开布局（android）

> ID：10936042
> 
> 赞同：21
> 
> 时间：2012-06-07T16:35:57.667
> 
> 标签：android

当我单击 main.xml 文件中的按钮时，如何打开另一个布局 xml 文件？

因此，如果我有 main.xml 有一个按钮单击此处并单击它，它会打开 second.xml 文件（布局）。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-06-07T16:41:32.620

首先创建你的两个布局：

主要的.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#ffffff"  >

    <TextView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:textColor="#000000"
    android:text="This is Activity 1" />

       <Button android:text="Next"
        android:id="@+id/Button01"
        android:layout_width="250px"
            android:textSize="18px"
        android:layout_height="55px">
    </Button>    

</LinearLayout> 
```

第二个.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#ffffff"  >

    <TextView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:textColor="#000000"
    android:text="This is Activity 2" />

       <Button android:text="Previous"
        android:id="@+id/Button02"
        android:layout_width="250px"
            android:textSize="18px"
        android:layout_height="55px">
    </Button>    

</LinearLayout> 
```

其次将您的活动添加到清单文件

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="com.rr"
      android:versionCode="1"
      android:versionName="1.0">
    <application android:icon="@drawable/icon" android:label="@string/app_name">
        <activity android:name=".Activity1"
                  android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity android:name=".Activity2"></activity>
    </application>
    <uses-sdk android:minSdkVersion="3" />
</manifest> 
```

**Activity1.java**

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class Activity1 extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Button next = (Button) findViewById(R.id.Button01);
        next.setOnClickListener(new View.OnClickListener() {
            public void onClick(View view) {
                Intent myIntent = new Intent(view.getContext(), Activity2.class);
                startActivityForResult(myIntent, 0);
            }

        });
    }
} 
```

要切换到 Activity2，您必须：

1.  使用 获取对布局上 ID 为 Button01 的按钮的引用 `(Button) findViewById(R.id.Button01)`。

2.  为按钮创建一个 OnClick 侦听器。

3.  最重要的部分是创建一个“Intent”来启动另一个 Activity。Intent 需要两个参数：上下文和我们要启动的 Activity 的名称（Activity2.class）

**Activity2.java**

```
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;

public class Activity2 extends Activity {

    /** Called when the activity is first created. */
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.second);

        Button next = (Button) findViewById(R.id.Button02);
        next.setOnClickListener(new View.OnClickListener() {
            public void onClick(View view) {
                Intent intent = new Intent();
                setResult(RESULT_OK, intent);
                finish();
            }

        });
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-07T16:39:35.100

-Inflate the button from the xml
-add an onClickListener on it
-set a new layout in the onClick event

```
Button btn = (Button) findViewById(R.id.myButton);
btn.setOnClickListener(new OnClickListener(){

@Override
public void onClick(View v)
{
    MyActivity.setContentView(R.layout.newlayout);
}

}); 
```

Something like this should work...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-12-20T10:28:52.087

一种科特林方式：

- 直接在设计器中添加 onClick 事件。

1.  在设计器模式下打开活动（例如Activity1.xml）文件
2.  选择将触发转换的按钮
3.  在右侧面板的 onClick 框中添加函数名称以及所有按钮属性

- 打开 Activity .kt 文件

1.  使用您刚刚在设计器中定义的名称添加函数

    `fun openActivity2(view: View) { intent = Intent(view.context,Activity2::class.java) startActivity(intent) }`

现在您已将函数链接到按钮的 onClick 事件

# php - strftime() 突然停止工作。有什么见解吗？

> ID：10936043
> 
> 赞同：0
> 
> 时间：2012-06-07T16:35:59.340
> 
> 标签：php, date, format, strtotime, strftime

我有一个简单的脚本，它接受输入日期、格式化并将其存储在数据库中。我以下列方式使用 strftime 函数：

```
$pdate = strftime('Y-m-d', strtotime($_POST['post_date'])); 
```

出于某种原因，这突然开始返回“Ymd”。是的，它返回了我作为第一个参数传递的格式字符串！根本没有日期信息。我还尝试通过将直接的 unicode 时间戳作为第二个参数传递给它，但它仍然只返回格式字符串。直到几天前它工作正常。现在我已将其切换为使用 date() 函数：

```
$pdate = date('Y-m-d', strtotime($_POST['post_date'])); 
```

现在一切正常！我只是想知道是否有人知道为什么 strftime() 函数突然停止工作。这似乎真的很奇怪，它会困扰我一整天。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:41:11.090

Actually the question might be opposite :) I don't know how did it return correctly formated date, because generally it should be like this:

```
$pdate = strftime('%Y-%m-%d', strtotime($_POST['post_date'])); 
```

As it's described [here](http://www.php.net/manual/en/function.strftime.php) :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:41:33.877

您在 strftime 参数中使用了错误的日期格式。检查[strftime](http://php.net/manual/en/function.strftime.php)函数。它应该是这样的：

```
$pdate = strftime('%Y-%m-%d', strtotime($_POST['post_date'])); 
```

还有许多其他格式。

# java - 如何提高你不拥有的代码的性能？

> ID：10936045
> 
> 赞同：2
> 
> 时间：2012-06-07T16:36:06.843
> 
> 标签：java, linux, performance, jvm

我们在一个运行调度算法的可笑的大 Linux 机器上拥有一个内部的 3rd 方 java 应用程序。对于我们需要的负载，应用程序运行得太慢了。我们没有代码，供应商不会因为金钱原因对应用程序进行任何更改，因此我无法改进代码。该应用程序是单线程的，它的设计不适合并行化（所以我不能在 2 个盒子之间分配负载）。

在软件或硬件方面，我可以做些什么来提高应用程序的性能？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T16:43:08.453

*   获取最新版本的 Java（较新版本往往具有性能改进）

*   [给 Java 更多的内存来使用](https://stackoverflow.com/questions/2294268/how-can-i-increase-the-jvm-memory)（基准看看这是否有任何区别）

*   衡量它在做什么`top`。升级任何有问题的东西（更多内存、更快的 CPU、SSD）。一些 CPU 在单线程工作负载方面比其他 CPU 更好（阅读：不要在[Bulldozer](http://en.wikipedia.org/wiki/Bulldozer_%28microarchitecture%29)上运行它；带有[Turbo Boost](http://en.wikipedia.org/wiki/Intel_Turbo_Boost)的东西可能会有所帮助）。

*   使用其他[实验性 JVM 选项](http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html#PerformanceTuning)（基准测试看看这是否有任何区别）

*   删除在这台机器上运行的任何其他应用程序（基准测试看看是否有任何好处——如果没有帮助就浪费钱）

*   向供应商付款以使其更快或给您代码（即：给他们金钱上的理由来解决这个问题）

*   寻找替代方案

*   编写自己的替代方案

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:41:18.890

1) You can improve the hardware that the application runs on. Do this by looking at what resources the application is using. Is it maxing out CPU, or using all the memory (or both)? If so, you can add more CPU power or RAM accordingly.

2) Is there a way you can cache the results from the application? Can you ever avoid using it?

Otherwise, there really isn't much more you can do. If becomes a bigger problem, you might have to write your own scheduling algorithm, or better yet, find a better vendor.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T17:00:15.603

您可以预处理输入以减少应用程序要做的工作吗？

例如，也许应用程序做的第一件事是使用合并排序对要调度的作业列表进行排序。如果您预先对列表进行排序，则应用程序的排序将无事可做。您可能能够比应用程序更快地对列表进行排序 - 使用许多内核，提前完成，等等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-08T00:26:11.917

在速度更快的计算机上运行它。这可能是最便宜的解决方案。

# java - 在 Java 类中设置启动参数

> ID：10936046
> 
> 赞同：3
> 
> 时间：2012-06-07T16:36:06.983
> 
> 标签：java, class, arguments, launch

有没有办法让你可以**在**java类中设置内存使用参数，而不是使用eclipse或java程序编译器，只是你可以使用记事本或其他东西在类中执行的简单代码。如果你不明白我的意思，这里有一个例子：

```
public class Example {
   public Example() {
     -Xmx("1024M");
   }

   public static void main(String args[]) {
     new Example();
   }
} 
```

请帮忙，谢谢！注意：我不想制作一个 cmd/批处理文件来使用 -Xmx 运行它！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:34:29.950

内存无法在运行时更改（当 JRE 到达您的代码语句时，内存已设置且无法更改）。实现不同内存大小的唯一方法是重新启动应用程序。使用`Process`指定更大的内存（然后关闭原始应用程序。没有足够的内存）。

当然，最好在启动过程中简单地指定所需的内存（BAT 文件、[JWS](https://stackoverflow.com/tags/java-web-start/info)等）。

# linq - 在 SharePoint 2010 中由带有 SPMetal 的 LoginName (ID) 创建

> ID：10936053
> 
> 赞同：0
> 
> 时间：2012-06-07T16:36:48.363
> 
> 标签：linq, sharepoint-2010

我正在使用 SP2010 中的 OOB 博客站点。我正在使用 SPMetal 为 Posts 列表（以及其他）生成实体类。我使用了 parameters.xml 文件来获取我需要的其他默认情况下不包含的列。

我想做的一件事是获取用户的“我的网站”网址。我可以相对容易地使用 CAML 做到这一点。但是我需要使用 Linq 来完成。我不知道如何获取作者字段的登录 ID（即域\ID）。我查看了联系人内容类型，但似乎没有任何帮助。

有没有人遇到过这个问题或获得了 SPMetal 用户的登录 ID？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:38:43.583

如果您使用创建`Posts`列表实体[`SPMetel.exe`](http://msdn.microsoft.com/en-us/library/ee538587.aspx)并且如果在帖子列表中假设字段类型为用户，则自动返回两种方法，如 LookupId 和 LookupValue。

在我的情况下：我在我的实体`promoterid`中的列表中作为字段名称有两种方法`Posts`

```
 private System.Nullable<int> _promoterId;
    private string _promoter;
    [Microsoft.SharePoint.Linq.ColumnAttribute(Name="promoterid", Storage="_promoterId", FieldType="User", IsLookupId=true)]
    public System.Nullable<int> PromoterId {
    get {
        return this._promoterId;
    }
    set {
        if ((value != this._promoterId)) {
            this.OnPropertyChanging("PromoterId", this._promoterId);
            this._promoterId = value;
            this.OnPropertyChanged("PromoterId");
        }
    }
}

[Microsoft.SharePoint.Linq.ColumnAttribute(Name="promoterid", Storage="_promoter", ReadOnly=true, FieldType="User", IsLookupValue=true)]
public string Promoter {
    get {
        return this._promoter;
    }
    set {
        if ((value != this._promoter)) {
            this.OnPropertyChanging("Promoter", this._promoter);
            this._promoter = value;
            this.OnPropertyChanged("Promoter");
        }
    }
} 
```

比我可以使用 linq 查询之后

IE

```
 SPWeb oWebsiteRoot = SPContext.Current.Web;
     EntitiesDataContext objent = new EntitiesDataContext(oWebsiteRoot.Url);
     EntityList<PostsItem> evnitems = objent.GetList<PostsItem>("Posts");
     var i =  from item in evnitems
              where item.PromoterId == SPContext.Current.Web.CurrentUser.ID 
             select item; 
```

# wpf - 多列标题：将列标题一分为二

> ID：10936056
> 
> 赞同：1
> 
> 时间：2012-06-07T16:36:59.173
> 
> 标签：wpf

我需要在列表视图中显示一些数据。我在 Visual Studio 2008 中使用 wpf。我需要在 listviews gridview 列中显示“类型”及其“值”。但是“值”列标题被分成两部分。它应该显示![在此处输入图像描述](../Images/118b75d4d39f47e3f337e9537daf7f66.png)最小值和最大值。谁能帮我实现这一目标？

# php - 如何将数组中的项目转换为 PHP 中的逗号分隔字符串？

> ID：10936059
> 
> 赞同：67
> 
> 时间：2012-06-07T16:37:16.747
> 
> 标签：php, arrays

> **可能重复：**
> [如何在 PHP 中从数组中创建逗号分隔列表？](https://stackoverflow.com/questions/2435216/how-to-create-comma-separated-list-from-array-in-php)

给定这个数组：

```
$tags = array('tag1','tag2','tag3','tag4','...'); 
```

如何生成此字符串（使用 PHP）：

```
$tags = 'tag1, tag2, tag3, tag4, ...'; 
```

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2012-06-07T16:37:48.777

使用[内爆](http://php.net/implode)：

```
 $tags = implode(', ', array('tag1','tag2','tag3','tag4')); 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-06-07T16:57:44.197

是的，您可以使用[implode来做到这一点](http://uk.php.net/manual/en/function.implode.php)

```
$string = implode(', ', $tags); 
```

你知道，有一个*implode*的别名，叫做[join](http://uk.php.net/manual/en/function.join.php)

```
$string = join(', ', $tags); 
```

我倾向于使用 join 而不是 implode 因为它有一个*更好*的名称（一个更不言自明的名称：D）

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-06-07T16:38:37.440

在你的数组上使用 PHP 函数[Implode](http://php.net/manual/en/function.implode.php)

```
$mystring = implode(', ',$tags) 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-06-07T16:40:32.710

简单地内爆：

```
$tags = implode(", ", $tags); 
```

# gcc - 不太了解gcc，但我找不到它为什么不起作用

> ID：10936060
> 
> 赞同：1
> 
> 时间：2012-06-07T16:37:22.993
> 
> 标签：gcc

我正在尝试编译一个简单的“hello world”

文件名

```
#include <stdio.h>
void main () {
    printf ("Hello World\n");
} 
```

然后我尝试： gcc file_name 我得到“文件无法识别。文件格式无法识别”

然而，我 100% 确定几周前我做了完全相同的事情（只是想看看它是否像现在一样有效）并且它有效，所以我只是不明白。

```
gcc -ver // returns 4.6.1 if this helpes 
```

还有 gcc -o 应该如何工作？手册（man gcc）有时只是胡言乱语（对我来说）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:41:03.627

Let's say you program is saved as helloworld.c. Typing gcc -o myprog helloworld.c would compile helloworld.c into myprog. That way, when you want to run the program, all you type in the command line is ./myprog

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:42:32.790

gcc 尝试根据文件的扩展名猜测使用的语言（例如 C 或 C++），因此您需要确保您具有正确的文件扩展名（通常 .cpp 用于 C++ 和 .c 用于 C dource 文件）。或者，如果有明确说明格式的命令行选项（无论扩展名如何），请阅读手册。

至于“-o”命令行参数：该选项后指定的名称是从编译的源文件创建的目标文件的名称。然后将目标文件链接在一起以形成可执行文件

# android - 透明布局 - 在 Android 2.3 上不透明

> ID：10936067
> 
> 赞同：1
> 
> 时间：2012-06-07T16:37:32.443
> 
> 标签：android, layout

我有一个透明布局，用于在我的应用程序中放置横幅广告。布局始终位于我的游戏区域顶部，但广告仅偶尔出现一次。该代码的工作原理如下：

```
transparent_linearlayout_to_hold_banner.setBackgroundColor(Color.TRANSPARENT);   
game_frame_layout.addView(transparent_linearlayout_to_hold_banner);
setContentView(game_frame_layout); 
```

当我想要展示广告时，我会执行

```
transparent_linearlayout_to_hold_banner.addView(adView); 
```

当我希望广告消失时，我会执行

```
transparent_linearlayout_to_hold_banner.removeView(adView); 
```

这在我的 Galaxy S 上完美运行！使用 4.0.3，但在使用 2.3 的 Galaxy 标签上，我发现我的 transparent_linearlayout_to_hold_banner 会在添加出现后立即变黑，并且即使删除了广告，也会永远保持黑色。

知道发生了什么吗？...以及如何解决？

**编辑：**经过一些实验，我发现布局的颜色没有改变，但 alpha 通道是。我的猜测是，横幅广告系统的 SDK 可能正在调用某些函数以确保横幅本身不透明，然后（取决于操作系统版本）这会产生使其父布局的副作用不透明。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T15:16:45.877

尝试使您想要在 XML 中透明的布局，而不是动态的。我在动态添加的带有透明项目的 ListView 上遇到了这样的问题。

你在这里有一个游戏，所以我建议的当然可能行不通，或者很难做到，但是你可以使用 FrameLayout 来放置你绘制的布局，并将透明的布局放在它上面。另请注意，在这种情况下，触摸将转到广告布局。它可以被阻止，但有点像黑客（顺便说一下我做过一次）。

我不知道这是否可行，但请尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:12:41.947

在添加广告横幅之前尝试使布局不透明。

当您想删除广告时，请删除广告横幅视图并再次使布局透明。

您可以在删除广告后再次尝试添加此行吗？

```
transparent_linearlayout_to_hold_banner.setBackgroundColor(Color.TRANSPARENT); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-12T07:59:52.527

如果您使用的是 admob，请尝试最新的 6.0 库，它在控制广告外观方面有一些改进（如我所见），它似乎更加关注[最佳实践中描述的属性：指定广告颜色](https://developers.google.com/mobile-ads-sdk/docs/bestpractices#adcolors)。我以前版本的库有类似的问题。然而，它不允许 alpha 通道，因此您将无法指定广告的透明背景，但它可能会解决您的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-15T11:40:07.260

一些想法：

您可以简单地删除将背景设置为 lineraLayout 的行：

```
transparent_linearlayout_to_hold_banner.setBackgroundColor(Color.TRANSPARENT); 
```

?

另外，您可以切换线性布局（或 adView）的可见性，而不是删除和添加 adView 吗？

# web-applications - 创建本地 Web 应用程序

> ID：10936070
> 
> 赞同：2
> 
> 时间：2012-06-07T16:37:34.507
> 
> 标签：web-applications, relative-path

我的问题是：

我开发了一个 Web 应用程序（只有 html 和 javascript，它不需要任何服务器环境，例如 PHP 解释器）。我想让它类似于桌面应用程序，所以我下载了 Google Chrome 的便携式版本，并为本地文件创建了一个应用程序快捷方式。现在的问题是：快捷方式使用绝对路径，但我需要一个相对路径，以便应用程序可以在每个文件系统位置运行。

有人可以帮助我吗？有没有相对路径的解决方案？否则是否有其他解决方案代替 Chrome 应用程序快捷方式？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:58:51.380

我在微软论坛上找到了这个答案：

[http://answers.microsoft.com/en-us/windows/forum/windows_vista-files/how-to-create-a-shortcut-with-relative-path/3e1b0ede-1e18-4ecd-937b-66756d3409d3](http://answers.microsoft.com/en-us/windows/forum/windows_vista-files/how-to-create-a-shortcut-with-relative-path/3e1b0ede-1e18-4ecd-937b-66756d3409d3)

我认为这也应该适用于您的问题。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:04:59.117

检查问题：[将 Javascript 应用程序转换为 Windows 应用程序](https://stackoverflow.com/questions/6465820/convert-javascript-app-into-windows-app)

他们在那里讨论了多种解决方案。其中两个对我来说似乎值得尝试的东西是将您的主 html 文件重命名为 hta 或 Chromeless 应用程序。

# android - 我会在子菜单中选择

> ID：10936071
> 
> 赞同：0
> 
> 时间：2012-06-07T16:37:38.067
> 
> 标签：android

我想在一个变量中记录用户在子菜单中的选择，问题是永远不会调用 onOptionsMenuClosed 方法。

```
 public class BrowserXActivity extends Activity {

       public void onCreate(Bundle savedInstanceState) {
       super.onCreate(savedInstanceState); 
       setContentView(R.layout.main);
       }

public boolean onCreateOptionsMenu(Menu menu){
    SubMenu subMenu2 = menu.addSubMenu("Scelta Lingua");
    //subMenu2.setIcon(R.drawable.icon_manage);
    subMenu2.add(2, Menu.NONE, Menu.NONE, "Italiano");
    subMenu2.add(2, Menu.NONE, Menu.NONE, "Inglese");
    subMenu2.setGroupCheckable(2, true, true);
    return true;
}

public boolean onOptionsItemSelected(MenuItem item){
    if(item.isCheckable()){
        item.setChecked(false);
    }else{
            item.setChecked(true);
    }
    return true;
}

public void onOptionsMenuClosed(Menu menu){
    Log.i("A", "enter");

//  Log.i("A", "" + menu.getItem(0));
//  Log.i("A", "" + menu.getItem(1));

} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:51:44.423

您不需要`onOptionMenuClosed()`，只需检查选择了哪些项目
`public boolean onOptionsItemSelected(MenuItem item)`并将其记住在变量中，这应该可以。

# facebook - Facebook 认证推荐和代码

> ID：10936076
> 
> 赞同：0
> 
> 时间：2012-06-07T16:37:55.910
> 
> 标签：facebook, api, authentication, facebook-graph-api, oauth

我正在为 Facebook 使用 Naitik Shah PHP 库。我最近开始玩 Authenticated Referrals，但我真的非常困惑。我不完全确定如何同时使用这两个系统并且发现 Facebook 文档充其量是令人困惑的。

在我的 Facebook 设置中，我使用的是 Auth Token Parameter: Querystring，它返回一个代码。

*查询字符串：如果您的应用正在使用服务器端身份验证。如果您的应用是画布应用，我们将不使用此设置，并将自动使用“signed_request”作为响应类型。*

该应用程序不是画布应用程序，因此它正在发送代码。

*返回访问令牌或代码*

据我所知，这是整个 API 中唯一发送代码的地方。我不完全确定那个“代码”是什么，或者一旦我有了它该怎么办。我对整个 oauth 的事情都没有帮助感到困惑。**作为一名程序员并且在这件事上有点过分，有没有人只用一段 PHP 代码来举例说明如何处理这个请求代码来梳理出身份验证所需的信息？**

谢谢！

* * *

使用 Facebook 的新 PHP 库将自动使用来自 Authentication Referrals 的代码变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:48:50.763

我认为您正在寻找的是“什么是签名请求？”...

[https://developers.facebook.com/docs/authentication/signed_request/](https://developers.facebook.com/docs/authentication/signed_request/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:53:43.283

# mysql - MySQL 计数和排序增强查询

> ID：10936078
> 
> 赞同：0
> 
> 时间：2012-06-07T16:37:57.253
> 
> 标签：mysql

我正在使用以下查询，但我一生无法找出按最大计数排序的正确语法，并且只包括 5 或更高的计数。基本上我只想显示在 COUNT 中有 5 个或更多办公室的结果，然后先按数量最多的办公室排序？

```
SELECT COUNT(Offices) FROM Active GROUP BY Offices 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:40:39.170

```
SELECT COUNT(Offices) AS c FROM Active GROUP BY Offices HAVING COUNT(Offices) >= 5  ORDER BY c DESC 
```

# javascript - 如果可能的话，我需要帮助理解这个 jQuery 过滤器函数是如何工作的，逐行

> ID：10936079
> 
> 赞同：0
> 
> 时间：2012-06-07T16:38:02.450
> 
> 标签：javascript, jquery, html, function, filter

这是HTML：

```
<div>
    <h3>text</h3>
</div>
<div>
    <h3>moretext</h3>
</div>
<div>
    <h3>123</h3>
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

这是JS：

```
var rv1_wlength = $("div").filter(function() {
    return $(this).find("h3").filter(function () {
        return $(this).text() != "123";
    }).length;
});

var rv1_wolength = $("div").filter(function() {
    return $(this).find("h3").filter(function () {
        return $(this).text() != "123";
    });
});

var rv2 = $("div").find("h3").filter(function() {
    return $(this).text() != "123";
});

alert(rv1_wlength.text());   // text
                             // moretext

alert(rv1_wolength.text());  // text
                             // moretext
                             // 123

alert(rv2.text());​           // textmoretext 
```

我不明白为什么前两种方法在每一行打印元素，而第二种方法将它们连接起来。`rv2`是一个 jQuery 对象。那么，前两个（`rv1_wlength`和`rv1_wolength`）是什么？

此外，我不明白为什么包含长度属性会在过滤元素时产生所有差异。第二种方法什么都不做，因为它返回所有元素。第一种方法，唯一的改变是增加了长度属性，正确地过滤了元素。我非常想要逐行解释。

我真诚地感谢任何反馈。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:41:53.430

此代码获取所有 div 元素，其中**至少包含一个** `h3`文本不是`"123"`.

```
var rv1_wlength = $("div").filter(function() {
    return $(this).find("h3").filter(function () {
        return $(this).text() != "123";
    }).length;
}); 
```

* * *

这段代码没用：

```
var rv1_wolength = $("div").filter(function() {
    return $(this).find("h3").filter(function () {
        return $(this).text() != "123";
    });
}); 
```

这将返回原始选择，`$('div')`因为回调函数总是返回一个真实的值（一个空的 jQuery 集仍然被认为是真实的）。

* * *

最后，这段代码获取所有文本不是的 h3 元素`"123"`：

```
var rv2 = $("div").find("h3").filter(function() {
    return $(this).text() != "123";
}); 
```

* * *

当您调用 时`.text()`，jquery 会连接选择中所有元素的文本。在第一种情况下，这是连接 div 内的文本，其中包含换行符。在第二个中，它连接了 h3s 中没有的文本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:43:00.667

在元素*外*`<h3>`但在元素内有带有换行符的文本节点`<div>`。换行符会在由`alert()`. 当您刚刚获取`<h3>`内容时，没有换行符。

# shell - 如何使用字符串作为分隔符 shell 脚本

> ID：10936080
> 
> 赞同：0
> 
> 时间：2012-06-07T16:38:07.077
> 
> 标签：shell, cut

我正在阅读一行并使用正则表达式在我的脚本中匹配它。(/bin/bash)

```
echo $line | grep -E '[Ss][Uu][Bb][Jj][Ee][Cc][Tt]: [Hh][Ee][Ll][Pp]' > /dev/null 2>&1
if [[ $? = "0" && -z $subject ]]; then
    subject=`echo $line | cut -d: -f2` > /dev/null
    echo "Was able to grab a SUBJECT $line and the actual subject is -> $subject" >> $logfile

fi 
```

现在我的问题是我使用冒号作为分隔符。但有时电子邮件的主题中会有多个冒号，因此我无法抓住整个主题。我正在寻找一种在冒号后面的主题之后获取所有内容的方法。甚至有一种方法可以循环并检查冒号或什么。也许 cut 允许您使用字符串作为分隔符进行剪切？不确定……有什么想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T19:08:09.580

您已经 Q 评论的建议的其他替代方案是：

```
cut -d\:  -f2- 
```

-f2 表示后面的破折号包括所有其余字段。您的基于 shell 的解决方案也将比运行“剪切”过程更快。

我可能还建议您双引号 echo 的 arg（和 ${line#*:}，以避免在 $line 中的单词之间丢失多个/非空格空格，如果您关心打印它/传递它，因为它是对行上的字符没有任何影响。

grep 还具有 -i 标志，可避免您为每个字母编写 [lower-upper]，并使其更具可读性。如果您不想要 grep 的输出，而不是将其重定向到 /dev/null，您可以使用 -q 标志，这意味着不输出它 - 只需以 ok/not 状态码退出，以便您检查它。如果您正在处理多条线路并想在发现的第一条线路上退出，您也可以使用另一个标志来执行此操作。

# javascript - 为什么在Javascript中从数组中拼接对象不返回数组？

> ID：10936085
> 
> 赞同：3
> 
> 时间：2012-06-07T16:38:20.730
> 
> 标签：javascript, arrays

我有一系列对象（例如，一副纸牌）：

```
var deck = [];
deck.push(new Card(suit, rank)); 
```

以下似乎有效：

```
var card = deck.pop();
var card = deck.shift(); 
```

（分别从甲板的“顶部”或“底部”拉出）

但是如果我想要一张中间的牌（比如说，如果这是一手牌）

```
var card = deck.splice(2,1); 
```

该对象似乎没有正确分配给变量（一切都未定义）。我查找的所有内容都表明 splice 应该返回我正在移除的对象 - 我错过了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-07T16:41:34.257

尝试

```
var card = deck.splice(2,1)[0]; 
```

由于 splice 返回已删除元素的**数组...**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:41:46.950

[splice](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice)返回一个可能被移除元素的数组，所以如果你只移除一个元素，你仍然有一个数组。所以：

```
var card = deck.splice(2, 1)[0]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:42:00.537

[splice](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice)应该返回一个包含您删除的元素的数组。实际元素可以像这样获得：

```
var card = deck.splice(2,1)[0]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T16:42:10.217

[与此处](https://stackoverflow.com/a/10719185/1048572)相同的错误（即使是非常相似的环境:-)：[`.splice()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/splice)返回已删除元素的*数组*，而不是单个元素。因此，您需要获取该数组的第一个元素：

```
var card = deck.splice(2,1)[0]; 
```

# python - 无法杀死/隐藏 CMD 控制台窗口

> ID：10936092
> 
> 赞同：1
> 
> 时间：2012-06-07T16:38:41.973
> 
> 标签：python, cmd

> **可能重复：**
> [如何避免带有包含 os.system 调用的 .pyw 文件的控制台窗口？](https://stackoverflow.com/questions/1765078/how-to-avoid-console-window-with-pyw-file-containing-os-system-call)

给定这样一段 Python 代码：

```
import os
os.system('set') 
```

尽管我将文件保存为`.pyw`! 任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:13:30.927

这是*因为*您正在从一个窗口运行 Python，您会得到一个弹出控制台窗口。控制台程序只能从控制台运行，如果程序环境还没有包含一个 Windows 将有助于创建它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T17:14:17.883

os.system 确实会按设计打开命令窗口。subprocess模块应该让你在不打开窗口的情况下做一些事情 [。](http://docs.python.org/library/subprocess.html)

此外，对于某些命令（例如复制、删除），您可以使用不会打开命令窗口并具有更多跨操作系统优势的专用操作系统命令。

# c# - C# 中的 MySQL 铸造

> ID：10936096
> 
> 赞同：0
> 
> 时间：2012-06-07T16:38:55.397
> 
> 标签：c#, mysql, casting, odbc, datareader

好的，所以我正在尝试以逗号分隔的文件打印出表格的内容。

```
using (OdbcCommand com = new OdbcCommand("SELECT * FROM pie_data WHERE Pie_ID = ?", con)) {
    com.Parameters.AddWithValue("", Request.Form["pie_id"]);
    com.ExecuteNonQuery();
    using (OdbcDataReader reader = com.ExecuteReader()) {
        string finalstring = "";
        while (reader.Read()) {
            finalstring = reader.GetString(9) + ",";
            for (int i = 0; i <= 8; i = i + 1) {
                finalstring = finalstring + reader.GetString(i) + ",";
            }
        }
    }
    Response.Write(finalstring);
    noredirect = 1;
} 
```

我的表格布局是：

```
CREATE TABLE `rent_data` (
`Pies` INT(10) UNSIGNED NOT NULL,
`Name` VARCHAR(85) NOT NULL,
`Email` VARCHAR(85) NOT NULL,
`Pie_Rent` DATE NOT NULL,
`Rent_To` DATE NOT NULL,
`Returned_Date` DATE NULL DEFAULT NULL,
`Place` VARCHAR(100) NOT NULL,
`Purpose` MEDIUMTEXT NOT NULL,
`Comments` MEDIUMTEXT NULL,
`Pie_ID` SMALLINT(5) UNSIGNED ZEROFILL NOT NULL,
INDEX `Pie_ID` (`Equipment_ID`)
) 
```

我得到的错误是：

```
Exception Details: System.InvalidCastException: Unable to cast object of type 'System.Int64' to type 'System.String'. 
```

在线上：

```
finalstring = finalstring + reader.GetString(i) + ","; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:43:26.247

[正如这里](http://msdn.microsoft.com/en-us/library/system.data.odbc.odbcdatareader.getstring.aspx)所说，转换由 ODBC 驱动程序完成，如果不支持，GetString 不会转换为字符串。由于您有非字符串列，因此您将面临此问题。

[使用GetValue](http://msdn.microsoft.com/en-us/library/system.data.odbc.odbcdatareader.getvalue)代替 GetString，然后使用 ToString() 转换为字符串：

```
finalstring += reader.GetValue(i).ToString() + ","; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:41:38.467

可能您正在使用`GetString()`获取 Int64。您应该`.GetInt64`改为使用该特定值

您还应该`IsDBNull`在调用此方法之前调用以查找空值。

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader_methods](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader_methods)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:43:11.340

`GetString`尝试将列值转换为字符串。这不适用于非文字列，并且您显然将它们放在表中（`Pies`是 type `long`，`Pie_Rent`is a `DateTime`）等。您必须使用其他方法来提取数据，例如：

```
 finalstring = finalstring + reader[i].ToString() + ","; 
```

# opencv - OpenCV中的矩阵乘法

> ID：10936099
> 
> 赞同：41
> 
> 时间：2012-06-07T16:39:11.357
> 
> 标签：opencv

我在 OpenCV 中有两个 Mat 图像：

```
Mat ft = Mat::zeros(src.rows,src.cols,CV_32FC1);
Mat h = Mat::zeros(src.rows,src.cols,CV_32FC1); 
```

两个图像的尺寸相同，并且是从单个源图像计算而来的。

我想将这两个图像相乘，但尝试同时使用这两个图像

```
Mat multiply1 = h*ft;

Mat multiply2;
gemm(h,ft,1,NULL,0,multiply2); 
```

但两者都导致以下断言失败：

> OpenCV 错误：未知函数中的断言失败（a_size.width == len），文件 ...matmul.cpp 抛出“cv::exception”后调用终止

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：125
> 
> 时间：2012-06-08T12:34:10.140

你说矩阵是相同的维度，但你正试图对它们执行矩阵乘法。只有当它们是正方形时，具有相同维度的矩阵才能相乘。在您的情况下，您会收到断言错误，因为尺寸不是方形的。矩阵相乘时必须小心，因为相乘有两种可能的含义。

**[矩阵乘法](http://en.wikipedia.org/wiki/Matrix_multiplication#Matrix_product_.28two_matrices.29)**是两个矩阵直接相乘的地方。此操作将大小为 [axb​​] 的矩阵 A 与大小为 [bxc] 的矩阵 B 相乘，以生成大小为 [axc] 的矩阵 C。在 OpenCV 中，它是使用简单的`*`运算符实现的：

```
C = A * B 
```

**[逐元素乘法](http://docs.opencv.org/3.2.0/d3/d63/classcv_1_1Mat.html#a385c09827713dc3e6d713bfad8460706)**是输出矩阵中的每个像素由矩阵 A 中的像素乘以矩阵 B 中的相应条目形成的。输入矩阵的大小应该相同，输出的大小也应该相同。这是使用以下`mul()`功能实现的：

```
output = A.mul(B); 
```

# java - GMF - programmatically create connections without commands

> ID：10936100
> 
> 赞同：1
> 
> 时间：2012-06-07T16:39:12.463
> 
> 标签：java, eclipse, editor, connection

Hi I am developing an graphical editor with GMF and want to create a set of nodes (Resources in my project) and connections between them upon initialization of a new diagram. I do not want to use commands here because without the code is much slimmer, easier to read and also faster it seems to me.

There is no problem creating nodes by calling my `XXXFactory.eInstance.createResource()` and adding them to the diagram model. My connection is contained as `source-/targetConnections` feature in the resource class. So I added a similarly created connection as source/target to the resources. But it will not show up in the diagram even though it exists in the ResourceImpl structural feature. Maybe I need to add it additionally to the diagram but since it's contained by a feature contained by the diagram, I don't know how.

Am I doing something wrong or missing something or is it just not possible to do this without commands? Any help would be much appreciated. Sample code is below. The output of it is the two nodes but no connection.

Thanks Lars

Example createInitialModel method:

> private static RDFEditor.ShapesDiagram createInitialModel() {
> 
> ```
>  ShapesDiagram diagram = >RDFEditor.RDFEditorFactory.eINSTANCE.createShapesDiagram();
>   RDFEditor.Resource res = RDFEditorFactory.eINSTANCE.createResource();
>   RDFEditor.Resource res2 = RDFEditorFactory.eINSTANCE.createResource();
>   Connection con = RDFEditorFactory.eINSTANCE.createConnection();
> 
>   EStructuralFeature target = >res.eClass().getEStructuralFeature("targetConnections");
>   EStructuralFeature source = >res.eClass().getEStructuralFeature("sourceConnections");
> 
>   res2.setName("rdfs:Resource");
>   res.setName("rdfs:Class");
>   con.setName("rdfs:type");
> 
>   con.setSource(res);
>   con.setTarget(res2);
> 
>   res.getSourceConnections().add(con);
>   res.getTargetConnections().add(con);    
> 
>   //res2.eSet(target, con);   
>   //res.eSet(source, con);
> 
>   List<? extends Shape> resList = Arrays.asList(res,res2);
> 
>   EStructuralFeature shapes = >diagram.eClass().getEStructuralFeature("shapes");
>   diagram.eSet(shapes, resList);
> 
>   return diagram; 
> ```
> 
> }

# java - Why == operator is not working here, but equals work in java

> ID：10936107
> 
> 赞同：2
> 
> 时间：2012-06-07T16:39:48.483
> 
> 标签：java, string, equals, palindrome

I have written the code to check whether the given string is palindrome or not. But here I didn't create any String object explicitly. When we don't create explicitly, "==" also should work to compare the strings. But here I am not getting correct output if I use ==. For the clarity in my question, I have given another code also below

Code 1:Here. "==" is not working.

```
class Palindrome 
{
    public static void main(String[] args) 
    {

        StringBuffer sb1=new StringBuffer();
        sb1.append("anna");
        String s1=sb1.toString();
        StringBuffer sb2=new StringBuffer();
        sb2=sb1.reverse();
        String s2=sb2.toString();
        if(s1.equals(s2))
        {
            System.out.println("The given String is a Palindrome");
        }
        else

            System.out.println("Not a Palindrome");

    }
} 
```

Code 2: Here == works

```
class Stringdemo 
{
    public static void main(String[] args) 
    {
        String str1="hello";
        String str2="hello";
        if(str1==str2)
        {
            System.out.println("both strings are same");
        }
        else
        {
            System.out.println("both strings are not Same");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T16:42:23.830

使用 StringBuilder/Buffer.toString() 将创建一个新实例，因此为什么 equals() 有效，但 == 无效。在使用字符串文字的情况下，任何作为字符串文字的字符串都将被添加到类的常量池中，因此 string1 和 string2 将仅指向常量池中“hello”的相同引用，ergo ==说真的，因为它们是相同的参考。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-07T16:41:55.920

"==" 比较对象引用值，其中 "equals()" 比较对象内容。"==" 仅对比较原语非常有用。

当您调用“sb2.toString()”时，它会创建一个具有新参考值的新对象。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-07T16:41:44.193

`sb2.toString();`创建一个新的字符串。== 在这里不起作用

`sb2.toString().intern()`但是，如果您改用它，它将起作用

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-07T16:56:02.917

== 检查对象身份是否相等（即，相同的内存地址）。

.equals() 检查值是否相等。

当您创建一个新的字符串文字时：

```
 String str1="hello";
 String str2="hello"; 
```

Java 调用 String.intern() 方法来实习新的 String，但首先会检查相同的 String 值是否已经存在，如果存在，它将返回该值（即，不会创建新实例）。有关详细信息，请参阅 String.intern() 上的 Javadoc 注释：

> 当调用 intern 方法时，如果池中已经包含一个等于该 String 对象的字符串，由 equals(Object) 方法确定，则返回池中的字符串。否则，将此 String 对象添加到池中并返回对该 String 对象的引用。

这就是第二个示例有效的原因，但 StringBuilder 示例却没有，因为调用 sb2.toString 创建了一个新实例，绕过了 intern()。

为了安全起见，最好对任何非原始对象使用 .equals() 。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-07T16:42:38.233

`==`运算符仅检查`object's`引用，同时分别`equals()`比较`strings`其字符。

由于`String`是**不可变**对象，因此如果它已在内存中创建，则它共享对象的引用。

所以，

```
String str1 = "hello"; //and
String str2 = "hello"; //are equal 
```

因为两者`str1`和`str2`共享相同的引用`"hello"`。

# c - Version Control as Text File?

> ID：10936109
> 
> 赞同：0
> 
> 时间：2012-06-07T16:39:51.573
> 
> 标签：c, eclipse, version-control

I am using eclipse and would like to integrate some sort of version control. Ideally, I do not want to use a plugin. I would really like to somehow write the version to a text file in some way.

The reason I would like to do this is because I have a program that needs to track the current version of the workspace. Right now I am manually creating a text file in the workspace folder called "Version.XXXX" and just reading the name of the file to get the version number. However, I would like to somehow have eclipse do this automatically in case I forget to make the text file manually.

Any help or suggestions is greatly appreciated. Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T21:05:21.157

如果你想要一个简单的源代码版本控制系统，我建议你使用 Mercurial。所有版本控制信息都存储在项目的根文件夹中的一个`.hg`文件夹中。没有服务器和登录。与 SVN 和 Git 一样，它具有来自 Tortoise 的 gui 支持和适用于您的 IDE 的插件。其背后的逻辑和命令与其他解决方案类似。

# svn - 解决 Subversion 错误 E235000 - 无法再更新

> ID：10936111
> 
> 赞同：3
> 
> 时间：2012-06-07T16:39:55.343
> 
> 标签：svn, version

我正在使用最新版本的 Subversion (SVN v1.7.5)，突然之间，我无法再更新。当我尝试更新时，我得到：

E235000：第 1538 行的断言失败

这使我无法更新现有的工作副本。有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T16:46:25.950

节点处理中存在一个错误，其中某些条件被错误地标记为无效。

你最好的选择是从头开始重建 SVN。从 Apache.org 下载源代码并对源代码进行以下更改：

```
$ diff -u update_editor.orig update_editor.c 
--- update_editor.orig 2012-04-26 13:02:08.000000000 +0900
+++ update_editor.c  2012-05-30 02:27:24.000000000 +0900
@@ -1578,9 +1578,8 @@
     /* When the node existed before (it was locally deleted, replaced or
      * edited), then 'update' cannot add it "again". So it can only send
      * _action_edit, _delete or _replace. */
-    SVN_ERR_ASSERT(action == svn_wc_conflict_action_edit
-                   || action == svn_wc_conflict_action_delete
-                   || action == svn_wc_conflict_action_replace);
+    ;
+
   else if (reason == svn_wc_conflict_reason_added)
     /* When the node did not exist before (it was locally added), then 'update'
      * cannot want to modify it in any way. It can only send _action_add. */ 
```

最后，您可以使用以下命令仅构建客户端（而不是服务器）：

```
./configure \
--without-berkeley-db \
--without-apache \
--without-apxs \
--without-swig \
--with-ssl

make

make install 
```

您最好使用**src2pkg**或**checkinstall**之类的工具来代替“make install”命令，以便以后轻松卸载它。这个补丁并不理想，但它可以完成工作。

**资料来源：**

*   SVN 来源： [http ://subversion.apache.org/](http://subversion.apache.org/)

*   仅从源代码构建 SVN 客户端，无需服务器组件： [http](http://www.tek-tips.com/viewthread.cfm?qid=1249332) ://www.tek-tips.com/viewthread.cfm?qid=1249332 ：

*   修复 SVN 1.7.5 [http://dqn.sakusakutto.jp/2012/05/svn_E235000_In_file_subversion_libsvn_wc_update_editor.c_line_1583%20.html中的问题的补丁](http://dqn.sakusakutto.jp/2012/05/svn_E235000_In_file_subversion_libsvn_wc_update_editor.c_line_1583%20.html)

# mysql - MySQL优化组合3表和搜索

> ID：10936113
> 
> 赞同：0
> 
> 时间：2012-06-07T16:40:03.507
> 
> 标签：mysql

谁能告诉我这个 MySQL 查询有什么问题？

```
select distinct(a.productId)
  from product a
  left join product_keyword b
    on b.productId = a.productId
  left join keywords c
    on c.keywordId = b.keywordId
  where a.productName LIKE '%truck%' OR c.value LIKE '%truck%'
  limit 100; 
```

实际上我需要加入 3 个表（`product`和`product_keyword`）`keywords`并根据用户输入进行搜索。一个产品可以是多个关键字，我将其存储（`keywordId`来自`table`关键字`product_keyword`）。

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:27:51.237

当您`%`在 LIKE 搜索的前缀中使用通配符时，MySQL 无法使用任何索引进行搜索。相反，MySQL 必须扫描所有行。

您至少应该在连接列（productID 和keywordID）上有索引，以便 MySQL 能够更快地执行连接操作。但是，如果结果集太大，MySQL 也会对 JOIN 执行扫描。

最有可能的是，MySQL 正在扫描 product 中的每一行，然后对 product_keyword 执行 JOIN，然后对关键字执行 join。然后，它检查是否可以根据 WHERE 子句排除该行。一旦它返回 100 行，它就会停止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:35:03.740

如果您的表很大，这将是一个非常昂贵的查询。在 LIKE 查询上使用前导通配符通常会很慢。如果您需要这种搜索功能，最好在外部在 Lucene 或类似的东西中进行，而不是在数据库中进行。

# ios - Google Delegates on Calendar Framework / EventKit

> ID：10936115
> 
> 赞同：25
> 
> 时间：2012-06-07T16:40:12.993
> 
> 标签：ios, cocoa-touch, eventkit

I have always run with the assumption that Google delegates can be viewed by iCal and the calendar.app, but are not visible to us developers through the calendar framework, or EventKit.

Has this changed?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-04T12:58:54.633

我也有问题。日历显示两次。取消选择代表。过了一会儿，一切都消失了。

显然它是谷歌方面的一个问题。他们声称正在“努力”[检查讨论](http://productforums.google.com/forum/#!topic/calendar/AWJSWllOt9Y/discussion)

我在另一个苹果论坛页面上找到了谷歌主题，专门讨论同样的问题：[这里](https://discussions.apple.com/thread/4512975?start=0&tstart=0)

# python - 使用 unicode 字符解码 JSON 数组

> ID：10936116
> 
> 赞同：2
> 
> 时间：2012-06-07T16:40:21.257
> 
> 标签：python, objective-c, ios, json, cocoa-touch

我有以下 JSON 数组：

```
[u'steve@gmail.com'] 
```

“u”显然是 unicode 字符，它是由 Python 自动创建的。现在，我想把它带回Objective-C并使用它解码成一个数组：

```
+(NSMutableArray*)arrayFromJSON:(NSString*)json
{
    if(!json) return nil;
    NSData *jsonData = [json dataUsingEncoding:NSUTF8StringEncoding];
   //I've also tried NSUnicodeStringEncoding here, same thing
    NSError *e;
    NSMutableArray *result= [NSJSONSerialization JSONObjectWithData:jsonData options:NSJSONReadingMutableContainers error:&e];
    if (e != nil) {
        NSLog(@"Error:%@", e.description);
        return nil;
    }
    return result;
} 
```

但是，我收到一个错误：`(Cocoa error 3840.)" (Invalid value around character 1.)`

我该如何补救？

编辑：这是我将实体从 Python 带回 Objective-c 的方法：

首先，我将实体转换为字典：

```
def to_dict(self):
    return dict((p, unicode(getattr(self, p))) for p in self.properties()
                if getattr(self, p) is not None) 
```

我将此字典添加到列表中，将我的 responseDict['entityList'] 的值设置为此列表，然后`self.response.out.write(json.dumps(responseDict))`

但是我回来的结果仍然有那个'u'字符。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T16:48:18.563

[u'steve@gmail.com'] 是数组的解码 python 值，它不是有效的 JSON。

有效的 JSON 字符串数据只是`["steve@gmail.com"]`.

通过执行以下操作将 python 中的数据转储回 JSON 字符串：

```
import json
python_data = [u'steve@gmail.com']
json_string = json.dumps(data) 
```

python 字符串文字上的`u`前缀表示这些字符串是 unicode，而不是 python2.X (ASCII) 中的默认编码。

# c++ - Requirements for using a struct as an STL map key?

> ID：10936120
> 
> 赞同：2
> 
> 时间：2012-06-07T16:40:43.207
> 
> 标签：c++, stl, map

I'm using an STL map with a `struct` for a key. This is the definition of the map: `std::map<Coord2<uint8_t>, MapTile> tile_;`

The definition of the `struct`:

```
template <typename T>
struct Coord2
{
    T x;
    T y;

    bool operator<(const Coord2<T> &coord) const { return (x < coord.x || y < coord.y); }
    bool operator>(const Coord2<T> &coord) const { return (x > coord.x || y > coord.y); }
} 
```

Will I experience issues with the map because the comparison?

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-07T16:42:55.640

这`operator<`不适合与 C++ 标准库的关联容器一起使用。

比较器必须提供[严格的弱排序](http://www.sgi.com/tech/stl/StrictWeakOrdering.html)，而您的则没有。考虑以下证明其不一致的操作数：

```
a = { x = 1, y = 0 }
b = { x = 0, y = 1 } 
```

给定这些输入`a < b == true`和`b < a == true`，但是`b != a`。

这种类型的正确比较可能是：

```
if (x < coord.x)
    return true;

if (coord.x < x)
    return false;

return y < coord.y; 
```

（当然可以以更紧凑的方式编写这个正确的代码，但是我已经调试了由错误实现的严格弱排序引起的足够多的错误，我强烈建议在比较中非常明确，以便清楚它是正确的. 通过这个实现，很明显，我们只`y`在值比较相等时才比较值`x`，这就是我们想要的。）

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-07T16:54:09.250

对于两个值，James 的答案是理想的，对于更多的成员，它会变得复杂，因此对多个值实现严格的弱排序的一种简单方法是创建这些值的元组并比较元组：

```
 return boost::tie(x, y, z) < boost::tie(coord.x, coord.y, coord.z); 
```

为此，您需要做的就是让每个成员成为 LessThanComparable，然后在每个表达式`#include <boost/tuple/tuple_comparison.hpp>`中以相同的顺序列出成员。`tie`

在 C++11 中，您可以改为`#include <tuple>`使用`std::tie`。

元组比较被定义为进行字典比较，因此比较第一个元素，如果结果为真，则比较完成并返回真，否则对于每对元素以相同的方式比较下一个元素。只要每个元素类型都有正确定义的`operator<`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-07T16:53:14.153

先说一句：你不需要`operator>`，因为无论如何`std::map`只会使用。`operator<`

但是，您`operator<`不适合密钥，因为它没有定义严格的弱排序*。*`std::map`事实上，它甚至没有实现严格的偏序，因为它违反了传递性和反对称：考虑以下定义：

```
coord p = { 2, 2 };
coord q = { 0, 4 };
coord r = { 1, 1 }; 
```

也不`p < q`返回`true`因为`2 < 4`，`q < r`返回`true`因为`0 < 1`，但是`p < r`返回`false`。因此违反了传递性。

此外，不仅`p < q`返回 true，而且`q < p`，因为`0 < 2`. 换句话说，根据您的运营商的说法，每个`p`和`q`都将被认为比另一个小。

# android - Is my application extension going to be created before my services in android?

> ID：10936122
> 
> 赞同：1
> 
> 时间：2012-06-07T16:40:57.127
> 
> 标签：android, android-lifecycle

I have the following items defined in my android application manifest

1 Application extension 3 Services 5 Activities

Is it guaranteed that the onCreate of my Application class complete before the services are started? I have specific logic that needs to occur before the three services are started to properly initialize the application state.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:48:01.507

That's at least how I understand the documentation:

`public void onCreate()`

"*Called when the application is starting, before any other application objects have been created. Implementations should be as quick as possible (for example using lazy initialization of state) since the time spent in this function directly impacts the performance of starting the first activity, service, or receiver in a process.*"

[http://developer.android.com/reference/android/app/Application.html#onCreate%28%29](http://developer.android.com/reference/android/app/Application.html#onCreate%28%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:48:27.847

Common sense suggests that it is. It's not explicitly documented IIRC. However, `Service.getApplication()` is not documented as capable of returning null, so I'd say - code as if it is.

Application init and service init both happen on the same UI thread, so don't worry about concurrency ("X begins before Y completes..."). There's no potential for a race condition, as a service is not a thread.

# python - Python - an object can be its own type?

> ID：10936125
> 
> 赞同：12
> 
> 时间：2012-06-07T16:41:08.437
> 
> 标签：python, class, recursion, metaclass

I was playing around with metaclasses in CPython 3.2.2, and I noticed it is possible to end up with a class that is its own type:

```
Python 3.2.2 (default, Sep  5 2011, 21:17:14) 
[GCC 4.6.1] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> class MC(type):            #a boring metaclass that works the same as type
...     pass
... 
>>> class A(MC, metaclass=MC): #A is now both a subclass and an instance of MC...
...     pass
...
>>> A.__class__ = A            #...and now A is an instance of itself?
>>> A is type(A)
True 
```

For our metaclass `A`, there doesn't really seem to be much of a distinction between class and instance attributes:

```
>>> A.__next__ = lambda self: 1
>>> next(A)
1                                     #special method lookup works correctly
>>> A.__dict__
dict_proxy({'__module__': '__main__',
'__next__': <function <lambda> at 0x17c9628>,
'__doc__': None})
>>> type(A).__dict__
dict_proxy({'__module__': '__main__',
'__next__': <function <lambda> at 0x17c9628>,
'__doc__': None})                                #they have the same `__dict__` 
```

All this works the same (apart from changing to `__metaclass__`, and `__next__` not being a special method) in CPython 2.7.2, PyPy 1.6.0 (which implements Python 2.7.1), and Jython 2.2.1 (no idea what Python version that is, if any - I'm not very familiar with Jython).

I can't find much explanation about the conditions under which assigning to `__class__` is allowed (apparently the types concerned must be user-defined and have a similar layout in some sense?). Note that `A` does have to be both a subclass and an instance of `MC` for the assignment to `__class__` to work. Are recursive metaclass hierarchies like this really supposed to be acceptable? I'm very confused.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T21:01:28.567

递归元类层次结构实际上是语言核心的一部分：

```
>>> type(type)
<class 'type'> 
```

所以即使是标准的元类`type`也是它自己的类型。这个构造没有概念上的问题——它只是意味着类的`__class__`属性指向类本身。

`__class__`只有用户定义的类才允许对属性进行分配。如果原始类和新类都没有定义`__slots__`，或者都设置`__slots__`为相同的序列，则分配是合法的。

# c++ - Cython and overloaded c++ constructors

> ID：10936126
> 
> 赞同：3
> 
> 时间：2012-06-07T16:41:08.577
> 
> 标签：c++, python, constructor, cython

Is there a standardized (or commonly accepted way) to tackle the issue of not being able to overload `__cinit__` methods in cython when wrapping C++ classes?

There is the possibility of making `__cinit__` take *args and **kwargs to contain parameters and inside the `__cinit__` scope select the way to generate the C++ instance according to certain pattern. This approach however has complications:

*   Trying to identify the correct constructor from the arguments might be dangerous in certain circumstances unless the arguments are named and passed as kwargs which might become cumbersome for users.
*   When the arguments are not invoked by their type in the `__cinit__` argument list, they are passed as Python objects. In my working case, the arguments are Python wrappers for C++ classes, and trying to retrieve these instances "thisptr" is a task of the devil when they are passed as Python objects from the *args or **kwargs.
*   The implied need of using a sequence of if... elif... else cases to select a C++ constructor from the argument combination ultimately becomes quite messy.

So there has to be a better way. One way may be using the classmethod approach (e.g. see: [classmethod to overload `__init__` behavior in Python](https://stackoverflow.com/questions/682504/what-is-a-clean-pythonic-way-to-have-multiple-constructors-in-python#answer-682545)). Nevertheless, as far as I know (and please correct me if I'm wrong), classmethod implies invoking methods with names different of the class name and this does not resemble well the C++ way of constructing instances with just one class name.

Any ideas on this?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T10:31:26.713

就个人而言，我会使用类方法。

```
WrapperClass.fromSpambar(spambar) 
```

这不是那个令人费解的恕我*直言*。如果你不能在 C++ 中重载函数，你也需要回退到这种方法。

如果您可以在初始化时接受一些重量级的操作，您可以通过定义“模式”或类似的方法来实现一种方法来识别构造函数的调用方式。即 args 和 kwargs 的正则表达式。;)

我没有看到从 Python 对象获取*thisptr的问题。*

```
cdef WrapperClass wrpclsi
if isinstance(instance, WrapperClass):
    wrpclsi = instance
else:
    raise TypeError('expected instance of WrapperClass.')

cdef WrappedClassFromCpp* thisptr = wrpclsi.thisptr 
```

# c# - ASP.NET Web API 上 HttpActionContext.RequestContentKeyValueModel 的替代方案

> ID：10936129
> 
> 赞同：3
> 
> 时间：2012-06-07T16:41:13.487
> 
> 标签：c#, asp.net, asp.net-web-api

从 ASP.NET Web API 的 beta 版本开始，我习惯于`HttpActionContext.RequestContentKeyValueModel`从 POST 请求的正文中获取输入参数：

```
public override void OnActionExecuting(HttpActionContext actionContext)
{
    var requestContentKeyValueModel = actionContext.RequestContentKeyValueModel;
    //Do something in here

    base.OnActionExecuting(actionContext);
} 
```

但是在新的发布版本RC中，这个属性消失了，有什么替代方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T19:20:13.730

您可以使用`HttpContext.Current.Request.Form`.

**编辑**

您始终可以将其隐藏在界面后面：

```
public interface IKeyValueProvider
{
    string GetValue(string key);
}

class RequestFormKeyValueProvider : IKeyValueProvider
{
    public string GetValue(string key)
    {
        return HttpContext.Current.Request.Form[key];
    }
} 
```

注入`IKeyValueProvider`您的控制器并模拟您的测试。

# php - jQuery 自动完成（简单应用）

> ID：10936132
> 
> 赞同：0
> 
> 时间：2012-06-07T16:41:27.330
> 
> 标签：php, jquery, oracle-call-interface

**index1.html**

```
<html>
<head>
    <link type="text/css" rel="stylesheet" media="all" href="jquery-ui-1.8.21.custom.css"/>
    <script type="text/javascript" src="jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="jquery-ui-1.8.21.custom.min.js"></script>
    <script type="text/javascript" src="presidents.js"></script>
    <script type="text/javascript">
        $(function () {
            $("#presidentsServerInput").autocomplete({
                source: 'getname1.php',
                minLength: 2
            })
        });
    </script>
</head>
<body>
<label for="presidentsServerInput">Select President (server-side): </label>
<input id="presidentsServerInput"/>
</body>
</html> 
```

**getname1.php**

```
<?php
$searchTerm = $_GET['term'];
$results=array();
$conn = oci_connect("xxxxx", "yyyyy", "zzzzzzz");
$query = "SELECT first_name FROM employees where first_name like '" . $searchTerm . "%'";
$stid = oci_parse($conn, $query);
$r = oci_execute($stid);        
echo oci_num_rows ($stid);
while ($row = oci_fetch_object($stid)) {
    array_push($results,$row->FIRST_NAME);  
}
echo json_encode($results);
?> 
```

我可以在 FirePHP 中看到它正在正确打印数组，但我的文本框中没有收到建议。

有人能告诉我我在哪里犯错吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T16:48:28.527

[从 jQuery http://jqueryui.com/demos/autocomplete/#remote-jsonp](http://jqueryui.com/demos/autocomplete/#remote-jsonp)的示例中查看 jQuery UI 自动完成的打开选择和关闭方法

# java - Ant : Junit 故障触发了一个停止故障

> ID：10936140
> 
> 赞同：1
> 
> 时间：2012-06-07T16:41:40.620
> 
> 标签：java, ant, junit

我发现以下内容：

```
<junit haltonfailure="no" haltonerror="no" >
   <!-- some tests guaranteed to call Assert.fail(); --> 
</junit> 
```

不会过早停止（所有测试都会运行）。

但是......以下

```
<junit haltonfailure="no" haltonerror="yes" > 
```

在 FIRST 测试失败后将失败。请注意，在这种情况下，我保证测试通过 Assert.fail(); 失败。

**这个，我假设要么**

1) Ant 认为 ERROR 是 FAILURE 的子类。或者

2) ant 感知故障的方式很奇怪——也就是说，在决定停止时，故障被（错误地）视为错误。

我的问题：为什么 ant 会在测试失败时停止（即使显式配置为 haltonfailure="no"）。任何想法都可能非常有启发性！谢谢。

**更新**

我现在意识到这显然是 ant [http://ant.apache.org/manual/Tasks/junit.html](http://ant.apache.org/manual/Tasks/junit.html)中涵盖的 RTFM 问题（请参阅下面的正确答案）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T16:47:39.343

[来自junit ant任务文档](http://ant.apache.org/manual/Tasks/junit.html)的引用：

> haltonfailure：如果测试失败（错误也被认为是失败），则停止构建过程。

所以答案是：ant junit 将失败视为错误，因此停止构建

# linux - 仅重新编码 PDF 的图像？（或者，ghostscript 在优化时在 8 位 RGB 上失败）

> ID：10936142
> 
> 赞同：0
> 
> 时间：2012-06-07T16:41:42.440
> 
> 标签：linux, pdf, command-line, ghostscript

我需要针对文件大小优化一些大型 PDF 文档，所以我尝试使用`ghostscript`, 调用如下：

`gs -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 -dPDFSETTINGS=/screen -dNOPAUSE -dBATCH -sOutputFile=output-my-doc.pdf input-my-doc.pdf`

我可以看到它在某些页面上运行，但是在特定页面上它崩溃了。

我更新到`gs`9.02 版，我也有同样的经历。将文档拆分成单独的页面后，在每个页面上运行上面的命令，我可以确认哪些页面是有问题的；事实上，即使我只是调用，错误也会发生`gs input-my-doc-pageX.pdf`- 这会启动一个查看器，我可以看到文本排版，直到它出现在图像中，当它崩溃时。

所以我可以确认在我的情况下，`gs`特定图像上的崩溃 - 最后我还可以提供一个最小的工作（或者更确切地说，非工作）示例，它演示了问题（如下）。特别是，问题似乎是 8 位 RGB 图像，以某种方式指定。

现在，我不知道这是否是一个错误，但因为我需要完成这件事 - 我想也许我可以`ghostscript`通过应用程序运行 PDF 来“作弊”，这几乎不会影响 PDF - 除了那个它会将图像重新编码为单一格式（例如 PNG）；这样`gs`优化器也可以在不崩溃的情况下运行这些文件。

在 Linux 中使用命令行仅重新编码给定 PDF 的图像有哪些选项？

非常感谢您的任何答案，
干杯！

PS：测试用例基本上是帖子中的[源代码PDF示例](https://stackoverflow.com/questions/10932012/how-to-generate-plain-text-source-code-pdf-examples-that-work-in-a-document-view)：[Imagemagick：为PDF flate嵌入生成原始图像数据？](https://stackoverflow.com/a/10935716/277826).

该 PDF ( `hello2.pdf`) 可以很好地打开，例如`evince`：

![hello2.pdf-evince-OK](../Images/37be40558c759cd6f2d65a100c7affd0.png)

...但是由于它的外部参照表已损坏，因此我对其进行了修复：

```
$ pdftk hello2.pdf output hello2O.pdf
$ qpdf --check hello2O.pdf 
checking hello2O.pdf
PDF Version: 1.4
File is not encrypted
File is not linearized
No errors found 
```

修复后的文件`hello2O.pdf`也可以正常打开`evince`- 但是，当我尝试对其运行上述`gs`优化命令时，它会失败：

```
$ gs -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 -dPDFSETTINGS=/screen -dNOPAUSE -dBATCH -sOutputFile=optihello2O.pdf hello2O.pdf
GPL Ghostscript 9.02 (2011-03-30)
Copyright (C) 2010 Artifex Software, Inc.  All rights reserved.
This software comes with NO WARRANTY: see the file PUBLIC for details.
Processing pages 1 through 1.
Page 1
Loading NimbusSanL-Regu font from /usr/share/ghostscript/9.02/Resource/Font/NimbusSanL-Regu... 2756020 1410650 1869284 568021 3 done.
Error: /undefined in --run--
Operand stack:
   --dict:6/15(L)--   false   --dict:11/19(L)--   --dict:4/4(L)--   --nostringval--   FlateDecode   --dict:4/4(L)--   0
Execution stack:
   %interp_exit   .runexec2   --nostringval--   --nostringval--   --nostringval--   2   %stopped_push   --nostringval--   --nostringval--   --nostringval--   false   1   %stopped_push   1910   1   3   %oparray_pop   1909   1   3   %oparray_pop   1893   1   3   %oparray_pop   --nostringval--   --nostringval--   2   1   1   --nostringval--   %for_pos_int_continue   --nostringval--   --nostringval--   --nostringval--   --nostringval--   %array_continue   --nostringval--   false   1   %stopped_push   --nostringval--   %loop_continue   --nostringval--   576   --nostringval--   --nostringval--   --nostringval--   --nostringval--   --nostringval--   --nostringval--   %array_continue   --nostringval--   --nostringval--
Dictionary stack:
   --dict:1160/1684(ro)(G)--   --dict:1/20(G)--   --dict:82/200(L)--   --dict:82/200(L)--   --dict:108/127(ro)(G)--   --dict:295/300(ro)(G)--   --dict:23/30(L)--   --dict:6/8(L)--   --dict:25/40(L)--   --dict:7/17(L)--
Current allocation mode is local
GPL Ghostscript 9.02: Unrecoverable error, exit code 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T15:22:54.660

[首先，如果您发现 Ghostscript 错误，请通过http://bugs.ghostscript.com](http://bugs.ghostscript.com)向我们报告

其次，我建议您更新当前发布的 9.05 版本，该版本可能已修复此错误。

# scala - SBT 从使用 xsbt-web-plugin 打包的 war 文件中排除 scala-library.jar

> ID：10936146
> 
> 赞同：2
> 
> 时间：2012-06-07T16:41:47.827
> 
> 标签：scala, sbt

我有一个项目，只需要一个 proguard 构建的 jar 文件，该文件构建在一个单独的 SBT 项目中，包含作为 servlet 运行所需的所有类，并从中创建一个 war 文件。

依赖项被正确打包到war中，并且使用notTransitive（）正确排除了传递jar，但scala-library.jar也继续放入war文件中。这是不希望的，因为 proguard 构建的 jar 包含运行 servlet 过滤器所必需的那些 scala 类。现在的项目只需要拿那个依赖的jar，添加一个web.xml，然后打包成一个war文件。

从 xsbt-web-plugin 获取 war 打包机制以排除 scala-library.jar 的最简单方法是什么（最好使用 build.sbt 文件）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T18:45:02.203

这应该工作，它.sbt：

```
autoScalaLibrary := false 
```

# iphone - 绘制到 OpenGL ES 帧缓冲区并在 iPhone 上从中获取 UIImage

> ID：10936157
> 
> 赞同：3
> 
> 时间：2012-06-07T16:42:39.883
> 
> 标签：iphone, opengl-es, framebuffer

我正在尝试在 iOS 上的 OpenGL ES 中对一些原语进行屏幕外渲染。代码如下：

```
// context and neccesary buffers
@interface RendererGL
{
   EAGLContext* myContext;
   GLuint framebuffer;
   GLuint colorRenderbuffer;
   GLuint depthRenderbuffer;
} 
```

.m 文件：

```
- (id) init
{
    self = [super init];
    if (self)
    {
            // initializing context
        myContext = [[EAGLContext alloc] initWithAPI:kEAGLRenderingAPIOpenGLES2];
        [EAGLContext setCurrentContext:myContext];
        [self setupOpenGL]; // creating buffers
    }
    return self;
}

-(void) setupOpenGL
{
    int width = 256;
    int height = 256;

    // generating buffers and binding them as Apple,s tutorial says

    glGenFramebuffersOES(1, &framebuffer);
    glBindFramebufferOES(GL_FRAMEBUFFER_OES, framebuffer);

    glGenRenderbuffersOES(1, &colorRenderbuffer);
    glBindRenderbufferOES(GL_RENDERBUFFER_OES, colorRenderbuffer);
    glRenderbufferStorageOES(GL_RENDERBUFFER_OES, GL_RGBA8_OES, width, height);
    glFramebufferRenderbufferOES(GL_FRAMEBUFFER_OES, GL_COLOR_ATTACHMENT0_OES, GL_RENDERBUFFER_OES, colorRenderbuffer);

    glGenRenderbuffersOES(1, &depthRenderbuffer);
    glBindRenderbufferOES(GL_RENDERBUFFER_OES, depthRenderbuffer);
    glRenderbufferStorageOES(GL_RENDERBUFFER_OES, GL_DEPTH_COMPONENT16_OES, width, height);
    glFramebufferRenderbufferOES(GL_FRAMEBUFFER_OES, GL_DEPTH_ATTACHMENT_OES, GL_RENDERBUFFER_OES, depthRenderbuffer);

    GLenum status = glCheckFramebufferStatusOES(GL_FRAMEBUFFER_OES) ;
    if(status != GL_FRAMEBUFFER_COMPLETE_OES) {
        NSLog(@"failed to make complete framebuffer object %x", status);
    }
}

- (UIImage *) renderImage
{
        int width = 256;
        int height = 256;

        [EAGLContext setCurrentContext:myContext];
        glEnable(GL_DEPTH_TEST);

// clear color - cyan       
        glClearColor(0.0f, 1.0f, 1.0f, 1.0f);
        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

// trying to draw some primitive - red line
        float line[] = {-0.5f, -0.5f, 0.5f, 0.5f};

        glBindRenderbufferOES(GL_RENDERBUFFER_OES, colorRenderbuffer); //should I do this?

        glEnableClientState(GL_VERTEX_ARRAY);
        glVertexPointer(2, GL_FLOAT, 0, line);

        glColor4f(1.0, 0.0, 0.0, 1.0);
        glLineWidth(10);

        glDrawArrays(GL_LINES, 0, 2); // draw line with two points

        [myContext presentRenderbuffer:GL_RENDERBUFFER_OES]; // and this?

// then I grab image from _frameBuffer and return it as UIImage - this part is working
        NSInteger x = 0, y = 0;
        NSInteger dataLength = width * height * 4;
        GLubyte *data = (GLubyte*)malloc(dataLength * sizeof(GLubyte));

        glPixelStorei(GL_PACK_ALIGNMENT, 4);
        glReadPixels(x, y, width, height, GL_RGBA, GL_UNSIGNED_BYTE, data);

        CGDataProviderRef ref = CGDataProviderCreateWithData(NULL, data, dataLength, NULL);
        CGColorSpaceRef colorspace = CGColorSpaceCreateDeviceRGB();
        CGImageRef iref = CGImageCreate(width, height, 8, 32, width * 4, colorspace, kCGBitmapByteOrder32Big | kCGImageAlphaPremultipliedLast,
                                        ref, NULL, true, kCGRenderingIntentDefault);

        UIGraphicsBeginImageContext(CGSizeMake(width, height));
        CGContextRef cgcontext = UIGraphicsGetCurrentContext();
        CGContextSetBlendMode(cgcontext, kCGBlendModeCopy);
        CGContextDrawImage(cgcontext, CGRectMake(0.0, 0.0, width, height), iref);
        UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();

        free(data);
        CFRelease(ref);
        CFRelease(colorspace);
        CGImageRelease(iref);

        return image;
    } 
```

问题是 -renderImage 返回完全青色图像，没有红线。会是什么？我在画线之前错过了一些动作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T19:34:30.473

第一个问题是我正在为 OpenGL ES 2.0 创建 EAGLContext，但我使用的函数是用于 OpenGL ES 1.1。解决方案是将常量设置为 kEAGLRenderingAPIOpenGLES1

第二个 - 我没有设置模型和投影矩阵（如果我使用 1.1）

```
glViewport(0, 0, width, height);
glMatrixMode(GL_PROJECTION);
glLoadIdentity();
glOrthof(-1.0f, 1.0f, -1.5f, 1.5f, -1.0f, 1.0f);
glMatrixMode(GL_MODELVIEW); 
```

在这一切正常之后）

# jquery - Datepicker“完成”按钮未显示在显示按钮栏面板中

> ID：10936159
> 
> 赞同：10
> 
> 时间：2012-06-07T16:42:44.983
> 
> 标签：jquery, jquery-ui, calendar, datepicker

我目前有我的 Datepicker 实例显示包含“今天”按钮但不包含“完成”按钮的按钮栏面板。我用来显示按钮栏的代码是：

```
 <script>
    $(function() {
            $( "#datepicker" ).datepicker({
                    showButtonPanel: true
            });           

    });
    </script> 
```

![这是它的显示方式](../Images/48e0b8369893560a2f5db96def0c8b59.png)

我认为默认情况下，当 showButtonPanel 设置为“true”时，会显示“完成”按钮。还有什么我应该补充的吗？

提前致谢。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-29T12:57:56.213

如果您尚未将日期选择器添加到输入元素，则 buttonPanel 不会显示关闭按钮

确保将日期选择器附加到输入而不是 div 之类的东西。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-07T16:57:11.770

尝试这个

```
 $(function() {
            $( "#datepicker" ).datepicker({
                    showButtonPanel: true
            }); 
            $( ".selector" ).datepicker( "option", "showButtonPanel", true );

          }); 
```

如果仍然无法获取，请在 firebug 等中查找 js 错误

# python - Python 编码风格

> ID：10936164
> 
> 赞同：3
> 
> 时间：2012-06-07T16:42:59.990
> 
> 标签：python, coding-style

我一直在阅读各种 python 编码风格指南，一些关于 SO 的答案等，但没有一个提到一些可能不是那么重要的问题，但我想知道是否有一种首选的方法来做到这一点：

如果我有一本字典，使用哪种风格会更好：

```
dict_name = {'test': 'somevalue',
             'test2': 'other'} 
```

或者

```
dict_name = {
    'longer_key': 'somevalue',
    'longer_key2': 'other'
} 
```

或者

```
dict_name = {
             'test': 'somevalue',
             'test2': 'other'
} 
```

或者

```
dict_name = {
             'test': 'somevalue',
             'test2': 'other'
            } 
```

或者是其他东西？

也适用于调用方法时：

```
function_name(longer_arg1, longer_arg2, longer_arg3, 
    longer_arg4) 
```

或者

```
function_name(longer_arg1, longer_arg2, longer_arg3, 
              longer_arg4) 
```

或者

```
function_name(
    longer_arg1, 
    longer_arg2, 
    longer_arg3, 
    longer_arg4
) 
```

或者

```
function_name(
              longer_arg1, 
              longer_arg2, 
              longer_arg3, 
              longer_arg4
) 
```

或者是其他东西？

当使用更长的日志记录行时，假设：

```
loggername.info('this is an awfully long line which must be separated'
    'into two lines, am I doing it right? {0}'.format('nope..')) 
```

甚至考虑一下：

```
loggername.info('this is an {0} {1} line which must be separated'
    'into {2} lines, am I doing it right? {0}'.format(
    'awfully', 'short', 'three', 'nope..')
) 
```

现在这最后一点也与函数调用风格有关，我们有很多参数，很长的字符串，如何最好地将这些行分开？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-07T16:43:50.270

[**查看PEP 8** - The Style Guide for Python Code](http://www.python.org/dev/peps/pep-0008/)以获取有关如何编写可读 Python 代码的指导，你不会出错。强烈推荐。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T19:30:14.897

Levon 的回答不会出错，因为它是完全客观的（尽管可能基于主观文件）。**PEP 8**应被视为标准。根据个人偏见回答：

```
dict_name = {'test': 'somevalue',
             'test2': 'other'} 
```

IDLE（Python 的集成开发环境）将在第一个逗号后按**回车/回车时以这种方式格式化字典。**因此，我经常将这种风格用于大型词典。

```
function_name(longer_arg2, longer_arg2, longer_arg3,
              longer_arg4) 
```

还考虑到 IDLE，如果在第三个逗号后按下**return / enter**，程序将以这种方式缩进函数。我通常遵循这种风格，但你总会偶尔发现标准风格的例外。

```
loggername.info('This is an awfully long line which must be separated into two \
lines. Am I doing it right? {}'.format('No.')) 
```

这可能是我最主观的评论。程序中的行长度应为 80 或更少字符。这可能应该适用于代码和文本。请记住，您可以创建块引号 ( `'''`)。

# java - 我如何压缩或编码椭圆曲线公钥并将其放在网络上？

> ID：10936171
> 
> 赞同：9
> 
> 时间：2012-06-07T16:43:34.983
> 
> 标签：java, cryptography, elliptic-curve

我正在开发分布式数字签名，它对文档进行签名并通过网络将其发送到应用程序服务器。我正在使用 java 中的套接字编程来做到这一点。我认为应该对公钥进行编码或压缩，即 x 和 y 值以某种方式表示为单个二进制数据并保存在公共注册表或网络中。但我不知道如何在 java 中做到这一点。

```
 // I have class like this 
           public class CryptoSystem{                  

               EllipticCurve ec = new EllipticCurve(new P192());

               //-------------------
               //--------------------

               public ECKeyPair generatekeyPair()
               {
                  return ECKeyPair(ec);

               }

            }    
        // i don't think i have problem in the above

    CryptoSystem crypto = new CryptoSystem();
    ECKeyPair keyPair = crypto.generateKeyPair();
    BigInteger prvKey = keyPair.getPrivateKey();
    ECPoint pubKey = keyPair.getPublicKey();
     // recommend me here to  compress and send it  the public key to a shared network. 
```

我想知道如何对公钥和域参数进行编码，以便签名的验证者对其进行解码以使用它。因为当您通过网络将它们发送给验证者时，您必须将其编码为单字节数组.我没有使用 Bouncy Castle Provider。ECDSA算法的整个实现是我的项目

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-07T20:53:12.770

椭圆曲线点几乎总是使用 X9.62 中指定的编码进行编码。

使用点压缩是可选的。使用点压缩进行编码很简单，但是解码压缩点需要更多的工作，所以除非你真的需要保存额外的字节，否则我不会打扰。如果您需要，请告诉我，我会添加详细信息。您可以通过第一个字节（即 0x02 或 0x03）点压缩来识别 X9.62 编码点。

没有点压缩的编码非常简单：以 0x04 开头（表示不压缩）。然后首先是 x 坐标，然后是 y 坐标，在左侧都用零填充，直到字段的大小（以字节为单位）：

```
int qLength = (q.bitLength()+7)/8;
byte[] xArr = toUnsignedByteArray(x);
byte[] yArr = toUnsignedByteArray(y);
byte[] res = new byte[1+2*qLength];
res[0] = 0x04;
System.arraycopy(xArr, 0, res, qLength - xArr.length, xArr.length);
System.arraycopy(yArr, 0, res, 2* qLength - yArr.length, nLength); 
```

解码这当然是微不足道的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-08T01:51:01.603

我很确定 BC 实现使用 X9.63 编码，所以这些将是相当标准化的编码。您需要将 Bouncy Castle 提供程序添加到您的 JRE ( `Security.addProvider(new BouncyCastleProvider())`，请参阅 bouncy 文档。

```
public static void showECKeyEncodings() {

    try {
        KeyPairGenerator kp = KeyPairGenerator.getInstance("ECDSA");
        ECNamedCurveParameterSpec ecSpec = ECNamedCurveTable
                .getParameterSpec("prime192v1");
        kp.initialize(ecSpec);
        KeyPair keyPair = kp.generateKeyPair();

        PrivateKey privKey = keyPair.getPrivate();
        byte[] encodedPrivKey = privKey.getEncoded();
        System.out.println(toHex(encodedPrivKey));

        PublicKey pubKey = keyPair.getPublic();
        byte[] encodedPubKey = pubKey.getEncoded();
        System.out.println(toHex(encodedPubKey));

        KeyFactory kf = KeyFactory.getInstance("ECDSA");
        PublicKey pubKey2 = kf.generatePublic(new X509EncodedKeySpec(encodedPubKey));
        if (Arrays.equals(pubKey2.getEncoded(), encodedPubKey)) {
            System.out.println("That worked for the public key");
        }

        PrivateKey privKey2 = kf.generatePrivate(new PKCS8EncodedKeySpec(encodedPrivKey));
        if (Arrays.equals(privKey2.getEncoded(), encodedPrivKey)) {
            System.out.println("That worked for the private key");
        }

    } catch (GeneralSecurityException e) {
        throw new IllegalStateException(e);
    }

} 
```

# c# - 使用实体框架在数据库中搜索文本

> ID：10936176
> 
> 赞同：4
> 
> 时间：2012-06-07T16:44:05.583
> 
> 标签：c#, .net, linq, oracle, entity-framework

我正在编写一个 UI，允许某人通过他们的名字和/或姓氏查找用户。例如，如果您输入“Mike”作为名字，“Jo”作为姓氏，它将返回“Mike Jones”、“Mike Johnson”和“Mike Jobs”。我使用以下 LINQ 语句进行此搜索：

```
var users = (from u in context.TPM_USER
             where u.LASTNAME.ToLower().Contains(LastName.ToLower())
             && u.FIRSTNAME.ToLower().Contains(FirstName.ToLower())
             select u); 
```

（可能有也可能没有更好的方法来执行不区分大小写的*like*子句，但这似乎有效）

问题是如果用户输入名字或姓氏，但随后将其他字段留空。如果我输入“迈克”作为名字并将姓氏字段留空，我想返回所有迈克，而不考虑他们的姓氏。上面的查询不返回任何结果，除非两个字段都至少填写了一些东西。

我试过：

```
var users = (from u in context.TPM_USER
             where (LastName == "" || u.LASTNAME.ToLower().Contains(LastName.ToLower()))
             && (FirstName == "" || u.FIRSTNAME.ToLower().Contains(FirstName.ToLower()))
             select u); 
```

但是，除非两个字段都填写，否则我仍然没有得到任何结果。我已经在调试器下验证了`LastName == ""`确实如此。

**更新：**

我做了更多的调试，这实际上是一个 Oracle 问题。正在生成的查询是：

```
--Replaced the field list with * for brevity
SELECT * FROM TPMDBO.TPM_USER "Extent1"
     WHERE (('jones' = '') OR ((INSTR(LOWER("Extent1".LASTNAME), LOWER('jones'))) > 0)) AND (('' = '') OR ((INSTR(LOWER("Extent1".FIRSTNAME), LOWER(''))) > 0)) 
```

乍一看似乎是正确的。但是，Oracle 似乎并没有正确地*缩短*短语`('' = '')`. 事实上，如果我这样做：

```
select * from TPM_USER where '' = '' 
```

我得到零行。我没有足够的 Oracle 专家知道*应该*如何编写此查询，但无论哪种方式，它都是实体框架方言错误。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-07T16:49:56.557

只需有条件地添加谓词：

```
var users = from u in context.TPM_USER select u;
if (!string.IsNullOrWhiteSpace(FirstName))
    users = users.Where(u => u.FIRSTNAME.ToLower().Contains(FirstName.ToLower()));
if (!string.IsNullOrWhiteSpace(LastName))
    users = users.Where(u => u.LASTNAME.ToLower().Contains(LastName.ToLower())); 
```

或者仅将 LASTNAME 谓词作为条件谓词。

*后期补充：*

`Where(u => u.FIRSTNAME.ToLower()...`最好避免使用类似的表达式。它们会导致忽略任何索引`FIRSTNAME`，因为首先转换字段值然后进行比较（有关更多详细信息，请参见[此处](https://stackoverflow.com/q/799584/861716)）。

您很有可能不需要这些小写转换。检查字段的数据库排序规则。如果它可能不区分大小写 (CI)，则不需要这些转换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T16:51:47.590

您确定 FirstName 和 LastName 不为空吗？

你可以试试这样写...

```
string LowerFirstName = (FirstName + "").ToLower();
string LowerLastName = (LastName + "").ToLower();

var users = (from u in context.TPM_USER
             where (LowerLastName == "" || u.LASTNAME.ToLower().Contains(LowerLastName))
             && (LowerFirstName == "" || u.FIRSTNAME.ToLower().Contains(LowerFirstName))
             select u); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T20:43:17.253

仅供参考，如果有人遇到 Oracle 的这个问题，这里有一个解决方法：

```
var users = (from u in context.TPM_USER
             where (LastName == null|| u.LASTNAME.ToLower().Contains(LastName.ToLower()))
             && (FirstName == null || u.FIRSTNAME.ToLower().Contains(FirstName.ToLower()))
             select u); 
```

这将转换为：

```
'' is null 
```

在 SQL 中，Oracle 将其解释为 true。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T16:50:16.623

您可以简单地围绕您的查询创建一个条件语句：

```
if (String.IsNullOrWhiteSpace(LastName) && !String.IsNullOrWhiteSpace(FirstName))
{
   var users = (from u in context.TPM_USER
   where (u.FIRSTNAME.ToLower().Contains(FirstName.ToLower()))
   select u);
}
else if (String.IsNullOrWhiteSpace(FirstName) && !String.IsNullOrWhiteSpace(LastName))
{
   var users = (from u in context.TPM_USER
   where (u.LASTNAME.ToLower().Contains(LastName.ToLower()))
   select u);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-09T16:38:29.883

也许您可以尝试检查搜索词的长度，看看它是否在 Oracle PL/SQL 中工作。

```
var users = (from u in context.TPM_USER
         where ((LastName ?? "").Trim().Length == 0 || u.LASTNAME.ToLower().Contains(LastName.ToLower()))
         && ((FirstName ?? "").Trim().Length == 0 || u.FIRSTNAME.ToLower().Contains(FirstName.ToLower()))
         select u); 
```

# python - 从 Python 中的 URL 下载文本

> ID：10936177
> 
> 赞同：2
> 
> 时间：2012-06-07T16:44:07.467
> 
> 标签：python, web-scraping

我目前正在开展一个学校项目，其目标是使用自然语言工具包包分析诈骗邮件。基本上我愿意做的是比较不同年份的骗局并试图找到一个趋势——它们的结构是如何随着时间的推移而变化的。我找到了一个骗局数据库：[http](http://www.419scam.org/emails/) ://www.419scam.org/emails/ 我想用 python 下载链接的内容，但我卡住了。到目前为止我的代码：

```
from BeautifulSoup import BeautifulSoup
import urllib2, re

html = urllib2.urlopen('http://www.419scam.org/emails/').read()
soup = BeautifulSoup(html)
links = soup.findAll('a')

links2 = soup.findAll(href=re.compile("index"))

print links2 
```

所以我可以获取链接，但我还不知道如何下载内容。有任何想法吗？非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T17:26:14.263

您已经有了一个好的开始，但现在您只是检索索引页面并将其加载到 BeautifulSoup 解析器中。现在您已经从链接中获得了 href，您基本上需要打开所有这些链接，并将它们的内容加载到您可以用于分析的数据结构中。

这基本上相当于一个非常简单的网络爬虫。如果您可以使用其他人的代码，您可以通过谷歌搜索“python Web crawler”找到适合的内容。我已经看过其中的一些，它们很简单，但对于这项任务来说可能有点矫枉过正。大多数网络爬虫使用递归来遍历给定站点的完整树。看起来更简单的东西可以满足您的情况。

鉴于我对 BeautifulSoup 的不熟悉，这个基本结构有望让您走上正确的道路，或者让您了解网络爬取的完成方式：

```
from BeautifulSoup import BeautifulSoup
import urllib2, re

emailContents = []

def analyze_emails():
    # this function and any sub-routines would analyze the emails after they are loaded into a data structure, e.g. emailContents

def parse_email_page(link):
    print "opening " + link
    # open, soup, and parse the page.  
    #Looks like the email itself is in a "blockquote" tag so that may be the starting place.  
    #From there you'll need to create arrays and/or dictionaries of the emails' contents to do your analysis on, e.g. emailContents

def parse_list_page(link):
    print "opening " + link
    html = urllib2.urlopen(link).read()
    soup = BeatifulSoup(html)
    email_page_links = # add your own code here to filter the list page soup to get all the relevant links to actual email pages   
    for link in email_page_links:
        parseEmailPage(link['href'])

def main():
    html = urllib2.urlopen('http://www.419scam.org/emails/').read()
    soup = BeautifulSoup(html)    
    links = soup.findAll(href=re.compile("20")) # I use '20' to filter links since all the relevant links seem to have 20XX year in them. Seemed to work

    for link in links:
        parse_list_page(link['href'])

    analyze_emails()         

if __name__ == "__main__":
    main() 
```

# java - 如何禁用 JSlider 的箭头键？

> ID：10936178
> 
> 赞同：1
> 
> 时间：2012-06-07T16:44:08.573
> 
> 标签：java, swing, jslider, arrow-keys

我想使用箭头键在屏幕上移动某些内容，但是在单击 a`JSlider`使用它并使用箭头键后，它们正在移动滑块而不是对象。我找不到任何方法来禁用它。（单击滑块后，滑动箭头从黑色轮廓变为蓝色轮廓{我的假设表明箭头键被“锁定”在滑块上。}）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T18:59:53.070

[键绑定](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)应该为这个问题提供解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T16:47:10.010

Try `slider.setFocusable(false);`

But for a complex application, ensuring you always have control over what the arrows do may require the `KeyboardFocusManager` and `KeyEventDispatcher` APIs. These let you divert arrow (or any) keystrokes from normal handling, so must be used carefully.

# javascript - 使用 Mongoose 在 JSLint 中抑制“期望一个标识符，而是看到“默认”（保留字）

> ID：10936180
> 
> 赞同：6
> 
> 时间：2012-06-07T16:44:15.487
> 
> 标签：javascript, node.js, mongoose, jslint, jshint

我`jshint`用来验证我的 JavaScript 文件。

在服务器端，我将 node.js 与 Mongoose 一起使用。在 Mongoose 中，我被鼓励以如下方式编写模式：

```
var UserSchema = new mongoose.Schema({
    firstname : { type: String, default: '' }
}); 
```

运行 linting 时，出现错误：

```
Expected an identifier and instead saw 'default' (a reserved word). 
```

有没有办法抑制这个错误？我真的更喜欢这种行为而不是写：

```
var UserSchema = new mongoose.Schema({
    firstname : { type: String, "default": '' }
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-19T17:06:41.150

`default`确实是 JavaScript 中的保留字（[https://developer.mozilla.org/en/JavaScript/Reference/Reserved_Words](https://developer.mozilla.org/en/JavaScript/Reference/Reserved_Words)）。虽然从技术上讲，您可以毫无问题地在对象属性名称中使用默认值，但如果您的解释器是严格的（就像 lint 一样），您最终可能会遇到该表示法的问题。

最简单的前进方法：通过添加引号来解决问题。Lint 不会再抱怨你了。代码长了两个字符，但那又怎样 - linting 通过了，并且您保证不会因为使用保留关键字而遇到问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-29T14:53:02.707

您还可以使用“es5”选项来禁止这种情况发生。

请参阅：http: [//jslinterrors.com/expected-an-identifier-and-instead-saw-aa-reserved-word/](http://jslinterrors.com/expected-an-identifier-and-instead-saw-a-a-reserved-word/)

# python - Twisted Python：无法写入正在运行的衍生进程

> ID：10936181
> 
> 赞同：1
> 
> 时间：2012-06-07T16:44:16.130
> 
> 标签：python, twisted, stdin, spawn

我的问题是，在产生一个进程之后，子进程正在循环以从其标准输入中获取数据。我想使用 Echo.Process.pipes[0].write(data) 或 Echo.Process.writeToChild(0,data) 向它写入新数据，但两者都不起作用。有人会解释发生了什么吗？或者我该如何解决这个问题？

这是我得到的错误：

```
--- <exception caught here> ---
  File "/usr/local/encap/python-2.6.4/lib/python2.6/site-packages/Twisted-9.0.0-py2.6-linux-x86_64.egg/twisted/internet/selectreactor.py", line 146, in _doReadOrWrite
    why = getattr(selectable, method)()
  File "/usr/local/encap/python-2.6.4/lib/python2.6/site-packages/Twisted-9.0.0-py2.6-linux-x86_64.egg/twisted/internet/tcp.py", line 460, in doRead
    return self.protocol.dataReceived(data)
  File "pp1.py", line 30, in dataReceived
    Echo.Process.pipes[0].write(data)
exceptions.KeyError: 0 
```

谢谢你，

问

```
from sys import executable
from os import environ
import os
from twisted.internet import reactor
from twisted.internet.protocol import Protocol
from twisted.internet.protocol import Factory
from twisted.internet import protocol
import sys

implementation = """\
import os
import time
import sys

print "in child", os.getpid()

while (True):
        a = raw_input("")
        if a: print a
"""

class Echo(Protocol):
    Process = None
    def dataReceived(self, data):
        if Echo.Process == None:
                pp = MyPP()
                Echo.Process = reactor.spawnProcess(pp, executable, [executable, "-c", implementation, data], env=environ, childFDs = {0:1, 1:1, 2:2})
        else:
                Echo.Process.pipes[0].write(data)
                #Echo.Process.writeToChild(0,data)
        self.transport.write(data)

class EchoFactory(Factory):
    def buildProtocol(self, addr):
        return Echo()

class MyPP(protocol.ProcessProtocol):
    def connectionMade(self):
        print "connectionMade!"
    def outReceived(self, data):
        print "out"
    def errReceived(self, data):
        print "error", data
    def processExited(self, reason):
        print "processExited"
    def processEnded(self, reason):
        print "processEnded"
        print "quitting"

reactor.listenTCP(8200, EchoFactory())
print 'in parent', os.getpid()
reactor.run() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T01:22:24.793

在每个传入连接上创建一个新进程并将所有输入数据重定向到进程的标准输入：

```
#!/usr/bin/python
from twisted.internet import reactor

from twisted.internet import protocol

class Echo(protocol.Protocol):
    def connectionMade(self):
        self.pp = MyPP()
        reactor.spawnProcess(self.pp, 'cat', ['cat'])
    def dataReceived(self, data):
        self.pp.transport.write(data)
    def connectionLost(self, reason):
        self.pp.transport.loseConnection()

class MyPP(protocol.ProcessProtocol):
    def connectionMade(self):
        print "connectionMade!"
    def outReceived(self, data):
        print "out", data,
    def errReceived(self, data):
        print "error", data,
    def processExited(self, reason):
        print "processExited"
    def processEnded(self, reason):
        print "processEnded"
        print "quitting"

factory = protocol.Factory()
factory.protocol = Echo
reactor.listenTCP(8200, factory)
reactor.run() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T13:09:22.780

不要传递`childFDs`给`spawnProcess`也不要使用`pipes`生成的进程传输对象的属性。这些事情都不是你想的那样。如果您放弃使用`childFDs`并切换回`writeToChild`，您将获得所需的行为。

# ruby-on-rails - 动作控制器：捕获异常 - 使用 Rails 进行敏捷 Web 开发

> ID：10936182
> 
> 赞同：1
> 
> 时间：2012-06-07T16:44:17.797
> 
> 标签：ruby-on-rails

我一直在阅读使用 Rails 进行敏捷 Web 开发，我目前在第 75/76 页上，您正在为产品设置视图。

我运行 rails s，我得到的是这个异常。

> *C:/Users/Win7/Desktop/Agile/depot/app/views/products/index.html.erb:25：语法错误，意外keyword_end，期待')'')；结束 ^ C:/Users/Win7/Desktop/Agile/depot/app/views/products/index.html.erb:34：语法错误，意外的keyword_ensure，期待')' C:/Users/Win7/Desktop/Agile/ depot/app/views/products/index.html.erb:36：语法错误，意外的keyword_end，期待')'*

这是视图中的代码：

```
<h1>Listing products</h1>

<table>
<% @products.each do |product| %>
<tr class="<%= cycle('list_line_odd', 'list_line_even') %>">
<td>
  <%= image_tag(product.image_url, class: 'list_image') %>
</td>

<td class="list_description">
  <dl>
    <dt><%= product.title %></dt>
    <dd><%= truncate(strip_tags(product.description), length: 80 %></dd>
  </dl>
</td>

<td class="list_actions">
  <%= link_to 'Show', product %><br />
  <%= link_to 'Edit', edit_product_path(product) %><br />
  <%= link_to 'Destroy', product, confirm: 'Are you sure?', method: :delete %>
</td>
</tr>

<% end %>

</table>

<br />

<%= link_to 'New Product', new_product_path %> 
```

我不知道为什么我会得到这个例外。任何人都可以解释一下吗？

一如既往，非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:12:56.530

你错过了一个 ) 就行了

```
 truncate(strip_tags(product.description), length: 80 
```

它应该是

```
 truncate(strip_tags(product.description), length: 80) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:09:46.323

删除您在此文件中的那一端：

```
<% end %> 
```

这个目的不是关闭任何东西。

# python - Scikit-learn 模型参数不可用？如果是这样，还有什么 ML 工作台替代方案？

> ID：10936183
> 
> 赞同：5
> 
> 时间：2012-06-07T16:44:19.013
> 
> 标签：python, machine-learning, scikit-learn

我正在按照[这个问题](https://stackoverflow.com/questions/7326958/python-machine-learning-library)中的建议使用 scikit-learn 进行机器学习。令我惊讶的是，它似乎无法访问它训练的实际模型。例如，如果我创建一个 SVM、线性分类器甚至决策树，它似乎无法让我查看为实际训练模型选择的参数。

如果模型的创建部分是为了更清楚地了解它正在使用的功能（例如，决策树），那么查看实际模型很有用。如果想要使用 Python 来训练模型并使用其他代码来实际实现它，那么查看模型也是一个重要问题。

我是否在 scikit-learn 中遗漏了一些东西，或者有什么方法可以在 scikit-learn 中解决这个问题？如果没有，什么是好的免费机器学习工作台，不一定是 python，*其中模型是透明可用的*？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T09:15:44.513

拟合的模型参数直接存储为模型实例的属性。这些拟合参数有一个特定的命名约定：它们都以尾随下划线结尾，而用户提供的构造函数参数（也称为超参数）则没有。

拟合属性的类型取决于算法。例如，对于内核支持向量机，您将拥有数组支持向量、对偶系数和截距，而对于随机森林和极端随机树，您将拥有二叉树的集合（在内存中内部表示为性能问题的连续 numpy 数组：结构数组表示）。

有关详细信息，请参阅每个模型的文档字符串的属性部分，例如 SVC：

[http://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC](http://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC)

对于基于树的模型，您还有一个辅助函数来生成学习树的 graphivz_export：

[http://scikit-learn.org/stable/modules/tree.html#classification](http://scikit-learn.org/stable/modules/tree.html#classification)

要了解森林模型中特征的重要性，您还应该查看`compute_importances`参数，例如，请参见以下示例：

[http://scikit-learn.org/stable/auto_examples/ensemble/plot_forest_importances.html#example-ensemble-plot-forest-importances-py](http://scikit-learn.org/stable/auto_examples/ensemble/plot_forest_importances.html#example-ensemble-plot-forest-importances-py)

[http://scikit-learn.org/stable/auto_examples/ensemble/plot_forest_importances_faces.html#example-ensemble-plot-forest-importances-faces-py](http://scikit-learn.org/stable/auto_examples/ensemble/plot_forest_importances_faces.html#example-ensemble-plot-forest-importances-faces-py)

# wpf - 如何检测对 RadGridView 控件的选定行的单击

> ID：10936192
> 
> 赞同：1
> 
> 时间：2012-06-07T16:45:05.357
> 
> 标签：wpf, events, routed-events

我的 WPF 应用程序在其一些屏幕上使用 Telerik RadGridView 控件。我有一个要求，即每当用户单击 RadGridView 中的一行时，我都应该切换到另一个屏幕并显示有关该行的详细信息。我为 SelectionChanged 事件连接了一个处理程序，这很有效，但如果用户再次单击选定的行，则不会发生任何事情。这是有道理的，因为选定的行没有被更改。

如何检测对同一行的第二次点击并显示第二个屏幕？

托尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:40:31.327

您可以将处理程序附加到 GridView 上的**MouseUp**事件。检查是否有任何选定的单元格并从那里响应。即使已经有选择，这也会触发。

Mousedown事件将在鼠标点击鼠标次，但在GridView更新之前，在选择已经调整时，鼠标悬停将启动

您还可以将处理程序附加到代码隐藏中的每个单独的单元格，如下所示

```
(this.GridView as RadGridView).AddHandler(  
     GridViewCell.MouseUpEvent,  
     new EventHandler<Telerik.Windows.RadRoutedEventArgs>(this.OnMouseUp)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:18:24.923

我想你可能会尝试通过`MouseLeftButtonDown`事件或`PreviewMouseLeftButtonDown`事件来实现这一点。

# java - Specify a parameter for using files inside a Jar

> ID：10936193
> 
> 赞同：1
> 
> 时间：2012-06-07T16:45:07.093
> 
> 标签：java, properties, jar, embedded-resource

Say `log.properties` is in the `test.jar`. I would like to specify the file parameter using some file inside the jar, is this doable?

```
-DLog=target/classes/log.properties 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:14:33.453

虽然问题对我来说不是那么清楚，但我会尝试回答：

如果您正在加载参数文件：

```
getClass().getClassLoader().getResourceAsStream(fileParameter); 
```

那么即使您的文件在 jar 中（在类路径中），它也应该可以工作。并且您应该能够将参数传递为`-DLog=log.properties`，以便它将搜索类路径中的所有可能路径。

# jquery - 使用 jQuery 读取 JSON 文件

> ID：10936196
> 
> 赞同：16
> 
> 时间：2012-06-07T16:45:10.493
> 
> 标签：jquery, json

嘿，我正在尝试使用 jQuery 从 JSON 文件中读取数据。这是我的 JS：

```
$(document).ready(function() {
    var myItems;

    $.getJSON('testData.json', function(data) {
        myItems = data.items;
        console.log(myItems);
    });
}); 
```

这就是 JSON 文件：

```
{"fname":"rafael","lname":"marques","age":"19"}
{"fname":"daniel","lname":"marques","age":"19"} 
```

当我在浏览器中打开我的 HTML 页面时，我在控制台中什么也看不到。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-07T16:48:20.177

在每个对象之后添加逗号，然后用json 文件中`[]`具有属性的对象将它们包装起来，`items`这样它看起来像

```
{
    items: [
    {
        "fname": "rafael",
        "lname": "marques",
        "age": "19"},
    {
        "fname": "daniel",
        "lname": "marques",
        "age": "19"
    }]
} 
```

那么你应该尝试

```
$.each(data.items, function(key, val) {
   alert(val.fname);
   alert(val.lname);
}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T16:47:45.677

```
{"fname":"rafael","lname":"marques","age":"19"}
{"fname":"daniel","lname":"marques","age":"19"} 
```

不是正确的 json 文件。在行之间添加逗号或使其如下所示：

```
{items:[
    {"fname":"rafael","lname":"marques","age":"19"},
    {"fname":"daniel","lname":"marques","age":"19"}
]} 
```

以符合您的明显要求。

但是打开控制台查看错误就可以解决这个问题。

# javascript - JavaScript zoom

> ID：10936197
> 
> 赞同：0
> 
> 时间：2012-06-07T16:45:12.627
> 
> 标签：javascript, zooming

I'm tying to achieve zoom effect which you can see here: [http://x3dom.org/x3dom/example/x3dom_x3dElementCSSIntegration.html](http://x3dom.org/x3dom/example/x3dom_x3dElementCSSIntegration.html).

So, I have a simple element (it doesn't matter that this is x3d example, really), which I want to enlarge to full screen size with a click of a button, and then reduce back to it's original size after clicking the button again. I would very much appreciate any help I can get with coding this in JavaScript. I have viewed the page source on this example and tried to get it to work in my project, but I'm very bad with JavaScript and I can't seem to get it to work.

Also, I tried searching with Google, but all the examples I found are far fancier in comparison with what I need.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:54:05.967

Something similar to the following should work.

HTML:

```
<div id="zoomable" class="resizable">
content
</div> 
```

CSS:

```
.resizable {
position: relative;
}
.resizable.zoomed {
position: absolute;
left: 0px;
top: 0px;
right: 0px;
bottom: 0px;
} 
```

JavaScript:

```
document.getElementById('zoomable').className = "resizable zoomed"; 
```

# objective-c - 带有 Bezeled 样式的 UISegmentedControl 使设备上的标题不居中

> ID：10936201
> 
> 赞同：2
> 
> 时间：2012-06-07T16:45:55.270
> 
> 标签：objective-c, ios, uikit, uisegmentedcontrol

为澄清起见，我将添加 2 个重叠的屏幕截图，一个在 Interface Builder 中，另一个在设备上。较低的 UISegmentedControl 刚从库中出来，没有编辑任何属性，但它在设备上看起来仍然不同（在这种情况下是非 Retina iPad，尽管 Retina-iPhone 的问题是相同的）（对于快速而肮脏的 photoshopping 感到抱歉)

![边框样式 UISegmentedControl](../Images/e70b54df1004513f7896e404b374d8f5.png)

有任何想法吗？

编辑：我显然尝试了界面生成器中实用程序选项卡中“控制”下的“对齐”。不幸的是，这些设置都没有改变 UISegment 中的标题。我认为他们不应该这样做，因为他们也没有更改 Interface Builder 中的标题。

EDIT2：以编程方式设置：

```
eyeSeg.contentHorizontalAlignment = UIControlContentHorizontalAlignmentCenter; 
```

也没有什么区别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T14:23:34.293

发现问题“UISegmentedControlStyleBezeled 已弃用。请使用不同的样式。”

另请参阅[我应该使用什么而不是不推荐使用的 uisegmentedcontrolstylebezeled-in-io](https://stackoverflow.com/questions/9883767/what-should-i-use-instead-of-the-deprecated-uisegmentedcontrolstylebezeled-in-io)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T23:47:05.510

嗯……你检查对齐了吗？也许就是这样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-07-17T01:25:23.203

您可以递归地搜索分段控件`UISegmentedControl`中每个视图的子视图`UILabels`，然后更改每个`UILabel`的属性，包括`textAlignment`我在代码示例中显示的属性。感谢 Primc 响应[更改 UISegmented Control 的字体大小](https://stackoverflow.com/questions/2280391/change-font-size-of-uisegmentedcontrol)的帖子，他建议使用这种通用方法来自定义`UILabels`. `UISegmentedControl`顺便说一句，即使在它被弃用之后，我也一直在使用这种`UISegmentedControlStyleBezeled`风格的代码，尽管我最近切换到`UISegmentedControlStyleBar`了调整过的框架高度。

```
- (void)viewDidLoad {
    [super viewDidLoad];
    // Adjust the segment widths to fit the text.  (Will need to calculate widths if localized text is ever used.)
    [aspirationControl setWidth:66 forSegmentAtIndex:0]; // Navel Lint Collector
    [aspirationControl setWidth:48 forSegmentAtIndex:1]; // Deep Thinker
    [aspirationControl setWidth:49 forSegmentAtIndex:2]; // Mental Wizard
    [aspirationControl setWidth:64 forSegmentAtIndex:3]; // Brilliant Professor
    [aspirationControl setWidth:58 forSegmentAtIndex:4]; // Nobel Laureate

    // Reduce the font size of the segmented aspiration control
    [self adjustSegmentText:aspirationControl];
}

- (void)adjustSegmentText:(UIView*)view {
    // A recursively called method for finding the subviews containing the segment text and adjusting frame size, text justification, word wrap and font size
    NSArray *views = [view subviews];
    int numSubviews = views.count;

    for (int i=0; i<numSubviews; i++) {
        UIView *thisView = [views objectAtIndex:i];
        // Typecast thisView to see if it is a UILabel from one of the segment controls
        UILabel *tmpLabel = (UILabel *) thisView;
        if ([tmpLabel respondsToSelector:@selector(text)]) {
            // Enlarge frame.  Segments are set wider and narrower to accomodate the text.
            CGRect segmentFrame = [tmpLabel frame];
            // The following origin values were necessary to avoid text movement upon making an initial selection but became unnecessary after switching to a bar style segmented control
            // segmentFrame.origin.x = 1;
            // segmentFrame.origin.y = -1;
            segmentFrame.size.height = 40;
            // Frame widths are set equal to 2 points less than segment widths set in viewDidLoad
            if ([[tmpLabel text] isEqualToString:@"Navel Lint Collector"]) {
                segmentFrame.size.width = 64;
            }
            else if([[tmpLabel text] isEqualToString:@"Deep Thinker"]) {
                segmentFrame.size.width = 46;
            }
            else if([[tmpLabel text] isEqualToString:@"Mental Wizard"]) {
                segmentFrame.size.width = 47;
            }
            else if([[tmpLabel text] isEqualToString:@"Brilliant Professor"]) {
                segmentFrame.size.width = 62;
            }
            else {
                // @"Nobel Laureate"
                segmentFrame.size.width = 56;
            }

            [tmpLabel setFrame:segmentFrame];
            [tmpLabel setNumberOfLines:0];  // Change from the default of 1 line to 0 meaning use as many lines as needed
            [tmpLabel setTextAlignment:UITextAlignmentCenter];
            [tmpLabel setFont:[UIFont boldSystemFontOfSize:12]];
            [tmpLabel setLineBreakMode:UILineBreakModeWordWrap];

        }

        if (thisView.subviews.count) {
            [self adjustSegmentText:thisView];
        }
    }
} 
```

分段控制标签文本在 IB 中外观难看，但使用上述代码在设备和模拟器中完美居中并包裹在 2 行中。

# java - Java: why TimeUnit have missing enums?

> ID：10936202
> 
> 赞同：16
> 
> 时间：2012-06-07T16:45:56.877
> 
> 标签：java, jakarta-ee, time

I just wonder, why some enums are missing on the TimeUnit class of Java?

Actually the max timeunit is DAY while i would like to use stuff like WEEK, YEAR...

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-07T17:11:26.290

该`TimeUnit.DAYS`常数表示 24 小时的间隔，而不是*日历日*（午夜到午夜）。超出一天（一周、一个月、一年）的任何时间都是日历单位，而不是时间单位。日历单位的持续时间取决于所使用的日历：例如，当夏令时生效和失效时，一周可以长或短一小时，闰年长一天，等等。这就是为什么在`TimeUnit`枚举中包含日历单位没有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-09T12:47:50.700

在 Java 8 ChronoUnit 中，您可以在一个枚举中拥有 NANOS（纳秒）和 CENTURIES、MILLENIA 甚至 FOREVER 之间的所有常用时间单位：[https ://docs.oracle.com/javase/8/docs/api/java /time/temporal/ChronoUnit.html](https://docs.oracle.com/javase/8/docs/api/java/time/temporal/ChronoUnit.html) （参见 Julien Kronegg 对所选答案的评论）

# android - Android Debugging techniques

> ID：10936203
> 
> 赞同：1
> 
> 时间：2012-06-07T16:46:00.027
> 
> 标签：android, memory

My question is there is a way to debug a specific line of code to check how much memory it takes or a technique of figuring out how much it uses?.

Note* I am using eclipse.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:49:07.497

请参阅
[http://www.droidnova.com/debugging-in-android-using-eclipse,541.html](http://www.droidnova.com/debugging-in-android-using-eclipse,541.html)
和
[http://macgyverdev.blogspot.de/2011/07/profiling-android-application-tutorial.html](http://macgyverdev.blogspot.de/2011/07/profiling-android-application-tutorial.html)

这就是你需要知道的一切；）

Debugging 和 Profiling 是关键字。

# iphone - UILabel becomes null after facebook login (UILabel dosen't update)

> ID：10936204
> 
> 赞同：0
> 
> 时间：2012-06-07T16:46:07.633
> 
> 标签：iphone, ios, facebook, facebook-graph-api

I am working on adding facebook SSO and the SDK to my project. All of my main facebook code is in my `AppDelegate.m` and `AppDelegate.h`. In my view controller `[[[UIApplication sharedApplication] delegate] performSelector:@selector(callLogin)];` is called when I press a button. The callLogin method in my `AppDelegate.m` looks like this:

```
- (void)callLogin{

facebook = [[Facebook alloc] initWithAppId:@"XXXXX" andDelegate:self];

NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
if ([defaults objectForKey:@"FBAccessTokenKey"] 
    && [defaults objectForKey:@"FBExpirationDateKey"]) {
    facebook.accessToken = [defaults objectForKey:@"FBAccessTokenKey"];
    facebook.expirationDate = [defaults objectForKey:@"FBExpirationDateKey"];
}

if (![facebook isSessionValid]) {
    [facebook authorize:nil];
    }
} 
```

Then in my `- (void)fbDidLogin` method I call the method `setInfo` which is located in my viewcontroller.

```
//this method is located in AppDelegate.m
- (void)fbDidLogin {
NSLog(@"FACEBOOK DID LOGIN");
ViewController * vc = [[ViewController alloc]init];
[vc setInfo]; 
} 
```

Finally, here is my `-(void)setInfo` code which is located in `ViewController.m`

```
-(void)setInfo{
infoL.text = [NSString stringWithFormat: @"Connected to Facebook!"];
NSLog(@"%@",infoL);
//NSLog returns null
} 
```

From setInfo I am unable to change the label and NSLog returns that `infoL` is null. I can update the label through methods like ViewDidLoad, but not setInfo. What am I doing wrong and how can I fix this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T15:32:44.697

The view controller won't get updated because you just created some random instance of the class that is not on your navigation stack. I suppose you could call

```
 [ self.viewController setInfo ] 
```

assuming that is the property name for the vc you pushed on the stack in applicationDidFinishLaunchingWithOptions although this wouldn't be considered great design. Id factor Facebook delegate stuff out out app delegate, create a Facebook controller singleton class that your view controller can feed off

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:58:07.943

我假设 infoL 代表一个 UILabel。您是在代码中创建此标签还是自动创建的插座？

如果您在代码中创建 infoL，它在哪里分配/初始化？在您的 setInfo 方法运行之前的任何时候它都不是 nil 吗？

# python - Can a python @classmethod be inherited?

> ID：10936205
> 
> 赞同：20
> 
> 时间：2012-06-07T16:46:18.183
> 
> 标签：python, inheritance, class-method

For example, I have a base class and a derived class:

```
>>> class Base:
...   @classmethod
...   def myClassMethod(klass):
...     pass
...
>>> class Derived:
...   pass
...
>>> Base.myClassMethod()
>>> Derived.myClassMethod()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: class Derived has no attribute 'myClassMethod' 
```

Is it possible to have the Derived class be able to call myClassMethod without overwriting it and calling super's class method? I'd like to overwrite the class method only when it's necessary.

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-07T16:49:08.183

是的，它们可以被继承。

如果你想继承成员，你需要告诉python继承！

```
>>> class Derived(Base):
...    pass 
```

在 Python 2 中，让你的`Base`类从对象继承是一个很好的做法（但它可以在你不这样做的情况下工作）。在 Python 3 中这是不必要的，因为它默认已经从 object 继承（除非你试图让你的代码向后兼容）：

```
>>> class Base(object):
...     ... 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-07T16:49:05.967

您必须从子类中的基类派生：

```
class Derived(Base):
    ... 
```

# java - JRE7 RSA Cipher javax.crypto.BadPaddingException: Blocktype mismatch: 0

> ID：10936208
> 
> 赞同：3
> 
> 时间：2012-06-07T16:46:40.700
> 
> 标签：java, public-key-encryption

I am at my wits end with this problem. I am trying to implement an encrypted channel using RSA(4096) to deliver an AES 256 bit key using java (JRE7). The first message I send is the generated 256 AES key encrypted with the RSA public key. Upon decryption, I am getting the following error message: javax.crypto.BadPaddingException: Blocktype mismatch: 0

My decryption code:

```
private byte[] decryptMessage(Key key, byte[] data){
    Cipher cipher;
    System.out.println("Decrypting message...");
    System.out.println("key: " + key.toString());
    System.out.println("data: " + data);
    System.out.println("data length: " + data.length);
    if(key instanceof PublicKey){
        //RSA public key
        System.out.println("Found PublicKey");
        try {
            cipher = Cipher.getInstance("RSA/ECB/PKCS1Padding");
            cipher.init(Cipher.DECRYPT_MODE, key);
            return cipher.doFinal(data);
        } catch (NoSuchAlgorithmException | NoSuchPaddingException | InvalidKeyException | IllegalBlockSizeException | BadPaddingException e) {
            // TODO Auto-generated catch block
            System.out.println("Failed to decrypt message");
            e.printStackTrace();
        }

    }else if(key instanceof PrivateKey){
        //RSA private key
        System.out.println("Found PrivateKey");
        try {
            cipher = Cipher.getInstance("RSA/ECB/PKCS1Padding");
            cipher.init(Cipher.DECRYPT_MODE, key);
            byte[] results = cipher.doFinal(data);
            System.out.println("Decrypted results: " + results);
            return results;
        } catch (NoSuchAlgorithmException | NoSuchPaddingException | InvalidKeyException | IllegalBlockSizeException | BadPaddingException e) {
            // TODO Auto-generated catch block
            System.out.println("Failed to decrypt message");
            e.printStackTrace();
        }
    }else if(key instanceof SecretKey){
        //AES secret key
        try {
            cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
            cipher.init(Cipher.DECRYPT_MODE, key);
            return cipher.doFinal(data);

        } catch (NoSuchAlgorithmException | NoSuchPaddingException | InvalidKeyException | IllegalBlockSizeException | BadPaddingException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }else{
        System.out.println("Invalid key type");
    }
    return null;
} 
```

My encryption code:

```
private byte[] encryptMessage(Key key, byte[] data){
    Cipher cipher;
    if(key instanceof PrivateKey || key instanceof PublicKey){
        //RSA key
        try {
            cipher = Cipher.getInstance("RSA/ECB/PKCS1Padding");
            cipher.init(Cipher.ENCRYPT_MODE, key);
            return cipher.doFinal(data);
        } catch (NoSuchAlgorithmException | NoSuchPaddingException | InvalidKeyException | IllegalBlockSizeException | BadPaddingException e) {
            // TODO Auto-generated catch block
            System.out.println("Failed to encrypt message");
            e.printStackTrace();
        }

    }else if(key instanceof SecretKey){
        //AES secret key
        try {
            cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
            cipher.init(Cipher.ENCRYPT_MODE, key);
            return cipher.doFinal(data);

        } catch (NoSuchAlgorithmException | NoSuchPaddingException | InvalidKeyException | IllegalBlockSizeException | BadPaddingException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }else{
        System.out.println("Invalid key type");
    }
    return null;
} 
```

I googled and came to some similar stories(most on this website), but they were all problems with default Padding between to different devices, computer to android for example). I am getting the error when sending messages from the same computer and I have padding and ECB both set up. I went through the source code of com.sun.crypto.provider.RSACipher and sun.security.rsa.RSAPadding and found the error is being thrown in the sun.security.rsa.RSAPadding.unpadV15 method due to the second bit not being set properly. I am also using the new NIO2 classes in Java7 specifically the AsychronousSocketChannel and CompletionHandler objects so I don't know if they are causing threading errors though I highly doubt it. I found the source code at [http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/com/sun/crypto/provider/RSACipher.java](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/com/sun/crypto/provider/RSACipher.java) and http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/sun/security/rsa/RSAPadding.java#RSAPadding.padV15%28byte[]%29 but again they didn't help me much. I have tried dropping the key size and changing the encoding/padding options of the cipher objects, but it always errors out even with padding disabled. Though it may not matter, but since I am using JRE7, there is no stable support for bouncycastle so I am using the default security provider.

Thanks in advance

# url - Redirection to an external website in a Portlet

> ID：10936209
> 
> 赞同：3
> 
> 时间：2012-06-07T16:46:43.460
> 
> 标签：url, redirect, portlet

I have a portlet where the `doView` method calls the `display.jsp` page with the following instruction :

```
getPortletContext().getRequestDispatcher("/views/display.jsp").dispatcher.include(request, response); 
```

In the `display.jsp`, I want to do a redirection to an external website :

```
<%
response.sendRedirect("http://www.google.fr");
%> 
```

Why is it not working at all ? (I put a `<div>foobar<div>` in the JSP to see if that works and it does) Is there another solution to make a redirection to an external URL ?

(The idea is to "stay" in the portlet/portal where the user can see the "targetted" website)

Regards.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-16T05:33:07.763

如果您查看[Portlet 2.0 规范](http://www.jcp.org/en/jsr/detail?id=286)的第 141 页，它提到 HttpServletRespone#sendRedirect() 在呈现阶段是一个 NO-OP。

所以这就是你看不到这个工作的原因。根据语义，响应对象是一个 HttpServletResponse，它对应于整个页面的响应，而不仅仅是该 JSP 所属的 portlet。由于页面现在是多个 portlet 的组合，并且每个 portlet 都有自己的生命周期，因此您应该使用 renderResponse、actionResponse 对象之一，并避免使用 servlet 对象。

不过，我还没有找到解决您原来问题的方法。

# math - Math: removing a digit from a number

> ID：10936210
> 
> 赞同：1
> 
> 时间：2012-06-07T16:46:47.227
> 
> 标签：math, digit

Let's say that I have the following number: `1286` now I want to remove the last digit `6` and end up with the first 3 digits `128` only. I also would like to do this using the number `6` and the number `1286` only as inputs.

Also if there is a c# solution would be great. Thanks

**Edit:** I want to do this using a math equation between the 6 and the 1286, I already know how to parse strings, which is not what I'm after.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-10-26T19:19:06.707

请尝试以下代码：（这仅使用数学函数完成，我也不懂 C#）

```
 java.util.Scanner s=new java.util.Scanner(System.in);
    int last=s.nextInt();
    int firstNumber=s.nextInt();
    int ans=0;
    loop:
    for(int temp=firstNumber,i=0;temp>0;temp/=10)
    {
        if(temp%10==last){ans=temp/10;while(i>0){ans=ans*10+(i%10);i/=10;} break loop;}
        i=i*10;
        i=i+(temp%10);
    }
    if(ans>0)System.out.println(ans);

    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:54:16.730

```
string input = "OneTwoThree";

// Get first three characters
string sub = input.Substring(0, 3); 
```

`sub`现在将有字符串中的前 3 个字符，0 是开始位置，然后你想要多少个字符（即：3） - 这是 (0, 3) 进入它的地方 - 如果你有 ( 3, 3), sub 等于 "Two"

我想这可能是你正在寻找的:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-10-12T17:24:51.103

在 JavaScript 中：这是您的电话号码：

```
var num = 1286; 
```

此行删除最后一位数字：

```
num % 10; //returns 6 
```

这两行删除了 6：

```
num /= 10 // turns num to 128.6
num = Math.trunc(num) // num now equals 128 
```

更好的是，您可以将它放在一个函数中，如下所示：

```
function sumOfDigits(num) {
  const sumArr = [];
  while (num > 0) {
    sumArr.push(num % 10);
    num /= 10;
    num = Math.trunc(num);
  }
  return sumArr.reduce((a, b) => a + b, 0);
}

sumOfDigits(1234);
// returns 10 
```

希望这可以帮助。

# statistics - How to know which users are logged in on TYPO3

> ID：10936212
> 
> 赞同：0
> 
> 时间：2012-06-07T16:46:51.447
> 
> 标签：statistics, typo3

Does anyone know if there is a way to do this, or an extension that displays who is logged in at the Front End and at the Back End.

Something that displays a list of the logged-in users (both fe_users and be_users).

Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-12T07:05:59.103

在 TYPO3 中，您还可以实时查看谁在线：

1.  **以管理员**身份连接
***   单击**管理工具**部分中的**用户管理*****   通过**在线列出用户**更改**比较用户设置******

 ******您将看到**谁在线**。

检查演示站点以尝试：[http ://demo.typo3.org](http://demo.typo3.org)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:54:02.247

every user has his own session. Table be_session. Look at it. you got every info you need******

# javascript - node.js 服务器未运行

> ID：10936214
> 
> 赞同：3
> 
> 时间：2012-06-07T16:47:00.293
> 
> 标签：javascript, node.js

我正在尝试学习 node.js，但我无法让简单的服务器在`localhost:8888`.

这是 server.js 的代码：

```
var http = require("http");

http.createServer(function(request, response) {
response.writeHead(200, {"Content-Type": "text/plain"});
response.write("Hello World");
response.end();
}).listen(8888); 
```

server.js 运行没有错误，并`netstat -an | grep 8888`从终端尝试返回

```
tcp4 0 0 *.8888 *.* 听
```

但是，当我在浏览器中访问 localhost:8888 时，它说找不到。

我已经查看了所有相关问题，但到目前为止没有任何效果。我尝试了不同的端口等。我知道我的路由器阻止了端口 8888 上的传入流量，但如果我尝试在本地访问它，这不重要吗？例如，我以前在这个端口上运行过 Tomcat 服务器。非常感谢你的帮助！

**node.js 版本：** v0.6.15
**操作系统：** Mac OS 10.6.8

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T18:01:44.233

这段代码有效——我刚刚尝试过并导航到 localhost:8888 并看到了预期的输出。

您的防火墙可能过于严格，或者您的 Node.js 安装错误。

# c# - 属性和字段的强类型序列化的方法扩展

> ID：10936215
> 
> 赞同：0
> 
> 时间：2012-06-07T16:47:00.897
> 
> 标签：c#, serialization, reflection

我正在尝试创建一个用于序列化对象的实用程序函数，通常，序列化会发生如下：

```
[Serializable]
public CoolCat : ISerializable
{
    public string Name;

    public void CoolCar(SerializationInfo info, StreamingContext context)
    {
        Name = (string)info.GetValue("Name", typeof(string));
    }

    public void GetObjectData(SerializationInfo info, StreamingContext context)
    {
        info.AddValue("Name", Name);
    }
} 
```

但是，我希望能够执行以下操作：

```
[Serializable]
public CoolCat : ISerializable
{
    public string Name;

    public void CoolCar(SerializationInfo info, StreamingContext context)
    {
        Name = info.GetValue<string>(() => Name);
    }

    public void GetObjectData(SerializationInfo info, StreamingContext context)
    {
        info.AddValue<string>(() => Name);
    }
} 
```

我用以下两种方法做到这一点：

这个用于反序列化值：

```
public static T GetValue<T>(this SerializationInfo Source, Expression<Func<T>> MemberExpression)
{
    string Name = ((MemberExpression)MemberExpression.Body).Member.Name;
    return (T)Source.GetValue(Name, typeof(T));
} 
```

而这个用于序列化值：

```
public static void AddValue<T>(this SerializationInfo Source, Expression<Func<T>> MemberExpression)
{
    MemberExpression Body = MemberExpression.Body as MemberExpression;

    if (Body == null)
    {
        UnaryExpression UnaryBody = MemberExpression.Body as UnaryExpression;

        if (UnaryBody != null)
        {
            Body = UnaryBody.Operand as MemberExpression;
        }
        else
        {
            throw new ArgumentException("Expression is not a MemberExpression", "MemberExpression");
        }
    }

    string Name = Body.Member.Name;

    if (Body.Member is FieldInfo)
    {
        T Value = (T)((FieldInfo)Body.Member).GetValue(((ConstantExpression)Body.Expression).Value);
        Source.AddValue(Name, Value, typeof(T));
    }
    else if (Body.Member is PropertyInfo)
    {
        T Value = (T)((PropertyInfo)Body.Member).GetValue(((ConstantExpression)Body.Expression, null);
        Source.AddValue(Name, Value, typeof(T));
    }
    else
    {
        throw new ArgumentException("Expression must refer to only a Field or a Property", "MemberExpression");
    }
} 
```

尝试从 Body.Member 作为属性时获取值时出现异常（当它是字段时，它工作正常）。我怎样才能得到这个？

其他问题 - 1) 我采用的方法有什么问题吗？2）有没有更好的方法来处理这整个事情？3) Body.Member 什么时候是 FieldInfo，什么时候是 PropertyInfo？

这是我以前的问题的扩展[在这里](https://stackoverflow.com/questions/10899071/get-the-name-of-a-field-from-a-class-without-an-instance)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:57:46.993

`AddValue`方法一定要这么复杂吗？我认为以下内容也可以。它不使用反射，而是编译和评估 lambda 表达式以获取值。

```
public static void AddValue<T>(
    this SerializationInfo source, 
    Expression<Func<T>> memberExpression)
{
    MemberExpression body = memberExpression.Body as MemberExpression;
    string name = body.Member.Name;
    Func<T> valFunc = memberExpression.Compile();
    T val = valFunc();

    source.AddValue(name, val, typeof(T));
} 
```

**编辑**：为了满足性能敏感的情况，我通常用两个重载定义扩展方法：

```
public static void AddValue<T>(
    this SerializationInfo source,
    Expression<Func<T>> memberExpression)
{
    Func<T> valFunc = memberExpression.Compile();
    T val = valFunc();

    source.AddValue(val, memberExpression);
}

public static void AddValue<T>(
    this SerializationInfo source,
    T val,
    Expression<Func<T>> memberExpression)
{
    MemberExpression body = memberExpression.Body as MemberExpression;
    string name = body.Member.Name;

    source.AddValue(name, val, typeof(T));
} 
```

这样，您可以调用以下任一选项：

```
// Inefficient, since it requires compilation of lambda expression:
info.AddValue<string>(() => Name);

// Faster, but requires you to specify two parameters.
info.AddValue<string>(Name, () => Name); 
```

后一种重载在其参数中具有一定程度的冗余，但会解决您的性能问题（实际上比基于反射的实现更快），同时仍然保持重构安全。

# sql - SQL 语句显示的行数多于表的行数

> ID：10936222
> 
> 赞同：1
> 
> 时间：2012-06-07T16:47:32.053
> 
> 标签：sql, oracle

所以我刚刚遇到了一些有趣的事情，我不知道以前是否有人回答过，因为我不知道它叫什么。假设您有两张桌子；第一个有一行，第二个有两行。如果您运行以下语句：

```
SELECT t1.*
FROM table1 t1, table2 t2 
```

它返回两行，并且都具有相同的值，但第一个表只有一行！为什么会出现这种情况？如果您没有相应地更改 select 子句，我认为 from 子句中的另一个表不会改变任何内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T16:49:07.803

您正在选择两个表的[**笛卡尔积**](http://en.wikipedia.org/wiki/Cartesian_product)。

它将返回`COUNT(t1) * COUNT(t2)`记录：来自的记录`t1`与来自的记录的所有可能组合`t2`。

使用`ANSI`语法，您的查询将读取为：

```
SELECT  t1.*
FROM    table1 t1
CROSS JOIN
        table2 t2 
```

# java - java callback, unscribe listener inside of interface implementation

> ID：10936223
> 
> 赞同：1
> 
> 时间：2012-06-07T16:47:34.050
> 
> 标签：java, callback

I would like to implement system of callbacks which looks like this (pseudo code):

```
final Listener listener = ListenerCtrl.addListener(new Listener() {
  void onNotify(String response){
    ListenerCtrl.unsetListener(listener);
} } 
```

This code mean that after received message, i want to unscribe from future notifications. I found very attractive have this action inside of callback.

Here is my actual implementation:

```
final WebServiceMsgListener wml = new WebServiceMsgListener()
{
  public void onMsgNotify(JSONObject response, int ecode)
  {
    Log.v(TAG, "getSetStateProgressBar MSG_MGT_STATICINFO: onMsgNotify ecode" +
       ecode);
    authDelegate.unsetMsgListener(wml);
  }
};

authDelegate.addMsgListener(NAOMsg.MSG_MGT_STATICINFO, wml); 
```

Unfortunately, my current implementation show me eclipse error:*"The local variable wml may not have been initialized"*

Question: how I can get round this, to finally unscribe inside of callback and dont have this error ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:51:54.460

将您的代码更改为：

```
authDelegate.unsetMsgListener(this); 
```

`this`指当前对象（`onMsgNotify()`在执行此语句时正在执行该对象）。

*注意*：虽然该变量`wml`可用于新对象，但在创建对象时尚未初始化，因此出现错误。它在对象完全创建后立即初始化。

# eclipse - IvyDE Resolve Dependencies in workspace with a Dynamic Web project in Eclipse

> ID：10936224
> 
> 赞同：2
> 
> 时间：2012-06-07T16:47:34.337
> 
> 标签：eclipse, tomcat, ivy, ivyde

I have a large application with many eclipse (actually using Spring Source Toolsuite) projects with ivy managed dependencies for each project. We currently have it setup and working where you can have project A (a dynamic web project that generates a war) and project B (generates a jar) setup such that project A depends on project B and if you only have project A in your workspace, it will go pull the jar file generated by project B from the ivy repository. We setup the deployment assembly to take the eclipse library generated from the ivy resolve and put it in the WEB-INF/lib directory so we can easily deploy to tomcat.

With the manual process, all of this works. I can make a change to project B, publish it to my local ivy repository, and re-resolve the dependencies on project A, and I get the new project B jar file and everything compiles and updates on tomcat as expected.

The problem I'm having comes when I change the ivy resolve settings of project A to "Resolve dependencies in workspace". When I make changes in project B, project A successfully notices the change and compiles correctly, but the deployment assembly breaks. When I go look in tomcat, it has a folder for project A's context root, but it is empty. If I uncheck the "Resolve dependencies in workspace" checkbox, the context root folder gets populated and everything returns to a working state.

I can continue doing the manual process, but it is a huge timesavings if I can get ivy to use my workspace first, then get the jar from the repository if the project does not exist in my workspace. Any suggestions would be greatly appreciated!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-29T20:24:04.827

解决方案是将 Utility Module facet 添加到项目 B（Project Properties->Project Facets->Utility Module），以便 eclipse 知道应该生成的 jar 文件的结构。

# rest - REST 参数与 URI

> ID：10936229
> 
> 赞同：0
> 
> 时间：2012-06-07T16:48:02.253
> 
> 标签：rest, uri

我只是在学习 REST 并试图弄清楚如何在实践中应用它。我有一个要查询的数据样本，但我不确定这些 URL 是如何形成的，即我将查询放在哪里。例如查询最近的 100 条数据记录：

```
GET http://data.com/data/latest/100
GET http://data.com/data?amount=100 
```

前两个查询哪个更好，为什么？以下内容也是如此：

```
GET http://data.com/data/latest-days/2
GET http://data.com/data?days=2
GET http://data.com/data?fromDate=01-01-2000 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:56:21.467

这真的取决于很多事情。如果您使用任何类型的 MVC 框架，您将使用 URI 段来定义您对 API 的获取请求，这是我个人更喜欢的。

这两种方式都不是什么大问题，这完全取决于偏好以及您希望 URL 对您的用户的可预测性。在某些情况下，我会说使用 REST 参数，但如果您的设置支持，基于 URI 的 GET 通常会非常干净。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T17:04:33.280

就个人而言，在这种情况下，我会使用查询字符串格式。如果您的`/data`路径正在返回所有数据，并且您希望执行这种类型的查询，我相信这是最有意义的。您还可以传递查询字符串参数，例如`?since=01-01-2000`获取指定日期之后的条目或传递列名，例如`?category=clothing`检索类别等于服装的所有条目。

此外，您可能希望路径`/data/{id}`可以在给定其唯一 ID 的情况下检索某些条目。

# ruby-on-rails - 如何在 Rails 中动态更改格式渲染引擎？

> ID：10936232
> 
> 赞同：0
> 
> 时间：2012-06-07T16:48:12.247
> 
> 标签：ruby-on-rails, haml, erb

我的默认模板引擎是 haml，但如果我指定特定参数，我有时会将其更改为 erb？

例如，我正在粘贴一些 html 代码，并且只想在没有 HAML 抱怨其格式的情况下测试代码。

知道怎么做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:30:31.077

做类似的事情：

```
if params[:render_erb]
  render 'file.html.erb'
else
  render 'file.html.haml'
end 
```

并使用 ?render_erb=true 调用操作

或者

```
render "file.html.#{params[:render]}" ir params[:render] 
```

并调用它 ?render=haml 或 ?render=erb （或者什么都没有，它将使用默认值

在您正在使用的控制器操作结束时

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:55:03.480

你只需要将文件保存为`your_file.html.erb`而不是我错了`your_file.html.haml`吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:03:49.537

您可以在同一个应用程序中使用不同的模板，并且可以为视图、部分和布局使用不同的模板引擎[，](https://stackoverflow.com/questions/339130/how-do-i-render-a-partial-of-a-different-format-in-rails)但[据](https://stackoverflow.com/questions/6125265/using-layouts-in-haml-files-independently-of-rails)我所知，您不能在同一个模板文件中进出多个模板引擎。

如果您只想使用不同的模板语言删除一些代码，那么我会将其放在单独的部分中。在这种特殊情况下，这似乎是最简单的。

# iphone - CALayer on CATiledLayer, drawLayer:inContext never called

> ID：10936233
> 
> 赞同：1
> 
> 时间：2012-06-07T16:48:14.157
> 
> 标签：iphone, objective-c, ios, cocoa-touch, ipad

i have a UIView which display a PDF page using CATiledLayer, now i want to add another CALayer on TiledLayer to draw some annots, Please see the code below.

```
 + (Class)layerClass
    {
        return [TiledLayer class];
    }

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self)
    {
       TiledLayer *tiledLayer = (id)self.layer;
        tiledLayer.backgroundColor = [UIColor whiteColor].CGColor;
        NSAssert([tiledLayer isKindOfClass:[TiledLayer class]], @"self.layer must be CATiledLayer");

        drawingLayer = [CALayer layer];
        drawingLayer.frame = frame;
        //its crashing if set the delegate, if not drawLayer is never called.
        [drawingLayer setDelegate:self];
        [self.layer addSublayer:self.drawingLayer];

    }

}

- (void)drawLayer:(CALayer*)layer inContext:(CGContextRef)context
{
    if(layer == [self layer])
   {
     [self drawPDFPage];
     [drawingLayer setNeedsDisplay];
   }
   else if(layer == drawingLayer)
   {
     //this one is never called.
     [self drawSomethinghere];
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T15:08:58.000

UIView 使用 -drawRect: 的存在来确定它是否应该允许其 CALayer 无效，这将导致层创建后备存储和 -drawLayer:inContext: 被调用。

实现一个空的 -drawRect: 方法允许 UIKit 继续实现这个逻辑，同时在 -drawLayer:inContext: 内部做真正的绘图工作。

只需添加到您的类实现：

```
-(void)drawRect:(CGRect)r
{

} 
```

你的 drawLayer 方法应该可以工作。

# asp.net - 无法访问生产服务器上的用户 Active Directory 密码信息

> ID：10936241
> 
> 赞同：0
> 
> 时间：2012-06-07T16:48:37.093
> 
> 标签：asp.net, asp.net-mvc, active-directory, ldap

我正在开发一个 MVC 应用程序，我有一个获取当前登录用户密码信息的例程，它在我的 PC 上运行良好，但是当我将我的应用程序发布到域上的实时服务器时，我似乎无法以访问 AD 信息。我在当前运行的 asp.net web 应用程序中使用了非常相似的代码，它工作得很好。我比较了两个应用程序的安全设置，它们看起来相同。这是例程：

```
 public int GetPasswordExpiration()
    {
        PrincipalContext domain = new PrincipalContext(ContextType.Domain);
        string currUserName = WindowsIdentity.GetCurrent().Name;
        UserPrincipal currLogin = UserPrincipal.FindByIdentity(domain, currUserName);
        DateTime passwordLastSet = currLogin.LastPasswordSet.Value; //here is where it chokes***
        int doyPasswordSet = passwordLastSet.DayOfYear;
        int doy = DateTime.Today.DayOfYear;
        int daysSinceLastset = (doy - doyPasswordSet);
        int daysTilDue = (120 - daysSinceLastset);
        return (daysTilDue);

    } 
```

我是域的管理员，所以我认为我有一个应用程序权限问题，但由于失败的应用程序与工作应用程序具有相同的权限，我不确定下一步该往哪里看。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-13T00:57:26.553

我正在回答我自己的问题，因为我想发布有效的代码。Wiktor Zychla 在询问 WindowsIdentity.GetCurrent().Name 是否应用于应用程序池的身份而不是登录用户时指出了这一点。事实上，它确实做到了，感谢 Wiktor！

这是修改后的代码。我确实改变了获取用户身份的方式（解释如下）。

**控制器代码：**

```
using MyProject.Utilities;  // Folder where I created the CommonFunctions.cs Class

var cf = new CommonFunctions();
string user = User.Identity.Name;
ViewBag.PasswordExpires = cf.GetPasswordExpiration(user); 
```

**CommonFunctions 中的代码**

```
public int GetPasswordExpiration(string user)
    {
        PrincipalContext ctx = new PrincipalContext(ContextType.Domain);
        UserPrincipal currLogin = UserPrincipal.FindByIdentity(ctx, user);
        DateTime passwordLastSet = currLogin.LastPasswordSet.Value;
        int doyPasswordSet = passwordLastSet.DayOfYear;
        int doy = DateTime.Today.DayOfYear;
        int daysSinceLastset = (doy - doyPasswordSet);
        int daysTilDue = (120 - daysSinceLastset);
        return (daysTilDue);

    } 
```

让我想到的一件事是，我决定只运行控制器中的所有代码，当我这样做时，我得到了一条红色波浪线，上面写着“WindowsIdentity 的名称在此上下文中不存在”：

字符串 currUserName = *WindowsIdentity* .GetCurrent().Name;

此外，我在 Controller 中检索 User.Identity.Name 并将其传递给函数的原因是，一旦我开始工作并想要精简我的控制器，我试图在函数中获取 User.Identity.Name 但我得到了在此行中的用户下另一个带有相同消息的红色波浪线： string user = User.Identity.Name; 所以我认为这是一个 .net 的东西，只是在控制器中获取 User.Identiy.Name ，将它传递给函数，一切都很好。这个真的考验了我的耐心，我希望这篇文章可以帮助别人。

# javascript - 如何更正 NginX 反向代理配置中的 Meteor base-url？

> ID：10936242
> 
> 赞同：5
> 
> 时间：2012-06-07T16:48:40.087
> 
> 标签：javascript, nginx, reverse-proxy, meteor, base-url

我已经通过反向代理（在 Ubuntu 服务器上）在 NginX 后面安装了 Apache 和 Meteor。Apache 直接映射为 baseURL (www.mydomain.com/)，Meteor 映射为子文件夹 (www.mydomain.com/live/)。

我遇到的问题是我的 Meteor 测试（在端口 3000 上按预期工作）停止在 NginX 后面工作，因为每个引用（CSS、Javascript、模板）都是 baseURL 的绝对引用。

```
<html>
<head>
  <link rel="stylesheet" href="/live.css?abc">
  <script type="text/javascript" src="/packages/underscore/underscore.js?efg"></script>
  ...
  <script type="text/javascript" src="/template.live.js?hij"></script>
  <script type="text/javascript" src="/live.js?klm"></script>
</head> 
```

显然，由于 Apache 是在 baseURL 上映射的，所以通过 NginX 测试时找不到这些文件。

解决问题的最佳方法是什么？系统管理不是我的强项，Meteor 是我第一次接触服务器端 javascript。所以我什至不知道这是否可以修复，如果可以，是通过服务器配置、Meteor 配置还是以编程方式完成。

* * *

编辑：Meteor 0.4.0 中新的“absolute-url”包解决了这个问题！

[http://docs.meteor.com/#absoluteurl](http://docs.meteor.com/#absoluteurl)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-05T15:18:55.773

Meteor 0.4.0 中新的“absolute-url”包解决了这个问题。

[http://docs.meteor.com/#absoluteurl](http://docs.meteor.com/#absoluteurl)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-07-16T15:15:41.000

为什么在`<head>`Meteor 中包含脚本和样式？您的流星项目目录中包含的任何内容，无论是 js、html 还是 css，都将被捆绑并提供给客户端，而不会使用 和 包含在您的 HTML`<link>`中`<script>`。

如果你必须在你的文件中包含一些东西`<head>`，为什么不使用包含子文件夹的绝对路径呢？

```
<html>
<head>
  <link rel="stylesheet" href="/live/live.css?abc">
  <script type="text/javascript" src="/live/packages/underscore/underscore.js?efg"></script>
  ...
  <script type="text/javascript" src="/live/template.live.js?hij"></script>
  <script type="text/javascript" src="/live/live.js?klm"></script>
</head> 
```

如果我误解了这个问题，请原谅我。

# ios - 内存不足opengl

> ID：10936244
> 
> 赞同：1
> 
> 时间：2012-06-07T16:48:44.543
> 
> 标签：ios, xcode, memory, memory-management, opengl-es

每时每刻我都有 3 个 25mb*3 的重帧缓冲区，然后我卸载一个，然后加载另一个。我的应用程序因内存不足警告而崩溃。但是在 xcode 的分配工具中，我每次看到 90mb 的已用内存。在具有 500mb RAM 的 ipad2 上测试。问题出在哪里？谢谢。

# android - Android用户界面元素使用

> ID：10936249
> 
> 赞同：0
> 
> 时间：2012-06-07T16:49:01.817
> 
> 标签：android, xml, user-interface

*我确实在互联网上搜索过我的问题的答案，但没有任何网站可以帮助我，所以我希望有人可以！提前谢谢你，祝你有美好的一天:-)*

所以这些天我一直忙于深入了解 Android 设计指南，了解更多关于它以及如何在我未来的应用程序中实现它的信息。这是我用来查看指南内容的主要网站：http: [//developer.android.com/design/index.html](http://developer.android.com/design/index.html)。很棒的网站，但是我在开发指南或其他地方找不到一些小东西。我只是不知道如何实现一些（简单的）UI 元素。

**有人可以提供以下问题的代码片段吗？**（我想知道如何尽可能简单地做到这一点，谷歌如何修改它！）它也可以帮助其他（开始）开发人员！

我的主要问题是，是否有特殊元素可以实现这些目标？由于它们是 Android 4.0 中的关键元素，它应该将这些东西作为一些标准吗？

1) Android 4.0 在新主题中大量使用带有分隔符的标题，而且看起来很棒。但我找不到如何简单地实现这个元素。我想知道的是如何使这个带有灰色分隔线的蓝色标题文本看起来像这张图片：

![带分隔线的蓝色标题！](../Images/50577a0fac097431379628ada239e6b7.png)

2）一般如何制作部分分隔符？像这张图片：

![部分分隔符](../Images/01c4a2466f8283daee174a24e57c345e.png)

3）如何制作带有部分分隔符的列表，并在其名称下为列表项提供 2 行解释，如下所示：

![列表显示](../Images/14553e7d825f7c885b30e529916dabfc.png)

*我确实在互联网上搜索过我的问题的答案，但没有任何网站可以帮助我，所以我希望有人可以！提前谢谢你，祝你有美好的一天:-)*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:43:55.497

在大多数情况下，您将不得不这样做是创建自定义布局。我尝试以`people`这种方式重新创建应用程序的外观。在大多数情况下，您想要的外观与`PreferenceActivity`视图相似。这为您提供了最后一张图像的外观，以及它可能是如何在`People`应用程序中通过一些额外的编程完成的。我只是发现创建自己的布局更容易，而不是试图弄乱它。

据我所知，api 中没有任何内容可以轻松创建您想要做的事情，而自定义布局将成为可行的方法。

像您在开头显示的自定义对话框布局非常简单，如果您不知道如何操作布局，我将从那里开始。查找 android 颜色样本以获取该蓝色的颜色

**编辑**

你可以做的另一件事是查看`People`源代码，看看他们是如何做到的，但是当你可以做一个布局时，它可能会比它的价值更痛苦

# c++ - C++项目兼容多个版本的boost

> ID：10936251
> 
> 赞同：1
> 
> 时间：2012-06-07T16:49:07.480
> 
> 标签：c++, boost, backwards-compatibility, autoconf, boost-filesystem

我正在开发一个 C++ 项目，并进行了一些更改以使其与 boost 1.46（突触在 Oneiric 上安装的默认版本）兼容，但我也想让它与旧版本的 boost 正确编译。如何根据正在使用的版本提升有不同的代码。是否配置文件（由 autoconf 生成）#DEFINE 一些变量来指示哪个？此外，我不完全确定在哪个版本中引入了此特定更改。

这是我要集成的两个版本的差异，基于 boost 版本：

```
diff --git a/src/util/Misc.cpp b/src/util/Misc.cpp
index 467144d..a9738aa 100644
--- a/src/util/Misc.cpp
+++ b/src/util/Misc.cpp
@@ -28,7 +28,7 @@ void MiscUtil::FindProgramDir(int argc, char* argv[])
 {
     if (argc == 0 || argv == 0)
         return;
-    programDir = path(argv[0], native).branch_path();
+    programDir = path(argv[0]).branch_path();
 }

 void MiscUtil::WordToBytes(unsigned word, byte* out)
@@ -70,7 +70,7 @@ std::string MiscUtil::OpenFile(std::string name, std::ifstream& f)
     {
         path p = programDir / name;
         p.normalize();
-        programDirFile = p.native_file_string();
+        programDirFile = p.string();
         f.open(programDirFile.c_str());
         if (f.is_open())
             return programDirFile;
@@ -78,7 +78,7 @@ std::string MiscUtil::OpenFile(std::string name, std::ifstream& f)
     {
         path p = boost::filesystem::path(ABS_TOP_SRCDIR) / "share" / name;
         p.normalize();
-        absFile = p.native_file_string();
+        absFile = p.string();
         f.open(absFile.c_str());
         if (f.is_open())
             return absFile;
@@ -86,7 +86,7 @@ std::string MiscUtil::OpenFile(std::string name, std::ifstream& f)
     {
         path p = boost::filesystem::path(DATADIR) / name;
         p.normalize();
-        dataFile = p.native_file_string();
+        dataFile = p.string();
         f.open(dataFile.c_str());
         if (f.is_open())
             return dataFile; 
```

我对 autoconf 不是很熟悉，这不是我的代码，是别人的。对这里发生的事情的任何解释将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T16:56:23.807

Boost 有“version.hpp”，其中包含可用于区分不同版本的 boost 的定义。它在[标题](http://www.boost.org/doc/libs/1_49_0/boost/version.hpp)本身中进行了解释。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-07T16:56:52.173

使用 Boost 版本号进行条件编译：

```
#include <boost/version.hpp>

#if BOOST_VERSION / 100 % 1000 == 46
// 1.46 version
    programDir = path(argv[0], native).branch_path();
#else
// older version
    programDir = path(argv[0]).branch_path();
#endif 
```

# java - 使用 JPA 关系映射的 EJB 3 持久性

> ID：10936256
> 
> 赞同：0
> 
> 时间：2012-06-07T16:49:12.597
> 
> 标签：java, mysql, jpa, persistence, ejb

我有两个实体：

语料库实体：

```
@Entity(name = "CORPUS")
public class Corpus implements Serializable {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "ID")
    private Long id;

    @OneToMany(mappedBy = "corpus", cascade = CascadeType.ALL, fetch = FetchType.LAZY)
    private Collection<CorpusHistory> corpusHistories;

    //Setters and getters...
} 
```

语料库历史实体：

```
@Entity(name = "CORPUS_HISTORY")
public class CorpusHistory implements Serializable {

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    @Column(name = "ID")
    private Long id;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name="CORPUS_ID")
    private Corpus corpus;

    //Setters and getters...
} 
```

语料库实体可以有许多语料库历史记录，所以我用`@OneToMany`. 我希望使用语料库 ID 完成映射，因此我在语料库历史实体中使用`@JoinColumn(name="CORPUS_ID")`和`@ManyToOne`注释。

在将语料库对象保存到数据库之前，我将语料库历史集合设置为它：

```
LinkedList<CorpusHistory> corpusHistories = new LinkedList<CorpusHistory>();
for (Change change : changes) {
    CorpusHistory corpusHistory = new CorpusHistory();
    //corpusHistory.setCorpusId(String.valueOf(corpusId)); ?????
    corpusHistory.setRevisionAuthor(change.getName());
    corpusHistory.setRevisionDate(change.getWhen());
    corpusHistory.setRevisionNote(change.getNote());
    //corpusHistoryFacade.create(corpusHistory);
    corpusHistories.add(corpusHistory);
}

corpus.setCorpusHistories(corpusHistories); 
```

记录已创建，一切正常，但在语料库历史表中，CORPUS_ID 列始终为空。当我从数据库中检索语料库时，历史列表是空的。如果尚未创建语料库记录，我不明白如何将语料库 ID 指定到语料库历史记录？

这不是 EJB 的工作吗？使用`@OneToMany`和`@ManyToOne`映射适当的 ID 应该被映射并存储到适当的列中（在这种情况下，语料库 id 应该存储在语料库历史列 CORPUS_ID 的每条记录中）。

或者我在这里误解了什么？我尝试了很多教程，没有成功......我被困在这里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:19:19.480

```
for (Change change : changes) {
    CorpusHistory corpusHistory = new CorpusHistory();
    corpusHistory.setCorpus(corpus);
    ...
} 
```

拥有者一方是没有 mappedBy 属性的一方。您必须初始化所有者方以便告诉 JPA 关联存在。由于您在 corpus.histories 上有级联，因此当您持久化语料库时，JPA 也会持久化历史记录。

# java - 如何设置不可变字段

> ID：10936257
> 
> 赞同：0
> 
> 时间：2012-06-07T16:49:28.063
> 
> 标签：java

```
 private static final Class<? extends UserManager> type;

  private static void setType(final Class <? extends UserManager> theType){
      if(type == null) type = theType;
      else throw new IllegalStateException("Type already set.");
  } 
```

我想让上面的东西工作，但它不会编译，因为`type`没有`final`人知道如何在 Java 中做到这一点？可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T16:51:18.897

这本质上是不可能的。
`final`表示初始化完成后*无法更改。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:53:12.080

默认情况下这是不可能的，但是使用反射:)一切都是可能的

```
 Field modifiersField = Field.class.getDeclaredField("modifiers");
      modifiersField.setAccessible(true);
      modifiersField.setInt(field, field.getModifiers() & ~Modifier.FINAL);

      field.set(null, newValue); 
```

# c++ - C++：为初始化的多维向量声明的宏？

> ID：10936260
> 
> 赞同：1
> 
> 时间：2012-06-07T16:49:43.727
> 
> 标签：c++, macros

初始化多维向量的一种方法是：

```
vector<vector<... vector<int> > >
  v(D1, vector<vector... <int> >
   (D2, vector<...vector<int>>
    ...
   (DN-1, vector<int>(DN, X))...); 
```

（点不是代码的一部分）

将使用值 X 初始化 D1 x D2 x ... x DN 向量。

是否可以以某种方式将其包装在宏中，以便我可以说：

```
DECL_VECTOR(v, X, D1, D2, ..., DN); 
```

你会如何定义 DECL_VECTOR ？

**注意：**这当然不是用于生产代码，它是编程竞赛模板的简写宏。

# c# - How to break apart a URI in WP7?

> ID：10936266
> 
> 赞同：3
> 
> 时间：2012-06-07T16:50:26.883
> 
> 标签：c#, silverlight, windows-phone-7, query-string

Is there a method for accesing Query parameters in the WebBrowser control or do we have to manually break apart the string? For example:

```
http://www.mysite.com?paramter=12345 
```

I simply need to access the value of parameter. I know when working with xaml pages we have the have the QueryString property. Is there something similar for working with web pages?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T19:13:44.203

I can't remember where I got this, possibly SO.

```
 public static class UriExtensions
    {
        private static readonly Regex QueryStringRegex = new Regex(@"[\?&](?<name>[^&=]+)=(?<value>[^&=]+)");

        public static IEnumerable<KeyValuePair<string, string>> ParseQueryString(this Uri uri)
        {
            if (uri == null)
                throw new ArgumentException("uri");

            var matches = QueryStringRegex.Matches(uri.OriginalString);
            for (var i = 0; i < matches.Count; i++)
            {
                var match = matches[i];
                yield return new KeyValuePair<string, string>(match.Groups["name"].Value, match.Groups["value"].Value);
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-06T15:57:35.890

Some important optimizations from other answers:

*   handling a *#* in the Uri
*   handling possible missing value like *&name=* in the Uri
*   not forgetting `Uri.UnescapeDataString`
*   returning a `Dictionary` instead of a `IEnumerable` so one can find a desired parameter easily
*   explaining that `Uri.Query` is unreliable on WP7
*   comparing speed for best solution

With Regex (**slower than Split**):

```
static readonly Regex QueryStringRegex1 = new Regex(@"^[^#]*\?([^#]*)");
static readonly Regex QueryStringRegex2 = new Regex(@"(?<name>[^&=]+)=(?<value>[^&=]*)");
public static Dictionary<string, string> QueryDictionary(this Uri uri)
{
    return QueryStringRegex1.Match(uri.ToString())// between ? and #
        .Groups
        .Cast<Group>()
        .Select(a => QueryStringRegex2.Matches(a.Value)// between ? and &
            .Cast<Match>()
            .Select(b => b.Groups)
            .ToDictionary(b => Uri.UnescapeDataString(b["name"].Value), b => Uri.UnescapeDataString(b["value"].Value)))
        .ElementAtOrDefault(1)
        ?? new Dictionary<string, string>();
} 
```

With Split (**faster than Regex**, recommended solution):

```
static readonly char[] QueryStringSeparator1 = "#".ToCharArray();
static readonly char[] QueryStringSeparator2 = "?".ToCharArray();
static readonly char[] QueryStringSeparator3 = "&".ToCharArray();
static readonly char[] QueryStringSeparator4 = "=".ToCharArray();
public static Dictionary<string, string> QueryDictionary(this Uri uri)
{
    return uri.ToString()
        .Split(QueryStringSeparator1, StringSplitOptions.RemoveEmptyEntries)
        .Select(a => a.Split(QueryStringSeparator2, StringSplitOptions.RemoveEmptyEntries)
            .Select(b => b.Split(QueryStringSeparator3, StringSplitOptions.RemoveEmptyEntries)
                .Select(c => c.Split(QueryStringSeparator4))
                .Where(c => c[0].Length > 0)
                .ToDictionary(c => Uri.UnescapeDataString(c[0]), c => c.Length > 1 ? Uri.UnescapeDataString(c[1]) : ""))
            .ElementAtOrDefault(1))// after ?
        .FirstOrDefault()// before #
        ?? new Dictionary<string, string>();
} 
```

Note: on a Windows Phone 7 device, `Uri.Query` is **unreliable** for an Uri like "mailto:a@example.com?subject=subject&body=body". That's why we use `Uri.ToString()` (itself better than `Uri.OriginalString`). If you only want to handle "(http|https)://" or you want to optimize for a Windows Phone 8 device, you can find an optimized solution on [https://stackoverflow.com/a/25167971/1033581](https://stackoverflow.com/a/25167971/1033581).

If you want this `Uri.Query` optimization on a Windows Phone 8 device using a Windows Phone 7 app, you can check beforehand:

```
public static readonly bool IsVersion8 = Environment.OSVersion.Version >= new Version(8, 0); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T18:28:04.700

Unless someone else has another way of doing it, I was able to accomplish the same thing manually:

```
// The url looked something like this http://www.mysite.com?param1=value&param2=value
var parameterValue = e.Uri.Query.Split('&')
            .Where(s => s.Split('=')[0] == "param2")
            .Select(s => s.Split('=')[1])
            .FirstOrDefault(); 
```

I don't think this way is *bad*, I was just wondering if there was a built in method for this type of parsing because I know it existed in ASP.NET, .NET , etc.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-28T04:56:36.030

Inspired on the answer of a [similar question](https://stackoverflow.com/questions/15888883/is-there-a-simple-way-to-get-query-string-parameters-from-a-uri-in-windows-phone/15985000#15985000),

```
public static Dictionary<string, string> ParseQueryString(Uri uri)
{
    var substring = uri.Query;
    if (substring.Length > 0)
         substring.Substring(1);

    var pairs = substring.Split('&'); 
    var output = new Dictionary<string, string>(pairs.Length);

    foreach (string piece in pairs)
    {
        var pair = piece.Split('=');
        output.Add(
            Uri.UnescapeDataString(pair[0]),
            Uri.UnescapeDataString(pair[1]));
    }

    return output;
} 
```

# configuration-files - 如何在 extensions.conf 中的另一个全局变量中引用一个全局变量？

> ID：10936267
> 
> 赞同：1
> 
> 时间：2012-06-07T16:50:31.507
> 
> 标签：configuration-files, asterisk

在`extensions.conf`中，我可以在另一个全局变量中引用一个全局变量吗？

```
[globals]
GROUP1=SIP/3333&SIP/3334&SIP/3335
GROUP2=SIP/4442&SIP/4441&SIP/4442
GROUP3=SIP/5553&SIP/5550&SIP/5556 
```

像这样？

```
EMERGENCY=${GROUP1}&${GROUP2}&${GROUP3}|9999|30 
```

如果没有，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T03:11:22.567

是的，这是完全可行的。正如 arheops 所提到的，当以 RTL 顺序计算表达式时，变量的值被替换。

拨号方案示例：

```
[general]

[globals]

TEST1=SIP/111&SIP/222
TEST2=SIP/333&SIP/444
TEST_GROUP=${TEST1}&${TEST2}

[default]

exten => 1,1,NoOp()
    same => n,NoOp(${TEST1})
    same => n,NoOp(${TEST2})
    same => n,NoOp(${TEST_GROUP})
    same => n,Dial(${TEST_GROUP})
    same => n,Hangup()

exten => 2,1,NoOp()
    same => n,Wait(5)
    same => n,Hangup() 
```

使用来自 Asterisk 1.8 的新结帐的示例执行，显示变量值：

```
*CLI> channel originate Local/1@default extension 2@default
    -- Executing [1@default:1] NoOp("Local/1@default-505e;2", "") in new stack
    -- Executing [1@default:2] NoOp("Local/1@default-505e;2", "SIP/111&SIP/222") in new stack
    -- Executing [1@default:3] NoOp("Local/1@default-505e;2", "SIP/333&SIP/444") in new stack
    -- Executing [1@default:4] NoOp("Local/1@default-505e;2", "SIP/111&SIP/222&SIP/333&SIP/444") in new stack
    -- Executing [1@default:5] Dial("Local/1@default-505e;2", "SIP/111&SIP/222&SIP/333&SIP/444") in new stack 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-09T16:04:48.043

你不能。只需创建另一个逻辑或外部脚本来创建拨号计划文件

# java - 如何在 Java 中使用自动代理配置脚本

> ID：10936268
> 
> 赞同：10
> 
> 时间：2012-06-07T16:50:32.473
> 
> 标签：java, proxy, pac

我的 Internet Explorer 设置为具有用于 Web 访问的自动代理文件（所谓的 PAC）。有没有办法在我的 Java 程序上使用它？

我下面的 Java 代码似乎根本没有使用代理。

```
ArrayList<Proxy> ar = new ArrayList<Proxy>(ProxySelector.getDefault().select(new URI("http://service.myurlforproxy.com")));
for(Proxy p : ar){
  System.out.println(p.toString()); //output is just DIRECT T.T it should be PROXY.
} 
```

我还在 Java 控制面板（Control->Java）上设置了我的代理脚本，但结果相同。而且我发现无法以编程方式为 Java 设置 PAC 文件。

人们将 http.proxyHost 用于 System.setProperties(..) 但这仅用于设置代理主机，而不是代理脚本（PAC 文件）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-08T15:27:05.983

哇！我可以在 Java 上加载代理自动配置 (PAC) 文件。请参阅下面的代码和包装。

```
import com.sun.deploy.net.proxy.*;
.
.
BrowserProxyInfo b = new BrowserProxyInfo();        
b.setType(ProxyType.AUTO);
b.setAutoConfigURL("http://yourhost/proxy.file.pac");       
DummyAutoProxyHandler handler = new DummyAutoProxyHandler();
handler.init(b);

URL url = new URL("http://host_to_query");
ProxyInfo[] ps = handler.getProxyInfo(url);     
for(ProxyInfo p : ps){
    System.out.println(p.toString());
} 
```

您的机器上已经有一个 [com.sun.deploy.net.proxy] 包！查找 [deploy.jar] ;D

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T20:07:23.903

Java 没有对解析 JS PAC 文件的任何内置支持。你只能靠自己。您可以做的是下载该文件并从中解析代理主机。你应该读[这个](https://stackoverflow.com/questions/10324996/does-javas-proxyselector-not-work-with-automatic-proxy-configuration-scripts)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-25T00:21:56.777

就我而言，我刚刚弄清楚 .pac 文件将返回什么，然后进行硬编码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-29T11:22:22.607

根据@Jaeh 的回答，我使用了下面的代码。请注意，**SunAutoProxyHandler**实现了**AbstractAutoProxyHandler**并且有一个名为**PluginAutoProxyHandler**的替代具体实现，但该实现似乎并不那么健壮：

```
 BrowserProxyInfo b = new BrowserProxyInfo();
    b.setType(ProxyType.AUTO);
    b.setAutoConfigURL("http://example.com/proxy.pac");

    SunAutoProxyHandler handler = new SunAutoProxyHandler();
    handler.init(b);

    ProxyInfo[] ps = handler.getProxyInfo(new URL(url));
    for(ProxyInfo p : ps){
        System.out.println(p.toString());
    } 
```

# c# - 通过membershipprovider / forms身份验证跟踪所有登录

> ID：10936271
> 
> 赞同：1
> 
> 时间：2012-06-07T16:50:40.037
> 
> 标签：c#, asp.net-mvc-3, forms-authentication, membership-provider

我正在使用默认值`SqlMembershipProvider`并喜欢跟踪所有登录。使用用户名/密码登录没有问题，因为他们通过`AccountController`.

但是如何跟踪使用会员 cookie 进行的登录？

# magento - 新的 Magento 后端功能

> ID：10936272
> 
> 赞同：0
> 
> 时间：2012-06-07T16:50:40.803
> 
> 标签：magento, collections, module, adminhtml

我正在关注[本教程](http://www.excellencemagentoblog.com/admin-part1-series-magento-admin-forms-grids-controllers-tabs)。本教程不是 100% 完成的，需要用户填补一些空白。我很好。打破的部分是`$collection = Mage::getModel('employee/employee')->getCollection();`。我假设这是因为我要求 Magento 调用我需要定义的客户 getCollection 方法。我浏览了一遍，似乎找不到如何创建集合文件的示例。

谁能给我举几个例子？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T19:35:15.610

```
1) file in **app\code\local\NCM\Employee\etc\config.xml**
<?xml version="1.0"?>

    <config>
    <modules>
        <NCM_Employee>
            <version>0.1.0</version>
        </NCM_Employee>
    </modules>
    <frontend>
        <routers>
            <employee>
                <use>standard</use>
                <args>
                    <module>NCM_Employee</module>
                    <frontName>employee</frontName>
                </args>
            </employee>
        </routers>
        <layout>
            <updates>
                <employee>
                    <file>employee.xml</file>
                </employee>
            </updates>
        </layout>
    </frontend>
    <admin>
        <routers>
            <employee>
                <use>admin</use>
                <args>
                    <module>NCM_Employee</module>
                    <frontName>employee</frontName>
                </args>
            </employee>
        </routers>
    </admin>
    <adminhtml>
        <menu>
            <employee module="employee">
                <title>Employee</title>
                <sort_order>71</sort_order>               
                <children>
                    <items module="employee">
                        <title>Manage Items</title>
                        <sort_order>0</sort_order>
                        <action>employee/adminhtml_employee</action>
                    </items>
                </children>
            </employee>
        </menu>
        <acl>
            <resources>
                <all>
                    <title>Allow Everything</title>
                </all>
                <admin>
                    <children>
                        <NCM_Employee>
                            <title>Employee Module</title>
                            <sort_order>10</sort_order>
                        </NCM_Employee>
                    </children>
                </admin>
            </resources>
        </acl>
        <layout>
            <updates>
                <employee>
                    <file>employee.xml</file>
                </employee>
            </updates>
        </layout>
    </adminhtml>   
    <global>
        <models>
            <employee>
                <class>NCM_Employee_Model</class>
                <resourceModel>employee_mysql4</resourceModel>
            </employee>
            <employee_mysql4>
                <class>NCM_Employee_Model_Mysql4</class>
                <entities>
                    <employee>
                        <table>employee</table>
                    </employee>
                </entities>
            </employee_mysql4>
        </models>
        <resources>
            <employee_setup>
                <setup>
                    <module>NCM_Employee</module>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </employee_setup>
            <employee_write>
                <connection>
                    <use>core_write</use>
                </connection>
            </employee_write>
            <employee_read>
                <connection>
                    <use>core_read</use>
                </connection>
            </employee_read>
        </resources>
        <blocks>
            <employee>
                <class>NCM_Employee_Block</class>
            </employee>
        </blocks>
        <helpers>
            <employee>
                <class>NCM_Employee_Helper</class>
            </employee>
        </helpers>
    </global>
</config>

2) file in **app\code\local\NCM\Employee\Model\Employee.php**

    class NCM_Employee_Model_Employee extends Mage_Core_Model_Abstract
{
    public function _construct()
    {
        parent::_construct();
        $this->_init('employee/employee');
    }
}

3) file in **app\code\local\NCM\Employee\Model\Mysql4\Employee.php**

    class NCM_Employee_Model_Mysql4_Employee extends Mage_Core_Model_Mysql4_Abstract
{
    public function _construct()
    {    
        $this->_init('employee/employee', 'employee_id');
    }
}

4) file in **app\code\local\NCM\Employee\Model\Mysql4\Employee\Collection.php**

    class NCM_Employee_Model_Mysql4_Employee_Collection extends Mage_Core_Model_Mysql4_Collection_Abstract
{
    public function _construct()
    {
        parent::_construct();
        $this->_init('employee/employee');
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T13:03:58.227

谢谢 WojtekT。我的 etc/config.xml 中缺少这部分

```
 <models>
        <categoryrules>
            <class>Rogue_CategoryRules_Model</class>
            <resourceModel>categoryrules_mysql4</resourceModel>
        </categoryrules>
        <categoryrules_mysql4>
            <class>Rogue_CategoryRules_Model_Mysql4</class>
            <entities>
                <rules>
                    <table>rogue_category_rules</table>
                </rules>
            </entities>
        </categoryrules_mysql4>
    </models> 
```

# emacs - Emacs 宏在 .emacs 文件中有效，但在源文件中无效？

> ID：10936273
> 
> 赞同：2
> 
> 时间：2012-06-07T16:50:45.963
> 
> 标签：emacs, configuration, elisp

我有一个 emacs 宏 (global-set-key) 在我的 .emacs 文件中运行良好，但无论出于何种原因，它在我的 .c 文件中都无法运行。

`(global-set-key "\C-c\C-d" "\C-a\C- \C-e\M-w\C-j\C-y")`

如果我关闭并重新打开我的 .emacs 文件并开始搞乱，这个宏会按预期运行，将一行复制到下面的一行。但是，当我打开一个 C 文件时，相同的宏只会删除一个字符（它似乎只在 Cd 上拾取）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T20:43:46.330

cc-mode 定义`C-c C-d`为`c-mode-base-map`be `c-hungry-delete-forward`，它在全局级别隐藏您的绑定。因此，解决此问题的更好方法是*取消定义*所做的绑定，`cc-mode`您可以使用以下方法：

```
(eval-after-load "cc-mode"
  '(define-key c-mode-base-map (kbd "C-c C-d") nil)) 
```

您也可以在挂钩中执行此操作，但我更喜欢它，`eval-after-load`因为它只执行一次。

*注意：*我通过打开一个文件`c-mode`并输入`C-h C-k C-c C-d`(aka `M-x describe-binding C-c C-d`) 来确定现有的绑定，然后看到：

> Cc Cd 运行命令 c-hungry-delete-forward，它是 `cc-cmds.el' 中的交互式编译 Lisp 函数。

这清楚地表明绑定是在（其中一个）`c-mode`s中设置的，所以我只是打开（或`grep`编辑）源文件，`c-hungry-delete-forward`然后我发现：

```
(define-key c-mode-base-map "\C-c\C-d"     'c-hungry-delete-forward) 
```

然后答案是直截了当的。

我认为最好*取消定义*隐藏所需全局绑定的本地绑定，而不是*重新定义*它们。找到有问题的绑定同样需要做很多工作，这样如果您想更改全局绑定的功能，您只需在一个地方进行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T16:57:00.847

显然，C 模式正在删除绑定或更改绑定。您可以尝试将其添加到 c-mode-hook 中，然后查看它是否有效。与此类似：

```
(add-hook `c-mode-hook '(lambda ()
                         (global-set-key "\C-c\C-d" "\C-a\C- \C-e\M-w\C-j\C-y"))) 
```

要么`c-mode-hook`要么`c-mode-common-hook`。您也可以使用`local-set-key`而不是全局的来将绑定仅应用于此缓冲区。

# php - 使用 $_SESSION['url'] 让 checklogin.php 重定向到 index.php

> ID：10936276
> 
> 赞同：0
> 
> 时间：2012-06-07T16:51:07.253
> 
> 标签：php, session, redirect, login

我有一个 checklogin.php 脚本，它可以很好地将用户重定向到成功登录的特定页面。我现在想将其设置为重定向到将用户重定向到登录表单的原始 index.php 页面。在 index.php 的顶部，我包括：

```
<?php
session_start();

$_SESSION['url'] = $_SERVER['REQUEST_URI'];

if(!session_is_registered(myusername)){
header("location:main_login.php");
}
?> 
```

我已检查 $_SESSION['url'] 在此页面上的设置是否正确。

main_login.php 只包含由 checklogin.php 处理的登录表单：

```
<form name="form1" method="post" action="checklogin.php"> 
```

并且 $_SESSION['url'] 在此页面上也已正确设置。

checklogin.php 看起来像这样：

```
<?php
session_start();

print_r($_SESSION['url']);

ob_start();
$host="localhost"; // Host name 
$username=""; // Mysql username 
$password=""; // Mysql password 
$db_name=""; // Database name 
$tbl_name=""; // Table name 

// Connect to server and select databse.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

// Define $myusername and $mypassword 
$myusername=$_POST['myusername']; 
$mypassword=$_POST['mypassword']; 

// To protect MySQL injection (more detail about MySQL injection)
$myusername = stripslashes($myusername);
$mypassword = stripslashes($mypassword);
$myusername = mysql_real_escape_string($myusername);
$mypassword = mysql_real_escape_string($mypassword);
$encrypted_mypassword=md5($mypassword);
$sql="SELECT * FROM $tbl_name WHERE username='$myusername' and password='$encrypted_mypassword'";
$result=mysql_query($sql);

// Mysql_num_row is counting table row
$count=mysql_num_rows($result);

// If result matched $myusername and $mypassword, table row must be 1 row
if($count==1){

// Register $myusername, $mypassword and redirect to file "login_success.php"
session_register("myusername");
session_register("mypassword"); 
header("location:$_SESSION['url']");
}
else {
echo "Wrong Username or Password";
}
ob_end_flush();
?> 
```

如您所见，我试图在此脚本的顶部打印 $_SESSION['url'] 但没有返回任何内容。

有人可以帮忙吗？

谢谢，

缺口

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T18:19:39.660

您不能在文字字符串中插入像 $_SESSION['url'] 这样的“复杂”变量，如以下语句：

```
header("location:$_SESSION['url']"); 
```

在我的 PHP (5.3.10) 版本中，它会产生以下错误：

> PHP 解析错误：语法错误，意外的 T_ENCAPSED_AND_WHITESPACE，期待 /home/.../test.php 中的 T_STRING 或 T_VARIABLE 或 T_NUM_STRING 在线...

事实上，如果你想在一个数组中输出一个字段，你应该使用连接：

```
header("Location: " . $_SESSION['url']); 
```

这可能是您问题的根源。根据 PHP 配置，它可能不会显示错误而只是输出一个空白页面，请检查 php 日志以确保。

最佳实践是在您想在字符串中输出变量的值时使用它。

例如，不要使用`echo "Foo: $foo";`，而是使用`echo "Foo : ". $foo;`

# dpi - 使用 render() 控制图像输出的 DPI

> ID：10936277
> 
> 赞同：11
> 
> 时间：2012-06-07T16:51:10.583
> 
> 标签：dpi, phantomjs, rasterizing

使用[phantomjs](http://www.phantomjs.org)，有没有办法控制使用该`page.render(filename)`方法对 Web 内容的图像进行光栅化时使用的 DPI 设置？

我找不到任何可以通过[接口 api](http://code.google.com/p/phantomjs/wiki/Interface)控制它的东西，但不知道是否有人已经想出了一种方法来做到这一点。

我们的业务案例如下所示：

通过 Web 应用程序创建的自定义 HTML 内容被馈送到我们的 rasterize.js 幻像进程，并被查询特定标签以设置客户端矩形。此客户端矩形被渲染为 HTML 的 PNG，然后可以在其他地方用作图像。

我们希望生成的 PNG 的分辨率高于默认值，因为在一些奇怪的字体大小/粗体组合中文本出现锯齿。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T12:58:48.810

我可能将 DPI 与其他内容混合在一起，但您是否查看了[zoomFactor](http://code.google.com/p/phantomjs/wiki/Interface#zoomFactor_%28number%29)选项？在页面对象上设置它会导致渲染图像缩放。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-06T08:30:35.487

这个 fork 允许设置 dpi [https://github.com/martonw/phantomjs/tree/issue-%2313553](https://github.com/martonw/phantomjs/tree/issue-%2313553)

然后你可以设置dpi`page.dpi = 72`

```
console.log('Loading a web page');  
var page = require('webpage').create();
var url = 'http://phantomjs.org/';
page.open(url, function (status) {
  //Page is loaded!
  page.dpi=300; // this is where you actually set the DPI
  page.render("test.pdf");
  phantom.exit();
}); 
```

# symfony1 - 从更新的夹具文件中加载数据而不清除现有数据

> ID：10936281
> 
> 赞同：0
> 
> 时间：2012-06-07T16:51:35.373
> 
> 标签：symfony1, doctrine, symfony-1.4, sfguard

我安装了 sfGuard 插件，并设置了三个用户组和权限。这是在最初安装插件的时候做的，数据库里没有很多数据。我想添加一个具有新权限的新用户组。

我已经编辑了 fixtures 目录中的 sfGuard.yml 文件。如何在不清除当前数据的情况下将新的 yml 数据上传到 SQL 数据库？

这是 sfGuard.yml 片段：

```
sfGuardGroup:
  Group_univ_admin:
    name:           univ_admins
    description:    Universal Administrators
    Permissions:    [Permission_admin, Permission_universal]
  Group_univ_editor:
    name:           univ_editors
    description:    Universal Editors
    Permissions:    [Permission_editor, Permission_universal]
  Group_dept_admin:
    name:           dept_admins
    description:    Department Administrators
    Permissions:    [Permission_admin, Permission_department]
  Group_dept_editor:
    name:           dept_editors
    description:    Department Editors
    Permissions:    [Permission_editor, Permission_department]
  Group_dept_faculty:
    name:           dept_faculties
    description:    Department Faculties
    Permissions:    [Permission_faculty, Permission_department]

sfGuardPermission:
  Permission_admin:
    name:           administrator
    description:    Administrator permission
  Permission_editor:
    name:           editor
    description:    Editor permission
  Permission_universal:
    name:           universal
    description:    Universal permission
  Permission_department:
    name:           department
    description:    Department permission
  Permission_faculty:
    name:           faculty
    description:    Faculty permission 
```

任何方向都会很棒！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T19:39:24.300

我相信加载数据的标准夹具任务不会覆盖任何现有数据，只要您不重新构建数据库和模型：

```
php symfony doctrine:data-load data/fixtures/some_specific_file.yml 
```

I would recommend calling the fixtures filename explicitly (as above) to avoid accidentally including a fixtures file from elsewhere in the project structure. There are several places from which they can be included, such as the sfDoctrineGuardPlugin. Do of course also run this on a dev/local database before production to avoid screw-ups.

# c# - 如何在 mvc 中清除实体集合

> ID：10936283
> 
> 赞同：0
> 
> 时间：2012-06-07T16:51:41.080
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, entity-framework

使用带有剃刀视图引擎的 MVC3.0。我有一个名为“供应商”的实体，其中包含对另一个名为“联系人”的实体的多对多引用。我要做的就是从特定控制器中的供应商那里删除所有引用。这是我的代码：

```
public ActionResult _Edit(Vendor vendor)
    {
        if (ModelState.IsValid)
        {
            //Clear contact list
            vendor.Contacts.Clear();

            db.Vendors.Attach(vendor);
            db.ObjectStateManager.ChangeObjectState(vendor, EntityState.Modified);
            db.SaveChanges();
         }
    } 
```

由于某种原因，这不起作用。我不知道为什么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:16:11.240

您应该从数据库中加载供应商及其联系人，然后更新其属性和 SaveChanges：

```
var vendor = ...retrieve vendor from db...;
vendor.Contacts.Load();
vendor.Contacts.Clear();
...update vendor properties...
db.SaveChanges(); 
```

我知道它不如附加实体和保存状态有效，但没有人说 EF 是完美的。

顺便说一句，直接绑定到实体框架对象可能非常危险。恶意用户可以使用您为他提供的表单中不存在的值准备 POST 并更改字段的值，您甚至不想在此操作中对其进行修改。您应该创建特殊的视图模型。

# java - mappedBy 和 joinTable 在错误的类中

> ID：10936289
> 
> 赞同：0
> 
> 时间：2012-06-07T16:51:49.680
> 
> 标签：java, hibernate, many-to-many, seam

我使用 seam 来生成我的实体。但是我有一个多对多的复合表，其中包含一个员工 ID 和一个车辆 ID，它生成了错误的哈希集。我希望能够在员工对象中选择员工最喜欢的车辆。然而; 当我将内容添加到员工对象中的哈希集中并将其持久化时，它不会向复合表中添加任何内容。车辆对象具有

```
@ManyToMany(fetch = FetchType.LAZY, cascade = CascadeType.ALL)  
@JoinTable(name = "flower_store_emp_vehicle", schema = "dbo", catalog = "tyler", joinColumns = { @JoinColumn(name = "vehicle_id", nullable = false, updatable = false) }, inverseJoinColumns = { @JoinColumn(name = "employee_id", nullable = false, updatable = false) }) 
```

并且员工对象具有：

```
@ManyToMany(fetch = FetchType.LAZY, mappedBy = "flowerStoreEmployees") 
```

但是，我猜这些是倒退的；我是接缝新手，不知道如何在没有 mappedBy 完全错误的情况下切换它们。如果有人知道如何提供帮助，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:11:23.857

如果您希望员工成为关联的所有者，只需切换注释：

员工：

```
@ManyToMany(fetch = FetchType.LAZY, cascade = CascadeType.ALL)  
@JoinTable(name = "flower_store_emp_vehicle", 
           schema = "dbo", 
           catalog = "tyler", 
           inverseJoinColumns = { @JoinColumn(name = "vehicle_id", nullable = false, updatable = false) }, 
           joinColumns = { @JoinColumn(name = "employee_id", nullable = false, updatable = false) })
private Set<Vehicle> vehicles; 
```

车辆：

```
@ManyToMany(fetch = FetchType.LAZY, mappedBy = "vehicles")
private Set<Employee> employees; 
```

# database - 从 Drupal 操作数据库

> ID：10936292
> 
> 赞同：1
> 
> 时间：2012-06-07T16:51:55.170
> 
> 标签：database, drupal-7, datamodule

我是 Drupal 7 的新手。现在我正在尝试使用 D7 构建一个界面，允许我直接操作数据库中的表。我已经安装了几个模块，例如 Data、Migrate、Feeds 等。我设法创建了一个视图来显示我使用 Data Module 创建的表，但我需要从界面中添加和更新行。此外，是否可以设置关系表，以便我可以使用 Drupal 同时更新或删除相关行？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-15T22:31:47.710

使用数据模块非常容易，因为它带有为您创建实体表单的“数据实体”子模块。这允许您更新数据表行。它应该在表格的数据视图末尾添加一个编辑按钮。

使用一些基本的自定义代码，您始终可以创建一个表单来向表中添加/更新数据。对于表单创建，请查看：

[http://api.drupal.org/api/drupal/includes%21form.inc/group/form_api/7](http://api.drupal.org/api/drupal/includes%21form.inc/group/form_api/7)

# javascript - 使用正则表达式验证输入是否包含任何非数字

> ID：10936293
> 
> 赞同：6
> 
> 时间：2012-06-07T16:52:07.683
> 
> 标签：javascript, regex, validation, integer, expression

```
function validInteger(theNumber){
    var anyNonDigits = new  RegExp('\D','g');
    if(parseInt(theNumber)&&!anyNonDigits.test(theNumber)){
        return true;
    }else{
        return false;
    }
} 
```

以上是我为验证某些输入而编写的函数。我想要所有正整数。我面临的问题是 RegExp 对象。这似乎应该非常简单，但由于某种原因它不起作用。

例如，如果我通过'f5'，我得到真，但如果我通过'5f'，我得到假。传递负数时我也遇到问题。即使我在将变量传递给 RegExp 之前对变量进行字符串化，-3 也不会被捕获。我可以通过`&&parseInt(theNumber)>0`在 if 语句中添加 ' ' 来解决这个问题，但我觉得 RegExp 也应该抓住它。提前致谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-07T16:55:00.703

简单地：

```
function validInteger(theNumber){    
    return theNumber.match(/^\d+$/) && parseInt(theNumber) > 0;
} 
```

[**现场演示**](http://jsfiddle.net/pCRQQ/)

或者更简单，`regex`仅按照@Eric的建议：

```
return /^[0-9]\d*$/.test(theNumber); 
```

[**现场演示**](http://jsfiddle.net/pCRQQ/1/)

**更新：**

~~[一个优秀的备忘单。](http://www.addedbytes.com/download/regular-expressions-cheat-sheet-v2/png/)~~链接在 5 年后失效，对不起。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:01:15.263

如果可以不使用 RegExp，您可以拥有：

```
function validInteger(theNumber){
    var number = +theNumber;

    return number > -1 && number % 1 === 0;
} 
```

假设您将 0 视为正整数，并且您不想区分 +0 和 -0。

请注意，此函数将接受任何`theNumber`可以转换为数字的值，因此不仅仅是“字符串”，当然您也可以传递数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:06:41.317

简单点！

```
function validate(num){
    return (num | 0) > 0;
}; 
```

此函数仅对正整数返回“true”。

# ruby-on-rails - 如何在 Rails 中预览 delete_all 或 destroy_all 查询

> ID：10936294
> 
> 赞同：9
> 
> 时间：2012-06-07T16:52:13.263
> 
> 标签：ruby-on-rails, activerecord, arel

你知道演习：一些无效数据在生产数据库中弹出，你必须摆脱它。在生产服务器上启动 Rails 控制台并输入查询：

```
Foo.where(bar: 'baz').all 
```

您查看返回的数据，这就是您需要删除的数据。然后你输入：

```
Foo.where(bar: 'baz').destroy_all 
```

你的心跳会停止一秒钟。您只想在查询运行之前查看它。

在 Rails 中有没有办法做到这一点？我正在寻找类似的方法

```
Foo.where(bar: 'baz').to_sql 
```

但是将返回**DELETE**查询的那个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:56:45.447

问题是`destroy_all`不运行单个 SQL 查询。它遍历对象的散列，实例化它们，运行它们的回调，然后调用该对象的`destroy`方法。Rails 没有生成这些查询数组的内置方法。

`delete_all`Cdesroisiers 是正确的，您可以在沙盒模式下测试查询，但真正的问题是，即使您已经验证了任何目标数据，您仍然在猜测您的决定是否运行。

如果您不愿意相信 ActiveRecord 能够正确删除对象，请考虑使用像[PaperTrail这样的 ActiveRecord 版本控制 gem。](https://github.com/paper-trail-gem/paper_trail)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T19:00:22.637

destroy_all 方法与执行以下操作相同：

```
Foo.where(bar: 'baz').each { |object| object.destroy } 
```

所以sql变成了

```
DELETE FROM foo WHERE foo.id = your_objects_id_attribute 
```

来自文档：

```
 def destroy_all(conditions = nil)
    find(:all, :conditions => conditions).each { |object| object.destroy }
  end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T17:38:42.863

就在我的脑海中，您可以在沙盒模式下运行控制台并运行删除查询以查看 sql。更改只会在退出时回滚。

# sql-server - SQL Server 分组依据/排序依据

> ID：10936295
> 
> 赞同：5
> 
> 时间：2012-06-07T16:52:19.673
> 
> 标签：sql-server, tsql

我有以下查询

```
select
    datepart(yy, orderDate) as 'year',
    datename(mm, OrderDate) as 'month',
    count(*) as 'Orders'
from orders     (yeah I know its missing the schema, its from a book)
group by
    datepart(yy, orderdate),
    datename(mm, orderdate)
order by
    datepart(yy, orderdate),
    datename(mm, orderdate); 
```

它返回 3 列，但`datename(mm, orderdate)`返回一个字符串，因此按其排序将 8 月置于 1 月之前等。

解决方案如下：

```
select
    datepart(yy, orderDate) as 'year',
    datename(mm, OrderDate) as 'month',
    count(*) as 'Orders'
from orders  (yeah i know its missing the schema, its from a book)
group by
    datepart(yy, orderdate),
    datename(mm, orderdate),
    datepart(mm, orderdate)
order by
    datepart(yy, orderdate),
    datepart(mm, orderdate); 
```

我仍然对整个 group by / order by section 及其实际工作方式感到有些困惑。

据我了解，group by 正在创建一个包含 4 列（可能是错误的）`datepart(yy, orderdate), datename(mm, orderdate), datepart(mm, orderdate)`和一`count`列的工作表。

每次遇到`orderdate`它在工作表中的一个它会增加计数，否则它会添加一个新行？

最初我以为我可以`DateName(mm, orderdate)`按部分从组中删除，但书上说这是不可能的。

如果有人可以逐步了解幕后实际发生的事情/指出一个资源，该资源可以更详细地解释这是如何工作的，我将不胜感激。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T17:03:28.210

任何时候使用聚合函数（COUNT、SUM、MAX 等），都需要在 GROUP BY 子句中包含所有其他列。您的示例中的 COUNT 返回具有相同值的记录数`datepart(yy, orderdate)`, `datename(mm, orderdate)`, `datepart(mm, orderdate)`。

一个例子：

```
SELECT col1, col2, col3, MAX(col4)
FROM MyTable
GROUP BY col1, col2, col3 
```

说这个返回：

```
1,2,3,9
1,2,5,9 
```

如果您将查询更改为：

```
SELECT col1, col2, MIN(col3), MAX(col4)
FROM MyTable
GROUP BY col1, col2 
```

它会返回：

```
1,2,3,9 
```

请注意，我向 (MIN) 添加了一个聚合函数，`col3`因此我能够`col3`从我的 GROUP BY 子句中删除。

# vb.net - Vb 2010 中的变量声明

> ID：10936298
> 
> 赞同：0
> 
> 时间：2012-06-07T16:52:20.673
> 
> 标签：vb.net

我正在创建一种“幼稚”的搜索引擎。

我所做的是在文件中分配单词，每个文件对应于单词的起始字母（即如果是英文，那么有 26 个文件）

然后，当搜索系统加载时，我正在加载哈希表（对应于 26 个字母字符的 26 个哈希表）中的所有单词，为此我使用了一个结构数组。

问题是在`Form load`子例程中声明变量后，变量无法在其他子例程中使用这些值....

我如何正确声明它们以使它们的值持续存在？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T16:56:51.690

将它们声明在所有例程之上，但在 main 中，`Class`那么它们也将在其他地方可用。例如：

```
Public Class yourClassName
   ' declare your variables here 
```

当您在子例程中声明变量时，它们将仅在该子例程中可用，这就是为什么您需要在类级别声明它们以便它们也可以在其他子例程中使用。

有关更多信息，请参阅文档（感谢 @Drise）

[http://msdn.microsoft.com/en-us/library/1t0wsc67.aspx](http://msdn.microsoft.com/en-us/library/1t0wsc67.aspx)

# ios - ios app Metadata被拒绝是否意味着二进制是好的

> ID：10936300
> 
> 赞同：17
> 
> 时间：2012-06-07T16:52:22.940
> 
> 标签：ios, metadata, appstore-approval

我最近接到 Apple 的电话，说他们会拒绝我们的应用程序，因为元数据存在问题。我问应用程序本身是否有问题，她说她不知道，因为她不是审核团队的成员。她说应该没问题。

所以我更改了我的元数据并重新提交了应用程序，现在状态正在审核中。根据 itunesconnect 程序员指南，他们将重用二进制文件。这是否意味着二进制文件很好？他们是否有可能会再次查看该应用程序并出于解决中心指定以外的其他原因拒绝我？

我知道这是一个可能只有苹果才能回答的问题，但这是我们的第一个应用程序，所以我真的不知道它是如何工作的。我问苹果，但他们什么也没告诉我。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-07T16:55:28.820

您不需要上传新的二进制文件。他们将再次审核并批准（或因其他原因拒绝）。在我的情况下只花了几个小时。但是你不能确定二进制文件已经被检查过了。也许他们到目前为止只做了元数据，并且会在您的元数据更正后检查二进制文件。无论如何，现在不需要上传任何东西。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-06-07T17:03:41.457

通常，审阅者在发现问题后会立即停止审阅过程。这意味着元数据拒绝可能是更长列表中的第一个（希望不是！）或者他们审查了您的整个应用程序并发现仅在元数据级别的唯一问题：在这种情况下修复您的元数据就足够了。

最近我看到我的一个应用程序由于添加应用内购买的错误而被拒绝（基本上该应用程序指的是 IAP 仍然不在 iTunes 中）。在修复它之后（没有二进制更改，只是添加“in app”）他们这次在应用程序中发现了一个问题，然后提交了二进制文件。对我来说，将这两个问题一起知道并修复一次会更容易，而不是三次旅行将我的最终应用程序提交延迟了 10 天（考虑两次连续审查之间的 5 天）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-07T17:02:17.027

根据我的经验，这并不总是意味着**二进制文件**是好的。他们可能已经达到了检查元数据的地步，并在**没有**测试二进制文件本身的情况下发现了问题。期待与苹果的意外。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-21T05:57:22.940

这是由于元数据信息，不需要上传新的二进制文件。他们将再次审核并批准（或因其他原因拒绝）。就我而言，我在后台模式下使用位置，但在我的应用程序描述中没有包含所需的“电池使用”免责声明，我根据苹果消息更改了元数据（仅限应用程序描述）。只用了几个小时（几乎没有 4 小时），应用程序就上线了。我被吓坏了 :) 因为有人说，最多需要 7 天（作为苹果的正常流程）。

以下是我的情况下应用程序拒绝的原因（以下是我从 Apple 收到的邮件）

来自苹果

   * 2.16 - 多任务应用程序只能将后台服务用于其预期目的：VoIP、音频播放、位置、任务完成、本地通知等。

2.16 详情

您的应用程序使用位置背景模式，但在您的应用程序描述中未包含所需的“电池使用”免责声明。

下一步

请在您的申请说明中添加以下免责声明：

“继续使用在后台运行的 GPS 会大大缩短电池寿命。”

请查看应用商店截图进行确认。

[![在此处输入图像描述](../Images/4e798ffb3d82dd8e5e7bf84e0c7e519e.png)](https://i.stack.imgur.com/lLGEy.png)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-24T22:57:31.183

根据我的经验，他们会在找到原因后立即拒绝该应用程序，并且在下次提交之前不会对其进行进一步审查。因此，如果元数据被拒绝，并不意味着他们已经批准了二进制文件。

# visual-c++ - 如何从exe应用程序调用dll中的纯虚函数？

> ID：10936302
> 
> 赞同：0
> 
> 时间：2012-06-07T16:52:33.357
> 
> 标签：visual-c++

我有一个 dll，它有一个抽象类，它的所有成员函数都是纯虚函数。我正在尝试编写一个应用程序来调用这些函数。调用这些纯虚函数需要采取哪些步骤？

这只是一个原型

带有抽象类的头文件：interface.h [这些是导出的函数]

```
class MathFuncExport {

public:

    virtual int Add(int a, int b)=0;

    MathFuncExport(){};
    virtual ~MathFuncExport(){};
}; 
```

dll 中的头文件：MathFuncDll.h

```
#include "intf.h"

class MyMathFuncs : public MathFuncExport
{
public:
    MyMathFuncs(){};
    virtual ~MyMathFuncs(){};
    virtual int Add(int a, int b);
}; 
```

实现：MyMathFunsDll.Cpp 文件

```
#include "MathFuncDll.h"

int MyMathFuncs::Add(int a, int b)
{
    return a + b;
} 
```

这创建了一个 dll，但我无法调用抽象类中的函数，或者我在这里缺少一些链接。请帮我解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T22:08:10.230

你不能称之为纯虚拟。它们被实施以强制功能实施。由于您的基类在 DLL 中，因此您必须导出类才能将其用于派生其他类。

导出类最简单的方法是使用隐式链接；这样，您需要一个用于类声明和导入库的标头。对于不同链接的overllok，[请检查此链接](http://msdn.microsoft.com/en-us/library/9yd93633)。

对于一个小演示，创建 Win32 dll。如果需要，请检查 MFC 支持并选中导出符号框。

这将创建一个带有示例类和全局变量导出的 dll。查看创建特殊宏的头文件，对于 DLL（导出）和与此 dll 链接的可执行文件（导入）具有不同的含义。

一旦您了解了如何使用隐式链接，您将能够从 dll 中的基类派生类，就像您在可执行模块中使用代码一样。

# .net - CruiseControl.net Remoting - 有理由的 ForceBuild

> ID：10936303
> 
> 赞同：0
> 
> 时间：2012-06-07T16:52:36.230
> 
> 标签：.net, cruisecontrol.net, remoting

CruiseControl.net 提供了使用 .net 远程连接到 CruiseControl.net 服务器的能力。我已经能够连接并实现我们需要的一切 - 一个更高级的 CCtray 版本。

但是，可以将项目配置为请求 buildReason，这通过订阅 ICruiseServer.ForceBuildReceived 事件来实现，该事件作为参数采用允许返回原因的对象。

[http://www.opensourcejavaphp.net/csharp/cruisecontroldotnet/ICruiseServer.cs.html](http://www.opensourcejavaphp.net/csharp/cruisecontroldotnet/ICruiseServer.cs.html)

这就是我通过查看服务器的源代码得出的结论。但是，在客户端订阅所述事件会引发 RemotingException，它表示要在其配置文件中启用远程服务器的 customErrors 选项。

有没有其他人设法做到这一点？还是我提供构建原因的过程有些错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T16:00:42.363

事实证明，答案是使用 BuildProjectRequest 而不是 ProjectRequest，因为这允许您为构建指定参数。我使用了与 Project.ListBuildParameters() 调用中相同的名称，并带有 $ 前缀来匹配其他名称。

添加的任何参数都将出现在构建日志中，并且足以存储强制构建的原因。

感谢 Automated Coder (Craig Sutherland) 的这篇文章，它帮助我指明了正确的方向。

[http://csut017.wordpress.com/2009/01/02/passing-dynamic-parameters-part-1-the-server/](http://csut017.wordpress.com/2009/01/02/passing-dynamic-parameters-part-1-the-server/)

# java - 以编程方式关闭 JDialog 中显示的 JPanel

> ID：10936306
> 
> 赞同：2
> 
> 时间：2012-06-07T16:52:37.790
> 
> 标签：java, swing

我有一个主应用程序框架 ( `MainFrame class`)。在 a 的 actionperformed 事件中`JButton`，a `JPanel (MyJPanel class)`通过将其放入来打开`JDialog`。我没有扩展`JDialog`到创建`MyJPanel`类，因为我可能也需要 MyJPanel 用于其他目的。

我的问题是我无法以编程方式关闭`MyJPanel`显示在`JDialog`. 有什么我想念的吗？你能弄清楚吗？

```
import java.awt.EventQueue;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JDialog;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.WindowConstants;

    public class MainFrame extends JPanel {
        public MainFrame() {

            JButton btnOpenJdialog = new JButton("Open JDialog");
            add(btnOpenJdialog);
            btnOpenJdialog.addActionListener(new ActionListener() {

                public void actionPerformed(ActionEvent e) {
                    JDialog jd = new JDialog();
                    MyJPanel mjp = new MyJPanel(true);//showing in JDialog
                    jd.setTitle("JDialog");
                    jd.add(mjp);
                    jd.pack();
                    jd.setVisible(true);

                }
            });
        }

        public static void main(String[] args) {
            EventQueue.invokeLater(new Runnable() {

                public void run() {
                    createAndShowGUI();
                }
            });
        }

        public static void createAndShowGUI() {

            JFrame frame = new JFrame("Test-JFrame");
            frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
            frame.getContentPane().add(new MainFrame());
            frame.pack();
            frame.setLocationRelativeTo(null);
            frame.setVisible(true);
        }

    } 
```

MyJPanel 类：

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JPanel;
import javax.swing.JButton;

public class MyJPanel extends JPanel {
    private boolean isShownInJDialog = false;

    public MyJPanel() {
        JButton btnCloseMe = new JButton("Finish Action");
        add(btnCloseMe);
        btnCloseMe.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent e) {
                if (isShownInJDialog) {
                    MyJPanel.this.setVisible(false);
                    //how to close the JDialog too.
                }
                else {
                    //just hide the content, 
                    MyJPanel.this.setVisible(false);
                }
            }
        });
    }

    public MyJPanel(boolean isShownInJDialog) {
        this();
        this.isShownInJDialog = isShownInJDialog;

    }

} 
```

**更新** 我能够使用霍华德的回答来解决这个问题：

```
...     
if (isShownInJDialog) {
        Window w = SwingUtilities.getWindowAncestor(MyJPanel.this);
        w.setVisible(false);
}
... 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-07T17:01:30.207

如果我正确理解了您的问题，您想关闭`JDialog`其中`MyJPanel`包含但没有参考的内容吗？

您可以使用的构造函数提供这样的参考，也可以将`MyJPanel`您的代码更改`ActionListener`为

```
Window w = SwingUtilities.getWindowAncestor(MyJPanel.this);
w.setVisible(false); 
```

它在没有直接参考的情况下查找面板的父窗口。

# c++ - 带有 gcc 4.6 的 std::packaged_task 编译错误

> ID：10936309
> 
> 赞同：5
> 
> 时间：2012-06-07T16:52:54.150
> 
> 标签：c++, concurrency, c++11, g++, std

我正在尝试使用在线程中启动一个函数`std::packaged_task`

```
Query query; /* protobuf object */        

/* fill Query object */

std::packaged_task<SearchResults(Query&)> task([](Query& q) ->SearchResults {
    index::core::Merger merger;
    return merger.search(q);
    });

std::future<SearchResults> ftr = task.get_future();
std::thread(std::move(task),query).detach(); 
```

Edit2：再次更新代码以修复错误并包含完整的错误消息。

g++-4.6（在 Ubuntu 10.04 上）无法编译代码：

```
In file included from /usr/include/c++/4.6/memory:80:0,
              from ../src/net/QueryConnection.cpp:8:
/usr/include/c++/4.6/functional: In instantiation of ‘std::_Bind_result<void, 
std::packaged_task<SearchResults(Query&)>(Query)>’:
/usr/include/c++/4.6/thread:135:9:   instantiated from ‘std::thread::thread(_Callable&&, 
_Args&& ...) [with _Callable = std::packaged_task<SearchResults(Query&)>, _Args = 
{Query&}]’
../src/net/QueryConnection.cpp:77:36:   instantiated from here
/usr/include/c++/4.6/functional:1365:7: error: ‘std::_Bind_result<_Result, 
_Functor(_Bound_args ...)>::_Bind_result(const std::_Bind_result<_Result, 
_Functor(_Bound_args ...)>&) [with _Result = void, _Functor =   
std::packaged_task<SearchResults(Query&)>, _Bound_args = {Query}, 
std::_Bind_result<_Result, _Functor(_Bound_args ...)> = std::_Bind_result<void, 
std::packaged_task<SearchResults(Query&)>(Query)>]’ declared to take const reference, 
but implicit declaration would take non-const
Build error occurred, build is stopped 
```

我读过这可能是由于一个错误：[gcc-mailinglist](http://www.mailinglistarchive.com/html/gcc-help@gcc.gnu.org/2011-11/msg00090.html)

我是 C++/C++11 的新手 - 什么是一个好的工作选择？我只需要启动一个给我未来的线程，`get()`稍后在`boost::asio`异步循环中调用 who -method。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T21:28:20.747

这是 GCC 4.6 中的一个错误（实际上是 C++11 标准中的一个[缺陷](http://open-std.org/JTC1/SC22/WG21/docs/papers/2012/n3358.html#2067)），我已经在 4.7 中修复了它。

作为一种解决方法，您可以使用`std::async`

```
Query query;
std::future<SearchResults> ftr = std::async([](Query& q) ->SearchResults {
      index::core::Merger merger;
      return merger.search(q);
    }, query); 
```

这适用于 GCC 4.6，并且`packaged_task`无论如何创建并在分离线程中运行它更简单、更安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T18:44:36.533

我不知道这些是否是 GCC 给出的错误的原因，但它们仍然是有问题的。

```
[=](Query& q){
        index::core::Merger merger;
        return merger.search(q);
} 
```

由于这个 lambda 不包含单个 return 语句，并且没有给出明确的返回类型，所以它有一个`void`返回类型。我怀疑你打算让它返回一个`SearchResults`对象。它需要一个`Query&`参数，因此打包任务的适当签名将是`SearchResults(Query&)`.

```
[=](Query& q) -> SearchResults {
        index::core::Merger merger;
        return merger.search(q);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T20:48:36.780

更新后的代码有两个问题：

1) lambda 没有正确说明它的返回类型。您想要的语法是（假设您不需要复制任何局部变量）是：

```
[](Query& q) -> SearchResults {
        index::core::Merger merger;
        return merger.search(q);
} 
```

2）鉴于打包的任务需要 a `Query&`，那么您需要将非常量 Query 的引用作为第二个参数传递给`std::thread`构造函数，以便可以将其传递给任务。

我不记得是您是否可以合法地将非常量 Query 引用作为第二个参数正确传递给`std::thread`，或者您是否需要使用`std::ref(q)`它以通过引用正确传递第二个参数。

如所写，它试图在没有参数的情况下调用任务，如

> /usr/include/c++/4.6/future:1272:7：注意：候选人需要 1 个参数，提供 0

# javascript - 如何使用 VB.Net 识别 PDF 中的签名签名字段

> ID：10936312
> 
> 赞同：1
> 
> 时间：2012-06-07T16:53:04.920
> 
> 标签：javascript, vb.net, acrobat

嗨，我正在寻找一种使用 VB.Net 或 JavaScript 和 Acrobat 在 PDF 上查找签名字段的方法，然后我想检查它是否已签名。这是我到目前为止所拥有的：

```
 Dim page As Acrobat.CAcroPDPage
        Dim annot As Acrobat.CAcroPDAnnot
        page = acroPDDoc.AcquirePage(0)
        For i = 0 To page.GetNumAnnots - 1
            annot = page.GetAnnot(i)
        Next 
```

我正在查找注释，但我不知道如何检查它是否是签名字段。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T16:01:04.670

通过 JavaScript 使用，您可以使用 this.getNthFieldName(i) 来获取 acrobat 文档上的所有字段名。然后，您必须使用“field.type.localeCompare("signature") == 0”找到正确的字段，以确保这是您要查找的字段。之后，只需对其进行处理以确定是否有签名。

下面是我用来确定是否存在数字签名的代码片段。

```
for(var i = 0; i < this.numFields; i++) {
  var a = this.getNthFieldName(i);
  var field = this.getField(a);
  if(field.type.localeCompare("signature") == 0) {
    var s = field.signatureInfo();
    if( s.name == null) {
       console.println("Digital Signature Not Present.");
       return -1;
    }else {
       console.println("Digital Signature Present.");
       return 0;
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-21T14:47:32.550

将表单调暗为 Acrobat.CAcroPDDoc 将 jso 调暗为对象

```
 theForm = CreateObject("AcroExch.PDDoc")
    theForm.Open("C:\Temp\Maru\DeclaracionJurada.pdf")
    jso = theForm.GetJSObject

    'Verifica que la firma sea valida

    Dim signatureOne = jso.getField("Signature2")
    Dim oState = signatureOne.SignatureValidate()

    Select Case oState
        Case Is = -1
            ListBox1.Items.Add("Estado : Sin Firma ")
        Case Is = 0
            ListBox1.Items.Add("Estado : Firma en blanco ")
        Case Is = 1
            ListBox1.Items.Add("Estado : No conoce el estado de la firma ")
        Case Is = 2
            ListBox1.Items.Add("Estado : Firma invalida ")
        Case Is = 3
            ListBox1.Items.Add("Estado : La firma es valida, pero la identidad del firmante no se pudo verificar ")
        Case Is = 4
            ListBox1.Items.Add("Estado : Firma e identidad son validas ")

    End Select

    'Extrae la info del firmante, nombre y fecha de la firma
    Dim signatureInformation = signatureOne.signatureInfo

    ListBox1.Items.Add("Firmante " & signatureInformation.name)
    ListBox1.Items.Add("Fecha " & signatureInformation.Date)

    'Extrae la info del certificado
    Dim signatureCertificate = signatureInformation.certificates
    ListBox1.Items.Add("Emitido a : " & signatureCertificate(0).subjectDN.serialNumber)
    ListBox1.Items.Add("Numero de Serie : " & signatureCertificate(0).serialNumber)
    ListBox1.Items.Add("Valido desde : " & signatureCertificate(0).validityStart)
    ListBox1.Items.Add("Valido hasta : " & signatureCertificate(0).validityEnd)
    ListBox1.Items.Add("Para : " & signatureCertificate(0).subjectDN.o)
    ListBox1.Items.Add("Tipo : " & signatureCertificate(0).subjectDN.ou)
    ListBox1.Items.Add("Emitido Por : " & signatureCertificate(0).issuerDN.cn) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-21T14:56:35.463

如何使用 VB.Net 识别 PDF 中的签名签名字段

```
 Dim gApp As Acrobat.CAcroApp
    Dim gPDDoc As Acrobat.CAcroPDDoc
    Dim jso As Object
    Dim fname As String

    gApp = CreateObject("AcroExch.App")
    gPDDoc = CreateObject("AcroExch.PDDoc")

    If gPDDoc.Open("C:\Temp\Solicitud de empleo.pdf") Then
        jso = gPDDoc.GetJSObject

        For i = 0 To jso.numFields - 1
            fname = jso.getNthFieldName(i)
            ListBox1.Items.Add("Campo : " & fname & " valor: " & jso.getField(fname).value)

            MessageBox.Show(jso.getField(fname).type)

        Next

    End If 
```

# permutation - 您好，我有一个计算 q。关于组合/排列

> ID：10936313
> 
> 赞同：0
> 
> 时间：2012-06-07T16:53:06.803
> 
> 标签：permutation, combinations

一个简短的介绍。我正在创建一个医疗软件。我忘记了大学里的一些计算/置换定理。假设我有五根神经。正中、尺骨、桡骨、胫骨、腓骨。我可以在任何组合中选择一个、两个、三个、四个或全部五个。找到我可以做出的最大组合数的方程式是什么？

例如; 中位数 + 尺骨中位数 + 尺骨 + 桡骨等

尺骨 + 中位数 = 中位数 + 尺骨。所以这些将是重复的。谢谢您的帮助。我知道这与编程没有直接关系，但我认为你们会很熟悉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-14T23:28:18.530

说它是 (2^n)-1 的评论是正确的。2^n 是您可以从一组 n 个对象中形成的可能子集的数量（在这种情况下，您有 5 个对象），然后在您的情况下，您不想计算空集，因此减去 1 .

我相信您可以进行数学计算，但为了完整起见，对于 5 条神经，您最终可能会得到 2^5 - 1 = 32 - 1 = 31 种可能的组合。

# ruby-on-rails - Rails如何从dateTime中删除UTC偏移文本（'UTC'），只留下DateTime？

> ID：10936319
> 
> 赞同：3
> 
> 时间：2012-06-07T16:53:51.520
> 
> 标签：ruby-on-rails

我有一个工具集，可以将数据库中的所有内容存储为 UTC。在表单上，​​我有一个带有附加 jQuery 日期 + 时间选择器的文本字段。

在该文本字段中，日期时间戳（带 UTC 偏移量）将如下所示：

```
<%= f.text_field :report_time, :size => 22  %>
    2012-06-05 15:55:50 
```

但是，我需要这种形式选择才能在 EST 中。所以我需要将它转换为表单，然后在提交表单时。此问题仅特定于执行“编辑”操作时（字段中已存在时间）。如果我做任何加法或减法，“UTC”会卡在表单文本字段的末尾：

```
@report.report_time = @report.report_time - 5.hours
=>2012-06-05 10:55:50 UTC 
```

此时，我正在使用的 jQuery DateJS dateparse 函数将停止工作，因为它不理解保存日期时间的文本字段中的“UTC”文本。

如何获取 db UTC 时间并添加/减去小时数而不会在表单中删除“UTC”，或者如何删除 UTC offfest 信息，只留下原始 dateTime 信息？

我如何：

```
@report.report_time = @report.created_at - 5.hours
=>2012-06-05 10:55:50 UTC
#  do something here to strip " UTC" off the dateTime   ??
=>2012-06-05 10:55:50 
```

谢谢你！导轨 2.3.5 / Ruby 1.8.7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:16:46.837

如果您不想要默认表示，请使用 strftime 函数直接设置字段的值。

```
<%= f.text_field :report_time, :size => 22, :value =>"...." %> 
```

[http://ruby-doc.org/stdlib-1.8.7/libdoc/date/rdoc/DateTime.html#method-i-strftime](http://ruby-doc.org/stdlib-1.8.7/libdoc/date/rdoc/DateTime.html#method-i-strftime)

您可能想查看此链接以获取有关如何使用表单构建器更自然地使用日期/时间的信息。

[http://guides.rubyonrails.org/form_helpers.html#using-date-and-time-form-helpers](http://guides.rubyonrails.org/form_helpers.html#using-date-and-time-form-helpers)

# android - Battery status without activity only using broadcastreceiver

> ID：10936320
> 
> 赞同：1
> 
> 时间：2012-06-07T16:53:59.663
> 
> 标签：android, broadcastreceiver, android-activity, battery

Hi I'm making an app which uses only the broadcast receiver. It serves three purposes. When a SMS containing specific code is received it sends the GPS data. The other code sends the sensor data. No problems up to this point. But for the battery I'm unable to do this because of the registerreceiver() function. As I'm not using an activity and onCreate method, can I send the battery data when an SMS is received?

When I tried to tweak this in the onreceive() method of broadcastreceiver, my application crashes. I searched everywhere an activity is created. I want to do everything inside the broadcast receiver only.

My code goes like this:

```
public class MyPhoneReceiver extends BroadcastReceiver{
double current_lat,current_lng;
LocationManager mlocManager;
LocationListener mlocListener;
//addition//////////////////////////////
SensorManager mSensorManager;

Sensor mAccelerometer;  
////////////////////

private static final String SMS_RECEIVED = "android.provider.Telephony.SMS_RECEIVED";
private static final String TAG = "SMSBroadcastReceiver";

@Override
public void onReceive(Context context, Intent intent) {
Log.i(TAG, "Intent recieved: rama" + intent.getAction());

Bundle bundle = intent.getExtras();
if (bundle != null) {
Object[] pdus = (Object[]) bundle.get("pdus");
final SmsMessage[] messages = new SmsMessage[pdus.length];
for (int i = 0; i < pdus.length; i++)
messages[i] = SmsMessage.createFromPdu((byte[]) pdus[i]);
if (messages.length > -1) {
String messagebody=messages[0].getMessageBody();
Log.i(TAG, "Message recieved: in message receied " + messages[0].getMessageBody());
if(messagebody.toString().matches("HDPK GPS"))
{
Log.i(TAG, "Message recieved: HDPK RECEIVED " + messages[0].getMessageBody());
mlocManager=(LocationManager)context.getSystemService(context.LOCATION_SERVICE);
mlocManager.requestLocationUpdates(LocationManager.GPS_PROVIDER,1000,1,new MyLocationListener());
}
if(messagebody.toString().matches("HDPK SENS"))
{
Log.i(TAG, "Message recieved: in msensior ");
mSensorManager = (SensorManager)context.getSystemService(Context.SENSOR_SERVICE);
mAccelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
mSensorManager.registerListener(new MySensorListener(), mAccelerometer, SensorManager.SENSOR_DELAY_NORMAL);
}
if(messagebody.toString().matches("HDPK BAT"))
{
Log.i(TAG, "Message recieved: in battery ");
IntentFilter filter=new IntentFilter(Intent.ACTION_BATTERY_CHANGED);
Intent batt=context.registerReceiver(null,filter);
int level = batt.getIntExtra("EXTRA_LEVEL", 0);
Log.i(TAG, "Message recieved: in battery level is "+level);
SmsManager sender=SmsManager.getDefault();
sender.sendTextMessage("9762281814", null, "Level is"+level, null,null);
}

}
}
}

public class MySensorListener implements SensorEventListener
{
public void onAccuracyChanged(Sensor arg0, int arg1) {
// TODO Auto-generated method stub

}

public void onSensorChanged(SensorEvent event) {
// TODO Auto-generated method stub
Log.i(TAG, "Message recieved: in msensior event change ");
float x = event.values[0];

float y = event.values[1];

float z = event.values[2];
SmsManager sender=SmsManager.getDefault();
String Text="x :"+x+" Y:"+y+ " Z:"+z;
sender.sendTextMessage("9762281814",null, Text, null, null);
mSensorManager.unregisterListener(this);
}

}

public class MyLocationListener implements LocationListener{

public void onLocationChanged(Location location) {
// TODO Auto-generated method stub
current_lat=location.getLatitude();
current_lng=location.getLongitude();
SmsManager sender=SmsManager.getDefault();
String Text = "My Location is : Latitude ->" +current_lat+" Longitude ->" + current_lng;
sender.sendTextMessage("9762281814", null, Text, null, null);

mlocManager.removeUpdates(this);

}

public void onProviderDisabled(String provider) {
// TODO Auto-generated method stub

}

public void onProviderEnabled(String provider) {
// TODO Auto-generated method stub

}

public void onStatusChanged(String provider, int status, Bundle extras) {
// TODO Auto-generated method stub

}

}

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-08T08:36:35.653

尝试使用应用程序`Context`而不是广播接收器`Context`来`registerReceiver()`更换粘性电池`Intent`。像这样：

```
IntentFilter filter=new IntentFilter(Intent.ACTION_BATTERY_CHANGED);
Intent batt=context.getApplicationContext().registerReceiver(null,filter);
int level = 99; // Default to some unknown/wild value
// registerReceiver method call could return null, so check that!
if (batt != null) {
    level = batt.getIntExtra(BatteryManager.EXTRA_LEVEL, 0);
} 
```

# java - Print / format locale-aware floats with "only as many to distinguish" digits in Java

> ID：10936322
> 
> 赞同：0
> 
> 时间：2012-06-07T16:54:05.290
> 
> 标签：java, formatting, floating-point

The default [`Java Float.toString(float)`](http://docs.oracle.com/javase/6/docs/api/java/lang/Float.html#toString%28float%29) method prints a floating point number with "only as many ... [fractional] digits as are needed to uniquely distinguish the argument value from adjacent values of type `float`." Perfect! Just what I need---except that I need to do this in a locale-specific way (e.g. on a French computer "1.23" would be represented as "1,23").

How do I reproduce the functionality of `Float.toString(float)` in a locale-aware manner?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:03:22.217

您可以尝试以下方法：

```
String s1 = String.format(Locale.FRANCE, "%.2f", 1.23f); // Country FRANCE 1,23
String s2 = String.format(Locale.FRENCH, "%.2f", 1.23f); // Language FRENCH 1,23
String s3 = String.format("%.2f", 1.23f); // Default Locale 
```

`.2`是可选的，是小数位数

`Locale.getDefault()`如果返回适合`Locale`法国的情况，可能与第三个配合得很好。

另一种方法是使用`NumberFormat`

```
NumberFormat nf = NumberFormat.getInstance(Locale.FRENCH);
String s4 = nf.format(1.23f); // 1,23 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:41:05.673

我认为问题的重要部分是`Float.toString()`自动计算出相关的小数位数，并且做得很好。在我的 JRE 中，使用了 class`sun.misc.FloatingDecimal`类。该类中的逻辑看起来非常复杂且难以重现。

另一个可以用来猜测要显示的正确位数的类是`BigDecimal`. 例如，如果您正在使用`double`而不是`float`：

```
double d = 1.23;
NumberFormat nf = NumberFormat.getNumberInstance(Locale.FRENCH); 
BigDecimal bd = BigDecimal.valueOf(d);
nf.setMaximumFractionDigits(bd.scale());
String s = nf.format(1.23f); // 1,23 
```

对于浮点数，您首先必须弄清楚如何在不改变精度的情况下从浮点数转换为 BigDecimal：[How to convert from float to bigDecimal in java?](https://stackoverflow.com/questions/3829029)

# java - （Java）为什么会编译：琐碎的最终类没有从继承的抽象父类中实现抽象方法

> ID：10936325
> 
> 赞同：2
> 
> 时间：2012-06-07T16:54:10.130
> 
> 标签：java, compilation

为什么会这样编译？（在 Oracle java 5 和 java 6 下都试过（是的，我知道，我适应得很慢）

```
public abstract class BaseClass
{
    public abstract void methodA(String abc);

    public abstract String methodB(String abc);
}

public final class ConcreteClass
extends BaseClass
{
} 
```

只需将这两个类弹出到单独的文件中，在它们上调用 javac 和*poof*，它们就会编译。由于抽象方法旨在由实现者实现，因此这没有意义。更进一步，当一段代码尝试调用未实现的方法时，我只会收到编译错误。

再说一次，我的问题是，有谁知道*为什么*编译器允许这样做（或者为什么我们希望它这样做）？

附加评论：

*   当我进行初始测试时，我最初没有将 ConcreteClass 标记为 final，我突然想到另一个类可以扩展该类，因此编译器可能不会抱怨并假设您以后会有其他类道路会照顾它，但是将课程标记为最终课程应该很清楚事实并非如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:05:15.870

正如@Jigar 在评论中提到的那样，您必须导入错误版本的`BaseClass`. 当我尝试编译您的代码时，出现以下错误：

```
/Users/ShirishP/Desktop/ConcreteClass.java:1: ConcreteClass is not abstract and does not override abstract method methodB(java.lang.String) in BaseClass
public final class ConcreteClass extends BaseClass
             ^
1 error 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-07T17:00:46.307

这可能不是故意的。静态抱怨抽象类的代码可能会在编译方法调用时运行，而不是在声明类时运行（因为调用方法是潜在的坏部分，而不是不声明它）。这绝对是他们可以添加的东西，但它不会捕获任何有用的东西，所以他们可能认为这不值得。

# asp.net-mvc-3 - 剃刀 MVC 3 中的 HTML

> ID：10936329
> 
> 赞同：0
> 
> 时间：2012-06-07T16:54:29.080
> 
> 标签：asp.net-mvc-3, razor

我怎样才能在 MVC 3 Razor 中正确地写这个？

```
<li  <%if(ViewContext.RouteData.Values["Controller"].ToString() == "Home"){%> class="active"<%} %>><a href="@Url.Action("index", "Home")">Home</a></li> 
```

祝福

编辑

这是我的代码，不起作用:(

```
<div class="navbar">
 <div class="navbar-inner">
   <div class="container">
    <a class="brand" href="#">CYSAC 2.0</a>
        <ul class="nav">
            <li @(ViewContext.RouteData.Values["Controller"].ToString() == "Home" ? "class=\"active\"" : string.Empty)><a href="@Url.Action("index", "Home")">Inicio</a></li>
            <li @(ViewContext.RouteData.Values["Controller"].ToString() == "University" ? "class=\"active\"" : string.Empty)><a href="@Url.Action("index", "University")">University</a></li>
            <li @(ViewContext.RouteData.Values["Controller"].ToString() == "Estudent" ? "class=\"active\"" : string.Empty)><a href="@Url.Action("index", "Estudent")">Estudent</a></li>

        </ul>
  </div>
 </div><!-- /navbar-inner -->
</div><!-- /navbar --> 
```

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T16:58:11.390

我会这样写：

```
<li class="@ViewContext.RouteData.Values["Controller"].ToString() == "Home" ? "active" : """>
    <a href="@Url.Action("index", "Home")">Home</a>
</li> 
```

如果它不是当前控制器，则它有一个 class="" 的缺点，但在最新版本的 Razor 中，它会识别并删除它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T10:12:37.003

今天我发现自己处于同样的境地（5 个月后）。

1) 定义变量 controllerName 并设置控制器名称 .ToLower()

2) 与 Equals("home") 比较

```
 @{ 
        var controllerName = ViewContext.RouteData.Values["Controller"].ToString().ToLower(); 
    }
    <div class="navbar">
     <div class="navbar-inner">
       <div class="container">
        <a class="brand" href="#">CYSAC 2.0</a>
            <ul class="nav">
                <li class="@(controllerName.Equals("home") ? "active" : "")"><a href="@Url.Action("index", "Home")">Inicio</a></li>
                <li class="@(controllerName.Equals("university") ? "active" : "")"><a href="@Url.Action("index", "University")">University</a></li>
                <li class="@(controllerName.Equals("estudent") ? "active" : "")"><a href="@Url.Action("index", "Estudent")">Estudent</a></li>

            </ul>
      </div>
     </div><!-- /navbar-inner -->
    </div><!-- /navbar --> 
```

为我工作！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T16:58:26.753

您可以使用`@(expression)`- 语法：

```
<li class="@((ViewContext.RouteData.Values["Controller"].ToString() == "Home" ?
           "active" : string.Empty)">
    <a href="@Url.Action("index", "Home")">Home</a>
</li> 
```

# php - Symfony/学说

> ID：10936331
> 
> 赞同：2
> 
> 时间：2012-06-07T16:54:35.433
> 
> 标签：php, symfony, doctrine

我目前正在通过[阅读文档](http://symfony.com/doc/current/book/doctrine.html)来学习 Symfony 和 Doctrine 。

我不明白**find**和**findOneById**之间的区别。我试图在这个简单的例子中同时使用它们，看起来它们对我做同样的事情。

```
$product = $this->getDoctrine()
                ->getRepository('AcmeStoreBundle:ProductEntity')
                ->findOneById($id); 
```

它们真的是一回事还是有一些不同？我在哪里可以找到所有这些方法的详细文档？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-07T17:20:53.237

在你的情况下，他们碰巧做同样的事情。查看[此示例](http://symfony.com/doc/current/book/doctrine.html#fetching-objects-from-the-database)，您会注意到它`find()`查找以主键命名的字段。`findOneBy<Field>()`将显式使用方法名称中的字段，即使它不是主键，也会返回第一条记录。所以，最后，如果主键确实是命名的`id`，那么两者都会做同样的事情。

```
// query by the primary key (usually "id")
$product = $repository->find($id);

// dynamic method names to find based on a column value
$product = $repository->findOneById($id);
$product = $repository->findOneByName('foo'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T17:26:45.087

[这里](http://www.doctrine-project.org/api/orm/2.1/class-Doctrine.ORM.EntityRepository.html)有一个API我认为没有什么区别：这两种方法，当调用你调用它们的方式时，这样做：

```
return $this->_em->getUnitOfWork()->getEntityPersister($this->_entityName)->load($id); 
```

但是在某些情况下 find 会越来越快，因为它不使用`__call`魔法方法，并且因为`find()`之前检查当前工作单元的映射而 load() 没有（参见@todo）：

```
/**                                                                         
 * Loads an entity by a list of field criteria.                             
 * ...
 * 
 * @todo Check identity map? loadById method? Try to guess whether $criteria is the id?
 */                                                                         
public function load(array $criteria, $entity = null, $assoc = null, array $hints = array(), $lockMode = 0) 
```

所以 prefer `find()`,`findOneById()`只是一种效率较低的方法来做同样的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-16T10:38:42.787

其实不是一回事。

想想看。如果您调用“findBy()”，您假设您将收到一组实体（0、1 或多个）。因此，要获得所有结果，您需要迭代 ArrayCollection 或只获得第一个（ $result->first() ）。

如果您的查询是通过唯一键（如本例），您可以通过调用“getOneById()”获取唯一实体，您将收到该实体作为结果。

```
/**
 * Retrieving Product with 'findOneBy'
 */
$product = $this->getDoctrine()
                ->getRepository('AcmeStoreBundle:ProductEntity')
                ->findOneById($id);

/**
 * Retrieving Product with 'findBy'
 */
$product = $this->getDoctrine()
                ->getRepository('AcmeStoreBundle:ProductEntity')
                ->findById($id)
                ->first(); 
```

从语义上讲，第一个是最好的。

*提示

实体应该被称为产品。为什么？因为在“/Entity”文件夹下（Almost, should...），命名空间将包含有关“什么是产品”的信息

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-11-17T04:48:20.690

```
// query by the primary key (usually "id")
$product = $repository->find($id);

// dynamic method names to find based on a column value
$product = $repository->findOneById($id);
// $foo is any name which you want to find from database
$product = $repository->findOneByName($foo); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-08-04T16:04:43.603

它最终调用相同的方法。

```
findByKey('value') 
```

基本上是一样的

```
findBy(array('key' => 'value')) 
```

其中key是实体的属性，value是属性的值。

```
findById($id) 
```

是上述情况的特例。也是如此

```
find($id) 
```

所有这些方法最终都执行相同的查询。但是，有区别

```
findBy() 
```

和

```
findOneBy() 
```

其中 findOneBy() 只返回一个结果，而 findBy 将返回所有满足需求的结果。

但是，一般来说，使用 DQL 查询被认为是一种很好的做法。考虑延迟加载、数组水合、准备好的语句等。这是一篇关于该主题的有趣文章： [Some Doctrine 2 Best Practices](http://www.uvd.co.uk/blog/some-doctrine-2-best-practices/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-15T03:22:53.410

是一样的，但我更喜欢 findOneBy 方法。更清楚了。

# macos - Mac问题上存在Shell脚本文件

> ID：10936333
> 
> 赞同：3
> 
> 时间：2012-06-07T16:54:57.253
> 
> 标签：macos, file, shell

好的，所以我在 Linux Ubuntu 中编写了一个 .sh 文件，它运行良好。但是，在 Mac 上，即使文件位于同一目录中，它也总是返回未找到该文件。谁能帮我吗？

.sh 文件：

```
if [ ! -f file-3*.jar ]; then
echo "[INFO] jar could not be found."
exit
fi 
```

只是想我要补充一下，这不是一个以上的文件，而是一个重命名为多个结尾的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T19:42:58.167

在对@Paul R 的回答的评论中，您说“shell 脚本也与 jar 文件位于同一目录中。因此，他们可以在指定 SH 文件默认情况下使用终端打开后双击它。” 我怀疑这是问题所在——当您通过双击运行 shell 脚本时，它运行的工作目录设置为用户的主目录，而不是脚本所在的目录。您可以通过将脚本 cd 放到它所在的目录来解决此问题：

```
cd "$(dirname "$BASH_SOURCE")" 
```

编辑：当然，$BASH_SOURCE 是其他 shell 中不可用的 bash 扩展。如果您的脚本不能指望在 bash 中运行，请改用它：

```
case "$0" in
    */*)
        cd "$(dirname "$0")" ;;
    *)
        me="$(which "$0")"
        if [ -n "$me" ]; then
            cd "$(dirname "$me")"
        else
            echo "Can't locate script directory" >&2
            exit 1
        fi ;;
esac 
```

顺便说一句，这个结构`[ ! -f file-3*.jar ]`让我很紧张，因为如果匹配的文件不止一个，它就会奇怪地失败。（我知道，这不应该发生；但是不应该发生的事情无论如何都会发生任何令人讨厌的趋势。）我会改用这个：

```
matchfiles=(file-3*.jar)
if [ ! -f "${matchfiles[0]}" ]; then
    ... 
```

同样，如果你不能指望 bash 扩展，这里有一个可以在任何 POSIX shell 中工作的替代方案：

```
if [ ! -f "$(echo file-3*.jar)" ]; then 
```

请注意，如果有多个匹配项，这将失败（即，就像文件不存在一样）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:04:47.187

我认为问题出在其他地方，因为脚本在 Mac OS X 上按预期工作：

```
$ if [ ! -f file-3*.jar ]; then echo "[INFO] jar could not be found."; fi
[INFO] jar could not be found.
$ touch file-302.jar
$ if [ ! -f file-3*.jar ]; then echo "[INFO] jar could not be found."; fi
$ 
```

也许您的脚本在错误的外壳下运行，或者在错误的工作目录中？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:22:17.990

不是它不适合你，它不适合你的用户吗？多年来，OS X 的默认 shell 已经发生了变化（参见[这篇文章](http://support.apple.com/kb/TA27005)）——但看起来你的评论说你已经准备`#!`好了。

您确定您的用户将 JAR 文件放在正确的位置吗？也许不是脚本错误，而是它告诉您正确答案 - 运行脚本的位置缺少所需的文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T23:06:39.427

这与其说是一个答案，不如说是一种策略：考虑一些严肃的日志记录。将消息回显到屏幕和日志文件，然后添加额外的日志记录，`"[INFO] jar could not be found."`例如 和 的值到日志中。然后，当您的客户/同事尝试运行脚本但失败时，他们可以通过电子邮件将日志发送给您。`$PWD``$SHELL``$0`

我可能会使用类似的东西

```
screenlog() {
    echo "$*"
    echo "$*" >> $LOGFILE
}

log() {
    echo "$*" >> $LOGFILE
} 
```

`$LOGFILE`在脚本顶部定义。然后在你的脚本中加入`screenlog "[INFO] jar could not be found."`or之类的语句`log "\$PWD: $PWD"`。

# asp-classic - 计算数组中字符串出现次数的更多问题

> ID：10936335
> 
> 赞同：0
> 
> 时间：2012-06-07T16:55:02.453
> 
> 标签：asp-classic, vbscript

我正在从其他地方复制一个问题和答案，因为它部分符合我的需要，但不完全。

在 ASP 经典中，有没有办法计算字符串在字符串数组中出现的次数并根据字符串和出现次数输出？

例如，如果我有一个包含以下内容的数组：

```
你好
快乐的
你好
你好
测试
你好
测试
快乐的

```

输出将是：

```
你好 4
快乐 2
测试 1
测试 1

```

给出的答案是这样的：

我假设语言是 VBScript（因为这是大多数人使用经典 ASP 的语言）。

您可以使用 Dictionary 对象来跟踪各个计数：

```
Function CountValues(pArray)
    Dim i, item
    Dim dictCounts
    Set dictCounts = Server.CreateObject("Scripting.Dictionary")
    For i = LBound(pArray) To UBound(pArray)
        item = pArray(i)
        If Not dictCounts.Exists(item) Then 
            dictCounts.Add item, 0
        End If
        dictCounts.Item(item) = dictCounts.Item(item) + 1
    Next
    Set CountValues = dictCounts
End Function 
```

这很棒，但我不知道如何获取前 2 个最常用的单词，显示它们并能够将它们放入自己的变量中以在其他地方使用。

有人能帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-10T08:23:12.030

您不能在 VBScript 中对 Dictionary 对象进行排序，因此您必须使用其他东西。

我的建议是使用断开连接的 Recordset 对象来保存项目及其出现。这样的对象本身就支持排序，而且很容易使用。要实现这一点，请改用以下功能：

```
Function CountValues_Recordset(pArray)
    Dim i, item
    Dim oRS
    Const adVarChar = 200
    Const adInteger = 3
    Set oRS = CreateObject("ADODB.Recordset")
    oRS.Fields.Append "Item", adVarChar, 255
    oRS.Fields.Append "Occurrences", adInteger, 255
    oRS.Open
    For i = LBound(pArray) To UBound(pArray)
        item = pArray(i)
        oRS.Filter = "Item='" & Replace(item, "'", "''") & "'"
        If (oRS.EOF) Then
            oRS.AddNew
            oRS.Fields("Item").Value = item
            oRS.Fields("Occurrences").Value = 1
        Else  
            oRS.Fields("Occurrences").Value = oRS.Fields("Occurrences").Value + 1
        End If
        oRS.Update
        oRS.Filter = ""
    Next
    oRS.Sort = "Occurrences DESC"
    oRS.MoveFirst
    Set CountValues_Recordset = oRS
End Function 
```

并使用它来实现您想要的输出：

```
Dim myArray, oRS
myArray = Array("happy", "hello", "hello", "testing", "hello", "test", "hello", "happy")
Set oRS = CountValues_Recordset(myArray)
Do Until oRS.EOF
    Response.Write(oRS("item") & " " & oRS("Occurrences") & "<br />")
    oRS.MoveNext
Loop
oRS.Close
Set oRS = Nothing 
```

使用后不要忘记关闭并处理记录集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T21:21:11.960

[您可以使用此方法](http://www.devguru.com/technologies/vbscript/quickref/dictionary_keys.html)遍历字典对象。在该循环中，跟踪前两个键及其在新数组或两个新变量中的计数。

# c++ - glGenFramebuffers 中的段错误

> ID：10936338
> 
> 赞同：5
> 
> 时间：2012-06-07T16:55:09.470
> 
> 标签：c++, opengl, ubuntu, glew

我遇到了段错误，不知道为什么。与我一起工作的人在 OSX 机器上编译并正确运行。gdb backtrace 告诉我它来自这部分代码，特别是来自 glGenFramebuffers：

```
 // Render the warped texture mapped triangles to framebuffer
GLuint myFBO;
GLuint myTexture;

glEnable(GL_TEXTURE_2D);
glGenTextures(1, &myTexture);
glBindTexture(GL_TEXTURE_2D, myTexture);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, size.width, size.height, 0, GL_RGB, GL_UNSIGNED_BYTE, 0);
glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_REPLACE);

glGenFramebuffers(1, &myFBO);
glBindFramebuffer(GL_FRAMEBUFFER_EXT, myFBO); 
```

我正在使用操作系统提供的 Nvidia 最新专有驱动程序运行 12.04 Ubuntu 和 Nvidia 卡。我对 OpenGL 不是很熟悉，很多代码是我的伙伴的，他似乎也被难住了。如果您需要任何进一步的信息，我很乐意提供。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:19:59.430

答案其实很简单。OSX 编码人员在开始使用 glew 调用之前不需要调用 glewInit() - Linux 和 Windows 用户需要。另外，我发现了另一条有趣的信息：检查您是否能够使用 glxinfo 执行直接渲染。它可以在运行 OpenGL 程序时产生重大影响。

# mysql - mysql right join with not in (select)

> ID：10936339
> 
> 赞同：0
> 
> 时间：2012-06-07T16:55:13.993
> 
> 标签：mysql, join, notin

我遇到了（对我而言）相当复杂的查询问题。每个单独的部分都有效，它不会产生错误，但它不会返回它应该返回的内容。

```
table_c = things to belong to
table_s = users that belong to things in table_c
table_u = users 
```

查询是：

```
SELECT * FROM table_c AS C 
RIGHT JOIN table_u AS U ON C.userid = U.user_id 
WHERE C.userid='xxx' 
  AND C.c_county IN (11, 00) 
  AND C.c_state IN (12, 00) 
  AND C.c_nation='US' 
  AND C.c_privacy='0' 
  AND C.userid NOT IN ( 
    SELECT userid FROM table_s AS S WHERE S.channel_id = C.id)
ORDER BY U.security, C.chan_name 
```

我需要做的是在table_c 中选择所有“属于的事物”，其中table_c 的县/州/国家与table_u 中的用户县/州/国家设置相匹配，或者“属于的事物”是00（没有位置）并且用户 ID 尚未在 table_s 中。

我在第 12 州第 11 县的 table_c 中创建了一个游乐场，来自第 11 县和第 12 州的用户想要找到他们可以属于的所有东西，因此他们查询应该返回我的游乐场。

这仅在 WHERE C.userid='xxx' 中的用户 ID 属于创建游乐场的人时才有效。
我想要的是让用户创建属于自己的东西，然后让其他人加入那个东西，所以 WHERE userid='xxx' 部分是不正确的，我不知道如何写它......

这是清澈的还是像泥一样清澈的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:02:03.280

答案是完全删除连接......因为我已经有了建立县/州/国家所需的用户信息，所以我还有其他一切，所以不需要加入......

感谢您的额外眼睛！

# entity-framework - 从 Advantage 数据库生成实体时没有关系

> ID：10936343
> 
> 赞同：0
> 
> 时间：2012-06-07T16:55:22.003
> 
> 标签：entity-framework, advantage-database-server

我正在尝试通过实体框架将现有 Advantage 数据库（最近从 v8 升级到 v10）中的表添加到 .NET 项目。但是，无论我做什么，表之间的关系都不会从数据库中导入。显然，我可以在 Visual Studio 中重新创建它们，但我更愿意将数据结构主要保留在数据库中。

[此链接](http://devzone.advantagedatabase.com/dz/content.aspx?Key=17&RefNo=120514-2520)描述了问题，但解决方案（权限问题）对我不起作用。我们在连接中使用 IGNORERIGHTS 安全模式，并且未在数据库上启用用户权限。

根据[这一章](http://www.jensendatasystems.com/ADSBook10/files/Chapter%2019%20ADS%20and%20the%20.NET%20Entity%20Framework.pdf)，我已经确定有问题的表是 ADT 表，并且具有不可为空的主键。我还验证了 RI 约束存在并显示在 Advantage 的视觉设计器中。

尽管如此，当我在 EDMX 中“从数据库更新模型”并选择它们之间有引用的表时，不会创建任何引用。

还有什么我可以尝试的吗？我错过了一些步骤？需要更改的设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-29T10:44:47.313

我最终出于完全不相关的原因删除了 EDMX，当我重新创建它时，关系工作得很好。马克的建议很可能是答案，但仅限于新的。不过，我没有进行任何广泛的测试来尝试确认这一点。

# perl - 使用 CPANM 安装 DBI 模块和 DBD::Oracle 驱动程序

> ID：10936348
> 
> 赞同：1
> 
> 时间：2012-06-07T16:55:37.893
> 
> 标签：perl, solaris, cpan, dbi

因此，根据我在 stackoverflow 上获得的说明，我尝试使用 perlbrew 在我的 64 位 Solaris 虚拟机上安装新版本的 Perl，以便最终安装“cpanm”并安装 CGI 和 DBI 模块，以及DBD::Oracle 驱动程序。这些是我遵循的步骤：

1) 安装 gcc 和其他构建工具。

2,3) 安装 perlbrew...

4) 安装新的 Perl

忽略 Socket.pm 中的测试失败后成功安装 Perl 5.16.0

```
 Test Summary Report
    -------------------
    ../cpan/Socket/t/getnameinfo.t   (Wstat: 256 Tests: 14 Failed: 1)
      Failed test:  10
      Non-zero exit status: 1 
```

5) 安装模块...

当我尝试使用 安装 DBI 模块`cpanm -v DBI`时，这是给定的输出。

```
Test Summary Report
    -------------------
    t/zvg_85gofer.t               (Wstat: 256 Tests: 211 Failed: 1)
      Failed test:  107
      Non-zero exit status: 1
    t/zvn_85gofer.t               (Wstat: 256 Tests: 211 Failed: 1)
      Failed test:  81
      Non-zero exit status: 1
    t/zvp_85gofer.t               (Wstat: 256 Tests: 219 Failed: 1)
      Failed test:  89
      Non-zero exit status: 1
    Files=182, Tests=8252, 128 wallclock secs ( 3.67 usr  2.56 sys + 82.68 cusr 37.78 csys = 126.69 CPU)
    Result: FAIL
    Failed 3/182 test programs. 3/8252 subtests failed.
    *** Error code 255
    make: Fatal error: Command failed for target `test_dynamic'
    FAIL
    ! Installing DBI failed. See /home/oracle/.cpanm/build.log for details. 
```

所以我继续做了一个`vi /home/oracle/.cpanm/build.log`，这就是 build.log 中的内容：

```
cpanm (App::cpanminus) 1.5011 on perl 5.016000 built for i86pc-solaris
Work directory is /home/oracle/.cpanm/work/1339087258.18143
You have make /usr/bin/make
You have /usr/bin/wget
You have /usr/sbin/tar, /usr/bin/gzip and /usr/bin/bzip2
You have /usr/bin/unzip
Searching DBI on cpanmetadb ...
--> Working on DBI
Fetching http://www.cpan.org/authors/id/T/TI/TIMB/DBI-1.622.tar.gz
-> OK
Unpacking DBI-1.622.tar.gz
Entering DBI-1.622
Checking configure dependencies from META.yml
Checking if you have ExtUtils::MakeMaker 0 ... Yes (6.63_02)
Configuring DBI-1.622
Running Makefile.PL
-> OK
Checking dependencies from MYMETA.json ...
Checking if you have ExtUtils::MakeMaker 6.48 ... Yes (6.63_02)
Checking if you have Test::Simple 0.90 ... Yes (0.98)
Building and testing DBI-1.622
-> FAIL Installing DBI failed. See /home/oracle/.cpanm/build.log for details.
~
"~/.cpanm/build.log" 22 lines, 858 characters 
```

**Doing 的输出** `cd ~/.cpanm/latest-build/DBI-1.622`，后跟`make test > /home/oracle/Desktop/DBI_Output`：

```
PERL_DL_NONLAZY=1 /home/oracle/perl5/perlbrew/perls/perl-5.16.0/bin/perl "-MExtUtils::Command::MM" "-e" "test_harness(0, 'blib/lib', 'blib/arch')" t/*.t
t/01basics.t .................... ok
t/02dbidrv.t .................... ok
t/03handle.t .................... ok
t/04mods.t ...................... ok
t/05concathash.t ................ ok
t/06attrs.t ..................... ok
t/07kids.t ...................... ok
t/08keeperr.t ................... ok
t/09trace.t ..................... ok
t/10examp.t ..................... ok
t/11fetch.t ..................... ok
t/12quote.t ..................... ok
t/13taint.t ..................... ok
t/14utf8.t ...................... ok
t/15array.t ..................... ok
t/16destroy.t ................... ok
t/19fhtrace.t ................... ok
t/20meta.t ...................... ok
t/30subclass.t .................. ok
t/31methcache.t ................. ok
t/35thrclone.t .................. skipped: this solaris perl 5.016000 not supported for DBI iThreads
t/40profile.t ................... ok
t/41prof_dump.t ................. ok
t/42prof_data.t ................. ok
t/43prof_env.t .................. ok
t/48dbi_dbd_sqlengine.t ......... ok
t/49dbd_file.t .................. ok
t/50dbm_simple.t ................ ok
t/51dbm_file.t .................. ok
t/52dbm_complex.t ............... skipped: DBI::SQL::Nano is being used
t/60preparse.t .................. ok
t/65transact.t .................. ok
t/70callbacks.t ................. ok
t/72childhandles.t .............. ok
t/80proxy.t ..................... skipped: modules required for proxy are probably not installed (e.g., RPC/PlClient.pm)
t/85gofer.t ..................... ok
t/86gofer_fail.t ................ ok
t/87gofer_cache.t ............... ok
t/90sql_type_cast.t ............. ok
t/pod-coverage.t ................ skipped: Test::Pod::Coverage 1.04 required for testing POD coverage
t/pod.t ......................... skipped: Test::Pod 1.00 required for testing POD
t/zvg_01basics.t ................ ok
t/zvg_02dbidrv.t ................ ok
t/zvg_03handle.t ................ ok
t/zvg_04mods.t .................. ok
t/zvg_05concathash.t ............ ok
t/zvg_06attrs.t ................. ok
t/zvg_07kids.t .................. ok
t/zvg_08keeperr.t ............... ok
t/zvg_09trace.t ................. ok
t/zvg_10examp.t ................. ok
t/zvg_11fetch.t ................. ok
t/zvg_12quote.t ................. ok
t/zvg_13taint.t ................. skipped: Taint attribute tests not functional with DBI_AUTOPROXY
t/zvg_14utf8.t .................. ok
t/zvg_15array.t ................. ok
t/zvg_16destroy.t ............... ok
t/zvg_19fhtrace.t ............... ok
t/zvg_20meta.t .................. ok
t/zvg_30subclass.t .............. ok
t/zvg_31methcache.t ............. ok
t/zvg_35thrclone.t .............. skipped: this solaris perl 5.016000 not supported for DBI iThreads
t/zvg_40profile.t ............... ok
t/zvg_41prof_dump.t ............. ok
t/zvg_42prof_data.t ............. ok
t/zvg_43prof_env.t .............. ok
t/zvg_48dbi_dbd_sqlengine.t ..... ok
t/zvg_49dbd_file.t .............. ok
t/zvg_50dbm_simple.t ............ ok
t/zvg_51dbm_file.t .............. ok
t/zvg_52dbm_complex.t ........... skipped: DBI::SQL::Nano is being used
t/zvg_60preparse.t .............. ok
t/zvg_65transact.t .............. skipped: Transactions not supported by DBD::Gofer
t/zvg_70callbacks.t ............. ok
t/zvg_72childhandles.t .......... ok
t/zvg_80proxy.t ................. skipped: modules required for proxy are probably not installed (e.g., RPC/PlClient.pm)
t/zvg_85gofer.t ................. ok
t/zvg_86gofer_fail.t ............ skipped: Gofer DBI_AUTOPROXY
t/zvg_87gofer_cache.t ........... skipped: Gofer DBI_AUTOPROXY
t/zvg_90sql_type_cast.t ......... ok
t/zvn_48dbi_dbd_sqlengine.t ..... ok
t/zvn_49dbd_file.t .............. ok
t/zvn_50dbm_simple.t ............ ok
t/zvn_51dbm_file.t .............. ok
t/zvn_52dbm_complex.t ........... skipped: DBI::SQL::Nano is being used
t/zvn_85gofer.t ................. 
Dubious, test returned 1 (wstat 256, 0x100)
Failed 1/219 subtests 
    (less 16 skipped subtests: 202 okay)
t/zvp_01basics.t ................ ok
t/zvp_02dbidrv.t ................ ok
t/zvp_03handle.t ................ ok
t/zvp_04mods.t .................. ok
t/zvp_05concathash.t ............ ok
t/zvp_06attrs.t ................. ok
t/zvp_07kids.t .................. skipped: $h->{Kids} attribute not supported for DBI::PurePerl
t/zvp_08keeperr.t ............... ok
t/zvp_09trace.t ................. ok
t/zvp_10examp.t ................. ok
t/zvp_11fetch.t ................. ok
t/zvp_12quote.t ................. ok
t/zvp_13taint.t ................. skipped: Taint attributes not supported with DBI::PurePerl
t/zvp_14utf8.t .................. ok
t/zvp_15array.t ................. ok
t/zvp_16destroy.t ............... ok
t/zvp_19fhtrace.t ............... ok
t/zvp_20meta.t .................. ok
t/zvp_30subclass.t .............. ok
t/zvp_31methcache.t ............. ok
t/zvp_35thrclone.t .............. skipped: this solaris perl 5.016000 not supported for DBI iThreads
t/zvp_40profile.t ............... skipped: profiling not supported for DBI::PurePerl
t/zvp_41prof_dump.t ............. skipped: profiling not supported for DBI::PurePerl
t/zvp_42prof_data.t ............. skipped: profiling not supported for DBI::PurePerl
t/zvp_43prof_env.t .............. skipped: profiling not supported for DBI::PurePerl
t/zvp_48dbi_dbd_sqlengine.t ..... ok
t/zvp_49dbd_file.t .............. ok
t/zvp_50dbm_simple.t ............ ok
t/zvp_51dbm_file.t .............. ok
t/zvp_52dbm_complex.t ........... skipped: DBI::SQL::Nano is being used
t/zvp_60preparse.t .............. skipped: preparse not supported for DBI::PurePerl
t/zvp_65transact.t .............. ok
t/zvp_70callbacks.t ............. skipped: $h->{Callbacks} attribute not supported for DBI::PurePerl
t/zvp_72childhandles.t .......... ok
t/zvp_80proxy.t ................. skipped: modules required for proxy are probably not installed (e.g., RPC/PlClient.pm)
t/zvp_85gofer.t ................. ok
t/zvp_86gofer_fail.t ............ skipped: requires Callbacks which are not supported with PurePerl
t/zvp_87gofer_cache.t ........... ok
t/zvp_90sql_type_cast.t ......... ok
t/zvxgn_48dbi_dbd_sqlengine.t ... ok
t/zvxgn_49dbd_file.t ............ ok
t/zvxgn_50dbm_simple.t .......... ok
t/zvxgn_51dbm_file.t ............ ok
t/zvxgn_52dbm_complex.t ......... skipped: DBI::SQL::Nano is being used
t/zvxgn_85gofer.t ............... 
Dubious, test returned 2 (wstat 512, 0x200)
Failed 2/202 subtests 
    (less 35 skipped subtests: 165 okay)
t/zvxgnp_48dbi_dbd_sqlengine.t .. ok
t/zvxgnp_49dbd_file.t ........... ok
t/zvxgnp_50dbm_simple.t ......... ok
t/zvxgnp_51dbm_file.t ........... ok
t/zvxgnp_52dbm_complex.t ........ skipped: DBI::SQL::Nano is being used
t/zvxgnp_85gofer.t .............. 
Dubious, test returned 1 (wstat 256, 0x100)
Failed 1/216 subtests 
    (less 40 skipped subtests: 175 okay)
t/zvxgp_01basics.t .............. ok
t/zvxgp_02dbidrv.t .............. ok
t/zvxgp_03handle.t .............. ok
t/zvxgp_04mods.t ................ ok
t/zvxgp_05concathash.t .......... ok
t/zvxgp_06attrs.t ............... ok
t/zvxgp_07kids.t ................ skipped: $h->{Kids} attribute not supported for DBI::PurePerl
t/zvxgp_08keeperr.t ............. ok
t/zvxgp_09trace.t ............... ok
t/zvxgp_10examp.t ............... ok
t/zvxgp_11fetch.t ............... ok
t/zvxgp_12quote.t ............... ok
t/zvxgp_13taint.t ............... skipped: Taint attributes not supported with DBI::PurePerl
t/zvxgp_14utf8.t ................ ok
t/zvxgp_15array.t ............... ok
t/zvxgp_16destroy.t ............. ok
t/zvxgp_19fhtrace.t ............. ok
t/zvxgp_20meta.t ................ ok
t/zvxgp_30subclass.t ............ ok
t/zvxgp_31methcache.t ........... ok
t/zvxgp_35thrclone.t ............ skipped: this solaris perl 5.016000 not supported for DBI iThreads
t/zvxgp_40profile.t ............. skipped: profiling not supported for DBI::PurePerl
t/zvxgp_41prof_dump.t ........... skipped: profiling not supported for DBI::PurePerl
t/zvxgp_42prof_data.t ........... skipped: profiling not supported for DBI::PurePerl
t/zvxgp_43prof_env.t ............ skipped: profiling not supported for DBI::PurePerl
t/zvxgp_48dbi_dbd_sqlengine.t ... ok
t/zvxgp_49dbd_file.t ............ ok
t/zvxgp_50dbm_simple.t .......... ok
t/zvxgp_51dbm_file.t ............ ok
t/zvxgp_52dbm_complex.t ......... skipped: DBI::SQL::Nano is being used
t/zvxgp_60preparse.t ............ skipped: preparse not supported for DBI::PurePerl
t/zvxgp_65transact.t ............ skipped: Transactions not supported by DBD::Gofer
t/zvxgp_70callbacks.t ........... skipped: $h->{Callbacks} attribute not supported for DBI::PurePerl
t/zvxgp_72childhandles.t ........ ok
t/zvxgp_80proxy.t ............... skipped: modules required for proxy are probably not installed (e.g., RPC/PlClient.pm)
t/zvxgp_85gofer.t ............... 
Dubious, test returned 1 (wstat 256, 0x100)
Failed 1/217 subtests 
    (less 40 skipped subtests: 176 okay)
t/zvxgp_86gofer_fail.t .......... skipped: requires Callbacks which are not supported with PurePerl
t/zvxgp_87gofer_cache.t ......... skipped: Gofer DBI_AUTOPROXY
t/zvxgp_90sql_type_cast.t ....... ok
t/zvxnp_48dbi_dbd_sqlengine.t ... ok
t/zvxnp_49dbd_file.t ............ ok
t/zvxnp_50dbm_simple.t .......... ok
t/zvxnp_51dbm_file.t ............ ok
t/zvxnp_52dbm_complex.t ......... skipped: DBI::SQL::Nano is being used
t/zvxnp_85gofer.t ............... ok

Test Summary Report
-------------------
t/zvn_85gofer.t               (Wstat: 256 Tests: 219 Failed: 1)
  Failed test:  141
  Non-zero exit status: 1
t/zvxgn_85gofer.t             (Wstat: 512 Tests: 202 Failed: 2)
  Failed tests:  87, 98
  Non-zero exit status: 2
t/zvxgnp_85gofer.t            (Wstat: 256 Tests: 216 Failed: 1)
  Failed test:  138
  Non-zero exit status: 1
t/zvxgp_85gofer.t             (Wstat: 256 Tests: 217 Failed: 1)
  Failed test:  113
  Non-zero exit status: 1
Files=182, Tests=8231, 126 wallclock secs ( 3.41 usr  2.41 sys + 80.87 cusr 37.61 csys = 124.30 CPU)
Result: FAIL
*** Error code 255 
```

**然后我继续尝试找出 zvxgn_85gofer.t 出了什么问题。所以我做了`make test TEST_VERBOSE=1`：**

```
t/zvxnp_85gofer.t ............... 
# Transports: null pipeone stream stream_ssh
# Policies: pedantic classic rush
# Count: 0
# =============
# Testing null transport with pedantic policy
#  dbi:Gofer:transport=null;policy=pedantic;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 1 - should connect to dbi:Gofer:transport=null;policy=pedantic;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 2
ok 3
ok 4
ok 5 - should detect prepare failure
ok 6
ok 7
ok 8
ok 9
ok 10
ok 11
ok 12 - go_response executed flag should be true
ok 13
ok 14
ok 15
ok 16
# Testing go_request_count and caching of simple values
ok 17
ok 18
ok 19
# use_remote=1 (policy=pedantic, transport=null) HASH(0x8a56738)
ok 20
ok 21
ok 22
ok 23 # skip caching of metadata methods returning sth not yet implemented
ok 24 # skip caching of metadata methods returning sth not yet implemented
ok 25
ok 26
# =============
# Testing null transport with classic policy
#  dbi:Gofer:transport=null;policy=classic;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 27 - should connect to dbi:Gofer:transport=null;policy=classic;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 28
ok 29
ok 30
ok 31 - The object isa DBI::st
ok 32
ok 33
ok 34
ok 35
ok 36
ok 37
ok 38 - go_response executed flag should be true
ok 39
ok 40
ok 41
ok 42
# Testing go_request_count and caching of simple values
ok 43
ok 44
ok 45
# use_remote=0 (policy=classic, transport=null) HASH(0x8a40118)
ok 46
ok 47
ok 48
ok 49 # skip caching of metadata methods returning sth not yet implemented
ok 50 # skip caching of metadata methods returning sth not yet implemented
ok 51
ok 52
# =============
# Testing null transport with rush policy
#  dbi:Gofer:transport=null;policy=rush;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 53 - should connect to dbi:Gofer:transport=null;policy=rush;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 54
ok 55
ok 56
ok 57 - The object isa DBI::st
ok 58
ok 59
ok 60
ok 61
ok 62
ok 63
ok 64 - go_response executed flag should be true
ok 65
ok 66
ok 67
ok 68
# Testing go_request_count and caching of simple values
ok 69
ok 70
ok 71
# use_remote=0 (policy=rush, transport=null) HASH(0x8a51920)
ok 72
ok 73
ok 74
ok 75 # skip caching of metadata methods returning sth not yet implemented
ok 76 # skip caching of metadata methods returning sth not yet implemented
ok 77
ok 78
# =============
# Testing pipeone transport with pedantic policy
#  dbi:Gofer:transport=pipeone;policy=pedantic;perl=/home/oracle/perl5/perlbrew/perls/perl-5.16.0/bin/perl  -Mblib=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/blib;timeout=240;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 79 - should connect to dbi:Gofer:transport=pipeone;policy=pedantic;perl=/home/oracle/perl5/perlbrew/perls/perl-5.16.0/bin/perl  -Mblib=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/blib;timeout=240;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 80
ok 81
ok 82
ok 83 - should detect prepare failure
ok 84
ok 85
ok 86
ok 87
ok 88
ok 89
ok 90 - go_response executed flag should be true
ok 91
ok 92
ok 93
ok 94
# Testing go_request_count and caching of simple values
ok 95
ok 96
ok 97
# use_remote=1 (policy=pedantic, transport=pipeone) HASH(0x8aa2600)
ok 98
ok 99
ok 100
ok 101 # skip caching of metadata methods returning sth not yet implemented
ok 102 # skip caching of metadata methods returning sth not yet implemented
ok 103
ok 104
# =============
# Testing pipeone transport with classic policy
#  dbi:Gofer:transport=pipeone;policy=classic;perl=/home/oracle/perl5/perlbrew/perls/perl-5.16.0/bin/perl  -Mblib=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/blib;timeout=240;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 105 - should connect to dbi:Gofer:transport=pipeone;policy=classic;perl=/home/oracle/perl5/perlbrew/perls/perl-5.16.0/bin/perl  -Mblib=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/blib;timeout=240;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 106
ok 107
ok 108
ok 109 - The object isa DBI::st
ok 110
ok 111
ok 112
ok 113
ok 114
ok 115
ok 116 - go_response executed flag should be true
ok 117
ok 118
ok 119
ok 120
# Testing go_request_count and caching of simple values
ok 121
ok 122
ok 123
# use_remote=0 (policy=classic, transport=pipeone) HASH(0x8aa2550)
ok 124
ok 125
ok 126
ok 127 # skip caching of metadata methods returning sth not yet implemented
ok 128 # skip caching of metadata methods returning sth not yet implemented
ok 129
ok 130
# =============
# Testing pipeone transport with rush policy
#  dbi:Gofer:transport=pipeone;policy=rush;perl=/home/oracle/perl5/perlbrew/perls/perl-5.16.0/bin/perl  -Mblib=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/blib;timeout=240;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 131 - should connect to dbi:Gofer:transport=pipeone;policy=rush;perl=/home/oracle/perl5/perlbrew/perls/perl-5.16.0/bin/perl  -Mblib=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/blib;timeout=240;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 132
ok 133
ok 134
ok 135 - The object isa DBI::st
ok 136
ok 137
ok 138
ok 139
ok 140
ok 141
ok 142 - go_response executed flag should be true
ok 143
ok 144
ok 145
ok 146
# Testing go_request_count and caching of simple values
ok 147
ok 148
ok 149
# use_remote=0 (policy=rush, transport=pipeone) HASH(0x8aa2b90)
ok 150
ok 151
ok 152
ok 153 # skip caching of metadata methods returning sth not yet implemented
ok 154 # skip caching of metadata methods returning sth not yet implemented
ok 155
ok 156
# =============
# Testing stream transport with pedantic policy
#  dbi:Gofer:transport=stream;policy=pedantic;perl=/home/oracle/perl5/perlbrew/perls/perl-5.16.0/bin/perl  -Mblib=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/blib;timeout=240;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 157 - should connect to dbi:Gofer:transport=stream;policy=pedantic;perl=/home/oracle/perl5/perlbrew/perls/perl-5.16.0/bin/perl  -Mblib=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/blib;timeout=240;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 158
ok 159
ok 160
ok 161 - should detect prepare failure
ok 162
ok 163
ok 164
ok 165
ok 166
ok 167
ok 168 - go_response executed flag should be true
ok 169
ok 170
ok 171
ok 172
# Testing go_request_count and caching of simple values
ok 173
ok 174
ok 175
# use_remote=1 (policy=pedantic, transport=stream) HASH(0x8abb8a8)
ok 176
ok 177
ok 178
ok 179 # skip caching of metadata methods returning sth not yet implemented
ok 180 # skip caching of metadata methods returning sth not yet implemented
ok 181
ok 182
# =============
# Testing stream transport with classic policy
#  dbi:Gofer:transport=stream;policy=classic;perl=/home/oracle/perl5/perlbrew/perls/perl-5.16.0/bin/perl  -Mblib=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/blib;timeout=240;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 183 - should connect to dbi:Gofer:transport=stream;policy=classic;perl=/home/oracle/perl5/perlbrew/perls/perl-5.16.0/bin/perl  -Mblib=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/blib;timeout=240;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 184
ok 185
ok 186
ok 187 - The object isa DBI::st
ok 188
ok 189
ok 190
ok 191
ok 192
ok 193
ok 194 - go_response executed flag should be true
ok 195
ok 196
ok 197
ok 198
# Testing go_request_count and caching of simple values
ok 199
ok 200
ok 201
# use_remote=0 (policy=classic, transport=stream) HASH(0x8abbec8)
ok 202
ok 203
ok 204
ok 205 # skip caching of metadata methods returning sth not yet implemented
ok 206 # skip caching of metadata methods returning sth not yet implemented
ok 207
ok 208
# =============
# Testing stream transport with rush policy
#  dbi:Gofer:transport=stream;policy=rush;perl=/home/oracle/perl5/perlbrew/perls/perl-5.16.0/bin/perl  -Mblib=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/blib;timeout=240;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 209 - should connect to dbi:Gofer:transport=stream;policy=rush;perl=/home/oracle/perl5/perlbrew/perls/perl-5.16.0/bin/perl  -Mblib=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/blib;timeout=240;dsn=DBI:DBM:f_dir=/home/oracle/.cpanm/work/1339090926.19497/DBI-1.622/test_output_23432;dbm_type=SDBM_File;f_lockfile=0
ok 210
ok 211
ok 212
ok 213 - The object isa DBI::st
ok 214
ok 215
ok 216
ok 217
ok 218
ok 219
ok 220 - go_response executed flag should be true
ok 221
ok 222
ok 223
ok 224
# Testing go_request_count and caching of simple values
ok 225
ok 226
ok 227
# use_remote=0 (policy=rush, transport=stream) HASH(0x8aa7a40)
ok 228
ok 229
ok 230
ok 231 # skip caching of metadata methods returning sth not yet implemented
ok 232 # skip caching of metadata methods returning sth not yet implemented
ok 233
ok 234
1..234
ok

Test Summary Report
-------------------
t/85gofer.t                   (Wstat: 256 Tests: 215 Failed: 1)
  Failed test:  137
  Non-zero exit status: 1
t/zvg_85gofer.t               (Wstat: 256 Tests: 214 Failed: 1)
  Failed test:  84
  Non-zero exit status: 1
t/zvn_85gofer.t               (Wstat: 512 Tests: 200 Failed: 2)
  Failed tests:  85, 122
  Non-zero exit status: 2
t/zvp_85gofer.t               (Wstat: 256 Tests: 217 Failed: 1)
  Failed test:  87
  Non-zero exit status: 1
t/zvxgnp_85gofer.t            (Wstat: 256 Tests: 219 Failed: 1)
  Failed test:  115
  Non-zero exit status: 1
Files=182, Tests=8208, 127 wallclock secs ( 3.86 usr  3.02 sys + 79.30 cusr 37.83 csys = 124.01 CPU)
Result: FAIL
Failed 5/182 test programs. 6/8208 subtests failed. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T19:32:02.133

好吧，所有失败的测试都与 DBD::Gopher 有关。（反过来，这可能与`getnameinfo`您安装 Perl 失败有关，但这纯粹是一个假设。）如果您不打算使用 DBI，您可以强制安装它。

```
cpan -f -i DBI 
```

请注意，我通常强烈反对强制安装模块（因为它不会神奇地使模块工作，并且因为它是在不了解后果的情况下完成的）。

# ruby - 如何在 rspec 中正确模拟 openssl 对象？

> ID：10936349
> 
> 赞同：2
> 
> 时间：2012-06-07T16:55:38.260
> 
> 标签：ruby, rspec, mocking, tdd, openssl

我有一个方法：

```
require 'openssl'

def extract_creds(data)
  pfx = OpenSSL::PKCS12.new(data)

  { :certificate => pfx.certificate.to_pem, :key => pfx.key.to_pem }
rescue
  # handle error
end 
```

我想为它写一个 rspec 示例。我应该如何正确模拟 pfx 对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:20:13.690

### 为什么这可能是错误的问题

当您想要执行以下操作时，通常应该使用模拟：

1.  避免在被测单元之外测试系统行为。
2.  避免昂贵的操作，例如系统间测试。
3.  确保调用了一个对象，但您不关心结果。

在这种情况下，不清楚您*为什么*要测试这种行为，或者您期望的结果是什么，或者为什么您认为您可能不会得到它。在大多数情况下，测试一个经过良好测试的外部库并不是正确的做法。

### 我认为正确的问题是

因此，根据您真正想要测试的内容，您可能需要检查：

1.  该方法是否引发任何异常。
2.  您的方法是否实际上是从应该调用它的某个对象调用的。

但是，在这两种情况下，模拟库与包含真实证书作为固定数据相比似乎没有真正的好处。对于实际执行代码来说，fixtures 比 mocks 更好。

# javascript - 调整背景图像的大小

> ID：10936350
> 
> 赞同：2
> 
> 时间：2012-06-07T16:55:50.147
> 
> 标签：javascript, html, css, image-resizing

这实际上是为了了解更多关于 JavaScript 和 CSS 的信息和学习目的。我有一个本地浏览器索引页面，我想在加载时旋转背景图像。在环顾四周并尝试了不同的解决方案之后，我选择了基本的旋转功能：

```
<html>
<head>
<script language="javascript" type="text/javascript">
function rotate()
{
   var imgArray = new Array("img1.jpg", "img2.jpg", "img3.jpg");
   var aImg = Math.floor(Math.random()*imgArray.length);
   var img = imgArray[aImg];
   document.body.style.background = "url(" + img + ") no-repeat";
   document.body.style.backgroundSize = "cover";
}
</script>
</head>
<body onload="rotate()">
</body>
</html> 
```

在此过程中，在我只是将其设置`backgroundSize`为封面以填充窗口之前，我正在考虑在从数组中选择它们之后将它们设置为背景图像之前调整图像大小的想法。

我做了很多搜索，我发现唯一真正可行的解决方案是通过 ID 选择元素，但这也要求图像具有关联的 ID，例如在 HTML 代码中的 IMG 属性中。此处使用 CSS 在 JavaScript 中选择并设置图像。

我尝试使用`img.width`/`img.height`和`img.style.width`/设置图像尺寸`img.style.height`，以及我遇到的其他一些随机解决方案，但是每当我尝试更改这些图像时，图像要么不会改变，要么根本不显示。

```
function rotate()
{
   var imgArray = new Array("img1.jpg", "img2.jpg", "img3.jpg");
   var aImg = Math.floor(Math.random()*imgArray.length);
   var img = imgArray[aImg];
   image = rsize(img);
   document.body.style.background = "url(" + image + ") no-repeat";
   document.body.style.backgroundSize = "cover";
}
function rsize(image)
{
   image.style.width = "300px";
   image.style.height = "300px";
   return image;
} 
```

我知道我可能在这里做错了什么。在这种情况下，我可以调整这些图像的大小吗？还是有更好的方法来构建它？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T17:02:40.473

您必须在实际的图像 DOM 对象上设置`image.style.width`和`image.style.height`，而不是像当前尝试那样在 URL 上设置。

由于图像对象不用于背景图像，因此您不能真正直接为背景图像执行您想要执行的操作。

您可以使用 CSS`background-size`属性，但这是相当新的，并且在 IE9 之前的 IE 版本中不受支持。如果您使用它，您将为其设置实际大小，而不是`"cover"`.

您也可以使用一个实际的 DOM 图像，然后将该 DOM 图像显示在您的页面中，如果这是您真正想要做的。

例如，以下是创建 DOM 图像对象、为其分配 URL、设置其大小并将其插入页面的方法：

```
var imgArray = new Array("img1.jpg", "img2.jpg", "img3.jpg");
var aImg = Math.floor(Math.random()*imgArray.length);
var imgURL = imgArray[aImg];
var img = new Image();
img.src = imgURL; 
img.style.width = "300px";
img.style.height = "300px";
img.id = "centeredImage";
document.body.appendChild(img); 
```

然后，您可以根据需要使用 CSS 将其定位在页面的中心。

在这里工作演示：http: [//jsfiddle.net/jfriend00/jqMtV/](http://jsfiddle.net/jfriend00/jqMtV/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:04:59.893

不，您没有`<img>`可以（重新）调整大小的元素（顺便说一句，它们不需要 id 即可选择）。您使用`rsize(imgArray[aImg])`对数组成员进行操作，这些成员是*字符串*而不是 DOM 元素，因此在其不存在的`style`属性上设置值会引发错误。

然而，您已经在使用[`backgroundSize`style 属性](http://www.css3.info/preview/background-size/)的正确方式上。只是不要将其设置为`cover`，而是设置为您需要的大小！

```
document.body.style.backgroundSize = "300px 300px"; 
```

如果您想使用一个`<img>`元素，请将其添加到您的末尾`<body>`：

```
<img src="some.jpg" style="position:fixed; z-index:-1; width:100%; height:100%" /> 
```

# java - 从 gwt.xml 中删除 GWT 继承的模块后，GWT 仍然尝试加载它

> ID：10936351
> 
> 赞同：2
> 
> 时间：2012-06-07T16:55:53.890
> 
> 标签：java, gwt

我已删除：

```
inherits name='com.google.gwt.widgetideas.WidgetIdeas'
inherits name='com.google.gwt.libideas.LibIdeas' 
```

以及我的项目和 gwt.xml 中的相应 jars（GWT Incubator），但我在编译时仍然面临这个问题：

```
Loading inherited module 'com.google.gwt.widgetideas.WidgetIdeas'
[ERROR] Unable to find 'com/google/gwt/widgetideas/WidgetIdeas.gwt.xml' on your classpath; could be a typo, or maybe you forgot to include a classpath entry for source? 
```

有什么线索吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T07:57:20.900

您需要执行以下操作：

1.  在eclipse中清理他的项目
2.  重建项目

如果上述方法没有帮助：检查您的主项目所依赖的任何其他项目是否仍然在他们的`gwt.xml`文件中继承您的库。

# java - 使用 IntelliJ IDEA 实施 ProGuard 和测试结果问题

> ID：10936352
> 
> 赞同：0
> 
> 时间：2012-06-07T16:55:57.473
> 
> 标签：java, android, intellij-idea, proguard

我正在使用 IntelliJ IDEA 为 Android 开发。

现在我要介绍 ProGuard。IntelliJ 允许我使用 ProGuard 导出签名或未签名的包 - 所以这很酷。我的问题是工作流程非常痛苦。我需要：

1.  导出包。
2.  通过电子邮件将包发送到设备。
3.  安装在设备上。
4.  注意错误（并且有很多问题）

我想以某种方式实现一键部署到混淆包的开发设备。我该怎么做呢？

通常，我只需在 IDE 中单击“运行”或“调试”——但它不使用 ProGuard。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:14:49.980

您可以使用命令行脚本将其自动化，并将其作为 IntelliJ IDEA 的外部工具运行。

查看[此问题的答案以获取详细信息](https://stackoverflow.com/q/5896741/104891)。

# android - 与 GPL Android 服务通信的 Android 私有应用程序

> ID：10936355
> 
> 赞同：0
> 
> 时间：2012-06-07T16:56:03.183
> 
> 标签：android, service, gpl

我在互联网上发现了一个有趣的 Android 服务，它是 GPL 许可的。我想知道：如果我创建一个与该服务通信的 Android 应用程序，是否可以将其保密，或者是否必须将其设为 GPL？当然，我想将 GPL 服务与我的应用程序一起分发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:02:14.623

如果通过通信您的意思是发送 HTTP 请求，那么是的，您不需要开源您的代码。GPL 限制仅在您链接代码时生效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:12:45.693

我也不是律师，但我很确定你可以。我这样说：只要您可以在不引用 GPL 代码的情况下编译和链接您的程序，那么您就安全了。

在您的情况下（Android 服务），安全的方法是将服务放入一个单独的 APK 中，您将在市场上单独提供该 APK，并通过意图与您的程序进行通信。

这类似于以下情况： GPL Un*x 机器上的程序调用`grep`（或任何其他可用工具）。我认为很明显您的程序不需要 GPL，否则此类操作系统将没有（或很少）非 GPL 程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:01:30.330

简单的回答：是的，聚合是可以的（不需要 GPL）。如需复杂答案，请咨询律师或阅读 FSF 常见问题解答

# c - 调试断言失败 fprintf

> ID：10936358
> 
> 赞同：0
> 
> 时间：2012-06-07T16:56:12.580
> 
> 标签：c, printf

首先，我将首先说我已阅读以下链接：

[fprintf 调试断言失败](https://stackoverflow.com/questions/10051961/fprintf-debug-assertion-fail)

我收到了与他/她相同的错误，但是我的错误不是由于相同的原因。这是C语言的代码：

```
FILE * fp;
fp = fopen("C:\ro_apps\IandQ.csv", "w");
fprintf(fp, "%f\n", (j+pTxWbHf110c->cAnalogOutputBuffer)->re); 
```

我得到的错误指出：

调试断言失败！

程序：（无关）文件：f:\dd\vctgools\crt_bld\self_x86\crt\src\fprintf.c 行：55

表达式：（str！= NULL）

我在另一个链接中看到有人说在使用 fprintf 命令之前使用 debug 来查看文件是否已打开。我的打不开 任何提示或技巧？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:00:56.800

你的文件名是错误的。你必须逃避每一个反斜杠`\`：

```
fp = fopen("C:\\ro_apps\\IandQ.csv", "w"); 
```

此外，您应该始终检查是否`fopen`失败：

```
if(fp == NULL){
   perror("Couldn't open file: C:\\ro_apps\\IandQ.csv\n");
   return;
} 
```

# php - 一个页面上有多个表单

> ID：10936359
> 
> 赞同：1
> 
> 时间：2012-06-07T16:56:14.233
> 
> 标签：php, html, forms, upload

我的个人资料编辑页面上的图片上传表单不起作用。这两种形式必须分开，因为它们独立工作。图片上传脚本会在提交个人资料编辑表单之前上传图片。

我在一个单独的页面上测试了图片上传，它是页面上唯一的东西并且它有效。所以我假设是另一种形式把它搞砸了。这两种形式作用于不同的脚本，两种方法都是帖子。

这是脚本

```
<script type="text/javascript" src="imageupload/scripts/jquery.min.js"></script>
<script type="text/javascript" src="imageupload/scripts/jquery.form.js"></script>
<script type="text/javascript" >
  $(document).ready(function() { 
    $('#photoimg').live('change', function() { 
        $("#preview").html('');
        $("#preview").html('<img src="imageupload/loader.gif" alt="Uploading...."//>');
        $("#cropimage").ajaxForm({ target: '#preview' }).submit();
    });
  }); 
</script> 
```

这是表格；

```
<form id="cropimage" method="post" enctype="multipart/form-data" action="../imageupload/ajaximage.php">
  <input type="file" name="photoimg" id="photoimg" class="filebutton"/><br>
</form> 
```

这是另一种形式。它很长；

```
 echo '<form action="phpscripts/artistupdate.php" method="post" id="profileedit"><input type="text" name="artistname" value="'. $row['artistname'].'" class="name"     maxlength="80"><span id="editlink"><t1>Your profile link will be: <br><a     href="http://newbornsounds.co.uk/artists/artist.php?artist='.$row['artistname'].'">    <b>http://newbornsounds.co.uk/artists/artist.php?artist=<FONT style="BACKGROUND-COLOR: yellow">'.$row['artistname'].'</font></b></a></span><br><div id="urlwarn"><t1>Please note that if you change your url all the links you have placed outside of NBS will be affected.</t1></div>';
  }
}
?>
<hr>
<?php 
  $username = $_SESSION['username'];
  $pass = $_SESSION['password']; 
  include ("../database.php");
  $result = mysql_query("SELECT * FROM members WHERE username='$username' AND     password='$pass' AND artist='Y'");

  while($row = mysql_fetch_array($result)){
    echo '<div id="artistsbio"><textarea name="bio" rows="10" cols="80" name="bio" value="'.     $row['bio']. '" class="bio">'. $row['bio']. '</textarea><br><div id="probwarn"><t1>Everything is still in the beta stage so there are bound to be a few problems. If you spot one please <a     href="mailto:artists@newbornsounds.co.uk"><b>tell us about it.</b></a></t1></div>';
  }
?>
<br><br>
<input type="submit" name="submit" value="Done" class="button"></form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-11T10:19:55.070

您的cropimage 表单中没有提交按钮，可能是pb。如果我理解得很好，您希望在 photoimg 字段发生更改时提交它，而不是提交按钮。

尝试[通过在不带提交按钮的情况下按 Enter 提交表单](https://stackoverflow.com/questions/477691/html-submitting-a-form-by-pressing-enter-without-a-submit-button) （如果您不想显示提交按钮，请在屏幕外显示提交按钮）。

顺便说一句，jquery live 已被弃用。 [http://api.jquery.com/live/](http://api.jquery.com/live/)

# c# - 某些 Windows 窗体控件无法识别？

> ID：10936360
> 
> 赞同：0
> 
> 时间：2012-06-07T16:56:14.947
> 
> 标签：c#, winforms

我有几个普通的 Windows 窗体。要清除其中一个中的数据输入字段，我使用如下代码：

```
 ClearInputFields(this);

    private void ClearInputFields(Control Page)
    {
        try
        {
            foreach (Control ctrl in Page.Controls)
            {
                if (ctrl is Button)                    
                    continue;
                if (ctrl is DataGridView)
                    continue;
                if (ctrl is ListBox)
                    continue;

                if (ctrl is TextBox)
                {
                    ((TextBox)(ctrl)).Text = string.Empty;
                }
                else if (ctrl is ComboBox)
                {        
                    ((ComboBox)(ctrl)).SelectedIndex = 0;
                }
                else if (ctrl is CheckBox)
                {
                    ((CheckBox)(ctrl)).Checked = false;
                }
                else if (ctrl.Controls.Count > 0)
                {
                    ClearInputFields(ctrl);
                }                                       
            }
        }
        catch (Exception ex)
        {
            TraceFile.Error("ExceptionLog", ex);
        }
    } 
```

在其中一种形式上，它按预期工作。在另一种形式中，九个 ComboBox 中的两个没有被重置，并且六个 CheckBox 中的任何一个都不会被清除。

在调试器中单步执行，似乎特定控件甚至不在表单中包含的控件列表中。？！

我比较了表单，发现这些控件的属性没有什么不同。无法识别的组合框之一是数据绑定的，一个不是，但对于那些被重置的组合框也是如此。

我看过设计器，所有控件都声明为“this.Controls.Add(this.name_of_control);”

我尝试省略最后一个“else if”（无论如何，此表单上没有面板、组框或其他容器）。行为上没有区别。

如果我将复选框显式设置为“Checked = false”，并将 ComboBoxes 设置为“SelectedIndex = 0”，它们会按照我的预期执行，但在遍历表单控件时不会。

编辑 - 附录：所有控件都是在设计器中创建的，而不是在运行时。如前所述，表单上没有容器。

我希望这是您眼皮底下那些简单、明显、直接的问题之一，但到目前为止我还没有看到它。

任何见解表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T05:58:13.407

每当我必须对 Collection 的项目做一些可能会改变它的事情时，我通常会复制该集合，然后循环遍历该副本。在您的情况下，这是我通常编写的代码：

```
ClearInputFields(this);

private List<Control> ControlsForPage(Control Page)
{
        List<Control> result = new List<Control>();
        foreach (Control ctrl in Page.Controls)
              result.Add(ctrl);
        return result;
{

private void ClearInputFields(Control Page)
{
    try
    {
        List<Control> ctrlsCopy = ControlsForPage(Page);
        foreach (Control ctrl in ctrlsCopy)
        {
            if (ctrl is Button)                    
                continue;
            if (ctrl is DataGridView)
                continue;
            if (ctrl is ListBox)
                continue;

            if (ctrl is TextBox)
            {
                ((TextBox)(ctrl)).Text = string.Empty;
            }
            else if (ctrl is ComboBox)
            {        
                ((ComboBox)(ctrl)).SelectedIndex = 0;
            }
            else if (ctrl is CheckBox)
            {
                ((CheckBox)(ctrl)).Checked = false;
            }
            else if (ctrl.Controls.Count > 0)
            {
                ClearInputFields(ctrl);
            }                                       
        }
    }
    catch (Exception ex)
    {
        TraceFile.Error("ExceptionLog", ex);
    }
} 
```

无论如何，为了了解这里发生了什么，我会尝试在重置之前制作 Controls 的副本，然后在重置后将其与页面的 Controls 集合进行比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:29:54.923

也许在更改控件的属性时 - 控件的顺序发生了`this.Controls`变化，因此您不会遍历所有控件。虽然可能不是这种情况，因为可能`Control ctrl in Page.Controls`只是第一次检查。

# c# - 在 C# 中查找和写入大于 2GB 的文件

> ID：10936367
> 
> 赞同：3
> 
> 时间：2012-06-07T16:56:25.090
> 
> 标签：c#, filestream

在 C# 中，`FileStream`的方法 Read/Write/Seek 接受`integer`参数。在[上一篇文章](https://stackoverflow.com/questions/5654298/filestream-read-write-methods-limitation)中，我看到了一个很好的解决方案来读取/写入大于分配给进程的虚拟内存的文件。

如果您想从头到尾写入数据，则此解决方案有效。但就我而言，我收到的数据块没有特定的顺序。

我有一个适用于小于 2GB 的文件的代码：

```
private void WriteChunk(byte[] data, int position, int chunkSize, int count, string path)
    {

        FileStream destination = new FileStream(path, FileMode.OpenOrCreate, FileAccess.Write);
        BinaryWriter writer = new BinaryWriter(destination);
        writer.Seek((int) (position*chunkSize), SeekOrigin.Begin);
        writer.Write(data, 0, count);
        writer.Close();
    } 
```

有没有办法可以在大于 2GB 的文件中查找和写入我的块？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T16:58:09.420

不要使用int，使用long。寻找需要很长时间。

不过，您需要在任何地方使用 long ，而不仅仅是在某个地方强制转换为 int 。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T16:58:34.107

```
writer.Seek((long)position*chunkSize, SeekOrigin.Begin); 
```

# ruby-on-rails - 如何避免使用 DHH 的关于在多个文件中分配路由的猴子补丁来缓存路由

> ID：10936373
> 
> 赞同：2
> 
> 时间：2012-06-07T16:57:01.450
> 
> 标签：ruby-on-rails, routes

我正在使用 Rails 3.1 和 DHH 的猴子补丁，用于在多个文件中分配路由：

[https://gist.github.com/2492118](https://gist.github.com/2492118)

因此，当我更改路由目录的其中一个路由中的路由时，我必须停用像 config/routes/users.rb 这样的路由子文件：

```
MyApplication::Application.routes.draw do
  #draw :users
end 
```

请求页面并激活路由子文件。

```
MyApplication::Application.routes.draw do
  draw :users
end 
```

在我请求一个页面后，我终于可以看到新的用户路由更改。

有谁知道如何避免这种解决方法并立即看到路由子文件的变化？

# deployment - 适用于不同平台、中间件、技术的持续部署工具，具有指标和报告

> ID：10936380
> 
> 赞同：3
> 
> 时间：2012-06-07T16:57:36.737
> 
> 标签：deployment, release-management, web-deployment, continuous-deployment, continuous-delivery

有哪些可与 UrbanCode uDeploy、Noliosoft ZeroTouch 和 XebiaLabs Deployit 相媲美的持续部署工具？我尝试将应用程序部署到的环境是多操作系统（Linux、Windows Server）、各种类型的中间件（Websphere、Weblogic、Jboss、Tomcat、Apache、IIS、BizTalk）、不同的数据库（Oracle、MySQL、MSSQL），并包括不同类型的应用程序打包（.war、.jar、.conf、.xml、.zip、.exe、.msi）。我也从文件系统而不是 Maven 存储库中提取（但将来需要与 Maven 集成）。我已经构建了一个 Maven-cargo 部署流程，但部署工程师想要一个基于 GUI 的工具，可以收集指标。我尝试了 Webistrano 部署，但无法让 .NET、IIS 和 .msi 部署正常工作（我知道 - 它不适用于这些平台）。我有 Red Hat JON，但它不允许部署到 Windows。SCCM？谷氨酸？八达通部署？夸提？

# css - CSS3 渐变在浏览器中看起来不同

> ID：10936383
> 
> 赞同：2
> 
> 时间：2012-06-07T16:57:58.457
> 
> 标签：css, gradient

CSS3 渐变在不同的浏览器中以不同的饱和度显示。如何解决这个问题？找不到任何有用的东西。 [http://d.pr/i/chm1](http://d.pr/i/chm1)

这是代码：

**html**

```
<div class="button-body">
    <a href="/" class="text">Купить</a>     
</div> 
```

**css**

```
.text{
font-family: Calibri;
font-size: 20px;
text-decoration: none;
font-weight: bold;
color: #913944;

margin-top: 7px;
margin-left: 70px;
float: left;
text-align: center;

text-shadow: rgba(255,255,255,0.6) 0px 1px 0.5px;

border-radius: 8px;
} 

.button-body{
height:40px;
width:200px;
display:inline-block;

background: -moz-linear-gradient(top, #ff4d55, #cc1d31);
background: -webkit-gradient(linear, left top, left bottom, 
                color-stop(0%,#ff4d55), color-stop(100%,#cc1d31));
background: -o-linear-gradient(top, #ff4d55, #cc1d31);

border-radius: 10px;
border: 2px solid #993f49;

box-shadow: inset 0 1px 1px rgba(255,255,255,1); 

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T02:38:16.207

问题是浏览器的渲染方式不同。使用图像是使其相似的最佳方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T14:15:21.620

在浏览器中实现相同的呈现有时是一个巨大的挑战。从业务的角度来看，您应该问自己要求是元素在所有浏览器中**看起来都相同**，还是在所有浏览器中**看起来都很好**。

# python - python PIL中16位无符号原始二进制图像文件的模式是什么

> ID：10936386
> 
> 赞同：2
> 
> 时间：2012-06-07T16:58:05.933
> 
> 标签：python, image, python-imaging-library, binary-data, grayscale

您好，我正在使用 Python Imaging Library 对图像进行小幅转换。该图像是具有 16 位无符号整数的原始二进制文件。由于某种原因，我无法让 python 工作，它不断给我以下错误：

```
 Traceback (most recent call last):
  File "C:\Users\Patrick\workspace\colorCorrect\src\editGrayscale.py", line 24, in <module>
    changed.save(saveFile)
  File "C:\Python27\lib\site-packages\PIL\Image.py", line 1423, in save
    raise KeyError(ext) # unknown extension
KeyError: '.bin' 
```

我的代码如下：

```
import Image
#file to save:  C:\Users\name\imagedata\visiblespec.bin

fileName = raw_input("Enter a file name: ")
saveFile = raw_input("Enter a new save file name: ")

with open(fileName, 'rb') as f:
im = Image.fromstring('L', (3032, 2016), f.read()) # also try 'L;16B', 'I;16', and 'I;16B'
changed = im.point(lambda i: i/2) 
```

更改。保存（保存文件）

同样，我的图像是 11 mbs 左右的灰度 16 位无符号整数，并以十六进制编写。

谢谢！

更新：

用于保存文件的代码：

```
def save(filename, contents):  
   fh = open(filename, 'w')  
   fh.write(contents)  
   fh.close() 

save(saveFile, final) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:07:03.653

PIL 的所有有效模式都列在文件[`unpack.c`](http://svn.effbot.org/public/tags/pil-1.1.4/libImaging/Unpack.c)底部附近的源文件中。我将从包含`16`.

鉴于您的编辑，还有其他问题。首先是 PIL.Image 需要确定用于写出文件的编码器，并且它使用文件扩展名来执行此操作。您的`.bin`文件扩展名是非标准的，因此无法知道要使用哪种格式。尝试类似的东西`.png`。

第二个问题是并非每种文件类型都支持每种图像格式。您可能需要在保存之前转换图像。

```
changed.convert('L').save(saveFile) 
```

鉴于您的最后一条评论，您只想将值写回原始格式文件。您可以尝试该`'raw'`格式或仅用于`tostring`自己写入文件。

```
changed.save(saveFile, 'raw') 
```

# database-design - 当 1NF 表没有复合候选键时，它是否在 2NF 中？

> ID：10936387
> 
> 赞同：3
> 
> 时间：2012-06-07T16:58:07.183
> 
> 标签：database-design, data-modeling, database-normalization

可以肯定地说，当 1NF 表没有复合候选键（主键由多于一列组成）时，该表自动处于 2NF 中吗？

当一个表的主键中只有一列时，它可以违反 2NF 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T21:24:42.063

只要不存在非平凡的 FD，A->B，R 满足其中 B 是非素数且 A 是 R 的某个候选键的适当子集，则关系 R 就处于 2NF 中。

您首先必须考虑所有候选键。如果所有候选键恰好是单个属性键，那么这些键中唯一可能的正确子集是 {}（[空集](http://www.dcs.warwick.ac.uk/~hugh/M359/FD-demystification.html#emptyset)）。对空集的依赖不太可能无意中出现，因为它们通常是显而易见且不必要的。然而，即使只有一个简单的密钥，这种依赖关系也是完全可能的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-07T18:01:04.843

是的，当主键中只有一列时，该表可能违反 2NF。2NF 的基本思想是让表的所有字段都直接依赖/关联到主键。@AB 给出的例子解释了同样的观点。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-06-07T17:04:18.817

在 2NF 中拥有单个表的关键是“删除适用于表的多行的数据子集并将它们放在单独的表中”。

如果一个表有多个重复信息的行，那么应该将该信息移动到另一个表并通过使用外键建立关系。

[http://databases.about.com/od/specificproducts/a/2nf.htm](http://databases.about.com/od/specificproducts/a/2nf.htm)

# php - PHP regex：检查每个文本行是否以 Foo 开头

> ID：10936392
> 
> 赞同：0
> 
> 时间：2012-06-07T16:58:17.337
> 
> 标签：php, regex, preg-replace, preg-match

如果每个文本行都以 Foo 开头，我如何检查 PHP？

我想在行的开头删除“Foo”，但前提是每行都以 Foo 开头。

```
$string = 'Foo A
Foo B
Foo C';

should return:
A
B
C 
```

和

```
$string = 'Foo A
B
Foo C';

should return:
Foo A
B
Foo C 
```

这怎么可能匹配？

```
if ( preg_match("/^Foo/m", $string ) ) {
  $string = preg_replace('/^Foo /m', '', $string);
} 
```

这仅匹配单行，但如前所述，它仅适用于所有行以“Foo”开头的情况。

测试：[http ://codepad.viper-7.com/roZNEo](http://codepad.viper-7.com/roZNEo)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:10:16.160

使用`&$count`参数 for`preg_replace`确定发生了多少替换。如果这等于文本中的行数，那么每一行都以`Foo`.

```
function replace($text) {

    if ( preg_match("/^Foo/m", $text ) ) {
        $return = preg_replace('/^Foo /m', '', $text, -1, $num_matches); 
        if( $num_matches == count( explode( "\n", $text))) {
            $text = $return;
        }
    }

    return $text;
} 
```

您也可以省略对 的调用`preg_match`，因为它是多余且不必要的。

[演示](http://codepad.viper-7.com/lIKe2B)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:11:19.867

```
<?php

$string = 'Foo A
Foo B
Foo C';

$a = explode("\n", $string);

foreach ($a as $line) {
  print preg_replace('/^Foo /', '', $line) . "\n";
}

?> 
```

在此处查看实际操作：http: [//codepad.org/ch6x0hSR](http://codepad.org/ch6x0hSR)

请注意，这对于此示例数据来说太过分了；[`str_replace()`](http://php.net/str_replace)如果你真的不需要正则表达式，你应该使用。

哎呀，如果每一行总是格式化`{uselessword}{delimiter}{importantword}`，那么你也可以使用[`explode()`](http://php.net/explode).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T17:13:36.223

我稍微修改了正则表达式以断言每一行都以`"Foo"`.

```
if ( preg_match("/^((?:^|\n)Foo.*)+$/", $text ) ) {
    $text = preg_replace('/^Foo /m', '', $text);
} 
```

[http://codepad.viper-7.com/ail50t](http://codepad.viper-7.com/ail50t)

# java - 登录我的 Java Web 应用程序时，我被定向到登录表单使用的 CSS，如何解决这个问题？

> ID：10936396
> 
> 赞同：1
> 
> 时间：2012-06-07T16:58:29.423
> 
> 标签：java, security, web, web.xml, security-constraint

我有一个 Java Web 应用程序，它由各种 servlet 和 JSP 组成——例如：控制器 servlet `/controller?abc=123&xyz=567`、其他一些 servlet `/showDocument?docid=55`，以及一些对 JSP 的直接访问`/userDetails.jsp`。

我启用了网络安全以阻止对所有人的访问（如下所示），并且我有一个`login.jsp`链接到 css 文件的页面`/styles.css`。

当我访问任何 URL 时，我被重定向到 login.jsp 页面。

问题是：

(1) 登录页面上没有使用 CSS 样式，可能是因为它`styles.css`被认为是受保护的资源，而我还没有登录。

(2) 使用用户名和密码成功登录后，我被定向到 style.css 文件（在浏览器中显示为纯文本）。我猜这是因为指向 css 文件的 LINK 被认为是最近请求的受保护资源，所以它假设这就是我想要去的地方。

如果我将 CSS 内容复制并粘贴到我的 JSP 中，这两个问题都会消失，但是我在两个地方都有 CSS，style.css 和 login.jsp。

我该如何解决？有没有办法让我将 *.css 文件列入“白名单”，以免它们受到保护。我是否必须为要保护的特定类型定义不同的安全约束？

这是我的 web.xml 中的当前安全约束：

```
<security-constraint>
  <display-name>name</display-name>
  <web-resource-collection>  
    <web-resource-name>Restricted</web-resource-name>
    <url-pattern>/*</url-pattern>
    <http-method>GET</http-method>
    <http-method>POST</http-method>
  </web-resource-collection>
  <auth-constraint>
    <role-name>APP_USER</role-name>
  </auth-constraint>
  <user-data-constraint>
    <transport-guarantee>NONE</transport-guarantee>
  </user-data-constraint>
</security-constraint> 
```

这就是我在我的 JSP 中链接到 CSS 的方式：

```
<head>
  <LINK REL=StyleSheet HREF="styles.css" TYPE="text/css" MEDIA="screen" />
</head> 
```

任何帮助是极大的赞赏！

抢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:03:52.087

保护好所有内容后，您可以禁用 css 和图像的安全性

```
<security-constraint>
  <display-name>name</display-name>
  <web-resource-collection>  
    <web-resource-name>Restricted</web-resource-name>
    <url-pattern>/*</url-pattern>
    <http-method>GET</http-method>
    <http-method>POST</http-method>
  </web-resource-collection>
  <auth-constraint>
    <role-name>APP_USER</role-name>
  </auth-constraint>
  <user-data-constraint>
    <transport-guarantee>NONE</transport-guarantee>
  </user-data-constraint>
</security-constraint>
<security-constraint><!--Exclude css and images here -->
   <web-resource-collection>
      <web-resource-name>Exclude from Security</web-resource-name>
      <url-pattern>/images/*</url-pattern><!-- No security for images -->
      <url-pattern>/css/*</url-pattern><!-- No security for css -->
   </web-resource-collection>
</security-constraint> 
```

# android - Android - 获取 url 重定向

> ID：10936398
> 
> 赞同：3
> 
> 时间：2012-06-07T16:58:37.037
> 
> 标签：android, redirect, httpurlconnection, android-mediaplayer

我目前有一个媒体播放器，并试图从我的源路径中获取重定向地址。由于媒体播放器不支持重定向处理，我试图通过创建 httpurlconnection 等来获取重定向的 url 路径。但是，我不确定我是否做得对。任何帮助，将不胜感激。谢谢。

代码：

```
Log.d(TAG, "create url - test");
URL testUrl = new URL(path);
HttpURLConnection conn = (HttpURLConnection)testUrl.openConnection();

String test = conn.getURL().toString();
String test1 = conn.getHeaderField(2);
String test2 = conn.toString();
Log.d(TAG, "normal stuff test is: " + test);
Log.d(TAG, "header field test is: " + test1);
Log.d(TAG, "url to string is: " + test2); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T19:15:11.817

下面的代码遵循一跳 URL 重定向。通过使用[HTTP HEAD](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.4)请求而不是[GET](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.3)，它*消耗的带宽大大减少*。扩展此方法以处理多跳应该相当简单。

```
public URI followRedirects(URI original) throws ClientProtocolException, IOException, URISyntaxException
{
    HttpHead headRequest = new HttpHead(original);

    HttpResponse response = client.execute(headRequest);
    final int statusCode = response.getStatusLine().getStatusCode();
    if (statusCode == HttpStatus.SC_MOVED_PERMANENTLY ||
        statusCode == HttpStatus.SC_MOVED_TEMPORARILY)
    {
        String location = response.getHeaders("Location")[0].toString();
        String redirecturl = location.replace("Location: ", "");
        return new URI(redirecturl);
    }
    return original;
} 
```

它假定您已经设置了存储在字段中的[HttpClient](http://developer.android.com/reference/org/apache/http/client/HttpClient.html)`client`。

另请参阅[此问题](https://stackoverflow.com/questions/9612208/how-to-detect-a-redirected-url)。

# ajax - 使用 AJAX JSON 调用 API 减少重复

> ID：10936399
> 
> 赞同：0
> 
> 时间：2012-06-07T16:58:47.957
> 
> 标签：ajax, json, api, wunderground

我的网站上有大约 15 份以下代码。唯一改变的是 url、经度、纬度和标记变量标题。我怎样才能把它切碎并减少重复？

```
$.ajax({
    url: "http://api.wunderground.com/api/<api_key>/conditions/q/pws:KCASANFR128.json",
    dataType: "jsonp",
    success: function(parsed_json) {
    var location = parsed_json['current_observation']['observation_location']['city'];
    var temp_f = parsed_json['current_observation']['temp_f'];
    var weather = parsed_json['current_observation']['weather'].toLowerCase();
    var iconUrl = parsed_json['current_observation']['icon_url'];
    var iconPic = new MyIcon(iconUrl);
    var markerRichmond = new L.Marker(new L.LatLng(37.779806, -122.471895), {icon: iconPic});
    markerRichmond.bindPopup("Current temperature in " +location+ " is: " +temp_f+ " and it is " + weather);
    map.addLayer(markerRichmond);
}}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:16:12.307

您可以创建一个函数来接收这些变量并将它们提供给 ajax 调用。然后你只需要这个 ajax 块的一个副本，你可以通过调用`getWeather`函数来调用它

```
function getWeather(url, lat, long, title){
    $.ajax({
        url: url,
        dataType: "jsonp",
        success: function(parsed_json) {
            var location = parsed_json['current_observation']['observation_location']['city'];
            var temp_f = parsed_json['current_observation']['temp_f'];
            var weather = parsed_json['current_observation']['weather'].toLowerCase();
            var iconUrl = parsed_json['current_observation']['icon_url'];
            var iconPic = new MyIcon(iconUrl);
            var markerRichmond = new L.Marker(new L.LatLng(lat, long), {icon: iconPic});
            markerRichmond.bindPopup(title);
            map.addLayer(markerRichmond);
        }
    });
} 
```

我不确定我在这里是否正确处理了标题，但你明白了。如果您对标题可能如何更改有所了解，我可以相应地修复代码。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-04T17:16:14.303

```
var current_observation = parsed_json['current_observation']; 
```

这也缩短了解析的次数。**然后**你可以将你的变量称为

```
current_observation['observation_location']['city']; 
```

# javascript - 如何检测和删除 JavaScript 中的无效 unicode 序列

> ID：10936400
> 
> 赞同：3
> 
> 时间：2012-06-07T16:58:53.530
> 
> 标签：javascript, node.js, unicode

给定一个输入字符串，生成一个输出字符串，其中所有无效序列都被删除或替换为 U+FFFD。

有没有比逐个字符地实现状态机或可用的非本机 node.JS 模块更好的方法？

例如，无效序列是孤立的代理`"\uD800"`，或其他无效的多字符序列。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T18:47:52.430

匹配无效序列所需的正则表达式取决于您要包含的内容。要使用 U+FFFD 替换孤立代理，您可以使用如下内容：

```
var surrogates = /[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;
str = str.replace(surrogates , function ($0) {
    return $0.length > 1 ? $0 : '\ufffd';
}); 
```

如果您使用带有[Unicode 插件的](http://xregexp.com/plugins/)[XRegExp](http://xregexp.com/)库，您可以使用或Unicode 类别而不是. 使用 XRegExp 还可以让您轻松访问其他可能相关的 Unicode 属性，例如, or , and or 。`\p{Cs}``\p{Surrogate}``[\ud800-\udfff]``\p{Noncharacter_Code_Point}``\p{Co}``\p{Private_Use}``\p{Cn}``\p{Unassigned}`

由于您使用的是 Node.js，因此您可以通过[npm](https://github.com/slevithan/XRegExp#installation-and-usage)使用`npm install xregexp`. XRegExp 的 npm 模块自动包含 Unicode 插件。

# php - 登录php后重定向到主页

> ID：10936401
> 
> 赞同：0
> 
> 时间：2012-06-07T16:58:54.903
> 
> 标签：php, mysql, redirect, login

我创建了一个登录表单。我怎样才能使当用户登录时，他/她重定向到显示他/她姓名的页面？我已经浏览了很多关于如何做到这一点的教程，但没有什么是非常好的......

main_login.php：

```
<table width="300" border="0" align="center" cellpadding="0" cellspacing="1" bgcolor="#CCCCCC">
<tr>
<form name="form1" method="post" action="checklogin.php">
<td>
<table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#FFFFFF">
<tr>
<td colspan="3"><strong>Member Login </strong></td>
</tr>
<tr>
<td width="78">Username</td>
<td width="6">:</td>
<td width="294"><input name="myusername" type="text" id="myusername"></td>
</tr>
<tr>
<td>Password</td>
<td>:</td>
<td><input name="mypassword" type="text" id="mypassword"></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><input type="submit" name="Submit" value="Login"></td>
</tr>
</table>
</td>
</form>
</tr>
</table> 
```

login_success.php：

```
<?php
session_start();
if(!session_is_registered(myusername)){
header("location:http://main_login.php");
}
?>

<html>
<body>
Login Successful
</body>
</html> 
```

检查登录.php：

```
<?php

$host="host"; // Host name 
$username="username"; // Mysql username 
$password="password"; // Mysql password 
$db_name="database"; // Database name 
$tbl_name="table"; // Table name 

// Connect to server and select databse.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

// username and password sent from form 
$myusername=$_POST['myusername']; 
$mypassword=$_POST['mypassword']; 

// To protect MySQL injection (more detail about MySQL injection)
$myusername = stripslashes($myusername);
$mypassword = stripslashes($mypassword);
$myusername = mysql_real_escape_string($myusername);
$mypassword = mysql_real_escape_string($mypassword);
$sql="SELECT * FROM $tbl_name WHERE username='$myusername' and password='$mypassword'";
$result=mysql_query($sql);

// Mysql_num_row is counting table row
$count=mysql_num_rows($result);

// If result matched $myusername and $mypassword, table row must be 1 row
if($count==1){

// Register $myusername, $mypassword and redirect to file "login_success.php"
session_register("myusername");
session_register("mypassword"); 
header("location:login_success.php");
}
else {
echo "Wrong Username or Password";
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:03:14.560

要发出 HTTP 重定向，`Location`标头应正确大写，并在标头名称及其值之间包含空格：

```
header('Location: login_success.php'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T18:31:49.467

这个例子应该对你有所帮助，但我建议使用 mysqli 并且以纯文本形式存储你的密码是一个非常糟糕的主意。您应该考虑查找 mysqli、散列密码，并开始熟悉 php 5.4，因为这里使用的许多函数已经更改并且不再受支持。

检查登录.php

```
<?php

$host="host"; // Host name 
$username="username"; // Mysql username 
$password="password"; // Mysql password 
$db_name="database"; // Database name 
$tbl_name="table"; // Table name 

// Connect to server and select databse.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

// username and password sent from form 
$myusername=$_POST['myusername']; 
$mypassword=$_POST['mypassword']; 

// Remove Magic Quotes
if (get_magic_quotes_gpc()){
  $myusername = stripslashes($myusername);
  $mypassword = stripslashes($mypassword);
}
$sql = sprintf(
  "SELECT * FROM $tbl_name WHERE username='%s' and password='%s' LIMIT 1;",
  mysql_real_escape_string($myusername),
  mysql_real_escape_string($mypassword)
);
$result = mysql_query($sql);

// MySQL count
$count = mysql_num_rows($result);

if ($count){
  $_SESSION['username'] = $myusername; // $_SESSION['loggedin'] = true or false would work too
  $_SESSION['mypassword'] = $mypassword; // Why store the password in session data?
  header("Location: login_success.php");
}else{
  header("Location: main_login.php?msg=Login_Failed");
}
?> 
```

login_success.php

```
<?php
session_start();
if (!isset($_SESSION['username']) || empty($_SESSION['username']){
  header("Location: mail_login.php");
}

?>
<html>
<body>
Welcome <?php echo $_SESSION['username']; ?>
Login Successful
</body>
</html> 
```

main_login.php

```
<?php
if (isset($_GET['msg']) && !empty($_GET['msg']) echo $_GET['msg'];
?>
<table width="300" border="0" align="center" cellpadding="0" cellspacing="1" bgcolor="#CCCCCC">
<tr>
<form name="form1" method="post" action="checklogin.php">
<td>
<table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#FFFFFF">
<tr>
<td colspan="3"><strong>Member Login </strong></td>
</tr>
<tr>
<td width="78">Username</td>
<td width="6">:</td>
<td width="294"><input name="myusername" type="text" id="myusername"></td>
</tr>
<tr>
<td>Password</td>
<td>:</td>
<td><input name="mypassword" type="text" id="mypassword"></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><input type="submit" name="Submit" value="Login"></td>
</tr>
</table>
</td>
</form>
</tr>
</table> 
```

使用风险自负。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T17:05:00.643

如果登录成功，您似乎已经能够将用户重定向到页面。您只需向该页面添加一些代码，例如 echo $_SESSION['username']; 希望能帮助到你。

# reporting-services - 每月将 SSRS 报告导出到同一个 Excel 工作簿

> ID：10936404
> 
> 赞同：0
> 
> 时间：2012-06-07T16:59:21.530
> 
> 标签：reporting-services, export-to-excel

我是 SSRS 的新手，我正在尝试为我们的客户自动生成报告。我已完成设计，但尚未将其部署到报告服务器。当我通过 Business Intelligence Studio 2008 中的设计查看器手动将报表导出到 excel 时，我每次都会得到一个新的工作簿。但是，我希望此报告在每个月运行时自动导出到 excel，到同一个工作簿，在同一个工作表上。这样，我可以创建一个 Excel 工作簿，其中包含报表数据和其他带有模板的工作表，这些模板会根据报表数据自动填充。

我想避免将其导出到新工作簿，然后使用我的所有模板手动复制并粘贴到工作簿中。我还想避免导出为 CSV 或 XML，然后将其导入 Excel。

这可能吗？也许这是通过报告的部署而我还没有走到那一步？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-08T13:31:44.883

嗨，欢迎堆栈溢出。

我可以建议看看另一种相关技术 SSIS（Sql Server 集成服务）。这将允许您从数据源中提取数据。然后使用开箱即用的组件将数据导出到 Excel。一旦你在 SSIS 中创建了包，就可以安排包在特定时间运行（如果你有 SQL 服务器实例）。我在目前的角色中使用该解决方案自动生成报告，然后通过电子邮件发送给不同的人。

下面的链接显示了一种使用 BIDS 导出到 excel 的方法，并建议了其他一些方法。

[http://cavemansblog.wordpress.com/2009/04/17/ssis-export-data-from-sql-server-2005-to-excel/](http://cavemansblog.wordpress.com/2009/04/17/ssis-export-data-from-sql-server-2005-to-excel/)

此外，此链接[http://dougbert.com/blog/post/Excel-in-Integration-Services-Part-1-of-3-Connections-and-Components.aspx](http://dougbert.com/blog/post/Excel-in-Integration-Services-Part-1-of-3-Connections-and-Components.aspx) 是涵盖将 SSIS 连接到的主题的三个之一Excel，有一些很好的建议恕我直言

SSRS 内置了一个调度器，可以在指定的时间运行报告，我认为只有企业版才有。如果内存服务正确，该工具将不会插入数据，每次只会创建或覆盖文件。所以我不确定这是否是您正在寻找的解决方案。

# java - 两种不同的递归方式

> ID：10936405
> 
> 赞同：0
> 
> 时间：2012-06-07T16:59:30.377
> 
> 标签：java, algorithm, recursion

我以两种不同的方式计算斐波那契行。为什么 fib1 的执行时间比 fib2 长得多？

```
public class RecursionTest {

    @Test
    public void fib1() {
        long t = System.currentTimeMillis();

        long fib = fib1(47);

        System.out.println(fib + "  Completed fib1 in:" + (System.currentTimeMillis() - t));

        t = System.currentTimeMillis();

        fib = fib2(47);

        System.out.println(fib + "  Completed fib2 in:" + (System.currentTimeMillis() - t));

    }

    long fib1(int n) {
        if (n == 0 || n == 1) {
            return n;
        } else {
            return fib1(n - 1) + fib1(n - 2);
        }
    }

    long fib2(int n) {
        return n == 0 ? 0 : fib2x(n, 0, 1);
    }

    long fib2x(int n, long p0, long p1) {
        return n == 1 ? p1 : fib2x(n - 1, p1, p0 + p1);
    }
} 
```

输出：

```
2971215073  Completed fib1 in:17414
2971215073  Completed fib2 in:0 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T17:30:50.860

因为两种算法的工作方式完全不同。让我用 fib(5) 向你展示这个。

如果你调用 fib1(5)，它会在内部调用 fib1(4) 和 fib1(3)，让我们用一棵树来可视化它：

```
    纤维（5）
  / \
fib(4) fib(3)
```

现在，fib(4) 在内部调用 fib(3) 和 fib(2)。

所以现在我们有了这个：

```
           纤维（5）
          / \
    fib(4) fib(3)
    / \ / \
fib(3) fib(2) fib(2) fib(1)

```

我认为到现在为止，这是非常明显的，你应该能够填写其余部分。

**编辑**：您应该注意的另一件事是，它实际上必须多次执行相同的计算。在这张图片中，fib(2) 和 fib(3) 都被多次调用。如果起始数字更大，情况会变得更糟。**/编辑**

现在，让我们看一下 fib2(5)。如果你用 0 调用它，它返回 0。否则，它调用 fib2x(n, 0,1) 所以，我们调用了 fib2x(5,0,1)。fib2x(n, 0,1) 现在在内部调用 fib2x(n-1, p1, p0+p1) 等等。那么，让我们看看：

```

fib2x(5, 0,1) => fib2x(4, 1,1) => fib2x(3, 1, 2) => fib2x(2, 2, 3) => fib2x(1, 3, 5)

```

至此，已经达到返回条件，返回5。

因此，您的算法工作方式完全不同。第一个递归地从上到下工作。第二个从 1 开始，一直向上。实际上，它比递归更迭代（它可能被写成递归让你失望）。它保留已经计算的值而不是丢弃它们，因此需要调用的计算要少得多。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-07T17:15:39.290

原因是两种算法具有不同的运行时复杂性：

*   `fib1`在[Ο(2 ^(*n*) )](https://stackoverflow.com/q/360748/53114)
*   `fib2`在Ο( *n* )中

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-07T17:37:12.180

最终，这是因为`fib2`只使用[尾端递归](https://stackoverflow.com/questions/33923/what-is-tail-recursion)。它最后只进行一次递归调用。因此，没有与递归相关的任何“分支”，并导致线性时间解决方案。它是尾调用的事实也导致某些编译器/VM 优化，其中递归可以转换为具有较低开销的迭代过程。

`fib1`除了导致运行时间呈指数增长的尾部调用之外，它还使用另一个递归调用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-07T17:33:19.080

fib1 是一种运行时间为 O(2^n) 的算法。fib2 是一种运行时间为 O(n) 的算法。

这样做的原因很酷——这是一种称为记忆的技术。程序所做的工作在每一步都保存下来，避免了任何无关的计算。

您可以通过将循环展开几个步骤来看到它：

```
long fib2(int n) {
    return n == 0 ? 0 : fib2x(n, 0, 1);
}
long fib2x(int n, long p0, long p1) {
    return n == 1 ? p1 : fib2xy(n - 1, 1, 1);
}
long fib2xy(int n, long p0, long p1) {
    return n == 1 ? p1 : fib2xyz(n - 1, 1, 2);
}
long fib2xyz(int n, long p0, long p1) {
    return n == 1 ? p1 : fib2xyz(n - 1, p1, p0 + p1);
} 
```

您可以将此循环展开为斐波那契数列中的任意数字；每个步骤都建立在先前存储在堆栈中的计算之上，直到 n 耗尽。这与第一个算法形成对比，第一个算法必须在每一步都重做这项工作。漂亮！

# php - $.ajax( type: "POST" POST 方法到 php

> ID：10936407
> 
> 赞同：12
> 
> 时间：2012-06-07T16:59:36.347
> 
> 标签：php, javascript, jquery, ajax, post

我正在尝试使用 jQuery 中的 POST 方法来发出数据请求。所以这是html页面中的代码：

```
<form>
Title : <input type="text" size="40" name="title"/>
<input type="button" onclick="headingSearch(this.form)" value="Submit"/><br /><br />
</form>
<script type="text/javascript">
function headingSearch(f)
{
    var title=f.title.value;
    $.ajax({
      type: "POST",
      url: "edit.php",
      data: {title:title} ,
      success: function(data) {
        $('.center').html(data); 
      }
    });
}
</script> 
```

这是服务器上的 php 代码：

```
<?php

$title = $_POST['title'];
if($title != "")
{
    echo $title;
}

?> 
```

根本没有发出 POST 请求，我不知道为什么。这些文件位于 wamp www 文件夹中的同一文件夹中，因此至少 url 没有错误。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-07T17:05:15.773

您需要使用`data: {title: title}`POST 正确。

在 PHP 代码中，您需要`echo`使用 value 而不是`return`ing 它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-07T17:15:45.713

检查 title 是否有任何值。如果不是，则使用 Id 检索值。

```
<form>
Title : <input type="text" id="title" size="40" name="title" value = ''/>
<input type="button" onclick="headingSearch(this.form)" value="Submit"/><br /><br />
</form>
<script type="text/javascript">
function headingSearch(f)
{
    var title=jQuery('#title').val();
    $.ajax({
      type: "POST",
      url: "edit.php",
      data: {title:title} ,
      success: function(data) {
    $('.center').html(data); 
}
});
}
</script> 
```

试试这个代码。

在 php 代码中，使用**echo**而不是**return**。只有这样，javascript 数据才会有价值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-05-02T18:59:05.237

试试这个

```
$(document).on("submit", "#form-data", function(e){
    e.preventDefault()
    $.ajax({
        url: "edit.php",
        method: "POST",
        data: new FormData(this),
        contentType: false,
        processData: false,
        success: function(data){
            $('.center').html(data); 
        }
    })
}) 
```

在表单中，按钮需要是`type="submit"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T18:12:25.063

我建议您使用更简单的方法 -

```
$.post('edit.php', {title: $('input[name="title"]').val() }, function(resp){
    alert(resp);
}); 
```

试试这个，我只是觉得它的语法比 $.ajax 的更简单......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-15T05:08:05.487

```
function signIn()
{
    var Username = document.getElementById("Username").value;
    var Password = document.getElementById("Password").value;

    $.ajax({
        type: 'POST',
        url: "auth_loginCode.jsp",
        data: {Username: Username, Password: Password},
        success: function (data) {
            alert(data.trim());
            window.location.reload();
        }
    });
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2019-05-20T12:28:43.830

```
contentType: 'application/x-www-form-urlencoded' 
```

# javascript - 将位图从 Flash 电影传输到 Javascript

> ID：10936408
> 
> 赞同：0
> 
> 时间：2012-06-07T16:59:46.283
> 
> 标签：javascript, actionscript-3, flash

我想知道将`BitmapData`对象从 Actionscript 传输到 Javascript 的最有效方法是什么，以便可以在网页上显示图像。

到目前为止，我已经设法使用 Flash 中的数据 URI 方案制作了一个包含图像数据的字符串，然后我使用`ExternalInterface.call("<function_name>", data)`.

虽然它工作正常，但将图像转换为其文本表示只是为了传输它似乎很浪费。有没有更清洁/更有效的方法来实现同样的目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T17:55:05.127

AS3：

base64 编码您的 BitmapData 对象。[那么示例](http://www.blackcj.com/blog/2009/12/22/base64-encoding-bitmapdata/)
：

```
ExternalInterface.call("setImage",encodedImg); 
```

Javascript：

```
function setImage(baseSixtyFourEncodedImage)
{
    document.getElementById("myImage").src = "data:" + baseSixtyFourEncodedImage;
} 
```

HTML：

```
<img id="myImage" src="no_image_from_flash_yet.png"> 
```

不要忘记在flash端导入ExternalInterface！让我知道事情的后续。

# sql-server - SQL Server BIDS 最大错误计数

> ID：10936412
> 
> 赞同：0
> 
> 时间：2012-06-07T17:00:04.683
> 
> 标签：sql-server, bids

我在 SQL Server BIDS 中工作，但一直收到错误消息：

> 错误代码：0x80019002
> 
> BIDS 告诉我我已达到最大错误数量，但它从未告诉我错误是什么……我如何找出错误是什么？

到目前为止，我的所有项目都包括读取 excel 源、从 unicode 到非 unicode 字符串的数据转换，然后是 OLE 数据库目标。

这是更多调试输出：

> 进度：2012-06-07 13:06:42.29
> 来源​​：数据流任务
> 发布执行：完成 66% 结束进度日志：
> 名称：OnInformation
> 计算机：SWDBD002
> 操作员：CORP\001196
> 
> 源名称：数据流任务
> 源 GUID：{AF22FA9B-1C72-40A9-A7EE-4EAB797CCBF9}
> 执行 GUID：{50B03BA7-39B5-4FC6-A613-C5BB9BF9138F}
> 消息：在“组件”OLE DB Dest 中插入数据的最终提交化“（131）”已经开始。
> 
> 开始时间：2012-06-07 13:06:42
> 结束时间：2012-06-07 13:06:42 结束日志
> 日志：
> 名称：OnInformation
> 计算机：SWDBD002
> 操作员：CORP\001196
> 源名称：成本
> 源 GUID：{3996EE76 -2D8B-4B92-A94B-29786A0A0C10}
> 执行 GUID：{50B03BA7-39B5-4FC6-A613-C5BB9BF9138F}
> 消息：“组件“OLE DB 目标”（131）中的数据插入的最终提交已经开始。
> 
> 开始时间：2012-06-07 13:06:42
> 结束时间：2012-06-07 13:06:42 结束日志
> 日志：
> 名称：诊断
> 计算机：SWDBD002
> 操作员：CORP\001196
> 源名称：“OLE DB 目标”（ 131)
> 源 GUID：{00000083-0000-0000-0000-000000000000}
> 执行 GUID：{50B03BA7-39B5-4FC6-A613-C5BB9BF9138F}
> 消息：ExternalRequest_pre：对象已准备好发出以下外部请求：'IRowsetFastLoad::Commit '。
> 开始时间：2012-06-07 13:06:42
> 结束时间：2012-06-07 13:06:42 结束日志

如果您需要更多信息，请与我们联系。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:46:07.653

看附图。您应该能够在 BIDS 的“执行结果”选项卡中找到类似的信息![错误图像](../Images/b8f9d88d0d96f00ae5e123dbdd583530.png)

# javascript - 获取关联数组的键

> ID：10936413
> 
> 赞同：5
> 
> 时间：2012-06-07T17:00:06.757
> 
> 标签：javascript, jquery, arrays

我目前正在使用 .each 获取一个数组：

```
$.each(messages, function(key,message){ doStuff(); }); 
```

但是键是数组的索引而不是关联键。

我怎样才能轻松获得它？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-07T17:09:16.493

JavaScript 没有“关联数组”。它有数组：

```
[1, 2, 3, 4, 5] 
```

和对象：

```
{a: 1, b: 2, c: 3, d: 4, e: 5} 
```

数组没有“键”。它们有索引，从 0 开始计数。

使用 访问数组，使用或`[]`访问对象。`[]``.`

例子：

```
var array = [1,2,3];
array[1] = 4;
console.log(array); // [1,4,3]

var obj = {};
obj.test = 16;
obj['123'] = 24;
console.log(obj); // {test: 16, 123: 24} 
```

如果您尝试使用字符串而不是 int 作为键来访问数组，则可能会导致问题。您将设置数组的属性而不是值。

```
var array = [1,2,3];
array['test'] = 4; // This doesn't set a value in the array
console.log(array); // [1,2,3]
console.log(array.test); // 4 
```

jQuery`$.each`与这两者都兼容。在 for 的回调中`$.each`，第一个参数 ,`key`是对象的键或数组的索引。

```
$.each([1, 2, 3, 4, 5], function(key, value){
    console.log(key); // Logs 0 1 2 3 4
});

$.each({a: 1, b: 2, c: 3, d: 4, e: 5}, function(key, value){
    console.log(key); // Logs 'a' 'b' 'c' 'd' 'e'
}); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-07T17:06:46.323

```
var data = {
    val1 : 'text1',
    val2 : 'text2',
    val3 : 'text3'
};
$.each(data, function(key, value) {
    alert( "The key is '" + key + "' and the value is '" + value + "'" );
});
​ 
```

查看[演示](http://jsfiddle.net/4qTv9/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:08:05.263

JavaScript 没有 PHP 中的“关联数组”，而是对象。但是，对象可能具有对应于值的字符串键。数组是按*数字*索引的值的列表，因此，如果`key`是数字，则它必须是您正在使用的数组而不是对象，因此您无法获取键，因为没有键。

因此，您可能希望使用简单的`for`-loop 而不是基于回调的迭代器（例如`$.each`.

# java - 我有一个 Java 异常：java.lang.NumberFormatException

> ID：10936414
> 
> 赞同：1
> 
> 时间：2012-06-07T17:00:08.350
> 
> 标签：java

编辑：我忘记在 Eclipse 中将启动类更改为客户端包！

这很奇怪，它在 Eclipse 中运行良好，然后我导出它，它给了我一个`java.lang.NumberFormatException`.

Start.java的pastebin

[http://pastebin.com/KxfApWKb](http://pastebin.com/KxfApWKb)

转储：

```
Exception in thread "main" java.lang.NumberFormatException: For input string: "gudenau.no-ip.org"

        at java.lang.NumberFormatException.forInputString(Unknown Source)
        at java.lang.Integer.parseInt(Unknown Source)
        at java.lang.Integer.<init>(Unknown Source)
        at com.gudenau.ChatServer.Start.main(Start.java:141) 
```

我不明白为什么它在 Eclipse 中有效，但不适用于批处理文件。

我用于套接字的代码是

```
socket = new Socket("gudenau.no-ip.org", 45678); 
```

稍后我会将其更改为不是静态的。

```
 try {
        socket = new Socket("gudenau.no-ip.org", 45678);

        out = new PrintWriter(socket.getOutputStream(), true);
        in = new BufferedReader(new InputStreamReader(
                socket.getInputStream()));
    } catch (NumberFormatException e) {
        e.printStackTrace();
        System.exit(-1);
    } catch (UnknownHostException e) {
        e.printStackTrace();
        System.exit(-2);
    } catch (IOException e) {
        e.printStackTrace();
        System.exit(-3);
    } 
```

编辑 141 左右的代码：

```
@Override
public void windowIconified(WindowEvent arg0) {
    // TODO Auto-generated method stub

}

@Override
public void windowOpened(WindowEvent arg0) {
    // TODO Auto-generated method stub

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:20:52.193

您为第 141 行添加的代码似乎不正确（我可能是错的）。错误来自一个名为 Start 的类（第 141 行）。我猜你正在尝试在那里创建一个整数，但是从一个不解析为整数的字符串。

您可能希望在该方法（或某些 System.out）处添加一个调试点，以查看您实际尝试转换为整数的内容。

更新：您正在查看错误的包，您需要 com.gudenau.ChatServer，而不是 com.gudenau.ChatCleint。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:13:01.143

您显示的堆栈跟踪表明异常来自第 141 行`Start.main()`，它直接实例化了一个`Integer`对象。由于`Socket`构造函数采用的是原语`int`，因此这不是实际问题。请使用第 141 行周围的代码更新您的帖子以`Start.main()`获得更好的答案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:52:41.523

我需要更改 eclipse jar 导出器中的启动类！哎呀！

# php - 根据mysql表行值显示隐藏div

> ID：10936415
> 
> 赞同：0
> 
> 时间：2012-06-07T17:00:13.233
> 
> 标签：php, jquery, mysql

大家好，我试图根据 mysql 值显示和隐藏 div，但我做不到，你能帮我我做错了什么，这是我的代码，非常感谢你的想法

```
var Value = <?php echo json_encode($valuek) ?>;
if (Value==1){
$('#show_hide').show();
}
else{
$('#show_hide').hide();
}

<?php
$valuek = $session->userinfo['vcc'];
?>

<div id="show_hide">
some code
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:01:24.357

```
<?php echo json_encode($valuek) ?> 
```

将返回一个 json 字符串，而不是尝试只使用“echo”

```
<?php echo $valuek ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:13:18.110

如果您只需要一个布尔值，那么根本不需要 JSON。

将值直接回显到 JavaScript 中。请记住确保您传递的是有效的布尔值。

* * *

PHP 代码 -

```
<?php
  $showDiv = ($dbValue == 1? 'true' : 'false');
?> 
```

* * *

JavaScript + PHP 注入 -

```
<script>
 var value = '<?php echo $showDiv; ?>';
<script> 
```

不要忘记用引号包裹 PHP 注入的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T18:01:17.103

```
$valuek = $session->userinfo['vcc']; 
```

我不确定您的 php 文件中是否有此顺序的代码，或者只是按此顺序显示代码片段，但应该在您的 js 代码之前进行。运行js代码时没有任何价值。

要查看 $valuek 是什么，只需在屏幕顶部回显它

```
 <?php echo "<h1>$valuek</h1>" ?>. 
```

或者只是查看源代码 - 在您的 js 函数中，查看在 'var Value =' 之后打印的内容，这才是真正的主要内容 - 以确保您从会话中获得预期的结果。

如前所述，您不需要 jason_encode，但在 echo 命令之后确实需要一个分号。另外，我希望您的 jquery 代码在 $(document).ready 函数中，而不是按原样。

# java - 针对具有包含的 xsd 验证 xml

> ID：10936419
> 
> 赞同：0
> 
> 时间：2012-06-07T17:00:21.933
> 
> 标签：java, xsd, xml-parsing, xml-validation

我正在尝试针对内部引用另一个 XSD（使用 include 语句）的 XSD 验证 XML。

作为，

```
<xs:include schemaLocation="Schema2.xsd"/> 
```

现在在针对 xsd(schema1.xsd) 验证我的 XML 时，例如：

```
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();

    DocumentBuilder builder;
    try {
        builder = factory.newDocumentBuilder();

        Document document = builder.parse(new InputSource(new StringReader(
                inputXml)));
        TransformerFactory tranFactory = TransformerFactory.newInstance();
        Transformer aTransformer = tranFactory.newTransformer();
        Source src = new DOMSource(document);
        Result xmlFile = new StreamResult(new File("xmlFileName.xml"));
        aTransformer.transform(src, xmlFile);
    } catch (Exception e) {
        // TODO: handle exception
    }

    File xmlFile = new File("xmlFileName.xml");
    SchemaFactory factory1 = SchemaFactory
            .newInstance("http://www.w3.org/2001/XMLSchema");

    File schemaLocation = new File("F:\\Project\\Automation\\XSDs\\schema1.xsd");
    Schema schema = factory1.newSchema(schemaLocation);

    Validator validator = schema.newValidator();

    Source source = new StreamSource(xmlFile);

    try {
        validator.validate(source);
        System.out.println(xmlFile.getName() + " is valid.");
        isXmlValid = true;
    } catch (SAXException ex) {
        System.out.println(xmlFile.getName() + " is not valid because ");
        System.out.println(ex.getMessage());
        isXmlValid = false;
    } 
```

我收到一个错误，“cvc-datatype-valid.1.2.1：'True' 不是 'boolean' 的有效值。”

这是针对在 schema1.xsd 所指的 schema2.xsd 中定义的元素。

如果我做错了什么，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:55:32.653

您遇到案例问题。'true' 是 xsd:boolean 的有效值，但 'True'（这显然是 XML 文档中的内容）不是。

此处的响应（[xsd:boolean 元素类型接受“true”但不接受“True”。我怎样才能让它接受它？](https://stackoverflow.com/questions/1308491/xsdboolean-element-type-accept-true-but-not-true-how-can-i-make-it-accept)）提供一些附加信息和基于枚举值的可能替代解决方案（如果您无法将 True 更改为 true ）。

# wcf - 读取已知类型队列时的中毒消息

> ID：10936423
> 
> 赞同：1
> 
> 时间：2012-06-07T17:00:40.177
> 
> 标签：wcf, msmq

我能够让它适用于不同的项目，并相信我遵循相同的路径/模式，但缺少一些东西。当我在 MSMQ 上发送已知类型的消息时，我不断收到有害消息。

我有一个名为 ConcreteClass 的类，它有几个属性，用 DataMember 属性装饰。我有一个 ConcreteClass 派生自的“基础”类。我可以很好地将消息发送到 MSMQ，但是当使用 WCF 从 MSMQ 读取时，服务总是出错并查看日志，这是一条有毒消息。

WCF 服务使用基类作为签名（在不同的项目中工作正常），并为服务应该期望的具体类装饰了 serviceknowntype 属性。

```
[ServiceKnownType(typeof(ConcreteClass))]
public sealed class WCFServiceMSMQReader : IWCFServiceMSMQReader { 
   [OperationBehavior(TransactionScopeRequired = true, TransactionAutoComplete = true)]
   public void ProcessIncomingMessage(MsmqMessage<BaseClass> msg) { .... do stuff .... }
} 
```

界面：

```
[ServiceContract]
public interface IWCFServiceMSMQReader {
   [OperationContract(IsOneWay = true, Action = "*")]
   void ProcessIncomingMessage(MsmqMessage<BaseClass> msg);
} 
```

基类：

```
[DataContract]
[KnownType(typeof(ConcreteClass))]
public class BaseClass
{
   ... some properties here...
} 
```

具体类：

```
[DataContract]
public class ConcreteClass : BaseClass {

public ConcreteClass() : base() { ... stuff ... }
public ConcreteClass(params here) : base() { .... }

} 
```

有什么想法我哪里出错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:12:20.723

服务已知类型应在接口中声明

# php - 如何从 Google Maps Geocode API 获取 JSON 请求

> ID：10936424
> 
> 赞同：0
> 
> 时间：2012-06-07T17:00:43.227
> 
> 标签：php, json, google-maps

由于某种原因，Google Maps Goeocode API 的 JSON 请求无法正常工作。如果您在地址栏中输入此网址：

```
http://maps.googleapis.com/maps/api/geocode/json?address=1600+Amphitheatre+Parkway+Mountain+View+CA&sensor=false 
```

它将返回：

```
{
   "results" : [],
   "status" : "OVER_QUERY_LIMIT"
} 
```

请注意，示例直接取自 Google Developers 站点：[https](https://developers.google.com/maps/documentation/geocoding/) ://developers.google.com/maps/documentation/geocoding/ 。

如何检索 JSON 请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:02:15.323

它不会把它还给我。

你只是做了太多的查询。

请参阅[https://developers.google.com/maps/documentation/geocoding/#Limits](https://developers.google.com/maps/documentation/geocoding/#Limits)

> 使用 Google Geocoding API 的查询限制为每天 2,500 个地理定位请求。（Google Maps API for Business 的用户每天最多可以执行 100,000 个请求。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:02:18.910

它只是对您不起作用，因为您超出了 Google Maps API 的限制。

您需要等待一段时间，获得新的 IP 地址或向谷歌支付费用。

有关限制、价格等的信息，请参阅[https://developers.google.com/maps/licensing 。](https://developers.google.com/maps/licensing)

# haml - 是否有用于 HAML（基于 Windows）的自动编译器？

> ID：10936426
> 
> 赞同：1
> 
> 时间：2012-06-07T17:00:49.580
> 
> 标签：haml

是否有用于 HAML 文件的自动编译器，它会在保存 HAML 文件时生成 HTML 文件？基本上，我正在寻找与 HAML 等效的[SimpLESS](http://wearekiss.com/simpless)，它是 LESS 的自动编译器 - 如果您查看他们的网站，您会很快了解我的要求。

# php - PHP/HTML 中的 URL 编码

> ID：10936428
> 
> 赞同：4
> 
> 时间：2012-06-07T17:00:55.840
> 
> 标签：php, html

我有一个带空格的网址：

> [http://mihalko.eu/image/data/ister/Nomad](http://mihalko.eu/image/data/ister/Nomad) Plus-G-cierno cervena.jpg

（浏览器可以打开此链接）对这个 url（空格=%20）进行 urlencode 的最佳方法是什么？

> Nomad%20Plus-G-%20cierno%20cervena.jpg

网址代码：

> http%3A%2F%2Fmihalko.eu%2Fimage%2Fdata%2Fister%2FNomad+Plus-G-+cierno+cervena.jpg

（浏览器无法打开此链接）
urlencode 给我这个结果，但我的浏览器不会打开这个 url。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:02:03.680

使用[rawurlencode](http://php.net/rawurlencode)：

```
echo rawurlencode('Nomad Plus-G- cierno cervena.jpg');
// Nomad%20Plus-G-%20cierno%20cervena.jpg 
```

如果您对编码为 as 的空格感到满意，`+`那么只需使用[urlencode](http://php.net/urlencode)即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:07:30.143

您可以搜索最后一个“/”并将 urlencode 用于字符串的最后一部分，如下所示：

```
$pos=strrpos($url,"/")+1;
$newurl=substr($url,0,$pos) . rawurlencode(substr($url,$pos)); 
```

如果您唯一的问题是空格，那么您可以使用

```
str_replace(" ","%20",$url); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:59:29.133

str_replace('%2F','/',rawurlencode('url')); 这是有效的。

# mysql - 用于多用户 Web 应用程序的高效 MySQL 数据库设计

> ID：10936430
> 
> 赞同：1
> 
> 时间：2012-06-07T17:01:01.597
> 
> 标签：mysql, database

我正在开发一个网站，允许用户跟踪个人工艺品的销售数字。它的工作方式是用户将能够提交/编辑每周销售数据，然后一旦数据被存储，就能够以各种形式的表格或图表查看它，跟踪趋势等。

我担心的是，随着用户群的增长，如果它增长，我想要一个能够随其扩展并且易于管理的数据库设计。当涉及到像这样的适当的网络应用程序时，我是自学的，虽然我拥有组装网站所需的所有 PHP 和 JS 知识，而且我以前使用过 jQuery，但我不太确定这一点。

我最好将用户的每周报告存储在一个大表中，还是创建一个单独的数据库，其中每个用户都有自己的表，依次包含该用户的每周报告？为完成的图表提取这些数据要比更改或添加数据要多得多，所以我的目标主要是存储/调用数据的效率和简单性。

最让我难过的是处理不同用户将拥有不同数量的产品这一事实的最佳方法，并且这些数量会发生变化。在用户的第一周，他们可能会记录 2 件商品的销售记录，但到了第三周，他们会将新商品添加到他们正在销售的商品列表中。数据库需要以低开销允许这种事情，因为大多数用户将拥有超过 1 个产品。

你将如何构建这个数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:04:24.243

我建议使用一个带有 innoDB 引擎的大表来进行行级锁定而不是表锁定。然后在用户名和进入时间上创建一个索引。

我建议每个用户的表有点多，你会浪费为用户可能不需要的表分配的硬盘和数据库空间。如果您的表甚至变得那么大，mySQL 支持 5+ 百万行是没有问题的。

简单是最好的。

# umbraco - 在 url 上获取 404 /auction/{一些向导}

> ID：10936431
> 
> 赞同：0
> 
> 时间：2012-06-07T17:01:06.150
> 
> 标签：umbraco, umbraco5

对 Umbraco 来说有点新，所以这可能是一个分散的问题。

我正在使用 5.1。

我有一个名为拍卖的文档类型，其中包含一个名为拍卖详细信息的选定模板

我的最终目标是在我的 AuctionSurfaceController 上调用这个控制器方法

```
 [ChildActionOnly]
    public PartialViewResult Detail(string id)
    {
        Guid auctionId;
        if (Guid.TryParse(id, out auctionId))
        {
            var auction = auctionService.Client.GetAuction(auctionId);
            return PartialView(auction);
        }
        return null;
    } 
```

截至目前，当我去 /Auction - 它点击此方法并将“拍卖”传递给该方法，当我去 /Auction/{GUID} 时，我只得到 404

我能否获得一些一般性指导 - 或要求澄清如何实现这一点。我将不胜感激

干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T21:39:46.643

听起来路由工作正常。

假设您是在“拍卖详细信息”页面的上下文中执行的，那么 /{GUID} 将用作 id 参数是有意义的。（而不是 www.mysite.com/auctions/auction/id）

有时会出现这个问题，因为页面上有多个表单，并且很难弄清楚 umbraco 将如何知道 Umbraco 将发布到哪个控制器。这就是[绑定属性](http://shazwazza.com/post/Umbraco-v5-Surface-Controller-Forms.aspx)发挥作用的地方。

但是，如果您想使用自定义路由，因为 Umbraco 5 是基于 MVC 构建的，您始终可以创建自己的区域和控制器。

# ios - CCAdvancedMenu 边界矩形

> ID：10936436
> 
> 赞同：1
> 
> 时间：2012-06-07T17:01:26.743
> 
> 标签：ios, xcode, cocos2d-iphone

希望有人能帮我解决这个问题......我正在关注[这里看到的 CCMenuAdvanced](http://www.cocos2d-iphone.org/forum/topic/14095)示例，但结果很奇怪，我看到我的菜单并且它滚动但使用 boundaryRect 属性我似乎无法隐藏它菜单的一部分并显示我想要的。

这是我的代码：

```
// Setup Menu Alignment
[menuA alignItemsVerticallyWithPadding:0 bottomToTop:NO]; //< also sets contentSize and keyBindings on Mac
menuA.isRelativeAnchorPoint = YES;

menuA.boundaryRect = CGRectMake(0, 100, 230, 200);

[menuA fixPosition];
[self addChild:menuA]; 
```

我可以滚动并查看我的整个列表，这很好，但我无法设置一个区域来一次只查看部分菜单，这就是 boundaryRect 应该做的。有没有人用过这个，可以给我一些建议吗？！？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T12:29:17.800

好吧，不是来自同一个班级，而是一个自制的滚动菜单。我使用 menuItems 本身的可见性和透明度。向上滚动时，如果菜单标签接近矩形的边缘，我开始将其淡出为 0。当 menuItem 的锚点位于矩形之外时，我将其可见性设置为 NO（因此无法单击）。下去也是一样。夹紧很棘手。当 menuItems 列表更改时，您必须设置这些属性，以防它变得比边界矩形的高度更短，或者再次变得大于矩形。像这样的东西（编辑，不是实际的代码......不知道它是否编译:)）：

```
-(void) fixMenuItemOpacity:(CCMenuItemLabel*) mi{

    float theY = mi.position.y ;

    if (fadeOutZoneHeight_<4.0f) {
        if (theY> self.boundaryRect.origin.y+self.boundaryRect.size.height/2 - fadeOutZoneHeight_) {
            mi.visible=NO;
        } else if( theY < self.boundaryRect.origin.y-self.boundaryRect.size.height/2 + fadeOutZoneHeight_) {
            mi.visible=NO;
        } else {
            mi.visible=YES;
        }
        return;
    }
    float delta;
    float percentOpacity;

    float topWindow;
    float bottomWindow;
    float top;
    float bottom;

    /*

     not visible

     --------------------------- top
     visible, variable opacity
     --------------------------- top window

     opacity 100%

     --------------------------  bottomWindow
     visible, variable opacity
     -------------------------   bottom

     */

    top = self.boundaryRect.origin.y + self.boundaryRect.size.height/2;
    topWindow = top - fadeOutZoneHeight_;
    bottom = self.boundaryRect.origin.y - self.boundaryRect.size.height/2;
    bottomWindow=bottom+ fadeOutZoneHeight_;

    if (theY> top ) {
        mi.visible=NO;
    } else if ( (theY > topWindow) && (theY < top)) {
        mi.visible=YES;
        delta = abs((int)top - (int)theY);
        percentOpacity=delta/fadeOutZoneHeight_;
        mi.opacity=(GLubyte )(255.0f*percentOpacity);
    } else if( (theY <= topWindow ) && (theY >= bottomWindow ) ){
        mi.opacity=255;
        mi.visible=YES;

    } else if ( (theY < bottomWindow) && (theY >= bottom) ){
        mi.visible=YES;
        delta= abs((int)bottom - (int)theY);
        percentOpacity = delta/fadeOutZoneHeight_;
        mi.opacity=(GLubyte ) (255.0*percentOpacity);
    } else {
        mi.visible=NO;
    }

} 
```

# android - 使用 facebook sdk android 向 facebook 发布消息时出错

> ID：10936439
> 
> 赞同：1
> 
> 时间：2012-06-07T17:01:35.883
> 
> 标签：android, facebook

`NullPointerException`使用 facebook sdk android 向 facebook 发布消息时，我收到了一条消息。当`facebook.authorizeCallback(requestCode, resultCode, data);`被调用时，它会与`NullPointerException`.

我的代码：

```
public void facebookShare(final String msg)
    {
        facebook = new Facebook(FACEBOOK_APPID);
        facebook.authorize(MainActivity.this,new String[] { FACEBOOK_PERMISSION },

                  new DialogListener() {
                       @Override
                       public void onComplete(Bundle values) {
                            try { 
                                Bundle parameters = new Bundle();
                                parameters.putString("message", msg);
                                String response = facebook.request("me/feed", parameters, "POST");
                                Log.d("fbproblem", "got response: " + response);
                                if (response == null || response.equals("") ||
                                    response.contains("error")) {
                                    Log.d("Login failed", "RETRY");
                                }
                                else {
                                    Log.d("fbproblem","Message posted to your facebook wall!");
                                    Toast.makeText(getApplicationContext(), "Message posted to your facebook wall!", Toast.LENGTH_LONG).show();                                 
                                    //facebook.logout(MainActivity.this);
                                }
                            }catch(Exception e) {
                                //finish();
                                Log.d("fbproblem", e.getMessage());
                            }
                           Log.d("fbproblem", "SUCCESS");
                           //finish();
                       }

                       @Override
                       public void onFacebookError(FacebookError error) {
                           Log.d("fbproblem", error.getMessage());
                           //finish();
                       }                               

                       @Override
                       public void onError(DialogError e) {
                           Log.d("fbproblem", e.getMessage());
                           //finish();
                       }

                       @Override
                       public void onCancel() {
                           Log.d("fbproblem", "");
                           //finish();
                       }
                  }
            );
    }
    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        try
        {
            super.onActivityResult(requestCode, resultCode, data);
            facebook.authorizeCallback(requestCode, resultCode, data);
        }
        catch(Exception e)
        {
            Log.d("fbproblem", e.getMessage());
            Toast.makeText(getApplicationContext(), "Something goes wrong Try again Later!!", Toast.LENGTH_LONG).show();
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T12:44:12.050

请更新您的应用程序的以下代码。

```
public void loginAndPostToWall() {
    facebook.authorize(this, PERMISSIONS, Facebook.FORCE_DIALOG_AUTH,
            new LoginDialogListener());
} 
```

# c# - 加载管道程序集 GifAnimation.dll 时出错

> ID：10936441
> 
> 赞同：2
> 
> 时间：2012-06-07T17:01:45.947
> 
> 标签：c#, visual-studio-2010, xna

使用此处找到的 GifAnimation XNA 包时--http://xnagif.codeplex.com/

我收到一条错误消息：

> 错误 2 加载管道程序集“D:###\Documents##################\GifAnimation.Pipeline\bin\x86\Debug\GifAnimation.dll”时出错。

并且代码在这一行中断：

```
animation = Content.Load<GifAnimation.GifAnimation>("Falling Stars"); 
```

我检查了项目的引用，它们都在工作，并且 .dll 文件存在于错误提到的位置。

我该如何解决？谢谢！

# c# - IHTMLDocument -- 按 ID 而非名称单击 IHTMLElement

> ID：10936454
> 
> 赞同：1
> 
> 时间：2012-06-07T17:03:00.347
> 
> 标签：c#, wpf, webbrowser-control, mshtml

我需要填写的输入字段的名称值设置为 j_password。我想单击的按钮是 div 中的一个链接，其 id 设置为 loginBtn。

我正在尝试这样的事情：

```
mshtml.IHTMLDocument2 doc = ((mshtml.IHTMLDocument2)webBrowserControl.Document);
((mshtml.IHTMLElement)doc.all.item("j_password")).setAttribute("value", password);
((mshtml.IHTMLElement)doc.all.item("loginBtn")).click(); 
```

但是该按钮永远不会被点击。我不知道是因为它不是真正的按钮，还是因为它没有名称属性并且我正在尝试使用 id。

无论如何，有没有人看到解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T23:05:24.967

如果单击调用未引发 NullReferenceException，则您找到了该元素。但将来最好使用标准的 IHTMLDocument3::getElementById 或 IHTMLDocument3::getElementsByName 而不是 document.all。

至于为什么点击不起作用，这取决于点击应该如何工作。鼠标点击有很多副作用，如果鼠标不在鼠标按下和鼠标按下之间的元素上方，浏览器可能会限制这些副作用。

如果单击应该调用javascript函数，则直接调用该函数（ExecScript）。否则，找到登录表单元素，如果有，则调用其 onsubmit 处理函数，然后调用其提交方法。

# c++ - 当程序变得无响应时，如何确定它在做什么？

> ID：10936456
> 
> 赞同：1
> 
> 时间：2012-06-07T17:03:21.960
> 
> 标签：c++, debugging, visual-c++

我的程序在执行某个功能时变得无响应。我怎样才能实时看到它在做什么，以了解它为什么变得无响应？

它没有崩溃，所以很遗憾我看不到原因。我怎样才能知道它在做什么？

我能做些什么？对于有和没有实际源代码的情况，有哪些程序在这种情况下是好的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T17:06:22.377

您需要在调试器中运行，然后在出现减速时中断执行。它停止的地方很可能就是你的问题所在。如果您多次启动和停止，则执行中断最频繁的地方可能会确定。

或者使用分析器。任何一个程序都可以在没有源代码的情况下工作，尽管使用源代码和调试符号更容易使用它们（在您运行的平台上不需要相当多的汇编知识技能。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:13:14.070

看看来自 Sysinternals [http://technet.microsoft.com/en-us/sysinternals/bb896645的 Process Monitor](http://technet.microsoft.com/en-us/sysinternals/bb896645)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:26:12.330

**A. 附源代码**

您可以将 Visual Studio 附加到进程并按下中断。然后查看调用堆栈。如果 ti 没有崩溃，则它可能没有递归。所以你应该看看它在做什么。

如果是多线程应用程序，则在线程之间切换并观察调用堆栈。

**B. 如果没有源代码** ，我认为这很难。唯一能找到的就是外部分析。像使用wireshark 来观察网络活动或来自Sysinternals (procmon.exe) 的进程监视器来查看注册表或文件访问。

# akka - 如何将 Akka 用于跨电子邮件和数据库的事务？

> ID：10936460
> 
> 赞同：1
> 
> 时间：2012-06-07T17:03:38.740
> 
> 标签：akka

我有一个包含用户列表的组件的情况。我需要向每个用户发送一封电子邮件，然后更新用户的记录以指示发送电子邮件的时间。

这似乎是 Akka 的一个很好的第一个用例。我认为获取用户列表的组件将是一个 Actor，并且将为每个出站电子邮件发送 Actor 创建一个单独的 Actor，它可以是多线程的。发送电子邮件的 Actor 将负责更新用户记录中的日期。

如果发送邮件的 Actor 失败，用户的记录将不会被完成，监督 Actor 将能够重新安排它。

那是正确的模型吗？还是主管应该负责更新用户记录？

或者这对 Akka 来说是一个糟糕的用例吗？

顺便说一句，我可以通过 SMTP 或网络服务发送邮件。我不认为这对讨论很重要，但我想我会提到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T21:45:54.117

当涉及 IO 时，我认为您不应该对事务性感到困惑。您无法保证电子邮件会被正确的人阅读、接收、接收、在一定时间内收到、被理解等。

只需发送电子邮件，然后更新数据库。快乐哈金！

# php - 带有 Yii 框架的 Facebook OpenGraph - 身份验证问题

> ID：10936463
> 
> 赞同：0
> 
> 时间：2012-06-07T17:03:41.123
> 
> 标签：php, facebook, yii, infinite-loop, access-token

我在使用 php Facebook sdk 时遇到问题。我已经阅读了许多关于相同类型问题的帖子（访问令牌无效、重定向循环等），但没有一个可以提供帮助。

简而言之，我的项目是如何设计的：

它是一个 Facebook 应用程序，仅适用于登录 Facebook 的用户。使用 Yii 框架，我创建了一个过滤器，每次加载页面时都会调用它，以确保内容仅对 Facebook 登录用户可见。它的行为应该与 Facebook 上的应用程序 BranchOut 完全相同。

我的问题，以及如何重现它：

*   我使用来自 Facebook 的典型登录过程（OAuth，访问令牌）登录到我的应用程序
*   我在 Facebook 页面上手动注销，然后尝试在我的应用程序上执行新操作
*   过滤器检查我是否登录 Facebook，因为我没有登录，它会将我重定向到 Facebook 登录页面。
*   再次登录 Facebook 后，我在 Facebook 和我的应用程序的过滤器之间得到了典型的无限循环。

这是我的过滤器的代码：

```
$fb_logged = false;
try
{
    $user = Yii::app()->facebook->getUser();
    $me = Yii::app()->facebook->api('/me');
    $fb_id = $me['id'];
    $fb_logged = true;
}
catch (Exception $e)
{
    $fb_logged = false;
}

if($fb_logged)
{
    print_r($fb_id. ' has logged');
    /* Check if user exists on MyApp 
     ... */
}
// If user NOT logged on FB, send him to the FB login page
else
{
    $loginUrl = Yii::app()->facebook->getLoginUrl(array(
                'redirect_uri' => Yii::app()->getRequest()->getUrl() // I have tried many things here.
        ));
    echo("<script> top.location.href='" . $loginUrl . "'</script>");
    Yii::app()->end();
} 
```

实际发生的情况是，在 FB 上登录后，再次调用过滤器，因为对同一 URL 进行了请求。那时，对 api('/me') 的调用会产生异常，因为它找不到任何有效的访问令牌，并开始在其上循环。

我可以补充一点，我的配置很好（或者看起来很好），我已经根据 Facebook 的应用程序设置检查了我所有的网址和域名。我也尝试过很多事情，比如重定向到一个新的特定 URL，但无论如何我也需要使用过滤器，因为我想确保这仍然是同一个用户（或者如果用户发生了变化，则采取相应的行动）。

唯一可行的是将用户重定向到没有过滤器的页面（没有调用 api("/me")）。然后，手动单击应用程序中的新链接，并在那里找到访问令牌。这不是我想要的行为。

我真的希望有人能帮助我！

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:19:08.630

在您进行新的登录尝试后，您应该会在重定向到的 URL 中获得一个新代码。因此，查找该代码参数，如果存在，请将其交换为新的访问令牌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-11T13:03:24.300

看看[yiiauth](http://www.yiiframework.com/extension/yiiauth/)扩展。它今天刚刚发布，您可以使用它登录 29 个不同的提供商：Facebook、OpenID、Google、Twitter、Yahoo 等。

它使用[HybridAuth](http://hybridauth.sourceforge.net/index.html)库和 AFAICT，使身份验证变得非常容易。

# c# - 3 层（项目）：如何从第一层抛出异常并在第三层捕获它

> ID：10936464
> 
> 赞同：0
> 
> 时间：2012-06-07T17:03:41.283
> 
> 标签：c#, exception

我有三层：

1.  ServiceHandlers（与 ax2012 对话并将数据映射到实体）
2.  服务（它从 serviceHandlers 中调用函数，例如 getOrder 并返回它）
3.  Winform（或者可以是任何人设计 UI，使用服务逻辑来做到这一点）。

我的问题是 ServiceHandlers 中的异常处理。我实现了我自己的异常`EntityNotFound`，当调用 getEntity 函数并且没有找到任何东西时我会抛出该异常。当我抓住它时，我所做的就是再次扔它并在服务中抓住它。

在 catch 块内，我只使用语句 throw; ..虽然我会把它扔回去，然后我会在winform层的catch语句中捕捉到。但是发生的事情是应用程序在服务层停止并说“EntityNotFoundException”未处理，这是好的，但我希望这发生在 winform 层。

希望这是可以理解的，所以..有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:12:18.167

首先，除非您添加一些值（例如日志记录）或添加服装消息，否则不要捕获并重新抛出异常。您可以尝试...在 GUI 层捕获异常以适当地处理它。

其次，示例代码将帮助您调试问题。

# c# - 构建发布时，C# 中的 Debug.WriteLine 将输出到哪里？

> ID：10936468
> 
> 赞同：24
> 
> 时间：2012-06-07T17:03:54.290
> 
> 标签：c#, debugging

我在代码中放置了很多 Debug.WriteLine 用于调试目的。当我准备发布发布时，这些 Debug.Write 是否会影响发布版本，它们会输出到哪里？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-06-07T17:06:34.250

`Debug.WriteLine`用`Conditional`属性注释。（见[MSDN](http://msdn.microsoft.com/en-us/library/9z9k5ydz.aspx)）

[ConditionalAttribute](http://msdn.microsoft.com/en-us/library/system.diagnostics.conditionalattribute.aspx)告诉编译器不要生成该代码，除非提供了标志`DEBUG`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-06-07T17:10:39.057

来自[MSDN](http://msdn.microsoft.com/en-us/library/vstudio/system.diagnostics.debug(v=vs.110))：“ConditionalAttribute 属性应用于 Debug 的方法。支持 ConditionalAttribute 的编译器会忽略对这些方法的调用，除非将“DEBUG”定义为条件编译符号。请参阅编译器的文档以确定是否支持 ConditionalAttribute 以及语法用于定义条件编译符号。”

因此，如果您的发布配置不包含 DEBUG 符号，则在编译期间将省略 Debug.WriteLine 调用，并且不会有输出。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-06-07T17:08:15.960

如果将它们切换到[`Trace.WriteLine`](http://msdn.microsoft.com/en-us/library/system.diagnostics.trace.writeline.aspx)，则可以在 app/web.config 文件中定义任意侦听器。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-06-07T17:06:49.413

Debug.Writeline 不会编译到发布代码中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-06-07T17:06:27.360

我相信它会被编译出来。

# usb - Wakelock 仅适用于连接的 USB 电缆

> ID：10936469
> 
> 赞同：1
> 
> 时间：2012-06-07T17:04:09.077
> 
> 标签：usb, wakelock, android, android-wake-lock

我有一个相当奇怪的问题。最近我尝试使用以下代码在我的应用程序中使用唤醒锁：

```
 /** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    PowerManager pm = (PowerManager) getSystemService(POWER_SERVICE);
    screenLock = pm.newWakeLock(PowerManager.FULL_WAKE_LOCK, "DoNotDimScreen");
    button = (Button)findViewById(R.id.button);
    button.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View view) {
            System.out.println("Clicked");
            try {
                Thread.sleep(5000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            if (!locked)
                setKeepScreenOn(WakeupLightActivity.this, true);
            else setKeepScreenOn(WakeupLightActivity.this, false);
            System.out.println("Screen will stay on");
        }
    });
}

public void setKeepScreenOn(Activity activity, boolean keepScreenOn) {
    if(keepScreenOn) {                    
        activity.getWindow().addFlags(WindowManager.LayoutParams.FLAG_TURN_SCREEN_ON);          
        activity.getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
        this.screenLock.acquire();
    } 
    else {                                 
       activity.getWindow().clearFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);             
       activity.getWindow().clearFlags(WindowManager.LayoutParams.FLAG_TURN_SCREEN_ON);
        this.screenLock.release();
    }
} 
```

唤醒锁工作完美：按下按钮（并锁定我的手机）5 秒后，屏幕打开。但是，此测试是在我的手机连接到我的笔记本电脑以使用 USB 电缆进行调试时完成的。

现在是奇怪的部分。当我没有用 USB 数据线连接手机时，wakelock 根本不会打开屏幕。我正在使用的设备是 HTC 的愿望。我实际上已经在另一个 HTC 愿望上测试过它，它做了同样的事情。接下来，我在 HTC Desire HD 上试了一下。猜猜看：它再次完美运行！我对此感到非常困惑，想知道问题是否只是我手机类型的缺陷，还是我的代码做错了什么。我能做些什么吗？如果任何手机类型故障的潜在客户在购买我的应用程序后遇到同样的问题，那将是非常尴尬的。

请注意，我还在使用连接到墙上插头的电缆为手机充电时尝试了该应用程序。这会导致与根本没有连接手机相同的问题。两款 HTC Desires 运行相同的 Android 版本 (2.2.2)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-09T13:27:29.573

显然所有这些都是因为我使用了错误的标志而发生的。通过使用以下标志创建 WakeLock 解决了该问题：

```
PowerManager.SCREEN_BRIGHT_WAKE_LOCK|PowerManager.ACQUIRE_CAUSES_WAKEUP 
```

# php - PHP爆炸字符串与数组？

> ID：10936471
> 
> 赞同：5
> 
> 时间：2012-06-07T17:04:11.577
> 
> 标签：php, arrays, string, explode

是否有理由在需要数组的地方使用字符串？

我有一个开发人员想要传递一个分隔字符串，在数据库类方法中分解它以从 2 个单独的字符串中提取多个字段/值对。我想不出不发送字符串数组的理由。

例子：

```
$s = "value1|value2|value3" ;
$s2 = explode("|", $s); 
```

与数组

```
$s3 = array(
    "1" => "value1",
    "2" => "value2",
); 
```

我知道这个想法实际上是传递未知数量的键/值对，但我不认为你爆炸的字符串是答案。但我可能是错的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-09T12:15:31.213

> 我想不出不发送字符串数组的理由。

字符串是单个实体。您的同事使用字符串“object”（变量或实体意义上的对象）使其携带信息，这是一种非常小的领域特定语言形式。

但正如它已经表明的那样，这只是开销而不是必要的。可能那个人只是懒惰打字，认为这更酷。实际上更酷的是，只需升级 PHP 并使用新的数组表示法。它也很短，并且它比首先需要解析器的字符串（这里以分隔字符爆炸）携带更多信息：

```
explode("|", "value1|value2|value3");

array("value1", "value2", "value3");

["value1", "value2", "value3"]; 
```

如果你想知道你的同事有多认真：他在玩。玩是可以的，但如果他需要进行强力游戏以表明他可以将其作为一种风格压制到共享代码库中，那就打他的手指。那是愚蠢的。如果您需要一个数组，请传递一个数组。

这不像让我们说正则表达式。这只是你的同事在代码库中引入问题的一些自嘲。仅仅因为某事是可能的并不意味着它更好。

> 我想不出不发送字符串数组的理由。

好吧，我可以想象一些可能的原因：

*   其他人只是想表明他们对你的了解不同*并且*有能力说服项目中的其他人（社会问题）
*   你不能接受你在团队中的地位太低，你甚至不能做出合理的论据来说服其他人，你跑到这里来抱怨，因为你希望你能找到更多的力量而不是响应升级@你的团队（社会问题）
*   那家伙只是个混蛋，想要引入秘密的复杂性，以便只有他可以编辑和更改代码（职业管理，也可能是社会问题的标志）。

请不要太认真地对待这些评论；）你问没关系，但没有太多答案，因为这闻起来很可疑，因为可能有一些原因表明这样的东西可能有用（尽管我对此表示怀疑，因为有些小 OOP 的东西在这里开始看起来非常不同）。所以它总是取决于，但尽量保持你编辑的代码易于编辑并且不要添加太多魔法。可以将该字符串视为一个魔术数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T13:13:50.870

我会说这对于 100% 准确的答案来说是不够的。在大多数情况下，答案是否定的。但这可能是一些特定情况。

您从哪里以及从哪里传递数据？

有时您认为的数组实际上是（或曾经是）一个字符串，例如，如果“底层”层是 JSON 或 XML。通过内爆/爆炸字符串来传递和解析数据**可能**会更快——但同样，对此没有共同的答案，它取决于很多事情，例如数据的数量和结构。你应该尝试并测试它。或提供更具体的信息:)

# java - 在 JAVA 中处理“netascii”

> ID：10936478
> 
> 赞同：1
> 
> 时间：2012-06-07T17:04:33.167
> 
> 标签：java, encoding, io

我在 java 中实现了一个 TFTP (RFC 1350) 客户端和服务器。

> 当前支持三种传输模式：netascii（这是“美国信息交换标准代码”[1] 中定义的 ascii，并在“Telnet 协议规范”[3] 中指定了修改。）请注意，它是 8 位 ascii。本文档中将使用术语“netascii”来表示此特定版本的 ascii。）；

这在 Java 术语中是什么意思？在这种模式下如何读取/写入文件或转换字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:33:37.787

[netascii](http://en.wikipedia.org/wiki/Trivial_File_Transfer_Protocol#Overview)似乎被定义为 ASCII 的 8 位扩展，但仅限于从 0x20 到 0x7F 的基本 ASCII，[外加 8 个控制字符](https://www.rfc-editor.org/rfc/rfc764)（见第 9 页）：0x00 (NUL)、0x10 (LF)、0x13 (CR)、 0x07 (BEL)、0x08 (BS)、0x09 (HT)、0x11 (VT) 和 0x12 (FF)。

除了确保您的输出仅在此范围内是纯 ASCII 之外，netascii 的另一个要求是换行符始终是 CRLF，因此您必须进行相应的转换。任何 CR 后面只能跟 LF 或 NUL。

您可以使用[Apache Commons](http://commons.apache.org/net/api-3.1/org/apache/commons/net/io/ToNetASCIIOutputStream.html)为您处理此问题，但如果您想推出自己的实现，只需使用`US-ASCII`Java 中的编码，然后执行额外检查以确保您没有来自 0x00– 的任何不允许的控制字符0x20 范围，最后确保您的换行符是 CRLF 而不仅仅是 LF。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:17:35.560

> 问：这在 Java 术语中是什么意思？

A：我认为这只是意味着您需要在读取或写入这些 8 位 ASCII 值时指定字符集：

*   `byte[] bytes = string.getBytes("UTF-8");`

*   `String string = new String(bytes, "UTF-8");`

# sql-server - 临时表上没有外键限制？SQL Server 2008

> ID：10936485
> 
> 赞同：5
> 
> 时间：2012-06-07T17:05:04.103
> 
> 标签：sql-server

我知道一个临时表只会在 SQL Server 会话打开时才存在，但为什么你不能对它们进行外键限制呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-02-20T02:17:20.110

想象一下这种情况：您创建了一个从临时表到具体表键的外键关系。外键关系的限制之一是您不能从临时表所依赖的键表中删除行。现在，通常当您创建外键关系时，您知道在删除键表中的相关行之前删除依赖表行，但是存储过程或对数据库的任何其他调用如何知道从临时表中删除行？不仅不可能发现虚假的外键依赖关系，其他会话即使可以发现关系也无法访问您的临时表。这会导致删除语句中的虚假失败，因为外键约束会限制依赖行的键表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-07T17:14:50.917

您可以在 tempdb 中的表之间创建外键。例如，试试这个：

```
use tempdb

create table parent
(
    parent_key int primary  key clustered
)

create table child
(
    child_key int primary key clustered,
    child_parent_key int
)
alter table child add constraint fk_child_parent foreign key (child_parent_key) references parent(parent_key)

insert into parent(parent_key) select 1
insert into child(child_key, child_parent_key) select 1, 1
insert into child(child_key, child_parent_key) select 2, 2 -- this fails because of the FK constraint

drop table child
drop table parent 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:07:41.067

可能是因为您不能有跨数据库外键约束，并且临时表在技术上是在 TempDB 数据库中创建的。

除非你的意思是在一个临时表和另一个临时表之间......但当你谈论临时表上的那些约束时，你确实会遇到很多问题。

# android - 动画淡入后显示进度条

> ID：10936487
> 
> 赞同：1
> 
> 时间：2012-06-07T17:05:09.347
> 
> 标签：android, animation, progress-bar, fadein

我有这段代码可以用图像创建淡入淡出的动画

push_top_in 代码创建一个从上到下的淡入淡出动画

```
<set xmlns:android="http://schemas.android.com/apk/res/android">
    <translate android:fromYDelta="-100%p" android:toYDelta="0" android:duration="1000"/>
    <alpha android:fromAlpha="0.0" android:toAlpha="1.0" android:duration="1000" />
</set> 
```

JAVA代码调用push_top_in动画

```
 ImageView imvLogo = (ImageView) findViewById(R.id.imvLogo); 
    Animation myFadeInAnimation = AnimationUtils.loadAnimation(MisCompras.this, R.animator.push_top_in);
    imvLogo.startAnimation(myFadeInAnimation); 
```

现在我想在动画结束时显示一个进度条，我使用这段代码

```
 myFadeInAnimation.setAnimationListener(new AnimationListener() {
        @Override
        public void onAnimationStart(Animation animation) {
        }
        @Override
        public void onAnimationRepeat(Animation animation) {
        }
        @Override
        public void onAnimationEnd(Animation animation) {
            progressBarCust = (ProgressBar)findViewById(R.id.progressBar);
            textViewLoad = (TextView)findViewById(R.id.txvProgreso);
            Handler hdl = new Handler();
            hdl.postDelayed(new MiSuperHandler(), 5000);       
        }
    }); 
```

但是 setAnimationListener 代码抛出了下一个异常

```
FATAL EXCEPTION: main
java.lang.RuntimeException: Unable to start activity ComponentInfo{miscompras.principal/miscompras.principal.MyActivity}: java.lang.NullPointerException 
```

我不知道出了什么问题

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T18:00:45.373

如果您仍然需要答案，请尝试替换 `R.animator.push_top_in` 为 `R.anim.push_top_in`

# javascript - JS：如何返回“未定义”而不是抛出错误“无法读取未定义的属性 x”

> ID：10936491
> 
> 赞同：2
> 
> 时间：2012-06-07T17:05:36.570
> 
> 标签：javascript

当父属性不存在时，让 js 返回 undefined 而不是抛出错误的最佳方法是什么？

例子

```
a = {}
b = a.x.y.z
// Error: Cannot read property 'value' of undefined
// Target result: b = undefined 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:14:23.657

您必须检查每个属性是否存在：

```
var b;
if (a.x && a.x.y && a.x.y.z) {
    b = a.x.y.z
} 
```

或者，类似于另一张海报的“safeGet”功能：

```
var get = function (obj, ns) {
    var y = ns.split('.');
    for(var i = 0; i < y.length; i += 1) {
        if (obj[y[i]]) {
            obj = obj[y[i]];
        } else {
            return;
        }
    }
    return obj;
}; 
```

利用：

```
var b = get(a, 'x.y.z'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T17:11:10.113

我会稍微冗长：

```
var b = ((a.x || {}).y || {}).z 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-07T17:07:57.270

```
try {
  a = {}
  b = a.x.y.z
}
catch (e) {
  b = void 0;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-07T17:17:49.867

您可以编写一个`safeGet`辅助函数，例如：

按照 arcyqwerty 评论中的建议进行了深入编辑

```
var getter = function (collection, key) {
    if (collection.hasOwnProperty(key)) {
        return collection[key];
    } else {
        return undefined;
    }
};

var drillDown = function (keys, currentIndex, collection) {
    var max = keys.length - 1;
    var key = keys[currentIndex];

    if (typeof collection === 'undefined') {
        return undefined;   
    }

    if (currentIndex === max) {
        return getter(collection, key);
    } else {
        return drillDown(keys, currentIndex + 1,
                         getter(collection, key));
    }
};

var safeGet = function (collection, key) {
    if (key.indexOf(".") !== -1) {
        return drillDown(key.split("."), 0, collection);
    } else {
        return getter(collection, key);
    }
};

a = { x: 1 };
b = safeGet(a, 'x.y.z'); 
```

[http://jsfiddle.net/YqdWH/2/](http://jsfiddle.net/YqdWH/2/)

# xquery - 从 xdmp:http-get() 访问 HTTP 响应

> ID：10936494
> 
> 赞同：2
> 
> 时间：2012-06-07T17:05:53.213
> 
> 标签：xquery, marklogic

使用 MarkLogic 从带有`xdmp:http-get()`or的 Web 服务中提取数据`xdmp:http-post()`，我希望能够在尝试处理数据之前检查返回的标头。在 DQ 我可以这样做：

```
let $result := xdmp:http-get($query,$options) (: $query and $options are fine, I promise. :)
return $result 
```

我得到的结果是这样的：

```
<v:results v:warning="more than one node">
       <response>
           <code>200</code>
            <message>OK</message>
            <headers>
              <server>(actual server data was here)</server>
              <date>Thu, 07 Jun 2012 16:53:24 GMT</date>
              <content-type>application/xml;charset=UTF-8</content-type>
              <content-length>2296</content-length>
              <connection>close</connection>
            </headers>
        </response> 
```

其次是实际反应。问题是我似乎无法将 XPath 插入此响应节点。如果我将我的 return 语句更改为`return $result/response/code`我得到空序列。如果我可以在尝试处理返回的实际数据之前检查该代码以确保我得到了 200，那将比使用 try-catch 块来查看数据是否存在并且是否正常要好得多。

因此，如果有人知道如何访问这些响应代码，我很乐意看到您的解决方案。

作为记录，我试过了`xdmp:get-response-code()`，但它不带任何参数，所以我不知道它在看什么响应代码。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-07T19:49:03.587

你会同时被两个陷阱烧死：

*   命名空间意识
*   文档节点的意识

首先，命名空间。http-get 函数的 XML 输出位于顶层元素所见的命名空间中：

```
<response xmlns="xdmp:http-get"> 
```

要成功访问该命名空间中的元素，您需要在绑定到正确命名空间的查询中声明一个前缀，然后在 XPath 表达式中使用该前缀。例如：

```
declare namespace h="xdmp:http-get";
//h:code 
```

现在让我们谈谈文档节点。:-)

您尝试将其`$result`视为包含元素的文档节点进行访问，但实际上，它是两个根节点的序列（因此它们也不是兄弟节点）。第一个（您在这里感兴趣的那个）是无父`<response>`元素——<em>不是包含`<response>`元素的文档。

这是一个常见的问题：知道文档节点何时存在或不存在。文档节点在序列化时总是不可见的（因此有问题），并且它们总是存在于存储在数据库中的文档中。但是，当您只在 XQuery 中使用裸元素构造函数时（如 http-get 实现所做的那样），您构造的不是文档节点，而是没有文档节点父节点的元素节点。

例如，以下查询将返回空序列，因为它试图获取 的`<foo>`子级`<foo>`：

```
declare variable $foo := <foo>bar</foo>;
$foo/foo 
```

另一方面，以下内容*确实*返回了`<foo>`，因为它正在获取`<foo>`文档节点的子节点（在 XQuery 中必须显式构造）：

```
$declare variable $doc := document{ <foo>bar</foo> };
$doc/foo 
```

因此，您必须知道给定函数的 API 是如何设计的（无论它返回包含元素的文档还是仅返回一个元素）。

要解决您的问题，请不要尝试访问`$result/h:response/h:code`（这是试图获取的`<response>`孩子`<response>`）。相反，访问`$result/h:code`（或更准确地说`$result[1]/h:code`，因为`<response>`是 http-get 函数返回的两个节点序列中的第一个）。

有关文档节点的更多信息，请查看此博客文章系列：http: [//community.marklogic.com/blog/document-formats-part1](http://community.marklogic.com/blog/document-formats-part1)

# mysql - SQL 计数和分组

> ID：10936496
> 
> 赞同：2
> 
> 时间：2012-06-07T17:06:13.980
> 
> 标签：mysql, sql

好的，我正在使用嵌套的 SQL 语句：

我想查询我们的销售人员最近写的 120 条提案。我正在使用嵌套查询从系统中获取最后 120 个提案，然后根据状态等过滤它们......

我遇到的问题是如何获得每个推销员的提案数量？

SQL 显然是错误的，但这就是我卡住的地方。

```
SELECT 
   CASE userId 
    WHEN '4' THEN 'AT'
    WHEN '3' THEN 'EO'
    WHEN '11' THEN 'CT'
    WHEN '13' THEN 'MH'
    ELSE userId
END AS Salesman,
SUM(contractAmt) as 'Contract Total',
AVG(DATEDIFF(contractDate, proposalDate)) AS averageDays,
SUM(proposalAmt) as pTot,
Count(*) as Contracts,
Count(A.proposalAmt) as Proposals,
(SUM(contractAmt) / SUM(proposalAmt)) AS 'Hit Rate $s',
(Count(*) / Count(A.proposalAmt)) AS 'Hit Rate #s'
FROM
( /* Get the last 120 proposals not in Lead or Proposal status*/
SELECT contractAmt, proposalAmt, contractDate, status, userId, 
    CASE WHEN proposalDate = '0000-00-00'   
        THEN CAST(contractDate as Date)
        else CAST(proposalDate as Date)
    END as proposalDate
FROM project
WHERE (status != 'proposal' and status != 'lead')
/*GROUP BY id*/
ORDER BY contractDate DESC
LIMIT 0, 120) A
WHERE status = 'contract' or status = 'complete'
GROUP BY userId 
```

“Count(A.proposalAmt) as Proposals”，这给了我过滤后的记录数。（仅限合同和已完成的订单）

在嵌套位中，查询不希望返回包含 100 条单独记录的单行计数。如果我按 userId 分组，我会按用户获得提案计数，但现在我没有单独的记录供以后过滤。

我可以想到几种方法来解决这个问题，但它们都很糟糕。我可以只做另一个查询，但这很不雅，而且我的输出效果不佳。

数据库是MySql。

如果我没有正确解释它的工作流程：

```
For each user ID
Get the last 100 proposals
Count # of proposals by salesman
Total proposal $ amount by salesman
Count # of contract or complete proposals
Total $ amount of contract and complete jobs
# proposals / # contracts = Hit Rate #'s
$ proposals / $ contracts = Hit Rate $'s
AVERAGE(contract date - proposal date) = Average # days in process 
```

输出应类似于：

> ```
>  Salesman  Avg Days  ProposalTot  ContractTot  HR $'s  Prop #  Con #  HR#'s
>    --------------------------------------------------------------------------------------
>    EO       |   29.27 |  $30,000  |    $15,000  |  50%  |   30  |   15 | 50% 
> ```

编辑：添加架构

```
Table project
=============
id, userId, clientId, contactId, projectName, status, description, creationDate, shipDate, estimateAmt, leadAmt, reestimateAmt, proposalAmt, contractAmt, completeAmt, type, subType, estDate, reestDate, proposalDate, contractDate, completeDate, lostDate, onHoldDate, estShip, reestShip, proposalShip, contractShip, completeShip, casperLink, statusChangeTS
-------------
id               int(11) PK
userId           int(11)
clientId         int(11)
contactId        int(11)
projectName      varchar(255)
status           enum('lead','proposal','contract','complete','onHold','lost')
description      text
creationDate     date
shipDate         date
estimateAmt      int(11)
leadAmt          int(11)
reestimateAmt    int(11)
proposalAmt      int(11)
contractAmt      int(11)
completeAmt      int(11)
type             varchar(100)
subType          varchar(100)
estDate          date
reestDate        date
proposalDate     date
contractDate     date
completeDate     date
lostDate         date
onHoldDate       date
estShip          date
reestShip        date
proposalShip     date
contractShip     date
completeShip     date
casperLink       varchar(20)
statusChangeTS   date 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T20:58:29.567

试试这个：

```
SELECT 
    Count(*) as 'Total Proposals',
    SUM(CASE WHEN status = 'complete' or status = 'contract' THEN 1 ELSE 0 END) as 'Total Contracts',
    CASE userId 
        WHEN '4' THEN 'AT'
        WHEN '3' THEN 'EO'
        WHEN '11' THEN 'CT'
        WHEN '13' THEN 'MH'
        ELSE userId
    END AS Salesman,
    SUM(CASE WHEN status = 'complete' or status = 'contract' THEN contractAmt ELSE 0 END) as 'Contract Total',
    AVG(DATEDIFF(contractDate, proposalDate)) AS averageDays,
    SUM(proposalAmt) as pTot,
    (SUM(CASE WHEN status = 'complete' or status = 'contract' THEN contractAmt ELSE 0 END) / SUM(proposalAmt)) AS 'Hit Rate $s',
    (SUM(CASE WHEN status = 'complete' or status = 'contract' THEN 1 ELSE 0 END) / Count(*)) AS 'Hit Rate #s'
FROM
    (/* This inner loop only selects the top 100 records */
    select * FROM project
    WHERE (status != 'proposal' and status != 'lead') and userId = '13'
    order by contractDate DESC
    LIMIT 0, 30) A
GROUP BY userId 
```

我能够设计的答案是不使用 WHERE 子句进行过滤，而是使用 CASE 子句过滤具有合同的记录。您需要在需要合同总额的地方执行此操作，并且您必须将合同金额过滤到仅具有您的状态的那些。（除非你的数据库已经处理好了。）

```
提案总数 | 合同总数 | 推销员 | 合同总额 | 平均天数 | pTot | 命中率 $s | 命中率#s
30 15 MH 160496 46.8 324122 0.4952 0.5

```

# vb.net - 使用 Linq 和多个条件过滤集合

> ID：10936497
> 
> 赞同：1
> 
> 时间：2012-06-07T17:06:17.663
> 
> 标签：vb.net, linq

在我看来，有一个数据表包含`ServerRow`4 个文本框（主机名、操作系统、位置、区域）的集合。当用户输入 4 个框中的任何一个时，我想立即过滤此列表。我有这个代码设置，并准备在我调用过滤器方法的每个文本框属性的 set 方法上进行。

现在问题来了：如果我有 4 个标准，这意味着我有 4 个不同场景的 2 次方。我想做的是编写一个处理所有这些场景的 linq 语句，这样如果有任何属性，`NullOrEmpty`它们将不会在`Where`子句中使用，另一方面，如果有值，则将搜索相应的字段带一个`Contains`。

例子

```
AvailableCis = New ObservableCollection(Of ServerRow)
                (_CiData.Where(Function(ci) ci.OS.ToUpper
                .Equals(_selectedOS.ToUpper) AndAlso 
                ci.HostName.ToUpper.Contains(_ciNameFilterText.ToUpper))
                .OrderBy(Function(a) a.CiName)) 
```

此示例显示了它如何与 2 个条件一起工作，并且设置了这两个条件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:23:02.270

您可以使用惰性评估来解决此问题 -

```
String.IsNullOrEmpty(ci.OS) OrElse ci.OS.ToUpper.Equals(_selectedOS.ToUpper) 
```

这样，如果字符串为 null 或为空，则不会评估第二个子句并接受所有 ServerRows。

另外不要忘记 AndAlso 的优先级高于 OrElse，因此每个子句都必须用括号括起来。

# perl - perl 如何发送 SMTP 邮件

> ID：10936501
> 
> 赞同：2
> 
> 时间：2012-06-07T17:06:26.460
> 
> 标签：perl, smtp

以下是我写的从我的邮件主机向我的个人电子邮件地址发送电子邮件的内容以及我收到的错误。

有人可以帮我解释为什么我们会收到错误：

> 无法在 cmm_ping.pl 第 2 行的未定义值上调用方法“mail”。

```
use Net::SMTP;
$smtp->mail("jo-sched@abcd.com");
$smtp->recipient("Myname@XXX-XXXX.com");
$smtp->datasend("From: jo-sched@abcd.com");
$smtp->datasend("To: Myname@xxxx-xxxxxx.com");
$smtp->datasend("Subject: This is a test");
$smtp->datasend("\n");
$smtp->datasend("This is a test");
$smtp->dataend;
$smtp->quit; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:10:44.913

该变量`$smtp`尚未定义。看一下[Net::SMTP 的使用示例](http://perldoc.perl.org/Net/SMTP.html#EXAMPLES)。这个例子几乎可以完成您的代码应该做的事情：

```
use Net::SMTP;

$smtp = Net::SMTP->new('mailhost');

$smtp->mail($ENV{USER});
$smtp->to('postmaster');

$smtp->data();
$smtp->datasend("To: postmaster\n");
$smtp->datasend("\n");
$smtp->datasend("A simple test message\n");
$smtp->dataend();

$smtp->quit; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-07T18:26:55.010

你熟悉面向对象的 Perl 是如何工作的吗？

为了使用面向对象的 Perl 模块，您必须首先创建该类类型的对象。通常，这是通过以下`new`方法完成的：

```
my $smtp = Net::SMTP->new($mailhost); 
```

现在，是class`$smtp`的一个*对象*`Net::SMTP`。基本上，它是对 glob 的引用，您可以在其中存储数据结构（您发送给谁、您的消息等）。然后 Perl 可以在方法调用期间使用这些信息（它们只是作为包 Net::SMTP 的一部分的子例程）。

这是我编写的程序中的一个示例：

```
use Net::SMTP;

my $smtp = Net::SMTP->new(
    Host  => $watch->Smtp_Host,
    Debug => $debug_level,
);

if ( not defined $smtp ) {
    croak qq(Unable to connect to mailhost "@{[$watch->Smtp_Host]}");
}

if ($smtp_user) {
    $smtp->auth( $watch->Smtp_User, $watch->Smtp_Password )
        or croak
        qq(Unable to connect to mailhost "@{[$watch->Smtp_Host]}")
        . qq( as user "@{[$watch->Smtp_User]}");
}

if ( not $smtp->mail( $watch->Sender ) ) {
    carp qq(Cannot send as user "@{[$watch->Sender]}")
        . qq( on mailhost "@{[$watch->Smtp_Host]}");
    next;
}
if ( not $smtp->to($email) ) {
    $smtp->reset;
    next;    #Can't send email to this address. Skip it
}

#
# Prepare Message
#
# In Net::SMTP, the Subject and the To fields are actually part
# of the message with a separate blank line separating the
# actual message from the header.
#
my $message = $watch->Munge_Message( $watcher, $email );
my $subject =
    $watch->Munge_Message( $watcher, $email, $watch->Subject );

$message = "To: $email\n" . "Subject: $subject\n\n" . $message;

$smtp->data;
$smtp->datasend("$message");
$smtp->dataend;
$smtp->quit; 
```

# java - 如何将自定义类型作为输入参数放入可调用语句中

> ID：10936514
> 
> 赞同：3
> 
> 时间：2012-06-07T17:07:04.777
> 
> 标签：java, oracle, jdbc, plsql

我需要对记录表使用可调用语句。我知道如何传递字符串、int 等参数。你可以写

```
callableStatement.setString(1, variable);
callableStatement.setInt(2, variable); 
```

但是如何为自定义类型记录列表执行此操作？我可以考虑创建一个`struct`并以某种方式发送它，但我不知道该怎么做。

这是我要使用的自定义表格和程序

```
type transaction is record(
     trans_id   varchar2(20)
    ,issuer_name varchar2(300)
    ,location_name varchar2(300)
    ,trans_date    date
    ,issue_date      date);
  type transaction_list is table of transaction;

  procedure set_transaction
  (
    caller_id     in varchar2
   ,trans_list   in transaction_list
   ,return_code out varchar2
  ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T18:43:35.860

您可以将[callableStatement.setObject](http://docs.oracle.com/javase/6/docs/api/java/sql/CallableStatement.html#setObject%28java.lang.String,%20java.lang.Object%29)与[Struct](http://docs.oracle.com/javase/6/docs/api/java/sql/Struct.html)类型一起使用。

可以`_demoInsertUsingCallableStmt`在此页面中的方法中找到一个很好的示例： [StructInsertExample](http://www.javadocexamples.com/java_source/__/st/StructInsertExample.java.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T19:19:07.570

您不能将记录定义为类型。您可以改用 OBJECT ：

```
CREATE OR REPLACE TYPE MY_TEST_REC AS OBJECT (
 id_ varchar2(30),
 name_ varchar2(30)
);

CREATE TABLE MY_TEST OF MY_TEST_REC;

create or replace package my_p is
  procedure proc(arg_  IN OUT MY_TEST_REC);
END;

create or replace package body my_p is
  procedure proc(arg_  IN OUT MY_TEST_REC)
  IS  
  BEGIN
    arg_.name_ := 'BAR';
  END;
END; 
```

然后将可调用语句中的对象绑定到 Struct。

# ruby-on-rails - Rails3.2 - 如何自定义设计以在用户注册时生成随机密码？

> ID：10936518
> 
> 赞同：4
> 
> 时间：2012-06-07T17:07:17.380
> 
> 标签：ruby-on-rails, devise

我正在尝试自定义设计注册过程以生成随机密码并将其与确认邮件一起发送。

我已经做的是覆盖默认设计的 :validtable 并在需要时生成一个新的随机密码。

```
 before_validation :password_generation

  def password_generation
       password_confirmation = password = Devise.friendly_token.first(7) if password.nil? || password.blank?
  end 
```

现在我的问题是在原始确认邮件中包含新生成的随机密码。

在定制它的新用户流程时是否有可能跟上 Devise 的原始可用性，或者我应该从头开始构建身份验证流程？

谢谢，哈达尔。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T19:57:43.590

（四个月太晚了，但也许其他人可以使用这个）

大多数情况下，您需要做的是将默认的 Devise 邮件程序和视图复制到您的项目中，并`config/initializers/devise.rb`在`config.mailer`. 此时，您可以根据需要自定义电子邮件。（请注意，Devise 使用该术语`resource`作为抽象，但大多数情况下它表示 User 的实例）。

唯一的诀窍是找到一种方法来记住在创建新用户帐户和生成和发送电子邮件之间生成的密码。当保存用户记录时，Devise 将存储的是密码的加密版本。我必须遵循设计中的逻辑路径才能确定，但​​我敢打赌你可以将它存储在用户的实例变量中，也许是参数或闪存。对此要非常小心；你希望这个值尽可能短——大概只是请求的生命周期。

# jquery - ajax 转换器和 IE7

> ID：10936525
> 
> 赞同：2
> 
> 时间：2012-06-07T17:07:53.530
> 
> 标签：jquery, ajax, json, parsing, converters

在我的 ajax 响应中使用[无法解析的内容。](https://stackoverflow.com/questions/3146798/why-do-people-put-code-like-throw-1-dont-be-evil-and-for-in-front-of)

效果很好，除了 IE7 会引发失败。关于为什么失败的任何想法？

阿贾克斯调用：

```
$.ajax({
        type: "POST",
         url: "js/zipcodeLookup.json", //mock json response
         contentType: "application/json",  
        dataType:"text json",
        data: "{postalcode: '" + $(myField).val() + "', country: '" + myCountry + "'}",
        success: function(data) {
            //do something here

        },
        error: function(){
        alert('failure');
      }

     }); 
```

ajax转换器：

```
 $.ajaxSetup({ 
            converters: { "text json": function (stringData) { 
                        return JSON.parse(stringData.replace('for(;;);', '')); 
            } } 
}); 
```

和json：

```
for(;;);{
    "isError": "false",
    "city": "Springfield",
    "juris": "IL"
} 
```

***编辑***

正确的答案是我愚蠢地忽略了我的解析方法 -`jQuery.parseJSON()`改用！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:10:39.833

IE < 8 没有对`JSON`. 你有 IE7 的后备机制吗？

对于没有原生 JSON 支持的浏览器，你应该使用[这个](https://github.com/douglascrockford/JSON-js)库

您可以实现这样的后备机制

```
<script>window.JSON|| 
    document.write("<script src='js/json2.js'>\x3C/script>")
</script> 
```

# php - 在 WordPress 页面上显示特定帖子

> ID：10936526
> 
> 赞同：1
> 
> 时间：2012-06-07T17:07:53.800
> 
> 标签：php, wordpress-theming, wordpress

在网站上，每个产品都是一个帖子，但是当我们添加新产品时，我们想要一个类似时事通讯的东西，主要是一个帖子，所以在主页的侧边栏中，您可以看到当月的新产品或事件。

我正在使用页面，因为我不想在每个新的时事通讯上重新发布产品，所以我想在页面内显示帖子。

在产品页面中，我将每个产品按类别和子类别分开，但由于我想将特定帖子分组以将它们发布在侧边栏上，我认为页面是最好的方法。

**现在我正在使用这段代码：**

```
<?php
$productos = new WP_Query(array(
'post__in'=> array(81, 83),
'orderby'=>'title',
'order'=>'ASC'
)
); if ($productos->have_posts()) : while ($productos->have_posts()) : $productos->the_post();
?> 
```

它显示 id 为 81 和 83 的帖子，我想使用 'name' 来显示 slug 的帖子，因为法典说需要一些时间来检查新帖子的 id，而不是使用名称每个新产品，但它不能在数组中工作，或者我做错了什么。

现在我会喜欢做这样的工作

```
$names = get_post_meta($post->ID, "names", $single = true); 

$productos = new WP_Query(array(
'name'=> array($names),
'orderby'=>'title',
'order'=>'ASC'
)
); 
```

因此，每次我发布一个新页面时，我都会在自定义字段中写下我想要包含在页面中的帖子的 slug，正如你所看到的，我对 php 不是很好，但我试图学习并搜索很多东西在在这里问之前可以工作。

我尝试了 ggis 内联帖子插件，虽然它可以工作，但我需要我想要包含的每个帖子的 id，我需要编辑插件，因为我希望帖子输出中的顺序不同，这就是我不喜欢的原因很大程度上依赖于插件。

**更新：**

所以我现在正在寻找是否可以使用简码来制作它，现在我有这个：

```
function producto_func($atts) {
    extract(shortcode_atts(array(
        'nombre' => ''
    ), $atts));
    global $post;
    $pieza = get_page_by_title($nombre,OBJECT, 'post');
                echo '<h1>'. $pieza->ID . '</h1>';
}
add_shortcode('producto', 'producto_func');
enter code here 
```

所以我只需`[producto nombre="ff 244"]`在页面中输入简码并显示其 ID，我可以根据需要的帖子数量添加任意数量的简码。但是我怎样才能显示帖子的全部内容。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T20:29:26.367

来自[Wordpress 法典](http://codex.wordpress.org/Class_Reference/WP_Query#Post_.26_Page_Parameters)：

按 slug显示**帖子：**

> $query = new WP_Query('name=about-my-life');

按 slug显示**页面：**

> $query = new WP_Query('pagename=contact');

**更新**

尝试改变这个：

```
'name'=> array($names), 
```

对此：

```
'name'=> $names, 
```

'name' - 和 'pagename' - 参数不包含在数组中。只有一个字符串。一个逗号分隔的列表应该在您的自定义字段中为您提供您需要的标题为“名称”的内容，尽管我还没有测试过这种方法。

另外，感谢您使用 WP_Query 而不是 query_posts。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T03:18:57.500

我找到了使用简码的解决方案。所以我把它放在我的functions.php页面上

```
function productos($atts, $content = null) {
    extract(shortcode_atts(array(
        "slug" => '',
        "query" => ''
    ), $atts));
    global $wp_query,$post;
    $temp = $wp_query;
    $wp_query= null;
    $wp_query = new WP_Query(array( 
    'name'=> $slug,
    ));
    if(!empty($slug)){
        $query .= '&name='.$slug;
    }
    if(!empty($query)){
        $query .= $query;
    }
    $wp_query->query($query);
    ob_start();
    ?>
    <?php while ($wp_query->have_posts()) : $wp_query->the_post(); ?>
        <h1><a href="<?php the_permalink() ?>" rel="bookmark"><?php the_title(); ?></a></h1>
        <div><?php the_content() ?></div>
    <?php endwhile; ?>

    <?php $wp_query = null; $wp_query = $temp;
    $content = ob_get_contents();
    ob_end_clean();
    return $content;
}
add_shortcode("producto", "productos"); 
```

在我的页面模板中，我只写 [producto slug="MY-SLUG"]，这样我就可以只用 slug 显示多个帖子。希望有人觉得这很有用。

# knockout.js - 如何验证数组？

> ID：10936527
> 
> 赞同：8
> 
> 时间：2012-06-07T17:07:54.947
> 
> 标签：knockout.js, knockout-2.0, knockout-validation

我正在尝试使用[淘汰赛验证库](https://github.com/ericmbarnard/Knockout-Validation)来验证对象数组。对我来说，如何为一组可观察对象形成一个验证组并不简单。我设法使它工作的唯一方法是这样的（[包括 JSFIDDLE](http://jsfiddle.net/KHFn8/332/)）：

```
var Note = function () {
    var self = this;
    self.name = ko.observable().extend({ required: true });
};

var viewModel = function() {
    var self = this;

    self.notes = ko.observableArray([new Note(), new Note()]);

    self.validatedObservables = function() {
        var arr = [];
        ko.utils.arrayForEach(self.notes(), function(note) {
            arr.push(note.name);
        });
        return arr;
    };

    self.errors = ko.validation.group(self.validatedObservables());

    self.submit = function () {
        if (self.errors().length != 0) {
            self.errors.showAllMessages();
        }
    };

};

ko.applyBindings(new viewModel()); 
```

看来我的方法是不必要的冗长。根据源代码，您可以简单地将 observable 传递给 ko.validation.group：

```
self.errors = ko.validation.group(self.notes()); 
```

但这不起作用。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-07T19:27:43.947

分组深度（递归）有一个配置选项。它可以在全局范围内设置，也可以`ko.validation.init( { grouping: { deep: true } } )` 在`group`调用本身中设置，例如：`self.errors = ko.validation.group( self.notes(), {deep: true} );`

在这里更新小提琴：http: [//jsfiddle.net/KHFn8/4116/](http://jsfiddle.net/KHFn8/4116/)

顺便说一句，你这样做的方式可以写成更短的形式：

```
self.errors = ko.validation.group(
    ko.utils.arrayMap(self.notes(), function(note) { return note.name })); 
```

**编辑**：我的小提琴不再适用于最新版本的 KO 验证。这是我给出答案时使用最新版本的相同小提琴（2012 年 6 月）：http: [//jsfiddle.net/KHFn8/4117/](http://jsfiddle.net/KHFn8/4117/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-05T13:44:58.750

我必须低声誉才能发表评论。所以这里有另一个答案。由 antishok seams 提供的小提琴的答案不再起作用。（到 knockout.js 的链接已损坏，但即使在修复该问题并添加了一个到 knockout 3.0 的有效链接后，它仍然无法正常工作）

我在 ko.validation.group() 周围添加了 ko.computed 并让它以这种方式工作。

```
self.errors = 
    ko.computed(function() {
        return ko.validation.group(self.notes(), { deep: true })}); 
```

[http://jsfiddle.net/bezFR/17/](http://jsfiddle.net/bezFR/17/)（更新）

我猜有更好的方法可以做到这一点，但现在它解决了我的问题，我期待得到纠正/看到更好的解决方案:)

# javascript - HTML5 → 动态关联的服务器发送事件

> ID：10936530
> 
> 赞同：1
> 
> 时间：2012-06-07T17:08:03.687
> 
> 标签：javascript, ajax, html, push, server-sent-events

我刚开始使用 SSE，想知道如何让它们变得更有活力。

我正在使用 Box 来选择用户以及与用户名相对应的图像和文本更改。现在我想通过 SSE 检查用户更新，并希望用户仍然可以选择。

我在更改框时尝试添加*eventSource*`<select>`：

```
function setSelected(elm) {
    selectedName = elm.options[elm.selectedIndex].innerHTML;

    var eSource = new EventSource("getState.php?passVar=" + selectedName);
    eSource.onmessage = function(event) {
        document.getElementById("stateText").innerHTML = event.data;
    };
} 
```

我怎样才能达到我的目标？

**编辑** 我现在已经成功添加了 eventSource（我的源本身有问题）。

但是当我现在添加另一个源时，我实际上有两个源在运行。我怎样才能删除旧的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:39:56.707

要删除以前的事件源，请使用[`close()`方法](https://developer.mozilla.org/en/Server-sent_events/EventSource#close%28%29)。您将不得不以`eSource`某种方式保留对周围的引用才能做到这一点。

# ruby - 在 Gemfile 中使用 git repo 时出现 Gem::LoadError

> ID：10936533
> 
> 赞同：1
> 
> 时间：2012-06-07T17:08:17.447
> 
> 标签：ruby, git, bundler

我分叉了 sinbook gem 并将 git repo 添加到我的 Gemfile 中。但是依赖于 sinbook的[sinatra-authentication gem 会抛出 Gem::LoadError。](https://github.com/maxjustus/sinatra-authentication)

为什么没有使用[我](https://github.com/JamesGecko/sinbook)的 gem 版本？

宝石文件

```
source :rubygems

gem 'sinatra'
gem 'sinatra-contrib'
gem 'sequel'

gem 'jruby-openssl'
gem 'rack-flash'
gem 'sinbook', git: 'https://github.com/JamesGecko/sinbook'
gem 'sinatra-authentication'

gem 'json-jruby'

gem 'coffee-script'
gem 'therubyrhino' 
```

错误

```
PS C:\users\james\code\portal> jruby -S bundle
Fetching gem metadata from http://rubygems.org/........
Fetching gem metadata from http://rubygems.org/..
Fetching https://github.com/JamesGecko/sinbook
Installing addressable (2.2.8)
Installing backports (2.5.1)
Installing bouncy-castle-java (1.5.0146.1)
Installing coffee-script-source (1.3.1)
Installing multi_json (1.2.0)
Installing execjs (1.3.0)
Installing coffee-script (2.2.0)
Installing dm-core (1.2.0)
Installing dm-migrations (1.2.0)
Installing dm-timestamps (1.2.0)
Installing dm-validations (1.2.0)
Installing eventmachine (0.12.10)
Installing jruby-openssl (0.7.7)
Installing json (1.5.0)
Installing json-jruby (1.5.0)
Installing rack (1.4.1)
Installing rack-flash (0.1.2)
Installing rack-protection (1.2.0)
Installing rack-test (0.6.1)
Installing rufus-tokyo (1.0.7)
Installing sequel (3.34.1)
Installing tilt (1.3.3)
Installing sinatra (1.3.2)
Using sinbook (0.1.9.jamesgecko) from https://github.com/JamesGecko/sinbook (at master)
Installing sinatra-authentication (0.4.1)
Installing sinatra-contrib (1.3.1)
Installing therubyrhino (1.73.2)
Using bundler (1.1.4)
Your bundle is complete! Use `bundle show [gemname]` to see where a bundled gem is installed.
PS C:\users\james\code\portal> jruby .\app.rb
Gem::LoadError: Could not find sinbook (>= 0) amongst [addressable-2.2.8, backports-2.5.1, bouncy-castle-java-1.5.0146.1, bundler-1.1.4, coffee-script-2.2.0, coffee-script-source-1.3.1, dm-core-1.2.0, dm-migrations-1.2.0, dm-timestamps-1.2.0, dm-validations-1.2.0, eventmachine-0.12.10-java, execjs-1.3.0, jruby-openssl-0.7.7, jruby-win32ole-0.8.5, json-1.5.0-java, json-jruby-1.5.0-java, multi_json-1.2.0, rack-1.4.1, rack-flash-0.1.2, rack-protection-1.2.0, rack-test-0.6.1, rake-0.9.2.2, rufus-tokyo-1.0.7, sequel-3.34.1, sinatra-1.3.2, sinatra-authentication-0.4.1, sinatra-contrib-1.3.1, therubyrhino-1.73.2, tilt-1.3.3]
               to_specs at c:/dev/jruby-1.7.0.preview1/lib/ruby/shared/rubygems/dependency.rb:247
  activate_dependencies at c:/dev/jruby-1.7.0.preview1/lib/ruby/shared/rubygems/specification.rb:777
                   each at org/jruby/RubyArray.java:1611
  activate_dependencies at c:/dev/jruby-1.7.0.preview1/lib/ruby/shared/rubygems/specification.rb:766
               activate at c:/dev/jruby-1.7.0.preview1/lib/ruby/shared/rubygems/specification.rb:750
           try_activate at c:/dev/jruby-1.7.0.preview1/lib/ruby/shared/rubygems.rb:212
                require at c:/dev/jruby-1.7.0.preview1/lib/ruby/shared/rubygems/custom_require.rb:59
                require at c:/dev/jruby-1.7.0.preview1/lib/ruby/shared/rubygems/custom_require.rb:55
                 (root) at .\app.rb:7 
```

应用程序.rb

```
require 'sinatra'
require 'sinatra/reloader'
require 'json'

require 'digest/sha1'
require 'rack-flash'
require 'sinatra-authentication'

use Rack::Session::Cookie, secret: 'foobar'
use Rack::Flash

# ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T13:26:53.073

添加`require "bundler/setup"`到 app.rb。它需要加载捆绑的环境。更多信息可以在[捆绑器文档](http://gembundler.com/bundler_setup.html)中找到。

由于您使用的是 Sinatra，因此您可能还想研究[使用 config.ru](http://gembundler.com/sinatra.html)。

# javascript - 无法在不刷新的情况下运行多个 AJAX 调用

> ID：10936535
> 
> 赞同：-5
> 
> 时间：2012-06-07T17:08:43.623
> 
> 标签：javascript, ajax

我有一个包含文本字段和按钮的表单。当我开始输入时，它会显示来自我的数据库的提示，并在单击按钮或按 Enter 键时显示搜索结果。AJAX 用于提示和搜索结果，并且运行良好。

问题是它只在页面加载后第一次起作用。如果我想再次搜索，它不会响应。它只是显示以前的搜索结果，直到页面刷新，但该`showhint()`功能运行良好。

```
<input type="text" id="txt"  onkeyup="showhint(this.value)"/>
<input type="button" value="search" onclick="searchresult()"/> 
```

AJAX 函数：

```
function searchresult() {
    var key = document.getElementById("txt").value;
    var xmlhttp;

    if(window.XMLHttpRequest) {
        xmlhttp = new XMLHttpRequest();
    } else {
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }

    xmlhttp.onreadystatechange = function() {
        if(xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            document.getElementById("mid").innerHTML = xmlhttp.responseText;
        }
    };

    xmlhttp.open("GET","keyprocess.php?q=" + key, true);
    xmlhttp.send();
} 
```

问题是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T18:03:25.070

我**猜**它第一次或刷新时工作的原因是因为事件处理程序没有在 ajax 请求之间持续存在。我会研究 jQuery，因为它有助于缓解此类问题。

对于 jquery < 1.7 版[.delegate()](http://api.jquery.com/delegate/)方法执行以下操作

> 根据一组特定的根元素，将处理程序附加到现在或将来与选择器匹配的所有元素的一个或多个事件。

1.7 之后的任何内容都应该使用[.on()](http://api.jquery.com/on/)方法。

基本上，如果页面上的元素从 ajax 请求发生变化，.delegate() 或 .on() 方法仍然允许处理事件。

更新：

```
//This needs to be within the $(document).ready function
//Attach an event handler to the ID called txt that fires on changes
$("body").on("change", "#txt", function(event){
    //get the value from the input
    var $val = $(this).val();

    //Send the $val to keyprocess.php via ajax call

    //Output Results

}); 
```

# ms-access - 如何在 MS Access 中保存计算值

> ID：10936536
> 
> 赞同：1
> 
> 时间：2012-06-07T17:08:46.930
> 
> 标签：ms-access, vba, ms-access-2003

我有一个我创建的表单中的文本框。

我想在文本框的 Control Source 属性中添加一个表达式。我还想使用文本框的控制源属性将文本框绑定到表中的字段。

有什么方法可以在特定文本框的控件源属性中添加字段名称和表达式？

该表达式基本上将几个数字相加并在该文本框中显示输出。我希望将输出存储在表中的一个字段中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:50:04.820

如果您有一个名为的文本框`txtMy_field`，它绑定到`My_field`表单记录源中命名的字段，则可以使用表单的 on current 事件将其他两个数字的总和加载到`txtMy_field`.

如果您不想覆盖存储在`My_field`...中的现有值

```
If IsNull(Me.txtMy_field) = True Then
    Me.txtMy_field = Number1 + Number2
End If 
```

如果您确实想覆盖存储在 中的现有值`My_field`，请消除该`IsNull()`条件。

```
Me.txtMy_field = Number1 + Number2 
```

如果`Number1`并且`Number2`来自表单上的其他控件，您还可以使用它们的更新后事件来`txtMy_field`按需更新值。

但是，我不确定我对您的问题的理解程度。这些只是一般性建议，我希望它们能给你一些有用的东西。顺便说一句，如果这两个数字来自两种不同的形式（如您之前的问题之一）并且您打算通过第三种形式显示和存储它们的总和，那么这可能比从这个问题中出现的更具挑战性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T13:05:24.747

You could link the text box to the table control source and then set the value of the text box to the result of the expression in the AfterUpdate property on the two objects the contain the values you want to add.

For example

```
me.textbox.value= int1 + int2 
```

This value should then be written to the table.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-07-03T12:53:09.157

If you have textboxes with names `text1` and `text2` and you will save your answer in `text3` you should give this code in `text3` properties Control Source:

```
=Val([text1])+Val([text2]) 
```

# macos - 界面生成器：10.7 之前的 Mac OS X 版本上的属性不可用标识符

> ID：10936539
> 
> 赞同：0
> 
> 时间：2012-06-07T17:09:08.107
> 
> 标签：macos, interface-builder

开发环境：OS X 10.7、Xcode 4.3.1 部署版本：10.6

界面生成器给了我警告：“10.7 之前的 Mac OS X 版本上的属性不可用标识符”

我如何找出它在抱怨什么？或者，我该如何解决这个问题？明显的点击并不会消除警告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-19T23:23:36.603

您提供了一个标识符，但您的目标是在引入标识符属性之前的操作系统版本。将您的部署目标提高到 10.7（或更高版本），或者取出对象的标识符。

在问题导航器中选择警告应该（IIRC）选择拥有不受支持的属性的对象。

# jquery - how do I get a js/jq object to print into google console? code included

> ID：10936542
> 
> 赞同：0
> 
> 时间：2012-06-07T17:09:16.730
> 
> 标签：jquery, google-chrome, logging, console, jquery-validate

I'm attempting to write some jquery from the first time and I'm using the validatation plugin.

as you can see in my code, i just want to print out the value of the Date object.

```
$.validator.addMethod(
        "testDate",
        function(value, element)
        {
            var currentDate = new Date();
            var dateObj = new Date(value);
            if(element == "dob")
            {
                if(dateObj > currentDate)
                {
                    console.log(currentDate);
                    console.log(dateObj);
                    return false;
                }
            }
            else if(element == "scheduledExamDate")
            {
                if((dateObj.getFullYear() > currentDate.getFullYear()+1)||(dateObj.getTime() < currentDate.getTime()))
                {
                    return false;
                }
            }
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:12:55.310

Use `Date.toString()` (like: `console.log(currentDate.toString())`)

[See this article on MDN](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date/toString).

# c# - 无法打开数据库连接

> ID：10936552
> 
> 赞同：1
> 
> 时间：2012-06-07T17:09:57.977
> 
> 标签：c#, ado.net

我创建了一个 C# 控制台应用程序，并且需要访问我的数据库。

```
var connectionString = "Data Source=MyServer;Integrated Security=True;Initial Catalog=MyDB;";

using (var connection = new SqlConnection(connectionString))
{
    connection.Open();
} 
```

给出了`.Open()`一个例外：

> “无法打开登录请求的数据库“MyDB”。登录失败。”

你能帮我解决这个问题吗？我应该给我的申请一些许可吗？我如何在 Windows 7 上做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:12:43.470

您应该尝试在连接字符串中指定用户和密码。

```
var connectionString = "Data Source=MyServer;Integrated Security=True;Initial Catalog=MyDB;user=you;password=password;"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:14:59.850

如果您使用的是 Windows 身份验证，则不需要用户名和密码（您登录到 Windows 就足够了，假设它对数据库具有权限）。否则，您将需要数据库的用户名和密码。

另外，我不确定这是否重要，但是当您遇到权限问题时，以管理员身份运行您的应用程序总是一个好主意。

# facebook - 有没有办法在身份验证对话框中不显示使用应用程序的朋友？

> ID：10936553
> 
> 赞同：1
> 
> 时间：2012-06-07T17:10:04.163
> 
> 标签：facebook, privacy, facebook-authentication

我创建了一个强调隐私的 Facebook 应用程序......有没有办法在您批准权限时不显示您的哪些朋友正在使用该应用程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:14:56.153

不，这不是身份验证对话框的选项，这就是它查找所有应用程序的方式。

用户会根据他们的隐私设置显示在那里，因此即使您的朋友已经在使用该应用程序，也可能没有人显示在那里。

如果您不希望在那里显示任何内容，您可以将应用的默认隐私设置设置为“仅限我”，除非用户更改此设置，否则当他们的朋友看到​​对话框时，他们将无法显示在那里

# c++ - 相同的代码，在 Windows 和 Linux 上的不同行为

> ID：10936554
> 
> 赞同：0
> 
> 时间：2012-06-07T17:10:08.640
> 
> 标签：c++, windows, linux

我知道下面的代码是不正确的，因为我正在为任意地址赋值。

```
#include <iostream>

using namespace std;

int main()
{
int *i;
*i = 12;     // Not right.... i is not initialized.
cout << *i << endl;
return 0;
} 
```

这段代码在 Linux 上给出了分段错误。但是，在 Windows 上它输出 12...

为什么它可以在 Windows 上运行？我不是将 12 分配给我的程序没有特权的任意位置吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-07T17:11:09.630

它实际上调用了未定义的行为。所以这两种行为都是正确的，即它可能会给出段错误，也可能不会。

下次运行时，Windows 版可能会崩溃，Linux 版可能会向您发送威胁邮件！

换句话说，任何事情都可能发生。C++ 规范和（符合标准的）编译器都没有提供任何保证，这就是 C++ 规范将这种行为称为*未定义行为*的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T17:22:20.070

因为*恰好*`i`在入栈位置的随机数据在Linux下*恰好*形成了不可写地址，而在Windows下*恰好*包含了可写地址。

但是请注意，您无法确定代码对 Windows 的其他影响。*可能*是，如果您碰巧在 13 日星期五下午 6:16 开始该程序，那么该地址*恰好*是存储“输出”的系统调用号的地址，并且可能*恰好*是`12`对“删除文件”，这可能*会*删除您拥有的最重要的文件。是的，这是极不可能的，但并非完全不可能（如果您使用特定编译器设置使用特定编译器的特定版本编译它，它可能只会发生）。

或者简而言之，没有人可以确切地告诉您运行此代码时会发生什么（请注意，即使在 Linux 下，如果您更改编译器选项、编译器版本或碰巧使用命令行参数调用它，行为也可能会有所不同...... )

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T17:31:46.527

@Nawaz 和 @celtschk 是对的。您的代码确实调用了未定义的行为，因此这两种行为都是正确的。不过，您看到这种特殊的未定义行为是有原因的。原因值得理解。

当操作系统在运行时加载程序时，它会为它打开一个*虚拟地址空间。* 在 64 位系统上，虚拟空间从地址 0 延伸到地址 0xffffffffffffffff。

您的系统自然只有一小部分实际物理内存，它需要填充如此巨大的地址空间。此外，您的系统必须在可能同时运行的几个不同进程之间共享它所拥有的内存——每个进程都有自己的私有虚拟地址空间。

所以这就是系统的作用。它最初为您新加载的程序分配一小块内存——可能是 4 kiB——并将其映射到地址空间的一小段，如 0xffffffffffffff000 到 0xffffffffffffffff。你的程序在这个空间中构建了*一堆*存储的数据对象。如果堆栈增长超过 4 kiB，系统将分配另一个 4 kiB，从 0xffffffffffffe000 到 0xffffffffffffefff，并且将以对正在运行的程序透明的方式进行分配。

只要程序以一种有序的、规定的方式构建和使用它的堆栈，它就好像它不知道对其堆栈大小的任何限制一样运行。但是，如果程序以无序的方式访问内存，那么结果取决于几个因素，但如果访问的是系统从未分配过程序实际内存的地址，肯定会引发系统异常利用。

现在，这个答案遗漏了很多细节。您可能知道还有第二种内存，即*堆*或*动态内存池。* 还有其他因素，包括“磁盘交换”。但是，如果指针`i`碰巧指向程序已经出于某种目的使用的内存，则不会引发系统异常。它指向这样的记忆吗？很难说。显然，在您的情况下，它似乎在一个系统上这样做，但在另一个系统上却没有。

顺便说一句，我与@celtschk 在一点上略有不同。现代 CPU 和操作系统是专门为防止系统灾难而构建的，就像他所说的那样。*C 和 C++ 标准*不保证不会发生此类灾难，但操作系统会保证，除非程序以超级用户权限运行（即使这样，也可能存在部分有效的保护措施）。我认为您不必担心使用普通的用户模式程序无意中擦除磁盘。不过，在嵌入式系统上，这是另一回事，@celtschk 是完全正确的。

# android - 从 ImageView 获取裁剪的图像

> ID：10936555
> 
> 赞同：4
> 
> 时间：2012-06-07T17:10:08.777
> 
> 标签：android, imageview, crop

我使用 ImageView 裁剪位图。裁剪后，我想获得裁剪后的图像，但得到的图像与原始图像相同。有没有办法只获取图像的可见部分？

```
ImageView iv = new  ImageView(this);                        
iv.setImageBitmap(OriginalBitmap);
iv.setScaleType(ScaleType.CENTER_CROP);
Bitmap CroppedBitmap = ((BitmapDrawable) iv.getDrawable()).getBitmap(); 
```

CroppedBitmap 的值与 OriginalBitmap 相同。我怎样才能得到裁剪的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-24T08:31:06.537

这个[例子](http://findnerd.com/list/view/How-to-GetCrop-the-visible-portion-of-ImageView-/2676/)对我有用 `iv.setDrawingCacheEnabled(true); Bitmap croppedBitmap = iv.getDrawingCache()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:16:47.710

以下代码用于裁剪图像 200x200

```
Bitmap bitmapOrg = BitmapFactory.decodeResource(getResources(), 
           R.drawable.android);

    int width = bitmapOrg.width();
    int height = bitmapOrg.height();
    int newWidth = 200;
    int newHeight = 200;

    // calculate the scale - in this case = 0.4f
    float scaleWidth = ((float) newWidth) / width;
    float scaleHeight = ((float) newHeight) / height;

    // createa matrix for the manipulation
    Matrix matrix = new Matrix();
    // resize the bit map
    matrix.postScale(scaleWidth, scaleHeight);

    // recreate the new Bitmap
    Bitmap resizedBitmap = Bitmap.createBitmap(bitmapOrg, 0, 0, 
                      width, height, matrix, true); 

    // make a Drawable from Bitmap to allow to set the BitMap 
    // to the ImageView, ImageButton or what ever
    BitmapDrawable bmd = new BitmapDrawable(resizedBitmap);

    iv.setImageDrawable(bmd); 
```

# objective-c - OCMock valueForKey 因 NSPredicate 失败

> ID：10936557
> 
> 赞同：2
> 
> 时间：2012-06-07T17:10:23.603
> 
> 标签：objective-c, ocmock

在我正在测试的代码中，我有一个 NSPredicate 并且我正在过滤一个数组：

```
NSPredicate* predicate = [NSPredicate predicateWithFormat:@"status == %d || status == %d", FVFileReadyStatus, FVFileWaitingStatus];
[myArray filterUsingPredicate:predicate]; 
```

我有一个方法来返回一个模拟，最终将被添加到`myArray`. `FVFileStatus`是一个 typedef 枚举。因为我使用的是谓词，所以谓词是 call `valueForKey`，所以我需要把它存根：

```
-(id)mockFVFileHandleWithStatus:(FVFileStatus)status {
    id mock = [OCMockObject mockForClass:[FVFileHandle class]];
    [[[mock stub] andReturnValue:OCMOCK_VALUE(status)] valueForKey:[OCMArg checkWithSelector:@selector(isEqualToString:) onObject:@"status"]];
    return mock;
} 
```

当我运行我的测试时，它在过滤器上失败了。我得到一个`NSInvalidArgumentException - Reason: Return value does not match method signature`.

我不确定如何设置存根，以便它可以与 NSPredicate 一起使用。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-08T11:11:15.947

很接近。设置存根的正确方法如下：

```
[[[mock stub] andReturn:OCMOCK_VALUE(status)] valueForKey:[OCMArg checkWithSelector:@selector(isEqualToString:) onObject:@"status"]]; 
```

起初这似乎违反直觉，因为您尝试存根的属性是*int*类型，因此您希望必须使用**andReturnValue:**。

但是，在模拟对象上调用的实际方法不是**status**而是**valueForKey:**，后者的返回类型是*id*。因此，当使用**andReturnValue:**时，存根被设置为返回原始值，然后在被要求提供对象时报错。顺便说一句，错误消息可能更清楚，我会调查一下。

您仍然可以使用**OCMOCK_VALUE**宏来设置值对象，但是通过使用**andReturn:**您告诉存根返回该值对象，而不是包装在其中的原语，这与**valueForKey:** ' s 返回类型。

# android - Galaxy Tab II 上缺少 Android MotionEvent 数据

> ID：10936559
> 
> 赞同：4
> 
> 时间：2012-06-07T17:10:32.907
> 
> 标签：android, galaxy-tab

**背景：**

我正在 Android 上制作一个小测试应用程序，它只在屏幕上显示应用程序可以感知到的所有手指触摸屏幕的所有数据。它与[此](http://android-coding.blogspot.com/2012/04/detect-touch-event-part-iv-get-touch_12.html)类似，但适用于所有触摸，而不仅仅是一个。Android 触摸事件包含大量数据（根据[此文档](http://developer.android.com/reference/android/view/MotionEvent.html)），包括位置、方向、压力、大小和椭圆轴长度。

**问题：**

我的应用程序的每个 MotionEvent 都会收到针对每个指针索引 i 的 getSize(i)、getTouchMajor(i) 和 getTouchMinor(i) 的报告 0（零）。但它报告了合理的、非零的位置和压力​​值，所以有些东西工作正常。文档*似乎*暗示这意味着硬件不支持该信息，但我对此持怀疑态度，原因有两个。

1.  我正在测试的设备是 Galaxy Tab II，我认为它非常漂亮。（我在网上搜索了是否可以找到各种 Android 设备支持 MotionEvents 的功能列表，但没有找到这样的列表。）
2.  我使用 Java 方法 InputDevice.getMotionRanges() 来测试设备是否支持尺寸和主轴/次轴，这些结果表明设备*确实*支持这些轴（我得到的尺寸：0.0-1.0，主要/次要：0.0-1509.437每个）。

**问题：**

1.  我是否认为 Galaxy Tab II 支持 MotionEvent 的大小和长轴/短轴特性是正确的，如果是这样，为什么我不能从实际的 MotionEvents 中获取这些数据？（我的代码与上面链接的代码非常相似。）
2.  如果此平板电脑实际上不支持这些轴，您能否推荐我*可以*在上面执行此操作的 Android 平板电脑，它*会给*我 MotionEvent 大小和椭圆轴长度？

提前感谢您提供的任何帮助！

**编辑：**同事在 Galaxy Tab 上测试应用程序我得到了所有数据，没有丢失。设备之间是否存在一些配置/设置差异？Galaxy Tab 会从 I 降级到 II 似乎很奇怪……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-27T10:17:25.850

我在一个类似的问题上回答了这个问题。 [onTouch MoitonEvent getTouchMinor 和 getTouchMajor 总是得到完全相同的数字结果，为什么？](https://stackoverflow.com/questions/22032486/ontouch-moitonevent-gettouchminor-and-gettouchmajor-alwasys-the-exact-same-numbe/22065092#22065092)

在我们的发现中，我们没有发现任何设备可以为椭圆提供不同的主要和次要长度，或者可以提供这种椭圆的方向。

我们测试的大多数设备只给出了一个我们认为是对角线的值。

# ios - 可以从 UISearchBar 中删除背景或边框吗？

> ID：10936566
> 
> 赞同：5
> 
> 时间：2012-06-07T17:10:52.047
> 
> 标签：ios, ios5, uisearchbar

我想得到这样的东西：

![在此处输入图像描述](../Images/45fa706ff8675f11d5925afafde2b0da.png)

但我无法删除原始背景（我使用的是 iOS5）。然而，苹果似乎做到了：

![在此处输入图像描述](../Images/0d4dc9286c4f7b6bbfce7b0452ba6264.png)

我怎样才能创造出我想要的东西？或者，别无选择，我唯一的选择是自定义 UITextField？

感谢您的建议和想法！

编辑：第一次回复后，这就是我得到的：

![在此处输入图像描述](../Images/0850a2762dd11f31d1f9519ebba7082d.png)

有谁可以在不使所有组件半透明更改其 alpha 值的情况下删除白色内部背景？顺便说一句，我可以用黑色改变白色吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T19:51:48.803

试试这个代码，它对我有用

```
for (id img in yourSearchBar.subviews) {
        if ([img isKindOfClass:NSClassFromString(@"UISearchBarBackground")]) {
           [img removeFromSuperview];    
        }
    } 
```

在上面的代码中yourSearchBar是你要移除背景的搜索栏，for循环是搜索UISearchBar的背景图片

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-08T00:16:21.700

你真的应该使用外观协议。您可以为 UISearchBar 的单个实例更改它，

```
UIImage *searchBg = [UIImage imageNamed:@"search_bar.png"];
[searchBar setBackgroundImage:searchBg]; 
```

或者，如果您在不同场景中有多个搜索栏，这将为每个实例设置主题（但将其称为 AppDelegate 之类的合理位置，以确保在您看到其中任何一个之前正确设置所有栏。

```
UIImage *searchBg = [UIImage imageNamed:@"search_bar.png"];
[[UISearchBar appearance] setBackgroundImage:searchBg]; 
```

**更新：**好的，要更改搜索栏的背景，您应该使用以下方法之一，

searchBar 的单个实例：

```
[searchBar setSearchFieldBackgroundImage:searchBg forState:UIControlStateNormal]; 
```

UISearchBars 的所有实例：

```
[[UISearchBar appearance] setSearchFieldBackgroundImage:searchBg forState:UIControlStateNormal]; 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-03T16:13:19.503

在 iOS 7 中，您可以设置：

```
searchBar.barTintColor = [UIColor clearColor]; 
```

# iphone - 在 iOS 中，使用 ARC，将所有 ivars 和属性设置为零，并在 viewDidUnload 中释放上下文、图像、颜色空间是否足够？

> ID：10936569
> 
> 赞同：6
> 
> 时间：2012-06-07T17:11:04.607
> 
> 标签：iphone, objective-c, ios, automatic-ref-counting

对于使用 ARC 的 iOS 应用程序，我们通常会在`viewDidUnload`?

1.  将所有实例变量设置为`nil`

2.  将所有属性设置为`nil`

3.  使用 释放任何上下文`CGContextRelease`，使用 CGImage`CGImageRelease`和使用颜色空间`CGColorSpaceRelease`（释放任何非对象）

4.  元素不需要特别注意：只需`NSMutableArray`将`NSSet`NSMutableArray 和 NSSet 的引用设置为 nil，每个元素都会自动释放。

这样做会处理 ARC 下的大部分内存释放吗？还有其他需要发布的项目吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-28T06:03:56.593

很多人误解了`viewDidUnload`. 特别是，它**不是**. `viewDidLoad`在大多数情况下，您的视图控制器将在不`viewDidUnload`被调用的情况下被释放。*出于这个原因，您**永远不**应该考虑在`viewDidUnload`适当的平衡中为`viewDidLoad`.*

`viewDidUnload`已被 Apple 弃用。反对使用它的最佳论据可能是它的标题（我已经包装了）：

```
- (void)viewDidUnload NS_DEPRECATED_IOS(3_0,6_0); // Called after the view
    // controller's view is released and set to nil. For example, a memory warning
    // which causes the view to be purged. Not invoked as a result of -dealloc.` 
```

那是什么`viewDidUnload`？它背后的想法是视图正在从视图控制器后面卸载。这使您有机会分离任何指向它的指针并清除您可以轻松重建的任何信息。您的视图*可能会*被重新加载，此时您需要重建所有缓存。苹果是这样描述的：

> 当内存不足的情况发生并且不需要当前视图控制器的视图时，系统可能会选择从内存中删除这些视图。此方法在视图控制器的视图被释放后调用，这是您执行任何最终清理的机会。如果您的视图控制器存储了对视图或其子视图的单独引用，您应该使用此方法来释放这些引用。您还可以使用此方法删除对您为支持视图而创建但在视图消失后不再需要的任何对象的引用。您不应使用此方法发布用户数据或任何其他无法轻松重新创建的信息。

请记住，`viewDidUnload`现在应该不需要将对对象的引用清零。如果您按照 Apple 的建议使用 ARC，则您的视图渠道正在将弱引用归零。没有你写，他们会自动被取消`viewDidUnload`！

此外，清除缓存信息更适合`didReceiveMemoryWarning`，因此您应该改为编写它：

> 您可以覆盖此方法以释放视图控制器使用的任何额外内存。如果这样做，则此方法的实现必须在某个时候调用超级实现以允许视图控制器释放其视图。如果您的视图控制器持有对视图层次结构中视图的引用，您应该在`viewDidUnload`方法中释放这些引用。

一般来说，人们放入的东西`viewDidUnload`最好用`viewDidDisappear`or处理`dealloc`。剩下的唯一事情就是在视图控制器仍然打开的情况下，在视图重新加载后的某个时间点需要时，`viewDidUnload`清空任何可以在不丢失数据的情况下重建**的缓存。**（同样，这应该在 中处理`didReceiveMemoryWarning`。）这些缓存应该是惰性构建的；当您的应用再次需要它们时，它会悄悄地重建它们。

那么你应该做什么`viewDidUnload`呢？如果您使用的是 ARC：没有。甚至不要写它。*事实上，自从写了这个答案以来，Apple 已经弃用了`viewDidUnload`.*

对于`CGContextRelease`，`CGContext`资源不是 Objective-C 对象。（你指出了这一点，但我想为后代重复。）因此，它不能被 ARC 自动释放。您有责任确保它像旧的手动保留释放 (MRR) 内存管理方案一样被释放和取消。

如果您将此代码放入 中`viewDidUnload`，则不能保证它会被调用。它必须进去`dealloc`。你*也可以*把它放进去`viewDidUnload`，但是……</p>

所以：

1.  没有必要也没有帮助。与视图层次结构相比，您的实例变量微不足道。
2.  没有必要也没有帮助。与视图层次结构相比，您的属性微不足道（只要您的属性不是对视图层次结构的强引用）。
3.  这将导致内存泄漏，`dealloc`通常在没有`viewDidUnload`.
4.  没有必要也没有帮助。见第 1 点和第 2 点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-08T00:23:18.643

viewDidUnload 有一个棘手的名字，如果你仔细考虑的话，很容易知道里面有什么。

首先你要知道的是 iOS 设备有一个低内存处理方法。这意味着当设备需要更多内存时，它会检查它的哪些应用程序可以释放内存。它通过调用 ViewDidUnload 方法（名称可能不正确）来完成此操作。

所以我们鼓励你在这里将所有可以重建的东西都设置为 nil。（您在 viewdidload 中创建的所有内容）。

例外情况是当您因为获取数据或其他东西可能需要时间而真的无法承受丢失对象时。

如果你不实现这个 viewdidload，你的应用程序将保留它的项目和对象，iOS 将无法从中释放任何东西。

所以基本上就像我说的那样，释放（通过将指向这些对象的元素设置为零）您可以在 viewdidload 中安全地重建的所有内容。（在视图被卸载并想要再次加载后肯定会调用它）

# opengl - GLSL顶点着色器中的眼睛空间像素宽度

> ID：10936570
> 
> 赞同：3
> 
> 时间：2012-06-07T17:11:09.113
> 
> 标签：opengl, glsl, opengl-3, opengl-4

我想在 glsl 顶点着色器中的当前顶点位置计算像素投影金字塔的眼睛空间宽度，但我似乎无法正确计算。这是一个明显不正确的例子：

```
// GLSL VERTEX SHADER
#version 410 compatibility

uniform vec4 viewport; // same as glViewport​
in vec4 gl_Vertex;

void main ()
{
    gl_Position = gl_ModelViewProjectionMatrix * gl_Vertex;
    float pixelWidth = gl_Position.z / viewport.z;
<snip> 
```

但这并没有考虑 FOV 或剪裁平面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-11T14:26:45.527

我通过数学计算并弄清楚了。:) 正如我所希望的，不需要额外的矩阵转换，只需要一个除法：

```
// GLSL VERTEX SHADER
#version 410 compatibility

uniform vec4 viewport; // same as glViewport​
in vec4 gl_Vertex;

float pixelWidthRatio = 2\. / (viewport.z * gl_ProjectionMatrix[0][0]);

void main ()
{
    gl_Position = gl_ModelViewProjectionMatrix * gl_Vertex;
    float pixelWidth = gl_Position.w * pixelWidthRatio;
    <snip> 
```

或者：

```
<snip>
float pixelHeightRatio = 2\. / (viewport.w * gl_ProjectionMatrix[1][1]);

void main ()
{
    gl_Position = gl_ModelViewProjectionMatrix * gl_Vertex;
    float pixelHeight = gl_Position.w * pixelHeightRatio;
<snip> 
```

正如预期的那样，如果像素是正方形的，则它们是相同的`pixelWidth`。`pixelHeight`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T18:34:33.850

在**顶点着色器**中，没有像素的世界空间宽度之类的东西。“宽度”仅在给定的 Z 距离处投影到像素中。通常，您将金字塔投影到像素中。

干得好：

1.  将两个屏幕点转换为 NDC 点：

    ```
     vec2 Screen = vec2( ScreenWidth, ScreenHeight );
        vec3 Point1 = vec3( ScreenPt1 / Screen * 2.0 - vec2( 1.0 ), 1.0 );
        vec3 Point2 = vec3( ScreenPt2 / Screen * 2.0 - vec2( 1.0 ), 1.0 ); 
    ```

2.  将 NDC 点解投影到世界空间位置：

    ```
     vec4 R1 = vec4( Point1, 1.0 );
        vec4 R2 = vec4( Point2, 1.0 );

        R1 = Projection.GetInversed() * R1;
        R1 = ModelView.GetInversed() * R1;
        R1 /= R1.W;

        R2 = Projection.GetInversed() * R2;
        R2 = ModelView.GetInversed() * R2;
        R2 /= R2.W; 
    ```

3.  求 R1 和 R2 之间的距离。

在**片段着色器**中，您可以使用局部导数。看看这里：

[http://www.opengl.org/sdk/docs/manglsl/xhtml/dFdx.xml](http://www.opengl.org/sdk/docs/manglsl/xhtml/dFdx.xml)

和这里：

[http://www.opengl.org/sdk/docs/manglsl/xhtml/fwidth.xml](http://www.opengl.org/sdk/docs/manglsl/xhtml/fwidth.xml)

仅在片段着色器中可用，dFdx 和 dFdy 分别返回表达式 p 在 x 和 y 中的偏导数。使用局部差分计算偏差。暗示高阶导数（例如 dFdx(dFdx(n))）的表达式具有未定义的结果，混合阶导数（例如 dFdx(dFdy(n))）也是如此。假设表达式 p 是连续的，因此，通过非均匀控制流评估的表达式可能是未定义的。

# uiview - iOS 的滑块视图

> ID：10936576
> 
> 赞同：3
> 
> 时间：2012-06-07T17:11:17.420
> 
> 标签：uiview, uibutton, uilabel, xib, uiviewanimation

![----window1-----](../Images/3791eeeeb8718fc362b05717a46e10b9.png) ![----window2-----](../Images/832084d2474098b9fb7fd4ac813ef81c.png) 有人可以帮我解决这个问题吗？

*有一个按钮，当点击它时，滑动打开一个 UIView，点击的按钮仍然在它的左边。

*再次点击此按钮时，会使 UIView 向后滑动。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-11T00:33:58.840

你描述的很简单。我们称从右侧滑入的视图为抽屉（“drawerView”）。将抽屉视图设置为视图控制器主视图的子视图。

使那个“抽屉”视图成为容器视图。把你想要的东西都放进去。（您的文本视图、按钮等）还将您的按钮放在此视图中。将该按钮连接到视图控制器中的操作“slideDrawer”。

然后确保“剪辑子视图”为假，并使用左箭头键将按钮从抽屉视图的左边缘移开。在 IB 中它会消失，但不要担心。IB 不像您正在运行的程序那样尊重“剪辑子视图”标志。

为您的抽屉视图创建一个出口并将其链接到您的代码。

一旦您的抽屉视图看起来完全符合您的要求，请注意它在“尺寸检查器”中的 x 坐标。让我们将该值**称为 kVisibleX**。然后将该视图向右拖动，直到它离开屏幕。该按钮在 IB 中不可见，但在运行时仅在窗口边缘可见。（就像你在第一张图片中展示的那样）

注意抽屉视图在屏幕外时的 x 坐标。让我们将该值**称为 kOffscreenX**。

将布尔实例变量“drawerIsShowing”添加到您的视图控制器。

现在写一个IBAction方法slideDrawer：

```
- (IBAction) slideDrawer: (id) sender; 
```

在该方法中，检查抽屉IsShowing 以查看抽屉当前是否可见。如果是，请将其滑出屏幕。如果不是，请在屏幕上滑动它。

```
- (IBAction) slideDrawer: (id) sender;
{
  CGFloat newX;
  if (drawerIsShowing)
    newX = kOffscreenX;
  else
    newX = kVisibleX;
  [UIView animateWithDuration: .25
  animations: 
  ^{
    CGRect drawerFrame = drawerView.frame;
    drawerFrame.origin.x = newX;
    drawerView.frame = drawerFrame;
  }
drawerIsShowing = !drawerIsShowing;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:21:24.653

我会让窗口 1 是 view1，窗口 2 是 view2。用视图中需要的任何内容填充这些视图中的每一个。如果您希望相同的按钮出现在两个视图中，请在具有相同文本的每个视图中放置一个按钮。对用户来说，它是同一个按钮。将视图 1 上的按钮操作推到视图 2。视图 2 将使用您告诉它的任何内容进行初始化。按下视图 2 中的按钮将弹出视图并将其返回到视图 1...

我希望这会有所帮助。如果您需要更具体的帮助，请提供更多信息，我应该能够进一步帮助您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-12T12:29:37.947

声明一个 BOOL 来检查视图是否隐藏。

**在.h**

```
BOOL _isContentVisible; 
```

**在.m**

```
-(IBAction)showHideContentView:(id)sender
{
    //BOOL isContentVisible= CGRectIntersectsRect(self.view.bounds, _sideContentScrollView.frame);

    [UIView animateWithDuration:1.0f
                          delay:0
                        options:UIViewAnimationOptionBeginFromCurrentState
                     animations:^{
                         //hide if visible else show
                         if (_isContentVisible) { // Hide
                             _isContentVisible = NO;
                             [_sideContentView setFrame:CGRectMake(-320, 0, 360, 748)];// 40 is assumed to button size
                         }
                         else { // Show
                             _isContentVisible = YES;
                             [_sideContentView setFrame:CGRectMake(0, 0, 360, 748)];
                         }
                     }
                     completion:^(BOOL finished) {
                         if (finished) {

                         }
                     }];
} 
```

# mobile - 如何将 ADFS 与 Google Apps 一起使用，同时仍允许在移动设备上使用 gmail

> ID：10936581
> 
> 赞同：0
> 
> 时间：2012-06-07T17:11:31.220
> 
> 标签：mobile, gmail, adfs2.0, adfs, google-apps-for-education

我一直在问谷歌，但无法给出答案：

我想为我的组织在本地实施 ADFS 服务器。这将是所有应用程序、内部和 DMZ 以及合作伙伴的 SSO 位置。在这种情况下，Google 是合作伙伴（企业应用程序）。我们希望 ADFS 页面使用 SAML2.0 向 Google 进行身份验证。我知道这是可能的。

我的问题是这对将 Gmail 邮件和日历添加到移动设备的用户有何影响。我是否必须以某种方式将用户名和密码与 Google 同步，还是它仍然可以工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T21:50:01.213

是的 - 可以联合 Google Apps 和 ADFS。

虽然我从未这样做过，但您可能会在配置联合时单击 Google Apps 管理控制台的身份验证部分中的“高级工具”并选择“设置单点登录 (SSO)”。

然后，您的移动用户应该能够使用他们的组织凭据登录到 Gmail。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-12T20:02:59.687

对于移动设备和桌面胖客户端（邮件、日历），每个用户都需要在 Google Apps 中存储一个本地密码。即使是 Android/iPhone 手机也需要使用 Google 用户名/密码向 GABE 注册。Web 浏览器用户可以使用 SAML2.0 并针对您的本地 IDP 和 SSO 对 Google Apps 进行身份验证。

您可以将本地企业商店中的密码同步到 Google Apps，也可以使用 PingFederate + Google 连接器之类的工具，该工具不仅允许 SAML2 SSO，还可以通过 Google Apps API 配置/取消配置用户。它还包括一个密码重置工具，用于管理 Google 维护的 Google Apps 密码。

HTH-伊恩

# javascript - JS/Chrome：加载的 JS 文件中的 chrome.extension.getURL

> ID：10936582
> 
> 赞同：0
> 
> 时间：2012-06-07T17:11:49.273
> 
> 标签：javascript, jquery, google-chrome

我有我的扩展，通过添加标签将 JS 文件加载到网站。

但是这个 JS 脚本正在从扩展目录加载图像，但它不能，因为它不知道扩展目录。

我不能使用 chrome.extension.getURL 因为它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:37:26.377

我找到了非最佳解决方案：

```
function geturl(url)
{
var path = ($('script[src$=jquery.lightbox-0.5.js]').attr('src')).split('/').slice(0, -1).join('/')+'/'
return path+url;
} 
```

它有效，但对我来说似乎不是最佳选择。

# java - 如何将 XML 更改为 JSON？

> ID：10936583
> 
> 赞同：0
> 
> 时间：2012-06-07T17:12:12.103
> 
> 标签：java, xml, xml-serialization

我正在从 WSDL 创建 Web 服务客户端，并且我想将从 SOAP 调用获得的 XML 转换为 JSON 对象（作为 RESTful WS）。

我试过 GSON，但它坚持使用 TypeAdapter。因为我有大约 75 个对象，所以我需要更通用的东西。我也使用过 Jackson，但它只是将其作为 XML 发送。

NetBeans (wsimport) 生成许多类，下面显示了其中的示例。我怎样才能把它变成一个 JSON 对象？

```
 import javax.xml.bind.JAXBElement;
  import javax.xml.bind.annotation.XmlAccessType;
  import javax.xml.bind.annotation.XmlAccessorType;
  import javax.xml.bind.annotation.XmlElement;
  import javax.xml.bind.annotation.XmlElementRef;
  import javax.xml.bind.annotation.XmlType;

  @XmlAccessorType(XmlAccessType.FIELD)
  @XmlType(name = "addressData", propOrder = {
      "addressLine1",
      "addressLine2"
  })
  public class AddressData {

      @XmlElement(required = true)
      protected String addressLine1;
      @XmlElementRef(name = "addressLine2", type = JAXBElement.class, required = false)
      protected JAXBElement<String> addressLine2;

      /**
       * Gets the value of the addressLine1 property.
       * 
       * @return
       *     possible object is
       *     {@link String }
       *     
       */
      public String getAddressLine1() {
          return addressLine1;
      }

      /**
       * Sets the value of the addressLine1 property.
       * 
       * @param value
       *     allowed object is
       *     {@link String }
       *     
       */
      public void setAddressLine1(String value) {
          this.addressLine1 = value;
      }

      /**
       * Gets the value of the addressLine2 property.
       * 
       * @return
       *     possible object is
       *     {@link JAXBElement }{@code <}{@link String }{@code >}
       *     
       */
      public JAXBElement<String> getAddressLine2() {
          return addressLine2;
      }

      /**
       * Sets the value of the addressLine2 property.
       * 
       * @param value
       *     allowed object is
       *     {@link JAXBElement }{@code <}{@link String }{@code >}
       *     
       */
      public void setAddressLine2(JAXBElement<String> value) {
          this.addressLine2 = value;
      }

  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T21:24:37.120

您可能必须`AnnotationMethodHandlerAdapter`使用杰克逊 messageConverter 进行配置：

```
<bean id="jsonConverter" class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter">
    <property name="objectMapper" ref="jacksonObjectMapper"/>
    <property name="supportedMediaTypes">
        <list>
            <bean class="org.springframework.http.MediaType">
                <constructor-arg index="0" value="application"/>
                <constructor-arg index="1" value="json"/>
                <constructor-arg index="2" value="UTF-8"/>
            </bean>
        </list>
    </property>
</bean>

<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
    <property name="messageConverters">
        <list>
            <ref bean="jsonConverter"/>
        </list>
    </property>
</bean> 
```

# jsf-2 - 使用 primefaces jsf2 上传文件示例

> ID：10936584
> 
> 赞同：1
> 
> 时间：2012-06-07T17:12:18.583
> 
> 标签：jsf-2, primefaces, netbeans-7

我到处寻找使用 jsf 2 和 primefaces 上传文件的工作示例，我尝试了很多替代方法，但仍然无法正常工作我在 web.xml 中添加了过滤器，然后我使用其侦听器方法创建了托管 bean，最后添加了

```
 <p:fileUpload fileUploadListener="#{fileUploadController.handleFileUpload}"/> 
```

[如这里](http://www.primefaces.org/showcase-labs/ui/fileUploadSingle.jsf)的 primefaces 官方网站所示。

我还添加了 commons-file 和 common-io jar

到目前为止没有结果，我做错了什么？

# asp.net-mvc-3 - 我可以在操作过滤器中修改模型元数据吗？

> ID：10936586
> 
> 赞同：1
> 
> 时间：2012-06-07T17:12:20.333
> 
> 标签：asp.net-mvc-3

我正在尝试实现一个要求，该要求允许我根据用户角色或其他业务逻辑更改 html 控件的状态。例如，某些用户不应该能够编辑某个模型属性，或者在某些情况下我什至不希望控件呈现到 html DOM。

在 HTML 帮助器中，元数据可以告诉帮助器是否呈现控件，或者它可以使其只读/禁用。我不想在这里重新发明轮子，我只想通过在运行时根据逻辑更改动作过滤器中的元数据来使用已经存在的东西。我不希望这种逻辑出现在我的视图中，如果我不需要的话，我也不想为每个 html 控件创建自定义帮助程序。

我试图做的是创建一个操作过滤器来处理我的业务层中的评估逻辑规则，然后对给定 model.property 的元数据进行更改。

问题是我对元数据的修改似乎并没有出现在视图中。似乎我对操作过滤器中元数据的更改不是通过引用进行的，因此我没有修改用于视图的同一实例？

```
public override void OnResultExecuting(ResultExecutingContext filterContext)
    {
    var trans = filterContext.Controller.ViewData.ModelMetadata.Properties.Where(e => e.PropertyName == "Transaction").FirstOrDefault();
    trans.DisplayName = "Show FOO!";
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T17:55:06.380

您无法更改`ModelMetadata.Properties`过滤器中的值，事实上您根本无法更改它们。

问题出在内置`DataAnnotationsModelMetadataProvider`（准​​确地`AssociatedMetadataProvider`说是`GetMetadataForProperties`方法）内部`ModelMetadata.Properties`，即每次迭代它时都会从属性中重新生成。

所以`ModelMetadata.Properties`集合中的项目是不可变的。

您可以通过调试检查它：

```
public override void OnResultExecuting(ResultExecutingContext filterContext)
{
     var properties = filterContext.Controller.ViewData.ModelMetadata.Properties
     var trans1 = properties.Where(e => e.PropertyName == "Transaction").First();
     trans1.DisplayName = "Show FOO!";
     var trans2 = properties.Where(e => e.PropertyName == "Transaction").First();
} 
```

`trans1`和将`trans2`是不同的实例（您可以检查它们的哈希码），因此`trans2`显示名称将是原始显示名称而不是“显示 FOO！”。

所以你需要扩展/编写一个新`MetadataProvider`的来实现你的目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:23:29.977

您可以检查用户在视图中的角色并以这种方式进行调整。角色在呈现 html 之前在服务器端进行评估

```
@if(HttpContext.Current.User.IsInRole("MyRole")) {
   <input type='text' id='txtSomeInput' />
} 
```

# c# - 重载运算符抛出什么异常

> ID：10936589
> 
> 赞同：1
> 
> 时间：2012-06-07T17:12:34.133
> 
> 标签：c#, exception, operator-overloading

我做了一个 Matrix 实现，它有一个重载的`operator *`. 如果有 2 个大小不兼容的矩阵，我想抛出`ArgumentException`或`InvalidOperationException`. 我应该使用哪一个？或者，也许它的移动方便声明我自己的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T17:20:32.640

绝对创建自己的`MismatchingDimensionsException`.

您的用户不会被这样的异常所迷惑，他们会立即知道问题所在。这是处理矩阵时经常发生的问题。

现在，您是从 ArgumentException 还是 InvalidOperationException 派生出来的？我会说前者，但后者同样有意义。如果您使用自己的异常类，则影响较小。

# macos - 在两个轴上翻转 NSImage

> ID：10936590
> 
> 赞同：8
> 
> 时间：2012-06-07T17:12:35.200
> 
> 标签：macos, cocoa, nsimage, core-image

我正在尝试翻转使用 NSImageBitmapRep 表示创建的 NSImage 。经过一番挖掘（[翻转 Quicktime preview & capture](https://stackoverflow.com/questions/820275/flipping-quicktime-preview-capture)和[Mirroring CIImage/NSImage](https://stackoverflow.com/questions/6128640/mirroring-ciimage-nsimage)），我尝试了两种方法，通过 CIImage 并为这两个因素应用 -1 的缩放转换。

首先使用 CIImage imageByApplyingTransform：

```
 NSBitmapImageRep *imgRep = ...
    CGImageRef cgi = [imgRep CGImage];
    CIImage *cii = [CIImage imageWithCGImage:cgi];
    CGAffineTransform at = CGAffineTransformTranslate(CGAffineTransformMakeScale(-1, -1), 0, 0);
    NSCIImageRep *ciiRep = [NSCIImageRep imageRepWithCIImage:[cii imageByApplyingTransform:at]];

    NSImage *img = [[[NSImage alloc] init] autorelease];
    [img addRepresentation:ciiRep];
    [self.ivImage setImage:img]; 
```

然后使用 CIAffineTransform 过滤器：

```
 NSBitmapImageRep *imgRep = ...
    CGImageRef cgi = [imgRep CGImage];
    CIImage *cii = [CIImage imageWithCGImage:cgi];
    CIFilter *f = [CIFilter filterWithName:@"CIAffineTransform"];
    NSAffineTransform *t = [NSAffineTransform transform];
    [t scaleXBy:1.0 yBy:1.0];
    //[t translateXBy:width yBy:0];
    [f setValue:t forKey:@"inputTransform"];
    [f setValue:cii forKey:@"inputImage"];
    CIImage *cii2 = [f valueForKey:@"outputImage"];
    NSCIImageRep *ciiRep = [NSCIImageRep imageRepWithCIImage:cii2];

    NSImage *img = [[[NSImage alloc] init] autorelease];
    [img addRepresentation:ciiRep];
    [self.ivImage setImage:img]; 
```

两种方式都会产生空白图像。我还尝试翻译图像，以防它因-1缩放而超出屏幕，但无济于事。如果我使用正值进行缩放，我可以看到转换已正确应用。

self.ivImage 是一个 NSImageView。我想要一个被翻转的实际 NSImage，因此对 NSImageView 应用转换不是一种选择。

这是 32 位，Lion 上的 Xcode 4.3.2。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-08T08:47:26.543

你应该`NSImage`用一个大小来初始化你的。

展示你的翻译尝试，因为那是正确的方式。通常，首先翻译然后缩放是最容易的。您的代码片段似乎有翻译尝试的残留痕迹，但它们是不正确的。您在一种情况下平移 0,0，在另一种情况下平移 width,0。此外，在您的第二个代码片段中，您将按 1,1（正）进行缩放，因此不会翻转。

此外，将焦点锁定在适当大小的新图像上、设置变换并绘制图像表示可能更简单。避免使用`CIImage`.

```
NSBitmapImageRep *imgRep = ...
NSImage* img = [[[NSImage alloc] initWithSize:NSMakeSize(imgRep.pixelsWide, imgRep.pixelsHigh)] autorelease];
[img lockFocus];
NSAffineTransform* t = [NSAffineTransform transform];
[t translateXBy:imgRep.pixelsWide yBy:imgRep.pixelsHigh];
[t scaleXBy:-1 yBy:-1];
[t concat];
[imgRep drawInRect:NSMakeRect(0, 0, imgRep.pixelsWide, imgRep.pixelsHigh)];
[img unlockFocus]; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-10T08:24:08.090

无论如何，我认为一个好主意应该是发布一个完整的功能。这是我基于 Ken 帖子的解决方案

```
- (NSImage *)flipImage:(NSImage *)image
{
    NSImage *existingImage = image;
    NSSize existingSize = [existingImage size];
    NSSize newSize = NSMakeSize(existingSize.width, existingSize.height);
    NSImage *flipedImage = [[[NSImage alloc] initWithSize:newSize] autorelease];

    [flipedImage lockFocus];
    [[NSGraphicsContext currentContext] setImageInterpolation:NSImageInterpolationHigh];

    NSAffineTransform *t = [NSAffineTransform transform];
    [t translateXBy:existingSize.width yBy:existingSize.height];
    [t scaleXBy:-1 yBy:-1];
    [t concat];

    [existingImage drawAtPoint:NSZeroPoint fromRect:NSMakeRect(0, 0, newSize.width, newSize.height) operation:NSCompositeSourceOver fraction:1.0];

    [flipedImage unlockFocus];

    return flipedImage;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-03-31T22:37:28.010

Swift 的扩展，基于[Alejandro Lugeno 的解决方案](https://stackoverflow.com/a/13797258/3151675)：

```
extension NSImage {
    func flipped(flipHorizontally: Bool = false, flipVertically: Bool = false) -> NSImage {
        let flippedImage = NSImage(size: size)

        flippedImage.lockFocus()

        NSGraphicsContext.current?.imageInterpolation = .high

        let transform = NSAffineTransform()
        transform.translateX(by: flipHorizontally ? size.width : 0, yBy: flipVertically ? size.height : 0)
        transform.scaleX(by: flipHorizontally ? -1 : 1, yBy: flipVertically ? -1 : 1)
        transform.concat()

        draw(at: .zero, from: NSRect(origin: .zero, size: size), operation: .sourceOver, fraction: 1)

        flippedImage.unlockFocus()

        return flippedImage
    }
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2016-04-06T12:23:18.327

用于垂直翻转

```
- (NSImage *)flipImageVertically:(NSImage *)inputImage {

    NSImage *tmpImage;
    NSAffineTransform *transform = [NSAffineTransform transform];

    NSSize dimensions = [inputImage size];
    NSAffineTransformStruct flip = {1.0, 0.0, 0.0, -1.0, 0.0,
        dimensions.height};
    tmpImage = [[NSImage alloc] initWithSize:dimensions];
    [tmpImage lockFocus];
    [transform setTransformStruct:flip];
    [transform concat];
    [inputImage drawAtPoint:NSMakePoint(0,0)
                         fromRect:NSMakeRect(0,0, dimensions.width, dimensions.height)
                        operation:NSCompositeCopy fraction:1.0];
    [tmpImage unlockFocus];

    return [tmpImage autorelease];

} 
```

用于水平翻转

```
+ (NSImage *)flipImageHorizontally:(NSImage *)inputImage {

    NSImage *tmpImage;
    NSAffineTransform *transform = [NSAffineTransform transform];

    NSSize dimensions = [inputImage size];
    NSAffineTransformStruct flip = {-1.0, 0.0, 0.0, 1.0,
        dimensions.width, 0.0 };
    tmpImage = [[NSImage alloc] initWithSize:dimensions];
    [tmpImage lockFocus];
    [transform setTransformStruct:flip];
    [transform concat];
    [inputImage drawAtPoint:NSMakePoint(0,0)
                         fromRect:NSMakeRect(0,0, dimensions.width, dimensions.height)
                        operation:NSCompositeCopy fraction:1.0];
    [tmpImage unlockFocus];

    return [tmpImage autorelease];

} 
```

# javascript - Javascript 十进制到二进制 - 64 位

> ID：10936600
> 
> 赞同：5
> 
> 时间：2012-06-07T17:13:01.417
> 
> 标签：javascript, binary, decimal

十进制 -805306368 的二进制是：

11111111111111111111111111111111 11010000000000000000000000000000

但是，在 Javascript 中，我得到[以下](http://jsfiddle.net/FjWwf/)信息：

```
 var str = parseInt(-805306368).toString(2);
   document.write(str); 
```

-1100000000000000000000000000000

谁能解释如何从这个十进制解析 64 位二进制字符串？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-07T17:29:37.323

JavaScript 不使用二进制补码表示，它`-`在字符串前面使用一个字符。那是因为它不知道您的数字范围有多少位。

要获得预期的结果，您可以反转每一位：

```
>>> (~-805306368).toString(2)
"101111111111111111111111111111" 
```

然而，javascript 对 32 位整数执行所有二进制操作，因此这不适用于更大（或更小）的数字，至少会非常混乱。因此，您需要实现自己的格式化算法。

```
// example of to 32-bit-conversion:
>>> (~parseInt("1111111111111111111111111111111",2)).toString(2)
"-10000000000000000000000000000000"
>>> (~parseInt("11111111111111111111111111111111",2)).toString(2)
"0" 
```

我的实现：

```
String.prototype.padleft = function(len, chr){...}

function get64binary(int) {
    if (int>=0)
        return int
          .toString(2)
          .padleft(64, "0");
    // else
    return (-int-1)
      .toString(2)
      .replace(/[01]/g, function(d){return +!+d;}) // hehe: inverts each char
      .padleft(64, "1");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T17:17:34.750

你可以`parseInt()`再次使用。它有一个可选的第二个参数，使您能够指定要解析的字符串中数字的基数（或基数）。

如：`parseInt("-110000000000000000000000000000", 2) // gives -805306368`

# url - 更改 portlet URL

> ID：10936604
> 
> 赞同：0
> 
> 时间：2012-06-07T17:13:13.850
> 
> 标签：url, liferay, portlet

在该`doView`方法中，有没有办法用外部 URL（如：www.google.fr）更改当前的 Portlet URL，然后刷新它（以便获取新内容）？

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T06:34:11.710

我要收回这个。你可以做的是在processAction()中，最后你可以做actionResponse.sendRedirect(String url)，

这根本不会调用 doView() 方法，如果你只想在 doView() 中执行，那么我想，你必须使用 javascript 来更改 window.location。这将重定向到 www.google.fr。

如果有任何细节，请告诉我。

# c# - 如何将gridview所有检查的行数据放入C#中另一个表单的文本框中？

> ID：10936606
> 
> 赞同：0
> 
> 时间：2012-06-07T17:13:17.507
> 
> 标签：c#, datagridview

我有一个数据网格视图，其中复选框列作为第一列。我们想要的是当用户检查行时，所有检查的行都应该转到另一个表单中的文本框。我写了以下内容来做到这一点。但问题是虽然检查了超过 1 行，但它总是将最后检查的行数据发送到下一个表单。并非所有检查的行数据

```
private void btngnvoucher_Click(object sender, EventArgs e)
{
    // foreach(DataGridViewRow row in dataGridView1.Rows)
    for (int x = 0; x < dataGridView1.RowCount;x++ )
    {
        // DataGridViewCheckBoxCell ch1  = (DataGridViewCheckBoxCell)row.Cells[0];
        DataGridViewCheckBoxCell ch1 = (DataGridViewCheckBoxCell)dataGridView1.Rows[x].Cells[0];

        if (ch1.Value != null)
        {
            for (int a = 0; a < 6; a++)
            {
                for (int col = 1; col < 5; col++)
                {
                    TextBox theText1 = (TextBox)vobj.Controls[col - 1];

                    // theText1.Text = row[x].Cells[col].Value.ToString();
                    theText1.Text = dataGridView1.Rows[x].Cells[col].Value.ToString();

                }

                // a = a + 1;
                break;

            }
        }
    }

    vobj.Show();
}
} 
```

}

谁能告诉我我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:19:08.433

而不是这个：

```
theText1.Text = dataGridView1.Rows[x].Cells[col].Value.ToString(); 
```

尝试：

```
theText1.AppendText(dataGridView1.Rows[x].Cells[col].Value.ToString()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T19:38:50.647

您的问题的原因似乎是您打算让变量`a`做某事但不做任何事情。看起来这是为了引用一行文本框，然后由查看单元格的代码填充这些文本框。

就目前而言，这段代码：

```
for (int col = 1; col < 5; col++)
{
    TextBox theText1 = (TextBox)vobj.Controls[col - 1];

    // theText1.Text = row[x].Cells[col].Value.ToString();
    theText1.Text = dataGridView1.Rows[x].Cells[col].Value.ToString();

} 
```

为每一行填充相同的四个文本框。

* * *

也就是说，您的代码还有很多其他问题，修复后可能会让您更清楚。

首先 - 只要有可能，使用 foreach 循环遍历`DataGridView`. 它最终变得更干净，更易于维护。例如，当您遍历所需的列时，您假定**永远不会**添加另一列。

下一步 - 尝试按名称而不是索引来引用列。维护代码时，它的脆弱性要小得多。

您检查复选框是否被选中是不正确的 - 如果用户选择该框然后删除您仍然计算它的检查，那么您拥有它的方式。您需要检查是否为空，如果不为空，则检查是否为真。

通过这些更改，您将获得如下内容：

```
foreach (DataGridViewRow r in dataGridView1.Rows)
{
    if (r.Cells["CheckBox"].Value != null && (bool)r.Cells["CheckBox"].Value)
    {
        foreach (DataGridViewCell c in r.Cells)
        {
            if (c.ValueType == typeof(string))
            {
                // The code here is still ugly - there is almost certainly
                // a better design for what you are trying to do but that is
                // beyond the scope of the question.
                // Plus it still has your original bug of referencing the 
                // same row of text boxes repeatedly.
                TextBox theText1 = (TextBox)vobj.Controls[c.ColumnIndex];
                theText1 += c.Value.ToString();
            }
        }
    }
} 
```

# css - IE 8 & 9 忽略 div 宽度 - 如何让这个例子工作？

> ID：10936608
> 
> 赞同：6
> 
> 时间：2012-06-07T17:13:19.773
> 
> 标签：css, internet-explorer, internet-explorer-8, internet-explorer-9, doctype

以下 html 页面似乎在除 IE 8 和 9 之外的任何浏览器中都能正常呈现：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
</head>
<body>
    <div style="width: 300px">

        <span style="white-space: nowrap;">
            <input type="radio" value="1" name="test" />Choice 1
        </span>
        <span style="white-space: nowrap;">
            <input type="radio" value="2" name="test" />Choice 2
        </span>
        <span style="white-space: nowrap;">
            <input type="radio" value="3" name="test" />Choice 3
        </span>
        <span style="white-space: nowrap;">
            <input type="radio" value="4" name="test" />Choice 4
        </span>
        <span style="white-space: nowrap;">
            <input type="radio" value="5" name="test" />Choice 5
        </span>
        <span style="white-space: nowrap;">
            <input type="radio" value="6" name="test" />Choice 6
        </span>
        <span style="white-space: nowrap;">
            <input type="radio" value="7" name="test" />Choice 7
        </span>

    </div>
</body>
</html> 
```

html 看起来相当简单，但 IE 8 和 9 忽略了 div 上的宽度，并强制在同一行上进行所有选择（IE 7 和所有其他非 IE 浏览器应该以 300px 换行）。不知何故，我需要这个单选按钮列表以指定的宽度换行，同时不将单选按钮与相应的选项分开。

如果我更改文档类型，我可以让 IE 8 和 9 正常运行，但是如果可能的话，我想避免更改它。

如果我使用老式的“nobr”标签代替 span 标签，我会得到相同的行为。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:16:00.580

你应该把“ `;`”放在`<div style="width: 300px;">`（好的做法）

使用`display: inline-block`；代替`white-space: nowrap;`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-07T17:59:08.677

问题在于标记中的制表符和换行符。您要求 IE 不要包裹这些元素，同时要求每个元素保持足够窄以并排放置在父容器中。

您会注意到，如果您删除空格，所有浏览器都会呈现相同的标记：

```
<!DOCTYPE html>
<html>
  <head>
    <style>
      div { 
        width: 300px; 
        border: 1px solid #333
      }
      span { 
        border: 1px solid red; 
        white-space: nowrap
      }
    </style>
  </head>
  <body>
    <div>
      <span><input type="radio" value="1" name="test" /> Choice 1</span>
      <span><input type="radio" value="2" name="test" /> Choice 2</span>
      <span><input type="radio" value="3" name="test" /> Choice 3</span>
      <span><input type="radio" value="4" name="test" /> Choice 4</span>
      <span><input type="radio" value="5" name="test" /> Choice 5</span>
      <span><input type="radio" value="6" name="test" /> Choice 6</span>
      <span><input type="radio" value="7" name="test" /> Choice 7</span>
    </div>
  </body>
</html> 
```

![在此处输入图像描述](../Images/57043e603fdea7aebfd19642462e0c58.png)

# backbone.js - 在新窗口中打开新视图

> ID：10936619
> 
> 赞同：2
> 
> 时间：2012-06-07T17:14:21.650
> 
> 标签：backbone.js, backbone-routing

假设我有一个使用 Backbone 制作的 Web 应用程序，
它使用 Backbone.Router 来路由客户端页面。

假设页面布局如下所示：

```
link_1 |
link_2 | Right
link_2 | 
```

路由器如下：

```
routes: {
    'link_:id': 'renderRight'
} 
```

当用户单击`l1, l2 or l3`它时，它会打开`Right part`窗口上的视图。
但是让我们假设用户想在`new window`.
对于路由器的工作原理，它将渲染完整的 Vies（左右）。
我该如何解决这个问题？

PS：
为了创建包含链接（）的左侧部分，`LinkView`我有以下`ContainerView`创建不同的实例`LinkView`（每个链接一个）：

```
var ContainerView = Backbone.View.extend({

   // ContainerView Left Part

    addAll: function ()
    {
        this.collection.each(this.addOne);
    },

    addOne: function (task)
    {
        var view;
        view = new LinkView({ 
            model: task
        });

        this.$("#linkContainer").append(view.render().el);
    },

    // other codes

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:54:29.477

您将必须找到一种方法来区分`new window`和 ，并`existing document`带有菜单。

我能想到的最简单的方法是使用[Backbone.history](http://documentcloud.github.com/backbone/#History)。当您在根路径上时，您可以渲染菜单并为要附加的正确部分创建一个 el。然后，当单击链接时，您会捕获它并让[应用程序路由器导航](http://documentcloud.github.com/backbone/#Router-navigate)到您的链接路由。在这里，您可以让您的`renderRight`路线检查是否存在 a`right-el`并附加到它，如果没有，那么这是一个新页面，因此创建一个 el 并附加。这解决了您在右键单击`new-page`或直接导航到`root/link:id`场景时遇到的麻烦，因为您的左侧菜单不存在，并解决了视图在没有它的情况下呈现整个页面的问题。

*   root - 渲染菜单，并创建正确的 el。
*   link_:id - 检查 el 是否存在，如果不存在，则创建并附加到它。

**编辑：**这是我的意思的示例

```
var Application = Backbone.Router.extend({

    routes: {
        "": "root"
        'link_:id': 'renderRight',
    },

    root: function() {
        //rednder link container
        var menu = new ContainerView();
        $('body').append('<div id="linkContainer"/>','<div id="rightContainer"/>'); //create left and right container
        menu.render();
        //render initial view of right container etc..

    },

    renderRight: function () {

        if ($('#rightContainer').length == 0) $('body').append('<div id="rightContainer"/>');  //check if a rightContainer is available if not create one
        //render right container to  #rightContainer
    }

});
var app = new Application();
Backbone.history.start(); 
```

# java - 使用 readClassDescriptor() 和 resolveClass() 来允许序列化版本控制

> ID：10936625
> 
> 赞同：5
> 
> 时间：2012-06-07T17:14:44.773
> 
> 标签：java, serialization, version-control, version, deserialization

我正在研究 Java 序列化机制中的不同选项，以允许我们的类结构具有灵活性以进行版本容错存储（并且提倡使用不同的机制，您无需告诉我）。

例如，如果只需要向后兼容，默认的序列化机制可以处理添加和删除字段。

然而，重命名一个类或将其移动到不同的包已被证明要困难得多。我在[这个问题](https://stackoverflow.com/questions/2358886/how-can-i-deserialize-the-object-if-it-was-moved-to-another-package-or-renamed/3916282#3916282)中发现，通过继承 ObjectInputStream 并覆盖 readClassDescriptor()，我能够进行简单的类重命名和/或移动包：

```
 if (resultClassDescriptor.getName().equals("package.OldClass"))
        resultClassDescriptor = ObjectStreamClass.lookup(newpackage.NewClass.class); 
```

这对于简单的重命名很好。但是，如果您随后尝试添加或删除字段，则会收到 java.io.StreamCorruptedException。更糟糕的是，即使添加或删除了一个字段，*然后*重命名该类，也会发生这种情况，这可能会导致多个开发人员或多个签入出现问题。

根据我所做的一些阅读，我尝试了一些覆盖resolveClass()的方法，我们的想法是我们正确地将名称重新指向新类，而不是加载旧类本身并轰炸字段更改。但这来自对序列化机制的一些细节的非常模糊的理解，我什至不确定我是否在吠叫正确的树。

所以2个精确的问题：

1.  为什么使用 readClassDescriptor() 重新指向类名会导致反序列化在正常、兼容的类更改时失败？
2.  有没有办法使用 resolveClass() 或其他机制来解决这个问题并允许类同时进化（添加和删除字段）并重命名/重新打包？

我四处寻找，找不到关于 SO 的等效问题。无论如何，如果存在这样的问题，请向我指出，但请仔细阅读该问题，以免关闭我，除非另一个问题实际上回答了我的确切问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-30T15:49:30.123

我和你一样在灵活性方面遇到了同样的问题，我找到了方法。所以这里是我的 readClassDescriptor() 版本

```
 static class HackedObjectInputStream extends ObjectInputStream
{

    /**
     * Migration table. Holds old to new classes representation.
     */
    private static final Map<String, Class<?>> MIGRATION_MAP = new HashMap<String, Class<?>>();

    static
    {
        MIGRATION_MAP.put("DBOBHandler", com.foo.valueobjects.BoardHandler.class);
        MIGRATION_MAP.put("DBEndHandler", com.foo.valueobjects.EndHandler.class);
        MIGRATION_MAP.put("DBStartHandler", com.foo.valueobjects.StartHandler.class);
    }

    /**
     * Constructor.
     * @param stream input stream
     * @throws IOException if io error
     */
    public HackedObjectInputStream(final InputStream stream) throws IOException
    {
        super(stream);
    }

    @Override
    protected ObjectStreamClass readClassDescriptor() throws IOException, ClassNotFoundException
    {
        ObjectStreamClass resultClassDescriptor = super.readClassDescriptor();

        for (final String oldName : MIGRATION_MAP.keySet())
        {
            if (resultClassDescriptor.getName().equals(oldName))
            {
                String replacement = MIGRATION_MAP.get(oldName).getName();

                try
                {
                    Field f = resultClassDescriptor.getClass().getDeclaredField("name");
                    f.setAccessible(true);
                    f.set(resultClassDescriptor, replacement);
                }
                catch (Exception e)
                {
                    LOGGER.severe("Error while replacing class name." + e.getMessage());
                }

            }
        }

        return resultClassDescriptor;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:58:57.400

问题是 readClassDescriptor 应该告诉 ObjectInputStream 如何读取*当前*正在读取的流中的数据。如果你查看一个序列化的数据流，你会发现它不仅存储数据，而且还有很多关于存在哪些字段的元数据。这就是允许序列化处理简单字段添加/删除的原因。但是，当您覆盖该方法并丢弃从流返回的信息时，您将*丢弃*有关序列化数据中的哪些字段的信息。

我*认为*该问题的解决方案是获取 super.readClassDescriptor() 返回的值并创建一个*新*的类描述符，该描述符返回新的类名，否则返回旧描述符的信息。（虽然，在查看 ObjectStreamField 时，它可能比这更复杂，但这是一般的想法）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-08T21:57:05.570

这就是 writeReplace() 和 readResolve() 的用途。你让它变得比实际复杂得多。请注意，您可以在相关的两个对象中或在对象流类的子类中定义这些方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-30T16:23:15.937

我最近遇到了同样的问题，即 StreamCorruptedException 反序列化从一个包移动到另一个包的类的对象，然后通过添加新字段以兼容的方式演变。虽然@gaponov answer 最初解决了它，但我发现以下解决方案更合适，因为它不需要弄乱类名。使用 ObjectInputStreamAdapter 的类定义了映射，内部类 ObjectInputStreamAdapter 只重新定义了 resolveClass 方法：

```
 public class Deserializer {

    /*
     * Mapping that stores the specific new classes to use for old serialized
     * class names in order to transform old classes to the new ones for
     * compatibility reasons
     */
    private static final Map<String, Class<?>> classMapping = new HashMap<>();

    static {
        classMapping.put("com.example.old.SomeClass",
                SomeClass.class);
        classMapping.put("com.example.old.SomeClass2",
                SomeClass2.class);
    }

    public void deserialize(byte[] bytes) {
        try (ObjectInputStream o =
                new ObjectInputStreamAdapter(new ByteArrayInputStream(bytes))) {
            Object object = o.readObject();
            /* ... */
        } catch (Exception e) {
            throw new SerializationException("Cannot deserialize", e);
        }
    }

    /*
     * Adaptor that transform old classes to the new classes for compatibility
     * reasons
     */
    private class ObjectInputStreamAdapter extends ObjectInputStream {

        public ObjectInputStreamAdapter(InputStream in) throws IOException {
            super(in);
        }

        @Override
        protected Class<?> resolveClass(ObjectStreamClass desc)
                throws IOException, ClassNotFoundException {
            Class<?> klazz = classMapping.get(desc.getName());
            if (klazz != null) {
                return klazz;
            } else {
                return super.resolveClass(desc);
            }
        }

    }

} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-06-07T18:44:25.987

我对类描述符的修改还不够多，但是如果您的问题只是重命名和重新打包，那么有一个更简单的解决方案。您可以简单地使用文本编辑器编辑序列化数据文件，然后将旧名称替换为新名称。它以人类可读的形式存在。例如，假设我们将它`OldClass`放在里面`oldpackage`并包含一个`oldField`，如下所示：

```
package oldpackage;

import java.io.Serializable;

public class OldClass implements Serializable
{
    int oldField;
} 
```

现在，当我们序列化这个类的一个实例并得到这样的东西时：

```
¬í sr oldpackage.OldClasstqŽÇ§Üï I oldFieldxp 
```

现在，如果我们想将类的名称更改为`NewClass`并放入`newpackage`其中并将其字段的名称更改为`newField`，我只需将其重命名为文件，如下所示：

```
¬í sr newpackage.NewClasstqŽÇ§Üï I newFieldxp 
```

并为新类定义适当的 serialVersionUID。

就这样。无需扩展和覆盖。

# javascript - 如何知道哪个页面被重定向？在javascript中

> ID：10936628
> 
> 赞同：1
> 
> 时间：2012-06-07T17:14:53.860
> 
> 标签：javascript, jquery

如何确定重定向哪个页面？

我正在使用此代码，但这对我正在寻找的内容没有帮助：

```
 $(function () {             
        //var locate = window.location;
        //var t = window.location.hash;
        var pagename = location.pathname.substr(location.pathname.lastIndexOf("/") + 1, location.pathname.length).toLowerCase();
        if (pagename == "toppages.aspx") {
            $('#back_to_your_list').show();
        }
        else {
            $('#back_to_your_list').hide();
        }
    }); 
```

编辑：

所以，我的主页 ( `mydomain.com/employee/default.aspx`) 上有一个链接，一旦用户点击它，它就会重定向到另一个页面 ( `mydomain.com/employee/toppages.aspx`)，还有其他链接，并说用户点击了一个名为的链接`Background check`，这将重定向到另一个页面，这次该页面的 url 将是 ( `mydomain.com/employee/toppages.aspx?id=123`)

逻辑应该是。

如果页面来自`mydomain.com/employee/toppages.aspx?id=123`则`$('#back_to_your_list').show();`否则`hide`

我希望它有意义和困惑:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:26:10.370

如果您想知道点击链接到您的页面的页面是什么，只需使用引荐来源网址：[https ://developer.mozilla.org/en/DOM/document.referrer](https://developer.mozilla.org/en/DOM/document.referrer)

可能会指示浏览器阻止它。您自己的网站的不同（hackish）解决方案可能只是将页面存储在 localStorage 中：

```
 var lastPage;
   $(function() {
        var lastPage = localStorage['lastPage'];
        localStorage['lastPage'] = document.location.pathname;
   }); 
```

# list - 在 Haskell 中过滤无限列表

> ID：10936633
> 
> 赞同：5
> 
> 时间：2012-06-07T17:15:09.810
> 
> 标签：list, haskell

我有以下实现 Eratosthenes 筛的代码：

```
primes :: [Int]
primes = primes' [2..]

primes' :: [Int] -> [Int]
primes' [] = []
primes' (p:ps) = p:(primes' [p' | p' <- ps, not (p' `isMultiple` p)])

a `isMultiple` b = (a `mod` b) == 0

main = print (sum (primes' [2..100000])) 
```

我想将 main 更改为类似

```
main = print (sum [p | p <- primes, p < 100000])) 
```

毫不奇怪，这会挂起，因为它必须将 p 与无限列表素数的每个元素进行比较。既然我知道素数是按递增顺序排列的，那么一旦找到超过上限的元素，如何截断无限列表？

ps 理论上，primes' 过滤输入列表以返回素数列表。我知道如果我从 2 以外的地方开始列表会有一些问题。我仍在研究如何自己解决这个问题，所以请不要剧透。谢谢 ;-）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-06-07T17:20:02.220

在这种情况下，您知道一旦谓词为某个元素返回 false，它将永远不会为后面的元素返回 true，您可以替换`filter`为`takeWhile`，一旦谓词第一次返回 false，它将停止获取元素。

# java - 仅查找从特殊字符 java 开始的第一个单词

> ID：10936634
> 
> 赞同：0
> 
> 时间：2012-06-07T17:15:10.153
> 
> 标签：java, android, regex

我想在java中的字符串中找到唯一以“#”符号开头的第一个单词。符号和单词之间也不能有空格。

字符串“hi #how are # you”将输出为：

如何

我已经用正则表达式尝试了这个，但仍然找不到合适的模式。请帮助我。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:19:49.603

```
String str ="hi #how are # you";
if (str.contains("#")) {
        int pos = str.indexOf("#");

        while (str.charAt(pos + 1) == ' ')
            pos++;

        int last = str.indexOf(" ", pos + 1);

        str = str.substring(pos + 1, last);
        System.out.println(str);
    }
else{

} 
```

**输出：** 如何

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:22:03.287

尝试这个

```
replaceFirst("^.*?(#\\S+).*$", "$1"); 
```

不完全漂亮，但应该工作。

这假设字符串具有这样的标记。如果不是，那么您可能需要在提取令牌之前检查它是否与正则表达式匹配：

```
matches("^.*?(#\\S+).*$"); 
```

请注意，此方法将匹配`"#sdfhj"`.`"sdfkhk#sdfhj sdf"`

如果要排除这种情况，可以将正则表达式修改为`"^.*?(?<= |^)(#\\S+).*$"`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T17:37:46.767

我认为 xx#xx 是错误的词。我是真的试试这个（如果不是`"#(\\w+)"`在 Pattern 中使用，`m.group(1)`而是`m.group(2)`）

```
String str ="ab cd#ef #gh";
Pattern pattern=Pattern.compile("(^|\\s)#(\\w+)");
Matcher m=pattern.matcher(str);
if(m.find())
    System.out.println(m.group(2));
else
    System.out.println("no match found"); 
```

`"ab cd#ef #gh"`结果- >`gh`

`"#ab cd#ef #gh"`结果- >`ab`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T17:19:01.663

你可以试试这个正则表达式：

```
"[^a-zA-Z][\\S]+?[\\s]" 
```

除非您知道在这种情况下要从哪个特定字符开始

```
"#[\\S]+?[\\s]" 
```

# php - PHP PDO - 无法序列化或反序列化 PDO 实例

> ID：10936636
> 
> 赞同：6
> 
> 时间：2012-06-07T17:15:14.787
> 
> 标签：php, serialization, pdo, shopping-cart

我需要将 PDO 连接传递到一个`cart`类中`controller`，

```
function __construct($connection) 
{
    $this->cart = new cart($connection);
} 
```

但我认为问题在于`serialize()`

```
public function render_page() 
{

    if (!isset($_SESSION[SESSION_CART]))
    {
       $cart =  $this->cart;
    }
    else 
    {
       $cart = unserialize($_SESSION[SESSION_CART]);
    }

    $_SESSION[SESSION_CART] = serialize($cart); 

 } 
```

我得到这个错误，

> 致命错误：在 C:\wamp\www\store_2012_MVC\local\controllers\class_base_extended_cart.php:89 中未捕获的异常“PDOException”和消息“您无法序列化或反序列化 PDO 实例”堆栈跟踪：#0 [内部函数]：PDO- >__sleep() #1 C:\wamp\www\store_2012_MVC\local\controllers\class_base_extended_cart.php(89): 序列化（对象（购物车））#2 C:\wamp\www\store_2012_MVC\local\controllers\class_factory。 php(75): base_extended_cart->render_page() #3 C:\wamp\www\store_2012_MVC\index.php(69): factory->render() #4 {main} 在 C:\wamp\www\store_2012_MVC 中抛出\local\controllers\class_base_extended_cart.php 第 89 行

我怎样才能解决这个问题？

或者我可以用别的东西代替`serialize()`吗？

**编辑：**

我用魔法方法试过了， `__sleep`但`__wakeup`仍然得到同样的错误，

```
class database_pdo
{
    # database handler
    protected $connection = null;

    # make a connection
    public function __construct($dsn,$username,$password)
    {
        try 
        {

            $this->connection = new PDO($dsn, $username, $password, array(PDO::MYSQL_ATTR_INIT_COMMAND => "SET NAMES utf8"));
            $this->connection->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 

        }
        catch (PDOException $e) 
        {
            # call the get_error function
            $this->get_error($e);
        }
    }

    # don't forget to add getter method to get $this->connection, it's just a good practice.
    public function get_connection()
    {
        return $this->connection;
    }

    public function __sleep()
    {
        return array('connection');
    }

    public function __wakeup()
    {
        $this->connection;
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T17:35:09.423

PDO 对象包含到数据库的活动链接（可能有一个事务启动或数据库会话设置和变量）。

您不能序列化 PDO 对象，因为上述内容会丢失并且无法自动重新建立。

您应该重新设计您的类以使用单独的类（专用于保持数据库连接）静态访问当前数据库链接，而不是在成员变量中保存引用（我假设当您执行 new cart($connection) 时会发生这种情况） .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:23:27.857

看看 __sleep 和 __wakeup 魔术方法。 [http://us.php.net/manual/en/language.oop5.magic.php#object.sleep](http://us.php.net/manual/en/language.oop5.magic.php#object.sleep)

它们允许您指定哪些属性被序列化，哪些被忽略。问题是您需要定期传入 PDO 对象的实例。

# jquery - 对多个 RadioButtonList 使用 Image Tick jQuery

> ID：10936643
> 
> 赞同：1
> 
> 时间：2012-06-07T17:15:55.903
> 
> 标签：jquery, jquery-selectors

我正在使用这个非常酷的库来修改传统的 RadioButtonLists。
[Image Tick V 2.0](http://boedesign.com/blog/2008/06/08/imagetick-for-jquery/)
但是我如何使用它来播放多个 RadioButtonList，如下所示

```
O option1 (Checked)
O option2
O option3
O option4

O option1 (checked)
O option2
O option3
O option4 
```

尝试使用不同的“名称”和“id”属性。到目前为止能够呈现两个列表，但是在单击它们之后（这里是第一个列表上的 Option3），列表开始充当一个列表，如下所示

```
O option1 
O option2
O option3 (checked)
O option4

O option1 
O option2
O option3
O option4 
```

就像脚本开始将两个列表视为一个列表一样。有什么方向可以继续前进吗？
**更新了我的小提琴链接**
[http://jsfiddle.net/skriyas/mctcs/236/](http://jsfiddle.net/skriyas/mctcs/236/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T18:00:11.643

根据图像勾选示例。只需确保您按名称对单选输入按钮进行分组。然后在脚本中你应该有这样的代码。

```
$("input:radio").imageTick({ // target all the radio buttons instead of selecting by name
    tick_image_path: "images/radio.gif",  // the image you want to use as a selected state of the radio/checkbox
    no_tick_image_path: "images/no_radio.gif", // image you want to use as a non selected state
    image_tick_class: "radios" // the class you want to apply to all images that are dynamically created
}); 
```

在他们的示例中，他们按名称选择单选元素，因此如果您复制该代码，则必须为每个组多次复制/粘贴代码

编辑：

在您的脚本中，您没有检查它们是否在同一组中。我已经用检查更新了这里的小提琴，它现在应该可以工作了。使用过滤器可能有更好的方法，但我还不太擅长。
[http://jsfiddle.net/mctcs/237/](http://jsfiddle.net/mctcs/237/)

```
$("#tick_img_"+id).click(function(){
            var thisGroup=$(this).next('input').attr('name');   // This is the clicked group         
                $("." + opt.image_tick_class).each(function() { 
                    if($(this).next('input').attr('name') === thisGroup){ // check to only modify clicked gruop
                    //console.log($(this).attr('name'));
                    var r = this.id.split("_");
                    var radio_id = r.splice(2,r.length-2).join("_");
                    $(this).attr('src', no_tick_image_path(radio_id));
                    }
                });
                $("#" + id).trigger("click");

                $(this).attr('src', tick_image_path);

 }); 
```

# sql-server-2005 - 为什么 SQL Server 2005 上的页面预期寿命为 0（零）

> ID：10936645
> 
> 赞同：0
> 
> 时间：2012-06-07T17:16:10.620
> 
> 标签：sql-server-2005, memory, buffer

我们一直想知道我们的 SQL Server 的页面预期寿命。因此，我们使用 Perform 查看计数器。该值为零并且永远不会改变。我认为一定有一些错误，所以我检查了 SQL Server DMV 查询

```
SELECT [object_name],[counter_name],[cntr_value]
FROM sys.dm_os_performance_counters
WHERE [object_name] LIKE '%Manager%'
AND [counter_name] = 'Page life expectancy' 
```

这也返回零，一整天。

为了使这更有趣，我们检查了“缓冲区缓存命中率”计数器，它的平均值约为 99-100。

那么，当“缓冲区高速缓存命中率”为 100 时，页面预期寿命如何为零？

我们缺少什么？如果它始终为零，这对我来说意味着缓冲区缓存中没有任何内容，如果缓冲区缓存命中率为 100，这似乎不正确？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-14T16:12:38.810

可能是未正确安装的性能计数器。在应用程序事件日志中查找一条消息，说明缺少哪些计数器。您可能必须使用 unlodctr/lodctr 命令重新加载它们，然后重新启动 SQL。

# java - 在 SuSE Enterprise Server 10 中发现运行 Jar 的路径

> ID：10936648
> 
> 赞同：1
> 
> 时间：2012-06-07T17:16:16.207
> 
> 标签：java, jar, path, executable-jar

我已经尝试过相关线程中发布的方法（获取受保护域等），但是当 Jar 在 SuSE Linux Enterprise Server 10 中运行时，返回的字符串只是一个点 (.)，表示当前工作目录。

我有一个 jar，它需要本地库来获取已经在运行用于生产的 java 应用程序的服务器上的系统信息（所以我不相信我可以在不发生坏事的情况下弄乱 java.library.path）。

我希望我能发现正在运行的 jar 的路径，以便我可以使用该字符串来形成 System.load("my/path/to/native/libs") 语句，因为我知道这是可行的。尝试将 System.loadLibrary 用于相对路径失败 - 本机库位于我正在部署的 java 应用程序的根目录中。

这是我从[另一个线程](https://stackoverflow.com/questions/320542/how-to-get-the-path-of-a-running-jar-file)尝试的方法之一：

```
 File fl = new File(SystemInfoGrabber.class.getProtectionDomain().getCodeSource().getLocation().getPath());
        System.out.println(fl.getPath()); 
```

这会在 SuSE 中返回句点 (.)

# node.js - 企业、企业用户和用户的 Mongodb/Mongoose 模式

> ID：10936649
> 
> 赞同：0
> 
> 时间：2012-06-07T17:16:37.507
> 
> 标签：node.js, mongodb, mongoose

我正在尝试构建一个拥有企业、企业用户和用户的应用程序。我想出了这些模式/模型。

```
var enterpriseSchema = new Schema({
    enterpriseId            :    ObjectId,
    enterpriseName          :    {type: String, index: true},
    enterpriseUsers         :    [enterpriseUserSchema],
    owner                   :    {type: ObjectId, ref: 'User'}
});

var enterpriseUserSchema = new Schema({
    user                    :    {type: ObjectId, ref: 'User'},
    role                    :    {type: String, index: true},
    lastAccess              :    Date
});

var userSchema = new Schema({
    userId                  :    ObjectId,
    givenName               :    String,
    middleName              :    String,
    familyName              :    String,
    username                :    { type: String, unique: true, index: true },
    password                :    String,
    enterprise              :    {type: ObjectId, ref: 'Enterprise'}
});

var User = mongoose.model('User', userSchema);
var Enterprise = mongoose.model('Enterprise', enterpriseSchema); 
```

请注意 enterpriseUsersSchema。这似乎是引用企业用户的合理方式。是这样，还是有更好的方法？

如果我使用这些模式/模型，我将如何填充企业的用户？我需要每个用户的 givenName、familyName 和角色。我已经尝试填充，但我无法确定如何填充给定企业用户架构的用户。

# magento - Magento 1.7 缩略图不显示

> ID：10936652
> 
> 赞同：0
> 
> 时间：2012-06-07T17:16:50.880
> 
> 标签：magento

在 magento 主题的顶部栏上构建迷你车。需要在 minicart 中显示产品缩略图和名称。我在目录“checkout/cart”中创建了一个文件 top_cart.phtml。使用下面给出的代码。

```
<?php 

$_cartQty = $this->getSummaryCount();
$session = Mage::getSingleton('checkout/session');
if ($_cartQty == 0) : ?>
    <span class="titleBlock">Your shopping cart is empty.</span>
<?php else : 
    foreach($session->getQuote()->getAllItems() as $_item): ?>
    <div>
        <span><?php echo $_item->getThumbnailImage(); ?></span>
        <span><?php echo $_item->getName(); ?></span>
    </div>
    <?php endforeach ?>
<?php endif;?>  
?> 
```

现在名称显示正确，但未显示缩略图。请指导。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T18:59:35.617

您需要从产品而不是购物车项目中获取图像 url。尝试以下操作：

```
<img src="<?php echo $_item->getProduct()->getThumbnailUrl() ?>" alt="<?php echo $_item->getName() ?>" /> 
```

或者，如果您要调整图像大小或对其进行其他操作，请使用目录/图像助手。这是获取图像并调整其大小的示例：

```
<img src="<?php echo $this->helper('catalog/image')->init($_item->getProduct(), 'thumbnail')->resize(50); ?>" alt="<?php echo $_item->getName() ?>" /> 
```

# vb.net - 通用 OrderBy 函数

> ID：10936653
> 
> 赞同：1
> 
> 时间：2012-06-07T17:16:51.927
> 
> 标签：vb.net, linq, sql-order-by

我有一个包含很多列的网格视图，所有列都需要排序。我已经看到了一些片段，但我无法让它们中的任何一个与我的示例一起使用。这是我到目前为止所拥有的。

```
 Protected Sub gvSearch_OnSorting(ByVal sender As Object, _
                                   ByVal e As GridViewSortEventArgs)

    If Not Session("sort") Is Nothing Then
        Dim strView = Session("sort").ToString()
        gvSearch.DataSource = ApplySorting(Session("grid"), , "ASC")
    End If
End Sub 
```

我在一个帖子中找到了这个，但我不确定要作为表达式输入什么

```
Private Function ApplySorting(Of T, U)( _
    query As IQueryable(Of T), _
    predicate As Expression(Of Func(Of T, U)), _
    order As String) As IQueryable(Of T)

    Dim ordered = TryCast(Query, IOrderedQueryable(Of T))
    If order = "ASC" Then
        If ordered IsNot Nothing Then
            Return ordered.ThenBy(predicate)
        End If
        Return query.OrderBy(predicate)
    Else
        If ordered IsNot Nothing Then
            Return ordered.ThenByDescending(predicate)
        End If
        Return query.OrderByDescending(predicate)
    End If
End Function 
```

结束类

我知道实际订单看起来像

```
Dim GridValues As List(Of spSearchResult2Result)
GridValues = db.spSearchResult2().ToList()
GridValues.OrderBy(Function(x) x.CreateUserID) 
```

对 ApplySorting 的调用将包含 e.SortExpression，但我不知道如何将其放入其中。任何帮助，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:33:58.863

表达式是

```
Function(x) x.CreateUserID 
```

* * *

```
gvSearch.DataSource = _
    ApplySorting(Session("grid"), Function(x) x.CreateUserID, "ASC") 
```

# java - 如何在（基于 Java 的）TCP 中处理多个客户端？

> ID：10936654
> 
> 赞同：1
> 
> 时间：2012-06-07T17:16:59.320
> 
> 标签：java, networking, tcp, client-server, nio

我觉得这些可能是基本主题，但我在其他地方找不到简洁的答案。

在构建 TCP 服务器时，我的理解是每个连接的客户端都必须连接到自己的端口以保持合理的连接性（例如，要知道*该*消息来自*该*客户端）。

如何设置？我假设你有一个列表和一个人们连接到的专用“入口点”套接字。连接的 Socket 会找到一个空闲端口，回复端口号，并在该端口上设置一个新的 Socket 侦听。这听起来对吗？

如果是这种情况，在我看来，条目 Socket 在侦听传入连接时需要阻塞。这个阻塞读取是在单独的线程上完成的吗？

附加的附带问题：我真的只需要一些简单的消息传递来实现我想要试验的基本 Java 游戏。像 Netty 这样的东西对于这个特殊的核桃应用程序来说似乎是一把大锤。我是否最好使用 Java 标准库编写一些漂亮且轻量级的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:22:37.870

主套接字被称为“母套接字”，你阻塞它等待新的连接。当一个新的连接发生时，你使用`accept()`为新客户端创建一个新套接字的方法。

您可以使用`Selector`. 您将选择器配置为侦听母套接字以及您创建的任何其他套接字。这样，您可以让一个线程监听所有传入的通信。如果新的通信在母套接字上，则接受连接并生成一个新的套接字并将其添加到选择器中。如果新的通信在其他套接字之一上，那么您可以适当地处理该消息。

我总是编写自己的网络代码。这是一次有用的学习经历，但您也确切地知道这些事情在做什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:27:36.577

客户端继续使用相同的 TCP 目标端口。TCP 堆栈根据 IP 地址和*源*端口（由客户端随机选择）处理多个连接。不过，您实际上并不需要为此担心。请参阅 Oracle Java IO 教程，了解如何处理将连接移交给单独的线程，它们相当不错。

# flexslider - Flexslider IE 问题 - 在活动图像下方加载图像

> ID：10936655
> 
> 赞同：1
> 
> 时间：2012-06-07T17:17:04.517
> 
> 标签：flexslider

我遇到了 Flexslider 在 Internet Explorer 中无法正常运行的问题 - 它在 Firefox、Chrome 和 Safari 中运行良好。

当页面加载时，它会加载第一张图片。但是，下一个图像会出现在当前打开的下方，因为它会淡出然后跳起来。

您可能最好亲眼目睹它的实际应用。

[http://www.philippacraddock.com/index_test.html](http://www.philippacraddock.com/index_test.html)

惹恼了我（这些年来我浪费了多少时间来迎合 Internet Explorer 的宝贵弱点......）所以任何帮助都将不胜感激。

提前喝彩。

# android - 在 android 和 visual-c++ 之间使用 google protobuf 进行 int32 解码

> ID：10936656
> 
> 赞同：1
> 
> 时间：2012-06-07T17:17:21.817
> 
> 标签：android, sockets, visual-c++, encoding, protocol-buffers

我在通过 tcp 套接字通信 protobuf 时遇到问题，客户端在 Android 模拟器（运行 eclipse + ADP + SDK android-15）和 C++ 中的服务器（Visual Studio 2010）中工作，两者都在 Windows 7 上。Protobuf 版本：2.4 .1

**.proto**

```
package pck;

option java_package = "my.messages.package";
option java_outer_classname = "ClassName"; 
option optimize_for = LITE_RUNTIME; 

message msg_name {
    optional int32 VARIABLE = 6;
    //moro...
    } 
```

**客户端：安卓端**

```
msg_name outMsg = to_send.build();
ByteArrayOutputStream output = new ByteArrayOutputStream();
outMsg.writeTo(output);
//now output.toString() is sent via tcp socket... 
```

我得到的，我在这里问的原因是：通信正常，消息到达服务器端点，但是 int32 变量的值如下：

（在 android 上发送的值 ->> 在 vi​​sual-c++ 端读取的值）

*   android: [0, 127] ->> visual-c++: [0, 127] 工作正常，好的。
*   机器人：[128, 255] -->> visual-c++：3104751
*   安卓：[256, 383] -->> visual-c++：5201903
*   ...

那么，这是编码的问题吗？我在客户端 android 端的 protobufs 有问题吗？（我必须说这是我在 android 上的第一天，opss！）

# facebook - 自定义监视操作被拒绝，找不到解决方法

> ID：10936660
> 
> 赞同：1
> 
> 时间：2012-06-07T17:17:43.990
> 
> 标签：facebook, facebook-opengraph, custom-action, watch, built-in

我的网站允许用户创建股票监视列表。在该站点中，该操作称为“添加到监视列表”。我希望这可以创建一个名为“观看”的 FB 开放图形操作，但我认为这是不可能的，因为观看是只能在视频对象上使用的内置操作。因此，我一直收到 FB 的拒绝，内容如下：

> 您的操作不符合标准：您正在尝试提交不允许的自定义操作。请删除此操作并提交此操作的内置版本。

我不能使用内置，因为我需要将它连接到我的自定义“Stock”对象。我已经尝试以我能想到的各种方式重命名动作及其动词变位（“添加到监视列表”、“跟踪”等），但至少被拒绝了 5 次。我已经没有想法了。

我试图在[FB](https://developers.facebook.com/docs/opengraph/actions/builtin/#watch)和这里 ( [1](http://facebook.stackoverflow.com/questions/10619464/create-read-action-as-custom-one) [2](http://facebook.stackoverflow.com/questions/10933574/custom-watch-action) [3](http://facebook.stackoverflow.com/questions/10853993/how-can-i-extend-fbs-built-in-open-graph-action-type-watch/10858333#10858333) ) 上找到答案，但到目前为止还没有找到可行的解决方案。我认为 FB 一定不喜欢这个动作在网站本身中被称为“观看”的事实，因此我必须使用内置的。我宁愿不重做我网站的重要部分，因为它可能会让 FB 的评论者高兴，所以任何其他想法都会受到赞赏。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T18:24:39.580

从头开始将自定义操作重新创建为“跟踪”（删除原始操作，创建一个新操作，以应用程序管理员身份发布共享活动，然后使用相同的操作说明重新提交）最终导致获得批准的自定义操作。

# mysql - 带有 IF 条件的 MySQL WHERE

> ID：10936663
> 
> 赞同：0
> 
> 时间：2012-06-07T17:17:50.130
> 
> 标签：mysql, where, conditional-statements

如果 WHERE 子句不起作用，谁能帮我解释一下为什么？什么是替代解决方案？

```
SELECT jq.jobid
  FROM jobqueue jq
  LEFT JOIN taskslogs tl
    ON jq.taskqueueid=tl.taskqueueid
  LEFT JOIN (SELECT p1.taskID,p1.processingType
               FROM projecttask p
               LEFT JOIN projecttask p1
                 ON p.sequenceNo=p1.nextTaskSequence
                AND p.projectID=p1.projectID
              WHERE p.taskID=paramTaskID) prevTask
    ON tl.taskID=prevTask.taskID
 WHERE IF(prevTask.processingType='BATCH',jq.batchid!=0,IF(prevTask.processingType='DOCGROUP',jq.documentgroupid!=0,TRUE))
 GROUP BY jq.jobid 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:20:43.660

也许是这样的：

```
WHERE 
    (prevTask.processingType='BATCH' AND jq.batchid!=0)
    OR (prevTask.processingType='DOCGROUP' AND jq.documentgroupid!=0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:22:47.137

我认为您不能在查询中使用 IF 语句。更多的是程序。

您可能应该看看 using case 语句。

[http://dev.mysql.com/doc/refman/5.0/en/case-statement.html](http://dev.mysql.com/doc/refman/5.0/en/case-statement.html)

# java - 如何使 JSONObject 忽略“null”的特殊含义并将其打印为文字 null

> ID：10936670
> 
> 赞同：2
> 
> 时间：2012-06-07T17:18:31.620
> 
> 标签：java, json

我在用`net.sf.json.JSONObject`

```
JSONObject obj = new JSONObject();
obj.put("id", "null");
System.out.println(obj.toString()); 
```

输出是

```
{"id":null} 
```

我希望在输出中引用 null 作为文字`"null"`

```
{"id":"null"} 
```

因为`null, true, false`是关键字，这是`JSONObject`将其转换为字符串时的处理方式。我试过 `obj.put("id", "\"null\"");`了 - 结果还是一样

`null`如果我可以将其打印为文字而不是使其成为 json ，我们有一些遗留代码将很容易流入`null`。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:41:17.387

看起来这是您正在使用的 JSON 库的实现的一个错误。

一个简单的解决方案是切换到实际工作的 JSON 库。

我正在使用这 2 个 JSON 库，我会向您推荐：

1.  [json-简单](http://code.google.com/p/json-simple/)
2.  [json-智能](http://code.google.com/p/json-smart/)

这两个库都按照您的实现的要求使用字符串“null”值工作。我用示例代码测试了两者：

```
JSONObject obj = new JSONObject();
obj.put("test", "null");

// Both libraries print out {"test":"null"}
System.out.println(obj.toJSONString()); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-07T17:41:55.197

使用 JsonWriter 类方法 WriteNull。

参考：http: [//msdn.microsoft.com/en-us/library/bb299886.aspx](http://msdn.microsoft.com/en-us/library/bb299886.aspx)

# html - 如何通过没有 og 标签的 Facebook 按钮传递元描述？

> ID：10936673
> 
> 赞同：2
> 
> 时间：2012-06-07T17:18:47.290
> 
> 标签：html, facebook, facebook-like, meta-tags

是否可以在不使用 og 标签的情况下通过 Facebook like 按钮传递元描述？ [http://developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)

我目前有这个标签

```
<meta name="description" content="description here" /> 
```

但我无权将其更新为

```
<meta property="og:description" content="description here" /> 
```

我想传递“这里的描述”以及标题和 URL。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T18:21:52.557

你考虑过 JavaScript SDK 吗？具体来说，值得一看 FB.ui，它可用于创建与类似插件相同的界面，但您可以配置所有字段。更多信息请访问[http://developers.facebook.com/](http://developers.facebook.com/)

# c# - 页面生命周期和文本框

> ID：10936674
> 
> 赞同：0
> 
> 时间：2012-06-07T17:18:49.660
> 
> 标签：c#, asp.net, pageload

在此处输入代码当下拉列表更改带有自动回发的项目时，我会创建动态文本框。后来我想在激活提交按钮时获取文本框的文本。但是当按钮激活时，文本框返回空白字符。问题一定是由于页面寿命。我应该使用什么技术来获得这些值？

```
 public class GuiOtherAuthors
    {
        public OtherAuthors[] tableOtherAuthors;
        public Label[] lblName;
        public TextBox[] txtName;
        public Label[] lblSurname;
        public TextBox[] txtSurname;
        public Label[] lblInstitution;
        public TextBox[] txtInstitution;
        public Label[] lblCountry;
        public TextBox[] txtCountry;
        public Label[] lblEmail;
        public TextBox[] txtEmail;
        public PlaceHolder PlaceHolder1 = new PlaceHolder();

        public Int32 NumberOfAutherOthos { set; get; }

        public void InitializeControls()
        {
            tableOtherAuthors = new OtherAuthors[NumberOfAutherOthos];
            lblName = new Label[NumberOfAutherOthos];
            txtName = new TextBox[NumberOfAutherOthos];
            lblSurname = new Label[NumberOfAutherOthos];
            txtSurname = new TextBox[NumberOfAutherOthos];
            lblInstitution = new Label[NumberOfAutherOthos];
            txtInstitution = new TextBox[NumberOfAutherOthos];
            lblCountry = new Label[NumberOfAutherOthos];
            txtCountry = new TextBox[NumberOfAutherOthos];
            lblEmail = new Label[NumberOfAutherOthos];
            txtEmail = new TextBox[NumberOfAutherOthos];

            for (int i = 0; i < NumberOfAutherOthos; i++)
            {
                lblName[i] = new Label();
                lblName[i].Text = "Name:";
                txtName[i] = new TextBox();
                lblSurname[i] = new Label();
                lblSurname[i].Text = "Surname:";
                txtSurname[i] = new TextBox();
                lblInstitution[i] = new Label();
                lblInstitution[i].Text = "Institution:";
                txtInstitution[i] = new TextBox();
                lblCountry[i] = new Label();
                lblCountry[i].Text = "Country:";
                txtCountry[i] = new TextBox();
                lblEmail[i] = new Label();
                lblEmail[i].Text = "Email:";
                txtEmail[i] = new TextBox();
            }

        }
        public PlaceHolder makeGUI()
        {
            int i = 0;
            int j = 1;

            for (i = 0; i < NumberOfAutherOthos; i++)
            {
                Label authorInformation = new Label();
                authorInformation.Text = "Information for Author " + j.ToString() + " :";
                lblName[i].Text = "Name:";
                lblSurname[i].Text = "Surname:";
                lblInstitution[i].Text = "Institution:";
                lblCountry[i].Text = "Country:";
                lblEmail[i].Text = "Email:";

                PlaceHolder1.Controls.Add(new LiteralControl("<table>"));
                PlaceHolder1.Controls.Add(new LiteralControl("<span style=\"font-weight:bold;\" "));
                PlaceHolder1.Controls.Add(authorInformation);
                PlaceHolder1.Controls.Add(new LiteralControl("</span>"));
                PlaceHolder1.Controls.Add(new LiteralControl("<tr><td>"));
                PlaceHolder1.Controls.Add(lblName[i]);
                PlaceHolder1.Controls.Add(new LiteralControl("</td><td>"));
                PlaceHolder1.Controls.Add(txtName[i]);
                PlaceHolder1.Controls.Add(new LiteralControl("</td></tr>"));
                PlaceHolder1.Controls.Add(new LiteralControl("<tr><td>"));
                PlaceHolder1.Controls.Add(lblSurname[i]);
                PlaceHolder1.Controls.Add(new LiteralControl("</td><td>"));
                PlaceHolder1.Controls.Add(txtSurname[i]);
                PlaceHolder1.Controls.Add(new LiteralControl("</td></tr>"));
                PlaceHolder1.Controls.Add(new LiteralControl("<tr><td>"));
                PlaceHolder1.Controls.Add(lblInstitution[i]);
                PlaceHolder1.Controls.Add(new LiteralControl("</td><td>"));
                PlaceHolder1.Controls.Add(txtInstitution[i]);
                PlaceHolder1.Controls.Add(new LiteralControl("</td></tr>"));
                PlaceHolder1.Controls.Add(new LiteralControl("<tr><td>"));
                PlaceHolder1.Controls.Add(lblCountry[i]);
                PlaceHolder1.Controls.Add(new LiteralControl("</td><td>"));
                PlaceHolder1.Controls.Add(txtCountry[i]);
                PlaceHolder1.Controls.Add(new LiteralControl("</td></tr>"));
                PlaceHolder1.Controls.Add(new LiteralControl("<tr><td>"));
                PlaceHolder1.Controls.Add(lblEmail[i]);
                PlaceHolder1.Controls.Add(new LiteralControl("</td><td>"));
                PlaceHolder1.Controls.Add(txtEmail[i]);
                PlaceHolder1.Controls.Add(new LiteralControl("</td></tr>"));
                PlaceHolder1.Controls.Add(new LiteralControl("</table><br /> "));
                j++;
            }
            return PlaceHolder1;

        }
    }

The code is in c#
Thanks

 this is my page load:

    private GuiOtherAuthors gui = new GuiOtherAuthors();

    protected void Page_Load(object sender, EventArgs e)
    {

        if (IsPostBack)
        {
            numberOfOtherAuthors = NumberOfOtherAuthors();
            if (!numberOfOtherAuthors.Equals(0))
            {
                gui.NumberOfAutherOthos = numberOfOtherAuthors;
                gui.InitializeControls(); //Initialize the textboes
                Panel1.Controls.Add(gui.makeGUI()); .. create my gui 
                setValueofOtherAuthors(numberOfOtherAuthors); //create object with value of textboxes
            }
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:33:05.370

这不是我的想法，所以我可能有错误的事件，但是在 Page_Init(?) 中，您需要添加任何动态添加的控件，以便在余下的回发周期中获得它们的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:21:25.563

在生命周期的 Page_Init() 处理程序的早期添加控件，并在生命周期的 OnPreRender 处理程序的后期获取文本框值。

# javascript - armv6l 上的流星（树莓派）

> ID：10936675
> 
> 赞同：8
> 
> 时间：2012-06-07T17:18:53.793
> 
> 标签：javascript, node.js, arm, meteor, raspberry-pi

我喜欢流星的外观，以前从未尝试过，认为它会为我的树莓派上的网络仪表板提供一个很好的平台。尝试了推荐的安装程序并得到了这个：

```
$ curl install.meteor.com | /bin/sh
Unable to install Meteor on unsupported architecture: armv6l
Installation failed. 
```

好吧，我不会躺下的！我将尝试手动安装它，但有人尝试过/失败/成功了吗？有小费吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T18:47:59.527

显然，现在有 raspi 的预构建包。唉，我很久以前就失去了兴趣——这里预建包的详细信息：http: [//meteor-universal.tumblr.com/](http://meteor-universal.tumblr.com/)

（感谢@Archonic - 请参阅下面的评论 - 如果您想让它成为一个真正的答案，我很乐意更改这个问题的公认答案。）

我将保留下面的文字以供参考。

* * *

（随着我的进展不断更新......）

注意：我在股票 debian 映像上执行此操作，尽管在安装了 ruby​​、passenger 和 padrino（以及它们的所有依赖项）之后。Archlinux 可能更容易，我不知道。

1.  安装 node.js

    默认情况下不起作用，请[按照此处的说明进行操作](http://blog.tomg.co/post/21322413373/how-to-install-node-js-on-your-raspberry-pi)

2.  结帐流星

    ```
    git clone git://github.com/meteor/meteor.git 
    ```

3.  修改 admin/generate-dev-bundle.sh

    本质上，删除有关构建 node.js 的所有说明，以及对 tempdir 的所有引用，因此您最终只安装节点包。一旦一切都弄清楚了，我会发布我的要点......

    然后，在一个空文件夹中运行它

4.  安装mongodb。从源头。

    cd 到解压目录，然后使用 scons 安装

    ```
    sudo apt-get install scons libboost-all-dev
    scons libboost-dev libpcre++-dev xulrunner-1.9.1-dev 
    ```

（注意：我很快就会完成这个。我认为诀窍可能是使用流星的捆绑功能 - 特别是大红框[http://docs.meteor.com/#deploying](http://docs.meteor.com/#deploying) - 但不幸的是我的 pi 已经崩溃了，我远离家乡。如果您发现有效，请发布，我会相应地更新此答案或接受您的答案）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-09-09T22:19:26.723

你可以在 github 上找到一个名为[Meteor Universal fork](https://github.com/4commerce-technologies-AG/meteor)的流星叉。对于 ARM 和 BSD 等尚未受支持的架构，它有一个随时可用的安装程序。

对于安装只需运行：

```
cd $HOME

git clone --depth 1 https://github.com/4commerce-technologies-AG/meteor.git 
```

然后获取二进制文件并通过以下方式完成安装：

```
$HOME/meteor/meteor --version 
```

> 第一次运行上述命令将尝试下载兼容的预构建 dev_bundle 并完成安装。根据您的硬件，这可能需要一些时间。

# javascript - 我应该如何将用户名和密码发送到服务器？

> ID：10936682
> 
> 赞同：0
> 
> 时间：2012-06-07T17:19:31.067
> 
> 标签：javascript, security, node.js, passwords

我正在构建一个游戏，玩家可以为其创建帐户，你知道的，标准方案。但是，我只想在服务器端（Node.js）和客户端都依赖 Javascript。

我与服务器的主要通信方式通常是 Socket.io，我猜以明文形式发送密码不是一个好主意——但我不知道为什么！我的意思是，有人可以嗅探交通吗？这到底是怎么发生的？最重要的是，这个问题的解决方案是什么？

我知道我需要将密码保存为服务器端的哈希值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:27:39.737

简短的回答是通过[创建您自己的 SSL 证书来](http://www.akadia.com/services/ssh_test_certificate.html)[使用 HTTPS](http://silas.sewell.org/blog/2010/06/03/node-js-https-ssl-server-example/)。

直到 2008 年，甚至 GMail 也没有一直[使用 HTTPS](http://gmailblog.blogspot.com/2008/07/making-security-easier.html)的选项。我一直很惊讶我们仍然不关心安全性。

说到这，对你的散列密码加盐。加盐很容易......选择一个词，任何词。将其附加到密码并对其进行哈希处理。(ie SHA1(password .mysalt))[最近有些人遇到了一些麻烦](http://news.yahoo.com/linkedin-eharmony-passwords-leaked-online-025345760--finance.html)。添加一点'o盐至少可以防止简单的彩虹攻击。

# mysql - MySQL 查询确实计数然后显示附加数据

> ID：10936684
> 
> 赞同：0
> 
> 时间：2012-06-07T17:19:35.580
> 
> 标签：mysql, sql

当前的查询效果很好，可以让我计算出每条记录和办公室名称在表中出现的次数和办公室。如何扩展此查询以首先显示 Office 和 Count 就像它现在一样，然后在与 Office 匹配的每条记录的计数下方显示列 lastName、Phone，然后移动到下一个 Office 和 Office(Count) 并显示那些姓氏，电话记录等等？这在 MySQL 中可能吗？

```
SELECT Office, COUNT(Office) AS c 
FROM Active 
GROUP BY Office 
HAVING COUNT(Office) >= 5  ORDER BY c DESC 
```

例子：

办公室1 | 2

办公室1 | 姓氏 | 电话

办公室1 | 姓氏 | 电话

办公室2 | 3

办公室2 | 姓氏 | 电话

办公室2 | 姓氏 | 电话

办公室2 | 姓氏 | 电话

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:24:50.647

您可以尝试使用 MySQL 的[UNION](http://dev.mysql.com/doc/refman/5.0/en/union.html)，但列数和列名必须相同。

总的来说，这似乎是一种错误的做法。尝试重新考虑不需要这种输出的逻辑。

我建议只接收姓氏和电话，并缓存结果，然后解析它们。COUNT(*) 在技术上是冗余信息，因为具有相同 Office 的行数已经描述了这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:31:19.113

不，你不能那样做。您最好的选择是`UNION`，但您必须具有相同数量的列和列类型，这与您的条件不匹配。

你为什么不试试

```
SELECT Office, lastName, Phone FROM Active ORDER BY Office 
```

并在您的编程语言中，解析行并使用计数器变量来计算相同的`Office`记录，并构建您自己的表。

编辑：您说它用于直接导出到电子表格。您可以在两个查询中执行此操作：执行您的 count() 查询，然后执行我上面的查询。导出两个结果并根据需要将它们混合到电子表格中。嘿，它完成了工作。

# jquery - 从字符串jQuery中提取前n个单词，jQuery中的Wordpress样式摘录（x字数

> ID：10936690
> 
> 赞同：4
> 
> 时间：2012-06-07T17:20:07.840
> 
> 标签：jquery, wordpress, extract

我有一个可以工作的 jQuery 片段，但是为了改进我的 JS，我想要关于如何提高其效率的建议。

此功能缩短了 WordPress 摘录。它采用原始的 WordPress 摘录并提取前 40 个单词，这是我关心的部分。之后，它会在原始摘录的末尾添加“继续阅读”链接，并将其添加到截断版本的末尾。

同样，我只是想知道返回截断摘录的更快/更简洁的方法是什么。我尝试了“切片”并得到了一堆逗号。

```
jQuery('.page-id-7 .promo_slider_excerpt').each(function (i) {
    var s = jQuery(this).html();
    var sw = s.split(' '); // separate contents into array of words
    var t = [];
    var v;
    if (sw.length > 40) {
        var a = jQuery(this).children('a'); // this is the Continue Reading link
        for (v = 0; v < 40; v++) {
            t = (t + ' ' + sw[v]); // Build the shortened excerpt (this is the part I wanted to improve)
        }
        t = (t + ' ' + a[0].outerHTML); // Add the Continue Reading onto the end
        jQuery(this).html(t);
    } else {
        t = s;
        jQuery(this).html(t);
    }
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-07T17:31:30.983

对于前四十个单词和继续阅读链接，我建议：

```
var s = jQuery(this).text(),
    fortyWords = s.split(' ').slice(0,39).join(' '),
    link = document.createElement('a'),
    linkText = document.createTextNode('continue reading');
link.href = 'http://path.to.article/';
link.appendChild(linkText);
$(this).text(fortyWords).append(link); 
```

[JS Fiddle 概念证明](http://jsfiddle.net/davidThomas/BqQF8/)。

* * *

**针对 OP 提出的进一步问题进行了编辑**（在下面的评论中）：

> 1：Firebug 中有没有办法记录一种技术与另一种技术的效率？IOW：您的示例看起来不错，但是我可以将它的内存和速度与我的 for 循环进行比较吗？

我真的不知道，恐怕我根本不使用 Firefox，虽然我几乎只使用 Chromium，但我使用它的时间还不够长，无法发现用于内存使用或速度的分析工具。

但是，有[JS Perf](http://jsperf.com/)可以让您运行测试以显示特定方法的运行速度；尽管它根本没有涉及内存使用。

> 2：我的版本使用`.html()`方法和`.outerHTML`属性。我一直在网上看到这些帖子并不总是可靠的。这是IE6的一些保留吗？我的用户都是最新的，所以我想知道你为什么选择使用`.text()`然后附加一个节点？

`html()`是一种很好的使用方法，但理想情况下，仅当您想以字符串格式使用 html 时才使用；在上述情况下，使用字符串似乎更容易，因为我真正想要使用的是文本字符串。如果我正在操作的元素中还有其他元素`text()`，那么我必须使用，`html()`否则在将文本写入/替换到 DOM 时，这些元素将被覆盖。

我似乎记得在`outerHTML`历史上使用并坦率地说，在经验上没有取得太大成功。所以我很少考虑使用它，尽管这只是个人喜好问题。至于它是 IE 6 的遗留物吗？我不确定；我不会感到惊讶，但不幸的是，我根本不知道。

我选择使用`text()`，因为如前所述，我正在处理文本；然后我分别附加了节点，`html()`因为我正在插入一个 html 节点。如果我使用完全通过相同的内容，`html()`那么我认为它会起作用。但是，再次，只是个人喜好，我认为，它清楚地表明我是在操作/使用文本还是 html。

参考：

*   jQuery：
    *   [`append()`](http://api.jquery.com//).
    *   [`slice()`](http://api.jquery.com/slice/).
    *   [`text()`](http://api.jquery.com/text/).
*   “普通”非库 JavaScript：
    *   [`appendChild()`](https://developer.mozilla.org/en/DOM/element.appendChild).
    *   [`document.createElement()`](https://developer.mozilla.org/en/DOM/document.createElement).
    *   [`document.createTextNode()`](https://developer.mozilla.org/en/DOM:document.createTextNode).
    *   [`join()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/join).
    *   [`slice()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/slice).
    *   [`split()`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/split).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T20:09:52.537

JQuery 不应该用于此。您可以根据需要使用过滤器修改摘录。让服务器完成工作：

```
remove_filter('get_the_excerpt', 'wp_trim_excerpt');
add_filter('get_the_excerpt', 'new_excerpt_format');
function new_excerpt_format($text)
{
    global $post;
    $raw_excerpt = $text;
    if(!$text)
    {
        $text = get_the_content('');
        $text = strip_shortcodes($text);
        $text = apply_filters('the_content', $text);
        $text = str_replace(']]>', ']]&gt;', $text);

        $exceptions = ''; //PRESERVE CERTAIN TAGS, ADD/REMOVE AS NEEDED (ex: <p>,<a>,<em>,<strong>,<br>)
        $text = strip_tags($text, $exceptions);

        $maxCount = 55; //DEFAULT WP WORD COUNT, INCREASE/DECREASE AS NEEDED
        $excerpt_length = apply_filters('excerpt_length', $maxCount);

        $moreText = '.... <a href="'.get_permalink($post->ID).'">Read More &gt;&gt;</a>'; //CUSTOM MORE TEXT, CHANGE AS NEEDED
        $excerpt_more = apply_filters('excerpt_more', $moreText);

        $words = preg_split("/[\n\r\t ]+/", $text, $excerpt_length+1, PREG_SPLIT_NO_EMPTY);
        if(count($words) > $excerpt_length)
        {
            array_pop($words);
            $text = implode(' ', $words);
            $text = $text.$excerpt_more;
        }
        else
            $text = implode(' ', $words);
    }
    return apply_filters('wp_trim_excerpt', $text, $raw_excerpt);
} 
```

只需将其添加到您的 functions.php 文件中，它就可以满足您的所有需求。让我知道这是否有帮助。

# ant - 使用 build.xml 将非类文件（包括文件夹和文件）添加到 jar

> ID：10936691
> 
> 赞同：3
> 
> 时间：2012-06-07T17:20:08.680
> 
> 标签：ant, build.xml

我有一个具有下面提到的结构的 java 项目（MyProject）

src->package1(读作 com.test.Atrribute)->File1.java,File2.java

src->package2(读作 com.test.Objects)->obj1.java,obj2.java

src->directory(读取为 Webcontent.Objects)-> Folder1 -> application.properties 文件和更多文件

目前 build.xml 为上述项目创建一个 jar 并从 package1 和 package2 复制类文件。

但是，我的 jar 还应该包含包含所有内容的文件夹（Webcontent.Objects）（即文件夹和文件）。

如何在 build.xml 中执行此操作？

我以前从未创建过 build.xml，而且对这一切都非常陌生。

以下是 build.xml 中的 jar 任务，用于将类文件包含在 jar 中。

```
<target name="MyProject-jar" depends="compile"  
        description="Jar for the Project">        
  <jar destfile="${output.dir}/MyProject.jar" basedir="${output.dir}/">
    <include name="com/test/Attribute/*.class"/>
    <include name="com/test/Objects/*.class"/>          
  </jar>
</target> 
```

感谢是否有人可以提供帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:27:31.587

你可以添加

```
<include name="Webcontent/Objects/**/*"/> 
```

到你的 jar 任务

*注意*：`**`递归地考虑其父目录下的目录

# reporting-services - SSRS Cube 报表钻取参数

> ID：10936692
> 
> 赞同：0
> 
> 时间：2012-06-07T17:20:12.273
> 
> 标签：reporting-services

使用 SSRS v3.0（SQLServer 2008 R2 和相应的 BIDS 版本）我已经成功地实现了关于多维数据集数据的钻取报告。当用户单击报表单元格时，子报表将使用用户选择的父报表参数。但我真正想要的是要传递给子报表的选定单元格参数，而不是用于创建报表的父报表参数。示例：对于父报表，用户选择年份、季度和类别。报告显示一个交叉表，可展开为向下钻取到低级单元格。当前，当单击单元格时，子报告使用父级的广泛参数（如在单元格文本框操作“转到报告”中设置的那样）。我希望单元格操作使用仅从该特定单元格派生的参数：它是年、月、类别等。

我已搜索但找不到访问单元格参数的报告属性。（顺便说一句，在多维数据集浏览器中，那里的操作会自动为我执行此操作，并且我仅获得所选单元格的正确子报表数据）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T13:13:56.983

在父报表的钻取操作中，您使用用户单击的项目的字段名称（如 Fields!Year.Value、Fields!Quarter.Value 等）并以相同的方式将它们分配给子报表参数您可以将父参数传递给子参数。当用户单击单元格以启动子报表时，年份、季度等的当前范围作为参数传递给子报表。

# objective-c - 是否可以在情节提要中创建静态表格视图并稍后以编程方式添加它？(iOS5, XCode 4)

> ID：10936694
> 
> 赞同：2
> 
> 时间：2012-06-07T17:20:15.220
> 
> 标签：objective-c, ios, xcode, uitableview

我正在尝试创建几个小的静态表格视图并将它们添加到我拥有的滑入和滑出的面板中。该面板是以编程方式创建的，因此我无法通过情节提要在其中放置表格视图，无论如何我不确定这是否可能：似乎唯一可以布置有效的静态表格视图的方法是在表格视图控制器中，它占据了整个屏幕。

如果你不能说我对 iOS 开发很陌生，所以如果我不理解这里的一些基本概念，请随时解释。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T21:02:04.840

当然是可能的。这是如何完成的：

1.  将 a`TableViewController`拖到故事板中。
2.  将其设置`Size`为`Freeform`，添加标识符并取消选中`Resize View From NIB` ![在此处输入图像描述](../Images/6f11412e73e050bd7adae863503e8dbd.png)
3.  选择 tableview 并将其内容设置为`Static Cells`. 设计你的细胞。
4.  设置它的大小 ![在此处输入图像描述](../Images/bbf5ea686a5f378eae1bee5e28789fa2.png)
5.  现在，无论您需要在哪里实例化它，都可以这样做：

    ```
    // I am using a UITableViewController as an example here
    // you probably would like to set your actual controller subclass instead
    UITableViewController *tableViewController = [[UIStoryboard storyboardWithName:@"MainStoryboard" bundle:[NSBundle mainBundle]] instantiateViewControllerWithIdentifier:@"staticTv"];
    UITableView *tableView = tableViewController.tableView;
    [self.view addSubview:tableView]; // Or add it to whatever view 
    ```

享受 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T19:21:04.137

A`UITableViewController`不是提供管理 a 所需的功能所必需的`UITableView`。我认为您正在寻找的是“代表”模式。任何`UIViewController`人都可以被指定为`UITableView`. 例如，我有一个“静态”表，其中显示了我正在开发的应用程序中的一些选项：

```
@interface LBOptionsViewController : UIViewController <UITableViewDataSource,
                                                       UITableViewDelegate> 
```

如果您以编程方式创建表视图，您可能会在其中创建它们，`viewDidLoad`或者`loadView`（如果您自己创建实际视图）。创建 tableView 后，分配代表：

```
self.tableView.delegate = self;
self.tableView.dataSource = self; 
```

然后您的`UIViewController`子类将收到数据委托消息，例如：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

不确定这是否对您有帮助。我还没有玩过 Storyboards。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T19:30:10.560

**编辑：** @Alladinian 有正确的答案！如果您使用视图控制器的属性，请确保在需要其他方法调用它时分配它。

* * *

我还没有找到一个有用的理由来使用静态表格视图单元格而不是动态的。当我开始 iOS 编程时，表格视图非常可怕。我在我的第一个应用**YIKES**中使用了 sqlite 。

所以，是的，您应该只导入 UITableView 数据源和委托，然后通过将表格视图添加到您的面板来跟进（假设它是一个 uiview 并且您可以将表格视图添加为子视图）。

无论如何，您的 ViewController.h 中包括 UITableViewDataSource 和 UITableViewDelegate。

```
@interface ViewController : UIViewController<UITableViewDataSource,UITableViewDelegate> 
```

接下来，为 a`UITableView`和 an添加属性`NSMutableArray`：

`@property (strong, nonatomic) UITableView* tableView;`

`@property (strong, nonatomic) NSMutableArray* tableViewContents;`

在您的 ViewController 的 .m 中：

`@synthesize tableView;`

`@synthesize tableViewContents;`

里面`ViewDidLoad`：

`self.tableViewContents = [NSMutableArray arrayWithObjects:@"Cell 1",@"Cell 2",@"Cell 3",nil];` `[self.tableView setDelegate:self]` `[self.tableView setDatasource:self]`

在 .m 文件中：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView{
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{
    return self.tableViewContents.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    NSUInteger row = [indexPath row];
    index = row;

    static NSString *cellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];

    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier] autorelease];
    }
cell.textLabel.text = [tableViewContents objectAtIndex:row];
    return cell;
} 
```

# asp.net-mvc-3 - 如何测试具有静态依赖的单例类

> ID：10936695
> 
> 赞同：0
> 
> 时间：2012-06-07T17:20:23.317
> 
> 标签：asp.net-mvc-3, unit-testing, c#-4.0, singleton

我有一个 Singleton 类，它使用来自 Jon Skeet 的线程安全 Singleton 模式，如 TekPub 视频中所示。该类表示 MVC 3 UI 中下拉列表的缓存参考数据列表。

为了获取列表数据，该类在我的 DAL 中的静态类上调用静态方法。

现在我开始测试我想在我的 DAL 类上实现一个接口，但显然不能，因为它是静态的并且只有一个静态方法，所以没有要创建的接口。所以我想删除静态实现，这样我就可以做接口了。

通过这样做，我无法从引用类中静态调用该方法，并且因为引用类是具有私有 ctor 的单例，所以我无法注入接口。我该如何解决这个问题？如何将我的接口放入参考类中，以便我可以拥有 DI 并且可以使用模拟成功地对其进行测试？

这是我当前形式的 DAL 课程

```
public static class ListItemRepository {

    public static List<ReferenceDTO> All() {
        List<ReferenceDTO> fullList;
        ... /// populate list
        return fullList;
    }
} 
```

这就是我想要的样子

```
public interface IListItemRepository {
    List<ReferenceDTO> All();
}

public class ListItemRepository : IListItemRepository {

    public List<ReferenceDTO> All() {
        List<ReferenceDTO> fullList;
        ... /// populate list
        return fullList;
    }
} 
```

这是我的单例引用类，对静态方法的调用在`CheckRefresh`调用中

```
public sealed class ListItemReference {

    private static readonly Lazy<ListItemReference> instance = 
        new Lazy<ListItemReference>(() => new ListItemReference(), true);

    private const int RefreshInterval = 60;
    private List<ReferenceDTO> cache;
    private DateTime nextRefreshDate = DateTime.MinValue;

    public static ListItemReference Instance {
        get { return instance.Value; }
    }

    public List<SelectListDTO> SelectList {
        get {
            var lst = GetSelectList();
            lst = ReferenceHelper.AddDefaultItemToList(lst);
            return lst;
        }
    }

    private ListItemReference() { }

    public ReferenceDTO GetByID(int id) {
        CheckRefresh();
        return cache.Find(item => item.ID == id);
    }

    public void InvalidateCache() {
        nextRefreshDate = DateTime.MinValue;
    }

    private List<SelectListDTO> GetSelectList() {
        CheckRefresh();
        var lst = new List<SelectListDTO>(cache.Count + 1);
        cache.ForEach(item => lst.Add(new SelectListDTO { ID = item.ID, Name = item.Name }));
        return lst;
    }

    private void CheckRefresh() {
        if (DateTime.Now <= nextRefreshDate) return;
        cache = ListItemRepository.All(); // Here is the call to the static class method
        nextRefreshDate = DateTime.Now.AddSeconds(RefreshInterval);
    }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T20:15:45.043

您可以使用基于实例的单例（而不是基于静态），您可以像这样声明接口。

```
public interface IListItemRepository
{
    List<ReferenceDTO> All();
}

public class ListItemRepository : IListItemRepository
{
    static IListItemRepository _current = new ListItemRepository();

    public static IListItemRepository Current
    {
        get { return _current; }
    }

    public static void SetCurrent(IListItemRepository listItemRepository)
    {
        _current = listItemRepository;
    }

    public List<ReferenceDTO> All()
    {
        .....
    }
} 
```

现在，您可以模拟 IListItemRepository 进行测试。

```
 public void Test()
    {
        //arrange
        //If Moq framework is used,
        var expected = new List<ReferneceDTO>{new ReferneceDTO()};

        var mock = new Mock<IListItemRepository>();           
        mock.Setup(x=>x.All()).Returns(expected);

        ListItemRepository.SetCurrent(mock.Object);

        //act
        var result = ListItemRepository.Current.All();

        //Assert
        Assert.IsSame(expected, result);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:09:54.577

您使用的是哪个 DI 框架？根据您的回答，IOC 容器应该能够处理单实例化，这样您就不必在缓存类中实现自己的单例模式。在您的代码中，您会将所有内容都视为实例类，但在您的 DI 框架映射中，您将能够指定只应创建缓存类的一个实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T19:06:18.713

测试它的一种方法是，如果您通过添加额外的属性来重构您的 ListItemReference：

```
public sealed class ListItemReference {
    ...
    public Func<List<ReferenceDTO>> References = () => ListItemRepository.All();
    ...
    private void CheckRefresh() {
        if (DateTime.Now <= nextRefreshDate) return;
        cache = References();
        nextRefreshDate = DateTime.Now.AddSeconds(RefreshInterval);
    }
} 
```

然后在你的测试中你可以这样做：

```
ListItemReference listReferences = new ListItemReference();
listReferences.References = () => new List<ReferenceDTO>(); //here you can return any mock data 
```

当然，这只是临时解决方案，我建议通过使用 IoC/DI 摆脱静态。

# sql-server - 有数百个与几个较小的主表

> ID：10936697
> 
> 赞同：5
> 
> 时间：2012-06-07T17:20:31.943
> 
> 标签：sql-server, database, performance, database-design

我想知道哪种方法更适合设计数据库？

我目前有一个大表（每行 97 列），其中可以引用查找表。

将一些列分组到较小的表中并添加关键列以引用整行不是更好吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:26:27.897

如果您将表格分成几个部分，您将需要额外的连接来获取单行的所有列 - 这将花费您的时间。

97 列并不多，真的 - 我见过超过 100 列。

这完全取决于您的数据是如何被使用的——如果你的行一直只有 97 列，并且需要 97 列——那么将它们分成不同的表几乎没有意义。

如果：

*   您可以将一些“大”列（例如`XML`等`VARCHAR(MAX)`）移动到一个单独的表中，如果您一直不需要这些列 -> 在这种情况下，您的“基本”行会变小并且您的基本表会表现得更好 -只要你不需要那些超大的列

*   您可以将一些列移到一个单独的表中，这些列并不总是存在，例如，可能是“可选”的列并且仅存在于例如 20% 的行中 - 在这种情况下，您可能会为剩余的 80 行节省一些处理不需要这些列的情况的百分比。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:25:53.450

最好将相关列分组到不同的表中。这将提高您的数据库的性能以及您作为程序员的易用性。您应该首先尝试找到列之间的所有不同关系，然后您应该尝试将所有内容分解为表格，同时牢记这些关系（使用主键、分叉键、引用等）。尝试将图表创建为这个[http://www.simple-talk.com/iwritefor/articlefiles/354-image008.gif](http://www.simple-talk.com/iwritefor/articlefiles/354-image008.gif)从那里拿走。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T23:02:38.037

除非您的数据是非规范化的，否则最好将所有列保留在同一个表中。SQL Server 将各个表中的页面读入缓冲池。因此，即使访问的页面已经在缓冲池中，您也将承担每次访问的连接成本。如果您使用一个键在每个查询中仅访问几行数据，那么索引将在同一个表中的所有列上很好地为该查询提供服务。即使您将扫描大部分行（> 大表的 1%）但仅扫描 97 列中的少数列，您仍然最好将列保留在同一个表中，因为您可以使用覆盖的非聚集索引查询。但是，如果数据被严重非规范化，则对其进行规范化，根据定义，这会根据规范化规则将其分成许多表以消除冗余，

# python - 使用python在字符串中插入字符

> ID：10936699
> 
> 赞同：1
> 
> 时间：2012-06-07T17:20:35.843
> 
> 标签：python, insert, character

这是我想要实现的目标：我想替换

```
void some_function(int,  int *, float); 
```

和

```
void some_function(int a, int *b, float c); 
```

到目前为止，当我遍历字符串时，我已经尝试用 chr(97+i) 替换“，”。

```
text = len("void some_function(int,  int *, float);")
i = 0
for j in range(0, length)
    if text[j] == ",":
       rep = " " + chr(97+i) + " .,"
       text = text.replace("," rep)
       i = i + 1
       j = 0 # resetting the index, but this time I want to find the next occurrence of "," which I am not sure 
```

但这并没有起到作用。请让我知道是否有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:39:06.757

```
import re

i = 96
def replace(matches):
    global i
    i += 1
    return " " + chr(i) + matches.group(0)

re.sub(',|\)', replace, "void some_function(int,  int *, float);") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:39:11.483

```
text = "void some_function(int,  int *, float);".replace(',', '%s,') % (' a', 'b') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:51:31.810

原来的想法行不通，因为最后一个参数后面不是'，'而是'）'。

```
import re
import string

def fix(text):
    n = len(re.findall('[,(]', text))
    return re.sub('([,)])', ' %s\\1', text) % tuple(string.letters[:n]) 
```

# c# - 正则表达式不适用于 Linq to Sql

> ID：10936705
> 
> 赞同：1
> 
> 时间：2012-06-07T17:20:53.787
> 
> 标签：c#, regex, linq

我有以下代码

```
Regex R = new Regex("my regex");
var q = from c in db.tble1
        where R.IsMatch(c.text)
        select c; 
```

在调试时我在 q 结果中看到了这条消息

> 方法 'Boolean IsMatch(System.String)' 没有支持的 SQL 转换。"} System.SystemException {System.NotSupportedException}

所以我做错了什么？

编辑：我了解到该方法不支持对 SQL 的翻译，
但如何解决这个问题

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-07T17:21:38.823

正则表达式不支持对 SQL 的转换。错误说明了一切。您不能在 LINQ to SQL 中使用正则表达式。

尝试使用`like`or`substring`比较：

```
var q = from c in db.tble1
        where c.text.StartsWith("x") && c.text.Substring(2, 1) == "y"
        select c; 
```

或者，您可以执行内存正则表达式比较。`ToList()`您可以通过在使用之前调用来做到这一点`Regex`：

```
Regex R = new Regex("my regex");
var q = from c in db.tble1.ToList()
        where R.IsMatch(c.text)
        select c; 
```

# objective-c - 在 isEqual 中检查了什么？

> ID：10936708
> 
> 赞同：1
> 
> 时间：2012-06-07T17:21:04.923
> 
> 标签：objective-c, uiview

苹果指南`isEqual`说：

> 返回一个布尔值，指示接收者和给定对象是否相等。（必需的）
> 
> 此方法定义了实例相等的含义。例如，一个容器对象可能将两个容器定义为相等，如果它们对应的对象都对`isEqual:`请求响应“是”。有关使用此方法的示例，请参阅 NSData、NSDictionary、NSArray 和 NSString 类规范。
> 
> 如果两个对象相等，则它们必须具有相同的哈希值。`isEqual`如果您在子类中定义 : 并打算将该子类的实例放入集合中，则最后一点尤其重要。确保您还在子类中定义哈希。

所以我的问题是，如果我想比较两个 UIButtons 或两个 UILabels（两个 UIViews）`isEqual`，并且事先我检查了它们的类是否是同一个类然后调用`isEqual`，检查什么？是否正在检查属性、值、操作消息、目标对象？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:50:50.483

NSObject 的 isEqual: 方法检查两个对象的哈希值是否相等。实际上，如果没有被覆盖，哈希就是实例的地址。然而，在简单的数据容器类中，isEqual 被覆盖，例如，NSString 的 isEqual: 方法调用 isEqualToString: 在检查被比较的对象是一个 NSString 实例之后。正如我之前提到的，同样适用于 NSData、NSNumber、NSDate、NSArray 和 NSDictionary。但是，UIView（及其所有父视图）不会覆盖 isEqual：因为没有明显的方法来确定两个视图是否相等。您最好比较要检查的视图的另一个更重要的属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:26:32.460

不，isEqual 对指针的内存地址进行简单检查，看它们是否是同一个对象。您必须使用其他方法来检查按钮是否具有相同的标题但是否是两个单独的按钮实例。

# python - 为什么 python 模块表现得像一个单例？

> ID：10936709
> 
> 赞同：13
> 
> 时间：2012-06-07T17:21:05.237
> 
> 标签：python, singleton

作为应用程序运行的一部分，我从远程数据库创建字典。这个过程是相当繁重的 I/O，所以我决定创建这个字典的“单例”实例，并在我的应用程序中根据需要调用它。

代码看起来像（在`Dictionaries.py`）：

```
state_code_dict = None

def get_state_code_dict():
    global state_code_dict
    if state_code_dict == None:
        state_code_dict = generate_state_code_dict()
    return state_code_dict 
```

`get_state_code_dict()`然后我在需要的地方导入并调用该函数。我添加了一个打印语句来检查是否`state_code_dict`正在重新初始化或重用，我发现它正在被重用（这是我想要的功能）。为什么`state_code_dict`存活应用程序的实例在运行？

**编辑**

我`get_state_code_dict`在多个文件中导入函数。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-06-07T17:35:51.057

这是 Python 语言参考对[导入模块如何工作](http://docs.python.org/reference/simple_stmts.html#the-import-statement)的描述：

> *(1) 找到一个模块，必要时*初始化它；(2) 在本地命名空间中定义一个或多个名称

（强调了。）这里，*初始化*一个模块意味着执行它的代码。此执行仅在*必要时*执行，即如果模块先前未在当前进程中导入。由于 Python 模块是一流的运行时对象，它们实际上变成了单例，在首次导入时初始化。

请注意，这意味着不需要`get_state_dict_code`函数；`state_code_dict`只需在顶层初始化：

```
state_code_dict = generate_state_code_dict() 
```

有关更深入的解释，请参阅[Thomas Wouters 的这篇演讲](https://www.youtube.com/watch?v=uOzdG3lwcB4)，尤其是。第一部分 - 大约 04:20 - 他讨论了“一切都是运行时”原则。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-06-07T17:42:58.073

我投了 larsmans 的回答，我只是想添加一个例子。

**你好.py：**

```
hi = 'hello'

print(hi)

def print_hi():
    print(hi) 
```

**ipython 会话：**

```
In [1]: from hello import print_hi
hello

In [2]: print_hi()
hello

In [3]: from hello import print_hi

In [4]: import hello

In [5]: hello.print_hi()
hello 
```

看看第 3 行和第 4 行的导入没有像第 1 行的导入那样输出“hello”，这意味着代码没有重新执行。

# installation - Windows 8 驱动程序安装和目录/签名验证

> ID：10936711
> 
> 赞同：10
> 
> 时间：2012-06-07T17:21:17.297
> 
> 标签：installation, driver, windows-8, digital-signature, inf

我无法让 Windows 8（发布预览版）接受描述为问题解决方案的**inf2cat**或**makecat方法**

> [Windows 8 的驱动程序签名要求有何变化？](https://stackoverflow.com/q/9640400/1442715)

除非我禁用验证。

此时我没有使用任何证书签署这些，只是试图克服阻止驱动程序安装的错误。

Windows 8 给了我一个非常不起眼的错误：

> “尝试将驱动程序添加到商店时遇到问题。”

查看事件日志，没有任何用处；仅来自“Windows 错误报告”的信息条目，指示**PnPdriverimporterror**。

当我将原始文件与与 inf 不匹配的 cab 文件一起使用时，我收到其他人列出的错误：

> 文件的哈希值不存在于指定的目录文件中。

我有一个`.inf`需要生成的文件`.cat`。

也许我做错了什么。想法？？

## INF2CAT 方法

```
c:\win_xp_vista32_64>inf2cat /driver:"." /os:XP_X86,XP_x64,Vista_X86,Vista_x64,7_X86,7_X64,8_X86,8_X64

.......................
Signability test complete.

Errors:
None

Warnings:
22.9.10: usbser.sys in [drivercopyfiles.nt] is missing from [SourceDisksFiles] s
ection in \mchpcdc.inf; ok if file source is provided via LayoutFile in [Version
].
22.9.10: %driverfilename%.sys in [drivercopyfiles.ntamd64] is missing from [Sour
ceDisksFiles] section in \mchpcdc.inf; ok if file source is provided via LayoutF
ile in [Version].

Catalog generation complete.
c:\win_xp_vista32_64\mchpcdc.cat 
```

## MAKECAT 方法

```
--- start of catalog.cdf file---

[CatalogHeader]
Name=mchpcdc.cat
ResultDir=.\
[CatalogFiles]
<hash>mchpcdc=.\mchpcdc.inf
---end of .cdf file ---

c:\win_xp_vista32_64>makecat catalog.cdf 
```

这些相同的文件，无论是哪种方法的 cat，都可以在 Windows 7 中正常安装。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-22T05:16:21.333

我认为这个问题与“Windows 驱动程序签名强制”有关。您可以通过禁用此选项来解决此问题。通过以下链接进行操作：

[http://tivadj-tech.blogspot.in/2012/09/certificate-check-error-when-installing.html](http://tivadj-tech.blogspot.in/2012/09/certificate-check-error-when-installing.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-09-12T12:32:48.200

I just tested this on Windows 10 and 8 PRO now, to get this right, follow these steps:

1) From your Start menu, locate your DDK's "x64 Checked Build Environment" i.e. the custom DOS build screen. Right-click, run-as administrator...

2) Compile your source with the Build tools etc.

3) Go into your compiled code, and then create your test-certificate (you don't need to purchase one just yet, use your self-signed one created with the line below):

> makecert -r -pe -ss PrivateCertStore -n CN=newhex.com(Test) NewhexTest.cer

The above means your certificate is called "newhex.com(Test)" and the generated file is "NewhexTest.cer"

4) Create / Edit your .CDF file which contains items about what your CAT file's contents.

5) Create your CAT file by executing:

> makecat -v MyCDF.CDF

This should generate an un-signed CAT file that includes all files specified by your CDF.

6) Sign your CAT file as follows:

> Signtool sign /v /s PrivateCertStore /n newhex.com(test) /t [http://timestamp.verisign.com/scripts/timestamp.dll](http://timestamp.verisign.com/scripts/timestamp.dll) MyDriverWhatever.cat

This should result in a CAT file that is signed, but don't just install it, because your Windows can't trust Newhex's cert since it's not in the keystore, to fix this do:

7) Add your certificate to your private Key Store, remember this step MUST be done by an administrators access, otherwise you will get an error about (Keystore not found etc):

> certmgr.exe -add NewhexTest.cer -s -r localMachine root

This should add into your keystore, Once done, you can then:

8) Go into your device manager, and add your new driver, you would get a warning but will be accepted and installed without the need to reboot with a forced (Don't check cert type account).

I tried this already and it works on Windows 10 and Windows 8 pro versions.

Kind Regards Heider Sati

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-02T18:36:36.033

您应该使用 inf2cat，而不是 makecat，因为您有一个 INF 文件。

您应该通过修复您的 INF 文件来解决来自 inf2cat 的这些警告。这是我的 INF 文件，它使用 usbser.sys 并且不会引起任何警告： [https ://gist.github.com/3647208](https://gist.github.com/3647208)

由于 chinzei 在此线程的第一篇文章中的建议，我能够修复我的 INF 文件：http: [//www.microchip.com/forums/m488342-print.aspx](http://www.microchip.com/forums/m488342-print.aspx)

如果您仍然遇到问题，请编辑您的问题以包含您的 INF 文件的来源，或者至少包含指向该来源的链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T21:28:45.823

我遇到了同样的问题，并且能够使用此处提供的说明安装带有 TEST 证书的驱动程序：

[http://msdn.microsoft.com/en-us/windows/hardware/gg487328.aspx](http://msdn.microsoft.com/en-us/windows/hardware/gg487328.aspx)

# javascript - 使用 settimeout 加载时，svg 动画不会启动

> ID：10936712
> 
> 赞同：1
> 
> 时间：2012-06-07T17:21:21.533
> 
> 标签：javascript, svg, settimeout

我在一个页面中加载了 2 个嵌入式 svg-let。一个动画一个没有。它们使用 setTimeout 按顺序加载。当我首先加载动画一切顺利时，动画按预期开始，然后第二个静态 svg 正确显示。当我第一次加载第二个，然后是动画时，动画没有开始。

代码在这里：[jsfiddle](http://jsfiddle.net/Kx3Hw/1/) switch #svg1 和 #svg2 in the javascript。

在浏览器检查后，我发现这可能是一个 webkit 错误，因为 chrome 和 safari 都显示这种行为 FF 12 和 Opera 都很好。

这可以用 JS 代码修复还是我应该用 webkit 提交错误？

== 已添加

我认为应该改写这个问题，为什么在加载了 settimeout 的 svg 后动画没有开始。

正如 Jared 在下面调查的那样，当元素存在于 DOM 中并通过 dom 操作重新排序到焦点元素中时，它可以工作，Chrome 和 webkit 需要通过对 animate 元素的 beginElement() 调用来启动。这仍然不适用于从纯文本构造的元素。因为我只有一个 mac，而且我仍然认为这是一个爱好项目，所以我将 MS IE 完全排除在外。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T14:55:13.270

嗯，这比我预期的要长得多，但我成功了。基本上，您`SVG`在标记等上使用 semi- 和正则表达式的方法至少可以说不是完成它的方法。

答案是使用`svg`DOM 动画方法和属性，尤其是在您希望动画运行时启动/停止动画。显然，Firefox 只需通过操作内部 HTML/标记来重新初始化元素和动画就可以了。然而，Chrome（Webkit？）实际上需要您以编程方式访问和控制元素。我还没有检查过 IE、Opera 或 Safari。

我重做了这个例子，完全省略了箭头，因为它与问题无关。相反，我专注于创建和测试动画功能。您之前缺少的关键点是：

```
var $lasso = $('#lasso'),
    animater = $lasso.find('animate')[0],

...

animater.beginElement();

...

animater.endElement(); 
```

这是我制作的演示，与您的问题有很大不同：

[http://jsfiddle.net/9hBfs/](http://jsfiddle.net/9hBfs/)

不过，我所说的“套索”效应仍然存在。

我会参考 Mozilla 开发者网络 (MDN) 站点，因为它们有很多重要的信息并且是高度信任的权威：

*   [https://developer.mozilla.org/en/SVG](https://developer.mozilla.org/en/SVG)
*   [https://developer.mozilla.org/en/SVG/Element/animate](https://developer.mozilla.org/en/SVG/Element/animate)
*   [http://www.w3.org/TR/SVG11/animate.html#animation-mod](http://www.w3.org/TR/SVG11/animate.html#animation-mod)
*   [http://www.w3.org/TR/SVG11/animate.html#InterfaceElementTimeControl](http://www.w3.org/TR/SVG11/animate.html#InterfaceElementTimeControl)
*   [http://www.w3.org/TR/SVG11/animate.html#RestartAttribute](http://www.w3.org/TR/SVG11/animate.html#RestartAttribute)

# java - Jersey 从 ClientResponse 转换为 Response

> ID：10936718
> 
> 赞同：4
> 
> 时间：2012-06-07T17:21:37.967
> 
> 标签：java, jersey

我目前正在使用 Jersey 作为代理 REST api 来调用另一个 RESTful Web 服务。一些调用将在我的服务器中以最少的处理传入和传出。

有没有办法干净地做到这一点？我正在考虑使用 Jersey 客户端进行 REST 调用，然后将 ClientResponse 转换为 Response。这是可能的还是有更好的方法来做到这一点？

一些示例代码：

```
@GET
@Path("/groups/{ownerID}")
@Produces("application/xml")
public String getDomainGroups(@PathParam("ownerID") String ownerID) {
    WebResource r = client.resource(URL_BASE + "/" + URL_GET_GROUPS + "/" + ownerID);
    String resp = r.get(String.class);
    return resp;
} 
```

如果响应始终成功，则此方法有效，但如果另一台服务器上有 404，我必须检查响应代码。换句话说，有没有干净的方法来返回我得到的响应？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-08T09:41:50.007

据我所知，没有方便的方法。你可以这样做：

```
public Response getDomainGroups(@PathParam("ownerID") String ownerID) {
    WebResource r = client.resource(URL_BASE + "/" + URL_GET_GROUPS + "/" + ownerID);
    ClientResponse resp = r.get(ClientResponse.class);
    return clientResponseToResponse(resp);
}

public static Response clientResponseToResponse(ClientResponse r) {
    // copy the status code
    ResponseBuilder rb = Response.status(r.getStatus());
    // copy all the headers
    for (Entry<String, List<String>> entry : r.getHeaders().entrySet()) {
        for (String value : entry.getValue()) {
            rb.header(entry.getKey(), value);
        }
    }
    // copy the entity
    rb.entity(r.getEntityInputStream());
    // return the response
    return rb.build();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-19T21:59:06.177

对我来说，Martin throw 的回答： *JsonMappingException: No serializer found for class sun.net.www.protocol.http.HttpURLConnection$HttpInputStream* Change from

```
rb.entity(r.getEntityInputStream()); 
```

到

```
rb.entity(r.getEntity(new GenericType<String>(){})); 
```

帮助。

# c# - 使用 UniObjects 加快 UniVerse 访问时间

> ID：10936721
> 
> 赞同：0
> 
> 时间：2012-06-07T17:21:53.440
> 
> 标签：c#, .net, universe, uniobjects

我正在访问 UniVerse 数据库并读出其中的所有记录，以便将其同步到 MySQL 数据库，该数据库用于与使用该数据的其他一些应用程序兼容。一些表的长度 > 250,000 条记录，列 > 100 列，服务器相当陈旧，仍然被许多同时使用的用户使用，因此有时需要很长时间才能读取记录。

示例：我执行 SSELECT <file> TO 0 并开始读取选择列表，将每条记录解析为我们的数据抽象类型并将其放入 .NET 列表中。根据具体情况，获取每条记录可能需要 250 毫秒到 3/4 秒，具体取决于数据库使用情况。删除提取方法只会稍微加快它的速度，因为我认为即使我不使用它，当我调用 UniFile.read 时它仍然会下载所有记录信息。

以这种速度读取 250,000 条记录非常慢，所以有谁知道我可以加快速度的方法吗？我应该在某处设置一些选项吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T11:45:55.293

你真的需要使用 SSELECT（排序选择）吗？记录键上的排序将产生额外的性能开销。如果您不需要以排序方式同步，只需使用普通的 SELECT，这应该会提高性能。

如果这没有帮助，那么尝试在系统使用率较低的时候自动运行同步，如果可能的话，当很少或没有用户登录到 UniVerse 系统时。

除此之外，您导出的某些表可能需要调整大小。如果它们不是动态文件（自动调整大小 - 类型 30），它们可能已进入磁盘溢出空间。要找出最大表的大小并查看它们是否溢出，您可以在命令行中使用 FILE.STAT 和 HASH.HELP 等命令来检索更多信息。使用 HELP FILE.STAT 或 HELP HASH.HELP 查看这些命令的文档，以便提取您需要的信息。

如果这些命令显示您的文件的类型为 30，那么数据库引擎会自动调整它们的大小。但是，如果文件类型是从 2 到 18 的任何类型，则 HASH.HELP 命令可能会建议您对表大小进行更改以提高其性能。

如果这些都没有帮助，那么您可以使用 LIST.INDEX TABLENAME ALL 检查表上的有用索引，您可以使用它来加快选择速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T03:58:27.503

使用 ANALYZE-FILE 文件名确保您的文件大小正确。如果不是动态的，请确保没有太多溢出。

使用 SELECT 而不是 SSELECT 将意味着您从数据库中顺序读取数据而不是随机读取数据，并且速度明显更快。

您还应该调查如何从每条记录中提取数据并将其放入列表中。通常pick数据分隔符chars 254、253、252会与外部数据库不兼容，需要进行转换。如何做到这一点会对性能产生巨大影响。

从最初的帖子中不清楚，但是 WRITESEQ 可能是输出文件数据的最有效方式。

# oracle - 在 Quercus/Tomcat 上使用 Zend 并连接到 Oracle

> ID：10936722
> 
> 赞同：1
> 
> 时间：2012-06-07T17:21:56.530
> 
> 标签：oracle, tomcat, jdbc, zend-db, quercus

我在 Quercus/Tomcat 上使用 Zend，我想使用 Zend_db 连接到 Oracle。

(a) 如何让 Quercus 连接到 Tomcat JNDI 数据源到 Oracle 数据库

(b) 如何让 Zend_db 连接到那个数据源

PDO::getAvailableDrivers() 显示以下输出

0->mysql

1->pgsql

2->java

我找到了（a）的一些步骤，但我不确定如何验证它。3->数据库

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-05T12:33:49.540

这就是我为 zend 连接到 oracle 所做的，它运行良好

在 Zend\Db 目录的 Zend 库中，我创建了一个名为 Dbname.php 的文件

```
<?php
date_default_timezone_set("Europe/London");
require_once 'Zend/Registry.php';

/**
 * Class for creeating an Oracle SQL Dbname.
 *
 * @Author     Chris Robinson cghrmauritius@gmail.com
 */
class Zend_Db_Dbname
{
 public static function get($arr) {

     $enviroment = Zend_Registry::get("enviroment");

     if(isset($arr[$enviroment.":db"])){

         $retArray = $arr[$enviroment.":db"];

         $dbName = "(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)
                        (HOST={$retArray['host']})(PORT={$retArray['port']})))";

         $dbName .= "(CONNECT_DATA=";

         if(isset($retArray['pooled'])){
             if($retArray['pooled'] == 1)
                $dbName .= "(SERVER = POOLED)";
         }
         if(isset($retArray['sid'])){
            $dbName .= "(SID={$retArray['sid']})))";
         }else if(isset($retArray['serviceName'])){
            $dbName .= "(SERVICE_NAME={$retArray['serviceName']})))";
         }

         $retArray['dbname'] = $dbName;

         unset($retArray['pooled']);

         return $retArray;
     }
     return "Missing '".$this->enviroment.":db' from application.ini";       
 }
}

?> 
```

我还有一个 ini 文件（'myfilename.ini'），其中包含我们的开发和生产数据库的所有数据库连接详细信息，如下所示

```
[global]

salt    = "qZPJeZbQv])7fnKxS’U0\2V^Eg.|})+obZ:H6|y.[#EBqo;Evp"
api     = "d5f75f4ddc0a5cead40b4269ca28b217b71ed893";

[production]

debug = false

[production:db]

host    = xx.xx.xx.xxx
username    = myusername
password    = mypassword
port    = xxxx
charset     = "WE8ISO8859P1"
pooled  = true
sid     = mysid

[development]

debug = true

[development:db]

host        = xx.xx.xx.xxx
username    = myusername
password    = mypassword
port        = xxxx
charset     = "WE8ISO8859P1"
pooled      = false
sid         = mysid
debug       = true 
```

然后在我的网站代码或类中进行连接

```
Zend_Registry::set("enviroment", "production");
$arr = parse_ini_file('myfilename.ini',true);
$options = Zend_Db_Dbname::get($arr);
$db = Zend_Db::factory('Oracle', $options); 
```

使用这种方法，我发现创建新类/页面/api 等非常有用且快速，并允许在开发和生产服务器之间快速切换。

如果您需要任何进一步的帮助，请尽管询问。

# c# - 登录身份验证逻辑在 C#.NET 中不起作用

> ID：10936723
> 
> 赞同：0
> 
> 时间：2012-06-07T17:21:56.983
> 
> 标签：c#, .net, visual-studio-2010, oracle11g

我创建了表 user_info，其中包含 2 个用户名和密码。当我执行下面的代码时，即使我输入正确的用户名和密码，它也总是进入“else”状态。

```
protected void Login1_Authenticate(object sender, AuthenticateEventArgs e)
{
    string v = System.Configuration.ConfigurationManager.ConnectionStrings["harish"].ConnectionString;
    con = new OracleConnection(v);
    con.Open();

    cmd = new OracleCommand("select * from user_info where username='" + Login1.UserName.Trim() + "' and password='" + Login1.Password + "'", con);
    dr = cmd.ExecuteReader();
    dr.Read();
    if (dr.HasRows)
    {
        Response.Redirect("Default2.aspx");
    }
    else
    {
        Response.Redirect("Default.aspx");
    }

    con.Close();
    dr.Close();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:51:59.410

它进入 else 因为 dr 没有行。要找出原因，请在

```
dr = cmd.ExecuteReader(); 
```

然后使用带有参数的实际 sql select 命令并将其作为针对 db 的 sql 语句运行，以查看它是否返回行。我的怀疑是，您认为输入 Login1.Username 和/或 Login1.Password 的任何内容都没有传递，但在不知道如何填充 Login1 的情况下很难说。

顺便说一句，如果这些是网页上的文本框，那么您需要使用 Login1.Username.Text 和 Login1.Password.Text 来获取文本框中的实际字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:08:28.500

首先，您至少应该对密码进行哈希处理。此外，最好不要将您的联系留在课堂上。当您使用它们时，它们应该被创建、打开和关闭。与命令、阅读器等相同...这可以通过**using**块轻松完成。

接下来，确保在使用 Login1.UserName 和 Login1.Password 时访问的是实际字符串值而不是控件。如果您使用控件，则需要使用 Login1.UserName.Text.Trim() 和 Login1.Password.Text.Trim()。您可以通过将构建的查询存储到本地字符串值并查看实际构建的内容来确保这一点。

不要将 DataReader 用于您正在做的事情。而是使用 ExecuteScalar 方法：

```
protected void Login1_Authenticate(object sender, AuthenticateEventArgs e)
{
    string v = System.Configuration.ConfigurationManager.ConnectionStrings["harish"].ConnectionString;
    con = new OracleConnection(v);
    con.Open();

    cmd = new OracleCommand("select * from user_info where username='" + Login1.UserName.Trim() + "' and password='" + Login1.Password + "'", con);
    int count = Convert.ToInt32(cmd.ExecuteScalar());
    if (count > 0)
    {
        Response.Redirect("Default2.aspx");
    }
    else
    {
        Response.Redirect("Default.aspx");
    }

    con.Close();
} 
```

**完成此设置后，在if (count > 0)**行上放置一个断点。检查存储在本地 var 中的查询并检查计数。这应该为您提供所需的一切。

# php - PHPEXCEL 库需要很长时间才能加载

> ID：10936724
> 
> 赞同：0
> 
> 时间：2012-06-07T17:21:59.430
> 
> 标签：php, phpexcel, codeplex

我使用 codeplex 的 phpexcel 库将大量数据导出到 excel 文件 (2007)。

问题是执行需要很长时间......我使用了作为库的一部分存在的内存缓存选项和缓存目录选项，并且在返回数据后我取消了对象的设置。
我也觉得我应该注意，在我的应用程序中，我使用一些变量来计算循环中包含的行数。
任何使脚本更快或更高效的想法或概念都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:30:37.943

我有时必须检查他们的网站以获取性能改进，并经常将这些因素纳入我的解决方案：

*   填充每个单独的单元格的效率低于 fromArray() 方法。
*   如果您使用公式，根据他们的网站，您可以使用 $objWriter->setPreCalculateFormulas(false) 加快保存速度

**编辑：**

如果不深入了解您在做什么，我只能建议您改进填充单元格的方式：

而不是这个： $objPHPExcel->getActiveSheet()->setCellValue('A1',$x); $objPHPExcel->getActiveSheet()->setCellValue('B1',$y);

以这种方式仅访问一次 getActiveSheet()：

```
$sheet = $objPHPExcel->getActiveSheet();
$sheet->setCellValue('A1',$x);
$sheet->setCellValue('B1',$y); 
```

或者，像这样组合单元格更新：

```
$objPHPExcel->getActiveSheet()->setCellValue('A1',$x)
                              ->setCellValue('B1',$y); 
```

# python - 跨会话序列化数据库连接

> ID：10936727
> 
> 赞同：1
> 
> 时间：2012-06-07T17:22:07.963
> 
> 标签：python, oracle, flask, cx-oracle

我正在开发一个需要使用最终用户提供的凭据登录数据库的 Web 应用程序；应用程序本身没有登录数据库。

问题是如何为每个*用户会话创建**一个连接*。

 *一种方法是：

1.  请求用户的凭据
2.  检查凭据是否对 db 后端有效
3.  将凭据存储在会话级变量中

这种方法的问题在于，对于该会话的每个后续请求；您需要创建一个新连接；这将很快耗尽与服务器的最大连接。

我正在将[Flask](http://flask.pocoo.org/)与 Oracle 一起使用。

在 Flask 中有一个[`g`](http://flask.pocoo.org/docs/api/#application-globals)对象，它存储请求范围的对象。但是，此代码段不起作用：

```
app = Flask(__name__)
app.config.from_object(__name__)

def login_required(f):
    @wraps(f)
    def decorated_function(*args, **kwargs):
        if g.db is None:
            return redirect(url_for('login', next=request.url))
        return f(*args, **kwargs)
     return decorated_function

class LoginForm(Form):
    username = TextField('Username', [validators.Length(min=4, max=25)])
    password = PasswordField('Password', [validators.Required()])

@app.route('/app', methods=['GET','POST'])
@login_required
def index():
    return 'Index'

@app.route('/', methods=['GET','POST'])
def login():
    form = LoginForm(request.form)
    if request.method == 'POST':
        if form.validate():
           try:
               dsn = cx_Oracle.makedsn(app.config['DB_HOST'],
                                       app.config['DB_PORT'], app.config['DB_SID'])
               g.db = cx_Oracle.connect(form.username.data,
                                        form.password.data, dsn)
           except cx_Oracle.DatabaseError as e:
               flash(unicode(e), 'error')
               return render_template('login.html', form=form)
            return redirect(url_for('index'))
        else:
            return render_template('login.html', form=form)
    else:
        return render_template('login.html', form=form) 
```

`AttributeError: '_RequestGlobals' object has no attribute 'db'`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T09:08:35.820

此代码段不起作用的原因是这一行

```
 if g.db is None: 
```

您正在访问不属于 g 的属性。添加这些代码行：

```
 @app.before_request
    def before_request():
         g.db = None 
```

标有 before_request() 的函数在请求之前调用并且不传递任何参数。

**关于连接池**

Python 中有一个名为[SQLAlchemy](http://www.sqlalchemy.org/)的 ORM 和 SQL 工具包，它会自动为您执行连接池。它还管理烧瓶的 g 对象并创建更安全的准备好的 SQL 语句。

它有两个部分：

```
 1\. Core which is a SQL abstraction toolkit.
    2\. ORM is an optional package which builds on top of Core. 
```

因此，如果您不想使用 ORM，那么只需使用其所有功能完整的核心即可。[在这里](http://www.sqlalchemy.org/features.html)检查。

[它通过 cx_Oracle 支持 Oracle，并且可以按照这里](http://docs.sqlalchemy.org/en/rel_0_7/dialects/oracle.html#module-sqlalchemy.dialects.oracle.cx_oracle)的 SQLAlchemy Docs 中所述进行设置。

检查此[问题](https://stackoverflow.com/q/98687/679047)以获取有关 python 中的连接池的更多讨论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T02:09:33.943

Sounds like you need to implement connection pooling. Instead of requesting a new connection for each request (which does not scale at all), you simply check out a connection from the pool with the required attributes. If no suitable connection is available, the pool would create a new one. The pool would also need to handle the opposite case of course in closing connections that haven't been used for some time.

You might want to check if such a pool is available for python. For java oracle supports this with UCP and for OCI with the session pool. If I'm not mistaken a connection pool is even provided for .Net.*

# c - 如何在C中写入excel中的第二列

> ID：10936733
> 
> 赞同：1
> 
> 时间：2012-06-07T17:22:48.230
> 
> 标签：c, excel

所以现在我知道了如何写入 excel 文件（非常感谢你们！），我想知道是否有办法在 excel 中写入第二列。我实际上正在向这个 excel 文件发送两个不同的变量，我希望它们并排而不是彼此相邻。我没有看到任何其他关于 C 语言的问题，所以我想我会把它扔掉。如果有，请随时将问题链接给我，对于浪费空间，我深表歉意！

```
File * fp;
fp = fopen("C:\\Documents and Settings\\MyName\\Desktop\\Filename.csv", "w");
if(fp == NULL){
    printf("Couldn't open file\n");
    return;
}
for (j = 0; j<Variable0; j++){
fprintf(fp, "%f\n", (j+Variable1);
fprintf(fp, "%f\n", (j+Variable2);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T17:38:46.530

您不是在编写 Excel 文件，而是在编写逗号分隔值文件 (CSV)。但是，它仍然可以使用 Excel 打开。这是个很大的差异。***每列用逗号分隔。***每行由换行符分隔。

```
File * fp;
fp = fopen("C:\\Documents and Settings\\MyName\\Desktop\\Filename.csv", "w");
if(fp == NULL){
    printf("Couldn't open file\n");
    return;
}

float otherVar1 = 1.0f; // random thing you want to put in second column
float otherVar2 = 2.0f; // random thing you want to put in second column

for (j = 0; j<Variable0; j++){
    fprintf(fp, "%f,%f\n", (j+Variable1), (otherVar1));
    fprintf(fp, "%f,%f\n", (j+Variable2), (otherVar2));
} 
```

确保你记得关闭文件！

```
fclose(fp); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:40:21.730

对于 CSV 文件，列由逗号分隔，行由回车分隔。

例子：

```
Col1,Col2
Data1,Data2 
```

# django - 为什么 django ORM 的 `save` 方法不返回保存的对象？

> ID：10936737
> 
> 赞同：45
> 
> 时间：2012-06-07T17:23:05.330
> 
> 标签：django, orm, django-models

对这个设计决策背后的原因有任何见解吗？在我看来，`obj.save()`返回*某些东西*只有好处（如方法链接）而没有缺点。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-06-07T17:33:35.143

在 Python 中，主要影响现有对象的函数*不*返回自身通常被认为是一种很好的做法。例如，`sorted(yourlist)`返回一个排序列表，但`yourlist.sort()`对列表进行就地排序并且不返回任何内容。

在一行上执行具有副作用的多个操作（与关注返回值的无副作用函数相反）并不是一个很好的做法。代码在行数方面会更紧凑，但会更难阅读，因为重要的副作用可能隐藏在链的中间。如果要使用方法链接，请在链的开头使用没有副作用的函数，然后`.save()`在末尾使用具有副作用的单个函数。

换句话说，在方法链中，链的开头是输入，链的中间转换输入（向下导航树，对输入进行排序，更改字符串的大小写等），最后是链是具有副作用的功能部分。如果您将具有副作用的方法埋在链的中间，那么您的方法链实际上做了什么就不清楚了。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-05-06T13:49:28.317

[这让我想起了 Greg Ward 最近在Pycon2015](https://www.youtube.com/watch?v=r9cnHO15YgU#t=11m50s)上提出的一般原则，即不要将函数与过程混淆。每个函数都应该返回一个值或有副作用，但不能两者兼而有之。

对 dict.update()基本上提出了同样的问题[。](https://stackoverflow.com/questions/1452995/why-doesnt-a-python-dict-update-return-the-object)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-23T23:12:59.013

由于这是我在搜索“django return saved object”时得到的第一个结果，为了恭维安德鲁的回答，如果你仍然想返回保存的对象，而不是使用：

```
ExampleModel(title=title).save() 
```

返回无，您将使用：

```
saved_instance = ExampleModel.objects.create(title=title) 
```

这是有效的，因为`ExampleModel.objects`它是[模型管理器](https://docs.djangoproject.com/en/2.2/topics/db/managers/)而不是类的实例，所以它不会返回自身。

# c# - 如何在 ASP.NET 实体框架中访问旧实体值

> ID：10936738
> 
> 赞同：7
> 
> 时间：2012-06-07T17:23:18.840
> 
> 标签：c#, asp.net, entity-framework

我有一个小的 ASP.Net mvc3 应用程序，我正在编辑部分。我有默认模板：

```
public ActionResult Edit(int id)
{
    User user = db.Users.Find(id); 
    return View(user);
}

public ActionResult Edit(User user)
{
    //(Here access to old user name for example)
    db.Entry(user).State = EntityState.Modified;
    db.SaveChanges();
} 
```

如果我做 user.name 我有新值，但我想在保存之前访问 db 值。

谢谢 ！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-08T12:45:34.773

我用一个小技巧让它工作：

```
db.Users.Attach(user);
var current = db.Entry(user).CurrentValues.Clone();
db.Entry(user).Reload();
//Do you user(from db) stuff
db.Entry(user).CurrentValues.SetValues(current);
db.Entry(user).State = EntityState.Modified;
db.SaveChanges(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-09-26T22:42:19.213

context.Entry(YourEntity).GetDatabaseValues().ToObject() 作为 YourEntity

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:26:31.130

这个怎么样：

```
public ActionResult Edit(User user)
{
    User oldUser = db.Users.Find(user.id);
    // oldUser object represents the user before the modification
    ...
    db.Entry(user).State = EntityState.Modified;
    db.SaveChanges();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-12T19:32:38.573

添加到 lkaradashkov 的答案。您可以尝试使用选项 AsNoTracking() 来防止实体框架跟踪它。

```
public ActionResult Edit(User user)
{
    User oldUser = db.Users.AsNoTracking().Single(x=>x.id.equals(user.id));
    // oldUser object represents the user before the modification
    ...
    db.Entry(user).State = EntityState.Modified;
    db.SaveChanges();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-29T07:17:40.270

如果您想将旧值和新值分开：

```
 //user.UserName = "oldtest"     
 user.UserName = "Test"     
 var originalValues = db.Entry(user).OriginalValues.Clone();
 var originalval = originalValues.GetValue<string>("UserName");
 var currentvalue = db.Entry(user).CurrentValues.Clone();
 var curretval = currentvalue.GetValue<string>("UserName"); 
```

这将在将新用户名设置为“oldtest”之前将 originalval 作为旧值返回，并且 curretval 将新用户名返回为“Test”

# mysql - MySql 和 Glassfish：分配连接时出错

> ID：10936746
> 
> 赞同：1
> 
> 时间：2012-06-07T17:23:56.887
> 
> 标签：mysql, rest, netbeans, glassfish

环境：Amazon EC2 Netbeans IDE 上的 Windows Server 2008 R2 与 Glassfish 在其上启动 MySql 在 WAMP 上运行。

我已经从 mysql 数据库创建了宁静的 Web 服务。我的数据库表中没有包含空格的字段名。

当我测试“RESTful Web 服务”时，测试 RESTful Web 服务页面打开，我可以在右侧看到不同的实体。

当我选择其中任何一个并尝试获取数据时，我得到 HTTP 状态 500，并出现以下错误：

> > GET RequestFailed RequestFailed --> 状态：(500) 响应：{ HTTP 状态 500 -
> 
> 类型异常报告
> 
> 信息
> 
> 描述服务器遇到一个内部错误 () 阻止它完成这个请求。
> 
> 例外
> 
> javax.persistence.PersistenceException：异常 [EclipseLink-4002]（Eclipse Persistence Services - 2.0.1.v20100213-r6600）：org.eclipse.persistence.exceptions.DatabaseException 内部异常：java.sql.SQLException：分配连接时出错。原因：空错误代码：0
> 
> note 异常的完整堆栈跟踪及其根本原因可在 GlassFish Server Open Source Edition 3.0.1 日志中找到。GlassFish Server 开源版 3.0.1
> 
> }

**GlassFish 日志的完整堆栈跟踪：**

```
WARNING: The DatabaseSession has an external transaction controller defined by something other than the ServerPlatform. EclipseLink will permit the override of the external transaction controller, but we recommend you consider the alternative of subclassing org.eclipse.persistence.platform.server.ServerPlatformBase and override getExternalTransactionControllerClass().
INFO: EclipseLink, version: Eclipse Persistence Services - 2.0.1.v20100213-r6600
WARNING: RAR5117 : Failed to obtain/create connection from connection pool [ mysql_DEPM_rootPool ]. Reason : com.sun.appserv.connectors.internal.api.PoolingException
WARNING: RAR5114 : Error allocating connection : [Error in allocating a connection. Cause: null]
SEVERE: Local Exception Stack: 
Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.0.1.v20100213-r6600): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: java.sql.SQLException: Error in allocating a connection. Cause: null
Error Code: 0
    at org.eclipse.persistence.exceptions.DatabaseException.sqlException(DatabaseException.java:309)
    at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:138)
    at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:94)
    at org.eclipse.persistence.sessions.DatasourceLogin.connectToDatasource(DatasourceLogin.java:162)
    at org.eclipse.persistence.internal.sessions.DatabaseSessionImpl.loginAndDetectDatasource(DatabaseSessionImpl.java:584)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryProvider.login(EntityManagerFactoryProvider.java:228)
    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.deploy(EntityManagerSetupImpl.java:369)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.getServerSession(EntityManagerFactoryImpl.java:151)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManagerImpl(EntityManagerFactoryImpl.java:207)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:195)
    at com.sun.enterprise.container.common.impl.EntityManagerFactoryWrapper.createEntityManager(EntityManagerFactoryWrapper.java:101)
    at controller.DisciplinesJpaController.getEntityManager(DisciplinesJpaController.java:35)
    at controller.DisciplinesJpaController.findDisciplinesEntities(DisciplinesJpaController.java:127)
    at controller.DisciplinesJpaController.findDisciplinesEntities(DisciplinesJpaController.java:119)
    at service.DisciplinesRESTFacade.findAll(DisciplinesRESTFacade.java:84)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$TypeOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:149)
    at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:67)
    at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:259)
    at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:83)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:133)
    at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:71)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:990)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:941)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:932)
    at com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:384)
    at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:451)
    at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:632)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1523)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:188)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:641)
    at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:97)
    at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:85)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:185)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:325)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:226)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:165)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:791)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:693)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:954)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:170)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:135)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:102)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:88)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:76)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:53)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:57)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:69)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:330)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:309)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.sql.SQLException: Error in allocating a connection. Cause: null
    at com.sun.gjc.spi.base.DataSource.getConnection(DataSource.java:112)
    at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:126)
    ... 54 more

SEVERE: The RuntimeException could not be mapped to a response, re-throwing to the HTTP container
javax.persistence.PersistenceException: Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.0.1.v20100213-r6600): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: java.sql.SQLException: Error in allocating a connection. Cause: null
Error Code: 0
    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.deploy(EntityManagerSetupImpl.java:397)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.getServerSession(EntityManagerFactoryImpl.java:151)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManagerImpl(EntityManagerFactoryImpl.java:207)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:195)
    at com.sun.enterprise.container.common.impl.EntityManagerFactoryWrapper.createEntityManager(EntityManagerFactoryWrapper.java:101)
    at controller.DisciplinesJpaController.getEntityManager(DisciplinesJpaController.java:35)
    at controller.DisciplinesJpaController.findDisciplinesEntities(DisciplinesJpaController.java:127)
    at controller.DisciplinesJpaController.findDisciplinesEntities(DisciplinesJpaController.java:119)
    at service.DisciplinesRESTFacade.findAll(DisciplinesRESTFacade.java:84)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$TypeOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:149)
    at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:67)
    at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:259)
    at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:83)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:133)
    at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:71)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:990)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:941)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:932)
    at com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:384)
    at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:451)
    at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:632)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1523)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:188)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:641)
    at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:97)
    at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:85)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:185)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:325)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:226)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:165)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:791)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:693)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:954)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:170)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:135)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:102)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:88)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:76)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:53)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:57)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:69)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:330)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:309)
    at java.lang.Thread.run(Thread.java:722)
Caused by: Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.0.1.v20100213-r6600): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: java.sql.SQLException: Error in allocating a connection. Cause: null
Error Code: 0
    at org.eclipse.persistence.exceptions.DatabaseException.sqlException(DatabaseException.java:309)
    at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:138)
    at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:94)
    at org.eclipse.persistence.sessions.DatasourceLogin.connectToDatasource(DatasourceLogin.java:162)
    at org.eclipse.persistence.internal.sessions.DatabaseSessionImpl.loginAndDetectDatasource(DatabaseSessionImpl.java:584)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryProvider.login(EntityManagerFactoryProvider.java:228)
    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.deploy(EntityManagerSetupImpl.java:369)
    ... 49 more
Caused by: java.sql.SQLException: Error in allocating a connection. Cause: null
    at com.sun.gjc.spi.base.DataSource.getConnection(DataSource.java:112)
    at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:126)
    ... 54 more

WARNING: StandardWrapperValve[ServletAdaptor]: PWC1406: Servlet.service() for servlet ServletAdaptor threw exception
javax.persistence.PersistenceException: Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.0.1.v20100213-r6600): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: java.sql.SQLException: Error in allocating a connection. Cause: null
Error Code: 0
    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.deploy(EntityManagerSetupImpl.java:397)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.getServerSession(EntityManagerFactoryImpl.java:151)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManagerImpl(EntityManagerFactoryImpl.java:207)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:195)
    at com.sun.enterprise.container.common.impl.EntityManagerFactoryWrapper.createEntityManager(EntityManagerFactoryWrapper.java:101)
    at controller.DisciplinesJpaController.getEntityManager(DisciplinesJpaController.java:35)
    at controller.DisciplinesJpaController.findDisciplinesEntities(DisciplinesJpaController.java:127)
    at controller.DisciplinesJpaController.findDisciplinesEntities(DisciplinesJpaController.java:119)
    at service.DisciplinesRESTFacade.findAll(DisciplinesRESTFacade.java:84)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$TypeOutInvoker._dispatch(AbstractResourceMethodDispatchProvider.java:149)
    at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:67)
    at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:259)
    at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:83)
    at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:133)
    at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:71)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:990)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:941)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:932)
    at com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:384)
    at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:451)
    at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:632)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1523)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:188)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:641)
    at com.sun.enterprise.web.WebPipeline.invoke(WebPipeline.java:97)
    at com.sun.enterprise.web.PESessionLockingStandardPipeline.invoke(PESessionLockingStandardPipeline.java:85)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:185)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:325)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:226)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:165)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:791)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:693)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:954)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:170)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:135)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:102)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:88)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:76)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:53)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:57)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:69)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:330)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:309)
    at java.lang.Thread.run(Thread.java:722)
Caused by: Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.0.1.v20100213-r6600): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: java.sql.SQLException: Error in allocating a connection. Cause: null
Error Code: 0
    at org.eclipse.persistence.exceptions.DatabaseException.sqlException(DatabaseException.java:309)
    at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:138)
    at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:94)
    at org.eclipse.persistence.sessions.DatasourceLogin.connectToDatasource(DatasourceLogin.java:162)
    at org.eclipse.persistence.internal.sessions.DatabaseSessionImpl.loginAndDetectDatasource(DatabaseSessionImpl.java:584)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryProvider.login(EntityManagerFactoryProvider.java:228)
    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.deploy(EntityManagerSetupImpl.java:369)
    ... 49 more
Caused by: java.sql.SQLException: Error in allocating a connection. Cause: null
    at com.sun.gjc.spi.base.DataSource.getConnection(DataSource.java:112)
    at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:126)
    ... 54 more 
```

您可以尝试通过以下方式访问服务器上的 RESTful Web 服务： [http ://ec2-23-22-180-93.compute-1.amazonaws.com:13495/WebApplication2/resources/entities.disciplines](http://ec2-23-22-180-93.compute-1.amazonaws.com:13495/WebApplication2/resources/entities.disciplines)

我在另一台 Windows 7 机器上对同一个数据库做了同样的事情，它工作正常。

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-15T11:24:27.370

我在另一个具有更高 RAM 的 Amazon EC2 实例上尝试了相同的设置，它可以正常工作！早些时候，我使用的是具有 613 MB RAM 的 EC2 实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T15:19:57.463

为避免 Glassfish 在您尝试部署应用程序时使用其内部 Derby 数据库，您必须通过选择您自己先前定义的连接池来更改 JDBC 资源“jdbc/__default”的值。再见。

# c# - 在进行 Jenkins 构建时，如何忽略某个类别的 NUnit 测试？

> ID：10936748
> 
> 赞同：5
> 
> 时间：2012-06-07T17:24:10.477
> 
> 标签：c#, nunit, continuous-integration, hudson, jenkins

在进行 Jenkins 构建时，如何忽略某个类别的 NUnit 测试？我知道如何在 Team City 中做到这一点。我们的生产环境使用 Jenkins，而我们的开发人员使用 Team City。在 Jenkins 上进行生产构建时，我需要忽略一些测试（数据库集成）。任何链接、提示或代码都值得赞赏。

```
[Test, Category("DBExclude")]
public void WidgetRepository_FindById_ReturnsWidget()
{
   //I should not run on Jenkins
} 
```

谢谢大家！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-08T03:36:16.247

如果您使用 Windows Batch 命令执行 NUnit 测试作为 Jenkins 作业的一部分，您可以简单地在分配给测试的类别上使用命令行选项“/exclude”。对于您给出的示例，该命令类似于...

```
nunit-console /exclude:DBExclude nunit.tests.dll 
```

而且，为了记录，您可以以其他方式执行此操作，并选择使用特定类别运行测试，而不是仅使用以下方法运行测试（再次使用您的示例）：

```
nunit-console /include:DBExclude nunit.tests.dll 
```

NUnit 的文档详细介绍了这些选项以及更多信息：[NUnit 文档](http://www.nunit.org/index.php?p=consoleCommandLine&r=2.6)

# c# - 使用 cookie 从 URL 下载文件

> ID：10936749
> 
> 赞同：1
> 
> 时间：2012-06-07T17:24:13.823
> 
> 标签：c#, .net, windows, cookies

我正在尝试从 Web 服务器下载文件，例如

```
http://web.server.com/getfile=2 
```

现在在网络浏览器中我可以做到这一点，因为我已经验证了自己并且可以查看允许访问文件的 cookie。

我做了相当多的研究，并相信 cookie 容器会保存 cookie，尽管我无法确定如何使用 CookieContainer 从 C# 中下载此文件

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T18:09:38.047

在 c# 中，您应该使用 WebClient。虽然它可以独立使用，但这样的代码将减少您每次添加 cookie 标头的麻烦。

```
public class CookieAwareWebClient : WebClient
{
    private readonly CookieContainer m_container = new CookieContainer();

    protected override WebRequest GetWebRequest(Uri address)
    {
        WebRequest request = base.GetWebRequest(address);
        HttpWebRequest webRequest = request as HttpWebRequest;
        if (webRequest != null)
        {
            webRequest.CookieContainer = m_container;
        }
        return request;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:49:31.857

向包含 cookie 的页面发出 HTTP get 请求，存储 cookie 并附加到 getfile 的第二个请求。

待办事项：添加示例

# jquery - 在没有 jquery 表排序器干扰的情况下向表中添加附加标题

> ID：10936750
> 
> 赞同：0
> 
> 时间：2012-06-07T17:24:21.663
> 
> 标签：jquery, jquery-ui, tablesorter

我需要在表格顶部添加一个额外的标题。目的只是为了告诉表是关于什么的。因此我不需要任何排序。但问题是 jquery 表排序器会干扰它，因为我将它添加到表排序器类中。到目前为止，这是我的代码：

```
 <script type="text/javascript">
    jQuery(document).ready(function() { 

        jQuery("table").tablesorter({ 

    }); 

    });
    </script>
        puts "<table cellspacing=\"1px\" class=\"tablesorter\" >"
        puts "<thead>"
        puts "<tr>"
        puts    "<th>Search</th>"
        puts    "<th>Sub-App</th>"
        puts    "<th>Division</th>"

        puts "</tr>"
        puts "</thead>"
        puts "<tbody>"

        puts "<tr>"
        puts    "<td>$level</td>"
        puts    "<td>$div_name</td>"
        puts    "<td>$reg_name</td>"

        puts "</tr>"

        puts "</tbody>"
        puts "</table>" 
```

这是我要添加的内容

```
 puts "<table cellspacing=\"1px\" class=\"tablesorter\" >"
            puts "<thead>"
            puts "<tr><th>Search Division/Region</th></tr>
            puts "<tr>"
            puts    "<th>Search</th>"
            # and so on
            puts    "<th>Sub-App</th>" 
```

我可以在不破坏页面的情况下获得一些解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T02:38:58.840

我认为第一行只是缺少一个`colspan="3"`. 尝试使用此 HTML（[演示](http://jsfiddle.net/Mottie/vCTHw/160/)）：

```
<thead>
    <tr><th colspan="3">Search Division/Region</th></tr>
    <tr><th>Search</th><th>Sub-App</th><th>Division</th></tr>
</thead> 
```

然后通过将排序器设置为 false 来禁用第一个标题单元格：

```
$('table').tablesorter({
    headers : {
        0 : { sorter: false }
    },
    widgets: ['zebra']
}); 
```

# forms - 复选框标签中的Spring 3多个值

> ID：10936753
> 
> 赞同：0
> 
> 时间：2012-06-07T17:24:46.230
> 
> 标签：forms, spring

我有一个不包含主 ID 的数据库表，我需要使用表中的两个值删除行，以便该行是唯一的。

对于 jsp 上显示的每个结果行，我都有一个复选框。

我需要看看我是否可以做这样的事情，我通过弹簧表单标签发布两个数组列表？

`<form:checkbox path="valuesList1" value="${object.value1}" path="valuesList2" value="${object.value2}"/>`

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:41:47.887

这不受支持，但是您可以使用特殊分隔符将您的值合并为一个，例如“:::”，然后将它们拆分回控制器中。

# php - 如何为zend服务器（PHP）安装MongoDb驱动程序

> ID：10936756
> 
> 赞同：3
> 
> 时间：2012-06-07T17:25:08.747
> 
> 标签：php, zend-framework, mongodb, zend-server

我使用的是 php 5.2 版本，并且我已经在 zend 服务器中安装了 mongodb 驱动程序。还在 php.ini 文件中添加了扩展参数，即 extesnions=mongoddb.dll。

但是，当我在本地机器上运行 phpinfo 页面时，没有显示 mongodb 详细信息。

任何想法，如何在 zendserver 上安装 mongodb 驱动程序，请。引导我

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-07T20:29:53.870

我会检查您是否拥有 Zend Server 使用的 php.ini 的正确路径。默认情况下，这应该是：

```
C:\Program Files\Zend\ZendServer\etc\php.ini 
```

您可以通过创建包含以下内容的 test.php 来确认这一点：

```
<?php phpinfo(); ?> 
```

在 Web 浏览器中查看 test.php（通过 Zend Server 提供）并搜索“配置文件 (php.ini) 路径”以验证 ini 路径。

添加到 php.ini 的附加行是：

```
extension=php_mongo.dll 
```

假设您从以下网址下载正确的 32 位或 64 位 Windows zip： [https ://github.com/mongodb/mongo-php-driver/downloads](https://github.com/mongodb/mongo-php-driver/downloads)

.. 您需要从 zip 中复制并重命名相应的 DLL，它应该类似于：

```
php_mongo-1.2.10-5.2-vc9-nts.dll => C:\Program Files\Zend\ZendServer\lib\php_extensions\php_mongo.dll 
```

安装扩展并重新启动 Zend Server 后，建议您重新访问 test.php (phpinfo) 输出以确认“mongo”扩展现在已启用。

# ios - XCode 中的 PDF 生成

> ID：10936758
> 
> 赞同：-2
> 
> 时间：2012-06-07T17:25:16.857
> 
> 标签：ios, pdf-generation

我是 iPhone 开发的新手。我打算为 iPhone 做一个 PDF 应用程序。功能是：

1.  用户将在文本字段中输入他们的输入（这将是 PDF 文件的内容）。
2.  我必须在保存时通过代码修改 PDF 文件（段落、表格、项目符号等）。
3.  用户可以用自己的名字保存。
4.  用户可以将 PDF 文件作为 MFMailComposer 的附件发送。

所以我搜索并获得了很多链接。但是，我没有找到在 iPhone/iPad 中创建和修改 PDF 文件的任何主要细节。

谁能给我一个很好的参考来做到这一点。有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:35:01.090

我使用了这个参考：[https ://developer.apple.com/library/ios/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_pdf/dq_pdf.html](https://developer.apple.com/library/ios/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_pdf/dq_pdf.html)

它包含理论解释和源代码示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-19T18:28:30.337

请使用以下链接下载**iOS 中 PDF 阅读器/查看器的示例应用程序**

[iOS 中的 PDF 阅读器/查看器](https://github.com/vfr/Reader)

另请查看以下链接中有关 pdf 创建、操作等的详细信息

[developer.apple：PDF 文档创建、查看和转换](https://developer.apple.com/library/mac/#documentation/graphicsimaging/conceptual/drawingwithquartz2d/dq_pdf/dq_pdf.html)

[快速和精益的 pdf-viewer-for-iphone](https://stackoverflow.com/questions/3889634/fast-and-lean-pdf-viewer-for-iphone-ipad-ios-tips-and-hints)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:34:27.037

如果您正在做一个 Phonegap 应用程序，我会说 got for [jsPDF](http://code.google.com/p/jspdf/)，这将使您能够在 Javascript 中创建（基本）PDF 文件。我不做 Obj-C，但快速浏览 SO 提供了[很好的链接](https://stackoverflow.com/questions/4362734/ios-sdk-programmatically-generate-a-pdf-file)。

# android - 图像变换同时应用旋转、拖动和缩放

> ID：10936762
> 
> 赞同：0
> 
> 时间：2012-06-07T17:25:43.347
> 
> 标签：android

我想同时在图像上应用旋转、拖动和缩放。图像拖动和缩放工作正常，但一旦我应用旋转图像质量就会丢失。请给我任何同时对图像进行旋转、移动和缩放的示例，并且应用转换后图像质量不应该丢失

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:31:54.810

查看 Maps API 扩展中的 MapsDemo。它实现了一个平滑的画布以旋转地图。他们通过打开用于绘制图像的 Paint 中的过滤来做到这一点。

```
private final Paint mSmooth = new Paint(Paint.FILTER_BITMAP_FLAG); 
```

由于从源像素到目标像素的映射只能在 90 度点处完美，因此旋转时总会丢失一些质量。

顺便说一句，我认为您的意思不是拖动，而是翻译。

# javascript - 使用 node.js 同步写入非常大的数据块

> ID：10936765
> 
> 赞同：0
> 
> 时间：2012-06-07T17:25:59.443
> 
> 标签：javascript, node.js, io

我正在尝试将一个非常大的数据块（由 JSON.stringify 产生）写入文件。它必须是同步的，因为我想在 process:exit 事件期间保存它。但是，当使用 fs.writeFileSync() 时，Node 会抛出以下消息：

```
FATAL ERROR: JS Allocation failed - process out of memory 
```

我试过 fs.createWriteStream()，但它似乎不起作用。此代码输出 0 字节，数据量中等，大则抛出相同的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T18:20:30.033

我认为你需要的是一个“泵”。像[http://elegantcode.com/2011/04/06/taking-baby-steps-with-node-js-pumping-data-between-streams/](http://elegantcode.com/2011/04/06/taking-baby-steps-with-node-js-pumping-data-between-streams/)这样的东西会减轻你的内核缓冲区，他们不必持有所有一直是文字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-04T23:16:02.333

我的问题出在 JSON.stringify 中。数据太大而无法存储在唯一的 JavaScript 字符串中。

我通过每行序列化一个属性解决了这个问题（因此对 JSON.stringify 有 X 次调用，其中 X 是我的对象中的属性数）。我的反序列化器通过添加每个属性来重建对象。

# c# - 将提示框值从 javascript 函数 - PostBack 传递到 c#

> ID：10936766
> 
> 赞同：5
> 
> 时间：2012-06-07T17:26:03.343
> 
> 标签：c#, javascript, asp.net

我会尽我所能表达我想要做的事情。

让我先说我对 C# 和 ASP.NET 非常陌生，并且对 javascript 的经验很少。

我有一个调用提示框的 javascript 函数。整体情况是 - 如果输入了输入 - 它将被保存到数据库中的一列。

在将值从提示框中传递到 c# 中的 PostBack 时，我画了一个空白。

```
function newName()
{
    var nName = prompt("New Name", " ");
    if (nName != null)
    {
        if (nName == " ")
        {
            alert("You have to specify the new name.");
            return false;
        }
        else
        {
            // i think i need to getElementByID here???
            //document.forms[0].submit();
        }
    }
} 
```

这就是我在 C# 中所拥有的：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        //I have other code that works here
    }
    else
    {
        //I'm totally lost here
    }
} 
```

我试图弄清楚如何对来自 javascript 函数的输入进行调用。

在过去的几个小时里，我一直在网上和书中寻找。不知所措。

编辑

我做了一些调整以适应我正在尝试做的事情....

```
<asp:HiddenField ID="txtAction" runat="server" Value="" /> 

document.forms(0).txtAction.Value = "saveevent"; 
document.forms(0).submit(); 
```

现在想弄清楚如何将字符串插入表中.....

```
 string nEvent = Request.Form["event"]; 
    if (txtAction.Value == "saveevent") { 
                   nName.Insert(); //am i on the right track? 
                 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:37:22.633

好吧，这是一种可能的方法（未经测试，但应该给你基本的想法）。您可以在表单上放置一个隐藏字段来保存提示的值：

```
<input type="hidden" id="hiddenNameField" runat="server" value=""> 
```

然后提示用户输入值，将其设置为隐藏字段，然后提交您的表单：

```
document.getElementById('hiddenNameField').value = nName;
document.forms(0).submit(); 
```

然后在您的代码隐藏中，您可以访问`hiddenNameField.Value`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:14:39.750

这是一个非常好的资源，包含您问题的答案：

[如何使用 __doPostBack()](https://stackoverflow.com/questions/3591634/how-to-use-dopostback)

基本上，`PostbackWithParameter()`从你的其他 JS 函数调用函数：

```
<script type="text/javascript">
function PostbackWithParameter(parameter)
{
    __doPostBack(null, parameter)
}
</script> 
```

在您的代码隐藏中，获取该参数的值，如下所示：

```
public void Page_Load(object sender, EventArgs e)
{
    string parameter = Request["__EVENTARGUMENT"];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:40:40.213

如果您尝试使用 java 脚本在背面调用该方法，您可以尝试使用 web 方法方法。

例如，您有一个将调用 SendForm 方法的函数

```
 function SendForm() {
         var name = $("#label").text();
         PageMethods.SendForm(name,
          OnSucceeded, OnFailed);
     }
     function OnSucceeded() {   
     }
     function OnFailed(error) {
     } 
```

并且您拥有将从 javascript 调用的方法。

```
 [WebMethod(enableSession: true)]
    public static void SendForm(string name)
    {

    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T17:41:41.060

```
<script language='Javascript'> 
__doPostBack('__Page', ''); 
</script> 
```

[使用 javascript 从 Postback](https://stackoverflow.com/questions/2920984/postback-using-javascript)复制

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-07T18:02:45.917

我认为您在这里需要 AJAX 请求。我建议使用 jQuery，因为这些狗对你有用……否则，你将不得不为 AJAX 处理实现很多已经编写好的通用代码。

如下所示：

```
function PromptSomewhere(/* some args if needed*/)
{
    var nName = prompt("New Name", " ");
    // Do process your prompt here... as your code in JS above. Not placed here to be more readable.
    // nName is used below in the AJAX request as a data field to be passed.

    $.ajax({
        type: "post", // may be get, put, delete also
        url: 'place-the-url-to-the-page',
        data {
            name: nName
            // You may put also other data
        },
        dataType: "json",
        error: PromptFailed,
        success: OnPromptComplete
    });
}

function  PromptFailed(xhr, txtStatus, thrownErr) // The arguments may be skipped, if you don't need them
{
    // Request error handling and reporting here (404, 500, etc.), for example:
    alert('Some error text...'); // or
    alery(txtStatus); // etc.
}

function OnPromptComplete(res)
{
    if(!res)
        return;

    if(res.code < 0)
    {
        // display some validation errors
        return false;
    }

    // display success dialog, message, or whatever you want

    $("div.status").html(result.message);
} 
```

这将使您能够通过异步请求向服务器动态发送数据。现在 C#：

```
using System.Web.Script.Serialization;

protected void Page_Load(object sender, EventArgs e)
{
    if(IsPostBack && ScriptManager.GetCurrent(this).IsInAsyncPostBack)
    {
        string nName = Request.Form["name"];

        // do validation and storage of accepted value
        // prepare your result object with values 

        result.code = some code for status on the other side
        result.message = 'Some descriptive message to be shown on the page';

        // return json result
        JavaScriptSerializer serializer = new JavaScriptSerializer();

        Response.Write(serializer.Serialize(result));
    }
} 
```

**注意：如果您使用 ASP.NET MVC 2 或更高版本，我认为，您将能够使用 JsonResult 操作和`Request.IsAjaxRequest`（我认为是名称），以及 ASP.NET 的许多其他设施和改进 - ASP.NET MVC 是新的基于 MVC 模式（架构）创建 Web 应用程序的方法，并将在一段时间内最终取代 ASP.NET 页面。**

# python - 使用 Numpy 重新排列矩阵元素

> ID：10936767
> 
> 赞同：10
> 
> 时间：2012-06-07T17:26:05.440
> 
> 标签：python, matrix, numpy

我有一个 NumPy 矩阵，我已经对其进行了简化以举例说明：

```
 a  b  c  d  e  f 
A =  [[0, 1, 2, 3, 4, 5],
 b    [1, 0, 3, 4, 5, 6],
 c    [2, 3, 0, 5, 6, 7],
 d    [3, 4, 5, 0, 7, 8],
 e    [4, 5, 6, 7, 0, 9],
 f    [5, 6, 7, 8, 9, 0]] 
```

“十字路口”的数字很重要，但它们的顺序不正确。我想重新排列行和列，使新顺序为 [a, d, b, e, c, f] 但我称之为“交集”的这个值是相同的。

下面我已经开始按照我想要的方式转换矩阵。填充“e”行涉及查看上面的交叉点 (e,a) (= 4)，然后是 (e,d) (=7) ，然后是 (e,b) (=5)，(e,e) , (e,c) 和 (e,f)

```
 a  d  b  e  c  f
A1=  [[0, 3, 1, 4, 2, 5],
 d    [3, 0, 4, 7, 5, 8],
 b    [1, 4, 0, 5, 3, 6],  
 e    [4, 7, 5, 
```

谁能建议如何以这种方式重新排列我的矩阵？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-07T17:48:54.287

**编辑：**我刚刚偶然发现了一个使用[高级索引](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html#advanced-indexing)的 NumPy 解决方案：

```
#                 a  b  c  d  e  f
A = numpy.array([[0, 1, 2, 3, 4, 5],
                 [1, 0, 3, 4, 5, 6],
                 [2, 3, 0, 5, 6, 7],
                 [3, 4, 5, 0, 7, 8],
                 [4, 5, 6, 7, 0, 9],
                 [5, 6, 7, 8, 9, 0]])

#            a  d  b  e  c  f
new_order = [0, 3, 1, 4, 2, 5]
A1 = A[:, new_order][new_order] 
```

这是一个可以转移到 NumPy 的纯 Python 解决方案：

```
#     a  b  c  d  e  f
A = [[0, 1, 2, 3, 4, 5],
     [1, 0, 3, 4, 5, 6],
     [2, 3, 0, 5, 6, 7],
     [3, 4, 5, 0, 7, 8],
     [4, 5, 6, 7, 0, 9],
     [5, 6, 7, 8, 9, 0]]

#            a  d  b  e  c  f
new_order = [0, 3, 1, 4, 2, 5]    # maps previous index to new index
A1 = [[A[i][j] for j in new_order] for i in new_order] 
```

结果：

```
>>> pprint.pprint(A1)
[[0, 3, 1, 4, 2, 5],
 [3, 0, 4, 7, 5, 8],
 [1, 4, 0, 5, 3, 6],
 [4, 7, 5, 0, 6, 9],
 [2, 5, 3, 6, 0, 7],
 [5, 8, 6, 9, 7, 0]] 
```

这是一个`A`就地修改的版本：

```
A[:] = [A[i] for i in new_order]
for row in A:
    row[:] = [row[i] for i in new_order] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-07T17:54:23.983

Numpy 提供了[许多](http://docs.scipy.org/doc/numpy/reference/routines.array-manipulation.html)操作数组的方法，包括[沿 xis 滚动元素](http://docs.scipy.org/doc/numpy/reference/generated/numpy.roll.html#numpy.roll)、[滚动所有轴](http://docs.scipy.org/doc/numpy/reference/generated/numpy.rollaxis.html#numpy.rollaxis)、[交换轴](http://docs.scipy.org/doc/numpy/reference/generated/numpy.swapaxes.html#numpy.swapaxes)。您可以使用这些组合来获得所需的元素顺序

# asp.net-mvc - 如何构建一个同时拥有 OpenID 和本地用户的 MVC 站点？

> ID：10936769
> 
> 赞同：2
> 
> 时间：2012-06-07T17:26:08.210
> 
> 标签：asp.net-mvc, asp.net-membership, openid, dotnetopenauth

我们有一个 MVC 网站，它将使用[DotNetOpenAuth](http://nuget.org/packages/DotNetOpenAuth)通过 OpenID 登录用户，我发现这个[非常有用的模板](http://visualstudiogallery.msdn.microsoft.com/81153747-70d7-477b-b85a-0374e7edabef)和[其他更简单的示例](https://stackoverflow.com/questions/3218225/using-openid-via-dotnetopenauth-along-with-user-roles-and-other-membership-pro)将帮助我在这方面开始。但是，**我还没有完全弄清楚如果我的用户不想使用 OpenID，如何为他们提供一种在我们这里创建帐户的方法。**

我可以在这里看到两个选项，编写一些自定义代码，允许 OpenID 搭载标准会员提供程序。或者，让最终站点仅通过 DotNetOpenAuth 使用 OpenID，并为我的用户构建一个身份提供程序以进行注册。这样，该站点将只看到 OpenID 用户并且不知道有什么区别。

这些是我唯一的选择吗？我找不到任何关于建立我自己的身份提供者的东西，只是依赖方模板。我想我可以将 OpenID 放在默认的会员提供者之上，但这感觉就像我做错了，因为我应该能够站起来一个身份提供者。

那么，在我的情况下，通过创建本地帐户和通过 DotNetOpenAuth 支持 OpenID 的最佳方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T14:55:54.073

设置您自己的身份提供者以使您的网站只使用 OAuth 肯定是一种选择，但不是一个简单的选择。我不建议您设置身份提供者，除非您打算让您的客户使用它来登录其他网站。

还要记住，大多数网站不使用 OAuth 进行身份验证（因为它不是身份验证协议）。OpenID 更受欢迎。

您在问题中链接到的项目模板演示了允许用户通过多个 OpenID 提供者登录，并*包括对链接用户帐户的支持*。

至于支持本地用户帐户，我建议您查看[nerddinner.com](http://nerddinner.com)背后的[源代码](http://nerddinner.codeplex.com/)。我建议*不要*对 OpenID/OAuth 帐户使用 ASP.NET Membership 提供程序，因为该界面不太适合，但人们已经让它工作，所以如果你愿意，你也可以。

# xml - 我可以在 RELAX NG 紧凑模式中指定模式位置吗？

> ID：10936773
> 
> 赞同：6
> 
> 时间：2012-06-07T17:26:16.257
> 
> 标签：xml, xsd, relaxng

我想使用 Relax NG 紧凑模式。我是否以我对 XSD 的方式指定 .rnc 文件`xsi:schemaLocation`？我不想将 Relax NG 转换为 XSD，因为 XSD 的限制对我来说是个问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-07T18:09:22.743

xsi:schemaLocation 特定于 XML 模式。

如果您需要在文档中指定 RNG 模式的位置（这种做法的用处并不总是很明显；），您可以使用[XML 模型处理指令](http://www.w3.org/TR/2011/NOTE-xml-model-20110811/#the-xml-model-processing-instruction)（当然假设您使用支持它的工具，建议还年轻）。

# sharepoint - 如何为自定义内容类型创建新表单

> ID：10936774
> 
> 赞同：0
> 
> 时间：2012-06-07T17:26:22.740
> 
> 标签：sharepoint, sharepoint-2010, content-type, sharepoint-api

我正在通过 Visual Studio 中的 Elements.xml 文件创建新的内容类型。我在 XmlDocment 节点中引用了一个自定义的新表单文档

```
 <XmlDocument NamespaceURI="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms">
    <FormTemplates  xmlns="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms">
      <Display>ListForm</Display>
      <Edit>ListForm</Edit>
      <New>MyNewList</New>
    </FormTemplates>
  </XmlDocument> 
```

现在，当我创建内容类型的新实例时，我得到一个空白。我已经读到这个新节点应该引用一个 ASCX 控件。但是，我还没有找到任何可以引导我完成整个过程的好例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:15:09.147

您在`<New></New>`元素中指定的值是`RenderingTemplate`_controltemplates 目录中控件的 ID。如果你打开

```
C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\14\TEMPLATE\CONTROLTEMPLATES\DefaultTemplates.ascx 
```

您将看到 SharePoint 使用的呈现模板，包括`ListForm`. 您可以通过在同一目录中创建新的 ASCX 文件来创建自己的渲染模板。[这篇文章](http://blog.octavie.nl/index.php/2011/09/04/customizing-listitem-forms-using-renderingtemplates/)将引导您完成此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-08T16:15:32.110

谢谢亚历克斯...为你回答。

我了解了使用 FormTemplates 与 FormUrls 元素之间的区别。FormsTemplate 用于引用自定义用户控件，使用现有的 aspx 页面。这由提供的链接 Alex 描述。一个同事指出了使用 FormUrls 的方向。FormUrls 用于引用一个全新的 aspx 页面。

```
 <XmlDocument NamespaceURI="http://schemas.microsoft.com/sharepoint/v3/contenttype/forms/url">
    <FormUrls xmlns:dd= "http://schemas.microsoft.com/sharepoint/v3/contenttype/forms/url">
      <New>_layouts/TMF/NewJobCard.aspx</New>
    </FormUrls>
  </XmlDocument> 
```

# macos - ESB 4.0.3 中的 WSO2 数据服务 (DS) 返回错误的故障消息

> ID：10936779
> 
> 赞同：0
> 
> 时间：2012-06-07T17:27:06.963
> 
> 标签：macos, wso2, wso2esb, wso2dss

我在 Apple 工作，我们正在使用带有数据服务功能的 WSO2 ESB 开发原型。我正在使用具有*DSS*功能的*WSO2 ESB 4.0.3 。*我已经部署了数据服务并从 ESB 中的代理服务调用数据服务。我使用的是*MAC OS X 10.7.4*，java 版本详细信息如下。

 **java 版本“1.6.0_31”Java(TM) SE 运行时环境（内部版本 1.6.0_31-b04-415-11M3635）Java HotSpot(TM) 64 位服务器 VM（内部版本 20.6-b01-415，混合模式）

我的 DS 服务需要某些参数，比如参数 A，但我没有在输入 XML 中传递该参数，我在 WSO2 ESB 控制台上看到以下错误。

```
[2012-06-07 09:49:11,348] ERROR - DataService DS Fault Message: Error in 'CallQuery.extractParams', cannot find parameter with type:query-param name:Hw_Serial_Nr
DS Code: INCOMPATIBLE_PARAMETERS_ERROR
Source Data Service:-
Name: OWCHECK
Location: /TQS_OWCHECK.dbs
Description: N/A
Default Namespace: http://ws.wso2.org/dataservice
Current Request Name: OWCHECK_OP
Current Params: {COUNTRYORIGIN=US, SUBDT=20090428}

DS Fault Message: Error in 'CallQuery.extractParams', cannot find parameter with type:query-param name:Hw_Serial_Nr
DS Code: INCOMPATIBLE_PARAMETERS_ERROR
Source Data Service:-
Name: OWCHECK
Location: /TQS_OWCHECK.dbs
Description: N/A
Default Namespace: http://ws.wso2.org/dataservice
Current Request Name: OWCHECK_OP
Current Params: {COUNTRYORIGIN=US, SUBDT=20090428}

    at org.wso2.carbon.dataservices.core.engine.CallQuery.extractParams(CallQuery.java:214)
    at org.wso2.carbon.dataservices.core.engine.CallQuery.execute(CallQuery.java:183)
    at org.wso2.carbon.dataservices.core.engine.CallQueryGroup.execute(CallQueryGroup.java:110)
    at org.wso2.carbon.dataservices.core.description.operation.Operation.execute(Operation.java:71)
    at org.wso2.carbon.dataservices.core.engine.DataService.invoke(DataService.java:592)
    at org.wso2.carbon.dataservices.core.engine.DSOMDataSource.execute(DSOMDataSource.java:99)
    at org.wso2.carbon.dataservices.core.engine.DSOMDataSource.serialize(DSOMDataSource.java:110)
    at org.wso2.carbon.dataservices.core.engine.DSOMDataSource.getReader(DSOMDataSource.java:116)
    at org.apache.axiom.om.impl.llom.OMSourcedElementImpl.getDirectReader(OMSourcedElementImpl.java:225)
    at org.apache.axiom.om.impl.llom.OMSourcedElementImpl.forceExpand(OMSourcedElementImpl.java:254)
    at org.apache.axiom.om.impl.llom.OMSourcedElementImpl.getFirstOMChild(OMSourcedElementImpl.java:867)
    at org.apache.axiom.om.impl.OMNavigator._getFirstChild(OMNavigator.java:196)
    at org.apache.axiom.om.impl.OMNavigator.updateNextNode(OMNavigator.java:140)
    at org.apache.axiom.om.impl.OMNavigator.getNext(OMNavigator.java:112)
    at org.apache.axiom.om.impl.SwitchingWrapper.updateNextNode(SwitchingWrapper.java:1113)
    at org.apache.axiom.om.impl.SwitchingWrapper.updateLastNode(SwitchingWrapper.java:1104)
    at org.apache.axiom.om.impl.SwitchingWrapper.next(SwitchingWrapper.java:1041)
    at javax.xml.stream.util.StreamReaderDelegate.next(StreamReaderDelegate.java:47)
    at org.apache.axiom.om.impl.builder.StAXOMBuilder.parserNext(StAXOMBuilder.java:681)
    at org.apache.axiom.om.impl.builder.StAXOMBuilder.next(StAXOMBuilder.java:214)
    at org.apache.axiom.om.impl.llom.OMSerializableImpl.build(OMSerializableImpl.java:78)
    at org.apache.axiom.om.impl.llom.OMElementImpl.build(OMElementImpl.java:722)
    at org.apache.axiom.om.impl.llom.OMElementImpl.cloneOMElement(OMElementImpl.java:1065)
    at org.wso2.carbon.tracer.module.handler.AbstractTracingHandler.storeMessage(AbstractTracingHandler.java:81)
    at org.wso2.carbon.tracer.module.handler.TracingMessageOutObservationHandler.invoke(TracingMessageOutObservationHandler.java:94)
    at org.apache.axis2.engine.Phase.invokeHandler(Phase.java:340)
    at org.apache.axis2.engine.Phase.invoke(Phase.java:313)
    at org.apache.axis2.engine.AxisEngine.invoke(AxisEngine.java:262)
    at org.apache.axis2.engine.AxisEngine.send(AxisEngine.java:427)
    at org.apache.axis2.receivers.AbstractInOutSyncMessageReceiver.invokeBusinessLogic(AbstractInOutSyncMessageReceiver.java:45)
    at org.apache.axis2.receivers.AbstractMessageReceiver.receive(AbstractMessageReceiver.java:110)
    at org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:181)
    at org.apache.axis2.transport.http.HTTPTransportUtils.processHTTPPostRequest(HTTPTransportUtils.java:172)
    at org.apache.synapse.transport.nhttp.ServerWorker.processEntityEnclosingMethod(ServerWorker.java:409)
    at org.apache.synapse.transport.nhttp.ServerWorker.run(ServerWorker.java:261)
    at org.apache.axis2.transport.base.threads.NativeWorkerPool$1.run(NativeWorkerPool.java:173)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:680)
[2012-06-07 09:49:11,352] ERROR - OMSourcedElementImpl Could not get parser from data source for element {http://ws.wso2.org/dataservice}EVENT
javax.xml.stream.XMLStreamException: DS Fault Message: Error in 'CallQuery.extractParams', cannot find parameter with type:query-param name:Hw_Serial_Nr
DS Code: INCOMPATIBLE_PARAMETERS_ERROR
Source Data Service:-
Name: OWCHECK
Location: /TQS_OWCHECK.dbs
Description: N/A
Default Namespace: http://ws.wso2.org/dataservice
Current Request Name: OWCHECK_OP
Current Params: {COUNTRYORIGIN=US, SUBDT=20090428}

    at org.wso2.carbon.dataservices.core.engine.DSOMDataSource.execute(DSOMDataSource.java:105)
    at org.wso2.carbon.dataservices.core.engine.DSOMDataSource.serialize(DSOMDataSource.java:110)
    at org.wso2.carbon.dataservices.core.engine.DSOMDataSource.getReader(DSOMDataSource.java:116)
    at org.apache.axiom.om.impl.llom.OMSourcedElementImpl.getDirectReader(OMSourcedElementImpl.java:225)
    at org.apache.axiom.om.impl.llom.OMSourcedElementImpl.forceExpand(OMSourcedElementImpl.java:254)
    at org.apache.axiom.om.impl.llom.OMSourcedElementImpl.getFirstOMChild(OMSourcedElementImpl.java:867)
    at org.apache.axiom.om.impl.OMNavigator._getFirstChild(OMNavigator.java:196)
    at org.apache.axiom.om.impl.OMNavigator.updateNextNode(OMNavigator.java:140)
    at org.apache.axiom.om.impl.OMNavigator.getNext(OMNavigator.java:112)
    at org.apache.axiom.om.impl.SwitchingWrapper.updateNextNode(SwitchingWrapper.java:1113)
    at org.apache.axiom.om.impl.SwitchingWrapper.updateLastNode(SwitchingWrapper.java:1104)
    at org.apache.axiom.om.impl.SwitchingWrapper.next(SwitchingWrapper.java:1041)
    at javax.xml.stream.util.StreamReaderDelegate.next(StreamReaderDelegate.java:47)
    at org.apache.axiom.om.impl.builder.StAXOMBuilder.parserNext(StAXOMBuilder.java:681)
    at org.apache.axiom.om.impl.builder.StAXOMBuilder.next(StAXOMBuilder.java:214)
    at org.apache.axiom.om.impl.llom.OMSerializableImpl.build(OMSerializableImpl.java:78)
    at org.apache.axiom.om.impl.llom.OMElementImpl.build(OMElementImpl.java:722)
    at org.apache.axiom.om.impl.llom.OMElementImpl.cloneOMElement(OMElementImpl.java:1065)
    at org.wso2.carbon.tracer.module.handler.AbstractTracingHandler.storeMessage(AbstractTracingHandler.java:81)
    at org.wso2.carbon.tracer.module.handler.TracingMessageOutObservationHandler.invoke(TracingMessageOutObservationHandler.java:94)
    at org.apache.axis2.engine.Phase.invokeHandler(Phase.java:340)
    at org.apache.axis2.engine.Phase.invoke(Phase.java:313)
    at org.apache.axis2.engine.AxisEngine.invoke(AxisEngine.java:262)
    at org.apache.axis2.engine.AxisEngine.send(AxisEngine.java:427)
    at org.apache.axis2.receivers.AbstractInOutSyncMessageReceiver.invokeBusinessLogic(AbstractInOutSyncMessageReceiver.java:45)
    at org.apache.axis2.receivers.AbstractMessageReceiver.receive(AbstractMessageReceiver.java:110)
    at org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:181)
    at org.apache.axis2.transport.http.HTTPTransportUtils.processHTTPPostRequest(HTTPTransportUtils.java:172)
    at org.apache.synapse.transport.nhttp.ServerWorker.processEntityEnclosingMethod(ServerWorker.java:409)
    at org.apache.synapse.transport.nhttp.ServerWorker.run(ServerWorker.java:261)
    at org.apache.axis2.transport.base.threads.NativeWorkerPool$1.run(NativeWorkerPool.java:173)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:680)
[2012-06-07 09:49:11,355] ERROR - ServerWorker Error processing POST request 
org.apache.axis2.AxisFault: javax.xml.stream.XMLStreamException
    at org.apache.axis2.AxisFault.makeFault(AxisFault.java:430)
    at org.apache.axis2.transport.http.HTTPTransportUtils.processHTTPPostRequest(HTTPTransportUtils.java:180)
    at org.apache.synapse.transport.nhttp.ServerWorker.processEntityEnclosingMethod(ServerWorker.java:409)
    at org.apache.synapse.transport.nhttp.ServerWorker.run(ServerWorker.java:261)
    at org.apache.axis2.transport.base.threads.NativeWorkerPool$1.run(NativeWorkerPool.java:173)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:680)
Caused by: org.apache.axiom.om.OMException: javax.xml.stream.XMLStreamException
    at org.apache.axiom.om.impl.builder.StAXOMBuilder.next(StAXOMBuilder.java:296)
    at org.apache.axiom.om.impl.llom.OMSerializableImpl.build(OMSerializableImpl.java:78)
    at org.apache.axiom.om.impl.llom.OMElementImpl.build(OMElementImpl.java:722)
    at org.apache.axiom.om.impl.llom.OMElementImpl.cloneOMElement(OMElementImpl.java:1065)
    at org.wso2.carbon.tracer.module.handler.AbstractTracingHandler.storeMessage(AbstractTracingHandler.java:81)
    at org.wso2.carbon.tracer.module.handler.TracingMessageOutObservationHandler.invoke(TracingMessageOutObservationHandler.java:94)
    at org.apache.axis2.engine.Phase.invokeHandler(Phase.java:340)
    at org.apache.axis2.engine.Phase.invoke(Phase.java:313)
    at org.apache.axis2.engine.AxisEngine.invoke(AxisEngine.java:262)
    at org.apache.axis2.engine.AxisEngine.send(AxisEngine.java:427)
    at org.apache.axis2.receivers.AbstractInOutSyncMessageReceiver.invokeBusinessLogic(AbstractInOutSyncMessageReceiver.java:45)
    at org.apache.axis2.receivers.AbstractMessageReceiver.receive(AbstractMessageReceiver.java:110)
    at org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:181)
    at org.apache.axis2.transport.http.HTTPTransportUtils.processHTTPPostRequest(HTTPTransportUtils.java:172)
    ... 6 more
Caused by: javax.xml.stream.XMLStreamException
    at org.apache.axiom.om.impl.SwitchingWrapper.updateLastNode(SwitchingWrapper.java:1106)
    at org.apache.axiom.om.impl.SwitchingWrapper.next(SwitchingWrapper.java:1041)
    at javax.xml.stream.util.StreamReaderDelegate.next(StreamReaderDelegate.java:47)
    at org.apache.axiom.om.impl.builder.StAXOMBuilder.parserNext(StAXOMBuilder.java:681)
    at org.apache.axiom.om.impl.builder.StAXOMBuilder.next(StAXOMBuilder.java:214)
    ... 19 more
[2012-06-07 09:49:11,375]  WARN - ClientHandler Received an internal server error : Internal Server Error For : 127.0.0.1:8280 For Request : Axis2Request [Message ID : urn:uuid:55a4d59a-2be2-43ee-99b5-8943b1ff2b91] [Status Completed : true] [Status SendingCompleted : true] 
```

它返回到代理服务的故障消息如何如下

```
2012-06-07 09:49:11,081 [-] [HttpServerWorker-1] TRACE OWCHECK_RPOXY To: /services/OWCHECK_RPOXY.OWCHECK_RPOXYHttpSoap12Endpoint, WSAction: urn:mediate, SOAPAction: urn:mediate, MessageID: urn:uuid:1f8cb9bf-ab10-40a4-b75d-6b3d4805322c, Direction: request, Envelope: <?xml version='1.0' encoding='utf-8'?><soapenv:Envelope xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope"><soapenv:Body><OWCHECK_OP spec="IDL:com/apple/vitria/idl/sapamr_rfcevents/RfcCallEvents:1.0#Z_WARR_VALIDATION_GROUP"><TAB_SERNHDR><SERIALNR>YM6191TJSCH</SERIALNR><SUBDT>20090428</SUBDT><COUNTRYORIGIN>US</COUNTRYORIGIN></TAB_SERNHDR></OWCHECK_OP></soapenv:Body></soapenv:Envelope>
2012-06-07 09:49:11,398 [-] [HttpClientWorker-1] TRACE OWCHECK_RPOXY To: http://www.w3.org/2005/08/addressing/anonymous, WSAction: , SOAPAction: , MessageID: urn:uuid:55a4d59a-2be2-43ee-99b5-8943b1ff2b91, Direction: response, MESSAGE = In-to-OutSequence !!!!!!!!!!!!!!!!!!!!!!!!!!!!, Envelope: <?xml version='1.0' encoding='utf-8'?><soapenv:Envelope xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope"><soapenv:Body><soapenv:Fault><soapenv:Code><soapenv:Value>soapenv:Receiver</soapenv:Value></soapenv:Code><soapenv:Reason><soapenv:Text xml:lang="en-US">javax.xml.stream.XMLStreamException</soapenv:Text></soapenv:Reason><soapenv:Detail><Exception>org.apache.axis2.AxisFault: javax.xml.stream.XMLStreamException
    at org.apache.axis2.AxisFault.makeFault(AxisFault.java:430)
    at org.apache.axis2.transport.http.HTTPTransportUtils.processHTTPPostRequest(HTTPTransportUtils.java:180)
    at org.apache.synapse.transport.nhttp.ServerWorker.processEntityEnclosingMethod(ServerWorker.java:409)
    at org.apache.synapse.transport.nhttp.ServerWorker.run(ServerWorker.java:261)
    at org.apache.axis2.transport.base.threads.NativeWorkerPool$1.run(NativeWorkerPool.java:173)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:680)
Caused by: org.apache.axiom.om.OMException: javax.xml.stream.XMLStreamException
    at org.apache.axiom.om.impl.builder.StAXOMBuilder.next(StAXOMBuilder.java:296)
    at org.apache.axiom.om.impl.llom.OMSerializableImpl.build(OMSerializableImpl.java:78)
    at org.apache.axiom.om.impl.llom.OMElementImpl.build(OMElementImpl.java:722)
    at org.apache.axiom.om.impl.llom.OMElementImpl.cloneOMElement(OMElementImpl.java:1065)
    at org.wso2.carbon.tracer.module.handler.AbstractTracingHandler.storeMessage(AbstractTracingHandler.java:81)
    at org.wso2.carbon.tracer.module.handler.TracingMessageOutObservationHandler.invoke(TracingMessageOutObservationHandler.java:94)
    at org.apache.axis2.engine.Phase.invokeHandler(Phase.java:340)
    at org.apache.axis2.engine.Phase.invoke(Phase.java:313)
    at org.apache.axis2.engine.AxisEngine.invoke(AxisEngine.java:262)
    at org.apache.axis2.engine.AxisEngine.send(AxisEngine.java:427)
    at org.apache.axis2.receivers.AbstractInOutSyncMessageReceiver.invokeBusinessLogic(AbstractInOutSyncMessageReceiver.java:45)
    at org.apache.axis2.receivers.AbstractMessageReceiver.receive(AbstractMessageReceiver.java:110)
    at org.apache.axis2.engine.AxisEngine.receive(AxisEngine.java:181)
    at org.apache.axis2.transport.http.HTTPTransportUtils.processHTTPPostRequest(HTTPTransportUtils.java:172)
    ... 6 more
Caused by: javax.xml.stream.XMLStreamException
    at org.apache.axiom.om.impl.SwitchingWrapper.updateLastNode(SwitchingWrapper.java:1106)
    at org.apache.axiom.om.impl.SwitchingWrapper.next(SwitchingWrapper.java:1041)
    at javax.xml.stream.util.StreamReaderDelegate.next(StreamReaderDelegate.java:47)
    at org.apache.axiom.om.impl.builder.StAXOMBuilder.parserNext(StAXOMBuilder.java:681)
    at org.apache.axiom.om.impl.builder.StAXOMBuilder.next(StAXOMBuilder.java:214)
    ... 19 more
</Exception></soapenv:Detail></soapenv:Fault></soapenv:Body></soapenv:Envelope> 
```

查看 SOAP 错误我必须将错误消息返回给客户端，但即使认为正确的错误消息必须“参数丢失”SOAP 错误的原因文本是“ `javax.xml.stream.XMLStreamException`”

我做错了什么还是DSS中的BUG？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-09T04:57:36.523

通过查看堆栈跟踪，我可以看到您在调用服务时启用了 SOAP 跟踪器，禁用了 SOAP 跟踪器，您应该得到正确的错误消息。

干杯，安佳娜。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-12T23:49:17.543

正如错误消息本身所解释的那样，它需要输入参数，而这些参数并未进入请求。可以通过两种方式修复：

1.  从 ESB 传递空标签而没有值。
2.  在 DSS 中设置默认值。

第一个选项适用于所有版本，这里是设置默认值的示例。

```
<payloadFactory media-type="xml">
    <format>
        <ds:DATA_SERVICE_REQUST xmlns:ds="http://ws.wso2.org/dataservice">
            <ds:INPUT_PARAM_1>$1</ds:INPUT_PARAM_1>
        </ds:DATA_SERVICE_REQUST>
    </format>
    <args>
        <arg xmlns:ds="http://ws.wso2.org/dataservice" evaluator="xml" expression="get-property('INPUT_PARAMETER')"/>
    </args>
</payloadFactory>
<call>
    <endpoint>
        <address uri="DSS_END_POINT"/>
   </endpoint>
</call> 
```

对于第二个选项，请检查您的 DSS 版本是否支持空值

最新版本的 DSS 支持查询参数列表中的默认参数值。您能否通过`defaultValue="#{NULL}"`在数据服务（dbs）文件中添加查询参数列表来尝试一下？

```
<query id="QUERY-ID" useConfig="DATA-SOURCE-ID">
    <sql>-------------SQL QUERY HERE -----</sql>
    <result ----------- >
        <element ------------ />  
    </result>
    <param defaultValue="#{NULL}" name="PARAM-NAME" ordinal="1" sqlType="INTEGER"/>
</query> 
```

如果此问题仍未解决，那么最好能提供您的 API 详细信息。**

# python - 无法修改 pycparser AST | 将 AST 转换为 C 代码

> ID：10936782
> 
> 赞同：4
> 
> 时间：2012-06-07T17:27:19.783
> 
> 标签：python, abstract-syntax-tree, pycparser

我正在尝试修改/重构输入 C 源代码。我试图在`printf`我的输入代码的每一行之后添加一个语句。

例如，如果我的输入是 -

```
void foo(){
    // Sample input code
    int a = 0, b = 0;
    a++;
    if(a<5)
         b++;
    b--;
} 
```

我想添加声明`printf('Hi');`，导致 -

```
void foo(){
    int a = 0, b = 0;
    printf('Hi');
    a++;
    printf('Hi');
    if(a<5){
         b++;
         printf('Hi');
    }
    printf('Hi');
    b--;
    printf('Hi');
} 
```

作为第一步，我只是尝试声明一个变量`test`并尝试将其插入到由随机源代码生成的 AST 的开头。这是我在将 AST 提取到对象后所涉及的 python 代码`ast`-

```
for i in range(0,len(ast.ext)):
    ## Look for a function named 'foo'
    if(type(ast.ext[i]) == c_ast.FuncDef and ast.ext[i].decl.name == 'foo'):
        ## Store the list of AST node objects in functionBody
        functionBody    = ast.ext[i].body

        ## Create a Decl object for the variable test
        id_obj          = c_ast.ID('test')
        identifier_obj  = c_ast.IdentifierType(['int'])
        typedecl_obj    = c_ast.TypeDecl(id_obj.name,[],identifier_obj)
        decl_obj        = c_ast.Decl(id_obj.name,[],[],[],typedecl_obj,[],[])

        ## Append the object to a list.
        ## Concatenate to a copy of existing list of AST objects     
        lst1 = []
        lst1.append(decl_obj)
        lst2 = []
        lst2 = copy.deepcopy(functionBody.block_items)
        lst3 = []
        lst3 = lst1+lst2

        ## Create a modified AST and print content
        functionBody1 = c_ast.Compound(lst3)
        functionBody1.show() 
```

我发现结果结构没有变化，`functionBody1`并且每当我尝试使用它的`show( )`方法时也会出现以下错误。

```
'list' object has no attribute 'show' 
```

知道我要去哪里偏离轨道吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-10T00:38:02.983

我发现三个地方你通过了一个你应该通过的地方没有。

```
## Create a Decl object for the variable test
id_obj          = c_ast.ID('test')
identifier_obj  = c_ast.IdentifierType(['int'])
typedecl_obj    = c_ast.TypeDecl(id_obj.name,None,identifier_obj)
decl_obj        = c_ast.Decl(id_obj.name,[],[],[],typedecl_obj,None,None) 
```

我对此并不是很熟悉，因为我也在学习 pycparser，但是这个更改为我修复了你的回溯。

# python - z3c.recipe.scripts 和 zc.recipe.egg 有什么区别？

> ID：10936783
> 
> 赞同：1
> 
> 时间：2012-06-07T17:27:24.447
> 
> 标签：python, buildout

z3c.recipe.scripts 和 zc.recipe.egg 似乎都在积极开发中。

z3c.recipe.scripts 描述为：

> 脚本配方将鸡蛋安装到构建鸡蛋目录中，就像 zc.recipe.egg 一样，然后在构建的 bin 目录中生成脚本，其中包含鸡蛋路径。

zc.recipe.egg 被描述为：

> egg-installation recipe 将 egg 安装到 buildout eggs 目录中。它还在 buildout bin 目录中生成脚本，其中包含 Egg 路径。

那么有什么区别呢？我需要他们两个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:58:51.857

你不需要两者。显然，`z3c.recipe.scripts`有一些改进`zc.recipe.egg`：

> *   脚本生成的解释器支持所有解释器选项，而不是 zc.recipe.egg 提供的子集。
> *   这个秘籍中的脚本和解释器都可以选择包含站点包，甚至站点自定义。

[`z3c.recipe.scripts`这些选项在PyPI 页面](http://pypi.python.org/pypi/z3c.recipe.scripts)上有更详细的描述。

如果你不明白这些选项的含义，你可能根本不需要使用`z3c.recipe.eggs`；只需坚持使用`zc.recipe.egg`，它作为`zc.buildout`核心的一部分进行维护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T06:03:00.817

**zc.recipe.egg**

鸡蛋配方安装一个或多个鸡蛋及其依赖项。它安装他们的控制台脚本入口点，并在其路径中包含所需的鸡蛋。它适合与“干净”的 Python 一起使用：一个没有安装在站点包中的包。

**z3c.recipe.scripts**

与 zc.recipe.egg 一样，此配方基于鸡蛋构建解释器脚本和入口点脚本。它可以与安装在站点包中的包的 Python 一起使用，例如系统 Python。解释器还具有比 zc.recipe.egg 提供的更多的功能。

[http://pypi.python.org/pypi/zc.buildout/1.6.3#creating-new-buildouts-and-bootstrapping](http://pypi.python.org/pypi/zc.buildout/1.6.3#creating-new-buildouts-and-bootstrapping)

# wix - WIX 安装默认功能未安装

> ID：10936787
> 
> 赞同：6
> 
> 时间：2012-06-07T17:27:43.107
> 
> 标签：wix

我对 WIX 安装程序非常陌生，我有以下功能：

```
<Feature Id="F_MyFeature" Title="My Feature" TypicalDefault="install" Level="1" Display="expand" > 
```

显然它在功能列表中显示为“将安装在本地硬盘上”

我希望此功能在其上显示“X”而不是默认安装，我该怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-08T07:21:33.633

**仅当功能的级别**低于[INSTALLLEVEL](http://msdn.microsoft.com/en-us/library/windows/desktop/aa369536%28v=vs.85%29.aspx)属性值时，才会将功能标记为安装。大多数安装程序的 INSTALLLEVEL 较低，例如 4 或 1000。

因此，要使您的功能默认不安装（旁边有一个 X），只需将其**Level**设置为一个非常高的值。例如[32767](http://msdn.microsoft.com/en-us/library/windows/desktop/aa368585%28v=vs.85%29.aspx)：

```
<Feature Id="F_MyFeature" Title="My Feature" TypicalDefault="install" Level="32767" Display="expand" > 
```

# objective-c - 获取“必须使用活动访问令牌来查询有关当前用户的信息。” 调用 requestWithGraphPath 时

> ID：10936790
> 
> 赞同：0
> 
> 时间：2012-06-07T17:27:53.410
> 
> 标签：objective-c, xcode, ios5, facebook-ios-sdk

在 [self.facebook requestWithGraphPath:@"me" andDelegate:self]; 我得到了上面提到的异常。这是我的代码

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    self.facebook = [[Facebook alloc] initWithAppId:@"<app id hidden>" andDelegate:self];

    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    if ([defaults objectForKey:@"FBAccessTokenKey"] 
        && [defaults objectForKey:@"FBExpirationDateKey"]) {
        self.facebook.accessToken = [defaults objectForKey:@"FBAccessTokenKey"];
        self.facebook.expirationDate = [defaults objectForKey:@"FBExpirationDateKey"];
    }

    if (![self.facebook isSessionValid]) {

        NSArray *permissions = [[NSArray alloc] initWithObjects:
                                @"user_likes", 
                                @"read_mailbox",
                                nil];
        [self.facebook authorize:permissions];

        [self.facebook requestWithGraphPath:@"me" andDelegate:self];

    }

}

- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url
  sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {

    return [self.facebook handleOpenURL:url]; 
}

- (void)fbDidLogin {
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    [defaults setObject:[self.facebook accessToken] forKey:@"FBAccessTokenKey"];
    [defaults setObject:[self.facebook expirationDate] forKey:@"FBExpirationDateKey"];
    [defaults synchronize];

}
-(void)request:(FBRequest *)request didLoad:(id)result
{
    NSArray *messagesResult= result;
}
-(void) request:(FBRequest *)request didFailWithError:(NSError *)error
{
    NSLog(@"%@",error);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:30:57.893

您应该等待 Facebook 授权您并致电`fbDidLogin`您的 FB 代表。然后，在`fbDidLogin`你启动`requestWithGraphPath:`. 在您的代码中，您在收到令牌之前启动图形请求，因为 FB 授权是异步的。

# asp.net - ASP.net Gridview 不显示第一行

> ID：10936792
> 
> 赞同：0
> 
> 时间：2012-06-07T17:28:01.317
> 
> 标签：asp.net, gridview

```
SqlDataReader myReader1 = null;
SqlCommand myCommand1 = new SqlCommand("SELECT Standard_Note_Code,     COUNT(Standard_Note_Code) as Count FROM [Excel_table] where Standard_Note_Creator_Name =  '" + ddlrep.Text + "' and (Std_Note_Date_Entered >= '" + datefrom + "' and Std_Note_Date_Entered <= '" + dateto + "') group by Standard_Note_Code", myConnection);

myReader1 = myCommand1.ExecuteReader();
myReader1.Read();

gvsummary.Visible = true;
if (myReader1.HasRows)
{                    
    gvsummary.DataSource = myReader1;
    gvsummary.DataBind();

}
else
{
    myReader1.Close();
    //myConnection.Close();
    //Label2.Text = "No Records Exist";
}
myReader1.Close(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T17:32:02.717

删除`myReader1.Read();`，之后`ExecuteReader`。那条线导致网格从第二个位置开始读取。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:32:28.507

一切对我来说都是正确的，除了我认为你不应该打电话

```
myReader1.Read(); 
```

在绑定到 GridView 之前。我认为如果您删除该行，它将解决您的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T17:32:50.953

`myReader1.Read();`如果您绑定为数据源，请不要调用。

# cakephp - Cakephp：保存我的三个表单中的最后一个时如何获取第一个表单的ID

> ID：10936794
> 
> 赞同：1
> 
> 时间：2012-06-07T17:28:05.717
> 
> 标签：cakephp

各位高人，我在 Cakephp 中使用了三个模型，我为我的模型创建了 3 个视图，这些视图由第二个模型链接。问题是当我想要进行最终保存时如何检索第一个模型的 id ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:10:32.043

您需要知道第一个模型的 ID。

如果您使用**save()**方法，您可以像这样获取 id：

```
$this->Model->save($data);
$id = $this->Model->id; 
```

或者

Cake 的模型类有一个函数可以获取最后插入的 id：

```
$this->Model->getLastInsertID() 
```

您只需要将 Model 替换为第一个模型的名称

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:50:21.297

假设您将三个模型保存在三个单独的页面请求中，只需将保存的模型数据存储在会话中就足够了。这样您就可以在第 2 和第 3 页请求中阅读它，并在您的表单和处理中包含必要的数据。

如果您在同一个请求中完成所有操作，那么 Moyed 的想法有效，您可以通过模型获取已保存行的 ID：

```
$this->Model->save($data);
$saved_row_id = $this->Model->id; 
```

# jquery - 如何CORS Sammy.js？

> ID：10936797
> 
> 赞同：0
> 
> 时间：2012-06-07T17:28:24.887
> 
> 标签：jquery, cors, sammy.js

我想知道是否有使用 Sammy.js 经验的人有使用跨域资源共享的解决方案？

***编辑***

最初的问题基本上只是询问人们可能使用什么方法来使用 Sammy.js 完成 CORS，例如覆盖 .load() 方法或类似的方法。

我遇到的问题是，在尝试与位于不同域（启用 CORS 的 sinatra 应用程序）上的 Sinatra api 交互时使用 .load() 方法时，事情没有按预期工作。

如果我使用 Ajax 调用，例如：

```
this.get('#/', function(context) {
    $.ajax({
      url: 'http://localhost:4567/posts', //located on other domain
      dataType: 'json',
      success: function(items) {
        $.each(items, function(i, item) {
          context.log(item.title);
        });
      }
    });
}); 
```

... firebug 在控制台中显示项目/帖子，但如果我使用 .load，例如：

```
this.load('http://localhost:4567/posts')

.then(function(items) {
   $.each(items, function(i, item) {
        context.log(item.title);
   });
}); 
```

... 一切都不是很好，萤火虫控制台显示[http://pastie.org/4051256](http://pastie.org/4051256)虽然萤火虫也表明 json 帖子数组已成功检索。

如果我尝试在模板中呈现项目而不是记录，也会发生这种行为：

```
this.load('http://localhost:4567/posts')
.then(function(items) {
   $.each(items, function(i, item) {
     context.render('tmpl/item.mustache', {item: item})
     .appendTo(context.$element());
   });
 }); 
```

...请记住，返回是一个只有三个帖子的 json 数组，模板已成功加载，但没有注入任何数据，并且它的呈现次数与上述粘贴中的“未定义”行数相同:(

***编辑 2***

*sammy.js 中的.load*方法如何将此调用与 jquery ajax 调用区别对待？

或者

为什么会出现上述问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-07T00:52:24.800

您需要在请求中添加预期的响应类型。否则，响应将作为字符串导入，同时看起来像 Firebug 中的数组/对象。您的标准 jQuery 方法有效，因为您已经这样做了：

```
dataType: 'json', 
```

使用 .load() 方法，可以像这样指定预期的响应类型：

```
this.load('http://localhost:4567/posts', {dataType: 'json'}) 
```

或者像这样：

```
this.load('http://localhost:4567/posts', {json: true}) 
```

如果您的资源的 URL 名称中包含“json”，sammy.js 将自动将预期的响应类型设置为 JSON。这也是 sammy.js 网站上的示例有效的原因。

# ruby - Ruby on Rails。调度.fcgi 。dependencies.rb:251:in `require': 无法加载此类文件 -- fcgi (LoadError)

> ID：10936800
> 
> 赞同：3
> 
> 时间：2012-06-07T17:28:37.247
> 
> 标签：ruby, ruby-on-rails-3, fastcgi, mod-fastcgi

app = redmine-2.0.1
ruby​​ = ruby​​ 1.9.3p194（2012-04-20 修订版 35410）[x86_64-linux]

```
[root@by1016690 public]# ./dispatch.fcgi
/usr/local/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `block in require': iconv will be deprecated in the future, use String#encode instead.
/usr/local/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require': cannot load such file -- fcgi (LoadError)
        from /usr/local/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `block in require'
        from /usr/local/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:236:in `load_dependency'
        from /usr/local/lib/ruby/gems/1.9.1/gems/activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
        from /usr/local/lib/ruby/gems/1.9.1/gems/rack-1.4.1/lib/rack/handler/fastcgi.rb:1:in `<top (required)>'
        from ./dispatch.fcgi:19:in `<main>' 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-07-15T20:06:11.913

*fcgi*处理程序不是*Redmine*核心的一部分。为了使用它，您必须将它添加到您的*Gem*依赖项中。

在 Redmine 安装中创建一个名为“ *Gemfile.local ”的文件：*

```
# Gemfile.local
gem "fcgi" 
```

# qt - 安全保存 cookie

> ID：10936801
> 
> 赞同：0
> 
> 时间：2012-06-07T17:28:45.680
> 
> 标签：qt, http, authentication, cookies, qt4

如何在我的程序会话之间安全地存储 cookie？我应该使用加密还是有另一种更简单的方法？如果我将使用加密，什么更安全：将加密的 cookie 存储在文件或注册表中（使用 QSettings）？

我使用 Qt。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:47:41.607

当您将 cookie 保存到硬盘驱动器时，实际上并不需要对其进行加密（如果您不想防御可以读取用户硬盘的人）。

# java - main函数和ExecutorService的任务速度差异

> ID：10936803
> 
> 赞同：0
> 
> 时间：2012-06-07T17:28:55.837
> 
> 标签：java, multithreading

所以，我有一个执行器服务，它创建了 12 个线程，每个线程之间有 250 毫秒的睡眠，这段时间通常足以让我的大多数线程完成，但是我创建了一个进程特别密集的线程，通常需要大约 7 -10 秒解析。

如果我让它在我的主线程中运行，它会毫无错误地完成，但是如果我将它提供给我的执行程序服务，它不会。

这是我的代码：

```
public static void main(String args[]){
ExecutorService threadPool = Executors.newFixedThreadPool(12);
...
Thread.sleep(250);
OPA.OpaHandler OpaSH = new OPA.OpaHandler();
    threadPool.submit(new ThreadHandler(OpaSH, 7));
Thread.sleep(250);
...

ThreadHandler.java
....
 public void run(){
    double startTime;
    double endTime;
        switch(this.threadNum){
....
          case 7:{
               startTime = System.nanoTime();
               OpaSH.run();
               endTime = System.nanoTime();
               endTime = endTime - startTime;
               System.out.println("Thread 7 (OPA) took:" + (endTime/1000000000) + " seconds. to run");
               break;
           } 
```

OpaSH.run() 唯一值得注意的部分；

```
 supply = new double[9];
        // Create an XML reader
        DocumentBuilderFactory domFactory = DocumentBuilderFactory.newInstance();
        DocumentBuilder builder = domFactory.newDocumentBuilder();
        Document doc = builder.parse(in);

        //Parse the Xml.
        XPathFactory factory = XPathFactory.newInstance();
        XPath xpath = factory.newXPath();
        XPathExpression expr = xpath.compile("//Stuff[1]/text()");

        result = (String) expr.evaluate(doc, XPathConstants.STRING);
        supply[0] = Double.parseDouble(result);

        expr = xpath.compile("//Stuff[2]/text()");

        result = (String) expr.evaluate(doc, XPathConstants.STRING);
        supply[1] = Double.parseDouble(result);

        .... 
```

总共有 12 个线程在运行，每个线程的计算时间在 0.07s 到 0.8s 之间。有两个需要更长的时间（大约 9s 和 OPA，可以在 1s 到 55s 之间）

为什么会发生这种情况，我该如何解决？

# c - C 错误 - 等待（）

> ID：10936805
> 
> 赞同：4
> 
> 时间：2012-06-07T17:29:09.243
> 
> 标签：c, wait

我使用内存段编写程序，但问题是我的 wait() 给我一个错误

错误：

```
ks.c:24:2: error: incompatible type for argument 1 of ‘wait’
/usr/include/x86_64-linux-gnu/sys/wait.h:116:16: note: expected ‘__WAIT_STATUS’ but argument is of type ‘int’
s.c:13:6: warning: unused variable ‘w’ [-Wunused-variable] 
```

代码行很简单`wait(1);` ，我已经为项目包含了所有必需的 ehaders 为什么我会收到那个错误，因为它应该像这样工作......导入

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/shm.h>
#include <sys/wait.h>
#include <errno.h>
#include "st.h" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T17:32:55.760

如果您检查文档`wait`，它作为参数的参数是一个*指向 int*设置状态的指针。由于这是家庭作业，我会让你自己总结解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T17:33:53.383

如果您查看手册页[等待](http://linux.die.net/man/2/wait)它需要一个指向整数的指针。

所以你的代码应该是这样的

```
int status;
wait(&status); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:34:24.787

wait 函数实际上接受一个指向 int 的指针，并在该指针中返回线程子进程的退出状态。

尝试这样的事情

```
 int status;
 wait(&status); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T17:45:38.393

# java - 将字符串转换为 java.util.date 并保留时区信息

> ID：10936806
> 
> 赞同：0
> 
> 时间：2012-06-07T17:29:24.017
> 
> 标签：java, timezone, simpledateformat, java.util.date

*在有人反对这个问题之前，我已经浏览了网络和 StackOverflow 以了解我所面临的情况并且没有找到任何东西，因此我将其作为一个新问题发布。*

我有 java 日期和时区的情况。

**情况：**

在 2 个不同的时区有 2 台服务器，比如说 PST 和 CST。我从这些服务器接收 dateString(date as a string)。但是，当我尝试使用 SimpleDateFormat 将字符串转换回日期时，日期信息（年、月、日、小时、分钟、秒）正在正确转换。但是时区信息没有被保留。

如果我在 EST 的服务器上运行我的代码，pstDateString 将转换为日期格式，但时区设置为 EDT，而不是 PST。

我以许多不同的方式考虑过它，但可能是我压力很大，我无法找到解决方案。有什么帮助吗？

模拟这种情况的代码块：

```
 DateFormat outDF1 = new SimpleDateFormat("yyyy-MM-dd HH:mm:SS");
        outDF1.setTimeZone(TimeZone.getTimeZone("PST"));        
        String pstDateString = outDF1.format(new Date());

        DateFormat outDF2 = new SimpleDateFormat("yyyy-MM-dd HH:mm:SS");
        outDF2.setTimeZone(TimeZone.getTimeZone("CST"));
        String cstDateString = outDF2.format(new Date());

        System.out.println("pstDateString "+pstDateString);
        System.out.println("cstDateString "+cstDateString);

        Date cstDate = new SimpleDateFormat("yyyy-MM-dd HH:mm:SS").parse(cstDateString);
        Date pstDate = new SimpleDateFormat("yyyy-MM-dd HH:mm:SS").parse(pstDateString);

        System.out.println("Date after format from string: "+pstDate);
        System.out.println("Date after format from string: "+cstDate); 
```

当前输出：

```
pstDateString 2012-06-07 10:26:689
cstDateString 2012-06-07 12:26:694
Date after format from string: Thu Jun 07 10:26:00 EDT 2012
Date after format from string: Thu Jun 07 12:26:00 EDT 2012 
```

预期输出：

```
pstDateString 2012-06-07 10:26:689
cstDateString 2012-06-07 12:26:694
Date after format from string: Thu Jun 07 10:26:00 PST 2012
Date after format from string: Thu Jun 07 12:26:00 CST 2012 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T17:34:20.137

java.util.Date 类没有时区，它始终是 UTC。如果要保留传入的时区，则需要一个结合了日期和时区的新类。您可以创建一个简单的持有人类，或者可能使用日历。

# iphone - NSUserDefaults boolForKey 在真机上的奇怪行为

> ID：10936809
> 
> 赞同：1
> 
> 时间：2012-06-07T17:29:37.133
> 
> 标签：iphone, objective-c, xcode, nsuserdefaults

我的申请已获批准，今天可以在 appstore 中销售。我立即从 appstore 下载了它，但是当我打开我的应用程序时，我的应用程序中没有广告。我什么都不懂。

在我的代码中，如果用户购买应用内商品，我将 userdefault 的值设置为 TRUE。

因此，当应用程序启动时，我会检查此 userdefaults。如果它是 TRUE 我不显示任何广告，如果不是我调用 ads api。

这是 inapp 购买区的一部分：

```
 if ([productId isEqualToString:@"dontshowads"])
    {   
            //user bought inapp item. so I must remove advertorials.

            [[NSUserDefaults standardUserDefaults] setBool:TRUE forKey:@"aldimi_lite_reklamikaldirma_099"];
            [[NSUserDefaults standardUserDefaults] synchronize];
    } 
```

这是 viewwillappear 区域：

```
 BOOL appin_reklamkaldirmaalindimi = [[NSUserDefaults standardUserDefaults] boolForKey:@"aldimi_lite_reklamikaldirma_099"];

    NSLog(@"appin_reklamkaldirmaalindimi :%d",appin_reklamkaldirmaalindimi);

    if (!appin_reklamkaldirmaalindimi) 
    {
       NSLog(@"showing ads");
    }
    else {
       NSLog(@"no ads. user bought inapp item");
    } 
```

当我在模拟器中运行我的应用程序时，一切都很好。（我先在模拟器中删除它并重新构建它）

控制台给出了这个日志：

```
 appin_reklamkaldirmaalindimi : 0
    showing ads 
```

当我在我的真手机上运行我的应用程序时，一切都很好。（我先在我的手机中删除它并重新构建它）

控制台给出了这个日志：

```
 appin_reklamkaldirmaalindimi : 0
    showing ads 
```

但是当我运行从 appstore 下载的应用程序时，一切都不同了。

控制台给出了这个日志：

```
 appin_reklamkaldirmaalindimi : 0
    no ads. user bought inapp item 
```

我尝试下载并查看我朋友手机中的情况。一切都是一样的。所以这与我的手机无关。

怎么可能？我想了一个小时，我找不到任何解释这种情况......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T21:20:01.530

对这种奇怪现象的唯一解释是，您提交到 App Store 的代码在某种程度上已损坏或与您通过构建计算机测试的代码不同。解决此问题的唯一方法是将您的应用程序重新提交到 App Store。

我能想到的唯一另一种可能性是您的应用程序有一些非常糟糕和不正确的内存访问倾向，例如在运行您的广告逻辑之前，您的部分可执行代码或堆栈以某种方式被覆盖。

# iphone - iOS 应用的企业分发

> ID：10936811
> 
> 赞同：2
> 
> 时间：2012-06-07T17:29:37.853
> 
> 标签：iphone, ios

有谁知道将 iOS 应用程序分发给企业的最佳方式（如果有的话）是什么。具体来说，我想做的是将我的应用程序发送给一些企业而不是其他企业。我怀疑这样的事情是否存在，但仍然想知道......

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T22:00:08.243

从我正在阅读的内容来看，你不能做你想做的事。您不能“私人”销售应用程序。如果您拥有 Dun & Bradstreet 编号，则可以注册为企业，然后将您的应用程序的使用许可给其他企业。这是可能的，但如果 Apple 发现他们将撤销您的许可证，因为企业开发者许可证仅适用于内部。

唯一合法的解决方案是让每个企业注册一个企业帐户，然后将您设置为他们帐户的开发人员。没有合法的解决办法，对不起。

# asp.net - ASP.NET asp:Button vs. a href - CSS 样式

> ID：10936814
> 
> 赞同：0
> 
> 时间：2012-06-07T17:30:21.217
> 
> 标签：asp.net, html, css

请原谅“菜鸟”的问题，但有人可以解释一下 ASP.NET 按钮的工作方式。我正在尝试在由 C# 中的服务器端事件处理程序驱动的 ASP.NET 中设置我的按钮样式。即单击按钮，并将值写回SQL Server。显然这不适用于href？

```
<a href="#" class="myStyle">Submit</a>

<asp:Button ID="btnSubmit" runat="server" Text="Submit" CssClass="myStyle" /> 
```

一个带有大量 jQuery/js 插件的 ASP.NET 站点能否看起来像原始编码的 HTML 页面一样好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:38:17.553

是的，您可以将 jQuery 和 js 添加到 ASP.NET 站点。如果您正在寻找超链接样式，但 ASP.NET 功能，请尝试使用 ASP.NET LinkBut​​tons

```
<asp:LinkButton ID="LinkButton1" runat="server">LinkButton</asp:LinkButton> 
```

请记住这一点 - ASP.NET 使在 SERVER 上的工作变得更容易。jQuery & js 使在 CLIENT 上的工作更容易。

通常 ASP.NET 的按钮是简单的拖放块，您可以在开发过程中双击它们并在后面添加代码进行一些处理。

不过，为了让我们帮助您解决样式问题，您必须向我们展示您正在使用的 CSS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-24T20:59:49.480

我实际上是在寻找一种显示“Windows 按钮”的好方法。我找到了一个不错的解决方案......这是代码：

**.aspx 代码：**

`<asp:Button ID="btnInsert" runat="server" CssClass="btn_normal" Text="Add" OnClick="btnInsert_Click" />`

**.css 代码：**

```
.btn_normal
{
    background-color: #f5f5f5;
    border: 1px solid #dedede;
    border-top: 1px solid #eee;
    border-left: 1px solid #eee;
    font-family: Arial, sans-serif;
    font-size: 12px;
    font-weight: bold;
    color: #565656;
    height: 25px;
}
.btn_normal:hover
{
    font-family: Arial, sans-serif;
    background-color:#E6EFC2;
    border:1px solid #C6D880;
    color:#529214;
    font-size: 12px;
    height: 25px;
}
.btn_normal:active
{
    font-family: Arial, sans-serif;
    background-color: #529214;
    border: 1px solid #C6D880;
    color: #fff;
    font-size: 12px;
    height: 25px;
} 
```

结果：

![在此处输入图像描述](../Images/072bb11dc6ca14f95efa35528a3a4a38.png)

# c# - System.Web.Caching 还是 System.Runtime.Caching 更适合 .NET 4 Web 应用程序

> ID：10936815
> 
> 赞同：45
> 
> 时间：2012-06-07T17:30:21.737
> 
> 标签：c#, asp.net, caching, .net-4.0

我正在向 ASP.NET Web 应用程序添加缓存。这是 .NET 4，因此我可以使用 System.Runtime.Caching 命名空间中的类（据我了解，它被添加以提供与 System.Web.Caching 中的功能相似的功能，但对于非 Web-应用。）

但既然这*是*一个网络应用程序，我最好使用 System.Web.Caching 吗？还是较新的 System.Runtime.Caching 在某些方面更胜一筹？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-06-08T20:08:39.540

Microsoft 建议将 System.Runtime.Caching 用于所有缓存目的。看到这个：http: [//msdn.microsoft.com/en-us/library/dd997357.aspx](http://msdn.microsoft.com/en-us/library/dd997357.aspx)

虽然，我遇到了一些人们对 MemoryCache.Default 实例有问题的线程。一段时间后，它会停止正常工作。您使用 Add 或 Set 方法添加的任何项目实际上都不会添加到缓存中。我尝试了相同的方法，并且能够通过显式调用 MemoryCache.Default.Dispose() 方法来重现此问题。

以下是链接： [MemoryCache Empty ：设置后返回 null](https://stackoverflow.com/questions/7422859/memorycache-disposed-in-web-application)

[http://forums.asp.net/t/1736572.aspx/1](http://forums.asp.net/t/1736572.aspx/1)

我的建议是使用 System.Web.Caching (HttpContext.Current.Cache)

**更新：**

MS 已修复此问题。检查以下帖子中接受的答案： [已解决运行时缓存问题](https://stackoverflow.com/questions/7422859/memorycache-disposed-in-web-application)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-06-07T17:49:11.357

System.Runtime.Caching 允许您在所有 .Net 应用程序中进行缓存，而不仅仅是 IIS 工作进程。因此，如果您需要在多个场景中访问缓存，请使用 System.Runtime。您还可以检查此缓存适配器，它允许您在运行时、Web 和应用程序结构缓存之间进行交换。[https://bitbucket.org/glav/cacheadapter](https://bitbucket.org/glav/cacheadapter)

还有一件事，如果您有一个多服务器场，并且具有负载平衡配置，请确保您有粘性会话或分布式缓存模型。

# android - Android 使用 LinearLayout 作为应用程序上所有其他 LinearLayouts 的背景

> ID：10936819
> 
> 赞同：0
> 
> 时间：2012-06-07T17:30:34.153
> 
> 标签：android, styles, themes, drawable, android-linearlayout

我有一个 LinearLayout，里面有另外 2 个 LinearLayout。每一个里面都有一个 ImageView。我需要将此 LinearLayout 设置为我的应用程序的所有其他 LinearLayouts 的背景。我尝试使用“Include”和“Merge”，但没有成功，因为我需要将其他 LinearLayout 放入我的“背景 LinearLayout”然后我尝试使用“Styles”，但我不知道如何在里面添加 ImageViews线性布局。有可能的？最后现在我正在尝试使用“Drawable”，但我不知道这是否是解决方案。

我需要想法，一些帮助，有人可以帮助我吗？

这是我的“背景线性布局”：

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout
xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical"
android:background="@layout/gradient_background">

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:gravity="center_horizontal"
    android:layout_marginTop="170dip"> 

    <ImageView
        android:id="@+id/background_title"
        android:src="@drawable/titulo_fondo"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>

</LinearLayout>

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:gravity="left|bottom"
    android:layout_marginLeft="-54dip"
    android:layout_marginBottom="-24dip"> 

    <ImageView
        android:id="@+id/background_logo"
        android:src="@drawable/circulo_logo"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>

</LinearLayout> 

</LinearLayout> 
```

感谢并为我糟糕的英语感到抱歉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:11:21.220

样式可能是要走的路，尝试创建如下样式：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <style name="MyTheme" parent="@android:style/Theme.Light">
<item name="android:windowBackground">@drawable/my_image</item>
</style> 
```

并配置您的整个应用程序以使用清单中的主题属性，例如

```
<application
   android:icon="@drawable/icon"
   android:label="@string/app_name"
   android:theme="@style/MyTheme"
   ...
</application> 
```

# sql - 从动态 SQL 返回的存储过程字符串参数的范围问题

> ID：10936820
> 
> 赞同：2
> 
> 时间：2012-06-07T17:30:35.150
> 
> 标签：sql, tsql

我有一个用于创建需要组装描述的库存交易的存储过程。由于其他库存存储过程也需要类似地组装它们的描述，因此我正在尝试创建一个辅助存储过程。

该助手将使用标准参数并构建描述。我遇到的麻烦是将字符串`Description`返回到库存交易。

Inventory 事务以这种方式调用助手：

```
declare @TransDescription nvarchar(256) 
declare @TransDescOut nvarchar(256)

EXEC [dbo].[sp_KF_Helpers_CreateInvTransDescription] 
     @TransactionTypeID, @UserName, @OwnerTypeID, @OwnerID, 
     @TransDesc = @TransDescOut OUTPUT

SET @TransDescription = @TransDescOut 
```

然后我将`@TransDescription`其用作插入列数据的值。

辅助代码是：

```
 CREATE PROCEDURE [dbo].[sp_KF_Helpers_CreateInvTransDescription]
    (   @TransactionTypeID int,
        @UserName nvarchar(256),
        @OwnerTypeID int,
        @OwnerID int,
        @TransDesc varchar(256) OUTPUT
    )
    AS
    BEGIN
    SET NOCOUNT ON;

declare @rslt int = 0
declare @strTyepID varchar(256) = @TransactionTypeID
declare @strOwnerID varchar(256) = @OwnerID
declare @intOwnerTypeID int = @OwnerTypeID
declare @OwnerStr varchar(256) = 'KF_'
declare @OwnerIDStr varchar(256) = (select Description from KF_OwnerType where ID = @intOwnerTypeID)

select @OwnerStr = @OwnerStr + @OwnerIDStr
declare @sql1 nvarchar(4000)

Select @sql1 = 'Select Top 1 (a.Description + '' - '' + ' + @OwnerStr + '.Name) TransDesc 
from KF_InventoryTransactionType a, KF_OwnerType c, ' + @OwnerStr + ' 
where a.ID = ' + @strTyepID + ' and ' 
+ @OwnerStr + '.ID = ' + @strOwnerID 

exec SP_EXECUTESQL @sql1, N'@TransDesc varchar output ', @TransDesc output
 End 
```

如您所见，我使用动态 SQL 来生成描述。问题是帮助代码生成了正确的描述，但没有将其作为输出传回。

任何人都知道我为什么或在哪里失去了返回输出描述的范围？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T17:40:15.617

您忘记分配变量。尝试：

```
select top 1 @TransDesc = a.Description + '' - '' + ' + @OwnerStr + '.Name
... 
```

另外，更改您声明动态脚本参数的部分（`@TransDesc`），否则您将遇到另一个问题。当前，参数声明如下：

```
@TransDesc varchar output 
```

这[相当于](http://msdn.microsoft.com/en-us/library/ms176089.aspx "char and varchar (Transact-SQL)")

```
@TransDesc varchar(1) output 
```

最有可能的是，它应该是

```
@TransDesc varchar(256) output 
```

反而。

# html - HTML img code src，保存和发送电子邮件或HTML表单

> ID：10936821
> 
> 赞同：1
> 
> 时间：2012-06-07T17:30:36.913
> 
> 标签：html, xhtml, html-email

假设有一个 HTML（或 XHTML）代码，并且

```
<img alt="...." src=".......aspx" />: 
```

因此，aspx 生成图像文件，并且会显示一些图像。

现在我想将生成的图像文件发送到电子邮件或使用 HTML 表单代码，我希望我的 html 代码自动执行此操作。

因此，在 html 代码中，在 img 代码之后，我想添加自动发送生成图像的代码。

（我想要一个带有 img 代码和电子邮件或 HTML 表单代码的代码。）

我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:37:47.273

老实说，根据您的问题，您要完成的工作并不完全清楚。但是，根据我的收集，您可以尝试几种不同的方法：

1.  查看这个 StackOverflow 帖子：[发送一封电子邮件，其中嵌入了来自 C# 的正文中的图像](https://stackoverflow.com/questions/1921275/sending-an-email-with-an-image-embedded-in-the-body-from-c-sharp)

2.  您可以使用此源中的代码作为起点： http: [//www.codedigest.com/Articles/ASPNET/95_Sending_Email_using_C__and_ASPNet_20.aspx](http://www.codedigest.com/Articles/ASPNET/95_Sending_Email_using_C__and_ASPNet_20.aspx)（请参阅“在消息正文中发送带有嵌入图像的电子邮件”部分）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:59:59.490

您需要做的是将图像生成逻辑移动到某个库或 App_Code 文件夹，然后调用该逻辑两次：一次来自为标记发送它的 .aspx 处理程序，一次用于您还需要编写的代码这将在电子邮件中发送。一旦你有了包含图像的 byte[] 数组，请按照 lkaradashkov 的链接在电子邮件中发送它：

[从 C# 发送带有嵌入在正文中的图像的电子邮件](https://stackoverflow.com/questions/1921275/sending-an-email-with-an-image-embedded-in-the-body-from-c-sharp)

# objective-c - 在restkit中序列化对同一类的嵌套引用

> ID：10936825
> 
> 赞同：1
> 
> 时间：2012-06-07T17:30:55.307
> 
> 标签：objective-c, ios, restkit

我很难让序列化适用于对象可能包含自身其他实例的对象。

例如对象： Person NSString* name Person* mother 这个 JSON 可能看起来像：{

```
"person": [

           {

            "name": "Blake Watters",

            "mother": {

                "name": "Jane Doe",

                "mother": {

                    "name":"Jane Smith",

                    "age":65

                }

            }

           }

        ] 
```

}

我创建映射： RKObjectMapping* personMapping = [RKObjectMapping mappingForClass:[Person class] ];

```
[personMapping mapAttributes:@"name", nil];

[personMapping mapKeyPath:@"mother" 
           toRelationship:@"mother" 
              withMapping:personMapping]; 
```

如果我对此执行逆映射以便可以序列化对象，我会得到一个递归映射错误，因为它不断添加映射。

我能找到的唯一答案是在关系上设置“序列化：否”。这允许它逆向然后序列化，但是序列化当然是缺少母对象。

有没有解决的办法？反转后，我可以手动将此序列化添加回对象吗？

编辑：

看起来之后将其重新添加可能是实现此目的的方法，因为以下代码似乎有效。虽然感觉必须有更好的方法。

```
// Map name
RKObjectMapping* nameMapping = [RKObjectMapping mappingForClass:[Name class]];
[nameMapping mapAttributes:@"first",@"last", nil];

// Map person
RKObjectMapping* personMapping = [RKObjectMapping mappingForClass:[Person class] ];
[personMapping mapAttributes:@"age", nil];
[personMapping mapKeyPath:@"name" toRelationship:@"name" withMapping:nameMapping];

// Don't serialize mother
[personMapping mapKeyPath:@"mother" toRelationship:@"mother" withMapping:personMapping serialize:NO];

// Connect our mapping to RestKit's mapping provider
[[RKObjectManager sharedManager].mappingProvider setMapping:personMapping forKeyPath:@"person"];

// invert the mapping
RKObjectMapping* personSerialization = [personMapping inverseMapping];
RKObjectMapping* mapping = [[RKObjectManager sharedManager].mappingProvider 
                            serializationMappingForClass:[Person class]];
// Since mother wasn't serialized, add its relationship back in
[personSerialization mapKeyPath:@"mother" 
                 toRelationship:@"mother" 
                    withMapping:personSerialization];    
[[RKObjectManager sharedManager].mappingProvider setSerializationMapping:personSerialization 
                                                                forClass:[Person class]]; 
```

谢谢，亚当

# msbuild - 如何控制在 .NET4 和 4.5RC 之间使用哪个版本的 msbuild 文件？

> ID：10936828
> 
> 赞同：6
> 
> 时间：2012-06-07T17:31:02.403
> 
> 标签：msbuild, msdeploy, visual-studio-2012

在我的开发笔记本电脑上，我只安装了 VS2012 RC，并且我成功地从 powershell（通过 psake）连接到新的 MSDeploy .pubxml 管道（DeployOnBuild 和 PublishProfile 设置），以将我的网站部署到我们的测试服务器。

但是，在我的构建服务器上，我最初安装了 VS2010 SP1，现在我*另外*安装了 2012 RC（我在这台机器上还有其他构建，仍然是 .NET 4）。

当使用完全相同的参数运行相同的脚本时，我在开发机器和构建服务器之间看到了不同的结果。我正在运行的命令是

```
exec { msbuild "Website\WebSite.csproj" /m p:DeployOnBuild=True /p:PublishProfile=MyTestProfile } 
```

在构建服务器上，这实际上并不会触发 MSDeploy，而只是将站点压缩并制作部署包的打包位。我的机器成功地选择了 pubxml 文件并成功部署。

最终，我相信我已经将问题追溯到文件 Microsoft.Web.Publishing.targets。在我的开发机器上，我只有

```
C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v11.0\Web 
```

但服务器另外有

```
C:\Program Files (x86)\MSBuild\Microsoft\VisualStudio\v10.0\Web 
```

似乎这个文件（不知道 .pubxml 的东西）是那里正在使用的东西。

有没有人知道我需要处理什么（最好在我自己的 msbuild 文件中，这样我就不会在构建服务器上为 4.0 构建搞砸任何其他内容）以让 msbuild 获取文件的 v11.0 版本和从而使用我的 .pubxml 文件？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-08T13:40:26.857

有趣的是它应该采用最新的（v11.0），好像这里有一个错误。这由 MSBuild 属性**VisualStudioVersion**控制。

以下是在构建时如何填充此值的规则。1\. 如果VisualStudioVersion 被定义为环境变量或全局属性（例如/p: 在命令行）获胜。这就是 Dev11 和 Dev11 命令提示符始终是 v11 的方式——它们都将 VSV 定义为环境变量 1。否则，如果存在与等效解决方案版本匹配的子工具集（当前始终是文件格式版本 - 1），选择那个 1\. 否则，获取默认版本；如果安装了 Dev10，则为 10.0，否则安装最高版本的子工具集版本（目前始终为 11）

在您的情况下，由于您遇到问题，您可以传入属性`/p:VisualStudioVersion=11.0`以确保使用正确的目标。

# javascript - 互联网浏览器上的货币符号

> ID：10936835
> 
> 赞同：1
> 
> 时间：2012-06-07T17:31:27.533
> 
> 标签：javascript, asp.net, formatting, currency

我在某些互联网浏览器上的货币符号有一些问题，特别是谷歌浏览器（令人震惊）

在浏览器上尝试我的网站，其中几个（FireFox、Safari、Opera）在欧元上显示了网站货币符号，我的网站专用于墨西哥用户，因此我需要墨西哥比索货币符号 ($)。在 FireFox 和 Opera 上，这并不麻烦，我只需要将区域设置从西班牙 - 西班牙更改为西班牙 - 墨西哥，那里没有甜蜜，但在 Safari 和 Chrome 上没有选择这样做。

无论我找到什么，他们都告诉我要更改我电脑的区域设置，但是我尝试过并显示欧元符号的所有电脑都设置为墨西哥

关于我能做什么来强制使用货币符号的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:50:39.267

如果你想更改谷歌浏览器的语言设置（我相信这会纠正货币符号问题）去 chrome://chrome/settings/ （它在我的 macbook pro 上的设置链接）点击高级设置的链接，然后去到语言设置，添加您想要的语言，并将其拖到堆栈顶部，使其成为最高首选项。

# iphone - 如何从目标 C 中的 NSDictionary 中检索字符串？

> ID：10936837
> 
> 赞同：2
> 
> 时间：2012-06-07T17:31:30.933
> 
> 标签：iphone, objective-c, arrays

我正在尝试检索 NSDictionary 中键的值。字典已使用字符串类型的键值对初始化。问题是，我似乎无法通过调用 objectForKey 或 valueForKey 来检索值。

我能够遍历字典并打印键和值。

有人能指出我哪里出错了吗？这是我的代码...

```
//Set up dictionary with options
keys = [NSArray arrayWithObjects:@"red", @"blue", nil];
values = [NSArray arrayWithObjects:@"1.7", @"2.8", nil];

conversionOptions = [NSDictionary dictionaryWithObject:values 
                                                forKey:keys]; 
```

然后在选择器中的选择行上调用它

```
NSLog(@"... %@", [keys objectAtIndex:row]);       //prints out the key
NSString *theString = [keys objectAtIndex:row];   //save it as a string
NSLog(@"The string is... %@", theString);         //print it out to make sure im not going crazy

NSLog(@"the value is : %@",[conversionOptions objectForKey:theString]); // I just get NULL here
//NSLog(@"the value is : %@",[conversionOptions valueForKey:theString]); // This doesn't work either, I just get NULL 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-07T17:35:18.407

您正在创建一个字典，其中一个数组作为唯一键，一个数组作为其值！您需要`dictionaryWithObjects:forKeys:`（复数）工厂，而不是`dictionaryWithObject:forKey:`（单数），以便键数组的每个元素都将用作值数组的各个元素的不同键。

我发现`dictionaryWithObjectsAndKeys:`大多数时候工厂更有用，例如：

```
conversionOptions = [NSDictionary dictionaryWithObjectsAndKeys:@"1.7", @"red", @"2.8", @"blue", nil]; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-07T17:37:44.957

这是从字典对象中检索字符串的方式

`NSString * string = [dictionary objectForKey:@"stringKey"];`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-07T17:33:43.530

`objectForKey:`不使用`valueForKey:`。

* * *

确保`conversionOptions`调用时非零`objectForKey:`（这是正确的方法）。

而且，是的，derp——我错过了使用错误的工厂方法。你可以做 dictionaryWithObjects:andKeys: 或者做 pmjordan 所说的。

**但是，您绝对必须使用`objectForKey:`。** `valueForKey:`特定于 KVC。

# c# - 在 UI wpf 中为 observablecollection 移动操作设置动画？

> ID：10936838
> 
> 赞同：1
> 
> 时间：2012-06-07T17:31:37.723
> 
> 标签：c#, wpf

我有一个绑定到可观察集合的包装面板。

当集合在后面的代码中更改时，有没有办法在 UI 中为项目的移动设置动画？有点像 windows tile 风格的 Metro 应用程序的流畅运动？

任何有关如何解决此问题的设计想法都将不胜感激。

现在，我能想到的只是为布局更改事件设置动画？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T18:49:20.127

我过去需要这样的东西 - 我记得 - 我最终使用了此处提供的示例的略微修改版本： [https ://docs.microsoft.com/en-us/archive/blogs/devdave/layout-过渡动画包装面板](https://docs.microsoft.com/en-us/archive/blogs/devdave/layout-transitions-an-animatable-wrappanel)

此示例有点高级，支持在对集合进行任何修改时为项目设置动画（添加项目、删除项目、调整面板大小）

另一方面，如果您需要的只是项目级别的简单动画（例如，当项目出现/消失时），您可以`ItemTemplate` 使用具有`EventTrigger`相关事件的控件构建一个更简单的动画。此示例将在添加时为项目设置动画：

XAML：

```
<StackPanel>
    <ItemsControl x:Name="itemsControl" Height="300">
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <WrapPanel IsItemsHost="True" />
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <Rectangle Width="80" Height="80" Fill="Red" Margin="4" Opacity="0">
                    <Rectangle.RenderTransform>
                        <TranslateTransform Y="20" />
                    </Rectangle.RenderTransform>
                    <Rectangle.Triggers>
                        <EventTrigger RoutedEvent="Loaded">
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetProperty="Opacity" To="1" Duration="00:00:00.6" />
                                    <DoubleAnimation Storyboard.TargetProperty="(RenderTransform).Y" To="0" Duration="00:00:00.4" />
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </Rectangle.Triggers>
                </Rectangle>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl>
    <Button Width="60" Height="40" Content="Add Item" Click="Button_Click" />
</StackPanel> 
```

后面的代码：

```
 ObservableCollection<string> items = new ObservableCollection<string>();

    public MainWindow()
    {
        InitializeComponent();
        itemsControl.ItemsSource = items;
    }

    private void Button_Click(object sender, RoutedEventArgs e)
    {
        items.Add("New Item");
    } 
```

# java - 无法显示 javax.swing 组件，特别是 JPanel

> ID：10936840
> 
> 赞同：2
> 
> 时间：2012-06-07T17:31:45.027
> 
> 标签：java, swing, jframe, jpanel, clock

我正在创建一种待办事项列表应用程序。一方面，您有待办事项列表应用程序，其中包含可以添加任务的框，另一方面，您有一个数字时钟。待办事项清单可以正常工作并完美显示。另一方面，时钟根本不显示。当我在测试程序中自己实例化一个 Clock 对象时，它运行得很好，但是当我尝试在 JFrame 中用待办事项列表实例化它时，它根本不显示。我已经检查了我的驱动程序，并且我有我的时钟对象的实例化和声明。我究竟做错了什么？

时钟面板对象：

```
 import java.awt.Color;
 import java.awt.Font;
 import java.awt.event.ActionEvent;
 import java.awt.event.ActionListener;
 import java.text.SimpleDateFormat;
 import java.util.Date;
 import javax.swing.Timer;

 public class ClockPanel extends javax.swing.JPanel implements ActionListener{
    private SimpleDateFormat sdf = new SimpleDateFormat("hh:mm:ss");
    private Timer timer;
    private javax.swing.JLabel clockLabel = new javax.swing.JLabel();
    public ClockPanel() {
     super();

     clockLabel.setText(sdf.format(new Date(System.currentTimeMillis())));
     clockLabel.setFont(new Font("Monospaced", Font.BOLD, 100));
     clockLabel.setOpaque(true);
     clockLabel.setBackground(Color.black);
     clockLabel.setForeground(Color.white);

     timer = new Timer(500, this);
     timer.setRepeats(true);
     timer.start();

     clockLabel.setVisible(true);

     initComponents();
  }
  @Override
  public void actionPerformed(ActionEvent e){
     if(e.getSource().equals(timer))
        clockLabel.setText(sdf.format(new Date(System.currentTimeMillis())));
  }
  @SuppressWarnings("unchecked")
  // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
  private void initComponents() {

     javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
     this.setLayout(layout);
     layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGap(0, 400, Short.MAX_VALUE)
        );
     layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addGap(0, 300, Short.MAX_VALUE)
        );
  }// </editor-fold>//GEN-END:initComponents
// Variables declaration - do not modify//GEN-BEGIN:variables
// End of variables declaration//GEN-END:variables
 } 
```

时钟对象本身：

```
import java.text.SimpleDateFormat;
import java.util.Date;
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class Clock extends JLabel implements ActionListener{
  private SimpleDateFormat sdf = new SimpleDateFormat("hh:mm:ss");
  private Timer timer;
  public Clock(){
     super();

     setText(sdf.format(new Date(System.currentTimeMillis())));
     setFont(new Font("Monospaced", Font.BOLD, 100));
     setOpaque(true);
     setBackground(Color.black);
     setForeground(Color.white);

     timer = new Timer(500, this);
     timer.setRepeats(true);
     timer.start();

     setVisible(true);
  }
  public void actionPerformed(ActionEvent e){
     if(e.getSource().equals(timer))
        setText(sdf.format(new Date(System.currentTimeMillis())));
  }
 } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T18:01:45.413

`clockLabel`永远不会添加到布局的任何组中。这个 SSCCE 解决了这个问题。

![时钟面板](../Images/0b2d8461942cb56363f1b335e256fc79.png)

```
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.text.SimpleDateFormat;
import java.util.Date;

import javax.swing.*;
import javax.swing.GroupLayout.ParallelGroup;

public class ClockPanel extends JPanel implements ActionListener {

    private static final long serialVersionUID = 1L;
    private SimpleDateFormat sdf = new SimpleDateFormat("hh:mm:ss");
    private Timer timer;
    private JLabel clockLabel = new JLabel("Ha Ha");

    public ClockPanel() {
        super();

        clockLabel.setText(sdf.format(new Date(System.currentTimeMillis())));
        clockLabel.setFont(new Font("Monospaced", Font.BOLD, 100));
        clockLabel.setOpaque(true);
        clockLabel.setBackground(Color.black);
        clockLabel.setForeground(Color.white);

        timer = new Timer(500, this);
        timer.setRepeats(true);
        timer.start();

        initComponents();
    }

    @Override
    public void actionPerformed(ActionEvent e){
        if(e.getSource().equals(timer))
            clockLabel.setText(sdf.format(
                new Date(System.currentTimeMillis())));
    }

    private void initComponents() {

        GroupLayout layout = new GroupLayout(this);
        ParallelGroup parallelGroupH = layout.createParallelGroup(
                GroupLayout.Alignment.LEADING);
        this.setLayout(layout);
        layout.setHorizontalGroup(
                parallelGroupH
                .addGap(0, 400, Short.MAX_VALUE)
                );
        ParallelGroup parallelGroupV = layout.createParallelGroup(
                GroupLayout.Alignment.LEADING);
        layout.setVerticalGroup(
                parallelGroupV
                .addGap(0, 30, Short.MAX_VALUE)
                );
        parallelGroupH.addComponent(clockLabel);
        parallelGroupV.addComponent(clockLabel);
    }

    public static void main(String[] args) throws Exception {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                JOptionPane.showMessageDialog(null, new ClockPanel());
            }
        });
    }
} 
```

# java - java tomcat utf-8编码问题

> ID：10936846
> 
> 赞同：8
> 
> 时间：2012-06-07T17:31:55.900
> 
> 标签：java, jsp, tomcat, utf-8, request

我正在使用 java/jsp/tomcat/mysql 开发一个简单的 Web 应用程序，最大的问题在于字符编码，因为我需要处理 UTF-8 编码而不是默认的 8851。

首先，我想描述一下我的程序结构。我正在使用一个名为 Controller.java 的 Servlet 来处理所有请求。所以在 web.xml 中，我有一个 Controller servlet，它接受来自 *.do 的所有请求。

然后这个Controller会根据请求的URL来分发请求，例如，如果客户端请求register.do，Controller就会将请求分发到Register.java。

而在Register.java中，有一个以请求为参数的方法，即：

```
public String perform(HttpServletRequest request) {
    do something with the request...
} 
```

所以问题是如果我想在这个方法中以 UTF-8 打印一些东西，它会给出随机字符。例如，我有一个 Enum 存储了几个常量，Enum 的属性之一是它的繁体中文名称。如果我打印它

```
public static void main(Stirng[] args{
    System.out.println(MyEnum.One.getChn());
    logger.info(MyEnum.One.getChn());
} 
```

中文打印正确。但是，如果我将确切的代码放入处理 HttpServletRequest 的方法中：

```
public String perform(HttpServletRequest request) {
    System.out.println(MyEnum.One.getChn());
    logger.info(MyEnum.One.getChn());
} 
```

它们被打印为随机字符，但我可以从调试窗口（eclipse）中看到变量包含正确的汉字。

因此，当我想存储 request.getParameter() 中的值时，也会发生同样的情况。在调试窗口中，我可以看到该变量包含正确的字符，但是我将其打印出来或尝试将其存储在数据库中，它是随机字符。

我不知道为什么行为会这样，这阻止了我读取提交的表单值并将它们存储到数据库中。有人可以对此提供一些提示吗？

十分感谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-10T19:37:04.223

这是一个小教程，您需要做些什么才能使 UTF-8 在您的 Web 应用程序中工作：

您必须在应用程序中实现过滤器以进行字符编码：

```
public class CharacterEncodingFilter implements Filter {

    @Override
    public void init(FilterConfig filterConfig)
            throws ServletException {

    }

    @Override
    public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)
            throws IOException, ServletException {
        servletRequest.setCharacterEncoding("UTF-8");
        servletResponse.setContentType("text/html; charset=UTF-8");
        filterChain.doFilter(servletRequest, servletResponse);
    }

    @Override
    public void destroy() {

    }
} 
```

您必须确保您的 tomcat 的 server.xml 文件连接器元素具有值为 UTF-8 的 URIEncoding 属性。

```
<Connector port="8080" 
           protocol="HTTP/1.1"
           connectionTimeout="20000"
           URIEncoding="UTF-8"
           redirectPort="8443"/> 
```

您还需要在每个 JSP 页面中指定这一点：

```
<%@page contentType="text/html" pageEncoding="UTF-8"%> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-07T19:03:27.930

如果您需要使用 UTF-8 编码（实际上，现在每个人都应该这样做），那么您可以按照 Tomcat 常见问题解答中的“UTF-8无处不在 HOWTO”进行操作：

[http://wiki.apache.org/tomcat/FAQ/CharacterEncoding#Q8](http://wiki.apache.org/tomcat/FAQ/CharacterEncoding#Q8)

请记住，您还需要在数据库的文本字段中支持 UTF-8。

另请记住，有时将其中包含非 ASCII 字符的字符串“打印”到日志文件或控制台可能会受到

1.  输出流的字符编码
2.  文件阅读器的字符编码（例如 cat/less/vi）
3.  终端的字符编码

您最好将值写入文件，然后使用十六进制编辑器检查内容以确保您获得了您正在寻找的字节值。

# c# - 为什么显示错误“找不到类型或命名空间‘学生’？

> ID：10936847
> 
> 赞同：0
> 
> 时间：2012-06-07T17:32:00.863
> 
> 标签：c#, asp.net, visual-studio-2010, list

点击按钮，我正在写这个：

```
 protected void Button1_Click(object sender, EventArgs e)
    {
        List<Students> student = new List<Students>()
        {
            new Students {FirstName= "Ram", LastName= "Gol"},
            new Students {FirstName= "Ran", LastName= "Gom"},
            new Students {FirstName= "Rao", LastName= "Gon"},
            new Students {FirstName= "Rap", LastName= "Goo"}
        };

        IEnumerable<Students> empQuery = from s in student
                       where s.FirstName.Length ==3
                       select s.FirstName;
        foreach (var stud in empQuery)
        {
            Button1.Text = stud;
        } 
```

而且我也在使用 System.Collection.Generic。但是我遇到了错误

> 找不到类型或命名空间名称“学生”（您是否缺少 using 指令或程序集引用？）

请让我知道我做错了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:36:06.627

1.  如果在当前项目中定义了类，请跳到步骤 4。
2.  确保定义学生的程序集位于项目[参考文件夹](http://msdn.microsoft.com/en-us/library/ez524kew%28v=vs.100%29.aspx)中（或者如果它存在，则表明它不是损坏的参考）。如果它不存在，则添加它。
3.  如果引用无效，请通过拉入项目引用或浏览到程序集的位置来删除并重新添加它。它很可能在添加参考的项目部分。
4.  如果引用有效，则放置一个[Using](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)指令，该指令指定学生命名空间，以便可以使用它。

# json - iTunes 搜索 API 未定义的第一个结果

> ID：10936853
> 
> 赞同：1
> 
> 时间：2012-06-07T17:32:08.600
> 
> 标签：json, api, itunes

嗨，我在 iTunes api 专辑列表中苦苦挣扎了很长时间。

我的问题是第一个中的缩略图和专辑标题`<li></li>`总是以未定义的形式返回。

该代码基于 iTunes 艺术家搜索，按预期工作，但我的专辑列表版本总是出现此故障。

```
$(document).ready(function(){
  var searchTerm = '909253';
  $.getJSON( "http://itunes.apple.com/lookup?id=" + searchTerm + '&limit=30' + '&entity=album' + '&callback=?', function(data) {
    $.each(data.results, function() {
      $('<li></li>')
        .hide()
        .append('<img src="' + this.artworkUrl60 + '" />' ) 
        .append('<span><a href="http://itunes.apple.com/search?term=' 
          + this.artistName + '">' + 'Artist: ' + this.artistName
          + '</a> ' + '<br />Album Title: '  + this.collectionName + '</span>')
        .appendTo('#results')
        .fadeIn();
    });        
    $("#results").listview("refresh");
  });
}); 
```

​ 见[http://jsfiddle.net/tris_wood/u2sYe/2/](http://jsfiddle.net/tris_wood/u2sYe/2/)

我在itunes api上看到过类似的帖子，但没有找到解决方案。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-12T23:45:24.393

这是因为第一个返回的元素始终是父元素，在本例中是艺术家。

如果您要求：

```
http://itunes.apple.com/lookup?id=909253&entity=album 
```

您将得到（如您在 wrapperType 中所见）：

```
0) Artist information
1) First album
2) Second album 
```

不幸的是，您的代码目前暂时离线，我无法检查我的直觉是否正确。

# javascript - 使用 highlight.js 突出显示 pre 标签中的语法

> ID：10936854
> 
> 赞同：9
> 
> 时间：2012-06-07T17:32:25.293
> 
> 标签：javascript, syntax, highlight

这里有一个用于语法高亮的功能强大的 JavaScript 代码：

[http://softwaremaniacs.org/soft/highlight/en/](http://softwaremaniacs.org/soft/highlight/en/)

但是这段代码只适用于`<pre><code></code></pre>`块，这是我的问题，我喜欢使用只是因为 Chrome 和 Safari在复制和过去代码时`<pre></pre>`不包含换行符，但它可以工作。`<pre><code></code></pre>``<pre></pre>`

还有一个用户指南，但老实说，我不明白我必须做什么才能突出显示前标签。用户指南在这里：

[http://softwaremaniacs.org/soft/highlight/en/description/](http://softwaremaniacs.org/soft/highlight/en/description/)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-07T18:04:53.120

当前版本的 chrome 在`<code>`标签中的换行没有问题。例如，在 chrome 中
尝试[这个示例。](http://jsfiddle.net/x3NXY/)

这[是一个没有 jQuery 的版本](http://jsfiddle.net/x3NXY/4/)。

=== 更新 ===

[这是一个](http://jsfiddle.net/x3NXY/6/)没有`<code>`标签的例子。

```
window.onload = function() {
    var aCodes = document.getElementsByTagName('pre');
    for (var i=0; i < aCodes.length; i++) {
        hljs.highlightBlock(aCodes[i]);
    }
}; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-07T17:39:47.793

我认为您只需要将初始化更改为：

```
$("pre").each(function (i, e) {
    hljs.highlightBlock(e);
}); 
```

并且不要`"pre code"`用于 jQuery 选择器。不确定这是否正是该插件的使用方式，但我认为这就是您需要更改的...

**编辑：**

如果您不使用 jQuery，您可能想尝试以下方法：

```
window.onload = function () {
    var allPre, i, j;
    allPre = document.getElementsByTagName("pre");
    for (i = 0, j = allPre.length; i < j; i++) {
        hljs.highlightBlock(allPre[i]);
    }
}; 
```

它需要在`window.onload`或类似的地方以确保 DOM 已准备好进行操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-03T21:13:49.113

一个特殊的相关情况，虽然太长了，无法评论：

**在新的blogger.com / blogspot 动态视图模板**和可能的其他类似站点上调用 DOM 完成事件是不够的，因为在这种情况下，DOM 实际已加载，但仅由可*注入的 div 元素*和 DOM 内容组成通过 JavaScript 方法注入，该方法本身在 set-timeout 中调用：

```
 setTimeout(function() {
    blogger.ui().configure().view();
  }, 800); 
```

为了使语法高亮显示起作用，必须完成复杂的 DOM 树。一种解决方案是在较长的超时时间后触发`hljs.initHighlightingOnLoad();`或自定义函数。`highlightBlock`

```
 setTimeout(function() {
    blogger.ui().configure().view();
  setTimeout(function() {$('pre code').each(function(i, e) {hljs.highlightBlock(e)});}, 2000);
  }, 800); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-25T04:56:43.760

select 任何一个具有 22 种常用语言的 highlight.js 的预构建版本都由以下 CDN 托管：

```
cdnjs
==========

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

jsdelivr
==========

    <link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/9.9.0/styles/default.min.css">
    <script src="//cdn.jsdelivr.net/highlight.js/9.9.0/highlight.min.js"></script>

```

在网页上使用 highlight.js 的最低要求是链接到库以及其中一种样式并调用 initHighlightingOnLoad：

```
    <脚本>
         hljs.initHighlightingOnLoad();
    </脚本>

```

这将找到并突出显示 <pre><code> 标签内的代码；它会尝试自动检测语言。如果自动检测对您不起作用，您可以在 class 属性中指定语言

```
    <上一页>
    <code class="html">
        这是标题 1
    </代码>
    </pre>

```

有关更多信息，请参阅这两个链接。
[https://highlightjs.org/usage/](https://highlightjs.org/usage/)
[https://highlightjs.org/download/](https://highlightjs.org/download/)

# sql - 按包含空值的列排序？

> ID：10936857
> 
> 赞同：2
> 
> 时间：2012-06-07T17:32:41.423
> 
> 标签：sql, sql-server

我认为这将是一个容易解决的问题，但我一直在疯狂地搜索，试图找到答案，但我没有得到答案。

我想根据包含空值的列对结果进行排序。SQL Server 似乎认为这是一个坏主意。我已经尝试使用`ISNULL`,`LIKE`以及其他一些不同的方法来限制它们来尝试让它工作，但它只是没有发生。

```
SELECT c1
FROM t1
WHERE c1 IS NOT NULL
ORDER BY c1 DESC 
```

SQL Server 给了我这个错误： `The text, ntext, and image data types cannot be compared or sorted, except when using IS NULL or LIKE operator.`

就像我说的那样，我一直在疯狂地搜索这个简单问题的答案，但它并没有发生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:35:15.900

c1 是 text、ntext 或 image

所以错误说你不能按他们订购

尝试将 text/ntext 转换为应该这样做的 varchar(max)。

```
SELECT c1
FROM t1
WHERE c1 IS NOT NULL
ORDER BY convert(varchar(max),c1) DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:37:57.177

```
ORDER BY cast(c1 as varchar(max)) DESC 
```

并考虑将列`c1`的类型切换为`varchar(max)`. `text`是一种[过时的数据类型](http://msdn.microsoft.com/en-us/library/ms187993.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:40:22.940

我发现一些东西说你只能对 varchar 进行排序。试试这段代码。

SELECT c1 FROM t1 WHERE c1 IS NOT NULL ORDER BY cast(c1 as varchar(MAX))

来源：http://twogeeks.mindchronicles.com/?p=7

# ms-access - msacces 2010 如何在许多相关表的子表中创建带有组合框的表

> ID：10936866
> 
> 赞同：0
> 
> 时间：2012-06-07T17:33:05.193
> 
> 标签：ms-access, ms-access-2010, related-content

我有表格：每个产品的产品、度量、颜色我有相关的度量和颜色。另外我有一个带有子表的表单，我需要在其中显示包含列的表：[products] comboboxColumn、[measures] comboboxColumn 和 [colors] comboboxColumn。这些行应该是选择的产品、选择的度量、选择的颜色。

问题是：当我从那个非常选定的行中的 [products] combobox-Cell 中选择产品时，如何在我的网格选定行中过滤 [measures] combobox-Cell（或颜色 ComboBox 列表）的度量 ComboBox 列表？

![http://i.stack.imgur.com/5pz8a.png](../Images/b76892f7c7a6bc9014044098f171b19f.png) ![http://i.stack.imgur.com/qDpzZ.png](../Images/750abe3df33efb60b5ab4f12092e1fad.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T09:39:15.747

我建议您使用连续表格而不是数据表。创建组合并使用当前事件中的相关值填充它，并将其绑定到表中的正确字段。为避免混淆用户，请同时包含绑定到该字段的文本框。您可以锁定文本框并将组合框列标记为“选择大小”。您可以使用条件格式使整个想法更漂亮。

# c# - 在 C# Web 服务中手动删除和使用 dll

> ID：10936872
> 
> 赞同：0
> 
> 时间：2012-06-07T17:33:33.747
> 
> 标签：c#, .net

我正在用 C# 编写一个 Web 服务，并且是一个彻头彻尾的新手。如果我问的很愚蠢，请原谅我。我有一组 Web 服务使用的 dll。我想要实现的目标如下：

1.  让我们假设 dll 是 first.dll、second.dll 和 common.dll
2.  common.dll 在 first.dll 和 second.dll 中被引用（common.dll 包含在 first.dll 和 second.dll 中实现的接口）
3.  common.dll 具有包含在 first.dll 和 second.dll 中的类类型的静态字典。该字典中的类根据需要进行实例化。
4.  每当我准备好发布新的 common.dll 时，我想**在系统运行/运行时手动删除 common.dll 文件并用新版本的 common.dll 替换它。**

目前，当我尝试执行第 4 步时出现以下错误：“此操作无法完成，因为文件已在 vshost32-clr2.exe 中打开”

以至于我完全错过了一些东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:39:21.553

您必须关闭托管网站。复制到新程序集中。然后重启网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:01:19.883

24/7 的可用性并不便宜 - 你真的需要一个吗？

一种简单的方法是在升级应用程序时将流量重新路由到不同的服务器。您让两台服务器都运行并验证新服务器正常，然后将流量切换到新服务器。您可以使用 DNS 条目或某些软件/硬件路由器来重定向流量。

如果您真的想即时更换程序集，您可以这样做。您可能需要足够多的代理对象层，并可能将最终程序集加载到自定义应用程序域中。您可能只需将 DLL 复制到 IIS 上网站的根文件夹即可摆脱困境，并希望应用程序域回收能够正常工作并满足您的“始终在线”要求。

注意：“手动删除”和“系统一直在运行/运行”不应同时出现在同一个系统中......除非您知道有人可以在任何时候多次完美地执行相同无聊的数十个步骤当天...

# javascript - 向 DOM 添加 js 函数？

> ID：10936876
> 
> 赞同：0
> 
> 时间：2012-06-07T17:33:39.467
> 
> 标签：javascript, dom, innerhtml

我有一个非常简单的 HTML 页面。加载完所有内容后，用户可以与之完美交互。现在，在某个时刻，用户点击了一个元素。进行了 ajax 调用并且正在请求新数据。我现在想删除用户单击的上一个元素以及用户请求的元素（在同一页面上） - 实际上从 DOM 中删除旧元素并添加新元素。好吧，我也这样做了，但是我无法向新创建的元素添加功能。这是我的功能：

```
setCountry = function(value){
  document.getElementById('country').innerHTML = value;
} 
```

我正在尝试像这样将它添加到我的元素中

```
a_tag.setAttribute("href", "javascript:setCountry(countries[i]);"); 
```

正在调用该函数并将“未定义”写入 innerHTML 元素。我使用 for 循环设置属性，并在 for 循环上方提醒数组中的一个元素以确保它是正确的，并打印出正确的值。

我认为问题的发生是因为该函数是在第一次加载 DOM 时创建的，但我不确定。谁能阐明这里真正发生的事情以及我应该做些什么来纠正它？我希望能够添加更多功能，所以不要寻找围绕编写 innerHTML 标签的工作，我只想了解我做错了什么。

谢谢你。

编辑了更多代码

```
//declare an array to hold all countries form the db
var countries = new Array();

function getCountries(region) {
    document.getElementById('scroller').innerHTML = '';

    //send the data to the server and retreive a list of all the countries based on the current region              
    $.ajax({
        type: "POST",
        url: "scripts/get_countries.php",
        data: {
            region: region
        },
        success: saveDataToArray,
        async: false,
        dataType: 'json'
    });

    //save the data to an array
    function saveDataToArray(data){
        var i = 0;
        while (data[i]){
            countries[i] = data[i];
            i++;
        }                           
    }

    scroller = document.getElementById('scroller');

    //create a ul element
    var holder = document.createElement("ul");

    //here create a back button which will recreate the whole list of regions

    var total = countries.length;
    for(i=0;i<total;i++){

    //create the first field in the list
    var bullet_item = document.createElement("li");

    //create an a tag for the element
    var a_tag = document.createElement("a");

    //set the redirect of the tag 
    a_tag.setAttribute("href", "javascript:setCountry(this);");

    //create some text for the a_tag
    var bullet_text = document.createTextNode(countries[i]);

    //apend the text to the correct element
    a_tag.appendChild(bullet_text);

    //apend the a_tag to the li element
    bullet_item.appendChild(a_tag);

    //apend the item to the list
    holder.appendChild(bullet_item);                        
}

//apend the holder to the scroller
scroller.appendChild(holder);   
            }

function setRegion(region){
    document.getElementById('region').innerHTML = region;
}

setCountry = function(value){
    document.getElementById('country').innerHTML = value;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T19:36:07.640

问题已解决
除了我声明 href 参数的方式之外，一切都很好

```
a_tag.setAttribute("href", "javascript:setCountry("+'"'+countries[i]+'"'+")"); 
```

这一切都是平常的，单引号和双引号的游戏。
感谢大家提出想法。像往常一样非常感谢

阿德里安

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:13:45.870

无需在字符串中引用代码。而不是这个：

```
a_tag.setAttribute("href", "javascript:...") 
```

尝试形成一个闭包：

```
a_tag.onclick = function () { ... } 
```

请注意，默认情况下没有的`<A>`元素`HREF`看起来不正常，但您可以使用 CSS 修复它。

# php - 对 SimpleXML 和 PHP 中的 Xpath 返回的结果进行排序

> ID：10936879
> 
> 赞同：1
> 
> 时间：2012-06-07T17:33:54.763
> 
> 标签：php, xml, xpath, simplexml, sorting

我从 XML 中获取并显示结果，如下所示：

```
<?php
    $xml = simplexml_load_file($url);
    //RUN QUERY ON XML
    $xQuery = $xml->xpath($query);

foreach($xQuery as $results){
?>
        MAKE:  <?php echo $results->Make;?><br />
        Model: <?php echo $results->Model;?><br />
   <?php } ?> 
```

现在我想做的是对 $xQuery 进行排序，例如在显示之前按字母顺序显示 Make 的结果。

这可能吗？如果是这样，我该如何管理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:37:47.860

您可能可以使用 XPath 或其他东西来完成，但`SimpleXMLElement::xpath()`返回一个易于排序的数组：

```
usort($xQuery, function ($a, $b) { return strcmp($a->Make, $b->Make); });
foreach ($xQuery as $results) {
    // …
} 
```

# javascript - .append() 删除添加的元素

> ID：10936880
> 
> 赞同：1
> 
> 时间：2012-06-07T17:33:58.407
> 
> 标签：javascript, jquery

我正在尝试将表行附加到现有表中。

这就是我的表格的结构：

```
<div id="productListContainer">
    <table id="productListTable">
            <thead>
                <tr>
                    <td>
                        #
                    </td>
                    <td>
                        Product Name
                    </td>
                    <td>
                        Price
                    </td>
                    <td>
                        Quantity
                    </td>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
</div> 
```

使用以下功能，我试图追加一个新的表格行：

```
function(data) {
                if (data.productAdded !== "undefined") {
                  $("#productListTable tr").append().html(data.productAdded);
                }
              } 
```

成功地附加了一行。但是，如果我选择触发相同功能的不同项目，则添加的表行将被新的行覆盖。

我在 ajax 调用中使用此函数作为成功消息。

'data' 是一个 JSON 对象，其中包含 productAdded，它本身就是作为字符串的表格行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T17:41:25.227

您想要做的是在我假设的表格主体中附加一行。为此，您需要这样做 -

```
$("#productListTable tbody").append(html_string); 
```

您`html_string`将需要包含与表格标题匹配的所有必要`<tr>`元素`<td>`。

参考 -

*   `.append()`文档 - [http://api.jquery.com/append/](http://api.jquery.com/append/)
*   [jsFiddle 演示](http://jsfiddle.net/hHGat/12/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T17:40:50.930

不带参数调用`.append()`，不附加任何内容，并返回原始 jQuery 对象。所以，当你打电话时，`.html()`你正在替换`<tr>`'s 的内容。

它应该是：

```
$("#productListTable tr").append(data.productAdded); 
```

**编辑**：那将附加`<tr>`到`<thead>`. 我假设你想附加到`<tbody>`.

```
$("#productListTable tbody").append(data.productAdded); 
```

**编辑 2**：附加到表时，您需要确保字符串中有`<tr>`正确数量的`<td>`s。

# c# - 如何像在 WinForms DataGridView 中一样在 WPF DataGrid 中显示小指针

> ID：10936887
> 
> 赞同：1
> 
> 时间：2012-06-07T17:34:17.180
> 
> 标签：c#, wpf, wpfdatagrid

我正在研究 WPF 和 DataGrids，对此我真的很陌生。**我需要 WPF DataGrid 在其行标题**中显示 WindowsForms DataGridView 中的小指针（它看起来像一个指向右侧的小三角形）。

我试过这个属性：

```
dataGrid1.HeadersVisibility = DataGridHeadersVisibility.All; 
```

但是如上所述，dataGrid 得到了一些非常小的标题，这似乎只是为了选择整行。

我已经对此进行了一些研究，但我一无所获。

有谁知道这是否可能？

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T20:21:43.043

2件事——

1) 指定一个 SortMemberPath -- 这将为您提供默认样式 2) 设置网格标题模板的样式

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-13T16:03:53.403

经过一些研究，我发现了两个链接，可以让我做我想要完成的事情：

[WPF DataGrid 行指示器](http://thedovgals.com/andre/blog/?tag=wpf-datagrid-row-indicators)

或者这个：

[更改 DataGrid 控件的选定行的样式](http://www.silverlightshow.net/items/Changing-the-style-of-the-selected-row-of-the-DataGrid-control.aspx)

# java - Intent putExtra(String,String) 在 AsyncTask 中

> ID：10936896
> 
> 赞同：0
> 
> 时间：2012-06-07T17:34:53.057
> 
> 标签：java, android, xml

我只是想将一个字符串带到下一个活动中，而不必为该任务定义整个对象。我见过类似的解决方案并让它们工作但不使用 AsyncTask 来创建意图。

```
protected void onPostExecute(Boolean result) {
        if (loggedIn && hasPin) {

            Intent intent = new Intent(UniteActivity.this,
                    WebViewActivity.class);
            intent.putExtra(PASSED_USERNAME, passUser);
            startActivity(intent);
        }
        if (loggedIn && !hasPin) {

            Intent intent = new Intent(UniteActivity.this,
                    CreatePinActivity.class);
            intent.putExtra(PASSED_USERNAME, passUser);
            startActivity(intent); 
```

PASSED_USERNAME 是一个公共静态常量，用于保存包名称，就像 putExtra() 方法所需要的一样。然后我尝试在下一个活动中提取价值。

```
Intent extras = getIntent();

            String username = extras.getStringExtra(UniteActivity.PASSED_USERNAME);

            // carry username to next activity
            Intent intent = new Intent(CreatePinActivity.this,WebViewActivity.class);
            intent.putExtra(PASSED_USERNAME, username);
            startActivity(intent); 
```

永远没有要拉出的字符串，用户名的值始终为空。我浏览了调试器，发现 Eclipse IDE 调试器在活动之间显示了不同的意图 ID，它们从来都不一致。AsyncTask 是否有可能因为它分裂成一个单独的线程而以某种方式干扰？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:03:16.167

不确定您的解决方案的确切答案。您在 UI 上调用 startActivity，因为它位于 postExecute() 中。

如果一切都失败了，您可以将该值保存到共享首选项中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:05:39.113

您处理变量 PASSED_USERNAME 的方式似乎不正确。您在一些宫殿中将其用作简单的 PASSED_USERNAME，而在其他一些地方您将其与名为 UniteActivity.PASSED_USERNAME 的类一起使用。因为它是一个公共静态常量，所以总是使用它以类名作为前缀。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T17:52:19.060

我不知道这是否适用于您的问题，因为我无法从您的代码片段中看到中间活动是否是新创建的。

**但是**：`getIntent()`-method 总是返回启动活动的第一个 Intent。如果活动保持在后台并接收到新的 Intent，则此值不会自动更新。您必须覆盖`onNewIntent(...)`并手动调用`setIntent(...)`它才能工作（或直接在那里做所有的事情）。

因此，如果您没有在`onCreate()`方法中运行发布的代码，请检查您是否没有错过获取您感兴趣的真实意图。

# mercurial - Mercurial 管理现有网站？

> ID：10936897
> 
> 赞同：2
> 
> 时间：2012-06-07T17:34:53.273
> 
> 标签：mercurial

准备启动一个处于 beta 测试阶段的网站/项目。我想将它切换到版本控制（Mercurial，因为我熟悉它）。

问题是，我不知道该怎么做，因为网站上的代码已经启动并在使用中，以及如何处理我不需要管理的目录（供应商和网络/上传）。

解决这个问题的最佳方法是什么？

我是否会将整个站点放入一个文件夹中，初始化 Merc repo，使用 hgignore 不跟踪供应商和 web/上传，提交，然后将其克隆到实时服务器？

谢谢！由于该网站已上线并且有用户上传，因此对该怎么做感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T22:29:47.050

我假设您想将 Web 服务器上的网站目录转换为 Mercurial 存储库。如果是这种情况，您将在该计算机的某处创建一个新存储库，然后将新存储库中的 .hg 目录移动到您希望成为存储库根目录的网站目录中。然后你应该能够运行

```
hg add * --exclude vendor --exclude web/Upload
hg commit -m "Adding site to version control." 
```

将所有非用户文件纳入版本控制。

但是，我建议您编写一个脚本或研究将您的网站部署到 Web 根目录之外的存储库的工具。你不希望你的 .hg 目录暴露给世界。在您获得部署脚本/工具之前，请确保您告诉您的网络服务器禁止/拒绝对您的 .hg 目录的所有请求。

# css - 如何让容器 div 扩展到其内容的高度？

> ID：10936898
> 
> 赞同：1
> 
> 时间：2012-06-07T17:34:57.927
> 
> 标签：css, html, height

我希望容器 div 扩展到 div 内部内容（无序列表）的高度。我无法让它工作。有任何想法吗？

HTML：

```
<div class="container">
    <ul id="list">
        <li>stuff</li>
        ...
    </ul>
</div> 
```

CSS：（不起作用）

```
.container {
    width: 332px;
    height: 100%;
    padding: 0.4em; 
    position: relative; 
    overflow-y:scroll; 
    overflow-x:hidden;
}

#list {
    position: absolute;
    height:auto;
    width:317px;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T17:37:45.430

`overflow-y:scroll`与您希望它扩展的要求相冲突，因为`height:100%`100% 基于`.container`包含元素的高度。

您需要做的是删除`height:100%`and `overflow-y:scroll`，替换为`overflow-y:hidden`and 我**相信**它应该可以工作。

PS。为什么你需要`#list`成为`position:absolute`？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-07T17:58:46.430

从中删除`height: 100%;`和`position: relative;`从`.container`中删除。`position: absolute;``#list`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:38:36.670

两个选项：为#list 添加 height:100%

```
#list{
position: absolute;
height:auto;
width:317px;
height: 100%;
} 
```

或将容器设为 ID：

```
#container{
... 
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-07T18:03:35.463

为 .container 设置最小宽度和/或最大宽度属性

# volume - Soundcloud HTML5 音量控制

> ID：10936901
> 
> 赞同：0
> 
> 时间：2012-06-07T17:35:06.940
> 
> 标签：volume, soundcloud

我的网站上有一个使用 soundcloud HTML5 播放器的曲目。我想知道是否有什么方法可以让它更安静一点，这样它就不会在打开我的页面时让观众感到震惊。如果有人能引导我在正确的方向上改变 soundcloud 上的播放器音量，将不胜感激：D

我知道这与 javascript 有关：`setVolume(volume)`但我不熟悉 JavaScript，所以如果有人可以帮助我，那就太好了。我希望音量为 50%。

如果需要，我也可以使用 Flash 播放器。

我可以使用 HTML5 或 Flash 播放器，我只想在有人播放时将音量设置为 50%。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T03:32:34.147

您可以使用[小部件 API来执行此操作](http://developers.soundcloud.com/docs/html5-widget#)

基本上，小部件通过 iframe 嵌入到您的页面中。给 iframe 一个`id`，包含 API 库（上面链接），然后它真的很简单。

```
SC.Widget('myIframeId').setVolume(50); 
```

# php - CodeIgniter 在同一个控制器中调用方法

> ID：10936903
> 
> 赞同：0
> 
> 时间：2012-06-07T17:35:09.880
> 
> 标签：php, codeigniter

这是一个菜鸟问题。我有一个控制器，它从数据库更新记录，然后显示主页。在更新方法中，

```
function update() {
  $row = $this->db->update($tablename, $data);
  if($row == 1) {
    $this->index();
  }
} 
```

在这种情况下，视图会回到索引页面，但 url 仍然是 localhost/controller/update。我应该改用重定向吗？

```
function update() {
  $row = $this->db->update($tablename, $data);
  if($row == 1) {
    redirect(controller/index);
  }
} 
```

哪种方法是重定向页面的正确方法？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:37:02.787

我建议使用该`redirect`方法。这样他们就不会意外地重新加载页面，并重新编辑该行（我猜他们可能会反击......）。

PS你需要引号`controller/index`。

```
redirect('controller/index'); 
```

# delphi - 对于在相邻显示器上显示其边框的最大化、样式化窗口，我能做些什么？

> ID：10936906
> 
> 赞同：23
> 
> 时间：2012-06-07T17:35:17.133
> 
> 标签：delphi, delphi-xe2, vcl-styles, maximize-window

在多显示器系统上，“空白”VCL 应用程序可以很好地最大化，但是启用样式（并且选择了一个作为默认样式）的同一应用程序会错误地最大化。我看到的是窗口的右侧边缘延伸到第二台显示器（我的主要在左侧）。当我开始与其他 Windows 应用程序进行比较时，我注意到在 Windows 7 下（至少），最大化的窗口甚至在左侧、右侧或底部都没有非客户端边框。事实上，标准 VCL（非样式化）应用程序的行为方式相同，没有非客户端边界。

我该如何解决？我注意到 TFormStyleHook 有一个 WMNCCalcSize 处理程序，我还没有剖析它，但让我想知道 VCL 是否可能错误地处理最大化窗口的此消息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-02T02:16:10.970

在摆弄了一些时间之后，我的看法是，这根本不是 vcl 样式的错误。这确实与[mghie](https://stackoverflow.com/users/30568/mghie)对问题的[评论](https://stackoverflow.com/questions/10936906/#comment14279633_10936906)中提到的[文章](http://blogs.msdn.com/b/oldnewthing/archive/2012/03/26/10287385.aspx)中的行为有关。

具体行为是，最大化窗口的大小大于窗口最大化的监视器的工作区域。据说，窗口管理器隐藏了悬垂的边框。显然，对于定制的框架，它并没有做到这一点。请注意，MSDN 自己的[自定义窗口框架示例](http://msdn.microsoft.com/en-us/library/bb688195%28v=vs.85%29.aspx)似乎遇到了同样的问题（请参阅社区内容中标题为*“窗口最大化时的错误”的帖子）。*VCL 的应用程序与 MSDN 示例的不同之处在于它不是基于 DWM，但我仍然认为这是同一个问题。

悬垂边界的大小与系统调整边界 (SM_C[X|Y]SIZEFRAME) 的大小相同，但这与下面的解决方法无关，因为它忽略了操作系统建议的大小/位置并使用了工作区。

不幸的是，我认为这种解决方法根本不可用。一方面，没有记录提到的行为，另一方面，解决方法并不完美；仍然有一个奇怪的像素。如果您将窗口准确地捕捉到工作区，窗口管理器会决定将窗口偏移到它认为应该放置窗口（带有隐藏框架）的位置。（VCL 可能会被修改为执行窗口管理器所做的事情，并考虑到悬垂并且不绘制它们或类似的东西，但这将是更多的工作，它仍然是解决未记录的行为..）

反正;

```
type
  TForm1 = class(TForm)
    ..
  protected
    // overriding styles is not necessary since TFormStyleHook.WMGetMinMaxInfo
    // first calls the default window procedure 
    procedure WMGetMinMaxInfo(var Message: TWMGetMinMaxInfo);
      message WM_GETMINMAXINFO;

..

procedure TForm1.WMGetMinMaxInfo(var Message: TWMGetMinMaxInfo);
var
  R: TRect;
begin
  // always arrives with MinMaxInfo.ptMaxPosition = (-SM_CXFRAME, -SM_CYFRAME)
  // and MinMaxInfo.ptMaxSize = (PrimaryMonitor.Width (?) + 2 * SM_CXFRAME, ... )
  inherited;

  // should test for OS, styles etc. before running the below 
  R := Monitor.WorkareaRect;
  InflateRect(R, -1, -1);             // odd pixel
  OffsetRect(R, -Monitor.Left, -Monitor.Top);
  Message.MinMaxInfo.ptMaxPosition := R.TopLeft;
  Message.MinMaxInfo.ptMaxSize := Point(R.Width, R.Height);
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-14T22:28:40.520

我发现的唯一方法是处理 WM_SIZE 事件并修改窗口区域以切断额外的边框。

# java - 如何确定 InvokeInstruction (BCEL) 调用的方法？

> ID：10936910
> 
> 赞同：1
> 
> 时间：2012-06-07T17:35:25.100
> 
> 标签：java, methods, bytecode, invocation, bcel

我正在尝试确定 BCEL 库中给定 InvokeInstruction 的被调用方的 MethodGen。问题是我不知道如何使用 InvokeInstruction 来访问它试图调用的 MethodGen。

如果我有一个程序的主要方法的 BCEL MethodGen 对象，我可以浏览指令列表并找到那些是 InvokeInstructions 的：

```
// Assume MethodGen mainMG is given to us
Instruction[] insns = mainMG.getInstructionList().getInstructions();
for(Instruction insn : insns) {
    if(insn instanceof InvokeInstruction) {
        // great, found an invoke instruction
        InvokeInstruction invoke = (InvokeInstruction)insn;

        // what do I do with it now?
    }
} 
```

BCEL 的一些文档很棒，而其他部分则有些欠缺。有关如何将 InvokeInstruction 链接到被调用方法的 MethodGen 的任何建议？

如果它简化了事情，我现在可以假设该程序没有任何多态性。尽管在某些时候我将不得不（保守地）处理它。

* * *

**澄清**：我意识到这样做没有直接的途径（例如`invoke.getCalledMethodGen()`），但我想知道是否有某种方法可以从调用指令（例如方法的 FQN 或等效项）中获得足够的不同信息，我可以链接它回到被调用的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T18:24:24.623

一般你不能。BCEL 和大多数其他框架，用于处理在单个类上运行的字节码。因此，您将阅读所有可用的类（可以懒惰地这样做）并构建您自己的 MethodGen 存储库（例如 FQN 方法名称到 MethodGen 实例的映射）。

# javascript - javascript窗口重定向不会启动

> ID：10936912
> 
> 赞同：3
> 
> 时间：2012-06-07T17:35:30.737
> 
> 标签：javascript, webforms

这个问题对我来说似乎很奇怪，我似乎无法解决它。我有一个简单的 HTML 表单；在里面，我确实有一个文本框和一个按钮，如下所示：

```
<form id="form1" method="get"> <!-- Note: No Action property -->
    <div>
       <h1>
           Simple Test Form</h1>
       <table border="0" width="400">
           <tr>
               <td align="right">
                   All of these words
               </td>
               <td>
                   <input name="txtAll" id="txtAll" type="text" value="testing keyword" />
               </td>
           </tr>
           <tr>
               <td colspan="2" align="center">
                   <input type="submit" name="Submit" value="Submit" onclick="myJS(this);" />
               </td>
           </tr>
       </table>
   </div>
</form> 
```

MyJS 文件如下：

```
<script type="text/javascript">
    function myJS(which) {
        var CONSTANT_SITE_TARGET = "http://servername/redirect/target.aspx?text=";

        //capture all values from the form
        var allWords = document.getElementById("txtAll").value;

        var morestring = ""; //More data manipulation here.....
        var url = CONSTANT_SITE_TARGET + allWords + morestring;

        window.open(url);
        //window.location = url;          //Doesn't work
        //window.location.href = url;     //Doesn't work
        //self.location = url;            //Doesn't work
        //top.location = url;             //Doesn't work
    }
</script> 
```

如您所见，它不会重定向到 javascript 中的指定 URL。当我使用 window.open 时，它可以工作。请注意，在 <form...> 标记中，我没有将*action*属性放入其中。我不想打开新浏览器，只需重定向到同一浏览器中的新网址。

有没有办法重定向它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T17:42:05.250

不要使用表单标签。或者，将按钮的“类型”属性设置为“按钮”，而不是“提交”。当您单击按钮时，表单会提交，但您不希望这种情况发生。删除表单或更改按钮应该可以修复不正确的重定向。当您不指定操作时，我很确定默认值是当前 URL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:43:18.067

好的，只是一个想法。由于您尚未设置`action`参数，因此按钮的默认行为`submit`是重新加载同一页面。你通过处理它来改变那个行为`onclick`。也许有一个冲突可以通过`return false;`在单击处理程序的末尾来解决，这会阻止该事件的默认操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T17:45:04.837

这里

```
function myJS(which) {
    var CONSTANT_SITE_TARGET = "http://servername/redirect/target.aspx?text=";

    //capture all values from the form
    var allWords = which.txtAll.value;

    var morestring = ""; //More data manipulation here.....
    return CONSTANT_SITE_TARGET + allWords + morestring;
}

<form id="form1" method="get" onsubmit="this.action=myJs(this)">
<div>
    <h1>
        Simple Test Form</h1>
    <table border="0" width="400">
        <tr>
            <td align="right">
                All of these words
            </td>
            <td>
                <input name="txtAll" id="txtAll" type="text" value="testing keyword" />
            </td>
        </tr>
        <tr>
            <td colspan="2" align="center">
                <input type="submit" name="Submit" value="Submit" />
            </td>
        </tr>
    </table>
</div>
</form> 
```

详细说明评论：

```
<script>
window.onload=function() {
  document.getElementById("Submit").onclick=function() {
     var CONSTANT_SITE_TARGET = "http://servername/redirect/target.aspx?text=";
    //capture all values from the form
    var allWords = document.getElementById("txtAll".value;
    var morestring = ""; //More data manipulation here.....
    location = CONSTANT_SITE_TARGET + allWords + morestring;
  }
}
</script>
<div>
    <h1>
        Simple Test Form</h1>
    <table border="0" width="400">
        <tr>
            <td align="right">
                All of these words
            </td>
            <td>
                <input name="txtAll" id="txtAll" type="text" value="testing keyword" />
            </td>
        </tr>
        <tr>
            <td colspan="2" align="center">
                <input type="button" id="Submit" value="Submit" />
            </td>
        </tr>
    </table>
</div> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-07T17:52:23.690

尝试以下重定向选项之一。我注释掉了其中的三个以使代码保持有效，但您可以尝试使用其中的任何一个，看看它是否适合您的需要。

```
 var CONSTANT_SITE_TARGET = "http://servername/redirect/target.aspx?text=";

    //capture all values from the form
    var allWords = document.getElementById("txtAll").value;

    var morestring = ""; //More data manipulation here.....
    var url = CONSTANT_SITE_TARGET + allWords + morestring;

     window.location.href= url;
     //window.navigate(url);
     //self.location(url);
     //top.location(url); 
```

# c++ - 在窗口调整大小时重新定位图形项目

> ID：10936913
> 
> 赞同：0
> 
> 时间：2012-06-07T17:35:32.263
> 
> 标签：c++, qt, qgraphicsview, qgraphicsitem, qgraphicsscene

好的，我基本上在图形场景中随机放置了图形项目。我打开一个窗口并显示这些项目。当我调整窗口大小时，我希望这些项目保持相同大小但与窗口大小成比例地重新定位。我是如何做到这一点的，我将图形视图子类化，然后当发生调整大小事件时，它将调整大小对象发送到我的图形场景对象。然后我能够做这样的事情：

```
double scaleX = double(event->size().width())/double(event->oldSize().width());
double scaleY = double(event->size().height())/double(event->oldSize().height()); 
```

然后我使用这些值来做到这一点：

```
derivedPointItem->setPos( derivedPointItem->pos().x() * scaleX,
                          derivedPointItem->pos().y() * scaleY ); 
```

这工作正常，但如果我将窗口调整得非常小或大，那就不太对了。我认为问题在于图形场景矩形和图形视图矩形不一样或什么。此外，我有一个调整窗口大小的背景：

```
void roiwindow::drawBackground( QPainter* painter, const QRectF& rect )
{
    this->setSceneRect(0,0,rect.width(),rect.height());
    painter->save();
    painter->drawImage(rect, *refimage);
    painter->restore();
} 
```

这是我正在编写的程序中需要的东西。此外，它允许我查看调整大小是否有效。我基本上可以将背景设置为多边形，然后在多边形的边缘放置点。当我将图像调整为非常大或小时，这些点不再位于多边形的顶点上，尽管它们有点接近。有谁知道更好的方法或解决方法？谢谢。

编辑：这是我正在做的项目：

dropbox.com/s/myxi8kvdl7x9ye2/ncorr.tar.gz

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T18:35:17.530

这种方法实际上有效（尽管我不确定它是否是最好的方法......）。无论如何，由于 setPos() 函数，它最终成为编码错误。我程序中的 setPos() 函数通过指定图像左上角的坐标而不是中心来工作。这最终导致了一些错误。

# python - 运行 django-admin.py startproject 给我一个错误

> ID：10936920
> 
> 赞同：1
> 
> 时间：2012-06-07T17:36:28.250
> 
> 标签：python, django, command-line, cmd

我刚刚开始研究 python 和 django .. 我很确定我成功安装了 python 和 django 框架，并且我设法将 python 和 django-admin.py 添加到我的系统路径但是现在当我运行命令`django-admin.py startproject My_Test_Site`时，在我想在其中创建一个新项目目录的文件夹（仅按照教程），我收到以下错误：

![我收到的错误的命令提示符屏幕截图](../Images/271147ea9598e3a908a04c7aa466ac27.png)

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:45:16.897

这不是 Django 错误。它似乎找不到作为Python 标准库 ( [docs](http://docs.python.org/library/unicodedata.html)`unicodedata` )一部分的Python 模块。我看到还有关于此问题的错误报告（Windows 上的 Python 2.7，请参见[此处](http://bugs.python.org/issue14975)）。另一方面，那里的一些人报告说重新安装他们的 Python 安装解决了这个问题。你可以试试看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T21:35:24.133

注意最后一行，它说 import unicodedata, importError

我猜你可能没有正确安装你的 django。

所以重新安装它并检查 django 是否在你的“路径”中，我相信 django 在安装时会自动执行此操作，但仔细检查并没有什么坏处。

如果重新安装 django 仍然不起作用，我建议你卸载 python 和 django 相关的东西。

然后安装python，安装pip，然后使用pip install django。

# .net - 如何使用带有 WCF 的存储库模式进行 CRUD 操作并避免代码重复

> ID：10936921
> 
> 赞同：1
> 
> 时间：2012-06-07T17:36:29.810
> 
> 标签：.net, wcf, repository-pattern

我有一个通过 WCF 接口公开一些 CRUD 操作的服务。

**服务：**

```
bool SavePerson(Person obj)
{
  Repository<Person> currentRepo = new Repository<Person>();
  currentRepo.Save(obj);
}
bool SaveAddress(Address obj)
{
  Repository<Address> currentRepo = new Repository<Address>();
  currentRepo.Save(obj);
} 
```

与每个接口定义

```
[OperationContract()]
bool SavePerson(Person obj);
[OperationContract()]
bool SaveAddress(Address obj); 
```

我有一个使用这些方法的 Web 客户端。

**网站：**

```
SaveAddress(addr);
SavePerson(pers); 
```

浏览了一下网站后，我知道泛型方法不适用于 WCF，所以 Web 不能做类似的事情`SaveObject<Address>(addr); SaveObject<Person>(pers);`

我的问题是，有没有办法减少代码重复的数量？理想情况下，我想减小 WCF 接口的大小。即使那不可行，我至少可以在服务端组合方法实现吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T21:12:53.197

REST WCF 服务应该可以帮助您。他们不会完全实现你想要的，但它是唯一可以减少接口和复制粘贴的东西。

[http://msdn.microsoft.com/library/dd203052.aspx](http://msdn.microsoft.com/library/dd203052.aspx)

# java - 带有 Cygwin 的 Windows 上的 HBase 0.92 Standalone

> ID：10936924
> 
> 赞同：8
> 
> 时间：2012-06-07T17:36:38.873
> 
> 标签：java, cygwin, hbase

有人知道如何在 Cygwin 下的 Windows 上运行 HBase 的教程吗？

我设法设置了所有内容，例如使用 SSH 自动登录的密钥，但我遇到了以下错误消息：

```
localhost: +======================================================================+
localhost: |      Error: JAVA_HOME is not set and Java could not be found         |
localhost: +----------------------------------------------------------------------+
localhost: | Please download the latest Sun JDK from the Sun Java web site        |
localhost: |       > http://java.sun.com/javase/downloads/ <                      |
localhost: |                                                                      |
localhost: | HBase requires Java 1.6 or later.                                    |
localhost: | NOTE: This script will find Sun Java whether you install using the   |
localhost: |       binary or the RPM based installer.                             |
localhost: +======================================================================+ 
```

...

```
java.lang.NoClassDefFoundError: org/apache/zookeeper/KeeperException
        at java.lang.Class.getDeclaredMethods0(Native Method)
        at java.lang.Class.privateGetDeclaredMethods(Unknown Source)
        at java.lang.Class.getMethod0(Unknown Source)
        at java.lang.Class.getMethod(Unknown Source)
        at sun.launcher.LauncherHelper.getMainMethod(Unknown Source)
        at sun.launcher.LauncherHelper.checkAndLoadMain(Unknown Source)
Caused by: java.lang.ClassNotFoundException: org.apache.zookeeper.KeeperException
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.net.URLClassLoader$1.run(Unknown Source) 
```

我已经将 .bash_profile 设置为指向：

```
export JAVA_HOME='/usr/lib/jre1.6.1' 
```

这是真实jre上的符号链接

```
/usr/lib/jre1.6.1 -> /cygdrive/c/Java/jre7/ 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-11-14T15:11:58.567

我遇到了同样的问题，我发现了以下问题： Cygwin 使用“：”作为路径分隔符。但是创建 CLASS_PATH 的脚本工作不正确。最终的 CLASS_PATH 看起来像 "...:zookeeper.jar:"，最后带有 ":"。在运行将 CLASS_PATH 转换为 Windows 样式的 java 脚本之前。但最后有“：”！

所以我的解决方案是：只需**在 hbase/lib 下创建一个空文件“zzz.jar”**。zzz.jar 将在 CLASS_PATH 中的最后一个，并且 zookeeper.jar 将正确添加到 CLASS_PATH。

*我知道修复脚本更好，但我在乎 :) 我只需要 2 天的 HBase，所以它可以工作，我很高兴 :)*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-09T11:05:11.667

对于`JAVA_HOME`错误，您可以通过`JAVA_HOME`在`hbase\conf\hbase-env.sh`.

对于找不到类的异常，请尝试将 添加`hbase\lib`到`HBASE_CLASSPATH`同一文件下。

就个人而言，我`hbase-env.sh`在 Windows 7 Environment + Cygwin 中使用以下两行：

```
export JAVA_HOME=/cygdrive/c/Program\ Files/Java/jdk1.7.0/

export HBASE_CLASSPATH=/cygdrive/c/programs/hbase-0.92.1/lib/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-14T19:56:33.760

使用虚拟机在 Linux 环境中运行 hadoop。使用 Java，您可能会在 Windows 下遇到典型的问题，将 Cygwin 添加到混合中会增加另一组，例如：

*   [包含路径中的空格](http://ist.berkeley.edu/as-ag/technology/howto/install-java-sdk-win.html)
*   来自不同应用程序（例如浏览器插件）的多个 java 安装可能会破坏 CLASSPATH、JAVA_HOME 和 PATH 变量的一致性
*   [shell 脚本路径/语法问题](http://www.weiqigao.com/blog/2008/03/10/java_bash_cygwin.html)

出于教程目的，我**强烈推荐**cloudera**演示 VM 和教程**： [https ://ccp.cloudera.com/display/SUPPORT/Cloudera%27s+Hadoop+Demo+VM](https://ccp.cloudera.com/display/SUPPORT/Cloudera%27s+Hadoop+Demo+VM)

[https://ccp.cloudera.com/display/SUPPORT/Hadoop+Tutorial#HadoopTutorial-Purpose](https://ccp.cloudera.com/display/SUPPORT/Hadoop+Tutorial#HadoopTutorial-Purpose)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T15:58:46.147

编辑：

第一个错误看起来像是找不到Java，但第二个错误显然来自Java，因此这两个错误的组合有些混乱。你确定它们都是由同一个脚本同时制作的吗？

第二个错误是由于类路径中没有 zookeeper jar 文件引起的。尝试修改脚本或将 jar 复制到 hadoop lib 目录中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-12T08:41:51.053

`hbase_classpath`不需要，只需更改`zookeeper.jar`为`azookeeper.jar`

# tinymce - TinyMCE 弹出窗口空白

> ID：10936935
> 
> 赞同：3
> 
> 时间：2012-06-07T17:37:43.887
> 
> 标签：tinymce

我浏览了几篇询问此问题的帖子，但我无法解决它 - 我现在收到的错误消息对我来说毫无意义。

我已将 TinyMCE 添加到文本区域，如下所示：

```
tinyMCE.init({
    theme : "advanced",
    mode : "textareas",
    relative_urls: true,
    plugins : "inlinepopups",
    theme_advanced_statusbar_location : 'bottom',
    theme_advanced_resizing : true,
    theme_advanced_path : false,
    theme_advanced_resizing_min_width : 600,
    theme_advanced_resizing_max_width : 800
}); 
```

当我打开页面时，它给了我以下错误：

**不安全的 JavaScript 尝试从 URL http://www.mysite.com/js/tiny_mce/themes/advanced/link.htm 的框架访问具有 URL [http://www.mysite.com/mypage](http://www.mysite.com/js/tiny_mce/themes/advanced/link.htm)[的](http://www.mysite.com/mypage)框架。域、协议和端口必须匹配。**

据我所知，如果您尝试跨域访问 JavaScript，就会导致此错误。然而，域似乎是相同的（我唯一改变的是实际的站点名称和实际的页面 - 其余的是一个字母一个字母的复制）。

在文件 tiny_mce_popup.js 中，我`document.domain = 'www.mysite.com';`根据一些建议添加了，但似乎没有帮助。如果我将它添加到 tiny_mce.js，我会收到一个错误，即我的 document.domain 值无效。

任何建议或想法将不胜感激。

**编辑**

我包含 TinyMCE 的脚本标签是：

```
<script type="text/javascript" src="http://www.mysite.com/js/tiny_mce/tiny_mce.js"></script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T08:06:08.467

这也可能对您有所帮助：[Django admin 中的 Tiny MCE popups blank](https://stackoverflow.com/questions/572025/tiny-mce-popups-blank-in-django-admin)

您的问题的另一个原因可能是您的网络服务器（例如：Apache）未配置为从您的 media_url 提供静态媒体文件。

# scipy - 如何找到“最佳”截止点（阈值）

> ID：10936945
> 
> 赞同：2
> 
> 时间：2012-06-07T17:38:04.410
> 
> 标签：scipy, threshold

我有一组用于机器学习的加权特征。我想减少功能集，只使用重量非常大或非常小的那些。

因此，在下面的排序权重图像中，我只想使用权重高于较高或低于较低黄线的特征。

![分类特征； 黄线是所需的截止点（阈值）](../Images/7c9e3af2ee87a4b141a8dab1b8c6de07.png)

我正在寻找的是某种斜率变化检测，因此我可以丢弃所有特征，直到第一个/最后一个斜率系数增加/减少。

虽然我（认为我）知道如何自己编写代码（使用一阶和二阶数值导数），但我对任何已建立的方法都感兴趣。也许有一些统计数据或索引可以计算类似的东西，或者我可以从 SciPy 使用的任何东西？

**编辑：** 目前，我使用`1.8*positive.std()`的是正阈值和`1.8*negative.std()`负阈值（快速而简单），但我不是足够的数学家来确定这是多么强大。不过，我认为不是。⍨</p>

![在此处输入图像描述](../Images/69c7cdc7af42da51bc83b67a589fb17e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-02T21:57:22.067

如果数据是（近似）高斯分布的，那么只使用标准偏差的倍数是明智的。

如果您担心尾部较重，那么您可能希望基于订单统计数据进行分析。

*   既然您已经绘制了它，我会假设您愿意对所有数据进行排序。
*   设 N 为样本中的数据点数。
*   令 x[i] 为已排序值列表中的第 i 个值。
*   那么 0.5( x[int( 0.8413*N)]-x[int(0.1587*N)]) 是对标准差的估计，它对异常值更稳健。如上所述，可以使用这个标准的估计值。（上面的幻数分别是小于 [mean+1sigma] 和 [mean-1sigma] 的数据部分）。

*   在某些情况下，只保留最高 10% 和最低 10% 也是明智的；如果您手头有已排序的数据，这些截止值很容易计算。

这些是基于您问题内容的临时方法。您尝试做的一般意义是异常检测（一种形式），如果您在定义/估计靠近中间的分布形状时小心翼翼，您可能会做得更好，这样您就可以判断特征何时变得异常。

# android - 禁用窗口和过渡设置

> ID：10936946
> 
> 赞同：1
> 
> 时间：2012-06-07T17:38:16.257
> 
> 标签：android, settings, android-contentresolver

所以我需要做的是在代码中打开和关闭窗口和/或过渡动画，以获得与设置 > 显示 > 动画 > 禁用所有动画相同的效果。

我熟悉更改设备设置的方式是在 Settings.System.putInt() 方法中使用 ContentResolver，如下所示：

```
ContentResolver cr = getContentResolver();
Settings.System.putInt(cr, Settings.System.WINDOW_ANIMATION_SCALE, 0); 
```

如文档“设置为 0 将禁用所有 .... 动画”中所述，这两种设置都适用。在使用 putInt() 方法之前和之后读取设置时，使用以下命令：

```
Settings.System.getString(cr, Settings.System.WINDOW_ANIMATION_SCALE); 
```

我可以看到设置正在更改。然而，当然后做一些事情来开始一个窗口或过渡动画时，很明显可以看到设置没有任何区别并且过渡仍然发生。

我还想说，当我从“设置”屏幕中更改设置时，我可以看到重新运行我的应用程序时设置已更改。所以看起来这是正确的设置，我的应用程序没有正确更改它。

还有什么我想念的吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T15:33:23.510

检查您是否设置了正确的比例。

```
Settings.System.TRANSITION_ANIMATION_SCALE 
```

将更改 Activity 转换。

然而：

```
Settings.System.WINDOW_ANIMATION_SCALE 
```

将影响窗口动画，例如对话框打开。

（添加 API16）这将启用/禁用查看特定动画。

```
Settings.System.ANIMATOR_DURATION_SCALE 
```

我也很确定这些是`floats`因为这些可以是 0.5 倍动画设置，意味着半速。我以前从未在应用程序中尝试过这些。

但有两件事浮现在脑海：

*   是异步的`ContentProvider`，您需要收听设置完成设置
*   此外，在您创建/完成和活动之前，这些可能不会起作用。意思是在活动中更改它们可能不会影响当前`Activity`，但我将不得不测试该理论。

# mysql - MySQL 连接查询或子查询

> ID：10936949
> 
> 赞同：1
> 
> 时间：2012-06-07T17:38:35.850
> 
> 标签：mysql

我正在尝试进行查询，以选择`mike`它是否不在关键字的三个最高出价中。应选择第 4 行和第 7 行。

因此，最后，如果 mike 不在关键字的三个最高出价中，则选择。

我该如何解决这个问题？使用子查询？

```
$construct = "SELECT child.* FROM `temp-advertise` child
    LEFT JOIN `temp-advertise` parent on child.keyword=parent.keyword
    WHERE child.name='mike'
    ORDER BY child.id DESC";

 id  |  name| keyword    | bid   |
   1 |  mike|  one       |  7    |
   2 |  tom |  one       |  4    |
   3 |  ced |  one       |  6    |
   4 |  mike|  two       |  1    |
   5 |  tom |  two       |  5    |
   6 |  har |  two       |  5    |
   7 |  mike|  one       |  3    |
   8 |  har |  two       |  3    | 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T18:04:08.923

```
SELECT  *
FROM    `temp-advertise` ta
WHERE   ta.keyword = 'one'
        AND ta.name = 'mike'
        AND ta.bid <
        (
        SELECT  bid
        FROM    `temp-advertise` tai
        WHERE   tai.keyword = 'one'
        ORDER BY
                bid DESC
        LIMIT 2, 1
        ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:31:39.253

试试这个：

```
Select ID, name, keyword from temp-advertise e
    where 3 <= (select count(name) from temp-advertise
        where e.keyword = keyword and bid > e.bid) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-07T18:33:17.690

您的结构看起来不太有希望，您的示例数据也没有。但是，也就是说，您想知道“Mike”是否在每个关键字的前 3 名中......并且他有 3 个出价......“一”为 2，“二”为 1。从原始数据来看，Mike 的“一”关键字排名第一和第四，“二”关键字排名第四。

这应该可以让您在某些方面获得您需要的东西，而不是对所有关键字进行完整查询。第一个最里面的查询是通过“mike”（因此别名“JustMike”）获得关键字出价。然后将其加入到只有那些关键字的临时广告中。

接下来，通过使用 MySQL 变量，我们可以跟踪 PER KEYWORD 的排名。诀窍是 ORDER BY 子句需要以代表正确排名的顺序返回它们。在这种情况下，每个关键字在前，然后在每个关键字内，按最高出价排序。

通过查询记录，然后使用@variables，我们增加计数器，每次关键字更改时从1开始，然后将关键字保存到@grpKeyword变量中以用于比较下一条记录。一旦针对各个关键字处理了所有出价，它就会查询该结果，但仅针对“mike”出价的结果。这些记录将有任何他的等级位置。

```
select RankPerKeyword.*
   from
      ( SELECT ta.*,
               @grpCnt := if( @grpKeyword = ta.Keyword, @grpCnt +1, 1 ) as KWRank,
               @grpKeyword := ta.Keyword as carryForward
           FROM 
              ( select distinct ta1.keyword
                   from `temp-advertise` ta1
                   where ta1.name = "mike" ) as JustMike
                 JOIN `temp-advertise` ta
                    on JustMike.Keyword = ta.Keyword,
              ( select @grpCnt := 0,
                       @grpKeyword := '' ) SqlVars
           ORDER BY 
              ta.Keyword,
              ta.Bid DESC" ) RankPerKeyword
   where
     RankPerKeyword.name = "mike" 
```

（上面运行只是预览结果...应该显示 3 条记录）

因此，如果您想知道它是否在关键字的前 3 名之内，您可以更改为

```
select RankPerKeyword.keyword, MIN( RankPerKeyword.KWRank ) as BestRank
  from (rest of query)
  group by RankPerKeyword.Keyword 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-06-07T17:57:59.907

尝试

```
SELECT .. ORDER BY bid LIMIT 3,999 
```

# google-chrome-extension - 确定扩展状态

> ID：10936956
> 
> 赞同：0
> 
> 时间：2012-06-07T17:39:04.300
> 
> 标签：google-chrome-extension

在我的 chrome 扩展程序中，我想在扩展程序运行时在内存中对用户首选项进行任何更改，并且仅在扩展程序即将终止时将首选项（作为 JSON obj）保存到 localStorage（我使用背景 html 页面在我的扩展中）。

我目前正在每次更改首选项时都写信给 localStorage，但我希望看看这是否可以更有效地避免在每次首选项更改时写入磁盘，而是在终止前只执行一次。

有什么方法可以知道扩展何时终止，或者有人知道处理这种情况的更好方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-08T00:47:01.460

这有帮助吗？

```
 function saveSettings(){
     window.clearTimeout(window.savingSettings);
     return window.savingSettings = window.setTimeout(function(){ 
         ... // write to local storage here.
     },2000)
 }; 
```

这将确保：

1.  保存操作之间至少有两秒钟
2.  整个事情在某种程度上与主线程并行运行

您应该会在一定程度上看到性能提升，但有一个问题。如果用户在更改首选项后没有等待那两秒钟就关闭了浏览器，则首选项将不会被保存。

# java - 评估字符串时的错误答案

> ID：10936961
> 
> 赞同：2
> 
> 时间：2012-06-07T17:39:29.263
> 
> 标签：java, javascript, scriptengine

我的代码如下所示：

```
 ScriptEngineManager factory = new ScriptEngineManager();
    ScriptEngine engine = factory.getEngineByName("JavaScript");
    int x = 10;
    engine.eval("x =" + x);
    System.out.println((Boolean) engine.eval("x < 5"));
    System.out.println((Boolean) engine.eval("2 < x < 5")); 
```

第一个 SOP 按预期打印为 false，但第二个 SOP 打印为 true。当我将变量与两个值进行比较时，它没有给出正确的结果。即使条件的一半为真，它也会给出真值。有什么解决方法吗？请建议。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-07T17:44:11.553

`2 < x < 5`不做你认为它做的事。评估如下：

```
2 < x < 5
(2 < x) < 5
(2 < 10) < 5
true < 5
1 < 5
true 
```

试试`(2 < x) && (x < 5)`吧。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-07T17:44:57.613

将我的评论转为 anwser

`2 < x < 5 => (2 < 10 ) < 5 => (true) < 5 => 1 < 5 => true`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-07T17:45:04.947

不，它实际上产生了正确的结果。您的表达式是这样评估的：

1.  2 < x => 真
2.  true < 5 => 1 < 5（类型强制）
3.  1 < 5 => 真
4.  真的

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-07T17:45:30.050

要解决此问题，请尝试指定必须满足这两个条件。

System.out.println((Boolean) engine.eval("2 < x && x < 5"));

# c# - 在 ASP.NET 和 C# 中回发表单后的重复列表

> ID：10936962
> 
> 赞同：1
> 
> 时间：2012-06-07T17:39:35.727
> 
> 标签：c#, asp.net

我有一些代码使用 ASP.NET 和 C# 从文件夹中检索文件，并使用 CheckBoxList 显示它们，因为用户将能够选择其中一个文件，然后在最后使用按钮，用户将能够通过电子邮件发送该选定项目。

我遇到的问题是，在选择项目并发送电子邮件后，页面重新加载并且项目重复，我不确定为什么或如何更正。任何帮助将不胜感激。

代码如下：

```
if (File.Exists(wavFile))
                    {

                        ListItemCollection itemCollection = CheckBoxList2.Items;
                        itemCollection.Add(new ListItem(wavFile));
                        itemCollection.Add(new ListItem("<asp:Panel ID=\"Panel1\" runat=\"server\"><object id=\"MediaPlayer\" width=\"100\" height=\"42\" classid=\"CLSID:22D6F312-B0F6-11D0-94AB-0080C74C7E95\" standby=\"Loading Windows Media Player components...\"" +
                                          "type=\"application/x-oleobject\"><param name=\"FileName\" value=\"" + wavFile + "\"><param name='AUTOPLAY' value='0'>" +
                                          "<embed type=\"application/x-mplayer2\" src=\"" + wavFile + "\" pluginspage=\"http://www.microsoft.com/Windows/MediaPlayer/\" name=\"MediaPlayer\" uimode=\"none\" width=\"300\" height=\"42\">" +
                                          "</embed></object></asp:Panel><br/><br/>")); 
```

}

然后电子邮件由带有以下代码的按钮控制：

```
protected void btnSend_Click1(object sender, EventArgs e)
    {
        try
        {
            MailMessage mail = new MailMessage();
            mail.To.Add("email@email.com");
            mail.From = new MailAddress("email@email.com");
            mail.Subject = claimNumber.Text;
            mail.Body = "This is a test of the email again.";
            System.Net.Mail.Attachment attachment;
            attachment = new System.Net.Mail.Attachment(CheckBoxList2.SelectedValue);
            mail.Attachments.Add(attachment);
            mail.IsBodyHtml = true;
            SmtpClient smtp = new SmtpClient();
            smtp.Host = "smtp.email.com"; //Or Your SMTP Server Address
            smtp.Credentials = new System.Net.NetworkCredential
            ("email@email.com", "pa$$w0rd");

            smtp.EnableSsl = true;
            smtp.Send(mail);

            this.labelSuccessIndex.Text = "<br/><strong>The file has been emailed.</strong>";
        }
        catch (Exception ex)
        {
            labelError.Text = ex.Message;
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:42:27.880

将代码放在`if (!Page.IsPostBack)`. 这将在单击按钮后回发页面时停止执行。

```
if (!Page.IsPostBack)
{
    if (File.Exists(wavFile))
    {
        // Your code here
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T17:49:20.947

假设此块中的代码

```
if (File.Exists(wavFile)) 
```

在第一页加载时运行，而不仅仅是将该块包装在另一个 if

```
if(!Page.IsPostback) { if (File.Exists(wavFile))... } 
```

这将阻止代码再次添加到列表中。

如果您没有在初始加载时填充列表，那么您需要一些其他方法来避免第二次加载，或者清除列表并每次加载所有项目。

# mysql - 使用来自 Google App Engine 和 Django 的外部 MySQL 数据库

> ID：10936968
> 
> 赞同：1
> 
> 时间：2012-06-07T17:40:10.360
> 
> 标签：mysql, django, google-app-engine

我们希望将 Google App Engine 用于 Django 项目，以实现快速开发和可扩展部署。我们还想使用现有的 MySQL 服务器作为数据库。从理论上讲，这将消除使用 Google App Engine 存储解决方案和 Django 的问题。

不幸的是，虽然该应用程序在本地运行，但我在部署时收到以下错误：

```
ImproperlyConfigured: Error loading MySQLdb module: No module named MySQLdb 
```

从想要使用 Java 执行此操作的人的帖子中，我了解到我无法从 GAE 打开 MySQL 端口。在这种情况下，是否有一个在 Python 中访问远程 MySQL 数据库（使用诸如通过 HTTP 隧道传输的技术）的插入式解决方案，可以让我继续使用 Django ORM 功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-07T17:55:14.743

您无法访问自己的 Mysql，但是您可以使用[Google cloud Sql](https://developers.google.com/cloud-sql/docs/developers_guide_python#deploy_your_application_to_google_app_engine)。

# php - 尝试查看不存在用户的个人资料时显示 404 页面

> ID：10936972
> 
> 赞同：0
> 
> 时间：2012-06-07T17:40:25.160
> 
> 标签：php, .htaccess

在我的站点中，用户个人资料有 urls mysite.com/user/username。我真正想要做的 url 应该是 mysite.com/username。我已经完成了将这些代码行添加到 htaccess 文件中

```
RewriteRule ^([a-zA-Z0-9_-]+)$ user.php?uname=$1
RewriteRule ^([a-zA-Z0-9_-]+)/$ user.php?uname=$1 
```

现在我可以从 mysite.com/username 联系用户。但错误是，现在 404 文件不起作用。如果我输入像 myste.com/dasdfsf 这样不存在的 url，它不会得到 404 文档，因为它正在查看所有数字和字母（以查找用户名）并给我一个我为无效用户名创建的空白页面。如果该用户不存在，我希望它显示 404 页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:43:19.680

为什么显示无效用户名的空白页？改为显示您的 404 页面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-07T17:48:49.843

重定向：

```
RewriteRule ^user/([a-zA-Z0-9_-]+)$ http://example.com/$1 [R=301,L]
RewriteRule ^([a-zA-Z0-9_-]+)$ user.php?uname=$1 [L] #use the L option to stop processing
RewriteRule ^([a-zA-Z0-9_-]+)/$ user.php?uname=$1 [L] 
```

要显示 404，您需要设置 404 页面并添加逻辑`user.php`来阅读它。

```
<?php
    if(!userExist()){
        header('Status: 404 Not Found');
        echo file_get_contents('404.php');
        exit;//do this if there is code below that assumes this is a valid user
    }
?> 
```

# html - HTML/CSS - 将元素宽度扩展到可见区域（超出包含元素的宽度）

> ID：10936973
> 
> 赞同：1
> 
> 时间：2012-06-07T17:40:30.297
> 
> 标签：html, css, layout

我有一个正在生成的网页，其中有一个带有绿色背景的 h2 标记了一个表格。表格可以有任意数量的列，我希望 h2 元素水平延伸到用户可以滚动的范围内，以便表格上方始终有一个绿色条。我想要达到的效果是一个至少跨越表格宽度的绿色条，因此无论用户滚动多远，它始终位于表格的正上方。

这是它目前的样子（红色轮廓大致显示了包含 html、body 和 div 元素的边缘）： ![截屏](../Images/8a6bc5ff48693cd81ee53e08e8d885e7.png) 以下是相关的代码片段：

CSS：

```
h2 {
    font-family:Arial;
    font-size:20pt;
    color:#FFFFFF;
    text-align:left;
    font-weight:normal;
    background-color:#00693C;
    clear: both;
    padding:2px;
    margin: 0px;
}
table.response {
    border:1px outset;
    border-collapse: separate;
}
table.response td {
    font-size: 14px;
    padding: 3px;
    border:1px inset;
} 
```

html:

```
<h2>[snip]</h2>
<table class="response">
  <tbody>
    <tr>
      <td>[snip]</td>
      [...]
    </tr>
    [...]
  </tbody>
</table> 
```

我已经尝试过但没有奏效的事情：

1.  <thead> 元素包含单个 <tr> 和单个 <th>，其中 <th> 上的 colspan 设置为表中的列数。这适用于较少的列数，但对于较大的表（例如，colspan="6000"），某些浏览器（特别是 Firefox 11）将单元格（及其背景）呈现为仅占用一列。
2.  <thead> 元素包含一个 <tr> 和一个 <th>，其中 colspan="2" 以及为 <tr> 元素设置的 background-color CSS 属性。使用 Firefox 的 Inspect Element 功能，它显示 <tr> 跨越了表格的整个宽度，但背景仅应用于一个单元格。
3.  <thead> 元素包含一个 <tr> 和一个 <th>，其中 colspan="2" 和另一个 <th>，用于表的每个剩余列。我试图消除 <thead> 上单元格之间的分隔，但我无法做到。

我的问题是：有没有办法实现让绿色条至少延伸整个表格宽度的效果，如果是这样，它是什么？当我为表格生成 HTML 时，我宁愿不使用 JavaScript 或生成样式代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T17:45:42.217

将`float: left`or添加`display: inline-block`到包含`table`and的元素`h2`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-07T17:51:57.333

添加

```
div#container { display: inline-block; } 
```

`<h2>`到您的 CSS 中，并将and嵌入到`<table>`具有该名称的 DIV 中：

```
<div id='container'>
  <h2>...</h2>
  <table>
    ...
  </table>
</div> 
```

这应该适用于任何现代浏览器。

# python - 龙卷风测试@tornado.web.authenticated

> ID：10936978
> 
> 赞同：4
> 
> 时间：2012-06-07T17:40:57.323
> 
> 标签：python, tornado

我正在尝试使用[AsyncHTTPTestCase](http://www.tornadoweb.org/documentation/testing.html?highlight=asynchttptestcase#tornado.testing.AsyncHTTPTestCase)测试龙卷风。我想测试标有 @tornado.web.authenticated 注释的处理程序。因为这个处理程序需要身份验证，所以我们必须先登录，或者以某种方式欺骗它，认为我们在测试代码中已经过身份验证

```
class HandlerToTest(BaseHandler):
  @tornado.web.authenticated
  def get(self):
    self.render("hello.html", user=self.get_current_user() ) 
```

根据[这篇文章](https://groups.google.com/forum/?fromgroups#!topic/python-tornado/6HW30emjops)，我们可以捏造饼干。我已经完成了这项工作，但根据 Ben Darnell 龙卷风维护者的说法，不建议这样做。Ben 建议使用[CookieLib](http://docs.python.org/library/cookielib.html#cookielib.CookieJar)模块，但这需要我们没有的响应的“信息”部分。

另[一篇博文建议使用](http://www.a13x.info/2011/08/testing-authenticated-handlers-in.html)[mox 模拟](http://code.google.com/p/pymox/)get_current_user() 调用。但是我无法让博客中的示例代码正常工作。

所以我的问题是：测试标记为已验证的处理程序的最佳方法是什么？有人可以指点我一个示例应用程序吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-07T18:14:55.510

最终让 Mocks 工作。不知道这是否是“最佳方式”，但将来可能对某人有用。此代码测试 2 个处理程序并模拟由以下`get_current_user()`生成的调用`@tornado.web.authenticated`：

```
# encoding: utf-8
import os, os.path, sys
import tornado.web
import tornado.testing
import mox

class BaseHandler(tornado.web.RequestHandler):
    def get_login_url(self):
        return u"/login"

    def get_current_user(self):
        user_json = self.get_secure_cookie("user")
        if user_json:
            return tornado.escape.json_decode(user_json)
        else:
            return None

class HelloHandler(BaseHandler):
    @tornado.web.authenticated
    def get(self):
        self.render("protected.html")

class Protected(tornado.web.RequestHandler):
    def get_current_user(self):
        # get an user from somewhere
        return "andy"

    @tornado.web.authenticated
    def get(self):
        self.render("protected.html")

class TestAuthenticatedHandlers(tornado.testing.AsyncHTTPTestCase):
    def get_app(self):
        self.mox = mox.Mox()
        app = tornado.web.Application([
            (r'/protected', Protected),
            (r'/hello', HelloHandler)
        ])
        return app

    def tearDown(self):
        self.mox.UnsetStubs()
        self.mox.ResetAll()

    def test_new_admin(self):
        self.mox.StubOutWithMock(Protected, 'get_current_user', use_mock_anything=True)
        Protected.get_current_user().AndReturn("test_user")
        self.mox.ReplayAll()
        resp = self.fetch('/protected')
        self.assertEqual(resp.code, 200)
        self.mox.VerifyAll()

    def test_hello_page(self):
        self.mox.StubOutWithMock(HelloHandler, 'get_current_user', use_mock_anything=True)
        HelloHandler.get_current_user().AndReturn("test_user")
        self.mox.ReplayAll()
        resp = self.fetch('/hello')
        self.assertEqual(resp.code, 200)
        self.assertIn( "Hello", resp.body )
        self.mox.VerifyAll() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T14:57:57.893

这个 Torando utils 库还允许您测试经过身份验证的处理程序：[tornado_utils/http_test_client.py](https://github.com/peterbe/tornado-utils)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-03-28T06:40:20.737

就我而言，它很简单：

```
BaseHandler.get_current_user = lambda x: {'username': 'user', 'email': 'user@ex.com'} 
```

# java - primefaces 组件不适用于自己的 css

> ID：10936982
> 
> 赞同：2
> 
> 时间：2012-06-07T17:41:11.270
> 
> 标签：java, css, jsf, primefaces

我在我的 java ee 应用程序中使用现成的模板（带有 css 和 j 查询）。除 primefaces 3.2 的 panelgrid 控件外，所有 primefaces 组件均已正确渲染。它以边框显示。我想要它没有边界。我已经从自定义现成模板的 css 中删除了所有表格样式。边界仍然存在。当我删除现成的模板时，panelgrid 完美呈现，没有任何边框。我如何删除边框，这个问题的原因是什么？

**编辑：** xhtml文件：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui">

<h:head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>AP administration panel - A massive administration panel</title>

</h:head>

<h:body>

    <div>
    <h:form>
        <p:panelGrid columns="2" style="border: none">
        <h:outputText value="scrip symbol"/>
        <p:inputText value=""/>
        <p:commandButton value="submit"/>
        </p:panelGrid>

    </h:form>

    </div>

</h:body>

</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-07T18:29:33.677

覆盖 PrimeFaces 默认样式时，您必须指定*至少*具有相同强度的 CSS 选择器或指定*更强*的选择器。CSS 选择器的强度（级联规则）在[W3 CSS 规范](http://www.w3.org/TR/CSS2/cascade.html)中指定，并在这篇文章中明确解释：[了解 CSS 中的样式优先级：特异性、继承和级联](http://www.vanseodesign.com/css/css-specificity-inheritance-cascaade/)。

基于 PrimeFaces 自己的 CSS，以下选择器应该做：

```
.ui-panelgrid tr, .ui-panelgrid td {
    border: none;
} 
```

只需将它们放在`.css`您包含`<h:outputStylesheet>`在开头的文件中，`<h:body>`以便*在*PrimeFaces 自己的样式之后包含它。

```
<h:body>
    <h:outputStylesheet name="layout.css" />
    ...
</h:body> 
```

### 也可以看看：

*   [如何从特定的 PrimeFaces p:panelGrid 中删除边框？](https://stackoverflow.com/questions/10421581/remove-border-from-panelgrid/10421651#10421651)
*   [如何使用自定义样式覆盖默认的 PrimeFaces CSS？](https://stackoverflow.com/questions/8768317/how-do-i-re-write-those-class-defined-in-primefaces-css)

* * *

**更新**：根据您的更新，您的 CSS 似乎根本没有加载。您应该已经通过验证浏览器内置 webdeveloper 工具集中的 HTTP 流量（在 Chrome/IE9/Firebug 中按 F12）并看到它返回了 HTTP 404 错误来注意到这一点。使用`<h:outputStylesheet>`时需要将 CSS 文件放在`/resources`webcontent 的文件夹中。所以你必须有一个`/resources/css/mycss.css`才能使用`<h:outputStylesheet name="css/mycss.css" />`。

### 也可以看看：

*   [如何在 Facelets 模板中引用 CSS / JS / 图片资源？](https://stackoverflow.com/questions/8367421/how-to-reference-resource-in-facelets-template/8368727#8368727)

# web - 选择使用 norco 1204 1u 机箱构建 Web 服务器的硬件

> ID：10936983
> 
> 赞同：0
> 
> 时间：2012-06-07T17:41:11.467
> 
> 标签：web, hardware

我正在运行几个管站点，并且我正在计划未来 3 年的新服务器。我已经有 norco 1204 机箱，带有 supermicro 600w psu。

计划使用： 1\. RAID6 中的 4X3TB SATA HD 用于视频流。2\. RAID1 中的 2x120GB SSD 用于系统、sql 和 php 文件。

（有些人可能认为它不适合，但确实如此）

我想使用带有 2 个 cpu、尽可能多的内存和支持 ssd 的 raid 卡的主板，但我不知道该选择哪种硬件。

我对主板、2 个 cpu 和 raid 卡的预算约为**1900 美元。** 请帮我解决一下这个。

谢谢，阿维。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:00:46.627

这是一个快速更新，半年前我完成了服务器的构建，这是最终的规范：

案子：

北方工业 RPC-1204 电源：

超微 PWS-563-1H 600w

### 电源不适合螺丝

母板：

美超微 MBD-X9DRL-IF-B

2X Xeon E5 2609 带 Dynatron R18 1u 冷却

DDR3 纠错码：

4X海力士DDR3 1333mhz PC3L-10600R

袭击：

LSI 3Ware 9750-8i + LSIiBBU07 电池

2 条 SFF-8087 突袭电缆

高清：

4 SSD INTEL 330 120GB (raid 10) - 操作系统、SQL、PHP 文件

4 日立 4TB (Raid 5) - 视频文件

和，

服务器构建的图片：

[http://img18.imageshack.us/img18/7788/serverx.jpg](http://img18.imageshack.us/img18/7788/serverx.jpg)

# disqus - 如果其他人使用我的 disqus 短名称会怎样？

> ID：10936984
> 
> 赞同：4
> 
> 时间：2012-06-07T17:41:16.147
> 
> 标签：disqus

如果其他人使用我的 disqus_shortname 会怎样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T18:09:23.783

如果其他人在他们的网站上使用您注册的短名称，他们的所有评论都将显示在您的审核面板中。

为避免这种情况，我们建议将您的域名添加到 Disqus 管理面板的 Trusted Domains 部分。这可以在“设置”>“常规”>“受信任的域”下找到。这将阻止其他用户在他们的网站上加载您的短名称。

# sql - Rails 3 Active Record Query Interface with join on ID 的问题

> ID：10936985
> 
> 赞同：1
> 
> 时间：2012-06-07T17:41:17.333
> 
> 标签：sql, ruby-on-rails-3, postgresql, activerecord, arel

我一直遇到 Rails 3 Active Record Query Interface 的问题。我有一个查找表 (lookups)、一个主表 (through_references) 和一个名为 through_tables 的直通/连接表。因此，这是我使用 has_many :through 设置的 HABTM 配置。

更新：这里需要特别注意的是，当我进行这些联接时，我一直在加入 ID，以提供记录过滤。这似乎不适用于 Active Record Query Interface。如果您不想看到我辛苦的血腥细节，您可以跳到下面查看我的解决方法。

我们还将有一些主要项目（through_references 表）应该能够有任何查找项的组合，并且能够方便地通过复选框单击相关的查找项。

我已经在[github](https://github.com/tayloredwebsites/rails3_left_joins)上发布了代码。github源代码上有很多解释。要查看结果，请转到查找索引页面。请注意，您将需要使用脚手架代码创建记录。

我还在[heroku](http://tws-left-joins.heroku.com/lookups)上启动并运行了代码，并提供了更多解释和示例。

```
class Lookup < ActiveRecord::Base
  has_many :fk_references
  has_many :through_tables
  has_many :through_references, :through => :through_tables
  attr_accessible :name, :value
end

class ThroughTable < ActiveRecord::Base
  belongs_to :through_reference
  belongs_to :lookup
  attr_accessible :description, :through_reference_id, :lookup_id
end

class ThroughReference < ActiveRecord::Base
  has_many :through_tables
  has_many :lookups, :through => :through_tables
  attr_accessible :description
end 
```

如果我们想要列出所有查找项目以及与之对应的主要项目，我们可以将“查找”表与主要项目（through_references）表连接起来。对应的SQL：

```
SELECT * FROM lookups
  LEFT OUTER JOIN through_tables ON (lookups.id = through_tables.lookup_id AND through_tables.through_reference_id = 1)
  LEFT OUTER JOIN through_references ON through_references.id = through_tables.through_reference_id
  ORDER BY lookups.id 
```

返回记录：

```
1;“Lookup Item 1”;“1”;“2012-06-06 17:14:40.819791”;“2012-06-06 17:14:40.819791”;1;1;1;“Main Item 1 has Lookup item 1”;“2012-06-06 17:17:31.355425”;“2012-06-06 17:17:31.355425”;1;“Main Item 1”;“2012-06-06 17:16:30.004375”;“2012-06-06 17:16:30.004375”

2;“Lookup Item 2”;“2”;“2012-06-06 17:14:59.584756”;“2012-06-06 17:14:59.584756”;;;;“”;“”;“”;;“”;“”;“”

3;“Lookup Item 3”;“3”;“2012-06-06 17:15:14.700239”;“2012-06-06 17:15:14.700239”;2;1;3;“Main Item 1 has Lookup item 3”;“2012-06-06 17:17:53.169715”;“2012-06-06 17:17:53.169715”;1;“Main Item 1”;“2012-06-06 17:16:30.004375”;“2012-06-06 17:16:30.004375” 
```

这是我所期望的。

=== 使用自定义左连接的活动记录查询接口

```
Lookup.joins(“LEFT OUTER JOIN through_tables ON (lookups.id = through_tables.lookup_id AND through_tables.through_reference_id = 1)” ).includes(:through_references).order(‘lookups.id’) 
```

从 Active Record 查询界面返回的内容（注意我在 Active Record 层次结构中向下导航）：

```
Lookup ID Lookup Name Lookup Value Through Table ID Through Table Description Main Item ID Main Item Description
1 Lookup Item 1 1 1 Main Item 1 has Lookup item 1 1 Main Item 1
1 Lookup Item 1 1 3 Main Item 2 has Lookup item 1 2 Main Item 2
2 Lookup Item 2 2 4 Main Item 2 has Lookup item 2 2 Main Item 2
3 Lookup Item 3 3 2 Main Item 1 has Lookup item 3 1 Main Item 1 
```

这不是我所期望的。

我们这里的内容与简单的左连接（没有 AND 子句）相同。这告诉我在 Active Record 查询界面中忽略了 AND 子句。

=== 使用 find_by_sql 方法的 Active Record 查询接口

```
Lookup.find_by_sql("SELECT * FROM lookups LEFT OUTER JOIN through_tables ON (through_tables.lookup_id = lookups.id AND through_tables.through_reference_id = 1) LEFT OUTER JOIN through_references ON through_references.id = through_tables.through_reference_id ORDER BY lookups.value, through_references.id" ) 
```

从 Active Record 查询界面返回的内容（注意我在 Active Record 层次结构中向下导航）：：

```
Lookup ID   Lookup Name     Lookup Value    Through Table ID    Through Table Description   Main Item ID    Main Item Description
1   Lookup Item 1   1   3   Main Item 2 has Lookup item 1   2   Main Item 2
1   Lookup Item 1   1   1   Main Item 1 has Lookup item 1   1   Main Item 1
    Lookup Item 2   2   No through_tables entry
1   Lookup Item 3   3   3   Main Item 2 has Lookup item 1   2   Main Item 2
1   Lookup Item 3   3   1   Main Item 1 has Lookup item 1   1   Main Item 1 
```

这里的结果很疯狂！

这是一个BUG，这是预期的效果，还是我错过了什么？

我希望有一种干净的方法可以做到这一点，而不必生成两个结果集，并通过代码将它们合并。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T17:44:41.353

我找到了解决方法。问题似乎是 Active Record 无法识别过滤 ID 的联接（LEFT OUTER JOIN xyz ON xyz.id = ID）。

我的解决方法包括创建一个存储过程或函数，将 ID 作为参数，在数据库中进行连接，并返回一个漂亮的平面记录集。

请参阅：[Heroku 演示页面（跳到底部）](http://tws-left-joins.herokuapp.com/lookups/)

请注意，我没有将此标记为解决方案，因为这是一种解决方法，与活动记录无关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-07T18:36:19.357

好吧，阅读 github 项目，我看到了这个：

> 我真正想做的是列出所有查找项，如果有匹配的主要项，将它们附加到返回的记录中，如果没有，我想要空值。这是我使用了 10 多年的技术。

我认为问题正是你想这样做，当让 Rails 急切加载处理它会更自然，所以你已经专注于在单个大规模连接中获取所有内容。

我会做的是这样的：

> Lookup.where( .. 在此处插入任何需要的条件 ...).includes(:through_tables)

然后 ActiveQuery 将在一个查询中获取所有查找，然后使用预加载来获取包含语句中命名的任何关联，每个关联一个查询。

请注意，我并不是说连接不好，只是说这是在 Rails 中更自然的方法。我喜欢使用 Preloader [http://apidock.com/rails/ActiveRecord/Associations/Preloader](http://apidock.com/rails/ActiveRecord/Associations/Preloader)将关于急切加载什么的决定与关于获取哪些数据的决定分开。我发现这对控制器很有帮助——让模型决定条件是什么，但让控制器决定它需要哪些对象来急切加载。

高温高压

# ruby-on-rails - 将星级评分添加到我的模型 rails3

> ID：10936988
> 
> 赞同：0
> 
> 时间：2012-06-07T17:41:30.587
> 
> 标签：ruby-on-rails

我有一个名为*教师*的模型，我想将评分添加到（5 星）。目前，我通过在教师资源中添加*评级*嵌套路由（资源评级）来实现这一点。然后我创建了一个模型：使用 (id, user_id, teacher_id, rating, ...) 进行评分。然后我创建了一个带有隐藏字段的表单，其中一个名为*stars*。当用户点击星号时，我使用 jQuery 发送 AJAX 请求来创建/更新该用户和教师的评分。

我的困惑是：我在页面上有两个单独的表格。我有一个用来写审稿人评论的表格。此表单有两个字段：标题、评论（和提交）。然后我有带有隐藏字段的评级表。这是做这样的事情的正确方法吗？在我看来，我真的应该将评级模型字段以某种方式嵌入到主评论表单中。

任何帮助高度赞赏。谢谢你。

[编辑]

我已经更新了我的应用程序，现在用户不再对**教师**对象进行评分，而是对教师的**评论****进行**评分

 **我的设置是这样的：

*路线*

```
resources :comments as :teacher_comments do  
 resource :rating  
end 
```

*楷模*

**评论**

```
has_one :rating  
attr_accessible :body, :rating_attributes  
accepts_nested_attributes_for :rating 
```

**评分**

```
belongs_to :comment  
attr_accessible :stars, :user_id, :teacher_id, :comment_id 
```

*看法*

```
<%= form_for( @comment, :remote => true, :url => teacher_comments_path ) do |tc| %>
  <%= tc.text_area :body, :maxlength => 450  %>
  <%= tc.fields_for :rating do |builder| %>
    <%= builder.text_field :stars  %>
  <% end %>
<% end %> 
```

我没有看到星星的 text_field。它只是没有出现。有什么我错过的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T18:55:18.563

实际上，将所有这些字段放在一个表单中通常会更好（有利于用户体验）。

**编辑：**

您可以使用该方法`accepts_nested_attributes_for`（正如您在下面的评论中建议的那样）。将以下内容放入您的父模型（老师）中；那么您应该能够创建一个表单来处理两个模型的输入：

在模型中：

```
class Comment < ActiveRecord::Base
  has_one :rating
  accepts_nested_attributes_for :rating
end 
```

在控制器中：

```
def new
  @comment = Comment.new
  @comment.rating = Rating.new
end 
```

Ryan Bates 在此处提供了有关这些概念使用的详细截屏视频：[嵌套模型表单](http://railscasts.com/episodes/196-nested-model-form-part-1)。我向想要了解更多细节的用户推荐它。

**原来的：**

这意味着您需要将表单指向可以处理这两种输入类型的操作。如果您愿意，您仍然可以使用`form_for`，但指定一个默认操作以外的操作（或更改您的teacher_controller.rb 文件中默认操作中的代码）：

```
<%= form_for @teacher, :url => {:action => 'create_and_rate'} do |f| %> 
```

由于 rating 是一个与teacher（我们刚刚创建的表单）不同的模型，因此您需要`_tag`对 rating 字段使用通用表单助手。

```
<%= text_field_tag :rating, :name %> # rating's fields should use the generic form helper
<%= f.text_field :name %> # teacher's fields can use the specific form helper 
```

由于您指向的是非 RESTful 操作，请将其添加到您的路由文件中。

```
resources :teacher do
  :collection do
    post 'create_and_rate' # this will match /teachers/create_and_rate to TeachersController#create_and_rate
  end
end 
```**

# javascript - 分层图像并单击以选择使用 Javascript

> ID：10936989
> 
> 赞同：2
> 
> 时间：2012-06-07T17:41:32.200
> 
> 标签：javascript, image

所以我正在为我所在大学城的兄弟会/姐妹会商店制作一个面料和背景画廊。如果你不知道我在说什么，[这是一封织物信](https://i.imgur.com/7zf2U.jpg)。您可以看到它有一个白色的轮廓（背景）和一个红色的内部（前景）。好吧，我想做它，这样您就可以更改前景和背景，只需单击它的相似图像即可。

这是我到目前为止所拥有的

```
<script type="text/javascript">// <![CDATA[
function changeImage(filename)
{
document.mainimage.src = filename;
}// ]]></script> 
```

每种面料都有这些：

```
<a href="javascript:changeImage('/wp-content/themes/collegiateconnectionbg/images/fabrics/foregrounds/37.jpg')">
<img src="/wp-content/themes/collegiateconnectionbg/images/fabrics/foregrounds/37.jpg"
alt="" width="100px" height="50px" /></a> 
```

我真的很喜欢它的工作原理，但它只对一层有好处。无论如何我可以在它下面添加一个图层，但仍然让它显示在页面顶部？我知道我必须为这两个选项使用 Photoshop 和透明度，这没问题，但我想确保在开始创建 600 多张图像之前我可以做到这一点。

我知道我可以使用 z-index 和 css，但是由于我使用的是 wordpress，所以我在[这里](https://stackoverflow.com/questions/6488390/can-you-layer-pictures-on-top-of-each-other-on-a-webpage)读到的一个示例不起作用或者我没有完全理解它，并且弄乱了我的整个页面。

另外[这里是](http://www.collegiateconnectionbg.com/customize-your-apparel/sewn-on-letters/)我的测试器网页，可以查看当前工作中的代码。（如果你点击海军和白色星星的图像，你可以看到一个非常粗糙的临时“A”）

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T16:45:17.010

我想我已经为你找到了解决方案。

现场演示：http: [//jsfiddle.net/hM6dj/4/](http://jsfiddle.net/hM6dj/4/)

或多或少，您只需要创建一些字母的图像并使其内部保持透明即可。

## 例子

![在此处输入图像描述](../Images/a9705bd4202e4f196d27114465258125.png)

您会注意到“A”周围的区域是白色的，而“A”线内的区域是透明的。

## 代码

然后你需要做的就是把这个图像放在另一个图像的前面。背景中的图像将通过顶部的透明图像渗出，从而形成带有图案的“A”。

*注意：我为前景字母使用了数据 url，因此我不必在任何地方托管图像。你可以在[这里](http://dataurl.net/#about)阅读。*

**HTML**

```
<div class='container'>
    <div class='foreground foreground-Black'>&nbsp;</div>
    <div class='background background-Cow'>&nbsp;</div>
</div>

<h2>Foreground Options</h2>
<input type='button' class='btnforeground' data-class='foreground-Black' value="Black" />
<input type='button' class='btnforeground' data-class='foreground-Red' value="Red" />
<input type='button' class='btnforeground' data-class='foreground-Green' value="Green" />

<h2>Background Options</h2>
<input type='button' class='btnbackground' data-class='background-Cow' value="Cow" />
<input type='button' class='btnbackground' data-class='background-Stars' value="Stars" />
<input type='button' class='btnbackground' data-class='background-Dots' value="Dots" />
​ 
```

**JS**

```
$('input[type="button"].btnforeground').click(function(){
    $('div.container > div.foreground').removeClass().addClass('foreground').addClass($(this).attr('data-class'));
});

$('input[type="button"].btnbackground').click(function(){
    $('div.container > div.background').removeClass().addClass('background').addClass($(this).attr('data-class'));
});
​ 
```

**CSS**

```
.container{
    position:relative; 
    width: 200px;
    height: 200px;    
}

.foreground, .background{
    width: 200px;
    height: 200px;
    background-repeat: no-repeat;
    position:absolute;
    z-index:100;
}

.background{
    background-repeat:repeat;       
    z-index:50;
}

.background-Cow{
background-image: 
url(http://www.collegiateconnectionbg.com/wp-content/themes/collegiateconnectionbg/images/fabrics/foregrounds/424.jpg);
}

.background-Stars{
background-image: 
url(http://www.collegiateconnectionbg.com/wp-content/themes/collegiateconnectionbg/images/fabrics/foregrounds/48.jpg);
}

.background-Dots{
background-image: 
url(http://www.collegiateconnectionbg.com/wp-content/themes/collegiateconnectionbg/images/fabrics/foregrounds/521.jpg);
}
/* Omitted due to StackOverflow character restrictions.
.foreground-Black{

    background-image: url();
}

.foreground-Green{
    background-image: url();
}

.foreground-Red{
    background-image: url();
}
*/ 
```

​</p>

# 编辑

使用[谷歌浏览器的开发者工具](https://developers.google.com/chrome-developer-tools/docs/overview)，看起来你有一些 HTML 与你的 JavaScript 混合在一起（注意段落标签`<p>`，`</p>`）。

![在此处输入图像描述](../Images/e91701ab1febdc94510f3d978eb23f4e.png)

此外，我会将 jQuery 事件包装在一个就绪函数中（JS Fiddle 会自动执行此操作，因此在代码示例中并不明显）。

## JS

```
$(function(){
    $('input[type="button"].btnforeground').click(function(){
        $('div.container > div.foreground').removeClass().addClass('foreground').addClass($(this).attr('data-class'));
    });

    $('input[type="button"].btnbackground').click(function(){
        $('div.container > div.background').removeClass().addClass('background').addClass($(this).attr('data-class'));
    });
});
​ 
```

## 编辑2

![在此处输入图像描述](../Images/d9dc97594a2f8217cc69752de52e21da.png)

一些东西。

1.  你的课：

    *   。前景
    *   。背景
    *   .foreground-黑色
    *   .foreground-牛
    *   ETC...

我的示例中几乎没有设置任何属性。您应该能够从我提供的[jsfiddle中逐字获取 css。](http://jsfiddle.net/hM6dj/4/)

2.  您已将容器命名为 class `.viewer`，但`.container`在您的 JavaScript 中引用。这些元素必须匹配，JavaScript 才能找到要更新的适当 html 元素。

# python - Os.walk 不能使用与正则表达式匹配的目录

> ID：10936994
> 
> 赞同：4
> 
> 时间：2012-06-07T17:41:55.077
> 
> 标签：python, match, os.walk

这是我使用的代码。为什么 os walk 不能处理？

```
import os, re

cwd = os.getcwd() 
directory= 'Box II'
dirpattern = re.compile(r'^.*?\\'+directory+'.*?', re.M)

for root, dirs, files in os.walk(os.path.abspath(cwd)):
    if dirpattern.search(root):
        match = dirpattern.search(root)
        match=match.group(0)

print match #OUTPUT = D:\dir1\dir2\dir3 (the directory i searched for)

for root, dirs, files in os.walk(os.path.abspath(match)):
    print files #OUTPUT = nothing 
```

为什么我不能将匹配的文件夹用于新的 os.walk 循环？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-07T20:19:29.960

我认为您想使用生成器来生成每个匹配项，以便您可以遍历与您的表达式匹配的内容。这是我经常使用的代码片段。

```
import os, fnmatch

#
# This wrapper for os.walk is based on Python Cookbook, 2.16.
# Added the exclude_dirs named parameter so that we can skip svn folders.
# Added the yield_files named parameter so that we can return only folders.
#

def walk_file_system (root, patterns='*', single_level=False, yield_folders=False, yield_files=True, exclude_dirs='.svn'):
    # Expand patterns from semicolon-separated string to list
    patterns = patterns.split (';')
    exclude_dirs = exclude_dirs.split (';')
    for path, subdirs, files in os.walk (root):
        for exclude_dir in exclude_dirs:
            for dir in subdirs:
                if fnmatch.fnmatch (dir, exclude_dir):
                    subdirs.remove(dir)
        fsnodes = []
        if yield_folders:
            fsnodes.extend(subdirs)
        if yield_files:
            fsnodes.extend(files)
        fsnodes.sort ( )
        for name in fsnodes:
            for pattern in patterns:
                if fnmatch.fnmatch (name, pattern):
                    yield os.path.join (path, name)
                    break
        if single_level:
            break 
```

你可以像这样使用它。

```
def walk_file_system_test():
    #patterns='*', single_level=False, yield_folders=False, yield_files=True, exclude_dirs='.svn'):
    print "Walk current directory with function defaults."
    for fsnode in walk_file_system(os.getcwd()):
        print fsnode

    #patterns='*', single_level=False, yield_folders=True, yield_files=True, exclude_dirs='.svn'):
    print "Walk current directory with yield_folders=True."
    for fsnode in walk_file_system(os.getcwd(), yield_folders=True):
        print fsnode

    #patterns='*', single_level=False, yield_folders=True, yield_files=False, exclude_dirs='.svn'):
    print "Walk current directory with yield_folders=True, yield_files=False."
    for fsnode in walk_file_system(os.getcwd(), yield_folders=True, yield_files=False):
        print fsnode

    #patterns='*', single_level=False, yield_folders=True, yield_files=False, exclude_dirs='.svn'):
    print "Walk current directory with yield_folders=True, yield_files=False, exclude_dirs='.svn;temp'."
    for fsnode in walk_file_system(os.getcwd(), yield_folders=True, yield_files=False, exclude_dirs='.svn;temp'):
        print fsnode 
```

希望这可以帮助。用 re 替换 fnmatch 应该相当简单。

# objective-c - 带有核心文本的 ios CCLabelTTF 彩色子类

> ID：10936996
> 
> 赞同：0
> 
> 时间：2012-06-07T17:41:58.487
> 
> 标签：objective-c, ios, cocos2d-iphone, core-text

祝大家有美好的一天。

目前我正在尝试实现支持 NSAttributedString 的 CCLabelTTF 子类以获取多色标签。而且我因缺乏 CoreText 和 CoreGraphics 知识而受到阻碍。

在阅读了一些指南后，我创建了 CCTexture2D 类别以使用 NSAttributedString 对象创建纹理。

这是我的绘图代码：

```
data = calloc(POTHigh, POTWide * 2);

colorSpace = CGColorSpaceCreateDeviceGray();
context = CGBitmapContextCreate(data, POTWide, POTHigh, 8, POTWide, colorSpace, kCGImageAlphaNone);
CGColorSpaceRelease(colorSpace);

if( ! context ) 
{
    free(data);
    [self release];
    return nil;
}

UIGraphicsPushContext(context);

CGContextTranslateCTM(context, 0.0f, POTHigh);
CGContextScaleCTM(context, 1.0f, -1.0f); 

// draw attributed string to context
CTFramesetterRef frameSetter = CTFramesetterCreateWithAttributedString((CFAttributedStringRef)string);

CGMutablePathRef path = CGPathCreateMutable();
CGPathAddRect(path, NULL, CGRectMake(0.f, 0.f, dimensions.width, dimensions.height));

CTFrameRef frame = CTFramesetterCreateFrame(frameSetter, CFRangeMake(0, 0), path, NULL);

CTFrameDraw(frame, context);

UIGraphicsPopContext();

CFRelease(frame);
CGPathRelease(path);
CFRelease(frameSetter); 
```

* * *

现在我遇到了一些麻烦：

* * *

第一个 - 我的纹理显示为垂直翻转。我想，这些线条

```
CGContextTranslateCTM(context, 0.0f, POTHigh);
CGContextScaleCTM(context, 1.0f, -1.0f); 
```

应该防止这种情况。

* * *

第二个，如果我创建 RGB 上下文，我在屏幕上看不到任何东西。我试图用这些线创建 RGB 上下文。

```
colorSpace = CGColorSpaceCreateDeviceRGB();
context = CGBitmapContextCreate(data, POTWide, POTHigh, 8, POTWide * 4, colorSpace, kCGImageAlphaPremultipliedFirst | kCGBitmapByteOrder32Big); 
```

我试图用谷歌搜索，但没有找到与我的问题相关的任何内容=（感谢任何帮助（链接或建议）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T20:40:49.203

几件事要尝试：

*   您的数据分配对于 RGB 来说不够大。尝试：`data = calloc(POTHigh, POTWide * 4);`对于 RGB 颜色空间。
*   `CTFrameDraw`绘制与 GL 坐标有关，因此您无需使用`CGContextScaleCTM(context, 1.0f, -1.0f);`
    *   该行被放入为 CCLabelTTF 创建的原始 CCTexture2D 中，因为它使用`drawInRect:`了与 UIKit 坐标相关的 NSString。
*   也许尝试其他 alpha 掩码标志...？查看 Apple关于 iOS[支持的像素格式](https://developer.apple.com/library/mac/#documentation/graphicsimaging/conceptual/drawingwithquartz2d/dq_context/dq_context.html#//apple_ref/doc/uid/TP30001066-CH203-BCIBHHBB)的文档，了解您的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:26:54.560

使用它来获得颜色纹理：

```
context = CGBitmapContextCreate(data, POTWide, POTHigh, 8, POTWide, colorSpace, kCGImageAlphaPremultipliedLast); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-08T07:26:05.690

您可能想看看 ActiveTextView-iOS ( [https://github.com/storify/ActiveTextView-iOS](https://github.com/storify/ActiveTextView-iOS) )。它可能有用。