# StackOverflow 问答 10607000-10607999

# android - 应该缓存 getSystemService(...) 结果吗？

> ID：10607000
> 
> 赞同：10
> 
> 时间：2012-05-15T18:50:36.927
> 
> 标签：android

的文档[`getSystemService`](http://developer.android.com/reference/android/content/Context.html#getSystemService%28java.lang.String%29)建议**不要在各种不同的上下文之间共享服务对象**。

对于单个上下文，是通过将服务对象分配给实例字段来缓存服务对象，`onCreate()`还是应该在使用时获取？什么是惯用用法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T18:55:44.273

由于持有系统服务对象的持续成本非常低，我建议在数据成员中持有它。如果/在需要时，您是否获得一个`onCreate()`或延迟初始化它取决于您。

请注意，*使用*系统服务对象可能会产生大量成本。持有一个`LocationManager`实例很便宜；使用 GPS（例如，通过`requestLocationUpdates()`）并不便宜。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-02T18:52:00.337

我正要问同样的问题。这是我的做法 - 在服务内部（继承自 Context）

```
private static volatile LocationManager lm; // not final - we need a context

private LocationManager lm() {
    LocationManager result = lm;
    if (result == null) {
        synchronized (LocationMonitor.class) { // my service
            result = lm;
            if (result == null)
                result = lm = (LocationManager)
                    getSystemService(Context.LOCATION_SERVICE);
        }
    }
    return result;
} 
```

# android - 如何在android中以编程方式打开扬声器

> ID：10607004
> 
> 赞同：1
> 
> 时间：2012-05-15T18:51:10.330
> 
> 标签：android

当收到来电并且耳机连接在音频插孔上时，如何以编程方式打开扬声器？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T18:53:38.580

```
audiomanager.setSpeakerphoneOn(true) 
```

请务必`MODIFY_AUDIO_SETTINGS`在清单中包含权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-04-21T12:56:24.153

```
// for android 10 and higher
Intent callIntent = new Intent(Intent.ACTION_CALL);
callIntent.putExtra(TelecomManager.EXTRA_START_CALL_WITH_SPEAKERPHONE, true);
callIntent.setData(Uri.parse("tel:" + phone)); 
```

# eclipse - 重新格式化很多类

> ID：10607007
> 
> 赞同：0
> 
> 时间：2012-05-15T18:51:16.927
> 
> 标签：eclipse, reformatting

在一个旧的 Java 项目中，我有很多重新格式化要做的事情。

我有超过 300 个由工厂创建的不同类，我想使用 Eclipse 插件或工具自动化更改。

我需要为 300 个类（如上面的 Foo 类）删除相同的参数，并每次都更改母类名称。

例子：

```
public Foo extends **OldClass** {

    public Foo(A a, **B b**){
        //..
    }

} 
```

至

```
public Foo extends newClass {

    public Foo(A a){
        //..
    }

} 
```

我还希望能够“批量查找和替换”很多声明。我的意思是，我想要一个带有替换列表（带有正则表达式模式）的工具，并且只需单击一下即可替换所有内容。

你知道我怎么能做到这一点吗？我在 Windows 7 系统上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:17:58.367

您可以使用 Eclipse 的搜索对话框 (Ctrl+H) 来执行此操作。在“搜索”按钮旁边有一个“替换”按钮。这可用于查找跨多个文件的每次出现（例如，指定每个匹配的文件名`*.java`），并在单个用户操作中替换它们。

![带有替换选项的 Eclipse 搜索对话框](../Images/5bc52e73b535230c465c740b7f674401.png)

一旦您配置了搜索条件（例如“extends OldClass”）并进行搜索，您将看到一个对话框以输入替换值（例如“extends NewClass”）。为该对话框按“确定”后，它将进行搜索和替换。

![替换对话框](../Images/bc7b5c50c3ea057c22108b7fc5fd6e6d.png)

这也允许在搜索和替换中使用正则表达式（我假设这将允许使用正则表达式组捕获，但我还没有测试过）。应该可以将相同的原则应用于您还想要删除的参数。

请注意，如果您只想修改同时出现`extends OldClass`AND`, B b)`并且它们可以独立出现的类，它会变得更加棘手。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:03:40.183

如果当前代码不太复杂，您可以使用 sed，例如，

```
find . -type f -iname '*.txt' -exec sed -i 's,this,that,g' {} + 
```

# ios - 切换画面时存储数据

> ID：10607008
> 
> 赞同：0
> 
> 时间：2012-05-15T18:51:18.657
> 
> 标签：ios, model-view-controller

我有一个简单的 iOS 程序，其中包含许多文本字段。我想要的是这些字段中的文本（用户提供输入）保持不变，即使在切换屏幕之后也是如此。例如，如果用户在我的文本字段中输入“hello”，然后转到另一个屏幕，那么如果他再次返回屏幕，我希望“hello”这个词仍然在文本字段中。

做这个的最好方式是什么？我是否应该创建一个模型，并且每次出现转场时，将字段中的文本存储到模型中？然后如果他们继续，重新加载文本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T18:54:59.723

如果您需要任何持久性，那么您应该将此信息存储在模型中，该模型通过视图控制器控制并与视图同步。文本字段应该通知视图控制器，视图控制器应该更新模型。同样，当视图控制器重新加载时，它应该从模型中更新视图。

这些东西可以通过键/值绑定自动完成。

我建议在 Google 中搜索“模型视图控制器设计模式 ios”和“键值绑定 ios”，以获得更好地解释这一点的信息。你会成为一个更好的 Objective-C 程序员，因为 Cocoa 是基于 MVC（模型视图控制器）范式的。

# sql-server - 在 SQL Server 中构建 ISO 日期的最佳方法

> ID：10607009
> 
> 赞同：2
> 
> 时间：2012-05-15T18:51:19.460
> 
> 标签：sql-server, stored-procedures, date-formatting

`yyyy-mm-dd`我需要在 SQL Server 上以格式构建日期。

最好的方法是什么？

谢谢。

编辑

我确实试过这个

```
DECLARE @IsoDate varchar(10)
SET @IsoDate = CONVERT(varchar(10), GETDATE(), 120) 
```

那会是一个好方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T18:54:00.780

替换`GetDate()`为您正在使用的列：

`SELECT CONVERT(VARCHAR(10), GETDATE(), 120) AS [YYYY-MM-DD]`

对于许多其他格式/示例，请参阅：[http ://www.sql-server-helper.com/tips/date-formats.aspx](http://www.sql-server-helper.com/tips/date-formats.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T18:56:11.240

`SELECT replace(convert(varchar, getdate(), 111), '/', '-')`

# ruby - 您如何处理 SimpleForm 中的单个表继承，以便单个助手处理所有模型？

> ID：10607016
> 
> 赞同：3
> 
> 时间：2012-05-15T18:52:22.850
> 
> 标签：ruby, ruby-on-rails-3.1, simple-form

我们有一个模型“EventSession”，它通过 STI 有几个子类型，包括“NetworkingEventSession”和“DiningEventSession”......在某些情况下，我们希望能够从一个控制器和一个视图处理所有这些，但简单的形式正在寻找在simple_form_for @session 中迭代并尝试使用我们目前尚未定义的networking_event_session_path 帮助器而不是常规的event_session_helper 路径时，该路径可以正常工作并且是我们想要的。

我可以定义新的路线来为每个子类型获取助手，所有这些都指向相同的路径，但这将是非常 unDRY，我们可能并不总是希望它们进入主事件会话路径......有什么方法可以覆盖 simple_form_for在这个特定的视图中明确告诉它使用什么模型/类？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T19:13:08.200

`:url=> networking_event_session_path`中指定`simple_form_for`。

像这样的东西：

```
<%= simple_form_form @session, :url => networking_event_session_path %> 
```

# excel - 在 Excel 中复制，同时选取多行将输入输入到复制的 Excel 公式中

> ID：10607019
> 
> 赞同：0
> 
> 时间：2012-05-15T18:52:26.713
> 
> 标签：excel, vba

我是一名 VBA 初学者，我希望对以下公式有所帮助，因为我不知道如何确保该公式适用于书中的所有行。如您所见，我已经开始复制实际代码，但是由于我必须为多达 100 行执行此操作，因此手动操作太费劲了。

谢谢

```
Sub Charts()
    ' Charts Macro
    ' Run charts
    Range("D7").Value = Range("D11")
    Range("E7:G7").Select
    Selection.Copy
    Range("E11").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
    Range("D7").Value = Range("D12")
    Range("E7:G7").Select
    Selection.Copy
    Range("E12").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("D7").Value = Range("D13")
    Range("E7:G7").Select
    Selection.Copy
    Range("E13").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("D7").Value = Range("D14")
    Range("E7:G7").Select
    Selection.Copy
    Range("E14").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:09:36.423

这是你正在尝试的吗？

```
Option Explicit

Sub Charts()
    Dim i As Long

    '~~> Change this to the relevant sheet
    With Sheets("Sheet1")
        For i = 11 To 14 '<~~ Change 14 to whatever row you want to go to
            .Range("D7").Value = .Range("D" & i).Value

            .Range("E7:G7").Copy
            .Range("E" & i).PasteSpecial Paste:=xlPasteValues, _
            Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        Next i
    End With
End Sub 
```

# python - 使用用户定义或 python 命令序列的 C++ 线程未在 gdb 异步模式下停止

> ID：10607021
> 
> 赞同：6
> 
> 时间：2012-05-15T18:52:57.417
> 
> 标签：python, asynchronous, gdb, pthreads, powerpc

我在嵌入式 powerpc 目标上使用 gdb 7.4.1 对使用 pthreads 的多线程 C++ 程序执行一些分析。我的最终目标是使用 python 编写 gdb 脚本以自动化一些常见的分析功能。问题是，当我单独运行命令与在 gdb 用户定义的命令（或通过 python 脚本调用相同的命令）中运行命令时，我发现行为存在一些差异。

编辑：我在主 gdb 邮件列表上发现[了这个对一个非常相似的问题的引用。](http://sourceware.org/ml/gdb/2009-01/msg00154.html)虽然我不完全遵循 Pedro 关于异步模式限制的回应，但我认为他的意思是在异步模式下，用户定义的命令序列的相对时间是不可信的。这是我凭经验发现的。

在这两种情况下，我执行以下启动步骤，加载我的程序，设置它的参数，并打开异步和不间断调试模式，然后在后台运行程序：

```
(gdb) file myprogram
(gdb) set args --interface=eth0 --try-count=0
(gdb) set target-async on
(gdb) set pagination off
(gdb) set non-stop on
(gdb) run & 
```

此时，如果我手动发出`interrupt`然后`info threads`命令，我会看到所有正在运行的线程的列表，除了一个停止的线程。然后我就可以`continue &`心满意足地重复一遍，它始终如一地工作。停止时，我可以检查该线程的堆栈帧，一切都很好。

但是，如果我将这些命令放入用户定义的 gdb 命令中：

```
(gdb) define foo
(gdb) interrupt
(gdb) info threads
(gdb) continue &
(gdb) end
(gdb) foo
Cannot execute this command while the selected thread is running. 
```

然后 foo 打印的线程列表表明没有线程被停止，因此`continue &`命令返回`Cannot execute this command while the selected thread is running.`。我认为这是异步 gdb 命令固有的问题，所以我在中断命令之后插入了一个荒谬的长时间等待并得到了相同的行为：

```
(gdb) define foo
(gdb) interrupt
(gdb) shell sleep 5
(gdb) info threads
(gdb) continue &
(gdb) end
(gdb) foo
Cannot execute this command while the selected thread is running. 
```

不管有没有 sleep 命令，我总是可以发出手动 CLI 命令，并且线程会正确停止。

同样，我得到了相同的结果，采购了一个 python 脚本来进行线程细读：

```
import gdb, time

gdb.execute("file myprogram")
gdb.execute("set args --interface=eth0 --try-count=0")
gdb.execute("set target-async on")
gdb.execute("set pagination off") 
gdb.execute("set non-stop on")
gdb.execute("run &")
time.sleep(5)
gdb.execute("interrupt")

# here, I inspect threads via gdb module interface
# in practice, they're always all running bc the program neven got interrupted
for thread in gdb.selected_inferior().threads():
    print thread.is_running(),

gdb.execute("continue &") 
```

即使我`from_tty=True`在`gdb.execute`调用中指定，我也会得到相同的结果。此外，如果我使用`continue -a`它会抑制错误字符串但无济于事，否则中断调用仍然不起作用。

所以……这是：

*   驾驶舱错误？考虑到我要完成的工作，我是否有遗漏或做错了什么？这应该可行，还是我必须像这样使用 GDB/MI 来异步“驱动”gdb？
*   时间问题？在这种情况下，也许调用`shell sleep`(or `python time.sleep()`) 不会像我认为的那样做。
*   我对 pthread 的使用有问题吗？我假设由于使用手动 gdb 命令始终可以正常工作，因此情况并非如此。
*   一个gdb问题？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-24T18:34:04.437

I think this is most likely a gdb problem. I don't know enough about the inferior-control stuff to be more confident. I do know that inferior control generally has not been wired up to Python...

One thing worth trying is having a separate Python thread that does the wait, then sends an "interrupt" command to the main gdb thread using gdb.post_event.

Then, instead of synchronously examining the threads or doing work after the "interrupt", instead use the gdb.events.stop event source to trigger your actions.

Please file bugs liberally about holes in the Python API.

# excel - 在没有 VBA 的两个命名范围之间创建动态范围？

> ID：10607025
> 
> 赞同：2
> 
> 时间：2012-05-15T18:53:12.933
> 
> 标签：excel

我正在尝试使用 Excel 函数创建一个动态范围，该函数将对两个命名范围之间的值求和。

这类似于在 2010 年创建表，您可以将所有添加到表中。

我的问题是我不想创建表。我只想指定一个起点和终点并从那里创建范围。

我尝试用冒号分隔两个命名范围，即 rng1:rng2，但这与使用两个绝对单元格引用（如 A1:C16）的工作方式不同。相反，它单独选择两个范围，而不是由两者限定的范围。

有没有办法做到这一点？

目前，我使用 OFFSET 和 COUNTA 函数使用动态范围，但这些仅在您对整个行/列或特定范围感兴趣时才有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T20:44:17.290

与 Addikt 的最后一条评论相反，将 2 个定义的范围相加并不仅仅将它们的左上角值相加。

答案在这里：

```
Name rng_1 and refer it to H13:H16
place the number 1 in all cells in that range

Name rng_2 and refer it to I13:I14
place the number 2 in all cells in that range

In cell K13 type = sum(rng_1,rng_2). Answer will be 8, not 3. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:15:40.483

基于您的问题缺乏明确性，完全是疯狂的猜测，但是假设您在 A 列中有一系列数字。您可以“动态地”对第 1 行中的数字求和`n`，如下所示：

```
=SUM(A1:INDIRECT(B1)) 
```

其中单元格`B1`包含类似“A10”的值（这将汇总单元格 A1:A10）。

更改名为 in 的单元格`b1`，您的求和公式将相应更新。您还可以在 中指定完整范围`B1`，即如果单元格`B1`包含“A1:A10”：

```
=SUM(INDIRECT(B1)) 
```

# html - 在 HTML 中创建项目符号列表

> ID：10607026
> 
> 赞同：1
> 
> 时间：2012-05-15T18:53:13.213
> 
> 标签：html

我只是想在 ASP.NET aspx 页面中添加一个项目符号列表。

我在 aspx 页面上有如下代码...如您所见，ul 标签上没有使用类...

```
 <ul type="circle">
                        <li>Upon receipt and inspection of the returned merchandise, credit will be issued based
                            on purchase price. Merchandise not originally purchased from xyz will be
                            credited at the current lowest market price.</li>
                        <li>All returns are subject to a handling fee.</li>
                        <li>It is recommended to allow 14 business days for a credit to be processed. Please
                            note, merchandise returned at the end of the month may not be processed in time
                            to be reflected on the current month’s statement.</li>
                        <li>Merchandise that is deemed as unacceptable per manufacturer’s policy will not be
                            credited and will be returned at the customer’s expense.</li>
                    </ul> 
```

下面是输出。它没有提出任何要点。我究竟做错了什么？

```
aaaaaaaa
bbbbbbbb
cccccccc
dddddddd 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T18:54:31.747

听起来您正在使用某种 CSS 重置。将其注释掉并重试，它应该可以工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:58:39.270

看起来你可能需要检查你的 CSS

检查说的 css

```
 ul, li { display:inline; AND list-style:none; OR float:left; } 
```

无序“项目符号”列表的标记是（如果这是您所要求的）..

```
 <ul>
  <li>aaaaaaa</li>
  <li>bbbbbbbbb</li>
  <li>ccccc</li>
  <li>dddddd</li>
  <li>eeeeee</li>
</ul> 
```

# pdf - mupdf 和 freetype：为什么字体模糊？

> ID：10607029
> 
> 赞同：0
> 
> 时间：2012-05-15T18:53:26.587
> 
> 标签：pdf, fonts, qt4, mupdf, freetype2

如果字体模糊（即使使用抗锯齿），我想知道是 mupdf 还是 freetype2 的错。这是在 Windows 上使用 pdfdraw 实用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T21:27:37.613

正如我在另一个答案中提到的，字形描述由线条和曲线组成。问题是这些线条和曲线无法确保以小尺寸呈现高保真字形，因为没有太多空间来表示字形。在这种情况下，一种称为*字体提示*的技术用于呈现可读的字形。TrueType 字体在字体文件中包含此类提示信息。提示基本上指定了字体轮廓如何适合像素网格，您可以[在此处](http://en.wikipedia.org/wiki/Font_hinting)阅读更多信息。另一种改进字体渲染的方法是在 LCD 显示器上使用*亚像素渲染。*

您在渲染中注意到的不同之处在于 Adob​​e Reader 使用提示信息（和其他专有渲染方法），而 mupdf 仅渲染线条和曲线。mupdf 使用 FreeType 进行字体渲染，而 FreeType 默认情况下可能不使用提示（我可能在这里弄错了）。据我所知，FreeType 支持字体提示，但也许你需要在构建它时指定它，我不确定。mupdf 也有可能在没有提示支持的情况下初始化 FreeType 库，但我不知道这些细节。

# java - 蚂蚁不重建新的源？

> ID：10607038
> 
> 赞同：1
> 
> 时间：2012-05-15T18:54:12.747
> 
> 标签：java, ant

我试图找出可能导致 Ant 无法重建具有更新源的依赖项的原因。

我有几个包，每个包在 Ant 中都有自己的构建目标。其中一个目标 mds 依赖于另一个目标 robotsim。如果我没有在依赖项列表中添加它，我会出现疯狂的行为，它只会在有时构建，我想了解何时以及为什么。

```
$ ant clean mds
...
BUILD SUCCESSFUL 
```

此时我在robotsim包中打开一个java文件并删除一个分号。

```
$ ls -l src/com/robotsim/model/Robot.java 
-rw-rw-r-- 1 matt matt 6.3K 2012-05-15 14:28 src/com/robotsim/model/Robot.java
$ ls -l build/com/robotsim/model/Robot.class 
-rw-rw-r-- 1 matt matt 6.6K 2012-05-15 14:13 build/com/robotsim/model/Robot.class
$ ant mds
...
BUILD SUCCESSFUL
$ ant clean mds
...
[javac] Robot.java:110: ';' expected
...
BUILD FAILED 
```

那么问题来了，为什么第二次构建成功了？

编辑以包含 build.xml 的相关部分：

```
<target name='init'>
    <mkdir dir='${build.dir}'/>
    <mkdir dir='${dist.dir}'/>
</target>
...
<target name='customTasks'>
    <javac srcdir='${customTasks.src.dir}' destdir='${ant.library.dir}' classpathref='customTasks.classpath' failonerror='false'/>
    <taskdef name='protoc' classname='com.hrilab.Protoc' classpath="${ant.library.dir}"/>
</target>
...
<target name='algorithms' depends='init' extensionOf='compile' description='Builds a few generic algorithms'>
    <build-java package.dir='com/algorithms'/>
</target>
...
<target name='engine3d' depends='init' extensionOf='compile' description='Builds the 3D engine'>
    <build-java package.dir='com/engine3D'/>
</target>
...
<target name='humanoid' depends='init,utilities' extensionOf='compile' description='Builds the humanoid servers.'>
    <build-java package.dir='com/humanoid'/>
</target>
...
<target name='mds' depends='init,algorithms,engine3d,humanoid' extensionOf='compile' description='Builds the servers for the Xitome MDS.'>
    <build-java package.dir='com/mds'/>
</target>
...
<target name='robotsim' depends='init,customTasks' extensionOf='compile' description='Builds the 3D robot simulator'>
    <protoc minversion='2.4.0' srcfile='com/robotsim/calibration/leng/calibration_server_config.proto' destdir='${src.dir}'/>
    <protoc minversion='2.4.0' srcfile='com/robotsim/calibration/leng/extrinsic_parameters_collection.proto' destdir='${src.dir}'/>
    <build-java package.dir='com/robotsim'/>
</target>
...
<target name='utilities' depends='init' extensionOf='compile' description='Builds some common utilities'>
    <build-java package.dir='utilities'/>
</target>
...
<macrodef name='build-java'>
    <attribute name='classpath' default='base.classpath'/>
    <attribute name='package.dir' default='NOT SET'/>
    <attribute name='package.mask' default='**'/> <!-- HACK: please do not use this attribute, it's only here to hack around the way we have our source laid out -->
    <sequential>
        <javac srcdir='${src.dir}' destdir='${build.dir}' includes='@{package.dir}/@{package.mask}' debug='${debug.enabled}' debuglevel='${debug.level}'>
            <classpath refid='@{classpath}'/>
        </javac>
    </sequential>
</macrodef> 
```

# javascript - 我的纯 js javascript 游戏听起来不错？

> ID：10607040
> 
> 赞同：5
> 
> 时间：2012-05-15T18:54:12.887
> 
> 标签：javascript, audio

是否可以在我的 javascript 游戏中播放声音而不使用 flash 或 HTML 解决方法之类的东西？

当我搜索谷歌时，它给了我各种插件或使用 flash 的方法，但我想用纯 js 来做，同时能够并行播放许多声音。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T18:56:53.470

HTML5`<audio>`元素有[相当不错的支持](http://caniuse.com/#search=audio)，还有一个音频 API（它允许高级音频操作）有些落后。

甚至还有[在 JS 游戏中使用它的教程](http://www.html5rocks.com/en/tutorials/webaudio/games/)。

# php - 插入名称中包含破折号的表中

> ID：10607041
> 
> 赞同：7
> 
> 时间：2012-05-15T18:54:18.720
> 
> 标签：php, mysql, pdo, mysql-error-1064

我有一个名为的表`concept-relation`，我想插入其中。

```
for ($i = 0; $i < count($sources); $i++) {
    $sourceID = $this->getConcpeptID($sources[$i]);
    $desID = $this->getConcpeptID($distinations[$i]);
    $query2 = "INSERT INTO concept-relation (relationID, firstConceptID, secondConceptID) VALUES (:rID, :sID, :dID)";
    $sth = $this->db->prepare($query2);
    $sth->execute(array(
        ':rID' => $relationID,
        ':sID' => $sourceID,
        'dID' => $desID
    ));
} 
```

我收到此语法错误消息

> 致命错误：未捕获异常 'PDOException' 并带有消息 'SQLSTATE[42000]：语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册以获取正确的语法，以便在 C:\xampp\htdocs\Mar7ba\models\ontology_model.php 中的 '-relation (relationID, firstConceptID, secondConceptID) VALUES (' at line 1' 附近使用： 86 堆栈跟踪：#0 C:\xampp\htdocs\Mar7ba\models\ontology_model.php(86): PDOStatement->execute(Array) #1 C:\xampp\htdocs\Mar7ba\controlers\Ontology.php(69) : Ontology_Model->addRelation('jklljkljk', Array, Array) #2 C:\xampp\htdocs\Mar7ba\libs\Bookstrap.php(42): Ontology->relationAdd() #3 C:\xampp\htdocs\Mar7ba \index.php(13): Bootstrap->__construct() #4 {main} 在第 86 行的 C:\xampp\htdocs\Mar7ba\models\ontology_model.php 中抛出

我试图直接从 MySQL 插入并得到错误似乎是同样的错误

> #1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 '"-".relation (relationID, firstConceptID, secondConceptID) VALU' 附近使用正确的语法

问题是因为表名有破折号，看看MySQL是如何理解查询的

```
INSERT INTO concept - relation(
    relationID,
    firstConceptID,
    secondConceptID
)
VALUES ( 3, 3, 3 ) 
```

它只是理解概念并单独制作“-关系”，

**任何帮助表示赞赏，但不会更改我的表名:)**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-05-15T18:59:51.530

用反引号括起来的标识符使保留字/字符成为 mysql 中的有效标识符。

所以你应该使用

```
 `concept-relation` 
```

反引号 ( ```) 是此键盘左上角的键。

![在此处输入图像描述](../Images/70f00b3e9b48f3918446156314510316.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-15T18:56:16.960

```
$query2 = "INSERT INTO `concept-relation` (relationID, firstConceptID, secondConceptID)
                VALUES (:rID, :sID, :dID)"; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-05-15T18:56:38.177

尝试：

```
"INSERT INTO `concept-relation` (relationID, firstConceptID, secondConceptID) VALUES (:rID, :sID, :dID)"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T18:55:39.057

尝试这个

```
$query2 = "INSERT INTO concept-relation (relationID, firstConceptID, secondConceptID)
                VALUES (:rID, :sID, :dID)"; 
```

# android - 教程 - Android Map Pin 放置动画 - 正确工作

> ID：10607042
> 
> 赞同：11
> 
> 时间：2012-05-15T18:54:19.407
> 
> 标签：android, overlay, android-mapview, android-animation

我需要我的 android 应用程序的地图图钉放置动画。做了很多研究，我发现没有任何用处。所以我创建了一个小技巧。只需发布代码，以便其他人可以使用它并相应地修改它。

由于 android 中的翻译动画仅适用于视图，而叠加层不是视图，因此我创建了一个小技巧，通过翻译动画将视图放置在同一地理位置，然后删除视图以显示叠加层。通过这种方式，用户认为地图叠加层正在从顶部下降，即使它们不是。

这是代码：

```
private void translateAnimation(MapView mapView,ArrayList<GeoPoint> geoPointsList,Context context) {
    Point dropPoint = new Point();
    Projection projection = mapView.getProjection(); /*
                                                      * Getting the map projections to calculate
                                                      * screen points and geopoints
                                                      */
    GeoPoint mGeoPoint = projection.fromPixels(0, 0);

    /* Map View screen parameters */
    MapView.LayoutParams screenParameters = new MapView.LayoutParams(
            MapView.LayoutParams.WRAP_CONTENT, MapView.LayoutParams.WRAP_CONTENT, mGeoPoint, 0,
            0, MapView.LayoutParams.LEFT | MapView.LayoutParams.BOTTOM);

    for (GeoPoint geoPoint : geoPointsList) {
        projection.toPixels(geoPoint, dropPoint); /*
                                                   * As Overlays are not a subclass of views so
                                                   * view animation cannot work
                                                   */
        ImageView imageView = new ImageView(context); /*
                                                        * Therefore creating an imageview for
                                                        * every overlay point apply the
                                                        * transition animation and then removing
                                                        * the imageview
                                                        */
        imageView.setImageResource(R.drawable.map_pin_focused);

        /* Translation animation to show Falling Pins effect */

        Bitmap markerImage = BitmapFactory.decodeResource(context.getResources(),
                R.drawable.map_pin_focused);

        TranslateAnimation drop = new TranslateAnimation(dropPoint.x
                - (markerImage.getWidth() / 2), dropPoint.x - (markerImage.getWidth() / 2), 0,
                dropPoint.y + (markerImage.getHeight() / 2));
        drop.setDuration(600);
        drop.setFillAfter(true);
        drop.setStartOffset(100);
        imageView.startAnimation(drop);
        mapView.addView(imageView, screenParameters);
        // imageView.setAnimation(drop);
    }
} 
```

当您需要显示此动画时 - 运行一个新线程，用户可以在其中看到图像视图的下降，然后在动画完成后将其删除。

```
private void startTranslationAnimation() {
    translationAnimation(mapView, geoPointsList, this);
    new Thread(new Runnable() {
        public void run() {
            try {
                Thread.sleep(1000); /*
                                     * Making thread sleep for 1 sec so that animation can be
                                     * seen before updating the overlays
                                     */
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            mapView.post(new Runnable() {
                public void run() {
                    mapView.removeAllViews(); /* Removing all the image Views */
                    mapOverlays.add(itemOverlay); /*
                                                   * Adding the overlay items on map overlay
                                                   * list
                                                   */
                    mapView.invalidate(); /* Refreshing the map overlays */
                }
            });

        }
    }).start();
} 
```

请随时对其进行修改，并提出任何更改建议。当然，如果你有大量的叠加层，它也会创建大量的图像视图，从而导致内存问题，但它适用于少量叠加层。我将它用于至少 100 个叠加层，效果很好。

# javascript - 更改图像样式有时会失败（JavaScript）

> ID：10607047
> 
> 赞同：1
> 
> 时间：2012-05-15T18:54:34.560
> 
> 标签：javascript, css, greasemonkey

使用以下代码，我得到图像的大小：

```
function getFileSize(img) {
    GM_xmlhttpRequest({
        url: img.src,
        method: "HEAD",
        onload: function(response) {
            response.responseHeaders.match(/Content-Length: (\d+)/);
            size = RegExp.$1;
            if (size > maxS)
                // If size > max. allowed size
                markImage(img);
            else if (img.height > maxH)
                    // If img.height > max. allowed height
                markImage(img);
        }
    }); 
} 
```

如您所见，上面的函数调用*了 markImage*：

```
function markImage(img) {
    img.style.border = "7px solid #990099";
    showDialog(); // This function shows a dialog
} 
```

所以我想改变那些符合特定条件的图像的风格。

如果图像与 getFileSize 上的条件匹配，则正确显示在 markImage 上调用的对话框*。*然而，风格并不总是改变。

据我所知，脚本在 时完美运行`size > maxS`，但在 时并不总是有效`img.height > maxH`。实际上，如果`img.height > maxH`，如果我刷新网站，脚本就可以工作，但在第一次尝试时它不会。

一方面，考虑到*markImage*被称为*onload*的事实，这似乎不是与同步相关的问题。此外，对话框在必须显示时正确显示。另一方面，我也尝试使用*setAttribute*更改样式，但没有任何区别。所以我不知道为什么这个“随机”失败。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T20:02:05.870

好的，如果`showDialog();`始终正确触发，则排除了图像加载和渲染延迟。

其他一些可能导致故障的事情：

1.  其他一些 CSS 正在覆盖`markImage()`. 将代码更改为：

    ```
    img.style.setProperty ("border", "7px solid #990099", "important"); 
    ```

2.  页面有修改或重新加载目标图像的 JS... 在此类 JS 之后酌情拦截、阻止或清理。

如果`showDialog();`并不**总是**正确开火，那是另一回事，但您表示情况并非如此。

如果发生了其他事情，如果没有看到目标页面，也许还有整个 GM 脚本，我们就无法判断。链接到那些。

# java - 具有相似元素和前缀名称的 JAXB

> ID：10607048
> 
> 赞同：0
> 
> 时间：2012-05-15T18:54:35.507
> 
> 标签：java, xml, jaxb

今天，我尝试使用 JAXB 将以下结构映射到 Java 代码。问题是，给定的 XML 结构有以下缺点：

对象详细信息 data1, data2, ... 对于不同的对象都是相同的，因此创建一个超类会非常好。不幸的是，这些元素的前缀是狗、猫、...

有没有一种优雅的方法可以用 JAXB 注释映射它，而不需要重复代码？

```
<objects>
  <dog>
    <dog_data1>...</data1>
    <dog_data2>...</data2>
    <dog_data3>...</data3>
  </dog>
  <cat>
    <cat_data1>...</data1>
    <cat_data2>...</data2>
    <cat_data3>...</data3>
  </cat>
</objects> 
```

# android - Android：在活动中移动

> ID：10607049
> 
> 赞同：1
> 
> 时间：2012-05-15T18:54:39.490
> 
> 标签：android, android-activity, sms

我想知道通过活动移动的最佳方式是什么。如果我从子活动中调用意图返回父活动会怎样？活动会在记忆中累积吗？

准确地说，在儿童活动中，我有一个用于发送短信的按钮。我想在发送消息（或按下按钮）后立即转到上一个活动，因为我想阻止用户再次按下发送按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T18:56:40.517

如果你想去上一个活动，只需调用`finish()`。这将返回到堆栈上的最后一个活动。这通常是调用此子活动的活动，除非在意图中使用了特殊标志。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:58:43.867

Android 活动应存储在内存堆栈中。在子活动中单击按钮后，如果调用函数finish()，它应该返回到父活动。

# php - 加入或添加列？

> ID：10607054
> 
> 赞同：0
> 
> 时间：2012-05-15T18:55:08.657
> 
> 标签：php, mysql, sql

我有 2 个表**用户**和**评论**。

就性能而言，我应该使用联接（带有用户 ID）从**用户**表中获取用户名，还是应该在**评论**中添加一个用户名列，所以我不需要仅加入 1 个数据（用户名），但我会需要为每个评论（用户名）添加一个数据。

如果表中有很多评论，加入会慢吗？

我应该做哪一个？在评论中加入或添加列用户名。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T18:57:00.330

加入可能是最好的，因此您不会将数据存储在两个地方。如果更改用户名怎么办？它不会更改评论的用户名。此外，连接两个表也不是很耗时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T18:58:46.333

这取决于用户和评论的数量。拥有您所要求的[非规范化](http://en.wikipedia.org/wiki/Denormalization)数据库可能会更快，但是您需要注意自己更新两个表中的用户名。如果您采用加入方式，请不要忘记在评论表中添加用户 ID 的索引。所以我相信正确的答案是加入，如果需要，以后再去规范化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:34:56.580

就个人而言，我宁愿使用两个简单的单独查询。我不太喜欢加入。根据定义，连接只会产生重复的数据。您可能想检查[http://www.notorm.com/](http://www.notorm.com/)这是一个简单的 php db 访问层，采用无连接方式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T19:00:09.907

如果您使用的是 InnoDB，则可以添加列并添加外键限制。这将使您能够提高效率并减少更新索引的担忧。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-15T19:11:19.137

将用户名存储在评论表中的一个原因是，如果您想在创建评论时知道用户名。如果随后更改了用户名，您仍将拥有评论时的名称。

不过，一般来说，您想使用联接。您希望将表上的主键定义为自动递增（标识）整数值。

如果您担心获取单个用户的所有评论的性能，那么您应该在用户 id 字段的评论表上建立索引。

# jquery - 为什么我的 jQuery 验证需要 2 次点击才能调用？

> ID：10607057
> 
> 赞同：1
> 
> 时间：2012-05-15T18:55:20.423
> 
> 标签：jquery, asp.net, html, ajax, jquery-ui

我有一个评论表单，其中包含 2 个字段：作者和消息。当我单击提交按钮时，验证不会触发。如果我再次单击提交按钮，则验证有效。知道为什么吗？

```
//User Clicked Submit Button
$('#CommentsForm').live('submit', function (e) {
    e.preventDefault(); //Prevent Browser from getting new url

    //Validate the comments form
    $('#CommentsForm').validate({
        rules: {
            Author: "required",
            Message: "required"
        },
        messages: {
            Author: "Author is required.",
            Message: "Comment is required."
        },
        errorContainer: "#CommentsErrorBox",
        errorLabelContainer: "#CommentsErrorBox ul",
        wrapper: "li",

        submitHandler: function() {
            //Create JSON object
            var jsonCommentData = {
                ProductID: $('#HiddenProductID').val(),
                Author: $('#Author').val(),
                Message: $('#Message').val()
            };

            //Add the comment.
            $.ajax({
                url: '/Home/_CommentsAdd',
                type: 'POST',
                data: JSON.stringify(jsonCommentData),
                dataType: 'html',
                contentType: 'application/json',

                //The request was a success. Repopulate the div with new result set.
                success: function (data) {
                    $('#AjaxComments').html(data);
                    $('abbr.timeago').timeago(); //update the timestamp with timeago

                    //Change colors of message.                
                    if ($('#CommentStatus').html() == "Your Comment Has Been Added!") {
                        $('#CommentStatus').css('color', 'GREEN');
                    }
                },
                error: function (data) {
                    alert('Fail');
                }
            });
        }
    }); 
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T18:57:30.657

因为您第一次单击`#CommentsForm`设置 jQuery 验证：

```
$('#CommentsForm').validate({ ... }); 
```

因此，任何后续点击都会被验证。

使固定：

```
 //setup validation
var form = $('#CommentsForm');

form.validate({ /* ... setup code .... */ }); 

form.live('submit', function (e) {
    e.preventDefault(); //Prevent Browser from getting new url

    $(this).validate();

}); 
```

# php - 试图从大学目录中提取课程列表

> ID：10607060
> 
> 赞同：0
> 
> 时间：2012-05-15T18:55:25.163
> 
> 标签：php, html, web, extract

我正在编写一个程序，允许人们为下一个季度制定课程表。为此，我需要提取下个季度可用的所有类。我的学校设置课程目录的方式使得提取信息有点困难，但如果你能够帮助我自动化一些命令，我​​认为这会很容易。

这是大学目录： http: [//my.sa.ucsb.edu/public/curriculum/coursesearch.aspx](http://my.sa.ucsb.edu/public/curriculum/coursesearch.aspx) 您将看到您需要： - 加载页面 - 从下拉列表中选择学科领域 - 从下拉列表中选择季度- 从下拉菜单中选择班级级别 - 触发搜索按钮 - 对所有主题区域重复从那里，我已经编写了我的代码，以便我将页面保存为 $SUBJECTAREA.aspx 我有一些脚本可以从中提取数据. 我希望能够在我的服务器上触发这个脚本，这样我就可以随时将我的课程列表直接更新到服务器上。

我真正的问题是我应该如何解决这个问题？我看过 SimpleTest，这是一个具有浏览器功能的 php 测试解决方案。虽然，由于我一直在玩它，但我不确定这是我想要的解决方案。

我认为 jQuery 是我在网上找到的另一种选择，可以做到这一点，但我知道的不够多，无法确定。

基本上我只是想知道我应该如何去做这个任务，也许还有一个在线资源可以让我开始朝那个方向发展。一旦我指向某个方向，我就有能力弄​​清楚它。

谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:29:11.077

> 您将看到您需要： - 加载页面 - 从下拉菜单中选择主题区域 - 从下拉菜单中选择季度 - 从下拉菜单中选择班级级别 - 触发搜索按钮

IE。POST 请求

> 我有一些脚本可以从中提取数据。

然后，您需要的只是主题、季度和级别的列表，您可以从同一页面获得类似的信息。

你需要一个 http 库——curl、http 组件等等——和一个循环。

# regex - perl/sed 替换中的正则表达式不匹配空格/字符

> ID：10607061
> 
> 赞同：1
> 
> 时间：2012-05-15T18:55:27.800
> 
> 标签：regex, perl

鉴于[这个](http://static.arounds.org/file.html)文件，我正在尝试做一个超级原始`sed`或`perl`替换页脚。

通常我使用 DOM 来解析 HTML 文件，但到目前为止，由于我使用 sed/perl 处理的原始 HTML 文件（时间很重要），我没有遇到任何问题。

我需要的只是替换`<div id="footer">`包含空格的元素，一个包含另一个元素的元素，并`</div>`用`<?php include 'footer.php';?>`.

出于某种原因，我什至无法让这个模式匹配，直到`<div id="stupid">`. 我知道有空格字符，所以我使用了`\s*`：

```
perl -pe 's|<div id="footer">.*\s*.*\s*|<?php include INC_PATH . 'includes/footer.php'; ?>|' file.html | less 
```

但这仅与第一行匹配。替换看起来像这样：

```
<?php include INC_PATH . includes/footer.php; ?> 
                   <div id="stupid"><img src="file.gif" width="206" height="252"></div>

               </div> 
```

我是否忘记了一些简单的事情，或者我应该指定某种标志来处理多行匹配？

`perl -v`是 5.14.2，我只使用`pe`标志。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:11:39.080

您可能想要`-0777`，这将强制 perl 一次读取整个文件。

```
perl -0777 -n -e 's|something|else|g' file 
```

此外，您的策略`.*\s*.*\s*`非常脆弱。它会匹配 eg `<div id="foo"`，这只是一个片段......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:00:12.857

您是否忘记了几乎所有正则表达式解析都是逐行进行的？

我总是不得不使用`tr`将换行符转换为其他字符，然后在正则表达式之后再次返回。

刚刚发现：[http](http://www.perlmonks.org/?node_id=17947) ://www.perlmonks.org/?node_id= 17947 您需要告诉正则表达式引擎将您的标量视为带有 /m 选项的多行字符串；否则它不会尝试跨换行符匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:08:38.837

```
perl -p 
```

正在逐行处理文件，[请参阅 perl.com](http://www.perl.com/pub/2004/08/09/commandline.html)

这意味着您的正则表达式将永远不会看到所有要匹配的行，它只会在它获取以“ `<div id="footer">`”开头的行时匹配，并且在以下行中它将不再匹配。

# ruby-on-rails-3 - 我将在哪里存储 Rails 应用程序中的静态/常量值？

> ID：10607063
> 
> 赞同：4
> 
> 时间：2012-05-15T18:55:30.407
> 
> 标签：ruby-on-rails-3

我有 Rails 应用程序，想知道存储常量的最佳位置？

例如：

```
HELLO_EVERYONE = "hiz" 
```

然后在一些控制器和视图中：

```
arr_used = [HELLO_EVERYONE] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T19:01:06.017

这取决于您需要在哪里访问它们。

如果您需要在整个应用程序中使用它们，您可以将它们放入`environment.rb`

```
# environment.rb
#
# other global config info
HELLO_EVERYONE = "hiz" 
```

如果您只需要在特定类中访问它们，则可以在该模型中定义它们。

```
class Test < ActiveRecord::Base
  HELLO_EVERYONE = "hiz"
end 
```

**编辑**

第二种情况（常量在`Test`类中定义），也可以在`Test`类外访问，只需要引用为`Test::HELLO_EVERYONE`.

如果您有一个可能在视图中使用的与该对象的域相关的项目列表（例如美国州列表），这可能会有所帮助（例如`select_tag :address, :state, options_for_select(Address::STATES)`）。尽管我可能会考虑将其包装在类方法中，而不是暴露类的内部结构。

```
class Address< ActiveRecord::Base
  STATES = ["AL", "AK", "AZ", "AR", ...]

  def self.states
    STATES
  end
end 
```

# python - 有没有办法通过python检测power point演示何时进入全屏？

> ID：10607065
> 
> 赞同：0
> 
> 时间：2012-05-15T18:55:37.960
> 
> 标签：python, windows, powerpoint

我试图找出一个。如果 Microsoft Power Point 正在运行，并且 b. 如果是这样，它是以全屏模式还是“幻灯片放映”模式运行。

检测 PowerPoint 实例是否正在运行非常简单。

```
def check_for_ppt():
    global ppt 
    stime = time.time()
    f = (os.popen('tasklist').read())
    if 'POWERPNT.EXE' in f:
        ppt = True
    else: 
        ppt = False 
```

但我不确定从这里去哪里。有没有办法检测另一个程序的状态？我想在紧要关头，我可以对屏幕极端的部分进行 ping 操作并测试像素是否返回黑色（就像在演示过程中那样），并希望我不会得到太多误报。但除此之外，我不确定。

python 可以“挂钩”到另一个程序并查看发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:15:54.500

您可以使用[PowerPoint 的 COM 接口](http://msdn.microsoft.com/en-us/library/bb265987%28v=office.12%29)和[win32com.client 模块](http://oreilly.com/catalog/pythonwin32/chapter/ch12.html)来执行此操作。

我这里没有 PPT 来编写代码，但看起来你必须连接到 PPT 并获取 Application.Presentations 对象并找到活动的 Presentation。当你有活动的[Presentation](http://msdn.microsoft.com/en-us/library/bb251586%28v=office.12%29)时，获取它的[SlideShowSettings](http://msdn.microsoft.com/en-us/library/bb230631%28v=office.12%29.aspx)并检查它的[ShowType](http://msdn.microsoft.com/en-us/library/bb230620%28v=office.12%29.aspx)是否为 ppShowTypeKiosk。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:05:36.490

您必须使用 PowerPoint 互操作，它可以让您访问 PPT 演示文稿正在执行的各种“内容”或它所处的状态。这不是一项简单的任务，因为您必须让它工作以某种方式使用您的 Python 应用程序。

我个人对 Python 并不熟悉，所以我不知道你会为此做些什么。如果您不能直接这样做，则可能是一个围绕 Interop 的 .NET 包装器，它将向 Python 应用程序公开所需的内容。我有 .NET 和互操作的经验，而且使用所有 MS 技术也并不简单。

我意识到，这是一个非常笼统的答案。我只是不认为这是一件容易完成的事情，无论是语言还是 IDE。

# sql-server - 左连接不起作用

> ID：10607078
> 
> 赞同：0
> 
> 时间：2012-05-15T18:56:24.423
> 
> 标签：sql-server

我正在尝试按开始日期和结束日期显示我酒店的免费客房

![在此处输入图像描述](../Images/042146ccd71c3a62de1e9ae9a97e1db3.png)

当我使用此代码时，它只显示出现在预订中的房间，但没有显示从未预订的房间。

```
SELECT room.RoomID,room.Room_Type_ID,room.Room_number,room.NumberofSpots,
 res.Data_Check_in,res.Data_Check_out FROM    

      dbo.Reservation res JOIN dbo.Room room ON room.RoomID=res.Room_ID
      WHERE NOT(res.Data_Check_in<=@p_StartData AND res.Data_Check_out>=@p_EndData) 
```

当我使用此代码时，它会显示所有房间，甚至是保留的房间：

```
SELECT DISTINCT r.*
FROM dbo.Room r LEFT JOIN dbo.Reservation  res ON r.RoomID=res.Room_ID
AND  NOT(res.Data_Check_in<='2012-05-07' AND res.Data_Check_out>='2012-06-13')
AND res.Cancel=0 
```

我应该修改什么以获得所有没有为选定日期保留的房间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T22:33:58.737

请原谅在变量和列名中使用日期而不是数据。

```
declare @p_StartDate as Date = '2012-05-07'
declare @p_EndDate as Date = '2012-06-13'

declare @Room as Table ( Room_ID Int Identity, Room_number VarChar(5) )
insert into @Room ( Room_number ) values
  ( '101' ), ( '102' ), ( '103' ), ( '104' ), ( '105' ),
  ( '201' ), ( '202' ), ( '203' ), ( '204' ), ( '205' )

declare @Reservation as Table ( ReservationID Int Identity, Room_ID Int, Date_Check_in Date, Date_Check_out Date, Cancel Bit )
insert into @Reservation ( Room_ID, Date_Check_in, Date_Check_out, Cancel ) values
  ( 3, '2012-05-01', '2012-05-06', 0 ), -- Before.
  ( 3, '2012-06-14', '2012-07-01', 0 ), -- After.
  ( 4, '2012-05-07', '2012-06-13', 0 ), -- Matching.
  ( 5, '2012-06-01', '2012-06-05', 0 ), -- Within.
  ( 6, '2012-05-01', '2012-06-01', 0 ), -- Overlapping start.
  ( 7, '2012-06-01', '2012-06-15', 0 ), -- Overlapping end.
  ( 8, '2012-06-01', '2012-06-05', 1 ), -- Within, but cancelled.
  ( 9, '2012-06-01', '2012-06-15', 1 ), -- Overlapping, but cancelled.
  ( 10, '2012-01-01', '2012-12-31', 0 ) -- Containing.

select room.Room_ID, room.Room_number
  from @Room as room
  where not exists (
    select 42
      from @Reservation
      where Room_ID = room.Room_ID and Cancel = 0 and
        -- The date ranges overlap.
        ( ( ( @p_StartDate <= Date_Check_in ) and ( Date_Check_in <= @p_EndDate ) or
        ( @p_StartDate <= Date_Check_out ) and ( Date_Check_out <= @p_EndDate ) ) or
        -- The desired range is contained in the reserved range.
        ( ( Date_Check_in <= @p_StartDate ) and ( @p_EndDate <= Date_Check_out ) ) ) ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:08:58.913

怎么样

```
SELECT Dr.* FROM dbo.Room r LEFT JOIN dbo.Reservation res 
ON r.RoomID=res.Room_ID
WHERE res.Room_ID IS NULL 
```

对于从未预订过的房间。

左连接对预订的房间没有帮助，但今天没有。为此，您想要类似的东西

```
SELECT Room_ID FROM Reservation WHERE Data_Check_out<=? OR Data_Check_in>=?
OR (Data_Check_out<=? AND Data_Check_in<=? AND Cancel=1 ) 
```

一些好的评论。我们知道左连接会给我们“从未使用过的房间”。

如果没有取消字段，以下应该可以工作：

> 设置@checkindate = '2012-05-15';
> 
> 设置@checkoutdate = '2012-05-17';
> 
> 从预订中选择 room_id （Data_Check_in 和 Data_Check_out 之间的@checkindate 或 Data_Check_in 和 Data_Check_out 之间的 @checkoutdate）

但是取消使事情变得更加困难，因为我们需要知道所有想要的日子都是可用的。这感觉更像是需要在个别日子进行设置操作。

# wpf - MVVM 绑定到可观察属性的属性

> ID：10607079
> 
> 赞同：0
> 
> 时间：2012-05-15T18:56:29.520
> 
> 标签：wpf, c#-4.0, data-binding, mvvm

我试图弄清楚当绑定的中间层发生变化时如何触发 PropertyChangedEvent。我将从这里的一个例子开始：

```
public class MainViewModel :NotificationObject // Main DataContext
{ 
   public SubViewModel SubVM{get; {_subVM = value; RaisePropertyChanged("SubVM");}}  // observable property
   public void DoChangeSubVM()
   {
      SubVM = new SubViewModel(); // doing this will not update the egControl
   }
}

public class SubViewModel : NotificationObject
{
   public Sub2ViewModel Sub2VM {get; set{_sub2VM = value; RaisePropertyChanged("Sub2VM");}} // observable property
}

public class Sub2ViewModel : NotificationObject
{
   public int SomeProp {get; set {_someProp = value; RaisePropertyChanged("SomeProp");} // observable property
} 
```

在 XAML 中：

```
<EgControl name="egControl" Content={Binding SubVM.Sub2VM.SomeProp} /> 
```

现在，如果我更改 Sub2VM 属性，egControl 不会自动更新为新 Sub2VM 实例的 SomeProp 值。有人如何实现这一点，而无需手动从 Sub2VM 属性设置器中引发所有 Sub2ViewModel propertychanged 事件？

使用：棱镜 .NET 4.0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T20:19:29.430

> 有人如何实现这一点，而无需手动从 Sub2VM 属性设置器中引发所有 Sub2ViewModel propertychanged 事件？

**回答**

你有几种可能性：

在 setter 中引发所有属性更改事件，您说过要避免这些事件。但这是一个值得考虑的有效策略。如果您知道哪些属性依赖于另一个属性的结果，那么它们将需要在 setter 中为许多属性引发属性更改。

```
public class myViewModel
{
    private string _FirstName
    public string FirstName
    {
        get { return_FirstName };
        set
        {
            _FirstName = value;
            RaisePropertyChanged("FirstName");
            RaisePropertyChanged("FullName");
        }
    }
} 
```

在构造新的 ViewModel 之后，在方法中引发所有属性更改事件。

```
public class myViewModel
{
    private string _FirstName
    public string FirstName
    {
        get { return_FirstName };
        set
        {
            _FirstName = value;
            RaisePropertyChanged("FirstName");
        }
    }

    public void UpdateFirstName(string firstName)
    {
        _FirstName = firstName;
        RaisePropertyChanged("FirstName");
        RaisePropertyChanged("FullName");
    }
} 
```

使用 setter 设置一些属性，从而触发已经存在的属性更改事件。

```
public class myViewModel
{
    private string _FirstName
    public string FirstName
    {
        get { return_FirstName };
        set
        {
            _FirstName = value;
            RaisePropertyChanged("FirstName");
        }
    }

    public Person ClonePerson(Person rootPerson)
    {
        Person clone = new Person()
        {
            FirstName = rootPerson.FirstName;
            LastName = rootPerson.LastName;
        }
        return clone;
    }
} 
```

创建一个引发所有属性更改事件的方法，并在需要引发多个更改事件的边缘情况下调用它。

```
public class myViewModel
{
    private string _FirstName
    public string FirstName
    {
        get { return_FirstName };
        set
        {
            _FirstName = value;
            this.RaiseAllPropertyChanges();
        }
    }

    public void RaiseAllPropertyChanges()
    {
        RaisePropertyChanged("FirstName");
        RaisePropertyChanged("FullName");
    }
} 
```

最终结果是：任何绑定的 UI 元素都知道它必须更新，必须引发该属性的属性更改事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:40:02.760

一种方法是为 SubViewModel 和 Sub2ViewModel 创建一个构造函数，将所有属性初始化为某个默认值。这将确保您的属性已初始化并让您能够设置初始值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:06:07.383

好的，不确定 Prism，但一般来说，所有三个类都应该实现属性更改通知。最简单的方法是使用 INotifyPropertyChanged。所以 SubViewModel 应该更像：

```
public class SubViewModel : INotifyPropertyChanged
{ 
    private Sub2ViewModel sub2vm;
    public Sub2ViewModel Sub2VM 
    {
        get
        {
            return sub2vm;
        }
        set
        {
            sub2vm = value;
            OnPropertyChanged("Sub2VM");
        }
    }

    protected void OnPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }
    public event PropertyChangedEventHandler PropertyChanged;
} 
```

如果没有属性更改通知，UI 不知道何时更新绑定的属性。

# css - 我可以为 twitter bootstrap 多选选择 size 属性吗？

> ID：10607085
> 
> 赞同：1
> 
> 时间：2012-05-15T18:56:46.857
> 
> 标签：css, twitter-bootstrap

size 属性似乎不适用于 Twitter 引导 css 文件。我错过了什么吗？

```
<div class="control-group"> 
    <div class="controls" >
        <select class="span2" multiple="multiple" id="multiSelect" size="2">
            <option>Assigned1</option>
            <option>Assigned2</option>
            <option>Assigned3</option>
            <option>Assigned4</option>
            <option>Assigned5</option>
        </select>
    </div> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T19:18:14.090

它应该工作。我想你忘记了容器 div 中的一个类。

```
<div class="control-group select optional">
    <label class="select optional control-label"> *Category</label>
    <div class="controls">
        <select name="name" id="id" class="select optional" size="2">
            <option value="">1</option>
            <option value="">1</option>
        </select>
    </div>
</div> 
```

试试这个例子并检查它是如何工作的。这就是我正在使用的方式。

# c# - SimpleIoc 未使用密钥注册 VM

> ID：10607087
> 
> 赞同：1
> 
> 时间：2012-05-15T18:56:55.353
> 
> 标签：c#, mvvm-light, silverlight-5.0

工具包二进制版本：4.0.30319

我在使用带有 SL5 二进制文件的 SimpleIoc 的密钥注册视图模型时没有成功。我让它工作的唯一一次是当我在 SL4 项目中使用[Mix 11 导航示例](http://blog.galasoft.ch/archive/2011/04/13/deep-dive-mvvm-samples-mix11-deepdivemvvm.aspx)中的 SL4 二进制文件时。

这是使用 SimpleIoc 注册我的 VM 的代码：

```
if (!SimpleIoc.Default.Contains<DeviceListDetailViewModel>(commandParam))
{
     SimpleIoc.Default.Register(
         () => new DeviceListDetailViewModel(this.Repository, this.NavService) { NavParameter = commandParam }, commandParam);
} 
```

这是我在视图中检查实例并获得“未找到项目”的地方：

```
if (DataContext == null)
{
     var url = e.Uri.ToString();
     NavParam = url.Substring(url.IndexOf("?") + 1);

     if (!SimpleIoc.Default.Contains<DeviceListDetailViewModel>(NavParam))
     {
           MessageBox.Show("Item not found");
           return;
     }

     var vm = SimpleIoc.Default.GetInstance<DeviceListDetailViewModel>(NavParam);
     DataContext = vm;
 } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-23T14:51:37.700

注册视图模型不会创建实例，除非您为 createInstanceImmediately 传入 true。因此，在您调用 Contains 时，没有创建任何实例。

[您可以在文档](http://www.mvvmlight.net/help/WP8/html/d1b36f20-c8b2-9169-0a8b-0322e80a1287.htm%22documentation%22)中看到

# ruby-on-rails - 使用多步表单时无法保存 tag_list

> ID：10607089
> 
> 赞同：0
> 
> 时间：2012-05-15T18:56:58.677
> 
> 标签：ruby-on-rails, forms, tagging, multi-step

我有一个归属模型，允许用户在我的网站上发布要出售或出租的对象。我最近更改了表单，使其成为一个多步骤表单：第一个表单询问对象的名称以及对象是出售还是出租，第二个表单询问对象的详细信息，字段取决于用户的选择.

我在 Rails 3.0.5 中使用 is_taggable，我的问题是 tag_list 从未保存在数据库中，因为我切换到多步骤表单（所有其他字段都正确保存）。

我跟着 Ryan Bates Rails 演员 #217。

之前，我使用的是：`@belonging.tag_list = params[:belonging][:tag_list]`

由于我从多步开始，我正在使用：`@belonging.tag_list = session[:belonging_params][:tag_list]`

我是 Rails 的新手，所以我可能在这里遗漏了一些明显的东西。我花了整个下午和晚上的时间试图了解出了什么问题，因此将不胜感激任何帮助！

这是我的控制器的“新建”和“创建”操作：

```
class BelongingsController < ApplicationController
  before_filter :authenticate_user!, :except => [:index, :with_tag, :remove_tag]
  after_filter :update_tag_cloud, :only => [:create, :update]

  def new
    @title = "Insert a new product or service"
    @user = current_user
    session[:belonging_params] ||= {}
    session[:belonging_step] = nil
    @belonging = @user.belongings.new(session[:belonging_params])
    session[:belonging_params][:tag_list] ||= []
    @belonging.current_step = session[:belonging_step]
    render 'new'
  end

  def create
    session[:belonging_params].deep_merge!(params[:belonging]) if params[:belonging]
    @belonging = current_user.belongings.build(session[:belonging_params])
    @belonging.current_step = session[:belonging_step]
    @belonging.tag_list=session[:belonging_params][:tag_list]
    if params[:previous_button]
      @belonging.previous_step
      render 'new'
    elsif params[:cancel_button]
      session[:belonging_step] = session[:belonging_params] = nil
      redirect_to user_path(current_user)
    elsif params[:continue_button]
      if @belonging.last_step?
        if @belonging.save!
          expire_fragment('category_list')
          flash[:success] = "New product or service created!"
          session[:belonging_step] = session[:belonging_params] = nil
          redirect_to belonging_path(@belonging)
        else
          flash[:error] = "Object could not be saved"
          render 'new'
        end
      else
        @belonging.next_step
        render 'new'
      end
    else
      render 'new'
    end
    session[:belonging_step] = @belonging.current_step
  end 
```

非常感谢任何线索！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T12:10:37.753

其实我是这么想的：

```
session[:belonging_params].deep_merge!(params[:belonging]) if params[:belonging] 
```

会复制 params[:belonging] 中的所有内容，但似乎 params[:belonging][:tag_list] 没有像我预期的那样复制到 session[:belonging_params][:tag_list] 中......

因此，通过在“创建”操作中添加一个新的会话变量来解决问题：

`session[:tag_list] = params[:belonging][:tag_list]`能够`:tag_list`从表单的一个步骤保存到下一个步骤。

`session[:tag_list]`在“新”操作中首先定义为：

```
session[:tag_list] ||= [] 
```

# python - 如何在 Django 中访问表单提交按钮的值？

> ID：10607091
> 
> 赞同：27
> 
> 时间：2012-05-15T18:57:03.850
> 
> 标签：python, django, forms

我有一个 Django 项目，在一个页面上，有多个表单（在不同的标签中）可以提交以产生不同的效果。在所有情况下，我都希望将用户重定向回同一页面，因此我在我的视图中使用提交表单然后重定向到原始页面的模式。至少在一种情况下，两个表单之间的唯一区别是提交按钮的值。

在我看来，我有代码（这是我的视图函数第一次访问`request.POST`）：

```
if request.POST['submit']=='Add':
    #code to deal with the "Add" form 
```

在模板中，第一个表单有一个提交按钮，如

```
<input type="submit" value="Add"> 
```

我认为这会起作用，但是当我提交该表单时，我在上面看到的行中出现错误：

> 未找到密钥“提交”`<QueryDict: {u'clientyear': [u'2012'], u'csrfmiddlewaretoken': [u'be1f2f051f09f6ab0375fdf76cf6a4d7'], u'ben': [u'123405']}>`

显然，这没有`'submit'`键或任何键值对应于我单击的提交按钮。那么，既然这不起作用，那么如何访问提交按钮的值或判断哪些表单已提交？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-05-15T19:10:39.913

`Submit`是一个 HTML 表单结构...您必须使用表单对象的名称属性，如下所示...在您的模板中：

```
<form>
...
<input type="submit" name="list" value="List Objects" />
</form>
<form>
...
<input type="submit" name="do-something-else" value="Do Something Else" />
</form> 
```

在您看来：

```
if 'list' in request.POST:
    # do some listing...
elif 'do-something-else' in request.POST:
    # do something else 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-10-07T08:22:44.357

要记住一件事以防止混淆。如果`name`表单中只有一个按钮，则不会显示提交按钮。

```
#template.html
<form action="..." method="post">
<input type="submit" name = "first_button" value="Add">
</form>

#view.py
...
'first_button' in request.POST  #False 
```

* * *

```
#template.html
<form action="..." method="post">
<input type="submit" name = "first_button" value="Add">
<input type="submit" name = "second_button" value="Remove">
</form>

#view.py
...
'first_button' in request.POST  #True if you clicked on that button 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-12-13T07:14:45.590

我有点晚了，但这是解决方案

**您面临的问题**

您正在尝试获取按钮名称，但获取按钮的初始值不正确。

**HTML 代码**

> ```
> <input type="submit" value="Add"> 
> ```

**Python 代码/View.py**

> ```
> if request.POST['submit']=='Add':
> #code to deal with the "Add" form 
> ```

**解决方案**

如果存在，首先在 request.POST 字典中找到按钮名称，然后获取它们的值。

**HTML 代码**

添加按钮的名称及其值。

> ```
> <input type="submit" value="Add" name="add_object"> 
> ```

**视图.py**

您可以在 request.POST 字典中找到按钮名称

> ```
> if request.POST['submit'] == 'add_object':
> # Both ways to deal with it
> if 'add_object' in request.POST: 
> ```

* * *

**额外的东西**

我们在一个页面上有两个表单。

第一种形式有 2 个按钮，**主题**名称相同，但值不同**fav_HTML**和**fav_CSS**。

第二种形式也有 2 个按钮，同名**tutorials**但值不同 **Tutorials_HTML**和**Tutorials_CSS**。

```
 <form action="" method="post">
      Form 1
      <button name="subject" type="submit" value="interview_HTML">HTML</button>
      <button name="subject" type="submit" value="interview_CSS">CSS</button>
 </form> 

<form action="" method="post">
      Form 2 
      <button name="tutorials" type="submit" value="Tutorials_HTML">HTML</button>
      <button name="tutorials" type="submit" value="Tutorials_CSS">CSS</button>
 </form> 
```

**视图.py**

我们可以处理不同的表单，检查单击了哪个按钮，然后获取它们的值并做一些事情。

```
if 'subject' in request.POST: # this section handle subject form (1st Form)
#now we can check which button is clicked 
# Form 1 is submitted , button value is subject now getting their value 

    if 'interview_HTML' == request.POST.get('subject'):
       pass 
       # do something with interview_HTML button is clicked
    elif 'interview_CSS' == request.POST.get('subject'):
        pass
        # do something with interview_CSS button is clicked

elif 'tutorials' in request.POST: #this section handle tutorials form (2nd form)

    #now we can check which button is clicked 
    # Form 1 is submitted , button name is tutorials now getting their value 

    if 'Tutorials_HTML' == request.POST.get('tutorials'):
        pass 
        # do something with fav_HTML button is clicked
    elif 'Tutorials_CSS' == request.POST.get('tutorials'):
        pass
        # do something with fav_CSS button is clicked 
```

# php - html表单字段验证

> ID：10607092
> 
> 赞同：0
> 
> 时间：2012-05-15T18:57:13.653
> 
> 标签：php, html

我有 html 表单，我想在用户输入上添加验证 - 示例用户名字段必须以 alpha 开头，邮政编码必须是数字。

```
 > <tr>
<td>username</td>
<td><input type="text" name="user name" placeholder="Must start with Alpha"></td>
 </tr>

 > <tr>
<td>zipcode</td>
<td><input type="text" name="zipcode" placeholder="Must be 5 digit numeric"></td>
 </tr> 
```

如果不发送错误，是否有任何简单的方法来执行此规则。我是新手，这是针对简单的内部站点而不是复杂的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:00:10.843

如果您想要表单验证而不是动态验证，我建议您使用 html5 数字字段以及“模式”属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:10:35.623

这个问题非常适合谷歌搜索。这是谷歌列出的示例教程：

[http://absolutewebdev.com/tutorials.php?result=8&topic=Validating_a_form_using_JavaScript_Regular_Expressions](http://absolutewebdev.com/tutorials.php?result=8&topic=Validating_a_form_using_JavaScript_Regular_Expressions)

通过谷歌搜索诸如表单验证 javascript regex 之类的东西来查找其他人

# iphone - 纹理映射 - Cocos2d/OpenGL ES 1.0

> ID：10607093
> 
> 赞同：-1
> 
> 时间：2012-05-15T18:57:17.040
> 
> 标签：iphone, opengl-es, cocos2d-iphone

这种闪电确实影响了我的游戏性能，因为我不断添加和移除闪电，而且每次闪电都由 3 条抗锯齿线组成，使用：

```
void ccDrawSmoothLine(CGPoint pos1, CGPoint pos2, float width)
{
    GLfloat lineVertices[12], curc[4];
    GLint   ir, ig, ib, ia;
    CGPoint dir, tan;

    // Default GL states: GL_TEXTURE_2D, GL_VERTEX_ARRAY, GL_COLOR_ARRAY, GL_TEXTURE_COORD_ARRAY
    // Needed states: GL_VERTEX_ARRAY,
    // Unneeded states: GL_TEXTURE_2D, GL_TEXTURE_COORD_ARRAY, GL_COLOR_ARRAY
    glDisable(GL_TEXTURE_2D);
    glDisableClientState(GL_TEXTURE_COORD_ARRAY);
    glDisableClientState(GL_COLOR_ARRAY);

    //glEnable(GL_LINE_SMOOTH);
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

    pos1.x *= CC_CONTENT_SCALE_FACTOR();
    pos1.y *= CC_CONTENT_SCALE_FACTOR();
    pos2.x *= CC_CONTENT_SCALE_FACTOR();
    pos2.y *= CC_CONTENT_SCALE_FACTOR();
    width *= CC_CONTENT_SCALE_FACTOR();

    width = width*2;
    dir.x = pos2.x - pos1.x;
    dir.y = pos2.y - pos1.y;
    float len = sqrtf(dir.x*dir.x+dir.y*dir.y);
    if(len<0.00001)
        return;
    dir.x = dir.x/len;
    dir.y = dir.y/len;
    tan.x = -width*dir.y;
    tan.y = width*dir.x;

    lineVertices[0] = pos1.x + tan.x;
    lineVertices[1] = pos1.y + tan.y;
    lineVertices[2] = pos2.x + tan.x;
    lineVertices[3] = pos2.y + tan.y;
    lineVertices[4] = pos1.x;
    lineVertices[5] = pos1.y;
    lineVertices[6] = pos2.x;
    lineVertices[7] = pos2.y;
    lineVertices[8] = pos1.x - tan.x;
    lineVertices[9] = pos1.y - tan.y;
    lineVertices[10] = pos2.x - tan.x;
    lineVertices[11] = pos2.y - tan.y;

    glGetFloatv(GL_CURRENT_COLOR,curc);
    ir = 255.0*curc[0];
    ig = 255.0*curc[1];
    ib = 255.0*curc[2];
    ia = 255.0*curc[3];

    const GLubyte lineColors[] = {
        ir, ig, ib, 0,
        ir, ig, ib, 0,
        ir, ig, ib, ia,
        ir, ig, ib, ia,
        ir, ig, ib, 0,
        ir, ig, ib, 0,
    };

    glEnableClientState(GL_VERTEX_ARRAY);
    glEnableClientState(GL_COLOR_ARRAY);
    glVertexPointer(2, GL_FLOAT, 0, lineVertices);
    glColorPointer(4, GL_UNSIGNED_BYTE, 0, lineColors);
    glDrawArrays(GL_TRIANGLE_STRIP, 0, 6);
    glDisableClientState(GL_COLOR_ARRAY);

    // restore default state
    glEnableClientState(GL_COLOR_ARRAY);
    glEnableClientState(GL_TEXTURE_COORD_ARRAY);
    glEnable(GL_TEXTURE_2D);
} 
```

我的 FPS 将下降到 40 左右，然后又回到 60。我读过纹理映射线可以提高我的游戏性能。

我已经尝试解决这个问题好几个星期了，但没有运气。有人可以帮我吗？

这是我目前的 ccDrawLines 和 draw 方法

```
-(void) draw
{
    numPoints_ = 0;
    glColor4ub(_color.r, _color.g, _color.b, _opacity);

    if (_opacity != 255)
        glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

    drawLightning(_strikePoint2, _strikePoint, _displacement, _minDisplacement, _seed, lightningPoints_, &numPoints_);
    ccDrawLines(lightningPoints_, numPoints_, texture);

    if (_opacity != 255)
        glBlendFunc(CC_BLEND_SRC, CC_BLEND_DST);

    glColor4f(1.0, 1.0, 1.0, 1.0);
}

void ccDrawLines( CGPoint* points, uint numberOfPoints, CCTexture2D* texture )
{
    //layout of points [0] = origin, [1] = destination and so on

    ccVertex2F vertices[numberOfPoints];
    if (CC_CONTENT_SCALE_FACTOR() != 1 )
    {
        for (int i = 0; i < numberOfPoints; i++)
        {
            vertices[i].x = points[i].x * CC_CONTENT_SCALE_FACTOR();
            vertices[i].y= points[i].y * CC_CONTENT_SCALE_FACTOR();
        }
        glVertexPointer(2, GL_FLOAT, 0, vertices);
    }
    else glVertexPointer(2, GL_FLOAT, 0, points);

    ccTex2F texCoords[numberOfPoints];

    float width = texture.pixelsWide;
    float height = texture.pixelsHigh;

    if (CC_CONTENT_SCALE_FACTOR() != 1 )
    {
        for (int i = 0; i < numberOfPoints; i++)
        {
            texCoords[i].u = (vertices[i].x * CC_CONTENT_SCALE_FACTOR()) / width;
            texCoords[i].v = (vertices[i].y * CC_CONTENT_SCALE_FACTOR()) / height;
        }
        glTexCoordPointer(2, GL_FLOAT, 0, texCoords);
    }
    else glTexCoordPointer(2, GL_FLOAT, 0, points);

    // Default GL states: GL_TEXTURE_2D, GL_VERTEX_ARRAY, GL_COLOR_ARRAY, GL_TEXTURE_COORD_ARRAY
    // Needed states: GL_VERTEX_ARRAY,
    // Unneeded states: GL_TEXTURE_2D, GL_TEXTURE_COORD_ARRAY, GL_COLOR_ARRAY
    glPushMatrix();
    glBindTexture(GL_TEXTURE_2D, [texture name]);
    glDisableClientState(GL_COLOR_ARRAY);

    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);

    glDrawArrays(GL_TRIANGLE_STRIP, 0, numberOfPoints);

    // restore default state
    glEnableClientState(GL_COLOR_ARRAY);

    glPopMatrix();
} 
```

纹理只是一个带有小蓝点的 32x32 .png 文件。

如果您查看 ccDrawLines，我已将代码添加到纹理映射线。它的问题是，线条中有间隙，绘制了多条线，看起来很可怕。

* * *

***编辑：*** 我决定不对线条进行纹理贴图并使用 ccDrawSmoothLine。

我所做的只是在我的游戏层初始化中分配闪电

```
lightningStrike_ = [Lightning lightningWithStrikePoint:ccp(-100, -100) strikePoint2:ccp(-100, -100)];
[self addChild:lightningStrike_ z:1]; 
```

然后，我创建了一个实例方法来设置_strikePoint 和_strikePoint2 属性并调用strikeRandom 方法。

```
-(Lightning *)lightningStrike:(CGPoint)p end:(CGPoint)p2
{
    lightningStrike_.strikePoint = ccp(p.x, p.y);
    lightningStrike_.strikePoint2 = ccp(p2.x, p2.y);
    [lightningStrike_ strikeRandom];

    return lightningStrike_;
} 
```

用法：

```
[self lightningStrike:ccp(100, 100) end:ccp(100, 100)]; 
```

这修复了 FPS 下降。24 小时后我会回答并接受我自己的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T12:20:39.960

编辑：我决定不对线条进行纹理贴图并使用 ccDrawSmoothLine。

我所做的只是在我的游戏层初始化中分配闪电

LightningStrike_ = [闪电闪电LightningWithStrikePoint：ccp（-100，-100）strikePoint2：ccp（-100，-100）]；[self addChild:lightningStrike_z:1];

然后，我创建了一个实例方法来设置_strikePoint 和_strikePoint2 属性并调用strikeRandom 方法。

-(闪电 *)lightningStrike:(CGPoint)p 结束:(CGPoint)p2 { LightningStrike_.strikePoint = ccp(px, py); LightningStrike_.strikePoint2 = ccp(p2.x, p2.y); [lightningStrike_strikeRandom];

    返回闪电罢工_; }

用法：

[自我闪电：ccp(100, 100) end:ccp(100, 100)];

这修复了 FPS 下降。24 小时后我会回答并接受我自己的回答。

# c# - “此程序集由比当前加载的运行时更新的运行时构建，无法加载”

> ID：10607095
> 
> 赞同：58
> 
> 时间：2012-05-15T18:57:32.013
> 
> 标签：c#, dll, .net-4.0, .net-2.0

我收到错误消息：“此程序集由比当前加载的运行时更新的运行时构建，无法加载。”

我有一个 .NET 2.0 项目正在调用的 .NET 4.0 dll 项目。有没有办法调和框架的差异？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-05-15T18:59:35.400

> 我有一个 .NET 2.0 项目正在调用的 .NET 4.0 dll 项目。有没有办法调和框架的差异？

不是那样的，不。.NET 4 CLR 可以加载 .NET 2 程序集（通常 - 混合模式程序集有一些例外，IIRC），但反之则不然。

您必须将 .NET 2 项目升级到 .NET 4，或者将 .NET 4 项目降级到 .NET 3.5（或更早版本）。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-06-13T20:57:12.210

如果您已经尝试过此页面上的所有其他逻辑解决方案，请仔细检查。在我的 app.config 中，我引用了一个旧框架。

```
<startup>
  <supportedRuntime version="v2.0.50727"/>
</startup> 
```

本来应该

```
<startup>
  <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
</startup> 
```

项目选项卡正确显示了 v4.0，但 app.config 并未通过该更改提交到我们的存储库。为了修复它，我将框架更改为其他内容并再次返回到 4.0，这更新了我的 app.config 文件。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-09-11T18:50:42.687

我得到了同样的错误信息。我在给

> C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\InstallUtil.exe "C:\MyService\MyService.exe"

代替

> C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\InstallUtil.exe "C:\MyService\MyService.exe"

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-05-15T19:04:25.460

由于只能将一个版本的运行时加载到进程中（尽管正如其他人所暗示的那样，向后加载 - 4.0 加载 2.0 - 是可以的），您有几个选择：

*   升级 .Net 2.0 项目
*   包装 .Net 2.0 项目（如果源不是你的）
*   降级 .Net 4.0 项目
*   将 .Net 4.0 项目加载到它自己的进程中（我相信这可以工作 - 但需要一些努力，IMO）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-01-25T12:09:13.977

> 您必须将 .NET 2 项目升级到 .NET 4，或者将 .NET 4 项目降级到 .NET 3.5（或更早版本）。

你如何升级.net版本？我不确定在哪里以及要指定什么。请帮忙。

编辑：我自己找到了答案。选择项目，右键单击并选择属性页。在那里您可以选择框架版本。或选择项目并单击**Shift+F4**

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-05-12T22:43:40.287

有趣的是，我一直收到这个错误。为我解决的问题是在与 gacutil.exe 相同的目录中创建一个名为*gacutil.exe.config的配置。*配置内容（文本文件）是：

```
<?xml version ="1.0"?> <configuration>
    <startup useLegacyV2RuntimeActivationPolicy="true">
        <requiredRuntime safemode="true" imageVersion="v4.0.30319" version="v4.0.30319"/>
    </startup> </configuration> 
```

我在此处发布此内容以供参考，并询问是否有人知道引擎盖下实际发生的事情。我并不是说这是“正确”的做法

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-09-07T08:49:20.693

**`INSTALL_UTIL_HOME`**将目录从更改**`C:\WINDOWS\Microsoft.NET\Framework\v2.0`**为**`C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319`**以安装服务。此错误主要发生在版本不匹配。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-12-17T19:02:16.207

我也遇到了这个错误，但我的问题是我使用的是旧版本的`GACUTIL.EXE`.

一旦我安装了正确`GACUTIL`的最新`.NET`版本，它就可以正常工作。

该错误具有误导性，因为它看起来像是您尝试注册的 DLL 不正确。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-08-22T23:23:43.567

将错误的 .NET 框架版本选为 IIS 中的默认值也可能会触发此错误。

*单击Connections*视图下的根节点（左侧），然后从*Actions视图（右侧）中选择**Change .NET Framework Version*，然后从下拉列表中选择适当的 .NET 版本。

 ** * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-08-11T15:45:55.390

该错误是由于我在 IIS 中配置应用程序池的方式造成的。

我的 Web 服务使用为 v2.0.50727 配置的应用程序工具。这导致了错误消息。

当我将其更改为 v4.0.30319 时，我没有收到错误消息。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-01-15T06:41:27.187

当我更改托管特定项目的应用程序池的 .Net 框架版本时，我能够解决这个特定问题。

应用程序池 -> 高级设置 -> .Net frame work 版本（将 v2.0 更改为 v4.0）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-04-04T10:14:20.133

它的 .net 版本与 dll 不匹配，因此请尝试在 app.config 或 web.config 中更改为 from。通常有更高的框架而不是更低的框架，因为当我们将系统的 dll 添加到低版本构建的 .net 应用程序时，它不会工作，因此只需更改为更高版本*

# android - 如何为自定义 Android 通知添加垂直线到 RemoteView？

> ID：10607097
> 
> 赞同：4
> 
> 时间：2012-05-15T18:57:39.770
> 
> 标签：android, android-layout, view, android-notifications, remoteview

我正在努力为自定义 Android 通知添加一条垂直线。我尝试将这样的视图添加到我的相对布局中：

```
<View
    android:id="@+id/line_vertical"
    android:layout_width="1dip"
    android:layout_height="fill_parent"
    android:layout_centerVertical="true"
    android:layout_toRightOf="@id/image_logo"
    android:background="#0000FF" /> 
```

但是当我触发通知时，我收到以下异常：
android.app.RemoteServiceException：从包 XXX 发布的错误通知：无法扩展 RemoteViews：StatusBarNotification(package=XXX)

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T18:59:44.463

您不能只对`RemoteView`. 将您更改`View`为空`TextView`或`ImageView`。

> RemoteViews 对象（以及相应的 App Widget）可以支持以下布局类：
> 
> ```
> FrameLayout
> LinearLayout
> RelativeLayout 
> ```
> 
> 以及以下小部件类：
> 
> ```
> AnalogClock
> Button
> Chronometer
> ImageButton
> ImageView
> ProgressBar
> TextView
> ViewFlipper
> ListView
> GridView
> StackView
> AdapterViewFlipper 
> ```
> 
> 不支持这些类的后代。

参考：http: [//developer.android.com/guide/topics/appwidgets/index.html#CreatingLayout](http://developer.android.com/guide/topics/appwidgets/index.html#CreatingLayout)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-25T11:12:51.447

```
 <LinearLayout
        android:layout_width="1dp"
        android:layout_height="25dp"
        android:layout_gravity="center_vertical"
        android:alpha="0.3"
        android:background="#FFFFFF" /> 
```

我们必须像这样添加。

# php - 使用一到五个变量变量时未初始化的字符串偏移通知

> ID：10607098
> 
> 赞同：1
> 
> 时间：2012-05-15T18:57:54.510
> 
> 标签：php, mysql, arrays

我想从一个数组中提取最多五个值并将它们放在一个 msql 查询中，如下所示：

```
$frontpage_hot_list_data = array(); 

while (@$row = mysql_fetch_array($sql_frontpage_hot_list)) {
    $frontpage_hot_list_data[] = $row['id']; 
}

$sql_frontpage_hot_down = mysql_query("SELECT * FROM submissions WHERE 
id !='$frontpage_hot_list_data[0]' AND id !='$frontpage_hot_list_data[1]' AND
id !='$frontpage_hot_list_data[2]' AND id !='$frontpage_hot_list_data[3]' AND 
id !='$frontpage_hot_list_data[4]' AND thumbnail_large=0 AND popular=1 AND 
popular_datetime > '$frontpage_hot_hot_three_onlineNowTm' AND 
views > '$frontpage_hot_hot_three_views' ORDER BY views DESC LIMIT 4"); 
```

这里的问题似乎是当我的值少于五个时，我收到以下错误：

> 注意：未定义的偏移量：D:\Hosting\8847501\html\scripts\timeframes.php 第 298 行中的 1
> 
> 注意：未定义的偏移量：D:\Hosting\8847501\html\scripts\timeframes.php 第 299 行中的 2
> 
> 注意：未定义的偏移量：3 在 D:\Hosting\8847501\html\scripts\timeframes.php 第 300 行
> 
> 注意：未定义的偏移量：第 301 行 D:\Hosting\8847501\html\scripts\timeframes.php 中的 4

知道如何解决这个问题吗？也许只在查询中放置确切数量的变量？我迷路了...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:02:15.097

您可以使用[`implode`](http://php.net/manual/en/function.implode.php)创建一个逗号分隔的 ID 列表，然后将这个新创建的列表放入 MySQL[`IN`](http://dev.mysql.com/doc/refman/5.5/en/comparison-operators.html#function_in)表达式中（**更新**：现在我看到您`!=`在查询中使用了，所以让我们来吧`NOT IN`）。

```
$list = implode(',', $frontpage_hot_list_data);
$sql_frontpage_hot_down = mysql_query("SELECT * FROM submissions WHERE 
id NOT IN ($list) AND thumbnail_large=0 AND popular=1 AND 
popular_datetime > '$frontpage_hot_hot_three_onlineNowTm' AND 
views > '$frontpage_hot_hot_three_views' ORDER BY views DESC LIMIT 4"); 
```

**重要说明**：我在这里假设您的 id 是数字，因此`implode()`会产生类似`1,5,133,31`. 如果它们是字符串，那么您必须首先使用`array_map()`例如将它们包装在撇号中。

此外，如果您希望数组可以为空，您可以添加另一个条件，`id NOT IN () AND`在必要时省略整个部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:05:50.237

似乎没有 $sql_frontpage_hot_list 结果，因为数组 $frontpage_hot_list_data[] 不包含任何结果

我会做以下事情：

```
$frontpage_hot_list_data = array(); 

while (@$row = mysql_fetch_array($sql_frontpage_hot_list)) {
    $frontpage_hot_list_data[] = $row['id']; 
}

if(count($frontpage_hot_list_data)) 
{
    $frontpage_ids_str = implode($frontpage_hot_list_data, ',');
    $sql_frontpage_hot_down = mysql_query("SELECT * FROM submissions WHERE 
           id not in (".$frontpage_ids_str.") AND thumbnail_large=0 AND popular=1 AND 
           popular_datetime > '$frontpage_hot_hot_three_onlineNowTm' AND 
           views > '$frontpage_hot_hot_three_views' ORDER BY views DESC LIMIT 4");
}
else
{  
    $sql_frontpage_hot_down = mysql_query("SELECT * FROM submissions WHERE
           thumbnail_large=0 AND popular=1 AND 
           popular_datetime > '$frontpage_hot_hot_three_onlineNowTm' AND 
           views > '$frontpage_hot_hot_three_views' ORDER BY views DESC LIMIT 4");
} 
```

因此，如果我们有 $frontpage_hot_list_data 我们将它们排除在外，否则我们将忽略它们。

# c# - WebApi 与 Linq“文档末尾的额外内容”错误

> ID：10607101
> 
> 赞同：0
> 
> 时间：2012-05-15T18:58:06.197
> 
> 标签：c#, asp.net, odata, iqueryable, asp.net-web-api

当我尝试查询我的 MVC 4 WebApi 服务时出现以下错误

```
Extra content at the end of the document

Below is a rendering of the page up to the first error.

55Author Namehttp://images.myserver.com/authorspictures/nophoto.jpg 
```

我查看了由 Linq To Sql 生成的 Author 类，发现在图片 URL 之后的 Author 对象的下一个属性是这个：

```
 [Association(Name = "Author_Quote", Storage = "_Quotes", ThisKey = "Id", OtherKey = "AuthorId")]
    public EntitySet<Quote> Quotes { get; set; } 
```

我的理解是，在为该属性生成 XML 时存在一些问题，导致上述错误。但是我不知道如何防止这种情况并使其正常工作。我发现的有关 webApi 的大多数示例都使用 POCO 列表，因此在这件事上他们无法帮助我。

有什么建议吗？

下面是我的代码

```
public class AuthorController : ApiController
{
    IAuthorRepository repository;

    public AuthorController(IAuthorRepository repository)
    {
        this.repository = repository; 
    }

    [ResultLimit(20)]
    public IQueryable<Author> GetAuthors(){
        return repository.GetAuthors(); 
    }
}

public class DBAuthorRepository : IAuthorRepository
{
    public IQueryable<Author> GetAuthors()
    {
        using (var context = new QuotesDataContext())
        {  
            return context.Authors.ToList().AsQueryable();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T13:16:41.643

我发现这是由延迟加载引起的。所以我添加了以下内容，现在它可以工作了。

```
public class DBAuthorRepository : IAuthorRepository
{
    public IQueryable<Author> GetAuthors()
    {
        using (var context = new QuotesDataContext())
        {  
            context.DeferredLoadingEnabled = false; // Added this line
            return context.Authors.ToList().AsQueryable();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T15:02:20.647

我在 mvc4 webapi 中收到上述错误，形成 @alexandrekow 答案，我找到了解决方案：

```
 entity = new BrewedlifeEntities();
 entity.ContextOptions.ProxyCreationEnabled = false; // Added this line 
```

# c# - 有没有办法标记每个 protobuf-net 记录的结尾

> ID：10607103
> 
> 赞同：4
> 
> 时间：2012-05-15T18:58:08.407
> 
> 标签：c#, protobuf-net

我在数据库单元格中将一系列 protobuf-net 对象保存为以长度为前缀的 protobuf-net 对象的 Byte[]：

```
//retrieve existing protobufs from database and convert to Byte[]
object q = sql_agent_cmd.ExecuteScalar();
older-pbfs = (Byte[])q;

// serialize the new pbf to add into MemoryStream m
//now write p and the new pbf-net Byte[] into a memory stream and retrieve the sum

var s = new System.IO.MemoryStream();
s.Write(older-pbfs, 0, older-pbfs.Length);
s.Write(m.GetBuffer(), 0, m.ToArray().Length); // append new bytes at the end of old
Byte[] sum-pbfs = s.ToArray();

//sum-pbfs = old pbfs + new pbf. Insert sum-pbfs into database 
```

这工作正常。我担心的是如果有轻微的数据库损坏会发生什么。将不再可能知道哪个字节是长度前缀，并且必须丢弃整个单元格内容。是否建议也使用某种类型的 pbf 对象结束指示符（有点像文本文件中使用的 \n 或 EOF 指示符）。这样，即使一条记录损坏，其他记录也可以恢复。

如果是这样，在每个 pbf 末尾添加记录结束指示符的推荐方法是什么。

在 Visual Studio 2010 上使用 protobuf-netv2 和 C#。

谢谢马尼什

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:27:55.833

如果您通过`Serialize`/使用普通消息`Deserialize`，那么不：这不是规范的一部分（因为格式被设计为可附加的）。

但是，如果您使用`SerializeWithLengthPrefix`，它将在消息开头转储长度；然后它将提前知道需要多少数据。你用 反序列`DeserializeWithLengthPrefix`化，如果它没有足够的数据它会大声抱怨。然而！**如果您有额外的**数据，它不会抱怨，因为这*也是*可附加的。

根据 Jon 的回复，该`*WithLengthPrefix`方法的默认用法是*存储的数据*与 Jon 建议的完全相同；它*假装*有一个包装对象并做出相应的行为。区别在于：

*   实际上不存在包装对象
*   "withlengthprefix" 方法在单次出现后显式停止，而不是将任何以后的数据合并到同一个对象中（例如，用于将多个离散对象发送到单个文件或单个套接字）

这里两个“可附加”的区别在于，第一个表示“合并为一个对象”，而第二个表示“我期望多个记录”。

无关建议：

```
s.Write(m.GetBuffer(), 0, m.ToArray().Length); 
```

应该：

```
s.Write(m.GetBuffer(), 0, (int)m.Length); 
```

（无需创建额外的缓冲区）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T19:04:33.043

（注：我对 protobuf-net 本身了解不多，但这一般适用于 Protocol Buffer 消息。）

通常，如果您想记录多条消息，只需放置一个“包装”消息 - 使“真实”消息成为其中的重复字段。然后，每个“真实”消息的长度都会以 Protocol Buffers 的自然线路格式为前缀。

这当然不会检测到损坏 - 但老实说，如果数据库最终损坏，您就会遇到更大的问题。您可能会*检测到*损坏，例如通过将哈希与每条记录一起保存...但是您需要考虑损坏发生在长度前缀内或哈希本身内的可能性。想一想您在这里*真正*想要实现的目标——您想要防范的场景，以及您需要的恢复水平。

# c# - string.replace 的 LINQ 查询

> ID：10607104
> 
> 赞同：4
> 
> 时间：2012-05-15T18:58:09.243
> 
> 标签：c#, .net, linq

在给定任何字符串的情况下寻求帮助，返回仅包含字母数字字符的字符串，并将所有非字母数字字符替换为 _

所以字符串“ASD@#$123”变成了“ASD___123”

ETC

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T18:59:59.397

对于大多数字符串操作，如果您使用正则表达式而不是 LINQ ，您会更好（在~~效率和简洁性方面）：~~

```
string input = "ASD@#$123";
string result = Regex.Replace(input, "[^A-Z0-9]", "_", RegexOptions.IgnoreCase); 
```

如果您想保留任何 Unicode 字母数字字符，包括非 ASCII 字母，例如`é`，我们可以使用[非单词字符](http://msdn.microsoft.com/en-us/library/20bw873z.aspx#NonWordCharacter)类使其更简单：

```
string input = "ASD@#$123";
string result = Regex.Replace(input, @"\W", "_"); 
```

为了比较，这里是使用 LINQ 完成的相同转换（只允许 ASCII 字母和数字）：

```
string input = "ASD@#$123";
string result =
    new string(input.Select(c => 
        c >= 'A' && c <= 'Z' || c >= 'a' && c <= 'z' || c >= '0' && c <= '9' ? c : '_'
    ).ToArray()); 
```

或者，如果`Char.IsLetterOrDigit`满足您的要求：

```
string input = "ASD@#$123";
string result = 
    new string(input.Select(c => char.IsLetterOrDigit(c) ? c : '_').ToArray()); 
```

请注意，这`Char.IsLetterOrDigit`将允许非 ASCII 字母，并且与`\w`我们在第二个示例中使用否定的单词字符类相当。

**编辑**：正如 Steve Wortham 所观察到的，LINQ 版本实际上比正则表达式快 3 倍以上（即使`Regex`实例是预先创建并重`RegexOptions.Compiled`用的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:05:47.660

```
char[] unwanted = new[] {'@', '#', '$'};

foreach(var x in query)
{
    x.SomePropertyName = string.Join("_", x.SomePropertyName.Split(unwanted));
}; 
```

[LINQ lambda 表达式替换字符串中的多个字符](https://stackoverflow.com/questions/3709924/linq-lambda-expression-to-replace-multiple-characters-in-a-string)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:10:38.420

这是适合您的功能：

```
 String ReplaceWrongChars(String baseString)
    {
        Regex rx = new Regex("[^A-Za-z0-9 ]", RegexOptions.CultureInvariant);
        String rv = rx.Replace(baseString, "_");

        return rv;
    } 
```

如果您不需要包含空格，请使用“[^A-Za-z0-9]”作为正则表达式。

# ruby-on-rails - Windows 7 上的 Pik 不记得选择

> ID：10607114
> 
> 赞同：6
> 
> 时间：2012-05-15T18:58:57.410
> 
> 标签：ruby-on-rails, ruby, pik

我`pik`在 Windows 7 上使用。我无法`pik`记住 ruby​​ 版本选择。

例子：

**命令窗口 1**

```
> pik list
* 187: ruby 1.8.7 (2011-02-18 patchlevel 334) [i386-mingw32]
  192: ruby 1.9.2p290 (2011-07-09) [i386-mingw32]
  193: ruby 1.9.3p125 (2012-02-16) [i386-mingw32] 
```

我选择版本 193。

```
>pik 193
>pik list
  187: ruby 1.8.7 (2011-02-18 patchlevel 334) [i386-mingw32]
  192: ruby 1.9.2p290 (2011-07-09) [i386-mingw32]
* 193: ruby 1.9.3p125 (2012-02-16) [i386-mingw32] 
```

现在我启动另一个命令窗口：

**命令窗口 2**

```
> pik list
* 187: ruby 1.8.7 (2011-02-18 patchlevel 334) [i386-mingw32]
  192: ruby 1.9.2p290 (2011-07-09) [i386-mingw32]
  193: ruby 1.9.3p125 (2012-02-16) [i386-mingw32] 
```

在新窗口中，不会记住红宝石选择。如何`pik`在命令窗口会话中保持 ruby​​ 选择？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T19:44:50.517

当您打开新的命令提示符时，不会加载 Pik。正因为如此，它无法为新窗口*默认*使用某些 Ruby 解释器。

要在 PATH 中拥有一个特定的 Ruby 解释器，您需要修改您的用户或系统 PATH 以便它始终可用。

稍后您可以使用 Pik 将 Ruby 的版本更改为您想要的版本。

但是，您可以设置一个*默认*的Ruby，以便您可以`pik default`使用它。请参阅`pik help use`文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:15:55.200

我很确定 pik 默认为您的系统变量`Ruby`中定义的那个。`Path`

因此，要更改默认值`Ruby`，您需要将系统`Path`变量更改为您首选的`Ruby`.

# firefox - mediaelement.js 全屏按钮在 Firefox 中弹出

> ID：10607123
> 
> 赞同：2
> 
> 时间：2012-05-15T18:59:34.017
> 
> 标签：firefox, fullscreen, mediaelement.js

这是一个链接：[http ://ericbrockmanwebsites.com/dev/reels/documentary-drama-reel/](http://ericbrockmanwebsites.com/dev/reels/documentary-drama-reel/)

在您点击播放之前很好，然后全屏按钮会弹出并位于播放器下方。

提前感谢您的任何见解！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T15:40:33.820

您可能会在这篇文章中找到解决方案： [mediaelement.js 中的控件大小如何](https://stackoverflow.com/questions/10504557/how-are-controls-sized-in-mediaelement-js)

您只需关闭“autosizeProgress”并以正确的方式调整大小。

# sql - 连接到我的远程 SqlServer 数据库

> ID：10607129
> 
> 赞同：0
> 
> 时间：2012-05-15T18:59:52.730
> 
> 标签：sql, sql-server, database, connection

我目前正在制作一个 wpf Windows 应用程序，它从数据库中提取数据，因此我需要设置与远程服务器 SQL Server 数据库的连接。现在我遇到了几个错误。当我首先尝试使用管理工作室连接到我的远程服务器 Sql Server 时，只是为了测试我是否真的可以建立连接，我收到以下错误。

与服务器成功建立连接，但在登录过程中出现错误。（提供者：命名管道提供者，错误：0 - 管道的另一端没有进程。）（Microsoft SQL Server，错误：233）

当然，我确实尽了最大努力进行研究，我发现了一些关于允许 SqlBrowser 在防火墙属性中的事情，做到了...允许通过 Windows 防火墙连接到端口 1433 和端口 1434，两者都做到了. 有什么我想念或没有做的吗？

它还说“与服务器成功建立连接”，这意味着它能够连接，但某处出现问题。还有它说“登录过程中发生错误”是否仅仅意味着我输入了错误的凭据？我的意思是，在安装 SQLExpress 时，我选择了 Windows 身份验证，所以我从来没有真正得到用户名和密码，所以我只使用了我用来连接到我的服务器本身的管理员帐户的用户名和密码。不知道这可能与我的登录有关。即使我启用了 TCP 连接并允许 SqlBrowser，任何人都可以指出我为什么会收到该错误的正确方向。任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:22:45.980

这是一个与证书相关的错误错误，可能是由不同的操作系统/环境差异引起的。如果这是出于测试目的，我会禁用证书，或者[您可以在此处对其进行配置](http://technet.microsoft.com/en-us/library/cc754841.aspx#BKMK_managelocal)（如果您正在创建一个真正的应用程序而不只是玩弄它，这可能是一个好主意）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T14:21:27.437

请通过创建新 id 来运行 sql 服务和代理服务，并使用 ea admin 或其他任何方式启动服务。

即使您修复了端口，检查 telnet 配置并通过它启用/打开端口，端口错误仍将继续显示。

我有类似的问题，所以我创建了一个安装 sql server2008 r2 的虚拟服务器，然后启动它工作正常。

由于我们通过格式化重用服务器，因此存在错误和身份验证问题的可能性。

# android - Galaxy Nexus: Sensor Sampling Rate becomes faster when sampling more Sensors

> ID：10607137
> 
> 赞同：2
> 
> 时间：2012-05-15T19:00:22.590
> 
> 标签：android, performance, android-sensors

I'm trying to read out sensor values as fast as possible from a Samsung Galaxy Nexus (with Android 4.0). For this I did a few experiments using different sensors and sampling rates and figured out a very weird behaviour. When I use only the Acc-Sensor the sampling-rate is about 50Hz. But when I also use the Gyro-Sensor (or magnetic-field-sensor) the sample-rate of the Acc-Sensor increases and both have a sample-rate of between 90 and 100 Hz. A change of the sensor-delay (e.g. from SENSOR_DELAY_FASTEST to SENSOR_DELAY_UI) has no effect on the sampling rate and when I add also the magnetic-field-sensor all three sensors have a high sampling-rate (90-100Hz). Another strange thing is that the values from the three sensors arrive always with the same timestamp (sometimes one has 1 or 2 ms difference, but the other two have exactly the same timestamp). I also tested the same with Android-NDK and there is exactly the same behaviour including that a change of the sampling-rate (using ASensorEventQueue_setEventRate()) has no effect.

A friend of mine tried the same things on a HTC Desire HD (with Android 2.3 and only acc- and magnetic-sensor, since he has no gyro) and there the sampling-rate of the sensors was different from each other and the sampling-rate of the acc-sensor was independent on the use of the magnetic sensor (that's what I would expect as normal behaviour).

Why becomes the acc-sensor faster if other sensors are used additionally? Did someone figure out a similar behaviour? Is this a bug? Or maybe a bug with my code?

Here is the code I used for testing with Android-SDK (I calculate the time it takes for doing 1000 measures on each of the sensors):

```
package de.tum.sdktest;

import java.util.ArrayList;
import android.app.Activity;
import android.hardware.Sensor;
import android.hardware.SensorEvent;
import android.hardware.SensorEventListener;
import android.hardware.SensorManager;
import android.os.Bundle;
import android.util.Log;
import android.widget.TextView;

public class TestSDKActivity extends Activity implements SensorEventListener {

private SensorManager mSensorManager;
private Sensor mAccSensor;
private Sensor mGyroSensor;
private Sensor mMagSensor;

private int accCounter = 0;
private long lastAccTime = 0;

private int gyroCounter = 0;
private long lastGyroTime = 0;

private int magCounter = 0;
private long lastMagTime = 0;

private int measuresPerInterval = 1000;

private ArrayList<Float> accValues;
private ArrayList<Float> gyroValues;
private ArrayList<Float> magValues;

private static final String TAG = "TestSDKActivity";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    accValues = new ArrayList<Float>();
    gyroValues = new ArrayList<Float>();
    magValues = new ArrayList<Float>();

    mSensorManager = (SensorManager)getSystemService(SENSOR_SERVICE);
    mAccSensor = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
    mGyroSensor = mSensorManager.getDefaultSensor(Sensor.TYPE_GYROSCOPE);
    mMagSensor = mSensorManager.getDefaultSensor(Sensor.TYPE_MAGNETIC_FIELD);

    TextView  tv = new TextView(this);
    tv.setText("Hello World!!!");
    setContentView(tv);
}

protected void onResume() {
    super.onResume();
    mSensorManager.registerListener(this, mAccSensor, SensorManager.SENSOR_DELAY_UI);
    mSensorManager.registerListener(this, mGyroSensor, SensorManager.SENSOR_DELAY_UI);
    mSensorManager.registerListener(this, mMagSensor, SensorManager.SENSOR_DELAY_UI);
}

public void onAccuracyChanged(Sensor sensor, int accuracy) {
    // TODO Auto-generated method stub

}

public synchronized void onSensorChanged(SensorEvent event) {

    if(event.sensor.getType() == Sensor.TYPE_ACCELEROMETER)
    {
        if(accCounter == 0 || accCounter == measuresPerInterval)
        {
            String s = String.valueOf("acc: "+(event.timestamp-lastAccTime)/1000000000.0);
            lastAccTime = event.timestamp;
            Log.i(TAG, s);
            accCounter = 0;
            accValues.clear();
        }
        accValues.add(event.values[0]);

        accCounter++;
    }
    else if(event.sensor.getType() == Sensor.TYPE_GYROSCOPE)
    {
        if(gyroCounter == 0 || gyroCounter == measuresPerInterval)
        {
            String s = String.valueOf("gyro: "+(event.timestamp-lastGyroTime)/1000000000.0);
            lastGyroTime = event.timestamp;
            Log.i(TAG, s);
            gyroCounter = 0;
        }
        gyroValues.add(event.values[0]);

        gyroCounter++;
    }
    else if(event.sensor.getType() == Sensor.TYPE_MAGNETIC_FIELD)
    {
        if(magCounter == 0 || magCounter == measuresPerInterval)
        {
            String s = String.valueOf("mag: "+(event.timestamp-lastMagTime)/1000000000.0);
            lastMagTime = event.timestamp;
            Log.i(TAG, s);
            magCounter = 0;
        }
        magValues.add(event.values[0]);

        magCounter++;
    }

} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T17:43:02.363

What you are seeing is a result of the "smart sensor" from Invensense, and is definitely not from a bug in your application level code. It's a bug in the implementation of platform software much lower down in the bowels of this device.

The [Invensense MPU3050 chip on this phone](http://www.ifixit.com/Teardown/Samsung-Galaxy-Nexus-Teardown/7182/2) has a Motion Processing Unit in addition to its MEMs gyroscope. It controls the accelerometer and magnetometer, coalesces the data, runs the [sensor fusion](http://en.wikipedia.org/wiki/Sensor_fusion), and [sends the data back up to Android](http://riansanderson.blogspot.com/2012/03/integrating-sensors-into-android.html), where your app sees it.

From the [MPU3050 datasheet](http://invensense.com/cn/mems/gyro/documents/PS-MPU-3000A-00_v2.5.pdf):

> The embedded Digital Motion Processor (DMP) is located within the MPU-30X0 and offloads computation of motion processing algorithms from the host processor. The DMP acquires data from accelerometers, gyroscopes, and additional sensors such as magnetometers, and processes the data. [..snip...]The purpose of the DMP is to offload both timing requirements and processing power from the host processor

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T08:43:12.667

This is weird. I experienced the same problem too. So I created an App for developer to check this problem [here](https://play.google.com/store/apps/details?id=cn.mountqi.sensor.rate.checker "Sensor Rate Checker").

# php - 有没有办法从网页上的链接打开用户计算机上本地网络上的文件？

> ID：10607138
> 
> 赞同：2
> 
> 时间：2012-05-15T19:00:33.263
> 
> 标签：php, html, file, networking, hyperlink

我正在制作一个将在我的公司企业 Intranet 上运行的 php 页面，该页面将托管在一个域上。我们在本地网络上有可以通过“网上邻居”访问的文件。我希望能够创建一个链接作为网络上文件的快捷方式，就像您在桌面上拥有的快捷方式一样，而不是让链接将其下载到用户的机器上。用户将单击该链接，excel 从其网络位置打开文档。这可能吗？如果可以，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:05:01.107

是的，您将需要完整路径（ unc 路径）

```
<a href="file:\\servername\path\file.doc">get file ( right click 'save target as')</a> 
```

# vbscript - 我需要一个在静音模式和“大声”模式下运行的设置。Installshield快递。似乎不起作用

> ID：10607139
> 
> 赞同：2
> 
> 时间：2012-05-15T19:00:34.707
> 
> 标签：vbscript, installshield

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-12T11:28:14.173

您可以尝试干净安装和维护安装的条件。请找到以下条件：

> 对于全新安装：`Not Installed`在组件或集合或操作上使用条件。
> 
> 对于维护安装：`Installed`在您的组件或集合或操作上使用条件。

# jquery - Function crashing in Internet Explorer

> ID：10607140
> 
> 赞同：0
> 
> 时间：2012-05-15T19:00:47.380
> 
> 标签：jquery, internet-explorer, xml-parsing

That´s all, it simply crashes before showing alert number 1:

```
jQuery.ajax({
                type: "GET",
                url: basePath+'mostrarMenu.do',
                dataType: "html",
                success: parseXml
              });

function parseXml(xml) {
        var menu = jQuery(xml).find("item");
        alert("0");
        menu.each(function(i, value) {
            alert("1");
            var setere = jQuery(value).find("name")[0].innerHTML;
            alert("2");
            if ( setere == '<!--[CDATA[menuDiv]]-->') {
                jQuery('#menuDiv').append(jQuery(value).find("value")[0].innerHTML);
            }
        });

    } 
```

Any help or recommendation would be appreciated, patience with me, I am a zombie at this point of the day.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:04:57.653

您应该调用`$($.parseXML(xmlString))`而不是将 XML 解析为 HTML。

# javascript - 如何刷新加载到现有 Javascript/jQuery 代码中的 Web 部件中的动态内容？

> ID：10607145
> 
> 赞同：0
> 
> 时间：2012-05-15T19:01:09.823
> 
> 标签：javascript, jquery

我有我在下面粘贴的代码，由另一个 Stackoverflow 成员提供。我已将此代码添加到 Kentico Web 部件中，并设置了缓存`minutes=0`，认为这将解决我的缓存问题。可以，但在 IE 中不行。有什么方法可以调整此代码以在用户访问页面时刷新内容，或者当我们必须更新 html 文件时？

```
// article footer
Date.prototype.getWeek = function() {
    var onejan = new Date(this.getFullYear(),0,1);
    var today = new Date(this.getFullYear(),this.getMonth(),this.getDate());
    var dayOfYear = ((today - onejan +1)/86400000);
    return Math.ceil(dayOfYear/7)
};

jQuery(function(){
    //Quotes/Testimonials
    var today = new Date();
    var weekno = today.getWeek();
    jQuery('#quotes-wrapper').load('/quotesroller.html div.quote-'+weekno);         
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:03:31.430

添加一个 cachebust 参数。因为它是一个 GET 请求，所以 IE 很烦人并且总是缓存内容。

```
var time = (new Date()).getTime();
jQuery('#quotes-wrapper').load('/quotesroller.html?_cb=' + time + ' div.quote-'+weekno); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:04:49.423

使用更复杂的功能可能会更好，例如`$.ajax()`如果您想根据每个请求控制缓存。或者，如果您只想将其关闭，请将其放在脚本的顶部：

```
$.ajaxSetup ({
    // Disable caching of AJAX responses
    cache: false
}); 
```

编辑：要仅为此请求设置不缓存，请将您的负载替换为：

```
$.ajax({
    url: '/quotesroller.html div.quote-'+weekno, //that's based on your URL above
    cache: false,
    success: function(result) {
        jQuery('#quotes-wrapper').html(result);
    }
}); 
```

# opencv - JavaCV - 使用 FFmpegFrameGrabber 播放文件时出现奇怪的黑屏

> ID：10607149
> 
> 赞同：0
> 
> 时间：2012-05-15T19:01:26.710
> 
> 标签：opencv, ffmpeg, video-streaming, javacv

我在我的项目中使用 JavaCV，它是 FFmpegFrameGrabber。当我从 Eclipse 启动项目时，它可以加载和播放文件，但是当我运行已编译的项目时显示黑屏或仍然是第一帧。有时会出现此错误：

```
Input #0, avi, from 'C:/path/Start_Cut.avi':
Duration: 00:00:20.03, start: 0.000000, bitrate: 26002 kb/s
Stream #0.0: Video: mpeg4, yuv420p, 1920x1080, 30 tbr, 30 tbn, 30 tbc
Cannot allocate memory. com.googlecode.javacv.FrameGrabber$Exception: Cannot initialize the conversion c ontext.
            at com.googlecode.javacv.FFmpegFrameGrabber.start(FFmpegFrameGrabber.jav a:280) 
```

有时与

```
[mpeg4 @ 6A95DF20] Invalid and inefficient vfw-avi packed B frames detected
Input #0, avi, from 'C:/path/Start_Cut.avi':
  Duration: 00:00:20.03, start: 0.000000, bitrate: 26002 kb/s
    Stream #0.0: Video: mpeg4, yuv420p, 1920x1080 [PAR 1:1 DAR 16:9], 25 tbr, 30
 tbn, 25 tbc 
```

有人知道吗？

**更新：**

我已经能够缩小问题的范围。出于某种原因，FFmpegFrameGrabber 返回 upn`null`调用该`grab()`方法。为什么它可以在 Eclipse 中工作，而不能在独立构建中工作？所有库都包括在内，我想，如果不这样做，它会出现错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T11:21:24.370

升级到 OpenCV 的 2.4.0 版本和 JavaCV 的当前版本就可以了。如果有人遇到同样的情况（这不太可能），只需按照 JavaCV 网站上的说明执行全新安装。

# eclipse - 错误！非静态 Java 函数“replace”的第一个参数不是有效的对象引用

> ID：10607151
> 
> 赞同：11
> 
> 时间：2012-05-15T19:01:34.167
> 
> 标签：eclipse, ant, junit

我试图让 ANT 在 Eclipse 中创建 JUNIT 测试的 HTML 报告，但是在创建 ANT 构建后，运行它时出现以下错误：

```
[junitreport] Processing C:\Documents and Settings\Administrator\workspace\Home\junit\TESTS-TestSuites.xml to C:\DOCUME~1\ADMINI~1\LOCALS~1\Temp\null785926900
[junitreport] Loading stylesheet jar:file:/C:/ANT/apache-ant-1.8.3/lib/ant-junit.jar!/org/apache/tools/ant/taskdefs/optional/junit/xsl/junit-frames.xsl
[junitreport] : Error! The first argument to the non-static Java function 'replace' is not a valid object reference.
[junitreport] : Error! Cannot convert data-type 'void' to 'reference'.
[junitreport] : Fatal Error! Could not compile stylesheet
[junitreport] Failed to process C:\Documents and Settings\Administrator\workspace\Home\junit\TESTS-TestSuites.xml 
```

我需要做什么来解决这个问题？

以下是我尝试运行的 Build.xml 的部分：

```
<target name="Home">
    <mkdir dir="${junit.output.dir}"/>
    <junit fork="yes" printsummary="withOutAndErr">
        <formatter type="xml"/>
        <test name="Home" todir="${junit.output.dir}"/>
        <classpath refid="Home.classpath"/>
    </junit>
</target>
<target name="junitreport">
    <junitreport todir="${junit.output.dir}">
        <fileset dir="${junit.output.dir}">
            <include name="TEST-*.xml"/>
        </fileset>
        <report format="frames" todir="${junit.output.dir}"/>
    </junitreport>
</target> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-05-10T20:43:57.890

当我收到此错误时，我必须在 Eclipse 中右键单击我的 build.xml 文件，选择“Run as Ant build...”选项（菜单中的第 3 个），然后单击 JRE 选项卡并选择“Run in the与工作区相同的 JRE”选项，然后继续运行脚本。由于某种原因，这解决了问题。老实说，我不知道为什么。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-05T16:20:07.373

Eclipse Bug 被清楚地记录在[Bug 384757](https://bugs.eclipse.org/bugs/show_bug.cgi?id=384757)中。分析表明，Oracle 引入了该错误。我需要 Java 版本 7，但 JunitReport 需要 Java 版本 5 和 Java 版本 6 的早期版本。显而易见的方法是将“bootclasspath”参数添加到 Ant junitreport 任务中，而 Java 问题由 Oracle 在未来的版本中修复。不幸的是 Ant 任务 junitreport 不支持 bootclasspath 选项。这是支持蚂蚁的人可以做到的吗？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-03-28T13:28:15.097

**我在Eclipse SDK Juno**上使用 *java 1.7.0_51*在*Ubuntu 12.04*上运行我的 java 程序时遇到了这种情况。我接受 Bhagyaraj 的建议，即使用 apache-ant-1.9.2 代替。（ps Eclipse Juno默认的ant版本是*org.apache.ant_1.8.3*，我用的是apache-ant-1.9.3）

 **您可以按照我的步骤进行设置。

1.  下载 apache-ant-1.9.3-bin.zip 并解压到你想要的地方。
2.  打开你的 Eclipse 并选择 Window --> Preferences
3.  您可以看到“首选项”窗口。在左侧请选择 ant --> runtime
4.  现在关注窗口的右侧位置。确保您现在位于*Classpath*选项卡上并选择**Ant Home Entries(Default)**。右侧的按钮是**Ant Home...**现在可以点击了。
5.  毫无疑问，点击**Ant Home...**按钮并选择您的 ant-1.9.3 所在的文件夹。在这一步中，如果您选择了错误的文件夹，Eclipse 可能会显示错误消息，例如***Specified Ant home does not contain a "lib" directory***。如果选择正确的目录，**Ant Home Entries(Default)**将变为****Ant Home Entries()**
6.  不要忘记点击申请。

更改这些后，当您右键单击 build.xml 文件并选择 Run --> 1 Ant Build 时，将不会显示错误消息，因为您的 ant 现在是 1.9.3。

我还下载了 apache-ant-1.8.4 来运行我的构建文件，但错误无法解决。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-10-25T07:02:05.297

我使用了 jdk1.6.45 和最新的 apache-ant-1.9.2-bin\

问题解决了。

根据 MikeBach 的注释

这是 bug#，请阅读： [https](https://bugs.eclipse.org/bugs/show_bug.cgi?id=384757) ://bugs.eclipse.org/bugs/show_bug.cgi?id= 384757 在 Ant 中已修复。

问候， Bhagyaraj

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-25T14:50:14.703

我尝试使用一些不同的 JRE/JDK 设置（全部为 1.6 和 1.7），但每个设置都有各种问题（这个或无法访问 jar 中的 XSL 文件）。

这显然不是一个完美的解决方案，但如果 JUnit 报告在构建文件中是“原始”的——没有包含在目标中，我似乎不会遇到这些问题。

糟糕的解决方法显然是因为目标是 Ant 的一个重要方面，但有时用于报告构建目标/依赖关系并不是那么关键。这对我来说还不是什么大问题，因为我以一种一次性的方式运行这些报告，而不是作为构建的一部分。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-02T13:08:54.217

[根据此评论，](https://bugs.eclipse.org/bugs/show_bug.cgi?id=384757#c6)该**错误**是在 Java 7u5 中引入的。另一条[评论](https://bugs.eclipse.org/bugs/show_bug.cgi?id=384757#c13)解释了如何解决它，改变*bootclasspath*。（**免责声明**：我没有尝试测试这个。）

 *****但是，此解决方案**对我来说效果很好：

*   下载**ant-1.9.4**
*   Eclipse>>首选项>>Ant>>运行时>>AntHomeEntries
*   删除所有 1.8.x 类路径条目
*   改为添加 1.9.4 中的所有库

根据 Ant [Changes ，](http://svn.apache.org/repos/asf/ant/core/trunk/WHATSNEW)[自 1.9.1 以来](https://issues.apache.org/bugzilla/show_bug.cgi?id=54641)已修复此问题

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-06-08T08:35:02.650

如果您在 JDK 1.7 中使用 Eclipse/JUnit 报告，请使用 JDK 1.6。JDK 1.7 中存在与您描述的类似的 Eclipse/JUnit 报告的错误。这可能是一个类似的报告：[https ://netbeans.org/bugzilla/show_bug.cgi?id=201022](https://netbeans.org/bugzilla/show_bug.cgi?id=201022)*****

# c# - OleDBException 未处理 没有为一个或多个参数提供值

> ID：10607154
> 
> 赞同：0
> 
> 时间：2012-05-15T19:01:40.113
> 
> 标签：c#, ms-access, oledb

我正在尝试从 C# 更新访问数据库中的表。

它是一个 .mdb 类型的数据库。

这是我正在使用的连接字符串。 `public MainWindow() {`

```
InitializeComponent();

OleDbConnection cn= new OleDbConnection();}
cn.ConnectionString=@"Provider=Microsoft.Jet.OLEDB.4.0;DataSource=" 
    + "C:\Users\Angela\Documents\Visual Studio 2010\Projects\Havnefoged11.mdb;" 
    + "User Id=;Password=;";

cn.Open();

Application.Current.Properties["DBConnection"] = cn; 
```

该文件位于正确的文件夹 C:\Users\Angela\Documents\Visual Studio 2010\Projects

```
 private void button1_Click_1(object sender, RoutedEventArgs e)
    {

 OleDbConnection conn =             

 (OleDbConnection)Application.Current.Properties["DBConnection"];
 //Below are the values i want to put into the database 
 String dybde = Dybde.Text;
 String bredde = Bredde.Text;
 String plads = PladsNummer.Text;

String StrSQL = 
    "INSERT INTO Bådpladser (Plads_nummer,Bredde,Dybde) VALUES (´´"+ plads
        + "´,´" 
        + bredde
        + "´," 
        + dybde+");";

  OleDbCommand InsertCommand = new OleDbCommand(StrSQL, conn);

   InsertCommand.ExecuteNonQuery();
    } 
```

然后我得到错误 OleDBException is unhandled NO value given for one or more parameters

我已经进入并将数据库中的所有字段更改为文本我已经检查了它们是否正确的字段名称。ldb 文件在我初始化程序时出现。但是一旦我按下按钮，我就会得到错误。

有任何想法吗？

Ps 我已经包括了

```
 using System.Data;
   using System.Data.OleDb; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:05:25.300

你`StrSQL`看起来有点可疑。您能否在执行之前显示该字符串的值？我猜撇号和/或引号有点混淆了。

```
String StrSQL = "INSERT INTO Bådpladser (Plads_nummer,Bredde,Dybde) VALUES (´´"+ plads +"´,´"+bredde+"´,"+dybde+");"; 
```

作为黑暗中的刺，试试这个：

```
string StrSQL = string.Format("INSERT INTO Bådpladser (Plads_nummer,Bredde,Dybde) VALUES ('{0}', '{1}', '{2}')", plads, bredde, dybde); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:07:03.627

我注意到了这一点：

```
String StrSQL = "INSERT INTO Bådpladser (Plads_nummer,Bredde,Dybde) VALUES (´´"+ 
                    plads +"´,´"+bredde+"´,"+dybde+");"; 
```

我看到你在 plads 前面有两个撇号。你可能只需要一个。如果您必须将它们作为双撇号转义，那么您可能会在每个逗号之后加倍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T19:30:18.297

正如其他人指出的那样，您对 SQL 注入攻击持开放态度。你应该使用参数。它可能失败的原因是您插入的字符串的内容可能包含“？” 和 ”？” 被暗示为“我在这里期待一个参数”，这就是让它窒息的原因。

尝试更改为

```
String StrSQL = "INSERT INTO Bådpladser (Plads_nummer, Bredde, Dybde ) VALUES ( ?, ?, ? )";
OleDbCommand InsertCommand = new OleDbCommand(StrSQL, conn )
InsertCommand.Parameters.AddWithValue( "yourFirstParm", plads );
InsertCommand.Parameters.AddWithValue( "yourSecondParm", bredde );
InsertCommand.Parameters.AddWithValue( "yourThirdParm", dybde ); 
```

然后，执行它，但注意：参数必须以与“？”相同的顺序添加。占位符。

此外，您的后端可能支持命名参数而不是“？” 价值观......如果是这样，你可能需要调整到类似的东西

```
String StrSQL = "INSERT INTO Bådpladser (Plads_nummer, Bredde, Dybde ) "
      + "VALUES ( @parmPlads, @parmBredde, @parmDybde )";
OleDbCommand InsertCommand = new OleDbCommand(StrSQL, conn )
InsertCommand.Parameters.AddWithValue( "@parmPlads", plads );
InsertCommand.Parameters.AddWithValue( "@parmBredde", bredde );
InsertCommand.Parameters.AddWithValue( "@parmDybde", dybde ); 
```

# android - 防止android webview加载某些url

> ID：10607160
> 
> 赞同：1
> 
> 时间：2012-05-15T19:02:09.113
> 
> 标签：android, performance, webview

我想提高我的 webview 的性能。
目前，我的 webview 正在加载我的应用程序不需要的几个资源，例如 *.css 或 *.jpg。

我如何防止它加载带有扩展名的 url？

我使用 API 7 级。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T20:50:24.133

如果您只需要页面中的文本，您可以抓取 html 并从那里解析出来：

```
 HttpClient httpClient = new DefaultHttpClient();
    HttpContext localContext = new BasicHttpContext();
    String url = "http://www.google.com";

    BufferedReader reader;
    HttpGet httpGet = new HttpGet(url);
    String result = "";

    try {
        HttpResponse response = httpClient.execute(httpGet, localContext);
        reader = new BufferedReader(new InputStreamReader(response.getEntity().getContent()));

        String line = null;
        result = "";
        while ((line = reader.readLine()) != null){
            result += line + "\n";
        }
    } catch(Exception e){}

    // result now contains the html text 
```

或者您甚至可以这样做并重新创建页面，减去 .jpg 和 .css 引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:18:17.187

如果您可以接受 API 11 的要求，您可以实现为具有这些扩展名的 URL[`shouldInterceptRequest`](http://developer.android.com/reference/android/webkit/WebViewClient.html#shouldInterceptRequest%28android.webkit.WebView,%20java.lang.String%29)返回某种空值。[`WebResourceResponse`](http://developer.android.com/reference/android/webkit/WebResourceResponse.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:54:10.437

```
myWebView.setWebViewClient(new MyWebViewClient());
protected class MyWebViewClient extends WebViewClient {
@Override
public boolean shouldOverrideUrlLoading(WebView view, String url) {
   String ext = MimeTypeMap.getFileExtensionFromUrl(url);
   if (ext.eq..... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-20T05:48:50.667

防止android webview加载某些url

您必须检查加载 url 是否相等，如果不是，请不要加载 webviw

MainActivity.Java

```
import android.app.AlertDialog;
import android.app.ProgressDialog;
import android.content.Context;
import android.content.Intent;
import android.graphics.Bitmap;
import android.support.v7.app.AppCompatActivity;
import android.os.Bundle;
import android.support.v7.widget.Toolbar;
import android.util.Log;
import android.view.MenuItem;
import android.view.View;
import android.webkit.WebResourceError;
import android.webkit.WebResourceRequest;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import android.widget.ImageView;
public class MainActivity extends AppCompatActivity implements View.OnClickListener {
    private static final String TAG = "WebActivity";
    private Context mContext;
    WebView webview;
    Toolbar toolbar;
    ImageView mBackResource;
    Boolean progress = true;
    private boolean isRedirected = true;
    String urlintent;
    public static ProgressDialog pDialog;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_webview);
        mContext = MainActivity.this;
        urlintent = "https://www.google.co.in";
        WebView wv = (WebView) findViewById(R.id.webView);
        mBackResource = (ImageView) findViewById(R.id.backarrowwufoo);
        mBackResource.setOnClickListener(this);
        toolbar = (Toolbar) findViewById(R.id.toolbar);
        wv.setScrollBarStyle(WebView.SCROLLBARS_OUTSIDE_OVERLAY);
        wv.loadUrl(urlintent);
        wv.setWebViewClient(new WebViewClient() {
            @Override
            public boolean shouldOverrideUrlLoading(WebView view, String url) {
                Log.e(TAG, "url check" + url + "intent" + urlintent);
                if (url.equals(urlintent)) {
                    Log.e(TAG, "url check" + url + "intent" + urlintent);
                    //Load your page if it equals
                    view.loadUrl(url);
                    return false; // let me handle this!
                } else {
                    //Do not load your page if it is not equals
                    return true; // no need to use loadUrl!
                }
            }
            @SuppressWarnings("deprecation")
            @Override
            public void onReceivedError(WebView view, int errorCode, String description, String failingUrl) {
                // Handle the error
                if (errorCode == -2 || errorCode == -8) {
                    view.loadUrl("file:///android_asset/error.html");
                }
                if (errorCode == -14) {
                    view.loadData("Page cannot be found on server", "text/html", "UTF-8");
                }
            }
            @TargetApi(android.os.Build.VERSION_CODES.M)
            @Override
            public void onReceivedError(WebView view, WebResourceRequest req, WebResourceError rerr) {
                // Redirect to deprecated method, so you can use it in all SDK versions
                onReceivedError(view, rerr.getErrorCode(), rerr.getDescription().toString(), req.getUrl().toString());
            }
            @Override
            public void onPageStarted(WebView view, String url, Bitmap favicon) {
                // TODO Auto-generated method stub
                super.onPageStarted(view, url, favicon);
                //          Log.d("onPageStarted", "onPageStarted:" + url );
                if (isRedirected) {
                    if (progress) {
                        progress = false;
                        showProgres(mContext);
                    }
                    isRedirected = false;
                }
            }
            @Override
            public void onLoadResource(WebView view, String url) {
                super.onLoadResource(view, url);
                //    Log.v(TAG, "onLoadResource url: " + url);
            }
            @Override
            public void onPageFinished(WebView view, String url) {
                // TODO Auto-generated method stub
                super.onPageFinished(view, url);
                //            Log.d("onPagefinished", "onPagefinished:" + url );
                if (!isRedirected) {
                    //Do something you want when finished loading
                    isRedirected = true;
                    if (!progress) {
                        hidepDialog();
                        progress = true;
                    }
                }
            }
        });
    }
    @Override
    public void onClick(View v) {
        switch (v.getId()) {
            case R.id.backarrowwufoo:
                onBackPressed();
                break;
        }
    }
    @Override
    protected void onDestroy() {
        super.onDestroy();
        if (!progress) {
            hidepDialog();
            progress = true;
        }
    }
    public static void showProgres(Context context) {
        pDialog = new ProgressDialog(context);
        pDialog.setMessage("Please wait...");
        pDialog.setCancelable(false);
        showpDialog();
    }
    public static void showpDialog() {
        if (!pDialog.isShowing())
            pDialog.show();
    }
    public static void hidepDialog() {
        if (pDialog.isShowing())
            pDialog.dismiss();
    }

} 
```

活动主：

```
<?xml version="1.0" encoding="utf-8"?>
<android.support.design.widget.CoordinatorLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/main_content"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@android:color/white"
    android:fitsSystemWindows="true">
    <android.support.design.widget.AppBarLayout
        android:id="@+id/appbar"
        android:layout_width="match_parent"
        app:elevation="0dp"
        android:layout_height="wrap_content"
        android:theme="@style/ThemeOverlay.AppCompat.Dark.ActionBar">
        <android.support.v7.widget.Toolbar xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@+id/toolbar"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:background="@color/colorPrimaryDark"
            android:minHeight="?attr/actionBarSize">
            <RelativeLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:paddingRight="10dp">
                <ImageView
                    android:id="@+id/backarrowwufoo"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_alignParentLeft="true"
                    android:layout_gravity="center"
                    android:scaleType="center"
                    android:padding="14dp"
                    android:src="@drawable/ic_arrow"
                    android:gravity="center" />
            </RelativeLayout>
        </android.support.v7.widget.Toolbar>
    </android.support.design.widget.AppBarLayout>
    <WebView
        android:id="@+id/webView"
        android:layout_width="match_parent"
        app:layout_behavior="@string/appbar_scrolling_view_behavior"
        android:padding="10dp"
        android:layout_height="match_parent" />
</android.support.design.widget.CoordinatorLayout> 
```

# entity-framework - Entity Framework 4.3 CF 多对多关系保存对象？

> ID：10607163
> 
> 赞同：2
> 
> 时间：2012-05-15T19:02:31.360
> 
> 标签：entity-framework, many-to-many, entity-framework-4.3, savechanges

使用 EF 4.3 代码优先方法创建多对多关系时，我无法将数据保存到连接表，也无法使用将对象保存到 Icollection 来填充此表的任何示例...这是我的示例：

**楷模**

```
public class Hospital
{
    //PK
    [Key]
    public int Id { get; set; }

    public string Name { get; set; }
    public string Address { get; set; }
    public string City { get; set; }
    public string County { get; set; }
    public string UserName { get; set; }
    public string Password { get; set; }
    public Guid User_Id { get; set; }

    //FK
    public virtual ICollection<Operator> Operators { get; set; }

}

public class Operator
{
    //PK
    [Key]
    public int Id { get; set; }

    public string FirstName { get; set; }
    public string LastName { get; set; }
    public DateTime Dob { get; set; }
    public string Email { get; set; }

    //FK
    public virtual ICollection<Hospital> Hospitals { get; set; }
}

public class Project: DbContext
{
    public DbSet<Hospital> Hospitals { get; set; }
    public DbSet<Operator> Operators { get; set; }
} 
```

**控制器**

```
public void AddOperater()
{

    Hospital h = new Hospital();
    h = db.Hospitals.Single(a=>a.Id ==1);

    var o = new Operator();
    o.FirstName = "John";
    o.LastName = "Doe";
    o.Dob = new DateTime(1988,2,12);
    o.Email = "johndoe@gmail.com";
    o.Hospitals.Add(h);

    db.SaveChanges();
 } 
```

使用这种方法，我在这里不断收到错误：`o.Hospitals.Add(h);`即使我的 Hospital 实例充满了数据。如何准确地将数据保存到两个表中，`dbo.Operators`哪个`dbo.OperatorHospital`是关系表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:10:57.220

o.Hospitals.Add(h) 将失败，因为该列表是一个空列表。您不能在空列表上调用 Add()。通常，大多数人通过在实体的构造函数中实例化列表来解决这个问题......就像这样......由于 CSharp 问题，当前行正在爆炸。

```
public class Hospital
{
    //PK
    [Key]
    public int Id { get; set; }

    public string Name { get; set; }
    public string Address { get; set; }
    public string City { get; set; }
    public string County { get; set; }
    public string UserName { get; set; }
    public string Password { get; set; }
    public Guid User_Id { get; set; }

     //FK
    public virtual ICollection<Operator> Operators { get; set; }

    public Hospital()
    {
         Operators = new List<Operator>();
    }

}

public class Operator
{
   //PK
   [Key]
   public int Id { get; set; }

   public string FirstName { get; set; }
   public string LastName { get; set; }
   public DateTime Dob { get; set; }
   public string Email { get; set; }

   //FK
   public virtual ICollection<Hospital> Hospitals { get; set; }

   public Operator()
   {
       Hospitals = new List<Hospital>();
   } 
```

}

# android - Android - 在主屏幕上设置图像？

> ID：10607167
> 
> 赞同：2
> 
> 时间：2012-05-15T19:03:03.553
> 
> 标签：android

我想在我的应用程序运行时在主屏幕上设置图像，例如破解屏幕应用程序（例如：[https](https://play.google.com/store/apps/details?id=mk.g6.crackyourscreen&hl=en) ://play.google.com/store/apps/details?id=mk.g6.crackyourscreen&hl=en ）以实现某些目标。

我相信这与这些权限有关；显示系统级警报 显示未经授权的窗口

但我找不到一个例子、教程或任何关于它的文章？

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:10:08.210

您应该能够通过设置透明活动来做到这一点。就此而言，您可以让您的活动使用半透明主题，如下所示（将其放在清单中）：

```
<activity android:theme="@android:style/Theme.Translucent.NoTitleBar"> 
```

（[来源](http://developer.android.com/guide/topics/ui/themes.html)）

# spring - 使用 Spring 和 Jersey 测试框架进行单元测试

> ID：10607168
> 
> 赞同：9
> 
> 时间：2012-05-15T19:03:04.473
> 
> 标签：spring, unit-testing, junit, jersey

我正在使用 JerseyTest 为 RESTful Web 服务编写一些基于 JUnit 的集成测试。JAX-RS 资源类使用 Spring，我目前正在将所有内容与测试用例连接在一起，如下面的代码示例：

```
public class HelloResourceTest extends JerseyTest
{
    @Override
    protected AppDescriptor configure()
    {
        return  new WebAppDescriptor.Builder("com.helloworld")
        .contextParam( "contextConfigLocation", "classpath:helloContext.xml")
        .servletClass(SpringServlet.class)
        .contextListenerClass(ContextLoaderListener.class)
        .requestListenerClass(RequestContextListener.class)
        .build();        
    }

    @Test
    public void test()
    {
        // test goes here
    }
} 
```

这适用于连接 servlet，但是，我希望能够在我的测试用例中共享相同的上下文，以便我的测试可以访问模拟对象、DAO 等，这似乎需要 SpringJUnit4ClassRunner。不幸的是，SpringJUnit4ClassRunner 创建了一个单独的并行应用程序上下文。

那么，任何人都知道如何创建一个在 SpringServlet 和我的测试用例之间共享的应用程序上下文？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-07-03T11:24:35.067

像这样覆盖 JerseyTest.configure：

```
@Override
protected Application configure() {
  ResourceConfig rc = new JerseyConfig();

  rc.register(SpringLifecycleListener.class);
  rc.register(RequestContextFilter.class);

  rc.property("contextConfigLocation", "classpath:helloContext.xml");
  return rc;
} 
```

对我来说，SpringServlet 不是必需的，但如果您需要，您也可以为此调用 rc.register。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-24T13:31:30.077

我找到了几种方法来解决这个问题。

首先，在**geek@riffpie**博客上，有一个很好的描述这个问题以及一个优雅的扩展`JerseyTest`来解决它： [Unit-testing RESTful Jersey servicesglue together with Spring](http://geek.riffpie.com/unit-testing-restful-jersey-services-glued-together-with-spring/)

不幸的是，我正在使用更新版本的 Spring 和/或 Jersey（忘记哪个）并且不能完全让它工作。

就我而言，我最终通过放弃 Jersey 测试框架并使用嵌入式 Jetty 和 Jersey 客户端来避免这个问题。无论如何，这实际上在我的情况下更有意义，因为我已经在我的应用程序中使用了嵌入式 Jetty。 **yves amsellem**有一个很好的[使用 Jersey 客户端和嵌入式 Jetty 进行单元测试的](https://github.com/yamsellem/jongo-jersey/blob/master/src/test/java/org/jongo/jersey/resource/ProductResourceTest.java)例子。对于 Spring 集成，我使用了**Trimbo 的** [Jersey Tests 与 Embedded Jetty 和 Spring的变体](http://trimbo.blogspot.com/2012/05/jersey-tests-with-embedded-jetty-and.html)

# java - Nightmare Class - 花车/弦乐

> ID：10607171
> 
> 赞同：-3
> 
> 时间：2012-05-15T19:03:12.497
> 
> 标签：java, class

这是我负责新项目条目的班级，从一开始它就是一场彻头彻尾的噩梦，我似乎无法解决我面临的问题：

Item 中的 setStock(float) 不能应用于 ()

条目输入：

```
private void writeItemRecord()
         {
             // Check to see if we can connect to database table
             if ( DataBaseHandler.makeConnectionToitemDB() == -1)
               {
                   JOptionPane.showMessageDialog (frame, "Unable to connect to database table (Item)");
               }
             else  // Ok, so first read data from the text fields
               {
                   // Read data from form and store data     

                   String Itemname = ItemnameTxtField.getText();
                   String Itemcode = ItemcodeTxtField.getText();
                   String Description = DescriptionTxtField.getText();
                   String Unitprice = UnitpriceTxtField.getText();
                   String Style = StyleTxtField.getText();
                   String Finish = FinishTxtField.getText();
                   String Stock = StockTxtField.getText();

                   // Convert priceStr to a float
                   Float fvar = Float.valueOf(Unitprice);
                   float price = fvar.floatValue();

                   Float svar = Float.valueOf(Stock);
                   float stock = svar.floatValue();

                   // Create a Item oject
                   Item Item = new Item();

                   // Set the attributes for the Item object

                   Item.setItemname (Itemname);
                   Item.setItemcode (Itemcode);
                   Item.setDescription (Description);
                   Item.setUnitprice (price);
                   Item.setStock(stock);
                   Item.setStyle(Style);
                   Item.setFinish(Finish);

                   // Write Item record.  Method writeToItemTable() returns
                   // 0 of OK writing record, -1 if there is a problem.  I store
                   // the returned value in a variable called error.
                   int error = DataBaseHandler.writeToItemTable(Item.getItemname(),
                                                                Item.getItemcode(),
                                                                Item.getDescription(),
                                                                Item.getUnitprice(), 
                                                                Item.setStock(),
                                                                Item.setStyle(Style),
                                                                Item.setFinish(Finish),
                                                                Item.setSuppliercode(Suppliercode),
                                                                Item.setSuppliername(Suppliername),
                                                                Item.setAddress(Address)
                                                                );

                   // Check if there is a problem writing the record, in 
                   // which case error will contain -1                                         
                   if (error == -1)
                     {
                         JOptionPane.showMessageDialog (frame, "Problem writing record to Item Table");
                     }

                  // Clear the form - actual method is coded below
                  clearForm();

                  // Close database connection.  Report an error message
                  // if there is a problem.
                  if ( DataBaseHandler.closeConnection() == -1 )
                     {
                         JOptionPane.showMessageDialog (frame, "Problem closing data   base conection");
                     }
                }

         }  // End 
```

任何帮助深表感谢！

和项目提取：

```
public void setStock(float StockIn)
  {
      Stock = StockIn;
  }   

public float getStock()
  {
     return Stock;
  } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T19:09:14.533

对于初学者，请遵守 Java 命名约定。除了类/接口名称外，其他任何东西都不允许使用 CamelCase。使用 lowerCamelCase。至于你的“问题”，你写道

```
Item.setStock(), 
```

所以很明显它给了你错误。它还为您提供了错误的确切行号，这显然有助于我们诊断您的问题。

解决方案：使用 Item.getStock() （我想，这很难说）。无论如何，在该位置调用 Item.setStock（作为方法调用的参数）是没有意义的，因为 setStock 是一个 void 方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T19:08:45.267

Java 编译器错误带有行号 - 请注意它。这是你的问题：

```
Item.setStock() 
```

`setStock()`需要一个参数，您试图在没有参数的情况下调用它。也许你的意思是`getStock()`？而且我怀疑所有对参数列表中设置方法的调用`writeToItemTable`也是错误的，因为这些设置方法将具有`void`返回值，所以你不能那样使用它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T19:08:21.647

该`setStock`方法如下所示：

```
public void setStock(float StockIn) 
```

要调用它，您需要传递一个浮点数作为参数。在您的代码中的某处，您调用该方法，如下所示：

```
Item.setStock(), 
```

该方法需要使用 float 参数调用，而是使用 none 调用，因此您会看到编译错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T19:08:51.043

在这段代码中：

```
int error = DataBaseHandler.writeToItemTable(Item.getItemname(),
                                             Item.getItemcode(),
                                             Item.getDescription(),
                                             Item.getUnitprice(), 
                     // Right here -->       Item.setStock(),
                                             Item.setStyle(Style),
                                             Item.setFinish(Finish),
                                             Item.setSuppliercode(Suppliercode),
                                             Item.setSuppliername(Suppliername),
                                             Item.setAddress(Address)
                                             ); 
```

请注意，您正在调用`Item.setStock()`,`Item.setStyle(Style)`等而不是`Item.getStock()`,`Item.getStyle()`等。这可能是您的问题的根源 - 您尝试`setStock()`不带参数调用该方法，因此出现错误。

希望这可以帮助！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-05-15T19:08:54.747

这条线

```
// Create a Item oject
               Item Item = new Item(); 
```

是有问题的。在 Java 中为变量使用大写名称不仅是不好的风格，而且这个特定的实例会导致编译错误。此外，您在`setStock`没有参数的情况下调用。你也需要解决这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-05-15T19:10:34.303

这是您的错误：

```
int error = DataBaseHandler.writeToItemTable(Item.getItemname(),
    Item.getItemcode(),
    Item.getDescription(),
    Item.getUnitprice(), 
    Item.setStock(), // <<< here! should be getStock()
    Item.setStyle(Style),
    Item.setFinish(Finish),
    Item.setSuppliercode(Suppliercode),
    Item.setSuppliername(Suppliername),
    Item.setAddress(Address)); 
```

但同样...考虑命名/编码约定。

# objective-c - @property 赋值

> ID：10607172
> 
> 赞同：3
> 
> 时间：2012-05-15T19:03:12.727
> 
> 标签：objective-c, ios

如果“分配”是默认值，我可以将其留空并使其分配吗？

```
@property BOOL sample; 
```

如果我定义了它的原子性然后将其留空怎么办？

```
@property (nonatomic) BOOL sample; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T19:07:00.727

是的，如果没有另外指定，则使用默认值。但是，在属性定义中明确是一种很好的做法。第三方更容易了解正在发生的事情，和/或知道应该发生的事情。此外，实施细节将来可能会发生变化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T19:07:53.290

是的你是对的：

```
@property BOOL sample; 
```

相当于：

```
@property (atomic, assign) BOOL sample; 
```

但是当然， atomic 不是一个存在的属性，所以不要使用它:)

# php - 模拟/存根在 PHPUnit 中实现数组访问的类的对象

> ID：10607173
> 
> 赞同：8
> 
> 时间：2012-05-15T19:03:13.740
> 
> 标签：php, phpunit, arrayaccess

这是我正在为其编写测试套件的类的构造函数（它扩展了 mysqli）：

```
function __construct(Config $c)
{
    // store config file
    $this->config = $c;

    // do mysqli constructor
    parent::__construct(
        $this->config['db_host'],
        $this->config['db_user'],
        $this->config['db_pass'],
        $this->config['db_dbname']
    );
} 
```

`Config`传递给构造函数的类实现了`arrayaccess`php内置的接口：

```
class Config implements arrayaccess{...} 
```

如何模拟/存根`Config`对象？我应该使用哪个，为什么？

提前致谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-05-15T23:32:51.343

`Config`如果您可以轻松地从数组创建实例，那将是我的首选。虽然您想在可行的情况下单独测试您的单元，但简单的协作者（例如）`Config`应该足够安全以在测试中使用。设置它的代码可能比等效的模拟对象更容易读写（不易出错）。

```
$configValues = array(
    'db_host' => '...',
    'db_user' => '...',
    'db_pass' => '...',
    'db_dbname' => '...',
);
$config = new Config($configValues); 
```

话虽如此，你模拟一个对象的实现[`ArrayAccess`](http://php.net/manual/en/class.arrayaccess.php)就像你模拟任何其他对象一样。

```
$config = $this->getMock('Config', array('offsetGet'));
$config->expects($this->any())
       ->method('offsetGet')
       ->will($this->returnCallback(
           function ($key) use ($configValues) {
               return $configValues[$key];
           }
       ); 
```

您还可以使用`at`来强制执行特定的访问顺序，但是这样会使测试变得非常脆弱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-07-29T16:33:23.310

问这个问题 8 年后，第一次回答这个问题 5 年后，我有同样的问题并得出了类似的结论。这就是我所做的，这与大卫接受的答案的第二部分基本相同，只是我使用的是更高版本的 PHPUnit。

基本上你可以模拟`ArrayAccess`接口方法。只需要记住你可能想要同时模拟`offsetGet`和`offsetExists`（你应该在使用之前检查数组键是否存在，否则`E_NOTICE`如果它不存在，你可能会在代码中遇到错误和不可预知的行为）。

```
 $thingyWithArrayAccess = $this->createMock(ThingyWithArrayAccess::class);

$thingyWithArrayAccess->method('offsetGet')
     ->with('your-offset-here')
     ->willReturn('test-value-1');

$thingyWithArrayAccess->method('offsetExists')
     ->with($'your-offset-here')
     ->willReturn(true); 
```

当然，您可以在测试中使用真正的数组，例如

```
 $theArray = [
    'your-offset-here-1' => 'your-mock-value-for-offset-1',
];

$thingyWithArrayAccess = $this->createMock(ThingyWithArrayAccess::class);

$thingyWithArrayAccess->method('offsetGet')
     ->willReturnCallback(
          function ($offset) use ($theArray) {
              return $theArray[$offset];
          }
     );

$thingyWithArrayAccess->method('offsetExists')
     ->willReturnCallback(
          function ($offset) use ($theArray) {
              return array_key_exists($offset, $theArray);
          }
     ); 
```

# button - 如何创建“新”闪烁按钮？

> ID：10607180
> 
> 赞同：0
> 
> 时间：2012-05-15T19:03:38.030
> 
> 标签：button, web, animated

如果这是一个菜鸟问题，我真诚地道歉，但是我对 Web 开发非常陌生，并且想向社区寻求一些帮助和建议，以在网站上创建一种闪烁的“新”按钮。

我想要实现的是一个醒目的例如“新产品”按钮。

任何人都可以为我指出一个很好的 asp .net、JavaScript 或 jquery 教程。

在此先感谢和亲切的问候， geoNeo

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:07:57.923

除了在您的网站上闪烁的不良 UI 设计方面之外，您还可以创建一个闪烁按钮的动画 GIF 图像，然后`onclick`在用户单击该按钮时使用该事件将他们重定向到您的下一页。

对于动画 GIF，我建议让它闪烁几次，然后在更长的时间内保持稳定，然后循环播放动画。这样一来，您就可以引起用户的注意，但以一种更微妙的方式。

# c++ - 调用虚函数：比较基引用和派生引用调用？

> ID：10607182
> 
> 赞同：2
> 
> 时间：2012-05-15T19:04:05.057
> 
> 标签：c++, gcc, polymorphism

给定一个带有虚函数 f 的基类 B、一个派生类 D 和它自己的 f 实现，这是我的场景：

1.  `B& b = *new D; b.f();`
2.  `D& d = *new D; d.f();`

项目符号 1 中的代码是否涉及从 vtable 获取 f 的地址然后跳转？清单 2 中的代码是否涉及任何 vtable 查找？

我知道这些可能取决于编译器，并且标准可能不会指定实现细节。在这种情况下，如果了解 GCC 或 CLANG 如何处理这些情况的人提供解释，我将不胜感激。

谢谢。

编辑：请剪切粘贴您的汇编器输出；我仍然不确定为什么在第二种情况下应该在 vtable 中进行任何查找。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:20:13.420

来自维基：

> C++ 标准并没有明确规定必须如何实现动态调度，但编译器通常在相同的基本模型上使用微小的变化。通常，编译器为每个类创建一个单独的 vtable。

编译器将为每个包含函数的类创建一个 vtable [，](http://www.learncpp.com/cpp-tutorial/125-the-virtual-table/)`virtual`如下所述：

> 每个使用虚函数的类（或派生自使用虚函数的类）都有自己的虚表。该表只是编译器在编译时设置的静态数组。一个虚拟表包含一个条目，对应于类对象可以调用的每个虚拟函数。此表中的每个条目只是一个函数指针，它指向该类可访问的最衍生函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T19:09:13.647

这是一个虚拟方法调用。在这两种情况下，都必须在运行时进行 vtable 查找。

编译器无法知道在对构造函数的调用和对函数的调用之间是否发生了某些事情，这可能已经修改了 b 和 d 并将它们的实际类型更改为其他内容。

标准是怎么说的：

> 2 如果在Base类和Derived类中声明了一个虚成员函数vf，直接或间接从Base派生，一个同名的成员函数vf，parameter-type-list (8.3.5)，和cv-qualification由于 Base::vf 被声明，那么 Derived::vf 也是虚拟的（无论是否如此声明）并且它覆盖 Base::vf。为方便起见，我们说任何虚函数都会覆盖自身。然后在任何格式良好的类中，对于在该类或其任何直接或间接基类中声明的每个虚函数，都有一个唯一的最终覆盖器覆盖该函数和该函数的所有其他覆盖器。成员查找规则 (10.2) 用于确定派生类范围内的虚函数的最终覆盖器，但忽略使用声明引入的名称。
> 
> 7 [注：虚函数调用的解释取决于被调用对象的类型（动态类型），而非虚成员函数调用的解释仅取决于对象的类型表示该对象的指针或引用（静态类型）（5.2.2）。——尾注]

这并没有强制要求它是如何完成的，但非常清楚地表明调用必须在调用时根据对象的实际类型来解析。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T19:11:22.847

标准方法是使用 vtable。只有好的或非常聪明的编译器才会优化它。

查看编译器的汇编结果以了解答案。大多数时候（如果不是一直）有一个 vtable 访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T19:12:28.270

在第一种情况下，您正在调用`f()`声明该函数的类的对象`virtual`，因此程序必须执行 vtable 查找以找到正确的派生类的覆盖`f()`（除非在您帖子中的简单示例中允许编译器对此进行优化，知道确切的类别）

在第二种情况下，没有 vtable 查找，除非也`D`声明`f()f`为 virtual ——通过知道类 id `D`，编译器知道`f()`在编译时要调用哪个。

更新（基于评论）：第二种情况相当于第一种情况，因为`D`' 的覆盖函数也是虚拟的，因为`B`它声明它是虚拟的（我今天也学到了一些新东西:)）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-15T19:14:46.337

在这两种情况下都必须查找 VTable，因为在编译时，代码不知道要调用哪个函数。

由于所有指令都是在编译时生成的，因此虚函数调用将被转换为 v-table 查找然后跳转。

# java - 用于验证数据的 Java 规则引擎

> ID：10607189
> 
> 赞同：-2
> 
> 时间：2012-05-15T19:04:43.947
> 
> 标签：java, rule-engine

我正在开发一个处理大量数据（每分钟 5-600k 条记录）的应用程序。数据被插入到我将验证数据的暂存区域。由于数据的大小，数据将通过批量操作进行验证。

我需要一个规则引擎，可用于使用 java 动态构建验证算法。

你能推荐一个可以处理这个的规则引擎吗？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:06:58.690

Red Hat/JBOSS 的 Drools 可能会成功。

我不相信规则引擎是必要的，只是因为数量很大。如果验证逻辑非常复杂或者有很多不同类型的消息，规则可能会发挥作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-05T14:03:34.817

我已经看过这篇关于实现 Java 规则 API 引擎的库的一些示例的帖子。

访问[https://www.baeldung.com/java-rule-engines](https://www.baeldung.com/java-rule-engines)

关于什么？

和

我还用规则引擎模式写了一个小解决方案。

像这样：

*   RuleParameter：object、fieldName、args、class（例如：ValidateEntityInsert.class）
*   RuleError：消息，字段名
*   ICase：getRuleParameters()
*   IRule: boolean shoudRun(Object object), List<RuleError> run(Object object, Object... args)
*   RuleEngine: List<RuleError> run(ICase useCase), List<RuleError> run(List<RuleParameter> rules), List<RuleError> run(RuleParameter rule)

这是基本的，但对我有用。

# sql-server-2005 - SQL Server 2008。难以设置日期和时间“时间戳”

> ID：10607195
> 
> 赞同：1
> 
> 时间：2012-05-15T19:05:16.990
> 
> 标签：sql-server-2005, datetime, timestamp, sql-server-2008-r2

我正在使用 MS SQL Server 2008 R2，我需要在每一行中都有一个单元格，其中包含该行插入数据库的日期和时间。现在，由于我想编写脚本然后在 MS SQL Server 2005 中加载数据库，因此我无法使用 datetime 或 date，因此我尝试在 Computed Column Specification 属性中使用 getdate() 函数。谁能帮帮我吗。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-16T17:46:17.443

让·克劳德，这是一个完整的例子。

**代码**

```
USE tempdb;
SET NOCOUNT ON;
GO

CREATE TABLE dbo.TestTable (
    RecordId         int         IDENTITY,
    RecordValue      varchar(32) NOT NULL,
    RecordCreateDate datetime    NOT NULL,

    CONSTRAINT PK_TestTable
    PRIMARY KEY CLUSTERED (
        RecordId
    )
)
GO

ALTER TABLE dbo.TestTable
ADD CONSTRAINT DF_TestTable_RecordCreateDate
DEFAULT GETDATE()
FOR RecordCreateDate;
GO

INSERT INTO dbo.TestTable (RecordValue) VALUES ('this');
WAITFOR DELAY '00:00:01';
INSERT INTO dbo.TestTable (RecordValue) VALUES ('that');
WAITFOR DELAY '00:00:01';
INSERT INTO dbo.TestTable (RecordValue) VALUES ('the other thing');

SELECT * FROM dbo.TestTable; 
```

**结果**

```
RecordId RecordValue     RecordCreateDate
-------- --------------- -----------------------
1        this            2012-05-16 10:43:48.400
2        that            2012-05-16 10:43:49.403
3        the other thing 2012-05-16 10:43:50.403 
```

您还应该研究新的日期时间数据类型和 SYSDATETIME() 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-29T15:02:54.420

Jean Claude，您似乎对 datetime 有误解，我曾经使用过的每个 SQL Server 版本都支持它，一直到 6.5。这是 SQL 2008 中新增的日期和时间类型。

Rob 的出色答案应该在 SQL 2005 和 2008 中都能正常工作。

# hibernate - 如何从实体管理器获取数据库元数据

> ID：10607196
> 
> 赞同：19
> 
> 时间：2012-05-15T19:05:21.030
> 
> 标签：hibernate, jpa

我有一个使用 hibernate 和 jpa 的应用程序。我需要找出它连接到哪个数据库，以便我基于数据库执行一些本机 sql 查询，例如。甲骨文和postgres。如果我使用的是纯 jdbc，那么直接获取数据库元数据但不知道如何从实体管理器获取

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-10-03T02:01:04.263

在 Hibernate 4 中，您可以使用该代码从实体管理器获取数据库信息：

```
org.hibernate.engine.spi.SessionImplementor sessionImp = 
     (org.hibernate.engine.spi.SessionImplementor) eManager.getDelegate();
DatabaseMetaData metadata = sessionImp.connection().getMetaData();
//do whatever you need with the metadata object...
metadata.getDatabaseProductName(); 
```

干杯

伊曼纽尔

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-15T20:56:38.467

作为一种解决方法，您可以获取`EntityManagerFactory`属性以获取特定于实现的底层数据库配置。

*   **休眠**：`hibernate.connection.driver_class`

*   **EclipseLink ：** `eclipselink.target-database`此属性指定目标数据库。`Oracle`在您的情况下，它可能具有`PostgreSQL`相应数据库的价值。

*   **一般的 ：** `javax.persistence.jdbc.driver`

从这些信息中，您可以获取当前连接的数据库。

```
EntityManagerFactory emf = entityManager.getEntityManagerFactory();     
Map<String, Object> emfProperties = emf.getProperties();

String driverClass = (String)emfProperties.get(PROPERTY);
//-- For PostgreSQL, it will have value "org.postgresql.Driver"

if(driverClass.lastIndexOf("postgresql") != -1)
    postGreSQL_DB = true; 
```

* * *

**注意：** *您的应用程序设计不太清楚，但您的应用程序可能会连接到两个数据库。如果可能，您可以尝试`EntityManager`为每个数据库单独设置，指向`persistence.xml`& 中的不同持久性单元，可以相应地使用它。*

*如果不是这种情况并且一次只连接其中一个，那么您可以简单地通过`entityManager.isOpen()`或进行验证`emf.isOpen()`。*

**编辑 ：**

```
Connection connection = entityManager.unwrap(Connection.class);  
DatabaseMetaData metaData = connection.getMetaData(); 
```

现在，您可以从中获取数据库产品名称、驱动程序等。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-03-04T00:07:22.683

基于 Emmanuel 回答如何使用 Spring 和休眠：

```
 @Repository
 public class UserRepository {

    @PersistenceContext
    private EntityManager em;

    public void getMeta() {
        org.hibernate.engine.spi.SessionImplementor sessionImp = (org.hibernate.engine.spi.SessionImplementor) em.getDelegate();
        DatabaseMetaData metadata = null;
        try {
            metadata = sessionImp.connection().getMetaData();
            ResultSet res = metadata.getColumns(null, null, "USERS", "USERNAME");
            System.out.println("List of columns: ");
            while (res.next()) {
                System.out.println(
                        "  " + res.getString("TABLE_SCHEM")
                                + ", " + res.getString("TABLE_NAME")
                                + ", " + res.getString("COLUMN_NAME")
                                + ", " + res.getString("TYPE_NAME")
                                + ", " + res.getInt("COLUMN_SIZE")
                                + ", " + res.getInt("NULLABLE"));
            }
            res.close();
            System.out.println();
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-11-01T07:36:47.307

使用以下行获取与您的连接和数据源相关的信息

```
entityManager.getEntityManagerFactory().getProperties().get("hibernate.connection.datasource"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-07-13T17:14:30.393

基于[这个答案](https://stackoverflow.com/a/19149637/5134722)，这里是 Kotlin/Spring 代码，用于根据一些已知值获取枚举值`databaseProductName`：

```
@Component
class DbDetector {

    @Autowired
    private lateinit var dataSource: DataSource

    val dbType by lazy { detectDatabase() }

    private fun detectDatabase(): DbType {
        val rawName = dataSource.connection.use {
            it.metaData.databaseProductName
        }
        return when (rawName) {
            "MySQL" -> DbType.MY_SQL
            "Oracle" -> DbType.ORACLE
            "PostgreSQL" -> DbType.POSTGRES
            "Microsoft SQL Server" -> DbType.SQL_SERVER
            "HSQL Database Engine" -> DbType.HSQLDB
            "H2" -> DbType.H2
            else -> DbType.UNKNOWN
        }
    }
}

enum class DbType {
    MY_SQL, ORACLE, POSTGRES, SQL_SERVER, HSQLDB, H2, UNKNOWN
} 
```

### 注意：关闭数据源和连接泄漏

一件让我痛苦的关键事情，我想明确指出的是使用后**关闭数据库连接**。Kotlin 的`use`构造优雅地允许这样做：

```
val rawName = dataSource.connection.use {
                it.metaData.databaseProductName
            } 
```

下面是我之前的错误代码，之后没有关闭连接。我已经把它划掉了，以表明你不应该使用它，因为它在第一次使用时可能不会明显失败，你可能认为没关系：

~~`val rawName = dataSource.connection.metaData.databaseProductName`~~

对我来说，这段代码暂时没有明显的错误。但它导致了一个微妙的连接泄漏，幸运的是，当我的连接池在测试期间达到最大值并且连接开始超时时，它才被幸运地检测到。[然后，此答案](https://stackoverflow.com/a/52414823/5134722)指向我使用以下中的泄漏检测设置来调试超时`application.properties`：

```
spring.datasource.hikari.leakDetectionThreshold=2000 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-29T09:46:45.637

如果其他人（比如我）想尝试获取一些 jdbc 信息并且您使用的是 hibernate 4.x，您可以这样尝试：

```
import java.sql.Connection;
import java.sql.SQLException;
import org.hibernate.jdbc.Work;
public class ConnectionInfo implements Work {

public String dataBaseUrl;
public String dataBaseProductName;
public String driverName;

@Override
public void execute(Connection connection) throws SQLException {
    dataBaseUrl = connection.getMetaData().getURL();
    dataBaseProductName = connection.getMetaData().getDatabaseProductName();
    driverName = connection.getMetaData().getDriverName();
}

public String getDataBaseProductName() {
    return dataBaseProductName;
}

public void setDataBaseProductName(String dataBaseProductName) {
    this.dataBaseProductName = dataBaseProductName;
}

public String getDataBaseUrl() {
    return dataBaseUrl;
}

public void setDataBaseUrl(String dataBaseUrl) {
    this.dataBaseUrl = dataBaseUrl;
}

public String getDriverName() {
    return driverName;
}

public void setDriverName(String driverName) {
    this.driverName = driverName;
}
} 
```

**现在您可以像这样检索您的信息：**

```
// -- snip
org.hibernate.ejb.EntityManagerImpl entityManagerImpl =  (org.hibernate.ejb.EntityManagerImpl) genericDBAccess.getEntityManager().getDelegate();
    Session session = entityManagerImpl.getSession();
    connectionInfo = new ConnectionInfo();
    session.doWork(connectionInfo);
// -- snap 
```

希望有帮助！我疯狂地寻找这些信息......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-03-17T20:58:48.677

如果您想从 url 获取 dba 名称

```
public String getDbName() throws SQLException {
    SessionImplementor sessionImp = (SessionImplementor) em.getDelegate();
    DatabaseMetaData metadata = sessionImp.connection().getMetaData(); 

    String dbName="";
    Pattern urlDbName = Pattern.compile("databaseName=([A-Za-z0-9\\-\\_]+)");
    Matcher m = urlDbName.matcher(metadata.getURL());
    while (m.find()) {
        dbName = m.group(1);
    }

    return dbName;   
} 
```

# css - div 高度（百分比）和不需要的滚动条

> ID：10607198
> 
> 赞同：0
> 
> 时间：2012-05-15T19:05:31.477
> 
> 标签：css, html

[http://magicdynamic.com/fit/](http://magicdynamic.com/fit/)

在这个演示页面中，我有 2 个问题：

1）我的页脚（我遵循了这些指南[http://ryanfait.com/sticky-footer/](http://ryanfait.com/sticky-footer/)）导致滚动条仅出现在 Firefox 上，我不明白原因

2) div#containerTop 由页脚 css 使用，它适合整个页面高度

```
 min-height: 100%; height: auto !important; height:100% 
```

问题是我希望 div#rightContainer 具有一定的高度，我希望它几乎可以拉伸整个页面，（在它和页脚之间留下一些像素）。显然，我尝试了以 % 为单位的高度，但它没有用。

我尝试了一些我在周围找到的 CSS，但那些也没有用，可能是因为 div#rightContainer 已经在一个 div 容器内，使用了一个 CSS 高度技巧。

如果不重复使用 javascript，我能做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:09:57.937

如果你想使用 % 作为高度，你必须把它放在每个父元素中：

```
<body style="height: 100%;">
    <div style="height: 100%;"></div>
</body> 
```

也许您可以将容器设置为绝对值，但这并不是真正合适的编码风格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-08T11:40:46.173

首先将div的父级高度和宽度设置为100%，并将html标签中的溢出设置为隐藏：

```
html{
     width: 100%;
     height: 100%;
     overflow: hidden; 
}
body{
     width: 100%;
     height: 100%;
} 
```

然后相应地设置你的div的宽度和高度......

这里溢出属性完成任务。如果现在 body 超过了实际窗口大小的宽度/高度，则相应地减小 body 标签的大小。但这肯定会删除滚动条。

它对我有用。

# jquery - 如何使此 jQuery 代码与 GridView 控件一起使用

> ID：10607199
> 
> 赞同：0
> 
> 时间：2012-05-15T19:05:34.557
> 
> 标签：jquery, asp.net, gridview

**编辑：** 什么不起作用：-我有两列（全部批准/全部拒绝）我如何限制用户只允许一个复选框？如果您不使用gridview，则以下代码有效....

我在这里问过这个问题（[只允许选中一个（批准/拒绝）复选框）并且](https://stackoverflow.com/questions/10560012/allow-only-one-approve-reject-checkbox-to-be-checked)**只有**当我有 asp.net 控件含义而不使用 gridview 控件时它才能按预期工作，现在我处于我有的情况使用 gridview 控件，似乎我的代码不起作用......我保持了相同的类名。有什么帮助吗？

这是我的带有gridview的.aspx代码：

```
<script type="text/javascript" language="javascript">

         $(document).ready(function () {
             $('#C1All').click(function () { debugger
                 $('.col1 > input').attr("checked", $('#C1All').attr("checked"));
                 $('.col2 > input').removeAttr("checked");
                 $('#C2All').removeAttr("checked");
             });

             $('#C2All').click(function () { debugger
                 $('.col2 > input').attr("checked", $('#C2All').attr("checked"));
                 $('.col1 > input').removeAttr("checked");
                 $('#C1All').removeAttr("checked");
             });

             $('.col1').each(function () { 
                 $(this).click(function () { debugger
                     var id = $("input", this).attr('id');
                     var coresId = id.replace('C1', 'C2');
                     $('#' + coresId).removeAttr("checked");
                     $('#C1All').removeAttr("checked");
                     $('#C2All').removeAttr("checked");
                 });
             });

             $('.col2').each(function () { 
                 $(this).click(function () {debugger
                     var id = $("input", this).attr('id');
                     var coresId = id.replace('C2', 'C1');
                     $('#' + coresId).removeAttr("checked");
                     $('#C1All').removeAttr("checked");
                     $('#C2All').removeAttr("checked");
                 });
             });
         });

  </script>
</head>
<body>
    <form id="form1" runat="server">
    <div>
    <asp:GridView ID="gv" runat="server" AutoGenerateColumns="False" DataKeyNames="Id"
        OnRowDataBound="gv_RowDataBound">
        <Columns>
         <asp:TemplateField HeaderText="Approve" HeaderStyle-HorizontalAlign="Center" HeaderStyle-Width="50px" >
            <HeaderTemplate>
                Approve<br />
                <asp:CheckBox ID="C1All" runat="server"  />
            </HeaderTemplate>
            <ItemStyle HorizontalAlign="Center" />
            <ItemTemplate   >
                <asp:CheckBox CssClass="col1" ID="chkApprove" runat="server"  >
                </asp:CheckBox>
            </ItemTemplate>
            <HeaderStyle HorizontalAlign="Center" />
        </asp:TemplateField>
         <asp:TemplateField HeaderText="Reject" HeaderStyle-HorizontalAlign="Center" HeaderStyle-Width="180px">
            <HeaderTemplate>
                Reject<br />
                <asp:CheckBox ID="C2All"  runat="server"  />
                 <asp:DropDownList ID="drpPaymentMethod" runat="server">
                        <asp:ListItem Value="-1">Please select</asp:ListItem>
                        <asp:ListItem Value="0">Month</asp:ListItem>
                        <asp:ListItem Value="1">At End</asp:ListItem>
                        <asp:ListItem Value="2">At Travel</asp:ListItem>
                    </asp:DropDownList>
            </HeaderTemplate>
            <ItemStyle HorizontalAlign="Center" />
            <ItemTemplate> 
                <div class="selectReason">
                    <asp:CheckBox CssClass="col2"  ID="chkReject" runat="server" >
                    </asp:CheckBox>
                     <asp:DropDownList ID="drpPaymentMethod" runat="server">
                        <asp:ListItem Value="-1">Please select</asp:ListItem>
                        <asp:ListItem Value="0">Month</asp:ListItem>
                        <asp:ListItem Value="1">At End</asp:ListItem>
                        <asp:ListItem Value="2">At Travel</asp:ListItem>
                    </asp:DropDownList>
                </div>
            </ItemTemplate>
            <HeaderStyle HorizontalAlign="Center" />
        </asp:TemplateField>
            <asp:BoundField DataField="ID" ControlStyle-Width="250px" HeaderText="ID" SortExpression="ID" />
            <asp:BoundField DataField="FirstName" ControlStyle-Width="250px" HeaderText="FirstName"
                SortExpression="FirstName" />
            <asp:BoundField DataField="LastName" ControlStyle-Width="250px" HeaderText="LastName"
                SortExpression="LastName" />
            <asp:TemplateField>

            </asp:TemplateField>

        </Columns>
    </asp:GridView>

    </div>
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T03:41:10.197

这与控件如何呈现给浏览器有关。因此，基于此，您将需要修改 jQuery 元素选择器。在您的情况下，`GridView`正在发生的事情是，而不是`C1All`和`C2All`现在是`gv_C1All`和`gv_C2All`。在复选框的情况下，这次您需要将单词替换为 and viseverse，而不是替换`C1`为and visevers。这是修改后的 jQuery。现在它应该可以工作了。`C2``Approve``Reject`

我建议您在浏览器中查看页面 HTML，以便了解控件的呈现方式（您可以在 InternetExplorer 中按功能键 F12 以查看开发人员工具窗格，您可以在其中看到 HTML 树）

```
 $(document).ready(function () {
    $('#gv_C1All').click(function () {
        $('.col1 > input').attr("checked", $('#gv_C1All').attr("checked"));
        $('.col2 > input').removeAttr("checked");
        $('#gv_C2All').removeAttr("checked");
    });

    $('#gv_C2All').click(function () {
        $('.col2 > input').attr("checked", $('#gv_C2All').attr("checked"));
        $('.col1 > input').removeAttr("checked");
        $('#gv_C1All').removeAttr("checked");
    });

    $('.col1').each(function () {
        $(this).click(function () {
            var id = $("input", this).attr('id');
            var coresId = id.replace('Approve', 'Reject');
            $('#' + coresId).removeAttr("checked");
            $('#gv_C1All').removeAttr("checked");
            $('#gv_C2All').removeAttr("checked");
        });
    });

    $('.col2').each(function () {
        $(this).click(function () {
            var id = $("input", this).attr('id');
            var coresId = id.replace('Reject', 'Approve');
            $('#' + coresId).removeAttr("checked");
            $('#gv_C1All').removeAttr("checked");
            $('#gv_C2All').removeAttr("checked");
        });
    });
}); 
```

# ios5 - 在表格视图中选择项目后无法关闭弹出框

> ID：10607201
> 
> 赞同：2
> 
> 时间：2012-05-15T19:05:39.433
> 
> 标签：ios5, uitableview, uipopovercontroller, xcode4.3

我正在使用 XCode 4.3.2 版创建 iPad 应用程序。我无法弄清楚如何关闭在情节提要中创建的弹出框。

在我的主屏幕上，我有一个按钮。在情节提要上，我从那个按钮到我的弹出框定义了一个segue。我的弹出框是一个表格视图控制器。在弹出框表视图中选择一个项目后，我将所选信息发送回父级并尝试关闭弹出框。一切正常，除了我无法关闭弹出窗口。

主屏幕 .m 文件的代码：

```
#import "SectionViewController.h"
#import "SortByTableViewController.h"

@interface SectionViewController () <SortByTableViewControllerDelegate>
@end

@implementation SectionViewController

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"DisplaySortByOptions"]) 
    {
        SortByTableViewController *popup = (SortByTableViewController*)segue.destinationViewController;
        popup.selectedSection = self.selectedSection;
        popup.receivedOption = self.selectedItemCharacteristic;
        popup.delegate = self;
    }
}

- (void)sortByTableViewController:(SortByTableViewController *)sender 
                           returnedOption:(ItemCharacteristic *)returnedOption
{
    if(!returnedOption)
    {
        [self.sortByButton setTitle:@"SHOW ALL" forState:UIControlStateNormal]; 
    }
    else 
    {
        [self.sortByButton setTitle:returnedOption.name forState:UIControlStateNormal];
    }
    self.itemCharacteristic = returnedOption;
    [self dismissViewControllerAnimated:YES completion:nil]; //THIS DOES NOT CLOSE THE POPOVER
} 
```

popover .h 文件的代码：

```
#import <UIKit/UIKit.h>

@class SortByTableViewController;

@protocol SortByTableViewControllerDelegate <NSObject>

- (void)sortByTableViewController:(sortByTableViewController *)sender 
                           returnedOption:(ItemCharacteristic *)returnedOption;

@end

@interface SortByTableViewController : UITableViewController

@property (nonatomic, strong) Section *selectedSection;
@property (nonatomic, strong) ItemCharacteristic *receivedOption;
@property (nonatomic, weak) id <SortByTableViewControllerDelegate> delegate;

@end 
```

popover .m 文件的代码：

```
#import "SortByTableViewController.h"

@interface SortByTableViewController () <UITableViewDelegate>

@end

@implementation SortByTableViewController

@synthesize selectedSection = _selectedSection;
@synthesize receivedOption = _receivedOption;
@synthesize delegate = _delegate;

...
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    ItemCharacteristic *itemCharacteristic = [self.fetchedResultsController objectAtIndexPath:indexPath];
    [self.delegate sortByTableViewController:self returnedOption:itemCharacteristic];
    [self dismissViewControllerAnimated:YES completion:nil]; //THIS DOESN'T WORK
    [self.navigationController popViewControllerAnimated:YES]; //THIS DOESN'T WORK EITHER
}

@end 
```

感谢您的任何帮助或指导。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-16T18:45:44.870

我找到了答案。我必须将以下属性添加到我的主屏幕：

```
@property (nonatomic, strong) UIPopoverController *sortByPopoverController; 
```

然后，在启动弹出窗口时，我包括了这个：

```
UIStoryboardPopoverSegue *popoverSegue = (UIStoryboardPopoverSegue *)segue;
self.sortByPopoverController = popoverSegue.popoverController; 
```

包含该代码允许我在委托回叫时正确关闭弹出框：

```
[self.sortByPopoverController dismissPopoverAnimated:YES]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-17T08:49:59.063

很快就叫这个

```
 func tableView(tableView: UITableView, didSelectRowAtIndexPath indexPath: NSIndexPath)   
  {
    self.dismissViewControllerAnimated(true, completion: nil)

  } 
```

# php - 包含前导斜杠的 codeigniter url 段

> ID：10607202
> 
> 赞同：1
> 
> 时间：2012-05-15T19:05:40.347
> 
> 标签：php, codeigniter, uri

访问该方法的 url 是这样的： `http://localhost/site/cont/method` 我想使用这样的 GET 方法访问这个方法： `http://localhost/new-tera/paper/lookup_doi/segment`但我的`segment`部分已经包含`/`这样的内容：

`http://localhost/lookup_doi/segment/containing/slashes` 请注意，整体`segment/containing/slashes`是一个值。

我在我的方法中得到这个值，如下所示：

```
public function method ($variable)
{
  echo $variable;
} 
```

//输出：段

而不是：段/包含/斜杠

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T19:09:48.920

CodeIgniter 将其余的作为附加参数传递。您可以指定附加参数（如果数字是固定的）或使用：

```
内爆（'/'，func_get_args（））
```

获取整个字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T20:28:38.417

.htaccess 桅杆是

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l
RewriteRule ^(.*)$ index.php?route=$1 [L,QSA] 
```

那么好吧...

```
$route = empty($_GET['route']) ? '' : $_GET['route'];
$exp = explode('/', $route); 
```

结果：

```
$exp[0] = new-tera
$exp[1] = paper
$exp[2] = lookup_doi
$exp[3] = segment 
```

所以我们有路由！运行示例（与我的项目）：

```
 if($exp[0] == '')
        {
          $file = $_SERVER['DOCUMENT_ROOT'] .'/controllers/controller_index.php'; 
        }
        else
        {

          $file = $_SERVER['DOCUMENT_ROOT'] .'/controllers/controller_'.$exp[0].'.php'; 
        }    
        if(!file_exists($file))
        {
            engine :: away(); 
        }

        include_once $file;

        $class = (empty($exp[0]) or !class_exists($exp[0])) ? 'class_index' : $exp[0];

        $controller = new $class;

        $method = (empty($exp[1]) or !method_exists($controller, $exp[1])) ? 'index' : $exp[1];

        $controller -> $method(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T19:13:56.350

您可以通过在查询字符串中添加“%2F”来添加斜杠希望这会起作用

```
segment = 'somethingwith%2F'
http://localhost/new-tera/paper/lookup_doi/segment 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T19:24:58.743

您可以先对其进行base64编码，然后再对其进行解码。实际上，您可以使用多种方法将 / 更改为其他内容（即 -）并将其改回。

echo site_url('控制器/方法/' . base64_encode($variable));

公共函数方法 ($variable) { $variable = base64_decode($variable); }

# android - 对 Android 中的屏幕密度/分辨率/尺寸感到困惑，为什么它们看起来不同？

> ID：10607203
> 
> 赞同：0
> 
> 时间：2012-05-15T19:05:45.023
> 
> 标签：android, screen-resolution, galaxy

我的应用程序几乎已准备就绪，我正在多台设备上对其进行测试...该应用程序是为平板电脑（旧平板电脑）设计的，因此我主要针对此类目标进行测试...

问题是这样的：我有 3 台平板电脑：A) ViewPad 7 (480x800, 7", 133dpi), B) Lenovo IdeaPad (600x1024, 7", 170dpi) 和 C) Samsung GALAXY tab 7 plus (600x1024, 7", 170dpi ）。

如您所见，平板电脑 B 和 C 具有相同的屏幕规格，但 B 平板电脑中的所有内容看起来都很大（巨大！），就像 Windows 无法识别 VGA 驱动程序并使用 640x480 分辨率时一样。

B平板电脑中的应用程序（和所有东西）看起来像一个480x640的屏幕...... B平板电脑看起来比A平板电脑差......

多么奇怪的行为……你知道发生了什么……吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T01:41:02.457

Android 布局根据“标称”屏幕像素密度工作，而不是实际硬件密度。标称密度的标准值为 120、160、240 和 320dpi，也分别称为“ldpi”、“mdpi”、“hdpi”和“xhdpi”。我的猜测是平板电脑 B 上的操作系统指定了 240dpi 的标称密度，而 C 说的是 160dpi。

换句话说，平板电脑 B 有问题。它运行的是哪个版本的 Android？我认为 Android 1.6 支持不同的屏幕密度。

# php - 如何在不依赖 javascript 的情况下决定用户的时区

> ID：10607207
> 
> 赞同：1
> 
> 时间：2012-05-15T19:06:00.023
> 
> 标签：php, javascript

我使用这种方法解决了这个问题：

设置 php.ini 时区 = UTC

然后使用 javascript new Date() 将其转换为客户端等效时间。

但是这种方法的一个严重缺点是，如果客户端更改了他的系统的时区甚至系统的时间，它就会改变。Javascript 使用它可以发送到服务器的操作系统时间和时区来进行计算，这些计算也存在同样的问题，即客户端可以欺骗你。同时我也看到facebook上的生日不受我们客户更改时间或时区的影响。

就我而言，我现在需要显示今天生日的解决方案。由于服务器和客户端时区的差异。生日在早上 5:30 发生变化，因为我在 php 中将 UTC 设置为时区并且我位于印度。我尝试并指出了这种方法中的问题。

请提出一个没有上述错误的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:25:49.787

尝试这样的事情......

不要发送生日的绝对时间，而是发送*相对于现在的时间*。

换句话说，不要让您的服务器说“生日是 5 月 18 日 12:00”。相反，让它说“生日是从现在开始的 80 小时 20 分钟”。

这样，客户认为现在是什么时间并不重要。只要他们的时钟以正常速度滴答作响，他们就会看到生日是“今天”或“两小时后”或其他。

通过网络发送时差会丢失一点精度，但应该在一秒左右或更少，没什么大不了的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:08:49.257

许多网站在用户的个人资料中都有一个“时区”字段。这很简单，但它有效。

我相信facebook要么有，要么根据用户的位置工作。

# php - 按周对数组中的信息进行排序

> ID：10607210
> 
> 赞同：1
> 
> 时间：2012-05-15T19:06:15.603
> 
> 标签：php, arrays, datetime, sorting

我有一系列日期，例如

```
array
1 => string '2012-02-27' (length=10)
2 => string '2012-03-02' (length=10)
59 => string '2012-03-05' (length=10) 
```

等等。这些日期代表人们申请某物的日子。比如2月27日3人申请，3月1日2人申请。

我想要做的是创建一个表格，上面写着 5 个人提交申请的那`2012-02-26`一周`2012-03-03`。左边栏的标题是`Weeks`，右边栏的标题是`# of applications received`。

我已经按天设置了桌子，但几周也会有帮助。我看过一篇关于上市周的帖子，并尝试使用它，但它没有用。

更具体地说，我的问题是如何获取一系列日期并将它们按周分解并将这些信息放在表格中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:15:04.520

您没有指定您使用的数据库引擎，但大多数都有一个日期格式字段“一年中的一周”，所以`SELECT COUNT, YEAR(date), WEEKOFYEAR(date) FROM stuff GROUP BY YEAR(date), WEEKOFYEAR(date)`.

[http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_weekofyear](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_weekofyear)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:15:23.640

您可能希望在 php 中使用它，而不是在数据库中。

```
1) convert dates to epoch (seconds) with strtotime()
2) sort array by (numeric now) date with asort()
3) loop through the sorted now array from start date to end date and add the values. 
```

当然，使用数据库可以更容易地做到这一点。

# python - Python 当 p.stdout.read(-1) 被阻塞时

> ID：10607211
> 
> 赞同：2
> 
> 时间：2012-05-15T19:06:37.717
> 
> 标签：python, subprocess, stdout, popen

你好，我对 Python 子进程模块有疑问

我想与子进程交互（例如：孩子的标准输入、标准输出）

这是子程序的代码

```
 1 #include <stdio.h>
  2 
  3 int main(){
  4         char buf[1024];
  5         printf("asdfsadfasff\n");
  6         scanf("%s",buf);
  7         printf("%s\n",buf);
  8 } 
```

这段代码很简单，打印字符串，等待输入，打印输入字符串

接下来，python代码如下

```
 1 #!/usr/bin/python
  2 from subprocess import *
  3 
  4 fd = Popen(["./random"],stdin=PIPE,stdout=PIPE)
  5 print "pid = %d"%(fd.pid) # print pid
  6 result = ""
  7 result = fd.stdout.read(-1) # read
  8 print result
  9 fd.stdin.write("write write write!!!\n")
 10 result = fd.stdout.read(-1)
 11 print result 
```

在这种情况下，我预计该程序会运行良好，但在第 7 行 (fd.stdout.read(-1) 被阻止并且无法运行

我更改了读取函数的参数（读取（-1），读取（1），读取（），读取（1024））但一切都不起作用

但是，当我首先在标准输入中给出字符串时，程序起作用了。

我认为程序结束时孩子的标准输出缓冲区没有填满......这只是我的选择

这个问题有什么解决办法吗？

编辑1。当我首先执行打印字符串的程序，然后等待用户输入，例如“sudo su”这工作得很好，我期望

我不明白为什么这个案子运作良好

```
 1 from subprocess import *
  2 
  3 fd = Popen(["sudo","su"],stdin=PIPE,stdout=PIPE)
  4 
  5 print fd.stdout.read(-1)
  6 print fd.stdin.write("asdfasdfas\n") 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T19:27:13.897

子进程`./random`正在使用`stdio`，当进程的标准输出不是 tty 设备时，默认情况下会执行“完全缓冲”而不是“行缓冲”。由于 python 通过管道（不是 tty 设备）运行进程，因此程序正在缓冲其输出，而不是在`scanf`调用时打印它。缓冲区仅在 (a) 填满时刷新（写入标准输出）；(b) 当被`fflush`调用显式刷新时；或 (c) 在程序退出时。

您可以修改子进程以进行显式`fflush`调用，或者您可以使用 Python 中的伪 tty，例如 with[`pexpect`](http://pexpect.readthedocs.org/en/latest/)或[`sh`](https://pypi.python.org/pypi/sh/)。（请注意，`sh`默认情况下，该模块仅使用 pty 输出，但这通常就足够了。）或者，在这种情况下，您正在运行的程序仅“看起来是交互式的”（但实际上是完全可预测的），您可以运行它与预先提供的已知输入序列：

```
fd = Popen(["./random"], stdin=PIPE, stdout=PIPE)
result = fd.communicate("write write write!!!\n")[0] 
```

虽然当然你会把所有的标准输出输入混合在一起，并且必须将它打印的两行分开（在这种特殊情况下）。

# coldfusion - 如何访问coldfusion中cffile上传创建的对象

> ID：10607212
> 
> 赞同：1
> 
> 时间：2012-05-15T19:06:42.433
> 
> 标签：coldfusion, upload, cffile

我有各种各样的问题，但我将在这里集中讨论一个。如何访问从 cffile 上传创建的对象。我目前正在这样做。

```
<cffile action="upload" destination="#Application.filePath#Pics/" filefield="image1" nameconflict="makeunique">
<cfif isDefined ("cffile.serverFile")>
<cfset image1Place = #cffile.serverFile#> 
</cfif> 
```

但这似乎不适用于多个文件上传，这恰好是我的情况。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:13:50.790

如果您担心由于多次调用 cffile 而导致结果对象被吹走，那么您可以使用“result”属性来区分它们：

```
<cfset uploadResults = {}>
<cfloop list="#form.filelist#" index="myFile">
  <cffile action="upload" destination="#Application.filePath#Pics/"
    filefield="#myFile#" nameconflict="makeunique" 
    result='uploadResults.#myFile#'>

  <cfif StructKeyExists(uploadResults, myFile)>
    <cfset image1Place = uploadResults[myFile].serverFile> 
  </cfif>
</cfloop> 
```

# nhibernate - NHibernate/Iesi.Collections 中的 HashedSet.cs 和 DictionarySet.cs 在哪里？

> ID：10607213
> 
> 赞同：1
> 
> 时间：2012-05-15T19:06:42.777
> 
> 标签：nhibernate, iesi-collections

这是我的基本情况。我正在尝试使用 NHibernate 从数据库中获取信息，根据映射创建一些对象，对它们进行序列化，然后将序列化的对象移动到闪存组件上。没有构建错误发生，但是当我返回“序列化”对象时，它一直返回 null。在插入一些断点并逐步完成后，我意识到一切都在往南走。

我把我的断点放在这里：

```
var tasks = (List<CSH_Task>)persistanceManager.RetrieveAll<CSH_Task>(SessionAction.BeginAndEnd); 
```

它进入我的 PersistanceManager 类，成功传递了我的 CSH_Task：

```
public IList<T> RetrieveAll<T>(SessionAction sessionAction)
    {
        /* Note that NHibernate guarantees that two object references will point to the
         * same object only if the references are set in the same session. For example,
         * Order #123 under the Customer object Able Inc and Order #123 in the Orders
         * list will point to the same object only if we load Customers and Orders in 
         * the same session. If we load them in different sessions, then changes that
         * we make to Able Inc's Order #123 will not be reflected in Order #123 in the
         * Orders list, since the references point to different objects. That's why we
         * maintain a session as a member variable, instead of as a local variable. */

        // Open a new session if specified
        if ((sessionAction == SessionAction.Begin) || (sessionAction == SessionAction.BeginAndEnd))
        {
            m_Session = m_SessionFactory.OpenSession();
        }

        // Retrieve all objects of the type passed in
        ICriteria targetObjects = m_Session.CreateCriteria(typeof(T));
        IList<T> itemList = targetObjects.List<T>();

        // Close the session if specified
        if ((sessionAction == SessionAction.End) || (sessionAction == SessionAction.BeginAndEnd))
        {
            m_Session.Close();
            m_Session.Dispose();
        }

        // Set return value
        return itemList;
    } 
```

这直接来自[NHibernate 的一个旧示例](http://www.codeproject.com/Articles/21122/NHibernate-Made-Simple)（我对它非常陌生）它让我进入一个“无可用资源”页面，其中列出了这个

> **调用堆栈位置：**
> 
> Iesi.Collections.DLL!Iesi.Collections.Generic.HashedSet.HashedSet() 第 18 行
> 
> **源文件信息：**
> 
> 查找 'd:\CSharp\NH\NH_Hg\nhibernate\src\Iesi.Collections\Generic\HashedSet.cs' 的源。校验和：MD5 {d3 1c 6c 95 94 c0 cb d4 b5 8d 8c 42 c5 4a 37 b2}
> 
> 文件 'd:\CSharp\NH\NH_Hg\nhibernate\src\Iesi.Collections\Generic\HashedSet.cs' 不存在。
> 
> 在脚本文档中查找 'd:\CSharp\NH\NH_Hg\nhibernate\src\Iesi.Collections\Generic\HashedSet.cs'...
> 
> 在项目中查找 'd:\CSharp\NH\NH_Hg\nhibernate\src\Iesi.Collections\Generic\HashedSet.cs'。
> 
> 在项目中找不到该文件。
> 
> 查看目录'C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\crt\src\'...
> 
> 查看目录 'C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\atlmfc\src\mfc\'...
> 
> 查看目录'C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\atlmfc\src\atl\'...
> 
> 查看目录 'C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\atlmfc\include\'... 查看目录 'C:\Users\tackiean\Desktop\'...
> 
> 查看目录 'E:\SmartMC\NHibernate\Required_Bins\'...
> 
> 源位于“E:\SmartMC\NHibernate\Required_Bins\HashedSet.cs”。
> 
> 确定校验和是否与以下位置匹配：
> 
> 1:E:\SmartMC\NHibernate\Required_Bins\HashedSet.cs 校验和：MD5 {40 1b 39 7e 8f 4a 3f 6 11 41 88 70 9e 8f 8 f1} 校验和不匹配。
> 
> 活动解决方案的调试源文件设置表明调试器不会要求用户查找文件：d:\CSharp\NH\NH_Hg\nhibernate\src\Iesi.Collections\Generic\HashedSet.cs。
> 
> 调试器找不到源文件 'd:\CSharp\NH\NH_Hg\nhibernate\src\Iesi.Collections\Generic\HashedSet.cs'。

如果我继续单步执行它会返回我的代码，然后返回此处列出关于 DictionarySet.cs 的几乎相同的消息

我不是第一个在这台机器上为这个项目下载 NHibernate 的人，但我会想象如果它需要 HashedSet.cs/DictionarySet.cs 才能工作，它们会默认包含在内吗？我今天花了大约 7 个小时来寻找这个问题的答案，但我空空如也。我以前从未见过这样的错误。我认为它只是在寻找 NHibernate 需要的文件，但找不到，但这里还有其他事情吗？任何帮助将不胜感激。我希望这是一个合适的位置/格式清晰；我以前从来没有在这里问过问题，所以我希望这不是完全不合适的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T17:30:15.250

HashedSet 和 DictionarySet 是 Iesi.Collections 的一部分，Iesi.Collections 是 NHibernate 包含的一个集合库。NHibernate 的二进制包通常包含 .pdb 文件，其中包含程序集的调试信息。当调试器想要打开源文件时，它在你的机器上找不到它们，因为包含的源路径是包维护者的路径。

如果您愿意，您可以在[GitHub 上](https://github.com/nhibernate/nhibernate-core)下载 NHibernate 源代码并自己编译程序集。然后调试器会在发生异常时自动查找源文件（编译后不要移动源文件）。

您应该稍微修改一下您的 RetrieveAll 方法，因为您必须始终打开一个会话并在某个地方关闭它。通常，您会执行以下操作：

```
using (ISession sess = factory.OpenSession())
using (ITransaction tx = sess.BeginTransaction())
{
    try
    {
        var crit = sess.CreateCriteria<T>();
        var list = crit.List<T>();

        // Do something with list

        tx.Commit();
    }
    catch (Exception)
    {
        tx.Rollback();
    }
} 
```

如果要将查询的列表返回给调用者，会话将被关闭。因此，请确保您的查询列表中没有未初始化的延迟加载代理。[您可以阅读NHibernate 文档](http://nhforge.org/doc/nh/en/index.html)中的延迟/急切加载部分。希望，我可以帮助你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T10:49:28.533

您看到的消息是您的**调试器**尝试查找源代码，因为您正在单步执行它。您的机器上缺少该源代码不会影响 NHibernate 运行时。

# c++ - 最简单的 TBB 示例

> ID：10607215
> 
> 赞同：21
> 
> 时间：2012-05-15T19:06:49.847
> 
> 标签：c++, tbb, icc

有人可以给我一个[TBB](http://wikipedia.org/wiki/Intel_Threading_Building_Blocks)示例如何：

1.  设置活动线程的最大计数。
2.  执行彼此独立并以类的形式呈现的任务，而不是静态函数。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-05-15T22:39:23.440

这里有几个完整的例子，一个 using `parallel_for`，另一个 using `parallel_for_each`。

**2014-04-12 更新**：这些显示了我认为现在使用 TBB 的非常老式的方式；我使用C++11 lambda添加了一个[单独的答案。](https://stackoverflow.com/questions/10607215/simplest-tbb-example/23027877#23027877)`parallel_for`

```
#include "tbb/blocked_range.h"
#include "tbb/parallel_for.h"
#include "tbb/task_scheduler_init.h"
#include <iostream>
#include <vector>

struct mytask {
  mytask(size_t n)
    :_n(n)
  {}
  void operator()() {
    for (int i=0;i<1000000;++i) {}  // Deliberately run slow
    std::cerr << "[" << _n << "]";
  }
  size_t _n;
};

struct executor
{
  executor(std::vector<mytask>& t)
    :_tasks(t)
  {}
  executor(executor& e,tbb::split)
    :_tasks(e._tasks)
  {}

  void operator()(const tbb::blocked_range<size_t>& r) const {
    for (size_t i=r.begin();i!=r.end();++i)
      _tasks[i]();
  }

  std::vector<mytask>& _tasks;
};

int main(int,char**) {

  tbb::task_scheduler_init init;  // Automatic number of threads
  // tbb::task_scheduler_init init(2);  // Explicit number of threads

  std::vector<mytask> tasks;
  for (int i=0;i<1000;++i)
    tasks.push_back(mytask(i));

  executor exec(tasks);
  tbb::parallel_for(tbb::blocked_range<size_t>(0,tasks.size()),exec);
  std::cerr << std::endl;

  return 0;
} 
```

和

```
#include "tbb/parallel_for_each.h"
#include "tbb/task_scheduler_init.h"
#include <iostream>
#include <vector>

struct mytask {
  mytask(size_t n)
    :_n(n)
  {}
  void operator()() {
    for (int i=0;i<1000000;++i) {}  // Deliberately run slow
    std::cerr << "[" << _n << "]";
  }
  size_t _n;
};

template <typename T> struct invoker {
  void operator()(T& it) const {it();}
};

int main(int,char**) {

  tbb::task_scheduler_init init;  // Automatic number of threads
  // tbb::task_scheduler_init init(4);  // Explicit number of threads

  std::vector<mytask> tasks;
  for (int i=0;i<1000;++i)
    tasks.push_back(mytask(i));

  tbb::parallel_for_each(tasks.begin(),tasks.end(),invoker<mytask>());
  std::cerr << std::endl;

  return 0;
} 
```

两者都在 Debian/Wheezy (g++ 4.7) 系统上编译`g++ tbb_example.cpp -ltbb`（然后运行`./a.out`）

（请参阅[此问题](https://stackoverflow.com/questions/10610307/am-i-reinventing-the-wheel-with-this-trivial-method-call-forwarding-class)以将“ `invoker`”替换为`std::mem_fun_ref`or `boost::bind`）。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2014-04-12T08:04:14.167

`parallel_for`这是 lambda的更现代用法；在 Debian/Wheezy 上编译并运行`g++ -std=c++11 tbb_example.cpp -ltbb && ./a.out`：

```
#include "tbb/parallel_for.h"
#include "tbb/task_scheduler_init.h"
#include <iostream>
#include <vector>

struct mytask {
  mytask(size_t n)
    :_n(n)
  {}
  void operator()() {
    for (int i=0;i<1000000;++i) {}  // Deliberately run slow
    std::cerr << "[" << _n << "]";
  }
  size_t _n;
};

int main(int,char**) {

  //tbb::task_scheduler_init init;  // Automatic number of threads
  tbb::task_scheduler_init init(tbb::task_scheduler_init::default_num_threads());  // Explicit number of threads

  std::vector<mytask> tasks;
  for (int i=0;i<1000;++i)
    tasks.push_back(mytask(i));

  tbb::parallel_for(
    tbb::blocked_range<size_t>(0,tasks.size()),
    [&tasks](const tbb::blocked_range<size_t>& r) {
      for (size_t i=r.begin();i<r.end();++i) tasks[i]();
    }
  );

  std::cerr << std::endl;

  return 0;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-04-22T00:45:36.100

如果您只想同时运行几个任务，使用`tbb::task_group`. 取自[tbb](https://www.threadingbuildingblocks.org/docs/help/reference/task_groups/task_group_cls.htm)的示例：

```
#include "tbb/task_group.h"  

using namespace tbb;

int Fib(int n) {
    if( n<2 ) {
        return n;
    } else {
        int x, y;
        task_group g;
        g.run([&]{x=Fib(n-1);}); // spawn a task
        g.run([&]{y=Fib(n-2);}); // spawn another task
        g.wait();                // wait for both tasks to complete
        return x+y;
    }
} 
```

但请注意

> 为单个 task_group 创建大量任务是不可扩展的，因为任务创建成为串行瓶颈。

在这些情况下，将 timday 的示例与 a`parallel_for`或类似内容一起使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-08-12T14:06:41.483

1-

```
 //!
 //! Get the default number of threads
 //!
 int nDefThreads = tbb::task_scheduler_init::default_num_threads();

 //!
 //! Init the task scheduler with the wanted number of threads
 //!
 tbb::task_scheduler_init init(nDefThreads); 
```

2-

也许如果您的代码允许，使用 TBB 运行独立任务的最佳方式是[parallel_invoke](http://www.threadingbuildingblocks.org/docs/help/reference/algorithms/parallel_invoke_func.htm)。在英特尔开发者专区的博客中，有一篇文章解释了一些并行调用可能有多大帮助的案例。看看[这个](https://software.intel.com/en-us/blogs/2009/04/02/running-your-code-in-parallel-with-tbbparallel_invoke)

# ios - 在完全不同的配置文件下向应用商店发布新版本

> ID：10607224
> 
> 赞同：1
> 
> 时间：2012-05-15T19:07:12.140
> 
> 标签：ios, xcode, testflight

所以我从一个客户端接手了一个现有的 iOS 应用程序，该应用程序目前可通过 App Store 供公众使用。当我在 xcode 中获得该项目时，我注意到与该应用程序关联的所有配置文件都已过期，并且都在前一个开发人员的名下。

因此，我将自己添加为开发人员并加入了团队，并在我的凭据下对开发副本进行了代码签名。我为测试创建了一个新的临时配置文件，并通过 TestFlight 向一些注册设备发布了一个版本。没问题。该应用程序已获准上线。

从现在开始，有人可以帮我完成发布过程吗？我是否要为 App Store 版本创建第三个新的配置文件，并将其绑定到 XCode 中的代码签名？考虑到现在使用的版本与来自不同开发人员的完全不同（过期）的配置文件下，这是否会有问题？我需要通过Apple来做一些替代方法吗？我在这里要非常小心...如果由于某种原因我释放了应用程序并且由于我没有意外采取的某些步骤而导致其崩溃，便便会击中风扇。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:16:38.773

您将不得不在 App Store 上以新名称发布它，并放弃所有评级和评论。Apple 不会让您在现有应用程序上交换开发者资料。

其他开发者可能不同意，但它看起来像一个巨大的 PITA。看这里

[转移应用商店中 iPhone 应用的所有权](https://stackoverflow.com/questions/671382/transferring-ownership-of-an-iphone-app-on-the-app-store)

官方的回答好像是NO

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:03:03.133

我没有将这个问题解释为有关更改应用程序所有权的问题。

我将问题解读为：我继承了应用程序的维护，我们希望以同一卖家的身份提交更新。

在这种情况下，您可以生成自己的证书和分发配置文件，然后您可以构建和提交应用程序。

我已经做过很多次了。也就是说，我继承了我最初不一定制作的应用程序的责任。我轻松地创建了新的签名和供应凭证，适用于代表他们作为卖方（而不是我）提交的应用程序。

值得一提的是，App Store Distribution 配置文件是必要的，但仅在提交应用程序时使用，因此 Apple 可以确保它来自有权提交它的开发人员。（请记住，这些配置文件是使用用于签署您的应用程序包的相同证书进行签名的。）如果该分发配置文件应该过期或更改，它与 App Store 中已有的应用程序无关。

# ruby-on-rails - 网页应用架构设计

> ID：10607226
> 
> 赞同：1
> 
> 时间：2012-05-15T19:07:15.953
> 
> 标签：ruby-on-rails, wordpress, architecture

我正在构建由 wordpress mu 作为博客引擎和我的 rails 应用程序作为应用程序核心的应用程序。有一个时刻我遇到了一个大问题：

我认为这可能真的很难做到，我可能不会避免做一些核心更改，但首先我想在这里问一下。

我在 domain.com 上有我的 ruby​​ on rails 应用程序 - 我想使用 wordpress mu 作为博客引擎（这是网站概念的一部分），使用子域（user.domain.com user2.domain.com 等），但 wordpress 不能直接在 domain.com 上，因为必须有我的 rails 应用程序。是否可以在 domain.com/wp 之类的东西中运行 wordpress，但在 *.domain.com 中捕获子域（正如我所说，我知道我可能必须深入研究 wordpress 核心）还是完全不可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T20:04:04.693

其实我已经找到答案了。例如，我将在 wp.domain.com 下设置 WordPress MU，并在其中注册帐户并将`wp.domain.com/user1` `wp.domain.com/user2`其重写为haproxy。`user1.domain.com``user2.domain.com`

我希望这可以帮助将来的任何人。

# ruby - 我可以安装多少个版本的 gem？

> ID：10607228
> 
> 赞同：3
> 
> 时间：2012-05-15T19:07:16.353
> 
> 标签：ruby, rubygems

我在运行`gem install -v=2.3.12 rails`的地方遇到了这个问题，cli 告诉我它安装成功。但是当我运行`gem list rails`它时，它不在可用的 Rails 版本列表中。

我不确定为什么这不起作用，但我注意到对于列表中的每个 gem，特定 gem 的版本不超过 6 个。您可以为特定 gem 拥有的版本数量是否有限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-28T17:53:44.167

> 特定 gem 可以拥有的版本数量是否有限制

文档中特定 gem 的版本数没有限制：http: [//docs.rubygems.org/read/chapter/2](http://docs.rubygems.org/read/chapter/2)您可以使用`gem list`查看所有已安装的 gem。

# javascript - 滑块在正确渲染之前加载每张幻灯片

> ID：10607229
> 
> 赞同：0
> 
> 时间：2012-05-15T19:07:51.600
> 
> 标签：javascript, jquery, css

如果您在下面查看我的 URL，并且连接速度可能不是很快。您会注意到顶部的滑块，将每个单独的幻灯片加载到垂直列表中（占用大约 1000 像素的空间），然后再捕捉到它应该呈现的方式 - 这就像一个标准滑块；一次显示和滑动一张幻灯片。

有人对如何让我的滑块正确加载有任何建议吗？

现场直播网站 >> [http://tinyurl.com/cz6sawg](http://tinyurl.com/cz6sawg)

--- 感谢任何指针，我想我需要找到一个脚本，允许隐藏幻灯片，直到滑块/页面在呈现之前完全加载。

***相关的jQuery：***

```
<script type="text/javascript">

jQuery(document).ready(function($){
    $("#photo-rotator").tabs({fx:{opacity: "toggle"}}).tabs("rotate", 6000);
});

</script> 
```

***相关加价：***

```
<!-- Top of Page Slider FRAGILE -->

<div style="min-height: 280px;">

<div id="photo-rotator" style="">
<?php $slide_id=1; ?>
<?php
 $featuredPosts = new WP_Query();
 $featuredPosts->query("showposts=3");
 while ($featuredPosts->have_posts()) : $featuredPosts->the_post();
 ?>

    <div id="slide-<?php echo $slide_id; $slide_id++;?>">
     <a href="<?php the_permalink() ?>" class="post-image">
         <?php the_post_thumbnail( 'rotator-post-image' ); ?>
         <span class="title" style="font-style:italic; color:#999;"><?php the_title(); ?></span>
     </a>
     </div>

    <?php endwhile; ?><!--/close loop-->

    <ul id="slide-nav">
        <?php $nav_id=1; ?>
        <?php while ($featuredPosts->have_posts()) : $featuredPosts->the_post(); ?>
            <li>
                <a href="#slide-<?php echo $nav_id; ?>">
                    <span class="thumbnail" style="display:none;">
                    </span>
                    <p style="color:#F93; font-family:Georgia, 'Times New Roman', Times, serif; font-size: 18px;"><? the_title(); $nav_id++;?></p>

                    <div style="">

                    <!--<?php the_excerpt(); ?>-->

                    <?php if($text= get_post_meta($post->ID, "slidetext", true)) { ?>
                         <div class="">

                         <p style="font-weight: normal; color: #333; font-family: Arial, Helvetica, sans-serif; font-size: 14px;"><?php echo $text; ?></p> 

                         </div>
                        <?php } //else { print"<div>"; } ?>  

                    </div>   

                </a>
            </li>
        <?php endwhile; ?><!--/close loop-->
        </ul>
        </div>

</div>        

<!-- End Top page Slider FRAGILE --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:53:46.243

您的代码有点混乱，这个问题没有帮助，但与您的问题部分有关：

> *您会注意到顶部的滑块，将每个单独的幻灯片加载到垂直列表中（占用大约 1000 像素的空间），然后再捕捉到它应该呈现的方式*

您可以用 div**包装整个滑块**内容并给出`overflow:hidden;`以防止页面加载时 +/-1000px 的高度：

**CSS**

```
#photo-rotatorWrapper {
    width: 960px;
    height: 400px;
    margin: 0 auto;
    overflow: hidden;
} 
```

**HTML**

```
<div id="photo-rotatorWrapper">
  <div id="photo-rotator">
    ...
  </div>
</div> 
```

**注意：** 您可能需要`CSS`为该包装器设置其他声明，以便在当前 HTML 结构中保持正确定位。

# java - 字符串比较不起作用（android）

> ID：10607232
> 
> 赞同：2
> 
> 时间：2012-05-15T19:08:04.940
> 
> 标签：java, android, string, comparison

我的字符串比较不起作用。我不知道为什么。它返回它总是相等的，即使两个字符串不相同

这是我使用的代码

```
if(videoFile.equals(LangSelect.INSTRUCTION_01));
    {
        Log.i("InstructionVideo", "video and instruction are equal\n"+ videoFile + "\n" + LangSelect.INSTRUCTION_01);

        //hideBackButton();
    } 
```

videoFile 是 intro_x.mp4 ，其中 x 更改为从 0 到 4 的数字，而 INSTRUCTION_01 是 into_0.mp4

我的 onCreate 中设置 videoFile 变量的部分

```
 //get which video file to play
    videoFile = getIntent().getExtras().getString("PlayVideo");

    Log.i("InstructionVideo", "videoFile name: " +videoFile); 
```

这是那部分的LogCat

```
 05-15 14:59:57.078: I/InstructionVideo(2952): videoFile name: intro_0.mp4
 05-15 14:59:57.085: I/InstructionVideo(2952): video and instruction are equal
 05-15 14:59:57.085: I/InstructionVideo(2952): intro_0.mp4
 05-15 14:59:57.085: I/InstructionVideo(2952): intro_0.mp4
 05-15 14:59:57.124: I/surfaceCreated(2952): created
 05-15 14:59:58.324: I/LangSelect(2952): 7
 05-15 14:59:58.390: I/InstructionVideo(2952): videoFile name: intro_1.mp4
 05-15 14:59:58.390: I/InstructionVideo(2952): video and instruction are equal 
 05-15 14:59:58.390: I/InstructionVideo(2952): intro_1.mp4
 05-15 14:59:58.390: I/InstructionVideo(2952): intro_0.mp4
 05-15 14:59:58.433: I/surfaceCreated(2952): created
 05-15 14:59:58.484: I/SurfaceDestroyed(2952): destroyed
 05-15 15:00:07.382: I/LangSelect(2952): 7
 05-15 15:00:07.445: I/InstructionVideo(2952): videoFile name: intro_2.mp4
 05-15 15:00:07.449: I/InstructionVideo(2952): video and instruction are equal
 05-15 15:00:07.449: I/InstructionVideo(2952): intro_2.mp4
 05-15 15:00:07.449: I/InstructionVideo(2952): intro_0.mp4
 05-15 15:00:07.488: I/surfaceCreated(2952): created
 05-15 15:00:07.539: I/SurfaceDestroyed(2952): destroyed
 05-15 15:00:23.535: I/LangSelect(2952): 7
 05-15 15:00:23.597: I/InstructionVideo(2952): videoFile name: intro_3.mp4
 05-15 15:00:23.597: I/InstructionVideo(2952): video and instruction are equal
 05-15 15:00:23.597: I/InstructionVideo(2952): intro_3.mp4
 05-15 15:00:23.597: I/InstructionVideo(2952): intro_0.mp4
 05-15 15:00:23.632: I/surfaceCreated(2952): created
 05-15 15:00:23.687: I/SurfaceDestroyed(2952): destroyed
 05-15 15:00:38.843: I/LangSelect(2952): 7
 05-15 15:00:38.902: I/InstructionVideo(2952): videoFile name: intro_4.mp4
 05-15 15:00:38.906: I/InstructionVideo(2952): video and instruction are equal
 05-15 15:00:38.906: I/InstructionVideo(2952): intro_4.mp4
 05-15 15:00:38.906: I/InstructionVideo(2952): intro_0.mp4
 05-15 15:00:38.941: I/surfaceCreated(2952): created
 05-15 15:00:38.992: I/SurfaceDestroyed(2952): destroyed
 05-15 15:01:13.242: I/LangSelect(2952): 7
 05-15 15:01:13.296: I/SurfaceDestroyed(2952): destroyed 
```

它表明，即使我比较它们，它们也会返回 true，但不是

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-15T19:15:08.057

`;`“if”行的末尾有一个，它终止了“if”语句，因此始终执行以下块。

# javascript - Facebook Javascript SDK 这些事件之间的区别？

> ID：10607233
> 
> 赞同：1
> 
> 时间：2012-05-15T19:08:16.773
> 
> 标签：javascript, facebook, coffeescript, facebook-javascript-sdk

我试图弄清楚这些事件之间的区别是什么。它们似乎在本地 sinatra 服务器和部署到 heroku 的服务器之间表现不同。它们通常只是在任何 localhost 与实际部署之间表现不同。如果有人能让她对此有所了解，那么我就不必一直摆弄它了。

```
FB.Event.unsubscribe ('auth.authResponseChange') , @oAuthVars
FB.Event.unsubscribe ('auth.statusChange' ) , @oAuthVars 
```

（这是在咖啡里）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-18T20:45:56.873

这两个事件的区别在于 auth.authResponseChange 在当前会话的信息发生变化时被触发，而 auth.statusChange 在会话本身发生变化时被触发。因此，例如，当用户登录或注销时，会触发 statusChange。如果有关会话本身的某些内容发生变化，例如 expiresIn 时间，则会触发 auth.authResponseChange 事件。

# django - Django 1.4 创建编辑用户配置文件帐户设置视图

> ID：10607235
> 
> 赞同：3
> 
> 时间：2012-05-15T19:08:27.177
> 
> 标签：django, django-models, django-forms

一些背景知识，我一直在为我们的 Django 数据库系统设计用户配置文件，目前正在尝试创建一个视图页面以允许用户编辑他们的帐户设置（在管理页面之外）。我搜索了许多资源，其中大多数建议使用 .get_profile()，但是无论我尝试哪种方法（据我所知和研究完成），这在我的程序中都不起作用。到目前为止，我已经使用 .get_profile() 的 django 主页来查看如何正确使用 .get_profile() 并找到 AUTH_PROFILE_MODULE 设置（我会稍微指定我的设置）。
使用这个网站： [http](http://www.turnkeylinux.org/blog/django-profile) : //www.turnkeylinux.org/blog/django-profile 我发现了一些其他使用 .get_profile() 的方法，但仍然没有任何效果。（我不会添加其余的链接我'

回到这个问题，任何人都可以推荐一种可行的方法，以便我可以获取用户信息以设置一些默认值以维护他们当前的设置，如果他们选择不编辑它们并且只使用新提交的值更新它们。

到目前为止我有：（希望所有相关部分）

文件目录：~/Documents/project1

设置.py

```
AUTH_PROFILE_MODULE = "accounts.Account" 
```

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~`

文件位置：project1/accounts

模型.py

```
# additional model to incorporate our custom fields to the auth user model                                                                                   
class Account(models.Model):
    userLink = models.OneToOneField(User)      #link (pointer) to the users other     information in User model                                                  
    birthdate = models.DateField(blank = True) # True makes this field optional                                                                              
    gender = models.CharField(max_length = 1, choices = GENDER_CHOICE, null = True)

    def __unicode__(self):            # define a unicode for the user to access                                                                              
        return u'%s %s' % (self.userLink.first_name, self.userLink.last_name)   # return first and last name

# custom Form to change user account information (can't be a modelForm)                                                                                      
class EditAccountForm(forms.Form):
    gender = forms.CharField(max_length = 1)#, choices = GENDER_CHOICE, null = True)                                                                         
    birthdate = forms.DateField(widget = SelectDateWidget()) # True makes this field   optional 
```

～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～～

视图.py

```
# Account settings view                                                                                                                                      
@login_required
def AccountSettings(request):
    sluggedSettingError = request.GET.get('error', '') # error message with slugged character                                                                
    settingError = sluggedSettingError.replace('-', ' ')
    settingForm = AdditionalForm(request.POST or None) # variable is called in     edit_user.html                                                                
    # might want to have some way to create a new profile if the account doesn't exist                                                                       
    userSettings = Account.objects.filter(userLink=request.user)
#    userSettings = request.user.get_profile() # returns the current settings of the     users profile                                                           
#### Currently trying to get it to let me use get_profile() ########                                                                                         
    print "userLink = %s" % userSettings#.user                                                                                                               
#    print "Gender = %s" % userSettings.gender # testing print                                                                                               
    if request.method == 'POST':
#        if settingForm.is_valid():                                                                                                                          
#            settingForm.save();                                                                                                                             
        return HttpResponseRedirect('/')
    return render_to_response("user_settings.html", {'settingForm': settingForm,   'settingError': settingError}, context_instance = RequestContext(request))
#        gender = request.POST['gender']  # pass in the gender variable from post                                                                            
#        birthdate = request.POST['birthdate']   # pass in the birthdate from post 
```

由于代码目前我放弃了 .get_profile() 方法并尝试通过可用帐户进行查询，直到找到匹配的 userLink 然后将其保存到变量“userSettings”。我采用的方法是将此变量用作 userSettings.gender、userSettings.birthdate 等来访问每个用户设置，如果更新则更改它们，如果没有则设置为以前的值（使用一系列 if 语句或一些内置 Django 函数）。

我不确定这是否是最有效的方法，或者我是否应该恢复到 get_profile() 方法。当我使用 get_profile() （因为它当前在注释掉的行中输入）时，我收到以下错误无法将关键字“用户”解析到字段中。选项有：生日、性别、id、userLink

我还使用定义为“用户”的 userLink 使用新数据库尝试了这种方法，以匹配 django.docs 网站指定的内容，但仍然收到有关帐户不存在的错误。我尝试从 [https://bitbucket.org/filmaster/filmaster-test/src/1618b18003ed/film20/userprofile/views.py](https://bitbucket.org/filmaster/filmaster-test/src/1618b18003ed/film20/userprofile/views.py)创建一个 try: and except: 方法 来处理这个错误，但这也没有产生任何积极的结果。

我不知道如何让 .get_profile() 工作，并且想不出任何东西可以让我访问用户存储的信息，以便他们可以以表格形式对其进行编辑。我不确定我是否了解此时如何正确使用它，并且觉得我此时只是在转圈。如果有人可以帮助我，我将不胜感激。我试图提供尽可能多的相关信息，但如果您需要其他信息来帮助我，请告诉我，我会尽快提供。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T22:12:27.573

要将配置文件附加到用户对象，您只需调用`get_profile()`用户对象：

```
user.get_profile() 
```

例如，

```
request.user.get_profile() 
```

上面的文档在[Django Docs](https://docs.djangoproject.com/en/dev/topics/auth/#storing-additional-information-about-users)中。值得注意的是

> 如果配置文件不存在，则 get_profile() 方法不会创建配置文件。

所以你必须有一个触发器来创建创建用户的配置文件......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-27T10:19:40.837

`user.get_profile()`现在已折旧，相反，假设您有一个带有用户模型的 OneToOne，您可以使用`user.profile`

# html - 应该将 action='' 设置为什么 提交到同一页面？

> ID：10607238
> 
> 赞同：0
> 
> 时间：2012-05-15T19:08:36.867
> 
> 标签：html

'action='' 应该设置为什么，以便将同一页面用于提交？

当我提交以下内容时，目前我有： action="./diag_system_page_controls.htm" ..但是我可以只使用 action="" 来表示我想重新加载同一页面吗？

```
 <span hidden="hidden">
                <form id="SNMP_operation_windmarks_form_id" class="body_t" action="./diag_system_page_controls.htm" method="post" >  
            <!-- A page-to-vxworks windmark field must be <input> and needs id= name= value= 
                    and cannot be used bi-directionally...-->

                   <!-----------  PAGE-TO-MM WINDMARKS GO HERE:   -------------->
                  <!--  EXAMPLE:
                <input id="SNMP_signal_element_id" type="text" name="SNMP_signal_windmark" value="$%SNMP_signal_windmark#$" />
                <input id="SNMP_IP_windmark_id" type="text" name="SNMP_IP_windmark" value="$%SNMP_IP_windmark#$" />
                <input id="SNMP_OID_list_windmark_id" type="text" name="SNMP_OID_windmark" value="$%SNMP_OID_windmark#$" />
                <input id="SNMP_set_data_windmark_id" type="text" name="SNMP_set_data_windmark" value="$%SNMP_set_data_windmark#$" />
                <input type="submit" />                                  -->
                </form>
                 <!-----------  MM-TO-PAGE WINDMARKS GO HERE:   -------------->
                 <!-- EXAMPLE:
                 <br />SNMP_signal_done_windmark:
                <span id="SNMP_signal_done_element_id" >$%SNMP_signal_done_windmark#$</span>
                -->
           </span> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:11:19.507

一个空白动作将完成你想要的，但这通常被认为是错误的形式。如果由于某种原因页面名称是动态的，您可以使用您选择的服务器端语言为您提供信息。在 PHP 中，它看起来像：

```
action="<?php echo htmlspecialchars($_SERVER['PHP_SELF'], ENT_HTML5, 'utf-8); ?>" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:09:21.697

很简单，应该是同一页。虽然您可以将其留空，但它是无效的，应该避免使用。不要依赖浏览器做出正确的决定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:33:50.090

使用`action=""`.

根据 HTML 规范，`action`属性值应为 URL，但空字符串为 URL，按照[Internet 标准 66](https://www.rfc-editor.org/rfc/rfc3986)第 4.4 节解释为同文档引用。

HTML5 草案（正在进行中）建议禁止空值，另一方面，使`action`属性可选，将操作默认为空字符串。如果你问我，这很奇怪。

无论如何，您可以省略该属性或将其设置为空字符串，效果相同。设置它对我来说看起来更多信息：作者不仅忘记了它，而且故意创建了同页参考。

# javascript - SetTimeout 函数仍然使 UI 无响应，直到其操作结束

> ID：10607239
> 
> 赞同：1
> 
> 时间：2012-05-15T19:08:37.757
> 
> 标签：javascript, jquery

我已经用 setTimeout 函数包装了长时间运行的逻辑（longLoop），但 UI 仍然没有响应，直到长时间运行执行结束。它不允许单击其他 UI 按钮。请查看我下面的示例，如果您发现任何问题，请告诉我。

```
function longLoop () {
    var startLogTime, endLogTime;
    startLogTime = new Date().getTime();
    console.log("loop begin");
    for (var i = 0; i <= 500000000; i++) {
        var j = 10;
    }
    endLogTime = new Date().getTime();
    console.log("loop execution takes " + (endLogTime - startLogTime) + " milliseconds");
}

$(document).ready(function () {

    $("#btnButton").bind("click", function () {
        setTimeout(longLoop, 15);

    });

    $("#anotherButton").bind("click", function () {
        console.log("another operation clicked");
    });
});

<input type="button" id="btnButton" value="Start Long Operation" />
<input type ="button" id="anotherButton" value= "Another operation" /> 
```

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T19:10:05.037

即使它是“异步的”，`setTimeout`仍然会在主事件循环上调度它的调用。由于主事件循环还接收点击、键盘输入以及网页可能调度的每个事件，因此您只是在延迟长时间操作冻结 UI 的时刻。

如果你想与主事件循环并行运行你的操作，你应该研究[Web 工作者](https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers)，它产生真正的线程（有一些重要的约束）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:12:44.363

JavaScript 是单线程的，所以总是只有一种方法在运行。一旦`longLoop`开始，就什么都做不了了。您可以通过使用新的[HTML5 web workers](http://www.html5rocks.com/en/tutorials/workers/basics/)来规避这个限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:14:09.147

JavaScript[不是多线程语言](https://stackoverflow.com/questions/1663125/is-javascript-multithreaded)，即使你使用 setTimeout，它也在主线程中运行，你只是推迟操作，你应该看看[Web-Workers](http://ejohn.org/blog/web-workers/)，用于在后台运行 cpu 密集型任务的新 JavaScript API

# excel - 使用任务计划程序在运行的 Excel 实例中打开 Excel 文件

> ID：10607241
> 
> 赞同：1
> 
> 时间：2012-05-15T19:08:42.333
> 
> 标签：excel, scheduled-tasks

我使用任务计划程序通过 Excel 自动执行各种夜间任务。通常，该任务会打开一个新的 Excel 实例，然后打开一个指定的文件，该文件执行一些操作并关闭自身（和 Excel）。

现在我有一个需要加载项的任务，并且使用加载项需要单独的身份验证。无法传递我的凭据 - 我必须在加载项加载时手动进行身份验证。因为老式方式总是启动一个新的（未经身份验证的）实例，所以我无法弄清楚需要加载项的任务如何完全自动化。

一种解决方法是在我离开之前打开一个 Excel 实例，对加载项进行身份验证，然后让该实例保持打开状态。然后我理论上可以安排在该实例中打开某个文件（而不是如上所述启动一个新实例来打开文件）并执行需要加载项的任何任务。

是否可以通过以某种方式直接定义任务或在我可以按计划运行的 .bat 文件中执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-29T18:18:48.163

我有一个非常相似的问题，想知道您是否已经通过 VBA（getobject()、sendmessage 方法等）解决了这个问题。我为此创建了一个单独的问题，只是展示了我所做的事情。[用于自动身份验证的 Windows FindWindows 和 SendMessgae excel VBA](https://stackoverflow.com/questions/19688674/windows-findwindows-and-sendmessgae-for-auto-authentication-excel-vba) 基本上我被困在如何将用户名和密码传递给加载项弹出窗口。

感谢一百万次：）

# xcode - Interface Builder 的用户定义的运行时属性不接受浮点数？

> ID：10607246
> 
> 赞同：12
> 
> 时间：2012-05-15T19:08:53.583
> 
> 标签：xcode, interface-builder, key-value-coding, kvc

我创建了一个具有 float 属性的 NSView 子类，我想在 Interface Builder 中设置它。在用户定义的运行时属性部分，唯一合适的类型是数字。但是，如果我想输入一个十进制数（使用 . 或 , 作为分隔符），它只会四舍五入到最接近的整数。这是一个错误还是故意的？如何定义浮点数而不是整数？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-05-23T01:12:01.523

使用字符串类型并像这样输入您的值

```
0.7 
```

# asp.net - 当我按下提交按钮时无法在 MVC3 中上传图像并且它没有转到 POST 操作方法

> ID：10607248
> 
> 赞同：2
> 
> 时间：2012-05-15T19:08:55.583
> 
> 标签：asp.net, asp.net-mvc-3, image, uploading

这是我的控制器：

```
public ActionResult Create()

    {
        ViewBag.CategoryID = new SelectList(db.Categories, "CategoryID", "CategoryName");
        return View();
    } 

    //
    // POST: /ManagePhotos/Create

    [HttpPost]
    public ActionResult Create(Photo photo, HttpPostedFile file)
    {
        if (ModelState.IsValid)
        {
            if (file != null && file.ContentLength > 0)
            {
                // save as original size of image
                var newfileName = Guid.NewGuid().ToString() + "_"
                                    + Path.GetFileName(file.FileName);
                var bigImagePath = Path.Combine(Server.MapPath("~/Content/PublicPhotos/BigImages"), newfileName);
                file.SaveAs(bigImagePath);

                // save as thumbnail image
                var photoUploaded = new WebImage(bigImagePath);
                photoUploaded.Resize(width: 200, height: 150, preserveAspectRatio: true, preventEnlarge: true);

                var thumbImagePath = Path.Combine(Server.MapPath("~/Content/PublicPhotos/ThumbImages"), newfileName);

                photoUploaded.Save(thumbImagePath);

            }

            db.Photos.Add(photo);
            db.SaveChanges();
            return RedirectToAction("Index");  
        } 
```

这是我的观点：

```
@using (Html.BeginForm("Create","ManagePhotos", FormMethod.Post, new {enctype = "multipart/form-data"})) 
{

@Html.ValidationSummary(true)
<fieldset>
    <legend>Photo</legend>

    <div class="editor-label">
        @Html.LabelFor(model => model.CategoryID, "Category")
    </div>
    <div class="editor-field">
        @Html.DropDownList("CategoryID", String.Empty)
        @Html.ValidationMessageFor(model => model.CategoryID)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.Name)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Name)
        @Html.ValidationMessageFor(model => model.Name)
    </div>

    <div class="editor-label">
        @Html.Label("File name: ")
    </div>
    <div class="editor-field">
        <input type="file" name="file"/>
    </div>

    <p>
        <input type="submit" value="Create" />
    </p>
</fieldset>

} 
```

我的问题：当我按下“创建”按钮时，网页显示如下：

> 连接被重置。
> 
> 加载页面时重置与服务器的连接。
> 
> 该站点可能暂时不可用或太忙。请稍后再试。如果您无法加载任何页面，请检查您计算机的网络连接。如果您的计算机或网络受到防火墙或代理的保护，请确保允许 Firefox 访问 Web。

我尝试在 Razor View 中进行调试，并在这个网站上查找，我确实做了网站向我展示的内容，但我无法弄清楚。请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T14:29:42.633

您的操作是预期的`HttpPostedFile`，但您应该使用`HttpPostedFileBase`

同样如评论中所述，您需要验证大小不是太大，您可以在 Javascript 中执行此操作

```
function onSelectImage(e) {
    if (e.files[0].size > 256000) {
        alert('The file size is too large for upload');
        e.preventDefault();
        return false;
    }
    ...
    return true;
} 
```

例如，这确保图像只有 256K 或更少

# joomla - Joomla - 按 IP 地址过滤内容（内联网/外联网）

> ID：10607250
> 
> 赞同：1
> 
> 时间：2012-05-15T19:09:13.847
> 
> 标签：joomla, ip, content-management

我们正在开发网站（不幸的是在 Joomla 上），我们需要限制对某些内容的访问 - 文章（如果可能，还包括类别）。

理想情况下，即使从菜单中也应该隐藏此内容。如果我们能够为我们的文章指定三个访问级别就足够了：

*   公众知名度
*   仅对 Intranet 可见
*   仅对外网可见

不幸的是，我们没有找到可以满足我们要求的扩展。你有什么建议，我们应该在哪里实现这个 IP 过滤器（检测 IP 地址并检查它是来自 Intranet 还是 Extranet 是简单的任务，但我们对 Joomla API 还是很陌生）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T02:17:16.333

**正如@Lodder 建议的那样，方法1**将是一个系统插件。它会选择`$_SERVER['REMOTE_ADDR']`（检查这个，就好像你在一个代理后面，另一个变量可能需要检查 - 比如`X-FORWARDED-FOR`或另一个）。然后，您可以检查它与为文章或类别设置的条件——尚未决定如何将特定文章标记为“仅限 Intranet”。在“拒绝访问”的情况下，只需将访问者重定向到主页。默认情况下，所有文章都对所有人开放，并且可以是“内联网”或“外联网”市场。

**方法 2**是拥有两个站点而不是一个站点，共享同一个数据库。他们可以使用单独的模板文件，选择不同的模块位置来放置菜单。因此，系统中将有两组菜单：一组用于 Intranet，一组用于 Extranet。当然，在这种情况下，任何拥有正确链接的人都可以访问任何文章，无论他来自什么 IP。所以它只是一个装饰品。

# c++ - 静态函数中的命名空间

> ID：10607253
> 
> 赞同：1
> 
> 时间：2012-05-15T19:09:16.767
> 
> 标签：c++, static, namespaces

我想写一个小单例类，看起来像：

```
#include <vector>

class Interpreter {

private:
    static Interpreter* interInstance;
    Interpreter() {}

public:
    static Interpreter* getInstance();
    ~Interpreter() {}

};

Interpreter* Interpreter::interInstance = 0;

Interpreter* Interpreter::getInstance(){
if (!interInstance)
    interInstance = new Interpreter();

return interInstance;
} 
```

但这会产生这个异常：

```
multiple definition of `Interpreter::getInstance() 
```

可以通过将类和函数包装在一个命名空间中来纠正此错误。但我真的不明白为什么我需要一个命名空间。有一个 getInstance() 声明和一个实现，不是吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:15:53.047

将定义移到头文件之外，在实现文件中，用于成员初始化和方法：

**解释器.h**

```
class Interpreter {

private:
    static Interpreter* interInstance;
    Interpreter() {}

public:
    static Interpreter* getInstance();
    ~Interpreter() {}

}; 
```

**解释器.cpp**

```
#include "Interpreter.h"
Interpreter* Interpreter::interInstance = 0;

Interpreter* Interpreter::getInstance(){
if (!interInstance)
    interInstance = new Interpreter();

return interInstance;
} 
```

在类或结构定义内部，`static`不会像在外部那样提供符号内部链接，因此您违反了**单一定义规则**。

如果多个翻译单元包含一个包含非内联方法或定义相同符号的标题，您将遇到多个定义。

# mono - 无法在 OS X 的 MonoDevelop 3.0 上构建任何 MonoMac 示例

> ID：10607254
> 
> 赞同：3
> 
> 时间：2012-05-15T19:09:18.233
> 
> 标签：mono, monodevelop, monomac

我刚刚在 OS X (10.7.2) 中完成了 MonoDevelop 3.0 的全新安装，然后对[MonoMac](https://github.com/mono/monomac "MonoMac")进行了 Git 检出。我无法构建 MonoMac 存储库中包含的任何示例，并且每次在输出显示构建成功后都会收到相同的错误：

```
Build failed. Object reference not set to an instance of an object 
```

完整示例构建输出：

```
Cleaning Solution: Fire (Debug)

Cleaning: Fire (Debug)
Removing output files...
Clean complete

Building Solution: Fire (Debug)

Building: Fire (Debug)
Performing main compilation...
/Library/Frameworks/Mono.framework/Versions/2.10.9/bin/dmcs /noconfig "/out:/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/bin/Debug/Fire.exe" "/r:/Library/Frameworks/Mono.framework/Versions/2.10.9/lib/mono/4.0/System.dll" "/r:/Library/Frameworks/Mono.framework/Versions/2.10.9/lib/mono/4.0/System.Xml.dll" "/r:/Library/Frameworks/Mono.framework/Versions/2.10.9/lib/mono/4.0/System.Core.dll" "/r:/Library/Frameworks/Mono.framework/Versions/2.10.9/lib/mono/4.0/System.Xml.Linq.dll" "/r:/Library/Frameworks/Mono.framework/Versions/2.10.9/lib/mono/4.0/System.Drawing.dll" "/r:/Applications/MonoDevelop.app/Contents/MacOS/lib/monodevelop/AddIns/MonoDevelop.MonoMac/MonoMac.dll" /nologo /warn:4 /debug:full /optimize- /codepage:utf8 "/define:DEBUG"  /t:exe "/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/MainWindow.cs" "/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/MainWindowController.cs" "/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/MainWindow.xib.designer.cs" "/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/Main.cs" "/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/AppDelegate.cs" "/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/MainMenu.xib.designer.cs" 

Compiling interface definitions
/Developer/usr/bin/ibtool --errors --warnings --notices --output-format human-readable-text --compile "/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/bin/Debug/Fire.app/Contents/Resources/MainWindow.nib" "/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/MainWindow.xib"
/* com.apple.ibtool.document.warnings */
/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/MainWindow.xib:2: warning: Content rectangle not entirely on screen with the menu bar (May not be completely visible for all screen resolutions and configurations) [9]
/Developer/usr/bin/ibtool --errors --warnings --notices --output-format human-readable-text --compile "/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/bin/Debug/Fire.app/Contents/Resources/MainMenu.nib" "/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/MainMenu.xib"

Copying content files
Copying '/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/bin/Debug/Fire.exe' to '/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/bin/Debug/Fire.app/Contents/MonoBundle/Fire.exe'
Copying '/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/bin/Debug/Fire.exe.mdb' to '/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/bin/Debug/Fire.app/Contents/MonoBundle/Fire.exe.mdb'
Copying '/Applications/MonoDevelop.app/Contents/MacOS/lib/monodevelop/AddIns/MonoDevelop.MonoMac/MonoMac.dll' to '/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/bin/Debug/Fire.app/Contents/MonoBundle/MonoMac.dll'
Copying '/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/fire.png' to '/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/bin/Debug/Fire.app/Contents/Resources/fire.png'
Copying '/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/smoke.png' to '/Users/dave/Dropbox/Code/MonoMac/monomac/samples/Fire/bin/Debug/Fire.app/Contents/Resources/smoke.png'
Build complete -- 0 errors, 0 warnings

Updating application manifest

---------------------- Done ----------------------

Build successful.
Build failed. Object reference not set to an instance of an object 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-17T15:57:29.847

这是一个已知的问题。问题是 MonoDevelop 在您的系统上找不到 MacOSX sdk（大概您使用的是早于 4.3 的 Xcode 版本？）。

我正在为 MonoDevelop 3.0.2 解决这个问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T20:42:29.247

对我来说，事实上我在 IDE 无法识别的 Info.plist 文件中存在冲突是不好的。只需要解决冲突并重建。

# .htaccess - htaccess，文件夹到文件夹重定向有一些问题

> ID：10607258
> 
> 赞同：1
> 
> 时间：2012-05-15T19:09:42.113
> 
> 标签：.htaccess, mod-rewrite, url-rewriting

我在将文件夹重定向到另一个文件夹时遇到问题。该规则似乎“有效”，但在某些时候添加了一些其他东西会绊倒。这里有一个例子：

目标是将流量从旧文件夹（不再存在）重定向到新文件夹。

www.domain.com/one/ **oldfolder** /year/ --> www.domain.com/one/ **newfolder** /year/

所以我设置了以下规则（规范网址的第一个规则）：

```
RewriteEngine on

RewriteCond %{HTTP_HOST} ^domain.com$
RewriteRule ^/?$ "http\:\/\/www\.domain\.com" [R=301,L]

RewriteRule ^(.*)/oldfolder/(.*)$ $1/newfolder/$2 [R=301,L] 
```

问题是它重定向到：

[http://www.domain.com/home/username/public_html/www.domain.com/one/newfolder/year/](http://www.domain.com/home/username/public_html/www.domain.com/one/newfolder/year/)

任何人都可以在我写的规则中发现问题吗？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:16:54.963

1.  检查您的 DocumentRoot
2.  检查目录指令
3.  `RewriteBase /`如果此 .htaccess 文件位于您的文档根目录中，请确保您有。

# r - 使用 ddply 根据日期值查找变量值

> ID：10607260
> 
> 赞同：2
> 
> 时间：2012-05-15T19:09:54.940
> 
> 标签：r, date, plyr

我有一个如下所示的 data.frame：

```
ID     Date.A        Date.B        Variable
A      01/01/2012    03/24/2012    Apples
A      02/01/2012    03/24/2012    Oranges
B      01/01/2012    02/04/2012    Bananas
C      01/01/2012    04/22/2012    Apples
A      03/01/2012    03/24/2012    Grapes
B      02/01/2012    02/04/2012    Oranges
D      01/01/2012    03/15/2012    Apples 
```

对于每个 ID，我需要找到对应于 Date.B 之前一个月的第一天的变量。因此，对于 ID A，我需要提取“Oranges”，因为 03/24/2012 - 1 个月 = 02/24/2012，而该月的第一天是 02/01/2012。

我对使用 lubridate 的日期计算没有任何问题：format.Date(df$Date.B -months(1), format="%Y-%m-01")。在不编写讨厌的 for 循环的情况下，我无法将该逻辑合并到 ddply 或以编程方式。不要求算法帮助或某人为我解决它，但希望看到一个使用与此类似的自定义日期逻辑的 ddply 示例。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T20:08:32.780

这不是`lubridate`or `plyr`，我什至不确定它是否可以解决您的问题。我选择使用该`mondate`软件包的原因 tcash21 指出：

```
10/31/2012 - months(1) 
```

而且我不再使用 plyr，所以我并没有真正考虑 plyr。如果您的数据称为 dat：

```
#Read your data in
dat <- read.table(text="ID     Date.A        Date.B        Variable
A      01/01/2012    03/24/2012    Apples
A      02/01/2012    03/24/2012    Oranges
B      01/01/2012    02/04/2012    Bananas
C      01/01/2012    04/22/2012    Apples
A      03/01/2012    03/24/2012    Grapes
B      02/01/2012    02/04/2012    Oranges
D      01/01/2012    03/15/2012    Apples", header=TRUE)

#This may be unnecessary but when I read your data in the dates were characters
lapply(2:3,  function(i) {dat[, i] <<- as.Date(dat[, i], "%m/%d/%Y")})

library(mondate)
prevmon <- as.character(mondate(dat$Date.B) - 1)  #get minus 1 month
z <- strsplit(prevmon, "-")                       #make it that first of that month
dat$Date.C <- as.Date(sapply(z, function(x) paste(x[1], x[2], "01", sep="-")))

key <- split(dat, dat$ID)                         #make list of data frames by ID 

#fruit finding function
fruiter <- function(x) x[match(x[, "Date.C"][1], x[, "Date.A"]), "Variable"]
sapply(key, fruiter) 
```

产生：

```
 A       B       C       D 
Oranges Bananas    <NA>    <NA> 
```

显然，由于我附加到您的问题的评论中的原因，几个月以来一直存在 NA。

# html - 如何使用 CSS 计数器编写 CSS 选择器以将格式应用于特定元素？

> ID：10607265
> 
> 赞同：0
> 
> 时间：2012-05-15T19:10:15.613
> 
> 标签：html, css, css-selectors

我正在使用 CSS 计数器和嵌套的 OL 创建 HTML/CSS 中的目录，效果很好。现在，我想在顶级 OL 上设置一个类“toc”（因为页面上的 OL 不仅仅是目录）。

如何调整 CSS 选择器以使计数器样式仅适用于`<ol class="toc">`？

如果您从第一个 OL 中删除 class="toc"，您会看到项目编号按照您的预期嵌套......当您添加 toc 类时，一切都会变成锅。如何修复 css 选择器以使嵌套的项目编号按预期工作？

```
<style>
ol {
  counter-reset: section;                /* Creates a new instance of the
                                            section counter with each ol
                                            element */
  list-style-type: none;
  text-decoration:underline;
}
li:before {
  counter-increment: section;            /* Increments only this instance
                                            of the section counter */
  content: counters(section, ".") " ";   /* Adds the value of all instances
                                            of the section counter separated
                                            by a ".". */
  font-weight:bold;
}
</style>​

<ol class="toc">

    <li>item
    <ol>
        <li>item
        <li>item
            <ol>
                <li>item
                <li>item
                <li>item
                <li>item
                <li>item
            </ol>
        </li>
        <li>item
    </ol>
</li>  
<li>item
    <ol>
        <li>item
        <li>item
        <li>item
        <li>item
    </ol>

</li> 
<li>item
    <ol>
        <li>item
        <li>item
        <li>item
        <li>item
        <li>item
        <li>item
    </ol>

</li> 
<li>item
    <ol>
        <li>item
            <ol>
                <li>item
                <li>item
                <li>item
            </ol>
        </li>

        <li>item
            <ol>
                <li>item
                <li>item</li>
                <li>item
                <li>item
                <li>item
                <li>item</li>
            </ol>
        </li>
        <li>item
            <ol>
                <li>item</li>
                <li>item</li>
            </ol>
    </ol>
</li> 
</ol>​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:15:54.110

```
<style>
ol { color:black; }

ol.parentol { color:red; }

ol.childol { color:green; }

 /* nested ols with class of 'childol' 
  will not inherit the red font color */
</style>
<ol>
  <li>zzzzz</li>
  <li>
    <ol class="parentol">
      <li>aaaa</li>
      <li>
       <ol class="childol">
         <li>bbb</li>
       </ol>
      </li>
    </ol>
 </li>
</ol> 
```

# java - 是否有 Google Group API 来访问帖子信息

> ID：10607268
> 
> 赞同：1
> 
> 时间：2012-05-15T19:10:26.253
> 
> 标签：java, google-api, google-groups-api

我正在尝试编写 java 程序来获取我加入的一个 google 组中的所有帖子信息。

是否有任何谷歌群组 API 可以帮助我实现目标？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T12:45:10.460

没有官方的 Google API 可以访问群组中的内容（只有会员数据）。您可以查看抓取数据的选项。有许多抓取 API：[https ://www.google.com.au/search?q=scraping+google+groups](https://www.google.com.au/search?q=scraping+google+groups)

# workflow-foundation-4 - 是否可以以编程方式修改状态机窗口工作流的定义？

> ID：10607274
> 
> 赞同：0
> 
> 时间：2012-05-15T19:10:48.030
> 
> 标签：workflow-foundation-4, state-machine-workflow

我有一个状态机 Windows 工作流程，我想以编程方式对其进行修改。例如，我可能想添加从状态 A 到状态 B 的转换，甚至在状态 A 和状态 B 之间添加一个新状态。

请注意，我不需要修改正在运行的 Windows 工作流实例，而是需要修改 Windows 工作流定义本身。

首先，我将拥有代表工作流的 xaml 文件。我可以完成上述工作的一种方法是直接修改 Windows 工作流 xaml 文件，但我担心这会带来风险和困难。我希望有一些编程接口来操纵工作流程。

我注意到 System.Activities 命名空间中有一些东西，特别是我可以从工作流定义 xaml 文件创建一个 Activity。但是，一旦有了活动，我就无法弄清楚如何操纵它。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T05:38:44.927

有一种方法可以做到这一点，至少是我想做的。

ActivityXamlServices.CreateBuilderReader() 从工作流定义创建一个 ActivityBuilder，ActivityBuilder 可用于修改工作流定义。

谢谢，埃里克

# delphi - TidHttp 文件下载出现内存不足异常

> ID：10607276
> 
> 赞同：4
> 
> 时间：2012-05-15T19:10:55.160
> 
> 标签：delphi, file, download, delphi-2010, indy

考虑以下使用 Indy 组件从 Internet 下载文件的代码：

```
procedure TForm26.Button1Click(Sender: TObject);
var
  vFileStream : TStream;
begin
  DeleteFile('C:\test.exe');
  vFileStream := TFileStream.Create('C:\test.exe', fmCreate);
  IdHTTP1.Get('SomeUrl', vFileStream);
  vFileStream.Free;
end; 
```

我收到内存不足异常。正在发生的事情是，除了我正在使用的事实之外，`TFileStream`正在写入它的字节不会直接进入磁盘，而是会保留在内存中直到`get`终止。

我要下载的文件非常非常大。

有谁知道如何在不出现内存不足异常的情况下下载大文件？

Delphi 2010 和来自 Indy 的 SVN 的最新 Indy 10。

**编辑**

那不是`FileStream`问题。这是一个`Indy`问题。Indy 以某种方式在将文件写入流之前将其缓存在内存中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T20:08:51.833

`TIdHTTP`如果数据被压缩，或者数据是 HTML 并且`TIdHTTP.HTTPOptions`属性不包含`hoNoParseMetaHTTPEquiv`标志，则将整个文件下载到内存中。

Indy 还不支持 HTTP 的流式解压缩（不过它支持 FTP），因此`TIdHTTP`在将整个压缩数据缓存在内存中，然后再将其解压缩到文件中。

在 HTML 通过 HTML`<meta>`标记用新值覆盖 HTTP 标头值（最重要的是数据的 Charset 值）的情况下，有时需要解析 HTML，因此`TIdHTTP`当数据以`String`. 启用该`hoNoParseMetaHTTPEquiv`标志会禁用该解析，从而禁用 HTML 数据的任何缓存（除非也使用压缩）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T20:37:43.693

我发现了这个问题。我在服务器端使用了 Indys`ServeFile`功能。

此函数检查是否`Content-Type`指定了 a，如果没有，它会自动检测`Content-Type`. 问题是我没有更改`Content-Type`它，默认情况下它是 text/html。更改内容类型使客户端直接写入流。

我认为该`serveFile`功能应始终设置正确`Content-Type`以避免此类问题。

在客户端，我发现这段代码对我有很大帮助：

```
 LParseHTML := IsContentTypeHtml(AResponse) and Assigned(AResponse.ContentStream) and not (hoNoParseMetaHTTPEquiv in FOptions);
  LCreateTmpContent := LParseHTML and not (AResponse.ContentStream is TCustomMemoryStream); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T19:27:14.850

您是否尝试通过设置[`Request.ContentRangeStart`](http://www.indyproject.org/docsite/html/TIdEntityHeaderInfo_ContentRangeStart.html)和部分下载文件[`Request.ContentRangeEnd`](http://www.indyproject.org/docsite/html/TIdEntityHeaderInfo_ContentRangeEnd.html)？

# regex - 正则表达式匹配具有转义字符的字符串

> ID：10607284
> 
> 赞同：1
> 
> 时间：2012-05-15T19:11:34.707
> 
> 标签：regex, string-matching

我想编写一个可以匹配以下字符串文字规范的正则表达式。在过去的 10 个小时里，我疯狂地编写了各种似乎都不起作用的正则表达式。最后我归结为这个：

*   `([^"]|(\\[.\n]))*\"`

基本上，要求如下：

1.  必须匹配字符串文字，所以我匹配所有内容直到最后一个“，中间可能有一个 \”，它不应该结束字符串。
2.  我们还可以转义任何内容，包括带有 '\' 的 \n
3.  只有未**转义**的 '"' 字符可以结束匹配，没有别的。

我需要正确匹配的一些示例字符串如下：

1.  \a\b\"\n" => 我应该匹配后面的字符 '\', 'a', '\', 'b', '\','"','\', 'n', '" '
2.  \"this is still inside the string" => 应该匹配整个文本，包括最后一个 '"'
3.  'm about to escape to a newline \'\n'" => 这个字符串中有一个 \n 字符，但字符串仍然应该匹配从开始 'm' 到结束 '"' 的所有内容。

请有人帮我制定这样的正则表达式。在我看来，我提供的正则表达式应该可以完成这项工作，但它无缘无故地失败了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:17:06.510

您的正则表达式几乎是正确的，您只需要注意在字符类中，句`.`点只是一个文字`.`，而不是*除 newline 之外的任何字符*。所以：

```
([^"\\]|\\(.|\n))*\" 
```

或者：

```
([^"\\]|\\[\s\S])*\" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:30:00.260

我认为这会更有效：

```
[^"\\]*(\\.[^"\\]*)*\" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:32:35.050

我假设您的字符串也以 " 开头（您的示例不应该以它开头吗？）

Lookaround 结构对我来说似乎是最自然的使用：

```
".*?"(?<!\\") 
```

给定输入

```
"test" test2 "test \a test"  "test \"test" "test\"" 
```

这将匹配：

```
"test"
"test \a test"
"test \"test"
"test\"" 
```

正则表达式如下：

```
Match the character “"” literally «"»
Match any single character that is not a line break character «.*?»
   Between zero and unlimited times, as few times as possible, expanding as needed (lazy) «*?»
Match the character “"” literally «"»
Assert that it is impossible to match the regex below with the match ending at this position (negative lookbehind) «(?<!\\")»
   Match the character “\” literally «\\»
   Match the character “"” literally «"» 
```

# java - 客户端停止响应服务器的消息

> ID：10607286
> 
> 赞同：0
> 
> 时间：2012-05-15T19:11:51.353
> 
> 标签：java, swing, sockets, concurrency, timer

我遇到了一个新问题。我正在用 Java+Swing 编写一个信使，我选择了这种方式来进行客户端与服务器的对话：

我有课程正在运行（所有代码都用于客户端）（服务器正常 - 我检查过）

```
public class Running {
private Socket s;
private PrintStream ps;
private BufferedReader br;

public Running(){
try{
    s = new Socket(InetAddress.getLocalHost(), 8072);
    ps = new PrintStream(s.getOutputStream());
    br = new BufferedReader(new InputStreamReader(s.getInputStream()));
} catch (UnknownHostException ex) {
    System.out.println("11");
    ex.printStackTrace();
} catch (IOException ex) {
    System.out.println("00");
    ex.printStackTrace();
}
}

public String receiveLine(){
    String ret = "";
    try {
        ret = br.readLine();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return ret;
}

public void sendLine(String s){
    ps.println(s);
}

public void close(){
    try {
        s.close();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} 
```

}

我主要做一个变量

```
 run = new Running(); 
```

然后我将这个变量发送到任何地方，它似乎工作。它提供 readline 或 writeline throwgh 套接字。我可以注册用户、登录或添加联系人。

我可以打开一个 MessageFrame 向我的联系人发送消息。但是当我关闭它时，我的程序停止对服务器的消息做出正确的反应。它仅对 30-70% 的消息作出反应。我检查了 - 服务器没问题。所以问题出在 Running 或 MessageFrameListener

```
public class MessageFrameListener{
private MessageFrame mf;
private User us;
private Contact cn;
private Timer timer;
private Running run;

public MessageFrameListener(MessageFrame m_f, User u_s, Contact c_n, Running r_n){
    run = r_n;
    mf = m_f;
    us = u_s;
    cn = c_n;
    m_f.addButtonListener(new SButtonListener());
    m_f.addWinListener(new FrameListener());
    timer = new Timer(500,new timerListener());
    timer.start();
}

public class timerListener implements ActionListener{
    public void actionPerformed(ActionEvent e) {
                SwingWorker<String,Void> sw = new SwingWorker<String,Void>(){
                    public String doInBackground() {
                        String ret = "";
                        ret = run.receiveLine();
                        return ret;
                    }
                    public void done() {
                        String[] results = null;

                            try {
                                results = get().split(" ");
                            } catch (InterruptedException
                                    | ExecutionException e) {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                            }

                        if("m".equals(results[0])){
                            if("-1".equals(results[2]))
                                mf.addLine2("Error");
                            else{
                                mf.addLine2(results[3]);
                            }
                        }

                    }
                };
                sw.execute();
    }
}

public class SButtonListener implements ActionListener{
    public void actionPerformed(ActionEvent e) {
            String insert = mf.getInput();
            if(!insert.equals("")){
                String infoString = "m "+us.getName()+" "+cn.getName()+" "+insert;
                run.sendLine(infoString);
                mf.addLine(insert);
                mf.refreshInput();
            }
    }
}

public class FrameListener implements WindowListener{

    @Override
    public void windowClosing(WindowEvent e) {
        timer.stop();
        timer = null;
        mf.close();
    } 
```

新的消息！我开始调试。我的客户端从服务器获取消息并到达此行

```
 mf.addLine2(results[3]); 
```

但随后什么也没有发生！Swing 不会添加新行。

addLine2的代码：

```
 public void addLine2(String line){
    //dialogArea.append(line+"\n");

    try { 
        if(line != ""){
            String formLine = us.getName()+" ("+now()+")\n";
            doc.insertString(doc.getLength(), formLine+line+"\n",st2);
        }

    }   
    catch (BadLocationException e){
        e.printStackTrace();
    }

} 
```

当然行！=""; 可能是线程的一些 Swing 问题？Swing 不能处理我的请求？

瓦西里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T03:41:05.583

在我看来问题出在这一行，您的 PrintStream 未设置为自动刷新，因此尝试更改此行：

```
ps = new PrintStream(s.getOutputStream()); 
```

对此

```
ps = new PrintStream(s.getOutputStream(), true); 
```

因此，它不会将输入存储到缓冲区，而是自动将其刷新。有关更多信息 [PrintStream（OutputStream 输出，布尔型 autoFlush）](http://docs.oracle.com/javase/7/docs/api/java/io/PrintStream.html#PrintStream%28java.io.OutputStream,%20boolean%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:28:02.317

这可能是因为 readLine 方法希望该行以 \n 结尾。尝试让服务器发送消息并在其末尾添加一个 \n

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T19:45:47.990

嘿，他说的是对的，该字符串将与 /n 一起使用，但它正在尝试获取。

```
in that just try with  **While** condition , that till true get the string . 
```

这是样本，

```
try {
        while(true) {

            DataInputStream is = new                      DataInputStream(sock.getInputStream());
          System.out.println("" +is.readLine());

            line =is.readLine();

        } // end of while
    } catch(Exception ex) {}
} 
```

# java - 从嵌套的 HashMap 中获取值到另一个 Map

> ID：10607287
> 
> 赞同：1
> 
> 时间：2012-05-15T19:11:55.487
> 
> 标签：java, arraylist, nested, hashmap

嗨，我想存储嵌套 Map 的键和值，如下所示：

```
Map<ArrayList <String>, Map<String, Integer>> NestedMap = new HashMap<ArrayList<String>, Map<String, Integer>(); 
```

进入另一个变量，让我们说 getKeyFromInsideMap 和 getValueFromInsideMap。因此，对访问感兴趣的是内部 Map String 和 Integer 的值。我如何在代码中做到这一点？

我在论坛中尝试了几个示例，但我不知道语法是什么样的。您能否为此提供一些代码。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T19:16:11.710

您从嵌套的 Map 中获取值的方式与从未嵌套的 Map 中获取值的方式相同，您只需应用相同的过程两次：

```
//Java7 Diamond Notation
Map<ArrayList, Map<String, Integer>> nestedMap = new HashMap<>();

//get nested map 
Map<String, Integer> innerMap = nestedMap.get(some_key_value_string);

//now get the Integer value from the innerMap
Integer innerMapValue = innerMap.get(some_key_value_string); 
```

此外，如果您正在寻找特定的键，您可以像这样遍历地图：

```
Iterator it = map.entrySet().iterator();
while (it.hasNext()) {
    Map.Entry pairs = (Map.Entry)it.next();
    System.out.println("Key: " + pairs.getKey() + " Val: " + pairs.getValue()));
    it.remove(); // avoids a ConcurrentModificationException
} 
```

这将遍历*单个*映射的所有键和值。

希望这可以帮助。

# java - JSF 2.0 - 改变组件样式

> ID：10607290
> 
> 赞同：1
> 
> 时间：2012-05-15T19:12:03.877
> 
> 标签：java, jsf-2, components

我有简单的组件 - CommandButton

```
 <tr:commandButton text="test" styleClass="form-button"
    actionBean="#{testPage}" action="synchAction" 
    partialSubmit="true" id="btnId" /> 
```

此 commandButton 使用**styleClass** 表单按钮。

我在支持 bean 中有一些布尔成员，它在某些事件触发后更改它的值。

是否可以根据该布尔值更改我的 commandButton **StyleClass ？**

我的意思是，当这个布尔值变为 true 时，commandButton styleClass 将更改为其他样式。

我很感激任何帮助，

谢谢，

约翰

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T19:16:48.693

`styleClass`在属性中使用 el 表达式和三元运算符：

```
 <tr:commandButton text="test" 
             styleClass="#{bean.boolVal ? 'form-button' : 'another-style'}"
             actionBean="#{testPage}" action="synchAction" 
             partialSubmit="true" id="btnId" /> 
```

# python - 嵌套参数未编译

> ID：10607293
> 
> 赞同：26
> 
> 时间：2012-05-15T19:12:25.803
> 
> 标签：python, python-3.x, compatibility, python-2.x

我正在尝试将我的代码编译成 Python 3 模块。当我在 IDLE 中选择“运行模块”时它运行良好，但当我尝试创建分发时收到以下语法错误：

```
File "/usr/local/lib/python3.2/dist-packages/simpletriple.py", line 9
    def add(self, (sub, pred, obj)):
                  ^
SyntaxError: invalid syntax 
```

谁能帮忙指出语法有什么问题？这是完整的代码：

```
import csv

class SimpleGraph:
    def __init__(self):
        self._spo = {}
        self._pos = {}
        self._osp = {}

    def add(self, (sub, pred, obj)):
        """
        Adds a triple to the graph.
        """
        self._addToIndex(self._spo, sub, pred, obj)
        self._addToIndex(self._pos, pred, obj, sub)
        self._addToIndex(self._osp, obj, sub, pred)

    def _addToIndex(self, index, a, b, c):
        """
        Adds a triple to a specified index.
        """
        if a not in index: index[a] = {b:set([c])}
        else:
            if b not in index[a]: index[a][b] = set([c])
            else: index[a][b].add(c)

    def remove(self, (sub, pred, obj)):
        """
        Remove a triple pattern from the graph.
        """
        triples = list(self.triples((sub, pred, obj)))
        for (delSub, delPred, delObj) in triples:
            self._removeFromIndex(self._spo, delSub, delPred, delObj)
            self._removeFromIndex(self._pos, delPred, delObj, delSub)
            self._removeFromIndex(self._osp, delObj, delSub, delPred)

    def _removeFromIndex(self, index, a, b, c):
        """
        Removes a triple from an index and clears up empty indermediate structures.
        """
        try:
            bs = index[a]
            cset = bs[b]
            cset.remove(c)
            if len(cset) == 0: del bs[b]
            if len(bs) == 0: del index[a]
        # KeyErrors occur if a term was missing, which means that it wasn't a valid delete:
        except KeyError:
            pass

    def triples(self, (sub, pred, obj)):
        """
        Generator over the triple store.
        Returns triples that match the given triple pattern. 
        """
        # check which terms are present in order to use the correct index:
        try:
            if sub != None: 
                if pred != None:
                    # sub pred obj
                    if obj != None:
                        if obj in self._spo[sub][pred]: yield (sub, pred, obj)
                    # sub pred None
                    else:
                        for retObj in self._spo[sub][pred]: yield (sub, pred, retObj)
                else:
                    # sub None obj
                    if obj != None:
                        for retPred in self._osp[obj][sub]: yield (sub, retPred, obj)
                    # sub None None
                    else:
                        for retPred, objSet in self._spo[sub].items():
                            for retObj in objSet:
                                yield (sub, retPred, retObj)
            else:
                if pred != None:
                    # None pred obj
                    if obj != None:
                        for retSub in self._pos[pred][obj]:
                            yield (retSub, pred, obj)
                    # None pred None
                    else:
                        for retObj, subSet in self._pos[pred].items():
                            for retSub in subSet:
                                yield (retSub, pred, retObj)
                else:
                    # None None obj
                    if obj != None:
                        for retSub, predSet in self._osp[obj].items():
                            for retPred in predSet:
                                yield (retSub, retPred, obj)
                    # None None None
                    else:
                        for retSub, predSet in self._spo.items():
                            for retPred, objSet in predSet.items():
                                for retObj in objSet:
                                    yield (retSub, retPred, retObj)
        # KeyErrors occur if a query term wasn't in the index, so we yield nothing:
        except KeyError:
            pass

    def value(self, sub=None, pred=None, obj=None):
        for retSub, retPred, retObj in self.triples((sub, pred, obj)):
            if sub is None: return retSub
            if pred is None: return retPred
            if obj is None: return retObj
            break
        return None

    def load(self, filename):
        f = open(filename, "rb")
        reader = csv.reader(f)
        for sub, pred, obj in reader:
            sub = unicode(sub, "UTF-8")
            pred = unicode(pred, "UTF-8")
            obj = unicode(obj, "UTF-8")
            self.add((sub, pred, obj))
        f.close()

    def save(self, filename):
        f = open(filename, "wb")
        writer = csv.writer(f)
        for sub, pred, obj in self.triples((None, None, None)):
            writer.writerow([sub.encode("UTF-8"), pred.encode("UTF-8"), obj.encode("UTF-8")])
        f.close()

if __name__ == "__main__":
    g = SimpleGraph()
    g.add(("blade_runner", "name", "Blade Runner"))
    g.add(("blade_runner", "name", "Blade Runner"))
    g.add(("blade_runner", "release_date", "June 25, 1982"))
    g.add(("blade_runner", "directed_by", "Ridley Scott"))

    print list(g.triples((None, None, None)))
    print list(g.triples(("blade_runner", None, None)))
    print list(g.triples(("blade_runner", "name", None)))
    print list(g.triples(("blade_runner", "name", "Blade Runner")))
    print list(g.triples(("blade_runner", None, "Blade Runner")))
    print list(g.triples((None, "name", "Blade Runner")))
    print list(g.triples((None, None, "Blade Runner")))

    print list(g.triples(("foo", "name", "Blade Runner")))
    print list(g.triples(("blade_runner", "foo", "Blade Runner")))
    print list(g.triples(("blade_runner", "name", "foo"))) 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-05-15T19:16:59.787

[PEP 3113](http://www.python.org/dev/peps/pep-3113/)解释了为什么在 Python 3 中删除了“元组参数解包”这一特性。它还解释了如何移植使用它们的代码。在这种情况下，您需要更改如下函数：

```
def add(self, (sub, pred, obj)):
    self._addToIndex(self._spo, sub, pred, obj)
    self._addToIndex(self._pos, pred, obj, sub)
    self._addToIndex(self._osp, obj, sub, pred) 
```

到将元组作为单个参数传递并手动解包的版本：

```
def add(self, sub_pred_obj):
    sub, pred, obj = sub_pred_obj
    self._addToIndex(self._spo, sub, pred, obj)
    self._addToIndex(self._pos, pred, obj, sub)
    self._addToIndex(self._osp, obj, sub, pred) 
```

* * *

对于一个`lambda`函数，你不能使用赋值来解包。最好的解决方案通常是不打开包装。例如，改变这个：

```
lambda (x, y): (y, x) 
```

……对此：

```
lambda xy: (xy[1], xy[0]) 
```

对于复杂的函数，这可能会变得很难看——但对于复杂的函数，你可能还是想要`def`它们。

* * *

值得注意的是，通过[`2to3`](https://docs.python.org/3/library/2to3.html)、[`modernize`](https://pypi.org/project/modernize/)或运行您的代码会在和[`futurize`](https://pypi.org/project/future/)中发现此问题，并准确建议以下解决方案：`def``lambda`

```
$ echo 'lambda (x,y): (y,x)' | 2to3 -
--- <stdin> (original)
+++ <stdin> (refactored)
@@ -1 +1 @@
-lambda (x,y): (y,x)
+lambda x_y: (x_y[1],x_y[0])

$ echo -e 'def foo((x,y)):\n    return (y,x)\n' | 2to3 -
--- <stdin> (original)
+++ <stdin> (refactored)
@@ -1 +1 @@
-def foo((x,y)):
+def foo(xxx_todo_changeme):
+    (x,y) = xxx_todo_changeme 
```

如果您尝试将 Python 2.x 代码移植到 3.x（或双版本代码）并且不了解这两种语言，那么您几乎可以肯定想要使用其中一种工具——或者包装它们的 IDE 插件-帮助。（尽管您可能不想按原样使用它的输出。）

# c# - 动态显示数据

> ID：10607296
> 
> 赞同：0
> 
> 时间：2012-05-15T19:12:35.250
> 
> 标签：c#, asp.net

我想使用 asp 和 C# 将数据库中的数据显示到内容页面上。从数据库获取数据并将其显示到网格视图很简单，我想要一些更高级的东西，它使我能够自定义正在显示的数据的布局，而不是看起来像表格中的数据。

我想为每个项目动态创建组件。例如，每个项目都有一个面板，带有标签（显示数据）和一个按钮，在同一个面板中显示更多数据。然后我打算通过使用底部的多视图和超链接来更改页面来进行一种分页。如果一页中有超过 10 个项目，则页面将增加。

我真正想要的是什么是最好的解决方案/方法来以有组织的方式显示数据，而不是看起来像表格的设计。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:19:04.430

我听起来像`Repeater`控制正是你要找的。它将允许您指定如何显示单个项目的模板（不需要是表中的行，它可以是顺序面板，或者您想要的任何其他内容）。然后，您可以像绑定 GridView 一样将数据绑定到该转发器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:19:46.080

您可以使用核心 ASP.NET 控件（Repeater、Pager 等）以及 JavaScript 和 CSS 的组合构建所有这些功能，但您要求的功能存在于几个不同的第三方组件套件（Telerik、DevExpress 、Infragistics、ComponentOne 等）您会发现关于哪些更好的不同意见，因此请评估每个并确定最适合您正在寻找的和/或您能负担得起的。

在网络上搜索“ASP.NET 控件”以查看一些更流行的库。

# ruby-on-rails-3 - Rails 中 Force_SSL 的对面？

> ID：10607297
> 
> 赞同：2
> 
> 时间：2012-05-15T19:12:38.323
> 
> 标签：ruby-on-rails-3, ssl

我正在运行一个 Rails 3.1.4 应用程序，该应用程序需要一些页面使用 force_ssl，但其他一些我不想使用 SSL。force_ssl 有没有相反的东西，比如 force_http？问题是我有一些不需要 SSL 的页面，并且它们包含我无法使用 https 拉过来的元素（因此用户从浏览器中得到不安全的错误）。

发生的情况是，当有人转到 force_ssl 页面时它工作正常，但是当他们转到不是 force_ssl 的其他页面时，他们会从浏览器收到不安全的页面错误，因为 https 仍然存在。因此，我想强制我无法使元素 https 避免使用 SSL 的页面（即强制它回到 http）。

先感谢您。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-18T08:33:04.670

好的，我找到了一种似乎对我有用的方法：

在我的会话控制器中，我添加了这个：

```
force_ssl :only => [:new, :create] 
```

所以只有这两个动作会被 SSL 调用。现在，用户成功登录后，页面将重定向到非 SSL 连接。

至于强制页面为非 SSL，请尝试以下问题：[Rails 3.1 Force Regular HTTP](https://stackoverflow.com/questions/7478911/rails-3-1-force-regular-http)，使用 before_filter 查找 Joost 的答案。

这是他发布的内容：

```
class ApplicationController < ActionController::Base
  before_filter do
    if request.ssl && Rails.env.production?
      redirect_to :protocol => 'http://', :status => :moved_permanently
    end
  end
end 
```

**免责声明**：上面的代码不是我的，我从链接中的问题中复制了它，只是为了方便起见放在这里。请访问上面的链接以查看其原始上下文。

此外，关于强制非 SSL，我不确定这是一个好主意。如果用户请求 SSL 连接并且您拥有证书，为什么不给他们呢？我同意 SSL 确实给浏览器带来了更大的压力，但有些人一直喜欢在 SSL 上冲浪。如果您有一些不能通过 SSL 运行的代码，那么这是强制使用非 SSL 的正当理由。

干杯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-02T20:04:38.227

让它在没有循环的情况下工作。除非它发生在我不知道的浏览器中。

```
before_filter do
  unless params[:controller] == 'whatever_controller_name_you_are_serving_https_to'
    if request.ssl? && Rails.env.production?
      redirect_to :protocol => 'http://', :status => :moved_permanently
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-23T22:26:01.893

`force_ssl`假设（希望）您已升级到受支持的 Rails 版本，除非声明，否则这是实现默认非 SSL 的一种简单方法。它的形式是`ActiveSupport::Concern`：

```
module ForceNoSSL
  extend ActiveSupport::Concern

  ACTION_OPTIONS = [:only, :except, :if, :unless]

  def force_no_ssl_redirect
    if request.ssl?
      options = {
        :protocol => 'http://',
        :host     => request.host,
        :path     => request.fullpath,
        :status   => :moved_permanently
      }

      redirect_to ActionDispatch::Http::URL.url_for(options)
    end
  end

  class_methods do
    def force_ssl(options = {})
      super

      action_options = options.slice(*ACTION_OPTIONS)
      skip_before_action :force_no_ssl_redirect, **action_options
    end

    def force_no_ssl
      before_action :force_no_ssl_redirect
    end
  end
end 
```

那么在你的`ApplicationController`你：

```
include ForceNoSSL
force_no_ssl 
```

它的工作原理是默认情况下所有操作都将运行`force_no_ssl_redirect`回调。如果它已经是非 ssl 连接，则不会执行任何操作，否则请求将被重定向到`http://`.

但是，如果您已声明`force_ssl`，则将`force_no_ssl_redirect`跳过回调（仅适用于 指定的那些操作`ACTION_OPTIONS`）。

您可以扩展它以允许`force_no_ssl`接受 URL 选项等......就像`force_ssl`操作一样，但对于我的用例来说，这不是必需的。

PS 很多代码都来自于此，`ActionController::ForceSSL`因此请查看以获取更多信息。

# asp.net-mvc - MVC POCO 控制器和流畅的路由

> ID：10607301
> 
> 赞同：1
> 
> 时间：2012-05-15T19:13:05.293
> 
> 标签：asp.net-mvc, asp.net-mvc-routing, poco, fluent-interface

是否有任何 MVC 框架将 POCO 概念应用于控制器？

示例：
假设我不想让我的控制器依赖于任何 Web 框架，因为我不再需要从框架 Controller 类继承。
相反，我只想用一些规则指定路由，描述如何将请求映射到我的 POCO 控制器类实例的方法和参数。

也许下面的小例子可以更好地解释它。
想象一下我们可以有这样的路由：

```
routes.MapPOCOController<MyPOCO>("MyWebAppName/{method}/{*parameters}", () => _container.Resolve<MyPOCO>());
routes.IfMethodReturns<MyCustomRedirectResult>().PerformRedirect(result => result.Url); 
```

然后你的控制器类只是一个 POCO 对象：

```
public class MyPOCO {
    public User     GetUser(Guid userId) {...}
    public string   Home() { 
        return _razorEngine.Render("~/Views/Home/Index.cshtml", new HomeModel { Message = "Hello world!"});
    }
    public object   RenderSomePageOrRedirect()
    {
        if(blabla)
            return new MyCustomRedirectResult("/profile");
        else
            return _razorEngine.Render( ... );
    }
    ...
} 
```

*   在第一种方法中，“GetUser”JSON 序列化可以像在 mvc4 中一样自动发生。
*   在第二种方法“Home”中，我们需要将视图手动呈现为字符串，因此这将为您提供更大的灵活性，例如组合不同的引擎或以比当前 asp.mvc 实现更自然的方式编写自定义引擎。
*   在第三种方法“RenderSomePageOrRedirect”中，我们对当前的 RedirectResult 实现并不严格，可以使用任何有效的类，然后在路由中正确映射它。

**是否有任何框架已经实现了至少一个上述概念？**...也许是一些“贡献”库？

我寻找这种功能的原因是：

*   我想遵循 DRY 原则，不想将请求/响应映射代码与控制器中的业务逻辑混合（你不能同时使用我知道的当前 mvc 实现）
*   我想让我的控制器类在多个上下文中可用，因此，单元测试、重用等更容易。（当您在不同的 Web 应用程序中重用相同的控制器时，代码会变得更加 DRY：您只需稍微调整一下路由）
*   这只是一种直觉，这种做事方式更好，对不起，我的话渲染器放弃了（

PS：我感谢那些在下面评论并帮助我正确形成这个问题的人（尤其是StriplingWarrior）！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T07:29:02.907

AFAIK 没有这样的框架。ASP.NET MVC 控制器必须从`Controller`、`AsyncController`或`ApiController`类派生。所以我想如果你想实现这样的概念，你将不得不编写自己的 MVC 框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T10:44:43.397

实际上有[FubuMvc](http://mvc.fubu-project.org/)。它似乎几乎就是你要找的东西。唯一的问题是缺乏文档。

# java - 为什么 Eclipse 中的显示不支持 Java 中的递归函数？

> ID：10607302
> 
> 赞同：7
> 
> 时间：2012-05-15T19:13:06.310
> 
> 标签：java, eclipse

我在 Eclipse IDE 中用 Java 实现了一个阶乘函数。

```
public class Utilities {
   public static int factorial(int n) {
        int result;
    if (n <= 1) // base case
        return 1;
    else {
        result = (n * factorial(n - 1));
        return result;
    }
}
} 
```

在 Eclipse 的显示中，我检查`Utilities.factorial(6)`. 但是，我收到此错误。

```
Utilities.factorial(6);
    Evaluation failed. Reason(s):
        Cannot perform nested evaluations. 
```

为什么显示器不支持递归调用？那是问题吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T21:45:12.583

要返回答案，它必须评估表达式，为此它必须评估内部表达式，为此它必须评估内部表达式，为此它必须评估内部表达式。

通常，当调试器破坏堆栈（嵌套堆栈帧过多）时，人们会将错误提交给编写调试器的开发团队。他们通过目前已知的唯一方法解决了问题：不递归。

对于任何递归表达式，如果您可以在不以嵌套方式评估表达式的情况下评估堆栈需要走多深；有一个闪亮的[菲尔兹奖章](http://en.wikipedia.org/wiki/Fields_Medal)在等着你（可能还有一所大学准备以你的名义建造一座新建筑）。这个问题与[停机问题](http://en.wikipedia.org/wiki/Halting_problem)有关，不幸的是，使用我们的计算模型，已知停机问题是无法解决的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-15T19:21:44.940

## 罪魁祸首：递归

大多数 IDE 不会进行这种评估，它与 Java 无关，更多地与递归有关。由于 Eclipse 无法知道递归的深度，它甚至不会费心评估表达式，否则它可能会挂起 JVM（如果递归有问题）或导致“堆外”异常，无论哪种情况，很难挽回。

您是否为哨兵尝试过较小的数字，例如`Utilities.factorial(1)`？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-15T21:35:10.043

不相关：如果这是您真正想要使用的方法，则递归不是要走的路。至少，将函数重写为迭代函数。根据您的用例，您可以使用各种近似值，例如[this one](http://en.wikipedia.org/wiki/Stirling%27s_approximation)或[this one](http://files.ele-math.com/articles/jmi-04-30.pdf)。

# java - 在接口中定义常量是什么意思？

> ID：10607305
> 
> 赞同：6
> 
> 时间：2012-05-15T19:13:23.407
> 
> 标签：java, interface, constants

我知道在 Java 中，有人可以通过声明来在接口中包含常量`public static final`。但是，假设我有一个名为 的接口，`I`它只包含公共静态最终常量，没有方法签名，还有一个名为`C`. 为什么我要在 C 中实现 I？即我为什么要执行以下操作：

`public class C implements I`

由于常量是公共的和静态的，我不能直接通过 访问它们`I`吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T19:15:41.583

这种（反）模式很有用，因为它允许您使用这些常量的名称，而不必在它们前面加上`I.`. 这曾经是一种常见的技术，但现在您可以使用它`import static`来导入常量，就像它已经失宠一样。避免它的原因之一是常量集实际上不是一个接口——它只是一堆值——并且让它成为一个接口可以让你做一些奇怪的事情，比如写作

```
ConstantInterfaceWithNoMethods m = new ClassImplementingThatInterface; 
```

或者

```
if (m instanceof ConstantInterfaceWithNoMethods) 
```

在这种情况下这是没有意义的。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-15T19:15:16.443

这是一种 Java 模式，允许您从接口访问常量，而无需一遍又一遍地键入该接口的名称。这种模式从早期就已经存在，在`enum`s 进入语言之前很多年。

有些人认为这是有问题的，因为它会导致创建不指定合同的接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:15:15.710

一般不需要。一个原因可能是，该接口`I`是“标记接口”。

# plsql - 无法编译 PLSQL 程序

> ID：10607306
> 
> 赞同：0
> 
> 时间：2012-05-15T19:13:30.030
> 
> 标签：plsql, oracle10g, infinite-loop

这个过程更新了一个表，我在其中跟踪完成的（非常基本的）历史工作。问题是我不能再修改或编译它了。我不知道我是否在程序中犯了错误并且正在无限循环。我的 DBA 已经检查了程序，一切似乎都正确，但我仍然无法更改它，使用它。

我敢打赌，当我试图捕捉异常并且我使用`EXCEPTION WHEN OTHERS THEN NULL`循环时会卡住。

有什么建议吗？

干杯

```
create or replace
PROCEDURE DOACTUALIZARHISTORIALEM 
(
  QUSUARIO IN VARCHAR2  
, QARCHIVO IN VARCHAR2  
, QANIOFISCAL IN VARCHAR2
, QFECHAPROCESAMIENTO IN DATE
) AS 

  cursorEstatus SYS_REFCURSOR;

  sqlQueryA VARCHAR2(200);
  sqlQueryB VARCHAR2(200);
  idArchivo INTEGER;

  idPrograma VARCHAR2(10);
  idComponente VARCHAR2(10);

  sumaSolicitado DECIMAL;
  sumaAprobado DECIMAL;
  sumaPagado DECIMAL;

BEGIN

  idArchivo := getidarchivo(qarchivo,getidusuario(qusuario),qaniofiscal);

  sqlQueryA := 'SELECT programa, componente'||
                ' FROM '||qusuario||
              ' WHERE id_archivo = :1';

  OPEN cursorEstatus FOR sqlQueryA USING idArchivo;
  LOOP
    FETCH cursorEstatus INTO idPrograma, idComponente;
    EXIT WHEN cursorEstatus%NOTFOUND;

    BEGIN  
      sqlQueryB := 'SELECT sum(monto_federal) '||
                    ' FROM '||qusuario||
                   ' WHERE programa = :1'||
                    ' AND componente = :2'||
                    ' AND estatus_monto = 1'||
                    ' AND status = 1';
      EXECUTE IMMEDIATE sqlQueryB
        INTO sumaSolicitado
        USING idPrograma, idComponente;

        INSERT INTO src_historialem VALUES (idArchivo,
                                            qfechaprocesamiento,
                                            idPrograma,
                                            idComponente,
                                            1,
                                            sumaSolicitado);
        COMMIT;
        EXCEPTION
          WHEN OTHERS THEN NULL;
      END;

    BEGIN
      sqlQueryB := 'SELECT sum(monto_federal) '||
                    ' FROM '||qusuario||
                   ' WHERE programa = :1'||
                    ' AND componente = :2'||
                    ' AND estatus_monto = 2'||
                    ' AND status = 1';
      EXECUTE IMMEDIATE sqlQueryB
        INTO sumaAprobado
        USING idPrograma, idComponente;

        INSERT INTO src_historialem VALUES (idArchivo,
                                            qfechaprocesamiento,
                                            idPrograma,
                                            idComponente,
                                            2,
                                            sumaSolicitado);
        COMMIT;
        EXCEPTION
          WHEN OTHERS THEN NULL;
      END;

    BEGIN
      sqlQueryB := 'SELECT sum(monto_federal) '||
                    ' FROM '||qusuario||
                   ' WHERE programa = :1'||
                    ' AND componente = :2'||
                    ' AND estatus_monto = 3'||
                    ' AND status = 1';
      EXECUTE IMMEDIATE sqlQueryB
        INTO sumaPagado
        USING idPrograma, idComponente;

        INSERT INTO src_historialem VALUES (idArchivo,
                                            qfechaprocesamiento,
                                            idPrograma,
                                            idComponente,
                                            3,
                                            sumaSolicitado);
        COMMIT;
        EXCEPTION
          WHEN OTHERS THEN NULL;
      END;
  END LOOP;

  CLOSE cursorEstatus;
END DOACTUALIZARHISTORIALEM; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T21:05:37.160

1) 打开一个 SQL*Plus 会话（会话 A）。获取该会话的`SID`和`SERIAL#`. 写下这些数字。

```
SELECT sid, serial#
  FROM v$session
 WHERE sid = (select distinct sid from v$mystat); 
```

2) 打开第二个 SQL*Plus 会话（会话 B）连接到与 A 相同的数据库。

3）在会话A中，尝试编译代码

4) 在运行时，在会话 B 中运行查询

```
SELECT blocking_session_status,
       blocking_instance,
       blocking_session
  FROM v$session
 WHERE sid     = <<sid from step 1>>
   AND serial# = <<serial# from step 1>> 
```

这将向您显示`SID`持有该过程锁定的会话。或者，`dba_waiters`应该有类似的信息。

```
SELECT waiting_session,
       holding_session,
       lock_type,
       mode_held,
       mode_requested
  FROM dba_waiters
 WHERE waiting_session = <<sid from step 1>> 
```

5) 一旦你确定了哪个会话持有锁，你可以要求 DBA 终止会话。

# arrays - FORTRAN-90 中的数组存储

> ID：10607307
> 
> 赞同：0
> 
> 时间：2012-05-15T19:13:32.657
> 
> 标签：arrays, sorting, fortran90

我正在使用 FORTRAN-90。我有一个问题。

我想将数据（即 X 和 Y 值）存储在一个三维数组（A（900,900,900），B（900,900,900））中，这样一开始我只使用每个数组的 30X30X30 个元素来存储 30X30X30 X 的初始值和 Y 然后在下一个时间步骤我有一些科学计算来改变 X 和 Y 的值然后再次想从两个数组的第 (31X31X31) 位置将 30X30X30 修改后的 X 和 Y 值存储在同一个数组中并再次为下一个时间步执行相同的程序。通过这种方式，我想用我的数据填充数组，最后想打印这些数组。

你能帮我看看我如何写这个算法我 FORTRAN 代码......

请帮我。

请指导我

最诚挚的问候

阿米塔沃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T16:30:23.570

好吧，这个怎么样：

```
real*8 :: A(900,900,900),X(30,30,30)
integer :: offset

offset=0

!   define X however ...

A(1:30,1:30,1:30)=X

do while (offset<900)
! do stuff to X
! do more stuff to X
  offset=offset+30
  A(1+offset:30+offset,1+offset:30+offset,1+offset:30+offset)=X
enddo 
```

另外，我认为 ja72 有更好的主意。但是，如果这是您需要这样做的方式，我认为这就是您想要的。

# sqlite - PHP 警告：SQLite3Stmt::execute()：无法执行语句：数据库被锁定

> ID：10607317
> 
> 赞同：0
> 
> 时间：2012-05-15T19:14:06.947
> 
> 标签：sqlite, symfony

我的问题与我的另一个问题有关：

[表现不佳](https://stackoverflow.com/questions/10599863/poor-performance)

在 apache 日志中，我有这样的错误：

PHP 警告：SQLite3Stmt::execute()：无法执行语句：数据库被锁定在 /home/marek/devel/sf2/cities/vendor/symfony/src/Symfony/Component/HttpKernel/Profiler/SqliteProfilerStorage.php

我正在使用 MySQL，为什么我收到关于 SQLite3 的错误？

有人可以帮助解决这个错误吗？

**[编辑]**

禁用分析器的唯一方法是：

```
public function __construct(ProfilerStorageInterface $storage, LoggerInterface $logger = null)
{
    $this->storage = $storage;
    $this->logger = $logger;
    $this->collectors = array();
    **$this->enabled = false;**
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T13:35:52.847

Symfony2 将调试和分析数据存储在 SQLite 数据库中（在 {root}/app/cache/dev/profiler.db 文件中），并且似乎在开发模式下您发送了很多请求并且它锁定了 SQLite 数据库。如果您想测试应用程序的性能 - 不要使用 DEV 环境

# java - 具有多个系统属性的 Maven exec

> ID：10607320
> 
> 赞同：1
> 
> 时间：2012-05-15T19:14:23.750
> 
> 标签：java, maven, system-properties

我正在尝试使用多个系统属性运行 mvn exec ...它可以使用一个但由于某种原因不能使用两个。

例如，这很好用

```
mvn  -Dlocation=c:\tmp  exec:java -Dexec.mainClass="MyClass" 
```

这不起作用

```
mvn  -Dlocation=c:\tmp  -Djava.library.path=c:\zeromq\ exec:java -Dexec.mainClass="MyClass" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:41:48.137

这个[答案](https://stackoverflow.com/a/824025/1050015)中提出的解决方案怎么样？

# php - Rails 3 站点在乘客上运行，带有 php 首页

> ID：10607321
> 
> 赞同：1
> 
> 时间：2012-05-15T19:14:24.040
> 
> 标签：php, ruby-on-rails-3, passenger

我的 Rails 3 应用程序与乘客一起运行。我有一个用 php 构建的小网站，我想将它作为我网站的首页。它包含一个指向实际 Rails 应用程序的链接。php 的东西位于我的公共目录的子目录中。

现在将文档根目录设置为 /var/www/myapp/current/public 将允许我的站点正常工作。我尝试将文档根目录设置为 /var/www/myapp/current/public/php_site，并将该目录的PassengerEnabled 设置为关闭。当我访问我的网站时，使 php 部分作为默认页面正常工作，但随后 rails 应用程序无法正常工作。如何让 php 部分和 rails 应用程序一起工作？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T14:36:25.370

这就是我要做的...

我在 /var/www-ruby/ 中有我的 Rails 应用程序

我的 apache 根目录是 /var/www/

我还在 /var/www/ 中运行了一些 PHP 的东西

对于我需要通过Passenger/Apache 服务的任何rails 应用程序，我创建了一个从/var/www/ 到/var/www-ruby/my-app-name/public/ 的链接。

示例：当前目录是 /var/www/

ln -s /var/www-ruby/my-app-name/public/my-app-name

每当有人访问[http://example.com/my-app-name](http://example.com/my-app-name)时，它​​将提供 /var/www-ruby/my-app-name/public/ 的内容

[编辑]

这是我的 /etc/apache2/sites-available/default 的相关部分：

```
<VirtualHost _default_:80>
        DocumentRoot /var/www/
        <Directory />
                Options FollowSymLinks
                AllowOverride None
        </Directory>

        <Directory /var/www/>
                Options Indexes FollowSymLinks MultiViews
                AllowOverride None
                Order allow,deny
                allow from all
        </Directory>

  RailsBaseURI /ticketqueue
    <Directory /var/www-ruby/ticketqueue>
        Options -MultiViews
    </Directory>

  RailsBaseURI /dashboard
    <Directory /var/www-ruby/dashboard>
        Options -MultiViews
    </Directory>

</VirtualHost> 
```

编辑该文件后，您可能需要通过运行和重新加载 apache 来禁用和重新启用`a2dissite default`默认`a2ensite default`值`/etc/init.d/apache2 reload`

# c# - 我可以提交只有隐藏字段的表单吗？

> ID：10607323
> 
> 赞同：2
> 
> 时间：2012-05-15T19:14:29.713
> 
> 标签：c#, asp.net-mvc-3, forms, post

我正在根据下拉菜单将不同的表单加载到同一个 div 中……当他们被告知通过 JQuery 提交时，所有其他表单似乎都可以工作，除了这个……有人知道为什么吗？谢谢....

```
@using (Html.BeginForm("SaveInMemoryPayment", "Payment", FormMethod.Post))
{
@Html.ValidationSummary(true)

<p> Payment type: Cash. No further action needed. Plase click Save to finish. </p>

<input type="hidden" name="PaymentTypeID" id="paymentTypeIDHidden" value="@Model.PaymentTypeID" />
<input type="hidden" name="DonationID" id="donationIDHidden" value="@Model.DonationID" />
<input type="hidden" name="PaymentDate" id="paymentDateHidden" value="@Model.PaymentDate" />
<input type="hidden" name="PaymentAmount" id="paymentAmountHidden" value="@Model.PaymentAmount" /> 

} 
```

这是一个有效的表格......

```
@using (Html.BeginForm("SaveInMemoryPayment", "Payment", FormMethod.Post))
{
@Html.ValidationSummary(true)

<p>Check information:</p>

<div class="editor-label" id="check1">
        @Html.LabelFor(model => model.CheckNumber)
    </div>
    <div class="editor-field" id="check1.2">
        @Html.EditorFor(model => model.CheckNumber)
        @Html.ValidationMessageFor(model => model.CheckNumber)
    </div>

@Html.HiddenFor(x => x.PaymentTypeID)
@Html.HiddenFor(x => x.DonationID)
@Html.HiddenFor(x => x.PaymentDate)
@Html.HiddenFor(x => x.PaymentAmount)

} 
```

他们都发回同一个地方……但第一个不会。这些表单被加载到具有保存按钮的父视图中的 div 中...该按钮打开一个对话框，单击时有一个 OK 按钮：$('#paymentSection2').find('form') 。提交（）;

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:17:21.147

你为什么不使用[`@Html.HiddenFor()`](http://msdn.microsoft.com/en-us/library/system.web.mvc.html.inputextensions.hiddenfor.aspx)？很有可能这是一个绑定问题，MVC 无法区分您的输入名称和它所期望的输入名称。（例如，它可能期望`MyModel.PaymentID`而不是仅仅`PaymentID`作为输入名称）。

尝试以下操作：

```
@using (Html.BeginForm("SaveInMemoryPayment", "Payment", FormMethod.Post))
{
    @Html.ValidationSummary(true)

    <p> Payment type: Cash. No further action needed. Plase click Save to finish. </p>

    @Html.HiddenFor(x => x.PaymentTypeID)
    @Html.HiddenFor(x => x.DonationID)
    @Html.HiddenFor(x => x.PaymentDate)
    @Html.HiddenFor(x => x.PaymentAmount)
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T19:18:36.940

是的，您可以提交仅包含隐藏字段的表单。

# c++ - CUDA /openCL；将分支重写为非分支表达式

> ID：10607324
> 
> 赞同：6
> 
> 时间：2012-05-15T19:14:30.700
> 
> 标签：c++, optimization, cuda, opencl, gpu

大多数情况下，CUDA 或 OpenCL 程序中都需要一个分支，例如：

```
for (int i=0; i<width; i++)
{
   if( i % threadIdx.x == 0)
     quantity += i*i;
} 
```

代码总是可以（或至少在大多数情况下）以非分支方式重写：

```
for (int i=0; i<width; i++)
{
   quantity += i*i* (i % threadIdx.x != 0);
} 
```

权衡似乎是在单个扭曲槽中运行而不是在所有线程上进行更多计算（在第二种情况下，总和总是执行，只是有时值为零）

假设分支操作将为每个可能的分支占用多个扭曲槽，人们会期望第二个始终比第一个好，现在我的问题是；我是否可以依靠编译器将 1) 优化为 2)，只要它有意义，或者没有广泛适用的标准，这意味着如果没有尝试和分析，通常无法确定哪个更好？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T21:59:13.433

模运算相当昂贵：我有理由确定添加模会比仅使用只有 1 个线程执行的单个指令花费更多时间。您的单个分支语句（`if`带有 no `else`）只会在执行 if 语句时挂起其他线程。因为 gpus 针对非常快速的上下文切换进行了优化，所以成本应该很低。

但建议您不要使用长分支语句：GPU 上过多的串行计算（即一个线程完成所有工作）否定了并行性的优势。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T21:21:22.630

以我的经验 - 完全由编译器编写者来优化这些边缘情况。

那么我能想到 1) 不能变成 2) 的任何情况吗？这是一个：我已经编写了内核，其中每 10 个线程或类似的东西运行某些计算部分更有效，在这种情况下，即使有一个数学运算（除法减法）可以推断出这样的优化也不能产生相同的结果，而不管条件与“在所有结果上运行但产生零结果”。

但是，即使检查 threadId == 0 是一个足够常见的场景，我也不知道它是否真的针对它进行了优化。我敢打赌，这取决于实现，甚至取决于设备本身（CPU 与 GPU）。

您将不得不尝试它才能真正找出最有效的方法，这不仅是因为上述原因，还因为工作调度程序可能会根据调度/启动/停止一组线程的成本而不是拥有它们都运行（并且大多数提供零/身份结果）。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T20:55:41.353

我对 CUDA 没有太多的记忆，但你为什么不并行化你的循环呢？您应该使用原子操作[1] 来添加您的计算。我希望这能帮到您！对不起，如果不是这样。

1.  原子操作：[http ://supercomputingblog.com/cuda/cuda-tutorial-4-atomic-operations/](http://supercomputingblog.com/cuda/cuda-tutorial-4-atomic-operations/)

# c# - #eval 网格视图中的电话号码

> ID：10607334
> 
> 赞同：1
> 
> 时间：2012-05-15T19:15:19.693
> 
> 标签：c#, asp.net, regex, string, gridview

我想在 asp.net gridview 中将电话号码显示为掩码格式 (999)999-9999。

```
<ItemTemplate>
    <asp:Label ID="Label4" runat="server" Text='<%# (Eval("OrgContactPhone").ToString().Length>50)?Eval("OrgContactPhone").ToString().Substring(0,50):Eval("OrgContactPhone") %>'></asp:Label>
</ItemTemplate> 
```

所以两个问题。

1.  如何格式化？我知道有 string.format 的东西。但请看下一个问题。
2.  如果为空，则不显示任何内容。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T19:18:28.473

这是我写[的类似（以前）答案的链接。](https://stackoverflow.com/questions/5807004/how-to-format-a-time-stamp-to-show-the-date-only-in-a-grid-view/5807076#5807076)

最终，您希望有一个代码隐藏函数来返回您的格式化文本。此功能将允许您对所有电话号码进行统一格式设置。如果您需要更改格式，您只需要更改一个方法。

```
public object FormatPhoneNumber(string phoneNumber)
{
   // return nothing if the string is null
   if(String.IsNullOrEmpty(phoneNumber))
   {
       return "";    
   }

   // invalid phone number submitted
   if(phoneNumber.Length != 10)
   {
       throw new System.ArgumentException("Phone Number must contain 10 digits", "phoneNumber");
   }

   // probably want one more check to ensure the string contains numbers and not characters, but then again, hopefully that's handled on input validation.

   // if the int is valid, return the formatted text
   return string.Format("({0}) {1}-{2}",
          phoneNumber.Substring(0, 3),
          phoneNumber.Substring(3, 3),
          phoneNumber.Substring(6));
} 
```

你像这样从你的aspx页面调用它。

```
<ItemTemplate>
    <asp:Label ID="Label4" runat="server" Text='<%# FormatPhoneNumber(Eval("OrgContactPhone").ToString()) %>'></asp:Label>
</ItemTemplate> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:37:04.670

为什么要检查电话号码长度是否大于 50？这会做我认为的工作。但我不喜欢对每一行都做 int.Parse ......

```
<ItemTemplate>
<asp:Label ID="Label4" runat="server" Text='<%# 
(Eval("OrgContactPhone") != null ? (((Eval("OrgContactPhone").ToString().Length>50) ? int.Parse(Eval("OrgContactPhone").Substring(0,10)).ToString("(###)###-####") : "") : (int.Parse(Eval("OrgContactPhone")).ToString("(###)###-####")) : ""%>'></asp:Label>
</ItemTemplate> 
```

# google-app-engine - Google App Engine python 2.7中的“释放未锁定的锁”错误，线程安全=否

> ID：10607337
> 
> 赞同：2
> 
> 时间：2012-05-15T19:15:31.630
> 
> 标签：google-app-engine, python-2.7, python-multithreading

我在 Google App Engine (gqueues) 上的应用程序的日志中偶尔会出现“释放解锁锁”错误，并且无法弄清楚原因（下面的完整堆栈跟踪）。有谁知道为什么会发生这个错误？

有趣的是，该应用程序在 python 2.7 上，threadsafe=NO，所以会发生任何锁定或锁定错误似乎很奇怪。

背景故事：GQueues 在 python2.5 上，4 月初我将它迁移到 2.7 并设置 threadsafe=True。一切正常一周。然后在 4 月 9 日早上，整个应用程序无法访问，出现 500 个错误。它不断产生延迟超过 30 秒的新服务器实例。我注意到在我的日志中我看到了错误“无法解锁未锁定的锁”。在迁移过程中我没有向我的代码添加任何锁定机制，所以我认为这是错误所指的应用程序引擎的锁定。无论如何，我将我的应用程序回滚到仍然在 Python 2.5 上的上一个版本，一切又开始工作了。

4 月晚些时候，AppEngine Downtime Notify 透露，他们在 4 月 9 日结束时出现了一个问题，导致 python 2.7 应用程序出现问题。 [https://groups.google.com/d/topic/google-appengine-downtime-notify/QL8TmRn6Ay4/discussion](https://groups.google.com/d/topic/google-appengine-downtime-notify/QL8TmRn6Ay4/discussion)

我跟进了来自 Google 的 Christina Ilvento，她认为现在回到 Python 2.7 并设置 threadsafe=True 应该没问题。我迁移回 2.7，但留下了 threadsafe=False，我想我会花几个星期来确保在 2.7 上一切正常，然后再次打开线程（我认为这是导致问题的原因）。几周前一切正常，但现在我看到这个“释放解锁锁”错误，即使禁用了线程。有谁知道这里发生了什么？

Christina 建议我在这里发帖，App Engine 团队会跟进。

```
释放解锁的锁
回溯（最近一次通话最后）：
  文件“/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py”，第 545 行，在调度中
    返回方法(*args, **kwargs)
  文件“/base/data/home/apps/s~gqueues-hrd/gq3-7-5.358902352474055782/controllers/util.py”，第 69 行，在 check_login
    handler_method(self, *args)
  文件“/base/data/home/apps/s~gqueues-hrd/gq3-7-5.358902352474055782/controllers/main.py”，第 297 行，在 get
    self.generate('main.html', template_values)
  文件“/base/data/home/apps/s~gqueues-hrd/gq3-7-5.358902352474055782/controllers/baserequest.py”，第 257 行，在生成
    self.response.out.write(template.render(path, values))
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/ext/webapp/template.py”，第 92 行，在渲染中
    返回 t.render(上下文(template_dict))
  wrap_render 中的文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/ext/webapp/template.py”，第 172 行
    返回 orig_render(上下文)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 173 行，在渲染中
    返回self._render（上下文）
  _render 中的文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 167 行
    返回 self.nodelist.render(context)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 794 行，在渲染中
    bits.append（self.render_node（节点，上下文））
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 807 行，在 render_node
    返回节点。渲染（上下文）
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/loader_tags.py”，第 139 行，在渲染中
    返回 self.template.render(context)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 173 行，在渲染中
    返回self._render（上下文）
  _render 中的文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 167 行
    返回 self.nodelist.render(context)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 794 行，在渲染中
    bits.append（self.render_node（节点，上下文））
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 807 行，在 render_node
    返回节点。渲染（上下文）
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/defaulttags.py”，第 173 行，在渲染中
    nodelist.append(node.render(context))
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/defaulttags.py”，第 257 行，在渲染中
    返回 self.nodelist_true.render(context)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 794 行，在渲染中
    bits.append（self.render_node（节点，上下文））
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 807 行，在 render_node
    返回节点。渲染（上下文）
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/loader_tags.py”，第 139 行，在渲染中
    返回 self.template.render(context)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 173 行，在渲染中
    返回self._render（上下文）
  _render 中的文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 167 行
    返回 self.nodelist.render(context)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 794 行，在渲染中
    bits.append（self.render_node（节点，上下文））
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 807 行，在 render_node
    返回节点。渲染（上下文）
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/loader_tags.py”，第 139 行，在渲染中
    返回 self.template.render(context)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 173 行，在渲染中
    返回self._render（上下文）
  _render 中的文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 167 行
    返回 self.nodelist.render(context)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 794 行，在渲染中
    bits.append（self.render_node（节点，上下文））
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 807 行，在 render_node
    返回节点。渲染（上下文）
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/defaulttags.py”，第 173 行，在渲染中
    nodelist.append(node.render(context))
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/loader_tags.py”，第 139 行，在渲染中
    返回 self.template.render(context)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 173 行，在渲染中
    返回self._render（上下文）
  _render 中的文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 167 行
    返回 self.nodelist.render(context)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 794 行，在渲染中
    bits.append（self.render_node（节点，上下文））
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 807 行，在 render_node
    返回节点。渲染（上下文）
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/loader_tags.py”，第 139 行，在渲染中
    返回 self.template.render(context)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 173 行，在渲染中
    返回self._render（上下文）
  _render 中的文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 167 行
    返回 self.nodelist.render(context)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 794 行，在渲染中
    bits.append（self.render_node（节点，上下文））
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/__init__.py”，第 807 行，在 render_node
    返回节点。渲染（上下文）
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/_internal/django/template/defaulttags.py”，第 136 行，在渲染中
    值 = 列表（值）
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/ext/db/__init__.py”，第 2312 行，在下一个
    return self.__model_class.from_entity(self.__iterator.next())
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/datastore/datastore_query.py”，第 2809 行，在下一个
    next_batch = self.__batcher.next()
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/datastore/datastore_query.py”，第 2671 行，在下一个
    返回 self.next_batch(self.AT_LEAST_ONE)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/datastore/datastore_query.py”，第 2708 行，在 next_batch
    批处理 = self.__next_batch.get_result()
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/api/apiproxy_stub_map.py”，第 592 行，在 get_result
    返回 self.__get_result_hook(self)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/datastore/datastore_query.py”，第 2450 行，在 __query_result_hook
    self._batch_shared.conn.check_rpc_success(rpc)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/datastore/datastore_rpc.py”，

```

更新：这是其中一个错误的完整回溯

```
46.231.181.199 - sandra.martin [15/May/2012:03:28:44 -0700]“POST /items/HTTP/1.1”500 1306“http://www.gqueues.com/main?q=ag1zfmdxdWV1ZXMtaHJkciILEGdBY2NvdW50GL- psgYMCxILU2hhcmVkUXVldWUYkU4M";;;; "Mozilla/5.0 (Windows NT 6.1; rv:12.0) Gecko/20100101 Firefox/12.0" "www.gqueues.com" ms=59858 cpu_ms=154948 api_cpu_ms=112433 cpm_usd=4.305925 instance=00c61b117cfbf1818fa4b0f779eacc7
2012-05-15 05:27:45.121
postAction：重新排序
2012-05-15 05:28:44.714
释放解锁的锁
回溯（最近一次通话最后）：
  文件“/base/python27_runtime/python27_lib/versions/third_party/webapp2-2.3/webapp2.py”，第 545 行，在调度中
    返回方法(*args, **kwargs)
  文件“/base/data/home/apps/s~gqueues-hrd/gq3-7-5.358902352474055782/controllers/util.py”，第 139 行，在 check_login
    handler_method(self, *args)
  文件“/base/data/home/apps/s~gqueues-hrd/gq3-7-5.358902352474055782/controllers/items.py”，第 371 行，在帖子中
    self.reorder()
  文件“/base/data/home/apps/s~gqueues-hrd/gq3-7-5.358902352474055782/controllers/items.py”，第 856 行，重新排序
    QueueSyncHandler.syncQueueViewers(clientId, itemQueue)
  文件“/base/data/home/apps/s~gqueues-hrd/gq3-7-5.358902352474055782/controllers/queuesync.py”，第 197 行，在 syncQueueViewers
    jsonObj['items'] = util.getJSONItems(queueItems, filter, queueViewer.type, accountObj)
  文件“/base/data/home/apps/s~gqueues-hrd/gq3-7-5.358902352474055782/controllers/util.py”，第 1536 行，在 getJSONItems
    jsonItem['subitems'] = getJSONItems(subItems, filter, type, accountObj, assignmentCompleted=assignmentCompleted, accountEmail=accountEmail)
  文件“/base/data/home/apps/s~gqueues-hrd/gq3-7-5.358902352474055782/controllers/util.py”，第 1536 行，在 getJSONItems
    jsonItem['subitems'] = getJSONItems(subItems, filter, type, accountObj, assignmentCompleted=assignmentCompleted, accountEmail=accountEmail)
  文件“/base/data/home/apps/s~gqueues-hrd/gq3-7-5.358902352474055782/controllers/util.py”，第 1536 行，在 getJSONItems
    jsonItem['subitems'] = getJSONItems(subItems, filter, type, accountObj, assignmentCompleted=assignmentCompleted, accountEmail=accountEmail)
  文件“/base/data/home/apps/s~gqueues-hrd/gq3-7-5.358902352474055782/controllers/util.py”，第 1481 行，在 getJSONItems
    如果 item.hasAssignments():
  文件“/base/data/home/apps/s~gqueues-hrd/gq3-7-5.358902352474055782/models.py”，第 1512 行，在 hasAssignments
    itemAssignments = Assignment.all(keys_only=True).filter('item =', self).fetch(1)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/ext/db/__init__.py”，第 2143 行，在 fetch
    返回列表（self.run（limit=limit，offset=offset，**kwargs））
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/datastore/datastore_query.py”，第 2809 行，在下一个
    next_batch = self.__batcher.next()
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/datastore/datastore_query.py”，第 2671 行，在下一个
    返回 self.next_batch(self.AT_LEAST_ONE)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/datastore/datastore_query.py”，第 2708 行，在 next_batch
    批处理 = self.__next_batch.get_result()
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/api/apiproxy_stub_map.py”，第 592 行，在 get_result
    返回 self.__get_result_hook(self)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/datastore/datastore_query.py”，第 2450 行，在 __query_result_hook
    self._batch_shared.conn.check_rpc_success(rpc)
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/datastore/datastore_rpc.py”，第 1206 行，在 check_rpc_success
    rpc.wait()
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/api/apiproxy_stub_map.py”，第 533 行，等待中
    self.__rpc.Wait()
  文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/api/apiproxy_rpc.py”，第 119 行，等待
    rpc_completed = self._WaitImpl()
  _WaitImpl 中的文件“/base/python27_runtime/python27_lib/versions/1/google/appengine/runtime/apiproxy.py”，第 134 行
    self.__done_event.wait()
  文件“/base/python27_runtime/python27_dist/lib/python2.7/threading.py”，第 407 行，等待中
    self.__cond.release()
错误：释放未锁定的锁

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T05:41:25.377

感谢您的报告。我们（GAE python 团队）知道这个错误。[可能发生的情况是，您的处理程序可能正在达到请求截止日期并遇到我们在https://developers.google.com/appengine/docs/python/runtime#The_Request_Timer](https://developers.google.com/appengine/docs/python/runtime#The_Request_Timer)警告的问题。

您能否帮我检查几件事： 1\. 异常跟踪似乎不完整。如果可能，您能否发布完整的回溯。2\. 您能否检查您的请求的请求时间（在日志中）并将其发布在此处。

编辑：我链接到的页面上的警告是最近发布的。

# python - 带泡菜的模块化序列化（Python）

> ID：10607350
> 
> 赞同：1
> 
> 时间：2012-05-15T19:16:42.843
> 
> 标签：python, pickle

我想以模块化的方式执行一些对象图的序列化。那就是我不想序列化整个图。原因是这张图很大。我可以保留图表某些部分的时间戳版本，并且我可以做一些惰性访问来推迟加载我现在不需要的部分。

我想我可以用 Python 中的元编程来管理这个。但似乎元编程在 Python 中还不够强大。

这就是我现在要做的。我的图表由几个不同的对象组成。其中一些是特殊类的实例。此类描述要腌制的根对象。这就是模块化的用武之地。每次我腌制一些东西时，它都会从其中一个实例开始，我从不同时腌制其中两个。每当有对另一个实例的引用，根对象可以访问时，我用一个persistant_id 替换这个引用，从而确保我不会在同一个酸洗流中拥有它们中的两个。解封流时出现问题。我可以找到一个尚未加载的实例的persistant_id。在这种情况下，我必须等待目标实例被加载，然后才能访问它。而且我无论如何也看不到这样做：

1/ 我试图构建一个**获取**方法返回引用目标的访问器。不幸的是，访问器必须放在类声明中，我不能将它们分配给未腌制的对象。2/我可以将引用必须解决的地方存储在某个地方。我认为这在 Python 中是不可能的：不能保留对位置（字段或变量）的引用，只能保留对值的引用。

我的问题可能不太清楚。我仍在寻找一个清晰的配方。我尝试了其他方法，例如使用显式引用，这将是某些“引用”类的实例。不过也不是很方便。

你知道如何用 pickle 实现模块化序列化吗？我是否必须更改 Unpickler 的内部行为才能记住我需要加载剩余对象图的位置？是否有另一个库更适合实现类似的结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T21:14:51.553

元编程在 Python 中*很强大；*Python 类具有极强的延展性。您可以在声明后随心所欲地更改它们，尽管最好在元类（装饰器）中完成。不仅如此，*实例*是可塑的，独立于它们的类。

“对地点的引用”通常只是一个字符串。例如，对对象字段的引用就是它的名称。假设您的节点对象中有多个节点引用。你可以有一些像`{persistent_id: (object, field_name),..}`你未解决的参考表这样的东西，很容易查找。同样，在节点列表中，“对地点的引用”是索引。

顺便说一句，您可以使用键值数据库进行图形存储吗？您无需等待即可按 ID 拉取节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:56:14.923

这就是我认为我会如何去做的事情。

1.  有一个模块级字典将 persistent_id 映射到 SpecialClass 对象。每次初始化或取消选择`SpecialClass`实例时，请确保将其添加到字典中。

2.  覆盖 SpecialClass 的`__getattr__`and`__setattr__`方法，以便`specialobj.foo = anotherspecialobj`仅将 persistent_id 存储在 specialobj 上的字典中（我们称之为`specialobj.specialrefs`）。当您检索`specialobj.foo`时，它会在 specialrefs 中找到名称，然后在模块级字典中找到引用。

3.  有一个模块级`check_graph`函数，它将遍历已知`SpecialClass`实例并检查它们的所有特殊引用是否可用。

# php - 动态添加的选择框未发布

> ID：10607358
> 
> 赞同：0
> 
> 时间：2012-05-15T19:17:25.897
> 
> 标签：php, javascript, jquery

```
$.ajax({
        type: "POST",
        url: "add_secondary_interest.php",
        data: "interest=ok", 
        cache: false,
        success: function(html){
            $('#interest_table tr:last').after(html);
        }
}); 
```

ajax 响应是这样的

```
<select name="test[]">                                            
<option value='7'>abc</option>
<option value='1'>xyz</option>
</select> 
```

但是当我发布表单时，不会发布这个动态选择框。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:22:48.670

简短的回答是，当 jQuery 添加元素时，它会绑定到 table 元素而不是 form 元素。要解决此问题，请使 DOM 相对于表单。例如：

```
$.ajax({
    type: "POST",
    url: "add_secondary_interest.php",
    data: "interest=ok", 
    cache: false,
    success: function(html){
        $('form #interest_table tr:last').after(html); //<<<<<
    }} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:21:10.590

现在您将选择框放在 a 内，`<table>`但不在 a 内，`<td>`因此它不可见。

`<td>`Makr 确保通过您的 ajax 请求将其添加到现有的新的。

# java - Android在按钮点击时自动发送短信

> ID：10607361
> 
> 赞同：10
> 
> 时间：2012-05-15T19:18:02.953
> 
> 标签：java, android, android-intent, sms, send

当用户按下屏幕上的按钮时，我试图自动将 SMS 消息发送到某个号码。

这是我的代码：

```
Intent smsIntent = new Intent(Intent.ACTION_SENDTO,
Uri.parse("sms:xxxxxxxxxxx")); 
smsIntent.putExtra("sms_body", "Hello");
startActivity(smsIntent); 
```

xxxxxxx = 电话号码

我有以下权限：

```
<uses-permission android:name="android.permission.SEND_SMS"></uses-permission>
<uses-permission android:name="android.permission.RECEIVE_SMS"></uses-permission> 
```

当我按下按钮时，它会将我带到另一个屏幕，我可以在其中编辑文本并按下发送。我只是希望它自动执行此过程，而无需将我带到另一个屏幕。由于我已经定义了我的消息，我只想将它发送到一个特定的号码。

而且我不确定我是否将正确的电话号码放在第二行代码中。我必须先把我的国家代码放在那里还是我可以把我的手机号码放在那里就可以了？

谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-15T19:21:30.600

试试这个代码：

```
 String messageToSend = "this is a message";
 String number = "2121234567";

 SmsManager.getDefault().sendTextMessage(number, null, messageToSend, null,null); 
```

关于号码，您需要输入号码，就好像您是通过电话拨打该号码或以正常方式发送短信一样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T19:30:17.980

您也可以使用 Intent 中的构建：

```
 buttonSendSms_intent.setOnClickListener(new Button.OnClickListener(){

       @Override
       public void onClick(View arg0) {
        // TODO Auto-generated method stub

        String smsNumber = edittextSmsNumber.getText().toString();
        String smsText = edittextSmsText.getText().toString();

        Uri uri = Uri.parse("smsto:" + smsNumber);
        Intent intent = new Intent(Intent.ACTION_SENDTO, uri);
        intent.putExtra("sms_body", smsText);  
        startActivity(intent);
       }}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T19:26:50.497

试试这个

```
private static final String SMS_SENT_INTENT_FILTER = "com.yourapp.sms_send";
private static final String SMS_DELIVERED_INTENT_FILTER = "com.yourapp.sms_delivered";

String message = "hey, this is my message";

String phnNo = " " //preferable use complete international number

PendingIntent sentPI = PendingIntent.getBroadcast(this, 0, new Intent(
                SMS_SENT_INTENT_FILTER), 0);
PendingIntent deliveredPI = PendingIntent.getBroadcast(this, 0, new Intent(
                SMS_DELIVERED_INTENT_FILTER), 0);

SmsManager sms = SmsManager.getDefault();
sms.sendTextMessage(phnNo, null, message, sentPI, deliveredPI); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-05-15T19:32:02.710

简单的方法是使用 SmsManager.Telephony。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-08-10T03:32:55.663

首先设置以下权限：

```
<uses-permission android:name="android.permission.SEND_SMS"/>
<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.READ_PHONE_STATE"/> 
```

然后创建以下活动：

```
 <?xml version="1.0" encoding="utf-8"?>
    <android.support.constraint.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:app="http://schemas.android.com/apk/res-auto"
        xmlns:tools="http://schemas.android.com/tools"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        tools:context=".MainActivity">

        <EditText
            android:id="@+id/editText"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_marginEnd="41dp"
            android:layout_marginLeft="41dp"
            android:layout_marginRight="41dp"
            android:layout_marginStart="41dp"
            android:layout_marginTop="43dp"
            android:ems="10"
            android:hint="Enter Phone no"
            android:inputType="textPersonName"
            app:layout_constraintEnd_toEndOf="parent"
            app:layout_constraintStart_toStartOf="parent"
            app:layout_constraintTop_toTopOf="parent" />

        <EditText
            android:id="@+id/editText2"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_marginEnd="37dp"
            android:layout_marginLeft="37dp"
            android:layout_marginRight="37dp"
            android:layout_marginStart="37dp"
            android:layout_marginTop="28dp"
            android:ems="10"
            android:hint="Enter text"
            android:inputType="textPersonName"
            app:layout_constraintEnd_toEndOf="parent"
            app:layout_constraintStart_toStartOf="parent"
            app:layout_constraintTop_toBottomOf="@+id/editText" />

        <Button
            android:id="@+id/button"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="183dp"
            android:text="SEND"
            app:layout_constraintBottom_toBottomOf="parent"
            app:layout_constraintEnd_toEndOf="parent"
            app:layout_constraintStart_toStartOf="parent" />
    </android.support.constraint.ConstraintLayout> 
```

现在转到您的**MainActivity.java**文件并添加以下代码：

```
public class MainActivity extends AppCompatActivity {

    EditText e1, e2;
    Button b1;
    private final static int SEND_SMS_PERMISSION_REQ=1;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        e1=findViewById(R.id.editText);
        e2=findViewById(R.id.editText2);
        b1=findViewById(R.id.button);
        b1.setEnabled(false);

        if(checkPermission(Manifest.permission.SEND_SMS))
        {
            b1.setEnabled(true);
        }
        else
        {
            ActivityCompat.requestPermissions(this, new String[]{Manifest.permission.SEND_SMS}, SEND_SMS_PERMISSION_REQ);
        }
        b1.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                String s1=e1.getText().toString();
                String s2=e2.getText().toString();
                if(!TextUtils.isEmpty(s1)&&!TextUtils.isEmpty(s2))
                {

                    if(checkPermission(Manifest.permission.SEND_SMS))
                    {
                        SmsManager smsManager=SmsManager.getDefault();
                         smsManager.sendTextMessage(s1,null,s2,null,null);
                    }
                    else {
                        Toast.makeText(MainActivity.this, "Permission Denied", Toast.LENGTH_SHORT).show();
                    }
                }
                else
                {
                    Toast.makeText(MainActivity.this, "Permission denied", Toast.LENGTH_SHORT).show();
                }
            }
        });

    }

    private boolean checkPermission(String sendSms) {

        int checkpermission= ContextCompat.checkSelfPermission(this,sendSms);
        return checkpermission== PackageManager.PERMISSION_GRANTED;
    }

    @Override
    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {
        switch (requestCode)
        {
            case SEND_SMS_PERMISSION_REQ:
                if(grantResults.length>0 &&(grantResults[0]==PackageManager.PERMISSION_GRANTED))
                {
                    b1.setEnabled(true);
                }
                break;
        }
    }
} 
```

成功地做到了。

# javascript - 将 Javascript 计数器格式化为 00:26

> ID：10607363
> 
> 赞同：3
> 
> 时间：2012-05-15T19:18:15.153
> 
> 标签：javascript, jquery, time

我有一些 Javascript 代码，基本上是文件上传的“经过”计时器。这是代码：

```
// Update elapsed
var time = new Date().getTime() - startTime;
var elapsed = Math.floor(time / 100) / 10;
console.log(elapsed); 
```

使用它，我在控制台中得到的日志看起来像：`0.7, 0.8, 0.9, 1, 1.1, 1.2`等等。这些是秒，后面的数字`.`是十分之一秒。我想将其格式化为更易于阅读的形式，例如，26 秒是`00:26`，1 分钟 30 秒是`01:30`，20 分钟是`20:00`等等。

但是，我不知道如何正确编写函数将其转换为人类可读的形式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:25:43.257

[http://jsfiddle.net/69dgJ/1/](http://jsfiddle.net/69dgJ/1/)

```
function formatSecs(secs) {
    secs = parseInt(secs);
    ss = secs % 60;
    mm = Math.floor(secs / 60.0);
    if(ss < 10) { ss = "0" + ss; }
    if(mm < 10) { mm = "0" + mm; }
    fmt = mm + ":" + ss;
    return fmt;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:40:04.880

您可以将[sprintf() 用于 Javascript](http://www.diveintojavascript.com/projects/javascript-sprintf)并正确格式化输出。如果你用过`sprintf`其他语言，应该是微不足道的

# asp.net-mvc - 在 MvcScaffolding ASP.NET 网页中使用 LINQtoCSV

> ID：10607364
> 
> 赞同：1
> 
> 时间：2012-05-15T19:18:15.593
> 
> 标签：asp.net-mvc, linq, csv, export-to-csv

我正在尝试添加一个指向基本 MvcScaffolding 项目的链接，该项目从 IQueryable 接口输出所有数据。控制器是用`Scaffold Controller Sales -Repository`Sale 类构建的，没有什么特别之处，只有几个字符串和一些整数。项目中的一切都按预期工作。

从我发现的帖子中，LINQtoCSV 对我来说可能是一个可能的解决方案（http://www.codeproject.com/Articles/25133/LINQ-to-CSV-library）。不幸的是，我不知道要添加什么。如果我在 /Sales/ 的索引页面上有指向 /Sales/CSV/ 的链接，如何提示用户“下载或打开”？

我还看到了这个页面（http://www.asp.net/web-api/overview/formats-and-model-binding/media-formatters），它讲述了如何构建 Web API，但我不能使用 MVC 4 per公司标准。

我目前拥有的代码`SalesController.cs`如下（错误`[DirectoryNotFoundException: Could not find a part of the path 'C:\...\Sales\CSV\LINQtoCSV.CsvContext'.]`）：

```
 //
    // GET: /Sales/CSV/
    [Authorize]
    public FilePathResult CSV()
    {
        List<Sale> dataRows = saleRepository.All.ToList();

        CsvFileDescription outputFileDescription = new CsvFileDescription
        {
            SeparatorChar = '\t', // tab delimited
            //EnforceCsvColumnAttribute = false,
            FirstLineHasColumnNames = true, // no column names in first record
            FileCultureName = "en-US" // default is the current culture
        };
        CsvContext cc = new CsvContext();

        cc.Write<Sale>(dataRows,
            "output.csv",
            outputFileDescription);

        return File(cc.ToString(), "text/csv");
    } 
```

**编辑：** 修改代码以从存储库创建列表并使用 File() 输出。

**编辑：** 这是我正在使用的修改后的代码。在模型中，我正在构建带有连接列表的字符串。控制器代码如下：

```
 [Authorize]
    public FileStreamResult CSV3()
    {
        MemoryStream output = new MemoryStream();
        StreamWriter writer = new StreamWriter(output);
        saleRepository.All.ToList().ForEach(s => writer.WriteLine(s.ToStringCSV));

        writer.Flush();
        output.Position = 0;

        return File(output, "text/csv", "report.csv");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:20:23.363

也许您需要使用[FileResult](http://msdn.microsoft.com/en-us/library/system.web.mvc.fileresult.aspx)类？另请参阅[如何在 ASP.NET MVC 中创建文件并通过 FileResult 返回它？](https://stackoverflow.com/questions/1375486/how-to-create-file-and-return-it-via-fileresult-in-asp-net-mvc)

# html - Internet Explorer CSS - 中心区

> ID：10607368
> 
> 赞同：4
> 
> 时间：2012-05-15T19:18:30.123
> 
> 标签：html, css, internet-explorer, doctype

我最近做了一个网站，但我在使用 Internet Explorer 时遇到了一个非常大的问题。CSS 似乎在 IE 中做了一些奇怪的事情。这里不是复制数百行 CSS 而是指向网站页面的链接：http: [//www.appwheal.com/app/ios/angry-birds-space](http://www.appwheal.com/app/ios/angry-birds-space) 所有内容都应显示在屏幕中间. 取而代之的是 IE 它被卡在左边。

我在用着

```
margin-left: auto;

margin-right: auto; 
```

这是IE支持的，对吧。

请提前帮助和感谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-05-15T19:23:24.883

您需要声明一个`DOCTYPE`，或 Internet Explorer 默认为 Quirks 模式（IE5 兼容）。进入 Internet Explorer，按 F12 以调出开发者工具，并注意它在文档模式下显示“怪癖”模式。Quirks 不支持任何已知的 div 居中方法，并且声明[DOCTYPE](http://www.w3schools.com/tags/tag_doctype.asp)是修复它的最简单（也是推荐）的方法。

要将页面设置为 XHTML 1.0 过渡（最常见），请使用

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
```

要声明页面与 HTML5 兼容，请使用

```
<!DOCTYPE html> 
```

该`DOCTYPE`行必须是 html 文件中的第一行，出现在开始`<html>`标记之前。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:20:58.630

您还必须设置

```
body {
    text-align: center;
}

#yourDiv {
    margin: 0 auto;
    text-align: left;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T06:49:06.410

设置边距和宽度：

```
#yourDiv {
  margin: 0 auto;
  width: 300px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T19:22:57.737

你可以使用老派的 text-align:center 并尝试 top:50%; 左：50%；并偏移合适的负像素

# ruby-on-rails - 将 .js 控制器请求呈现为 html

> ID：10607369
> 
> 赞同：4
> 
> 时间：2012-05-15T19:18:31.043
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3, controller

我`before_filter`在我的 Rails 应用程序中有一个发送用户，`login_url`如果他们在提交请求（以 html 或 js 格式）时注销。

我希望我`format.js`产生与 相同的结果`format.html`，在以下情况下以“通知”布局呈现视图。我怎样才能做到这一点？

```
respond_to do |format|
  format.js
  format.html{ render :layout => "notice" }
end 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T19:29:01.093

您可以强制使用这样的可用格式：

```
respond_to do |format|
  format.js   { render :layout => "notice", :formats => [:html] }
  format.html { render :layout => "notice" }
end 
```

编辑：

您需要的是文档的某些部分被响应替换。这是通过使用完成这项工作的 javascript 响应来完成的：

在您的控制器中：

```
respond_to do |format|
  format.js
  format.html { render :layout => "notice" }
end 
```

在您的 login.js 视图中：

```
$('#whatever').html('<%= escape_javascript( render :login, formats: [ :html ]) %>') 
```

...或类似的东西

# javascript - require.js 文本插件在文件名中添加“.js”

> ID：10607370
> 
> 赞同：15
> 
> 时间：2012-05-15T19:18:34.350
> 
> 标签：javascript, text, backbone.js, requirejs

我正在尝试使用 requirejs 和文本插件，但我遇到了奇怪的问题。

我有两个网络服务器：

1.  **localhost:3000** - 充当 CDN 并拥有所有静态文件：js、图像、css 和模板
2.  **localhost:3001** - 服务器 - 充当 REST 服务器并仅提供一个文件，即 main.html 文件

main.html 文件使用以下行从第二个服务器加载所有**js文件：**

```
<script data-main="http://localhost:3000/js/main" 
        src="http://localhost:3000/lib/require-jquery.js"></script> 
```

出于某种原因，在使用**requirejs 文本插件时，他在导航到****localhost:3001**时添加到模板`".js"`后缀

 **我正在使用以下语法：

```
define ['jquery','backbone','underscore','models/model','text!templates/main.html', 
        'views/navigation', 'views/player', 'views/content', 'views/header'] 
```

当我导航到**localhost:3000**时，它工作正常。

您能想到文本插件在从远程服务器（例如 CDN 服务器）提供文本文件时出现问题的任何原因吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-06-26T10:10:42.260

The [documentation of the text plugin](https://github.com/requirejs/text#xhr-restrictions) gives a hint to the solution: It's possible to configure the plugin in a way that it always fetches remote resources via XHR without appending the `.js` suffix and loading it via script tag. The simple solution is to always enforce using XHR:

```
requirejs.config({
   config: {
      text: {
         useXhr: function (url, protocol, hostname, port) {
            return true;
         }
      }
   }
}); 
```

Note that the remote server needs to set the correct CORS header and that this could be a security issue. Thus add the necessary checks for trusted urls when using this instead of simply returning `true`.

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-07-02T13:36:00.280

我在跨域工作时遇到了文本插件问题，也许你的两个本地主机服务器也遇到了这个问题。

在网络检查器中，我看到**require.js**试图获取类似`some-content.html.js`而不是`some-content.html`.

您是在开发模式下运行此代码还是构建到生产集中？当您将所有内容捆绑在一起时，文本插件不应该有同样的跨域问题。

这是给我提示的 API 文档部分（来自[http://requirejs.org/docs/api.html](http://requirejs.org/docs/api.html)）：

> baseUrl 可以是与将加载 require.js 的页面不同的域上的 URL。RequireJS 脚本加载跨域工作。**唯一的限制是文本加载的文本内容！插件：这些路径应该与页面在同一个域中，至少在开发过程中是这样。**优化工具将内联文本！插件资源，所以使用优化工具后，您可以使用引用文本的资源！来自另一个域的插件资源。

[这是一篇帮助我为支持](http://jaketrent.com/post/cross-domain-requirejs-text/)[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)的浏览器解决此问题的文章：

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-16T12:22:59.053

我已经深入研究了文本插件的代码。

我发现文本插件假定开发人员将文本模板转换为 html，因为它位于不同的域中。

我已经将文本插件的代码更改为不假设它。

有人认为我做错了什么？

插件原代码：

```
 //Load the text. Use XHR if possible and in a browser.
            if (!hasLocation || useXhr(url, defaultProtocol, defaultHostName, defaultPort)) {
                text.get(url, function (content) {
                    text.finishLoad(name, parsed.strip, content, onLoad, config);
                });
            } else {
                //Need to fetch the resource across domains. Assume
                //the resource has been optimized into a JS module. Fetch
                //by the module name + extension, but do not include the
                //!strip part to avoid file system issues.
                req([nonStripName], function (content) {
                    text.finishLoad(parsed.moduleName + '.' + parsed.ext,
                                    parsed.strip, content, onLoad, config);
                });
            } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-19T21:53:38.527

除了运行 r.js 优化器并将我的模板编译成 .js 文件之外，我已经破解了我在互联网上看到的所有解决方案。

临时解决方法是将模板放在与 index.html 文件相同的目录中。这当然不能解决问题，但如果你像我一样处于静止状态，那么这至少会让你再次移动。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-03T17:15:13.077

我遇到了同样的问题，解决方法是确保 main.js 文件是从与 *.htm 文件相同的域加载的。当它们不同时，require 会将 .js 附加到 html 文件中，从而导致 404。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-12-12T12:07:09.403

作为另一种替代方法，您可以使用 jQuery get 方法将模板的内容作为纯文本获取，然后使用 Handlebars 对其进行编译。在花了几个小时在论坛上阅读有关 require.js 文本插件和 CORS 的问题后，我将这个解决方案作为最后的手段。这是一个例子：

模板：

```
<span class="badge badge-pill badge-danger">Default</span>
<div class="entry">
    <h1>{{title}}</h1>
    <div class="body">
        {{body}}
    </div>
</div> 
```

js脚本：

```
var deps = [
    'jquery',
    'handlebars',
];

require(deps, function($, handlebars){

    var template = 'https://your_site/raw.templates/basic.handlebars';

    $.get(template, function( data, textStatus, jqxhr ) {
        var Handlebars = handlebars;

        var basicTemplate = Handlebars.compile(data);

        var context = {title: "My New Post", body: "This is my first post!"};

        var html = basicTemplate(context);

        var grid = document.createElement('div');
        grid.setAttribute('id', 'itemsGrid');
        grid.innerHTML = html;
        document.body.appendChild(grid);

    });

}); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-05-01T17:34:25.943

这样的配置在当前文本中不起作用！插入。我的解决方案是在“文本”模块中覆盖 useXhr 方法

```
require(["text"], function (text)
{   if( location.port == '4502' || location.port == '4503' )// AEM env-t
        text.useXhr = function(){ return true; }
    require(["loader/widget/WidgetLoader"]); // dependent on HTML templates by text! plugin
}); 
```**

# php - PHP rename() 不会在错误时抛出异常

> ID：10607373
> 
> 赞同：6
> 
> 时间：2012-05-15T19:18:37.580
> 
> 标签：php, exception-handling

我正在使用一个 php 应用程序，并且有一行移动文件。我将该方法包含在 try...catch 块中，因此，如果抛出错误，可以管理回滚系统。但是异常永远不会被捕获，所以，重命名会引发任何类型的异常？我需要尝试其他方法吗？

谢谢

上面的代码：

```
try{
   if(rename($archivo_salida, $ruta_archivos)){
    //anything;
   }

}catch (Exception $e)
  //do something
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-15T19:23:05.833

“正常” PHP 函数不会抛出异常。

更改代码以模拟异常：

```
try{
   if(rename($archivo_salida, $ruta_archivos)){
      //anything;
   } else {
      throw new Exception('Can not rename file'.$archivo_salida);
   }
}catch (Exception $e)
   //do something
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T19:20:49.310

`rename()`只返回真/假 - 没有抛出异常。

[http://php.net/manual/en/function.rename.php](http://php.net/manual/en/function.rename.php)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T19:20:57.850

它`FALSE`在失败时返回。见[http://php.net/manual/en/function.rename.php](http://php.net/manual/en/function.rename.php)

如果你真的需要在重命名失败时抛出异常，你可以这样做：

```
if (rename($archivo_salida, $ruta_archivos)) {
    // anything;
} else {
    throw new Exception("Rename failed.");
} 
```

现在，您可以将它包装`try {} catch {}`在您调用此代码的块周围。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-12T08:46:52.687

您也可以使用与此答案中所述相同的方法：[https ://stackoverflow.com/a/43364340/563049](https://stackoverflow.com/a/43364340/563049)

创建一个自定义异常类，并将其静态构造方法与`or`operator after一起使用`rename()`。

异常类：

```
class CustomException extends Exception {
  static public function doThrow($message = "", $code = 0, Exception $previous = null) {
    throw new Exception($message, $code, $previous);
  }
} 
```

用法：

```
try {

  rename($archivo_salida, $ruta_archivos) or CustomException::doThrow('Renaming failed.');

} catch (Exception $e){
  //do something
} 
```

> **笔记**
> 
> 如果您使用的是 PHP 7 及更高版本 - 您可以将静态方法重命名`doThrow()`为 simple `throw()`，因为在 PHP 7 及更高版本中允许使用保留关键字作为方法名称。

# c# - 测试角色是否来自 .net 中某个类别的最佳方法

> ID：10607374
> 
> 赞同：1
> 
> 时间：2012-05-15T19:18:42.530
> 
> 标签：c#, .net, algorithm, text, nlp

我需要一种有效的方法来测试给定字符（System.Char）是否为辅音。然后我需要同样的东西来处理元音。更一般地说，我需要以下接口的有效实现，因为目标字符集大约有 20 个字符。请指教。谢谢！

```
using System;

public interface ITester
{
    Boolean IsInCategory(Char something);
} 
```

**更新**

好的，伙计们，我已经进行了一些测试。这就是我得到的。最好的方法是使用预先计算的映射，其中每个字符都映射到布尔值。（请参阅下面代码中的 IndexBased）。事实证明，HashSet 并不是最好的。如果有人有更多想法，请告诉我。

```
[TestClass]
public class Runner
{
    public const Int32 NumberOfRuns = 10000;
    public const String TextSample = @"The Letter It was November. Although it was not yet late, the sky was dark when I turned into Laundress Passage. Father had finished for the day, switched off the shop lights and closed the shutters; but so I would not come home to darkness he had left on the light over the stairs to the flat. Through the glass in the door it cast a foolscap rectangle of paleness onto the wet pavement, and it was while I was standing in that rectangle, about to turn my key in the door, that I first saw the letter. Another white rectangle, it was on the fifth step from the bottom, where I couldn't miss it. I closed the door and put the shop key in its usual place behind Bailey's Advanced Principles of Geometry. Poor Bailey. No one has wanted his fat gray book for thirty years. Sometimes I wonder what he makes of his role as guardian of the bookshop keys. I don't suppose it's the destiny he had in mind for the masterwork that he spent two decades writing. A letter. For me. That was something of an event. The crisp-cornered envelope, puffed up with its thickly folded contents, was addressed in a hand that must have given the postman a certain amount of trouble. Although the style of the writing was old-fashioned, with its heavily embellished capitals and curly flourishes, my first impression was that it had been written by a child. The letters seemed untrained. Their uneven strokes either faded into nothing or were heavily etched into the paper. There was no sense of flow in the letters that spelled out my name.";
    private interface ITester
    {
        Boolean IsConsonant(Char something);
    }

    // results in millisecs: 14807, 16411, 15050, 
    private class HashSetBasedTester : ITester
    {
        private HashSet<Char> hash;
        public HashSetBasedTester()
        {
            this.hash = new HashSet<Char>("bcdfghjklmnpqrstvwxz");
        }
        public Boolean IsConsonant(Char something)
        {
            return this.hash.Contains(Char.ToLower(something));
        }
    }

    // results in millisecs: 12270, 12495, 12853,
    private class HardcodedTester : ITester
    {
        public Boolean IsConsonant(Char something)
        {
            var lower = Char.ToLower(something);
            return lower == 'b' || lower == 'c' || lower == 'd' || lower == 'f' || lower == 'g' || lower == 'h' || lower == 'j' || lower == 'k' || lower == 'l' || lower == 'm' || lower == 'n' || lower == 'p' || lower == 'q' || lower == 'r' || lower == 's' || lower == 't' || lower == 'v' || lower == 'w' || lower == 'x' || lower == 'z';
        }
    }

    // WORST RESULTS
    // results in millisecs: 32140, 31549, 31856
    private class ListBasedTester : ITester
    {
        private List<Char> list;
        public ListBasedTester()
        {
            this.list = new List<Char> { 'b', 'c', 'd', 'f', 'g', 'h', 'j', 'k', 'l', 'm', 'n', 'p', 'q', 'r', 's', 't', 'v', 'w', 'x', 'z' };
        }
        public Boolean IsConsonant(Char something)
        {
            return this.list.Contains(Char.ToLower(something));
        }
    }

    // WINNER! (fastest and most consistent)
    // results in millisecs: 11335, 11349, 11386, 
    private class IndexBased : ITester
    {
        private Boolean[] map;
        private char min;
        private char max;
        public IndexBased()
        {
            var chars = "bcdfghjklmnpqrstvwxz".ToArray();
            this.min = chars.Min();
            this.max = chars.Max();
            var length = this.max - this.min + 1;
            this.map = new Boolean[length];
            foreach (var at in chars)
            {
                map[at - min] = true;
            }
        }
        public Boolean IsConsonant(Char something)
        {
            something = Char.ToLower(something);
            return something <= this.max && something >= this.min && this.map[something - this.min];
        }
    }

    [TestMethod]
    public void RunTest()
    {
        var tester = new IndexBased(); // new HashSetBasedTester(); // new HardcodedTester(); // new ListBasedTester(); //
        var stopwatch = Stopwatch.StartNew();
        for (var i = 0; i < NumberOfRuns; i++)
        {
            foreach (var at in TextSample)
            {
                var tested = tester.IsConsonant(at);
            }
        }
        Trace.WriteLine(stopwatch.ElapsedMilliseconds.ToString());
    }
} 
```

**更新 2：**

这组测试不会强制转换为下/上，我们有更好的结果！无论如何，最爱/失败者都是一样的。一探究竟：

```
[TestClass]
public class Runner
{
    public const Int32 NumberOfRuns = 10000;
    public const String TextSample = @"The Letter It was November. Although it was not yet late, the sky was dark when I turned into Laundress Passage. Father had finished for the day, switched off the shop lights and closed the shutters; but so I would not come home to darkness he had left on the light over the stairs to the flat. Through the glass in the door it cast a foolscap rectangle of paleness onto the wet pavement, and it was while I was standing in that rectangle, about to turn my key in the door, that I first saw the letter. Another white rectangle, it was on the fifth step from the bottom, where I couldn't miss it. I closed the door and put the shop key in its usual place behind Bailey's Advanced Principles of Geometry. Poor Bailey. No one has wanted his fat gray book for thirty years. Sometimes I wonder what he makes of his role as guardian of the bookshop keys. I don't suppose it's the destiny he had in mind for the masterwork that he spent two decades writing. A letter. For me. That was something of an event. The crisp-cornered envelope, puffed up with its thickly folded contents, was addressed in a hand that must have given the postman a certain amount of trouble. Although the style of the writing was old-fashioned, with its heavily embellished capitals and curly flourishes, my first impression was that it had been written by a child. The letters seemed untrained. Their uneven strokes either faded into nothing or were heavily etched into the paper. There was no sense of flow in the letters that spelled out my name.";
    private interface ITester
    {
        Boolean IsConsonant(Char something);
    }

    // results in millisecs: 8378, 7980, 7533, 7752
    private class HashSetBasedTester : ITester
    {
        private HashSet<Char> hash;
        public HashSetBasedTester()
        {
            this.hash = new HashSet<Char>("bcdfghjklmnpqrstvwxzBCDFGHJKLMNPQRSTVWXZ");
        }
        public Boolean IsConsonant(Char something)
        {
            return this.hash.Contains(something);
        }
    }

    // results in millisecs: 6406, 6667, 6500, 6708
    private class HardcodedTester : ITester
    {
        public Boolean IsConsonant(Char something)
        {
            return something == 'b' || something == 'c' || something == 'd' || something == 'f' || something == 'g' || something == 'h' || something == 'j' || something == 'k' || something == 'l' || something == 'm' || something == 'n' || something == 'p' || something == 'q' || something == 'r' || something == 's' || something == 't' || something == 'v' || something == 'w' || something == 'x' || something == 'z' ||
                something == 'B' || something == 'C' || something == 'D' || something == 'F' || something == 'G' || something == 'H' || something == 'J' || something == 'K' || something == 'L' || something == 'M' || something == 'N' || something == 'P' || something == 'Q' || something == 'R' || something == 'S' || something == 'T' || something == 'V' || something == 'W' || something == 'X' || something == 'Z';
        }
    }

    // WORST RESULTS
    // results in millisecs: 36585, 37702, ...
    private class ListBasedTester : ITester
    {
        private List<Char> list;
        public ListBasedTester()
        {
            this.list = new List<Char> { 'b', 'c', 'd', 'f', 'g', 'h', 'j', 'k', 'l', 'm', 'n', 'p', 'q', 'r', 's', 't', 'v', 'w', 'x', 'z',
                'B', 'C', 'D', 'F', 'G', 'H', 'J', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'X', 'Z' };
        }
        public Boolean IsConsonant(Char something)
        {
            return this.list.Contains(something);
        }
    }

    // WINNER!
    // results in millisecs: 4716, 4846, 4756, 4550
    private class IndexBased : ITester
    {
        private Boolean[] map;
        private char min;
        private char max;
        public IndexBased()
        {
            var chars = "bcdfghjklmnpqrstvwxzBCDFGHJKLMNPQRSTVWXZ".ToArray();
            this.min = chars.Min();
            this.max = chars.Max();
            var length = this.max - this.min + 1;
            this.map = new Boolean[length];
            foreach (var at in chars)
            {
                map[at - min] = true;
            }
        }
        public Boolean IsConsonant(Char something)
        {
            return something <= this.max && something >= this.min && this.map[something - this.min];
        }
    }

    [TestMethod]
    public void RunTest()
    {
        var tester = new IndexBased();//new IndexBased(); // new HashSetBasedTester(); // new HardcodedTester(); // new ListBasedTester(); //
        var stopwatch = Stopwatch.StartNew();
        for (var i = 0; i < NumberOfRuns; i++)
        {
            foreach (var at in TextSample)
            {
                var tested = tester.IsConsonant(at);
            }
        }
        Trace.WriteLine(stopwatch.ElapsedMilliseconds.ToString());
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T19:23:01.027

[`HashSet<char>`](http://msdn.microsoft.com/en-us/library/bb359438.aspx)会成功的。为辅音、元音等创建单独的实例，并使用它们来测试成员资格。

```
ISet<char> vowels = new HashSet<char>("auoie");

if (vowels.Contains('a')) {
    // ...
} 
```

**更新：**对于字符的英文子集，您可以构建一个`bool`数组 - 类似于您在更新中使用的数组，但没有偏移量`min`，并且有大写/小写重复：它会更快 - 几乎和它一样快得到。

```
private class IndexBased : ITester {
    private readonly bool[] map = new bool[128];
    public IndexBased() {
        foreach (var ch in "bcdfghjklmnpqrstvwxz") {
            map[ch] = map[Char.ToUpper(ch)] = true;
        }
    }
    public bool IsConsonant(Char ch) {
        return ch < map.Length && map[ch];
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:44:26.633

我给了 dasblinenlight +1，但如果你需要不区分大小写，那么

```
private HashSet<string> vowels = new HashSet<string>(StringComparer.CurrentCultureIgnoreCase); 
```

可能会提供更好的性能。

据我所知，没有快速简单的不区分大小写的字符比较。如果有请告诉我。

我尝试了以下，这是一个死热

> HashSet consonantHSchar = new HashSet { 'B', 'C', 'D', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N'、'P'、'Q'、'R'、'S'、'T'、'V'、'W'、'X'、'Y'、'Z'、'b'、'c '，'d'，'f'，'g'，'h'，'i'，'j'，'k'，'l'，'m'，'n'，'p'，'q'， 'r'、's'、't'、'v'、'w'、'x'、'y'、'z' }; List consonantListchar = new List { 'B', 'C', 'D', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N'、'P'、'Q' ，'R'，'S'，'T'，'V'，'W'，'X'，'Y'，'Z'，'b'，'c'，'d'，'f'，' g'、'h'、'i'、'j'、'k'、'l'、'm'、'n'、'p'、'q'、'r'、's'、't' ,'v','w','x','y','z'}; HashSet consonantHSstring = new HashSet(StringComparer.CurrentCultureIgnoreCase) { “B”、“C”、“D”、“F”、“G”、“H”、“I”、“J”、“K”、“L” ，“M”，“N”，“P”，“Q”，“R”，“S”，“T”，“V”，“W”，“X”，“Y”，“Z”}；'T'、'V'、'W'、'X'、'Y'、'Z'、'b'、'c'、'd'、'f'、'g'、'h'、'i '，'j'，'k'，'l'，'m'，'n'，'p'，'q'，'r'，'s'，'t'，'v'，'w'， 'x', 'y', 'z' }; HashSet consonantHSstring = new HashSet(StringComparer.CurrentCultureIgnoreCase) { “B”、“C”、“D”、“F”、“G”、“H”、“I”、“J”、“K”、“L” ，“M”，“N”，“P”，“Q”，“R”，“S”，“T”，“V”，“W”，“X”，“Y”，“Z”}；'T'、'V'、'W'、'X'、'Y'、'Z'、'b'、'c'、'd'、'f'、'g'、'h'、'i '，'j'，'k'，'l'，'m'，'n'，'p'，'q'，'r'，'s'，'t'，'v'，'w'， 'x', 'y', 'z' }; HashSet consonantHSstring = new HashSet(StringComparer.CurrentCultureIgnoreCase) { “B”、“C”、“D”、“F”、“G”、“H”、“I”、“J”、“K”、“L” ，“M”，“N”，“P”，“Q”，“R”，“S”，“T”，“V”，“W”，“X”，“Y”，“Z”}；Y'、'Z'、'b'、'c'、'd'、'f'、'g'、'h'、'i'、'j'、'k'、'l'、'm' ，'n'，'p'，'q'，'r'，'s'，'t'，'v'，'w'，'x'，'y'，'z'}; HashSet consonantHSstring = new HashSet(StringComparer.CurrentCultureIgnoreCase) { “B”、“C”、“D”、“F”、“G”、“H”、“I”、“J”、“K”、“L” ，“M”，“N”，“P”，“Q”，“R”，“S”，“T”，“V”，“W”，“X”，“Y”，“Z”}；Y'、'Z'、'b'、'c'、'd'、'f'、'g'、'h'、'i'、'j'、'k'、'l'、'm' ，'n'，'p'，'q'，'r'，'s'，'t'，'v'，'w'，'x'，'y'，'z'}; HashSet consonantHSstring = new HashSet(StringComparer.CurrentCultureIgnoreCase) { “B”、“C”、“D”、“F”、“G”、“H”、“I”、“J”、“K”、“L” ，“M”，“N”，“P”，“Q”，“R”，“S”，“T”，“V”，“W”，“X”，“Y”，“Z”}；,'j','k','l','m','n','p','q','r','s','t','v','w',' x', 'y', 'z' }; HashSet consonantHSstring = new HashSet(StringComparer.CurrentCultureIgnoreCase) { “B”、“C”、“D”、“F”、“G”、“H”、“I”、“J”、“K”、“L” ，“M”，“N”，“P”，“Q”，“R”，“S”，“T”，“V”，“W”，“X”，“Y”，“Z”}；,'j','k','l','m','n','p','q','r','s','t','v','w',' x', 'y', 'z' }; HashSet consonantHSstring = new HashSet(StringComparer.CurrentCultureIgnoreCase) { “B”、“C”、“D”、“F”、“G”、“H”、“I”、“J”、“K”、“L” ，“M”，“N”，“P”，“Q”，“R”，“S”，“T”，“V”，“W”，“X”，“Y”，“Z”}；
> 
> ```
> Stopwatch sw = new Stopwatch();
> 
> sw.Start();
> if (consonantHSchar.Contains('b')) Debug.WriteLine("consonantHSchar.Contains('b')");
> if (consonantHSchar.Contains('m')) Debug.WriteLine("consonantHSchar.Contains('m)");
> if (consonantHSchar.Contains('z')) Debug.WriteLine("consonantHSchar.Contains('z')");
> sw.Stop();
> Debug.WriteLine(sw.ElapsedMilliseconds.ToString());
> sw.Restart();
> if (consonantListchar.Contains('b')) Debug.WriteLine("consonantListchar.Contains('b')");
> if (consonantListchar.Contains('m')) Debug.WriteLine("consonantListchar.Contains('m')");
> if (consonantListchar.Contains('z')) Debug.WriteLine("consonantListchar.Contains('z')");
> sw.Stop();
> Debug.WriteLine(sw.ElapsedMilliseconds.ToString());
> sw.Restart();
> if (consonantHSstring.Contains("b")) Debug.WriteLine("consonantHSstring.Contains('b')");
> if (consonantHSstring.Contains("m")) Debug.WriteLine("consonantHSstring.Contains('m')");
> if (consonantHSstring.Contains("z")) Debug.WriteLine("consonantHSstring.Contains('z')");
> sw.Stop();
> Debug.WriteLine(sw.ElapsedMilliseconds.ToString());
> sw.Restart();
> if (consonantListchar.Contains('b')) Debug.WriteLine("consonantListchar.Contains('b')");
> if (consonantListchar.Contains('m')) Debug.WriteLine("consonantListchar.Contains('m')");
> if (consonantListchar.Contains('z')) Debug.WriteLine("consonantListchar.Contains('z')");
> sw.Stop();
> Debug.WriteLine(sw.ElapsedMilliseconds.ToString());
> sw.Restart();
> if (consonantHSchar.Contains('b')) Debug.WriteLine("consonantHSchar.Contains('b')");
> if (consonantHSchar.Contains('m')) Debug.WriteLine("consonantHSchar.Contains('m)");
> if (consonantHSchar.Contains('z')) Debug.WriteLine("consonantHSchar.Contains('z')");
> sw.Stop();
> Debug.WriteLine(sw.ElapsedMilliseconds.ToString()); 
> ```

# java - Java Youtube api

> ID：10607377
> 
> 赞同：-2
> 
> 时间：2012-05-15T19:19:25.143
> 
> 标签：java, api, youtube, youtube-api

我对 java youtube api 有疑问：

我认为每个java api程序的基础都是一个YouTubeService实例所以我创建了一个但没有方法（我导入了com.google.gdata.client.youtube.YouTubeService）例如我不能做service.getFeed（ ) 不起作用。或者我在示例和文档中阅读的任何其他方法。我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-20T19:18:34.530

我刚刚发现发生了什么事。我应该包括所有 gdata 库，而不仅仅是 gdata-youtube

# php - 在数组中，如何使值（在键/值对中）等于变量？

> ID：10607381
> 
> 赞同：2
> 
> 时间：2012-05-15T19:19:44.083
> 
> 标签：php

例如，我在课堂上有这个：

```
private $messages = array( 
    'name'=>        '<aa_f>name',
    'PASS' =>       '<aa_p>'
); 
```

但我想做`<aa_p>`一个这样的变量：

```
private $pass = '<aa_p>'; 
```

我已经尝试了这4种方法，但都没有奏效。PHP.net 没有这样做的例子。

```
 'PASS' =>       $this->pass
    'PASS' =>       $pass
    'PASS' =>       '$this->pass'
    'PASS' =>       '$pass' 
```

**完整代码**

```
<?php
class Message
{
    private $PASS = '<aa_p>';
    private $FAIL = '<aa_f>';

    private $messages = array( 
        'name'=>        '<aa_f>name',
        'email' =>      '<aa_f>email_s', 
        'pass' =>       '<aa_f>pass',
        'url' =>        '<aa_f>url',
        'title' =>      '<aa_f>title',
        'tweet'=>       '<aa_f>tweet',
        'empty' =>      '<aa_f>empty', 
        'same' =>       '<aa_f>same',  
        'taken' =>      '<aa_f>taken', 
        'validate' =>   '<aa_f>validate',
        'PASS' =>       '<aa_p>'
    );
    public function __construct()
    {
    }
    public function display($type)
    {
        echo $this->messages[$type];
    }
    public function get($type)
    {
        return $this->messages[$type];
    }
} 
```

**更新：回答**

供参考：（更新代码）

```
class Message
{
    private $PASS = '<aa_p';
    private $FAIL = '<aa_f>';
    private $messages = array();

    public function __construct()
    {
        $this->messages['PASS'] = $this->PASS;
        $this->messages['name'] = $this->FAIL . 'name';
        $this->messages['email'] = $this->FAIL . 'email_s';
        $this->messages['pass'] = $this->FAIL . 'pass';
        $this->messages['url'] = $this->FAIL . 'url';
        $this->messages['title'] = $this->FAIL . 'title';
        $this->messages['tweet'] = $this->FAIL . 'tweet';
        $this->messages['empty'] = $this->FAIL . 'empty';
        $this->messages['same'] = $this->FAIL . 'same';
        $this->messages['taken'] = $this->FAIL . 'taken';
        $this->messages['validate'] = $this->FAIL . 'validate';
    }
    public function display($type)
    {
        echo $this->messages[$type];
    }
    public function get($type)
    {
        return $this->messages[$type];
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:26:37.797

如果你的意思是你有这样的东西：

```
class Test {
    private $pass = '<aa_p>';
    private $messages = array(
        'name' => '...',
        'PASS' => '...'
    );
} 
```

并且您想设置`'PASS'`为私有`$pass`属性的值，那么您不能在定义中执行此操作，因为 PHP 语法不允许这样做。您必须在可以评估表达式的地方执行此操作，例如在方法中。构造函数将是一个很好的地方：

```
class Test {
    private $pass = '<aa_p>';
    private $messages = array(
        'name' => '...'
    );

    public function __construct() {
        $this->messages['PASS'] = $this->pass;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T19:26:48.733

您需要在构造函数中设置变量。在构造函数之外，您无法读取其他变量。

```
class Message{
    private $PASS = '<aa_p>';
    private $messages = array();

    public function __construct(){
        $this->messages['PASS'] = $this->PASS;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-15T19:27:24.303

只有可以在编译时确定的值才能用于启动类成员。您需要在运行时设置值（通过构造函数）：

```
class Message
{
    private $PASS = '<aa_p';
    private $FAIL = '<aa_f>';

    private $messages = array( 
        'name'=>        '<aa_f>name',
        'email' =>      '<aa_f>email_s', 
        'pass' =>       '<aa_f>pass',
        'url' =>        '<aa_f>url',
        'title' =>      '<aa_f>title',
        'tweet'=>       '<aa_f>tweet',
        'empty' =>      '<aa_f>empty', 
        'same' =>       '<aa_f>same',  
        'taken' =>      '<aa_f>taken', 
        'validate' =>   '<aa_f>validate',
        'PASS' =>       null
    );

    public function __construct()
    {
        $this->messages['PASS'] = $this->PASS;
    }

} 
```

# jquery - jQuery 动画可放置元素不会为其“目标可放置区域”设置动画

> ID：10607388
> 
> 赞同：1
> 
> 时间：2012-05-15T19:19:54.017
> 
> 标签：jquery, jquery-animate, draggable, droppable

我在下面有这段代码，当您开始拖动可拖动元素时，它会将一个充满可放置元素的 DIV 动画化到视图中

```
 var droptions = {
            accept: '.sdPlayer',
            hoverClass: 'target',
            tolerance: 'pointer',
            drop: function( event, ui ) {
                var songId = (ui.draggable[0].id).substring(3);
                var mixId = (event.target.id).substring(4);
                alert('Song '+songId+' added to mix '+mixId);
            }           
        }
        $('.sdPlayer').draggable({
            revert: true,
            revertDuration: 100,
            distance: 40,
            zIndex: 10, 
            start: function(){
                $('#mix-dropper').animate({top:122},200);
            },
            drag: function(){
                pl.dragging = true;
            },
            stop: function(){
                $('#mix-dropper').delay(500).animate({top:12},300);
                pl.dragging = false;
            }
        }); 
```

以及使用 droppables 创建 div 的函数：

```
// Insert user's mixes into #mix-dropper div below header
function mixDropper(){
    $.ajax({
        type: 'GET',
        url: baseURL+"mixes/getmixes/",
        success: function( response ){
            $( '#mix-dropper-mixes' ).html( response ); 
            //make newly appended divs droppable
            $( ".mix-dropper-mix" ).droppable(droptions)
        }
    });
} 
```

我遇到的问题是，您必须将可拖动对象拖到`$('#mix-dropper-mix')`它所在的区域上，然后才能对其父`$('#mix-dropper')`对象进行动画处理，我不知何故需要可拖动对象来识别可放置对象已移动。

谁能告诉我如何做到这一点或其他一些解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-14T15:03:34.997

是的（为时已晚 4 年），添加`refreshPositions: true,`到`$('.sdPlayer').draggable({`将使其解决。

我花了很长时间才弄清楚这一点。

# elasticsearch - 创建索引 - 弹性搜索 - Java API

> ID：10607391
> 
> 赞同：1
> 
> 时间：2012-05-15T19:20:09.700
> 
> 标签：elasticsearch

我正在尝试使用 Elastic Search Java API 创建索引。

我的代码与此类似：

```
String indexName = "clients";
Node node =  new NodeBuilder().clusterName(this.clusterName).client(true).node();
Client client = node.client();

client.admin().indices().prepareCreate(indexName).execute().actionGet(); // It fails here

if (client != null) client.close();
if (node != null) node.close(); 
```

但是每次，我执行都会收到此错误：[http ://screencast.com/t/MfnTccwho](http://screencast.com/t/MfnTccwho)

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:26:02.430

看起来弹性搜索客户端版本和弹性搜索服务器版本不匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T20:16:16.140

您还应该检查 elasticsearch 集群的 jvm 版本和您的客户端是否匹配，我碰巧我的客户端是 1.7 并且 elasticsearch 在 openjdk 1.6 下运行，抛出该异常。

一旦 elasticsearch 和 java 版本匹配，您将获得“真正的”异常:)

# android - 自定义全局应用程序类因“android.app.Application 无法转换为”而中断

> ID：10607392
> 
> 赞同：149
> 
> 时间：2012-05-15T19:20:11.483
> 
> 标签：android

我有一个看起来像这样的自定义全局类

```
import android.app.Application;

public class MyApp extends Application {

    public String MainAct;

    public String getMainAct() {
        return MainAct;
    }

    public void setMainAct(String mainAct) {
        MainAct = mainAct;
    }
} 
```

我想通过另一个方法在这个类中保留一个`Activity`字符串`onCreate`。

```
 String local = "myLocalVariable";
    ((MyApp) getApplication()).setMainAct(local); //breaks here!!!
    String name = ((MyApp) getApplication()).getMainAct(); 
```

它在标记线上中断并出现错误：`Caused by: java.lang.ClassCastException: android.app.Application cannot be cast to com.xxx.yyy.global.MyApp`

我已经检查了五次代码，但在任何地方都找不到错误。谁能告诉我错误在哪里？！

谢谢

* * *

## 回答 #1

> 赞同：513
> 
> 时间：2012-05-15T19:21:53.853

错误表明返回的对象的类型`getApplication`是`android.app.Application`。造成这种情况的一个可能原因是您未能在清单中定义应用程序。确保您的清单包含以下内容：

```
<application android:name=".MyApp"...
</application> 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2016-10-30T17:51:14.123

**旧 Android 设备或模拟器**的另一种解决方案。您在清单中定义了一个应用程序：

```
 <application 
           android:name=".MyApp"...
    </application> 
```

但你还有这个问题吗？

**尝试禁用即时运行：**

1.  禁用即时运行
2.  清理并重建项目
3.  从设备中删除应用程序并再次安装，无需即时运行

# entity-framework - 实体框架一对一插入

> ID：10607395
> 
> 赞同：0
> 
> 时间：2012-05-15T19:20:22.943
> 
> 标签：entity-framework, c#-4.0

我有一个架构，其中一个表可能有 6-7 个 1 到 (0..1) 关系。我将表拆分，因为我宁愿在一个表中有一个空行，也不愿在另一个表中有一堆空值。

基本上我让我的学生实体返回一个顾问实体，其中包含 5 个保存顾问名称的字符串。如果学生已经有顾问，一切正常，但如果我尝试向学生添加顾问或新学生，则更改不会持续存在。我基本上有一个 WPF 窗口，其中包含绑定到学生顾问类的学生数据和文本框数据。我认为插入的问题是因为如果记录不存在，advisor 的值为 null，所以我创建了一个方法，将学生顾问设置为新的顾问类，但仍然不会保留更改。

我找到了这篇文章[http://social.msdn.microsoft.com/Forums/en/adodotnetentityframework/thread/9b68f183-ba28-4a94-8c65-545611726268](http://social.msdn.microsoft.com/Forums/en/adodotnetentityframework/thread/9b68f183-ba28-4a94-8c65-545611726268)，但我想知道我该怎么做并且仍然保留我的数据绑定到顾问文本框。

# c# - 如何从 WCF 服务 [nettcpbinding] 返回流？

> ID：10607398
> 
> 赞同：2
> 
> 时间：2012-05-15T19:20:31.993
> 
> 标签：c#, wcf, stream

我有一个 WCF 服务，我希望客户端通过调用`client.GetStream();`应该返回一个从该服务接收图像`MemoryStream`

```
 public Stream GetStream()
    {
        Rectangle bounds = Screen.GetBounds(Point.Empty);
        using (Bitmap bmp = new Bitmap(bounds.Width, bounds.Height))
        {
            using (Graphics g = Graphics.FromImage(bmp))
            {
                g.CopyFromScreen(Point.Empty, Point.Empty, bounds.Size);
            }
            MemoryStream ms = new MemoryStream();
            bmp.Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg);
            img = Image.FromStream(ms);
            ms.Position = 0;
            OperationContext.Current.OutgoingMessageHeaders.Action = "image/jpeg";
            return ms;
        }
    } 
```

IScreenShot 界面：

```
[ServiceContract]
public interface IScreenShot
{
    [OperationContract]
    Stream GetStream();
} 
```

我得到的第一个例外是关于**MaxReceivedMessageSize**，然后我将其增加到 2MB。
现在我有一个新的例外是：

`Multiple headers with name 'Action' and namespace 'http://www.w3.org/2005/08/addressing' found.`

请注意，我遵循了此示例的步骤：

[来自 MSDN 的示例示例（将图像作为流返回）](http://msdn.microsoft.com/en-us/library/cc681221.aspx) 但我使用 NetTcpBinding 的区别。

代码有问题吗？或者它不适用于nettcpbinding？

这是客户：

```
public partial class ScreenImage : Form
{
    ScreenShotClient client;

    public ScreenImage(string baseAddress)
    {
        InitializeComponent();
        NetTcpBinding binding = new NetTcpBinding(SecurityMode.None);
        binding.MaxReceivedMessageSize = 1024 * 1024 * 2;
        client = new ScreenShotClient(binding, new EndpointAddress(baseAddress));
    }

    private void btnNew_Click(object sender, EventArgs e)
    {
        picBox.Image = Image.FromStream(client.GetStream());
    }
} 
```

# objective-c - 自动推送到其他视图控制器

> ID：10607410
> 
> 赞同：1
> 
> 时间：2012-05-15T19:21:18.180
> 
> 标签：objective-c, xcode, cocoa, ios5

如何自动将我的视图控制器推送到另一个视图控制器？我在 viewWillApear 中得到了这段代码，当我的 Tabledata 包含 1 个项目时，它需要将它直接推送到另一个视图控制器，但它不起作用

```
if ([DatainTable count] == 1) {

        count.text = [NSString stringWithFormat:@"xxx"];

        xViewController *scoreView = [[xViewController alloc]initWithNibName:@"xViewController" bundle:nil];
        [scoreView.count setText:count.text];

        [self.navigationController pushViewController:scoreView animated:YES];

} 
```

我尝试了很多其他的东西，但没有成功

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T20:32:31.667

不要将代码放入`viewWillAppear:`（第一个视图的实际推送尚未发生），您应该将其放入`viewDidAppear:`（当第一个视图完成推送时运行，您可以执行任何进一步的任务，例如推送另一个控制器)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:35:34.073

为什么要让用户坐着通过控制器互相推动？推送 scoreView 不是您现在推送它的位置，而是在它之前的控制器中，即推送您提供的代码的控制器的控制器。当然，只有在`[DatainTable count]`== 1 或任何您的情况下才这样做。

# java - Spring MVC，文件上传/下载应用程序中的资源映射失败

> ID：10607411
> 
> 赞同：0
> 
> 时间：2012-05-15T19:21:19.020
> 
> 标签：java, spring, spring-mvc

我有一个上传表单，我想要实现的是一个应用程序，可以通过我保存它们的目录中的静态链接访问上传的文件。

我在 servlet-context.xml 中定义了如下资源：

```
<mvc:resources mapping="/files/**" location="/files/" /> 
```

但是当我尝试使用以下代码保存文件时：

```
public void saveFile() throws IOException
{
    String path = File.separator + "files" + File.separator + filedata.getOriginalFilename();
    File dest = new File(path);

    filedata.transferTo(dest);
} 
```

我得到错误：

```
java.io.FileNotFoundException: \files\colour-palette.png (The system cannot find the path specified) 
```

文件只是我用于测试的随机文件。

这是我的 webapp 目录的外观：http: [//i.imgur.com/g5ihe.jpg](http://i.imgur.com/g5ihe.jpg)

谁能帮我？如果需要，我可以发布更多代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:26:34.883

不确定您的文件是否自动创建：

```
 public void saveFile() throws IOException
    {
        String path = File.separator + "files" + File.separator + filedata.getOriginalFilename();
        File dest = new File(path);
        dest.createNewFile();

        filedata.transferTo(dest);
    } 
```

# eclipse - Maven Eclipse (m2e) 和 Nexus - Add Dependency Search Results Limited

> ID：10607413
> 
> 赞同：1
> 
> 时间：2012-05-15T19:21:44.223
> 
> 标签：eclipse, nexus, m2e

使用 eclipse 安装的默认 maven 允许您右键单击您的项目并转到：Maven->Add Dependency，然后从这里搜索您想要的工件的中央索引。

但是，在设置本地 nexus 服务器（和镜像中心）并配置 maven 以使用它之后（http://www.sonatype.com/books/nexus-book/reference/maven-sect-single-group.html） ，我现在无法从搜索中看到所有工件。我只能看到一个子集（即已经使用/下载的子集）。

我已经确保我的 nexus 服务器设置为下载远程索引（我可以从 Nexus 的 Web 界面查看/搜索所有这些），但 Eclipse 似乎没有拾取索引。

请帮忙。:)

软件：eclipse indigo release 2\.
m2e - 1.0.200.20111228-1245。
联系 2.02

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-31T18:33:52.287

所以......显然耐心是这个神奇问题的答案。已经有几个星期了，现在它神奇地在我的几台开发机器上运行。

我最好的猜测是，Eclipse 可能并不总是在您每次重新启动它时刷新它的索引，而且它只是没有从我们的 nexus 服务器中提取最新的索引。（缓存超时？刷新超时？）

对此行为/类似经历的任何确认都可能有助于关闭此线程。:)

# java - jsp是如何工作的？

> ID：10607415
> 
> 赞同：24
> 
> 时间：2012-05-15T19:21:45.893
> 
> 标签：java, jsp

我想知道 JSP 有没有被编译过？我问的原因是因为每当我在 Web 服务器上部署我的 Java EE 应用程序时，我只能在 WEB-INF 文件夹中看到那些 servlet 和 beans 类文件，因为它们是编译的，而不是那个 JSP，所以它是如何工作的，以及正常请求/响应周期的逻辑流程和大图是什么。

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-05-15T19:33:17.140

基本上：

*   `.jsp`在您的 servlet 容器中，JSP servlet 映射到以（通常）结尾的任何 URL

*   当请求其中一个`.jsp`URL 时，该请求将转到 JSP servlet。然后，这个 servlet 检查 JSP 是否已经编译。

*   如果 JSP 尚未编译，则 JSP servlet 会将 JSP 转换为一些实现`Servlet`接口的 Java 源代码。然后它将这个 Java 源代码编译成一个`.class`文件。该`.class`文件通常位于应用程序的 servlet 容器的工作目录中的某个位置。

*   一旦 JSP servlet 从 JSP 源代码编译了 servlet 类，它就将请求转发给这个 servlet 类。

问题是，除非您专门预编译您的 JSP，否则所有这些都发生在运行时，并且隐藏在 servlet 容器的工作目录中，因此它是“不可见的”。还要记住，这是“概念上”发生的事情，在这个工作流程中可以进行一些优化。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-15T19:26:50.667

是的，它们是编译的！

较旧的编译器甚至会生成 java 和 class 文件。

看起来使用较新的编译器（至少从 Sun JDK 6 update 30 开始），它们可以在内存中生成所有字节码，因此您在应用程序`work`或`temp`目录中看不到任何痕迹。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-05-15T19:27:53.160

JSP 编译为 Servlet。他们只有一个特殊的编译器，通常嵌入在容器中。

来自优秀的 ole 维基百科：

> 在架构上，JSP 可以被视为 Java servlet 的高级抽象。JSP 在运行时被翻译成 servlet；每个 JSP 的 servlet 都被缓存并重新使用，直到原始 JSP 被修改。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-12-31T16:41:01.840

在运行时，JSP 代码由 JSP 编译器解释，它解析出 JSP 代码中的所有特殊功能并将它们转换为 Java 代码。从每个 JSP 创建的 Java 类实现`Servlet`. 然后，Java 代码会经历与通常情况相同的循环。仍然在运行时，它被编译成字节码，然后编译成机器码。最后，JSP-turned-Servlet 像任何其他 Servlet 一样响应请求。

如果您查看 *_jsp.java 文件，您应该会发现一个扩展的类`org.apache.jasper.runtime.HttpJspBase`。这个抽象类扩展了`HttpServlet`. `HttpJspBase`提供了一些基础功能，Tomcat 编译的所有 JSP 都将使用这些功能，并且当您的 JSP 执行时，最终会执行该 Servlet 上的服务方法，该方法最终会执行 _jspService 方法。如果您检查 _jspService 方法，您会发现一系列方法调用将您的 HTML 写入输出流。这段代码对您来说应该很熟悉，因为它与您用这个 JSP 替换的 Java 代码没有什么不同。

当然，JSP Servlet 类在每个 Web 容器上看起来都不一样。例如，org.apache.jasper 类是 Tomcat 特定的类。您的 JSP 在您运行它的每个不同 Web 容器上的编译方式都不同。重要的一点是 JSP 的行为和语法有一个标准规范，只要您使用的 Web 容器符合规范，您的 JSP 应该在所有容器上运行相同，即使它们的 Java 代码翻译成看起来完全不同。

摘自*Nicholas S Williams*的*Professional Java for Web Applications*

# android - ListView 文字颜色变化？

> ID：10607416
> 
> 赞同：0
> 
> 时间：2012-05-15T19:21:46.083
> 
> 标签：android, android-intent, android-listview, android-manifest

我知道你们中的许多人会说只是搜索谷歌，但如果这很容易，我不会问:)。我有一个`ListView`并且动态地添加另一个列表等。

现在我想用 XML 更改文本颜色。

这是我的 XML：

```
<ListView
        android:id="@+id/listView1"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:smoothScrollbar="true"
        android:divider="@drawable/divider"
        android:dividerHeight="1dp"
        android:cacheColorHint="#000000"
        android:textColor="#D0640D" 
        android:fadeScrollbars="true">
</ListView> 
```

有人可以帮忙吗？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:27:32.677

您想要更改`textColor`列表项布局的属性，而不是列表本身。如果您使用的是预定义的项目布局之一，那么只需将其复制到您的项目中并进行修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:27:36.657

你想改变什么文字的颜色？如果是列表项，则需要为列表中的每个项设置正在使用的布局的文本颜色。

# iphone - 为什么不需要声明viewDidLoad、viewDidUnload等方法？

> ID：10607419
> 
> 赞同：0
> 
> 时间：2012-05-15T19:22:09.370
> 
> 标签：iphone, objective-c, xcode

我对 xcode 和目标 c 非常陌生。我意识到，如果我们希望它对其他类公开，我们只在 .h 文件中声明方法。我还注意到我们可以使用 .m 文件中的类扩展来使方法“私有”。但是为什么有些方法没有在任何地方声明（例如viewDidLoad等）？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T19:29:13.500

它们是超类的方法 - `UIViewController`. 它们在该类的接口中声明。当你从那个类继承时，你继承了它的所有方法声明和实现。

# git - 理解 git：将分支连接到远程存储库

> ID：10607422
> 
> 赞同：5
> 
> 时间：2012-05-15T19:22:23.943
> 
> 标签：git

我在 github 上有一个存储库，比如 testrepo。现在我想建立一个本地存储库`repo`，它有一个分支`origin-master`，我希望能够从存储库中编辑内容。

```
repo/origin-master  <-------->  origin/master 
```

克隆工作正常：

```
mkdir repo && cd repo && git init 
# not necessary of course:
echo "master" > master && git add master && git ci -m "master"
git remote add origin git@github.com:<username>/testrepo.git
git fetch origin
git branch --set-upstream origin-master origin/master 
git checkout origin-master
# create a new file:
echo "for origin-master" > orig-master && git add orig-master && git ci -m "orig-master" 
```

但

```
git push origin 
To git@github.com:<username>/testrepo.git
 ! [rejected]        master -> master (non-fast-forward)
error: failed to push some refs to 'git@github.com:<username>/testrepo.git'
To prevent you from losing history, non-fast-forward updates were rejected
Merge the remote changes (e.g. 'git pull') before pushing again.  See the
'Note about fast-forwards' section of 'git push --help' for details. 
```

我如何告诉 git，如果我想推送到 origin，我想将本地分支推`origin-master`送到`origin/master`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-18T08:16:50.300

有关推送到非裸（即带有工作副本）回购的好建议，请参阅[这篇文章。](https://stackoverflow.com/a/1764793/11343)基本上这里发生的事情是，当您以这种方式推送时，远程仓库不会更新它的工作副本（真实文件），只会更新它的历史记录。然后你需要`git reset --hard`在它上面刷新文件，但这很危险，因为你会丢失未提交的修改。

作为一般建议，我会说在处理多个非裸存储库时更喜欢拉而不是推送：[仅推送到裸存储库](http://gitready.com/advanced/2009/02/01/push-to-only-bare-repositories.html)！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-19T18:10:22.717

我无法理解您要设置什么样的工作流程，但这有帮助吗？

“[如何让现有的 git 分支跟踪远程分支？](https://stackoverflow.com/questions/520650/how-do-you-make-an-existing-git-branch-track-a-remote-branch) ”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-22T20:19:59.823

将默认推送行为设置为上游：

```
$ git config push.default upstream
$ git push origin 
```

`git push origin`与 相同`git push origin :`，默认情况下会推送所有“匹配”的分支。您的 origin-master 分支不匹配，因此它会尝试采用匹配 ( ) 的分支*并将*其`master`推送到 origin。

或者，您可以`push`基于每个远程指定 refspec：

```
$ git config --add remote.origin.push origin-master:master
$ git push origin 
```

另请参阅[git-push 示例](http://schacon.github.com/git/git-push#_examples)和[git-config](http://schacon.github.com/git/git-config)。

# ios - Shazam App 喜欢加载屏幕

> ID：10607427
> 
> 赞同：7
> 
> 时间：2012-05-15T19:22:46.213
> 
> 标签：ios, animation

如何在 iOS 中创建如下图所示的动画加载效果？有人请给我一个想法或指出我的任何例子。
![在此处输入图像描述](../Images/eb92fbbd7dd1ebf666647a6108bf64e3.png)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-05-16T10:58:44.070

我非常清楚这是如何工作的（我为 Shazam 工作并编写了这个动画）所以......

虽然我怀疑您是否想要一个具有 Shazam 版本所有细节的动画，但我将解释基本思想。

首先，动画由五个主要部分组成。

1.  形成圆圈的 CAShapeLayer
2.  一个 CABasicAnimation 让我们的动画保持及时
3.  一个计时器，告诉我们的形状层重绘
4.  一个遮罩层，它将旋转并遮盖我们的形状层
5.  位于形状层顶部的徽标（不一定是 shazam）

所以首先创建 CAShapeLayer

```
CAShapeLayer *newPieLayer = [CAShapeLayer layer];     

[newPieLayer setFillColor:[UIColor blackColor].CGColor];

[[self layer] addSublayer:newPieLayer];

return newPieLayer; 
```

创建蒙版图层并将其添加到圆形图层，您的蒙版图像应该是一个从零 alpha 扫描到 100% alpha 的圆圈

```
self.maskLayer = [CALayer layer];
[self.maskLayer setBounds:self.bounds];
[self.maskLayer setPosition:CGPointMake(self.bounds.size.width/ 2, self.bounds.size.height/2)];
[self.maskLayer setContents:(id)[UIImage imageNamed:kMaskImageName].CGImage];

newPieLayer.mask = self.maskLayer; 
```

创建使我们保持同步的动画并将其添加到遮罩层

```
 CABasicAnimation *anim = [CABasicAnimation animationWithKeyPath:@"transform.rotation.z"];
    anim.fromValue = [NSNumber numberWithFloat:startRadians];
    anim.toValue = [NSNumber numberWithFloat:M_PI * 2];
    anim.duration = timeInterval;
    anim.delegate = delegate;
    anim.TimingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionLinear];

    [maskLayer addAnimation:anim forKey:kMaskRotationAnimationKey]; 
```

创建并启动我们想要从中进行绘图的计时器

```
[NSTimer scheduledTimerWithTimeInterval:kAnimationFireRate target:self selector:@selector(updateTimerFired:) userInfo:nil repeats:YES]; 
```

在计时器回调中设置图层的路径

```
float rotation = [[[maskLayer presentationLayer] valueForKeyPath:@"transform.rotation.z"] floatValue];

decibelPath = CGPathCreateArc(animationCenter, inRadius, endAngle, rotation);

[self.layerOne setPath:decibelPath]; 
```

现在你应该有一些看起来非常相似的东西

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:32:47.650

iOS 中没有用于动画加载屏幕的功能。您所做的是在您的应用程序首次启动时创建一个视图，该视图最初显示加载图像。然后，您为该视图设置动画。

请不要这样做，除非你真的在加载一些东西。iOS 应用程序旨在尽快启动。加载屏幕旨在近似于您看到的第一个屏幕，以尽可能快地将用户定向到界面。它**不是**为了品牌目的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T13:15:51.020

嗨，为 monotouch 实现这个逻辑，你可以使用逻辑希望，这样你就可以得到你的解决方案

```
private UIImageView splashScreen;
public override void ViewDidLoad () {
#region Splash Screen
// get the Height & Width of device Screen
float mainSrcWidth = this.View.Bounds.Width;
float mainSrcHeight = this.View.Bounds.Height;
splashScreen = new UIImageView (UIImage.FromFile ("Images/loading.gif"));
splashScreen.Frame = new RectangleF (0, 0, mainSrcWidth, mainSrcHeight);    
//Start the thread;
ThreadPool.QueueUserWorkItem (delegate {
Load ();
}
        );
#endregion
#region Load() splashscreen
private void Load ()
{
        //Sleep for 5 seconds to simulate a long load.
Thread.Sleep (new TimeSpan (0, 0, 0, 5));
        this.BeginInvokeOnMainThread (delegate {
splashScreen.RemoveFromSuperview ();
            splashScreen = null;
            });
    }
    #endregion 
```

# parsing - DOM 树解析和语法树解析的区别？

> ID：10607429
> 
> 赞同：3
> 
> 时间：2012-05-15T19:22:48.950
> 
> 标签：parsing, dom, schema, context-free-grammar, concrete-syntax-tree

解析 HTML 或 XML 文件后，我们可以得到 DOM 树。

在解析 C、C++ 或 JavaScript 之后，我们可以得到语法树。

请注意，语法树是基于指定有效 C/C++/JS 程序的上下文无关语法构建的。

但似乎 DOM 树只是由 HTML/XML 文件指定的纯层次结构。真的吗？这就是解析后进行Schema Validation的原因吗？这两种解析树的根本区别是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-24T20:20:00.447

感谢您对 Ira Baxter 和 Guy Coder 的关注。

我重新搜索了一会儿，比较了这两种情况。我的印象是这样的：

XML的“*解析*”可以是“*验证解析*”或“*非验证解析*”。对于后一种，解析器不会根据*文档类型定义*(DTD) 文件检查其语法。此解析器仅生成 XML 文件中元素的层次结构。所以它比“*验证解析*”更轻。

C/C++/Java的“*解析*”基于其上下文无关文法生成语法树。因此，非正式地，它更像是“*验证解析*”。

PS：我不是专家，如果您发现我的理解不正确，欢迎提出任何意见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-24T22:49:32.683

与任何其他语言一样，XML 由语法描述。XML 的语法相当简单（开始标签、结束标签、正确的嵌套）。所以语法树看起来也很简单（只是元素的层次结构）。XML 模式是描述 XML 文件内容的*另一种语法。*

所以基本上是两个解析器被一个接一个地调用。第一个验证所有开始标签都有一个结束标签并且嵌套是正确的。

第二个解析器验证 XML 文件的内容是根据模式（语法）构造的。就像名为“B”的元素只能包含在名为“A”的元素中。

这不应与解析 C 等编程语言相比，因为您无法更改编程语言的语法。If 语句只能出现在函数体内，不能出现在函数体之外，而且您无法更改它。但是，在 XML 中，您可以指定“B”元素只能出现在“A”元素中，或者“A”元素只能出现在“B”元素中。所有这些都通过指定 XML 文件内容的语法来实现以模式的形式。

# python - ImportError：没有名为 array_import 的模块

> ID：10607430
> 
> 赞同：-6
> 
> 时间：2012-05-15T19:22:56.140
> 
> 标签：python, scipy

有谁知道如何解决这个错误？

异常类型：ImportError 异常值：没有名为 array_import 的模块

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:29:18.187

`Note: It's Stack Overflow etiquette to post the code that caused the problem.`

您的问题很可能是由于将“太远”导入一组模块（一直到实际成员而不是模块或子模块）引起的：

```
import module_name.sub_module.array_import 
```

而不是任何一个

1.  `from module_name.sub_module import array_import`
2.  `import module_name.sub_module`

但是没有代码就无法分辨。

**编辑**

@Dave，很重要的一点是，您也可能完全错过了该模块。尝试不同的版本或更好的版本，但使用您尝试使用的任何库替换旧版本。

# c++ - 共享指针的循环依赖

> ID：10607439
> 
> 赞同：3
> 
> 时间：2012-05-15T19:23:43.160
> 
> 标签：c++, shared-ptr, circular-dependency

我在我的程序中遇到了循环依赖，并通过使用指针和前向声明来解决它。`dn.hpp`为此，我制作了一个文件。一切都很好，直到我转向共享指针而不是通用指针。我在`dn.hpp`. 一切都适用于通用指针（注释掉），而不是共享。

它返回一个错误：字段 'parentGraph' 的类型不完整 node.h 第 21 行

（我正在使用 mingw 和 boost 1.47）

请帮我解决这个问题。

这是我的代码的简化版本：

**dn.hpp**

```
// forward declarations
#include <map>
#include <list>
#include <boost/shared_ptr.hpp>

class graph;
typedef boost::weak_ptr<graph> graph_wp;
typedef boost::shared_ptr<graph> graph_sp;
//typedef graph* graph_wp;
//typedef graph* graph_sp;

class node;
typedef boost::weak_ptr<node> node_wp;
typedef boost::shared_ptr<node> node_sp;
//typedef node* node_wp;
//typedef node* node_sp;
typedef std::list<node_sp> nodes_t;

class edge;
typedef boost::weak_ptr<edge> edge_wp;
typedef boost::shared_ptr<edge> edge_sp;
//typedef edge* edge_wp;
//typedef edge* edge_sp;
typedef std::list<edge_sp> edges_t;
typedef std::list<edge_wp> edgeList_t; 
```

**图.h**

```
#ifndef GRAPH_H_
#define GRAPH_H_

#include "node.h"
#include "edge.h"

#include "dn.hpp"

class graph
{
public:
    node* createNode();
protected:
    nodes_t nodes;
    edges_t edges;
};
#endif /*GRAPH_H_ */ 
```

**节点.h**

```
#ifndef NODE_H_
#define NODE_H_

#include "graph.h"
#include "edge.h"

#include "dn.hpp"

class node
{
public:
    node();
    node(graph_wp n);
    node(const graph_wp& net);
    virtual ~node();

    edge_wp createChild();
protected:
    graph_wp parentGraph;
    edgeList_t edges;
};
#endif /* NODE_H_ */ 
```

**边缘.h**

```
#ifndef EDGE_H_
#define EDGE_H_

#include "node.h"

#include "dn.hpp"

class edge
{
public:
    edge(node_wp src,node_wp tgt);
    virtual ~edge();
private:
    node_sp source;
    node_sp target;
};
#endif /* EDGE_H_ */ 
```

**主文件**

```
#include "graph.h"
int main() {
    graph n;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:36:29.477

当我用 VisualStudio 编译你的代码时，我得到

```
error C2079: 'node::parentGraph' uses undefined class 'boost::weak_ptr<Y>'
with
[
    Y=graph
] 
```

添加

```
#include <boost/weak_ptr.hpp> 
```

修复了这个

# facebook-graph-api - 聚合中“分组依据”的工作示例？

> ID：10607440
> 
> 赞同：0
> 
> 时间：2012-05-15T19:23:49.740
> 
> 标签：facebook-graph-api, facebook-opengraph, aggregation

我无法弄清楚 **应用程序 - 打开图表 - 聚合 - 高级 - 分组方式** 命令。

我想显示添加到打开图表中的最受欢迎的链接，按对象属性分组。但是，它似乎只向我展示了我可以分组的一件事：对象类型（不是对象类型的属性）。

有没有人让聚合分组工作？如果是这样，您能否通过“这些按顺序评估。第一个匹配的是分组键”来解释它们的含义。?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T19:24:39.517

You can only group by things with URLs. That is so that Facebook has somewhere to link to. so if you want o show the most popular links, you should make a "Link" object type and put that as a property of your other object. Then it should show up in the group by selector.

# android - Android 浏览器 HTML 选择事件 onclick/onblur 不起作用

> ID：10607443
> 
> 赞同：0
> 
> 时间：2012-05-15T19:24:08.667
> 
> 标签：android, mobile, android-browser

通常当我找不到关于某个问题的信息时，它是因为一些愚蠢的事情！我目前有一部 Android 手机，并且选择下拉菜单有一个 onblur 事件。这在主流台式机上完美运行，但是当我在手机上使用它时，浏览器似乎忽略了该事件。是否有其他方法可以让这些事件正确触发？

我一直在使用的一些测试代码：

[http://jsfiddle.net/KJUkX/](http://jsfiddle.net/KJUkX/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T12:27:12.483

我最终将选择绑定到 onblur 和 on change 事件。即使选择了第一个索引，也会触发 onchange。虽然现在使用桌面浏览器时它会调用该函数两次。它的功能足够小，我并不担心。

# continuous-integration - 如何在 Jenkins/Hudson 中定义作业以并行运行？

> ID：10607445
> 
> 赞同：6
> 
> 时间：2012-05-15T19:24:16.483
> 
> 标签：continuous-integration, hudson, jenkins, parallel-processing, jenkins-plugins

**问题：**给定 Jenkins/Hudson 中的许多工作，每个工作都分配了一个我们可以称之为级别的数字。这个数字的范围从 1 到 n，并且多个作业可以具有相同的级别。现在，我想定义要运行的那些（否则独立的）作业，以便级别 1 必须在级别 2 之前构建，**并且**我希望 Jenkins/Hudson 在同一级别并行启动多个作业，如果作业所在的从属执行器被定义是免费的。

这个级别数是什么无关紧要，它只是为了解释问题而定义的。

**重要提示：**我希望能够自动生成这些作业，因为我知道哪些作业依赖于哪些作业，哪些可以并行运行，所以如果解决方案是 config.xml 中的一些配置，很高兴听到这个消息，这样我就可以编写脚本自动生成这些配置文件。

![X 级的作业可以而且应该尽可能多地并行运行。](../Images/b27b15337e8ffcea1ef67db5012e55e4.png)

谢谢你的时间。

**编辑：**还有一个我想知道的，以防有一些优雅的解决方案：假设作业 X 是由 Build Flow Plugin 触发的，并且它失败了。如果我希望 Build Flow Plugin 再次触发相同的作业（在我修复它之后），并正常继续通过插件定义的作业，有什么办法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-15T20:23:18.990

Jenkins 有一个相对较新的插件，称为 Build Flow 插件。该插件提供了一种新的 Job 类型，您可以在其中使用 DSL 定义此类作业依赖结构。我认为，您也可以自动执行此操作。该插件非常强大，您可以[在此处](https://wiki.jenkins-ci.org/display/JENKINS/Build+Flow+Plugin)找到更多信息。我不知道，这个插件是否也可以在 Hudson 中工作，因为它需要 Jenkins 1.424 作为最低版本，并且最新的 Hudson 版本也更改了它的配置 xml。

# android - 安卓内存泄漏

> ID：10607447
> 
> 赞同：1
> 
> 时间：2012-05-15T19:24:25.083
> 
> 标签：android, memory

[链接](http://android-developers.blogspot.de/2009/01/avoiding-memory-leaks.html)。

现在我的项目中有一个上下文泄漏，并且在链接上它几乎解释了可能导致它的所有内容。

老实说，我试图尽可能多地删除具有上下文变量的内容，但我的网格视图和基本适配器有问题，我真的需要帮助，我一直在努力解决这个问题。有时它让我觉得它收集了垃圾，然后在其他课程中表现得像忍者。

我的问题：“你们建议我应该改变什么？” “我应该注意什么？”

这是我所做的： 1\. 为我的可绘制图像创建一个哈希映射 2\. 为 gridview 创建一个基本适配器 3\. 我的 loadCover 类代码

私有静态地图 ImageLocator = Collections.synchronizedMap(new WeakHashMap());

```
private class BaseA extends BaseAdapter{
    private LayoutInflater inflater;

    public BaseA(Context context){
        inflater = (LayoutInflater)context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        // TODO Auto-generated method stub
        View row = convertView;
        viewHolder vh = new viewHolder();

        row = inflater.inflate(R.layout.book_row_view, null);       
        vh.authors = (TextView)row.findViewById(R.id.book_Author);
        vh.image = (ImageView)row.findViewById(R.id.icon);
        vh.date = (TextView)row.findViewById(R.id.Date);
        vh.Titles = (TextView)row.findViewById(R.id.Book_Title);
        vh.fileName = (TextView)row.findViewById(R.id.FileLocation);

        try{
            String temp = File_Name.get(position);
            vh.fileName.setText(temp);
        }catch (Exception e) {
            // TODO: handle exception
            e.printStackTrace();
        }

        Book_Information bi;
        bi = new Book_Information();
        bi = dbh.getData(File_Name.get(position));
        //Gets the right book information for all the items
        new LoadCover(vh.image, bi).run();
        if(bi.getBook_Author() != null || bi.getBook_Date() !=null || bi.getBook_Description() != null ||
                bi.getBook_Title() != null){

            vh.authors.setText(bi.getBook_Author());
            vh.date.setText(bi.getBook_Date());
            vh.Titles.setText(bi.getBook_Title());
        }                   
        return row;
    }

    public int getCount() {
        // TODO Auto-generated method stub
        return File_Name.size();
    }

    public Object getItem(int position) {
        // TODO Auto-generated method stub
        return position;
    }

    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return position;
    }

}

private class LoadCover implements Runnable{
    ImageView image; Book_Information bi;

    public LoadCover(ImageView image, Book_Information bi){
        this.image = image;
        this.bi = bi;
    }

    public void run() {
        // TODO Auto-generated method stub
        Drawable draw = ImageLocator.get(bi.getBook_File_Name());

        if(draw!=null){
            image.setImageDrawable(draw);
        }else{
            new UpdateImages(image, bi).run();
        }
        draw = null;
    }

}

private class UpdateImages implements Runnable{
    ImageView image;
    Book_Information book_info;

    public UpdateImages(ImageView imageView,  Book_Information bookInfo){
        this.image = imageView;
        this.book_info = bookInfo;
    }
    public void run(){
        try{
            Bitmap bm = getBitmap(book_info);
            FastBitmapDrawable fbd = new FastBitmapDrawable(bm);
            image.setImageDrawable(fbd);
            ImageLocator.put(book_info.getBook_File_Name(), fbd);
            bm = null;
        }catch (OutOfMemoryError e) {
            // TODO: handle exception
            ImageLocator.clear();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T21:45:17.280

我查看了您的代码并将其重构为更易于管理的方式，它指出了一些事情。

您在 getView 方法中执行某种类型的图像加载，这需要很长时间，应该在 ASyncTask 或具有某种类型回调的处理程序中完成。

然后，您将这些位图存储在一个静态映射中，该映射将在您的应用程序的整个生命周期中保留在内存中，这是 baaad，并在您创建位图时保留对您的上下文的引用。我可以看到您在加载它们时将其用作一种图像缓存，如果这导致您出现内存不足错误，也许可以考虑另一种方式。

这是您的代码，已重构：

```
/**
 * @author paul.blundell
 *         May 15, 2012
 */
public class MyAct extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        LayoutInflater inflater = (LayoutInflater) getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        List<String> fileNames = new ArrayList<String>(); // Whatever filenames you get
        List<BookInformation> list = dbh.getData(fileNames); // However you get your data from the database (usually in a Service)

        BaseA base = new BaseA(inflater, list);

        // Do whatever with base
    }
 } 
```

适配器类：

```
 public class BaseA extends BaseAdapter {

        // Having a static map means it lives the entire life of your application, your drawables should take a context
        // when they are being created therefore they have a reference to your Activity, and this is not being destroyed
        public static Map<String, Drawable> imageLocator = new WeakHashMap<String, Drawable>();

        private LayoutInflater inflater;
        private List<BookInformation> books;

        public BaseA(LayoutInflater inflater, List<BookInformation> books) {
            this.inflater = inflater;
            this.books = books;
        }

        public View getView(int position, View convertView, ViewGroup parent) {
            View rowView = convertView;
            ViewHolder vh = null;

            if(rowView == null){
                // Get new instance of our row view
                rowView = inflateView();
                // Hold the view in an object so it doesnt need to be re-fetched
                vh = new ViewHolder();

                vh.authors  = (TextView)  rowView.findViewById(R.id.book_author);
                vh.image    = (ImageView) rowView.findViewById(R.id.book_icon);
                vh.date     = (TextView)  rowView.findViewById(R.id.book_date);
                vh.titles   = (TextView)  rowView.findViewById(R.id.book_title);
                vh.fileName = (TextView)  rowView.findViewById(R.id.file_location);

                // Cache the view so it can be re-accessed later
                rowView.setTag(vh);
            } else {
                vh = (ViewHolder) rowView.getTag();
            }

            BookInformation book = books.get(position);
            vh.fileName.setText(book.getFileName());

            // Gets the right book information for all the items
            loadCover(vh.image, book.getFileName());

            if (book.getAuthor() != null){
                vh.authors.setText(book.getAuthor());
            }
            if(book.getDate() != null){
                vh.date.setText(book.getDate());
            }
            if(book.getTitle() != null){
                vh.titles.setText(book.getTitle());
            }

            return rowView;
        }

        private View inflateView() {
            return inflater.inflate(R.layout.view_book_row, null);
        }

        public int getCount() {
            return books.size();
        }

        public Object getItem(int position) {
            return position;
        }

        public long getItemId(int position) {
            return position;
        }

        private void loadCover(ImageView image, String filename) {
            Drawable draw = imageLocator.get(filename);

            if (draw == null) {
                draw = updateImage(filename);
            }
            imageLocator.put(filename, draw); // This is your problem keeping a reference to these drawables in a static map
            image.setImageDrawable(draw);
        }

        private Drawable updateImage(String filename) {
            Bitmap bm = getBitmap(filename);
            Drawable drawable = new BitmapDrawable(bm);
            return drawable;
        }

        private Bitmap getBitmap(String filename) {
            return null; // I don't know how you get a bitmap but you shouldn't do this in getView() , use a callback
        }

       private static class ViewHolder {
            public TextView fileName;
            public TextView titles;
            public TextView date;
            public ImageView image;
            public TextView authors;
        }
    } 
```

单独的域类 bookInformation：

```
public class BookInformation {

        public String getFileName() {
            return "filename";
        }

        public String getTitle() {
            return "title";
        }

        public String getDate() {
            return "date";
        }

        public String getAuthor() {
            return "author";
        }
    } 
```

# spring - 接受参数的构造函数 - 定义为普通对象或spring bean？

> ID：10607450
> 
> 赞同：7
> 
> 时间：2012-05-15T19:24:41.210
> 
> 标签：spring

假设我有一个带有一个构造函数的类，该构造函数接受一个或多个参数。我们还假设这些参数是来自用户的某种输入。即参数不能在编译时或配置时知道，只能在运行时知道。我应该将我的类定义为原型 spring bean 还是应该用“new”创建它。

如果我应该将它定义为一个 bean，我该如何传递参数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T19:38:00.993

这在 Spring 中是有问题的。如果您的类不依赖于其他 bean，只需使用`new`. 如果您有一个依赖于其他 Spring bean 的类，但仍想传递一些运行时参数，则当前 Spring 不支持它。

但是，请查看[SPR-7431](https://jira.springsource.org/browse/SPR-7431)和[我关于将自定义参数传递给`<lookup-methods/>`](http://nurkiewicz.blogspot.com/2010/08/creating-prototype-spring-beans-on.html). 如果一切顺利，这个特性应该是 Spring 3.2 的一部分，它应该符合你的要求。它基本上允许创建`prototype`-scoped beans，同时仍然传递一些构造函数参数。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-15T19:28:11.150

除非您的类还依赖于上下文中的其他 bean，否则不，您不应该将其设为 bean - 没有意义。只需使用`new`.

使它成为 bean 的唯一令人信服的理由是它是否*确实*依赖于其他 bean，在这种情况下，原型范围的 bean 是合理的。但是，如果该类在其构造函数中需要这些运行时值，那么您不能真正做到这一点，除非更改类以通过某种方法而不是使用构造函数来注入它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-05T19:06:49.623

使用查找方法将参数传递给构造函数的弹簧功能在 Spring 3.2.11 中不起作用，但在 Spring 版本 4.1.1 中起作用

这是我用来检查它的代码：

这是接口工厂...

```
package prueba;

public interface Factory {

    Person createPersonWithDependencies(String name);
} 
```

这是我们要由spring管理的bean，注入helloWorldService...

```
package prueba;

public class Person {

    private HelloWorldService helloWorldService;

    public final void setHelloWorldService(HelloWorldService extraService) {
        this.helloWorldService = extraService;
    }

    public Person() {
        super();
    }

    public Person(String name) {
        super();
        this.name = name;
    }

    private String name;

    public final String sayHello() {
        return helloWorldService.getGreeting()+" I am "+name;
    }   
} 
```

这是著名的 helloworld 服务：

```
package prueba;

public class HelloWorldService {

    public String getGreeting(){
        return "hello world";
    }
} 
```

这是一个使用工厂的示例服务

```
package prueba;

public class Service {

    private Factory factory;

    public final void setFactory(Factory factory) {
        this.factory = factory;
    }

    public void doSomeThing(){
        Person bean1= factory.createPersonWithDependencies("Jhon");

        System.out.println(bean1.sayHello());

        Person bean2= factory.createPersonWithDependencies("Maria");

        System.out.println(bean2.sayHello());
        System.out.println(bean1.sayHello());

    }
} 
```

这是测试所有人的主要课程

```
package prueba;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class TestLookupMethodWithArguments {
     /**
     * Main method.
     */
    public static void main(String[] args) {

        ApplicationContext applicationContext = new ClassPathXmlApplicationContext("/applicationContext.xml");

        Service service=applicationContext.getBean("service",Service.class);

        service.doSomeThing();
    }

} 
```

最后是spring配置文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="helloWorldService" class="prueba.HelloWorldService" />

    <bean id="Person" class="prueba.Person" scope="prototype">
        <property name="helloWorldService" ref="helloWorldService" />
    </bean>

    <bean id="myFactory" class="prueba.Factory">
        <lookup-method name="createPersonWithDependencies" bean="Person" />
    </bean>

    <bean id="service" class="prueba.Service">
        <property name="factory" ref="myFactory" />
    </bean>
</beans> 
```

使用弹簧 4.1.1 的输出

```
hello world I am Jhon
hello world I am Maria
hello world I am Jhon 
```

# jquery-ui - jquery列表框插件

> ID：10607451
> 
> 赞同：0
> 
> 时间：2012-05-15T19:24:41.650
> 
> 标签：jquery-ui, jquery, jquery-plugins, user-interface

我正在寻找一个用于执行少量操作的 java jquery 列表框插件，我在谷歌中搜索但找不到任何合适的插件。

我有一个要求，比如我应该有两个列表框，我可以在其中将左列表框的值随机排列到右列表框，反之亦然。左侧列表框中列出的项目应随时排序。应该能够拖放右侧列表框中的项目，以单独更改右侧列表框中项目的位置。

任何人都可以为此建议一个 jquery 插件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T19:42:16.970

Looks like this gets you pretty close, maybe you can configure it further?

[http://www.meadmiracle.com/dlb/DLBPlugin.aspx](http://www.meadmiracle.com/dlb/DLBPlugin.aspx)

# python - 在 VPS 上部署 Flask

> ID：10607454
> 
> 赞同：0
> 
> 时间：2012-05-15T19:24:53.240
> 
> 标签：python, deployment, frameworks, mod-wsgi, flask

我目前在 Linode VPS 上有一个 LAMP 堆栈。

我的服务器是用 apache2 设置的，然后在 /etc/apache2/sites-available 我有一个站点虚拟主机列表。

例子：

```
<VirtualHost *:80>
     ServerAdmin user@gmail.com
     ServerName domain.com
     ServerAlias www.domain.com
     DocumentRoot /folder/www/domain.com/public_html/
     ErrorLog /folder/www/domain.com/logs/error.log
     CustomLog /folderx/www/domain.com/logs/access.log combined
</VirtualHost> 
```

我主要是一名 PHP 开发人员，但我正在尝试使用 Flask 进入 Python。

按照[这里](http://flask.pocoo.org/docs/deploying/mod_wsgi/)的说明，我安装了 mod_wsgi。但是，我对如何做剩下的事情有点困惑。创建 wsgi 文件，创建一个新的 Flask 应用程序等。

有没有好的教程，或者有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T03:10:19.333

怎么样：

[http://flask.pocoo.org/docs/quickstart/#quickstart](http://flask.pocoo.org/docs/quickstart/#quickstart)

[http://flask.pocoo.org/docs/tutorial/#tutorial](http://flask.pocoo.org/docs/tutorial/#tutorial)

[http://flask.pocoo.org/docs/deploying/mod_wsgi/#creating-a-wsgi-file](http://flask.pocoo.org/docs/deploying/mod_wsgi/#creating-a-wsgi-file)

如果这些东西对你来说真的很新，你最初不应该担心 mod_wsgi，只需使用 Flask 的内置开发服务器并在你自己的本地机器上使用它。这不是 PHP。您不需要安装 Apache 就可以做一些事情。

# c# - 从文件结构构建菜单

> ID：10607464
> 
> 赞同：0
> 
> 时间：2012-05-15T19:25:47.217
> 
> 标签：c#, asp.net, rad-controls

我正在根据服务器上的文件结构构建一个菜单。所以，这是文件结构：

```
Videos
    Reports 
        Customers
    SetUp
        Customers
        Products 
```

所以，我写了这段代码

```
System.IO.DirectoryInfo RootDir = new System.IO.DirectoryInfo(Server.MapPath("~/Videos"));
RadMenuItem RootNode = OutputDirectory(RootDir, null);
videoMenu.Items.Add(RootNode); 
```

在输出目录中，我将遍历它们并返回它们。所以，现在我想要如下所示的输出：

```
Reports 
    Customers
SetUp
    Customers
    Products 
```

我不希望视频成为父级。相反，希望报告和设置位于顶部。你能帮我么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:35:08.467

听起来您需要向 RadMenu（报告、设置等）添加多个父级节点，而不是仅添加单个 RootNode。无论你的`OutputDirectory`方法在做什么，让它返回“视频”的子节点作为节点的 IEnumerable，并添加这些节点而不是 RootNode。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:44:41.237

您可能需要一个递归函数。像这样的东西：

```
void Main()
{   
    var dirs = new DirectoryInfo(Server.MapPath("~/Videos")).GetDirectories();
    CreateTree(videoMenu.Items, dirs):
}

public void CreateTree(IList<RadMenuItem> parantCollection, IEnumerable<DirectoryInfo> parentDirs)
{
    foreach (var dir in parentDirs)
    {
        var node = OutputDirectory(dir, null);
        parantCollection.Add(node);
        CreateTree(node.Items, dir.GetDirectories());
    }
} 
```

# python - 如何使用 PIL 减小图像文件大小

> ID：10607468
> 
> 赞同：102
> 
> 时间：2012-05-15T19:26:01.480
> 
> 标签：python, image, compression, python-imaging-library

我正在使用 PIL 通过将较大的图像转换为较小的图像来调整图像的大小。是否有任何标准方法可以在不损失太多质量的情况下减小图像的文件大小，假设图像的原始大小为 100KB，我想将其缩小到 5 或 10 KB，尤其是对于 png 和 jpeg 格式。

* * *

## 回答 #1

> 赞同：166
> 
> 时间：2012-11-03T17:48:56.583

A built-in parameter for saving JPEGs and PNGs is `optimize`.

```
 >>> from PIL import Image
 # My image is a 200x374 jpeg that is 102kb large
 >>> foo = Image.open("path\\to\\image.jpg")
 >>> foo.size
  (200,374)
 # I downsize the image with an ANTIALIAS filter (gives the highest quality)
 >>> foo = foo.resize((160,300),Image.ANTIALIAS)
 >>> foo.save("path\\to\\save\\image_scaled.jpg",quality=95)
 # The saved downsized image size is 24.8kb
 >>> foo.save("path\\to\\save\\image_scaled_opt.jpg",optimize=True,quality=95)
 # The saved downsized image size is 22.9kb 
```

The `optimize` flag will do an extra pass on the image to find a way to reduce its size as much as possible. 1.9kb might not seem like much, but over hundreds/thousands of pictures, it can add up.

Now to try and get it down to 5kb to 10 kb, you can change the quality value in the save options. Using a quality of 85 instead of 95 in this case would yield: Unoptimized: 15.1kb Optimized : 14.3kb Using a quality of 75 (default if argument is left out) would yield: Unoptimized: 11.8kb Optimized : 11.2kb

I prefer quality 85 with optimize because the quality isn't affected much, and the file size is much smaller.

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2014-04-28T10:02:07.273

假设您有一个名为 Book 的模型，上面有一个名为“cover_pic”的字段，在这种情况下，您可以执行以下操作来压缩图像：

```
from PIL import Image
b = Book.objects.get(title='Into the wild')
image = Image.open(b.cover_pic.path)
image.save(b.image.path,quality=20,optimize=True) 
```

希望它对任何偶然发现它的人有所帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-05-15T19:33:05.170

请参阅 PIL 的 Image Module 的[缩略图](http://effbot.org/imagingbook/image.htm#tag-Image.Image.thumbnail)功能。您可以使用它将较小版本的文件保存为各种文件类型，如果您想尽可能多地保留质量，请考虑`ANTIALIAS`在这样做时使用过滤器。

除此之外，我不确定是否有办法指定最大所需大小。当然，您可以编写一个函数，尝试以不同的质量保存文件的多个版本，直到满足特定大小，丢弃其余的并为您提供所需的图像。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-07-08T19:21:28.947

主要的图像管理器`PIL`是`PIL`'s`Image`模块。

```
from PIL import Image
import math

foo = Image.open("path\\to\\image.jpg")
x, y = foo.size
x2, y2 = math.floor(x-50), math.floor(y-20)
foo = foo.resize((x2,y2),Image.ANTIALIAS)
foo.save("path\\to\\save\\image_scaled.jpg",quality=95) 
```

您可以添加`optimize=True`参数来进一步减小尺寸，但优化仅适用于 JPEG 和 PNG。对于其他图像扩展，您可以降低新保存图像的质量。您可以通过删除一些代码并定义图像大小来更改新图像的大小，只有仔细查看代码才能弄清楚如何做到这一点。我定义了这个尺寸：

```
x, y = foo.size
x2, y2 = math.floor(x-50), math.floor(y-20) 
```

只是为了向您展示（几乎）通常使用水平图像完成的操作。对于垂直图像，您可以这样做：

```
x, y = foo.size
x2, y2 = math.floor(x-20), math.floor(y-50) 
```

. 请记住，您仍然可以删除那段代码并定义新的大小。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-31T10:15:39.953

您可以调整图像大小，也可以降低图像质量。这里附上几个例子：

**Python PIL调整图像大小**

```
from PIL import Image
WIDTH = 1020
HEIGHT = 720
img = Image.open("my_image.jpg")
resized_img = img.resize((WIDTH, HEIGHT))
resized_img.save("resized_image.jpg") 
```

**更改图像分辨率枕头**

```
from PIL import Image
size = 7016, 4961
im = Image.open("my_image.png")
im_resized = im.resize(size, Image.ANTIALIAS)
im_resized.save("image_resized.png", "PNG") 
```

或者你可以使用

```
im_resized.save("image_resized.png", quality=95, optimize=True) 
```

* * *

## 回答 #6

> 赞同：-14
> 
> 时间：2020-12-29T05:04:53.013

如果你有一个胖 png（1MB 用于 400x400 等）：

```
__import__("importlib").import_module("PIL.Image").open("out.png").save("out.png") 
```

# android - Android获取屏幕宽度

> ID：10607470
> 
> 赞同：3
> 
> 时间：2012-05-15T19:26:17.063
> 
> 标签：android, layout, screen

Android：嘿，我想检索屏幕的宽度并将其除以 3。我想在 LayoutParams 中使用这个长度，但它不起作用。我究竟做错了什么 ？应用程序在 // 1 崩溃。

```
public class LoaderImageView extends LinearLayout {

private Context mContext;
private Drawable mDrawable;
private ProgressBar mSpinner;
private ImageView mImage;
Context ctx;
Display display;

public LoaderImageView(Context context, AttributeSet attrs) {
    super(context, attrs);
    init(context);
}

public LoaderImageView(Context context) {
    super(context);
    init(context);
}

/**
 * First time loading of the LoaderImageView
 * Sets up the LayoutParams of the view, you can change these to
 * get the required effects you want
 */
private void init(final Context context) {
    mContext = context; 
```

//1\. //这是应用程序崩溃，从这里开始

```
 Display display = getWindowManager().getDefaultDisplay();
    Point size = new Point();
    display.getSize(size);
    int width = size.x;
    int height = size.y; 
```

// 到这里

```
 mImage = new ImageView(mContext);
    mImage.setLayoutParams(new LayoutParams((width/3), 150));
    mImage.setVisibility(View.GONE);
    mImage.setBackgroundColor(Color.WHITE);
    mImage.setPadding(3, 3, 3, 3);

    mSpinner = new ProgressBar(mContext);
    mSpinner.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));

    mSpinner.setIndeterminate(true);

    addView(mSpinner);
    addView(mImage);

}

/**
 * Set's the view's drawable, this uses the internet to retrieve the image
 * don't forget to add the correct permissions to your manifest
 * 
 * @param imageUrl the url of the image you wish to load
 */
public void setImageDrawable(final String imageUrl) {
    mDrawable = null;
    mSpinner.setVisibility(View.VISIBLE);
    mImage.setVisibility(View.GONE);
    new Thread() {
        public void run() {
            try {
                mDrawable = getDrawableFromUrl(imageUrl);
                imageLoadedHandler.sendEmptyMessage(RESULT_OK);
            } catch (MalformedURLException e) {
                imageLoadedHandler.sendEmptyMessage(RESULT_CANCELED);
            } catch (IOException e) {
                imageLoadedHandler.sendEmptyMessage(RESULT_CANCELED);
            }
        };
    }.start();
}

/**
 * Callback that is received once the image has been downloaded
 */
private final Handler imageLoadedHandler = new Handler(new Callback() {

    public boolean handleMessage(Message msg) {
        switch (msg.what) {
        case RESULT_OK:
            mImage.setImageDrawable(mDrawable);
            mImage.setVisibility(View.VISIBLE);
            mSpinner.setVisibility(View.GONE);
            break;
        case RESULT_CANCELED:
        default:
            // Could change image here to a 'failed' image
            // otherwise will just keep on spinning
            break;
        }
        return true;
    }
});

/**
 * Pass in an image url to get a drawable object
 * 
 * @return a drawable object
 * @throws IOException
 * @throws MalformedURLException
 */
private static Drawable getDrawableFromUrl(final String url) throws IOException, MalformedURLException {
    return Drawable.createFromStream(((java.io.InputStream) new java.net.URL(url).getContent()), "name");
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:31:41.643

在创建视图时，它尚未附加到布局或窗口。尝试将该代码移至`onAttachedToWindow`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T20:20:58.720

尽管`getWindowManager()`是Activity的方法：http: [//developer.android.com/reference/android/app/Activity.html#getWindowManager](http://developer.android.com/reference/android/app/Activity.html#getWindowManager) ()

方法也`getSize()`仅从 API livel 13 开始可用

[http://developer.android.com/reference/android/view/Display.html#getSize(android.graphics.Point](http://developer.android.com/reference/android/view/Display.html#getSize(android.graphics.Point) )

可能这不太好，涵盖所有使用的 android api 版本

```
Display display = getWindowManager().getDefaultDisplay(); 
int width = display.getWidth();  // deprecated
int height = display.getHeight();  // deprecated 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:33:20.507

我相信 getWindowManager() 需要在 Activity 上调用，而不是在 Layout 类上。尝试在您的活动中检索宽度/高度，然后将这些值（宽度/高度）传递到您的扩展线性布局类并使用它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-12T11:30:03.637

如果您不在 Activity 中，您可以通过 WINDOW_SERVICE 获得默认显示：

```
WindowManager wm = (WindowManager) context.getSystemService(Context.WINDOW_SERVICE);
Display display = wm.getDefaultDisplay(); 
```

[详情在这里..](https://stackoverflow.com/questions/1016896/how-to-get-screen-dimensions)

# jquery - KeyUp 移动到输入值的末尾

> ID：10607471
> 
> 赞同：0
> 
> 时间：2012-05-15T19:26:22.490
> 
> 标签：jquery, input, keyup

当输入字段中的输入发生更改时，我正在 jquery 中编写一些内容来保存 cookie，它会一直跳到字符末尾。这方面的例子就是我打字。

Wise[d]Words[an] 我把 d 放在 WiseWords 的中间，它会在我放剩下的 an 之前自动把我送到最后。身为丹。

```
 $("#firstName, #lastName, #Pickup_Date_Value, #phoneValue, #emailValue").keyup(function() {
        session_order.cFnV = $("#firstName").val();
        session_order.cLnV = $("#lastName").val();
        session_order.pDv = $("#Pickup_Date_Value").val();
        session_order.pNv = $("#phoneValue").val();
        session_order.eAv = $("#emailValue").val();
    }); 
```

# android - 三星模拟器缺少 Google API - 地图？

> ID：10607474
> 
> 赞同：0
> 
> 时间：2012-05-15T19:26:26.677
> 
> 标签：android, samsung-mobile, galaxy-tab

我们的应用程序使用 Googe API 来制作地图。

当我们尝试在提供的模拟器上运行应用程序时`Samsung for their Galaxy`，它会失败，因为模拟器似乎是`missing the shared library`？如何克服？

```
Failure [INSTALL_FAILED_MISSING_SHARED_LIBRARY] 
```

这是 AVD 的配置：

![在此处输入图像描述](../Images/8da088e8eda970803f94f7284030c963.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:49:27.477

Go for Google APIs(Google Inc.)-API Level 8

由于 Galaxy Tab Addon 系统映像不包含 Maps 外部库`(com.google.android.maps)`。

# php - oauth_token 随时间的有效性和linkedin API

> ID：10607475
> 
> 赞同：0
> 
> 时间：2012-05-15T19:26:27.213
> 
> 标签：php, oauth, linkedin

我使用了来自linkedin的以下代码：

[https://developer.linkedin.com/documents/quick-start-guide#toggleview:id=php](https://developer.linkedin.com/documents/quick-start-guide#toggleview:id=php)

它显示了如何获取访问令牌并在 php 中生成典型的身份验证 url： [https ://www.linkedin.com/uas/oauth/authenticate?oauth_token=xxxxxxxxxx](https://www.linkedin.com/uas/oauth/authenticate?oauth_token=xxxxxxxxxx)

这是问题所在：当我复制粘贴 url 时，它首先起作用：我进入linkedIn 页面以
授权访问。但是，如果我在 5 分钟后尝试相同的链接，即相同的令牌，我会收到错误消息：“我们无法找到授权令牌”。我用不同的令牌尝试了几次并得到相同的结果：从第一次生成到 5 分钟后，url 工作，然后 5 分钟后，我得到错误页面。我会很感激一些建议。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-03T13:37:09.893

oAuth“舞蹈”的一部分是时间戳，必须在舞蹈第一部分的 5 分钟内。幻灯片[http://www.slideshare.net/episod/linkedin-oauth-zero-to-hero](http://www.slideshare.net/episod/linkedin-oauth-zero-to-hero)可能会有所帮助。

# java - 使用 WS-policy 保护 Web Logic WebServices

> ID：10607481
> 
> 赞同：0
> 
> 时间：2012-05-15T19:26:50.020
> 
> 标签：java, web-services, weblogic-10.x, ws-security

我已经为通过 VPN 访问它的客户开发了网络服务（为了安全起见，大多数电信公司都提供了对它的访问）

考虑到上述情况，我是否需要为我的 Web 服务实现 WSSecurity？

如果是，那么应该使用哪种类型的策略？

更新：

我想强调一点，多个客户连接到一台服务器。不同的 Web 服务面向不同的客户。因此，为了限制一个客户端访问其他客户端 Web 服务，我们必须实施一些用户名密码策略。

请评论。

问候，伊姆兰

# sql - 使用 SQL 向表中添加布尔类型字段

> ID：10607485
> 
> 赞同：0
> 
> 时间：2012-05-15T19:27:10.387
> 
> 标签：sql

我正在尝试使用 SQL 向表中添加一个布尔字段，但是我没有得到任何结果。我用来尝试添加字段的查询是：

```
ALTER TABLE TEST
ADD "NewField" BOOLEAN 
```

运行它时会显示错误`Invalid use of keyword`。我正在尝试将此字段添加到悖论数据库中。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T19:29:49.987

SQL 中没有布尔值 -`bit`改为使用列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:55:57.097

双引号= postgres？带有大写字母的表名也可能需要双引号。

> 更改表“TEST”添加“NewField”布尔值；

可以工作....

# c++ - C ++中的通用（几乎）自描述参数与GUI相结合？

> ID：10607486
> 
> 赞同：11
> 
> 时间：2012-05-15T19:27:11.867
> 
> 标签：c++, oop, templates

我面临以下难题：我们的软件有一个算法对象的抽象基类。所有这些对象都有一个共同的`execute()`方法，例如：

```
class Algorithm
{
public:
  // [...]
  virtual void execute() = 0;
  // [...]
}; 
```

对于我们想要实现的每个算法，我们只需从基类继承并将所有加载的算法对象存储在一个中心位置。到目前为止，一切都很好。

现在的问题在于算法的参数。我们希望能够为每个算法描述需要设置的参数（通过外部类）。为此，我们给每个算法一个`ParameterList`包含其参数的对象。我应该澄清一下，对我们来说，参数由某种类型（例如`int`）和标签（例如“迭代次数”）组成。

当我们想要连接`ParameterList`到某种 GUI 时，问题就开始了。显然，我们的算法不应该“了解”我们正在使用的图形 API（Qt、GTK 等）。然而，在同一方面，我们希望能够从语义上描述算法参数，例如通过指定算法需要一个*文件名*。然后如何显示此*文件名*取决于 GUI。

有没有办法将它`ParameterList`与某种语义类型的知识结合起来？

我意识到这个问题听起来很模糊。但是，我不允许发布任何重要的代码示例（出于 NDA 原因）。那么，过去有没有人遇到过类似的问题？

总结一下：我们希望我们的对象在不知道 GUI 的确切细节的情况下向 GUI 描述它们所需的参数。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-15T19:32:42.587

这里的一种选择可能是使用访问者模式。您可以像这样创建一个基类：

```
class Parameter {
public:
    virtual ~Parameter() {} // Polymorphic classes need virtual dtors.

    virtual void accept(ParameterVisitor& v) = 0;
}; 
```

您可以定义如下子类：

```
class IntParameter: public Parameter {
public:
     virtual void accept(ParameterVisitor& v) {
          v.visit(*this);
     }
};
class FilenameParameter: public Parameter {
public:
     virtual void accept(ParameterVisitor& v) {
          v.visit(*this);
     }
}; 
```

请注意，在每个`accept`成员函数中，类型`*this`是类的静态类型——即，`IntParameter&`在第一种情况下，`FilenameParameter&`在第二种情况下。

然后，您可以`ParameterVisitor`像这样定义一个基类类：

```
class ParameterVisitor {
public:
    virtual ~ParameterVisitor() {} // Polymorphic classes need virtual dtors.

    virtual void visit(IntParameter& p) {}
    virtual void visit(FilenameParameter& p) {}
    /* .. etc. .. */
}; 
```

然后，您可以对该访问者进行子类化以获取类型信息：

```
class Gui1ParameterVisitor: public ParameterVisitor {
public:
    virtual void visit(IntParameter& p) {
        /* ... use GUI1 to create a field for an integer. */
    }
    virtual void visit(FilenameParameter& p) {
        /* ... use GUI1 to create a field for a filename. */
    }
};

class Gui2ParameterVisitor: public ParameterVisitor {
public:
    virtual void visit(IntParameter& p) {
        /* ... use GUI2 to create a field for an integer. */
    }
    virtual void visit(FilenameParameter& p) {
        /* ... use GUI2 to create a field for a filename. */
    }
}; 
```

然后，您的`ParameterList`班级可以只存储`Parameter*`s 的列表。然后，您可以通过实例化适当的访问者类型来构建 GUI，然后让其`visit`回调完成所有小部件的构建。这最终是类型安全的并恢复了您需要的信息。它确实有一个缺点，即每次创建新的参数类型时，都必须向类中添加新的成员函数`visit`，`ParameterVisitor`但无论如何您都需要这样做才能完成所有 GUI 构建。

希望这可以帮助！

# java - 小程序计算 & 监听器问题 & 外观

> ID：10607494
> 
> 赞同：1
> 
> 时间：2012-05-15T19:27:41.907
> 
> 标签：java, exception, applet, try-catch, actionlistener

以下小程序在启动时显示为一团糟，但更大的问题是当按下按钮进行计算时，异常会飞。我不确定问题可能是什么。我很确定我的循环是正确的。

这是异常列表，然后是实际代码：

```
Exception in thread "AWT-EventQueue-1" java.lang.NumberFormatException: empty String
    at sun.misc.FloatingDecimal.readJavaFormatString(FloatingDecimal.java:992)
    at java.lang.Double.parseDouble(Double.java:510)
    at bacCalcApplet$ButtonListener.actionPerformed(bacCalcApplet.java:164)
    at java.awt.Button.processActionEvent(Button.java:392)
    at java.awt.Button.processEvent(Button.java:360)
    at java.awt.Component.dispatchEventImpl(Component.java:4737)
    at java.awt.Component.dispatchEvent(Component.java:4565)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:684)
    at java.awt.EventQueue.access$000(EventQueue.java:85)
    at java.awt.EventQueue$1.run(EventQueue.java:643)
    at java.awt.EventQueue$1.run(EventQueue.java:641)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:87)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:98)
    at java.awt.EventQueue$2.run(EventQueue.java:657)
    at java.awt.EventQueue$2.run(EventQueue.java:655)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:87)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:654)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:296)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:211)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:201)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:196)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:188)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:122) 
```

## 代码

```
//@author Noah Kline

import java.applet.*;
import java.awt.*;
import java.awt.event.*;
import java.text.*;

public class bacCalcApplet extends Applet
{

/**
 * Calculates the BAC
 */
// Create Panel Properties
private static final long serialVersionUID = -8477155615510893945L;
private Panel fPanel;
private Panel answerPanel;
private Panel dPanel;
private Panel wPanel;
private Panel hPanel;
private Panel buttonPanel;
private TextField genderDisplay;
private TextField drinksCount;
private TextField weightDisplay;
private TextField hoursDisplay;
private TextField bacDisplay;

public void init()
{
    // Initialize panels
    buildGenderpanel();
    buildDrinkpanel();
    buildWeightpanel();
    buildHourspanel();
    buildanswerPanel();
    buildButtonPanel();

    // panel layout design in 1 applet
    setLayout(new GridLayout(8, 1));

    // adding panel properties to layout
    add(fPanel);
    add(dPanel);
    add(wPanel);
    add(answerPanel);
    add(buttonPanel);

}

private void buildGenderpanel()
{

    fPanel = new Panel();

    Label message1 = new Label("Enter Gender:");

    genderDisplay = new TextField(10);

    fPanel.setLayout(new FlowLayout(FlowLayout.RIGHT));

    fPanel.add(message1);
    fPanel.add(genderDisplay);

}

private void buildDrinkpanel()
{

    dPanel = new Panel();

    Label message2 = new Label("Enter # of Drinks:");

    drinksCount = new TextField(10);

    fPanel.setLayout(new FlowLayout(FlowLayout.RIGHT));

    fPanel.add(message2);
    fPanel.add(drinksCount);

}

private void buildWeightpanel()
{

    wPanel = new Panel();

    Label message3 = new Label("Enter Your Weight:");

    weightDisplay = new TextField(10);

    wPanel.setLayout(new FlowLayout(FlowLayout.RIGHT));

    wPanel.add(message3);
    wPanel.add(weightDisplay);

}

private void buildHourspanel()
{

    hPanel = new Panel();

    Label message4 = new Label("Enter Hours since last drink: ");

    hoursDisplay = new TextField(10);

    hPanel.setLayout(new FlowLayout(FlowLayout.RIGHT));

    hPanel.add(message4);
    hPanel.add(hoursDisplay);

}

private void buildanswerPanel()
{

    answerPanel = new Panel();

    Label message5 = new Label("Answer: ");

    bacDisplay = new TextField(10);

    // answerPanel.setLayout(new FlowLayout(FlowLayout.RIGHT));

    bacDisplay.setEditable(false);

    answerPanel.add(message5);
    answerPanel.add(bacDisplay);

}

private void buildButtonPanel()
{

    buttonPanel = new Panel();

    Button convButton = new Button("Calculate");

    convButton.addActionListener(new ButtonListener());

    buttonPanel.add(convButton);
}

// Listener
private class ButtonListener implements ActionListener
{
    public void actionPerformed(ActionEvent e)
    {

        double gender;
        double drinks;
        double weight;
        double hours;
        double bac;

        DecimalFormat fmt = new DecimalFormat("0.0000");

        gender = Double.parseDouble(genderDisplay.getText());

        drinks = Double.parseDouble(drinksCount.getText());

        weight = Double.parseDouble(weightDisplay.getText());

        hours = Double.parseDouble(hoursDisplay.getText());

        bac = Double.parseDouble(bacDisplay.getText());

        if (gender == 1)
        {
            bac = ((drinks * .06 * 100 * 1.055) / (weight * .68))
                    - (0.015 * hours);

            bacDisplay.setText(fmt.format(bac));

        }

        else if (gender == 2)
        {

            bac = ((drinks * .06 * 100 * 1.055) / (weight * .55))
                    - (0.015 * hours);

            bacDisplay.setText(fmt.format(bac));

        }

    }
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-28T02:48:26.653

这是最终产品，减去一个小程序（使用 jQuery 构建）： [http ://bac.klinetel.com/](http://bac.klinetel.com/)

# java - 展平xml文件

> ID：10607496
> 
> 赞同：0
> 
> 时间：2012-05-15T19:27:47.983
> 
> 标签：java, xml, xslt, xml-parsing

我想编写一个通用的 xml 解析器，它可以展平任何 xml 文件。例如

如果 xml 具有如下结构：

```
<A a="a1">

   <B> b </B>

   <C>

      <D> d1 </D>

      <D> d2 </D>

   </C>

   <C>

      <D> d3 </D>

   </C>

   <E> e1 </E>     

</A> 
```

我应该得到如下输出：

a1 b d1 e1

a1 b d2 e1

a1 b d3 e1

我希望解析器是通用的，以便它可以在不知道标签的情况下应用于任何 xml。我听说过 XSLT。但我不确定我们是否可以编写一个没有 xml 标签知识的通用 XSL。XML 文件的大小约为 1Gb。这个问题有通用的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:34:14.083

使用 SAX 解析器，并保留一堆开放元素。看到元素打开后，将它们添加到堆栈中。在文本节点上，打印堆栈，在关闭元素上，将它们从堆栈中弹出。应该直截了当。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T06:30:20.953

你似乎想要的“扁平化”更像是一种“爆炸”。您的输入是一棵树，您希望将其分解为一组记录，其中重复所有冗余数据。这不是 XSLT 的工作。从概念上讲，您必须对数据进行多次传递。首先，您必须识别所有级别的所有叶节点集合；然后你必须遍历所有可能的叶子节点组合，为每个组合输出一组完整的数据。如果您的输入约为 1GB，请为 TB 的输出做好准备。

看起来你有两个选择：

1.  使用 SAX 将整棵树加载到内存中，然后实现爆炸算法。
2.  遍历输入数据以提取结构并在每个叶节点集上建立位置光标；然后对输入进行多次传递，使用光标决定每次传递的输出。

无论哪种方式，我都不确定您所描述的实际上是您想要的。对于任何大型的多级叶节点集，组合的数量很容易成为天文数字。

# javascript - 使用原型在标签中获取 for 的值

> ID：10607503
> 
> 赞同：0
> 
> 时间：2012-05-15T19:28:13.973
> 
> 标签：javascript, prototypejs

HTML：

```
<label name="table_id" for="1280461">Rock</label>
<label name="table_id" for="1291065">Paper</label> 
```

这不起作用：

```
$$('label[name="table_id"]').each(function(s){ 
  console.log(s.for); 
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:29:56.737

```
s.readAttribute('for'); 
```

参见： http: [//prototypejs.org/api/element/readattribute](http://prototypejs.org/api/element/readattribute)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:40:49.493

`for`是 Javascript 中的关键字。您不能以“ `s.for`”形式使用它。

使用`DOM Element`的[getAttribute](https://developer.mozilla.org/en/DOM/element.getAttribute)函数：

```
$$('label[name="table_id"]').each(function(s){ 
    console.log(s.getAttribute('for')); 
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:43:14.597

我创造了一个小提琴来回答这个问题。希望这对你有意义。

[http://jsfiddle.net/QmEWD/](http://jsfiddle.net/QmEWD/)

# asp.net - 使用 asp.net 为 SalesLogix 使用 OleDb 连接时出错。没有可用的错误消息，结果代码：E_FAIL(0x80004005)

> ID：10607506
> 
> 赞同：5
> 
> 时间：2012-05-15T19:28:47.283
> 
> 标签：asp.net, iis, database-connection, oledb, saleslogix

我正在使用 SalesLogix 连接提供程序，它是一个 32 位驱动程序。当我尝试打开连接然后引发以下异常

**System.Data.OleDb.OleDbException (0x80004005)：没有可用的错误消息，结果代码：E_FAIL(0x80004005)**

我在应用程序（网络和桌面）中都使用以下连接字符串

```
Provider=SLXOLEDB.1;Data Source=TestServer;Initial Catalog=SLXTestApp;User Id=Alex;Password=alex124;Persist Security Info=True;Extended Properties=Port=1706;Log=Off" 
```

当我在桌面应用程序（C#）中使用具有相同连接字符串的相同代码时。它成功打开连接并且还没有错误地获取数据。但是在 asp.net 4.0 的情况下给了我错误。

以下是我的应用程序的配置/设置

两个应用程序中的 1-Platform 目标相同，即**x86**。
2-我在具有 64 位操作系统的 webserver 2008 R2 上使用 IIS(7.5.7600.16385)。
3-在应用程序池中启用 32 位应用程序是真的。
4-托管管道模式 = 集成
5-Aspnet 4.0(C#)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-17T19:32:54.920

SalesLogix OLEDB 提供程序仅为 32 位。您需要以 32 位模式运行 IIS 网站才能访问数据库。

有关详细信息，请参见此处：http: [//help.webcontrolcenter.com/KB/a1114/how-to-enable-32-bit-application-pool-iis-7-dedicatedvps.aspx](http://help.webcontrolcenter.com/KB/a1114/how-to-enable-32-bit-application-pool-iis-7-dedicatedvps.aspx)

您似乎已经设置好了...但是请仔细检查以防万一。

然后：驱动程序是否正常工作？通常的检查是运行 SalesLogix LAN 客户端（如果尚未安装，请安装它）。可能只需运行客户端安装即可为您解决问题。

编辑：只是为了在响应中插入这个问题的另一个原因（这似乎很常见）是运行应用程序池的用户帐户，通常应该是本地系统。

# javafx-2 - JavaFX 2 空白标签刷新问题

> ID：10607507
> 
> 赞同：2
> 
> 时间：2012-05-15T19:28:49.187
> 
> 标签：javafx-2

我有一个每秒更新数百次的 Java FX 2 应用程序。我遇到了一个问题，标签在几分之一秒内部分空白，但这种情况经常发生。我该如何解决？

![在此处输入图像描述](../Images/5fa1211fab6c829430cf09c77e8f09ec.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:27:32.643

每秒调用数百次[Platform.runLater()](http://docs.oracle.com/javafx/2/api/javafx/application/Platform.html#runLater%28java.lang.Runnable%29)不是一个好主意。我建议您在调用 Platform.runLater() 以更新您的 UI 之前限制数据源的输入速度或将数据一起批处理，这样 Platform.runLater 的调用次数不会超过每秒 30 次。

我提交了一个 jira 请求[RT-21569](http://javafx-jira.kenai.com/browse/RT-21569)来改进 Platform.runLater 调用的文档，并考虑在底层平台中实现一个优越的 runLater 事件节流系统。

[Richard Bair 在此论坛主题](https://forums.oracle.com/forums/thread.jspa?messageID=10170806)中提供了批处理 runLater 事件的示例解决方案。

```
import javafx.application.Application;
import javafx.application.Platform;
import javafx.scene.Scene;
import javafx.scene.control.ListView;
import javafx.stage.Stage;

import java.util.LinkedList;
import java.util.List;
import java.util.concurrent.Semaphore;

/**
 *
 */
public class BackgroundLoadingApp extends Application {

    private ListView<String> listView;

    private List<String> pendingItems;

    private Semaphore lock = new Semaphore(1);

    protected void addItem(String item) throws InterruptedException {
        if (Platform.isFxApplicationThread()) {
            listView.getItems().add(item);
        } else {
            // It might be that the background thread
            // will update this title quite frequently, and we need
            // to throttle the updates so as not to completely clobber
            // the event dispatching system.
            lock.acquire();
            if (pendingItems == null) {
                pendingItems = new LinkedList<String>();
                pendingItems.add(item);
                Platform.runLater(new Runnable() {
                    @Override public void run() {
                        try {
                            lock.acquire();
                            listView.getItems().addAll(pendingItems);
                            pendingItems = null;
                        } catch (InterruptedException ex) {
                            ex.printStackTrace();
                        } finally {
                            lock.release();
                        }
                    }
                });
            } else {
                pendingItems.add(item);
            }
            lock.release();
        }
    }

    /**
     * The main entry point for all JavaFX applications.
     * The start method is called after the init method has returned,
     * and after the system is ready for the application to begin running.
     * <p/>
     * <p>
     * NOTE: This method is called on the JavaFX Application Thread.
     * </p>
     *
     * @param primaryStage the primary stage for this application, onto which
     *                     the application scene can be set. The primary stage will be embedded in
     *                     the browser if the application was launched as an applet.
     *                     Applications may create other stages, if needed, but they will not be
     *                     primary stages and will not be embedded in the browser.
     */
    @Override public void start(Stage primaryStage) throws Exception {
        listView = new ListView<String>();
        primaryStage.setScene(new Scene(listView));
        primaryStage.show();

        // Start some background thread to load millions of rows as fast as it can. But do
        // so responsibly so as not to throttle the event thread
        Thread th = new Thread() {
            @Override public void run() {
                try {
                    for (int i=0; i<2000000; i++) {
                        addItem("Item " + i);
                        if (i % 200 == 0) {
                            Thread.sleep(20);
                        }
                    }
                } catch (InterruptedException ex) {
                    ex.printStackTrace();
                }
            }
        };
        th.setDaemon(true);
        th.start();
    }

    public static void main(String[] args) {
        launch(args);
    }
} 
```

Richard Bair 的评论从引用的论坛帖子中复制：

> 这是一个模拟一些长时间运行的线程产生大量数据的示例。我发现它不太符合我的喜好。如果 Thread.sleep 丢失，它仍然会淹没进程（也许这是我在这种情况下处理并发的方式）。我还发现，如果我将它减少到“2”毫秒的睡眠时间，那么我就无法抓住滚动条拇指并移动它。我认为这里的问题是事件队列中有一个用于按下和拖动的鼠标事件，但是在拖动事件之间，新项目被添加到列表中，导致拇指移动，因为这比我的拖动事件更频繁地发生拇指永远不会去我想要的地方。我认为这是由于根据行数处理拇指位置的方式，

# loops - Struts 逻辑迭代标记以循环遍历表行

> ID：10607510
> 
> 赞同：0
> 
> 时间：2012-05-15T19:28:56.853
> 
> 标签：loops, html-table, struts-1

我正在使用支柱。当每个迭代使用不同的列表时，如何使用迭代标记创建一个遍历名字和姓氏的表行？

```
 <logic:iterate name="fName" id="listMsgId1">
      <tr>
           <td>First Name: <bean:write name="listMsgId1"/></td>
           <logic:iterate name="lName" id="listMsgId2" >
           <td>Last Name: <bean:write name="listMsgId2"/></td>     
           </logic:iterate>     
      </tr>
 </logic:iterate> 
```

目前，我得到的输出是名字：juan 姓氏：brown 姓氏：smith 名字：ken 姓氏：brown 姓氏：smith

我希望每个名字只出现一次姓氏，而不是创建的行数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T09:43:51.280

@Dave 的答案是正确的，尽管这可能对您有所帮助，

您应该创建`ActioForm`包含 2 个属性。

```
public class PersonDetail extends ActionForm 
{
protected String firstName;
protected String lastName;

public void setFirstName(String newFirstName) {
    firstName = newFirstName;
}

public String getFirstName() {
    return firstName;
}

public void setFirstName(String newLastName) {
    lastName = newLastName;
}

public String getLastName() {
    return lastName;
}
} 
```

现在根据要求进行迭代，假设`PersonDetail`在`ArrayList`您的操作类中。

```
<logic:iterate name="PersonDetail" id="listUsers">
     <tr>
          <td>First Name: <bean:write name="listUsers" property="FirstName"/></td>
          <td>Last Name: <bean:write name="listUsers" property="LastName"/></td>
     <tr>
</logic:iterate> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:38:38.417

在操作中创建适当的数据结构并传递它而不是两个列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-12T04:51:43.237

作为旁注，您可以使用 hashmap 轻松完成。在 java 类中，您将创建一个哈希，代码将是这样的

```
HashMap<String,String> myMap = new HashMap();
myMap.put("DummyFirstName", "DummyLastName");
myMap.put("raheel","arif");
myMap.put("dave","newton");
request.setAttribute("SubscribedLists", myMap); 
```

和jsp页面代码将是

```
 <logic:iterate name="SubscribedLists" id="SubscribedListsId">

                        <div>                         
                        <p><bean:write name="SubscribedListsId" property="key"/></p>                             
                        </div>

                        <div>
                          <p><bean:write name="SubscribedListsId" property="value"/></p>
                        </div>
                </logic:iterate> 
```

在我的示例中，我使用了 div，您可以轻松地将其转换为代码表

# javascript - 在 XMPP pubsub 中，订阅者是否可以检索订阅列表或将其与 MUC 结合使用？

> ID：10607512
> 
> 赞同：0
> 
> 时间：2012-05-15T19:29:06.333
> 
> 标签：javascript, xmpp, openfire, ejabberd, multiuserchat

在 XMPP pubsub 中，订阅者是否可以检索订阅列表或将 pubsub 服务与 MUC 结合起来，以便订阅者可以在线看到人们（就像在 MUC 中一样）？

是否只有所有者可以检索订阅列表？他能以某种方式向pubsub中的所有人公开吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T02:09:42.890

虽然[XEP-0060](http://xmpp.org/extensions/xep-0060.html)中没有指定非所有者应该能够访问订阅者列表，但我认为对于给定的 pubsub 服务实现来说，允许您覆盖访问控制规则是完全合理的。

不幸的是，我对 Openfire 的了解还不够，无法知道这是否可行。

**更新：**在重新阅读您的问题时，我意识到您可能正在尝试将 pubsub 节点用作伪 MUC 房间。这样做的问题是，当订阅者列表发生变化（即有人加入或离开）时，您将不会收到通知。您也无法像使用普通状态节一样添加扩展信息。

出于这个原因，我不推荐这种方法（考虑到我对你正在尝试做的事情知之甚少）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-16T15:52:57.450

您可以编写一个插件，使每个订阅者都成为所有者（添加从属关系）并在他们取消订阅时删除该从属关系。

否则，您当然可以创建自定义版本的 openfire 并更改访问规则。

# javascript - 分组下拉 - 避免选择父级

> ID：10607517
> 
> 赞同：1
> 
> 时间：2012-05-15T19:29:23.943
> 
> 标签：javascript, html, drop-down-menu, parent

我正在尝试创建一个下拉菜单，如下所示：

```
Area1
 -City1
 -City2
 -City3
Area2
 -City4
 -City5 
```

因此，它将按区域进行某种分组，而这些区域将不可点击。基本上，我正在努力实现[Groupon](http://www.groupon.com/)所做的事情。

我已经查看了他们页面的代码，但我看不到如何实现这一点。我需要 JS/jQuery 吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:31:35.813

使用`<optgroup>`标签。例如：

```
<optgroup label='Seattle'>
    <option value='seattle:tacoma'>Tacoma</option>
    <option value='seattle:seattle'>Seattle</option>
</optgroup> 
```

在 Web 表单中，HTML`<optgroup>`元素在元素内创建一组选项`<select>`。optgroup 标签的 label 属性显示在 select 的下拉列表中，但不能被选中。最好的部分是不需要 JavaScript。

这是一个现场**[jsFiddle 示例](http://jsfiddle.net/j08691/2hYtj/)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:37:34.313

试试这个

```
<select>
  <optgroup label="Candy">
    <option value="snickers">Snickers</option>
    <option value="HerseyBar">Hershey Bar</option>
  </optgroup>
  <optgroup label="Fruit">
    <option value="apple">Apple</option>
    <option value="orange">Orange</option>
  </optgroup>
</select>​ 
```

# android - Android appWidget 多实例

> ID：10607518
> 
> 赞同：4
> 
> 时间：2012-05-15T19:29:32.577
> 
> 标签：android, android-appwidget

这个问题几乎是[Android - Multiple appWidgets playing different sound](https://stackoverflow.com/questions/4225197/android-multiple-appwidgets-playing-diferent-sounds)的重复，但我的代码不起作用。我正在使用小部件 ID 添加一个额外的意图，并使用日志语句来证明它，但是每当我在有多个实例时单击我的一个小部件时，我只会得到最后一个 appWidgetId。添加第二个小部件后，第一个小部件的意图似乎正在发生变化。如果其他帖子中的代码应该可以工作，那么我一定忽略了一些东西，因为我相信我的设置方式几乎相同。

```
 public class PhcaAppWidgetProvider extends AppWidgetProvider {
     private static final String ACTION_CLICK = "com.skipmorrow.phca.PhcaAppWidgetProvider.WIDGET_CLICKED";
     private final String widgetPageName = "_widget";
     private static final String PREFS_NAME = "PHCA";
     private static final String PREF_PREFIX_KEY = "prefix_";
     private static String MY_DEBUG = "PhcaAppWidget";

     @Override
     public void onUpdate(Context context, AppWidgetManager appWidgetManager,
             int[] appWidgetIds) {
        Log.d(MY_DEBUG, "Provider.onUpdate");
     }

     @Override
     public void onReceive(Context context, Intent intent) {
        String intentAction = intent.getAction();
        Log.d(MY_DEBUG, "Provider.onReceive(); action = " + intentAction);
        Bundle extras = intent.getExtras();

        // make a list of all extras, just so I can see what is in there...
        if (extras!=null) {
            Set<String> ks = extras.keySet();
            Iterator<String> iterator = ks.iterator();
            while (iterator.hasNext()) {
                String s = iterator.next();
                Log.d(MY_DEBUG, "Provider.Key found: " + s);
            }
        }
        else {
          Log.d(MY_DEBUG, "Provider.extras was null");
        }

            int[] appWidgetIds1 = intent.getIntArrayExtra("appWidgetIds");

            if (extras!=null && extras.containsKey("appWidgetIds")){
                // sometimes the intent comes back with an array of appWidgetIds, and sometimes the appWidgetId is stored
                // in the one extra "appWidgetId" Clicks never come with the array of appWidgetIds. They always come by
                // themselves
                Log.d(MY_DEBUG, "Provider.Intent extras does contain a key appWidgetIds");
                if (appWidgetIds1!=null) Log.d(MY_DEBUG, "Provider.Intent int array appWidgetIds1 size is " + appWidgetIds1.length);
                for (int i = 0; i<appWidgetIds1.length; i++) {
                    int appWidgetId = appWidgetIds1[i];
                    Log.d(MY_DEBUG, "Provider.Intent appWidgetIds1[" + i + "] = " + appWidgetId);
                    if (intentAction.equals("android.appwidget.action.APPWIDGET_UPDATE")) {
                        Log.d(MY_DEBUG, "Provider.APPWIDGET UPDATE");
                        updateWidgetState(context, intentAction, appWidgetId);
                    } else if (intentAction.equals("android.appwidget.action.APPWIDGET_DELETED")) {
                        // do nothing
                    }
                    else {
                        super.onReceive(context, intent);
                    }
                }
            } else {

            String intentData = intent.getDataString();
            Log.d(MY_DEBUG, "Provider.intent data = " + intentData);

            Integer appWidgetId = intent.getIntExtra("appWidgetId", -1);
            Log.d(MY_DEBUG, "Provider.appWidgetId = " + appWidgetId);

            if (intentAction.equals(ACTION_CLICK)) {
                Log.d(MY_DEBUG, "Provider.Clicked");
                SharedPreferences myPrefs = context.getSharedPreferences(PREFS_NAME, Context.MODE_WORLD_WRITEABLE);
                Integer objNum = myPrefs.getInt(PREF_PREFIX_KEY + appWidgetId, -1);
                Log.d(MY_DEBUG, "Provider.ObjNum = " + objNum);
                if (objNum > -1) {
                    Log.d(MY_DEBUG, "Provider.Executing...");
                    PageAction pa = (PageAction) CommonActivity.GetPageObjectAtIndex(context, widgetPageName, objNum);
                    pa.ExecuteActionFromWidgetClick(context);
                }
            }
            else {
                super.onReceive(context, intent);
            } 
            }
     }

     public static void updateWidgetState(Context paramContext, String paramString, Integer appWidgetId)
     {
        Log.d(MY_DEBUG, "Provider.updateWidgetState; appWidgetId = " + appWidgetId + "; paramString = " + paramString);
        RemoteViews localRemoteViews = buildUpdate(paramContext, paramString, appWidgetId);
        ComponentName localComponentName = new ComponentName(paramContext, PhcaAppWidgetProvider.class);
        AppWidgetManager.getInstance(paramContext).updateAppWidget(localComponentName, localRemoteViews);
     }

     private static RemoteViews buildUpdate(Context ctx, String paramString, Integer appWidgetId)
     {
        Log.d(MY_DEBUG, "Provider.buildUpdate(); appWidgetId = " + appWidgetId + "; paramString = " + paramString);
        RemoteViews views = new RemoteViews(ctx.getPackageName(), R.layout.phca_appwidget);
        if (paramString.equals("android.appwidget.action.APPWIDGET_UPDATE")) {
            Log.d(MY_DEBUG, "Provider.buildUpdate().. APPWIDGET_UPDATE");
            Intent intent = new Intent(ctx, PhcaAppWidgetProvider.class);
            intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            intent.setAction(ACTION_CLICK);
            intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId);
            Uri data = Uri.withAppendedPath(
                Uri.parse("ABCD" + "://widget/id/")
                ,String.valueOf(appWidgetId));
            intent.setData(data);
            Log.d(MY_DEBUG, "Provider.Added intent extra \"" +  AppWidgetManager.EXTRA_APPWIDGET_ID + "\" = " + appWidgetId);

            PendingIntent pendingIntent = PendingIntent.getBroadcast(ctx, appWidgetId, intent , PendingIntent.FLAG_UPDATE_CURRENT);
            views.setOnClickPendingIntent(R.id.phca_appwidget_layout, pendingIntent);
        }
        if(paramString.equals(ACTION_CLICK))
        {
            Log.d(MY_DEBUG, "Provider.buildUpdate().. CLICKED");
            Toast.makeText(ctx, "ACTION_CLICK", Toast.LENGTH_LONG).show();
        }
        return views; 
    }
 } 
```

我确实有一个配置活动（一个 ListActivity）这是我的 onListItemClick：

```
@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    super.onListItemClick(l, v, position, id);
    Toast.makeText(getApplicationContext(), "onListItemClick", Toast.LENGTH_SHORT);
    Log.d(MY_DEBUG, "Configurator.onListItemClick");
    SharedPreferences.Editor prefs = getSharedPreferences(PREFS_NAME, 0).edit();
    prefs.putInt(PREF_PREFIX_KEY + mAppWidgetId, position);
    prefs.commit();
    Log.d(MY_DEBUG, "Configurator.Prefs.commit()");

    // Push widget update to surface with newly set prefix
    Log.d(MY_DEBUG, "Configurator.calling updateWidgetState with appWidgetId = " + mAppWidgetId);
    PhcaAppWidgetProvider.updateWidgetState(getApplicationContext(), "android.appwidget.action.APPWIDGET_UPDATE", mAppWidgetId);
    Log.d(MY_DEBUG, "Configurator.updateWidgetState complete");
    Intent resultValue = new Intent();
    Uri data = Uri.withAppendedPath(
            Uri.parse("ABCD" + "://widget/id/")
            ,String.valueOf(mAppWidgetId));
    resultValue.setData(data);
    resultValue.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, mAppWidgetId);
    Log.d(MY_DEBUG, "Configurator.Creating widget with id = " + mAppWidgetId);
    setResult(RESULT_OK, resultValue);
    finish();
} 
```

我已经为此工作了两天，我希望有人能指出我的错误。一个虚拟的电子啤酒等待着可以解决这个问题的人:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-16T08:34:04.510

我试图查看您的代码，但没有找到为什么它对您不起作用，除了我在您的代码中发现了一些其他错误。无论如何，我已经构建了一个快速工作的代码，你可以尝试一下。

**WidgetProvider.java**

```
package com.example.helloclickablewidget;

import android.app.PendingIntent;
import android.appwidget.AppWidgetManager;
import android.appwidget.AppWidgetProvider;
import android.content.Context;
import android.content.Intent;
import android.widget.RemoteViews;
import android.widget.Toast;

public class WidgetProvider extends AppWidgetProvider {

    public static final String WIDGET_CLICKED = "com.example.helloclickablewidget.WIDGET_CLICKED";

    @Override
    public void onReceive(Context context, Intent intent) {
        final String action = intent.getAction();

        if (action != null && action.equals(WIDGET_CLICKED)) {
            int widgetId = intent.getIntExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, -1);
            Toast.makeText(context, "Widget clicked. ID: " + widgetId, Toast.LENGTH_LONG).show();
        } else {
            super.onReceive(context, intent);
        }
    }

    @Override
    public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) {
        final int N = appWidgetIds.length;

        // Perform this loop procedure for each App Widget that belongs to this provider
        for (int i = 0; i < N; i++) {
            int appWidgetId = appWidgetIds[i];

            // Create an Intent to launch ExampleActivity
            Intent intent = new Intent(context, WidgetProvider.class);
            intent.setAction(WIDGET_CLICKED);
            intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId);
            PendingIntent pendingIntent = PendingIntent.getBroadcast(context, appWidgetId, intent,
                    PendingIntent.FLAG_UPDATE_CURRENT);

            // Get the layout for the App Widget and attach an on-click listener
            // to the button
            RemoteViews views = new RemoteViews(context.getPackageName(), R.layout.widget);
            views.setOnClickPendingIntent(R.id.text, pendingIntent);
            // Tell the AppWidgetManager to perform an update on the current app widget
            appWidgetManager.updateAppWidget(appWidgetId, views);
        }
    }

} 
```

**布局/widget.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/text"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:text="@string/app_name" >
</TextView> 
```

**xml/widget.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android"
    android:initialLayout="@layout/widget"
    android:minHeight="50dp"
    android:minWidth="50dp"
    android:updatePeriodMillis="86400000" >
</appwidget-provider> 
```

**AndroidManifest.xml**

```
<manifest package="com.example.helloclickablewidget"
    android:versionCode="1"
    android:versionName="1.0" xmlns:android="http://schemas.android.com/apk/res/android">

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="15" />

    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <receiver android:name="WidgetProvider" android:exported="false">
            <intent-filter>
                <action android:name="android.appwidget.action.APPWIDGET_UPDATE" />
                <action android:name="com.example.helloclickablewidget.WIDGET_CLICKED"/>
            </intent-filter>
            <meta-data
                android:name="android.appwidget.provider"
                android:resource="@xml/widget" />
        </receiver>
    </application>

</manifest> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T09:59:33.327

尝试替换这些行：

```
Uri data = Uri.withAppendedPath(
            Uri.parse("ABCD" + "://widget/id/")
            ,String.valueOf(appWidgetId));
        intent.setData(data); 
```

和：

```
intent.setData(ContentUris.withAppendedId(Uri.EMPTY, appWidgetId)); 
```

# java - 带有 VPN 连接的 Java 套接字

> ID：10607523
> 
> 赞同：3
> 
> 时间：2012-05-15T19:29:59.073
> 
> 标签：java, sockets, networking, network-programming, network-protocols

我有一个 Java Socket 服务器在给定 192.168.* 地址的机器上监听。我有一个客户端 Java 解决方案连接到 Socket 服务器并使用 BufferedOutputStream 发送命令并捕获 BufferedInputStream 上的响应。

当我在本地网络上时，这一切都很好。

当我使用 VPN 时，我获得了 10* IPA，但该解决方案不起作用。听说需要路由10网，但是VPN服务器不会为我做这一切吗？

我可以通过我的 10 Net VPN 连接访问所有 192.168* 资源，所以我看不出这怎么可能是路由问题。

任何想法为什么来自 10 Net VPN 的 Java Socket 解决方案无法获得发送命令或接收响应？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T11:55:40.053

尽管您解决了问题，但我仍然对您的回答有一些误解，并考虑添加以确保。

您有一台 192.... 机器，您的服务器正在其上侦听某个端口（例如 4055）。现在，您希望该网络之外的客户端能够访问该服务器并交换数据。

如果您的客户端在同一个网络上，您不需要任何路由，您所需要的只是您的服务器*允许端口 4055 上的传入连接*。通常传入的连接（来自本地主机的除外）被防火墙（例如 Linux 上的 iptables）阻止，*您必须为此*在防火墙配置中添加规则。

但是，如果您的客户端位于不同的子网上并且需要路由，则您需要**在路由器上设置一个规则，**即您的路由器需要被告知从路由器端口 (y) 上的 ip x（客户端）收到的每个数据包都应该转发到您的服务器端口 4055。这称为端口转发。

**即使您的路由器能够转发某些端口，也必须明确告知需要将哪些流量从哪个 ip / 端口转发到哪个 ip 在哪个端口侦听**

# ios5 - 用于电视应用发布的 Facebook Opengraph 显示用户将在未来观看

> ID：10607525
> 
> 赞同：1
> 
> 时间：2012-05-15T19:30:02.920
> 
> 标签：ios5, facebook-opengraph

我们有一个电视指南应用程序，允许用户设置警报、添加到日历、观看、收藏和评价来自普通线性电视的电视节目或电影，并使用 Facebook Opengraph 自动与朋友分享这些内容。

我们已经研究过使用内置对象类型 video.movi​​e、video.episode 和 video.tv_show，但是由于用户经常会为将来的节目创建警报等动作，我们希望将频道和在时间轴中显示开始时间。不幸的是，我们无法为内置类型添加自定义属性。

这种 Facebook Opengraph 实施的最佳实践是什么？

# php - 一次又一次地给出MYSQL错误

> ID：10607526
> 
> 赞同：0
> 
> 时间：2012-05-15T19:30:03.410
> 
> 标签：php, mysql, database

我主持了一个新的头尾游戏网站。但我在我的索引和历史页面上不断收到此错误消息。

索引页面：警告：mysql_num_rows()：提供的参数不是第 233 行 /home/a1906451/public_html/index.php 中的有效 MySQL 结果资源

历史页面：警告：mysql_num_rows()：提供的参数不是第 106 行 /home/a1906451/public_html/history.php 中的有效 MySQL 结果资源

有解决的朋友吗？请帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:35:10.033

mysql_num_rows() 的参数需要一个有效的 MySQL 结果。最有可能的是，您忽略了来自 mysql_query() 的错误或试图查看不返回可用结果对象的查询。

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2012-05-15T19:32:48.997

更改`mysql_num_rows`为`@mysql_num_rows`第 233 行的 index.php 和第 106 行的 history.php ind

# sql - SQL 查询选择用户个人评分，或者如果不存在平均评分

> ID：10607529
> 
> 赞同：1
> 
> 时间：2012-05-15T19:30:16.973
> 
> 标签：sql, sql-server, average, rating

我有两张桌子：

**食谱**

食谱 ID | 用户名 | 姓名 | 等等

和

**食谱评级**

RecipeRatingId | 配方 ID| 用户名 | 评分| 评论

我想选择一个食谱列表并包括平均评分。像这样的东西会起作用：

```
SELECT
    Recipes.RecipeId,
    Name,
    AVG(RecipeRatings.Rating) AS AverageRating
FROM Recipes
INNER JOIN RecipeRatings
ON RecipeRatings.RecipeId = Recipes.RecipeId
GROUP BY Recipes.RecipeId, Recipes.Name
ORDER BY AverageRating DESC 
```

但我真正想要的是获得平均或当前用户评分。如果用户对它的评价更高或更低，我似乎不应该费心显示平均值。

所以给定一个参数@userId，有没有办法从RecipeRatings 表中选择一个食谱列表以及当前用户的评分（如果有的话），否则是平均值（如果有的话）？

拥有AverageRating 和MyRating 列也很好，这将由客户端来正确显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:33:03.873

你可以试试这个：

```
SELECT
    R.RecipeId,
    R.Name,
    AVG(RR.Rating) AS AverageRating,
    MAX(CASE WHEN RR.UserId = @userId THEN RR.Rating END) AS MyRating
FROM Recipes AS R
LEFT JOIN RecipeRatings AS RR
ON RR.RecipeId = R.RecipeId
GROUP BY R.RecipeId, R.Name
ORDER BY AverageRating DESC 
```

如果您想显示`MyRating`它是否不为空，否则`AverageRating`您可以查看该`COALESCE`函数。

```
COALESCE(MAX(CASE WHEN RR.UserId = @userId THEN RR.Rating END),
         AVG(RR.Rating) AS ActualRating 
```

我还将您的 INNER JOIN 更改为 LEFT JOIN，这样没有任何评级的食谱仍然可以显示在结果中。

# html - 两个 tr 标签之间没有空格

> ID：10607532
> 
> 赞同：-4
> 
> 时间：2012-05-15T19:30:22.333
> 
> 标签：html

我似乎无法减少两个 TR 标签之间的空间。我有以下代码。我不希望两个 tr 标签之间有任何空格。

```
 <table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-        color:#d7d6d4" > 
    <tr   > 
    <td align="center" style="height:0px; line-height:0px; background:#932a28;         border:0; border-bottom:0"> 
              <asp:Image ID="newLogo" runat="server"  ImageUrl="~/images/middle_logo_top.jpg"/> 

    </td> 

</tr> 

<tr > 
    <td  align="center" style="height:10px;  background:#e5e0dd"> 
         <asp:Image ID="Image1" runat="server" ImageUrl="~/images/middle_logo_btm.jpg"/> 

    </td> 
</tr> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:45:33.560

不确定您要问什么 - 删除标记中的空格或删除浏览器表示的标记中的空格？

如果是后者，你最好学习一些 CSS，那么你可以删除内联样式，停止使用表格进行布局，并将**display:block**和其他助手附加到对象上，以掌握你的演示工作......

```
<style type="text/css">

   div , div img { display:block }
   .fl { float:left; }

</style>

<div class="fl"><img src="image1.jpg alt=""/></div>
<div class="fl"><img src="image2.jpg alt=""/></div> 
```

和你的桌子一样，可能会解决空间问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:48:20.580

我认为您应该使用 CSS 进行布局并停止使用表格。

看看这个：[http ://sixrevisions.com/web-standards/20-html-best-practices-you-should-follow/](http://sixrevisions.com/web-standards/20-html-best-practices-you-should-follow/)

# ruby-on-rails - 如何在一对多关联中返回父级？

> ID：10607533
> 
> 赞同：0
> 
> 时间：2012-05-15T19:30:26.743
> 
> 标签：ruby-on-rails, activerecord

**导轨 3.0.4**

鉴于以下关系

```
class Child < ActiveRecord::Base
  belongs_to   :parent
end

class Parent < ActiveRecord::Base
   has_many  :children
end 
```

使用

```
@parents = Parent.find(:all, :include => :children) 
```

将返回每个父母及其孩子。

每个孩子如何还包括对其父母的引用，以便在序列化期间使用？

例如，采用 JSON 格式，如下所示：

```
[
    {
        "parent": {
            "created_at": "2012-05-05T11:29:19Z",
            "id": 1,
            "updated_at": "2012-05-05T11:29:19Z",
            "children": [
                {
                    "created_at": "2012-05-05T11:35:05Z",
                    "id": 1,
                    "updated_at": "2012-05-05T11:35:05Z",
                    "parent": {
                        "created_at": "2012-05-05T11:29:19Z",
                        "id": 1,
                        "updated_at": "2012-05-05T11:29:19Z"
                    }
                }
            ]
        }
    }
] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:48:03.227

您应该覆盖模型`to_json`上的方法`Child`：

```
class Child
  belongs_to :parent

  def to_json
    attributes.merge(parent: parent.attributes).to_json
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:56:08.050

```
@parents = Parent.find(:all, :include => {:children => :parent}) 
```

# installation - 使用 yum 安装 Aptana Studio 3

> ID：10607534
> 
> 赞同：4
> 
> 时间：2012-05-15T19:30:30.040
> 
> 标签：installation, aptana3, yum

是否可以通过 yum 安装 aptana studio（独立版本），以便它出现在我的菜单中？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-09T15:31:04.283

我只是在没有 Yum 的情况下完成的，所以我会写下来。Fedora 16 Aptana 安装没有 yum 包括图标

[从http://aptana.org/products/studio3/download](http://aptana.org/products/studio3/download)下载您的版本，然后将 Aptana 3 解压缩到一个文件夹中。

打开根 shell 并将提取的文件夹移动到 /usr/local/bin 或您安装的任何位置。

```
mv Aptana_Studio_3 /usr/local/bin/ 
```

去那里。

```
cd /usr/local/bin/Aptana_Studio_3 
```

如果您希望能够从 shell 启动它，请将其添加到系统路径中：

```
nano ~/.bashrc 
```

添加/编辑 PATH 行以包含您的 aptana 目录：

```
PATH=$PATH:/usr/local/bin/Aptana_Studio_3 
```

保存/退出并打开一个新的外壳。测试您是否可以启动它。

```
AptanaStudio3 
```

仍然在您刚刚创建的文件夹中，创建一个符号链接，以便更容易启动：

```
ln -s AptanaStudio3 aptana 
```

测试符号链接

```
aptana 
```

在 gnome 3 中以 root 身份添加图标：

```
cd /usr/share/applications 
```

创建一个新文件

```
nano aptana-studio-3.desktop 
```

将此添加到文件中（根据您之前放置的位置编辑路径）：

```
[Desktop Entry]
Name=Aptana Studio 3
Exec=/usr/local/bin/Aptana_Studio_3/aptana
Icon=/usr/local/bin/Aptana_Studio_3/icon.xpm
Type=Application
Categories=Development 
```

保存。

完毕。

注意 - 这不会把 aptana 放在每个人的 PATH 中，只是你自己。您可以编辑 /etc/.bashrc 或其他全局环境配置文件以确保每个人都拥有它。

然而，在这个例子中，每个人都会在他们的菜单中找到它。

如果需要，从那里打开 Applications 菜单 -> Programming 并将 aptana 拖到您的 Dock 上。

这适用于 fc16 compiz 桌面，但应该适用于其他最近的 redhat 风格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-31T02:26:40.643

两个附加说明：

*   `gedit ~/.bash_profile`也可以针对单个路径进行编辑，默认情况下，每个 GNOME 安装都会附带它，以防您没有 nano。
*   万一编辑完路径变量后不能吃午饭`AptanaStudio3`，需要自己刷新路径变量。您可以执行此操作，您可以键入`PATH=$PATH:/opt/Aptana_Studio_3`，此路径是您用于安装 Aptana Studio 3 的路径

# android - 如何在活动中嵌入 web 视图而不是打开另一个窗口

> ID：10607535
> 
> 赞同：2
> 
> 时间：2012-05-15T19:30:38.397
> 
> 标签：android, webview

所以在我的应用程序中，我使用 webview 来显示一些 web 内容，我使用了带有 loadURL() 函数的 webview，但是，网页在另一个窗口中打开，我想显示带有活动的网页，沿着活动的其他视图和组件

更新：已解决，请参阅这篇文章：[Opening webview not in new browser](https://stackoverflow.com/questions/5561709/opening-webview-not-in-new-browser)

# php - 是否有任何原生 PHP 函数会引发内置异常？

> ID：10607539
> 
> 赞同：10
> 
> 时间：2012-05-15T19:31:17.820
> 
> 标签：php, exception, spl

在回答[PHP rename() 不会在错误时引发异常时，](https://stackoverflow.com/a/10607435/22470)我想知道除了[SPL](http://php.net/manual/book.spl.php)的东西之外，是否有任何原生 PHP 函数会引发内置的[Exception ？](http://php.net/manual/language.exceptions.php)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T19:34:40.720

[PDO 可以配置为抛出异常](http://php.net/manual/en/class.pdoexception.php)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-05-15T19:35:50.067

并不真地。如果您阅读了您链接的该页面上的注释：

> **笔记：**
> 
> 内部 PHP 函数主要使用[错误报告](http://php.net/errorfunc.configuration.php#ini.error-reporting)，**只有现代[面向对象的](http://php.net/language.oop5.php)扩展使用异常**。但是，可以使用[ErrorException](http://php.net/class.errorexception.php)将错误简单地转换为异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T19:36:01.193

PHP 5 具有类似于其他编程语言的异常模型。

[错误异常](http://www.php.net/manual/en/class.errorexception.php)

# python - Django virtualenv，pythonpath 问题

> ID：10607543
> 
> 赞同：1
> 
> 时间：2012-05-15T19:31:57.530
> 
> 标签：python, django, virtualenv, wsgi

我正在尝试使用 virtualenv 部署 django 应用程序，但我不是 linux 专家用户。

它在共享主机上。如果我输入 python 我得到了 python 2.4 控制台。如果是 python2.7 类型，我得到了 2.7 控制台。

我想用2.7。

1.  我在我的私有 .site-packages 中安装了带有 setuptools 的 virtualenv。
2.  我使用 python 2.7 创建了我的环境： .site-packages/virtualenv --no-site-packages -p python2.7 env
3.  我激活了我的环境并安装了我需要的软件包。
4.  我配置（尝试）我的 .wsgi 以使用 env

我在第 4 步已经 2 天了。服务器有一些预安装的模块，它们位于 sys.path 上。例如，它安装了 django，但我想使用安装在我的 virtualenv 中的模块。

我阅读了几个 wsgi 文档，然后得出了这个结论：

```
import sys, os, site

sys.stdout = sys.stderr

os.environ['PYTHON_EGG_CACHE'] = '/home/bruddennautica/apps_wsgi/.python-eggs'
os.environ['DJANGO_SETTINGS_MODULE'] = "brudden.settings"

sys.path.append('/home/bruddennautica/apps_wsgi')
sys.path.append('/home/bruddennautica/apps_wsgi/env/lib/python2.7/site-packages')

activate_this = '/home/bruddennautica/apps_wsgi/env/bin/activate_this.py'
execfile(activate_this, dict(__file__=activate_this))

import django.core.handlers.wsgi
application = django.core.handlers.wsgi.WSGIHandler() 
```

有了这个 conf，我得到了一个 django 错误，它向我展示了一些东西。django错误并不重要，这是因为django版本不等于我安装在我的virtualenv中的那个，python版本也是。

打印：[http ://dl.dropbox.com/u/9290581/error.png](http://dl.dropbox.com/u/9290581/error.png)

可以看到 python 路径条目，其中大多数不是来自 virtualenv。第一个是：/home/bruddennautica/apps_wsgi/env/lib/python2.4/site-packages。但是这个文件夹不存在。显然它是由 activate_this.py 在第 22 行添加的：

```
site_packages = os.path.join(base, 'lib', 'python%s' % sys.version[:3], 'site-packages') 
```

任何人都可以帮助我吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T03:04:42.753

如果您的 mod_wsgi 是为 Python 2.4 编译的，则不能使用 Python 2.7。您甚至不能将 mod_wsgi 指向使用 Python 2.7 构建的虚拟环境。您唯一的选择是安装一个针对 mod_wsgi 编译的 mod_wsgi，或者从二进制发行包（如果可用），或者通过您自己针对正确的 Python 版本从源代码编译 mod_wsgi。

现在看来您可能正在混合 Python 版本，这是您无法做到的，并且会导致包括崩溃在内的错误。您需要找出编译的 Python mod_wsgi 版本。

看：

[http://code.google.com/p/modwsgi/wiki/CheckingYourInstallation#Python_Shared_Library](http://code.google.com/p/modwsgi/wiki/CheckingYourInstallation#Python_Shared_Library)

找出这一点的一种方法。

# c# - 使用当前登录用户通过 SMTP 客户端发送电子邮件

> ID：10607547
> 
> 赞同：1
> 
> 时间：2012-05-15T19:32:21.537
> 
> 标签：c#, asp.net

我已经设置了一些通过 LDAP 进行表单身份验证的网站。当前登录的用户单击按钮时，我正在发送电子邮件，但是电子邮件是从我的地址发送的，而不是从用户发送的。这造成了一些混乱。

我想要做的是使用登录的用户帐户发送电子邮件，而无需他们再次输入他们的用户信息。

我基本上想这样做：

```
 MailMessage message = new MailMessage();
    message.From = new MailAddress(User.GetIdentity);
    message.Subject = Subject;
    message.Body = body;
    message.IsBodyHtml = true;
    SmtpClient client = new SmtpClient("address.qweqwe", 25);
    client.Credentials = new System.Net.NetworkCredential(User.Identity);
    client.Send(message); 
```

获取用户的电子邮件并不是什么大问题，我已经有了相应的方法，但我不确定我应该如何获取他们的凭据。他们已经登录以访问该页面，而且我知道他们有一封 LDAP 电子邮件。

有什么方法可以做到这一点，而无需强迫用户再次登录以发送电子邮件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:47:45.050

如果您的 SMTP 服务器需要凭据，我可以看到 2 个解决方案。

1.  从他们的网络凭据（用户名/密码）中通过页面询问用户

2.  设置一个有权代表所有用户中继的帐户。这将允许您为 SMTP 服务器设置一个帐户。然后，每次发送电子邮件时，您要做的就是更改 MailMessage.From 属性。

# c# - WPF - 将 UserControl 可见性绑定到属性

> ID：10607548
> 
> 赞同：17
> 
> 时间：2012-05-15T19:32:24.247
> 
> 标签：c#, wpf, xaml, binding, controltemplate

我有一个绑定到 ObservableCollection 的 ListView。数据从 Internet 加载，然后添加到集合中。下载需要几秒钟，我想告诉用户数据正在加载。

我创建了一个指示活动的 UserControl。我把它放在 ControlTemplate 里面。

```
<ControlTemplate x:Key="ListViewControlTemplate1" TargetType="{x:Type ListView}">
    <Grid>
        <local:ActivityIndicatorControl 
            HorizontalAlignment="Center" 
            Height="Auto" 
            Margin="0" 
            VerticalAlignment="Center"/>
    </Grid>
</ControlTemplate> 
```

我想将 Visibility 绑定`ActivityIndicatorControl`到一个属性，比如说`bool IsLoading`并相应地将其设置为 Visible/Collapsed。

谢谢！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-05-15T19:34:39.120

我建议使用 a[`IValueConverter`](http://msdn.microsoft.com/en-us/library/system.windows.data.ivalueconverter.aspx)来接受您的布尔值，并返回 Visibility 枚举的成员。

这是一个很好的例子：http: [//jeffhandley.com/archive/2008/10/27/binding-converters---visibilityconverter.aspx](http://jeffhandley.com/archive/2008/10/27/binding-converters---visibilityconverter.aspx)

XAML 看起来像这样：

首先，您为转换器定义一个资源（将其放入资源字典中）：

```
<local:BooleanToVisibilityConverter x:Key="myBoolToVisibilityConverter" /> 
```

然后像这样更改您的模板：

```
<ControlTemplate x:Key="ListViewControlTemplate1" TargetType="{x:Type ListView}">
    <Grid Visibility="{Binding IsLoading, Converter={StaticResource myBoolToVisibilityConverter}}">
        <local:ActivityIndicatorControl 
            HorizontalAlignment="Center" 
            Height="Auto" 
            Margin="0" 
            VerticalAlignment="Center"/>
    </Grid>
</ControlTemplate> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-31T17:14:51.577

# 使用 .NET 的内置转换器

.NET 3 有一个内置的[BooleanToVisibilityConverter](https://msdn.microsoft.com/en-us/library/system.windows.controls.booleantovisibilityconverter(v=vs.110).aspx)。

（注意：可能并非在所有平台上都可用，例如：移动）

首先将其添加到您的资源中

```
<UserControl.Resources>
    <BooleanToVisibilityConverter x:Key="bool2vis"></BooleanToVisibilityConverter>
</UserControl.Resources> 
```

然后在一个元素上使用它

```
<Label Visibility="{Binding IsSomeProperty, Converter={StaticResource bool2vis}}" /> 
```

# 反相

[如何反转 BooleanToVisibilityConverter？](https://stackoverflow.com/questions/534575/how-do-i-invert-booleantovisibilityconverter)

如果你想反转转换器（例如：当你的属性为真时隐藏元素），这个答案有一个自定义实现`IValueConverter`，通过 XAML 支持它

```
<Application.Resources>
    <app:BooleanToVisibilityConverter 
        x:Key="BooleanToVisibilityConverter" 
        True="Collapsed" 
        False="Visible" />
</Application.Resources> 
```

# python - Python多处理队列：接收进程退出时该怎么办？

> ID：10607553
> 
> 赞同：4
> 
> 时间：2012-05-15T19:32:36.593
> 
> 标签：python, queue, multiprocessing

基本上我有以下代码：

```
import multiprocessing
import time

class MyProcess(multiprocessing.Process):

    def __init__(self, ):
        multiprocessing.Process.__init__(self)
        self.queue = multiprocessing.Queue()

    def run(self):
        print "Subprocess starting!"
        time.sleep(4)
        print "Subprocess exiting!"

    def addToQueue(self):
        starttime = time.time()
        count=0
        print "Adding stuff to queue..."
        while time.time()-starttime  < 4:
            self.queue.put("string")
            count += 1
        print "Added %d objects!" % count

        #self.queue.close()

if __name__ == "__main__":
    process = MyProcess()
    process.start()
    print "Waiting for a while"
    time.sleep(2)
    process.addToQueue()
    time.sleep(1)
    print "Child process state: %d" % process.is_alive() 
```

当主进程完成时，它不会退出。什么都没有发生，它只是阻塞。我发现退出的唯一方法是杀死它（不是 SIGTERM，SIGKILL）。

如果我使用该注释行，它会退出但会发出 IOError。

我查看了 multiprocessing.queue 的代码，它使用了在另一个线程 (threading.Thread) 中生成的 os.pipe()。我怀疑是线程在写入管道时阻塞，并且当使用 close() 方法时，它会引发 IOError。

所以我的问题是：有没有更清洁的方法来处理这个问题？

我的意思是，我有这种情况，其中一个队列不断被写入。当接收进程退出（干净与否）时，我应该关闭队列并在发送者进程上获得 IOError 吗？

编辑：过程的输出

```
Waiting for a while
Subprocess starting!
Adding stuff to queue...
Subprocess exiting!
Added 1822174 objects!
Traceback (most recent call last):
  File "/usr/lib/python2.7/multiprocessing/queues.py", line 266, in _feed
    send(obj)
IOError: [Errno 32] Broken pipe
Child process state: 0 
```

这部分仅在使用注释的 self.queue.close() 时发生：

```
Traceback (most recent call last):
  File "/usr/lib/python2.7/multiprocessing/queues.py", line 266, in _feed
    send(obj)
IOError: [Errno 32] Broken pipe 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-05-17T15:14:40.417

我正在回答我自己的问题，因为不是每个人都会阅读评论。在评论中用户 mata 的提示之后，我测试了问题中的示例代码，在`time.sleep(0.01)`将对象添加到队列的循环内部添加了一个调用，因此我可以限制将添加到队列中的对象数量：

```
def addToQueue(self):
        starttime = time.time()
        count=0
        print "Adding stuff to queue..."
        while time.time()-starttime  < 4:
            self.queue.put("string")
            count += 1
            time.sleep(0.01)
        print "Added %d objects!" % count 
```

因此，当对象数量较少时（在本例中少于 3800），进程会正常退出。但是当有很多对象时，进程之间的管道似乎有一些锁定。

但这对我提出了另一个问题：这是一个错误吗？我应该报告吗？或者这只是正常的预期行为？

非常感谢用户 mata 指出这种可能性！

# objective-c - 核心数据 - 可以建模 OR 关系

> ID：10607554
> 
> 赞同：0
> 
> 时间：2012-05-15T19:32:36.637
> 
> 标签：objective-c, core-data

假设我有一个名为`EntityA`. `EntityB`EntityA 与和有关系`EntityC`。EntityB 和 EntityC 都不是强制关系，但必须选择其中之一。

是否可以在 Core Data 中对此进行建模？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:37:10.633

如果 EntityB 和 EntityC 有一个共同的超类，那么您可能需要该类型的关系。

也就是说，我听说你应该远离 Core Data 中的类层次结构。

YMMV

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T19:41:45.717

# android - 准备好使用持久对象的最佳方法

> ID：10607555
> 
> 赞同：0
> 
> 时间：2012-05-15T19:32:42.507
> 
> 标签：android, service, broadcastreceiver

也许有一些类似我的问题，但经过长时间的搜索，我找不到任何问题！

我有一个对象（OntologyHandler），其中填充了一些 Activity 和 BroadcastReceiver 使用的 rdf 文件。这个 OntologyHandler 加载起来真的很重，当我启动 Activity 时并不重要，因为我有一个“请稍候”消息。

但是BroadcastReceiver是在手机有来电的时候启动的，所以一定要尽可能快的执行，而且加载OntologyHandler对象需要7/8秒的时间真的是很多时间。

因此，我想在启动手机后仅加载一次 OntologyHandler，并使其对 Activity 或 BroadcastReceiver 的每次访问都保持快速可用。

你能告诉我任何建议吗？

- - 编辑 - -

实际上，我所拥有的是：

*   本体处理程序：

    ```
    public class OntologyHandler {
        private static OntologyHandler instance;

        private OntologyHandler() {
            //loadOntology() is the method that spend a lot of time to terminate.
            loadOntology();
        }

        public synchronized static OntologyHandler getInstance()
        {
            if(instance == null)
            {
                instance = new OntologyHandler();
            }
            return instance;
        }

        public synchronized static void setInstance(OntologyHandler inst)
        {
            instance = inst;
        }

        public synchronized static boolean isInstanceLoaded()
        {
            return instance != null;
        }

        private void loadOntology()
        {
            //load the rdf files...
        }
    } 
    ```

*   首次加载 OntologyHandler 的 Service，由侦听`android.intent.action.MEDIA_MOUNTED`Intent 的 BroadcastReceiver 启动：

    ```
    public class OntologyPreLoaderService extends IntentService {

        private OntologyHandler handler;

            public OntologyPreLoaderService() {
                super(OntologyPreLoaderService.class.getName());
            }

            @Override
            protected void onHandleIntent(Intent intent) {

            if (handler == null) {

                //I use a thread because the Process is executed in the main thread of the app, 
                //so, if the user starts the Activity he has no black screen while loading Ontology, 
                //but a "Please wait" message in an AlertDialog, dismissed when the Activity can access the 
                //OntologyHandler.getInstance(); synchronized static method
                new Thread() {
                    public void run() {
                        handler = OntologyHandler.getInstance();
                    }
                }.start();

            } else {
                OntologyHandler.setInstance(handler);
            }
        }
    } 
    ```

Activity 和`PHONE_STATE`Intent BroadcastReceiver 都调用这个服务来加载本体。问题是，在挂载 SD 卡后（在手机启动时），`OntologyPreLoaderService`正确加载了本体，但是在完成`onHandleIntent`方法时，应用程序进程终止，所以当 Activity 或手机 BroadcastReceiver 调用它时，`handler`服务的字段总是null 并且服务必须再次重新加载本体。

但我希望，一旦加载，服务维护 OntologyHandler 实例，即使它结束工作并再次重新唤醒或类似的东西。

希望你能理解我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:26:52.007

您可以实现在手机启动时启动加载的部分，这会将数据保存在内存中，以供应用程序的其他部分在需要时使用`OntologyHandler`。`Service`

但是，像这样保持大量内存绑定必然会导致问题。您能否重新评估您的应用程序，看看您是否可以用另一种方式表示 RDF 文件中的数据，以便可以在需要时以较小的部分加载它们？

了解您的应用程序要完成的任务会很有帮助。当特定患者呼叫医生的智能手机时，目标是显示患者的医疗文件吗？

# asp.net-mvc - 如何从加密的 cookie 中读取值？

> ID：10607559
> 
> 赞同：0
> 
> 时间：2012-05-15T19:32:49.280
> 
> 标签：asp.net-mvc, asp.net-mvc-3

如果用户选中记住我复选框，我有一个登录控制器，它正在设置一个 cookie，但是如果用户下次访问我的网站并且 cookie 尚未过期，我想这样做，所以我将他重定向到产品页面。

这是控制器动作

```
[HttpPost]
    public ActionResult Index(MyData data)
    {
        if (ModelState.IsValid)
        {
            if (data.UserName == "abc" && data.Password == "123")
            {
                if (data.RememberMe == true)
                {
                    var authTicket = new FormsAuthenticationTicket(1, data.UserName, DateTime.Now, DateTime.Now.AddMinutes(2), data.RememberMe,"");
                    HttpCookie cookie = new HttpCookie(FormsAuthentication.FormsCookieName, FormsAuthentication.Encrypt(authTicket));
                    Response.Cookies.Add(cookie);
                    return RedirectToAction("Index", "Products");
                }
                else
                {
                    return RedirectToAction("Index", "Products");
                }
            }
            else
            {
                ModelState.AddModelError("", "Invalid User Name & Password");
            }
        }
        return View();
    } 
```

控制器的索引动作

```
 public ActionResult Index()
    {
        if(//logic which is i am asking about)
        {
          return RedirectToAction("Index", "Products");
        }
        return View();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:44:06.893

你试过这个吗？

```
if (Request.Cookies[FormsAuthentication.FormsCookieName] != null)
    {
      return RedirectToAction("Index", "Products");
    }
    return View();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:46:47.007

```
if (ControllerContext.HttpContext.User.Identity.IsAuthenticated) 
```

是你所需要的全部。解密和过期身份验证 cookie 是表单身份验证的职责。

# ipad - 忽略通用应用程序上的视网膜并强制视网膜 ipad 使用 ipad2 版本的应用程序

> ID：10607561
> 
> 赞同：-1
> 
> 时间：2012-05-15T19:32:57.610
> 
> 标签：ipad

如何强制应用程序运行 ipad2 版本的通用应用程序而忽略视网膜 ipad 上的视网膜 ipad？你可以删除你没有开发的游戏的视网膜资产，以便你可以使用 ipad2 版本而不是视网膜版本吗？info.plist、resource.plist 等中是否有任何可以更改的内容，以便应用程序的 Ipad2 版本而不是 Retina 版本运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:07:08.763

在大多数情况下，从 Xcode 项目中移除所有 Retina 资源就足够了。

# javascript - JavaScript replace() 大写或小写

> ID：10607569
> 
> 赞同：4
> 
> 时间：2012-05-15T19:33:25.670
> 
> 标签：javascript, replace

我想使用这个函数，但保留大写或小写，例如有类似的东西

```
var value = 'Replace a string';

var search = 'replace';

value.replace(search, "<span style='font-weight: bold'>"+search+'<span>'); 
```

并且 value 的输出是：

**替换**字符串

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-15T19:36:06.503

由于您将单词本身保留原样，因此可以使用简单的正则表达式：

```
var value = 'Replace a string';
var search = /replace/i;
value = value.replace(search, "<span style='font-weight: bold'>$&</span>"); 
```

`$&`表示匹配的模式。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-05-15T19:35:04.300

制作`search`一个正则表达式并在组中捕获不区分大小写的“替换”：

```
var search = /(replace)/i; 
```

然后，在`<span>`标签内用组替换单词：

```
value.replace(search, '<span style="font-weight: bold">$1<span>'); 
```

# php - php 中的 Desk.com OAuth 问题

> ID：10607570
> 
> 赞同：1
> 
> 时间：2012-05-15T19:33:28.107
> 
> 标签：php, oauth, salesforce

我正在尝试使用以下代码连接到我们的 CRM 平台：

[https://gist.github.com/2564090](https://gist.github.com/2564090)

但它在第 28 行完全失败：

$oauth = 新 OAuth($consumer_key, $consumer_secret);

我需要做些什么来实例化一个新的 OAuth 对象吗？我应该指的是某个库或包含文件吗？还是我必须在我的 php.ini 配置文件中启用某些东西？为什么“新 OAuth()”对我不起作用？我得到的只是：500 - 内部服务器错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-05-08T10:28:26.917

正如 Paul 所说，您需要安装 PECL 扩展[http://it2.php.net/oauth](http://it2.php.net/oauth)

一旦你安装了你的扩展，你就可以创建一种方法，就像我写的连接到 API 的方法一样。如您所见，我定义了一个私有方法，该方法存储在我命名为 Desk_Client 的 Client 类中。如果您需要执行多个请求，最好将 oAuth 对象创建移动到类构造函数中并将其存储到实例变量中。

```
const API_URL = "https://YOURSITE.desk.com/api/v2/"; 

// Access token & secret (Click [Your Access Token] on App Listing) 
// https://[yoursite].desk.com/admin/settings/api-applications)
const ACCESS_TOKEN = "*****";
const ACCESS_SECRET = "*****";

// Application key and secret found here: 
// https://[yoursite].desk.com/admin/settings/api-applications
const CONSUMER_KEY = "*****";
const CONSUMER_SECRET = "*****";

/**
 * Utility method to perform a request to the Desk.com API.
 *
 * @param string $actionPath - The relative path to an API action (e.g. companies)
 * @param array $params - Array containing key value parameters for the request
 * @param string $request - POST, GET, PUT, PATCH
 * @return Array
 */
private function _performRequest($actionPath, $params = null, $request = OAUTH_HTTP_METHOD_GET) {

    $url = self::API_URL.$actionPath;

    try {
        $oauth = new OAuth(CONSUMER_KEY, CONSUMER_SECRET);
        $oauth->setToken(ACCESS_TOKEN, ACCESS_SECRET);
        $oauth->disableSSLChecks();

        switch ($request) {
            case OAUTH_HTTP_METHOD_GET:
                // Add get params to the url.
                $url .= ($params && $request === "GET") ? "?".http_build_query($params) : "";
                $oauth->fetch($url);
                break;

            case OAUTH_HTTP_METHOD_POST:
                $oauth->fetch($url, json_encode($params), OAUTH_HTTP_METHOD_POST);
                break;

            default:
                $oauth->fetch($url, json_encode($params), OAUTH_HTTP_METHOD_PUT);
        }
        $result = $oauth->getLastResponse();
    }
    catch(Exception $e) {
        error_log("Error: ".$e->getCode()." - ".$e->getMessage());
    }

    return json_decode($result);
} 
```

我正在分享这段代码，因为desk.com Api 文档只提供了一个示例Ruby 片段，我希望这段代码可以节省一些时间

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T17:14:39.713

例如，您需要从 pecl 安装 OAuth

# between - 在 Fusion-Tables 中显示两个值之间的行

> ID：10607571
> 
> 赞同：0
> 
> 时间：2012-05-15T19:33:34.187
> 
> 标签：between, google-fusion-tables

我试图弄清楚这个 Fusion-Tables，我只想显示评估值在 500,000 到 750,000 之间的行。我已经能够弄清楚如何显示超过 500,000 的任何内容，但我不知道如何获得两个值之间的任何内容。

```
<script type="text/javascript">
    function changeByAssessedValue(formResults) {
        layer.setQuery("SELECT 'Address' FROM " + tableid + " WHERE 'Assessed Value' > '"+ formResults+ "'");
    }
</script> 
```

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:44:18.403

`BETWEEN`Fusion Tables中没有类似的关键字（有关详细信息，请参阅[SQL 参考](https://developers.google.com/fusiontables/docs/developers_reference#Select)）。但是使用可以使用关键字组合的两个条件很容易完成您想要的操作`AND`：

```
 SELECT 'Address' 
  FROM   1234
  WHERE  'Assessed Value' > 500000
  AND    'Assessed Value' < 750000 
```

请记住使用值“500,000”`>=`和`<=`“750,000”是否应包含在结果中。

# ruby-on-rails - 我在我的 Ruby on Rails 项目中的视图有一些问题

> ID：10607572
> 
> 赞同：1
> 
> 时间：2012-05-15T19:33:43.053
> 
> 标签：ruby-on-rails, networking, network-programming, ruby-on-rails-2

我正在尝试为我的建筑物中的网络创建一个 ruby​​ on rails。我想用有很多端口的交换机来设置它，每个端口都有一个名称、插孔和房间。

尝试查看开关时出现以下错误：

```
undefined method `port' for #<Switch:0x2b49d7643c90> 
```

提取的源代码（在第 2 行附近）：

```
1: <h1><%= @switch.title %></h1>
2: <p><strong>Switch :</strong> <%= @switch.port.name %><br />
3: </p>
4: <p><%= @switch.description %></p>
5: <hr /> 
```

这是我的控制器方法：

```
class SwitchController < ApplicationController
    def list
            @switches = Switch.find(:all)
    end
    def show
            @switch = Switch.find(params[:id])
    end
    def new
            @switch = Switch.new
    end
    def create
            @switch = Switch.new(params[:switch])
            if @switch.save
                    redirect_to :action => 'list'
            else
                    @ports = Port.find(:all)
                    render :action => 'new'
            end
    end
    def edit
            @switch = Switch.find(params[:id])
            @ports = Port.find(:all)
    end
    def update
            @switch = Switch.find(params[:id])
            if @switch.update_attributes(params[:switch])
                    redirect_to :action => 'show', :id => @switch
            else
                    @ports = Port.find(:all)
                    render :action => 'edit'
            end
    end
    def delete
            Switch.find(params[:id]).destroy
            redirect_to :action => 'list'
    end
    def show_ports
            @port = Port.find(params[:id])
    end 
```

结尾

这是我的模型：

```
class Switch < ActiveRecord::Base
   has_many :ports
   validates_uniqueness_of :title
end

class Port < ActiveRecord::Base
   belongs_to :switch
   validates_presence_of :name
   validates_presence_of :jack
   validates_presence_of :room
end 
```

这是我的迁移：

```
class Switches < ActiveRecord::Migration
  def self.up
     create_table :switches do |t|
        t.string     :title
        t.text       :description
     end
  end
  def self.down
    drop_table :switches
  end
end

class Ports < ActiveRecord::Migration
  def self.up
     create_table :ports do |t|
        t.string     :name
        t.string     :jack
        t.string     :room
     end
     Port.create :name => "1/0/1"
  end
  def self.down
    drop_table :ports
  end
end 
```

最后，这是我的 show.html.erb

```
<h1><%= @switch.title %></h1>
<p><strong>Switch :</strong> <%= @switch.port.name %><br />
</p>
<p><%= @switch.description %></p>
<hr />
<%= link_to 'Back', {:action => 'list'} %> 
```

我知道我在某处遗漏了一些关键代码，在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-21T17:31:35.947

如果 Switch 有很多端口，则没有属性`port`，只是`ports`，它是一个集合（零个、一个或多个端口）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-21T17:32:36.400

看起来问题是您在`@switch.port`需要访问时尝试访问`@switch.ports`（注意复数）。由于交换机有许多端口，因此关系具有复数名称。要为视图中的每个端口打印一些东西，你需要这样的东西：

```
<h1><%= @switch.title %></h1>
<%- @switch.ports.each do |port| %>
  <p><strong>Switch :</strong> <%= port.name %><br />
  </p>
<%- end %>
<p><%= @switch.description %></p>
<hr />
<%= link_to 'Back', {:action => 'list'} %> 
```

# javascript - javascript click 事件、keypress 事件和 doc 就绪 - 使函数更高效

> ID：10607573
> 
> 赞同：0
> 
> 时间：2012-05-15T19:33:45.367
> 
> 标签：javascript, jquery, performance

```
$(document).ready(function(){
    iframeSize()
});

$("html").live("click", function( event ){
    iframeSize()
});
$("html").live("keypress", function( event ){
    iframeSize();
});

// resize dialog and iframe when contents change document height
function iframeSize(){
    var iframeHeight = $(document).height();
    window.parent.$('#loginLayer').attr('height', iframeHeight);
    window.parent.$('#loginDialog').css('height', iframeHeight);
} 
```

这段代码能写得更高效吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:44:19.327

为什么不直接将 iFrameSize 函数作为名称传递？而不是将其包装在另一个函数中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:59:36.330

你可以删除'live'然后做

```
$("body").click( function() { }); 
```

只需要'live'来告诉 jquery**重新检查**DOM 是否有新元素

（例如，如果一个新元素已添加到页面中，例如使用 .append()）

除此之外，您可以通过css/设置百分比高度和宽度（？）在父级中使用流体布局来实现您的iframe一致尺寸

# javascript - 如何获得“1.2.5.4”和“1.2.5.3”等字符串的最大值？

> ID：10607582
> 
> 赞同：3
> 
> 时间：2012-05-15T19:34:34.610
> 
> 标签：javascript

我有一个数组，其中的字符串由点分符号中的数字组成，如下所示：

```
var arr = ['1.2.5.4', '1.2.5.3']; 
```

我希望能够找到表示最高值的字符串。

我已经试过了

```
Math.max.apply(null, arr) 
```

由于有多个小数，它根本行不通。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:44:34.693

您需要为此创建自己的排序子例程，因为它们将被视为版本号。您需要进行左优先比较，比较由句点分隔的每个数字。

[这是从另一个答案](https://stackoverflow.com/questions/6832596/how-to-compare-software-version-number-using-js-only-number)中窃取的大量代码，与我提到的完全一样：

```
function assert(x) {
    if (!x) {
        alert("Assert failed");
        debugger;
    }
}

function isPositiveInteger(x) {
    // https://stackoverflow.com/a/1019526/11236
    return /^\d+$/.test(x);
}

/**
 * Compare two software version numbers (e.g. 1.7.1)
 * Returns:
 *
 *  0 if they're identical
 *  negative if v1 < v2
 *  positive if v1 > v2
 *  Nan if they in the wrong format
 *
 *  E.g.:
 *
 *  assert(version_number_compare("1.7.1", "1.6.10") > 0);
 *  assert(version_number_compare("1.7.1", "1.7.10") < 0);
 *
 *  "Unit tests": http://jsfiddle.net/ripper234/Xv9WL/28/
 *
 *  Taken from https://stackoverflow.com/a/6832721/11236
 */
function compareVersionNumbers(v1, v2){
    var v1parts = v1.split('.');
    var v2parts = v2.split('.');

    // First, validate both numbers are true version numbers
    function validateParts(parts) {
        for (var i = 0; i < parts.length; ++i) {
            if (!isPositiveInteger(parts[i])) {
                return false;
            }
        }
        return true;
    }
    if (!validateParts(v1parts) || !validateParts(v2parts)) {
        return NaN;
    }

    for (var i = 0; i < v1parts.length; ++i) {
        if (v2parts.length === i) {
            return 1;
        }

        if (v1parts[i] === v2parts[i]) {
            continue;
        }
        if (v1parts[i] > v2parts[i]) {
            return 1;
        }
        return -1;
    }

    if (v1parts.length != v2parts.length) {
        return -1;
    }

    return 0;
}

assert(compareVersionNumbers("1.7.1", "1.7.10") < 0);
assert(compareVersionNumbers("1.6.1", "1.7.10") < 0);
assert(compareVersionNumbers("1.6.20", "1.7.10") < 0);
assert(compareVersionNumbers("1.7.1", "1.7.10") < 0);
assert(compareVersionNumbers("1.7", "1.7.0") < 0);
assert(compareVersionNumbers("1.7", "1.8.0") < 0);

assert(compareVersionNumbers("1.7.10", "1.7.1") > 0);
assert(compareVersionNumbers("1.7.10", "1.6.1") > 0);
assert(compareVersionNumbers("1.7.10", "1.6.20") > 0);
assert(compareVersionNumbers("1.7.0", "1.7") > 0);
assert(compareVersionNumbers("1.8.0", "1.7") > 0);

assert(compareVersionNumbers("1.7.10", "1.7.10") === 0);
assert(compareVersionNumbers("1.7", "1.7") === 0);

assert(isNaN(compareVersionNumbers("1.7", "1..7")));
assert(isNaN(compareVersionNumbers("1.7", "Bad")));
assert(isNaN(compareVersionNumbers("1..7", "1.7")));
assert(isNaN(compareVersionNumbers("Bad", "1.7")));

alert("All done");
​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-17T20:08:11.393

这似乎是一个更简单的解决方案：

```
function latest (versions) {
  versions.sort (function (a, b) {
    a = a.split ('.');
    b = b.split ('.');   
    for (var i = 0; i < a.length && i < b.length && a[i] === b[i]; i++);
    return ((i === a.length) || (+a[i] < +b[i])) ? 1 : -1;
  });
  return versions[0]; 
}

[
  latest (['1.2.5.4', '1.3.5.3', '1.2.3.4.5', '1.24.2.1', '1.2.52']),
  latest (['1.2.5.4', '1.3.5.3', '1.2.3.4.5', '1.2.52']),
  latest (['1.2.5.4', '1.2.3.4.5', '1.2.52']),
  latest (['1.2.5.4', '1.2.3.4.5'])
]

/* Displays on JS console

    ["1.24.2.1", "1.3.5.3", "1.2.52", "1.2.5.4"]
*/ 
```

感谢您的投票，在审查时我注意到我在上面的代码中更正了一个错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-09T10:14:10.760

在我看来，这是一个“更好”的解决方案（因为选中的那个会修改原始数组，这是邪恶的；））：

```
function latest(versions) {
    return versions.reduce(function(latest, current){
        var l = latest.split('.'),
            c = current.split('.');
        for (var i=0,len=Math.min(l.length, c.length); i<len; i++){
            if (+l[i] === +c[i]) {
                continue;
            } else {
                return +l[i] < +c[i] ? current : latest;
            }
        }
        return l.length < c.length ? current : latest;
    }, "0");
} 
```

结果与检查的答案完全相同，除了原始数组仍然是原始的。

```
[
  latest (['1.2.5.4', '1.3.5.3', '1.2.3.4.5', '1.24.2.1', '1.2.52']),
  latest (['1.2.5.4', '1.3.5.3', '1.2.3.4.5', '1.2.52']),
  latest (['1.2.5.4', '1.2.3.4.5', '1.2.52']),
  latest (['1.2.5.4', '1.2.3.4.5'])
]

/* Displays on JS console

    ["1.24.2.1", "1.3.5.3", "1.2.52", "1.2.5.4"]
*/ 
```

它利用了`reduce`专门为此用途而设计的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T19:57:15.507

这是一个人工排序的实现：

```
Array.prototype.humanSort = function() {
  return this.sort(function(a, b) {
    aa = a.split('.');
    bb = b.split('.');

    for(var x = 0; x < Math.max(aa.length, bb.length); x++) {
      if(aa[x] != bb[x]) {
        var cmp1 = (isNaN(parseInt(aa[x],10)))? aa[x] : parseInt(aa[x],10);
        var cmp2 = (isNaN(parseInt(bb[x],10)))? bb[x] : parseInt(bb[x],10);
        if(cmp1 == undefined || cmp2 == undefined)
          return aa.length - bb.length;
        else
          return (cmp1 < cmp2) ? -1 : 1;
      }
    }
    return 0;
  });
} 
```

像这样称呼它：

```
 ['1.12.5.4', '1.2.5.3'].humanSort(); // => ['1.2.5.3', '1.12.5.4'] 
```

# java - 定义令牌“组”

> ID：10607588
> 
> 赞同：1
> 
> 时间：2012-05-15T19:34:51.493
> 
> 标签：java, parsing, javacc

我正在使用 JavaCC 开发一种简单语言的解析器。

在我的令牌声明部分，我有这样的东西

```
< CONSTANT: < INTEGER > | < FLOAT_NUMBER > | < BOOLEAN > >

< INTEGER: "0" | ("-")? ["1"-"9"](["0"-"9"])* | "0x" (["0"-"9"] | ["a"-"f"]  | ["A"-"F"])+ >
< FLOAT_NUMBER: ("-")? (["0"-"9"])+ "." (["0"-"9"])+ ("E" ("-")? (["0"-"9"])+)? ("D")? >
< BOOLEAN: "true" | "false"> 
```

`CONSTANT`，由于其顺序，优先级高于`INTEGER`。但是，在语法的某些部分我需要一个`INTEGER`，特别是。在这些情况下，解析器会抛出异常，因为`INTEGER`被解析为`CONSTANT`.

一个简单的解决方案是消除`CONSTANT`令牌并将其查找并替换为 `(< INTEGER > | < FLOAT_NUMBER > | < BOOLEAN >)`. 不过，这感觉相当笨拙。

有没有办法将`CONSTANT`其他标记简单地定义为一组，这样它`CONSTANT`本身就不是一个标记，而是 的简写`(< INTEGER > | < FLOAT_NUMBER > | < BOOLEAN >)`？

感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T20:09:17.350

我认为这里的简单答案是您不应该在标记器中执行此操作。

最好将其放入生产规则中，例如：

```
Token parseConstant() :
{
    Token t;    
}

{
    (
      t = < INTEGER > | t = < FLOAT_NUMBER > | t = < BOOLEAN >
    )
    {
      return t;
    }

} 
```

# c - 这两个循环哪个更快？

> ID：10607591
> 
> 赞同：2
> 
> 时间：2012-05-15T19:35:00.283
> 
> 标签：c, windows, performance, x86, 64-bit

我需要遍历一组字节，搜索一个 4 字节的值（所有 4 个字节都相同）。数据的长度是可变的，这些字节可以在数据中的任何位置；我正在寻找第一个实例。我试图找到最快的实现，因为这个逻辑在我的代码的关键部分运行。

这只会在 Windows 下的 x86 和 x64 上运行。

```
typedef unsigned char Byte;
typedef Byte* BytePtr;
typedef unsigned int UInt32;
typedef UInt32* UInt32Ptr;

const Byte MARKER_BYTE = 0xAA;
const UInt32 MARKER = 0xAAAAAAAA;

UInt32 nDataLength = ...;
BytePtr pData = ...;
BytePtr pEnd = pData + nDataLength - sizeof ( UInt32 );

// Option 1 -------------------------------------------
while ( pData < pEnd )
{
    if ( *( (UInt32Ptr) pData ) == MARKER )
    {
        ... // Do something here
        break;
    }

    pData++;
}

// Option 2 -------------------------------------------
while ( pData < pEnd )
{
    if ( ( *pData == MARKER_BYTE ) && ( *( (UInt32Ptr) pData ) == MARKER ) )
    {
        ... // Do something here
        break;
    }

    pData++;
} 
```

我认为`Option 2`更快，但我不确定我的推理是否正确。

`Option 1`首先从内存中读取 4 个字节，根据 4 字节常量检查它，如果没有找到，它会进入下一个字节并重新开始。从内存中准备好的下一个 4 字节将与已经读取的 3 个字节重叠，因此需要再次获取相同的字节。我的 4 字节标记之前的大多数字节将被读取两次。

`Option 2`一次只读取 1 个字节，如果该单个字节匹配，则从该地址读取完整的 4 字节值。这样，所有字节只被读取一次，并且只有 4 个匹配的字节被读取两次。

我的推理是正确的还是我忽略了什么？

在有人提出之前，是的，我确实需要执行这种优化。:)

**编辑**：请注意，此代码只能在基于 Intel / AMD 的计算机上运行。我不在乎其他架构是否无法运行它，只要普通的 x86/x64 计算机（台式机/服务器）运行它而不会出现问题或性能损失。

**编辑 2**：编译器是 VC++ 2008，如果有帮助的话。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T20:06:03.943

您也可以尝试 Boyer-Moore 方法。

```
pData = start + 3;
int i;

while(pData < pEnd) {
    for(i = 0; i < 4; ++i) {
        if (*(pData-i) != MARKER_BYTE) {
            pData += 4-i;
            break;
        }
    }
    if (i == 4) {
        /* do something here with (pData-3) */
        break;
    }
} 
```

如果幸运的话，它只测试每四个字节，直到找到匹配项。

对于这样的短模式，任何人都猜测这是否比测试每个字节更快或更慢。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T19:40:25.000

选项 1 将执行大量未对齐的内存访问。我不确定这是否适用于硬件。至少在某些硬件上，Windows 会拦截产生的异常，并且非常缓慢地模拟内存访问。性能的彻底灾难。

无论如何，你已经有了代码。你为什么不测量它并 100% 确定呢？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T20:59:51.063

选项 2。如果 256 次中的 255 次第一个不是您想要的，则没有理由获取 4 个字节。

为了皮特的缘故，展开循环。

编辑：展开。长度为`nDataLength`。你可以这样说：

```
pEnd1 = pData + (nDataLength & -8);
while (pData < pEnd1){
  if (pData[0] == theByteIWant){ ... }
  if (pData[1] == theByteIWant){ ... }
  ...
  if (pData[7] == theByteIWant){ ... }
  pData += 8;
}
while(pData < pEnd){
  if (pData[0] == theByteIWant){ ... }
  pData++;
} 
```

看看有什么作用？你不会花一半的时间问一个`(pData < pEnd)`答案几乎总是相同的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-16T01:28:27.017

这种方法并不完整，但基本思想是一次搜索八 (8) 个字节以查找 0xAA 模式。如果找到，则可以对 MARKER 模式执行二次搜索。

阶段 1：逐字节进行测试，直到您的数组是 8 字节对齐的。

阶段 2：#define HAS_NUL_BYTE(x) ((x) - 0x0101010101010101ull) & ~x & 0x8080808080808080ull)

```
uint64_t  value;
for (...) {
    value = *(uint64_t *) array[i] ^ 0xAAAAAAAAAAAAAAAAull;
    if (HAS_NUL_BYTE (value) != 0) {
        perform secondary search for the MARKER pattern
    }
    i += 8;
} 
```

这种方法应该（希望）具有以下优点。

1.  当 0xAA 不在窗口中时，每 8 个字节进行 1 次比较，而不是 8 次。
2.  更少的未对齐内存访问。

缺点包括...

1.  它更复杂
2.  如果数组包含大量 0xAA 字节（但不包含 MARKER），则主搜索中的误报会影响性能。

另一件事——既然你提到这只会在 Windows 下的 x86-64 上运行，你是否考虑过在汇编中编写它？如果是这样，PCMPEQB 指令可能会被证明是有用的。

希望这可以帮助。

# asp.net - asp:LoginView，需要登录旁边的注册链接

> ID：10607594
> 
> 赞同：1
> 
> 时间：2012-05-15T19:35:06.997
> 
> 标签：asp.net

我正在使用asp登录视图，除了带有登录链接的注册链接之外，我得到了我需要的一切，我试图找到正确的代码，但没有运气。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:50:53.070

寻找这样的东西？

```
<asp:LoginView ID="RegisterLink" runat="server">
  <AnonymousTemplate>
    <div class="titleRegistration">
      <a href="/Users/Register.aspx">Register</a> or 
    </div>
  </AnonymousTemplate>
  <LoggedInTemplate>
    <div class="titleRegistration">
      Welcome back
      <asp:LoginName ID="LoginName1" runat="server" />
      -
    </div>
  </LoggedInTemplate>
</asp:LoginView>
<asp:LoginStatus ID="lsGeneral" runat="server" LogoutPageUrl="/Users/Logout.aspx" /> 
```

# cookies - WSO2 BPS 共享 HTTP Cookie

> ID：10607598
> 
> 赞同：0
> 
> 时间：2012-05-15T19:35:22.613
> 
> 标签：cookies, wso2, bpel

考虑我们需要编排 WSO2 Carbon 管理服务的场景：**AuthenticationAdmin**和**UserAdmin**（通过**WSO2 BPS BPEL 流程**）。经过身份验证的用户的**AuthenticationAdmin**服务返回**JSESSIONID** cookie，该 cookie 应在后续调用（例如**UserAdmin中的***listUsers() ）*中使用（在 HTTP 请求中注入）。但是，似乎 HTTP cookie**没有共享**并用于同一域中的 Web 服务：

 ****```
http://localhost:9443/services/AuthenticationAdmin
http://localhost:9443/services/UserAdmin 
```

对问题有任何意见或解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T10:48:04.533

我认为这里的问题是，当服务绑定是 SOAP 时，WSO2 BPS 当前只能访问（获取/设置）消息的 SOAP 标头（而不是 HTTP 标头）。因此，您可以在 BPS 前面使用 ESB，以便从 carbon 返回的 cookie 可以从 HTTP 标头复制到自定义 SOAP 标头。然后，您将能够通过 BPS 访问它并可以将其存储为变量。稍后 BPS 可以使用 SOAP 标头中的此 cookie 进行管理调用，ESB 可以将其复制到 HTTP 标头。[您可以在此](http://old.nabble.com/HTTP-Header-Issues-td20485170.html)线程中阅读有关在 Apache ODE/WSO2 BPS 中访问 HTTP 标头的更多信息。****

# objective-c - 两个应用程序之间的通信

> ID：10607599
> 
> 赞同：8
> 
> 时间：2012-05-15T19:35:24.793
> 
> 标签：objective-c, ios

是否可以在两个不同的应用程序之间进行通信，一个在后台运行，另一个在前台运行？如果是，任何人都可以建议如何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T20:00:49.040

是的，可以在 iPhone 中的两个应用程序之间进行通信，但仅限于少数场景。

1.  可能有一些应用程序需要根据电话等事件发送到后台。在这种情况下，您必须配置您的音频会话对象（基于 Voip 的应用程序）并相应地发送通知。

2.  前面的例子只是在应用程序之间进行交互，灵活性极低（在一些重要的内置事件上将应用程序发送到后台）。另一种方法是通过 URL Schemes ，苹果有一些内置功能并支持某些应用程序，如邮件.tel 等。但其中一个应用程序将出现在前台。

就像您可以拨打电话号码一样，该电话号码是内置在应用程序中的：-

```
NSString *phURL= [NSString stringWithFormat:@"tel:%@", [NSString StringWithString:@"1-800-555-1212"]];
NSURL *phoneURL = [NSURL URLWithString:phURL];
[[UIApplication sharedApplication] openURL:phoneURL]]; 
```

顺便说一句，如果您需要实现[自定义 URL 方案](https://developer.apple.com/library/IOs/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/AdvancedAppTricks/AdvancedAppTricks.html#//apple_ref/doc/uid/TP40007072-CH7-SW18).. 玩得开心。

3.  The other way is through [UIDocumentInteractionController](https://www.google.co.in/webhp?hl=en&tab=ww#hl=en&safe=off&sclient=psy-ab&q=UIDocumentInteractionController+&oq=UIDocumentInteractionController+&aq=f&aqi=g4&aql=&gs_l=hp.3..0l4.617438.617438.0.621292.1.1.0.0.0.0.577.577.5-1.1.0...0.0.BV22RO4g1IY&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.,cf.osb&fp=357008c06016d30d&biw=1280&bih=696) which provides in-app support to have interaction between certain files.(Sandbox environment inhibits a complete access or even accesses that can modify data of other application).Like it can be used to preview files in mail app or download attachments.But you cannot modify them for other application , of course you can copy it and modify it for your application.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:43:15.780

我不认为这正是你想要的，但它肯定会让你在应用程序之间进行交互。

[https://developer.apple.com/library/IOs/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/AdvancedAppTricks/AdvancedAppTricks.html#//apple_ref/doc/uid/TP40007072-CH7-SW18](https://developer.apple.com/library/IOs/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/AdvancedAppTricks/AdvancedAppTricks.html#//apple_ref/doc/uid/TP40007072-CH7-SW18)

它只是使用 URL 方案来激活命令并在另一个应用程序中打开。只是尽量避免为您自己的应用程序使用苹果默认值。

# php - 如何在我的 wordpress 页面内容和侧边栏小部件之间传递变量

> ID：10607602
> 
> 赞同：0
> 
> 时间：2012-05-15T19:35:52.970
> 
> 标签：php, wordpress, nextgen-gallery

我正在编辑 $image 对象附带的 nextgen 画廊插件。我希望能够将这个 $image 对象传递给我侧边栏中的 php 小部件，这样我就可以在那里回显关于 $image 的内容。我怎样才能做到这一点？

这是我想要在侧边栏中的模板中的示例。当我将 php 粘贴到其中时，它不起作用，因为它没有对 $image 对象的引用。

```
<?php if(!empty($image->ngg_custom_fields["buy-1"])){?>

            <ul class="buying-list">
                <li><?php echo $image->ngg_custom_fields["text-1"]; ?> </li>
                <li><?php  echo $image->ngg_custom_fields["buy-1"]; ?> </li>
            </ul>
        <?php }; ?> 
```

# macos - 在 Mac OsX 上查询

> ID：10607603
> 
> 赞同：1
> 
> 时间：2012-05-15T19:35:59.617
> 
> 标签：macos

我对在 Mac OSX 上使用一些框架有疑问。

例如，如果要从日历应用程序中获取事件。这可以使用“CalCalendarStore”类来完成。可以获取所有与日历相关的信息。但是，它是否在系统上留下任何查询日历信息的痕迹？

或者，可以通过解析 ~/Library/Calender/ 目录中的“.ics”文件获得相同的信息。是否也留下了查询日历应用程序信息的痕迹？

谢谢！！

# haskell - 我有同一个 haskell/cabal 包的多个安装版本。哪个投入使用？

> ID：10607607
> 
> 赞同：2
> 
> 时间：2012-05-15T19:36:08.173
> 
> 标签：haskell, packages, ghc, cabal, ghci

主要问题：我安装了多个版本的软件包。在 ghc/ghci 中编译或运行在包中有一个模块作为依赖项的模块时，我如何知道正在使用哪个版本？

相关问题：如果我正在安装一个 cabal 包，它的依赖项可以由一个包的多个版本来满足。将使用哪个版本？最新版本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T19:44:00.370

ghc 更喜欢与最新版本（即最高版本号）链接。

如果与 cabal 链接，它将解析 .cabal 文件中指定的版本（如果没有给出上限，则首选较新的版本）。

cabal-install 将首选最新版本，除非给出约束。

在存在约束的情况下，依赖[解析变为 NP-complete](http://people.debian.org/~dburrows/model.pdf)，并且 cabal 依赖于求解器来找到令人满意的包分配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T20:21:35.290

一些有用的命令可以实际查看已安装的软件包并控制它们是否被使用：

`ghc-pkg list`

`ghc-pkg register`

`ghc-pkg unregister`

# jquery - 如果某些文本旋转 x 度，那么我将如何计算最左边的点与原始最左边的点之间的距离？

> ID：10607608
> 
> 赞同：1
> 
> 时间：2012-05-15T19:36:17.337
> 
> 标签：jquery, html, canvas, geometry

我在 HTML5 画布上绘制一些文本，将画布转换为覆盖在第二个画布上的图像，然后由用户旋转 img，然后绘制到第二个画布上。我遇到的问题是，当图像被绘制到画布上时，它的位置不正确。我附上了一些图片来证明这一点：

这是用户可以拖动和旋转的 img 标签：

[![绝对定位的 img 标签](../Images/3127d48a7f398c0dc96f9848c98ce0bb.png)](https://i.stack.imgur.com/LBu7s.png)
[（来源：[devjoe.co.uk](http://devjoe.co.uk/before.png)）]

这就是将图像绘制到画布上时发生的情况（忽略红色框） [（来源：][[devjoe.co.uk](http://devjoe.co.uk/after.png)][）][![结果](../Images/c163c90a5b809666f55de28d31709250.png)](https://i.stack.imgur.com/qyjlh.png)

我无法弄清楚为什么图像被偏移。如果它是水平的，那么它被绘制在正确的位置，我旋转得越多，它就会越远。这是将图像绘制到画布上的 javascript：

```
function saveWatermark()
{
toggleLoading(true);
enableUndo();
var watermarkOffset = $('.watermark').offset();
var watermarkWidth = $('.watermark').width();
var watermarkHeight = $('.watermark').height();
var canvasOffset = $(_canvas).offset();
//TODO: If the text is a long string then the rotate handle is too close and it moves jerkily
var img = new Image();
img.onload = function ()
{
    $('.watermark-container').remove();
    if (!_watermarkAngle)
    {
        _context.drawImage(img, _watermarkX, _watermarkY);
    } else
    {
        _watermarkAngle = Math.round(_watermarkAngle);
        _context.save();
        var xPos = watermarkOffset.left - canvasOffset.left;
        var yPos = watermarkOffset.top - canvasOffset.top;
        var xCentre = xPos + img.width / 2;
        var yCentre = yPos + img.height / 2;

        _context.translate(xCentre, yCentre);
        _context.rotate(_watermarkAngle * Math.PI / 180);
        _context.translate(-xCentre, -yCentre);
        _context.drawImage(img, xPos + (img.width / 2), yPos + (img.height / 2));
        _context.fillStyle = 'rgba(255,0,0,0.5)';
        _context.fillRect(xPos, yPos, img.width, img.height);
        _context.restore();

    }
    $btnWatermarkSave.attr('disabled', 'disabled');
    toggleLoading(false);
};
img.src = $('.watermark')[0].src;
} 
```

任何帮助都会很棒。

谢谢，

乔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:52:10.543

也许也检查`line-height`一下文本——它可能有一个比我们看到的更大的“盒子”？

# java - 文本文件中不同命令的随机调用百分比

> ID：10607614
> 
> 赞同：0
> 
> 时间：2012-05-15T19:36:44.830
> 
> 标签：java, multithreading, random

这是我的配置文件（Test.txt）

```
CommandA   75%
CommandB   15%
CommandC   10% 
```

我写了一个多线程程序，我在其中逐行读取文件，但不知道我应该怎么做上面的问题，其中这么多百分比（75%）的随机调用转到 CommandA，而这么多百分比（15%）的随机调用转到 CommandB，与 CommandC 相同。

```
public static void main(String[] args) {

            for (int i = 1; i <= threadSize; i++) {
                new Thread(new ThreadTask(i)).start();
            }
        }

class ThreadTask implements Runnable {

        public synchronized void run() {
            BufferedReader br = null;

            try {
                String line;

                br = new BufferedReader(new FileReader("C:\\Test.txt"));

                while ((line = br.readLine()) != null) {
                    String[] s = line.split("\\s+");
                    for (String split : s) {
                    System.out.println(split);
                }
            }

            } catch (IOException e) {
                e.printStackTrace();
            } finally {
                try {
                    if (br != null)br.close();
                } catch (IOException ex) {
                    ex.printStackTrace();
                }
            }

        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:43:34.490

获取一个随机数 1-100。如果编号是 1-75 执行命令 A，76-90 执行命令 B，91-100 执行命令 C。

编辑评论：

有两种方法我会考虑这样做。如果你只有三个命令（A、B、C），那么你可以做一个简单的：

```
 int[] commandPercentages = {75, 15, 10};        
    int randomNumber = 90;

    if((randomNumber -= commandPercentages[0]) < 0) {
        //Execute Command A
    }
    else if((randomNumber -= commandPercentages[1]) < 0) {
        //Execute Command B
    }
    else {
        //Execute Command C
    } 
```

如果你有很多复杂的命令，你可以像这样设置命令：

```
private abstract class Command {
    int m_percentage;       
    Command(int percentage) {
        m_percentage = percentage;
    }       
    int getPercentage() {
        return m_percentage;
    }
    abstract void executeCommand();
};

private class CommandA extends Command {        
    CommandA(int percentage) {
        super(percentage);
    }
    @Override
    public void executeCommand() {
        //Execute Command A
    }       
}

private class CommandB extends Command {        
    CommandB(int percentage) {
        super(percentage);
    }
    @Override
    public void executeCommand() {
        //Execute Command B
    }

} 
```

然后像这样选择命令：

```
 Command[] commands = null;  
    int randomNumber = 90;

    commands[0] = new CommandA(75);
    commands[1] = new CommandB(25);

    for(Command c: commands) {
        randomNumber -= c.getPercentage();
        if(randomNumber < 0) {
            c.executeCommand();
        }
    } 
```

# spring-mvc - Spring：如何忽略 Controller 的超类中的 RequestMappings？

> ID：10607619
> 
> 赞同：0
> 
> 时间：2012-05-15T19:37:06.467
> 
> 标签：spring-mvc, controller, url-mapping

让我先解释一下我的设置。

我的 Web 应用程序由多个模块组成，这些模块相互关联，模块 1 使用模块 2 中的控制器/服务来重新创建通用功能，从而消除代码冗余。简单地说，2 个独立的 Web 应用程序，其中 1 个应用程序的所有类作为 jar 包含在另一个应用程序中。

现在，我面临的问题是由于子模块中的常见 URL 映射，根据以下情况：

*模块 1 的控制器 A 扩展模块 2 的控制器 B*

```
package com.module1;

@RequestMapping("/client")
public class A extends B {

    @RequestMapping("/hello")
    public void helloWorldNew(...) {
        ...
    }
}

package com.module2;

@RequestMapping("/user")
public class B {

    @RequestMapping("/")
    public void helloWorld(...) {
        ...
    }
} 
```

*模块 1 的控制器 C 扩展模块 2 的控制器 D*

```
package com.module1;

@RequestMapping("/client")
public class C extends D {

    @RequestMapping("/helloworld")
    public void helloWorldNew(...) {
        ...
    }
}

package com.module2;

@RequestMapping("/human")
public class D {

    @RequestMapping("/")
    public void helloWorld(...) {
        ...
    }
} 
```

如您所见，将模块 2 分开来看，已映射的 URL 是`/user/`&`/client/`在任何意义上都是合法的。现在，当模块 1 出现时，正如预期的那样，Spring 会抛出一个异常，指出 URL`/client/`已经通过`A.helloWorld()`和`C.helloWorld()`映射映射。

有没有解决的办法？我可以要求 Spring 简单地忽略在超类中找到的方法级 RequestMappings 吗？或者有没有办法让 Spring 忽略/覆盖映射（就像根级 RequestMappings 所做的那样）？

任何帮助将不胜感激。

谢谢，
苏米特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T21:12:27.980

我可以想到几种方法来做到这一点：

当您设置模块 1 时，您可以仅对模块 1 中与您相关的包进行组件扫描（假设模块 1 和模块 2 中的包名称不同：

```
<context:component-scan base-package="package1, package2" use-default-filters="false">
</context:component-scan> 
```

如果包名差别不大，可以尝试按类名模式排除：

```
<context:exclude-filter type="regex" expression="*.Module1Class"/> 
```

第二种方法是在模块 2 abstract 中声明基类，这样根本不会创建与基类对应的控制器。

第三种方法，如果基类对您来说不是那么重要，可以将 @RequestMapping 与为模块 1 指定的 RequestMappings 完全不冲突。

# python - 一个使用 SimpleHTTPServer 和 SocketServer 的简单网站，如何只显示 html 文件而不显示整个目录？

> ID：10607621
> 
> 赞同：11
> 
> 时间：2012-05-15T19:37:21.177
> 
> 标签：python, networking, webpage

我如何只`simplehttpwebsite_content.html`在访问时显示`localhost:8080`？所以我看不到我的文件树，只有网页。所有这些文件都在同一个目录中。

简单的httpwebsite.py

```
#!/usr/bin/env python
import SimpleHTTPServer
import SocketServer

Handler = SimpleHTTPServer.SimpleHTTPRequestHandler
server = SocketServer.TCPServer(('0.0.0.0', 8080), Handler)

server.serve_forever() 
```

简单的httpwebsite_content.html

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html>
  <head>
    <link rel="stylesheet" type="text/css" href="simplehttpwebsite_style.css">
  </head>

  <body>
    This is my first web page
  </body>
</html> 
```

简单的httpwebsite_style.css

```
body{background-color:blue;} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-05-15T20:01:06.247

如果被请求，您可以扩展`SimpleHTTPServer.SimpleHTTPRequestHandler`和覆盖替换为的方法`do_GET`。`self.path``simplehttpwebpage_content.html``/`

```
#!/usr/bin/env python
import SimpleHTTPServer
import SocketServer

class MyRequestHandler(SimpleHTTPServer.SimpleHTTPRequestHandler):
    def do_GET(self):
        if self.path == '/':
            self.path = '/simplehttpwebpage_content.html'
        return SimpleHTTPServer.SimpleHTTPRequestHandler.do_GET(self)

Handler = MyRequestHandler
server = SocketServer.TCPServer(('0.0.0.0', 8080), Handler)

server.serve_forever() 
```

由于[`SimpleHTTPServer.SimpleHTTPRequestHandler`](http://docs.python.org/library/simplehttpserver.html#SimpleHTTPServer.SimpleHTTPRequestHandler)extends [`BaseHTTPServer.BaseHTTPRequestHandler`](http://docs.python.org/library/basehttpserver.html#BaseHTTPServer.BaseHTTPRequestHandler)，您可以阅读他们的文档以了解可用的方法和实例变量以及如何操作它们。

您可以找到`path`文档中提到的变量[`BaseHTTPServer.BaseHTTPRequestHandler`](http://docs.python.org/library/basehttpserver.html#BaseHTTPServer.BaseHTTPRequestHandler)。你可以找到`do_GET()`文档中提到的方法[`SimpleHTTPServer.SimpleHTTPRequestHandler`](http://docs.python.org/library/simplehttpserver.html#SimpleHTTPServer.SimpleHTTPRequestHandler)。

这是我的 shell 的一些输出，显示了当我运行这个程序然后我尝试访问时会发生什么`http://localhost:8080/`

```
susam@swift:~/so$ ls
simplehttpwebpage_content.html  simplehttpwebpage.py  simplehttpwebsite_style.css
susam@swift:~/so$ python simplehttpwebpage.py
swift - - [19/Apr/2012 09:10:23] "GET / HTTP/1.1" 200 -
swift - - [19/Apr/2012 09:10:26] "GET /simplehttpwebsite_style.css HTTP/1.1" 200 - 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-05-15T19:53:15.490

您应该调用您的文件`index.html`，这是自动提供的页面，而不是列出目录。

另一种可能性是覆盖处理程序`list_directory(self, path)`方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-24T17:51:33.993

基于 Susam Pal 的回答，这是我的实现，它允许设置端口（就像您运行时一样`python -m SimpleHTTPServer 8080`），并且当文件存在于文件服务器上时还提供 html 页面，没有 .html 扩展名。

```
#!/usr/bin/env python
import SimpleHTTPServer
import SocketServer
import os.path
import sys

class MyRequestHandler(SimpleHTTPServer.SimpleHTTPRequestHandler):
    def do_GET(self):            
        possible_name = self.path.strip("/")+'.html'
        if self.path == '/':
            # default routing, instead of "index.html"
            self.path = '/simplehttpwebpage_content.html'
        elif os.path.isfile(possible_name):
            # extensionless page serving
            self.path = possible_name

        return SimpleHTTPServer.SimpleHTTPRequestHandler.do_GET(self)

Handler = MyRequestHandler

port = 8000
if len(sys.argv) > 1:
    try:
        p = int(sys.argv[1])
        port = p
    except ValueError:
        print "port value provided must be an integer"

print "serving on port {0}".format(port)
server = SocketServer.TCPServer(('0.0.0.0', port), Handler)
server.serve_forever() 
```

# android - 如何在android中创建一个类似于数据库SELECT语句的搜索按钮

> ID：10607622
> 
> 赞同：1
> 
> 时间：2012-05-15T19:37:30.523
> 
> 标签：android

我正在为 android 构建一个字典应用程序。我想创建一个搜索按钮，可以搜索 SQLite 数据库，然后将数据显示到 ListView。

1.  如何编码以便我将该搜索按钮链接到数据库 SELECT 语句？
2.  如何将 SELECT 语句结果显示到 ListView？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:48:12.830

为此，您需要根据搜索栏的内容创建查询，例如：

```
select * from <your_database> where word = "<word typed in the search field>" 
```

即，您必须创建一个基本字符串，例如`select * from <your_database> where word = "`，然后在按下“选择”按钮时将其与搜索栏的内容连接起来。

另外你想用 word`like "#<word typed in the search field>#"`

并拆分单词并检测相似的单词并在数据库中搜索它们，这特定于您正在谈论的实现，即字典。我的意思是，例如，如果我输入`cavalier`字典，字典结果也包括`cavalier hat`，但这些取决于您的目标。

[这](http://www.vogella.com/articles/AndroidSQLite/article.html)是一个android的数据库教程。

[这](http://developer.android.com/resources/tutorials/views/hello-listview.html)和[这](http://www.vogella.com/articles/AndroidListView/article.html)应该可以帮助您使用`ListView`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:23:16.303

为了与您打交道，`ListView`可以使用我的代码它做同样的事情，即从文本字段获取输入，在 db 中搜索并打印结果`ListView`

```
 EditText userInput = (EditText)findViewById(R.id.myEditText);
    SQLiteClass mySQLiteClass = new SQLiteClass(this);
    mySQLiteClass.openToWrite();
    Cursor cursor = mySQLiteClass.returnResultsFromDb(userInput.getText().toString);

    ArrayList<String> result = new ArrayList();
    for (cursor.moveToFirst(); !(cursor.isAfterLast()); cursor.moveToNext()) {
       result.add(cursor.getString(cursor.getColumnIndex(SQLiteClass.BI_Attr2)));
    }

    String[] Values = new String[result.size()];

    for (int i=0; i<result.size(); i++) {
        Values[i] = result.get(i);
    }

    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_single_choice, android.R.id.text1, Values);

    ListView LV = (ListView)findViewById(R.id.myListView);
    LV.setAdapter(adapter); 
```

并遵循我的数据库类

```
public class SQLiteClass{

    public static final String MYDATABASE_NAME = "DATABASE_Proj";
    public static final String MYDATABASE_TABLE = "Basic_Info";
    public static final String BI_Attr1 = "ID"; // Primary Key
    public static final String BI_Attr2 = "Name";
    public static final String BI_Attr3 = "StudentRoll";
    public static final String BI_Attr4 = "FromCourse";
    public static final String BI_Attr5 = "ToCourse";
    public static final String BI_Attr6 = "Time";
    public static final String BI_Attr7 = "Status";
    public static final String BI_Attr8 = "Comments";

    private static final String SCRIPT_CREATE_DATABASE = "create table "
        + MYDATABASE_TABLE + 
        " (" + BI_Attr1         + " integer primary key autoincrement, " +
        BI_Attr2 + " text not null, " +
        BI_Attr3 + " text," +
        BI_Attr4 + " text," + 
        BI_Attr5 + " text," +
        BI_Attr6 + " text," +
        BI_Attr7 + " text," +
        BI_Attr8 + " text " +

        "); ";

    public static final int MYDATABASE_VERSION = 1;

    private SQLiteHelper sqLiteHelper;
    private SQLiteDatabase sqLiteDatabase;

    private Context context;

    public SQLiteClass(Context c) {
        context = c;
    }

    public SQLiteClass openToRead() throws android.database.SQLException {
        sqLiteHelper = new SQLiteHelper(context, MYDATABASE_NAME, null,
                MYDATABASE_VERSION);
        sqLiteDatabase = sqLiteHelper.getReadableDatabase();
        return this;
    }

    public SQLiteClass openToWrite() throws android.database.SQLException {
        sqLiteHelper = new SQLiteHelper(context, MYDATABASE_NAME, null,
                MYDATABASE_VERSION);
        sqLiteDatabase = sqLiteHelper.getWritableDatabase();
        return this;
    }

    public void close() {
        sqLiteHelper.close();
    }

    public Cursor returnResultsFromDb(String S) {
        String[] columns = new String[] { BI_Attr3 };
        Cursor cursor = sqLiteDatabase.query(MYDATABASE_TABLE, columns, null,
            null, null, null, null);
        return cursor;
    }

    public class SQLiteHelper extends SQLiteOpenHelper {

        public SQLiteHelper(Context context, String name,
                CursorFactory factory, int version) {
            super(context, name, factory, version);
        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            try {
                db.execSQL(SCRIPT_CREATE_DATABASE);
            } catch (Exception E) {
                Log.v("Failed to create DB", "----");
            }
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

        }
    }
} 
```

# jquery - 使用 Mousedown 和 setTimeout 函数反复触发函数

> ID：10607624
> 
> 赞同：0
> 
> 时间：2012-05-15T19:37:36.427
> 
> 标签：jquery, settimeout, mousedown

我想在使用 setTimeout 的 mousedown 事件时重复使用调用函数，它根本不起作用。有人知道吗？

```
 $("#image_360").mousedown( function() {
        mouseStillDown=true;
        $(this).data('timeout', window.setTimeout(function () {

            getDirection;
        }, 2000));
    },
    function()
    {
        clearTimeout($(this).data('timeout'));
        alert('mouse left');

    });

    function getDirection(e){
    var x = e.pageX;
            //do stuff with condition e.pageX
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:40:48.550

您需要使用`setInterval()`and`clearInterval()`方法来重复调用和清除计时器，而不是`setTimeout`and `clearTimeout`。

[setInterval](https://developer.mozilla.org/en/DOM/window.setInterval)和[clearInterval](https://developer.mozilla.org/en/DOM/window.clearInterval)

像这样更新您的代码

```
 $("#image_360").mousedown( function() {
        mouseStillDown=true;
        $(this).data('timeout', window.setInterval(function () {

            getDirection;
        }, 2000));
    },
    function()
    {
        clearInterval($(this).data('timeout'));
        alert('mouse left');

    }); 
```

然后`getDirection`每 2 秒调用一次。

# android - Proguard保存mapping.txt

> ID：10607625
> 
> 赞同：2
> 
> 时间：2012-05-15T19:37:43.463
> 
> 标签：android, proguard

我想为我的 android 项目的每个版本保存带有版本号的 mapping.txt 文件。这样 QA 就可以对其进行测试。我需要有关如何使用 build 重命名 mapping.txt 文件并将其保存到 direct 的具体信息

# iphone - 从核心数据错误中检索 NSString

> ID：10607626
> 
> 赞同：0
> 
> 时间：2012-05-15T19:37:44.047
> 
> 标签：iphone, xcode, core-data, if-statement

应用程序需要从核心数据中检索数据，然后将其中一个值与 IF 语句进行比较

```
MyAppDelegate *appDelegate = [[UIApplication sharedApplication] delegate];
        NSManagedObjectContext *context = [appDelegate managedObjectContext];

        NSEntityDescription *getDetails = [NSEntityDescription entityForName:@"Detail" inManagedObjectContext:context];
        NSFetchRequest *request = [[NSFetchRequest alloc] init];

        [request setEntity:getDetails];
        NSPredicate *pred = [NSPredicate predicateWithFormat:@"(genID = %i)", genID];
        [request setPredicate:pred];

        NSSortDescriptor *sort = [[NSSortDescriptor alloc] initWithKey:@"genID" ascending:YES];
        [request setSortDescriptors:[NSArray arrayWithObject:sort]];

        NSError *error;
        NSArray *objects = [context executeFetchRequest:request error:&error];

        for (NSManagedObject *oneObject in objects) {   

            NSString *type = [oneObject valueForKey:@"type"];

            if (type == @"straight") {
                NSLog(@"straight");
                //straight logic removed
            }else if (type == @"Left") {
                NSLog(@"Left");
                //Left logic removed
            }else {
                NSLog(@"Else");
                //Else logic removed

            }

            } 
```

问题是它永远不会进入“直”或“左”总是 ELSE。单步执行代码，我可以看到值确实匹配直线和左侧，甚至将它们转储到日志文件中也显示它们很好。怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:45:20.423

您需要使用`isEqual:`or`isEqualToString:`或比较字符串`compare:`。

例如：

```
NSString *type = [oneObject valueForKey:@"type"];
if ([type isEqualToString:@"straight"])
    // etc. 
```

如果您需要更多解释，请在 StackOverflow 中搜索“NSString equal”或“NSString compare”。你不是第一个问这个问题的人，你肯定不会是最后一个。

# sql - 在 SQL Server 中使用一个存储过程更新两个表？

> ID：10607627
> 
> 赞同：0
> 
> 时间：2012-05-15T19:37:54.890
> 
> 标签：sql

当我尝试在一个存储过程中更新两个表时遇到问题我得到 SqlException 有人可以帮助我吗

> INSERT 语句与 FOREIGN KEY 约束“FK”冲突。冲突发生在数据库“”、表“dbo.Users”、列“userID”中。该语句已终止。

```
ALTER PROCEDURE  [dbo].[CreateProject]
    @ProjectID UNIQUEIDENTIFIER,
    @UserID UNIQUEIDENTIFIER,
    @ProjectName NVARCHAR(50),
    @Description NTEXT,
    @EstStartDate DATETIME,
    @EstEndDate DATETIME,
    @StatusID SMALLINT,
    @Priority SMALLINT

AS 

INSERT INTO DBO.Projects VALUES 
(@ProjectID,@ProjectName,GETDATE(),@Description,@EstStartDate,@EstEndDate,@StatusID,@Priority)

INSERT INTO Users_projects VALUES 
(@ProjectID,@UserID) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:50:26.253

问题出在 UserID 的外键上。您需要先将 UserId 插入到 Users 表中。几点提示：“createProc”过程通常应该创建 ProjectId 并作为 OUTPUT 参数返回。此外，您可能希望使用用户名作为输入参数并让 proc 查找 UserId。

# php - Ajax - jQuery - JSON - PHP 登录

> ID：10607630
> 
> 赞同：-1
> 
> 时间：2012-05-15T19:37:57.873
> 
> 标签：php, jquery, ajax, json, jsonp

好的，所以我正在尝试使用 Phonegap 为 iOS 应用程序创建登录表单。为了让用户登录，我需要解决 SOP。我已经尝试了许多教程和示例，但我无法让它们中的任何一个工作。这就是我现在所拥有的，我可以使用一些指针：

```
<script type="text/javascript">
$(document).ready(function() {

$("#login").click(function() {

    var action = $("#form1").attr('action');
    var form_data = {
        username: $("#username").val(),
        password: $("#password").val(),
        is_ajax: 1
    };

    $.ajax({
        type: "POST",
        url: action,
        data: form_data,
        success: function(response)
        {
            if(response == 'success')
                $("#form1").slideUp('slow', function() {
                    $("#message").html("You have logged in successfully!");
                });
            else
                $("#message").html("Invalid username and/or password.");    
        }
    });

    return false;
});

});
</script> 
```

------------ 关于doLogin.php -----

```
<?php

$is_ajax = $_REQUEST['is_ajax'];
if(isset($is_ajax) && $is_ajax)
{
    $username = $_REQUEST['username'];
    $password = $_REQUEST['password'];

    if($username == 'demo' && $password == 'demo')
    {
        echo "success"; 
    }
}

?> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-05-15T19:50:06.223

第一个想法：在条件句中使用花括号时，您的代码不容易出错

```
if(response == 'success')
    $("#form1").slideUp('slow', function() {
        $("#message").html("You have logged in successfully!");
    });
else
    $("#message").html("Invalid username and/or password."); 
```

可能

```
if(response == 'success') {
    $("#form1").slideUp('slow', function() {
        $("#message").html("You have logged in successfully!");
    });
} else {
    $("#message").html("Invalid username and/or password.");    
} 
```

此处的用户解释了为什么这会有所帮助：[https ://stackoverflow.com/a/2125078/680578](https://stackoverflow.com/a/2125078/680578)

# ios - iOS - 测试设备时未调用类别方法

> ID：10607631
> 
> 赞同：0
> 
> 时间：2012-05-15T19:37:58.660
> 
> 标签：ios, nsdate, categories

我有这个类别：

```
@interface NSDate (PrettyDate)
- (NSString *)prettyDate;
@end

#import "NSDate+PrettyDate.h"

@implementation NSDate (PrettyDate)

- (NSString *)prettyDate
{
  NSString *prettyTimestamp = nil;

  float delta = [self timeIntervalSinceNow] * -1;

  if (delta < 60) {
    prettyTimestamp = @"Just now";
  } else if (delta < 120) {
    prettyTimestamp = @"One minute ago";
  } else if (delta < 3600) {
    prettyTimestamp = [NSString stringWithFormat:@"%d minutes ago", (int) floor(delta/60.0) ];
  } else if (delta < 7200) {
    prettyTimestamp = @"One hour ago";      
  } else if (delta < 86400) {
    prettyTimestamp = [NSString stringWithFormat:@"%d hours ago", (int) floor(delta/3600.0) ];
  } else if (delta < ( 86400 * 2 ) ) {
    prettyTimestamp = @"One day ago";       
  } else if (delta < ( 86400 * 7 ) ) {
    prettyTimestamp = [NSString stringWithFormat:@"%d days ago", (int) floor(delta/86400.0) ];
  } else {
    NSDateFormatter * formatter = [[NSDateFormatter alloc] init];
    [formatter setDateStyle:NSDateFormatterMediumStyle];

    prettyTimestamp = [NSString stringWithFormat:@"On %@", [formatter stringFromDate:self]];
  }

  return prettyTimestamp;
}

@end 
```

我这样称呼它：

```
NSDateFormatter *currentFormat = [[NSDateFormatter alloc] init];
currentFormat.dateFormat = @"yyyy-MM-dd HH:mm:ss";
NSDate *date = [currentFormat dateFromString:dateString];

cell.detailTextLabel.text = [date prettyDate]; 
```

它在模拟器上运行良好，但在设备上甚至没有调用类别方法，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T19:41:41.693

如果在调试器中添加符号断点，它会得到解决吗？如果是这样，执行会停止吗？

您是否将此代码编译到静态 .a 库中？GCC 链接器需要使用 -all_load 标志来确保获取静态库中的类别。

# java - 第一次测试后，junit 中的 HttpServer 失败并出现地址使用错误

> ID：10607633
> 
> 赞同：4
> 
> 时间：2012-05-15T19:38:01.273
> 
> 标签：java, junit, com.sun.net.httpserver

我有一个用于 JUnit 4.x 的 Java 类。在每个 @Test 方法中，我创建一个新的 HttpServer，使用端口 9090。第一次调用工作找到，但随后的错误“地址已在使用中：绑定”。

这是一个例子：

```
@Test
public void testSendNoDataHasValidResponse() throws Exception {
    InetSocketAddress address = new InetSocketAddress(9090);
    HttpHandler handler = new HttpHandler() {

        @Override
        public void handle(HttpExchange exchange) throws IOException {
            byte[] response = "Hello, world".getBytes();
            exchange.sendResponseHeaders(HttpURLConnection.HTTP_OK, response.length);
            exchange.getResponseBody().write(response);
            exchange.close();
        }
    };
    HttpServer server = HttpServer.create(address, 1);
    server.createContext("/me.html", handler);
    server.start();

    Client client = new Client.Builder(new URL("http://localhost:9090/me.html"), 20, "mykey").build();

    client.sync();
    server.stop(1);
    assertEquals(true, client.isSuccessfullySynchronized());
} 
```

很明显，HttpServer 只包含在每个方法中，并在结束前停止。我看不到是什么继续保持任何套接字打开。第一个测试通过，随后的测试每次都失败。

有任何想法吗？

用更正的方法编辑：

```
@Test
public void testSendNoDataHasValidResponse() throws Exception {
    server = HttpServer.create(new InetSocketAddress("127.0.0.1", 0), 1);
    HttpHandler handler = new HttpHandler() {

        @Override
        public void handle(HttpExchange exchange) throws IOException {
            byte[] response = "Hello, world".getBytes();
            exchange.sendResponseHeaders(HttpURLConnection.HTTP_OK, response.length);
            exchange.getResponseBody().write(response);
            exchange.close();
        }
    };
    server.createContext("/me.html", handler);
    server.start();
    InetSocketAddress address = server.getAddress();
    String target = String.format("http://%s:%s/me.html", address.getHostName(), address.getPort());

    Client client = new Client.Builder(new URL(target), 20, "mykey").build();

    client.sync();
    server.stop(0);
    assertEquals(true, client.isSuccessfullySynchronized());
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T21:03:06.900

果冻的答案是钱。

其他解决方法：

*   为所有测试重用相同的 HttpServer。要在测试之间清理它，您可以删除它的所有上下文。如果你给它一个自定义的执行器，你也可以等待或杀死所有的工作线程。

*   在新端口上创建每个 HttpServer。您可以通过[在创建 InetSocketAddress 时将端口号指定为零来](http://docs.oracle.com/javase/6/docs/api/java/net/InetSocketAddress.html#InetSocketAddress%28int%29)执行此操作。[然后，您可以通过在创建端口后查询服务器的端口来](http://docs.oracle.com/javase/6/docs/jre/api/net/httpserver/spec/com/sun/net/httpserver/HttpServer.html#getAddress%28%29)找到实际使用的端口，并在测试中使用它。

*   [将全局服务器套接字工厂更改为](http://docs.oracle.com/javase/6/docs/api/java/net/ServerSocket.html#setSocketFactory%28java.net.SocketImplFactory%29)每次返回相同服务器套接字的自定义工厂。这使您可以在许多测试中重用相同的实际套接字，而不必重用 HttpServer。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T20:08:41.203

在重新绑定到特定端口号之前，通常需要等待 2 分钟。运行 netstat 以确认您的服务器的连接是否在 TIME_WAIT 中。如果是这样，您可以在绑定之前使用 SO_REUSEADDR 选项来绕过它。文档在[此处](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/ServerSocket.html#setReuseAddress%28boolean%29)适用于 java。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-18T14:58:44.397

创建 HttpServer 时，您指定

> 侦听套接字上允许的最大排队传入连接数

这是**1**

```
server = HttpServer.create(new InetSocketAddress("127.0.0.1", 0), 1); 
```

[关联](https://docs.oracle.com/javase/7/docs/jre/api/net/httpserver/spec/com/sun/net/httpserver/HttpServer.html#create(java.net.InetSocketAddress,%20int))

# powershell - 通过 PowerShell Foreach 循环正确使用 Get-Childitem

> ID：10607635
> 
> 赞同：1
> 
> 时间：2012-05-15T19:38:14.903
> 
> 标签：powershell

我想获取一个带有用户名的文本文件，然后搜索特定位置（[UNC](http://en.wikipedia.org/wiki/Path_%28computing%29#Uniform_Naming_Convention)路径）并返回找到的任何匹配项，将它们输出到日志文件：

```
#Searches target folder for all folders matching input

$start = (get-date -uformat "%Y-%m-%d_%H%M")
$defaultLogFileName = "folder_matcher" + $start + ".log"

#Log file header

$header = @()
$header += "=============================="
$header += "Search results"
$header += ""
$header += "Execution Start: " + (get-date -uformat "%Y-%m-%d %H%M") + ""
$header += ""

#Get the logfile location
do
{
    $logdir = Read-Host "Enter log directory (or press Enter for default c:\)"
    if ($logdir -eq "")
        {$logfile = ("c:\" + $defaultLogFileName); break;}
    if(Test-Path $logdir)
        {$logfile += ($logdir + "\" + $defaultLogFileName); break;}
    Write-Host -ForegroundColor Red "Directory does not exist"
} while (!(Test-Path $logfile))

$SourceFile = Read-Host "Enter file path"
$SearchValue = Read-host "Enter target directory to sweep"

$header | Out-File -FilePath $logfile

foreach($user in $sourcefile){
    Get-ChildItem $SearchValue -filter $user | Out-file -Append -FilePath $logfile
} 
```

当我尝试在此循环中使用[Get-ChildItem时，结果如下：](http://technet.microsoft.com/en-us/library/hh849800.aspx)

```
Get-ChildItem : Second path fragment must not be a drive or UNC name.
Parameter name: path2
At \\erebus\erebus_users$\rraymond1\ps\searchandmatch.ps1:32 char:14
+ Get-ChildItem <<<<  $SearchValue -filter $user | Out-file -Append -FilePath $logfile
+ CategoryInfo          : InvalidArgument: (\\harvard\tsprofiles$:String)
[Get-ChildItem], ArgumentException  + FullyQualifiedErrorId  DirArgumentError,Microsoft.PowerShell.Commands.GetChildItemCommand 
```

我尝试用固定值替换变量（甚至在本地映射 UNC 路径并尝试以这种方式运行），但问题仍然存在。我该如何解决？

# c++ - C++低级文件加密函数

> ID：10607637
> 
> 赞同：1
> 
> 时间：2012-05-15T19:38:30.053
> 
> 标签：c++, encryption, directx

请原谅我的白痴……我是一个负责处理 C++ 问题的 PHP 人。

我们的 C++ 应用程序从某些文件中读取数据。我们现在希望在硬盘驱动器上加密这些文件。我确信只有一个 C++ 加密库很容易找到，但该应用程序还调用了一些 DirectX 函数，这些函数也读取相同的文件。

我的团队负责人建议重写由我们的代码和 DirectX 函数调用的低级文件读取函数的可能性。

我的问题是，是否有一些图书馆已经在做这种事情？或者，我们是否以一种奇怪的方式来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:48:11.073

好吧，[OpenSSL](http://www.openssl.org/)。这是[二进制分布](http://slproweb.com/products/Win32OpenSSL.html)。它实际上是 C，而不是 C++，但我认为这并不重要。

另见[加密++](http://www.cryptopp.com/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:21:59.220

通过 NFTS 内置加密来加密您的文件。然后将 ACL 分配给那些限制对受限帐户的访问的文件，并在该帐户的上下文中运行您的程序，或者让程序在尝试读取这些文件之前使用受限帐户的凭据执行 LoginUser()。

# c# - 修饰符 'private' 在 C# 中对此项无效

> ID：10607642
> 
> 赞同：0
> 
> 时间：2012-05-15T19:38:56.417
> 
> 标签：c#, keydown

它给了我这样的错误，我似乎无法弄清楚问题所在。

```
private void Form1.KeyDown(object sender, KeyEventArgs e)  // **THE ERROR HERE**   
    {
        if (ListBox1.Items.Contains(e.KeyCode))
        {
            ListBox1.Items.Remove(e.KeyCode);
            ListBox1.Refresh();
            if (timer1.Interval > 400)
            {

                timer1.Interval -= 10;
            }
            if (timer1.Interval > 250)
            {
                timer1.Interval -= 7;

            }
            if (timer1.Interval > 100)
            {
                timer1.Interval -= 2;

            }
            difficultyProgressBar.Value = 800 - timer1.Interval;
            stats.Update(true);

        }
        else
        {

            stats.Update(false);

        }

        correctLabel.Text = "Correct: " + stats.correct;
        missedLabel.Text = "Missed: " + stats.missed;
        totalLabel.Text = "Total: " + stats.total;
        accuracyLabel.Text = "Accuracy: " + stats.accuracy + "%";

    } 
```

这是一些教程的代码，所以它应该可以工作。可能是什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T19:41:02.897

您的第一行应如下所示：

```
private void Form1_KeyDown(object sender, KeyEventArgs e)
{
    ...
} 
```

没有点。

点使编译器认为您指的是表单的 KeyDown 事件，而您只需要一个侦听该事件的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T19:42:12.760

Interfacename.methodname 语法为显式接口实现保留。接口只包含公共方法，因此“私有”是非法的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T19:42:49.227

在 VB 中，当您声明一个事件处理程序时，您会继续添加`Handles <Class>.<Event>`，它会自动为您连接所有内容。在 C# 中，事件处理程序只是附加到事件的方法。因此，您应该将方法名称重命名为`Form1_KeyDown`。但是，您仍然需要连接它（通过 Visual Studio 设计器或在代码中）。

```
public class Form1 : Form
{
    ...
    public Form1()
    {
        InitializeComponent();
        this.KeyDown += new KeyEventHandler(this.Form1_KeyDown);
    }
    ...
    private void Form1_KeyDown(object sender, KeyEventArgs e) { ... }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-16T19:14:27.617

我刚收到此错误，发现标记方法上方的代码中缺少右括号。坏括号对搞砸了私有布尔方法的识别......

# python - 如何以编程方式将多个路径附加到 PYTHONPATH

> ID：10607643
> 
> 赞同：7
> 
> 时间：2012-05-15T19:38:59.370
> 
> 标签：python, path, pythonpath

我有 4 个目录：

```
/home/user/test1
/home/user/test2
/home/user/test3
/home/user/test4 
```

我有另一个包含测试的目录

```
/home/user/testing 
```

拥有文件 testall.py

ow，我如何将 test1 到 test4 的 PATHS 附加到 PYTHONPATH，以便我可以访问 test1 到 4 下的文件。

顺便说一句，test1 到 4 在它们下面有多个目录，这些目录是 python 文件所在的位置。

我试过：

```
import sys
import os
PROJECT_ROOT = os.path.dirname(__file__)
sys.path.insert(0,os.path.join(PROJECT_ROOT,"test1"))
sys.path.insert(1,os.path.join(PROJECT_ROOT,"test2"))
sys.path.insert(2,os.path.join(PROJECT_ROOT,"test3"))
sys.path.insert(3,os.path.join(PROJECT_ROOT,"test4")) 
```

似乎没有工作

还：

```
import sys
sys.path.append('/home/user/test1','/home/user/test2','/home/user/test3','/home/kahmed/test4')
from test1.common.api import GenericAPI 
```

不工作。

基本上： from test1.common.api import GenericAPI 应该可以工作

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2019-05-30T14:31:06.950

`sys.path.append('/home/user/test1','/home/user/test2', ...)`不起作用，因为`append()`函数只能接受 1 个参数。

您可以使用的是：

```
import sys
sys.path += ['/home/user/test1','/home/user/test2','/home/user/test3','/home/kahmed/test4'] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-15T20:17:13.907

试试这个：

```
import sys
sys.path.append('/home/user/')
from test1.common.api import GenericAPI 
```

不建议这样做，但也许会做你想做的事？因为我猜你的文件*不在*文件夹`/home/user/test1/test1/common/api/`中......

给定一个 python 路径`["a", "b", "c"]`，试图`import a.b.c`将查找`a/a/b/c`，然后`b/a/b/c`和`c/a/b/c`。但是，*不在*. `a/b/c`没有以*开头*的模块名称和以*结尾*的`a`python 路径然后省略其中一个s 的匹配。严格来说是路径+模块，而不是路径的一部分+模块的一部分。*`a``a`*

 *既然您的问题是关于“多条路径”的，那么*单*条路径对您有用吗？好像不是这样...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-15T05:43:36.587

更像这样：

```
sys.path.append \
("C:\\Program Files\\DIgSILENT\\...");("C:\\Programs\\eclipse...") 
```*

# git - 使用 GIT 和 Bitbucket，我应该从本地开发者推送到 Bitbucket 还是导入和克隆？

> ID：10607646
> 
> 赞同：1
> 
> 时间：2012-05-15T19:39:06.860
> 
> 标签：git, wamp, bitbucket, git-push, git-clone

我正在使用 WAMP 服务器进行本地开发，并且最近开始使用 GIT。我想使用 Bitbucket 保留我工作的私人备份副本，我认为这就是它的用途。我似乎无法理解是否应该首先将我的项目目录上传到 Bitbucket，然后将其克隆到我的本地开发区域，或者首先在我的本地项目文件夹中创建一个 repo 并将其推送到 Bitbucket，或者最终是否有区别结果。最终，我希望将所有内容复制到 Bitbucket。

编辑我读[了这个](https://stackoverflow.com/questions/4172174/backup-a-local-working-directory-on-bitbucket-clone-or-push)，但我不认为它回答了我的问题，因为它正在谈论将本地存储库克隆到 Bitbucket，而我正在询问是否导入 Bitbucket 支持的本地存储库，然后将其从 Bitbucket 克隆到我的本地开发人员, BB 也支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:41:04.050

无论哪种方式都可以，但是如果您进行了正确的导入，您还将导入您以前的 git 历史记录，这可能是您想要的。

但一般来说，在 bitbucket 中创建一个新的 git 存储库并（以某种方式）将文件移动到其中、提交和推送并不是那么糟糕。

# php - jPlayer - Safari 在播放时未接收到标题 - 无法正确缓冲

> ID：10607648
> 
> 赞同：1
> 
> 时间：2012-05-15T19:39:13.333
> 
> 标签：php, safari, jplayer

我正在使用 jPlayer 播放媒体，我还使用 PHP 下载脚本将内容传送到 jPlayer。

我在使用 Safari 时遇到问题，音频无法正确缓冲。最初认为这是一个 Accept-Ranges 问题，我确保传递了正确的标题。

在 Firefox 中，如下面的屏幕截图所示，标头可以正常通过，并且一切正常。

[![](../Images/f564feabe3957b0003436e98f2b62dd0.png)](https://i.stack.imgur.com/tMfRl.png)

但是，在 Safari 中，当我单击播放时会发生以下情况：

[![](../Images/156c19b201c75038233eb8a33137550a.png)](https://i.stack.imgur.com/vZevb.png)

如您所见，它称为下载脚本，但状态仍处于挂起状态且不会更改。奇怪的是，音频播放正常。

在查看收到的标头时，它让我更加困惑，因为似乎没有发送标头：

[![](../Images/98504b9682207eae042035793a1be201.png)](https://i.stack.imgur.com/6ahDm.png)

这些是我从下载脚本发送的标头，省略了位：

```
...

header("Content-Type: ".$mimeTypes[$ext]);
header('Content-Disposition: attachment; filename="Test - '.$_GET[title].'.mp3"');
header('Accept-Ranges: bytes');
$begin  = 0;
$end    = $fsize - 1;

if (preg_match('/bytes=\h*(\d+)-(\d*)[\D.*]?/i', $_SERVER['HTTP_RANGE'], $matches))
{
    $begin  = intval($matches[1]);
    if (!empty($matches[2]))
    {
        $end    = intval($matches[2]);
    }
}

header('Content-Length:' . (($end - $begin) + 1));
header("Content-Range: bytes $begin-$end/$fsize"); 
```

我将文件发送到 jPlayer 的 javascript 是：

```
 $("#jquery_jplayer_1").jPlayer("setMedia", { mp3: "/download.php?track=" + id });
    $("#jquery_jplayer_1").jPlayer("play"); 
```

如果有人能指出我正确的方向，我是否错过了 Safari 需要的一些关键标题信息 - 或者......？

非常感谢。

# android - 使用 SQLite3 行条目（光标）和字符串填充 Spinner

> ID：10607649
> 
> 赞同：0
> 
> 时间：2012-05-15T19:39:19.737
> 
> 标签：android, simplecursoradapter, android-spinner

所以我想用像“All”这样的字符串填充 Spinner，然后是 SQLite db 的所有条目。我已经搜索了如何在没有任何运气的情况下这样做。我已经设置了所有设置来处理选择“全部”或实际条目的条目，但我不知道如何将条目“全部”添加到微调器或适配器。

我目前正在使用 SimpleCursorAdapter（我知道它已被弃用）。我应该使用其他类型的适配器吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:42:18.857

您应该为微调器创建动态数组并在数组中添加数据

```
List<String> arrayList = new ArrayList<String>();
arrayList.add("All"); 
```

现在使用游标获取数据并添加到arrayList（使用for循环或while循环逐一添加）和setAdapter与arrayList。

```
ArrayAdapter adapter = new ArrayAdapter<String>(YOURCLASSNAME.this,android.R.layout.simple_spinner_item,arrayList);
spinner.setAdapter(adapter); 
```

# sql-server - 查找约束失败的罪魁祸首行

> ID：10607650
> 
> 赞同：0
> 
> 时间：2012-05-15T19:39:32.577
> 
> 标签：sql-server, datatable, constraints, sqlbulkcopy

知道当约束测试失败时是否可以在 INSERT/UPDATE 语句中获取麻烦的行列表？

我正在尝试使用从 DataTable 读取数据的 SQLBulkCopy 对象插入数据，当约束失败时，我无法判断是哪些行导致了问题。DataTable 非常大，实际上是来自 XML 文件的数据，因此我无法真正针对该源运行 SELECT 语句来查找与约束的选择条件匹配的行。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-18T20:46:31.693

仅供参考 找不到从框架中获取此信息的方法，因此构建了一个帮助程序类，该类可以在 SqlBulkCopy 进程失败时检索所有错误和相关数据行。详情见这里：[http ://www.codeproject.com/script/Articles/ArticleVersion.aspx?waid=13789&aid=387465](http://www.codeproject.com/script/Articles/ArticleVersion.aspx?waid=13789&aid=387465)

# iphone - 用于内部分发的 iPhone 配置实用程序的代码签名错误

> ID：10607655
> 
> 赞同：0
> 
> 时间：2012-05-15T19:39:56.437
> 
> 标签：iphone

我们拥有企业许可证，可以在内部分发我们的应用程序。从 developer.apple.com 上的那个帐户，我们生成了一个配置文件。在某些人的机器上，配置文件有效，他们能够安装应用程序。在其他人身上，他们得到，

> “无法在设备上安装应用程序。错误：已添加、修改或删除签名资源。”

有没有什么特别的东西我可以检查一下为什么它在某些人的机器上工作而不在其他人的机器上工作？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:02:43.060

您是否在 PC（基于 Windows）系统上获得此功能？如果是这样，请检查文件名，就可以在文件名中使用的字符而言，Mac OS X 比 Windows 更灵活。

# c# - 在 MATLAB 中调用 .NET 泛型类的静态方法？

> ID：10607656
> 
> 赞同：2
> 
> 时间：2012-05-15T19:39:58.010
> 
> 标签：c#, .net, matlab, generics

如何在 MATLAB 中调用 .NET 泛型类的静态方法？

例如，我将如何调用`Create`下面显示的静态方法？

```
public class A<T> {

    internal A() {      
    }

    public static A<T> Create() {
        return new A<T>();
    }
} 
```

[http://www.mathworks.com/help/techdoc/matlab_external/brz16z_-1.html](http://www.mathworks.com/help/techdoc/matlab_external/brz16z_-1.html)谈论调用泛型类的静态泛型方法，但它没有显示如何调用泛型的静态非泛型方法班级。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:46:35.903

所以在你拥有的那个链接上，它说：

> 调用泛型类的泛型函数 如果泛型方法使用与泛型类相同的参数化类型，则可以直接在类对象上调用该函数。如果泛型使用与类不同的类型，请使用 NET.invokeGenericMethod 函数。

所以看起来你应该能够做到：

```
genClsDef = NET.GenericClass('A','System.Double');
ret = NET.invokeGenericMethod(genClsDef,'A','System.Double'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-13T13:08:09.447

以下代码应该可以调用通用非静态类的静态方法：

```
c = NET.createGeneric('A',{'System.Double'});
d = c.Create() 
```

# mysql - 进行mysql查询以从某个表中查找所有人

> ID：10607658
> 
> 赞同：2
> 
> 时间：2012-05-15T19:40:01.173
> 
> 标签：mysql

假设我有一张桌子`Person`，我还有另外 3 `Doctor`, `Policeman`, `Lawyer`.... 这 3 张桌子`idPerson`从中获取共同的属性，如姓名 surname 等.... 如果我想找到所有医生或律师的人他们从表中的共同信息`Person`，我该怎么做？

我尝试过类似的东西（通过将所有组合右连接，左连接，内连接来播放）

```
SELECT Person.* 
FROM Person 
RIGHT JOIN doctor ON doctor.idPerson = person.idPerson 
LEFT JOIN lawyer ON lawyer.idPerson = person.idPerson 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:43:20.090

除了使用连接之外，您可能会发现使用起来更简单`EXISTS`：

```
SELECT col1, col2, ... coln
FROM Person
WHERE EXISTS (
    SELECT * FROM Doctor WHERE Doctor.idPerson = Person.idPerson
) OR EXISTS (
    SELECT * FROM Lawyer WHERE Lawyer.idPerson = Person.idPerson
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:43:32.030

试试这个

```
SELECT Person.* 
FROM Person 
LEFT JOIN doctor ON doctor.idPerson = person.idPerson 
LEFT JOIN lawyer ON lawyer.idPerson = person.idPerson
WHERE lawyer.idPerson IS NOT NULL 
OR doctor.idPerson IS NOT NULL 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T19:43:50.297

```
SELECT Person.* FROM Person 
left outer JOIN doctor ON doctor.idPerson = person.idPerson 
LEFT outer JOIN lawyer ON lawyer.idPerson = person.idPerson
where doctor.personid is not null
or laywer.personid is not null 
```

# wpf - Windows Phone 7 溢出剪辑

> ID：10607659
> 
> 赞同：0
> 
> 时间：2012-05-15T19:40:02.673
> 
> 标签：wpf, silverlight, windows-phone-7

我在一个网格中有一个网格，我希望第二个的内容可以移动而不侵犯第一个网格。

很像全景视图，但可以左右移动以及上下移动。

我可以让它工作，但不幸的是，当您将顶部溢出向下移动到外部网格中时，会覆盖其中的任何控件。

有没有办法像 CSS 溢出一样隐藏溢出：隐藏？

任何帮助都会被真正占用。

谢谢安德鲁

可能的解决方案：

```
var gridWidth = (this.tilesize * (this.gridSize - 1)) / 2;
var top = -(((-offsetY + tileY) * this.tilesize) - gridWidth);
var left = -(((-offsetX + tileX) * this.tilesize) - gridWidth);
this.Container.Margin = new Thickness(left, top, 0, 0);
var clipSection = new RectangleGeometry();
clipSection.Rect = new Rect(-1 * left, -1 * top, 480, 400);
this.Container.Clip = clipSection;
this.Container.Dispatcher.BeginInvoke(new ThreadStart(delegate
{
  this.Container.Clip = clipSection;
})); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:42:08.427

您可以通过在“外部”网格的单元格中放置一些东西并看到比您正在移动的元素更高的 ZIndex 来做到这一点。ZIndex 较高的元素出现在较低的元素之上。

# model-view-controller - 结合 cms 和 mvc

> ID：10607662
> 
> 赞同：1
> 
> 时间：2012-05-15T19:40:35.910
> 
> 标签：model-view-controller, content-management-system

我正在尝试构建一个也有很多内容要显示的应用程序。所以基本上我想知道如果我尝试结合 cms 和 mvc 是一个好主意。我曾在各种 cms 和 mvc 上独立工作。如果我在一个应用程序中同时使用两者，是否会有任何冲突的参数？同时使用两者是否是个好主意？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-16T15:46:56.393

没有*“各种 mvc”*。MVC 是一种设计模式，它使您可以将业务逻辑与表示分离。阅读：*Martin Fowler 的*[**UI 架构**](http://martinfowler.com/eaaDev/uiArchs.html) 。我有一种感觉，对于“mvc”，您（错误）理解“MVC 框架”，这是完全不同的东西，而且通常不是，并没有真正实现该模式。

 *可以（并且许多人选择）基于 MVC 模式和设计原则构建 CMS。

但是**不可能**将随机的 MVC 框架和随机的内容管理系统神奇地复制粘贴在一起。

您可以做的最好的事情是离开 CMS 进行站点管理，并创建一个基于 MVC 的单独前端。不管有没有框架。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:43:40.853

实际上，我认为您应该构建一个 CMS 控制器/模型/视图。

所以如果你理论上有一些控制器方法：

```
class Pages_Controller extends Controller {
    function viewPage( $id ) {
        get_db_content($id);
    }
} 
```

并使用您的路由器清理网址。理论上似乎很容易。

如果您能以这种方式成功地做到这一点，您将避免很多通常在尝试组合两个框架时出现的问题。*

# c# - 何时在 Visual Studio 2010 工具箱中隐藏/禁用控件？

> ID：10607665
> 
> 赞同：1
> 
> 时间：2012-05-15T19:40:39.387
> 
> 标签：c#, visual-studio-2010, user-controls, windows-forms-designer, design-time

在 Visual Studio 2010 工具箱中禁用控件的一些标准是什么？

如果用户启用“全部显示”，则工具箱中的所有控件都会显示，但其中一些控件会被禁用。是什么导致控件被禁用？

一个原因可能是控件是否无法拖放到设计图面上，具体取决于打开的文档类型。

但是，我注意到，在 Visual Studio 2010 中开发 3.5 Windows 窗体应用程序时，我的 .NET 3.5 控件被禁用。可能导致此问题的原因是什么？

任何帮助是极大的赞赏。

达特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-02T19:18:52.747

我通过选择项目 - > 属性，在应用程序选项卡中，选择 .NET 框架客户端配置文件到 .Net 框架解决了这个问题。在此之后启用控件。

这似乎是导致这种情况发生的目标框架。

希望这对你有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:43:55.667

这取决于您的项目，如果此目标 .net 2 您看不到 .net 4 控件，则与目标 2.0.3.5 等第三方控件非常常见

我的经验是使用第三方控件。

# android - 安卓。如果应用程序仅支持纵向模式，如何确定屏幕方向？

> ID：10607671
> 
> 赞同：1
> 
> 时间：2012-05-15T19:40:49.553
> 
> 标签：android, bitmap, orientation, landscape, portrait

我的 Android 应用程序只能纵向工作。横向模式被禁用

```
setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT). 
```

但是我有一个带有签名视图（自定义视图）的对话框，用户使用它来绘制他的签名。结果它给出了一个位图。我还有一个用于保存签名预览的 ImageView，它显示上述位图。用户可以在绘制签名时随心所欲地握住他的设备。因此，我的应用程序应根据当前屏幕位置旋转生成的位图。例如，用户以角度 = 90 度绘制他的签名，我想将位图旋转 90 度，我的应用程序将以纵向模式正确显示签名位图。问题是只支持纵向模式，以下方法不起作用：

```
int rotation = getResources().getConfiguration().orientation; 
```

或者

```
int rotation = getWindowManager().getDefaultDisplay().getOrientation(); 
```

这些语句的结果始终为 0。

那么，如果禁用方向更改，我如何获得设备的当前位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T01:32:20.823

您可以使您的对话框成为一个单独的活动，并使其不限于纵向。

# html - CSS 百分比在 IE 中完全失败

> ID：10607672
> 
> 赞同：0
> 
> 时间：2012-05-15T19:40:55.057
> 
> 标签：html, internet-explorer, layout, css

我刚刚为我的摄影设计了一个网页。我使用 Chrome 作为我的测试浏览器。

但是在 IE 上打开我的页面，什么都看不到。在遇到一些麻烦之后，我将问题与我使用百分比的事实隔离开来。我在网上搜索了解决方案，但一切都是关于微小的变化（与填充和百分比有关）。

这是一个简单的 HTML 文件，它可以在 Chrome 中完美运行，但并非全部在 IE 中运行（div 是一个无像素框，由于文本的存在而略微扩展）。非常感谢您的帮助。如果我不能解决这个问题，我将不得不完全重新设计我的网站。

```
<html>
<head>
    <title>A test HTML</title>
    <style type="text/css">
        #currpage
        {
            position: absolute;
            bottom: 18%;
            right: 10%;
            left: 35%;
            top: 15%;
            border:2px solid green;
            z-index: 240;
        }
    </style>
</head>
<body>
    <div id="currpage" style="visibility: visible; opacity: 1;">
        This is just a test.
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T19:43:39.020

您是否尝试过...实际上制作了格式良好的 HTML 文件？

如果没有`DOCTYPE`，浏览器会以 Quirks 模式呈现页面。在 IE 的情况下，它像在 IE5.5 中一样呈现，它不支持很多现在基本的东西。

添加`<!DOCTYPE HTML>`到文件的开头。

**编辑**：当您使用它时，请*始终包含一个 Content-Type`<meta>`标记*（例如，`<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />`以便浏览器知道编码是什么。还考虑添加`<meta http-equiv="X-UA-Compatible" content="IE=edge" />`以强制 IE 使用它拥有的最严格的标准模式。这些出现在每一个我的页面，甚至是空白模板。 DOCTYPE 和 Content-Type 是必需的（如果您希望它实际工作），并且 Compatible 标题是可选的（我主要使用它来摆脱令人讨厌的关闭的 Compatibility Mode 按钮到刷新按钮...）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:45:28.517

好吧，我在mac上，所以我无法检查它，但是您的HTML中似乎没有doctype，因此IE可能会遇到麻烦，因为他不知道如何解析您的代码。

在第一行（甚至在`<html>`-Tag 之前写下以下内容：

```
<!DOCTYPE html> 
```

这是针对 HTML5 文档的。

**编辑：** ....编辑....忘记这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T20:13:18.347

明确设置包含元素的高度和宽度。我的一个旧页面也有类似的问题（在 Firefox 和 Chrome 中运行良好，在 IE 中下地狱），我发现如果没有明确分配，Firefox 和 Chrome 将自动设置包含元素的尺寸然后将这些百分比基于这些假设。IE 没有做出这样的假设，所以当它查看百分比时，它基本上会说“嗯 35% 的什么？”

# django - 在 is_valid() 之后将 django 表单设置为错误

> ID：10607674
> 
> 赞同：6
> 
> 时间：2012-05-15T19:41:00.493
> 
> 标签：django, django-forms

在使用 is_valid() 验证表单后，我需要调用 API 函数。此 API 调用仍会引发异常，这反过来可能会使表单中的字段无效。

我怎样才能做到这一点？我正在寻找类似的东西：

```
def smstrade(request):
    if request.method == "POST":
        form = SomeForm(request.POST)
        if form.is_valid():
            try:
                api_call(...)
            except SomeException:
                form["field"].set_valid(False) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-01T03:54:37.960

有点晚了，但是您可以通过设置 form._errors 使表单无效并添加显示适当的消息

```
>>> f.is_valid()
True
>>> f._errors['my_field'] = ['This field caused a problem']
>>> f.is_valid()
False
>>> str(f)
... <ul class="errorlist"><li>This field caused a problem</li></ul> 
```

`FormView.form_valid()`我需要使用具有独特字段的方法和模型来做到这一点

```
def form_valid(self, form):
  obj = User(**form.cleaned_data)
  try:
    obj.save()
  except IntegrityError:
    form._errors['username'] = ['Sorry, already taken']
    return super(MyView, self).form_invalid(form)

  return super(MyView, self).form_valid(form) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T20:09:00.317

最好覆盖您感兴趣的字段的[clean 方法并在那里添加您的逻辑。](https://docs.djangoproject.com/en/dev/ref/forms/validation/#cleaning-a-specific-field-attribute)这样，您也可以输出适当的错误消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T20:06:28.070

听起来您只需要一个变量来存储表单对象之外的有效状态。

```
def smstrade(request):
    if request.method == "POST":
        form = SomeForm(request.POST)
        valid = form.is_valid()
        if valid:
            try:
                api_call(...)
            except SomeException:
                valid = False
        if valid: # still valid?
            print "VALID!" 
```

但实际上，您似乎应该将其放入表单本身，以便您只需要调用`is_valid()`一次。唯一的复杂情况是您是否需要访问请求对象。

```
class MyForm(forms.Form):
    def clean(self):
        cd = super(MyForm, self).clean()
        try:
           api_call
        except Exception:
           raise forms.ValidationError("API Call failed")
        return cd

# view..
if form.is_valid():
     print "api call success and the rest of the form is valid too." 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-24T09:42:42.020

如果您真的想通过调用`is_valid`第二个来触发表单验证，这就是您可以做到的方式（Django 1.4）

```
form = MyForm(data)
form.is_valid()
# ...
form._errors = None
form.is_valid() # trigger second validation 
```

# ruby-on-rails - 使用 Rails 进行敏捷 Web 开发第 14 章

> ID：10607681
> 
> 赞同：1
> 
> 时间：2012-05-15T19:41:32.560
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在按照本书第 14 章“登录”中的示例编写。我在“127.0.0.1:3000/login”中的观点运作良好，但如果我插入我的用户名和密码，它会返回此错误：

SessionsController#create 中的 NoMethodError

#< 用户：0x9f75978> 的未定义方法“身份验证”

如何解决？

创建方法 session_controller.rb 是：

```
 def create
    user = User.find_by_name(params[:name])
    if user and user.authenticate(params[:password])
      session[:user_id] = user.id
      redirect_to admin_url
    else
      redirect_to login_url, alert: "Invalid user/password combination"
    end
  end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T19:42:37.787

它正在尝试调用`authenticate`用户，这意味着您可能没有用户身份验证方法。如果你这样做，请确保它不是私人的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-22T02:14:42.967

您提供的代码尝试在User 对象的*实例*`authenticate`上调用该方法。

 *根据您的评论：`User.authenticate(name, password)`您仅在 User*类*上有一个身份验证方法- 它同时将名称和密码作为参数。

要调用 User 类方法，您可以使用以下代码：

```
user = User.find_by_name(params[:name])
if user && User.authenticate(params[:name], params[:password]) 
```

或者，寻找一个名为的实例级方法`authenticate`（如上面提到的@caulfield）看起来像：

```
def authenticate(password)
  # does stuff
end 
```

代替`User.authenticate(name,password)`*

# c# - asp.net Web 服务中的 maxItemsInObjectGraph？

> ID：10607686
> 
> 赞同：0
> 
> 时间：2012-05-15T19:41:57.813
> 
> 标签：c#, .net, web-services

我们的一个客户正在使用我创建的 asp.net Web 服务 (asmx)，并且收到错误消息，指出 maxItemsInObjectGraph 太小。我告诉他在他的 app.config 文件中进行必要的更改。但是我必须在哪里进行这些更改？我的 Web 服务中的 web.config 文件没有提到 maxItemsInObjectGraph。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:52:41.077

因为它有一个默认值，当它不在您的配置中时使用。您必须将其添加到您的 web.config 或您的代码中，如此[处](https://stackoverflow.com/questions/6298209/how-to-fix-maxitemsinobjectgraph-error)、[此处](http://forums.silverlight.net/t/148523.aspx)、[此处](http://thedotnethub.blogspot.de/2009/10/passing-large-messages-in-wcf.html)或[此处](https://stackoverflow.com/questions/2473620/how-can-i-set-the-maxitemsinobjectgraph-property-programmatically-from-a-silverl)所示。

编辑：对于 ASMX，maxItemsInObjectGraph 没有设置，但设置最大请求长度可能会有所帮助。

```
<location path="yourservice.asmx">
 <system.web>
    <httpRuntime executionTimeout="240" maxRequestLength="20480" />
 </system.web>
</location> 
```

[MSDN 上 httpRuntime 的](http://msdn.microsoft.com/en-us/library/e1f13641.aspx)其他属性

# wordpress - Youtube 视频缩略图问题。图像顶部和底部的黑色空间

> ID：10607687
> 
> 赞同：1
> 
> 时间：2012-05-15T19:41:59.357
> 
> 标签：wordpress

我有一个使用来自 youtube 视频的缩略图的[网站。](http://www.stresssmashers.com)换句话说，您获得的图像，当您将鼠标悬停在视频上时，右键单击它并将图像另存为。问题是视频缩略图上方和下方都有黑色空间。

我可以每次在 imageready 或烟花中裁剪它，但我想知道是否有一种方法可能是一些 css 代码可以从底部和顶部切掉图像，切掉黑色空间。除非黑色空间作为图像的一部分根深蒂固！

任何想法都会有所帮助。谢谢

奥马尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T14:06:19.453

我在这里面临同样的问题。缩略图具有 120x90 像素、4x3 格式（1,333 纵横比）。似乎视频宽高比，YT 生成这些黑条。

使用 CSS，我们可以使用“background-position”属性将缩略图设置为 a 的背景，然后计算 -11px 以隐藏顶部栏。

# python - 如何在 Python 中创建具有当前日期和时间的文件名？

> ID：10607688
> 
> 赞同：246
> 
> 时间：2012-05-15T19:42:01.167
> 
> 标签：python

这是一个功能代码（成功创建文件）

```
sys.stdout = open('filename1.xml', 'w') 
```

现在我正在尝试用当前日期/时间命名文件（我不是 Python 专家）

```
filename1 = datetime.now().strftime("%Y%m%d-%H%M%S")
sys.stdout = open(filename1 + '.xml', 'w') 
```

我想写出一个带有确切日期和时间的文件名，它是一个 xml 文件，程序已经创建了，我只需要命名文件。上面的代码不起作用。

返回的错误：

```
 File "./fix.py", line 226, in <module>
    filenames = datetime.now().strftime("%Y%m%d-%H%M%S")
AttributeError: 'module' object has no attribute 'now' 
```

* * *

## 回答 #1

> 赞同：498
> 
> 时间：2012-05-15T19:48:07.850

在不使用`datetime`时，这可以解决您获取具有您指定的当前时间和日期格式的字符串的问题（回答您的问题）：

```
import time
timestr = time.strftime("%Y%m%d-%H%M%S")
print timestr 
```

产量：

```
20120515-155045 
```

所以你的文件名可以附加或使用这个字符串。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2012-05-15T19:55:09.447

更改此行

```
filename1 = datetime.now().strftime("%Y%m%d-%H%M%S") 
```

到

```
filename1 = datetime.datetime.now().strftime("%Y%m%d-%H%M%S") 
```

注意额外的`datetime`. 或者，将您的更改 `import datetime`为`from datetime import datetime`

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2012-05-15T19:53:53.607

[`now`](http://docs.python.org/library/datetime.html#datetime.datetime.now)`datetime`是模块中类中的类方法`datetime`。所以你需要

```
datetime.datetime.now() 
```

或者您可以使用不同的导入

```
from datetime import datetime 
```

这样做可以让您`datetime.now`按照问题中的代码使用。

* * *

## 回答 #4

> 赞同：36
> 
> 时间：2019-08-15T18:26:27.273

这一个更具人类可读性。

```
from datetime import datetime

datetime.now().strftime("%Y_%m_%d-%I_%M_%S_%p") 
```

```
'2020_08_12-03_29_22_AM' 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-01-20T02:31:45.593

我很惊讶没有一些单一的格式化程序返回默认（和安全）“用于附加文件名” - 当时的格式，我们可以简单地写`FD.write('mybackup'+time.strftime('%(formatter here)') + 'ext'`

```
"%x" instead of "%Y%m%d-%H%M%S" 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-12-26T03:48:30.293

这是我需要在文件夹名称中包含日期时间戳的一些内容，以便从网络抓取工具中转储文件。

```
# import time and OS modules to use to build file folder name
import datetime
import time
import os

# Build string for directory to hold files
# Output Configuration
#   drive_letter = Output device location (hard drive) 
#   folder_name = directory (folder) to receive and store PDF files

drive_letter = r'D:\\' 
folder_name = r'downloaded-files'
folder_time = datetime.now().strftime("%Y-%m-%d_%I-%M-%S_%p")
folder_to_save_files = drive_letter + folder_name + folder_time 

# IF no such folder exists, create one automatically
if not os.path.exists(folder_to_save_files):
    os.mkdir(folder_to_save_files) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-02-04T06:46:18.300

这以易于阅读的格式打印 -

```
import datetime

time_now  = datetime.datetime.now().strftime('%m_%d_%Y_%H_%M_%S') 

print(time_now) 
```

输出：`02_03_2021_22_44_50`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-12-10T11:57:48.913

```
import datetime

def print_time():
    parser = datetime.datetime.now() 
    return parser.strftime("%d-%m-%Y %H:%M:%S")

print(print_time())

# Output>
# 03-02-2021 22:39:28 
```

# spring - Spring Security：自定义用户详细信息

> ID：10607696
> 
> 赞同：10
> 
> 时间：2012-05-15T19:42:47.677
> 
> 标签：spring, spring-security

我对 Java 和 Spring 3 很陌生（过去 8 年主要使用 PHP）。我已经让 spring security 3 与所有默认的 userDetails 和 userDetailsS​​ervice 一起工作，我知道我可以通过以下方式访问控制器中登录用户的用户名：

```
Authentication auth = SecurityContextHolder.getContext().getAuthentication();
String username = auth.getName(); //get logged in username 
```

但是有两个问题我想不通：

1.  我希望在用户登录时存储许多其他用户详细信息（例如 DOB、性别等），以便稍后通过控制器访问。我需要做什么才能使创建的 userDetails 对象包含我的自定义字段？

2.  我已经在调用“HttpSession session = request.getSession(true);” 在我的控制器中每个方法的顶部。是否可以在登录时将登录用户的 userDetails 存储在会话中，这样我就不需要调用“Authentication auth = SecurityContextHolder.getContext().getAuthentication();” 在每个方法的开头？

安全-applicationContext.xml：

```
<global-method-security secured-annotations="enabled"></global-method-security>     
<http auto-config='true' access-denied-page="/access-denied.html">
    <!-- NO RESTRICTIONS -->        
    <intercept-url pattern="/login.html" access="IS_AUTHENTICATED_ANONYMOUSLY" />
    <intercept-url pattern="/*.html" access="IS_AUTHENTICATED_ANONYMOUSLY"  /> 
    <!-- RESTRICTED PAGES -->
    <intercept-url pattern="/admin/*.html" access="ROLE_ADMIN" />
    <intercept-url pattern="/member/*.html" access="ROLE_ADMIN, ROLE_STAFF" />

    <form-login login-page="/login.html"
                login-processing-url="/loginProcess"
                authentication-failure-url="/login.html?login_error=1"
                default-target-url="/member/home.html" />
    <logout logout-success-url="/login.html"/>
</http>

<authentication-manager>
    <authentication-provider>
        <jdbc-user-service data-source-ref="dataSource" authorities-by-username-query="SELECT U.username, UR.authority, U.userid FROM users U, userroles UR WHERE U.username=? AND U.roleid=UR.roleid LIMIT 1" />
        <password-encoder hash="md5"/>
    </authentication-provider>
</authentication-manager> 
```

登录.jsp：

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib uri="http://tiles.apache.org/tags-tiles" prefix="tiles" %>
<%@ taglib uri="http://www.springframework.org/tags/form" prefix="form"%>

<tiles:insertDefinition name="header" />
<tiles:insertDefinition name="menu" />
<tiles:insertDefinition name="prebody" />

<h1>Login</h1>

<c:if test="${not empty param.login_error}">
    <font color="red"><c:out value="${SPRING_SECURITY_LAST_EXCEPTION.message}"/>.<br /><br /></font>
</c:if>
<form name="f" action="<c:url value='/loginProcess'/>" method="POST">
    <table>
        <tr><td>User:</td><td><input type='text' name='j_username' value='<c:if test="${not empty param.login_error}"><c:out value="${SPRING_SECURITY_LAST_USERNAME}"/></c:if>' /></td></tr>
            <tr><td>Password:</td><td><input type='password' name='j_password' /></td></tr>
            <tr><td>&nbsp;</td><td><input type="checkbox" name="_spring_security_remember_me" /> Remember Me</td></tr>
            <tr><td>&nbsp;</td><td><input name="submit" type="submit" value="Login" /></td></tr>
        </table>
    </form>

<tiles:insertDefinition name="postbody" />
<tiles:insertDefinition name="footer" /> 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-05-15T20:26:02.763

这个问题发生了很多事情。我会尝试分段解决它...

Q#1：这里有几种可能的方法。

方法 #1：如果您有其他属性要添加到 UserDetails 对象，那么您应该提供自己的 UserDetails 接口的替代实现，其中包括这些属性以及相应的 getter 和 setter。这将要求您还提供您自己的 UserDetailsS​​ervice 接口的替代实现。该组件必须了解如何将这些附加属性保存到底层数据存储中，或者在从该数据存储中读取时，必须了解如何填充这些附加属性。你会像这样连接所有这些：

```
<beans:bean id="userDetailsService" class="com.example.MyCustomeUserDetailsService">
<!-- ... -->
</beans:bean>

<authentication-manager alias="authenticationManager">
    <authentication-provider ref="authenticationProvider"/>
</authentication-manager>

<beans:bean id="authenticationProvider" class="org.springframework.security.authentication.dao.DaoAuthenticationProvider">
    <beans:property name="userDetailsService" ref="userDetailsService"/>
</beans:bean> 
```

方法#2：像我一样，您可能会发现（尤其是在多次迭代中）最好将特定域的用户/帐户详细信息与Spring Security 特定的用户/帐户详细信息*分开。*这对你来说可能是也可能不是。但是如果你能在这种方法中找到任何智慧，那么你会坚持你当前的设置并添加一个额外的用户/帐户域对象、相应的存储库/DAO等。如果你想检索特定于域的用户/帐户，您可以执行以下操作：

```
User user = userDao.getByUsername(SecurityContextHolder.getContext().getAuthentication().getName()); 
```

Q#2：Spring Security 自动将 UserDetails 存储在会话中（除非您已明确采取措施覆盖该行为）。因此，您无需在每个控制器方法中自己执行此操作。您一直在处理的 SecurityContextHolder 对象实际上（由 SS）在每个请求开始时使用 SecurityContext 填充，包括 Authentication 对象、UserDetails 等。此上下文在每个请求结束时被清除，但数据始终保留在会话中。

然而，值得注意的是，如果可以避免的话，在 Spring MVC 控制器中处理 HttpServletRequest、HttpSession 对象等并不是一个很好的做法。Spring 几乎总是提供更清洁、更惯用的方法来实现目标，*而无需*这样做。这样做的好处是控制器方法签名和逻辑不再依赖于在单元测试中难以模拟的东西（例如 HttpSession），而不是依赖于您自己的域对象（或那些域对象的存根/模拟） ）。这极大地增加了控制器的可测试性......从而增加了您实际测试控制器的可能性。:)

希望这会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-23T02:28:25.393

在我看来，自定义 UserDetails 实现很棒，但只应用于用户的不可变特征。

一旦您的自定义用户对象覆盖了 UserDetails，就不容易更改。您必须使用修改后的详细信息创建一个全新的身份验证对象，并且不能将修改后的 UserDetails 对象重新粘贴到安全上下文中。

在我正在构建的应用程序中，我已经意识到这一点并且必须重新构建它，以便在成功的身份验证后，有关用户的详细信息随每个请求而变化（但我不想在每次页面加载时从数据库重新加载）将需要单独保存在会话中，但仍然只能在身份验证检查后访问/更改。

试图弄清楚[https://stackoverflow.com/a/8769670/1411545](https://stackoverflow.com/a/8769670/1411545)中提到的这个 WebArgumentResolver 是否适合我的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T20:10:32.747

直接访问会话有点混乱，而且容易出错。例如，如果用户使用记住我或其他不涉及重定向的机制进行身份验证，则在该请求完成之前不会填充会话。

我会使用自定义访问器接口来包装对`SecurityContextHolder`. 请参阅[我对这个相关问题的回答](https://stackoverflow.com/a/8765597/241990)。

# c++ - 在 MFC 中访问多个编辑框

> ID：10607698
> 
> 赞同：0
> 
> 时间：2012-05-15T19:42:51.307
> 
> 标签：c++, mfc

我正在编写一个 MFC 程序，其中有很多编辑框，我想获取它们的所有文本值并将它们放入容器中。如何在不为每个 ID 写一行的情况下实现这一点。我对每个 ID 都使用了这段代码：
`CEdit *edit;`
`edit = reinterpret_cast<CEdit *>(GetDlgItem(IDC_NAME1));`
但如果我使用这种方法，我将不得不写 45 次。这似乎不对。有没有办法将所有编辑框放在一个容器中，这样我就可以以这种方式或类似的方式使用它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:52:26.643

您当然可以创建一个数组（或其他容器）或指向 CEdit 的指针：`CEdit edits[45];`如果`IDC_NAME1`through的值`IDC_NAME45`是连续的，您可以执行以下操作：

```
for (int i=0; i<45; i++)
   names[i] = reinterpret_cast<CEdit *>(GetDlgItem(IDC_NAME1 + i)); 
```

如果这些标识符可能不连续，那么您可以将它们放在一个数组中，并根据需要索引到该数组中。

一个警告：除非它们类似于一个几乎相同的编辑控件的网格，否则屏幕上的 45 个可能有点多。如果它们像网格，您可能希望查看许多可用的网格控件之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-16T11:41:01.183

您不必使用控件 ID。使用 EnumChildWindows 并仅对编辑控件进行测试。片段如下。

* * *

在对话框的标题中添加以下内容：

```
afx_msg LRESULT OnFoundEdit(WPARAM wParam, LPARAM lParam); 
```

这对cpp：

```
#define WM_U_FOUND_EDIT WM_APP + 0x100

BEGIN_MESSAGE_MAP(CEditCtrlFishingDlg, CDialog)
    ON_MESSAGE(WM_U_FOUND_EDIT, OnFoundEdit)
    .
    .
    .
    .
END_MESSAGE_MAP() 
```

在要开始编辑文本集合的地方写下这一行：

```
 EnumChildWindows(m_hWnd, EnumChildProc, (LPARAM)m_hWnd); 
```

枚举子过程：

```
BOOL CALLBACK EnumChildProc(HWND hwnd, LPARAM lParam)
{
    CString csBuffer;
    LPTSTR pBuf = csBuffer.GetBufferSetLength(MAX_PATH);
    GetClassName(hwnd, pBuf, MAX_PATH);
    csBuffer.ReleaseBuffer();

    if(!csBuffer.CompareNoCase(_T("edit")))
    {
        SendMessage((HWND)lParam, WM_U_FOUND_EDIT, 0, (LPARAM)hwnd);
    }

    return TRUE;

} 
```

和处理程序：

```
LRESULT YourDlg::OnFoundEdit(WPARAM wParam, LPARAM lParam)
{
    CWnd *pWnd = FromHandle((HWND)lParam);
    CString csTxt;

    pWnd->GetWindowText(csTxt);
    // do what you need with text here

    return 0;
} 
```

# wordpress - WordPress 小部件未保存新实例

> ID：10607703
> 
> 赞同：1
> 
> 时间：2012-05-15T19:43:07.500
> 
> 标签：wordpress, instance, widget, product, savechanges

我对 wordpress 小部件有一个非常奇怪的问题。我正在从 Phomedia 主题中编辑现有的 wordpress 小部件，并且我正在尝试再添加一个实例，以便可以使用它来过滤帖子。在代码中它是 $instance['custom']。但是每次我点击保存时，价值都会消失。我真的坚持了好几次，试图找出问题所在，但找不到。这是代码

```
 class MZ_Widget_Latest_Products extends WP_Widget {

            /**
             * Widget Constuctor
             */
            function MZ_Widget_Latest_Products() {
                $widget_ops = array( 'classname' => 'widget_mz_wpsc_latest_products','description' => __( 'Phomedia Latest Products Widget', 'wpsc' ) );
                $this->WP_Widget( 'wpsc_latest_products', __( 'Phomedia Latest Products', 'wpsc' ), $widget_ops );
            }

            /**
             * Widget Output
             *
             * @param $args (array)
             * @param $instance (array) Widget values.
             */
            function widget( $args, $instance ) {

                global $wpdb, $table_prefix;

                extract( $args );

                $title = apply_filters( 'widget_title', empty( $instance['title'] ) ? __( 'Latest Products', 'wpsc' ) : $instance['title'] );

                echo $before_widget;

                if ( $title )
                    echo $before_title . $title . $after_title;
                wpsc_phomedia_latest_product( $args, $instance );
                echo $after_widget;
            }

            /**
             * Update Widget
             *
             * @param $new_instance (array) New widget values.
             * @param $old_instance (array) Old widget values.
             *
             * @return (array) New values.
             */
            function update( $new_instance, $old_instance ) {

                $instance = $old_instance;
                $instance['title']      = strip_tags( $new_instance['title'] );
                $instance['number']     = (int)$new_instance['number'];
                $instance['image']      = (bool)$new_instance['image'];
                $instance['height']     = (int)$new_instance['height'];
                $instance['width']      = (int)$new_instance['width'];
                $instance['custom']     = $instance['custom'];

                return $instance;

            }

            /**
             * Widget Options Form
             *
             * @param $instance (array) Widget values.
             */
            function form( $instance ) {

                global $wpdb;

                // Defaults
                $instance = wp_parse_args( (array)$instance, array(
                    'title' => '',
                    'number' => 4,
                    'width' => 173,
                    'height' => 151
                ) );

                // Values
                $title    = esc_attr( $instance['title'] );
                $number   = (int)$instance['number'];
                $image    = (bool)$instance['image'];
                $width    = (int) $instance['width'];
                $height   = (int) $instance['height']; 
                $custom = $instance['custom']; ?>

                <p><label for="<?php echo $this->get_field_id('custom'); ?>">Custom: <input class="widefat" id="<?php echo $this->get_field_id('custom'); ?>" name="<?php echo $this->get_field_name('custom'); ?>" type="text" value="<?php echo attribute_escape($custom); ?>" /></label></p>
                <p>
                    <label for="<?php echo $this->get_field_id('title'); ?>"><?php _e( 'Title:', 'wpsc' ); ?></label>
                    <input class="widefat" id="<?php echo $this->get_field_id( 'title' ); ?>" name="<?php echo $this->get_field_name( 'title' ); ?>" type="text" value="<?php echo $title; ?>" />
                </p>

                <p>
                    <label for="<?php echo $this->get_field_id( 'number' ); ?>"><?php _e( 'Number of products to show:', 'wpsc' ); ?></label>
                    <input type="text" id="<?php echo $this->get_field_id( 'number' ); ?>" name="<?php echo $this->get_field_name( 'number' ); ?>" value="<?php echo $number; ?>" size="3" />
                </p>

                <p>
                    <input type="checkbox" class="checkbox" id="<?php echo $this->get_field_id( 'image' ); ?>" name="<?php echo $this->get_field_name( 'image' ); ?>"<?php checked($image); ?> onclick="jQuery('.wpsc_latest_image').toggle()">
                    <label for="<?php echo $this->get_field_id( 'image' ); ?>"><?php _e( 'Show Thumbnails', 'wpsc' ); ?></label>
                </p>

                <div class="wpsc_latest_image"<?php if( !checked( $image ) ) { echo ' style="display:none;"'; } ?>>
                    <p>
                        <label for="<?php echo $this->get_field_id('width'); ?>"><?php _e('Width:', 'wpsc'); ?></label>
                        <input type="text" id="<?php echo $this->get_field_id('width'); ?>" name="<?php echo $this->get_field_name('width'); ?>" value="<?php echo $width ; ?>" size="3" />
                        <label for="<?php echo $this->get_field_id('height'); ?>"><?php _e('Height:', 'wpsc'); ?></label>
                        <input type="text" id="<?php echo $this->get_field_id('height'); ?>" name="<?php echo $this->get_field_name('height'); ?>" value="<?php echo $height ; ?>" size="3" />
                    </p>
                </div>
        <?php
            }
        }

        add_action( 'widgets_init', create_function( '', 'return register_widget("MZ_Widget_Latest_Products");' ) );

        function wpsc_phomedia_latest_product( $args = null, $instance ) {
            global $wpdb;
            $args = wp_parse_args( (array)$args, array( 'number' => 3 ) );
            $siteurl = get_option( 'siteurl' );
            $options = get_option( 'wpsc-widget_latest_products' );
            $number  = isset($instance['number']) ? (int)$instance['number'] : 3;
            $image  = isset($instance['image']) ? (bool)$instance['image'] : FALSE;

            if ( isset($instance['width'] ) )
                $width = $instance['width'];

            if ( isset( $instance['height'] ) )
                $height = $instance['height'];

            $latest_products = get_posts( array(
                'post_type'   => 'wpsc-product',
                'numberposts' => $number, 
                'orderby'     => 'post_date',
                'post_parent' => 0,
                'post_status' => 'publish',
                'order'       => 'ASC'
            ) );
            $output = '';

            $total = count( $latest_products ); 
            $i = 0; 
            if ( count( $latest_products ) > 0 ) {

                $output .= '<div class="grid no-border" ><ul>';     
                foreach ( $latest_products as $latest_product ) {

                    //print_r($latest_product);
                    $i++;
                    if ( !($i%3)) $class = 'last'; else $class = '';
                    $output .= '<li class="item '.$class.' ">';
                    // Thumbnails, if required
                    if ($image) {                   
                        $output .= '<a class="product-image" href="' . wpsc_product_url( $latest_product->ID, null ) . '">';
                        $attached_images = (array)get_posts( array(
                            'post_type'   => 'attachment',
                            'numberposts' => 1,
                            'post_status' => null,
                            'post_parent' => $latest_product->ID,
                            'orderby'     => 'menu_order',
                            'order'       => 'ASC'
                        ) );
                        $attached_image = $attached_images[0]; 
                        if ( $attached_image->ID > 0 )
                                $output .= '<img class="product_image" src="' . wpsc_product_image( $attached_image->ID, $width, $height ) . '" title="' . $latest_product->post_title . '" alt="' . $latest_product->post_title . '" />';
                        else
                            $output .='<img class="no-image product_image" id="product_image_'.wpsc_the_product_id().'" alt="No Image" title="'.wpsc_the_product_title().'" src="'.WPSC_URL.'/wpsc-theme/images/noimage.png" width="' . $width . '" height="' . $height . '" />';

                        $output .= '</a>';

                    }
                    // Link
                    $output .= '<h3 class="product-name"><a href="' . wpsc_product_url( $latest_product->ID, null ) . '" class="wpsc-product-title">'.stripslashes( $latest_product->post_title ).'</a></h3>';

                    $output .= '<p class="product-desc">'. $latest_product->post_content.'</p>';
                    $output .=  '<div class="action">';

                    $output .= '<div class="price-box left">';
                    //$output .= $latest_product->ID;
                    //$output .= wpsc_calculate_price( wpsc_the_product_id(),null,false );
                    $output .= wpsc_currency_display(get_post_meta( $latest_product->ID, '_wpsc_price', true ));
                    $output.= '</div>';

                    $output .= '<a class="button right" href="' . wpsc_product_url( $latest_product->ID, null ) . '"><span>'.__( 'Details', 'wpsc' ).'</span></a>';

                    $output .= '<div class="clear"></div></div>';

                    $output .= '</li>';
                }
                $output .= "</ul></div><div class=\"clear\"></div>";
            }
            echo $output;
        } 
```

更新：修复了这个问题。由于错误的类名作为参数，它没有保存。

```
 $widget_ops = array( 'classname' => 'widget_mz_wpsc_latest_products','description' => __( 'Phomedia Latest Products Widget', 'wpsc' ) );
                $this->WP_Widget( 'wpsc_latest_products', __( 'Phomedia Latest Products', 'wpsc' ), $widget_ops ); 
```

# css-selectors - selenium web 驱动程序 - 用于表听者的 css 选择器/定位器

> ID：10607708
> 
> 赞同：1
> 
> 时间：2012-05-15T19:43:20.370
> 
> 标签：css-selectors, selenium-webdriver

```
<table id="state_table" class="table" width="100%">
<thead>
<tr>
<th class="column_checkbox disabled">
<th class="sortable desc" data-type="stateid">ID</th>
<th class="sortable" data-type="name">Name</th> 
```

按列标题对表格进行排序的 webdriver 代码是

```
driver.findElement(By.cssSelector("th.sortable")).click(); 
```

这将按 ID 列对表进行排序。如何使用“名称”而不是数据类型 =“名称”按名称列对表进行排序

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T11:53:30.443

为什么要打扰css？使用 XPath，应该类似于

```
driver.findElement(By.xpath("//th[text()='Name']")).click(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-07T12:22:03.757

我们可以在这里使用 CSS

driver.findElement(By.cssSelector(".sortable[data-type='name']")) -- 数据类型（名称） driver.findElement(By.cssSelector(".sortable[data-type='stateid'] ")) -- 数据类型（州 ID）

请让我知道上面的 CSS 选择器是否正常工作。

# wordpress - wordpress：通过 meta_value 复选框过滤 customposttype

> ID：10607714
> 
> 赞同：0
> 
> 时间：2012-05-15T19:43:40.813
> 
> 标签：wordpress, checkbox, filter

我创建了一个自定义帖子类型，其中一个 meta_value 是这个自定义帖子类型的一个选择框，在后端有 3 个不同的可能性可供选择。在前端应该有一个列表显示所有这些 posttypes，什么已经有效。但在列表上方，这 3 个不同的值显示为复选框，通过选中其中一个框，列表视图应刷新并仅显示存储此 meta_value 的 posttypes...

我有点迷茫，我怎么能意识到呢？

# shell - 如何使用 Hadoop FS shell 将 hadoop 中的两个文件连接成一个文件？

> ID：10607716
> 
> 赞同：7
> 
> 时间：2012-05-15T19:43:48.110
> 
> 标签：shell, hadoop, concatenation

我正在使用 Hadoop 0.20.2 并希望尽可能使用 -cat shell 命令将两个文件连接为一个（来源：[http](http://hadoop.apache.org/common/docs/r0.19.2/hdfs_shell.html) ://hadoop.apache.org/common/docs/r0.19.2/hdfs_shell.html ）

这是我提交的命令（名称已更改）：

```
**/path/path/path/hadoop-0.20.2> bin/hadoop fs -cat /user/username/folder/csv1.csv /user/username/folder/csv2.csv > /user/username/folder/outputdirectory/** 
```

它返回 bash: /user/username/folder/outputdirectory/: No such file or directory

我还尝试创建该目录，然后再次运行它——我仍然收到“没有这样的文件或目录”错误。

我还尝试使用 -cp 命令将两者复制到一个新文件夹中，并使用 -getmerge 将它们组合起来，但 getmerge 也没有运气。

在 hadoop 中这样做的原因是文件很大，并且需要很长时间才能在 hadoop 之外下载、合并和重新上传。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T21:06:42.603

该错误与您尝试将命令的标准输出重定向回 HDFS 有关。有一些方法可以做到这一点，使用`hadoop fs -put`源参数为连字符的命令：

```
bin/hadoop fs -cat /user/username/folder/csv1.csv /user/username/folder/csv2.csv | hadoop fs -put - /user/username/folder/output.csv 
```

`-getmerge`也输出到本地文件系统，而不是 HDFS

Unforntunatley 没有将多个文件合并为一个的有效方法（除非您想查看 Hadoop 的“附加”，但在您的 hadoop 版本中，默认情况下禁用并且可能存在错误），而无需将文件复制到一台机器然后回到 HDFS，不管你是在

*   一个自定义 map reduce 作业，带有一个 reducer 和一个保留文件顺序的自定义 mapper reducer值将是线本身）
*   通过 FsShell 命令，具体取决于您的网络拓扑 - 即您的客户端控制台与数据节点的连接速度是否良好？这当然是您最省力的工作，并且可能比 MR 工作更快地完成相同的工作（因为无论如何都必须转到一台机器上，所以为什么不使用本地控制台呢？）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-11-03T19:17:14.477

要将文件夹中的所有文件连接到输出文件：

```
hadoop fs -cat myfolder/* | hadoop fs -put - myfolder/output.txt 
```

如果您在 hdfs 上有多个文件夹，并且想要连接每个文件夹中的文件，则可以使用 shell 脚本来执行此操作。（注意：这不是很有效，可能会很慢）

**句法 ：**

```
for i in `hadoop fs -ls <folder>| cut -d' ' -f19` ;do `hadoop fs -cat $i/* | suy hadoop fs -put - $i/<outputfilename>`; done 
```

**例如：**

```
for i in `hadoop fs -ls my-job-folder | cut -d' ' -f19` ;do `hadoop fs -cat $i/* |hadoop fs -put - $i/output.csv`; done 
```

**说明：** 所以你基本上遍历所有文件并将每个文件夹内容分类到 hdfs 上的输出文件中。

# grails - 如何在 Grails 中指定默认事务隔离级别

> ID：10607717
> 
> 赞同：6
> 
> 时间：2012-05-15T19:43:49.987
> 
> 标签：grails, transactions, isolation-level

我无法弄清楚如何在 Grails 应用程序中指定默认事务隔离级别。请帮助并指出我的错误在哪里。以下是详细信息。

圣杯：1.3.7

数据库：SQL Server 2008。

数据源.groovy：

```
dataSource {
  ...
  driverClassName = "net.sourceforge.jtds.jdbc.Driver"
  dialect = org.hibernate.dialect.SQLServerDialect
  defaultTransactionIsolation = java.sql.Connection.TRANSACTION_READ_UNCOMMITTED
}

hibernate {
  ...
  connection.isolation = java.sql.Connection.TRANSACTION_READ_UNCOMMITTED
} 
```

然后我正在浏览应用程序并同时执行以下查询：

```
SELECT session_id, host_name, program_name, login_name, status, transaction_isolation_level
FROM sys.dm_exec_sessions
WHERE host_name IS NOT NULL AND login_name = 'cm'
ORDER BY host_name, program_name 
```

返回：

```
session_id  host_name   program_name    login_name  status  transaction_isolation_level
61          ANDREYK-WS  jTDS            cm          running 2 
```

2 表示 READ_COMMITTED。我希望看到 1，即 READ_UNCOMMITTED。

如果我明确指定：@Transactional(isolation=Isolation.READ_UNCOMMITTED)

上面的查询按预期返回 1。但是，我不想将应用程序中的所有服务都归于属性。我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T20:17:05.903

这需要在[数据源配置](http://grails.org/doc/latest/guide/conf.html#dataSource)的属性属性下设置，即

```
dataSource {
  ...
  driverClassName = "net.sourceforge.jtds.jdbc.Driver".
  dialect = org.hibernate.dialect.SQLServerDialect
  properties {
    defaultTransactionIsolation = java.sql.Connection.TRANSACTION_READ_UNCOMMITTED.
  }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T23:57:45.010

我有一些变化，因为我有多个 DS

在数据源的顶部定义属性的共享映射（根据您的环境进行调整）：

```
def defaultConnectionProperties =  [
    maxActive: 50,
    maxIdle: 25,
    minIdle: 5,
    initialSize: 5,
    minEvictableIdleTimeMillis: 60000,
    timeBetweenEvictionRunsMillis: 60000,
    maxWait: 10000,
    defaultTransactionIsolation: java.sql.Connection.TRANSACTION_READ_UNCOMMITTED
] 
```

然后每个 DS 类似于：

```
dataSource {
    pooled = true
    driverClassName = "net.sourceforge.jtds.jdbc.Driver"
//    driverClassName = "com.p6spy.engine.spy.P6SpyDriver" // use this driver to enable p6spy logging
    //readOnly = "true"
    properties = defaultConnectionProperties
} 
```

重新启动您的 Grails 应用程序。

奇怪的是我看到了最初的 transaction_isolation_level = 2，但是当我真正点击 DB 时，似乎设置了连接属性并且它闪烁到 1。

您还可以检查：grailsApplication.config 并查找数据源并确认那里的设置

# unit-testing - Visual Studio 2010 单元测试总是给出 NullReferenceException 错误

> ID：10607725
> 
> 赞同：0
> 
> 时间：2012-05-15T19:44:18.717
> 
> 标签：unit-testing, c#-2.0

我正在尝试使用单元测试向导进行单元测试，但我总是得到：

> 测试方法 TestProject9.Log_InsertMasterTest 抛出异常：
> System.NullReferenceException：对象引用未设置为对象的实例。

我的test.cs：

```
 [TestMethod()]
    [DeploymentItem("Engine.dll")]
    public void Log_InsertMasterTest()
    {
        SkinnedRepairSearch_Accessor target = new SkinnedRepairSearch_Accessor(); // TODO: Initialize to an appropriate value
        int RepairMasterID = 0; // TODO: Initialize to an appropriate value
        int RepairMasterIDOld = 0; // TODO: Initialize to an appropriate value
        int id = 0; // TODO: Initialize to an appropriate value
        string Text = string.Empty; // TODO: Initialize to an appropriate value
        target.Log_InsertMaster(RepairMasterID, RepairMasterIDOld, id, Text);
        Assert.Inconclusive("A method that does not return a value cannot be verified.");
    } 
```

Log_InsertMaster 方法：

```
protected void Log_InsertMaster(int RepairMasterID, int RepairMasterIDOld, int id, string Text)
{
    SqlConnection myConnection = new SqlConnection(Globals.DatabaseConnectionString);

    SqlCommand myCommand = new SqlCommand("dbo.Repair_LogInsertMaster", myConnection);
    myCommand.CommandType = CommandType.StoredProcedure;

    myCommand.Parameters.Add("@RepairMasterID", SqlDbType.Int).Value = RepairMasterID;
    myCommand.Parameters.Add("@RepairMasterIDold", SqlDbType.Int).Value = RepairMasterIDOld;
    myCommand.Parameters.Add("@DateTime", SqlDbType.DateTime).Value = System.DateTime.Now;
    myCommand.Parameters.Add("@RepairID", SqlDbType.Int).Value = id;
    myCommand.Parameters.Add("@UserSignature", SqlDbType.NVarChar, 200).Value = AdminUser.Signature;
    myCommand.Parameters.Add("@Text", SqlDbType.NVarChar, 200).Value = Text;

    myConnection.Open();
    myCommand.ExecuteNonQuery();
    myConnection.Close();
} 
```

如何不出现此错误？以及如何使用 Unint 测试向导？

异常行：

```
SkinnedRepairSearch_Accessor target = new SkinnedRepairSearch_Accessor(); // TODO: Initialize to an appropriate value 
```

我尝试了其他公共方法：

```
[TestMethod()]
public void EmptyTextBoxesTest()
{
    SkinnedRepair target = new SkinnedRepair(); // TODO: Initialize to an appropriate value
    Control parent = null; // TODO: Initialize to an appropriate value
    target.EmptyTextBoxes(parent);
    Assert.Inconclusive("A method that does not return a value cannot be verified.");
} 
```

同样的错误

# caching - 将标头添加到 Spring 控制器

> ID：10607729
> 
> 赞同：6
> 
> 时间：2012-05-15T19:44:31.677
> 
> 标签：caching, spring-mvc, http-headers

[我知道这个问题与这个](https://stackoverflow.com/questions/1362930/how-do-you-set-cache-headers-in-spring-mvc)问题非常相似，但我觉得它的不同和具体足以保证在这里提出自己的问题。

我刚刚从一个没有留下任何文档的唯一开发人员那里继承了一个 Java Web 应用程序项目。它是一个 Spring MVC 应用程序，其基本包结构如下：

```
com.ourOrg.app.controllers
    ImageController
    ProgramController
    UserController
com.ourOrg.app.otherPackages 
```

每个`Controller`类都只是一个用`@Controller`and注释的 POJO `@RequestMapping("/blah")`。例如：

```
@Controller
@RequestMapping("/images")
public class ImageController() {
    @RequestMapping(value="/saveImage", method = RequestMethod.POST)
    @ResponseBody
    public ResponseEntity<String> saveImage(@RequestParam(value="imageData", required=true) String imageXML, HttpServletRequest request){
        // This method gets executed whenever the:
        // http://ourSite.com/images/saveImage
        // URL is hit
    }
} 
```

我被要求将以下 HTTP 标头添加到 Spring 配置中，以便我们禁用浏览器缓存：

> Pragma：无缓存
> 
> 缓存控制：无缓存
> 
> 过期：-1

我上面链接的文章听起来我们的控制器应该扩展这个`WebContentGenerator`类。不幸的是，有几十个控制器具有大量的方法，因此重构每个控制器以扩展或继承某些基本类型并不是一个真正可行的选择（除非它是**唯一**的选择！）。

我还看过一些文章，听起来您必须配置 Spring 以使用修改响应标头的 AOP 拦截器，但现在我真的进入了不熟悉的领域。

鉴于我们对 Spring MVC 的设置和实现，我将这三个简单的标头添加到服务器发回的每个响应中的最简单方法是什么（无论执行哪个控制器或方法）？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:53:41.230

希望您使用的是 Spring 3，您可以查看一个拦截器，然后您不必修改所有控制器（因为您说您有很多）。看起来他们可能已经实现了一个你可以使用的。查看 Bozho 对此问题的回答[如何通过注释在 spring mvc 3 中设置标头无缓存](https://stackoverflow.com/questions/4364622/how-to-set-header-no-cache-in-spring-mvc-3-by-annotation)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-03-02T02:07:30.963

我意识到这是一个旧帖子，但也许这会对某人有所帮助。我在这个例子中使用了 Spring。

主要是对参数使用注释：

```
@Controller
public class HelloController {

    @RequestMapping(value = "/hello.htm")
    public String hello(@RequestHeader(value="User-Agent") String userAgent)

        //..
    }
} 
```

# mysql - 如何以编程方式从表中获取种子字段名？

> ID：10607731
> 
> 赞同：2
> 
> 时间：2012-05-15T19:44:36.720
> 
> 标签：mysql, count, seed

反正有没有得到种子字段名？我所说的种子是指用这样的东西创造的领域；INT NOT NULL AUTO_INCREMENT 主键

我计划使用它（以编程方式获取种子字段名称）提出最快的 SQL 查询来获取表中的记录数。

我打算写的函数是这样的。请填空并提供 getSeed 函数内部机制。

```
function get_record_count ($dbh,$table,$where){

//get the seedfield name in the {table} programmatically

$seed = getSeed($dbh,$table);
$sql = "select count({$seed}) as `count` from {$table} " . $where; 

//do the mysql query & get num rows to return it... 

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T20:03:38.107

如果您不尝试计算列中非 NULL 值的数量（`COUNT(expr)`不计算 NULL），那么只需使用`SELECT COUNT(*)`并让 MySQL 使用 WHERE 子句中使用的相同索引来回答`COUNT(*)`。

```
$sql = "SELECT COUNT(*) AS `count` FROM {$table} " . $where; 
```

# javascript - 如何访问选择的 parentNode 以引发元素？

> ID：10607732
> 
> 赞同：39
> 
> 时间：2012-05-15T19:44:40.300
> 
> 标签：javascript, d3.js

我创建了以下文档：

```
<g>
    <path class=​&quot;line" name=​&quot;gene_1" stroke=​&quot;#aec7e8" d=​&quot;M10.47...">​&lt;/path>​
    <path class=​&quot;line" name=​&quot;gene_2" stroke=​&quot;#aec7e8" d=​&quot;M10.47...">​&lt;/path>​
    <path class=​&quot;line" name=​&quot;gene_3" stroke=​&quot;#aec7e8" d=​&quot;M10.47...">​&lt;/path>​
    ...
</g> 
```

当我将鼠标悬停在每条路径上时，我想将其最后附加到内部，`svg:g`因此它出现在其他行的顶部，但我不知道如何正确选择`parentNode`：

```
function onmouseover(d, i){
  var current_gene_name = d3.select(this).attr("name"),
      current_gene_pcp = d3.select(".line[name=" + current_gene_name + "]");

  p1 = this.parentNode 

  p2 = current_gene_pcp[0].parentNode

  p3 = current_gene_pcp[0][0].parentNode

  //p.appendChild(this);
} 
```

`p1`有效，但我想确保它`this`是 a `.line`，所以我更喜欢使用`current_gene_pcp`，但作为父级`p2`返回`<html></html>`，即使`p3`返回正确的`<g></g>`. 最后一个版本似乎是一个等待发生的错误。有没有更好的办法？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-05-15T19:55:15.943

D3 选择只是一个包裹在所选元素周围的双数组。正如您在 中找到的那样`p3`，您可以根据需要取消引用数组以找到您的第一个节点。但是，确实存在更好的方法：

从文档中[`selection.node()`](https://github.com/mbostock/d3/wiki/Selections#wiki-node)：

> *返回当前选择中的第一个非`null`元素。如果选择为空，则返回`null`。*

在你的情况下：

```
var dad = current_gene_pcp.node().parentNode; 
```

但是，如果您不需要 DOM 句柄以外的行，您不妨直接获取它：

```
// Search document-wide...
var dad = document.querySelector(".line[name=" + current_gene_name + "]");

// ...or only as a child of the current DOM element
var dad = this.querySelector(".line[name=" + current_gene_name + "]"); 
```

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-05-15T21:08:30.410

这是将鼠标悬停元素移到前面的快速方法：

```
selection.on("mouseover", function() { this.parentNode.appendChild(this); }); 
```

另请参阅 d3-js 组中的[相关线程](https://groups.google.com/d/msg/d3-js/eUEJWSSWDRY/EMmufH2KP8MJ)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-11-26T11:10:02.850

有两种方法可以访问它。
要么像这样使用[第三个变量](https://stackoverflow.com/questions/20437116/third-variable-in-d3-anonymous-function)：`someNode.attr("someAttrib", function(d, i, j) { console.log(d, i, j); });`. `j`包含您提供给父​​节点的数据。
或使用`d3.select(this.parentNode).data()[0].id;`.

一个例子：

```
<!DOCTYPE html>
<meta charset="utf-8">
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<div id="area", width="1000px" height="1000px"></div>
<script>
var GAP = 10, NODE_RADIUS = 14;

  var nodes = [
    {id: 1, prop: [{id: 1, something: 1}], abc: 1},
    {id: 2, prop: [{id: 1, something: 1}, {id: 2, something: 1}, {id: 3, something: 1}], abc: 2},
    {id: 3, prop: [{id: 1, something: 1}, {id: 2, something: 1}], abc: 3},
    {id: 4, prop: [{id: 1, something: 1}], abc: 4},
    {id: 5, prop: [{id: 1, something: 1}], abc: 5},
    {id: 6, prop: [], abc: 6}
  ];

var nodeLayer = d3.select("#area").selectAll(".node").data(nodes, function(d) {return d.id; });
var iNodes = nodeLayer.enter().append("svg").attr("class", "node");
    //append the black circle
    iNodes.append("circle")
                .style("fill", "black")
                .attr("r", NODE_RADIUS)
                .attr("cx", function(d) {return 10 + d.id * 10;})
                .attr("cy", 100);

    iNodes.append("g").selectAll(".prop").data(function(d) {return d.prop;}).enter()
            .append("text")
                .text(function(d,i,j){console.log("parent id="+j); return d3.select(this.parentNode).data()[0].id;})
                .attr("dx", 50)
                .attr("dy", 50)
                .style("font-size", "8px")
                .style("fill", d3.rgb(180,0,0))
                .style("text-anchor", "middle");

</script>
</body> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-07T16:05:55.240

出于某种原因，我不得不提高 2 倍水平：`console.log(">>"+my_chart.node().parentNode.parentNode.id+"<<")`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-05T14:31:57.910

随着 D3 [v4](https://github.com/d3/d3/blob/master/CHANGES.md#changes-in-d3-40)的发布，这已成为某种[XY 问题](https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem)。不再需要`parentNode`重新插入元素作为其父元素的最后一个子元素。因为从 D3 上的那个版本开始提供[`selection.raise()`](https://github.com/d3/d3-selection/blob/master/README.md#selection_raise)方法：

> *选择*。**提高**()
> 
> 按顺序重新插入每个选定元素，作为其父元素的最后一个子元素。相当于：
> 
> ```
> selection.each(function() {
>   this.parentNode.appendChild(this);
> }); 
> ```

使用 D3 **v6**将事件作为第一个参数传递给事件侦听器（请参阅[更改日志](https://github.com/d3/d3/blob/master/CHANGES.md#d3-selection)），您的代码可以像这样简单：

```
function onmouseover(event) {
  d3.select(event.target).raise();
} 
```

看看下面的演示：

```
d3.select("g")
  .on("mouseover", event => d3.select(event.target).raise())
```

```
<script src="https://d3js.org/d3.v6.js"></script>

<svg width="400" height="400">
  <g>
    <rect x="100" y="50" width="100" height="100" fill="red"></rect>
    <rect x="150" y="50" width="100" height="100" fill="blue"></rect>
  </g>
</svg>
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-05T04:58:48.423

我做过的一种方法是：

```
bars.on('mouseover', d => {
let parentNode = d3.select(this.parentNode);
let tooltip = parentNode.append('rect) 
```

从`this`关键字，你可以访问当前节点，然后触摸它的父节点。

# android - 如何使用和激活phonegap的蓝牙？

> ID：10607734
> 
> 赞同：3
> 
> 时间：2012-05-15T19:44:42.220
> 
> 标签：android, plugins, cordova, bluetooth

我已经完成了国际象棋游戏的源代码。现在是 1 人对 1 人通过蓝牙的部分。如何通过蓝牙使用、激活和操作动作？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T23:19:40.123

蓝牙插件：

[https://github.com/phonegap/phonegap-plugins/tree/master/Android/Bluetooth](https://github.com/phonegap/phonegap-plugins/tree/master/Android/Bluetooth) https://github.com/phonegap/phonegap-plugins/tree/master/Android/BluetoothPlugin

# jquery - 当我将位置从第一个更改为最后一个时，添加新行不起作用

> ID：10607735
> 
> 赞同：2
> 
> 时间：2012-05-15T19:44:44.863
> 
> 标签：jquery, jqgrid

我正在尝试将内联编辑与 jqgrid 一起使用，并且在我设置 position = last 时遇到了添加新行的问题。我的网格最初没有记录。我第一次单击“新行”时，它可以工作。我单击保存并将数据发布到 Web 服务。但是，当我再次单击“新行”时，它会将我之前添加的行置于编辑模式，因此我无法添加多行。我的代码如下。任何帮助将不胜感激:)

再看一遍之后，新行在保存后似乎没有被提交/接受到网格。如果我刷新网格然后添加一个新行，它会按预期工作。在我的保存网络服务被调用后，我似乎需要做一些事情......

```
var airGrid = $("#tblAir");
airGrid.jqGrid({
    datatype: function () {
        $.ajax({
            url: "MyTravelSrv.asmx/GetPlanAirfare",
            data: JSON.stringify({ TravReqstId: 1234 }),
            datatype: "json",
            type: "POST",
            contentType: "application/json; charset=utf-8",
            beforeSend: function () {
            },
            complete: function (jsondata, stat) {
                if (stat == "success") {
                    airGrid[0].addJSONData(JSON.parse(jsondata.responseText).d);
                }
            },
            error: function (e) {
                var msg = JSON.parse(e.responseText);
                alert(msg.Message);
            }
        });
    },
    colNames: ['ID', 'Date', 'Time', 'Preferred Airline', 'From', 'To'],
    colModel: [{ name: 'id', index: 'id', hidden: true },
               { name: 'departDate', index: 'departDate', editable: true },
               { name: 'departTime', index: 'departTime', editable: true },
               { name: 'prefAirline', index: 'prefAirline', editable: true },
               { name: 'from', index: 'from', editable: true },
               { name: 'to', index: 'to', editable: true}],
    pager: '#pager',
    height: 60,
    viewrecords: true,
    editurl: 'MyTravelSrv.asmx/UpdatePlanAirfare'
});

airGrid.jqGrid('navGrid', "#pager", { search: false, edit: false, add: false, del: false });
airGrid.jqGrid('inlineNav', '#pager', {
    addParams: { position: "last",
        addRowParams: {
            keys: true,
            oneditfunc: function (rowid) {
                //alert(rowid);
            }
        }
    }
}); 
```

# c# - 将 Facebook API 中的字符串放入列表框

> ID：10607738
> 
> 赞同：2
> 
> 时间：2012-05-15T19:45:04.820
> 
> 标签：c#, silverlight, windows-phone-7

在我正在使用的当前客户端（而不是控制）中，接收/解析请求的方式是：

```
 var result = (IDictionary<string, object>)e.GetResultData();
        string id = result["id"].ToString();
        string name = result["name"].ToString();

        Dispatcher.BeginInvoke(() =>
        {

            id.ItemsSource = new List<String> { 
                id, 
                name};
        } 
```

XAML 看起来像：

```
<ListBox Height="168" HorizontalAlignment="Left" Margin="204,21,0,0" Name="id" VerticalAlignment="Top" Width="239" >
   <ListBox.ItemTemplate>
     <DataTemplate>
       <StackPanel Orientation="Vertical" Margin="2">
          <TextBlock Text="{Binding}" />
       </StackPanel>
      </DataTemplate>
    </ListBox.ItemTemplate>
 </ListBox> 
```

**新更新 - 寻求帮助（未解决）：** 我正在尝试使用这些字符串，以便我可以将每个项目放入 ListBox（如果存在更多），而不是仅抓取 1 个项目集（例如 id、名称、链接）。

```
 public class Datum
    {
        public string id { get; set; }
        public string name { get; set; }
        public string link { get; set; }
    } 
```

任何帮助都将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:48:06.097

您需要将 设置`ItemsSource`为实现的东西`IEnumerable`。

```
id.ItemsSource = new List<String> { id }; 
```

您还需要调整绑定以接受，`DataContext`因为您没有传入对象。

```
<TextBlock Text="{Binding}" /> 
```

如果你想在一个简单的字符串之外扩展，创建一个类来包装你的内容，然后绑定到给定的属性。

```
class Person
{
     String id {get; set;}
     String name {get; set;}
}

 <ListBox Height="168" HorizontalAlignment="Left" Margin="204,21,0,0" Name="id" VerticalAlignment="Top" Width="239" >
   <ListBox.ItemTemplate>
     <DataTemplate>
       <StackPanel Orientation="Horizontal" Margin="2">
          <TextBlock Text="{Binding id}" />
          <TextBlock Text="{Binding name}" />
       </StackPanel>
      </DataTemplate>
    </ListBox.ItemTemplate>
 </ListBox> 
```

然后在您后面的代码中，您可以创建一个实例并像以前一样分配。

```
Person p = new Person();
p.id = "id";
p.name = "name";

List<Person> people = new List<Person>();
people.Add(p);

id.ItemsSource = people; 
```

这是一个简单的示例，但应该为您提供所需的内容。

# batch-file - 多行文本文件，如何放入环境变量

> ID：10607739
> 
> 赞同：8
> 
> 时间：2012-05-15T19:45:12.437
> 
> 标签：batch-file, multiline

我有一个名为 file.txt 的文件，其中包含：

```
 this is line one ^
     this is line two ^
     this is the last line 
```

我怎样才能把它放到一个环境变量中？

我可以从批处理文件中做到这一点：test.bat

```
 set LF=^
    [blank line]
    [blank line]
    rem two blank lines needed above
    set multi=Line 1!LF!Line 2!LF!Last line
    echo !multi! 
```

这输出三行：

```
 Line 1
      Line 2
      Last line 
```

那么如何将 file.txt 放入批处理文件中的 envvar 中呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-16T18:10:59.427

正如 dbenham 所说，它也可以用 for/f 完成，但它有点复杂。

简单的 80% 解决方案是

```
setlocal EnableDelayedExpansion

set "var="
set LF=^

rem *** Two empty lines are required for the linefeed
FOR /F "delims=" %%a in (myFile.txt) do (
  set "var=!var!!LF!%%a"
)
echo !var! 
```

但它失败了：
- 如果一行是空白的，它将被跳过
- 如果一行以`;`EOL 字符开头
- 如果一行包含`!`（和插入符号）

但是你可以使用更复杂的解决方案

```
@echo off
SETLOCAL DisableDelayedExpansion
set "all="
FOR /F "usebackq delims=" %%a in (`"findstr /n ^^ aux1.txt"`) do (
    set "line=%%a"
    SETLOCAL EnableDelayedExpansion
    set "line=!line:#=#S!"
    set "line=!line:*:=!"
    for /F "delims=" %%p in ("!all!#L!line!") do (
        ENDLOCAL
        set "all=%%p"
    )
)
SETLOCAL EnableDelayedExpansion
if defined all (
set "all=!all:~2!"
set ^"all=!all:#L=^

!"
set "all=!all:#S=#!"
)
echo !all! 
```

代码做什么？
首先，`findstr /n ^^`将在每一行前面加上一个行号和一个冒号，比如

```
1:My first Line
2:; beginning with a semicolon
3:
4:there was an empty line 
```

这解决了空行的问题，并且标准的 EOL 字符`;`可以被忽略。
要获取该行的内容，将值设置为一个变量，同时禁用延迟扩展，这解决了`!`和`^`字符的问题。

去掉行号和冒号，会启用延迟扩展（不，delim`:`解决不了）。

然后全部`#`替换为`#S`，这将首先完成，因为删除该行的前缀可能为空并且替换将失败。
但是我为什么要换？
那是因为我不能在这里插入换行符，因为下面的 FOR/F 会因嵌入换行符而失败，
所以我只添加*换行符标记*（在这种情况下我使用`#L`），但文件的内容也可以包含 a `#L`，但是通过`#`用`#S`所有标记 替换所有是唯一的。

在标记之后，使用 关闭/禁用延迟扩展存在问题`endlocal`，但保留修改后的`all`和`line`变量的内容。
这是通过`FOR/F-endlocal`技巧完成的，因为可以在屏障 `%%p`后面传输内容。`endlocal`

然后在阅读完整文件后，我检查是否`all`已定义，因为对于空文件，它将为空。
然后第一个*换行标记* `#L`将被删除，所有其他标记都将替换为真正的换行字符。
然后将锐利的安全`#S`器恢复为`#`.

就是这样，所以即使这个解决方案显然......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T20:46:39.233

你快到了。您需要阅读每一行文本，然后将该行加上换行符附加到变量中。

可以使用 FOR /F，但如果内容包含`!`字符，则延迟扩展效果不佳。保留空白行和禁用 EOL 选项也很尴尬。

一个更简单的解决方案是使用 SET /P 来读取行。这种技术的局限性是：

1）它修剪每行的尾随控制字符

2) 文件必须使用 Windows 标准的回车、换行符。它不适用于 Unix 样式的换行符。

3）每行限制读取1023字节（不包括行终止符）

请记住，环境变量只能容纳不到 8 KB 的数据。因此，您只能使用这种技术将非常小的文件加载到变量中。

```
@echo off
setlocal enableDelayedExpansion
set LF=^

:: Two blank lines above needed for definition of LF - do not remove
set file="test.txt"
set "var="
for /f %%N in ('find /c /v "" ^<%file%') do set lineCnt=%%N
<%file% (
  for /l %%N in (1 1 %lineCnt%) do (
    set "ln="
    set /p "ln="
    set "var=!var!!ln!!lf!"
  )
)
set var 
```

# c++ - 如何通过strtok忽略一个字符？

> ID：10607743
> 
> 赞同：2
> 
> 时间：2012-05-15T19:45:42.147
> 
> 标签：c++, strtok

在下面的代码中，我也想忽略字符“。但是在添加之后，我仍然得到“Mr_Bishop”作为我的输出。

我有以下代码：

```
 ifstream getfile;
    getfile.open(file,ios::in);
        char data[256];
    char *line;
    //loop till end of file                   
    while(!getfile.eof())
    {
            //get data and store to variable data
            getfile.getline(data,256,'\n');

        line = strtok(data," ”");
        while(line != NULL)
        {
            cout << line << endl;
            line = strtok(NULL," ");
        }
    }//end of while loop 
```

我的文件内容：

```
hello 7 “Mr_Bishop”
hello 10 “0913823” 
```

基本上我希望我的输出是：

```
hello
7
Mr_Bishop
hello
10
0913823 
```

使用此代码，我只能得到：

```
hello
7
"Mr_Bishop"
hello
10
"0913823" 
```

提前致谢！:)

我意识到我在内部循环中犯了一个错误，错过了报价。但现在我收到以下输出：

```
hello
7
Mr_Bishop
�
hello
10
0913823
� 
```

有什么帮助吗？谢谢！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T20:08:21.843

看起来您使用写字板或其他东西来生成文件。您应该在 Windows 上使用 Notepad 或 Notepad++ 或在 Linux 上创建 ASCII 编码的类似工具。现在你正在使用看起来像 UTF-8 的编码。

此外，“正确的转义序列是 \”。例如

```
line = strtok(data," \""); 
```

将文件修复为 ASCII 编码后，您会发现循环中遗漏了一些内容。

```
while(!getfile.eof())
{
        //get data and store to variable data
        getfile.getline(data,256,'\n');

    line = strtok(data," \"");
    while(line != NULL)
    {
        std::cout << line << std::endl;
        line = strtok(NULL," \""); // THIS used to be strtok(NULL," ");
    }
}//end of while loop 
```

你在那里错过了一组报价。更正文件，这个错误会产生正确的输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:49:29.533

*仔细*查看您的代码：

```
 line = strtok(data," ”"); 
```

注意引号如何以不同的角度倾斜（我的也是这样，我想希望你的字体显示相同的东西）。您在`strtok()`通话中只包含了结束双引号。但是，您的数据文件具有：

```
hello 7 “Mr_Bishop” 
```

它有*两种*不同的报价。确保您使用了所有正确的字符，无论您的数据是否“正确”。

**更新**：你的数据可能是 UTF-8 编码的（这就是你在那里得到那些倾斜的双引号的方式）并且你正在使用`strtok()`它完全不知道 UTF-8 编码。所以它可能做错了，拆分多字节 UTF-8 字符，并在行尾留下垃圾。

# perl - Perl 子目录遍历

> ID：10607746
> 
> 赞同：1
> 
> 时间：2012-05-15T19:45:50.047
> 
> 标签：perl, directory, traversal

我正在编写一个脚本，它会遍历我们的 Perl 脚本大目录并检查某些内容。现在，它需要两种输入：主目录或单个文件。如果提供了单个文件，它将在该文件上运行 main 函数。如果提供了主目录，它将在该目录内的每个 .pm 和 .pl 上运行 main 函数（由于目录遍历的递归性质）。

我该如何编写它（或者什么包可能会有所帮助） - 这样我也可以输入七个子目录之一，它只会遍历那个子目录（而不是整个东西）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T08:34:19.893

我真的看不出两个目录参数之间的处理差异。当然，使用 File::Find 在这两种情况下都会做正确的事情。

像这样的东西...

```
#!/usr/bin/perl

use strict;
use warnings;

use File::Find;

my $input = shift;

if (-f $input) {
  # Handle a single file
  handle_a_file($input);
} else {
  # Handler a directory
  handle_a_directory($input);
}

sub handle_a_file {
  my $file = shift;

  # Do whatever you need to with a single file
}

sub handle_a_directory {
  my $dir = shift;

  find(\&do this, $dir);
}

sub do_this {
  return unless -f;
  return unless /\.p[ml]$/;

  handle_a_file($File::Find::name);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:49:57.593

如果您确切知道要查看的目录和子目录，则可以使用`glob("$dir/*/*/*.txt")`例如`.txt`在给定的第 3 级获取文件`$dir`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-16T08:47:51.707

一种方便的方法是使用优秀的[`Path::Class`模块](https://metacpan.org/module/Path%3a%3aClass)，更准确地说：`traverse()`方法[`Path::Class::Dir`](https://metacpan.org/module/Path%3a%3aClass%3a%3aDir)。您可以在作为第一个参数提供的回调函数中控制要处理的内容`traverse()`。手册页有示例片段。

当然，使用内置的 like`opendir`是非常好的。

不过，我刚刚转向`Path::Class`几乎在任何地方都使用它，因为它有很多不错的便捷方法，而且感觉很不错。请务必阅读[文档`Path::Class::File`](https://metacpan.org/module/Path%3a%3aClass%3a%3aFile)以了解可用的内容。真正做到了 99% 的时间。

# python - 在 Python 3 的多处理队列中避免竞争条件

> ID：10607747
> 
> 赞同：12
> 
> 时间：2012-05-15T19:46:02.150
> 
> 标签：python, python-3.x, parallel-processing, race-condition

我试图找到大约 61 亿个（自定义）项目的最大重量，我想通过并行处理来做到这一点。对于我的特定应用程序，有更好的算法不需要我迭代超过 61 亿个项目，但是解释它们的教科书让我头疼，我的老板希望在 4 天内完成。我想我有更好的机会使用我公司的高级服务器和并行处理。但是，我对并行处理的了解都来自阅读[Python](http://docs.python.org/py3k/library/multiprocessing.html) [文档](http://docs.python.org/py3k/library/concurrent.futures.html)。也就是说我很迷茫...

我目前的理论是设置一个馈线进程、一个输入队列、一大堆（比如 30 个）工作进程和一个输出队列（在输出队列中找到最大元素将是微不足道的）。我不明白的是馈线进程如何告诉工作进程何时停止等待项目通过输入队列。

我曾考虑过`multiprocessing.Pool.map_async`在可迭代的 6.1E9 项目上使用，但仅在不对它们做任何事情的情况下迭代这些项目就需要将近 10 分钟。**除非我误解了某些东西...**，`map_async`否则可以在流程开始工作时对它们进行迭代以将它们分配给流程。（`Pool`也提供了`imap`，但[文档](http://docs.python.org/py3k/library/multiprocessing.html)说它类似于`map`，它似乎不能异步工作。**我想要异步，对吧？**）

**相关问题**：我想用`concurrent.futures`代替`multiprocessing`吗？我不可能是第一个实现双队列系统的人（这正是美国每个熟食店的排队方式……）所以有没有更 Pythonic/内置的方法来做到这一点？

这是我正在尝试做的事情的骨架。**请参阅中间的注释块。**

```
import multiprocessing as mp
import queue

def faucet(items, bathtub):
    """Fill bathtub, a process-safe queue, with 6.1e9 items"""
    for item in items:
        bathtub.put(item)
    bathtub.close()

def drain_filter(bathtub, drain):
    """Put maximal item from bathtub into drain.
    Bathtub and drain are process-safe queues.
    """
    max_weight = 0
    max_item = None
    while True:
        try:
            current_item = bathtub.get()
        # The following line three lines are the ones that I can't
        # quite figure out how to trigger without a race condition.
        # What I would love is to trigger them AFTER faucet calls
        # bathtub.close and the bathtub queue is empty.
        except queue.Empty:
            drain.put((max_weight, max_item))
            return
        else:
            bathtub.task_done()
        if not item.is_relevant():
            continue
        current_weight = item.weight
        if current_weight > max_weight:
            max_weight = current_weight
            max_item = current_item

def parallel_max(items, nprocs=30):
    """The elements of items should have a method `is_relevant`
    and an attribute `weight`. `items` itself is an immutable
    iterator object.
    """
    bathtub_q = mp.JoinableQueue()
    drain_q = mp.Queue()

    faucet_proc = mp.Process(target=faucet, args=(items, bathtub_q))
    worker_procs = mp.Pool(processes=nprocs)

    faucet_proc.start()
    worker_procs.apply_async(drain_filter, bathtub_q, drain_q)

    finalists = []
    for i in range(nprocs):
        finalists.append(drain_q.get())

    return max(finalists) 
```

* * *

# 这是答案

**我从 Python 基金会通讯主管 Doug Hellman 那里找到了对我的问题的一个非常彻底的答案，以及对多任务处理的温和介绍。我想要的是“毒丸”模式。在这里查看：http: [//www.doughellmann.com/PyMOTW/multiprocessing/communication.html](http://www.doughellmann.com/PyMOTW/multiprocessing/communication.html)**

支持@MRAB 发布该概念的核心。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T19:59:27.610

您可以将一个特殊的终止项（例如 None）放入队列中。当一个工人看到它时，它可以把它放回去让其他工人看到，然后终止。或者，您可以将每个工作人员的一个特殊终止项放入队列中。

# performance - 衡量 MPI 通信成本的工具

> ID：10607750
> 
> 赞同：22
> 
> 时间：2012-05-15T19:46:15.560
> 
> 标签：performance, communication, mpi

我正在使用 MPI，我想测量通信成本，以便我可以将它们与“处理”成本进行比较，例如，我需要多少时间将列表分散到 n 个进程中，然后将其与多少时间进行比较是时候我需要对其进行排序了。

有谁知道任何衡量这种沟通成本的工具？（例如散点图）

是否有任何东西可以测量 MPI 通信成本，例如 PAPI 来分析代码性能？

提前致谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-05-15T20:20:19.433

是的，有很多这样的工具。MPI 定义了一个工具接口，允许其他库在您的 MPI 函数调用中插入自己，并执行计数、计时等。

一个非常小的 MPI 分析工具是[mpiP](http://mpip.sourceforge.net/) - 它提供了代码中 MPI 活动的非常简短的摘要。

[IPM](http://ipm-hpc.sourceforge.net/)库相当容易构建，并为您提供大量 MPI 计数和时间，并因此提供了一个不错的 HTML 文件。你提到了PAPI；如果可用，IPM 还将集成 PAPI 计数器。我们在我们的中心经常使用它，我认为这会做你喜欢的。如果您使用 MPI 的动态库构建程序，您甚至不需要重新编译即可使用它（mpiP 具有相同的属性）。

[Jumpshot](http://www.mcs.anl.gov/research/projects/perfvis/software/viewers/)是 MPICH2 附带的，但可以使用任何 MPI 构建，它实际上在时间线上显示了每个 MPI 操作花费了多长时间。

[OpenSpeedshop](http://www.openspeedshop.org/wp/)对您的代码进行了非常详细的性能测量，特别突出了“昂贵”的行；它还具有 MPI 跟踪模式，可通过代码行识别 MPI 时间。安装可能很棘手。

在频谱的商业部分，有来自德累斯顿工业大学的[Vampir和英特尔 Trace Analyzer and Collector (ITAC)。](http://www.vampir.eu/)Vampir 使用开源 VampirTrace 库收集源级、MPI 和 OpenMP 跟踪，该库还与 PAPI 集成以提供详细的事件和计数器跟踪。VampirTrace 的踪迹采用 Open Trace 格式，除了 Vampir 之外，其他各种工具都可以读取它。

ITAC 是[Intel Cluster Studio XE](http://software.intel.com/en-us/articles/intel-cluster-studio-xe/)的一部分。它主要设计用于与英特尔 MPI 一起使用，并与 Vampir 共享相同的祖先代码，提供或多或少相同的功能。它的一个不错的功能是包含的自动运行时 MPI 正确性检查器。

[Allinea MAP](http://www.allinea.com/products/map/)是来自 Allinea 的 MPI 分析器，它通过集成的源浏览器提供性能分析，该浏览器在源代码的各个行旁边显示通信/计算成本。它还显示了性能信息的高级图表，包括内存、CPU 指令和通信。

但是还有其他更高级别的工具，它们不仅提供报告，而且实际上提供建议。TACC 的 perfexpert 是一个基于命令行的工具，它进行大量测量并提供一些性能调整建议。[Jülich 的Scalasca](http://www.scalasca.org/)使用大量源代码级工具重新编译您的代码，并且可以指出负载不平衡，特别是昂贵的 MPI 集合等。它还可以与 Vampir 集成以进行详细的跟踪分析。

# .net - 防御性反多线程类实现

> ID：10607754
> 
> 赞同：3
> 
> 时间：2012-05-15T19:46:41.963
> 
> 标签：.net, multithreading, thread-safety, il, defensive-programming

我有一个[对多线程应用程序不安全](http://blogs.msdn.com/b/ericlippert/archive/2009/10/19/what-is-this-thing-you-call-thread-safe.aspx)的对象（以多种方式），我想提供内部检查以确保不会同时访问关键方法。

**问题**

我应该采用什么技术来检测和防止多个线程访问我的类？

跟踪消费者可能使用的所有方法、属性等的 Thread.ID 是否足够？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-05-15T19:50:07.727

只需记录它不是线程安全的。这是 .NET 中的类使用的约定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T19:49:46.247

会有帮助吗？

```
lock(_padLock)
{
   ....
} 
```

或者，如果您从外部访问对象，则可以使用 Mutex 对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-22T18:27:13.163

您可以使用的最佳内部检查是`lock`其他人建议的设置。但是这里有一些值得研究的创造性方法，看看它们是否能解决您的特定问题。我遇到的问题是，我不知道是否只有类的一部分是不安全的，是否让不同的线程使用类的不同实例是否是线程安全的。所以这里有一些`lock`可以缓解某些情况的组合

场景 1：静态类/方法 - 这将确保无论谁访问静态类/成员，如果另一个线程已经这样做，他们将被阻止。

```
public static class UnsafeStaticClass
{
    private static object _padLock = new object();

    public static void UnsafeStaticMethod()
    {
        lock(_padLock)
        {
            // Do Work
        }
    }
} 
```

场景二：普通类，实例可以并行，但每个实例只允许调用一次。多个实例可以同时运行代码块。

```
public class UnsafeClass
{
    private object _padLock = new object();

    public void UnsafeMethod()
    {
        lock(_padLock)
        {
            // Do Work
        }
    }
} 
```

场景 3：一个 Class 实例，它与不安全的静态方法交互 - 因此需要确保只存在对 ouside 静态方法的单个调用。无论有多少实例，一次只有一个可以运行该方法，因为它锁定在一个静态对象上。

```
public void UnsafeClass
{
    private static object _padLock = new object();

    public void UnsafeInstanceMethod()
    {
        lock(_padlock)
        {
            // Do Work
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-22T03:06:15.483

属性[MethodImplOptions](http://msdn.microsoft.com/en-us/library/system.runtime.compilerservices.methodimploptions.aspx)有一个用于 Synchronized 的枚举

> 指定该方法一次只能由一个线程执行。静态方法锁定类型，而实例方法锁定实例。只有一个线程可以在任何实例函数中执行，并且只有一个线程可以在任何类的静态函数中执行。

...虽然**不推荐**这样做。此方法的功能等同于`lock(this)`允许其他类意外或恶意获取锁

另一种选择是使用单独的对象用于锁定。这样做时，它可以被标记为只读，除非它是像 Spinlock 这样的结构。简而言之：**不要对 Spinlock 使用 readonly 属性**：这会导致每次调用 SpinLock 或 _lock.Enter 获取对象的新副本并成功。如果这样做，腐败很可能发生。

```
 class myClass
  {
      private object myLock;           //OK
      private readonly object myLock2; //OK
      private readonly SpinLock myLock3;  //WARNING: Value type, won't work as intended
      private SpinLock myLock4;  //OK

     void DoStuff()
     {
        lock(myLock4)
        {
           // some quick instructions... say 10 or fewer
        }
     }
  } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-05-15T21:06:16.330

检查线程 ID 将捕获多线程使用，因为如果有人在多线程程序中使用它，它会抛出消息，希望阻止人们使用该程序。它不会优雅，但它最终会提醒人们注意麻烦。该程序的使用方式将决定在人们意识到错误之前造成严重伤害的可能性。

但总的来说，单线程代码在多线程程序中运行得非常好。它快速*且*（相对）容易编写。（当然，调用代码必须**非常**小心。）您将放弃您的类的这种能力，并将其限制为仅在会从头到尾在一个线程中运行它的程序中运行的程序。例如，在 Windows 桌面程序中，这几乎意味着它必须在事件队列中运行，这意味着它在运行时必然会占用事件队列——没有工作线程！

大多数集合类都是单线程的，但在多线程程序中得到广泛使用。我会将它们用作单线程编码的模型。

# asp.net - 使用具有双向信任的 Active Directory 登录网站

> ID：10607755
> 
> 赞同：0
> 
> 时间：2012-05-15T19:46:44.330
> 
> 标签：asp.net, active-directory, asp.net-membership

我们有一个使用 Active Directory 作为成员资格提供程序的 ASP.NET 网站。该站点使用`Forms`身份验证模式和.NET`Login`控件。我们最近与另一家公司合并，现在他们也需要访问该网站，但他们当然在不同的域上。我们的 IT 人员以双向信任的方式设置了两个 Active Directory。
我可以使用我们网络中的测试帐户登录到他们的域。但是当我在我的网站上使用相同的 DOMAIN\username + 密码组合时，它不起作用。
如何使我们的网站能够看到第二个域上的用户？这不能使用 `Login`控件吗？还是我还缺少其他东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:07:34.073

我认为不可能通过对内置提供程序的信任来对远程 AD 域进行身份验证。您可以设置第二个提供程序，该提供程序配置为指向另一个域，然后将附加逻辑添加到您的登录控件以选择正确的提供程序进行身份验证。我使用类似的方法来支持域用户的“直通”身份验证，同时也支持使用标准表单身份验证的非域用户。

# symfony - Symfony2 管理生成器错误

> ID：10607757
> 
> 赞同：0
> 
> 时间：2012-05-15T19:47:09.267
> 
> 标签：symfony

尝试从控制台设置管理员时出现以下错误

`php app/console admin:setup`

symfony 调用未定义的方法 nodeBuilder::append();

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T22:52:50.273

@user654127 您必须知道您使用的是哪个版本，对于 symfony 2.0，您使用 2.0 分支，对于 symfony 2.1，您使用 master 分支，

# c# - 将数据从 SQL DB 表的列（数据集）导入文本框？

> ID：10607758
> 
> 赞同：1
> 
> 时间：2012-05-15T19:47:17.250
> 
> 标签：c#, asp.net

*使用：ASP.NET 4、SQL 2008、C#*

我正在为我们的项目团队编写一个网络应用程序来跟踪特殊的项目用户。他们要求的一件事是导出他们经常使用的数据的快速列表。例如，我在这里要做的是给团队一个按钮，该按钮将使用保存在我们的 SQL 数据库中的所有各种电子邮件地址填充一个文本框。

我一直在尝试做的是将 TextBox 绑定到数据库中的特定列。我已经与数据库建立了连接，并且我已经构建了一个查询该特定列的数据集，并且它可以正常工作。

我的问题是，我如何告诉 ASP.NET 使用 DataSet 中的数据来填充文本框？这是我目前正在使用的代码：

```
protected void btnGetNPMEmailAddresses_Click(object sender, EventArgs e)
    {
    txbResults.Text = "";
    txbResults.DataBind(ObjectDataSource_Designee_EmailAddresses) // ??? My DataSet
    } 
```

我肯定在爬上 C# 学习曲线。任何帮助将不胜感激！

谢谢，保罗 D。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:03:39.957

尝试这样的事情：

```
protected void btnGetNPMEmailAddresses_Click(object sender, EventArgs e)
{
    // TODO:: Populate ObjectDataSource_Designee
    DataSet dataSet = GetDS(ObjectDataSource_Designee);

    string emails = string.Empty;
    for (int i = 0; i < dataSet.Tables[0].Rows.Count; i++)
    {
        emails = emails + dataSet.Tables[0].Rows[i]["EmailAddresses"].ToString() + Environment.NewLine;
    }
    txbResults.Text = emails;
}

private DataSet GetDS(ObjectDataSource ods)
{
    var ds = new DataSet();
    var dv = (DataView)ods.Select();
    if (dv != null && dv.Count > 0)
    {
        var dt = dv.ToTable();
        ds.Tables.Add(dt);
    }
    return ds;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:53:35.753

您不能数据绑定到 ASP.Net 中的文本框。

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.textbox_properties](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.textbox_properties)

没有 DataSource 属性。您可以手动浏览并抓取数据集中的内容并将其放入文本框中，但不能绑定它。你是说文本框吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:54:04.703

假设您只从数据库中返回一行和一列，您可以执行以下操作：

```
txbResults.Text = dataSet.Tables[0].Rows[0].Cols[0].ToString(); 
```

我的建议是使用只返回一个值的“ExecuteScalar()”方法，而不是使用 DataAdapter/Dataset。

希望这可以帮助！！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T19:56:18.057

我会说

```
 foreach(DataRow dr in DataTable)
  {
    Textbox.Text = Textbox.Text + dr;
  } 
```

如果由于某种原因您必须使用文本框

# sql - PostgreSQL 时间戳 - 索引

> ID：10607759
> 
> 赞同：3
> 
> 时间：2012-05-15T19:47:17.963
> 
> 标签：sql, postgresql, timestamp, range

我正在运行一个查询，在其中查找一条记录，并在一段时间后查找另一条记录。

表定义：

```
(
  id integer primary key,
  gpsstatus character(2),
  datetime timestamp without time zone,
  lat numeric(9,6),
  lon numeric(9,6),
  alt numeric(9,4),
  time integer,
  datafileid integer,
  shape geometry,
  speed double precision,
  dist double precision,
  shape_utm geometry,
  lokalitet character(128),
  cowid integer
) 
```

日期时间、lokalitet、cowid、gpsstatus、shape 和 shape_utm 上有 gist-index 索引。

这些点应该每 5 秒采样一次，所以我试着做

```
select <something more>,p1.timestamp 
from table p1, table p2 
where p1.timestamp + interval '5 secound' = p2.timestamp 
```

那运行得相当快，但后来我发现由于采样中的抖动，我损失了很多点，因此这些点可能相隔 4 到 6 秒。

然后我尝试了：

```
where    (p2.timestamp, interval'0 second')
overlaps (p1.timestamp + interval '4 second', interval '2 second') 
```

这需要很长时间。我还尝试了更简单的解决方案：

```
WHERE p1.timestamp + interval '4 second' <= p2.timestamp
AND   p1.timestamp + interval '6 second' >= p2.timestamp 
```

这也最终变得异常缓慢。

时间戳字段具有正常索引。是否有一种特殊的索引可以使这个查询可用？

目前的查询：

```
SELECT
    p1.cowid,
    p1.datetime,
    st_distance(p1.shape_utm, lead(p1.shape_utm)
      OVER (ORDER BY p1.datetime)) AS meters_obs,
    st_distance(p1.shape_utm, lead(p1.shape_utm, 720)
      OVER (ORDER BY p1.datetime)) AS meters_hour,
    observation.observation
  FROM (gpspoint p1 LEFT JOIN observation
                           ON (observation.gpspointid = p1.id)),
       status
  WHERE p1.gpsstatus = status.id
    AND status.use = true; 
```

我还可以通过询问一些特定的时间间隔来获得可接受的查询时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T20:13:16.323

如果你只想要以前的记录，你可以这样做：

```
SELECT  p, LAG(p) OVER (ORDER BY timestamp) AS pp
FROM    table p
ORDER BY
        timestamp 
```

如果您需要记录`4`到`6`当前秒之前，请使用以下命令：

```
SELECT  p1.*, p2.*
FROM    table p1
LEFT JOIN
        table p2
ON      p2.timestamp BETWEEN p1.timestamp - '4 seconds'::INTERVAL
                         AND p1.timestamp - '6 seconds'::INTERVAL
ORDER BY
        p1.timestamp 
```

如果它们都在范围内，这可能会返回多个先前的记录。

# javascript - apply() 的这种用法在 Javascript 中意味着什么

> ID：10607760
> 
> 赞同：9
> 
> 时间：2012-05-15T19:47:18.910
> 
> 标签：javascript, jquery, web-applications

拜托，有人能告诉我`this.init.apply(this, arguments)`下面的代码做什么吗？

我理解`apply()`一般来说是什么，但是在下面的代码的上下文中，它在那里做什么？

```
var Class = function() {

    var klass = function() {
        this.init.apply(this, arguments); //I don't really get this bit...
    };

    klass.prototype.init = function(){};

    return klass;
};

var Person = new Class;

//Usage
var someone =  new Person; 
```

我看到很多人都在使用它。我知道它的作用，但不能真正动手，所以我需要更多的光。

我要在 JS 中提升一个额外的级别，所以我想了解它的所有内容，而不仅仅是简单的“Hello world”级别。

非常感谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-15T19:52:16.363

[`apply`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/apply)是函数对象的*成员函数*。假设我们有：

```
function saySomething(thing, anotherThing) {
    alert(this + " says " + thing + " and " + anotherThing);
} 
```

然后我们可以使用：

```
saySomething.apply(document, ["hello", "goodbye"]); 
```

这将调用函数并将数组的值作为参数提供给函数。第一个参数指定函数的*上下文*（或者，`this`函数运行时的等于）。

您还应该知道这`arguments`是一个特殊变量，它包含传递给函数的所有参数的数组。所以，在这里，`this.init.apply(this, arguments)`意味着`init`函数被调用并传递了所有传递给`klass`构造函数的参数。

在实际的实现中，我认为`init`会期望参数。考虑如何在没有 的情况下完成`apply`：

```
var klass = function(arg1, arg2, arg3) {
    init(arg1, arg2, arg3);
}

klass.prototype.init = function(arg1, arg2, arg3) {} 
```

如果你想添加`arg4`到 init，你必须在三个地方添加它！通过`klass`透明地将其所有参数传递给`init`，您可以使您的代码变得不那么脆弱。

# codeigniter - CodeIgniter 2.1 - 复选框数组验证失败时不显示验证错误（）？

> ID：10607761
> 
> 赞同：1
> 
> 时间：2012-05-15T19:47:25.290
> 
> 标签：codeigniter, codeigniter-2

我在一个表单中有一个包含两个复选框的数组，按照[这个问题](https://stackoverflow.com/questions/5222790/codeigniter-2-0-validating-arrays)的建议进行设置。当没有选中任何复选框时，验证*似乎*正确地失败了，但看起来 form_validation 甚至没有针对空复选框运行？相关代码：

```
$this->form_validation->set_rules('groupcheck[]', 'groupcheck', 'required'); 
```

如果未选中任何复选框，则提交时不会产生错误（坏），并且“验证”为假（好）。当复选框被选中时，不会产生错误（好）并且表单验证为真（好）。

将验证更改为始终失败的内容：

```
$this->form_validation->set_rules('groupcheck[]', 'groupcheck', 'valid_email'); 
```

如果未选中任何复选框，则提交时不会产生错误（坏），并且“验证”为假（好）。当一个复选框被选中时，会产生一个有效的电子邮件错误（好）并且表单验证为假（好）。

那么，当没有选中复选框时，浏览器没有向 form_validation 返回任何数据是一个问题吗？当未选中复选框时，您将如何显示错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T20:55:32.943

最终，我在视图中添加了一个 form_hidden() 字段，然后即使没有选中复选框，form_validation 也将始终运行

# wcf - 使用 SOAP 调用 WCF 服务

> ID：10607771
> 
> 赞同：4
> 
> 时间：2012-05-15T19:48:15.083
> 
> 标签：wcf, web-services, soap, jmeter

我正在尝试在不创建 WCF 客户端的情况下测试 WCF 服务。[我有与此处](https://stackoverflow.com/a/1643025/1397017)介绍的类似代码/问题。

我希望完全控制 SOAP 有效负载，因此我希望能够发出我自己的 Web 请求/响应并将我自己的 XML 作为参数替换为任何方法。我还希望返回的 SOAP XML 完全按原样，而不创建响应对象、故障异常对象等。

作为参考，我想完全按照[SoapUI](http://www.soapui.org/)在您单击执行按钮并获取响应时所做的事情。我只是假设 SoapUI 不是创建 WCF 客户端、构建请求和调用方法，而是向 WCF 服务发出完整的 SOAP 调用并显示结果。

在回答评论中的问题时，我不想创建 WCF 客户端的原因是我希望与服务的任何和所有更改隔离，不必重建引用、修改我自己的代码、创建单独的每个新服务/方法等的代码，因为这个过程在每次构建后自动启动，没有交互。

所以，我有数十万个测试 XML 参数，我将它们传递给数百个方法，而不关心它们是什么。我们已经在 ASMX Web 服务上做了多年，并且一种方法（与上面的链接非常相​​似）处理了所有 Web 服务/方法/测试参数。

切换到 WCF 后，我会遇到内部服务器错误，尤其是在测试无效的 XML 节点时：缺少必需的节点、重复名称的创建方法中的错误等（任何错误情况）。我认为有一种简单的方法可以以相同的方式使用 WCF 执行此操作是有道理的。

我想要确切的 SoapUI 发回的内容，我只需要知道它是如何做到的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-19T14:20:02.547

@John Saunders 在他的评论中是正确的。无论您使用 ASMX 做什么，都应该能够使用 WCF。事实上，只要您执行正确的 SOAP 请求，您的 Web 服务使用何种框架/技术并不重要。

[WCF](http://msdn.microsoft.com/en-us/library/ms731082.aspx)只是一个帮助构建面向服务的应用程序的框架。与任何其他此类框架一样，它使您可以专注于您将提供的实际服务，并负责将该服务公开为 SOAP Web 服务所需的所有管道功能。

至于 SoapUI，它是一个 Java 工具，可让您测试 Web 服务。当您向它提供 WSDL 时，[它会动态创建](https://stackoverflow.com/questions/8996295/convert-wsdl-to-its-repective-http-bindings/9056358#9056358)请求样本，然后使用（如果我没记错的话）[Http Client](http://hc.apache.org/httpcomponents-client-ga/)将这些请求样本发送到 Web 服务。

如果您有 WCF Web 服务，就不会发生什么特别的事情。即使使用这样的基本客户端，它仍然是 SOAP 通信：

```
public class Program
{
    public static void Main(string[] args)
    {
        // OK, this is not a WCF web service, but that should not matter :D
        string endpoint = "http://www.html2xml.nl/Services/Calculator/Version1/Calculator.asmx";

        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(endpoint);
        request.ContentType = "text/xml"; // or application/soap+xml for SOAP 1.2
        request.Method = "POST";
        request.KeepAlive = false;

        //In case you have a proxy to resolve the server name also add these lines
        var proxyServer = new WebProxy("XX.XX.XX.XX", 1234);
        proxyServer.Credentials = CredentialCache.DefaultCredentials; // or username + password
        request.Proxy = proxyServer;

        // you can read these from files
        string payload = @"<soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:tem=""http://tempuri.org/"">
                               <soapenv:Header/>
                               <soapenv:Body>
                                  <tem:Add>
                                     <tem:a>1</tem:a>
                                     <tem:b>2</tem:b>
                                  </tem:Add>
                               </soapenv:Body>
                            </soapenv:Envelope>";

        byte[] byteArray = Encoding.UTF8.GetBytes(payload);
        request.ContentLength = byteArray.Length;

        Stream requestStream = request.GetRequestStream();
        requestStream.Write(byteArray, 0, byteArray.Length);
        requestStream.Close();

        HttpWebResponse response = null;
        try
        {
             response = (HttpWebResponse)request.GetResponse();
        }
        catch (WebException ex)
        {
             response = (HttpWebResponse)ex.Response;
        }

        Console.WriteLine(string.Format("HTTP/{0} {1} {2}\n", response.ProtocolVersion, (int)response.StatusCode, response.StatusDescription));

        // you can write this to files
        Stream responseStream = response.GetResponseStream();
        StreamReader reader = new StreamReader(responseStream);
        Console.WriteLine(reader.ReadToEnd());

        // cleanp
        reader.Close();
        requestStream.Close();
        responseStream.Close();
        response.Close();
    }
} 
```

您会收到一个 SOAP 响应，在本例中是这样的：

```
HTTP/1.1 200 OK

<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <soap:Body>
        <AddResponse xmlns="http://tempuri.org/">
            <AddResult>3</AddResult>
        </AddResponse>
    </soap:Body>
</soap:Envelope> 
```

并且它是生成它的 ASMX 还是 WCF 或其他任何东西都没有关系。它是对 HTTP 请求的响应。

相反，如果您发送无效消息，例如：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:tem="http://tempuri.org/">
   <soapenv:Header/>
   <soapenv:Body>
      <tem:Add>
         <tem:a>x</tem:a>
         <tem:b>y</tem:b>
      </tem:Add>
   </soapenv:Body>
</soapenv:Envelope> 
```

你会得到一个错误，比如：

```
HTTP/1.1 500 Internal Server Error

<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 
               xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
               xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <soap:Body>
        <soap:Fault>
            <faultcode>soap:Client</faultcode>
            <faultstring> ... exception stacktrace here ... </faultstring>
            <detail />
        </soap:Fault>
    </soap:Body>
</soap:Envelope> 
```

您可以[使用 SoapUI 自动化测试，](http://www.soapui.org/Test-Automation/functional-tests.html)甚至将它们与[Junit](http://www.junit.org/)集成，您甚至可以使用[JMeter](http://jmeter.apache.org/index.html)之类的东西，尽管它不是专门为 Web 服务（如 SoapUI）设计的，但[它可以测试 SOAP](http://jmeter.apache.org/usermanual/build-ws-test-plan.html)。您当然可以使用我添加到答案中的基本客户端。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-21T20:01:05.720

除了我之外，这个问题的答案可能对每个人来说都是显而易见的......但它是：我遇到了（500）内部服务器错误并且不知道该怎么做。事实证明，这对每个人来说都是显而易见的，您必须捕获 WebException 错误。WebException 有一个响应，您可以使用它来获取故障条件、完整响应等。我正在捕获一个异常，但不是专门针对 WebException。抱歉，如果我让任何人感到困惑，但我只是在发生错误情况时遇到问题，否则所有代码示例（甚至是我的原始代码示例）都在工作。

我想我可以将此作为另一个问题发布，但这是典型的行为吗？即使对于尝试创建重复记录/项目、无效名称等简单的错误，也会引发 WebException？我确定由于缺乏经验，我希望错误响应以与成功响应相同的方式返回，而不会出现内部服务器错误并且不需要在服务之外捕获 WebException（除非它确实是“网络”例外）。

感谢您的所有回答。

# c# - Linq to Entities 添加 Where 子句以在另一个表中查找 EXISTS

> ID：10607776
> 
> 赞同：1
> 
> 时间：2012-05-15T19:48:53.570
> 
> 标签：c#, linq, linq-to-entities, exists

使用 Linq to Entities，我有一个`IQueryable<T>`并且想要添加另一个 WHERE 子句，它相当于`EXISTS`SQL 中的一个子句。我不需要实际从另一个表中提取任何数据，只需检查是否满足条件即可过滤结果。这是我最近的尝试：

```
IQueryable<FileEntity> files = repository.Files.Where(...);
// More stuff done to files

files = files.Where(f => repository.FileInfo.Where(i => i.Foo == "bar")
                                            .Select(i => t.FileId)
                                            .Contains(f => f.FileId));
var list = files.ToList(); // ERROR! 
```

我也尝试过类似的东西：

```
files = files.Where(f => repository.FileInfo.Any(i => i.FileId == f.FileId)); 
```

任何情况下的例外都是ol'“无法创建'FileInfo'类型的常量值。在此上下文中仅支持原始类型（'例如'Int32、String和Guid'）。”

您如何在数据库服务器上实现这种类型的查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:55:36.753

好吧，一种选择是使用连接：

```
files = files.Join(repository.FileInfo.Where(i => i.Foo == "bar"),
                   f => f.FileId,
                   i => i.FileId,
                   (f, i) => f)
             .Distinct(); 
```

我不希望这一定会转化为 SQL 中的 EXISTS 查询，但看看查询计划，它很可能会做同样的事情......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T20:59:43.220

```
IQueryable<FileEntity> files = repository.Files.Where(...);
// More stuff done to files
var ids = repository.FileInfo.Select(i=>i.FileId).ToList();

var list = files.Where(f => ids.Contains(f.FileId)).ToList(); 
```

# php - 如何使用 PHP 在 Windows 中自动验证 LDAP

> ID：10607778
> 
> 赞同：1
> 
> 时间：2012-05-15T19:49:17.597
> 
> 标签：php, iis, ldap

在 PHP（在 IIS 下的 Windows 服务器上运行）中，我有一个登录页面，用于根据 Windows 域控制器验证输入的用户名/密码。

该代码使用`ldap_connect`和`ldap_bind`反对用户输入（用户名+密码）。

但我希望 PHP 代码自动提取登录用户，因此他们不必输入用户名和密码。用户已经使用 Internet Explorer 在域下登录计算机。

如何让 PHP 代码针对 Windows 机器上的用户中的记录器自动进行身份验证（在 IE 中）？

`$_SERVER["AUTH_USER"]`并且`$_SERVER["REMOTE_USER"]`不起作用，它只在 IE 中返回一个空白字符串。

我发现我可以使用这个 Javascript：

```
ActiveXObject("WScript.Network") 
```

（然后提取用户名）但这对我不起作用，因为它要求用户首先正确设置其 ActiveX 信任级别（这会降低用户的安全性）。

# matlab - Matlab - 无法显示手动设置的轴

> ID：10607784
> 
> 赞同：1
> 
> 时间：2012-05-15T19:49:44.367
> 
> 标签：matlab, panel, uicontrol, axes

我创建了一个图形和一个 uicontrols 面板。当我运行程序时，面板会覆盖默认轴（或绘图区域，如果更合适的话）。所以，我想让面板在某个位置，轴（或绘图区域）设置在一个单独的位置。我已经阅读了 Matlab 帮助并尝试了 set、get、CurrentAxes、axis 方法的许多变体。我还是想不通。到目前为止的基本代码是

```
mytitle = 'Kinematic Control of a Redudant Robotic System';
simfig = figure( 'menubar', 'none', 'position', [ 140 140 600 600], 'Name', mytitle, 'NumberTitle', 'off');
ax = axes( 'Parent', simfig, 'Units', pixels, 'Position', [ 150 150 300 300], 'XLim', [ 0 10], 'YLim', [ 0 8]);
panbut  = uipanel( simfig, 'Units', pixels, 'position', [20 45 143 150], 'Title', 'Simulation Buttons');
%buttons
up      = uicontrol( panbut, 'style', 'pushbutton', 'string', 'up',   'position', [ 50 90 40 40], 'callback', @up_button_press);
down    = uicontrol( panbut, 'style', 'pushbutton', 'string', 'down', 'position', [ 50 10 40 40], 'callback', @down_button_press); 
right   = uicontrol( panbut, 'style', 'pushbutton', 'string', 'right','position', [ 90 50 40 40], 'callback', @right_button_press); 
left    = uicontrol( panbut, 'style', 'pushbutton', 'string', 'left', 'position', [ 10 50 40 40], 'callback', @left_button_press); 
```

我想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T20:06:42.847

如果您使用该`position`属性定位绘图，结果可能会非常不准确，因为标签和刻度标签的空间会添加到您定义的空间中`position`。

为了避免重叠，您可以设置的`OuterPosition`属性`axes`：

```
mytitle = 'Kinematic Control of a Redudant Robotic System';
simfig = figure( 'menubar', 'none', 'position', [ 140 140 600 600],...
    'Name', mytitle, 'NumberTitle', 'off');
ax = axes( 'Parent', simfig, 'Units', 'pixels','outerPosition', [ 150 150 300 300], ...
    'XLim', [ 0 10], 'YLim', [ 0 8]);
panbut  = uipanel( simfig, 'Units', 'pixels', 'position',...
    [20 45 143 150], 'Title', 'Simulation Buttons');
%buttons
up      = uicontrol( panbut, 'style', 'pushbutton',...
    'string', 'up',   'position', [ 50 90 40 40],...
    'callback', @up_button_press);
down    = uicontrol( panbut, 'style', 'pushbutton',...
    'string', 'down', 'position', [ 50 10 40 40], ...
    'callback', @down_button_press);
right   = uicontrol( panbut, 'style', 'pushbutton',...
    'string', 'right','position', [ 90 50 40 40], ...
    'callback', @right_button_press);
left    = uicontrol( panbut, 'style', 'pushbutton',...
    'string', 'left', 'position', [ 10 50 40 40],...
    'callback', @left_button_press); 
```

# jquery - jQuery Mobile 关闭对话框并加载不同的页面

> ID：10607785
> 
> 赞同：0
> 
> 时间：2012-05-15T19:49:45.380
> 
> 标签：jquery, jquery-mobile

在 jQuery mobile 中，当用户打开一个新页面（比如说 example.html）时，是否有可能

*   淡入对话框（背景为 example.html）
*   3 秒后，对话框淡出并
*   example.html 现在可见

我已经设置了对话框，但不确定如何淡入/淡出对话框。

```
<div data-role="page">
// page
</div>

<div data-role="dialog">
  // dialog box fades in, 3 seconds later, fade out
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T21:20:42.223

使用唯一的 id 注释页面和对话框，并将类似这样的内容绑定到`pageshow`页面的事件：

```
jQuery('#myPageId').bind('pageshow', function() {
    var me = jQuery(this);
    var dialogShown = me.data('dialogShown');
    var dialog = jQuery('#myDialogId');
    if(!dialogShown) {
        me.data('dialogShown', true);
        dialog.one('pageshow', function() {
            setTimeout(function() { window.history.back(); }, '3000');
        });
        jQuery.mobile.changePage(dialog, {transition: 'fade'}); 
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:52:57.163

使用该`fadeOut`方法，您应该能够淡化对话框。然后设置一个计时器在页面加载后 3 秒调用。

# mysql - 使用“set”字段类型时需要的mysql设计技巧

> ID：10607786
> 
> 赞同：1
> 
> 时间：2012-05-15T19:49:45.570
> 
> 标签：mysql

我正在开始一个新的 MySQL 数据库项目，其中表的关键字段之一`Organizations`将是`Town`. 一个人可以在这里选择多个城市或城镇，也可以选择整个州的任何城市或城镇。他们需要能够轻松添加新城镇，并且能够轻松移除城镇也很棒。所以，由于需要有多个枚举类型的值，我认为字段类型`Town`应该是`set`. 然后，当我定义表格和字段时，`Town`我可以枚举所有 170 个城镇。
但是，我想我仍然需要另一个表格来列出所有这些城镇，这样当他们为他们的组织选择城镇时，我可以在下拉列表中使用它。

1.  这是正确的方法吗，使用字段类型`set`和城市/城镇的单独表，这将匹配我为此字段枚举的内容？我将进行大量搜索并希望优化搜索，因此如果有更好的方法来组织它，我很想知道。

2.  我知道如何`concat()`将一个城镇添加到特定组织的现有城镇列表中（即`UPDATE Organization SET Town = concat(Town, ',Springfield') WHERE OrgID = 1`），并且效果很好。但是，如果他们已经指定了一长串城镇并且只想删除一个城镇，是否有等效的？

# mysql - 使用 MySQL 构建倒排索引系统

> ID：10607790
> 
> 赞同：4
> 
> 时间：2012-05-15T19:49:55.787
> 
> 标签：mysql

我正在构建一个需要大量搜索查询的移动服务。

该服务基于MySQL数据系统，搜索查询不足以做一个快速的搜索服务。

因此，我决定使用倒排索引系统：

```
index    Documents
1        a, b, c, d, e, f, g, h
2        c, k, i, j, k 
```

这是倒排索引系统的简单构造。

我假设一行会有超过一千个文档。

**我不确定“文档”列应该使用哪种类型和长度？**

我现在选择了 VARCHAR(100000)。是否可以设置像 9999999 这样的长度？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-05-15T20:04:06.560

1.  数据结构：

    ```
    index document
      1      a
      1      b
      1      c
     ...
      2      c
      2      k 
    ```

    `index`类型`INT`，`document`类型`CHAR(1)`。主键为`index`和的集合`document`。

    使用这种数据结构，查询将执行得非常快。
    顺便说一下，我提出的结构是[规范化](http://en.wikipedia.org/wiki/Database_normalization)的。

2.  来自 MySQL 5.0 参考手册（[The `CHAR`and `VARCHAR`Types](http://dev.mysql.com/doc/refman/5.0/en/char.html)）：

> [...] `VARCHAR`[...] 在 MySQL 5.0.3 之前，长度可以指定为 0 到 255 之间的值，在 5.0.3 和更高版本中可以指定为 0 到 65,535 之间的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:57:55.020

恕我直言，这会变得很难看，但话虽如此，您的 varchar 大小会覆盖它，或者您可以查看 TEXT、mediumTEXT 或 longTEXT：

```
TEXT    65,535 bytes    ~64kb
MEDIUMTEXT   16,777,215 bytes   ~16MB
LONGTEXT    4,294,967,295 bytes ~4GB 
```

# c++ - Open Inventor 中的 SoRayPickAction？

> ID：10607792
> 
> 赞同：5
> 
> 时间：2012-05-15T19:49:58.930
> 
> 标签：c++, 3d, openinventor

抱歉，如果这是重复的，但我正在尝试找出 Open Inventor 中 SoRayPickAction 的实现。我正在尝试实现它，以便在单击鼠标时选择一个特定节点，以便我可以平移、旋转等。我有三个节点：桌子、灯和框架（相框）。但是，我不认为我的代码完全正确。我也有各种方法，例如 MouseButtonCallback（它将检查鼠标是否被单击，然后使用导航器）和 MouseMoveCallback（相同的想法）。所以这是我的代码，但你有什么建议吗？现在，好吧，它什么也没做。

```
SbViewportRegion viewport(400,300); 
    SoRayPickAction m(viewport); 
    m.setRay(SbVec3f(0.0,0.0,0.0), SbVec3f(0.0,0.0,-1.0));
    m.apply(callback_node);
    const SoPickedPoint *mpp = m.getPickedPoint(); 
    if(mpp != NULL) {
        std::cout << "test" << std::endl;
    } 
```

您是否还知道 OpenInventor 中可以在场景中“放置”节点的动作，即将台灯放置在桌面上，将框架放置在墙上等。是否带有路径？不幸的是，我什至不知道我在寻找什么。非常感谢你的帮助！！

编辑：这看起来怎么样？SoSeparator *desk2; SoSeparator *lamp2; SoSeparator *pic_frame2; SoSeparator *选中；

```
void MouseButtonCallback(void* data, SoEventCallback* node)
{
   SoHandleEventAction* action = node->getAction();
   const SoMouseButtonEvent* event = static_cast<const SoMouseButtonEvent*>(action-          >getEvent());
   Navigator* nav = static_cast<Navigator*>(data);

   if (SoMouseButtonEvent::isButtonPressEvent(event, event->getButton())) 
       nav->OnMouseDown(event, action);
   else
         nav->OnMouseUp(event, action);

   const SbViewportRegion & viewportRegion = action->getViewportRegion();
   SoRayPickAction pickAction(viewportRegion); 

   SbVec2s mousePos = event->getPosition(viewportRegion); 
   pickAction.setPoint(mousePos); 
   pickAction.setPickAll(TRUE); 
   pickAction.setRadius(2.0F); 
   pickAction.setRay(SbVec3f(0.0,0.0,0.0), SbVec3f(0.0,0.0,-1.0));
   pickAction.apply(node);
   const SoPickedPoint *mpp = pickAction.getPickedPoint(); 
   if(mpp != NULL) {
  SoPath *path = mpp->getPath(); 

 if(desk2 != NULL && path->containsNode(desk2))
  {             //but this doesn't respond with cout when I try to test it :(
      if (SoMouseButtonEvent::isButtonPressEvent(event, event->getButton()))
      *picked = *desk2; 
  }
  else if(lamp2 != NULL && path->containsNode(lamp2))
  {
      if (SoMouseButtonEvent::isButtonPressEvent(event, event->getButton()))
      *picked = *lamp2;
  }
  else if(pic_frame2 != NULL && path->containsNode(pic_frame2))
  {
      if (SoMouseButtonEvent::isButtonPressEvent(event, event->getButton())) 
      *picked = *pic_frame2;
  }

           action->setHandled();
   }
 void MouseMoveCallback(void* data, SoEventCallback* node)
{
    SoHandleEventAction* action = node->getAction();
    const SoLocation2Event* event = static_cast<const SoLocation2Event*>(action->getEvent());
    Navigator* nav = static_cast<Navigator*>(data);

    nav->OnMouseMove(event, action);

     const SbViewportRegion & viewportRegion = action->getViewportRegion();
    SoRayPickAction pickAction(viewportRegion); 

    SbVec2s mousePos = event->getPosition(viewportRegion); 
    pickAction.setPoint(mousePos); 
    pickAction.setPickAll(TRUE); 
    pickAction.setRadius(2.0F); 
    pickAction.setRay(SbVec3f(0.0,0.0,0.0), SbVec3f(0.0,0.0,-1.0));
    pickAction.apply(node);
    const SoPickedPoint *mpp = pickAction.getPickedPoint(); 
    if(mpp != NULL) {
  SoPath *path = mpp->getPath(); 
  if(desk2 != NULL && path->containsNode(desk2))
  {
      *picked = *desk2; //can't remember how to set pointers, will figure that out
  }
  else if(lamp2 != NULL && path->containsNode(lamp2))
  {
      *picked = *lamp2;
  }
  else if(pic_frame2 != NULL && path->containsNode(pic_frame2))
  {
       *picked = *pic_frame2;
  }
   }  
        action->setHandled();
    }

  (part of main method) 

 //desk 
SoTransform *desk_transform = new SoTransform; 
desk_transform->translation.setValue(SbVec3f(380,340,330)); 
SoSeparator* desk2 = new SoSeparator(); 
desk2->addChild(desk_transform);
desk2->addChild(desk); 
root->addChild(desk2);

  SoTransformerManip* picked_transform = new SoTransformerManip(); 
   picked_transform->translation.setValue(SbVec3f(200,340,330));
  SoSeparator* pick2 = new SoSeparator(); 
  pick2->addChild(picked_transform); 
  pick2->addChild(picked); 
  root->addChild(pick2); 

 std::auto_ptr<btCollisionShape> picked_shape(new btBoxShape(btVector3(10.0f, 10.0f,  10.0f)));
  CollisionEngine* picked_collision = new CollisionEngine(collision_world.get(),      picked_shape.get());
  picked_collision->translation_in.connectFrom(&picked_transform->translation);
  picked_collision->rotation_in.connectFrom(&picked_transform->rotation);
  picked_transform->translation.connectFrom(&picked_collision->translation_out); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T03:45:02.493

你有选择的点。然后你得到一个`SoPath`你猜到的。然后查看路径中是否包含您想要使用的节点。

```
SbViewportRegion viewport(400,300); 
    SoRayPickAction m(viewport); 
    m.setRay(SbVec3f(0.0,0.0,0.0), SbVec3f(0.0,0.0,-1.0));
    m.apply(callback_node);
    const SoPickedPoint *mpp = m.getPickedPoint(); 
    if(mpp != NULL) {
        std::cout << "test" << std::endl;
        SoPath * path = pickedPoint->getPath();

        if (deskSeparator != NULL && path->containsNode(deskSeparator)
        {
        }
        else if (lampSeparator != NULL && path->containsNode(lampSeparator)
        {
        }
        else if (radomeSeparator != NULL && path->containsNode(radomeSeparator)
        {
            if (    SoMouseButtonEvent::isButtonPressEvent( event, SoMouseButtonEvent::BUTTON2 )
                 || ( SoMouseButtonEvent::isButtonPressEvent( event, SoMouseButtonEvent::BUTTON1 ) && event->wasShiftDown() ) )
            {
                modelPointMoving = true;
                const SoDetail * detail = modelPickedPoint->getDetail( 0 );
                int face = -1;
                if ( detail && detail->isOfType( SoFaceDetail::getClassTypeId() ) )
                {
                    const SoFaceDetail * faceDetail = static_cast<const SoFaceDetail *>( detail );
                    face = faceDetail->getFaceIndex();
                }
                updateStatusBar( face, point.getValue(), normal.getValue() );
                graphicModel.postNote( pickedPoint );
                break;
            }
            else if ( SoMouseButtonEvent::isButtonPressEvent( event, SoMouseButtonEvent::BUTTON1 ) )
            {
            }
            else if ( SoMouseButtonEvent::isButtonReleaseEvent( event, SoMouseButtonEvent::BUTTON1 ) )
            {
            }
        }
    } 
```

您最终会希望将拾取射线连接到鼠标位置，如下所示：

```
//  Set an 2-pixel wide region around the pixel.
SbVec2s mousePosition = event->getPosition( viewportRegion );
pickAction.setPoint( mousePosition );
pickAction.setPickAll( TRUE );
pickAction.setRadius( 2.0F ); 
```

这`.apply()`当然是在您选择操作之前完成的。

我想我的代码是你和我的混合体，但我认为它应该给你一个开始。此外，这是一个处理鼠标事件的函数：

```
void
RenderWindow::mouseEvent( void *, SoEventCallback * eventCallback )
{
    const SoEvent *event = eventCallback->getEvent();

    if ( ! event )
    {
        qDebug() << "  **  Error in mousePressCallback: Event not found.";
        return;
    }

    //SoType eventType = event->getTypeId();   
    //SbName eventTypeName = eventType.getName();
    //const char * eventTypeString = eventTypeName.getString();
    SoHandleEventAction * action = eventCallback->getAction();
    const SbViewportRegion & viewportRegion = action->getViewportRegion();
    SoRayPickAction pickAction( viewportRegion ); 
```

在主程序或设置例程中，我注册了鼠标事件（对于单击操作和位置（将鼠标移动到视口上）：

```
//  Add a mouse event callback to catch mouse button presses.
SoEventCallback * mouseEventCallback = new SoEventCallback();
mouseEventCallback->setName( "MOUSE_EVENT_CALLBACK" );
mouseEventCallback->addEventCallback( SoMouseButtonEvent::getClassTypeId(), &::mouseEvent, static_cast<void *>( this ) );
//  Add a mouse event callback to catch mouse motion.
mouseEventCallback->addEventCallback( SoLocation2Event::getClassTypeId(), &::mouseEvent, static_cast<void *>( this ) );
rootSeparator->addChild( mouseEventCallback ); 
```

现在我看着它，我以相反的顺序写了这些块;-)。对不起。

祝你好运

# jquery - WordPress 滑块

> ID：10607793
> 
> 赞同：0
> 
> 时间：2012-05-15T19:50:01.887
> 
> 标签：jquery, image, wordpress, slider, carousel

有没有人见过一个 wordpress 插件滑块，它会在滑入之前部分显示下一个和上一个图像？或者是否有人知道可以轻松定制以显示该效果的一种？任何演示、指导或链接都将非常有帮助！首先十分感谢！

*   迈克尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T20:04:41.240

[Wordpress jQuery Slider](http://wordpress.org/extend/plugins/jquery-slider/)对我来说效果很好。

然后你只需要添加这样的代码并在 wordpress 中自定义它：

```
<?php if(function_exists('jquery-slider')){ jquery-slider(); } ?> 
```

访问您添加的内容。你想把它放在哪里取决于你；在主要、页脚或您的博客文章中。

# javascript - 打开另一个选项卡时，页面的一部分变空

> ID：10607794
> 
> 赞同：0
> 
> 时间：2012-05-15T19:50:03.307
> 
> 标签：javascript, html, css

当您打开此页面并右键单击任何菜单项并单击“在新选项卡中打开链接”时，不会发生任何事情，页面将保持不变。但是，如果你用鼠标滚轮在新标签库中打开它，它就会消失。这个非同寻常的错误令人震惊。知道如何解决它或为什么要这样做吗？

链接到页面；[http://goo.gl/kfjlJ](http://goo.gl/kfjlJ)

基本上; 我不断更改画廊 div 的显示属性，这就是我使此页面与此代码一起工作的方式。

```
<script type='text/javascript'>//<![CDATA[ 
    $(window).load(function(){

    $('a').click(function() {
      $('.gallery').hide();
      $('#' + $(this).data('gallery')).show();
    });
});//]]>  
</script> 
```

# ruby-on-rails - 设置 Rails 模型关联

> ID：10607803
> 
> 赞同：0
> 
> 时间：2012-05-15T19:50:30.173
> 
> 标签：ruby-on-rails, database, ruby-on-rails-3, activerecord, associations

我的 Rails 应用程序有一个用户模型，它与兴趣和假期有 HABTM 关系。这两者（兴趣和假期）只有一个属性需要编辑并与用户相关。这是设置和工作正常。

我需要创建一个名为friend_birthday 的新模型，其中包含有关用户朋友的生日（以及他们各自的兴趣）的信息。这个模型（friend_birthday）需要有几个属性（:name、:gender、:dob 和:interests）。

我正在考虑为此使用 has_many/belongs_to。用户有很多friends_birthdays 和friends_birthdays 属于一个用户。

这听起来对吗？我怎么能实现这个？

谢谢！！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T20:05:32.693

是的，这听起来不错，但我认为最好命名模型朋友

```
class Friend
  belongs_to :user
  #also u can use HABTM for interests, 
  #but it is better to use rich join table and polymorphic association
  has_and_belongs_to_many :interests 
end

class User
  has_many :friends
end 
```

Ofc 如果朋友不是用户））只是 RL 朋友

# jquery - 显示“正在加载内容消息”

> ID：10607805
> 
> 赞同：0
> 
> 时间：2012-05-15T19:50:55.747
> 
> 标签：jquery, html, ajax, web-frontend

我正在使用它来动态加载事件而无需刷新页面，但是加载时间有点多，所以为了更好的用户体验，我认为我们应该添加“加载事件”或类似的东西，但到目前为止我的尝试都是徒劳的。

```
function calendarAjax () {

    $('#month_nav a').live('click', function() {
        $('#events_container').animate({ opacity: "0" }, 200 ).load($(this).attr('href')+' #events_content' , function(){
            $(this).animate({ opacity: "1" }, 600 );
        });
        return false;
    })

}; 
```

非常感谢任何帮助。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:55:32.917

你需要三样东西：

装载机：

```
<div id="loader">
I'm loading something
</div> 
```

加载器的 CSS：

```
#loader {
   /* some design */
} 
```

那么您需要创建一个 javascript 方法来切换其可见性：

```
var loader = {
    show: function() {
        $('#loader').show();
    },
    hide: function() {
        $('#loader').hide();
    }
}; 
```

然后，您只需说出`loader.show()`想要*加载*某些内容的时间，以及`loader.hide()`想要关闭该消息的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:57:26.830

有几种方法，这里是使用[$ajaxStart](http://api.jquery.com/ajaxstart/)和[$.ajaxStop的全局加载图像/文本代码](http://api.jquery.com/ajaxstop/)

```
$('#loadingDiv')
    .hide()  // hide it initially
    .ajaxStart(function() {
        $(this).show();
    })
    .ajaxStop(function() {
        $(this).hide();
    }); 
```

假设您的加载 div 的 ID`loadingDiv`包含文本或加载图像。

**更新**

[$.load](http://api.jquery.com/load/)是一个 jQuery[速记方法](http://api.jquery.com/category/ajax/shorthand-methods/)，它像其他几个方法一样，例如[$.post](http://api.jquery.com/jQuery.post/)、[$.get](http://api.jquery.com/jQuery.get/)、[$getJSON](http://api.jquery.com/jQuery.getJSON/)、[$.getScript](http://api.jquery.com/jQuery.getScript/)在底层使用[$.ajax](http://api.jquery.com/category/ajax/)函数。

[$.ajaxStart](http://api.jquery.com/ajaxStart/)是一种在第一个 ajax 请求开始时注册要执行的回调的方法，并且 [$.ajaxStop](http://api.jquery.com/ajaxStop/)用于注册要在所有 ajax 请求完成时执行的回调的相同方式

因此，如果您使用上述代码显示和隐藏加载 div，它将在您的`$.load`函数的 ajax 请求启动时自动显示加载文本/图像，并在 ajax 请求完成时隐藏，假设您在该页面中只有一个`$.ajax`或`$.ajax`速记方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:55:25.880

[Jquery BlockUI 插件](http://jquery.malsup.com/block/)非常适合您的需求。

# selenium - 将 selenium 绑定到特定 IP - 可能吗？

> ID：10607806
> 
> 赞同：16
> 
> 时间：2012-05-15T19:51:17.913
> 
> 标签：selenium, ip, bind, ip-address

像许多人一样，我们通过以下命令启动 selenium 服务器：

```
java -jar selenium-server-standalone-2.21.0.jar 
```

我们发现这会在 0.0.0.0:4444 打开 selenium

```
Started SocketListener on 0.0.0.0:4444

[USER @ BOX ~]# netstat -na | grep LISTEN | grep 4444
tcp        0      0 :::4444                     :::*                        LISTEN 
```

有什么方法可以将硒绑定到特定的 IP（本地主机）？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-16T01:11:14.810

使用以下命令

```
 java -jar selenium-server-standalone-2.21.0.jar -host 192.168.1.100 
```

其中 192.168.1.100 是主机的 IP 地址

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-02-15T06:17:09.240

这不是处理这个问题的正确方法，而是一种方法

所以这将做的只是从任何外部源断开端口 4444 上的任何连接。您可以通过首先进入页面来测试它

像这样启动服务器

```
java -jar selenium-server-standalone-2.39.0.jar -host 127.0.0.1 -port 4444 
```

验证一切正常

```
http://yourexternalip:4444/wd/hub/ 
```

页面将加载。如果您的服务器运行正常。

发送命令

```
sudo iptables -A INPUT -p tcp --dport 4444 -s 127.0.0.1 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 4444 -j DROP 
```

然后重新加载页面。该网页将不再可访问（因为您正在从外部 IP 访问）

您的新可访问 URL 现在是

```
http://127.0.0.1:4444/wd/hub/ 
```

这应该工作

同样，这更像是解决更大问题的创可贴，这样做不会迫使您更改任何源代码并仍然保持系统安全

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-10T13:02:05.443

这可以通过添加“-host 192.168.1.100”参数来实现，前提是您的版本中有此修复：

[https://code.google.com/p/selenium/source/detail?r=71c5e231f442](https://code.google.com/p/selenium/source/detail?r=71c5e231f442)

（在撰写本文时，该修复不包含在可用的二进制文件中，因此您必须从源代码构建自己的。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T20:48:07.663

你可以`java -jar selenium-server-standalone-2.21.0.jar`在远程机器上运行

然后在您的 selenium 脚本中定义您的 webdriver 以远程运行。

在红宝石中你可以这样做

```
@driver = Selenium::WebDriver.for(:remote, :url => "http://specific_ip_of_remotemachine:4444", :desired_capabilities => firefox) 
```

这是你想要的？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-24T09:53:57.367

我在 Hub 上也遇到了同样的问题。因此，当我尝试启动集线器时，我的集线器指向其他 IP 地址，但是当我检查我的 IP 地址时，它在我的本地系统上有所不同。为了克服这个问题，我刚刚尝试了以下代码并且它有效。

```
java -jar selenium-server-standalone-3.12.0.jar -host 192.XXX.X.XX -role hub 
```

我的集线器已注册到我的本地机器 IP 地址。

# c# - 如何检测图像上的水位？

> ID：10607807
> 
> 赞同：0
> 
> 时间：2012-05-15T19:51:39.707
> 
> 标签：c#, java, image, algorithm

我的作业是编写一个非常简单的应用程序（Java 或 C#，我都知道），它可以检测图片中一杯水/可乐的水位（它必须在那里画一条线）。我什至不知道如何开始。我用谷歌搜索了一整天，但没有找到有用的结果。有什么好的算法可以检测液位吗？

照片是从侧面拍的，像这样：

![在此处输入图像描述](../Images/86dd3f448feca3d45a39a7b12e15ede5.png)

（如果它检测到两条线也很好）。那么你能帮我看看如何开始吗？使用 egde 检测（有没有好的基本算法？），或其他方法？

如果它能检测到水、焦炭和每一种液体等，那将是最好的……

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T20:25:30.677

你将不得不做一些边缘检测，然后一旦你有了边缘，试着找到玻璃内的水平。您可以使用像[Aforge.NET](http://www.aforgenet.com/framework/downloads.html)这样的工具包。然后检测边缘的代码非常简单，例如：

```
Bitmap b = new Bitmap(Image.FromFile(@"C:\Temp\water.jpg"));
// create filter
Edges filter = new Edges();
// apply the filter
filter.ApplyInPlace(b);

pictureBox1.Image = b; 
```

产生这样的图像：

![在此处输入图像描述](../Images/457eae00236c99dea9f26108c43c3a66.png)

现在应该更容易找到玻璃杯中的水点。由于所有背景噪音都已消除，您可以专注于确定您应该关闭哪个边缘。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:13:51.957

它将帮助您获得相关玻璃的容量。

一旦您知道玻璃杯可以容纳多少水，您就可以使用您自己编写的函数在图像上画两条线。我建议用一条线表示玻璃尺寸，另一条线表示叠加在图像上的水位线，然后您可以使用这些线和玻璃的最大容量来形成两者之间的相关性并计算其中包含的液位玻璃。

请记住，您的教授对您获得 100% 正确的作业并不感兴趣，他们更感兴趣的是让您准备好用自己的主动性解决问题。谷歌搜索并不总能解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T20:00:03.087

[在此处](http://shedletsky.com/hough/index.html)检查霍夫变换

# java - OpenFaces 教程

> ID：10607809
> 
> 赞同：0
> 
> 时间：2012-05-15T19:51:58.687
> 
> 标签：java, treetable

网上有什么地方可以找到 openfaces 组件的教程吗？几天来，我一直在尝试实现动态树表，但遇到了麻烦，但是文档根本没有帮助，因此很难克服这个障碍。

谢谢，

昆顿

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-17T13:49:42.770

除了[文档](http://openfaces.org/documentation/)和[常见问题解答](https://sites.google.com/a/teamdev.com/openfaces-support/documentation/openfaces-faq)之外，您可能会发现这些文章很有用：

*   [OpenFaces 简介，第 1 部分](http://www.jsfcentral.com/articles/openfaces_1.html)——概述；
*   [OpenFaces 简介，第 2 部分——DataTable](http://www.jsfcentral.com/articles/openfaces_2.html)和 TreeTable 组件概述。

您还可以[下载](http://openfaces.org/downloads/)OpenFaces 演示应用程序的源代码来研究工作示例。

如果文档不够清晰，您可以搜索解决方案或在讨论区寻求[澄清](http://links.teamdev.com/openfaces-forum)。

# javascript - 在 XMPP MUC 中是否可以发布地理位置信息？

> ID：10607812
> 
> 赞同：2
> 
> 时间：2012-05-15T19:52:07.423
> 
> 标签：javascript, geolocation, xmpp, openfire

在 XMPP [MUC](http://xmpp.org/extensions/xep-0045.html)中是否可以发布每个在线用户的地理位置信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-16T02:02:27.233

当然，客户端可以简单地在房间中包含一个`<geoloc>`元素（在[XEP-0080中定义）：](http://xmpp.org/extensions/xep-0080.html)

```
<presence to="room@roomserver/nickname">
    <x xmlns='http://jabber.org/protocol/muc'/>
    <geoloc xmlns='http://jabber.org/protocol/geoloc'>
      <accuracy>20</accuracy>
      <country>Italy</country>
      <lat>45.44</lat>
      <locality>Venice</locality>
      <lon>12.33</lon>
    </geoloc>
</presence> 
```

后续更新自然会忽略该`<x>`元素，因为这些仅在加入房间时才包含在内。

# java - Android：OpenGL：何时加载纹理？

> ID：10607819
> 
> 赞同：0
> 
> 时间：2012-05-15T19:52:25.697
> 
> 标签：java, android, opengl-es

我正在尝试制作一个包含 3 个阶段的 OpenGL 游戏：欢迎、战斗和盔甲。每个阶段都有不同的逻辑和不同的纹理。

何时是加载这些纹理的最佳时间，所有这些都在开始时加载，或者加载每个阶段激活时使用的纹理。如果是这样，我应该在切换到另一个阶段时删除它们吗？

如果第二种方法最好，如何在每个阶段加载纹理时显示静态启动画面（图像）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T21:05:22.470

好吧，加载纹理（尤其是从 sd 卡）可能需要一些时间。在需要它们之前加载它们的原因是避免在阶段之间出现加载屏幕。如果玩家经常在阶段之间切换，并且您的纹理不是那么大，您可能希望在启动时加载它们（给等待游戏加载一次的痛苦，即使它会更长）。您必须在可供您使用的记忆以及您想通过打断玩家的游戏体验来激怒玩家的程度之间做出平衡。

您还可以通过在阶段结束时显示记分牌来分散玩家的注意力，以向他展示他刚刚的表现，而不是加载栏。

如果你能预料到玩家什么时候会很快切换到另一个阶段，你可以尝试在背景中流式传输纹理，但这样做要复杂得多（嗯，尤其是在移动平台上），所以你需要为此做一些研究。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T19:59:02.607

我认为只有在该阶段需要它们时才应该加载它们。如果玩家可能无法进入下一阶段，为什么还要在视频 RAM 上加载纹理来浪费内存？

您可以显示一个根据您的需要定制的对话框，并在您准备好时将其关闭。我现在没有任何样品。

# android - 在 ImageView 中交换图像

> ID：10607821
> 
> 赞同：5
> 
> 时间：2012-05-15T19:52:28.437
> 
> 标签：android, image

我一直在尝试在我的应用程序中实现简单（我认为）的东西。我认为这很简单，但不知怎的，它并没有像我想要的那样工作。

我想做的是：

*   ImageView 在中心有一个活动 - 它有自己的图像（嗯，有两个）。
*   我想按下那个 ImageView（或者它可能是 ImageButton），打开画廊/用相机拍照。
*   然后，在拍摄/挑选图片后，我想让 ImageView 显示图片的缩略图。

**我的布局**

```
 <ImageView
                    android:id="@+id/add_photo_left"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:layout_marginRight="20dp"
                    android:layout_weight="1"
                    android:adjustViewBounds="true"
                    android:src="@drawable/add_photo_button" />

                <ImageView
                    android:id="@+id/add_photo_right"
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:adjustViewBounds="true"
                    android:src="@drawable/add_photo_button" />
            </LinearLayout> 
```

**我的代码 - 获取图片路径后**

```
 BitmapFactory.Options bmpFactoryOptions = new BitmapFactory.Options();
        bmpFactoryOptions.inSampleSize = 8;
        Bitmap bitmap = BitmapFactory.decodeFile("/sdcard/5.png",bmpFactoryOptions);
        lastClicked.setImageBitmap(bitmap);
        //lastClicked.setImageResource(R.drawable.green_circle); 
```

我想做的是从 sdcard 中读取调整大小的文件（使用 inSampleSize），然后用它填充 ImageView（或 ImageButton）。但是在使用 setImageBitmap 函数后，视图消失了——就像它刚刚加载了空图像（注释行正常工作——它只是绿点）。

也许有人已经解决了类似的问题？我将不胜感激任何帮助。

问候，斯卡纳

编辑：最后一次点击：

```
lastClicked = (ImageView)findViewById(R.id.add_photo_left); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T20:27:21.147

你为什么不试试`lastClicked.invalidate()`？

我至少在我的代码中这样做了，它是这样工作的；）

# java - 连接到 SQL Server 数据库

> ID：10607822
> 
> 赞同：2
> 
> 时间：2012-05-15T19:52:37.300
> 
> 标签：java, sql-server, jdbc

我正在尝试连接到 SQL Server 数据库，但我真的不知道如何使用我提供的信息进行操作。我得到了以下信息：

*   提供者
*   数据源
*   持久安全信息
*   用户身份
*   初始目录

我一直通过网址或其他方式连接，所以我真的不知道如何使用它。我正在尝试这样做是使用 JDBC 的 Java。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T19:54:49.077

请参阅此处的示例列表，具体取决于您使用的版本：

*   [SQL Server 2000](http://www.connectionstrings.com/sql-server)
*   [SQL 服务器 2005](http://www.connectionstrings.com/sql-server-2005)
*   [SQL Server 2008](http://www.connectionstrings.com/sql-server-2008)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-23T03:02:06.437

要从 Java 应用程序连接到 MSSQL Server，您需要使用 JDBC API。JDBC API 提供连接到数据库、加载适当的驱动程序、发送 SQL 查询、检索结果等的类和方法。

**如何连接到数据库：** “连接”对象表示与数据库的连接。要建立连接，请使用“DriverManager.getConnection”方法。此方法接受一个包含 URL 的字符串，该 URL 表示我们尝试连接的数据库。下面是建立连接的示例代码：

```
 private String DATABASE_URL = "jdbc:odbc:embedded_sql_app"; // establish connection to database
    Connection connection = DriverManager.getConnection( DATABASE_URL,"sa","123" ); 
```

关于数据库 URL 以及如何创建它的详细讨论可以在本文末尾提供的资源中找到。

**查询数据库：** JDBC API 提供了三个接口用于向数据库发送 SQL 语句，并且“连接”接口中的相应方法创建它们的实例。1\. 语句 - 由“Connection.createStatement”方法创建。'Statement' 对象用于发送不带参数的 SQL 语句。2\. PreparedStatement - 由“Connection.prepareStatement 方法”创建。'PreparedStatement' 对象用于预编译的 SQL 语句。它们可以将一个或多个参数作为输入参数（IN 参数）。3\. CallableStatement - 由“Connection.prepareCall”方法创建。'CallableStatement' 对象用于从 Java 数据库应用程序执行 SQL 存储过程。

**检索结果：** “ResultSet”是一个 Java 对象，包含执行 SQL 查询的结果。存储在“ResultSet”对象中的数据是通过一组允许访问当前行的各个列的 get 方法检索的。'ResultSet.next' 方法用于移动到 'ResultSet' 的下一行，使其成为当前行。以下代码片段执行返回行集合的查询，列“a”为“int”，列“b”为“String”，列“c”为“float”：

```
 java.sql.Statement stmt = con.createStatement();
   ResultSet rs = stmt.executeQuery("SELECT a, b, c FROM Table1");
   while (rs.next()) { // retrieve and print the values for the current row
         int i = rs.getInt("a");
         String s = rs.getString("b");
         float f = rs.getFloat("c");
         System.out.println("ROW = " + i + " " + s + " " + f);
   } 
```

这只是关于如何从 Java 与数据库进行交互的简要介绍。有关上述项目的更多详细信息以及有关传递参数、执行存储过程等的信息，请参阅以下资源：( [http://www.shahriarnk.com/Shahriar-NK-Research-Embedding-SQL-in -C-Sharp-Java.html#Shahriar_N_Embedding_SQL_in_Java](http://www.shahriarnk.com/Shahriar-N-K-Research-Embedding-SQL-in-C-Sharp-Java.html#Shahriar_N_Embedding_SQL_in_Java)）在这里，您还将找到有关如何以编程方式与数据库交互的信息；即不使用SQL。希望您觉得这个有帮助。

资料来源： [http ://www.shahriarnk.com/Shahriar-NK-Research-Embedding-SQL-in-C-Sharp-Java.html](http://www.shahriarnk.com/Shahriar-N-K-Research-Embedding-SQL-in-C-Sharp-Java.html)

# python - Django：如果将模型字段值放入任何数据结构中，如何获取/设置它？

> ID：10607824
> 
> 赞同：1
> 
> 时间：2012-05-15T19:52:43.027
> 
> 标签：python, django

我正在尝试做这样的事情：

```
class PollResults(models.Model):
    votes_0 = models.IntegerField( default=0 )
    votes_1 = models.IntegerField( default=0 )
    votes_2 = models.IntegerField( default=0 )
    votes_3 = models.IntegerField( default=0 )
    votes = [votes_0,votes_1,votes_2,votes_3]

    def add_vote(self,choice):
        self.votes[choice] = self.votes[choice]+1 
```

但是，当我调用 add_vote(0) 时，我得到：*"unsupported operand type(s) for +: 'IntegerField' and 'int'"*。

有什么办法让它工作吗？请不要批评数据库设计，这只是一个例子。关键是如何获取/设置字段值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T20:14:06.287

它不起作用的原因是因为您在`votes`变量中引用了字段对象本身。您的代码正在做同样的事情，`models.IntegerField(default=0) + 1`这当然是无效的。

最简单的解决方案是简单地获取/设置新属性并让 django 魔术处理字段 -> 值转换。

```
def add_vote(self,choice):
    attname = 'votes_{0}'.format(choice) # get the attribute name
    value = getattr(self, attname) # get the value
    setattr(self, attname, value+1) # set the value 
```

如果你想使用`votes`你的这个字段来确定索引/字段，你可以访问`Field.attname`找出你的字段的属性名称。

```
def add_vote(self,choice):
    attname = self.votes[choice].attname
    value = getattr(self, attname) # get the value
    setattr(self, attname, value+1) # set the value 
```

# objective-c - Objective-c 文件大小格式化程序

> ID：10607825
> 
> 赞同：5
> 
> 时间：2012-05-15T19:52:50.167
> 
> 标签：objective-c, file, formatting, size, string-formatting

在 Objective C 中是否有用于格式化文件大小的内置方法？或者您可以建议我一些库/源代码/等？

我的意思是你有一些文件大小应该根据给定的大小显示如下：

*   1234 KB
*   1,2 兆
*   ETC..

提前致谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-08-01T10:48:36.907

这个非常优雅地解决了这个问题：

```
[NSByteCountFormatter stringFromByteCount:countStyle:] 
```

示例用法：

```
long long fileSize = 14378165;
NSString *displayFileSize = [NSByteCountFormatter stringFromByteCount:fileSize
                                                           countStyle:NSByteCountFormatterCountStyleFile];
NSLog(@"Display file size: %@", displayFileSize);

fileSize = 50291;
displayFileSize = [NSByteCountFormatter stringFromByteCount:fileSize
                                                 countStyle:NSByteCountFormatterCountStyleFile];
NSLog(@"Display file size: %@", displayFileSize); 
```

日志输出：

> 显示文件大小：14.4 MB
> 显示文件大小：50 KB

输出将根据设备的区域设置正确格式化。

自 iOS 6.0 和 OS X 10.8 起可用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T23:04:29.797

这是我发现的一些代码。效率不是很高，并且可能比 NSNumber 更好地附加到 NSNumberFormatter 类别，等等，但它似乎有效

```
@interface NSNumber (FormatKibi)
- (NSString *)formatKibi;
@end

@implementation NSNumber (FormatKibi)
- (NSString *)formatKibi {
  double value = [self doubleValue];
  static const char suffixes[] = { 0, 'k', 'm', 'g', 't' }; 
  int suffix = 0;
  if (value <= 10000)
    return [[NSString stringWithFormat:@"%5f", value] 
         substringToIndex:5];
  while (value > 9999) {
    value /= 1024.0;
    ++suffix;
    if (suffix >= sizeof(suffixes)) return @"!!!!!";
  }
  return [[[NSString stringWithFormat:@"%4f", value] 
            substringToIndex:4]
           stringByAppendingFormat:@"%c", suffixes[suffix]];
}
@end 
```

我用这个测试了它：

```
int main(int argc, char *argv[]) {
  for (int i = 1; i != argc; ++i) {
    NSNumber *n = [NSNumber numberWithInteger:
                              [[NSString stringWithUTF8String:argv[i]]
                                integerValue]];
    printf("%s ", [[n formatKibi] UTF8String]);
  }
  printf("\n");
  return 0;
} 
```

然后：

```
$ ./sizeformat 1 12 123 1234 12345 123456 1234567 12345678 1234567890 123456789012 12345678901234 1234567890123456 123456789012345678
1.000 12.00 123.0 1234\. 12.0k 120.k 1205k 11.7m 1177m 114.g 11.2t 1122t !!!!! 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:59:19.367

获取文件大小，然后计算是字节还是kb还是mb

```
NSDictionary *fileAttributes = [[NSFileManager defaultManager] attributesOfItemAtPath:URL error:&attributesError];

NSNumber *fileSizeNumber = [fileAttributes objectForKey:NSFileSize];
long long fileSize = [fileSizeNumber longLongValue];

Then conversion table

    1 byte = 8 bits

    1 KiB = 1,024 bytes

    1 MiB = 1024  kb

    1 GiB = 1024  mb 
```

检查[这个链接](http://www.dzone.com/snippets/objective-c-and-cocoa-human)

# c# - 不可阻挡的计时器

> ID：10607831
> 
> 赞同：0
> 
> 时间：2012-05-15T19:53:22.807
> 
> 标签：c#

我正在尝试制作一个从 15 分钟到 0 秒的“简单”计时器。我用 900 秒作为我的 15 分钟。当我运行程序时，它运行良好，但继续进入负面状态。我还是 C# 的新手。我希望代码在 0 处停止并运行警报以引起某人的注意。这是我到目前为止所拥有的

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Timers;

namespace GBS_GI_Timer
{
   public class Program
    {
       public static int t = 2;

        public static void Main()
        {
            System.Timers.Timer aTimer = new System.Timers.Timer();

            // Hook up the Elapsed event for the timer.
            aTimer.Elapsed += new ElapsedEventHandler(OnTimedEvent);

            aTimer.Interval = 1000;
            aTimer.Enabled = true;

            //Console.WriteLine("Press the Enter key to exit the program.");
            Console.ReadLine();

            //GC.KeepAlive(aTimer);
            if (t == 0)
            aTimer.Stop();
        }
        public static void OnTimedEvent(object source, ElapsedEventArgs e)
        {
            //TimeSpan timeRemaining = TimeSpan.FromSeconds(t);

            Console.WriteLine("Time remianing..{0}", t);
            t--;

            if (t == 0)
            {
                Console.WriteLine("\a");
                Console.WriteLine("Time to check their vitals, again!");
                Console.WriteLine("Press any key to exit...");
            }
            // Console.ReadKey();
            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T19:56:53.503

您已对其进行了编码，以便当您按 Enter（或键入某些内容并按 Enter）时，它会检查 t 并可能会停止计时器。您正在检查 t == 0 是否然后才停止计时器。如果在您按 Enter 之前 t 小于零会发生什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T20:07:32.843

您必须按如下方式重构您的代码才能使其正常工作，System.Timers.Timer 使用 ThreadPool 来运行回调例程。

```
class Program
{
    public static int t = 2;
    static System.Timers.Timer aTimer = new System.Timers.Timer();

    public static void Main()
    {

        // Hook up the Elapsed event for the timer.
        aTimer.Elapsed += new ElapsedEventHandler(OnTimedEvent);

        aTimer.Interval = 1000;
        aTimer.Enabled = true;

        Console.ReadLine();
    }
    public static void OnTimedEvent(object source, ElapsedEventArgs e)
    {
        Console.WriteLine("Time remianing..{0}", t);
        t--;

        if (t == 0)
        {
            Console.WriteLine("\a");
            Console.WriteLine("Time to check their vitals, again!");
            Console.WriteLine("Press any key to exit...");
            aTimer.Stop();
            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T19:58:31.693

你的程序还有一些其他的逻辑问题，不过我不确定它是否会按照你的意愿运行，即使它正在运行。

我会重构你的 OnTimedEvent 来做

```
Console.WriteLine(string.Format("{0} time to check their vitals!")); 
```

并使用 while 循环检查主程序中 t 的状态。

您还可以在进入处理程序时更改 Timer.Interval 以便在确认第一个事件之前不会触发其他事件，但是您不能保证此例程运行 15 分钟...

# linux - 检测快速用户切换 Linux

> ID：10607832
> 
> 赞同：2
> 
> 时间：2012-05-15T19:53:23.197
> 
> 标签：linux, performance, x11

我目前正在尝试检测用户何时在 Linux 平台（特别是 Fedora 14-16、RedHat 4.7-6.x、CentOS 4-6、OpenSuse 10-11）上快速切换到另一个用户。我一直在寻找类似于 Windows 上可用的 WTSRegisterSessionNotification() 函数的东西，但我遇到的只是一堆对 Wine 软件中错误的引用。

有没有其他人遇到过这个障碍？关于如何在 Windows 和 Mac OS X 上执行此操作似乎有大量资源（这很好），但在 Linux 上似乎什么都没有……

编辑：显然，在较新的系统（至少 Fedora 16）上，[这](http://0pointer.de/public/systemd-man/systemd-loginctl.html)似乎是一个可行的选择。我想知道它是否有 DBus 接口...更多即将推出！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T12:32:33.470

首先，我需要告诉你我不是这方面的专家，但我有足够的知识给你指点，你可以去哪里学习更多。所以我在某些方面可能是错的。

我的猜测是：

*   这并不容易
*   对于您可能实施的大多数方法，可能有很多方法可以诱使他们相信不正确的东西，这可能会导致安全问题
*   您的方法可能取决于：
    *   选择的 Linux 发行版
    *   发行版
    *   桌面环境
    *   显示管理器

据我所知（如果在过去几年发生了一些变化，我可能会错），快速用户切换是通过在另一个 VT 上启动另一个 X 服务器来实现的。所以一种方法*是*检测是否有多个 X 服务器在运行。

但是在很多情况下，有多个 X 服务器在运行，这并不是因为快速的用户切换。示例：多席位甚至简单的 Xephyr 登录。使用 Xephyr 和 XDMCP，您甚至可以让同一用户在非快速用户切换情况下登录两次。

我开始搜索这个并找到了这个旧网页：

*   [http://fedoraproject.org/wiki/Desktop/FastUserSwitching](http://fedoraproject.org/wiki/Desktop/FastUserSwitching)

如果从那时起事情没有改变，您应该研究 ConsoleKit 和 PolicyKit（以及今天的 DeviceKit 和 Systemd）以及它们的 DBus API。

还有命令`ck-list-sessions`和`ck-launch-session`。但我相信你可以很容易地欺骗这些命令：try to`ck-launch-session xterm`然后`ck-list-session`.

您究竟为什么要检测快速用户切换？你的最终目标是什么？也许您可以在不尝试检测快速用户切换的情况下解决您的问题...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-17T19:45:40.257

看来获取这些信息最有用的方法是使用[ConsoleKit DBus 接口](http://www.freedesktop.org/software/ConsoleKit/doc/ConsoleKit.html#id310672)。

以下过程概述了如何枚举会话并确定它们是否处于活动状态：

1.) 使用以下方法枚举会话：

```
 Bus:    org.freedesktop.ConsoleKit
    Path:   /org/freedesktop/ConsoleKit/Manager
    Method: org.freedesktop.ConsoleKit.Manager.GetSessions 
```

返回的是一个导出 Session 接口的对象路径数组。反过来，可以使用 DBus 查询这些以获取其适当的属性。例如，我使用 dbus-send 与 ConsoleKit 通信以枚举我系统中的会话：

`dbus-send --system --print-reply --dest=org.freedesktop.ConsoleKit /org/freedesktop/ConsoleKit/Manager org.freedesktop.ConsoleKit.Manager.GetSessions`

我收到的回报如下：
`method return sender=:1.15 -> dest=:1.205 reply_serial=2 array [ object path "/org/freedesktop/ConsoleKit/Session2" ]`

2.）使用返回的对象路径，我可以查询它们的属性，例如它们是否处于活动状态，使用以下内容：

```
 Bus:    org.freedesktop.ConsoleKit
    Path:   /org/freedesktop/ConsoleKit/Session2
    Method: org.freedesktop.ConsoleKit.Session.IsActive 
```

根据方法，我可以从会话中查询我需要的内容！使用 ConsoleKit 界面，我还可以检索当前会话的标识符，因此我可以随时查询它以查看它是否在需要时处于活动状态。只是为了好玩，这是以下命令的输出：

`dbus-send --system --print-reply --dest=org.freedesktop.ConsoleKit /org/freedesktop/ConsoleKit/Session2 org.freedesktop.ConsoleKit.Session.IsActive`

> > 方法返回发件人=：1.15 -> dest=：1.206 reply_serial=2 boolean true

整洁的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T11:48:12.930

您必须通过轮询来确保在所有机器上工作（您显然不必运行 DBus 来进行用户切换！）。

Solaris、HP-UX 和其他系统不会在控制台上进行用户切换。

支持的平台：linux、FreeBSD、AIX。Linux/BSD 使用虚拟终端；`/dev/lft0`如果您有兴趣，可以使用 AIX 。

假设您想在控制台上可靠且安全地运行应用程序，并在控制台切换到另一个 VT 时在新的活动 X 服务器上重新启动它。问题是您可能有也可能没有运行桌面环境（我们中的一些人使用 twm！）。会话可能不是通过登录管理器启动的（您可以在 linux 上执行 Ctrl-Alt-F2，登录并`startx`愉快地运行）。系统甚至可能没有安装 xdm/gdm/similar。

愚蠢的解决方案是唯一可靠的解决方案：每隔几秒钟，查询活动的虚拟终端是什么（`VT_GETSTATE`在 linux 上，`VT_GETACTIVE`在 BSD 上）。如果它发生了变化，你就知道发生了变化。如果您切换到非图形会话（例如使用 Ctrl-Alt-F1），则不会有 X 服务器处于活动状态。

否则，您必须努力寻找哪个显示号码处于活动状态。例如，您可能会在 中看到两个 X 服务器`ps`，显示编号为 :1 和 :2。其中哪一个在VT7上？拼图的最后一块，将 VT 数字映射到显示数字，是最难的。这个问题在[这个重复的问题中得到了回答，“给定的 X 进程在哪个虚拟终端上运行？”](https://unix.stackexchange.com/questions/32884/which-virtual-terminal-is-a-given-x-process-running-on) .

# crystal-reports - 如何在水晶报表的交叉表中编辑/重命名列总计字段？

> ID：10607837
> 
> 赞同：1
> 
> 时间：2012-05-15T19:53:53.197
> 
> 标签：crystal-reports

我正在使用水晶报告 2008

在交叉表中我有：

```
AA 1
    BB 2
    抄送 0
    dd 1
**总计** 4

0
    年年 1
    0
    jj 1
**总计** 2
```

其中 A 和 B 是第 1 组数据，aa, bb, cc .... 是第 2 组数据。1,2... 是汇总值。总计是第 2 组以下的列总计。

我希望**Total**字段为**A Total**和**B Total** ...

任何人都可以帮我解决这个问题。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T13:18:49.680

我认为这样做的唯一方法是计算成员行。但这变得非常复杂，因为您需要隐藏总计，并且默认情况下计算的成员被列为总计，因此您需要为每个级别的组提供一个计算的成员。

[此链接](http://www.crystalkeen.com/articles/crystalreports/crosstabcalcmember.htm)提供了一些有用的信息。

# c# - 允许角色不起作用

> ID：10607839
> 
> 赞同：1
> 
> 时间：2012-05-15T19:53:55.687
> 
> 标签：c#, asp.net

我有一个带有 2 个文件夹的 Web 应用程序。包含各自页面的管理员和培训师。我在每个文件夹中有一个 web.config，如下所示。当我使用这些配置设置登录时，用户被拒绝访问他的主页，如果我删除拒绝用户，每个人都可以登录。我已经使用 WSAT 创建了角色并将用户添加到角色中。

***管理员的 Web.Config***

```
<?xml version="1.0"?>
<configuration>
<system.web>
    <authorization>
      <allow roles="Administrator" />
      <deny users="?"/>
    </authorization>
</system.web>
</configuration> 
```

***培训师的 Web.Config***

```
<?xml version="1.0"?>
<configuration>
<system.web>
    <authorization>
      <allow roles="Trainer" />
      <deny users="?"/>
    </authorization>
</system.web>
</configuration> 
```

**根文件夹 Web.Config 文件**

```
<?xml version="1.0"?>

<configuration>
<connectionStrings>
<add name="TSS" connectionString="Data Source = VC-SQL2008; Integrated
    Security=True;   database = aspnetdb" providerName="System.Data.SqlClient"/>
</connectionStrings>

<system.web>
<compilation debug="true" targetFramework="4.0"/>
<authentication mode="Forms">
  <forms loginUrl="Login.aspx" timeout="2880" />
</authentication>
</system.web>

<system.web>
<membership>
  <providers>
    <clear/>
    <add name="AspNetSqlMembershipProvider"
 type="System.Web.Security.SqlMembershipProvider" connectionStringName="TSS"
 requiresQuestionAndAnswer="false" requiresUniqueEmail="false"
 enablePasswordRetrieval="false" enablePasswordReset="false"
 maxInvalidPasswordAttempts="5" minRequiredPasswordLength="1"
 minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10"
 applicationName="/"/>

  </providers>
  </membership>

  <profile>
  <providers>
    <clear/>
    <add name="AspNetSqlProfileProvider"
  type="System.Web.Profile.SqlProfileProvider"
   connectionStringName="TSS" applicationName="/"/>
  </providers>
 </profile>

 <roleManager enabled="true">
  <providers>
    <clear />
    <add connectionStringName="TSS" applicationName="/" name="AspNetSqlRoleProvider"
   type="System.Web.Security.SqlRoleProvider" />
    <!--<add applicationName="/" name="AspNetWindowsTokenRoleProvider"
      type="System.Web.Security.WindowsTokenRoleProvider" />-->
  </providers>
</roleManager>

<pages controlRenderingCompatibilityVersion="3.5" clientIDMode="AutoID"/>
</system.web>

<system.webServer>
<modules runAllManagedModulesForAllRequests="true"/>
</system.webServer>
</configuration> 
```

***关于我如何添加角色的 web.sitemap 示例***

```
enter<siteMapNode url="Administrator/Admin_Home.aspx" title="Home"  description=""
roles="Administrator"> 
```

***Login.aspx.cs*** 命名空间 TSS { public partial class Login2 : System.Web.UI.Page { protected void Page_Load(object sender, EventArgs e) { dbConnection dbConn = new dbConnection(); }

```
 protected void submit_Click(object sender, EventArgs e)
  {
       // var a = Session["username"];
       string password = tb_password.Text;
       // Membership.CreateUser("s.g@visiblechanges.com", "9000");

       bool x = Membership.ValidateUser(tb_email.Text, password);
       string f_name;
       string l_name;
       string trainer="";
       DataTable dt = new DataTable();
       dt = TSS_WebService.getEmployeeByEmail(tb_email.Text);

       foreach (DataRow row in dt.Rows)
       {
            f_name = row["First_Name"].ToString();
            l_name = row["Last_Name"].ToString();
             trainer = row["First_Name"].ToString() + " " +   
           row["Last_Name"].ToString();
       }

   if (x == true)
  {

    Session["username"] = tb_email.Text;
    Session["trainer"] = trainer;

    if (Roles.IsUserInRole(tb_email.Text, "Administrator"))
    {
         Response.Redirect("~/Administrator/Admin_Home.aspx");
    }

  if (Roles.IsUserInRole(tb_email.Text, "Trainer"))
  {

   Response.Redirect("~/Trainer/Trainer_Home.aspx");
  }

   if (Roles.IsUserInRole(tb_email.Text, "Salon Manager"))
   {

    Response.Redirect("~/Salon/Salon_Home.aspx");
   }

   if (Roles.IsUserInRole(tb_email.Text, "IT"))
    {

     Response.Redirect("Home.aspx");
     }
   }

   else
   {
        FormsAuthentication.RedirectToLoginPage();
   }
  }

  }
  }

***Login.aspx***
    <%@ Page Title="" Language="C#" MasterPageFile="~/Master/Master.Master"     
    AutoEventWireup="true" CodeBehind="Login.aspx.cs" Inherits="TSS.Login2" %>
    <asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
    </asp:Content>
    <asp:Content ID="Content2" ContentPlaceHolderID="BreadCrumbs" runat="server">
    <asp:SiteMapPath ID="SiteMapPath1" runat="server">
    </asp:SiteMapPath>
    </asp:Content>
    <asp:Content ID="Content3" ContentPlaceHolderID="MainArea" runat="server">
    <div id = "loginBox">
    <h2> LOGIN</h2>
    <asp:TextBox ID="tb_email" runat="server" class = "ipBox_large"></asp:TextBox><br 
    />
    <asp:TextBox ID="tb_password" runat="server" class = "ipBox_large"></asp:TextBox>  
     <br />   
     <asp:ImageButton ID= "btn" ImageUrl = "../Images/btnLogin.gif" OnClick = 
     "submit_Click"  
     runat="server" />
     <asp:CheckBox id="NotPublicCheckBox" runat="server" /> 
     </div>
    </asp:Content> 
```

我已经坚持了 2 天了，并且已经研究了我可能做的一切。非常感谢任何帮助或建议。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T19:58:58.373

使用`<deny users="?"/>` 而不是`<deny users="*"/>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T22:20:08.737

尝试以下代码而不是您的`if(x==true){...}`部分 if (x == true) { if (Request.QueryString["ReturnUrl"] != null) { //重定向到返回 url FormsAuthentication.RedirectFromLoginPage(userName.Text, NotPublicCheckBox.Checked) ; }

```
 /* create authentication cookie */
    FormsAuthentication.SetAuthCookie(tb_email.Text, NotPublicCheckBox.Checked)
    Session["username"] = tb_email.Text;
    Session["trainer"] = trainer;

    /*redirect depending on roles*/
    if (Roles.IsUserInRole(tb_email.Text, "Administrator"))
    {
        Response.Redirect("~/Administrator/Admin_Home.aspx");
    }

    if (Roles.IsUserInRole(tb_email.Text, "Trainer"))
    {
        Response.Redirect("~/Trainer/Trainer_Home.aspx");
    }

    if (Roles.IsUserInRole(tb_email.Text, "Salon Manager"))
    {
        Response.Redirect("~/Salon/Salon_Home.aspx");
    }

    if (Roles.IsUserInRole(tb_email.Text, "IT"))
    {
        Response.Redirect("Home.aspx");
    }
}
else
{
    /*Login error*/
    FormsAuthentication.RedirectToLoginPage();
} 
```

希望它有效。祝你好运。

# jquery - 有哪些可用于网络/桌面（最好两者）应用程序的图表软件

> ID：10607840
> 
> 赞同：0
> 
> 时间：2012-05-15T19:53:59.843
> 
> 标签：jquery, html, charts, fusioncharts

我正在寻找各种图表/图形选项。

我的要求是

*   这是一个商业演示，因此需要非常酷。并拥有所有的花里胡哨，如动画等。
*   它需要支持大量图表/图形类型（折线、条形、饼图、极坐标等）
*   它应该是高度可配置的
*   它适用于更多的观众并放在投影仪上。因此，它应该具有控制标签、图例等大小的能力
*   我更喜欢使用基于 Jquery/Javascript/html5 的东西，因为这些是最新的技术，可以让平板电脑适应大屏幕。

我需要知道各种包的优缺点。

*   我看到了 FusionCharts（基于闪存）之类的东西，但有很多功能
*   jqplot（基于jquery）
*   一些基于silverlight的

需要了解哪一个最符合我的要求并具有所有功能。

只要符合上述要求，我对任何事情都持开放态度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-16T06:28:04.357

我不同意@Hrishikesh Choudhari 上面所说的。

FusionCharts Free 仅在 Flash 中呈现图表。付费版 XT 在 Flash 和 JS 中呈现图形。

请参阅此链接中的**注释部分：** [http ://www.fusioncharts.com/goodies/fusioncharts-free/](http://www.fusioncharts.com/goodies/fusioncharts-free/)

如果要在 JS 中默认呈现图表，则需要明确指定图表。与`Fusioncharts.setCurrentRenderer('javascript');`. 如果您不指定它，那么它将首先查找 flash 如果它不存在（iPad）然后它将在 JS 中呈现图表。在 Flash 和 JS 版本中，我应该说是微不足道的、外观上的变化。

如果您想要免费图表，也可以使用[Google Chart Tools 。](https://developers.google.com/chart/)一些 Silverlight 图表看起来也很有希望。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-14T14:43:02.670

[我们在http://www.datacopia.com](http://www.datacopia.com)使用[http://nvd3.org](http://nvd3.org)作为我们的自动图表生成工具。它有一个非常简单的 API，文档/示例代码相当完整。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T20:01:33.833

你可以看看[http://www.highcharts.com/demo/](http://www.highcharts.com/demo/)

它有一个很好的文档，有许多图表类型和许多可配置的选项。

它适用于网络，使用 javascript 构建。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T06:08:11.860

FusionCharts 不再基于 Flash。

他们已经加入 HTML5 / JavaScript 潮流有一段时间了。

查看他们的画廊 - [http://www.fusioncharts.com/demos/gallery/](http://www.fusioncharts.com/demos/gallery/) - 默认情况下，那里的示例以 JavaScript 呈现。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-01T17:00:26.153

我们在这里使用 ChartDirector。它适用于 ASP.Net、Java、ASP Classic 等。

除了他们似乎不想回答任何支持问题外，它在大多数情况下都非常酷。即使你已经为此付出了……就像我们一样。

我真的告诉​​你这个，因为我希望他们能以某种方式看到这一点并回答我该死的问题。

# algorithm - 存在环时的拓扑排序算法

> ID：10607841
> 
> 赞同：13
> 
> 时间：2012-05-15T19:54:02.187
> 
> 标签：haskell, algorithm, directed-graph, topological-sort

一些编程语言（如[haskell](/questions/tagged/haskell "显示标记为“haskell”的问题")）允许模块之间的循环依赖。由于编译器在编译一个模块时需要知道所有导入的模块的所有定义，如果某些模块相互导入或发生任何其他类型的循环，它通常需要做一些额外的工作。在这种情况下，编译器可能无法像在没有导入周期的模块中那样优化代码，因为导入的函数可能尚未被分析。通常只有一个循环的一个模块必须以这种方式编译，因为二进制对象没有依赖项。让我们称这样的模块为*循环断路器*

特别是如果导入周期是交错的，那么在编译由数百个模块组成的大型项目时，如何最大限度地减少循环断路器的数量是很有趣的。

是否有一种算法可以给定一组依赖项输出最少数量的模块，这些模块需要编译为循环断路器才能成功编译程序？

## 例子

我试图澄清我在这个例子中的意思。

考虑一个具有四个模块`A`、`B`和`C`的项目`D`。这是这些模块之间的依赖关系列表，条目`X y`表示*`y`依赖于`x`*：

```
交流电
广告
文学学士
CB
D B

```

相同的关系可视化为 ASCII 图：

```
D ---> B
^ / ^
| / |
| / |
| 大号 |
A ---> C

```

这个依赖图中有两个循环：`ADB`和`ACB`。为了打破这些循环，例如可以编译模块`C`并`D`作为循环断路器。显然，这不是最好的方法。编译`A`为循环中断器完全足以中断两个循环，您需要少编译一个模块作为循环中断器。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-05-15T20:18:06.753

这是被称为[最小反馈顶点集](http://en.wikipedia.org/wiki/Feedback_vertex_set)的 NP-hard（和 APX-hard）问题。[Demetrescu 和 Finocchi (pdf, Combinatorial Algorithms for Feedback Problems in Directed Graphs (2003)”)](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.1.9435&rep=rep1&type=pdf)的近似算法在没有长简单循环的情况下在实践中运行良好，正如我对您的应用程序所期望的那样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T19:59:13.397

以下是如何在 Python 中执行此操作：

```
from collections import defaultdict

def topological_sort(dependency_pairs):
    'Sort values subject to dependency constraints'
    num_heads = defaultdict(int)   # num arrows pointing in
    tails = defaultdict(list)      # list of arrows going out
    for h, t in dependency_pairs:
        num_heads[t] += 1
        tails[h].append(t)

    ordered = [h for h in tails if h not in num_heads]
    for h in ordered:
        for t in tails[h]:
            num_heads[t] -= 1
            if not num_heads[t]:
                ordered.append(t)
    cyclic = [n for n, heads in num_heads.iteritems() if heads]
    return ordered, cyclic

def is_toposorted(ordered, dependency_pairs):
    '''Return True if all dependencies have been honored.
       Raise KeyError for missing tasks.
    '''
    rank = {t: i for i, t in enumerate(ordered)}
    return all(rank[h] < rank[t] for h, t in dependency_pairs)

print topological_sort('aa'.split())
ordered, cyclic = topological_sort('ah bg cf ch di ed fb fg hd he ib'.split())
print ordered, cyclic
print is_toposorted(ordered, 'ah bg cf ch di ed fb fg hd he ib'.split())
print topological_sort('ah bg cf ch di ed fb fg hd he ib ba xx'.split()) 
```

运行时间与边（依赖对）的数量成线性比例。

该算法是围绕一个名为 num_heads 的查找表组织的，该表保持对前辈的数量（传入箭头）进行计数。在`ah bg cf ch di ed fb fg hd he ib`示例中，计数为：

```
node  number of incoming edges
----  ------------------------
 a       0
 b       2
 c       0
 d       2
 e       1
 f       1  
 g       2
 h       2
 i       1 
```

该算法通过“访问”没有前任的节点来工作。例如，节点`a`并且`c`没有传入边，因此首先访问它们。

访问意味着节点被输出并从图中移除。当一个节点被访问时，我们循环它的后继节点并将它们的传入计数减一。

例如，在访问节点`a`时，我们去它的后继节点`h`将其传入计数减一（这样`h 2`就变成了`h 1`.

同样，当访问节点时`c`，我们循环遍历它的后继者`f`和`h`，将它们的计数减一（这样`f 1`变成`f 0`和`h 1`变成`h 0`）。

节点不再有传入边，因此我们重复输出它们并从图中删除它们的过程，直到所有节点都被访问过`f`。`h`在示例中，访问顺序（拓扑排序为）：

```
a c f h e d i b g 
```

如果 num_heads 曾经到达没有节点且没有传入边的状态，则意味着存在无法进行拓扑排序的循环并且算法退出。

# c++ - 使用命名空间避免名称冲突

> ID：10607843
> 
> 赞同：3
> 
> 时间：2012-05-15T19:54:09.203
> 
> 标签：c++, namespaces

我正在编译我使用的一个项目，这次使用 VS2010，只是为了发现 windows.h 中的一个包含有一个 typedef INPUT，它与我已经拥有的代码中的导出 const 字符串发生冲突。

//winuser.h（行：5332）

```
typedef struct tagINPUT {
    DWORD   type;

    union
    {
        MOUSEINPUT      mi;
        KEYBDINPUT      ki;
        HARDWAREINPUT   hi;
    };
} INPUT, *PINPUT, FAR* LPINPUT; 
```

//foo.h

```
//stuff here
extern FOO_DLL_API const string INPUT; 
```

现在，我不在有问题的 .cpp 中使用 INPUT（并且我不拥有大部分代码），并试图将影响降到最低，我做了以下事情：

//我的文件.cpp

```
#include <foo.h>
namespace windowsLib {    //I added this
#  include <windows.h>
}

using namespace windowsLib; 
```

到目前为止，这种方法运行良好，但我想问您是否发现这种方法存在潜在问题，或者您是否有更好的建议。

**编辑：**

我感谢所有关于为什么这是一个坏主意的评论和解释。我从您的评论中得到的是我应该更改 foo.h 并将内容放入命名空间。但是，这样做会影响几十个文件，甚至更多，现在需要命名空间限定。

**有没有办法在不触及所有这些文件的情况下做到这一点“正确的方式”？**

如果我是代码的所有者，我会进行此更改并完成它，但我必须提出一个解决方案并获得批准并将其分配给某人等。因此，如果更改很小，它会更容易。

**编辑2：**

我的最终建议是将班级分成两部分，如下所示：

//存根.cpp

```
#include <windows.h>

//Implementation of wrapper methods 
```

//存根.h

```
class stub {
    //public wrapper methods
} 
```

//我的文件.cpp

```
#include <stub.h>
#include <foo.h> 
```

我接受 Benlitz 的回答，因为该建议还可以解决我目前面临的当前最小影响约束的问题。不过，我感谢大家的意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T20:02:34.173

不仅语言不允许这样做（假设标准头文件将包含在命名空间中），而且还存在调用在中声明的*任何*函数`<windows.h>`并发现链接器将在命名空间中查找它们的问题`windowsLib`。

就是不行！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-05-15T19:58:31.153

至少这似乎是个坏主意。

1）如果这实际上是您的代码，那么添加命名空间没有任何好处，因为您`using namespace windowsLib;`在下一行。不会`INPUT`有歧义吧？

2）您*可能*包含其他使用来自的东西`windows.h`并且不会使用正确符号的标题。想象一下，包含一个定义返回函数的头文件`INPUT`。这将如何解决？

我建议您谨慎行事，只需重命名您的类型。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T20:12:38.880

正如其他答案中所解释的那样，这是一个坏主意。这是一个可以帮助您解决问题的想法：

//我的文件.cpp

```
#define INPUT UnusedSymbol
#include "foo.h"
#undef INPUT

#include "windows.h" 
```

这可能有效，因为 INPUT 是 foo.h 中的外部变量，因此只要您不在 myfile.cpp 中使用它，编译器和链接器都不会关心它。UnusedSymbol 是一个虚拟名称，您可以编写源代码中未使用的任何名称。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-15T20:16:29.727

在 windows.h 周围放置一个命名空间对我来说听起来很危险。它可能会隐藏你需要的东西。除非您在下一行中导入命名空间。

我宁愿将命名空间放在 foo.h 周围：

```
namespace fooLib {
#include "foo.h"
}

using fooLib; 
```

我想这只是将问题从操作系统代码转移到 foo 代码，但这对我来说似乎更安全。

另一种方法可能是围绕 foo 构建一个包装器，该包装器调用 foo 函数并在单独的小包装器库中返回 foo 全局变量。一个不需要 windows.h 的。您可以将此包装器放入名称空间中以防止再次发生这种情况。

我在这里假设您**没有**能力在 foo.h 中重命名事物`foo.h`或将`fooLib`命名空间放在 foo.h 中的事物周围。

如果您**可以**触摸`foo.h`，最好在 foo.h 中重命名 INPUT 或将 foo.h 内容放在自己的名称空间中。我认为`fooLib`命名空间会有很大（明显）的好处。

# javascript - 内联 Javascript（在 HTML 中）如何工作？

> ID：10607847
> 
> 赞同：136
> 
> 时间：2012-05-15T19:54:40.373
> 
> 标签：javascript, html

我知道这是不好的做法。如果可能的话，不要写这样的代码。

当然，我们总是会发现自己处于一个巧妙的内联 Javascript 片段可以快速解决问题的情况。

我追求这个查询是为了充分理解写这样的东西时会发生什么（以及潜在的陷阱）：

```
<a href="#" onclick="alert('Hi')">Click Me</a> 
```

据我所知，这在功能上与

```
<script type="text/javascript">
   $(function(){ // I use jQuery in this example
       document.getElementById('click_me').onclick = 
           function () { alert('Hi'); };
   });
</script>
<a href="#" id="click_me">Click Me</a> 
```

由此推断，似乎分配给属性的字符串`onclick`被插入到一个匿名函数中，该函数被分配给元素的点击处理程序。真的是这样吗？

因为我开始做这样的事情：

```
<a href="#" onclick="$(this).next().fadeIn(); return false;">Display my next sibling</a> <!-- Return false in handler so as not to scroll to top of page! --> 
```

哪个有效。但我不知道这是多少黑客行为。它看起来很可疑，因为没有返回明显的函数！

你可能会问，你为什么要这样做，史蒂夫？内联 JS 是不好的做法！

老实说，我已经厌倦了仅仅为了修改页面的一个部分而编辑三个不同的代码部分，尤其是当我只是制作原型以查看它是否可以工作时。*在*元素中定义与此 HTML 元素特别相关的代码要容易得多，有时甚至是有意义的：当我在 2 分钟后决定这是一个可怕的、可怕的想法时，我可以核对整个 div（或其他) 并且我没有在页面的其余部分挂起一堆神秘的 JS 和 CSS 杂物，从而稍微减慢了渲染速度。这类似于引用局部性的概念，但我们关注的是错误和代码膨胀，而不是缓存未命中。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2012-05-15T20:04:01.133

您已经得到了几乎正确的结果，但是您还没有考虑`this`提供给内联代码的值。

```
<a href="#" onclick="alert(this)">Click Me</a> 
```

实际上更接近：

```
<a href="#" id="click_me">Click Me</a>
<script type="text/javascript">
document.getElementById('click_me').addEventListener("click", function(event) {
    (function(event) {
        alert(this);
    }).call(document.getElementById('click_me'), event);
});
</script> 
```

内联事件处理程序设置`this`为等于事件的目标。您还可以在内联脚本中使用匿名函数

```
<a href="#" onclick="(function(){alert(this);})()">Click Me</a> 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-15T19:59:55.987

当你有浏览器时，浏览器会做什么

```
<a onclick="alert('Hi');" ... > 
```

是将“onclick”的实际值设置为有效的值，例如：

```
new Function("event", "alert('Hi');"); 
```

也就是说，它创建了一个需要“事件”参数的函数。（嗯，IE 没有；它更像是一个简单的匿名函数。）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-02-15T01:11:41.467

事件处理程序属性似乎有很多*不好的做法。*不好的做法是不知道并在最合适的地方使用可用的功能。事件属性完全是 W3C 文档化的标准，它们没有什么不好的做法。这与放置内联样式没有什么不同，这也是 W3C 记录的并且有时会很有用。无论您是否将其包裹在脚本标签中，都会以相同的方式进行解释。

[https://www.w3.org/TR/html5/webappapis.html#event-handler-idl-attributes](https://www.w3.org/TR/html5/webappapis.html#event-handler-idl-attributes)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-05-15T20:19:44.397

回答您的问题的最佳方式是[亲眼目睹](http://jsfiddle.net/EZxnc/)。

```
<a id="test" onclick="alert('test')"> test </a> ​ 
```

在js中

```
var test = document.getElementById('test');
console.log( test.onclick ); 
```

正如您在 中看到的`console`，如果您使用的是 chrome，它会打印一个带有传入事件对象的匿名函数，尽管它在 IE 中有点不同。

```
function onclick(event) {
   alert('test')
} 
```

我同意你关于内联事件处理程序的一些观点。是的，它们很容易编写，但我不同意您关于必须在多个地方更改代码的观点，如果您的代码结构良好，则不需要这样做。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-15T19:57:41.247

> 它看起来很可疑，因为没有返回明显的函数！

它是一个匿名函数，已附加到对象的单击事件。

> 你为什么要这样做，史蒂夫？

你到底为什么要这样做.....啊，没关系，正如你所提到的，这确实是被广泛采用的不良做法:)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-05-15T20:23:49.507

在控制台中试试这个：

```
var div = document.createElement('div');

div.setAttribute('onclick', 'alert(event)');

div.onclick 
```

在 Chrome 中，它显示了这一点：

```
function onclick(event) {
  alert(event)
} 
```

...以及is的非标准`name`属性。`div.onclick``"onclick"`

因此，这是否匿名取决于您对“匿名”的定义。与类似的东西比较`var foo = new Function()`，其中`foo.name`是一个空字符串，并且`foo.toString()`会产生类似的东西

```
function anonymous() {

} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-02-11T11:00:54.253

使用**javascript：**

这里使用了输入元素

```
<input type="text" id="fname" onkeyup="javascript:console.log(window.event.key)"> 
```

**如果要使用多行代码，请在javascript**之后使用花括号：

 **```
<input type="text" id="fname" onkeyup="javascript:{ console.log(window.event.key); alert('hello'); }"> 
```**

# testing - 如何测试时间相关的方法？

> ID：10607848
> 
> 赞同：0
> 
> 时间：2012-05-15T19:54:40.437
> 
> 标签：testing, time

**测试时间相关方法的标准/推荐方法是什么？**

举个例子：

我有一个类`Foo`，它有一个方法`GetTimestamp()`，`GetTimestamp()`应该返回给定的时间`string`，总是按字典顺序增加（字母排序）。

在不为测试目的过度设计的情况下进行测试的最佳方法是什么？

我最初的想法是创建一个接受`IDateTimeProvider`其唯一属性是`DateTime`属性的类构造函数，然后从单元测试中我可以创建一个虚拟的 DateTimeProvider ...

这是一个简单的案例，但代表了我想知道的。

这还有很多其他的应用，例如测试闰年的日期相关逻辑等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-10T23:24:01.583

我喜欢做的是创建一个公共函数，该函数`Func<DateTime>`在需要当前日期/时间的类中返回一个 DateTime ()，并将其设置为`DateTime.Now`默认返回。然后，在测试期间，我注入了一个测试函数，它返回我想要测试的任何 DateTime。

```
public class MyClass
{
    public Func<DateTime> DateTimeNow = () => DateTime.Now;

    public void MyMethod()
    {
        var currentTime = DateTimeNow();
        //... do work
    }
}

public class MyClassTest
{
    public void TesttMyMethod()
    {
        // Arrange
        var myClass = new MyClass();
        myClass.DateTimeNow = () => new DateTime(1999, 12, 31, 23, 59, 59);

        // Act
        myClass.MyMethod();

        // Assert
        // my asserts
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:00:29.407

这是一个很好的资源：

[为什么 .NET 中没有 IDateTimeProvider 而 DateTime 有 Now getter？](https://stackoverflow.com/questions/3131702/why-there-is-no-idatetimeprovider-in-net-and-datetime-has-now-getter)

听起来这是一个不错的方法。

# php - 有没有一种简单的方法可以在开发时切换 PHP 版本？

> ID：10607849
> 
> 赞同：5
> 
> 时间：2012-05-15T19:54:48.783
> 
> 标签：php

我喜欢[rvm](https://rvm.io/)（ruby 版本管理器），它允许在命令行上快速切换 Ruby 版本，如下所示：

```
$ rvm use 1.9.3 
```

PHP有类似的工具吗？（最好在命令行上。）我目前正在开发一个 PHP 框架，所以我很快需要在不同的 PHP 版本上测试代码。

我正在使用 Ubuntu 11.10。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-05-15T19:57:21.013

您可以简单地在 PHP 上安装不同的版本，每个版本都在不同的目录中，然后使用您想要的那个。您甚至可以编写一个简单的脚本来自动执行此操作（它将从与参数对应的目录运行 PHP 可执行文件，和/或它可以更改 Apache 配置以使用指定的版本并重新加载 Apache）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T20:03:34.253

您可以在您的机器上以不同的路径安装多个版本的 php，并在您的脚本文件中添加您想要在开始时加载的版本

```
#!/usr/bin/php-4 
```

或者

```
#!/usr/bin/php-5 
```

等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T22:25:09.030

[phpenv](https://github.com/CHH/phpenv)基于[rbenv](https://github.com/sstephenson/rbenv)并提供在 PHP 版本之间切换的能力：

```
$ phpenv global 5.3.11 
```

结合[php-build](https://github.com/chh/php-build)，自动化构建自定义 PHP 环境要容易得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-10-27T11:52:11.083

如果要切换php7.1到php5.6

首先使用以下命令禁用当前版本 7.1

```
sudo a2dismod php7.1 
```

现在启用 php5.6

```
sudo a2enmod php5.6 
```

重新启动服务器，现在你准备好使用 php5.6

```
sudo service apache2 restart 
```

同样，您可以切换不同版本的 php。

# ruby - 如果我插入具有重复 _id 的对象，Mongoid 不会抱怨

> ID：10607851
> 
> 赞同：0
> 
> 时间：2012-05-15T19:54:50.227
> 
> 标签：ruby, mongodb, sinatra, mongoid

我有一个 Sinatra/Mongoid 应用程序，我注意到如果我尝试插入重复的对象，我的 mongoid 模型/对象不会抱怨或出错`_id`。`object.errors`集合也是空的。

“未插入对象/记录。”

在 Mongo 控制台上，我确实收到“重复键错误索引”错误。

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T21:08:51.363

默认情况下，Mongo 更新/插入有点“fire&forget”。但是，您可以打开[安全模式](http://mongoid.org/docs/persistence/safe_mode.html)，当这种事情发生时应该会引发错误

# mysql - 从表中为每种请求类型选择不同的 user_id

> ID：10607852
> 
> 赞同：1
> 
> 时间：2012-05-15T19:54:58.830
> 
> 标签：mysql, join, subquery

我有一个有 4 列的表：

`ID`, `USER_ID`, `SOURCE`,`CREATED_DATE`

该表中有以下数据：

```
ID  USER_ID SOURCE          CREATED_DATE
1   25      PURCHASE        2012-01-01 12:30:00
2   26      PLEDGE          2012-01-01 12:40:00
3   25      PLEDGE          2012-01-01 12:50:00
4   25      PURCHASE        2012-01-14 12:00:00 
```

现在如您所见，我有 4 行数据和两个唯一用户。用户 (25) 进行了 3 笔交易（两笔购买和一笔质押），用户 (26) 进行了一笔交易 - （一笔质押）

这是我想要实现的目标：

我需要从此表中选择所有事务，但我想为每个请求类型（源）选择一个唯一用户，并且该行需要是最早的事务。

我的预期结果数据将是：

```
ID  USER_ID SOURCE          CREATED_DATE
1   25      PURCHASE        2012-01-01 12:30:00
2   26      PLEDGE          2012-01-01 12:40:00
3   25      PLEDGE          2012-01-01 12:00:00 
```

用户 (25) 进行了两次购买（一次在 2012 年 1 月 1 日，一次在 2012 年 1 月 14 日）——第一次是被退回的。

这是我到目前为止提出的SQL：

```
 SELECT 
        Supporter.user_id,
        MIN(Supporter.created) as created,
        Supporter.*,
        Supporter.source
    FROM
        supporters AS Supporter

    GROUP BY Supporter.source
    ORDER BY Supporter.created ASC 
```

现在，这让我非常接近，除了它只选择一个用户 ID（一个有两个项目 - 承诺和购买）。如果我能弄清楚如何选择两个用户的数据，那将是我需要做的！谁能看到我在这里可能做错了什么，或者错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T20:00:58.143

您需要按来源和用户 ID 分组

像这样的东西

```
SELECT 
    Supporter.user_id,
    MIN(Supporter.created) as created,
    Supporter.*,
    Supporter.source
FROM
    supporters AS Supporter

GROUP BY Supporter.user_id, Supporter.source
ORDER BY Supporter.created ASC 
```

# ssl - Outlook 和 Gmail 阻止 SSL 通讯中的图像

> ID：10607853
> 
> 赞同：0
> 
> 时间：2012-05-15T19:55:02.680
> 
> 标签：ssl, outlook

我有一个时事通讯工具，可以显示时事通讯。好吧，该站点位于非 SSL 主机上，现在位于 SSL 主机上。当用户在 Gmail 或 Outlook 中收到时事通讯时，图像上有一个蓝色问号，并且图像不会显示。他们可以单击“在浏览器中查看”选项，一切正常。

这也是在 Outlook 和 Gmail 中打开图像显示选项的情况。

这就是我认为我看到问题的地方 - 该网站没有自己的 SSL 证书。它使用的是服务器，因此名称不匹配。

这就是图像没有出现在 Outlook/Gmail 中的原因吗？如果是这样，解决方案是获取与域名匹配的 SSL 证书吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:17:03.700

> 这就是我认为我看到问题的地方 - 该网站没有自己的 SSL 证书。它使用的是服务器，因此名称不匹配。

您使用的证书必须对您使用的主机名有效（请参阅 RFC 2818，第 3.1 节）。如果不是这种情况，则说明您的 HTTPS 服务器设置不正确，因此您不应该对客户端不喜欢它感到惊讶。

> 他们可以单击“在浏览器中查看”选项，一切正常。

据推测，这是因为您的用户愿意忽略他们不应该这样做的错误消息。

# git - git push to origin 错误 git-http-push 死于信号 11

> ID：10607860
> 
> 赞同：0
> 
> 时间：2012-05-15T19:55:28.863
> 
> 标签：git, version-control

我正在尝试将本地（主）更改推送到存储库（源），但我不断收到一个奇怪的错误，我不明白**"git-http-push dead of signal 11"**。这可能是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-09T19:35:17.537

如果您使用的是 gitweb，问题可能在于您访问存储库的方式。在 gitweb 中，repos 通常存储在 /repos 中。

如果您使用以下方法克隆：

```
git clone http://user@server/repos/myrepo.git 
```

克隆会成功，但是当你推送到这个 repo 时，你会得到错误*git-http-push dead of signal 11*

对我有用的解决方案是从 URL 中删除“repos”：

```
git clone http://user@server/myrepo.git 
```

删除 /repos 后，克隆和推送都正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T20:03:34.067

检查以确保您正在推送到一个存在的分支，并且在推送到 master 之前您已经下载了最新的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-22T20:43:42.860

我通过运行`uninstall.sh`然后降级到`git-1.7.5.4-x86_64-leopard.dmg`（我在 上遇到问题`git-1.7.10.1-intel-universal-snow-leopard.dmg`）解决了这个问题。

关于这个错误（以及许多沮丧的用户）几乎没有有用的实用建议，所以我的建议是切换到不会遇到这个问题的 git 的替代版本。

你能发布你正在使用的git版本吗？怀疑 git-http-push 在某些版本的 git 上失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-12T09:12:50.973

有同样的问题。我的修复：在我的 Git Repo Provider 设置中，有一个复选框说明

> Git 智能 HTTP

激活后工作。也许你可以在你的供应商设置中找到类似的东西。

# active-directory - LDAP错误代码32

> ID：10607865
> 
> 赞同：15
> 
> 时间：2012-05-15T19:55:56.503
> 
> 标签：active-directory, ldap, synchronization, openldap

我正在尝试将 OpenLDAP 和 Active Directory 同步在一起。为此，我使用了一个名为 LSC-Project 的程序，它被指定用于执行此类操作。

我已经尽可能地配置了程序，但是我找不到摆脱以下错误的方法：

```
javax.naming.NameNotFoundException: [LDAP: error code 32 - 0000208D: NameErr: DSID-
031001CD,
problem 2001 (NO_OBJECT), data 0, best match of:
'DC=domname,DC=com'
]; remaining name 
'uid=user1,ou=Users'

May 09 15:19:25 - ERROR - Error while synchronizing ID uid=user1,ou=Users:
java.lang.Exception:
Technical problem while applying modifications to directory
dn: uid=user1,ou=Users,dc=domname,dc=com
changetype: add
userPassword: 3+kU2th/WMo/v553A24a3SBw2kU=
objectClass: uid 
```

这是程序运行的配置文件：

```
############################### 
Destination LDAP directory #
##############################

dst.java.naming.provider.url = ldap://192.168.1.3:389/dc=Windows,dc=com  
dst.java.naming.security.authentication = simple
dst.java.naming.security.principal = cn=Administrator,cn=Users,dc=Windows,dc=com
dst.java.naming.security.credentials = 11111
dst.java.naming.referral = ignore
dst.java.naming.ldap.derefAliases = never
dst.java.naming.factory.initial = com.sun.jndi.ldap.LdapCtxFactory
dst.java.naming.ldap.version = 3
dst.java.naming.ldap.pageSize = 1000

#########################
Source LDAP directory 
#########################

src.java.naming.provider.url = ldap://192.168.1.2:389/dc=Linux,dc=com
src.java.naming.security.authentication = simple
src.java.naming.security.principal = uid=root,ou=users,dc=Linux,dc=com
src.java.naming.security.credentials = 11111
src.java.naming.referral = ignore
src.java.naming.ldap.derefAliases = never
src.java.naming.factory.initial = com.sun.jndi.ldap.LdapCtxFactory
src.java.naming.ldap.version = 3

#######################
Tasks configuration 
#######################

lsc.tasks = Administrator
lsc.tasks.Administrator.srcService = org.lsc.jndi.SimpleJndiSrcService
lsc.tasks.Administrator.srcService.baseDn = ou=users
lsc.tasks.Administrator.srcService.filterAll = (&(objectClass=person))
lsc.tasks.Administrator.srcService.pivotAttrs = uid 
lsc.tasks.Administrator.srcService.filterId = (&(objectClass=person)(uid={uid}))
lsc.tasks.Administrator.srcService.attrs = description uid userPassword

lsc.tasks.Administrator.dstService = org.lsc.jndi.SimpleJndiDstService
lsc.tasks.Administrator.dstService.baseDn = cn=Users
lsc.tasks.Administrator.dstService.filterAll = (&(cn=*)(objectClass=organizationalPerson))
lsc.tasks.Administrator.dstService.pivotAttrs = cn, top, person, user, organizationalPerson
lsc.tasks.Administrator.dstService.filterId = (&(objectClass=user) (sAMAccountName={cn}))
lsc.tasks.Administrator.dstService.attrs = description cn userPassword objectClass

lsc.tasks.Administrator.bean = org.lsc.beans.SimpleBean
lsc.tasks.Administrator.dn = "uid=" + srcBean.getAttributeValueById("uid") + ",ou=Users"

dn.real_root = dc=Domname,dc=com

############################# 
Syncoptions configuration 
#############################

lsc.syncoptions.Administrator = org.lsc.beans.syncoptions.PropertiesBasedSyncOptions
lsc.syncoptions.Administrator.default.action = M
lsc.syncoptions.Administrator.objectClass.action = M
lsc.syncoptions.Administrator.objectClass.force_value = srcBean.getAttributeValueById("cn").toUpperCase()
lsc.syncoptions.Administrator.userPassword.default_value = SecurityUtils.hash(SecurityUtils.HASH_SHA1, "defaultPassword")
lsc.syncoptions.Administrator.default.delimiter=;
lsc.syncoptions.Administrator.objectClass.force_value = "top";"user";"person";"organizationalPerson"
lsc.syncoptions.Administrator.userPrincipalName.force_value = srcBean.getAttributeValueById("uid") + "@Domname.com"
lsc.syncoptions.Administrator.userAccountControl.create_value = AD.userAccountControlSet ( "0", [AD.UAC_SET_NORMAL_ACCOUNT]) 
```

我怀疑它与源配置部分中的 Task 配置的 baseDn 有关。

操作系统是 ubuntu 10.04 和 Windows2K3

有人建议我在它们之间进行手动同步，但我还没有找到任何这样做的指南。而这个程序几乎是唯一可以说是在没有成本的情况下完成这种工作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-03-25T17:54:17.110

主要原因`NameNotFoundException`是您正在搜索的对象**不存在**或您正在搜索的容器**不****正确**。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-05-15T20:07:40.440

应该是搜索的基础对象的`baseDn`可分辨名称，例如，`ou=users,dc=domname,dc=com`。

### 也可以看看

*   [LDAP：掌握搜索过滤器](http://ff1959.wordpress.com/2011/09/21/mastering-ldap-search-filters/)
*   [LDAP：搜索最佳实践](http://www.ldapguru.info/ldap/ldap-search-best-practices.html)
*   [LDAP：编程实践](http://ff1959.wordpress.com/2011/10/27/ldap-programming-best-practices/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-01-29T08:15:13.110

在 Spring-ldap 的情况下，当我们在上下文文件（LdapContextSource bean）中指定 baseDn 以及在 createUser 代码中构建 userDn 时，我们会收到此错误。我们不需要在`buildUserDn()`

```
protected Name buildUserDn(String userName) {
   DistinguishedName dn = new DistinguishedName();

   //only cn is required as the base dn is already specified in context file

   dn.add("cn", userName); 

   return dn;
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2018-01-25T09:43:05.627

在 Active Directory 中：`Users`目录是`container`类，而不是 OrganizationalUnit，因此您应该使用：`cn=users,dc=domname,dc=com`

# php - $object->($string)

> ID：10607868
> 
> 赞同：0
> 
> 时间：2012-05-15T19:56:11.713
> 
> 标签：php

我正在处理一个我没有编写且无法更改的类的对象。这个类具有非常多的属性。我想循环浏览这些属性中的一半（一个选择组）。我将必要属性的名称放入一个数组中，并希望循环浏览它们。这可能吗？语法是什么样的？

```
class B{
   public $foo = 'hi';
   public $bar = 'bye';
   ...etc, etc.
}

$arr = array(1=>'foo', 2=>'bar', ...)
$b = new B();
foreach($arr as $val){
  echo $b->($val); //<-----does not work
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T19:58:27.453

是的你可以。参见手册： http: [//php.net/manual/en/language.variables.variable.php](http://php.net/manual/en/language.variables.variable.php)

```
<?php
class foo {
    var $bar = 'I am bar.';
}

$foo = new foo();
$bar = 'bar';
$baz = array('foo', 'bar', 'baz', 'quux');
echo $foo->$bar . "\n";
echo $foo->$baz[1] . "\n";
?> 
```

> 上面的示例将输出：

```
I am bar.
I am bar 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T19:59:31.040

```
echo $b->$val; 
```

或方法

```
echo $b->$val(params...); 
```

你可以使用[反射函数](http://php.net/manual/en/book.reflection.php)之一来获取所有的方法和成员

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T20:01:23.147

你很接近：

```
$b->$val; //Or...
$b->{$val}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T20:00:56.937

您可以像这样遍历每个变量：

```
$b= new B();

foreach($b as $var => $value) {
    echo "$var is $value\n";
} 
```

# ios - segue 如何创建目标 ViewController？

> ID：10607872
> 
> 赞同：1
> 
> 时间：2012-05-15T19:56:35.287
> 
> 标签：ios, cocoa-touch, uiviewcontroller, uinavigationcontroller, segue

正如问题所暗示的那样：segue 如何创建目标控制器？具体来说，调用哪个方法？当 segue 创建他时，我想从 nib 初始化另一个 ViewController。我该如何做到这一点？

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T21:19:40.363

简短的回答：`initWithCoder:`被调用。

更长的答案（[来自苹果的文档`UIViewController`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)）：

> 如果您的应用程序使用情节提要来定义视图控制器及其关联视图，则您的应用程序永远不会直接初始化该类的对象。相反，视图控制器要么由故事板实例化——要么在触发 segue 时由 iOS 自动实例化，要么在您的应用程序调用故事板对象的 instantiateViewControllerWithIdentifier: 方法时以编程方式实例化。当从故事板实例化视图控制器时，iOS 通过调用它的 initWithCoder: 方法来初始化新的视图控制器。iOS 自动将 nibName 属性设置为存储在故事板中的 nib 文件。

# sql-server - SQL 查询数据连接具有它忽略的空值

> ID：10607874
> 
> 赞同：-1
> 
> 时间：2012-05-15T19:56:47.720
> 
> 标签：sql-server, tsql, select-into

我在 SQL Server 中有一个表，其中包含一个分类帐代码列，该`ledgercode`列通过`keyfield`. 目前，该列显示`keyfield`值而不是我使用此查询创建新表的代码编号：

```
SELECT [OC_Key]
  ,[OC_PO_PO_DPNo]
  ,[OC_DateofInv]
  ,[V_VendorNo]
  ,[OC_ExpDescrip]
  ,[LedgerCode]
  ,[OC_InvoiceNo]
  ,[OC_DatePosted]
  ,[OC_TotAmount]
  ,[OC_Type]
  ,[OC_Initials]
INTO dbo.OCommittedTbl
FROM [CommittedTbl] CT, [codeLedgerTbl] LT, [VendorTbl] VT
WHERE VT.V_VenKey = CT.OC_VendorName and LT.LedgerKey = CT.OC_LedgerCode 
```

我的问题是表中的某些行的列具有空值，`ledgercode`因此这个新表仅将 484 行中的 34 行拉入表中。

如何绕过空值，以便它们仍会被拉入我的表中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-05-15T20:00:02.153

使用 LEFT JOIN 而不是（隐式）INNER JOIN。

```
SELECT ...
INTO dbo.OCommittedTbl
FROM [CommittedTbl] CT
LEFT JOIN [codeLedgerTbl] LT ON LT.LedgerKey = CT.OC_LedgerCode 
LEFT JOIN [VendorTbl] VT ON VT.V_VenKey = CT.OC_VendorName 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T20:04:48.213

首先，您需要学习 JOIN 语法。其次，您的问题的答案是左外连接：

```
SELECT [OC_Key], [OC_PO_PO_DPNo], [OC_DateofInv], [V_VendorNo], [OC_ExpDescrip],
       [LedgerCode], [OC_InvoiceNo], [OC_DatePosted], [OC_TotAmount], [OC_Type], [OC_Initials]
INTO dbo.OCommittedTbl
FROM [CommittedTbl] CT left outer join
     [codeLedgerTbl] LT
     on LT.LedgerKey = CT.OC_LedgerCode left outer join
     [VendorTbl] VT
      on VT.V_VenKey = CT.OC_VendorName 
```

第三，我非常喜欢同名的主键和外键。因此，如果您构建了原始表，那么您可能会使用一致的命名约定。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T20:04:12.177

INNER JOIN 排除空条目，尝试使用左连接

```
SELECT [OC_Key]
  ,[OC_PO_PO_DPNo]
  ,[OC_DateofInv]
  ,[V_VendorNo]
  ,[OC_ExpDescrip]
  ,[LedgerCode]
  ,[OC_InvoiceNo]
  ,[OC_DatePosted]
  ,[OC_TotAmount]
  ,[OC_Type]
  ,[OC_Initials]
INTO dbo.OCommittedTbl
FROM [CommittedTbl] CT
LEFT JOIN [codeLedgerTbl] LT ON LT.LedgerKey = CT.OC_LedgerCode 
LEFT JOIN [VendorTbl] VT ON VT.V_VenKey = CT.OC_VendorName
WHERE VT.V_VenKey = CT.OC_VendorName and LT.LedgerKey = CT.OC_LedgerCode 
```

# macos - 来自 stat.h 的 UF_TRACKED 文件标志

> ID：10607877
> 
> 赞同：2
> 
> 时间：2012-05-15T19:57:05.363
> 
> 标签：macos, unix, filesystems, osx-lion, hfs

`stat.h`在osx 10.7的标题中，我在 fileflag 中找到了一个定义`UF_TRACKED`。我用谷歌搜索了这个定义，但没有找到关于标志的任何信息。你能向我描述一下这面旗帜的含义吗？当我尝试将属性应用于放置在已安装文件夹上的文件时，我遇到了它。该文件夹是远程 osx 10.7.3 上的 HFS+ 文件夹。

也许我可以忽略它？在这种情况下会发生什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-25T14:10:26.210

UF_TRACKED 是一个标志，它告诉HFS 在用户模式下对文件dentry 的任何更改（即重命名或删除，以及元数据的更改，但不是文件修改）发送事件到跟踪文件处理程序。您可以在头文件中看到这两个：

```
#define UF_TRACKED      0x00000040  /* file renames and deletes are tracked */ 
```

处理此问题的代码位于内核 bsd/hfs/hfs_vfsutils.c 中：

```
int
check_for_tracked_file(struct vnode *vp, time_t ctime, uint64_t op_type, void *arg)
{
        int tracked_error = 0, snapshot_error = 0;

        if (vp == NULL) {
                return 0;
        }

        if (VTOC(vp)->c_bsdflags & UF_TRACKED) {
 ... 
```

并且被到处调用，主要来自 hfs_vnops.c

# intellij-idea - JRebel 的配置不起作用

> ID：10607879
> 
> 赞同：1
> 
> 时间：2012-05-15T19:57:13.330
> 
> 标签：intellij-idea, glassfish-3, jrebel

我在 IntelliJ 中有一个复杂的 maven 项目，我不想在其中使用 JRebel 来加快开发时间。该项目是这样组成的：

**ERP-HM** **modulo-nfe**
            assinador-nfe importador
            -nfe
            compositor-nfe
            marshaller-nfe **persistencia**
            persistencia-banco
            persistencia-venda
            persistencia-cadastro
            persistencia-nfe
            persistencia-erp
            persistencia-pagamento-recebimento
            persistencia-estoque
            persistencia-utilidades modulos **-web**
            banco- web
            configuracao-web
            seguranca-web
            cadastro-web
            erp-web **
            pagamento-recebimento-web
            components-web
            estoque-web
            venda-web
      utilidades
      gerador-relatorios

粗体的名称只是 pom 项目，法线是有代码的项目......项目 erp-web 是**战争**项目。我以这种方式在 ERP-HM 项目中配置了 JRebel 插件：

```
<plugin>
    <groupId>org.zeroturnaround</groupId>
    <artifactId>jrebel-maven-plugin</artifactId>
    <version>1.1.3</version>
    <configuration>
       <packaging>war</packaging>
       <web>
           <resources>
               <resource>
               </resource>
           </resources>
       </web>
    </configuration>
    <executions>
        <execution>
             <id>generate-rebel-xml</id>
             <phase>process-resources</phase>
             <goals>
                 <goal>generate</goal>
             </goals>
        </execution>
     </executions>
</plugin> 
```

在 IntelliJ 中，我已经像 JRebel 向导一样配置了项目：

![IntelliJ JRebel 配置](../Images/24b7ce8609cc725d0863c6157dc13f5d.png)

**已编辑：添加了 jrebel 日志**

```
-------- HEADER --------
VERSION 2
JVM_ID 43ce9d1ce623bd1d7995a6d2c715000b
JVM_STARTED 1337341646006
LOG_STARTED 1337341646178
-------- EOF HEADER --------
[2012-05-18 08:47:26.187] Rebel properties loaded from /home/hudson/.IntelliJIdea11/config/plugins/jr-ide-idea/lib/jrebel/conf/jrebel.properties:
rebel.env.ide=intellij11
rebel.env.ide_server_start=true
rebel.env.java_version=java16
rebel.env.maven=true
rebel.env.operating_system=unix
rebel.env.server=glassfish
rebel.jasper_plugin=false
rebel.jboss_plugin=false
rebel.log=true
rebel.properties.version=2
rebel.stats.time=146
rebel.weblogic_plugin=false
rebel.websphere_plugin=false

[2012-05-18 08:47:26.196] Found a license file: /home/hudson/.jrebel/jrebel.lic
[2012-05-18 08:47:26.271] License information: {uid=ffc12cd3-d035-4576-871d-0e92fd9c38e5, Name=Hudson Assumpção, limited=true, GeneratedOn=Tue May 15 14:36:55 BRT 2012, Email=brevleq@gmail.com, Seats=1, Product=JRebel, limitedFrom=Sun May 13 14:36:55 BRT 2012, override=false, Organization=Gep, limitedUntil=Thu Jun 14 14:36:55 BRT 2012}
[2012-05-18 08:47:26.282] Now: Fri May 18 08:47:26 BRT 2012 Sun May 13 14:36:55 BRT 2012 Thu Jun 14 14:36:55 BRT 2012
[2012-05-18 08:47:26.282]  JRebel 4.6.2 (201205021440)
[2012-05-18 08:47:26.283]  (c) Copyright ZeroTurnaround OU, Estonia, Tartu.
[2012-05-18 08:47:26.283] 
[2012-05-18 08:47:26.290]  Over the last 1 days JRebel prevented 
[2012-05-18 08:47:26.290]  at least 0 redeploys/restarts saving you about 0 hours.
[2012-05-18 08:47:26.290] 
[2012-05-18 08:47:26.291]  This product is licensed to Hudson Assumpção (Gep) 
[2012-05-18 08:47:26.298]  until June 14, 2012
[2012-05-18 08:47:26.298] 
[2012-05-18 08:47:26.299] *************************************************************
[2012-05-18 08:47:26.299]          Your license is about to EXPIRE!
[2012-05-18 08:47:26.300] *************************************************************
[2012-05-18 08:47:26.300] 
[2012-05-18 08:47:26.301]  This license will expire in 27 days and JRebel will
[2012-05-18 08:47:26.301]  stop working after that. Renew your license at:

[2012-05-18 08:47:26.301]     http://sales.zeroturnaround.com/?1339695415
[2012-05-18 08:47:26.302] JRebel is running with the following internal licensing configuration:
[2012-05-18 08:47:26.302]     License valid? true
[2012-05-18 08:47:26.302]     License flags: [none]
[2012-05-18 08:47:26.303]     License type: LIMITED 
```

不幸的是，当我更改代码并刷新浏览器时，JRebel 无法正常工作，没有任何反应......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-25T17:41:24.640

我删除了 maven 插件并将这个 rebel.xml 添加到我的 Web 应用程序的资源文件夹中：

```
<classpath>
    <dir name="/home/hudson/projetos/ERP-HM/modulos-web/erp-web/target/erp-web-0.1.0/WEB-INF/classes/">
        <include name="com/hrgi/**"/>
    </dir>
    <jarset dir="/home/hudson/projetos/ERP-HM/modulos-web/erp-web/target/erp-web-0.1.0/WEB-INF/lib">
        <include name="gerador-relatorios*.jar"/>
        <include name="assinador-nfe*.jar"/>
        <include name="compositor-nfe*.jar"/>
        <include name="importador-nfe*.jar"/>
        <include name="marshaller-nfe*.jar"/>
        <include name="banco-web*.jar"/>
        <include name="cadastro-web*.jar"/>
        <include name="componentes-web*.jar"/>
        <include name="configuracao-web*.jar"/>
        <include name="estoque-web*.jar"/>
        <include name="pagamento-recebimento-web*.jar"/>
        <include name="seguranca-web*.jar"/>
        <include name="venda-web*.jar"/>
        <include name="persistencia-banco*.jar"/>
        <include name="persistencia-cadastro*.jar"/>
        <include name="persistencia-erp*.jar"/>
        <include name="persistencia-estoque*.jar"/>
        <include name="persistencia-nfe*.jar"/>
        <include name="persistencia-pagamento-recebimento*.jar"/>
        <include name="persistencia-utilidades*.jar"/>
        <include name="persistencia-venda*.jar"/>
        <include name="utilidades*.jar"/>
    </jarset>
</classpath>

<web>
    <link target="/">
        <dir name="/home/hudson/projetos/ERP-HM/modulos-web/erp-web/target/erp-web-0.1.0"/>
    </link>
</web> 
```

这里包含的 jars 是完整的 maven 项目的一部分。现在 JRebel 工作正常...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-18T01:04:44.063

您是从“使用 JRebel 运行”按钮还是从普通的“运行”按钮设置它？

您必须启用日志记录 - 将日志发送给支持人员并告诉您尝试更改哪个类

# actionscript-3 - 在 Flash / Flex 中从 Floder 读取文件

> ID：10607889
> 
> 赞同：0
> 
> 时间：2012-05-15T19:57:56.287
> 
> 标签：actionscript-3, flash, apache-flex

我想制作一个图像滑块和 mp3 播放器，它不会从 XML 中获取文件，而是直接形成文件夹并可能将它们放入一个数组中。

搜索了一段时间后，我找不到这个问题的具体答案。

这样的事情在 Flash 中可以实现吗？如何？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T20:11:31.940

如果您想构建桌面应用程序，答案是肯定的。然后，您可以通过 air 运行时访问文件夹。这很容易：

```
var directory:File = File.documentsDirectory; 
var contents:Array = directory.getDirectoryListing();  
for (var i:uint = 0; i < contents.length; i++)  
{ 
     trace(contents[i].name, contents[i].size);  
} 
```

如果你想创建一个 Web 应用程序。那就不要。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-05-15T20:11:43.967

据我所知，Flash 不具备读取目录的能力——Adobe AIR 可能能够做到这一点，或者您可以使用服务器端语言来帮助您 [1]。我不确定Flex，我没用过。

[1] [http://actionscript.org/forums/showthread.php3?t=88941&highlight=files+directory](http://actionscript.org/forums/showthread.php3?t=88941&highlight=files+directory)

# javascript - window.open(window.parent) 可能吗？

> ID：10607892
> 
> 赞同：0
> 
> 时间：2012-05-15T19:58:06.393
> 
> 标签：javascript, window.open, window.parent

我有一个按钮，当用户单击该按钮时，会触发此代码...

```
window.open('','','width=640,height=480,resizeable,scrollbars'); 
```

这会打开一个新窗口。我想要显示的是该新窗口中的当前页面，所以我尝试了..

```
window.open('window.parent.getElementById("printPage")','','width=640,height=480,resizeable,scrollbars'); 
```

但它只是说找不到文件:(

谁能告诉我我做错了什么，如果这是可能的，我该如何解决？

谢谢，J

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T20:02:25.527

`window.location`应该给你当前的窗口位置，所以：

```
window.open(window.location); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T20:05:35.417

[`window.open()`](https://developer.mozilla.org/en/DOM/window.open)需要一个 URI 作为第一个参数。将其留空（在您的第一个示例中）似乎默认为`about:blank`，但您的第二个示例中的字符串`'window.parent.getElementById("printPage")'`，实际上不是有效的 url。

如果要当前窗口的url，[`window.location`](https://developer.mozilla.org/en/DOM/window.location)可以使用：

```
 window.open(window.location,'','width=640,height=480,resizeable,scrollbars'); 
```

您似乎试图从父框架中获取某些元素的 href 或 src 属性。您需要对其进行编码，不会评估一串代码。使用类似的东西

```
 var url = window.parent.getElementById("printPage").src; // I'm guessing that
  // "printpage" is a (i)frame
 window.open(url, '','width=640,height=480,resizeable,scrollbars'); 
```

反而。

# ms-access - MS ACCESS 通过查询检索“表描述”

> ID：10607896
> 
> 赞同：5
> 
> 时间：2012-05-15T19:58:26.487
> 
> 标签：ms-access, vba

我一直在到处寻找一种通过 SELECT 查询访问表描述的方法（与右键单击表>表属性时出现的描述相同）。

我尝试使用 MSysObjects 但我只能使用它检索表的名称。

是否可以通过查询来做到这一点，还是需要 VBA？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T22:49:22.797

正如 Remou 所说，您无法从查询中获取它（但您可以包含一个在查询中返回它的函数）。这是另一个功能：

```
Public Function GetTableDescr(stTableName As String) As String
On Error Resume Next
GetTableDescr = CurrentDb.TableDefs(stTableName).Properties("Description").Value
End Function 
```

这是一个返回所有非系统表及其日期和描述的查询（使用上面的函数）：

```
SELECT MSysObjects.Name, msysobjects.datecreate, msysobjects.dateupdate, GetTableDescr([Name]) AS Description
FROM MSysObjects
WHERE (((MSysObjects.Name) Not Like "~*") AND((MSysObjects.Name) Not Like "MSys*") and ((MSysObjects.Type)=1)); 
```

最后，您可以为查询执行几乎相同的功能。我发现的技巧是你只返回非继承的描述，否则如果查询没有描述，你会得到查询对象的描述：

```
Public Function GetQueryDescr(stQryName As String) As String
On Error Resume Next
If CurrentDb.QueryDefs(stQryName).Properties("Description").Inherited = False Then
    GetQueryDescr = CurrentDb.QueryDefs(stQryName).Properties("Description").Value
End If
End Function 
```

On`Error Resume Next`是必需的，因为在对象具有描述之前，该属性为空。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T20:42:02.487

您可以从表架构或 TableDef 属性中获取描述，但我认为标准查询不会起作用。

```
Set rs = CurrentProject.Connection.OpenSchema(adSchemaTables, _
     Array(Empty, Empty, "Rules", Empty))
Debug.Print rs!Description 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-23T02:44:40.143

使用上面的 GetQueryDescr()，您可以对隐藏的 sys 表运行此查询

SELECT MSysObjects.Name, GetQueryDescr([Name]) AS Properties, MSysObjects.DateCreate, MSysObjects.DateUpdate FROM MSysObjects WHERE (((MSysObjects.Name) Not Like "~sq_*") AND ((MSysObjects.Type)=5)) ;

类型 5 用于查询

# ios - 在 UiWebView 中播放远程 MOV

> ID：10607901
> 
> 赞同：0
> 
> 时间：2012-05-15T19:58:35.500
> 
> 标签：ios, video, uiwebview, quicktime

我有一个相当复杂的应用程序，主要在 UiWebView 中工作。我想从 URL 全屏自动播放 MOV 文件。我的问题是，当我链接到 MOV 文件时，播放图标被划掉或视频加载但不播放。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-16T15:51:14.727

您是否将视频嵌入到 html 中？你的 html 是什么样的？

如果您使用的是 html5，请注意不允许自动播放。

我建议首先使用您知道的格式/编解码器类型是否正确的视频来让事情正常工作，然后在工作时切换您的视频。您可以从 Apple 网站下载一组受支持的参考视频。或者使用它来确保您的视频格式正确：

[http://www.mirovideoconverter.com/](http://www.mirovideoconverter.com/)

您可能还想阅读以下内容：

[http://developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Introduction/Introduction.html](http://developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Introduction/Introduction.html)

# tridion - 关键字自定义元数据中的组件链接

> ID：10607903
> 
> 赞同：9
> 
> 时间：2012-05-15T19:58:48.733
> 
> 标签：tridion

我们有一个元数据模式，其中包含 3 个字段 - 2 个文本字段（标题和摘要），一个组件链接字段。它被我们的关键字和发布给经纪人的分类法所使用。

但是，当我们为关键字分配值并发布时，在代理的 [CUSTOM_META] 表中，我们只看到两个文本字段条目的 2 行，而组件链接字段则看不到任何内容。我希望看到组件链接的第三行显示 TCM ID 或代表链接到的组件的内容。

实际上，当您查看 [CUSTOM_META] 的数据库表设计时，它似乎只支持 KEY_DATE_VALUE、KEY_STRING_VALUE 和 KEY_FLOAT_VALUE。

**这是否意味着组件链接字段中的值无法发布到代理？**

我们将使用此 TCM 生成指向已发布页面的链接，因此我想我们可以将字段类型更改为文本，并要求编辑输入 url 或使用 Bart 的[项目选择器](http://www.sdltridionworld.com/community/2011_extensions/itemselector.aspx)来选择页面本身。

这是在 Tridion 2011 SP1 环境中。- 默认情况下配置为发布到代理的所有内容（除了二进制文件和一些特定的页面类型）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-05-15T20:40:13.907

此问题已在 2011 SP1 中通过修补程序 CD_2011.1.0.79212 修复，可从以下网址下载： [https](https://www.sdltridionworld.com/Login.aspx?ReturnUrl=/downloads/hotfixes/SDL_Tridion_2011_SP1/index.aspx) ://www.sdltridionworld.com/Login.aspx?ReturnUrl=/downloads/hotfixes/SDL_Tridion_2011_SP1/index.aspx （需要登录）

# c - 在 C 中使用信号量和共享内存的读写器

> ID：10607904
> 
> 赞同：2
> 
> 时间：2012-05-15T19:58:51.300
> 
> 标签：c, posix, semaphore, readerwriterlock

我正在尝试使用名为信号量的 POSIX 制作一个简单的读取器/写入器程序，它可以工作，但在某些系统上，它会在第一个信号量时立即停止，仅此而已......我现在真的很绝望。有人可以帮忙吗？它在我的系统上运行良好，所以我无法通过 ltrace 跟踪问题。（抱歉评论，我来自捷克共和国）

[https://www.dropbox.com/s/hfcp44u2r0jd7fy/readerWriter.c](https://www.dropbox.com/s/hfcp44u2r0jd7fy/readerWriter.c)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T21:44:44.570

POSIX 信号量不太适合应用程序代码，因为它们是可中断的。基本上，对您的流程进行任何类型的 IO 都会弄乱您的信号。请看一下[这篇文章](https://gustedt.wordpress.com/2010/07/07/how-to-make-sem_t-interrupt-safe/)。

因此，您必须非常小心地`sem_`正确解释函数返回的所有错误。在您发布的代码中没有这样的事情。

如果您的 POSIX 实现支持它们，只需使用 rwlocks，它们就是为此而设计的，级别更高，不会遇到那种困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-10T06:18:52.083

在计算机科学中，读​​写器问题是并发中常见计算问题的示例。这些问题至少有三种变体，它们处理许多线程试图同时访问同一个共享内存的情况。一些线程可能读取，一些线程可能写入，其约束条件是没有进程可以访问共享以进行读取或写入，而另一个进程正在对其进行写入。（特别是，允许​​两个或多个读者同时访问共享。） 读写器锁是一种数据结构，用于解决一个或多个读写器问题。

# javascript - 将主干模型属性值设置为另一个模型

> ID：10607905
> 
> 赞同：1
> 
> 时间：2012-05-15T19:58:52.847
> 
> 标签：javascript, backbone.js

我可以设置另一个主干模型作为它的属性吗？

我有一个代表基本实体的模型，我想将它作为其他东西的一部分重用。但是，Backbone 的模型属性值似乎只能是字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T20:21:21.040

排序答案：**是的，您可以**：

```
myHouse.set({ door: new Door() }) 
```

但是，在我看来，这样做并不是一个好主意，因为我不认为 Backbone 期望`Objects`在`Model.attributes`. 我没有尝试，但如果*属性*中的某个人是对象，我认为像这样的方法`Model.toJSON`不会有正确的行为。

 *但是这么说，我认为在模型中声明引用对象的*真实属性*没有任何问题，例如：

```
myHouse.door = new Door(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:16:39.833

如果我理解正确，您需要执行以下操作：

```
var ModelOne = Backbone.Model.extend({
    method : function() {
        console.log('ModelOne > method');
    },
    sayHello : function() {
        console.log('ModelOne > hello');
    }
});

var ModelTwo = ModelOne.extend({
    method : function() {
        ModelOne.prototype.method.apply(this);
        console.log('ModelTwo > method');
    }
});

var methodTwo = new ModelTwo();
methodTwo.method();
methodTwo.sayHello(); 
```

输出：

```
ModelOne > method
ModelTwo > method
ModelOne > hello 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-12T11:47:15.477

设置另一个模型的属性的另一种变体`Backbone.Model`是将其设置为默认值：

```
var UserModel = Backbone.Model.extend({
    defaults: {
        id: null,
        name: null,
        address: new AddressModel()
    }
});

var someUser = new UserModel();
    someUser.address.set('country', 'ZA'); 
```

当你在做`someUser.save()`数据时，`someUser.attributes.address`将是一个*通常的数据对象*。

* * *

`!`**我**尚未测试的一件事`AddressModel`是人口`someUser.fetch()`*

# ruby-on-rails - 存在 api_key 时 skip_before_filter

> ID：10607906
> 
> 赞同：6
> 
> 时间：2012-05-15T19:58:55.803
> 
> 标签：ruby-on-rails, ruby-on-rails-3, api, csrf

我正在尝试为我的 rails 应用程序构建一个 api。

当非获取请求中存在有效的 api_key 时，我想在过滤之前跳过 csrf。

我已经尝试过（一旦我可以让条件过滤器工作，我将验证 api_key）

```
(skip_before_filter :verify_authenticity_token) if params[:api_key].present? 
```

但这不起作用...

有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T20:19:34.140

我认为这行不通，因为如果在创建控制器类期间评估表达式，那么`params[:api_key].present?`在那一刻是错误的......你可以试试

`skip_before_filter :verify_authenticity_token, :if =>lambda{ params[:api_key].present?}`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T03:30:26.910

导轨 3.2.13 -

上述解决方案都没有奏效（也许我做错了什么？）但这确实：

```
skip_before_filter :verify_authenticity_token, :if => :check_auth
def check_auth
  request.headers["authentication_token"] == ENV['AUTH_KEY']
end 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-20T23:25:38.960

没有办法让 skip_before_filter 有条件。您不能在 skip_before_filter 上使用“if”。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-05-15T20:29:40.277

尝试这个

```
skip_before_filter :verify_authenticity_token, :except => [], if params[:api_key].present? 
```

# c# - 选择数据网格事件

> ID：10607909
> 
> 赞同：0
> 
> 时间：2012-05-15T19:59:13.337
> 
> 标签：c#, wpf, datagrid

所以我有一个 WPF 应用程序和一个数据网格，不可编辑，启用了全行选择，我试图用数据网格行创建一种开关功能。但是，我似乎无法为简单的行选择找到合适的事件。如果我再次单击已选择的项目，则有`SelectionChanged`, 这不起作用。很简单`Click`（有很多类型），但是所有这些都发生在实际选择行之前，所以如果我尝试在单击时获取选定的项目，我将得到空值。还有一些其他事件（我忘记了）需要单击两次，这并不是我真正想要的。我的想法已经不多了，也许有一些好的事件组合或某种方式来覆盖它们，或者我只是错过了一些东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-16T07:30:03.927

考虑到您提供的信息，@Yatrix 的解决方案是完全有效的！

但是你已经回应了..

> 在选择行之前发生，因此不起作用：/

然后，您在这里缺少一些东西。即使 LeftMouseDown \ LeftMouseUp \ PreviewLeftMouseDown \ Up 事件发生在选择事件之前，它们也会知道该行是否已被选中。这样他们就可以取消选择它然后做

```
e.Handled=true 
```

.... 以便在鼠标事件之后永远不会调用选择，从而避免重新选择。

试着让我知道。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:08:23.143

`PreviewMouseDown`或者`PreviewMouseLeftButtonDown`可能会有所帮助。我还在这个网站上找到了这个可以为你提供方向的东西：

[当 SelectionMode="Extended" 时，如何让 DataGrid 在单击时取消选择？](https://stackoverflow.com/questions/6465178/how-can-i-get-a-datagrid-to-unselect-on-click-when-selectionmode-extended)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T20:42:30.537

如果您想注册行 Selected 事件，您需要为 DataGrid 中的每一行注册。尝试注册 DataGrid 上的[LoadingRow](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.loadingrow%28v=vs.100%29.aspx)事件，并为每一行注册[Selected](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagridrow.selected)事件。

# jquery - 在 aspx 与 html 中的 Jquery

> ID：10607912
> 
> 赞同：0
> 
> 时间：2012-05-15T19:59:26.860
> 
> 标签：jquery, asp.net, checkboxlist

我在没有使用母版页的情况下在 aspx 页面中运行以下 Jquery。带有脚本的标记如下。它工作得很好。

```
<body>
<form id="form1" runat="server">
<div>

    <asp:CheckBox ID="chkAll" runat="server" Text="Check All" /><br />

    <asp:CheckBoxList ID="cbList" runat="server">
    </asp:CheckBoxList>

</div>
</form> 
```

这是脚本

```
<script src="Scripts/jquery-1.7.2.js" type="text/javascript"></script>

<script type="text/javascript">
    $(document).ready(function () {
        $('#chkAll').click(
         function () {
             $("INPUT[type='checkbox']").attr('checked', $('#chkAll').is(':checked'));
         });
    });    

 </script> 
```

这是我使用母版页创建的页面的标记。母版页仅在 HeadContent 占位符的标头中具有对 jquery 文件的引用。不用说它在母版页场景中不起作用。为什么是问题

```
 <asp:Content ID="Content1" ContentPlaceHolderID="HeadContent" Runat="Server">
   The identical script from above is placed here

</asp:Content> 
```

这是占位符内容标记

```
<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" Runat="Server">

<div>

    <asp:CheckBox ID="chkAll" runat="server" Text="Check All" /><br />

    <asp:CheckBoxList ID="cbList" runat="server">
    </asp:CheckBoxList>

</div>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:05:26.813

`ID`当 Webform 控件具有它们时，您不能使用它们提供的值`runat="server"`。ID 将更改为类似`ctl1_chkAll`的内容，您的脚本将失败。您需要使用以下内容引用他们的客户 ID：

```
$("#<%= chkAll.ClientID %>") 
```

...这就是人们远离网络表单的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:06:54.450

这是因为，当我们使用母版页时，页面上呈现的控件 ID 是不同的。您应该执行以下操作以确保代码在这两种情况下都有效。

```
$("[id$='chkAll']").click() { function () {
    $("INPUT[type='checkbox']").attr("checked", $(this).attr("checked"));
}); 
```

希望这可以帮助！！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T20:10:14.743

这听起来像是您的 jQuery 脚本的相对路径的问题，您应该使用您的网络调试器（FireBug、IE 工具栏等）来查看您的脚本是否正在加载。如果您的 Scripts 文件夹位于站点的根目录中，请将脚本 src 设置为“/Scripts/jquery-1.7.2.js”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-15T20:13:40.177

在您的控件上使用`ClientIDMode="Static"`应该允许您通过分配的名称来引用它。

```
<asp:CheckBox ID="chkAll" runat="server" Text="Check All" ClientIDMode="Static" /> 
```

# javascript - Jquery 脚本在 IE 7-8 中不起作用

> ID：10607917
> 
> 赞同：0
> 
> 时间：2012-05-15T19:59:32.413
> 
> 标签：javascript, jquery, internet-explorer, internet-explorer-8, internet-explorer-7

在 IE 7-8 中不工作脚本。第 3 个字符串出错。我找不到错误。来自俄语：“对象不支持此属性或方法”。

包含在html中：

```
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery.red-first.js"></script> 
```

jquery.red-first.js：

```
(function($) {
    $.fn.redFirst = function() {
        var city = $(this).text().trim();
        var newCity;
        if (city == 'г. Москва') { city = 'Москва'; }
        if (city == 'г. Санкт-Петербург') { city = 'Санкт-Петербург'; }
        var cityWords = city.split(' ');
        if (cityWords.length == 1) {
            newCity = '<span class="red">' + city[0] + '</span>';
            newCity = newCity + city.slice(1);;
        } else {
            newCity = '<span class="red">' + cityWords[0] + '</span>';
            delete cityWords[0];
            newCity = newCity + cityWords.join(' ');
        }
        $(this).html(newCity);
        return this;
    };
})(jQuery);

$(document).ready(function(){
    $('#city').redFirst();
    $('#choose_reg_city').redFirst();
    $('#authorization #region').redFirst();
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T20:02:57.007

`string.trim()`不是 IE 自带的功能。其他浏览器定义它，但 IE 没有。由于您使用的是 jQuery，因此已经使用它：

```
var city = $.trim($(this).text()); 
```

# ajax - ie9中的DropShadowExtender

> ID：10607918
> 
> 赞同：0
> 
> 时间：2012-05-15T19:59:32.613
> 
> 标签：ajax

我有一个非常奇怪的问题，我不知道从哪里开始解决它。我已经在 8 台使用 IE9 的计算机上尝试了我的网站，其中 2 台的页面显示不正确。我发现当我取出 dropshadowextender 时，它看起来还不错。所以我所做的是首先尝试清除所有 cookie 等。然后进入高级设置以比较那些有效的和那些无效的，但那没有用。我在所有计算机上使用 FireFox 在所有计算机上尝试了该站点，它们运行良好。我的问题是什么可能导致这 2 台计算机无法正确显示。当我在所有计算机上运行该站点时，我可以查看它是否显示错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:24:28.660

[CSS3 Pie](http://css3pie.com/)是一个 .htc 文件，当放置在您的服务器上时，它为 IE 提供了额外的代码，因此它可以在 IE9、8 和 7 上正确呈现许多 CSS3 样式。

效果很好。值得一试。

# java - 用 SimpleAdapterCursor swapCursor() 交换光标

> ID：10607919
> 
> 赞同：1
> 
> 时间：2012-05-15T19:59:34.810
> 
> 标签：java, android, android-loadermanager, android-loader

我在我的应用程序中设置了一个内容提供程序并使用 LoaderManager 加载数据，但是我在将光标交换到光标适配器时遇到了麻烦，我测试了光标是否正在返回数据并且它正在返回！追踪问题，似乎`ad.swapCursor(cursor);`是问题所在。

你认为我在这里做错了什么？它可能是内容提供者吗？

```
public class Main extends ListActivity implements LoaderManager.LoaderCallbacks<Cursor> {

public SimpleCursorAdapter ad;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    getLoaderManager().initLoader(0, null, Main.this) != null);
            ad = new SimpleCursorAdapter(this, android.R.id.list, null, null, null, 0); 
}

public Loader<Cursor> onCreateLoader(int id, Bundle args) {
    // TODO Auto-generated method stub
    Toast.makeText(this, "Started!", Toast.LENGTH_SHORT).show();
    CursorLoader cursorLoader = new CursorLoader(getBaseContext(),
            AviatorContentProvider.LISTS_URI, null, null, null, null);
    if(cursorLoader != null){
        Toast.makeText(this, "This thing is heavy!", Toast.LENGTH_SHORT).show();
    }

    return cursorLoader;

}

public void onLoadFinished(Loader<Cursor> cursorLoader, Cursor cursor) {
    // TODO Auto-generated method stub
    ad.swapCursor(cursor);

}

public void onLoaderReset(Loader<Cursor> arg0) {
    // TODO Auto-generated method stub

}} 
```

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T20:01:27.910

您永远不会初始化您的`SimpleCursorAdapter`“广告”。尝试调用`swapCursor`适配器时，您可能会遇到空指针异常。

在 中初始化您的适配器`onCreate`并传入一个空游标（因为尚未加载任何数据）。

```
String[] from = new String[] { COLUMN_NAME_FROM_YOUR_CURSOR };
int[] to = new int[] { android.R.id.text1 }; 
ad = new SimpleCursorAdapter(this, android.R.layout.simple_list_item_1, null, from, to,0); 
```

请注意我在哪里有 "COLUMN_NAME_FROM_YOUR_CURSOR" 。您需要将其中一列的字符串值放入其中（来自常量或硬编码值）

确保检查 logcat 以查看您收到的错误。它将准确地告诉您错误是什么以及导致错误的代码行。

# python - appengine-mapreduce 对操作有限制吗？

> ID：10607922
> 
> 赞同：2
> 
> 时间：2012-05-15T19:59:37.847
> 
> 标签：python, xml, google-app-engine, mapreduce, blobstore

我正在开展一个项目，该项目需要根据文本中的单词共现来构建一个庞大的知识库。正如我所研究的，在 appengine 中还没有尝试过类似的方法。我想利用 appengine 的灵活性和可扩展性，以便能够为知识库提供服务并对其进行推理以供广大用户使用。

到目前为止，我已经提出了一个基于管道演示应用程序的 mapreduce 实现。源文本作为包含一个 xml 文档的压缩文件存储在 blobstore 中，每个文档包含可变数量的文章（多达 30000 篇）。

第一步是调整当前的`BlobstoreZipLineInputReader`，以便解析 xml 文件，从中检索相关信息。XMLParser 类使用 lxml iterparse 方法从[http://www.ibm.com/developerworks/xml/library/x-hiperfparse/](http://www.ibm.com/developerworks/xml/library/x-hiperfparse/)检索要处理的 xml 元素，并返回一个迭代器。

修改后的类`BlobstoreXMLZipLineInputReader`有一个稍微不同的`next`功能：

```
def next(self):
  if not self._filestream:
    if not self._zip:
      self._zip = zipfile.ZipFile(self._reader(self._blob_key))
      self._entries = self._zip.infolist()[self._start_file_index:
                                           self._end_file_index]
      self._entries.reverse()
    if not self._entries:
      raise StopIteration()
    entry = self._entries.pop()

    parser = XMLParser()
    # the result here is an iterator with the individual articles
    self._filestream = parser.parseXML(self._zip.open(entry.filename))

  try:
      article = self._filestream.next()
      self._article_index += 1    
  except StopIteration:
      article = None

  if not article:
    self._filestream.close()
    self._filestream = None
    self._start_file_index += 1
    self._initial_offset = 0
    return self.next()

  return ((self._blob_key, self._start_file_index, self._article_index),
          article) 
```

然后 map 函数将接收这些文章中的每一篇，按句子拆分，然后按单词拆分：

```
def map_function(data):
  """Word count map function."""
  (entry, article) = data
  for s in split_into_sentences(article.body):
    for w in split_into_words(s.lower()):
      if w not in STOPWORDS:
        yield (w, article.id) 
```

reducer 聚合单词，并加入它们出现的文章的 id：

```
def reduce_function(key, values):
  """Word count reduce function."""
  yield "%s: %s\n" % (key, list(set(values))) 
```

这在开发服务器和多达 10000 条文本的实时设置上都非常有效（上面没有那么多字）。一般不超过10秒。问题是当它有点过时，mapreduce 似乎会一直挂起处理作业。每个分片处理的项目数量只会增加，我的写入操作限制很快就会达到。

**Q1。mapreduce 管道在开始“表现不佳”之前可以执行多少个映射操作是否存在某种限制？
Q2。会有更好的方法来解决我的问题吗？
Q3。我知道以前有人问过这个问题，但是我可以绕过临时 mapreduce 数据存储写入吗？他们在杀我...**

PS：这是我的主要 mapreduce 调用：

```
class XMLArticlePipeline(base_handler.PipelineBase):
  def run(self, filekey, blobkey):
    output = yield mapreduce_pipeline.MapreducePipeline(
        "process_xml",
        "backend.build_knowledgebase.map_function",
        "backend.build_knowledgebase.reduce_function",
        "backend.build_knowledgebase.BlobstoreXMLZipLineInputReader",
        "mapreduce.output_writers.BlobstoreOutputWriter",
        mapper_params={
            "blob_keys": [blobkey],
        },
        reducer_params={
            "mime_type": "text/plain",
        },
        shards=12)
    yield StoreOutput(filekey, output) 
```

编辑：运行无休止的工作时，我在开发服务器中遇到一些奇怪的错误：

```
[App Instance] [0] [dev_appserver_multiprocess.py:821] INFO Exception in HandleRequestThread
Traceback (most recent call last):
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/tools/dev_appserver_multiprocess.py", line 819, in run
    HandleRequestDirectly(request, client_address)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/tools/dev_appserver_multiprocess.py", line 957, in HandleRequestDirectly
    HttpServer(), request, client_address)
  File "/usr/local/Cellar/python/2.7.2/lib/python2.7/SocketServer.py", line 310, in process_request
    self.finish_request(request, client_address)
  File "/usr/local/Cellar/python/2.7.2/lib/python2.7/SocketServer.py", line 323, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/google/appengine/tools/dev_appserver.py", line 2579, in __init__
    BaseHTTPServer.BaseHTTPRequestHandler.__init__(self, *args, **kwargs)
  File "/usr/local/Cellar/python/2.7.2/lib/python2.7/SocketServer.py", line 641, in __init__
    self.finish()
  File "/usr/local/Cellar/python/2.7.2/lib/python2.7/SocketServer.py", line 694, in finish
    self.wfile.flush()
  File "/usr/local/Cellar/python/2.7.2/lib/python2.7/socket.py", line 303, in flush
    self._sock.sendall(view[write_offset:write_offset+buffer_size])
error: [Errno 32] Broken pipe 
```

# mysql - Django-Mysql 数据迁移

> ID：10607923
> 
> 赞同：0
> 
> 时间：2012-05-15T19:59:39.483
> 
> 标签：mysql, django, migration

我想知道最简单的方法：

我有一个名为 Student 的模型，数据库中有许多 Student 具有许多属性，例如：

**名称类型**

id int(11)

名称 varchar(200)

性别 varchar(1)

状态 int(11)

创建日期时间

我想要做的是将模型重命名为 Costumer 并使“状态”字段成为 Charfield (varchar) 而不是整数。而且我必须保持数据库中的数据完好无损。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T20:04:36.603

[向南的世界敞开](http://south.aeracode.org/)你的自我。South 是 Django 项目的智能模式和数据迁移。

安装后，将“south”放入 django 设置 installed_apps 列表中，您希望运行 2 个命令。

1.  python manage.py schemamigration [my_app_name] --initial 第一次运行时使用#initial
2.  在第 1 步之后，您的 app 文件夹中将有一个名为“migrations”的文件夹，现在您必须通过执行 python manage.py migrate [my_app_name] 来应用迁移

应用迁移后，您可以通过运行 python manage.py migrate [my_app_name] --list 检查迁移状态。已应用带有 * 的迁移。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:08:50.723

> 创建表客户（id int（11），
> 
> 名称 varchar(200),
> 
> 性别 varchar(1),
> 
> status varchar(20) created datetime );
> 
> 插入到客户中选择 id、name、sex、cast（status as char），由学生创建；

然后当然编辑你的 django 以匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T21:48:10.940

如果没有其他模型引用学生，那么您可以这样做：

1.  首先备份您的数据库，确保您可以从中恢复（到另一个不同的数据库）

2.  更新 django 模型的 python 代码

3.  让 django 创建新表（为您重命名的模型）：

    ```
    python manage.py syncdb 
    ```

4.  将旧表中的数据复制到新表中：

    ```
    echo 'insert into costumer select id, name, sex, cast(status as char), created from student;' | python manage.py dbshell 
    ```

但是，如果您有其他模型使用外键或多对多关系引用旧表，那么上述方法将不起作用，因为这些其他模型可能在其数据库模式中引用了旧表。如果这是你的情况，那么你可以试试这个：

1.  将所有模型转储到 json

    ```
    python manage.py dumpdata --indent 4 > everything.json 
    ```

2.  更新你的 Django 模型

3.  让 Django 创建新表（为您重命名的模型）：

    ```
    python manage.py syncdb 
    ```

4.  手动编辑 json 文件，将模式替换`"model": "yourapp.student"`为`"model": "yourapp.costumer"`. 您可能需要进行其他替换，具体取决于您的模型和它们之间的关系。

5.  重新加载json

    ```
    python manage.py loaddata 
    ```

对于未来，请参阅@mangobug 的答案并开始使用`django-south`.

# git - 在 *same* 服务器上运行 svnserve *and* git-shell？

> ID：10607924
> 
> 赞同：0
> 
> 时间：2012-05-15T19:59:45.227
> 
> 标签：git, svn, permissions

我有一个我负责管理的存储库服务器（主要用于学术目的），并且各种团体都想使用 git 和其他 svn。有些人需要访问这两个存储库。我不希望给个人用户 shell 访问权限，但我找不到任何方法让 git-shell 与 svn（或 svnserve 与 git）一起玩得很好。有没有办法做到这一点？也许某种方式要求 git-shell 通过一些 git-shell-commands 技巧将无法识别的命令传递给 svnserve？

对于这种情况，规定的最佳做法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:08:24.313

没问题，只要你在不同的端口上运行它们。

如果您希望它们都提供*同一个*存储库，那么它会变得有点复杂。基本上你必须用另一个库来模拟一个，因为它们不共享相同的底层设计决策，这样的模拟会有弱点。

如果您正在讨论凭据处理缺乏协调，那么只需让 svn 和 git 将它们的凭据检查委托给特定用途的凭据处理库（如 pam、kerberos 或其他东西）。

最佳实践是将凭证处理（身份验证）委托给其他东西，但单独管理每个存储库，通过 svn 配置文件（授权）管理 svn 用户（但不是他们的凭证），通过 git 管理 git 用户（但不是他们的凭证）配置文件（授权）。

在任何情况下，我*都不*建议在同一产品中结合身份验证和授权，即使这可能是配置它们的*默认*方式。这是因为密码不同步只是时间问题，任何“重置密码”工作都需要为每个产品和每个帐户重复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-05T16:41:55.093

使用 git-shell，可以通过创建用户 'gitsvn' 来允许访问 git 和 svn，然后使用 git-shell 作为 gitsvn 登录 shell。创建以下目录树（在 'gitroot' 中使用裸 git 存储库，在 'svnroot' 中使用 svn 存储库）。

```
gitsvn@server:~$ pwd
/home/gitsvn
gitsvn@server:~$ ls -l *
gitroot:
total 4
drwxr-xr-x 7 gitsvn gitsvn 4096 Jan  5 17:17 test

git-shell-commands:
total 4
-rwxr-xr-x 1 gitsvn gitsvn 52 Jan  5 17:22 help
lrwxrwxrwx 1 gitsvn gitsvn 17 Jan  5 16:22 svnserve -> /usr/bin/svnserve

svnroot:
total 4
drwxr-xr-x 6 gitsvn gitsvn 4096 Jan  5 16:23 test3

gitsvn@server:~$ cat git-shell-commands/help 
#!/usr/bin/python

print """
Restricted shell.
"""

gitsvn@server:~$ 
```

可以通过以下方式访问存储库：

```
ruser@client:/tmp/svnc$ svn checkout svn+ssh://gitsvn@server/home/gitsvn/svnroot/test3
gitsvn@server's password: 
A    test3/it
Checked out revision 1.

ruser@client:/tmp/svnc$ git clone gitsvn@server:/home/gitsvn/gitroot/test
Cloning into 'test'...
gitsvn@server's password: 
remote: Counting objects: 3, done.
remote: Total 3 (delta 0), reused 0 (delta 0)
Receiving objects: 100% (3/3), done.
Checking connectivity... done. 
```

我相信 git-shell 从 git 方面提供了基本的安全性。然而，一旦你在 git-shell-commands 中放置了任意应用程序，所有的赌注都没有了。因此，根据您的安全情况，可能值得围绕 svnserve 编写一个参数检查包装器，以防止恶意 svn 客户端将任意参数传递给 svnserve。

# tortoisesvn - SVN 提交错误：无法打开文件 txn-current-lock 权限被拒绝

> ID：10607928
> 
> 赞同：7
> 
> 时间：2012-05-15T19:59:57.443
> 
> 标签：tortoisesvn, commit, permission-denied

我可以进行结帐、更新等。但是当我尝试提交更改时，SVN 给了我以下错误：

> 无法打开文件'/svn/p/pokemonium/code/db/txn-current-lock'：权限被拒绝

我正在使用带有最新版本 TortoiseSVN 的 Windows 7 x64 SP1。UAC已关闭，我的帐户具有读写权限等。

我可以很好地提交到其他 svn 存储库。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-08-03T05:27:01.870

对我来说，它最终成为服务器上的权限问题。我在 linux 机器上有我的 repo，并 ssh 以使用 svnadmin。为方便起见，我以 root 身份执行了我的创建存储库命令。我正在寻找将我的 Windows 机器上的源代码放入 repo，因此使用 TortoiseSVN 来设置主干/分支/标签。服务器上包含 repo 的目录归 root 所有，而 Tortoise 以 apache 的形式出现。我将服务器上的目录改成 apache:apache，一切都很顺利。

```
chown apache:apache -R my_repo_root 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-11-02T05:36:51.553

这是服务器配置问题。在 windows 主机上，Visual SVN 服务器默认运行在 NETWORK SERVICE 帐户下。我通过授予此帐户对存储库文件夹的完全访问权限来解决此问题。另一种选择是将 Visual SVN 服务切换到 SYSTEM 帐户，但这可能会带来潜在的安全风险。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T20:08:12.613

试试这个。

1.  制作工作副本的备份副本（为了安全起见）。
2.  将您的整个工作副本复制到其他地方。
3.  取出副本并从中删除所有 SVN 文件夹
4.  删除您的工作副本并重新结帐
5.  现在将损坏的工作副本复制/粘贴到新结帐上。

## 在执行复制/粘贴之前，您必须从损坏的工作副本中完全删除 _svn 或 .svn 文件夹，这对这项工作至关重要。

这将为您（希望）留下一个工作副本，该副本显示（！）您自上次提交以来修改的所有文件。并修复了您的锁定问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-17T09:10:20.373

重新安装 Windows 7 并将 SVN 存储库从旧 Windows 复制到新 Windows 后，我遇到了同样的问题。

在尝试了经理先生提出的步骤后，我的问题仍然没有解决。

在确保为 SVN 存储库文件夹正确设置权限后，我刚刚删除了项目 /db 文件夹中的文件“txn-current-lock”。那为我修好了。从那时起，我可以再次提交我的项目。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-16T13:32:44.830

我在 Unix 机器上遇到过同样的问题

重启SVN服务器的Apache服务解决了我的问题。

-f httpd.conf -k 停止

-f httpd.conf -k 开始

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-03-17T01:49:38.390

在我自己的情况下，我的 linux 服务器在断电后重新启动。由于已进行了一些日志修复，因此文件系统仍以只读方式挂载。重新启动机器恢复了全部功能。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-03T10:51:09.893

权限也对我有用

错误

```
repo/db/txn-current-lock: Permission denied 
```

使固定

```
chown apache:apache -R my_repo_root 
```

# sockets - 从异步套接字反序列化多个对象

> ID：10607931
> 
> 赞同：0
> 
> 时间：2012-05-15T20:00:07.907
> 
> 标签：sockets, object, asynchronous, deserialization

全部，

我是 C# 和套接字编程的新手，我需要一些建议。我一直在寻找这个网站和类似的网站，但还没有真正找到解决我的问题的方法。

我正在开发一个客户端应用程序和一个服务器应用程序，两者通过异步套接字进行通信。客户端通过使用 BinaryFormatter 将对象序列化为 MemoryStream，一次一个地将对象发送到服务器。生成的字节数组通过套接字发送并由服务器反序列化。

当服务器有时间在客户端发送新对象之前接收和处理对象时，这很有效。但是，当客户端发送对象的速度快于服务器处理它们的速度时，它们会在服务器端排队。下一个 EndReceive() 调用从套接字读取所有排队的对象，但序列化程序只反序列化第一个对象，其他对象丢失。

这些对象的大小是可变的，所以我想我不能使用 MemoryStream 的 Position 属性。有没有办法在字节数组中检测对象开始的地方？

此外，我在其他帖子中读到 EndReceive() 可能无法接收一次读取发送的所有内容，可能需要其他读取。所以我想这是我必须处理的其他事情？

任何指针？任何帮助将不胜感激。:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T21:01:05.280

您可以阅读尽可能多的内容并将其“排队”进行处理，以便套接字不会排队。您可以让接收数据的服务器简单地读取数据并将其发送到消息队列中以进行异步处理。

令人担忧的是，服务器处理速度不够快，无法跟上写入的速度；您可能想考虑优化它。

# android - Android线性布局与屏幕底部对齐

> ID：10607932
> 
> 赞同：0
> 
> 时间：2012-05-15T20:00:12.813
> 
> 标签：android, android-layout

整天为此撕扯我的头发

我试图在屏幕底部有两个线性布局，每个都有几个底部。我想要一个线性布局在右边，一个在左边

到目前为止我有

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<LinearLayout
    android:id="@+id/home_layout"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >
    <!-- MAIN CONTENT WILL GO HERE -->
</LinearLayout>

<LinearLayout
    android:id="@+id/ad_layout"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/home_layout"
    android:layout_alignParentBottom="true"
    android:gravity="bottom" >

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_gravity="right"
        android:background="@android:color/white"
        android:gravity="right"
        android:orientation="vertical" >

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="£12.50" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Rate1 **** " />
    </LinearLayout>
</LinearLayout>

</RelativeLayout> 
```

产生

![第一次尝试](../Images/93dd464e88820907c4e1d3612fa185d6.png) 现在我尝试在左侧添加第二个布局

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<LinearLayout
    android:id="@+id/home_layout"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >
    <!-- MAIN CONTENT WILL GO HERE -->
</LinearLayout>

<LinearLayout
    android:id="@+id/ad_layout"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/home_layout"
    android:layout_alignParentBottom="true"
    android:gravity="bottom" >

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_gravity="left"
        android:background="@android:color/white"
        android:gravity="left"
        android:orientation="vertical" >

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="£12.50" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Rate1 **** " />
    </LinearLayout>

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_gravity="right"
        android:background="@android:color/white"
        android:gravity="right"
        android:orientation="vertical" >

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="£12.50" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Rate1 **** " />
    </LinearLayout>
</LinearLayout>

</RelativeLayout> 
```

产生：

![在此处输入图像描述](../Images/857b8494e94206f4f210a4a46de0e023.png)

任何的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T20:11:50.937

您的两个子线性布局都有

```
android:layout_width="fill_parent" 
android:layout_height="fill_parent" 
```

这行不通。如果要均匀分割空间，请考虑使用`layout_weight`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T20:10:55.857

你可以做这样的事情：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <LinearLayout
        android:id="@+id/home_layout"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:orientation="vertical"
        android:layout_weight="1" >
        <!-- MAIN CONTENT WILL GO HERE -->
    </LinearLayout>

    <FrameLayout
        android:id="@+id/ad_layout"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="0" >

       <LinearLayout
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="left"
            android:background="@android:color/white"
            android:gravity="left"
            android:orientation="vertical" >

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="£12.50" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Rate1 **** " />
        </LinearLayout>

        <LinearLayout
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="right"
            android:background="@android:color/white"
            android:gravity="right"
            android:orientation="vertical" >

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="£13.50" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Rate2 **** " />
        </LinearLayout>
    </FrameLayout>

</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-15T20:11:13.263

您应该为您的布局使用 android:layout_weight 属性，以便您可以指定每个 LinearLayout ViewGroup 占用多少屏幕，或者如上面的注释所指定，您需要更改布局，以便它们都不是试图填满父 ViewGroup。您可以将其设置为 wrap_content，这可能看起来不太好，因为屏幕可能有任何 ViewGroup 未填充的空白

# layout - 在本身位于垂直字段管理器中的水平字段管理器中添加垂直字段管理器 - 黑莓

> ID：10607933
> 
> 赞同：1
> 
> 时间：2012-05-15T20:00:20.640
> 
> 标签：layout, blackberry, button, user-interface, layout-manager

我在水平字段管理器中创建 3 个按钮，以便它们在屏幕中心水平对齐。

这是在包含 3 个选项卡的选项卡管理器上完成的。实现在窗格的第一个选项卡内。此窗格中保存的所有代码都在垂直字段管理器内。

我已经通过以下链接创建按钮 [如何在黑莓的水平字段管理器中为任何设备放置两个按钮？](https://stackoverflow.com/questions/7845438/how-to-put-two-buttons-in-horizontal-field-manager-in-blackberry-for-any-device)

它建议将垂直字段管理器添加到水平字段管理器。在我的代码中，有另一个垂直字段管理器持有这个水平字段管理器。

这是我的代码：

```
// setup the tab model with 3 tabs
  final PaneManagerModel model = new PaneManagerModel();
  model.enableLooping( true );

// setup the first tab   
   VerticalFieldManager vfm = new VerticalFieldManager( 
      Field.USE_ALL_HEIGHT | Field.USE_ALL_WIDTH |
      Manager.NO_VERTICAL_SCROLL | Manager.NO_HORIZONTAL_SCROLL );
  LabelField lbl = new LabelField( "Content for tab 1", Field.FOCUSABLE );
  vfm.add( lbl );

//Add one button to the form normal way
 ButtonField gl = new ButtonField(" Group ",ButtonField.FIELD_HCENTER | ButtonField.CONSUME_CLICK);
     // sms.setChangeListener(new FieldChangeListener());
     gl.setChangeListener(new FieldChangeListener() 
      {
            public void fieldChanged(Field field,int context) 
            {
                  model.getView().jumpTo(1,PaneManagerView.DIRECTION_NONE); 
            }
       });
      vfm.add(gl)

//Second button
//SMS send from form
      ButtonField sms = new ButtonField(" Sms ",ButtonField.FIELD_HCENTER | ButtonField.CONSUME_CLICK);
     vfm.add(sms);

//Adding horizontal field manager(MAIN IMPLEMENTATION)
HorizontalFieldManager buttonPanel = new HorizontalFieldManager(Field.FIELD_HCENTER | Field.USE_ALL_WIDTH);
    buttonPanel.add(vfm);//Gives error at this point
   // buttonPanel.add(sms);
    buttonPanel.add(new ButtonField(" Send Mail "));
    add(buttonPanel);

 //Ideal way posted on that link
VerticalFieldManager vfm = new VerticalFieldManager(USE_ALL_WIDTH);
    vfm.add(new ButtonField("button2",Field.FIELD_RIGHT));

    HorizontalFieldManager hfm = new HorizontalFieldManager();
    hfm.add(new ButtonField("button1"));
    hfm.add(vfm);
    add(hfm); 
```

我完全对这里使用的布局管理器感到困惑。请指导。谢谢

# javascript - 将返回的字符串 (YYYYMMDD) 转换为日期

> ID：10607935
> 
> 赞同：35
> 
> 时间：2012-05-15T20:00:31.027
> 
> 标签：javascript, datetime

我有一个字符串，其中包含代表日期的 8 位数字。例如：

```
20120515 
```

我想将它与以这种方式创建的今天的日期进行比较：

```
var currentDate = new Date(); 
```

如何将“8 位日期字符串”转换为合适的日期格式以便与 currentDate 进行比较？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2012-05-15T20:40:21.927

使用 substring 方法和 substring 关闭 4 个元素并将其分配给您的新日期。然后一次子串出两个元素并相应地存储月份和日期。

```
var dateString  = "20120515";
var year        = dateString.substring(0,4);
var month       = dateString.substring(4,6);
var day         = dateString.substring(6,8);

var date        = new Date(year, month-1, day);
var currentDate = new Date(); 
```

现在您可以使用普通运算符比较这两个日期。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-05-16T00:12:16.207

如果您想要一个小型日期库，您可以使用[moment.js](http://momentjs.com)。

```
var a = moment("20120515", "YYYYMMDD");
// then use any of moment's manipulation or display functionality
a.format("MMM Do YYYY"); // May 15th 2012
a.fromNow(); // 14 hours ago
a.calendar(); // Today at 12:00 AM 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-12-13T09:37:38.783

为了正确处理本地时区，它必须明确地与计算的时间相加

```
function dateStringToDate(dateString) {
  try {
    var year = dateString.substring(0, 4);
    var month = dateString.substring(4, 6);
    var day = dateString.substring(6, 8);
    var date = new Date(year, month - 1, day);
    const offset = date.getTimezoneOffset()
    date = new Date(date.getTime() - (offset * 60 * 1000));
    return date;
  } catch (error) {
    return null;
  }
} 
```

```
function dateStringToDate(dateString) {
  try {
    var year = dateString.substring(0, 4);
    var month = dateString.substring(4, 6);
    var day = dateString.substring(6, 8);
    var date = new Date(year, month - 1, day);
    const offset = date.getTimezoneOffset()
    date = new Date(date.getTime() - (offset * 60 * 1000));
    return date;
  } catch (error) {
    return null;
  }
}

console.log(dateStringToDate("20211212"))
console.log(dateStringToDate("20211213"))
console.log(dateStringToDate("20211214"))
```

# sql - 返回特定间隔记录的存储过程

> ID：10607942
> 
> 赞同：4
> 
> 时间：2012-05-15T20:00:58.933
> 
> 标签：sql, sql-server-2008, tsql

我必须在应用程序中为具有数十万条记录的表创建视图。出于显而易见的原因，我不想一次全部检索它们。

约定是创建存储过程来查询数据库表，所以我的计划是创建一个存储过程来返回记录的间隔（如记录 2000 到 3000）。我知道使用嵌套查询来检索一系列记录的技巧`TOP`，但据我所知，您不能将参数参数化为`TOP`.

这将`DataTable`在 C# 应用程序中与 datasets 和 s 一起使用。

我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-15T20:08:51.890

您可以利用 SQL Server 2008 中的 ROW_NUMBER。下面的查询将根据行号仅返回 10 行。

```
WITH Ordered AS (
SELECT ROW_NUMBER() OVER (ORDER BY OrderID) AS RowNumber, OrderID, OrderDate
FROM Orders)
SELECT * 
FROM Ordered
WHERE RowNumber BETWEEN 21 AND 30 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-05-15T20:06:04.750

您*可以*将参数参数化为顶部。将论点括在（大括号）中。

如果您无论如何都需要它们，那么一次获得所有它们会更有效。不需要分块。

# django - 格式化表单集结果值未输入

> ID：10607943
> 
> 赞同：0
> 
> 时间：2012-05-15T20:00:59.900
> 
> 标签：django, django-templates

我的模板看起来像：

```
<form method="post" action="">
  {{ formset.management_form }}
  {% for form in formset.forms %}
    {{ form.contractor }} {{ form.date }} {{ form.value }} {{ form.comment }} {{ form.operation_type }} {{ form.category }} {{ form.account }}
  {% endfor %}
</form> 
```

但结果允许更改所有字段 - 但我只想要一个。

我认为（请注意“.value”毕竟除了类别字段）解决了问题，但不是。

```
<form method="post" action="">
  {{ formset.management_form }}
  {% for form in formset.forms %}
    {{ form.contractor.value }} {{ form.date.value }} {{ form.value.value }} {{ form.comment.value }} {{   form.operation_type.value }} {{ form.category }} {{ form.account.value }}
  {% endfor %}
</form> 
```

**UPD** : 相关视图代码

```
def detail(request, category_id):
  from django.forms.models import modelformset_factory
  OperationFormSet = modelformset_factory(Operation)
  if request.method == "POST":
    formset = OperationFormSet(request.POST, request.FILES,
                                queryset=Operation.objects.filter(category=category_id))
    if formset.is_valid():
      formset.save()
      # Do something.
  else:
    formset = OperationFormSet(queryset=Operation.objects.filter(category=category_id))
  return render_to_response("reports/operation_list.html", {
    "formset": formset,
  }) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:34:12.453

您的问题是只读值没有传递回服务器，因此您的表单集应该失败，因为它只接收一个字段。

您希望显示该值并设置一个隐藏字段来存储表单集期望的数据。但我会推荐一种不同的方法......

最终，表单集和表单用于显示 html 表单，而不是为其他任何东西构建的。您必须破解它以显示隐藏的小部件，确保用户不能发布任意数据等。因此，我将使用表单框架仅显示您的一个可编辑字段。

创建一个`ModelForm`只有一个可编辑字段的

```
class MyModelForm(forms.ModelForm):
    class Meta:
        model = Operation
        fields = ('category',)

MyModelFormSet = modelformset_factory(Operation, form=MyModelForm) 
```

至于在模板中显示值，ModelForms 应该可以直接访问它们的实例，`form.instance`因此您应该能够执行以下操作：

```
{% for form in formset %}
   {{ form.instance.some_attribute }}
   {{ form.category }} 
{% endfor %} 
```

# forms - 当在 buidler 中定义相同时，Symfony2 表单会忽略自定义字段中的属性

> ID：10607947
> 
> 赞同：0
> 
> 时间：2012-05-15T20:01:11.167
> 
> 标签：forms, symfony, custom-controls, symfony-forms

当我在表单构建器中定义属性并在自定义字段中定义与默认属性相同的属性时，其他属性将被忽略。在表单生成器中，我有：

```
 $builder
            ->add('validityOfADecisionOnDisability', new JQDateType(), array(
                'attr' => array(
                    'rel' => 'permanent',
                )
            )) 
```

和自定义字段

```
class JQDateType extends AbstractType {

public function getDefaultOptions(array $options)
{
    return array(
        'widget' => 'single_text',
        'format' => 'yyyy-MM-dd',
        'attr' => array(
            'class' => 'datepicker'
        )
    );
} 
```

它呈现html

```
<input type="text" rel="permanent" required="required" 
  name="profile[validityOfADecisionOnDisability]" 
  id="profile_validityOfADecisionOnDisability"> 
```

没有课。但是当我将类添加到构建器中的属性时

```
 $builder
            ->add('validityOfADecisionOnDisability', new JQDateType(), array(
                'attr' => array(
                    'rel' => 'permanent',
                    'class' => 'datepicker',
                )
            )) 
```

eevrything 按预期工作。我应该如何在 JQDateType() 中定义属性？我尝试在 JQDateType::getDefaultOptions() 中使用 array_merge() 和 array_merge_recursive() 但它没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-26T06:09:39.177

这是一个在 Symfony 2.1 中修复的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T22:40:09.670

@Koral 我猜你可以在你的实体类中使用注释比'getDefaultOptions'更好，你可以在这里看到：

[http://symfony.com/doc/current/book/validation.html](http://symfony.com/doc/current/book/validation.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-16T20:30:02.523

是的，您可以直接在实体类中验证表单的所有字段，例如：

```
/**
 * @Assert\Min(limit = "18", message = "You must be 18 or older to enter")
 */
 protected $age; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-20T11:04:03.090

听起来像一个错误。[你应该在https://github.com/symfony/symfony/issues](https://github.com/symfony/symfony/issues)上开一张票

# android - 在 OPENGL ES 1.x 中使用带有 .OBJ 和多个索引的绘图元素

> ID：10607954
> 
> 赞同：0
> 
> 时间：2012-05-15T20:01:33.847
> 
> 标签：android, opengl-es, .obj, indices

我正在自学opengl es。我最近想出了如何从 .OBJ 文件解析/加载网格。我现在正在尝试对其应用纹理，我知道我只能使用一组索引..除此之外，我迷失了在我的立方体上绘制纹理所需的概念和代码。非常感谢对所需内容、代码和正在发生的事情的描述的详细/半详细解释。我在这个主题上没有找到太多关于 opengl 的内容，而且解释对我来说有点模糊。请记住我使用的是opengl es。提前致谢。顺便说一句，如果有帮助，这是 .OBJ 文件

```
enter code here
# Blender v2.62 (sub 0) OBJ File: '' 
```

# www.blender.org

mtllib untitled.mtløCube_Cube.002 v 1.067472 -0.769912 -1.117719 1.067472 v -0.769912 0.882281 -0.932528 v -0.769912 0.882281 -0.932527 v -0.769912 -1.117719 v 1.067473 1.230088 -1.117718 v 1.067472 1.230088 0.882282 v -0.932528 1.230088 0.882281 v -0.932528 1.230088 -1.117719 VT 0.951958 0.112804 0.951958 VT VT -0.887196 -0.048042 -0.887196 -0.048042 VT VT 0.112804 0.058859 0.112804 0.058859 VT VT 1.112804 1.058859 1.112804 1.058859 VT VT 0.112804 0.951958 1.112804 -0.941141 VT VT 0.112804 -0.941141 -0.887196 0.951958 VT VT 0.058859 -0.048042 0.058859 VT 0.951958 -0.941141 vt 1.951958 -0.941141 vt -0.048042 -0.941141 usemtl Material.001 s off f 5/1 1/2 4/3 f 5/1 4/3 8/4 f 3/5 7/6 8/7 f 3 /5 8/7 4/8 f 2/1 6/9 3/4 f 6/1 7/4 3/3 f 1/5 5/6 2/10 f 5/5 6/10 2/11 f 5 /12 8/13 6/14 f 8/12 7/14 6/15 f 1/12 2/14 3/16 f 1/12 3/16 4/13

PS我了解如何阅读/解析/理解文件的这些方面。我只需要澄清我应该如何将一个索引缓冲区用于纹理和顶点，同时只调用一次drawelements。再次感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:48:22.060

我不知道搅拌机是否可以做到这一点，但存在一些工具可以用一组索引导出 .obj 。这将如下所示：

```
f 6/6/6 1/1/1 4/4/4 
f 4/4/4 1/1/1 3/3/3 
f 1/1/1 2/2/2 3/3/3 
f 12/12/12 2/2/2 1/1/1 
f 11/11/11 12/12/12 1/1/1 
f 11/11/11 81/81/81 12/12/12 
```

例如，当您将场景（由 StaticMesh 制成）导出为 .obj 格式时，UDK 会执行此操作。使用以这种方式导出 .obj 的工具对您来说是最简单的解决方案。但是，您可以根据从代码中的 .obj 读取的内容自行重建数组，但这是一个无聊且不必要的耗时操作。

# ios - 无法识别的选择器错误

> ID：10607959
> 
> 赞同：0
> 
> 时间：2012-05-15T20:01:53.710
> 
> 标签：ios

我收到此错误：[NSURL stringByAppendingFormat:]: unrecognized selector sent to instance 0x5869210 when it get to append。strcust 是一个纯数字，并且 strURI 在追加之前是正确的。

```
 NSString *strUIR = [NSURL URLWithString:@"https://cid.hooru.mobi:36610/?";
 strURI = [strURI stringByAppendingFormat:@&Cust=IPRR%@", strCust]; 
```

任何想法将不胜感激。我只是想从变量中附加名称/值对。无法使附加工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T20:08:53.377

这段代码有几个问题：

1.  您正在声明一个，`NSString`但您正在分配一个`NSURL`
2.  你缺少一个右方括号']'
3.  您在第二行缺少双引号
4.  您正在尝试调用对象`NSString`上的方法`NSURL`
5.  您在`strURI`第一行拼写错误（它是`strUIR`）

试试这个：

```
NSString *strURI = @"https://cid.hooru.mobi:36610/?";
strURI = [strURI stringByAppendingFormat:@"&Cust=IPRR%d", strCust]; 
//Note the %d (if strCust is an int. If it's an NSString use %@)

NSURL *myUrl = [NSURL UrlWithString:strURI]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:11:06.290

[NSURL URLWithString:] 返回 NSURL 类型的指针。仅在 NSString* 类型中收集 NSURL* 类型的返回值不会将其转换为 NSString* 类型。因此 strUIR 是 NSURL* 类型，即使声明为 NSString *strUIR，因此您不能将任何应该传递给 NSString*类型的消息传递给 strUIR。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T20:12:18.377

NSURL 不响应 stringByAppendingFormat：

您将 strURI 指定为 NSString，因此编译器不会发出警告，但您将其设置为 NSURL。

在创建 NSURL 之前初始化完整的字符串，或者使用 URLByAppendingPathComponent:，我推荐第一个选项。

```
 NSString *path = @"https://cid.hooru.mobi:36610/?" 
```

...

```
 path = [path stringByAppendingFormat:@"&Cust=IPRR%@", strCust];
    NSURL *url = [NSURL URLWithString:path] 
```

有关更多信息，请参阅文档：[https ://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURL_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURL_Class/Reference/Reference.html)

# php - 从 XML 文件中去除所有标签

> ID：10607960
> 
> 赞同：4
> 
> 时间：2012-05-15T20:01:54.770
> 
> 标签：php, asp.net, xml, xslt

我有一个大型 XML 文件，我想剥离所有标签并只保留节点值。我希望每个节点值都在单独的行中。我怎样才能做到这一点？

我可以使用免费软件还是使用 PHP 或 ASP.NET 代码。我还查看了 XSLT 选项。RegEX 可能太多了。我探索了查看`simplexml_load_file()`,的 PHP 选项`strip_tags()`，`get_file_contents()`但失败了。

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- a comment -->
<catalog>
    <cd>
        <title>Empire Burlesque</title>
        <artist>Bob Dylan</artist>
        <country>USA</country>
        <company>Columbia</company>
        <price>10.90</price>
                <address>
                         <city>Melbourne </city>
                         <zip>01803 </zip>
                </address>
        <year>1985</year>
    </cd>
    <cd>
        <title>Hide your heart</title>
        <artist>Bonnie Tyler</artist>
        <country>UK</country>
        <company>CBS Records</company>
        <price>9.90</price>
        <year>1988</year>
    </cd>

</catalog> 
```

**编辑：**这是我尝试过的，除其他外。

```
<?php

$xml = simplexml_load_file('myxml.xml');
echo strip_tags($xml);

?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T20:18:37.757

这应该做你：

```
<?php
$xml = file_get_contents('myxml.xml');
$xml = nl2br($xml);
echo strip_tags($xml,"<br>");
?> 
```

您缺少换行符的原因是因为在 XML 中，它存储为纯文本换行符`\n`，而当显示为 HTML 时，您必须有明确的`<br>`换行符。因此，优秀的 PHP 人员制作了一个方便的函数`nl2br()`来为您执行此操作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-05-16T03:01:36.487

**这是一个简短的 XSLT 解决方案**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="text()">
  <br /><xsl:value-of select="concat(.,'&#xA;')"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时**（适用于*任何*XML 文档）：

```
<catalog>
    <cd>
        <title>Empire Burlesque</title>
        <artist>Bob Dylan</artist>
        <country>USA</country>
        <company>Columbia</company>
        <price>10.90</price>
        <address>
            <city>Melbourne </city>
            <zip>01803 </zip>
        </address>
        <year>1985</year>
    </cd>
    <cd>
        <title>Hide your heart</title>
        <artist>Bonnie Tyler</artist>
        <country>UK</country>
        <company>CBS Records</company>
        <price>9.90</price>
        <year>1988</year>
    </cd>
</catalog> 
```

**产生了想要的结果：**

```
<br/>Empire Burlesque
<br/>Bob Dylan
<br/>USA
<br/>Columbia
<br/>10.90
<br/>Melbourne 
<br/>01803 
<br/>1985
<br/>Hide your heart
<br/>Bonnie Tyler
<br/>UK
<br/>CBS Records
<br/>9.90
<br/>1988 
```

**它被浏览器显示为：**

Empire Burlesque
Bob Dylan
USA
Columbia
10.90
Melbourne
01803
1985
隐藏你的心
Bonnie Tyler
UK
CBS Records
9.90
1988

# spring - Spring Security 3.1 拦截 url

> ID：10607962
> 
> 赞同：1
> 
> 时间：2012-05-15T20:02:02.923
> 
> 标签：spring, authentication, spring-security

我有我的拦截网址配置

```
<security:http use-expressions="true" disable-url-rewriting="true">

    <security:intercept-url pattern="/secure/admission/*" access="hasRole('ROLE_ADMISSIONER')" />              
    <security:intercept-url pattern="/secure/subdean/*" access="hasRole('ROLE_SUBDEAN')" />
    <security:intercept-url pattern="/secure/referent/*" access="hasRole('ROLE_REFERENT')" />                   
    <security:intercept-url pattern="/secure/index.xhtml" access="hasRole('ROLE_REFERENT, ROLE_SUBDEAN')" />    
    <security:intercept-url pattern="/secure/*" access="hasRole('ROLE_OMNI_ADMIN')" />
    <security:intercept-url pattern="/**" access="isAuthenticated()" /> 
```

但是现在我有一个问题，可以访问我的应用程序的 url，例如具有角色 ROLE_ADMISSIONER 的 MY_APPLICATION/PririzMaven/secure/admin/updateRole.xhtml，具有相同角色的 url ..../secure/subdean/* 和依此类推...但应该禁止该用户使用。

你知道哪里有问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-05-15T20:20:32.507

假设`PririzMaven`是您的应用程序的上下文路径，`/secure/admin/updateRole.xhtml`将与路径匹配`/**`，因此所有经过身份验证的用户都可以访问。你没有规则`/secure/admin`。另请注意，单个“*”不匹配子路径。例如，您应该使用`/secure/admin/**`来匹配此路径下的所有内容。

您还应该启用调试日志并检查规则是如何应用的 - 您应该看到匹配器被调用到传入的请求 URL，并将看到正在比较的内容和正在匹配的内容。

最后，值得`<security:debug />`在应用程序上下文文件的顶部添加，这将以更易于阅读的格式添加有关请求处理的其他有用的调试信息。

# sql-server - 为什么我在这个演员表中丢失了两位小数？

> ID：10607965
> 
> 赞同：1
> 
> 时间：2012-05-15T20:02:17.057
> 
> 标签：sql-server, tsql

我在这里想念什么？

```
select cast ( ( cast (100 * 39  as decimal )  / 41) as decimal(5,2)) 
```

结果为 95.12

但

```
declare @percent decimal 
set  @percent = cast ( ( cast (100 * 39  as decimal )  / 41)  as decimal(5,2)) 
select @percent 
```

结果为 95

两个 2 小数点发生了什么？如何将它们放回我的变量中？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-05-15T20:05:59.100

`DECIMAL`它本身没有任何小数位（实际上是`DECIMAL(18,0)`）。您需要指定精度和比例，例如

```
DECLARE @percent DECIMAL(5,2);
SET @percent = 1.0 * (100 * 39) / 41;
SELECT @percent; 
```

# xcode - 使用 Xcode 4，我可以摆脱一个 git 存储库但让我的整个项目保持当前状态吗？

> ID：10607970
> 
> 赞同：1
> 
> 时间：2012-05-15T20:02:40.013
> 
> 标签：xcode, git

我开始在 Xcode 4 中使用 git 存储库，之前不知道 git，看起来我已经搞砸了存储库的状态。我首先创建了一个存储库，对其进行了许多提交，然后创建了一个分支并在该分支上进行了许多提交。然后我尝试使用 Xcode 管理器将分支合并回主分支，但它不会让我切换到主分支。当我尝试切换到主分支时，出现错误：“您需要先解析当前索引”。我不知道这到底是什么意思。我做了一个提交，一切都是最新的。我在 Xcode 菜单或屏幕中看不到任何提及“索引”的内容。在阅读了一些关于 git 的帖子并使用了 git 命令行之后，我显然迷路了，不知道该怎么做。

我知道正确的做法是学习 git 并学习如何使用命令行工具，但我现在不想为此花时间。无论如何，我并不真的需要存储库功能，我只是使用它们来看看它们是什么样的。我可以保留整个目录的副本和/或我可以使用快照给我一种回到早期状态的方法。

我一直在处理的分支上的代码的当前状态很好，所以我想做的是 un-git 它。IOW 完全消除了存储库，但将项目保持在当前状态。有没有办法做到这一点？我不需要回到master分支上的项目状态，我只需要当前状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T20:06:53.313

要删除 git 的所有痕迹，请删除主项目文件夹中的 .git 文件夹。还要查找任何 .git* 文件（例如 .gitignore、.gitmodules）。如果您有子模块，则需要检查这些文件的子文件夹以及 .git 目录。

在 linux 上，这将做到这一点：

```
find /base/dir -name '.git*' -prune -exec rm -rf {} \; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T20:08:31.100

un-git 项目的快速方法是打开终端，进入项目目录，然后删除 .git 目录

```
cd ~/Documents/MyProject/
rm -rf .git 
```

小心 rm 命令，你只想核对 .git 目录。不是你的代码。

我不知道如何使 .git 目录在 finder 中可见。

# c++ - C ++：向量中向量列表的有效副本

> ID：10607972
> 
> 赞同：1
> 
> 时间：2012-05-15T20:02:47.383
> 
> 标签：c++, vector, stdvector

我正在寻找最有效的方法来复制向量中向量列表的内容。我想尽可能避免内存重新分配。

我的问题如下：我有：

*   a`std::vector<int> v`包含 N 个元素

*   向量列表`std::vector< std::vector<int>* > vlist`

*   而且我知道 vlist 的向量中的元素总数 M <= N （N 和 M 可能非常大）

我想在 v 中复制 vlist 的所有元素（首先是 vlist[0] 的所有元素，然后是 vlist[1] 的所有元素等），最后将 v 的大小减小到 M（我的项目不要'不使用 C++2011)。

如何尽可能有效地做到这一点？

非常感谢。

编辑：备注：v 已经填充了 N 个元素，我想用来自其他向量的 M (<= N) 个元素替换它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-05-15T20:06:58.197

我不知道这是否是*最有效的方法*，但这是*一种方法*：

```
std::vector<int> v;
std::vector< std::vector<int>* > vlist;
int j = 0;
for(int i = 0; i < vlist.size(); ++i) {
  std::copy(vlist[i]->begin(), vlist[i]->end(), &v[j]);
  j += vlist[i]->size();
}
v.resize(j); 
```

如果您*真的*想要最有效的方法，您可能必须实现几种不同的方法并比较它们的速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-05-15T20:20:13.680

```
std::vector<int> v;
v.reserve(N);
for(size_t i = 0; i<vlist.size(); i++)
{
   v.insert(v.end(), vlist[i]->begin(), vlist[i]->end());
} 
```

如果 M 接近 N，这应该足够有效。否则最好在分配内存之前计算 M，并使用 v.reserve(M)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-05-15T20:09:49.430

最有效的方法是不复制它。您的应用程序在做什么需要它？另外，为什么你有 a`vector<* vector<int> >`而不是 just `vector<vector<int> >`？围绕它进行设计，使用 pimpl、惰性复制等。

最后，我不确定你认为你能做什么来击败 std 的默认复制构造函数。您是否分析过您的应用程序以确定默认 ctor 是瓶颈？

# javascript - 在同一个声明中制作javascript函数和原型定义？

> ID：10607975
> 
> 赞同：3
> 
> 时间：2012-05-15T20:02:56.893
> 
> 标签：javascript, prototype

是否可以将整个定义合并到一个声明中而不是将其分开？

第一部分

```
var Pan = function(){}; 
```

第二部分

```
Pan.prototype = {

 //private variables
 Id: null,

 //public methods
 GetId: function(){
    alert(Id);
 }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-05-15T20:33:10.747

你总是可以这样做：

```
var Pan = function () {
    var Id = null;

    this.GetId = function(){
        alert(Id);
    }
}; 
```

# facebook - 将 Facebook 评论添加到 Dreamweaver 模板

> ID：10607978
> 
> 赞同：2
> 
> 时间：2012-05-15T20:03:04.267
> 
> 标签：facebook, dreamweaver, facebook-comments

我按照[https://developers.facebook.com/docs/reference/plugins/comments/](https://developers.facebook.com/docs/reference/plugins/comments/)上的说明在我的 Dreamweaver 模板中添加了一个评论框，它起作用了 - 但所有评论都显示在所有页面上，无论哪个页面评论实际上是对的。另外，当它发布到用户的个人资料时，它只是链接到“beachpaper.com”。我如何告诉代码我不只是想要域 URL 的评论框 - 我希望它自动知道它所在的页面并制作一个独立于网站上其他评论框的评论框？无论如何都可以在不手动更改每个页面上的代码的情况下执行此操作？

# c# - MvcBuildViews 与 Razor 生成器

> ID：10607983
> 
> 赞同：11
> 
> 时间：2012-05-15T20:03:29.083
> 
> 标签：c#, .net, asp.net-mvc, unit-testing, razor

[使用 .csproj 设置MvcBuildViews](https://stackoverflow.com/questions/383192/compile-views-in-asp-net-mvc)和使用[Razor Generator](http://blog.davidebbo.com/2011/06/unit-test-your-mvc-views-using-razor.html)来实现相同的目标之间有什么区别？

我自己的假设是 MvcBuildViews 不会让单元测试可以使用智能视图，但是可能还有哪些其他差异？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-05-15T20:06:15.657

**MVCBuildViews**实际上并没有为部署预编译您的视图。它在构建解决方案后编译视图，以在部署之前回显任何 MVC 视图中可能存在的任何错误。这样，您可以在将视图推送到服务器之前捕获它们的编译错误，以避免在运行时出现错误页面或黄屏死机。

RazorGenerator**可**用于预编译您的视图，以避免在服务器上任何视图的第一次命中时出现任何编译预热时间。使用 RazorGenerator 工具时，您可以为应用程序而不是视图文件夹部署程序集，因为所有视图都将被预编译并包含在该程序集中。

# java - 我应该如何在 Java 中复制字符串？

> ID：10607990
> 
> 赞同：222
> 
> 时间：2012-05-15T20:03:46.500
> 
> 标签：java

```
 String s = "hello";
    String backup_of_s = s;
    s = "bye"; 
```

此时，备份变量仍然包含原始值“hello”（这是因为 String 的不变性吧？）。

但是用这种方法复制字符串真的**安全**吗（复制常规的可变对象当然不安全），还是写这个更好？：

```
 String s = "hello";
    String backup_of_s = new String(s);
    s = "bye"; 
```

换句话说，这两个片段之间有什么区别（如果有的话）？

* * *

**编辑 - 第一个片段安全的原因：**

让我根据已经提供的好的答案（主要集中在两个片段之间的性能差异问题）更详细地解释一下事情：

字符串在 Java 中是不可变的，这意味着 String 对象在构造后无法修改。因此，

`String s = "hello";`创建一个新的 String 实例并将其地址分配给`s`(`s`作为对实例/对象的引用)

`String backup_of_s = s;`创建一个新变量`backup_of_s`并对其进行初始化，使其引用当前所引用的对象`s`。

注意：字符串不变性保证这个对象不会被修改：我们的备份是安全的

注2：Java垃圾回收机制保证这个对象只要被至少一个变量引用就不会被销毁（`backup_of_s`在这种情况下）

最后，`s = "bye";`创建另一个 String 实例（因为不可变性，这是唯一的方法），并修改`s`变量，以便它现在引用新对象。

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2012-05-15T20:04:52.053

由于字符串是不可变的，因此两个版本都是安全的。然而，后者效率较低（它会创建一个额外的对象，并且在某些情况下会复制字符数据）。

考虑到这一点，应该首选第一个版本。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-05-15T20:07:14.660

字符串是[不可变的对象](http://docs.oracle.com/javase/tutorial/essential/concurrency/immutable.html)，因此您可以复制它们只是应对对它们的引用，因为引用的对象不能改变......

所以你可以像你的第一个例子一样复制没有任何问题：

```
String s = "hello";
String backup_of_s = s;
s = "bye"; 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-05-15T20:05:45.640

您的第二个版本效率较低，因为它在根本不需要这样做时会创建一个额外的字符串对象。

不变性意味着您的第一个版本按照您期望的方式运行，因此是首选方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-14T06:59:54.100

第二种情况在字符串池方面也是低效的，您必须在返回引用上显式调用 intern() 以使其成为实习生。

* * *

## 回答 #5

> 赞同：-14
> 
> 时间：2013-05-08T12:41:54.530

```
String str1="this is a string";
String str2=str1.clone(); 
```

这样的副本怎么办？我认为获得一个新的副本更好，这样在以后的操作中引用和修改数据`str1`时不会受到影响。`str2`

# java - JSF 2.0 和参数化 EL 表达式的问题

> ID：10607994
> 
> 赞同：1
> 
> 时间：2012-05-15T20:04:06.623
> 
> 标签：java, jsf-2, el

我在尝试使用参数访问某些属性时遇到了一些麻烦。好吧，我不知道是否应该将它们称为属性，因为访问器具有参数，但现在让我们将它们称为属性。

情况是这样的：

我有一个 Student 类，其中包含不同的本地化作为地图中的对象。我可以通过这样做获得这些本地化对象：

```
student.getLocalizedData(String localizationCode); 
```

现在，在页面上，我正在尝试这样做：

```
<h:inputText value="#{collegeBean.student.getLocalizedData('es').profileDescription}"/> 
```

一个学生的描述可以有很多本地化。

页面加载正确，但是当我尝试保存学生时，它说 bean CollegeBean 没有属性 getLocalizedData，很难说这是 bean 中包含的学生的属性。

我知道那条线很疯狂，所以我试着把它包装起来：

```
<h:inputText value="#{collegeBean.getStudentLocalizedData('es').profileDescription}"/> 
```

唉，我又收到了同样的信息。

我发现的唯一解决方案是制作一种完全包裹学生属性的方法......但这给每个本地化留下了 2 种方法（get + set），而且这只适用于一个属性。这意味着我将拥有（2 x 本地化 x 属性）数量的方法！。

有什么方法可以以最动态的方式解决这个问题吗？未来本地化的数量可能会发生变化，我不想更改任何代码。

**编辑：**我正在使用 JBoss 6.1.0.Final 和它附带的 JSF 实现 JSF 2.0.3-b05

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-05-15T20:09:35.860

这在理论上应该可行，所以我怀疑使用的 EL 实现中存在错误或疏忽。您可能想尝试不同的 EL 实现（不同的服务器品牌）或升级服务器。如果无效，请将其作为错误报告给服务器供应商。

但是，由于您实际上是将 a 委托`getLocalizedData()`给 a `Map`，因此最好不要这样做，而是`Map`直接返回整个。

```
public Map<String, LocalizedData> getLocalizedData() {
    return localizedData;
} 
```

这样您就可以按如下方式使用它

```
<h:inputText value="#{collegeBean.student.localizedData.es.profileDescription}"/> 
```

或者，如果需要

```
<h:inputText value="#{collegeBean.student.localizedData['es'].profileDescription}"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-05-15T20:23:26.337

以我的经验，大多数接受参数的 EL 实现都以一种或另一种方式存在缺陷。我最满意的是Tomcat 7 的EL。

请注意，您可以将自定义 EL 实现与 Mojarra 和 MyFaces 一起使用。我通常将 Tomcat 与我的应用程序捆绑在一起，因此我可以相信一个稳定的功能集是可用的。但是，您必须小心，因为如果您没有正确配置所有内容，您可能会遇到类加载器问题。

莫哈拉：

```
<context-param>
    <param-name>com.sun.faces.expressionFactory</param-name>
    <param-value>YOUR EL IMPLEMENTATION EXPRESSION FACTORY</param-value>
</context-param> 
```

我的脸：

```
<context-param>
    <param-name>org.apache.myfaces.EXPRESSION_FACTORY</param-name>
    <param-value>YOUR EL IMPLEMENTATION EXPRESSION FACTORY</param-value>
</context-param> 
```

# node.js - Nodejs，提供恒定的图像

> ID：10607997
> 
> 赞同：3
> 
> 时间：2012-05-15T20:04:39.010
> 
> 标签：node.js

我正在尝试在 node.js 中加载图像文件。该文件将在 ram 中并在主循环之外加载。它只是一个 1x1 像素。

如何打开图像文件？

我尝试了以下方法：

```
var fs = require('fs');
fs.readFile('/home/ubuntu/workspace/rtbopsConfig/rtbServers/rtbNodejsServer/pixel1x1.gif', function(err,pixel){
  if(err) {
    console.error("Could not open file: %s", err);
    process.exit(1);
  }
  console.log(pixel);
});

Server running at http://127.0.0.1:8124/
<Buffer 47 49 46 38 39 61 01 00 01 00 80 00 00 00 00 00 ff ff ff 21 f9 04 01 00 00 00 00 2c 00 00 00 00 01 00 01 00 00 02 01 44 00 3b> 
```

图像无法显示，因为它包含错误。

```
 res.writeHead(200, {'Content-Type': 'image/gif'});
 res.end(pixel); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-04-20T00:52:51.437

如果它只是一个 1x1 gif 图像，那么你不需要存储图像文件并加载它，因为有一个很好的 NPM 包 blankgif 已经在代码中加载了带有 base64 字符串的空白 1x1 gif，所以它会工作得更快然后单独加载图像。此外，还有一些辅助函数可以帮助您在 expressjs 中发送此图像。

要使用这个包，你可以使用这个代码：

```
var blankgif = require('blankgif');
var express = require('express');
var app = express();

app.get('/track.gif', blankgif.sendBlankGif);

app.listen(3000, function () {
  console.log('App listening on port 3000!');
}); 
```

我还假设您要实现此功能，因为您需要使用此空白图像在某处跟踪访问者。所以你可以用这个库以两种方式做到这一点：

1）使用blankgif的特殊中间件，为您的响应对象添加附加功能

```
var blankgif = require('blankgif');
var express = require('express');
var app = express();

app.use(blankgif.middleware());

app.get('/track.gif', function(req, res) {
  console.log('request information logged');

  res.set('Cache-Control', 'public, max-age=0');
  res.status(200).sendBlankGif();
});

app.listen(3000, function () {
  console.log('App listening on port 3000!');
}); 
```

2) 只需在 blankgif.sendBlankGif 之前使用自定义中间件

```
var blankgif = require('blankgif');
var express = require('express');
var app = express();

app.get('/track.gif', function(req, res, next) {
  console.log('request information logged');
  next();
}, blankgif.sendBlankGif);

app.listen(3000, function () {
  console.log('App listening on port 3000!');
}); 
```

此外，如果您出于某些原因不想使用此库（或者如果您想要另一个 gif 图像），您可以手动提供此图像：

```
var express = require('express');
var app = express();
var fs = require('fs');
var path = require('path');

var buff = null;

fs.readFile(path.resolve(__dirname, 'pixel1x1.gif'), function (err, pixel) {
  if (err) {
    console.error("Could not open file: %s", err);
    process.exit(1);
  }

  buff = pixel;
});

app.get('/track.gif', function (req, res) {
  console.log('request information logged');

  res.type('image/gif');
  res.send(buff);
});

app.listen(3000, function () {
  console.log('App listening on port 3000!');
}); 
```