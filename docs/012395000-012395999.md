# StackOverflow 问答 12395000-12395999

# java - IOException 后的 Java 重试

> ID：12395004
> 
> 赞同：2
> 
> 时间：2012-09-12T19:30:18.327
> 
> 标签：java, inputstream, ioexception

如果我有我期望的流有时可能会抛出一个`IOException`，并且想要捕获异常并重试流将在哪里（即标记仍然会在最后一次成功读取块/字节之后）？我只是捕获异常并执行相同的`read(byte[])`操作，并期望我不会丢失数据吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T07:31:23.073

您可以尝试使用[jcabi-aspects](http://www.jcabi.com/jcabi-aspects/annotation-retryonfailure.html)`mark()`中的使用/`reset()`方法、AOP 和 Java 注释（我是开发人员）。读取的函数将如下所示（伪代码）：

```
@RetryOnFailure(attempts = 5)
private byte[] read(InputStream stream, int length) {
  stream.reset();
  byte[] bytes = new byte[length];
  stream.read(bytes, 0, length);
  stream.mark(length);
  return bytes;
} 
```

`stream.read(bytes, 0, length)`如果在调用时抛出 IOException`mark()`将不会发生，并且下一次调用`reset()`会将指针设置为前一个位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:33:43.657

一些 IOExceptions 是致命的，你不能指望继续。确保连续重试可能成功。（即检查手头的异常是否可恢复。）

# c# - 如何同时对一个字符串进行多次替换？

> ID：12395006
> 
> 赞同：0
> 
> 时间：2012-09-12T19:30:33.473
> 
> 标签：c#, asp.net, replace

```
string rawConnString = Properties.Settings.Default.ConnectionString; 
```

我想用“rawConnString”做到这一点：

```
rawConnString.Replace("<<DATA_SOURCE>>", server);
rawConnString.Replace("<<INITIAL_CATALOG>>", "tempdb"); 
```

然后将最终字符串设置为变量 finalConnString。

我该怎么做呢？

这是 ASP .NET 4.0/C# 顺便说一句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:33:20.250

```
string finalString = Properties.Settings.Default.ConnectionString.Replace("<<DATA_SOURCE>>", server).Replace("<<INITIAL_CATALOG>>", "tempdb"); 
```

将在一行代码中完成所有操作。但它更丑 IMO 因为你必须滚动。您问题中的代码对我来说似乎更***干净***，更具可读性。

并且在一行代码中完成它根本不会帮助您的性能。无论哪种方式，它都应该编译成相同的 MSIL。我会按照你的方式保留它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:33:15.383

不确定这是否是您所追求的，但您可以将它们链接起来：

```
var finalConnString = rawConnString.Replace("<<DATA_SOURCE>>", server)
    .Replace("<<INITIAL_CATALOG>>", "tempdb"); 
```

如果您希望通过单个方法调用来完成它，我认为 .NET 没有任何原生功能。不过，您始终可以创建扩展方法。这是一个[注重性能的`ReplaceMany`实现](http://www.codeproject.com/Articles/310525/The-ReplaceMany-Method)（签名`.ReplaceMany(string[] oldValues, string[] newValues)`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T19:33:25.543

你的意思是这样的

```
string tempString=rawConnString.Replace("<<DATA_SOURCE>>", server);
sting finalstring=tempString.Replace("<<INITIAL_CATALOG>>", "tempdb"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T19:34:32.403

坦率地说，这是微不足道的。你有 90% 的代码需要：

```
string rawConnString = Properties.Settings.Default.ConnectionString;

string finalConnString = rawConnString
                            .Replace("<<DATA_SOURCE>>", server)
                            .Replace("<<INITIAL_CATALOG>>", "tempdb"); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-12T19:38:59.563

为避免使用 的两个背靠背调用`Replace`，您可以使用正则表达式。然而，这远不如原来的可读性：

```
string connString = Regex.Replace(
    rawConnString
,   "(<<DATA_SOURCE>>)|(<<INITIAL_CATALOG>>)"
,   m => m.Groups[1].Success ? server : "tempdb"
); 
```

[链接到ideone。](http://ideone.com/jMf1I)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-12T19:35:50.633

首先，String.replace 不会更改原始字符串：它会创建一个新字符串。因此，您必须将返回值分配给某些东西。所以逻辑上最简单的事情是：

```
finalstring=rawConnString.Replace("<<DATA_SOURCE>>", server);  
finalstring=finalstring.Replace("<<INITIAL_CATALOG>>", "tempdb"); 
```

请注意，对于第二次替换，您希望从第一次替换的结果开始，而不是原始字符串。

由于 String.replace 返回一个字符串，而 String.replace 接受一个字符串，您可能会发现将它们一起运行更容易：

```
finalstring=rawConnString.Replace("<<DATA_SOURCE>>", server).Replace("<<INITIAL_CATALOG>>", "tempdb"); 
```

# c - Solaris 8-10：host2ip 转换问题

> ID：12395007
> 
> 赞同：1
> 
> 时间：2012-09-12T19:30:39.080
> 
> 标签：c, unix, networking, tcp, solaris

我正在处理一个非常特殊的问题。我有一个旧编译器（gcc 2.95 或更早版本）在 solaris 8/sparc 平台上编译的代码。它在 solaris 8/sparc 上运行良好，但在 solaris 10/sparc 上崩溃。（solaris 10 应该向后兼容 solaris 8）

在调试时，我发现当应用程序尝试将主机名转换为其相应的 i/p 地址时出现问题。它使用 gethostbyname_r，后跟 inet_ntoa 来获取 ipv4 四点分号。gdb'ing 通过解决方案让我看到 gethostbyname_r 返回的 in_addr 具有表示 i/p 地址的正确整数，但 inet_ntoa 调用返回格式错误的字符串。确认它确实是 inet_ntoa 失败的一个困难是代码编写如下

```
strcpy(hostaddr, inet_ntoa(*((struct in_addr *) hostdata.h_addr))); 
```

所以从技术上讲，我看不到 inet_ntoa 返回的值。但我可以做一个

```
print (char*)inet_ntoa(*((struct in_addr *) hostdata.h_addr_list[0])) 
```

在 gdb 上查看（我认为这足够接近）并打印格式错误的 i/p 地址。例如，“0.0.”。（主机名具有有效的 i/p 地址，并且可以从该机器解析，因此以 0.0 开头的 i/p 也不是正确的值）

您可以看到将 unsafe strcpy 与 inet_ntoa 一起使用会产生一些未知，并导致分段错误。

很高兴听到经历过类似事情的人的来信，了解导致 inet_ntoa 失败的原因可能是什么。不知何故，系统正在发挥作用，我什至无法确定它是否可以解决这个问题。

所有评论将不胜感激。

约束：我无法修改代码以使其工作（否则这很容易解决）。因此，尽管知道 strcpy 是一个非常不安全的函数 wrt 段错误，并且 inet_ntoa 已被弃用，但我在这方面无能为力。

编辑：我觉得这是一个并行处理问题。我不确定，但我认为该应用程序不是多线程的。但是新的sol10机器是64核的机器。思考链的原因是 inet_ntoa 的唯一真正问题是静态缓冲区，并且代码确实在循环中进行了此调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T21:10:05.960

我发现链接器（当然还有错误的代码）是问题所在。一些超级好人，尽管拥有一个与标准库函数（inet_ntoa_r）同名的函数是个好主意。当我在将代码与库链接时尝试使用 -static 选项时，它开始抱怨用户库文件中存在此符号。一旦我从用户库中删除了该功能，它就会从崩溃中继续（到我正在尝试修复的其他一些问题。期待另一个问题:)）。希望有人觉得这很有用

# ruby-on-rails-3 - rails 3应用程序上的activeadmin格式错误

> ID：12395012
> 
> 赞同：1
> 
> 时间：2012-09-12T19:31:00.803
> 
> 标签：ruby-on-rails-3, activeadmin

我最近将一个 Rails 3 应用程序从 Mac OS X 环境迁移到了 Debian 服务器。迁移成功，应用程序正在通过 WEBrick 服务器运行，但最初随 activeadmin gem 提供的格式已从大多数视图中消失。该表单仍然可以访问和运行，但它采用默认的 html 格式。

但是[http://domainexample.com:3000/admin](http://domainexample.com:3000/admin)仍然有自定义格式，任何想法为什么会发生这种情况？

在我的故障排除中：重新安装了activeadmin

```
rails generate active_admin:install 
```

当我跑

```
rake db:migrate 
```

出现设计错误，因此删除了数据库并运行

```
rake db:create 
```

rails s 仍然可以工作并启动服务器，但是

rake db:migrate 抛出错误：

```
Mysql2::Error: Table 'admin_users' already exists 
```

更新：这解决了问题，但我不明白为什么。

必须从我的本地复制 active_admin.css 作为 active_admin.css.dup.css 文件并将其上传到 app/assets/stylesheets 中的服务器版本。出于某种原因，服务器版本正在实现命名空间。

# vb.net - VB.NET 将密钥发送到其他应用程序并关注它

> ID：12395029
> 
> 赞同：0
> 
> 时间：2012-09-12T19:32:07.717
> 
> 标签：vb.net, sendkeys

我想通过 VB.NET 将密钥发送到其他应用程序。我希望能够发送 Keydown 消息和 KeyUp 消息。但是没有关注我想要发送密钥的应用程序。

以下示例着重于发送密钥时的应用程序。我不想要那个。 [http://www.codeproject.com/Articles/18366/Sending-Keystrokes-to-another-Application-in-C](http://www.codeproject.com/Articles/18366/Sending-Keystrokes-to-another-Application-in-C)

这样做的原因是我希望能够使用 2 个游戏/窗口登录到 1 个服务器并与它们一起玩。我有宏键，所以我可以设置它们来运行这段代码。例如，当我在第一个游戏窗口上控制角色时，它将在第二个游戏窗口上移动角色。就像发送“W”以将第二个字符向前移动。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:51:37.120

在一个快速的研究中（我打赌你也会这样做），我还没有发现它是可能的。SendKey 是一种在操作系统级别而非应用程序级别模拟输入的方法。

**一种*可能的*解决方法**

也就是说，您可以实现的一种方法是创建一个虚拟机，然后在其上运行您的自动化脚本，保持主机操作系统免费。我只是害怕根据您正在运行的游戏所需的资源（3D 渲染），VM 规格可能不适合。

（因为我讨厌“你不能那样做”的答案，我只是觉得分享这个姑息疗法很有趣）

# magento - 付款方式排序顺序。不会工作

> ID：12395032
> 
> 赞同：3
> 
> 时间：2012-09-12T19:32:31.523
> 
> 标签：magento, checkout, magento-1.5

我正在尝试更改我的付款方式排序顺序，但它不起作用。

我有 2 个付款方式模块，我需要选择输出顺序，已在每个模块的 config.xml 上更改。

但是不要改变顺序。我尝试将 phtml 的调用更改为 getChildHtml('payment',true,true); 但两者都不起作用。

我没有想法，有人可以帮助我吗？

多谢你们。

# hadoop - 限制每个数据节点的非 dfs 使用

> ID：12395034
> 
> 赞同：1
> 
> 时间：2012-09-12T19:32:33.523
> 
> 标签：hadoop, hdfs

由于 Hadoop 疯狂的数据分布和管理，我面临一个奇怪的问题。由于非 DFS 的使用，我的一两个数据节点已完全填满，而其他数据节点几乎是空的。有没有办法让非 dfs 的使用更加统一？[我已经尝试过使用 dfs.datanode.du.reserved 但这也无济于事]

**问题示例：**我有 16 个数据节点，每个节点有 10 GB 空间。最初，每个节点都有大约。7 GB 可用空间。当我开始处理 5 GB 数据的作业（复制因子 = 1）时，我希望该作业能够成功完成。可惜！当我监视作业执行时，我突然看到一个节点空间不足，因为非 dfs 使用量约为 6-7 GB，然后它重试，另一个节点现在空间不足。我真的不想有更高的重试次数，因为这不会给出我正在寻找的性能指标。

知道如何解决此问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:46:57.330

听起来您的输入没有被正确拆分。您可能想要选择不同的 InputFormat 或编写自己的 InputFormat 以更好地适应您的数据集。还要确保所有节点都列在 NameNode 的从属文件中。
另一个问题可能是严重的数据倾斜——当大部分数据流向一个 reducer 时。您可能需要创建自己的分区器来解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T21:39:45.417

据我所知，您不能限制非 dfs 的使用。我建议确定究竟是什么输入文件（或其拆分）导致了问题。然后你可能会找到解决方案。
Hadoop MR 是在假设单个拆分处理可以使用单节点资源（如 RAM 或磁盘空间）完成的情况下构建的。

# html - IE7 不会完全显示我的网站

> ID：12395039
> 
> 赞同：0
> 
> 时间：2012-09-12T19:32:39.677
> 
> 标签：html, internet-explorer-7

我发现自己陷入困境，希望有人能提供帮助。

我有一个网站，如果我在任何浏览器中打开这个网站，它可以完美地找到，直到我用 IE7 打开它。IE7 打开网站，但它只加载了一半... html 源代码已成功下载，后台元素处于活动状态，它们对客户端不可见 oO 我该怎么办？？

该网站是：[http ://ambulanta-susnik.voblaku.com/](http://ambulanta-susnik.voblaku.com/)

我不想以任何方式做广告。我只是觉得这是真正向您展示问题所在的唯一方法。

尝试在 IE7 或 IE9 中打开它，文档类型为：IE7 标准。

有任何想法吗？？？我尝试了一切......不同的文档类型，xmls声明，xml声明等......

W3C HTML 验证器显示 5 个错误、5 个警告，但这些仅适用于未编码的链接...

无法使用IE7兼容模式的截图：

错误的方式：http : [//ambulanta-susnik.vobaku.com/files/wrong.png](http://ambulanta-susnik.voblaku.com/files/wrong.png)

正确的方式：http: [//ambulanta-susnik.voblaku.com/files/right.png](http://ambulanta-susnik.voblaku.com/files/right.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:37:55.640

添加`position:relative`到`#content {}`CSS

# jquery-ui - 如何使用 jQuery UI 从继承的小部件插件中添加父事件处理程序？

> ID：12395041
> 
> 赞同：1
> 
> 时间：2012-09-12T19:32:47.420
> 
> 标签：jquery-ui

我正在使用 $.widget 工厂扩展一个 jQuery UI 小部件。在这种特殊情况下，我继承了 Wijmo 的 wijlinechart。我需要从我的孩子班级中响应 wijlinechart 的“绘制”事件。

考虑一下：

```
 $.widget("bw.wijlinechartcursor", $.wijmo.wijlinechart, {
             _create: function () {
                 var self = this;
                 $.wijmo.wijlinechart.prototype._create.apply(self, arguments);

                 self.element.on("painted", function (e) {
                     alert("Got painted in child via element.on"); // Doesn't get called.
                 });

                 // This works, but blows away the client code's handler (below)
                 self.options.painted = function (e) {
                    alert("Got painted in child class via options.painted!");
                 }                   

             },

             _painted: function () {
                 alert("Got painted in child via _painted");  // Doesn't get called.
             }
         });

         $("#mywijlinechartcursor").wijlinechartcursor({
             // ... stuff...
             painted: function (e) {
                 alert("Got painted in client code");
             }
         }); 
```

那么，在由继承的父类触发的子类中处理事件的最有效方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:48:02.480

绑定到事件`on()`应该可以工作，然后该事件可能未命名`painted`。

每个小部件都有自己的事件前缀，默认为小部件的名称。如果您的基本小部件没有覆盖此默认值，则该事件将被命名为`wijlinechartpainted`.

在任何情况下，前缀都在小部件的`widgetEventPrefix`属性中可用，因此您可以编写：

```
self.element.on(self.widgetEventPrefix + "painted", function(e) {
    alert("Got painted in child via element.on");  // Should be called.
}); 
```

# flash - Flash CS5 3D 立方体中心点不起作用

> ID：12395049
> 
> 赞同：0
> 
> 时间：2012-09-12T19:33:16.753
> 
> 标签：flash, actionscript, 3d, flash-cs5, cs4

我正在使用下面的动作脚本来旋转我的立方体。

即使我将它设置在中间，我也有过从错误的中心点旋转的问题。

我知道这可以使用操作脚本来完成，只是想知道语法或任何简单的建议。

```
function cubeRotate(e:Event){
    mycube3d.rotationY = mycube3d.rotationY+1;
    mycube3d.rotationX = mycube3d.rotationX+1;

}
stage.addEventListener(Event.ENTER_FRAME,cubeRotate); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:50:00.743

如果您尝试通过拖动白色圆圈来更改 Flash IDE 中的“中心点” - 尝试将“mycube3d”（或其内容）附在另一部电影中并将其移动到内部以设置所需的中心

因为`.rotationY`将围绕其零坐标旋转您的对象并忽略 ide 的中心设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T19:02:27.890

```
setRegPoint(book, book.width / 2, book.height / 2);

function setRegPoint(obj:DisplayObjectContainer, newX:Number, NewY:Number):void {

    var bounds:Rectangle = obj.getBounds(obj.parent);
    var currentRegZ:Number = obj.z - bounds.top;

    var zOffset:Number = -50 - currentRegZ;

    obj.z += zOffset;

    for(var i:int = 0; i < obj.numChildren; i++) {
        obj.getChildAt(i).z -= zOffset;
    }
}

function cubeRotate(e:Event){    
  book.rotationY = book.rotationY+1    
  book.rotationX = book.rotationX+1    
}

stage.addEventListener(Event.ENTER_FRAME,cubeRotate) 
```

# passport.js - Mojito不认护照js

> ID：12395055
> 
> 赞同：1
> 
> 时间：2012-09-12T19:33:54.517
> 
> 标签：passport.js, mojito

我正在尝试通过执行以下操作将passportjs与Mojito一起使用：

1）安装Node JS和Mojito之后

2) 创建了一个 Mojito 应用程序

3）创建了莫吉托

4) 将护照作为依赖项包含在 Mojito 应用程序的 package.json 中

5) 运行 npm install （它将护照获取到 node_modules 目录中，该目录位于 app 目录中）

6) 在控制器的 init 操作函数中（在步骤 3 中创建的 mojit 的 controller.server.js 中），我需要护照模块（`this.passport = require('passport')`），但是 Mojito 抱怨以下错误：

```
/usr/local/lib/node_modules/mojito/node_modules/yui/yui-nodejs/yui-nodejs.js:1147
            throw (e || new Error(msg));
                        ^
Error: Cannot find module 'passport' 
```

我已经尝试将护照添加到传递给 controller.server.js 中的 YUI.add 函数的 requires 数组中，并且根据日志，mojito 调度程序正在使用护照模块调度我的 mojit/index 的一个实例，但是它还警告：`[YUI-WARN] yui: NOT loaded: passport`

关于我可能做错了什么的任何想法或在 Mojito 中使用任何非 YUI nodejs 模块的任何示例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-16T00:28:15.020

这已在以下位置解决：http: [//developer.yahoo.com/forum/Yahoo-Mojito/Using-Passport-JS-with-Mojito/1347478967128-30d8251c-4103-49dc-b555-bec39e9ebe1d](http://developer.yahoo.com/forum/Yahoo-Mojito/Using-Passport-JS-with-Mojito/1347478967128-30d8251c-4103-49dc-b555-bec39e9ebe1d)

解决方案：将 NODE_PATH 环境变量附加到：./node_modules:/opt/local/lib/node:/opt/local/lib/node_modules

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T16:47:53.180

两件事情：

*   `passport`不是 YUI 模块，因此您无法将其添加到`requires`控制器中的数组中。相反，您需要将其作为常规节点模块使用`require('passport`)`

*   mojito/yui 中存在一个已知问题（将通过 YUI 3.9.0 解决），`require()`如果您使用`mojito start`的是从 mojito cli 全局运行的本地节点模块，则无法识别本地节点模块。解决方案是不依赖全局 cli 来启动您的应用程序，而是`./node_modules/mojito/bin/mojito start`从 app 文件夹中使用。

# coffeescript - Spine JS堆栈路由-未定义的参数？

> ID：12395058
> 
> 赞同：0
> 
> 时间：2012-09-12T19:34:04.707
> 
> 标签：coffeescript, spine.js

我有一个基本的 Spine/coffeescript 应用程序，我试图通过查看其他应用程序的示例来从我设置的路由中获取参数。这是基本堆栈：

```
class Main extends Spine.Stack
  el: "#main"

  controllers:
    sources: Sources

  default: 'sources'

  routes:
    '/sources/:id': 'sources' 
```

这是源控制器：

```
class Sources extends Spine.Controller
  el: '#something'

  constructor: ->
    super

  active: (params) ->
    super
    @id = params.id
    @refresh()
    @render() 
```

但是，`params`在调用 active 时未定义。我正在导航到`/#/sources/soemthing`. 也许堆栈中的糖有些东西我不明白，但我看到的例子似乎只是以这种方式工作。谁能告诉我缺少什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:42:05.973

因此，显然堆栈总是在切换到其他控制器之一之前不带参数地初始化默认控制器，即使您直接导航到 /#/route/parameter 也是如此。添加一个什么都不做的默认控制器后，这个问题就消失了。

```
class Main extends Spine.Stack
  el: "#main"

  controllers:
    home: Home
    sources: Sources

  default: 'home'

  routes:
    '/': 'home'
    '/sources/:zooniverse_id': 'sources' 
```

PS 如果您想在 SO 上获得 Spine 帮助，请不要这样做。转到 SpineJS 谷歌组：[https ://groups.google.com/forum/#!forum/spinejs](https://groups.google.com/forum/#!forum/spinejs)

# java - 如何将算法的输出存储到新数组中

> ID：12395063
> 
> 赞同：0
> 
> 时间：2012-09-12T19:34:24.210
> 
> 标签：java, arrays, dynamic

```
value1 = 0 and value2 = 0 with weight 0

value1 = 1 and value2 = 6 with weight 5

value1 = 2 and value2 = 4 with weight 4

value1 = 3 and value2 = 3 with weight 2

value1 = 5 and value2 = 2 with weight 4

value1 = 5 and value2 = 7 with weight 6

value1 = 8 and value2 = 5 with weight 6 
```

我将如何将此输出存储到一个新数组中（value1、value2 和 weight 的不同数组）并比较它们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:41:21.437

您可以像这样创建一个包含 value1、value2 和 weight 的 bean

```
public class AlgoItem {
    private Integer value1;
    private Integer value2;
    private Integer weight;
    // Setter and getter
} 
```

并使用 Collection 来存储它（您可以使用 HashSet 或 ArrayList 来实现 Collection）

所以你的方法将返回一个 AlgoItem 的集合

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:41:52.643

您可以使用二维数组

```
 int[][] values = new int[][] {{ 0, 0, 0}, {1, 6, 5}, {2,4,4}}; 
```

第一个数组是包含 3 个值的数组数组。

这是简单而肮脏的方式。我建议制作一个包含所有 3 个值的对象，然后列出它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:55:56.193

我仍然不确定你的问题是什么。也许您应该向我们展示您尝试过的但不起作用的方法。

```
int[] value1=new int[7];
int[] value2=new int[7];
int[] weight=new int[7];

value1[0]=0
value2[0]=0;
weight[0]=0;

value1[1]=1;
value2[1]=6;
weight[1]=5;

value1[2]=2;
value2[2]=4;
weight[2]=4;

... etc ... 
```

那是你要找的吗？

# android - CursorAdapter如何回收ListView中的View？

> ID：12395066
> 
> 赞同：1
> 
> 时间：2012-09-12T19:34:35.283
> 
> 标签：android, android-listview, android-cursoradapter

我知道`BaseAdapter`有一种机制可以回收视图以`ListView`提高效率。但它`CursorAdapter`究竟是如何工作的呢？是一样的吗？我还没有真正找到任何关于此的文档。最接近的是 World of ListView 的 google IO 视频，但这并没有考虑到 CursorAdapter。任何关于此事的建议将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:42:08.127

该`getView()`方法负责回收行视图（这与非基于游标的适配器相同，只是它将行构造和数据绑定委托给两个不同的方法）并将其移动`Cursor`到正确的位置。

# android - 取消绑定可绘制对象 onPause() 导致无响应的后退导航并跳过此步骤会导致内存溢出

> ID：12395068
> 
> 赞同：6
> 
> 时间：2012-09-12T19:34:48.017
> 
> 标签：android, android-layout, android-image, android-memory

我正在使用图像设置为我所有活动的背景，但这会导致内存溢出问题并使应用程序崩溃。现在我在我的活动中的 pause() 和 Destroy() 上取消绑定我的可绘制对象，现在它在按下后退按钮时显示空白屏幕。那么如何在不使用额外内存的情况下避免这种情况。

```
 protected void onPause(){
    super.onPause();
    unbindDrawables(findViewById(R.id.login_root));
}

protected void onDestroy() {
        unbindDrawables(findViewById(R.id.login_root));
        super.onDestroy();
      }

private void unbindDrawables(View view) {
    System.gc();
    Runtime.getRuntime().gc();
    if (view.getBackground() != null) {
    view.getBackground().setCallback(null);
    }
    if (view instanceof ViewGroup) {
        for (int i = 0; i < ((ViewGroup) view).getChildCount(); i++) {
        unbindDrawables(((ViewGroup) view).getChildAt(i));
        }
    ((ViewGroup) view).removeAllViews();
    } 
```

最初我使用 android:background="@drawable/" 膨胀我的布局，这总是导致内存溢出错误，说 VM 不会让我们分配 10MB（应用程序。）现在我从该可绘制对象中获取位图而无需缩小和绑定它在运行时。现在它说VM不会让我们在不使用unbindDrawables（..）的情况下分配5MB（应用程序）显然显示的背景图像的质量已经降低但我无法理解如果我使用的是13KB 的 png 文件，JVM 如何需要 5 或 10MB 的空间来处理请求？

我已将布局语句从 onCreate() 转移到 onResume() 方法，但应用程序在按下后退按钮时再次耗尽内存。

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
    }

  protected void onResume(){
        setContentView(R.layout.home);
        Bitmap bmp;
        ImageView background = (ImageView)findViewById(R.id.iv_home_background);
        InputStream is = getResources().openRawResource(R.drawable.background);
        bmp = BitmapFactory.decodeStream(is);
        background.setImageBitmap(bmp);

         super.onResume();
    }

 protected void onPause(){
        super.onPause();
        unbindDrawables(findViewById(R.id.home_root));
    }

 private void unbindDrawables(View view) {
        System.gc();
        Runtime.getRuntime().gc();
        if (view.getBackground() != null) {
        view.getBackground().setCallback(null);
        }
        if (view instanceof ViewGroup) {
            for (int i = 0; i < ((ViewGroup) view).getChildCount(); i++) {
            unbindDrawables(((ViewGroup) view).getChildAt(i));
            }
        ((ViewGroup) view).removeAllViews();
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T09:17:09.703

我找到了解决这个问题的方法。现在我在运行时将我的位图缩放到非常小的尺寸，然后将它们存储在内部存储中。程序在运行时从存储中调用缩放的位图，如果它不存在，它会从可绘制文件夹中调用它，缩放它，将其写入存储，然后将其绑定到视图。这样，在任何时候都不需要调用 unbindDrawables 方法，并且应用程序始终保持响应。我现在唯一关心的是位图的质量，我想我需要调整缩放大小以找出质量最高的最小尺寸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-16T13:54:44.797

您正在为每个子视图调用 GC。尝试在所有解除绑定完成后仅调用一次。

```
unbindDrawables(findViewById(R.id.login_root));
System.gc(); 
```

GC 是一个很重的负载，太频繁地调用它是没有用的。事实上，如果没有泄漏，它应该是必要的。

还要记住，png 文件的大小与内存上的位图无关。这是有关该 [http://developer.android.com/training/displaying-bitmaps/index.html的更多信息](http://developer.android.com/training/displaying-bitmaps/index.html)

# jquery - 尝试根据当前 div 中应用的背景颜色更改 div 的 backgroundColor。

> ID：12395069
> 
> 赞同：2
> 
> 时间：2012-09-12T19:34:56.983
> 
> 标签：jquery, events, if-statement, background-color

大家好，我已经学习 jquery 大约 3 个月了，但我无法弄清楚这一点。

我要做的是通过单击更改 div (.box) 的背景。我知道如何单击一次，但我不知道如何在不同的单击时更改背景颜色。我想实现某种 if 语句，如果当前类的背景==red 而不是单击使新的当前类变为黄色。在此示例中，我无法将背景颜色变为黄色，并且我真的希望在第三次单击 div 时变为黄色。将来我喜欢第四次点击创建另一个背景颜色。

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">

     <html xmlns="http://www.w3.org/1999/xhtml" lang="en">
     <head>
     <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
     <style type="text/css">
        .box{
            width:200px;
            height:200px;
            background-color:green;
        }
        .red{
                width:200px;
            height:200px;
            background-color:red;
        }
        .yellow{
            width:200px;
            height:200px;
            background-color:yellow;
        }
     </style>
    <script type="text/javascript">
        $(document).ready(function(){
        $('.box').click(toRed)
        function toRed(e){
            $(this).addClass('red');
        }
        if($('this').hasClass('red')){
            $(this).removeClass('red')
            .addClass('yellow');
        }

            });

    </script>
    </head>
    <body>
   <div class="box"></div>
    </body>
    </html> 
```

所以总而言之，当我多次单击它时，我基本上试图将 div 的背景颜色更改为每次不同的不同颜色。为什么我的代码不起作用。

感谢您阅读并提前感谢您的回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:43:17.893

您是否正在寻找类似**[jsFiddle 示例](http://jsfiddle.net/j08691/FNMca/)**的内容？

```
$('.box').click(toRed)
function toRed(e) {
    if ($(this).hasClass('red')) {
        $(this).removeClass('red').addClass('yellow');
    }
    $(this).addClass('red');
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:44:08.617

从我收集到的问题中，最基本、最简单的概念是这样的：

```
$('.box').click(function()
{
    if($(this).hasClass('red'))
    {
        $(this).removeClass('red').addClass('blue');
    }
    if($(this).hasClass('blue'))
    {
        $(this).removeClass('blue').addClass('black');
    }
    if($(this).hasClass('black'))
    {
        $(this).removeClass('black').addClass('white');
    }
    if($(this).hasClass('white'))
    {
        $(this).removeClass('white').addClass('red');
    }
}); 
```

然而，让大家知道，您可以使用一些方法来使这更加精细、更加复杂，并且这样做更加智能。但我不知道您的需求有多精细，也不知道是否需要更精细的东西。它绝对不是最优化的处理方式，但它应该可以在所有地方工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:51:11.357

你可以为多种颜色做这样的事情。只需向数组中添加更多颜色类（[此处为 jsFiddle](http://jsfiddle.net/mqF8P/)）：

```
​$(function() {
    var colors = ["green","red","yellow"];

    $(".box").click(function(e) {
         var oldIndex = $.data(this, 'color-index') || 0, 
             newIndex = (oldIndex + 1 < colors.length ? oldIndex + 1 : 0);

        $(this).removeClass(colors[oldIndex]).addClass(colors[newIndex]);
        $.data(this, 'color-index', newIndex);
    });
});​ 
```

# database - 如何使用 luasql 创建 Sqlite3 数据库？

> ID：12395072
> 
> 赞同：1
> 
> 时间：2012-09-12T19:35:07.277
> 
> 标签：database, sqlite, lua, luasql

我正在尝试使用 luasql 创建一个 Sqlite3 数据库。在我`require`luasql.sqlite3 之后，如何在文件上创建数据库？

另外，我似乎找不到 luasql 的手册。它可以在任何地方使用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T07:48:27.063

如果数据库不存在，SQLLite 将自动创建它。

这是一组在 Lua 中使用它的示例函数（忽略 fh 函数，它们只是我使用的程序的内部）。

```
 require 'luasql.sqlite3'
    function opendb(dbname)
    -- Check for Settings Database and create if needed
    local db = fhGetPluginDataFileName()
    local dbenv = assert (luasql.sqlite3())
    -- connect to data source, if the file does not exist it will be created
    dbcon = assert (dbenv:connect(db))
    -- check table for page list
    checkTable(dbcon,'pagelist',
    [[CREATE TABLE pagelist(filename varchar(500), md5hash varchar(32),UNIQUE (filename))
    ]])
    -- create table for settings
    checkTable(dbcon,'settings',
    [[CREATE TABLE settings(key varchar(20), directory varchar(500), 
               host varchar(500), folder varchar(50), userid varchar(50), password varchar(50), UNIQUE (key))
    ]])
    return dbenv,dbcon
end
function checkTable(dbcon,table,createString)
    local sql = string.format([[SELECT count(name) as count FROM sqlite_master WHERE type='table' AND name='%s']],table)
    local cur = assert(dbcon:execute(sql))
    local rowcount = cur:fetch (row, "a")
    cur:close()
    if tonumber(rowcount) == 0 then
        -- Table not found create it
        res,err = assert(dbcon:execute(createString))
    end
end
function closedb(dbenv,dbcon)
    dbcon:close()
    dbenv:close()
end
function loadSettings(dbcon)
    local sql = [[SELECT * FROM settings]]
    local cur,err = assert(dbcon:execute(sql))
    local row = cur:fetch({},'a')
    cur:close()
    if row then
        return row
    else
        -- return default values
        return {
            directory = fhGetContextInfo('CI_PROJECT_PUBLIC_FOLDER')..'\\FH Website',
            host = 'websitehost',
            folder = '/',
            userid = 'user',
            password = 'password',
            new = 'yes'
        }
    end
end
function saveSettings(dbcon,settings)
    -- Check for Settings
    if settings.new == 'yes' then
        -- Create
        sql = string.format([[insert into settings (directory, host, folder, userid, password) Values('%s','%s','%s','%s','%s')]],settings.directory,settings.host,settings.folder,settings.userid,settings.password)
    else
        -- Update
        sql = string.format([[update settings set directory = '%s', host = '%s',folder = '%s',userid = '%s', password = '%s']],settings.directory,settings.host,settings.folder,settings.userid,settings.password)
    end
    local res = assert(dbcon:execute(sql))
end 
```

# php - 在没有根访问权限的情况下安装 Zend Framework 2？

> ID：12395073
> 
> 赞同：0
> 
> 时间：2012-09-12T19:35:19.700
> 
> 标签：php, zend-framework2

我知道对于经验丰富的 ZF 开发人员来说，这可能听起来很愚蠢，但请多多包涵。让我们发挥一下我们的想象力，假设我在 Linux 服务器上有一个托管包，它不允许我访问我的 htdocs 文件夹（或 www 或 public_html 文件夹，无论哪个）之外的任何文件夹。

我知道所有说明都建议我将这个框架安装在 htdocs 文件夹之外以确保安全，并在 PHP 配置中设置一个包含路径，以自动让我访问所有 PHP 文件中的这个框架。

但是，鉴于上述限制，这是不可能的。我的问题是：

1.  至于框架的运行方式，我*可以*在我的 htdocs 文件夹中安装这个框架，例如，将它放在与我的应用程序相同的目录级别的自己的专用文件夹中，并禁止使用 .htaccess 对其进行公共访问吗？
2.  如果我将 Apache 设置为拒绝对该文件夹及其内容的所有非本地请求，这种方法的安全性如何？
3.  我在脚本中包含哪些核心文件以允许我访问框架？

很抱歉问题的崩溃列表，但我对 Zend 框架的经验几乎为零。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:50:37.543

您可以将整个[Zend 库](http://www.zend.com/en/community/downloads)上传到您的服务器。最好将它放在您的 htdocs 文件夹之外。然后在代码中使用这一行：

```
$paths = array( '/path/to/Zend', get_include_path());
set_include_path(implode(PATH_SEPARATOR, $paths)); 
```

然后你可以像平常一样使用所有的zend：

```
require_once 'Zend/Controller/Front.php';
Zend_Controller_Front::run('../application/controllers'); 
```

# data-structures - 有没有在 Erlang 中实现高效数组类型的模块？

> ID：12395074
> 
> 赞同：6
> 
> 时间：2012-09-12T19:35:33.170
> 
> 标签：data-structures, clojure, erlang

我一直在寻找 Erlang 中具有以下特征的数组类型。

```
append(vector(), term())        O(1) 
nth(Idx, vector())              O(1)
set(Idx, vector(), term())      O(1)
insert(Idx, vector(), term())   O(N)
remove(Idx, vector())           O(N) 
```

我通常为此目的使用元组，但性能特征不是我想要的大 N。我的测试显示以下性能特征......

```
erlang:append_element/2          O(N).
erlang:setelement/3              O(N). 
```

我已经开始基于 clojure.lang.PersistentVector 实现的模块，但如果它已经完成，我不会重新发明轮子。

**编辑：**

对于那些感兴趣的人，我已经完成了[vector.erl ... 使用与](http://pastie.org/4715345)[clojure.lang.PersistentVector](https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/PersistentVector.java)相同的算法。它具有与数组模块相似的性能特征，但在追加时具有稍好的常数因子。

以下测试在每个间隔附加 10000 个项目，然后在随机索引处进行 10000 次查找和 10000 次更新。所有操作都接近 O(1)。内部元组中的时间以微秒为单位。

```
3> seq_perf:test(vector, 100000, 10).
{2685854,
 {ok,[{100000,{66966,88437,124376}},
      {200000,{66928,76882,125677}},
      {300000,{68030,76506,116753}},
      {400000,{72429,76852,118263}},
      {500000,{66296,84967,119828}},
      {600000,{66953,78155,116984}},
      {700000,{65996,77815,138046}},
      {800000,{67801,78455,118191}},
      {900000,{69489,77882,114886}},
      {1000000,{67444,80079,118428}}]}}
4> seq_perf:test(array, 100000, 10). 
{2948361,
 {ok,[{100000,{105482,72841,108828}},
      {200000,{123655,78898,124092}},
      {300000,{110023,76130,106806}},
      {400000,{104126,73830,119640}},
      {500000,{104771,72593,110157}},
      {600000,{107306,72543,109713}},
      {700000,{122066,73340,110662}},
      {800000,{105853,72841,110618}},
      {900000,{105267,73090,106529}},
      {1000000,{103445,73206,109939}}]}} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T21:36:45.720

这些属性在纯功能实现中是不可能的。数组模块 (http://www.erlang.org/doc/man/array.html) 是一个很好的折衷方案，但如果您需要 O(1) 查找和更新，则必须改用 ETS 表.

# hibernate - 通过 http 休眠

> ID：12395080
> 
> 赞同：1
> 
> 时间：2012-09-12T19:35:48.373
> 
> 标签：hibernate, jdbc

我需要将 java 对象保存在数据库中并使用 eclipse rcp 应用程序检索它。有没有办法在没有 jdbc 和 http 的情况下使用 hibernate 来实现这一点？rcp 客户端处于分布式环境中，防火墙可能是一个问题。请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:52:08.150

您可以构建两种应用程序

*   基于rcp的客户端
*   基于休眠的服务器。

客户端和服务器之间的通信可以基于 http 使用类似的技术

*   休息
*   肥皂
*   自己的格式
*   JSON
*   还有更多

# php - PHP嵌套循环，其中值是数组下一级的键

> ID：12395084
> 
> 赞同：1
> 
> 时间：2012-09-12T19:36:16.670
> 
> 标签：php, multidimensional-array, foreach, nested

我对 PHP 比较陌生，希望你能帮我解决我的问题。我正在从数据库中选择数据到一个数组中以进行计时。最终，我想计算给定客户在项目上花费的总小时数。

这是填充多维数组的代码：...

```
foreach ($record as $data) {  
  $mArray = array();  
  $name = $data['user'];  
  $customer = $data['customer'];  
  $project = $data['project'];  
  $hours = $data['hours'];  

  $mArray[$name][$customer][$project] += $hours;  
} 
```

...

我现在想遍历 $mArray 以生成这样的 xml 文件：

...

```
foreach ($mArray as $username) {
  foreach ($mArray[$username] as $customerName) {
    foreach ($mArray[$username][$customerName] as $project ) {
        echo '<'.$username.'><'.$customerName.'><'.$project.'><hours>'.
           $mArray[$username][$customerName][$project].'</hours></'.$project.'>
           </'.$customerName.'></'.$username.'>';
    }
  }
} 
```

这个嵌套的 foreach 不起作用。有人可以给我一些关于如何遍历这个结构的提示吗？感谢您的阅读！

更新：根据我目前收到的评论（感谢大家），我有：

```
foreach ($mArray as $userKey => $username) {
  foreach ($mArray[$userKey] as $customerKey => $customerName) {
    foreach ($mArray[$userKey][$customerKey] as $projectKey => $projectName) {
      echo '<name>'.$userKey.'</name>';
      echo "\n";
      echo '<customerName>'.$customerKey.'</customerName>';
      echo "\n";
      echo '<projectName>'.$projectKey.'</projectName>';
      echo "\n";
      echo '<hours>'.$mArray[$userKey][$customerKey][$projectKey].'</hours>';
      echo "\n";
    }
  }
} 
```

现在只提供一次迭代（一行数据）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T19:38:15.593

Foreach 语法是`foreach($array as $value)`. 您正在尝试将这些值用作数组键，但它们不是值 - 它们是子数组。你想要的是：

```
foreach($mArray as $username) {
   foreach($username as ...) 
```

或者

```
foreach($mArray as $key => $user) {
   foreach($mArray[$key] as ...) 
```

# css - 动态高度不适用于绝对位置

> ID：12395085
> 
> 赞同：3
> 
> 时间：2012-09-12T19:36:22.503
> 
> 标签：css, dynamic, background, position, absolute

我正在尝试完成我的主页设计，但是我在让内容 div 的背景颜色流过 div 时遇到了一些麻烦。

```
<div id="container">
    <div id="content">
        <div id="headerInfo">
            <div class="leftLocation">
                <p>golden, co</p>
            </div>
            <div class="rightInfo">
                <span class="text">
                    <a href="about.php">about us</a>
                    <a href="contact.php">contact</a>
                    <span class="phone">XXX-XXX-XXXX</span>
                </span>
            </div>
            <div class="rightPic">
                <img src="images/facebook.png" alt="facebook" title="facebook" />
                <img src="images/yelp.png" alt="yelp" title="yelp" />
            </div>
            <div class="clear"></div>
        </div>
        <div id="homeHead">
            <img class="logo" src="images/logo.png" alt="logo" />
            <img class="paintSplash" src="images/paintSplash.png" alt="paint" />
            <span id="nav">
                <a href="classes">classes</a>
                <a href="classes">calendar</a>
                <a href="classes">gallery</a>
                <a href="classes">FAQ</a>
                <a href="classes">private events</a>
                <a href="classes">large-scale</a>
            </span>
            <span id="word">
                ...Paint
            </span>
                <img src="images/homeSlide1.png" class="pic1" alt="pic1"/>
                <img src="images/homeSlide4.png" class="pic1" alt="pic2"/>
                <img src="images/homeSlide7.png" class="pic1" alt="pic3"/>

                <img src="images/homeSlide2.png" class="pic2" alt="pic4"/>
                <img src="images/homeSlide5.png" class="pic2" alt="pic5"/>
                <img src="images/homeSlide8.png" class="pic2" alt="pic6"/>

                <img src="images/homeSlide3.png" class="pic3" alt="pic7"/>
                <img src="images/homeSlide6.png" class="pic3" alt="pic8"/>
                <img src="images/homeSlide9.png" class="pic3" alt="pic9"/>
            <div id="step1">
                <span class="easy">Easy as</span>
                <span class="part">Sign Up</span>
                <span class="num">1.</span>
                <p style="padding-bottom:5px;">Pick your favorite class and <a href="#">REGISTER ONLINE</a>.</p>
                <p class="bottom"><a href="#">Classes</a> Starting at only $25!</p>
            </div>
            <div id="step2">
                <span class="part">Show Up</span>
                <span class="num">2.</span>
                <p style="padding-bottom:5px;">We supply everything! Check out the <a href="#">FAQ</a>.</p>
                <p class="bottom">Limited Seating, <a href="#">Register Now!</a></p>
            </div>
            <div id="step3">
                <span class="part2">Enjoy!</span>
                <span class="num2">3.</span>
                <img class="wine" src="images/wine.png" alt="wine" />
                <p style="padding-bottom:10px;">Sip your drink, paint, play &amp; have fun.</p>
                <p class="bottom">See our <a href="#">Gallery</a> for results!</p>
            </div>
        </div><!--End Header Info -->
        <div id="bodyInfo">
            <div id="left">
                <p>
                    <span class="bloodHeader">Welcome</span> to Art on the Brix where anyone can unleash their inner artist amidst friends, family and co-workers. Quickly <a href="#">Sign-Up</a> for a class or take your time to enjoy our website!
                </p>
                <p id="midLeft">
                    <span class="blueHeader">NO TALENT OR EXPERIENCE IS NECESSARY!</span>Colorful Variety of Themed Classes &#8226; Open Studio Times &#8226; Private Parties &#8226; Corporate Team-Builds &#8226; Charity Events
                </p>
                <p>
                    Our casual yet upscale studio is in the heaert of historic Golden, Colorado. Enjoy painting, crafts, wine or beer, music and fun surprises in our low-stress art classes. Our local artists guie all of the <a href="#">CLASSES</a> with easy-to-folow, step-by-step instruction on how to create the featured piece. The experience is playful and light-hearted encouraging you to just follow along or release inhibitions and go outside your lines. Create, taste and play!
                </p>
            </div>
            <div id="right">
            </div>
        </div><!-- End bodyInfo -->
    </div>
</div> 
```

CSS：

```
#container{
width:100%;
height:100%;
}
#content{
width:900px;
height:100%;
margin:0px auto;
background-color:#FFF;
-moz-border-radius: 10px;
-webkit-border-radius: 10px;
border-radius: 10px; /* future proofing */
-khtml-border-radius: 10px; /* for old Konqueror browsers */
}
/*Header Info*/
#headerInfo{
position: relative;
}
.leftLocation{
float:left;
font-family: HelveticaNeueStd;
font-size:14px;
color:#4d2c0d;
height:30px;
margin-top:10px;
}
.leftLocation p{
padding-right:5px;
}
.rightInfo{
position: relative;
float:right;
width:360px;
}
.rightInfo a{
color:#3397bf;
text-decoration: none;
font-size:14px;
font-family: HelveticaNeueStd;
padding-right:10px;
}
.rightInfo a:hover{
color:#e11b6b;
}
span.text{
position:absolute;
top:-7px;
}
span.phone{
font-family: Lavanderia;
font-size:30px;
color:#4d2c0d;
}
.rightPic{
position: absolute;
right:0px;
}
/*Home Head*/
#homeHead{
background-image:url('../images/homeHead.png');
width:900px;
height:573px;
position:relative;
clear: both;
}
.logo{
position: absolute;
top:-30px;
left:10px;
}
.paintSplash{
position: absolute;
left:350px;
top:-35px;
height:105px;
}
#nav{
position: absolute;
left:245px;
top:70px;
}
#nav a{
color:#FFF;
font-size: 16px;
font-family: HelveticaNeueStd;
padding-right:10px;
text-decoration: none;
}
#nav a:hover{
color:#e11b6b;
}
#word{
position: absolute;
top:90px;
left:235px;
padding:10px;
color:#3397bf;
font-family: Lavanderia;
font-size:35px;
}
#pic1{

}
.pic1{
position:absolute;
top:249px;
left:160px;
width:140px;
height:174px;
}
#pic2{
transform: rotate(7deg);
-ms-transform: rotate(7deg); /* IE 9 */
-webkit-transform: rotate(7deg); /* Safari and Chrome */
-o-transform: rotate(7deg); /* Opera */
-moz-transform: rotate(7deg); /* Firefox */
}
.pic2{
position:absolute;
top:263px;
left:424px;
width:102px;
height:150px;
transform: rotate(7deg);
-ms-transform: rotate(7deg); /* IE 9 */
-webkit-transform: rotate(7deg); /* Safari and Chrome */
-o-transform: rotate(7deg); /* Opera */
-moz-transform: rotate(7deg); /* Firefox */
}
#pic3{
transform: rotate(-13deg);
-ms-transform: rotate(-13deg); /* IE 9 */
-webkit-transform: rotate(-13deg); /* Safari and Chrome */
-o-transform: rotate(-13deg); /* Opera */
-moz-transform: rotate(-13deg); /* Firefox */
}
.pic3{
position:absolute;
top:252px;
left:641px;
width:121px;
height:173px;
transform: rotate(-13deg);
-ms-transform: rotate(-13deg); /* IE 9 */
-webkit-transform: rotate(-13deg); /* Safari and Chrome */
-o-transform: rotate(-13deg); /* Opera */
-moz-transform: rotate(-13deg); /* Firefox */
}
#step1{
position:absolute;
font-family: Helvetica;
top:500px;
left:100px;
width:200px;
height:60px;
padding:15px;
text-align: center;
background-color:#f0deba;
-webkit-box-shadow: 0 8px 6px -6px black;
   -moz-box-shadow: 0 8px 6px -6px black;
        box-shadow: 0 8px 6px -6px black;
-moz-border-radius: 10px;
-webkit-border-radius: 10px;
border-radius: 10px; /* future proofing */
-khtml-border-radius: 10px; /* for old Konqueror browsers */
}
#step1 a{
color:#e11b6b;
}
.bottom{
font-family: HelveticaNeueStd-Italic;
color:#3397bf;
}
.bottom a{
color:#e11b6b;
}
.easy{
font-family: Helvetica;
font-size:14px;
position: absolute;
color:#FFF;
top:-25px;
left:-30px;
}
.num{
font-family: HelveticaNeueStd;
font-size:45px;
color:#FFF;
position: absolute;
top:-45px;
left:20px;
}
.part{
font-family: Lavanderia;
color:#FFF;
font-size:40px;
position: absolute;
top:-45px;
left:60px;
}
.num2{
font-family: HelveticaNeueStd;
font-size:45px;
color:#FFF;
position: absolute;
top:-45px;
left:60px;
}
.part2{
font-family: Lavanderia;
color:#FFF;
font-size:40px;
position: absolute;
top:-45px;
left:100px;
}
#step2{
position:absolute;
font-family: Helvetica;
top:500px;
left:345px;
width:200px;
height:60px;
padding:15px;
text-align: center;
background-color:#f0deba;
-webkit-box-shadow: 0 8px 6px -6px black;
   -moz-box-shadow: 0 8px 6px -6px black;
        box-shadow: 0 8px 6px -6px black;
-moz-border-radius: 10px;
-webkit-border-radius: 10px;
border-radius: 10px; /* future proofing */
-khtml-border-radius: 10px; /* for old Konqueror browsers */
}
#step2 a{
color:#e11b6b;
}
#step3{
position:absolute;
font-family: Helvetica;
top:500px;
left:590px;
width:200px;
height:60px;
padding:10px;
padding-bottom:20px;
padding-left:50px;
text-align: center;
background-color:#f0deba;
-webkit-box-shadow: 0 8px 6px -6px black;
   -moz-box-shadow: 0 8px 6px -6px black;
        box-shadow: 0 8px 6px -6px black;
-moz-border-radius: 10px;
-webkit-border-radius: 10px;
border-radius: 10px; /* future proofing */
-khtml-border-radius: 10px; /* for old Konqueror browsers */
}
#step3 a{
color:#e11b6b;
}
.wine{
position:absolute;
top:-30px;
left:5px;
}
/*bodyInfo*/
#holder{
width:900px;
height:573px;
}
#bodyInfo{
width:100%;
}
#left{
width:450px;
float:left;
}
#right{
width:450px;
float:left;
} 
```

一切都包含在容器和内容 div 中，所以我认为当我在 homeHead 之后添加内容时，白色背景会像往常一样向下扩展......不是它只是停留在那里的情况。（看截图）如果有人有解决这个问题的想法，我将不胜感激！

![问题](../Images/dce1b7525ef32b8a719fee603cf2cf63.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T22:42:21.173

问题可能与您的 div 中浮出***的***`"left"`和div 有关。您需要在 div 中包含另一个 div作为最后一个块元素。`"right"`*`bodyInfo``style="clear: both;"``bodyInfo`*

 *有关使用浮动的更多布局，请参阅此内容：[CSS 设计模式 - 浮动和清除](http://cssdesignpatterns.com/Chapter%2007%20-%20POSITIONING1/Float%20and%20Clear/example.html)

[这](http://jsfiddle.net/t53TY/)是您在 jsFiddle 上的情况的通用模型。如果用 删除 div，则div`style="clear: both"`周围的边框`bodyInfo`不再环绕两个浮动 div。

```
<div id="bodyInfo">
    <div id="left">
        <p>
            <span class="bloodHeader">Welcome</span> to Art on the Brix where anyone can unleash their inner artist amidst friends, family and co-workers. Quickly <a href="#">Sign-Up</a> for a class or take your time to enjoy our website!
        </p>
        <p id="midLeft">
            <span class="blueHeader">NO TALENT OR EXPERIENCE IS NECESSARY!</span>Colorful Variety of Themed Classes &#8226; Open Studio Times &#8226; Private Parties &#8226; Corporate Team-Builds &#8226; Charity Events
        </p>
        <p>
           Our casual yet upscale studio is in the heaert of historic Golden, Colorado. Enjoy painting, crafts, wine or beer, music and fun surprises in our low-stress art classes. Our local artists guie all of the <a href="#">CLASSES</a> with easy-to-folow, step-by-step instruction on how to create the featured piece. The experience is playful and light-hearted encouraging you to just follow along or release inhibitions and go outside your lines. Create, taste and play!
        </p>
    </div>
    <div id="right"></div>
    <div sytle="clear: both;"></div>
</div><!-- End bodyInfo --> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:45:48.843

[Absolutely positioned elements do not expand their parents as they grow](http://jsbin.com/amahih/1/edit). The positioning of your content container should be static or relative.

[Here's some info for you on document flow](http://www.rainbodesign.com/pub/css/css-positioning-2.html); this is an important concept to understand.*

# mysql - 需要帮助优化连接

> ID：12395086
> 
> 赞同：0
> 
> 时间：2012-09-12T19:36:23.927
> 
> 标签：mysql, optimization, join

谁能帮我优化这个查询？需要 15 秒。如果我将 WHERE 子句移动到连接本身，结果仍然相同。

```
SELECT
`users`.`employeeID` as `username`,
`users`.`firstName` as `fname`,
`users`.`lastName` as `lname`
FROM `enrollment`
INNER JOIN `users` ON `enrollment`.`employeeID` = `users`.`employeeID`
WHERE `enrollment`.`number` = [int]
AND
`enrollment`.`term` = [int]
AND
(
`enrollment`.`status` = 'E'
OR
`enrollment`.`status` = 'M'
)
ORDER BY    
`users`.`lastName` ASC,
`users`.`firstName` ASC; 
```

只要这样：

```
SELECT
`users`.`employeeID` as `username`,
`users`.`firstName` as `fname`,
`users`.`lastName` as `lname`
FROM `enrollment`
INNER JOIN
`users` ON `enrollment`.`employeeID` = `users`.`employeeID`
AND
`enrollment`.`number` = [int]
AND
`enrollment`.`term` = [int]
AND
(
`enrollment`.`status` = 'E'
OR
`enrollment`.`status` = 'M'
)
ORDER BY    
`users`.`lastName` ASC,
`users`.`firstName` ASC; 
```

这是解释结果

```
id  select_type table   type    possible_keys   key key_len ref rows    Extra
1   SIMPLE  users   ALL PRIMARY NULL    NULL    NULL    52925   Using filesort
1   SIMPLE  enrollment  ref employeeID,number_term  employeeID  9   ezlrn.users.employeeID  2   Using where 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:56:17.573

您需要`enrollment`包含（至少部分）`number`、、`term`和的表上的索引`status`。您还需要一个`employeeID`索引`employees`（如果它还不是主键，它应该是）。

```
CREATE INDEX idx1 ON enrollment (number, term, status);
CREATE INDEX idx2 ON users (employeeID); // if needed 
```

这将确保 mysql`enrollment`首先使用索引在表中查找，然后再加入`users`表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:48:27.443

为了详尽地回答，我们需要检查您获得的查询计划，`EXPLAIN SELECT...(your query)`以及已经存在的索引结构。

在您还没有索引的假设中（可能除了`PRIMARY KEY`那些），这就是问题所在，让我们看看如何制作一些东西（可能进一步改进）：

```
SELECT
    `users`.`employeeID` as `username`,
    `users`.`firstName` as `fname`,
    `users`.`lastName` as `lname`
FROM `enrollment`
    INNER JOIN `users` ON `enrollment`.`employeeID` = `users`.`employeeID`
WHERE `enrollment`.`number` = [int]
    AND
    `enrollment`.`term` = [int]
    AND
    (
        `enrollment`.`status` = 'E'
    OR
    `enrollment`.`status` = 'M'
    )
    ORDER BY    
        `users`.`lastName` ASC,
        `users`.`firstName` ASC; 
```

你有一个`JOIN`从句 between `enrollment.employeeID`and `users.employeeID`。

所以你需要的前几个索引就在那里：

```
-- CREATE INDEX enrollment_ndx ON enrollment(employeeID); -- wait on this one
CREATE INDEX users_ndx ON users(employeeID); 
```

然后该`WHERE`子句包含更多可以有用索引的条件。所以最终的索引`enrollment`是：

```
CREATE INDEX enrollment_ndx ON enrollment(employeeID, number, term, status); 
```

尝试在注册和用户上创建索引，然后重试（发布查询计划）。

注意：您也可以`enrollment.status IN ('M', 'E')`在查询中使用语法来简化它。

# c# - 将 IList 绑定到 DependencyProperty

> ID：12395088
> 
> 赞同：0
> 
> 时间：2012-09-12T19:36:29.430
> 
> 标签：c#, xaml, dependency-properties

我创建了自己的自定义控件，它`DependencyProperty` `ItemsSource`根据绑定列表中提供的项目数量动态创建按钮。创建 XAML 时，我应该能够通过声明将列表绑定到我的自定义控件

```
ItemsSource="{Binding ListOfData}". 
```

我似乎无法让它显示按钮或显示，数据是否没有正确绑定到列表？

* * *

```
 [TemplateVisualState(GroupName = "Button0States", Name = "Button0Visible")]
         [TemplateVisualState(GroupName = "Button0States", Name = "Button0NotVisible")]
         [TemplateVisualState(GroupName = "Button1States", Name = "Button1Visible")]
         [TemplateVisualState(GroupName = "Button1States", Name = "Button1NotVisible")]
         [TemplateVisualState(GroupName = "Button2States", Name = "Button2Visible")]
         [TemplateVisualState(GroupName = "Button2States", Name = "Button2NotVisible")]
         [TemplateVisualState(GroupName = "Button3States", Name = "Button3Visible")]
         [TemplateVisualState(GroupName = "Button3States", Name = "Button3NotVisible")]
         [TemplateVisualState(GroupName = "Button4States", Name = "Button4Visible")]
         [TemplateVisualState(GroupName = "Button4States", Name = "Button4NotVisible")]
         [TemplateVisualState(GroupName = "Button5States", Name = "Button5Visible")]
         [TemplateVisualState(GroupName = "Button5States", Name = "Button5NotVisible")]
         [TemplateVisualState(GroupName = "Button6States", Name = "Button6Visible")]
         [TemplateVisualState(GroupName = "Button6States", Name = "Button6NotVisible")]
         [TemplateVisualState(GroupName = "Button7States", Name = "Button7Visible")]
         [TemplateVisualState(GroupName = "Button7States", Name = "Button7NotVisible")]
         [TemplatePart(Name = "btn0", Type = typeof(Control))]
         [TemplatePart(Name = "btn7", Type = typeof(Control))]
         [TemplatePart(Name = "btnMore", Type = typeof(Control))]
         [TemplateVisualState(GroupName = "MoreButtonStates", Name = "MoreButtonVisible")]
         [TemplateVisualState(GroupName = "MoreButtonStates", Name = "MoreButtonNotVisible")]
         public class FourByTwoGrid : Control
         {

        public FourByTwoGrid()
        {
            this.DefaultStyleKey = typeof(FourByTwoGrid);

            this.Loaded += new RoutedEventHandler(FourByTwoGrid_Loaded); 
            this.GotFocus += new RoutedEventHandler(FourByTwoGrid_GotFocus);
        }

        public IList ItemsSource
        {
            get {  return GetValue(ItemsSourceProperty) as IList; }
            set { Logger.Log("Value set"); SetValue(ItemsSourceProperty, value); }
        }

        /// <summary>
        /// Identifies the ItemsSource dependency property.
        /// </summary>
        public static readonly DependencyProperty ItemsSourceProperty =
            DependencyProperty.Register(
                "ItemsSource",
                typeof(IList),
                typeof(FourByTwoGrid),
                new PropertyMetadata(null, OnItemsSourcePropertyChanged));

        /// <summary>
        /// ItemsSourceProperty property changed handler.
        /// </summary>
        /// <param name="d">FourByTwoGrid that changed its ItemsSource.</param>
        /// <param name="e">Event arguments.</param>
        private static void OnItemsSourcePropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            FourByTwoGrid source = d as FourByTwoGrid;          

            if (source != null)
            {
                source.AttemptToBuildGridUi();
            }
        }

   #region public DataTemplate ItemTemplate
        /// <summary>
        /// Gets or sets an ItemTemplate to be used in the buttons. 
        /// </summary>
        public DataTemplate ItemTemplate
        {
            get { return GetValue(ItemTemplateProperty) as DataTemplate; }
            set { SetValue(ItemTemplateProperty, value); }
        }

        /// <summary>
        /// Identifies the ItemTemplate dependency property.
        /// </summary>
        public static readonly DependencyProperty ItemTemplateProperty =
            DependencyProperty.Register(
                "ItemTemplate",
                typeof(DataTemplate),
                typeof(FourByTwoGrid),
                new PropertyMetadata(null, OnItemTemplatePropertyChanged));

        /// <summary>
        /// ItemTemplateProperty property changed handler.
        /// </summary>
        /// <param name="d">FourByTwoGrid that changed its ItemTemplate.</param>
        /// <param name="e">Event arguments.</param>
        private static void OnItemTemplatePropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            FourByTwoGrid source = d as FourByTwoGrid;

            if (source != null)
            {
                source.AttemptToBuildGridUi();
            }
        }

        /// <summary>
        /// Update the visual state of buttons based on whether or not an item exists. 
        /// </summary>
        private void UpdateVisualState()
        {
            // set buttons to visible if there's a corresponding item
            var lastI = 0;

            if (ItemsSource != null)
            {
                for (int i = 0; i < ItemsSource.Count && i < 8; i++)
                {
                    lastI = i;
                    VisualStateManager.GoToState(this, "Button" + i + "Visible", false);
                    Logger.Log("Visible" + i);
                }
                lastI++;
            }

            // set buttons to nto visible for all buttons that don't have a corresponding item
           for (int i = lastI; i < 8; i++)
            {
            }

            if (ShouldMoreButtonBeVisible)
            {
                VisualStateManager.GoToState(this, "MoreButtonVisible", false);
            }
            else
            {
                VisualStateManager.GoToState(this, "MoreButtonNotVisible", false);
            }
        }

        /// <summary>
        /// Attempt to populate the UI based on control properties. 
        /// </summary>
        private void AttemptToBuildGridUi()
        {
            UpdateVisualState();

            UpdateItemsSourceBindings();
        }

        /// <summary>
        /// It seems that the TemplateParent bindings aren't automatically updated. 
        /// We'll invoke Update on each of these. 
        /// </summary>
        private void UpdateItemsSourceBindings()
        {

            if (ItemsSource == null)
                return;

            if ((ItemsSource.Count > 0) && !ItemsSource[0].Equals(Item0))
                Item0 = ItemsSource[0];

            if ((ItemsSource.Count > 1) && !ItemsSource[1].Equals(Item1))
                Item1 = ItemsSource[1];

            if ((ItemsSource.Count > 2) && !ItemsSource[2].Equals(Item2))
                Item2 = ItemsSource[2];

            if ((ItemsSource.Count > 3) && !ItemsSource[3].Equals(Item3))
                Item3 = ItemsSource[3];

            if ((ItemsSource.Count > 4) && !ItemsSource[4].Equals(Item4))
                Item4 = ItemsSource[4];

            if ((ItemsSource.Count > 5) && !ItemsSource[5].Equals(Item5))
                Item5 = ItemsSource[5];

            if ((ItemsSource.Count > 6) && !ItemsSource[6].Equals(Item6))
                Item6 = ItemsSource[6];

            if ((ItemsSource.Count > 7) && !ItemsSource[7].Equals(Item7))
                Item7 = ItemsSource[7];

            Logger.Log("Layout updated");
            ItemsCountText = ItemsSource.Count.ToString(CultureInfo.InvariantCulture);
        }

#region public object Item0
        /// <summary>
        /// Gets or sets item #0.
        /// </summary>
        public object Item0
        {
            get { return GetValue(Item0Property) as object; }
            set { SetValue(Item0Property, value); }
        }

        /// <summary>
        /// Identifies the Item0 dependency property.
        /// </summary>
        public static readonly DependencyProperty Item0Property =
            DependencyProperty.Register(
                "Item0",
                typeof(object),
                typeof(FourByTwoGrid),
                new PropertyMetadata(null));

        #endregion public object Item0

        #region public object Item1
        /// <summary>
        /// Gets or sets item #1.
        /// </summary>
        public object Item1
        {
            get { return GetValue(Item1Property) as object; }
            set { SetValue(Item1Property, value); }
        }

        /// <summary>
        /// Identifies the Item1 dependency property.
        /// </summary>
        public static readonly DependencyProperty Item1Property =
            DependencyProperty.Register(
                "Item1",
                typeof(object),
                typeof(FourByTwoGrid),
                new PropertyMetadata(null));

        #endregion public object Item1

        #region public object Item2
        /// <summary>
        /// Gets or sets item #2.
        /// </summary>
        public object Item2
        {
            get { return GetValue(Item2Property) as object; }
            set { SetValue(Item2Property, value); }
        }

        /// <summary>
        /// Identifies the Item2 dependency property.
        /// </summary>
        public static readonly DependencyProperty Item2Property =
            DependencyProperty.Register(
                "Item2",
                typeof(object),
                typeof(FourByTwoGrid),
                new PropertyMetadata(null));

        #endregion public object Item2

        #region public object Item3
        /// <summary>
        /// Gets or sets item #3.
        /// </summary>
        public object Item3
        {
            get { return GetValue(Item3Property) as object; }
            set { SetValue(Item3Property, value); }
        }

        /// <summary>
        /// Identifies the Item3 dependency property.
        /// </summary>
        public static readonly DependencyProperty Item3Property =
            DependencyProperty.Register(
                "Item3",
                typeof(object),
                typeof(FourByTwoGrid),
                new PropertyMetadata(null));

        #endregion public object Item3

        #region public object Item4
        /// <summary>
        /// Gets or sets item #4.
        /// </summary>
        public object Item4
        {
            get { return GetValue(Item4Property) as object; }
            set { SetValue(Item4Property, value); }
        }

        /// <summary>
        /// Identifies the Item4 dependency property.
        /// </summary>
        public static readonly DependencyProperty Item4Property =
            DependencyProperty.Register(
                "Item4",
                typeof(object),
                typeof(FourByTwoGrid),
                new PropertyMetadata(null));

        #endregion public object Item4

        #region public object Item5
        /// <summary>
        /// Gets or sets item #5.
        /// </summary>
        public object Item5
        {
            get { return GetValue(Item5Property) as object; }
            set { SetValue(Item5Property, value); }
        }

        /// <summary>
        /// Identifies the Item5 dependency property.
        /// </summary>
        public static readonly DependencyProperty Item5Property =
            DependencyProperty.Register(
                "Item5",
                typeof(object),
                typeof(FourByTwoGrid),
                new PropertyMetadata(null));

        #endregion public object Item5

        #region public object Item6
        /// <summary>
        /// Gets or sets item #6.
        /// </summary>
        public object Item6
        {
            get { return GetValue(Item6Property) as object; }
            set { SetValue(Item6Property, value); }
        }

        /// <summary>
        /// Identifies the Item6 dependency property.
        /// </summary>
        public static readonly DependencyProperty Item6Property =
            DependencyProperty.Register(
                "Item6",
                typeof(object),
                typeof(FourByTwoGrid),
                new PropertyMetadata(null));

        #endregion public object Item6

        #region public object Item7
        /// <summary>
        /// Gets or sets item #7.
        /// </summary>
        public object Item7
        {
            get { return GetValue(Item7Property) as object; }
            set { SetValue(Item7Property, value); }
        }

        /// <summary>
        /// Identifies the Item7 dependency property.
        /// </summary>
        public static readonly DependencyProperty Item7Property =
            DependencyProperty.Register(
                "Item7",
                typeof(object),
                typeof(FourByTwoGrid),
                new PropertyMetadata(null));

        #endregion public object Item7 
```

* * *

EpisodeList 是 SeriesViewModel 类中的 IList，我想将该列表绑定到我的 EpisodeGrid 控件。

```
public class SeriesViewModel : CoreViewModel
{
     public IList episodeList = new ObservableCollection<Episode>
     {
         new Episode {image =""},

         new Episode {image =""},
         ......
     }

    public IList EpisodeList
    {
        get {return this.episodeList;}
        set
        {
            this.episodeList = value;
            RaisePropertyChanged("EpisodeList");
        }
    }
 } 
```

* * *

```
<Core:CoreView
xmlns:Core="clr-namespace:AmebaTV_XBOXApplication.ViewModel"
x:Class="AmebaTV_XBOXApplication.UI.EpisodeGridView"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:GridLayout="clr-namespace:AmebaTV_XBOXApplication.Controls.GridLayout"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
xmlns:xbox="clr-namespace:Microsoft.Xbox.Controls;assembly=Microsoft.Xbox"
mc:Ignorable="d"
d:DesignHeight="720" d:DesignWidth="1280"
Title="EpisodeGridView Page">

<Core:CoreView.ViewModel>
    <Binding Path="SeriesViewModel" Source="{StaticResource viewModelLocator}"/>
</Core:CoreView.ViewModel>

<Core:CoreView.Resources>
    <DataTemplate x:Key="button_template">
        <Button Width="50" Height="50" >
            <TextBlock Text="Button"/>
        </Button>
    </DataTemplate>
</Core:CoreView.Resources>

  <Grid x:Name="LayoutRoot"  Margin="0">         
    <GridLayout:FourByTwoGrid x:Name="fourbytwogrid"
              ItemsSource="{Binding EpisodeList}"
              ItemTemplate="{StaticResource button_template}"/>

  </Grid>
</Core:CoreView> 
```

我在上面缺少什么？它编译得很好，但在运行时 EpisodeList 不绑定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-20T17:39:51.883

我查看了代码，它似乎绑定得很好。

如果在 OnItemsSourcePropertyChanged 方法中设置断点，您可以看到 DP ItemsSourceProperty 绑定到 EpisodeList，并且获取存储在属性 ItemsSource 中的 IList 的调用具有我们期望的值。

什么证据表明 EpisodeList 未绑定到 ItemsSource？

如果问题是网格按钮未显示，我不确定您是否显示了有关如何创建按钮控件的任何代码，也许问题存在而不是绑定。

这是我编写的 ControlTemplate 示例，它管理您在 FourByTwoGrid 类中定义的状态。您可以在 XAML 中添加以下内容以引用它。

```
 <GridLayout:FourByTwoGrid x:Name="fourbytwogrid"
      ItemsSource="{Binding EpisodeList}"
      ItemTemplate="{StaticResource butemp}"
      Template="{StaticResource FourByTwoGridTemplate}" /> 
```

这里是 ControlTemplate 的定义。如果没有这个，您的代码将无法知道如何显示您在方法 UpdateVisualState() 中引用的状态。

将此添加到 CoreView XAML 中的资源字典中：

```
<ControlTemplate x:Key="FourByTwoGridTemplate" TargetType="GridLayout:FourByTwoGrid">
        <Grid>
            <vsm:VisualStateManager.VisualStateGroups>
                <vsm:VisualStateGroup x:Name="Button0States">
                    <vsm:VisualState x:Name="Button0Visible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="Button0">
                                <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}"/>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </vsm:VisualState>
                    <vsm:VisualState x:Name="Button0NotVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="Button0">
                                <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Hidden}"/>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </vsm:VisualState>
                </vsm:VisualStateGroup>
                <vsm:VisualStateGroup x:Name="Button1States">
                    <vsm:VisualState x:Name="Button1Visible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="Button1">
                                <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}"/>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </vsm:VisualState>
                    <vsm:VisualState x:Name="Button1NotVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="Button1">
                                <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Hidden}"/>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </vsm:VisualState>
                </vsm:VisualStateGroup>
                <vsm:VisualStateGroup x:Name="Button2States">
                    <vsm:VisualState x:Name="Button2Visible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="Button2">
                                <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Visible}"/>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </vsm:VisualState>
                    <vsm:VisualState x:Name="Button2NotVisible">
                        <Storyboard>
                            <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.Visibility)" Storyboard.TargetName="Button2">
                                <DiscreteObjectKeyFrame KeyTime="0" Value="{x:Static Visibility.Hidden}"/>
                            </ObjectAnimationUsingKeyFrames>
                        </Storyboard>
                    </vsm:VisualState>
                </vsm:VisualStateGroup>

            </vsm:VisualStateManager.VisualStateGroups>
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition/>
                <RowDefinition/>
                <RowDefinition/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <Button Grid.Row="0" Grid.Column="0" Name="Button0" Content="0" Visibility="Hidden" />
            <Button Grid.Row="0" Grid.Column="1" Name="Button1" Content="1" Visibility="Hidden" />
            <Button Grid.Row="1" Grid.Column="0" Name="Button2" Content="2" Visibility="Hidden" />
            <Button Grid.Row="1" Grid.Column="1" Name="Button3" Content="3" Visibility="Hidden" />
            <Button Grid.Row="2" Grid.Column="0" Name="Button4" Content="4" Visibility="Hidden" />
            <Button Grid.Row="2" Grid.Column="1" Name="Button5" Content="5" Visibility="Hidden" />
            <Button Grid.Row="3" Grid.Column="0" Name="Button6" Content="6" Visibility="Hidden" />
            <Button Grid.Row="3" Grid.Column="1" Name="Button7" Content="7" Visibility="Hidden" />
        </Grid>
</ControlTemplate> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:43:59.030

看起来问题出在`ViewModel`. 您正在尝试绑定`ItemsSource`到名为“EpisodeList”的属性。但`RaisePropertyChanged`指的是非绑定成员“episodeList”。

# wcf - AccessViolationException 和故障模块：是什么导致了这个异常？是模块故障吗？

> ID：12395090
> 
> 赞同：0
> 
> 时间：2012-09-12T19:36:36.187
> 
> 标签：wcf, com, vb6, access-violation, sta

如果发生 AccessViolationException，与它相关的故障模块是否意味着它是该模块中的错误，在我们的例子中，它恰好是我们的第三方 DLL 之一？或者这是一个更复杂的问题？我们已经联系了这个模块的制造商，但他们没有发现任何错误，只是暗示可能的堆栈损坏意味着什么。但是，根据事件日志，特定的故障模块始终与 AccessViolationException 相关联。那么这件事的真相是什么？它是有问题的第三方 DLL 模块还是其他什么？

背景

我们在 IIS 7 上运行的 .NET WCF Web 服务中使用受互斥体保护的 VB6 STA COM 对象。最近我们检测到随机 System.AccessViolationException 错误（由该对象引起）使 Web 服务完全崩溃，我们非常无助此刻，我们已经完成了使该 COM 对象与 Web 服务一起工作的所有工作。服务本身已使用以下指南设置为在 STA 模式下运行：(http://scottseely.com/2009/07/17/calling-an-sta-com-object-from-a-wcf-operation/

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T08:49:57.277

这可能与线程终止时的 VB6 运行时泄漏有关。VB6 ActiveX DLL 项目具有“无人参与执行”和“保留在内存中”的选项，它们试图通过尽可能长时间地保持 STA 线程上的运行时间来缓解这些问题。询问您的供应商这些选项是否适用于他们的组件。

在任何一种情况下，最好的办法是阻止这些 STA 线程终止，实现它们的池（或在单个 STA 线程上序列化），以便 VB6 运行时不会尝试随时拆除它的内部结构（并且泄漏句柄/内存/TLS 这样做）。

在 COM+/MTS 下搜索使用 VB6 组件，可能会找到有价值的建议。祝你好运！

# asp.net - ASP.net 形成身份验证和超时

> ID：12395092
> 
> 赞同：0
> 
> 时间：2012-09-12T19:36:40.013
> 
> 标签：asp.net, asp.net-mvc, forms-authentication

我有一个简单的小问题，但是下面的内容很长，可以更多地解释这个问题。

我有一个使用表单身份验证的 MVC 4 应用程序。我使用浏览器会话 cookie 设置它，以便他们可以使用该网站只要他们愿意，但是一旦他们关闭浏览器，它实质上就会将它们注销。

现在我以空闲计时器的形式添加了额外的安全层，因此如果它们空闲了 5 分钟，则会向服务器发送一个 ajax 请求以删除表单身份验证令牌，返回一个会话过期部分视图，并将此会话过期视图显示为模式对话框。

此对话框有一个显示用户名的标签和一个密码输入字段，以便他们可以重新输入密码。

这意味着如果有人打开另一个会话，他们只会进入登录屏幕，因为没有人登录，如果他们只是刷新当前屏幕，也会发生同样的情况。但这也意味着，如果用户在超时屏幕上输入密码，对话框会向服务器发送一个 ajax 请求以再次登录，然后删除对话框。

这一切（大部分）都完美无缺，它们将与以前一样在同一个屏幕上，并且它们还将像以前一样填写所有内容，例如，如果他们正在填写一张大表格等。

**问题是**，如果他们在浏览器中打开了 2 个不同的选项卡，第一个超时，按预期显示超时屏幕及其名称和密码输入框，但第二个浏览器选项卡在请求时间时 -将屏幕输出到 mvc 方法，找不到已登录的用户，因为没有人登录，因为该人已通过第一次超时请求注销。我怎样才能解决这个问题？有简单的解决方案吗？或者对于我如何做到这一点有更好的设计？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:05:07.223

我在实时站点中看到了这个问题，这真的很烦人。它强制用户只打开一个选项卡以避免退出。

您能否通过在超时后不将用户从服务器上注销来解决这个问题，而只删除会话 cookie？这样，用户仍然会在空闲选项卡上看到超时屏幕，但仍然可以使用其他选项卡。这仍然会带来不便，但我认为如果你真的想要那个超时屏幕，它可能是这样做的方法。除非你想用 WebSockets 或类似的东西来做。

# eclipse - Eclipse - 将 Jar 文件添加到现有项目

> ID：12395095
> 
> 赞同：2
> 
> 时间：2012-09-12T19:37:01.397
> 
> 标签：eclipse, eclipse-plugin

我正在运行 Eclipse 3.7。我目前正在为一个名为 Team Center 的应用程序开发插件项目。我最近了解到一个名为 Opal 的 SWT Widgets jar 文件。所以我想弄清楚如何将 Jar 文件添加到我现有的项目中。我尝试了许多不同的方法来做到这一点。到目前为止没有任何效果。

以下是我尝试过的一些事情。

1.  在我当前项目中做了一个lib目录复制了jar文件
2.  构建路径配置 -> 库 -> 添加了 Jar
3.  运行时选项卡 -> 添加 -> 选择 lib/jar 文件 -> 更新构建路径
4.  已保存
5.  我的项目仍然可以编译，但在运行时它失败并且我得到 can't load proxied handler 错误

我试图为 Jar 文件创建一个插件项目，然后将 opal 插件添加到所需的插件中。如果 Opal 项目已关闭，则反映在我的项目中的 Opal 插件。

这是我当前项目的工作方式。这是一个插件项目，当我完成或更改代码时。

1.  构建项目
2.  出口
3.  可部署的插件和片段
4.  选择我的项目插件
5.  结束
6.  然后我将project.jar复制到TeamCenter Application插件目录

我假设我必须以某种方式将 opal.jar 包含在 project.jar 中。但是现在我完全不知道该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:46:03.123

在 Eclipse Plugin Project 中，单击您的 MANIFEST.MF 文件并转到运行时选项卡。应该有一个“类路径”部分。尝试在那里添加你的库。

**更新**

我已经尝试过了，它对我有用。我已经执行了以下步骤：

1.  创建新的插件项目
2.  在其中创建新`lib`文件夹
3.  将蛋白石库复制到文件夹
4.  打开`MANIFEST.MF`，转到`Runtime`选项卡并将库添加到该`Classpath`部分
5.  检查`lib`文件夹是否被构建过程识别（`Build`应检查 tab 和 lib 文件夹）
6.  创建新的运行配置（`Run`-> `Run Configuration...`-> 双击`OSGi Framework`）
7.  在`Bundles`选项卡上检查新建项目（`Workspace`部分）并`Target Platform`立即取消选中
8.  标记新项目并点击`Add Required Bundles`右侧的按钮
9.  现在应该在`Target Platform`部分中检查一些运行项目所需的捆绑包
10.  单击`Apply`，然后`Run`您的 OSGi 环境将启动

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T04:30:38.257

检查插件中的 build.properties。检查 lib 文件夹应该包含在那里。

在编辑器中打开 plugin.xml 或 MANIFEST.MF，您会看到构建选项卡。在二进制构建中，确保您的 lib 文件夹被选中。

# haskell - Pointfree 在 Haskell 中返回一个元组

> ID：12395097
> 
> 赞同：4
> 
> 时间：2012-09-12T19:37:21.147
> 
> 标签：haskell, pointfree

无点函数可以返回元组吗？例如，以下是否可以用 pointfree 样式编写（其中 f1、f2 和 f3 已定义）：

```
(\t -> (f1 t, f2 t, f3 t)) 
```

在这种情况下，我的 f1、f2 和 f3 是 quot、mod、* 和一些整数的组合。

```
(\f1,f2,f3 -> (\t -> (f1 t, f2 t, f3 t))) 
```

是一个更一般的情况，并且等价于

```
(\f1,f2,f3,t -> (f1 t, f2 t, f3 t)) 
```

命名函数是可以的，但我的例子是匿名的。（命名示例如下）

```
f x = (f1 x, f2 x, f3 x)
f f1 f2 f3 x = (f1 x, f2 x, f3 x) 
```

编辑：我只是好奇，我不会这样做。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-12T19:51:22.090

你可以写

```
(\t -> (f1 t, f2 t, f3 t)) 
```

免点，这是

```
liftM (,,) f1 `ap` f2 `ap` f3 
```

带有`ap`from`Control.Monad`和from的`Monad`实例。一种更易读的形式可能是变体`(->) a``Control.Monad.Instances``Control.Applicative`

```
(,,) <$> f1 <*> f2 <*> f3 
```

然后你可以进一步免点

```
(\f1 f2 f3 -> (\t -> (f1 t, f2 t, f3 t))) 
```

作为

```
 \f1 f2 f3 -> (,,) <$> f1 <*> f2 <*> f3
= \f1 f2 -> ((,,) <$> f1 <*> f2 <*>)
= \f1 f2 -> (<*>) ((,,) <$> f1 <*> f2)
= \f1 f2 -> ((<*>) . ((,,) <$> f1 <*>)) f2
= \f1 -> (<*>) . ((,,) <$> f1 <*>)
= \f1 -> (<*>) . (<*>) ((,,) <$> f1)
= \f1 -> (((<*>) .) . (<*>) . (<$>) (,,)) f1
= ((<*>) .) . (<*>) . (<$>) (,,) 
```

但说真的，你不应该。保持可读性，这意味着一点点自由是好的，但不要过度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-12T19:45:21.563

是的。#haskell IRC 频道上的“lambdabot”IRC 机器人实际上有一个功能，可以为您提供给定功能的无点版本。在你的情况下，它说

```
\x -> (f x, g x, h x) 
```

相当于

```
ap (liftM2 (,,) f g) h 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-12T19:54:52.577

尽管 applicative 或 monadic 版本更简单、更短，但可能暴露“含义”（以及您正在使用的 Haskell 类型类别的属性）的一种方法是使用 Control.Arrow

```
uncurry (uncurry (,,)) . ((f &&& g) &&& h) 
```

pointfull版本虽然优越。

这也暴露了你需要 Hask 的“笛卡尔性”，而不是 Hask 的所有“封闭性”

```
 arrowized :: Arrow cat => cat a a1 -> cat a b1 -> cat a b -> cat a (a1, b1, b)
 arrowized f g h => arr (uncurry (uncurry (,,))) . ((f &&& g) &&& h) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-12T19:52:14.087

你可以这样写你的例子：

```
\f1 f2 f3 t -> (,,) (f1 t) (f2 t) (f3 t) 
```

(,,) 是一个带有 3 个参数的常用函数，因此使其应用程序无点并没有什么特别之处。但是，它使用它的参数 3 次，所以它会很麻烦，而且可能不值得。

#haskell 的 Lambdabot 说它是`(ap .) . liftM2 (,,)`. 享受 ：）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-13T15:01:10.417

这里有一些关于其他人的答案的详细说明。

我们在源码里面`Control.Applicative`找到

```
instance Applicative ((->) a) where  -- (a ->) is meant here
    pure = const
    (<*>) f g x = f x (g x)

liftA3 f a b c = f <$> a <*> b <*> c 
```

在 GHCi 中，我们得到

```
Prelude Control.Applicative> :t liftA3 (,,)
liftA3 (,,) :: (Applicative f) => f a -> f b -> f c -> f (a, b, c) 
```

因此，使用`(t->)`as `f`，**`liftA3 (,,)`**就可以了：

```
liftA3 (,,) ~ (t->a) -> (t->b) -> (t->c) -> (t->(a,b,c)) 
```

即，调用**`liftA3 (,,) f1 f2 f3 t`**产生一个三元组`(f1 t, f2 t, f3 t)`，给定相同类型输入的三个函数：

`Prelude Control.Applicative>` **`liftA3 (,,) (:[]) (quot 12) (`rem`3) 4`**
`([4],3,1)`

* * *

那么它是怎样工作的？根据 的定义`liftA3`，然后是`<*>`，

```
liftA3 (,,) f g h t = ((((,,) <$> f) <*> g) <*> h) t
    = (((,,) <$> f) <*> g) t (h t)
    = (((,,) <$> f) t (g t) (h t) 
```

现在，`(<$>) = fmap`定义`instance Functor ((->) t)`，`fmap = (.)`所以我们继续

```
 = (((,,) . f) t (g t) (h t)
    = (,,) (f t) (g t) (h t)
    = (f t, g t, h t) 
```

# c# - Sql Server 2008，通过存储过程将查询修改为 .NET ArrayList

> ID：12395099
> 
> 赞同：-1
> 
> 时间：2012-09-12T19:37:43.797
> 
> 标签：c#, sql-server-2008, stored-procedures, arraylist

下面是使用存储过程 (GetTimesWithCustomerNames) 然后通过 ArrayList 收集查询检索到的数据的示例：

```
/*
    GetTimesWithCustomerNames 3571, 6, 2012, 1
    GetTimesWithCustomerNames '3571', '6', '2012', '0'

*/
ALTER PROCEDURE [dbo].[GetTimesWithCustomerNames]
@userid int=0, @month int=0, @year int=0,@reasonid int=0
AS
BEGIN
    SET NOCOUNT ON;

    if @userid!=0 begin

        create table #tmp (tId int, UserId int, 
        TimeIn1 smalldatetime, [TimeOut1] smalldatetime, 
        TimeIn2 smalldatetime, [TimeOut2] smalldatetime, tId2 int,
        TimeIn3 smalldatetime, [TimeOut3] smalldatetime, tId3 int,
        ActiveDate smalldatetime, ReasonID int, Name nvarchar(100), ReasonType nvarchar(100),
        TotalMins int)

        insert into #tmp (tId, UserId, TimeIn1, TimeOut1, ActiveDate, ReasonID, Name, ReasonType)
        SELECT
        t1.tId, t1.UserId, t1.TimeIn, t1.[TimeOut], t1.ActiveDate, t1.ReasonID, tblCustomers.Name,
        (select reasontype from tblTimeReas where ReasonID=t1.ReasonID) as ReasonType
        FROM tblTime t1
        inner join tblCustomers on t1.UserId=tblCustomers.custID
        where (t1.userid=@userid)
        and (DATEPART(MONTH,t1.timein)=@month or @month=0)
        and (DATEPART(YEAR,t1.timein)=@year or @year=0)
        and (t1.reasonid = @reasonid or @reasonid=0)        
        and
        (select COUNT(1) from tblTime t2 where userid=@userid and datediff(day,t2.TimeIn,t1.TimeIn)=0 and t2.tId<t1.tId)=0

        update #tmp
        set tId2 = (select top 1 tId from tblTime t2 where userid=@userid and DATEDIFF(day,t2.timein,#tmp.timein1)=0
                        and t2.tId>#tmp.tId order by tId asc)
        update #tmp
        set tId3 = (select top 1 tId from tblTime t3 where userid=@userid and DATEDIFF(day,t3.timein,#tmp.timein2)=0
                        and t3.tId>#tmp.tId2 order by tId asc)

        update #tmp
        set TimeIn2 = (select TimeIn from tblTime where tId=tId2),
            TimeOut2 = (select [TimeOut] from tblTime where tId=tId2),
            TimeIn3 = (select TimeIn from tblTime where tId=tId3),
            TimeOut3 = (select [TimeOut] from tblTime where tId=tId3)

        update #tmp set TotalMins = (
            isnull(DATEDIFF(minute,timein1,timeout1),0)+
            isnull(DATEDIFF(minute,timein2,timeout2),0)+
            isnull(DATEDIFF(minute,timein3,timeout3),0)
        )

        select * from #tmp order by TimeIn1
        drop table #tmp

    end

END 
```

我想知道，对于给定的用户 ID，我可以将所有数据返回到 ArrayList - 检索每个用户 ID 的一组值的方法是什么？是否有可能在 arrayList 中为每个用户（少数）返回一个数据，而**不是**像这个过程一样？

在此查询中，数据是`TimeIn` `TimeOut` `ActiveDate`等...

*   重新编辑我认为我的问题是该任务是否应该针对 foreach 循环中的代码，或者是否可以修改该过程以接受多个用户 ID？

我用来在后面的代码中存储数据的代码是：

```
 public static ArrayList loadData(string sql)
    {

        DBManager dbManager = new DBManager(DataProvider.SqlServer, "Data Source=(local);Initial Catalog=databaseName;Integrated Security=True");

        ArrayList data = new ArrayList();

        try
        {
            dbManager.Open();
            dbManager.ExecuteReader(System.Data.CommandType.Text, sql);
            while (dbManager.DataReader.Read())
            {
               Hashtable x = new Hashtable();

                for (int i = 0; i < dbManager.DataReader.FieldCount; i++)
                {
                    x.Add(dbManager.DataReader.GetName(i), dbManager.DataReader.GetValue(i));
                }
                x.Add("COUNTER", data.Count+1);
                data.Add(x);
            }
        }
        catch { data = null; }
        finally
        {
            dbManager.Dispose();
        }

        return data;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T23:59:51.873

```
 public static List<Dictionary<string, object>> loadData(string sql)
    {

    itson = (sql.StartsWith("GetTimesWith"));
    DBManager dbManager = new DBManager(DataProvider.SqlServer, "Data Source=(local);Initial Catalog=hental;Integrated Security=True");

    //ArrayList data = new ArrayList();
    List<Dictionary<string, object>> data = new List<Dictionary<string,object>>();
    try
    {
        dbManager.Open();
        dbManager.ExecuteReader(System.Data.CommandType.Text, sql);
        while (dbManager.DataReader.Read())
        {
           //Hashtable x = new Hashtable();
           Dictionary<string, object> x = new Dictionary<string, object>();
            for (int i = 0; i < dbManager.DataReader.FieldCount; i++)
            {
                x.Add(dbManager.DataReader.GetName(i), dbManager.DataReader.GetValue(i));
            }

            x.Add("COUNTER", data.Count+1);
            data.Add(x);
            ncx = data.Count;

        }
    }
    catch { data = null; }
    finally
    {
        dbManager.Dispose();
    }

    return data;
} 
```

# r - R如何进行精确的wilcox秩和检验？

> ID：12395110
> 
> 赞同：3
> 
> 时间：2012-09-12T19:38:23.060
> 
> 标签：r, testing, sum, rank

我阅读了 R 中的文档`wilcox.test()`并想确定：

1.  R如何计算`wilcox.test()`
2.  文档说，当样本数量很少时，它会准确地进行测试（而不是使用正常的近似值）——它使用什么表来准确地做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-06T09:30:27.397

wilcox.test.default 在 stats 包的命名空间中是“隐藏的”。

这就是您需要执行`getAnywhere("wilcox.test.default")`或`stats:::wilcox.test.default`查看它的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-06T03:10:04.907

包exactRankTests 可以做精确的wilcox 秩和检验。

# sql - Oracle SQL——我可以给查询加时间戳吗？

> ID：12395114
> 
> 赞同：1
> 
> 时间：2012-09-12T19:38:31.253
> 
> 标签：sql, oracle

我有一个简单的查询：

```
Select         Count(p.Group_ID)
From           Player_Source P 
  Inner Join   Feature_Group_Xref X On P.Group_Id=X.Group_Id 
where          x.feature_name ='Try this site' 
```

它会在当前时刻吐出特定测试组中的当前人数。

如果我想看看这个数字是多少，比如说，在 2012 年 9 月 10 日，我可以在查询中添加一些东西来对这些信息进行时间分段，因为数据库在 2 天前就有了它吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:46:14.897

不可以。如果您想存储历史信息，您需要将其合并到您的架构中。例如，您可以扩展`Feature_Group_Xref`以添加列`Effective_Start_Timestamp`和`Effective_End_Timestamp`; 要查找当前具有给定特征的组，您可以编写`AND Effective_End_Timestamp > CURRENT_TIMESTAMP()`（或`AND Effective_End_Timestamp IS NULL`，取决于您要如何定义列），但要查找哪些组在特定时间具有给定特征，您可以编写`AND ... BETWEEN Effective_Start_Timestamp AND Effective_End_Timestamp`（或`AND Effective_Start_Timestamp < ... AND (Effective_End_Timestamp > ... OR Effective_End_Timestamp IS NULL)`）。

Wikipedia 上有一篇很好的文章，介绍了人们用来解决此类问题的各种模式设计：请参阅[http://en.wikipedia.org/wiki/Slowly_changeing_dimension](http://en.wikipedia.org/wiki/Slowly_changing_dimension)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:53:38.757

这取决于...

至少理论上可以使用闪回查询

```
Select Count(p.Group_ID)
  From Player_Source as of timestamp( date '2012-09-10' ) P 
       Join Feature_Group_Xref as of timestamp( date '2012-09-10' ) X 
         On P.Group_Id=X.Group_Id 
 where x.feature_name ='Try this site' 
```

但是，这要求您具有执行闪回查询所需的权限，并且`UNDO`Oracle 有足够的权限申请能够恢复到两天前午夜时这些表所处的状态。尽管通常是可能的，但数据库不太可能配置为保留那么多`UNDO`。如果您碰巧使用的是[Oracle Total Recall](http://www.oracle.com/technetwork/database/application-development/total-recall-1667156.html) ，此查询也可以工作。

但是，更有可能的是，您需要修改架构定义，以便存储历史信息，然后您可以在某个时间点查询这些信息。有多种方法可以实现这一点——正如@ruakh 建议的那样，在表中添加有效日期和到期日期列是更受欢迎的选项之一。哪些选项适合您的特定情况将取决于多种因素，包括您想要保留多少历史记录、数据更改的频率等。

# spring-mvc - Spring缺少扩展文件

> ID：12395115
> 
> 赞同：2
> 
> 时间：2012-09-12T19:38:42.460
> 
> 标签：spring-mvc

我正在使用 Spring MVC 开发应用程序，而 Extjs 和我有一个问题，我需要将文件路径传递给我的控制器，它将删除带有路径的图像。但是在我看来，路径是正确的，但是当请求到达控制器时，路径没有扩展。

查看：记事本图标.png

控制器：记事本图标

```
@RequestMapping (value = "/delete/{file}", method = RequestMethod.DELETE)
public ModelAndView delete(@PathVariable String file){
    ModelAndView view = new ModelAndView(VIEW);
    service.delete(file);
    view.addObject("success", Boolean.TRUE);
    return view;
} 
```

谁能给我一个见解，好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:50:16.670

如果它是一个简单的扩展，我可以建议这样做：

```
@RequestMapping (value = "/delete/{file}.{ext}", method = RequestMethod.DELETE)
public ModelAndView delete(@PathVariable("file") String file, @PathVariable("ext") String ext){
    ModelAndView view = new ModelAndView(VIEW);
    service.delete(file + "." + ext);
    view.addObject("success", Boolean.TRUE);
    return view;
} 
```

另一种方法是有点迂回 - 这将通过将`useSuffixPatternMatch`标志设置`RequestMappingHandlerMapping`为 false，这应该为您提供整个文件名，但是设置标志有点困难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-08T00:36:47.350

只需将 {file:.+} 添加到 RequestMapping。

```
@RequestMapping (value = "/delete/{file:.+}", method = RequestMethod.DELETE) 
```

# mongodb - Mongodb设置唯一字段

> ID：12395118
> 
> 赞同：5
> 
> 时间：2012-09-12T19:38:53.197
> 
> 标签：mongodb, mongodb-query

```
 TENANT
  { "_ID" : 11, NAME : "ruben", OPERATION :[{OPERATION_ID: 100, NAME : "Check"}] } 
```

如何设置 OPERATION_ID 具有唯一性以避免重复值并避免像主键这样的空值？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-12T20:30:45.717

When you want the OPERATION_IDs to be unique for all tenants, then you can do it like that:

```
db.tenants.ensureIndex( { operation.OPERATION_ID : 1 }, { unique:true, sparse:true } ); 
```

When you want the OPERATION_IDs to be unique per tenant, so that two tenants can both have the operation_ID:100 but no tenant can have operation_id:100 twice, you have to add the _id of the tenant to the index so that any given combination of _id and operation_id is unique.

```
db.tenants.ensureIndex( { _id: 1, operation.OPERATION_ID : 1 }, { unique:true, sparse:true } ); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-12T21:07:01.393

在 OPERATION.OPERATION_ID 上添加[唯一索引](http://www.mongodb.org/display/DOCS/Indexes#Indexes-unique:true)将确保没有两个不同的文档将包含 OPERATION 中具有相同 OPERATION_ID 的元素。

如果要防止单个文档在 OPERATION 中有两个具有相同 OPERATION_ID 的元素，则不能使用唯一索引；您将不得不使用集合更新运算符（例如 $set 和 $addToSet）。您可以将 OPERATION 转换为由 OPERATION_ID 键入的子文档，如下所示：

```
{ "_ID" : 11, NAME : "ruben", OPERATION : {"100" : {NAME : "Check"} }} 
```

然后，您可以通过使用 $set; 发出更新来强制唯一性；例如：

```
db.<collection>.update({NAME: "ruben"}, {$set: {"OPERATION.100.NAME": "Uncheck"}}) 
```

关于空值：MongoDB 对字段没有非空约束（它甚至不强制给定字段具有单一类型），因此您必须确保在您的应用程序中不插入空值。

# cuda - 使用 CUDA Thrust 并行执行多个 1D 移动平均线

> ID：12395122
> 
> 赞同：3
> 
> 时间：2012-09-12T19:39:20.567
> 
> 标签：cuda, thrust

我不是一个有任何能力的程序员。只是有人对 CUDA 感到好奇，所以我正在做一些阅读。我遇到了一个使用推力做移动平均线的例子：

[简单移动平均线推力示例](http://code.google.com/p/thrust/source/browse/examples/simple_moving_average.cu?r=e553df2dbb9e21fb3e95836729139db40b88d07d)

示例，例如，运行并且大部分正常工作。然而，从某种意义上说，它只进行一次移动平均操作，这是微不足道的。

我会怎么说`352`这些并行的移动平均操作，都在同一个数据流上操作？在我看来，程序流程可能是：

1.  生成数据并将其发送到一个 CUDA 核心。（与现有代码相同，但认为长度为`1000`or`10000`而不是`30`）
2.  将它从它所在的 CUDA 核心复制到`351`我的 GTX 465 中的所有其他 CUDA 核心
3.  告诉每个 CUDA 核心要平均多少数据项。( `4`, `5`, `6`,..., `352`, `353`, `354`)
4.  告诉设备在每个内核中并行运行平均值
5.  读回每个核心的结果

我知道这段代码

```
// compute SMA using standard summation
simple_moving_average(data, w, averages); 
```

让这一切发生，但我如何让 Thrust 并行执行其中的许多操作？

我在这里感兴趣的是股票数据之类的东西。如果我正在查看 GOOG 价格，我会使用所有内核将其放入 GPU 中并留在那里。然后，我可以自由地进行大量处理，而无需再加载数据，只需从每个核心读取结果。注意：我可能不想在所有内核中都使用 GOOG。有些核心可能是 GOOG，有些核心可能带有其他符号，但我稍后会介绍。我只是在想，如果每个核心都有足够的空间，我不想要全局内存中的库存数据。

我认为这对于 CUDA 和 Thrust 来说非常简单？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T11:49:11.887

以下是使用 arrayfire 执行此操作的可能方法：请注意，我不隶属于该库。
我很确定这也可以通过推力来完成，但我发现使用 arrayfire 更简单。如果图书馆是免费的，为什么我不能用它来代替推力？

在 arrayfire 中，您可以使用矩阵并行运行多个 SMA 操作：

```
unsigned n_SMAs = 1000;   // # of SMA indicators to evaluate 
unsigned len = 2000;      // # of stock prices per indicator
unsigned w = 6; // window size

// generate stock prices: [0..10] 
af::array data = af::randu(n_SMAs, len) * 10;

// compute inclusive prefix sums along colums of the matrix
af::array s = af::accum(data, 1);

// compute the average
af::array avg = (s.cols(w, af::end) - s.cols(0, af::end - w)) / w;
af::eval(avg);

std::cout << avg.dims() << "\n" << avg << "\n"; 
```

让我知道这是否是您正在寻找的。这就是我理解您的问题的方式：并行计算多个 SMA 指标

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-15T15:42:20.850

我的理解是您对以下两种情况感兴趣：

1.  您有很长的项目序列，并且您希望通过对不同数量的项目进行平均来计算一定数量的平均值，即，对移动平均窗口使用不同的长度。这是我从你原来的问题中理解的。
2.  您有一系列序列，连续存储在内存中，并且您希望使用大小为 的固定平均窗口并行平均它们`2 * RADIUS + 1`。这就是@asm 提出的 ArrayFire 代码的作用——你已经接受了。

而不是使用 CUDA Thrust，我认为编写自己的 CUDA 内核来执行上述操作会更容易。下面是一个完整的示例，其操作方式与@asm 提出的 ArrayFire 代码相同，因此涵盖了案例 #2。修改它以涵盖案例#1 将很简单。

```
#include <thrust/device_vector.h>

#define RADIUS        3
#define BLOCK_SIZE_X  8
#define BLOCK_SIZE_Y  8

/*******************/
/* iDivUp FUNCTION */
/*******************/
int iDivUp(int a, int b){ return ((a % b) != 0) ? (a / b + 1) : (a / b); }

/********************/
/* CUDA ERROR CHECK */
/********************/
#define gpuErrchk(ans) { gpuAssert((ans), __FILE__, __LINE__); }
inline void gpuAssert(cudaError_t code, const char *file, int line, bool abort=true)
{
   if (code != cudaSuccess) 
   {
      fprintf(stderr,"GPUassert: %s %s %d\n", cudaGetErrorString(code), file, line);
      if (abort) exit(code);
   }
}

/**********/
/* KERNEL */
/**********/
__global__ void moving_average(unsigned int *in, unsigned int *out, unsigned int M, unsigned int N) {

    __shared__ unsigned int temp[BLOCK_SIZE_Y][BLOCK_SIZE_X + 2 * RADIUS];

    unsigned int gindexx = threadIdx.x + blockIdx.x * blockDim.x;
    unsigned int gindexy = threadIdx.y + blockIdx.y * blockDim.y;
    unsigned int gindex  = gindexy * N + gindexx;

    unsigned int lindexx = threadIdx.x + RADIUS;
    unsigned int lindexy = threadIdx.y;

    // --- Read input elements into shared memory
    temp[lindexy][lindexx] = ((gindexx < N)&&(gindexy < M))? in[gindex] : 0;
    if (threadIdx.x < RADIUS) {
        temp[lindexy][threadIdx.x] = ((gindexx >= RADIUS)&&(gindexx < (N + RADIUS))&&(gindexy < M)) ? in[gindex - RADIUS] : 0;
        temp[lindexy][threadIdx.x + (RADIUS + min(BLOCK_SIZE_X, N - blockIdx.x * BLOCK_SIZE_X))] = (((gindexx + min(BLOCK_SIZE_X, N - blockIdx.x * BLOCK_SIZE_X)) < N)&&(gindexy < M))? in[gindexy * N + gindexx + min(BLOCK_SIZE_X, N - blockIdx.x * BLOCK_SIZE_X)] : 0;
        if ((threadIdx.y == 0)&&(gindexy < M)&&((gindexx + BLOCK_SIZE_X) < N)&&(gindexy < M)) printf("Inside 2 - tidx = %i; bidx = %i; tidy = %i; bidy = %i; lindexx = %i; temp = %i\n", threadIdx.x, blockIdx.x, threadIdx.y, blockIdx.y, threadIdx.x + (RADIUS + BLOCK_SIZE_X), temp[lindexy][threadIdx.x + (RADIUS + BLOCK_SIZE_X)]);
    }

    __syncthreads();

    // --- Apply the stencil
    unsigned int result = 0;
    for (int offset = -RADIUS ; offset <= RADIUS ; offset++) {
        result += temp[lindexy][lindexx + offset];
    }

    // --- Store the result
    out[gindexy * N + gindexx] = result;
}

/********/
/* MAIN */
/********/
int main() {

    const unsigned int M        = 2;
    const unsigned int N        = 4 + 2 * RADIUS;

    const unsigned int constant = 3;

    thrust::device_vector<unsigned int> d_in(M * N, constant);
    thrust::device_vector<unsigned int> d_out(M * N);

    dim3 GridSize(iDivUp(N, BLOCK_SIZE_X), iDivUp(M, BLOCK_SIZE_Y));
    dim3 BlockSize(BLOCK_SIZE_X, BLOCK_SIZE_Y);
    moving_average<<<GridSize, BlockSize>>>(thrust::raw_pointer_cast(d_in.data()), thrust::raw_pointer_cast(d_out.data()), M, N);
    gpuErrchk(cudaPeekAtLastError());
    gpuErrchk(cudaDeviceSynchronize());

    thrust::host_vector<unsigned int> h_out = d_out;

    for (int j=0; j<M; j++) {
        for (int i=0; i<N; i++)
            printf("Element j = %i; i = %i; h_out = %i\n", j, i, h_out[N*j+i]);
    }

    return 0;

} 
```

# java - 在 -x 和 x 之间生成随机 Double

> ID：12395127
> 
> 赞同：2
> 
> 时间：2012-09-12T19:39:44.950
> 
> 标签：java, random, double, range

> **可能重复：**
> [使用 Java 在一个范围内生成随机数](https://stackoverflow.com/questions/363681/generating-random-number-in-a-range-with-java)

```
double x = //Random number between -0.5 and 0.5 
```

可能的输出：

```
-0.23
0.01
0.26
-0.4 
```

如何在 (example)`-0.5`和的范围之间生成双精度值`0.5`？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-12T19:41:39.563

```
return min + Math.random() * (max - min); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-12T19:41:29.437

这应该这样做

```
Math.random() - 0.5 
```

`Math.random``0`将在和之间生成`1`。如果你想要介于两者之间`-0.5`，`+0.5`那么你可以`-0.5`从这个结果中得到。请参阅[API 文档](http://docs.oracle.com/javase/6/docs/api/java/lang/Math.html#random%28%29)

这不会做的一件事是永远给你`0.5`，因为`Math.random()`永远不会回来`1`。[这篇](https://stackoverflow.com/a/363732/846476)文章将为您提供更多详细信息和可能的解决方案。

# gcc - 在 MinGW 中使用 scriptedmain 时遇到问题

> ID：12395130
> 
> 赞同：2
> 
> 时间：2012-09-12T19:39:58.570
> 
> 标签：gcc, attributes, mingw, weak, scriptedmain

我想用 C 语言重现[这个 Perl 代码](https://github.com/mcandre/scriptedmain/tree/master/perl)，将 API 和 CLI 捆绑在同一个 C 源代码文件（[scriptedmain](http://rosettacode.org/wiki/Scripted_Main#C)）中。这是在 Python`if __name__=="__main__": main()`和 gcc/Unix 中完成的，如下所示：

```
$ gcc -o scriptedmain scriptedmain.c scriptedmain.h
$ ./scriptedmain
Main: The meaning of life is 42
$ gcc -o test test.c scriptedmain.c scriptedmain.h
$ ./test
Test: The meaning of life is 42 
```

脚本main.h

```
int meaning_of_life(); 
```

脚本main.c

```
#include <stdio.h>

int meaning_of_life() {
    return 42;
}

int __attribute__((weak)) main() {
    printf("Main: The meaning of life is %d\n", meaning_of_life());

    return 0;
} 
```

测试.c

```
#include "scriptedmain.h"
#include <stdio.h>

extern int meaning_of_life();

int main() {
    printf("Test: The meaning of life is %d\n", meaning_of_life());
    return 0;
} 
```

但是，当我尝试使用 gcc/Strawberry 进行编译时，我得到：

```
C:\>gcc -o scriptedmain scriptedmain.c scriptedmain.h
c:/strawberry/c/bin/../lib/gcc/i686-w64-mingw32/4.4.3/../../../../i686-w64-mingw32/lib/libmingw32.a(lib32_libmingw32_a-crt0_c.o): In function `main':
/opt/W64_156151-src.32/build-crt/../mingw-w64-crt/crt/crt0_c.c:18: undefined reference to `WinMain@16'
collect2: ld returned 1 exit status 
```

当我尝试使用 gcc/MinGW 编译时，我得到：

```
$ gcc -o scriptedmain -mwindows scriptedmain.c scriptedmain.h
c:/mingw/bin/../lib/gcc/mingw32/4.5.2/../../../libmingw32.a(main.o):main.c:(.text+0x104): undefined reference to `WinMain@16'
collect2: ld returned 1 exit status 
```

如何让 GCC 在 Windows 中识别`__attribute__((weak))`语法？

此外，G++ 显示相同的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T00:35:15.207

我找到了一个适用于 Windows 和 Unix 的解决方案：只需将`main()`预处理器指令包装起来，除非设置了显式编译器标志，否则会忽略它。

脚本main.c：

```
#include <stdio.h>

int meaning_of_life() {
    return 42;
}

#ifdef SCRIPTEDMAIN

int main() {
    printf("Main: The meaning of life is %d\n", meaning_of_life());

    return 0;
}

#endif 
```

Now`main()`将被完全省略，除非您使用

```
gcc -o scriptedmain -DSCRIPTEDMAIN scriptedmain.c scriptedmain.h 
```

这段代码可以安全地导入到其他 C 代码中，因为预处理器会去掉`main()`，让您编写自己的 main.js 代码。最好的部分是这个解决方案不再依赖于晦涩的编译器宏，只依赖于简单的预处理器指令。该解决方案也适用于[C++](http://rosettacode.org/wiki/Scripted_main#C.2B.2B)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-12T19:42:11.583

无论操作系统如何，这都不是 C 语言中的好习惯。对于任何复杂到值得将其分离为库和驱动程序的东西，C 中的最佳实践是单独放入`main`一个文件中。

# flash - 我们能否将 Flex 4.6 SDK 的最低 Flash Player 要求更改为 10.2？

> ID：12395134
> 
> 赞同：0
> 
> 时间：2012-09-12T19:40:10.990
> 
> 标签：flash, apache-flex, flex4, flex4.5, flex4.6

是否可以将 Flex 4.6 SDK 所需的最低 Flash Player 更改为 10.2 版？目前 SDK 要求的最低版本是 11.1。

如果可以更改它，当有人在 Flash Player 10.2 中查看我们的应用程序时会发生什么？它还会运行吗？在我们的应用程序中是否有我们可以远离的 API？你知道我想说什么...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T08:33:34.743

不幸的是，答案是：视情况而定。

这取决于您使用 Flash Player 的哪些功能。如果您的应用程序中没有使用任何新功能，它将在较旧的 VM 中无缝运行。

然而，找出是否存在任何依赖关系可能是一项艰巨的任务，因为它们可能深埋在 Flex 框架中。所以基本上你必须从头到尾了解框架代码。或者您只需要在较旧的 VM 中测试您的应用程序，看看一切是否仍按预期工作。

如果您希望使用与默认版本不同的播放器版本，请使用`target-player`编译器选项；例如：

```
-target-player=10.2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T01:28:05.963

如果您希望以 Flash Player 10.2 为目标，我建议您使用[Flex SDK 4.5](http://sourceforge.net/adobe/flexsdk/wiki/Flex%204.5/)而不是 4.6。功能集并没有太大的不同，而且它还可以让您支持 Flash Player 10.1。

可以将较旧的 SDK 安装到当前的 Flash Builder 中，但在这种情况下，只安装 Flash Builder 4.5 可能更容易。

如果您需要某些仅在 Flex SDK 4.6+ 中提供的功能，那么您可能需要更新的播放器。Adobe 没有无缘无故地提高播放器要求。

# javascript - Js.erb VS Button_tag - 不起作用。为什么？

> ID：12395135
> 
> 赞同：0
> 
> 时间：2012-09-12T19:40:11.583
> 
> 标签：javascript, ruby-on-rails, erb

我的 js.erb 文件中有这段代码：

```
m = "<%= button_tag 'Update', :class => 'btn btn-success' %>"
$('#yield').prepend(m) 
```

而且它根本不起作用，甚至不能渲染简单的文本。问题出在 button_tag 中，因为其他代码运行良好，例如：

```
<%= 'hello world'%> 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T19:42:57.423

你可能需要逃避它：

```
m = "<%= escape_javascript(button_tag 'Update', :class => 'btn btn-success') %>" 
```

或者您可以使用`j`快捷方式：

```
m = "<%=j button_tag 'Update', :class => 'btn btn-success' %>" 
```

# javascript - 消息显示之外的淘汰赛验证

> ID：12395136
> 
> 赞同：1
> 
> 时间：2012-09-12T19:40:14.180
> 
> 标签：javascript, jquery, mvvm, knockout.js, knockout-validation

我正在做 KnockOut 验证，到目前为止一切都很好。不过我确实有一个问题。我有一些如下代码：

```
 shippingMethodModel.Description.extend({ required: true }); 
```

这在下面显示了一条验证消息，但它是否设置了一个标志或我可以阅读的东西来禁用我的保存按钮？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T21:01:33.973

我最近也有同样的需求，所以我会尝试根据您上面提供的代码行来翻译我所做的...

尝试添加类似于以下内容的 ko.computed observable：

```
shippingMethodModel.formIsNotValid = ko.computed(function () {
    // original line
    // var errors = ko.utils.unwrapObservable(ko.validation.group(self));

    // ** oops, not "self" in this case

    // UPDATED line
    var errors = ko.utils.unwrapObservable(ko.validation.group(shippingMethodModel));
    return (errors.length > 0);
}); 
```

**更新** 在注意到我的错误后，我在上面的代码中进行了更正。

对于那些一次性将此类模型/类声明为函数的人，此代码可能类似于以下内容：

```
var ShippingMethodModel = function () {
    var self = this;
    self.shippingMethodId = ko.observable().extend({ required: true });
    self.description = ko.observable().extend({ required: true });

    self.formIsNotValid = ko.computed(function () {
        var errors = ko.utils.unwrapObservable(ko.validation.group(self));
        return (errors.length > 0);
    });
}; 
```

**/更新**

**UPDATE2** 根据@ericb 在下面的评论中的输入，我对实现自己的解决方案的方式进行了更改，我将通过调整上面更新中的示例代码来演示：

```
var ShippingMethodModel = function () {
    var self = this;
    self.shippingMethodId = ko.observable().extend({ required: true });
    self.description = ko.observable().extend({ required: true });

    self.formIsNotValid = ko.observable(false);

    self.validateObservableFormField = function (nameOfObservableToValidate, 
                                                 data, event) {
        for (var prop in data) {
            if (prop === nameOfObservableToValidate) {
                var theObservable = data[prop];
                theObservable.valueHasMutated();
                ko.validation.validateObservable(theObservable);
                if (theObservable.error) {
                    self.formIsNotValid(true);
                }
                else {
                    if (self.formIsNotValid()) {
                        var errors = 
                            ko.utils.unwrapObservable(ko.validation.group(self));
                        self.formIsNotValid(errors.length > 0);
                    }
                }
                return;
            }
        }
    };        
}; 
```

请注意，我现在已将其定义`formIsNotValid`为可观察对象，但我正在使用该`validateObservableFormField`函数来帮助我确定提交前表单的有效性。此更改确保`ko.validation.group`仅在需要时调用该函数，并且仅当正在验证的 observable 有效但`formIsNotValid`为 true 时才需要调用（以处理当前 observable 设置`formIsNotValid`为 true 的情况）。

这是我如何执行此操作的示例：

```
<input data-bind="value: description, 
                  event: { blur: function(data, event) {
                                     validateObservableFormField('facilityName', 
                                                                  data, 
                                                                  event) 
                                 }
                         }" /> 
```

*愚蠢的格式以消除水平滚动*

**注意：**我已经在使用这种技术，但我已经对其进行了调整以提高检查表单是否有效的性能。**@Californicated**，在我上次发表评论后，我意识到从验证表单字段的模糊事件调用此函数是我看到我的保存/提交按钮在启用和禁用状态之间切换的原因。

再次感谢 @ericb 提供的性能提示。

任何人的进一步提示，总是受欢迎的！

**/更新2**

一旦你做到了，禁用按钮就是以`formIsNotValid`任何对你打算如何禁用按钮有意义的方式绑定到计算的 observable 的问题，例如`css: { 'ui-state-disabled': formIsNotValid }`和/或`disable: formIsNotValid`和/或其他一些方法。

希望这会有所帮助，如果您遇到麻烦，请告诉我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T21:28:59.943

我会设置以下内容：

```
saveEnabled = ko.computed(function(){
    // possible other logic
    return shippingMethodModel.Description.isValid();
}); 
```

然后在您的 HTML 中：

```
<button data-bind="enable: saveEnabled"> Save </button> 
```

或者，如果您的模型上有多个属性，您可以执行以下操作：

```
ko.validation.group(shippingMethodModel); 
```

然后在您的 HTML 中：

```
<button data-bind="enable: isValid"> Save </button> 
```

该`group`函数将一个`isValid`属性添加到它的任何组中。

# ruby-on-rails-3 - wash_out gem 创建具有空名称的复杂类型

> ID：12395139
> 
> 赞同：2
> 
> 时间：2012-09-12T19:40:20.350
> 
> 标签：ruby-on-rails-3

创建一个带有清除的可重用类型我注意到它创建了一个具有空名称属性的复杂类型？无论如何，这似乎会生成无效的 WSDL。

```
<xsd:complexType name="">
<xsd:sequence>
<xsd:element name="universe" type="tns:universe"/>
</xsd:sequence>
</xsd:complexType>
<xsd:complexType name="universe">
<xsd:sequence>
<xsd:element name="name" type="xsd:string"/>
<xsd:element name="age" type="xsd:int"/>
</xsd:sequence>
</xsd:complexType> 
```

示例代码

```
 class Fluffy < WashOut::Type
  map :universe => {
        :name => :string,
        :age  => :int
      }
  end

  class FluffyContainer < WashOut::Type
    type_name 'fluffy_con'
    map :fluffy => Fluffy
  end 
```

模块

```
 module soapActions
      def self.sample_request() 
       { :fluffy => Fluffy }
     end
   end 
```

控制器

```
 soap_action "SampleReqest", :args => SbActions.sample_request(), :return => :string 
```

这就是我希望它呈现的内容

```
<xsd:complexType name="universe">
    <xsd:sequence>
    <xsd:element name="name" type="xsd:string"/>
    <xsd:element name="age" type="xsd:int"/>
  </xsd:sequence>
</xsd:complexType> 
```

# javascript - JavaScript 中的 "x == a || b" 和 "x == a || x == b" 是等效的语句吗？

> ID：12395140
> 
> 赞同：-4
> 
> 时间：2012-09-12T19:40:25.537
> 
> 标签：javascript, if-statement

这些陈述如何等效？

var test = '一个'

```
if( test == 'car' || 'one' ){
console.log('spo')
} 
```

和

```
if( test == 'car' || test == 'one' ){
console.log('spo')
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T19:42:02.110

不，它们不相等。

```
if( test == 'car' || 'one' ){
    console.log('spo')
} 
```

相当于

```
if( test == 'car' || 'one' != ''){
  console.log('spo')
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T19:41:41.390

不会。第一次测试总会通过。

如果左侧`||`是假的，它将返回右侧。`'one'`因此将返回右侧 ( )。这是真的，所以测试会通过。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T19:53:21.380

不，他们不是。

在第一个条件中，与`test == 'car' || 'one'` *总是* *计算*为[真值](http://javascriptweblog.wordpress.com/2011/02/07/truth-equality-and-javascript/)（即相等*或*“一”的结果）相同。`(test == 'car') || 'one'`

 **后一个条件仅在 test 为“car”或“one”时产生 true，而在所有其他情况下产生 false。

也可以尝试使用*失败*的测试值，例如“hello”作为反例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T19:42:47.587

不。像Javascript这样的语言接受'one'是真的。所以第一个测试总会通过。第二个具有错误的能力，因为我们不知道测试可能是什么。**

# c++ - 在 Box2D 中找到夹具的中心

> ID：12395141
> 
> 赞同：1
> 
> 时间：2012-09-12T19:40:25.863
> 
> 标签：c++, box2d

我正在尝试在 Box2D 中创建一个“块”系统 - 即连接在一起形成一个大块的形状，这样你就可以将块分成它们自己的身体。

目前，我的系统非常基础（才真正开始），并以 Box2D 测试平台中的“Breakable”测试为模型。它是一个带有很多基本盒子固定装置（稍后将变成多边形）的主体。当您单击一个实体时，它会删除夹具并在与旧“块”相同的位置创建一个具有相同夹具、旋转等的新实体。

但是，我只能让它在大身体的原点
（-> GetWorldCenter）创建新身体。我想做的是找到要删除和替换的灯具的全局位置，这样我就可以在那里制作新的块。

我读过一些关于 b2PolygonShape 有一个“质心”的东西，但我不知道如何访问和使用它......

简而言之，我想找到 FIXTURE 的全局位置（如 x+y 或 b2Vec2），而不是身体（这很容易）。夹具将随着它所连接的主体移动，但我目前只需要一帧的位置（虽然更新它也会很有用）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T19:36:30.193

对于 Box2D 身体的位置不是那么重要。身体位置只是夹具坐标的偏移。它不影响模拟过程。所以，我不明白，你为什么这么关心这个。

我做了这样的事情，可以说，使用大身体的起源很好。您可以查看 Box2D 测试平台到 Breakable 测试。还有用大身躯的本源。我看到的计算新坐标的唯一原因是 SetAngle 方法的奇怪行为。

如果您仍然需要质心，请查看位于 b2PolygonShape.cpp 的 ComputeCentroid。注意，方法不在 b2PolygonShape.h 中声明。您可以从 cpp 复制代码并像这样使用它：

```
b2Fixture* chunk = ...;
b2Vec2 chunkCentroidLocal = ComputeCentorid(chunk->m_vertices, 
    chunk->m_vertexCount);
b2Vec2 chunkCentroidWorld = bigBody->GetWorldPoint(chunkCentroidLocal); 
```

ps不要忘记转换多边形点，当你将创建新的身体。只需找到大体和新体之间的差异，然后从多边形的每个点中减去它。

```
b2Vec2 shift = chunkCentroidWorld - bigBody->GetWorldCenter();
b2Vec2 newVertices = new b2Vec2[chunk->m_vertexCount];
for(int i = 0; i< chunk->m_vertexCount; i++)
{
   newVertices[i] = chunk->m_vertices[i] - shift;
} 
```

# django - 使用 Django 的 CBV，我如何检查 request.user == my_model.user？

> ID：12395143
> 
> 赞同：1
> 
> 时间：2012-09-12T19:40:43.433
> 
> 标签：django

当我使用基于函数的视图时，我经常这样做：

```
def my_view(request, username):
  user = get_object_or_404(User, username = username)
  if user != request.user:
    return HttpRequestForbidden() 
```

这个编码确保只有用户`john`可以访问像`/users/john/edit/`.

如何使用基于类的视图来做同样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:48:44.363

我的问题似乎与[基于 Django 类的 DeleteView 的示例重复](https://stackoverflow.com/questions/5531258/example-of-django-class-based-deleteview)

这是如何做到的：

```
def get_object(self, queryset=None):
    """ Hook to ensure object is owned by request.user. """
    obj = super(MyDeleteView, self).get_object()
    if not obj.owner == self.request.user:
        raise Http404
    return obj 
```

# php - 如何在 WHERE 子句中使用数组值？

> ID：12395146
> 
> 赞同：1
> 
> 时间：2012-09-12T19:40:58.837
> 
> 标签：php, mysql, phpmyadmin

我试图弄清楚如何使用带有 where 子句的数组变量。

当我回显 $deader 时，我得到 23、25、43、56、31、24、64、34 等 .. 这些是我想要更新的 id 号码

```
$sql = mysql_query("UPDATE users SET dead='DEAD' WHERE userID ='(".$deader.")' "); 
```

该数组`$deader`有多个 id 编号值，它只工作并更新 $deader 数组中的第一个 id#。

我正在阅读 Implode 是我需要的，但不知道如何将其转换为功能格式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T19:43:47.877

Use `WHERE ... IN`

```
$sql = mysql_query("UPDATE users SET dead='DEAD' WHERE userID IN (".$deader.")"); 
```

Where $deader is in comma separated format. (for example: `$deader = '143, 554, 32'`)

If it is an array you can use `$deader = implode(',', $deader);` to make it comma separated.

* * *

**Note**: Please stop using mysql_* functions for new code. The functions aren't maintained anymore and the community has begun the deprecation process. See here for more info about converting this to PDO: [How do I convert a dynamically constructed ext/mysql query to a PDO prepared statement?](https://stackoverflow.com/questions/12327363/how-do-i-convert-a-dynamically-constructed-ext-mysql-query-to-a-pdo-prepared-sta/12327364#12327364) (thanks to PeeHaa)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:45:26.130

If `$deader` is some sort of string of values, you will need to use MySQL `IN()` condition. Like this

```
UPDATE users SET dead = 'DEAD" WHERE userID IN ('?', '?', '?') 
```

Where `?` are your values. If userID as an INTEGER field, you can omit the single quotes around the values, if it is a string field, they would be required.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:44:38.667

I think what you're looking for is the IN keyword in SQL.

```
UPDATE users set dead='DEAD' where userID in (100,101,102) 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-12T20:02:11.180

使用 MySQLi 而不是 mysql_*

```
require_once('.dbase'); //contains db constants DB_NAME, DB_USER etc
//using PHP built in connection class mysqli

$mysqli = new mysqli(DB_HOST,DB_UNAME,DB_UPWORD,DB_NAME);

if ($mysqli->connect_errno){
    $err = urlencode("Failed to open database connection: ".$mysqli->connect_error);
    header("Location: error.php?err=$err");
exit();
    }
$deader=implode(',',$deader); //assumes array, sting "143,554,32"
if ($stmt = $mysqli->prepare("UPDATE users SET dead='DEAD' WHERE userID IN (?)"){
    //bind variable to statement object
    $stmt->bind_param('s',$deader) //var type[string],var to bind
    //execute query
    $stmt->execute();
    //feedback
    $rowsAffected = $stmt->affected_rows(); //update doesn't return a result set.
    //close statement object
    $stmt->close();
}
$mysqli->close(); 
```

你们正在抨击 Rickos 使用 mysql_* 但没有解释如何使用它，我的意思只是展示如何使用 mysqli。准备好的语句不是必需的，但是由于您将我的评论标记为（peehaa），因为它没有将其显示为准备好的语句，因此这里将其编辑为准备好的语句。它确实回答了他的问题。

# reporting-services - SSRS 2005 报表执行服务不返回任何结果

> ID：12395150
> 
> 赞同：0
> 
> 时间：2012-09-12T19:41:07.380
> 
> 标签：reporting-services

我有一个报告，正常运行时它返回正确的数据，但是当我通过报告执行服务运行时，报告不包含任何数据。我们确实传递了一个包含我们过滤的 ID 的参数，使用报告上的标签我们可以验证它是否正在发送。

如果查看 ExecutionLogStorage 表，我可以看到我的报告以 rsSuccess 的状态运行，但 RowCount 为 0。事件日志或报告服务器日志中没有错误。

以下是我们用于将报告报告为 PDF 的方法：

```
 public byte[] Render( ReportRequest rptRequest )
    {
        ReportExecutionService rs = new ReportExecutionService();

        rs.Credentials = CredentialCache.DefaultCredentials;
        rs.Url = rptRequest.ReportExecutionServerEndPoint;

        string reportPath = string.Format(
            "/{0}/{1}",
            rptRequest.ReportDataBaseName,
            rptRequest.ReportName );

        string format = "PDF";

        string historyID = null;
        string devInfo =
            @"<DeviceInfo><Toolbar>False</Toolbar></DeviceInfo>";

        string encoding;
        string mimeType;
        string extension;
        Warning[] warnings;
        string[] streamIDs;

        ExecutionHeader execHeader = new ExecutionHeader();

        rs.ExecutionHeaderValue = execHeader;
        rs.LoadReport( reportPath, historyID );

        rs.SetExecutionParameters( rptRequest.ReportParameters, "en-us" );

        return rs.Render(
            format,
            devInfo,
            out extension,
            out encoding,
            out mimeType,
            out warnings,
            out streamIDs );
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T13:31:26.207

事实证明，代码在部署时是在不同的用户帐户下运行的。该帐户无权读取任何数据。

# java - HashMap 中的对象被覆盖 - java

> ID：12395154
> 
> 赞同：0
> 
> 时间：2012-09-12T19:41:17.160
> 
> 标签：java, mysql, hashmap, overwrite

我想创建一个 HashMap，其中键是字符串，值是列表。所有值均取自 Mysql 表。问题是我有一个 HashMap ，其中键是正确的，而值不是正确的，因为它被覆盖了。事实上，对于所有不同的键，我都有相同内容的相同列表。这是代码：

```
public static HashMap<String,List<Table_token>> getHashMapFromTokenTable() throws SQLException, Exception{

DbAccess.initConnection();
List<Table_token> listFrom_token = new ArrayList();
HashMap<String,List<Table_token>> hMapIdPath = new HashMap<String,List<Table_token>>();

String query = "select * from token";
resultSet = getResultSetByQuery(query);

while(resultSet.next()){

    String token=resultSet.getString(3);
    String path=resultSet.getString(4);
    String word=resultSet.getString(5);
    String lemma=resultSet.getString(6);
    String postag=resultSet.getString(7);
    String isTerminal=resultSet.getString(8);
    Table_token t_token = new Table_token();
    t_token.setIdToken(token);
    t_token.setIdPath(path);
    t_token.setWord(word);
    t_token.setLemma(lemma);
    t_token.setPosTag(postag);
    t_token.setIsTerminal(isTerminal);
    listFrom_token.add(t_token);
    System.out.println("path "+path+" path2: "+token);
    int row = resultSet.getRow();

    if(resultSet.next()){
        if((resultSet.getString(4).compareTo(path)!=0)){    
            hMapIdPath.put(path, listFrom_token);
                listFrom_token.clear();
            }
        resultSet.absolute(row);

    }
    if(resultSet.isLast()){
        hMapIdPath.put(path, listFrom_token);
            listFrom_token.clear();
    }

}

DbAccess.closeConnection();

return hMapIdPath;

} 
```

您可以在下面找到 HashMap 内容的示例：

键：p000000383 内容：[t0000000000000019231, t0000000000000019232, t0000000000000019233]

键：p000000384 内容：[t0000000000000019231, t0000000000000019232, t0000000000000019233]

“内容”中的值位于 Mysql 表中相同键的最后一行。

```
 mysql> select * from token where idpath='p000003361';
+---------+------------+----------------------+------------+
| idDoc   | idSentence | idToken              | idPath     |
+---------+------------+----------------------+------------+
| d000095 | s000000048 | t0000000000000019231 | p000003361 |
| d000095 | s000000048 | t0000000000000019232 | p000003361 |
| d000095 | s000000048 | t0000000000000019233 | p000003361 |
+---------+------------+----------------------+------------+
3 rows in set (0.04 sec) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T19:46:51.060

您需要`listFrom_token`每次分配一个新的而不是`clear()`ing 它。替换这个：

```
 listFrom_token.clear(); 
```

和：

```
 listFrom_token = new ArrayList<Table_token>(); 
```

*将*列表放入`HashMap`不会复制列表。你一遍又一遍地清理和重新填写同一个列表。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:45:16.940

您的数据显示 idPath 不是主键。这就是你需要成为地图中的关键。也许您应该使 idToken 成为 Map 中的键 - 这是您的示例中唯一唯一的东西。

您的另一个选择是将列名作为键并将值提供给列表。然后您将有四个键，每个键都有一个包含四个值的列表。*

# regex - 在正则表达式中使用'的 lighttpd mod_rewrite 不起作用

> ID：12395174
> 
> 赞同：0
> 
> 时间：2012-09-12T19:42:28.127
> 
> 标签：regex, apache, mod-rewrite, lighttpd

这是我的 lighttpd 的 mod_rewrite 规则：

```
url.rewrite-once = (
    "^/label/([-'\./\+a-z0-9A-Z]+)/$" => "/index.php?page=label&label=$1",
    "^/riddim/([-'\./\+a-z0-9A-Z]+)/$" => "/index.php?page=riddim&riddim=$1",
    "^/([a-z]+)$" => "/index.php?page=$1",
    "^/(!?pma)([a-z]+)/?$" => "/index.php?page=$1"
) 
```

问题是字符 ' (39 .d) 以某种方式破坏了链接，我收到 404 错误。

```
/riddim/Some+Thing+Here+9.38/ --> works, page is shown
/riddim/Someone's+Stuff+Here/ --> fails, page not found 404 error 
```

我已经尝试过使用“^/riddim/(.+)/$”并且它有效，所以我猜 ' 正在破坏链接/mod_rewrite。我什至尝试转义字符（使用：\'），尽管我从未听说过使用 ' 作为某些特殊字符的正则表达式引擎，但这也失败了。

lighttpd 在网络服务器上运行，在我的计算机上我使用 XAMPP 和 apache，我在那里设置了相同的正则表达式/规则，它工作得很好：

```
RewriteEngine on
RewriteRule ^/label/([-'\./\+a-z0-9A-Z]+)/$ /index.php?page=label&label=$1
RewriteRule ^/riddim/([-'\./\+a-z0-9A-Z]+)/$ /index.php?page=riddim&riddim=$1
RewriteRule ^/([a-z]+)$ /index.php?page=$1 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T00:45:28.500

问题是 ' 将 URL 编码为 %27，即使我的浏览器仍将其显示为 '，这就是正则表达式不匹配的原因，因为字符组尚未包含 %。

新的正则表达式看起来像

```
 "^/riddim/([-'\./\+a-z\%0-9A-Z]+)/$" 
```

并且像魅力一样工作！

# css - 为什么此图像不能使用浮动属性在 css 中水平对齐：

> ID：12395179
> 
> 赞同：2
> 
> 时间：2012-09-12T19:42:52.280
> 
> 标签：css, joomla

提前感谢您可以为我提供的任何帮助 - 我正在努力让这个页面为我的慈善网站工作。它在除 IE 之外的所有浏览器中看起来都很完美。在 IE 中，应该浮动在其他图像旁边的长的垂直图像没有水平对齐。

你可以在这里看到它：www.worldofchildren.org

在此处引用外部样式表：

```
<link rel="stylesheet" href="/bannerincludes/boxes.css" type="text/css" media="screen"> 
```

这是页面上的代码：

```
<div style="width:868px;">
<div style="float:left; position: relative;margin-left:25px; margin-top:20px;width:533px;"">
<h1 style="font-family: Adobe Garamond Pro, Garamond, serif; font-size: xx-large; font-weight: 500;
color: #0D9B89;
padding: 0px 0px 0px 0px; line-height:90%;">meet the 2012 honorees</h1>

<div style="float:left;">

<div class="hover-div1" style="margin-right:6px; margin-bottom:6px; float:left;">
<img src="http://www.worldofchildren.org/images/banner/dallas.jpg">
<div class="hover-text"><a href="http://www.worldofchildren.org/honorees/393" style="color:#fff;">Dallas Jessup <br> 2012 Youth Award Winner</a></div>
</div>

<div class="hover-div2" style="margin-right:6px; margin-bottom:4px; float:left;">
<img src="http://www.worldofchildren.org/images/banner/craig.jpg" >
<div class="hover-text"><a href="http://www.worldofchildren.org/honorees/395" style="color:#fff;">Craig Kielburger <br> 15th Anniversary Achievement Award Winner</a></div>
</div>

<div class="hover-div3" style="margin-bottom:6px; float:left;">
<img src="http://www.worldofchildren.org/images/banner/alina.jpg">
<div class="hover-text"><a href="http://www.worldofchildren.org/honorees/396" style="color:#fff;">Alina Cho <br> 2012 Board of Governors' Award Winner</a></div>
</div>
<br>
<br>

<div class="hover-div4" style="margin-right:5px; margin-bottom:5px;float:left;">
<img src="http://www.worldofchildren.org/images/banner/dryoung.jpg" >
<div class="hover-text"><a href="http://www.worldofchildren.org/honorees/390" style="color:#fff;">Dr. Nilas Young <br> 2012 Health Award Winner</a></div>
</div>

<div class="hover-div5" style="margin-bottom:5px;float:left;">
<img src="http://www.worldofchildren.org/images/banner/kyle.jpg" >
<div class="hover-text"><a href="http://www.worldofchildren.org/honorees/392" style="color:#fff;">Kyle Weiss <br> 2012 Youth Award Winner</a></div>
</div>
</div>

<div style="float:right !important;">
<div class="hover-div6" style="margin-bottom:5px;">
<img src="http://www.worldofchildren.org/images/banner/benito.jpg" >

<div class="hover-text"><a href="http://www.worldofchildren.org/honorees/391" style="color:#fff;">
Beno&#238;t Duch&#226; teau-Arminjon<br> 2012 Humanitarian Award Winner</a></div>
</div>

</div>
</div>

<div style="float:right; margin-top:20px;margin-right:30px; ">
<h1 style="font-family: Adobe Garamond Pro, Garamond, serif; font-size: xx-large; font-weight: 500;
color: #0D9B89;
padding: 0px 0px 0px 0px; line-height:90%;">15th annual awards</h1>

<p style="max-width:250px; font-family:helvetica;sans-serif; font-size:14pt;color:#777; font-weight:lighter; line-height:100%;">Join us as we celebrate the work of six exceptional heroes who have dedicated their lives to serving children in need. Much more than a ceremony, our Awards change the lives of those who attend and the children our Honorees serve.</p>
<br>
<center><a href="http://www.worldofchildren.org/awardsceremony.html"><img src="http://www.worldofchildren.org/images/banner/lm.jpg" border="0"></a><br>

Interested in Sponsorship Opportunities?<br>
<a href="http://www.worldofchildren.org/sponsorships">Click here</a>
</center>

</div>

</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:48:18.990

在您向左浮动的 DIV 上放置一个宽度`width: 420px;`（第一块框）。即使它是浮动的，IE 也会给它它的父级的全宽，所以右边的框没有空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T19:48:46.337

为您的浮动容器添加宽度。现在，你没有宽度，IE 正在用你的左浮动元素填充内联空间。

要在 IE 中调试这些东西，可以使用 IE 开发者工具。

1.  在 IE 中，按 F12 键。
2.  在开发者工具中，点击左上角的“鼠标”图标。这是您的选择器工具。
3.  将选择器工具选择您遇到问题的网站区域。

在您的情况下，您可以看到浮动的左侧元素太宽，因为它的宽度当前是动态的。IE 正在使它填充 100% 的水平区域。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-12T19:51:32.107

而不是浮动，这在 IE9 中有效

```
position: absolute;
right: 0;
bottom: 0; 
```

# objective-c - RKObjectPaginator 没有向服务器发送 GET 请求

> ID：12395180
> 
> 赞同：2
> 
> 时间：2012-09-12T19:42:53.273
> 
> 标签：objective-c, restkit

我有一个`RKObjectPaginator`并且已经设置了必要的参数。但是我的服务器没有收到任何查询。

```
RKURL *patternURL = [[[RKObjectManager sharedManager] baseURL] URLByAppendingResourcePath:ResourcePathPattern];

RKObjectPaginator *paginator = [[RKObjectPaginator alloc] initWithPatternURL:patternURL mappingProvider:[self paginationMappingProvider]];
paginator.delegate = self;
[paginator loadPage:0]; 
```

我的日志控制台显示：

```
2012-09-12 20:56:36.975 keytech search ios[1692:c07] Will load page: 0
2012-09-12 20:58:06.613 keytech search ios[1692:c07] D restkit.network:RKRequest.m:436 Sending asynchronous GET request to URL 'http://-MyServerIP-:8080/keytech/GetNextSearchResults?pageSize=25&pageNumber=0.
2012-09-12 20:58:06.613 keytech search ios[1692:c07] T restkit.network:RKRequest.m:402 Prepared GET URLRequest '<NSMutableURLRequest >http://-MyServerIP-:8080/keytech/GetNextSearchResults?pageSize=25&pageNumber=0>'. HTTP Headers: {
    "Content-Length" = 0;
}. HTTP Body: . 
```

但是没有请求发送到服务器。

我做对了一切吗？如果我在浏览器中发布 URL，服务器会响应良好。似乎未发送此查询。

我不知道为什么不发送此请求。

是否有“最佳实践”示例如何使用`RKObjectPaginator`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T14:55:07.643

您可能无法加载第 0 页。

尝试[分页器加载页面：1]；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T22:52:47.107

我自己也在寻找如何做到这一点的样本。在您的情况下，我相信您缺少 PageCount 和 ObjectCount 属性。在我看来，您必须手动设置它。

BTW：你解决了吗？

# objective-c - NSBlockoperation is not getting cancelled

> ID：12395185
> 
> 赞同：0
> 
> 时间：2012-09-12T19:43:23.090
> 
> 标签：objective-c, ios, asynchronous, uitableview, nsblockoperation

I've a uitableview which shows images in each cell, which are downloaded online.

To make this call async, I use NSBlockoperation. I prefer to use this, because i used GCD before but you cannot cancel GCD. The reason is that if I leave the view, the images gets downloaded at the background of the App, and when I get into the previous view again GCD would let it queue all again, so eventually there would be a whole stack of images and the user would never see the uitableview. So thats why I choose for NSBlockoperation.

However, my blocks don't get cancelled. This is the code I use (it is a part of - (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath { ):

```
// Create an operation without any work to do
    downloadImageOperation = [NSBlockOperation new];

    // Make a weak reference to the operation. This is used to check if the operation
    // has been cancelled from within the block
    __weak NSBlockOperation* operation = downloadImageOperation;

    // Give the operation some work to do
    [downloadImageOperation addExecutionBlock: ^() {
        // Download the image
        NSData *data = [NSData dataWithContentsOfURL:[newsimages objectAtIndex:indexPath.row]];;
        UIImage *image = [[UIImage alloc] initWithData:data];
         NSLog(@"%@",image);
        // Make sure the operation was not cancelled whilst the download was in progress
        if (operation.isCancelled) {
            return;
            NSLog(@"gestopt");
        }
        if (image != nil) {

            NSData* imageData = UIImagePNGRepresentation(image);

            [fileManager createFileAtPath:path contents:imageData attributes:nil];
            cell.imageView.image = image;
            cell.imageView.layer.masksToBounds = YES;
            cell.imageView.layer.cornerRadius = 15.0;

        }

        // Do something with the image
    }];

    // Schedule the download by adding the download operation to the queue
    [queuee addOperation:downloadImageOperation]; 
```

I've used this code to cancel:

```
-(void)viewDidDisappear:(BOOL)animated {
[downloadImageOperation cancel];
} 
```

However, my NSLog tells me that even after my view dissappeared (i put an nslog there), there are still blocks.

```
 2012-09-12 21:32:31.869 App[1631:1a07] <UIImage: 0x3965b0>
 2012-09-12 21:32:32.508 App[1631:1907] <UIImage: 0x180d40>
 2012-09-12 21:32:32.620 App[1631:707] view dissappear!
 2012-09-12 21:32:33.089 App[1631:3a03] <UIImage: 0x3a4380>
 2012-09-12 21:32:33.329 App[1631:5a03] <UIImage: 0x198720> 
```

Notice: there are each time 4 cells displayed in the view, so I think that even though I leave the view they are still in the queue..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:08:28.403

您的代码似乎从来没有超过一个块排队 - 这是正确的吗？如果不是，那么您需要将“取消”发送到队列而不是操作。

无论如何，您的问题很可能是这一行：

```
NSData *data = [NSData dataWithContentsOfURL:[newsimages objectAtIndex:indexPath.row]];; 
```

该下载正在为您同步完成 - 因此，如果您在此消息之后发送“取消”，那么很长一段时间都不会看到取消。这就是为什么大多数开发人员使用并发 NSOperations 使用异步 NSURLConnections 来进行下载 - 所以实时获取取消消息。

假设这是 ARC，您可以在 dealloc 中添加日志，以验证操作实际上已完成或已取消，并且已正确释放。[请注意，您上面的日志是在返回之后，因此永远不会被调用。您还应该在周围散布更多 isCancelled 消息，以便在取消后尽快停止。]

# wix - How to use WIX with Dotfuscator

> ID：12395186
> 
> 赞同：0
> 
> 时间：2012-09-12T19:43:24.633
> 
> 标签：wix, dotfuscator

I've been trying to import an obfuscated project (with Dotfuscator) into an existing WIX installer package, but I can't figure out where to start. Currently the WIX project just has a reference to the application project. But when I pipe the application project into Dotfuscator, I am unable to add a reference to the Dotfuscator project. I'm unaware of any other way to add a project to WIX.

I have the Dotfuscator pro edition.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T21:40:09.650

与其他 .NET 项目类型一样，WiX 支持项目引用和直接文件引用。事实上，WiX 项目和应用程序项目可以在两个不同的解决方案中。您可以构建您的应用程序，进行混淆处理，然后构建您的 WiX 解决方案并获取经过混淆处理的程序集。

换句话说，这更像是一个构建问题，而不是一个 WiX 问题。

# c# - Windows Application .exe not updating by modifying Main method

> ID：12395188
> 
> 赞同：0
> 
> 时间：2012-09-12T19:43:33.637
> 
> 标签：c#, winforms, command-line-arguments

I have created windows application to .. I need to add arguments to Main method so I changed my main method by overloading string[] parameter.

if I change any changes to Program class main method it's not updating through my application .exe why?

copied code Before changing Program.cs

```
static class Program
{
    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        Application.Run(new Form1());
    }
} 
```

copied code below after adding arguments to mainb method i am checking for value and calling a method from other class

```
static class Program
{
    private static string x= string.Empty;
    private static string y= string.Empty;
    private static string z= string.Empty;

    public static void Main(string[] args)
    {
        try
        {
            if (args.Count() > 0)
            {
                if (args.Count() != 3)
                {
                    RootDirectory = args[0];
                    SourceFile = args[1];
                    DestinationFile = args[2];
                    Form1.GetCommandLineArgs(x, y, z);
                }
                else
                {
                    throw new Exception("");
                }
            }
            else
            {
                throw new Exception();
            }
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new Form1());
        }
        catch (Exception ex)
        {
            Common.AppUtilties.LogError(ex, "OnFailure, " + ex.Message);
            Environment.Exit(0);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T15:35:29.870

虽然没有直接回答这个问题，但你可能会更好地使用

[Environment.GetCommandLineArgs](http://msdn.microsoft.com/en-us/library/system.environment.getcommandlineargs.aspx)

我通常将它用于 winforms，因为您可以从代码中的任何位置访问 args。

# math - 旋转超过 360 度

> ID：12395191
> 
> 赞同：1
> 
> 时间：2012-09-12T19:43:48.133
> 
> 标签：math, geometry, angle

我有一个多边形，我想旋转 360 度以上，但仍跟踪整轮。

我将手指的角度定义为可变角度，并且我知道我正在旋转的暴徒的角度，但是在每转一圈后，角度就会重置，因为触摸点和暴徒之间的角度从 360 变为 0，反之亦然。

我怎样才能解决这个问题？

当前代码：

```
double rotation = angle - lastAngle;
selectedMob.rotate((float) (rotation)); 
```

其中 angle 是接触点和 mob 之间的角度，lastAngle 是之前的角度。

方法 rotate 只是将旋转添加到当前角度，如下所示：

```
public void rotate(float angle) {
    this.angle += angle;
} 
```

角度定义为

```
 double rads = Math.atan2(dy, dx);
                double angle = Math.toDegrees(rads); 
```

然后我调整角度，让它从 0 开始，但我确保它从 0 到 360

调试：

```
09-13 00:03:53.708: V/GameActivity(23389): updating frame
09-13 00:03:53.708: V/GameActivity(23389): checked for all mobs
09-13 00:03:53.825: V/GameActivity(23389): Angle of finger is 360.0
09-13 00:03:53.825: V/GameActivity(23389): Angle of mob is 344.94818
09-13 00:03:53.825: V/GameActivity(23389): Last angle is 359.56921278299137
09-13 00:03:53.825: V/GameActivity(23389): Rotation will be 0.43078721700862843
09-13 00:03:53.825: V/GameActivity(23389): ****************
09-13 00:03:53.825: V/GameActivity(23389): updating frame
09-13 00:03:53.825: V/GameActivity(23389): checked for all mobs
09-13 00:03:54.137: V/GameActivity(23389): Angle of finger is 0.4275725068334077
09-13 00:03:54.137: V/GameActivity(23389): Angle of mob is 345.37897
09-13 00:03:54.137: V/GameActivity(23389): Last angle is 360.0
09-13 00:03:54.137: V/GameActivity(23389): Rotation will be -359.5724274931666
09-13 00:03:54.137: V/GameActivity(23389): **************** 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T21:04:11.397

您可以将当前角度修改为与以下范围相同`lastAngle`：

```
while(Math.Abs(angle - lastAngle) > 180)
    angle += (angle > lastAngle ? -360 : 360); 
```

# controller - 如何在 Rails 3.2 中正确使用 Flash 消息

> ID：12395198
> 
> 赞同：4
> 
> 时间：2012-09-12T19:44:05.100
> 
> 标签：controller, twitter-bootstrap, ruby-on-rails-3.2, flash-message

当使用 Twitter-Bootstrap 的样式不正确地提交表单时，我试图简单地呈现一条 Flash 消息。

我显然错过了一些东西，因为我不断收到以下错误：

```
TypeError in NewslettersController#create

can't convert Symbol into String 
```

下面的代码

**看法**

```
 <div class="footer_newsletter_container">
            <%= image_tag("envelope.png", :border=>0, :class => '') %>&nbsp;&nbsp;Sign up for our newsletter</br></br>
            <%= simple_form_for Newsletter.new do |f| %>
              <%= f.input :email, :label => false, :placeholder => 'Enter Your Email Address', class: "floatleft" %><%= f.button :submit, 'Submit', class: "btn floatleft" %>
             <% end %>
            <%= render "layouts/messages" %>
        </div> 
```

**部分的**

```
<% flash.each do |name, msg| %>
  <div class="alert alert-<%= name == :notice ? "success" : "error" %>">
    <a class="close" data-dismiss="alert">&#215;</a>
    <%= content_tag :div, msg, :id => "flash_#{name}" if msg.is_a?(String) %>
  </div>
<% end %> 
```

**控制器**

```
class NewslettersController < ApplicationController

  def create
      @newsletter = Newsletter.new(params[:newsletter])
      if @newsletter.save
        redirect_to :back, notice: "You have been added to our newsletter."
      else
        redirect_to :back, flash[:error] = "Oops, something went wrong. Please try again"
      end
  end

  def destroy
    @newsletter = Newsletter.find(params[:id])
    @newsletter.destroy
  end
end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T19:52:37.033

您的错误行应如下所示：

```
redirect_to :back, flash: {error: "Oops, something went wrong. Please try again"} 
```

# ios - 如何为 iPhone 5 屏幕分辨率开发或迁移应用程序？

> ID：12395200
> 
> 赞同：500
> 
> 时间：2012-09-12T19:44:08.820
> 
> 标签：ios, iphone, screen, iphone-5

新的 iPhone 5 显示屏具有新的纵横比和新的分辨率（640 x 1136 像素）。

开发新的应用程序或将现有的应用程序转换到新的屏幕尺寸需要什么？

为了使旧显示器和新宽屏宽高比的应用程序“通用”，我们应该记住什么？

* * *

## 回答 #1

> 赞同：483
> 
> 时间：2012-09-12T23:13:02.410

1.  下载并安装最新版本的[Xcode](http://itunes.apple.com/us/app/xcode/id497799835?mt=12&at=1l3vpwv&ct=so)。
2.  为您的应用设置启动屏幕文件（在目标设置的常规选项卡中）。这就是你如何使用任何屏幕的完整尺寸，包括 iOS 9 中的 iPad 拆分视图尺寸。
3.  测试您的应用程序，希望不要做任何其他事情，因为如果您正确设置了自动调整大小的掩码或使用了自动布局，一切都应该会神奇地工作。
4.  如果没有，请调整视图布局，最好使用自动布局。
5.  如果您必须专门为较大的屏幕做一些事情，那么看起来您必须检查高度，`[[UIScreen mainScreen] bounds]`因为似乎没有特定的 API。从 iOS 8 开始，还有一些尺寸类可以将屏幕尺寸抽象为垂直和水平的常规或紧凑型，建议采用这种方式来调整你的 UI。

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2012-09-19T20:27:26.653

**如果你有一个为 iPhone 4S 或更早版本构建的应用程序，它会在 iPhone 5 上运行 letterboxed。**

要使您的应用程序适应新的更高屏幕，您要做的第一件事是将启动图像更改为：Default-568h@2x.png。它的大小应为 1136x640 (HxW)。*是的，在新的屏幕尺寸中使用默认图像是让您的应用程序占据整个新 iPhone 5 屏幕的关键*。

*（请注意，命名约定仅适用于默认图像。命名另一个图像“Image-568h@2x.png”不会导致它被加载到“Image@2x.png”的位置。如果您需要加载不同的图像对于不同的屏幕尺寸，您必须以编程方式进行。）*

如果您非常幸运，可能就是这样……但很可能，**您将不得不采取更多步骤。**

*   确保您的 Xibs/Views 使用自动布局来调整自己的大小。
*   使用弹簧和支柱来调整视图大小。
*   如果这对您的应用程序来说还不够好，请为一种特定的屏幕尺寸设计您的 xib/storyboard，并以编程方式为另一种屏幕尺寸重新定位。

在极端情况下（当以上都不满足时），设计两个 Xib 并在视图控制器中加载适当的一个。

检测屏幕尺寸：

```
if(UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone)
{
    CGSize result = [[UIScreen mainScreen] bounds].size;
    if(result.height == 480)
    {
        // iPhone Classic
    }
    if(result.height == 568)
    {
        // iPhone 5
    }
} 
```

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2012-09-16T04:12:15.987

唯一真正需要做的事情是将名为“Default-568h@2x.png”的启动图像添加到应用程序资源中，并且在一般情况下（如果你足够幸运的话）应用程序将正常工作。

如果应用程序不处理触摸事件，请确保键窗口具有适当的大小。解决方法是设置正确的框架：

```
[window setFrame:[[UIScreen mainScreen] bounds]] 
```

迁移到 iOS 6 时，还有其他与屏幕尺寸无关的问题。请阅读[iOS 6.0 发行说明](https://developer.apple.com/library/prerelease/ios/releasenotes/General/RN-iOSSDK-6_0/_index.html#//apple_ref/doc/uid/TP40012166)了解详细信息。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2012-10-11T08:56:51.017

有时（对于预故事板应用程序），如果布局将有很大不同，则值得在 viewController 中根据设备指定不同的 xib（请参阅[此问题](https://stackoverflow.com/questions/8426518/how-to-find-iphone-ipod-device-model3g-3gs-4-4s-by-code)- 您需要修改代码以处理 iPhone 5） init，因为如果您需要不同的图形，那么再多的使用自动调整大小的蒙版也行不通。

```
-(id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil

    NSString *myNibName;
    if ([MyDeviceInfoUtility isiPhone5]) myNibName = @"MyNibIP5";
    else myNibName = @"MyNib";

    if ((self = [super initWithNibName:myNibName bundle:nibBundleOrNil])) {

... 
```

这对于针对旧 iOS 版本的应用程序很有用。

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2012-09-17T13:55:42.167

在这里你可以找到一个很好的教程（对于 MonoTouch，但你也可以使用非 MonoTouch 项目的信息）：
[http ://redth.info/get-your-monotouch-apps-ready-for-iphone-5 -ios-6-今天/](http://redth.info/get-your-monotouch-apps-ready-for-iphone-5-ios-6-today/)

1.  为您的初始/默认屏幕（**640 x 1136 像素**）创建一个名为“ **Default-568h@2x.png** ” 的新图像

2.  在**iOS 模拟器**中，进入硬件 -> 设备菜单，然后选择“ **iPhone (Retina 4-inch)** ”

3.  创建其他图像，例如背景图像

4.  检测 iPhone 5 以加载您的新图像：

* * *

```
public static bool IsTall
{
    get {
        return UIDevice.currentDevice.userInterfaceIdiom
                    == UIUserInterfaceIdiomPhone
                && UIScreen.mainScreen.bounds.size.height
                    * UIScreen.mainScreen.scale >= 1136;
    }
} 
```

* * *

```
private static string tallMagic = "-568h@2x";
public static UIImage FromBundle16x9(string path)
{
    //adopt the -568h@2x naming convention
    if(IsTall())
    {
        var imagePath = Path.GetDirectoryName(path.ToString());
        var imageFile = Path.GetFileNameWithoutExtension(path.ToString());
        var imageExt = Path.GetExtension(path.ToString());
        imageFile = imageFile + tallMagic + imageExt;
        return UIImage.FromFile(Path.Combine(imagePath,imageFile));
    }
    else
    {
        return UIImage.FromBundle(path.ToString());
    }
} 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2012-12-21T07:52:29.780

通过XIB可以轻松迁移iPhone5和iPhone4............

```
UIViewController *viewController3;
if ([[UIScreen mainScreen] bounds].size.height == 568)
{
    UIViewController *viewController3 = [[[mainscreenview alloc] initWithNibName:@"iphone5screen" bundle:nil] autorelease];               
}    
else
{
     UIViewController *viewController3 = [[[mainscreenview alloc] initWithNibName:@"iphone4screen" bundle:nil] autorelease];
} 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2012-11-27T08:02:09.363

[我在这里](https://github.com/mrdepth/tools/tree/master/Retina4)解决了这个问题。只需在图像中添加 ~568h@2x 后缀，在 xib 中添加 ~568h。无需更多运行时检查或代码更改。

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2012-10-26T16:50:42.313

我添加了新的默认启动图像并（在查看其他几个 SE 答案时...）确保我的故事板都自动调整大小和子视图，但 4 英寸的视网膜仍然是信箱。

然后我注意到我的信息 plist 有一个“**启动图像**”的行项目设置为“ **Default.png** ”，因此我将其删除并且神奇的信箱不再出现。希望这可以拯救其他人，就像我忍受的一样疯狂。

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2012-10-28T21:55:35.153

要确定您的应用程序是否可以支持 iPhone 5 Retina，请使用以下命令：（这可能更可靠地返回显示类型、4S Retina 等，但如下所述，它仅在 iPhone 支持 iOS5 Retina 时返回是还是不是）

在一个常见的“.h”文件中添加：

```
BOOL IS_IPHONE5_RETINA(void); 
```

在一个常见的“.m”文件中添加：

```
BOOL IS_IPHONE5_RETINA(void) {
    BOOL isiPhone5Retina = NO;
    if(UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone) {
        if ([UIScreen mainScreen].scale == 2.0f) {
            CGSize result = [[UIScreen mainScreen] bounds].size;
            CGFloat scale = [UIScreen mainScreen].scale;
            result = CGSizeMake(result.width * scale, result.height * scale);

            if(result.height == 960){
                //NSLog(@"iPhone 4, 4s Retina Resolution");
            }
            if(result.height == 1136){
                //NSLog(@"iPhone 5 Resolution");
                isiPhone5Retina = YES;
            }
        } else {
            //NSLog(@"iPhone Standard Resolution");
        }
    }
    return isiPhone5Retina;
} 
```

* * *

## 回答 #10

> 赞同：9
> 
> 时间：2013-01-29T08:11:11.500

在`constants.h`文件中，您可以添加以下定义语句：

```
 #define IS_IPAD UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad 
 #define IS_IPHONE UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone
 #define IS_WIDESCREEN (fabs((double)[[UIScreen mainScreen] bounds].size.height - (double)568) < DBL_EPSILON) 
 #define IS_IPHONE_5 (!IS_IPAD && IS_WIDESCREEN) 
```

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2013-03-26T07:06:43.177

我想，它不会在所有情况下都有效，但在我的特定项目中，它避免了我重复 NIB 文件：

您可以在某处`common.h`根据屏幕高度进行这些定义：

```
#define HEIGHT_IPHONE_5 568
#define IS_IPHONE   ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone)
#define IS_IPHONE_5 ([[UIScreen mainScreen] bounds ].size.height == HEIGHT_IPHONE_5) 
```

在您的基本控制器中：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    if (IS_IPHONE_5) {
        CGRect r = self.view.frame;
        r.size.height = HEIGHT_IPHONE_5 - 20;
        self.view.frame = r;
    }
    // now the view is stretched properly and not pushed to the bottom
    // it is pushed to the top instead...

    // other code goes here...
} 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2013-08-07T05:19:48.967

首先创建两个 xib 并将所有代表、主类`xib`附加`appdelegate.m`到

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 

    if ([[UIScreen mainScreen] bounds].size.height == 568)
        {

        self.ViewController = [[ViewController alloc] initWithNibName:@"ViewControlleriphone5" bundle:nil];
        }

        else
        {
             self.ViewController = [[ViewController alloc] initWithNibName:@"ViewControlleriphone4" bundle:nil];

        } 
```

您可以根据您的要求在程序中的任何位置使用它，即使在您的`ViewController`课程中也是如此。最重要的是您已经创建了两个`xib`单独的文件`iphone 4(320*480) and iphone 5(320*568)`

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2013-02-04T06:42:18.937

在横向模式下检查`bounds`将`568`失败。iPhone 5 仅在纵向模式下启动，但如果您想支持旋转，那么 iPhone 5 的“检查”也需要处理这种情况。

这是一个处理方向状态的宏：

```
#define IS_IPHONE_5 (CGSizeEqualToSize([[UIScreen mainScreen] preferredMode].size, CGSizeMake(640, 1136))) 
```

'preferredMode' 调用的使用来自我几个小时前阅读的另一篇文章，所以我没有想出这个想法。

* * *

## 回答 #14

> 赞同：7
> 
> 时间：2013-02-16T09:40:34.413

您可以使用该`Auto Layout`功能并使用 iPhone 5 屏幕分辨率创建设计，它适用于 4" 和 3.5" 设备，但在这种情况下，您应该对布局管理器有足够的了解。

* * *

## 回答 #15

> 赞同：7
> 
> 时间：2013-03-19T06:16:25.953

在单例类中尝试以下方法：

```
-(NSString *)typeOfDevice
    {
        if(UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone)
        {
            CGSize result = [[UIScreen mainScreen] bounds].size;
            if(result.height == 480)
            {
                return @"Iphone";
            }
            if(result.height == 568)
            {
                return @"Iphone 5";
            }
        }
        else{
            return @"Ipad";;
        }

        return @"Iphone";
    } 
```

* * *

## 回答 #16

> 赞同：6
> 
> 时间：2012-11-27T18:26:40.447

我从来没有在任何设备上遇到过这样的问题，因为我有一个适用于所有人的代码库，没有任何硬编码值。我所做的是将最大尺寸的图像作为资源，而不是每个设备一个。例如，我将有一个用于视网膜显示并将其显示为适合纵横比的方式，因此它将是每台设备上的视图。例如，在运行时决定按钮的框架。为此，我使用专利视图的 % 值，例如，如果我希望宽度为父视图的一半，则取父视图的 50%，并且同样适用于高度和中心。

有了这个，我什至不需要 xibs。

* * *

## 回答 #17

> 赞同：6
> 
> 时间：2013-06-29T10:06:02.573

首先显示此图像。在该图像中，您显示了对 Retina 4 支持的警告，因此单击此警告并单击添加，以便您的 Retina 4 启动屏幕自动添加到您的项目中。

![在此处显示图片](../Images/51627c47e7065c099b365a2c910165e7.png)

使用此代码后：

```
if([[UIScreen mainScreen] bounds].size.height == 568)
    {
        // For iphone 5
    }
    else
    {
        // For iphone 4 or less
    } 
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2013-04-29T10:04:53.273

您可以使用此定义来计算您是否使用基于屏幕尺寸的 iPhone 5：

```
#define IS_IPHONE_5 ( fabs( ( double )[ [ UIScreen mainScreen ] bounds ].size.height - ( double )568 ) < DBL_EPSILON ) 
```

然后使用一个简单的`if`语句：

```
 if (IS_IPHONE_5) {

    // What ever changes
    } 
```

* * *

## 回答 #19

> 赞同：4
> 
> 时间：2012-09-25T15:30:48.917

彼得，你真的应该看看 Canappi，它为你做了所有这些，你所要做的就是指定这样的布局：

```
button mySubmitButton 'Sumbit' (100,100,100,30 + 0,88,0,0) { ... } 
```

从那里，Canappi 将生成正确的 Objective-c 代码，用于检测应用程序运行的设备并将使用：

```
(100,100,100,30) for iPhone4
(100,**188**,100,30) for iPhone 5 
```

Canappi 的工作方式类似于 Interface Builder 和 Story Board 的组合，只是它是文本形式。如果您已经有 XIB 文件，则可以转换它们，这样您就不必从头开始重新创建整个 UI。

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2013-06-04T09:16:43.197

您可以手动检查屏幕尺寸以确定您使用的设备：

```
#define DEVICE_IS_IPHONE5 ([[UIScreen mainScreen] bounds].size.height == 568)

float height = DEVICE_IS_IPHONE5?568:480;
if (height == 568) {
    // 4"

} else {

    // 3"

} 
```

* * *

## 回答 #21

> 赞同：3
> 
> 时间：2012-09-23T13:53:30.167

您可以添加以下代码：

```
if(UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone){
        if ([[UIScreen mainScreen] respondsToSelector: @selector(scale)]) {
            CGSize result = [[UIScreen mainScreen] bounds].size;
            CGFloat scale = [UIScreen mainScreen].scale;
            result = CGSizeMake(result.width * scale, result.height * scale);

            if(result.height == 960) {
                NSLog(@"iPhone 4 Resolution");
            }
            if(result.height == 1136) {
              NSLog(@"iPhone 5 Resolution");
            }
        }
        else{
            NSLog(@"Standard Resolution");
        }
    } 
```

* * *

## 回答 #22

> 赞同：3
> 
> 时间：2013-06-29T10:55:58.153

这是一个真正的通用代码，您可以创建 3 个不同的故事板：

设置您的项目通用模式，并将您的主故事 iPhone 设置为 iPhone5 故事板，将 ipad 主故事设置为 iPad 目标故事板，现在为 iphone 添加新的故事板目标并修改 iphone 4s 或更小的分辨率现在实现您的**AppDelegate.m**

**iPhone4/4s**（与 3/3Gs 相同）一个用于**iPhone5**，并使项目**具有通用性**，并为 iPad 提供一个新的 Storyboard 目标，现在在**AppDelegate.m**下`didFinishLaunching`添加以下代码：

```
 if(UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone){
        UIStoryboard *storyBoard;

        CGSize result = [[UIScreen mainScreen] bounds].size;
        CGFloat scale = [UIScreen mainScreen].scale;
        result = CGSizeMake(result.width *scale, result.height *scale);

//----------------HERE WE SETUP FOR IPHONE4/4s/iPod----------------------

        if(result.height == 960){
            storyBoard = [UIStoryboard storyboardWithName:@"iPhone4_Storyboard" bundle:nil];
            UIViewController *initViewController = [storyBoard instantiateInitialViewController];
            [self.window setRootViewController:initViewController];
        }

//----------------HERE WE SETUP FOR IPHONE3/3s/iPod----------------------

        if(result.height == 480){
            storyBoard = [UIStoryboard storyboardWithName:@"iPhone4_Storyboard" bundle:nil];
            UIViewController *initViewController = [storyBoard instantiateInitialViewController];
            [self.window setRootViewController:initViewController];
        }
    }

        return YES;
 } 
```

**因此，您已经为 iPhone 3/3Gs/4/4s/5 All gen of iPod 和 All type iPad 创建了一个通用应用程序**

请记住将所有 IMG 与`myImage.png`和`myImage@2x.png`

* * *

## 回答 #23

> 赞同：2
> 
> 时间：2013-04-03T12:47:24.907

根据我的说法，处理此类问题并避免检查设备高度所需的几个条件的最佳方法是使用视图的相对框架或您添加到视图中的任何 UI 元素，例如：如果您正在添加您想要的一些 UI 元素应该位于视图底部或标签栏上方，那么您应该相对于视图的高度或相对于标签栏（如果存在）取 y 原点，我们也有自动调整大小的属性。我希望这对你有用

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2013-08-30T14:12:14.400

您可以使用屏幕大小自动调整视图大小，而不是使用一组条件。

```
int h = [[UIScreen mainScreen] bounds].size.height;
int w = [[UIScreen mainScreen] bounds].size.width;
self.imageView.frame = CGRectMake(20, 80, (h-200), (w-100)); 
```

在我的情况下，我想要一个视图来填充顶部的一些输入字段和底部的一些按钮之间的空间，因此根据屏幕大小固定左上角和可变右下角。我的应用程序用相机拍摄的照片填充图像视图，所以我想要我能得到的所有空间。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2014-01-26T10:23:01.700

如果您需要将一个已经存在的应用程序转换为通用应用程序，您需要选择相应的 xib 文件->显示实用程序->显示大小检查器。

在 Size inspector 中你可以看到 Autosizing，通过使用这个工具你可以转换成现有的 iOS App。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2014-05-08T15:51:04.783

使用 xCode 5，在 Project>General 上选择“Migrate to Asset Catalog”。

然后使用“在查找器中显示”找到您的启动图像，您可以将其虚拟编辑为 640x1136，然后将其拖到资产目录中，如下图所示。

**确保 iOS7 和 iOS6 R4 部分都具有 640x1136 的图像。**下次启动应用程序时，黑条将消失，您的应用程序将使用 4 英寸屏幕

![在此处输入图像描述](../Images/d9e1ad8ed1ac9be99a96d8d0cf9ada47.png)

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2014-07-08T08:52:29.960

我建议根据您的 UI 界面在您的应用程序中使用 Autoresizing Mask，它可以节省很多麻烦，并且比为 iPhone 4 和 5 屏幕制作不同的 UI 更好。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2014-10-06T08:36:51.557

值得注意的一点 - 在新的 Xcode 中，您必须将此图像文件 Default-568h@2x.png 添加到资产

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2014-10-10T11:03:37.717

在 iOS 设备和 iOS Simulator 上测试时都会出现一个小问题。似乎模拟器（XCode 6.0.1）`[[UIScreen mainScreen] bounds].size`根据设备方向提供了宽度和高度的切换值。

因此，在确定正确的物理屏幕尺寸时，这可能是一个问题。此代码还有助于区分所有 2014 年。iPhone 型号：

*   iPhone4s
*   iPhone5（和 iPhone5s）
*   iPhone6（和 iPhone6+）

它也可以很容易地改变，以区分 iPhone6 和 iPhone6+。

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {

    CGSize iOSDeviceScreenSize = [[UIScreen mainScreen] bounds].size;

    if ([UIDevice currentDevice].userInterfaceIdiom == UIUserInterfaceIdiomPhone)
    {
        if (iOSDeviceScreenSize.width > 568 || // for iOS devices
            iOSDeviceScreenSize.height > 568) // for iOS simulator
        {   // iPhone 6 and iPhone 6+

            // Instantiate a new storyboard object using the storyboard file named Storyboard_iPhone6
            storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard_iPhone6" bundle:nil];

            NSLog(@"loaded iPhone6 Storyboard");
        }
        else if (iOSDeviceScreenSize.width == 568 || // for iOS devices
                 iOSDeviceScreenSize.height == 568) // for iOS simulator
        {   // iPhone 5 and iPod Touch 5th generation: 4 inch screen (diagonally measured)

            // Instantiate a new storyboard object using the storyboard file named Storyboard_iPhone5
            storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard_iPhone5" bundle:nil];

            NSLog(@"loaded iPhone5 Storyboard");
        }
        else
        {   // iPhone 3GS, 4, and 4S and iPod Touch 3rd and 4th generation: 3.5 inch screen (diagonally measured)

                // Instantiate a new storyboard object using the storyboard file named Storyboard_iPhone4
            storyboard = [UIStoryboard story    boardWithName:@"MainStoryboard_iPhone" bundle:nil];

                NSLog(@"loaded iPhone4 Storyboard");
        }
    }
    else if ([UIDevice currentDevice].userInterfaceIdiom == UIUserInterfaceIdiomPad)
    {   // The iOS device = iPad

        storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard_iPadnew" bundle:nil];

        NSLog(@"loaded iPad Storyboard");
    }

    // rest my code
} 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2015-01-06T08:12:14.457

将该`Auto Layout`功能用于视图。它将自动调整为所有分辨率。

为控制器创建两个 xib，控制器名称带有后缀 ~iphone 或 ~ipad。在编译时，Xcode 会根据设备采用正确的 xib。

如果你想为 iPhone 和 iPad 创建一个单一的 xib，如果视图足够简单，可以移植到 iPhone 和 iPad，请使用 size classes。

# sql - MS SQL Server 2008 R2 Express Script to Write Query to Text file

> ID：12395201
> 
> 赞同：0
> 
> 时间：2012-09-12T19:44:17.570
> 
> 标签：sql, sql-server

I have a query whose results I'd like to write to a text file. I'm doing this across several Db's and output files and so would like to automate it.

I know how to do this in `SSMS` by running the script with the `output` set to `file` but was curious if there is a way to do it in a script.

Ideally something like :

```
SELECT * FROM tablel
OUTPUT TO 'c:\myFile1.txt'    

SELECT * FROM table2
OUTPUT TO 'c:\myFile2.txt'    

SELECT * FROM table3
OUTPUT TO 'c:\myFile3.txt' 
```

Any suggestions?

# azure - 如何在 Azure Project 中使用跟踪诊断

> ID：12395202
> 
> 赞同：0
> 
> 时间：2012-09-12T19:44:22.987
> 
> 标签：azure, azure-worker-roles, azure-diagnostics

在我的解决方案中，我有一个 Azure 工作者角色项目和一个类库（处理我的项目的套接字编程需求）。当我在托管服务上部署解决方案时，出现了问题。在本地开发存储上，一切都像魅力一样.

我在 Azure Worker 角色中包含了 Trace Diagnostics。我如何跟踪类库中发生的错误，因为我无法在类库上使用 Trace（使用时它没有写入存储表）。

有什么方法可以调试 Azure 上托管的类库以及 Worker 角色

问候， 维维克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:21:02.667

您仍然可以在类库中使用 System.Diagnostics 模块来生成自定义跟踪消息。如果诊断监视器配置正确，这些消息将被视为跟踪消息并发送到 Azure 存储。在 Windows Azure 应用程序中，DiagnosticMonitorTraceListener 收集对应用程序中的 System.Diagnostics.Trace 或 System.Diagnostics.Debug 以及应用程序中的其他模块的所有调用。如果没有发生，您可能需要调查原因。

还有另一种选择是在您的类库中添加自定义日志记录，然后将所有这些日志存储到特定文件夹，并通过 Azure 诊断将此文件夹中的日志同步到 blob/表存储。[此处](http://convective.wordpress.com/2009/12/08/custom-diagnostics-in-windows-azure/)描述了向 Azure 角色添加自定义诊断，这篇文章已经过时但仍然适用。

# c# - 如果每件事都应该用引号引起来，如何处理绑定方法

> ID：12395203
> 
> 赞同：2
> 
> 时间：2012-09-12T19:44:26.940
> 
> 标签：c#, asp.net, vb.net

```
<asp:Button ID="btnUnSubmit" Text="UnSubmit" CommandName="UnSubmit" runat="server" CommandArgument=<%# Eval("form_id") %> /> 
```

其实它的说法是正确的，但是根据W3C标准，每个属性都应该用引号括起来，所以更正确的方法是

```
 <asp:Button ID="btnUnSubmit" Text="UnSubmit" CommandName="UnSubmit" runat="server" CommandArgument="<%# Eval("form_id") %>" /> 
```

但是您说“签名会出错，请问如何解决，即使我将 <%# %> 内的“更改为 \” ，也无法解决。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:46:27.977

像这样：

```
<asp:Button ID="btnUnSubmit" Text="UnSubmit" CommandName="UnSubmit" runat="server" CommandArgument='<%# Eval("form_id") %>' /> 
```

大多数情况下 the`"`和 the`'`在 HTML 中是可以互换的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:48:14.293

使用单引号：

```
CommandArgument='<%# Eval("form_id") %>' /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T18:17:33.577

使用`'`（单引号）而不是`"`（双引号）。

# c# - 为提高效率而使用 property.setvalue() 的替代方法

> ID：12395204
> 
> 赞同：4
> 
> 时间：2012-09-12T19:44:30.747
> 
> 标签：c#, asp.net, reflection

property.setvalue() 有哪些替代方法？我读过它非常慢。我正在使用它将 IDataReader 映射到 POCO 对象。

这是代码的截断版本。这里的一切对我来说都很新鲜。我知道有很多框架可以完成这项任务。但是，我们不能使用它们。

```
public class DbAutoMapper<T>
{
    public IEnumerable<T> MapToList(IDataReader reader)
    {
        var list = new List<T>();

        while (reader.Read())
        {                
            var obj = Activator.CreateInstance<T>();

            foreach (PropertyInfo prop in obj.GetType().GetProperties())
            {
                foreach (var attribute in prop.GetCustomAttributes(true))
                {                        
                    prop.SetValue(obj, value, null);                        
                }
            }

            list.Add(obj);
        }
        return list;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T20:10:02.463

首先：当你不*使用*属性时，为什么要为每个属性重复反射？

第二：假设您打算按名称、列到属性（这不是代码当前所做的）来映射它，请考虑像[dapper](http://nuget.org/packages/Dapper)这样的工具，它**会为您完成所有这些工作**，包括缓存的高性能反射发射。它还将为您处理命令本身。例如：

```
string region = "North";
var customers = conn.Query<Customer>(
    @"select * from Customers where Region = @region",
    new { region } // full parameterization, the easy way
).ToList(); 
```

如果您需要更多控制，请考虑[FastMember](http://nuget.org/packages/FastMember)，它提供快速成员访问（同样，反射发射），但不特定于数据访问：

```
var accessor = TypeAccessor.Create(typeof(T)); 
string propName = // something known only at runtime 
while( /* some loop of data */ ) {
    var obj = new T();
    foreach(var col in cols) {
        string propName = // ...
        object cellValue = // ...
        accessor[obj, propName] = cellValue;
    }
    yield return obj;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:56:25.800

想到了几种方法...

**跳过反射**

```
public class DbAutoMapper<T> where T : IInitFromReader, new()
{
    public IEnumerable<T> MapToList(IDataReader reader)
    {
        var list = new List<T>();

        while (reader.Read())
        {                
            IInitFromReader obj = new T;

            obj.InitFromReader(reader);

            list.Add(obj);
        }
        return list;
    }
} 
```

然后，您必须在每个实体对象中实现 InitFromReader。显然，这跳过了反射的好处（更少的代码）。

**代码生成**

为 (InitFromReader) 维护此代码很痛苦，因此您可以选择生成它。这在许多方面为您提供了两全其美：

*   您不必（手动）维护大量代码
*   您不会受到反射的性能影响。

# vba - 在 MS Access 中附加链接表时出现运行时错误

> ID：12395208
> 
> 赞同：5
> 
> 时间：2012-09-12T19:44:49.990
> 
> 标签：vba, ms-access, ms-access-2003

我有一个链接到 Excel 电子表格的数据库。当手动添加链接表时，我没有任何问题（我只是按照小向导操作，表就完美创建了）。我正在尝试使用 VBA 自动化：

```
Dim db as DAO.Database
Dim tdf as TableDef

Set db = CurrentDB
Set tdf = db.CreateTableDef("linked_table")
tdf.Connect = "Excel 8.0;HDR=YES;IMEX=2;DATABASE=" & Me.txtExcelFile  ' references form field
db.TableDefs.Append tdf  ' Here's where I get a run time error 
```

不幸的是，我在最后一行收到运行时错误 3264，它说：“未定义字段——无法附加 TableDefs 或索引。” 我什至不确定为什么需要最后一行（从文档中我发现它似乎是将表添加到数据库的 TableDefs 集合中）。有关解决错误的任何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T19:49:13.053

你错过了：

```
tdf.SourceTableName = "Sheet1$" 
```

或者您希望用作表格的任何范围或工作表名称。

所以，总的来说，这对我有用：

```
Dim db as DAO.Database
Dim tdf as TableDef

Set db = CurrentDB
Set tdf = db.CreateTableDef("linked_table")
tdf.SourceTableName = "Sheet1$"
tdf.Connect = "Excel 8.0;HDR=YES;IMEX=2;DATABASE=" & Me.txtExcelFile  ' references form field
db.TableDefs.Append tdf 
```

您还可以使用 TransferSpreadsheet 链接 Excel

# java - How can I integrate spring security with an existing web application

> ID：12395213
> 
> 赞同：1
> 
> 时间：2012-09-12T19:45:25.537
> 
> 标签：java, spring, tomcat, web-applications, spring-security

FYI, I'm using Tomcat 5.5.

Simply put, I want to integrate Spring Security into an existing web application. The web app is proprietary; I have no access to its Java source code. The name of the web app is [BMC ARS Remedy Mid-Tier](http://en.wikipedia.org/wiki/AR_Mid-Tier), and I do have access to the web.xml file, of course. I'm not looking to build a Spring MVC application.

Is there a tutorial or guide which shows you how to integrate Spring Security with a "black box" web application?

Thank you very much for any help.

# java - 如何附加到现有的 Java EE 会话

> ID：12395219
> 
> 赞同：0
> 
> 时间：2012-09-12T19:45:47.487
> 
> 标签：java, web-services, jakarta-ee, session-variables

我有一个外部 SOAP Web 服务，它附加到应用程序内的服务层。对于 Web 2.0 应用程序，服务层使用会话来存储用户的“钥匙链”或用户可以在系统中执行的操作。

现在我试图弄清楚如何用我的 web 服务客户端对我们的服务层做同样的事情。问题是 Web 服务 URL 不能包含保存会话 ID 的 cookie。（如果我错了，请说出如何，我会那样做。）

当 Web 服务客户端第一次连接时，我需要登录并生成唯一标识该用户的安全密钥，并将在一定期限内过期，要求他们再次登录。

我想在我的端点中找到一种方法来重新附加到该安全密钥的正确会话，然后安全性将自动工作。

我的端点当前由 tomcat 提供服务。

我怎样才能从这里到达那里？

所有输入表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:06:01.800

我最终使用 REST 通过 URL 返回到我们的 web 应用程序，这样我就有了一个会话。我就是这样连接的。

# jquery - struts2 access session var in sj:head

> ID：12395221
> 
> 赞同：0
> 
> 时间：2012-09-12T19:45:51.330
> 
> 标签：jquery, struts2

I have a problem with session var in sj:head:

```
<sj:head locale="%{#session.language}" jqueryui="true" jquerytheme="%{#session.viewTheme}" /> 
```

Doesn't set either locale or theme. Variables are set properly, line below displays correct values:

```
selected locale: <s:property value="%{#session.language}"/><br>
selected theme: <s:property value="%{#session.viewTheme}"/> 
```

I played with #session.var %{#session.var} and similar and none of them works. How can I use session vars in sj:head?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T22:24:23.657

对于您的主题问题，请尝试以下操作：

**主题**试试这个：

```
$(function(){
  $('#jquery_theme_link').attr('href',
                               'struts/themes/'
                               +<s:property value="%{#session.viewTheme}"/>
                               +'/jquery-ui.css');
}); 
```

**语言环境**试试这个：

```
<sj:head locale="%{#session.locale}"/> 
```

这将注入支柱语言环境。如果你想改变语言环境，你可以使用 struts 改变它，确保

```
<interceptor-ref name="i18n"/> 
```

在你的堆栈中。

# python - Click on a dropdown element menu with Selenium Webdriver

> ID：12395228
> 
> 赞同：11
> 
> 时间：2012-09-12T19:46:11.933
> 
> 标签：python, selenium, automation, webdriver, selenium-webdriver

I'm trying to automate an administration task, so far I have made selenium to click on an element to show a dropdown menu.

![enter image description here](../Images/2324c12942133a8f9efc0d024f1893eb.png)

When it comes the time to click on one of those menu elements I've got an error saying that the element must be displayed.

Code:

```
 driver = webdriver.Chrome()
 driver.implicitly_wait(10)
 driver.get(url)
 doc = driver.find_element_by_css_selector('td.ms-vb-title > table')
 try:
    doc.click()
    time.sleep(4)
    menu = driver.find_element_by_xpath('//menu/span[5]')
    time.sleep(4)
    print dir(menu)
    menu.click()
 except:
    traceback.print_exc()
    driver.quit() 
```

Error:

```
Traceback (most recent call last):
  File "aprobar_docs.py", line 22, in main
    menu.click()
  File "C:\Python27\lib\site-packages\selenium\webdriver\remote\webelement.py",
line 52, in click
    self._execute(Command.CLICK_ELEMENT)
  File "C:\Python27\lib\site-packages\selenium\webdriver\remote\webelement.py",
line 205, in _execute
    return self._parent.execute(command, params)
  File "C:\Python27\lib\site-packages\selenium\webdriver\remote\webdriver.py", l
ine 156, in execute
    self.error_handler.check_response(response)
  File "C:\Python27\lib\site-packages\selenium\webdriver\remote\errorhandler.py"
, line 147, in check_response
    raise exception_class(message, screen, stacktrace)
ElementNotVisibleException: Message: u'Element must be displayed to click' 
```

As you can see the code waits a lot to get the element loaded. I've also tried to set the element's `is_displayed` property to `True` but didn't work neither.

Note: the element that's not displayed is the one on the xpath search, it is present because I've logged it with dir(menu)

**Edit:**

The `menu` variable is not the menu itself it's one of the spans that are elements of the menu, `doc` is the `Perfil` html element getting clicked to show the dropdown.

**Edit 2:**

Inspecting the DOM on chrome tools, when you click a `doc` a new menu gets created on the tree, I don't know if it's because of an ajax call or vanilla js, I don't think it's really that important how it's created. I can't retrieve it from the page and make a python object from it, it's just not being displayed at least on code.

**Final Edit:**

I ended up executing some JavaScript to make it work. Apparently when Selenium finds the menu item the first element that triggers the menu drop down loses the focus and it makes the menu invisible again, if you don't select a menu item and wait for some time the menu dropdown still is shown, if you try to select one element from the menu the menu disappears.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-12T20:12:42.787

你为什么不选择这样的选项

```
el = driver.find_element_by_id('id_of_select')
for option in el.find_elements_by_tag_name('option'):
    if option.text == 'The Options I Am Looking For':
        option.click() # select() in earlier versions of webdriver 
```

如果您的点击没有触发 ajax 调用来填充您的列表，那么您实际上不需要执行点击。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T23:50:32.320

您需要找到目标的链接。您并没有*真正*单击元素，而是单击链接......（或者更确切地说，您单击其中包含链接的元素）。话虽如此，点击链接最可靠的方法是隔离链接元素。

```
frame = driver.find_element_by_id('this_is_your_frame_name') 
links = frame.find_elements_by_xpath('.//a')
links[1].click() 
```

或者，

```
for link in links:
    if link.text() == "Administratar Permisos":
        link.click() 
```

# c# - 使用 DotNetOpenAuth 向 Twitter 帐户发布推文

> ID：12395229
> 
> 赞同：4
> 
> 时间：2012-09-12T19:46:12.447
> 
> 标签：c#, winforms, twitter, dotnetopenauth

我正在尝试寻找一个示例，说明如何使用 C# 和 DotNetOpenAuth 在我的 Twitter 帐户上简单地发布推文。我想从 WinForms 应用程序中执行此操作。我发现的示例似乎使用 ASP.NET 和 WebForms。具体来说，我正在挂断“验证码”。这是我到目前为止的代码：

```
private McMurryTokenManager TokenManager
{
    get
    {
        McMurryTokenManager tokenManager = null;

        string consumerKey = ConsumerKey;
        string consumerSecret = ConsumerSecret;
        if (!string.IsNullOrEmpty(consumerKey))
        {
            tokenManager = new McMurryTokenManager 
                { ConsumerKey = consumerKey, ConsumerSecret = consumerSecret };
        }

        return tokenManager;
    }
}

public Form1()
{
    InitializeComponent();

    var twitter = new DesktopConsumer(TwitterConsumer.ServiceDescription, TokenManager);
    string requestToken;
    twitter.RequestUserAuthorization(null, null, out requestToken);
    var accessTokenResponse = twitter.ProcessUserAuthorization(requestToken, null);
} 
```

我收到一条错误消息，说验证器代码不能为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T02:11:25.710

这是您需要做的：

1.  RequestUserAuthorization 方法返回授权页面的 URL。
2.  您应该将用户重定向到该页面，通常是 Process.Start(url)，用户将在其中授权您的应用程序。
3.  Twitter 将用户重定向到具有多位数字的页面，即验证者。
4.  在您将用户发送到授权页面后，您的应用程序应该等待一个对话框或提示，以便用户可以输入验证程序并将其提交给您的应用程序。
5.  获得验证者后，将其作为第二个参数传递给 ProcessUserAuthorization。

这是一篇博客文章，内容类似，并有一个代码示例：

[http://whelkaholism.blogspot.com/2010/08/c-doing-stuff-with-google-using-oauth.html](http://whelkaholism.blogspot.com/2010/08/c-doing-stuff-with-google-using-oauth.html)

# jquery - Calculate two numbers in jQuery

> ID：12395231
> 
> 赞同：0
> 
> 时间：2012-09-12T19:46:17.617
> 
> 标签：jquery

i have problem calculate 2 numbers has comma in jquery or javascript

i take the first and second number from div "attr"

this is my example code

```
var firstnumber = $('.first_price').attr('price'); //its 5,000
var secondnumber = $('.second_price').attr('price'); //its 6,000

$('#total').html( Math.floor(firstnumber+secondnumber) );

//also tried
$('#total').html( Number(firstnumber+secondnumber) ); 
```

its return 0 , but when i remove the comma from the price its retruen 11000 how to make it return 11,000 i mean i need it to calculate the two numbers if they has comma any help ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T19:56:23.077

这是答案：

```
var firstnumber = $('.first_price').data('price').replace( /[\$,]/g, '' ) ; 
var secondnumber = $('.second_price').data('price').replace( /[\$,]/g, '' ) ;
var total = Math.floor(firstnumber+secondnumber)
$('#total').html( formatCurrency(total)  );

function formatCurrency( amount ) {
amount = ('' + amount).replace( /[$,]/g, '' );
if( isNaN( amount ))
    amount = '0';

var cents = Math.round( amount * 100 ); // Total number of cents
amount = Math.abs( amount > 0 ? Math.floor(amount) : Math.ceil(amount) ) + ''; // Number of complete dollars

for( var i = 0; i < Math.floor( (amount.length - ( 1 + i )) / 3 ); i++ )
    amount = [amount.substring( 0, amount.length - ( 4 * i + 3 ) ), amount.substring( amount.length - ( 4 * i + 3 ))].join(',');

return (cents >= 0 ? '' : '-') + amount + '.' + (Math.abs(cents) % 100).zeroFill(2); 
```

}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:50:28.847

您必须删除逗号，然后重新应用逗号

```
var firstnumber = $('.first_price').data('price');
var secondnumber = $('.second_price').data('price');
firstnumber  = firstnumber.replace(/,/g , '');
secondnumber = secondnumber.replace(/,/g , '');
var result = addCommas(firstnumber+secondnumber); 
```

添加逗号的功能

```
function addCommas(nStr){
nStr += '';
x = nStr.split('.');
x1 = x[0];
x2 = x.length > 1 ? '.' + x[1] : '';
var rgx = /(\d+)(\d{3})/;
while (rgx.test(x1)) {
    x1 = x1.replace(rgx, '$1' + ',' + '$2');
}
return x1 + x2;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:48:28.687

您需要将字符串转换为数字：

```
var firstnumber = +$('.first_price').attr('price');
var secondnumber = +$('.second_price').attr('price'); 
```

但是，与其使用纯字符串的无效属性，不如考虑`data-price="5000"`在您的 HTML 中使用；那么以下代码将正常工作：

```
var firstnumber = $('.first_price').data('price');
var secondnumber = $('.second_price').data('price'); 
```

哦，不要把那几千个分隔符放在你的价格里。它们根本不属于*数据*；那是一个*显示*的东西。如果您无法摆脱它们，您需要在这两种情况下都转换为 int 但首先将它们删除 ( `.replace(/,/g, '')`)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T19:50:37.933

因为还不是数字，是字符串，去掉逗号

```
var firstnumber = $('.first_price').attr('price').replace(/[^\d.]/g,''); //its 5,000
var secondnumber = $('.second_price').attr('price').replace(/[^\d.]/g,''); //its 6,000

$('#total').html( Math.floor(firstnumber+secondnumber) ); 
```

我将正则表达式更改为仅保留有效的数值（数字和小数位）并删除其余部分。由于这些是价格，负数应该是一个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T19:52:40.563

尝试：

```
$('#total').html(  Math.floor(parseInt(firstnumber.replace(',',''),10)+parseInt(secondnumber.replace(',',''),10)) )); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/73H7B/)**

在将字符串解析为整数之前，您需要去掉逗号。

# sql - Oracle SQL：选择值列表的第一个日期

> ID：12395235
> 
> 赞同：0
> 
> 时间：2012-09-12T19:46:43.990
> 
> 标签：sql, oracle

我会尽力解释这一点。

我有一个要求，我需要输入案件的第一封信发送日期。

```
Case     |   Letter_Sent_Date
1234     |   05/29/2012
1234     |   05/30/2012
1234     |   06/01/2012 
```

如何构建一个 oracle sql，其中以下“WHERE”条件将排除此案例出现在报告中？

```
WHERE Letter_Sent_Date between '01JUN2012' and '30JUN2012' 
```

由于发送的第一封信不是在 6 月，我不希望它出现在这份报告中，并且只在我运行 5 月份的报告时出现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:03:39.760

我会为此使用 MIN 窗口/分析函数：

```
select case_id, letter_sent_date
from (select case_id, letter_sent_date,
             min(letter_sent_date) over (partition by case_id) as mindate
      from t
     ) t
where mindate between '01JUN2012' and '30JUN2012' 
```

这消除了基于发送第一封信的时间的所有情况。如果您只想消除该行，那么 AriStorm 会回答这个问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T19:54:59.813

您可以在一个查询中获取第一个字母，然后在其上写一个 where 以根据日期范围进行过滤。

为了得到案例和第一个字母..

```
select case_id,
       letter_sent_date
  from (
    select case_id,
           letter_sent_date,
           rank () over (partition by case_id order by letter_sent_date asc) rnk
      from case_table
       )
  where rnk = 1 
```

仅获取在您指定的日期发送第一封信的情况..

```
select case_id,
      letter_sent_date
 from (
    select case_id,
           letter_sent_date,
           rank () over (partition by case_id order by letter_sent_date asc) rnk
      from case_table
      )
 where rnk = 1
   and letter_sent_date between to_date('01-JUN-2012','DD-MON-YYYY) 
                            and to_date('30-JUN-2012','DD-MON-YYYY') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:55:57.157

如果我理解您在寻找什么：

```
选择大小写、letter_sent_date {，以及您想要从表中获取的任何其他字段}
从表名
其中 letter_sent_date 在 '01-jun-2012' 和 '30-jun-2012' 之间

```

这将输出

```
案例 | letter_date_sent
第1234章 2012 年 6 月 1 日

```

如果这不是您想要的，请澄清您的要求:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T08:57:48.617

或老派 GROUP/HAVING：

```
 SELECT case_id, MIN(letter_sent_date)
   FROM case_table
  GROUP BY case_id
 HAVING MIN(letter_sent_date) BETWEEN '01-JUN-2012' and '30-JUN-2012' 
```

# ruby-on-rails-3 - Writing arbitrary attributes on a model is deprecated. (Multiple belongs_to on model)

> ID：12395236
> 
> 赞同：16
> 
> 时间：2012-09-12T19:46:47.143
> 
> 标签：ruby-on-rails-3, activerecord

I have multiple `belongs_to` relationships to the same model. Modeling messages between two users as follows (in the `Message` model):

```
 belongs_to :to, :class_name => 'User', :foreign_key => 'to_id'
  belongs_to :from, :class_name => 'User', :foreign_key => 'from_id'

  attr_accessible :to, :from # ... 
```

The corresponding `has_many` calls are in the `User` model. Everything works in the spec and the console as I need it to, with the exception of the following deprecation warning (for both `from_id` and `to_id`):

```
DEPRECATION WARNING: You're trying to create an attribute `from_id'. Writing arbitrary attributes on a model is deprecated. Please just use `attr_writer` 
```

The relevant spec follows:

```
 it "can associate users" do
    User.delete(:all)
    ufrom = FactoryGirl.create(:DrKevorkian)
    ufrom.save!
    uto = FactoryGirl.create(:JohnSmith)
    uto.save!

    m = Message.new
    m.from = ufrom   # <-- Warning here
    m.to = uto       # <-- Warning here
    m.save

    m.from.id.should == ufrom.id
    m.to.id.should == uto.id

  end 
```

It seems to me the warning is happening as a result of the `belongs_to` association -- is there a cleaner/better way to do this?

Thanks very much.

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-10-09T12:45:47.183

我的经验是，如果您忘记运行`rake db:migrate`并且`rake db:test:prepare`在更改架构后会收到此警告。

# jquery - Posabsolute 的 jQuery 验证引擎和 CkEditor

> ID：12395239
> 
> 赞同：3
> 
> 时间：2012-09-12T19:46:54.290
> 
> 标签：jquery, ckeditor, jquery-validation-engine

我已经搜索了该网站（和 Google），但找不到解决我问题的有效解决方案。

我正在使用 Posabsolute 的验证引擎，它工作得很好。除了我的问题孩子 - 我的 CKeditor 格式化文本区域。

我知道我需要使用 评估 textarea `CKEditor.instances.textareaid.updateElement()`，但无法使其正常工作。

有人对如何工作有任何提示/解决方案吗？也许我需要覆盖validationEngine.js 中的一个设置？

任何指针都将受到欢迎:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-09-30T09:24:42.903

```
jQuery(function()
{
    CKEDITOR.replace("editor_id",
    {
        width:"750px",
        height:"300px",
        on:
        {
            instanceReady: function(ev)
            { 
                jQuery("#editor_id").css({display:"block",visibility:"hidden",position:"absolute"});
                this.document.on("keyup", CK_jQ);
                this.document.on("paste", CK_jQ);
            }
        }
    });
});

function CK_jQ()
{
    CKEDITOR.tools.setTimeout( function()
    { 
        jQuery("#editor_id").val(CKEDITOR.instances.editor_id.getData()); 
    }, 0);
}

function validateFrm()
{
    if(JQObj('#'+frmID).validationEngine('validate'))
    {
        return true;
    } 
    else
    {
        return false;
    }
} 
```

//你的html如下

表单方法="post" name="formId" id="formId" action="" enctype="multipart/form-data" onsubmit="return validateFrm('formId');"

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-19T14:06:33.493

我已经这样做了：

```
 if(typeof CKEDITOR !== 'undefined'){
               for(var i in CKEDITOR.instances){ //editors
                $("form textarea[name="+CKEDITOR.instances[i].name+"]").addClass("validate[required]");
                $("form textarea[name="+CKEDITOR.instances[i].name+"]").attr("data-prompt-position", 'bottomLeft:400,0');
               }
            } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-05T15:58:56.983

请记住，ValidationEngine 仅验证可见字段，CKeditor 使用`visibility: hidden; display: none;`内联样式隐藏原始文本区域或 div。
正如您所发现的，需要此代码`CKEditor.instances.textareaId.updateElement()`将编辑器区域的内容传输回原始元素，但还需要做更多工作。

您还需要使原始元素再次可见，并使用`$('#textareaId').toggle()`or`$('#textareaId').show()`执行此操作。现在您可以使用以下方法验证所有字段：

```
$('#formId').validationEngine('validate'); 
```

现在出现另一个问题，错误提示不是在编辑器区域附近，而是在原始元素处，因为`visibility: hidden`，但这不是问题。我们只需使用`$('#textareaId').toggle()`or再次隐藏原始元素`$('#textareaId').hide()`，以使提示符与编辑器对齐。

# 完整代码

此代码使用 CKEditor v4 和 validationEngine v2.5。

```
<form id="yourFormId" onsubmit="return validate(this);">
<textarea id="textareaId" class="ckeditor"></textarea>
</form>
<script>
function validate(form) {
    CKEDITOR.instances.textareaId.updateElement();
    $('#textareaId').toggle();
    validated = $(form).validationEngine('validate');
    $('#textareaId').toggle();

    return validated;
}
</script> 
```

如果您有多个编辑器元素，您可能需要添加一个循环。
此代码的唯一*缺点*是硬编码的原始 elementId(s)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-12T13:57:19.727

我宁愿使用一些 CSS 技巧。我会将这种样式用于 textarea

```
.wysiwyg-editor{
    visibility: hidden !important;
    display: block !important;
    height: 0px;
} 
```

我认为这是一个更清洁的解决方案。

# ruby-on-rails-3 - 设计 + OmniAuth NoMethodError UndefinedMethod 用户名

> ID：12395241
> 
> 赞同：5
> 
> 时间：2012-09-12T19:47:02.993
> 
> 标签：ruby-on-rails-3, devise, omniauth

我正在关注 Railscast #235 “Devise + OmniAuth Revised”，每当我尝试使用 Twitter 进行身份验证时，都会遇到用户名的 NoMethodError。我正在运行 Rails 3.2。

具体来说，它写道：

```
NoMethodError in OmniauthCallbacksController#twitter
undefined method `username' for #<User:0x007fa4744561c0>

app/models/user.rb:11:in `from_omniauth'
app/controllers/omniauth_callbacks_controller.rb:3:in `all' 
```

我是 Rails 的新手，所以任何帮助都将不胜感激。这是我的代码：

omn​​iauth_callbacks_controller：

```
 class OmniauthCallbacksController < Devise::OmniauthCallbacksController
  def all
    user = User.from_omniauth(request.env["omniauth.auth"])
    if user.persisted?
      flash.notice = "Signed in!"
      sign_in_and_redirect user
    else
      session["devise.user_attributes"] = user.attributes
      redirect_to new_user_registration_url
    end
  end
  alias_method :twitter, :all
end 
```

用户模型：

```
class User < ActiveRecord::Base
  devise :database_authenticatable, :registerable, :omniauthable,
         :recoverable, :rememberable, :trackable, :validatable

  attr_accessible :email, :password, :password_confirmation, :remember_me, :username

  validates_presence_of :username
  validates_uniqueness_of :username

  def self.from_omniauth(auth)
    where(auth.slice(:provider, :uid)).first_or_create do |user|
      user.provider = auth.provider
      user.uid = auth.uid
      user.username = auth.info.nickname
    end
  end

  def self.new_with_session(params, session)
    if session["devise.user_attributes"]
      new(session["devise.user_attributes"], without_protection: true) do |user|
        user.attributes = params
        user.valid?
      end
    else
      super
    end
  end

  def password_required?
    super && provider.blank?
  end

  def update_with_password(params, *options)
    if encrypted_password.blank?
      update_attributes(params, *options)
    else
      super
    end
  end
end 
```

框架跟踪：

```
activemodel (3.2.8) lib/active_model/attribute_methods.rb:407:in `method_missing'
activerecord (3.2.8) lib/active_record/attribute_methods.rb:149:in `method_missing'
activemodel (3.2.8) lib/active_model/errors.rb:254:in `block in add_on_blank'
activemodel (3.2.8) lib/active_model/errors.rb:253:in `each'
activemodel (3.2.8) lib/active_model/errors.rb:253:in `add_on_blank'
activemodel (3.2.8) lib/active_model/validations/presence.rb:8:in `validate'
activesupport (3.2.8) lib/active_support/callbacks.rb:310:in `_callback_before_35'
activesupport (3.2.8) lib/active_support/callbacks.rb:473:in `_run__3967236747236009763__validate__2888041296400006394__callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_validate_callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'
activemodel (3.2.8) lib/active_model/validations.rb:227:in `run_validations!'
activemodel (3.2.8) lib/active_model/validations/callbacks.rb:53:in `block in run_validations!'
activesupport (3.2.8) lib/active_support/callbacks.rb:425:in `_run__3967236747236009763__validation__2888041296400006394__callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_validation_callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'
activemodel (3.2.8) lib/active_model/validations/callbacks.rb:53:in `run_validations!'
activemodel (3.2.8) lib/active_model/validations.rb:194:in `valid?'
activerecord (3.2.8) lib/active_record/validations.rb:69:in `valid?'
activerecord (3.2.8) lib/active_record/validations.rb:77:in `perform_validations'
activerecord (3.2.8) lib/active_record/validations.rb:50:in `save'
activerecord (3.2.8) lib/active_record/attribute_methods/dirty.rb:22:in `save'
activerecord (3.2.8) lib/active_record/transactions.rb:241:in `block (2 levels) in save'
activerecord (3.2.8) lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'
activerecord (3.2.8) lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'
activerecord (3.2.8) lib/active_record/transactions.rb:208:in `transaction'
activerecord (3.2.8) lib/active_record/transactions.rb:293:in `with_transaction_returning_status'
activerecord (3.2.8) lib/active_record/transactions.rb:241:in `block in save'
activerecord (3.2.8) lib/active_record/transactions.rb:252:in `rollback_active_record_state!'
activerecord (3.2.8) lib/active_record/transactions.rb:240:in `save'
activerecord (3.2.8) lib/active_record/persistence.rb:45:in `create'
activerecord (3.2.8) lib/active_record/relation.rb:87:in `block in create'
activerecord (3.2.8) lib/active_record/relation.rb:241:in `block in scoping'
activerecord (3.2.8) lib/active_record/scoping.rb:98:in `with_scope'
activerecord (3.2.8) lib/active_record/relation.rb:241:in `scoping'
activerecord (3.2.8) lib/active_record/relation.rb:87:in `create'
activerecord (3.2.8) lib/active_record/relation.rb:119:in `first_or_create'
actionpack (3.2.8) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.8) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.8) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.8) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.2.8) lib/active_support/callbacks.rb:436:in `_run__3199821227742357635__process_action__2555454004410598156__callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.8) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.8) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.8) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.8) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.8) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.8) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
activerecord (3.2.8) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.8) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.8) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.8) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.8) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.8) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:36:in `call'
actionpack (3.2.8) lib/action_dispatch/routing/mapper.rb:42:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:600:in `call'
omniauth (1.1.1) lib/omniauth/strategy.rb:394:in `call_app!'
omniauth (1.1.1) lib/omniauth/strategy.rb:356:in `callback_phase'
omniauth-oauth (1.0.1) lib/omniauth/strategies/oauth.rb:58:in `callback_phase'
omniauth (1.1.1) lib/omniauth/strategy.rb:219:in `callback_call'
omniauth (1.1.1) lib/omniauth/strategy.rb:175:in `call!'
omniauth (1.1.1) lib/omniauth/strategy.rb:157:in `call'
warden (1.2.1) lib/warden/manager.rb:35:in `block in call'
warden (1.2.1) lib/warden/manager.rb:34:in `catch'
warden (1.2.1) lib/warden/manager.rb:34:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.1) lib/rack/etag.rb:23:in `call'
rack (1.4.1) lib/rack/conditionalget.rb:25:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'
rack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/cookies.rb:339:in `call'
activerecord (3.2.8) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.8) lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `_run__635784344197953786__call__2888041296400006394__callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.8) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.8) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.8) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.8) lib/rails/engine.rb:479:in `call'
railties (3.2.8) lib/rails/application.rb:223:in `call'
rack (1.4.1) lib/rack/content_length.rb:14:in `call'
railties (3.2.8) lib/rails/rack/log_tailer.rb:17:in `call'
thin (1.4.1) lib/thin/connection.rb:80:in `block in pre_process'
thin (1.4.1) lib/thin/connection.rb:78:in `catch'
thin (1.4.1) lib/thin/connection.rb:78:in `pre_process'
thin (1.4.1) lib/thin/connection.rb:53:in `process'
thin (1.4.1) lib/thin/connection.rb:38:in `receive_data'
eventmachine (1.0.0) lib/eventmachine.rb:187:in `run_machine'
eventmachine (1.0.0) lib/eventmachine.rb:187:in `run'
thin (1.4.1) lib/thin/backends/base.rb:63:in `start'
thin (1.4.1) lib/thin/server.rb:159:in `start'
rack (1.4.1) lib/rack/handler/thin.rb:13:in `run'
rack (1.4.1) lib/rack/server.rb:265:in `start'
railties (3.2.8) lib/rails/commands/server.rb:70:in `start'
railties (3.2.8) lib/rails/commands.rb:55:in `block in <top (required)>'
railties (3.2.8) lib/rails/commands.rb:50:in `tap'
railties (3.2.8) lib/rails/commands.rb:50:in `<top (required)>'
script/rails:6:in `require'
script/rails:6:in `<main>' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-15T18:20:46.157

您需要在表格中添加一`username`列`users`。

# ios - Cocos2d与iOS：静态CCScene的dealloc方法如何处理

> ID：12395242
> 
> 赞同：0
> 
> 时间：2012-09-12T19:47:12.557
> 
> 标签：ios, memory-management, cocos2d-iphone

我正在使用 CCScene 的 GameScene 子类的一些静态实例。从 GameScene 调用

```
[[CCDirector sharedDirector] replaceScene:[MainMenuScene scene]]; 
```

不会触发 GameScene 的 dealloc 方法。

一旦我再次加载场景（并创建了一个新的 GameScene），就会调用该方法：

```
+(id) sceneWithId:(int)sceneId
{
    CCScene* scene = [CCScene node];
    GameScene* gameScene = [[self alloc] initWithId:sceneId];
    [scene addChild:gameScene z:0 tag:GameSceneLayerTagGame];
    return scene;
}

-(id) initWithId:(int)sceneId
{
    CCLOG(@"scene With id");
    if ((self = [super init]))
    {
        instanceOfGameScene = self;
        //ONLY NOW the previous object becomes unreferenced and the memory management system is allowed to deallocate it 
```

我想了解是否**有一种方法可以在每次替换（静态）场景时强制调用 dealloc 方法，**而不仅仅是在“释放”内存时。

或者，如果我应该改为编写一些清理方法来停止我不想影响 MainMenuScene 的正在进行的进程（例如，我在 GameScene 的 dealloc 方法中放置了停止背景音乐方法调用，但背景音乐也在一个静态类 - 并且没有作为孩子添加到 GameScene - 然后它会在 MainMenuScene 中继续播放一次）。

因此，我的快速修复建议是执行以下操作：

```
 [self stopAllStuffInOtherStaticClassesThatAreRelatedOnlyToGameScene];
    [[CCDirector sharedDirector] replaceScene:[MainMenuScene scene]]; 
```

这是一个好方法吗？

编辑：什么时候在 dealloc 方法中添加这段代码是明智的？

```
 [self removeAllChildrenWithCleanup:TRUE]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T21:00:19.083

我闻到不好的做法。永远不要保留节点的静态实例。尤其是不在场景层次结构之外。它只是打破了 cocos2d 处理内存管理的方式。

如果您需要保留状态，请将此状态保存到单独的类中，但是当您更改场景时一定要让场景消失。然后在场景再次初始化时恢复状态。

您不能强制使用 dealloc 方法。想要这样做是代码异味的标志。但是，您可以覆盖该方法以在将节点作为子节点删除`-(void) cleanup`之前和之后运行反初始化代码。`dealloc`

> 编辑：什么时候在 dealloc 方法中添加这段代码是明智的？
> 
> [自我 removeAllChildrenWithCleanup:TRUE];

绝不。曾经。

Again, if you find you need to do this, there's a terrible bug somewhere. Cocos2D will have removed the child nodes by this time. In fact, it does so during the `cleanup` method, one way to cause cocos2d not to remove a node's children is when you override cleanup and not call [super cleanup].

Or perhaps when you keep it as a static instance, so it'll never actually call the cleanup method. And even worse would then continue to run scheduled updates and actions.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:33:30.557

你的麻烦是你没有发布你的游戏场景。将其创建为

```
GameScene* gameScene = [[[self alloc] initWithId:sceneId] autorelease]; 
```

它将被正确释放。

无论如何，我认为没有必要将游戏场景创建为其他场景的孩子，但也许我对您的项目一无所知。

而且我无法理解，您在“静态CCScene”下是什么意思

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-01T06:56:08.647

Using 'Instruments' under Developer Tools, I was able to make some progress on this matter:

When the scene is created it should follow a few simple rules to keep the memory low:

1.  Allocate the sprites from smallest to largest
2.  Make sure to call `[self unscheduleAllSelectors];` at the right times
3.  如果您想在您的案例中看到显着的内存改进，请使用以下代码覆盖 -(void)dealloc 方法，因为每次加载 CCScene 时都会遇到这种情况：

    ```
    // Clean up memory allocations from sprites
    [[CCSpriteFrameCache sharedSpriteFrameCache] removeUnusedSpriteFrames];
    [[CCDirector sharedDirector] purgeCachedData];
    [[CCSpriteFrameCache sharedSpriteFrameCache] removeSpriteFrames];
    [CCSpriteFrameCache purgeSharedSpriteFrameCache]; 
    ```

# javascript - 如何在纯 JavaScript 或 Jquery 中创建带有 id 的音频标签

> ID：12395246
> 
> 赞同：0
> 
> 时间：2012-09-12T19:47:41.400
> 
> 标签：javascript, jquery, html, audio

我想创建一个音频文件以在 iphone safari 浏览器中播放，但没有 HTML 页面的帮助。只是在纯 javascript 或 Jquery 中。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T15:38:34.727

```
var audio = new Audio();
audio.id = "mySong";
audio.src = "//mysite.com/media/mysong.mp3"; 
```

除了您不能在音频中自动播放歌曲。您无法在***i*** *_* __ 设备上自动加载歌曲。...因此您需要自定义构建控件，然后您必须将其放在 HTML 页面上，使用事件侦听器来侦听点击或点击，以便播放/暂停歌曲，或更改曲目或其他...

所以你仍然需要一个 HTML 页面。

此外，这只能在浏览器中工作，因为没有其他方法可以让它在浏览器之外在 iPhone 上运行（不是 100% 正确，而是`Audio`HTML5 API，因此，需要 HTML5 支持才能使用该特定API）。

# javascript - 重构代码

> ID：12395247
> 
> 赞同：0
> 
> 时间：2012-09-12T19:47:43.913
> 
> 标签：javascript, jquery

假设我有以下代码：

```
 $(function () {
    $(".buy-it-now.ribbon").click(function () {
        $(".bid-to-beat.ribbon.active").removeClass("active");
        $(".bid-to-beat.ribbon").addClass("inactive");
        $(".buy-it-now.ribbon.inactive").removeClass("inactive");
        $(".buy-it-now.ribbon").addClass("active");
        $(".bid-now").hide();
        $(".buy-now").show();
        $(".add-to-cart").hide();
    })
    $(".bid-to-beat.ribbon").click(function () {
        $(".buy-it-now.ribbon.active").removeClass("active");
        $(".buy-it-now.ribbon").addClass("inactive");
        $(".bid-to-beat.ribbon").removeClass("inactive");
        $(".bid-to-beat.ribbon").addClass("active");
        $(".buy-now").hide();
        $(".bid-now").show();
        $(".add-to-cart").show();
    });
}); 
```

这是一个简单的功能，允许在我正在处理的网站的前端发生多个与 UI 相关的事情。总的来说，我对 jQuery 和 JavaScript 相当（非常）陌生，现在正在学习重构和使我的代码更加简洁。我目前编写代码的方式有点像我所想的那样。所以我的问题是，有经验的开发人员如何编写相同的代码？或者更确切地说，我该如何重构这段代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:15:42.347

尝试以下操作：

```
$(function () {
    var $handlers = $('.buy-it-now.ribbon, .bid-to-beat.ribbon');

    $handlers.click(function() {
        $handlers.toggleClass("active inactive");

        var $elements = $(".bid-now, .add-to-cart"),
            $buyElement = $(".buy-now");

        if($(this).is('.buy-it-now.ribbon')) {
            $elements.hide();
            $buyElement.show();
        } else {
            $elements.show();
            $buyElement.hide();
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:53:00.670

这个问题更适合代码审查，但是可以使用方法链接将其压缩一点。

```
$(function () {
    $(".buy-it-now.ribbon").click(function () {
        $(".bid-to-beat.ribbon").removeClass("active").addClass("inactive");
        $(".buy-it-now.ribbon").removeClass("inactive").addClass("active");
        $(".bid-now").hide();
        $(".buy-now").show();
        $(".add-to-cart").hide();
    })
    $(".bid-to-beat.ribbon").click(function () {
        $(".buy-it-now.ribbon").removeClass("active").addClass("inactive");
        $(".bid-to-beat.ribbon").removeClass("inactive").addClass("active");
        $(".buy-now").hide();
        $(".bid-now").show();
        $(".add-to-cart").show();
    });
}); 
```

您可以通过在点击事件之前预先选择元素并将它们缓存在变量中来进一步压缩它，只要在页面的生命周期内没有添加或删除任何元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T20:13:51.693

作为您的代码，您可以将一些选择器组合成一行。而且因为你的元素看起来是静态的，你可以将它们缓存到一个变量中并在以后使用它们，因为它减少了在 DOM 中查找元素的次数，从而减少了访问时间。

您还可以通过将它们封装在对象或闭包中来限制这些变量或选择器的范围。

也许这些行中的某些东西..

```
 $(function () {
   cart.init();
});

var cart = {
    elems : {
        $buyRibbon : null,
        $bidRibbon : null,
        $bidNow: null,
        $buyNow: null,
        $addToCart: null
    },
    events : {
    },
    init : function() {
        this.elems.$buyRibbon = $(".buy-it-now.ribbon");
        this.elems.$bidRibbon = $(".bid-to-beat.ribbon");
        this.elems.$bidNow = $(".bid-now") ;
        this.elems.$buyNow = $(".buy-now") ;
        this.elems.$addToCart = $(".add-to-cart") ;
        this.events.buyClick();
        this.events.bidClick();
    }
};

cart.events.buyClick = function() {
    cart.elems.$buyRibbon.on('click', function(){
        cart.elems.$bidRibbon.removeClass('active').addClass('inactive');
        cart.elems.$buyRibbon.removeClass('inactive').addClass('active');
        cart.elems.$bidNow.hide();
        cart.elems.$buyNow.show();
        cart.elems.$addToCart.hide();
    });
} 

cart.events.bidClick = function() {
    cart.elems.$bidRibbon.on('click', function(){
        cart.elems.$buyRibbon.removeClass('active').addClass('inactive');
        cart.elems.$bidRibbon.removeClass('inactive').addClass('active');
        cart.elems.$bidNow.show();
        cart.elems.$buyNow.hide();
        cart.elems.$addToCart.show();
    });
} 
```

所以基本上在这里你的整个购物车是一个对象..并且购物车具有与此相关的不同属性..您在这里遵循面向对象编程的原则..我听说使用闭包可以更好地设计限制您的代码范围..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T21:15:43.793

我可以建议这样的事情：

```
$(function () {
    var buyNowButton = $('buy-it-now.ribbon'),
        bidToBeatButton = $('.bid-to-beat.ribbon'),
        buyNowEls = $('.buy-now'),
        bidToBeatEls = $('.bid-now,.add-to-cart');

    var toggleButtons = function(showBuyNow){
        buyNowButton.toggleClass('active', showBuyNow);
        bidToBeatButton.toggleClass('active', !showBuyNow);
        buyNowEls.toggle(showBuyNow);
        bidToBeatEls.toggle(!showBuyNow);
    }

    buyNowButton.click(function(){ toggleButtons(true) });
    bidToBeatButton.click(function(){ toggleButtons(false) });
}); 
```

如果节省的空间比轻微的性能损失更重要，您可以通过在开始时删除选择器来节省一些行，然后就地进行选择。然后它看起来像这样：

```
$(function () {
    var toggleButtons = function(showBuyNow){
        $('buy-it-now.ribbon').toggleClass('active', showBuyNow);
        $('.bid-to-beat.ribbon').toggleClass('active', !showBuyNow);
        $('.buy-now').toggle(showBuyNow);
        $('.bid-now,.add-to-cart').toggle(!showBuyNow);
    }

    $('buy-it-now.ribbon').click(function(){ toggleButtons(true) });
    $('.bid-to-beat.ribbon').click(function(){ toggleButtons(false) });
}); 
```

第一个版本选择元素一次并将它们保存在内存中；每次单击按钮时，第二个都会选择它们。两者都解决了我认为选择的答案会出现的问题，其中两次单击相同的按钮会导致 .active 和 .inactive 类与显示/隐藏的元素不同步。

# entity-framework - EF和人物PK/FK

> ID：12395253
> 
> 赞同：0
> 
> 时间：2012-09-12T19:48:07.190
> 
> 标签：entity-framework

我是EF的新手。我读了[http://msdn.microsoft.com/en-us/data/gg193958.aspx](http://msdn.microsoft.com/en-us/data/gg193958.aspx)并且仍然感到困惑。

我有一个现有的数据库，我正在编写一个 Code First 模型。我有带有 op_code Char(6) 主键的 Operators 表。在 Operator 类中，我将其命名为 OperatorCode，例如

```
[Key]
[Column("op_code",TypeName = "char")]
[DisplayName("Operator")]
public virtual string OperatorCode { get; set; } 
```

在我的几个表中，我有 EnteredBy 和一些对 op_code 是 FK 的 ModifiedBy 列。

比如说，对于 Clients 表，我有这两个字段。

所以，我在底部的 Operator 类中添加了：

```
[InverseProperty("EnteredBy")]
public virtual ICollection<Client> ClientsEnteredBy { get; set; }

[InverseProperty("ModifiedBy")]
public virtual ICollection<Client> ClientsUpdatedBy { get; set; } 
```

我在 Client 类中添加了以下内容：

```
public virtual Operator EnteredBy { get; set; }
public virtual Operator ModifiedBy { get; set; } 
```

我收到有关 EnteredBy_OperatorCode 和 ModifiedBy_OperatorCode 列的运行时错误。

我应该修复什么 /add 让 EF 知道我的列名？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:36:51.827

您在数据库中的外来列名称与 FK 名称的默认约定不匹配，即`NavigationPropertyName_PrimaryKeyNameinTargetClass`. 因为您的导航属性被调用`EnteredBy`并且`ModifiedBy`主键属性被调用`OperatorCode`EF 期望 - 根据提到的约定 -`EnteredBy_OperatorCode`并且`ModifiedBy_OperatorCode`作为外键列。但是这些在数据库中不存在，这是您异常的原因。相反，您的 FK 列是`EnteredBy`和`ModifiedBy`。

因此，要解决问题，您必须重写约定。

如果您的模型中没有 FK 属性，请使用 Fluent API：

```
modelBuilder.Entity<Operator>()
    .HasMany(o => o.ClientsEnteredBy)
    .WithRequired(c => c.EnteredBy)    // or HasOptional
    .Map(m => m.MapKey("EnteredBy"));  // mapping for the FK column name

modelBuilder.Entity<Operator>()
    .HasMany(o => o.ClientsUpdatedBy)
    .WithRequired(c => c.ModifiedBy)    // or HasOptional
    .Map(m => m.MapKey("ModifiedBy"));  // mapping for the FK column name 
```

（使用此映射，您可以删除该`InverseProperty`属性。）

另一种方法是将 FK 公开为模型中的属性。重命名导航属性并将其名称用于 FK 属性。然后可以使用数据注释进行映射。

在`Client`课堂上：

```
[ForeignKey("EnteredByOperator")]
public string EnteredBy { get; set; }

[InverseProperty("ClientsEnteredBy")]
public virtual Operator EnteredByOperator { get; set; }

[ForeignKey("ModifiedByOperator")]
public string ModifiedBy { get; set; }

[InverseProperty("ClientsUpdatedBy")]
public virtual Operator ModifiedByOperator { get; set; } 
```

并删除类中的`InverseProperty`属性`Operator`。

除了数据注释，您还可以使用 Fluent API：

```
modelBuilder.Entity<Operator>()
    .HasMany(o => o.ClientsEnteredBy)
    .WithRequired(c => c.EnteredByOperator)    // or HasOptional
    .HasForeignKey(c => c.EnteredBy);

modelBuilder.Entity<Operator>()
    .HasMany(o => o.ClientsUpdatedBy)
    .WithRequired(c => c.ModifiedByOperator)    // or HasOptional
    .HasForeignKey(c => c.ModifiedBy); 
```

如果这两种关系都需要，您将需要为至少一个关系禁用级联删除（附加`.WillCascadeOnDelete(false)`在其中一个映射的末尾），否则 SQL Server 将抛出一个错误，即不允许表之间的多个级联删除路径。

我建议使用“替代方法”（将外键作为属性公开），因为在大多数情况下它更容易使用。

# sorting - 有没有办法覆盖 JQGrid 中的默认排序行为？

> ID：12395254
> 
> 赞同：1
> 
> 时间：2012-09-12T19:48:11.793
> 
> 标签：sorting, jqgrid

我正在使用 JQGrid 4.4.0，我想覆盖整数排序方式的默认行为。我可以通过将`sorttype`每个属性设置`colModel`为函数而不是文字来实现这一点`'int'`。

不过，我想知道，有没有一种方法可以对我的 JQGrid 配置进行全局更改，如此处的[示例](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aoptions#setting_options_globally)所示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T08:56:38.757

您可以做的是使用jqGrid的`template`属性`colModel`或选项的使用来为网格的所有列定义默认属性。如果您在其中设置选项，您将更改所有网格的所有列的默认属性：`cmTemplate``sorttype``cmTemplate``$.jgrid.defaults``sorttype`

```
$.extend($.jgrid.defaults, {
    cmTemplate: {
        sorttype: 'int' // you can use functions in the same way
                        // to define custom sorting
                        // see https://stackoverflow.com/a/5296935/315935
                        // for the code example
    }
}); 
```

查看[答案](https://stackoverflow.com/a/6047856/315935)以获取更多详细信息。例如，如果您想从[答案中定义自定义排序功能](https://stackoverflow.com/a/5296935/315935)

# r - R - 简化二次抽样程序

> ID：12395258
> 
> 赞同：0
> 
> 时间：2012-09-12T19:48:23.867
> 
> 标签：r, plyr

我有一个数据集，由从研究和实验中获得的值组成。实验嵌套在研究中。我想对数据集进行二次抽样，以便每个研究只代表 1 个实验。我想重复这个过程 10,000 次，每次随机抽取 1 个实验，然后计算一些值的汇总统计。这是一个示例数据集：

```
df=data.frame(study=c(1,1,2,2,2,3,4,4),expt=c(1,2,1,2,3,1,1,2),value=runif(8)) 
```

我编写了以下函数来执行上述操作，但它需要永远。有人对简化此代码有任何建议吗？谢谢！

```
subsample=function(x,A) {
  subsample.list=sapply(1:A,function(m) {
    idx=ddply(x,c("study"),function(i) sample(1:nrow(i),1)) #Sample one experiment from each study
    x[paste(x$study,x$expt,sep="-") %in% paste(idx$study,idx$V1,sep="-"),"value"] } ) #Match the study-experiment combinations and retrieve values
  means.list=ldply(subsample.list,mean) #Calculate the mean of 'values' for each iteration
  c(quantile(means.list$V1,0.025),mean(means.list$V1),upper=quantile(means.list$V1,0.975)) } #Calculate overall means and 95% CIs 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:28:35.207

您可以以这种方式更多地矢量化（即使使用 plyr），并且速度要快得多：

```
function=yoursummary(x)c(quantile(x,0.025),mean(x),upper=quantile(x,0.975))
subsampleX=function(x,M)
  yoursummary(
    aaply(
      daply(.drop_o=F,df,.(study),
        function(x)sample(x$value,M,replace=T)
      ),1,mean
    )
  ) 
```

这里的诀窍是预先进行所有采样。如果我们想采样 M 次，为什么不在你可以访问研究的时候做所有这些。

## 原始代码：

```
> system.time(subsample(df,20000))
   user  system elapsed 
 123.23    0.06  124.74 
```

## 新的矢量化代码：

```
> system.time(subsampleX(df,20000))
   user  system elapsed 
   0.24    0.00    0.25 
```

这大约快 500 倍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:33:08.227

这是一个基本的 R 解决方案，出于速度原因避免使用 ddply：

```
df=data.frame(study=c(1,1,2,2,2,3,4,4),expt=c(1,2,1,2,3,1,1,2),value=runif(8))

sample.experiments <- function(df) {
    r <- rle(df$study)
    samp <- sapply( r$lengths , function(x) sample(seq(x),1) )
    start.idx <- c(0,cumsum(r$lengths)[1:(length(r$lengths)-1)] )
    df[samp + start.idx,]
}
> sample.experiments(df)
  study expt     value
1     1    1 0.6113196
4     2    2 0.5026527
6     3    1 0.2803080
7     4    1 0.9824377 
```

**基准**

```
> m <- microbenchmark(
+   ddply(df,.(study),function(i) i[sample(1:nrow(i),1),]) ,
+   sample.experiments(df)
+   )
> m
Unit: microseconds
                                                        expr      min       lq   median       uq      max
1 ddply(df, .(study), function(i) i[sample(1:nrow(i), 1), ]) 3808.652 3883.632 3936.805 4022.725 6530.506
2                                     sample.experiments(df)  337.327  350.734  357.644  365.915  580.097 
```

![自动绘图微基准](../Images/afed8ab0dbc0446767b608b2098c6f65.png)

# rest - 使用 Jersey 构建 REST URI

> ID：12395265
> 
> 赞同：0
> 
> 时间：2012-09-12T19:48:42.853
> 
> 标签：rest, jersey

泽西岛的新手（Java 的 REST 框架），我正在尝试在共享根路径的两个单独的类中设置两个资源，但我遇到了问题。所以，我有类似的东西：

```
@Path("/users")
public class User extends RestSupport {

    @GET
    @Path("/{user_uuid}")
    public String get(@PathParam("user_uuid") String uuid) {    
        return "Hello User " + uuid;
    }
} 
```

上述课程有效。但是，我想在一个单独的类中创建一个子资源。但是当我这样做时，似乎会产生 URI 命名冲突。所以，在这里，我想获取特定用户的所有宠物

```
@Path("/users")
public class Pets extends RestSupport {

    @GET
    @Path("/{user_uuid}/pets")
    public String get(@PathParam("user_uuid") String uuid) {    
        return "Hello Pets " + uuid;
    }
} 
```

这些顶级资源有很多子资源，所以我正在寻找组织它们的最佳方式。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T22:14:40.323

如果您希望 Jersey 将调用委托给子资源，请不要`@GET`在根资源方法上添加 HTTP 注释。`Users`考虑一个`User`类：

```
public class User {

  String uuid;
  User(String id) { this.uuid = id; }

  @GET
  public String get() { return "Hello user " + uuid; }

  @GET
  @Path("/pets")
  public String getPets() { return "Hello pets " + uuid; }

} 
```

然后调整你的`Users`资源：

```
@Path("/users")
public class Users  {

  @Path("/{user_uuid}")
  public User get(@PathParam("user_uuid") String uuid) {
    // Get the user from the DAO here...
    return new User(uuid);
  }

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T04:50:55.877

Change the path of `Pets` class from
`@Path("/users")`
to
`@Path("/users/{user_uuid}/pets")`

# asp.net - 处理表单返回的Javascript

> ID：12395267
> 
> 赞同：0
> 
> 时间：2012-09-12T19:48:44.713
> 
> 标签：asp.net, forms

我有一个标准的 html 注册页面，它在提交时以外部 .asp 页面为目标。发生的情况是当前 .asp（我无权访问）返回整个 html 页面。相反，我想以某种方式解析返回的 html 并使用 a) 验证错误（如果不正确）或 B）某种成功消息（如果全部验证）填充现有表单

谁能告诉我这是否可能和/或帮助一些伪代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:01:06.970

假设我正确解释了您的问题，您可以做的最好的事情是“抓取”从 asp 页面返回的 HTML，并对标记中文本的位置和含义做出适当的假设。我个人强烈建议不要根据相当于屏幕抓取的内容开发任何类型的稳健性，特别是考虑到您无权访问 .asp 文件本身。如果我误解了你的问题，我很抱歉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:38:58.590

这在使用 ajax 的 JavaScript 中是可行的，但它要求 ASP 页面（可能在不同的域上）发送适当的 CORS HTTP 标头。即使您无法访问实际的 ASP 页面，您也可以让某人在其服务器上的 IIS 中设置标头。

否则，您将被困在服务器端移动所有内容，即在您自己的网络服务器上模拟 POST，然后抓取 HTML 以获取状态。这看起来像：

1.  将页面回发到您自己的页面（或使用 Ajax）
2.  在您的服务器上，发起将数据发送到 ASP 页面的 Web 请求
3.  解析服务器代码中的结果
4.  向浏览器客户端返回适当的响应

# coffeescript - 用咖啡脚本继承

> ID：12395269
> 
> 赞同：0
> 
> 时间：2012-09-12T19:48:48.283
> 
> 标签：coffeescript

为什么这个...

```
class Person
    name: "initial name"

    constructor: (@name) ->

class User extends Person
    password: "initial password"

f = new User "Felds"

console.log f
console.log "my name is '#{f.name}' and my password is '#{f.password}'"

b = new User "Bob"
b.password = "bob's password"

console.log b 
```

...运行时`coffee -p test.coffee | node`输出这个？

```
{ name: 'Felds' }
my name is 'Felds' and my password is 'initial password'
{ name: 'Bob', password: 'bob\'s password' } 
```

为什么`password`房产不显示`console.log f`？它存储在哪里以及如何检索？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:31:58.027

该`'initial password'`值存储在`Person.prototype.password`. 是一个具有所有实例`Person.prototype`之间共享的公共属性的对象。`Person`访问`aPersonInstance.password`时，首先在对象中查找密码属性`aPersonInstance`；如果没有找到它，它将在其原型中查找，然后在其原型的原型中查找，依此类推。

`console.log f`不会显示`f`的原型属性，只显示`f`自身存储的属性（也称为*自己的*`f`属性）。当您分配 Bob 的密码时，您自己创建了一个新属性，现在将成为 access 的值，即使' 的原型仍然具有该值。我希望这是有道理的 =P*`b.password = 'bob\'s password'``password``b``b.password``b``'initial password'`*

 *通过存储`'initial password'`在原型中，您将在所有 Person 实例之间共享该值作为一种默认值。这对于字符串或其他原始（不可变）类型来说非常好；但是如果要使用数组或其他可变对象，则必须特别小心，因为相同的对象将在所有类的实例之间共享，并且如果其中一个修改它，例如`@someArray.push 5`，所有其他的要去看看它。在这些情况下，通常最好在类构造函数中初始化属性，例如`@someArray = []`，以保证每个实例都有不同的数组/对象属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T19:14:56.780

我想给你一个简单而快速的答案，但在 Javascript 中并不完全正确：

`password`您定义的变量`class User`是`User.prototype.password`，该变量就像OO语言中的**类变量**。它不是`f`实例变量，所以当你`console.log f`看不到的时候`password`。

但如果你检索`f.password`，那么你仍然会得到价值`'initial password'`。当一个实例本身找不到变量时，它会继续在它的类中找到它，即`User`.

`b.password`是 in 的实例变量`b`，因此控制台可以将其注销。*

# tsql - 如何在 t-sql 查询中使用变量

> ID：12395277
> 
> 赞同：2
> 
> 时间：2012-09-12T19:49:47.500
> 
> 标签：tsql

今天我得到这样的数据库名称：

```
set @databaseNameTXT = 'NewStat1DB'; 
```

然后我像这样将数据插入到正确的表中：

```
IF @databaseNameTXT = 'NewStat1DB' 
    BEGIN
        INSERT INTO [NewStat1DB] (wStat_id) values(@wStat_id)
    END

IF @databaseNameTXT = 'NewStat2DB'
    BEGIN
        INSERT INTO [NewStat2DB] (wStat_id) values(@wStat_id)
    END 
```

如何在 t-sql 中使用变量并运行它，例如：

插入 [@databaseNameTXT] (wStat_id) 值(@wStat_id)

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:52:27.493

您需要为此使用[动态 SQL](http://www.sommarskog.se/dynamic_sql.html)，尽管您需要小心[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)。

数据库、模式、表和列名不能是变量——唯一的方法是使用动态 SQL。

例如（这很容易受到 SQL 注入的攻击）：

```
sp_executesql 'INSERT INTO [' + @databaseNameTXT + 
                '] (wStat_id) values(' + @wStat_id + ');'; 
```

我建议阅读链接的文章——它是对动态 SQL 主题的综合处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:52:40.963

您可以为此使用动态 SQL：

```
declare @query nvarchar(max)

set @query = 'INSERT INTO ' + QUOTENAME(@databaseNameTXT) + '(wStat_id) 
                values('+@wStat_id+')'

exec(@query) 
```

# reporting-services - SSRS URL 访问比报表管理器慢

> ID：12395280
> 
> 赞同：1
> 
> 时间：2012-09-12T19:50:02.330
> 
> 标签：reporting-services, ssrs-2008

我正在使用 URL 访问在应用程序中嵌入报告，该应用程序使用如下所示的 URL：

```
https://servername/ReportServer/Pages/ReportViewer.aspx?/ReportPath/&parameter=value 
```

此报告有几个参数，其有效值由查询填充。

报告的显示时间与通过报告管理器访问报告所用的时间大致相同。

但是，我注意到，如果我在报告管理器中更改参数并单击“查看报告”按钮，它的刷新速度比通过 URL 访问刷新报告快几秒钟。

我认为这是因为在报表管理器中刷新报表会减少一些处理步骤。当您使用报表管理器中的“查看报表”按钮刷新报表时，看起来一堆状态被发送回服务器，而我认为通过 URL 访问刷新报表基本上是从头开始完成所有工作。

我的假设正确吗？有什么方法可以像使用报表管理器时一样快地通过 URL 访问刷新带有新参数的报表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T06:39:37.213

你的假设是正确的，据我所知 Report Manager 和 ReportViewer 控件将有一个跨越多个请求的会话。（虽然我有点惊讶这在您更改参数时也会起作用，因为我无法想象在这种情况下可以跳过哪些步骤。）

为了控制这一点，报表管理器使用会话。即使我自己没有尝试过，您也应该可以通过[使用 SessionId 和相关参数](http://msdn.microsoft.com/en-us/library/ms153610%28v=sql.105%29)来使用 URLS 执行此操作。

让我们知道这是否对您有用！

# java - 将 double 转换为 BigDecimal 并设置 BigDecimal 精度

> ID：12395281
> 
> 赞同：88
> 
> 时间：2012-09-12T19:50:05.537
> 
> 标签：java, double, bigdecimal

在 Java 中，我想取一个 double 值并将其转换为 a`BigDecimal`并将其 String 值打印到一定精度。

```
import java.math.BigDecimal;
public class Main {
    public static void main(String[] args) {
        double d=-.00012;
        System.out.println(d+""); //This prints -1.2E-4

        double c=47.48000;
        BigDecimal b = new BigDecimal(c);
        System.out.println(b.toString()); 
        //This prints 47.47999999999999687361196265555918216705322265625 
    }
} 
```

它打印出这个巨大的东西：

> 47.47999999999999687361196265555918216705322265625

并不是

> 47.48

我进行`BigDecimal`转换的原因是有时双精度值将包含很多小数位（即`-.000012`），当将双精度值转换为字符串时会产生科学记数法`-1.2E-4`。我想以非科学记数法存储字符串值。

我想让 BigDecimal 总是有两个这样的精度单位：“47.48”。BigDecimal 可以限制转换为字符串的精度吗？

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2013-05-27T13:24:34.470

这种行为的原因是打印的字符串是确切的值 - 可能不是你所期望的，但这是存储在内存中的真实值 - 这只是浮点表示的限制。

根据 javadoc，如果您不考虑此限制，BigDecimal(double val) 构造函数的行为可能会出乎意料：

> 此构造函数的结果可能有些不可预测。有人可能会假设用 Java 编写 new BigDecimal(0.1) 会创建一个正好等于 0.1 的 BigDecimal（未缩放的值 1，缩放为 1），但它实际上等于 0.1000000000000000055511151231257827021181583404541015625。这是因为 0.1 不能完全表示为双精度数（或者，就此而言，不能表示为任何有限长度的二进制分数）。因此，传递给构造函数的值并不完全等于 0.1，尽管看起来如此。

所以在你的情况下，而不是使用

```
double val = 77.48;
new BigDecimal(val); 
```

采用

```
BigDecimal.valueOf(val); 
```

BigDecimal.valueOf 返回的值等于调用`Double.toString(double)`.

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2012-09-12T19:57:52.480

如果您使用另一个[MathContext](http://docs.oracle.com/javase/6/docs/api/java/math/MathContext.html) ，它将打印 47.48000 ：

```
BigDecimal b = new BigDecimal(d, MathContext.DECIMAL64); 
```

只需选择您需要的上下文。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2012-09-12T20:00:22.913

您想尝试一下`String.format("%f", d)`，它将以十进制表示法打印您的双精度数。根本不要使用`BigDecimal`。

关于精度问题：您首先存储`47.48`在 中`double c`，然后从中制作新`BigDecimal`的`double`. 精度的损失在于分配给`c`。你可以做

```
BigDecimal b = new BigDecimal("47.48") 
```

以避免丢失任何精度。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2016-10-20T07:21:49.563

为什么不 ：

```
b = b.setScale(2, RoundingMode.HALF_UP); 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-09-12T20:07:44.770

它打印出`double`.

`Double.toString()`将`double`s 转换为`String`s，不会*打印*输入的确切十进制值 - 如果`x`是您的双精度值，它会打印出`x`最接近`double`打印值的足够数字。

关键是*没有`double`*确切的 47.48 这样的。Doubles 将值存储为*二进制*分数，而不是小数，因此它不能存储精确的十进制值。（这就是为什么`BigDecimal`！）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-03-07T07:50:53.480

**String.format 语法帮助我们将双精度数和 BigDecimals 转换为任何精度的字符串。**

这个java代码：

```
double dennis = 0.00000008880000d;
System.out.println(dennis);
System.out.println(String.format("%.7f", dennis));
System.out.println(String.format("%.9f", new BigDecimal(dennis)));
System.out.println(String.format("%.19f", new BigDecimal(dennis))); 
```

印刷：

```
8.88E-8
0.0000001
0.000000089
0.0000000888000000000 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-05-05T02:18:35.270

```
BigDecimal b = new BigDecimal(c).setScale(2,BigDecimal.ROUND_HALF_UP); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-12-01T13:59:55.270

在 Java 9 中，不推荐使用以下内容：

`BigDecimal.valueOf(d).`~~setScale~~ `(2, BigDecimal.`~~ROUND_HALF_UP~~`);`

改为使用：

```
BigDecimal.valueOf(d).setScale(2, RoundingMode.HALF_UP); 
```

例子：

```
 double d = 47.48111;

    System.out.println(BigDecimal.valueOf(d)); //Prints: 47.48111

    BigDecimal bigDecimal = BigDecimal.valueOf(d).setScale(2, RoundingMode.HALF_UP);
    System.out.println(bigDecimal); //Prints: 47.48 
```

# java - Vector和Vector<>有什么区别

> ID：12395282
> 
> 赞同：1
> 
> 时间：2012-09-12T19:50:07.163
> 
> 标签：java, vector

我在java中看到了一些向量被声明为的例子

```
Vector v = new Vector() 
```

在一些例子中，

```
Vector<String> = new Vector<String>() 
```

我不确定后一个声明是做什么的？它是否指定了 Vector shud 所包含的对象类型？

如果是，那么如果我使用第一个声明声明一个向量，我可以使用任何类型的对象，如果我使用第二个声明，那么该对象只能是 <> 内的类型？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T19:59:02.467

这是 Java 的一个特性，称为泛型。[您可以在此处](http://docs.oracle.com/javase/tutorial/java/generics/)找到 Oracle 官方资源。

```
Vector v = new Vector(); 
```

是相同的

```
Vector<Object> v = new Vector<Object>() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T19:59:20.840

第一行定义了可以是任何类型的a `Vector`of s。`Object`

第二行使用[Java 泛型](http://docs.oracle.com/javase/tutorial/java/generics/)并定义`Vector`仅包含`String`s 的 a。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T20:13:11.540

正如其他海报所回答的那样，您确实在处理“通用”类。

我建议不要使用 Vector clsas，因为它已被弃用。相反，使用 [ArrayList](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)。

使用泛型的一个很好的优势是编译器将为您提供所谓的“类型安全”。当您最初将 ArrayList 声明为`ArrayList<Ball>`时，编译器只会让您`Ball`在该列表中存储类（或其子类）的对象。此外，每当您从列表中选择一个对象时，即`myList.get(index)`从该调用返回的对象会自动转换为`Ball`.

编写泛型类可能很棘手，但使用它们可以让您真正清理代码。

如果您想了解更多信息，这里是泛型[Java 教程](http://docs.oracle.com/javase/tutorial/java/generics/)的链接。

# ruby - Ruby：为什么 nil.to_s 返回“”，但 nil.inspect 返回“nil”

> ID：12395286
> 
> 赞同：10
> 
> 时间：2012-09-12T19:50:13.840
> 
> 标签：ruby, null

为什么`nil.to_s`return `""`，但`nil.inspect`返回`"nil"`（显然`.inspect`使用该`.to_s`方法时）

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-09-12T19:56:05.887

[Object 类](http://ruby-doc.org/core-1.9.3/Object.html#method-i-inspect)的“inspect”方法应该返回对象*的可读*版本。

的人类可读版本`nil`是“nil”而不是“”（这是字符串的人类可读版本`""`）。
这就是为什么`nil.inspect`应该返回“nil”，而`nil.to_s`返回“”以便按照通常的预期`"a string" + nil`返回（例如在其他语言中）。`"a string"`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-12T19:53:31.737

请参阅 上的文档[`NilClass.inspect`](http://rubydoc.info/stdlib/core/1.9.3/NilClass#inspect-instance_method)。它声明它将返回`"nil"`并且不保证与`to_s`.

# android - ActivityNotFound 即使存在 Activity

> ID：12395290
> 
> 赞同：1
> 
> 时间：2012-09-12T19:50:30.267
> 
> 标签：android, exception, android-intent, start-activity

> **可能重复：**
> [使用已安装的文件编辑器（如果有）编辑纯文本文件的意图](https://stackoverflow.com/questions/4539778/intent-for-editing-plain-text-file-with-the-installed-file-editor-if-any)

我正在尝试打开一些已下载的文本文件。当我有意图地开始活动时，它会给出 ActivityNotFound 异常。

```
try {
    Uri path = Uri.parse(path+"/sampletext.txt");
    Intent intent = new Intent(Intent.ACTION_VIEW);
    PackageManager packageManager = ctx.getPackageManager();
    intent.setType("text/plain") ;
    List<ResolveInfo> list = packageManager.queryIntentActivities(intent, PackageManager.MATCH_DEFAULT_ONLY);
    if (list.size() > 0 ) {
        intent.setDataAndType(path, "text/plain");
        intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        ctx.startActivity(intent) ;
    } 

} catch (Exception e){
    e.printStackTrace() ;
} 
```

调试的时候发现list.size是1。

我还缺少其他信息吗？

任何一种观点都会对我有所帮助。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:55:19.690

当清单文件中没有声明匹配的活动或没有被另一个应用程序注册为共享活动时，通常会遇到 ActivityNotFound 异常。

您可能需要编辑路径：

`Uri path = Uri.parse("file://" + path + "/sampletext.txt");`

更好的方法是使用便捷方法：

`Uri data = Uri.fromFile(file);`

但是您需要创建一个 File 对象才能使用该方法

# windows - 如何允许多个用户为他们的 Windows 桌面共享一台机器？

> ID：12395293
> 
> 赞同：0
> 
> 时间：2012-09-12T19:50:41.267
> 
> 标签：windows, remote-desktop, thin, multiple-instances

允许 5 个远程用户为他们的多个桌面共享一台计算机的最佳方式是什么？

任何非服务器版本的 Windows 都允许这样做吗？

是否有任何服务器版本可以在不购买额外许可证的情况下实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:01:59.410

如果我正确理解您的意思，答案是否定的，您需要创建一个服务器，然后在这 5 个多个桌面上使用 Windows 远程连接连接到服务器计算机。祝你好运，你会需要它！;)

# vb.net - VB.net VS2010：更改以匹配类名的动态对象类型

> ID：12395295
> 
> 赞同：1
> 
> 时间：2012-09-12T19:50:51.893
> 
> 标签：vb.net, class, object, dynamic, types

在问之前我试着搜索了一下，但我真的不知道在这个上搜索什么，所以这就是我要找的：

我需要一种在 VB.net 中声明对象的方法，以便可以将其设置为当前类（使用该类作为对象类型），但如果类名发生更改，则对象类型会更改以匹配新的类名。这是一个例子。

> 类 UhhWhat
> 
> > Dim L As List(Of UhhWhat)
> > 
> > 子添加（）
> > 
> > > ```
> > >  L.Add(Me) 
> > > ```
> > 
> > 结束子
> 
> 结束类

因此，如果这是我的代码，并且有人将其复制到具有不同名称的新类中说...“UhhNo”，那么我希望“List(Of UhhWhat)”更改为“List(Of UhhNo)”。

那有意义吗？我并没有真正坚持使用对象类型的名称，我只是想要一些功能类似于 List 对象的 Of T 但使用当前类的类型而不是提供给子例程的类型。我希望在编写代码时完成此操作，而不是在运行时完成，因为我需要智能感知来继续为新类型工作。

最后，我确实知道简单地使用“List(Of Object)”会帮助我解决问题。但是这对智能感知不起作用，我听说将对象声明为“对象”类型比将其声明为慢具体类型。

总而言之，我正在寻找一种将对象类型更改为程序员将类名自动更改为的方法。

谢谢一堆:)

--EDIT-- 我在一个相当简单的地方找到了我正在寻找的解决方案.. VS 重命名功能.. 啊，又一次答案如此简单。

感谢大卫 W 对我的耐心，谢谢一群大卫 W！我希望我没有因为我模糊的想法而给你带来太多麻烦 :) 我很欣赏这些建议 :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T21:47:00.020

在解决方案资源管理器中，当您重命名类文件时，Visual Studio 将相应地修复相应的类名。

# python - 类型错误：无法转换

> ID：12395296
> 
> 赞同：3
> 
> 时间：2012-09-12T19:50:59.117
> 
> 标签：python, pyside

使用`python`, `pyside`，我得到这个错误：

```
 self.setCheckState(value)
TypeError: could not convert 'BooleanEditor' to 'QCheckBox' 
```

除了许多谷歌的结果只显示“TypeError：**无法**转换”而不是“**可以**”，我仍然不知道如何解决这个问题。

代码片段：

```
class Editor(QGraphicsLayoutItem): 
    def __init__(self, name):
        QGraphicsLayoutItem.__init__(self)
        :
    :
    def update_value(self, value):
        pass

class BooleanEditor(Editor, QCheckBox):
    def __init__(self, parent, name, value, min, max):
        Editor.__init__(self, name)
        QCheckBox.__init__(self)

        self.update_value(value)

    def update_value(self, value):
        self.old_value = value
        self.setCheckState(value)  # Error occurs here. 
```

setCheckState 收到的“值”将是[Qt.CheckState](http://www.pyside.org/docs/pyside/PySide/QtCore/Qt.html?highlight=qt.checkstate#PySide.QtCore.PySide.QtCore.Qt.CheckState)。根据调试打印，运行时，“值”`Qt.Unchecked`如预期的那样是 (== 0)。

请注意，`BooleanEditor`使用`multiple inheritance`. 我正在将`wxWidget`应用程序（其他人制作的）移植到`Qt`，现在我不想更改此设计，因为它来自原始（这意味着这里的多重继承本身不应该是原因，因为原始应用程序工作正常）。

环境）pyside 1.1.0、python 2.7.3、Ubuntu 12.04

* * *

Update-1) 正如@Luke Woodward 建议的那样，我尝试将超类的顺序交换为`BooleanEditor(QCheckBox, Editor)`，然后在不同部分得到不同的错误。

```
class PaneGroup(GroupView, QFrame):
    def __init__(self, parent, group, config, top = None):
        GroupView.__init__(self, group, top) 
        QFrame.__init__(self)
        :
        sizer = QGraphicsGridLayout()
        :        
        for param_descr in self.params:
            name = param_descr['name']
            type, val, min, max, description = param_descr['type'], config[name], param_descr['min'], param_descr['max'], param_descr['description']
            try:
                enum = eval(param_descr['edit_method'])['enum']
                editor = self.top.EnumEditor(self, name, val, enum)
            except:
                editor = self.top._editor_types[type](self, name, val, min, max)
            self.top.editors[name] = editor
            sizer.addItem(editor, row, 1) # Error occurs here 
```

错误：

```
TypeError: could not convert 'BooleanEditor' to 'QGraphicsLayoutItem' 
```

对我来说，这似乎是一个关于多重继承初始化的问题..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T02:32:42.817

我很糟糕，原来我使用`PyQt4`的是`PySide`. 当我使用`PySide`时，不会发生错误（如@phihag 的要点所示），而使用`PyQt4`会产生相同的结果。这实际上很好奇，但我现在不会进一步调查。

使用以下代码进行复制。

```
#!/usr/bin/env python    
import sys
from PySide.QtCore import Qt
from PySide.QtGui import QApplication, QCheckBox, QGraphicsLayoutItem
#from PyQt4.QtCore import Qt
#from PyQt4.QtGui import QApplication, QCheckBox, QGraphicsLayoutItem

class Editor(QGraphicsLayoutItem):
    def __init__(self, name):
        QGraphicsLayoutItem.__init__(self)
    def update_value(self, value):
        pass

class BooleanEditor(Editor, QCheckBox):
    def __init__(self, value):
        Editor.__init__(self, "foo")
        QCheckBox.__init__(self)

        self.update_value(value)

    def update_value(self, value):
        self.old_value = value
        self.setCheckState(value) # Error occurs here
        print("End of update_value")

if __name__ == "__main__":
    qApp = QApplication(sys.argv)
    BooleanEditor(Qt.Checked) 
```

PS。为什么我不知道我在使用`PyQt`？对于我使用哪一个，我取决于我一直在使用的这个框架（[`qt_gui`](http://www.ros.org/wiki/qt_gui_core)在[`ROS`机器人操作系统](http://www.ros.org/wiki/)中调用），它没有明确告诉我正在使用哪个（它是开源项目，文档工作正在进行中） ...在破解它的代码后，我发现默认是`PyQt`.

# ruby-on-rails-3 - Rails：在对象验证上，属性为零

> ID：12395303
> 
> 赞同：0
> 
> 时间：2012-09-12T19:51:17.583
> 
> 标签：ruby-on-rails-3

我有 3 个模型：房屋、租户和管道工。租户属于_to 房子和房子有_one 租户。我想使用需要管道工数据的自定义 EachValidator。为此，在我的租户模型中：

```
attr_accessor :plumber_limit 
```

在控制器中，我设置了`plumber_limit`：

```
house.tenant.plumber_limit = plumber.value 
```

当租户验证触发时，该`tenant.plumber_limit`值为 nil，因此失败。我尝试为`plumber_limit`. 我试过添加`attr_accessible :plumber_limit`. 我尝试了不同的符号。这是因为`tenant`在子上下文中使用而失败吗？如果是这样，我如何`plumber_limit`进入`tenant`'s 验证？

根据要求，这是验证码：

```
class UniquePlumberAssignment < ActiveModel::EachValidator
  def validate_each(record, attribute, value)
    record.property.limit(record.plumber_limit).each |p|
      ...
    end
  end
end 
```

# c++ - 在 C++ ctor-initializer 中选择性地包含成员的干净方式

> ID：12395305
> 
> 赞同：0
> 
> 时间：2012-09-12T19:51:20.587
> 
> 标签：c++, ctor-initializer

如果我有：

```
Class MyClass {
public:
    MyClass( /* args */ );
private:
    someType member0;
    someType member1;
    // ...
    someType memberN;
#if defined(FIRST_COMPILE_CONDITION)
    someType condition1Member0;
    someType condition1Member1;
    // ...
    someType condition1MemberN;
#endif
#if defined(SECOND_COMPILE_CONDITION)
    someType condition2Member0;
    someType condition2Member1;
    // ...
    someType condition2MemberN;
#endif
}; 
```

对于一些任意数量的编译条件，是否有一种干净的方法可以做到这一点（尤其是对于可能的多个编译条件），而不会将一些永久成员放在最后？

```
MyClass::MyClass( /* args */ ) :
    member0( someValue ),
    member1( someValue ),
    // ...
    memberN( someValue ),
#if defined(FIRST_COMPILE_CONDITION)
    condition1Member0( someValue ),
    condition1Member1( someValue ),
    // ...
    condition1MemberN( someValue ),
#endif
#if defined(SECOND_COMPILE_CONDITION)
    condition2Member0( someValue ),
    condition2Member1( someValue ),
    // ...
    condition2MemberN( someValue ),
#endif
// ...
{
} 
```

由于尾随逗号，上述内容在大多数情况下都无法编译。

编辑以澄清：

可能应该明确指出，`someValue`它旨在成为一个潜在独立的任意值，在每种使用的情况下，它可能取决于也可能不取决于构造函数参数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T19:54:29.567

您可以将逗号放在初始化程序之前：

```
MyClass::MyClass() :
     member0( someValue )
    ,member1( someValue )
    // ...
    , memberN( someValue )
#if defined(FIRST_COMPILE_CONDITION)
    ,condition1Member0( someValue )
    ,condition1Member1( someValue )
    // ...
    ,condition1MemberN( someValue )
#endif
// ...
{
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T19:56:41.467

就个人而言，我尽量避免使用编译器指令（包括守卫除外），因为它们通常隐藏问题并反映设计问题。

我们都面临的一个设计问题是 windows/linux/mac 特定代码。处理跨平台的方法很少。

为了处理这个问题，我跳过编译器指令并在 Makefile/project 级别解决它（取决于您的工具）。为此，您可以：

1.  给类添加一个init_conditional()方法并在构造函数中调用
2.  为每个条件添加 class_init_....cpp 文件，每个文件都有不同的 init_conditional() 实现
3.  让 make 文件决定要编译和链接的文件

现在，这样做是它自己的一些工作，但在代码中要干净得多。

注意：这失去了对成员初始化的保护，但它是多条件编译问题的更通用的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T20:12:18.077

我总是使用以下方式来编写初始化：

```
MyClass::MyClass()
  : member0 ( some_value0 )
  , member1 ( some_value1 )
// etc
{} 
```

这是逻辑上更正确的方法，因为逗号将成员与其*前任*分隔，而不是下一个成员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T19:55:01.967

我想这就是有些人移动尾随逗号以使其位于下一个条目前面的原因：

```
member0( someValue ),
    member1( someValue )
    // ...
    , memberN( someValue )
#if defined(FIRST_COMPILE_CONDITION)
    , condition1Member0( someValue )
    , condition1Member1( someValue ) 
```

但这太**丑陋**了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T19:57:05.927

当您能够或被允许使用 C++11 时，它变得非常容易

```
Class MyClass {
  public:
    MyClass();
  private:
    someType member0 = someValue;
    someType member1 = someValue;
    // ...
    someType memberN;
#if defined(FIRST_COMPILE_CONDITION)
    someType condition1Member0 = someValue;
    someType condition1Member1 = someValue;
    // ...
    someType condition1MemberN = someValue;
#endif
#if defined(SECOND_COMPILE_CONDITION)
    someType condition2Member0 = someValue;
    someType condition2Member1 = someValue;
    // ...
    someType condition2MemberN = someValue;
#endif
}; 
```

真正的大优势是，您不必关心多个构造函数。但是，您也可以使用其他方法来实现这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-12T19:57:23.977

只需反转您的逗号逻辑：

```
MyClass::MyClass() :
    member0( someValue ),
    member1( someValue ),
    // ...
    memberN( someValue )
#if defined(FIRST_COMPILE_CONDITION)
    ,condition1Member0( someValue )
    ,condition1Member1( someValue )
    // ...
    ,condition1MemberN( someValue )
#endif
#if defined(SECOND_COMPILE_CONDITION)
    ,condition2Member0( someValue )
    ,condition2Member1( someValue )
    // ...
    ,condition2MemberN( someValue )
#endif
// ...
{
} 
```

注意删除第一个成员N之后的逗号

# java - java - 如何在java iText PDF中的多个页面上创建复选框？

> ID：12395308
> 
> 赞同：3
> 
> 时间：2012-09-12T19:51:27.573
> 
> 标签：java, pdf, itext, checkbox

我目前有一个看起来像这样在我的pdf上制作复选框的方法：

```
private static void createCheckbox(PdfWriter writer, float lowerLeftX, float lowerLeftY, float upperRightX, float upperRightY, String fieldName, boolean startChecked) throws IOException, DocumentException {
    RadioCheckField bt = new RadioCheckField(writer, new Rectangle(lowerLeftX, lowerLeftY, upperRightX, upperRightY), fieldName, "Yes");
    bt.setCheckType(RadioCheckField.TYPE_CHECK);
    bt.setBorderWidth(BaseField.BORDER_WIDTH_THIN);
    bt.setBorderColor(Color.BLACK);
    bt.setBackgroundColor(Color.WHITE);
    bt.setChecked(startChecked);
    bt.setOptions(RadioCheckField.READ_ONLY);
    PdfFormField ck = bt.getCheckField();
    writer.addAnnotation(ck);
} 
```

这让我可以发送左下 X 和 Y 坐标以及右上 X 和 Y 坐标来制作一个盒子。这似乎在我创建复选框的文档的第一页上工作正常。如果我尝试在后面的页面上制作它们，它们就不会出现。

示例：我在第一页上制作了一个 PDF 表单，制作了一个新页面，添加了更多信息和复选框，制作了一个新页面，添加了更多信息和复选框。即使我对带有复选框的两个页面使用相同的代码，最后一页实际上也不会显示复选框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T13:25:35.153

尝试在每个页面上放置不同的名称。字段名称是文档范围的。

# java - Maven 可以在这个 ANT build.xml 中做我们正在做的事情吗

> ID：12395310
> 
> 赞同：0
> 
> 时间：2012-09-12T19:51:31.200
> 
> 标签：java, spring, maven, ant

Maven 可以做我们在这个 ANT build.xml 中所做的事情吗？

1.  Takinig 源代码和 jars 和制造战争
2.  四处移动文件
3.  根据属性文件值更改文件中的值
4.  删除文件
5.  SCP WAR 到服务器

下面是我的 ANT 构建。请让我知道我是否可以在 Maven 中完成所有这些操作...谢谢

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project default="build" name="Create Runnable Jar for Project DisasterReliefBatch with Jar-in-Jar Loader">
    <!--this file was created by Eclipse Runnable JAR Export Wizard-->
    <!--ANT 1.7 is required      
                               -->
    <property name="server.location" value="uftwfssh@6dvjvm01.uftwf.dev:/home/uftwfssh" />
    <path id="master-classpath">
        <fileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" />
    </path>

    <target name="movexml" depends="clean">
        <copy todir="${user.home}/uft-workspace/DisasterReliefBatch/bin" overwrite="true">
            <fileset dir="${user.home}/uft-workspace/DisasterReliefBatch/src" includes="*.xml" />
            <mapper type="flatten" />
        </copy>

        <replace file="${user.home}/uft-workspace/DisasterReliefBatch/bin/config.xml" value="defaultvalue" propertyFile="name.properties">
            <replacefilter token="os400dataSource.url" property="os400dataSource.url" />
            <replacefilter token="os400dataSource.username" property="os400dataSource.username" />
            <replacefilter token="os400dataSource.password" property="os400dataSource.password" />

            <replacefilter token="mysqldataSource.url" property="mysqldataSource.url" />
            <replacefilter token="mysqldataSource.username" property="mysqldataSource.username" />
            <replacefilter token="mysqldataSource.password" property="mysqldataSource.password" />
        </replace>

        <replace file="${user.home}/uft-workspace/DisasterReliefBatch/bin/log4j.xml" value="defaultvalue" propertyFile="name.properties">
            <replacefilter token="email.to" property="email.to" />
            <replacefilter token="email.SMTPHost" property="email.SMTPHost" />
        </replace>
    </target>

    <target name="clean">
        <delete dir="${user.home}/uft-workspace/DisasterReliefBatch/bin" />
    </target>

    <target name="compile" depends="movexml">
        <mkdir dir="${user.home}/uft-workspace/DisasterReliefBatch/bin" />

        <javac destdir="${user.home}/uft-workspace/DisasterReliefBatch/bin">
            <src path="${user.home}/uft-workspace/DisasterReliefBatch/src" />
            <classpath refid="master-classpath" />
        </javac>

    </target>

    <target name="build" depends="compile">
        <jar destfile="${user.home}/DRB.jar">
            <manifest>
                <attribute name="Main-Class" value="org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader" />
                <attribute name="Rsrc-Main-Class" value="org.uftwf.batch.MainBatch" />
                <attribute name="Class-Path" value="." />
                <attribute name="Rsrc-Class-Path" value="./ commons-logging-1.1.1.jar mysql-connector-java-5.0.5.jar jt400Native.jar log4j-1.2.14.jar org.springframework.beans-3.0.6.RELEASE.jar org.springframework.core-3.0.6.RELEASE.jar org.springframework.jdbc-3.0.6.RELEASE.jar org.springframework.context-3.0.6.RELEASE.jar org.springframework.context.support-3.0.6.RELEASE.jar org.springframework.aspects-3.0.6.RELEASE.jar org.springframework.oxm-3.0.6.RELEASE.jar org.springframework.instrument.tomcat-3.0.6.RELEASE.jar commons-codec-1.4.jar httpclient-4.1.2.jar httpclient-cache-4.1.2.jar httpcore-4.1.2.jar httpmime-4.1.2.jar itext-xtra-5.1.3.jar itextpdf-5.1.3.jar jt400.jar junit-4.10.jar org.springframework.aop-3.0.6.RELEASE.jar org.springframework.asm-3.0.6.RELEASE.jar org.springframework.expression-3.0.6.RELEASE.jar org.springframework.instrument-3.0.6.RELEASE.jar org.springframework.jms-3.0.6.RELEASE.jar org.springframework.orm-3.0.6.RELEASE.jar org.springframework.test-3.0.6.RELEASE.jar org.springframework.transaction-3.0.6.RELEASE.jar org.springframework.web-3.0.6.RELEASE.jar org.springframework.web.portlet-3.0.6.RELEASE.jar org.springframework.web.servlet-3.0.6.RELEASE.jar org.springframework.web.struts-3.0.6.RELEASE.jar mail.jar mailapi.jar smtp.jar" />
            </manifest>

            <zipfileset src="${user.home}/jar-in-jar-loader.zip" />
            <fileset dir="${user.home}/uft-workspace/DisasterReliefBatch/bin" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="commons-logging-1.1.1.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="mysql-connector-java-5.0.5.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="jt400Native.jar" />
            <fileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch" includes="log4j-1.2.14.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.beans-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.core-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.jdbc-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.context-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.context.support-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.aspects-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.oxm-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.instrument.tomcat-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="commons-codec-1.4.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="httpclient-4.1.2.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="httpclient-cache-4.1.2.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="httpcore-4.1.2.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="httpmime-4.1.2.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="itext-xtra-5.1.3.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="itextpdf-5.1.3.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="jt400.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="junit-4.10.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.aop-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.asm-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.expression-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.instrument-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.jms-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.orm-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.test-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.transaction-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.web-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.web.portlet-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.web.servlet-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="org.springframework.web.struts-3.0.6.RELEASE.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="mail.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="mailapi.jar" />
            <zipfileset dir="${user.home}/uft-workspace/DisasterReliefBatch/lib" includes="smtp.jar" />
        </jar>

    </target>

    <target name="promote" depends="build">
        <input message="New version is going to be updated to 6dvjvm01 continue (y/n)?" validargs="y,n" addproperty="do.delete" />

        <condition property="do.abort">
            <equals arg1="n" arg2="${do.delete}" />
        </condition>

        <fail if="do.abort">Build aborted by user.</fail>

        <scp file="${user.home}/DRB.jar" todir="${server.location}" keyfile="${user.home}/.ssh/id_rsa" />
    </target>

    <target name="run" depends="build">
        <java jar="${user.home}/DRB.jar" fork="true" />
    </target>

    <target name="run-count" depends="build">
        <java jar="${user.home}/DRB.jar" fork="true">
            <arg value="count" />
        </java>
    </target>
</project> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:11:14.640

是的。基于属性的注入在 Maven 中被称为“资源过滤”。请参阅[http://www.sonatype.com/books/mvnref-book/reference/resource-filtering-sect-description.html](http://www.sonatype.com/books/mvnref-book/reference/resource-filtering-sect-description.html)。

在 Maven 项目中很少需要移动文件；您只需遵循约定或为编译器/war-assembly 插件声明额外的“源”路径。

我从未使用过 maven 直接将 war 文件 scp 到服务器，但是我会将此线程作为资源读取：[Maven copy local file to remote server using SSH](https://stackoverflow.com/questions/909867/maven-copy-local-file-to-remote-server-using-ssh)

作为最后的努力，maven 还有一个 'antrun' 插件，允许您在需要时运行自定义 ant 任务。但是，在您的情况下，它不应该是必需的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-23T10:51:34.553

对于“与服务器的 SCP 战争”，您可以查看[http://mojo.codehaus.org/wagon-maven-plugin/upload-mojo.html](http://mojo.codehaus.org/wagon-maven-plugin/upload-mojo.html)

手动尝试：`mvn org.codehaus.mojo:wagon-maven-plugin:1.0:upload -Dwagon.url=scp://username:userpassword@myserver -Dwagon.fromDir=target -Dwagon.includes=*.ear -Dwagon.toDir=/home/elisabetta`

在这两种情况下，请务必为 Wagon 添加 SSH 扩展： `<extensions> <extension> <groupId>org.apache.maven.wagon</groupId> <artifactId>wagon-ssh</artifactId> <version>2.8</version> </extension> </extensions>`

# javascript - jQuery 将数据发布到下一页

> ID：12395318
> 
> 赞同：2
> 
> 时间：2012-09-12T19:51:59.690
> 
> 标签：javascript, jquery, html, forms, post

我正在编写一个注册页面，用户首先在第一页中选择三个选项中的一个，然后才能移动到第二页，因为它显示的内容取决于先前的选择。所以这是我的代码：

```
<script>
$(document).ready(function(e) {
    $("form").submit(function() {
        var data= $(this).serialize();
        $.post("/Registration_1.php",data);
        alert(data);
    });
});
</script>

<form id="frmtype1" name="frmtype1" method="post">
<input type="radio" name="Reg_type" value="1"/> option 1 <br/>
<input type="radio" name="Reg_type" value="2"/> option 2<br/>
<input type="radio" name="Reg_type" value="3"/> option 3 <br/>
<input type="submit" name="Submit" value="Submit" />
</form> 
```

问题是，在选择一个选项并单击提交后，它只停留在第 1 页。警报显示数据，这一切都是正确的，但它不会移动到下一页。我是 jquery 的新手，所以我不知道 $.post 在语法上是否正确。谁能看到这里的问题是什么？为什么不跳转到下一页？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:00:42.937

伙计，您需要再定义一个函数来处理您的 post 方法的成功事件。当您的帖子成功完成后，您可以像 SomeKittens 向您展示的那样更改 URL。

```
$.post("/Registration_1.php",data,function(response){
     window.location = ...
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T20:24:41.040

请以如下形式指定操作：**action="your url"**

例如：

```
<body>
    <form id="form1" action="http://stackoverflow.com/" method="post">
        <input type="radio" name="Reg_type" value="1"/> option 1 <br/>
        <input type="radio" name="Reg_type" value="2"/> option 2<br/>
        <input type="radio" name="Reg_type" value="3"/> option 3 <br/>
        <input type="submit" id="s" name="Submit" value="Submit" />
    </form>
</body> 
```

修改后的脚本：

```
 $(document).ready(function () {
        $('input').on('click', function () {
            window.location('http://stackoverflow.com/');
        });
    }); 
```

希望这可以帮助 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:54:08.523

问题是`$.post`发送数据，但不重定向用户。

[这是有关如何重定向用户的教程。](http://www.tizag.com/javascriptT/javascriptredirect.php)

# javascript - 无法从 GMap v3 隐藏标记

> ID：12395319
> 
> 赞同：0
> 
> 时间：2012-09-12T19:52:02.010
> 
> 标签：javascript, google-maps, google-maps-api-3

我可以在地图上显示一堆不同类别的位置。最终我想对它们应用过滤器。可能这个场景非常熟悉，因为我在尝试解决我的问题时在网上发现了许多场景。我把标记放在我的地图上，我找不到隐藏它们的方法。这是我的尝试方法：

```
function addLocations($content, id, map){
var $mapdiv = $content.find('div.map_div');
catValues = [map.catPrimary, map.catWhite, map.catGreen, map.catYellow, map.catRed, map.catBrown, map.catPurple, map.catGray, map.catOrange];
db.locations.all(function(obj){
    $.each(obj, function(index, location){
        if(location.value.nodeID == id){
            var latitude = location.value.latitude;
            var longitude = location.value.longitude;
            var description = location.value.description;
            var category = location.value.category;
            var position = new google.maps.LatLng(latitude, longitude);
            if(category == "0"){
                homeLocation = position;
                $mapdiv.gmap('get','map').setOptions({'center':position});
            }       
            var marker = new google.maps.Marker({
                position: position, 
                icon: "assets/img/marker_" + category + ".png", 
                category: category,
                shadow: iconShadow,
            });
            marker.setMap( $mapdiv.gmap('get','map') );
            $mapdiv.gmap('addMarker', marker).click(function() {
                $mapdiv.gmap('openInfoWindow', { 'content': description + "<br/> (" + catValues[category] + ")"}, this);
            });
        }       
    });
    markers = $mapdiv.gmap('get', 'markers');
    for(var i = 0; i<markers.length; i++){
        if(markers[i].category != "0"){
            //"not primary, hiding  
            markers[i].setVisibile(false);
        }
    }
}); 
```

所有标记都显示出来，而应该隐藏的标记则不显示。在将标记添加到地图并使用它们之前，我还尝试将标记添加到数组中，但没有成功。当我在 try 和 catch 周围包含标记 [i].setVisible(false) 时，它说“对象 # 没有方法 'setVisible'。令人惊讶的是，如果我测试标记 [i].getVisible()，我得到的值为 true。我很感激提前您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:54:34.650

我相信正确的代码是`markers[i].setMap(null);`

[https://developers.google.com/maps/documentation/javascript/overlays#RemovingOverlays](https://developers.google.com/maps/documentation/javascript/overlays#RemovingOverlays)

来自文章：

> 移除叠加层
> 
> 要从地图中删除覆盖，请调用覆盖的 setMap() 方法，并传递 null。请注意，调用此方法不会删除叠加层；它只是从地图中删除覆盖。相反，如果您希望删除叠加层，则应将其从地图中删除，然后将叠加层本身设置为 null。
> 
> 如果你想管理一组覆盖，你应该创建一个数组来保存覆盖。使用此数组，您可以在需要删除数组中的每个叠加层时调用 setMap()。（请注意，与 V2 不同，不存在 clearOverlays() 方法；您负责跟踪叠加层并在不需要时将其从地图中移除。）您可以通过从地图中移除叠加层然后设置数组的长度为 0，这将删除对覆盖的所有引用。

# c# - Win32 OpenFileDialog 不过滤 *.DOCX 快捷方式

> ID：12395327
> 
> 赞同：2
> 
> 时间：2012-09-12T19:52:38.550
> 
> 标签：c#, c++, windows, winapi

我可以在几台装有 Windows 7 SP1 的不同计算机上执行此操作。

这可以在记事本（或任何其他使用的应用程序`OpenFileDialog`）中复制

1.  创建 DOCX 的快捷方式
2.  启动记事本
3.  文件，打开
4.  过滤 *.txt
5.  浏览到 *.docx 快捷方式的位置

*.docx 是我能找到的唯一一个不过滤的快捷方式扩展。到目前为止，我唯一的解决方法是让我的应用程序在用户选择文件后检查文件扩展名。

是否有某种方法可以`OpenFileDialog`按照用户的期望过滤掉 *.docx.lnk 文件？

为什么只有 Office 文件扩展名受到影响？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T08:48:37.733

只有 Office 2007+ 文档的快捷方式受到影响。（快捷方式实际上有一个 .lnk 扩展名，被 shell 隐藏，即 Windows 资源管理器）

当指定掩码“*.txt”时， FindFirstFile*找不到*这些文件，因此这是 shell 所做的。

[您可以尝试禁用相应的 shell 插件](http://www.nirsoft.net/utils/shexview.html#DownloadLinks)以确定哪个插件负责该行为（为了安全起见：禁用插件，通过任务管理器杀死并重新启动资源管理器，然后在再次测试之前重新启动您的进程）。

我检查了最明显的候选人，找不到任何人。

* * *

编程建议：验证您的输入。在您的情况下，这是文件内容，而不是文件扩展名！

我可以在“打开”对话框中指定任何字段，即使您限制了蒙版。
我可以将我的文本文件保存为“really.important”，并且仍然希望在您的应用程序中打开它。
我可以将我的 word 文件保存为“真正的 word document.txt”，在你的应用程序中打开它，至少希望你不会崩溃——

# c# - 我应该将用户配置文件信息存储在缓存还是会话中？

> ID：12395337
> 
> 赞同：2
> 
> 时间：2012-09-12T19:53:17.677
> 
> 标签：c#, asp.net, asp.net-mvc-3, caching

我的网站在右上角有一个小菜单，上面写着用户的名字和姓氏。我把这件作品放在局部视图中。由于这显示在每个页面上，我显然想缓存它，这样我就不必每次加载页面时都获取用户的信息。我应该将它存储在缓存或会话数据中，如果它在每个页面中，我应该在哪里创建我的代码来缓存这些数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T19:58:33.497

根据场景，您绝对应该使用缓存。正如您所说，您已经将菜单作为部分视图

```
 [OutputCache(Duration = 3600)]
    public ActionResult mymenu()
    {
        return PartialView();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:02:30.870

最好将用户信息存储在 session 中，而不是缓存中。缓存主要是应用程序级别，会话是每个用户/会话。如果您提供密钥（通过会话或 cookie），您可以将每个用户的信息存储在缓存中。

这篇文章可能有用：[-cache-session-viewstate-c#](http://www.codeproject.com/Articles/26621/Cache-Session-and-ViewState)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T20:02:34.427

如果您指的是 ASP.Net 缓存，则存储在其中的信息可用于机器上运行的任何 .Net 页面。我认为在你的情况下，会议会更合适。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T20:16:22.100

我不确定您使用的是什么身份验证机制，但它可能已经存储在：

HttpContext.Current.User

或者

System.Threading.Thread.CurrentPrincipal

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T20:19:02.063

我更喜欢创建一个用户对象，我可以在我的网站上设置我需要的所有方便的参数。

此对象存储在会话或数据库中，具体取决于站点

# iphone - 旧的应用程序将如何在 iPhone 5 上显示？

> ID：12395341
> 
> 赞同：-1
> 
> 时间：2012-09-12T19:53:33.777
> 
> 标签：iphone

iPhone 5 的新屏幕有一个不同的比例，16:9 (1136:640)。较旧的应用程序将如何显示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T19:56:07.240

它们将与现在适合屏幕中心的大小相同。

**编辑**截至 2013 年 5 月 1 日，Apple 要求所有应用程序都支持 iPhone 5 上的 4 英寸显示屏。所有应用程序都必须包含适当大小的启动图像。这是[iOS 人机界面指南](https://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/MobileHIG/TranslateApp/TranslateApp.html#//apple_ref/doc/uid/TP40006556-CH10-SW8)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T19:55:44.307

它们将显示在信箱中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T19:55:59.437

两边都会有一点未使用的空间。

# image - 在蒙版内滚动影片剪辑

> ID：12395346
> 
> 赞同：0
> 
> 时间：2012-09-12T19:53:45.790
> 
> 标签：image, flash, scroll, mask, movieclip

我正在使用 Flash CS5 并尝试在矩形蒙版内制作可滚动的影片剪辑。我尝试了不同的代码，但它似乎没有将影片剪辑假定为可滚动区域，将矩形作为蒙版。

我对此很陌生，可能有一个明显的解决方案。请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T04:56:58.523

链接[http://www.kirupa.com/developer/flash8/scrollbar.htm](http://www.kirupa.com/developer/flash8/scrollbar.htm)有一个滚动影片剪辑教程。我认为本教程将对您有所帮助。

# sql - 来自 pymssql 的 SQL 中的事务自行回滚

> ID：12395350
> 
> 赞同：0
> 
> 时间：2012-09-12T19:54:05.660
> 
> 标签：sql, sql-server, rollback, pymssql

我们有一个开发人员使用使用 freetds 的 pymssql 连接到 SQL Server。他的脚本根据 MySQL 数据库中的值动态生成 sql 插入查询。

当您在 SQL Profiler 中查看这些语句时，它们会被正确解析并在其中包含正确的开始事务/提交。出现“将数据库上下文更改为...”的唯一“用户错误消息”，每当您在 SQL 中发出 USE 时就会出现。批处理完成后，会出现事务日志事件“回滚”，并且删除所有插入的记录。

我们没有使用 XACT_ABORT_OFF 因为我没有看到“将数据库上下文更改为”受到它的影响。

有没有人对此有任何想法或经验？谢谢！

[编辑]：从分析器中复制的代码在 SSMS 中使用相同的用户可以正常工作，并且没有触发器。

[第二次编辑]：在 SQL 探查器中，我在 eventsubtype 下看到一个带有 'rollback' 的 'TransactionLog' 条目，但是没有 TM:Rollback Tran

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:12:28.530

可能连接未正确提交或关闭。检查 freetds 文档以确保您使用正确的使用模式。此外，您可能想检查是否可以在连接上启用自动提交模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T23:01:00.657

因此，经过多次搜索和三次检查自动提交设置后，我们发现 2 个变量的名称非常接近，并且它提交了错误的变量。有一个 mysql 和一个 pymysql 模块，但在这种情况下，我们使用的是 pymssql，但它是在 pymysql 中输入的。感谢所有评论的人。

# xml - XSLT .. 使用包含多个响应的 XML 中的最小值设置变量时遇到问题

> ID：12395353
> 
> 赞同：0
> 
> 时间：2012-09-12T19:54:14.760
> 
> 标签：xml, xslt

首先......这个论坛已经帮助我很多很多次找到我的问题的答案，而不必问我自己的问题。谢谢那些回答。我保证这次会按照这个论坛协议做得更好。

我并不完全肯定我的问题已经足够好，所以我会画出来一点......

我得到的 XML 在响应中包含一组结果，每个结果都需要有自己的“最小值”用于我的导入。

这是非常简洁的外观，只是为了给您一个想法：

```
<?xml version="1.0"?>
<GetLowestOfferListingsForASINResponse xmlns="http://mws.amazonservices.com/schema/Products/2011-10-01">
  <GetLowestOfferListingsForASINResult ASIN="0470067802" status="Success"></GetLowestOfferListingsForASINResult>
  <GetLowestOfferListingsForASINResult ASIN="0684177722" status="Success"></GetLowestOfferListingsForASINResult>
  <GetLowestOfferListingsForASINResult ASIN="0470052325" status="Success"></GetLowestOfferListingsForASINResult>
  <GetLowestOfferListingsForASINResult ASIN="0470182601" status="Success"></GetLowestOfferListingsForASINResult>
  <GetLowestOfferListingsForASINResult ASIN="0525950869" status="Success"></GetLowestOfferListingsForASINResult>
</GetLowestOfferListingsForASINResponse> 
```

此外，实际上在每个返回的结果中出现了 3 次“金额”元素......

目前，我的变量采用整体响应中的每个“金额”，而不是来自每个结果集中。

XLST：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0" 
xmlns:amz="http://mws.amazonservices.com/schema/Products/2011-10-01" xmlns:ns2="http://mws.amazonservices.com/schema/Products/2011-10-01/default.xsd" exclude-result-prefixes="amz ns2">
<xsl:output method="xml" version="1.0" encoding="utf-8" indent="yes"/>
    <xsl:template match="/">
    <xsl:variable name="MIN_Landed">
        <xsl:for-each select="//amz:Price/amz:LandedPrice/amz:Amount">
            <xsl:sort data-type="number" order="ascending"/>
            <xsl:if test="position()=1"><xsl:value-of select="."/></xsl:if>
        </xsl:for-each>
    </xsl:variable>
    <FMPXMLRESULT xmlns="http://www.filemaker.com/fmpxmlresult">
            <ERRORCODE>0</ERRORCODE>
            <PRODUCT BUILD="" NAME="" VERSION=""/>
            <DATABASE DATEFORMAT="M/d/yyyy" LAYOUT="" NAME="" RECORDS="1" TIMEFORMAT="h:mm:ss a"/>
            <METADATA>
                <FIELD EMPTYOK="YES" MAXREPEAT="1" NAME="MIN_Landed" TYPE="TEXT"/>
                <FIELD EMPTYOK="YES" MAXREPEAT="1" NAME="ASIN" TYPE="TEXT"/>
                <FIELD EMPTYOK="YES" MAXREPEAT="1" NAME="ItemCondition" TYPE="TEXT"/>
                <FIELD EMPTYOK="YES" MAXREPEAT="1" NAME="ItemSubCondition" TYPE="TEXT"/>
                <FIELD EMPTYOK="YES" MAXREPEAT="1" NAME="LandedPrice" TYPE="TEXT"/>
                <FIELD EMPTYOK="YES" MAXREPEAT="1" NAME="ListingPrice" TYPE="TEXT"/>
                <FIELD EMPTYOK="YES" MAXREPEAT="1" NAME="Shipping" TYPE="TEXT"/>
            </METADATA>
            <RESULTSET>
                <xsl:attribute name="FOUND">1</xsl:attribute>
                <xsl:for-each select="amz:GetLowestOfferListingsForASINResponse/amz:GetLowestOfferListingsForASINResult/amz:Product/amz:LowestOfferListings/amz:LowestOfferListing">
                    <ROW>
                        <xsl:attribute name="MODID">0</xsl:attribute>
                        <xsl:attribute name="RECORDID">1</xsl:attribute>
                        <COL>
                            <DATA>
                                <xsl:value-of select="$MIN_Landed"/>
                            </DATA>
                        </COL>
                        <COL>
                            <DATA>
                                <xsl:value-of select="../../amz:Identifiers/amz:MarketplaceASIN/amz:ASIN"/>
                            </DATA>
                        </COL>
                        <COL>
                            <DATA>
                                <xsl:value-of select="amz:Qualifiers/amz:ItemCondition"/>
                            </DATA>
                        </COL>
                        <COL>
                            <DATA>
                                <xsl:value-of select="amz:Qualifiers/amz:ItemSubcondition"/>
                            </DATA>
                        </COL>
                        <COL>
                            <DATA>
                                <xsl:value-of select="amz:Price/amz:LandedPrice/amz:Amount"/>
                            </DATA>
                        </COL>
                        <COL>
                            <DATA>
                                <xsl:value-of select="amz:Price/amz:ListingPrice/amz:Amount"/>
                            </DATA>
                        </COL>
                        <COL>
                            <DATA>
                                <xsl:value-of select="amz:Price/amz:Shipping/amz:Amount"/>
                            </DATA>
                        </COL>
                    </ROW>
                </xsl:for-each>
            </RESULTSET>
        </FMPXMLRESULT>
    </xsl:template>
</xsl:stylesheet> 
```

这是一个测试 XML ....

```
<?xml version="1.0"?>
<GetLowestOfferListingsForASINResponse xmlns="http://mws.amazonservices.com/schema/Products/2011-10-01">
    <GetLowestOfferListingsForASINResult  ASIN="0060784776"  status="Success">
        <Product>
            <Identifiers>
                <MarketplaceASIN>
                    <MarketplaceId>ATVPDKIKX0DER</MarketplaceId>
                    <ASIN>0060784776</ASIN>
                </MarketplaceASIN>
            </Identifiers>
            <LowestOfferListings>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Used</ItemCondition>
                        <ItemSubcondition>Good</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>8.98</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>4.99</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Collectible</ItemCondition>
                        <ItemSubcondition>Mint</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>8.98</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>4.99</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Used</ItemCondition>
                        <ItemSubcondition>VeryGood</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>9.00</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>9.00</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>0.00</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Used</ItemCondition>
                        <ItemSubcondition>Acceptable</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>9.44</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>5.45</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>New</ItemCondition>
                        <ItemSubcondition>New</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>9.45</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>9.45</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>0.00</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Used</ItemCondition>
                        <ItemSubcondition>VeryGood</ItemSubcondition>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>9.45</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>5.46</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>New</ItemCondition>
                        <ItemSubcondition>New</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>9.95</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>9.95</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>0.00</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
            </LowestOfferListings>
        </Product>
    </GetLowestOfferListingsForASINResult>
    <GetLowestOfferListingsForASINResult  ASIN="0140171223"  status="Success">
        <Product>
            <Identifiers>
                <MarketplaceASIN>
                    <MarketplaceId>ATVPDKIKX0DER</MarketplaceId>
                    <ASIN>0140171223</ASIN>
                </MarketplaceASIN>
            </Identifiers>
            <LowestOfferListings>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Used</ItemCondition>
                        <ItemSubcondition>Good</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>6.99</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.00</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Used</ItemCondition>
                        <ItemSubcondition>Acceptable</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>6.99</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.00</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Used</ItemCondition>
                        <ItemSubcondition>Mint</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>7.49</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.50</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Used</ItemCondition>
                        <ItemSubcondition>Acceptable</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>8.48</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>4.49</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>New</ItemCondition>
                        <ItemSubcondition>New</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>8.49</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>4.50</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Used</ItemCondition>
                        <ItemSubcondition>Mint</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>8.78</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>4.79</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Used</ItemCondition>
                        <ItemSubcondition>Good</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>8.98</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>4.99</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>New</ItemCondition>
                        <ItemSubcondition>New</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>8.99</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>5.00</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
            </LowestOfferListings>
        </Product>
    </GetLowestOfferListingsForASINResult>
    <GetLowestOfferListingsForASINResult  ASIN="014100181X"  status="Success">
        <Product>
            <Identifiers>
                <MarketplaceASIN>
                    <MarketplaceId>ATVPDKIKX0DER</MarketplaceId>
                    <ASIN>014100181X</ASIN>
                </MarketplaceASIN>
            </Identifiers>
            <LowestOfferListings>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Used</ItemCondition>
                        <ItemSubcondition>VeryGood</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>0.00</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Used</ItemCondition>
                        <ItemSubcondition>Good</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>0.00</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Used</ItemCondition>
                        <ItemSubcondition>Good</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>0.00</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Used</ItemCondition>
                        <ItemSubcondition>Good</ItemSubcondition>
                        <FulfillmentChannel>Merchant</FulfillmentChannel>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>4.00</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>0.01</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
                <LowestOfferListing>
                    <Qualifiers>
                        <ItemCondition>Used</ItemCondition>
                        <ItemSubcondition>Good</ItemSubcondition>
                    </Qualifiers>
                    <Price>
                        <LandedPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>4.00</Amount>
                        </LandedPrice>
                        <ListingPrice>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>0.01</Amount>
                        </ListingPrice>
                        <Shipping>
                            <CurrencyCode>USD</CurrencyCode>
                            <Amount>3.99</Amount>
                        </Shipping>
                    </Price>
                </LowestOfferListing>
            </LowestOfferListings>
        </Product>
    </GetLowestOfferListingsForASINResult>
</GetLowestOfferListingsForASINResponse> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T21:39:13.920

如果我理解正确，您的问题是您的代码当前`Amount`在文档中找到最低值，而您希望在每个`amz:LowestOfferListing`.

你需要改变两件事。

`$MIN_Landed`首先，您需要为每个结果集绑定一次该变量，而不是设置一次的值。因此，将`xsl:variable`声明移动到`for-each`将为每个结果集评估一次的其中。

其次，您想要的值是结果集中的最低值，而不是文档中的最低值。因此，您需要更改`select`表达式中确定`$MIN_Landed`变量值的属性，以便它仅选择`amz:Amount`当前结果集中出现的元素。（提示：`select`表达式以 './/' 开头，而不是 '//'。）

# javascript - Javascript 重定向/域指定

> ID：12395357
> 
> 赞同：0
> 
> 时间：2012-09-12T19:54:32.503
> 
> 标签：javascript

在搜索和检查某些网站的元素时，我发现了一个不错的脚本。

这是我发现的：

```
<script type="text/javascript">
//redirect browser to fullscreen preview
    if (/^http:\/\/codecanyon\.net/.test(document.referrer))
    window.top.location.href = 'http://www.gravitysign.com/backslider/';                    
</script> 
```

因此，如果我从这个脚本中理解，它会告诉 jquery 网站是否通过 codecanyon 打开，将它们重定向到指定的网站进行预览。

现在......我想知道是否有可能制作这样的东西。

如果我们指定一个网站，例如[http://google.com](http://google.com)并将其输入到 javascript... 然后如果该网站被上传到任何其他域，除了 google.com ...它将重定向到指定的站点（谷歌） ？

因此，为了稍微澄清一下，让我举个例子。

如果我为“an-website.com”创建了一个网站，然后有人将他们的网站上传到“another-website.com”，它会自动将所有访问者从 another-website.com 重定向到 an-website.com。

希望我足够清楚，并希望这是可能的。干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T08:19:50.473

您当然可以重定向从与您的域不匹配但使用 javascript 访问您网站的任何用户。这应该可以正常工作：

```
if (window.location.hostname !== 'yourdomain.com'){
    window.top.location.href = 'http://yourdomain.com'; 
} 
```

如果您在子域上托管您的网站等，您也可以使用匹配。

请记住，任何对服务器上的文件具有写访问权限的人都可以删除此“复制保护”。复制保护客户端内容是不可能的，因为您需要以浏览器理解的方式提供内容，从而有效地使任何人都可以使用该内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T09:32:56.373

如果您正在寻找单域保护的解决方案，您可以在这里查看我的

[如果未在脚本中指定域，则重定向网站 - 使用 Javascript 进行保护](https://stackoverflow.com/questions/15965035/redirect-website-if-its-not-specified-domain-in-script-protection-using-javasc)

我正在寻找多域的解决方案。

# c# - 在边界框碰撞中获取碰撞点

> ID：12395370
> 
> 赞同：3
> 
> 时间：2012-09-12T19:55:21.980
> 
> 标签：c#, xna, collision-detection, collision

我正在研究一种 2D 自上而下的地图生成算法，我所创建的只是具有顶部/左侧点和底部/右侧点的房间。所有房间都是矩形的，除了一些偶尔共用墙壁外，任何部分都没有重叠。

我的问题是，当我有两个房间最终在它们之间共享一堵墙时，我将如何快速轻松地吐出由所述墙内的两个房间共享的“瓷砖”（或点）列表？

我有点希望像：

```
private List<Point> SharedTiles (Point P1, Point P2, Point P3, Point P4)
{
    /*
    P1 = Top Left point of room1
    P2 = Bottom Right point of room1
    P3 = Top Left point of room2
    P4 = Bottom Right point of room2
    */
    List<Point> _SharedTiles = new List<Point>();
    //Magic goes here...
    return _SharedTiles;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:08:53.710

给定两个房间 A 和 B：

我假设指定的点不包括房间的墙壁。如果这是不正确的，您可以在第一步中跳过矩形膨胀。

将每个房间`Rectangle`表示为在每个方向上延伸一格以解释墙壁：

```
var roomAreaA = new Rectangle(a1.X - 1, a1.Y - 1, (a2.X - a1.X) + 2, (a2.Y - a1.Y) + 2); 
var roomAreaB = new Rectangle(b1.X - 1, b1.Y - 1, (b2.X - b1.X) + 2, (b2.Y - b1.Y) + 2); 
```

与房间区域相交：

```
var roomIntersection = Rectangle.Intersect(roomAreaA, roomAreaB); 
```

生成的矩形将表示两个房间区域之间的交集。既然你说房间*只能共享墙砖*，那么必然会得出这个交叉区域的所有瓷砖都是墙砖。

如有必要，您可以将此矩形转换为`Point`对象列表。我不一定会推荐下面的方法，这取决于它的使用方式，但它传达了这一点：

```
var p = from x in Enumerable.Range(r.X, r.Width)
        from y in Enumerable.Range(r.Y, r.Height)
        select new Point(x, y); 
```

# apache - 重定向除 ?p=* 之外的所有内容

> ID：12395373
> 
> 赞同：0
> 
> 时间：2012-09-12T19:55:34.477
> 
> 标签：apache, .htaccess, mod-rewrite, redirect, seo

如何配置 .htaccess 文件以重定向每个链接，除了

```
domain.com?p=* 
```

和

```
domain.com/index.php?p=* 
```

到 domain.com

我希望你能理解我的问题，谢谢你的每一个回答。来自德国的问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:02:57.600

将其放入文档根目录的 htaccess 文件中：

```
RewriteEngine On

# if query string is p=(something)
RewriteCond %{QUERY_STRING} ^p=
# and request is for "/" or "/index.php"
RewriteCond %{REQUEST_URI} ^/$ [OR]
RewriteCond %{REQUEST_URI} ^/index\.php$
# pass it through, don't do anything
RewriteRule ^ - [L]

# otherwise, redirect everything else to http://domain.com/
RewriteRule ^ http://domain.com/ [L,R=301] 
```

# gcc - gcc：尝试执行“as”时出错：execvp：没有这样的文件或目录

> ID：12395376
> 
> 赞同：1
> 
> 时间：2012-09-12T19:55:54.623
> 
> 标签：gcc, fortran, gfortran

我试图用山狮在我的英特尔 mac 上安装 gcc 和 gfortran，并在尝试编译 fortran 文件时不断收到上述错误。gcc 似乎也不适用于 c 程序。这是我在使用 c 程序时遇到的错误：

```
test.c:1:19: fatal error: stdio.h: No such file or directory 
```

我尝试在终端中输入：

```
export PATH=${PATH}:/usr/local/bin 
```

但这没有用。我将 gcc 和 gfortran 添加到 /usr/local/bin 而不是 /usr/bin。我通过 hpc 下载了编译器。这些文件具有给定的目录结构：

```
/usr/local/bin: contained gcc and gfortran along with other compilers
/uer/local/include/...
/usr/local/lib/...
etc... 
```

我几乎只是将所有文件直接复制并粘贴到计算机上完全相同的路径目录中，然后运行导出命令。这就是我所做的一切。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T15:59:10.487

您可能需要 odcctools（由 macports 提供）或 XCode（其中包含 Mac“binutils”和 Clang 编译器，GCC 已停产）。

# cordova - 移动应用程序是否会因使用访问来源而被拒绝 = *

> ID：12395380
> 
> 赞同：3
> 
> 时间：2012-09-12T19:56:01.640
> 
> 标签：cordova

我正在使用 phonegap/cordova 为苹果/安卓/黑莓构建一个移动应用程序，用于搜索美国的旅行社。如果应用程序显示搜索结果，一个选项是查看旅行社的网站。为了让我这样做，我对使用 phonegap/cordova 的理解是，我需要通过我的应用程序访问的任何网站都需要添加到白名单中（苹果的情况）。我的问题如下：如果在我的 config.xml 文件中我只是使用

```
<access subdomains="true" origin="*"/> 
```

我的申请是否有被 Apple 应用商店拒绝的风险？或谷歌播放？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T21:48:56.763

苹果指南中没有关于您可以在应用程序中打开哪些网址的任何限制的具体行，如 phonegap 有关白名单的文档中所示，它通知您可以使用 * 所以它根本不应该是一个问题：

> 访问 google.com 上的所有子域（例如 mail.google.com 和 docs.google.com）：
> 
> *.google.com

但我强烈建议您限制访问，因为没有人知道苹果对此做了什么。

# android - Android Actionbar 导航微调器文本颜色

> ID：12395381
> 
> 赞同：6
> 
> 时间：2012-09-12T19:56:04.477
> 
> 标签：android, android-actionbar, android-theme

我能够更改导航微调器的背景：

```
 <style name="MyTheme" parent="android:style/Theme.Light">
        <item name="android:actionBarStyle">@style/MyActionBar</item>
        <item name="android:actionDropDownStyle">@style/MyDropDownNav</item>
    </style>

  <style name="MyDropDownNav" parent="android:style/Widget.Spinner">
        <item name="android:background">@drawable/spinner_white</item>
        <item name="android:textColor">@color/red</item>
    </style> 
```

然而 textColor 没有改变。我还尝试了其他方法来更改 textColor：

```
 <style name="MyActionBar" parent="@android:style/Widget.Holo.ActionBar">
        <item name="android:background">?color_actionbar</item>
        <item name="android:titleTextStyle">@style/myTheme.ActionBar.Text</item>
    </style>

  <style name="myTheme.ActionBar.Text" parent="@android:style/TextAppearance">
        <item name="android:textColor">@color/violet</item>
    </style> 
```

还有什么想法吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-19T20:54:51.787

我一直在寻找相同的答案，但没有找到任何东西，所以我尝试了这个解决方案。我至少为我工作。

在主题文件中，您可以设置 spinnerDropdownItemStyle 的样式：

```
<style name="YourTheme" parent="YourParentTheme">
    <item name="android:spinnerDropDownItemStyle">@style/YourCustomDropDownItemStyle</item>
</style> 
```

现在，为您的样式设置 textappearance：

```
<style name="YourCustomDropDownItemStyle" parent="@android:style/Widget.Holo.DropDownItem.Spinner">
    <item name="android:textAppearance">@style/YourCustomDropDownItemTextStyle</item>
</style> 
```

在您的自定义文本外观中，您可以设置文本详细信息：

```
<style name="YourCustomDropDownItemTextStyle" parent="@android:style/Widget">
    <item name="android:textColor">@color/white</item>
    <!-- Here you can set the color and other text attributes -->
</style> 
```

希望这可以帮助！

# javascript - 使用 jQuery jTemplates 创建树视图

> ID：12395384
> 
> 赞同：0
> 
> 时间：2012-09-12T19:56:15.963
> 
> 标签：javascript, jquery, jtemplates

在我的应用程序中，当每个项目可以有许多子节点时，我有复杂的树形数据结构。我正在尝试在 jQuery jTemplates 插件的帮助下使用这些数据构建一种树视图。我正在寻找一种方法来做到这一点，但我走到了死胡同，我不知道如何继续。到目前为止，我得到了：

```
{#foreach $T as item}
<div class="procsSumItem {#if $T.item.Status==3}pending{#/if}">

 <div class="itemIcon {#if $T.item.Status==3}pending{#/if}">
  <div class="taskIcon"></div>
 </div>

 <h2 class="title">{$T.item.Title}</h2>
 <span class="value">{$T.item.Value}</span>
  {#if $T.item.Nodes.length}<div class="expand"></div>{#/if}
 <div class="expandPanel hidden">
 {#foreach $T.item.Nodes as N1}
 {#if $T.N1.Nodes.length}
   <div class="groupHeader">
     <span class="groupIcon"></span>
     <span class="groupTitle">{$T.N1.Title}</span>
   </div>
        {#foreach $T.N1.Nodes as N2}
           {#if $T.N2.Nodes.length}
            {#foreach $T.N2.Nodes as N3}
                {#if $T.N3.Nodes.length}
                    //this can be very deep....
                 {#/if}
            {#/for}
          {#else}
             <ul class="recipents rgroup">
             <li class="{#if $T.b.Replied}rep{#/if}">
                <span class="user"></span>
                <span>{$T.b.Title}</span>
                <div class="arrow"></div>
                {#if $T.b.Replied}<span class="replied">Replied</span>{#/if}
             </li>
            </ul>
        {#/if}
       {#/for}
  {#else}
   <ul class="recipents">
    <li class="{#if $T.a.Replied}rep{#/if}">
         <span class="user"></span>
         <span>{$T.a.Title}</span>
         <div class="arrow"></div>
         {#if $T.a.Replied}<span class="replied">Replied</span>{#/if}   
    </li>
   </ul>
  {#/if}
 {#/for} 
   </div>
 <p class="time">{$T.item.CreatedAt}</p>
</div>
{#/for} 
```

如您所见，我的问题是，在我当前的方法中，查找每个项目的子节点的过程可能是无穷无尽的。如果它有帮助，我可以返回每个项目的深度，所以也许我可以循环这个动作。但我不确定这是否是正确的方法。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T18:13:28.910

我会将“节点”模板放在一个单独的模板中，并`{#include}`为每个节点放置该模板。

在该模板中，您可以使用 an`{#if}`来确定是否有更多子节点要渲染，然后`{#include}`再次递归地使用节点模板（从节点模板本身中）以继续递归地渲染节点。

或者，您可以使用 JavaScript 来处理递归，通过仅传入必要的数据来呈现每个级别的节点模板，然后使用 jQuery 的操作方法将它们组装在一起。

# meteor - Meteor 如何处理陈旧的连接？

> ID：12395387
> 
> 赞同：3
> 
> 时间：2012-09-12T19:56:23.920
> 
> 标签：meteor

我正在尝试以某种方式处理应用程序状态损坏的情况：

1.  我首先在两个浏览器窗口中打开同一个应用程序。
2.  关闭 wi-fi（或 3g） - 连接变得陈旧，因为它没有从远程服务器关闭。
3.  在第一个选项卡中执行写入操作（第二个选项卡当然不会被动更新）。
4.  打开无线网络。
5.  在第一个选项卡中执行第二次写入（第二个选项卡现在将响应更新）
6.  所以第一个选项卡现在处于损坏状态。第一次写入永远不会同步到服务器，如果页面重新加载，该更改将永久丢失。

有没有办法处理这种陈旧的连接状态？Meteor.status().connected 在整个场景中保持真实。这是需要解决的流星问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-22T14:43:05.643

此问题已在 Meteor 的 github 页面上标记为已确认的错误

[https://github.com/meteor/meteor/issues/339](https://github.com/meteor/meteor/issues/339)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T02:33:15.030

编辑：

算了，不幸的是我的假设没有成功:(

[http://jqm.meteor.com](http://jqm.meteor.com)在重新连接时确实提交了更改，

但 Meteor.status() 确实在该页面上不起作用。

在meteor.com 上确实如此，这很奇怪，因为afaik 整个流星云应该在0.4.0 上运行，而不仅仅是托管应用程序？

玩得开心

马纳留斯

# php - Doctrine2 缓存损坏？

> ID：12395389
> 
> 赞同：1
> 
> 时间：2012-09-12T19:56:26.663
> 
> 标签：php, symfony, doctrine-orm, memcached

我有一个像 Bellow 一样的存储库。

代码首先检查项目是否已经在表中。

*   如果不是，它会下载数据，然后将其存储到表中。

*   如果它已经在表中，它只会返回记录。

但是有时在它检查表中的项目之后，它仍然会去尝试下载并存储该项目，即使它已经存在，从而产生密钥冲突，但这绝不应该发生，因为它只是搜索并没有找到它。

注意事项：

1.  **如果我禁用 $query->useResultCache(true) 我没有问题。**
2.  这是唯一在桌面上工作的过程。
3.  这是代码中唯一将项目添加到表中的地方。
4.  此代码是从 symfony2 控制台命令调用的。
5.  Memcache 是为学说 2 设置的缓存。
6.  Memcached 在本地运行。
7.  使用 arraycache 时也会产生错误。
8.  此查询每秒运行多次。

```
    类 ItemRepository 扩展 EntityRepository
    {
      公共函数 findOrFetch($id)
      {

        $item = $this->findItem($id);

        如果（$项目！=空）
          返回$项目；
        别的
          {
        $itemData = $this->fetchItem($id);

        $ 项目 = 新项目（）；
        $item->setId($id);
        $item->setName($itemData['name']);
        $this->getEntityManager()->persist($item);
        $this->getEntityManager()->flush();
          }
      }

      私有函数 findItem($id)
      {
        $查询 = $这个
          ->getEntityManager()
          ->createQuery('SELECT i from MonkeyWire\WowProfToolsBundle\Entity\Item i WHERE i.id = ?1');
        $query->setParameter(1, $id);
        $query->useResultCache(true);

        返回 $query->getOneOrNullResult();
      }

      私有函数 fetchItem($id)
      {
        $api = 新客户端（）；
        $api->setRequest(new Curl());

        尝试
          {
        $itemData = $api->getItemsApi()->getItem($id);
          }
        捕捉（NotFoundException $e）
          {
        $itemData['name'] = "na";
          }

        返回 $itemData;
      }
    }

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T02:21:28.137

听起来您可能需要在添加新项目时使结果缓存过期。

`$query->expireResultCache();`

根据您的存储库，您可能需要进行一些重组以适应它：

```
class ItemRepository extends EntityRepository
{
    public $findQuery = null;
    ...
    public function findOrFetch($id)
    {
        ...
        $this->getEntityManager()->flush();
        $this->findQuery->expireResultCache();
          }
    }

    private function findItem($id)
    {
      $query = $this
        ->getEntityManager()
        ->createQuery('SELECT i from MonkeyWire\WowProfToolsBundle\Entity\Item i WHERE i.id = ?1');
      $query->setParameter(1, $id);
      $this->findQuery = $query;
      ...
    }
} 
```

# jquery - blockUI 可滚动内容

> ID：12395392
> 
> 赞同：2
> 
> 时间：2012-09-12T19:56:39.747
> 
> 标签：jquery, blockui

我喜欢 blcokUI 插件。我在项目中到处使用它。最近，我需要在 blockUI 对话框中注入动态 html。基本上内容是图像预览。大多数时候，照片所需的空间比屏幕本身要大。

我尝试了很多我能想到的解决方案，包括在 blockUI 中有一个单独的可滚动 div，但没有运气。

有没有人做到这一点？

**编辑：** 代码如下；

如何调用 blockUI：

```
$('#addphoto').click(function (e) {
    $('body').block({ message: $('#dropbox'), css: { top: '10px;', width: '90%', 'position': 'absolute'}, allowBodyStretch: true })
}); 
```

保管箱内容：

```
<div id="dropbox" style="display:none;"><span class="message">drag&drop images here</span></div>
<div id="image_container">
    <div class="preview done">
        <span class="imageHolder">
            <img src="" />
            <span class="uploaded" style="overflow: scroll"; ></span></span>
        <div class="progressHolder">
            <div class="progress">
            </div>
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-31T02:47:47.437

您可以使用`blockMsgClass`BlockUI 中的参数来修改用于单个对话的类。由于这些是内联添加的，因此您需要包含`!important`这些属性才能使某些 css 属性起作用。

知道这一点，您可以执行以下操作：

```
$('#addphoto').click(function (e) {
    $('body').block({ 
       blockMsgClass: 'PhotoAdd',
       message: $('#dropbox') 
     })
}); 
```

然后在你的CSS中：

```
.PhotoAdd{
 Top:10px!important;
 width:90%!important;
 position: absolute!important;
 height:90%!important;
 overflow:auto!important;
} 
```

这将使整个 BlockUI 对话框根据需要滚动。

# wpf - 如何像 Blu twitter 客户端一样重新设置 wpf 窗口的样式

> ID：12395396
> 
> 赞同：0
> 
> 时间：2012-09-12T19:56:53.937
> 
> 标签：wpf

很长一段时间以来，我一直在寻找开发类似蓝光的窗口的技巧，其中一些叶子图像从标题栏中出来。他们如何设计这样的布局。

这是自定义标题栏的小图像 ![在此处输入图像描述](../Images/40143f9ab7b8b7983ad869cf4f584d77.png)

请有人告诉我如何设计这种类型的标题栏，其中的内容来自标题栏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:11:49.293

您可以通过为窗口设置适当的背景图像并设置`AllowsTransparency`为`True`：

```
<Window x:Class="WpfApplication1.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" WindowStyle="None" AllowsTransparency="True">
    <Window.Background>
        <ImageBrush ImageSource="/bg.png"/>
    </Window.Background> 
```

然后您必须创建自己的标题栏，因为不会显示默认的标题栏。

# c# - 创建新数据库并填充另一个数据库

> ID：12395406
> 
> 赞同：3
> 
> 时间：2012-09-12T19:57:59.373
> 
> 标签：c#, sql, ms-access

**我在C# windows 程序**中有一个问题，我无法使用 2 个数据库，这些数据库是表和数据中的简单数据库。在这个项目中，我想**打开 Access 数据库**并使用另一个名称**创建新的 Access 数据库，但****具有相同的表、列和行**，并填充源数据库中的源数据。

我无法从源数据库读取并插入新的目标数据库。源代码如下，请帮我完成这个项目，非常感谢。

```
private void button3_Click(object sender, EventArgs e)
{
    OleDbConnection cn = new OleDbConnection();
    cn.ConnectionString = @"provider=Microsoft.ACE.OLEDB.12.0;" + @"data source=" + openFileDialog1.FileName;
    OleDbCommand cmd = new OleDbCommand();
    cn.Open();
    DataTable table = cn.GetSchema("Tables");

    int i = 0;
    foreach (System.Data.DataRow row in table.Rows)
    {
        if ((string)row["TABLE_TYPE"] == "TABLE")
        {
            comboBox1.Items.Add(row["TABLE_NAME"]);
            Tables[i] = row["TABLE_NAME"].ToString();
            listBox1.Items.Add(Tables[i]);
            i++;
            n++;
        }
    }
}
private void comboBox1_SelectedIndexChanged(object sender, EventArgs e)
{
    OleDbConnection conne = new OleDbConnection();
    conne.ConnectionString = @"provider=Microsoft.ACE.OLEDB.12.0;" + @"data source=" + openFileDialog1.FileName;
    conne.Open();
    OleDbCommand cmd = new OleDbCommand();
    cmd.Connection = conne;
    DataTable Dt = new DataTable();
    cmd.CommandText = "select * from " + comboBox1.Text;
    OleDbDataAdapter adapter = new OleDbDataAdapter();
    adapter.SelectCommand = cmd;
    adapter.Fill(Dt);
    dataGridView1.DataSource = Dt;
    dataGridView1.Visible = true;
    conne.Close();
}
private void button2_Click(object sender, EventArgs e)
{
    saveFileDialog1.Filter = "accdb|*.accdb";
    saveFileDialog1.Title = "Save Access DataBase File";
    saveFileDialog1.FileName = strFileName;
    saveFileDialog1.ShowDialog();
    System.IO.File.Copy(openFileDialog1.FileName, saveFileDialog1.FileName);

    ADOX.Catalog cat = new ADOX.Catalog();
    cat.Create("Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + saveFileDialog1.FileName);
    Console.WriteLine("Database Created Successfully");
    OleDbConnection connsave = new OleDbConnection();
    connsave.ConnectionString = @"provider=Microsoft.ACE.OLEDB.12.0;" + @"data source=" + saveFileDialog1.FileName;
    connsave.Open();
    OleDbCommand cmdsave = new OleDbCommand();
    cmdsave.Connection = connsave;

    OleDbConnection connopen = new OleDbConnection();
    connopen.ConnectionString = @"provider=Microsoft.ACE.OLEDB.12.0;" + @"data source=" + openFileDialog1.FileName;
    connopen.Open();
    OleDbCommand cmdopen = new OleDbCommand();
    cmdopen.Connection = connopen;

    int i = 0;

    foreach (string strtablename in Tables)
    {
        if (i < n)
        {
            cmdsave.CommandText = "CREATE TABLE [" + Tables[i] + "]";
            cmdsave.ExecuteNonQuery();
            cmdsave.CommandText = "DELETE FROM [" + Tables[i] + "]";
            cmdsave.ExecuteNonQuery();
            cmdopen.CommandText = "SELECT * FROM [" + Tables[i] + "]";
            cmdopen.ExecuteNonQuery();
            cmdsave.CommandText = "INSErT INTO [" + Tables[i] + "]";
            cmdsave.ExecuteNonQuery();                       
            i++;
        }
    }
    connopen.Close();
    connsave.Close();
    textBox2.Text = saveFileDialog1.FileName.ToString();
    MessageBox.Show("DataBase Save Sucessfull in \"" + textBox2.Text + "\"");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T02:40:23.103

`INSERT INTO`您可以使用该子句执行语句`IN`：

```
INSERT INTO DestinationTable (DestinationField)
IN '' [;DATABASE= C:\Users\Rob\Documents\Northwind 2007.accdb]
SELECT SourceField FROM SourceTable 
```

他们在这里更详细地介绍：http: [//blogs.office.com/b/microsoft-access/archive/2009/03/27/accessing-external-data-using-the-in-clause.aspx](http://blogs.office.com/b/microsoft-access/archive/2009/03/27/accessing-external-data-using-the-in-clause.aspx)

# multithreading - 在主线程中添加的线程中读取数据的核心数据

> ID：12395407
> 
> 赞同：0
> 
> 时间：2012-09-12T19:58:02.373
> 
> 标签：multithreading, core-data, nsmanagedobjectcontext, nspersistentdocument

我有一个基于 Mac 文档的应用程序，使用 NSPersistentDocument 作为文档模型。

创建新文档时，应用程序会在 initiWithType 方法中将一些默认数据（一些运动对象和用户数据）添加到文档中。

```
- (id)initWithType:(NSString *)typeName error:(NSError **)outError {
self = [super initWithType:typeName error:outError];

NSManagedObjectContext *managedObjectContext = [self managedObjectContext];

[[SportManagement sharedManager] addDefaultSports:managedObjectContext];
[[UserManagement sharedManager] addDefaultUser:managedObjectContext];

[managedObjectContext processPendingChanges];

return self; 
```

}

该应用程序有一个导入功能，可以从一些硬件中导入数据，它在一个线程中运行，我设置如下（managedObjectContext 是 NSPersistentDocument 的）：

```
dispatch_async(dispatch_get_global_queue(0, 0), ^ {

    NSManagedObjectContext *moc = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSConfinementConcurrencyType];
    [moc setPersistentStoreCoordinator:[managedObjectContext persistentStoreCoordinator]]; 
```

数据从硬件导入到许多 NSManagedDataObject 项中。每个 ManagedObject 都有一个“Sport”字段，需要用创建文档时创建的运动对象之一填充该字段。

但是，`- (id)initWithType:(NSString *)typeName error:(NSError **)outError`线程 (moc) 中的新 ManagedObjectContext 中不存在任何已添加的运动对象。

如果我运行应用程序，创建一个新文档，然后让应用程序空闲一分钟左右，然后尝试导入，那么 Sport 对象确实存在于线程托管对象上下文中。

如何将线程中的新 ManagedObjectContext 与 NSPersistantDocument 中的主线程同步？

我试过：`[managedObjectContext processPendingChanges];`和`[managedObjectContext setStalenessInterval];`，但似乎都不能解决这个问题。

有趣的是，这似乎不会在 Mac OS X 10.8 中发生，仅在 10.7 中发生

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:49:20.663

设置您的“主” MOC 以接收`NSManagedObjectContextDidSaveNotification`通知，并在后台 MOC 保存时合并更改`-mergeChangesFromContextDidSaveNotification:`。

**编辑**

好的，看起来您已经在 MOC 中进行了更改，但它只是一个暂存器。在数据实际保存到持久存储之前，持久存储不知道新的数据更改。

因此，当您创建其他 MOC 并将其连接到 PSC 时，它不知道这些更改。

您可以知道自动保存何时启动，因为“过一段时间”它会起作用。

创建初始内容后，我会尝试手动保存文档。

# sql - 防止 SQL Server 中的 DROP 表

> ID：12395412
> 
> 赞同：3
> 
> 时间：2012-09-12T19:58:39.160
> 
> 标签：sql, sql-server

有没有办法以某种方式阻止 SQL Server 中的 DROP TABLE，只需使用 SSMS 及其功能？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T20:00:11.463

不要授予用户删除表的权限。

您可能认为[DDL 触发器](http://msdn.microsoft.com/en-us/library/ms190989(v=sql.105).aspx)可以*防止*这种情况发生。在某种程度上确实如此：它让下降发生，然后将其回滚。这并没有完全*阻止*它，但我想它可能已经足够好了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:01:07.577

检查[一下](http://pratchev.blogspot.com/2007/12/prevent-table-drop.html)，基本上有两种方法

> 第一个基于使用选项 SCHEMABINDING 在表上创建视图。当使用 SCHEMABINDING 选项时，不能以影响视图定义的方式修改表，并且除非先删除视图，否则不能删除它。
> 
> 第二种方法是使用 SQL Server 2005 中的新 DDL 触发器。为 DROP_TABLE 定义带有回滚主体的触发器将不允许删除表。

# android - Android 3rd Party Paging Control 就像 Etsy iPhone 中的一样？

> ID：12395413
> 
> 赞同：0
> 
> 时间：2012-09-12T19:59:00.107
> 
> 标签：android, paging, android-viewpager, etsy

我正在开发一个 Android 应用程序。我们的设计者认为我们需要一个看起来像 Etsy iPhone 的分页控件。（见下图）

基本上你可以在灰色标题栏或内容上滑动切换屏幕。

是否有任何现有的第三方控制可以做到这一点？

![在此处输入图像描述](../Images/208cd819b924554af5729e338e4ff4a5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:21:03.337

我建议您使用 Jake Whartons [ViewPageIndicator](http://viewpagerindicator.com/)（或只是普通的 ViewPager）：

为每个布局创建一个`Fragment`，并使用片段内的方法将布局设置为`onCreateView()`片段（仅当您想要具有不同的布局时。如果您有相同的布局但只是不同的数据，您可以只使用一个片段并传递getItem() 方法中的数据）

```
@Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, 
        Bundle savedInstanceState) {

        return inflater.inflate(R.layout.layout, container, false);
    } 
```

现在创建一个`FragmentPagerAdapter`名为`getItem()`. `Switch`位置并将其设置为您的片段：

```
@Override
            public Fragment getItem(int position) {
                switch(position){
                case 0:
                    TestFragment fragment = new TestFragment();  

                    return fragment;

                case 1:
                            TestFragment2 fragment2 = new TestFragment2();  
                    return fragment2;

                }

                return defaultFragment fragment3 = new defaultFragment();  
                    return fragment3;
            } 
```

现在您应该可以轻松滑动到您的布局（片段）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:20:13.433

您需要使用[ViewPager](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)小部件。查看 Android 开发者博客以了解其工作原理：[使用 ViewPager 进行水平视图滑动](http://android-developers.blogspot.fr/2011/08/horizontal-view-swiping-with-viewpager.html)。

如果您需要向后兼容 Android 2.x，请查看 Android 兼容性库。

所有解释都在那里：[实现水平分页（滑动视图）](http://developer.android.com/training/implementing-navigation/lateral.html#horizontal-paging)

该页面的一些代码：

```
public class CollectionDemoActivity extends FragmentActivity {
    // When requested, this adapter returns a DemoObjectFragment,
    // representing an object in the collection.
    DemoCollectionPagerAdapter mDemoCollectionPagerAdapter;
    ViewPager mViewPager;

    public void onCreate(Bundle savedInstanceState) {
        // ViewPager and its adapters use support library
        // fragments, so use getSupportFragmentManager.
        mDemoCollectionPagerAdapter =
                new DemoCollectionPagerAdapter(
                        getSupportFragmentManager());
        mViewPager = (ViewPager) findViewById(R.id.pager);
        mViewPager.setAdapter(mDemoCollectionPagerAdapter);
    }
}

// Since this is an object collection, use a FragmentStatePagerAdapter,
// and NOT a FragmentPagerAdapter.
public class DemoCollectionPagerAdapter extends
        FragmentStatePagerAdapter {
    public DemoCollectionPagerAdapter(FragmentManager fm) {
        super(fm);
    }

    @Override
    public Fragment getItem(int i) {
        Fragment fragment = new DemoObjectFragment();
        Bundle args = new Bundle();
        // Our object is just an integer :-P
        args.putInt(DemoObjectFragment.ARG_OBJECT, i + 1);
        fragment.setArguments(args);
        return fragment;
    }

    @Override
    public int getCount() {
        return 100;
    }

    @Override
    public CharSequence getPageTitle(int position) {
        return "OBJECT " + (position + 1);
    }
}

// Instances of this class are fragments representing a single
// object in our collection.
public static class DemoObjectFragment extends Fragment {
    public static final String ARG_OBJECT = "object";

    @Override
    public View onCreateView(LayoutInflater inflater,
            ViewGroup container, Bundle savedInstanceState) {
        // The last two arguments ensure LayoutParams are inflated
        // properly.
        View rootView = inflater.inflate(
                R.layout.fragment_collection_object, container, false);
        Bundle args = getArguments();
        ((TextView) rootView.findViewById(android.R.id.text1)).setText(
                Integer.toString(args.getInt(ARG_OBJECT)));
        return rootView;
    }
}

<android.support.v4.view.ViewPager
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/pager"
    android:layout_width="match_parent"
    android:layout_height="match_parent">

    <android.support.v4.view.PagerTitleStrip
        android:id="@+id/pager_title_strip"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="top"
        android:background="#33b5e5"
        android:textColor="#fff"
        android:paddingTop="4dp"
        android:paddingBottom="4dp" />

</android.support.v4.view.ViewPager> 
```

# javascript - chrome开发者工具控制台中对象之间的差异

> ID：12395416
> 
> 赞同：3
> 
> 时间：2012-09-12T19:59:03.447
> 
> 标签：javascript, google-chrome, object, google-chrome-devtools

当我将我的一个对象（通过 ajax 调用创建）打印到控制台时，我回来了：

```
Object
discreet: Array[2]
range: Array[2]
__proto__: Object 
```

但是当我手动创建对象时，我会正确返回：

```
Object {range: Array[2], discreet: Array[2]}
discreet: Array[2]
range: Array[2]
__proto__: Object 
```

有人可以向我解释这两个对象之间的区别，以及为什么我无法访问第一个对象的属性吗？

编辑：第一个对象是由以下人员创建的：

```
var obj = {}

$http.get('/discreet').then( function(data) { obj.discreet = data } );
$http.get('/range').then( function(data) { obj.range = data } );

print(obj); 
```

我手工制作的第二个：

```
var obj = { range: [1,2], discreet: [1,2] }
print(obj); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:26:10.307

这是一个误解异步编程的经典案例。以下是您需要了解的内容：

1.  JavaScript 是单线程的，所以它一次只能做一件事。

2.  `.then`附加到的回调函数`$http.get`是异步的——它*不会*立即执行。相反，只要 Ajax 请求从服务器返回，它就会*排队等待执行。*

3.  在当前函数完成之前，异步回调无法运行。他们不能霸占执行线程，必须耐心等待当前函数完成使用。

因此，当`print(obj);`运行时，`obj`尚未分配任何属性，因为异步回调都没有机会运行。

如果您在扩展控制台上生成的内容时*确实*看到了属性`Object`，那是因为 Chrome 懒于为控制台中打印的对象提供属性。它只会在您实际单击以展开对象时询问对象的属性（此时回调将完成）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:26:22.310

第一个只是`print`在响应返回之前被编辑`xhr`，所以对象在记录时是空的。

第二个是在填充后记录的。

# linux - 如何从我的网络服务器上现有站点的开发和实时版本创建 Git 存储库？

> ID：12395418
> 
> 赞同：1
> 
> 时间：2012-09-12T19:59:11.690
> 
> 标签：linux, git

一些信息：

*   在 CentOS 5.6 64 位上运行 Apache 2.2.3（不知道 Apache 版本是否与此处相关）
*   安装了 Git
*   这是一个 VPS，所以我拥有我需要的所有访问权限

我有一个现有网站（位于**/home/username/public_html/**）和该网站的开发版本（位于**/home/username/dev/**）都在同一台机器上。

我直接在开发版本上工作（实际上在本地工作，但使用 Sublime Text 2 的 SFTP 插件在保存时自动上传，所以出于所有意图和目的，我可以被认为是直接在 /home/username/dev 上的文件工作/)。

我想做的是使用 Git 将更改从 dev 推送到 live。目前，我必须跟踪哪些文件被编辑，然后是 FTP 或手动复制它们。如果事情不顺利，我希望能够恢复更改，诸如此类。

但是，我以前从未使用过 Git（或任何类型的版本控制）。我一直在谷歌上搜索 Git 教程，但我发现的所有内容都假设与我的实际设置有所不同。最主要的是大多数教程都假设全新的项目。我害怕通过尝试为它设置一个 repo 来搞乱我的实时网站。

无论如何，我的问题是：如何使用我现有的文件夹创建一个存储库，我可以从 /home/username/dev/ 推送到 /home/username/public_html/ （反之亦然）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T19:54:20.537

我最终遵循了[本教程](http://toroid.org/ams/git-website-howto)，它完全符合我的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:40:17.333

假设您的实时版本来自您的开发版本的某个版本，您可以将所有内容放入 git 存储库中

*   复制您的实时代码

    ```
    $ cp -axf /home/username/public_html/ git_repo 
    ```

*   将所有内容置于 git 版本控制之下

    ```
    $ cd git_repo
    $ git init
    $ git add .
    $ git commit -m 'Initial import from live version' 
    ```

*   现在从 dev 版本复制所有文件并将它们放在`dev`git的分支上

    ```
    $ rm *
    $ cp /home/username/dev/* .
    $ git checkout -b dev
    $ git add .
    $ git commit -m 'Initial import from dev version' 
    ```

之后，您的实时代码将`master`位于存储库中的分支上，而开发代码位于 branch 中`dev`。

如果你完成后总是把从开发到生活的所有东西都放在生活中，你可以在完成后将你的分支合并`dev`到你的`master`分支（保存你的实时代码）中，从而在 git 中实现这一点。

您的实时版本可能是`master`分支中该存储库的克隆，而部署只是一个

```
$ git pull 
```

那里。

# python - 在numpy中将3个数组组合成一个3D数组

> ID：12395420
> 
> 赞同：5
> 
> 时间：2012-09-12T19:59:23.140
> 
> 标签：python, arrays, 3d, numpy

关于 numpy 中的数组，我有一个非常基本的问题，但我找不到快速的方法。我有三个具有相同尺寸的二维数组 A、B、C。我想将它们转换为一个 3D 数组 (D)，其中每个元素都是一个数组

```
D[column][row] = [A[column][row] B[column][row] c[column][row]] 
```

最好的方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-12T20:05:31.573

您可以使用[numpy.dstack](http://docs.scipy.org/doc/numpy/reference/generated/numpy.dstack.html)：

```
>>> import numpy as np
>>> a = np.random.random((11, 13))
>>> b = np.random.random((11, 13))
>>> c = np.random.random((11, 13))
>>> 
>>> d = np.dstack([a,b,c])
>>> 
>>> d.shape
(11, 13, 3)
>>> 
>>> a[1,5], b[1,5], c[1,5]
(0.92522736614222956, 0.64294050918477097, 0.28230222357027068)
>>> d[1,5]
array([ 0.92522737,  0.64294051,  0.28230222]) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-13T08:28:11.617

[numpy.dstack](http://docs.scipy.org/doc/numpy/reference/generated/numpy.dstack.html)沿第三轴堆叠数组，因此，如果您堆叠 3 个 shape 数组（`a`、`b`、`c`）`(N,M)`，您最终将得到一个 shape 数组`(N,M,3)`。

另一种方法是直接使用：

```
np.array([a, b, c]) 
```

这给了你一个`(3,N,M)`数组。

两者有什么区别？内存布局。您将访问您的第一个`a`数组

```
np.dstack([a,b,c])[...,0] 
```

或者

```
np.array([a,b,c])[0] 
```

# ruby-on-rails - 如何使用 heroku 或 heroku-api gem 在自动部署中运行 rake db:migrate？

> ID：12395422
> 
> 赞同：4
> 
> 时间：2012-09-12T19:59:39.987
> 
> 标签：ruby-on-rails, ruby, deployment, heroku

我在 rake 任务中使用它：

```
client = Heroku::Client.new('', 'heroku-api-key')
client.rake 'my-app-name', 'db:migrate' 
```

我得到的只是

RestClient::UnprocessableEntity: 422 无法处理的实体。

其他命令有效，例如

```
client.ps('my-app-name') 
```

heroku client.rb 使用

```
rake(app_name, cmd) 
```

所以我不确定出了什么问题。即使使用 RESTCLIENT_LOG=stdout，我也看不到调试响应的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-14T08:30:51.007

有点太晚了，但如果你还没有弄清楚，试试这个。

`heroku run bash`接着

`rake db:migrate`就像你在本地机器上做的那样

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T18:50:57.820

如果您导出 API 密钥，您可以运行 heroku 命令行，而无需编写 API 脚本：

```
export HEROKU_API_KEY=<your key>
heroku run bundle exec rake db:migrate 
```

# ios - 限制 iOS 5 中同时 NSURLConnection 请求的数量？

> ID：12395426
> 
> 赞同：5
> 
> 时间：2012-09-12T20:00:00.907
> 
> 标签：ios, cocoa, http

仅在 iOS 5 中，当我异步发送大量请求时，我正在处理的应用程序似乎会丢弃请求。大的意义仍然很小 - 现在用 30 进行测试

每个请求都使用它自己的 NSURLConnection 并且预计会相对快速地返回（即 300 ms - 2s ）。我们还会长时间保持一个连接打开。

似乎每 5 个连接都无法离开设备。它当然永远不会到达服务器，使用 Charles 进行网络调试甚至不会显示请求已发出。

我想知道是否有人知道同时打开的 NSURLConnection 对象和活动请求的数量限制？

值得注意的是，我们在 iOS 4 中没有看到这个问题。似乎如果我们终止我们的长期连接，那么我们不会再丢弃每 5 个请求。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T20:50:13.717

`NSOperationQueue`是解决此问题的最佳方法。简而言之，您将您的包装`NSURLConnection`在一个 中`NSBlockOperation`，然后将其添加到队列中。队列允许您设置各种属性，例如同时连接的最大数量，并为您提供一种取消排队操作的简单方法。

在名为“Building Concurrent User Interfaces on iOS”的 WWDC 视频 (2012) 中有一个很好的介绍这种设计模式。

在 iOS 5 中，您可以使用以下调用来启动 an`NSURLConnection`并将其添加到`NSOperationQueue`

`+ (void)sendAsynchronousRequest:(NSURLRequest *)request queue:(NSOperationQueue *)queue completionHandler:(void (^)(NSURLResponse*, NSData*, NSError*))handler`

# linq - 如何将其重写为一个 linq 语句？

> ID：12395428
> 
> 赞同：1
> 
> 时间：2012-09-12T20:00:01.370
> 
> 标签：linq

我真的很讨厌 LINQ 语句，所以如果有人可以帮助我找到合并这两个语句的方法，我将永远感激：

```
public IList<SomeType> getSomeTypes(string id){
        string itemName = (from item in _itemcollection
                    where item.id.Equals(id)
                    select item.name).FirstOrDefault();
        return (from item in _itemcollection
                item.name == itemName
                select item)
               .ToList(); 
```

id 是一个唯一的 id，这是 _itemcollection 是一个 IQueryable。

目标是获取与 id 匹配的项目的名称（这是唯一的），然后找到具有相同名称的所有项目（其中有很多）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:23:04.783

```
public IList<SomeType> getSomeTypes(string id) {

  return (from item1 in _itemcollection
          join item2 in _itemcollection on item1.name equals item2.name
          where 
            item1.id.Equals(id)
          select item2).ToList();

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:48:19.337

我喜欢在这些情况下使用[**let**](http://msdn.microsoft.com/en-us/library/bb383976.aspx)或者只是内联

```
from item in _itemcollection
let match = _itemcollection.FirstOrDefault(x => x.id.Equals(id))
let itemName = match == null ? '' : match.name
where item.name == itemName 
select item 
```

# email - 我的表格结果没有自动通过电子邮件发送 - 为什么？

> ID：12395433
> 
> 赞同：0
> 
> 时间：2012-09-12T20:00:36.813
> 
> 标签：email, google-apps-script

首先 - 我是 Google Apps 的新手。

我创建了一个表单，我希望在提交时自动通过电子邮件发送给我。
我设置了一个触发器，如下所示：

timeDriven --> 时间驱动 --> 分钟计时器 --> 每分钟

我创建了两个表单，它收集了数据。
但不是通过电子邮件发送给我。任何想法为什么？

-耶拿

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:49:58.010

在对触发器问题进行故障排除时，将通知频率设置为“立即”会有所帮助，以确保错误一旦发生就会通过电子邮件发送给您。

# haskell - 遗漏一些严格的东西

> ID：12395435
> 
> 赞同：0
> 
> 时间：2012-09-12T20:01:00.713
> 
> 标签：haskell, strictness

我有这个代码：

```
divisors n = 1:[y|y<-[2..(n `div` 2)], n `mod` y == 0]

writeList l = do print "Start"
                 print l 
```

然后，我想用严格的参数调用函数；我试过了：

```
writeList $! (divisors 12345678) 
```

和

```
(divisors 12345678) \`seq\` (writeList (divisors 12345678)) 
```

但它并没有表现得好像它有严格的论点：即在“开始”之后我必须等待评估`(divisors 12345678)`

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:14:47.307

`seq`（或`$!`）仅针对第一个头范式进行评估，`(:)`在您的情况下是构造函数，您可以使用[deepseq](http://www.haskell.org/ghc/docs/7.4-latest/html/libraries/deepseq-1.3.0.0/Control-DeepSeq.html#v%3adeepseq)（或[$!!](http://www.haskell.org/ghc/docs/7.4-latest/html/libraries/deepseq-1.3.0.0/Control-DeepSeq.html#v%3a-36--33--33-)）来评估范式。

# mongodb - 在 mogodb 中添加索引

> ID：12395436
> 
> 赞同：0
> 
> 时间：2012-09-12T20:01:02.273
> 
> 标签：mongodb

我目前有一个非常非结构化的 mongodb 数据库。我试图在 twitter 上提取一组给定配置文件的所有关注者。我的数据库如下所示：

```
{'123':1
 '123':2
 '123':3
 '567':8
 '567':9
} 
```

其中每个键是用户，值是单个关注者。当我尝试在这些键上创建索引时，我只是用完了可用索引，因为我有很多用户（800 万）。谷歌搜索后，我发现我可以拥有的最大索引数约为 64。如何在此数据库上创建正确的索引？或者你会建议我用不同的方式来存储我的数据吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:22:58.203

您应该以不同的方式构建数据。

我建议您收集“用户”文档，其中每个用户都有一个“关注者”数组。该数组应填充关注用户的唯一标识符（如姓名、_id 或您自己的 ID 号）。

```
{ name: "userA",
  followers: [
     "userB",
     "userC"
  ] 
},
{ name: "userB",
  followers: [
     "userD",
     "userF"
 ] 
}, 
```

然后，您可以在关注者字段上创建索引，以快速找到关注其他用户的所有用户。当您想查找所有关注用户“userX”、“userY”和“userZ”的用户时，您可以使用以下查询：

```
db.users.find({followers: { $all: ["userX", "userY", "userZ" ] } }); 
```

**编辑：**

要向用户添加关注者，请使用 $push 运算符：

```
db.users.update({name:"userA"}, { $push: { followers: "userB" } } ); 
```

$pull 运算符可用于删除数组条目：

```
db.users.update({name:"userA"}, { $pull: { followers: "userB" } } ); 
```

# java - xCMIS 1.2.2 WAR 包在 Linux 上安装新的 Tomcat 7.0.28 时出现“未经授权”错误

> ID：12395440
> 
> 赞同：1
> 
> 时间：2012-09-12T20:01:15.593
> 
> 标签：java, tomcat, cmis

我有一个用于开发的 Linux Ubuntu 12.04 机器。我下载并解压缩了 Tomcat 7.0.28 并将 xCMIS 1.2.2 发行版（“服务器”之一，来自 xCMIS Google 代码页面）中的 xcmis.war 放在 webapps/ 文件夹中。我启动 Tomcat 并将浏览器指向 xCMIS Web 应用程序。我得到了 xCMIS 实例的页面，没有任何问题。然后我启动 CMIS Workbench 并指向我的 xCMIS 实例首页中标记为 REST Atom Services 的地址 (http://localhost:8080/xcmis/rest/cmisatom) 使用提供的凭据 (root / exo) 我试图连接。出现一个小的弹出窗口，上面写着“运行时：未经授权”。但是，当我尝试使用 xCMIS 页面中的 Tomcat 6 捆绑包进行相同操作时，它起作用了，我能够连接、选择存储库并创建文件夹和文档。

有什么提示吗？

在此先感谢 - 山姆

更新：我意识到 Unauthorized 错误的原因是 HTTP 授权错误，从而解决了这个问题。添加示例 xCMIS Tomcat 服务器在其 conf/tomcat-users.xml 中具有的相同用户解决了这些问题。

# mysql - MySQL 仅当结果存在于第二个表中时才合并结果

> ID：12395444
> 
> 赞同：0
> 
> 时间：2012-09-12T20:01:45.650
> 
> 标签：mysql

我有一个具有唯一 ID 的表和第二个表，这些 ID 存储了不同的值。第二个表可能有几行带有第一个表中的 ID。我想打印出表#one 的完整内容，并且只有在与表一中的ID 匹配的ID 之一存储了*（星号）字符时才包含另外一列。

第一个表

```
|id1|value1|value2|value3|value4| 
```

第二张桌子

```
|id2|value1|value2|id1|value4|
|   |      |      |   |     *| 
```

期望的输出

```
|id1|value1|value2|value3|value4|value5 with * or empty 
```

mysql 的语法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:07:51.667

```
 select *, s.value4
 from first_table f
 left outer join second_table s
   on f.id1 = s.id1
 and s.value4 = "*" 
```

# model-view-controller - 使用控制器将参数从 Sencha Touch 2 中的视图发送到其他视图

> ID：12395445
> 
> 赞同：3
> 
> 时间：2012-09-12T20:01:45.207
> 
> 标签：model-view-controller, sencha-touch-2

我只是从 Sencha Touch 1.x 迁移到 Sencha Touch 2，我找不到在视图之间传递参数的方法。

假设我必须查看： Place（包含所有地点的列表） PeopleAtPlace（每个地点的人员列表）

现在我需要做的是将按下的地点的 id 传递给 peopleatplace 视图，以便它可以获取该特定视图的人员。

我一直在阅读 Sencha 的文档，但这让我很困惑。

有人可以帮我吗？代码片段对我有很大帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T20:25:18.280

控制器可以成为不同视图之间的粘合剂。我不知道你究竟有什么样的观点，但以下代码可以作为基础：

```
Ext.define('MyApp.controller.TestController', {
    extend : 'Ext.app.Controller',

    config : {
        views : [  // you need to list all views your controller will use
            'Place', 
            'PeopleAtPlace'
        ],

        refs : {
            place : 'place',  // ComponentQuery used to find the view e.g. xtype, id, etc of the view 
            peopleAtPlace : 'peopleAtPlace'
        },

        control : {
            place : {
                select : 'onPlaceSelected' // use the appropriate event 
            }
        }
    },

    onPlaceSelected : function (view, record) {
        var peopleAtPlaceView = this.getPeopleAtPlace(); // generated by Sencha from the ref property

        // now you have the reference to the target view, you can put your logic here
        peopleAtPlaceView.doSomething(record);
    }
}); 
```

# selenium - 从书签启动 Selenium 测试？

> ID：12395446
> 
> 赞同：8
> 
> 时间：2012-09-12T20:01:56.093
> 
> 标签：selenium, bookmarks, launch

我有一些用于自动化任务的 Selenium IDE 脚本（通过其 Web 界面部署到内部服务器），并且我希望有书签来启动它们。

不想去工具 -> Selenium IDE -> 搜索测试 -> 启动测试，只想单击书签并让脚本运行。

我怎样才能做到这一点？我错过了一点吗？

不知道这是否有区别，但我目前正在使用 Firefox（如果我必须为此更改浏览器，那不会有问题）。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T15:23:56.590

不确定您是否能够在书签上运行测试，因为浏览器插件通常使用组合键运行。书签是 URL。那么您问题中的主要问题是如何将书签与浏览器插件启动相关联。

好吧，我已经研究了一些解决方法。谈到让 Selenium HTML 测试套件自动运行（我的意思是书签的替代方案），一些解决方案是可能的： **解决方案 1**：

1.  修补 Selenium 服务器代码以支持 HTML 套件。
2.  构建一个脚本来执行您的 HTML 测试套件。
3.  构建一个脚本来读取套件的输出报告并将信息整合到您的 CC.NET 报告中。

您可以[在这里获得设置详细信息](http://frazzleddad.blogspot.com/2009/02/getting-selenium-html-test-suites.html)

**解决方案2：**

*   用于 Firefox 的 Selenium IDE 插件以创建测试
*   Java 运行 Selenium 服务器
*   Selenium Server 运行测试套件
*   Nant 为 CruiseControl.NET 生成报告
*   CruiseControl.Net 作为持续集成引擎

[此处](http://www.devbridge.com/articles/integrating-selenium-ide-tests-cruisecontrol-net/)设置详细信息

希望这对你有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T12:03:29.637

书签只不过是 URL，这使得无法为插件的功能“添加书签”，例如 Selenium IDE。

但是，可能还有其他插件可以满足您的需求。我还没有仔细研究它，但一个候选者可能是[收藏夹 (Selenium IDE)](https://addons.mozilla.org/en-us/firefox/addon/favorites-selenium-ide/) Firefox 附加组件。

# objective-c - 如何在保留当前翻译的同时使用 genstrings 获取所有 NSLocalization

> ID：12395449
> 
> 赞同：2
> 
> 时间：2012-09-12T20:02:07.813
> 
> 标签：objective-c, ios, localization, nslocalizedstring

假设我的 iOS 应用程序已经有日语翻译 localizatible.strings。说“继续”=“続ける”；

但是，我在我的代码中添加了新的 NSLocalization，但我想使用 genstrings 来获取所有新的 NSLocalization，而无需手动合并它们。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T09:49:03.707

有一些工具可以管理本地化，并根据对基础语言的更改自动更新翻译（并帮助翻译人员仅对已更改的内容进行必要的更改）。

例如 www.gengo.com 有一个名为[Strings](http://ads.gengo.com/string-landing-page/)的免费在线工具（我还没有尝试过）。还有一些看起来非常不错的桌面应用程序，例如作为本地化套件一部分的本地化管理器[http://www.loc-suite.org/](http://www.loc-suite.org/)（我也没有正确尝试过）。

本地化机构也可能有自己的工具。

如果您进行大量更新并使用多种语言，这些工具是必须的，但对于较小的项目，它们可能需要太多时间来适应。对于偶尔的任务或语言很少的小项目，手动将基本语言 localizable.strings 文件的更改合并到翻译后的 localizable.strings 文件可能会更快。

# ios - 如何以编程方式在 IOS AirPrint 上打印特定页面

> ID：12395451
> 
> 赞同：2
> 
> 时间：2012-09-12T20:02:24.620
> 
> 标签：ios, printing, airprint

我有一个 iOS iPad 应用程序，它显示一个用户可以选择打印的 web 视图。虽然显示的内容只有一页，但在第一页之后打印垃圾页，这是浪费碳粉。我只想打印第 1 页，但到目前为止，我能找到的唯一解决方案是使用确实不能解决我的问题的 showsPageRange = YES 选项。

谁能建议一个简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-09T13:47:10.843

用一个按钮测试这个你在视图中包含的所有内容都是打印

```
 ///PRINT///
UIGraphicsBeginImageContextWithOptions(self.ImagentoPrint.bounds.size,    normal, 0.0);

 [self.ImagentoPrint drawViewHierarchyInRect:self.ImagentoPrint.bounds
                         afterScreenUpdates:normal];
UIImage *snapshotImage = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();
UIPrintInfo *info = [UIPrintInfo printInfo];
info.orientation = UIPrintInfoOrientationLandscape;
info.outputType = UIPrintInfoOutputPhoto;
UIPrintInteractionController *pic =
[UIPrintInteractionController sharedPrintController];
pic.delegate = self;
pic.printingItem = snapshotImage;
pic.printInfo = info;

UIPrintInteractionCompletionHandler completionHandler =
^(UIPrintInteractionController *pic, BOOL completed, NSError *error)
{
    if (error)
        NSLog(@"failed... %@ %ld", error.domain, (long)error.code);
    if (completed)
        NSLog(@"completed yes");
    else
        NSLog(@"completed no");
};

[pic presentFromRect:CGRectMake(600, 650, 100, 200) inView:_ImagentoPrint animated:YES completionHandler:completionHandler]; 
```

# java - 在 Wicket 中为下载链接设置超时？

> ID：12395452
> 
> 赞同：2
> 
> 时间：2012-09-12T20:02:26.553
> 
> 标签：java, wicket

我刚开始使用 Wicket（对很多 Web 开发真的不太熟悉）并且对下载链接有疑问。我有一个网络应用程序，它只允许用户上传特定文件，处理文件中的一些信息，并提供不同格式的已处理信息的下载。然而，这真的应该是我正在开发的一些软件的精简版，所以我真的不想做太多的处理。我想知道是否有一种方法可以设置下载链接的超时时间，这样如果用户单击链接并且处理时间超过 20 秒左右，它将简单地退出处理并向他们发送错误反而。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T09:38:54.147

我同意 Xavi 的处理（以及可能的处理终止）应该用线程来完成。

但是，特别是如果它花费的时间超过几秒钟，最好不要只等待打开的连接，而是定期检查线程是否完成。

我会做这样的事情：

1.  启动线程做实际工作
2.  显示`Panel`“正在处理您的下载”或类似的内容。
3.  `AbstractAjaxTimerBehavior`以 10 秒左右的计时器持续时间将一个附加到面板上。
4.  在计时器行为的`onTimer`方法中，检查处理的状态：
    *   如果它仍然有效，则什么也不做。
    *   如果因为时间过长而取消，请向用户显示“已取消”之类的消息，例如通过更换面板或将警告标签设置为可见。
    *   如果完成，请显示“您的下载正在开始”之类的消息并开始下载。请参阅[此文档](https://cwiki.apache.org/confluence/display/WICKET/AJAX+update+and+file+download+in+one+blow)了解如何进行 AJAX 响应并同时启动下载

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T22:31:50.240

为了能够在处理时间超过给定时间量时取消处理，最好在单独的线程中执行它。此问题在以下问题中得到解决：[如何使线程超时](https://stackoverflow.com/q/2275443/851811)。

现在对于它的 Wicket 部分：如果我理解您要实现的目标，您可以例如滚动您自己的`Link`来执行处理，并以结果响应以防它不超时。如果处理时间过长，您可以简单地抛出一个错误（记住要有一个`FeedbackPanel`以便显示）。

要下载的文件的处理或生成可以以`LoadableDetachableModel`提高效率来实现。有关更多详细信息，请参阅此问题：[如何将 Wicket 的 DownloadLink 与动态生成的文件一起使用？](https://stackoverflow.com/q/7646270/851811)

例如：

```
IModel<File> processedFileModel = new LoadableDetachableModel<File>(){
    protected File load(){
        // Implement processing in a separate thread. 
        // If it times out it could return null, for instance
    }

}

Link<File> downloadLink = new Link<File>("yourID", processedFileModel) {
        @Override
        public void onClick() {
            File processedFile = getModelObject();
            if (file != null) {
                IResourceStream rs = new FileResourceStream(file);
                getRequestCycle().setRequestTarget(new ResourceStreamRequestTarget(rs));
            } else {
                error("Processing took too long");
            }
        }
    }; 
```

# javascript - 使用remoteSort 在某种商店上触发什么方法？

> ID：12395461
> 
> 赞同：2
> 
> 时间：2012-09-12T20:03:07.110
> 
> 标签：javascript, extjs, extjs4

我有点继承了一个烂摊子，只有很短的时间来修复它。我的问题是我正在尝试修复我们使用无限滚动的商店/网格的错误。当用户尝试对网格进行排序时，会出现“加载”消息，就是这样。

我已经在服务器端设置了断点，它可以很好地回调服务器并传递正确的列，但它永远不会关闭“加载”消息。

我正在寻找在触发排序之前和之后我应该在客户端观察什么事件。我在 load、beforesync 和商店中的所有其他内容（http://docs.sencha.com/ext-js/4-0/#!/api/Ext.data.Store）中可能有 console.log 语句我需要在网格上听什么吗？

这是来自预取覆盖和 console.logs 的日志...

```
grid store event: ["beforeload", i, Object]
pageSize = 100
grid store event: ["beforeprefetch", i,i]
before prefetch done 
proxy.read done 
end of prefetch 
grid panel event: ["sortchange", i, i, "DESC"]
grid panel event: ["beforestatesave", i, Object]
grid store event: ["totalcountchange", 2] BufferedStore.js:22
grid store event: ["prefetch", i, Array[2], true,i] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T22:03:08.027

'sortchange' 事件应该在网格上触发。'beforeload' 事件应该在调用服务以获取新数据之前触发。一旦数据从服务调用返回，'load' 事件应该触发。

为了更深入地调试，在创建网格并引用它之后，例如“rolocGrid”，您可以使用 Observable 实用程序来监视网格上的所有事件及其存储。

此代码段将为每个事件写入控制台，让您深入了解过程中发生的情况：

```
 Ext.util.Observable.capture(rolocGrid.store, function () { console.log('grid store event:', arguments)}, rolocGrid);                                           
 Ext.util.Observable.capture(rolocGrid, function () { console.log('grid event:', arguments)}, rolocGrid); 
```

# scala - 使用带有 play 和 scala 的 Google Ads API，如何正确添加依赖项？

> ID：12395463
> 
> 赞同：1
> 
> 时间：2012-09-12T20:03:14.990
> 
> 标签：scala, dependencies, playframework-2.0, sbt

我正在尝试将谷歌广告 api 的必要依赖项添加到用 scala 编写的播放应用程序中。我的问题是所有示例都是针对 java 的，我无法让它为 scala 工作。

我一直在看这个设置指南：

[https://code.google.com/p/google-api-ads-java/](https://code.google.com/p/google-api-ads-java/)

我从这个站点获取了 sbt 的依赖项：

[http://mvnrepository.com/artifact/com.google.api-ads](http://mvnrepository.com/artifact/com.google.api-ads)

构建.scala：

```
val appDependencies = Seq(
    //won't work, sbt can't resolve the RELEASE version
    "com.google.api-ads" % "ads-lib" % "RELEASE"
)

val appDependencies = Seq(
    //won't work either, see error below
    "com.google.api-ads" % "ads-lib" % "1.8.0"
)

[warn]  module not found: com.google.api-client#google-api-client;RELEASE              
[warn] ==== local: tried
[warn]   /home/rawphl/Coding/play-2.0.3/framework/../repository/local/com.google.api-     client/google-api-client/RELEASE/ivys/ivy.xml
[warn] ==== Typesafe Releases Repository: tried
[warn]   http://repo.typesafe.com/typesafe/releases/com/google/api-client/google-api-client/RELEASE/google-api-client-RELEASE.pom
[warn] ==== Typesafe Snapshots Repository: tried
[warn]   http://repo.typesafe.com/typesafe/snapshots/com/google/api-client/google-api-client/RELEASE/google-api-client-RELEASE.pom
[warn] ==== public: tried
[warn]   http://repo1.maven.org/maven2/com/google/api-client/google-api-client/RELEASE/google-api-client-RELEASE.pom
[warn]  module not found: com.google.oauth-client#google-oauth-client;RELEASE
[warn] ==== local: tried
[warn]   /home/rawphl/Coding/play-2.0.3/framework/../repository/local/com.google.oauth-client/google-oauth-client/RELEASE/ivys/ivy.xml
[warn] ==== Typesafe Releases Repository: tried
[warn]   http://repo.typesafe.com/typesafe/releases/com/google/oauth-client/google-oauth-client/RELEASE/google-oauth-client-RELEASE.pom
[warn] ==== Typesafe Snapshots Repository: tried
[warn]   http://repo.typesafe.com/typesafe/snapshots/com/google/oauth-client/google-oauth-client/RELEASE/google-oauth-client-RELEASE.pom
[warn] ==== public: tried
[warn]   http://repo1.maven.org/maven2/com/google/oauth-client/google-oauth-client/RELEASE/google-oauth-client-RELEASE.pom
[warn]  ::::::::::::::::::::::::::::::::::::::::::::::                       
[warn]  ::          UNRESOLVED DEPENDENCIES         ::
[warn]  ::::::::::::::::::::::::::::::::::::::::::::::
[warn]  :: com.google.api-client#google-api-client;RELEASE: not found
[warn]  :: com.google.oauth-client#google-oauth-client;RELEASE: not found
[warn]  :::::::::::::::::::::::::::::::::::::::::::::: 
```

我不确定现在如何进行。我想我只是缺少一些依赖项，但我不太清楚添加 google api 的首选方式是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T17:21:34.020

使用 1.9.0 就可以了。更一般地说，检查依赖关系，检查版本，随机化值并祈祷。

# sql - SQL2008全文索引搜索没有分词器

> ID：12395465
> 
> 赞同：3
> 
> 时间：2012-09-12T20:03:25.757
> 
> 标签：sql, sql-server, full-text-search, sql-server-2008-r2, wordbreaker

我正在尝试使用`CONTAINS`Twitter 风格的用户名搜索 FTI，例如 @username，但分词器将忽略 @ 符号。有什么方法可以禁用分词器吗？根据研究，有一种方法可以创建自定义分词器 DLL 并安装它并分配它，但这一切似乎有点密集，坦率地说，在我头上。我禁用了停用词，以便不会忽略破折号，但我需要那个 @ 符号。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T06:48:42.353

你不会喜欢这个答案的。但是全文索引在索引时只考虑字符**_**和**`**。所有其他字符都被忽略，单词在这些字符出现的地方被分割。这主要是因为全文索引旨在索引大型文档，并且只考虑适当的单词以使其成为更精细的搜索。

我们遇到了类似的问题。为了解决这个问题，我们实际上有一个翻译表，其中*@、-、/*等字符被替换为特殊序列，如 ' **`at`** '、' **`dash`** '、' **`slash`** ' 等。在全文搜索时，您必须再次用这些特殊序列替换搜索字符串中的字符并进行搜索。这应该照顾特殊字符。

# postgresql - PostgreSQL 删除约束未知名称

> ID：12395466
> 
> 赞同：8
> 
> 时间：2012-09-12T20:03:31.227
> 
> 标签：postgresql, plpgsql, dynamic-sql, psql

我有一个 SQL 脚本，它需要删除几个约束并在最后恢复它们，但是约束名称是自动生成的，并且每次运行脚本时都会有所不同。

我知道如何从表名中获取约束名称，但似乎无法在 drop 语句中使用此信息。

```
select conname from pg_constraint where
   conrelid = (select oid from pg_class where relname='table name')
   and confrelid = (select oid from pg_class where relname='reference table'); 
```

`alter table something drop constraint (some subquery)`是语法错误。

理想情况下，我想获取约束名称并将其存储在变量中，但 Postgres 似乎不支持它，我无法使其与 psql 一起使用`\set`。

这甚至可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T21:55:20.930

要动态删除和重新创建外键约束，您可以将其全部包装在一个函数中或使用以下[`DO`](http://www.postgresql.org/docs/current/interactive/sql-do.html)命令：

```
DO
$body$
DECLARE
   _con text := (
      SELECT quote_ident(conname)
      FROM   pg_constraint
      WHERE  conrelid = 'myschema.mytable'::regclass
      AND    confrelid = 'myschema.myreftable'::regclass
      LIMIT 1 -- there could be multiple fk constraints. Deal with it ...
      );

BEGIN
   EXECUTE '
      ALTER TABLE wuchtel12.bet DROP CONSTRAINT ' || _con;

   -- do stuff here

   EXECUTE '
      ALTER TABLE myschema.mytable
      ADD CONSTRAINT ' || _con || ' FOREIGN KEY (col)
      REFERENCES myschema.myreftable (col)';
END
$body$ 
```

您必须拥有该表才能使用`ALTER TABLE`。
否则，您可以[使用](http://www.postgresql.org/docs/current/interactive/sql-createfunction.html)（使用`LANGUAGE plpgsql SECURITY DEFINER`相同的主体）和

```
ALTER FUNCTION foo() OWNER TO postgres; 
```

`postgres`作为这里的超级用户 - 或表的所有者。
但请务必了解[手册中有关安全性的内容](http://www.postgresql.org/docs/current/interactive/sql-createfunction.html#SQL-CREATEFUNCTION-SECURITY)。

[该手册还有更多关于动态命令的内容。](http://www.postgresql.org/docs/current/interactive/plpgsql-statements.html#PLPGSQL-STATEMENTS-EXECUTING-DYN)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-14T10:21:07.653

您也可以使用存储过程。

```
CREATE OR REPLACE PROCEDURE public.p_costraint()
 LANGUAGE plpgsql
AS $procedure$
DECLARE _constrint text;
begin
-- for dynamic change the constraint. 
    _constrint := (
      SELECT quote_ident(conname)
      FROM   pg_constraint
        WHERE  conrelid = 'test.contacts'::regclass
        AND    confrelid = 'test.customers'::regclass
      LIMIT 1 -- there could be multiple fk constraints. Deal with it ...
      );
    _constrint := _constrint || 'test';
    EXECUTE '
      ALTER TABLE test.contacts
      ADD CONSTRAINT ' || _constrint || ' FOREIGN KEY (customer_id)
      REFERENCES test.customers (customer_id)';
    RAISE NOTICE 'hello, world!';
end
$procedure$; 
```

在这里。约束名称用作文本变量。
您可以直接调用它：`call public.p_costraint();`
它将返回：

```
NOTICE:  hello, world!
CALL 
```

# ruby - 不要在 irb 中加载 readline 模块

> ID：12395469
> 
> 赞同：0
> 
> 时间：2012-09-12T20:03:40.073
> 
> 标签：ruby, irb, libreadline

`readline`我的 OSX 上的扩展似乎有问题。

```
$irb -f --noreadline
irb(main):001:0> "中文"
=> "中文"

$irb -f --readline
irb(main):001:0> \U+FFE4\U+FFB8\U+FFAD\U+FFE6 
```

所以我想设置`--noreadline`为irb的默认选项。怎么做？

ps 我正在使用`RVM`和`Ruby`1.9.3p194。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:50:11.437

将以下内容添加到您的`~/.irbrc`文件中（如果不存在则创建它）：

```
IRB.conf[:USE_READLINE] = false 
```

`/etc/irbrc`或者，如果您希望它跨用户帐户应用，或者`foo/.irbrc`如果您希望它基于目录/项目应用，您可以添加它。

这是[其他有用的配置选项的列表](http://www.rubycentral.org/pickaxe/irb.html)。

# php - 通过 Javascript / PHP 查询数据库

> ID：12395471
> 
> 赞同：0
> 
> 时间：2012-09-12T20:03:50.730
> 
> 标签：php, javascript, jquery, ajax, database

我在尝试将 PHP 脚本的结果返回到我的 HTML / Jquery 应用程序时遇到问题。

目前，我正在尝试像这样连接到服务器：

```
function getDatabaseRows()
{           
    var xmlHttp = new XMLHttpRequest();

    xmlHttp.onreadystatechange = function()
    {
        if(xmlHttp.readyState == 4)
        {
          HandleResponse(xmlHttp.responseText);
        }
    }

    xmlHttp.open("POST", "myDomain.com/subDirectory/getRowCounts.php", true);
    xmlHttp.send(null);
} 
```

我的响应处理程序是：

```
function HandleResponse(response)
{   
    alert(response.length);

    if(response.length != 0)
        maxArray = JSON.parse(response);

    storage.set('currentID', maxArray);
} 
```

目前，每当我运行代码时，`getDatabaseRows()`总是最终调用`HandleResponse(response)`. 问题是`response.length`总是等于`0`。

PHP 脚本只是从数据库中收集最大行数并返回行数：

```
<?php

   $rowCounts = [];

   $dbhost = 'host';
   $dbuser = 'host';
   $dbpass = 'host';

   $con = mysql_connect($dbhost, $dbuser, $dbpass) or die('Error connecting to mysql');
   mysql_select_db("host") or die(mysql_error());

   $sql = "SELECT MAX(TID) AS MaxTID FROM TransData";
   $results = mysql_query($sql, $con);
   $transRow = mysql_fetch_array($results);
   $maxTrans = $transRow['MaxTID'];

   $sql = "SELECT MAX(FID) AS MaxFID FROM FullData";
   $results = mysql_query($sql, $con);
   $fullRow = mysql_fetch_array($results);
   $maxFull = $fullRow['MaxFID'];

   $sql = "SELECT MAX(SID) AS MaxSID FROM SalamanderData";
   $results = mysql_query($sql, $con);
   $salamanderRow = mysql_fetch_array($results);
   $maxSal = $salamanderRow['MaxSID'];

   $sql = "SELECT MAX(OID) AS MaxOID FROM OthersData";
   $results = mysql_query($sql, $con);
   $othersRow = mysql_fetch_array($results);
   $maxOther = $othersRow['MaxOID'];

   array_push($rowCounts, $maxTrans, $maxFull, $maxSal, $maxOther);

   echo json_encode($rowCounts);

   mysql_close($con);
?> 
```

当我将浏览器直接指向脚本时，它会回显我的行数正确。我只是在尝试通过 AJAX 获取数据时遇到了麻烦。

编辑：

好的，我终于连接了脚本，它与跨域脚本问题有关。现在都整理好了。

不过新问题：

```
function HandleResponse(response)
{   

    if(response.length != 0)
        maxArray = JSON.parse(response);

    storage.set('currentID', maxArray);
} 
```

HandleResponse 在解析 JSON 时会抛出错误`Error trying to parse '<'`，所以我认为它与 Array 的编码方式有关。我该如何解决这个问题并弄清楚如何解析该数组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:06:37.773

我会检查以下连接方法。

[http://api.jquery.com/jQuery.get/](http://api.jquery.com/jQuery.get/)

这将解决您的所有问题并清理您的代码

这是我的旧代码之一的示例

```
 $.ajax({
        data: "id=" + value,
        type: "POST",
        url: "unlock.php",
        success: function (data) {
            if (data == 1 || data == true) {
                var result = true;
            } else {
                var result = false;
            }
        }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T21:22:01.897

这是我能理解的最简单的 jQuery JavaScript（它使用 GET 方法）：

```
function getDatabaseRows()
{           
  $.getJSON('myDomain.com/subDirectory/getRowCounts.php', function(data) {
    console.log(data);
  });
} 
```

[http://api.jquery.com/jQuery.getJSON/](http://api.jquery.com/jQuery.getJSON/)上的文档

`foreach {}`并且使用and对您的 PHP 进行了一些增强`mysql_result()`，尽管您可能希望查看 PHP 的`mysqli`类以获得更面向未来的解决方案。

```
$rowCounts = array();

$dbhost = 'host';
$dbuser = 'host';
$dbpass = 'host';
$dbase  = 'host';

$fields = array(
    'MaxTID' => array('tab' => 'TransData',      'col' => 'TID'),
    'MaxSID' => array('tab' => 'FullData',       'col' => 'SID'),
    'MaxFID' => array('tab' => 'SalamanderData', 'col' => 'FID'),
    'MaxOID' => array('tab' => 'OthersData',     'col' => 'OID')
  );

$con = mysql_connect($dbhost, $dbuser, $dbpass) or die('Error connecting to mysql');
mysql_select_db($dbase, $con) or die(mysql_error());

foreach ($fields as $id => $info) {
  $sql = "SELECT MAX({$info['col']}) FROM {$info['tab']}";
  $result = mysql_query($sql, $con);
  if (!$result) die('Could not query:' . mysql_error());
  $rowCounts[$id] = mysql_result($result, 0);
}

echo json_encode($rowCounts);

mysql_close($con); 
```

此代码适用于 GoDaddy 托管网站。作为记录，这是我的第一个 Stack Overflow 答案。请指教 ：）

# python - 在 django 中处理排名的最佳方法是什么？

> ID：12395472
> 
> 赞同：3
> 
> 时间：2012-09-12T20:03:54.753
> 
> 标签：python, django, ranking

我正在构建具有排名功能的网络服务。

我没有强大的服务器：整个服务将托管在标准 PC 中。可能有一段时间，当许多用户（在这种情况下很多 = ~100）正在刷新排名时，所以我会这样做，用户不会因此而崩溃服务器。

不实时刷新没有问题：可以显示前一段时间生成的用户排名。

生成排名对我来说没有问题。我可以很容易地做到这一点：

```
User.objects.filter(...).order_by('rank') 
```

编辑：更多细节：我有一些工人在做一些计算。当 worker 结束其工作时，它会更改某些 User 实例的 rank 字段。您可以假设，所有用户都会执行导致数（5-20​​）次计算的操作，每一次都会导致该用户的排名发生变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:26:06.187

如果更新排名的任务太长而无法按请求执行，那么您可以使用以下一些解决方案：

*   在更新排名的事情发生后，创建一个异步任务来更新排名但不阻止请求。你可以用[芹菜](http://celeryproject.org/)或[齿轮人](http://gearman.org/)
*   使用[celery 定期任务](http://docs.celeryproject.org/en/latest/userguide/periodic-tasks.html)或[cron 作业定期更新排名](http://en.wikipedia.org/wiki/Cron)

解决方案 1 在性能方面更好，但更难正确。解决方案 2 更容易做到，但可能不太理想。

# assembly - 在 DDD 中解释 eFlags

> ID：12395477
> 
> 赞同：2
> 
> 时间：2012-09-12T20:04:51.043
> 
> 标签：assembly, x86, ddd-debugger

我正在尝试学习如何编写和理解`x86 Assembly`以及如何`GDB`有效地使用和相关工具。为此，我将`DDD`其用作`GDB`.

我无法理解条件标志（eflags？）的含义，因为它们似乎都存储在同一个寄存器中。我将发布寄存器、汇编代码和相关的 C 代码。感谢您提供任何帮助。

寄存器在给定断点处显示如下：`0x293 [CF AF SF IF]`

以下是正在运行的 C 代码。（这不是我编码风格的示例。我试图强制 GCC 使用该`compl`操作。）

```
int main( int argc, char* argv[] )
{
  int a = 0;
  int b = 2;
  if( a == b ) // There is a breakpoint here!
    goto EQUAL;
  else
    goto NEQUAL;

  EQUAL:
    return 3;

  NEQUAL:
    return 1;
} 
```

以下是我的机器将其分解成的组件：

```
Dump of assembler code for function main:
0x0000000000400474 <+0>:     push   %rbp
0x0000000000400475 <+1>:     mov    %rsp,%rbp
0x0000000000400478 <+4>:     mov    %edi,-0x14(%rbp)
0x000000000040047b <+7>:     mov    %rsi,-0x20(%rbp)
0x000000000040047f <+11>:    movl   $0x0,-0x8(%rbp)
0x0000000000400486 <+18>:    movl   $0x2,-0x4(%rbp)
0x000000000040048d <+25>:    mov    -0x8(%rbp),%eax
0x0000000000400490 <+28>:    cmp    -0x4(%rbp),%eax
0x0000000000400493 <+31>:    jne    0x40049d <main+41> # Break point here
0x0000000000400495 <+33>:    nop
0x0000000000400496 <+34>:    mov    $0x3,%eax
0x000000000040049b <+39>:    jmp    0x4004a3 <main+47>
0x000000000040049d <+41>:    nop
0x000000000040049e <+42>:    mov    $0x1,%eax
0x00000000004004a3 <+47>:    leaveq 
0x00000000004004a4 <+48>:    retq   
End of assembler dump. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:40:43.633

eflags 寄存器由单个位组成，每个位都是一个标志。

显示标志时，它们可以组合成一个更大的数字实体（例如您的示例中的 0x293），或者每个都可以有自己的符号（例如在带有进位标志 CF 的“[CF AF SF IF]”中，调整标志AF、符号标志SF和中断标志IF。

英特尔[64 和 IA 32 架构软件开发人员手册卷。1](http://download.intel.com/products/processor/manual/253665.pdf)在第 3.4.3 章中详细描述了这些标志。

最重要的（对于应用程序开发人员）是：

```
位 | 符号 | 姓名
------------------
  0 | CF | 携带
  1 | -- | （总是 1）
  2 | PF | 平价
  3 | -- | （总是 0）
  4 | 自动对焦 | 调整
  5 | -- | （总是 0）
  6 | 采埃孚 | 零
  7 | 顺丰 | 符号
  8 | TF | 陷阱
  9 | 中频 | 打断
 10 | 东风 | 方向
 11 | 的 | 溢出

```

结合你的例子中的那些（CF AF SF IF）给出二进制值1010010011，其中最右边的数字是进位标志，最左边的数字是中断标志。转换为十六进制它正好给出 0x293。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T20:53:22.513

该`(R/E)FLAGS`寄存器包含以下条件标志：

**OF**（溢出标志） - 它用于确定有符号操作数上整数算术运算（例如，、、、`ADD`指令）`ADC`的`SUB`溢出。`SBB`条件分支/跳转（`Jcc`指令）可以直接检查这个标志。

**SF**（符号标志） - 用于确定最后一个整数算术运算的结果是否为负值，**SF**基本上是结果的符号位（=最高有效位）的副本。同样，条件分支/跳转可以直接检查它。

**ZF**（零标志） - 用于确定最后一个整数算术或逻辑运算的结果是否为 0。条件分支/跳转也可以直接检查它。

**CF （进位标志） - 与溢出标志 (** **OF** )类似，它可用于确定对无符号操作数执行的整数算术运算的溢出。注意区别：**CF**代表无符号，**OF**代表有符号。另请注意，CPU 通常会计算 **CF**和**OF**，程序员有责任检查正确的标志。在大多数情况下，CPU 不能也不会区分有符号和无符号操作数，因为结果是以相同的方式计算的，而且它都是 CPU 的数据。将值解释为有符号或无符号是程序员的职责，而不是 CPU 的职责。条件分支/跳转也可以直接检查**CF。**

**编辑**：还有使用**CF**`rotate through carry`的指令（`RCL`和`RCR`）。

 **整数比较（与`CMP`指令）导致上述四个标志集。如果您打算比较无符号整数，请检查**ZF**和/或**CF**。对于有符号整数比较，您需要检查**ZF**和/或**SF** + **OF**对。请参阅条件分支/跳转指令（`Jcc`: `JB`, `JNC`, `JE`, `JNGE`, 等）。

奇偶校验标志**PF**和辅助进位标志**AF**是其他条件标志，但它们很少使用。

中的其余位`(R/E)FLAGS`要么是系统标志，要么是控制标志。其中你可能只想知道两个：

**DF**（方向标志）——用于设置字符串指令的方向。字符串指令用于顺序访问内存，例如块内存复制、块内存比较、块内存搜索、块内存填充（参见`MOVSB/W/D/Q`, `CMPSB/W/D/Q`, `SCASB/W/D/Q`, `STOSB/W/D/Q`, `LODSB/W/D/Q`）。这个标志的值告诉内存操作数地址是在每次迭代后递增还是递减。

**IF**（中断标志） - 它用于启用或禁用硬件中断处理。如果您进入非常低级的编程（驱动程序、操作系统内核等），您将不得不使用此标志。

就是这样。英特尔和 AMD 的官方 CPU 文档中提供了所有详细信息。去，下载CPU手册。

**编辑**：您可能会发现这些问题/答案很有用：[1](https://stackoverflow.com/q/8034566/968261)、[2](https://stackoverflow.com/q/8053053/968261)。

同样有用的是：

*   并非所有指令都会修改条件标志
*   有些人总是修改它们并设置为 0 或 1
*   有些将它们设置为未指定的值，您不能依赖或期望 0 或 1**

# sql - 记录了 Oracle BEA Workshop sql 语句

> ID：12395478
> 
> 赞同：0
> 
> 时间：2012-09-12T20:04:51.550
> 
> 标签：sql, oracle, weblogic-10.x

我们正在使用 Oracle 的 BEA Workshop 10 工具。当我们运行我们的应用程序时，我们所有的 sql 语句都会被记录下来。我需要关闭它。有什么建议么？我查看了我们的配置文件，没有看到任何说 SQL=TRACE 的内容。

谢谢您的帮助。

# php - 在头部顶部添加带有块的 jQuery

> ID：12395479
> 
> 赞同：0
> 
> 时间：2012-09-12T20:04:55.013
> 
> 标签：php, javascript, jquery, html, magento

我在 magento 中有一个扩展，它在标题中添加了一个用于加载 jQuery 的块：

```
<reference name="head">            
     <block type="page/html" 
            template="csdev/embedjquery/embed_jquery.phtml" 
            output="toHtml" 
            name="csdev_embedjquery" />
</reference> 
```

块的内容如下：

```
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js" />

<script type="text/javascript">    
    $.noConflict();
    alert(jQuery);
</script> 
```

问题是在原型之后添加 jQuery 为时已晚。它需要在原型之前添加，所以我可以执行该`noConflict()`功能。

另外，由于我不想覆盖 magento 头模板或 magento 头块，所以我添加了以下内容：

```
output="toHtml" 
```

但这为时已晚:(...

有没有解决方案，例如`"add this block on top of the reference (head) with output='toHtml'"`？

我试过了：

```
before="-" 
```

但它似乎不起作用，因为我写道：

```
output="toHtml" 
```

我的 Magento 版本是 1.7。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:12:51.650

您的问题是您将其添加为 phtml 文件，而不是 JS 文件。尝试将其添加到 page.xml 中，默认 -> root -> head（大约第 37 到 61 行）：

```
<action method="addJs"><script>jquery/jquery.js</script></action> 
```

然后在 /js 中创建一个名为 jquery 的文件夹，并将 jquery.js 上传到该文件中。在 jquery.js 文件的末尾，附加 noConflict 方法调用。那应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T20:34:42.783

`/app/design/frontend/default/yourtheme/layout/local.xml`您可以通过在文件中使用以下代码段来实现此目的。如果我们使用这个布局覆盖，我们不需要编辑任何核心文件。

```
<layout version="0.1.0">
    <default>
        <reference name="root">
            <block type="core/text" name="external.cdn.jquery" before="-">
                <action method="setText">
                    <text><![CDATA[<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script><script type="text/javascript">jQuery.noConflict();</script>]]></text>
                </action>
            </block>        
        </reference>
    </default>
</layout> 
```

如您所见，我们正在从外部 CDN 加载 jQuery。这将加载到所有页面上。但是，如果您想将其限制为任何特定页面，请使用页面句柄而不是`<default>`标签 - 例如：对于 home page `<cms_index_index>`。

# c# - 将字符串 [] 对象从客户端传递给服务 wcf

> ID：12395480
> 
> 赞同：0
> 
> 时间：2012-09-12T20:04:56.253
> 
> 标签：c#, wcf, windows-phone-7.1

**IService1.cs**

```
 [OperationContract]
    string SendMessage(string[] contact, string message,CookieContainer con); 
```

**服务1.svc.cs**

```
 string SendMessage(string[] contact, string message,CookieContainer con);
  {
   .... ..... 
   .... 
   ... code
  } 
```

客户端

```
string[] contact;
svc.SendMessageCompleted += new EventHandler<SendMessageCompletedEventArgs>(svc_Send_Sms);
svc.SendMessageAsync(contact, txtsms.Text,con); 
```

这给出了错误

> 'SmsApplication.ServiceReference1.Service1Client.SendMessageAsync(System.Collections.ObjectModel.ObservableCollection, string, System.Net.CookieContainer)' 的最佳重载方法匹配有一些无效参数
> 
> 参数 1：无法从 'string[]' 转换为 'System.Collections.ObjectModel.ObservableCollection'

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:15:18.990

我相信这个解决方案应该有效。右键单击服务引用 选择配置服务引用选项 在 Data Type 部分下，将 Collection 类型从 Array 更改为下拉菜单中所需的类型。

# regex - Unix CLI 脚本使用其预先存在的名称重命名文件夹

> ID：12395481
> 
> 赞同：0
> 
> 时间：2012-09-12T20:05:00.773
> 
> 标签：regex, bash, unix, rename

我有一个文件夹结构如下的目录：

```
-- DATA -- ABD 1231345 -- 01-08-12 // date in mm-dd-yy format
                       -- 03-09-12
                       -- 06-11-12

        -- DEF 4859480 -- 02-10-12
                       -- 05-10-12
                       -- 07-10-12 
```

我想批量重命名这个`DATA`文件夹如下

```
-- DATA -- ABD 1231345 -- 2012_01_08 // date in yyyy_mm_dd format with underscore
                       -- 2012_03_09
                       -- 2012_06_11

        -- DEF 4859480 -- 2012_02_10
                       -- 2012_05_10
                       -- 2012_07_10 
```

你对如何在 Mac OSX / unix 上使用命令行有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:11:55.063

您可以使用`for`循环和`awk`，将每个文件名解析为您指定的格式，然后`mv`将原始文件名重命名为新名称：

```
for dir in DATA/*; do \
    pushd "$dir"; # change directory \
    for file in *; do \
        path=`echo $file | awk -F- '{print "20"$3"_"$1"_"$2}'`; \
        mv $file $path; # "rename" the file \
    done; \
    popd; # restore original directory \
done; 
```

这可以在上面的文件夹中执行`DATA`。如果您想直接在 中执行它`DATA`，请将第一个循环更新为 read`for dir in *; do`而不是`DATA/*`. 它告诉`awk`使用`-`作为分隔符（而不是空格），然后将字符串从“mm-dd-yy”重构为“20yy_mm_dd”。

使用[`pushd`](http://ss64.com/bash/pushd.html)and[`popd`](http://ss64.com/bash/popd.html)将使脚本能够将当前目录更改为`DATA`( `pushd`) 内的每个子目录，然后，在移动所有必要的文件后，将更改回原始目录 ( `popd`)。这样做将为您节省大量尝试保存目录路径 / 等的解析工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:20:28.580

使用`date`命令转换文件名：

```
$ date -j -f %m-%d-%y 01-08-12 +%Y_%m_%d
2012_01_08 
```

获取文件有点小技巧。我们将只切换目录以避免处理长文件路径。

```
for d in DATA; do
    pushd "$d"
    for f in *; do
        new_f=$(date -j -f %m-%d-%y $f +%Y_%m_%d)
        mv "$f" "$new_f"
    done
    popd
done 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T20:15:35.090

您可以使用[字符串操作](http://tldp.org/LDP/abs/html/string-manipulation.html)和[数组](http://tldp.org/LDP/abs/html/arrays.html)来仅使用 bash 来执行此操作。

就像是：

```
for f in * ; do
  parts=(${f//-/ })
  mv "$f" "20${parts[2]}_${parts[1]}_${parts[0]}"
done 
```

在此站点中搜索各种选项以递归到目录中，例如： [Shell 脚本遍历目录](https://stackoverflow.com/questions/10610955/shell-script-to-traverse-directories)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T20:15:07.213

[这个网站](http://snipplr.com/view/2736/)提供了一个很好的片段

```
for i in *.avi; do j=`echo $i | sed 's/(\d{2})-(\d{2})-(\d{2})/20\3_\1_\2/g'`; mv "$i" "$j"; done 
```

# c++ - 如何删除图像中的小平行线？

> ID：12395486
> 
> 赞同：3
> 
> 时间：2012-09-12T20:05:22.500
> 
> 标签：c++, image-processing, opencv, graphics, computer-vision

二值化后我有黑白图像。之后，我有如下图像：

![http://ifotos.pl/zobacz/ipng_xhnxhrh.png/](../Images/242059382835db55bfc9ca8d93d4eb1f.png)

如何使用 OpenCV 删除与长曲线平行的小线？我可以通过移除所有小物体来移除它们，但我只想移除小的平行线。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:47:02.893

对我来说，这看起来像是一个 Canny 人工制品（或某种振铃人工制品）。有几种方法可以删除它们。

一种经验丰富但计算量不大的方法是定位所有小特征，并将它们与移动了 [+/-]X、[+/-]Y 的相同图像叠加。如果特征与移位图像完全重合，即白色特征中的所有像素在移位图像中也是白色的，那么您*可能*正在查看伪影。

要评估特征的“小”，您可以使用基本的填充。这种方法很便宜，因为您可以使用指针模拟移位，而无需真正分配四个移位的图像。只要你真的有小的平行线，它就容易出现误报，如果伪影非常大，则容易出现误报。

另一种方法是用不同的阈值对原始图像进行两次后处理。虽然“真实”线条会保持在一起，但振铃伪影将具有不同的强度。此时，您评估图像差异，并考虑“伪影”所有距离图像轨道比给定阈值*更远的特征。*这需要更多的计算密集度，产生更好的结果，但取决于您对原始图像的了解，即您的工作流程是什么。

重新评估工作流程（更改边缘检测阶段）可能会完全避免创建工件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-13T13:33:46.290

使用[cvBlobslib 库](http://opencv.willowgarage.com/wiki/cvBlobsLib)将白色补丁检测为 blob...cvBlobslib 库提供了一些函数，您可以通过这些函数找出 blob 的不同特征，例如 area 和 ellipticity ...因此，如果您只想要与长曲线平行的较小补丁...然后 ..

1.  根据斑点覆盖的面积或周长（即斑点的轮廓长度）获得长曲线...
2.  拟合椭圆后获取长曲线长轴的椭圆度或方向（cvBlobslib 库将为您执行此操作..!!）...
3.  过滤所有那些在面积或轮廓方面小于阈值并且**与长曲线具有相同方向的**斑点......

希望这可能有效..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T21:46:55.993

也许与其他人所说的相似，但用更简单的话来说：由于小线似乎大约是长线粗细的一半，如果你真的不关心保持长线的原样，你可以应用几个乘以“使线条变细”的简单算法，直到小线条消失。您需要做的是逐像素扫描图像，当您检测到黑色像素上方或下方或左侧或右侧的白色像素时，您将其坐标存储在矢量中。遍历整个图像后，将向量中坐标指定的所有像素设置为黑色。您可以根据经验为该算法的迭代次数定义一些阈值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-12T20:43:08.283

如果您事先知道线条的方向，则可以使用适合您需要的自定义结构元素进行形态闭合。

参见维基百科上的[morphomat](http://en.wikipedia.org/wiki/Mathematical_morphology)

见 opencv[文档](http://docs.opencv.org/modules/imgproc/doc/filtering.html?#void%20morphologyEx%28InputArray%20src,%20OutputArray%20dst,%20int%20op,%20InputArray%20kernel,%20Point%20anchor,%20int%20iterations,%20int%20borderType,%20const%20Scalar&%20borderValue%29)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-27T14:11:11.443

以下是利用平行线增加边缘密度这一事实的步骤。

1）应用于`adaptive Threshold`灰度图像以获得许多边缘。

2）`Erode`3x3（或小实验）形态学操作。

3) 取`Logical Not`边缘密度。

4) 应用`Dilate`3x3 或 5x5。它将扩大边缘以合并并形成一个区域。

5）现在`Erode`7x7（或实验更高然后最后扩张）形态学操作。它将删除大部分不需要的区域、长线和小的杂散区域。

输出是去除区域的 MASK。您可以在原始图像上应用轮廓检测​​并移除轮廓对象以在掩模高精度移除中匹配位置。或者，如果您不需要仅`And`使用 mask 的高精度结果`NOT`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-13T07:09:43.047

为什么不做类似的事情：

1.  找到长曲线（使用`findContours`并按大小过滤）。
2.  找到小曲线
3.  对于每条长曲线，计算每条小曲线的每个点与长曲线之间的最小距离。
4.  计算这些最小距离的平均值和标准差。
5.  拒绝与长曲线的平均最小距离太大的小曲线，或最小距离的标准偏差大的小曲线。

如果您首先对图像进行骨架化，结果可能会更好（更快）。

祝你好运，

# objective-c - 以编程方式与 charles 代理服务器进行 HTTP 请求和响应通信

> ID：12395488
> 
> 赞同：3
> 
> 时间：2012-09-12T20:05:32.243
> 
> 标签：objective-c, ios, http, charles-proxy

我正在尝试开发一个应用程序来监控其他应用程序的数据计划使用情况。根据链接 [iPhone/iPad 数据使用跟踪](https://stackoverflow.com/questions/5274805/iphone-ipad-data-usage-tracking?rq=1)链接，我设置了代理服务器 Charles。现在我可以在 charles 中看到 iPhone 网络流量的所有 http 请求/响应。现在我需要编写一个可以检查这些 charles 请求/响应的 HTTP 标头的应用程序。如何在 IOS（objective-C）中以编程方式执行此操作？请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-13T12:23:56.860

我不能将此添加为评论（需要 50 个代表），我知道这可能不是您正在寻找的内容，但这是我发现以编程方式访问会话的唯一方法。

您可以编写一个利用[Web Interface](http://www.charlesproxy.com/documentation/using-charles/web-interface/)的应用程序。我在对我的应用程序运行测试以检索会话活动时使用它，然后回顾性地对下载的信息做出断言。希望有帮助。

# jquery - Strange comma appending issue with @ModelAttribute

> ID：12395490
> 
> 赞同：1
> 
> 时间：2012-09-12T20:05:53.857
> 
> 标签：jquery, spring-mvc

Platform: Spring 3.1.2, Tomcat 7.0.30

The issue started after upgraded to Spring 3.1 from 3.0

I have a normal spring enabled form as:

> ```
> <c:url value='/healthcare/insurance/policy/save' var="url" />
> <form:form commandName="insurancePolicy" action="${url }" method="POST" cssClass="form-horizontal">
>   <div class="module">
>       <div class="header">
>           <strong><spring:message code="insurance.policy.view.formbox" /> </strong>
>       </div>
>       <div class="module-content row-fluid">
>           <div class="span4">
> 
>               <div class="control-group">
>                   <label class="control-label"><spring:message code="insurance.policy.view.policyId" /></label>
>                   <div class="controls">
>                       <form:input path="policyId" cssClass="span10" readonly="true" />
>                   </div>
>               </div>
> 
>               <div class="control-group">
>                   <label class="control-label"><spring:message code="insurance.policy.view.tpaId" /></label>
>                   <div class="controls">
>                       <form:select path="tpaId" items="${tpas }" itemLabel="tpaName" itemValue="tpaId" cssClass="span10" />
>                   </div>
>               </div> 
> ```

And so on.

The way I submit is:

```
function save(){
    $("#insurancePolicy").submit();

} 
```

The way I catch is through the Controller which resides in an abstracted class as below:

```
public abstract class AbstractCrudViewController<T, PK extends Number, META extends T> extends AbstractViewController {

@SuppressWarnings("unchecked")
    @RequestMapping(value="/save", method = RequestMethod.POST)
    protected String save(@ModelAttribute T t, Model model, HttpServletRequest request){

        logger.debug("Executing save for model: {}", t.toString());

        try{

            if (getPrimaryKeyValue(t) == null || ((Number) getPrimaryKeyValue(t)).intValue() <=0 ){
                logger.debug("Creating new record");
                PK pk =  getCrudService().create(t);
                logger.debug("New record created with ID: {}", pk);
                ViewUtil.addSuccess(model, "crud.saveSuccess", request, getPrimaryKeyValue(t));

            } 
```

The init binder is declared in the AbstractViewController as:

```
public abstract class AbstractViewController {

     @InitBinder
     public void initBinder(WebDataBinder binder) {
        String dateFormat = "dd/MM/yyyy";       
        binder.registerCustomEditor(DateTime.class, new DateTimeEditor(dateFormat,true));
     }

} 
```

OK. Now the problem is: I'm saving form and the log says:

```
DEBUG:com.keype.hawk.hr.mvc.StaffViewController[save]:Executing save for model: Staff [staffId=null, firstName=Steve,, lastName=Harris,, middleName=,, nationality=AF, dob=2012-09-11T00:00:00.000+03:00, status=1000, title=Mr, address1=, address2=, city=, state=, postalCode=, country=AF, homePhoneAreaCode=, homePhone=,, homePhoneExt=, homePhoneAllowSoliciation=, workPhoneAreaCode=, workPhone=null, workPhoneExt=, workPhoneAllowSoliciation=, fax=, mobileAreaCode=, mobile=, mobileAllowSolicitation=, email=null, joiningDate=null, gender=, govtId=, maritalStatus=, passportNumber=, passportExpiryDate=null, totalWorkExperience=, notes=, staffCreated=null, staffModified=null, dateCreated=null, dateModified=null] 
```

Notice the comma after each field.

For debugging, I serialized the form using jquery serialize and checked and there NO comma with it. Then ajax-posted this data to the server and after @ModelAttribute did it's job, The comma gets appended.

Any idea? Something with Init binder?

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-04T16:06:42.387

I was experiencing the same issue, but Twitter Bootstrap wasn't the cause.

In my case, we had 2 inputs having the same name attribute. In that case, data for this two input are sent as an Array. Since my inputs were empty, the array was `myName=,`

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-09-14T12:28:03.860

Problem Isolated. It seems like Twitter Bootstrap is creating the problem. There was a Tab inside the form. I put the tab outside the form and the problem is solved. Extremely strange.

# core-plot - 重置图表最安全的方法是什么？

> ID：12395491
> 
> 赞同：0
> 
> 时间：2012-09-12T20:05:55.033
> 
> 标签：core-plot

场景：我使用相同的图形空间（plotspace）来绘制 3 个月、6 个月、... 3 年的数据。我通过一个类似标签的控件从一个切换到另一个。

但是，当我切换图表时，我会从其他图表中“流血”。如果我要 [图表发布] 并重新创建图表，我最终会由于访问已发布的对象而崩溃。

那是：

```
if (graph is not nil) {
  release it;
}
create it 
```

那么，有没有一种安全的方法来重置绘图集显示之间的绘图空间、主题和范围？从而避免出血（例如，标签相互绊倒等）。

里克。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T00:33:31.113

只需在同一方法中更新轴标签、绘图范围和其他与外观相关的属性，以便在 Core Animation 让图形有机会更新其布局和重绘所有内容之前更新所有内容。

听起来您在发布旧图（或其中一个部分，如绘图）后在某处保留了对旧图的弱引用。仔细检查您的内存管理。

# slickgrid - 自定义格式化程序函数中的 SlickGrid 找出是否选择了行？

> ID：12395493
> 
> 赞同：1
> 
> 时间：2012-09-12T20:06:05.470
> 
> 标签：slickgrid

一直在尝试和寻找这个，这是我需要解锁的最后一块，我的 SlickGrid 将完成。

基本上我在列上使用自定义格式化程序，在格式化程序内部我只是创建一个蓝色的 HTML 链接。如果选择了该行（CheckBoxSelectionPlugin），我希望它与链接匹配为白色。所以我只是在该格式化程序中使用不同的类而不是 class `mp_dcp_import_blue_link`。任何人都知道我如何有效地找出单元格/行是否被选中？

这是我的简单格式化程序：

```
function PersonSearchFormatter(row, cell, value, columnDef, dataContext) {
    return "<div class='mp_dcp_cell_grid_pad'><a class='mp_dcp_import_blue_link       mp_dcp_font' title='Launch Patient Chart' onClick='javascript:APPLINK(0,\"Powerchart.exe\",\"/PERSONID=" + dataContext['MATCH_PERSON_ID'] + "\")'>" + value + "</a>&nbsp;</div>";
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:15:39.477

我认为这比格式化程序更容易处理，假设您使用的是[此处](http://mleibman.github.com/SlickGrid/examples/example-checkbox-row-select.html)演示的 CheckBox 插件，它将`selected`类添加到选定的行：

```
.selected .mp_dcp_import_blue_link{
    color: white;
} 
```

# vba - Excel UDF 过滤器范围

> ID：12395497
> 
> 赞同：2
> 
> 时间：2012-09-12T20:06:39.137
> 
> 标签：vba, excel, excel-formula, user-defined-functions

我有一个函数，它将一系列值作为输入（只是一列）以及一些阈值。我想返回一个经过过滤的范围，以包含原始范围中大于阈值的所有值。我有以下代码：

```
Public Function FilterGreaterThan(Rng As Range, Limit As Double) As Range

Dim Cell As Range
Dim ResultRange As Range

For Each Cell In Rng
    If Abs(Cell.Value) >= Limit Then
        If ResultRange Is Nothing Then
            Set ResultRange = Cell
        Else
            Set ResultRange = Union(ResultRange, Cell)
        End If
    End If    
Next
Set FilterGreaterThan = ResultRange
End Function 
```

问题在于，一旦某个数字低于阈值，则该数字之后高于阈值的其他数字不会添加到该范围中。

例如：

```
Threshold - 2

Numbers -

3
4
1
5 
```

它将循环添加 3 和 4，但不会添加 5。我最终得到一个#value 错误。但是我没有收到任何错误，如果我只输入范围 - 3、4 或范围 - 3、4、1，它就可以正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T21:57:18.683

看起来 UDF 不喜欢将非连续范围写回数组。

一种解决方法是重写 UDF，如下所示。它假定输出数组仅在列中，但确实允许多列输入。

```
Option Explicit

Public Function FilterGreaterThan(Rng As Range, Limit As Double) As Variant

Dim Cell As Range
Dim WriteArray() As Variant
Dim i As Long
Dim cellVal As Variant
Dim CountLimit As Long

CountLimit = WorksheetFunction.CountIf(Rng, ">=" & Limit)
ReDim WriteArray(1 To CountLimit, 1 To 1) 'change if more than 1 column
For Each Cell In Rng

    cellVal = Cell.Value
    If Abs(cellVal) >= Limit Then
            i = i + 1 'change if more than 1 column
            WriteArray(i, 1) = cellVal 'change if more than 1 column
    End If
Next
FilterGreaterThan = WriteArray
End Function 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T22:36:19.603

哦，我先到了那里，但我现在已经把它打出来了，所以我不妨把它贴出来。此版本将作为正确大小的列向量返回。

如果没有匹配项，则在 1 x 1 数组中返回 #N/A（这与数组函数在没有足够值填充数组时的正常行为一致）

*edit2：由于 ooo 的评论更新了功能*

```
Public Function FilterGreaterThan(Rng As Range, Limit As Double) As Variant()

Dim inputCell As Range ' each cell we read from
Dim resultCount As Integer ' number of matching cells found
Dim resultValue() As Variant ' array of cell values

resultCount = 0
ReDim resultValue(1 To 1, 1 To Rng.Cells.Count)

For Each inputCell In Rng
    If Abs(inputCell.Value) >= Limit Then
        resultCount = resultCount + 1
        resultValue(1, resultCount) = inputCell.Value
    End If
Next inputCell

' Output array must be two-dimensional and we can only
' ReDim Preserve the last dimension
If (resultCount > 0) Then
    ReDim Preserve resultValue(1 To 1, 1 To resultCount)
Else
    resultValue(1, 1) = CVErr(xlErrNA)
    ReDim Preserve resultValue(1 To 1, 1 To 1)
End If

' Transpose the results to produce a column rather than a row
resultValue = Application.WorksheetFunction.Transpose(resultValue)

FilterGreaterThan = resultValue

End Function 
```

* * *

编辑：对我来说可以使用下面评论中的测试值：

![显示 FilterGreaterThan UDF 正常工作的 Excel 文件](../Images/1af30f474bef8c31414982e24a56e8b0.png)

我确定您知道这一点，但在输入数组公式时不要包含`{`or`}`字符 - Excel 在您按下 Ctrl-Shift-Enter 后将它们添加

# r - 有没有办法使用 StatET Eclipse 插件的外部工具功能来编织和生成 .rmd 文件？

> ID：12395499
> 
> 赞同：11
> 
> 时间：2012-09-12T20:06:51.367
> 
> 标签：r, knitr, literate-programming, statet, r-markdown

我正在成为可重复分析和 Sweave、Beamer 以及特别是 knitr 包的粉丝。

RStudio 允许一键编织和编织文档，但 RStudio 虽然易于安装，但相当不稳定，不具备 Eclipse 的 StatET 插件的成熟度和灵活性。大多数教程或列表服务器在询问有关 knitr 和 RMarkdown 的问题时倾向于参考 RStudio IDE，但是关于如何安装 Markdown 文件并将其转换为`.Rmd`使用 knitr 包的内容很少。Jeffrey Horner 在宣布 R 降价包时说：

> “与 RStudio 合作创建的将 Markdown 文档转换为 HTML。它在其同类最佳的 IDE 中提供了完整的 R Markdown 功能集，但用户可以将 Markdown 集成到他们自己选择的工具链中。”

最后一句话是我一直无法弄清楚的。在其他地方，我看到有人建议使用 knitr 手动编织`library(knitr); knit('myfile.Rmd')`，但是，在尝试执行此操作时，我收到一个错误：

```
Warning in file(con, "r") :
  cannot open file 'My file.Rmd': No such file or directory
Error in file(con, "r") : cannot open the connection 
```

我能够`My file.md`使用以下方法将文件转换为 html：

```
library(markdown)
markdownToHTML(file = "C:/Dropbox/eclipse/8\. CM/Myfile", output="C:/Dropbox/eclipse/8\. CM/Myfile.html") 
```

但是，R 代码没有运行，我怀疑我需要先编织`.Rmd`文件。任何有关如何在 StatET 或 Rstudio 以外的地方编写 markdown 文件的帮助或指导将不胜感激。

我在 Windows 7 Professional 操作系统上使用 R 版本 2.15.1 (2012-06-22)。Eclipse 版本：3.8.0 和 StatET 3.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-14T12:52:14.373

一种方法是使用**R 片段**：

1）创建一个stateET R项目，其中包含此文件[https://raw.github.com/yihui/knitr-examples/master/001-minimal.Rmd](https://raw.github.com/yihui/knitr-examples/master/001-minimal.Rmd)。

2) 在 Windows-> 首选项 -> StatET -> 运行/调试 -> R 代码片段

单击“添加...”。创建一个名为**Rmd2html**的新片段。片段内容：

```
file <- "${selected_resource_loc}"
if (!nzchar) stop('Select a file first')
library(knitr)
library(markdown)
library(tools)
md_file <- knit(file)
html_file <- paste(file_path_sans_ext(md_file), '.html', sep = '')
markdownToHTML(md_file, html_file) 
```

单击“确定”、“确定”。

3）回到你的项目，在*项目资源管理器*视图中，右键单击**minimum.Rmd**文件，然后选择“Run Code Snippet in R -> Rmd2html”

这应该生成 minimum.html 文件。

# android - Android围绕另一个位图旋转

> ID：12395500
> 
> 赞同：2
> 
> 时间：2012-09-12T20:06:57.003
> 
> 标签：android, canvas, bitmap, rotation, 2d

我正在制作一个 2d 游戏，其中我的角色由操纵杆控制，我使用`canvas.rotate(angel, x, y)`. 我的角色朝他前进的方向射击，现在我想在他射击时增加他的步枪射出的火力。问题是，我如何围绕我的角色旋转这个火焰图像？

我如何旋转我的角色：

```
 canvas.save();
    canvas.rotate((float) controls.getAngle(), controls.charPosition.x + charBitmap.getWidth() / 2, controls.charPosition.y + charBitmap.getHeight() / 2);
    character.draw(canvas, controls.charPosition.x,controls.charPosition.y);
    canvas.restore(); 
```

我如何旋转火：

```
 canvas.save();
        canvas.rotate((float) controls.getAngle(), controls.charPosition.x + (fireBitmap.getWidth()) / 2, controls.charPosition.y + (fireBitmap.getHeight() / 2));
        fire.draw(canvas, controls.charPosition.x, controls.charPosition.y);
        canvas.restore(); 
```

你可能知道，像这样画我的火会让它围绕自己的中心旋转，就像我的角色一样。但我希望它**围绕**我的角色旋转，这样看起来火是从他的枪里出来的。

有任何想法吗？如果有任何不清楚的地方，请在评论中告诉我。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:34:41.547

我会尝试调整这个答案，使其更具体，但如果我理解正确，你可能不想旋转画布来创建火的旋转。相反，您可能希望使用相对于角色位置的三角函数来描述它。所以我认为它看起来像你画的角色。

```
canvas.save();
canvas.rotate((float) controls.getAngle(), controls.charPosition.x + charBitmap.getWidth() / 2, controls.charPosition.y + charBitmap.getHeight() / 2);
fire.draw(canvas, controls.charPosition.x+(fireRadius*cos(fireAngle)),controls.charPosition.y+(fireRadius*sin(fireAngle));
canvas.restore(); 
```

在这段代码中，fireRadius 是您希望火焰图距角色中心多远，而 fireAngle 是火焰距离角色中心的角度。这不太正确，因为它会跟踪火焰图像的角落，而不是中心。我认为这可以很容易地解决。如果没有，我会尽快改变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:54:32.800

你可以使用`Canvas.translate(dx, dy)`. 想法是把火移到离枪一定距离的地方，可以直接沿着x轴，然后围绕枪中心旋转Canvas。这导致火在距枪的给定距离处旋转给定角度。

```
canvas.save();
canvas.rotate((float) controls.getAngle(), controls.charPosition.x + (fireBitmap.getWidth()) / 2, controls.charPosition.y + (fireBitmap.getHeight() / 2));
canvas.translate(distanceFromGun, 0);
fire.draw(canvas, controls.charPosition.x, controls.charPosition.y);
canvas.restore(); 
```

请注意顺序。画布矩阵运算是预乘法，虽然翻译是在代码的后面进行的。

# jquery - 选择：保持多项选择顺序

> ID：12395503
> 
> 赞同：28
> 
> 时间：2012-09-12T20:07:15.430
> 
> 标签：jquery, jquery-chosen, multipleselection

我正在使用 Chosen 的多项选择。我希望能够跟踪用户选择的订单。例如，如果用户先选择option2然后选择option1，我想按option2和option1的顺序得到结果。但选择排序用户选择的选项。有没有办法告诉我选择不对结果进行排序？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-07-22T17:35:31.563

我写了一个简单的插件来与 Chosen 一起使用。它允许您**检索选择**的多选元素的选择顺序，还可以**从有序值数组中设置它**。

它在 Github 上可用：[https ://github.com/tristanjahier/chosen-order](https://github.com/tristanjahier/chosen-order)

它与 Chosen 1.0+ 以及 jQuery 和 Prototype 版本兼容。每个框架还有一个插件，可以让你做这样的事情：

## 检索选择顺序

```
var selection = $('#my-list').getSelectionOrder(); 
```

## 按顺序设置选定的值

```
var order = ['nioup', 'plop', 'fianle']; // Ordered options values
$('#my-list').setSelectionOrder(order); 
```

一探究竟。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-08T16:50:07.667

现在有一个[https://github.com/mrhenry/jquery-chosen-sortable/](https://github.com/mrhenry/jquery-chosen-sortable/)插件可用，它可以为所选的 v1 完成工作。

对于较新版本的 selected，您需要在 github JS 文件中将 chzn- 替换为 selected- 。

要使用它，我使用以下代码：

```
jQuery('#myselect').addClass('chosen-sortable').chosenSortable(); 
```

它工作得很好，但是当再次编辑字段以在加载选择后重新排序元素时，您将需要更多代码。

我为此使用以下内容。给定一个 sortedElements 列表和 $select = jQuery('#myselect')：

```
var $container = $select.siblings('.chosen-container')
var $list = $container.find('.chosen-choices');

// Reverse the list, as we want to prepend our elements.
var sortedElements = sortedElements.reverse();

for (var i = 0; i < sortedElements.length; i++) {
  var value = sortedElements[i];

  // Find the index of the element.
  var index = $select.find('option[value="' + value + '"]').index();

  // Sort the item first.
  $list
          .find('a.search-choice-close[data-option-array-index="' + index + '"]')
          .parent()
          .remove()
          .prependTo($list);
} 
```

这在这里工作得很好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-13T19:35:51.310

如果还不算太晚，我建议您使用[Select2 。](http://ivaynberg.github.com/select2/)它看起来与 Chosen 相同，但具有更好的 API 和文档。

使用 select2，它类似于 [未经测试的代码]

```
 var results = [];
 $("#e11").on("change", function(e) { 
    results.push(e.val)
 }) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-05-21T00:55:17.673

我注入了一个自定义`.change()`事件处理程序以使其工作：

```
$('.chosen-select').chosen({}); 
```

至：

```
$('.chosen-select').chosen({}).change((event, info) => {
  if (info.selected) {
    var allSelected = this.querySelectorAll('option[selected]');
    var lastSelected = allSelected[allSelected.length - 1];
    var selected = this.querySelector(`option[value="${info.selected}"]`);
    selected.setAttribute('selected', '');
    lastSelected.insertAdjacentElement('afterEnd', selected);
  } else { // info.deselected
    var removed = this.querySelector(`option[value="${info.deselected}"]`);
    removed.setAttribute('selected', false); // this step is required for Edge
    removed.removeAttribute('selected');
  }
  $(this).trigger("chosen:updated");
}); 
```

请注意，这会在选择的情况下移动 DOM，而在取消选择的情况下不会移动。`setAttribute`/是为了在DOM`removeAttribute`中带来可见的变化。`<option>`

希望这对仍在寻找方法的人有所帮助，而无需在提交时做任何额外的事情。

PS：如果需要，可以编写此代码的紧凑 jQuery 版本。:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-02-06T19:51:04.973

您可以在更改事件中自己添加/删除项目。

```
// Your collection Array
var collectionArray = [] 

// make change event on chosen select field
chosenSelect.change(function () {
  // first get the chosen results which might be in wrong order
  var currentValues = $(this).val();

  // get your current collection that is in the right order
  var pastValues = collectionArray;

  // see if you need to add or drop
  if (currentValues.length > pastValue.length) {

    // loop to get just the new item
    pastValues.forEach(function(pastValue) {
      currentValue = $.grep(currentValue, function(newItemOnly) {
        return newItemOnly != pastValue;
      });
    });

    // add your newItemOnly
    collectionArray.push(currentValue[0]);

  } else {

    // here loop to get only the dropped value
    currentValues.forEach(function(currentValue) {
      pastValues = $.grep(pastValues, function(droppedValueOnly) {
        return droppedValueOnly != currentValue;
      });
    });

    // drop the value dropped from your collection
    collectionArray = $.grep(collectionArray, function(updatedArray) {
      return updatedArray != pastValues[0];
    });
  }
}); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-12-27T13:46:00.703

希望这对使用旧版本 select2（低于 v4）的人有用。在这种情况下，select2-selecting 和 select2-removing 选项很有帮助。使用数组并在我们选择后附加值，我们可以保持选择顺序，并且在取消选择特定选项时，我们可以找到索引并使用 splice() 从数组中删除它。

```
var selected = [];    
$('#multiSelect').on("select2-selecting", function(evt) {
            var selectedOption = evt.val;
            selected.push(selectedOption);

        }).on("select2-removing", function(evt) {
              index = selected.indexOf(evt.val);
              selected.splice(index,1);       
        }); 
```

对于版本 4 及更高版本，可以使用 select2:select 和 select2:unselect。:)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2018-02-27T15:04:58.223

这将按照您的选择顺序排列

```
$("select").on('select2:select', function (e) {
    var elm = e.params.data.element;
    $elm = jQuery(elm);
    $t = jQuery(this);
    $t.append($elm);
    $t.trigger('change.select2');
}); 
```

# java - 在tomcat 5上部署战争抱怨文件是一个目录

> ID：12395516
> 
> 赞同：1
> 
> 时间：2012-09-12T20:08:30.277
> 
> 标签：java, tomcat, war, tomcat5.5

我在 Linux 上安装了 Tomcat 5，并且部署了一个 web 应用程序并且愉快地运行了很多年。我现在正在尝试部署一个新的 web 应用程序，这场战争是使用 Maven 创建的，对我来说看起来不错，但是 catalna 日志中有一个错误，阻止它正确部署。

它抱怨：

```
 java.io.IOException: java.io.FileNotFoundException: 
 /home/jthink/jakarta-tomcat-5.0.27/conf/Catalina/localhost/widget.xml
 (Is a directory) 
```

没错，widget.xml**是**一个目录。但我没有创建这个文件，我不知道它来自哪里

我的战争包含以下文件结构：

```
.:
META-INF
WEB-INF

./META-INF:
context.xml
MANIFEST.MF
maven

./WEB-INF:
classes
lib
web.xml 
```

我看不出有什么奇怪的

这是完整的堆栈跟踪

```
java.io.IOException: java.io.FileNotFoundException: /home/jthink/jakarta-tomcat-5.0.27/conf/Catalina/localhost/widget.xml (Is a directory)
        at org.apache.catalina.core.StandardHostDeployer.install(StandardHostDeployer.java:494)
        at org.apache.catalina.core.StandardHost.install(StandardHost.java:863)
        at org.apache.catalina.startup.HostConfig.deployDescriptors(HostConfig.java:482)
        at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:427)
        at org.apache.catalina.startup.HostConfig.check(HostConfig.java:1068)
        at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:327)
        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
        at org.apache.catalina.core.StandardHost.backgroundProcess(StandardHost.java:800)
        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1619)
        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.processChildren(ContainerBase.java:1628)
        at org.apache.catalina.core.ContainerBase$ContainerBackgroundProcessor.run(ContainerBase.java:1608)
        at java.lang.Thread.run(Thread.java:619) 
```

**解决方法**

jakarta-tomcat-5.0.27/conf/Catalina/localhost/widget.xml 应该是 widget.wars META-INF/context.xml 文件的副本，而不是目录。我不知道为什么它被创建为目录但手动删除然后复制 context.xml 并重命名为 widget.xml 解决了这个问题。

向开发人员提出了一个错误[https://issues.apache.org/bugzilla/show_bug.cgi?id=53864](https://issues.apache.org/bugzilla/show_bug.cgi?id=53864)但由于 tomcat 版本太旧而关闭了 wont-fix。猜猜我应该升级amd看看问题是否消失。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T05:54:46.583

没有深入了解，但解决方案是升级到 Tomcat 7，我没有意识到 Tomcat 5 已经过时了。

# iphone - Facebook 连接集成错误

> ID：12395518
> 
> 赞同：1
> 
> 时间：2012-09-12T20:08:33.487
> 
> 标签：iphone, objective-c, facebook, facebook-graph-api

我正在将 facebook 集成到我的 iPhone 应用程序中。当我通过 safari 登录时，单点登录方法有效。但是在我安装 Facebook 应用程序并单击“连接到 Facebook”后，应用程序将我带到 Facebook 应用程序。顶部有一条错误消息“为 Facebook 登录配置错误。按确定返回应用程序而不将其连接到 facebook”

可能是什么问题？请指教，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-14T00:05:09.283

所以，这可能听起来像是有史以来最糟糕的两个潜在修复，但我只是遇到了这个问题......

1.  我从使用以前版本的 Facebook iOS SDK 转到了最新版本，我所做的少数更改之一是添加了 FacebookAppID && 4* ***** ****** *7。所以，我删除了APP ID，然后再试一次，它成功了。我建议您在 plist 中检查 AppID 和 FacebookAPPID 的拼写。

2.  您的模拟器或设备上是否有多个版本的应用程序？删除旧的，它可能会修复它，它把我踢到我的应用程序的旧版本，并在我已经登录时试图让我退出应用程序。

希望对你有帮助，

伊娃

# visual-studio-2010 - 在 Visual Studio 2010 中调试时出现无限循环

> ID：12395519
> 
> 赞同：7
> 
> 时间：2012-09-12T20:08:39.683
> 
> 标签：visual-studio-2010, debugging, infinite-loop

我对 VS2010 有一个奇怪的问题（构建一个大型 C++ 项目）。开始调试时，执行类似于无限循环。我在 main() 的第一行放了一个断点，但断点从未到达。我也试过 F11 进入 main()，但没有效果。任务管理器显示了我的应用程序的一个实例，控制台只显示“xxx.dll Symbols loaded”。我试图暂停执行，但我陷入了一些程序集循环，如果有人可以阅读，这里是程序集：

```
0000000077226129  lea         rdx,[rsp+88h]  
0000000077226131  xor         ecx,ecx  
0000000077226133  call        0000000077231650  
0000000077226138  mov         dword ptr [rsp+30h],eax  
000000007722613C  test        eax,eax  
000000007722613E  js          000000007725E73F  
0000000077226144  cmp         dword ptr [7731201Ch],r14d  
000000007722614B  je          0000000077226129 
```

有人可以告诉我或至少指出如何解决这个问题吗？

**编辑：**我发现当删除一个共享库（Point Gray Research 开发的 FlyCapture2）时，应用程序正常启动。似乎该库具有某种加载程序，该程序在执行 main() 之前调用。即使我解决了当前的问题，我仍然想知道：如何检测此类问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-08T01:18:22.013

我想我找到了问题所在。在我的一个 DLL 中，我有一个单例类。在头文件中，我有一个 getter *LogManager::instance()*和一个销毁器*void LogManager::destroyInstance()*。该实例是在 .cpp 文件中定义的，但不是静态的，而是作为全局变量

```
LogManager* sInstance = new LogManager; 
```

而*instance()*函数只是返回了该变量，而*destroyInstance()*函数将其删除。所以我删除了全局变量并在*instance()*函数中创建了该实例

```
void LogManager::instance()
{
    static LogManager*  sInstance = 0;
        if(!sInstance)
            sInstance = new LogManager;
    return sInstance;
} 
```

问题就消失了。所以我认为也许该DLL中的全局变量在加载该DLL期间导致了无限循环？也许这对有类似问题的人来说是一个提示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-13T10:45:50.410

如何正确连接DLL是一个大问题。它在应用程序之前所以我们很难找到它并解决它。但是当我有关于DLL的问题时，我也会在互联网上寻找答案.而且每个错误都有自己的序列号。这是关键。它还在“错误列表”中显示“LNK**** ........”。所以我可以找到它，甚至可以通过我自己根据别人的信息。

PS：您的代码称为“机器指令”。它是计算机原理的一部分。

# java - Android NDK 是否可以加快通过套接字发送大 int[] 的速度？

> ID：12395520
> 
> 赞同：8
> 
> 时间：2012-09-12T20:08:46.470
> 
> 标签：java, android, performance, casting, android-ndk

我需要通过两个 Android 设备之间的套接字发送一个包含 500,000 个整数的数组。目前，我花费大量时间将 int[] 转换为 byte[] 以便 Java 的套接字能够接受它（请参阅我之前的问题[Efficiently send large int[] over sockets in Java](https://stackoverflow.com/questions/12320000/efficiently-send-large-int-over-sockets-in-java)，我们确定没有更快的方法在 Java 中进行类型转换）。

我现在的问题是，如果我采用 int[] 并通过 JNI 将其传递给 Android NDK，我是否可以期望对 byte[] 的类型转换在本机代码中更快？我知道在普通的 C 中将 int* 类型转换为 char* 非常简单，但是我想知道 JNI 是否会否定任何性能提升。

此外，一旦我的本机代码中有一个 byte[]，我可以有效地将它传递回我的 Java 代码，还是我还需要在 C 中实现套接字？

编辑1：人们在没有点击链接的情况下发布了很多答案。**使用 ByteBuffers 不是一个好的选择**，它实际上比 mask-and-shift 慢得多，这仍然比我的性能关键代码需要慢得多！这就是我问NDK的原因。

编辑 2：我更改了上面的文字，说 C 代码可以从 int* 转换为 char* 而不是 int[] 转换为 byte[]。希望这能澄清这个问题。

编辑 3：为了澄清我的用例，这是一个研究问题，我在多个设备上分布大量整数并对列表进行并行排序。假设我在 Java 中有 500,000 个整数（不管它们来自哪里），我需要尽快通过套接字将它们从设备中取出。说“不要以整数数组开头”的答案没有帮助。此外，我的应用程序代码需要尽可能接近 100% Java。如果本机类型转换和套接字提高了性能，那没关系，但我不能在本机上做任何其他事情（即排序）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:14:14.483

~~不，使用 JNI/NDK 不会提高性能。首先，当您尝试将数组转移到本机代码时，您必须复制它或使用直接分配的 ByteBuffer~~。原来 Dalvik VM 的实现总是从 Get*ArrayElements() 返回直接指针。我确实怀疑您是否会获得性能提升，因为通过 JNI 进行的调用会产生间接费用。最后，C++ 和 Java 在这种情况下具有非常接近的性能（请参阅[C++ 性能与 Java/C#](https://stackoverflow.com/questions/145110/c-performance-vs-java-c)）。

看看这个问题和第一个答案，了解从 Java 将 int[] 转换为 byte[] 的快速方法[How to convert int[] to byte[]](https://stackoverflow.com/questions/1086054/java-how-to-convert-int-to-byte)

您是否有理由使用 int[] 而不是 byte[] 开始？如果是图像，我们可能会推荐避免转换的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:20:24.097

使用 a `SocketChannel`，您可以使用`ByteBuffer`s 代替。

```
buffer.asIntBuffer().put(ints);
do {
  channel.write(buffer);
} while (buffer.hasRemaining()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T10:49:41.170

如果 Java 代码需要有效地访问`int[]`，那么很有可能使用套接字进行本机发送/接收是值得的。

但通常可以使用 IntBuffer 代替 int[]。在这种情况下，您可以分配一个 ByteBuffer 并从中获取一个 IntBuffer：

```
ByteBuffer bb = ByteBuffer.allocate(500000*4);
IntBuffer ib = bb.asIntBuffer(); 
```

您应该同时使用 allocate() 和 allocateDirect()，请参阅“ [ByteBuffer.allocate() 与 ByteBuffer.allocateDirect()](https://stackoverflow.com/questions/5670862/bytebuffer-allocate-vs-bytebuffer-allocatedirect) ”和[http://objectissues.blogspot.co.il/2005/10/java-nio-allocate -vs-allocatedirect.html](http://objectissues.blogspot.co.il/2005/10/java-nio-allocate-vs-allocatedirect.html)。

**重要的！**在这种情况下，`UnsupportedOperationException`如果您尝试使用`ib.array()`.

# ruby-on-rails - Rails Forms：如何在多对多关系的复选框旁边添加字段

> ID：12395524
> 
> 赞同：3
> 
> 时间：2012-09-12T20:09:02.520
> 
> 标签：ruby-on-rails, ruby-on-rails-3, many-to-many, associations

所以我需要关于如何在多对多关系中设置 Rails 表单的建议，我在连接模型中保存额外的信息。

背景：我有两个模型，用户和技能。一个用户可以有很多技能；技能可以映射到许多用户。我有一个加入模型 SkillAssessment 来保存它，它保存了一个 user_id，skill_id。我希望能够在加入模型中保存用户在技能或技能级别上的表现。这可以采用 0-5 的整数值。

技能表预先填充了条目，因此在创建新用户时，我希望“技能”输入是一堆复选框。我不知道如何在复选框旁边添加一个字段，用户可以在其中输入他/她的技能水平。理想情况下，这将是一个下拉菜单，但这并不是非常重要。

这是它的外观图片：复选框在左侧，后面是一个标签，然后是一个额外的字段（文本输入，下拉......任何东西）来评估技能水平。

![示范做什么](../Images/1525e216c0243e660c3ace94c2e7a64a.png)

保存数据后，这些模型运行良好，但我不知道如何更改表单。如果只是节省技能，我会说：

```
 = f.input :skills, :label => _("Skills"), :as => :check_boxes, :collection => Skill.all 
```

我怎样才能实现我在这里的目标？我想也许是 semantic_fields_for 之类的？

仅供参考，我使用苗条和形式，但知道haml和plain rails，因此非常感谢任何格式的建议！多谢你们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T08:15:00.563

您已经说过，一旦数据库中的所有内容都运行良好，所以我假设您已将模型设置为 a`:has_many, :through`而不是`has_and_belongs_to_many`. 如果没有，您需要这样做以将额外的属性保存到您的连接模型。

如果您还没有这样做，您将需要在您的用户模型中打开accepts_nested_attributes_for SkillsAssessments。

如果您正在使用`attr_accessible`，您还需要将`skill_assessments_attributes`可访问属性添加到您的用户列表中。

最终结果是您的用户模型如下所示：

```
models/user.rb
===============
class User < ActiveRecord::Base

has_many :skill_assessments
has_many :skills, :through => :skill_assessments

accepts_nested_attributes_for :skill_assessments

attr_accessible :user_field, ..., :skill_assessments_attributes 
```

同样，如果您使用 attr_accessible，则需要确保您的 Skill_assessment 模型上的所有三个字段都是可访问的。

```
models/skill_assessment.rb
===========================
class SkillAssessment < ActiveRecord::Base

belongs_to :user
belongs_to :skill

attr_accessible :user_id, :skill_id, :skill_level 
```

然后在您看来，您将拥有这样的东西（haml）：

```
views/users/_form.html.haml
============================
= semantic_form_for @user do |f| 
  = f.input :user_field_1
  ...
  = f.input :user_field_n
  = f.semantic_fields_for :skill_assessments do |sa|
    = sa.input :skill_id, :label => "Skill", :collection => Skill.all
    = sa.input :skill_level, :label => "Proficiency", :collection => [1,2,3,4,5]
  = f.submit 
```

# c# - “C:\”的访问被拒绝

> ID：12395530
> 
> 赞同：2
> 
> 时间：2012-09-12T20:09:24.957
> 
> 标签：c#

我做了一个程序，应该显示一个文件系统树。我将其设置为显示来自**`C:`**. 当我编译程序时说访问被拒绝`C:`。告诉我你需要什么，以防你帮助我，我会为你提供所需的信息。谢谢！

PS 当我设置程序以列出其中的文件系统时，`C:\Windows\`它起作用了。

这是我使用的代码：

```
private void ListDirectory(TreeView treeView, string path)
{
    treeView.Nodes.Clear();
    var rootDirectoryInfo = new DirectoryInfo(path);
    treeView.Nodes.Add(CreateDirectoryNode(rootDirectoryInfo));
}

private static TreeNodeCreateDirectoryNode(DirectoryInfo directoryInfo)
{
    var directoryNode = new TreeNode(directoryInfo.Name);
    foreach (var directory in directoryInfo.GetDirectories())
        directoryNode.Nodes.Add(CreateDirectoryNode(directory));
    foreach (var file in directoryInfo.GetFiles())
        directoryNode.Nodes.Add(new TreeNode(file.Name));
    return directoryNode;
} 
```

在程序中，调用我使用的方法：

```
mainWindow(){
    InitialiseComponent();
    ListDirectory(treeView1, @"C:\");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-01T12:50:43.057

此代码将在执行它的用户帐户下运行。根据该帐户的权限，`System.UnauthorizedAccessException`某些目录（例如用户帐户文件夹或回收站）可能会出现。

这不会阻止您在目录结构中导航，但会阻止该帐户读取受保护文件夹内的所有目录。

您可以编写代码来使用[拉取访问控制列表](https://stackoverflow.com/a/3456514/1399675)`directoryInfo.GetAccessControl()`

或者你可以抓住`System.UnauthorizedAccessException`. 那么您的代码可能如下所示：

```
try
{
    var directoryNode = new TreeNode( directoryInfo.Name );
    foreach ( var directory in directoryInfo.GetDirectories() )
        directoryNode.Nodes.Add( CreateDirectoryNode( directory ) );
    foreach ( var file in directoryInfo.GetFiles() )
        directoryNode.Nodes.Add( new TreeNode( file.Name ) );
    return directoryNode;
}
catch ( System.UnauthorizedAccessException )
{
    return new TreeNode( "Unavailable Node" );
}
catch ( System.IO.PathTooLongException )
{
    return new TreeNode( "Unavailable Node" );
} 
```

# jquery - 在 jQuery 中，如何根据下拉列表中的 selectino 更改 Html 表格标题

> ID：12395531
> 
> 赞同：1
> 
> 时间：2012-09-12T20:09:29.573
> 
> 标签：jquery, html, datatables

我无法更改**基于下拉列表的**更改事件的我的 Html 表的文本。****

 **首先是带有 Html 表定义的 div 部分，以及下拉列表：

```
 <div class="floatleft">        
    <span style="margin-left:250px;">Portfolio Filter: </span>
    <select id="drpPortFilters">
        <option>Select a portfolio filter</option>
    </select>

    <div class="PortfolioList"> <!-- PORTFOLIO TABLE ! -->
        <table id="pftable">
            <caption>Portfolio Exposures</caption>
            <tbody></tbody>
        </table>            
    </div>
</div> 
```

这是**jquery** document.ready() 部分...

注意：“ **selValue** ”确实被分配了。alert() 向我展示了一个很好的价值！

但是，“#pftable”不知何故迷路了……意思是，本节不会更改标题！

```
 $(document).ready(function () {
    // Initialize Trade Contribs table (see html table below)
    var oTable = $('#contribtable').dataTable();

    // Portfolio Filters change event !!
    $('#drpPortFilters').change(function () {
        var selValue = $('#drpPortFilters option:selected').text(); //$(this).val(); 
        alert(selValue);
        $('#pftable').find("caption").text(selValue);            
    });
}); 
```

奇怪的是，我确实成功地将不同部分的文本一起更改了；也就是说，在我通过数据表插件填充 Datatable() 之后。

也许数据表妨碍了使用 jQuery 的传统参考。

对此有任何想法或想法？？？

提前谢谢.....鲍勃

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-01T14:02:11.683

我的测试用例在这里： http: [//live.datatables.net/oxeqij/19/edit#source](http://live.datatables.net/oxeqij/19/edit#source)

最后，我在 Datatables 中使用滚动，它覆盖了我的 html 表“pftable”的“id”属性。所以***我无法***使用**$('#pftable')**处理我的 Html 表。

所以底线是我需要在我的 html 表中添加**class="pftable"**，然后编写 jQuery 选择如下：

```
 $('**.pftable**').find("caption").text(selValue); 
```

这最终使我能够动态更改我的 Html 表的文本。

问候。鲍勃**

# ios - iScroll 在“下一个”之后或焦点在输入框之后

> ID：12395532
> 
> 赞同：1
> 
> 时间：2012-09-12T20:09:36.450
> 
> 标签：ios, iphone-web-app

在 iOS 的基本 Web 应用程序中运行 iScroll，我注意到如果我在键盘上按“下一步”，即使我离开它，iScroll 也不会滚动到突出显示的输入框上方。有小费吗？

# android - 禁用 Eclipse 中小部件的自动排列

> ID：12395533
> 
> 赞同：2
> 
> 时间：2012-09-12T20:09:44.843
> 
> 标签：android, android-layout

我对 android 编程相当陌生（从 Windows 编程切换到移动平台。）

问题：每次我添加，比如说，一个文本视图，我都会在它周围得到一个绿色框，它将把它放在一个位置。当我添加多个文本视图时，我会把它放在另一个文本视图下，我的应用程序中的所有内容都会发生变化，并将所有内容移动到屏幕左上角的一个堆栈中。似乎每次我移动一件东西，其他 5 件东西也会随之移动。

问题：有没有办法禁用该功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:30:35.350

转到您的布局，右键单击它，然后单击更改布局。我将其更改为绝对布局，这样我就可以在屏幕上随意移动任何或我的小部件，而不会影响其他小部件。希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T21:05:07.827

Android 强迫您在没有像素刚性符号的情况下进行开发。基本上，您有一组布局类型（线性、相对等）来建立子元素之间的**关系。**

因此，重要的是要了解这些布局，如何连接它们以及它们的子级是如何排列的。

在 eclipse 中你可以添加元素，但有些东西 eclipse 不知道它们是如何相关的。Eclipse 将更新新数据，因此将所有类型的视图移开以更新到您定义的新层次结构中。因此，您不能删除“自动布局”。即使您更改为绝对布局（如大卫建议的那样），您也不会删除“自动布局”功能。你只是告诉 eclipse 你想用绝对定位来安排你的东西。但是，绝对定位是不可取的，因为您有多个具有不同分辨率的设备。

我建议您阅读一些[有关布局](http://developer.android.com/guide/topics/ui/declaring-layout.html)的信息，然后尝试使用 XML。不要害怕。它可以变得很容易。实际上，我更喜欢 XML 而不是 Eclipse 中的接口构建器。在您了解布局的工作原理后，您可以更好地使用界面构建器。

# android - 适用于 ios 和 android 的智能手机应用程序

> ID：12395534
> 
> 赞同：-3
> 
> 时间：2012-09-12T20:09:54.617
> 
> 标签：android, ios

我是开发移动应用程序的初学者，我想开发可以轻松从 android 迁移到 ios 或返回的应用程序。我的意思是，如果我想为两个平台设计应用程序，我该怎么办。

示例：我将为 android 制作应用程序，而我的朋友将更改我的 ios 应用程序。什么方法或技术更适合这种风格。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:14:35.153

[这篇文章](http://maniacdev.com/2010/09/cross-platform-iphone-and-android-solutions/)会帮助你。

我评估过各种跨平台解决方案，它们都比原生开发有一定的劣势，无论是硬件访问、api 的可用性等。本质上，任何跨平台的应用程序开发环境都必然会采用最低公分母。Corona 非常适合游戏，如果这就是您所追求的。除此之外，您最好运行两个代码流。

# php - HTACCESS 用获取变量重写

> ID：12395539
> 
> 赞同：0
> 
> 时间：2012-09-12T20:10:15.610
> 
> 标签：php, .htaccess

我有一个子目录，里面有一堆 .php 文件。我目前将此作为我的 .HTACCESS 来干净地重写网址。

```
RewriteEngine on
Options +FollowSymLinks
RewriteBase /mailing_list

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php 
```

这很好，因为它变成[http://www.example.com/mailing_list/home](http://www.example.com/mailing_list/home)来查看[http://www.example.com/mailing_list/home.php](http://www.example.com/mailing_list/home.php)

我还需要考虑的是一个使用干净 url 获取变量的页面。该页面称为 w.php 并通过`?i=(int)`

当我尝试访问[http://www.example.com/mailing_list/w/1](http://www.example.com/mailing_list/w/1)时，我收到 505 服务器错误。我需要在我的 htaccess 中添加什么来解决这个问题？有没有一种完整的证明方法可以解释我遇到的其他人。例如：

如果出现一个名为 blogs 的页面，它会像这样传递博客的 ID：[http ://www.example.com/mailing_list/blog/1](http://www.example.com/mailing_list/blog/1)

我是否必须专门为该页面添加新规则？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:26:01.837

代替

```
RewriteRule ^(.*)$ $1.php 
```

经过

```
RewriteRule ^([^/]+)$ $1.php [L,QSA]
RewriteRule ^([^/]+)/(.*)$ $1.php?i=$2 [L,QSA] 
```

# svg - 嵌入 SVG 时 wkhtmltopdf 失败

> ID：12395541
> 
> 赞同：16
> 
> 时间：2012-09-12T20:10:36.543
> 
> 标签：svg, pdf-generation, wkhtmltopdf

在这个广阔的空间中，有没有人有幸成功地在 HTML 上创建了带有嵌入式 SVG 的 PDF？我一直在收到分段错误。

或者也许有任何其他方法可以将 SVG 嵌入到 HTML 文件中，然后将其导出为 PDF 而不是`wkhtmltopdf`？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-19T20:27:40.800

我有类似的问题。似乎嵌入在 SVG 图像中的 javascript 会导致分段错误。

*我正在使用pygal* Python 模块生成 SVG 图。为了成功地从带有 SVG 图形的 HTML 生成 PDF，我必须做几件事：

1.  删除对 j​​avascript 的引用。（在*pygal*的情况下，将 js=() 键添加到图形构造函数）。
2.  在 svg 标签中指定图像大小，例如

    ```
    <svg ... width="300" height="200"> 
    ```

    （在 pygal 的情况下使用*explicit_size*关键字）

3.  将 SVG 图像以 base64 编码形式嵌入到*img标签中，例如*

    ```
    <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0..."> 
    ```

我使用的是第 11 版的 wkhtmltopdf。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-10-24T17:11:56.700

如果此修复对其他人不起作用，这就是在 Ubuntu 64 下使用 chartist.js 和 wkhtmltopdf 0.12.2.1 对我有用的方法。（感谢 Panokev）

在所有其他 JS 之前将此添加到您的 javascript 中。

```
{

Function.prototype.bind = Function.prototype.bind || function (thisp) {
    var fn = this;
    return function () {
        return fn.apply(thisp, arguments);
    };
}; 
```

明确设置图表 div 的宽度样式，例如 - style="width:950px;"

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T20:57:50.953

对..我终于成功了...所需要的只是对原始 eps 文件进行一些处理。我用illustrator打开文件并选择“展平透明度”..也许它的作用是展平文件的多层或其他东西..然后另存为svg ..它在PDF中呈现得很好..

如果有人遇到和我一样的问题，希望这会有所帮助。谢谢！:D

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-02-05T19:13:13.887

我们通过向 svg 除了 viewbox 属性添加宽度和高度属性来解决此问题。

# machine-learning - 为什么我们在主成分分析期间最大化方差？

> ID：12395542
> 
> 赞同：18
> 
> 时间：2012-09-12T20:10:42.507
> 
> 标签：machine-learning, feature-extraction

我试图通读 PCA 并看到目标是最大化方差。我不太明白为什么。对其他相关主题的任何解释都会有所帮助

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-12T20:29:15.520

方差是衡量您拥有的数据的“可变性”的指标。组件的数量可能是无限的（实际上，在数字化之后，它最多等于矩阵的秩，正如@jazibjamil 指出的那样），所以你想在你构建的有限集合的每个组件中“挤压”最多的信息.

如果夸大其词，您要选择*单个*主成分，您可能希望它考虑最大的可变性：因此搜索最大方差，以便一个成分从数据集中收集最多的“唯一性”。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-12T23:38:46.900

请注意，PCA 实际上不会增加​​数据的方差。相反，它以这样一种方式旋转数据集，以便将其展开最多的方向与主轴对齐。这使您可以删除数据几乎平坦的那些维度。这会降低数据的维度，同时保持点之间的方差（或散布）尽可能接近原始数据。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-12T20:27:37.360

最大化分量向量方差与最大化这些向量的“唯一性”相同。因此，您的向量彼此之间的距离尽可能远。这样，如果您只使用前 N 个分量向量，您将使用高度变化的向量捕获比使用相似向量更多的空间。想想主成分的实际含义。

例如，您有 2 条线在 3D 空间中正交。与两条平行（或几乎平行）的线相比，使用这些正交线可以更完整地捕捉环境。当使用非常少的向量应用于非常高维的状态时，这将成为要维护的向量之间更重要的关系。在线性代数意义上，您希望 PCA 生成独立的行，否则其中一些行将是多余的。

有关基本解释，请参阅[普林斯顿计算机系的](http://www.cs.princeton.edu/courses/archive/spr08/cos424/scribe_notes/0424.pdf)此PDF。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-01-19T07:52:03.117

[![最大方差](../Images/aa4c04dc327bbbda2f3d4210782bab03.png)](https://i.stack.imgur.com/QQ3Iw.jpg) 最大方差基本上是设置这些占据数据点最大分布的轴，为什么？因为这个轴的方向是真正重要的，因为它有点解释相关性，稍后我们将沿这些轴压缩/投影点以摆脱某些维度

# python - 双重列表理解

> ID：12395546
> 
> 赞同：-3
> 
> 时间：2012-09-12T20:11:01.270
> 
> 标签：python, list-comprehension

有没有一种简单的方法可以理解以下内容

```
words = ["x", "mouse", "looloo", "google", "foo"]
terms = set()
for i in xrange(len(words)):
    terms = terms.union([" ".join(words[j:j + len(words) - i]) for j in xrange(len(words))])
return sorted(terms, key=len, reverse=True) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:15:11.973

您可以将多个循环按与使用嵌套 for 循环时相同的顺序列出它们，从而将它们放入列表推导中。

就像是：

```
terms = set([" ".join(words[j:j + len(words) - i])
               for i in xrange(len(words)) for j in xrange(len(words))]) 
```

但是我发现您的算法很难阅读，所以我什至不确定这会满足您的需求。

# android - Android 蓝牙开发入门：测试应用建议

> ID：12395547
> 
> 赞同：0
> 
> 时间：2012-09-12T20:11:02.977
> 
> 标签：android, testing, bluetooth

我的任务是将蓝牙设备集成到我的应用程序中。现在我的要求非常具体。该设备有一个特定的通信协议，它依赖于某些 ACK，但我认为如果有一个程序可以让我测试与设备的通信，这将使我的开发变得更加容易。

我想知道是否有适用于 Linux 的程序，或者可能是一个简单的 Android 程序，它可以让我使用我输入的数据通过一系列 ping 与任何蓝牙设备进行通信，并简单地记录响应。

编辑：我的问题可能不够清楚。

我有一个需要集成到我的应用程序中的秤，并且该秤具有与此类似的协议：

从设备获取特定的字节串 传输数据 传输数据包断开连接 接收断开数据包确认 断开连接

现在，当我必须从我的应用程序发出 POST 请求时，我通常会在线构建一个测试脚本，以便测试 POST 是否正常工作。

我想知道我是否可以用该设备做类似的事情。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-14T10:28:00.640

你的问题不够清楚。要与 BT 设备通信，您需要知道您的设备支持的配置文件。根据这一点，您可以在 Android 或 Linux 或 Windows 中找到与设备通信的方法。

最简单的方法是从 android/PC 打开一个 RFCOMM 通道并将数据传输到设备和从设备传输数据。为此，设备必须支持串行端口配置文件 (SPP)。如果您想在 Android 中执行此操作，请查找来自 google的**BluetoothChat示例。**

如果您想使用 PC/mac/linux，请查看**Bluez** python 模块。使用起来真的很简单。还有很多其他的选择。。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-16T16:31:53.217

我正在寻找类似 SENA BTerm 的东西。它让我可以连接到任何设备并发送我想要的任何数据。

它是测试我的代码的一个非常有用的工具。

[http://www.sena.com/download/manual_bterm/overview.html](http://www.sena.com/download/manual_bterm/overview.html)是您可以找到它的地方。

# r - ggplot中具有不等分箱的直方图日期

> ID：12395548
> 
> 赞同：5
> 
> 时间：2012-09-12T20:11:09.883
> 
> 标签：r, ggplot2

我试图让 ggplot 生成一个带有 3 个月宽的箱的直方图。不是 90 天，而是 3 个月。就天数而言，这是一个不等宽的分箱。请注意，每隔 3 个月的刻度线可以正常工作。这是我遇到问题的 bin 宽度。这里有很多讨论，但我找不到解决方案。

[了解日期并在 R 中使用 ggplot2 绘制直方图](https://stackoverflow.com/questions/10770698/understanding-dates-and-plotting-a-histogram-with-ggplot2-in-r)

这是问题的陈述。请注意，我显然可以在 ggplot 之外聚合结果，然后将它们绘制出来，也许是 ggplot 中的因素。但我一直在寻找一个全 ggplot 解决方案。

```
set.seed(seed=1)
dts<-as.Date('2012-01-01') + round(365*rnorm(500))
dts<-data.frame(d=dts)
g<-ggplot(dts,aes(x=d, y=..count..))

#this isnt what I want.  It is 90 days, not 3 months.
#Setting binwidth=' 3 months' also doesnt work
g + geom_histogram(fill='blue',binwidth=90) +
    scale_x_date(breaks = date_breaks('3 months'),  #seq(as.Date('2008-1-1'), as.Date('2012-3-1'), '3 month'),
                 labels = date_format("%Y-%m"),
                 limits = c(as.Date('2010-1-1'), as.Date('2014-1-1'))) +
    opts(axis.text.x = theme_text(angle=90))

#this doesnt work either.
#get:   stat_bin: binwidth defaulted to range/30\. Use 'binwidth = x' to adjust this.
#        Error in `+.Date`(left, right) : binary + is not defined for Date objects
g + geom_bar(fill='blue') +
    stat_bin(breaks=seq(as.Date('2010-1-1'), as.Date('2014-1-1'), '3 month')) +
    scale_x_date(breaks = date_breaks('3 months'),  #seq(as.Date('2008-1-1'), as.Date('2012-3-1'), '3 month'),
                 labels = date_format("%Y-%m"),
                 limits = c(as.Date('2010-1-1'), as.Date('2014-1-1'))) +
    opts(axis.text.x = theme_text(angle=90)) 
```

也许答案是：ggplot 不会创建 3 个月宽（或 N 个月宽）的箱。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T18:53:02.100

正如您所注意到的，`stat_bin`将允许指定 bin 边缘。但在处理日期时，往往需要手动将值转换为内部刻度才能工作。此外，在您的第二个示例中，您同时拥有 a`geom_bar`和 a `stat_bin`，它正在绘制两个不同的图层。这是一个工作版本：

```
g + stat_bin(breaks=as.numeric(seq(as.Date('2010-1-1'), 
                                   as.Date('2014-1-1'), '3 month')),
             fill = "blue",
             position = "identity") +
    scale_x_date(breaks = date_breaks('3 months'),
                 labels = date_format("%Y-%m"),
                 limits = c(as.Date('2010-1-1'), as.Date('2014-1-1'))) +
    opts(axis.text.x = theme_text(angle=90)) 
```

![在此处输入图像描述](../Images/9fe66a6b39cda6d9a03d4e01ac8f8120.png)

请注意，我已将`breaks`参数包装到`stat_bin`in `as.numeric`。另外，我添加了一个`position="identity"`参数来`stat_bin`消除关于不等箱宽度的警告（因为只有一个组，它不需要与任何东西堆叠）。

# sql - 从 SQL Server Profiler（或其他观察者）隐藏语句

> ID：12395551
> 
> 赞同：4
> 
> 时间：2012-09-12T20:11:15.857
> 
> 标签：sql, sql-server, sql-server-2008

在 SQL Server 2008 R2 中，我想执行一条我希望对 SQL Profiler 或其他观察用户查询的方式不可见的语句。有没有办法控制 SQL 探查器显示的内容？

我想执行类似的操作：

```
SELECT 'MyPassword' INTO #passwordTable 
```

我不想通过 SQL Server Profiler 或其他方式显示“MyPassword”。有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-12T20:15:54.037

本质上，不，你不能。您过去可以通过在批处理或语句中添加这样的注释来做到这一点：

```
-- sp_password 
```

但这不再有效。你为什么不*散列*你的密码？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:20:24.707

好吧，你必须是服务器管理员才能运行 SQL Profiler，所以即使你可以阻止它看到命令，用户也可以去获取密码表。理想情况下，您将存储密码的哈希而不是密码，从而使分析器的任何查看都无用。

如果您真的想尝试不让探查器看到这些语句，您可以尝试这样的第三方工具：[http ://www.dbdefence.com/support/dbdefence-documentation/](http://www.dbdefence.com/support/dbdefence-documentation/)

我不知道它是否有效，也不知道那家公司的声誉如何。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T11:24:18.963

Denis，Aaron 是正确的，没有什么比“不可见的语句”更好的了，你不能调整 SQL Profiler 以不显示语句：一旦上船，就可以看到数据库中运行的所有语句。

在将这些敏感数据提交给数据库之前，您需要对其进行模糊处理。有一些混淆的方法可用（单向哈希、对称算法、自制方法），您需要选择更适合您需要的方法并实施。不幸的是，您的案子没有免费午餐...

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-18T11:03:28.207

我看过一个叫做 DBDefence 的产品。它对分析器完全隐藏 SQL 语句。我不知道他们是怎么做到的。我使用免费版本，因为我的数据库很小。

在 SQL Server 的早期版本中，可以添加注释 --sp_password 但在 SQL Server 2008 及更高版本中不能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T20:15:07.570

我看不出重点，真的。如果一个人能够使用 SQL 分析器查看查询，那么他肯定可以访问数据库以查看实际数据。

关键是不要以明文形式存储敏感数据（如密码）。

阻止人们使用 SQL 探查器将归结为在 SQL Server 上应用适当的安全配置。

# css - 为什么 height 在 IE9 中不能与 DropDownList 一起使用，但可以与 Chrome 和 FF 一起使用？

> ID：12395553
> 
> 赞同：0
> 
> 时间：2012-09-12T20:11:28.307
> 
> 标签：css, internet-explorer-9

这是代码

```
select
{
 font-size: 9px; 
 color: Blue; 
 font-weight: bold;
 height: 30px;
} 
```

是否有任何原因它不适用于 IE9。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:16:25.170

取决于您执行此操作的 html 元素类型，但添加 display:block ；给它。这将为 IE 解决问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-14T10:00:49.560

理查德，当您测试自己的代码时，渲染模式是否存在怪癖？我测试了您的代码，我添加的唯一内容是 doctype 和 html 标签，如下例所示：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <style type="text/css">
        SELECT {
        font-size: 9px; 
        color: Blue; 
        font-weight: bold;
        height: 30px;
    }
    </style>
</head>
<body>
    <select name="">
            <option>Test data 1</option>
     </select>
</body>
</html> 
```

# circuit-diagram - 将 Sum 的值转换为 Base 10

> ID：12395554
> 
> 赞同：0
> 
> 时间：2012-09-12T20:11:31.193
> 
> 标签：circuit-diagram

我正在制作一台完全用水的电脑。进展顺利，但我有一个问题。在加法器中，总和存在的地方，我只是在那里收集了水。我不知道如何取两个基数的和值并将它们转换回基数 10 并显示它......任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-06T02:00:18.480

你为什么使用加法器，你的意思是和门控。

![在此处输入图像描述](../Images/87c431623e51db6963080e915c3d25d7.png)![在此处输入图像描述](../Images/27776f0eab5c0ce794bc7b8f532b44fe.png)

不需要加法器。

# db4o - 请解释一下 db4o PolePosition 报告

> ID：12395563
> 
> 赞同：0
> 
> 时间：2012-09-12T20:12:12.150
> 
> 标签：db4o

有人可以在下面的链接中解释我如何阅读 PolePosition 的基准测试结果吗？

[http://polepos.sourceforge.net/results/PolePositionClientServer.pdf](http://polepos.sourceforge.net/results/PolePositionClientServer.pdf)

因此，让我们以上述 pdf 中第 2 页的 ComplexConcurrency 为例。在图表上，它显示时间=60000，更新=2，选择=20，线程=1，写入=3，对象=3。这是否意味着运行这个完整的测试需要 60000 毫秒？测试包括 2 个更新查询、20 个选择查询。该应用程序仅使用 1 个线程。我对吗？对象=3 是什么意思？

在每个条形图的右侧，有 533、430、153 等数字。这些数字代表什么？

我想从 db4o 的角度来理解这份报告。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T07:42:18.900

据我所知（可能完全错误）。

然后像 533、430 等显示的数字显示在 60 秒内运行了多少次操作迭代。

然后其他数字告诉单次迭代完成了什么。它确实喜欢 2 次更新操作，一次迭代中有 20 次选择操作。并且 1 个线程执行这些操作。

但是对于确切的信息，我需要查看代码。

# powershell - Powershell 字符串 split() 上的 AQ

> ID：12395564
> 
> 赞同：0
> 
> 时间：2012-09-12T20:12:16.590
> 
> 标签：powershell, powershell-2.0

我做了像这样的脚本

```
$item_name = $item["Server_Name"]
$result = nslookup $item_name #a nslookup code to get the server's ip
$split = $result.tostring() 
```

Caz 直接使用 split() 会失败，所以我习惯使用 String()，但它显​​示为 System.Object[]

如何从 $result 中获取内容

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:20:24.743

调用可执行文件并将结果存储在变量中将为您提供与输出“行”相对应的字符串*数组中的标准输出。*

通常，如果要将字符串数组的元素组合成单个字符串，请使用`-join <delimiter>`. 如在

```
'one','two','three' -join 'xyz'
'one','two','three' -join "`r`n" 
```

所以你可以做

```
$result = nslookup <servername>
$singleString = $result -join "`r`n"
<process $singleString here> 
```

或者，如果您在输出中搜索特定的字符串模式，我喜欢使用这种模式，它单独处理每一行输出：

```
nslookup <server> |?{ $_ -match 'someregex' } |%{ <use $matches here to process> } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:33:38.490

`-join`除了用于获取字符串数组并创建单个字符串之外，您还可以简单地将 nslookup 的输出通过管道传输到例如`Out-String`：

```
$result = nslookup $server_name | Out-String 
```

# css - 问题：悬停在下拉菜单上

> ID：12395571
> 
> 赞同：0
> 
> 时间：2012-09-12T20:13:00.787
> 
> 标签：css, drop-down-menu

我有一个包含两列的下拉菜单，我希望块内的链接在悬停时更改颜色，但是当我添加样式时，只有顶层`ul`元素起作用并且整个块处于活动状态。我一直在看这个东西太久了，无法弄清楚我需要在哪里添加 `a:hover`.`li`

知道我需要把它放在哪里，这样主链接就没有悬停效果，而下拉菜单有吗？

[全屏](http://ttac.gmu.edu/test/ttac_home)

[jsFiffle](http://jsfiddle.net/jricharc/LYhSg/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:20:40.643

这将使它工作：

```
#top_nav li:hover > a { ... } 
```

因此，只有直接在悬停的 LI 元素内的锚点“变为活动状态”。当您将鼠标悬停在“项目”顶级菜单项时，其锚点会改变颜色，但下拉菜单中的锚点不会。然后，当您将鼠标悬停在该下拉菜单中的某个锚点时，它会改变颜色，因为*它*包含的 LI 元素已被悬停。

# firebase - Firebase 交易错误

> ID：12395573
> 
> 赞同：2
> 
> 时间：2012-09-12T20:13:17.607
> 
> 标签：firebase

我使用 Firebase 在浏览器上的多个用户上共享一些状态，并使用事务。经过一些工作，我开始收到这个奇怪的错误；

> 未捕获的错误：Firebase 内部断言失败：tryToSendTransactionForNode_：队列中的项目都应该运行。firebase.js:29

这是什么意思？似乎收到此错误后，它无法再更新数据了。更奇怪的是交易回报`success=true`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T12:41:03.017

在 node.js 中，您可以通过包装调用来解决此问题：

```
process.nextTick(function() {
    ref.transaction(function(current) {
        current.something = true
        return current
    })
}) 
```

# javascript - 在闭包或本地定义变量，哪个更快？

> ID：12395576
> 
> 赞同：0
> 
> 时间：2012-09-12T20:13:49.320
> 
> 标签：javascript, closures

我在画布上画了一些基本的画，其中 jcanvas 正在进行：

```
this.div.bind("mousedown", function(ev) {
        ev.preventDefault();
        ev.stopPropagation();
        var point= [];
        var pX, pY;
        point[0]= (ev.pageX- this.offsetLeft);
        point[1]= (ev.pageY- this.offsetTop);
        that.div.bind("mousemove", function(ev) {
            ev.preventDefault();
            ev.stopPropagation();
            pX= (ev.pageX- this.offsetLeft);
            pY= (ev.pageY- this.offsetTop);
            that.canvas.drawLine({
                strokeStyle: "#000",
                strokeWidth: 10,
                rounded: true,
                x1: point[0], y1: point[1],
                x2: pX, y2: pY,
            });
            point[0]= pX;
            point[1]= pY;
        });

        that.div.bind("mouseup", function(ev) {
            ev.preventDefault();
            ev.stopPropagation();
            that.div
                .unbind('mousemove')
                .unbind('mouseup');
        });
    }); 
```

注意到我在 mousedown 事件中声明了 pX 和 pY，使它们可以作为绑定到 mouseover 事件的内部函数的闭包来访问。我想知道什么会更快，在鼠标悬停事件中或现在声明它们。

一方面在外部声明这两个变量意味着当调用 mouseover 事件时分配的变量会更少（这是很多次）另一方面实际访问这些变量意味着我需要在两个不同的范围内查找它们.

我想知道 Javascript 中哪个操作较慢。我的直觉说分配应该慢很多，假设 Javascript 引擎对局部变量使用基于堆栈的分配，但我不确定。

# javascript - 我的 django 模板布尔变量在 javascript 中没有按预期工作

> ID：12395579
> 
> 赞同：33
> 
> 时间：2012-09-12T20:13:56.810
> 
> 标签：javascript, django, templates

这是我的 base.html 标头中的代码

```
 <script>
        var auth_status = "{{ user.is_authenticated }}"
    </script>

    {% block scripts %}  {% endblock %} 
```

我网站中的其余脚本都在块脚本中。

在子模板中（在脚本块和脚本标签内）我有这段代码，

```
 if (auth_status) {
          //something
         } 
```

手头的错误是 auth_status 始终为 True，何时应该打开和关闭取决于用户是否登录。Request_context 正在传递给模板，因此这不应该是错误。

谢谢

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2012-09-12T20:28:01.663

因为我看到你的`auth_status`变量似乎是一个字符串，而不是一个布尔值。javascript 上具有非空字符串的变量将评估为`true`子句`if`。

无论如何，像

```
<script>
    var auth_status = {{ user.is_authenticated }};
</script> 
```

将不起作用，因为这将生成此 HTML：

```
<script>
    var auth_status = True;
</script> 
```

因为 Python 的 True 布尔值是大写的。

这应该完成从 Python 到 Javascript 的翻译：

```
<script>
    var auth_status = {{ user.is_authenticated|yesno:"true,false" }};
</script> 
```

在此处查看 yesno 文档：[https ://docs.djangoproject.com/en/dev/ref/templates/builtins/#yesno](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#yesno)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-08-16T13:04:05.127

另一种选择是使用 jinja2[`tojson`](https://jinja.palletsprojects.com/en/2.10.x/templates/#tojson)过滤器：

```
<script>
  let javascript_var = {{ python_var|tojson }};
</script> 
```

您可能还想[`safe`](https://jinja.palletsprojects.com/en/2.10.x/templates/#safe)根据您传递的内容使用过滤器：

```
<script>
  let javascript_var = {{ python_var|tojson|safe }};
</script> 
```

# php - 通过 foreach 循环将对象数组中的值放入关联数组

> ID：12395584
> 
> 赞同：0
> 
> 时间：2012-09-12T20:14:08.353
> 
> 标签：php, object, associative-array

我有一个对象数组，每个对象包含一堆值，其中两个是一个 int 和一个字符串。我需要遍历对象并拉出字符串和 int 并将它们放入关联数组中，其中每个字符串与每个 int 相关联。我该怎么做呢？

这是我到目前为止所拥有的：

```
foreach( $fileobject as $p ) {
    $program_number = $p['number'];
    $filename = $p['InputFile']['filename'];
} 
```

$fileobject 是对象数组。'number' 是 int，'filename' 是字符串。将“数字”和“文件名”放在关联数组中的语法是什么。初始数组中有未确定数量的对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:15:49.647

```
$result = array();
foreach( $fileobject as $p ) {
    $program_number = $p['number'];
    $filename = $p['InputFile']['filename'];
    $result[] = array( 'number' => $program_number, 'filename' => $filename);
} 
```

但是你提到你正在使用一个对象数组，所以这可能是正确的语法：

```
$result = array();
foreach( $fileobject as $p ) {
    $program_number = $p->number;
    $filename = $p->InputFile->filename;
    $result[] = array( 'number' => $program_number, 'filename' => $filename);
} 
```

# git - Git 提交补丁

> ID：12395586
> 
> 赞同：4
> 
> 时间：2012-09-12T20:14:19.133
> 
> 标签：git, git-diff

有没有办法将一系列提交从 Git 导出到补丁中。假设我需要从存储库中导出最后 5 个提交并将它们导入另一个存储库。我该怎么做呢？

对此的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-12T20:18:06.607

`git format-patch`专为此目的而设计：

```
git format-patch --stdout HEAD~5 > ~/patches 
```

输出是一个可读的 BSD 邮箱样式文件，其中包含补丁以及一些元数据，例如提交消息。要将补丁导入其他存储库，请使用`git am`：

```
git am < ~/patches 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:19:03.520

您可以使用 format-patch 选择所需的任何范围

```
git format-patch --stdout R1..HEAD > output.patch 
```

# ruby-on-rails - Rails 更改 new.html.erb 页面的背景

> ID：12395587
> 
> 赞同：1
> 
> 时间：2012-09-12T20:14:23.767
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2

在 index.html.erb 页面上，我使用的是自定义黑色背景。默认情况下，此自定义背景也用于所有其他页面，包括 new.html.erb (_form.html.erb)、edit.html.erb 等页面...

有没有办法更改其他页面（例如 new.html.erb）上其他页面的背景（例如白色背景）？如果是这样，怎么能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:24:53.007

我认为您正在寻找布局： http: [//guides.rubyonrails.org/layouts_and_rendering.html](http://guides.rubyonrails.org/layouts_and_rendering.html)

具体来说，您可以有一个`black_background`和一个`white_background`布局。然后，您只需根据需要使用一种或另一种布局来渲染您的局部。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:24:19.840

我认为最好的方法是为其创建一个新模板并在您需要该背景时使用它

# ios5 - 在辅助功能模式下未检测到手势

> ID：12395588
> 
> 赞同：3
> 
> 时间：2012-09-12T20:14:26.267
> 
> 标签：ios5, accessibility, uigesturerecognizer, voiceover

我正在编写一个应用程序，我需要将标签放在屏幕顶部，并且每当用户触摸它（或在其上方滑动手指）时，我都需要大声读出标签文本。我尝试了以下方法：

首先使标签的可访问性元素 = `YES`。

```
[labelInfo setIsAccessibilityElement:YES]; 
```

但这不起作用。然后我尝试定义许多手势，例如两次触摸、单击；用一根和两根手指等长按，在我写的那个手势类中`UIAccessibilityPostNotification`，这样就可以大声读出文本。但它似乎根本不起作用。我是这样做的：

```
UITapGestureRecognizer *TapOnLabel = [[UITapGestureRecognizer alloc] initWithTarget:labelInfo action:@selector(TapOnLabel:)];
[TapOnLabel setIsAccessibilityElement:YES];
[TapOnLabel setNumberOfTapsRequired:2];
[TapOnLabel setNumberOfTouchesRequired:1];
[labelInfo addGestureRecognizer:TapOnLabel];
[TapOnLabel release];

-(void) TapOnLabel:(UITapGestureRecognizer *)gestureRecognizer
{
  UIAccessibilityPostNotification(UIAccessibilityAnnouncementNotification, @"Where am    I?");
  NSLog(@"%@",labelInfo.text);
} 
```

是否有我遗漏的东西或在可访问性模式下没有手势工作，因为许多都是预定义的。例如。两指两按是音乐开/关等。如果是这种情况，我至少需要滑动才能工作。对此有什么想法吗？

[PS我在这里](https://stackoverflow.com/questions/6583757/ios-gesture-not-detected-due-to-accessibility-settings)看到了类似问题的解决方案。但是缩放手势很特别，对我没有帮助。此外，所有手势类都可以在没有可访问性模式的情况下完美运行，因此它们已正确编写。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-15T00:12:52.197

手势都被 VoiceOver 截取。有一种手势直通模式，您可以在屏幕上双击并按住手指 1 秒。然后，您将听到提示音，并且在您抬起手指或完成一个手势之前，拦截将被禁用。这基本上为您提供了 8 个手势，然后您可以完成 - 四次滑动和四次拖动。

但是话虽如此，为什么您的应用程序需要以这种方式运行？为什么您不能简单地添加辅助功能标签和/或提示，并允许 VoiceOver 焦点和触摸探索工作，因为它们的设计？

# facebook - 在朋友的墙上发布一次通知

> ID：12395597
> 
> 赞同：1
> 
> 时间：2012-09-12T20:15:07.603
> 
> 标签：facebook, fbconnect

我有一个网站，用户只能通过 facebook 登录/连接加入它。

1.  我希望在所有用户（通过 fblogin 加入网站的新用户）朋友墙上发布一次性帖子。该帖子可能类似于“Suresh Adams 加入 abcd 站点，以及其他元数据，例如通常描述该站点的图像、标题和描述”
2.  如果不可能在所有朋友墙上发帖，那么至少必须在用户墙上发帖。

如前所述，这只是在新用户通过 fblogin 加入网站期间发布的一次性帖子。

请让我知道如何完成这项工作以及要求什么权限。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T00:01:48.017

Facebook 不喜欢你在所有朋友源中发布。但你想这样做：

*   请求许可“publish_stream”

*   使用 FQL 获取所有朋友 --> SELECT uid2 FROM friend WHERE uid1 = me()

*   发布（'我/饲料'）

# c# - 使用 C# 更新 Access 表行

> ID：12395602
> 
> 赞同：1
> 
> 时间：2012-09-12T20:15:36.310
> 
> 标签：c#, ms-access

我有一个程序检查 Access DB 中的表的 2 行，并允许用户通过 textBox 对 ComplexityFactor 列进行更改。如果在应用程序加载时行不存在，则创建 2 行（所有字段都相同，除了 OHorUG 字段）。根据他们选择的行，用户可以更改所选行的 ComplexityFactor 字段。我已经能够成功创建和读取行，但我无法更新 1 字段。

这是更新代码：

```
private void button1_Click(object sender, EventArgs e)
    {
        if (listView1.SelectedItems.Count != 0)
        {
            ListViewItem selected = listView1.SelectedItems[0];
            OleDbCommand updateCmd = new OleDbCommand();
            myConnection.Open();

            updateCmd.CommandType = CommandType.Text;
            updateCmd.CommandText = "UPDATE Contractors SET ComplexityFactor = @ComplexityFactor" +
               " WHERE Division = @Division AND ComplexityFactorCode = @ComplexityFactorCode AND ContractNumber = @ContractNumber AND ContractorCode = @ContractorCode AND ContractorName = @ContractorName AND OHorUG = @OHorUG)";

            updateCmd.Parameters.AddWithValue("@ComplexityFactor", textBox1.Text.ToString());//FYI this field is a Number in Access
            updateCmd.Parameters.AddWithValue("@Division", "SV");
            updateCmd.Parameters.AddWithValue("@ComplexityFactorCode", "X01");
            updateCmd.Parameters.AddWithValue("@ContractNumber", "0");
            updateCmd.Parameters.AddWithValue("@ContractorCode", "SSI");
            updateCmd.Parameters.AddWithValue("@ContractorName", "SunStream Inc");
            updateCmd.Parameters.AddWithValue("@OHorUG", selected.SubItems[6].Text.ToString());
            updateCmd.Connection = myConnection;
            updateCmd.ExecuteNonQuery();
            myConnection.Close();
        }
        else
        {
            MessageBox.Show("Please select a row to update...");

        } 
```

我忘了添加例外：

```
System.Data.OleDb.OleDbException was unhandled
  Message=Extra ) in query expression 'Division = @Division AND ComplexityFactorCode = @ComplexityFactorCode AND ContractNumber = @ContractNumber AND ContractorCode = @ContractorCode AND ContractorName = @ContractorName AND OHorUG = @OHorUG)'.
  Source=Microsoft JET Database Engine
  ErrorCode=-2147217900
  StackTrace:
       at System.Data.OleDb.OleDbCommand.ExecuteCommandTextErrorHandling(OleDbHResult hr)
       at System.Data.OleDb.OleDbCommand.ExecuteCommandTextForSingleResult(tagDBPARAMS dbParams, Object& executeResult)
       at System.Data.OleDb.OleDbCommand.ExecuteCommandText(Object& executeResult)
       at System.Data.OleDb.OleDbCommand.ExecuteCommand(CommandBehavior behavior, Object& executeResult)
       at System.Data.OleDb.OleDbCommand.ExecuteReaderInternal(CommandBehavior behavior, String method)
       at System.Data.OleDb.OleDbCommand.ExecuteNonQuery()
       at WindowsFormsApplication1.Form1.button1_Click(Object sender, EventArgs e) in c:\Users\s153720\AppData\Local\Temporary Projects\WindowsFormsApplication1\Form1.cs:line 199
       at System.Windows.Forms.Control.OnClick(EventArgs e)
       at System.Windows.Forms.Button.OnClick(EventArgs e)
       at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)
       at System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)
       at System.Windows.Forms.Control.WndProc(Message& m)
       at System.Windows.Forms.ButtonBase.WndProc(Message& m)
       at System.Windows.Forms.Button.WndProc(Message& m)
       at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
       at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
       at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)
       at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG& msg)
       at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(Int32 dwComponentID, Int32 reason, Int32 pvLoopData)
       at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)
       at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)
       at System.Windows.Forms.Application.Run(Form mainForm)
       at WindowsFormsApplication1.Program.Main() in c:\Users\s153720\AppData\Local\Temporary Projects\WindowsFormsApplication1\Program.cs:line 18
       at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:20:09.517

尝试删除`)`更新语句末尾的右括号

```
updateCmd.CommandText = "UPDATE Contractors SET ComplexityFactor = @ComplexityFactor" +
" WHERE Division = @Division AND ComplexityFactorCode = @ComplexityFactorCode AND ContractNumber = @ContractNumber AND ContractorCode = @ContractorCode AND ContractorName = @ContractorName AND OHorUG = @OHorUG"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:20:23.037

您可能想尝试：

1.  将您的字符串转换为数字 cint 或 cdec
2.  只要防止 SQL 注入攻击，就直接将数字传递到 SQL 中。

# python - Apache bench 和 python BaseHTTPServer 断管异常

> ID：12395609
> 
> 赞同：1
> 
> 时间：2012-09-12T20:15:53.393
> 
> 标签：python, apache, benchmarking, basehttpserver

我有一个用 python 实现的简单 HTTP 服务器，如下所示：

```
from BaseHTTPServer import BaseHTTPRequestHandler, HTTPServer

class Handler(BaseHTTPRequestHandler):
    def do_GET(self):
        self.send_response(200)
        self.send_header('Content-Type', 'text/html')
        self.end_headers()
        self.wfile.write('Hello World!')

if __name__ == '__main__':
    try:
        server = HTTPServer(('', 8000), Handler)
        print 'Listening on 0.0.0.0:8000'
        server.serve_forever()
    except KeyboardInterrupt:
        print '^C, halting'
        server.socket.close() 
```

然后我运行并发级别为 50 的 apache bench：

```
ab -v 3 -c 50 -n 50000 http://localhost:8000/ 
```

我开始在 apache bench 中收到此错误：

> apr_socket_recv：对等方重置连接（104）

在 HTTP 服务器控制台上，我看到了这个：

```
Exception happened during processing of request from ('127.0.0.1', 51545)
Traceback (most recent call last):

  File "/usr/lib/python2.6/SocketServer.py", line 281, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/lib/python2.6/SocketServer.py", line 307, in process_request
    self.finish_request(request, client_address)
  File "/usr/lib/python2.6/SocketServer.py", line 320, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/lib/python2.6/SocketServer.py", line 615, in __init__
    self.handle()
  File "/usr/lib/python2.6/BaseHTTPServer.py", line 329, in handle
    self.handle_one_request()
  File "/usr/lib/python2.6/BaseHTTPServer.py", line 323, in handle_one_request
    method()
  File "./test.py", line 12, in do_GET
    self.send_response(200)
  File "/usr/lib/python2.6/BaseHTTPServer.py", line 384, in send_response
    self.send_header('Server', self.version_string())
  File "/usr/lib/python2.6/BaseHTTPServer.py", line 390, in send_header
    self.wfile.write("%s: %s\r\n" % (keyword, value))
  File "/usr/lib/python2.6/socket.py", line 300, in write
    self.flush()
  File "/usr/lib/python2.6/socket.py", line 286, in flush
    self._sock.sendall(buffer)
error: [Errno 32] Broken pipe 
```

我还注意到 HTTPServer 变得非常缓慢

我试图`request_queue_size`通过这样做来增加 HTTPServer ：

```
from BaseHTTPServer import BaseHTTPRequestHandler, HTTPServer
class MyServer(HTTPServer):
    request_queue_size = 100
    timeout = None

class Handler(BaseHTTPRequestHandler):
    counter = 0

    def do_GET(self):
        self.send_response(200)
        self.send_header('Content-Type', 'text/html')
        self.end_headers()
        self.wfile.write(str(self.counter))
        Handler.counter += 1

if __name__ == '__main__':
    try:
        server = MyServer(('', 8000), Handler)
        print 'Listening on 0.0.0.0:8000'
        server.serve_forever()
    except KeyboardInterrupt:
        print '^C, halting'
        server.socket.close() 
```

但我仍然偶尔会在测试运行结束时遇到管道损坏错误。如果我增加到`request_queue_size`一个巨大的数字，那么错误就会消失。我不明白为什么，因为 Apache bench`-c`值是 50，`request_queue_size`而 100 应该就足够了。为什么`request_queue_size`需要比 Apache bench 并发设置大得多？即使前一个尚未完成，Apache bench 是否会触发更多连接，因此并发连接的总数可能超过`-c`设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-18T15:15:10.443

这是 apachebench 的问题，但不是 httperf 的问题。我不太确定他们处理连接的方式有什么不同。

从默认值（5）增加到 1000。我没有注意到内存有任何巨大的爆炸，性能显着提高，同时消除了错误。

# javascript - 刷新父窗口后无法关闭窗口

> ID：12395616
> 
> 赞同：0
> 
> 时间：2012-09-12T20:16:28.727
> 
> 标签：javascript

我有一个打开一个新选项卡的链接，该选项卡又具有一个 js 链接，该链接应该更新和刷新打开器窗口，然后关闭新选项卡。我试图通过让链接调用这个函数来做到这一点

```
function updatePrev(update){
    window.opener.location = ./prev.html?+update
    window.opener.refresh();
    window.self.close(); //also tried window.close
} 
```

它可以很好地更新打开器窗口，但当前选项卡不会关闭。关于我可能在哪里搞砸的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:20:21.110

你为什么用“自己”？为什么不

```
window.close(); 
```

?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:25:50.263

`self.close()`根据[Quirksmode.org](http://www.quirksmode.org/js/popup.html#prob)尝试

> 有趣的是，self.close() 命令总是正确地关闭弹出窗口，而不是主页。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T19:40:11.597

显然 window.opener.refresh() 正在阻止当前选项卡关闭。没有它，选项卡将关闭并且父（打开器）选项卡会刷新

# css - 对齐 div 中的按钮

> ID：12395618
> 
> 赞同：1
> 
> 时间：2012-09-12T20:16:40.097
> 
> 标签：css

我有一个问题，我只想在图像旁边的蓝色 div 中间显示 2 个链接按钮。

我想要这样的东西

```
link1   {space} link2
{space}
link3    {space} link 4 
```

目前是这样的

```
link1
link2
link3
link4 
```

这是我的代码 HTML

```
<div class="list-wrapper">
<div class="my-background">
    <div class="div1" style="float:left;"> </div>

        <span class="buttons">
         <a class="buttonStyling" href="test.com"><b>Link 1</b></a>
        <a class="buttonStyling" href="test.com"><b>Link 2</b> </a>
         <a class="buttonStyling" href="test.com"><b>Link 3</b> </a>
        <a class="buttonStyling" href="test.com"><b>Link 4</b> </a>
        </span>
</div>​ 
```

CSS

```
.my-background{
    background-color: #8af0fc;
    height: 204px;
}
.div1 {
    height: 205px;
    background:  url(http://www.dynamicdrive.com/dynamicindex4/lightbox2/horses.jpg) no-repeat;
    background-size: 435px;
    font-weight: normal;
    font-family: futura, arial, sans-serif;
    text-align: center;
    width:256px;
    margin-bottom: -20%;
}
.buttons .buttonStyling{

    display: block;
    height: 40px;
    text-align: center;
    line-height: 40px;
    width: 35%;
    float:right;

}

.buttonStyling {

    background: rgb(255, 255, 255); /* Old browsers */
    background: -moz-linear-gradient(top, rgba(255, 255, 255, 1) 33%, rgba(225, 225, 225, 1) 100%); 
    background: -webkit-gradient(linear, left top, left bottom, color-stop(33%, rgba(255, 255, 255, 1)), color-stop(100%, rgba(225, 225, 225, 1)));
    background: -webkit-linear-gradient(top, rgba(255, 255, 255, 1) 33%, rgba(225, 225, 225, 1) 100%);
    background: linear-gradient(top, rgba(255, 255, 255, 1) 33%, rgba(225, 225, 225, 1) 100%);     color: #333;
} 
```

这是jsfiddle

[http://jsfiddle.net/cUWn8/4/](http://jsfiddle.net/cUWn8/4/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:24:15.970

1.  摆脱浮动
2.  添加显示：inline-block
3.  为您需要的间距添加边距

使用这个 CSS

```
.buttons .buttonStyling{

    display: inline-block;
    height: 40px;
    text-align: center;
    line-height: 40px;
    width: 35%;
   margin: 0 50px 50px 0; //or however much space you want
} 
```

这是上述更改的[小提琴](http://jsfiddle.net/jcurran/h3w3N/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:33:06.847

试试这个：http: [//jsfiddle.net/cUWn8/5/](http://jsfiddle.net/cUWn8/5/)

基本上，不要用地毯轰炸所有东西，`float`而是只将其应用于偶数按钮，这将产生您描述的定位。要获得 (1 和 2) 和 (3 和 4) 之间的垂直空间，`margin-top`请在 #2 之后添加按钮。此外，所有按钮都必须是`display: inline-block`.

关键的 CSS 更改是：

```
.buttons .buttonStyling { display: inline-block; }
.buttonStyling:nth-of-type(even) { float: right; }
.buttonStyling:nth-of-type(2) ~ .buttonStyling{ margin-top: 50px; } 
```

加上删除现有`float`属性 on`.buttons .buttonStyling`和 inline on `div1`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T20:33:54.817

清理它并在 .buttons 跨度上设置最大宽度，试试这个：[jsFiddle](http://jsfiddle.net/OldCode101/cUWn8/6/)

# javascript - Uncaught SyntaxError: Unexpected token {

> ID：12395622
> 
> 赞同：0
> 
> 时间：2012-09-12T20:17:28.133
> 
> 标签：javascript, jquery

**当前使用的 jQuery**

```
$("#like_button").live("click", function(){
    var status = $(this).data("status");
    var id = $(this).data("id");
    var count = $(this).html();

        if(status === 1){
            like(id);
            $(this).removeClass("likes");
            $(this).addClass("liked");
            count++;
            $(this).html(count);
        }elseif(status === 2){
            like(id);
            $(this).removeClass("liked");
            $(this).addClass("likes");
            count--;
            $(this).html(count);
        }   else   {
            // do nothing
        }

        return false;

}); 
```

**错误**

```
Uncaught SyntaxError: Unexpected token { (Line 529) 
```

这是下面的这一行，

```
}elseif(status === 2){ 
```

如果您需要更多信息来帮助我，请务必询问。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-12T20:18:09.630

JavaScript 使用`else if`，而不是`elseif`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:22:02.213

阅读本教程以了解有关 if else 语句的更多信息[http://www.w3schools.com/js/js_if_else.asp](http://www.w3schools.com/js/js_if_else.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T20:31:17.747

这个说法

```
}elseif(status === 2){ 
```

必须

```
 }else if(status === 2){ 
```

**在else**和**if**之间缺少一个空格

# c# - 另一个进程正在使用 XML 文件

> ID：12395624
> 
> 赞同：0
> 
> 时间：2012-09-12T20:17:50.883
> 
> 标签：c#, xml, file, process

最近，我开始开发一个在 C# 程序中利用 XML 文档的应用程序。一开始一切都很好，但是当我编辑代码并为程序添加更多功能以防 XML 被删除、损坏等时，程序不想再正常运行了。

提交数据并将其传输到 XML 时使用以下代码：

```
 private void doneCreate_Click(object sender, EventArgs e)
    {
        //Initialize new XMLDocument class.
        XmlDocument XmlDoc = new XmlDocument();

        //See if the card data file is there, if not, create it.
        if (File.Exists(xmlPath) == false)
        {
            using (FileStream createFile = File.Create(xmlPath))
            {
                Byte[] FileData = new UTF8Encoding(true).GetBytes(toBase64("<studycards></studycards>"));
                // Add some information to the file.
                createFile.Write(FileData, 0, FileData.Length);
                createFile.Close();
            }

            XMLData = "<studycards></studycards>";
        }
        else
        {
            XMLData = readXML();

            if (XMLData == "")
            {
                XMLData = "<studycards></studycards>";
            }
            else
            {
                XMLData = fromBase64(XMLData);
            }
        }

        XmlDoc.LoadXml(XMLData);

        XmlElement Group = XmlDoc.CreateElement("Group", null);
        XmlAttribute Group_Attr = XmlDoc.CreateAttribute("Name");
        Group_Attr.Value = groupName.Text;

        Group.Attributes.Append(Group_Attr);

        foreach (string[] Card in CardData)
        {
            try
            {
                FrontData = Card[0].ToString();
                BackData = Card[1].ToString();

                NewCard = XmlDoc.CreateElement("Card");
                FrontElement = XmlDoc.CreateElement("Front");
                FrontElement.InnerText = FrontData;

                BackElement = XmlDoc.CreateElement("Back");
                BackElement.InnerText = BackData;

                NewCard.AppendChild(FrontElement);
                NewCard.AppendChild(BackElement);
                Group.AppendChild(NewCard);
            }

            catch
            {
                break;
            }
        }

        XmlDoc.DocumentElement.AppendChild(Group);

        XmlTextWriter write = new XmlTextWriter(xmlPath, null);
        write.Formatting = Formatting.Indented;
        XmlDoc.Save(write); 
    } 
```

尝试在应用程序中单击“完成”时，出现以下异常：

该进程无法访问文件“C:\Users\Toshiba\documents\visual studio 2010\Projects\StudyCards\StudyCards\bin\Debug\Resources\card_data.xml”，因为它正被另一个进程使用。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:20:26.470

这很可能至少是问题的*一部分*：

```
XmlTextWriter write = new XmlTextWriter(xmlPath, null);
write.Formatting = Formatting.Indented;
XmlDoc.Save(write); 
```

你永远不会关闭作者，所以我希望它保持文件打开。这将阻止未来打开文件的尝试，直到终结器启动。

或者，它可能是`readXML()`您未显示的 的一部分 - 同样，如果这使文件保持打开状态，则会导致问题。

# python - 通过我制作的这两种方法，文本不会在 Python 解释器中打印

> ID：12395625
> 
> 赞同：0
> 
> 时间：2012-09-12T20:18:01.500
> 
> 标签：python

我想调用任一方法（getPerimeter | getArea）并根据提供的输入返回答案。

```
#!usr/bin/python

def getPerimeter(x, y):
    answer = (2 * x) + (2 * y)
    return string(answer)  **This will not return anything in my terminal**
def getArea(x, y):  
    answer = x * y 
    return string(answer)   **This also will not return anything in my terminal**

reply = raw_input("Do you want to find the area or the perimeter? ")

if reply == "area":
    response1 = raw_input("What is the length ?: ")
    response2 = raw_input("What is the width ?: ")
    response1Int = int(response1)
    response2Int = int(response2)
    getArea(response1Int, response2Int)
else:
    response3 = raw_input("What is the length ?: ")
    response4 = raw_input("What is the width ?: ")
    response3Int = int(response3)
    response4Int = int(response4)
    getPerimeter(response3Int, response4Int) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:19:55.127

[`return`](http://docs.python.org/reference/simple_stmts.html#the-return-statement)返回，它没有[`print`](http://docs.python.org/reference/simple_stmts.html#the-print-statement)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T20:20:24.003

从函数返回某些内容不会将其*打印*到屏幕上。尝试`print(getArea(response1Int, response2Int))`并`print(getPerimeter(response1Int, response2Int))`

另外，`string`不是函数。

# android - 如何使用网络服务？

> ID：12395630
> 
> 赞同：1
> 
> 时间：2012-09-12T20:18:42.093
> 
> 标签：android, sql-server, database, web-services, synchronization

我会问一个关于 Web 服务和客户端-服务器架构的半理论问题。

我有一个带有大约 50 个表的数据库的服务器。该服务器甚至包含一个表，其中包含有关与客户端关联的用户的信息。每个客户端都与 db 中所有数据的子集相关联。

定义的架构意味着每个客户端（在 Android 应用程序上运行）调用，以预定义的频率，一定数量的 Web 服务，填充本地数据库，创建驻留在服务器 sb 上的所有表的副本，包含与相关的唯一信息请求的客户。

另外，db server 端的数据是可以变化的，所以需要经常同步。

考虑到客户端应用程序可以想象为在线商店应用程序，因此应该可以浏览提供者、文章、下订单、删除订单等。

所以，当我谈到填充本地数据库时，我的意思是存储提供者、文章……也就是说，所有与请求客户端相关的信息。

用这些信息填充本地数据库有意义吗？

我认为仅在需要信息时才调用 Web 服务更合理，而不是将信息存储在本地数据库中。因此，不再需要同步。

告诉我你在想什么？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:24:15.953

我对 Android 开发一无所知，但在使用 Web 服务和 SOA 方面有大量经验。

以我的经验，尤其是当客户端设备的存储和处理能力有限时，所有的业务逻辑和数据逻辑都应该在 Web 服务中，客户端应用程序仅用于显示和调用这些服务。您如何实施这是我们无法为您回答的问题。每个项目都不一样。

唯一的例外是当您绝对必须让应用程序在未连接时运行。在这种情况下，请确保您了解您的具体要求，并且非常努力地只在客户端保留您绝对需要的数据**，**并且只提供您在断开连接时绝对需要的业务逻辑。

（这也有助于保持安全性更简单 - 丢失或被盗的设备是数据泄露的最高来源之一，因此设备上潜在的敏感数据越少越好。）

我不知道这是否有帮助，但我认为我会把它扔在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T22:57:20.597

如果您的应用程序只能在线工作，那么是的。您无需担心将数据存储到数据库中并稍后检索。如果您的要求需要同时支持在线和离线，那么您必须使用数据库。

您可以运行服务或异步任务或处理程序以从 Android 应用程序调用 Web 服务，这样您的 UI 线程就不会被阻塞。

如果您的响应太大，那么可能您必须考虑中间层，这样您就可以将 SOAP 响应转换为 JSON，这样设备可以更容易地处理响应并且网络传输更快。

我相信根据您的要求，它足以支持仅在线模式......因为如果用户两天不使用该应用程序并重新登录并显示可能不相关的离线数据，数据可能会有所不同

# php - 从 Zend PHP 调用 SQL 过程会给出 @@@@@ 作为结果

> ID：12395634
> 
> 赞同：2
> 
> 时间：2012-09-12T20:19:11.583
> 
> 标签：php, sql, zend-framework, procedure

我最近在 iSeries 上加载了 Zend Server，并试图运行 SQL 存储过程。当我运行常规 SQL 查询时，一切正常。

当我将查询更改为 SQL 存储过程时，一切看起来都在运行，但结果是“@”。

我将我的输出变量设置为“”，并且在调用的过程运行后，该变量为 26“@”，这是我在 DB2 中的字段长度。什么会导致常规 SQL 工作但存储的 SQL 过程给出这个结果？

我将系统值 QCCSID 从 65355 更改为 37 并没有帮助。

# meteor - 在模板中使用 Meteor.renderList 会引发错误

> ID：12395637
> 
> 赞同：-1
> 
> 时间：2012-09-12T20:19:25.277
> 
> 标签：meteor

我试图用它`Meteor.renderList`来呈现某种聊天消息。我使用`Template.foo.rendered`回调方法将 domFragment 添加到列表中。

```
Template.foo.rendered = ->
    list = this.find "ul"
    list.appendChild fragmet 
```

如果我将列表放在`<template name="foo">`Meteor 中，则会在无限循环/递归中引发错误。

```
Uncaught Error: LiveRange start and end must have a parent 
```

我必须使用另一个没有直接连接到`foo`. 从`foo#rendered`回调中附加列表而不是按预期工作。

```
Template.foo.rendered = ->
    document.getElementById("foo").appendChild fragmet # element with id foo not part of template foo 
```

我认为，模板使用的反应式上下文存在问题，并且`renderList`？任何人都知道这是一个错误还是预期的行为？我查看了消息来源，但很快就迷失了；）

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T13:40:47.197

这是有道理的，因为您在呈现模板时将元素附加到模板。因此，每次渲染模板时，它都会将一个元素附加到自身，导致它无限地重新渲染自己。

您确定要呈现列表而不是在模板本身中`Meteor.renderList`使用迭代器吗？`{{each}}`

# macos - Mac OS Mountain Lion - Apache 正在运行但 localhost 不工作

> ID：12395639
> 
> 赞同：8
> 
> 时间：2012-09-12T20:19:54.540
> 
> 标签：macos, apache, unix, localhost, osx-mountain-lion

我使用命令在 Mac OS Mountain Lion 上加载了 Apache Web 服务器

```
sudo apachectl start 
```

但是，当我尝试在 Firefox 中打开 localhost 时，我收到了消息

> 未找到：在此服务器上未找到请求的 URL /。Apache/2.2.21 (Unix) DAV/2 服务器在 localhost 端口 80

我编辑了 httpd.conf 和 httpd.conf.default 来改变

```
#ServerName www.website.com 
```

到

```
ServerName localhost 
```

它仍然不起作用。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T21:08:19.147

要验证进程是否正在侦听端口 80，您可以在终端窗口中使用 lsof：

```
$ sudo lsof -iTCP:80 -sTCP:LISTEN
COMMAND   PID USER   FD   TYPE             DEVICE SIZE/OFF NODE NAME
httpd      88 root    4u  IPv6 0xffffff8018804600      0t0  TCP *:http (LISTEN)
httpd      90 _www    4u  IPv6 0xffffff8018804600      0t0  TCP *:http (LISTEN)
httpd   14843 _www    4u  IPv6 0xffffff8018804600      0t0  TCP *:http (LISTEN) 
```

这将验证您是否成功启用了 apache。

（我安装了 xcode，但我认为 lsof 是正常安装的一部分）

添加：

这确认 apache 正在侦听端口 80。下一步我将查看访问日志，以查看当您请求 '/' 时 apache 记录的内容，如错误 apache 返回到浏览器中所示。这就是我的显示。请注意，http GET 请求显示为返回代码 200（成功）：

```
bash-3.2# grep 'GET / ' /private/var/log/apache2/access_log 
127.0.0.1 - - [12/Sep/2012:16:46:45 -0400] "GET / HTTP/1.1" 200 44
127.0.0.1 - - [12/Sep/2012:16:49:44 -0400] "GET / HTTP/1.1" 200 44 
```

您还可以通过刷新浏览器窗口来确认浏览器请求的 url，然后确认 apache 将该新请求记录到 access_log。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-12T20:47:03.423

您应该检查“httpd.conf”中指定为“DocumentRoot”的文件夹的权限，并至少允许 Apache 用户读取访问权限（默认情况下应该由“_www”访问）。
否则，您可以在“DocumentRoot”文件夹上执行“sudo chmod 755”。
顺便说一句，您应该只修改“httpd.conf”文件，因为“httpd.conf.default”是一个默认配置，如果您想恢复 Apache 原始配置，只需覆盖“httpd.conf”即可。 conf”文件和“httpd.conf.default”文件。
我想您没有启用基于名称的虚拟主机，因为当您启用基于名称的虚拟主机时，主配置中的文档根目录将被忽略；反而，
最后，当您遇到问题时，首先要检查的始终是 Apache 错误日志文件。
通过查看 Apache 配置文件中的“ErrorLog”指令可以找到错误日志的位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-18T16:33:50.873

注释掉所有`IfDefine !WEBSERVICE_ON`标签，保留内容`WEBSERVICE`——Mountain Lion 上没有。

# facebook - 点赞后如何不显示facebook评论？

> ID：12395641
> 
> 赞同：0
> 
> 时间：2012-09-12T20:20:00.877
> 
> 标签：facebook, facebook-like

因此，当我单击“赞”按钮时，我会看到添加一些评论的表单。我想隐藏或阻止显示此表单。怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:32:31.123

See this [Facebook Like Button - how to disable Comment pop up?](https://stackoverflow.com/questions/3247855/facebook-like-button-how-to-disable-comment-pop-up)

Basically you just need to modify the css and hide the comment box after facebook like.

# jquery - jQuery/CSS：让自动完成将其他 div 向下推？

> ID：12395642
> 
> 赞同：1
> 
> 时间：2012-09-12T20:20:00.900
> 
> 标签：jquery, css, tags

我正在使用 xoxco jQuery 标记系统作为标记，它们的自动完成系统用于……等待它……自动完成！[http://xoxco.com/projects/code/tagsinput/](http://xoxco.com/projects/code/tagsinput/)

然后我通过修改 CSS 中的三个不同的类来样式化这个列表：

```
ui-autocomplete
ui-menu-item
ui-corner-all 
```

在这个标签窗口的正下方我有一些其他内容，我的问题是当自动完成列表出现在标签输入下方时，下面的内容不会向下移动，这使得自动完成出现在上面。

**添加：**

示例： http: [//jsfiddle.net/jQm2C/1/show/](http://jsfiddle.net/jQm2C/1/show/) 我想要的是将自动完成列表放在标签内。或者我想要的任何类型的标签。特别是在 div 或 span 标签之间。

我该如何解决这个问题？

**添加＃2：**

在对 jQuery 进行一些研究之后，我想我可以进一步解释我想要做什么。我想将自动完成列表附加到 div 中。虽然我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T16:46:39.437

终于修好了！[http://jsfiddle.net/jQm2C/7/show/](http://jsfiddle.net/jQm2C/7/show/)

我所做的是将自动完成列表的“顶级类”附加到使用此 jQuery 代码`.ui-autocomplete`命名的 div中：`.test`

```
$('.test').append($('.ui-autocomplete')); 
```

然后为列表设置样式，我编写了这个 CSS。出于某种原因，我不能将 CSS 放入 CSS 框中而不使事情停止工作：

```
.ui-autocomplete{
    position: static !important;
    float:none !important;
    display:inline-block;
} 
```

# c# - 通过泛型访问扩展方法总是匹配最不具体的选项？

> ID：12395646
> 
> 赞同：4
> 
> 时间：2012-09-12T20:20:18.513
> 
> 标签：c#, generics, extension-methods

*   有一组我不拥有的类 - 我无法更改它们。
*   我想为每个类添加一个识别参数，使用每个类中的现有字段。
*   因此，我创建了一组扩展方法来从每个类中获取此字段，并为没有特定实现的任何类提供默认值。

这在直接访问新扩展方法时工作得很好（下面示例中的前三个写入），但是当实例首先传递给泛型方法时，选择的扩展方法始终是对象的扩展方法（后三个写入）。

我做错了什么，还是这是 C# 编译器的限制？

```
public class Call { public string Number { get; set; } }
public class Message { public string Address { get; set; } }
public class Unknown { }

public static class Extensions
{
    public static string ID(this object item) { return "Unknown"; }
    public static string ID(this Call item) { return item.Number; }
    public static string ID(this Message item) { return item.Address; }
}

internal class Program
{
    private static void Main()
    {
        var call = new Call { Number = "555-1212" };
        var msg = new Message { Address = "you@email.com" };
        var other = new Unknown();

        // These work just as I would expect
        // - printing out Number, Address, or the default
        System.Console.WriteLine("Call = {0}", call.ID());
        System.Console.WriteLine("Message = {0}", msg.ID());
        System.Console.WriteLine("Unknown = {0}", other.ID());
        System.Console.WriteLine();

        // These all print out "Unknown"
        System.Console.WriteLine("Call = {0}", GetID(call));
        System.Console.WriteLine("Message = {0}", GetID(msg));
        System.Console.WriteLine("Unknown = {0}", GetID(other));
    }

    public static string GetID<T>(T item)
    {
        return item.ID();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T20:22:12.990

重载解决是在*编译时*执行的。编译器一无所知`T`，所以*唯一*适用的重载是这个：

```
public static string ID(this object item) { return "Unknown"; } 
```

如果您想在执行时有效地执行重载解决方案，并且如果您使用的是 C# 4，您可能需要考虑使用`dynamic`- 不幸的是它不直接支持扩展方法：

```
public static string GetID(dynamic item)
{
    return Extensions.ID(item);
} 
```

# sencha-touch-2 - 是否可以在 sencha touch 中向字段集标题添加按钮？

> ID：12395659
> 
> 赞同：1
> 
> 时间：2012-09-12T20:20:43.697
> 
> 标签：sencha-touch-2

我想在字段集标题中添加一个按钮。也许是这样的：

```
var btn = Ext.create('Ext.Button', {
    text: 'my button'
});

...

xtype: 'fieldset',
title: 'my title' + btn 
```

这样的事情可能吗。我真的不想使用委托来为点击事件引用 html。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T20:37:26.827

在场景字段集的标题后面是一个`Ext.Title`组件。所以不要使用

```
{xtype: 'fieldset', title: 'title'... } 
```

但

```
{xtype: 'fieldset', items: [{xtype: 'titlebar', title: 'Title', items: [{xtype: 'button'...}], ...}],... } 
```

干杯，奥列格

# iphone - iPhone 模拟器：为 iPhone 5 设置自定义分辨率？

> ID：12395661
> 
> 赞同：3
> 
> 时间：2012-09-12T20:20:59.470
> 
> 标签：iphone, xcode, resolution, simulator, iphone-5

是否可以在 Xcode 4.4 中欺骗/破解 iPhone 模拟器以获得自定义分辨率，以便能够开始测试/开发新 iPone 5 显示器（1136 x 640px）的应用程序 UI？

还是我们必须耐心等待更新的工具发布？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:34:48.500

是 - 解决方案[http://0xced.blogspot.co.at/2012/08/prepare-your-apps-for-new-iphone.html](http://0xced.blogspot.co.at/2012/08/prepare-your-apps-for-new-iphone.html)

# oracle11g - 如何捕获 ORA-02055，“分布式更新操作失败；需要回滚”并可能找到根本原因

> ID：12395665
> 
> 赞同：4
> 
> 时间：2012-09-12T20:21:12.053
> 
> 标签：oracle11g

在一台 Oracle 服务器上的存储过程中，我尝试将一条记录插入到另一台 Oracle 服务器上的表中，但失败并出现异常“分布式更新操作失败；需要回滚”

尽管我的代码包含在 BEGIN EXCEPTION END 中，但错误处理程序无法捕获错误。

我什至把它扔到了第二个错误处理程序中，但没有任何效果。知道为什么我无法捕捉到这个错误。程序编译没有问题。

我的主要目标是捕获错误，以便我可以返回对我的用户有用的东西。此外，如果可能的话，我想找出错误的根源。

注意 1：如果我取消注释引发“远程错误”的行，那么它会按预期被捕获。

注意 2：与远程服务器的连接是可靠的，因为我可以毫无问题地查询它。

两台服务器都是：Oracle Database 11g Release 11.2.0.3.0 - 64bit Production

```
BEGIN                                                                 
    begin
      --raise_application_error( -20001, 'Remote Error' );
      insert into RemoteSchema.RemoteObject@RemoteSystem
        (field_one, field_two)
        select value_one, value_two from dual;
     exception
       when others then
         raise_application_error( -20000, 'Remote Error:' || sqlerrm );
     end;
 exception
   when others then
     raise_application_error( -20000, 'Caught Remote Error:' || sqlerrm );
 end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T17:08:37.827

经过更多调试后，一位同事帮助我发现了问题。错误消息令人困惑，因为更新实际上是成功的，但成功意味着现在有一个带有“分布式更新”的活动事务。

当我的代码遇到随后的小错误时，Oracle 引发了错误消息“分布式更新操作失败；需要回滚”，因为现在有一个事务需要先回滚，然后我才能引发以下错误。

在我的调试中，我没有看到将我发送到正确方向的完整消息。

# python - 在wxpython中关闭窗口时如何结束线程

> ID：12395666
> 
> 赞同：1
> 
> 时间：2012-09-12T20:21:11.450
> 
> 标签：python, multithreading, wxpython

我正在尝试使用 wxPy 构建一个 GUI 应用程序来执行一些长脚本操作。我已将 GUI 和脚本放在不同的线程中以防止阻塞。这工作得很好，除了在我关闭 GUI 之后，包含脚本的线程仍然在运行。

下面是我的程序的简化版本（对不起，如果代码难以理解或缺少部分，我在缩短程序方面很糟糕）

```
class Form(wx.Frame):
    ...
    def test(self, evt):
        t2 = threading.Thread(target = self.runTest)
        t2.start()
    def runTest(self):
       result = really_long_script()

def main():
   app = wx.App(False)
   form = form(app)
   app.MainLoop()

t1 = threading.Thread(target = main)
t1.start() 
```

有什么办法可以杀死线程吗？现在，当我关闭窗口时，脚本仍在后台运行。

任何帮助将不胜感激！

谢谢，

约翰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T11:31:06.683

如果将线程设置为守护线程，它将与主线程一起死亡。

您可以通过`t2.daemon = True`在调用 start 之前添加该行来执行此操作

**编辑**：检查这个例子，`t.daemon = True`当你关闭框架时线程死了，如果你注释掉那`t.daemon = True`行，框架关闭后线程保持活动状态

```
import wx
import time
from threading import Thread

def print_something_forever(something):
    while True:
        print something
        time.sleep(1)

class Frame(wx.Frame):
    def __init__(self,parent):
        wx.Frame.__init__(self,parent)
        self.panel= wx.Panel(self)
        t= Thread(target=print_something_forever,args=("Thread alive!",))
        t.daemon= True
        t.start()
        self.Show()

if __name__ == "__main__":
    app= wx.App(False)
    Frame(None)
    app.MainLoop() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-16T16:10:52.793

Python 不支持杀死/销毁线程，可能是因为内存泄漏、资源丢失等。

试试这个“线程化类”：D

```
class Run_Other_Thread(threading.Thread):
      "Raises a child thread \
       I'm busy dying, rather lying - _P0W !"
      def __init__(self,func_name,*args): #Constructor
            self._func=func_name
            self._func_args=args
            threading.Thread.__init__(self)
      def run(self): # Start Dying
            try:
                print("\n** Running New Thread :"+self._func.func_name)
            except:
                print("\n** Running New Thread :"+self._func.__name__)
            self._func(*self._func_args)
      def stop(self):
            print('!! Stopped')
      def __del__(self):#Constructor
            try:
                print('\n  @@ Farewell :'+self._func.func_name)
            except:
                print('\n  @@ Farewell :'+self._func.__name__) 
```

您可以将 GUI 运行为：（并尝试关闭）

```
def GUI():
    app= wx.App(False)
    Frame(None)
    app.MainLoop()

if __name__ == '__main__':
      "Tkinter GUI in Thread helps in De-bugging"
      Run_Other_Thread(GUI).start() # Release command window control 
```

# objective-c - 如何导入一个非常大的数组Objective-C

> ID：12395674
> 
> 赞同：3
> 
> 时间：2012-09-12T20:22:22.950
> 
> 标签：objective-c, ios

我正在创建一个 iOS 文字游戏，需要导入英语词典中的每个单词。我必须检查一个字符串是否是数组或集合的一部分，或者它可能是什么。导入和利用数据的最佳和最节省内存的方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:25:35.907

我觉得我在为他们工作，哈哈，但是[LexiconText](http://lexicontext.com)确实有一个非常好的产品，而且确定这个词是否在字典中并不难：

```
Lexicontext *dictionary = [Lexicontext sharedDictionary];
BOOL wordExists = [dictionary containsDefinitionFor:@"MyWord"]; 
```

[**注意：**除了作为一个快乐的客户之外，我与 lexicontext 没有任何关系。]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:25:26.830

您应该使用 sqlite 或其他数据库来存储字典。然后你不必将它全部加载到内存中，而是快速加载单词。

# java - 创建一个带有路径的 HttpClient

> ID：12395676
> 
> 赞同：0
> 
> 时间：2012-09-12T20:22:32.650
> 
> 标签：java, apache-httpclient-4.x, apache-commons-httpclient

我想要一个内置路径的 HttpClient 实例。因此，所有 HttpUriRequest 提供的 URI 不仅会附加到主机和端口，还会附加到路径。

例如，为*http://tempuri.org/path配置 HttpClient 时，* *some/more*的 HttpUriRequest将请求*http://tempuri.org/path/some/more*。

可以将 DefaultHttpClient 配置为执行此操作吗？如果没有，是否有另一个 HttpClient 实现可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:47:54.517

您可以创建自己的类 FixedPathHttpClient 来扩展标准 HttpClient。

在那里，您可以覆盖 executeMethod 以将您的路径附加到方法的路径，然后再将其传递给 super()。

# macos - MAMP、XAMPP 的重定向问题

> ID：12395677
> 
> 赞同：1
> 
> 时间：2012-09-12T20:22:56.687
> 
> 标签：macos, iis, xampp, mamp, windows-7-x64

我一直在我的电脑上创建一个网站。我安装了php，打开了iis，使用了dreamweaver，一切正常，我可以完美地在localhost上测试。但我想在其他地方的网站上工作，比如在我的笔记本电脑或 Mac 台式机上。但是我注意到在我的 Windows 笔记本电脑上使用 XAMPP 等打包软件，在 mac 桌面上使用 mamp 时，在转到下一页时会出现一些问题。假设我有两页，在第 1 页单击提交后它应该带你到第 2 页，在我的电脑上工作得很好，但在笔记本电脑和 Mac 上它只是直接无法继续前进，它只是重定向回第 1 页。有谁知道问题可能是什么以及如何解决？

另外，我的笔记本电脑不会打开 IIS 服务，我去 optionalfeatures.exe 并打开它，它需要一段时间然后说“发生错误，某些功能未启用”。这就是为什么我被迫使用 XAMPP。

# c - 创建结构数组

> ID：12395686
> 
> 赞同：0
> 
> 时间：2012-09-12T20:23:37.170
> 
> 标签：c, arrays, data-structures, linked-list

我一直忙于 C 书中的一个问题。这个问题很简单，但它有一些特定的部分。

我想问一个关于数组的问题。我的问题是关于创建结构数组的最佳方法。问题都想要这些；首先创建一个结构数组。其次，创建一个链表，将这些数组与一个 restp 指针连接起来。我想把我的问题分成几个部分。第一部分是结构数组...如何创建结构数组。我对此进行了研究。这是我的方式：我正在为我的结构数组创建一个结构：

```
struct student{
    int id;
    struct courseList_node_s *restp;
}; 
```

还有我完成其余问题的链接列表：

```
typedef struct courseList_node_s{
    char course[6];
    int credit,
        section;
    struct courseList_node_s *restp;
}courseList_node_t; 
```

我已经实现了一些功能来处理这个学生的日程安排。在我的 get_studentList 函数中；我将我的数组声明为这样；

```
struct student *ansp[size]; 
```

并进行内存分配；

```
ansp[i] = malloc(sizeof(struct student)); 
```

最后赋值；

```
ansp[i]->id =id; 
```

现在，我的问题是在创建数组时，我无法将其作为有序数组。例如，用户可以键入 1111、1222、1232，然后是 1011。所以，我的数组的第一个元素是 ansp[0] = 1011，ansp[1] = 1111。

我想不通。

你能给我一个包含这些的算法吗（创建一个有序的结构数组）。

最后，对不起我的英语不好，我可能会犯一些语法错误......

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:31:10.100

要对元素进行排序，您需要对它们进行排序。在`C`中，您可能想要使用`qsort`（`C++`有更简单的方法）。您将需要定义一个比较函数`struct student *`并用它调用`qsort`您的数组。

请参阅[此示例](http://cboard.cprogramming.com/c-programming/97843-qsort-structure-array.html)以获取灵感。请注意，您的数组是一个结构*指针*数组，该示例是一个直接结构数组（这可能是您想要的吗？）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:36:39.823

> 你能给我一个包含这些的算法吗（创建一个有序的结构数组）。

如果你想创建一个有序的结构数组，你可能想构建一个*tree*。

有一些图书馆，但要学习和理解，你可以谷歌“C中的二叉树”或类似的东西，例如：

[http://www.macs.hw.ac.uk/~rjp/Coursewww/Cwww/tree.html](http://www.macs.hw.ac.uk/~rjp/Coursewww/Cwww/tree.html)

树将允许您的用户插入未排序的值并按排序顺序检索它们（也可以更快地搜索它们）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T22:00:05.807

我已经通过@Keith Randall 和lserni 的帮助解决了这个问题，我已经实现了二叉搜索树和结构数组。

**第一种方式，使用 qsort 对数组进行排序：**

我必须创建一个比较函数：

```
int compare(const void *p1, const void *p2){
    return (* (struct student **) p1)->id - (* (struct student **) p2)->id;
} 
```

还有我的其他辅助功能；

```
void get_studentList(struct student **listp,int size){
    int id,i;
    struct student *ansp[size];
    for(i=0;i<size;i++){
        printf("Enter student's id to exit enter -1> ");
        scanf("%d", &id);
        ansp[i] = malloc(sizeof(courseList_node_t));
        ansp[i]->id = id;
        ansp[i]->restp = NULL;
    }
    qsort (ansp, size, sizeof(struct student *), compare);
    for(i=0;i<size;i++){
        listp[i] = ansp[i];
    }
}

courseList_node_t * insert_studentSchedule(courseList_node_t *headp, int size){
    courseList_node_t *cur_nodep;
    if(headp == NULL){
        cur_nodep = scan_course();
        headp = cur_nodep;
    } else {
        headp->restp = insert_studentSchedule(headp->restp,size);
    }
    return (headp);
} 
```

还有我的显示功能；

```
void display_schedule(struct student **headp, int size){
    courseList_node_t *cur_nodep;
    int i = 0;
    while(i< size){
        cur_nodep = headp[i]->restp;
        printf("Student id > %d\n", headp[i]->id);
        while(cur_nodep != NULL){
            printf("Course name> %s\t", cur_nodep->course);
            printf("Course credit> %d\t", cur_nodep->credit);
            printf("Course section> %d\n", cur_nodep->section);
            cur_nodep = cur_nodep->restp;
        }
        i++;
    }
} 
```

**第二种方式，二叉搜索树：**

我将头文件的 typedef 部分更改为：

```
typedef struct tree_node_s{
    int id;
    struct courseList_node_s *restp;
    struct tree_node_s *leftp, *rightp;
}tree_node_t; 
```

和我的宏来形式化节点动态分配的标准模式：

```
#define TYPED_ALLOC(type) (type *)malloc(sizeof(type)) 
```

还有我创建二叉搜索树的实现：

```
/*
 * Insert a new id in a binary search tree. 
 * Pre: rootp points to the root node of a binary search tree
 */
tree_node_t * get_studentTree(tree_node_t *rootp, int newId)
{
    if (rootp == NULL){
        rootp = TYPED_ALLOC(tree_node_t);
        rootp->id = newId;
        rootp->restp = NULL;
        rootp->leftp = NULL;
        rootp->rightp = NULL;
    } else if ( newId == rootp->id){
        /* */
    } else if (newId < rootp->id){
        rootp->leftp = get_studentTree(rootp->leftp, newId);
    } else {
        rootp->rightp = get_studentTree(rootp->rightp, newId);
    }
    return (rootp);
} 
```

这部分与这个问题无关。我给他们是因为我想分享真实问题的部分解决方案。

```
/*
 * Its aim to add courses to restp component of subtree
 * It may have some problems. And you can omit it. Because it not related with this question
 * Pre: elementp not empty
 */
courseList_node_t * add_course(courseList_node_t *nextp, courseList_node_t *elementp){
        if(nextp->restp == NULL){
            nextp->restp = elementp;
        } else {
            nextp->restp = add_course(nextp->restp,elementp);
        }
        return (nextp);
}

/*
 * It is not neccessary to first call get_studentTree function. It simply creates a linked list which consist of student class/lecture schedule.
 * Pre: ele and id not empty
 * Post: Tree returned includes all schedule and retains binary search tree properties.
 */
tree_node_t * insert_studentSchedule(tree_node_t *rootp,courseList_node_t *ele, int id){
    if (rootp == NULL){
        rootp = get_studentTree(rootp, id);
        rootp->restp = TYPED_ALLOC(courseList_node_t);
        strcpy(rootp->restp->course, ele->course);
        rootp->restp->credit = ele->credit;
        rootp->restp->section = ele->section;
    }
    else if(rootp->id == id){
        if ( rootp->restp == NULL ){
            rootp->restp = TYPED_ALLOC(courseList_node_t);
            strcpy(rootp->restp->course, ele->course);
            rootp->restp->credit = ele->credit;
            rootp->restp->section = ele->section;
        } else {
            rootp->restp = add_course(rootp->restp, ele);
        }

    } else if ( id < rootp->id ){
        if ( rootp->leftp != NULL )
            rootp->leftp = insert_studentSchedule(rootp->leftp, ele, id);
    } else if ( id > rootp->id ) {
        if ( rootp->rightp != NULL )
            rootp->rightp = insert_studentSchedule(rootp->rightp, ele, id);
    }
    return (rootp);
}

/*
 * Course scanning function
 */
courseList_node_t * scan_course(void){
    courseList_node_t *cur_coursep;
    char courseName[6];
    cur_coursep = (courseList_node_t *)malloc(sizeof(courseList_node_t));

    printf("Welcome to course scanning part>\n");
    printf("Enter the name of course> ");
    scanf("%s", courseName);
    strcpy(cur_coursep->course, courseName);
    printf("Enter the credit of course> ");
    scanf("%d", &cur_coursep->credit);
    printf("Enter the section of course> ");
    scanf("%d", &cur_coursep->section);
    cur_coursep->restp = NULL;

    return (cur_coursep);
}

/*
 * My way to print binary search tree with all elements
 */
void display_schedule(tree_node_t *rootp){
    courseList_node_t *cur_course;
    if(rootp == NULL)
        return;
    display_schedule(rootp->leftp);
    if (rootp->restp == NULL)
        printf("Tree with id: %d element has no member!", rootp->id);
    else {
        cur_course = rootp->restp;
        while (cur_course != NULL){
            printf("Student Id> %d\n", rootp->id);
            printf("Course name> %s\t", rootp->restp->course);
            printf("Course credit> %d\t", rootp->restp->credit);
            printf("Course section> %d\n", rootp->restp->section);
            cur_course = cur_course->restp;
        }
    }
    display_schedule(rootp->rightp);
} 
```

它可能无法完全解决书本问题，但在您的帮助下，它是基本部分的解决方案。如果你发现了错误。随意添加评论。

# objective-c - rightBarButtonItem 没有出现在导航栏 iOS

> ID：12395687
> 
> 赞同：16
> 
> 时间：2012-09-12T20:23:43.150
> 
> 标签：objective-c, uinavigationcontroller, uibarbuttonitem, uinavigationitem, rightbarbuttonitem

我在显示导航栏的 rightBarButtonItem 时遇到问题 - 我正在尝试在应用程序委托中以编程方式创建它，我的 UINavigationController 已在其中设置。

代码如下：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

// Override point for customization after application launch.
RSCListViewController *list = [[RSCListViewController alloc] initWithStyle:UITableViewStylePlain];
self.navController = [[UINavigationController alloc] initWithRootViewController:list];

UIBarButtonItem *barButton = [[UIBarButtonItem alloc] initWithTitle:@"+"
                                                              style:UIBarButtonItemStylePlain
                                                             target:list
                                                             action:@selector(addPressed:)];

self.navController.navigationItem.rightBarButtonItem = barButton;

self.window.backgroundColor = [UIColor whiteColor];
[self.window makeKeyAndVisible];

[DatabaseManager openDatabase];

return YES;
} 
```

运行应用程序，导航栏上不会出现任何按钮项。

我不确定我是否遗漏了一些明显的东西——我尝试使用相关的 Stack Overflow 线程来纠正问题并没有取得任何成功。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-09-12T20:42:39.840

您需要将条形按钮项附加到自定义视图控制器，而不是导航控制器。从[更新导航栏](http://developer.apple.com/library/ios/documentation/uikit/reference/UINavigationController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006934-CH3-SW25)：

> 此外，导航控制器对象使用与导航堆栈上的视图控制器关联的导航项（UINavigationItem 类的实例）动态构建导航栏的内容。因此，要更改导航栏的内容，您必须为自定义视图控制器配置导航项。
> 
> (...)
> 
> 导航控制器更新导航栏右侧如下：
> 
> *   如果新的顶级视图控制器具有自定义右栏按钮项，则显示该项。要指定自定义右栏按钮项，请设置视图控制器导航项的 rightBarButtonItem 属性。
>     
>     
> *   如果未指定自定义右栏按钮项，则导航栏右侧不显示任何内容。

因此，替换：

```
self.navController.navigationItem.rightBarButtonItem = barButton; 
```

和：

```
list.navigationItem.rightBarButtonItem = barButton; 
```

# c# - 如何在 C# 中解析字符串？

> ID：12395690
> 
> 赞同：0
> 
> 时间：2012-09-12T20:24:15.627
> 
> 标签：c#, string

在开发评分组件时，我们有一个棘手的难题需要解决。我们有一个 C# 程序，我们从 Oracle 数据库中获取分数，格式为

字段名

字段值

我们将它们解析为两个逗号分隔的字符串。

我们有一个要求，当我们得到一个像“LOW@HIGH”这样一个字段值为“11@21”的字段名时，我们希望将它放入另一个格式为 LOW=11,HIGH=21 的变量中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:27:34.067

首先解析输入：

```
var parts = input.Split('@');
var i1 = int.Parse(parts[0]);
var i2 = int.Parse(parts[1]); 
```

接下来计算结果：

```
return "LOW=" + i1 + ",HIGH=" + i2; 
```

如果你把它分成这两个步骤，问题就变得容易了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:40:47.650

还有一个替代方法，它向您介绍了非常有用的 Zip 扩展方法......

```
string Parse(string fieldName, string fieldValue)
{
  return string.Join( ",",
           fieldName.Split( '@' )
             .Zip( fieldValue.Split( '@' ),
               ( name, value ) => string.Concat( name, "=", value ) ) );
} 
```

所有验证检查都由您决定...

请注意，如果“字段名称”字段包含两个以上的字段名称，则该方法有效。例如，字段名称“LOW@AVERAGE@HIGH”和字段值“11@15@21”会给你`LOW=11,AVERAGE=15,HIGH=21`

这是一个快速而有趣的练习，但我想知道为什么它会像这样非规范化？！

# c# - 从父列表创建子列表

> ID：12395692
> 
> 赞同：1
> 
> 时间：2012-09-12T20:24:19.667
> 
> 标签：c#, linq

我有一组自定义对象，家属。自定义对象有大约 70 个属性。我只想提取一个属性，成员编号。我有以下代码，我在其中提取成员编号并创建另一个列表：

```
var memberIDs = (from d in dependents
                            select new
                                   {
                                       d.MemberNum 
                                   });
            foreach(var id in memberIDs)
            {
                string idValue = id.ToString();
            } 
```

问题是 idValue 以“{ MemberNum = 20044782604 }”的形式出现，而不仅仅是“20044782604”。请让我知道如何解决它。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T20:26:31.383

那是因为您正在使用 MemberNum 作为属性创建一个新的匿名类型。只需选择它。

```
var memberIDs = from d in dependents
                select d.MemberNum; 
```

这将产生一个`IEnumerable<int>`而不是一个`IEnumerable<AnonymousType>`（假设`MemberNum`是 int 类型）。

# php - 使用 PHP“readfile()”嵌入 quicktime 电影

> ID：12395693
> 
> 赞同：0
> 
> 时间：2012-09-12T20:24:20.187
> 
> 标签：php, embed, quicktime, readfile

类似于[https://stackoverflow.com/questions/11554068/embed-quicktime-movie-serve-data-from-php-script](https://stackoverflow.com/questions/11554068/embed-quicktime-movie-serve-data-from-php-script)，我正在尝试嵌入“直接访问保护”的快速电影。我正在使用 .htaccess 拒绝所有直接访问视频的权限。我尝试了多种电影嵌入选项，但使用老式的“对象/嵌入”甚至都行不通。

这是嵌入代码（在 HTML 页面中）：

```
<object classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" width="320" height="256" codebase="http://www.apple.com/qtactivex/qtplugin.cab">
<param name="src" value="/displayVideo.php?video=/path/to/file.mov&type=video/quicktime">
<param name="qtsrc" value="/displayVideo.php?video=/path/to/file.mov&type=video/quicktime">
<param name="autoplay" value="true">
<param name="controller" value="true">
<embed src="/displayVideo.php?video=/path/to/file.mov&type=video/quicktime" qtsrc="/displayVideo.php?video=/path/to/file.mov&type=video/quicktime" width="320" height="256" autoplay="true" loop="false" controller="true" pluginspage="http://www.apple.com/quicktime/"></embed>
</object> 
```

这是“displayVideo.php”文件：

```
 $file = '/path/to/root' . $_GET['video'];
    $type = $_get['type'];

    if(file_exists($file)){
        header('Content-type: ' .$type);    
        header('Content-length: ' . filesize($file));
        header('X-Pad: avoid browser bug');
        header('Cache-Control: no-cache');
        readfile($file);
    }else{
        header("HTTP/1.0 404 Not Found");
    } 
```

问题是 HTML 页面显示“缺少插件”错误。

任何线索我可以如何使用这样的下载...php脚本正确嵌入快速时间？

# javascript - 需要使用 Google Apps 脚本列出 google 域下的所有站点

> ID：12395695
> 
> 赞同：0
> 
> 时间：2012-09-12T20:24:35.657
> 
> 标签：javascript, google-apps-script

我需要使用 Google Apps 脚本列出 google 域下的所有站点。我写了一个小脚本，但它只返回我创建的网站：

```
function list_sites() {
  var doc = DocumentApp.create('SiteList1');
  var domain = 'test.com';
  var sites = SitesApp.getSites(domain);

  doc.appendParagraph("Top");
  doc.appendParagraph(sites);
  doc.appendParagraph("Bottom");

  doc.saveAndClose(); // Save and close the document
} 
```

我如何获得所有网站？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T02:46:31.953

您可以使用 getAllSites 方法。

```
SitesApp.getAllSites(domain, start, max) 
```

我不确定为什么它看起来没有文档，而且不在 API 文档中，但[您可以找到对它的引用，](http://www.google.com/search?q=%22sitesapp.getallsites%22)而且我有每天使用它的生产脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T18:00:07.333

彼得提到的例子对我不起作用，另请参阅这个问题：[为什么 SitesApp.getSites(myDomain) 不起作用？](https://stackoverflow.com/questions/12500256/why-does-sitesapp-getsitesmydomain-not-work) 但我找到了一个也可能对您有所帮助的解决方案：

```
function list_sites() {
  var doc = DocumentApp.create('SiteList1');
  var domain = 'example.com';
  var site = SitesApp.getSite(domain);

  doc.appendParagraph("Top");
  var pages = site.getAllDescendants();
  for (i in pages) {
    doc.appendParagraph(pages[i].getTitle());
  }  

  doc.appendParagraph("Bottom");
  doc.saveAndClose(); // Save and close the document  
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-07T11:51:01.600

[https://gist.github.com/eduvik/46bb72f3ffea57402b3f](https://gist.github.com/eduvik/46bb72f3ffea57402b3f)

需要以管理员用户身份运行

```
function listSites() {
  var domain = UserManager.getDomain();
  var PAGE_LENGTH=200;
  sheet = SpreadsheetApp.getActiveSheet();
  var sites = SitesApp.getAllSites(domain,0,PAGE_LENGTH);
  for(var i=0; sites.length != 0; i+=PAGE_LENGTH){
    for (var j=0; j<sites.length; j++) {
      sheet.appendRow([sites[j].getUrl()]);
    }
    sites = SitesApp.getAllSites(domain, i, PAGE_LENGTH);
  }
}; 
```

# ios - CoreData 可转换类型 - 我可以存储 NSString 或 NSData 吗？

> ID：12395698
> 
> 赞同：0
> 
> 时间：2012-09-12T20:24:44.020
> 
> 标签：ios, core-data

这是情况。我需要存储 NSData（图像）或用于从包中提取图像的字符串。这合法吗？

```
if(aCondition){
    [managedObject setValue:filePath forKey:imageKey];
}else{
    [managedObject setValue:imageData forKey:imageKey];
} 
```

如果这是合法的，那么当需要检索此信息时，我如何确定我最初保存的值类型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T22:27:13.947

将类型设为 NSData（二进制），因此以这种方式保存。假设路径的长度不能超过一些字节（比如 128）并且图像必须超过 500 字节，您可以在请求属性将其转换为字符串或将其保留为数据时做出决定。

如果您不喜欢这种方法，请添加一个布尔值并使用它来指示数据的类型。

# ajax - Backbone.js Backbone.wrapError 函数

> ID：12395699
> 
> 赞同：3
> 
> 时间：2012-09-12T20:24:45.837
> 
> 标签：ajax, backbone.js

这个问题是关于 Backbone 0.9.2

**自从升级到 Backbone 0.9.10 后，我们选择覆盖 Backbone.sync，它就像一个魅力。**

*   **2012 年12 月**- (v0.9.9) Backbone.wrapError 已被删除。
*   **2013 年2 月**- 看起来 WrapError 将在 Backbone 的下一个版本中恢复，但覆盖主干.sync 是要走的路。

（抱歉读了很久）

我正在修改 Backbone.wrapError 函数，我被一行字弄糊涂了。我知道这条线的作用，但不知道为什么它是必要的。

```
 resp = model === originalModel ? resp : model; 
```

*   resp 最终成为 textStatus/errorType 即：“错误”“超时”“解析错误”
*   model 是 XHR 请求对象
*   originalModel 是对最终调用此函数的 Backbone.Model 实例的引用

我很好地掌握了 Backbone.wrapError 的作用、返回的内容以及使用方式，但我似乎无法理解上述行的目的。

* * *

Backbone 的文档指出 wrapError 将“使用回退错误事件包装可选的错误回调”，这是真的。此外，我了解到 Backbone.wrapError 在库中从 fetch、save、destroy 和 reset 函数中调用了 4 次，以确保库不会忽视 AJAX 错误。例如，如果将 AJAX 错误回调传递给 fetch 方法，它将使用传递的几个参数执行，如果没有，模型将使用传递的相同的几个参数触发错误事件。

示例调用：

```
options.error = Backbone.wrapError(options.error, model, options); 
```

Backbone.wrapError：

```
 Backbone.wrapError = function(onError, originalModel, options) {
    return function(model, resp) {
      resp = model === originalModel ? resp : model;
      if (onError) {
        onError(originalModel, resp, options);
      } else {
        originalModel.trigger('error', originalModel, resp, options);
      }
    };
  }; 
```

这行 ( `resp = model === originalModel ? resp : model;`) 出现的问题是 model 和 resp 对应于 jQuery/Zepto 错误回调参数列表中的前 2 个参数。我遇到的第一个问题是这些参数（模型、响应）的命名，因为在调试时我已经看到这两个参数是`jqXHR/xhr`and `textStatus/errorType`。textStatus/errorType 参数通常最终是“错误”，但（根据文档）也可以是“超时”“解析错误”等。比较`model === originalModel`对我来说毫无意义。对 XHR 对象和 Backbone.Model 实例的硬比较总是会失败，并且`model`会存储到`response`(resp) 中，这很好，因为`model`实际上是 XHR 响应对象...这行对我来说似乎毫无意义，但我继续将其包含在我修改后的 wrapError 方法中。

因为`model === originalModel`总是评估为假，所以该行似乎是 resp = model; 的复杂版本。这是没用的，因为您可以完全删除该行，并且`model`可以将参数传递给`originalModel.trigger('error', originalModel, resp, options);`而不是`resp`.

**有没有`model === originalModel`可能评估为真的实例？**

**任何在 Backbone.js、AJAX 方面有更多经验的人都可以回答/解释为什么这条线是必要的？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-13T19:51:23.337

**TLDR/悬崖：**

下面奇怪的小线用于确定错误回调是由模型级别的验证失败或来自 fetch、save 或 destroy 方法（均调用 Backbone.sync）的失败 AJAX 调用触发的天气。如果失败来自验证，它不会更改 resp 变量，因为 resp 应该已经保存了 validate 返回的有用信息（例如错误数组或有关错误的字符串）。如果失败来自错误的 AJAX 请求，则 XHR 对象将存储到 resp 中，因为 XHR 是可用信息最多的项目。不幸的是，XHR 作为模型传递给这个函数，Backbone 文档没有指出这个参数并不总是代表一个模型。Resp 旨在保存有关错误的有用响应信息，并发送到错误回调或抛出的错误事件。

* * *

好的。我学到了一些关于这条奇怪的线的东西。

```
resp = model === originalModel ? resp : model; 
```

在 Backbone 中有 AJAX 错误和验证错误。方便的是，Backbone 将两个错误集中到同一个函数中——AJAX 错误回调。问题是传递给这些函数的参数不一致。当出现 AJAX 错误时，XHR 对象可用，但在验证错误期间不可用。

*   *如果不存在回调，Backbone 将抛出和“错误”事件，其参数与传递给错误回调的参数相同。（下面的第 7 行和第 9 行）。*

在成功的 AJAX 请求之后，您的 JSON 数据可以选择性地通过模型的 validate 函数。在 Backbone 中，验证功能`should return false or nothing at all when there are no errors`。当出现错误时，通常会返回一个数组，例如`['invalid username', 'password too long', 'etc...']`从 validate 返回的任何内容（通常是错误消息数组）作为`resp`参数传递到“包装”错误回调中**，模型本身作为`model`**!

_validate 函数有点草率，有多个 return 语句，但是当验证失败时，第 9 行被命中。函数的第 9 行`_validate`通过`this`（模型）、`error`（从模型验证方法返回）、`options`（ajax 选项、成功、错误、超时等）。这不同于将传入`xhr`（xmlhttprequest 对象）、`errorType`（'error' 'timeout' 'parse error' 等）、`options`（ajax 选项）的 AJAX 错误。

```
validate error:   error(model, validate_return_value, options)
    ajax error:   error(xhr, errorType, options)

1   _validate: function(attrs, options) {
2     if (options.silent || !this.validate) return true;
3     attrs = _.extend({}, this.attributes, attrs);
4     var error = this.validate(attrs, options);
5     if (!error) return true;
6     if (options && options.error) {
7*       options.error(this, error, options);
8     } else {
9       this.trigger('error', this, error, options);
10    }
11    return false;
12  } 
```

上面奇怪的代码行是必要的，因为这个函数处理来自 2 种不同方法的错误。AJAX 和验证。这两个向它发送不同的参数，因此这是为了规范它们并使用一致的参数列表抛出事件。

`When a validation error occurs, the model does not change`所以`model`传递给错误回调的那个**完全**等于`originalModel`. 该`resp`参数的目的是保存有关错误本身的信息。当出现 AJAX 错误时，“超时”“解析错误”或“错误”根本不如 XHR 对象提供信息。

**那条奇怪的小线决定了错误回调是从`_validate`或通过诸如 404 之类的正常 AJAX 错误**访问的天气。当从 validate 访问它时，是从 validate`resp`返回的值。它应该是前端模板显示的信息丰富且有用的数据。当结果错误来自 HTTP 错误时，有关该错误的最有用信息是作为 MODEL 参数传递到此函数的 XHR 对象。

wrapError 和 validate 函数的一种有希望的简化方法

```
 Backbone.wrapError = function(ajax_error_callback, model_or_xhr, ajax_options) {
      return function(model_or_xhr, error_info) {
        if there was an ajax error, error_info = the xhr object
        if there was a validation error, error_info = whatever was returned from validate
        if there's an error callback {
          run the error callback with (the original model, error_info, ajax_options)  as parameters
        if there is not an error callback
          throw an event called 'error' with (the original model, error_info, ajax_options) as parameters
        }
      };
    }; 
```

原来的：

```
 Backbone.wrapError = function(onError, originalModel, options) {
      return function(model, resp) {
        resp = model === originalModel ? resp : model;
        if (onError) {
    *      onError(originalModel, resp, options);
        } else {
          originalModel.trigger('error', originalModel, resp, options);
        }
      };
    }; 
```

* 表示从这里调用的错误回调

# c# - 在 asp.net 应用程序中为子命名空间创建单独的程序集

> ID：12395703
> 
> 赞同：-1
> 
> 时间：2012-09-12T20:24:55.040
> 
> 标签：c#, asp.net, dll, namespaces, .net-assembly

我正在编写一个引用许多程序集的 Web 项目。我想为根命名空间中的子命名空间创建一个单独的程序集，而不创建不同的项目。但我无法做到这一点。我希望你能帮助解决这个问题。我想，要么我可以解释，要么你理解我。

谢谢大家。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:57:20.847

Visual Studio 将每个项目编译为一个 DLL。您不能构建项目并将输出发送到 2 个不同的 dll。

如果您查看 Visual Studio 中的项目属性，则“程序集名称”只有一个字段

最简单的解决方案是将子命名空间中的代码移动到单独的项目中。

# php - 登录时将 NOW() 插入 MySQL 列

> ID：12395706
> 
> 赞同：0
> 
> 时间：2012-09-12T20:25:14.520
> 
> 标签：php, mysql, authentication, login

`DATETIME`当用户登录他们的帐户时，我正在尝试将电流插入 MySQL。屏幕上未显示错误，登录但 NOW() 未插入。我已经检查了 MySQL 中的列声明并且它是正确的——DATETIME

我的PHP在下面

```
 if(isset($_POST['username']) && isset($_POST['password'] )) {         
          $query = mysql_query("SELECT username, password, image_name
                  FROM forum_login
                  WHERE username = '$username'
                  AND password = '$password'") or die (mysql_error());

                  $user = mysql_num_rows($query); 
                      if($user == 1) { 
                  $row = mysql_fetch_assoc($query);
                  $_SESSION['username'] = $row['username'] ;
                  $_SESSION['image_name'] = $row['image_name']  ;

                  $login_time = mysql_query("UPDATE forum_login
                                             SET last_login = 'NOW()'
            WHERE username = '".$_SESSION['username']."'") or die (mysql_error());
              header('Location: http://127.0.0.1/tapmichiana/'); 
              die;
                } 

             else 
             {        

                         echo "<div class='OpenError' >";
                         echo "Username & Password Combination Is Wrong"; 
                         echo "</div>";

                 } 
```

我没有显示用于数据清理和清理的部分脚本

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T20:27:19.173

不要引用`NOW()`。

```
 UPDATE forum_login
 SET last_login = NOW() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:27:28.970

删除 NOW() 周围的引号。这是您想要的函数结果，而不是包含 NOW() 的字符串。

# c# - 我有一个以编程方式设置的样式，我希望在打印时忽略它

> ID：12395708
> 
> 赞同：0
> 
> 时间：2012-09-12T20:25:18.717
> 
> 标签：c#, asp.net, styles

代码很简单：

页面.aspx

```
<body id ="PageBody" runat ="server"> 
```

page.aspx.cs

```
if ($foo == "foo")
{
    PageBody.Style.Add("background-color", "green");
} 
```

我想在打印页面时完全忽略背景颜色（由于各种原因，PC 打印将在其打印设置中打开背景，并且无法禁用）

我在 C# 中没有过多地使用 CSS，所以也许有一种方法可以设置主体以有条件地使用特定的 CSS 对象 ID？如果是这种情况，我可以在 style.css 中设置 BG 颜色并将其留在 print.css 中。

任何帮助是极大的赞赏。

编辑：

进行了更多搜索，但添加属性“class”似乎可以解决问题。

我只是在满足条件时调用我的绿色背景，在不满足条件时调用标准样式。两者在打印样式表中都没有背景颜色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T22:13:54.327

由于特殊性，在元素上添加背景颜色`body`作为样式属性内联（您正在做的方式）会覆盖打印样式表。（[关于 CSS 特性的进一步值得一读的内容在这里](http://css-tricks.com/specifics-on-css-specificity/)。）

要解决此问题，您可以：

1.  不将背景颜色设置为内联样式（可能通过向`body`元素添加 CSS 类并从 CSS 设置样式），或者
2.  `!important`在打印样式表中定义的背景样式之后添加，即在 print.css 中执行：

    ```
    body {
        background-color: transparent !important;
    } 
    ```

# git - Git rebase master 和多个分支

> ID：12395711
> 
> 赞同：3
> 
> 时间：2012-09-12T20:25:32.293
> 
> 标签：git, rebase, git-rebase, git-pull, git-fetch

我有三个分支：master、task_one 和 task_two。我想提取其他人所做的所有更新，并将这些更新应用到我的所有工作中。

正确的命令是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:52:38.573

由于潜在的合并冲突，没有自动“更新所有内容”的好方法。因为这意味着没有简单的“始终保持最新”的好方法，所以下一个要回答的问题是：为什么需要更新？

如果您需要他们进行代码审查，那么

```
git remote update 
```

其次是

```
git log refs/remotes/<remote-name>/<branch-name> 
```

将让您检查其他人发送的提交。

如果您想将它们与您所做的更改集成（您提到变基），那么您只需要在实际对分支进行工作之前进行更改。所以，一旦你检查了你想要处理的分支（并且假设你现在已经准备好集成更改*——不要无缘无故地集成！当你准备好时集成！*）

```
git pull --rebase <remote-name> <remote-branch-name> 
```

将从 <remote-name> 获取 <branch-name>，然后对其进行 rebase。它实际上是（并且等同于）运行的快捷方式：

```
git fetch <remote-name> <remote-branch-name> &&
git rebase <remote-branch-name> 
```

您还可以为任何给定分支设置默认的上游远程/分支，这将允许您简单地键入

```
git pull --rebase 
```

在将来。这对于运行时间较长的主题很有用。要设置默认值，请使用：

```
git branch --set-upstream <local-branch-name> <remote-name>/<remote-branch-name> 
```

总而言之，就是：

*   git checkout <分支>
*   git pull --rebase <远程名称> <远程分支名称>

对于您要更新的每个分支，需要注意的是，我通常建议不要简单地遍历每个分支，直到您真正准备好对其进行工作。

如果“master”正在积极开发中，“remote-master”正在积极开发中（并且应该rebase-to），而“task_one”和“task_two”是基于“master”，而不是直接基于“remote-master” ”，只从“master”而不是任何任务分支中提取 --rebase 可能是有意义的，而是将它们重新设置在 master 之上。例如：

*   git结账大师
*   git pull --rebase <remote> master
*   git checkout <任务分支>
*   git rebase 大师

虽然真的， git pull --rebase <remote> master 与偶尔的 git rebase master 混合在一起，很可能“做正确的事”，具体取决于您历史的复杂性。不要依赖它，但要意识到这种可能性。了解“git patch-id”和“git rebase”如何交互，以及“git rebase”如何在您的工作流程基于该简化之前进行合并，但取决于您的工作流程，这可以为您节省几个步骤。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:31:42.073

I would create a new local branch "merge_work" from master: `git checkout -b merge_work`

Then merge task_one: `git merge task_one`

I would then fix any conflicts then merge task_two `git merge task_two` again fix the conflicts.

Once that is all done move to master `git checkout master`

The merge merge_work: `git merge merge_work`

**Note:** This assumes all your branches are already local.

# xml - 设置以编程方式创建的 XML 文档以在 SharePoint 中使用 InfoPath 模板打开

> ID：12395719
> 
> 赞同：1
> 
> 时间：2012-09-12T20:25:55.083
> 
> 标签：xml, sharepoint, infopath, sharepoint-object-model, form-library

我在获取我以编程方式创建并添加到 SharePoint 中的表单库以使用 InfoPath 模板打开的 XML 文档时遇到问题，而不仅仅是在 Internet Explorer 中作为纯 XML 文档打开。

基本上，我有一个 Web 服务，它检查数据库以查看某些条件是否为真。如果是，则 Web 服务以编程方式创建一个 XML 文档，该文档与前面提到的 InfoPath 模板创建的文件具有相同的 XML 架构。通常的过程是真实用户打开此 InfoPath 模板，填写数据并单击 SUBMIT 按钮，在后台创建 XML 文档并将其保存在表单库中。当用户稍后进入表单库查看该 XML 文档时，该文档会自动使用 InfoPath 模板打开（而不仅仅是在 Internet Explorer 中作为 XML 文档打开）。

我试图找出为什么我从 Web 服务生成的 XML 文档在这方面的行为与从 InfoPath 生成的 XML 文档不同。这是我用来在 Web 服务中创建 XML 文档的代码片段：

```
 //specify path to the SharePoint site and the form library
        var clientContext = new ClientContext("http://urlToSiteContainingTheFormLibrary");
        var site = clientContext.Web;
        clientContext.Load(site);
        var folder = site.GetFolderByServerRelativeUrl("FormLibraryNameHere");
        clientContext.Load(folder);            
        clientContext.ExecuteQuery();

        //create new file to add to the form library
        var fci = new FileCreationInformation();
        var encoding = new System.Text.UTF8Encoding();

        //load the InfoPath document's XML schema from resources file
        var baseXml = XElement.Load(new StringReader(Properties.Resources.BaseXml));
        //fill out the appropriate elements and attributes of the XML here
        //......
        //

        //set remaining properties of the new FileCreationInformation object
        byte[] array = encoding.GetBytes(baseXml.ToString());

        fci.Content = array;
        fci.Overwrite = true;
        fci.Url = "DocumentName"            

        //add the new file to the form library
        var newFile = folder.Files.Add(fci);
        clientContext.Load(newFile);
        var item = newFile.ListItemAllFields;
        clientContext.Load(item);

        //set metadata for the xml file here
        item["HTML_x0020_File_x0020_Type"] = "InfoPath.Document.3";
        item["TemplateUrl"] =
            "http://templateUrlHere/template.xsn?openin=preferclient&amp;noredirect=true&amp;xsnlocation=/templateLocation/template.xsn";
        //set remaining item properties......

        //update changes to the item
        item.Update();

        //commit the changes
        clientContext.ExecuteQuery(); 
```

此时，我的 XML 文档已成功提交到我的表单库，但是当我打开它时，它在 Internet Explorer 中以纯 XML 的形式打开，而不是使用我指定的模板。我假设该项目的 HTML_x0020_File_x0020_Type 和 TemplateUrl 属性将为 SharePoint 指定足够的信息，以便知道它需要使用 InfoPath 模板打开此文件，但也许还有一些其他属性需要我专门设置。有没有人有过类似问题的经验？起初我认为我用于模板的 URL 是错误的，但我直接从通过 InfoPath 模板创建的现有 XML 文档中复制了它，所以我认为这不是问题（我遗漏了任何真实的我上面的示例代码中的 URL 和文件名，所以请忽略这些 URL 不正确的事实）。

提前感谢您的任何回答，感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T03:53:30.883

我知道这个问题被问到已经有一段时间了，但我想我找到了解决方案，或者至少找到了问题所在。

我最近解决了同样的问题。

当下载其中一个显示为 xml 的文件时，当它们实际上是 InfoPath 时，在记事本中打开它显示至少有与真实字符相同数量的空垃圾字符。

事实证明，我正在使用`XmlTextWriter`来写入`MemoryStream`. 在`XmlTextWriter`我正在使用的`Encoding.UTF8`. 将其更改为 Encoding.Default 后，文件已正确保存并显示为 InfoPath。

因此，对于任何有类似问题的人，请检查 xml 文件中的值，如果有空值，请尝试删除并重新上传。然后检查创建文档的代码，如果它是以 UTF8 编写的，请尝试不同的编码，例如 UTF16。

# python - 使用 Twisted Python 锁定 Postgres 表

> ID：12395720
> 
> 赞同：0
> 
> 时间：2012-09-12T20:25:59.700
> 
> 标签：python, postgresql, twisted

我有一个扭曲的守护进程，它可以进行一些 xml 提要解析。

我通过 twisted.enterprise.adbapi 将数据存储在 PostgreSQL 中，IIRC 正在包装 psycopg2

我在将数据存储到数据库时遇到了一些问题——重复数据会定期进入数据库。

老实说，我的实现存在一些潜在的问题，应该重做并设计得更好。不过，我没有时间和资源来做这件事——所以我们现在处于“保持运行”模式。

我认为问题可能来自我对 deferToThread 的使用或我在开始时如何生成服务器。

作为对我认为有问题的功能的快速概述：

Twisted 查询 Postgres 以获取应分析的帐户，并对其设置块

```
SELECT 
    id 
FROM 
    xml_sources 
WHERE 
    timestamp_last_process < ( CURRENT_TIMESTAMP AT TIME ZONE 'UTC' - INTERVAL '4 HOUR' ) 
    AND
    is_processing_block IS NULL ;

lock_ids = [ i['id'] for i in results ]

UPDATE xml_sources SET is_processing_block = True WHERE id IN %(lock_ids)s 
```

我认为正在发生的事情是（意外地）运行多个服务器或各种其他问题导致多个线程处理这些数据。

我认为如果我将这个快速部分包装在一个独占表锁中，这可能会得到解决——或者至少被排除为一个问题。

不过，我以前从未通过扭曲完成表锁定。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T23:28:37.227

您可以执行 a[`SELECT FOR UPDATE`](http://www.postgresql.org/docs/current/static/sql-select.html#SQL-FOR-UPDATE-SHARE)而不是 plain `SELECT`，这将锁定查询返回的行。如果你真的想要*表*锁定，你可以发出一个[`LOCK`](http://www.postgresql.org/docs/current/static/sql-lock.html)语句，但根据你的其余问题，我认为你想要行锁定。

如果您正在使用`adbapi`，请记住，[`runInteraction`](http://twistedmatrix.com/documents/12.2.0/api/twisted.enterprise.adbapi.ConnectionPool.html#runInteraction)如果您想在事务中运行多个语句，则需要使用。传递给的函数`runInteraction`将在一个线程中运行，因此您可能需要使用`callFromThread`或[`blockingCallFromThread`](http://twistedmatrix.com/documents/12.2.0/api/twisted.internet.threads.blockingCallFromThread.html)从数据库交互返回到反应器。

但是，锁定可能不是您的问题。一方面，如果您正在混合`deferToThread`和`adbapi`，则可能有问题。 `adbapi`已经在`deferToThread` *为*你做相当于。您应该能够在主线程上执行所有操作。

不过，您必须包含一个具有代表性的示例才能获得更具体的答案。考虑一下您的问题：基本上是“有时我会收到重复的数据，并且执行过程自认存在问题，这很大，我无法修复，也无法向您展示。” 这不是一个可以回答的问题。

# javascript - 可以从 Chrome 扩展程序修改窗口对象吗？

> ID：12395722
> 
> 赞同：47
> 
> 时间：2012-09-12T20:26:03.927
> 
> 标签：javascript, google-chrome-extension

我想制作一个 Chrome 扩展程序，它在内部提供一个新对象`window`。当在加载了扩展程序的浏览器中查看网页时，我希望`window.mything`通过 Javascript 可用。该`window.mything`对象将具有一些我将在扩展中定义的函数，并且`console.log`当在启用了扩展的浏览器中查看页面时，这些函数应该可以从任何 Javascript 文件中调用。

[我能够通过使用内容脚本](http://developer.chrome.com/extensions/content_scripts.html)成功地将 Javascript 文件注入页面：

```
var s = document.createElement("script"); 
s.src = chrome.extension.getURL("mything.js");
document.getElementsByTagName("head")[0].appendChild(s); 
```

mything.js 看起来像这样：

```
window.mything = {thing: true};
console.log(window); 
```

每当页面加载时，我都会看到整个`window`对象，就像我期望它在控制台中一样。但是，我无法`window.mything`从控制台与对象交互。似乎注入的脚本没有真正修改全局`window`对象。

如何`window`从 Chrome 扩展中修改全局对象？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-09-12T21:08:39.803

你不能，不能直接。从[内容脚本文档](http://developer.chrome.com/extensions/content_scripts.html)：

> 但是，内容脚本有一些限制。他们不能：
> 
> *   使用 chrome.* API（chrome.extension 的部分除外）
> *   使用由其扩展页面定义的变量或函数
> *   **使用由网页或其他内容脚本定义的变量或函数**

（重点补充）

`window`内容脚本看到的对象`window`与页面看到的对象不同。

`window.postMessage`但是，您可以使用该方法通过 DOM 传递消息。您的页面和内容脚本都会监听**消息**事件，并且每当您`window.postMessage`从其中一个地方调用时，另一个地方都会收到它。“内容脚本”文档页面上有一个[示例。](http://developer.chrome.com/extensions/content_scripts.html#host-page-communication)

编辑：您可以通过从内容脚本注入脚本来向页面添加一些方法。尽管不使用类似的东西，它仍然无法与扩展的其余部分进行通信`postMessage`，但您至少可以在页面的`window`

```
var elt = document.createElement("script");
elt.innerHTML = "window.foo = {bar:function(){/*whatever*/}};"
document.head.appendChild(elt); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2019-08-02T00:36:17.703

经过数小时尝试不同的尝试并面临 CORS 等安全问题后，我找到了`window`在和. 您需要对每种策略使用不同的策略：`Chrome``Firefox``Safari`

## 铬合金

1.  将您的脚本添加到`content_scripts`.
2.  在您的脚本文件中，将 a 附加`script`到页面并使其内联运行您的自定义代码。像这样：

```
;(function() {
  function script() {
    // your main code here
    window.foo = 'bar'
  }

  function inject(fn) {
    const script = document.createElement('script')
    script.text = `(${fn.toString()})();`
    document.documentElement.appendChild(script)
  }

  inject(script)
})() 
```

## 火狐

`Content-Security-Policy`在 Firefox 上，由于错误，上述解决方案不起作用。但是以下解决方法目前正在起作用，至少目前是这样：

1.  将 2 个脚本添加到`content_scripts`，例如`inject.js`和`script.js`
2.  该`inject`脚本将获取文件的完整绝对**url**`script.js`并加载它：

```
;(function() {
  const b = typeof browser !== 'undefined' ? browser : chrome

  const script = document.createElement('script')
  script.src = b.runtime.getURL('script.js')
  document.documentElement.appendChild(script)
})() 
```

3.  您的`script.js`将包含您的主要代码：

```
;(function() {
  // your main code here
  window.foo = 'bar'
})() 
```

## 苹果浏览器

它与 Firefox 非常相似。

1.  创建 2 个 javascript 文件，例如`inject.js`和`script.js`
2.  该`inject`脚本将获取文件的完整绝对**url**`script.js`并加载它：

```
;(function() {
  const script = document.createElement('script')
  script.src = safari.extension.baseURI + 'script.js'
  document.documentElement.appendChild(script)
})() 
```

3.  您的`script.js`将包含您的主要代码：

```
;(function() {
  // your main code here
  window.foo = 'bar'
})() 
```

## 源代码

在此处查看完整代码：[https ://github.com/brunolemos/simplified-twitter](https://github.com/brunolemos/simplified-twitter)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2018-10-12T01:54:51.253

正如其他人指出的那样，上下文脚本不会在与页面相同的上下文中运行，因此，要访问正确的`window`，您需要将代码注入页面。

这是我的看法：

```
function codeToInject() {
    // Do here whatever your script requires. For example:
    window.foo = "bar";
}

function embed(fn) {
    const script = document.createElement("script");
    script.text = `(${fn.toString()})();`;
    document.documentElement.appendChild(script);
}

embed(codeToInject); 
```

清洁且易于使用。无论您需要在页面上下文中运行什么，都将其放入`codeToInject()`（您可以随意称呼它）。该`embed()`函数负责打包您的函数并将其发送到页面中运行。

该`embed()`函数的作用是`script`在页面中创建一个标签并将该函数`codeToInject()`作为[IIFE](https://developer.mozilla.org/en-US/docs/Glossary/IIFE)嵌入其中。浏览器将在新标签附加到文档后立即执行`script`它，并且您注入的代码将按预期在页面上下文中运行。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-01-25T06:50:25.717

chrome 扩展程序`content_script`在其自己的上下文中运行，该上下文与窗口分开。您可以将脚本注入到页面中，以便它在与页面窗口相同的上下文中运行，如下所示：[Chrome 扩展 - 从网页中检索全局变量](https://stackoverflow.com/questions/9602022/chrome-extension-retrieving-global-variable-from-webpage#answer-9636008)

我能够调用窗口对象上的方法并通过将 a 添加`script.js`到页面的 DOM 来修改窗口属性：

```
var s = document.createElement('script');
s.src = chrome.extension.getURL('script.js');
(document.head||document.documentElement).appendChild(s);
s.onload = function() {
    s.remove();
}; 
```

并在注入的脚本文件中创建自定义事件侦听器：

```
document.addEventListener('_my_custom_event', function(e) {
  // do whatever you'd like! Like access the window obj
  window.myData = e.detail.my_event_data;
}) 
```

并在 content_script 中调度该事件：

```
var foo = 'bar'
document.dispatchEvent(new CustomEvent('_save_OG_Editor', {
  'detail': {
    'my_event_data': foo
  }
})) 
```

或相反亦然; 在扩展程序的 content_script 中分派事件`script.js`并监听它们（如上面的链接所示）。

只需确保在扩展文件中添加注入的脚本，并将脚本文件的路径添加到[清单中，`"web_accessible_resources"`](https://developer.chrome.com/extensions/manifest/web_accessible_resources)否则会出错。

希望对某人有所帮助\ (•◡•) /

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-04-12T01:40:24.830

我一直在玩这个。我发现我可以通过将我的 javascript 包装到 window.location= 调用中来与浏览器的窗口对象进行交互。

```
var myInjectedJs = "window.foo='This exists in the \'real\' window object';"
window.location = "javascript:" + myInjectedJs;

var myInjectedJs2 = "window.bar='So does this.';"
window.location = "javascript:" + myInjectedJs2; 
```

它有效，但仅适用于设置的 window.location 的最后一个实例。如果您访问文档的窗口对象，它将有一个变量“bar”但没有“foo”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-10-02T15:29:12.680

感谢这里的其他答案，这就是我正在使用的：

```
((source)=>{
  const script = document.createElement("script");
  script.text = `(${source.toString()})();`;
  document.documentElement.appendChild(script);
})(function (){

  // Your code here
  // ...

}) 
```

效果很好，没有问题。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-10-23T11:54:22.897

内容脚本**可以**调用`window`可以用来改变`window`对象的方法。这比`<script>`标签注入更容易，即使在`<head>`和`<body>`还没有被解析时（例如使用 时`run_at: document_start`）也能工作。

```
// In Content Script
window.addEventListener('load', loadEvent => {
    let window = loadEvent.currentTarget;
    window.document.title='You changed me!';
}); 
```

# json - 包含抽象属性的 JSON (Jackson) 的 JAXB 注释类

> ID：12395724
> 
> 赞同：2
> 
> 时间：2012-09-12T20:26:06.640
> 
> 标签：json, jaxb, jackson

使用以下类构成我在 JAX-RS 调用 (CXF) 后传输到客户端的 JSON 消息结构，我收到

```
org.apache.cxf.jaxrs.client.ClientWebApplicationException: .Problem with reading the response message, class : class bg.vivacom.sel.dto.SELResponse, ContentType : application/json.
...
Caused by: org.codehaus.jackson.map.JsonMappingException: Can not construct instance of bg.vivacom.sel.dto.SELDTO, problem: abstract types can only be instantiated with additional type information
 at [Source: sun.net.www.protocol.http.HttpURLConnection$HttpInputStream@16edbe39; line: 1, column: 157] (through reference chain: bg.vivacom.sel.dto.SELResponse["dto"]) 
```

返回的对象包含属性**dto**，它是一个接口

```
@XmlRootElement(name = "SELResponse")
public class SELResponse implements Serializable{

@XmlElement(name = "corelationID")
private String corelationID;

@XmlElement(name = "responseTimeStamp")  
private String responseTimeStamp;

@XmlElement(name = "respStatusCode")  
private String respStatusCode;

@XmlElement(name = "respStatusMessage")  
private String respStatusMessage;

@XmlElement(name = "processStatus")  
private ProcessStatus processStatus;

@XmlElement(name = "dto")  
private SELDTO dto; 
```

界面

```
public interface SELDTO extends Serializable { 
```

是一种根据请求在我的答案中包含许多不同 DTO 的方法，例如

```
@XmlRootElement(name = "customerProfile")
public class CustomerProfileDTO implements SELDTO {

@XmlElement(name = "customerCode")
private String customerCode;
... 
```

和

```
@XmlRootElement(name = "sms")
public class SmsDTO implements SELDTO {

@XmlElement(name = "From")
private String from;
... 
```

任何想法我必须如何注释类，以便可以将响应正确设置为特定的对象类型。我知道它在重新创建不知道其类型的 dto 对象时需要其他信息，因此我尝试如下注释接口：

```
@XmlSeeAlso({CustomerProfileDTO.class, SmsDTO .class})
public interface SELDTO extends Serializable { 
```

但我仍然得到这个问题。任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T21:21:44.637

对于这种情况，我建议使用 Jackson 注释“@JsonTypeInfo”。

但是，如果您必须使用 JAXB 注释，请使用`@XmlElements`或`@XmlElementRefs`类似于您在 JAXB/XML 中使用它们的方式：

```
 @XmlElements({
             @XmlElement(type=SubClass1.class, name="sub1"),
             @XmlElement(type=SubClass2.class, name="sub2")
     }) 
```

请注意，您必须在此处包括到可能的子类型的特定映射。

# ruby-on-rails - Rails - 如何避免必须从另一个控制器中的创建操作触发一个控制器中的创建操作

> ID：12395728
> 
> 赞同：3
> 
> 时间：2012-09-12T20:26:27.670
> 
> 标签：ruby-on-rails, model-view-controller, controller, action

在这里原谅一个基本问题。

通过阅读，我了解到从另一个控制器触发创建操作不是最佳实践 - 我正在寻找有关在以下情况下如何组织代码的建议：

> 我有两个控制器：案例和通知。
> 
> 创建新案例时，我希望它也创建一个新通知。
> 
> 通知创建操作在其模型中创建一个新实例，并发送一封电子邮件。

我认为我不应该只是从我的案例控制器调用 Notification#create 是否正确？我应该将其提取到帮助程序或模块中吗？如果是这样，它会是什么样子？关于这个主题的其他大致相似的帖子没有详细说明。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T02:28:04.130

由于 create 是一种 POST 方法，我认为没有办法从案例控制器调用通知控制器的创建。我的建议是将通知实例的创建和发送邮件逻辑移动到您的案例模型的保存之前。这将在每次创建案例时创建一个通知，并且还会处理邮件发送机制。由于这是您业务需求的一部分，因此最好将业务逻辑移动到您的模型中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T02:42:14.617

这个逻辑应该在你的模型中。好的解决方案是使用 ActiveRecord 回调。

```
# app/models/case.rb
class Case < ActiveRecord:Base
  after_create :create_notification

private        # <--- bottom of your model
  def create_notification
    Notification.create!(some_options_for_notification)
  end
end

# app/models/notification.rb
class Notification < ActiveRecord:Base
  after_create :send_notification

def send(opts)
  ...          # <--- some logic to send notification here
end

private        # <--- bottom of your model
  def send_notification
    send(some_options_for_sending)
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-13T12:08:12.113

作为选项之一，您可以使用 rails 观察者来创建通知[http://api.rubyonrails.org/classes/ActiveRecord/Observer.html](http://api.rubyonrails.org/classes/ActiveRecord/Observer.html)

观察者和回调之间几乎没有区别，例如观察者不能取消任何模型动作，但在你的情况下，我认为无论如何都可以使用。

但观察者也曾经坚持单一职责原则。

例子

```
class CaseObserver < ActiveRecord::Observer
 def after_create(case)
    #create notification
 end
end 
```

应该保存到`/app/models/case_observer.rb.`

在你的`config/application.rb`

```
config.active_record.observers = :case_observer 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T20:40:03.550

您只需要在您的案例控制器操作中编写 Notification.create 即可。

您可以根据需要编写尽可能多的代码，在控制器操作中创建尽可能多的模型。

# c# - 内置在 app.exe 中的 Updater.exe

> ID：12395730
> 
> 赞同：-1
> 
> 时间：2012-09-12T20:26:32.840
> 
> 标签：c#, .net, wpf

目前我有2个exe文件。app.exe 和 updater.exe。当 app.exe 发现有新版本可用时，它会运行 updater.exe，它会下载并替换它。

我想知道是否可以将 updater.exe 构建到 app.exe 中。在应用程序启动时，它应该检查目录中是否有 updater.exe，如果没有，则将其解压缩。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:41:00.310

您可以将 updater.exe 作为*资源*集成到 app.exe 中。以下 SO 帖子显示了如何在运行时提取它：

*   [在 C# 程序中嵌入外部可执行文件](https://stackoverflow.com/q/798655/87698)

请注意，如果您的应用程序位于默认应用程序目录（`C:\Program Files`或更一般地说，`%ProgramFiles%`）中，您将无权在同一目录中创建文件（这是一件好事）。因此，您可能需要将 updater.exe 提取到当前用户具有写入权限的临时目录中（例如[Path.GetTempPath](http://msdn.microsoft.com/en-us/library/system.io.path.gettemppath)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:49:46.150

有关遍历和列出目录内容，请参阅[http://msdn.microsoft.com/en-us/library/system.io.directory.aspx](http://msdn.microsoft.com/en-us/library/system.io.directory.aspx)

要访问您的嵌入式资源，请参阅[http://msdn.microsoft.com/en-us/library/xc4235zt.aspx](http://msdn.microsoft.com/en-us/library/xc4235zt.aspx)

要将二进制数据写入磁盘，请参阅[http://msdn.microsoft.com/en-us/library/system.io.binarywriter.aspx](http://msdn.microsoft.com/en-us/library/system.io.binarywriter.aspx)

要从磁盘运行 exe，请参阅[http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T20:32:40.583

当我正确理解您时，您需要将 updater.exe 作为资源打包到 app.exe 中。解压它，当 App.exe 启动时。

但我可以告诉你，这个带有替换的想法很糟糕。您应该选择一个 MSI 包来部署您的应用程序。

# symfony - 在 symfony2 中使用 twig 向路径请求添加属性

> ID：12395737
> 
> 赞同：6
> 
> 时间：2012-09-12T20:27:19.823
> 
> 标签：symfony, twig, routes

我一直在用谷歌搜索这个问题，但我找不到有同样问题的人......而且我不认为我是这里唯一的人>。<

让我们看看，我在 symfony2 中使用翻译。我需要为此使用树枝...问题是我需要 3 个链接，以便人们可以更改网站的语言。该链接必须重定向到用户所在的同一页面，但要更改“_locale”。

我首先想到的是这样的：

```
// in routing.yml
bundleStuff_someUrl:
    pattern:  /{_locale}/aloha
    defaults: { _controller: bundleStuff:Aloha:foo }

bundleStuff_fooUrl:
    pattern:  /{_locale}/foo/{fooParam}
    defaults: { _controller: bundleStuff:Foo:foo }

// in view.html.twig
<a href="{{ path((app.request.get('_route'), { '_locale': 'l1' }) }}">lang1</a>
<a href="{{ path((app.request.get('_route'), { '_locale': 'l2' }) }}">lang2</a>
<a href="{{ path((app.request.get('_route'), { '_locale': 'l3' }) }}">lang3</a> 
```

当（在这种情况下）_route 是 fooUrl 时，问题就变成了......有没有办法将我在当前视图中的每个属性附加到我正在寻找的路径中？换句话说，参考这个例子：如果当前视图是'fooUrl'，有没有办法让twig知道它必须将'fooParam'添加到路径中？

提前致谢！希望这篇文章有用！:D

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-12T21:13:37.600

`_route_params`request 属性保存当前路由的参数。所以树枝代码是，

```
{% set route = app.request.get('_route') %}
{% set route_params = app.request.get('_route_params') %}

<a href="{{ path(route, route_params | merge({ '_locale': 'l1' })) }}">lang1</a>
<a href="{{ path(route, route_params | merge({ '_locale': 'l2' })) }}">lang2</a>
<a href="{{ path(route, route_params | merge({ '_locale': 'l3' })) }}">lang3</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T07:41:26.373

对于 symfony 2.0，你可以在控制器中获取 _locale 变量，然后在发送变量之后。

例如

控制器：

```
 $language = $this->getRequest()->get('_locale'); 
    $this->$this->redirect($this->generateUrl('bundleStuff_someUrl', array('language' => $language))) 
```

在 routing.yml 之后

bundleStuff_someUrl：模式：/{language}/aloha 默认值：{ _controller: bundleStuff:Aloha:foo }

# python - 排序后填充唯一 ID 字段，Python

> ID：12395738
> 
> 赞同：0
> 
> 时间：2012-09-12T20:27:19.900
> 
> 标签：python, sorting, updates, arcpy

我正在尝试在访问表中创建一个新的唯一 id 字段。我已经有一个名为 的字段`SITE_ID_FD`，但它是历史性的。该字段中唯一值的格式不是我们当前的格式，因此我正在使用新格式创建一个新字段。

```
Old Format = M001, M002, K003, K004, S005, M006, etc

New format = 12001, 12002, 12003, 12004, 12005, 12006, etc 
```

我写了以下脚本：

```
fc = r"Z:\test.gdb\testfc"

x = 12001

cursor = arcpy.UpdateCursor(fc)

for row in cursor:
    row.setValue("SITE_ID", x)
    cursor.updateRow(row)
    x+= 1 
```

这很好用，但它会根据 objectID 的默认排序填充新的 id 字段。我需要先对 2 个字段进行排序，然后根据该排序填充新的 id 字段（我想先按一个名为的字段排序`SITE`，然后再按旧的 id 字段`SITE_ID_FD`）

我尝试手动对 2 个字段进行排序，希望 Python 能够接受排序，但事实并非如此。我不确定如何在 Python 中执行此操作。任何人都可以提出一种方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T11:04:43.937

一个可能的解决方案是在您创建更新游标时。您可以向光标指定您希望对其进行排序的字段（对不起我的英语......），他们在文档中对此进行了解释：http: [//help.arcgis.com/en/arcgisdesktop/10.0/help/ index.html#//000v0000003m000000](http://help.arcgis.com/en/arcgisdesktop/10.0/help/index.html#//000v0000003m000000)

所以它是这样的： `UpdateCursor(dataset, {where_clause}, {spatial_reference}, {fields}, {sort_fields})` 并且您只对 sort_fields 感兴趣，因此假设您的代码在排序表上运行良好并且您希望该表按代码的第二部分升序排列应该如下所示：

```
fc = r"Z:\test.gdb\testfc"

x = 12001

cursor = arcpy.UpdateCursor(fc,"","","","SITE A, SITE_ID_FD A") 
#if you want to sort it descending you need to write it with a D 
#>>  cursor = arcpy.UpdateCursor(fc,"","","","SITE D, SITE_ID_FD D")

for row in cursor:
    row.setValue("SITE_ID", x)
    cursor.updateRow(row)
    x+= 1 
```

我希望这有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T22:10:58.553

在评论中添加了指向 arcpy 文档的链接，但据我所知，这将创建一个新的、排序的数据集——

```
import arcpy
from arcpy import env

env.workspace = r"z:\test.gdb"

arcpy.Sort_management("testfc", "testfc_sort", [["SITE", "ASCENDING"],
                                                ["SITE_IF_FD", "ASCENDING]]) 
```

这将在排序的数据集上执行您想要的操作：

```
fc = r"Z:\test.gdb\testfc_sort"
x = 12001
cursor = arcpy.UpdateCursor(fc)

for row in cursor:
    row.setValue("SITE_ID", x)
    cursor.updateRow(row)
    x+= 1 
```

我假设有某种方法可以将排序/修改后的数据集复制回原始数据集，所以一切都好吗？

我承认，我不使用 arcpy，文档可能更明确。

# python - Matplotlib“迭代期间字典更改大小”创建子图时出错

> ID：12395742
> 
> 赞同：7
> 
> 时间：2012-09-12T20:27:43.177
> 
> 标签：python, matplotlib, weak-references

我写了一个函数来绘制一个由两个不同大小的子图组成的图形：

```
def draw_plot(data, function, sigma_value):

    gs = gridspec.GridSpec(1, 5)
    ax1 = subplot(gs[0, 0:3])  
    ax2 = subplot(gs[0, 3:5], sharey=ax1)                
    gs.update(wspace=0.05)
    ... 
```

我应该提到这是一个模块级函数，所以在该模块的顶部我进行导入

```
from pylab import *
import matplotlib.gridspec as gridspec 
```

当我跑步时`myplot.draw_plot(...)`，我得到了`RuntimeError`。问题是这种行为是不一致的。我可以调用该函数，例如三次，前两次我得到错误，而第三次运行正常。

追溯是

```
Traceback (most recent call last):
File "<interactive input>", line 1, in <module>
File "myplot.py", line 105, in draw_plot
    ax1 = subplot(gs[0, 0:3])                 
File "C:\Python32\lib\site-packages\matplotlib\pyplot.py", line 766, in subplot
    a = fig.add_subplot(*args, **kwargs)
File "C:\Python32\lib\site-packages\matplotlib\figure.py", line 779, in add_subplot
    a = subplot_class_factory(projection_class)(self, *args, **kwargs)
File "C:\Python32\lib\site-packages\matplotlib\axes.py", line 8380, in __init__
    self._axes_class.__init__(self, fig, self.figbox, **kwargs)
File "C:\Python32\lib\site-packages\matplotlib\axes.py", line 467, in __init__
    self.cla()
File "C:\Python32\lib\site-packages\matplotlib\axes.py", line 910, in cla
    self._shared_y_axes.clean()
File "C:\Python32\lib\site-packages\matplotlib\cbook.py", line 1493, in clean
    for key, val in mapping.items():
RuntimeError: dictionary changed size during iteration 
```

谢谢你的帮助！

**编辑**

显然我一直在试图弄清楚自己发生了什么，所以按照`Traceback`我检查`clean()`了`cbook.py`.

```
def clean(self):
    """
    Clean dead weak references from the dictionary
    """
    mapping = self._mapping
    for key, val in mapping.items():
        if key() is None:
            del mapping[key]
            val.remove(key) 
```

在函数中，我添加了一行可以打印的内容`mapping.items()`，我注意到当`<weakref at 0480EBA0; dead>`这些项目中有类似的条目时会发生错误。我对弱引用完全不熟悉，所以我又被困住了。

**编辑 2** 这当然不是一个好的解决方案，但在我的情况下注释掉`clean()`函数体会有所帮助，而不会产生任何新的错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-14T18:23:23.107

我刚刚发现了一篇最近发布的[安全迭代 WeakKeyDictionary 和 WeakValueDictionary](https://stackoverflow.com/questions/12428026/safely-iterating-over-weakkeydictionary-and-weakvaluedictionary)的帖子，它有助于解决一个非常相似的问题。

因此，使用 Bakuriu 给出的答案，我编辑`close()`了以下功能

```
def clean(self):
    """
    Clean dead weak references from the dictionary
    """

    mapping = self._mapping
    for key, val in list(mapping.items()):  # iterate over list now        
        if key() is None:
            del mapping[key]
            val.remove(key) 
```

它似乎工作得很好！

**编辑**

我刚刚发现在新版本`matplotlib`的函数中看起来像这样：

```
def clean(self):
    """
    Clean dead weak references from the dictionary
    """
    mapping = self._mapping
    to_drop = [key for key in mapping if key() is None]
    for key in to_drop:
        val = mapping.pop(key)
        val.remove(key) 
```

来源：

[https://github.com/matplotlib/matplotlib/blob/master/lib/matplotlib/cbook.py](https://github.com/matplotlib/matplotlib/blob/master/lib/matplotlib/cbook.py)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-14T18:24:40.873

只是对正在发生的事情的简短解释：

您像这样循环遍历一个可迭代的（列表、字典等）：

```
for somevalue in someiterable:
    #do something 
```

在循环内部，您尝试在结构上修改可迭代对象，这意味着您添加或删除了值。这是不允许的，因为它会弄乱 for 循环。对此的解决方案通常是迭代可迭代的副本，让您可以自由地更改原始文件。

# ruby-on-rails-3 - Rails 3：我如何验证允许空白（“”）但不允许零（数据库中的 NULL）

> ID：12395743
> 
> 赞同：21
> 
> 时间：2012-09-12T20:27:55.033
> 
> 标签：ruby-on-rails-3, activerecord

在 ActiveRecord（或 ActiveModel）中，我希望通过以下规范

```
it { should allow_value("").for(:my_string) }
it { should_not allow_value(nil).for(:my_string) } 
```

我努力了

```
validates :my_string, {
  :length => { :in => 0..255 },
  :presence => true,
  :allow_blank => true,
  :allow_nil => false,
} 
```

并且

```
validates :my_string, {
  :length => { :in => 0..255 },
  :allow_blank => true,
  :allow_nil => false,
} 
```

但要么它允许 "" 和 nil 要么都不允许。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-12-06T20:09:49.730

这对我有用

```
 validates :my_string, length: { in: 0..255, allow_nil: false } 
```

如果您只想验证该字段不为空，但不关心空白/空字符串，则此方法有效：

```
 validates :my_string, length: { minimum: 0, allow_nil: false, message: "can't be nil" } 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-12-15T13:05:34.950

您可以尝试这样做：

```
validates :my_string, exclusion: { in: [nil]} 
```

它是 ActiveRecord 中验证本身的一部分。

我已经尝试过其他的，它们都非常复杂，或者也允许 nil。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-12T20:35:49.310

您可能需要为此进行自定义验证：

```
validates :my_string, :length => { :in => 0..255 }
validate :my_string_is_valid

def my_string_is_valid
  self.errors.add :base, 'My string can not be nil' if self.my_string.nil? 
end 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-02-24T13:27:01.217

您可以创建一个简单的自定义验证器（放在`app/validators`dir 中）

```
class NotNilValidator < ActiveModel::EachValidator
  def validate_each(record, attribute, value)
    record.errors[attribute] << "must not be nil" if value.nil?
  end
end 
```

接着

```
validates :my_string, not_nil: true 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-12T20:49:48.200

或者可能：

```
validates :my_string, :length => { :in => 0..255 }, :allow_nil => false 
```

似乎`allow_nil`不会覆盖`allow_blank`. 所以你最好不要指定`allow_blank`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-06T08:20:02.113

这对我有用：

```
validates_exclusion_of :my_string, in: [nil] 
```

# android - 选项菜单不会出现在 Android 中

> ID：12395747
> 
> 赞同：2
> 
> 时间：2012-09-12T20:28:11.770
> 
> 标签：android, android-xml, android-menu, android-optionsmenu

我有这个代码来创建菜单：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
        super.onCreateOptionsMenu(menu);
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.tip_menu, menu);
    return true;

}

@Override
public boolean onOptionsItemSelected(MenuItem item) {

    switch (item.getItemId()) {
    case MNU_PREV:
        animateTextViewsPrev();
        break;

    case MNU_NEXT:
        animateTextViewsNext();
        break;
    }

    return true;
} 
```

和 XML：

```
<?xml version="1.0" encoding="utf-8"?>
    <menu xmlns:android="http://schemas.android.com/apk/res/android" >
        <item android:id="@+id/prev_tip" android:title="@string/prevTip"></item>
        <item android:id="@+id/next_tip" android:title="@string/nextTip"></item>
    </menu> 
```

在 Android 2.1 的智能手机中，菜单是可见的，但在其他移动设备中，4.1.1 是不可见的。有人现在如何解决它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T20:40:20.170

你的目标是什么 Android，很高兴知道，在 android 4.0 中他们重新设计了菜单布局。

我认为你`super.onCreateOptionsMenu(menu);`在通话中不见了`onCreateOptionsMenu`

在我的代码中，

```
public boolean onCreateOptionsMenu(Menu menu) {
    super.onCreateOptionsMenu(menu);
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.menu, menu);
    return true;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-06-13T11:46:12.573

我正在处理同样的问题..阅读一些查询和文档..希望这可能对您有所帮助。

这是我的菜单的 XML 文件..

```
<item
    android:id="@+id/action_send_feedback"
    android:orderInCategory="100"
    android:showAsAction="always"
    android:title="@string/action_send_feedback"/>

<item 
    android:id="@+id/action_share_app"
    android:orderInCategory="100"
    android:showAsAction="ifRoom"
    android:title="@string/action_share_app"
    android:icon="@drawable/ic_action_share" />

<item
    android:id="@+id/action_rate_app"
    android:orderInCategory="100"
    android:showAsAction="never"
    android:title="@string/action_rate_app"/> 
```

JAVA代码在这里..

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
} 
```

对于具有选项按钮（在手机底部）的 android 手机，当按钮被按下时，菜单项 showAsAction="never" 会出现。否则它们将正常显示在操作栏选项菜单上。

参考：http: [//developer.android.com/guide/topics/ui/menus.html#options-menu](http://developer.android.com/guide/topics/ui/menus.html#options-menu)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-05T06:33:45.210

您可以简单地将清单文件中的“targetSdkVersion”更改为**10**

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-09-22T19:41:49.157

它需要java中的ID！:)

# c# - C# 和 Combobox 无法加载列表的问题

> ID：12395749
> 
> 赞同：1
> 
> 时间：2012-09-12T20:28:27.830
> 
> 标签：c#, list, combobox

我正在使用组合框构建一个列表，当从组合列表中选择一个客户端时，它会加载一个特定的 URL。问题是列表是空白的。
下面是代码，但我看不到我缺少什么，但这可能是简单的疏忽，因为这是我第一次构建这样的 Combobox。

```
public partial class Form1 : Form
{
    List<MyClient> clients;
    public Form1()
    {
        InitializeComponent();
        clients = new List<MyClient>();
        clients.Add(new MyClient { ClientName = "Client 1", UrlAddress = @"http://www.google.com" });
        BindBigClientsList();
    }

    private void BindBigClientsList()
    {
        BigClientsList.DataSource = clients;
        BigClientsList.DisplayMember = "ClientName";
        BigClientsList.ValueMember = "UrlAddress";
    }

    private void BigClientsList_SelectedIndexChanged(object sender, EventArgs e)
    {
        MyClient c = BigClientsList.SelectedItem as MyClient;
        if (c != null)
        {
            string url = c.ClientName;
            Process.Start(url);
        }
    }
}
class MyClient
{
    public string ClientName { get; set; }
    public string UrlAddress { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:37:38.737

你错过了最后一行：**DataBind**

```
private void BindBigClientsList()
{
    BigClientsList.DataSource = ClientSize;
    BigClientsList.DisplayMember = "ClientName";
    BigClientsList.ValueMember = "UrlAddress";
    BigClientsList.DataBind;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T21:45:13.420

你的构造函数应该是这样的

```
public Form1() 
    { 
        InitializeComponent(); 
        List<MyClient> clients = new List<MyClient>(); 
        clients.Add(new MyClient { ClientName = "Client 1", UrlAddress = @"http://www.google.com" });
        foreach(MyClient client in clients)
        {
            BigClients.Items.Add(client);
        } 
    } 
```

这增加了两件事：

*   **将对象添加到组合框。**没有它，该项目应该如何出现在 ComboBox 中？
*   **将代码放在 InitializeComponent() 语句之后。**否则，当您尝试将 MyClient 对象添加到 ComboBox 时，它将引发 NullReferenceException。

# android - CursorAdapter + CheckBox，如果选中某项，则也选中其他项

> ID：12395752
> 
> 赞同：1
> 
> 时间：2012-09-12T20:28:58.023
> 
> 标签：android, adapter, simplecursoradapter, android-cursoradapter

我尝试使用每行上的复选框为 ListView 创建自己的适配器。一切正常，但问题是，当我选中某个复选框然后向下滚动时，另一个也被选中。

（当我第一次检查时，11 日，21 日，...，也被检查了）我能解释一下问题出在哪里吗？

谢谢你。

我的适配器：

```
public class WordAdapter extends CursorAdapter {

    public WordAdapter(Context context, Cursor cursor, int flags){
        super(context, cursor, flags);
    }

    @Override
    public void bindView(View oldView, Context ctx, Cursor c) {

        int wordQuestionIndex = c.getColumnIndex( WordDBAdapter.QUESTION );
        int wordAnswerIndex = c.getColumnIndex( WordDBAdapter.ANSWER );
        int activeIndex = c.getInt(c.getColumnIndex( WordDBAdapter.ACTIVE ));
        String question = c.getString(wordQuestionIndex);
        String answer = c.getString(wordAnswerIndex);
        int active = c.getInt(activeIndex);

        Log.d("WordAdapter", "isActive: "+ active + " - " + question + ", " + answer);

        ((TextView) oldView.findViewById(R.id.adapter_question)).setText(question);
        ((TextView) oldView.findViewById(R.id.adapter_answer)).setText(answer);
        CheckBox checkBox =(CheckBox) oldView.findViewById(R.id.myCheckBox);
        //checkBox.setChecked(vh.isChecked);
    }

    @Override
    public View newView(Context ctx, Cursor c, ViewGroup root) {
        LayoutInflater inflater = LayoutInflater.from(ctx);
        View view = inflater.inflate(R.layout.word, root, false);
        return view;
    }   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:39:36.897

这是因为旧视图的重用...

我建议，您维护一个复选框项目列表，每次使用新值初始化时都会在 bindview 中选中并重置复选框项目。

[在这里找到](https://stackoverflow.com/questions/4803756/android-cursoradapter-listview-and-checkbox)类似的问题和解决方案

# ruby-on-rails-3 - 如何？：Mongoid 3 和 Dragonfly 配置

> ID：12395753
> 
> 赞同：1
> 
> 时间：2012-09-12T20:29:01.960
> 
> 标签：ruby-on-rails-3, mongoid, ruby-on-rails-3.2, dragonfly-gem, mongoid3

我正在尝试将我的应用程序升级到 mongoid 版本 3。在我的蜻蜓初始化程序中，我曾经有这个：

```
app.configure_with(:imagemagick)
app.configure_with(:rails) do |c|
  c.datastore = Dragonfly::DataStorage::MongoDataStore.new :db => Mongoid.database
end 
```

Mongoid.database 不再存在。现在为蜻蜓配置连接的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T08:54:24.080

我使用`Mongoid.load!("config/mongoid.yml", :development)`而不是`Mongoid.database`. 它对我有用。

# php - 无法点击管理订单中的订单

> ID：12395754
> 
> 赞同：1
> 
> 时间：2012-09-12T20:29:02.957
> 
> 标签：php, magento, grid, admin, orders

我似乎捏造了一些东西，我无法在 Magento 1.5 的管理销售>订单网格中单击订单

我什至不能点击进入下一页...

这是概述网格链接：

> [http://www.thatsmytopper.com/index.php/manage/sales_order/index/key/3686900bdbffc7eead3a4283a269ac33/](http://www.thatsmytopper.com/index.php/manage/sales_order/index/key/3686900bdbffc7eead3a4283a269ac33/)

当我单击箭头转到第 2 页时，我得到相同的链接，最后带有 # 符号。

如果我单击每个订单右侧的查看，我可以查看订单，但无法像以前那样单击该行。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-11-19T18:34:53.603

可能没有以点击所需的权限登录。

# php - 如何从字符串中删除特定数字？

> ID：12395755
> 
> 赞同：-1
> 
> 时间：2012-09-12T20:29:01.863
> 
> 标签：php, regex

我在 PHP 中有这个字符串：

```
Hopelessly Incredible |SPG:M| 766 STEAM_0:1:20130600 " banned "A
Blatantly Obvious Hacker 740 STEAM_0:1:55386073 " (minutes "0")
(reason "Multi-Hack") 
```

字符串的格式为：

```
Name1 Number(0-3 digits) Steam_0:x:xxxx offense (banned/kicked/mute etc) Name2 Number(0-3 digits) Steam_0:x:xxxx time reason 
```

我的目标是删除这些值`766`，`740`因为它只是垃圾。这些值可以有一位数、两位数和三位数。

下一步是剥离字符串`STEAM_0:1:20130600`并将`STEAM_0:1:55386073`其捕获到一个新变量中。唯一不变的是`STEAM_0:`，其余的都可以改变。

我仍在学习正则表达式，但我担心这对我来说有点复杂。一些指导将是最感激的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:41:14.453

试试这个：（不擅长 PHP，但这应该很接近，正则表达式应该可以工作）

```
<?php
$sourcestring='Hopelessly Incredible |SPG:M| 766 STEAM_0:1:20130600 " banned "A Blatantly Obvious Hacker 740 STEAM_0:1:55386073 " (minutes "0") (reason "Multi-Hack")';
$replacedstring = preg_replace('/\d{1,3}(?=\s*STEAM_0)/i','',$sourcestring);
echo $replacedstring;
preg_match_all('/STEAM_0[^\s]+/i',$replacedstring,$matches);
echo "<pre>".print_r($matches,true);
?> 
```

[在这里](http://codepad.viper-7.com/K3YEIH)玩代码

* * *

*   正则表达式`/\d{1,3}(?=\s*STEAM_0)/i`匹配之前出现的数字 `STEAM_0`（正前瞻）并用空字符串替换它们
*   正则表达式`/STEAM_0[^\s]+/i`匹配所有`STEAM_0`单词（不区分大小写）并打印所有匹配的数组。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-12T20:39:09.807

```
$ cat scratch.php
<?php
$s = 'Hopelessly Incredible |SPG:M| 766 STEAM_0:1:20130600 " banned "A Blatantly Obvious Hacker 740 STEAM_0:1:55386073 " (minutes "0") (reason "Multi-Hack")';

$s = preg_replace('@\d+ (STEAM_\d:)@', '\1', $s);
preg_match_all('@(STEAM_\d:\d+:\d+)@', $s, $matches);
var_dump($s, $matches[1]);

$ php scratch.php
string(142) "Hopelessly Incredible |SPG:M| STEAM_0:1:20130600 " banned "A Blatantly Obvious Hacker STEAM_0:1:55386073 " (minutes "0") (reason "Multi-Hack")"
array(2) {
  [0]=>
  string(18) "STEAM_0:1:20130600"
  [1]=>
  string(18) "STEAM_0:1:55386073"
} 
```

# android - 可以在服务之间共享 Google 帐户身份验证令牌吗？

> ID：12395756
> 
> 赞同：0
> 
> 时间：2012-09-12T20:29:11.747
> 
> 标签：android, oauth, openid, oauth-2.0, accountmanager

我想使用用户的 Google 帐户从 Web 应用程序对他们进行[*身份验证*](https://developers.google.com/accounts/)（而不是授权），并唯一标识他们运行配套应用程序的 Android 设备。平台之间的通信将通过 Google Cloud Messaging 完成。

[当用户通过Google OAuth 2.0 实现](https://developers.google.com/accounts/docs/OAuth2Login)对他们的 Google 帐户进行身份验证时，Web 服务可以获得一个身份验证令牌。Android 应用通过[`AccountManager`](http://developer.android.com/reference/android/accounts/AccountManager.html).

每个平台返回的令牌是否相同，可以用作可靠的ID？如果不是，我是否被迫请求允许查看用户的电子邮件地址以完成此操作？

我不想访问用户的电子邮件地址进行身份验证——这是保护它的额外权限和责任。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:37:28.137

所有令牌都是唯一的——这样，您可以撤销一个设备/平台的身份验证，同时为另一个设备/平台保留它。利用[user_id](https://developers.google.com/accounts/docs/OAuth2Login)，它旨在跨平台关联同一用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:37:29.267

auth 令牌每小时过期一次，因此它永远不会是一个好的 id。

user_id 是你想要的

# c++ - Sig 11 使用 icpc v12 使用 -static 和 -openmp 编译时使用 boost 序列化

> ID：12395758
> 
> 赞同：0
> 
> 时间：2012-09-12T20:29:12.647
> 
> 标签：c++, boost, static, openmp, intel

如标题所述，我发生了段错误，我不知道为什么。我可以挖掘的最接近的可能相关问题是[this](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=34297)。我的系统规格如下：

*   RHELv5u8
*   icpc 12.1.0 版（gcc 4.1.2 版兼容性）
*   拱 = x86_64

使用g++编译时似乎没有出现问题。

我已将问题隔离为一小段代码：

```
#include <iostream>
#include <cstdio>
#include <vector>

#include <boost/archive/text_oarchive.hpp>
#include <boost/archive/text_iarchive.hpp>
#include <boost/serialization/vector.hpp>
#include <string>
#include <fstream>

using namespace std;

int main()
{   
  cout << "Testing ... ";

  vector<int> outVect(10);

  //  Save the data
  std::ofstream outputFile_("archive.txt");
  outputFile_ << std::scientific;
  boost::archive::text_oarchive textOutArchive_(outputFile_);
  cout << "chk1" << endl;
  textOutArchive_ & BOOST_SERIALIZATION_NVP(outVect);
  cout << "chk2" << endl;
  return 0;
} 
```

我正在编译：

```
icpc -g -static -openmp standalone.cc -o minimal -lboost_serialization ; ./minimal 
```

有任何想法吗？

Valgrind 给了我以下信息：

```
Testing ... chk1
==24519== Jump to the invalid address stated on the next line
==24519==    at 0x0: ??? 
==24519==    by 0x403100: boost::serialization::detail::extended_type_info_typeid_1<std::vector<int, std::allocator<int> > const>::get_instance() (extended_type_info_typeid.hpp:96)
==24519==    by 0x4027C0: boost::archive::detail::oserializer<boost::archive::text_oarchive, std::vector<int, std::allocator<int> > >::oserializer() (oserializer.hpp:106)
==24519==    by 0x402934: boost::archive::detail::oserializer<boost::archive::text_oarchive, std::vector<int, std::allocator<int> > >::instantiate() (oserializer.hpp:135)
==24519==    by 0x402764: boost::archive::detail::save_non_pointer_type<boost::archive::text_oarchive, std::vector<int, std::allocator<int> > >::save_standard::invoke(boost::archive::text_oarchive&, std::vector<int, std::allocator<int> > const&) (oserializer.hpp:264)
==24519==    by 0x4027AA: boost::archive::detail::save_non_pointer_type<boost::archive::text_oarchive, std::vector<int, std::allocator<int> > >::save_conditional::invoke(boost::archive::text_oarchive&, std::vector<int, std::allocator<int> > const&) (oserializer.hpp:273)
==24519==    by 0x40274A: boost::archive::detail::save_non_pointer_type<boost::archive::text_oarchive, std::vector<int, std::allocator<int> > >::invoke(boost::archive::text_oarchive&, std::vector<int, std::allocator<int> > const&) (oserializer.hpp:322)
==24519==    by 0x40364E: void boost::archive::save<boost::archive::text_oarchive, std::vector<int, std::allocator<int> > >(boost::archive::text_oarchive&, std::vector<int, std::allocator<int> > const&) (oserializer.hpp:536)
==24519==    by 0x401A85: void boost::archive::basic_text_oarchive<boost::archive::text_oarchive>::save_override<std::vector<int, std::allocator<int> > const>(std::vector<int, std::allocator<int> > const&, int) (basic_text_oarchive.hpp:78)
==24519==    by 0x4021D5: boost::archive::text_oarchive& boost::archive::detail::interface_oarchive<boost::archive::text_oarchive>::operator<< <std::vector<int, std::allocator<int> > const>(std::vector<int, std::allocator<int> > const&) (interface_oarchive.hpp:78)
==24519==    by 0x402E49: void boost::serialization::nvp<std::vector<int, std::allocator<int> > >::save<boost::archive::text_oarchive>(boost::archive::text_oarchive&, unsigned int) const (nvp.hpp:77)
==24519==    by 0x402C9E: void boost::serialization::access::member_save<boost::archive::text_oarchive, boost::serialization::nvp<std::vector<int, std::allocator<int> > > const>(boost::archive::text_oarchive&, boost::serialization::nvp<std::vector<int, std::allocator<int> > > const&, unsigned int) (access.hpp:93)
==24519==  Address 0x0 is not stack'd, malloc'd or (recently) free'd
==24519==    
==24519==    
==24519== Process terminating with default action of signal 11 (SIGSEGV)
==24519==  Bad permissions for mapped region at address 0x0
==24519==    at 0x0: ???
==24519==    by 0x403100: boost::serialization::detail::extended_type_info_typeid_1<std::vector<int, std::allocator<int> > const>::get_instance() (extended_type_info_typeid.hpp:96)
==24519==    by 0x4027C0: boost::archive::detail::oserializer<boost::archive::text_oarchive, std::vector<int, std::allocator<int> > >::oserializer() (oserializer.hpp:106)
==24519==    by 0x402934: boost::archive::detail::oserializer<boost::archive::text_oarchive, std::vector<int, std::allocator<int> > >::instantiate() (oserializer.hpp:135)
==24519==    by 0x402764: boost::archive::detail::save_non_pointer_type<boost::archive::text_oarchive, std::vector<int, std::allocator<int> > >::save_standard::invoke(boost::archive::text_oarchive&, std::vector<int, std::allocator<int> > const&) (oserializer.hpp:264)
==24519==    by 0x4027AA: boost::archive::detail::save_non_pointer_type<boost::archive::text_oarchive, std::vector<int, std::allocator<int> > >::save_conditional::invoke(boost::archive::text_oarchive&, std::vector<int, std::allocator<int> > const&) (oserializer.hpp:273)
==24519==    by 0x40274A: boost::archive::detail::save_non_pointer_type<boost::archive::text_oarchive, std::vector<int, std::allocator<int> > >::invoke(boost::archive::text_oarchive&, std::vector<int, std::allocator<int> > const&) (oserializer.hpp:322)
==24519==    by 0x40364E: void boost::archive::save<boost::archive::text_oarchive, std::vector<int, std::allocator<int> > >(boost::archive::text_oarchive&, std::vector<int, std::allocator<int> > const&) (oserializer.hpp:536)
==24519==    by 0x401A85: void boost::archive::basic_text_oarchive<boost::archive::text_oarchive>::save_override<std::vector<int, std::allocator<int> > const>(std::vector<int, std::allocator<int> > const&, int) (basic_text_oarchive.hpp:78)
==24519==    by 0x4021D5: boost::archive::text_oarchive& boost::archive::detail::interface_oarchive<boost::archive::text_oarchive>::operator<< <std::vector<int, std::allocator<int> > const>(std::vector<int, std::allocator<int> > const&) (interface_oarchive.hpp:78)
==24519==    by 0x402E49: void boost::serialization::nvp<std::vector<int, std::allocator<int> > >::save<boost::archive::text_oarchive>(boost::archive::text_oarchive&, unsigned int) const (nvp.hpp:77)
==24519==    by 0x402C9E: void boost::serialization::access::member_save<boost::archive::text_oarchive, boost::serialization::nvp<std::vector<int, std::allocator<int> > > const>(boost::archive::text_oarchive&, boost::serialization::nvp<std::vector<int, std::allocator<int> > > const&, unsigned int) (access.hpp:93)
==24519== 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T06:58:56.963

长评：

`pthreads`除非链接整个存档，否则静态链接（由 OpenMP 运行时使用）永远不会正常`libpthreads.a`工作。要解决它，您应该附加`-Wl,--whole-archive -lpthreads -Wl,--no-whole-archive`到编译选项。

但是，我在您的代码中看不到并行区域，因此激活 OpenMP 是多余的。此外，它看起来更像是 RTTI 在 icpc 上失败，因为错误发生在从内部调用的东西中`extended_type_info_typeid.hpp`。

# html - 如何将选定的选项值转换为 HTML5 代码

> ID：12395759
> 
> 赞同：1
> 
> 时间：2012-09-12T20:29:12.833
> 
> 标签：html, asp.net-mvc-4, html-select

我正在使用 MVC4 和 HTML5 来开发我的项目。我声明了选择标签和选项，每个选项都有自己的值。当我选择一个选项时，我可以在警报中看到它的值。

```
<select name="select" onchange="drawOption(this)">
    <option value="">--- Cizgi Tipi Seçiniz ---</option>
    <option value="">--- Basit Semboller ---</option>
    <option value="new esri.symbol.SimpleMarkerSymbol();">Default</option>
    <option value="new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE, 10, new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID,new dojo.Color([210, 105, 30, 0.5]), 8), new dojo.Color([210, 105, 30, 0.9]))" >Square</option>
</select> 
```

在 JavaScript 中，我想使用这个值来创建对象并分配给 var 变量。相关函数（不是drawOption函数，addGraphic函数是在某些函数之后触发的）：

```
function addGraphic(pt) {
    var idx = element.selectedIndex;
    alert(element.options[idx].value);
    var symbol = element.options[idx].value;
    // var symbol = new esri.symbol.SimpleMarkerSymbol(esri.symbol.SimpleMarkerSymbol.STYLE_SQUARE, 10, new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID, new dojo.Color([210, 105, 30, 0.5]), 8),
    //new dojo.Color([210, 105, 30, 0.9]));
    graphic = new esri.Graphic(pt, symbol);
    map.graphics.add(graphic);
} 
```

在警报中，我可以看到价值。但是，它不会分配给符号变量。我认为，它将它分配为字符串，所以我不能创建新对象。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-09T10:06:02.860

我看不到在哪里`element`定义，所以很难说。我认为您正在为 分配一个字符串`symbol`，即`"new esri.symbo...."`.

也许使用`eval (...)`会有所帮助？（注意安全问题！）

问候，诺比

# sql - 水平联合选择语句

> ID：12395761
> 
> 赞同：3
> 
> 时间：2012-09-12T20:29:21.320
> 
> 标签：sql, sql-server, sql-server-2008-r2

假设我的选择语句的结果如下（我有 5 个）：

```
 Id  Animal AnimalId
    1   Dog     Dog1
    1   Cat     Cat57

   Id  Transport TransportId
    2   Car        Car100
    2   Plane      Plane500 
```

我想得到如下结果：

```
 Id  Animal AnimalId    Transport    TransportId
    1   Dog     Dog1
    1   Cat     Cat57
    2                        Car          Car100
    2                       Plane         Plane500 
```

我能做的是创建一个表变量并指定所有可能的列并将每个选择语句中的记录插入其中。但也许像 PIVOT 这样的更好的解决方案？
**编辑**

查询： 第一：`Select CategoryId as Id, Animal, AnimalId from Animal`
第二：`Select CategoryId as Id, Transport, TransportId from Transport`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T20:37:03.727

怎么样，如果您需要它们在同一行中，这将获取`row_number()`每行并加入这些：

```
select a.id,
  a.aname,
  a.aid,
  t.tname,
  t.tid
from 
(
  select id, aname, aid, row_number() over(order by aid) rn
  from animal
) a
left join
(
  select id, tname, tid, row_number() over(order by tid) rn
  from transport
) t
  on a.rn = t.rn 
```

见[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/f69c1/2)

如果您不需要它们在同一行中，请使用`UNION ALL`：

```
select id, aname, aid, 'Animal' tbl
from animal
union all
select id, tname, tid, 'Transport'
from transport 
```

见[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/f69c1/4)

编辑#1，这是一个带有`UNPIVOT`and的版本`PIVOT`：

```
select an_id, [aname], [aid], [tname], [tid]
from
(
  select *, row_number() over(partition by col order by col) rn
  from animal
  unpivot
  (
    value
    for col in (aname, aid)
  ) u
  union all
  select *, row_number() over(partition by col order by col) rn
  from transport
  unpivot
  (
    value
    for col in (tname, tid)
  ) u
) x1
pivot
(
  min(value)
  for col in([aname], [aid], [tname], [tid])
) p
order by an_id 
```

见[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/72a8f/31)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-12T20:37:27.153

这将为您做到：

```
SELECT
ID, field1, field2, '' as field3, '' as field4
FROM sometable

UNION ALL

SELECT
ID, '', '', field3, field4
FROM someothertable 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T20:50:06.110

要以您想要的格式获取它，请选择您想要的值，然后`null`（或空字符串）选择其他列。

```
SELECT
    CategoryId as Id, 
    Animal as 'Animal', 
    AnimalId as 'AnimalId',
    null as 'Transport',
    null as 'TransportId'
FROM Animal
UNION
SELECT 
    CategoryId as Id, 
    null as 'Animal',
    null as 'AnimalId',
    Transport as 'Transport',  
    TransportId as 'TransportId' 
FROM Transport 
```

我仍然不确定这样做的目的，但这应该可以提供您想要的输出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T20:35:41.027

你不应该需要旋转，你的结果已经很好了。

如果需要，您可以将所有 5 个语句以与第一个选择相同的格式合并在一起：ID/Category/CategoryID。然后你会得到一个长的结果集，所有 5 个集合都附加了 3 列宽。

那是你要的吗？还是您需要区分“类别”？

* * *

给出你的例子，试试：

```
Select CategoryId as Id, Animal, AnimalId from Animal
union all
Select CategoryId as Id, Transport, TransportId from Transport 
```

如果你愿意，你可以给列起别名，例如：

```
Select CategoryId as Id, Animal as category, AnimalId as categoryID from Animal
union all
Select CategoryId as Id, Transport, TransportId from Transport 
```

* * *

你真的不需要旋转，只需像你最初想的那样隔开你的列。您不会旋转以移动列，而是旋转以对分组数据执行聚合功能。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-12T20:43:56.553

```
create table Animal (
    Animal varchar(50)
    ,AnimalID varchar(50)
    )

create table Transport (
    Transport varchar(50)
    ,TransportID varchar(50)
    )

insert into Animal values ('Dog', 'Dog1')
insert into Animal values ('Cat', 'Cat57')

insert into Transport values ('Car', 'Car100')
insert into Transport values ('Plane', 'Plane500')

select  ID = 1
    ,A.Animal
    ,A.AnimalID
    ,Transport = ''
    ,TransportID = ''
from    Animal A

union

select  ID = 2
    ,Animal = ''
    ,AnimalID = ''
    ,T.Transport
    ,T.TransportID
from    Transport T 
```

# video - 将任何视频转换为 iPhone - 转码逻辑/算法？

> ID：12395764
> 
> 赞同：2
> 
> 时间：2012-09-12T20:29:28.183
> 
> 标签：video, ffmpeg, video-processing, mencoder

我有很多不同格式的视频文件（主要是 avi）。例如，一些相关行来自`ffprobe`：

```
 Duration: 02:27:14.70, start: 0.000000, bitrate: 664 kb/s
    Stream #0.0: Video: mpeg4, yuv420p, 608x256 [PAR 1:1 DAR 19:8], 23.98 tbr, 23.98 tbn, 23.98 tbc
    Stream #0.1: Audio: mp3, 44100 Hz, stereo, s16, 96 kb/s

  Duration: 00:20:51.84, start: 0.000000, bitrate: 3286 kb/s
    Stream #0.0: Video: mpeg4, yuv420p, 640x480 [PAR 1:1 DAR 4:3], 25 tbr, 25 tbn, 25 tbc
    Stream #0.1: Audio: mp3, 48000 Hz, stereo, s16, 128 kb/s

  Duration: 01:26:01.84, start: 0.000000, bitrate: 845 kb/s
    Stream #0.0: Video: mpeg4, yuv420p, 704x544 [PAR 1:1 DAR 22:17], 25 fps, 25 tbr, 25 tbn, 30k tbc
    Stream #0.1: Audio: mp3, 44100 Hz, stereo, s16, 128 kb/s

  Duration: 01:42:25.68, start: 0.000000, bitrate: 952 kb/s
    Stream #0.0: Video: h264 (High), yuv420p, 600x244 [PAR 1:1 DAR 150:61], 25 fps, 25 tbr, 25 tbn, 50 tbc
    Stream #0.1: Audio: mp3, 48000 Hz, stereo, s16, 112 kb/s 
```

如您所见，比特率、视频大小、编解码器各不相同。想要编写一个脚本（bash，perl），将它们转换为带有`ffmpeg`.

通过谷歌搜索，我发现了许多不同的 ffmpeg 配置文件，但所有配置文件都是“静态的”，例如将视频转换为相同的分辨率，这可能不是正确的方法，因为我有许多不同的视频分辨率和许多不同的比特率。（这也适用于音频）。

我能够编写脚本 - 但需要一个基本问题的帮助。

我需要有关如何根据`ffmpeg`上述`ffprobe`结果计算参数值的算法帮助。例如，当有 704x544 和 845kb/s 的视频以及另一个尺寸较小的 640x480 但比特率为 3200kb/s 的视频时 - 如何计算`ffmpeg`脚本中的“正确值”？

**为所需设备转码视频的正确算法/逻辑是什么？**（在我的情况下是 iPhone）

如果有人关心，我已经用“非自由”编解码器重新编译了 ffmpeg，并且也有 mencoder（来自 mplayer 包）。

第二：在 avi 容器中已经有许多 mpeg4 格式的视频。如何确定“最快”的转换配置文件？意味着一个配置文件，其中`ffmpeg`只会进行不太可能的计算，因此可能会保持原样：mpeg4 格式、大小、比特率和“仅”会改变容器格式。这可能吗？

我读了很多`ffmpeg`SO 问题，但没有找到答案 - 也许我错过了一些东西。有人可以指点我一些好的文件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T13:10:48.910

您是否尝试使用**gstreamer**？如果是这样，您可以运行命令行 gst-launch 来自动解码任何输入文件，然后调整大小为您需要的任何格式，然后重新编码并重新复用到 mov 文件中。确切的行取决于音频的存在/不存在，以及用于编写 .mov 文件的具体编解码器。

重新编码 XYZ -> ABC.mov 的示例，没有音频，用于 320x240 调整大小和 h263 编码：

```
gst-launch   filesrc location=XYZ ! decodebin2 ! ffmpegcolorspace ! videoscale add-borders=true ! video/x-raw-yuv, width=320, height=240 ! ffmpegcolorspace ! ffenc_h263 ! qtmux ! filesink location=ABC.mov 
```

# perforce - 在 Perforce 中，如何重新添加在退出期间删除的文件？

> ID：12395766
> 
> 赞同：2
> 
> 时间：2012-09-12T20:29:36.853
> 
> 标签：perforce

这是我们的情况：

*   我们复制了流 A 的内容，这是对我们的安全基础设施的更改，主要内容是。
*   然后我们将内容合并到流 B 中。
*   然后我们在流 B 中进行了一些其他不相关的更改。
*   然后我们意识到来自流 A 的更改并没有我们想象的那么好，我们决定将其撤消以确保安全。
*   我们取消了包含流 A 更新的修订。
*   这具有删除一些文件并更改其他文件的效果。
*   我们在没有更改流 A 的情况下进行了测试，一切正常。
*   同时，开发人员对流 A 进行了一些小改动，我们准备将流 A 合并回流 B。

问题是，我们可以复制到 main，但我们不能将这些更改返回到流 B，因为“删除流 A”的更改更新。我们希望将之前撤消的所有更改以及新更改都*恢复原状。*

有没有办法做到这一点，而不需要大量的手动工作来手动复制或手动合并所有内容？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-16T00:04:23.230

我不熟悉 Perforce 流，但传统上 Perforce 没有任何特殊的回退概念。撤消更改只会创建反向更改集。

因此，要重新应用已撤销的更改，您应该能够仅撤销撤销。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-13T08:54:22.563

首先运行`p4 changes -i @n,n`其中 n 是从 main 到 B 的合并的更改列表编号，其中包含您退出的 A 更改。这为您提供了更改列表，其中第一个是 n 本身，其余的是您需要重新合并到 B 的 main 更改。但是，您不能使用“p4 merge”重新合并，但必须使用'p4 integ -f'。

例如，假设 n 为 1000：

```
p4 changes -i @1000,1000
Change 1000 ...
Change 994  ...
Change 991  ...
Change 866  ... 
```

这告诉您必须将 866、991 和 994 从 main 重新合并到 B。如果您不是在挑选，您可以假设这些是 main 中的连续更改，并且您可以使用 866 到 994 作为修订范围：

```
p4 integ -f -r -S //stream/B @866,994
p4 resolve
p4 submit 
```

（这个 integ 命令示例假定 //stream/main 是 //stream/B 的父级。当然，您必须在 //stream/B 工作区中执行此操作。为了获得最佳结果，您可能想要以确保您的工作区已完全同步，并且在运行 integ 之前您没有打开的文件。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T18:25:45.943

您可以随时退出已退出的更改列表。这样，您将到达进行第一次更改的地步。

请记住，所有文件历史记录都已保存，因此所有更改都应该在像您这样的情况下轻松恢复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-23T20:57:33.477

您最近的更改是删除，因此它不会重新添加文件，因为它已经打开以进行删除。在该文件上运行 p4 revert，然后执行 p4 add，它对我有用。

# c++ - 矩阵相乘时的分段错误

> ID：12395767
> 
> 赞同：0
> 
> 时间：2012-09-12T20:29:38.277
> 
> 标签：c++, segmentation-fault, operator-keyword

出于某种原因，每当我调用以下命令时，我似乎都会遇到异常（假设 A、B 和 C 都是矩阵，并且没有违反矩阵乘法规则）：

```
c=a*b; 
```

我已经通过我的代码几个小时了，我一辈子都找不到问题所在。

有接受者吗？我认为这可能是 allocate() 或 clear() 函数或复制构造函数/赋值运算符的问题。

提前致谢！

```
// matrix.h
#ifndef matrix_H
#define matrix_H
#include <iostream>
#include <cstdlib>
using namespace std;
template <class mType> class matrix {
public:
    matrix() : N(0), M(0), origin(NULL) { /* EMPTY */ }
    matrix(const matrix<mType> &m) {
        if (origin)
                clear();
        origin = new mType* [m.numrows()];
        for (int i=0; i<m.numrows(); ++i)
            origin[i] = new mType[m.numcols()];

    }
    matrix(int n, int m): N(n), M(m), origin(NULL) {
        allocate(n,m);
    }

    ~matrix() {
        clear();
    }

    matrix & operator=(const matrix &rhs) {

        if (this != &rhs) {     //Check to see they're not the same instance

            this->clear();
            this->allocate(rhs.numrows(), rhs.numcols());
            for(int i=0; i<N; ++i)
                for (int j=0; j<M; ++j)
                    this->origin[i][j] = rhs[i][j];
            }

        return *this;
    }

    matrix & operator+=(const matrix &rhs) {
        try {
            if (    this->numrows() != rhs.numrows() ||
                this->numcols() != rhs.numcols() ) 
                throw 1;
        }
        catch (int e)
        {
            cerr << "Error: The addition of two matrices of different demensions is not defined." << endl;
            return *this;
        }

        for(int i=0; i<N; ++i)
            for (int j=0; j<M; ++j)
                this->origin[i][j] += rhs[i][j];
        return *this;
    }

    const matrix operator+(const matrix &rhs) const {
       matrix tmp = *this;     // tmp copy so we can use the += operator
       return (tmp += rhs);     // return answer
    }

    friend const matrix operator*(const matrix &that, const matrix &rhs) {
        try {
            if (    that.numcols() != rhs.numrows() )
                throw 1;
        }
        catch (int e)
        {
            cerr << "Error: matrix Multiplication not defined." << endl;
            return that;
        }
        matrix<mType> returnmatrix(that.numrows(), rhs.numcols());
        int x=0;
        for (int i=0; i<returnmatrix.numrows(); ++i)
            for (int j=0; j<returnmatrix.numcols(); ++j)
                for (int k=0; k < that.numcols(); ++k){
                    cout << (++x)<<endl;
                    returnmatrix[i][j] += that[i][k] * rhs[k][j];}
        cout << "rt" <<endl;    
        return returnmatrix;

     }

    inline int const numrows() const {
        return N;
    }

    inline int const numcols() const {
        return M;
    }

    void allocate(int n, int m) {
        if (origin)
            clear();
    origin = new mType* [n];
    for (int i=0; i<n; ++i)
        origin[i] = new mType[m];
    M=m;
    N=n;        
}
void clear() {
    if (this->origin) {
        for(int i = 0; i < N; i++)
                delete[] origin[i];
        delete this->origin;
    }

    M=N=0; // Reset

    origin=NULL; 
}

mType* operator [] (const int index)  { return origin[index]; }
const mType* operator [] (const int index) const  { return origin[index]; }

friend matrix<mType> operator*( mType factor, const matrix<mType> rhs ) {
    matrix<mType> out(rhs.numrows() , rhs.numcols());       
        for (int i=0; i<rhs.numrows(); ++i) {
            for (int j=0; j<rhs.numcols(); ++j) {
                out[i][j] = rhs[i][j]*factor;
            }
        }
    return out;
}

friend ostream& operator<< (ostream& out, const matrix<mType>& A) {

    if (A.numrows() > 0 && 0 <  A.numcols()) {
        out <<"[";
        for (int j=0; j<A.numcols(); ++j) {
            out << A[0][j] << " ";
        }
        for (int i=1; i<A.numrows(); ++i) {
            out << endl;
            for (int j=0; j<A.numcols(); ++j) {
                out << " " << A[i][j];
            }
        }
        out << "]" <<endl;

    }
    return out;
}

 friend istream& operator>> (istream& in, matrix<mType> &A)  {
    //[3 2 9 1 2 3 4 5]
    //toss first char
    try {
        if (in.get() != '[')
            throw 1;
        int N, M;
        mType tmp;
        in >> N;
        in >> M;

        A = matrix<mType>(N,M);
        for (int i=0; i<N; ++i)
            for (int j = 0; j < M; j++)
            {   
                in >> tmp;
                A[i][j] = tmp;
            }
        in.get();
            in.ignore();
        }
        catch (int e) {
            cerr << "Invalid Input for matrix" << endl;

        }

        return in;
    }

private: 
    int N, M;
    mType ** origin;

};

#endif 
```

修改：

```
// matrix.h
#ifndef matrix_H
#define matrix_H
#include <iostream>
#include <cstdlib>
using namespace std;
template <class mType> class matrix {
public:
matrix() : N(0), M(0), origin(NULL) { /* EMPTY */ }
matrix(const matrix<mType> &m) {

    origin = new mType* [m.numrows()];
    for (int i=0; i<m.numrows(); ++i)
        origin[i] = new mType[m.numcols()];
    for (int i=0; i<N;++i)
        for (int j = 0; j < M; j++)
        {
            origin[i][j] = m[i][j];
        }

}
matrix(int n, int m): N(n), M(m), origin(NULL) {
    allocate(n,m);
    for (int i=0; i<N;++i)
        for (int j = 0; j < M; j++)
        {
            origin[i][j] = 0;
        }
}

~matrix() {
    clear();
}

matrix & operator=(const matrix &rhs) {

    if (this != &rhs) {     //Check to see they're not the same instance

        this->clear();
        this->allocate(rhs.numrows(), rhs.numcols());
        for(int i=0; i<N; ++i)
            for (int j=0; j<M; ++j)
                this->origin[i][j] = rhs[i][j];
        }

    return *this;
}

matrix & operator+=(const matrix &rhs) {
    try {
        if (    this->numrows() != rhs.numrows() ||
            this->numcols() != rhs.numcols() ) 
            throw 1;
    }
    catch (int e)
    {
        cerr << "Error: The addition of two matrices of different demensions is not defined." << endl;
        return *this;
    }

    for(int i=0; i<N; ++i)
        for (int j=0; j<M; ++j)
            this->origin[i][j] += rhs[i][j];
    return *this;
}

const matrix operator+(const matrix &rhs) const {
   matrix tmp = *this;     // tmp copy so we can use the += operator
   return (tmp += rhs);     // return answer
}

friend const matrix operator*(const matrix &that, const matrix &rhs) {
    try {
        if (    that.numcols() != rhs.numrows() )
            throw 1;
    }
    catch (int e)
    {
        cerr << "Error: matrix Multiplication not defined." << endl;
        return that;
    }
    matrix<mType> returnmatrix(that.numrows(), rhs.numcols());
    int x=0;
    for (int i=0; i<returnmatrix.numrows(); ++i)
        for (int j=0; j<returnmatrix.numcols(); ++j)
            for (int k=0; k < that.numcols(); ++k){
                cout << (++x)<<endl;
                returnmatrix[i][j] += that[i][k] * rhs[k][j];}
    cout << "rt" <<endl;    
    return returnmatrix;

 }

inline int const numrows() const {
    return N;
}

inline int const numcols() const {
    return M;
}

void allocate(int n, int m) {
    if (origin)
        clear();
    origin = new mType* [n];
    for (int i=0; i<n; ++i)
        origin[i] = new mType[m];
    M=m;
    N=n;        
}
void clear() {
    if (this->origin) {
        for(int i = 0; i < N; i++)
                delete[] origin[i];
        delete this->origin;
    }

    M=N=0; // Reset

    origin=NULL; 
}

mType* operator [] (const int index)  { return origin[index]; }
const mType* operator [] (const int index) const  { return origin[index]; }

friend matrix<mType> operator*( mType factor, const matrix<mType> rhs ) {
    matrix<mType> out(rhs.numrows() , rhs.numcols());       
        for (int i=0; i<rhs.numrows(); ++i) {
            for (int j=0; j<rhs.numcols(); ++j) {
                out[i][j] = rhs[i][j]*factor;
            }
        }
    return out;
}

friend ostream& operator<< (ostream& out, const matrix<mType>& A) {

    if (A.numrows() > 0 && 0 <  A.numcols()) {
        out <<"[";
        for (int j=0; j<A.numcols(); ++j) {
            out << A[0][j] << " ";
        }
        for (int i=1; i<A.numrows(); ++i) {
            out << endl;
            for (int j=0; j<A.numcols(); ++j) {
                out << " " << A[i][j];
            }
        }
        out << "]" <<endl;

    }
    return out;
}

 friend istream& operator>> (istream& in, matrix<mType> &A)  {
    //[3 2 9 1 2 3 4 5]
    //toss first char
    try {
        if (in.get() != '[')
            throw 1;
        int N, M;
        mType tmp;
        in >> N;
        in >> M;

        A = matrix<mType>(N,M);
        for (int i=0; i<N; ++i)
            for (int j = 0; j < M; j++)
            {   
                in >> tmp;
                A[i][j] = tmp;
            }
        in.get();
        in.ignore();
    }
    catch (int e) {
        cerr << "Invalid Input for matrix" << endl;

    }

    return in;
}

private: 
    int N, M;
    mType ** origin;

};

#endif 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T20:45:37.280

相当多的代码，但我只是查看了复制构造函数，其中有两个严重的错误。

第一个错误

```
matrix(const matrix<mType> &m) {
    if (origin)
            clear(); 
```

origin 此时未初始化，因此您无法测试它的值。只需删除这两行。请记住，构造函数初始化一个新对象，如果构造函数正在测试对象是否已经存在，那就错了。

第二个错误

您的复制构造函数不会复制任何内容！它会创建一个大小合适的矩阵，但不会复制矩阵值！

我猜第一个错误是你崩溃的原因，第二个错误只是意味着你得到垃圾结果。

# java - 如何转换列表 to JSON on playframework Java First of all, I am using playframework 2 with Java. I have a Bootstrap-lookahead input field in a view and I want to use a json array as source for it, as described 问问题

> ID：12395769
> 
> 赞同：3
> 
> 时间：2012-09-12T20:29:59.990
> 
> 标签：java, view, playframework-2.0, json

First of all, I am using playframework 2 with Java.

I have a Bootstrap-lookahead input field in a view and I want to use a json array as source for it, as described [here](https://gist.github.com/1866577). I can generate json at server-side with:

```
Json.toJson(users) 
```

or on client with:

```
@{Json.toJson(users)} 
```

However it generates strings with `&quot;` and when I try to create the bootstrap-lookahead field with this data, it gives me

```
Uncaught SyntaxError: Unexpected token & 
```

Could someone help me with that?

Thank you

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-12T20:49:59.193

您可以通过`@Html(Json.toJson(users))`在模板中使用来防止转义。

[文档，最后一段](http://www.playframework.org/documentation/2.0/JavaTemplates)

# apache - WAMP apache httpd.config 和主机 - 如何将 localhost 别名为端口 8080？

> ID：12395770
> 
> 赞同：0
> 
> 时间：2012-09-12T20:30:01.100
> 
> 标签：apache, port, wamp, wampserver, portforwarding

好的，所以我在 Windows 7 上配置了我的 apache 安装，以便它`port 8080`通过更改`httpd.config`.

我*太愚蠢*了，没有意识到现在我必须`:8080`在最后访问 localhost。

**问题：**有没有办法让我的盒子自动解析`localhost`到`127.0.0.1:8080`？我不喜欢 haviog 输入：8080，不，我*不能*将端口更改为 80，我需要那个用于防火墙。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:42:11.573

不。主机名与端口无关。您必须自己指定端口，或者在通常的端口 80 上设置一个代理来代表您执行 8080 请求。...或者硬着头皮直接使用端口 80 并将防火墙移到其他地方。

# php - Does Zend Framework Lock Table before Insert?

> ID：12395771
> 
> 赞同：0
> 
> 时间：2012-09-12T20:30:08.810
> 
> 标签：php, mysql, zend-framework

I read this on URL: [http://docs.oracle.com/cd/E17952_01/refman-5.5-en/optimizing-myisam-bulk-data-loading.html](http://docs.oracle.com/cd/E17952_01/refman-5.5-en/optimizing-myisam-bulk-data-loading.html)

If you lock table before you insert and unlock it after that. The speed will increase 40% faster than not locking.

I don't know if Zend Framework does lock table before insert or not?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:39:50.280

1.  ZF 不会自己锁定它。如果您愿意 - 您必须手动执行此操作。
2.  确切的改进是**非常**具体的。没有人能说如果你锁定你会赢多少（或输多少，谁知道）。

如果您的应用程序没有遇到任何性能问题 - 不要那样做。如果您确实遇到任何性能问题 - 从分析开始并找出问题的*确切*原因。

PS：mysql 文档中的那句话非常投机。

# javascript - Stopping .each execution on every iteration for a spesific time interval in jquery?

> ID：12395774
> 
> 赞同：1
> 
> 时间：2012-09-12T20:30:32.037
> 
> 标签：javascript, jquery, time, each, intervals

I am trying to create the following functionality in my javascript:

```
$("mySelector").each(function(){

// Do something (e.g. change div class attribute)   
// call to MyFunction(), the iteration will stop here as long as it will take for myFunction to complete

});

function myFunction() 
{   
 // Do something for e.g. 5 seconds 
} 
```

My question is how can I stop every iteration for the duration of the myFunction()?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:31:16.143

No, that isnt possible. You'll have to code it differently, possibly with a setTimeout based on the current index of .each.

```
$("mySelector").each(function(i){

    // Do something (e.g. change div class attribute)   
    // call to MyFunction(), the iteration will stop here as long as it will take for myFunction to complete
    setTimeout(myFunction,i*5000);

});

function myFunction() 
{   
 // Do something for e.g. 5 seconds 
} 
```

Edit: You can also do it with queuing: [http://jsfiddle.net/9Bm9p/6/](http://jsfiddle.net/9Bm9p/6/)

```
$(document).ready(function () {
    var divs = $(".test");
    var queue = $("<div />");

    divs.each(function(){
        var _this = this;
        queue.queue(function(next) {
            myFunction.call(_this,next); 
        });
    });
});

function myFunction(next) {    
    // do stuff
    $(this).doSomething(); 

    // simulate asynchronous event
    var self = this;
    setTimeout(function(){
        console.log(self.id);
        // go to next item in the queue
        next();
    },2000);

} 
```

​</p>

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T21:06:47.167

这是一个 jsFiddle，我认为它可以满足您的需要：

[http://jsfiddle.net/9Bm9p/2/](http://jsfiddle.net/9Bm9p/2/)

您只需将选择器替换为您使用的选择器。

正在发生的“循环”将等待`myFunction`完成，然后再继续下一个元素。我在里面添加了 setTimeout`myFunction`来模拟它需要一段时间。如果您正在使用异步的东西，例如 AJAX 请求，您需要将调用`myFunction`放在`complete`方法内部......或动画的回调中。

但是正如有人已经评论过的那样，如果其中的所有内容`myFunction`都是同步的，那么您应该可以按原样使用它。如果您希望此过程是异步的，或者如果其中的内容`myFunction`是异步的，则不能使用 for 循环或 .each()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T20:41:25.833

```
(function () {
    "use strict";

    var step = 0;
    var content = $("mySelector");
    var max = content.length;
    var speed = 5000; // ms

    var handle = setInterval(function () {
        step++;
        if (step >= max) {
            clearInterval(handle);
        } else {
            var item = content[step];
            // do something
        }
    }, speed);
}()); 
```

`setInterval`每n毫秒执行一次，`clearInterval`完成后停止。这不会锁定浏览器（前提是您的“做某事”也没有）。 **FRAGILE：**假设 的结果`$("mySelector")`在任务期间有效。如果不是这种情况，那么在里面`do something`然后`item`再次验证。

# php - 在 wordpress 模板中为特定帖子加载评论

> ID：12395777
> 
> 赞同：0
> 
> 时间：2012-09-12T20:31:04.513
> 
> 标签：php, wordpress, comments

嗨，我使用此代码加载特定帖子的内容和信息：

```
if ($actual_link == $wpbase){
    $recent_posts = wp_get_recent_posts('1');
    foreach( $recent_posts as $recent ){
        echo '<article id="post-'.$recent["ID"].'"><h1>' .
                $recent["post_title"] .
            '</h1>' .
            apply_filters('the_content', $recent["post_comments"]) .
        '</article><aside>' .
            $recent["post_content"].
        '</aside>';
    };
} 
```

但不知何故，最后一个表达式`$recent["post_comments"]`没有返回任何东西。甚至没有原始评论文本。难道我做错了什么？我尝试了不同的语法，也使用`wp_list_comments( $args );`但从未真正发挥作用。

任何想法如何让这个工作？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T21:35:31.873

[`wp_get_recent_posts`](http://codex.wordpress.org/Function_Reference/wp_get_recent_posts)不返回帖子评论，查看[`get_post`返回值](http://codex.wordpress.org/Function_Reference/get_post#Return)以查看可用字段。

[`wp_list_comments`](http://codex.wordpress.org/Function_Reference/wp_list_comments)将显示评论列表，但您应该在[wordpress 循环](http://codex.wordpress.org/The_Loop)中使用它。

但是您可以使用[get_comments](http://codex.wordpress.org/Function_Reference/get_comments)来获取一组评论，看看 codex 上的示例。

PS：您使用的方式`wp_get_recent_posts`已弃用，您应该使用数组而不是`'1'`

# c# - How to code a good Offline-Online Dispatcher

> ID：12395778
> 
> 赞同：2
> 
> 时间：2012-09-12T20:31:03.817
> 
> 标签：c#, design-patterns, generics

Let's assume that I have this scenario: I have got 2 repositories of information, and I want to access both, but it would be nice to leave the task of deciding which repo to use to **common class**.

The goal is to accomplish this with something **similar** to the code I've wrote below, but this sounds pretty bad:

```
where TOnline : class
where TOffline : class
where TContract : class 
```

Sure I can ommit that, but bassically what I'm asking is what to do in order to stop using reflection and go **typed**. Maybe any *design-pattern* recomendation?

Code (if you copy/paste this on a console app replacing the `Program` class you should be able to run the example)

```
using CustomerDispatcher = DispatcherProxy<CustomerOnline, CustomerOffline, ICustomer>;

public interface ICustomer
{
    string Get(int id);
}

public class CustomerOnline : ICustomer
{
    public string Get(int id)
    {
        // Get From intranet DB
        return "From DB";
    }
}

public class CustomerOffline : ICustomer
{
    public string Get(int id)
    {
        // Get From local storage
        return "From local storage";
    }
}

public class DispatcherProxy<TOnline, TOffline, TContract>
    where TOnline : class
    where TOffline : class
    where TContract : class
{
    public TContract Instance { get; set; }

    public bool IsConnected { get; set; }

    public DispatcherProxy()
    {
        // Asume that I check if it's connected or not
        if (this.IsConnected)
            this.Instance = (TContract)Activator.CreateInstance(typeof(TOnline));
        else
            this.Instance = (TContract)Activator.CreateInstance(typeof(TOffline));
    }
}

class Program
{
    static void Main(string[] args)
    {
        var customerDispatcher = new CustomerDispatcher();

        Console.WriteLine("Result: " + customerDispatcher.Instance.Get(1));

        Console.Read();
    }
} 
```

Thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T21:49:29.060

如果你们中的任何人感兴趣，我不得不改变我这样做的方式，因为它正在检查**Constructor Level**的连接，我需要在**Operation Level**进行检查。

```
using System;
using Microsoft.Practices.Unity;
using Microsoft.Practices.Unity.InterceptionExtension;

namespace ConsoleApplication1
{
    public enum ConnectionStatus
    {
        Online,
        Offline,
        System // System checks connectivity
    }

    public static class Connectivity
    {
        private static ConnectionStatus ConnectionStatus = ConnectionStatus.Offline;

        public static void ForceConnectionStatus(ConnectionStatus connectionStatus)
        {
            ConnectionStatus = connectionStatus;
        }

        public static bool IsConnected()
        {
            switch (ConnectionStatus)
            {
                case ConnectionStatus.Online:
                    return true;
                case ConnectionStatus.Offline:
                    return false;
                case ConnectionStatus.System:
                    return CheckConnection();
            }
            return false;
        }

        private static bool CheckConnection()
        {
            return true;
        }
    }

    public class Unity
    {
        public static IUnityContainer Container;

        public static void Initialize()
        {
            Container = new UnityContainer();

            Container.AddNewExtension<Interception>();
            Container.RegisterType<ILogger, OnlineLogger>();
            Container.Configure<Interception>().SetInterceptorFor<ILogger>(new InterfaceInterceptor());
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            Unity.Initialize();

            var r = new Router<ILogger, OnlineLogger, OnlineLogger>();

            Connectivity.ForceConnectionStatus(ConnectionStatus.Offline);

            Console.WriteLine("Calling Online, will attend offline: ");

            r.Logger.Write("Used offline.");

            Connectivity.ForceConnectionStatus(ConnectionStatus.Online);

            Console.WriteLine("Calling Online, will attend online: ");

            r.Logger.Write("Used Online. Clap Clap Clap.");

            Console.ReadKey();
        }
    }

    public class Router<TContract, TOnline, TOffline>
        where TOnline : TContract
        where TOffline : TContract
    {
        public TContract Logger;

        public Router()
        {
            Logger = Unity.Container.Resolve<TContract>();
        }
    }

    public interface IOnline
    {
        IOffline Offline { get; set; }
    }

    public interface IOffline
    {
    }

    public interface ILogger
    {
        [Test()]
        void Write(string message);
    }

    public class OnlineLogger : ILogger, IOnline
    {
        public IOffline Offline { get; set; }

        public OnlineLogger()
        {
            this.Offline = new OfflineLogger();
        }

        public void Write(string message)
        {
            Console.WriteLine("Online Logger: " + message);
        }
    }

    public class OfflineLogger : ILogger, IOffline
    {
        public IOnline Online { get; set; }

        public void Write(string message)
        {
            Console.WriteLine("Offline Logger: " + message);
        }
    }

    [System.Diagnostics.DebuggerStepThroughAttribute()]
    public class TestAttribute : HandlerAttribute
    {
        public override ICallHandler CreateHandler(IUnityContainer container)
        {
            return new TestHandler();
        }
    }

    public class TestHandler : ICallHandler
    {
        public int Order { get; set; }

        public IMethodReturn Invoke(IMethodInvocation input, GetNextHandlerDelegate getNext)
        {
            Console.WriteLine("It's been intercepted.");

            if (!Connectivity.IsConnected() && input.Target is IOnline)
            {
                Console.WriteLine("It's been canceled.");

                var offline = ((input.Target as IOnline).Offline);

                if (offline == null)
                    throw new Exception("Online class did not initialized Offline Dispatcher.");

                var offlineResult = input.MethodBase.Invoke(offline, this.GetObjects(input.Inputs));

                return input.CreateMethodReturn(offlineResult, this.GetObjects(input.Inputs));
            }

            return getNext()(input, getNext);
        }

        private object[] GetObjects(IParameterCollection parameterCollection)
        {
            var parameters = new object[parameterCollection.Count];

            int i = 0;
            foreach (var parameter in parameterCollection)
            {
                parameters[i] = parameter;
                i++;
            }
            return parameters;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:37:43.817

您可以添加 new() 约束：

```
public class DispatcherProxy<TOnline, TOffline, TContract>
    where TOnline : class, new()
    where TOffline : class, new()
    where TContract : class //isn't TContract an interface?
{
    public TContract Instance { get; set; }

    public bool IsConnected { get; set; }

    public DispatcherProxy()
    {
        // Asume that I check if it's connected or not
        if (this.IsConnected)
            this.Instance = new TOnline() as TContract;
        else
            this.Instance = new TOffline() as TContract;
    }
} 
```

# c# - Passing custom object to RunWorkerCompleted event in case of an exception

> ID：12395782
> 
> 赞同：2
> 
> 时间：2012-09-12T20:31:15.177
> 
> 标签：c#, .net, multithreading, exception-handling

My Console App uses `System.ComponentModel.BackgroundWorker` for threading purposes:

```
System.ComponentModel.BackgroundWorker backgroundWorker = new System.ComponentModel.BackgroundWorker();

backgroundWorker.DoWork += (sender, e) =>
     ReportStatus(worker, status, result, e);
backgroundWorker.RunWorkerCompleted += new System.ComponentModel.RunWorkerCompletedEventHandler(backgroundWorker1_RunWorkerCompleted);
backgroundWorker.RunWorkerAsync(worker); 
```

As you can see that I am passing "worker" as an argument inside RunWorkerAsync.

What I am trying to achieve is that if there is an exception inside ReportStatus method I need the same "worker" object so that I can perform some operation (Call a service to notify that workers exception)

```
private void ReportStatus(Worker worker, Status status, WorkResult result,System.ComponentModel.DoWorkEventArgs arg)
{
    var proxy = new PreparationServiceProxy(new NetTcpBinding(), new EndpointAddress(PreparationEngineState.ServiceAddress));
    try
    {
        proxy.ReportStatus(worker, status, result);
        proxy.Close();
    }
    catch (Exception)
    {
        arg.Result = worker;
        proxy.Abort();
        throw;
    }
} 
```

In my exception block (I am not sure if this is the correct way!) I am assigning the worker to the Result so that I can get the same worker back when the RunWorkerCompleted method (backgroundWorker1_RunWorkerCompleted) is executed :

```
private void backgroundWorker1_RunWorkerCompleted(object sender, System.ComponentModel.RunWorkerCompletedEventArgs e)
{

    if (e.Error != null)
    {
        Worker worker = e.Result as Worker; // At this point I get an exception!
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:54:02.890

这是因为你重新抛出了异常。 `BackgroundWorker`将其视为处理程序未处理的异常，并在您获得值`DoWork`时将其重新扔回另一个线程。`Result`

如果您不希望它这样做，请删除处理程序`throw`中的 catch `DoWork`。

如果您将工作对象传递给`BackgroundWorker`，为什么不只使用您在异常处理程序中传入的内容，该异常处理程序包装对测试的调用`Result`或在测试块中`Error`？例如：

```
 if (e.Error != null)
        {
            worker.DoSomething(); // no access of Result
        } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T22:16:32.163

如果发生错误，.NET 不会认为异步操作可能会产生一些结果。这就是为什么你会以其他方式通过它。

我建议实现自定义异常类：

```
public class WorkerException:ApplicationException
{
    public WorkerException(Worker worker,Exception innerException):base(null,innerException)
    { Worker = worker; }

    public Worker Worker
    {
        get;
        set;
    }
} 
```

并相应地包装你的异常：

```
private void ReportStatus(Worker worker, Status status, WorkResult result,System.ComponentModel.DoWorkEventArgs arg)
{
    var proxy = new PreparationServiceProxy(new NetTcpBinding(), new EndpointAddress(PreparationEngineState.ServiceAddress));
    try
    {
        proxy.ReportStatus(worker, status, result);
        proxy.Close();
    }
    catch (Exception exception)
    {
        arg.Result = worker;
        proxy.Abort();
        throw new WorkerException(worker,exception);
    }
} 
```

在这种情况下，您将能够检索异常的 Worker，将 Error 转换为 WorkerException：

```
private void backgroundWorker1_RunWorkerCompleted(object sender, System.ComponentModel.RunWorkerCompletedEventArgs e)
{

    if (e.Error is WorkerException)
    {
        Worker worker = ((WorkerException)e.Error).Worker; // At this point I get an exception!
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-13T01:11:06.653

`RunWorkerCompletedEventArgs`包含一个`UserState`属性（我认为）应该是对您传递给该`RunWorkerAsync`方法的同一对象的引用。（它也应该在`DoWorkEventArgs`as`Argument`属性中。）

您需要进行试验以确认这`UserState`是正确的对象（强制转换它`as Worker`）并且即使`DoWork`处理程序抛出异常它也是有效的，但我认为这可能是您正在寻找的。

# python - Error when importing programs IDLE

> ID：12395790
> 
> 赞同：1
> 
> 时间：2012-09-12T20:31:56.643
> 
> 标签：python

Im new to Python but Im getting on pretty well, however I cannot seem to import save programs into IDLE. Could someone assist me where that is concerned, please. This is one of the errors no matter how simple the program is:

```
>>> import dinner

Traceback (most recent call last):
  File "<pyshell#17>", line 1, in <module>
    import dinner
  File "C:\Python25\dinner.py", line 1
    Python 2.5.4 (r254:67916, Dec 23 2008, 15:10:54) [MSC v.1310 32 bit (Intel)] on win32
             ^
SyntaxError: invalid syntax 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:46:37.763

`dinner.py`如果您的程序实际上从该行开始，这是您将得到的错误

```
Python 2.5.4 (r254:67916, Dec 23 2008, 15:10:54) [MSC v.1310 32 bit (Intel)] on win32 
```

但这不是一行有效的 Python 代码，而是解释器在启动时给出的消息。例如，我的说

```
~/coding$ python
Python 2.7.3 (default, Aug  1 2012, 05:16:07) 
[GCC 4.6.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```

然后我开始输入诸如`print 2+2`等之类的内容。您可以`dinner.py`在 IDLE 中打开并删除任何一开始看起来像此欢迎消息的部分。

顺便说一句，我看到您使用的是 Python 2.5.4。这现在已经很老了，从那以后添加了很多整洁的东西。我建议改用 2.7.3。

# jquery - fadeIn() - flickering images in Firefox

> ID：12395792
> 
> 赞同：0
> 
> 时间：2012-09-12T20:32:04.177
> 
> 标签：jquery

Demo-site: `http://83.249.244.210:8080/img/`

Try refreshing the site a few times in Firefox. When the images fade in, some of them flicker a bit. Can anyone please explain why?

This is how i load my images:

```
$(function(){

        $.post('service.php?getPhotos', function(data){

            var loadCount = 0;

            $.each(data, function(){

                $.post('service.php?getImage', { id: this.id }, function(data2){

                    loadCount++;

                    var $galleryItem = $('<div/>')
                        .hide()
                        .attr({ 'class': 'galleryItem' })
                        .html('<a href="'+ data2.photo.id +'"><img src="http://farm'+ data2.photo.farm +'.staticflickr.com/'+ data2.photo.server +'/'+ data2.photo.id +'_'+ data2.photo.secret + '_q.jpg"/></a><h3>'+ data2.photo.title._content +'</h3><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent euismod ultrices ante, ac laoreet nulla vestibulum adipiscing.</p>');

                    $('#container').append($galleryItem); 

                    $galleryItem.find('img').load(function(){

                        $galleryItem.fadeIn(200);
                    });

                });

            });
        });

    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:37:17.833

也许尝试在jQuery淡入之前用css隐藏图像？

```
#container > div {
    display: none;
} 
```

# cocos2d-iphone - Cocos2d 和新 iPhone 5 的长宽比

> ID：12395793
> 
> 赞同：7
> 
> 时间：2012-09-12T20:32:27.797
> 
> 标签：cocos2d-iphone, screen-resolution, aspect-ratio, iphone-5

我刚刚看到[iPhone 5](http://www.youtube.com/watch?v=DYb855lAkFs)的公告，它说像素分辨率已更改为1136 * 640，从而影响了应用程序的ASPECT RATIO。

我应该如何在我的 Cocos2d 游戏中处理这个问题？我为“旧”的 960*640 视网膜显示屏完成了所有图形，我猜这些图形在 iPhone 5 屏幕上会失真。

我对吗？或者是否会显示“旧分辨率”图像而不修改纵横比并留下一些屏幕黑色？

**编辑：**有没有办法让 Cocos2d 检测它是否是 iPhone 5，在这种情况下，在屏幕顶部（顶部 960 像素）绘制背景文件，并在剩余像素中绘制一些其他自定义背景文件（例如，这些可能是我们的游戏中仅适用于 iPhone 5 的一些自定义广告横幅或一些额外按钮）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-13T00:46:49.937

今天早上我刚刚为我的应用添加了 4 英寸的支持。Cocos2d 运行良好（在模拟器中），无需修改。我的所有场景都已正确调整大小，我只需要对某些位置进行一些修改，因为它们是固定坐标而不是相对坐标。

目前没有办法轻松加载不同的图像，我怀疑未来几天会有一个类似于 -hd 的新命名约定。

至于您的编辑问题，您可能会发现，一旦启用 4 英寸模式，您的布局顶部就会有很大的黑色空间。当然你可以放任何你想要的东西。

您可以使用以下方法检测它是否是高屏幕

```
[[UIScreen mainScreen] bounds].size.height 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-12T20:50:43.763

> iOS 将自动在应用程序的两侧放置细黑条，以便与应用程序最初为以前版本的 iPhone 设计的方式保持一致

有几个消息来源报告了这一点，这是[从这里](http://www.gametrailers.com/mobile-apps/29109/iphone-5-revealed-available-september-21-starting-at-199)。

到目前为止，由于没有可用的设备和 iOS 6，我们甚至不知道 cocos2d 是否需要或需要进行哪种修改以支持 iPhone 5。不用担心。不要假设。等着瞧。

与所有其他设备一样，将有办法检测确切的设备类型。同样，这将不得不等到我们至少获得 iOS 6。您可以加入测试计划以希望找到答案，但只要它处于测试阶段，此类信息就在 NDA 之下，您可能只能通过私人 Apple 找到开发者论坛。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-21T03:45:59.777

COCOS2d - v2.x

用以下代码替换 CCFileUtils.h 和 .m 并在委托内添加行：`[sharedFileUtils setiPhone5DisplaySuffix:@"-568h"]; // >>>>>> iPhone 5 -568h`

。H

```
/*
 * cocos2d for iPhone: http://www.cocos2d-iphone.org
 *
 * Copyright (c) 2008-2010 Ricardo Quesada
 * Copyright (c) 2011 Zynga Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 */

#import <Foundation/Foundation.h>
#import "../ccTypes.h"

/** Helper class to handle file operations */
@interface CCFileUtils : NSObject
{
    NSFileManager   *fileManager_;
    NSBundle        *bundle_;
    NSMutableDictionary *fullPathCache_;
    NSMutableDictionary *removeSuffixCache_;

#ifdef __CC_PLATFORM_IOS
    BOOL    enableFallbackSuffixes_;

    NSString *iPhoneRetinaDisplaySuffix_;
    NSString *iPhone5DisplaySuffix_;                            // <<<<<<<<<<<<< ADDED
    NSString *iPadSuffix_;
    NSString *iPadRetinaDisplaySuffix_;
#endif // __CC_PLATFORM_IOS
}

/** NSBundle used by CCFileUtils. By default it uses [NSBundle mainBundle].
 @since v2.0
 */
@property (nonatomic, readwrite, retain) NSBundle   *bundle;

/** NSFileManager used by CCFileUtils. By default it uses its own intance.
 @since v2.0
 */
@property (nonatomic, readwrite, retain) NSFileManager  *fileManager;

#ifdef __CC_PLATFORM_IOS
/** The iPhone RetinaDisplay suffixes to load resources.
 By default it is "-hd" and "" in that order.
 Only valid on iOS. Not valid for OS X.

 @since v1.1
 */
@property (nonatomic,readwrite, copy, setter = setiPhoneRetinaDisplaySuffix:) NSString *iPhoneRetinaDisplaySuffix;

/** The iPhone 5 suffixes to load resources.
 By default it is "-hd" and "" in that order.
 Only valid on iOS. Not valid for OS X.

 @since v1.1
 */
@property (nonatomic,readwrite, copy, setter = setiPhone5DisplaySuffix:) NSString *iPhone5DisplaySuffix;

/** The iPad suffixes to load resources.
 By default it is "-ipad", "-hd", "", in that order.
 Only valid on iOS. Not valid for OS X.

 @since v1.1
 */
@property (nonatomic,readwrite, copy, setter = setiPadSuffix:) NSString *iPadSuffix;

/** Sets the iPad Retina Display suffixes to load resources.
 By default it is "-ipadhd", "-ipad", "-hd", "", in that order.
 Only valid on iOS. Not valid for OS X.

 @since v2.0
 */
@property (nonatomic,readwrite, copy, setter = setiPadRetinaDisplaySuffix:) NSString *iPadRetinaDisplaySuffix;

/** Whether of not the fallback sufixes is enabled.
 When enabled it will try to search for the following suffixes in the following order until one is found:
   * On iPad HD  : iPad HD suffix, iPad suffix, iPhone HD suffix, Without suffix
   * On iPad     : iPad suffix, iPhone HD suffix, Without suffix
   * On iPhone HD: iPhone HD suffix, Without suffix

 By default this functionality is off;
*/
@property (nonatomic, readwrite) BOOL enableFallbackSuffixes;

 #endif // __CC_PLATFORM_IOS

/** returns the shared file utils instance */
+(CCFileUtils*) sharedFileUtils;

/** Purge cached entries.
 Will be called automatically by the Director when a memory warning is received
 */
-(void) purgeCachedEntries;

/** Returns the fullpath of an filename.

 If in iPhoneRetinaDisplay mode, and a RetinaDisplay file is found, it will return that path.
 If in iPad mode, and an iPad file is found, it will return that path.

 Examples:

  * In iPad mode: "image.png" -> "/full/path/image-ipad.png" (in case the -ipad file exists)
  * In iPhone RetinaDisplay mode: "image.png" -> "/full/path/image-hd.png" (in case the -hd file exists)
  * In iPad RetinaDisplay mode: "image.png" -> "/full/path/image-ipadhd.png" (in case the -ipadhd file exists)

 */
-(NSString*) fullPathFromRelativePath:(NSString*) relPath;

/** Returns the fullpath of an filename including the resolution of the image.

 If in RetinaDisplay mode, and a RetinaDisplay file is found, it will return that path.
 If in iPad mode, and an iPad file is found, it will return that path.

 Examples:

 * In iPad mode: "image.png" -> "/full/path/image-ipad.png" (in case the -ipad file exists)
 * In iPhone RetinaDisplay mode: "image.png" -> "/full/path/image-hd.png" (in case the -hd file exists)
 * In iPad RetinaDisplay mode: "image.png" -> "/full/path/image-ipadhd.png" (in case the -ipadhd file exists)

 If an iPad file is found, it will set resolution type to kCCResolutioniPad
 If a RetinaDisplay file is found, it will set resolution type to kCCResolutionRetinaDisplay

 */
-(NSString*) fullPathFromRelativePath:(NSString*)relPath resolutionType:(ccResolutionType*)resolutionType;

#ifdef __CC_PLATFORM_IOS

/** removes the suffix from a path
 * On iPhone RetinaDisplay it will remove the -hd suffix
 * On iPad it will remove the -ipad suffix
 * On iPad RetinaDisplay it will remove the -ipadhd suffix

 Only valid on iOS. Not valid for OS X.

 @since v0.99.5
 */
-(NSString *)removeSuffixFromFile:(NSString*) path;

/** Returns whether or not a given path exists with the iPhone RetinaDisplay suffix.
 Only available on iOS. Not supported on OS X.
 @since v1.1
 */
-(BOOL) iPhoneRetinaDisplayFileExistsAtPath:(NSString*)filename;

/** Returns whether or not a given path exists with the iPhone 5 suffix.
 Only available on iOS. Not supported on OS X.
 @since v1.1
 */
-(BOOL) iPhone5DisplayFileExistsAtPath:(NSString*)filename;

/** Returns whether or not a given filename exists with the iPad suffix.
 Only available on iOS. Not supported on OS X.
 @since v1.1
 */
-(BOOL) iPadFileExistsAtPath:(NSString*)filename;

/** Returns whether or not a given filename exists with the iPad RetinaDisplay suffix.
 Only available on iOS. Not supported on OS X.
 @since v2.0
 */
-(BOOL) iPadRetinaDisplayFileExistsAtPath:(NSString*)filename;

#endif // __CC_PLATFORM_IOS

@end

#ifdef __cplusplus
extern "C" {
#endif

/** loads a file into memory.
 the caller should release the allocated buffer.

 @returns the size of the allocated buffer
 @since v0.99.5
 */
NSInteger ccLoadFileIntoMemory(const char *filename, unsigned char **out);

#ifdef __cplusplus
}
#endif 
```

.m

```
/*
 * cocos2d for iPhone: http://www.cocos2d-iphone.org
 *
 * Copyright (c) 2008-2010 Ricardo Quesada
 * Copyright (c) 2011 Zynga Inc.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 */

#import "CCFileUtils.h"
#import "../CCConfiguration.h"
#import "../ccMacros.h"
#import "../ccConfig.h"
#import "../ccTypes.h"

enum {
    kCCiPhone,
    kCCiPhoneRetinaDisplay,
    kCCiPhone5Display,
    kCCiPad,
    kCCiPadRetinaDisplay,
};

#pragma mark - Helper free functions

NSInteger ccLoadFileIntoMemory(const char *filename, unsigned char **out)
{
    NSCAssert( out, @"ccLoadFileIntoMemory: invalid 'out' parameter");
    NSCAssert( &*out, @"ccLoadFileIntoMemory: invalid 'out' parameter");

    size_t size = 0;
    FILE *f = fopen(filename, "rb");
    if( !f ) {
        *out = NULL;
        return -1;
    }

    fseek(f, 0, SEEK_END);
    size = ftell(f);
    fseek(f, 0, SEEK_SET);

    *out = malloc(size);
    size_t read = fread(*out, 1, size, f);
    if( read != size ) {
        free(*out);
        *out = NULL;
        return -1;
    }

    fclose(f);

    return size;
}

#pragma mark - CCCacheValue

@interface CCCacheValue : NSObject
{
    NSString            *fullpath_;
    ccResolutionType    resolutionType_;
}
@property (nonatomic, readwrite, retain) NSString *fullpath;
@property (nonatomic, readwrite ) ccResolutionType resolutionType;
@end

@implementation CCCacheValue
@synthesize fullpath = fullpath_, resolutionType = resolutionType_;
-(id) initWithFullPath:(NSString*)path resolutionType:(ccResolutionType)resolutionType
{
    if( (self=[super init]) )
    {
        self.fullpath = path;
        self.resolutionType = resolutionType;
    }

    return self;
}

- (void)dealloc
{
    [fullpath_ release];

    [super dealloc];
}
@end

#pragma mark - CCFileUtils

#ifdef __CC_PLATFORM_IOS
@interface CCFileUtils()
-(NSString *) removeSuffix:(NSString*)suffix fromPath:(NSString*)path;
-(BOOL) fileExistsAtPath:(NSString*)string withSuffix:(NSString*)suffix;
-(NSInteger) runningDevice;
@end
#endif // __CC_PLATFORM_IOS

@implementation CCFileUtils

@synthesize fileManager=fileManager_, bundle=bundle_;
#ifdef __CC_PLATFORM_IOS
@synthesize iPhoneRetinaDisplaySuffix = iPhoneRetinaDisplaySuffix_;
@synthesize iPhone5DisplaySuffix = iPhone5DisplaySuffix_;
@synthesize iPadSuffix = iPadSuffix_;
@synthesize iPadRetinaDisplaySuffix = iPadRetinaDisplaySuffix_;
@synthesize enableFallbackSuffixes = enableFallbackSuffixes_;
#endif // __CC_PLATFORM_IOS

+ (id)sharedFileUtils
{
    static dispatch_once_t pred;
    static CCFileUtils *fileUtils = nil;
    dispatch_once(&pred, ^{
        fileUtils = [[self alloc] init];
    });
    return fileUtils;
}

-(id) init
{
    if( (self=[super init])) {
        fileManager_ = [[NSFileManager alloc] init];

        fullPathCache_ = [[NSMutableDictionary alloc] initWithCapacity:30];
        removeSuffixCache_ = [[NSMutableDictionary alloc] initWithCapacity:30];

        bundle_ = [[NSBundle mainBundle] retain];

#ifdef __CC_PLATFORM_IOS
        iPhoneRetinaDisplaySuffix_ = @"-hd";
        iPhone5DisplaySuffix_ = @"-568h";
        iPadSuffix_ = @"-ipad";
        iPadRetinaDisplaySuffix_ = @"-ipadhd";

        enableFallbackSuffixes_ = NO;
#endif // __CC_PLATFORM_IOS

    }

    return self;
}

-(void) purgeCachedEntries
{
    [fullPathCache_ removeAllObjects];  
    [removeSuffixCache_ removeAllObjects];
}

- (void)dealloc
{
    [fileManager_ release];
    [bundle_ release];
    [fullPathCache_ release];
    [removeSuffixCache_ release];

#ifdef __CC_PLATFORM_IOS    
    [iPhoneRetinaDisplaySuffix_ release];
    [iPhone5DisplaySuffix_ release];
    [iPadSuffix_ release];
    [iPadRetinaDisplaySuffix_ release];
#endif // __CC_PLATFORM_IOS

    [super dealloc];
}

-(NSString*) pathForResource:(NSString*)resource ofType:(NSString *)ext inDirectory:(NSString *)subpath
{
    return [bundle_ pathForResource:resource
                             ofType:ext
                        inDirectory:subpath];
}

-(NSString*) getPath:(NSString*)path forSuffix:(NSString*)suffix
{
    NSString *newName = path;

    // only recreate filename if suffix is valid
    if( suffix && [suffix length] > 0)
    {
        NSString *pathWithoutExtension = [path stringByDeletingPathExtension];
        NSString *name = [pathWithoutExtension lastPathComponent];

        // check if path already has the suffix.
        if( [name rangeOfString:suffix].location == NSNotFound ) {

            NSString *extension = [path pathExtension];

            if( [extension isEqualToString:@"ccz"] || [extension isEqualToString:@"gz"] )
            {
                // All ccz / gz files should be in the format filename.xxx.ccz
                // so we need to pull off the .xxx part of the extension as well
                extension = [NSString stringWithFormat:@"%@.%@", [pathWithoutExtension pathExtension], extension];
                pathWithoutExtension = [pathWithoutExtension stringByDeletingPathExtension];
            }

            newName = [pathWithoutExtension stringByAppendingString:suffix];
            newName = [newName stringByAppendingPathExtension:extension];
        } else
            CCLOGWARN(@"cocos2d: WARNING Filename(%@) already has the suffix %@. Using it.", name, suffix);
    }

    NSString *ret = nil;
    // only if it is not an absolute path
    if( ! [path isAbsolutePath] ) {

        // pathForResource also searches in .lproj directories. issue #1230
        NSString *imageDirectory = [path stringByDeletingLastPathComponent];

        // If the file does not exist it will return nil.
        ret = [self pathForResource:[newName lastPathComponent]
                                                   ofType:nil
                                              inDirectory:imageDirectory];
    }
    else if( [fileManager_ fileExistsAtPath:newName] )
        ret = newName;

    if( ! ret )
        CCLOGINFO(@"cocos2d: CCFileUtils: file not found: %@", [newName lastPathComponent] );

    return ret;
}

-(NSString*) fullPathFromRelativePath:(NSString*)relPath resolutionType:(ccResolutionType*)resolutionType
{
    NSAssert(relPath != nil, @"CCFileUtils: Invalid path");

    CCCacheValue *value = [fullPathCache_ objectForKey:relPath];
    if( value ) {
        *resolutionType = value.resolutionType;
        return value.fullpath;
    }

    // Initialize to non-nil
    NSString *ret = @"";

#ifdef __CC_PLATFORM_IOS

    NSInteger device = [self runningDevice];

    // iPad HD ?
    if( device == kCCiPadRetinaDisplay ) {
        ret = [self getPath:relPath forSuffix:iPadRetinaDisplaySuffix_];
        *resolutionType = kCCResolutioniPadRetinaDisplay;
    }

    // iPad ?
    if( device == kCCiPad || (enableFallbackSuffixes_ && !ret) ) {
        ret = [self getPath:relPath forSuffix:iPadSuffix_];
        *resolutionType = kCCResolutioniPad;
    }

    // iPhone HD ?
    if( device == kCCiPhoneRetinaDisplay || (enableFallbackSuffixes_ && !ret) ) {
        ret = [self getPath:relPath forSuffix:iPhoneRetinaDisplaySuffix_];
        *resolutionType = kCCResolutioniPhoneRetinaDisplay;
    }

    // If it is not Phone HD, or if the previous "getPath" failed, then use iPhone images.
    if( device == kCCiPhone || !ret )
    {
        ret = [self getPath:relPath forSuffix:@""];
        *resolutionType = kCCResolutioniPhone;
    }

#elif defined(__CC_PLATFORM_MAC)

    *resolutionType = kCCResolutionMac;

    ret = [self getPath:relPath forSuffix:@""];

#endif // __CC_PLATFORM_MAC

    if( ! ret ) {
        CCLOGWARN(@"cocos2d: Warning: File not found: %@", relPath);
        ret = relPath;
    }

    value = [[CCCacheValue alloc] initWithFullPath:ret resolutionType:*resolutionType];
    [fullPathCache_ setObject:value forKey:relPath];
    [value release];

    return ret;
}

-(NSString*) fullPathFromRelativePath:(NSString*) relPath
{
    ccResolutionType ignore;
    return [self fullPathFromRelativePath:relPath resolutionType:&ignore];
}

#pragma mark CCFileUtils - Suffix (iOS only)

#ifdef __CC_PLATFORM_IOS

// XXX: Optimization: This should be called only once
-(NSInteger) runningDevice
{
    NSInteger ret=-1;

    if( UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
    {
        if( CC_CONTENT_SCALE_FACTOR() == 2 )
            ret = kCCiPadRetinaDisplay;
        else
            ret = kCCiPad;
    }
    else
    {
        if( CC_CONTENT_SCALE_FACTOR() == 2 )

            if (([[UIScreen mainScreen] bounds].size.width == 640) || ([[UIScreen mainScreen] bounds].size.width == 1136))
            {

                ret = kCCiPhone5Display;

            } else {

                ret = kCCiPhoneRetinaDisplay;

            }
        else
            ret = kCCiPhone;
    }

    return ret;
}

-(NSString *) removeSuffix:(NSString*)suffix fromPath:(NSString*)path
{
    // quick return
    if( ! suffix || [suffix length] == 0 )
        return path;

    NSString *name = [path lastPathComponent];

    // check if path already has the suffix.
    if( [name rangeOfString:suffix].location != NSNotFound ) {

        CCLOGINFO(@"cocos2d: Filename(%@) contains %@ suffix. Removing it. See cocos2d issue #1040", path, suffix);

        NSString *newLastname = [name stringByReplacingOccurrencesOfString:suffix withString:@""];

        NSString *pathWithoutLastname = [path stringByDeletingLastPathComponent];
        return [pathWithoutLastname stringByAppendingPathComponent:newLastname];
    }

    // suffix was not removed
    return nil;
}

-(NSString*) removeSuffixFromFile:(NSString*) path
{
    NSString *withoutSuffix = [removeSuffixCache_ objectForKey:path];
    if( withoutSuffix )
        return withoutSuffix;

    // Initial value should be non-nil
    NSString *ret = @"";

    NSInteger device = [self runningDevice];

    if( device == kCCiPadRetinaDisplay )
        ret = [self removeSuffix:iPadRetinaDisplaySuffix_ fromPath:path];

    if( device == kCCiPad || (enableFallbackSuffixes_ && !ret) )
       ret = [self removeSuffix:iPadSuffix_ fromPath:path];

    if( device == kCCiPhoneRetinaDisplay || (enableFallbackSuffixes_ && !ret) )
        ret = [self removeSuffix:iPhoneRetinaDisplaySuffix_ fromPath:path];

    if( device == kCCiPhone5Display || (enableFallbackSuffixes_ && !ret) )
        ret = [self removeSuffix:iPhone5DisplaySuffix_ fromPath:path];

    if( device == kCCiPhone || !ret )
        ret = path; 

    if( ret )
        [removeSuffixCache_ setObject:ret forKey:path];

    return ret;
}

-(BOOL) fileExistsAtPath:(NSString*)relPath withSuffix:(NSString*)suffix
{
    NSString *fullpath = nil;

    // only if it is not an absolute path
    if( ! [relPath isAbsolutePath] ) {
        // pathForResource also searches in .lproj directories. issue #1230
        NSString *file = [relPath lastPathComponent];
        NSString *imageDirectory = [relPath stringByDeletingLastPathComponent];

        fullpath = [bundle_ pathForResource:file
                                                   ofType:nil
                                              inDirectory:imageDirectory];

    }

    if (fullpath == nil)
        fullpath = relPath;

    NSString *path = [self getPath:fullpath forSuffix:suffix];

    return ( path != nil );
}

-(BOOL) iPhoneRetinaDisplayFileExistsAtPath:(NSString*)path
{
    return [self fileExistsAtPath:path withSuffix:iPhoneRetinaDisplaySuffix_];
}

-(BOOL) iPhone5DisplayFileExistsAtPath:(NSString*)path
{
    return [self fileExistsAtPath:path withSuffix:iPhoneRetinaDisplaySuffix_];
}

-(BOOL) iPadFileExistsAtPath:(NSString*)path
{
    return [self fileExistsAtPath:path withSuffix:iPadSuffix_];
}

-(BOOL) iPadRetinaDisplayFileExistsAtPath:(NSString*)path
{
    return [self fileExistsAtPath:path withSuffix:iPadRetinaDisplaySuffix_];
}

#endif // __CC_PLATFORM_IOS

@end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T10:01:40.360

你们所有人都提出了很好的解决方案，但会有某种命名约定，例如分别用于 ratina 显示和 iphone 5 启动图像的@2x 和 h@2x。

谢谢马诺

# python - Pyqt默认进度条没有正确缩放

> ID：12395796
> 
> 赞同：1
> 
> 时间：2012-09-12T20:32:31.247
> 
> 标签：python, qt, user-interface, pyqt4

我刚开始使用 Pyqt，我的操作系统是 Lubuntu 12.04。我用 Qt 设计器在一个空窗口中创建了一个进度条，问题是它似乎没有正确缩放。

当值在 0 和 2 之间时，进度条图像仍然存在并且看起来很难看：

![0%](../Images/558f46f16137d688b9ac933e9a208671.png) .

进度条的开头应该是空的（或者至少我是这么认为的）

我不知道它是否与操作系统相关的问题，或者只是我做错了什么。有什么办法解决吗？

# google-chrome-extension - Javascript 等待请求在 for 循环中处理

> ID：12395804
> 
> 赞同：0
> 
> 时间：2012-09-12T20:33:06.210
> 
> 标签：google-chrome-extension, javascript

在我的 chrome 扩展中，我正在检查一个函数，该函数可以阻止我的 for 循环处理，直到它得到内容脚本的响应。分享下面的示例代码

```
function abc() {
  chrome.tabs.query({'status': 'complete'}, function(tabArray) {
    for (var i = 0, tab; tab = tabArray[i]; i++) {
      var currentUrl = tab.url;
      var tabId = tab.id;
      if (currentUrl.match(otherthing)) {
        chrome.tabs.sendRequest(tabId, {'type': 'getrequiredthing'},
            function(response) {
              if (response.isrequiredthind) {
                callfunction(tabId);
              }
            }
        ); 
      }
    }
  });
} 
```

在这里，当我得到匹配的 url 时，`else if`我正在向页面发送获取一些信息的请求，如果我的信息是肯定的，我需要调用函数。但是在 for 循环中，tabId 的迭代速度非常快，即使响应是肯定的，它也会使用 next（或 next）tabId 调用 callfunction。

您能否就解决此问题发表意见，请继续等待收到此响应的 for 循环。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:48:44.453

问题是 sendRequest 的第三个参数不会阻塞准备好的请求。按照设计，JavaScript 几乎从不阻塞。这是一件好事。相反，它使用“事件驱动”模型。

另一个问题是由于词法作用域：调用 callfunction 时，tabId 具有最近的值，而不是调用 sendRequest 时的值。为了解决这个问题，您需要为每个循环迭代创建一个单独的范围，例如

```
for (...) {
  var tabId = ...;
  if (...) {
    (function (localTabId) {
      chrome.tabs.SendRequest(..., function (response) {
        if (response.isrequiredthind) {
          callfunction(localTabId);
        }
      }
    })(tabId);
  }
} 
```

# javascript - JavaScript 不会运行，但可以在 jsFiddle 中运行

> ID：12395812
> 
> 赞同：0
> 
> 时间：2012-09-12T20:33:38.950
> 
> 标签：javascript, html

[我在 jsFiddle jsFiddle](http://jsfiddle.net/S4C5a/6/)中有以下测试项目，它按预期运行并且 JSLint 报告代码有效。

然后我将 html 复制并粘贴到记事本中的空白文本文件中并另存为 randomfilename.html

当我单击 html 文件时，我看到了文件选择器，我可以选择文件但图表不呈现。任何想法为什么？我在 IE、Chrome 和 Firefox 中尝试过，但它们都没有图表。

谢谢

编辑：这就是我现在在名为 randomfilename.html 的文本文件中的内容

它不工作

`Chrome 21.0.1180.89 m`还是我最新的 Firefox/IE？

```
<!DOCTYPE html>
<html>

<script src="http://code.highcharts.com/stock/highstock.js"></script>
<script src="http://code.highcharts.com/stock/modules/exporting.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<input type="file" id="files" name="file" />
<div id="container" style="height: 500px; min-width: 500px"></div>
<div id="testString"></div>

<script>

var dataString = new Array (
[1341187200000,592.52],[1341273600000,599.41],[1341446400000,609.94],[1341532800000,605.88],[1341792000000,613.89],[1341878400000,608.21],
[1341964800000,604.43],[1342051200000,598.90],[1342137600000,604.97],[1342396800000,606.91],[1342483200000,606.94],[1342569600000,606.26],
[1342656000000,614.32],[1342742400000,604.30],[1343001600000,603.83]);

function handleFileSelect(evt)
{
    var files = evt.target.files; // FileList object

    for (var i = 0, f; f = files[i]; i++)
    {

        var reader = new FileReader();
        reader.onload = (function(reader)
        {
            return function()
            {
                var contents = reader.result;
                document.getElementById('testString').innerHTML=contents;
                var gx;   
                gx=dataString;            
                renderChart(gx);  
}    
        })(reader);

        reader.readAsText(f);
    }
}

function renderChart(data) {
        // Create the chart
        window.chart = new Highcharts.StockChart({
            chart : {
                renderTo : 'container'
            },

            rangeSelector : {
                selected : 1
            },

            title : {
                text : 'AAPL Stock Price'
            },

            series : [{
                name : 'AAPL',
                data : data,
                tooltip: {
                    valueDecimals: 2
                }
            }]
        });
    };

document.getElementById('files').addEventListener('change', handleFileSelect, false);
</script>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T20:38:06.407

我认为您忘记包含 jQuery 库。使用 jsFiddle 时，它​​允许您指定要自动包含在 HTML 中的 JS 库（您实际上看不到）。当您从 jsFiddle 复制/粘贴 HTML 时，不会复制包括在内的 jQuery 库。尝试添加类似：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script> 
```

就在其他`<script>`标签的正上方（仅在您复制/粘贴到的文本文件中...您不需要在 jsFiddle 中执行此操作，因为它会自动“完成”）。

并不是说这会破坏它，但是您的 HTML 中还缺少`<head>`and`<body>`部分。我不确定 HTML5 是否将其设为可选，但您可能想要添加这些。即使`<head></head>`是空的，它也应该被包含在内......并且您在 current 中的所有代码`<html></html>`都应该在嵌套的`<body></body>`.

# .net - Silverlight 手风琴标签问题

> ID：12395814
> 
> 赞同：0
> 
> 时间：2012-09-12T20:33:48.453
> 
> 标签：.net, silverlight, silverlight-4.0, accordion

全部，

我有一个简单的手风琴，有 2 个手风琴项目，每个项目包含 4 个文本框。当我进入手风琴项目时，为什么我不能在手风琴项目中的每个文本框中进行标签？我几乎尝试了从 tabindex 到 TabNavigation='Local' & 'Cycle' 的所有方法。

我希望能够在手风琴项目中的所有文本框之间切换。

要求的代码：

```
<UserControl x:Class="Pimarc.Silverlight.Commerce.UI.View.TestView"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
mc:Ignorable="d"
d:DesignHeight="300" d:DesignWidth="400" xmlns:toolkit="http://schemas.microsoft.com/winfx/2006/xaml/presentation/toolkit">

<Grid x:Name="LayoutRoot" Background="White">
    <toolkit:Accordion HorizontalAlignment="Left" Margin="30,46,0,0" Name="accordion1" VerticalAlignment="Top" Width="200">
        <toolkit:AccordionItem Header="abac" IsTabStop="True" TabNavigation="Cycle">
            <StackPanel>
            <TextBox Name="textBox1" Width="120" TabIndex="0" />
                <TextBox Name="textBox2" Width="120" TabIndex="1" />
                <TextBox Name="textBox3" Width="120" TabIndex="2" />
                <TextBox Name="textBox4" Width="120" TabIndex="3"/>
            </StackPanel>
        </toolkit:AccordionItem>

        <toolkit:AccordionItem Header="bob">
            <StackPanel>
            <TextBox Name="textBox5" VerticalAlignment="Top" Width="120" />
            <TextBox Name="textBox6" VerticalAlignment="Top" Width="120" />
            <TextBox Name="textBox71" VerticalAlignment="Top" Width="120" />
            <TextBox Name="textBox81" VerticalAlignment="Top" Width="120" />
            </StackPanel>
        </toolkit:AccordionItem>
    </toolkit:Accordion>
</Grid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:49:12.673

这是手风琴的一个已知问题，请参阅：[手风琴控件中的控件的选项卡顺序](http://silverlight.codeplex.com/workitem/3922?ProjectName=silverlight)

但是有一个简单的解决方法：

您需要`TabNavigation`在`ExpandableContentControlStyle`.

所以你需要创建一个样式：

```
<Style x:Key="TabNavigationStyle" TargetType="toolkit:ExpandableContentControl">
    <Setter Property="TabNavigation" Value="Cycle" />
</Style> 
```

并在你的`AccordionItem`：

```
<toolkit:AccordionItem Header="abac" IsTabStop="True" 
     ExpandableContentControlStyle="{StaticResource TabNavigationStyle}"> 
```

# c# - WCF 并行模拟

> ID：12395819
> 
> 赞同：4
> 
> 时间：2012-09-12T20:34:04.433
> 
> 标签：c#, wcf, impersonation, parallel-extensions

我有一个带有“ImpersonationOption.Required”的 WCF 服务。使用并行性时，模拟似乎没有通过。例如：

```
Parallel.ForEach(items => results.Add(SystemUtil.WindowsUser.Name) 
```

将返回一个带有模拟用户的号码，以及一个带有应用程序池用户的号码。可以使模拟与并行性一起工作吗？

最好的，

马克

**更新：**

这是 IIS 服务端的实际代码。

```
[OperationBehavior(Impersonation = ImpersonationOption.Required)]
public string[] WhoAmI(int numOfTests)
{
    var tests = new List<int>();
    for (var i = 0; i < numOfTests; i++)
        tests.Add(i);

    var results = new ConcurrentBag<string>();
    Parallel.ForEach(tests, (test) => results.Add(WindowsIdentity.GetCurrent(false).Name));
    return results.ToArray();
} 
```

如果我传入 numOfTests = 10，它会生成 10 个任务并返回每个任务的 WindowsIndentity 名称。我得到的是〜70％的“IIS APPPOOL.NET v4.0”和〜​​30％的我。

我如何设置它以使我的身份始终进入 Parallel.ForEach？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T13:55:28.557

你需要自己处理。尝试这样的事情：

```
IntPtr token = WindowsIdentity.GetCurrent().Token;

Parallel.ForEach( Enumerable.Range( 1, 100 ), ( test ) =>
{
    using ( WindowsIdentity.Impersonate( token ) )
    {
          Console.WriteLine( WindowsIdentity.GetCurrent( false ).Name );
    }
} ); 
```

# google-apps-script - 使用 gid 访问工作表

> ID：12395820
> 
> 赞同：10
> 
> 时间：2012-09-12T20:34:21.137
> 
> 标签：google-apps-script, google-sheets

抱歉，如果我的问题在其他地方得到了回答，我整个下午都在谷歌上寻找答案，但我还是太新手了。

我正在尝试使用 Google 电子表格的脚本来访问不同的电子表格。我拥有的唯一信息是电子表格的 URL，其中包含密钥和 gid（多页电子表格的某种按时间顺序排列的索引——我能找到的唯一信息[在这里](https://developers.google.com/chart/interactive/docs/spreadsheets)）。

工作表 URL 类似于`https://docs.google.com/spreadsheet/ccc?key=abc123#gid=178` 它链接到的工作表是电子表格中的第一个工作表。

我如何找到匹配的表`gid`？

以下内容不起作用，因为它基于工作表的顺序，而不是创建时间：

```
var ss = SpreadsheetApp.openById("abc123");

var sheet = ss.getSheets();
Browser.msgBox(sheets[178].getIndex()); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-19T20:04:21.080

我会做这样简单的事情：

```
var refSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("SHEET NAME HERE");
var refSheetId = refSheet.getSheetId().toString(); 
```

然后将 refSheetId 附加到 getUrl 字符串的末尾

```
var ssUrl = SpreadsheetApp.getActiveSpreadsheet().getUrl()+"#gid="+refSheetId; 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-06-06T07:35:27.103

我就是这样做的：

```
function getSheetByGid(spreadsheet, gid){
    gid = +gid || 0;
    var res_ = undefined;
    var sheets_ = spreadsheet.getSheets();
    for(var i = sheets_.length; i--; ){
        if(sheets_[i].getSheetId() === gid){
            res_ = sheets_[i];
            break;
        }
    }

    return res_;
}

var sheet = SpreadsheetApp.openById("YOUR_SHEET_ID_HERE");
var seetWithGid = getSheetByGid(cpSheet, "YOUR_GID_HERE"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-30T19:35:56.817

我知道这已经晚了，并且可能不再对原始请求者有用。但是我在处理功能时看到了这个问题，但后来我自己解决了。您可以通过 gid 查找工作表，并且当您删除工作表时它不会更改这一事实是一件好事......如果您打算使用它。基本上我得到所有工作表，并遍历工作表名称和工作表 gid 直到 gid 匹配，然后我按名称调用工作表。

这是我用来从编辑聚合表中获取一行的一些代码的一部分，并作为双向同步的一部分推送到子表。如果您只存储了 gid 和密钥，则可以跳过我显示的步骤，只需引用这些值。它似乎工作得非常快，它是一个更复杂的脚本，然后从带有分解表的工作簿运行，但两个脚本几乎都需要 2 秒才能推送，这对我来说是可以接受的。

```
function Stest() 
 {
  SpreadsheetApp.flush();
  var sheet = SpreadsheetApp.getActiveSheet();
  var r = sheet.getActiveRange();
  var lastColumnRow = sheet.getLastColumn(); 
  var activeRow = r.getRow();
  var dataRange = sheet.getRange(activeRow,1,1,lastColumnRow);  
  var data = dataRange.getValues();

   var sskeytemp = data[0][10].split("=")[1]; //the sheet url is in column k
   var sskey = sskeytemp.split("#")[0]; //these first two steps get the sheet key
   var ssid = data[0][10].split("gid=")[1]; //this last step gets the gid
   var wrkbk = SpreadsheetApp.openById(sskey).getSheets(); //this gets the sheets from the workbook

   for (var i = 0 ; i < wrkbk.length ; i++ ) {
     if( ssid == wrkbk[i].getSheetId() ){ //this is to say if the spreadsheet gid, which is the gid of the sheet i know, matches the gid in the workbook from the link, thats the sheet i'm looking for
     var ssname= wrkbk[i].getName();
     var ss = SpreadsheetApp.openById(sskey).getSheetByName(ssname); //give me that sheet by name

    var sslastColumn = ss.getLastColumn();
    var sslastRow = ss.getLastRow();
    var dataRange = ss.getRange(1,1,sslastRow,sslastColumn);  
    var data2 = dataRange.getValues(); //here's your data range, you can proceed freely from here 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-13T04:39:13.377

最好不要依赖gid，原因很多

1.  已删除的工作表不会显示在您的 getSheets() 方法中，但会在 gid 中显示 例如：

创建 Sheet1（默认情况下，gid#1）

创建 Sheet2 (gid#2)

删除 Sheet2

创建 Sheet3 (gid#3)

1.  如果用户决定在电子表格 UI 中移动工作表，则顺序将混乱。getSheets 按照它们在电子表格中的排列顺序返回工作表。

您可以访问工作表的唯一方法是通过其名称。或者，如果您知道工作表中的某些内容，则可以搜索每个工作表。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-20T19:35:39.077

**或者**，这对我来说很完美：

```
function _getSheetId() {
var getSpreadsheetURL = SpreadsheetApp.getActiveSpreadsheet().getUrl();
var mat = getSpreadsheetURL.match(/^(https:\/\/docs\.google\.com\/spreadsheets\/d\/)([a-zA-Z0-9]+\/)/g);
Logger.log(mat.toString()+"#gid="+SpreadsheetApp.getActiveSpreadsheet().getActiveSheet().getSheetId());
} 
```

# mysql - spring + hibernate + 数据库连接池和高可用

> ID：12395826
> 
> 赞同：2
> 
> 时间：2012-09-12T20:35:01.523
> 
> 标签：mysql, spring, hibernate, cluster-computing, failover

我正在尝试像这样配置我的 Web 应用程序： 1 个 tomcat 服务器 2 个 mysql 数据库在主/主复制中用于故障转移目的。

我还成功地使用 c3p0 设置了一个池连接，从而避免为每个请求打开一个新的连接（当不涉及故障转移时）

我想使用 jdbc 连接器提供的故障转移支持，以便在第一个数据库不可用时将请求路由到第二个数据库。因此，我使用 jdbc 驱动程序的故障转移功能，只需提供额外的配置参数。

目前，当一个服务器不可用时，请求被路由到第二个可用服务器。但是，对于每个请求，我都面临数据库上新打开的连接的问题。

似乎将连接池和 jdbc 故障转移结合起来不起作用？

请咨询，也关于配置参数

```
<bean id="mydataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"     destroy-method="close">
  <property name="driverClass" value="com.mysql.jdbc.Driver"/>
  <property name="jdbcUrl"  value="jdbc:mysql://localhost:3306,myOtherServer:3306/zeus?autoCommit=true&amp;autoReconnect=true&amp;autoReconnectForPools=true&amp;failOverReadOnly=false"/>
  <property name="user" value="root" />
  <property name="password" value="root" /> 

  <!-- these are C3P0 properties -->
  <!-- property name="acquireIncrement" value="${acquireIncrement}" /_-->
  <property name="minPoolSize" value="6" />
  <property name="maxPoolSize" value="10" />
  <property name="maxIdleTime" value="100" />
</bean> 
```

# sql - SQL - 根据某些列标准从单个表中获取计数

> ID：12395834
> 
> 赞同：0
> 
> 时间：2012-09-12T20:36:04.647
> 
> 标签：sql, oracle

我需要获得一个“简单”的用户数量，这些用户拥有 >5 个标记为相同 UUID 的帐户。

为了对单个 UUID 执行此操作，我执行了简单的查询：

```
Select count(user) 
From Ply 
Where Uuid Like 'i~cfe3a1eba3c2469aa3695e34c840fb62cb3e8791%' 
```

（我添加了 % 标记，因为我们将额外的标签附加到同一个 UUID 下的多个帐户）

上述查询中的结果是 5 的结果。

为了更上一层楼，我想计算整个 Ply 表中拥有超过 5 个帐户且具有 1 个 UUID 的用户数量。

我们欢迎所有的建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:37:32.297

听起来你想要

```
SELECT substr(uuid,1,42), count(user)
  FROM ply
 GROUP BY substr(uuid,1,42)
HAVING COUNT(*) > 5 
```

如果这不是您想要的，那么如果您可以发布表定义 (DDL)、一些示例数据 (DML) 和您想要的输出，将会非常有帮助。

# sql - 根据 3 个 int 列选择描述

> ID：12395835
> 
> 赞同：0
> 
> 时间：2012-09-12T20:36:09.403
> 
> 标签：sql, sql-server, sql-server-2008

我有一个包含字段 ID、department_code、sub_department_code、class_code、desc_text 的表

desc_text在sub_department_code和class_code字段为空时为部门名称，在department_code和sub_department_code不为空但class_code为空时为sub_department名称，在class_code不为空时为类名。

我的问题是我有另一个表具有上表中的 id，但我想选择具有部门代码、desc_text（部门）、sub_department_code、desc_text（子部门）等的字段。

我尝试了一些方法，但我什至不确定如何搜索这个问题。

我有以下两个表： Hierarchy
id,department_code,subdept_code,class_code
1 1 null null
2 1 1 null
3 1 1 1
4 2 1 null
Hierarchy_detail
id,hierarchy_id,short_text
1 1 car
2 2 truck

hierarchy.id 链接到 hierarchy_detail.hierarchy_id

有了这个，我有一个包含我想要的数据的表，它是来自 hierarchy.id 的 fk，我 cna 链接并获取部门、子 sept 和类代码，但是我无法获取每种类型的文本.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:41:33.877

您想使用 case 语句来捕获逻辑。如果我阅读正确，它看起来像这样：

```
select id, department_code, sub_department_code, class_code,
       (case when sub_department_code is null and class_code is null
             then desc_text
        end) as department_name,
       (case when department_code is not null and sub_department_code is not null and class_code is null
             then desc_text
        end) as sub_department_name,
       (case when class_code is not null then desc_text
        end) as class_name
from t 
```

然后，您可以将此查询用作子查询来连接到其他表。

# ruby-on-rails - JSON 数组到哈希

> ID：12395838
> 
> 赞同：0
> 
> 时间：2012-09-12T20:36:18.687
> 
> 标签：ruby-on-rails, ruby

我需要解析并显示以 JSON 或 Ruby 形式返回的 solr 方面：

> 集合： [ "a", 1, "b", 2, "c", 3, "d", 4, ... ]

进入

```
{"a"=>1, "b"=>2, "c"=>3, "d"=>4} 
```

最干净的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:41:31.713

**编辑：**现在我们知道你真正想要什么，一个`hash`......

```
collections = ["a", 1, "b", 2, "c", 3, "d", 4]
Hash[*collections]
# => {"a"=>1, "b"=>2, "c"=>3, "d"=>4} 
```

**原始答案**：我可能不明白你的目标，但......

```
collections = ["a", 1, "b", 2, "c", 3, "d", 4]
collections.each_slice(2).map{ |(x, y)| "#{x} - #{y}" }
# => ["a - 1", "b - 2", "c - 3", "d - 4"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:52:52.287

我看到你想做的可能是哈希？{a => "1", b => "2"} ??

如果是这样，请阅读以下内容：

```
collections = [ "a", 1, "b", 2, "c", 3, "d", 4]

result = Hash[*collections.flatten]

result prints {"a"=>1, "b"=>2, "c"=>3, "d"=>4} 
```

# java - 浏览器中的证书验证（具体案例：https://gmail.com）

> ID：12395839
> 
> 赞同：3
> 
> 时间：2012-09-12T20:36:27.890
> 
> 标签：java, browser, ssl, ssl-certificate

我正在编写一个函数来验证证书中的主机名/CN 是否与 url 中的主机名匹配。

**我的设置：** 我正在使用Java 提供的默认*SSLSockets 。*我在 SSLSocket中添加了一个*HandshakeCompletedListener 。*（这只是我设计一个解决方案的原型。我认为这不是握手完成后验证证书的最佳方式）

**我的难题：** 当我连接到[https://gmail.com](https://gmail.com)即*主机：gmail.com 端口：443 over ssl*时，我获得了 CN=mail.google.com 的证书。我的主机名验证功能拒绝此证书并关闭连接。

奇怪的是，广泛使用的浏览器并没有这样做。他们不显示通常的消息“证书不受信任。您要继续吗？” 不知何故，他们都信任提供给他们的证书，即使它与 url 中的主机名不匹配。

那么浏览器在做什么，以至于它不会直接拒绝证书？需要采取哪些额外步骤来确保证书在此过程中有效？我的意思是，在一系列重定向[https://gmail.com](https://gmail.com)被 https://mail.google.com 替换后，[证书](https://mail.google.com)验证没有任何问题，因为它现在匹配 CN=mail.google.com。这种机制背后有什么具体规则吗？

我想听听您可能有的任何想法。:)

**编辑：**我包含了一个测试程序，可以打印出主机/对等方发送的证书。并打印出 http 消息。该程序向 gmail.com 发送一个获取请求。我仍然在证书中看到 CN=mail.google.com。有人愿意测试一下吗？我觉得这种行为很奇怪`curl -v -k https://gmail.com`，因为正如[ian](https://stackoverflow.com/a/12397272/1024460)在他的评论中所建议的，它返回了一个完全不同的结果。

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.io.PrintWriter;
import java.net.Socket;
import java.net.UnknownHostException;
import java.security.cert.Certificate;
import javax.net.ssl.SSLSocket;
import javax.net.ssl.SSLSocketFactory;

public class SSLCheck {

public static String[] supportedCiphers = {"SSL_RSA_WITH_RC4_128_MD5",
                                        "SSL_RSA_WITH_RC4_128_SHA",
                                        "TLS_RSA_WITH_AES_128_CBC_SHA",
                                        "TLS_DHE_RSA_WITH_AES_128_CBC_SHA",
                                        "TLS_DHE_DSS_WITH_AES_128_CBC_SHA",
                                        "SSL_RSA_WITH_3DES_EDE_CBC_SHA",
                                        "SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA",
                                        "SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA",
                                        "SSL_RSA_WITH_DES_CBC_SHA",
                                        "SSL_DHE_RSA_WITH_DES_CBC_SHA",
                                        "SSL_DHE_DSS_WITH_DES_CBC_SHA",
                                        "SSL_RSA_EXPORT_WITH_RC4_40_MD5",
                                        "SSL_RSA_EXPORT_WITH_DES40_CBC_SHA",
                                        "SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA",
                                        "SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA",
                                        "TLS_EMPTY_RENEGOTIATION_INFO_SCSV"};

public static void main(String[] args) {
    int port = 443;
    String host = "gmail.com";

    try {
        Socket sock = SSLSocketFactory.getDefault().createSocket(host, port);
        sock.setSoTimeout(2000);
        ((SSLSocket)sock).setEnabledCipherSuites(supportedCiphers);

        PrintWriter out = new PrintWriter(new OutputStreamWriter(sock.getOutputStream()));

        out.println("GET " + "/mail" + " HTTP/1.1");
        out.println("Host: "+host);
        out.println("Accept: */*");
        out.println();
        out.flush();

        BufferedReader in = new BufferedReader(new InputStreamReader(sock.getInputStream()));

        SSLSocket ssls = (SSLSocket)sock;
        Certificate[] peercerts = ssls.getSession().getPeerCertificates();

        System.out.println("***********************PEER CERTS**********************");
        for(int i=0;i<peercerts.length;i++){
            System.out.println(peercerts[i]);       
            System.out.println("*********************************************************");
        }

        String line;
        while ((line = in.readLine())!=null) {
            System.out.println(line);
        }

        out.close();
        in.close();

    } catch (UnknownHostException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } finally { 
        System.exit(0);
    }
}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-13T17:41:38.170

您在不使用 Server Name Indication 扩展的情况下获得的证书确实是 for `CN=mail.google.com`，没有任何 Subject Alternative Name for `gmail.com`。

如果您尝试使用 SNI，您将获得不同的证书，用于`gmail.com`：

```
openssl s_client -connect gmail.com:443 -servername gmail.com | openssl x509 -text -noout 
```

桌面上大多数现代版本的浏览器都支持 SNI。在桌面上，剩下的主要不支持 SNI 的是任何版本的 XP 上的 IE。由于它是一个尚未向后移植到 SSLv3 的 TLS 扩展，这也解释了为什么它不能与`curl -3`.

Java 中的 SNI 支持仅在[Java 7 之后才可用（并且仅在客户端）](http://docs.oracle.com/javase/7/docs/technotes/guides/security/enhancements-7.html)。

（顺便说一句，除非您知道自己在做什么，否则请保留默认启用的密码套件，特别是不要启用弱密码套件，例如`EXPORT`或伪套件`TLS_EMPTY_RENEGOTIATION_INFO_SCSV`。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-12T23:08:16.133

一个快速测试`curl -v`告诉我，初始连接`https://gmail.com`提供了一个带有`CN=gmail.com`. SSL 信封内的 HTTP 响应是一个 301 重定向`https://mail.google.com/mail/`，它反过来提供一个`CN=mail.google.com`证书。所以在这种情况下，CN实际上在每个阶段都匹配*。*

但一般来说，您需要了解“主题备用名称”扩展，这是一种证书指定多个不同主机名的方式，这些主机名在主 CN 之外有效。

# php - 如何一次发布所有朋友的墙提要

> ID：12395844
> 
> 赞同：0
> 
> 时间：2012-09-12T20:36:57.303
> 
> 标签：php, facebook, facebook-wall

我试图在我所有朋友的墙上发帖。我什么时候做

```
 $user_friends = $facebook->api('/me/friends');
    sort($user_friends['data']);
    foreach($user_friends['data'] as $f){
$sendTo = $f['id'];
$sendToName = $f['name'];
echo $sendToName." - ".$sendTo."<br />";
    } 
```

它显示了我所有的朋友。(505) 但是当我尝试在他们的墙上发帖时，我补充说

```
$result = $facebook->api("/".$sendTo ."/feed", 'post', $vars); 
```

它只发送给 20 个朋友，我有正确的权限。什么问题？

# c# - 将前 2 列编码为主键/索引

> ID：12395845
> 
> 赞同：0
> 
> 时间：2012-09-12T20:36:57.530
> 
> 标签：c#, database, entity-framework, ef-code-first

所以我有一个名为 ObjectA 的类，它有很多 ObjectsB，对象有一个 Id 来识别它们，但也有一种语言（枚举，但它实际上保存为和 INT，对于这种情况都无关紧要）。

```
public class ObjectA
{
       public int Id {get;set;}
       public Language Language {get;set;}
       ... // and a list of objectA properties

       public virtual ICollection<ObjectB> ObjectBs {get;set;}
}

public class ObjectB
{
       public int Id {get;set;}
       public Language Language {get;set;}
       ... // and a list of objectB properties

       public ObjectA TheObjectA {get;set;}
} 
```

现在我学会了如何将它们都映射为主键，为此我使用了 fluent API。我知道您也可以使用 [Key] 和 [Column] 属性（我不使用）：

```
modelBuilder.Entity<ObjectA>().HasKey(a => new {a.Id, a.Languague})
modelBuilder.Entity<ObjectB>().HasKey(a => new {a.Id, a.Languague}) 
```

现在我尝试了很多东西，但我似乎无法将它们相互连接起来。任何人都知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T21:02:04.473

如果`ObjectA`一对多关系中的主体 ( ) 具有复合主键，则从属 ( `ObjectB`) 也必须具有由相同数量的列组成的外键。

我假设相关对象 A 和对象 B 必须具有相同的语言。在这种情况下，您可以制作`ObjectB.Language`外键的第一部分。（它同时是主键和外键的一部分`ObjectB`。）如果将 FK 的第二部分作为模型中的属性公开，它将如下所示：

（我相信你必须交换`Id`和`Language`以下工作。）

```
public class ObjectA
{
    public Languague Languague {get;set;}
    public int Id {get;set;}
    ... // and a list of objectA properties

    public virtual ICollection<ObjectB> ObjectBs {get;set;}
}

public class ObjectB
{
    public Languague Languague {get;set;}
    public int Id {get;set;}
    ... // and a list of objectB properties

    public int TheObjectAId {get;set;}
    public ObjectA TheObjectA {get;set;}
} 
```

以及使用 Fluent API 的映射：

```
modelBuilder.Entity<ObjectA>().HasKey(a => new { a.Languague, a.Id })
modelBuilder.Entity<ObjectB>().HasKey(b => new { b.Languague, b.Id })

modelBuilder.Entity<ObjectA>()
    .HasMany(a => a.ObjectBs)
    .WithRequired(b => b.ObjectA)
    .HasForeignKey(b => new { b.Language, b.TheObjectAId }); 
```

如果语言可以不同，请为该语言引入一个单独的 FK 属性：

```
 public Language TheObjectALanguage {get;set;}
    public int TheObjectAId {get;set;}
    public ObjectA TheObjectA {get;set;} 
```

...和地图：

```
modelBuilder.Entity<ObjectA>()
    .HasMany(a => a.ObjectBs)
    .WithRequired(b => b.ObjectA)
    .HasForeignKey(b => new { b.TheObjectALanguage, b.TheObjectAId }); 
```

如果关系是可选的，请使用`WithOptional`而不是`WithRequired`并使 FK 属性可为空：

```
public Language? TheObjectALanguage {get;set;}
public int? TheObjectAId {get;set;} 
```

如果您不想在模型中使用 FK 属性，您可以将`MapKey`其与 Fluent API 一起使用：

```
modelBuilder.Entity<ObjectA>()
    .HasMany(a => a.ObjectBs)
    .WithRequired(b => b.ObjectA)
    .Map(m => m.MapKey("TheObjectALanguage, TheObjectAId")); // FK columns 
```

# perl - 在 Perl 中识别矩阵中的子数组

> ID：12395847
> 
> 赞同：4
> 
> 时间：2012-09-12T20:37:00.883
> 
> 标签：perl, matrix

我对 Perl 比较陌生，需要进行相对复杂的矩阵计算，不知道要使用什么数据结构。

不确定这是否是合适的论坛，但假设您在 Perl**的多维数组中有以下矩阵：**

```
0.2    0.7    0.2 
0.6    0.8    0.7
0.6    0.1    0.8
0.1    0.2    0.9
0.6    0.3    0.0
0.6    0.9    0.2 
```

我正在尝试识别此矩阵中对应于高于给定阈值的连续值的**列段，例如****0.5**

例如，如果我们对这个矩阵设置阈值，我们有：

```
0    1    0 
1    1    1
1    0    1
0    0    1
1    0    0
1    1    0 
```

如果我们现在关注第一列：

```
0 
1 
1
0 
1 
1 
```

我们可以看到有两个连续的段：

> 0 **1 1** 0 **1 1**

*   第一个**轨道**（一个序列）以索引**1**开始，以索引**2结束**
*   第二个**轨道**（一个序列）以索引**4**开始，以索引**5结束**

我想检测原始矩阵中的所有这些轨道，但我不知道如何进行或哪些 Perl 数据结构最适合此。

理想情况下，我想要一些易于索引的东西，例如假设我们使用变量`tracks`，我可以存储第一列（索引 0）的索引，如下所示：

```
# First column, first track
$tracks{0}{0}{'start'} = 1; 
$tracks{0}{0}{'end'}   = 2;

# First column, second track
$tracks{0}{1}{'start'} = 4; 
$tracks{0}{1}{'end'}   = 5;

# ... 
```

在 Perl 中我可以使用哪些好的数据结构和/或库来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T21:13:41.437

我只是给出算法答案，你可以用你喜欢的任何语言对其进行编码。

将问题拆分为子问题：

1.  阈值：取决于您存储输入的方式，这可以像在 $n$ 维矩阵上的迭代一样简单，或者如果您的矩阵是稀疏的，则可以进行树/列表遍历。这是容易的一点。

2.  寻找连续片段的算法称为“游程编码”。它需要一个可能重复的序列，如 1 0 0 1 1 1 1 0 1 并返回另一个序列，该序列告诉您下一个元素是哪个元素，以及其中有多少。因此，例如，上面的序列将是 1 1 0 2 1 4 0 1 1 1。编码是唯一的，所以如果你想反转它，你就可以了。

第一个 1 存在是因为原始输入以 1 开头，第一个 0 存在是因为 1 之后有一个 0，第四个数字是 2 因为有两个连续的零。如果你不想自己做的话，有无数的 rle-encoders。它的主要目的是压缩，如果您长时间运行相同的项目，它可以很好地用于此目的。根据您的需要，您可能需要水平、垂直甚至对角线运行它。

您可以在所有有关数据结构和算法的经典书籍中找到精确的算法。我建议 Cormen-Leiseron-Rivest-Stein：首先是“算法简介”，然后是 Knuth。

掌握要点后，您可以安全地将阈值与 RLE“融合”，以避免对输入进行两次迭代。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T22:34:19.447

这似乎做你想做的事。我以您建议的形式表示了数据，因为理想的形式完全取决于您要对结果做什么

它的工作原理是从每一列计算 0 和 1 的列表，在每一端添加零的*障碍*值（列表`$prev`中的一个和一个`for`），然后扫描列表以查找 1 和 0 之间的变化

每次发现变化时，都会记录轨道开始或结束。如果`$start`未定义，则当前索引被记录为段的开始，否则当前段以比当前索引小一结束。`start`使用和键构建散列`end`，并将其推送到`@segments`数组中。

最后一组嵌套循环以您在问题中显示的形式转储计算数据

```
use strict;
use warnings;

use constant THRESHOLD => 0.5;

my @data = (
  [ qw/ 0.2    0.7    0.2 / ],
  [ qw/ 0.6    0.8    0.7 / ],
  [ qw/ 0.6    0.1    0.8 / ],
  [ qw/ 0.1    0.2    0.9 / ],
  [ qw/ 0.6    0.3    0.0 / ],
  [ qw/ 0.6    0.9    0.2 / ],
);

my @tracks;

for my $colno (0 .. $#{$data[0]}) {

  my @segments;
  my $start;
  my $prev = 0;
  my $i = 0;

  for my $val ( (map { $_->[$colno] > THRESHOLD ? 1 : 0 } @data), 0 ) {
    next if $val == $prev;
    if (defined $start) {
      push @segments, { start => $start, end=> $i-1 };
      undef $start;
    }
    else {
      $start = $i;
    }
  }
  continue {
    $prev = $val;
    $i++;
  }

  push @tracks, \@segments;
}

# Dump the derived @tracks data
#
for my $colno (0 .. $#tracks) {
  my $col = $tracks[$colno];
  for my $track (0 .. $#$col) {
    my $data = $col->[$track];
    printf "\$tracks[%d][%d]{start} = %d\n", $colno, $track, $data->{start};
    printf "\$tracks[%d][%d]{end} = %d\n", $colno, $track, $data->{end};
  }
  print "\n";
} 
```

**输出**

```
$tracks[0][0]{start} = 1
$tracks[0][0]{end} = 2
$tracks[0][1]{start} = 4
$tracks[0][1]{end} = 5

$tracks[1][0]{start} = 0
$tracks[1][0]{end} = 1
$tracks[1][1]{start} = 5
$tracks[1][1]{end} = 5

$tracks[2][0]{start} = 1
$tracks[2][0]{end} = 3 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T23:09:58.763

为 Perl 对多维数组的糟糕支持感到遗憾，我很快发现自己在拼凑出自己的一个小解决方案。该算法与 Borodins 的想法非常相似，但结构略有不同：

```
sub tracks {
  my ($data) = @_; # this sub takes a callback as argument
  my @tracks;      # holds all found ranges
  my @state;       # is true if we are inside a range/track. Also holds the starting index of the current range.
  my $rowNo = 0;   # current row number
  while (my @row = $data->()) { # fetch new data
    for my $i (0..$#row) {
      if (not $state[$i] and $row[$i]) {
        # a new track is found
        $state[$i] = $rowNo+1; # we have to pass $rowNo+1 to ensure a true value
      } elsif ($state[$i] and not $row[$i]) {
        push @{$tracks[$i]}, [$state[$i]-1, $rowNo-1]; # push a found track into the @tracks array. We have to adjust the values to revert the previous adjustment.
        $state[$i] = 0; # reset state to false
      }
    }
  } continue {$rowNo++}
  # flush remaining tracks
  for my $i (0..$#state) {
    push @{$tracks[$i]}, [$state[$i]-1, $rowNo-1] if $state[$i]
  }
  return @tracks;
} 
```

`@state`兼作指示我们是否在轨道内的标志和轨道起始索引的记录。在 state 和 tracking 数组中，索引表示当前列。

作为数据源，我使用了一个外部文件，但这可以很容易地插入任何东西，例如预先存在的数组。唯一的约定是，当没有更多数据可用时，它必须返回任意序列的真假值和空列表。

```
my $limit = 0.5
my $data_source = sub {
  defined (my $line = <>) or return (); # return empty list when data is empty
  chomp $line;
  return map {$_ >= $limit ? $_ : 0} split /\s+/, $line; # split the line and map the data to true and false values
}; 
```

将您复制粘贴的数据作为输入，我得到以下打印输出作为输出（省略打印代码）：

```
[ [1 2], [4 5] ]
[ [0 1], [5 5] ]
[ [1 3] ] 
```

使用您的结构，这将是

```
$tracks[0][0][0] = 1;
$tracks[0][0][1] = 2;

$tracks[0][1][0] = 4;
...; 
```

如果将其修改为哈希，则可以合并更多数据，例如原始值。

# php - 有没有更好的方法在 PHP 中剥离/形成这个字符串？

> ID：12395850
> 
> 赞同：0
> 
> 时间：2012-09-12T20:37:07.337
> 
> 标签：php, regex

我目前正在使用看起来非常复杂且不必要的解决方案来形成所需的字符串。

该字符串可以有任何标点符号，并包括斜线。

例如，这个字符串：

```
Test Ripple, it\'s a comic book one! 
```

使用我目前的方法：

```
str_replace(" ", "-", trim(preg_replace('/[^a-z0-9]+/i', ' ', str_replace("'", "", stripslashes($string))))) 
```

返回正确的结果：

```
Test-Ripple-its-a-comic-book-one 
```

以下是我当前（较差的）解决方案为实现所需输出所做的细分：-

1.  从字符串中去除所有斜线
2.  使用 str_replace 删除任何撇号
3.  使用 preg_replace 删除任何剩余的标点符号并将其替换为空格
4.  从字符串的开头/结尾剪掉任何可能由标点符号引起的多余空格。
5.  用'-'替换所有空格

但必须有更好、更有效的方法。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:45:59.597

就我个人而言，它看起来不错，但我会做一点小改动。

改变

```
preg_replace("/[^a-z0-9]+/i" 
```

到以下

```
preg_replace("/[^a-zA-Z0-9\s]/" 
```

# asp.net-mvc - MVC 3 传递大数据 (5MB)

> ID：12395855
> 
> 赞同：0
> 
> 时间：2012-09-12T20:37:24.770
> 
> 标签：asp.net-mvc, linq, session, large-data

我们有一个 MVC 项目，它将处理显示跟踪记录机制，该机制从多个应用程序收集数据，这些应用程序都与一个主应用程序套件相关。Trace 日志记录工具是一种服务，它收集异常和其他各种日志记录信息并将它们放在数据库中以供以后使用。这个 MVC 项目是消费的一部分。

我敢肯定你会说，有很多数据是通过 Entity / LINQ 返回的。现在，开发人员正在取回所有数据并使用会话变量来保存这些数据（我认为他说这就像被返回的 3-5 MB 数据一样好。）。仅将 512 条跟踪发送回视图/浏览器。然后，用户可以按他们通过 AJAX 调用键入的任何内容进行过滤。开发人员正在使用旧的 Session["name"] 对象将数据放入其中，并使用 LINQ 在服务器上对其进行过滤，这样他就不会在每次选择/键入过滤器时都点击跟踪服务。

它在本地工作，但不是远程工作。我认为 IIS 存在问题，但尚未调查。

我想知道 Sessions 是否是此类大数据的最佳方法，或者是否有更好的建议而不是 Sessions 会更好。我知道 MVC 是无状态的，我尽量保持它除了 TempData 之外的任何东西可以，但不确定如何解决这个问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T02:51:17.310

使用 HttpRunTime.Cache 存储数据可能会更好，因为它在过期方面具有灵活性，特别是如果跟踪对应用程序是全局的，例如

```
private List<string> GetApplicationSuiteTraces() 
{
    List<string> applicationSuiteTraces = Cache["ApplicationSuiteTraces"];

    if(applicationSuiteTraces == null) 
    {    
       applicationSuiteTraces = Service.GetTraces();
       Cache.Add("ApplicationSuiteTraces", applicationSuiteTraces, null, DateTime.Now.AddSeconds(600), Cache.NoSlidingExpiration, CacheItemPriority.High, null);
    }

    return applicationSuiteTraces;
} 
```

# apache - 优化 sed/tr shell 脚本

> ID：12395856
> 
> 赞同：0
> 
> 时间：2012-09-12T20:37:26.437
> 
> 标签：apache, shell, sed, tr

`sed`我编写了一个脚本来自动将 ServerAlias 添加到 Apache 配置文件中，然后重新启动 Apache，对`tr`一般的 shell 脚本有相当的理解。这就是我想出的：

```
cp /etc/httpd/sites/site.conf tmphost &&
sed s/ServerName\ site.com/ServerName\ site.com^#ServerAlias\ sub.site.com/ \
        tmphost |
    tr '^#' '\n\t' >/etc/httpd/sites/site.conf &&
rm -f tmphost &&
apachectl restart 
```

基本上我正在创建一个副本，用自身+新别名替换 ServerName 行，`tr`用于放入换行符和选项卡（`sed`这很奇怪？），覆盖旧配置文件，删除副本，然后重新启动 Apache。

如果你明白我的意思的话，它有效，但并不能真正让妈妈感到自豪。关于如何清理它的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:42:25.050

如果你想在 ServerName 行之后添加一个 ServerAlias 行，为什么不使用 'append' 命令添加一行：

```
sed '/ServerName site.com/a\
    ServerAlias sub.site.com' tmphost >/etc/httpd/sites/site.conf 
```

额外行的开头有一个“标签”，您似乎需要它。

如果您有 GNU sed，您可以使用该选项而不使用临时文件进行就地编辑`-i`（但如果您正在编辑的文件有多个硬链接，则不要使用该`-i`选项，如果它是一个符号链接，则可能不是，或者；请参阅下面来自[William Pursell](https://stackoverflow.com/users/140750/william-pursell)的评论）。

请注意，您应该将代码包装在：

```
trap "rm -f tmphost; exit 1" 0 1 2 3 13 15
...script manipulating tmphost...
rm -f tmphost
trap 0 
```

因此，如果外壳因信号而退出，则不会留下临时文件。当然，如果您有就地更改，则根本不需要临时文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T13:20:55.170

我喜欢使用 sed 直接添加 ServerAilas 的方式：

```
sed -i "0,/^ServerName.\+/s//\0\nServerAlias sub.site.com/" /etc/httpd/sites/site.conf
apachectl reload 
```

# java - 对包含空标记的字符串进行标记

> ID：12395862
> 
> 赞同：10
> 
> 时间：2012-09-12T20:37:30.727
> 
> 标签：java, string, java.util.scanner, stringtokenizer, string-split

我有一个看似简单的问题，将逗号分隔`String`成标记，在以下情况下输出应包含空标记：

*   中的第一个字符`String`是逗号。
*   中的最后一个字符`String`是逗号。
*   出现两个连续的逗号。

例如，对于`String`:`",abd,def,,ghi,"`应该产生输出：`{"", "abd", "def", "", "ghi", ""}`。

我尝试过使用`String.split`,`Scanner`并且`StringTokenizer`为此，但每个都给出了不同的不想要的输出（下面的示例）。谁能为此提出一个**优雅**的解决方案，最好使用JDK类？显然我可以自己编写一些代码，但我觉得我在提到的三种方法之一上遗漏了一些东西。请注意，分隔符是固定`String`的，但不一定是逗号，也不是单个字符。

**示例代码**

```
import java.util.*;

public class Main12 {
  public static void main(String[] args) {
    String s = ",abd,def,,ghi,";
    String[] tokens = s.split(",");

    System.err.println("--- String.split Output ---");
    System.err.println(String.format("%s -> %s", s, Arrays.asList(tokens)));

    for (int i=0; i<tokens.length; ++i) {
      System.err.println(String.format("tokens[%d] = %s", i, tokens[i]));
    }

    System.err.println("--- Scanner Output ---");

    Scanner sc = new Scanner(s);
    sc.useDelimiter(",");
    while (sc.hasNext()) {
      System.err.println(sc.next());
    }

    System.err.println("--- StringTokenizer Output ---");

    StringTokenizer tok = new StringTokenizer(s, ",");
    while (tok.hasMoreTokens()) {
      System.err.println(tok.nextToken());
    }
  }
} 
```

**输出**

```
$ java Main12
--- String.split Output ---
,abd,def,,ghi, -> [, abd, def, , ghi]
tokens[0] =
tokens[1] = abd
tokens[2] = def
tokens[3] =
tokens[4] = ghi
--- Scanner Output ---
abd
def

ghi
--- StringTokenizer Output ---
abd
def
ghi 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-12T20:40:15.867

`-1`将a`split`作为`limit`参数传递：

```
String s = ",abd,def,,ghi,";
String[] tokens = s.split(",", -1); 
```

然后您的结果数组将包含任何尾随的空字符串。

从[javadocs](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#split%28java.lang.String,%20int%29)：

> 如果 [the limit] 为非正数，则该模式将被应用尽可能多的次数，并且数组可以具有任意长度。如果 [the limit] 为零，则该模式将被应用尽可能多的次数，数组可以具有任意长度，并且尾随的空字符串将被丢弃。

调用`split(regex)`就像`limit`参数是一样`0`，所以尾随的空字符串被丢弃。

# iphone - Iphone：如何在应用程序内显示库中的歌曲列表

> ID：12395866
> 
> 赞同：0
> 
> 时间：2012-09-12T20:37:39.403
> 
> 标签：iphone, objective-c, ios, xcode, ios4

我想在我的应用程序内的列表中显示用户 ipod 中所有歌曲的列表。当用户单击一首歌曲时，我想存储这首歌曲的名称。

我稍后也想获取那首歌的名称并播放它（但不是马上）。

任何想法从哪里开始？我知道它可能在 Media.Player 框架中的某个地方，但我似乎无法弄清楚如何从应用程序内部实际查看歌曲列表

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:51:46.557

您可以使用以下命令调用 MPMediaPickerController：

```
- (IBAction) selectSong: (id) sender 
{   
    MPMediaPickerController *picker =
    [[MPMediaPickerController alloc] initWithMediaTypes: MPMediaTypeMusic];

    picker.delegate                     = self;
    picker.allowsPickingMultipleItems   = NO;
    picker.prompt                       = NSLocalizedString (@"Select any song from the list", @"Prompt to user to choose some songs to play");

    [self presentModalViewController: picker animated: YES];
} 
```

然后，您可以使用类似的方法将选择的歌曲添加到您自己的数组中。

**注意：**您将使用 访问每个轨道的元数据信息`valueForProperty`。

```
- (void) mediaPicker: (MPMediaPickerController *) mediaPicker didPickMediaItems: (MPMediaItemCollection *) mediaItemCollection 
{
    [self dismissModalViewControllerAnimated: YES];
    someMutableArray = [mediaItemCollection mutableCopy];
} 
```

那么这是一种不言自明但必要的：

```
- (void) mediaPickerDidCancel: (MPMediaPickerController *) mediaPicker 
{   
    [self dismissModalViewControllerAnimated: YES]; 
} 
```

欲了解更多信息，请访问[Apple 的 iPod Library Access 编程指南](http://developer.apple.com/library/ios/#DOCUMENTATION/Audio/Conceptual/iPodLibraryAccess_Guide/UsingtheMediaItemPicker/UsingtheMediaItemPicker.html)

# apache-flex - 以编程方式更改属性时不显示 Datagrid 滚动条

> ID：12395870
> 
> 赞同：2
> 
> 时间：2012-09-12T20:38:11.320
> 
> 标签：apache-flex, datagrid, mxml

我正在开发一个允许用户单击切换按钮的 Flex 应用程序。Datagrid 将显示信息。在运行时以编程方式将ToggleButtonBar 中*启用*的属性设置为`true`或`false`时，当数据长度超过屏幕高度时，Datagrid 滚动条不会显示。但是，如果我硬编码`enabled = "true"`，它工作正常。有谁知道如何使滚动条工作？

这是代码片段：

```
<mx:ToggleButtonBar id="choices" dataProvider="{viewstack}" 
enabled="{module != Utils.MODULE_NOT_SELECTED}" horizontalGap="5" verticalGap="5"/>

<mx:ViewStack id="viewstack" width="100%" height="100%" creationPolicy="all"
    selectedIndex="0">

<mx:Canvas width="100%" height="100%" label="VM Info">
<mx:DataGrid id="vminfoTbl" width="100%" height="100%" 
 dataProvider="{vnics}" variableRowHeight="true">
<mx:columns>
<mx:DataGridColumn dataField="vm" headerText="Name" 
 itemRenderer="{new ClassFactory(LineTooLongItemRenderer)}" />
 <mx:DataGridColumn ataField="vnic"     headerText="host" />   
  itemRenderer="{new ClassFactory(LineTooLongItemRenderer)}" />

 </mx:columns>
 </mx:DataGrid>
 </mx:Canvas>
 </mx:ViewStack> 
```

# java - LeftMouseIsDown 时返回布尔值的方法

> ID：12395871
> 
> 赞同：-1
> 
> 时间：2012-09-12T20:38:15.477
> 
> 标签：java, mouse

如果用户按住鼠标左键，我如何制作将返回布尔值的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:49:34.143

您需要实现 MouseListener 并处理`MOUSE_PRESSED`事件。[你可以在这里](http://docs.oracle.com/javase/tutorial/uiswing/events/mouselistener.html)和[这里](http://docs.oracle.com/javase/1.4.2/docs/api/java/awt/event/MouseEvent.html)详细阅读

# algorithm - 使用 Google Maps API 查找区域内的街道交叉口

> ID：12395874
> 
> 赞同：3
> 
> 时间：2012-09-12T20:38:23.287
> 
> 标签：algorithm, google-maps, google-maps-api-3, graph

给定一个正方形区域，找到给定区域内每个街道交叉口的近似坐标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-18T14:13:45.110

由于没有对您的应用程序的描述，我无法判断您是否需要使用 Google 地图，或者其他数据源是否可以满足您的需求。如果[http://openstreetmap.org](http://openstreetmap.org)满足您的应用程序的要求，那么很容易：

*   OSM API 请求从矩形区域提取数据。您获得 XML 数据。
*   过滤此数据以仅保留您感兴趣的街道，可能是“key=highway”标签
*   过滤它以仅保留属于两条或多条线的点。

如果需要谷歌地图，请忽略这一点。

但仍然：由于道路独立于数据库而存在，上述方法将产生道路交叉点（在纬度/经度坐标中）与您从谷歌地图中获得的高度相关；-) 然后您可以使用这些点来显示他们在谷歌地图上，知道两个数据集并不相同，所以它不会是完美的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-15T05:41:45.207

可能不是最简单的方法，但我使用了我们国家道路及其线串的单独数据库。我取了每个线串的第一个和最后一个点，然后计算每个起点/终点 50 m 内的道路数量。然后，我从导航路线中获取节点，并使用这些节点来比较与每个节点相交的道路数量。然后，我查看了每个起点的方向以及沿该道路的下一个点，这为您提供了方向。通过一些数学运算，您可以计算出下一个十字路口的道路数量和角度。然后我做了一个道路规则应用程序，告诉你哪些车辆让路

# php - PHP 和 XSLT：扩展处理器

> ID：12395881
> 
> 赞同：3
> 
> 时间：2012-09-12T20:39:33.650
> 
> 标签：php, xslt

我需要用我自己的标签和函数在 PHP 中扩展 XSLT 处理器。我找到了一些 API，但这些 API 仍然不是我需要的。

1) [http://php.net/manual/ru/book.xsl.php](http://php.net/manual/ru/book.xsl.php) - 非常简单的 API，但我只能扩展函数（registerPHPFunctions），不能扩展标签。

2) [http://www.php.net/manual/en/ref.xslt.php](http://www.php.net/manual/en/ref.xslt.php) - 又好又简单，我可以扩展我需要的任何东西（xslt_set_sax_handlers），但是，我们开始了 - 另一个问题。简介 (http://www.php.net/manual/en/intro.xslt.php) 说：“此扩展已移至 » PECL 存储库，自 PHP 5.0.0 起不再与 PHP 捆绑。” . 好的，我正在导航到 pecl.php.net -> Search Packages -> XSLT -> No results found -> o_O

所以，看起来好的 API 已被弃用，而糟糕的 API 并不能满足我的需求。大家有什么可以推荐的吗？我需要一个 PHP XSLT 处理器，我可以在其中扩展或覆盖所有可以扩展或覆盖的东西，就像上面的“2)”一样。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-17T15:30:21.943

PHP`libxslt`用作其默认处理器和`libexslt`扩展处理器。以下是 API 文档：

*   [EXSLT API 符号](http://xmlsoft.org/XSLT/EXSLT/APIsymbols.html)
*   [LibXSLT 宏](http://xmlsoft.org/XSLT/html/libxslt-xsltexports.html)
*   [LibXSLT 源代码](http://www.xmlsoft.org/sources/)
*   [LibXSLT Git 存储库](https://git.gnome.org/browse/libxslt/tree/)

此外，`libxslt`已经支持[eval 扩展](https://git.gnome.org/browse/libxslt/tree/tests/extensions/evaluate.xsl)，它可以满足您的目的。

还有一些内置的宏可以`xsl:processing-instruction`匹配 PHP 的简写分隔符：

*   [有什么方法可以内联调用 XSLT 模板](https://stackoverflow.com/questions/1792707/is-there-any-way-to-call-xslt-templates-inline/8763014#8763014)

*   [寻找一个（伪）XSLT 预处理器/模板以使其不那么冗长](https://stackoverflow.com/questions/6816770/looking-for-a-pseudo-xslt-preprocessor-templater-to-make-it-less-verbose/13383122#13383122)

*   [使用 XSLT 的多层条件包装 HTML](https://stackoverflow.com/questions/17365816/multi-layer-conditional-wrap-html-with-xslt/18865513#18865513)

和[registerPHPFunctions](https://github.com/evnix/go-php-parser/blob/master/testdata/fuzzdir/corpus/ext_xsl_tests_xsltprocessor_registerPHPFunctions-array-multiple.php)方法。

转换可以将 XPath 表达式作为参数传递给自定义命名空间中的函数：

```
<xsl:stylesheet version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:js="urn:livescript"
  extension-element-prefixes="js"
>

  <xsl:variable name="source" select="//"/>

  <xsl:template match="json">
    <xsl:value-of select="livescript:JSON($source)"/>
  </xsl:template>
</xsl:stylesheet> 
```

该函数链接到一个外部转换，该转换计算 XPath 结果并使用回调返回结果。

**参考**

*   [XSLTProcessor::hasExsltSupport](http://www.php.net/manual/en/xsltprocessor.hasexsltsupport.php)
*   [XSLTProcessor::registerPHPFunctions](http://www.php.net/manual/en/xsltprocessor.registerphpfunctions.php)
*   [用于 MSXML 的 EXSLT](http://www.xml.com/lpt/a/1261)
*   [MDN：EXSLT](https://developer.mozilla.org/en-US/docs/Web/EXSLT)
*   [comlibxml](http://comlibxml.mozdev.org)
*   [W3C：HTML/XML 实用程序](https://www.w3.org/Tools/HTML-XML-utils/)

# php - 将静态内容与 MVC 架构集成

> ID：12395891
> 
> 赞同：0
> 
> 时间：2012-09-12T20:40:24.680
> 
> 标签：php, model-view-controller

我即将为我的公司创建一个新网站。我希望使用 PHP，因为它是一家小型企业，整个网站最后只有大约 40-50 个页面。为了学习和最佳实践，我希望使用 PHP MVC 框架。我一直在尝试一些，看看当你很好地提供动态内容时它会如何工作。我不明白的是你如何用静态内容纠正 MVC 逻辑。

我的意思是，MVC 模式将如何处理非动态页面，例如公司信息页面。每个页面是否有一个控制器，它只返回一个包含所有 HTML 和 CSS 的视图？控制器是否从其他控制器中提取页眉和页脚信息，然后从不同的视图中提取主要内容？我想我不明白这一切是如何进行的。有人可以 ELI noob 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T21:02:59.370

首先，我向你推荐 Yii 框架，它快速稳定，并且对所有函数/方法都有很好的文档。其他框架选项（symfony、cakePhp 等）很慢，学习曲线也很慢。

Yii 使用 controller->actions 管理内容。当你连接到 yourpage.com/site/index 时，yii 会加载一个 SiteController ->actionIndex 并在视图文件中呈现 html 代码。

您将所有网站内容（页眉/页脚/菜单/等）放在页面文件中，视图文件仅加载正文视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T22:00:11.140

> 每个页面是否有一个控制器，它只返回一个包含所有 HTML 和 CSS 的视图？

在视图和控制器之间建立 1:1 的关系是一种常见的做法。在实现 MVC 时，视图通常代表网站中的一个页面（如 StackOverflow 中的用户配置文件），它会根据模型层状态而改变（想想：您查看您的配置文件或其他人的配置文件）。

一个特定的控制器将负责处理来自该页面的所有（或大部分）用户交互。

在正确实现的 MVC 或受 MVC 启发的设计模式中，控制器只会更改视图的状态（在构造函数中提供给它）。响应的生成（无论是 HTML 页面、HTTP 标头还是 JSON 文件）由视图本身处理。由于控制器不应该创建视图，因此返回它没有意义。

> 控制器是否从其他控制器中提取页眉和页脚信息，然后从不同的视图中提取主要内容？

[如果您使用的是HMVC 模式](http://www.javaworld.com/jw-07-2000/jw-0721-hmvc.html)（实际上与[经典 MVC](http://www.itu.dk/courses/VOP/E2005/VOP2005E/8_mvc_krasner_and_pope.pdf)没有直接关系），那将是这种行为。

在适当的 MVC 或受 MVC 启发的结构中，视图将从模型层获取数据，并根据该信息从多个模板组装 HTML 页面。如果你想学习如何用 PHP 制作简单的模板，请阅读[这篇文章](http://codeangel.org/articles/simple-php-template-engine.html)。

> 我想我不明白这一切是如何进行的。

在这种情况下，您应该首先阅读*Martin Fowler*的[“GUI 架构”](http://martinfowler.com/eaaDev/uiArchs.html)。[如果您对整个 OOP 还很陌生，请观看本文](https://stackoverflow.com/a/9855170/727208)底部列出的每一堂课。

 ** * *

## 主要话题

如果您有大量的静态页面，可以使用 MVC 设计模式来创建站点（您基本上会将它们视为缓存结构，可以查看哪些视图），但这可能有点无意义。

MVC 是一种复杂的设计模式，旨在通过应用[SoC](http://en.wikipedia.org/wiki/Separation_of_concerns)为大型应用程序带来秩序。

MVC 不是一种神奇的喷剂，当[应用于额头](http://www.youtube.com/watch?v=f_SwD7RveNE)时，它会变得更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-12T20:56:56.197

MVC 结构并不是静态内容的最佳选择，因为所有的 M、V 和 C 组件都在同一个文档中。因此，没有“正确的方法”来做到这一点。

但是，有一些解决方法。

其中之一是将静态内容转换为模型（M）并将其注入主模板（如果它是推送模板）。另一种是将内容制作成扩展主模板的子模板。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-12T20:57:26.007

控制器的工作是填充模型，然后将该模型发送到视图以向用户显示数据。如果数据是静态的而不是动态的，这种责任模式不会改变。控制器只需要较少的“工作”来处理静态内容。*

# php - 如何逐行读取txt文件

> ID：12395894
> 
> 赞同：-9
> 
> 时间：2012-09-12T20:40:39.027
> 
> 标签：php

> **可能重复：**
> [如何读取和解析此文本文件的内容？](https://stackoverflow.com/questions/12370553/how-can-i-read-and-parse-the-contents-of-this-text-file)

我想读取一个文本文件，因为 C++ 读取它

这是文本文件中的示例

```
(item(name 256) (Index 1)(Image "Wea001")   (specialty  (aspeed 700) (Hit 20)))
(item   (name 257)  (desc 520)           (Index 2)  (Image "Wea002")(specialty(Attack 16 24))) 
```

我想要像这样的输出

```
name : 256
Index : 1
Image : Wea001
Specialty > aspeed : 700 
Specialty > hit : 20 
```

* * *

```
Name : 257
Desc : 520
Index : 2
Image : Wea002
Speciality > Attack : 16 24 
```

* * *

那可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:43:43.333

直接出php手册：

[fgets()](http://php.net/manual/en/function.fgets.php)

> **Example #1 逐行读取文件**

```
<?php
$handle = @fopen("/tmp/inputfile.txt", "r");
if ($handle) {
    while (($buffer = fgets($handle, 4096)) !== false) {
        echo $buffer;
    }
    if (!feof($handle)) {
        echo "Error: unexpected fgets() fail\n";
    }
    fclose($handle);
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T20:47:19.637

[RTM](http://php.net/manual/en/function.fgets.php)

```
<?php
$f = fopen ("fgetstest.php", "r");
$ln= 0;
while ($line= fgets ($f)) {
    ++$ln;
    printf ("%2d: ", $ln);
    if ($line===FALSE) print ("FALSE\n");
    else print ($line);
}
fclose ($f); 
```

?>

# sql - SQL Server INSERT触发器如何获取当前行的数据

> ID：12395899
> 
> 赞同：2
> 
> 时间：2012-09-12T20:40:53.677
> 
> 标签：sql, sql-server-2008-r2, sql-server-2012

我以前从未创建过触发器，我正在尝试在线阅读，但有点困惑。

我想在插入的表上创建一个触发器，它将从不同的列中获取一些数据并将其插入到其他几个不同的表中。

我不确定如何编写 T-SQL 来从列中获取数据..

```
insert into [othetTable] 
values ([col1 from row that was inserted], [col5 from row that was inserted]) 
```

获取这些值的语法是什么？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-12T20:42:08.430

使用`inserted`可用于触发器的虚拟表。请注意，此表中可能有多行 - 您的触发器可能一次处理多个插入。

因此，您需要使用类似于以下语法的内容：

```
insert into othertable
select col1, col5
from inserted 
```

这将为`othertable`每个插入的行插入一行。

# ajax - 从 iframe 加载内联内容

> ID：12395905
> 
> 赞同：0
> 
> 时间：2012-09-12T20:41:19.403
> 
> 标签：ajax, iframe, colorbox

首先，我的所有按钮都使用“ajax”类打开了 Colorbox。但是那个类给我带来了很多问题： 1-当我打开一个窗口时，它会出现，当我关闭它并重新单击同一个按钮时，它将被加载两次（所以我需要单击两次才能关闭）解决这个问题？

我目前所做的：使用 iframe；我现在唯一的问题是我无法加载在该 iframe 中链接的其他颜色框。我正在使用内联类。

让我重新表述一下：我单击“生成”按钮，它会打开带有 iframe 类的第一个颜色框。在该 iframe 中，我有一个“generate_2”按钮，其中包含内联内容。一旦我点击第二个按钮，什么都不会发生。当我将第一个按钮设置为 ajax 时，这曾经有效。

我能做些什么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T20:28:21.607

> 当我关闭它并重新单击同一个按钮时，它将被加载两次（所以我需要单击两次才能关闭） 是否有解决此问题的方法？

我敢打赌你正在使用 ajax 打开一个完整的 HTML 文档，不是吗？你不应该那样做。将一个 HTML 文档嵌套在另一个 HTML 文档中是无效的 HTML，并且您正在将两者中的脚本应用于原始文档。每次加载该内容时，这些脚本都会重新加载和执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-12T21:29:53.213

我以前也有同样的问题。由于 JavaScript 不能影响 iframe，因此您必须在 iframe 页面本身的脚本标记内添加 JavaScript 代码。

# r - 没有刻面的ggplot

> ID：12395906
> 
> 赞同：2
> 
> 时间：2012-09-12T20:41:23.553
> 
> 标签：r, ggplot2, r-mice

以下代码来自@ROLO 对我之前的问题的回答，生成了 3 个图：

```
require(mice)
require(reshape2)
require(ggplot2)
dt <- nhanes
impute <- mice(dt, seed = 23109)

# Obtain the imputed data, together with the original data
imp <- complete(impute,"long", include=TRUE)
# Melt into long format
imp <- melt(imp, c(".imp",".id","age"))
# Add a variable for the plot legend
imp$Imputed<-ifelse(imp$".imp"==0,"Observed","Imputed")

# Plot. Be sure to use stat_density instead of geom_density in order
#  to prevent what you call "unwanted horizontal and vertical lines"
ggplot(imp, aes(x=value, group=.imp, colour=Imputed)) + 
    stat_density(geom = "path",position = "identity") +
    facet_wrap(~variable, ncol=2, scales="free") 
```

![在此处输入图像描述](../Images/dedd6bc465dd3003d07c8e9bd7e0a866.png)

我的问题是，如何修改它以单独绘制每个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T20:55:41.847

正如 Joran 所说，您可以只在每个图中使用数据的一个子集。

```
ggplot(imp[imp$variable=="bmi",], aes(x=value, group=.imp, colour=Imputed)) + 
    stat_density(geom = "path",position = "identity")
ggplot(imp[imp$variable=="hyp",], aes(x=value, group=.imp, colour=Imputed)) + 
    stat_density(geom = "path",position = "identity")
ggplot(imp[imp$variable=="chl",], aes(x=value, group=.imp, colour=Imputed)) + 
    stat_density(geom = "path",position = "identity") 
```

或者，您可以将它们放在一个循环中

```
library("plyr")
d_ply(imp, .(variable), function(DF) {
    print(ggplot(DF, aes(x=value, group=.imp, colour=Imputed)) + 
        stat_density(geom = "path",position = "identity"))
}) 
```

这种方法的缺点是它把所有的图一个接一个地放出来，所以没有机会在屏幕上看到以前的图。如果您要输出到 PDF（直接或通过类似的方式`knitr`），所有内容都将被写入并以这种方式显示。

# android - 程序化ImageView android重复行

> ID：12395907
> 
> 赞同：0
> 
> 时间：2012-09-12T20:41:24.570
> 
> 标签：android, layout, imageview

所以我有一个android应用程序的功能，它应该拍摄任意数量的图片并为每行显示5张图片，由于某种原因，当它进入第二行时，它只是重复第一行的图片，例如如果我有 7 张编号为 1-7 的图片，它们将显示：12345 12 这是我的功能，感谢您的建议。

```
public void generateImageView(int number, String path){
        //ImageView[] imageViewArray = new ImageView[number];
        int ROW_ITEMS = 5; // 5 images per row
        RelativeLayout rl = (RelativeLayout) findViewById(R.id.RelativeLayout1);
        int limit = number;//limits the number of created imageViews to number
        int rows = limit / ROW_ITEMS;//number of rows
        int leftOver = limit % ROW_ITEMS; //see if we have incomplete rows
        if (leftOver != 0){
            rows += 1;
        }
        int id = 1000;
        int belowId = R.id.send;
        while (rows > 0){
            int realItemsPerRow = ROW_ITEMS;
            if (leftOver != 0 & rows == 1){
                realItemsPerRow = Math.min(ROW_ITEMS,  leftOver);
            }

        for (int i = 0; i < realItemsPerRow; i++){

            Bitmap myBitmap = BitmapFactory.decodeFile(path + i + ".png");
            ImageView imageViewArray = new ImageView(MainActivity.this);
            imageViewArray.setId(id);
            imageViewArray.setImageBitmap(myBitmap);
            RelativeLayout.LayoutParams lp = new RelativeLayout.LayoutParams(RelativeLayout.LayoutParams.WRAP_CONTENT, RelativeLayout.LayoutParams.WRAP_CONTENT);
            imageViewArray.setPadding(10,10,0,0);
            imageViewArray.setAdjustViewBounds(true);
            imageViewArray.setMaxHeight(80);
            imageViewArray.setMaxWidth(80);
            if (i==0) {
                lp.addRule(RelativeLayout.ALIGN_PARENT_LEFT, RelativeLayout.TRUE);
            } else {
                lp.addRule(RelativeLayout.RIGHT_OF, imageViewArray.getId() -1);
            }
            lp.addRule(RelativeLayout.BELOW, belowId);

            imageViewArray.setLayoutParams(lp);

            rl.addView(imageViewArray);
            id++;
        }
        belowId = id - 1;
        rows--; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:52:13.950

这是因为您只是为行中的每个位置拉取相同的图像：

```
Bitmap myBitmap = BitmapFactory.decodeFile(path + i + ".png"); 
```

添加前`while( rows > 0 )`：

```
int j = 0; 
```

然后将上面的内容更改为：

```
Bitmap myBitmap = BitmapFactory.decodeFile(path + ( j * ROW_ITEMS + i ) + ".png"); 
```

并在`rows--;`添加下：

```
j++; 
```

# matlab - 在 MATLAB 中导致错误的分位数函数

> ID：12395922
> 
> 赞同：0
> 
> 时间：2012-09-12T20:42:25.690
> 
> 标签：matlab, matrix, quantile

我以最简单的形式使用分位数函数：

```
x = [1.2,3,4,5];
y = quantile(x,0.5); 
```

但我得到了错误：

> “double”类型的输入参数的未定义函数“quantile”。

我在 MATLAB R2009a 中没有出现此错误，但在 R2012a 中出现此错误。可能是什么原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-13T15:10:11.087

请运行：

```
license('test', 'Statistics_Toolbox') 
```

如果这返回 0，那么您没有统计工具箱的有效许可证。

但是，如果您想在示例中使用它，则以下代码将执行以下操作：

```
y = median(x); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T22:03:35.150

`quantile`是统计工具箱的一部分。如果您在新安装中无权访问该功能，您将无法使用该功能。

要检查您安装了哪些工具箱，请`ver`在命令提示符处键入。

# objective-c - 将大纲视图的数据源委托给分离对象

> ID：12395926
> 
> 赞同：1
> 
> 时间：2012-09-12T20:42:41.167
> 
> 标签：objective-c, cocoa

我希望能够使用蓝色对象框来委派对 NSOutlineView 的控制。蓝色对象框将连接到我的主控制器，因此它只是一个数据源并控制 NSOutlineView 的内容。

我遇到的问题是我无法控制通道数据源。我只是调用了一个声明的方法，里面有一些测试 NSLog，它没有被调用。出口没有被实例化。

这是蓝色对象框（ChannelDataSource）的连接

![在此处输入图像描述](../Images/9aba70e96bbf703c3a4bba17d777ba48.png)

这是我的主控制器的文件所有者的连接。

![在此处输入图像描述](../Images/fef8281a1f58be002e611c44527de01f.png)

所以你看，我想做一些事情`[dataSource callMyMethod];`，最终目标是我可以控制`NSOutlineView`.

有任何想法吗？

**编辑**

该应用程序的结构使我的主要应用程序委托看起来像这样：

```
@implementation MyAppDelegate

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    // Insert code here to initialize your application
    controller = [[MainController alloc] init];
    [controller showWindow];
}

@end 
```

然后在`MainController`我有以下几点：

```
@implementation MainController

-(id)init {
    self = [super init];
    if (self) {
        // loads of random stuff

        [dataSource myMethod];
    }

    return self;
} 
```

所以“通道数据源”蓝色对象框是`dataSource`. 在应用程序生命周期的这一点上，它是 null，这不是我所期望的。同时，这对我来说还是有点黑魔法。如果你有一个蓝色的对象框，它在什么时候被实例化？显然，这并没有正确连接。

**编辑编辑**

进一步我上面的观点，并试图解决这个问题，这实际上是一个好方法吗？我认为它不符合一个像样的 MVC 架构，因为最终蓝色对象框的拥有类是存储和管理数据。有没有更好的方法来管理 NSOutlineView 中的内容？

**编辑 编辑 编辑**

所以我有我的应用程序委托，奇怪的是，它本身就是一个实例化主控制器的类。不要问我为什么这样做，这是非常早期的代码。所以我的应用程序委托（根入口点）有这个：

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    // Insert code here to initialize your application
    controller = [[MyController alloc] initWithWindowNibName:@"MainWindow"];
    [controller showWindow:nil]; // this doesn't open the window
    [controller loadWindow]; // this does open the window
} 
```

以及控制器的声明：

```
@interface MyController : NSWindowController 
```

其中包含以下方法声明：

```
-(void)windowDidLoad {
    [dataSource insertChannel:@"test" forServer:@"test2"];
} 
```

我有一个断点`windowDidLoad`，它肯定不会被调用。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T15:51:24.260

还有一些事情你没有澄清，但我可以做一些猜测。首先，我假设 MainController 是 NSWindowController 的子类。如果是这样，您应该使用 initWithWindowNibName: 而不是只使用 init，否则控制器如何知道当您将 showWindow: 寻址到它时要显示哪个窗口？其次，即使您这样做，并将您的 init 方法更改为 initWithWindowNibNamed:，您所写的内容也不会起作用，因为 init 在此过程中太早了，无法看到您的出口、数据源。如果您只记录 dataSource 它将出现空值。放置该代码的更好位置是在 windowDidLoad 中，因为那时一切都已设置好（这将在 showWindow 之后调用：）。所以，在我的小测试项目中，这就是我所做的。

在应用委托中：

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification {
    self.cont = [[Controller alloc] initWithWindowNibName:@"Window"];
    [self.cont showWindow:nil];
} 
```

在 Controller.MI 中有这个：

```
- (void)windowDidLoad {
    NSLog(@"%@",self.dataSource);
    [self.dataSource testMethod];
} 
```

在 IB 中，在 Window.xib 文件中，我将文件所有者的类设置为 Controller，将蓝色立方体的类设置为 ChannelDataSource。一切都与您在帖子中显示的方式相同。

# macos - Mac 上 Chrome 和 Firefox 中的上传对话框不会禁用页面元素的 mouseout 事件

> ID：12395929
> 
> 赞同：0
> 
> 时间：2012-09-12T20:42:57.950
> 
> 标签：macos, google-chrome, firefox, file-upload, dom-events

我的任务是在弹出的子菜单面板中实现文件上传表单。我正在使用 XmlHttpRequest，因此在收到文件加载完成/失败的事件状态之前，保持该弹出窗口打开很重要。`Onmouseover`和`onmouseout`事件用于显示/隐藏弹出窗口。在“隐藏”时，弹出面板与 DOM 分离，不能再用作 XHR 事件的侦听器。

当我单击表单的“浏览”按钮时，会在浏览器上方打开一个系统对话窗口。在 Windows 中的 IE、Chrome 和 Firefox 中，系统对话框禁用按页面处理的事件。这意味着如果您将鼠标光标移出页面元素之一的对话框窗口，该页面将不会执行任何操作，例如对`mouseOver`/`mouseOut`事件做出反应。不幸的是，如果在 Mac 上使用 Chrome/Firefox（Safari 可以），页面元素会在鼠标悬停/移出时做出反应。我的弹出菜单关闭（由于`mouseOut`弹出的事件处理程序）-> XHR 响应未正确管理。

假设必须在弹出窗口中有一个上传表单，那么在系统上传文件对话框窗口打开时保持该面板/表单可见的可能方法是什么？可能是 Mac 特定的解决方案。

示例代码可以在这里看到[http://jsfiddle.net/xqvXG/](http://jsfiddle.net/xqvXG/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T23:20:46.653

通过冻结弹出面板并用透明 div（“玻璃”）覆盖整个页面来解决此问题。

如果用户选择文件并开始上传，我会移除玻璃并使用 XHR 函数解冻弹出窗口`readyStateChangeHandler`（或者可以在`load`事件处理程序中执行此操作）。

如果用户在系统对话框窗口中单击“取消”或使用“X”按钮将其关闭 - 没有事件传递到页面并且“玻璃”保留在屏幕上。然后，对“玻璃”的任何点击都会将其移除并解冻（或简单地隐藏）弹出菜单。

如果按下取消/关闭，则需要“玻璃”来制作一个单击点（面板）以解冻弹出窗口。我不会说这是一个完美的解决方案（有时需要额外的操作），但非常接近我想要的。

# objective-c - 如何在目标 c 中模拟类方法以与 TDD 一起使用

> ID：12395933
> 
> 赞同：1
> 
> 时间：2012-09-12T20:43:37.983
> 
> 标签：objective-c, unit-testing, mocking, tdd

我正在使用第三方框架将数据发送到服务器。我正在嘲笑该第三方框架以隔离和测试我的代码如何与之交互。这是为了避免在单元测试时避免等待从网络取回数据，并且因为我想测试我编写的错误处理代码。

我没有使用 OCMock 或类似的东西，我正在通过子类化 3rd 方框架来编写自己的模拟对象。

我的方法看起来像这样-

```
- (void)loginWithCredentials:(NSDictionary *)credentials
{
    NSDictionary *credentials = [self credentials];
    NSString *username = [credentials objectForKey:kUserCredintialUsername];
    NSString *password = [credentials objectForKey:kUserCredintialPassword];

    [ThirdPartyClass loginWithUsername:username 
                           andPassword:password 
                                 block:^(ThirdPartyClass *user, NSError *error){
    if (user) {
        NSLog(@"We logged in");
    }
    else if (error) {
        NSLog(@"%@", [error errorString]);
    }
}];
} 
```

我想做的是`loginWithUsername:andPassword:block:`在我的单元测试中调用我的模拟。当前的方法显然是不可测试的，因为它没有遵循“告诉，不要问”（我不是在告诉`loginWithCredentials:`要调用哪个类`loginWithUser...block:`）。我能想到解决这个问题的唯一方法是向我的实例或类添加一个类变量或添加一个参数，`loginWithCredentials:`以便我可以替换我的模拟。生产代码这样做并没有获得任何清晰性 - 它已经被编写为 3rd 方库的适配器。相反，我更愿意尝试重构该`loginWithCredentials:`方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T05:18:32.760

[在https://github.com/AliSoftware/OHHTTPStubs](https://github.com/AliSoftware/OHHTTPStubs)有一个 HTTP 存根库。它通过捕获传出请求并返回文件数据来工作。它还允许对不同类型网络的加载速度进行初步模拟。

# cuda - CUDA 线程/线程块之间的通信

> ID：12395936
> 
> 赞同：0
> 
> 时间：2012-09-12T20:43:45.983
> 
> 标签：cuda, synchronization, gpu

我正在尝试将一些任务“映射”到 CUDA GPU。有 n 个任务要处理。（见伪代码）

```
malloc an boolean array flag[n] and initialize it as false.
for each work-group in parallel do
    while there are still unfinished tasks do
        Do something;
        for a few j_1, j_2, .. j_m (j_i<k) do
            Wait until task j_i is finished; [ while(flag[j_i]) ;  ]
            Do Something;
        end for
        Do something;
        Mark task k finished;  [  flag[k] = true;  ]
    end while
end for 
```

出于某种原因，我将不得不在不同的线程块中使用线程。

问题是如何实现**等待任务 j_i 完成；**并**标记任务 k 完成；**在 CUDA 中。我的实现是使用布尔数组作为标志。然后在任务完成后设置标志，并读取标志以检查任务是否完成。

但它只适用于小案例，一个大案例，GPU 因未知原因而崩溃。有没有更好的方法来实现 CUDA 中的**等待**和**标记**。

这基本上是CUDA上的线程间通信问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:54:07.647

在线程块中同步很简单，使用`__syncthreads()`. 然而线程块之间的同步更加棘手 - 编程模型方法是分成两个内核。

如果你仔细想想，这是有道理的。执行模型（对于 CUDA 和 OpenCL）适用于在处理单元上执行的一大堆块，但没有说明何时执行。这意味着一些块将被执行，但其他块不会（它们将等待）。因此，如果您有一个`__syncblocks()`then 您将面临死锁的风险，因为那些已经执行的将停止，但那些未执行的将永远不会到达障碍。

您可以在块之间共享信息（例如，使用全局内存和原子），但不能共享全局同步。

根据您尝试做的事情，通常有另一种解决或分解问题的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:58:10.827

您所要求的并不容易完成，因为线程块可以按任何顺序安排，并且没有简单的方法可以在它们之间进行同步或通信。从 CUDA 编程指南：

> 对于并行工作负载，在算法中由于某些线程需要同步以相互共享数据而破坏并行性的点，有两种情况： 这些线程属于同一个块，在这种情况下，它们应该使用 __syncthreads () 并在同一个内核调用中通过共享内存共享数据，或者它们属于不同的块，在这种情况下，它们必须使用两个单独的内核调用通过全局内存共享数据，一个用于写入，一个用于从全局内存中读取。第二种情况不太理想，因为它增加了额外内核调用和全局内存流量的开销。

因此，如果您不能在一个线程块中满足您需要的所有通信，则需要进行多个内核调用才能完成您想要的。

我不相信 OpenCL 有什么不同，但我也不在 OpenCL 中工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-12T22:59:25.590

这种问题最好通过稍微不同的方法来解决：

不要将固定任务分配给您的线程，迫使您的线程等待它们的任务可用（这在 CUDA 中是不可能的，因为线程不能阻塞）。

相反，保留一个可用任务列表（使用原子操作）并让每个线程从该列表中获取一个任务。

这仍然很难实现并正确处理极端情况，但至少这是可能的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-14T18:43:50.083

我认为你不需要在 CUDA 中实现。每件事都可以在 CPU 上实现。您正在等待一项任务完成，然后随机执行另一项任务。如果你想在 CUDA 中实现，你不需要等待所有的标志都为真。您最初知道所有标志都是错误的。因此，只需`Do something`为所有线程并行实现并将标志更改为 true。

如果你想在CUDA中实现，`int flag`在完成之后继续加1，`Do something`这样你就可以知道在做之前和之后flag的变化`Do something`。

如果我的问题错了，请发表评论。我会努力改进答案。

# android - Android蓝牙IOException：连接被拒绝

> ID：12395938
> 
> 赞同：0
> 
> 时间：2012-09-12T20:43:56.913
> 
> 标签：android, python, bluetooth, connect, sl4a

注意：也发布在[https://groups.google.com/forum/?fromgroups=#!topic/android-scripting/UsPy3x4jvG0](https://groups.google.com/forum/?fromgroups=#!topic/android-scripting/UsPy3x4jvG0)

我正在尝试连接到蓝牙 RFCOMM 设备。我使用 sl4a 并从 Python 脚本连接。我有两个运行相同 Android 版本 2.3.4 的 Android 设备。

在一台设备上（Galaxy S2 非常接近股票内核，root），脚本运行良好并连接到 RFCOMM 设备。在另一台设备上，异国情调的 Winmate E430T（我怀疑是专门的坚固型 Android 手机，音量相当低），我得到了`java.io.IOException: Connection refused`.

我尝试运行示例代码`bluetooth_chat.py`但没有成功，该代码用于 Android 到 Android 的连接。我收到相同的错误消息，这表明问题不在我的代码中，而更多的是 Winmate 手机的状态（是否已root，已安装软件，配置）。

有人见过类似的东西吗？我看到了关于 unpair-repair 的帖子，我尝试了两次，但没有帮助。在安装 Python 和所有模块后，我还尝试重新启动 Winmate。

编码：

```
import android
droid = android.Android()
address = '00:12:F3:11:DC:D5'
uuid = '00001101-0000-1000-8000-00805F9B34FB'
droid.toggleBluetoothState(True)
droid.bluetoothConnect(uuid, address) 
```

logcat 的摘录：

```
V/sl4a.JsonRpcServer:117(27913): Sent: {"error":null,"id":6,"result":{"which":"negative"}}
V/sl4a.JsonRpcServer:74(27913): Received: {"params": [], "id": 7, "method": "bluetoothConnect"}
I/ActivityManager( 1304): Starting: Intent { flg=0x18000000 cmp=com.googlecode.android_scripting/.activity.FutureActivity (has extras) } from pid 27913
I/HK/LatinKeyboardBaseView( 1385): closing org.pocketworkstation.pckeyboard.LatinKeyboardView@407d4810
D/sl4a.ConsoleActivity:761(27913): onResume called
D/sl4a.ConsoleActivity:746(27913): onPause called
V/sl4a.FutureActivity:50(27913): FutureActivity created.
I/ActivityManager( 1304): Starting: Intent { cmp=com.googlecode.android_scripting/.activity.BluetoothDeviceList } from pid 27913
E/BluetoothEventLoop.cpp( 1304): event_filter: Received signal org.bluez.Adapter:PropertyChanged from /org/bluez/23550/hci0
V/BluetoothEventRedirector( 1862): Received android.bluetooth.adapter.action.DISCOVERY_STARTED
I/HK/LatinKeyboardBaseView( 1385): closing org.pocketworkstation.pckeyboard.LatinKeyboardView@407d4810
E/BluetoothEventLoop.cpp( 1304): event_filter: Received signal org.bluez.Adapter:DeviceFound from /org/bluez/23550/hci0
D/BluetoothService( 1304): updateDeviceServiceChannelCache(00:12:F3:11:DC:D5)
V/BluetoothEventRedirector( 1862): Received android.bluetooth.device.action.FOUND
E/BluetoothEventLoop.cpp( 1304): event_filter: Received signal org.bluez.Adapter:DeviceFound from /org/bluez/23550/hci0
D/BluetoothService( 1304): updateDeviceServiceChannelCache(0C:DF:A4:78:99:50)
I/ActivityManager( 1304): Displayed com.googlecode.android_scripting/.activity.BluetoothDeviceList: +449ms (total +519ms)
D/BluetoothService( 1304):  uuid(system): 00001105-0000-1000-8000-00805f9b34fb 3
V/BluetoothEventRedirector( 1862): Received android.bluetooth.device.action.FOUND
D/wpa_supplicant(19159): CMD: DRIVER RSSI-APPROX
D/wpa_supplicant(19159): wpa_driver_tista_driver_cmd RSSI-APPROX
D/wpa_supplicant(19159): rssi-approx command
D/wpa_supplicant(19159): CMD: DRIVER LINKSPEED
D/wpa_supplicant(19159): wpa_driver_tista_driver_cmd LINKSPEED
D/wpa_supplicant(19159): Link Speed command
D/wpa_supplicant(19159): buf LinkSpeed 54
E/BluetoothEventLoop.cpp( 1304): event_filter: Received signal org.bluez.Adapter:PropertyChanged from /org/bluez/23550/hci0
E/BluetoothService.cpp( 1304): stopDiscoveryNative: D-Bus error in StopDiscovery: org.bluez.Error.Failed (Invalid discovery session)
V/BluetoothEventRedirector( 1862): Received android.bluetooth.adapter.action.DISCOVERY_FINISHED
D/sl4a.ConsoleActivity$1:145(27913): Connected to TerminalManager and found bridges.size=1
I/HK/LatinKeyboardBaseView( 1385): closing org.pocketworkstation.pckeyboard.LatinKeyboardView@407d4810
D/sl4a.ConsoleActivity:761(27913): onResume called
E/BluetoothEventLoop.cpp( 1304): event_filter: Received signal org.bluez.Device:PropertyChanged from /org/bluez/23550/hci0/dev_0C_DF_A4_78_99_50
D/BluetoothService( 1304): updateDeviceServiceChannelCache(0C:DF:A4:78:99:50)
D/BluetoothService( 1304):  uuid(system): 00001105-0000-1000-8000-00805f9b34fb 3
D/BluetoothService( 1304):  uuid(application): 457807c0-4897-11df-9879-0800200c9a66 13
D/BluetoothService( 1304): Making callback for 457807c0-4897-11df-9879-0800200c9a66 with result 13
V/BluetoothEventRedirector( 1862): Received android.bleutooth.device.action.UUID
E/sl4a.JsonRpcServer:101(27913): Invocation error.
E/sl4a.JsonRpcServer:101(27913): java.io.IOException: Connection refused
E/sl4a.JsonRpcServer:101(27913):    at android.bluetooth.BluetoothSocket.connectNative(Native Method)
E/sl4a.JsonRpcServer:101(27913):    at android.bluetooth.BluetoothSocket.connect(BluetoothSocket.java:204)
E/sl4a.JsonRpcServer:101(27913):    at com.googlecode.android_scripting.facade.BluetoothFacade.bluetoothConnect(BluetoothFacade.java:158)
E/sl4a.JsonRpcServer:101(27913):    at java.lang.reflect.Method.invokeNative(Native Method)
E/sl4a.JsonRpcServer:101(27913):    at java.lang.reflect.Method.invoke(Method.java:507)
E/sl4a.JsonRpcServer:101(27913):    at com.googlecode.android_scripting.jsonrpc.RpcReceiverManager.invoke(RpcReceiverManager.java:87)
E/sl4a.JsonRpcServer:101(27913):    at com.googlecode.android_scripting.facade.FacadeManager.invoke(FacadeManager.java:58)
E/sl4a.JsonRpcServer:101(27913):    at com.googlecode.android_scripting.rpc.MethodDescriptor.invoke(MethodDescriptor.java:109)
E/sl4a.JsonRpcServer:101(27913):    at com.googlecode.android_scripting.jsonrpc.JsonRpcServer.handleConnection(JsonRpcServer.java:99)
E/sl4a.JsonRpcServer:101(27913):    at com.googlecode.android_scripting.SimpleServer$ConnectionThread.run(SimpleServer.java:91)
V/sl4a.JsonRpcServer:117(27913): Sent: {"error":"java.io.IOException: Connection refused","id":7,"result":null}
V/sl4a.JsonRpcServer:74(27913): Received: {"params": [], "id": 8, "method": "bluetoothReadLine"}
E/sl4a.JsonRpcServer:101(27913): Invocation error.
E/sl4a.JsonRpcServer:101(27913): java.io.IOException: Bluetooth not ready for this connID.
E/sl4a.JsonRpcServer:101(27913):    at com.googlecode.android_scripting.facade.BluetoothFacade.getConnection(BluetoothFacade.java:95)
E/sl4a.JsonRpcServer:101(27913):    at com.googlecode.android_scripting.facade.BluetoothFacade.bluetoothReadLine(BluetoothFacade.java:231)
E/sl4a.JsonRpcServer:101(27913):    at java.lang.reflect.Method.invokeNative(Native Method)
E/sl4a.JsonRpcServer:101(27913):    at java.lang.reflect.Method.invoke(Method.java:507)
E/sl4a.JsonRpcServer:101(27913):    at com.googlecode.android_scripting.jsonrpc.RpcReceiverManager.invoke(RpcReceiverManager.java:87)
E/sl4a.JsonRpcServer:101(27913):    at com.googlecode.android_scripting.facade.FacadeManager.invoke(FacadeManager.java:58)
E/sl4a.JsonRpcServer:101(27913):    at com.googlecode.android_scripting.rpc.MethodDescriptor.invoke(MethodDescriptor.java:109)
E/sl4a.JsonRpcServer:101(27913):    at com.googlecode.android_scripting.jsonrpc.JsonRpcServer.handleConnection(JsonRpcServer.java:99)
E/sl4a.JsonRpcServer:101(27913):    at com.googlecode.android_scripting.SimpleServer$ConnectionThread.run(SimpleServer.java:91)
V/sl4a.JsonRpcServer:117(27913): Sent: {"error":"java.io.IOException: Bluetooth not ready for this connID.","id":8,"result":null}
V/sl4a.JsonRpcServer:74(27913): Received: {"params": ["Chat Received", null], "id": 9, "method": "dialogCreateAlert"}
V/sl4a.JsonRpcServer:117(27913): Sent: {"error":null,"id":9,"result":null}
V/sl4a.JsonRpcServer:74(27913): Received: {"params": ["Ok"], "id": 10, "method": "dialogSetPositiveButtonText"}
V/sl4a.JsonRpcServer:117(27913): Sent: {"error":null,"id":10,"result":null}
V/sl4a.JsonRpcServer:74(27913): Received: {"params": [], "id": 11, "method": "dialogShow"}
I/ActivityManager( 1304): Starting: Intent { flg=0x18000000 cmp=com.googlecode.android_scripting/.activity.FutureActivity (has extras) } from pid 27913
D/sl4a.ConsoleActivity:746(27913): onPause called 
```

编辑 2012 年 13 月 9 日 09:55：我尝试`Bluetooth Chat App`了市场上的 (BILL RAY)，它允许我的两部手机聊天，我可以从任一方连接：问题至少可以用 Java 解决。这个`bluetooth_chat.py`例子仍然不起作用。

编辑 10:45：我从 BeanShell 尝试仍然在 SL4A 中遇到同样的问题，在我的 S2 上工作并在我的 Winmate 上失败：

代码：

```
source("/sdcard/com.googlecode.bshforandroid/extras/bsh/android.bsh");
droid = Android();
droid.call("makeToast", "Hello, Android!");
address = "00:12:F3:11:DC:E5";
uuid = "00001101-0000-1000-8000-00805F9B34FB";
droid.call("toggleBluetoothState","True");
droid.call("bluetoothConnect",uuid, address);
droid.call("makeToast", "Bye, Android!"); 
```

logcat 类似：

```
I/ActivityManager( 1305): Starting: Intent { act=android.bluetooth.adapter.action.REQUEST_ENABLE cmp=com.android.settings/.bluetooth.RequestPermissionActivity } from pid 7364
D/dalvikvm( 7364): GC_CONCURRENT freed 1075K, 49% free 3716K/7239K, external 4198K/5242K, paused 2ms+14ms
V/sl4a.JsonRpcServer:117( 7364): Sent: {"error":null,"id":0,"result":true}
I/HK/LatinKeyboardBaseView( 1385): closing org.pocketworkstation.pckeyboard.LatinKeyboardView@4078a040
V/sl4a.JsonRpcServer:74( 7364): Received: {"id":0,"method":"bluetoothConnect","params":["00001101-0000-1000-8000-00805F9B34FB","00:12:F3:11:DC:E5"]}
E/BluetoothService.cpp( 1305): stopDiscoveryNative: D-Bus error in StopDiscovery: org.bluez.Error.Failed (Invalid discovery session)
I/ActivityManager( 1305): Displayed com.googlecode.android_scripting/.activity.FutureActivity: +223ms
I/HK/LatinKeyboardBaseView( 1385): closing org.pocketworkstation.pckeyboard.LatinKeyboardView@4078a040
D/sl4a.ConsoleActivity:761( 7364): onResume called
E/BluetoothEventLoop.cpp( 1305): event_filter: Received signal org.bluez.Device:PropertyChanged from /org/bluez/1804/hci0/dev_00_12_F3_11_DC_E5
I/ActivityManager( 1305): Start proc com.google.android.carhome for broadcast com.google.android.carhome/.receiver.BluetoothLaunchReceiver: pid=7876 uid=10020 gids={3002, 3001}
I/HK/LatinKeyboardBaseView( 1385): closing org.pocketworkstation.pckeyboard.LatinKeyboardView@4078a040
I/ActivityThread( 7876): Pub com.google.android.carhome.config: com.google.android.carhome.CarHomeProvider
D/BluetoothService( 1305): updateDeviceServiceChannelCache(00:12:F3:11:DC:E5)
D/BluetoothService( 1305):  uuid(application): 00001101-0000-1000-8000-00805f9b34fb 1
D/BluetoothService( 1305): Making callback for 00001101-0000-1000-8000-00805f9b34fb with result 1
D/dalvikvm( 7364): GC_EXTERNAL_ALLOC freed 50K, 49% free 3698K/7239K, external 4198K/5242K, paused 131ms
V/BluetoothEventRedirector( 7681): Received android.bleutooth.device.action.UUID
I/BluetoothEventLoop.cpp( 1305): agent_event_filter: Received method org.bluez.Agent:OutOfBandAvailable
I/sl4a.TerminalBridge:540( 7364): parentChanged() now width=133, height=34
E/sl4a.JsonRpcServer:101( 7364): Invocation error.
E/sl4a.JsonRpcServer:101( 7364): java.io.IOException: Connection refused
E/sl4a.JsonRpcServer:101( 7364):    at android.bluetooth.BluetoothSocket.connectNative(Native Method)
E/sl4a.JsonRpcServer:101( 7364):    at android.bluetooth.BluetoothSocket.connect(BluetoothSocket.java:204)
E/sl4a.JsonRpcServer:101( 7364):    at com.googlecode.android_scripting.facade.BluetoothFacade.bluetoothConnect(BluetoothFacade.java:158)
E/sl4a.JsonRpcServer:101( 7364):    at java.lang.reflect.Method.invokeNative(Native Method)
E/sl4a.JsonRpcServer:101( 7364):    at java.lang.reflect.Method.invoke(Method.java:507)
E/sl4a.JsonRpcServer:101( 7364):    at com.googlecode.android_scripting.jsonrpc.RpcReceiverManager.invoke(RpcReceiverManager.java:87)
E/sl4a.JsonRpcServer:101( 7364):    at com.googlecode.android_scripting.facade.FacadeManager.invoke(FacadeManager.java:58)
E/sl4a.JsonRpcServer:101( 7364):    at com.googlecode.android_scripting.rpc.MethodDescriptor.invoke(MethodDescriptor.java:109)
E/sl4a.JsonRpcServer:101( 7364):    at com.googlecode.android_scripting.jsonrpc.JsonRpcServer.handleConnection(JsonRpcServer.java:99)
E/sl4a.JsonRpcServer:101( 7364):    at com.googlecode.android_scripting.SimpleServer$ConnectionThread.run(SimpleServer.java:91)
V/sl4a.JsonRpcServer:117( 7364): Sent: {"error":"java.io.IOException: Connection refused","id":0,"result":null} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T02:02:47.377

[Python4Android 项目](https://code.google.com/p/python-for-android/)有一个为 ARM 编译的PyBluez 的副本，这在这里可能很有用。

它不是纯 Python，但安装起来很简单；您只需将 egg 文件的副本下载到您的机器人，打开 Python4Android 应用程序，点击 Import Modules 并选择 egg 文件。

我以前用过这个东西没有问题。

*   PyBluez 项目 [[访问](http://code.google.com/p/pybluez/)]
*   Python4Android项目[[访问](https://code.google.com/p/python-for-android/)]
*   PY4A 预编译包列表，包括 PyBluez [[访问](https://code.google.com/p/python-for-android/wiki/Modules)]
*   PyBluez-0.19-py2.6-linux-armv.egg [[下载](https://python-for-android.googlecode.com/files/PyBluez-0.19-py2.6-linux-armv.egg)]

# java - JAXB 解组错误后文件被阻止的文件

> ID：12395940
> 
> 赞同：4
> 
> 时间：2012-09-12T20:44:07.733
> 
> 标签：java, file, exception, jaxb, unmarshalling

我有一个工作正常的 JAXB 编组/解组进程，除了这个：有时我必须解组的文件是空的或格式不正确，因此解组会引发异常。没关系，但是在此异常之后，我正在解组的文件（源 xml 文件 java 对象）被阻止。我不能使用它。

我注意到这试图在解组异常之后立即删除或重命名文件。如果没有发生异常，则可以毫无问题地使用这些文件，因为它应该。

有没有办法“解锁”这些文件？我认为必须有任何方法来释放、关闭或释放阻止我的文件的 JAXB 上下文或解组器对象的资源。

提前致谢，

丹妮

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:52:20.050

您可以从您的文件创建一个`FileInputStream`然后解组它。然后，您可以更好地控制发生错误时发生的情况。

```
FileInputStream inputStram = new FileInputStream(file);
Foo foo = (Foo) Unmarshaller unmarshal(inputStream); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-05-22T18:53:36.080

我错过了 finally 块中的资源释放（关闭流等）。多年前的菜鸟错误！谢谢！

# css - 页面的移动渲染在小视图中加载完整的垂直页面

> ID：12395942
> 
> 赞同：0
> 
> 时间：2012-09-12T20:44:21.927
> 
> 标签：css, mobile

我正在为我的网站构建移动优化页面。我是移动网络优化的新手。在我的开发机器上一切看起来都很好，但是当我在我的 android 移动浏览器上查看页面时，它看起来非常小，因为它强制文本的完整垂直部分显示在浏览器中。这不会发生在我的桌面浏览器上。有什么想法可以阻止这种情况发生并让它在移动浏览器中以全宽显示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:48:35.250

你错过了一个`meta-viewport`标签，试试这个：

```
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0" > 
```

重要的是`width=device-width`，这将确保您的 HTML 占据屏幕的整个宽度。初始和最大比例属性设置为 1 以禁用缩放，只需将值更改为`maximum-scale`1 到 10 之间的值以允许缩放。

# visual-studio-2010 - Visual Studio 2010 未将 XSL 文件部署到 SharePoint 2010

> ID：12395948
> 
> 赞同：0
> 
> 时间：2012-09-12T20:45:29.790
> 
> 标签：visual-studio-2010, sharepoint, sharepoint-2010

所以我在 Visual Studio 2010 中有一个 SharePoint 2010 项目，并且我定义了一个 fldtypes_*.xsl 文件。我将文件放入映射目录 /Template/Layouts/XSL，但是，当我使用 Build->Deploy 部署应用程序时，不会复制该文件。

我可以手动复制文件，效果很好，但必须有一种方法可以通过常规部署过程进行复制。

有谁知道出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-13T07:03:18.647

尝试使用相对路径引用您的 .xsl 文件：

`"/_XSL/path/to/xslFile.xsl"`

我假设您选择了 Add -> SharePoint Mapped Folder... 但是当您选择 XSL 文件夹时没有添加 TEMPLATES 和 LAYOUTS，因此没有添加到项目中的文件夹树中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T14:31:01.207

显然，问题是我在“布局”中添加了一个映射文件夹，然后在其下方添加了 XSL 文件夹，期望它与布局文件夹中的其余内容一起部署。事实并非如此。

我将映射目录直接添加到 XSL 文件夹并进行部署，它工作正常。不知道为什么以前的设置不起作用，因为这是所有示例中显示的方式，但是你去。

# c# - 从 64 位应用程序调用 Twain 驱动程序

> ID：12395950
> 
> 赞同：2
> 
> 时间：2012-09-12T20:45:35.623
> 
> 标签：c#, .net, twain

我需要从为 x64 目标平台编译的 .NET (C#) 应用程序调用 TWAIN API。对提供 64 位 twain 实现的 3rd 方供应商有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:49:31.007

不，很遗憾没有。据我所知，不存在 TWAIN 驱动程序本机 64 位。我认为唯一的解决方案是在 x86 32 位上编译您的应用程序。

另一种选择（商业）是[TWAIN 64-32 Bridge](http://www.eztwain.com/twain-bridge.htm)。

# asp.net - AjaxControlToolKit 与 .Net 4 下的 64 位环境不兼容

> ID：12395952
> 
> 赞同：1
> 
> 时间：2012-09-12T20:45:42.393
> 
> 标签：asp.net, ajaxcontroltoolkit

为 Windows 2008 R2 64 位服务器编写 Web 应用程序。

Visual Studio 2010，.Net Framework 4，64 位 Windows 7，64 位硬件。我创建了一个 ASP.NET Web 应用程序，右键单击项目，转到属性，在构建选项卡下，将平台目标设置为 x64。

我下载了 Ajax .net 4 工具包。在工具箱中，我添加了一个选项卡和 AjaxControlToolkit。

我将 Ajax 控件从工具箱放入我的默认页面。例如：工具包脚本管理器。智能感知强调了它。警告信息是：

元素“ToolkitScriptManager”不是已知元素。如果网站中存在编译错误，或者缺少 web.config 文件，则可能会发生这种情况。

我有一个 web.config 文件，默认情况下它就在那里，我通常不会弄乱它。

我运行该应用程序并收到以下错误消息：

无法加载文件或程序集“WebApplication1”或其依赖项之一。试图加载格式不正确的程序。

将目标平台切换回任何 CPU 可解决此问题，但不能解决此问题。

# mysql - MySQL 的复杂唯一约束

> ID：12395960
> 
> 赞同：1
> 
> 时间：2012-09-12T20:46:16.613
> 
> 标签：mysql, constraints

考虑下表：

```
CREATE TABLE `demo` (
  `id` BIGINT(20) NOT NULL AUTO_INCREMENT,
  `from_val` BIGINT(20) DEFAULT NULL,
  `to_val` BIGINT(20) DEFAULT NULL,
  PRIMARY KEY (`id`)
); 
```

是否可以创建一个约束来防止在同一个表中存在第二条记录，`from_val` *或者* `to_val`在另一条记录的`from_val`和之间`to_val`？因此，从一个空表中，第二个查询应该会因约束失败而失败：

```
INSERT INTO `demo` (`from_val`, `to_val`) VALUES (1,10),(11,20);
INSERT INTO `demo` (`from_val`, `to_val`) VALUES (5,15); 
```

在输入/更新的过程中验证数据是微不足道的，我只是想知道 MySQL 是否可以在 RDBMS 级别强制执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:54:52.157

不，MySQL 不支持（或强制执行）任何在您指定的条件下会引发异常的声明性约束。

元组中的值`(5,15)`（“第二个查询”）与先前插入表中的任何行中的任何值都不冲突...... `(1,10),(11,20)`，至少就 MySQL 中的声明性约束可用的内容而言。

解决方法是在表上定义`BEFORE INSERT`和`BEFORE UPDATE`触发器；这些可以执行您需要的任何检查，并引发异常。

# xcode - 从 MacRuby 访问外部文件

> ID：12395966
> 
> 赞同：1
> 
> 时间：2012-09-12T20:46:39.970
> 
> 标签：xcode, macruby

我之前做过几个小型脚本/自动化项目，但这是我第一次使用 MacRuby，我根本不知道为什么我的项目不工作。

如果它只是一个普通的 Ruby 脚本，这个任务很容易修复。但是，它需要一个 Mac GUI，所以我决定使用 MacRuby 来进行 Cocoa 绑定。

该应用程序本身是一个简单的表单，它将根据来自外部 CSV 的一些数据和一些文本字段执行计算，然后显示计算结果。

我的问题是这段代码似乎不起作用：

```
@arr_from_csv = CSV.read("data.csv") 
```

在构建文件时，我收到以下错误：

```
[...]/ruby/1.9.2/CSV.rb:1335:in `open': No such file or directory - open() failed (Errno::ENOENT) 
```

起初，我认为我一定是把 CSV 文件放到了 XCode 项目文件夹结构内的错误目录中。我尝试放置与脚本本身相同的文件夹（`app_delegate.rb`）。没用。我试着把它放在`Resources`文件夹里，仍然没有用。

然后，我决定只使用绝对文件路径。因此，我将代码更改为：

```
@arr_from_csv = CSV.read("~/data.csv") 
```

并将文件复制到我的主目录中。它仍然无法读取 CSV 文件。

我错过了什么吗？对不起，这是我第一次使用 MacRuby。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-28T08:30:13.727

您应该将代码更改为“/Users/xxx/data.csv”。Ruby 不会将“~”扩展为“/Users/xxx”。

注意：xxx 代表您的登录 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T15:26:57.073

我能够通过使用来解决我的问题：

```
@arr_from_csv = CSV.read(File.expand_path("~/data.csv")) 
```

# javascript - Javascript 正则表达式 - 获取 [stuff in here] 之后的所有文本

> ID：12395967
> 
> 赞同：0
> 
> 时间：2012-09-12T20:46:43.287
> 
> 标签：javascript, regex, string

我的程序中有这样的字符串：

```
var myStrings = [

"[asdf] thisIsTheText",
"[qwerty]  andSomeMoreText",
"noBracketsSometimes",
"[12345]someText"

]; 
```

我想捕获字符串“thisIsTheText”、“andSomeMoreText”、“noBracketsSometimes”、“someText”。输入的模式总是相同的，方括号中包含一些内容（或者可能没有），然后是一些空格（同样，可能不是），然后是我想要的实际文本。

我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T20:49:24.017

这应该让你开始：

```
/(?:\[[^]]*])?\s*(\w+)/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:49:58.210

一种方法：

```
var actualTextYouWant = originalString.replace(/^\[[^\]]+\]\s*/, ''); 
```

`originalString`这将返回一个删除了初始`[...]`和空格的副本。

# arrays - excel：如何识别包含从关键字列表中提取的文本关键字的行

> ID：12395971
> 
> 赞同：2
> 
> 时间：2012-09-12T20:47:00.117
> 
> 标签：arrays, excel, vba

我有一列（称为A）数据，其中每个单元格都包含一长串单词，例如：

```
COLUMN A 
HORNBACH BAUMARKT ETOY, ETOY 
ALIGRO, CHAVANNES-PR 
DIPL. ING. FUST AG,ETO, ETOY 
AGIP SUISSE SA 224, LAUSANNE 
AMAZON MEDIA EU, LUXEMBOURG 
MIGROS M EPALINGES, EPALINGES 
HORNBACH BAUMARKT ETOY, ETOY 
MANOR AG - 390, BASEL 
MANOR AG - 390, BASEL 
GLOBUS LAUSANNE, LAUSANNE 
```

我在另一列中还有另一个关键字列表（称为 B），例如

```
COLUMN B 
MSFT 
Amazon 
Hornbach 
Jumbo 
OBI 
Lipo 
Ikea 
Coop 
Migros 
Casino 
```

这就是我想做的：

对于 Col B 中的每个关键字 K 检查 Col A 中的每个单元格，看看该条目是否作为子字符串存在，如果存在，则在 C 列的相邻单元格中输入关键字 K 如果不存在，则将相邻单元格留在列中C 不变 重复下一个关键字 K

结果应该是：

```
COLUMN A ----------------------------------> COLUMN C 
HORNBACH BAUMARKT ETOY, ETOY --------------> Hornbach 
ALIGRO, CHAVANNES-PR 
DIPL. ING. FUST AG,ETO, ETOY 
AGIP SUISSE SA 224, LAUSANNE 
AMAZON MEDIA EU, LUXEMBOURG ---------------> Amazon 
MIGROS M EPALINGES, EPALINGES -------------> Migros 
HORNBACH BAUMARKT ETOY, ETOY --------------> Hornbach 
MANOR AG - 390, BASEL 
MANOR AG - 390, BASEL 
GLOBUS LAUSANNE, LAUSANNE 
```

我可以看到如何使用 VBA 类型结构来做到这一点......但肯定有一种方法可以使用内置的 Excel 函数来做到这一点 - INDEX、HLOOKUP、SEARCH ......等。

我试过但没有成功。如果有人有更好的想法，请告诉我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-12T21:27:34.360

假设每行最多只有 1 个匹配的单词，你可以在 C1 中使用这个公式复制下来

`=IFERROR(LOOKUP(2^15,SEARCH(B$1:B$10,A1),B$1:B$10),"")`

IFERROR 函数仅在 Excel 2007 或更高版本中可用，对于早期的 Excel 版本，请尝试此修改

`=LOOKUP("zzz",IF({1,0},"",LOOKUP(2^15,SEARCH(B$1:B$10,A1),B$1:B$10)))`

如果您想在单独的单元格中获得多个匹配项，则可以在 C1 中使用此“数组公式”，`CTRL+SHIFT+ENTER`并根据需要确认并向下复制（与最大可能匹配项相称）

`=IFERROR(INDEX($B$1:$B$10,SMALL(IF(COUNTIF($A1,"*"&$B$1:$B$10&"*"),ROW($B$1:$B$10)-ROW($B$1)+1),COLUMNS($C1:C1))),"")`

如果 A1 在列表中包含 3 个单词，那么这些将填充在 C1、D1 和 E1 中，F1 等将保持空白

**根据评论修改：**

公式中的第一个范围（INDEX 的第一个参数）定义了从中获取结果的范围，以便将其更改为 Z 列只需更改该部分，即

`=IFERROR(INDEX($Z$1:$Z$10,SMALL(IF(COUNTIF($A1,"*"&$B$1:$B$10&"*"),ROW($B$1:$B$10)-ROW($B$1)+1),COLUMNS($C1:C1))),"")`

# ruby-on-rails - 在 Rails 应用程序中使用多个 git 存储库隐藏 db 的密码

> ID：12395975
> 
> 赞同：3
> 
> 时间：2012-09-12T20:47:28.117
> 
> 标签：ruby-on-rails, ruby-on-rails-3, git, github, capistrano

我在 GitHub 和我的私有 Amazon 实例上都有一个 git 存储库，并且我通过唯一的提交更新了两者。

有一种方法可以`database.yml`只将文件提交到我的私人存储库而不是 GitHub 上吗？

如果有帮助，我正在使用 Capistrano 进行部署。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-12T20:47:28.117

在过去的几天里，我没有找到这个问题的答案，但后来我解决了我的问题，所以我会说我做了什么来让事情正常进行。

由于我不必修改文件`database.yml`，我解决了我的问题，手动将其复制到我的 Amazon 实例并将其添加到`.gitignore`.

然后，我添加了一个任务`deploy.rb`来链接`database.yml`到当前部署目录

```
# copy db config
after "deploy:update_code", :copy_db_config
desc "copy db config file"
task :copy_db_config do
  run "ln -s ~/path/where/I/copied/database.yml #{release_path}/config/database.yml"
end 
```

希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-10T12:45:14.003

[这里](https://stackoverflow.com/questions/17151324/securely-providing-the-database-password-in-a-rails-app "在 Rails 应用程序中安全地提供数据库密码")提供了另一种解决方案。如果您之前定义了环境变量，则可以在`databases.yml`文件中使用它们。

```
username: <%= ENV['POSTGRES_USERNAME'] %>
password: <%= ENV['POSTGRES_PASSWORD'] %> 
```

# html5-video - 强制 Vimeo HTML5 视频嵌入

> ID：12395981
> 
> 赞同：18
> 
> 时间：2012-09-12T20:48:20.450
> 
> 标签：html5-video, vimeo

我正在尝试嵌入 Vimeo 视频并强制它默认使用 HTML5。

这是一个关于做我想做但与 YouTube 相同的事情[的线程。](https://stackoverflow.com/questions/5845484/force-html5-youtube-video)

[这是另一个](https://stackoverflow.com/questions/6407008/what-is-a-good-way-to-embed-vimeo-videos-in-html5-format)讨论获取 Vimeo HTML5 cookie的线程

[这是](https://vimeo.com/forums/topic:46313)Vimeo 网站上对该问题的讨论。基本上，我会根据用户在我的网站上的偏好来做这件事，所以他们的担忧并不真正适用。

有没有人知道即使在 Flash 可用时也可以强制嵌入 HTML5 Vimeo 的解决方法或方法？（我知道 cookie 应该可以在 Safari 中使用，但我有很多 Chrome 用户。）

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-23T17:26:24.837

目前没有办法强制使用嵌入脚本的 HTML5。“万能播放器”会根据设备自动选择格式。

旧嵌入提供了一种强制 Flash 的方法，但这是唯一的其他选择。

让我们期待未来的选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-26T23:31:27.810

在带有 flash 的浏览器上，播放器使用以下代码以 html5 模式加载。沙箱阻止 iframe 访问任何插件，包括 flash。

```
<iframe sandbox="allow-same-origin allow-scripts allow-popups"
  id="foo" width="100%" height="90%"
  allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" 
  src="http://player.vimeo.com/video/28544156?api=1">
</iframe> 
```

要允许 vimeo 按钮打开视频的 vimeo 网页，您需要“允许弹出窗口”权限。不需要播放视频。

编辑：添加完整示例

如果您只有一个黑色视图，则视频的大小可能为零，因为我将 iframe 设置为以 100% 的宽度填充父级，但如果父级缩小以适应，那么该大小仍然为零。这是一个带有 CSS 的整个网页，以使视频占据大部分页面。此外，-webkit-transform 将镜像视频，然后稍微旋转它。如果它在 Flash 中显示，则会产生黑屏，因为它根本无法处理旋转。从那以后，我发现这可能根本不适用于 Firefox，因为它本身不支持所有 vimeo 服务的 h.264，并且禁用插件将禁用使 h.264 在 Firefox 上工作的任何插件。

```
<!DOCTYPE html>
<html>
  <head>
    <style>
div {
  display: inline-block;
  top: 0px;
  left: 0px;
  bottom: 0px;
  right: 0px;
  position: absolute;
}
iframe {
  -webkit-transform: scaleX(-1) rotate(2deg);
}
    </style>
  </head>
  <body>
    <div>
      <iframe sandbox="allow-same-origin allow-scripts allow-popups"
        id="foo" width="100%" height="90%"
        allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" 
        src="http://player.vimeo.com/video/28544156?api=1">
      </iframe>
    </div>
  </body>
</html> 
```

# python - 如何处理 Python 协议字段中十六进制表示的固定大小/位置

> ID：12395988
> 
> 赞同：0
> 
> 时间：2012-09-12T20:49:00.537
> 
> 标签：python, python-2.7, hex, byte

我是 python 新手。我正在使用`Python 2.7`并希望编写一些东西，为最终将在网络上工作的模拟器生成样本数据集。不过现在，我们可以从文件中读取数据并将其输入模拟器。

我的第一个任务是定义字段并以编程方式将它们转储到文件中。该文件应包含将要发送的数字的十六进制表示。我被难住的是：**当我们知道它们将是固定长度时，我如何最好地在输出中表示十六进制数字？**

*例如，序列号在协议中总是保留 3 个字节，所以即使它是序列号 1，它也会在前面加上前导 0 来填充那个 3 字节的 SN 字段。*

我已经弄清楚了如何在 Python 中生成整数、字符串等，但是确定将它们以十六进制表示形式（带前导 0）写入文件的最佳方法让我很难过。

# solr - 使用 solr/lucene 进行精确字段搜索

> ID：12395990
> 
> 赞同：1
> 
> 时间：2012-09-12T20:49:04.520
> 
> 标签：solr, lucene, full-text-search, search-engine

我有文本字段。对于给定的查询，我想找到所有包含索引字段值的文档。

```
query.contains(document.field_name) 
```

示例： 1\. field_name:"ab" 2\. field_name:"ab c"

对于查询“ab d”，我只想找到第一项。

执行此操作的无效方法基本上是将查询和索引字段的所有子字符串生成为字符串。

是否可以使用现有功能在 Solr 中实现此类要求？如果不是，那么最有效的算法/方法是什么？

PS。似乎 google adwords 为查找添加进行了此类匹配。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-29T23:10:45.290

这是执行您要求的一种方法：

## 字段类型

```
<fieldType name="exact" class="solr.TextField" positionIncrementGap="100">
  <analyzer type="index">
    <tokenizer class="solr.KeywordTokenizerFactory"/>
    <filter class="solr.WordDelimiterFilterFactory" splitOnCaseChange="0" splitOnNumerics="0" preserveOriginal="0" generateWordParts="0" catenateAll="1" />
  </analyzer>
  <analyzer type="query">
    <tokenizer class="solr.KeywordTokenizerFactory"/>
    <filter class="solr.WordDelimiterFilterFactory" splitOnCaseChange="0" splitOnNumerics="0" preserveOriginal="0" generateWordParts="1" catenateAll="0" />
    <filter class="solr.ShingleFilterFactory" outputUnigrams="true" outputUnigramsIfNoShingles="true" tokenSeparator="" maxShingleSize="99"/>
  </analyzer>
</fieldType> 
```

## 解释：

索引分析器用于`WordDelimiterFilterFactory`将字段值拆分为单词。因此，使用您的示例，`a b`将拆分为单词`a`and `b`，并`a b d`拆分为`a`,`b`和`d`. 我们设置`catenateAll="1"`，`generateWordParts="0"`所以单个单词被丢弃，产生一个单词。`a`并`b`成为`ab`和并成为。`a`_`b``d``abd`

查询分析器类似，但有细微差别。我们将值拆分为单词，除非我们不丢弃单词或将它们连接起来。相反，我们将单词传递给`ShingleFilterFactory`，它接受`a`and`b`并返回`a`, `b`, and `ab`。

我们使用 shingles 而不是串联的原因是允许`a b c`匹配`a b`和`b c`。如果你只想`a b c`匹配`a b c`，设置`catenateAll="1"`和删除 shingle 工厂。

使用此配置，`a b`将仅匹配`a`、`b`和`a b`（而不是`a b d`）。此外，`a b c`将匹配`a`, `b`, `c`, `a b`, `b c`, 和`a b c`. 还应该注意的是`ab`会匹配`a b`。如果其中任何一个不是您想要的，您应该能够配置 shingle 和 word 过滤器工厂来完全满足您的需要。

**编辑**：这个答案的早期版本使用*魔法值*来标记值的开始和结束。事实证明这是不必要的；只需将这些值连接在一起就足以防止`a b`匹配`a b d`。

**编辑 2**（*索引分析器修复*）：`WhitespaceTokenizerFactory`应该是`KeywordTokenizerFactory`. 此外，`WordDelimiterFilterFactory`应该有`catenateAll="0"`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-13T02:24:18.477

我认为在单个 Solr 查询中可能很难做到这一点。如果我正确理解了您的问题，我想我会做的是对查询字符串进行标记，依次搜索每个标记，并将搜索结果与初始查询字符串进行比较。例如，假设您的查询字符串是“term1 term2 term3”。您将依次搜索以下每个术语：

```
/solr/index/select?q=term1 
```

这可能会返回以下内容：

```
term1 term2 term4
term1 term2
term1 term2 term3 
```

然后，您可以与您的初始查询（“term1 term2 term3”）进行比较，以查看它是否包含每个搜索结果。抱歉，如果以上内容没有帮助。

# jquery - jQuery Validation 插件：提示覆盖

> ID：12395991
> 
> 赞同：0
> 
> 时间：2012-09-12T20:49:08.087
> 
> 标签：jquery, jquery-plugins, validation

我有一个具有排序验证的 jQuery 表单。这是一个数据输入屏幕，上面有两个文本框。每个文本框的大声值从 1 到无穷大，但第一个控件的“所需”范围为 36-84，第二个控件为 50-300。如果该值在所需范围内，则提交通过。如果范围超出所需范围，但在大声范围内，例如 25 为任一范围，则需要在用户按下提交后提示用户。如果他们对提示说是，则提交通过，如果他们说不，则不提交。

感谢 Cooper Maruyama 的帮助，我已经到了尝试在 ASP.Net 世界中实际实现答案的地步。问题是文本框 id 是在运行时确定的，并被传递给 ids 对象中的初始化函数。

当我运行它时，我收到以下错误：*无法获取属性“设置”的值：对象为空或未定义*

这是我的代码：

```
var manageResidentWeightsJs = {

    initialize: function (ids) {

        var cbDeclined = $(ids.cbDeclined);
        var cbIsOutOfFac = $(ids.cbIsOutOfFac);

        $('<div id=errorSummary>The following values fall out side of the normal range:</div>')
                .append('<ul id="errorsList"></ul>').hide().insertAfter(ids.formView);

        var txtHeight = $(ids.txtHeight);
        var txtWeight = $(ids.txtWeight);

        function confirmation() {
            var x;
            var r = confirm("Are you sure?");
            if (r == true) { return true; }
            else { return false; }
        }

        $(ids.formView).validate({
            invalidHandler: function (form, validator) {
                if (confirmation()) { form.submit(); }
            }
        });

        txtHeight.each(function (index, elem) { $(elem).rules("add", { min: 0 }) });
        txtWeight.each(function (index, elem) { $(elem).rules("add", { min: 0 }) });
    }
} 
```

以下代码用于调用上述代码。在此代码中，ASP.Net 已替换为“#”，以消除问题中的 ASP.Net 因素：)

```
$(document).ready(function () {
    var ids = {
      formView: '#mainForm',
      txtHeight: '#heightCtrl',
      txtWeight: '#weightCtrl'
    };

    manageResidentWeightsJs.initialize(ids);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T08:27:39.613

告诉验证器“不想要的”范围是“无效的”。然后使用 invalidHandler 显示一个确认框。如果他们点击确定，则强制表单提交。

工作示例：http: [//jsfiddle.net/FqX6h/14/](http://jsfiddle.net/FqX6h/14/)

您必须根据自己的喜好编辑验证规则。

HTML：

```
 <form id="form" action="">
    <input type="text" name="some_name" value="" id="some_name" minlength="5">
    <input type="submit" value="submit" class="required" size="10" onclick="">
  </form> 
```

js：

```
 function confirmation() {
            var r=confirm("Are you sure?");
            if (r==true) {return true;}
            else {return false;}
        }
        $(function() {
            $("#form").validate({
                rules: {
                    some_name: {
                        required: true
                    }
                },
                invalidHandler: function(form, validator) {
                    if (confirmation()) {form.submit();}
                }
            });
        }); 
```

# c# - 在 TextBox 中保存私有数据？

> ID：12395993
> 
> 赞同：0
> 
> 时间：2012-09-12T20:49:16.140
> 
> 标签：c#, asp.net

这似乎是一个奇怪的问题，也许我没有以正确的方式思考它，但我正在寻求一些帮助。

假设我有一个带有 ID 和名称的对象列表。我们不希望用户看到 ID，它是私有的。我只使用名称属性将此列表绑定到转发器控件，因此页面上有一堆带有名称的文本框。

然后用户更改名称并保存。现在，我们需要 ID 来保存更改，否则我们无法确定哪个名称是原始名称！但是如果绑定时没有保存在我们的文本框中，它就会丢失。将它保存在控件中的安全方法是什么，以便在调用 OnTextChanged 事件时可以使用它？

tl; dr：如何在每个文本框控件中存储一个 ID，以便以后在用户看到该 ID 的情况下访问它？

编辑：我意识到一种可能的解决方案是在更改名称之前在 OnTextChanged 事件上再次找到 ID，但在这种特定情况下，需要在 OnTextChanged 事件之外访问 ID。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T20:53:14.437

使用隐藏字段来存储 id。在浏览器中查看数据时它是不可见的，但如果用户查看 html 标记则它是可见的。但没有办法解决这个问题。这就是网络的本质。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-12T20:50:07.900

您可以将这样的 Id 值放在隐藏字段中。这就是我通常在 listViews 中做的事情等等

# css - 动态浮动内容，让 div 浮动在另一个 div 之上

> ID：12395996
> 
> 赞同：0
> 
> 时间：2012-09-12T20:49:26.297
> 
> 标签：css, html, height

[http://jsfiddle.net/V7BJM/](http://jsfiddle.net/V7BJM/)

框中的文本将根据谁登录而动态变化。当蓝色框像 jsfiddle 中那样有很多内容时，我希望黄色框浮在绿色下方。这是可能的还是我需要使用某种列系统，我知道我可以用它来解决我的问题，但这样做会很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T20:57:58.613

在我看来，最好的选择是将内容分成两列，如下所示：

[http://jsfiddle.net/V7BJM/1/](http://jsfiddle.net/V7BJM/1/)

# serial-port - 串行端口：硬件握手仅在发送方打开，传输仍然有效

> ID：12395997
> 
> 赞同：0
> 
> 时间：2012-09-12T20:49:28.257
> 
> 标签：serial-port, handshake

我正在通过 DB-9 串行端口发送数据，并且我想使用 HW CTS/RTS 握手。奇怪的是，即使我在接收方关闭握手，发送方仍然会发送数据。这对我来说没有意义，因为发送者应该等待 CTS 信号的到来，而接收者显然不应该在握手关闭时发送。

我已经检查过我有一个完整的握手零调制解调器电缆，而不仅仅是一个循环支持的电缆。

这是正常行为还是我的想法有问题？我已经用不同的编程语言尝试过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-12T22:37:54.133

这是有道理的。当您禁用握手时，CTS 引脚的状态将永久告诉远程设备可以传输。