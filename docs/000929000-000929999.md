# StackOverflow 问答 000929000-000929999

# java - 我如何调整这个程序以符合在线法官的要求？

> ID：929001
> 
> 赞同：0
> 
> 时间：2009-05-30T04:32:19.027
> 
> 标签：java

我正在一个名为 programming-challenges.com 的 uva 子站点上解决 UVA 的 Edit Step Ladders，但由于我完全没有得到我应该测试输入的格式，所以我只是取了他们的示例输入，把将其放入一个文本文件并从那里测试我的代码。像这样：

```
import java.io.*;
import java.util.*;

class Levenshtein {
    private static int minimum(int a, int b, int c) {
        if(a<=b && a<=c)
            return a;
        if(b<=a && b<=c)
            return b;
        return c;
    }

public static int computeLevenshteinDistance(String str1, String str2) {
    return computeLevenshteinDistance(str1.toCharArray(),
                                      str2.toCharArray());
}

private static int computeLevenshteinDistance(char [] str1, char [] str2) {
    int [][]distance = new int[str1.length+1][str2.length+1];

    for(int i=0;i<=str1.length;i++)
            distance[i][0]=i;

    for(int j=0;j<=str2.length;j++)
        distance[0][j]=j;

    for(int i=1;i<=str1.length;i++)
        for(int j=1;j<=str2.length;j++)
            distance[i][j]= minimum(distance[i-1][j]+1,
                                    distance[i][j-1]+1,
                                    distance[i-1][j-1]+
                                    ((str1[i-1]==str2[j-1])?0:1));

    return distance[str1.length][str2.length];
}

public static void main(String args[]){

ArrayList<String> theWords = new ArrayList<String>();

try {

        String ruta="entradaLevenshtein.txt";
        File myFile = new File (ruta);
        FileReader fileReader = new FileReader(myFile);

        BufferedReader reader = new BufferedReader(fileReader);

        String line = null;

        while ((line=reader.readLine())!=null){
            System.out.println(line);
            theWords.add(line);
        }

        reader.close();
    }

    catch (IOException ex){
        ex.printStackTrace();

    }
 {}
 // todo esto sólo para iniciar el arreglo
 // ahora vienen las llamadas a Levenstein y las comparaciones

 int maxEdit=0;
 int actualEdit=0;

 int wordsIndex1 =0, wordsIndex2=0;

 while (wordsIndex1<= theWords.size())
 {
  while (wordsIndex2<= theWords.size()-1){
     actualEdit=computeLevenshteinDistance(theWords.get(wordsIndex1),theWords.get(wordsIndex2));
     if (actualEdit>maxEdit){maxEdit=actualEdit;}
     wordsIndex2++;
  }
 wordsIndex1++;

 }

 System.out.println(maxEdit+1);
}

} 
```

我的输入文件是：

```
cat
dig
dog
fig
fin
fine
fog
log
wine 
```

我应该使代码符合以下模式，事情是..我不知道这个东西在哪里捕获它的字符串：

```
import java.io.*;
import java.util.*;

class Modelo implements Runnable{
    static String ReadLn(int maxLength){  // utility function to read from stdin,
                                          // Provided by Programming-challenges, edit for style only
        byte line[] = new byte [maxLength];
        int length = 0;
        int input = -1;
        try{
            while (length < maxLength){//Read untill maxlength
                input = System.in.read();
                if ((input < 0) || (input == '\n')) break; //or untill end of line ninput
                line [length++] += input;
            }

            if ((input < 0) && (length == 0)) return null;  // eof
            return new String(line, 0, length);
        }catch (IOException e){
            return null;
        }
    }

    public static void main(String args[]) // entry point from OS
    {
        Modelo myWork = new Modelo();  // Construct the bootloader
        myWork.run();            // execute
    }

    public void run() {
        new myStuff().run();
    }
}
class myStuff implements Runnable{
    public void run(){
        try
        {

        /// PLACE YOUR JAVA CODE HERE

        }catch(Exception e){
            System.out.println("A Exception was generated");
        }
    }

    // You can insert more classes here if you want.
} 
```

为什么我应该把它放在上面写着 // 把你的代码放在这里而不是放在这里？

```
 try{
                    while (length < maxLength){//Read untill maxlength
                        input = System.in.read();
                        if ((input < 0) || (input == '\n')) break; //or untill end of line input
                        line [length++] += input;

} 
```

如何操作输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T05:00:33.193

我认为这里的想法是在`myStuff`类中编写程序，将在`run()`方法中调用它。从`run()`方法中，您可以使用`Modelo.ReadLn()`来获取您的输入。

# wcf - 如何编写使用 MSMQ 的事务性多线程 WCF 服务

> ID：929009
> 
> 赞同：2
> 
> 时间：2009-05-30T04:37:07.233
> 
> 标签：wcf, msmq

我有一个 WCF 服务，可以将消息发布到一个私有的、非事务性的 MSMQ 队列。我有另一个 WCF 服务（多线程），它处理 MSMQ 消息并将它们插入数据库。

我的问题是测序。我希望消息按特定顺序排列。例如 MSG-A 需要在插入 MSG-B 之前进入数据库。因此，从数据库的角度来看，我目前的解决方案非常粗糙且昂贵。

我正在阅读该消息，如果它的 MSG-B 并且数据库中没有 MSG-A，我将其放回消息队列中，并继续这样做，直到将 MSG-A 插入数据库。但这是一项非常昂贵的操作，因为它涉及表扫描（SELECT stmt）。

消息总是按顺序发布到队列中。

没有使我的 WCF 队列处理服务单线程（通过将服务行为属性 InstanceContextMode 设置为 Single），有人可以提出更好的解决方案吗？

谢谢

担

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T07:41:11.587

与其在将消息从队列中取出后立即将它们推送到数据库，不如在内存中保留一个待处理消息的列表。当您获得 A 或 B 时，请检查匹配的是否在列表中。如果是这样，请将它们（以正确的顺序）提交到数据库，并从列表中删除匹配的一个。否则，只需将新消息添加到该列表即可。

如果检查匹配项的任务太昂贵而无法序列化-我假设您出于某种原因正在使用多线程-您可以让另一个线程处理该列表。现有的多个线程读取，立即将大部分消息提交给 DB，但将 As 和 Bs 放在（线程安全）列表中。后台线程通过该列表查找匹配的 As 和 B，并在找到它们时以正确的顺序提交它们（并将它们从列表中删除）。

底线是 - 由于您使用多个线程从队列中删除项目，因此您将不得不在某个地方进行序列化，以确保排序。诀窍是尽量减少锁定在序列码中的次数和时间长度。

您可能还可以在数据库级别使用触发器或其他方式执行某些操作，以便在检测到这种情况时重新排序条目。恐怕我对数据库编程知之甚少，无法提供帮助。

更新：假设消息包含一些 id，可让您将消息“A”与正确的关联消息“B”相关联，以下代码将确保 A 在 B 之前进入数据库。请注意，它不能确保它们是相邻的数据库中的记录 - A 和 B 之间可能还有其他消息。此外，如果由于某种原因您得到 A 或 B 而没有收到其他类型的匹配消息，则此代码将泄漏内存，因为它挂在不匹配的消息上永远。

（您可以将这两个“锁定”块提取到一个子程序中，但为了清楚 A 和 B，我将其保留为这样。）

```
static private object dictionaryLock = new object();
static private Dictionary<int, MyMessage> receivedA = 
    new Dictionary<int, MyMessage>();
static private Dictionary<int, MyMessage> receivedB = 
    new Dictionary<int, MyMessage>();

public void MessageHandler(MyMessage message)
{
    MyMessage matchingMessage = null;
    if (IsA(message))
    {
        InsertIntoDB(message);
        lock (dictionaryLock)
        {
            if (receivedB.TryGetValue(message.id, out matchingMessage))
            {
                receivedB.Remove(message.id);
            }
            else
            {
                receivedA.Add(message.id, message);
            }
        }
        if (matchingMessage != null)
        {
            InsertIntoDB(matchingMessage);
        }
    }
    else if (IsB(message))
    {
        lock (dictionaryLock)
        {
            if (receivedA.TryGetValue(message.id, out matchingMessage))
            {
                receivedA.Remove(message.id);
            }
            else
            {
                receivedB.Add(message.id, message);
            }
        }
        if (matchingMessage != null)
        {
            InsertIntoDB(message);
        }
    }
    else
    {
        // not A or B, do whatever
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-09T17:45:09.123

如果您是这些队列的唯一客户，您可以很容易地将时间戳添加为消息头（请参阅[IDesign](http://www.idesign.net)示例）并将“发送到”字段（有点像 Outlook 消息）也保存在数据库中。您可以按照发送顺序处理它们（基本上您在使用时移动排序逻辑）。

希望这会有所帮助，阿德里安

# .net - 我可以为 XML 数据源使用哪些报告工具？

> ID：929010
> 
> 赞同：2
> 
> 时间：2009-05-30T04:38:01.333
> 
> 标签：.net, visual-studio, web-applications, reporting

我正在寻找可以与 XML 数据源一起使用的报告工具。XML 文件会很小，大约 50-60K，但可能大到 200K。我们项目的目标是根据 XML 文件中提交的数据生成报告。

我知道我可以简单地使用 XSLT 样式表并输出 HTML，但我更喜欢 PDF、XPS、XLS 或 DOC 输出并且想要更好的格式控制。有什么建议么？

很可能我们不会在机器上安装 SQL Server，因此 SQL Server 报告可能不会成为一种选择。如果我错了，请纠正我。. .

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T04:41:18.460

Sql 服务器报告服务 (sSRS)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T04:47:05.457

BIRT 可以处理 XML 输入，前提是您有一个 ODA 源（您可能需要自己编写它，具体取决于 XML 的复杂性）。

我们已经将 BIRT 与数据库源一起使用了很长一段时间，我们只是将代码变形以处理 XML 输入，作为一种以相对轻松的方式将我们出色的代码附加到其他产品上的方法。

[此页面](http://www.birt-exchange.org/devshare/designing-birt-reports/70-birt-xml-data-source/#description)是我们的起点，非常有帮助。

# rubygems - 寻找 ruby gem 的其他来源

> ID：929013
> 
> 赞同：-1
> 
> 时间：2009-05-30T04:42:04.323
> 
> 标签：rubygems

我一直在从 Windows 上的 ruby​​forge 获取宝石时遇到问题。计算机只是挂起。还有其他我可以使用的来源吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T04:43:47.083

GitHub(www.github.com) 拥有大量的 ruby​​gems。

# iphone - 设置 UILabel 的 x,y 坐标但让它在 iPhone 上自动宽度/高度的最佳方法是什么？

> ID：929014
> 
> 赞同：2
> 
> 时间：2009-05-30T04:42:11.453
> 
> 标签：iphone, cocoa-touch

我确切地知道我想将我的 UILabel 放在 UIView 中的哪个位置，但我不一定知道我希望它在编译时具有什么高度/宽度，因此在 initWithFrame 中设置宽度/高度是没有用的。我希望能够初始化它的 x,y 点，然后使用类似 [myLabel sizeToFit] 的东西，这样它就可以根据我的中断模式和内容自动设置宽度/高度。

我正在寻找的解决方案是如何设置 UILabel 的原点，同时根据设置为标签的文本将其宽度/高度设置为动态数字。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-30T22:41:17.053

首先调整标签大小，然后设置其原点或中心：

```
[myLabel sizeToFit];
CGRect frame = myLabel.frame;
frame.origin = CGPointMake(x, y);
myLabel.frame = frame; 
```

或者

```
[myLabel sizeToFit];
myLabel.center = CGPointMake(x, y); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T08:40:44.553

如果您已经拥有动态大小的框架但想要更改原点：

```
CGRect myFrame = myLabel.frame;
myFrame.origin = aCGPoint;
myLabel.frame = myFrame; 
```

如果需要计算尺寸：

```
CGSize suggestedSize = [myString sizeWithFont:myLabel.font constrainedToSize:CGSizeMake(FLT_MAX, FLT_MAX) lineBreakMode:UILineBreakModeWordWrap]; 
```

当然，您可以更改 FLT_MAX 以限制到特定的宽度或高度。

编辑：我没有意识到你想以编程方式计算大小。在上面添加了更好的解释。

# c++ - msvc9、iostream 和 2g/4g 加文件

> ID：929016
> 
> 赞同：2
> 
> 时间：2009-05-30T04:42:19.627
> 
> 标签：c++, visual-studio-2008, stl

用64位做跨平台开发。使用 gcc/linux 和 msvc9/server 2008。最近刚刚在 Windows 上部署了一个客户，在一些升级测试期间，我发现虽然 std::streamoff 是 8 个字节，但程序在超过 4G 时崩溃。

我立即切换到解决问题的 stlport，但是 stlport 似乎还有其他问题。带有 msvc9 的 STL 真的那么坏，还是我遗漏了什么？

由于代码是跨平台的，我对使用任何 win32 调用都没有兴趣。

### 有关的

*   [iostream 和大文件支持](https://stackoverflow.com/questions/660667/iostream-and-large-file-support)
*   [使用 c++ stl 读取大于 4GB 的文件。](https://stackoverflow.com/questions/293672/reading-files-larger-than-4gb-using-c-stl)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T15:43:39.537

即使您说您对使用“win32”调用的兴趣“零”，但在这种情况下，您会陷入困境和困境。

我只会使用看起来和感觉像 fstream 接口的“win32”调用来实现我自己的文件 iostream 版本。这很容易做到，我已经做过数百次了。

称它为“fstreamwin32”。

然后我会有一个头文件，它会做类似的事情：

```
#ifdef WIN32
typedef fstreamwin32 fsteamnative;
#else
typedef fstream fsteamnative;
#endif 
```

然后我会在任何地方使用 fsteamnative。这样你就可以保持你的代码跨平台并且仍然可以解决你的问题。

如果问题得到解决，您可以通过将 typedef 改回使用 fstream typedef 来轻松删除“win32”解决方法。这就是为什么很多跨平台代码库有很多间接级别（例如，通过使用他们自己的 typedef 来处理标准的东西），所以他们做这样的事情就不得不改变很多代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T20:13:43.307

我在这个主题上找到的另一个链接：

[http://cplusplus.com/forum/general/6813/](http://cplusplus.com/forum/general/6813/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T19:48:31.790

我最终使用了 STLport。与 STLport 最大的不同是，一些在双精度数乘法过程中崩溃的单元测试现在可以工作并且这些单元测试通过了。出现相对精度的其他一些差异，但这些差异似乎很小。

# java - 什么是静态工厂方法？

> ID：929021
> 
> 赞同：294
> 
> 时间：2009-05-30T04:46:16.393
> 
> 标签：java, design-patterns, factory-method

什么是“静态工厂”方法？

* * *

## 回答 #1

> 赞同：501
> 
> 时间：2009-05-30T07:44:33.217

[静态工厂方法模式](https://books.google.com/books?id=ka2VUBqHiWkC&pg=PA5)是一种封装对象创建的方法。如果没有工厂方法，您只需直接调用类的[构造函数](http://en.wikipedia.org/wiki/Constructor_(computer_science))：`Foo x = new Foo()`. 使用这种模式，您将改为调用工厂方法： `Foo x = Foo.create()`。构造函数被标记为私有，因此只能从类内部调用它们，工厂方法被标记为[`static`](http://en.wikipedia.org/wiki/Method_(computer_science)#Static_methods)可以在没有对象的情况下调用它。

这种模式有几个优点。一是工厂可以从许多子类（或接口的实现者）中选择并返回。这样，调用者可以通过参数指定所需的行为，而不必知道或理解潜在的复杂类层次结构。

正如 Matthew 和 James 所指出的，另一个优势是控制对有限资源（例如连接）的访问。这是一种实现[可重用对象池的](http://en.wikipedia.org/wiki/Object_pool)方法——而不是构建、使用和拆除对象，如果构建和销毁是昂贵的过程，那么构建一次并回收它们可能更有意义。`null`工厂方法可以返回一个现有的、未使用的实例化对象，如果它有一个，或者如果对象计数低于某个下限阈值，则构造一个，或者如果它高于上限阈值，则抛出异常或返回。

根据 Wikipedia 上的文章，多个工厂方法还允许对类似参数类型进行不同的解释。通常构造函数与类具有相同的名称，这意味着您只能拥有一个具有给定[签名](http://en.wikipedia.org/wiki/Type_signature)的构造函数。工厂不受限制，这意味着您可以有两种不同的方法来接受相同的参数类型：

```
Coordinate c = Coordinate.createFromCartesian(double x, double y) 
```

和

```
Coordinate c = Coordinate.createFromPolar(double distance, double angle) 
```

正如 Rasmus 所说，这也可以用来提高可读性。

* * *

## 回答 #2

> 赞同：180
> 
> 时间：2012-03-28T19:44:19.477

笔记！“**静态工厂方法**与**工厂****方法**模式不同” (c) Effective Java，Joshua Bloch。

工厂方法：“定义一个用于创建对象的接口，但让实现该接口的类决定实例化哪个类。工厂方法让一个类将实例化推迟到子类”（c）GoF。

“静态工厂方法只是一个返回类实例的静态方法。” (c) 有效的 Java，Joshua Bloch。通常这个方法在一个特定的类中。

区别：

静态工厂方法的关键思想是控制对象的创建并将其从构造函数委托给静态方法。要创建的对象的决定就像在抽象工厂中在方法之外做出的一样（在常见情况下，但并非总是如此）。而工厂方法的关键（！）思想是委托决定在工厂方法中创建什么类的实例。例如，经典的 Singleton 实现是静态工厂方法的一个特例。常用的静态工厂方法示例：

*   的价值
*   获取实例
*   新实例

* * *

## 回答 #3

> 赞同：137
> 
> 时间：2009-05-30T05:04:27.633

我们避免提供对数据库连接的直接访问，因为它们是资源密集型的。`getDbConnection`因此，如果我们低于限制，我们使用静态工厂方法创建连接。否则，它会尝试提供“备用”连接，如果没有则失败并出现异常。

```
public class DbConnection{
   private static final int MAX_CONNS = 100;
   private static int totalConnections = 0;

   private static Set<DbConnection> availableConnections = new HashSet<DbConnection>();

   private DbConnection(){
     // ...
     totalConnections++;
   }

   public static DbConnection getDbConnection(){

     if(totalConnections < MAX_CONNS){
       return new DbConnection();

     }else if(availableConnections.size() > 0){
         DbConnection dbc = availableConnections.iterator().next();
         availableConnections.remove(dbc);
         return dbc;

     }else {
         throw new NoDbConnections();
     }
   }

   public static void returnDbConnection(DbConnection dbc){
     availableConnections.add(dbc);
     //...
   }
} 
```

* * *

## 回答 #4

> 赞同：71
> 
> 时间：2009-05-30T06:43:56.460

静态工厂方法可以提高可读性：

比较

```
public class Foo{
  public Foo(boolean withBar){
    //...
  }
}

//...

// What exactly does this mean?
Foo foo = new Foo(true);
// You have to lookup the documentation to be sure.
// Even if you remember that the boolean has something to do with a Bar
// you might not remember whether it specified withBar or withoutBar. 
```

到

```
public class Foo{
  public static Foo createWithBar(){
    //...
  }

  public static Foo createWithoutBar(){
    //...
  }
}

// ...

// This is much easier to read!
Foo foo = Foo.createWithBar(); 
```

* * *

## 回答 #5

> 赞同：22
> 
> 时间：2009-05-30T04:52:37.977

> *   有名字，不像构造函数，可以澄清代码。
> *   无需在每次调用时创建新对象 - 如有必要，可以缓存和重用对象。
> *   可以返回其返回类型的子类型 - 特别是，可以返回调用者不知道其实现类的对象。这是许多使用接口作为静态工厂方法的返回类型的框架中非常有价值且广泛使用的特性。

来自[http://www.javapractices.com/topic/TopicAction.do?Id=21](http://www.javapractices.com/topic/TopicAction.do?Id=21)

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2009-05-30T05:30:10.910

这一切都归结为可维护性。最好的表达方式是，每当您使用`new`关键字创建对象时，您就是将正在编写的代码耦合到实现。

工厂模式允许您将创建对象的方式与使用对象的方式分开。当您使用构造函数创建所有对象时，您实际上是将使用该对象的代码硬连接到该实现。使用您的对象的代码“依赖于”该对象。从表面上看，这似乎没什么大不了的，但是当对象发生更改时（考虑更改构造函数的签名，或对对象进行子类化），您必须返回并在各处重新连接。

今天，工厂在很大程度上被搁置在使用依赖注入的支持下，因为它们需要大量的样板代码，结果证明自己有点难以维护。依赖注入基本上等同于工厂，但允许您指定对象如何以声明方式连接在一起（通过配置或注释）。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2012-12-05T05:07:31.040

如果一个类的构造函数是私有的，那么你不能从它的外部为类创建一个对象。

```
class Test{
 int x, y;
 private Test(){
  .......
  .......
  }
} 
```

我们不能从外部为上述类创建对象。所以你不能从课堂外访问 x, y。那么这个类有什么用呢？
这是答案：**工厂**方法。
在上面的类中添加以下方法

```
public static Test getObject(){
  return new Test();
} 
```

所以现在你可以从它的外部为这个类创建一个对象。就像路...

```
Test t = Test.getObject(); 
```

因此，通过执行其私有构造函数返回类对象的静态方法称为**FACTORY**方法
。

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2013-09-22T19:46:01.143

我想我会在这篇文章中添加一些关于我所知道的内容。我们在我们的`recent android project`. 代替`creating objects using new operator`你也可以`static method`用来实例化一个类。代码清单：

```
//instantiating a class using constructor
Vinoth vin = new Vinoth(); 

//instantiating the class using static method
Class Vinoth{
  private Vinoth(){
  }
  // factory method to instantiate the class
  public static Vinoth getInstance(){
    if(someCondition)
        return new Vinoth();
  }
} 
```

**静态方法支持条件对象创建**：每次调用构造函数时都会创建一个对象，但您可能不希望这样。假设您只想检查某些条件，然后才想创建一个新对象。除非满足您的条件，否则您不会每次都创建 Vinoth 的新实例。

另一个来自**Effective Java**的例子。

```
public static Boolean valueOf(boolean b) {
        return (b ? TRUE : FALSE);
} 
```

此方法将布尔原始值转换为布尔对象引用。该`Boolean.valueOf(boolean)`方法向我们展示了，它从不创建对象。`static factory methods`从重复中返回相同对象的能力`invocations`允许类在任何时候保持对存在的实例的严格控制。

`Static factory methods`是，与 不同`constructors`，它们可以返回`object`任何`subtype`返回类型中的一个。这种灵活性的一个应用是 API 可以返回对象而无需公开它们的类。以这种方式隐藏实现类会导致 API 非常紧凑。

`BuddhistCalendar`Calendar.getInstance() 是上面的一个很好的例子，它根据语言环境 a`JapaneseImperialCalendar`或默认情况下创建一个`Georgian`。

我能想到的另一个例子是`Singleton pattern`，你让你的构造函数私有创建一个你自己的`getInstance`方法，你可以确保总是只有一个实例可用。

```
public class Singleton{
    //initailzed during class loading
    private static final Singleton INSTANCE = new Singleton();

    //to prevent creating another instance of Singleton
    private Singleton(){}

    public static Singleton getSingleton(){
        return INSTANCE;
    }
} 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-05-30T04:51:12.067

工厂方法是一种抽象出对象实例化的方法。通常，当您知道需要实现某个接口但不知道实现类的类的新实例时，工厂很有用。

这在处理相关类的层次结构时很有用，一个很好的例子就是 GUI 工具包。您可以简单地对构造函数的调用进行硬编码，以实现每个小部件的具体实现，但是如果您想将一个工具包换成另一个工具包，那么您将有很多地方需要更改。通过使用工厂，您可以减少需要更改的代码量。

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2015-10-04T17:33:04.420

源自静态工厂的优点之一是 API 可以返回对象而无需公开其类。这导致非常紧凑的 API。在 java 中，这是通过 Collections 类实现的，该类隐藏了大约 32 个类，这使得它的集合 API 非常紧凑。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-03-02T14:00:16.070

具有私有构造函数的静态工厂方法的优点之一（必须限制外部类的对象创建以确保不会在外部创建实例）是您可以创建*实例控制的*类。并且实例控制的类保证在程序运行期间不存在两个相等的不同实例（**a.equals(b) 当且仅当 a==b**），这意味着您可以使用**==**运算符而不是**equals**方法检查对象的相等性，根据有效的java。

> 静态工厂方法从重复调用返回相同对象的能力允许类在任何时候保持对存在的实例的严格控制。执行此操作的类被称为实例控制的。编写实例控制类有几个原因。实例控制允许一个类保证它是单例（第 3 项）或不可实例化（第 4 项）。此外，它允许不可变类（第 15 条）保证不存在两个相等的实例：a.equals(b) 当且仅当 a==b 时。如果一个类做出了这种保证，那么它的客户端可以使用 == 运算符而不是 equals(Object) 方法，这可能会提高性能。枚举类型（第 30 项）提供了这种保证。

来自 Effective Java，Joshua Bloch（第 1 项，第 6 页）

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-05-30T06:15:33.567

当您想确保只有一个实例将返回要使用的具体类时，静态工厂方法是很好的选择。

例如，在一个数据库连接类中，您可能希望只有一个类创建数据库连接，这样如果您决定从 Mysql 切换到 Oracle，您只需更改一个类中的逻辑，应用程序的其余部分将使用新连接。

如果你想实现数据库池，那么也可以在不影响应用程序的其余部分的情况下完成。

它保护应用程序的其余部分免受您可能对工厂进行的更改，这就是目的。

它是静态的原因是如果你想跟踪一些有限的资源（套接字连接或文件句柄的数量），那么这个类可以跟踪有多少已经被传递和返回，所以你不会用尽资源有限。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-11-19T05:52:35.463

Java 实现包含实用程序类**java.util.Arrays**和**java.util.Collections**它们都包含**静态工厂方法**、它的示例以及如何使用：

*   `Arrays.asList("1","2","3")`

*   `Collections.synchronizedList(..), Collections.emptyList(), Collections.unmodifiableList(...)` （只有一些示例，可以检查 javadocs 以获取 mor 方法示例[https://docs.oracle.com/javase/8/docs/api/java/util/Collections.html](https://docs.oracle.com/javase/8/docs/api/java/util/Collections.html)）

**java.lang.String**类也有这样的静态**工厂方法**：

*   `String.format(...), String.valueOf(..), String.copyValueOf(...)`

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-09-23T00:00:06.507

> 静止的

使用关键字“static”声明的成员。

> 工厂方法

创建和返回新对象的方法。

> 在爪哇

编程语言与“静态”的含义有关，但与“工厂”的定义无关。

# php - PHP 上传问题

> ID：929023
> 
> 赞同：2
> 
> 时间：2009-05-30T04:48:51.523
> 
> 标签：php, file, upload, uploading

我已经使用了一些脚本来开始在我的开发机器上上传文件。问题是，尽管预期此操作很容易，但每当我尝试上传图像时，Apache 似乎都会超时。上传设置为`On`，`tmp`目录设置为`php.ini`.

我尝试`gif`从谷歌上传主要`8.36KB`图片。它应该很好，并且在 PHP 上传功能的限制范围内。

这是脚本的副本。应该有一个简单的解决方法。根据要求，我将波浪号更改为实际目录。

```
<?php 

if (!isset($_GET['upload'])) { ?>
  <form method="post" action="index.php?upload=true" enctype="multipart/form-data"> 
  <input type="file" name="file" class="form">
  <input name="submit" type="submit">
  </form>
<? } else  if (isset($_GET['upload']) && $_GET['upload'] == 'true') {
  $url = $_FILES['file']['name'];
    $move = move_uploaded_file($_FILES['file']['tmp_name'], "/Users/<username>/Sites/file.jpg");
    if ($move) {
        echo "Success!";
    } else { 
        echo "Err..."
    } 
} ?> 
```

谢谢，丹

编辑：

在一些答案的帮助下，我修复了它，我将标记其中一个。

这里有几件事导致了这种行为。

1.  该目录的权限`images`未设置为允许`_www`用户访问它。A`chmod -R 777 images`似乎修复了它，以及`sudo chown _www images`.

2.  表单输出可能已经破坏了 PHP 脚本本身。正如建议的那样`ECHO <<< ...END`，我认为有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T04:59:27.970

是什么让您相信 Apache 正在超时，而不是说，以某种方式彻底失败？因为让我大吃一惊的是您正试图将文件移动到`~/file.jpg`，我几乎可以肯定这不会起作用；`~`是一个通常只在 shell 中有意义的构造，除非 PHP 的一个怪异晦涩的特性是在这样的上下文中处理它。无论如何，尝试放置实际目录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T04:58:44.770

如果问题是文件大小，请将以下行添加到您的 php.ini 文件中，它应该可以工作：

```
upload_max_filesize = 500M ;
post_max_size = 500M ; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T05:55:12.720

默认情况下，PHP 在页面上有 30 秒的超时。因此，如果您的上传时间超过 30 秒，它将失败。在您的 php.ini 中设置超时或将以下代码放在文件顶部。

```
ini_set(max_execution_time, 90); 
```

第二个参数表示页面超时之前的时间（以秒为单位）。将其设置为您认为合适的任何时间。此外，混乱是正确的，因为“~”是一个通常只在壳内有意义的结构。

回复：[http ://ca2.php.net/manual/en/ini.list.php](http://ca2.php.net/manual/en/ini.list.php)

编辑：问题是您在条件中间重新打开了标签。尝试您的代码时出现语法错误。奇怪的是，您能够看到任何 Web 表单。这是固定代码（对我有用）。

```
<?php 
if (!isset($_GET['upload'])) { 
ECHO <<<END
  <form method="post" action="index.php?upload=true" enctype="multipart/form-data"> 
  <input type="file" name="file" class="form">
  <input name="submit" type="submit">
  </form>
END;
 } else  if (isset($_GET['upload']) && $_GET['upload'] == 'true') {
    $url = $_FILES['file']['name'];
    $move = move_uploaded_file($_FILES['file']['tmp_name'], "/Users/<username>/Sites/file.jpg");
    if ($move) {
        echo "Success!";
    } else { 
        echo "Err...";
    } 
} ?> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T05:55:46.680

这很可能是文件大小问题和/或 Apache 用户与指定目录之间的权限问题。例如，确保 Apache 实例未在用户 (nobody) 下运行。

对混乱的评论：他是对的，波浪号 (~) 可能会导致问题，但可能不会导致超时；它会显示警告。即使它确实可以在您的系统上运行，它也可能会将文件存放到意外的目录中，或者如果 Apache 用户（即 www）没有设置有效的主目录，则可能会遇到一些问题。

# python - 如何在不知道子类名称的情况下访问 django 中对象的子类？

> ID：929029
> 
> 赞同：84
> 
> 时间：2009-05-30T04:52:56.243
> 
> 标签：python, django, many-to-many

在 Django 中，当您有一个父类和多个从它继承的子类时，您通常会通过 parentclass.childclass1_set 或 parentclass.childclass2_set 访问一个子类，但是如果我不知道我想要的特定子类的名称怎么办？

有没有办法在不知道子类名的情况下获取父->子方向的相关对象？

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-05-30T15:47:56.853

（**更新**：对于 Django 1.2 和更新版本，它可以在反向 OneToOneField 关系中跟踪 select_related 查询（因此向下继承层次结构），有一种更好的技术可用，它不需要`real_type`在父模型上添加字段。它可以作为[InheritanceManager](https://django-model-utils.readthedocs.org/en/latest/managers.html#inheritancemanager)在[django-model-utils](https://github.com/carljm/django-model-utils/)项目。）

执行此操作的常用方法是在 Parent 模型上向 ContentType 添加一个 ForeignKey，该模型存储正确的“叶”类的内容类型。如果没有这个，您可能必须对子表执行大量查询才能找到实例，具体取决于您的继承树有多大。以下是我在一个项目中的做法：

```
from django.contrib.contenttypes.models import ContentType
from django.db import models

class InheritanceCastModel(models.Model):
    """
    An abstract base class that provides a ``real_type`` FK to ContentType.

    For use in trees of inherited models, to be able to downcast
    parent instances to their child types.

    """
    real_type = models.ForeignKey(ContentType, editable=False)

    def save(self, *args, **kwargs):
        if self._state.adding:
            self.real_type = self._get_real_type()
        super(InheritanceCastModel, self).save(*args, **kwargs)

    def _get_real_type(self):
        return ContentType.objects.get_for_model(type(self))

    def cast(self):
        return self.real_type.get_object_for_this_type(pk=self.pk)

    class Meta:
        abstract = True 
```

这被实现为抽象基类以使其可重用；您还可以将这些方法和 FK 直接放在特定继承层次结构中的父类中。

如果您无法修改父模型，此解决方案将不起作用。在这种情况下，您几乎无法手动检查所有子类。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-05-30T06:02:24.390

在 Python 中，给定一个（“新式”）类 X，您可以使用 获取它的（直接）子类`X.__subclasses__()`，它返回一个类对象列表。（如果您想要“进一步的后代”，您还必须调用`__subclasses__`每个直接子类等 - 如果您需要有关如何在 Python 中有效地做到这一点的帮助，请问！）。

一旦您以某种方式确定了一个感兴趣的子类（可能是所有子类，如果您想要所有子子类的实例等），`getattr(parentclass,'%s_set' % childclass.__name__)`应该会有所帮助（如果子类的名称是`'foo'`，这就像访问`parentclass.foo_set`- 不多也不少）。同样，如果您需要澄清或示例，请询问！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-30T22:01:08.493

Carl 的解决方案是一个很好的解决方案，如果有多个相关的子类，这是一种手动执行的方法：

```
def get_children(self):
    rel_objs = self._meta.get_all_related_objects()
    return [getattr(self, x.get_accessor_name()) for x in rel_objs if x.model != type(self)] 
```

它使用 _meta 中的一个函数，不能保证随着 django 的发展而稳定，但它可以解决问题，并且可以在需要时即时使用。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-09T22:20:31.053

事实证明，我真正需要的是：

[具有内容类型和继承感知管理器的模型继承](http://www.djangosnippets.org/snippets/1034/)

这对我来说非常有效。不过，感谢其他所有人。看了你的回答我学到了很多！

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-05-20T21:43:09.387

您可以为此使用[django-polymorphic](https://github.com/django-polymorphic/django-polymorphic)。

它允许自动将派生类转换回它们的实际类型。它还提供 Django 管理支持、更高效的 SQL 查询处理以及代理模型、内联和表单集支持。

基本原则似乎被重新发明了很多次（包括 Wagtail 的`.specific`，或本文中概述的示例）。然而，它需要更多的努力，以确保它不会导致 N 查询问题，或者与管理员、表单集/内联或第三方应用程序很好地集成。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-26T18:32:38.090

这是我的解决方案，它再次使用`_meta`，因此不能保证稳定。

```
class Animal(models.model):
    name = models.CharField()
    number_legs = models.IntegerField()
    ...

    def get_child_animal(self):
        child_animal = None
        for r in self._meta.get_all_related_objects():
            if r.field.name == 'animal_ptr':
                child_animal = getattr(self, r.get_accessor_name())
        if not child_animal:
            raise Exception("No subclass, you shouldn't create Animals directly")
        return child_animal

class Dog(Animal):
    ...

for a in Animal.objects.all():
    a.get_child_animal() # returns the dog (or whatever) instance 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-30T05:23:19.157

您可以通过查找作为 django.db.models.fields.related.RelatedManager 实例的父级中的所有字段来实现此目的。从您的示例看来，您所谈论的子类似乎不是子类。对？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-09-14T13:47:42.857

可以在[此博客文章](http://anthony-tresontani.github.com/Python/2012/09/11/django-polymorphism/)中找到使用代理的替代方法。与其他解决方案一样，它也有其优点和缺点，这些都很好地放在了文章的末尾。

# jsp - 是否可以在 jsp scriptlet 中访问 struts2 变量？

> ID：929036
> 
> 赞同：1
> 
> 时间：2009-05-30T04:59:51.650
> 
> 标签：jsp, struts2

是否可以在 jsp scriptlet 中访问 struts2 变量？

如果我有 struts2 变量，例如

```
<s:set var="test" value="%{'true'}"/> 
```

我可以在 JSP scriptlet 中使用变量“test”吗？

如是。这怎么可能？

任何人都可以提供一些想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-03-11T07:00:38.200

您甚至可以使用请求对象来获取操作变量。例如，如果您`String userName`在操作中有一个变量，您可以使用

```
<%
String userName = (String) request.getAttribute("userName");
%> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-27T01:55:11.893

是的，

```
<s:set var="jspVariable" value="%{strutsVariable}"/>
<jsp:useBean id="jspVariable" type="com.example.Object" />
<%=jspVariable%> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T05:41:42.870

```
<jsp:useBean id="test" class="java.lang.String" scope="request"/>

<%
         test = "false";
%>

1\. outside scriptlet: <c:out value="${test}"/>   <!-- will not print anything -->

<%
    out.println("2\. in scriptlet: " + test);     // will print false
%>

<c:set var="test" value="true" />

3\. outside scriptlet: <c:out value="${test}"/>   <!-- will print true -->

<%
    out.println("4\. in scriptlet: " + test);     // will print false
%> 
```

# subsonic - 下载 SubSonic 入门套件

> ID：929043
> 
> 赞同：0
> 
> 时间：2009-05-30T05:01:57.637
> 
> 标签：subsonic, starter-kits

这对你来说很简单……也许吧。SubSonicProject 网站上讨论的 SubSonic Starter Kit 是 MIA。所有指向 DL 的链接都指向现已失效的 CodePlex 项目。Google 项目网站上似乎没有这样的 DL。10 美元给第一个知道我在哪里可以得到这些钻头的人。好吧，也许不是 10 美元，但我会投票给你。

小号

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T09:03:40.920

大声笑 入门站点非常古老 :) 但是当您下载 SubSonic 时它在安装程序中。只是在那里有一个峰值，它应该是文件集的一部分。

我也有一个不错的 MVC 网站，如果您可以再冷静一周左右，那就太好了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T08:31:56.460

[http://code.google.com/p/subsoniccms/downloads/list](http://code.google.com/p/subsoniccms/downloads/list)

# mapping - 在地形模型上构建缓冲区

> ID：929046
> 
> 赞同：0
> 
> 时间：2009-05-30T05:05:20.393
> 
> 标签：mapping, gis

我有一个多边形和一个地形模型（可以是网格或 TIN）。我想建造一个 1 公里的缓冲区，以便在地形表面上测量 1 公里，即不是平面的。缓冲区必须始终距离多边形至少 1 公里，并且比地形最平坦的部分更喜欢测量。

任何人都知道这样做的好方法，它对于您在真实地形中获得的所有边缘情况都是稳健的？

首选使用 FOSS 工具的算法或解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-12-02T17:31:19.810

使用 Grass Gis 可以查看此链接

[http://grass.ibiblio.org/gdp/html_grass62/r.buffer.html](http://grass.ibiblio.org/gdp/html_grass62/r.buffer.html)

或使用 pgraster

[http://trac.osgeo.org/postgis/wiki/WKTRasterTutorial01](http://trac.osgeo.org/postgis/wiki/WKTRasterTutorial01)

[http://cartosig.upv.es/es/system/files/jomarlla/PGRASTER_20070710-0001.pdf](http://cartosig.upv.es/es/system/files/jomarlla/PGRASTER_20070710-0001.pdf)

祝你好运

# asp.net - 在 ASP.NET 中清除 FileUpload 内容

> ID：929048
> 
> 赞同：16
> 
> 时间：2009-05-30T05:06:08.723
> 
> 标签：asp.net

如何清除 ASP.NET 中 FileUpload 控件中的文本框内容？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-30T05:58:31.870

ASP.NET`FileUpload`控件映射到`input`带有`type="file"`. 此元素被认为是只读的，您不能直接更改它。

但是，似乎至少有三种解决方法可以实现“清除领域”的目标：

一种。使用脚本或提供`input type="reset"`按钮重置表单。

湾。通过再次设置其属性在 DOM 中重新建立输入字段：

```
var fu = document.getElementById("fileUpload");
if (fu != null)
{
  fu.setAttribute("type", "input");
  fu.setAttribute("type", "file");
} 
```

C。`innerHTML`从现有的字段重新创建字段，`innerHTML`如下[所示](http://gusiev.com/2009/04/clear-upload-file-input-field/)：

```
var fu = document.getElementById("fileUpload");
if (fu != null)
{
  // You may be able to use the cached object in `fu`, but I'm not sure.
  document.getElementById("fileUpload").innerHTML = fu.innerHTML;
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-02-03T07:02:57.903

嗨，不错的技巧，但对我来说，跟随工作而不是 innerhtml

```
 var fu = document.getElementById("flUpload");
            if (fu != null) {
                document.getElementById("flUpload").outerHTML = fu.outerHTML;
            } 
```

问候， 哈里什

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-29T15:27:59.483

我刚刚在后面代码中的按钮单击事件中使用了以下内容...

```
protected void btnReset_Click(object sender, EventArgs e)
{
    flUpload = new FileUpload();
} 
```

按钮单击引起的回发允许页面刷新并创建 FileUpload 控件的新实例。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-19T01:14:26.067

这些适用于 FF、Chrome、IE7/8/9

```
//Method 1

var fu = $('#docUpload')[0];  
fu.value="";

var fu2= fu.cloneNode(false);
fu2.onchange= fu.onchange;
fu.parentNode.replaceChild(fu2,fu); 
```

或：//方法二：

```
document.getElementById('docUpload').outerHTML =     
    document.getElementById('docUpload').outerHTML; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-09-01T08:08:42.127

最近我需要同样的东西，但建议的解决方法都不适合我（在多个浏览器中）。我所做的测试是在 IE8 和 Mozilla 6.0 上完成的。在 IE 中有效的东西在 Mozilla 中无效，反之亦然。

在 IE 中：

```
var fu = document.getElementById("<%= fileUploadImage.ClientID %>");
if (fu != null) {    
    fu.setAttribute("type", "input");
    fu.setAttribute("type", "file");
} 
```

在 Mozilla 中：

```
var fu = document.getElementById("<%= fileUploadImage.ClientID %>");
if (fu != null) {        
    fu.outerHTML = fu.outerHTML;
} 
```

我尝试了所有可能的变体 - 总是调用**getElementById**，只调用它第一次，调用它两次......我也尝试了**innerHTML**，但从来没有一个解决方案适用于两种浏览器。这就是为什么我想出了类似的东西：

```
function clearFileUpload() {
    var fu = document.getElementById("<%= fileUploadImage.ClientID %>");
    if (fu != null) {
        try {
            fu.setAttribute("type", "input");
            fu.setAttribute("type", "file");
        }
        catch (ex) {
            fu.outerHTML = fu.outerHTML;
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-11-18T18:26:07.197

一种适用于 Internet Explorer 和 Firefox 的简单方法 - 在 c# 代码后面：

```
File1Upload.ID = null; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-22T20:15:26.537

```
Sub ClearAll()

    txtExample.Text=""
    txtInfo.Text=""

    fuPics.Dispose
    fuDocs.Dispose

End Sub 
```

当从按钮（例如`btnClear`. 上面的代码适用于 asp.net 可视化网页。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-05-30T12:03:19.223

您可以清除 FileUpload 控件，并将响应重定向回页面本身，并且可以将文件存储在会话变量中，以便在下一次往返时使用。

```
protected void PageLoad(EventArgs e){

   if(FileUpLoadControlId.HasFile)
    {
        Session["data"]=FileUpLoadControlId.PostedFile.InputStream;

        Response.Redirect(HttpContext.Current.Request.Url.AbsoluteUri, true);
     }

    else if( Session["data"]!=null)
    {

         //massage data here 

         //and post back
         Session["data"]=null;
         Response.Redirect(HttpContext.Current.Request.Url.AbsoluteUri, true);

    }

 } 
```

响应重定向重新初始化视图状态

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-03-02T19:24:08.703

刚刚怎么样

If (File1Upload.HasFile) Then File1Upload = Nothing

# .net - 在哪里可以获得新的 .NET 徽标的高分辨率透明版本？

> ID：929052
> 
> 赞同：1
> 
> 时间：2009-05-30T05:09:28.360
> 
> 标签：.net, graphical-logo

一段时间以来，我们一直在使用[FCG](http://www.xheo.com/support/kb/1018/assembly+versioning.aspx)将产品和工具标记为与 .NET 兼容。Microsoft 已更新外观，但我似乎找不到任何高分辨率版本的徽标。

我会对高分辨率 PNG、PhotoShop 或 Illustrator 文件感到满意。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T05:16:55.810

这里有几个不同的版本：

[http://www.microsoft.com/presspass/images/gallery/logos/ms_net_rgb_print.tif](http://www.microsoft.com/presspass/images/gallery/logos/ms_net_rgb_print.tif)

[http://www.microsoft.com/presspass/images/gallery/logos/net_v_print.tif](http://www.microsoft.com/presspass/images/gallery/logos/net_v_print.tif)

可以在此处找到更多徽标：http: [//www.microsoft.com/presspass/gallery/ms-logos.mspx? finish=yes](http://www.microsoft.com/presspass/gallery/ms-logos.mspx?finish=yes)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T15:11:03.497

请检查以下链接以下载带有源文件的高分辨率新 Microsoft 徽标

[http://designerslogic.com/freebies/download-high-resolution-new-microsoft-logo-source-files-included/](http://designerslogic.com/freebies/download-high-resolution-new-microsoft-logo-source-files-included/)

# database - 在 mySQL 中优化嵌入式 SELECT 查询

> ID：929055
> 
> 赞同：5
> 
> 时间：2009-05-30T05:13:33.817
> 
> 标签：database, optimization, mysql

好的，这是我现在在一个有 45,000 条记录且大小为 65MB 的表上运行的查询......并且即将变得越来越大（所以我必须在这里考虑未来的性能）：

```
SELECT count(payment_id) as signup_count, sum(amount) as signup_amount
FROM payments p
WHERE tm_completed BETWEEN '2009-05-01' AND '2009-05-30'
AND completed > 0
AND tm_completed IS NOT NULL
AND member_id NOT IN (SELECT p2.member_id FROM payments p2 WHERE p2.completed=1 AND p2.tm_completed < '2009-05-01' AND p2.tm_completed IS NOT NULL GROUP BY p2.member_id) 
```

正如您可能想象的或可能想象的那样 - 它使 mysql 服务器陷入停顿......

它的作用是——它只是提取注册的新用户的数量，至少有一笔“已完成”的付款，tm_completed 不为空（因为它只为已完成的付款填充），以及（嵌入的 Select）该成员有以前从未“完成”付款 - 这意味着他是新成员（只是因为系统会重新计费等等，这是区分刚刚重新计费的现有成员和被计费的新成员的唯一方法第一次）。

现在，是否有任何可能的方法来优化此查询以使用更少的资源或其他东西，并停止让我的 mysql 资源跪下......？

我是否缺少任何信息来进一步澄清这一点？让我知道...

编辑：

以下是该表上已有的索引：

PRIMARY PRIMARY 46757 payment_id

member_id 索引 23378 member_id

payer_id 索引 11689 payer_id

coupon_id 索引 1 coupon_id

tm_added 索引 46757 tm_added, product_id

tm_completed 索引 46757 tm_completed, product_id

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T05:22:26.973

这些类型的`IN`子查询在 MySQL 中有点慢。我会这样改写：

```
SELECT COUNT(1) AS signup_count, SUM(amount) AS signup_amount
FROM   payments p
WHERE  tm_completed BETWEEN '2009-05-01' AND '2009-05-30'
AND    completed > 0
AND    NOT EXISTS (
           SELECT member_id
           FROM   payments
           WHERE  member_id = p.member_id
           AND    completed = 1
           AND    tm_completed < '2009-05-01'); 
```

检查“ `tm_completed IS NOT NULL`”不是必需的，因为您的`BETWEEN`条件暗示了这一点。

还要确保你有一个索引：

```
(tm_completed, completed) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-30T06:19:30.347

我很高兴将这个不需要子查询的解决方案放在一起：

```
SELECT count(p1.payment_id) as signup_count, 
       sum(p1.amount)       as signup_amount  

  FROM payments p1
       LEFT JOIN payments p2 
       ON p1.member_id = p2.member_id
   AND p2.completed = 1
   AND p2.tm_completed < date '2009-05-01'

 WHERE p1.completed > 0
   AND p1.tm_completed between date '2009-05-01' and date '2009-05-30'
   AND p2.member_id IS NULL; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T05:22:57.563

避免在子查询中使用 IN；MySQL 没有很好地优化这些（尽管在 5.4 和 6.0 中有关于此的待定优化（请参阅[此处](http://dev.mysql.com/tech-resources/articles/mysql-54.html)）。将其重写为连接可能会提高性能：

```
SELECT count(payment_id) as signup_count, sum(amount) as signup_amount
FROM payments p
LEFT JOIN (SELECT p2.member_id
          FROM payments p2
          WHERE p2.completed=1
          AND p2.tm_completed < '2009-05-01'
          AND p2.tm_completed IS NOT NULL
          GROUP BY p2.member_id) foo
ON p.member_id = foo.member_id AND foo.member_id IS NULL
WHERE tm_completed BETWEEN '2009-05-01' AND '2009-05-30'
AND completed > 0
AND tm_completed IS NOT NULL 
```

其次，我必须查看您的表模式；你在使用索引吗？

# sql - SQL：选择表上的最高条件和

> ID：929060
> 
> 赞同：1
> 
> 时间：2009-05-30T05:15:11.850
> 
> 标签：sql, mysql

我有一个带有 、 和数量字段的 OrdersProducts`order_id`表`product_id`。我想知道最受欢迎的产品，那么如何分别对每个 product_id 的数量字段求和然后订购总和？任何指针将不胜感激。我正在使用 MySQL 5.3，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T05:22:31.683

不是 100% 确定 MySQL 会喜欢这个 - 但它的标准 SQL

```
SELECT product_id, sum(quantity)
FROM OrdersProducts 
GROUP BY product_id
ORDER BY sum(quantity) DESC 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T05:24:53.960

试试这个。

```
select product_id, sum(quantity) As ProductQtySum
from OrdersProducts 
group by product_id 
order by ProductQtySum Desc 
```

# c# - 通过 ODBC 访问 MySQL 数据库时出现问题

> ID：929062
> 
> 赞同：0
> 
> 时间：2009-05-30T05:16:34.407
> 
> 标签：c#, asp.net, mysql, database, odbc

```
OdbcDataReader q = dbc.Query("SELECT * FROM `posts` WHERE `id`=" + id.ToString());
if (q.RecordsAffected < 1)
{
    this.Exists = false;
}
else
{
    this.Exists = true;
    this.Author = q.GetString(6);
} 
```

服务器返回`No data exists for the row/column.`

我的数据库表的结构是这样的（来自 phpMyAdmin 的屏幕截图） [http://1.img.anyhub.net/1243660397_6485910f8b3fc9ee3e2d93831ad554fd.png](http://1.img.anyhub.net/1243660397_6485910f8b3fc9ee3e2d93831ad554fd.png)

顺便说一句，`dbc`只是我的一个数据库连接类；`Query()`功能是这样的：

```
public OdbcDataReader Query(string QueryStr)
{
    OdbcCommand q = new OdbcCommand(QueryStr, conn);
    OdbcDataReader r = q.ExecuteReader();
    return r;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T05:34:58.220

我认为您应该先使用 DataReader.Read 方法，然后才能从中获取数据。

```
q.Read(); 
this.Author = q.GetString(6); 
```

我建议对 DataReader 和 Command 对象使用 using 块

# ide - 如何在 VB6 中声明 MAX_DOUBLE？

> ID：929069
> 
> 赞同：4
> 
> 时间：2009-05-30T05:21:58.347
> 
> 标签：ide, vb6, constants, max, minimum

根据 VB6 的 MSDN 帮助

> 浮点值可以表示为 mmmEeee 或 mmmDeee，其中 mmm 是尾数，eee 是指数（10 的幂）。Single 数据类型的最大正值为 3.402823E+38，即 3.4 乘以 10 的 38 次方；Double 数据类型的最大正值为 1.79769313486232D+308，即 1.8 乘以 10 的 308 次方。使用 D 分隔数字文字中的尾数和指数会导致该值被视为 Double 数据类型。同样，以相同方式使用 E 会将值视为 Single 数据类型。

现在在 VB6 IDE 中我尝试输入这个

```
const MAX_DOUBLE as Double = 1.79769313486232D+308 
```

但是，一旦我离开那条线，IDE 就会抛出错误 6（溢出）

> 当您尝试进行超出分配目标限制的分配时，会导致溢出。...

那么如何定义 MAX_DOUBLE （以及 MIN_DOUBLE ）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-01T03:46:52.760

**编辑：解决了！**

```
Const test As Double = 1.79769313486231E+308 + 5.88768018655736E+293 
```

仔细检查到二进制级别，应该尽可能高。您可以继续添加 1 等值，但它会产生一个等于而不是大于的数字。输出是这样的： 01111111|11101111|11111111|11111111|11111111|11111111|11111111|11111111 这确实是 DoubleMax

旧：您可以只使用[Positive infinity](https://stackoverflow.com/questions/885994/how-do-you-get-vb6-to-initialize-doubles-with-infinity-infinity-and-nan)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T19:49:03.237

它必须是一个常量吗？您可以通过使用 Byte 数组中的 CopyMemory 设置正确的位模式，将 MAX_DOUBLE 的确切值放入变量中。

```
Private Declare Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" (Destination As Any, Source As Any, ByVal Length As Long)

Dim Max As Double
Dim Idx As Long
Dim Bits(0 To 7) As Byte

For Idx = 0 To 5
   Bits(Idx) = 255
Next
Bits(6) = 239 ' = 11101111
Bits(7) = 127

For Idx = 0 To 7
   CopyMemory ByVal VarPtr(Max) + Idx, Bits(Idx), 1
Next

Debug.Print Max 
```

编辑：我忘了你也问过 MIN_DOUBLE，这更容易。

```
Dim Min As Double
Dim Bits As Byte

Bits = 1
CopyMemory ByVal VarPtr(Min), Bits, 1

Debug.Print Min 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T06:56:43.967

明显实用的解决方法：稍微减少数量。

```
Const MAX_DOUBLE As Double = 1.79769313486231E+308 
```

我想这在大多数情况下就足够了。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-30T05:30:06.417

使用“E”作为数字中的指数，而不是像下面这样的“D”。

```
Public Const MAX_DOUBLE = 1.79769313486232E+308 
```

[编辑]

看看下面的这个链接，滚动到底部。这个具体的代码示例展示了如何使用这个结构。希望这会有所帮助。

[http://www.experts-exchange.com/Programming/Languages/.NET/Visual_Basic.NET/Q_22555684.html](http://www.experts-exchange.com/Programming/Languages/.NET/Visual_Basic.NET/Q_22555684.html)

# unicode - Unicode小写字符？

> ID：929079
> 
> 赞同：6
> 
> 时间：2009-05-30T05:29:27.243
> 
> 标签：unicode, uppercase, lowercase

我在某个地方读到，在 Unicode 中，除了 AZ 之外，还有**其他**具有小写等效字符的字符。这些可能是哪一个，为什么任何其他字符都需要大写和小写？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-30T07:26:12.503

英语，甚至那个奇怪的变体，美式英语:-)，并不是地球上唯一的语言。有一些看起来*很*奇怪的字符（至少对于那些熟悉拉丁字符的人来说），但即使是拉丁字符也有细微的变化。

我非常熟悉的其中两个是希腊语和德语：

```
Αα Ββ Γγ Δδ Εε Ζζ  Ηη Θθ Ιι Κκ Λλ Μμ
Νν Ξξ Οο Ππ Ρρ Σσς Ττ Υυ Φφ Χχ Ψψ Ωω

Aa Ää Bb Cc Dd Ee Ff Gg Hh Ii Jj Kk Ll Mm Nn
Oo Öö Pp Qq Rr Ss ß  Tt Uu Üü Vv Ww Xx Yy Zz 
```

这就是为什么我们不允许使用以下代码：

```
char lower = upper - 'A' + 'a'; 
```

不再。在一家认真对待 i18n 的公司里做这样的事情几乎是被解雇的理由。使用 Unicode-aware`toLower()/toUpper()`类型的函数是更好的方法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T05:37:39.713

除了我们大多数人习惯在这里看到的通常源自拉丁语的西欧字母之外，还有很多字母。首先，您需要重音字母和连字的大写和小写版本，例如 Àà、Ĳĳ 等。在用亚洲语言设置文档时，还使用了全角版本的拉丁字符（我懒得查）。此外，现在还使用其他字母，例如西里尔字母 (Бб) 和希腊字母 (Δδ)。

还有土耳其，根据杰夫阿特伍德[的说法，这有点困难。](http://www.codinghorror.com/blog/archives/001075.html)使用环境提供的大写/小写函数（通常）是处理用户输入数据的方式。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-10T19:34:59.593

德语中不需要大写的 ß，因为该字母从不用作名称或单词的第一个字母。其余的，在某些语言（法语？）中不使用大写重音字符，只使用非重音变体。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-01-24T14:53:10.960

> > 在某些语言中（法语？）不使用大写重音字符（...）
> > [Reiner Bakels - 2012 年 12 月 10 日 19:34]

嗯，是的……但不是！

在手动“字体”页面制作的好时代，这曾经是真的。由于强调的大写字母（例如“É”）在一行上会上升得太高，通常的做法是忽略它而只显示“E”。然后“des études”通常表现为“DES ETUDES”（没有重音）。

But that is not recommended anymore. Whenever one can edit/type/publish the accentuated capital letters, we are invited to do so. The very official Quebec's "Office de la langue française" is actually promoting this since more than two decades!

That is becoming specially crucial in our era of computers and the Web, where texts are more and more processed (read & translated) by machines. Omitting accents can entirely change the meaning. tache (stain) -vs- tâche (task), du (of) -vs- dû (something you have to pay), and many many more words. Continuing to omit the accents on uppercase is definitively not a good idea (although century old legacy). Using them whereever it is now possible is a far better practice.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-30T05:33:13.887

任何带有重音符号的字母都可能具有不同的代码点，或者是多个代码点的组合。例如，ÂËÕÝ 是具有小写等效项的大写字符。

关键是根据用户的区域设置忠实地实施标准，或者通过使用正确处理 toupper()/tolower() 的一般情况的系统库来获得相同的效果。

# iphone - 网页问题

> ID：929080
> 
> 赞同：0
> 
> 时间：2009-05-30T05:29:49.723
> 
> 标签：iphone

如何从网页中获取内容正文？...我只想从正文标签中获取文本，正文中的所有其他标签都应该被删除...

谁能帮我？提前致谢....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T05:34:32.557

首先找出body标签在字符串中的位置。然后使用 NSString 方法删除开始标记之前的所有内容和结束标记之后的所有内容。

之后，以下是从正文内容中去除 HTML 标记的方法：

[http://www.objectpark.net/StrippingHTML.html](http://www.objectpark.net/StrippingHTML.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T05:34:44.257

当你通过 NSURLConnection 进行调用时，你会从你在 NSURLRequest 中设置的 URL 接收到 NSMutableData 形式的 ASCII 文本数据。

从那里你必须只为字符串解析它，删除所有其他标签。也许使用上一个答案中提到的工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T08:49:36.580

如果您使用 UIWebView 来加载和显示，您可以使用它方便的方法`stringByEvaluatingJavaScriptFromString`。

```
NSString *jsString = @"document.getElementsByTagName('body')[0].innerHTML;";
NSString *contentOfBody = [myWebView stringByEvaluatingJavaScriptFromString:jsString]; 
```

这应该可以在 Web 视图中解决问题。请注意，我可能对 javescript 有点不满意，但我在我的应用程序中使用了相同的方法，并且效果很好。

# geolocation - 地理数据编码（国家/地区/城市的标准代码）

> ID：929087
> 
> 赞同：1
> 
> 时间：2009-05-30T05:35:35.410
> 
> 标签：geolocation, geocoding, geospatial

是否有一种标准方法来编码用户位置（国家、州/地区、城镇），以便我可以要求用户在注册时选择这些项目，然后使用这些数据在地图上显示他的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T12:48:25.647

[ISO 3166](http://en.wikipedia.org/wiki/ISO_3166)规范是广泛接受的国家和“主要细分”（即州、省、州等）代码标准。请注意，这与存储地址数据不同。

# sql - Rails 查找不重复的查询

> ID：929089
> 
> 赞同：0
> 
> 时间：2009-05-30T05:36:34.410
> 
> 标签：sql, ruby-on-rails

如何更改以下代码，以便我只有具有不同`sender_id`和`message_id`组合的记录：

```
@roles = Role.find_all_by_simulation_id(session[:sim_id])
@messages = RolesMessages.find(:all, :conditions => ["sender_id IN (?) ", @roles.map(&:id)], :order => 'created_at DESC') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T05:39:55.277

```
@messages = RolesMessages.find(:all, :select => 'DISTINCT sender_id, message_id', :conditions => ["sender_id IN (?) ", @roles.map(&:id)], :order => 'created_at DESC') 
```

编辑：现在我想到了，group by 可能是一个更好的选择。 `:group => 'sender_id, message_id'`可能会更好地满足您的需求

您还可以执行以下操作：

```
RolesMessages.find_by_sql("query goes here") 
```

（我更喜欢自己做查询……叫我疯了）

# python - Eclipse + AppEngine =？自动完成

> ID：929095
> 
> 赞同：0
> 
> 时间：2009-05-30T05:41:17.770
> 
> 标签：python, eclipse, google-app-engine

我在 Windows 机器上做了一些初学者 AppEngine 开发并为此安装了 Eclipse。我喜欢对象和函数的自动完成功能。

我将开发环境转移到我的 Macbook 上，并安装了 Eclipse Ganymede。我安装了 AppEngine SDK 和 Eclipse 插件。但是，当我现在输入代码时，自动完成功能不起作用。我错过了一步吗？

更新

只是补充一点：

该行：

```
import cgi 
```

似乎给了我我需要的东西。当我输入“cgi”时。我得到了所有的自动完成。但是，这些行：

```
from google.appengine.api import users
from google.appengine.ext import webapp
from google.appengine.ext.webapp.util import run_wsgi_app
from google.appengine.ext import db 
```

不要给我任何自动完成。如果我输入“用户”。没有自动完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T15:33:55.527

Eclipse 的 App Engine 插件适用于 Java SDK，而不适用于 Python。我不太了解 eclipse，但我怀疑您缺少的只是 eclipse 的 pythonpath 配置中包含的 App Engine SDK 的路径。找个地方添加它，它将能够找到 SDK 类并为它们提供自动完成建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-29T04:57:51.593

1.  为 Google App Engine添加库 [PyDev 项目未找到 webapp2](https://stackoverflow.com/questions/7756981/pydev-project-for-google-app-engine-not-finding-webapp2)
2.  现在创建 pydev GAE 项目 [http://www.mkyong.com/google-app-engine/google-app-engine-python-hello-world-example-using-eclipse/](http://www.mkyong.com/google-app-engine/google-app-engine-python-hello-world-example-using-eclipse/)

或添加类似于此 [https://developers.google.com/appengine/articles/eclipse的库](https://developers.google.com/appengine/articles/eclipse)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-07T06:57:52.140

我从 Google App Engine 论坛上的一张海报中找到了答案。我稍后会在博客上写下这段经历，但这一次在 GOOG 上失败了。您需要单击“Linux/Other”的下载链接以获取包含正确文件的 ZIP 文件。然后，您可以将 PYTHONPATH 指向本地计算机上的目录。

这里的失败是 Mac SDK 下载为您提供了 AppEngineLauncher，但没有这些文件。在 AppEngine 网站或 GOOG 发布的说明中，他们没有建议作为 Mac 开发人员下载这些“其他”文件。非常非常非常烦人。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T21:00:38.457

1.  您是否在 Java->Editor->Content Assist->Advanced（见下文）中检查了任何形式的“Java 提案”？
2.  您的错误日志中有任何消息吗？

[首选项 http://img26.imageshack.us/img26/2663/completionpreferences.png](http://img26.imageshack.us/img26/2663/completionpreferences.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T16:09:02.140

要让 Eclipse 自动完成您的 Python 代码，您需要将 Pydev 安装到 Eclipse 中。

这是一个免费插件，可在此处获得： http: [//aptana.com/python](http://aptana.com/python)

更新 Eclipse 时使用的 URL：http: [//pydev.sourceforge.net/updates/](http://pydev.sourceforge.net/updates/) （在 Eclipse 中，选择“帮助/软件更新...”）

该插件的增强版本称为 Pydev Extensions（费用： http: [//www.fabioz.com/pydev/buy.html](http://www.fabioz.com/pydev/buy.html)），提供更多功能，包括代码分析、自动导入代码完成和远程调试。

# vim - vim：将扩展名与语言相关联

> ID：929099
> 
> 赞同：28
> 
> 时间：2009-05-30T05:44:58.980
> 
> 标签：vim, syntax-highlighting, d

我有 gvim 7.2，它可以识别 .d 文件并根据 D 编程语言的语法正确突出显示它。但是，.di 文件不会被识别为 D 文件，并且不存在突出显示。

如何让vim根据D语言高亮显示.di文件？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-05-30T05:55:57.350

这应该在 .vimrc 中完成：

```
au BufNewFile,BufRead *.di setlocal ft=d 
```

可能还有其他方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T05:51:52.820

[http://vimdoc.sourceforge.net/htmldoc/filetype.html](http://vimdoc.sourceforge.net/htmldoc/filetype.html)有关于文件类型的（坚韧不拔的）细节。你可以通过编辑你的 vimrc 来修改相关的插件。查找规则 *.d，然后复制/粘贴该行，将其更改为 *.di

我没有使用过 gvim，所以可能有一种我不知道的更简单的方法

# python - 将一个数字范围转换为另一个范围，保持比率

> ID：929103
> 
> 赞同：340
> 
> 时间：2009-05-30T05:48:22.420
> 
> 标签：python, math

我正在尝试将一个数字范围转换为另一个数字，保持比率。数学不是我的强项。

我有一个图像文件，其中点值的范围可能从 -16000.00 到 16000.00，尽管典型范围可能要小得多。我要做的就是将这些值压缩到 0-100 的整数范围内，其中 0 是最小点的值，100 是最大点的值。即使丢失了一些精度，两者之间的所有点都应该保持相对比率我想在 python 中这样做，但即使是通用算法也应该足够了。我更喜欢可以调整最小/最大或任一范围的算法（即，第二个范围可以是-50 到 800 而不是 0 到 100）。

* * *

## 回答 #1

> 赞同：669
> 
> 时间：2009-05-30T05:52:21.290

```
NewValue = (((OldValue - OldMin) * (NewMax - NewMin)) / (OldMax - OldMin)) + NewMin 
```

或者更具可读性：

```
OldRange = (OldMax - OldMin)  
NewRange = (NewMax - NewMin)  
NewValue = (((OldValue - OldMin) * NewRange) / OldRange) + NewMin 
```

或者，如果您想保护旧范围为 0 ( *OldMin = OldMax* ) 的情况：

```
OldRange = (OldMax - OldMin)
if (OldRange == 0)
    NewValue = NewMin
else
{
    NewRange = (NewMax - NewMin)  
    NewValue = (((OldValue - OldMin) * NewRange) / OldRange) + NewMin
} 
```

请注意，在这种情况下，我们被迫任意选择一个可能的新范围值。根据上下文，明智的选择可能是：（`NewMin`参见*示例*），`NewMax`或`(NewMin + NewMax) / 2`

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2009-05-30T05:50:45.130

这是一个简单的线性转换。

```
new_value = ( (old_value - old_min) / (old_max - old_min) ) * (new_max - new_min) + new_min 
```

因此，将 -16000 到 16000 范围内的 10000 转换为 0 到 100 的新范围会产生：

```
old_value = 10000
old_min = -16000
old_max = 16000
new_min = 0
new_max = 100

new_value = ( ( 10000 - -16000 ) / (16000 - -16000) ) * (100 - 0) + 0
          = 81.25 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2013-03-21T00:32:53.217

Actually there are some cases that above answers would break. Such as wrongly input value, wrongly input range, negative input/output ranges.

```
def remap( x, oMin, oMax, nMin, nMax ):

    #range check
    if oMin == oMax:
        print "Warning: Zero input range"
        return None

    if nMin == nMax:
        print "Warning: Zero output range"
        return None

    #check reversed input range
    reverseInput = False
    oldMin = min( oMin, oMax )
    oldMax = max( oMin, oMax )
    if not oldMin == oMin:
        reverseInput = True

    #check reversed output range
    reverseOutput = False   
    newMin = min( nMin, nMax )
    newMax = max( nMin, nMax )
    if not newMin == nMin :
        reverseOutput = True

    portion = (x-oldMin)*(newMax-newMin)/(oldMax-oldMin)
    if reverseInput:
        portion = (oldMax-x)*(newMax-newMin)/(oldMax-oldMin)

    result = portion + newMin
    if reverseOutput:
        result = newMax - portion

    return result

#test cases
print remap( 25.0, 0.0, 100.0, 1.0, -1.0 ), "==", 0.5
print remap( 25.0, 100.0, -100.0, -1.0, 1.0 ), "==", -0.25
print remap( -125.0, -100.0, -200.0, 1.0, -1.0 ), "==", 0.5
print remap( -125.0, -200.0, -100.0, -1.0, 1.0 ), "==", 0.5
#even when value is out of bound
print remap( -20.0, 0.0, 100.0, 0.0, 1.0 ), "==", -0.2 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-07-10T02:11:52.597

有一个条件，当您检查的所有值都相同时，@jerryjvl 的代码将返回 NaN。

```
if (OldMin != OldMax && NewMin != NewMax):
    return (((OldValue - OldMin) * (NewMax - NewMin)) / (OldMax - OldMin)) + NewMin
else:
    return (NewMax + NewMin) / 2 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-04-23T04:27:08.287

我没有为此挖掘[BNF ，但 Arduino 文档有一个很好的函数示例，并且它被击穿了。](https://en.wikipedia.org/wiki/Backus%E2%80%93Naur_form)我可以在 Python 中使用它，只需将 def 重命名添加到 remap（因为 map 是内置的）并删除类型转换和花括号（即删除所有“long”）。

原来的

```
long map(long x, long in_min, long in_max, long out_min, long out_max)
{
  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
} 
```

Python

```
def remap(x, in_min, in_max, out_min, out_max):
  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min 
```

[https://www.arduino.cc/en/reference/map](https://www.arduino.cc/en/reference/map)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2017-02-07T16:32:06.967

这里有一些简短的 Python 函数，方便您复制和粘贴，包括缩放整个列表的函数。

```
def scale_number(unscaled, to_min, to_max, from_min, from_max):
    return (to_max-to_min)*(unscaled-from_min)/(from_max-from_min)+to_min

def scale_list(l, to_min, to_max):
    return [scale_number(i, to_min, to_max, min(l), max(l)) for i in l] 
```

可以这样使用：

```
scale_list([1,3,4,5], 0, 100) 
```

> [0.0, 50.0, 75.0, 100.0]

就我而言，我想缩放对数曲线，如下所示：

```
scale_list([math.log(i+1) for i in range(5)], 0, 50) 
```

> [0.0, 21.533827903669653, 34.130309724299266, 43.06765580733931, 50.0]

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2020-07-22T07:20:07.723

## 添加了带有数学解释的 KOTLIN 版本

考虑我们在**(OMin, Omax)**之间有一个刻度，我们在这个范围内有一个值**X**

我们要将其转换为比例 **（NMin，NMax）**

我们知道 X 并且我们需要找到 Y，比率必须相同：

```
 => (Y-NMin)/(NMax-NMin) = (X-OMin)/(OMax-OMin)  

 =>  (Y-NMin)/NewRange = (X-OMin)/OldRange 

 =>   Y = ((X-OMin)*NewRange)/oldRange)+NMin  Answer 
```

**务实地，我们可以这样写这个 rquation：**

```
 private fun  convertScale(oldValueToConvert:Int): Float {
       // Old Scale 50-100
       val oldScaleMin = 50
       val oldScaleMax = 100
       val oldScaleRange= (oldScaleMax - oldScaleMin)

       //new Scale 0-1
       val newScaleMin = 0.0f
       val newScaleMax = 1.0f
       val newScaleRange=  (newScaleMax - newScaleMin)

       return ((oldValueToConvert - oldScaleMin)* newScaleRange/ oldScaleRange) + newScaleMin
    } 
```

**爪哇**

```
/**
     * 
     * @param x
     * @param inMin
     * @param inMax
     * @param outMin
     * @param outMax
     * @return
     */
        private long normalize(long x, long inMin, long inMax, long outMin, long outMax) {
          long outRange = outMax - outMin;
          long inRange  = inMax - inMin;
          return (x - inMin) *outRange / inRange + outMin;
        } 
```

**用法：**

```
float brightness = normalize(progress, 0, 10, 0,255); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-12-16T04:40:26.937

在 PenguinTD 提供的清单中，我不明白为什么要反转范围，它无需反转范围即可工作。线性范围转换基于线性方程`Y=Xm+n`，其中`m`和`n`是从给定范围导出的。与其将范围称为`min`和`max`，不如将它们称为 1 和 2 。所以公式为：

```
Y = (((X - x1) * (y2 - y1)) / (x2 - x1)) + y1 
```

`Y=y1`何时何地`X=x1`，`Y=y2`何时何地`X=x2`。`x1`, `x2`, `y1`&`y2`可以被赋予任何`positive`or`negative`值。在宏中定义表达式使其更有用，然后可以与任何参数名称一起使用。

```
#define RangeConv(X, x1, x2, y1, y2) (((float)((X - x1) * (y2 - y1)) / (x2 - x1)) + y1) 
```

在所有参数都是值的`float`情况下，强制转换将确保浮点除法。`integer`根据应用程序，可能不需要检查范围`x1=x2`和`y1==y2`。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-07-09T16:14:08.937

我在用js解决的一个问题中使用了这个解决方案，所以我想我会分享翻译。感谢您的解释和解决方案。

```
function remap( x, oMin, oMax, nMin, nMax ){
//range check
if (oMin == oMax){
    console.log("Warning: Zero input range");
    return None;
};

if (nMin == nMax){
    console.log("Warning: Zero output range");
    return None
}

//check reversed input range
var reverseInput = false;
oldMin = Math.min( oMin, oMax );
oldMax = Math.max( oMin, oMax );
if (oldMin != oMin){
    reverseInput = true;
}

//check reversed output range
var reverseOutput = false;  
newMin = Math.min( nMin, nMax )
newMax = Math.max( nMin, nMax )
if (newMin != nMin){
    reverseOutput = true;
};

var portion = (x-oldMin)*(newMax-newMin)/(oldMax-oldMin)
if (reverseInput){
    portion = (oldMax-x)*(newMax-newMin)/(oldMax-oldMin);
};

var result = portion + newMin
if (reverseOutput){
    result = newMax - portion;
}

return result;
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-04-20T16:38:35.777

我个人使用支持泛型的辅助类（兼容 Swift 3、4.x）

```
struct Rescale<Type : BinaryFloatingPoint> {
    typealias RescaleDomain = (lowerBound: Type, upperBound: Type)

    var fromDomain: RescaleDomain
    var toDomain: RescaleDomain

    init(from: RescaleDomain, to: RescaleDomain) {
        self.fromDomain = from
        self.toDomain = to
    }

    func interpolate(_ x: Type ) -> Type {
        return self.toDomain.lowerBound * (1 - x) + self.toDomain.upperBound * x;
    }

    func uninterpolate(_ x: Type) -> Type {
        let b = (self.fromDomain.upperBound - self.fromDomain.lowerBound) != 0 ? self.fromDomain.upperBound - self.fromDomain.lowerBound : 1 / self.fromDomain.upperBound;
        return (x - self.fromDomain.lowerBound) / b
    }

    func rescale(_ x: Type )  -> Type {
        return interpolate( uninterpolate(x) )
    }
} 
```

前任：

```
 let rescaler = Rescale<Float>(from: (-1, 1), to: (0, 100))

   print(rescaler.rescale(0)) // OUTPUT: 50 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-11-25T22:11:12.360

C++ 变体

我发现 PenguinTD 的解决方案很有用，所以如果有人需要，我将它移植到 C++：

> 浮动重映射（浮动 x，浮动 oMin，浮动 oMax，浮动 nMin，浮动 nMax）{
> 
> ```
> //range check
> if( oMin == oMax) {
>     //std::cout<< "Warning: Zero input range";
>     return -1;    }
> 
> if( nMin == nMax){
>     //std::cout<<"Warning: Zero output range";
>     return -1;        }
> 
> //check reversed input range
> bool reverseInput = false;
> float oldMin = min( oMin, oMax );
> float oldMax = max( oMin, oMax );
> if (oldMin == oMin)
>     reverseInput = true;
> 
> //check reversed output range
> bool reverseOutput = false;  
> float newMin = min( nMin, nMax );
> float newMax = max( nMin, nMax );
> if (newMin == nMin)
>     reverseOutput = true;
> 
> float portion = (x-oldMin)*(newMax-newMin)/(oldMax-oldMin);
> if (reverseInput)
>     portion = (oldMax-x)*(newMax-newMin)/(oldMax-oldMin);
> 
> float result = portion + newMin;
> if (reverseOutput)
>     result = newMax - portion;
> 
> return result; } 
> ```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-03-27T06:37:22.997

PHP 端口

发现 PenguinTD 的解决方案很有帮助，所以我将其移植到 PHP。帮助自己！

```
/**
* =====================================
*              Remap Range            
* =====================================
* - Convert one range to another. (including value)
*
* @param    int $intValue   The value in the old range you wish to convert
* @param    int $oMin       The minimum of the old range
* @param    int $oMax       The maximum of the old range
* @param    int $nMin       The minimum of the new range
* @param    int $nMax       The maximum of the new range
*
* @return   float $fResult  The old value converted to the new range
*/
function remapRange($intValue, $oMin, $oMax, $nMin, $nMax) {
    // Range check
    if ($oMin == $oMax) {
        echo 'Warning: Zero input range';
        return false;
    }

    if ($nMin == $nMax) {
        echo 'Warning: Zero output range';
        return false;
    }

    // Check reversed input range
    $bReverseInput = false;
    $intOldMin = min($oMin, $oMax);
    $intOldMax = max($oMin, $oMax);
    if ($intOldMin != $oMin) {
        $bReverseInput = true;
    }

    // Check reversed output range
    $bReverseOutput = false;
    $intNewMin = min($nMin, $nMax);
    $intNewMax = max($nMin, $nMax);
    if ($intNewMin != $nMin) {
        $bReverseOutput = true;
    }

    $fRatio = ($intValue - $intOldMin) * ($intNewMax - $intNewMin) / ($intOldMax - $intOldMin);
    if ($bReverseInput) {
        $fRatio = ($intOldMax - $intValue) * ($intNewMax - $intNewMin) / ($intOldMax - $intOldMin);
    }

    $fResult = $fRatio + $intNewMin;
    if ($bReverseOutput) {
        $fResult = $intNewMax - $fRatio;
    }

    return $fResult;
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-03-10T14:26:59.233

这是一个 Javascript 版本，它返回一个函数，该函数对预定的源和目标范围进行重新缩放，从而最大限度地减少每次必须完成的计算量。

```
// This function returns a function bound to the 
// min/max source & target ranges given.
// oMin, oMax = source
// nMin, nMax = dest.
function makeRangeMapper(oMin, oMax, nMin, nMax ){
    //range check
    if (oMin == oMax){
        console.log("Warning: Zero input range");
        return undefined;
    };

    if (nMin == nMax){
        console.log("Warning: Zero output range");
        return undefined
    }

    //check reversed input range
    var reverseInput = false;
    let oldMin = Math.min( oMin, oMax );
    let oldMax = Math.max( oMin, oMax );
    if (oldMin != oMin){
        reverseInput = true;
    }

    //check reversed output range
    var reverseOutput = false;  
    let newMin = Math.min( nMin, nMax )
    let newMax = Math.max( nMin, nMax )
    if (newMin != nMin){
        reverseOutput = true;
    }

    // Hot-rod the most common case.
    if (!reverseInput && !reverseOutput) {
        let dNew = newMax-newMin;
        let dOld = oldMax-oldMin;
        return (x)=>{
            return ((x-oldMin)* dNew / dOld) + newMin;
        }
    }

    return (x)=>{
        let portion;
        if (reverseInput){
            portion = (oldMax-x)*(newMax-newMin)/(oldMax-oldMin);
        } else {
            portion = (x-oldMin)*(newMax-newMin)/(oldMax-oldMin)
        }
        let result;
        if (reverseOutput){
            result = newMax - portion;
        } else {
            result = portion + newMin;
        }

        return result;
    }   
} 
```

这是使用此函数将 0-1 缩放为 -0x80000000、0x7FFFFFFF 的示例

```
let normTo32Fn = makeRangeMapper(0, 1, -0x80000000, 0x7FFFFFFF);
let fs = normTo32Fn(0.5);
let fs2 = normTo32Fn(0); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-08-21T17:19:52.093

我在 R 中编写了一个函数来执行此操作。方法与上述相同，但我需要在 R 中执行多次，所以我想我会分享以防它对任何人有帮助。

```
convertRange <- function(
  oldValue,
  oldRange = c(-16000.00, 16000.00), 
  newRange = c(0, 100),
  returnInt = TRUE # the poster asked for an integer, so this is an option
){
  oldMin <- oldRange[1]
  oldMax <- oldRange[2]
  newMin <- newRange[1]
  newMax <- newRange[2]
  newValue = (((oldValue - oldMin)* (newMax - newMin)) / (oldMax - oldMin)) + newMin

  if(returnInt){
   return(round(newValue))
  } else {
   return(newValue)
  }
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-04-30T01:11:04.937

# Java版

不管你喂什么，它总是有效的！

我将所有内容都扩展了，以便更容易学习。当然，最后的四舍五入是可选的。

```
 private long remap(long p, long Amin, long Amax, long Bmin, long Bmax ) {

    double deltaA = Amax - Amin;
    double deltaB = Bmax - Bmin;
    double scale  = deltaB / deltaA;
    double negA   = -1 * Amin;
    double offset = (negA * scale) + Bmin;
    double q      = (p * scale) + offset;
    return Math.round(q);

} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-08-20T10:32:21.453

# 列表理解一班轮解决方案

```
color_array_new = [int((((x - min(node_sizes)) * 99) / (max(node_sizes) - min(node_sizes))) + 1) for x in node_sizes] 
```

# 更长的版本

```
def colour_specter(waste_amount):
color_array = []
OldRange = max(waste_amount) - min(waste_amount)
NewRange = 99
for number_value in waste_amount:
    NewValue = int((((number_value - min(waste_amount)) * NewRange) / OldRange) + 1)
    color_array.append(NewValue)
print(color_array)
return color_array 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2015-04-08T04:30:54.750

**捷径/简化提案**

```
 NewRange/OldRange = Handy multiplicand or HM
 Convert OldValue in OldRange to NewValue in NewRange = 
 (OldValue - OldMin x HM) + NewMin 
```

韦恩

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2021-09-21T04:53:17.827

使用`Numpy`and`interp`函数，您可以**将值从旧范围转换为新范围**：

```
>>> import numpy as np
>>> np.interp(0, [-16000,16000], [0,100])
50.0 
```

您也可以尝试使用它来**映射值列表**：

```
>>> np.interp([-16000,0,12000] ,[-16000,16000], [0,100])
array([ 0\. , 50\. , 87.5]) 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-11-10T00:22:17.243

此示例将歌曲当前位置转换为 20 - 40 的角度范围。

```
 /// <summary>
    /// This test converts Current songtime to an angle in a range. 
    /// </summary>
    [Fact]
    public void ConvertRangeTests()
    {            
       //Convert a songs time to an angle of a range 20 - 40
        var result = ConvertAndGetCurrentValueOfRange(
            TimeSpan.Zero, TimeSpan.FromMinutes(5.4),
            20, 40, 
            2.7
            );

        Assert.True(result == 30);
    }

    /// <summary>
    /// Gets the current value from the mixValue maxValue range.        
    /// </summary>
    /// <param name="startTime">Start of the song</param>
    /// <param name="duration"></param>
    /// <param name="minValue"></param>
    /// <param name="maxValue"></param>
    /// <param name="value">Current time</param>
    /// <returns></returns>
    public double ConvertAndGetCurrentValueOfRange(
                TimeSpan startTime,
                TimeSpan duration,
                double minValue,
                double maxValue,
                double value)
    {
        var timeRange = duration - startTime;
        var newRange = maxValue - minValue;
        var ratio = newRange / timeRange.TotalMinutes;
        var newValue = value * ratio;
        var currentValue= newValue + minValue;
        return currentValue;
    } 
```

# javascript - 如何在 $.ajax 中将变量传递给 web 服务

> ID：929114
> 
> 赞同：3
> 
> 时间：2009-05-30T05:56:30.750
> 
> 标签：javascript, jquery, ajax

我想向网络服务发送一个参数。该参数需要是一个变量而不是一个固定的字符串。当我编写以下代码时，webservice 被很好地调用并完美执行。

```
$(document).ready(function() {
  $.ajax({
    type: "POST",
    url: "JsonTestService.asmx/Test",
    data:"{'url':'http://www.cramster.com'}",
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(msg) {
      alert(msg.d);
    }  
  });
}); 
```

但是，当我将行更改为以下 x 是变量时，它不起作用。您能告诉我如何在以下代码中将变量传递给 Web 服务吗？

```
data:"{'url':x}", 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T06:00:26.127

你真的很亲近。不要将您的数据元素值括在引号中，即：

```
$(function() {
  var dynamic_url = "http://www.example.com";
  $.ajax({
    type: "POST",
    url: "JsonTestService.asmx/Test",
    data: {
      url: dynamic_url
    },
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function(msg) {
      alert(msg.d);
    }
  });
});` 
```

通过将全部内容括在引号中，表达式根本没有被评估。我还建议使用这两种语法来传递对象。我认为它更清楚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T07:24:46.440

必须引用整个 JSON 字符串的原因：

> 在向它们发出的请求中，ASP.NET AJAX 脚本服务和页面方法理解并期望将参数序列化为 JSON 字符串。这些参数从 POST 数据中解析出来，并用作您调用的方法的参数。
> 
> 但是，如果您直接提供 JSON 对象作为 $.ajax 调用的数据参数，jQuery 会将对象序列化为一系列要发布的 k,v 对，而不是将原始 JSON 传递给您的 Web 服务。

如果您有兴趣，可以在[这篇文章中获得更多关于将 jQuery 与 ASP.NET AJAX Web 服务和页面方法一起使用时的常见缺陷的详细信息。](http://encosia.com/2008/06/05/3-mistakes-to-avoid-when-using-jquery-with-aspnet-ajax/)

您可能还对[使用 stringify 方法使构造 JSON 字符串更加简洁](http://encosia.com/2009/04/07/using-complex-types-to-make-calling-services-less-complex/)感兴趣。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T06:02:18.320

以下应该有效：

```
$(document).ready(function() {
    var x = 'http://www.cramster.com';

    $.ajax({
        type: "POST",
        url: "JsonTestService.asmx/Test",
        data: { 'url': x },
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function(msg) {
            alert(msg.d);
        }
    });
}) 
```

您需要丢失`data`参数周围的引号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T07:33:45.173

根据 jquery 文档将完整的 json 作为字符串是正确的，将 x 的值放入其中的明显解决方案是：

```
data:"{\"url\":\"" + x + "\"}", 
```

# objective-c - 使用 Objective-C 搜索开放目录 (LDAP)

> ID：929120
> 
> 赞同：4
> 
> 时间：2009-05-30T05:59:48.420
> 
> 标签：objective-c, cocoa, ldap

是否有人在 Objective C 中有任何示例代码用于连接到外部 Open Directory 服务器并搜索特定节点（如 /Users/）？

我查看了 Apple 上的 OD 指南，但无法弄清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T06:23:18.717

这是[你](http://developer.apple.com/documentation/Networking/Conceptual/Open_Directory/Introduction/Introduction.html)看过的“OD指南”吗？似乎附带了非常丰富和广泛的代码示例——您发现自己难倒了这些示例中的哪一个？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T12:55:40.353

实际上，在 Leopard 中围绕这些 API 有一个更好的 CoreFoundation 和 Objective-C 包装器，尽管它*在 10.5 中*是一个私有框架。

好消息是它是开源的，因此您可以[直接从 Apple](http://opensource.apple.com/source/OpenDirectory/OpenDirectory-39/)获取源代码。坏消息是它引用了其他私有框架（`DirectoryServiceCore/CSharedData.h`和`CoreFoundation/CFRuntime.h`）中的几个标头，这使得构建自己的嵌入副本有点困难。但是，您可以这样做，但您需要从其他项目中获取相关标题才能这样做。

但是，与此同时，您可能会发现该项目中的代码说明了您自己编写的代码。

对于更有用的可嵌入代码，您可以查看开源[DSTools 项目](http://opensource.apple.com/source/DSTools/DSTools-112.1/)，尤其是 DSObjCWrappers 例程。这曾经是 loginwindow 应用程序的一部分，但我记得在 10.3 或 10.4 中被分开了。但是，与新版本不同的是，它不需要访问任何私有 API。我也从个人经验中知道，可以将整个 DSObjCWrappers 文件夹直接复制并导入到您自己的项目中并就地使用它，尽管我建议使用 Xcode 的重构支持更改所有类名以避免命名空间冲突（即将“DSoAttribute”更改为“MyDSAttribute”等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-05T07:00:34.487

感谢所有好的建议，我认为只使用 C 是满足我需求的方法。我发现这个网站很有帮助：[http ://www.mozilla.org/directory/csdk-docs/writing.htm](http://www.mozilla.org/directory/csdk-docs/writing.htm)

# javascript - GGeoXML如何访问跨域XML文件？

> ID：929122
> 
> 赞同：0
> 
> 时间：2009-05-30T06:00:42.333
> 
> 标签：javascript, ajax, google-maps, xmlhttprequest, kml

Google Maps 的 API 对象 GGeoXML 能够访问跨域 XML 文件（通常是 KML 或 GeoRSS）。它不使用 XmlHttpRequest，因为它抛出“访问受限 URI 被拒绝”异常（正如它应该的那样）。此外，它不使用 Google 的 GXmlHttp 包装器，因为我已经尝试过并且它抛出了相同的 URI denied 异常。

因此，GGeoXML 不使用 XMLHttpRequest 也不使用 Google 的 GXMLHttp 包装器。GGeoXML如何访问跨域XML文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T07:07:05.953

如果您*确实*想通过 AJAX 获取跨域数据，则可以使用 JSONP。它本质上是一个封装在函数调用中的 JSON 对象。当 JSONP 对象返回到您的服务器时，将执行该函数并将其中的 JSON 解析回一个可行的对象。

JSONP 是专门为避免 AJAX 的跨域限制而创建的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-07T19:42:08.343

后端有一个代理可以“跨域”访问此数据。这避免了浏览器中的跨域安全功能。

对“fetchData”的 JS 调用调用了与 js 所在域相同的 Web 服务。此后端代理“跨域”访问其他信息，对其进行解析并将其返回给“fetchData”调用的回调函数。

# xmlhttprequest - HTTP 请求和响应

> ID：929124
> 
> 赞同：0
> 
> 时间：2009-05-30T06:00:53.753
> 
> 标签：xmlhttprequest

我想向远程服务器发出 HTTP 请求并希望得到回复。

如何连接到服务器以及如何读取 xml 文件响应。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T06:08:28.823

有关简单示例，请参见[http://www.w3schools.com/ajax/ajax_server.asp](http://www.w3schools.com/ajax/ajax_server.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T06:09:08.307

这是关于 AJAX / XMLHTTPRequest[的一个很好的初学者教程。](http://www.w3schools.com/ajax/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T07:38:14.167

您可以尝试使用 telnet 进行非常简单的测试

```
telnet google.com 80
GET /path/to/file/index.html HTTP/1.0 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T07:13:20.097

向 Web 服务器生成请求并获得响应的最简单方法是使用 Web 浏览器 - 如果您知道提供 XML 数据的 Web 服务的 URL，只需在浏览器中导航到该 URL。请注意，这做了一些假设；例如，Web 服务响应 GET 请求（与 POST 或其他 HTTP 动词相反）。如果您进一步阐明该方案，我们可以提供更详细的指导。

# c# - WPF ContextMenu 文本对齐

> ID：929125
> 
> 赞同：1
> 
> 时间：2009-05-30T06:01:21.833
> 
> 标签：c#, wpf, alignment, contextmenu

我正在为 WPF 应用程序构建上下文菜单，如果我有文本然后添加图像，则文本始终在菜单项的顶部对齐，我不知道如何将其与中心对齐。

我已经尝试了`VerticalAlignment`and`VerticalContentAlignment`属性，但它们没有帮助..有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-31T10:11:03.680

我想这取决于您使用哪种面板来托管文本和图像。我尝试使用 a `StackPanel`，一旦添加`VerticalAlignment="Center"`，文本就正确对齐了。如果它仍然不适合您，请提供更多信息。

```
<Button Content="Right-click me">
    <Button.ContextMenu>
        <ContextMenu>
            <MenuItem>
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock VerticalAlignment="Center">Menu item 1</TextBlock>
                        <Image Source="image.png" Height="50" />
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>
        </ContextMenu>
    </Button.ContextMenu>
</Button> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T08:52:10.713

每当我遇到这样的问题时，我都会启动 Snoop ( [https://github.com/snoopwpf/snoopwpf](https://github.com/snoopwpf/snoopwpf) ) 并使用它来确定哪个控件对齐不正确。

# asp.net - 如何解决 IIS7.0 上的“HTTP 错误 500.19 - 内部服务器错误”

> ID：929131
> 
> 赞同：225
> 
> 时间：2009-05-30T06:06:08.610
> 
> 标签：asp.net, iis, web-applications, iis-7

是什么导致了这个错误，我该如何解决？

> 详细错误信息
> 模块 IIS Web 核心
> 通知 BeginRequest
> 处理程序 尚未确定
> 错误代码 0x8007052e
> 配置错误 无法使用虚拟目录密码以用户管理员身份本地登录 C:\inetpub\wwwroot
> 配置文件不可用（配置隔离）
> 请求的 URL [http:// 192.168.0.3:80/](http://192.168.0.3:80/)
> 物理路径 C:\inetpub\wwwroot
> 登录方法尚未确定
> 登录用户尚未确定

配置源

```
<application path="/" applicationPool="PS-Extranet">
    <virtualDirectory path="/" physicalPath="%SystemDrive%\inetpub\wwwroot" userName="administrator" password="[enc:AesProvider:PrISRz2ggJH4bV46ktObfCSh91Y/yF9pAoLmH7eCnj0=:enc]" />
</application> 
```

* * *

## 回答 #1

> 赞同：427
> 
> 时间：2012-02-29T07:56:48.620

我有同样的问题，但原因不同。

在我的 web.config 中有一个*URL 重写模块规则*，我还没有安装 URL 重写模块。在我安装[url rewrite 模块](http://www.iis.net/download/urlrewrite)后，这个问题就解决了。

* * *

## 回答 #2

> 赞同：162
> 
> 时间：2009-05-30T07:09:30.120

看起来您用于应用程序池的用户帐户没有网站目录的权限，因此它无法从那里读取配置。检查应用程序池并查看它配置为以哪个用户身份运行。检查目录并查看该用户是否具有适当的权限。当您使用它时，请检查事件日志并查看 IIS 是否在其中记录了任何更详细的诊断信息。

* * *

## 回答 #3

> 赞同：123
> 
> 时间：2015-09-26T14:28:20.063

在 Windows 10 上，我必须安装`ASP.NET 3.5`和安装`ASP.NET 4.6`（`Internet Information Services`其他框会自动检查自己）：

[![在此处输入图像描述](https://i.stack.imgur.com/b3KIw.png)](https://i.stack.imgur.com/b3KIw.png)

* * *

## 回答 #4

> 赞同：79
> 
> 时间：2014-05-19T14:32:30.443

最后我得到了我的问题的解决方案。asp.net 帐户未出现在 IIS 管理器中，因为我没有在 IIS 中选中其复选框以在 Windows 7 中执行此操作，请按照以下步骤操作

1.  打开控制面板
2.  点击“程序”链接（不是卸载程序）
3.  单击“打开/关闭 Windows 功能”链接
4.  在弹出窗口中找到“Internet Information Services IIS”并展开其节点
5.  展开“万维网服务”节点
6.  展开“应用程序开发功能”节点
7.  勾选“ASP.NET”复选框</li>
8.  然后点击确定按钮

现在您将在 IIS 管理器上看到 Asp.net 帐户，默认情况下您会看到 IIS 帐户 现在您应该将您的 asp.net 网站从“我的文档”移动到 IIS 有权访问它的另一个地方（到您的任何分区计算机）现在从 IIS 管理器浏览您的网站，它应该可以工作。

* * *

## 回答 #5

> 赞同：68
> 
> 时间：2011-10-03T17:34:42.190

我们必须更改域管理员密码后出现此错误。

经过几个设置后，我最终发现在下面路径的应用程序中，它被设置为专门使用域管理员帐户而不是直通身份验证（谁知道为什么）。

> IIS 管理器 -> 基本设置 -> 连接

* * *

## 回答 #6

> 赞同：19
> 
> 时间：2014-04-16T15:57:58.423

你需要做一个步骤：

```
run->cmd

run "c:\Windows\Microsoft.NET\Framework\v4.0.30319\aspnet_regiis.exe -i" 
```

就是这样

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2012-03-12T04:43:55.043

今天遇到了这个问题，解决了。有人在 IIS 中为“默认网站”设置了“路径凭据”以作为特定用户运行。由于密码过期或只是例行更改，同一用户更改了她的密码。通过基本设置选项将“默认网站”设置为“应用程序用户”为我解决了这个问题

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2013-02-04T15:38:07.517

您可能更改了 NT 密码。

> 打开 IIS -> 右键单击​​您的应用程序 -> 管理应用程序 -> 高级设置 -> 物理路径凭据。

祝你好运

* * *

## 回答 #9

> 赞同：9
> 
> 时间：2014-09-09T09:02:33.337

就我而言，更改文件夹的解决方案后会出现此错误。

我通过转到我的项目属性并重新创建我的虚拟目录来解决问题。

**右键单击项目 > 属性 > Web > 在服务器部分下单击“创建虚拟目录”**

它会显示一条消息，说虚拟目录是在另一个地方创建的，它会改变它

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2016-05-26T14:18:22.400

对我来说，我需要在“添加/删除 Windows 功能”中的 .Net 功能下启用**Http 激活**

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2010-11-11T15:02:38.073

得到这个工作正常，但不是基于上面的建议。我的情况是在域中的 Windows 2008 服务器上运行 iis7 时出现 500 错误。刚刚在域中添加了一个新用户，基本上允许对虚拟目录或文件夹进行读取/执行访问。确保将虚拟文件夹 > 基本设置 > 连接为 > 路径凭据设置为具有读取/执行访问权限的用户。您可以测试设置，并且身份验证和授权都应该可以工作。干杯!

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2014-03-13T13:03:17.170

现在我遇到了这个错误并解决了它。您的 url 可以与创建的虚拟目录匹配。

您必须检查虚拟目录，在我的示例中，我`applicationhost.config`在下一行找到：

```
<application path="/" applicationPool="Clr4IntegratedAppPool">
    <virtualDirectory path="/admin/roles" physicalPath="C:\..." />
</application> 
```

我尝试使用 url ( `http://localhost/admin/roles`)`AdminController`和`Roles`操作打开页面并收到此错误。

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2010-06-18T23:42:45.767

对于其他人，由于尝试在 .Net 2 应用程序池中运行 .Net 4 应用程序，我收到了类似的错误消息。更改应用程序池的 .Net FX 版本为我修复了它。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2010-08-03T08:22:48.433

我在安装 php 5.3.3 时遇到了类似的错误，错误代码为 0x80070020，指向我的 www 根目录（不是标准根目录）中 web.config 中的几行。

该解决方案虽然粗糙，但效果很好。我只是删除了 web.config 文件，现在一切正常。我花了 HOURS 尝试其他解决方案无济于事。

如果有人认为这很愚蠢，请告诉我。如果其他人用同样多的时间拔头发，试试看（当然是在备份文件之后）

问候 FEQ

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2013-01-10T22:15:31.847

遇到同样的错误并修复 IIS 应用程序池中的凭据没有帮助。我终于通过在默认网站、高级设置->物理路径凭据->特定用户下选择我的网站来解决 IIS 中的错误，然后重新输入应用程序池用户的凭据，然后重新启动 IIS，错误消失了，我的网站来了成功起来。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2013-06-06T07:18:29.073

**默认网站**也需要管理：

1.在默认网站->基本设置->连接为，将其更改为正确的用户。

2.更改与defaultWebSite相关的applicationPool的Identiy

g.运气

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2014-04-14T17:45:33.187

如果当您尝试访问 joomla 管理员面板时它很大，只是用户名和密码问题！您只需更新 joomla 数据库中的 jos_user。

转到您的 joomla 网站目录并使用 bloc note 或记事本打开**configuration.php**以显示您的 joomla 管理员站点使用的数据库名称。您必须找到具有以下内容的行：

```
public $user = 'joomlauser251';           //MySQL username 
```

在我的情况下`joomlauser251`是我的数据库名称。

登录到你的mysql：

```
 mysql -uyourusername -pyourpassword 
```

为您的 joomla 选择数据库：

```
use joomlauser251; 
```

修改管理员密码：

```
UPDATE jos_users SET password=MD5(‘NewPassword’) WHERE username=’admin’; 
```

并再次尝试访问。

就这样 ！！！

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2012-09-20T00:57:30.347

对我来说似乎不是权限问题 - 尝试让 IIS_IUSRS 帐户完全控制 Web 服务中的所有内容，只是为了看看这是否是原因。修复结果是在 IIS 中重新创建托管 Web 服务的应用程序（即实际的“.svc”）

* * *

## 回答 #19

> 赞同：2
> 
> 时间：2013-02-12T17:30:56.350

当我获得 500.19 时，我`IIS_IUSRS`为上述 web.config 和项目文件夹提供了完全访问权限。这解决了这个问题。

您可以通过以下方式授予权限

1.  右键单击文件夹/文件
2.  选择选项卡“安全”
3.  添加用户`IIS_IUSRS`- 不要忘记 USRS 前面的 i 并且不要像在 USERS 中那样写“e”

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2014-11-06T17:43:20.173

就我而言，我在虚拟目录默认值下的 applicationHost.config 中找到了对旧域帐户密码的引用。

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2014-12-22T09:24:04.043

很容易在 Windows -> System32 -> inetsrv -> config 中找到文件“applicationHost.config” 1\. 将“applicationHost.config”备份到另一个文件名 2\. 打开文件“applicationHost.config”清除数据并保存 3\. 打开浏览器并调用url内部网站，完成。

* * *

## 回答 #22

> 赞同：2
> 
> 时间：2015-04-22T23:53:16.197

如果您使用的是新的专用用户帐户...还值得检查该帐户的密码是否未过期，因为这也会导致此 500.19 权限问题。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2013-10-22T07:37:08.113

ASP.Net 应用程序预装了 web.config 中的处理程序部分。默认情况下，这在 IIS 的功能委派中设置为只读。在 IIS 管理器中查看

1.转到**IIS管理器**并单击服务器名称

2.转到**管理部分**并单击**功能委派**。

3.选择应该设置为**只读**的**处理程序映射**。

 **4.将值更改为**读/写**，现在您可以解决问题

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2015-04-22T10:48:15.257

关于这一点，我还有一件事要说。使用相同的 HTTP 错误代码，您仍然可以有几个不同的错误，因为其中一个已在原始问题的描述中发布。例如：在我编辑了`Web.Config`一个 ASP.NET 项目的文件后，我有

> 错误代码 0x8007000d
> 
> “只允许一个 <configSections> 元素。它必须是根 <configuration> 元素的第一个子元素”

正如它所说，您不能`<configSections>`在文件部分之前插入您自己的 XML 内容`Web.Config`。在我的结束标记之后插入我的片段后`<configSections>`，它工作得很好。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2015-09-30T14:59:12.247

我的网站的正确路径未在 IIS 中指定。

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2016-02-03T10:16:05.313

我的解决方案是，

1.  只需删除损坏的文件夹。
2.  然后再次重新创建文件夹。

> 似乎损坏的文件夹是在 IIS 设置之前创建的。如果您再次创建文件夹，它将正常工作。

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2016-03-09T10:11:57.580

从运行 IIS 的计算机上卸载 Windows Server Update Services (WSUS) 后出现此错误。显然卸载 WSUS 可能会破坏服务器上的 IIS 配置，从而使安装在同一服务器上的其他 Web 应用程序不可用。

[我在这里](https://social.technet.microsoft.com/Forums/windowsserver/en-US/6f73e779-a1ce-4730-8a9f-a8d365209625/missing-2-dlls-for-iis-after-uninstalling-wsus-iis-broken?forum=winserveressentials)找到了问题的解决方案。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2016-05-24T16:27:56.393

对于 ASP.NET Core 网站，如果您没有安装 HttpPlatformHandler 模块，也会发生此一般错误，有关详细信息，请参阅[此答案。](https://stackoverflow.com/a/33235848/33080)

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2016-06-29T06:52:09.403

就我而言，文件中的 Key 值不正确`Web.config`：

```
 <defaultDocument>
        <files>
            <add value="Portal.htm" />
        </files>
    </defaultDocument> 
```

当我将值更改为“Portal.html”时，它起作用了。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2016-03-03T10:29:42.850

从 Visual Studio 2013 升级到 2015 后出现此错误。经过一番搜索和尝试各种修复后，我发现可以通过从 web.config 中删除以下内容来解决该问题：

```
<staticContent>
    <mimeMap fileExtension=".less" mimeType="text/css" />
</staticContent > 
```

显然 staticContent 现在已弃用？

[来源](https://stackoverflow.com/questions/30050290/solved-visual-studio-2015-error-500-19)

**编辑 1**

在部署程序时，这种方式会阻止 IIS 提供 .json 文件。如果您这样做，您应该将 .json (application/json) 重新添加到 IIS 中站点的 mime 类型。以下是更多信息：[http ://www.iis.net/configreference/system.webserver/staticcontent/mimemap](http://www.iis.net/configreference/system.webserver/staticcontent/mimemap)

**编辑 2**

我注意到在我的情况下，上述编辑 1 解决方案只能暂时起作用。一旦我重新部署，条目就会被删除。因此，我将 mimeMap XML 移动到`Web.Release.config`. 现在工作正常。

* * *

## 回答 #31

> 赞同：-6
> 
> 时间：2011-07-08T19:56:42.300

1.  从开始按钮打开 IIS 管理器
2.  双击功能委托
3.  使所有属性读写
4.  去ISPAI并删除所有权限

如果上面没有正常工作。然后，确保你在安装 IIS 之前先安装了 Visual Studio，

为了获得更好的解决方案，请卸载 Visual Studio，然后再次正确安装第一个 IIS，然后再安装 Visual Studio

# architecture - 应用架构清单中应包括哪些内容？

> ID：929133
> 
> 赞同：45
> 
> 时间：2009-05-30T06:07:42.680
> 
> 标签：architecture, review

我正在尝试提出一个清单或一组问题/标准来评估和评估提议的或新兴的架构（执行架构审查）。在尝试规划、评估或审查架构时，您提出的最重要的问题是什么？

我知道这是一个很大的话题，所以我想把它限制在一个单一的端到端系统上，而不是整个组织的架构。

*Code Complete*提供了一个不错的起点：

> 建筑学
> 
> *   程序的整体组织是否清晰，包括良好的架构概述和理由？
> *   模块是否定义良好，包括它们的功能和与其他模块的接口？
> *   需求中列出的所有功能是否都被合理地涵盖了，既没有太多也没有太少的模块？
> *   架构是否旨在适应可能的变化？
> *   是否包括必要的购买与建造决策？
> *   架构是否描述了如何使重用代码符合其他架构目标？
> *   所有主要的数据结构都隐藏在访问例程后面吗？
> *   数据库组织和内容是否合理？
> *   是否描述了所有关键算法并证明了其合理性？
> *   所有主要对象都被描述和证明了吗？
> *   是否描述了处理用户输入的策略？
> *   是否描述并证明了处理 I/O 的策略？
> *   是否定义了用户界面的关键方面？
> *   用户界面是模块化的，所以它的变化不会影响程序的其余部分吗？
> *   内存使用估计和内存管理策略是否得到描述和证明？
> *   架构是否为每个模块设置了空间和速度预算？
> *   是否描述了处理字符串的策略，是否提供了字符串存储估计？
> *   是否提供了一致的错误处理策略？
> *   是否将错误消息作为一组进行管理以呈现干净的用户界面？
> *   是否规定了稳健性水平？
> *   是否有任何部分架构过度或不足？是否明确规定了该领域的期望？
> *   主要系统目标是否明确说明？
> *   整个架构在概念上是否结合在一起？
> *   顶层设计是否独立于用于实现它的机器和语言？
> *   是否提供了所有重大决策的动机？
> *   作为将要实现系统的程序员，您对架构感到满意吗？

我正在寻找带有示例的实用知识，例如，您创建的架构中最痛苦的点是什么？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-06-23T20:19:15.810

根据我的研究，这里有一些架构审查清单，我发现这些清单可以更公正地回答这个问题，并提供一些关于架构审查是什么的背景知识。（这里似乎有点混乱。）

这些潜在候选人中的每一个都包括许多不同的类别。这些类别的总体重要性会因业务需求而有所不同。恕我直言，没关系。在通过检查清单进行审查并排除它时提出另一个问题的成本要低于完全错过一个问题或类别，因为它最初似乎不够重要，无法包含在清单中。

*   Alexander Nowak 的“[软件架构审查指南”](https://www.codeproject.com/Articles/20467/Software-Architecture-Review-Guidelines)
*   “[建筑设计文件审查清单](http://www.win.tue.nl/%7Ewstomv/edu/2im24+2im25/add.html)”，Tom Verhoeff
*   来自 Microsoft 模式和实践开发人员中心的“[清单：架构和设计审查”](http://msdn.microsoft.com/en-us/library/aa302332.aspx)
*   Craig Borysowich 的“[概念建筑清单”](http://it.toolbox.com/blogs/enterprise-solutions/conceptual-architecture-checklist-22364)
*   “ [App Arch 指南 2.0 知识库：清单 - 架构和设计](http://apparch.codeplex.com/Wiki/View.aspx?title=Checklist%20-%20Architecture%20and%20Design&referringTitle=Home)”，作者 JD Meier、Alex Homer 等人。（通过 Peter Stuer 的链接找到）
*   来自 Open Group 的“ [TOGAF 架构合规审查清单”](http://www.opengroup.org/architecture/togaf9-doc/arch/chap48.html#tag_49_05)
*   Ricky Ho 的“[架构审查过程”](https://dzone.com/articles/architecture-review-process)

似乎也有关于这个主题的白皮书，虽然我还没有阅读过。它试图在大约 11 页的过程中回答这个问题。

*   [建筑评论：](http://ieeexplore.ieee.org/xpl/freeabs_all.jsp?tp=&arnumber=1407824&isnumber=30525) Maranzano、Rozsypal 等人的实践和经验。

此外，一位同事推荐了 Springer 的一套书，尽管我自己没有检查过这些书：

*   Springer[的企业工程系列](http://www.springer.com/series/8371?detailsPage=titles)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T14:22:33.970

需要考虑的其他几点：

*   是否确定了所有利益相关者？（示例：客户、最终用户、业务分析师、用户界面设计人员、开发人员、测试人员、维护人员。）架构是否与利益相关者一起验证？
*   该架构如何解决安全问题？
*   是否规定了对可用性和可靠性的要求？架构如何解决这些问题？（例如：平均故障间隔时间、平均修复时间。）
*   灾难恢复如何处理？

有更多想法的两本好书：

*   Nick Rozanski 和 Eóin Woods 的[软件系统架构](https://rads.stackoverflow.com/amzn/click/com/0321112296)
*   Len Bass、Paul Clements 和 Rick Kazman 的[软件架构实践](https://rads.stackoverflow.com/amzn/click/com/0321154959)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T06:50:45.587

# 你将如何测试它

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T07:29:18.317

它是否使用 SOLID 原则？

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T19:59:04.407

架构是否符合技术供应商的指导和路线图？

您想从您选择的平台获得支持，而不是与之抗争。

例如，对于以 Microsoft 为中心的解决方案，这意味着记录您的选择在何处以及为何偏离[Microsoft 体系结构指南](http://www.codeplex.com/AppArch)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-01T01:15:08.797

是否有一个人可以负责架构，具有足够的（1）所提议架构的技术知识，（2）管理事物的经验，（3）站在公司中，这样他的决定就不会被不知道的管理层推翻什么都不知道。

由于（2）和（3）并不真正依赖于架构，我会找到这个人并问他想做什么。

现在假设你是那个人（这从你的问题中并不明显——只有当你认为你仍然会在一段时间内担任这件事的首席架构师时才适用），我会接受[Joel On Software 的建议写博客](http://www.joelonsoftware.com/articles/fog0000000036.html)并编写设计规范，包括计划、目标、客户、解释设计选择等。那应该清除视图。

## 后来的想法

我试着想一想在你写完规范之后你可能会问自己什么确切的问题，比如“更新你的项目容易吗”、“它是否允许最终目标的灵活性”、“它会让事情变得容易吗？”支持”，“是否有任何安全问题”等，但是，尽管提出这样的问题是值得的，但我根本看不到它们可以用于任何“评估”，因为除了过滤掉明显的错误我认为任何*具体*问题都不会对“评估架构”有多大帮助。也许您的问题会从改写中受益？

# perl - Perl 的 Text::Table 的输出是否有解析器？

> ID：929135
> 
> 赞同：1
> 
> 时间：2009-05-30T06:08:05.923
> 
> 标签：perl, parsing

假设我有一堆用[Text::Table](http://search.cpan.org/~anno/Text-Table-1.114/lib/Text/Table.pm)创建的表。是否存在将它们转换回 Perl 数据结构的解析器，还是我必须自己编写？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T13:11:28.547

Text::Table 是一个用于创建数据表示的模块。如果它旨在用于存储和检索（即文件格式），它将包括解析现有表的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T18:01:31.240

好像有点绕。如果您在将其转换为表格之前已经获得了信息，那么为什么要尝试从其呈现形式中解析它呢？这就像拥有一个文本文件，将其转换为乳胶，然后转换为 postscript，然后尝试从 postscript 文件中获取文本。

我确信有一种方法可以解析 Text::Table 的输出，但您的工作流程似乎有缺陷；我的目标是使用更简单的数据输出（除了 Text::Table，如果你真的必须这样的话），比如 YAML，然后可以轻松地恢复到原始数据结构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T10:47:15.283

通过在 Google 上进行 'site:search.cpan.org "Text::Table" parse' 搜索，我没有找到用于此目的的模块。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T06:25:48.523

为什么不使用 CSV？

如果您有许多不同长度的列，CSV 在人类可读性方面并不是很好，但它可以在紧要关头完成。

CSV 的好处是任何电子表格（以及许多其他工具）都会以一种友好、友好的方式解析和显示 CSV。

**更新**

布莱恩，

根据上述 OP 的评论：

> 客户需要一种人类和机器可读的表格数据格式。——霍勒斯·勒布 5 月 31 日 3:26

我得出的结论是，他可以控制生产代码作为消费代码。

我的回答实际上是在回答“我可以使用什么格式既可以人类又可以机器读取？”这个问题。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-30T22:13:31.883

您可以在输出之前将它们作为 Perl 本身保存。这样，您打印过的任何内容都可以按需重新打印。请参阅[Storable](http://search.cpan.org/perldoc?Storable) --or [YAML::Syck](http://search.cpan.org/perldoc?YAML::Syck)，这会将其转储到 YAML 中。

一旦你有了[Storable](http://search.cpan.org/perldoc?Storable)的格式，你可能

1.  读入文件
2.  有一些标准格式来检查请求的更改。
3.  改了就写回来。

但是，使用 YAML，只需修改 YAML 文件就足够简单了。

[为Text::Table](http://search.cpan.org/perldoc?Text::Table)给出的示例的 YAML如下所示：

```
--- !!perl/hash:Text::Table 
blank: ~
cols: 
  - 
    - Mercury
    - Venus
    - Earth
    - Jupiter
  - 
    - 2360
    - 6110
    - 6378
    - 71030
  - 
    - 3.7
    - 5.1
    - 5.52
    - 1.3
forms: 
  - "%s %s %s"
  - "%s %s %s"
lines: ~
spec: 
  - 
    align: auto
    align_title: left
    align_title_lines: left
    sample: []

    title: 
      - Planet
  - 
    align: auto
    align_title: left
    align_title_lines: left
    sample: []

    title: 
      - Radius
      - km
  - 
    align: auto
    align_title: left
    align_title_lines: left
    sample: []

    title: 
      - Density
      - g/cm^3
titles: 
  - 
    - Planet
    - "      "
  - 
    - Radius
    - "km    "
  - 
    - Density
    - "g/cm^3 " 
```

# .net - Ironpython 控制台立即消失

> ID：929141
> 
> 赞同：0
> 
> 时间：2009-05-30T06:13:11.077
> 
> 标签：.net, .net-2.0, ironpython

我在 windows xp 专业版中安装了 ironpython 2.0，它需要 .Net framework 2.0 service pack 2 或更高版本。窗户盒有它。但是控制台仍然消失了。他们中的任何一个都有问题。

需要帮忙？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T23:49:13.360

同样的结果

Iropython 需要 .NET 2.0 sp1 或更高版本

实际上没有错误...

我想 Ironpython 没有找到它应该在的 .Net 库。

如果控制面板\添加删除程序显示 .Net 框架，这是否意味着它们已安装。我在问这个问题，因为在论坛上没有人谈论过检查控制面板的事情；但是，他们要么谈论检查 Registry 或 %systemroot%\Microsoft .net\Framework 并检查相应版本文件夹中的 Mscorlib.dll。

好吧，我找到了.net 2.0 和.net 1.1 的.dll 文件，但没有找到.net 3.0 如果没有安装.net 3.0，那么ironpython 失败的原因是没有安装.net 2.0 的sp1。

另外，我检查了 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft.NETFramework\policy\v2.0 的注册表信息，发现安装了 .NEt 2.0，原始版本

但是，我在 .NETFramework 文件夹中找到了 .net 3.0，但在策略文件夹中没有。在那个文件夹中，没有像 v3.0 这样的文件夹，其中的值是这样设置的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T16:08:43.187

我找到了路……

.NET 2.0 和 .Net 3.0 没有 SP1。

因此，任何一个带有 SP1 的 .Net 版本都会使 Ironpython 工作...... yippee

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T06:47:59.070

如果您打开命令提示符并从那里运行 ipy 会发生什么？

运行（从命令提示符） ipy -X:ExceptionDetail 这有望提供更多信息。

还可以在 Windows 事件日志（应用程序）中查看与 IPY 相关的任何错误。

**更新**如果您没有记录错误，请尝试运行另一个 .Net 程序以查看它是否是一般问题。卸载框架并重新安装框架将是下一步尝试。

干杯，

戴维

# vb.net - 如何在 VB.net 中指定 volatile 的等价物？

> ID：929146
> 
> 赞同：7
> 
> 时间：2009-05-30T06:15:52.163
> 
> 标签：vb.net, multithreading, volatile, lock-free

我正在尝试编写用于消息传递的调用队列的无锁版本。这不是什么严肃的事情，只是为了了解线程。

我相对确定我的代码是正确的，除非指令被重新排序或在寄存器中完成。我知道我可以使用内存屏障来停止重新排序，但是如何确保立即将值写入内存？

```
Public Class CallQueue
    Private first As New Node(Nothing) 'owned by consumer'
    Private last As Node = first 'owned by producers'
    Private Class Node
        Public ReadOnly action As Action
        Public [next] As Node
        Public Sub New(ByVal action As Action)
            Me.action = action
        End Sub
    End Class

    Private _running As Integer
    Private Function TryAcquireConsumer() As Boolean
        Threading.Thread.MemoryBarrier()

        'Dont bother acquiring if there are no items to consume'
        'This unsafe check is alright because enqueuers call this method, so we never end up with a non-empty idle queue'
        If first.next Is Nothing Then Return False

        Threading.Thread.MemoryBarrier()

        'Try to acquire'
        Return Threading.Interlocked.Exchange(_running, 1) = 0
    End Function
    Private Function TryReleaseConsumer() As Boolean
        Do
            Threading.Thread.MemoryBarrier()

            'Dont release while there are still things to consume'
            If first.next IsNot Nothing Then Return False

            Threading.Thread.MemoryBarrier()

            'Release'
            _running = 0

            Threading.Thread.MemoryBarrier()

            'It is possible that a new item was queued between the first.next check and releasing'
            'Therefore it is necessary to check if we can re-acquire in order to guarantee we dont leave a non-empty queue idle'
            If Not TryAcquireConsumer() Then Return True
        Loop
    End Function

    Public Sub QueueAction(ByVal action As Action)
        'Enqueue'
        'Essentially, this works because each node is returned by InterLocked.Exchange *exactly once*'
        'Each node has its .next property set exactly once, and also each node is targeted by .next exactly once, so they end up forming a valid tail'
        Dim n = New Node(action)
        Threading.Interlocked.Exchange(last, n).next = n

        'Start the consumer thread if it is not already running'
        If TryAcquireConsumer() Then
            Call New Threading.Thread(Sub() Consume()).Start()
        End If
    End Sub
    Private Sub Consume()
        'Run until queue is empty'
        Do Until TryReleaseConsumer()
            first = first.next
            Call first.action()
        Loop
    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-30T08:27:37.280

在 VB.NET 中没有 C#`volatile`关键字的等效项。相反，通常推荐使用[MemoryBarrier](http://msdn.microsoft.com/en-us/library/system.threading.thread.memorybarrier.aspx)。辅助方法也可以写成：

```
Function VolatileRead(Of T)(ByRef Address As T) As T
    VolatileRead = Address
    Threading.Thread.MemoryBarrier()
End Function

Sub VolatileWrite(Of T)(ByRef Address As T, ByVal Value As T)
    Threading.Thread.MemoryBarrier()
    Address = Value
End Sub 
```

还有一篇关于这个主题的有用的博客[文章。](http://www.panopticoncentral.net/archive/2004/09/30/1721.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-11-09T00:36:48.457

使用`Thread.VolatileRead()`和`VolatileWrite()`方法来自 BCL。

[http://msdn.microsoft.com/en-us/library/system.threading.thread.volatileread.aspx](http://msdn.microsoft.com/en-us/library/system.threading.thread.volatileread.aspx)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-08-16T06:15:16.510

从 .NET 4.5 开始，他们向 BCL 添加了两个新方法来模拟`volatile`关键字：[Volatile.Read](https://msdn.microsoft.com/en-us/library/gg712891.aspx)和[Volatile.Write](https://msdn.microsoft.com/en-us/library/gg712814.aspx)。它们应该完全等同于读/写一个`volatile`字段。您可以清楚地在 VB.NET 中使用它们。它们比/*更好*（*更好*==*更快*），因为它们使用半栅栏而不是全栅栏。`Thread.VolatileRead``Thread.VolatileWrite`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-30T06:57:00.707

我不是这方面的专家，所以如果我错了，希望其他人能纠正我。据我了解，内存优化问题目前是理论上的问题，不一定会在现实中发生。但是话虽如此，我认为通过使用 Interlocked API 进行内存访问（无论 MemoryBarrier 是什么），您都不会受到影响。

不幸的是，在 VB.NET 中没有 volatile 的等价物。它不是用普通属性修饰的，而是一个特殊的编译器生成的修饰符。您需要使用反射来发出具有这种字段的类型。

这是我在对 .NET 框架中的线程有疑问时经常参考的资源。它很长，但希望你会发现它很有用。

[http://www.yoda.arachsys.com/csharp/threads/printable.shtml](http://www.yoda.arachsys.com/csharp/threads/printable.shtml)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-06-20T11:42:11.877

Mono.Cecil 阅读器代码将 FieldType 设为 RequiredModifierType，ModifierType 设为 System.Runtime.CompilerServices.IsVolatile。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-12-20T16:52:13.097

您还可以使用 Thread.VolatileRead() 和 Thread.VolatileWrite() 为“Volatile”编写一个属性，并使用该属性创建所有属性/变量，例如：

```
<Volatile()>
Protected Property SecondsRemaining as Integer 
```

在某个地方写了这个，但现在似乎找不到它......

# php - 使用 PHP 在数组中交替大写字母

> ID：929148
> 
> 赞同：0
> 
> 时间：2009-05-30T06:17:17.230
> 
> 标签：php, arrays

我有一个如下所示的字母数字字符串，

```
$string_1 = "a4nas60dj71wiena15sdl1131kg12b" 
```

并想将其更改为如下所示，

```
$string_2 = "a4NaS60dJ71wIeNa15Sdl1131Kg12B" 
```

我该怎么做呢？我已经尝试了下面的代码，但它不起作用。

```
$lenght = strlen($string_1);

for ( $i = 0; $i <= $length - 1; $i += 1) {

    if ( $i % 2) {

        $string_2[$i]=strtoupper($string_1[$i]);

    }

    else {

        $string_2[$i]=$string_1[$i];

    }

}

echo $string_2; 
```

上面的代码打印出“Array”，所以肯定有什么不工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T06:27:12.030

顺便说一句，你的大写字符串有一个小错误：

```
$string_1: a4nas60dj71wiena15sdl1131kg12b
$string_2: a4NaS60dJ71wIeNa15Sdl1131Kg12B
                               ^ should be capital so out of sync for rest of string 
```

我会给你两种方法：

```
<?php
header('Content-Type: text/plain');

$string_1 = "a4nas60dj71wiena15sdl1131kg12b";
$string_2 = "a4NaS60dJ71wIeNa15Sdl1131Kg12B";

$letter_count = 0;
$result = '';
for ($i=0; $i<strlen($string_1); $i++) {
    if (!preg_match('![a-zA-Z]!', $string_1[$i])) {
        $result .= $string_1[$i];
    } else if ($letter_count++ & 1) {
        $result .= strtoupper($string_1[$i]);
    } else {
        $result .= $string_1[$i];
    }
}

$result2 = preg_replace_callback('!([a-zA-Z]\d*)([a-zA-Z])!', 'convert_to_upper', $string_1);

function convert_to_upper($matches) {
    return strtolower($matches[1]) . strtoupper($matches[2]);
}

echo "$string_1\n";
echo "$string_2\n";
echo "$result\n";
echo "$result2\n";
?> 
```

**注意：**上面做了几个假设：

1.  字符串中可以有数字和字母以外的字符；
2.  无论原始大小如何，您都想替换大小写（例如“ASDF”变为“aSdF”）；
3.  您将每隔一个字母大写，而不是每隔一个小写字母。

如果这些假设不正确，则可以更改上述内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T06:28:47.800

字符串不是数组，您将 $string_2 声明为数组...

不过，您的代码不会像预期的那样工作，因为您会交替使用每个其他*字母*的大小写，而忽略数字

尝试以下操作：

```
function altCaps($str) {
    $lower = true;
    $str2 = "";
    for ($i=0;$len=strlen($str);$i<$len;++$i) {
        $char = substr($str,$i,1);
        if (is_numeric($char)) {
            $str2 .= $char;
        } else {
            if ($lower) {
                $str2 .= strtolower($char);
            } else {
                $str2 .= strtolower($char);
            }
            $lower = !$lower;
        }
    }
    return $str2;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T06:29:40.233

你应该很好地使用这个功能。只需调用**alternate('string here');** 它会完美地工作。

这适用于字符串中包含的连字符、空格、句点等。

```
function alternate($string1)
{
    $do_caps = false;
    $string2 = '';
    for ($i = 0; $i < strlen($string1); $i++)
    {
      $char = substr($string1, $i, 1);
      if (stripos('abcdefghijklmnopqrstuvwxyz', $char) !== false)
      {
            if ($do_caps)
            {
                $char = strtoupper($char);
                $do_caps = false;
            }
            else
            {
                $do_caps = true;
            }
      }
      $string2 .= $char;
    }
    return $string2;
} 
```

# asp.net - 如何改进您的 Web 应用程序

> ID：929151
> 
> 赞同：1
> 
> 时间：2009-05-30T06:19:13.683
> 
> 标签：asp.net, web-applications

我想做得更好，我想听听您的意见，将其添加到 Web 应用程序有什么好处，什么最坏。

我做了很多 ASP.NET 应用程序，特别是在 CRM 应用程序中运行。就像在用户中完成蜜蜂一样，我们会“忘记”它，直到我们收到一封电子邮件:)

这个问题是针对商业的免费网络应用程序。以及下面的所有想法，**我将免费分享我的源代码**。

目前我只有一些想法并实施了其他想法，例如：

*   如果您将 &debug=y 添加到查询字符串，我将显示一个调试窗口，其中包含所有调用的查询和过程

[替代文字 http://www.balexandre.com/temp/WebApp_DebugInfo.png](http://www.balexandre.com/temp/WebApp_DebugInfo.png)

*   使用 global.asax 我向用户显示了一个更好的错误消息，而不是原始的 ASP.NET 错误窗口（这是开发人员版本，用户版本没有堆栈跟踪信息）

[替代文字 http://www.balexandre.com/temp/WebApp_errorMsg.png](http://www.balexandre.com/temp/WebApp_errorMsg.png)

*   我使用 jQuery 和 Web 服务创建了一个简单的链接，该链接将显示 Web 应用程序的当前版本以及是否是最新版本。

*   昨天我从[Scotts博客中读到了关于](http://scottonwriting.net/sowblog/posts/13845.aspx)[ELMAH](http://code.google.com/p/elmah/)的信息，我将尝试进行设置，以便将电子邮件发送到一个特殊地址，以改进和修复可能发生的任何错误......

你们有什么建议？什么可以被视为部署 Web 应用程序的“标准”...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T06:35:33.823

除了通过 querystring 参数显示所有查询信息之外，我喜欢您所做的一切。我建议该功能仅在开发人员的调试模式下可用。服务器或类似的东西。否则可能会带来很大的安全风险。

我还看到您发布的查询（底部第三行）以

```
where <some field> = 582 
```

使用参数化查询而不是字符串连接是个好主意。它让您面临一系列令人讨厌的问题，例如性能下降和 sql 注入攻击。如果您使用参数化查询，那将消失。

希望我为您的“标准”增加了一些价值。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T06:37:52.710

“如果您将 &debug=y 添加到查询字符串中，我将显示一个调试窗口，其中包含所有调用的查询和过程”

现在，通常我是通过默默无闻来*批评*安全性的人，但这是一个非常糟糕的主意。没有理由像这样完全公开您的实现。如果你在生产服务器上启用了这个调试选项，你最多应该登录到一个内部文件。

您的“有用”回溯错误消息也是如此。此信息受到限制是有原因的。

甚至版本链接也可以被认为是一个漏洞。例如，请参阅[这篇 Wordpress 文章](http://codex.wordpress.org/Hardening_WordPress)，该文章建议不要发布您正在使用的 Wordpress 版本，因为过去存在大量漏洞，而且人们升级速度非常慢。

# iphone - 动态信息屏幕

> ID：929155
> 
> 赞同：1
> 
> 时间：2009-05-30T06:19:53.230
> 
> 标签：iphone, screen

如果互联网连接可用，我正在尝试找到一种方法让我的应用程序上的信息屏幕从网上下载（这样我就可以定期更新它）。如果互联网不可用，它应该使用默认或最后下载的。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T09:00:35.717

请注意，上面 James Skitmore 提供的方法是测试连接性的糟糕方法。*请*不要**使用**它。它会不必要地加载 google.com，如果网络不可用，它会导致超时，这会使您的应用看起来像已冻结。

这是检查网络连接的方法。

在您的应用程序中，您可以执行此操作来检查网络是否可用：

```
if (![[UIDevice currentDevice] networkAvailable]) 
```

您现在还可以检查与某个主机的连接，例如 yourwebsite.com，或者您可以检查连接类型、3G 与 Wifi 等。我将通过阅读头文件让您自己弄清楚。

您需要在您的应用程序中包含以下文件：（由 Erica Sadun 提供）

UIDevice-Reachability.h

```
/*
 Erica Sadun, http://ericasadun.com
 iPhone Developer's Cookbook, 3.0 Edition
 BSD License for anything not specifically marked as developed by a third party.
 Zach Waugh and Apple's code excluded.
 Use at your own risk
 */

#import <UIKit/UIKit.h>

#define SUPPORTS_UNDOCUMENTED_API   1

@interface UIDevice (Reachability)
- (NSString *) hostname;

- (NSString *) localWiFiIPAddress;
- (NSString *) localIPAddress;
- (NSString *) whatismyipdotcom;

- (BOOL) activeWLAN;
- (BOOL) addressFromString:(NSString *)IPAddress address:(struct sockaddr_in *)address; // via Apple
- (void) forceWWAN; // via Apple
- (void) shutdownWWAN; // via Apple
@end

// Methods which rely on undocumented API methods 
#if SUPPORTS_UNDOCUMENTED_API

@interface UIDevice (UIDevice_Undocumented_Reachability)
- (BOOL) networkAvailable;
- (BOOL) activeWWAN;
@end

#endif // SUPPORTS_UNDOCUMENTED_API 
```

UIDevice-Reachability.m

```
/*
 Erica Sadun, http://ericasadun.com
 iPhone Developer's Cookbook, 3.0 Edition
 BSD License for anything not specifically marked as developed by a third party.
 Apple's code excluded.
 Use at your own risk
 */

// TTD: Add async version of whatsmyip -- thanks rpetrich

#include <unistd.h>
#include <sys/sysctl.h>
#include <arpa/inet.h>
#include <netdb.h>
#include <net/if.h>
#include <net/if_dl.h>
#include <netinet/in.h>
#include <ifaddrs.h>

#import "UIDevice-Reachability.h"
#import "wwanconnect.h"

@implementation UIDevice (Reachability)

#pragma mark host and ip utils
- (NSString *) hostname
{
    char baseHostName[255];
    int success = gethostname(baseHostName, 255);
    if (success != 0) return nil;
    baseHostName[255] = '\0';

#if !TARGET_IPHONE_SIMULATOR
    return [NSString stringWithFormat:@"%s.local", baseHostName];
#else
    return [NSString stringWithFormat:@"%s", baseHostName];
#endif
}

// Direct from Apple. Thank you Apple
- (BOOL)addressFromString:(NSString *)IPAddress address:(struct sockaddr_in *)address
{
    if (!IPAddress || ![IPAddress length]) {
        return NO;
    }

    memset((char *) address, sizeof(struct sockaddr_in), 0);
    address->sin_family = AF_INET;
    address->sin_len = sizeof(struct sockaddr_in);

    int conversionResult = inet_aton([IPAddress UTF8String], &address->sin_addr);
    if (conversionResult == 0) {
        NSAssert1(conversionResult != 1, @"Failed to convert the IP address string into a sockaddr_in: %@", IPAddress);
        return NO;
    }

    return YES;
}

- (NSString *) getIPAddressForHost: (NSString *) theHost
{
    struct hostent *host = gethostbyname([theHost UTF8String]);

    if (host == NULL) {
        herror("resolv");
        return NULL;
    }

    struct in_addr **list = (struct in_addr **)host->h_addr_list;
    NSString *addressString = [NSString stringWithCString:inet_ntoa(*list[0])];
    return addressString;
}

#if ! defined(IFT_ETHER)
#define IFT_ETHER 0x6   // Ethernet CSMACD
#endif

// Matt Brown's get WiFi IP addy solution
// Author gave permission to use in Cookbook under cookbook license
// http://mattbsoftware.blogspot.com/2009/04/how-to-get-ip-address-of-iphone-os-v221.html
- (NSString *) localWiFiIPAddress
{
    BOOL success;
    struct ifaddrs * addrs;
    const struct ifaddrs * cursor;

    success = getifaddrs(&addrs) == 0;
    if (success) {
        cursor = addrs;
        while (cursor != NULL) {
            // the second test keeps from picking up the loopback address
            if (cursor->ifa_addr->sa_family == AF_INET && (cursor->ifa_flags & IFF_LOOPBACK) == 0) 
            {
                NSString *name = [NSString stringWithUTF8String:cursor->ifa_name];
                if ([name isEqualToString:@"en0"]) { // found the WiFi adapter
                    return [NSString stringWithUTF8String:inet_ntoa(((struct sockaddr_in *)cursor->ifa_addr)->sin_addr)];
                }
            }
            cursor = cursor->ifa_next;
        }
        freeifaddrs(addrs);
    }
    return nil;
}

// Return the local IP address
- (NSString *) localIPAddress
{
    struct hostent *host = gethostbyname([[self hostname] UTF8String]);
    if (host == NULL)
    {
        herror("resolv");
        return nil;
    }
    else {
        struct in_addr **list = (struct in_addr **)host->h_addr_list;
        return [NSString stringWithCString:inet_ntoa(*list[0])];
    }
    return nil;
}

- (NSString *) whatismyipdotcom
{
    NSError *error;
    NSURL *ipURL = [NSURL URLWithString:@"http://www.whatismyip.com/automation/n09230945.asp"];
    NSString *ip = [NSString stringWithContentsOfURL:ipURL encoding:1 error:&error];
    if (!ip) return [error localizedDescription];
    return ip;
}

- (BOOL) activeWLAN
{
    return ([self localWiFiIPAddress] != nil);
}

#pragma mark Forcing WWAN connection

MyStreamInfoPtr myInfoPtr;

static void myClientCallback(void *refCon)
{
    int  *val = (int*)refCon;
    printf("myClientCallback entered - value from refCon is %d\n", *val);
}

- (void) forceWWAN
{
    int value = 0;
    myInfoPtr = (MyStreamInfoPtr) StartWWAN(myClientCallback, &value);
    if (myInfoPtr)  
    {
        printf("Started WWAN\n");
    }
    else
    {
        printf("Failed to start WWAN\n");
    }
}

- (void) shutdownWWAN
{
    if (myInfoPtr) StopWWAN((MyInfoRef) myInfoPtr);
}
@end

#if SUPPORTS_UNDOCUMENTED_API
@implementation UIDevice (UIDevice_Undocumented_Reachability)
- (BOOL) networkAvailable
{
    // Unavailable has only one address: 127.0.0.1
    return !(([[[NSHost currentHost] addresses] count] == 1) && [[self localIPAddress] isEqualToString:@"127.0.0.1"]);
}

- (BOOL) activeWWAN
{
    return ([self networkAvailable] && ![self localWiFiIPAddress]);
}
@end
#endif  // SUPPORTS_UNDOCUMENTED_API 
```

wwanconnect.h

```
// Direct from Apple. Thank you Apple

#if !defined(__WWAN_CONNECT__)
#define __WWAN_CONNECT__    1

#include <CoreFoundation/CoreFoundation.h>
#include <assert.h>

#define kTestHost   "www.whatismyip.com"
#define kTestPort   80      

typedef void (*ConnectClientCallBack)(void *refCon);

struct MyStreamInfoStruct{
    CFWriteStreamRef        wStreamRef;
    CFReadStreamRef         rStreamRef;
    ConnectClientCallBack   clientCB;
    void                    *refCon;
    CFStreamError           error;
    Boolean                 errorOccurred;
    Boolean                 isConnected;
    Boolean                 isStreamInitd;
    Boolean                 isClientSet;
};

typedef struct MyStreamInfoStruct MyStreamInfo;
typedef struct MyStreamInfoStruct *MyStreamInfoPtr;
typedef struct __MyInfoRef *MyInfoRef;

/*
 *  StartWWAN()
 *  
 *  Discussion:
 *    This function will initiate a Wireless Wide Area Network (WWAN)
 *     connection by using the CFSocketStream API to connect with a 
 *     server system defined by kTestHost:kTestPort above.
 *     No communications are expected to happen over the CFSocketStream
 *     connection.
 *  
 *    clientCB:
 *     if the connection is opened, the callback routine, if not NULL
 *     will be called. function defintion - see ConnectClientCallBack above
 *     
 *    refCon:
 *     if a client callback, clientCB is defined, then the refCon
 *      parameter will be the argument to the client callback
 *
 *    return:
 *     if the WWAN connection is successful, a MyInfoRef value is returned
 *     The MyInfoRef value must be passed to StopWWAN to stop the WWAN
 *     connection.
 *     A NULL result indicates that the connection was unsuccessful
 *    
 */
extern MyInfoRef StartWWAN(ConnectClientCallBack clientCB, void *refCon);

/*
 *  StopWWAN()
 *  
 *  Discussion:
 *    This function closes the CFSocketStream which was used to establish the
 *    WWAN connection. Once the WWAN connection has been started, BSD
 *    network functions can be used to communicate across the WWAN connection.
 *    As of the writing of this sample, there is no guarantee that the use of
 *    only BSD socket API's will maintain the WWAN connection.
 *  
 *    infoRef:
 *     pass in the MyInfoRef result from the StartWWAN function.
 *     
 */

extern void StopWWAN(MyInfoRef infoRef);

#endif // __WWAN_CONNECT__ 
```

wwanconnect.c

```
// Direct from Apple. Thank you Apple

#include "wwanconnect.h"
#include <CFNetwork/CFSocketStream.h>
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <unistd.h>
#include <ifaddrs.h>
#include <stdio.h>

static Boolean TestGetIFAddrs(void);
static void MyCFWriteStreamClientCallBack(CFWriteStreamRef stream, CFStreamEventType type, void *clientCallBackInfo);
static void CleanupAfterWAAN(MyStreamInfoPtr myInfoPtr);
static void CloseStreams(MyStreamInfoPtr myInfoPtr);

static Boolean TestGetIFAddrs(void)
{
    int             result;
    struct  ifaddrs *ifbase, *ifiterator;
    int             done = 0;
    Boolean         addrFound = FALSE;
    char            loopbackname[] = "lo0/0";

    result = getifaddrs(&ifbase);
    ifiterator = ifbase;
    while (!done && (ifiterator != NULL))
    {
        if (ifiterator->ifa_addr->sa_family == AF_INET)
        {
            if (memcmp(ifiterator->ifa_name, loopbackname, 3))
            {
                struct  sockaddr *saddr, *netmask, *daddr;
                saddr = ifiterator->ifa_addr;
                netmask = ifiterator->ifa_netmask;
                daddr = ifiterator->ifa_dstaddr;

                // we've found an entry for the IP address
                struct sockaddr_in  *iaddr;
                char                addrstr[64];
                iaddr = (struct sockaddr_in *)saddr;
                inet_ntop(saddr->sa_family, &iaddr->sin_addr, addrstr, sizeof(addrstr));
                fprintf(stderr, "ipv4 interface name %s, source IP addr %s ", ifiterator->ifa_name, addrstr);

                iaddr = (struct sockaddr_in *)netmask;
                if (iaddr)
                {
                    inet_ntop(saddr->sa_family, &iaddr->sin_addr, addrstr, sizeof(addrstr));
                    fprintf(stderr, "netmask IP addr %s ", addrstr);
                }

                iaddr = (struct sockaddr_in *)daddr;
                if (iaddr)
                {
                    inet_ntop(saddr->sa_family, &iaddr->sin_addr, addrstr, sizeof(addrstr));
                    fprintf(stderr, "dest/broadcast IP addr %s.\n\n", addrstr);
                }
                return TRUE;
            }

        }
        else if (ifiterator->ifa_addr->sa_family == AF_INET6)
        {
            // we've found an entry for the IP address
            struct sockaddr_in6 *iaddr6 = (struct sockaddr_in6 *)ifiterator->ifa_addr;
            char                addrstr[256];
            inet_ntop(ifiterator->ifa_addr->sa_family, iaddr6, addrstr, sizeof(addrstr));
            fprintf(stderr, "ipv6 interface name %s, source IP addr %s \n\n", ifiterator->ifa_name, addrstr);
        }
        ifiterator = ifiterator->ifa_next;
    }
    if (ifbase)
        freeifaddrs(ifbase);    /* done with the memory allocated by getifaddrs */

    return addrFound;
}

static void MyCFWriteStreamClientCallBack(CFWriteStreamRef stream, CFStreamEventType type, void *clientCallBackInfo)
{
    MyStreamInfoPtr myInfoPtr = (MyStreamInfoPtr) clientCallBackInfo;

    printf("MyCFWriteStreamClientCallBack entered - event is %d\n", type);

    switch (type)
    {
        case kCFStreamEventOpenCompleted:
            myInfoPtr->isConnected = TRUE;
            TestGetIFAddrs();       // call the test function to return the local ip address associated with this connection.
            if (myInfoPtr->clientCB)
            {
                // call client callback routine
                myInfoPtr->clientCB(myInfoPtr->refCon);
            }
            printf("write stream connected\n");
            break;

        case kCFStreamEventErrorOccurred:
            myInfoPtr->errorOccurred = TRUE;
            myInfoPtr->error = CFWriteStreamGetError(myInfoPtr->wStreamRef);
            printf("write stream error %d .. giving up\n", myInfoPtr->error.error);
            break;

        default:
            printf("event type %d occurred\n");
            break;
    }
    // stop the run loop at this point
    CFRunLoopStop(CFRunLoopGetCurrent());
}

extern MyInfoRef StartWWAN(ConnectClientCallBack clientCB, void *refCon)
{ 
    char                        host[] = kTestHost;
    int                         portNum = kTestPort;
    CFDataRef                   addressData;
    MyStreamInfoPtr             myInfoPtr;
    CFStreamClientContext       ctxt = {0, NULL, NULL, NULL, NULL};
    Boolean                     errorOccurred = FALSE;

    myInfoPtr = malloc(sizeof(MyStreamInfo));
    if (!myInfoPtr)
    {
        return NULL;
    }

    // init the allocated memory
    memset(myInfoPtr, 0, sizeof(MyStreamInfo));
    myInfoPtr->clientCB = clientCB;
    myInfoPtr->refCon = refCon; 
    ctxt.info = myInfoPtr;

    // Check for a dotted-quad address, if so skip any host lookups 
    in_addr_t addr = inet_addr(host); 
    if (addr != INADDR_NONE) { 
        // Create the streams from numberical host 
        struct sockaddr_in sin; 
        memset(&sin, 0, sizeof(sin)); 

        sin.sin_len= sizeof(sin); 
        sin.sin_family = AF_INET; 
        sin.sin_addr.s_addr = addr; 
        sin.sin_port = htons(portNum); 

        addressData = CFDataCreate(NULL, (UInt8 *)&sin, sizeof(sin)); 
        CFSocketSignature sig = { AF_INET, SOCK_STREAM, IPPROTO_TCP, addressData }; 

        // Create the streams. 
        CFStreamCreatePairWithPeerSocketSignature(kCFAllocatorDefault, &sig, &(myInfoPtr->rStreamRef), &(myInfoPtr->wStreamRef));       
        CFRelease(addressData); 
    } else { 
        // Create the streams from ascii host name 
        CFStringRef hostStr = CFStringCreateWithCStringNoCopy(kCFAllocatorDefault, host, kCFStringEncodingUTF8, kCFAllocatorNull); 
        CFStreamCreatePairWithSocketToHost(kCFAllocatorDefault, hostStr, portNum, &(myInfoPtr->rStreamRef), &(myInfoPtr->wStreamRef)); 
    } 

    myInfoPtr->isConnected = FALSE;
    myInfoPtr->isStreamInitd = TRUE;
    myInfoPtr->isClientSet = FALSE;

    // Inform the streams to kill the socket when it is done with it. 
    // This effects the write stream too since the pair shares the 
    // one socket. 
    CFWriteStreamSetProperty(myInfoPtr->wStreamRef, kCFStreamPropertyShouldCloseNativeSocket, kCFBooleanTrue); 

    // set up the client
    if (!CFWriteStreamSetClient(myInfoPtr->wStreamRef, kCFStreamEventOpenCompleted | kCFStreamEventErrorOccurred | kCFStreamEventEndEncountered, 
                                MyCFWriteStreamClientCallBack, &ctxt))
    {
        printf("CFWriteStreamSetClient failed\n");
        errorOccurred = TRUE;
    }
    else
        myInfoPtr->isClientSet = TRUE;

    if (!errorOccurred)
    {
        // schedule the stream
        CFWriteStreamScheduleWithRunLoop(myInfoPtr->wStreamRef, CFRunLoopGetCurrent(), kCFRunLoopCommonModes);

        // Try to open the stream.
        if (!CFWriteStreamOpen(myInfoPtr->wStreamRef))
        {
            printf("CFWriteStreamOpen failed\n");
            errorOccurred = TRUE;
        }
    }

    if (!errorOccurred)
    {
        // everything worked so far, so run the runloop - when the callback gets called, it will stop the run loop
        printf("CFWriteStreamOpen returned with no error - calling CFRunLoopRun\n");
        CFRunLoopRun();
        if (myInfoPtr->errorOccurred)
            errorOccurred = TRUE;
        printf("after CFRunLoopRun - returning\n");
    }

    if (errorOccurred)
    {
        myInfoPtr->isConnected = FALSE;
        CleanupAfterWAAN(myInfoPtr);
        CloseStreams(myInfoPtr);

        if (myInfoPtr->isStreamInitd)
        {
            CFRelease(myInfoPtr->rStreamRef);
            CFRelease(myInfoPtr->wStreamRef);
            myInfoPtr->isStreamInitd = FALSE;
        }
        free(myInfoPtr);
        return NULL;
    }
    return (MyInfoRef)myInfoPtr;
} 

static void CleanupAfterWAAN(MyStreamInfoPtr myInfoPtr)
{
    assert(myInfoPtr != NULL);
    if (myInfoPtr->isClientSet)
    {
        CFWriteStreamSetClient(myInfoPtr->wStreamRef, 0, NULL, NULL);
        CFWriteStreamUnscheduleFromRunLoop(myInfoPtr->wStreamRef, CFRunLoopGetCurrent(), kCFRunLoopCommonModes);
        myInfoPtr->isClientSet = FALSE;
    }
}

static void CloseStreams(MyStreamInfoPtr myInfoPtr)
{
    assert(myInfoPtr != NULL);
    if (myInfoPtr->rStreamRef)
    {
        CFReadStreamClose(myInfoPtr->rStreamRef);
        myInfoPtr->rStreamRef = NULL;
    }
    if (myInfoPtr->wStreamRef)
    {
        CFWriteStreamClose(myInfoPtr->wStreamRef);
        myInfoPtr->wStreamRef = NULL;
    }
}

extern void StopWWAN(MyInfoRef infoRef)
{
    MyStreamInfoPtr myInfoPtr = (MyStreamInfoPtr)infoRef;

    printf("stopWWAN entered\n");
    assert(myInfoPtr != NULL);
    myInfoPtr->isConnected = FALSE;
    CleanupAfterWAAN(myInfoPtr);
    CloseStreams(myInfoPtr);
    free(myInfoPtr);
} 
```

# delphi - Delphi 2006 附带的 Rave Report

> ID：929156
> 
> 赞同：0
> 
> 时间：2009-05-30T06:19:57.257
> 
> 标签：delphi, bde, rave-reports

有一个使用 BDE 进行数据库活动的软件。

该数据库的设计非常笨拙。

我必须构建一些自定义报告，这些报告将使用该软件生成的数据。

我需要根据一些条件跳过一些记录。

例如，如果**Field4**和**Field5** = 0，则不应打印该记录，但如果同一记录的**Field1 > Field2**，则*仅* 应打印**Field1而*****不是***其他字段。

我怎样才能获得这份狂欢报告？

即使在 Rave Report 中，我也尝试在打印前实现这一点，但由于这部分缺乏适当的文档，我无法取得任何进展。如果有人能指出我在哪里可以找到足够的文档和一些如何编程**打印前**和**打印后**事件的示例，我也许可以解决我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T08:17:39.437

你总是可以对你的数据源使用查询，比如（我不知道你的表结构）

```
select distinct * from table where field <> '0' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-12T00:11:04.357

您可以在[此处](http://www.nevrona.com/files/rppro4.pdf)找到旧版本的文档和示例，但它应该与您的版本非常兼容

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-12T04:35:37.390

如果 .rav 未嵌入在可执行文件中（是​​的，这是可能的），您可以修改数据视图并将原始数据视图替换为直接数据库数据视图。因此，如果程序只是触发报告而无需进一步参数化，您可以修改报告......在可视化编辑器和 Nevrona 网站的帮助下，有一些关于 rave 脚本引擎的文档。

当然，Nevrona 需要做更好的文档......

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-30T08:29:28.070

不要为此责备我。我从未使用过 Rave Report，但这可能是您最后的手段。

```
select CASE When (Field4>Field5) Then Field1 Else '' END AS Field1, ..... from Table where (Field4 <> 0 AND Field5<>0) OR (Field1>Field2) 
```

# regex - 在 perl 风格的正则表达式中匹配字符串的其余部分

> ID：929158
> 
> 赞同：4
> 
> 时间：2009-05-30T06:21:17.690
> 
> 标签：regex, pcre

如何在 perl 风格的正则表达式（PCRE）中匹配“已知部分（未知单词）（字符串的其余部分）”的内容？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-30T06:28:31.107

这样的事情应该做：

```
/^KNOWN PART (\w+) (.*)$/ 
```

# php - 为 PHP 中的有效数组获取“foreach 的无效参数”

> ID：929162
> 
> 赞同：1
> 
> 时间：2009-05-30T06:25:17.353
> 
> 标签：php, arrays, foreach

`Invalid argument supplied for foreach()`即使提供的数组似乎是有效数组，我也收到错误消息。这是我的代码：

```
print_r($keywords);
extract($product);
foreach ($keywords as $k=>$v)
{
   //stuff here
} 
```

这是 print_r 的一些输出：

```
Array
(
    [0] => Array
        (
            [text] => vanguard tripod
            [language] => 
            [advertiserCompetitionScale] => 0
            [avgSearchVolume] => -1
            [lastMonthSearchVolume] => -1
        )
    .........
    [39] => Array
        (
            [text] => 63 for sale
            [language] => 
            [advertiserCompetitionScale] => 0
            [avgSearchVolume] => 6600
            [lastMonthSearchVolume] => -1
        )

) 
```

我得到的错误是在我做 foreach 的那一行。

通过对两个相似的数组`$keywords`执行 an 来检索数组。`array_merge`这有什么关系吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T06:29:09.110

是否`$products`包含名为 的元素`keywords`？

如果是这样，`print_r`在`extract`. `extract`可能是这里的问题。

# python - str.startswith() 没有按我的预期工作

> ID：929169
> 
> 赞同：-1
> 
> 时间：2009-05-30T06:27:38.690
> 
> 标签：python, string, python-3.x

我不明白为什么这行不通。我正在对传递给函数的字符串执行 lstrip()，并尝试查看它是否以“””开头。由于某种原因，它陷入了无限循环

```
def find_comment(infile, line):

    line_t = line.lstrip()
    if not line_t.startswith('"""') and not line_t.startswith('#'):
        print (line, end = '')
        return line

    elif line.lstrip().startswith('"""'):
            while True:
                if line.rstrip().endswith('"""'):
                    line = infile.readline()
                    find_comment(infile, line)
                else:
                    line = infile.readline()
    else:
        line = infile.readline()
        find_comment(infile, line) 
```

我的输出：

```
Enter the file name: test.txt
import re
def count_loc(infile): 
```

这是我正在阅读以供参考的文件的顶部：

```
 import re

    def count_loc(infile):
        """ Receives a file and then returns the amount
            of actual lines of code by not counting commented
            or blank lines """

        loc = 0
        func_records = {}
        for line in infile:
        (...) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T06:57:19.507

您没有提供并退出递归循环的路径。return 语句应该可以解决问题。

```
 (...)
    while True:
        if line.rstrip().endswith('"""'):
            line = infile.readline()
            return find_comment(infile, line)
        else:
            line = infile.readline() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T06:49:50.253

`while True`是一个无限循环。完成后，您需`break`要这样做。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T06:32:59.960

```
not line_t.startswith('"""') or not line_t.startswith('#') 
```

无论字符串 line_t 表示什么，此表达式的计算结果都为 True。你想要'and'而不是'or'吗？你的问题我不清楚。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T06:37:58.280

```
if not line_t.startswith('"""') or not line_t.startswith('#'): 
```

这`if`将始终得到满足——要么该行不以 开头`"""`，要么不以`#`（或两者）开头。你可能打算`and`在你使用的地方使用`or`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T07:01:10.747

只要行以注释开头或结尾，下面的代码就可以工作。

但是，请记住，文档字符串可以在一行代码的中间开始或结束。

此外，您需要为三重单引号以及分配给不是真正注释的变量的文档字符串编写代码。

这会让你更接近答案吗？

```
def count_loc(infile):
  skipping_comments = False
  loc = 0 
  for line in infile:
    # Skip one-liners
    if line.strip().startswith("#"): continue
    # Toggle multi-line comment finder: on and off
    if line.strip().startswith('"""'):
      skipping_comments = not skipping_comments
    if line.strip().endswith('"""'):
      skipping_comments = not skipping_comments
      continue
    if skipping_comments: continue
    print line, 
```

# ruby-on-rails - 如何确定每个循环中的最后一个对象？

> ID：929178
> 
> 赞同：39
> 
> 时间：2009-05-30T06:33:06.653
> 
> 标签：ruby-on-rails

在 Rails 中典型的每个循环中，我如何确定最后一个对象，因为我想做一些与其他对象不同的事情。

```
<% @stuff.each do |thing| %>

<% end %> 
```

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-02-13T09:12:03.103

```
@stuff.each do |s|
  ...normal stuff...
  if s == @stuff.last
    ...special stuff...
  end
end 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-05-30T06:43:30.033

有趣的问题。使用 each_with_index。

```
len = @stuff.length

@stuff.each_with_index do |x, index|
 # should be index + 1       
 if index+1 == len
 # do something
  end
end 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-13T09:04:08.057

```
<% @stuff[0...-1].each do |thing| %>
  <%= thing %>
<% end %>
<%= @stuff.last %> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T06:44:16.833

一种有点幼稚的处理方式，但是：

```
<% @stuff.each_with_index do |thing, i| %>
  <% if (i + 1) == @stuff.length %>
    ...
  <% else %>
    ...
  <% end %>
<% end %> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-01T20:37:12.020

一个更 lispy 的替代方法是使用

```
@stuff[1..-1].each do |thing|

end
@stuff[-1].do_something_else 
```

# c# - 获取listview的item双击事件

> ID：929179
> 
> 赞同：40
> 
> 时间：2009-05-30T06:33:07.400
> 
> 标签：c#, .net, wpf, wpf-controls

为了引用列表视图控件的双击事件，我需要做什么？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-11-23T19:02:34.030

```
<ListView.ItemContainerStyle>
    <Style TargetType="ListViewItem">
        <EventSetter Event="MouseDoubleClick" Handler="listViewItem_MouseDoubleClick" />
    </Style>
</ListView.ItemContainerStyle> 
```

那么唯一的困难是，如果您对 listviewitem 映射到的底层对象感兴趣，例如

```
private void listViewItem_MouseDoubleClick(object sender, MouseButtonEventArgs e)
{
    ListViewItem item = sender as ListViewItem;
    object obj = item.Content;
} 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-05-30T15:38:37.417

我正在使用这样的东西来触发 ListViewItem 双击，而不是例如当你双击 ListView 的标题时。

```
private void ListView_MouseDoubleClick(object sender, MouseButtonEventArgs e)
{
    DependencyObject obj = (DependencyObject)e.OriginalSource;

    while (obj != null && obj != myListView)
    {
        if (obj.GetType() == typeof(ListViewItem))
        {
            // Do something here
            MessageBox.Show("A ListViewItem was double clicked!");

            break;
        }
        obj = VisualTreeHelper.GetParent(obj);
    }
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-03-11T17:28:23.947

使用`ListView.HitTest`方法

```
 private void listView_MouseDoubleClick(object sender, MouseEventArgs e)
    {
        var senderList  = (ListView) sender;
        var clickedItem = senderList.HitTest(e.Location).Item;
        if (clickedItem != null)
        {
            //do something
        }            
    } 
```

还是老办法

```
 private void listView_MouseDoubleClick(object sender, MouseEventArgs e)
    {
        var senderList  = (ListView) sender;                        
        if (senderList.SelectedItems.Count == 1 && IsInBound(e.Location, senderList.SelectedItems[0].Bounds))
        {
            //Do something
        }
    }

    public  bool IsInBound(Point location, Rectangle bound)
    {
        return (bound.Y <= location.Y && 
                bound.Y + bound.Height >= location.Y &&
                bound.X <= location.X && 
                bound.X + bound.Width >= location.X);
    } 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-06-15T06:53:36.917

```
 private void positionsListView_DoubleClick(object sender, EventArgs e)
    {
        if (positionsListView.SelectedItems.Count == 1)
        {
            ListView.SelectedListViewItemCollection items = positionsListView.SelectedItems;

            ListViewItem lvItem = items[0];
            string what = lvItem.Text;

        }
    } 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2010-01-30T23:36:36.273

我也需要那个。我在 msdn 上发现了这一点：http:

[//msdn.microsoft.com/en-us/library/system.windows.forms.listview.activation.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.listview.activation.aspx)

我认为这个代表就是为了这个。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-12-08T09:14:04.417

我还没有足够大的声誉分数来添加最有帮助的评论，但这与那些询问 .Net 4.5 解决方案的人有关。

您可以使用鼠标 X 和 Y 坐标以及 ListView 方法 GetItemAt 来查找已单击的项目。

```
private void ListView_MouseDoubleClick(object sender, MouseButtonEventArgs e)
{
    ListViewItem item = myListView.GetItemAt(e.X, e.Y)
    // Do something here
} 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-02-20T02:51:07.983

对我来说，我在此代码部分中双击 ListView 。

```
 this.listView.Activation = ItemActivation.TwoClick;

    this.listView.ItemActivate += ListView1_ItemActivate; 
```

[ItemActivate 指定用户如何使用项目激活](http://msdn.microsoft.com/en-us/librarysystem.windows.forms.itemactivation%28v=vs.90%29.aspx)

当用户双击时，ListView1_ItemActivate 将被触发。ListView ItemActivate 的属性是指访问所选项目的集合。

```
 private void ListView1_ItemActivate(Object sender, EventArgs e)
    {

        foreach (ListViewItem item in listView.SelectedItems)
           //do something

    } 
```

这个对我有用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-06-11T17:26:23.060

我在 Microsoft 开发中心找到了这个。它可以正常工作并忽略在错误位置双击。如您所见，关键是在触发双击事件之前选择了一个项目。

```
private void listView1_DoubleClick(object sender, EventArgs e)
{
    // user clicked an item of listview control
    if (listView1.SelectedItems.Count == 1)
    {
        //do what you need to do here            
    }
} 
```

[http://social.msdn.microsoft.com/forums/en-US/winforms/thread/588b1053-8a8f-44ab-8b44-2e42062fb663](http://social.msdn.microsoft.com/forums/en-US/winforms/thread/588b1053-8a8f-44ab-8b44-2e42062fb663)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-04-14T13:02:32.833

以下是如何获取 WPF 列表视图中双击列表视图项的选定对象和对象匹配代码：

```
/// <summary>
/// Get the object from the selected listview item.
/// </summary>
/// <param name="LV"></param>
/// <param name="originalSource"></param>
/// <returns></returns>
private object GetListViewItemObject(ListView LV, object originalSource)
{
    DependencyObject dep = (DependencyObject)originalSource;
    while ((dep != null) && !(dep.GetType() == typeof(ListViewItem)))
    {
        dep = VisualTreeHelper.GetParent(dep);
    }
    if (dep == null)
        return null;
    object obj = (Object)LV.ItemContainerGenerator.ItemFromContainer(dep);
    return obj;
}

private void lvFiles_PreviewMouseDoubleClick(object sender, MouseButtonEventArgs e)
{
    object obj = GetListViewItemObject(lvFiles, e.OriginalSource);
    if (obj.GetType() == typeof(MyObject))
    {
        MyObject MyObject = (MyObject)obj;
        // Add the rest of your logic here.
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-06-21T17:24:15.463

可以先获取ListView，再获取Selected ListViewItem。我有一个 ListBox 的例子，但 ListView 应该是类似的。

```
private void listBox_MouseDoubleClick(object sender, MouseButtonEventArgs e)
    {
        ListBox box = sender as ListBox;
        if (box == null) {
            return;
        }
        MyInfo info = box.SelectedItem as MyInfo;
        if (info == null)
            return;
        /* your code here */
        }
        e.Handled = true;
    } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-30T07:16:13.290

在 ListBox DoubleClick 事件中，获取列表框的 selecteditem(s) 成员，然后就可以了。

```
void ListBox1DoubleClick(object sender, EventArgs e)
    {
        MessageBox.Show(string.Format("SelectedItem:\n{0}",listBox1.SelectedItem.ToString()));
    } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-30T07:22:37.113

要么使用 MouseDoubleClick 事件，而且所有 MouseClick 事件在 eventargs 变量“e”中都有一个点击计数。因此，如果 e.ClickCount == 2，则双击。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-01T09:00:00.650

这很烦人，但最好的方法是：

```
<DataTemplate Name="MyCoolDataTemplate">
    <Grid Loaded="HookLVIClicked" Tag="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListViewItem}}}">
        <!-- your code here -->
    </Grid>
</DataTemplate> 
```

然后在代码中：

```
public void HookLVIClicked(object sender, RoutedEventArgs e) {
    var fe = (FrameworkElement)sender;
    var lvi = (ListViewItem)fe.Tag;
    lvi.MouseDoubleClick += MyMouseDoubleClickHandler;
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-10-08T09:03:56.397

与想要打开一个以 SelectedItem 作为上下文的窗口（不同视图）的 ListBox 有类似的问题（在我的情况下，所以我可以编辑它）。

我发现的三个选项是： 1\. 隐藏代码 2\. 使用附加行为 3\. 使用 Blend 的 i:Interaction 和 EventToCommand 使用 MVVM-Light。

我选择了第三个选项，它看起来像这样：

```
<ListBox x:Name="You_Need_This_Name"  
ItemsSource="{Binding Your_Collection_Name_Here}"
SelectedItem="{Binding Your_Property_Name_Here, UpdateSourceTrigger=PropertyChanged}"
... rest of your needed stuff here ...
>
<i:Interaction.Triggers>
<i:EventTrigger EventName="MouseDoubleClick">
    <Command:EventToCommand Command="{Binding Your_Command_Name_Here}" 
        CommandParameter="{Binding ElementName=You_Need_This_Name,Path=SelectedItem}"     />
    </i:EventTrigger>
</i:Interaction.Triggers> 
```

就是这样......当您双击所需的项目时，您在 ViewModel 上的方法将以 SelectedItem 作为参数调用，您可以在那里做任何您想做的事情:)

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2014-10-28T16:55:19.577

发件人的类型是 ListView 而不是 ListViewItem。

```
 private void listViewTriggers_MouseDoubleClick(object sender, MouseEventArgs e)
    {
        ListView triggerView = sender as ListView;
        if (triggerView != null)
        {
            btnEditTrigger_Click(null, null);
        }
    } 
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2018-03-04T13:17:22.970

我看到这个主题在谷歌上很受欢迎，有我的简单和工作示例:)

XAML：

```
 <ListView Name="MainTCList" HorizontalAlignment="Stretch" MinHeight="440" Height="Auto" Margin="10,10,5.115,4" VerticalAlignment="Stretch" MinWidth="500" Width="Auto" Grid.Column="0" MouseDoubleClick="MainTCList_MouseDoubleClick" IsSynchronizedWithCurrentItem="True">
        <ListView.View>
            <GridView>
                <GridViewColumn Header="UserTID" DisplayMemberBinding="{Binding UserTID}" Width="80"/>
                <GridViewColumn Header="Title" DisplayMemberBinding="{Binding Title}" Width="410" />
            </GridView>
        </ListView.View>
    </ListView> 
```

C＃

```
 private void MainTCList_MouseDoubleClick(object sender, MouseButtonEventArgs e)
    {
            TC item = (TC)MainTCList.Items.CurrentItem;
            Wyswietlacz.Content = item.UserTID;  
    } 
```

Wyswietlacz 是一个用于查看项目内容的测试标签 :) 我在最后一行中添加了一个方法来使用来自项目的数据加载页面。

# web-services - 通过 Web 服务与 MS Dynamics 的电子商务 webapp 集成 (Navision 2009)

> ID：929180
> 
> 赞同：1
> 
> 时间：2009-05-30T06:34:07.133
> 
> 标签：web-services, integration, microsoft-dynamics, navision

有没有人尝试使用 Nav 2009 中引入的新 Web 服务在 MS Dynamics 上构建电子商务站点？我想知道这些 Web 服务可以承受什么样的负载，可以读取/写入什么样的资源，以及我可以预料到的任何其他挑战。

我打算通过 Web 服务集成现有的基于 linux 的 webapp ...

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-09T19:05:46.870

NAV 2009 中的 Web 服务可以调用 CodeUnit 或 Page 对象。页面允许您从其源表中创建、读取、更新和删除行。CodeUnits 提供了更大的灵活性，允许您调用可以在 C/AL 中实现的任何操作。我认为 CodeUnit 触发争论仅限于原始类型和记录。

NAV Web 服务使用 Windows 身份验证，因此您的 linux 应用程序必须能够相应地提供 Windows 凭据。我不是这方面的专家，所以我不确定这在 Linux 机器上有多困难。

关于支持的负载，我会在 mibuso 的[论坛](http://www.mibuso.com/forum/viewforum.php?f=32)中询问 - 这是我所知道的最大的有经验用户社区。我希望您会受到 Web 服务主机的 CPU 和内存的限制。NAV 不支持 Web 服务层上的集群\负载平衡，但我相信可以并排运行多个。

# php - 有没有一种简单的方法可以从 CakePHP 的视图中获取 AuthComponent 用户数据？

> ID：929186
> 
> 赞同：7
> 
> 时间：2009-05-30T06:38:21.993
> 
> 标签：php, authentication, cakephp

根据[Auth 组件的 cakebook 部分](http://book.cakephp.org/view/172/Authentication)，我可以使用以下用户控制器实现简单的身份验证：

```
class UsersController extends AppController {

    var $name = 'Users';    
    var $components = array('Auth'); // Not necessary if declared in your app controller

    /**
     *  The AuthComponent provides the needed functionality
     *  for login, so you can leave this function blank.
     */
    function login() {
    }

    function logout() {
        $this->redirect($this->Auth->logout());
    }
} 
```

我希望能够将以下内容纳入我的观点：

```
<?php
   $username = $auth->user('username');
   echo "Welcome " . $username;
?> 
```

有没有一种简单的方法可以做到这一点，还是我需要覆盖登录功能并将用户名存储到会话中？

**更新**

[亚历山大的回答](https://stackoverflow.com/questions/929186/is-there-an-easy-way-to-get-authcomponent-user-data-from-a-view-in-cakephp/930226#930226)正是我想要的。但是，我将添加以下内容，以防其他人像我一样感到困惑。

我花了一段时间才明白，如果您更改 Auth 使用的模型（例如，您可能有一个“persons”表而不是“users”），那么您需要使用以下内容：

```
$persondata = $session->read('Auth.Person'); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-30T18:03:27.400

实际上，这些信息很容易从会话中获得。您使用会话助手来获取它。我相信正确的语法是：

```
$userdata = $session->read('Auth.User');
$username = $session->read('Auth.User.username'); 
```

编辑：

对于 CakePHP 2.X 和语法是：

```
$userdata = $this->session->read('Auth.User');
$username = $this->session->read('Auth.User.username'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T12:53:05.013

查看 CakePHP 手册中的 AuthComponent-Methods....

用户通过 $this->Auth->User() 从会话登录后，您可以访问用户信息。因此，如果您想要用户名，只需在控制器中使用它即可。

$this->set('username', $this->Auth->User('username'));

您现在可以在视图中使用 $username。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T17:14:59.437

在 AppController 中添加一个方法

```
function beforeFilter() {
$ath = $this->Auth->user();
$this->set('userDetails', $ath['User']);
} 
```

然后您可以通过 $userDetails 从您的视图和/或布局中访问它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-31T17:14:28.247

要在视图中访问 Auth 变量，只需执行以下操作：

```
echo $session->read('Auth.User.id');

```

# c# - 如何到达 C# 的顶峰？

> ID：929190
> 
> 赞同：0
> 
> 时间：2009-05-30T06:43:10.393
> 
> 标签：c#

我怎样才能成为 C# 和我所学的任何语言的专家？

还有，有什么推荐的书……？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T06:53:41.743

真的很容易。[学习语言的所有特性，然后研究框架并阅读何时应用每个特性](http://www.youtube.com/watch?v=tNfGyIW7aHM)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T06:48:46.027

Head First 系列是一个很好的起点。

Head First C# 这本书非常棒。我从中学到了很多，而且阅读起来超级简单、全面（而且有趣！）。（[亚马逊链接](https://rads.stackoverflow.com/amzn/click/com/0596514824)）

然后自己开始一个项目并应用你学到的东西。你会比你想象的更快！

祝你的任务好运！

# php - 如何安装ffmpeg-php Mac OS X leopard

> ID：929205
> 
> 赞同：3
> 
> 时间：2009-05-30T06:55:15.593
> 
> 标签：php, macos, ffmpeg

有没有人能够在osx上安装ffmpeg-php？我能够通过 mac 端口安装 ffmpeg。ffmpeg-php 不会安装。

问题：找不到共享目录，因为 macports 将其安装到 /opt/local/include/ 和 /opt/local/lib。ffmpeg-php 在 /usr/local/include/ffmpeg 中查找

phpize 返回一大堆警告，不确定这是否有问题。

当我在正确的位置获取所有标题/库时，make 仍然很适合。

有没有人真的这样做过？或者...

ffmpeg有替代品吗？我希望能够即时创建视频帧的图片。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T14:26:04.950

我也无法编译它，尽管 ffmpeg 在没有该扩展的情况下仍然有用。这是一个每 5 秒抓取一次 jpg 的简单示例：

```
$ffmpeg = '/opt/local/bin/ffmpeg';
$vid = 'test.mpg';
$cmd = $ffmpeg.' -i '.$vid.' -r 0.2 -sameq -f image2 '.$vid.'.%03d.jpg';
exec($cmd); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-03T18:58:11.633

我的 ffmpeg-php 的“公式”被接受。

安装[homebrew](https://brew.sh/)，然后运行：

```
brew install ffmpeg-php 
```

你可以走了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-04-06T21:57:39.807

[我刚刚使用这些说明](http://www.webrelatedstuff.com/blog/ffmpeg+and+ffmpeg-php/ffmpeg-installation-on-mac-osx)作为指导，完成了在我的 OSX 10.6.2 上安装它的整个过程。还帮助我的是按照[此处链接的站点](http://www.youtube.com/watch?v=3srKCD3ok3w)上的说明（对于 ffmpeg 部分）以及[ffmpeg-php 站点本身](http://ffmpeg-php.sourceforge.net/)的“安装”下的“简单”说明获取正确的文件，以解决您的实际问题。全部没有任何macport。

不能说这很容易，但它工作得很好。这是一个非常漫长的过程，我不会在这里引用。希望基本上你需要最新的[ffmpeg](http://ffmpeg.org/)就足够了，然后一切都是常规的“./configure && make”过程。

我的**ffmpeg**配置选项是：`--enable-libmp3lame --enable-shared --disable-mmx --arch=x86_64 --enable-libfaad --enable-gpl`

[请注意，[这就是我在 google 上找到这些链接的方式](http://www.google.com/search?num=30&hl=en&safe=off&tbs=qdr%3Ay&q=ffmpeg+php+mac&aq=f&aqi=&aql=&oq=&gs_rfai=)（所有这些搜索选项对我来说都是默认的，包括去年的过滤）。有趣的是，第一个结果是这个问题，所以我在这里回答它。;-)]

# asp.net - Mono(Linux) 与 IIS(Window) 中 ASP.NET 的性能

> ID：929210
> 
> 赞同：16
> 
> 时间：2009-05-30T06:57:33.327
> 
> 标签：asp.net, iis, mono

将您的 asp.net 托管在 linux 上的 mono 和 iis 上的窗口服务器之间有什么不同吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-30T14:42:08.990

当然存在差异，就像 Java 和 .Net 之间存在性能差异一样。但是，它会根据应用程序正在执行的操作而有很大差异。

有些事情 .Net 比 Mono 快得多。Mono 在某些方面比 .Net 快得多。有些事情他们的表现大致相同。比较在 Windows 或 Linux 上运行的应用程序时也是如此。比较在 IIS 和 Apache 上运行的应用程序时也是如此。

很可能，任何一个都可以足够快地运行您的应用程序，并且您会发现您的性能将由您的编程技术驱动。每秒几个请求的差异可能不是一个大问题，除非您有一个大型服务器场，在这种情况下，您很可能有资源在两者上进行测试，看看哪个对您的特定应用程序更快。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-01T14:20:33.390

关于 lextm 的建议，即“不可能”发布性能比较的结果，[Windows Vista Ultimate 的最终用户许可协议（又名 EULA）在](http://download.microsoft.com/documents/useterms/Windows%20Vista_Ultimate_English_36d0fe99-75e4-4875-8153-889cf5105718.pdf)有条件的情况下允许这样做。

> **微软 .NET 基准测试。**该软件包括 .NET Framework 3.0 的一个或多个组件（“.NET 组件”）。*您可以对这些组件进行内部基准测试。您可以披露这些组件的任何基准测试的结果，前提是您遵守 [http://go.microsoft.com/fwlink/?LinkID=66406](http://go.microsoft.com/fwlink/?LinkID=66406)中规定的条件。* 尽管您可能与 Microsoft 达成了任何其他协议，但如果您披露此类基准测试结果，Microsoft 有权披露其对您的与适用的 .NET 组件竞争的产品进行的基准测试的结果，前提是它符合相同的[http://go.microsoft.com/fwlink/?LinkID=66406](http://go.microsoft.com/fwlink/?LinkID=66406)中规定的条件 .

我读到的条件是合理的披露要求：您用于进行测试的源代码、您测试的软件版本、您进行测试的日期、您所做的配置和优化等。

[Windows Server 2003 的 EULA](http://www.microsoft.com/windowsserver2003/eulas/default.mspx)包括相同的规定。我找不到 Windows Server 2008（最新版本）的 EULA，但我认为基准测试规定仍然存在。

**附录**：如果您查看 Windows7 的 EULA，您可能会发现无基准测试条款，或更准确地说是无发布条款；这是因为 Win7 仍处于预发布阶段。当它正式发布时，预计会出现标准基准发布条件。

过去，Microsoft 对此主题有更严格的政策。基本上：*您需要我们（Microsoft）的许可才能披露性能比较。*[根据上述 EULA 中的链接，](http://go.microsoft.com/fwlink/?LinkID=66406) 此政策已放宽，甚至可追溯至 .NET v1.0 和 v1.1 。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T14:46:43.973

单声道很烂！

*   [http://art-blog.no-ip.info/cppcms/blog/post/27](http://art-blog.no-ip.info/cppcms/blog/post/27)
*   [http://www.phpvs.net/2008/02/08/benchmarking-mono-aspnet-vs-php-a-slight-problem/](http://www.phpvs.net/2008/02/08/benchmarking-mono-aspnet-vs-php-a-slight-problem/)

或者在政治上更正确：至少对于 Asp.Net Web 应用程序来说，Mono 还没有准备好迎接黄金时间：

*   不支持缓存
*   应用程序启动后性能非常不稳定并且下降。

**编辑：**为我的帖子添加引号，回复最新评论。

> 但是，为了进行公平比较...我应该启用缓存...在 aspx 文件的标题处添加以下行应该对我有所帮助。
> 
> ```
> <%@ OutputCache Duration="20" VaryByParam="None" %> 
> ```
> 
> 我做到了——没有结果！性能是一样的。

注意：经过更深入的检查，modo 中缓存的实现非常有限且很差，经过最近的检查，它仍然适用于较新版本的 mono。

> 好的，无论如何我做了一些基准测试（...）简单的时钟给我大约每秒 750 页的缓存变体和 650 页的非缓存变体。测试是在双核奔腾 D 3G 上的**IIS 5.0下完成的**
> 
> 与 mod_mono 相同的代码（在 Signle Core AMD Athlon 3000 下）给了我：
> 
> *   每秒 350 页。
> *   下一次运行给了 300。
> *   下一个 200
> *   和接下来的 150

因此，基准测试是不可能的。

引用帖子是否仍然不是增强的？

没有**单声道**绝对没有准备好迎接黄金时段。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-01-04T17:50:30.010

这是一个很好的[基准测试](http://www.ctothoughts.com/2011/03/performance-of-aspnet-on-windowsiis-vs.html)，有人测试了 windows/IIS 与 Linux/Apache/Mono(mod_mono) 的区别。足够疯狂的 mod_mono（apache 的 mono 插件）的性能明显更高。当然，我确信在某些情况下它会有所不同，但考虑到 linux 和 apache 的低调加上 mono 人所做的出色工作，Linux/Apache/Mono 是一个更好的选择是理所当然的。话虽如此，但希望通过新的开源 ASP，我们将很快看到一些性能超强的 Linux .Net 服务器（已为云做好准备）。

[性能比较图](http://i.stack.imgur.com/aQSHd.png)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-31T22:27:41.693

我在 mod_mono 下运行了单声道应用程序。从可用性来看，它运行良好，虽然我没有做任何基准测试。仍然 IIS 确实是一个非常方便的工作环境。考虑到我仍然在 IIS 中托管我的 web 服务器并使用 linux mono 客户端连接到它的选择。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-31T02:07:53.347

首先，据说发布性能统计数据来比较 CLR 实现（.NET 与 Mono）是不可能的。我不确定来源是什么，但 Mono 团队只发布了 Mono 版本之间的比较（1.x、2.0、2.2、和 2.4），所以我认为这句话是真实的。因此，您只能在自己的环境中测试性能。

其次，Mono 最近发展得更快，这让您有机会通过升级 Mono 运行时来获得性能提升。

第三，请用不同的态度来评判一个开源产品。对于封闭源代码产品，您只能请求其供应商提高性能或提供有关如何调整应用程序的支持。对于开源项目，您可以访问代码库，并且可以根据自己的需要对其进行定制，并为自己的应用程序修复问题。

正如 jpobst 所提到的，即使您自己无法解决问题，您也可以联系 Mono 人员。

# winforms - 当文本框更改而不是失去焦点时更新数据绑定

> ID：929216
> 
> 赞同：3
> 
> 时间：2009-05-30T07:03:12.537
> 
> 标签：winforms, data-binding, compact-framework

我正在学习为紧凑型框架进行开发，但遇到了一个困扰我的问题。

我已经将几个文本框绑定到一些属性（一个人类的名字和姓氏），并且有一个菜单项，它只显示全名的显示消息，它工作得很好，除了属性只有在文本框丢失时才会更新重点。这意味着如果我更改名字并按显示名称菜单项，我会得到名字的旧值。

有没有办法可以强制更新数据绑定，或者让它每次在一个文本框中更改字符时更新相应的属性？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-31T02:41:19.847

如果您这样做，您可能会将不良数据放入数据对象中，但这里是如何做到这一点的：

在您的`MyTextBox.DataBinding.Add()`方法中，将[this 重载](http://msdn.microsoft.com/en-us/library/ms158436.aspx)与 OnPropertyChanged 一起用于[DataSourceUpdateMode](http://msdn.microsoft.com/en-us/library/system.windows.forms.datasourceupdatemode.aspx)参数，而不是默认的 OnValidate

我再说一遍，这是听起来很容易的事情之一，但从长远来看可能会导致问题，因为您“绑定”到从未经过验证的数据。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-31T17:23:17.097

Just call form's ValidateChildren() in the code on the button doing the save

# asp.net - 如何使用 asp.net 上传文件而不发回整个页面？

> ID：929217
> 
> 赞同：0
> 
> 时间：2009-05-30T07:03:42.673
> 
> 标签：asp.net, ajax, file-upload

我想使用 asp.net 上传文件，所以我不想在上传时回发页面。我该怎么做，有没有办法使用 Ajax 来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T19:03:26.977

使文件上传表单以隐藏的 iframe 为目标。

```
<iframe name="UploadTarget" style="display:none"></iframe>
<form target="UploadTarget" action="postfile" method="post" enctype="multipart/form-data">
<input type="file" name="MyFile">
<input type="submit" name="submit" value="Send me a file">
</form> 
```

最后一个技巧是添加到您的响应页面：

```
<script type="text/javascript">parent.somecallbackfunction("Here is some data")</script> 
```

让您的父页面（包含隐藏 iframe 的页面）知道文件上传已完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T07:13:11.097

iframe 可以放置在您的页面上，并且可以包含输入元素 type=file。您可以通过 javascript 操作和提交 iframe 表单。您可以通过将其 CSS 样式设置为 display:none 来隐藏 iframe。这通常被称为隐藏 iframe 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T07:22:41.903

使用像[SWFUpload](http://swfupload.org/)这样经过验证的东西，并节省编写自己的客户端代码的时间。

# php - 如何在 PHP 中将关联数组展平为仅包含值的数组？

> ID：929222
> 
> 赞同：4
> 
> 时间：2009-05-30T07:08:35.207
> 
> 标签：php, arrays, function

我有一个包含键和值的数组。例如：

```
Array (
    [name] => aalaap
    [age] => 29
    [location] => mumbai
) 
```

我想将键从这个转换为值，但我希望值在键之后出现。例如：

```
Array (
    [0] => name
    [1] => aalaap
    [2] => age
    [3] => 29
    [4] => location
    [5] => mumbai
) 
```

我可以很容易地编写一个迭代函数来做到这一点......例如：

```
array_flatten($arr) {
    foreach ($arr as $arrkey => $arrval) {
        $arr_new[] = $arrkey;
        $arr_new[] = $arrval;
    }
    return $arr_new;
} 
```

...但我试图找出是否有任何方法可以使用`array_combine`,和/或来完成`array_keys`，最好是在一个中完成，所以我不需要使用自定义函数。`array_values``array_merge`

有没有？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T08:58:35.703

您自己的解决方案可能是最干净的解决方案，因此将其转换为**“单线”**：

```
$array = array('name' => 'aalaap','age' => 29, 'location' => 'mumbai');
$answer = array();

array_walk($array, create_function('$val,$key', 'global $answer; $answer[]=$key; $answer[]=$val;'));

var_dump($answer); 
```

这避免了不必要且昂贵的数组复制或排序。

**或者，丢失全局：**

```
array_walk($array, create_function('$val,$key,$result', '$result[]=$key; $result[]=$val;'), &$answer); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T07:16:26.457

我认为这是不可能的——使用内置函数，你最终会得到所有的键，然后是所有的值：

```
$a = array('a' => 'A', 'b' => 'B', 'c' => 'C');

$a = array_merge(array_keys($a), array_values($a));
print_r($a); 
```

你将不得不使用这样的循环：

```
$b = array();
foreach ($a as $key => $value)
{
    $b[] = $key;
    $b[] = $value;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-06-06T09:23:40.463

Just Jules 答案的 PHP 5.3+ 版本，更具可读性：

```
array_walk($array, function($val, $key) use (&$answer) {
    $answer[] = $key;
    $answer[] = $val;
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T07:59:11.143

这*是*可能的，但我不认为它更具可读性*或*更快。它将与 PHP 的一个鲜为人知的功能一起使用 -[数组添加](http://us.php.net/manual/en/language.operators.array.php)：

```
$array = array('name' => 'aalaap', 'age' => 29, 'location' => 'mumbai');

# Separate keys and values into distinct arrays
$keys = array_keys($array);
$values = array_values($array);

# Generate 2 new array containing indexes for the 2 arrays which contain
# only odd/even numbers:
$keysKeys = range(0, count($keys) * 2 - 1, 2);
$valuesKeys = range(1, count($keys) * 2, 2);

# Combine the keys with the values and add the results:
$array = array_combine($keysKeys, $keys) + array_combine($valuesKeys, $values);

# Sort the resulting array, otherwise the numbering will be broken
# (1,3,5,2,4,6)
ksort($array);

# Result:
var_dump($array);
array(6) {
    [0]=>
        string(4) "name"
    [1]=>
        string(6) "aalaap"
    [2]=>
        string(3) "age"
    [3]=>
        int(29)
    [4]=>
        string(8) "location"
    [5]=>
        string(6) "mumbai"
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-07T00:35:07.677

可以使用 array_reduce 来接近。

```
array_reduce(array_keys($arr), function($carry, $key)use($arr){
    $carry[] = $key;
    $carry[] = $arr[$key];
    return $carry;
}, array()); 
```

# c# - 列表框元素显示属性后如何上下移动？

> ID：929234
> 
> 赞同：0
> 
> 时间：2009-05-30T07:16:32.680
> 
> 标签：c#

我创建了一个代码，其中当我在列表框中选择一个项目时，有关该项目的信息会显示在一个文本框中。我也有上下移动按钮来上下移动列表的内容和删除按钮来删除选定的项目。现在，当我单击该项目时，信息将显示在文本框中，但是如果我单击同一项目的上移、下移或删除按钮，则会引发异常 对象引用未设置为对象的实例。引发此异常的行是当我在下面的代码中创建 ClassName 的新对象时：

```
 private void lb_SelectedIndexChanged(object sender, EventArgs e)
    {
        m_Txt.Clear();
        ClassName fileInfo = new ClassName(m_lbOPFfiles.SelectedItem.ToString());
        m_Txt.Multiline = true;
        m_Txt.Text = fileInfo.title + Environment.NewLine + fileInfo.ID + Environment.NewLine + fileInfo.time;

    } 
```

上移按钮的代码是：

```
 private void m_btnUP_Click(object sender, EventArgs e)
    {            
        if (m_lbOPFfiles.SelectedIndex != 0 && m_lbOPFfiles.SelectedIndex != -1)
        {
          //  m_lbOPFfiles.SelectedItem.
            object item = m_lbOPFfiles.SelectedItem;
            int index = m_lbOPFfiles.SelectedIndex;
            m_lbOPFfiles.Items.RemoveAt(index);

            m_lbOPFfiles.Items.Insert(index - 1, item);
        }         
    } 
```

请告诉可能是什么问题及其解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T07:26:21.130

SelectedIndexChanged 在选择项目时触发，但也会在“未选择”项目时触发（如果从列表中删除当前选定的项目，则会发生这种情况）。添加一个检查以验证是否选择了一个项目：

```
if (m_lbOPFfiles.SelectedIndex >= 0)  // you can also use m_lbOPFfiles.SelectedItem != null
{
    m_Txt.Clear();
    ClassName fileInfo = new ClassName(m_lbOPFfiles.SelectedItem.ToString());
    m_Txt.Multiline = true;
    m_Txt.Text = fileInfo.title + Environment.NewLine + fileInfo.ID + Environment.NewLine +  fileInfo.time;
} 
```

如果未选择任何项目，则 SelectedIndex 为 -1，且 SelectedItem 为空。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T07:24:26.300

我的猜测是在`lb_SelectedIndexChanged`方法的第三行。`ToString()`此时您正在调用`SelectedItem`which 可能为 null - 在删除该`m_btnUP_Click`方法的第 7 行中的项目后，它可能为 null - 这将引发异常。

您可以在异常详细信息中查看它是从哪一行代码中抛出的，并像这样精确指出错误。也可以逐行调试代码，自己看看。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T07:24:28.733

我的猜测是你的`Items.RemoveAt`电话正在清除选择，导致`SelectedItem`成为`null`，并且`lb_SelectedIndexChanged`事件被触发，这`null`会导致你描述的问题。

我建议您确保在事件处理程序中实际选择了某些内容。

# c# - 使用 DrawingContext 在画布上的元素上绘图

> ID：929237
> 
> 赞同：2
> 
> 时间：2009-05-30T07:17:51.913
> 
> 标签：c#, wpf, drawing

当我单击并拖动画布对象（扩展画布）时，我正在绘制一个选择框。我已经像这样覆盖了 OnRender 方法：

```
 protected override void OnRender(DrawingContext dc)
    {
        base.OnRender(dc);

        DrawGrid(dc);
        DrawSelector(dc);
    }

    private void DrawSelector(DrawingContext dc)
    {
        if (Selecting)
        {
            dc.DrawRectangle(new SolidColorBrush(Color.FromArgb(75, 0, 0, 255)), new Pen(Brushes.Blue, 1.5), SelectionRect);
        }
    } 
```

但是我的选择器总是在画布上的所有元素下绘制。有谁知道我将如何在画布上的所有 UIElements 上绘制我的选择器？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T08:48:03.010

您可以[`Adorner`](http://msdn.microsoft.com/en-us/library/system.windows.documents.adorner.aspx)为此目的使用一个。

# visual-studio - Visual Studio 中的类似 ViM 的搜索突出显示可能吗？

> ID：929239
> 
> 赞同：5
> 
> 时间：2009-05-30T07:19:49.570
> 
> 标签：visual-studio, search, vim, highlight

ViM 有这个选项[hlsearch](http://www.vim.org/htmldoc/options.html#%27hlsearch%27)，其中搜索到的字符串以高亮模式显示在找到的文件的所有位置。有没有办法在 Visual Studio 中做同样的事情？

也就是说，如果我搜索`"foobar"`，则`foobar`文件中的所有内容都会突出显示，并且此显示将一直保留到我下一次搜索。我发现这对于查看函数中使用某个变量的位置非常有用（无需手动搜索该字符串的下一次出现）。

我知道 Visual Studio 任务列表可用于查找 TODO 之类的字符串。我希望读者意识到这不适合我的问题，即更一般的文本搜索和突出显示。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T07:56:10.853

如果您喜欢 vim 并且正在使用 Visual Studio，您可能需要查看[Viemu](http://www.viemu.com/)。

hlsearch 功能当然包括在内。

示例图片：

[Viemu hlsearch http://dklein.taunus.de/viemuhlsearch.png](http://dklein.taunus.de/viemuhlsearch.png "Viemu hlsearch")

最诚挚的问候。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-31T03:13:55.897

[Visual Assist X](http://www.wholetomato.com/)执行此操作，以及类似于[light-symbol-mode 的功能](http://www.emacsblog.org/2007/04/17/quick-tip-light-symbol-mode/)。当然，除其他外。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-08-05T21:31:40.760

Visual Studio 2010 现在支持[引用突出显示](http://msdn.microsoft.com/en-us/library/ee349251.aspx)。单击或将光标移动到任何符号，例如变量、类、方法、属性等的名称，它将突出显示文件中的所有其他引用。它还允许您使用以下方式在引用之间导航：

`ctrl+shift+down arrow or ctrl+shift+up arrow`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T07:26:35.577

我使用[RockScroll](http://www.hanselman.com/blog/IntroducingRockScroll.aspx)插件。它具有多种功能，其中之一是，如果您双击一个单词，它将在文件中的任何位置突出显示。这和你描述的非常相似。它是免费的（就像啤酒一样）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-31T02:44:47.407

如果你碰巧真的很喜欢 Vim，你可能想看看[ViEmu](http://www.viemu.com/) for Visual Studio 。我只是一个非常高兴的用户:)

# c# - ASP.NET：如何为在 C# 代码隐藏中生成的表应用 CSS 类

> ID：929240
> 
> 赞同：10
> 
> 时间：2009-05-30T07:20:50.783
> 
> 标签：c#, asp.net

我有一个 ASP.NET 页面，我正在我的服务器端代码（代码隐藏文件）中生成一个 HTML 表，如下所示。

```
 HtmlTable iTblCart = new HtmlTable();
 HtmlTableRow iRowHeader = new HtmlTableRow();
 HtmlTableCell iCellHead1 = new HtmlTableCell();
 iCellHead1.InnerText= "Item";
 iRowHeader.Cells.Add(iCellHead1);
 iTblCart.Rows.Add(iCartRow);
 pnlPhoneCart.Controls.Add(iTblCart);  //appending to a panel 
```

我想在这个表上应用一个 CSS 类。我无法从智能感知中找到这样的属性。我错过了什么吗？谁能指导我如何继续？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-30T07:43:04.873

是的，我得到了答案。这里是

```
iTblCart.Attributes.Add("Class", "clsTradeInCart"); 
```

和 clsTradeInCart 是我的 CSS 类名

# mysql - Mysql使用动态数据库名称创建表

> ID：929244
> 
> 赞同：0
> 
> 时间：2009-05-30T07:24:05.520
> 
> 标签：mysql, database, dynamic

我在运行时创建数据库，我想同时在该数据库中创建表。谁能给我任何关于如何做到这一点的想法？例如 -

我已经创建了一个名为“mydb”的数据库，现在在同一个过程中，我正在尝试创建我正在使用 mysql 存储过程的表。我的 proc 输入将是我的 dbname。所以，我的过程看起来像

```
create procedure test(IN dbname varchar(100))
begin 
    create table `dbname`.`testing`(testid int, testname varchar(45));
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T07:34:27.853

您可以使用[PREPARE 功能](http://dev.mysql.com/doc/refman/5.1/en/sql-syntax-prepared-statements.html)来执行动态 SQL。

# amazon-s3 - 如何在 EC2 上创建 OpenSolaris 自我捆绑卷

> ID：929248
> 
> 赞同：0
> 
> 时间：2009-05-30T07:25:45.517
> 
> 标签：amazon-s3, opensolaris

我在 EC2 上使用 OpenSolaris 2008.11。我想创建自我捆绑。在ubuntu中

```
sudo ec2-bundle-vol -d /mnt -k $EC2_PRIVATE_KEY  -c $EC2_CERT  --fstab /etc/fstab --user $AWS_ACCUNT_ID  -r i386 
```

但 OpenSolaris 没有 /etc/fstab

你知道吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T21:15:10.690

Solaris 使用 /etc/vfstab 而不是 /etc/fstab

以下是一些关于如何在 solaris 上使用 e2c 的链接：

[http://www.sun.com/third-party/global/amazon/start/index.jsp](http://www.sun.com/third-party/global/amazon/start/index.jsp) [http://developer.amazonwebservices.com/connect/message.jspa?messageID=93069](http://developer.amazonwebservices.com/connect/message.jspa?messageID=93069)

# eclipse - 如何在 Mac OS X 上正确地将 Firefox 设置为 Eclipse 的外部 Web 浏览器

> ID：929260
> 
> 赞同：9
> 
> 时间：2009-05-30T07:36:23.420
> 
> 标签：eclipse, macos, firefox

默认设置“/Applications/Firefox.app/Contents/MacOS/firefox-bin”每次都会尝试启动一个新的 Firefox 实例，如果已经有一个，Firefox 会公然拒绝。

然后我尝试使用“开放”魔法并将其设置为：

```
Name: Firefox
Location: /usr/bin/open
Parameters: -a /Applications/Firefox.app %URL% 
```

这解决了多实例问题。

然而，另一个问题出现了。从光标下的代码（Open External Javadoc）获取的API的URL丢失了它的锚部分，即“.../docs/reference/android/widget/ImageView.html#setImageDrawable(android.graphics.drawable.Drawable)”变成“.../docs/reference/android/widget/ImageView.html”。所以打开页面后，还得自己定位API，真的很繁琐，效率低下。

那么，如何正确地将 Firefox 设置为外部 Web 浏览器以同时克服这两个问题呢？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-12-04T19:27:05.113

```
名称：火狐
位置：/usr/bin/open
参数：-a Firefox.app %URL%
```

来源： http: [//support.mozilla.com/en-US/questions/666771](http://support.mozilla.com/en-US/questions/666771)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T19:15:57.013

在 Eclipse 中，如果您明确将 Firefox 设置为外部浏览器，那么它将尝试启动一个新实例。但是，如果您将 Firefox 设置为默认系统浏览器并在 eclipse 中选择该选项，它将在现有实例中打开一个新窗口。

如果由于某种原因您必须有 2 个实例，那么您可以[创建一个新的 firefox 配置文件](http://jeroencoumans.nl/journal/multiple-firefox-versions)。我尝试了这个，但取得了有限的成功。我只能通过创建此脚本并在 eclipse 中指向它来让调试器在新实例中运行：

```
#！/bin/bash
/Applications/Firefox.app/Contents/MacOS/firefox-bin -P 调试 $1 $2 $3 $4 $5 $6 $7 $8 $9

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-02-04T00:29:58.133

经过一番摆弄，我想出了一个需要 Safari、/usr/bin/osascript 和一个 applescript 的解决方案。

创建一个applescript，如：

```
on run argv
    tell application "Safari"
        activate
        make new document at the beginning of documents
        set the_url to item 1 of argv
        set the URL of the front document to the_url
    end tell
end run 
```

然后将其保存在某处，记下路径：`/my/path/to/launch_url.scpt`

在 Eclipse 中：

1.  创建一个新的外部网络浏览器配置
2.  将位置设置为：`/usr/bin/osascript`
3.  将参数设置为： `/my/path/to/launch_url.scpt %URL%`

这是用 Eclipse 3.5 测试过的，打开的 url 就像上面提到的 an0 一样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-06T05:41:19.237

另一种选择，使用：`Eclipse Oxygen. 1a`和`Nightly build 49.01`浏览器测试。

```
Name: Firefox (Nightly)
Location: /usr/bin/open
Parameters: -b org.mozilla.nightly 
```

# ruby-on-rails - 条件时间显示

> ID：929265
> 
> 赞同：0
> 
> 时间：2009-05-30T07:40:37.950
> 
> 标签：ruby-on-rails, datetime, timestamp

在我的 Rails 应用程序的邮箱部分，我简单地显示每条消息的时间戳，如下所示：

```
<%= message.created_at.utc %> 
```

但我想更改它，以便如果消息的日期与今天不同，则显示日期，否则只显示时间（例如 Gmail）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T09:22:02.880

试着把这样的东西放在一个助手中：

```
def time_or_date(date)
  date.today? ? date.strftime('%H:%M') : date.strftime('%d/%m')
end 
```

然后，您可以像这样从您的视图中调用它：

```
<%= time_or_date(message.created_at.utc) %> 
```

您可能想要更改*strftime*以使其适合您的需求： [http ://www.ruby-doc.org/core/classes/Time.html#M000297](http://www.ruby-doc.org/core/classes/Time.html#M000297)

# iphone - 连续两个单元格，UITableview

> ID：929271
> 
> 赞同：1
> 
> 时间：2009-05-30T07:43:57.507
> 
> 标签：iphone, uitableview

我想连续有一个两个单元格，因为在联系人中，我们在一行中有“短信”和“添加到收藏夹”如何做到这一点......。那是把一个单元格一分为二吗？

谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T08:35:19.697

为此，您将不得不创建自己的自定义单元格，其中包含两个单元格。也许最简单的方法是创建一个包含两个按钮的单元格。这有点像黑客，但这是最简单的方法。

如果您采用该路线，您甚至不必子类化，您可以简单地使用两个按钮准备您的内容视图，并将其设置为单元格的内容。

# python - 是否有用于小型游戏的 2d 数组的 Python 模块/配方（不是 numpy）

> ID：929274
> 
> 赞同：2
> 
> 时间：2009-05-30T07:46:36.067
> 
> 标签：python, arrays, multidimensional-array

我正在用 Python 编写一些使用 Pygame 和 Pyglet 作为爱好项目的小游戏。

二维数组的类会非常方便。我使用 py2exe 将游戏发送给亲戚/朋友，而 numpy 太大了，它的大部分功能对我的要求来说是不必要的。

你能推荐一个我可以用来做这个的 Python 模块/食谱吗？

——奇拉格

[编辑]：MatrixFrog 和 zvoase 如下所述，可以使用列表列表。但它非常原始。具有插入/删除行和列以及旋转/翻转数组的方法的类也将使其非常容易和可重用。dicts 仅适用于稀疏数组。

谢谢你的想法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T08:48:39.123

使用默认字典怎么样？

```
>>> import collections
>>> Matrix = lambda: collections.defaultdict(int)
>>> m = Matrix()
>>> m[3,2] = 6
>>> print m[3,4]   # deliberate typo :-)
0
>>> m[3,2] += 4
>>> print m[3,2]
10
>>> print m
defaultdict(<type 'int'>, {(3, 2): 10, (3, 4): 0}) 
```

由于底层 dict 使用元组作为键，因此它支持 1D、2D、3D、... 矩阵。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T08:30:11.940

最简单的方法就是使用嵌套列表：

```
>>> matrix = [[0] * num_cols] * num_rows
>>> matrix[i][j] = 'value' # row i, column j, value 'value'
>>> print repr(matrix[i][j])
'value' 
```

或者，如果您要处理稀疏矩阵（即具有大量空值或零值的矩阵），使用嵌套字典可能更有效。在这种情况下，您可以实现对矩阵进行操作的 setter 和 getter 函数，如下所示：

```
def get_element(mat, i, j, default=None):
    # This will also set the accessed row to a dictionary.
    row = mat.setdefault(i, {})
    return row.setdefault(j, default)

def set_element(mat, i, j, value):
    row = mat.setdefault(i, {})
    row[j] = value 
```

然后你会像这样使用它们：

```
>>> matrix = {}
>>> set_element(matrix, 2, 3, 'value') # row 2, column 3, value 'value'
>>> print matrix
{2: {3: 'value'}}
>>> print repr(get_element(matrix, 2, 3))
'value' 
```

如果你愿意，你可以实现一个`Matrix`实现这些方法的类，但这可能有点矫枉过正：

```
class Matrix(object):
    def __init__(self, initmat=None, default=0):
        if initmat is None: initmat = {}
        self._mat = initmat
        self._default = default
    def __getitem__(self, pos):
        i, j = pos
        return self._mat.setdefault(i, {}).setdefault(j, self._default)  
    def __setitem__(self, pos, value):
        i, j = pos
        self._mat.setdefault(i, {})[j] = value
    def __repr__(self):
        return 'Matrix(%r, %r)' % (self._mat, self._default)

>>> m = Matrix()
>>> m[2,3] = 'value'
>>> print m[2,3]
'value'
>>> m
Matrix({2: {3: 'value'}}, 0) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T17:53:32.313

也许[pyeuclid](http://code.google.com/p/pyeuclid/)符合您的需求——（过时但可用）格式的文档在[这里](http://partiallydisassembled.net/euclid/)，ReST 格式的最新文档在pyeuclid 源中的此文[本文件](http://code.google.com/p/pyeuclid/source/browse/trunk/euclid.txt)中（要对 ReST 文本进行自己的格式化，请使用[docutils](http://docutils.sourceforge.net/rst.html)）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-07T09:56:58.803

我写了课。不知道它是好还是多余，但是...在这里发布[http://bitbucket.org/pieceofpeace/container2d/](http://bitbucket.org/pieceofpeace/container2d/)

# c# - 如何递归列出C#目录中的所有文件？

> ID：929276
> 
> 赞同：376
> 
> 时间：2009-05-30T07:47:09.747
> 
> 标签：c#, .net

如何在C#中递归列出目录和子目录中的所有文件？

* * *

## 回答 #1

> 赞同：494
> 
> 时间：2009-05-30T09:21:55.970

请注意，在 .NET 4.0 中，内置了（据说）基于迭代器（而不是基于数组）的文件函数：

```
foreach (string file in Directory.EnumerateFiles(path, "*.*", SearchOption.AllDirectories))
{
    Console.WriteLine(file);
} 
```

目前我会使用类似下面的东西；如果您无权访问单个子目录，则内置递归方法太容易中断...；这种`Queue<string>`用法避免了过多的调用堆栈递归，迭代器块避免了我们拥有一个巨大的数组。

```
static void Main() {
    foreach (string file in GetFiles(SOME_PATH)) {
        Console.WriteLine(file);
    }
}

static IEnumerable<string> GetFiles(string path) {
    Queue<string> queue = new Queue<string>();
    queue.Enqueue(path);
    while (queue.Count > 0) {
        path = queue.Dequeue();
        try {
            foreach (string subDir in Directory.GetDirectories(path)) {
                queue.Enqueue(subDir);
            }
        }
        catch(Exception ex) {
            Console.Error.WriteLine(ex);
        }
        string[] files = null;
        try {
            files = Directory.GetFiles(path);
        }
        catch (Exception ex) {
            Console.Error.WriteLine(ex);
        }
        if (files != null) {
            for(int i = 0 ; i < files.Length ; i++) {
                yield return files[i];
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：223
> 
> 时间：2009-05-30T07:50:32.563

[本文](http://support.microsoft.com/kb/303974)涵盖了您需要的所有内容。除了搜索文件和比较名称之外，只需打印出名称即可。

可以这样修改：

```
static void DirSearch(string sDir)
{
    try
    {
        foreach (string d in Directory.GetDirectories(sDir))
        {
            foreach (string f in Directory.GetFiles(d))
            {
                Console.WriteLine(f);
            }
            DirSearch(d);
        }
    }
    catch (System.Exception excpt)
    {
        Console.WriteLine(excpt.Message);
    }
} 
```

**由 barlop 添加**

GONeale 提到上面没有列出当前目录中的文件，并建议将文件列表部分放在获取目录的部分之外。以下将做到这一点。它还包括一个可以取消注释的 Writeline 行，这有助于跟踪您在递归中的位置，这可能有助于显示调用以帮助显示递归的工作方式。

```
 DirSearch_ex3("c:\\aaa");
            static void DirSearch_ex3(string sDir)
            {
                //Console.WriteLine("DirSearch..(" + sDir + ")");
                try
                {
                    Console.WriteLine(sDir);

                    foreach (string f in Directory.GetFiles(sDir))
                    {
                        Console.WriteLine(f);
                    }

                    foreach (string d in Directory.GetDirectories(sDir))
                    {
                        DirSearch_ex3(d);
                    }
                }
                catch (System.Exception excpt)
                {
                    Console.WriteLine(excpt.Message);
                }
            } 
```

* * *

## 回答 #3

> 赞同：135
> 
> 时间：2014-04-23T19:48:43.603

```
Directory.GetFiles("C:\\", "*.*", SearchOption.AllDirectories) 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2020-05-28T19:43:37.520

最短记录

```
string[] files = Directory.GetFiles(@"your_path", "*.jpg", SearchOption.AllDirectories); 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2013-07-16T02:48:08.567

至少在 .NET 4.5 中，这个版本要短得多，并且具有评估任何文件标准以包含在列表中的额外好处：

```
public static IEnumerable<string> GetAllFiles(string path, 
                                              Func<FileInfo, bool> checkFile = null)
{
    string mask = Path.GetFileName(path);
    if (string.IsNullOrEmpty(mask)) mask = "*.*";
    path = Path.GetDirectoryName(path);
    string[] files = Directory.GetFiles(path, mask, SearchOption.AllDirectories);

    foreach (string file in files)
    {
        if (checkFile == null || checkFile(new FileInfo(file)))
            yield return file;
    }
} 
```

像这样使用：

```
var list = GetAllFiles(mask, (info) => Path.GetExtension(info.Name) == ".html").ToList(); 
```

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2014-09-18T22:29:00.640

```
IEnumerable<string> GetFilesFromDir(string dir) =>
 Directory.EnumerateFiles(dir).Concat(
 Directory.EnumerateDirectories(dir)
          .SelectMany(subdir => GetFilesFromDir(subdir))); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-08-30T07:45:33.613

一些很好的答案，但这些答案并没有解决我的问题。

一旦出现文件夹权限问题：“权限被拒绝”，代码就会失败。这是我用来解决“权限被拒绝”问题的方法：

```
private int counter = 0;

    private string[] MyDirectories = Directory.GetDirectories("C:\\");

    private void ScanButton_Click(object sender, EventArgs e)
    {
        Thread MonitorSpeech = new Thread(() => ScanFiles());
        MonitorSpeech.Start();
    }

    private void ScanFiles()
    {
        string CurrentDirectory = string.Empty;

        while (counter < MyDirectories.Length)
        {
            try
            {
                GetDirectories();
                CurrentDirectory = MyDirectories[counter++];
            }
            catch
            {
                if (!this.IsDisposed)
                {
                    listBox1.Invoke((MethodInvoker)delegate { listBox1.Items.Add("Access Denied to : " + CurrentDirectory); });
                }
            }
        }
    }

    private void GetDirectories()
    {
        foreach (string directory in MyDirectories)
        {
            GetFiles(directory);
        }
    }

    private void GetFiles(string directory)
    {
        try
        {
            foreach (string file in Directory.GetFiles(directory, "*"))
            {
                listBox1.Invoke((MethodInvoker)delegate { listBox1.Items.Add(file); });
            }
        }
        catch
        {
            listBox1.Invoke((MethodInvoker)delegate { listBox1.Items.Add("Access Denied to : " + directory); });
        }
    } 
```

希望这对其他人有帮助。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-09-23T21:12:21.723

在 Framework 2.0 中，您可以使用（它列出了根文件夹的文件，这是最好的最流行的答案）：

```
static void DirSearch(string dir)
{
    try
    {
        foreach (string f in Directory.GetFiles(dir))
            Console.WriteLine(f);
        foreach (string d in Directory.GetDirectories(dir))
        {
            Console.WriteLine(d);
            DirSearch(d);
        }

    }
    catch (System.Exception ex)
    {
        Console.WriteLine(ex.Message);
    }
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-08-07T16:47:57.563

**一个简单而干净的解决方案**

```
/// <summary>
/// Scans a folder and all of its subfolders recursively, and updates the List of files
/// </summary>
/// <param name="sFullPath">Full path of the folder</param>
/// <param name="files">The list, where the output is expected</param>
internal static void EnumerateFiles(string sFullPath, List<FileInfo> fileInfoList)
{
    try
    {
        DirectoryInfo di = new DirectoryInfo(sFullPath);
        FileInfo[] files = di.GetFiles();

        foreach (FileInfo file in files)
            fileInfoList.Add(file);

        //Scan recursively
        DirectoryInfo[] dirs = di.GetDirectories();
        if (dirs == null || dirs.Length < 1)
            return;
        foreach (DirectoryInfo dir in dirs)
            EnumerateFiles(dir.FullName, fileInfoList);

    }
    catch (Exception ex)
    {
        Logger.Write("Exception in Helper.EnumerateFiles", ex);
    }
} 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-11-08T15:58:29.890

我更喜欢使用 DirectoryInfo，因为我可以获得 FileInfo，而不仅仅是字符串。

```
 string baseFolder = @"C:\temp";
        DirectoryInfo di = new DirectoryInfo(baseFolder);

        string searchPattern = "*.xml";

        ICollection<FileInfo> matchingFileInfos = di.GetFiles(searchPattern, SearchOption.AllDirectories)
            .Select(x => x)
            .ToList(); 
```

我这样做是为了将来我需要基于 FileInfo 的属性进行过滤。

```
 string baseFolder = @"C:\temp";
        DirectoryInfo di = new DirectoryInfo(baseFolder);

        string searchPattern = "*.xml";

        ICollection<FileInfo> matchingFileInfos = di.GetFiles(searchPattern, SearchOption.AllDirectories)
            .Where(x => x.LastWriteTimeUtc < DateTimeOffset.Now)
            .Select(x => x)
            .ToList(); 
```

如果需要，我也可以求助于字符串。（并且对于过滤器/where子句的东西仍然是未来的证明。

```
 string baseFolder = @"C:\temp";
        DirectoryInfo di = new DirectoryInfo(baseFolder);

        string searchPattern = "*.xml";

        ICollection<string> matchingFileNames = di.GetFiles(searchPattern, SearchOption.AllDirectories)
            .Select(x => x.FullName)
            .ToList(); 
```

请注意，“ *.* ”是一个有效的搜索模式，如果您想通过扩展名进行归档。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2021-09-26T09:58:59.170

这就是我们如何获取文件作为其子目录的 FileInfo，

```
var dir = new DirectoryInfo(rootPath);
FileInfo[] files = dir.GetFiles("*.*", SearchOption.AllDirectories); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-01-27T18:37:03.633

```
private void GetFiles(DirectoryInfo dir, ref List<FileInfo> files)
{
    try
    {
        files.AddRange(dir.GetFiles());
        DirectoryInfo[] dirs = dir.GetDirectories();
        foreach (var d in dirs)
        {
            GetFiles(d, ref files);
        }
    }
    catch (Exception e)
    {

    }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-04-19T14:56:56.760

为了避免`UnauthorizedAccessException`，我使用：

```
var files = GetFiles(@"C:\", "*.*", SearchOption.AllDirectories);
foreach (var file in files)
{
    Console.WriteLine($"{file}");
}

public static IEnumerable<string> GetFiles(string path, string searchPattern, SearchOption searchOption)
{
    var foldersToProcess = new List<string>()
    {
        path
    };

    while (foldersToProcess.Count > 0)
    {
        string folder = foldersToProcess[0];
        foldersToProcess.RemoveAt(0);

        if (searchOption.HasFlag(SearchOption.AllDirectories))
        {
            //get subfolders
            try
            {
                var subfolders = Directory.GetDirectories(folder);
                foldersToProcess.AddRange(subfolders);
            }
            catch (Exception ex)
            {
                //log if you're interested
            }
        }

        //get files
        var files = new List<string>();
        try
        {
            files = Directory.GetFiles(folder, searchPattern, SearchOption.TopDirectoryOnly).ToList();
        }
        catch (Exception ex)
        {
            //log if you're interested
        }

        foreach (var file in files)
        {
            yield return file;
        }
    }
} 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-04-07T07:23:50.643

如果您只需要文件名，并且由于我不太喜欢这里的大多数解决方案（功能方面或可读性方面），那么这个懒惰的解决方案怎么样？

```
private void Foo()
{
  var files = GetAllFiles("pathToADirectory");
  foreach (string file in files)
  {
      // Use can use Path.GetFileName() or similar to extract just the filename if needed
      // You can break early and it won't still browse your whole disk since it's a lazy one
  }
}

/// <exception cref="T:System.IO.DirectoryNotFoundException">The specified path is invalid (for example, it is on an unmapped drive).</exception>
/// <exception cref="T:System.UnauthorizedAccessException">The caller does not have the required permission.</exception>
/// <exception cref="T:System.IO.IOException"><paramref name="path" /> is a file name.-or-A network error has occurred.</exception>
/// <exception cref="T:System.IO.PathTooLongException">The specified path, file name, or both exceed the system-defined maximum length. For example, on Windows-based platforms, paths must be less than 248 characters and file names must be less than 260 characters.</exception>
/// <exception cref="T:System.ArgumentNullException"><paramref name="path" /> is null.</exception>
/// <exception cref="T:System.ArgumentException"><paramref name="path" /> is a zero-length string, contains only white space, or contains one or more invalid characters as defined by <see cref="F:System.IO.Path.InvalidPathChars" />.</exception>
[NotNull]
public static IEnumerable<string> GetAllFiles([NotNull] string directory)
{
  foreach (string file in Directory.GetFiles(directory))
  {
    yield return file; // includes the path
  }

  foreach (string subDir in Directory.GetDirectories(directory))
  {
    foreach (string subFile in GetAllFiles(subDir))
    {
      yield return subFile;
    }
  }
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-04-28T12:36:11.437

一些带有 max lvl 的改进版本可以进入目录和排除文件夹的选项：

```
using System;
using System.IO;

class MainClass {
  public static void Main (string[] args) {

    var dir = @"C:\directory\to\print";
    PrintDirectoryTree(dir, 2, new string[] {"folder3"});
  }

  public static void PrintDirectoryTree(string directory, int lvl, string[] excludedFolders = null, string lvlSeperator = "")
  {
    excludedFolders = excludedFolders ?? new string[0];

    foreach (string f in Directory.GetFiles(directory))
    {
        Console.WriteLine(lvlSeperator+Path.GetFileName(f));
    } 

    foreach (string d in Directory.GetDirectories(directory))
    {
        Console.WriteLine(lvlSeperator + "-" + Path.GetFileName(d));

        if(lvl > 0 && Array.IndexOf(excludedFolders, Path.GetFileName(d)) < 0)
        {
          PrintDirectoryTree(d, lvl-1, excludedFolders, lvlSeperator+"  ");
        }
    }
  }
} 
```

输入目录：

```
-folder1
  file1.txt
  -folder2
    file2.txt
    -folder5
      file6.txt
  -folder3
    file3.txt
  -folder4
    file4.txt
    file5.txt 
```

函数的输出（由于 lvl 限制，排除了 folder5 的内容，排除了 folder3 的内容，因为它位于 excludeFolders 数组中）：

```
-folder1
  file1.txt
  -folder2
    file2.txt
    -folder5
  -folder3
  -folder4
    file4.txt
    file5.txt 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2014-03-04T17:10:00.727

这是我基于 Hernaldo 的观点，如果您需要查找具有特定模式名称的文件，例如名称中某处包含特定字符串的 XML 文件：

```
// call this like so: GetXMLFiles("Platypus", "C:\\");
public static List<string> GetXMLFiles(string fileType, string dir)
{
    string dirName = dir; 
    var fileNames = new List<String>();
    try
    {
        foreach (string f in Directory.GetFiles(dirName))
        {
            if ((f.Contains(fileType)) && (f.Contains(".XML")))
            {
                fileNames.Add(f);
            }
        }
        foreach (string d in Directory.GetDirectories(dirName))
        {
            GetXMLFiles(fileType, d);
        }
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message);
    }
    return fileNames;
} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-07-01T10:02:00.690

列出要建模的文件和文件夹，自定义实现。
这将创建从您的起始目录开始的所有文件和文件夹的完整列表。

```
public class DirOrFileModel
    {
        #region Private Members

        private string _name;
        private string _location;
        private EntryType _entryType;

        #endregion

        #region Bindings

        public string Name
        {
            get { return _name; }
            set
            {
                if (value == _name) return;
                _name = value;
            }
        }

        public string Location
        {
            get { return _location; }
            set
            {
                if (value == _location) return;
                _location = value;
            }
        }

        public EntryType EntryType
        {
            get { return _entryType; }
            set
            {
                if (value == _entryType) return;
                _entryType = value;
            }
        }

        public ObservableCollection<DirOrFileModel> Entries { get; set; }

        #endregion

        #region Constructor

        public DirOrFileModel()
        {
            Entries = new ObservableCollection<DirOrFileModel>();
        }

        #endregion
    }

    public enum EntryType
    {
        Directory = 0,
        File = 1
    } 
```

方法：

```
 static DirOrFileModel DirSearch(DirOrFileModel startDir)
        {
            var currentDir = startDir;
            try
            {
                foreach (string d in Directory.GetDirectories(currentDir.Location))
                {
                    var newDir = new DirOrFileModel
                    {
                        EntryType = EntryType.Directory,
                        Location = d,
                        Name = Path.GetFileName(d)
                    };
                    currentDir.Entries.Add(newDir);

                    DirSearch(newDir);
                }

                foreach (string f in Directory.GetFiles(currentDir.Location))
                {
                    var newFile = new DirOrFileModel
                    {
                        EntryType = EntryType.File,
                        Location = f,
                        Name = Path.GetFileNameWithoutExtension(f)
                    };
                    currentDir.Entries.Add(newFile);
                }

            }
            catch (Exception excpt)
            {
                Console.WriteLine(excpt.Message);
            }
            return startDir;
        } 
```

用法：

```
var dir = new DirOrFileModel
            {
                Name = "C",
                Location = @"C:\",
                EntryType = EntryType.Directory
            };

            dir = DirSearch(dir); 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-11-15T12:35:31.787

简短而简单的解决方案

```
string dir = @"D:\PATH";

DateTime from_date = DateTime.Now.Date;
DateTime to_date = DateTime.Now.Date.AddHours(23);
var files = Directory.EnumerateFiles(dir, "*.*",SearchOption.AllDirectories).Select(i=>new FileInfo(i))
.Where(file=>file.LastWriteTime >= from_date && file.LastWriteTime <= to_date);
foreach(var fl in files)
    Console.WriteLine(fl.FullName); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-05-23T06:59:48.327

这个帮助我获取目录和子目录中的所有文件，可能对某人有帮助。[灵感来自上述答案]

```
static void Main(string[] args)
    {
        try
        {
            var root = @"G:\logs";
            DirectorySearch(root);
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        }
        Console.ReadKey();
    }

public static void DirectorySearch(string root, bool isRootItrated = false)
{
    if (!isRootItrated)
    {
        var rootDirectoryFiles = Directory.GetFiles(root);
        foreach (var file in rootDirectoryFiles)
        {
            Console.WriteLine(file);
        } 
    }

    var subDirectories = Directory.GetDirectories(root);
    if (subDirectories?.Any() == true)
    {
        foreach (var directory in subDirectories)
        {
            var files = Directory.GetFiles(directory);
            foreach (var file in files)
            {
                Console.WriteLine(file);
            }
            DirectorySearch(directory, true);
        }
    }
} 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-05-30T09:55:29.133

```
var d = new DirectoryInfo(@"C:\logs");
var list = d.GetFiles("*.txt").Select(m => m.Name).ToList(); 
```

* * *

## 回答 #21

> 赞同：-1
> 
> 时间：2014-04-12T07:14:13.487

这是 B. Clay Shannon 的代码的一个版本，它对于 excel 文件不是静态的：

```
class ExcelSearcher
{
    private List<string> _fileNames;

    public ExcelSearcher(List<string> filenames)
    {
        _fileNames = filenames;
    }
    public List<string> GetExcelFiles(string dir, List<string> filenames = null)
    {

        string dirName = dir;
        var dirNames = new List<string>();
        if (filenames != null)
        {
            _fileNames.Concat(filenames);
        }
        try
        {
            foreach (string f in Directory.GetFiles(dirName))
            {
                if (f.ToLower().EndsWith(".xls") || f.ToLower().EndsWith(".xlsx"))
                {
                    _fileNames.Add(f);
                }
            }
            dirNames = Directory.GetDirectories(dirName).ToList();
            foreach (string d in dirNames)
            {
                GetExcelFiles(d, _fileNames);
            }
        }
        catch (Exception ex)
        {
            //Bam
        }
        return _fileNames;
    } 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2019-01-06T09:55:47.067

一个非常简单的解决方案，返回文件列表。

```
 public static List<string> AllFilesInFolder(string folder)
    {
        var result = new List<string>();

        foreach (string f in Directory.GetFiles(folder))
        {
            result.Add(f);
        }

        foreach (string d in Directory.GetDirectories(folder))
        {
            result.AddRange(AllFilesInFolder(d));
        }

        return result;
    } 
```

* * *

## 回答 #23

> 赞同：-3
> 
> 时间：2014-07-12T08:30:59.070

```
static void Main(string[] args)
        {
            string[] array1 = Directory.GetFiles(@"D:\");
            string[] array2 = System.IO.Directory.GetDirectories(@"D:\");
            Console.WriteLine("--- Files: ---");
            foreach (string name in array1)
            {
                Console.WriteLine(name);
            }
            foreach (string name in array2)
            {
                Console.WriteLine(name);
            }
                  Console.ReadLine();
        } 
```

# c - 有没有用 C 语言构建 Windows UI 的轻松方法？

> ID：929280
> 
> 赞同：5
> 
> 时间：2009-05-30T07:53:01.047
> 
> 标签：c, user-interface, winapi

# 编辑

好吧，我猜C本质上是痛苦的——只是，这部分，特别痛苦。此外，我只用 C 语言编写并
没有*真正的原因，除了，这是我现在想要编写并精通的语言。*我知道从 C 迁移到 C++ 是不好的，但无论如何。

有没有人知道我在程序中制作多个窗口的问题的解决方案？

* * *

好吧，我*正在*将 C DLL 与 VB6 前端接口，但是——尝试来回传递字符串变得很丑陋，而且似乎每次我添加一个新函数时，*其他一切*都会中断。所以，我想，我为什么要让自己经历所有这些痛苦，只是为了与一种甚至不再受支持的语言交互？为什么不把这些痛苦更好地利用并学习用 C 构建前端呢？

好吧，我开始了，但我不得不问：有没有简单的方法可以做到这一点？WndProc 的巨大 switch 语句伤害了我的眼睛，并且与我学到的关于干净代码的所有内容背道而驰（很像 12 参数 CreateWindowEx() 或 14 参数 CreateFont()）。

我意识到我可以在一定程度上重构这一切——如果我使用 C++，我可以将窗口及其组件放入类中，并以一种更自然的方式访问它们，我想...

无论如何，我设法构建了一个名为“主窗口！”的大表单，带有“弹出消息！” 按钮，效果很好——而且一点也不复杂。然后是“更改该文本！” 更改编辑控件中的文本的按钮。为此，WndProc 必须在`WM_COMMAND`从按钮接收消息时了解编辑控件。我不能将编辑控件的 hWnd 传递给它，因为我不是调用它的人，你*不能只向 WndProc 添加参数。*所以我不得不把编辑控件放在全局范围内。

我想将按钮的字体更改为 13pt Tahoma——很简单，对吧？当然——但我无法比`WM_PARENTNOTIFY`消息更进一步……在仔细阅读了 MSDN 之后，我发现有些信息在 wParam 的高位字中，有些在低位字中。所以，我不得不写这个：`if(wParam==(WM_CREATE | (POPUP_COMMAND<<16))){`

使控件全球化？巨大的switch语句？12和14参数函数调用？简单通知的位移？我什至不知道如何让更多的一个窗口（窗口窗口，而不是控制窗口）出现——这很痛苦......

请告诉我有更好的方法！

顺便说一句，我如何制作多个窗口？如果我只注册两个类，或者在同一个类上两次 CreateWindowEx（对于两个句柄），则只会出现第一个。我尝试了一点 dwStyle 参数，但无济于事。任何人？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-30T08:04:22.130

作为 C Windows 编程的前任讲师，我可以肯定地说，使用 C 构建 GUI 没有简单的方法——这种语言不太适合这项任务。几乎其他任何东西都是更好的选择——我自己最喜欢的 GUI 开发是 Delphi。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-30T09:51:15.927

Win32 + C 是一种非常底层的方法，它有它的优点和缺点。也就是说，有一些方法可以让事情变得更容易。

首先，关于位移，有[几个宏可用于 WPARAM 和 LPARAM](http://msdn.microsoft.com/en-us/library/dd469352.aspx)。实际上，您可能不应该编写位移，因为[多年来 WPARAM 和 LPARAM 的大小发生了变化](https://devblogs.microsoft.com/oldnewthing/20031125-00/?p=41713)，并且您可能正在创建一个未来的错误。

其次，关于 WindowProc 函数中的巨大 switch 语句，虽然它会在那里，但有一种方法可以使它更易于管理。 `#include <windowsx.h>`获得一大堆有用的宏，尤其是 HANDLE_MSG。而不是需要写

```
LRESULT CALLBACK MyWindowProc(HWND hwnd, UINT Message, WPARAM wParam, LPARAM lParam)    {
    switch(Message) {
    case WM_COMMAND:
        ...
    }
} 
```

你可以改为写：

```
void MyOnCommand(HWND hwnd, int controlID, HWND hwndCtl, UINT codeNotify);
LRESULT CALLBACK MyWindowProc(HWND hwnd, UINT Message, WPARAM wParam, LPARAM lParam)    {
    switch(Message) {
    HANDLE_MSG(hwnd, WM_COMMAND, MyOnCommand);
    }
} 
```

并且宏会自动将该消息类型的所有不同参数转换并分离为适当命名和类型化的变量。浏览`windowsx.h`以查看已处理的消息及其所需的函数原型。并非所有不同的消息都被处理，但相当多的消息被处理。

至于一次拥有多个窗口，不应该有任何东西阻止您多次调用 CreateWindow 或其亲属。虽然您只有一个`HINSTANCE`（在您的 中给您`WinMain`），但您可以拥有任意数量的`HWND`s。

您可能会发现[Raymond Chen 的草稿程序](https://devblogs.microsoft.com/oldnewthing/20030723-00/?p=43073)很有用，因为它应该为您提供一个不错的框架来开始。您也可以考虑让您的应用程序使用[对话框](http://msdn.microsoft.com/en-us/library/ms632588.aspx)而不仅仅是一个窗口；您可以免费获得一堆东西，并且可以使用资源编辑器来设计窗口及其所有控件。 [Visual C++ Standard 及以上](http://msdn.microsoft.com/en-us/library/hs24szh9.aspx)版本包括一个资源编辑器，还有几个免费的： [XN Resource Editor](http://www.wilsonc.demon.co.uk/d10resourceeditor.htm)似乎是一个流行的开源编辑器，我相信你可以在谷歌上找到更多。所有这些都会生成一个资源脚本，并且您的工具链中应该有一个资源编译器：用于 Visual Studio 的[rc.exe](http://msdn.microsoft.com/en-us/library/aa381042.aspx)（包括 Express Edition，或作为 SDK 的一部分提供），或者[windres](http://sourceware.org/binutils/docs/binutils/windres.html)作为 cygwin 或 mingw 中的 GNU BinUtils 的一部分。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-30T10:25:17.073

我将提出我传统的开箱即用建议：将[Lua](http://www.lua.org/)添加到您的应用程序中，并结合 Lua 和合适的工具包模块构建 GUI。一个不错的选择是[IUP](http://www.tecgraf.puc-rio.br/iup/)，另一个是[wxWidgets](http://www.wxwidgets.org/)。两者都有质量不错的 Lua 绑定。更好的是，Lua 本身以及 wxLua 和 IUP 可以与[Lua for Windows](http://luaforwindows.luaforge.net/)项目中的许多其他有用的 Lua 模块一起安装在一个单独的安装中。

Lua 很容易与 C 代码集成，因为它从一开始就是为此目的而设计的。

使用 Lua 作为将应用程序结合在一起的粘合剂也很容易，核心功能用 C 实现或作为本地 API 调用的接口。

[SWIG](http://www.swig.org/)也支持 Lua ，以防你有一个广泛的库需要适应。

当然，您可以直接从 C 中使用 wxWidgets 或 IUP，因为它们都具有 C 可调用 API，但事件驱动的 GUI 通常充满挑剔的小内务回调函数，这些回调函数很容易用脚本语言处理.

另一个需要考虑的工具包是[Tk](http://en.wikipedia.org/wiki/Tk_(computing))，它最常与[Tcl](http://www.tcl.tk/)脚本语言结合使用。Tcl 在开发时也考虑到了嵌入到更大的应用程序中，尽管它已经从它的主要用例演变而来。Tk 已绑定到多种其他语言，包括 Perl。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-30T08:48:04.117

我从来没有真正见过用纯 C 编写 Win32 的东西的问题，我实际上认为它比我尝试过的替代方案（MFC、WTL、QT 和其他一些）更干净。一些简单的指针：

*   关于高位和低位字参数，有很好的宏可以为您处理——不过，这些名称现在让我难以理解。

*   通过分配“应用程序”结构并使用 SetWindowLong() 存储其地址，您可以以一种相当不错的面向对象方式工作，这解决了您拥有全局句柄的问题。

*   您可以从 WM_MESSAGE -> 函数指针创建一个相当简单的映射，以减轻窗口进程中长开关的可重复性，或者将其重构为更简单的函数以获得更好的概览。

所以，总而言之，写出漂亮干净的东西是可能的，但这很难。不过，其他所有方法也是如此，唯一不同的是“可能”和“困难”的值:)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-30T08:20:03.770

有一个更好的办法。使用 Qt。它适用于 C++，但 C++ 更适合 GUI，因为它的面向对象模型非常适合该领域。Qt 本身是一个很棒的库，具有惊人的深度和广度，得到很好的支持和设计，获得了 LGPL 许可并且使用起来很有趣。它带有一个完整的 GUI 设计器，可以帮助您以图形方式非常快速地构建对话框。

如果你坚持使用 C 和原生 Win32，还有一种方法。购买 Petzold 的[Programming Windows](http://www.charlespetzold.com/pw5/)书 - 非常好。在阅读了前几章之后，您将能够相对容易地用 C 构建有趣的 GUI。与使用 Qt 相比，将需要更多的代码和工作量，但积极的一面是，您将获得无需外部依赖的小型且快速的可执行文件。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-30T10:16:07.827

理想情况下，GUI 由比 C 更抽象的语言处理，否则会有很多冗余的样板代码，从这个意义上说，我建议您考虑将脚本语言解释器嵌入到您的 C 应用程序中，以便 GUI 主要由脚本驱动，而您的应用程序的核心是用 C 编码的。

这还具有使您的应用程序更可配置和更灵活的优势，而无需重新编译。

您将需要研究用 ANSI C 编写的轻量级脚本引擎，这些引擎提供与 QT、GTK、wxWindows 等 GUI 库的绑定。

您可能想检查一下[Lua](http://www.lua.org)或[鼻腔](http://plausible.org/nasal)，它们都相当轻量级并且确实为 GUI 库提供绑定。

对于某些示例用途，您可能需要查看以下两个应用程序的屏幕截图，这些应用程序具有主要基于鼻腔及其 GTK 绑定的 GUI：

*   [KyCE II - Kymatica 组合环境](http://www.bitminds.net/kymatica/uploads/Software/kyce_screenshot2.png)
*   [算法评分](http://www.bitminds.net/kymatica/uploads/Software/algoscore_screenshot7.png)
*   [算法评分](http://www.bitminds.net/kymatica/uploads/Software/algoscore_screenshot5.png)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-30T17:21:46.807

如果你想用 C 语言来做，你肯定想要 Charles Petzold 的 Programming Windows。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-30T09:03:15.680

只是为了让您了解在 Win UI 应用程序中 C 与其他语言的比较：前段时间，一个**简单的 MDI 应用程序有几个窗口和几个类**来可视化医疗数据，我花了**17k 行 C 代码**。几年后，我在**Delphi**中重写了这个，只用了**5k LOCs**。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-30T17:40:58.107

使用[GTK+](http://www.gtk.org/)，您可以使用[Glade](http://glade.gnome.org/)来构建 UI。

# blackberry - 如何将数据写入黑莓中的套接字？

> ID：929284
> 
> 赞同：1
> 
> 时间：2009-05-30T07:55:14.070
> 
> 标签：blackberry, sockets

我两次向服务器发送数据。首先，我发送“Hello world”，然后发送“Server”。但是服务器在 1 读取时收到了数据。但是服务器必须在两次读取操作中读取数据。

另外，我写数据。然后从服务器读取数据，然后我写入数据。在这种情况下，服务器可以读取第一个数据。但是服务器无法读取第二个数据。服务器使用读、写、读。

那么如何克服这个问题呢？如何将数据写入 BlackBerry 中的套接字？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-10T00:41:23.703

您所描述的是默认情况下 TCP 应该如何工作。您所看到的是 Nagle 算法 (RFC 896) 在工作中，它减少了发送的出站数据包的数量，以便尽可能高效地处理它们。您可能在代码中发送 2 个数据包，但它们作为 1 个数据包一起传输。由于 TCP 是一个字节流，因此接收方不应该对它收到多少数据包做出任何假设。您必须在更高级别的协议中界定您的数据包数据，并且接收方必须根据该协议处理数据。它必须处理多个数据包在单个读取中到达、单个 pakcet 在多个读取中到达以及介于两者之间的情况，仅在完整接收到数据包数据时处理它们，缓存剩余的内容以供后续读取处理需要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T00:53:07.220

很难说没有更多细节，但听起来您在第一种情况下使用单向通信 - 即客户端写入，然后再次写入。服务器将 2 次写入接收为 1 次读取的原因有很多。在客户端缓冲，在无线堆栈（或 BES 中）的某个位置，在服务器端缓冲。所有这些对于 TCP/IP 都是合法的。

在不了解您的解决方案的更多信息的情况下，您是否考虑过定义一个小协议 - 即客户端在发送第二次写入之前写入一个或多个已知字节（如 0 字节？）？然后服务器可以读取，然后识别定界字节，并说'啊哈，现在这是与客户端不同的写入'？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-17T00:55:00.290

如前所述，这是节省带宽的预期 TCP 行为。请注意，传送您的包[TCP](http://en.wikipedia.org/wiki/Transmission_Control_Protocol)会添加大量数据（例如目标端口、序列号、校验和...）。

我建议您在协议中投入更多工作，而不是刷新数据。例如，您可以定义一个标头，其中包含要读取的字节数，然后是有效负载（实际数据）。

下面的代码是一个用 [length];[data] 结构的字符串编码的协议

```
StringBuffer headerStr = new StringBuffer();
StringBuffer data = new StringBuffer();
//read header
char headerByte = dataInputStream.readChar();
while (headerByte != ';') {
  headerStr.append(headerByte);
  headerByte = dataInputStream.readChar();
}
//header has the number of character to read
int header= Integer.parseInt(headerStr.toString());
int bytesReaded = 1;
char dataByte = dataInputStream.readChar();
//we should read the number of characters indicated in the header
while (bytesReaded < header) {
 data.append(dataByte);
 dataByte = dataInputStream.readChar();
 bytesReaded++;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T12:22:26.337

对于第一个查询，我猜您使用的是 TCP。如果您使用 UDP，那么服务器将按照您想要的顺序读取数据包。

您能否对第二个查询更加清晰/详尽？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T12:16:41.810

我会尝试明确告诉 Connector.open 以 read_write 的形式打开流。然后我会确保在每次与服务器交谈后刷新我的连接。

```
SocketConnection connection = (SocketConnection) Connector.open(url, Connector.READ_WRITE);
OutputStream out = connection.openOutputStream();
// ... write to server
out.flush() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-02T05:57:08.140

我有一个解决方案来克服提取字符串

**在发件人设备上**

*   创建一个包含该数据详细信息的标头，例如数据长度、数据类型等。
*   将此标头添加到实际数据并发送

**在接收设备上**

*   阅读标题
*   从标头中检索实际数据长度
*   读取下一个数据，直到数据头指定的数据长度

# syntax - JasperReports 中直接嵌入子报表

> ID：929290
> 
> 赞同：5
> 
> 时间：2009-05-30T08:02:11.310
> 
> 标签：syntax, jasper-reports, embedded-resource, subreport

我非常接近这项工作，我正在尝试将一个碧玉子报表直接嵌入到另一个的主报表 xml 中。你会认为这很容易，但我找不到一个这样做的例子。每个人似乎都使用文件或资源或其他任何东西。我有一个直接从字符串工作的报告，我希望它包含它的子报告。

任何人？句法？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-11T20:52:53.990

我知道使用 JasperReports 执行此操作的唯一方法是为子报表使用单独的 .jrxml 文件，并使用`subreport`命令将其包含在主报表中。

任何嵌入式报告的另一个选择是使用子数据集，但据我所知，它们仅对图表有用。

听起来您控制了围绕报告生成的代码，您可以提出一种简单的格式来在一个字符串中定义多个报告，然后让您的代码在运行时提取每个报告。

当我们需要处理单个文件但有 JasperReport 的子报表时，我们使用了 Zip 文件，只需压缩主报表和所有必要的子报表，然后在需要时将它们解压缩到临时目录中到（当然都在代码中）

# .net - 在 .net 中使用非托管代码

> ID：929292
> 
> 赞同：2
> 
> 时间：2009-05-30T08:03:06.517
> 
> 标签：.net, unmanaged

案子：

有一个 .net 应用程序调用非托管 C 代码。为此使用的方法：

```
public static class MiracleCreator
{
    [DllImport("Library.dll")]
    private static extern void RunUnmanaged(string fileName);

    public static void Run(string fileName)
    {
        RunUnmanaged(fileName);
    }
} 
```

它用于 Windows 窗体应用程序，所需的文件名由 OpenFileDialog 获得。代码：

```
if (openFileDialog.ShowDialog() == DialogResult.OK)
{
    MiracleCreator.Run(openFileDialog.FileName);
} 
```

问题：

在 Windows 窗体应用程序中多次执行代码后，openFileDialog 被破坏并出现异常：*“试图读取或写入受保护的内存。这通常表明其他内存已损坏。”*

在寻找解决方案时：

尝试“更可靠”地使用 OpenFileDialog 并没有帮助。像这个解决方案（试图给出链接，但“新用户不允许添加超链接”:)）：

```
public class Invoker
{
    public OpenFileDialog InvokeDialog;
    private Thread InvokeThread;
    private DialogResult InvokeResult;

    public Invoker()
    {
        InvokeDialog = new OpenFileDialog();
        InvokeThread = new Thread(new ThreadStart(InvokeMethod));
        InvokeThread.SetApartmentState(ApartmentState.STA);
        InvokeResult = DialogResult.None;
    }

    public DialogResult Invoke()
    {
        InvokeThread.Start();
        InvokeThread.Join();
        return InvokeResult;
    }

    private void InvokeMethod()
    {
        InvokeResult = InvokeDialog.ShowDialog();
    }
} 
```

用法 ：

```
 Invoker I = new Invoker();

        if (I.Invoke() == DialogResult.OK)
        {
            MessageBox.Show(I.InvokeDialog.FileName, "Test Successful.");
        }
        else
        {
            MessageBox.Show("Test Failed.");
        } 
```

问题：

异常真的是由非托管代码引起的吗？是否会出现其他可能的问题（破坏与 OpenFileDialog 不同的东西）？对此有什么更好的方法？

感谢您的每一个想法/解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T08:07:37.443

您应该为方法声明的参数指定适当的`MarshalAs`属性。`string`就像是：

```
[DllImport("Library.dll")]
private static extern void RunUnmanaged(
  [MarshalAs(UnmanagedType. ... )] string fileName); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-09T15:45:59.153

仅当使用从 db 加载的任何数据从模态表单`SaveFileDialog`公开时，通过 .NET Windows 窗体应用程序（在 Windows 7 32 位上运行）中的托管代码使用相同的错误。`saveAs`经过几个小时的调试和试错后，我的目光落在了一个我以前没有意识到的属性上：在 VB.NET 中，我写了

```
Dim sfv As New System.Windows.Forms.SaveFileDialog
   With sfv  
     .AutoUpgradeEnabled = False
     '[...] 
```

错误消失了。

# xcode - 在 Xcode 中调试时如何显示程序的所有线程

> ID：929317
> 
> 赞同：6
> 
> 时间：2009-05-30T08:20:09.337
> 
> 标签：xcode, macos

在 Xcode 中调试时如何显示我的程序的所有线程？我正在使用 eclipse 进行 java 调试，它可以显示程序中的所有当前线程，我可以暂停每个线程并显示它们当前的堆栈跟踪。我可以在 XCode 中做同样的事情吗？

谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2017-11-16T07:52:58.683

运行应用程序后，调试区域会自动出现。如果不是很可能是因为调试区域的可见性已被关闭。打开它。切换 xcode 窗口右上角的第一个视图控件，应该会出现调试区域。

[![在此处输入图像描述](https://i.stack.imgur.com/DoVoY.png)](https://i.stack.imgur.com/DoVoY.png)

完成后，将出现如下图所示的区域。 [![在此处输入图像描述](https://i.stack.imgur.com/QzBin.png)](https://i.stack.imgur.com/QzBin.png)

单击`show debug navigator`调试导航器控件中倒数第三个按钮。在项目名称旁边的那一行，有两个按钮，点击第二个

[![在此处输入图像描述](https://i.stack.imgur.com/K7Ep0.png)](https://i.stack.imgur.com/K7Ep0.png)

并选择按线程查看进程。 [![在此处输入图像描述](https://i.stack.imgur.com/TzIWS.png)](https://i.stack.imgur.com/TzIWS.png)

为了使线程出现，您的应用程序必须暂停。这可以通过在代码的特定点添加断点来完成，或者通过单击源编辑器下方调试栏上的暂停按钮手动完成。暂停后，线程会自动出现，如下所示。 [![在此处输入图像描述](https://i.stack.imgur.com/K9uGq.png)](https://i.stack.imgur.com/K9uGq.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T10:19:22.157

您可以在调试器视图中查看每个活动线程的堆栈跟踪。（运行->调试器）。在左上角面板中，您应该能够看到当前线程的堆栈跟踪。它应该在顶部显示类似“Thread-1”的内容，单击它，您可以选择任何其他线程，并查看它们各自的堆栈跟踪。

# sql - SQL 应该格式化输出还是只检索原始数据？

> ID：929318
> 
> 赞同：4
> 
> 时间：2009-05-30T08:20:14.597
> 
> 标签：sql

一般来说，我编写的 SQL 查询返回未格式化的数据，我将其留给表示层、网页或 Windows 应用程序，以根据需要格式化数据。和我一起工作的其他人，包括我的老板，都会坚持让数据库来做这件事更有效。我不确定我是否会购买它，并且相信即使通过让数据库执行此操作而获得了可衡量的性能提升，通常也有更令人信服的理由来避免这种情况。

例如，我将把查询放在数据访问层中，目的是尽可能地重用查询。鉴于此，我确定如果数据保持其本机类型而不是将数据转换为字符串并对它们应用格式化函数，例如，将日期列格式化为 DD，则查询更有可能被重用-MMM-YYYY 显示格式。当然，如果 SQL 将日期作为格式化字符串返回，您可以反转该过程以将值恢复为日期数据类型，但这似乎很尴尬，因为没有更好的词。此外，在格式化其他数据时，例如，由前缀、基数和后缀组成的机器序列号，在每个子字段中删除分隔破折号和前导零，当您朝另一个方向前进时，您可能无法正确恢复为原始序列号。也许这是一个不好的例子，但我希望你能看到我的方向......

更进一步，我看到人们编写非常复杂的 SQL，因为他们本质上是将我称之为表示逻辑的东西写入 SQL，而不是返回简单的数据，然后在表示层中应用这个表示逻辑。在我看来，这会导致非常复杂、难以维护和更脆弱的 SQL，难以适应变化。

以我在我们的系统中发现的以下真实示例为例，告诉我您的想法。我对这种方法给出的理由是，这使得 Web 应用程序可以非常简单地呈现页面，因为它在经典 ASP Web 应用程序中使用以下 1 行经典 ADO 逻辑片段来处理返回的行：

```
 oRS.GetString ( , , "</td>" & vbCrLf & "<td style=""font-size:x-small"" nowrap>" ,"</td>" & vbCrLf & "</tr>" & vbCrLf & "<tr>" & vbCrLf & _
     "<td style=""font-size:x-small"" nowrap>" ,"&nbsp;" ) & "</td>" & vbCrLf & "</tr>" & vbCrLf & _ 
```

这是 SQL 本身。虽然我很欣赏作者编写复杂 SQL 的能力，但我觉得这是一场维护噩梦。我疯了吗？SQL 正在返回当前针对我们的数据库运行的程序列表以及每个程序的状态：

因为当我粘贴到这里时 SQL 没有与 CR/LF 一起显示，所以我决定将 SQL 放在一个原本空的个人 Google 站点上。请随意发表评论。谢谢。

顺便说一句，这个 SQL 实际上是使用嵌套在经典 ASP 页面中的 VB 脚本构建的，而不是调用存储过程，所以如果你明白我的意思，你就会有嵌入连接和引用标记的额外复杂性，更不用说缺乏格式化。当我被要求帮助调试 SQL 时，我做的第一件事是添加 SQL 输出的 debug.print，然后通过我刚刚找到的 SQL 格式化程序将其抛出。在以下链接中粘贴时丢失了一些格式：

编辑（Andomar）：内联复制：（删除外部链接，谢谢乍得）

```
SELECT 
Substring(Datename("dw",start_datetime),1,3) 
+ ', '
+ Cast(start_datetime AS VARCHAR) "Start Time (UTC/GMT)"
,program_name "Program Name"
,run_sequence "Run Sequence"
,CASE 
WHEN batchno = 0
THEN Char(160)
WHEN batchno = NULL
THEN Char(160)
ELSE Cast(batchno AS VARCHAR)
END "Batch #" /* ,Replace(Replace(detail_log ,'K:\' ,'file://servernamehere/DiskVolK/') ,'\' ,'/') "log"*/ /* */
,Cast('<a href="GOIS_ViewLog.asp?Program_Name=' AS VARCHAR(99))
+ Cast(program_name AS VARCHAR)
+ Cast('&Run_Sequence=' AS VARCHAR)
+ Cast(run_sequence AS VARCHAR)
+ Cast('&Page=1' AS VARCHAR)
+ ''
+ Cast('">'
+ CASE 
WHEN end_datetime >= start_datetime
THEN CASE 
WHEN end_datetime <> 'Jan 1 1900 2:00 PM'
THEN CASE 
WHEN (success_code = 10
OR success_code = 0)
AND exit_code = 10
THEN CASE 
WHEN errorcount = 0
THEN 'Completed Successfully'
ELSE 'Completed with Errors'
END
WHEN success_code = 100
AND exit_code = 10
THEN 'Completed with Errors'
ELSE CASE 
WHEN program_name <> 'FileDepCheck'
THEN 'Failed'
ELSE 'File not found'
END
END
ELSE CASE 
WHEN success_code = 10
AND exit_code = 0
THEN 'Failed; Entries for Input File Missing'
ELSE 'Aborted'
END
END
ELSE CASE 
WHEN ((Cast(Datediff(mi,start_datetime,Getdate()) AS INT) <= 240)
OR ((SELECT 
Count(* )
FROM 
MASTER.dbo.sysprocesses a(nolock)
INNER JOIN gcsdwdb.dbo.update_log b(nolock)
ON a.program_name = b.program_name
WHERE a.program_name = update_log.program_name
AND (Abs(Datediff(n,b.start_datetime,a.login_time))) < 1) > 0))
THEN 'Processing...'
ELSE 'Aborted without end date'
END
END
+ '</a>' AS VARCHAR) "Status / Log"
,Cast('<a href="' AS VARCHAR)
+ Replace(Replace(detail_log,'K:\','file://servernamehere/DiskVolK/'),
'\','/')
+ Cast('" title="Click to view Detail log text file"' AS VARCHAR(99))
+ Cast('style="font-family:comic sans ms; font-size:12; color:blue"><img src="images\DetailLog.bmp" border="0"></a>' AS VARCHAR(999))
+ Char(160)
+ Cast('<a href="' AS VARCHAR)
+ Replace(Replace(summary_log,'K:\','file://servernamehere/DiskVolK/'),
'\','/')
+ Cast('" title="Click to view Summary log text file"' AS VARCHAR(99))
+ Cast('style="font-family:comic sans ms; font-size:12; color:blue"><img src="images\SummaryLog.bmp" border="0"></a>' AS VARCHAR(999)) "Text Logs"
,errorcount "Error Count"
,warningcount "Warning Count"
,(totmsgcount
- errorcount
- warningcount) "Information Message Count"
,CASE 
WHEN end_datetime > start_datetime
THEN CASE 
WHEN Cast(Datepart("hh",(end_datetime
- start_datetime)) AS INT) > 0
THEN Cast(Datepart("hh",(end_datetime
- start_datetime)) AS VARCHAR)
+ ' hr '
ELSE ' '
END
+ CASE 
WHEN Cast(Datepart("mi",(end_datetime
- start_datetime)) AS INT) > 0
THEN Cast(Datepart("mi",(end_datetime
- start_datetime)) AS VARCHAR)
+ ' min '
ELSE ' '
END
+ CASE 
WHEN Cast(Datepart("ss",(end_datetime
- start_datetime)) AS INT) > 0
THEN Cast(Datepart("ss",(end_datetime
- start_datetime)) AS VARCHAR)
+ ' sec '
ELSE ' '
END
ELSE CASE 
WHEN end_datetime = start_datetime
THEN '< 1 sec'
ELSE CASE 
WHEN ((Cast(Datediff(mi,start_datetime,Getdate()) AS INT) <= 240)
OR ((SELECT 
Count(* )
FROM 
MASTER.dbo.sysprocesses a(nolock)
INNER JOIN gcsdwdb.dbo.update_log b(nolock)
ON a.program_name = b.program_name
WHERE a.program_name = update_log.program_name
AND (Abs(Datediff(n,b.start_datetime,a.login_time))) < 1) > 0))
THEN 'Running '
+ Cast(Datediff(mi,start_datetime,Getdate()) AS VARCHAR)
+ ' min'
ELSE '&nbsp;'
END
END
END "Elapsed Time" /* ,end_datetime "End Time (UTC/GMT)" ,datepart("hh" ,
(end_datetime - start_datetime)) "Hr" ,datepart("mi" ,(end_datetime - start_datetime)) "Mins" ,datepart("ss" ,(end_datetime - start_datetime)) "Sec" ,datepart("ms" ,(end_datetime - start_datetime)) "mSecs" ,datepart("dw" ,start_datetime) "dp" ,case when datepart("dw" ,start_datetime) = 6 then ' Fri' when datepart("dw" ,start_datetime) = 5 then ' Thu' else '1' end */
,totalrows "Total Rows"
,inserted "Rows Inserted"
,updated "Rows Updated" /* ,success_code "succ" ,exit_code "exit" */
FROM 
update_log
WHERE start_datetime >= '5/29/2009 16:15'
ORDER BY start_datetime DESC 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-30T08:26:54.630

答案显然是“只检索输出”。在 SQL Server 上格式化存在以下问题：

*   它增加了来自 SQL 服务器的网络流量
*   SQL 的字符串处理功能很差
*   SQL 服务器未针对执行字符串操作进行优化
*   您正在使用可以更好地用于查询处理的服务器 CPU 周期
*   它可能使查询优化器的生活变得困难（或不可能）
*   您必须编写更多查询以支持不同的格式
*   您可能必须编写不同的查询以支持不同浏览器上的格式设置
*   您不能将查询重复用于不同的目的

我敢肯定还有很多。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-30T08:26:59.480

SQL 不应该*被*格式化，句号。它是一种关系代数，用于从数据库中提取（使用时`SELECT`）数据。

让 DBMS 为您格式化数据是错误的做法，这应该留给您自己的代码（在 DBMS 之外）。DBMS 通常处于足够的负载之下，而无需为您完成演示工作。它还针对数据检索而不是演示进行了优化。

我知道如果我尝试做类似的事情，DBA 会要求我立即执行 :-)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-30T08:28:49.477

SQL 中格式化输出的概念确实打破了表示和数据分离的整个概念，不仅如此，还可能出现许多情况：

*   如果您需要本地化日期格式怎么办？例如，英国使用与美国不同的日期格式 - 您是否要一直国际化到您的数据层？

*   如果格式规则改变了怎么办？即某些文本需要以不同的方式格式化以符合某些新的公司政策？同样，您需要一直回到数据层。

*   如果我们采用网络上下文，您如何决定转义值？如果您要输出到网页、JSON 或其他地方，可能需要不同形式的转义...

不仅如此，SQL 字符串操作函数通常也不是很灵活。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T08:42:39.933

我是负责我公司产品报告引擎的开发人员。简单来说，引擎的工作原理是构建数据的 XML 文档以从数据库进入报告，然后根据用户要求将 XML 转换为构建网页、PDF 或 Word 文档的任何方式。

当我五年前开始时，我有数据库格式化输出，虽然我很高兴我写的没有什么像问题示例那样可怕。随着时间的推移，我改变了方向，现在 XML 只保存原始数据，并且在演示过程中进行了整理。

我们的软件使用交通灯作为快速一目了然的状态指示器，因此我们在数据库中有很多字符字段存储“R”、“A”、“G”、“U”来表示红色、琥珀色、绿色并且未知。我有几个技巧，例如带有嵌入式 CASE 语句的 SELECTS 将单个字符代码转换为英文对应项：

```
SELECT CASE status WHEN 'R' THEN 'Red' WHEN 'G' THEN 'Green' ...etc... 
```

无法对原生代码进行排序；用户期望事物有两种顺序：红色、琥珀色、绿色或绿色、琥珀色、红色；所以我也有相应的 SORT 列

```
SELECT
    CASE status WHEN 'R' THEN 'Red' WHEN 'G' THEN 'Green' WHEN 'A' THEN 'Amber' END as status,
    CASE status WHEN 'R' THEN 0 WHEN 'A' THEN 1 WHEN 'G' THEN 2 END as sort
FROM
    table
ORDER BY
    sort 
```

这只是一个简单的例子。我还有其他技巧来进行日期格式化、名称组合等。

这当然会导致应用程序多语言的问题，因为英语被编译到数据库中。我需要查找客户语言环境并编写大量多语言案例来支持其他语言。不好。日期也是一个问题。美国人喜欢他们的日期 mm/dd，而欧洲人喜欢 dd/mm。

它还导致了其他重复问题。如果有人添加了第四个或第五个红绿灯选项，当新状态已经在代码中表示为 Java 枚举或其他东西时，我必须修改我的所有 SQL，一旦我从数据库中读取单个字符，我就可以查找它。

就我而言，让数据库返回原始数据并编写一套比较器和格式化程序以用户的母语和编码在文档中呈现数据变得非常容易。如果我今天重新开始，那就是我会做的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T08:34:14.520

我认为在脱离 SQL 的过程中可以进行某些类型的转换，这取决于调用程序的期望。

例如，如果一个日期时间是合适的，它应该被本地返回。另一方面，如果您只在日期时间字段中返回一年（或季度，如 1/1、4/1、7/1、10/1），并且预计客户端会解析出信息，将其放在单独的列中（例如年 = 2008 或季度 = '2008Q1'）。一些从代码到描述的代码翻译（删除代码列并仅发出描述）。在合理的情况下，连接和字符串构建是合适的。

您的特定示例是一个不合适的地方，虽然在表面上它看起来像松散耦合（仅更改数据库中的 SP），但它实际上可以通过强制为不同用途编写额外的 SP 而不是多个 UI 来创建更强的耦合能够使用相同的 SP。然后随着系统的发展，可能需要同步更改多个 SP。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-30T11:28:06.930

在考虑是否代表您的表示层格式化您的数据时，请考虑您的“表示层”可能是 Web 服务或其他程序。您可以从代表一段 UI 代码进行格式化开始，只是稍后需要 Web 服务使用相同的查询，这将有不同的要求。

我最喜欢的是一组所有格式化日期/时间的存储过程。在当地时区。当被来自不同时区的 Web 服务调用时，它并没有很好地工作。当数据库服务器的区域设置发生变化时，它的工作效果就更差了，改变了日期/时间格式。哦，它在午夜没有工作，因为它在最后截断了“00:00”。

OTOH，UI 非常方便。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-30T08:40:32.870

我认识的大多数人都不同意我的观点，但我有点喜欢这种方法。所以我会列出一些优点：

*   SQL 非常强大：这个查询需要多少行 C#？
*   SQL 很容易更新。我想这段代码在一个存储过程中，你可以用一个简单的 ALTER PROC 来改变它。这可以大大减少滚动修复的时间。
*   SQL 速度快；我见过引入 ORM 层会减慢应用程序爬行速度的情况。
*   SQL 易于调试，错误易于重现。只需运行查询。测试您的修复是运行新查询的问题。
*   如果格式正确，这样的 SQL 并不难维护。5-10分钟看不懂的SQL不多；但是多层 C# 解决方案可能需要很长时间，特别是如果您必须弄清楚哪一层的抽象被破坏了。

我相信其他人会列出 SQL 方法的缺点。

# sql - SQL Server 2005 只恢复一个架构

> ID：929327
> 
> 赞同：2
> 
> 时间：2009-05-30T08:27:49.183
> 
> 标签：sql, sql-server-2005, tsql, database-restore

我很确定这是不可能的......

我们有一个包含多个模式的数据库。每个模式属于不同的用户。一位用户问“如果我发现我犯了一大堆错误，是否有可能恢复到我的数据昨天的状态”。显然我们可以恢复整个数据库，但这也会恢复我们不想做的其他模式......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T09:12:48.530

你是对的，不可能只恢复一个模式。

也就是说，如果您将所有特定架构对象存储到特定文件组并进行文件组备份，那么您可以只恢复受影响的文件组。

但是，如果您要管理大量模式/文件组，这将非常麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T08:50:23.210

将整个数据库还原到具有不同名称的数据库。

复制您要恢复的部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T18:44:15.013

您必须将整个[数据库的副本恢复到某个时间点](http://msdn.microsoft.com/en-us/library/ms179451.aspx)，然后将模式数据复制回原始数据库。如果将来需要定期执行此操作，您可以按照 John 的建议使用文件组并执行[部分恢复副本](http://msdn.microsoft.com/en-us/library/ms190984.aspx)，然后将数据复制回。但是，即使使用文件组，您也不能及时将*部分恢复到某个时间点*（这就是你所要求的），afaik 不存在这样的东西。

# sql - PLSQL 函数帮助

> ID：929328
> 
> 赞同：0
> 
> 时间：2009-05-30T08:27:53.270
> 
> 标签：sql, plsql

我在下面有这个 SELECT，我必须在一个循环中为我从加入中获得的每个 activity_id(record) 运行它。

此外，此 SELECT 必须在一个过程中的多个位置运行以获取详细信息和该记录——>我运行 assign_ course 或 assign_test 如下。

谁能帮我写一个有这个选择的函数。

输入是 strtplanid、strPersonid、p_objective_id

```
FOR activity_id IN
               (SELECT objact.activity_id, objact.activity_type,objact.IS_REQUIRED
                  FROM test_training_plan tp,
                       test_tp_objective tp_obj,
                       test_train_obj_activity objact
                 WHERE tp.tplan_id = tp_obj.tplan_id
                   AND tp.tplan_id = strtplanid
                   AND tp_obj.t_objective_id = p_objective_id
                   AND tp_obj.t_objective_id = objact.t_objective_id
                   AND objact.activity_id NOT IN (
                          SELECT tplplr.activity_id
                            FROM test_learning_record lr,
                                 test_learning_record lr1,
                                 test_tp_learning_activity tplplr
                           WHERE lr.lr_catalog_history_id = tplplr.activity_id
                             AND lr.learning_record_id =
                                                      tplplr.activity_lp_lr_id
                             AND tplplr.tp_lp_lr_id = lr1.learning_record_id
                             AND lr1.lr_catalog_history_id =
                                               strtplanid
                             AND lr.lr_person_id = strPersonid
                             AND lr1.lr_person_id = strPersonid
                             AND lr.status IN
                                           ('PASSED', 'WAIVED', 'TESTED_OUT'))
                   AND objact.activity_id NOT IN (
                          SELECT event_id
                            FROM test_train_obj_activity toa,
                                 test_event_sessions sessions,
                                 test_learning_record lr1,
                                 test_tp_learning_activity tplearnact,
                                 test_learning_record tplr
                           WHERE toa.activity_id = sessions.event_id
                             AND sessions.event_session_id =
                                                     lr1.lr_catalog_history_id
                             AND lr1.learning_record_id =
                                                  tplearnact.activity_lp_lr_id
                             AND tplearnact.tp_lp_lr_id =
                                                       tplr.learning_record_id
                             AND tplr.lr_catalog_history_id =
                                               strtplanid
                             --AND toa.is_required = 1
                             AND toa.t_objective_id = obj.t_objective_id
                             AND tplr.lr_person_id = strPersonid
                             AND lr1.lr_person_id = strPersonid
                             AND lr1.status IN
                                           ('PASSED', 'WAIVED', 'TESTED_OUT')))

            LOOP

               IF (activity.activity_type = 'Course')
               THEN

                   ASSIGN_COURSETP(strPersonid,activity.activity_id,strPersonid,activity.activity_type,
                  activity.IS_REQUIRED,strtplanid,v_straccreditingorg); 

                ELSif (activity.activity_type ='Test')
                THEN
                  ASSIGN_TESTTP(strPersonid,activity.activity_id,strPersonid,activity.activity_type,
                  activity.IS_REQUIRED,strtplanid,v_straccreditingorg); 

                END IF; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T08:14:01.280

这需要退货吗？

为什么不能将代码包装在样板函数代码中？

```
CREATE OR REPLACE Function ACTIVITY_ASSIGN_TESTTP
(
  strtplanid IN number
, strPersonid IN number
, p_objective_id IN number
)
RETURN number
IS
  retVal number;
BEGIN

  -- YOUR CODE

  RETURN retVal
END ACTIVITY_ASSIGN_TESTTP; 
```

# url - 在 URL 中表示空格的最佳字符是什么？

> ID：929329
> 
> 赞同：9
> 
> 时间：2009-05-30T08:28:27.153
> 
> 标签：url, seo

当您构建对用户和搜索引擎来说应该清晰易读的 URL 并且您从内容中自动完成时，表示空格的最佳方式是什么？连字符（这是 StackOverflow 使用的）？下划线？任何其他？这些对SEO有什么不同吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-30T08:48:23.523

两者都是有效的 URL 字符，并且各有利弊。

**专业破折号**

*   [Google 推荐使用破折号](http://www.google.com/support/webmasters/bin/answer.py?hl=en&answer=76329)，以下是来自 Google 的 Matt Cutts 对 [破折号与下划线](http://www.mattcutts.com/blog/dashes-vs-underscores/)的看法。

    > 如果您有一个类似 word1-word2 的 url，则该页面可以返回用于搜索 word1、word2 甚至“word1 word2”。这就是为什么我总是选择破折号而不是下划线。

*   破折号似乎是主要博客所做的： [赫芬顿邮报](http://www.huffingtonpost.com/)、 [TechCrunch](http://www.techcrunch.com/)、 [Engadget](http://www.engadget.com/) ...
*   ~~破折号似乎是主要 CMS 所做的。~~
    *不太清楚那个了，有人可以评论吗？*
*   正如[Kazar](https://stackoverflow.com/questions/929329/whats-the-best-character-to-represent-blank-spaces-in-a-url/929341#929341)所提到的，下划线可能与链接的下划线发生冲突。
*   我发现下划线很难打字。
*   [Rene Saarsoo](https://stackoverflow.com/questions/929329/whats-the-best-character-to-represent-blank-spaces-in-a-url/929526#929526)指出，在比例字体中，破折号比下划线占用的空间更少。
*   [Ionut G. Stan](https://stackoverflow.com/questions/929329/whats-the-best-character-to-represent-blank-spaces-in-a-url/929429#929429)提到[主机名中不允许使用下划线](http://en.wikipedia.org/wiki/Domain_name_system#Internationalized_domain_names)。如果你力求一致性，你应该选择破折号。

**临下划线**

*   [ISO9660](http://en.wikipedia.org/wiki/ISO_9660#File_and_directory_name_restrictions)文件系统中不允许使用破折号 。如果您的内容也以 DVD 或 CD 形式提供（例如帮助文件或电子学习内容），这可能会成为问题。
*   在某些语言（例如德语）中，破折号可以是单词字符，通常不被视为单词分隔符。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-30T10:47:58.527

破折号的另一个优点是，在比例字体中，它们占用的下划线空间更少。比较：

*   [https://stackoverflow.com/../whats-the-best-character-to-represent-blank-spaces-in-a-url](https://stackoverflow.com/../whats-the-best-character-to-represent-blank-spaces-in-a-url)
*   [https://stackoverflow.com/../whats_the_best_character_to_represent_blank_spaces_in_a_url](https://stackoverflow.com/../whats_the_best_character_to_represent_blank_spaces_in_a_url)

It's not a lot, but every little helps :)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-30T08:32:36.457

同样，个人喜好 - 我个人认为连字符比下划线更有效，因为下划线可能会与添加标签的下划线冲突（默认情况下），所以[http://someurl.com/this_is_a_address](http://someurl.com/this_is_a_address)看起来那里没有下划线。（因为这是堆栈溢出，请翻转链接）。 [http://someurl.com/this-is-a-address](http://someurl.com/this-is-a-address)看起来不错。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-30T09:28:37.623

您知道，如果您购买了一个域名，您可以在该名称中使用连字符，但不能使用下划线。这是我认为连字符比下划线更好的另一个原因。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T08:57:08.513

我会说破折号。我曾经在几乎所有此类目的（表示空间）中使用下划线，但现在，随着所有视觉事物在四周闪烁，您经常会发现下划线使它们通常不可见。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-04-10T09:26:03.757

This may answer your question. Things looks like changed for Google few years ago about - and _ See this article here: [http://www.blog-tutorials.com/marketing-and-seo/linking/google-oks-underscores-as-word-separators-in-urls-and-more-seo-tips/](http://www.blog-tutorials.com/marketing-and-seo/linking/google-oks-underscores-as-word-separators-in-urls-and-more-seo-tips/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-30T08:30:45.353

我认为这取决于您的喜好。我最喜欢的是下划线，但如果使用连字符或其他有效的 URL 字符，我看不到任何（不利）优势。一切看起来都比 %20 好:)

# sql - SQL：在一个语句中插入多组值？

> ID：929339
> 
> 赞同：5
> 
> 时间：2009-05-30T08:32:01.450
> 
> 标签：sql, mysql, sqlite

是否可以在一个语句中向 SQLite 表插入多组值？

我在尝试：

`INSERT INTO the_table VALUES (1,2,'hi'),(2,0,'foo');`

不同的 ()s 代表不同的插入集，但我得到一个错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T08:41:49.543

你的表中只有三列吗？如果没有，您可以尝试定义您设置的列名，如下所示：

```
INSERT INTO the_table 
       (column1  ,column2  ,column3) 
VALUES (1        ,2        ,'hi'   )
      ,(2        ,0        ,'foo'  ) 
```

此约定是在 SQL Server 2008 中引入的，称为[表值构造函数](http://msdn.microsoft.com/en-us/library/dd776382.aspx)。请参阅 MSDN 的[INSERT 页面](http://msdn.microsoft.com/en-us/library/ms174335.aspx)以了解整体语法。此外，该`INSERT`语句可以很容易地格式化以获得更好的可读性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T08:33:56.580

你可以做

```
INSERT INTO the_table 
SELECT 1,2,'hi'
UNION
SELECT 2,0,'foo'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T08:34:33.897

我在 MSDN 中发现了该语法，但在尝试后我也不能这样做，但我注意到页面底部写着页面中有错误:) 链接在哪里[http://msdn.microsoft .com/en-us/library/ms174335.aspx](http://msdn.microsoft.com/en-us/library/ms174335.aspx)见底部**如何插入多行**

# gwt - [GWT]在链接的情况下阻止浏览器的事件

> ID：929340
> 
> 赞同：0
> 
> 时间：2009-05-30T08:32:09.487
> 
> 标签：gwt

我想在我自己的事件监听器链接的情况下处理事件。如果我们点击浏览器中的链接，浏览器将打开链接中给出的地址，但我想调用我自己的事件监听器。我试图在 GWT 中通过删除有效的锚标记的属性来做到这一点，但这不是一个干净的解决方案。因此，如果您知道如何阻止浏览器打开该链接，请回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-02T18:40:53.940

在 GWT **1.6**中，正确的代码是：

```
ClickHandler foo = new ClickHandler() { 
    public void onClick(ClickEvent event) {

        /// do your stuff

        event.stopPropagation(); // stops the event from bubbling to parent

        event.preventDefault();  // prevents the browsers default action,
                                 // following a link, etc
    }
} 
```

这大致相当于：

```
<a href="#" onclick="return false">Link</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T18:28:14.823

您可以调用`event.cancel()`(GWT 1.6) 或

```
Event.getCurrentEvent().cancelBubble(true);              // In 1.4 and earlier
DOM.eventCancelBubble(DOM.eventGetCurrentEvent(), true); // In 1.5 
```

在 GWT 1.5 中还有一种方法可以从其实例中取消事件，但我不记得了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T10:18:13.250

这不是这个小部件的作用：

[http://google-web-toolkit.googlecode.com/svn/javadoc/1.6/com/google/gwt/user/client/ui/Hyperlink.html](http://google-web-toolkit.googlecode.com/svn/javadoc/1.6/com/google/gwt/user/client/ui/Hyperlink.html)

例如：它看起来像一个普通的超链接，但可以让您处理 onclick 事件？

# mysql - 从 MySQL 客户端执行 shell 命令？

> ID：929342
> 
> 赞同：11
> 
> 时间：2009-05-30T08:33:51.807
> 
> 标签：mysql, shell

在 oracle 数据库中，命令“host”可用于从数据库命令窗口运行 bash 命令。在 mySql 中是否有与“主机”等效的命令？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-30T08:41:08.967

您可以使用该[`system`](http://dev.mysql.com/doc/refman/5.0/en/mysql-commands.html)命令。

> 系统命令，\！命令
> 
> 使用您的默认命令解释器执行给定的命令。
> 
> system 命令仅适用于 Unix。

例子：

```
system ls -l 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-07-27T13:47:26.150

作为一个额外的调整，在大多数“'nix”系统上，你实际上可以做这样的事情：

```
mysql> system bash 
```

并让整个航站楼供您使用。如果您在与 MySQL 接口的终端中进行代码工作，这将特别有效；在 shell 中，键入“exit”将带您回到 MySQL 监视器/客户端，因此您可以很容易地来回切换。

显然，其他 shell（“mysql> system tcsh”）也可以。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-02-19T15:57:01.060

我在 Linux 上运行 5.0.95-log 版本。以“system”或“!”作为命令的前缀 适用于“pwd”和“ls -l”命令。如果我尝试使用例如更改目录

mysql> 系统 cd /home/mydir

该命令似乎被接受。但这显然没有任何作用，因为遵循“pwd”和“ls -l”命令表明我仍在同一个目录中。因此，似乎为此内置了一个有限功能的存根，但我们实际上并没有完全访问系统 shell。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T02:29:26.143

[实际上，可以通过使用MySQL 代理](http://dev.mysql.com/tech-resources/articles/proxy-gettingstarted.html)（向下滚动到“来自 MySQL 客户端的 Shell 命令”部分）通过客户端连接（而不是在本地执行客户端计算机上的命令）在 mysqld 正在运行的服务器上执行 shell 命令。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-02T14:43:05.007

在 linux 机器中，您应该能够使用以下示例

1.  ！clear - 清除屏幕
2.  ！ls - 列出当前工作目录中的文件
3.  基本上，您应该能够使用该语法运行任何命令或脚本

注意：在 ! 之前添加反斜杠！

# asp.net - 我必须在两个 asp.net 页面之间传递值的选项

> ID：929347
> 
> 赞同：2
> 
> 时间：2009-05-30T08:35:07.233
> 
> 标签：asp.net, vb.net

我想知道在两个 asp.net 页面之间传递值（有时是多个值）的最佳实践是什么

在过去，我使用查询字符串在 asp 中传递一个值，如下所示：

```
href='<%# Eval("TestID","../Net/TestPage.aspx?TestID={0}") %>'><%#Eval("Title")%> </a> 
```

我假设您可以在后面的代码中执行此操作，但我不知道最好的方法。

我还假设可以传递多个值。

有人可以为我提供一个 VB 片段，让我知道如何去做吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T09:24:44.590

您有许多用于传递数据的选项，并且所有选项都可以在页面之间传递多个值。

您可以使用[Request.Form](http://msdn.microsoft.com/en-us/library/system.web.httprequest.form.aspx)集合来捕获从带有 POST 动词的 HTML 表单提交的值（即“method="POST">）。

代码看起来像：

```
Dim formvalue As String
formValue = Request.Form("FormField1") 
```

您还可以在 URL[查询字符串](http://msdn.microsoft.com/en-us/library/system.web.httprequest.querystring.aspx)中使用参数（很像您的示例）：

```
Dim queryStringValue As String
queryStringValue = Request.QueryString("QueryStringValue1") 
```

您可以设置一个[cookie](http://msdn.microsoft.com/en-us/library/system.web.httprequest.cookies.aspx)（它的生命周期取决于您设置的 Expiry 属性值）：

设置 cookie（注意：这里使用的是 HttpResponse 对象。用户的浏览器在从请求的响应中接收到 Set-Cookie HTTP 标头值时存储 cookie）

```
Response.Cookies("CookieValue") = "My Cookie Data"
Response.Cookies("CookieValue").Expires = DateTime.Now.AddDays(1) ' optional, expires tomorrow 
```

检索 cookie 值（我们在这里使用 HttpRequest 对象）：

```
Dim cookieValue As String
cookieValue = Request.Cookies("CookieValue") 
```

您可以使用 HttpSessionState 对象（可通过页面的[Session](http://msdn.microsoft.com/en-us/library/system.web.ui.page.session.aspx)属性访问）。设置会话变量：

```
Session["SessionValue"] = "My Session Value" 
```

要检索会话值：

```
Dim sessionValue As String
sessionValue = Session["SessionValue"] 
```

还有另一种在页面之间传递页面状态的方法`Page.Transfer`（请参阅[如何：在 ASP.NET 网页之间传递值](http://msdn.microsoft.com/en-us/library/6c3yckfw(VS.80).aspx)），但在研究之前，我会尝试熟悉上述内容。

* * *

就最佳实践而言，它实际上取决于您传递的数据。

*   **不要**通过 URL（查询字符串）、表单或 cookie 传递敏感数据。这些可以通过各种方式拦截
*   使用服务器端存储（如会话状态或数据库）传递敏感数据，但要考虑如何保证会话 ID 的安全。
*   **永远不要**相信来自应用程序外部的数据（用户通过表单输入的数据、从数据库读取的信息等）。在您的页面中再次显示此信息之前，请务必对其进行编码。这可以防止[跨站点脚本（又名 XSS）攻击](http://en.wikipedia.org/wiki/Cross-site_scripting)。
*   不要在查询字符串中使用顺序 ID，您在页面之间传递特定于用户的标识符。假设您创建了一个列出客户所有订单的 Orders.aspx 页面。您通过查询字符串传入 CustID 参数：Orders.aspx?CustID=123。有人很容易将 URL 更改为 Orders.aspx?CustID=124 并查看他们不应该查看的信息。您可以通过检查是否允许当前用户查看信息来解决此问题，您可以使用不容易猜到的标识符（通常是 GUID）或在服务器端传递信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T09:03:42.730

它将帮助您查看以下链接：

一种。[跨页回传](http://msdn.microsoft.com/en-us/library/ms178139.aspx)

湾。[如何在 ASP.NET 页面之间传递值 (MSDN)](http://msdn.microsoft.com/en-us/library/6c3yckfw.aspx)

C。[Steve C. Orr 关于传递值的另一篇文章](http://steveorr.net/faq/PassValues.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T08:41:24.553

您可以在发布请求中使用会话、cookie、查询字符串、隐藏表单字段。

# c# - 有没有办法在运行时构建新类型？

> ID：929349
> 
> 赞同：24
> 
> 时间：2009-05-30T08:35:27.343
> 
> 标签：c#, .net, vb.net, reflection

我要问一个听起来很奇怪的问题。

有没有办法在运行时构建一个新类？或者至少，向现有类添加一个新属性。

我的意思是创建一个不存在的类，而不是现有类的实例。我以后可以使用反射来加载和使用这个类。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-30T09:02:28.443

无法向现有类型添加属性，但您可以在运行时使用 Reflection.Emit 创建新类型。这是非常复杂的东西，它是这样的：

```
AssemblyBuilder assemblyBuilder = Thread.GetDomain().DefineDynamicAssembly(
      assemblyName , AssemblyBuilderAccess.Run, assemblyAttributes);
ModuleBuilder moduleBuilder = assemblyBuilder.DefineDynamicModule("ModuleName");
TypeBuilder typeBuilder = moduleBuilder.DefineType(
      "MyNamespace.TypeName" , TypeAttributes.Public);

typeBuilder.DefineDefaultConstructor(MethodAttributes.Public);

// Add a method
newMethod = typeBuilder.DefineMethod("MethodName" , MethodAttributes.Public);

ILGenerator ilGen = newMethod.GetILGenerator();

// Create IL code for the method
ilGen.Emit(...);

// ...

// Create the type itself
Type newType = typeBuilder.CreateType(); 
```

此代码只是一个示例。它可能包含错误。

您还可以通过在运行时使用 System.CodeDom 编译 C# 源代码来生成类，但我对此知之甚少。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-30T08:43:24.300

看一下[System.Reflection.Emit](http://msdn.microsoft.com/en-us/library/system.reflection.emit.aspx)命名空间。我自己从未使用过它，但此命名空间中的类可用于生成 IL（中间语言）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-30T09:04:13.307

这不是一个奇怪的问题——在某些情况下它可能非常有用。例如，我有时会使用这种技术进行性能测试：

```
public static Type[] DynamicTypes;

public void CreateObjects()
{
  var codeNamespace = new CodeNamespace( "DynamicClasses" );
  codeNamespace.Imports.Add( new CodeNamespaceImport( "System" ) );
  codeNamespace.Imports.Add( new CodeNamespaceImport( "System.ComponentModel" ) );

  for( var i = 0; i < 2000; i++ )
  {
    var classToCreate = new CodeTypeDeclaration( "DynamicClass_" + i )
    {
      TypeAttributes = TypeAttributes.Public
    };
    var codeConstructor1 = new CodeConstructor
    {
      Attributes = MemberAttributes.Public
    };
    classToCreate.Members.Add( codeConstructor1 );

    codeNamespace.Types.Add( classToCreate );
  }

  var codeCompileUnit = new CodeCompileUnit();
  codeCompileUnit.Namespaces.Add( codeNamespace );

  var compilerParameters = new CompilerParameters
  {
    GenerateInMemory = true,
    IncludeDebugInformation = true,
    TreatWarningsAsErrors = true,
    WarningLevel = 4
  };
  compilerParameters.ReferencedAssemblies.Add( "System.dll" );

  var compilerResults = new CSharpCodeProvider().CompileAssemblyFromDom( compilerParameters, codeCompileUnit );

  if( compilerResults == null )
  {
    throw new InvalidOperationException( "ClassCompiler did not return results." );
  }
  if( compilerResults.Errors.HasErrors )
  {
    var errors = string.Empty;
    foreach( CompilerError compilerError in compilerResults.Errors )
    {
      errors += compilerError.ErrorText + "\n";
    }
    Debug.Fail( errors );
    throw new InvalidOperationException( "Errors while compiling the dynamic classes:\n" + errors );
  }

  var dynamicAssembly = compilerResults.CompiledAssembly;
  DynamicTypes = dynamicAssembly.GetExportedTypes();
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-30T08:45:43.203

您可以查看[System.CodeDom](http://msdn.microsoft.com/en-us/library/system.codedom.aspx)命名空间。根据从那里链接的页面之一：

> .NET Framework 包含一种称为代码文档对象模型 (CodeDOM) 的机制，它使发出源代码的程序开发人员能够在运行时基于表示要呈现的代码的单个模型生成多种编程语言的源代码。

我根本不是这方面的专家，我只记得在我墙上的 .NET Framework 海报上看到过它。:)

**编辑：**自从写下这个答案后，我就玩过 System.CodeDom 了。我写了[一篇博客文章](http://www.digitallycreated.net/Blog/47/speeding-up-.net-reflection-with-code-generation)，其中使用了一些基本的 CodeDom，可以帮助那些想要开始使用它的人。

# java - 如何制作 Java 插件？

> ID：929350
> 
> 赞同：2
> 
> 时间：2009-05-30T08:35:42.723
> 
> 标签：java, plugins, plugin-architecture

我需要将我的 Java 程序作为 OME 的插件 - 具有 Java API 的基于 Web 的图像处理软件

www.openmicroscopy

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-09-11T13:02:04.057

[如果您正在编写客户端， OmeroJava](http://trac.openmicroscopy.org.uk/omero/wiki/OmeroJava)是适用于最新版 OME (OMERO 4.2) 的 API。如果您想将代码嵌入到 Insight（OMERO Java 客户端）中，那么您应该从[如何编写客户端](https://trac.openmicroscopy.org.uk/shoola/wiki/OmeroInsightHowToBuildAgent)开始。其他指向[OME-Java 库](http://www.openmicroscopy.org/site/support/legacy/ome-server/developer/java-api)的链接适用于旧版本，不应**使用**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T12:40:41.180

看起来[Open Microscopy Java API](http://www.openmicroscopy.org/site/support/legacy/ome-server/developer/java-api)值得研究。如果不是，那么值得在您的问题中强调为什么它不适合（标记为遗产？）

# c# - 使用证书的 WCF 传输安全性忽略链信任

> ID：929351
> 
> 赞同：6
> 
> 时间：2009-05-30T08:37:11.723
> 
> 标签：c#, .net, wcf, security, certificate

我一直试图让 WCF 安全性为我的项目工作，但运气不佳。我正在尝试创建一个使用 net.tcp 作为绑定的服务，并同时提供消息和传输安全性。消息安全性使用用户名和密码完成，传输安全性（据说！）使用证书完成。

对于我的开发测试，我创建了自己的证书颁发机构并将此证书放在我计算机的受信任存储区 (LocalMachine) 中。然后我创建了两个证书，每个都由我的证书颁发机构签名，一个供服务使用，一个供客户端应用程序使用。我将这两个都放在 LocalMachine 的个人商店 (My) 中。然后，为了测试，我创建了一个未由我的证书颁发机构签名的随机证书（因此不受信任），并将其放在 LocalMachine 的个人存储中。我使用 makecert 创建这些证书。

然后，我将连接到服务的客户端应用程序配置为使用无效的不受信任的证书作为其客户端证书。该服务设置为（假设）使用链信任检查客户端证书。但是，此客户端能够连接并成功与服务对话！它应该被拒绝，因为它的证书不受信任！

我不知道是什么导致了这种行为，所以我将问题提交给你们，看看你们是怎么做的。这是我的 WCF 配置：

**服务配置：**

```
<system.serviceModel>
    <services>
        <service behaviorConfiguration="DHTestBehaviour" name="DigitallyCreated.DHTest.Business.DHTestBusinessService">
            <endpoint address="" binding="netTcpBinding" contract="DigitallyCreated.DHTest.Business.IDHTestBusinessService" bindingConfiguration="DHTestNetTcpBinding" bindingNamespace="http://www.digitallycreated.net/DHTest/v1" />

            <host>
                <baseAddresses>
                    <add baseAddress="net.tcp://localhost:8090/"/>
                    <add baseAddress="http://localhost:8091/"/>
                </baseAddresses>
            </host>
        </service>
    </services>
    <behaviors>
        <serviceBehaviors>
            <behavior name="DHTestBehaviour">
                <serviceMetadata httpGetEnabled="true"/>
                <serviceDebug includeExceptionDetailInFaults="true"/>
                <serviceCredentials>
                    <userNameAuthentication userNamePasswordValidationMode="MembershipProvider" membershipProviderName="DHTestMembershipProvider"/>
                    <serviceCertificate storeLocation="LocalMachine" storeName="My" x509FindType="FindBySubjectDistinguishedName" findValue="CN=business.dhtestDHTest.com" />
                    <clientCertificate>
                        <authentication certificateValidationMode="ChainTrust" trustedStoreLocation="LocalMachine" revocationMode="NoCheck" />
                    </clientCertificate>
                </serviceCredentials>
                <serviceAuthorization principalPermissionMode="UseAspNetRoles" roleProviderName="DHTestRoleProvider" />
            </behavior>
        </serviceBehaviors>
    </behaviors>
    <bindings>
        <netTcpBinding>
            <binding name="DHTestNetTcpBinding">
                <security mode="TransportWithMessageCredential">
                    <message clientCredentialType="UserName"/>
                    <transport clientCredentialType="Certificate" protectionLevel="EncryptAndSign"/>
                </security>
            </binding>
        </netTcpBinding>
    </bindings>
</system.serviceModel> 
```

**客户配置：**

```
<system.serviceModel>
    <bindings>
        <netTcpBinding>
            <binding name="NetTcpBinding_IDHTestBusinessService" closeTimeout="00:01:00"
             openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
             transactionFlow="false" transferMode="Buffered" transactionProtocol="OleTransactions"
             hostNameComparisonMode="StrongWildcard" listenBacklog="10" maxBufferPoolSize="524288"
             maxBufferSize="65536" maxConnections="10" maxReceivedMessageSize="65536">
                <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                 maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                <reliableSession ordered="true" inactivityTimeout="00:10:00"
                 enabled="false" />
                <security mode="TransportWithMessageCredential">
                    <transport clientCredentialType="Certificate" protectionLevel="EncryptAndSign" />
                    <message clientCredentialType="UserName" />
                </security>
            </binding>
        </netTcpBinding>
    </bindings>
    <behaviors>
        <endpointBehaviors>
            <behavior name="DHTestBusinessServiceEndpointConf">
                <clientCredentials>
                    <clientCertificate storeLocation="LocalMachine" storeName="My" x509FindType="FindBySubjectDistinguishedName" findValue="CN=invalid"/>
                    <serviceCertificate>
                        <authentication revocationMode="NoCheck" trustedStoreLocation="LocalMachine"/>
                    </serviceCertificate>
                </clientCredentials>
            </behavior>
        </endpointBehaviors>
    </behaviors>
    <client>
        <endpoint address="net.tcp://phoenix-iv:8090/" binding="netTcpBinding"
         behaviorConfiguration="DHTestBusinessServiceEndpointConf"
         bindingConfiguration="NetTcpBinding_IDHTestBusinessService"
         contract="DHTest.NetTcp.Business.IDHTestBusinessService"
         name="NetTcpBinding_IDHTestBusinessService">
            <identity>
                <dns value="business.dhtest.com" />
            </identity>
        </endpoint>
    </client>
</system.serviceModel> 
```

客户端用户名/密码验证码：

```
DHTestBusinessServiceClient client = new DHTestBusinessServiceClient();
client.ClientCredentials.UserName.UserName = "ratfink";
client.ClientCredentials.UserName.Password = "testpassword"; 
```

提前谢谢你的帮助。

**编辑（2009/06/01）：**

我的一个朋友向我指出了[一个博客](http://blogs.msdn.com/drnick/archive/2006/10/10/Which-Client-Credential-Does-TransportWithMessageCredential-Use_3F00_.aspx)，该博客回答了为什么会发生这种情况的问题。显然，当您指定 TransportWithMessageCredential 时，就意味着： *Transport* with Message Credentials *only*。这就是为什么我的证书在传输级别被忽略的原因。

但是，我不认为这个问题是完整的和关闭的，因为我仍然想这样做。:) 我将研究我认为可以插入的自定义证书验证器，看看它是否有效。我会把结果告诉大家。

**编辑（2009/06/08）：**

不，自定义证书验证器也不起作用。WCF 根本不调用它们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-08T15:52:39.220

我找到了解决问题的方法，但是结果比我预期的要糟糕得多。

基本上，要实现传输和消息凭据检查，您需要定义自定义绑定。[（我在这里](http://social.msdn.microsoft.com/forums/en-US/wcf/thread/2c168952-7d67-4e6f-810a-6dd11d4dc55a/)找到了有关此效果的信息）。

我发现最简单的方法是继续在 XML 中进行配置，但在运行时复制并稍微修改 XML 配置中的 netTcp 绑定。实际上，您需要启用一个开关。这是服务端和客户端的代码：

**服务端**

```
ServiceHost businessHost = new ServiceHost(typeof(DHTestBusinessService));
ServiceEndpoint endpoint = businessHost.Description.Endpoints[0];
BindingElementCollection bindingElements = endpoint.Binding.CreateBindingElements();
SslStreamSecurityBindingElement sslElement = bindingElements.Find<SslStreamSecurityBindingElement>();
sslElement.RequireClientCertificate = true; //Turn on client certificate validation
CustomBinding newBinding = new CustomBinding(bindingElements);
NetTcpBinding oldBinding = (NetTcpBinding)endpoint.Binding;
newBinding.Namespace = oldBinding.Namespace;
endpoint.Binding = newBinding; 
```

**客户端**

```
DHTestBusinessServiceClient client = new DHTestBusinessServiceClient();
ServiceEndpoint endpoint = client.Endpoint;
BindingElementCollection bindingElements = endpoint.Binding.CreateBindingElements();
SslStreamSecurityBindingElement sslElement = bindingElements.Find<SslStreamSecurityBindingElement>();
sslElement.RequireClientCertificate = true; //Turn on client certificate validation
CustomBinding newBinding = new CustomBinding(bindingElements);
NetTcpBinding oldBinding = (NetTcpBinding)endpoint.Binding;
newBinding.Namespace = oldBinding.Namespace;
endpoint.Binding = newBinding; 
```

你以为就是这样，但你错了！:) 这是它变得更加蹩脚的地方。我将我的具体服务方法归因于 PrincipalPermission 以根据服务用户的角色限制访问，如下所示：

```
[PrincipalPermission(SecurityAction.Demand, Role = "StandardUser")] 
```

一旦我应用了上述更改，这就会开始失败。原因是因为

```
OperationContext.Current.ServiceSecurityContext.PrimaryIdentity 
```

最终成为一个未知的、无用户名、未经身份验证的 IIdentity。这是因为实际上有*两种*身份代表用户：一种是用于通过传输进行身份验证的 X509 证书，另一种是用于在消息级别进行身份验证的用户名和密码凭证。当我对 WCF 二进制文件进行逆向工程以查看它为什么没有给我 PrimaryIdentity 时，我发现它有一行明确的代码，如果找到多个 IIdentity，它会导致它返回那个空的 IIdentity。我想这是因为它无法确定哪个是*主要*的。

这意味着使用 PrincipalPermission 属性是不可能的。相反，我编写了一个方法来模仿它*可以*处理多个 IIdentities 的功能：

```
private void AssertPermissions(IEnumerable<string> rolesDemanded)
{
    IList<IIdentity> identities = OperationContext.Current.ServiceSecurityContext.AuthorizationContext.Properties["Identities"] as IList<IIdentity>;
    if (identities == null)
        throw new SecurityException("Unauthenticated access. No identities provided.");

    foreach (IIdentity identity in identities)
    {
        if (identity.IsAuthenticated == false)
            throw new SecurityException("Unauthenticated identity: " + identity.Name);
    }

    IIdentity usernameIdentity = identities.Where(id => id.GetType().Equals(typeof(GenericIdentity))).SingleOrDefault();
    string[] userRoles = Roles.GetRolesForUser(usernameIdentity.Name);

    foreach (string demandedRole in rolesDemanded)
    {
        if (userRoles.Contains(demandedRole) == false)
            throw new SecurityException("Access denied: authorisation failure.");
    }
} 
```

它不漂亮（尤其是我检测用户名/密码凭据 IIdentity 的方式），但它有效！现在，在我的服务方法的顶部，我需要这样调用它：

```
AssertPermissions(new [] {"StandardUser"}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T10:57:18.913

查看[Codeplex - Intranet 部分](http://wcfsecurityguide.codeplex.com/)，该部分提供了针对不同场景的清单。另一件要提的是，在 IIS5.0 和 IIS6.0 中不支持使用 netTcpBindings - 请参见[此处的第 3 段](http://wcfsecurity.codeplex.com/Wiki/View.aspx?title=How%20do%20I%20choose%20an%20appropriate%20binding%3F)，仅限 IIS7.0+。

# iphone - 如何创建iphone的摆动图标效果？

> ID：929364
> 
> 赞同：52
> 
> 时间：2009-05-30T08:43:15.017
> 
> 标签：iphone, ios, animation, rotation

我想在我的应用程序中来回摆动图像，类似于按下 iPhone 图标时的摆动方式。最好的方法是什么？

这是我第一次尝试不使用动画 GIF 的动画。我认为这个想法是稍微来回旋转图像以产生摆动效果。我看过使用 CABasicAnimation 和 CAKeyframeAnimation。CABasicAnimation 每次重复时都会产生抖动，因为它会跳转到起始位置并且不会向后插值。CAKeyframeAnimation 似乎是解决方案，但我无法让它工作。我肯定错过了什么。这是我使用 CAKeyframeAnimation 的代码（不起作用）：

```
 NSString *keypath = @"wobbleImage";
CAKeyframeAnimation *animation = [CAKeyframeAnimation animationWithKeyPath:keypath];
animation.duration = 1.0f;
animation.delegate = self;
animation.repeatCount = 5;

CGFloat wobbleAngle = 0.0872664626f;
NSValue *initial = [NSValue valueWithCATransform3D:CATransform3DMakeRotation(0.0f, 0.0f, 0.0f, 1.0f)];
NSValue *middle = [NSValue valueWithCATransform3D:CATransform3DMakeRotation(wobbleAngle, 0.0f, 0.0f, 1.0f)];
NSValue *final = [NSValue valueWithCATransform3D:CATransform3DMakeRotation(-wobbleAngle, 0.0f, 0.0f, 1.0f)];
animation.values = [NSArray arrayWithObjects:initial, middle, final, nil];

[imageView.layer addAnimation:animation forKey:keypath]; 
```

或者可能有一个我只是想念的更简单的解决方案。感谢任何指针。谢谢！

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-05-30T16:54:40.460

简单的方法：

```
#define RADIANS(degrees) (((degrees) * M_PI) / 180.0)

CGAffineTransform leftWobble = CGAffineTransformRotate(CGAffineTransformIdentity, RADIANS(-5.0));
CGAffineTransform rightWobble = CGAffineTransformRotate(CGAffineTransformIdentity, RADIANS(5.0));

itemView.transform = leftWobble;  // starting point

[UIView beginAnimations:@"wobble" context:itemView];
[UIView setAnimationRepeatAutoreverses:YES]; // important
[UIView setAnimationRepeatCount:10];
[UIView setAnimationDuration:0.25];
[UIView setAnimationDelegate:self];
[UIView setAnimationDidStopSelector:@selector(wobbleEnded:finished:context:)];

itemView.transform = rightWobble; // end here & auto-reverse

[UIView commitAnimations];

...

- (void) wobbleEnded:(NSString *)animationID finished:(NSNumber *)finished context:(void *)context 
{
     if ([finished boolValue]) {
        UIView* item = (UIView *)context;
        item.transform = CGAffineTransformIdentity;
     }
} 
```

可能必须玩时间和角度，但这应该让你开始。

编辑：我编辑了响应以添加代码以在完成后将项目恢复到原始状态。另外，请注意，您可以使用`beginAnimations`上下文值将任何内容传递给启动/停止方法。在这种情况下，它是摆动的对象本身，因此您不必依赖特定的 ivars，并且该方法可用于任何基于 UIView 的通用对象（即文本标签、图像等）

* * *

## 回答 #2

> 赞同：92
> 
> 时间：2011-04-19T20:29:28.923

Ramin 的回答非常好，但是从 OS4 开始，在一个简单的函数中使用 animateWithDuration 也可以实现相同的效果。

（为未来的谷歌人改编了他的榜样）

```
#define RADIANS(degrees) (((degrees) * M_PI) / 180.0)

- (void)startWobble {
 itemView.transform = CGAffineTransformRotate(CGAffineTransformIdentity, RADIANS(-5));

 [UIView animateWithDuration:0.25 
      delay:0.0 
      options:(UIViewAnimationOptionAllowUserInteraction | UIViewAnimationOptionRepeat | UIViewAnimationOptionAutoreverse)
      animations:^ {
       itemView.transform = CGAffineTransformRotate(CGAffineTransformIdentity, RADIANS(5));
      }
      completion:NULL
 ];
}

- (void)stopWobble {
 [UIView animateWithDuration:0.25
      delay:0.0 
      options:(UIViewAnimationOptionAllowUserInteraction | UIViewAnimationOptionBeginFromCurrentState | UIViewAnimationOptionCurveLinear)
      animations:^ {
       itemView.transform = CGAffineTransformIdentity;
      }
      completion:NULL
  ];
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2011-01-07T22:08:27.130

您应该使用它`CAKeyframeAnimation`来制作更流畅的动画。

```
+ (void) animationKeyFramed: (CALayer *) layer 
                   delegate: (id) object
              forKey: (NSString *) key {

    CAKeyframeAnimation *animation;
    animation = [CAKeyframeAnimation animationWithKeyPath:@"transform.rotation.z"];
    animation.duration = 0.4;
    animation.cumulative = YES;
    animation.repeatCount = 2;
    animation.values = [NSArray arrayWithObjects:
            [NSNumber numberWithFloat: 0.0], 
            [NSNumber numberWithFloat: RADIANS(-9.0)], 
            [NSNumber numberWithFloat: 0.0],
            [NSNumber numberWithFloat: RADIANS(9.0)],
            [NSNumber numberWithFloat: 0.0], nil];
    animation.fillMode = kCAFillModeForwards;
    animation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionLinear];
    animation.removedOnCompletion = NO;
    animation.delegate = object;

    [layer addAnimation:animation forKey:key];
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2011-10-18T23:22:12.930

我编写了一个示例应用程序，试图复制主屏幕摆动和图标移动：[iPhone 示例代码：瓷砖](http://undefinedvalue.com/2010/02/05/iphone-sample-code-tiles)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-07-28T11:25:57.727

对于最近看到这篇文章并希望在 Swift 中做同样事情的任何人，这是我的翻译：

```
func smoothJiggle() {

    let degrees: CGFloat = 5.0
    let animation = CAKeyframeAnimation(keyPath: "transform.rotation.z")
    animation.duration = 0.6
    animation.cumulative = true
    animation.repeatCount = Float.infinity
    animation.values = [0.0,
        degreesToRadians(-degrees) * 0.25,
        0.0,
        degreesToRadians(degrees) * 0.5,
        0.0,
        degreesToRadians(-degrees),
        0.0,
        degreesToRadians(degrees),
        0.0,
        degreesToRadians(-degrees) * 0.5,
        0.0,
        degreesToRadians(degrees) * 0.25,
        0.0]
    animation.fillMode = kCAFillModeForwards;
    animation.timingFunction = CAMediaTimingFunction(name: kCAMediaTimingFunctionLinear)
    animation.removedOnCompletion = true

    layer.addAnimation(animation, forKey: "wobble")
}

func stopJiggling() {
    jiggling = false
    self.layer.removeAllAnimations()
    self.transform = CGAffineTransformIdentity
    self.layer.anchorPoint = CGPointMake(0.5, 0.5)
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-30T16:30:48.910

我知道的最简单的方法是使用核心动画。基本上，您创建一个核心动画块，然后进行旋转变换并设置和重复计数。然后，Core Animation 会处理完成这种摆动效果所需的一切。

要启动核心动画块，只需执行以下操作：

```
[UIView beginAnimations:@"any string as animationID" context:self];
[UIView setAnimationRepeatCount:10];
// rotate 
[UIView commitAnimations]; 
```

未测试。但也可能你还必须这样做：

```
[UIView setAnimationBeginsFromCurrentState:YES]; 
```

AFAIK setAnimationRepeatCount 将产生动画完成，撤消，完成，撤消，完成，撤消，完成......您指定的次数的效果。因此，您可能希望首先向左旋转而没有重复计数，然后从这一点开始重复计数摆动。完成后，您可能希望旋转回恒等变换（= 不应用旋转和缩放）。

您可以通过设置动画委托来链接动画

```
[UIView setAnimationDelegate:self] 
```

进而

```
[UIView setAnimationDidStopSelector:@selector(myMethod:finished:context:)]; 
```

一旦动画停止，该方法就会被调用。有关如何实现将在动画停止时调用的方法，请参阅 UIView 类文档。基本上，在该方法中，您将使用一个新的动画块但相同的上下文和动画 ID 执行下一步（即向后旋转或其他任何操作），然后（如果需要）指定另一个 didStopSelector。

**更新：**

您可能想查看：

```
[UIView setAnimationRepeatAutoreverses:YES]; 
```

这将自动来回摆动。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-02-14T14:48:24.907

您可以使用 来创建一个非无休止的摆动效果`CAKeyframeAnimation`，如下所示：

```
CGFloat degrees = 8.0;
CAKeyframeAnimation *animation = [CAKeyframeAnimation animationWithKeyPath:@"transform.rotation.z"];
animation.duration = 0.6;
animation.cumulative = YES;
animation.repeatCount = 1;
animation.values = @[@0.0,
                    @RADIANS(-degrees) * 0.25,
                    @0.0,
                    @RADIANS(degrees) * 0.5,
                    @0.0,
                    @RADIANS(-degrees),
                    @0.0,
                    @RADIANS(degrees),
                    @0.0,
                    @RADIANS(-degrees) * 0.5,
                    @0.0,
                    @RADIANS(degrees) * 0.25,
                    @0.0];
animation.fillMode = kCAFillModeForwards;
animation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionLinear];
animation.removedOnCompletion = YES;

[self.layer addAnimation:animation forKey:@"wobble"]; 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-10-15T15:01:46.450

从上面的答案，我得到了 swift5 版本：

```
 func startWobble() {
    let angle = 5.0 * Double.pi / 180.0;
    self.transform = CGAffineTransform.identity.rotated(by: CGFloat(-angle));
    UIView.animate(withDuration: 0.25, delay: 0, options: [.allowUserInteraction,.repeat,.autoreverse], animations: {
         self.transform = CGAffineTransform.identity.rotated(by: CGFloat(angle));
    }, completion: nil)

}

func stopWobble() {

    UIView.animate(withDuration: 0.25, delay: 0, options: [.allowUserInteraction,.beginFromCurrentState,.curveLinear], animations: {
        self.transform = CGAffineTransform.identity;
    }, completion: nil)
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-05-28T13:23:16.713

晚会迟到了。我通常使用带阻尼的弹簧（iOS7 和更新版本）。很快它看起来像：

```
 sender.transform = CGAffineTransformMakeScale(1.2, 1.2)
    UIView.animateWithDuration(0.30, delay: 0.0, usingSpringWithDamping: 0.3, initialSpringVelocity: 0.3, options: UIViewAnimationOptions.CurveEaseInOut, animations: { () -> Void in
        sender.transform = CGAffineTransformMakeScale(1, 1)
    }) { (Bool) -> Void in
    //Do stuff when animation is finished
    } 
```

您可以通过调整`initialSpringVelocity`和调整效果`SpringWithDamping`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-04-09T10:06:52.527

基于 EsbenB 的回答，但针对 Swift 3 和轮换进行了更新：

```
 sender.transform = CGAffineTransform(rotationAngle: 12.0 * .pi / 180.0)
    UIView.animate(withDuration: 0.60, delay: 0.0, usingSpringWithDamping: 0.3, initialSpringVelocity: 0.3, options: .curveEaseInOut, animations: { () -> Void in
        sender.transform = CGAffineTransform(rotationAngle: 0.0)
    }, completion: nil) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-11-20T11:27:54.177

[好吧， Ramin](https://stackoverflow.com/a/930101/1971013)给出的代码运行良好。但是如果您使用标签栏应用程序并移动到下一个标签项目然后再次返回到上一个标签项目，您会看到您的视图每次都向左移动。所以最好的做法是您使用 ViewWillAppear 方法。

```
- (void)viewWillAppear:(BOOL)animated
{
    UIView* item = self.view;
    item.transform = CGAffineTransformIdentity;
} 
```

因此，每次加载视图时，您都会在正确的位置找到动画。并且也使用此方法。

```
[UIView setAnimationDidStopSelector:@selector(myMethod:finished:context:)]; 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-07-30T19:53:43.130

**斯威夫特 3**

```
func startWiggling() {
    deleteButton.isHidden = false
    guard contentView.layer.animation(forKey: "wiggle") == nil else { return }
    guard contentView.layer.animation(forKey: "bounce") == nil else { return }

    let angle = 0.04

    let wiggle = CAKeyframeAnimation(keyPath: "transform.rotation.z")
    wiggle.values = [-angle, angle]
    wiggle.autoreverses = true
    wiggle.duration = randomInterval(0.1, variance: 0.025)
    wiggle.repeatCount = Float.infinity
    contentView.layer.add(wiggle, forKey: "wiggle")

    let bounce = CAKeyframeAnimation(keyPath: "transform.translation.y")
    bounce.values = [4.0, 0.0]
    bounce.autoreverses = true
    bounce.duration = randomInterval(0.12, variance: 0.025)
    bounce.repeatCount = Float.infinity
    contentView.layer.add(bounce, forKey: "bounce")
}

func stopWiggling() {
    deleteButton.isHidden = true
    contentView.layer.removeAllAnimations()
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-10-26T06:42:19.490

使用 Swift 4+ 最简单的方法：

```
static func wobbleAnimation(button: UIButton) {
    CATransaction.begin()
    let rotateAnimation = CABasicAnimation(keyPath: "transform.rotation")
    rotateAnimation.autoreverses = true
    rotateAnimation.repeatCount = Float.greatestFiniteMagnitude
    rotateAnimation.fromValue = CGFloat(-0.2)
    rotateAnimation.toValue = CGFloat(0.2)
    rotateAnimation.duration = 0.20
    button.layer.add(rotateAnimation, forKey: nil)
    CATransaction.commit()
}

static func stopWobbleAnimation(button: UIButton) {
    button.layer.removeAllAnimations()
} 
```

# bash - 如何使用 bash 测试 Internet 连接？

> ID：929368
> 
> 赞同：128
> 
> 时间：2009-05-30T08:45:49.583
> 
> 标签：bash, connection, ping

如何在不 ping 某些网站的情况下测试 Internet 连接？我的意思是，如果有连接但站点已关闭怎么办？是否有检查与世界的联系？

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2014-11-08T18:01:49.260

**没有 ping**

```
#!/bin/bash

wget -q --spider http://google.com

if [ $? -eq 0 ]; then
    echo "Online"
else
    echo "Offline"
fi 
```

**-q**：静音模式

**--spider** : 不知道，只是检查页面可用性

**美元？**: 外壳返回码

**0**：外壳“一切正常”代码

**没有 wget**

```
#!/bin/bash

echo -e "GET http://google.com HTTP/1.0\n\n" | nc google.com 80 > /dev/null 2>&1

if [ $? -eq 0 ]; then
    echo "Online"
else
    echo "Offline"
fi 
```

* * *

## 回答 #2

> 赞同：97
> 
> 时间：2009-05-31T15:04:55.757

ping 默认网关：

```
#!/bin/bash
ping -q -w 1 -c 1 `ip r | grep default | cut -d ' ' -f 3` > /dev/null && echo ok || echo error 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2013-02-18T15:09:32.637

超级感谢用户**​​ somedrew**在这里发帖：[https](https://bbs.archlinux.org/viewtopic.php?id=55485) ://bbs.archlinux.org/viewtopic.php?id= 55485 on 2008-09-20 02:09:48

> 查看 /sys/class/net 应该是一种方法

这是我的脚本，用于测试环回以外的网络连接。我在另一个脚本中使用以下内容来定期测试我的网站是否可以访问。如果无法访问，则会弹出一个窗口提醒我出现问题。

每当我的笔记本电脑未连接到网络时，下面的脚本会阻止我每五分钟接收一次弹出消息。

```
#!/usr/bin/bash

# Test for network conection
for interface in $(ls /sys/class/net/ | grep -v lo);
do
  if [[ $(cat /sys/class/net/$interface/carrier) = 1 ]]; then OnLine=1; fi
done
if ! [ $OnLine ]; then echo "Not Online" > /dev/stderr; exit; fi 
```

**bash 新手的注意事项：**最后的 'if' 语句测试是否在线 [!] 并在这种情况下退出。有关更多详细信息，请参阅 man bash 并搜索“可以组合表达式”。

*PS 我觉得 ping 不是在这里使用的最佳选择，因为它旨在测试与**特定主机**的连接，而不是测试是否存在与任何类型**网络的连接。***

*PPS 以上适用于 Ubuntu 12.04 /sys 在其他一些发行版上可能不存在。见下文：*

> 现代 Linux 发行版包括一个 /sys 目录作为虚拟文件系统（sysfs，相当于 /proc，它是一个 procfs），它存储并允许修改连接到系统的设备，而许多传统的 UNIX 和类 Unix 操作系统使用/sys 作为内核源代码树的符号链接。[需要引用]
> 
> 来自维基百科[https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard](https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard)

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2016-06-19T14:29:20.483

这适用于 MacOSX 和 Linux：

```
#!/bin/bash

ping -q -c1 google.com &>/dev/null && echo online || echo offline 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2019-05-14T20:33:19.117

在 Bash 中，通过**/dev/** { **udp** , **tcp** } **/** *host* **/** *port*使用它的网络包装器：

```
if : >/dev/tcp/8.8.8.8/53; then
  echo 'Internet available.'
else
  echo 'Offline.'
fi 
```

（`:`是 Bash 无操作，因为您只想测试连接，而不是处理。）

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2018-02-01T10:17:57.747

最佳答案忽略了这样一个事实，即您可以与默认网关建立完美稳定的连接，但这并不意味着您实际上可以在互联网上访问某些内容。OP 询问他/她如何测试与世界的联系。因此，我建议通过将网关 IP 更改为 LAN 外部的已知 IP (xyzw) 来更改最佳答案。

所以答案会变成：

```
ping -q -w 1 -c 1 x.y.z.w > /dev/null && echo ok || echo error 
```

还删除了命令替换的不利反引号^([[1]](https://stackoverflow.com/a/4708569/9050928))。

如果您只是想确保在执行某些代码之前已与世界连接，您还可以使用：

```
if ping -q -w 1 -c 1 x.y.z.w > /dev/null; then
    # more code
fi 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-05-30T08:50:24.113

我之前写过脚本，只需使用 telnet 连接到端口 80，然后传输文本：

```
HTTP/1.0 GET /index.html 
```

其次是两个 CR/LF 序列。

如果您得到某种形式的 HTTP 响应，您通常可以假设该站点正在运行。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2017-12-13T13:53:07.570

执行以下命令检查网站是否已启动，以及 Web 服务器显示的状态消息：

`curl -Is http://www.google.com | head -1 HTTP/1.1 200 OK`

状态码“200 OK”表示请求已成功并且可以访问网站。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2017-11-19T09:52:14.953

确保您的网络允许 TCP 流量进出，然后您可以使用以下命令取回面向公众的 IP

```
curl ifconfig.co 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2018-01-12T15:14:30.710

[投票最多](https://stackoverflow.com/a/932187/395414)的答案不适用于 MacOS，因此对于那些使用 Mac 的人，我已经成功测试了这一点：

```
GATEWAY=`route -n get default | grep gateway`
if [ -z "$GATEWAY" ]
  then
    echo error
else
  ping -q -t 1 -c 1 `echo $GATEWAY | cut -d ':' -f 2` > /dev/null && echo ok || echo error
fi 
```

在 MacOS High Sierra 10.12.6 上测试

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2009-05-31T02:43:52.760

如果您的本地名称服务器已关闭，

```
平 4.2.2.1

```

是一个易于记忆的永远在线 IP（它实际上是一个名称服务器，甚至）。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2017-09-21T06:46:36.293

此 bash 脚本不断检查 Internet 并在 Internet 可用时发出哔声。

```
#!/bin/bash
play -n synth 0.3 sine 800 vol 0.75
while :
do
pingtime=$(ping -w 1 8.8.8.8 | grep ttl)
if [ "$pingtime" = "" ] 
then 
   pingtimetwo=$(ping -w 1 www.google.com | grep ttl) 
   if [ "$pingtimetwo" = "" ] 
   then 
       clear ; echo 'Offline'
   else
       clear ; echo 'Online' ; play -n synth 0.3 sine 800 vol 0.75
   fi 
else
    clear ; echo 'Online' ; play -n synth 0.3 sine 800 vol 0.75
fi
sleep 1
done 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2017-10-11T00:40:34.047

最短的方法：`fping 4.2.2.1`=>“4.2.2.1 还活着”

我更喜欢这个，因为它的输出速度更快，输出更简洁`ping`，缺点是你必须安装它。

您可以使用任何[公共 dns](https://www.lifewire.com/free-and-public-dns-servers-2626062)而不是特定网站。

`fping -q google.com && echo "do something because you're connected!"`

`-q`返回一个退出代码，所以我只是展示了一个运行你在线的东西的例子。

在 mac 上安装：`brew install fping`; 在 ubuntu 上：`sudo apt-get install fping`

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-05-31T15:16:48.930

Ping 旨在完成您想要做的事情。但是，如果站点阻止了 ICMP 回显，那么您始终可以远程登录到某个站点的 80 端口、wget 或 curl。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-12-03T18:18:47.420

检查 Google 的索引页面是另一种方法：

```
#!/bin/bash

WGET="/usr/bin/wget"

$WGET -q --tries=20 --timeout=10 http://www.google.com -O /tmp/google.idx &> /dev/null
if [ ! -s /tmp/google.idx ]
then
    echo "Not Connected..!"
else
    echo "Connected..!"
fi 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-05-31T09:28:47.707

[与@Jesse 的回答](https://stackoverflow.com/a/14939373/4935114)类似，此选项可能比使用的任何解决方案都快得多，`ping`并且可能比[@Jesse 的回答](https://stackoverflow.com/a/14939373/4935114)更有效。

```
find /sys/class/net/ -maxdepth 1 -mindepth 1 ! -name "*lo*" -exec sh -c 'cat "$0"/carrier 2>&1' {} \; | grep -q '1' 
```

### 解释：

此命令使用`find`with`-exec`对所有未命名`*lo*`的文件运行命令`/sys/class/net/`。这些应该是指向包含您机器上可用网络接口信息的目录的链接。

正在运行的`sh`命令是检查`carrier`这些目录中文件内容的命令。的值`$interface/carrier`有 3 个含义 -[引用](https://unix.stackexchange.com/questions/252002/help-testing-special-file-in-sys-class-net)：

> 似乎有三种状态：
> 
> *   ./carrier 不可读（例如在网络管理器中禁用接口时）。
> *   ./carrier 包含“1”（当接口被激活并连接到 WiFi 网络时）
> *   ./carrier 包含“0”（当接口被激活且未连接到 WiFi 网络时）

[@Jesse 的回答](https://stackoverflow.com/a/14939373/4935114)中没有考虑第一个选项。删除的`sh`命令是：

```
# Note: $0 == $interface
cat "$0"/carrier 2>&1 
```

`cat`用于检查内容`carrier`并将所有输出重定向到标准输出，即使由于文件不可读而失败。如果在这些文件中`grep -q`找到`"1"`，则表示至少连接了 1 个接口。的退出代码`grep -q`将是最终退出代码。

### 用法

例如，使用这个命令的退出状态，你可以使用它来启动一个[gnubiff](http://gnubiff.sourceforge.net/)，`~/.xprofile`只有当你有互联网连接时。

```
online() {
    find /sys/class/net/ -maxdepth 1 -mindepth 1 ! -name "*lo*" -exec sh -c 'cat "$0"/carrier 2>&1 > /dev/null | grep -q "1" && exit 0' {} \;
}
online && gnubiff --systemtray --noconfigure & 
```

### 参考

*   [帮助测试特殊文件`/sys/class/net/`](https://unix.stackexchange.com/questions/252002/help-testing-special-file-in-sys-class-net)
*   [find -exec 一个shell函数？](https://stackoverflow.com/questions/4321456/find-exec-a-shell-function)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-06-02T13:55:25.487

Pong 并不意味着服务器上的 Web 服务正在运行；它仅仅意味着服务器正在回复 ICMP 回显。我建议使用 curl 并检查它的返回值。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-08-15T17:23:39.713

如果您的目标是实际检查*Internet*访问，那么该问题的许多现有答案都是有缺陷的。您应该注意的几件事：

1.  您的计算机可能连接到网络而该网络没有互联网访问权限
2.  如果整个互联网都无法访问，服务器可能会关闭
3.  即使您没有 Internet 访问权限，强制门户也有可能返回任意 URL 的 HTTP 响应

考虑到这一点，我认为最好的策略是通过 HTTPS 连接联系*多个站点，如果其中任何一个站点响应，则返回 true。*

例如：

```
connected_to_internet() {
  test_urls="\
  https://www.google.com/ \
  https://www.microsoft.com/ \
  https://www.cloudflare.com/ \
  "

  processes="0"
  pids=""

  for test_url in $test_urls; do
    curl --silent --head "$test_url" > /dev/null &
    pids="$pids $!"
    processes=$(($processes + 1))
  done

  while [ $processes -gt 0 ]; do
    for pid in $pids; do
      if ! ps | grep "^[[:blank:]]*$pid[[:blank:]]" > /dev/null; then
        # Process no longer running
        processes=$(($processes - 1))
        pids=$(echo "$pids" | sed --regexp-extended "s/(^| )$pid($| )/ /g")

        if wait $pid; then
          # Success! We have a connection to at least one public site, so the
          # internet is up. Ignore other exit statuses.
          kill -TERM $pids > /dev/null 2>&1 || true
          wait $pids
          return 0
        fi
      fi
    done
    # wait -n $pids # Better than sleep, but not supported on all systems
    sleep 0.1
  done

  return 1
} 
```

用法：

```
if connected_to_internet; then
  echo "Connected to internet"
else
  echo "No internet connection"
fi 
```

关于这种方法的一些注意事项：

1.  它对我上面概述的所有误报和否定都很有效
2.  所有请求都是并行发生的，以最大限度地提高速度
3.  *如果您在技术上*可以访问互联网，但 DNS 无法正常工作，或者您的网络设置混乱，它将返回 false ，我认为在大多数情况下这是合理的做法

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2019-10-13T21:57:46.160

为了获得最快的结果，**ping DNS 服务器**：

```
ping -c1 "8.8.8.8" &>"/dev/null"

if [[ "${?}" -ne 0 ]]; then
    echo "offline"
elif [[ "${#args[@]}" -eq 0 ]]; then
    echo "online"
fi 
```

可作为独立命令使用：[linkStatus](https://gitlab.com/es20490446e/linkStatus/-/blob/master/readme.md)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-04-21T15:32:16.930

如果你想处理强制门户，你可以这样做：

```
if [[ $(curl -s -D - http://www.gstatic.com/generate_204 2>/dev/null | head -1 | cut -d' ' -f 2) == "204" ]]; then
  echo 'online'
else
  echo 'offline'
fi 
```

或者，如果您想要一些更具可读性的东西，可以将强制门户与缺乏信号区分开来：

```
function is_online() {
  # Test signal
  local response
  response=$(curl --silent --dump-header - http://www.gstatic.com/generate_204 2> /dev/null)
  if (($? != 0)); then return 2; fi
  # Test captive portal
  local status=$(echo $response | head -1 | cut -d' ' -f 2)
  ((status == "204"))
}
is_online && echo online || echo offline 
```

# subsonic - 拯救父母和孩子

> ID：929382
> 
> 赞同：2
> 
> 时间：2009-05-30T08:50:39.933
> 
> 标签：subsonic

我的架构中有几个具有 PK 和 FK 关系的表。我使用 SubSonic 生成器创建了 DAL。如果我创建一个新的父级及其子级，我应该如何保存两者？分开还是一次性？

> 例如

```
Parent.Save();  
ChildCollection.SaveAll(); 
```

我尝试了上述方法，但它不起作用，因为 ChildCollection 没有其父 ID。是我必须自己为每个孩子分配父母 ID，还是可以选择一次性保存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-12-08T16:26:38.657

假设：您的主键是由您的数据库自动生成的。如果是这样，您首先需要做的是 Save() 父级，然后在 ChildrenCollection 中的每个对象中填充 ParentID 属性。完成此操作后，您将能够 Save() 您的 ChildrenCollection。

```
 Parent.Save();
        ChildCollection.ForEach(x => x.ParentID = Parent.ParentID);
        ChildCollection.SaveAll(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T09:18:29.547

您可以使用具有自定义重载保存函数的部分类来提供所需的功能。

```
public partial class Class1
{
    public void Save(bool childern)
    {
        Save();

        if (childern)
        {
            //based on primary/foreign key SubSonic provides
            //methods to fetch child collections related to
            //this (primary key) table.
            ChildernCollection col = Childerns();

            col.SaveAll();
        }
    }
} 
```

# entity-framework - 添加/删除数据库字段后刷新实体模型的最简单方法是什么？

> ID：929385
> 
> 赞同：1
> 
> 时间：2009-05-30T08:52:48.943
> 
> 标签：entity-framework

有谁知道在数据库中添加/删除字段后更新实体模型的最简单方法是什么？

我在我的数据库中添加了一些新字段，然后选择“从数据库更新模型”，没有任何反应。模型保持不变。有没有人遇到同样的问题？

感谢您的任何反馈！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T10:28:09.360

对于 .net 3.5 附带的 EF，我倾向于遵循以下步骤：

1.  删除连接字符串
2.  删除模型
3.  生成新模型
4.  构建解决方案

这可能不是一个非常可靠的方法，但从长远来看它可以节省我的时间。将来进行刷新会更容易、更稳定，但我已经从自动生成模型变为模型优先。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-11-28T08:44:37.793

我肯定会查看 EDM 生成器，它允许您从头开始生成完整的模型 -[单击此处转到 MSDN 参考](http://msdn.microsoft.com/en-us/library/bb387165.aspx)。它为我节省了很多时间，希望它也能为你做同样的事情。

# html - INPUT 和 SELECT 元素自定义大小

> ID：929389
> 
> 赞同：1
> 
> 时间：2009-05-30T08:57:27.500
> 
> 标签：html, css, resize, html-select, html-input

据我了解，宽度/填充/边距属性仅适用于块级元素。但是，在 INPUT 和 SELECT 元素上，我可以指定宽度，这是可行的。应该是？

我可以写这样的东西：

```
<input type="text" style="display:block;" /> 
```

但是有必要吗？

谁能解释一下为什么它有效？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T09:19:17.143

实际上，它们并不是真正的内联元素，而是**内联块元素**。这允许您指定宽度、高度和其他特定于块的属性，而无需中断内联元素的流动。[在好的浏览器](http://www.quirksmode.org/css/display.html)中，您可以在任何元素上使用“display:inline-block”来实现相同的目的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T19:36:57.783

[规范说](http://www.w3.org/TR/CSS21/visudet.html#the-width-property)：

> 适用于：所有元素，但未替换的内联元素、表格行和行组

表单控件，例如 input 和 select 元素被**替换**为内联元素（元素被替换为表单控件 - 它的文本内容不像普通元素那样显示）。

由于它们被替换，它们不是不可替换的，因此宽度属性适用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T09:25:22.217

表单元素是 HTML/CSS 世界的害群之马——有很多属性不能像普通的 HTML 元素那样工作。

虽然它没有回答您的问题，但您可能会发现以下讨论很有趣： http: [//meyerweb.com/eric/thoughts/2007/05/15/formal-weirdness/](http://meyerweb.com/eric/thoughts/2007/05/15/formal-weirdness/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T09:45:35.577

从技术上讲，这是特定于浏览器的呈现属性。在这一点上，大多数浏览器确实允许您设置宽度，但不能保证（尤其是在旧浏览器上），您肯定*会*遇到错误。

输入元素的 W3 规范在技术上使其成为内联元素。内联块甚至不是 W3 规范的一部分，它是 CSS2 的一部分（因此旧浏览器不一致）。

例如，如果您将宽度指定为百分比并将大量文本放入其中，IE 会有一些有趣的错误。

长话短说，它几乎总是安全的，只是不是我见过的任何官方规范的一部分。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-30T09:01:05.340

如果那不可能发生，你想过吗？引入 INPUT 元素时，没有 CSS。HTML 中绝对需要 INPUT 元素的宽度来创建正确的表单。

# mysql - Mysql Prepare Statement 执行时出错

> ID：929392
> 
> 赞同：1
> 
> 时间：2009-05-30T08:58:01.307
> 
> 标签：mysql, prepared-statement, concat

我试图通过准备语句创建一个表，但它给了我语法错误。好吧，如果我尝试单独执行相同的语句，那么它可以正常工作。

这是我的声明——

```
SET @Stmt1 = Concat('DROP TABLE IF EXISTS ',DB,'.`county`;\n'
'CREATE TABLE IF NOT EXISTS ',DB,'.`County`
(
  `CountyID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `CountyName` VARCHAR(45) NOT NULL,
  `CountyCode` VARCHAR(30) NOT NULL,
   PRIMARY KEY (`CountyID`)
)');

Prepare stmt2 From @stmt1;
Execute stmt2; 
```

请谁能告诉我我在这个声明中遗漏了什么？它在这条线上给了我一个错误：

```
'CREATE TABLE IF NOT EXISTS ',DB,'.`County`
(
  `CountyID` INT UNSIGNED NOT NULL AUTO_INCREMENT, 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T16:44:39.770

[http://dev.mysql.com/doc/refman/5.1/en/prepare.html](http://dev.mysql.com/doc/refman/5.1/en/prepare.html)说：

> [可准备语句的] 文本必须表示单个 SQL 语句，而不是多个语句。

所以你必须先执行你的`DROP TABLE`语句，然后`CREATE TABLE`分别准备和执行语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T09:13:17.517

你没有错过 concat 中两个字符串之间的逗号吗？

应该

```
SET @Stmt1 = Concat('DROP TABLE IF EXISTS ',DB,'.county;\n', 'CREATE TABLE IF NOT EXISTS ',DB,'.County ( CountyID INT UNSIGNED NOT NULL AUTO_INCREMENT, CountyName VARCHAR(45) NOT NULL, CountyCode VARCHAR(30) NOT NULL, PRIMARY KEY (CountyID) )'); 
```

# asp.net-mvc - 如何创建 3D 饼图？-Asp.net MVC

> ID：929401
> 
> 赞同：3
> 
> 时间：2009-05-30T09:05:12.943
> 
> 标签：asp.net-mvc, charts

我在[这里](http://code-inside.de/blog-in/2008/11/27/howto-use-the-new-aspnet-chart-controls-with-aspnet-mvc/)和[这里](http://weblogs.asp.net/scottgu/archive/2008/11/24/new-asp-net-charting-control-lt-asp-chart-runat-quot-server-quot-gt.aspx)看到过 Microsoft 图表控件@ 。

它对在 MVC 中显示条形图有很好的演示。

在 scottgu 的博客上有很多示例，但它们使用的是服务器控件（即`<asp:CHRT runat"server">`。通过修改 web.config 在 MVC 中也支持这一点。

但是由于我们应该避免使用服务器控制，因为 MVC 不支持回发，我们应该按照“页面后没有代码”示例中所示的方式呈现它。

就像这个[问题](https://stackoverflow.com/questions/319835/new-asp-net-charting-controls-will-they-work-with-mvc-eventually)一样。

现在我想知道**如何在控制器中创建其他图表类型**（如饼图）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T12:32:17.287

我喜欢谷歌图表。只需编写一个 HTMLHelper 来呈现正确的 URL。

[http://code.google.com/apis/chart/](http://code.google.com/apis/chart/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T14:16:46.403

尝试使用诸如[amCharts 之](http://www.amcharts.com)类的 3rd 方 Flash 图表控件。它们可以通过简单的 XML 文件进行配置，并从静态或生成的 XML 或 CSV 文件或流中获取数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-14T13:32:06.243

[新的 asp.net 图表控件——它们会与 MVC（最终）一起使用吗？](https://stackoverflow.com/questions/319835/new-asp-net-charting-controls-will-they-work-with-mvc-eventually)

很久以前创建的东西，但与这个主题相关。

# jquery - ASP.NET MVC ModelBinder 不能处理 GET 请求和/或 jQuery AJAX？

> ID：929409
> 
> 赞同：1
> 
> 时间：2009-05-30T09:15:54.063
> 
> 标签：jquery, asp.net-mvc, ajax, modelbinder

当通过 GET 而不是 POST 调用时，让 MVC 填写我的自定义模型参数似乎有问题。

我有一个 JavaScript 片段，它调用如下操作：

```
$.getJSON('<%= Url.Action("DoSearch") %>' + location.search,
    function(data) {
        if (data.Result == "OK") {
            location.href = location.href;
        }
    }); 
```

它的作用基本上是调用一个单独的操作，将与调用页面相同的查询字符串传递给它。然后如果结果为“OK”，则刷新当前页面。

动作定义如下：

```
 public ActionResult DoSearch(SearchParameters searchParameters) 
```

型号为：

```
public class SearchParameters
{
    public string Query;
    ...
} 
```

调用 URL（用 firebug 验证）就像`/DoSearch?Query=some+query`. （也试过`/DoSearch?searchParameters.Query=some+query`没有成功）

无论我尝试什么，我的参数总是显示为空（不是 null，只是所有参数都被初始化为其默认值）

如果我这样定义动作：

```
 public ActionResult DoSearch(string Query, ...) 
```

然后我的参数被正确填写。然而，与模型无关。

我假设：

a) 填充对象模型不适用于 GET 请求。

b) 我做错了什么

有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T09:23:50.053

您需要公共属性来绑定一个类。

代替

```
public string Query; 
```

和

```
public string Query{get;set;} 
```

至少这是我必须做的才能让它在我的项目中工作。我不知道你是否还有其他问题。哦，我也使用了 GET，所以它应该可以工作。

这是我的参数类：

```
public class Parameters
{
    public int? page { get; set; }
    public int? pageSize { get; set; }
    public string[] columnsToDisplay { get; set; }
    public string columnToSort { get; set; }
    public bool? descending { get; set; }
} 
```

没有绑定字段。

# sql - 多语言数据库设计的最佳实践是什么？

> ID：929410
> 
> 赞同：216
> 
> 时间：2009-05-30T09:17:23.607
> 
> 标签：sql, database, database-design

创建多语言数据库的最佳方法是什么？为每个表创建本地化表使设计和查询变得复杂，在其他情况下为每种语言添加列很简单但不是动态的，请帮助我了解什么是企业应用程序的最佳选择

* * *

## 回答 #1

> 赞同：259
> 
> 时间：2009-05-30T09:28:40.057

我们所做的是为每个多语言对象创建两个表。

例如，第一个表仅包含与语言无关的数据（主键等），第二个表包含每种语言的一条记录，包含本地化数据和该语言的 ISO 代码。

在某些情况下，我们会添加一个 DefaultLanguage 字段，以便在没有可用于指定语言的本地化数据时回退到该语言。

例子：

```
Table "Product":
----------------
ID                 : int
<any other language-neutral fields>

Table "ProductTranslations"
---------------------------
ID                 : int      (foreign key referencing the Product)
Language           : varchar  (e.g. "en-US", "de-CH")
IsDefault          : bit
ProductDescription : nvarchar
<any other localized data> 
```

使用这种方法，您可以根据需要处理尽可能多的语言（无需为每种新语言添加额外的字段）。

* * *

*更新 (2014-12-14)：请查看[此答案](https://stackoverflow.com/a/27474681/19635)，了解有关用于将多语言数据加载到应用程序中的实现的一些附加信息。*

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-30T10:37:52.070

我推荐马丁发布的答案。

但是您似乎担心您的查询变得过于复杂：

> 为每个表创建本地化表使设计和查询变得复杂......

所以你可能会想，与其编写这样的简单查询：

```
SELECT price, name, description FROM Products WHERE price < 100 
```

...您需要开始编写这样的查询：

```
SELECT
  p.price, pt.name, pt.description
FROM
  Products p JOIN ProductTranslations pt
  ON (p.id = pt.id AND pt.lang = "en")
WHERE
  price < 100 
```

不是一个非常漂亮的观点。

但是，您应该开发自己的数据库访问类，而不是手动执行此操作，该类会预先解析包含您的特殊本地化标记的 SQL，并将其转换为您需要发送到数据库的实际 SQL。

使用该系统可能看起来像这样：

```
db.setLocale("en");
db.query("SELECT p.price, _(p.name), _(p.description)
          FROM _(Products p) WHERE price < 100"); 
```

我相信你可以做得更好。

关键是让您的表和字段以统一的方式命名。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-30T09:33:34.323

我发现这种方法对我有用：

```
产品 产品详情 国家
=====================================
ProductId ProductDetailId CountryId
- 等等 - ProductId CountryName
            CountryId 语言
            产品名称 - 等等 -
            产品描述
            - ETC -

```

ProductDetail 表包含您想要支持的语言的所有翻译（产品名称、描述等）。根据您的应用程序的要求，您可能希望将 Country 表分解为也使用区域语言。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-30T09:38:40.723

我正在使用下一种方法：

## 产品

产品ID 订单ID，...

## 产品信息

ProductID 标题 名称 LanguageID

## 语言

LanguageID 名称 文化,....

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-08-24T14:39:08.957

Martin 的解决方案与我的非常相似，但是当找不到所需的翻译时，您将如何处理默认描述？

这是否需要一个 IFNULL() 和每个字段的另一个 SELECT 语句？

默认翻译将存储在同一个表中，其中像“isDefault”这样的标志指示该描述是否是默认描述，以防当前语言没有找到。

# c++ - 如何在不可靠的集群上分发程序？

> ID：929411
> 
> 赞同：3
> 
> 时间：2009-05-30T09:18:01.313
> 
> 标签：c++, cluster-computing, distributed-computing

我正在寻找的是以下任何/所有内容：

*   工人故障的自动发现（例如计算机关闭）
*   检测给定IP地址范围内所有正在运行的（linux）PC（计算机开启）
*   ...和汽车工人产卵（ping + ssh？）
*   负载平衡，以便工作人员不会减慢其他进程（很好？）
*   某种形式的消息传递

...并且不想重新发明轮子。

C++ 库、bash 脚本、独立程序……都欢迎。

如果您举一个软件示例，请告诉我们它具有上述哪些功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T09:26:29.190

查看[Spread Toolkit](http://www.spread.org)，一个 C/C++ 组通信系统。它将允许您以允许您重新平衡分布式工作负载的方式检测节点/进程故障和恢复/启动。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T14:32:39.163

您正在寻找的东西称为“作业调度程序”。市场上有很多作业调度器，这些是我熟悉的：

*   [SGE](http://en.wikipedia.org/wiki/Sun_Grid_Engine)处理与多台机器上的作业调度相关的所有问题（恢复、监控、优先级、排队）。您的软件不必支持 SGE，因为 SGE 只是提供了一个您提交批处理作业的环境。
*   [LSF](http://en.wikipedia.org/wiki/Load_Sharing_Facility)是一个更好的选择，但不是免费的。

要支持消息传递，请参阅[MPI](http://en.wikipedia.org/wiki/Message_Passing_Interface)规范。SGE 完全支持基于 MPI 的分发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T09:43:53.087

根据您的应用要求，我会查看 BOINC 基础架构。他们在最新版本中实现了一种客户端/服务器通信形式，目前尚不清楚您需要哪种形式的通信。他们的 API 是用 C 语言编写的，我们很容易用 C++ 为它编写了包装器。

BOINC 的另一个优点是它旨在为大型分布式计算项目（如 SETI 或 Rosetta@Home）进行扩展，因此它支持验证、作业分配和管理不同平台的不同应用程序版本等内容。

这是链接：

[BOINC 网站](http://boinc.berkeley.edu/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T10:15:10.963

有[Hadoop](http://hadoop.apache.org/)。它有 Map Reduce，但我不确定它是否有我需要的任何其他功能。有人知道吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-23T19:36:21.810

您确实在寻找“作业调度程序”。节点“静态”注册到作业调度程序。这允许作业调度程序检查节点并确定核心数、RAM、可用暂存盘空间、操作系统等等。所有这些信息都可用于选择工作所需的资源。

作业调度程序还提供集群的基本健康监控。关闭的节点会自动从可用节点列表中删除。正在运行作业的节点（通过调度程序）也会从可用节点列表中删除。

[SLURM](https://computing.llnl.gov/linux/slurm/)是您可能会考虑的资源管理器和作业调度程序。SLURM 具有 LSF 和 PBSPro 的集成挂钩。一些 MPI 实现是“SLURM 感知”的，并且可以使用/设置环境变量，这些环境变量将允许 MPI 作业在 SLURM 分配给它的节点上运行。

# c# - 如何用字母创建按字母顺序排列的列表？

> ID：929416
> 
> 赞同：2
> 
> 时间：2009-05-30T09:21:45.143
> 
> 标签：c#, asp.net-mvc, algorithm, logic

大家好，我试图按列实现 alpha 有序列表

[如图](http://clip2net.com/clip/m12007/1243674700-clip-41kb.png)所示

但是我的算法不清楚，也许有人可以帮助我

```
string[] letters = new string[] { "A", "B", "C", "D", "E", "F", "G", "H", "I",
  "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X",
  "Y", "Z", "Å", "Ä", "Ö", "0-9" };

int j = 0, s = 0, i = 1;
var fullServices = (from se in EntityBase.db.Services
               orderby se.Name
               select se).ToList();
int total = fullServices.Count;
var grouped = (from l in letters
            select new ServiceInfo
            {
              Letter = l,
              Services = EntityBase.db.Services.Where(se => se.Name.StartsWith(l)).ToList(),
              Total = EntityBase.db.Services.Where(se => se.Name.StartsWith(l)).Count()
            }).ToList();
Dictionary<int, List<ServiceInfo>> result = new Dictionary<int, List<ServiceInfo>>();

changecell:

List<ServiceInfo> item = new List<ServiceInfo>();
while (j < letters.Count())
{
letterchange:
   List<Service> _services = new List<Service>();
   while (s < total)
   {
      if ((s == (5 + (total % 5 > i ? 1 : 0)) * i))
      {
         item.Add(new ServiceInfo() { Letter = letters[j], Services = _services });
         result.Add(i, item);
         if (i == 6)
            goto exit;
         i++;
         goto changecell;
      }
      //start render services
      if (fullServices.ElementAt(s).Name.StartsWith(letters[j]))
      {
         _services.Add(fullServices.ElementAt(s));
         s++;//increment service in list
      }
      else //letter switch
      {
         item.Add(new ServiceInfo() { Letter = letters[j], Services = _services });
         j++;
         goto letterchange;
      }
   }//end render services

}
exit:
return View(result); 
```

在我的代码中，我看到遗漏的字母 XYZ Å Ä Ö，它看起来像[这样](http://clip2net.com/clip/m12007/1243675035-clip-15kb.png)

这是呈现字典的代码

```
<% foreach (KeyValuePair<int, List<BL.Models.Infos.ServiceInfo>> col in Model)
{ %>
  <ul class="col">
    <% foreach (var item in col.Value)
 { %>
    <% if (!item.Services.Any())
 {%>
    <li class="disabled">
      <h1>
        <%= item.Letter %></h1>
    </li>
    <%}
 else
 { %>
    <li>
      <h1>
        <a href="/service/info/<%= item.Letter %>"><%= item.Letter %></a>
      </h1>
    </li>
    <% foreach (var service in item.Services)
 { %>
    <li><a href="/service/info/<%= service.Name %>"><%= service.Name %></a></li>
    <%}
 }
 }%>
  </ul>
  <%} %> 
```

请帮忙...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T09:39:52.953

好吧，您当然是对的，代码不是特别清楚:)

我并没有真正遵循您代码的主循环，但这是一个更简单的起点。请注意，它不会正确地将 0-9 分组（它目前只处理 0）：老实说，我不确定解决这个问题的最佳方法。你可能想推迟它，直到你得到一些与任何正常字母都不匹配的条目......

```
using System;
using System.Linq;

class Test
{   
    static void Main(string[] args)
    {
        ShowGroups();
    }

    private static readonly char[] Letters = 
        "ABCDEFGHIJKLMNOPQRSTUVWXYZÅÄÖ0".ToCharArray();

    // This is taking the place of EntityBase.db.Services
    // for the purposes of the test program
    public static string[] Services = { "Blogger", "Delicious", 
            "Digg", "Ebay", "Facebook", "Feed", "Flickr", 
            "Friendfeed", "Friendster", "Furl", "Google", 
            "Gosupermodel", "Lastfm", "Linkedin", "Livejournal",
            "Magnolia", "Mixx", "Myspace", "NetOnBuy", "Netvibes",
            "Newsvine", "Picasa", "Pownce", "Reddit", "Stumbleupon",
            "Technorati", "Twitter", "Vimeo", "Webshots", 
            "Wordpress" };

    public static void ShowGroups()
    {
        var groupedByLetter = 
            from letter in Letters
            join service in Services on letter equals service[0] into grouped
            select new { Letter = letter, Services = grouped };

        // Demo of how to access the groups
        foreach (var entry in groupedByLetter)
        {
            Console.WriteLine("=== {0} ===", entry.Letter);
            foreach (var service in entry.Services)
            {
                Console.WriteLine ("  {0}", service);
            }
            Console.WriteLine();
        }
    }
} 
```

我不知道您打算如何将结果分成 5 个相等的列...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T09:58:25.613

这可能是一种方式——我刚刚在记事本中完成了这项工作（现在无法访问 IDE）。看起来您正在尝试填充`Dictionary<int, List<ServiceInfo>> result`实例，并且我假设您的`View`方法了解如何在列中布局结果。

开始：

```
string[] letters = new string[] { "A", "B", "C", "D", "E", "F", "G", "H", "I", "J",
                                  "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T",
                                  "U", "V", "W", "X", "Y", "Z", "Å", "Ä", "Ö", "0-9" };

var result = new Dictionary<int, List<ServiceInfo>>();
foreach (var letter in letters)
{
    var services = (from se in EntityBase.db.Services
                    where se.Name.StartsWith(letter)
                    orderby se.Name
                    select select new ServiceInfo
                    {
                        Letter = letter,
                        Services = EntityBase.db.Services.Where(se => se.Name.StartsWith(letter)).ToList(),
                        Total = EntityBase.db.Services.Where(se => se.Name.StartsWith(letter)).Count()
                    }).ToList();
    result.Add(i, services);
} 
```

如果它是正确的，它可能不会是最快的实现，但它更具可读性。

# open-source - 自动工具生成的链接应该在上传之前替换吗？

> ID：929425
> 
> 赞同：0
> 
> 时间：2009-05-30T09:25:38.270
> 
> 标签：open-source, autotools

我的主要问题是自动工具创建了指向安装、复制、丢失、安装-sh 和 depcomp 的链接。当我试图查看它们时，我看到它们是作为链接上传的，所以我用真实文件替换它们，这样它们就可以查看了。我错过了一些基本的东西吗？当我从“make dist”解压我的 gz 文件时，它是这样的：

**分布树（减去源目录）**

```
-rw-r--r-- 1 ojblass 用户 18591 2009-05-30 03:23 Makefile.in
-rwxr-xr-x 1 ojblass 用户 136168 2009-05-30 03:20 配置
drwxr-xr-x 3 ojblass 用户 4096 2009-05-30 03:20 autom4te.cache
-rw-r--r-- 1 ojblass 用户 32230 2009-05-30 03:20 aclocal.m4
-rw-r--r-- 1 ojblass 用户 251 2009-05-30 03:20 configure.ac
-rw-r--r-- 1 ojblass 用户 626 2009-05-30 03:11 作者
-rwxr-xr-x 1 ojblass 用户 120 2009-05-30 03:11 autogen.sh
-rw-r--r-- 1 ojblass 用户 737 2009-05-30 03:11 ChangeLog
-rw-r--r-- 1 ojblass 用户 35147 2009-05-30 03:11 复制
-rwxr-xr-x 1 ojblass 用户 17867 2009-05-30 03:11 depcomp
-rwxr-xr-x 1 ojblass 用户 199 2009-05-30 03:11 example.pl
-rwxr-xr-x 1 ojblass 用户 152 2009-05-30 03:11 example.sh
-rw-r--r-- 1 ojblass 用户 9512 2009-05-30 03:11 安装
-rwxr-xr-x 1 ojblass 用户 13620 2009-05-30 03:11 install-sh
-rw-r--r-- 1 ojblass 用户 215 2009-05-30 03:11 Makefile.am
-rwxr-xr-x 1 ojblass 用户 11135 2009-05-30 03:11 丢失
-rw-r--r-- 1 ojblass 用户 75 2009-05-30 03:11 新闻
-rwxr-xr-x 1 ojblass 用户 507 2009-05-30 03:11 profile.sh
-rw-r--r-- 1 ojblass 用户 2605 2009-05-30 03:11 自述文件
-rw-r--r-- 1 ojblass 用户 201 2009-05-30 03:11 README_developers
-rwxr-xr-x 1 ojblass 用户 382 2009-05-30 03:11 run.sh
-rw-r--r-- 1 ojblass 用户 481 2009-05-30 03:11 TODO
-rwxr-xr-x 1 ojblass 用户 117 2009-05-30 03:11 有用的.sh

```

我计划删除 README_developers 并在 README 中创建两个部分。我还在考虑删除 run.sh 和 profile.sh 并使它们成为 make 测试目标的一部分（需要阅读一些内容）。我不认为 TODO 项属于源代码分发，但也许可以将它放在项目的源代码树中。任何超出链接问题的额外指针表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T11:16:03.027

**简短的回答：** 留下那些符号链接（除了安装）将被伪造符合[GNU 编码标准](http://www.gnu.org/prep/standards/standards.html)。

默认情况下，automake 会检查是否符合 GNU 标准（需要存在以下文件：INSTALL、NEWS、README、COPYING、AUTHORS 和 ChangeLog）。可以通过将 --foreign 选项传递给 automake （编辑 autogen.sh 并重新运行它）来关闭该检查（并安全地删除其中一些文件）。

链接是在使用 --add-missing 选项调用 automake 时创建的，除非给出 --copy 选项，否则会为丢失的文件创建符号链接，而不是复制它们。这是为了在您安装较新的 automake 时使这些文件（实际上仅 INSTALL）保持最新。Regerding Jonathan 的回答这些符号链接不是问题：在制作 tarball 之前，所有分布式文件都被复制到单独的目录中。如果要编辑它们，请将它们更改为常规文件。

其他文件（README_developers、run.sh、profile.sh、TODO 等）可能由您正在使用的 IDE 生成并添加到 `EXTRA_DIST`顶部 Makefile.am 中的变量中。您可以通过编辑将它们从分发中删除`EXTRA_DIST`，然后您也可以从源中删除它们。

其余部分由 autoconf 和 automake 自动生成：

*   aclocal.m4
*   autom4te.cache
*   配置
*   depcomp
*   安装-sh
*   生成文件.in
*   失踪

如果您想进一步整理您的顶级源目录，您可以添加 `AC_CONFIG_AUX_DIR([scripts])`到 configure.ac。这样一些脚本将在`scripts`目录中找到位置。

**更新：**

GNU 编码标准仅描述了这些文档文件在分发中存在的要求以及应该包含哪些信息。--add-missing 选项用于提醒程序员应该写入哪些文件。显然，拥有空 NEWS 或 AUTHORS 文件不会使项目更符合标准。

只有 ChangeLog 文件对其格式有严格的[要求。](http://www.gnu.org/prep/standards/standards.html#Change-Logs)在某些项目中，ChangeLog 是从格式正确的提交消息中自动生成的。在 Darcs 上很简单`darcs changes >ChangeLog`。如果您使用 Subversion，您可以查看：[svn2log](http://www.core.com.pl/svn2log/)、[svn2cl](http://ch.tudelft.nl/~arthur/svn2cl/)。

如前所述，将 INSTALL 文件保留为符号链接可能是合理的，但前提是不需要有关安装的项目特定信息（即没有额外的配置脚本参数等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T05:10:47.590

TODO 文件可以进入发行版；它向消费者表明了您认为产品中存在的缺陷，并且它们是指向可能有助于改进产品的领域的潜在贡献者的指针。（另外，如果你跌倒在公共汽车下，它会帮助其他人接管使用当前的发布材料。）

使用子目录来保存大部分配置材料可能是值得的。

关于您的主要问题-文件是“链接”还是“符号链接”？`-h`除非您告诉 (GNU) tar 无论如何都要遵循它们（' ' 或 ' '） ，否则符号链接对于打包的用处不大`--dereference`。如果唯一的符号链接是指向这些文件的，那就行了；如果您在发行版本身中使用符号链接，则可能会适得其反。

# encryption - 如何生成包含加密数据的密钥代码？

> ID：929433
> 
> 赞同：0
> 
> 时间：2009-05-30T09:32:44.997
> 
> 标签：encryption, rsa

## 情况：

我想提供一个网站服务，用户可以在其中输入一些数据，例如 15 字节长的名称“namedata”并获取密钥代码。然后，该代码可用于解锁游戏中的某些功能（由我提供），还可以使用名称数据（想想一个名为“Lazgun of Peter”的自定义 Lazgun，其中“Peter”是名称数据）。

我的计划是使用非对称加密（使用私钥）将名称数据与一些短签名（例如 5 字节“hello”）一起加密到密钥代码中（类似于 AsdF-STaCK-0VEr-FL0W-13Abbx）。

然后用户在游戏中输入密钥代码，然后游戏使用公钥将数据解码为 namedata 和签名，瞧，用户得到了它的“Lazgun of Peter”。

## 问题：

问题（或我的误解？）是典型的 RSA 加密只能用于加密密钥长度的数据，例如 1024 位，这对于我的密钥代码来说太长了 - 没有用户想要输入 150 的代码+ 字符（假设每个输入的字符大约有 6 位数据）。

## 问题：

我应该使用什么样的加密来获得不错的安全性，这样只有我的网站服务才能生成“正确”的代码，但用户只需要输入大约 namedata 大小的代码 + 签名 + 一些小开销？

注意：游戏可执行文件显然是公开可用的，并且可以从中读取存储在其中的任何加密密钥，但可执行文件本身不能更改（复制保护）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T10:40:11.257

我认为将所有项目数据存储在实际密钥代码中是错误的想法。

创建唯一的下载代码更有意义。输入后，客户端将连接到服务器，并通过安全连接下载实际项目数据。

这有道理吗？

# design-patterns - 在这种情况下应该在哪里定义访问者模式的 Accept 方法？

> ID：929435
> 
> 赞同：2
> 
> 时间：2009-05-30T09:34:27.630
> 
> 标签：design-patterns, oop

我们提供的服务既可以是教育税，也可以是应税服务，也可以是非应税服务。税收可以进一步分为以下类型：附加税、销售税、消费税、八项税、教育税、补贴、其他地方税。
我们计划使用访客来计算税款。Visitable 类/接口、Service 或 TaxCategory 的最佳选择是什么。

类别的数量将限于税种的组合。服务就像可定制的产品，预计大约有 3000 多个。每个服务都有一个 TaxCategory 成员。

某些服务可能属于给定的税收类别，但仍有额外的税收/补贴。

亲切的问候，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T10:05:43.463

由于我们在这里讨论的是访问者/访问者设计模式，我想说访问者/接受接口确实应该在 TaxCategory 上。访问者模式的思想是让访问者进入可访问对象，执行一些操作，然后取回一些结果。

这听起来完美地描述了您需要对每个 TaxCategory 执行的操作。进去，在该税的背景下执行必要的计算，然后取回你需要的价值。

希望这是有道理的。

# ruby-on-rails - Ruby on Rails 中的隐式表

> ID：929437
> 
> 赞同：0
> 
> 时间：2009-05-30T09:35:58.343
> 
> 标签：ruby-on-rails, ruby, activerecord

我刚刚学习如何在 Ruby on Rails 中编程，Ruby on Rails 框架为您完成的工作给我留下了深刻的印象。我有以下两个课程：

```
Object
--------
object_id
description

ObjectGroup
--------
group_id 
description 
```

这个想法是我有一些对象，我希望用户能够定义对象组。对象行和对象组行都有自己的标识符和关联数据，这基于网络上发布的文档非常直观。我的问题是 - 我如何存储有关构成 ObjectGroup 的对象的信息并充分利用 Ruby on Rails 框架？在 SQL 中执行此操作的明显方法是使用第三个表，该表存储以下形式的条目：

```
ObjectGroupEntry
--------
object_id
group_id 
```

ObjectGroupEntry 表中的每个条目都代表一个 Object，它是 ObjectGroup 的一部分。我是否有责任手动创建此表并教与 Objects 和 ObjectGroups 交互的类如何与之交互？或者 Ruby on Rails 是否提供了一些我还没有发现的魔法来做到这一点？

我可以用我所知道的自己来做这件事，但我仍在学习 Ruby on Rails，我想学习正确的方法 (TM) 来做这件事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T09:43:24.617

对于 Rails，两者兼而有之。您使用具有正常命名约定的迁移（或其他方法）创建表，然后在 Object 和 ObjectGroup 的模型中放入以下行：

```
==Object==
has_and_belongs_to_many :object_groups

==ObjectGroup==
has_and_belongs_to_many :objects 
```

只要您在 ObjectObjectGroup 表中没有任何额外信息，那么这就是您所需要的。否则，您将需要一个新模型，但可能会获得相同的行为，如下所示：

```
==Object==
has_many :object_object_groups
has_many :object_groups, :through => :object_object_groups

==ObjectObjectGroup==
belongs_to :object
belongs_to :object_group

==ObjectGroup==
has_many :object_object_groups
has_many :objects, :through => :object_object_groups 
```

使用 :through 属性指示 has_many 关系以获得多对多关系，并允许访问有关该关系的其他信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T11:04:05.827

我想你会发现它是

```
has_many :object_object_groups
has_many :objects, :though => :through => :object_object_groups 
```

而不是workmad3所说的。提供的所有其他信息都是正确的，但这只是语法错误。

# sql - 获取 sql DateTime 日期的字符串表示形式

> ID：929440
> 
> 赞同：2
> 
> 时间：2009-05-30T09:38:10.977
> 
> 标签：sql, datetime, dayofweek, weekday

假设我的 sql 日期时间为“2009 年 5 月 1 日”或“2009 年 5 月 12 日”。我可以在上面的日期上执行任何内置的 sql 函数/操作以返回日期的 DAY 的字符串表示形式吗？

所以对于“2009 年 5 月 1 日”，我会得到“星期五”作为答案（大小写不重要）。对于“2009 年 5 月 12 日”，我会得到“星期二”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T09:42:24.930

[日期名称](http://msdn.microsoft.com/en-us/library/ms174395.aspx)

```
SELECT DATENAME(weekday, '1 May 2009') 
```

编辑：对于 MS SQL Server

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T09:42:22.510

```
DATE_FORMAT(somedatetimevariable, '%W'); 
```

参考：[http ://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-format](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_date-format)

编辑 (gbn)：对于 MySQL

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T09:56:48.300

对于 MySQL，如果该列实际上是一个字符串，则必须先将其转换为 DATE：

```
mysql> SELECT DATE_FORMAT(STR_TO_DATE('1 May 2009', '%e %M %Y'), '%W');
+----------------------------------------------------------+
| DATE_FORMAT(STR_TO_DATE('1 May 2009', '%e %M %Y'), '%W') |
+----------------------------------------------------------+
| Friday                                                   |
+----------------------------------------------------------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T10:29:00.810

如果您正在研究如何进行不同的表示，那么您不能比[SQL Server Helper](http://www.sql-server-helper.com/tips/date-formats.aspx)的这个链接做得更好。这将向您展示如何将日期转换为您不知道如何处理的更多格式。我有这个经常书签，以方便参考。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-18T07:19:40.967

对于 MySQL：[DAYNAME](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_dayname)

```
DAYNAME('2015-12-01') 
```

# asp.net - Page.PreLoad 事件未显示在 Visual Studio 中

> ID：929449
> 
> 赞同：3
> 
> 时间：2009-05-30T09:44:56.577
> 
> 标签：asp.net, visual-studio

我想知道为什么我在 Visual Studio 2008 中看不到所有页面事件，当我单击事件组合框时，只有 page_load 事件在其中。我可以做什么来查看组合中的所有页面生命周期事件，这样我就可以单击它来生成事件模板？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T09:56:49.517

这是页面生命周期：http: [//msdn.microsoft.com/en-us/library/ms178472.aspx](http://msdn.microsoft.com/en-us/library/ms178472.aspx)

您看不到事件，因为它们还没有写在代码页中，您必须自己编写它们（如果您指的是顶部页面后面的代码中的组合框）

如果您已经设置了 AutoEventWireup="true"，只需编写代码：

```
protected void Page_PreLoad(object sender, EventArgs e)
{
   // handle code
} 
```

# assembly - 堆栈的汇编 x86 实现

> ID：929450
> 
> 赞同：0
> 
> 时间：2009-05-30T09:45:27.730
> 
> 标签：assembly, x86

我需要在 x86 程序集中实现一个堆栈，所以我写了这个：

```
section .bss

my_stack: 
       resb 5 
```

但是在我继续我的程序后，这个地址内的数据消失了

有更好的方法可以实现堆栈？？？？？？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T10:09:03.970

我不确定你想要什么，但是由于 x86 汇编语言提供了它自己的堆栈，为什么不使用它呢？

```
push reg ; push register reg to the stack
pop reg  ; pop register reg from the stack
         ; actual stack pointer = sp 
```

顺便说一句，你的代码只为变量保留了 5 个字节的空间，要看看你的数据为什么会消失，程序的其余部分会很有趣。一个堆栈只使用 5 个字节也很奇怪。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T08:52:02.213

下面是一个简单示例，说明如何在 x86 asm 中创建自己的堆栈：

```
format pe console
entry start

include 'win32ax.inc' ;used for proc macros only

MAXSIZE = 256

section '.text' code readable executable

    start:
            ;test code
            push 12345
            call myPush
            push 22222
            call myPush
            call myPop
            call myPop
            ret

    proc myPush x
         cmp [_top], MAXSIZE        ;did we exceed stack size
         ja stack_full
         inc [_top]                 ;update the last element position
         mov eax, [_top]
         mov esi, _stack
         mov edx, [x]
         mov dword [esi+eax*4], edx ;write the value to stack
    stack_full:
         ;do something when stack is full
         ret
    endp

    proc myPop
         cmp [_top], 0              ;did we write anything previously
         jbe stack_empty
         mov eax, [_top]
         mov [_stack+eax*4], 0       ;clear stack value at last position
         dec [_top]                 ;decrease last element position
    stack_empty:
         ;do something when stack is empty
         ret
    endp

section '.data' data readable writeable
    _stack dd MAXSIZE dup ?
    _top dd ? 
```

我在这里使用了 FASM 语法，但这应该不是问题。我还建议在内存中分配堆栈，例如使用 VirtualAlloc。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-10T08:35:10.327

要使用你的堆栈，如果你是 16 位，你必须正确设置 ss:sp，否则是 (ss):esp。设置 ss:sp 的首选方法是在同一指令中加载 ss 和 sp 的 LSS 指令。

```
section .bss

my_stack: 
       resb 5

section .text

setup_stack:
       lss sp, [my_stack]
       ; rest of your code 
```

# php - 将 PHP 页面转换为静态 HTML 页面的最简单方法

> ID：929454
> 
> 赞同：6
> 
> 时间：2009-05-30T09:50:18.813
> 
> 标签：php, html, email, xhtml, static

我想将一个以 PHP 编写的大量 CSS 样式的网页转换为静态 html，以便我可以将其嵌入到电子邮件中。

我设法做到了这一点，但为了实现这一点，我必须将整个页面转换为一个字符串，然后将该字符串分配为电子邮件正文。页面的布局看起来不如原来的好，因为我无法嵌入 CSS。

这种方法有一些问题，例如如果必须对页面布局进行任何更改，我必须重做生成可嵌入页面的整个过程。

我想要一种更简单的方法，让我可以在 Dreamweaver 中直观地保持原始页面可编辑。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-30T09:57:38.800

您可以使用输出缓冲区。如果你有一个 html 页面，例如：

```
 <html>
      <head>
         <title>Blah</title>
      </head>
      <body>
        Some text here
      </body>
   </html> 
```

然后，如果你把，在 html 文件的顶部：

```
<?php ob_start(); ?> 
```

在底部，在最后一个标签之后，输入：

```
<?php 
   $string = ob_get_contents(); 

   //do whatever you need to do to the html, save it to a seperate file, email it, etc

   ob_flush();
?> 
```

这基本上意味着 $string 变量将在动态生成后以页面的整个静态 html 结束。然后，您可以在电子邮件中使用该字符串。虽然实际上，html 页面在电子邮件中的工作方式并不完全相同，因此您可能需要重新考虑这种方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T09:56:17.023

由于以下几个原因，这是一件很难自动完成的事情：

1.  如果您认为浏览器对 HTML 的支持很糟糕，那么电子邮件程序会差一个数量级。基本上你应该像 1999 年那样编写 HTML，所以 HTML 3.2/4.0，没有 CSS；
2.  您可以选择将图像作为外部链接包含在内，也可以将它们直接嵌入到电子邮件中。外部链接占用的空间较少，但许多邮件程序会阻止它们，因为垃圾邮件发送者使用它们来标记实时地址（通过使它们发送的每个图像 URL 都是唯一的，因此它们可以确定打开了哪封电子邮件）。嵌入图像使用略有不同的参考格式；
3.  CSS 支持基本上应该被视为不存在。所有 CSS 必须是内部的；
4.  最佳做法是，在发送 HTML 电子邮件时，也为不支持 HTML 或用户禁用它的客户端发送纯文本版本（是的，确实会发生这种情况）。并且没有将复杂的 HTML 页面转换为等价的纯文本的好方法。基本上必须手工完成；和
5.  电子邮件内容不同于网页内容。网页通常具有搜索框、菜单、侧边栏、页眉、页脚等。这些都是您对电子邮件不感兴趣的事情。您只对页面的内容感兴趣。所以博客在这方面工作得很好，因为可以很容易地提取博客文章的内容。任意页面更难。

因此，有多种方法可以做到这一点，例如使用 cURL 获取网页，使用输出缓冲通过 require/include 捕获页面等，但所有这些方法都存在上述一个或多个问题。我通常发现编写 HTML 电子邮件的唯一方法是手动滚动它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-27T06:24:41.583

只需在 php 页面中执行此操作

将其放在要开始捕获输出的位置的顶部：

ob_start();

把它放在php的底部

$HtmlCode= ob_get_contents(); ob_end_flush();

$fh=fopen('index.html','w'); fwrite($fh,$HtmlCode);

fclose($fh);

然后重定向到html页面

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-05-27T06:17:55.170

只需在 php 页面中执行此操作

将其放在要开始捕获输出的位置的顶部：

把它放在php的底部

$HtmlCode= ob_get_contents(); ob_end_flush();

$fh=fopen('index.html','w'); fwrite($fh,$HtmlCode);

fclose($fh);

?> 然后重定向到 html 页面

# c# - 序列化中传递了哪些数据？（二进制序列化）

> ID：929458
> 
> 赞同：6
> 
> 时间：2009-05-30T09:52:31.430
> 
> 标签：c#, serialization

在序列化（二进制序列化）中传输的是什么数据？类（对象）的实例或分配给该对象属性的值。

我想知道序列化过程中基本上发生了什么？我的意思是一个对象被转换为它的目标文件或序列化中的任何东西。但是怎么做？在这个过程中遵循了哪些步骤？

有人可以帮忙吗？

杰...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T10:21:24.367

二进制序列化正在拍摄对象并将其序列化。这意味着所有未标记为 NonSerializable 的私有字段都将使用它们的值进行序列化。对象层次结构中使用的所有对象都必须设为可序列化。您应该将 [field:NonSerializable] 属性放在事件上，因此事件处理程序也不会被序列化：http: [//bytes.com/groups/net-c/250944-nonserialized-attribute-events#post1013968](http://bytes.com/groups/net-c/250944-nonserialized-attribute-events#post1013968)

请记住，在反序列化对象时，您必须在同一个程序集中拥有与序列化它时完全相同的对象（相同意味着相同的程序集信息）。如果没有，您可以使用 SerializationBinder 类，这样您就可以重置流将被消毒的类型。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T10:10:49.567

我假设你的意思是`BinaryFormatter`; 这取决于;-p

序列化的目的是将一个复杂的内存对象表示为一个简单的字节序列（或取决于序列化程序 - 字符等），可以在另一端重新水合以重新创建对象。

某些类型（原语、字符串等）具有序列化程序的内置直接支持 - 它直接编写这些。

在类的情况下，写入类型元数据（包括程序集名称等），然后枚举类型上的所有**字段**（本质上`Type.GetFields()`，包括私有等）。对于每个字段（未标记`[NonSerialized]`），写入字段名称，并序列化值（通过相同的过程）。最终，一切都归结为内置的原语、一些类型定义和一些名称/值字段对。

这里的一个例外是类型是否实现`ISerializable`- 在这种情况下，要求类型将自身序列化到输出。这在诸如字典类型之类的事物中很常见，其中类型的内存布局可以以不同的方式表示为流。

在反序列化过程中，过程是相反的；类型元数据用于创建一个空对象（除非它有一个特殊的序列化构造函数/ `ISerializable`）；然后设置字段，因为它们在流中找到。

在序列化和反序列化中都有“回调”点，您可以在其中执行附加代码来修复（反）序列化的对象。

这个过程很脆弱；出于很多原因，[请参见此处](http://marcgravell.blogspot.com/2009/03/obfuscation-serialization-and.html)-但它也是版本不容忍和特定于实现的（您不能从 java 等中使用它）。

[protobuf-net通过成为](http://code.google.com/p/protobuf-net/)*基于合约*而不是*基于字段*的二进制序列化程序，解决了很多这些问题。

* * *

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T09:54:48.383

默认情况下，当使用二进制序列化时，只有一个类型的字段会被序列化。属性被视为方法，对序列化没有影响。

使用 Xml 序列化时，默认情况下会序列化公共属性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-16T01:52:13.590

以 Java 语言为例。当一个对象被序列化时，实际上会发生什么？二进制序列化实际上只保存有效数据，即Java的原始数据类型的数据，例如Timestamp对象。二进制序列化实际上将长型时间戳保存在二进制中。

如果你对这个过程感兴趣，可以看看**FastProto** ( [https://github.com/indunet/fastproto](https://github.com/indunet/fastproto) )，一个协议化的序列化工具，可以帮助很好地理解这个过程。

# python - Django ORM Query 以限制特定键实例

> ID：929468
> 
> 赞同：1
> 
> 时间：2009-05-30T09:59:51.337
> 
> 标签：python, django, orm, django-models, django-orm

Projectfundingdetail 具有项目的外键。

以下查询为我提供了*任何*projectfundingdetail 低于 1000 的所有项目的列表。如何将其限制为仅最新的 projectfundingdetail。

```
projects_list.filter(projectfundingdetail__budget__lte=1000).distinct() 
```

我已经定义了以下功能，

```
def latest_funding(self):
    return self.projectfundingdetail_set.latest(field_name='end_date') 
```

但我不能使用以下内容，因为`latest_funding`它不是数据库字段

```
projects_list.filter(latest_funding__budget__lte=1000).distinct() 
```

那么我应该使用什么查询来获取所有只有其最新 projectfundingdetail 低于 1000 的项目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T17:38:58.720

这个查询比乍一看更难。AFAIK Django ORM 没有提供任何方法来为此查询生成有效的 SQL，因为有效的 SQL 需要相关的子查询。（我很乐意对此进行更正！）您可以使用此查询生成一些丑陋的 SQL：

```
Projectfundingdetail.objects.annotate(latest=Max('project__projectfundingdetail__end_date')).filter(end_date=F('latest')).filter(budget__lte==1000).select_related() 
```

但这需要从 Projectfundingdetail 加入到 Project 并再次返回，这是低效的（尽管可能足以满足您的需求）。

另一种方法是编写原始 SQL 并将其封装在管理器方法中。它看起来有点吓人，但效果很好。如果您将经理分配为 Projectfundingdetail 上的“对象”属性，您可以像这样使用它来获取每个项目的最新资金详细信息：

```
>>> Projectfundingdetail.objects.latest_by_project() 
```

它返回一个普通的 QuerySet，所以你可以添加更多的过滤器：

```
>>> Projectfundingdetail.objects.latest_by_project().filter(budget__lte=1000) 
```

这是代码：

```
from django.db import connection, models
qn = connection.ops.quote_name

class ProjectfundingdetailManager(models.Manager):
    def latest_by_project(self):
        project_model = self.model._meta.get_field('project').rel.to

        names = {'project': qn(project_model._meta.db_table),
                 'pfd': qn(self.model._meta.db_table),
                 'end_date': qn(self.model._meta.get_field('end_date').column),
                 'project_id': qn(self.model._meta.get_field('project').column),
                 'pk': qn(self.model._meta.pk.column),
                 'p_pk': qn(project_model._meta.pk.column)}

        sql = """SELECT pfd.%(pk)s FROM %(project)s AS p 
                 JOIN %(pfd)s AS pfd ON p.%(p_pk)s = pfd.%(project_id)s
                 WHERE pfd.%(end_date)s =
                     (SELECT MAX(%(end_date)s) FROM %(pfd)s 
                      WHERE %(project_id)s = p.%(p_pk)s)
              """ % names

        cursor = connection.cursor()
        cursor.execute(sql)
        return self.model.objects.filter(id__in=[r[0] for r
                                                 in cursor.fetchall()]) 
```

大约一半的代码（“名称”字典）只需要对非标准数据库表和列名称的可能性保持健壮。如果您确信它们永远不会改变，您也可以将表和列名称硬编码到 SQL 中。

# algorithm - O(log(log(n))))-competitive 是什么意思？

> ID：929470
> 
> 赞同：8
> 
> 时间：2009-05-30T10:00:11.773
> 
> 标签：algorithm, time-complexity

我正在浏览一些数据结构，我注意到这是一个时间复杂度： **O(log(log(n))))-competitive**。

我读到持续竞争是预期时间/最佳时间的比率。但是，有一个集合竞争意味着什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-30T15:54:47.040

在线算法是一种事先不知道其输入的算法，并且必须对不可预测的输入做出“反应”（在某种意义上）。相反，离线算法是那些预先知道其所有输入的算法。

竞争分析将最佳在线算法的性能与最佳离线算法的性能进行比较。因此，k 竞争意味着存在一种离线算法，其性能最多比在线算法差 k 倍。因此，O(lglgn) 竞争意味着最优离线算法的性能最多比最优在线算法差 lglgn（乘以常数）倍。

* * *

术语“k-竞争”可以以与术语“k-近似”相同的方式来考虑。k 近似意味着近似算法的性能最多比最优算法差 k 倍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T11:08:17.253

[这](http://books.google.gr/books?id=i3S9_GnHZwYC&pg=PA594&lpg=PA594&dq=O(log+log+n)+competitive+constant+factor&source=bl&ots=nBknqdArSw&sig=y_PKqaGiRdw9YEHMhqGQPgx7_vM&hl=el&ei=tw8hSrnMGo7GsgbInPyuBg&sa=X&oi=book_result&ct=result&resnum=2)可以阐明您的问题。

从上面的链接：

> 令 A 为任意 BST 算法，定义 A(S) 为执行序列 S 的成本，定义 OPT(S, To) 为执行序列 S 的最小成本。如果对于所有可能的序列 S，算法 A 是 T 竞争的， A(S) <= T * OPT(S, To) + O(m, n)。

# powershell - 使用 CloudDrive Azure 示例时出现 Powershell 错误

> ID：929471
> 
> 赞同：2
> 
> 时间：2009-05-30T10:00:42.147
> 
> 标签：powershell, azure, blob

我目前正在尝试使用 Azure SDK 附带的 CloudDrive (Powershell) 示例来列出我存储的 blob。我在这个过程的早期就遇到了一个错误，我想肯定是我做错了什么——我只是不知道如何调试这种问题......

我遵循了有关日志记录的[出色教程](http://blog.benday.com/archive/2008/11/07/23201.aspx)，还观看了[“操作方法”视频](http://msdn.microsoft.com/en-us/azure/dd637760.aspx)，它们都轻而易举地绕过了我遇到麻烦的区域。

看起来很简单，您运行 MountDrive Powershell 脚本，默认情况下该脚本将查看本地计算机上的开发存储，该脚本将为您安装两个新驱动器，一个 Blob 和一个队列驱动器。

然后您可以执行“ `dir Blob:`”或“ `dir Queue:`”，在上面的链接中，显示了所需的信息。在我的情况下，`dir Queue:`工作得很好，但`dir Blob:`会产生以下 Powershell 错误：

```
....\Azure\samples\CloudDrive\scripts> dir Blob:
Get-ChildItem : The specified container name ".." is not valid!Please choose a name that conforms to the naming conventions for containers!
At line:1 char:4
+ dir <<<<  Blob:
    + CategoryInfo          : NotSpecified: (:) [Get-ChildItem], ArgumentException
    + FullyQualifiedErrorId : System.ArgumentException,Microsoft.PowerShell.Commands.GetChildItemCommand 
```

现在，上面提到的“问题”容器名称 - “..” - 看起来像您可以执行“dir”操作的任何驱动器中列出的“点”和“两个点”。我不确定这是否与此有关，但在我见过的所有在线演示中，人们都会获得他们的 Blob 文件夹等列表，我只是收到此错误，我不知道如何修复它。

非常感谢任何帮助...

更新：我确实在使用预装了 Powershell 的 Windows 7 RC。如果这个版本实际上是错误的，那么我该如何去那里获得以前的版本......如果可能的话？

谢谢，

抢G

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T19:09:31.367

您使用的是 Windows 7 RC 吗？如果是这样，则该系统上的 powershell 版本中存在一些错误，可能会阻止示例正常工作。我已经在 Vista 上成功地使用了 blob 提供程序，所以我确信示例很好。

-Oisin

# python - 为什么 inspect.getsource 不返回整个类源？

> ID：929472
> 
> 赞同：0
> 
> 时间：2009-05-30T10:01:19.930
> 
> 标签：python, inspect, code-inspection

我的代码中有此代码`forms.py`：

```
from django import forms
from formfieldset.forms import FieldsetMixin

class ContactForm(forms.Form, FieldsetMixin):
    full_name = forms.CharField(max_length=120)
    email = forms.EmailField()
    website = forms.URLField()
    message = forms.CharField(max_length=500, widget=forms.Textarea)
    send_notification = forms.BooleanField(required=False)

    fieldsets = ((u'Personal Information',
                {'fields': ('full_name', 'email', 'website'),
                'description': u'Your personal information will not ' \
                                u'be shared with 3rd parties.'}),
                (None,
                {'fields': ('message',),
                'description': u'All HTML will be stripped out.'}),
                (u'Preferences',
                {'fields': ('send_notification',)})) 
```

当我尝试以编程方式提取代码时，`inspect`它会遗漏`fieldsets`：

```
In [1]: import inspect

In [2]: import forms

In [3]: print inspect.getsource(forms)
from django import forms
from formfieldset.forms import FieldsetMixin

class ContactForm(forms.Form, FieldsetMixin):
    full_name = forms.CharField(max_length=120)
    email = forms.EmailField()
    website = forms.URLField()
    message = forms.CharField(max_length=500, widget=forms.Textarea)
    send_notification = forms.BooleanField(required=False)

    fieldsets = ((u'Personal Information',
                {'fields': ('full_name', 'email', 'website'),
                'description': u'Your personal information will not ' \
                                u'be shared with 3rd parties.'}),
                (None,
                {'fields': ('message',),
                'description': u'All HTML will be stripped out.'}),
                (u'Preferences',
                {'fields': ('send_notification',)}))

In [4]: print inspect.getsource(forms.ContactForm)
class ContactForm(forms.Form, FieldsetMixin):
    full_name = forms.CharField(max_length=120)
    email = forms.EmailField()
    website = forms.URLField()
    message = forms.CharField(max_length=500, widget=forms.Textarea)
    send_notification = forms.BooleanField(required=False)

In [5]: 
```

这似乎不是空行的问题。我已经在没有空行的情况下进行了测试，并且在其他属性之间添加了额外的空行。结果不变。

任何想法为什么检查只返回之前的部分`fieldsets`而不是整个课程的来源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T10:47:17.170

**编辑：根据评论修改：**

`inspect.getsource(forms.ContactForm)`该方法内部`BlockFinder.tokeneater()`用于确定`ContactForm`块停止的位置。除此之外，它还会检查`tokenize.DEDENT`，它会在存储在 github 的版本中的字段集之前找到它。该行仅包含一个换行符，因此`inspect`认为当前块已结束。

如果你插入 4 个空格，它又对我有用。我无法争论这背后的理由，也许是性能。

```
class ContactForm(forms.Form):
    full_name = forms.CharField(max_length=120)
    email = forms.EmailField()
    website = forms.URLField()
    message = forms.CharField(max_length=500, widget=forms.Textarea)
    send_notification = forms.BooleanField(required=False)
    # <-- insert 4 spaces here
    fieldsets = ((u'Personal Information',
                {'fields': ('full_name', 'email', 'website'),
                'description': u'Your personal information will not ' \
                                u'be shared with 3rd parties.'}),
                (None,
                {'fields': ('message',),
                'description': u'All HTML will be stripped out.'}),
                (u'Preferences',
                {'fields': ('send_notification',)})) 
```

工作方式不同的原因`inspect.getsource(forms)`是因为`inspect`在这种情况下不必确定类定义的开始和结束。它只是输出整个文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T11:54:59.013

为我工作。我的代码中没有“from formfieldset.forms import FieldsetMixin”。也许这导致了一个问题..

# php - 生成的 Postgresql 进程可以由 spawner PHP 脚本控制吗？

> ID：929480
> 
> 赞同：1
> 
> 时间：2009-05-30T10:09:24.157
> 
> 标签：php, linux, postgresql, command-line, ubuntu

我有一个 PHP CLI 脚本，它处理一个 csv 文件，将它的内容插入到 Postgresql 数据库中的一个表中。这是在 Ubuntu 服务器上。我使用 schedtool 来控制整个脚本的亲和力。Schedtool 用于使用 -e 选项启动脚本本身。不幸的是，使用 htop 我看到数据库线程是作为一个完全不同的线程产生的，并且不受关联选项的影响。

是否有可能以某种方式使数据库进程从 spawner PHP 脚本继承所有亲和性选项？

* * *

我刚刚找到了答案——因为我正在阅读一些 Ruby 的 Postgresql 示例文件:)。

我最好的选择是使用 NOTIFY - LISTEN 获取运行当前脚本的 Postgresql 线程的非常精确的 PID。正如 [depesz] 所说，Postgres 仅使用 1 个核心。我仍然可以控制它在`schedtool`哪个核心上运行，并且`cpulimit`我可以进一步控制它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T10:40:43.923

不。

Postgres 后端总是从 postmaster 进程产生的，因此无法将关联（无论是什么）选项从 php 脚本传递到 postgres 后端。

另一方面-如果您要描述什么是亲和力，以及要设置/传递什么样的选项，也许有一个解决方案-没有通用解决方案的事实并不意味着没有一些事情的专门解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T19:56:16.077

Postgres 不使用线程。每个连接都由一个单线程进程处理。因此，单个连接只能使用一个核心。尽管操作系统可能会将其移动到不同的内核，但它一次只能使用一个。

如果您坚持使用 postgres，“SELECT pg_backend_pid()”将为您提供 postgres 进程的 PID，而无需任何 NOTIFY/LISTEN 内容。不过，一般来说，您不想尝试改进 postgres 进程。您可能会导致其他更高优先级的进程阻塞。那么你认为的低优先级进程不再是低优先级了。

如果您只是从 csv 中进行大量插入，那么对您的脚本进行微调可能不会有太大帮助。Postgres 可能正在做更多的工作，它可能是 IO，所以再一次，nicing 可能不会让你得到太多。但是，您可以偶尔睡觉。插入50毫秒，休眠一会，...

# iphone - 当我执行选择器InBackground: 时，为什么没有自动释放池？

> ID：929485
> 
> 赞同：5
> 
> 时间：2009-05-30T10:16:37.480
> 
> 标签：iphone, multithreading, cocoa-touch, uikit, autorelease

我正在调用一个进入后台线程的方法：

```
[self performSelectorInBackground:@selector(loadViewControllerWithIndex:) withObject:[NSNumber numberWithInt:viewControllerIndex]]; 
```

然后，我有这个由选择器调用的方法实现：

```
- (void) loadViewControllerWithIndex:(NSNumber *)indexNumberObj {
    NSAutoreleasePool *arPool = [[NSAutoreleasePool alloc] init];
    NSInteger vcIndex = [indexNumberObj intValue];

    Class c;
    UIViewController *controller = [viewControllers objectAtIndex:vcIndex];

    switch (vcIndex) {
        case 0:
            c = [MyFirstViewController class];
            break;
        case 1:
            c = [MySecondViewController class];
            break;
        default:
            NSLog(@"unknown index for loading view controller: %d", vcIndex); // error
            break;
    }

    if ((NSNull *)controller == [NSNull null]) {
        controller = [[c alloc] initWithNib];
        [viewControllers replaceObjectAtIndex:vcIndex withObject:controller];
        [controller release];
    }

    if (controller.view.superview == nil) {
        UIView *placeholderView = [viewControllerPlaceholderViews objectAtIndex:vcIndex];
        [placeholderView addSubview:controller.view];
    }

    [arPool release];
} 
```

尽管我确实为该线程创建了一个自动释放池，但我总是收到此错误：

```
2009-05-30 12:03:09.910 Demo[1827:3f03] *** _NSAutoreleaseNoPool(): Object 0x523e50 of class NSCFNumber autoreleased with no pool in place - just leaking
Stack: (0x95c83f0f 0x95b90442 0x28d3 0x2d42 0x95b96e0d 0x95b969b4 0x93a00155 0x93a00012) 
```

如果我拿走自动释放池，我会收到一大堆这样的消息。我还尝试围绕 performSelectorInBackground: 的调用创建一个自动释放池，但这无济于事。

我怀疑这个参数，但我不知道为什么编译器会抱怨一个 NSCFNumber。我错过了什么吗？

我的实例变量都是“非原子的”。这会是个问题吗？

更新：我可能还怀疑某些变量已添加到主线程的自动释放池中（可能是 ivar），现在它试图在错误的自动释放池中释放那个变量？如果是这样，我该如何解决？（该死，这个线程的东西很复杂；））

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T10:47:07.187

这很可能是因为泄漏的对象（NSNumber）是从线程外部传入的参数。因此，此变量属于调用线程（及其自动释放池）

线程调用周围的自动释放池不起作用的原因是线程创建者（performSelectorInbackground） - 立即返回，很可能在线程仍在运行时返回。

我建议您在将选择器的参数作为参数传入后对其进行释放。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-06-12T02:31:28.027

我同意这很可能是因为泄漏的对象（NSNumber）是从线程外部传入的参数。因此，此变量属于调用线程（及其自动释放池）

调用线程应该使用`NSAutoreleasePool` ，我建议您在参数中添加一条保留指令，如下所示：

```
- (void) loadViewControllerWithIndex:(NSNumber *)indexNumberObj {
    NSAutoreleasePool *arPool = [[NSAutoreleasePool alloc] init];
    [indexNumberObj retain];

    ....

    [arPool release];
  } 
```

# sql - sql服务器登录

> ID：929492
> 
> 赞同：1
> 
> 时间：2009-05-30T10:24:01.257
> 
> 标签：sql, login, nt

我正在编写一个使用集成安全性连接到数据库的 vb.net 应用程序。但是，我想实现一个登录屏幕，以便用户输入他们的 NT 用户名和密码以进行初始连接。这是因为我们的信息治理团队想要验证其他人没有在未经授权的情况下使用机器。通过尝试最初使用用户名和密码进行连接，我可以“验证”他们是谁，然后继续使用集成密码。

另外，我想创建数据库角色并将 NT 用户名分配给这些角色。如何将 nt 登录分配给数据库角色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T10:31:32.770

我建议您的“信息治理团队”需要提供解决方案，而不是像这样胡说八道。

贵公司是否有一个框架（例如单点登录）可以作为启动应用程序的正确方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T10:29:00.593

问题是那个人让他的终端解锁。完成此操作后，他可以在登录到您的应用程序后离开。

用蓬松的粉红色大象打治理团队的头。

* * *

您可以创建一个与 NT 帐户相关联的新数据库登录，例如：

```
CREATE LOGIN [domain\user] FROM WINDOWS 
    WITH DEFAULT_DATABASE=[YourDb], DEFAULT_LANGUAGE=[us_english] 
```

确保将登录作为用户添加到您的数据库中：

```
use YourDb
EXEC sp_grantdbaccess 'domain\user' 
```

您可以将登录名添加到以下角色：

```
EXEC sp_addrolemember 'YourRole', 'domain\user' 
```

当然，您也可以从 Sql Server Management Studio 执行此操作。单击安全性 -> 新建 -> 登录以开始使用。

# sql - 如何在 LINQ 中编写此查询？

> ID：929493
> 
> 赞同：0
> 
> 时间：2009-05-30T10:24:07.013
> 
> 标签：sql, linq

以下查询用于获取类别和每个类别的一个新闻。如何使用 LINQ 编写此查询

```
SELECT * FROM News n where n.NewsID IN 
(SELECT TOP 1 NewsID FROM News v
WHERE v.CategoryID = n.CategoryID 
ORDER BY CreatedOn DESC) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T10:32:45.280

未经测试，但尝试这样的事情：

```
using (var db = new YourDataContext())
{
   var results = from n in db.News 
                 let v = db.News
                 where n.NewsId == v.Where(c=>c.CategoryId == n.CategoryId)
                    .OrderByDescending(o=>o.CreatedOn).First()
                 select n;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T10:39:30.213

```
var q = from n in dc.News
        group n by n.CategoryId into g
        let ti = g.OrderByDescending(x => x.CreatedOn).FirstOrDefault()
        where ti != null
        select ti; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T10:39:44.610

这是在VB中：

```
Using db = New YourDataContext()
   Dim results = From n In db.News _
       Let v = db.News _
       Where n.NewsId = v.Where(Function(c) c.CategoryId = n.CategoryId).OrderByDescending(Function(o) o.CreatedOn).First() _
       Select n
End Using 
```

转换为： http: [//www.developerfusion.com/tools/convert/csharp-to-vb/](http://www.developerfusion.com/tools/convert/csharp-to-vb/)

# c++ - 为什么 MinGW 很慢？

> ID：929495
> 
> 赞同：33
> 
> 时间：2009-05-30T10:25:29.337
> 
> 标签：c++, performance, mingw, codeblocks

我在 Windows 上使用带有 GCC/MinGW 的 Code::Blocks IDE，并且我正在尝试构建一个 wxWidgets 应用程序，该应用程序具有 ca. 20k 行和 40 个源模块。它的构建非常非常缓慢。

编译一个 C++ 模块需要 2-5 秒，链接甚至需要 2-3 分钟。

这是一个可移植的代码，而且这个代码在 Linux 上编译得非常快。我无法跟随构建消息窗口...整个过程持续不到 20 秒。

我尝试了常见的调整（例如，预编译头文件、关闭优化等），但没有任何效果。

为什么这么慢？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-12-08T16:43:23.727

您是否在 Active Directory 域中，但没有立即连接到它？

虽然我没有关于为什么 MinGW 会变慢的“答案”，但根据我的经验，属于 AD 域但无法访问 AD 控制器的计算机在启动可执行文件时会出现延迟（例如rxvt.exe）和当前正在运行的程序会遇到暂停或卡顿（例如使用 MinGW 构建的 emacs）。

我仍在调查以确定这种行为的实际**原因**，但我想我会提到它以防它适用于你。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2017-05-07T10:08:16.677

从 开始`MSYS 1.0.19-1`，如果用户帐户位于 Active Directory 域中并且无法访问域控制器 (DC)，则`MSYS DLL`在启动任何 MSYS 可执行文件（使用`MSYS DLL`）之前将引入很长的延迟。这会影响 MSYS和 CoreUtils 包中的`make`所有命令行实用程序，例如通常安装在.`ls``rm``C:\MinGW\msys\1.0\bin`

观察：

*   从 MSYS `bash`shell 启动实用程序时，只有 shell 的启动会受到延迟。从 shell 启动的实用程序不受影响。

*   延迟可能会有所不同，在我的情况下是 21 秒。

*   在延迟命令后的 10-20 秒内运行任何 MSYS 实用程序将启动，不会出现新的延迟。
*   当机器连接到不同的网络，或者从其域断开连接，或者域控制器主机名更改时（在我的情况下是问题），就会出现问题。要检查 DC 是否可访问，请打开`cmd`并键入`echo %LOGONSERVER%`，然后`ping`或`net view`使用 DC 的主机名。

为什么这么慢：

*   `MSYS DLL`in的代码进行了`uinfo.cc internal_getlogin()`两次系统调用来获取用户信息。第一次调用`NetUserGetInfo()`以从本地计算机检索用户帐户。它对域用户失败，因此它第二次调用它，DC 服务器取自`LOGONSERVER`变量。如果无法立即访问此主机，则会引入很长的延迟，直到调用超时失败。该应用程序将在不久后启动。

如何避免这个问题，几种解决方法：

*   从 MSYS shell 运行所有内容，或者
*   如果原因是 DC 主机名更改，则重新启动或重新登录将解决问题。`LOGONSERVER`Windows 将使用正确的 DC 主机自动更新。
*   `cmd`如果从 Windows或脚本 调用 MSYS 工具，则设置`LOGONSERVER`为 localhost 以避免网络访问。例如`set LOGONSERVER=\\LOCALHOST`为我工作。`cmd`注意：此变量在登录时设置，并且在 Windows 环境变量窗口中全局更改它与在脚本中设置它相比没有效果。
*   我认为这是 MinGW/MSYS 中的一个错误。MSYS2 和 Cygwin 中的代码是不同的。我检查了 MSYS2 并没有这样的问题。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2015-04-21T08:18:31.303

MinGW 上的许多“unixy”东西都非常缓慢，因为 Windows 没有`fork()`. Windows 只有`CreateProcess()`，这是完全不同的。Unix shell 和 GNU Make 做了很多分叉，所以在 MinGW 下运行这些会导致“模拟”分叉，这真的很慢。

受此影响的另一件事是 GNU Autotools，因此`./configure`在从源代码构建“unixy”应用程序时运行脚本也非常慢。如果您需要多次执行此操作（例如在获取*配置*以查找所有库时遇到问题时），这可能会变得非常烦人。

[这个答案](https://stackoverflow.com/a/985374/1717300)更详细地解释了 Cygwin 和 MinGW**是**如何模拟`fork()`的，[这个答案](https://stackoverflow.com/a/985525/1717300)有更多最新的解释。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-12-08T17:20:36.787

您可以尝试使用更新版本的工具集。我发现这很有用：http: [//nuwen.net/mingw.html](http://nuwen.net/mingw.html) 它在一个大包中包含了 MinGW 使用的所有工具和常用 API。从网站：

> 我的 MinGW 发行版（“发行版”）是 x64-native，目前包含 GCC 6.1.0 和 Boost 1.61.0。
> 
> MinGW 是 GCC 到 Windows 的一个端口。它是免费的且易于使用（嗯，就像工具链一样简单）。它生成可以以任何方式分发的独立 Windows 可执行文件。

# php - 词袋模型：2 个 PHP 函数，结果相同：为什么？

> ID：929505
> 
> 赞同：4
> 
> 时间：2009-05-30T10:33:19.913
> 
> 标签：php, function

我有两个 PHP 函数来计算两个文本之间的关系。他们都使用词袋模型，但 check2() 更快。无论如何，这两个函数都给出了相同的结果。为什么？check1() 使用一个包含所有单词的大字典数组 - 如词袋模型中所述。check2() 不使用一个大数组，而是一个只包含一个文本单词的数组。所以 check2() 不应该工作，但它没有。为什么两个函数给出相同的结果？

```
function check1($terms_in_article1, $terms_in_article2) {
    global $zeit_check1;
    $zeit_s = microtime(TRUE);
    $length1 = count($terms_in_article1); // number of words
    $length2 = count($terms_in_article2); // number of words
    $all_terms = array_merge($terms_in_article1, $terms_in_article2);
    $all_terms = array_unique($all_terms);
    foreach ($all_terms as $all_termsa) {
        $term_vector1[$all_termsa] = 0;
        $term_vector2[$all_termsa] = 0;
    }
    foreach ($terms_in_article1 as $terms_in_article1a) {
        $term_vector1[$terms_in_article1a]++;
    }
    foreach ($terms_in_article2 as $terms_in_article2a) {
        $term_vector2[$terms_in_article2a]++;
    }
    $score = 0;
    foreach ($all_terms as $all_termsa) {
        $score += $term_vector1[$all_termsa]*$term_vector2[$all_termsa];
    }
    $score = $score/($length1*$length2);
    $score *= 500; // for better readability
    $zeit_e = microtime(TRUE);
    $zeit_check1 += ($zeit_e-$zeit_s);
    return $score;
}
function check2($terms_in_article1, $terms_in_article2) {
    global $zeit_check2;
    $zeit_s = microtime(TRUE);
    $length1 = count($terms_in_article1); // number of words
    $length2 = count($terms_in_article2); // number of words
    $score_table = array();
    foreach($terms_in_article1 as $term){
        if(!isset($score_table[$term])) $score_table[$term] = 0;
        $score_table[$term] += 1;
    }
    $score_table2 = array();
    foreach($terms_in_article2 as $term){
        if(isset($score_table[$term])){
            if(!isset($score_table2[$term])) $score_table2[$term] = 0;
            $score_table2[$term] += 1;
        }
    }
    $score = 0;
    foreach($score_table2 as $key => $entry){
        $score += $score_table[$key] * $entry;
    }
    $score = $score/($length1*$length2);
    $score *= 500;
    $zeit_e = microtime(TRUE);
    $zeit_check2 += ($zeit_e-$zeit_s);
    return $score;
} 
```

我希望你能帮助我。提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T18:16:33.977

由于您似乎关心性能，这是您的 check2 函数中算法的优化版本，它使用更多内置函数来提高速度。

```
function check ($terms1, $terms2)
{
    $counts1 = array_count_values($terms1);
    $totalScore = 0;
    foreach ($terms2 as $term) {
        if (isset($counts1[$term])) $totalScore += $counts1[$term];
    }
    return $totalScore * 500 / (count($terms1) * count($terms2));
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T15:55:49.757

这两个函数都实现了几乎相同的算法，但是第一个以直接的方式执行，第二个更聪明一些，并且跳过了一部分不必要的工作。

check1 是这样的：

```
// loop length(words1) times
for each word in words1:
    freq1[word]++

// loop length(words2) times
for each word in words2:
    freq2[word]++

// loop length(union(words1, words2)) times
for each word in union(words1, words2):
    score += freq1[word] * freq2[word] 
```

但请记住：当您将某物与零相乘时，您将得到零。

这意味着，计算不在两组中的单词的频率是浪费时间 - 我们将频率乘以零，这不会增加分数。

check2 考虑到这一点：

```
// loop length(words1) times
for each word in words1:
    freq1[word]++

// loop length(words2) times
for each word in words2:
    if freq1[word] > 0:
        freq2[word]++

// loop length(intersection(words1, words2)) times
for each word in freq2:
    score += freq1[word] * freq2[word] 
```

# .net - 发票打印输出

> ID：929506
> 
> 赞同：0
> 
> 时间：2009-05-30T10:34:49.737
> 
> 标签：.net, printing

我正在.net 中开发一个应用程序。我想进行所有计算，然后在公司的给定页面上打印所选项目的所有信息，然后打印该页面并保存同一页面在 DB 中并通过 .pdf 格式的电子邮件将发票发送给客户。请建议。？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-02T18:14:52.163

不确定这是否为时已晚，但这个网站[Simpeli](https://simpe.li)有一些不错的模板可供选择，用于生成好看的 PDF。

您使用非常简单的 API 调用制作 PDF。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T10:47:34.003

如果您可以在报告生成器工具上花一些钱，请查看 DevExpress 的 Xtra 报告：[链接](http://www.devexpress.com/Products/NET/Reporting/)。这可以导出为pdf。然后我会获取生成的文件并将其（或对它的引用）存储在数据库中。对于实际发送邮件，您可以使用 System.Net.Mail 中的 MailMessage-Class

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T10:51:04.043

我会生成和存储 XML 并将 XSLT 转换为 PDF、HTML 等...考虑[上一篇文章](https://stackoverflow.com/questions/210222/converting-between-document-formats-in-c)。

'c# xml xslt pdf' 的快速谷歌，给了我[这个](http://www.codelathe.com/blog/index.php/2009/02/28/generate-pdf-from-cnet/)可能有帮助的链接。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T10:51:38.627

您可以使用[RDLC](http://msdn.microsoft.com/en-us/library/ms155062.aspx)来定义报告。它可以将其导出为 PDF/Excel。您可以将报告导出为 pdf 并将其附加到使用 System.Net.Mail.MailMessage 类发送电子邮件。您还可以使用报告查看器工具打印报告。

或者，您也可以使用与 Visual Studio 捆绑的 Crystal Reports。

# version-control - Mercurial 与多个项目

> ID：929508
> 
> 赞同：32
> 
> 时间：2009-05-30T10:35:06.460
> 
> 标签：version-control, mercurial, dvcs, repository-design

我的 SVN 存储库中有几个具有不同发布周期的项目。版本是使用 SVN 中的经典标签结构创建的。当版本中存在要修复的错误时，会从标签创建分支，修复错误，然后从那里合并到主干中。

现在，出于多种原因，我想通过中央推送站点从 SVN 切换到 mercurial。

问题：在 mercurial 中，组织多个项目之间共享少量代码的最佳方式是什么？我应该为每个项目创建多个推送站点吗？

请在答案中包含有关如何使用您首选的存储库设计版本重新创建我的发布标签、错误修复分支的描述。

编辑：我想安装尽可能少的扩展。

编辑2：

鉴于此 SVN 布局：

```
.
|-- project-a
|   |-- branches
|   |   |-- 1.x
|   |   `-- feature-1
|   |-- tags
|   `-- trunk
`-- project-b
    |-- branches
    |-- tags
    |   |-- 1.0
    |   `-- 1.1
    `-- trunk 
```

（感谢@bendin！:)）

使用多个 hg 推送存储库会更好吗

```
project_a-trunk
project_a-1.x
project_a-feature-1
project_b-trunk 
```

为树枝。标签被折叠到适当的分支中。

或者您更愿意在本例中使用两个推送存储库

```
project_a
project_b 
```

具有命名的分支，因此在一个 repo 中有多个头。

我看到的多头存储库的优势是我不必在多个存储库中寻找标签。我看到的缺点是 hg 书似乎不鼓励多头回购。你会/做什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-30T10:59:57.393

一些颠覆存储库会将逻辑上不相关的东西（即具有不同版本号和发布周期的项目）分组到一个主干下：

```
.
|-- branches
|   |-- project-a-1.x
|   `-- project-a-feature-1
|-- tags
|   |-- project-a-1.0
|   |-- project-b-1.0
|   `-- project-b-1.1
`-- trunk
    |-- project-a
    `-- project-b 
```

这种布局在 Mercurial 中没有直接的模拟。每个有自己的发布周期和自己的版本号的项目都应该有自己的存储库。

一些颠覆存储库的结构是通过为每个项目提供自己的主干、标签和分支来做到这一点：

```
.
|-- project-a
|   |-- branches
|   |   |-- 1.x
|   |   `-- feature-1
|   |-- tags
|   `-- trunk
`-- project-b
    |-- branches
    |-- tags
    |   |-- 1.0
    |   `-- 1.1
    `-- trunk 
```

您可以将每个项目视为物理 subversion 存储库中的一个逻辑存储库。每个项目都有自己的主干、标签和分支。这还有一个好处是您可以缩短标签和分支名称，因为您已经知道它们属于哪个项目。

这种布局也很容易用像 mercurial 这样的工具来表达。每个“项目”都成为一个反复无常的存储库。该存储库中的标签和分支是该项目的标签和分支。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-30T15:19:42.580

正如bendin 所说，您应该创建多个存储库，每个独立项目一个存储库作为开始。

Mercurial 提交是在存储库范围内进行的，您不能只签出单个子目录。这与 Subversion 不同，它允许您通过仅提交一些文件来进行不一致的提交，但它也允许您仅签出单个子目录。

当您发布一个版本时，您通常会向 Mercurial 存储库 ( `hg tag`) 添加一个标签。您可以自由决定是否要为每个版本保留一个错误修复存储库，或者是否要在第一次需要时创建它们。诀窍是

```
% hg 克隆 -r 1.0 项目-a 项目-a-1.0.x

```

可用于创建`project-a-1.0.x`仅包含标签的历史记录的存储库`1.0`。然后，您可以修复错误`project-a-1.0.x`并将其推回`project-a`. 可以在`project-a-1.0.x`存储库中进行进一步的错误修复。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T10:49:48.647

我认为您想尝试[mercurial 森林扩展](http://www.selenic.com/mercurial/wiki/ForestExtension)

# ruby-on-rails - 在 Rails 中测试清除 cookie 值？

> ID：929515
> 
> 赞同：3
> 
> 时间：2009-05-30T10:41:33.233
> 
> 标签：ruby-on-rails, cookies, tdd

如何在功能测试中发送 cookie？如何测试以确保清除 cookie？

我使用 TDD 为 Rails 应用程序构建模型取得了巨大成功，但在控制器测试方面遇到了障碍：我可以在测试中设置一次 cookie 值并读取它们，但我无法清除它们。那是：

```
test "clears cookie" do
  get :set_it, :stuff => {'key' => 'value'} # stuff to cookify
  assert cookies['key'] == 'value' # works fine

  get :clear_it # cookie doesn't get sent. How do I simulate this?
  assert nil == cookies['key'], 'Cookie not cleared' # fails
end 
```

rails testing guide没有提到如何在测试中模拟cookie的发送，只是如何验证数据是否设置在服务器上。我知道我之前遇到过这样一种情况，即在发送响应之前，服务器上的 cookie 数据不会被更改。这就是这里发生的事情吗？我有点希望功能测试在“成为客户”方面做得更好。

这是一个广为人知的问题吗？人们只是放弃使用 JUnit 来做这种事情吗？我真的很想能够为我的*全部或几乎全部*tdd 使用一个框架。

* * *

纯粹的绝望和猜测让我乐观地尝试了@response.cookies，但这也没有奏效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-11-08T19:06:37.640

如果您想专门围绕取消设置 cookie 进行单元测试，那么您实际上是在测试响应是否包含将 cookie 设置为空的标头。我假设你`get :clear_it`正在做`cookies.delete :cookie-name` 。这会将 response.header 设置为包含`Set-[COOKIE-NAME]=;`. 因此，如果其他方法失败，您可以直接查找该字符串。

在您的代码中看起来可疑的是您只是在`cookies`直接检查。您的“获取”请求的响应在哪里？

如果一切都失败了，您还可以使用 webrat 的集成测试，如此处[所述](https://stackoverflow.com/questions/681183/how-to-handle-cookies-when-testing-with-webrat)。这可能不如单元测试那么好，但它至少会检查功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T03:02:09.687

我的注销测试有

```
assert_nil @response.cookies["auth_token"] 
```

哪个有效。

如果不是零，你会得到什么价值？

# java - Eclipse PDT (3.4) 在加载时冻结（Ubuntu 8.04、Sun Java 1.6）

> ID：929516
> 
> 赞同：0
> 
> 时间：2009-05-30T10:43:06.070
> 
> 标签：java, eclipse, ubuntu

我正在尝试使用 Sun Java 1.6 在 Ubuntu 8.04 上运行 Eclipse PDT。工作台屏幕加载了一段时间并冻结，然后我得到一个`.SWTError: XPCOM error -2147467262`。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T10:51:59.237

您可以尝试使用 -clean 标签启动 eclipse。这可能会解决它。查看以下内容：

[http://www.eclipsezone.com/eclipse/forums/t61566.html](http://www.eclipsezone.com/eclipse/forums/t61566.html)

或者，您可以删除工作区文件夹中存在的 .snap 文件。请注意，这将导致工作区状态丢失，但您可以通过重新导入项目、再次设置视角等来恢复......这确实是最后的手段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T11:43:47.867

我发现 Eclipse 不能与 Ubuntu 附带的 JVM 一起工作。尝试下载 Sun JVM 并将 eclipse 更改为启动，并将 -vm 标志设置为 sun JVM 的路径。

编辑：对不起，我现在看到你有 sun JVM，你需要启动 Eclipse 并设置 -vm 标志。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T14:42:02.047

仔细检查您的 Firefox/XulRunner 安装。

# mapping - 创建具有多个输入架构的 BizTalk 映射

> ID：929518
> 
> 赞同：9
> 
> 时间：2009-05-30T10:45:49.153
> 
> 标签：mapping, biztalk

无论如何“从头开始”创建具有多个输入架构的 BizTalk 映射？
即不创建编排和变换形状并在源中选择多个消息

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-01T13:24:53.160

不，没有办法在 Visual Studio 中为 BizTalk 2006、2009 或 2013（感谢@Krishan 的澄清）创建多模式输入映射，而无需通过编排/转换形状路线。唯一的其他选择是在文本编辑器中或从模板中手动编写地图。

请记住，使用 Orchestration/Transform 解决方案，您可以在使用 Orchestration 创建地图后将其丢弃。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-10-26T12:42:29.487

为清楚起见，我将概述使用 Visual Studio 创建多输入模式映射的过程：

*   创建一个空的编排。
*   创建您需要的所有消息类型（所有输入消息和输出消息）
*   将构造消息形状和变换形状拖到那里。
*   配置变换形状并将所有输入消息添加到变换源列表

![多源变换](https://i.stack.imgur.com/QZ3TP.png)

*   像往常一样设置输出消息，然后单击确定
*   地图文件应该出现在您的项目中。打开它
*   您将在左侧看到您输入的所有消息现在都可以在映射器中使用（在 Root/InputMessagePart_1、_2 等下）

![多输入映射器](https://i.stack.imgur.com/JzMmD.png)

然后，您可以根据需要重命名/移动地图。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-12-20T22:10:02.533

以防万一有人仍然需要这个，这里有一个你可以使用的模板。

[http://fabiomarini.wordpress.com/2011/12/20/multipart-map-template/](http://fabiomarini.wordpress.com/2011/12/20/multipart-map-template/)

# javascript - 使用 jQuery 动态排列 div

> ID：929519
> 
> 赞同：9
> 
> 时间：2009-05-30T10:46:15.270
> 
> 标签：javascript, jquery

我有以下结构：

```
<div id="container">
<div id="someid1" style="float:right"></div>
<div id="someid2" style="float:right"></div>
<div id="someid3" style="float:right"></div>
<div id="someid4" style="float:right"></div>
</div> 
```

现在 someid 实际上是该 div 的唯一 ID。现在我收到一个具有不同顺序的数组，比如 someid 3、2、1、4，那么我如何移动这些 div 以匹配使用 jQuery 的新顺序？

非常感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-30T11:51:00.583

我的插件版本 -**[工作演示](http://jsbin.com/ihuqo)**

获取一个数组和可选的 id 前缀，并对 id 对应于数组内 (id 前缀) + 值的顺序的元素进行重新排序。数组中没有对应 id 的元素的任何值都将被忽略，并且数组中没有 id 的任何子元素都将被删除。

```
(function($) {

$.fn.reOrder = function(array, prefix) {
  return this.each(function() {
    prefix = prefix || "";

    if (array) {    
      for(var i=0; i < array.length; i++) 
        array[i] = $('#' + prefix + array[i]);

      $(this).empty();  

      for(var i=0; i < array.length; i++)
        $(this).append(array[i]);      
    }
  });    
}
})(jQuery); 
```

演示中的代码

**jQuery**

```
 $(function() {
  $('#go').click(function() {

    var order = $('#order').val() == ""? null: $('#order').val().split(",");
    $('#container').reOrder(order, 'someid');
  });
});

(function($) {

$.fn.reOrder = function(array, prefix) {
  return this.each(function() {
    prefix = prefix || "";

    if (array) {    
      for(var i=0; i < array.length; i++) 
        array[i] = $('#' + prefix + array[i]);

      $(this).empty();  

      for(var i=0; i < array.length; i++)
        $(this).append(array[i]);      
    }
  });    
}
})(jQuery); 
```

**HTML**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<title>reOrder Demo</title>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<style type="text/css" media="screen">
body { background-color: #fff; font: 16px Helvetica, Arial; color: #000; }
div.style { width: 200px; height: 100px; border: 1px solid #000000; margin: 5px; }
</style>
</head>
<body>
<div id="container">
<div id="someid1" class="style" style="background-color:green;">div1</div>
<div id="someid2" class="style" style="background-color:blue;">div2</div>
<div id="someid3" class="style" style="background-color:red;">div3</div>
<div id="someid4" class="style" style="background-color:purple;">div4</div>
</div>
<p>Pass in a comma separated list of numbers 1-4 to reorder divs</p>
<input id="order" type="text" />
<input id="go" type="button" value="Re-Order" />

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T11:00:52.820

[编辑]，这是经过测试并且有效的：

```
var order = [3,2,1,4];
var container = $("#container");
var children = container.children();
container.empty();
for (var i = 0; i < order.length; i++){
    container.append(children[order[i]-1])
} 
```

i-1 是必要的，因为您的排序从 1 开始，但数组从 0 开始索引。

感谢 JP 和 Russ Cam 让我再看一遍。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T12:00:10.173

这是一个无 jQuery 的解决方案：

```
function appendNodesById(parent, ids) {
    for(var i = 0, len = ids.length; i < len; ++i)
        parent.appendChild(document.getElementById(ids[i]));
}

appendNodesById(document.getElementById('container'),
    ['someid4', 'someid2', 'someid3', 'someid1']); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T10:58:56.523

如果数组中有所有内容，则从代码中的包装 div*容器*中删除所有内容。然后开始一一添加收到的div：

```
 var v = $(ar[0]).append(ar[1]).append(ar[2]);
 $("#container").html(v); 
```

如果这不起作用，请查看讨论关于相对于其他元素定位元素的[线程。](https://stackoverflow.com/questions/158070/jquery-how-to-position-one-element-relative-to-another)

# java - 想在jsp页面上添加动态内容

> ID：929520
> 
> 赞同：1
> 
> 时间：2009-05-30T10:46:29.653
> 
> 标签：java, ajax, jsp, struts2

我在前端的设计页面中使用 Struts2 标签。

现在我有一个要求，在我的 jsp 页面中，我已经放置了 3 个简单的字段并在一些添加链接上，我想在同一表单中动态地重复一些另外的 3 或 4 个字段。

例如，如果用户在添加链接上单击 5 次，那么 3 或 4 字段必须在 jsp 页面上显示 5 次。

我知道 ajax 可以用于此目的。但我仍然对如何实现它感到困惑。

如果有人有解决方案，请回复...

提前谢谢....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-01T03:47:06.207

您最好的方法是使用[jquery](http://docs.jquery.com/Downloading_jQuery)来简化 javascript。这个简单的 html 页面演示了该方法：

```
<html>
  <head>
    <script type="text/javascript" src="js/jquery-1.3.2.min.js"/>
  </head>
  <body>
    <form method="post" action="#">
      <table>
        <tbody> 
          <tr>
            <td><input type="text" name="fieldname"/></td>
            <td><a href="#" onclick="$(this).closest('tr:not(:only-child)').remove();return false;">delete</a></td>
          </tr>
          <tr>
            <td><input type="text" name="fieldname"/></td>
            <td><a href="#" onclick="$(this).closest('tr:not(:only-child)').remove();return false;">delete</a></td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <td></td>
            <td><a href="#" onclick="var tr = $(this).closest('table').find('tbody tr:first-child').clone(true); $(tr).find(':input').val(''); $(this).closest('table').find('tbody').append(tr); return false;">add</a>
            </td>
          </tr>
        </tfoot>    
      </table>
    </form>
  </body>
</html> 
```

这是该方法的简要介绍。每个重复元素都是表中行的一部分。您可以选择任何其他类型的容器来相应地调整 jquery。重复元素在每行的 tbody 内，有一个输入和一个删除该行的链接。请注意，只有当它不是 tbody 的唯一子级时，它才会删除该行。我们需要这样才能始终有办法从添加链接添加新元素。添加逻辑在 tfoot 中。添加链接在相应的 tbody 中找到第一个表行，将其克隆，清除任何输入字段中的所有值并将其作为新行附加到 tbody。

像我在本例中所做的那样，将这么多的 javascript/jquery 嵌入到属性中并不是一个好习惯。

# jquery - 如何将效果应用于 jQuery 数组中检索到的元素？

> ID：929527
> 
> 赞同：0
> 
> 时间：2009-05-30T10:48:23.720
> 
> 标签：jquery, arrays, effects

我想知道是否可以将效果应用于数组中的检索元素。

我知道我可以通过: 输出数组的内容。`text()`或`.html()`jQuery 中的函数。但我一直在尝试`fadeIn()`内容，它永远不会奏效。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T10:55:32.520

您必须先将对象添加到 DOM 中，然后才能对其进行显示和使用效果。

例如：

```
content.appendTo('#somedivid').hide().fadeIn(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T10:59:20.857

您必须将其附加到 dom，将其隐藏，然后将其淡入：

```
for(i=0, x=content.length; i<x; i++){      
   $('<p />').text(content[i]).appendTo('#container').hide().fadeIn();
} 
```

假设内容是您要添加到#container 的文本数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T11:06:07.443

如果数组中的每个元素都包含一个与页面布局上的元素相关联的 id，您可以执行以下操作：

```
$('#'+content[i].id).fadeIn(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T11:15:45.397

我不确定我是否正确理解了这个问题，但它与您提到的 text() 或 html() 函数的工作方式相同：

```
var elements = $('.test');
// elements is an array of all elements with class 'test'

// now fade all these elements out:
elements.fadeOut('slow'); 
```

# php - 我应该使用什么开发记事本？

> ID：929535
> 
> 赞同：3
> 
> 时间：2009-05-30T10:53:43.960
> 
> 标签：php, macos, notepad

我需要一个好的（免费）开发记事本的建议，以便在我的新 macbook 上工作，主要用于 PHP、AJAX 等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T10:57:48.070

[TextWrangler](http://www.barebones.com/products/TextWrangler/)是一款免费的 Mac 文本编辑器，内置 PHP 支持。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T14:27:29.550

我知道你已经要求它是免费的 - 但真的，我不能对 TextMate 施加足够的压力。这太棒了，而且也很便宜（大约 30 美元）。这是非常值得的价格标签。

如果您坚持保持免费 - 请尝试使用 PDT 的 Eclipse。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T10:56:18.510

如果您熟悉 vim，或者有时间学习一个相当复杂的文本编辑器，我建议您查看[macvim](http://code.google.com/p/macvim/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T10:56:36.700

[Vim](http://vim.org)是用于编写 Web 代码的出色文本编辑器。它有一个陡峭的学习曲线，但几乎适用于所有平台。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-30T16:45:09.833

我还建议尝试[Smultron](http://tuppis.com/smultron/)。它非常轻巧，但它是一个非常好的（免费）编辑器。当然，它还支持 PHP、JavaScript 和所有内置的主要 Web 编程语言。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-30T12:49:29.607

Emacs 如果你喜欢定制到宇宙的尽头。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-30T11:02:17.030

还有用于 Emacs 风格的 Mac 编辑体验的[Aquamacs](http://aquamacs.org/)和[Carbon Emacs 。](http://homepage.mac.com/zenitani/emacs-e.html)Carbon Emacs 更接近于 Unix Emacs 的体验，而 Aquamacs 人则在 OS X 集成上投入了大量精力。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-30T11:11:34.423

Geany (geany.org) 是我选择的 IDE。它是轻量级的、开源的，我将它用于编程和记笔记。它支持 PHP、C、Python 等。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-30T15:26:33.707

您可能需要考虑[Aptana](http://www.aptana.com/)。它支持 PHP 和主要的 AJAX 库。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-31T02:02:07.413

我也建议 Komodo Studio

# css - 所有关于为网站选择正确的字体

> ID：929537
> 
> 赞同：18
> 
> 时间：2009-05-30T10:54:33.677
> 
> 标签：css, fonts

我现在实际上有两个问题：

1) 网站首选哪些字体？现在我真的很喜欢“Segoe UI”，但它只适用于最新的 Windows 系统，如 Vista 和 2008 Server。所以我定义了一个序列：

```
font-family: 'Segoe UI', Tahoma, Arial, Helvetica, Sans-Serif; 
```

除了“Segoe UI”之外，我不太喜欢它们的外观。除此之外，还有什么好的字体可以使用的建议吗？我还尝试了“Trebuchet MS”，它在文档上看起来很棒，但在页面上却不是。

2) 有什么方法可以用 CSS 为每个特定的字体系列指定不同的字体大小？像“Segoe UI - 9px”、Tahoma - 8px 等。这可能是不可能的，但也许有一些技巧？

我也知道我现在会收到很多评论来使用相对字体大小，但我不希望那样。我的设计中有一些不可拉伸的图形。如果用户或浏览器默认导致字体以不同的大小呈现，则设计很快就会分崩离析。我更喜欢有字体大小限制的设计，而不是根本没有设计。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-30T10:59:19.347

**1) 网站首选哪些字体？**

请参阅有关[安全网络字体](http://web.mit.edu/jmorzins/www/fonts.html)的此页面。

**2) 有什么方法可以通过 CSS 为每个特定的字体系列指定不同的字体大小？**

没有。

很快，`@font-face`所有主要浏览器都将支持它，您将能够在您的网站上使用您想要的任何字体。

在那之前，看看[Cufón](http://wiki.github.com/sorccu/cufon/about)或[sIFR](http://www.mikeindustries.com/blog/sifr/)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-31T11:04:42.650

为您的网站使用正确的字体。这不是说“这是网站最好的字体”那么简单。[以下是罗伯特·布林赫斯特 (Robert Bringhurst) 的“印刷风格元素”](https://rads.stackoverflow.com/amzn/click/com/0881791326)中的两句引述（阅读原则）：

*   “排版的存在是为了尊重内容。”
*   “选择适合任务和主题的面孔。”

另一方面，除非衬线字体真的适合网站，否则无衬线字体更适合数字媒体。

关于您的第二点，Phil Oye 最近发布了[FontUnstack](http://github.com/philoye/fontunstack/tree/master)，这是一个 jQuery 插件，可以告诉您给定元素使用的字体。该元素将被赋予一个类（即“ `set_in_gill_sans`”），您可以通过它为不同的字体应用特定的样式。

另外，查看[字体矩阵](http://media.24ways.org/2007/17/fontmatrix.html)（1.5 岁）和这些经过深思熟虑的[font-stacks](http://unitinteractive.com/blog/2008/06/26/better-css-font-stacks/)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-30T11:12:09.490

> *1) 网站首选哪些字体？现在我真的很喜欢“Segoe UI”，但它只适用于最新的 Windows 系统，如 Vista 和 2008 Server。所以我定义了一个序列：font-family: 'Segoe UI', Tahoma, Arial, Helvetica, Sans-Serif; 除了“Segoe UI”之外，我不太喜欢它们的外观。除此之外，还有什么好的字体可以使用的建议吗？我还尝试了“Trebuchet MS”，它在文档上看起来很棒，但在页面上却不是。*

首选哪些字体？这是一个棘手的问题。有三个主要的计算平台，每个平台都有自己的一组基本字体。然后，一些软件，如 Adob​​e Creative Suite、Microsoft Office 套件，甚至像 XP 的 Powerpoint 2007 查看器这样简单的软件都会为用户安装字体。网上有很多图表列出了[常用字体](http://www.codestyle.org/css/font-family/sampler-CombinedResults.shtml)。

对于一个网站，你会想要使用清晰的字体。网络上常用的大多数屏幕字体都非​​常清晰。例如，您提到的字体就是很好的例子。屏幕上最清晰的字体是 Verdana，尽管它通常被认为是丑陋的。Arial 始终是一个安全的选择。

不过，请注意 Segoe UI 声明：如果 Windows XP 用户使用该字体，则在禁用抗锯齿的情况下可能无法辨认。

对于标题，您可以自定义并使用 sIFR 和 Cufon 等技术将文本替换为非本地系统字体。

关于大小的快速说明：大多数网站倾向于设置非常小的字体大小。13 像素确实是长文本的最小值（请参阅[相对可读性](http://www.wilsonminer.com/posts/2008/oct/20/relative-readability/)）。像 Times 这样的 x 高度较小的字体只能用于标题或足够大的尺寸（例如 15+ 像素）。

> *2) 有什么方法可以用 CSS 为每个特定的字体系列指定不同的字体大小？像“Segoe UI - 9px”、Tahoma - 8px 等。这可能是不可能的，但也许有一些技巧？*

不，这是不可能的。您可以对人们通过 Javascript 运行的浏览器和操作系统做出假设，从而对他们安装的字体做出假设，但是为了获得相对较小的收益，这需要做很多工作。我建议不要这样做。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-30T11:03:27.060

关于。你的字体选择，我会认为可用性是一个关键要求（除非你想要一种故意设计的格式）。

[Neilson](http://en.wikipedia.org/wiki/Jakob_Nielsen_%28usability_consultant%29)进行了一项[研究](http://easi.cc/podcasts/conference/auburn.htm)，发现 Verdana 或 Arial 在易读性方面是最佳选择。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-30T11:38:49.670

CSS3 将原生支持可下载字体（您不会被提示下载，它们只会在运行中运行），因此您将能够使用您想要的任何字体。我们只需要等待它，但因为它仅在 Firefox 3.5 和 Opera 10 中可用。

您还可以使用经典字体，例如：Arial/Helvetica、Verdana、Georgia，甚至 Times Roman，以获得出色的视觉效果。您只需要找到正确的字体大小并与页面上的其他元素进行对比。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-31T23:51:33.520

就个人而言，我喜欢 Verdana 和 Georgia，尽管它们只是 Mac/Windows-“安全”的。在您的情况下，最好选择与您的首选具有相同指标的第二选择字体。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-01-17T00:27:17.427

大多数主流浏览器已经支持`@font-face`，因此您可以使用任何**公开可用的字体**。
[Google Web Fonts](http://google.com/webfonts)提供一些免费字体供您选择：

![谷歌网络字体](https://i.stack.imgur.com/TOPPF.png)

还有一些付费网站，例如[Typekit](https://typekit.com)，会为您托管**付费字体**并让您购买：

![在此处输入图像描述](https://i.stack.imgur.com/lFrO6.png)

# language-agnostic - 如何衡量代码库的百分比差异？

> ID：929552
> 
> 赞同：2
> 
> 时间：2009-05-30T11:04:39.380
> 
> 标签：language-agnostic, diff

手头的任务——我有一些代码的三个版本，由不同的编码人员开发，一个“父”和两个“子”，需要计算，哪个更接近父级。

手头的代码大小禁止手动计算差异，并且我没有在我尝试过的流行的差异合并工具中看到任何聚合相似性统计信息。

豪拍网^H^H^H^H^H^H^H 获得单百分“相似度”数？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T11:08:53.913

您可以计算差异的行数。在 Linux 上，你会这样做：

```
diff -r parent child1 | wc -l

diff -r parent child2 | wc -l 
```

通过这种方式，您可以在代码行中获得粗略的差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T13:36:34.550

也许您可以使用复制粘贴检测器工具，例如[http://pmd.sourceforge.net/cpd.html](http://pmd.sourceforge.net/cpd.html)。我没有亲自使用过它，但它似乎能够生成统计数据。

# java - 有没有办法在 Java 中随机获取 HashMap 的值？

> ID：929554
> 
> 赞同：47
> 
> 时间：2009-05-30T11:07:33.977
> 
> 标签：java, collections, hashmap

有没有办法在 Java 中随机获取 HashMap 的值？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-05-30T11:23:10.903

这有效：

```
Random generator = new Random();
Object[] values = myHashMap.values().toArray();
Object randomValue = values[generator.nextInt(values.length)]; 
```

如果您希望随机值是一种类型，而不是`Object`简单地将强制转换添加到最后一行。所以如果`myHashMap`被声明为：

```
Map<Integer,String> myHashMap = new HashMap<Integer,String>(); 
```

最后一行可以是：

```
String randomValue = (String) values[generator.nextInt(value.length)]; 
```

* * *

下面的**不起作用**，`Set.toArray()`总是返回一个`Object`s 的数组，它不能被强制转换成一个 s 的数组`Map.Entry`。

```
Random generator = new Random();
Map.Entry[] entries = myHashMap.entrySet().toArray();
randomValue = entries[generator.nextInt(entries.length)].getValue(); 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-05-30T11:52:42.280

由于要求仅要求从 中获取随机值，`HashMap`因此方法如下：

1.  [`HashMap`](http://java.sun.com/javase/6/docs/api/java/util/HashMap.html)有一个[`values`](http://java.sun.com/javase/6/docs/api/java/util/HashMap.html#values())方法，它返回地图中的一个值[`Collection`](http://java.sun.com/javase/6/docs/api/java/util/Collection.html)。
2.  `Collection`用于[`List`](http://java.sun.com/javase/6/docs/api/java/util/List.html)创建.
3.  该[`size`](http://java.sun.com/javase/6/docs/api/java/util/List.html#size())方法用于查找 的大小，`List`该[`Random.nextInt`](http://java.sun.com/javase/6/docs/api/java/util/Random.html#nextInt(int))方法用于获取 的随机索引`List`。
4.  最后，`List` [`get`](http://java.sun.com/javase/6/docs/api/java/util/List.html#get(int))使用随机索引从方法中检索该值。

执行：

```
HashMap<String, Integer> map = new HashMap<String, Integer>();
map.put("Hello", 10);
map.put("Answer", 42);

List<Integer> valuesList = new ArrayList<Integer>(map.values());
int randomIndex = new Random().nextInt(valuesList.size());
Integer randomValue = valuesList.get(randomIndex); 
```

这种方法的好处是所有方法都是[通用](http://java.sun.com/j2se/1.5.0/docs/guide/language/generics.html)的——不需要类型转换。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-30T12:29:02.813

如果您需要在不重复任何元素的情况下从地图中绘制更多值，您可以将地图放入 List 中，然后对其进行洗牌。

```
List<Object> valuesList = new ArrayList<Object>(map.values());
Collections.shuffle( valuesList );

for ( Object obj : valuesList ) {
    System.out.println( obj );
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-30T11:11:24.250

生成一个介于 0 和`HashMap`. 在随机数处获取密钥。从该键中获取值。

**伪代码**：

```
 int n =  random(map.keys().length());
 String key = map.keys().at(n);
 Object value = map.at(key); 
```

如果很难在 Java 中实现这一点，那么您可以`toArray()`使用`Set`.

```
 Object[] values = map.values().toArray(new Object[map.size()]);
 Object random_value = values[random(values.length)]; 
```

我不太确定如何做随机数。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-05-29T19:30:07.340

当它在热路径中时，将其转换为数组然后获取值太慢了。

所以获取集合（键或键值集）并执行以下操作：

```
 public class SetUtility {
        public static<Type> Type getRandomElementFromSet(final Set<Type> set, Random random) {
        final int index = random.nextInt(set.size());

        Iterator<Type> iterator = set.iterator();

        for( int i = 0; i < index-1; i++ ) {
            iterator.next();
        }

        return iterator.next();
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-30T13:07:33.783

一个好的答案稍微取决于具体情况，特别是您需要多长时间为给定地图获取随机密钥（注意，无论您获取密钥还是值，该技术本质上都是相同的）。

*   如果您需要 来自给定映射的**各种随机键**，并且在获取随机键之间**没有更改**映射，则在遍历键集时使用**[随机采样方法。](http://www.javamex.com/tutorials/random_numbers/random_sample.shtml)**实际上，您所做的是遍历 keySet() 返回的集合，并在每个项目上计算想要获取该密钥的概率，考虑到您总共需要多少以及到目前为止您已经获取的数量。然后生成一个随机数，看看这个数字是否低于概率。（注意，即使您只需要 1 个密钥，**此方法也将始终有效**；在这种情况下，它不一定是最有效的方法。）
*   HashMap 中的键实际上已经是伪随机顺序。在极端情况下，对于给定的可能映射，您**只需要一个随机键**，您甚至可以只提取**keySet() 的第一个元素**。
*   在**其他情况下**（对于给定的可能映射，您需要多个可能的随机键，或者在您使用随机键之间映射会发生变化），您基本上必须 **创建或维护一个键的数组/列表**，从中选择一个随机键钥匙。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-05-07T12:07:20.137

通常你并不真正想要一个**随机**值，而只是想要**任何**值，然后这样做很好：

```
Object selectedObj = null;
for (Object obj : map.values()) {
    selectedObj = obj;
    break;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-11-12T18:52:06.577

如果您使用的是 Java 8，请使用`findAny`一个漂亮的解决方案：

```
MyEntityClass myRandomlyPickedObject = myHashMap.values().stream().findAny(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-30T12:04:16.220

下面是一个示例，如何使用 Peter Stuifzand 描述的数组方法，也可以通过`values()`- 方法：

```
// Populate the map
// ...

Object[] keys = map.keySet().toArray();
Object[] values = map.values().toArray();

Random rand = new Random();

// Get random key (and value, as an example)
String randKey = keys[ rand.nextInt(keys.length) ];
String randValue = values[ rand.nextInt(values.length) ];

// Use the random key
System.out.println( map.get(randKey) ); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-30T12:14:26.527

我真的不知道你为什么要这样做......但如果它有帮助，我已经创建了一个 RandomMap，它会在你调用 values() 时自动随机化这些值，那么下面的可运行演示应用程序可能会完成这项工作.. .

```
 package random;

  import java.util.ArrayList;
  import java.util.Collection;
  import java.util.Collections;
  import java.util.HashMap;
  import java.util.Iterator;
  import java.util.List;
  import java.util.Map;
  import java.util.TreeMap;

  public class Main {
      public static void main(String[] args) {
          Map hashMap = makeHashMap();
          // you can make any Map random by making them a RandomMap
          // better if you can just create the Map as a RandomMap instead of HashMap
          Map randomMap = new RandomMap(hashMap);

          // just call values() and iterate through them, they will be random
          Iterator iter = randomMap.values().iterator();

          while (iter.hasNext()) {
              String value = (String) iter.next();
              System.out.println(value);
          }
      }

      private static Map makeHashMap() {
          Map retVal;

          // HashMap is not ordered, and not exactly random (read the javadocs)
          retVal = new HashMap();

          // TreeMap sorts your map based on Comparable of keys
          retVal = new TreeMap();

          // RandomMap - a map that returns stuff randomly
          // use this, don't have to create RandomMap after function returns
          // retVal = new HashMap();

          for (int i = 0; i < 20; i++) {
              retVal.put("key" + i, "value" + i);
          }

          return retVal;
      }
  }

  /**
   * An implementation of Map that shuffles the Collection returned by values().
   * Similar approach can be applied to its entrySet() and keySet() methods.
   */
  class RandomMap extends HashMap {
      public RandomMap() {
          super();
      }

      public RandomMap(Map map) {
          super(map);
      }

      /**
       * Randomize the values on every call to values()
       *
       * @return randomized Collection
       */
      @Override
      public Collection values() {
          List randomList = new ArrayList(super.values());
          Collections.shuffle(randomList);

          return randomList;
      }

  } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-02-23T18:41:41.567

我编写了一个实用程序来从映射、条目集或迭代器中检索随机条目、键或值。

由于您不能也不应该能够计算出迭代器的大小（[Guava 可以做到这一点](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Iterators.html#size(java.util.Iterator))），您将不得不重载该`randEntry()`方法以接受应该是条目长度的大小。

```
package util;

import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Set;

public class MapUtils {
    public static void main(String[] args) {
        Map<String, Integer> map = new HashMap<String, Integer>() {
            private static final long serialVersionUID = 1L;
            {
                put("Foo", 1);
                put("Bar", 2);
                put("Baz", 3);
            }
        };

        System.out.println(randEntryValue(map));
    }

    static <K, V> Entry<K, V> randEntry(Iterator<Entry<K, V>> it, int count) {
        int index = (int) (Math.random() * count);

        while (index > 0 && it.hasNext()) {
            it.next();
            index--;
        }

        return it.next();
    }

    static <K, V> Entry<K, V> randEntry(Set<Entry<K, V>> entries) {
        return randEntry(entries.iterator(), entries.size());
    }

    static <K, V> Entry<K, V> randEntry(Map<K, V> map) {
        return randEntry(map.entrySet());
    }

    static <K, V> K randEntryKey(Map<K, V> map) {
        return randEntry(map).getKey();
    }

    static <K, V> V randEntryValue(Map<K, V> map) {
        return randEntry(map).getValue();
    }
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-04-22T07:05:18.533

如果你对`O(n)`时间复杂度没问题，你可以使用类似`values()`or的方法，`values().toArray()`但是如果你寻找一个恒定的`O(1)` `getRandom()`操作，一个很好的选择是使用自定义数据结构。`ArrayList`和`HashMap`可以组合以获得和的`O(1)`时间。这是一个示例实现：`insert()``remove()``getRandom()`

```
class RandomizedSet {
    List<Integer> nums = new ArrayList<>();
    Map<Integer, Integer> valToIdx = new HashMap<>();
    Random rand = new Random();

    public RandomizedSet() { }

    /**
     * Inserts a value to the set. Returns true if the set did not already contain
     * the specified element.
     */
    public boolean insert(int val) {
        if (!valToIdx.containsKey(val)) {
            valToIdx.put(val, nums.size());
            nums.add(val);
            return true;
        }
        return false;
    }

    /**
     * Removes a value from the set. Returns true if the set contained the specified
     * element.
     */
    public boolean remove(int val) {
        if (valToIdx.containsKey(val)) {
            int idx = valToIdx.get(val);
            int lastVal = nums.get(nums.size() - 1);

            nums.set(idx, lastVal);
            valToIdx.put(lastVal, idx);

            nums.remove(nums.size() - 1);
            valToIdx.remove(val);
            return true;
        }
        return false;
    }

    /** Get a random element from the set. */
    public int getRandom() {
        return nums.get(rand.nextInt(nums.size()));
    }
} 
```

这个想法来自[leetcode.com的](https://leetcode.com)[这个](https://leetcode.com/problems/insert-delete-getrandom-o1/)问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-12-15T15:06:04.367

似乎所有其他高票数的答案都迭代了所有元素。至少，这里不是所有元素都必须迭代：

```
Random generator = new Random();
return myHashMap.values().stream()
                .skip(random.nextInt(myHashMap.size()))
                .findFirst().get(); 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2009-05-30T11:10:41.617

这取决于您的密钥是什么 - 哈希图的性质不允许这种情况轻易发生。

我能想到的方法是选择一个介于 1 和哈希图大小之间的随机数，然后开始迭代它，随时保持计数 - 当计数等于你的随机数时选择，那是你的随机元素。

# wordpress - 用于 Wordpress 主题开发的虚拟博客条目

> ID：929558
> 
> 赞同：4
> 
> 时间：2009-05-30T11:10:07.920
> 
> 标签：wordpress, themes, blogs

我正在开发一个自定义的 wordpress 博客主题。

有谁知道是否有一个我可以用于开发的虚拟条目数据库？

目前我正在使用我自己博客中的实时数据，这没问题，但我在 wordpress 数据库上看到了具有相同条目的主题，这些主题使用出现的所有不同事物、表单、样式文本、不同类型的项目符号和表格等。据我所知，该数据没有发布。

我知道我可以创建自己的条目来练习所有这些案例，但我很[懒惰而且没有耐心](http://en.wikipedia.org/wiki/Larry_Wall#Virtues_of_a_programmer)。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-30T11:17:27.297

从此处下载示例内容文件：[使用示例 WordPress 内容更轻松地进行主题开发](http://wpcandy.com/articles/easier-theme-development-with-the-sample-post-collection.html)。

然后将其导入您的博客（工具 - 导入 - WordPress）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-29T14:53:17.660

Wordpress 还有一个主题开发清单，其中包括示例内容：[http ://codex.wordpress.org/Theme_Development_Checklist](http://codex.wordpress.org/Theme_Development_Checklist)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-02T09:28:36.073

您可以在此处下载 Wordpress 示例内容[http://wpcandy.s3.amazonaws.com/resources/postsxml.zip](http://wpcandy.s3.amazonaws.com/resources/postsxml.zip)。

这对于测试您的 wordpress 很有用，而不会浪费您的时间来发布测试条目。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-25T14:21:21.973

我建议使用“WP 示例内容”插件。此插件的优点是您可以按需启用/禁用示例内容。

# apache-flex - 是否可以同时向 Google 和 Yahoo API 发送请求？

> ID：929564
> 
> 赞同：0
> 
> 时间：2009-05-30T11:12:40.533
> 
> 标签：apache-flex, api, air

在我的项目中，我使用了 Google adwords API 和 Yahoo API。我想使用 flex 同时向两个 API 发送请求。

是否可以同时发送请求。如果不是我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T11:19:59.007

由于 flex 是基于事件的，这应该非常简单。只需创建 2 个 URLRequest 对象（我假设这两个 API 都是基于 REST 的），然后设置您的 GET 变量。为每个 URLRequest 对象创建一个 loadComplete 事件侦听器，并在每个事件侦听器中编写处理来自两个 API 的结果的代码。

那应该这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T16:41:43.350

不是“同时”，不是。一方面，您只有一个（后台）线程可以使用，并且该线程一次只能做一件事，因此无论您编写代码，始终会首先启动其中一个请求。

如果您要问的是是否可以在一次调用中向这两个服务发送请求，那么答案再次是否定的（因为两者都有不同的 URL，并且 ActionScript API 不将数组作为 URL 参数，它们只带字符串）。

也就是说，我想你可以“伪造”它，可以这么说，让你的 Flex 应用程序调用你自己编写的服务——例如，在 C# 中——并让该服务调用（同步）谷歌，然后是雅虎，然后返回控制权返回到您的 Flex 应用程序以及修改后的结果集，其中包含分别从 Google 和 Yahoo 返回的任何内容。

除非我误解（或过度思考）这个问题。;)

[下面是一些示例代码，说明了使用mx.rpc.HTTPService](http://www.adobe.com/livedocs/flex/3/langref/mx/rpc/http/HTTPService.html)处理调用两个服务的一种方法——不是同时的，而是一个接一个地调用：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" creationComplete="onCreationComplete()">

    <mx:Script>
        <![CDATA[

            import mx.rpc.http.HTTPService;
            import mx.rpc.events.ResultEvent;
            import mx.rpc.events.FaultEvent;

            private function onCreationComplete():void
            {
                callGoogle();
                callYahoo();
            }

            private function callGoogle():void
            {
                var svc:HTTPService = new HTTPService();
                svc.url = "http://api.google.com/someservice.xml";
                svc.addEventListener(ResultEvent.RESULT, onGoogleResult, false, 0, true);
                svc.addEventListener(FaultEvent.FAULT, onGoogleFault, false, 0, true);
                svc.send();
            }

            private function callYahoo():void
            {
                var svc:HTTPService = new HTTPService();
                svc.url = "http://api.yahoo.com/someservice.xml";
                svc.addEventListener(ResultEvent.RESULT, onYahooResult, false, 0, true);
                svc.addEventListener(FaultEvent.FAULT, onYahooFault, false, 0, true);
                svc.send();
            }

            private function onGoogleResult(event:ResultEvent):void
            {
                trace(event.result);
            }

            private function onGoogleFault(event:FaultEvent):void
            {
                trace(event.fault.message);
            }

            private function onYahooResult(event:ResultEvent):void
            {
                trace(event.result);
            }

            private function onYahooFault(event:FaultEvent):void
            {
                trace(event.fault.message);
            }

        ]]>
    </mx:Script>

</mx:Application> 
```

希望有帮助！回复评论，我会留意的。

# forum - 在网络上推广免费图书馆

> ID：929566
> 
> 赞同：0
> 
> 时间：2009-05-30T11:15:34.727
> 
> 标签：forum

我几乎完成了一个免费的 Windows Mobile 拼写检查库，并且有一些很棒的论坛（面向开发人员和最终用户），例如[XDA](http://www.xda-developers.com/)，您可以在其中宣传您的 Windows Mobile 创作。

但是，我一直在想我想让我的库的一个版本也可供 Windows 桌面开发人员使用。一旦我完成了同样的工作，我想分发和推广它以获得反馈、错误报告和建议。

有没有好的开发者论坛可以以这种方式推广和分发应用程序或库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T11:37:00.970

您可能需要考虑为自己的库编写介绍性评论，并将其发布在[codeguru.com](http://www.codeguru.com/)或[codeproject.com](http://www.codeproject.com)等网站上。您还可以使用[ddj.com](http://www.ddj.com)等热门网站的博客来宣传您的图书馆。

另一方面，要做的一件非常简单的事情是为您的库设置一个 sourceforge 项目（如果它是开源的），然后将它们的设施用于所有这些目的。具体来说，您可以轻松地使用[freshmeat.net](http://www.freshmeat.net)让您的图书馆更广为人知。

您将需要一个最低限度的基础设施（论坛/邮件列表、问题跟踪器和可能的源代码管理），以便为您的用户提供一个轻松监控甚至可能积极参与您的项目的地方。

不过，一个简单的主页和雅虎列表可能就足够了。

此外，一般来说，查看可用的拼写检查库，您可能希望突出您的实现/项目与更成熟的项目之间的主要区别，例如[GNU aspell](http://aspell.net/)或[hunspell](http://hunspell.sourceforge.net)。

因此，请务必进行一些研究以了解相关项目。

# java - 如何正确显示带有西里尔字符的字符串？

> ID：929573
> 
> 赞同：1
> 
> 时间：2009-05-30T11:21:12.327
> 
> 标签：java, macos, character-encoding

在带有 Java 1.5 的 Mac OS X 10.5 上，我有这个代码片段。

```
public static void main(String[] args) {
    String name = "Алексей";
    System.out.println("name = " + name);
} 
```

输出是：

```
name = ??????? 
```

我希望看到：

```
name = Алексей 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T11:26:47.230

这里有两个潜在的问题。首先，您的源代码中有西里尔字符。这意味着您必须确保用于存储文件的编码与编译器使用的编码相同。查看*javac 手册*页以了解其默认编码是什么，和/或如何指定特定编码。或者，在您的字符串中使用 Unicode 转义。

第二种可能性是您的终端字体不显示西里尔字符。但是，我不认为这是正在发生的事情，因为（1）您能够看到源代码中的字符，并且（2）我相信缺少字形呈现为块，不正确的编码呈现为问号。

要进行测试，只需用正确的 Unicode 转义符替换您的字符串，并验证字符是否呈现在您的屏幕上。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T13:33:45.087

如果您使用**Console**类而不是 System.out，并且您真的很幸运，您**可能**能够让控制台打印西里尔字符。

但总的来说，控制台没有很好的字符集支持。

以其他方式输出字符串会更可靠，例如将其打印到 Swing 组件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T07:54:51.567

感谢所有有用的想法。

原来我的问题的关键是这句话：

> 在带有 Java 1.5 的**Mac OS X 10.5**上，我有这个代码片段

我正在使用的 IDE IntelliJ IDEA 将文件编码显式设置为 MacRoman。通过将项目的编码更改为 UTF-8，无需更改任何代码即可解决问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T20:25:45.953

如果您的字符串是从某个地方动态获取的，并且您需要确保根据需要对其进行编码，请使用 String 的一些将 Charset 类型作为参数的类构造函数来转换该字符串。

# c# - 读取音频 CD 曲目信息

> ID：929575
> 
> 赞同：3
> 
> 时间：2009-05-30T11:26:41.507
> 
> 标签：c#, audio, cd-rom

如何使用 C# 读取音频 CD 的曲目信息（作者、曲目标题、长度）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T11:31:16.473

有一个很好的教程：http: [//khason.net/dev/audio-cd-operation-including-cd-text-reading-in-pure-c/](http://khason.net/dev/audio-cd-operation-including-cd-text-reading-in-pure-c/)

我希望这就足够了，祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T11:31:40.170

嗯，也许我错了，但我认为音频 CD 中没有这样的信息。也许你必须使用像 CDDB 这样的东西

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-02-20T21:08:21.040

“嗯，也许我错了，但我认为音频 CD 中没有这样的信息。也许你必须使用 CDDB 之类的东西”

哦，是的，您无法在没有 3rd 方软件的 PC 上阅读它 参见此链接[wikipedia CD-Text](http://en.wikipedia.org/wiki/CD-Text#Software)如果您只想阅读自制 CD，Windows Media 播放器插件特别好

CDDB 仅对商业生产的 CD 有任何用途

# php - 如何在 php 中启用 sqlite3 的 PDO 驱动程序？

> ID：929585
> 
> 赞同：9
> 
> 时间：2009-05-30T11:36:05.310
> 
> 标签：php, sqlite, pdo, xampp

我的 SQLite 是 3.4.0 版： [图片](http://www.picamatic.com/show/2009/05/30/03/33/3822461_343x44.jpg)

但是我的 phpinfo 对 SQLitev3 的 PDO 支持未启用/列出： [图像](http://www.picamatic.com/show/2009/05/30/03/32/3822444_630x115.jpg)

我该如何启用它？我通过 XAMPP 安装了我的网络服务器。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-15T12:42:21.657

转到您的`php.ini`文件并搜索“sqlite”。这些可能是评论：

```
extension=php_pdo_sqlite.dll

extension=php_sqlite.dll 
```

取消注释，然后重新启动 Apache。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-30T12:12:12.023

我认为 sqlite3 的 PDO 驱动程序称为“sqlite”，因此您已经安装了它。sqlite2 驱动程序较旧。

> PDO_SQLITE 是一个实现 PHP 数据对象 (PDO) 接口以启用对 SQLite 3 数据库的访问的驱动程序。
> 
> 在 PHP 5.1 中，SQLite 扩展还为 SQLite 2 数据库提供了驱动程序；虽然它在技术上不是 PDO_SQLITE 驱动程序的一部分，但它的行为相似，因此它与它一起记录。提供 PDO 的 SQLite 2 驱动程序主要是为了更轻松地将旧版 SQLite 2 数据库文件导入使用更快、更高效的 SQLite 3 驱动程序的应用程序。因此，SQLite 2 驱动程序不像 SQLite 3 驱动程序那样功能丰富。

来自[http://php.net/manual/en/ref.pdo-sqlite.php](http://php.net/manual/en/ref.pdo-sqlite.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-05-02T18:55:46.843

我在 linux/unix 系统上修复了这个问题，并在 php.ini 中添加了以下行：

```
extension=pdo_sqlite.so
extension=sqlite.so 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-03T13:11:24.593

"pdo_sqlite" 和 "sqlite3" 是不同的扩展名，加载`php.ini`在不同的行中：

```
extension=php_pdo_sqlite.dll

extension=php_sqlite3.dll 
```

# perl - 如何解决 Perl 中的“关闭文件句柄上的 print()”错误？

> ID：929586
> 
> 赞同：13
> 
> 时间：2009-05-30T11:36:38.257
> 
> 标签：perl, file-io

我在执行我的 Perl 脚本时收到此错误。请告诉我如何在 Perl 中纠正这个错误。

```
print() on closed filehandle MYFILE 
```

这是给出错误的代码：

```
sub return_error
{
    $DATA= "Sorry this page is corrently being updated...<p>";
    $DATA.=  "<A href=\"javascript:history.go(-1)\"> Back </A>";
    open(MYFILE,">/home/abc/xrt/sdf/news/top.html");
    print MYFILE $DATA;
    close(MYFILE);
    exit;
} 
```

我希望现在我更清楚了。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-30T11:40:42.990

您想`MYFILE`在您（或解释器本身由于错误）关闭它之后执行一些操作。

根据您的代码示例，问题可能是`open`没有真正打开文件，脚本可能没有写入文件的权限。

将您的代码更改为以下内容以查看是否有错误：

```
open(MYFILE, ">", "/home/abc/xrt/sdf/news/top.html") or die "Couldn't open: $!"; 
```

*更新*

[ysth](https://stackoverflow.com/users/17389/ysth)指出，`-w`它并不擅长检查您是否可以写入文件，它只是“检查模式中的相关标志之一是否已设置”。此外，[brian d foy](https://stackoverflow.com/users/8817/brian-d-foy)告诉我，我使用的条件并不擅长处理错误。所以我删除了误导性代码。请改用上面的代码。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-05-30T13:22:06.343

看来`open`通话失败了。打开文件句柄时应*始终*检查状态。

```
my $file = '/home/abc/xrt/sdf/news/top.html';
open(MYFILE, ">$file") or die "Can't write to file '$file' [$!]\n";
print MYFILE $DATA;
close MYFILE; 
```

如果打开不成功，则内置变量 $! （又名 $OS_ERROR）将包含依赖于操作系统的错误消息，例如“权限被拒绝”

最好（对于 Perl 的非古老版本）使用三参数形式`open`和词法文件句柄：

```
my $file = '/home/abc/xrt/sdf/news/top.html';
open(my $fh, '>', $file) or die "Can't write to file '$file' [$!]\n";
print {$fh} $DATA;
close $fh; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-30T16:58:40.503

另一种说法`or die`是使用[autodie](http://search.cpan.org/dist/autodie/lib/autodie.pm) pragma：

```
#!/usr/bin/perl

use strict;
use warnings;
use autodie;

open my $fh, "<", "nsdfkjwefnbwef";

print "should never get here (unless you named files weirdly)\n"; 
```

上面的代码会产生以下错误（除非当前目录中存在名为 nsdfkjwefnbwef 的文件）：

```
Can't open 'nsdfkjwefnbwef' for reading: 'No such file or directory' at example.pl line 7 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-30T12:38:31.500

这个：

```
open(MYFILE,">/home/abc/xrt/sdf/news/top.html"); 
```

在[现代 Perl](http://modernperlbooks.com/mt/index.html)中，它可以写成：

```
open(my $file_fh, ">", "/home/abc/xrt/sdf/news/top.html") or die($!); 
```

这样，您就可以将 $ 变量限制在范围内，如果您有奇怪的文件名（例如以“>”开头）和错误处理（您可以用警告或错误处理代码替换 die），则没有“时髦的业务”。

一旦您关闭 $file_fh 或只是超出范围，您就不能再打印到它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-07-29T14:21:56.387

当我的文件设置为只读时，我遇到了这个问题。

在放弃之前也要检查一下！:)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-30T13:22:44.720

检查打开是否有效

```
if(open(my $FH, ">", "filename") || die("error: $!"))
{
    print $FH "stuff";
    close($FH);
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-01T18:19:34.133

如果您使用全局符号 MYFILE 作为文件句柄，而不是本地词法 ($myfile)，如果您的程序是多线程的，例如，如果它通过 mod_perl 运行，您总是会遇到问题。一个进程可能正在关闭文件句柄，而另一个进程正在尝试写入它。使用 $myfile 可以避免这个问题，因为每个实例都有自己的本地副本，但您仍然会遇到一个进程可能覆盖另一个进程正在写入的数据的问题。在写入文件时使用flock() 锁定文件。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-30T11:42:34.140

在您的脚本中的某个地方，您将执行以下操作：

```
open MYFILE, "> myfile.txt";
# do stuff with myfile
close MYFILE;
print MYFILE "Some more stuff I want to write to myfile"; 
```

最后一行将抛出错误，因为 MYFILE 已关闭。

*更新*

看到您的代码后，看起来您尝试写入的文件一开始就无法打开。正如其他人已经提到的那样尝试做类似的事情：

```
open MYFILE, "> myfile.txt" or die "Can't open myfile.txt: $!\n" 
```

这应该会给你一些关于为什么你不能打开文件的反馈。

# delphi - 如何打印 TPanel 内容？

> ID：929589
> 
> 赞同：3
> 
> 时间：2009-05-30T11:38:34.117
> 
> 标签：delphi, printing, vcl, delphi-5, tpanel

我有 TPanel。在这个面板上有一个 TImage 后代，很少有其他面板带有控件等。实际上，图片包含一些图表，而在运行时创建了带有标签的其他面板，以向用户提供额外的信息。
最近有人告诉我，如果可以打印此面板，并以它的形式出现在纸上，那就太好了。任何线索，如何做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T12:09:59.077

我找到了一个旧的 usenet 帖子，通过将面板的内容复制到可以打印的位图来提供解决方案：

```
procedure TFormPrintWindows.ButtonPrintPanelClick(Sender: TObject);
  var
    Bitmap       :  TBitmap;
    FromLeft     :  INTEGER;
    FromTop      :  INTEGER;
    PrintedWidth :  INTEGER;
    PrintedHeight:  INTEGER;
begin
  Printer.BeginDoc;
  TRY
    Bitmap := TBitmap.Create;
    TRY
      Bitmap.Width  := Panel1.Width;
      Bitmap.Height := Panel1.Height;
      Bitmap.PixelFormat := pf24bit;  // avoid palettes

      // Copy the Panel area from the Form into a separate Bitmap
      Bitmap.Canvas.CopyRect(Rect(0,0, Bitmap.Width,Bitmap.Height),
                             FormPrintWindows.Canvas,
                             Rect(Panel1.Left, Panel1.Top,
                                  Panel1.Left + Panel1.Width-1,
                                  Panel1.Top  + Panel1.Height-1) );

      // Assumes 10% left, right and top margin
      // Assumes bitmap aspect ratio > ~0.75 for portrait mode
      PrintedWidth  := MulDiv(Printer.PageWidth, 80,100);  // 80%
      PrintedHeight := MulDiv(PrintedWidth, Bitmap.Height, Bitmap.Width);
      FromLeft      := MulDiv(Printer.PageWidth, 10,100);  // 10%
      FromTop       := MulDiv(Printer.PageHeight,10,100);  // 10%

      PrintBitmap(Printer.Canvas,
        Rect(FromLeft, FromTop,
             FromLeft + PrintedWidth,
             FromTop  + PrintedHeight),
        Bitmap);
    FINALLY
      Bitmap.Free
    END;
  FINALLY
    Printer.EndDoc
  END

end; 
```

并添加

```
//Source of Code: 
//http://www.swissdelphicenter.ch/torry/showcode.php?id=744
//Which refers to a posting to borland.public.delphi.winapi by Rodney E Geraghty, 8/8/97.

procedure PrintBitmap(Canvas: TCanvas; DestRect: TRect; Bitmap: TBitmap);
var
  BitmapHeader: pBitmapInfo;
  BitmapImage: Pointer;
  HeaderSize: DWORD;
  ImageSize: DWORD;
begin
  GetDIBSizes(Bitmap.Handle, HeaderSize, ImageSize);
  GetMem(BitmapHeader, HeaderSize);
  GetMem(BitmapImage, ImageSize);
  try
    GetDIB(Bitmap.Handle, Bitmap.Palette, BitmapHeader^, BitmapImage^);
    StretchDIBits(Canvas.Handle,
      DestRect.Left, DestRect.Top,    // Destination Origin
      DestRect.Right - DestRect.Left, // Destination Width
      DestRect.Bottom - DestRect.Top, // Destination Height
      0, 0,                           // Source Origin
      Bitmap.Width, Bitmap.Height,    // Source Width & Height
      BitmapImage,
      TBitmapInfo(BitmapHeader^),
      DIB_RGB_COLORS,
      SRCCOPY)
  finally
    FreeMem(BitmapHeader);
    FreeMem(BitmapImage)
  end
end {PrintBitmap}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T12:38:48.990

Birger 的代码示例中的 PrintBitmap 缺失，当您添加缺失的方法时，它运行良好。

```
//Source of Code: 
//http://www.swissdelphicenter.ch/torry/showcode.php?id=744
//Which refers to a posting to borland.public.delphi.winapi by Rodney E Geraghty, 8/8/97.

procedure PrintBitmap(Canvas: TCanvas; DestRect: TRect; Bitmap: TBitmap);
var
  BitmapHeader: pBitmapInfo;
  BitmapImage: Pointer;
  HeaderSize: DWORD;
  ImageSize: DWORD;
begin
  GetDIBSizes(Bitmap.Handle, HeaderSize, ImageSize);
  GetMem(BitmapHeader, HeaderSize);
  GetMem(BitmapImage, ImageSize);
  try
    GetDIB(Bitmap.Handle, Bitmap.Palette, BitmapHeader^, BitmapImage^);
    StretchDIBits(Canvas.Handle,
      DestRect.Left, DestRect.Top,    // Destination Origin
      DestRect.Right - DestRect.Left, // Destination Width
      DestRect.Bottom - DestRect.Top, // Destination Height
      0, 0,                           // Source Origin
      Bitmap.Width, Bitmap.Height,    // Source Width & Height
      BitmapImage,
      TBitmapInfo(BitmapHeader^),
      DIB_RGB_COLORS,
      SRCCOPY)
  finally
    FreeMem(BitmapHeader);
    FreeMem(BitmapImage)
  end
end {PrintBitmap}; 
```

# php - 如何在 Windows 平台上用 PHP 编译 C/C++ 代码？

> ID：929592
> 
> 赞同：2
> 
> 时间：2009-05-30T11:39:24.960
> 
> 标签：php, c++, command-line, compiler-construction, compilation

谁能帮我在 Windows 平台上用 PHP 编译 C++ 代码？我正在使用 Microsoft Visual C++ 6.0。

我尝试了以下我知道的选项，但它们都不起作用：

```
system('test.c') 
exec('test.c') 
```

文件“test.c”已放在我的 php/www/ 文件夹中。

我需要首先编译生成 test.exe 的代码，然后使用 exec() 我需要运行 exe 文件。

* * *

### 编辑：

在这段代码“test.c”中，我正在读取文件“data.txt”。data.txt 的内容每 5 秒更改一次。这就是为什么我首先需要在 PHP 中编译，然后运行新的 exe 文件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T11:48:40.510

做一个 .bat 文件：

*   运行 Visual Studio 附带的 vcvars32.bat 文件
*   运行“cl.exe yourprogram.c”

然后从 PHP 启动该 .bat 文件。（不知道你会怎么做）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T11:46:57.033

您需要`cl.exe`显式调用编译器 () 和链接器（[参见编译器参考](http://msdn.microsoft.com/en-us/library/aa236704(VS.60).aspx)）或使用 makefile（[g++ 参考](http://www.sethi.org/classes/cet375/lab_notes/lab_04_makefile_and_compilation.html)，但说明了重点）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T11:48:07.500

我假设您想从 php 脚本调用编译器？

如果是这种情况，您首先必须调用编译器本身 - 而不仅仅是将源代码的文件名传递给 system. 对于 MSVC++，您需要查找“cl.exe”。

此外，如果您的环境中未设置相应的路径，则需要使用完整路径。

确保首先了解如何从命令提示符手动调用 cl.exe。一旦你理解了这一点，你就可以尝试从一个 php 脚本中调用它。

但是，您需要意识到还有其他因素需要考虑，例如编译文件所需的时间与 php 脚本在超时之前执行所允许的时间。

我认为，您可能需要向我们提供有关您到底想做什么以及为什么要这样做的更多信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-08T08:01:28.457

[http://4answered.com/questions/view/7e1694/Compile-C-file-Using-PHP](http://4answered.com/questions/view/7e1694/Compile-C-file-Using-PHP)这有助于我编译和运行 C 程序（请参阅此链接上的视频）。使用这个我写了这个 php 代码，它可以工作

```
<?php

putenv("PATH=C:\\MinGW\\bin");
exec("gcc C:\\test\\q.c -o C:\\test\\q1.exe");
system("C:\\test\\q1.exe",$output);
echo $output; 
```

我的质检

```
#include <stdio.h>

int main(int argc, char* argv[])
{
  printf("Hello world");
  return 0;
} 
```

所以你会在 $output 中看到“Hello world0”

# java - Java Slider - 如何制作自定义刻度？

> ID：929593
> 
> 赞同：1
> 
> 时间：2009-05-30T11:39:50.217
> 
> 标签：java, swing, user-interface, jslider

我有一个带有图像幻灯片的音轨 - 例如，图像 1 在 0:00，图像 2 在 0:45，图像 3 在 1:03 等。我目前正在使用 JSlider 来更改轨道中的位置。我想在图像更改的点上的滑块上有刻度 - 但刻度之间的间距不均匀，所以`setPaintTicks`不是一个选项。有没有办法做到这一点`javax.swing.JSlider`，或者你能推荐一个不同的滑块控件吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T11:50:31.910

我遇到了这个问题，没有找到在 JSlider 中自定义刻度间距的方法。

您可以使用自定义刻度标签作为解决方法，使用**JSlider.setLabelTable()**。这允许您仅标记某些刻度。

# iphone - 如何同时在两个 UIViews 中动态更新 UIlabel 文本？

> ID：929596
> 
> 赞同：-1
> 
> 时间：2009-05-30T11:43:40.863
> 
> 标签：iphone, objective-c, xcode, math

我有两个uiview的命名问题和答案。问题视图是通过单击单元格加载的。在问题视图上，当我单击名为“答案”的按钮时，我有两个名为“查看答案”和“下一步”的 iboutlet 按钮加载了答案视图。两个 uiview 都有一个标签。现在我想在第一次加载问题视图时显示一个问题，并且相关答案应该在答案视图的标签上。现在当点击下一个按钮时，标签应该更新并且相关的答案也应该更新。当所有问题都完成后，我想要一个带有分数的视图，即有多少答案是正确的，有多少是错误的。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2010-05-06T00:11:03.153

好主意拉胡尔！

您必须将您的应用程序设计为具有“引擎”和“界面”。引擎必须知道问题、答案、回答的问题和总分。连接用户界面后。

您的 UIButton 视图答案有一个单击事件的过程。当用户单击按钮时，您必须：

1) 知道当前的问题编号是什么
2) 从引擎中获取答案
3) 检查是否
创建了答案视图 4) 如果为 nil 则创建答案视图
5) 将答案传递给答案视图 - 答案视图会更新答案标签
6) 弹出可见的答案视图

用户单击下一步时无需更新答案。

添加多媒体，它会摇滚！祝你好运！

理查德

# delphi - 如何使 Virtual Treeview 控件始终按行滚动？

> ID：929600
> 
> 赞同：5
> 
> 时间：2009-05-30T11:47:15.707
> 
> 标签：delphi, virtualtreeview

与标准 Delphi 网格的方式不同，Virtual Treeview 按像素垂直滚动，`TListView`并且`TTreeView`（或我知道的大多数其他此类控件）逐行滚动并始终在控件顶部保持整行可见。当我使用光标键导航时，根据方向，第一行或最后一行完全可见。用鼠标滚动时，没有任何对齐。

例如，可以通过 Delphi 2007 和 2009 中的结构窗口观察到这种行为。

有没有办法设置许多属性以具有标准 Windows 控件的行为？或者是否有一组补丁可以实现这一目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-01T14:03:20.210

这是我在 Argalatyr 的帮助下想出的，看起来它做了我想要的：

```
procedure TForm1.FormCreate(Sender: TObject);
begin
  VirtualStringTree1.ScrollBarOptions.VerticalIncrement :=
    VirtualStringTree1.DefaultNodeHeight;
end;

procedure TForm1.VirtualStringTree1Resize(Sender: TObject);
var
  DY: integer;
begin
  with VirtualStringTree1 do begin
    DY := VirtualStringTree1.DefaultNodeHeight;
    BottomSpace := ClientHeight mod DY;
    VirtualStringTree1.OffsetY := Round(VirtualStringTree1.OffsetY / DY) * DY;
  end;
end;

procedure TForm1.VirtualStringTree1Scroll(Sender: TBaseVirtualTree; DeltaX,
  DeltaY: Integer);
var
  DY: integer;
begin
  if DeltaY <> 0 then begin
    DY := VirtualStringTree1.DefaultNodeHeight;
    VirtualStringTree1.OffsetY := Round(VirtualStringTree1.OffsetY / DY) * DY;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-01T01:06:51.373

您可以拦截 TBaseVirtualTree.OnScroll 事件并使用虚拟树视图的画布的 textheight('M') 返回值作为更改 TBaseVirtualTree.offsety 的量，以便增加（向上滚动）或减少（向下滚动）。还可以测试以确保预滚动位置模数 textheight('M') 为零（以避免从错误位置滚动正确的量）。

或者，虚拟树视图论坛上的[这篇文章](http://support.soft-gems.net/forums/viewtopic.php?t=2149&highlight=vstscrollintoview)提出了另一种方法：使用 VCL 滚动条隐藏虚拟树视图的本机滚动条，然后自己进行滚动（捕获 VCL 滚动事件并以编程方式滚动虚拟树视图）。

# .net - 针对开发人员的异常消息是否应该本地化？

> ID：929604
> 
> 赞同：8
> 
> 时间：2009-05-30T11:48:53.020
> 
> 标签：.net, api, exception-handling, localization, frameworks

我指的是显示开发人员错误地使用 API 的异常消息。例如，错误地将 null 传递给方法。因此，开发人员第一次运行错误代码时会遇到的异常类型。永远不应向系统用户显示的异常消息的类型。

这与这样一种理论有关，即由于编程语言是英语，因此程序员已经对英语有所了解。或者至少足以破译异常消息。

[http://www.codinghorror.com/blog/archives/001248.html](http://www.codinghorror.com/blog/archives/001248.html)（请不要在这里讨论这个理论）

是的，我知道 .net 框架遵循“本地化一切”的方法。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-30T12:15:10.847

您的问题可以改写为“所有开发人员都应该收到相同的错误消息以便他们可以谷歌吗？” ;)

答案是肯定的。

翻译的意思是

*   该消息不再与编写 API 的人相同。它可能具有相同的含义，或者它可能在翻译中丢失了一些东西。它可能翻译得很糟糕，在某些情况下可能完全无法阅读。
*   阅读它的人不能简单地将错误输入谷歌并查看其他收到此错误的人做了什么。因为其他人在不同的语言中都遇到了同样的错误。

关于 .NET 的“本地化一切”方法，这太可怕了。我被它绊倒了无数次，特别是如果它找不到本地化资源，它不会**给**你简单的英文版本。相反，它会为您提供“无法找到资源”错误，从而有效地丢弃实际的错误信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T11:53:21.077

不，我认为他们不应该这样做（或者至少我们不这样做，而且我们很大:-)。本地化用户看到的所有内容需要付出足够的努力，而不必担心开发人员。

没有支持外语关键字和标准库的主流语言，因此对英语的基本掌握已经是开发人员的先决条件。

当然，如果开发人员开发自己的库（或语言），他们完全可以自由地本地化或选择非英语语言。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T12:15:48.020

在我们公司，我们允许为我们的编译器/IDE 翻译异常/错误消息，并提供翻译这些异常/错误消息的框架，但是我们自己不进行翻译。如果客户愿意，则由客户进行翻译。有许多国家的英语不是那么流行，并且在推广自己的语言。因此，允许翻译错误消息是有意义的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T11:53:08.987

这完全取决于谁来维护代码。如果开发人员始终是英语，那么将其全部保持为英语是有意义的。

此外，我不确定 .NET Framework 是否以本地化方式抛出其错误消息。我一直认为这些错误消息总是用英文显示的，因此将内部错误消息也保留为英文是有意义的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T12:29:02.177

如果您翻译您的异常消息，那么您还应该翻译所有出现异常消息的文本。这包括您拥有的任何知识库或错误跟踪系统，因为用户和程序员会想要搜索他们在屏幕上看到的异常消息。

# javascript - 在 javascript 中加入 2 个“线程”

> ID：929606
> 
> 赞同：8
> 
> 时间：2009-05-30T11:50:42.190
> 
> 标签：javascript, jquery, ajax, multithreading, join

如果我有一个 ajax 取消获取（带有回调），然后在此期间运行一些其他代码。当前两个都完成时，我怎样才能有第三个函数将被调用。我确信轮询（setTimeout 然后检查一些变量）很容易，但我宁愿回调。

可能吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-30T11:54:19.797

您可以为 AJAX 调用和同时运行的其他代码提供相同的回调，使用变量来跟踪它们的组合进度，然后将它们链接到如下回调：

```
// Each time you start a call, increment this by one
var counter = 0;

var callback = function() {
    counter--;
    if (counter == 0) {
        // Execute code you wanted to do once both threads are finished.
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T12:15:55.103

丹尼尔的解决方案是正确的。我拿了它并添加了一些额外的代码，所以你不必想太多；）

```
function createNotifier() {
    var counter = 2;
    return function() {
        if (--counter == 0) {
            // do stuff
        }
    };
}

var notify = createNotifier();
var later = function() {
    var done = false;
    // do stuff and set done to true if you're done
    if (done) {
        notify();
    }
};

function doAjaxCall(notify) {
    var ajaxCallback = function() {
        // Respond to the AJAX callback here
        // Notify that the Ajax callback is done
        notify();
    };
    // Here you perform the AJAX call action
}

setInterval(later, 200);
doAjaxCall(notify); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-30T18:26:43.647

最好的方法是利用函数是 JavaScript 中的一阶对象这一事实。因此，您可以将它们分配给变量并通过变量调用它们，根据需要更改变量引用的函数。

例如：

```
function firstCallback() {
    // the first thing has happened
    // so when the next thing happens, we want to do stuff
    callback = secondCallback;
}

function secondCallback() {
    // do stuff now both things have happened
}

var callback = firstCallback; 
```

如果您的两段代码现在都使用该变量来调用该函数：

```
callback(); 
```

然后无论哪个先执行，都会调用 firstCallback，这会将变量更改为指向 secondCallback，因此第二个执行的将调用该变量。

但是，您对问题的措辞暗示这可能都是不必要的，因为听起来您正在发出 Ajax 请求然后继续处理。由于 JavaScript 解释器是单线程的，所以在发出请求的代码主体完成执行之前，永远不会执行 Ajax 回调，即使在收到响应之后很长时间也是如此。

如果这不是您的情况，我[在我的网站上创建了一个工作示例](http://www.nickfitz.co.uk/examples/javascript/switching-functions.html)；查看源代码以查看代码（就在 </body> 标记之前）。它发出一个被服务器延迟几秒钟的请求，然后是一个立即收到响应的请求。第二个请求的响应由一个函数处理，而第一个请求的响应稍后由另一个函数处理，因为首先收到响应的请求已将回调变量更改为引用第二个函数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-01T07:14:09.100

您正在谈论上面提到的@Chris Conway 在javascript中称为延迟的东西。同样，jQuery 从 v1.5 开始也有 Deferred。

检查这些[Deferred.when()](http://api.jquery.com/jQuery.when/)或[deferred.done()](http://api.jquery.com/deferred.done/)

不要忘记检查 jQuery 文档。

但是在这里给你一些想法是我从那个网站复制的。

```
$.when($.ajax("/page1.php"), $.ajax("/page2.php")).done(function(a1,  a2){
    /* a1 and a2 are arguments resolved for the 
        page1 and page2 ajax requests, respectively */
   var jqXHR = a1[2]; /* arguments are [ "success", statusText, jqXHR ] */
   if ( /Whip It/.test(jqXHR.responseText) ) {
      alert("First page has 'Whip It' somewhere.");
   }
}); 
```

//使用deferred.then()

```
$.when($.ajax("/page1.php"), $.ajax("/page2.php"))
 .then(myFunc, myFailure); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T14:32:43.330

像这样的东西（示意图）：

```
registerThread() {
  counter++;
}

unregisterThread() {
  if (--counter == 0) fireEvent('some_user_event');
}

eventHandler_for_some_user_event() {
   do_stuff();
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-05-30T19:59:04.477

您可以使用 Google 的[Closure 库](https://developers.google.com/closure/library/)轻松做到这一点，特别是[`goog.async.Deferred`](http://closure-library.googlecode.com/svn/docs/class_goog_async_Deferred.html)：

```
// Deferred is a container for an incomplete computation.
var ajaxFinished = goog.async.Deferred();

// ajaxCall is the asynchronous function we're calling.
ajaxCall( //args...,
    function() {  // callback
      // Process the results... 
      ajaxFinished.callback();  // Signal completion 
    }
);

// Do other stuff...

// Wait for the callback completion before proceeding
goog.async.when(ajaxFinished, function() {
    // Do the rest of the stuff...
}); 
```

`awaitDeferred`您可以使用、`chainDeferred`或连接多个异步计算`goog.async.DeferredList`。

# c# - 为什么会出现此错误：并非所有代码路径都返回值？

> ID：929608
> 
> 赞同：0
> 
> 时间：2009-05-30T11:52:04.370
> 
> 标签：c#, .net, visual-studio-2005, console-application

嗨，我是 c# 的新手，正在尝试编写代码，但出现错误有人可以帮我解决这个问题吗？

```
using System;
using System.Collections.Generic;
using System.Text;

namespace hodder
{
    class Program
    {
        public static void Main()
        {
            isHodder(3);
        }

        static int isHodder(int n)
        {
            int k = n;
            for (int i = 2; i <= n / 2;i++ )
            {
                if ((n % 1) == 0)
                {
                    return 0;
                }
                else
                {
                    for (int j = 2; j <= k;j++ )
                    {
                        if (n == (2^ j)  - 1)
                        {
                            return 1;
                        }
                        else
                        {
                            return 0;
                        }
                        k=(2^j)-1;
                    }
                }
            }
        }
    }
} 
```

我在“静态 int isHodder(int n)”'hodder.Program.isHodder(int)' 上遇到错误：并非所有代码路径都返回一个值

和“k=(2^j)-1”上的“检测到无法访问的代码”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T11:58:42.580

第一个错误，“不是所有的代码路径都返回一个值”意味着代码可以遵循一个不会返回任何值的路径（即：调用 isHodder(1)）。您需要在 for 循环之外返回一些值。此外，由于您在第二个 for 循环中有一个 if/else 块

```
k=(2^j)-1; 
```

永远不会被执行。

```
 static int isHodder(int n)
    {
        int k = n;
        for (int i = 2; i <= n / 2; i++)
        {
            if ((n % 1) == 0)
            {
                return 0;
            }
            else
            {
                for (int j = 2; j <= k; j++)
                {
                    if (n == (2 ^ j) - 1)
                    {
                        return 1;
                    }
                    else
                    {
                        return 0;
                    }
                    k = (2 ^ j) - 1;
                }
            }
        }
        return 0;
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T11:59:25.603

这条线是高度怀疑的：

```
if ((n % 1) == 0) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T13:22:53.080

如果我打电话会`isHodder(1)`怎样？我要达到哪个退货声明？

我们可能根本就不会进入 for 循环（或者如果我们进入了它，编译器就不能确定在我们离开循环之前我们是否到达了 return 语句）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T14:04:08.503

@jalf：关于 2 <= n/2（即 4<=n）的情况是正确的。在这种情况下，您永远不会进入*for*循环，因此您需要在`for`.

正如@Kenny 建议的那样，

```
if ((n % 1) == 0) 
```

有嫌疑。n % 1 总是 == n，所以只有当 n == 0 时条件才会成立。但是，这看起来也可能是一个错字，因为条件不会测试循环内变化的任何内容。你的意思

```
if ((n % i) == 0) 
```

?

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-04T11:28:51.740

对于这个问题，如果你的函数没有返回任何值，你必须使用 void ，否则你必须在函数末尾定义一个返回值。

# iphone - 在 iphone 中使用 Brautaset Json 框架时出错

> ID：929609
> 
> 赞同：5
> 
> 时间：2009-05-30T11:52:20.457
> 
> 标签：iphone, json, http

我正在尝试发出 http 请求。代码如下所示：

```
NSString *urlString = [NSString stringWithString:@"http://www.foo.se/bartojson.php?venue=47497"]; 

NSLog(@"retain %d urlString %@", [urlString retainCount], urlString );
    NSURL *url = [NSURL URLWithString:urlString];
    [urlString release];

    NSString *jsonString = [NSString stringWithContentsOfURL:url];
    NSDictionary *httpResult = [jsonString JSONValue]; 
```

在浏览器中调用页面时，结果如下所示：

{“名称”：“测试”，“描述”：“这是一个测试。” ,"reviews": [{"grade": "5", "description": "Nice"},{"grade": "3", "description": "非常好！"}]}

但是当从代码中调用它时，我得到了这个：

错误域 = org.brautaset.JSON.ErrorDomain 代码 = 3 UserInfo = 0x582640“键的对象值：评论”

指向新词典的评论似乎存在一些问题。你能帮我理解这个错误信息吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-04T12:14:13.830

好吧，我找到了错误的原因。结果中愚蠢的 Windows 换行符导致 JSONValue 调用失败。删除了所有 \r 和 viola 一切都像一个魅力！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-19T00:12:25.393

不知道这是不是一个错字，但您的示例不是有效的 JSON，因为“Nice”后面有逗号。JSON 不允许在数组或字典（“对象”）中使用尾随逗号。JSON.framework 肯定会引起人们的注意。

顺便说一句，如果您使用的是当前稳定版本的框架，如果您使用的是便捷方法，它将始终将失败的完整堆栈打印到控制台日志。否则，您可以向解析器对象询问完整的堆栈跟踪并自己打印。

# mysql - 如何在 mysql 中自定义“显示进程列表”？

> ID：929612
> 
> 赞同：212
> 
> 时间：2009-05-30T11:53:17.753
> 
> 标签：mysql, filter, sql-order-by, processlist

我想按时间订购，但似乎没有办法做到这一点？

```
mysql> show processlist;
+--------+-------------+--------------------+------+---------+--------+----------------------------------+------------------------------------------------------------------------------------------------------+
| Id     | User        | Host               | db   | Command | Time   | State                            | Info                                                                                                 |
+--------+-------------+--------------------+------+---------+--------+----------------------------------+------------------------------------------------------------------------------------------------------+
|      1 | system user |                    | NULL | Connect | 226953 | Waiting for master to send event | NULL                                                                                                 | 
|      2 | system user |                    | v3   | Connect |  35042 | Locked                           | update postings a
                                left join cities b on b.id=a.job_city_id
                                left join states h on h.id=b.stat | 
| 313888 | irnadmin    | 172.19.0.239:40136 | v3   | Sleep   |      0 |                                  | NULL                                                                                                 | 
| 314075 | irnadmin    | 172.19.0.239:41113 | v3   | Sleep   |      0 |                                  | NULL                                                                                                 | 
| 314118 | irnadmin    | 172.19.0.239:41282 | v3   | Query   |  34978 | freeing items                    | SELECT id, screen_name, type, active, bound, LastLogin, robotno, protocol FROM accounts WHERE email_ | 
| 314686 | irnadmin    | 172.19.0.239:43251 | v3   | Sleep   |      0 |                                  | NULL                                                                                                 | 
| 314732 | irnadmin    | 172.19.0.239:43436 | v3   | Query   |  34978 | freeing items                    | SELECT id, screen_name, type, active, bound, LastLogin, robotno, protocol FROM accounts WHERE email_ | 
| 314984 | irnadmin    | 172.19.0.239:44366 | v3   | Sleep   |      2 |                                  | NULL                                                                                                 | 
| 315051 | irnadmin    | 172.19.0.239:44713 | v3   | Query   |      0 | NULL                             | NULL                                                                                                 | 
| 315198 | irnadmin    | 172.19.0.239:51569 | v3   | Sleep   |      2 |                                  | NULL                                                                                                 | 
| 315280 | irnadmin    | 172.19.0.239:51849 | v3   | Query   |  34978 | freeing items                    | SELECT id, email_address, type, closed, robotno FROM accounts WHERE screen_name = 'ShantanuS'        | 
| 315320 | irnadmin    | 172.19.0.239:52045 | v3   | Query   |  34978 | freeing items                    | SELECT id, screen_name, type, active, bound, LastLogin, robotno, protocol FROM accounts WHERE email_ | 
| 315384 | irnadmin    | 172.19.0.239:52463 | v3   | Sleep   |      1 |                                  | NULL                                                                                                 | 
| 452248 | irnadmin    | 172.19.0.28:54899  | v3   | Query   |  34978 | freeing items                    | SELECT id, email_address, type, closed, robotno FROM accounts WHERE screen_name = 'LIZW0218'         | 
| 452291 | irnadmin    | 172.19.0.28:55045  | v3   | Sleep   |      1 |                                  | NULL                                                                                                 | 
| 452316 | irnadmin    | 172.19.0.28:55144  | v3   | Sleep   |      0 |                                  | NULL                                                                                                 | 
| 452353 | irnadmin    | 172.19.0.28:55278  | v3   | Sleep   |      0 |                                  | NULL                                                                                                 | 
| 452382 | irnadmin    | 172.19.0.28:55371  | v3   | Query   |  34978 | freeing items                    | SELECT o.account_id FROM online o JOIN accounts a ON a.id=o.account_id WHERE o.server_id IS NULL AND | 
| 452413 | irnadmin    | 172.19.0.28:55479  | v3   | Sleep   |      1 |                                  | NULL                                                                                                 | 
| 452541 | irnadmin    | 172.19.0.28:55946  | v3   | Query   |  34978 | freeing items                    | SELECT o.account_id FROM online o JOIN accounts a ON a.id=o.account_id WHERE o.server_id IS NULL AND | 
| 452626 | irnadmin    | 172.19.0.28:56215  | v3   | Sleep   |      2 |                                  | NULL                                                                                                 | 
| 452711 | irnadmin    | 172.19.0.28:39916  | v3   | Sleep   |      0 |                                  | NULL                                                                                                 | 
| 452781 | irnadmin    | 172.19.0.28:40161  | v3   | Sleep   |      1 |                                  | NULL                                                                                                 | 
| 452904 | irnadmin    | 172.19.0.28:40955  | v3   | Query   |  34978 | freeing items                    | select a.id, aa.screen_name, i.requester from interview_requests i left join accounts aa on aa.id=i. | 
| 453014 | irnadmin    | 172.19.0.28:41291  | v3   | Query   |  34978 | freeing items                    | SELECT o.account_id FROM online o JOIN accounts a ON a.id=o.account_id WHERE o.server_id IS NULL AND | 
| 453057 | irnadmin    | 172.19.0.28:41377  | v3   | Query   |  34978 | freeing items                    | select a.id, aa.screen_name, i.requester from interview_requests i left join accounts aa on aa.id=i. | 
| 453084 | irnadmin    | 172.19.0.28:41441  | v3   | Sleep   |      0 |                                  | NULL                                                                                                 | 
| 453112 | irnadmin    | 172.19.0.28:41536  | v3   | Sleep   |      0 |                                  | NULL                                                                                                 | 
| 453156 | irnadmin    | 172.19.0.28:41653  | v3   | Query   |  34978 | freeing items                    | SELECT protocol FROM accounts WHERE email_address= '***@gtalk.jabber.jobirn.c | 
| 453214 | irnadmin    | 172.19.0.28:41800  | v3   | Sleep   |      5 |                                  | NULL                                                                                                 | 
| 453243 | irnadmin    | 172.19.0.28:41991  | v3   | Sleep   |      0 |                                  | NULL                                                                                                 | 
| 453313 | irnadmin    | 172.19.0.28:42255  | v3   | Query   |  34978 | freeing items                    | SELECT o.account_id FROM online o JOIN accounts a ON a.id=o.account_id WHERE o.server_id IS NULL AND | 
| 453396 | irnadmin    | 172.19.0.28:53718  | v3   | Sleep   |      2 |                                  | NULL                                                                                                 | 
| 453476 | irnadmin    | 172.19.0.28:54019  | v3   | Sleep   |      0 |                                  | NULL                                                                                                 | 
| 453561 | irnadmin    | 172.19.0.28:54352  | v3   | Sleep   |      3 |                                  | NULL                                                                                                 | 
| 453594 | irnadmin    | 172.19.0.28:54456  | v3   | Sleep   |      0 |                                  | NULL                                                                                                 | 
| 453727 | irnadmin    | 172.19.0.28:55166  | v3   | Query   |  34978 | freeing items                    | SELECT id, screen_name, type, active, bound, LastLogin, robotno, protocol FROM accounts WHERE email_ | 
| 453786 | irnadmin    | 172.19.0.28:55320  | v3   | Sleep   |      4 |                                  | NULL                                                                                                 | 
| 610140 | irnadmin    | 172.19.0.28:33848  | v3   | Query   |  34978 | freeing items                    | select a.id, aa.screen_name, i.requester from interview_requests i left join accounts aa on aa.id=i. | 
| 685119 | irnadmin    | 172.19.0.27:37251  | v3   | Query   |  34980 | Sending data                     | select postings.id id,category, job_desc_title,
        IF(c1.name is not null,c1.name,IF(c2.name is not n | 
| 685226 | irnadmin    | 172.19.0.139:57274 | v3   | Query   |  34735 | Locked                           | SELECT job_desc_title,job_desc,job_state_name,job_city_name,company_categories.name,postings.categor | 
| 685229 | irnadmin    | 172.19.0.139:57278 | v3   | Query   |  34735 | Locked                           | SELECT job_desc_title,job_desc,job_state_name,job_city_name,company_categories.name,postings.categor | 
| 685232 | irnadmin    | 172.19.0.139:57283 | v3   | Query   |  34734 | Locked                           | select job_desc_title,job_desc from postings where id=287650                                         | 
| 685233 | irnadmin    | 172.19.0.139:57286 | v3   | Query   |  34734 | Locked                           | SELECT accounts.screen_name,postings.url url, accounts.type owner_type, postings.id ID, postings.job | 
| 685235 | irnadmin    | 172.19.0.28:37502  | v3   | Query   |  34734 | Locked                           | SELECT accounts.screen_name,postings.url url, accounts.type owner_type, postings.id ID, postings.job | 
| 686496 | irnadmin    | 172.19.0.239:33306 | v3   | Query   |  32589 | Locked                           | SELECT accounts.screen_name,postings.url url, accounts.type owner_type, postings.id ID, postings.job | 
| 686503 | irnadmin    | 172.19.0.28:54051  | v3   | Query   |  32588 | Locked                           | SELECT job_desc_title, job_desc, IF(postings.category IS NOT NULL, postings.category, job_categories | 
| 709550 | root        | localhost          | v3   | Query   |      0 | NULL                             | show processlist                                                                                     | 
| 710084 | irnadmin    | 172.19.0.27:53285  | NULL | Query   |      0 | removing tmp table               | show status where Variable_name='Threads_running'                                                    | 
+--------+-------------+--------------------+------+---------+--------+----------------------------------+------------------------------------------------------------------------------------------------------+
49 rows in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：386
> 
> 时间：2009-05-30T12:09:46.240

较新版本的 SQL 支持 information_schema 中的进程列表：

```
SELECT * FROM INFORMATION_SCHEMA.PROCESSLIST 
```

您可以以任何您喜欢的方式订购。

在 MySQL 5.1.7 中添加了 INFORMATION_SCHEMA.PROCESSLIST 表。您可以找出您正在使用的版本：

```
SELECT VERSION() 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2014-05-08T17:56:30.103

命令

```
show full processlist 
```

可以替换为：

```
SELECT * FROM information_schema.processlist 
```

但如果你使用后一个版本，你可以在`WHERE`其中添加子句：

```
SELECT * FROM information_schema.processlist WHERE `INFO` LIKE 'SELECT %'; 
```

欲了解更多信息，[请访问此](http://www.stetsenko.net/2011/08/mysql-how-to-add-where-clause-to-processlist/)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-01-30T12:31:30.943

来自命令行界面的另一个有用的工具是 pager 命令。

例如

```
pager grep -v Sleep | more; show full processlist; 
```

然后，您可以对结果进行分页。

您还可以通过这种方式使用 grep 或 sed 查找某些用户、IP 或查询。

pager 命令在每个会话中都是持久的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-30T11:58:44.047

您可以捕获输出并将其通过过滤器，例如：

```
mysql show processlist
    | grep -v '^\+\-\-'
    | grep -v '^| Id'
    | sort -n -k12 
```

这两个 grep 去掉了标题和尾行（如果有其他行不包含有用信息，则可能需要其他行），并且根据数字字段编号 12 进行排序（我认为这是正确的）。

这适用于您的即时输出：

```
mysql show processlist
    | grep -v '^\+\-\-'
    | grep -v '^| Id'
    | grep -v  '^[0-9][0-9]* rows in set '
    | grep -v '^ '
    | sort -n -k12 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-04-04T00:11:01.767

如果你使用旧版本的 MySQL，你总是可以使用 \P 结合一些不错的 awk 代码。有趣的例子在这里

[http://www.dbasquare.com/2012/03/28/how-to-work-with-a-long-process-list-in-mysql/](http://www.dbasquare.com/2012/03/28/how-to-work-with-a-long-process-list-in-mysql/)

这不正是您需要的吗？

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-21T19:04:59.223

...我们还没有更新版本的 MySQL，所以我能够做到这一点（仅适用于 UNIX）：

```
 host=maindb

 echo "show full processlist\G" | mysql -h$host | grep -B 6 -A 1 Locked 
```

以上将查询所有被锁定的会话，并返回涉及的信息和SQL。

...所以-假设您想查询正在休眠的会话：

```
 host=maindb

  echo "show full processlist\G" | mysql -h$host | grep -B 6 -A 1 Sleep 
```

或者，假设您需要为 MySQL 提供额外的连接参数：

```
 host=maindb

  user=me

  password=mycoolpassword 

  echo "show full processlist\G" | mysql -h$host -u$user -p$password | grep -B 6 -A 1 Locked 
```

通过一些调整，我确信可以轻松创建一个 shell 脚本来按照您想要的方式查询进程列表。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-11T14:41:46.580

使用“|” 作为分隔符

```
mysqladmin processlist| sort -t\| -n -k7 
```

来自 *排序*手册 ( `man sort`)

> ```
>  -k, --key=KEYDEF
>           sort via a key; KEYDEF gives location and type 
> ```

> ```
>  -t, --field-separator=SEP
>             use SEP instead of non-blank to blank transition 
> ```

> ```
>  -n, --numeric-sort
>           compare according to string numerical value 
> ```

> ```
>  -r, --reverse
>           reverse the result of comparisons 
> ```

# visual-studio-2008 - 重置 VS 2008 工具栏

> ID：929615
> 
> 赞同：6
> 
> 时间：2009-05-30T11:53:35.397
> 
> 标签：visual-studio-2008, toolbar

如何完全重置我的 Visual Studio 2008 工具栏？现在，当我编写代码与调试时，工具栏会随机出现/消失。这是预期的行为吗？

我想让它达到同一组工具栏出现并在工具栏区域中保持相同位置的程度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T12:05:42.800

您还可以运行以下命令之一（如果您无法在 VS 的命令行中运行它，请在 Windows 中运行常规命令提示符。作为管理员，如果您正在运行 Vista...）：

“温和”版本

```
devenv /resetskippkgs
devenv /resetsettings 
```

“硬核”版

```
devenv /setup 
```

这需要一些时间才能完成，所以请耐心等待......另外，请注意它会重置**所有**设置，而不仅仅是菜单。但是，如果您查看该`devenv`命令的文档，您可能会发现一个仅重置菜单选项的标志。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T12:02:58.843

在工具菜单上，选择导出和导入设置。这为您提供了许多选项，包括重置设置的选项。

话虽如此，VS 确实为调试保留了不同的工具栏集。因此，您所做的任何更改都必须对调试和正常设置进行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T11:55:48.450

是的，这很正常。

每个工具栏都有每个模式的视图设置，您应该手动更改它们以使其相同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-11-02T19:55:40.913

1.  到*工具 -> 导入导出设置*
2.  选择“导入选定的环境设置”，然后单击下一步
3.  选择“是，保存我当前的设置”，然后单击下一步
4.  选择一个默认值，然后单击下一步
5.  取消选择所有设置。选择*所有设置 -> 常规设置 -> 菜单和命令栏自定义*，然后单击完成

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T12:20:54.157

使用

> 开发环境/重置设置

或者这种类型的东西也会重置您每个配置的其他选项。对于像安排 GUI 这样微不足道的事情来说，这太激烈了。不久前我找到了一个更好的解决方案。

请参阅我对这个问题的最终答案：

[VS2008：调试时断点窗口消失了？](https://stackoverflow.com/questions/632761/vs2008-breakpoints-window-gone-while-debugging)

# .net - 在现有数据库中创建 ASP.Net 成员数据库结构

> ID：929637
> 
> 赞同：5
> 
> 时间：2009-05-30T12:07:42.123
> 
> 标签：.net, asp.net, asp.net-mvc

如何在已经包含数据（非冲突）的数据库中创建所有 ASP.Net 表、存储过程等。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-30T12:13:42.160

如果您有权访问数据库，请在命令行中运行以下命令：

```
cd "C:\Windows\Microsoft.NET\Framework\v2.0.50727"
aspnet_regsql 
```

这将启动一个指南，帮助您将所有表和存储过程添加到您可以从该计算机访问的任何表中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-30T12:14:46.290

从一篇关于[4GuysFromRolla](http://www.4guysfromrolla.com/articles/040506-1.aspx)的文章，转到`%WINDOWS%\Microsoft.NET\Framework\v2.0.50727\`目录并运行

`-- To use Windows Authentication (i.e., a "trusted connection"), use:`

`aspnet_regsql.exe -S <server> -E -d <database> -A all`

`-- To use SQL Server credentials (a UserID and Password), use:`

`aspnet_regsql.exe -S <server> -U <login id> -P <password> -d <database> -A all`

还有一个向导可以帮助您完成这些步骤。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T12:09:07.597

这应该可以帮助您：

[http://blog.krisvandermast.com/CreateMembershipTablesInAnotherDatabaseThanTheStandardAspnetdbmdf.aspx](http://blog.krisvandermast.com/CreateMembershipTablesInAnotherDatabaseThanTheStandardAspnetdbmdf.aspx)

# ruby - 相当于 Ruby 的 cURL？

> ID：929652
> 
> 赞同：71
> 
> 时间：2009-05-30T12:18:56.440
> 
> 标签：ruby, curl

是否有用于 Ruby 的 cURL 库？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-05-30T12:28:22.597

[Curb](https://taf2.github.io/curb/)和[Curl::Multi](https://github.com/kball/curl_multi.rb/)为 Ruby 提供 cURL 绑定。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2009-05-30T15:12:48.287

如果你不喜欢低级，还有[Typhoeus](https://github.com/typhoeus/typhoeus)，它建立在 Curl::Multi 之上。

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-05-30T12:52:30.397

使用[OpenURI](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/open-uri/rdoc/OpenURI.html)和

```
 open("http://...", :http_basic_authentication=>[user, password]) 
```

访问需要 HTTP 身份验证的站点/页面/资源。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-05-31T16:14:44.537

[Curb-fu](http://github.com/gdi/curb-fu/tree/master)是 Curb 的一个包装器，它反过来使用 libcurl。Curb-fu 比 Curb 提供什么？只是很多语法糖-但这通常是您所需要的。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-09-19T08:46:56.993

[HTTP 客户端](https://www.ruby-toolbox.com/categories/http_clients)是一个很好的页面，可以帮助您对各种客户端做出决策。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-31T05:59:17.993

你也可以看看[Rest-Client](https://github.com/rest-client/rest-client)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2013-01-29T16:43:59.863

gem 是 OpenURI的[`eat`](https://github.com/seamusabshere/eat)“替代品”，因此您需要首先安装`eat`gem

```
$ gem install eat 
```

现在你可以使用它了

```
require 'eat'
eat('http://yahoo.com')                 #=> String
eat('/home/seamus/foo.txt')             #=> String
eat('file:///home/seamus/foo.txt')      #=> String 
```

它在底层使用[HTTPClient](https://github.com/nahi/httpclient)。它还有一些选项：

```
eat('http://yahoo.com', :timeout => 10)                   # timeout after 10 seconds
eat('http://yahoo.com', :limit => 1024)                   # only read the first 1024 chars
eat('https://yahoo.com', :openssl_verify_mode => 'none')  # don't bother verifying SSL certificate 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2016-06-09T15:19:11.733

如果你知道如何将你的请求写成`curl`命令，有一个在线工具可以把它变成 ruby​​ (2.0+) 代码：[curl-to-ruby](https://jhawthorn.github.io/curl-to-ruby/)

目前，它知道以下选项：`-d/--data`、`-H/--header`、`-I/--head`、`-u/--user`、`--url`、 和`-X/--request`。它对[捐款开放](https://github.com/jhawthorn/curl-to-ruby)。

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2009-05-31T05:55:33.023

还有[Mechanize](https://rubydoc.info/gems/mechanize/Mechanize)，这是一个非常高级的网络抓取客户端，它使用 Nokogiri 进行 HTML 解析。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2014-04-18T03:18:14.200

这是我编写的一个小程序，用于获取一些文件。

```
base = "http://media.pragprog.com/titles/ruby3/code/samples/tutthreads_"

for i in 1..50

  url = "#{ base }#{ i }.rb"
  file = "tutthreads_#{i}.rb"

  File.open(file, 'w') do |f|   
    system "curl -o #{f.path} #{url}"
  end

end 
```

我知道它可能会更有说服力，但它服务于它的目的。看看这个。我今天只是拼凑起来，因为我厌倦了去每个 URL 获取源代码下载中未包含的书的代码。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2011-04-06T05:58:27.210

添加一个更新的答案，[HTTPClient](https://github.com/nahi/httpclient)是另一个使用 libcurl 的 Ruby 库，支持并行线程和许多 curl 好东西。我将 HTTPClient 和 Typhoeus 用于任何重要的应用程序。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-11-28T22:12:47.280

说起来可能太明显了，刻度线也在 Ruby 中执行 shell 代码。假设您的 Ruby 代码在具有以下特性的 shell 中运行`curl`：

```
puts `curl http://www.google.com?q=hello` 
```

或者

```
result = `
  curl -X POST https://www.myurl.com/users \
  -d "name=pat" \
  -d "age=21"
` 
puts result 
```

# ms-access - (IIS) 7 配置 - 可视化 Web 开发人员

> ID：929656
> 
> 赞同：0
> 
> 时间：2009-05-30T12:22:41.813
> 
> 标签：ms-access, iis, asp-classic, iis-7, visual-web-developer

我开发小型网络基础`ASP`应用程序，这些应用程序基本上存储和显示来自后端的数据`MsAccess database`。

应用程序网站是在我的本地机器上开发和测试的（完成的工作最终会发布到公司的 Web 服务器）。

为了在我的 XP 机器上运行开发 Web 服务器，我没有加载任何额外的软件。我相信我正在运行 IIS 5？并且此设置正在运行 100%。

我刚刚加载了一个**Visual Web Developer – Express Edition**来帮助我的开发，经过两个小时的安装时间，它似乎让我升级到了我的 IIS（到版本 7），而没有通知我是否要加载它。

现在我机器上的所有开发 .asp 页面不再运行。

注意：初始页面出现，但每当我点击“提交”按钮时，我都会收到错误消息：

> 目标页面找不到或不再可用

这是 IIS 7 配置问题吗？

我该去哪里更改配置？需要更改什么才能让 .asp 页面“发布”？

如果是 IIS，我可以卸载 IIS 7 并返回到旧版本吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T12:33:58.640

默认情况下禁用 IIS7 ASP。您需要在 IIS7 配置中激活它。我相信它是一个 ISAPI 模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T12:41:53.723

您运行的是哪个版本的 Windows XP？如果您有低于 Proffessional 的任何东西，您可能升级到 II6 而不是 II7 - 较小版本没有 II7。

如果您有 II7，请继续进行操作。（我运行的是 Vista，但我相信这些配置工具看起来大致相同）。

1.  从管理工具（在开始/程序下）打开 IIS 管理器

2.  展开您的 Web 服务器（具有本地计算机名称的节点），然后展开站点并选择要为其激活 ASP 的站点。

3.  在“IIS”下有一个名为“ASP”的设置。在配置工具的右侧有一个标有“操作”的栏 - 我相信您需要`Start`在“管理网站”下找到该选项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T02:13:51.523

IIS 是操作系统的一部分。因此，除非您升级操作系统，否则它将保持旧版本。

如果您使用的是 32 位 Windows XP，那么 IIS 5.1 就在那里。如果您使用的是 Windows XP 64 位，那么 IIS 6\. 就在那里。

一点是Visual Web Developer主要是为ASP.NET开发的。因此，如果您正在开发经典的 ASP，它并没有多大帮助。

如果现在你所有的经典 ASP 页面都失败了，你能用一个简单的 hello world 页面进行测试吗？如果您可以毫无问题地看到该页面，那么实际上 IIS 服务于 ASP 没有问题。

# gwt - 同一模块中有多个入口点的问题

> ID：929661
> 
> 赞同：9
> 
> 时间：2009-05-30T12:28:37.137
> 
> 标签：gwt, module, project-structure, entry-point

我在同一个模块中有多个入口点。

例如，我有一个主页入口点和管理页面的管理入口点。

```
<entry-point class='com.company.project.client.HomeModule'/> 
<entry-point class='com.company.project.client.AdminModule'/> 
```

我现在的设置方式 - 我需要在我的 OnModuleLoad 中检查 somt：

```
if((RootPanel.get("someHomeWidget")!=null)&& 
  (RootPanel.get("someOtherHomeWidget")!=null)) 
{ 
  // do the stuff 
} 
```

为了在主页打开时不执行管理入口点，反之亦然。

不进行上述检查还涉及如果我在主页和管理页面中有一个同名的 div，无论我在其中注入什么，都会在每个页面上显示两次。

这在 1000 英里外很臭，显然是错误的：在人们的经验中，这样做的正确方法是什么？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-31T00:27:49.803

正确的方法是每个模块有一个入口点，将适当的小部件粘贴在适当的 div 中：

```
RootPanel panel = RootPanel.get("someHomeWidget");
if (panel) panel.add(new HomeWidget());

panel = RootPanel.get("adminWidget");
if (panel) panel.add(new AdminWidget()); 
```

这样，它只会扫描页面以查找您拥有的任何 div 并插入适当的小部件。因此，您的 HTML 页面决定了何时显示哪些小部件，并且 GWT 代码已准备好处理任何情况。上面没有什么不好的，这是你的入口点应该写的方式。

另一种选择是，如果您的管理区域和通常区域完全不同（例如：您想在不同的时间加载它们），那么它们应该是单独的模块，具有单独的入口点。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-10-08T04:51:00.873

我还想在 GWT 玩具应用程序中使用多个页面，我想我想通了。它需要对部署描述符（myApp.gwt.xml）进行一些按摩，但这就是我所做的。

*   制作了另一个实现 EntryPoint 的类，并添加了一些仅在新页面中添加到 div 的代码。
*   复制了原来的gwt.xml，改了两处：
    *   模块重命名为 - 我改为“anothergwtapp”
    *   入口点指定了新类。
*   当我编译项目时，“war”文件夹中有另一个目录，称为（等待它......）“anothergwtapp”。它包含 GWT 魔法“anothergwtapp.nocache.js”。
*   最后，我复制了原始 HTML 页面并将“stockwatcher/stockwatcher.nocache.js”替换为“anothergwtapp/anothergwtapp.nocache.js”（是的，我很新——教程还在我的机器上）
    *   我将新的 HTML 更改为稍有不同（用于填充新入口点的新 div），并在第一页的新页面中添加了一个简单的 href。

有效。只需复制 gwt.xml 并为模块提供一个新名称以与新的应用程序页面一起使用。我查看了其他一些链接，实际上我可能已经完成了所描述的内容，但是有太多的单词和重定向等（即我并没有真正阅读任何内容）。我正在为 Galileo 使用最新的 GWT 插件，所以现在可能是 IJW。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T06:20:17.863

不要将管理和主页视为不同的页面。页面的概念不适用于 GWT，因为只有一个页面，即单个入口点。如果你想赋予不同页面的效果，那么使用 GWT 的 URL 重写特性。

如果您确实想使用不同的入口点，那么如上面评论中所述，使用不同的模块。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-12T07:23:36.893

通常最好只有一个入口点。一个模块中的多个入口点都同时启动，有时会做一些你没想到的事情。

在如何分别处理它时，您有很多选择： - 有 2 种不同的编译，一种用于 Admin，一种用于 Home 应用程序。- 使用历史标记来指示您想要管理员或主页 - 检查 JS 变量以显示其中一个 - 检查特定 DIV id 的存在以显示管理员或主页 (RootPanel.get(id)) - 使用 URL 参数来表明申请。- ... ETC

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-12-14T12:29:24.847

有一个简单（棘手）的方法来实现这一点：

将 Main 类设为您的切入点。

```
<module rename-to='gwt'>
  <inherits name='com.google.gwt.user.User'/>
  <entry-point class='com.example.client.Main'/>
  <source path='client'/>
  <source path='shared'/>
</module>;<br/> 
```

创建此 Main.java 以像调度程序一样工作：

```
package com.example.client;

import com.google.gwt.core.client.EntryPoint;
import com.google.gwt.user.client.Window;
import com.google.gwt.user.client.ui.RootPanel;

public class Main implements EntryPoint {

  public void onModuleLoad() {

    String url = Window.Location.getHref();
    if ( url.indexOf("?install")>-1 ) {
      Install install = Install.getInstance();
      RootPanel.get().add(install);      
    else if ( url.indexOf("?admin")>-1 ) {
      Admin admin = Admin.getInstance();
      RootPanel.get().add(admin);    
    } else {
      Application app = Application.getInstance();
      RootPanel.get().add(app);      
    }
  }
} 
```

现在，不同的类 Application、Admin 和 Install 像单独的单元一样工作。

这是一个简单的安装示例：

```
package comexample.client;

import com.google.gwt.user.client.ui.FlowPanel;
import com.google.gwt.user.client.ui.HTML;

public class Install extends FlowPanel {

  /** Singleton stuff - to access Main from all subclasses! */
  private static Install singelton;
  public static Install getInstance() {
    if (singelton == null) {singelton = new Install();}
    return singelton;
  }

  /** Constructor - called by Main.onModuleLoad() */
  private Install() {
    this.add(new HTML("<h1>Do whatever You have to do!</h1>"));
  }
} 
```

您不需要 Singleton 的东西 (getInstance)，但它在大型应用程序中非常方便。

现在在 /war-directory 中创建名为 install 和 admin 的目录，并在其中创建一个 HTML 页面，如下所示：

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="refresh" content="0; URL=/index.html?install">
</head>
<body></body>
</html> 
```

因此，当用户将他的浏览器指向[http://www.example.com/install](http://www.example.com/install)时，他将被重定向到[http://www.example.com/index?install](http://www.example.com/index?install)并且 index.html 绑定到将调度的 Main.java请求并加载 Install.java

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-10T20:33:50.623

我的博客上有一个解决方案。您可以下载具有多个入口点并使用 url-rewriting 的示例 maven 项目。看看：http: [//zenoconsulting.wikidot.com/blog :16](http://zenoconsulting.wikidot.com/blog:16)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-01T20:56:12.680

你试过这个框架了吗？ [http://gwtmultipage.org/](http://gwtmultipage.org/) 克劳迪斯

# jquery - 查找特定元素之前和之后的元素

> ID：929670
> 
> 赞同：38
> 
> 时间：2009-05-30T12:34:28.000
> 
> 标签：jquery, traversal

我有一个列表，其中包含与选项卡一起使用的链接。它看起来像这样：

```
<ul>
    <li><a href="#">First tab</a></li>
    <li><a href="#">Second tab</a></li>
    <li class="active"><a href="#">Active tab</a></li>
    <li><a href="#">Fourth tab</a></li>
    <li><a href="#">Fifth tab</a></li>
</ul> 
```

如何在活动选项卡之前和之后找到列表元素？（在这种情况下，第二个和第四个选项卡）。

尝试使用find，没有成功:(

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-05-30T12:38:17.570

```
$("li.active").next(); 
```

和

```
$("li.active").prev(); 
```

# ajax - 同域策略究竟是如何执行的？

> ID：929677
> 
> 赞同：13
> 
> 时间：2009-05-30T12:40:25.973
> 
> 标签：ajax, subdomain, xss

假设我有一个域 ，`js.mydomain.com`它指向某个 IP 地址，而另一个域 ，`requests.mydomain.com`，它指向不同的 IP 地址。可以从发出 Ajax 请求`.js`下载的文件吗？`js.mydomain.com``requests.mydomain.com`

现代浏览器究竟是如何执行同域策略的？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-30T12:49:16.580

对您的问题的简短回答是否定的：对于 AJAX 调用，您只能访问与加载页面相同的主机名（和端口/方案）。

有两种解决方法：一种是创建一个 URL `foo.example.com`，作为`bar.example.com`. 只要主机名匹配，浏览器并不关心请求在哪里实际完成。如果您已经有一个前端 Apache 网络服务器，这不会太难。

另一种选择是[AJAST](http://ajast.org/ajast/main)，它通过将脚本标签插入文档来工作。我相信这就是 Google API 的工作方式。

您可以在此处找到关于同源策略的详细说明：[http ://code.google.com/p/browsersec/wiki/Part2](http://code.google.com/p/browsersec/wiki/Part2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T12:48:11.527

这不起作用，因为主机名不同。如果两个页面具有相同的主机、协议和端口，则认为它们来自同一来源。

来自维基百科[的同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)：

> 术语“来源”是使用域名、应用层协议和（在大多数浏览器中）运行脚本的 HTML 文档的 TCP 端口来定义的。当且仅当所有这些值完全相同时，才认为两个资源具有相同的来源。

# css - CSS是否在单独的文件中？

> ID：929683
> 
> 赞同：10
> 
> 时间：2009-05-30T12:45:13.953
> 
> 标签：css, dynamic

哪个是更好的选择：将 CSS 存储在单独的文件或同一页面上？

让我们忘记更改文件上的 CSS 会使其直接应用所有 HTML 页面这一事实。我正在使用动态语言来生成整个输出 - 所以这并不重要。

我能想到的几点：

1.  单独文件上的 CSS 会产生较少的带宽负载。
2.  单独文件上的 CSS 需要另一个 HTTP 请求。

另一方面，如果我用 Zlib 压缩数据传输，同一页面上的 CSS 在带宽方面应该无关紧要，对吗？那么，我得到的 HTTP 请求少了吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-05-30T12:47:38.347

外部 CSS 文件的主要好处是：

*   它可以在多个页面上使用；和
*   它可以被缓存，因此不需要在每个页面上都加载它。

因此，如果有可能在页面之间或同一页面的多个视图上重用动态生成的 CSS，那么外部文件可以增加价值。

动态生成的 CSS 有几种常见的模式。

**1.为页面生成子集**

我偶尔看到过这种情况。开发人员决定通过仅发送必要的内容来限制每页的 CSS 数量。我不认为这是你的情况，但我提到它是为了完整性。这是一种错误的优化努力。发送整个批次并有效地缓存它会更便宜。

**2.用户选择的主题**

如果用户为您的网站选择了特定的外观，这就是我所说的。这意味着他们可能会选择一整套 CSS，并且可能只有有限的一组可供选择。通常这将通过拥有一个或多个基本 CSS 文件，然后拥有一个或多个主题 CSS 文件来完成。这里最好的解决方案是通过动态生成具有正确元素的页眉`<link>`然后有效地缓存这些文件来发送外部 CSS 文件的正确组合。

**3.用户滚动的主题**

这超出了 (2) 的范围，用户可以选择颜色、字体和大小，以至于您无法将这些选择打包到单个主题包中，但您必须为该用户生成一组 CSS。在这种情况下，您可能仍然有一些常见的 CSS。将其作为外部 CSS 文件发送（同样有效地缓存它们）。

动态内容可能在页面上最好，或者您仍然可以使用外部文件，因为**没有理由`<link>`不能指向脚本而不是静态文件**。例如：

```
<link rel="stylesheet" href="/css/custom.php?user=bob" type="text/css"> 
```

查询字符串由登录者的标头动态生成。该脚本将查找用户首选项并生成动态 CSS 文件。这可以有效地缓存，而不能将其直接放入 HTML 文件中（除非可以有效地缓存整个 HTML 文件）。

**4\. 基于规则的 CSS 生成**

在此之前，我编写了一个报告系统，该系统采用了用户或报告编写者指定的许多规则和一个自定义报告，并生成了一个完整的 HTML 页面（基于他们在自定义报告定义中请求的表格和/或图表）并根据规则对它们进行样式化。这确实是动态 CSS。问题是，这里也有缓存的潜力。HTML 页面生成一个动态链接，如下所示：

```
<link rel="stylesheet" href="/css/report.annual-sales.0001.css" type="text/css"> 
```

其中 'annual-sales' 是报告 ID，0001 类似于版本。当规则更改时，您会创建一个新版本，并且可以有效地缓存每个报告的每个版本。

**结论**

所以我不能明确地说外部 CSS 文件是否适合你，但是在看过并为上面的每个场景开发之后，我很难相信你不能从你的 CSS 中获得某种形式的缓存点它应该是外部的。

我[在 PHP 中的 Supercharging CSS 中](http://www.cforcoding.com/2009/05/supercharging-css-in-php.html)写过关于有效 CSS 的问题，但这些原则和技术适用于任何语言，而不仅仅是 PHP。

您可能还想参考相关问题[Multiple javascript/css files: best practice?](https://stackoverflow.com/questions/490618/multiple-javascript-css-files-best-practices)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-30T15:27:00.070

谷歌和雅虎都有一种从内联 CSS 中受益的方法。第一次访问者为了快速加载，他们在 HTML 中嵌入 CSS（甚至是 JavaScript），然后在后台下载单独的 CSS 和 JS 文件以供下次使用。

[Steve Souders（雅虎！）写道](http://developer.yahoo.net/blog/archives/2007/07/rule_8_make_jav.html)：

> [...] 最好的解决方案通常是将 JavaScript 和 CSS 部署为外部文件。我见过的唯一一个更喜欢内联的例外是主页，例如 Yahoo! 的首页 ( [http://www.yahoo.com](http://www.yahoo.com) ) 和 My Yahoo! （[http://my.yahoo.com](http://my.yahoo.com)）。每个会话只有很少（可能只有一次）页面查看的主页可能会发现内联 JavaScript 和 CSS 可以加快最终用户的响应时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T12:50:20.383

浏览器可以缓存 CSS 文件（除非更改很多）。带宽不应该改变，因为信息是发送的，无论你把它放在哪里。

因此，除非 css 非常静态，否则将其放在页面中花费更少的时间来获取。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T12:54:47.413

我总是混合使用两者。

*   站点范围的样式在单独的文件中（[缩小](http://developer.yahoo.com/yui/compressor/)和[压缩](http://httpd.apache.org/docs/2.0/mod/mod_deflate.html)），
*   放入任何特定于页面的样式`<style>`（我已经设置了我的页面模板，以便随时轻松插入 CSS 位`<head>`）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T18:11:33.657

如果您正在动态生成 HTML（例如，从模板），嵌入 CSS 使您有机会使用与生成 HTML 时相同的上下文（数据、程序状态）动态生成 CSS，而不是让在后续请求中再次设置相同的上下文以生成 CSS。

例如，考虑一个使用数百张图像中的一张作为背景的页面，这取决于某些计算成本很高的状态。你可以

1.  在一个单独的静态 CSS 文件中列出规则中的所有数百个图像，然后在动态 HTML 中生成相应的类名，或者
2.  使用单个类名生成 HTML，然后在后续请求中生成带有使用所需图像的该名称的规则的 CSS，或
3.  执行 (2)，但在单个请求中生成嵌入在 HTML 中的 CSS

(1) 避免重做昂贵的状态计算，但对流量的影响更大（移动更大的 CSS 文件需要更多的数据包）。(2) 进行两次状态计算，但提供较小的 CSS 文件。只有 (3) 进行一次状态计算并在单个 HTTP 请求中提供结果。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-31T01:01:59.220

是和不是。对大多数规则使用 .css 文件；无论如何，您的网站应该具有一致的外观。对于罕见的、特殊情况或动态生成的规则，您可以使用内联 'style=""'。如果只是为了使嵌入、混搭等更容易，任何粘住的东西都应该移到 .css 中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-30T15:11:36.340

保持分开。HTML 代表 centent，CSS 代表样式，JavaScript 代表逻辑。

# sql - 是否有适用于世界所有地址的通用街道地址数据库设计？

> ID：929684
> 
> 赞同：132
> 
> 时间：2009-05-30T12:47:12.153
> 
> 标签：sql, database-design, street-address, postal-code

我是一名程序员，需要一种实用的方法来将世界的街道地址结构存储在数据库中。那么存储街道地址的最佳和通用数据库设计是什么？它应该易于使用、快速查询和动态存储世界上所有的街道地址。

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2009-05-30T22:57:21.733

可以在一组标准字段中表示来自许多不同国家的地址。命名或编号建筑物所在的命名通道（通道）的基本概念是相当标准的，有时在中国除外。其他近乎普遍的概念包括： 命名定居点（城市/城镇/村庄），通常可以称为地方；命名该地区并分配一个字母数字邮政编码。请注意，邮政编码（也称为邮政编码）仅在某些国家/地区是纯数字的。如果您真的想要通用，您将需要很多字段。

万国邮政联盟 (UPU) 以[标准格式](https://upu.int/en/Postal-Solutions/Programmes-Services/Addressing-Solutions)为许多国家/地区提供地址数据。请注意，万国邮联格式包含整个国家的所有地址（直至可用字段精度），因此它是相关的。如果存储客户地址，其中仅存储所有可能地址的一小部分，最好使用包含所有字段和每行一个地址的单个表（或平面格式）。

存储地址的合理格式如下：

*   地址行 1-4
*   地方性
*   地区
*   邮政编码（或邮政编码）
*   国家

地址行 1-4 可以包含以下组件：

*   建造
*   子楼
*   房屋号码（门牌号）
*   前提范围
*   通道
*   次通道
*   双重依赖的地方
*   次区域

通常只使用 3 条地址线，但这通常是不够的。当然可以要求更多行来表示官方格式的所有地址，但逗号始终可以用作行分隔符，这意味着仍然可以捕获信息。

通常数据的分析会按地点、地区、邮政编码和国家进行，这些元素在用户输入数据时很容易理解。这就是为什么这些元素应该存储为单独的字段。但是，不要强迫用户提供邮政编码或地区，它们可能不会在本地使用。

地点可能不清楚，尤其是地图地点和邮政地点之间的区别。邮政地区是邮政当局认定的地区，有时可能是附近的大城镇。但是，邮政编码通常会解决那里的任何问题或差异，即使没有使用官方邮政地址，也可以正确交付。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-05-30T12:50:22.833

看看[数据库答案](http://www.databaseanswers.org/data_models/customers_and_addresses/index.htm)。具体来说，这涵盖了许多情况：

（所有可变长度字符数据类型）

```
AddressId
Line1
Line2
Line3
City
ZipOrPostcode
StateProvinceCounty
CountryId
OtherAddressDetails 
```

[![在此处输入图像描述](https://i.stack.imgur.com/VGzMy.gif)](https://i.stack.imgur.com/VGzMy.gif)

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2009-05-30T19:51:35.383

问问自己存储这些数据的主要**目的是什么？**您是否打算实际向该地址的人发送邮件？跟踪人口统计、人口？作为一些基本身份验证/验证的一部分，能否向呼叫者询问他们的正确地址？上述所有的？以上都不是？

根据您的实际需要，您将确定 a) 它并不重要，您可以采用自由文本方法，或 b) 所有国家/地区的结构化/特定字段，或 c) 国家/地区特定架构。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-06-02T11:04:35.330

有时，您可以到达的最接近街道地址的是城市。

我曾经有一个项目将印度所有的中学都放在谷歌地图上。我使用 Google API 编写了一个漂亮的程序，并认为它会很容易。

然后我从客户那里得到数据。一些学校地址是“市场对面，理发店旁边”或“旧巴士站附近”之类的东西。

这让我的任务变得更加困难，因为不幸的是，Google API 不支持这种格式。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-05-30T22:43:17.330

对于国际地址，如果将信息分解为字段，则很难找到一种方法来格式化信息。例如，意大利地址使用：

```
<street address>
<zip> <town> <region>
<country> 
```

如

```
Via Eroi della Repubblica
89861 Tropea VV
Italy 
```

这与美国地址的顺序大不相同 - 在第二行。

另请参阅 SO 问题：

*   [您将为英国数据库使用多少地址字段？](https://stackoverflow.com/questions/373084/how-many-address-fields-would-you-use-for-a-uk-database)
*   [您是否将地址分解为街道/城市/州/邮编？](https://stackoverflow.com/questions/249156/do-you-break-up-addresses-into-street-city-state-zip)
*   [你如何处理重复的街道后缀？](https://stackoverflow.com/questions/510078/how-do-you-deal-with-duplicate-street-suffixes)
*   [在数据库 (RDBMS) 中存储邮政地址的最佳实践？](https://stackoverflow.com/questions/310540/best-practices-for-storing-postal-addresses-in-a-database-rdbms)

另请查看标签“[邮政编码](https://stackoverflow.com/questions/tagged/postal-code)”。

* * *

*编辑*：地区和城镇的倒序 - 每个[万国邮联](http://www.upu.int/post_code/en/postal_addressing_systems_member_countries.shtml)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2010-12-15T20:40:43.163

也许这很有用： [https](https://gist.github.com/259744) ://gist.github.com/259744 对于一个项目，我收集了一张关于世界所有国家/地区的信息表，包括 ISO 代码、顶级域、电话代码、汽车标志、长度和正则表达式压缩。不幸的是，国名和评论只有德语......

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-30T13:01:39.940

与这里的其他答案不同，我相信可以拥有一个结构化的地址数据库。

刚出帽子，我可以想到以下结构：

*   国家
*   地区（州/省）
*   地区（市/市）
*   次地区（县/地区的其他细分）
*   街道

但是如何足够快地查询呢？

我一直认为可以实现的一种方法是询问邮政编码（或邮政编码），它因国家而异，但在国内是可靠的。

通过这种方式，您可以围绕世界各地邮局提供的信息构建数据。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-05-30T12:50:39.543

不，绝对不是。如果您比较美国和[日本地址](http://www.worldwide-tax.com/japan/japaddresses.asp)的工作方式，您会发现这是不可能的。

更新：

再想一想，任何事情都可以做，但有一个权衡。

一种方法是使用 address 和 address_attribute 表对问题进行建模，它们之间具有 1:m 的关系，任何东西都可以建模。address_attribute 表将包含一个 pk、一个名称、一个值和一个指向其地址父级 pk 的 fk。这几乎就像使用带有名称、值对的 Map 一样。

每次您想要一个地址时，都必须进行一次 JOIN 操作。您还必须询问 address_attributes 的名称以弄清楚您每次处理的内容。

另一种方法是对全球地址的建模方式进行更全面的研究。在面向对象的世界中，您可能拥有西方地址类 (street1/street2/city/state/zip) 以及日本、中国的其他地址类，根据需要平铺地址空间。然后，您将拥有一个主地址表和其他类型的子表，它们之间具有 1:1 的关系。

亚马逊或易趣如何做到这一点？他们在国际上运送。他们是否具有特定于语言环境的 UI 功能？我只使用了美国语言环境。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-05-30T12:51:40.990

取决于您准备使用这些字段的自由形式。一个自由格式的地址字段显然总是可以的，但对缩小地理范围的帮助相对较小。

您将遇到的问题是，不同国家/地区的地理等级差异太大。哎呀，有些国家甚至没有到处都有“街道地址”。

我建议你不要试图让它太聪明。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-30T13:02:13.513

[Universal Data Model](http://www.univdata.com/)的 Len Silverston推荐了一个单独的层次结构，`GEOGRAPHIC BOUNDARIES`这取决于您愿意接受简单`STREET ADDRESS LINE`的 s 或每个国家/地区的衍生品的自由度。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-08-23T13:44:06.297

不，没有标准的寻址方案。它通常因国家而异。就连**万国邮政联盟**在“ [Adressing the world, a address for everyone](http://www.upu.int/fileadmin/documentsFiles/activities/addressingAssistance/paperAddressingAddressingTheWorldAnAddressForEveryoneEn.pdf) ”一文中也说没有。[对此的最佳解决方案是使用称为ISO 3166](http://www.iso.org/iso/country_names_and_code_elements)的 2/3 个字母的国家代码标准，并按国家标准处理其他所有内容。

但是，如果您真的很想为您的项目使用易于访问的工具，您可以尝试[Google Place API](https://developers.google.com/places/documentation/)。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-06-02T10:30:21.873

你的设计应该很大程度上取决于你的目的。有些人发布了如何构造数据。因此，如果您只是想向某人发送 s-mail，它就可以了。如果您想使用这些数据进行导航，事情就会变得复杂。汽车导航将需要额外的结构来包含交通信息（例如单向道路），而步行导航将需要大量额外的数据。这是一个小例子：在我的城市，我的社区靠近公园。公园旁边是前机场（实际上是欧洲最古老的机场之一）变成了航空博物馆。航空博物馆旁边是一个商业园区。博物馆的门牌号是 39，而商业园的门牌号是 39A。所以看起来 39 和 39A 似乎很近——但从一个到另一个步行大约需要一英里（如果开车去，甚至更长）。
这只是我所在城市的一个小例子，我认为您可能会发现很多例外情况（尤其是在每个国家的农村或荒野地区）。

# xaml - 将输出 XAML 的最佳 XPS WYSIWYG 编辑器是什么？

> ID：929695
> 
> 赞同：2
> 
> 时间：2009-05-30T12:51:42.550
> 
> 标签：xaml, wysiwyg, xps

我正在寻找将输出原始 XAML 的 XPS 所见即所得。

我的意图是使用该工具快速生成和测试 XAML（XPS 文档），然后在代码中生成相同的 xaml 并以编程方式生成 XPS 文档。许多人用于生成 html 的方法相同。

任何人都可以推荐以下任何产品或建议任何其他产品吗？更好的是，有人知道免费的 XPS 编辑器吗？

*   NiXPS 编辑 300 美元[http://www.nixps.com/nixps_edit_20.html](http://www.nixps.com/nixps_edit_20.html)
*   XamlPad 是免费的，但也非常有限，并不真正针对 XPS。
*   Office System Power Tools 不是所见即所得[http://blogs.msdn.com/adrianford/archive/2008/07/03/visual-studio-and-xps-files.aspx](http://blogs.msdn.com/adrianford/archive/2008/07/03/visual-studio-and-xps-files.aspx)
*   XPS eXaminer 1.0 399 美元 [http://storefront.qualitylogic.com/p-16-qualitylogic-xps-examiner.aspx](http://storefront.qualitylogic.com/p-16-qualitylogic-xps-examiner.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T13:48:58.783

您可以尝试只使用 MS Word 2007，然后导出到 XPS。将 .xps 文件重命名为 .zip，您将在解压缩时看到原始 xps 数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-01T14:06:08.677

祝你好运。XPS 文档不包含带有 TextBlocks 和其他舒适 WPF 控件的 FixedPages。它的所有画布都带有字形。用于在代码中构建 XPS 文档的真正低级表示。至少在使用 XpsWriter 创建文档时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-08T01:10:55.200

如果您有 Adob​​e Illustrator（599 美元；30 天免费试用），您可以使用 Michael Swanson 的[Adob​​e Illustrator XAML 导出模块](http://www.mikeswanson.com/xamlexport/)。

# java - 如何在 JMX 中查询 J2EEServer MBean？

> ID：929701
> 
> 赞同：2
> 
> 时间：2009-05-30T12:56:43.633
> 
> 标签：java, jakarta-ee, jmx

如何使用 JMX 查询获取 J2EEServer MBean？

我试过类似的东西：

```
mbsc.queryMBeans(new ObjectName("*:j2eeType=J2EEServer"), null) 
```

但没有成功？

我做错了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-30T13:12:33.570

这会变魔术：

```
 mbeanServerConnection.queryNames(new ObjectName("*:j2eeType=J2EEServer,*"),null ) 
```

# pagination - 在宁静的网址上编码分页信息的标准方法得到？

> ID：929702
> 
> 赞同：5
> 
> 时间：2009-05-30T12:57:40.090
> 
> 标签：pagination, rest, friendly-url

我认为我的问题可以用几个例子更好地解释......

GET [http://myservice/myresource/?name=xxx&country=xxxx&_page=3&_page_len=10&_order=name](http://myservice/myresource/?name=xxx&country=xxxx&_page=3&_page_len=10&_order=name) asc

也就是说，一方面我有条件（ name=xxx&country=xxxx ），另一方面我有影响查询的参数（ _page=3&_page_len=10&_order=name asc ）

现在，我想使用一些特殊的前缀（在这种情况下是“_”）来避免条件和参数之间的冲突（如果我的资源有一个“订单”属性怎么办？）

有没有一些标准的方法来处理这些情况？

--

我找到了这个例子（只是挑一个） [http://www.peej.co.uk/articles/restfully-delicious.html](http://www.peej.co.uk/articles/restfully-delicious.html)

获取[http://del.icio.us/api/peej/bookmarks/?tag=mytag&dt=2009-05-30&start=1&end=2](http://del.icio.us/api/peej/bookmarks/?tag=mytag&dt=2009-05-30&start=1&end=2)

但在这种情况下，条件字段已经定义（没有开始或结束属性）

我正在寻找一些通用的解决方案...

-- 编辑，一个更详细的例子来澄清

每个项目都是完全独立的......假设我的资源是客户，并且（幸运的是）我的数据库中有几百万个。

所以网址可能类似于

[http://myservice/customers/?country=argentina,last_operation=2009-01-01..2010-01-01](http://myservice/customers/?country=argentina,last_operation=2009-01-01..2010-01-01)

它应该给我去年买过任何东西的所有阿根廷客户

现在我想使用这个服务来构建一个浏览页面，或者用 ajax 填充一个组合，所以我的想法是添加一些元数据来控制我应该得到什么信息

构建我要添加的浏览页面

[http://...,_page=1,_page_len=10,_order=state,name](http://...,_page=1,_page_len=10,_order=state,name)

并用 ajax 填充自动建议组合

[http://...,_page=1,_page_len=100,_order=state,name,name=what_ever_type_the_user](http://...,_page=1,_page_len=100,_order=state,name,name=what_ever_type_the_user) *

用与用户键入的内容匹配的前 100 个客户填充组合...

我的问题是，是否有某种标准（书面或非书面）方式以一种完整的 url 方式对这类内容进行编码......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-11-12T10:02:34.100

虽然没有标准，但[Web API 设计](https://pages.apigee.com/rs/apigee/images/api-design-ebook-2012-03.pdf)（Apigee 出）是创建 Web API 时的一本很好的建议书。我将其视为一种标准，并尽可能遵循其建议。

在“分页和部分响应”下，他们建议（第 17 页）：

> ## 使用限制和偏移
> 
> 我们建议限制和抵消。它更常见，在领先的数据库中很容易理解，并且对开发人员来说很容易。
> 
> ```
> /dogs?limit=25&offset=50 
> ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T13:32:26.713

没有标准或约定来定义执行此操作的方法，但是使用下划线（一个或两个）来表示元信息并不是一个坏主意。这是在某些语言中用于按约定指定成员变量的内容。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-31T15:11:12.013

* * *

**注意：** *我开始写这篇文章是对[我之前的回答](https://stackoverflow.com/questions/929702/standard-way-of-encoding-pagination-info-on-a-restful-url-get/930001#930001)的评论。然后我打算将其添加为编辑，但我认为它属于单独的答案。这是一种完全不同的方法，并且本身就是一个单独的答案，因为它是一种不同的方法。*

* * *

我考虑得越多，我认为您确实有两种不同的资源需要处理：

1.  一页资源
2.  收集到页面中的每个资源

我可能错过了一些东西（可能是......我犯了误解）。由于页面本身就是资源，因此分页*元信息*实际上是资源的属性，因此将其放在 URL 中不一定是错误的方法。如果您考虑可以为页面下游缓存的内容和/或将来称为资源的内容，则资源由分页属性和查询参数定义，因此它们都应该在 URL 中。为了继续我完全冗长的回复，页面资源将类似于：

```
http://.../myresource/page-10/3?name=xxx&country=yyy&order=name&orderby=asc 
```

我认为这触及了您最初问题的核心。如果页面本身是一个资源，那么 URI 应该描述页面，所以就像`page-10`我所说*的“一页 10 个项目”*，页面的下一部分是页码。查询部分包含过滤器。

其他资源命名页面包含的每个项目。如何识别项目应该由资源是什么来控制。我认为一个关键问题是结果资源是否独立存在。根据此概念，您表示*项目资源的方式会有所不同。*

如果项目表示仅在页面上下文中是合适的，那么包含内联表示可能是合适的。如果您这样做，则单独识别它们并确保您可以使用[URI 片段语法](https://www.rfc-editor.org/rfc/rfc2396#section-4.1)或[附加路径元素](https://www.rfc-editor.org/rfc/rfc2396#section-5)检索它们。似乎以下 URL 应导致十项的第三页上的第五项：

```
http://.../myresource/page-10/3?...#5
http://.../myresource/page-10/3/5?... 
```

在这两者之间做出决定的最大因素是单个项目与页面的耦合程度。片段语法比路径元素恕我直言更具约束力。

现在，如果项目资源是独立的并且页面只是查询的结果（我认为这里很可能就是这种情况），那么页面资源应该是每个项目资源的 URL 的有序列表。在这种情况下，项目资源应该独立于页面资源。您可能希望使用基于项目本身的标识属性的 URI。所以你最终可能会得到类似的东西：

```
http://.../myresource/item/42
http://.../myresource/item/307E8599-AD9B-4B32-8612-F8EAF754DFDB 
```

关键的决定因素是这些项目是否是独立资源。如果不是，那么它们是从页面 URI 派生的。如果它们是独立的，那么它们应该由它们自己的资源定义，并且应该作为链接包含在*页面*资源中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T15:53:32.937

我知道 RESTful 的人倾向于不喜欢使用 HTTP 标头，但有没有人真正研究过使用[HTTP 范围](https://www.rfc-editor.org/rfc/rfc2616#section-3.12)来解决分页问题。几年前我写了一个 ISAPI 扩展，其中包括分页信息以及 URI 中的其他非属性信息，我从来没有真正喜欢它的*感觉*。我正在考虑做类似的事情：

```
GET http://...?name=xxx&country=xxxx&_orderby=name&_order=asc HTTP/1.1
Range: pageditems=20-29
... 
```

这会将结果集参数（例如`_orderby`和`_order`）放在 URI 中，并将选择作为`Range`标题。我有一种感觉，尽管大多数 HTTP 实现都会搞砸这一点，特别是因为对非字节范围的支持是 RFC2616 中的一个 MAY。[在使用RTSP](https://www.rfc-editor.org/rfc/rfc2326)做了很多工作后，我开始更加认真地思考这个问题。[`Range`RTSP](https://www.rfc-editor.org/rfc/rfc2326#section-12.29)中的标头是扩展范围以处理时间和字节的一个很好的例子。

我想另一种处理方法是对页面上的每个项目单独请求作为单独的资源。如果您的代表允许这样做，那么您可能需要考虑它。中间缓存更有可能与这种方法一起工作得很好。因此，您的资源将被定义为：

```
myresource/name=xxx;country=xxx/orderby=name;order=asc/20/
myresource/name=xxx;country=xxx/orderby=name;order=asc/21/
myresource/name=xxx;country=xxx/orderby=name;order=asc/22/
myresource/name=xxx;country=xxx/orderby=name;order=asc/23/
myresource/name=xxx;country=xxx/orderby=name;order=asc/24/ 
```

我不确定是否有人尝试过这样的事情。这将使 URI 可构造，恕我直言，这始终是一个有用的属性。这种方法的好处是可以缓存各个响应，并且服务器可以自由地优化处理收集项目页面的处理以及最有效的方式。基本思想是让客户端在 URI 中指定查询以及它想要检索的项目的索引。无需将*“页面”*的想法推送到资源中，甚至无需使其可见。客户端可以迭代检索对象，直到它的页面已满或收到 404。

当然有一个缺点...... HTTP 服务器和基础设施必须支持[流水线](https://www.rfc-editor.org/rfc/rfc2616#section-8.1.2.2)，否则创建/破坏连接的成本可能会彻底扼杀这个想法。

# groovy - 从列表中选择行块的 Groovy 方法

> ID：929707
> 
> 赞同：1
> 
> 时间：2009-05-30T13:08:25.667
> 
> 标签：groovy

在我的 Groovy 程序中，我有一个行列表，我想从列表中选择一个连续的行块。所需块的第一行包含一个特定的字符串，最后一行（我可以包含或不包含 - 没关系）包含一个（不同的）标记字符串。

工作代码在下面，但肯定有一种“groovier”方法可以在一两行中做到这一点 - 任何人都可以建议如何做吗？

（实际上我的行列表来自 HTTP GET，但我只是定义了一个 URL 对象并执行 url.openStream().readLines() 来获取这些行。）

```
lines = ["line1", "line2", "line3", "line4", "line5", "line6"]
println extract_block("2", "5", lines)

def extract_block(start, end, lines) {
    def block = null
    for (line in lines) {
        if (null == block && line.contains(start)) { block = [] }
        if (null != block && line.contains(end)) { break }
        if (null != block) { block << line }
    }
    return block
} 
```

这打印

```
["line2", "line3", "line4"] 
```

其中包括第一行（包含“2”）并跳过最后一行（包含“5”）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T18:48:14.513

正则表达式就是为这类问题而设计的。这是一个示例，显示它在文件内容的位置都有效

（注意：String.find 方法在 groovy 1.6.1 及更高版本中，在此之前您需要稍微修改语法）

```
def BEGIN_MARKER = "2"
def END_MARKER = "5"
def BEGIN_LINE = /.*$BEGIN_MARKER.*\n/
def MIDDLE_LINES = /(.*\n)*?/
def LOOKAHEAD_FOR_END_LINE_OR_EOF = /(?=.*$END_MARKER.*|\Z)/

def FIND_LINES = "(?m)" +
                 BEGIN_LINE +
                 MIDDLE_LINES +
                 LOOKAHEAD_FOR_END_LINE_OR_EOF    

def fileContents = """
line1 ipsum
line2 lorem
line3 ipsum
line4 lorem
line5 ipsum
line6 lorem
"""

// prints:
// line2 lorem
// line3 ipsum
// line4 lorem
println fileContents.find(FIND_LINES)

def noEndMarkerFileContents = """
line1 ipsum
line2 lorem
line3 ipsum
line4 lorem
line6 lorem
"""

// prints:
// line2 lorem
// line3 ipsum
// line4 lorem
// line6 lorem        
println noEndMarkerFileContents.find(FIND_LINES) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T19:00:11.120

或者，如果你不想使用正则表达式，你可以使用 findAll 让它更时髦一点：

```
lines = ["line1", "line2", "line3", "line4", "line5", "line6"]

def extract_block(start, end, lines) {
    def inBlock = false
    return lines.findAll { line ->        
        if (line.contains(start)) inBlock = true
        if (line.contains(end)) inBlock = false            
        return inBlock
    }
}

assert ["line2", "line3", "line4"] == extract_block("2", "5", lines) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T06:51:51.350

Ted 的“groovier”答案的一个较短但表达力稍差的版本：

```
def extract_block(start, end, lines) {
    def inBlock = false
    return lines.findAll { inBlock = (it.contains(start) || inBlock) && !it.contains(end) } 
} 
```

# c# - 第n个素数问题，需要加快速度

> ID：929712
> 
> 赞同：3
> 
> 时间：2009-05-30T13:12:52.290
> 
> 标签：c#, optimization, performance, primes, prime-factoring

有一种简单的密码可以将数字转换为 **.** **(** **)**

为了将数字（0 .. 2147483647）*加密*为这种表示，我（认为我）需要：

*   质因数分解
*   对于给定的*p*（*p*是 Prime ）， p 的顺序序列（即**PrimeOrd(2)** == **0**，**PrimeOrd(227)** == **49**）

### 一些例子

```
    0 . 6 (()())
    1 () 7 (...())
    2 (()) 8 ((.()))
    3 (.()) 9 (.(​​()))
    4 ((())) 10 (().())
    5 (..()) 11 (..())
    227 (.................................................. ())
    2147483648 ((........()))

```

### 我的问题源代码

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;

static class P
{
    static List<int> _list = new List<int>();

    public static int Nth(int n)
    {
        if (_list.Count == 0 || _list.Count < n)
            Primes().Take(n + 1);

        return _list[n];
    }

    public static int PrimeOrd(int prime)
    {
        if (_list.Count == 0 || _list.Last() < prime)
            Primes().First(p => p >= prime);

        return (_list.Contains(prime)) ? _list.FindIndex(p => p == prime) : -1;
    }

    public static List<int> Factor(int N)
    {
        List<int> ret = new List<int>();
        for (int i = 2; i ≤ N; i++)
            while (N % i == 0)
            {
                N /= i;
                ret.Add(i);
            }

        return ret;
    }

    public static IEnumerable<int> Primes()
    {
        _list = new List<int>();

        _list.Add(2);
        yield return 2;

        Func<int, bool> IsPrime = n => _list.TakeWhile(p => p ≤ (int)Math.Sqrt(n)).FirstOrDefault(p => n % p == 0) == 0;

        for (int i = 3; i < Int32.MaxValue; i += 2)
        {
            if (IsPrime(i))
            {
                _list.Add(i);
                yield return i;
            }
        }
    }

    public static string Convert(int n)
    {
        if (n == 0) return ".";
        if (n == 1) return "()";

        StringBuilder sb = new StringBuilder();
        var p = Factor(n);
        var max = PrimeOrd(p.Last());
        for (int i = 0; i ≤ max; i++)
        {
            var power = p.FindAll((x) => x == Nth(i)).Count;
            sb.Append(Convert(power));
        }
        return "(" + sb.ToString() + ")";
    }
}

class Program
{
    static void Main(string[] args)
    {
        string line = Console.ReadLine();
        try
        {
            int num = int.Parse(line);
            Console.WriteLine("{0}: '{1}'", num, P.Convert(num));
        }
        catch
        {
            Console.WriteLine("You didn't entered number!");
        }
    }
} 
```

**问题是程序 PrimeOrd 的缓慢性。你知道一些更快的解决方案来找出素数中的素数顺序吗？**

## 标题

### 如果您知道如何加快查找素数的顺序，请提出一些建议。:-)

## 谢谢你。

* * *

PS 小于 2,147,483,648 的最大素数是**2,147,483,647**，它是第**105,097,565 个**素数。没有必要期望比 2^31 更大的数字。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T13:16:19.163

这不是您在运行时应该做的事情。更好的选择是预先计算所有这些素数，然后以某种方式将它们放入您的程序中（静态数组或要读入的文件）。然后，慢速代码作为开发过程的一部分运行（无论如何都很慢:-)，*而不是*在您需要速度的地方。

那么这只是某种查找的问题，而不是每次需要它们时都计算它们。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-30T13:16:48.570

请参阅 SO 问题：

[http://www.google.com/search?q=site%3Astackoverflow.com+prime+number&btnG=搜索](http://www.google.com/search?q=site%3Astackoverflow.com+prime+number&btnG=Search)

[用埃拉托色尼筛法寻找素数（原文：有没有更好的方法来准备这个数组？）](https://stackoverflow.com/questions/586284/finding-prime-numbers-with-the-sieve-of-eratosthenes-originally-is-there-a-bett)

[素数计算乐趣](https://stackoverflow.com/questions/288200/prime-number-calculation-fun)

[如何通过 C++ 中的位运算找到素数？](https://stackoverflow.com/questions/898731/how-can-i-find-prime-numbers-through-bit-operations-in-c)

[素数 c#](https://stackoverflow.com/questions/886540/prime-numbers-c)

[寻找合数](https://stackoverflow.com/questions/248400/finding-non-prime-numbers-in-c)

[素数程序](https://stackoverflow.com/questions/502443/prime-numbers)

如果您需要已知素数的列表，请查看[此处](http://www.math.unicaen.fr/~reyssat/largest.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T14:30:55.597

您应该将素数缓存到 _list，然后将其用于 Factor 和 PrimeOrd。此外，避免运算符 LINQ 运算符（如 TakeWhile）创建的值会被丢弃。

这是一个优化的版本：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

static class P
{
    private static List<int> _list = new List<int>();

    public static int Nth(int n)
    {
        if (_list.Count == 0 || _list.Count <= n)
        {
            GenerateNextPrimes().First(p => _list.Count >= n);            
        }

        return _list[n];
    }

    public static int PrimeOrd(int prime)
    {
        var primes = GrowPrimesTo(prime);
        return primes.IndexOf(prime);
    }

    public static List<int> Factor(int N)
    {
        List<int> ret = new List<int>();        
        GrowPrimesTo(N);

        for (int ixDivisor = 0; ixDivisor < _list.Count; ixDivisor++)
        {
            int currentDivisor = _list[ixDivisor];

            while (N % currentDivisor == 0)
            {
                N /= currentDivisor;
                ret.Add(currentDivisor);
            }

            if (N <= 1)
            {
                break;
            }
        }

        return ret;
    }

    private static List<int> GrowPrimesTo(int max)
    {
        if (_list.LastOrDefault() >= max)
        {
            return _list;
        }

        GenerateNextPrimes().First(prime => prime >= max);
        return _list;        
    }

    private static IEnumerable<int> GenerateNextPrimes()
    {
        if (_list.Count == 0)
        {
            _list.Add(2);
            yield return 2;
        }

        Func<int, bool> IsPrime =
            n =>
            {
                // cache upperBound
                int upperBound = (int)Math.Sqrt(n);
                for (int ixPrime = 0; ixPrime < _list.Count; ixPrime++)
                {
                    int currentDivisor = _list[ixPrime];
                    if (currentDivisor > upperBound)
                    {
                        return true;
                    }

                    if ((n % currentDivisor) == 0)
                    {
                        return false;
                    }
                }

                return true;
            };

        // Always start on next odd number
        int startNum = _list.Count == 1 ? 3 : _list[_list.Count - 1] + 2;
        for (int i = startNum; i < Int32.MaxValue; i += 2)
        {
            if (IsPrime(i))
            {
                _list.Add(i);
                yield return i;
            }
        }
    }

    public static string Convert(int n)
    {
        if (n == 0) return ".";
        if (n == 1) return "()";

        StringBuilder sb = new StringBuilder();
        var p = Factor(n);
        var max = PrimeOrd(p.Last());
        for (int i = 0; i <= max; i++)
        {
            var power = p.FindAll(x => x == Nth(i)).Count;
            sb.Append(Convert(power));
        }
        return "(" + sb.ToString() + ")";
    }
}

class Program
{
    static void Main(string[] args)
    {        
        string line = Console.ReadLine();
        int num;

        if(int.TryParse(line, out num))
        {   
            Console.WriteLine("{0}: '{1}'", num, P.Convert(num));             
        }
        else
        {
            Console.WriteLine("You didn't entered number!");
        }
    }
} 
```

# security - 网站和 Web 应用程序有哪些类型的身份验证选项？

> ID：929714
> 
> 赞同：0
> 
> 时间：2009-05-30T13:14:08.713
> 
> 标签：security, web-applications

尽管市面上有很多优秀的 CMS 工具，但我还是决定为我的网站推出自己的工具来获得一些实践经验。目前唯一让我感到困惑的是如何添加身份验证来保护管理工具。

我是唯一会使用管理工具的人，所以我不需要像成熟的登录和注册系统那样复杂的东西。但是，我也不想依靠隐匿安全性并使用随机页面名称等来隐藏工具。

我有哪些选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T13:23:23.593

[OpenID](http://openid.net/)可能是您最好的选择。

要按照您的建议将其用于一个人，只需检查经过身份验证的用户名。是的，这相当于硬编码，但如果我们要创建一个只有一个有效登录名的系统，则不需要任何更复杂的东西。

但是创建替代方案应该不会那么糟糕。您也可以只创建一个角色表，然后对该表进行查询以查看当前登录的用户是否是管理员。如果您以后想更高级，您可以稍后添加不同的用户和角色。

用户和角色如何进入表格取决于您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T13:36:10.933

1）只需使用“WWW-Authenticate：Basic”查看[维基百科](http://en.wikipedia.org/wiki/Basic_access_authentication)的想法和相关的RFC了解详细信息。
2) 启用 SSL 以确保您的明文密码已加密。
SSL 在 Web 服务器上是相当标准的。您甚至可以[自行签署](http://en.wikipedia.org/wiki/Self-signed_certificate)您的证书。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T13:48:39.003

这部分取决于您和您的虚拟主机将使用什么平台。给定的平台可能会提供一组比其他平台更容易访问的选择。

例如，在 IIS 内运行的 ASP.NET 提供表单、基本和 Windows (NTLM) 身份验证，以及基于证书的身份验证，能够将客户端证书映射到 Windows 用户。

您当然可以在 ASP.NET 应用程序中实现另一个授权模式，而且很多都可以。但是，如果这是您的平台，您就不必实施这套开箱即用的身份验证方案。我希望任何其他平台都是如此，包括基于 Linux 的平台。

在编写自己的内容之前，请务必找出开箱即用的内容以及可以轻松添加的内容。

# c# - TLS/SSL in .net

> ID：929720
> 
> 赞同：3
> 
> 时间：2009-05-30T13:18:29.877
> 
> 标签：c#, sockets, ssl

Is there any (hopefully free/open source) code available that does native TLS/SSL communication? I do not speak about the HTTPListener/Client and WebRequest classes. I'd like to do raw TLS communication in my C# code.

Thanks in advance, Max

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T13:24:24.810

[Here's an article on codeproject](http://www.codeproject.com/KB/IP/sslclasses.aspx), it also includes code for using OpenSSL.

Do you mind if I ask what you're trying to achieve? Just curious really; there's lots of high-level wrapper classes for this kind of thing so you don't normally need to work at this level (not that there's anything wrong with that :-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T14:32:50.257

[http://www.mentalis.org/soft/projects/ssocket/](http://www.mentalis.org/soft/projects/ssocket/) - been using this in a commercial product for the last 5 years in .net 1.0, 2.0 and now 3.0\. Very reliable, simple to use and stable.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-03T05:43:56.063

Built-in (as at time of writing) `SslStream` object makes this easy - see [https://www.medo64.com/2014/09/client-authenticated-tls-in-c/](https://www.medo64.com/2014/09/client-authenticated-tls-in-c/)

# javascript - Javascript onkeypress

> ID：929729
> 
> 赞同：0
> 
> 时间：2009-05-30T13:26:42.107
> 
> 标签：javascript, javascript-events

我对 Javascript 上的 onkeypress 事件有疑问。

是否可以检测到 Just Ctl 键或 Alt 键？目前，如果同时按下 Ctl 和 m ，则 onkeypress 事件可以触发点击。是否可以单独执行 Ctl 键？

期待您的评论

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T13:34:54.740

`onkeypress`只是捕捉字符键。使用`onkeydown`和/或`onkeyup`其他键。请参阅[Peter-Paul Koch 关于关键事件的信息](http://www.quirksmode.org/dom/events/keys.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T13:34:54.647

从外观上看，不，您不能只捕获 Ctrl 键。专门用于捕获键[的热键 jQuery 插件也不捕获直接的“Ctrl”键，所以我猜这是不可能的。](http://code.google.com/p/js-hotkeys/)[您可以使用鼠标事件来捕捉它](http://www.javascripter.net/faq/ctrl_alt.htm)，但这并不完全相同。

[http://jshotkeys.googlepages.com/test-static-01.html](http://jshotkeys.googlepages.com/test-static-01.html)

# actionscript-3 - ActionScript 3：测量 enterFrame 事件之间经过的时间

> ID：929733
> 
> 赞同：3
> 
> 时间：2009-05-30T13:31:52.143
> 
> 标签：actionscript-3

我有一个 EnterFrame 事件，我想知道调用之间的确切时间，因此当计算机无法产生所需的帧速率时，我将能够更流畅地为对象设置动画。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-30T15:31:31.793

更具体一点。

```
currentTime = getTimer();
diff = currentTime - prevTime;

prevTime = currentTime;//update for next go around 
```

**编辑**

getTimer 要求您导入包：`flash.utils.getTimer;`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T13:51:11.057

使用 getTimer(); ?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T00:46:39.157

您应该使用内置的[Timer](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/utils/Timer.html)函数以某种`ENTER_FRAME`独立的方式调用方法。

```
var timer:Timer = new Timer(500, 0);
timer.addEventListener(TimerEvent.TIMER, timerHandler);
timer.start();

private function timerHandler(event:TimerEvent):void
{
    // do something

    // *EDIT* Thanks @Luke spotting this out (check comments)
    event.updateAfterEvent();

} 
```

*) 您仍然需要记住，事件处理程序不会在帧之间触发，因此如果您的脚本滞后（由于某些其他进程），此调用也将被延迟。准确地说，方法调用将近似于在设置的*延迟*时间之后或同时执行的帧处。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T14:18:44.210

正如其他人所说，getTimer 是最好的方法......但我想提出其他建议：如果你想做基于时间的动画，基于更新的帧，你也可以尝试一些更大的 ActionScript 补间库，作为 caurina Tweener ... 他们只是开箱即用并提供其他出色的功能...

问候

back2dos

# java - Java EE 中的 for-each 循环和泛型

> ID：929735
> 
> 赞同：0
> 
> 时间：2009-05-30T13:33:20.003
> 
> 标签：java, jakarta-ee, generics, foreach, jstl

我正在设计一个基于网站的项目，其中我首先在 Java SE 应用程序开发中设计了我的逻辑层。然后我在 Java EE 中为网站制作了 GUI。我正在使用 JSTL 在 Java EE 架构中导入我的 Java SE 文件，我将只使用它来调用数据。

但是，它给了我一个错误如下：

1.  for-each 循环——`for-each loops are not used in source 1.4, try source 1.5 to enable for-each loop.`
2.  泛型——`generics are not supported in source 1.4, try source 1.5 to enable generics`
3.  `variable-arity methods are not supported in -source 1.4`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T13:35:43.647

看来您选择了错误的 JDK - 所有这些功能都是在 JDK 1.5 中添加的。确保为 IDE 和 Web 应用程序应用服务器选择了 1.5 JDK。这应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T17:42:00.803

如果您通过 Ant 或命令行构建，请确保在命令行上指定“ `-source 1.5`” `javac`。此外，默认情况下，JSP 文件不一定使用 Java 5 功能。这取决于您使用的 Servlet 标准。例如，请参阅[此博客条目](http://blog.taragana.com/index.php/archive/how-to-run-javac-15-or-beyond-compiler-for-jsp-compilation-in-tomcat-55-with-generics-enabled-and-other-15-only-features/)，该条目告诉您如何设置 Tomcat 5.5，以便在其 JSP 中允许 1.5 功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T15:02:01.197

在 Netbeans 中，Java EE 格式是项目设置的一部分。不幸的是，一旦您创建了项目，就无法在项目设置中更改它。

使用 Java EE 5 版本创建一个新项目并复制您的源代码。

为了能够选择 Java EE 5，您需要安装支持 Java EE 5 的服务器，例如。Tomcat v6 或 GlassFish v2。您可以使用 NetBeans 工具->服务器菜单安装服务器。

# jquery - IE6 的实现 + 选择器

> ID：929737
> 
> 赞同：2
> 
> 时间：2009-05-30T13:34:37.253
> 
> 标签：jquery, css, internet-explorer-6, selector

我真的很喜欢 + 选择器，并且不想仅仅为了 IE6 解决方法而添加另一个 css 规则。那么是否有一种 jquery 方式来检查所有现有的 css 规则，如果它使用 + 选择器然后修改元素。

像这样的东西：

```
if (IE6)
  for (var rule in $.cssrules)
    if (rule.selector.find('+'))
       $(rule).style = rule.style; // here the + selector works even for IE6 because jquery emulates it. 
```

所以基本问题是：我可以获得文档中定义的所有 css 规则的数组（或其他东西）吗？

干杯，曼努埃尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T13:43:10.637

如果您通过类应用规则，也许您可​​以检查应该应用它的已知元素的属性并查看它是否已应用？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T11:34:44.527

有办法做到这一点。事实上，一个名为**IE7**的 JavaScript 库已经做到了这一点，而且做得更多——它支持 Internet Explorer 6 甚至 5 上的大多数 CSS 选择器： [http](http://code.google.com/p/ie7-js/) ://code.google.com/p/ie7-js/ 。
我应该说我自己没有使用过它，但我听说过它的好消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T11:39:13.457

你可以做的是这样的：

使用正常的一切，但 IE6 CSS 规则，但也创建另一个具有相同样式的类：

```
/* CSS */
.myNormal + .cssRule + strong,
.myOverrideClass {
    color: #f0f;
} 
```

然后，使用 jQuery，将覆盖类应用于与普通 CSS 选择器匹配的元素：

```
$('.myNormal + .cssRule + strong').addClass('myOverrideClass'); 
```

使用这种方法，如果他们在禁用 Javascript 的 IE6 上，则无法获得样式的唯一方法。在其他浏览器上没有 javascript 的用户不会受到影响。

# iphone - 在 iPhone OS 中加密 SQLite 数据库文件

> ID：929744
> 
> 赞同：20
> 
> 时间：2009-05-30T13:39:02.143
> 
> 标签：iphone, sqlite, ios, encryption, checksum

iPhone 上的任何 SQLite 数据库都只是一个与应用程序捆绑在一起的文件。任何人提取此文件并查询它都相对简单。

您对加密文件或存储在数据库中的数据有什么建议。

**编辑：**该应用程序是一款将与其他用户对战的游戏。有关用户相对优势和劣势的信息将存储在数据库中。我不希望用户能够越狱手机以提高他们的声誉/权力等，然后赢得锦标赛/联赛等（注意：由于这个想法处于 NDA 之下，所以试图含糊其辞）。

我不需要军事加密，我只是不想以纯文本形式存储东西。

**编辑2：**再澄清一点，我的主要目标是

1.  让破解敏感数据变得轻而易举
2.  有一种简单的方法来发现数据是否已被更改（某种校验和）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-02T22:13:44.807

你不能相信客户，期间。如果您的独立应用程序可以解密它，那么它们也可以。要么将数据放在服务器上，要么不要打扰，因为真正破解它以增强统计数据的人数将是微不足道的，无论如何他们可能应该因为努力而得到回报！

在数据库中放入一个字符串，说“请不要作弊”。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-02T05:34:52.073

这里至少有两种更简单的方法（都是免费的），可以避免加密值或内存数据库：

**#1 - ipa 裂纹检测**

避免加密数据库和/或内容的技术（和法律）麻烦，只需确定应用程序是否被盗版并禁用游戏的网络/得分/排名方面。有关详细信息，请参阅以下内容：

[http://thwart-ipa-cracks.blogspot.com/2008/11/detection.html](http://thwart-ipa-cracks.blogspot.com/2008/11/detection.html)

**#2 - 数据完整性验证**

或者，在保存数据时（以及在初始 sqlite 数据库中），在每一行中存储重要列的 HMAC/salted 哈希。加载每一行时，根据 HMAC/哈希验证数据，如果验证失败，则采取相应措施。

这两种方法都不会强制您填写 Apple/美国政府要求的加密导出表格。

**分数提交**

不要忘记，您需要为实际提交的分数执行类似的操作，以防止值来自您的应用程序以外的其他内容。[您可以在http://code.google.com/p/cocos2d-iphone/](http://code.google.com/p/cocos2d-iphone/)和[http://code.google.com/p/cocoslive/](http://code.google.com/p/cocoslive/)的 cocos2d-iphone 和 cocoslive 框架中看到这个实现

**对评论的回应**

这里没有解决方案可以 100% 防止数据篡改。如果这是要求，则客户端只需要查看，并且所有状态和逻辑都必须在受信任的服务器上计算。根据应用程序，客户端将需要额外的反作弊机制。

有许多关于开发大型多人游戏的书籍讨论了这些问题。

在代码中使用具有已知秘密的哈希可能是一种合理的方法（至少，考虑到 App Store 上普遍存在的应用程序类型时）。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-06-29T14:21:52.783

就像 Kendall 说的，包括设备上的密钥，基本上就是要求被破解。但是，有些人有理由使用设备上的密钥来混淆数据。如果您决心这样做，您可以考虑使用[SQLCipher](http://www.zetetic.net/software/sqlcipher)来实现。它是 SQLite 的构建，可提供整个数据库的透明、页面级加密。有一个[关于 Mobile Orchard 的教程，](http://www.mobileorchard.com/tutorial-iphone-sqlite-encryption-with-sqlcipher/)用于在 iPhone 应用程序中使用它。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-30T15:08:59.730

您认为您的普通用户执行此操作的可能性有多大？我假设您正在浏览应用商店，这意味着在进入用户设备之前所有内容都经过签名/加密。他们必须越狱他们的设备才能访问您的数据库。

您存储什么样的数据需要加密？如果它包含用户输入的密码，那么您实际上不需要加密它们；用户无需找到自己的密码。如果它是您只希望用户通过应用程序访问的通用 BLOB 数据，则它可以像使用[安全 API](https://developer.apple.com/iphone/library/documentation/Security/Reference/certifkeytrustservices/Reference/reference.html#//apple_ref/c/func/SecKeyRawSign)存储加密的 blob 一样简单。

如果它是您想要保护的整个数据库，那么您仍然希望使用安全 api，但是在整个文件上，并在打开文件之前根据需要解密文件。这里的问题是，如果应用程序在没有清理的情况下关闭，您将得到一个解密的文件。

您可能想查看内存驻留数据库或临时数据库，您可以使用模板数据库或程序中的硬编码模式创建它们（查看[sqlite3_open](http://www.sqlite.org/c3ref/open.html)的文档）。数据可以被解密，插入临时数据库，然后删除解密的数据库。关闭连接时以相反的方向执行此操作。

**编辑**：

您可以使用存储在应用程序中的值对数据进行异或运算，并在其他地方存储哈希以确保它不会更改或其他东西，我敢肯定，您可以使用一个非常简单的安全系统来制作自己的加密方案.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-06-13T08:49:06.990

**SQL密码：**

根据我的经验，SQLCipher 是加密数据库的最佳选择。

一旦设置了密钥（“PRAGMA 密钥”），SQLCipher 将自动加密数据库中的所有数据！请注意，如果您不设置密钥，则 SQLCipher 的操作方式与标准 SQLite 数据库相同。

对 sqlite3_key 或“PRAGMA key”的调用应该作为打开数据库后的第一个操作发生。在大多数情况下，SQLCipher 使用 PBKDF2（一种加盐和迭代的密钥派生函数）来获取加密密钥。或者，应用程序可以告诉 SQLCipher 以 blob 表示法使用特定的二进制密钥（注意 SQLCipher 需要 256 位的密钥材料），即

![在此处输入图像描述](https://i.stack.imgur.com/jYLQp.png)

参考：

```
http://sqlcipher.net/ios-tutorial 
```

我希望有人能节省时间来探索这个

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-04T15:08:10.547

忽略哲学和出口问题，我建议您最好直接加密表中的数据。

您需要混淆代码中的解密密钥。通常，这意味着将它们分解成碎片并以十六进制编码字符串并使用函数将密钥的碎片组装在一起。

对于算法，对于您使用的任何语言，我都会使用受信任的 AES 实现。也许这个适用于 C#：

[http://msdn.microsoft.com/en-us/magazine/cc164055.aspx](http://msdn.microsoft.com/en-us/magazine/cc164055.aspx)

最后，您需要了解该方法的局限性。也就是说，解密密钥是一个薄弱环节，它将在运行时以明文形式在内存中可用。（至少）必须是这样才能使用它。你的加密方案的实施是另一个弱点——任何缺陷都存在于你的代码中。正如其他几个人指出的那样，您的客户端-服务器通信也是可疑的。

您应该记住，您的可执行文件可以在十六进制编辑器中检查，其中明文字符串将从您编译的代码的随机垃圾中跳出来。并且许多语言（例如 C#）可以被反向编译，并且所有将缺少的只是注释。

话虽如此，加密您的数据将提高作弊的门槛。多少取决于你有多小心；但即便如此，一个坚定的对手仍然会破坏你的加密并作弊。此外，如果您的游戏很受欢迎，他们可能会编写一个工具来简化它；在这一点上给你留下一个军备竞赛的场景。

* * *

关于校验和值，假设您的数据库中有足够的数值来执行此操作，您可以根据一行中的值的总和来计算校验和。或者，对于一堆布尔值，您可以将它们存储在 varbinary 字段中，并使用按位排他运算符 ^ 来比较它们——您应该以 0 结尾。

例如，

对于数字列，

2|3|5|7| 带有校验和列 | 17 |

对于布尔值，

0|1|0|1| 带有校验和列 | 0101 |

如果您这样做，您甚至可以在最后添加一个汇总行来汇总您的校验和。尽管如果您不断添加新记录，这可能会出现问题。您还可以将字符串转换为它们的 ANSI/UNICODE 组件并将它们相加。

然后，当您想检查校验和时，请执行如下选择：

```
Select * 
FROM OrigTable 
right outer join 
(select pk, (col1 + col2 + col3) as OnTheFlyChecksum, PreComputedChecksum from OrigTable) OT on OrigTable.pk = OT.pk
where OT.OnTheFlyChecksum = OT.PreComputedChecksum 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-08T13:27:19.947

将所有锦标赛结果同步到锦标赛中的所有 iPhone 似乎是最简单的。您可以在每场比赛期间这样做：在比赛前，如果两部手机的数据库相互矛盾，则会显示警告。

如果用户 A 在与用户 B 的游戏中伪造结果，则此结果将传播，直到 B 最终看到它并警告 A 的数据与他的手机不匹配。然后他可以去~~殴打~~向A解释他的行为是不对的，就像现实生活中有人作弊一样。

当您计算最终的锦标赛结果时，显示警告、命名并丢弃所有结果相互矛盾的游戏。这消除了作弊的动机。

如前所述，加密无法解决问题，因为您无法信任客户端。即使您的普通人无法使用反汇编程序，也只需要一个有动力的人，您拥有的任何加密都将被破坏。

* * *

## 回答 #8

> 赞同：-5
> 
> 时间：2010-01-07T13:16:23.223

但是，如果在windows平台上，您也可以选择[SQLiteEncrypt](http://www.sqlite-encrypt.com/)来满足您的需求。SQLiteEncrypt扩展了sqlite加密支持，但您可以将其视为原始sqlite3 c库。

# php - 固定装置可以从其他固定装置“复制”项目吗？

> ID：929745
> 
> 赞同：1
> 
> 时间：2009-05-30T13:42:47.423
> 
> 标签：php, doctrine, yaml, acl

在我的 ACL 装置中，我有资源和动作，大多数资源共享共同的动作，如 CRUD，在 Doctrine (yaml) 中有没有办法扩展另一个元素？

这是我当前的 yaml 的简介：

* * *

```
Resource:
  R1:
    title: Article
    system_name: ARTICLE
    Actions:
        A1:
            title: Create
            system_name: CREATE
        A2:
            title: Read
            system_name: READ
        A3:
            title: Update
            system_name: UPDATE
        A4:
            title: Delete
            system_name: DELETE 
```

我如何使用新资源扩展 R1，例如，称为“新闻文章”，它将继承 A1 到 A4 + 包括它自己的操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-02T08:04:31.340

“锚和别名”+合并就是答案：

[http://yaml.github.com/yaml-spec/#id2768357](http://yaml.github.com/yaml-spec/#id2768357)

（使用[http://instantyaml.appspot.com/](http://instantyaml.appspot.com/)查看规范 YAML 的外观）

```
Resource:
  R1:
    title: Article
    system_name: ARTICLE
    Actions: &id1
        A1:
            title: Create
            system_name: CREATE
        A2:
            title: Read
            system_name: READ
  R2:
    system_name: New ARTICLE
    Actions:
       <<: *id1
       A5:
            title: Drop
            system_name: DROP 
```

# java - Java 服务器无法使用 Blackberry 的 AESkey 加密/解密数据

> ID：929746
> 
> 赞同：1
> 
> 时间：2009-05-30T13:42:58.237
> 
> 标签：java, encryption, blackberry, java-me, aes

我正在开发一个服务器在 Java 中的 BlackBerry 应用程序。每当 AES 加密数据与 PKCS5 格式一起发送到服务器时，服务器在解密时会出现错误的填充异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T15:31:28.233

确保您首先以正确的顺序进行填充等：填充然后加密，解密然后取消填充。

*   检查传输的数据长度并确保它是块大小的倍数。

*   确保块大小在所有调用中都是一致的。

*   确保您的加密提供商设置完全匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T22:08:47.670

那是黑莓还是服务器代码？您是否尝试过使用标准的 JCE 类？像这样的东西：

```
`Cipher aes = Cipher.getInstance("AES/ECB/PKCS5Padding");
SecretKeySpec key = new SecretKeySpec(yourKeyBytes, "AES");
aes.init(Cipher.DECRYPT_MODE, key);
byte[] cleartext = aes.update(ciphertext, 0, ciphertext.length);` 
```

# `actionscript-3 - ActionScript 3：流畅的程序化动画`

 `> ID：929749
> 
> 赞同：5
> 
> 时间：2009-05-30T13:45:43.720
> 
> 标签：actionscript-3

我想尽可能平滑地为 MoviveClips/Sprite 对象设置动画。然而到目前为止，唯一可行的方法是将移动代码放入 EnterFrame 事件处理程序。这种方法有一个问题：当特定机器上的帧速率低于所需的帧速率时，整个游戏就会变慢。我希望能够以与时间无关的方式做到这一点。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-30T23:26:25.247

有两种方法可以在 Flash 播放器中制作程序化动画。您已经通过使用 onEnterFrame 指出了第一个。但是，您可能已经注意到，要获得流畅的动画，您需要提高电影的整体帧速率。这样做还会增加 SWF 运行期间的 CPU 负载。这不是你一直想要的。

进行程序化动画的另一种方法是使用计时器。在计时器处理程序中，可以调用一个名为的函数，该函数`updateAfterEvent`将独立于您为 SWF 设置的 FPS 更新屏幕。因此，使用计时器可以在 Flash 播放器中制作流畅的动画，而不会增加 SWF 的整体帧速率。

大约两年前，我开始为 Flash 创建自己的补间库（因为我对当时可用的补间库感到沮丧）。[我以Coretween](http://www.coretween.org)的名义发布了它，这个库允许你为每个补间选择你喜欢的动画类型。在文档页面上，我举了一个[例子](http://www.coretween.org/documentation.html#RenderMethod)基于帧的动画和基于时间的动画之间的区别。该页面上的示例 SWF 以 12 fps 运行，但正如您所见，较低的圆形补间更加平滑，因为它由一个以 60 fps 滴答作响的计时器控制，并根据 SWF 帧速率更新屏幕。请记住，尽管实际上即使计时器以 60 fps 的速度滴答作响，Flash Player 也永远无法达到此帧速率。但是，它将尝试实现此帧速率，从而使整体动画更加流畅。

不幸的是，直到现在我还不能发布我的库的 1.0 版本，但据我所知它非常稳定。非常欢迎您以任何您认为合适的方式使用它。我在许多商业制作中都使用过 Coretween，包括我们为澳大利亚的[StGeorge](http://www.stgeorge.com.au/promos/yourhome/)银行制作的这个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T13:50:29.890

以下是一些基于 Actionscript 的动画库：

[TweenMax](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fblog.greensock.com%2Ftweenmaxas3%2F&ei=UzkhSpD8IYPBtwfCxOnBBg&rct=j&q=TweenMax&usg=AFQjCNFfJ41rVV8JX7vg8VfC2vRwuwzAkQ)

[吐温](http://www.google.com/url?sa=t&source=web&ct=res&cd=1&url=http%3A%2F%2Fcode.google.com%2Fp%2Ftweener%2F&ei=eTkhSqT7COHgtgfS6uzABg&rct=j&q=Tweener&usg=AFQjCNH06RZesH0SEvPCYbJ-J0OMFd7GGQ)

它们都运作良好，应该可以帮助您满足您的需求。

# performance - 静态代码分析和应用程序性能之间是否存在关系

> ID：929753
> 
> 赞同：1
> 
> 时间：2009-05-30T13:49:20.220
> 
> 标签：performance, analysis

我的问题：性能测试通常在应用程序与各种模块集成并准备好部署之后进行。

有没有办法在开发阶段识别性能瓶颈。代码分析是否会在性能方面提供任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T13:57:56.643

这完全取决于您在代码分析期间运行的规则，但我认为您不能仅通过 CA 来防止性能瓶颈。

从我过期的情况来看，性能问题通常非常复杂，要找到真正的问题，您必须运行性能测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T14:01:56.030

不，除非在非常小的情况下（例如对于 Java，在循环中使用 StringBuilder 而不是字符串追加）。

原因是您不会知道特定代码段将如何影响整个应用程序，直到您使用相关数据集运行整个应用程序。

例如：如果您始终对六个元素的列表进行排序，那么将冒泡排序更改为快速排序不会显着影响您的应用程序。或者，如果您在半夜运行一次排序，并且不会延迟其他处理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T01:17:56.583

如果我们谈论的是 .NET，那么是与否…… FxCop（或内置代码分析）中有许多处理性能问题的规则。但是，此列表相当短且性质有限。

话虽如此，没有理由不能使用更多规则（启发式或其他规则）来扩展 FxCop，以捕捉潜在问题区域并标记它们。这只是一个事实，没有人（据我所知）为此（还）投入了大量工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-02T16:50:39.333

一般来说，不会，尽管[根据经验](https://stackoverflow.com/questions/926266/performance-optimization-strategies-of-last-resort/927773#927773)，我可以查看一个我以前从未见过的系统并识别出一些容易出现性能问题的设计方法：

*   就代码行数或类数而言，它有多大？这与过度设计导致的性能问题密切相关。

*   有多少抽象层？每一层都有可能花费比必要更多的周期，并且这种影响会复合，尤其是如果每个操作都被认为是“非常有效”的。

*   是否有需要保持一致的单独数据结构？如果是这样，这是如何完成的？如果尝试通过通知保持数据结构紧密同步，这是一个危险信号。

*   在系统输入信息的类别中，其中一些是否会在低频下发生变化？如果是这样，很可能它应该被“编译”而不是“解释”。这在性能和易于开发方面都可能是一个巨大的胜利。

*   一个常见的主题是：程序员 A 创建包装复杂操作的函数，例如数据库访问以收集大量信息。程序员 A 认为这对其他程序员非常有用，并希望这些功能在一定程度上被使用，而不是随意使用。程序员 B 欣赏这些强大的功能并经常使用它们，因为它们只需一行代码就可以完成很多工作。（程序员 B 和 A 可以是同一个人。）您可以看到这如何导致性能问题，特别是如果分布在多个层上。

这些是首先想到的事情。

# c# - windows启动时的应用

> ID：929754
> 
> 赞同：0
> 
> 时间：2009-05-30T13:49:54.947
> 
> 标签：c#, startup

我希望在 Windows 用户登录后和 Windows 桌面出现之前加载我的 C# 应用程序。目前我将我的应用程序启动路径添加到注册表运行键。它正确加载了我的应用程序，但出现了 windows windows 桌面 [2 sec] 然后我的应用程序运行

**笔记：**

我的应用程序使用 winapi 创建单独的桌面，而我运行它的应用程序暂时隐藏了桌面。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T14:29:02.230

这实在是做不到。Windows 非常努力地在用户登录后立即启动桌面和资源管理器响应。这对用户来说是最重要的。

你的目标可能是崇高的，但它们与用户想要的不一致。所以总的来说，它们与 Windows 的工作方式不一致（尤其是 Win-7）。

如果您的软件需要提前运行而无需与用户交互，那么服务就是他们的必经之路。需要注意的是，在 Vista 和更高版本的 Windows 系统中，服务无法与用户交互 - 例如，它们不能拥有自己的图形用户界面。带有 UI 的服务本质上是不安全的。

对软件进行分区的一种方法是将一些东西放在服务中，并在其上放置一个 think UI 层。COM 和 Local RPC 是服务和 UI 层之间通信的不错选择。

请注意，您需要在此处进行操作以防止您的组件减慢启动速度。表现不佳的应用程序是引导路径中的最大问题之一。您可以使用[Windows Performance Toolkit进行研究](http://msdn.microsoft.com/en-us/performance/default.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T01:21:17.950

我认为这*有点*可能，但你真的需要做很多额外的工作。您可以做的是用您自己的代码替换 Windows Shell，但此时您将全权负责与用户交互的 UI。

如果您的代码不是“恰到好处”，那么您最终可能会安装无法使用的 Windows，而且我不确定您的用户是否会非常感激。

另请注意，您通常直观地希望在 Windows 机器上可用的某些功能是您将无法再访问的 shell 的一部分。有关详细信息，请尝试以[http://en.wikipedia.org/wiki/Windows_shell_replacement](http://en.wikipedia.org/wiki/Windows_shell_replacement)作为起点。

**附录**：
我自己对实现这一点的技术上实际涉及的内容只有最模糊的了解，但[http://dustyant.com/articles/deeshell/](http://dustyant.com/articles/deeshell/)似乎是对基础知识的一个不错的解释。再一次……*这里是龙*确保你在虚拟机或其他东西中这样做，这样你就不会最终填充你的主要 Windows 安装。

简单地说一下“Shell Replacement”的含义：登录后，Windows 会启动一个名为“explorer”的应用程序（不确定这是否仍然适用于 Vista / Win 7...我有一个模糊的回忆，它最近涉及更多） ，它基本上绘制桌面、任务栏等......可以告诉 Windows 启动不同的应用程序而不是默认的图形 shell。此时，您可以控制 Windows 的主 UI……这意味着您*负责 Windows 通常在 shell 中执行的所有操作*……为您提供了很多控制权和灵活性，但可能还有很多令人头疼的问题。

# php - 获取zlib中未压缩数据的大小？

> ID：929757
> 
> 赞同：6
> 
> 时间：2009-05-30T13:50:36.817
> 
> 标签：php, c, compression, size, zlib

我正在创建包含各种文件上传服务的东西，我需要存储使用 zlib 的 compress() 函数压缩的数据。我通过已经压缩的 Internet 发送它，但我需要知道远程服务器上未压缩的文件大小。有什么方法可以在不先解压缩（）服务器上的数据的情况下找出这些信息，只是为了提高效率？我现在就是这样做的，但如果有捷径，我很乐意走。

顺便问一下，为什么叫解压？这听起来对我来说很可怕，我一直以为它会减压......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T13:54:32.003

我对此表示怀疑。我不相信这是底层 zlib 库从内存中提供的东西（尽管我使用它已经 7 或 8 年了，但最新的文档似乎并未表明已添加此功能）。

一种可能性是传输另一个包含未压缩大小的文件（例如，同时传输`file.zip`和`file.zip.size`），但这似乎充满危险，特别是如果您弄错了大小。

另一种选择是，如果服务器解压缩耗时但不必立即完成，则在较低优先级的后台任务中进行（如`nice`在 Linux 下）。但同样，如果尺寸检查器开始落后（上传太多），可能会有缺点。

而且我倾向于用“爆炸性减压”来考虑减压，这不是一个好用的词:-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T15:30:49.937

如果您使用原始“压缩”格式上传，那么您将无法获得有关上传数据大小的信息。Pax 在这方面是正确的。
您可以将其存储为压缩缓冲区开头的 4 字节标头 - 假设文件大小不超过 4GB。
以一些 C 代码为例：

```
 uint8_t *compressBuffer = calloc(bufsize + sizeof (uLongf), 0);
 uLongf compressedSize = bufsize;
 *((uLongf *)compressBuffer) = filesize;
 compress(compressBuffer + sizeof (uLongf), &compressedSize, sourceBuffer, bufsize); 
```

然后发送大小为compressedSize + sizeof (uLongf) 的完整compressBuffer。当您在服务器端收到它时，您可以使用以下代码取回数据：

```
 // data is in compressBuffer, assume you already know compressed size.
 uLongf originalSize = *((uLongf *)compressBuffer);
 uint8_t *realCompressBuffer = compressBuffer + sizeof (uLongf); 
```

如果您不信任客户端发送正确的大小，那么您将需要对服务器大小执行某种未压缩数据检查。使用 uncompress to /dev/null 的建议是合理的。
如果您要上传 .zip 文件，它包含一个目录，该目录会告诉您文件未压缩时的大小。再次，此信息被内置到文件格式中，尽管这受恶意客户端的影响。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-30T15:19:17.963

zlib 格式没有原始输入大小的字段，因此我怀疑您是否能够在不模拟数据解压缩的情况下做到这一点。[gzip 格式](http://www.gzip.org/zlib/rfc-gzip.html#header-trailer)有一个“输入大小”( `ISIZE`) 字段，您可以使用它，但您可能希望避免更改压缩格式或让客户端发送文件大小。

但是，即使您使用不同的格式，如果您不信任客户端，您仍然需要进行更昂贵的检查，以确保未压缩的数据是客户端所说的大小。在这种情况下，您可以做的是降低*uncompress-to-/dev/null*过程的成本，确保 zlib 不会将输出数据写入任何地方，因为您只想知道未压缩的大小。

# business-objects - 多语言数据库设计业务类

> ID：929758
> 
> 赞同：1
> 
> 时间：2009-05-30T13:50:51.213
> 
> 标签：business-objects, business-logic, business-logic-layer

我在这里发布了一个关于多语言数据库设计的问题，
[][多语言数据库设计的最佳实践是什么？](https://stackoverflow.com/questions/929410/what-is-best-practices-for-multilanguage-database-design)
我喜欢 Martin 的建议，但现在我有一个问题，创建业务对象的最佳方式是什么？如果我将创建包含 ProductTranslation 对象的产品，那么 UI 中的绑定和工作将会很复杂，如果只有本地化的对象，我将不得不为 CMS 创建不同的对象
非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T14:32:17.793

很难回答，因为这取决于您的确切需求。我们在一个地方拥有的是这个（基于另一个问题中描述的数据库模型）：

*   业务对象是在数据库之后建模的，这意味着我们有一个 Product 类，它有一个 ProductTranslation 对象的集合
*   在产品类中，我们有多语言数据的属性，例如描述
*   这些属性的getter查找正确的翻译对象（基于当前语言）并返回相应的值

一个非常简单的示例（仅显示相关部分）：

```
class ProductTranslation
{
    public string Description;
}
public class Product
{
    private List<ProductTranslation> _translations;

    private ProductTranslation GetTranslation(string language)
    {
        // return translation for specified language
        // or return translation for default language           
    }

    public string Description
    {
        get
        {
            return GetTranslation(GetCurrentLanguage()).Description;
        }
    }       
} 
```

我们为 ASP.NET Web 应用程序选择了这种方法。每个用户的 CurrentLanguage 可能不同（用户可以为 UI 和数据选择他们喜欢的语言）。这种方法允许我们为所有用户全局缓存数据。

根据您的需要，这种方法可能不是最好的。例如，最好将 Product 和 ProductTranslation 表建模为一个业务对象（产品），然后为特定语言加载（例如，如果数据是只读的并且不需要在应用程序范围内缓存它）。

# ruby - 不可重现的字符串比较，强制 elsif 失败

> ID：929760
> 
> 赞同：0
> 
> 时间：2009-05-30T13:51:55.347
> 
> 标签：ruby, string-comparison, ruby-1.8

在回答[这个代码高尔夫问题](https://stackoverflow.com/questions/928563/code-golf-evaluating-mathematical-expressions)时，我在回答中遇到了一个问题。

我一直在对此进行测试，尽管 IRB 具有正确的行为，但我什至无法在代码中进行这两个比较。我*真的*需要一些帮助。

这是代码，下面将解释问题。

```
def solve_expression(expr)
  chars = expr.split '' # characters of the expression
  parts = []  # resulting parts
  s,n = '','' # current characters

  while(n = chars.shift)
    if (s + n).match(/^(-?)[.\d]+$/) || (!chars[0].nil? && chars[0] != ' ' && n == '-') # only concatenate when it is part of a valid number
      s += n
    elsif (chars[0] == '(' && n[0] == '-') || n == '(' # begin a sub-expression
      p n # to see what it breaks on, ( or -
      negate = n[0] == '-'
      open = 1
      subExpr = ''
      while(n = chars.shift)
        open += 1 if n == '('
        open -= 1 if n == ')'
        # if the number of open parenthesis equals 0, we've run to the end of the
        # expression.  Make a new expression with the new string, and add it to the
        # stack.
        subExpr += n unless n == ')' && open == 0
        break if open == 0
      end
      parts.push(negate ? -solve_expression(subExpr) : solve_expression(subExpr))
      s = ''
    elsif n.match(/[+\-\/*]/)
      parts.push(n) and s = ''
    else
      parts.push(s) if !s.empty?
      s = ''
    end
  end
  parts.push(s) unless s.empty? # expression exits 1 character too soon.

  # now for some solutions!
  i = 1
  a = parts[0].to_f # left-most value is will become the result
  while i < parts.count
    b,c = parts[i..i+1]
    c = c.to_f
    case b
      when '+': a = a + c
      when '-': a = a - c
      when '*': a = a * c
      when '/': a = a / c
    end
    i += 2
  end
  a
end 
```

问题发生在 的分配中`negate`。

当表达式之前的字符是破折号时，我需要否定为真，但条件甚至不起作用。`n == '-'`和`n[0] == '-'`，引用的形式无关紧要，每次都以 FALSE 结束。然而，我一直在使用这种精确的比较并且`n == '('`每次都能正常工作！

到底是怎么回事？为什么不起作用`n == '-'`，什么时候起作用`n == '('`？这是用 UTF-8 编码的，没有 BOM，UNIX 换行符。

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T14:52:34.630

你有：

```
if (s + n).match(/^(-?)[.\d]+$/) || (!chars[0].nil? && chars[0] != ' ' && n == '-')
      s += n
elsif (chars[0] == '(' && n[0] == '-') || n == '(' 
```

与`n`总是一个字符的字符串一样，如果`(chars[0] == '(' && n[0] == '-'))`为真，那么前面的条件 ,`(!chars[0].nil? && chars[0] != ' ' && n == '-')`也将为真。您的代码永远不会进入`if`if的第二部分`n[0]=='-'`。

如果您的`p n`行输出的是破折号，请确保它与您要查找的字符完全相同，而不是某个*看起来像*破折号的字符。Unicode 有多种破折号，也许您的代码或输入中有一个奇怪的 Unicode 破折号字符。

# linq - LINQ - 不选择某些字段？

> ID：929766
> 
> 赞同：9
> 
> 时间：2009-05-30T13:59:22.337
> 
> 标签：linq, linq-to-entities

我有一个与实体框架映射的 LINQ 查询，看起来像这样：

```
image = this.Context.ImageSet
                    .Where(n => n.ImageId == imageId)
                    .Where(n => n.Albums.IsPublic == true)
                    .Single(); 
```

这将返回单个图像对象并按预期工作。

但是，此查询返回数据库中我的 Image 表的所有属性。在正常情况下，这很好，但这些图像包含大量二进制数据，需要很长时间才能返回。

基本上，在当前状态下，我的 linq 查询正在执行：

```
Select ImageId, Name, Data
From Images
... 
```

但我需要一个执行此操作的查询：

```
Select ImageId, Name
From Images
... 
```

请注意，我想加载除数据之外的所有内容。（我可以在第二次异步传递中获取此数据）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-02T02:43:17.787

不幸的是，如果使用 LINQ to SQL，则没有最佳解决方案。

您有 3 个选项：

1.  您返回实体，带有上下文跟踪和所有，在这种情况下是图像，带有所有字段
2.  您选择字段并返回匿名类型
3.  你选择你的字段并返回一个强类型的自定义类，但是如果你想要的话，你会失去跟踪。

我喜欢 LINQ to SQL，但它就是这样。

**我对您的唯一解决方案是重组您的数据库，并将所有大数据移动到一个单独的表中，并从图像表链接到它。**

这样，在返回 Image 时，您只需在新的 DataID 字段中返回一个键，然后您可以在需要时访问更重的 Data。

干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T14:20:13.060

这将创建一个仅设置了这些字段的新图像。当您返回获取所选图像的数据时，我建议您继续获取完整的数据集，而不是尝试将其与现有的 id/name 数据合并。id/name 字段相对于数据可能很小，并且代码比尝试进行合并要简单得多。此外，可能不需要实际构造 Image 对象，使用匿名类型也可能适合您的目的。

```
image = this.Context.ImageSet
                    .Where(n => n.ImageId == imageId)
                    .Where(n => n.Albums.IsPublic == true)
                    .Select( n => new Image { ImageId = n.ImageId, Name = n.Name }
                    .Single(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-01T17:35:52.690

[如果使用 Linq 2 SQL] 在 DBML 设计器中，有一个选项可以延迟加载各个表列。对于您的大型二进制字段，将此设置为 true。然后，在实际使用之前不会加载该数据。

[给大家的问题：有谁知道实体框架是否支持 MSVS 2010 中延迟加载的 varbinary/varchar ？]

解决方案 #2（对于实体框架或 linq 2 sql）：

创建仅包含主键和 varchar(max)/varbinary(max) 的表视图。将其映射到 EF。

在您的实体框架设计器中，从表定义中删除 varbinary(max)/varchar(max) 属性（使其仅在视图中定义）。这应该将该字段从对该表的读/写操作中排除，尽管您可以使用记录器验证这一点。

通常，您将通过排除数据 blob 的表访问数据。当您需要 blob 时，您从视图中加载一行。我不确定您是否能够写入视图，我不确定您将如何写入。您可能能够写入视图，或者您可能需要编写一个存储过程，或者您可以为一个表创建一个 DBML 文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-30T18:28:15.080

至少现在你不能用**LINQ做到这一点......**

我知道的最好的方法是`View`为您需要的表创建没有大字段的表并使用**LINQ**`View`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-01T17:33:20.447

或者，您可以在查询表达式中使用 select new ...

```
var image =
(
    from i in db.ImageSet
    where i.ImageId == imageId && i.Albums.IsPublic
    select new
    {
        ImageId = i.ImageId,
        Name = i.Name
    }
).Single() 
```

LINQ 查询表达式实际上在编译时被转换为 Lambda 表达式，但我通常更倾向于使用查询表达式，因为我发现它更具可读性和可理解性。

谢谢**:)**

# xcode - Xcode：从快照中恢复完整的项目？

> ID：929770
> 
> 赞同：5
> 
> 时间：2009-05-30T14:03:37.430
> 
> 标签：xcode, snapshot

今天我正在使用 Xcode 快照功能，我想知道如果所有代码都丢失了，我是否可以从快照重新创建一个完整的项目。

在我看来，在快照管理器中，我只能看到当前项目的快照，而不是所有项目的快照。因此，如果我的项目文件丢失或损坏，是否可以从快照中恢复我的文件？

我也想知道是否保存了快照。不在我已经发现的项目文件夹中。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-04T17:08:07.960

转到 Xcode Organizer 中的“Projects”选项卡并选择您的项目。您应该会看到所有已创建的快照。选择要还原到的快照，然后选择“导出快照”将其保存到磁盘的某个位置。您导出到磁盘的是项目的“恢复”版本。

我同意 SVN 和 Git 等系统在版本控制方面远远优于 Xcode 的快照机制。但是，快照机制可能非常有用。例如，我刚刚对一个项目进行了更改。在进行更改之前，Xcode 询问我是否要拍摄快照。更改后，我发现我不想进行更改，因此我使用此机制将项目恢复到之前的状态。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T14:07:39.497

在过于信任 Xcode 快照功能之前，我是否建议您考虑使用[CVS](http://www.nongnu.org/cvs/)、[SVN](http://subversion.tigris.org/)或[Perforce](http://www.perforce.com/)（集成在 Xcode 中）进行源代码管理？

对我来说，快照的主要用途是在重构会话期间：在应用重构更改之前创建快照，以便能够恢复修改。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-30T15:53:16.417

查看您的主文件夹：

```
~/Library/Application Support/Developer/Shared/SnapshotRepository.sparseimage 
```

在此您将找到项目快照。

但是，你最好使用适当的源代码控制系统

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-16T13:41:45.483

由于有一些关于版本控制系统的评论。我真的建议给 git 一个机会。如果您将特定于 xcode 的文件包含到 git 存储库中，那么您将具有与快照机制相同的效果。

因此，如果您目前有一个不受 git 控制的项目，您可以使用这些方法之一来创建一个 git 存储库：

[将 Git 与现有 XCode 项目一起使用](https://stackoverflow.com/questions/5383609/using-git-with-an-existing-xcode-project)

然后不要忘记添加 .xcodeproj 目录，事情应该会更顺利一些。

有时我真的不喜欢 Linus Torwald，但 git 是我遇到过的最好的 VCS。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-28T23:46:51.760

本文档解释了如何恢复快照：http: [//developer.apple.com/library/ios/#documentation/IDEs/Conceptual/Xcode4TransitionGuide/SCM/SCM.html](http://developer.apple.com/library/ios/#documentation/IDEs/Conceptual/Xcode4TransitionGuide/SCM/SCM.html)

# css - 如何在 Ruby 中验证 XHTML、ATOM 和 CSS？

> ID：929772
> 
> 赞同：0
> 
> 时间：2009-05-30T14:04:08.770
> 
> 标签：css, xml, ruby, validation

我想对正在创建的静态 Web 内容进行验证。XHTML、ATOM 和 CSS 有什么好的验证器吗？（前两个将被任何通用 XML-DTD 验证器覆盖。）

**之后**

我没有指定我想要*本地*验证，而不是使用 W3C 服务的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T22:10:18.443

Nokogiri ( [http://github.com/tenderlove/nokogiri/tree/master](http://github.com/tenderlove/nokogiri/tree/master) ) 是解析 XML/XHTML/HTML/etc 的好工具，它看起来也可以验证：

```
Nokogiri::XML.parse(string_or_io, nil, nil, Nokogiri::XML::PARSE_DTDVALID) 
```

目前，我不相信你会找到一个纯 ruby​​ 项目来验证你的 CSS 指令，但是有很多项目可以让你使用 ruby​​ 代码生成有效的 CSS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T15:34:26.123

检查[W3C 验证器 Ruby Gem](http://code.dunae.ca/w3c_validators/)。

> W3C Validators 是万维网联盟在线验证服务的 Ruby 包装器。
> 
> 它支持标记验证器、提要验证器和 CSS 验证器。

否则，[W3C 的 Validator 有一个 SOAP API](http://validator.w3.org/docs/api.html)，您甚至可以从 Ruby 中使用它，或者有一篇文章演示了如何[使用 libxml 在 Ruby 中验证 HTML](http://overstimulate.com/articles/valid-wellformed-html-libxml-ruby-rails)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-31T10:37:33.097

就像一个信息：Nokogiri 1.3.0 于今天发布，现在在官方版本中包含 XML 验证类。无需获取主干版本。

[http://nokogiri.rubyforge.org/nokogiri/](http://nokogiri.rubyforge.org/nokogiri/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-31T15:23:43.190

我使用以下内容通过我们的测试套件验证我们所有页面上的标记： [assert_valid_markup](http://github.com/wr0ngway/assert_valid_markup/)

它提供了很好的标记测试，例如：

```
class FooControllerTest < Test::Unit::TestCase
  def test_bar_markup
    get :bar
    assert_valid_markup
  end
end 
```

或者

```
class FooControllerTest < Test::Unit::TestCase
  def test_bar_markup
    assert_valid_markup "<div>Hello, world.</div>"
  end
end

# For the ultimate in convenience, use the class-level method to validate a slew of
# actions in one line. Par exemple:

class FooControllerTest < Test::Unit::TestCase
  assert_valid_markup :bar, :baz, :qux
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T14:10:54.997

[w3c 的标记验证服务](http://validator.w3.org/)可以验证 XHTML。

还有一个[CSS 验证服务](http://jigsaw.w3.org/css-validator/)和一个[提要验证服务](http://validator.w3.org/feed/)。

那是你要找的吗？

如果您想从 ruby​​ 程序内部进行验证，[这里](http://devlicio.us/blogs/sergio_pereira/archive/2008/04/02/xhtml-validation-script-using-ruby.aspx)有一篇文章解释了如何使用此服务进行验证。我没试过，抱歉。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-09T17:28:43.160

我参加聚会有点晚了，但是……对于 HTML 的本地验证——你可以看看我的 html_validation gem。它包装了 W3c 推出的 HTML Tidy。它带有一个 RSpec 匹配器。

[https://github.com/ericbeland/html_validation](https://github.com/ericbeland/html_validation)

# java - 计算两点之间的距离

> ID：929773
> 
> 赞同：20
> 
> 时间：2009-05-30T14:05:26.520
> 
> 标签：java

我需要创建一个计算两点之间距离的类。我被卡住了，我是一个完全的初学者。这是我的课程：

```
package org.totalbeginner.tutorial;

public class Point {

    public double x;
    public double y;

    Point(double xcoord, double ycoord){
        this.x = xcoord;
        this.y = ycoord;
    }

    public double getX() {
        return x;
    }

    public double getY() {
        return y;
    }    
} 
```

第二课。

```
package org.totalbeginner.tutorial;

public class Line {

    double x;
    double y;

    Point p1 = new Point(2.0,2.0);
    Point p2 = new Point(4.0,4.0);
    Point mp = new Point(x,y);

    public void midpoint() {
        x = (p1.getX() + p2.getX()) / 2;
        y = (p1.getY() + p2.getY()) / 2;
    }
} 
```

我不确定如何在两个定义的点之间获取点对象（中点）。

我可以创建点对象，但我不确定如何通过`midpoint()`位于这两个点对象之间的方法返回点对象。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-05-30T14:10:57.367

平面上两点 (x1,y1) 和 (x2,y2) 之间的距离为：

```
 ____________________
   /       2          2
 \/ (y2-y1)  + (x2-x1) 
```

但是，如果您想要的只是两点的中点，您应该将中点函数更改为：

```
public Point midpoint (Point p1, Point p2) {
    return new Point ((p1.getX() + p2.getX()) / 2, (p1.getY() + p2.getY()) / 2);
} 
```

这将返回一个全新的点对象，其点设置为给定两点的中间（无需关心任何其他数学）。而且，由于你的第二类是一条线，你只需要两个端点来描述它，所以我会做一些小的改动。

首先`Point.java`：

```
class Point {
    double x, y;
    Point (double xcoord, double ycoord) {
        this.x = xcoord;
        this.y = ycoord;
    }
    public double getX() { return x; }
    public double getY() { return y; }
} 
```

然后`Line.java`：

```
public class Line {
    Point p1, p2;
    Line (Point point1, Point point2) {
        this.p1 = point1;
        this.p2 = point2;
    }
    public Point midpoint() {
        return new Point ((p1.getX()+p2.getX())/2, (p1.getY()+p2.getY())/2);
    }
    public double abstand() {
        return Math.sqrt(
            (p1.getX() - p2.getX()) *  (p1.getX() - p2.getX()) + 
            (p1.getY() - p2.getY()) *  (p1.getY() - p2.getY())
        );
    }
    static public void main (String args[]) {
        Line s = new Line (new Point(2.0, 2.0), new Point(5.0, 6.0));
        Point mp = s.midpoint();
        System.out.println ("Midpoint = (" + mp.getX() + "," + mp.getY() + ")");
        double as = s.abstand();
        System.out.println ("Length   = " + as);
    }
} 
```

这两个文件在编译并使用端点`2,2`和`5,6`（经典 3/4/5 直角三角形的斜边）运行时，生成正确的：

```
Midpoint = (3.5,4.0)
Length   = 5.0 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-05-30T14:10:39.803

简单毕达哥... root(dx^2 + dy^2)

```
Math.sqrt(Math.pow((p2.getX() - p1.getX()), 2) + Math.pow((p2.getY() - p1.getY()), 2)) 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-30T14:18:06.900

```
 X
 +
 |\
 | \
a|  \c
 |   \
 |    \
 +-----+ 
    b   Y 
```

想象 X 和 Y 是平面上的点。然后`a`是`X.y - Y.y`和`b`是`Y.x - X.x`。的长度`c`是它们的距离，并且是该三角形的斜边的长度。它是使用计算的

```
sqrt(a^2 + b^2); 
```

既然你看到我们是平方`a`和`b`，它们的符号是不相关的 - 它会归结为相同的。所以这个方法总是有效的，无论点在哪里。

查找[`Pythagorean theorem`](http://en.wikipedia.org/wiki/Pythagorean_theorem)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-30T17:47:24.320

您真的需要距离，还是只想获得中点？因为从您的代码片段来看，您似乎只想在两个现有点之间创建一个新点。

如果你真的只是在中点之后，你真的不需要整个第二类（即“线”）来完成它。由于您要查找的东西也是一个点，因此将构造函数添加到现有的 Point 类是有意义的，就像这样..

```
Point(Point a, Point b)
{
  x = (a.x + b.x) / 2;
  y = (a.y + b.y) / 2;
} 
```

..然后，在其他地方假设您已经有几点要使用它，因此您可以使用构造函数：

```
Point p1 = new Point(2,2);
Point p2 = new Point(4,4);
Point midpoint = new Point(p1, p2); 
```

如果你真的想要两点之间的距离，那并不是任何一点的属性，所以使用静态方法是有意义的，就像这样

```
public static double distance(Point a, Point b)
{
  double dx = a.x - b.x;
  double dy = a.y - b.y;
  return Math.sqrt(dx * dx + dy * dy);
} 
```

并返回调用代码，您可以这样使用它：

```
Point p1 = new Point(2,2);
Point p2 = new Point(4,4);
System.out.println("Distance between them is " + Point.distance(p1, p2)); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-02-26T15:20:09.363

您可以为此使用数学函数：

```
public Point midpoint() {
    //Calculate the difference between the old and new x/y
    double dx = p1.getX() - p2.getX();
    double dy = p1.getY() - p2.getY();

    double newX = Math.pow(dx, 2D);
    double newY = Math.pow(dz, 2D);
    return new Point(newX, newZ);
} 
```

**Math.pow**处理负值等问题。对您而言，使用 Math.pow 为您提供了一种安全的方法，因为它内置了很多检查。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-30T14:51:40.670

**正如其他人所说，**您可以使用勾股定理。**这是[Wolfram Demostration Project](http://demonstrations.wolfram.com/DistanceBetweenTwoPoints/)的视觉演示。**

 **[替代文字 http://demonstrations.wolfram.com/DistanceBetweenTwoPoints/HTMLImages/index.en/popup_5.jpg](http://demonstrations.wolfram.com/DistanceBetweenTwoPoints/HTMLImages/index.en/popup_5.jpg)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-30T18:04:46.383

在您的第二堂课中，您似乎正在尝试设置用于构造变量的`x`和的值。您所有的公式都是正确的，但是您需要考虑执行所有操作的*顺序*。在代码中，它创建了and变量，从 0 开始，然后是各种s。并且仍然为 0，因此设置为。`y``mp`*`x``y``Point``x``y``mp``Point(0, 0)`*

 *您可能想要做的是更改 to 的返回*类型*，这样当您调用该函数时，您会得到一个. 然后您可以使用您计算的值创建一个新对象。它应该看起来更像这样：`midpoint``Point``Point``Point`

```
public Point midpoint() {
    // calculate the middle x and y
    double x = (p1.getX() + p2.getX()) / 2;
    double y = (p1.getY() + p2.getY()) / 2;
    // now make a new Point with those values, and return it
    return new Point(x, y);
} 
```

# javascript - 合并对象（关联数组）

> ID：929776
> 
> 赞同：148
> 
> 时间：2009-05-30T14:08:32.223
> 
> 标签：javascript, object

在 JavaScript 中合并两个关联数组的最佳/标准方法是什么？每个人都只是通过滚动自己的`for`循环来做到这一点吗？

* * *

## 回答 #1

> 赞同：205
> 
> 时间：2010-07-05T21:23:08.770

使用 jquery 你可以调用`$.extend`

```
var obj1 = {a: 1, b: 2};
var obj2 = {a: 4, c: 110};

var obj3 = $.extend(obj1, obj2); 

obj1 == obj3 == {a: 4, b: 2, c: 110} // Pseudo JS 
```

（assoc.数组是js中的对象）

看这里：[http ://api.jquery.com/jQuery.extend/](http://api.jquery.com/jQuery.extend/)

* * *

**编辑：**就像 rymo 建议的那样，最好这样做：

```
obj3 = $.extend({}, obj1, obj2); 
obj3 == {a: 4, b: 2, c: 110} 
```

在这里 obj1（和 obj2）保持不变。

* * *

**编辑2：**在 2018 年，方法是通过`Object.assign`：

```
var obj3 = Object.assign({}, obj1, obj2); 
obj3 === {a: 4, b: 2, c: 110} // Pseudo JS 
```

如果使用 ES6，这可以通过[Spread Operator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax)来实现：

```
const obj3 = { ...obj1, ...obj2 }; 
```

* * *

## 回答 #2

> 赞同：66
> 
> 时间：2016-04-08T09:58:26.913

现在在 2016 年，我会说最好/标准的方法是**Object.assign()**
纯 Javascript。不需要 jQuery。

```
obj1 = {a: 1, b: 2};
obj2 = {a: 4, c: 110};
obj3 = Object.assign({},obj1, obj2);  // Object {a: 4, b: 2, c: 110} 
```

更多信息、示例和 polyfill：
[https ://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2009-05-30T14:16:45.763

Prototype 是这样做的：

```
Object.extend = function(destination, source) {
    for (var property in source) {
        if (source.hasOwnProperty(property)) {
            destination[property] = source[property];
        }
    }
    return destination;
}; 
```

称为，例如：

```
var arr1　= { robert: "bobby", john: "jack" };
var arr2 = { elizabeth: "liz", jennifer: "jen" };

var shortnames = Object.extend(arr1,arr2); 
```

**编辑**：添加了hasOwnProperty（）检查，正如bucabay在评论中正确指出的那样

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2012-02-05T18:43:54.787

把事情简单化...

```
function mergeArray(array1,array2) {
  for(item in array1) {
    array2[item] = array1[item];
  }
  return array2;
} 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2011-12-16T20:08:18.687

[Underscore](http://documentcloud.github.com/underscore/#extend)还有一个 extend 方法：

> 将源对象中的所有属性复制到目标对象。它是有序的，因此最后一个源将覆盖先前参数中的同名属性。

```
_.extend(destination, *sources) 

_.extend({name : 'moe'}, {age : 50});
=> {name : 'moe', age : 50} 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-05-30T16:29:51.610

在[dojo](https://dojotoolkit.org/)中，2-objects/arrays “合并”将是`lang.mixin(destination, source)`——您还可以将多个源混合到一个目标中，等等——有关详细信息，请参阅[mixin 函数的参考](https://dojotoolkit.org/reference-guide/1.10/dojo/_base/lang.html#mixin)。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-05-30T16:07:42.673

如果名称相同但值不同，您是否要覆盖属性？

你想永久更改其中一个原始对象，

还是您想要返回一个新的合并对象？

```
function mergedObject(obj1, obj2, force){
    for(var p in obj1) this[p]= obj1[p];
    for(var p in obj2){
        if(obj2.hasOwnProperty(p)){
            if(force || this[p]=== undefined) this[p]= obj2[p];
            else{
                n= 2;
                while(this[p+n]!== undefined)++n;
                this[p+n]= obj2[p];
            }
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-02-12T01:02:52.147

# 滚动你自己的*扩展/混合*函数

```
function extend(objects) {
    var args
        , first = Array.prototype.slice.call(arguments, 0, 1)[0]
        , second;

    if (arguments.length > 1) {
        second = Array.prototype.splice.call(arguments, 1, 1)[0];
        for (var key in second) {
            first[key] = second[key];
        }
        args = Array.prototype.slice.call(arguments, 0);
        return extend.apply(this, args);
    }

    return first;
} 
```

...

```
var briansDirections = {
    step1: 'Remove pastry from wrapper.',
    step2: 'Place pastry toaster.',
    step3: 'Remove pastry from toaster and enjoy.',
};
extend(briansDirections, { step1: 'Toast Poptarts' }, { step2: 'Go ahead, toast \'em' }, { step3: 'Hey, are you sill reading this???' }); 
```

...

这只是递归地扩展了*一堆*对象。另外，请注意，此递归函数是 TCO（*尾调用优化*），因为它的返回是对自身的最后一次调用。

此外，您可能需要*目标属性*。在这种情况下，您可能希望基于 、 或其他属性来压缩`id`对象`quantity`。这种方法可以写一本关于它的小书，并且需要对象并置并且可能变得非常复杂。我为此编写了一个小型库，可根据要求提供。

希望这可以帮助！

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-05-30T14:13:12.747

1.  在Javascript中没有关联数组的概念，有对象
2.  合并两个对象的唯一方法是循环获取它们的属性并将指向它们的非原始类型值的指针和原始类型的值复制到另一个实例

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2019-01-05T15:35:35.717

在 2019 年，您有 2 个不错的选择：

**对象分配**[ [doc](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign) ]

```
const result = Object.assign({}, baseObject, updatingObject); 
```

**对象传播**[ [doc](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax) ]

```
const result = { ...baseObject, ...updatingObject}; 
```

第一个往往更安全，更标准和多价。[这里](https://stackoverflow.com/questions/32925460/object-spread-vs-object-assign)有一个很好的利弊

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-01-13T22:34:34.987

Yahoo UI (YUI) 也有一个辅助函数：

[http://developer.yahoo.com/yui/examples/yahoo/yahoo_merge.html](http://developer.yahoo.com/yui/examples/yahoo/yahoo_merge.html)

```
YAHOO.namespace('example');

YAHOO.example.set1 = { foo : "foo" };
YAHOO.example.set2 = { foo : "BAR", bar : "bar" };
YAHOO.example.set3 = { foo : "FOO", baz : "BAZ" };

var Ye = YAHOO.example;

var merged = YAHOO.lang.merge(Ye.set1, Ye.set2, Ye.set3); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-07-16T16:47:20.970

jquery 有一个用于深拷贝的布尔值。你可以这样做：

```
MergeRecursive = function(arr1, arr2){
    $.extend(true, arr1, arr2);
    return arr1;                
}; 
```

您也可以编辑此函数以支持 n 数组合并。

```
ArrayMergeRecursive = function(){
     if(arguments.length < 2){
          throw new Error("ArrayMergeRecursive: Please enter two or more objects to merge!");
     }

    var arr1=arguments[0];
    for(var i=0; i<=arguments.length; i++ ){
        $.extend(true, arr1, arguments[i]);                 
    }

    return arr1;                
}; 
```

所以现在你可以做

```
var arr1 = {'color': {'mycolor': 'red'}, 3: 5},
    arr2 = {4: 10, 'color': {'favorite': 'green', 0: 'blue'}},
    arr3 = ['Peter','Jhon','Demosthenes'],
    results = ArrayMergeRecursive(arr1, arr2, arr3); // (arr1, arr2 ... arrN)
console.log("Result is:", results); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2012-06-26T10:59:31.817

我需要一个深度对象合并。因此，所有其他答案都对我没有太大帮助。_.extend 和 jQuery.extend 做得很好，除非你有一个像我一样的递归数组。但这还不错，您可以在五分钟内编程：

```
var deep_merge = function (arr1, arr2) {
    jQuery.each(arr2, function (index, element) {
        if (typeof arr1[index] === "object" && typeof element === "object") {
            arr1[index] = deep_merge(arr1[index], element);
        } else if (typeof arr1[index] === "array" && typeof element === "array") {
            arr1[index] = arr1[index].concat(element);
        } else {
            arr1[index] = element;
        }
    });
    return arr1;
} 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-03-24T08:03:12.457

要在 jQuery 中合并数组，$.merge 怎么样？

```
var merged = $.merge([{id:3, value:'foo3'}], [{id:1, value:'foo1'}, {id:2, value:'foo2'}]);
merged[0].id == 3;
merged[0].value == 'foo3';
merged[1].id == 1;
merged[1].value == 'foo1';
merged[2].id == 2;
merged[2].value == 'foo2'; 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-04-21T16:32:48.470

## 递归解决方案（也扩展对象数组）+ null 检查

```
var addProps = function (original, props) {
    if(!props) {
        return original;
    }
    if (Array.isArray(original)) {
        original.map(function (e) {
            return addProps(e, props)
        });
        return original;
    }
    if (!original) {
        original = {};
    }
    for (var property in props) {
        if (props.hasOwnProperty(property)) {
            original[property] = props[property];
        }
    }
    return original;
}; 
```

测试

```
console.log(addProps([{a: 2}, {z: 'ciao'}], {timestamp: 13}));
console.log(addProps({single: true}, {timestamp: 13}));
console.log(addProps({}, {timestamp: 13}));
console.log(addProps(null, {timestamp: 13}));

[ { a: 2, timestamp: 13 }, { z: 'ciao', timestamp: 13 } ]
{ single: true, timestamp: 13 }
{ timestamp: 13 }
{ timestamp: 13 } 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-06-06T16:36:38.123

这是最好的解决方案。

```
obj1.unshift.apply( obj1, obj2 ); 
```

此外，`obj1`可以毫无问题地在循环内生长。（可以说`obj2`是动态的）

# python - 为什么分配给我的全局变量在 Python 中不起作用？

> ID：929777
> 
> 赞同：78
> 
> 时间：2009-05-30T14:09:18.337
> 
> 标签：python, global-variables, scope

我在尝试理解 python 范围规则时遇到了可怕的麻烦。

使用以下脚本：

```
a = 7

def printA():
    print "Value of a is %d" % (a)

def setA(value):
    a = value
    print "Inside setA, a is now %d" %(a)

print "Before setA"
printA()
setA(42)
print "After setA"
printA() 
```

给出了意想不到的（对我而言）输出：

```
    设置A之前
    a 的值为 7
    在 setA 中，a 现在是 42
    设置A之后
    a 的值为 7

```

我希望最后一次打印 a 的值是 42，而不是 7。关于 Python 的全局变量范围规则，我缺少什么？

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2009-05-30T14:12:14.883

全局变量是特殊的。如果您尝试分配给`a = value`函数内部的变量，它会在函数内部创建一个新的局部变量，即使存在同名的全局变量也是如此。要改为访问全局变量，请在函数内添加一条[`global`语句：](http://docs.python.org/reference/simple_stmts.html#the-global-statement)

```
a = 7
def setA(value):
    global a   # declare a to be a global
    a = value  # this sets the global value of a 
```

有关Python 命名和绑定规则的详细说明，另请参阅[命名和绑定。](http://docs.python.org/reference/executionmodel.html#naming-and-binding)

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-30T14:17:00.927

理解这一点的诀窍是，当您使用 = 分配给变量时，您还将其声明为局部变量。因此，setA(value) 并没有更改全局变量 a 的值，而是将一个局部变量（恰好称为 a）设置为传入的值。

如果您尝试在 setA(value) 的开头打印 a 的值，这会变得更加明显，如下所示：

```
def setA(value):
    print "Before assignment, a is %d" % (a)
    a = value
    print "Inside setA, a is now %d" % (a) 
```

如果你尝试运行这个 Python 会给你一个有用的错误：

```
回溯（最近一次通话最后）：
  文件“scopeTest.py”，第 14 行，在
    设置A(42)
  文件“scopeTest.py”，第 7 行，在 setA 中
    print "赋值前，a 为 %d" % (a)
UnboundLocalError：分配前引用的局部变量“a”

```

这告诉我们 Python 已经决定 setA(value) 函数有一个称为 a 的局部变量，当您在函数中分配给它时，您会更改它。如果您没有在函数中分配 a（如 printA()），那么 Python 将使用全局变量 A。

要将变量标记为全局变量，您需要在 Python 中使用 global 关键字，*在要使用全局变量的范围内*。在这种情况下，它在 setA(value) 函数中。所以脚本变成了：

```
a = 7

def printA():
    print "Value of a is %d" % (a)

def setA(value):
    global a
    a = value
    print "Inside setA, a is now %d" %(a)

print "Before setA"
printA()
setA(42)
print "After setA"
printA() 
```

这一行添加告诉 Python，当您在 setA(value) 函数中使用变量 a 时，您正在谈论的是全局变量，而不是局部变量。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-01-16T10:03:30.887

在函数内部，*a*被视为局部变量，需要定义

> 全球

在方法内部使用它之前，即使您已经在方法外部定义了它。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T22:26:57.287

Python 没有其他语言的变量概念。您有“某处”的对象，并且您有对这些对象的引用。= 用于将这些对象分配给*当前*命名空间中的引用。

您在 setA 函数的命名空间中创建一个名称 a ，该名称引用值所指的对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-07T11:42:27.523

函数的执行引入了一个新的符号表，用于函数的局部变量。更准确地说，函数中的所有变量赋值都将值存储在本地符号表中；而变量引用首先在局部符号表中查找，然后在封闭函数的局部符号表中查找，然后在全局符号表中查找，最后在内置名称表中查找。因此，全局变量不能在函数内直接赋值（除非在全局语句中命名），尽管它们可以被引用。

# iphone - 使用 AudioServices 在 iPhone 上停止播放声音样本

> ID：929785
> 
> 赞同：0
> 
> 时间：2009-05-30T14:12:49.767
> 
> 标签：iphone, cocoa-touch, audio, core-audio

我正在实现在用户拖动 UISlider 时播放的声音效果。

这是 IBAction：由 UISlider 的**Value Changed**事件调用

```
-(IBAction)playTone4; {
    AudioServicesPlaySystemSound(soundID4); 
} 
```

**当用户没有**拖动滑块但**没有释放**它时，我希望声音停止。

有没有办法做到这一点？似乎没有 AudioServices **Stop** SystemSound() 功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T14:49:03.657

**系统声音无法停止**。

有关更多信息，请参阅[**iPhone 编程指南：多媒体支持部分**](http://developer.apple.com/iphone/library/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/AudioandVideoTechnologies/AudioandVideoTechnologies.html#//apple_ref/doc/uid/TP40007072-CH19-SW35)。

为了达到预期的效果，我建议使用**AVAudioPlayer**或**audioQueues**。我提到的编程指南涵盖了您想了解的有关这些技术的所有内容。

# javascript - 自动打开第一张 Fancybox 图片

> ID：929787
> 
> 赞同：1
> 
> 时间：2009-05-30T14:14:52.977
> 
> 标签：javascript, jquery, json, fancybox

单击链接后，我会从 JSON 获取一些图像，然后单击其中一张图片时可以显示图库，但我希望第一张图像立即出现，作为一个事件，一旦JSON 已加载。这可能吗？

我的代码是：

```
$("#json-get")
    .css("cursor","pointer")
    .click(function(){
        $.getJSON("http://api.flickr.com/services/feeds/photos_public.gne?tags=cat&tagmode=any&format=json&jsoncallback=?",
            function(data){
                $.each(data.items, function(i,item){
                    $("<a/>").attr("rel", "group").addClass("json-im").appendTo("#imgs").attr("href", item.media.m).append(
                    $("<img/>")
                        .attr("src", item.media.m)
                    );
                });
                $("#imgs a").fancybox();
                // Load the first element
            });
}); 
```

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T14:29:12.073

尝试添加：

```
 $("#imgs a:first").trigger('click'); 
```

创建fancybox之后。

# php - 如何修复此 PHP XML 解析错误？

> ID：929796
> 
> 赞同：1
> 
> 时间：2009-05-30T14:18:48.663
> 
> 标签：php, xml, parsing

这是我的第一个问题:)。

我用 PHP 编写了一个小 twitter 应用程序，它向您的所有关注者发送 DM。我现在要做的是获取关注者列表。因此，通过 twitter api 并获取所有用户名，但由于某种原因会出现此解析错误。我是 php 新手（但对编程不太了解），实际上我昨天开始学习它，所以请放轻松；）。

这是代码：

```
$t= new twitter();
$t->username= $_GET["username"];
$t->password= $_GET["password"];
$fi = $t->followers();
    $xml[$page] = new SimpleXMLElement($fi[2]);
    $user1count=0;
    while(isset($xml[$page]->user[0])){
          foreach ($xml[$page]->user as $user) {
             $userdet[(string)$user->screen_name]=array( ’screen_name’=> (string)$user->screen_name, ‘location’=>(string)$user->location, ‘description’=>(string)$user-> description, ‘profile_image_url’=> (string)$user-> profile_image_url, ‘url’=>(string)$user-> url, ‘name’=>(string)$user->name );
             $user1details[$user1count]= (string)$user->screen_name;
             $user1count++;
           } 
          $page++;
          $fi=getfilecontents($friendsurl.$username1."xml?page".$page);
          if($fi[0]===false){
               echo ("Error :".$fi[1]);
               $err=new SimpleXMLElement($fi[2]);
               echo " ".$err->error." ";
               // echo ““;
               die();
          }
       $xml[$page] = new SimpleXMLElement($fi[2]);
    } 
```

错误说：

致命错误：在 /Applications/XAMPP/xamppfiles/htdocs/scripts/dmsend.php:125 中带有消息“字符串无法解析为 XML”的未捕获异常“异常”：125 堆栈跟踪：#0 /Applications/XAMPP/xamppfiles/htdocs/ scripts/dmsend.php(125): SimpleXMLElement->__construct('') #1 {main} 在第 125 行的 /Applications/XAMPP/xamppfiles/htdocs/scripts/dmsend.php 中抛出

谢谢！:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T14:21:42.183

看起来 $fi[2] 不是有效的 xml 字符串。我不是 100% 熟悉 twitter API，但我会做一个 var_dump($fi) 并评估开始返回的内容。从那里，您应该能够弄清楚发生了什么。

# ant - 使用 ant 创建带有标签的 javadoc

> ID：929799
> 
> 赞同：2
> 
> 时间：2009-05-30T14:20:20.750
> 
> 标签：ant, javadoc

我已经使用 {@see myPackage.MyClass} 等标签在 javadoc 中注释了我的 java 源代码。

我必须从终端使用 ant 生成 javadoc，但我收到了这个警告：

```
[javadoc] src/calendar/annotation/DataType.java:11: warning - Tag @see cannot be used in inline documentation.  It can only be used in the following types of documentation: overview, package, class/interface, constructor, field, method. 
```

在 build.xml 中是这一行：

```
<javadoc  sourcepath="${sourceDir}" destdir="${docDir}" windowtitle="MyProject" /> 
```

有人可以帮我吗？

编辑：

我正确使用它。例如我有

```
/**
 * <p>Metoda provede požadovaný dotaz do databáze za použití předaných parametrů.
 * Pokud jsou parametry nedostatečně nedefinované, SQL dotaz neexistuje nebo nastane
 * problém s komunikací, dojde k vygenerování {@see calendar.exception.LoadException}.
 * Pokud žádné entity neodpovídají požadavku, dochází k vrácení prázdného seznamu.
 * V případě, že nějaké entity odpovídají požadovanému pravidlu, jsou načteny především ty,
 * které již jsou definovány v persistenční vrstvě. Pokud tam entity nejsou zavedeny, dochází
 * k jejich načtení z databáze.</p>
 * @param entityClass
 * @param query
 * @param params
 * @return
 * @throws calendar.exception.LoadException
 */
<EntityClass extends AbstractEntity> Collection<EntityClass> find( Class<EntityClass> entityClass, String query, Map<String, Object> params ) throws LoadException; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T14:38:17.810

那不应该是[@link](http://java.sun.com/j2se/1.5.0/docs/tooldocs/windows/javadoc.html#%7B%40link%7D)而不是[@see](http://java.sun.com/j2se/javadoc/writingdoccomments/#multiple@see)吗？

[http://java.sun.com/j2se/1.5.0/docs/tooldocs/windows/javadoc.html#%7B%40link%7D](http://java.sun.com/j2se/1.5.0/docs/tooldocs/windows/javadoc.html#%7B%40link%7D)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T14:23:42.957

在 Datatype.java 中，您在 Javadoc 不允许的代码中的注释中使用 @see。具体来说，看起来你有类似的东西：

```
/**
  *...@see...
  */
void foo() {
} 
```

它应该在哪里

```
/**
  * ...
  * @see bla
 /*
 void foo() {
     ...
 } 
```

# printing - 如何指定不同方向的字体高度？

> ID：929801
> 
> 赞同：3
> 
> 时间：2009-05-30T14:21:43.180
> 
> 标签：printing, fonts, gdi, orientation

使用 GDI 创建字体的常用方法是使用所需的点大小和目标设备的垂直分辨率 (DPI)，如下所示：

```
LOGFONT lf = {0};
lf.lfHeight = -MulDiv(point_size, GetDeviceCaps(hdc, LOGPIXELSY), 72);
...
HFONT hfont = CreateFontIndirect(&lf); 
```

假设默认`MM_TEXT`映射模式，这会将 point_size 转换为所需设备的像素高度。（这是一个常见的近似值。实际上一英寸有 72.27 个点，而不是 72。）（减号表示我要指定实际字符高度，而不是单元格高度。）

如果我想创建一种横向字体（即，方向和擒纵为 90 度的字体），我应该使用`LOGPIXELSX`而不是`LOGPIXELSY`? 对于我所针对的某些打印机，水平和垂直分辨率是不同的。

一般来说，如果我想要一个角度`theta`，我是否结合`LOGPIXELSX`和`LOGPIXELSY`？我在想这样的事情：

```
// Given theta in degrees (e.g., theta = 45.0) ...
double theta_radians = theta * 2.0 * pi / 360.0;
int dpi = static_cast<int>(GetDeviceCaps(hdc, LOGPIXELSX) * sin(theta_radians) +
                           GetDeviceCaps(hdc, LOGPIXELSY) * cos(theta_radians) +
                           0.5);
LOGFONT lf = {0};
lf.lfHeight = -MulDiv(point_size, dpi, 72);
// Set escapement and orientation to theta in tenths of a degree.
lf.lfEscapement = lf.lfOrientation = static_cast<LONG>(theta * 10.0 + 0.5);
... 
```

这对我来说很直观，但我想知道这是否真的是 GDI 字体映射器和打印机驱动程序的工作方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-06T21:22:08.903

1) 有 72 点/英寸。（它曾经是 72.27 但已更改。） 2）以您所做的方式组合 LOGPIXELSX 和 LOGPIXELSY 很好，但是 3）字体映射器在映射字体时不查看转义和方向。LOGPIXELS 值将仅用作坐标变换的一部分。

[http://msdn.microsoft.com/en-us/library/ms969909(loband).aspx](http://msdn.microsoft.com/en-us/library/ms969909(loband).aspx)

不确定“打印机驱动程序如何工作”，因为该语句可能包括许多可能的驱动程序和打印机。

他们可以用正方形像素光栅化，然后拉伸到非正方形。他们可以转换字形曲线。他们可以做点别的。

# java - 在线法官问题处理输入

> ID：929802
> 
> 赞同：0
> 
> 时间：2009-05-30T14:22:41.650
> 
> 标签：java

这与我之前的[问题有关](https://stackoverflow.com/questions/929001/how-do-i-adapt-this-program-to-comply-with-the-online-judge)

我正在解决 UVA 的 Edit Step Ladders 并试图让在线法官遵守我的答案。

我使用了 ReadLn() 方法来调整我的文本文件阅读程序：

```
import java.io.*;
import java.util.*;

class LevenshteinParaElJuez implements Runnable{
    static String ReadLn(int maxLength){  // utility function to read from stdin,
                                          // Provided by Programming-challenges, edit for style only
        byte line[] = new byte [maxLength];
        int length = 0;
        int input = -1;
        try{
            while (length < maxLength){//Read untill maxlength
                input = System.in.read();
                if ((input < 0) || (input == '\n')) break; //or untill end of line ninput
                line [length++] += input;
            }

            if ((input < 0) && (length == 0)) return null;  // eof
            return new String(line, 0, length);
        }catch (IOException e){
            return null;
        }
    }

    public static void main(String args[]) // entry point from OS
    {
        LevenshteinParaElJuez myWork = new LevenshteinParaElJuez();  // Construct the bootloader
        myWork.run();            // execute
    }

    public void run() {
        new myStuff().run();
    }
}
class myStuff implements Runnable{
    public void run(){

        ArrayList<String> theWords = new ArrayList<String>();
        try
        {

        /// PLACE YOUR JAVA CODE HERE

        String leido=LevenshteinParaElJuez.ReadLn(100);

        //System.out.println("lo leido fue "+leido);

        while (!leido.equals(" ")){
        theWords.add(leido);
        leido=LevenshteinParaElJuez.ReadLn(100);
        }

        }catch(Exception e){
            System.out.println("El programa genero una excepcion");
        }

        int maxEdit=0;
        int actualEdit=0;

     int wordsIndex1 =0, wordsIndex2=0;

     while (wordsIndex1<= theWords.size())
     {
      while (wordsIndex2<= theWords.size()-1){
         actualEdit=Levenshtein.computeLevenshteinDistance(theWords.get(wordsIndex1),theWords.get(wordsIndex2));
         if (actualEdit>maxEdit){maxEdit=actualEdit;}
         wordsIndex2++;
      }
     wordsIndex1++;

     }

     System.out.println(maxEdit+1);

    }

}
class Levenshtein {
    private static int minimum(int a, int b, int c) {
        if(a<=b && a<=c)
            return a;
        if(b<=a && b<=c)
            return b;
        return c;
    }

    public static int computeLevenshteinDistance(String str1, String str2) {
        return computeLevenshteinDistance(str1.toCharArray(),
                                          str2.toCharArray());
    }

    private static int computeLevenshteinDistance(char [] str1, char [] str2) {
        int [][]distance = new int[str1.length+1][str2.length+1];

        for(int i=0;i<=str1.length;i++)
                distance[i][0]=i;

        for(int j=0;j<=str2.length;j++)
            distance[0][j]=j;

        for(int i=1;i<=str1.length;i++)
            for(int j=1;j<=str2.length;j++)
                distance[i][j]= minimum(distance[i-1][j]+1,
                                        distance[i][j-1]+1,
                                        distance[i-1][j-1]+
                                        ((str1[i-1]==str2[j-1])?0:1));

        return distance[str1.length][str2.length];
    }

} 
```

我应该阅读整个在线法官的输入，因为它是通过键盘编写的，但是当我运行上述程序时，我无法让它停止阅读。它类似于：

```
abc
cba
aba
cca 
```

无法停止控制台读取。我该如何解决这个问题？我怀疑问题出在我的循环条件中：

```
String leido=LevenshteinParaElJuez.ReadLn(100);

            //System.out.println("lo leido fue "+leido);

            while (!leido.equals(" ")){
            theWords.add(leido);
            leido=LevenshteinParaElJuez.ReadLn(100);
            } 
```

我也用过：

```
while (!leido.equals(null)){
        theWords.add(leido);
        leido=LevenshteinParaElJuez.ReadLn(100);
        } 
```

并且也被卡住了。

编辑：声明实际上是：

```
while (leido != null)){
        theWords.add(leido);
        leido=LevenshteinParaElJuez.ReadLn(100);
        } 
```

我不明白为什么它失败了。我希望在输入第一个空行时停止通过键盘读取输入。

编辑：感谢rodion的回答， ReadLn 方法现在更改为：

```
if ((input < 0) || (length == 0)) return null;  // eof 
```

代替：

```
if ((input < 0) && (length == 0)) return null;  // eof 
```

现在，它在生成整数输出之前读取两个空格。我怎样才能改变它只是为了阅读一个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T14:34:23.000

问题是输入在到达返回 null 的行时不会 <0，所以这样做：

```
while (leido.length() != 0) {
    ....
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T14:40:40.630

我不确定我是否正确理解了您的问题。如果您只想让程序停止从控制台读取，您可以通过按 Ctrl+D (Linux) 或 Ctrl+Z (Windows) 来“关闭”控制台。这会导致 System.in.read() 返回 -1，因此 ReadLn 方法将返回 null。

按照 Nathaniel 的建议检查 null 。

**编辑**：（根据您的评论）

问题在于 ReadLn 方法中的这种情况

```
if ((input < 0) && (length == 0)) return null; 
```

如果您输入一个空行，长度将为 0，但输入将 > 0（无论您的系统使用什么来表示换行符）。如果您将其更改为

```
if ((input < 0) || (length == 0)) return null; 
```

如果输入流关闭或输入空行，该方法将返回 null。**强文本**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T15:02:03.910

而不是`!leido.equals(" ")`，只需使用`!leido.equals("")`. 前者在输入仅包含空格的行时终止，后者在输入空行时终止。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T20:47:58.407

我不太了解您的问题，但我这边的建议就是以这种方式使用您的情况

```
while(!" ".equals(leido)){  
//instead of   
while (!leido.equals(" ")){ 
```

为什么？，因为如果您的变量包含 null，您的代码将抛出异常，而我提到的条件永远不会这样做：P

# .net - 如何将网页下载到 .NET 中的流中

> ID：929808
> 
> 赞同：4
> 
> 时间：2009-05-30T14:28:20.467
> 
> 标签：.net, vb.net, streaming, stream

我知道这应该是一个基本问题，但我正在碰壁。我正在寻找一个 URL/URI 下载生成的字符串，就好像我打开了一个文件然后将它取出到一个字符串变量中一样。

我一直在忙于使用 IO.Stream 和 Net.httpxxx，但没有设法让元素以正确的方式排列。

我在标准流中打开页面时得到“不支持给定路径的格式”，因为它不在本地文件系统中……我明白这一点，我不明白的是……我该怎么做达到以下等效：

```
Public Function GetWebPageAsString(pURL As String) As String
        Dim lStream As IO.StreamReader = New System.IO.StreamReader(pURL)
        Return lStream.ReadToEnd

End Function 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T15:01:49.620

在 C# 中，简短的答案看起来像

```
using(System.Net.WebClient client = new System.Net.WebClient())
{
  string html = client.DownloadString("http://www.google.com");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T14:39:01.057

[WebClient.OpenRead()](http://msdn.microsoft.com/en-us/library/781fwaz8.aspx)可能是您正在寻找的。

来自上面链接的 MSDN 页面的示例：

```
 Dim uriString as String
 uriString = "http://www.google.com"

 Dim myWebClient As New WebClient()

 Console.WriteLine("Accessing {0} ...", uriString)

 Dim myStream As Stream = myWebClient.OpenRead(uriString)

 Console.WriteLine(ControlChars.Cr + "Displaying Data :" + ControlChars.Cr)
 Dim sr As New StreamReader(myStream)
 Console.WriteLine(sr.ReadToEnd())

 myStream.Close() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T14:36:44.117

此函数将任何 URI 下载到文件中。您可以轻松地将其调整为将其放入字符串 var：

```
public static int DownloadFile(String remoteFilename, String localFilename, bool enforceXmlSafe)
{
// Function will return the number of bytes processed
// to the caller. Initialize to 0 here.
int bytesProcessed = 0;

// Assign values to these objects here so that they can
// be referenced in the finally block
Stream remoteStream = null;
Stream localStream = null;
WebResponse response = null;            

// Use a try/catch/finally block as both the WebRequest and Stream
// classes throw exceptions upon error
try
{
    // Create a request for the specified remote file name
    WebRequest request = WebRequest.Create(remoteFilename);
    if (request != null)
    {
        // Send the request to the server and retrieve the
        // WebResponse object 
        response = request.GetResponse();
        if (response != null)
        {
            // Once the WebResponse object has been retrieved,
            // get the stream object associated with the response's data
            remoteStream = response.GetResponseStream();

            // Create the local file
            if (localFilename != null)
                localStream = File.Create(localFilename);
            else
                localStream = new MemoryStream();

            // Allocate a 1k buffer
            byte[] buffer = new byte[1024];
            int bytesRead;

            // Simple do/while loop to read from stream until
            // no bytes are returned
            do
            {
                // Read data (up to 1k) from the stream
                bytesRead = remoteStream.Read(buffer, 0, buffer.Length);

                // Write the data to the local file
                localStream.Write(buffer, 0, bytesRead);

                // Increment total bytes processed
                bytesProcessed += bytesRead;
            } while (bytesRead > 0);
        }
    }
}
catch (Exception e)
{
    Console.WriteLine(e.Message);
}
finally
{
    // Close the response and streams objects here 
    // to make sure they're closed even if an exception
    // is thrown at some point
    if (response != null) response.Close();
    if (remoteStream != null) remoteStream.Close();
    if (localStream != null) localStream.Close();
}

// Return total bytes processed to caller.
return bytesProcessed;
} 
```

# asp.net-mvc - ASP .Net MVC - 已发布版本中未显示图像

> ID：929809
> 
> 赞同：6
> 
> 时间：2009-05-30T14:28:25.210
> 
> 标签：asp.net-mvc, image

我正在开发一个 ASP .Net MVC 应用程序，在我的开发机器上，该应用程序按预期运行，更重要的是，CSS 文件中提到的图像也可以正确显示。

但是，当我将此应用程序发布到测试服务器时，Web 应用程序运行良好，但未显示图像。

如果我在测试测试服务器的输出时修改了 IE 中的 URL，则会返回图像，这意味着该文件存在，但在正常使用该站点时它不会出现在视图页面中。

我也尝试过替代服务器，但结果是一样的。

为了确认，这是引用图像的 CSS 页面中的一行...

```
background-image: url('/Content/Images/Logo/myLogo.jpg'); 
```

有什么建议么？

干杯

布雷特

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-30T14:32:15.890

URL 不正确，可能是因为您在子文件夹中发布，因此它们不再位于服务器的根目录。我通常使用`Url.Content( "~/Content/Images/..." )`构建 url 而不是对其进行硬编码。这样，它会在构建路径时考虑到路径。

例子：

```
 <img src='<%= Url.Content( "~/Content/Images/banner.jpg" ) %>' alt="Banner" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T14:47:08.173

我遇到了同样的问题，但我找到了它强制对 Contents 文件夹进行身份验证的原因。

When a user is not logged in yet, they are classified as Anonymous Authentication. In IIS7 (which is what I am using, guessing it is the same in IIS6) you need to open the authentication window in features view. Then edit the Anonymous Authentication, to use your application pool identity, or the default one, just make sure that user has permissions to read in that folder.

That fixed it for me, hope it works for you.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T14:44:49.187

可能的相对路径是错误的......可能它们对于 CSS 文件本身是错误的。您可以使用 FireBug 查看 CSS 是否正确加载，然后您可以检查图像请求，通常在这种情况下您会看到红色（错误）项。这可能有助于定位问题。

# javascript - 在 Opera 中更改 body 元素类

> ID：929813
> 
> 赞同：2
> 
> 时间：2009-05-30T14:31:46.560
> 
> 标签：javascript, opera

我有这个脚本，它基本上可以打开和关闭 bgColor 类，以便在第一次单击按钮时背景变为黑色，然后在第二次单击时返回默认的空类。我想弄清楚的是，为什么在 Opera 9.64 中，在第三次单击按钮时，背景保持黑色，只有按钮周围的背景会改变颜色。

```
<style>
.bgColor {background-color: #000000}
</style>

<button id="button">Change Class</button>

<script>
function changeBodyClass() {
    var body = document.body;
    if (body.className === "bgColor") {
        body.className = "";
    } else {
        body.className = "bgColor";
    }
}

document.getElementById("button").onclick = changeBodyClass;
</script> 
```

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T14:50:51.967

似乎存在渲染问题，因为当您调整 Opera 的大小（强制它重绘）时，所有背景都将按预期显示为白色。

你可以在你的 CSS 中添加这样的东西来强制 Opera 认为 body 确实和 viewport 一样大：

```
html {margin: 0; height: 100%}
body {margin: 0; height: 100%} 
```

# parsing - 递归上升解析器如何工作？

> ID：929819
> 
> 赞同：18
> 
> 时间：2009-05-30T14:32:56.667
> 
> 标签：parsing, recursion

递归上升解析器如何工作？我自己编写了一个递归*下降*解析器，但我不太了解 LR 解析器。我[在 Wikipedia](http://en.wikipedia.org/wiki/Recursive_ascent_parser)上找到的内容只会增加我的困惑。

另一个问题是为什么递归上升解析器没有比基于表的解析器更多地使用。似乎递归上升解析器总体上具有更好的性能。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-30T15:42:45.560

古典[龙书](https://rads.stackoverflow.com/amzn/click/com/0321486811)很好地解释了 LR 解析器是如何工作的。还有[解析技术。实用指南。](http://www.cs.vu.nl/~dick/PTAPG.html)如果我没记错的话，你可以在哪里读到它们。维基百科中的文章（至少是介绍）是不正确的。它们是由 Donald Knuth 创建的，他在他的计算机编程艺术第 5 卷中对其进行了解释。如果你懂西班牙语，这里有我发布的完整书籍[清单](https://stackoverflow.com/questions/1669/learning-to-write-a-compiler/789357#789357)。也不是所有的书都是西班牙语的。

在了解它们的工作原理之前，您必须了解一些概念，例如首先、跟随和前瞻。另外，我真的建议您在尝试理解 LR（上升）解析器之前理解 LL（后代）解析器背后的概念。

有一系列解析器 LR，特别是 LR(K)、SLR(K) 和 LALR(K)，其中 K 是它们需要工作的前瞻次数。Yacc 支持 LALR(1) 解析器，但您可以进行调整，而不是基于理论，以使其适用于更强大的语法类型。

关于性能，它取决于被分析的语法。它们在线性时间内执行，但它们需要多少空间取决于您为最终解析器构建了多少状态。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-30T14:47:04.800

我个人很难理解函数调用如何更快 - 远不如表查找“明显更快”。而且我怀疑与词法分析器/解析器必须做的所有其他事情（主要是读取和标记文件）相比，即使“明显更快”也是微不足道的。我查看了维基百科页面，但没有遵循参考；作者是否真的描述了一个完整的词法分析器/解析器？

对我来说更有趣的是表驱动解析器在递归下降方面的衰落。我来自 C 背景，其中 yacc（或等效的）是首选的解析器生成器。当我转向 Java 时，我发现了一个表驱动实现（JavaCup）和几个递归下降实现（JavaCC、ANTLR）。

我怀疑答案类似于“为什么使用 Java 而不是 C”的答案：执行速度不如开发速度重要。正如 Wikipedia 文章中所指出的，表驱动的解析器几乎不可能从代码中理解（当我使用它们时，我可以跟随它们的操作，但永远无法从解析器重构语法）。相比之下，递归下降非常直观（这无疑是它早于表驱动大约 20 年的原因）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-05-20T21:40:45.017

关于递归*上升*解析的维基百科文章引用了似乎是关于该主题的原始论文（“Very Fast LR Parsing”）。略读那张纸为我清除了一些东西。我注意到的事情：

1.  该论文讨论了生成汇编代码。我想知道如果您正在生成 C 或 Java 代码，您是否可以做与他们相同的事情；参见第 4 和 5 节，“错误恢复”和“堆栈溢出检查”。（我不是想 FUD 他们的技术——它可能会很好——只是说这是你在提交之前可能想要研究的东西。）

2.  他们将递归上升工具与他们自己的表驱动解析器进行比较。从他们结果部分的描述来看，他们的表驱动解析器似乎是“完全解释的”；它不需要任何自定义生成的代码。我想知道是否存在整体结构仍然是表驱动的中间立场，但您为某些操作生成自定义代码以加快速度。

维基百科页面引用的论文：

*   “非常快的 LR 解析”（1986 年）
*   [http://portal.acm.org/citation.cfm?id=13310.13326](http://portal.acm.org/citation.cfm?id=13310.13326)

另一篇关于使用代码生成而不是表格解释的论文：

*   “非常快的 YACC 兼容解析器（只需很少的努力）”（1999 年）
*   [http://www3.interscience.wiley.com/journal/1773/abstract](http://www3.interscience.wiley.com/journal/1773/abstract)

另外，请注意，递归下降解析并不是解析基于 LL 语法的语言的最快方法：

*   [LL和递归下降解析器之间的区别？](https://stackoverflow.com/questions/1044600/difference-between-an-ll-and-recursive-descent-parser)

# c#-3.0 - 在 C# 中的接口上具有扩展方法的伪多重继承？

> ID：929820
> 
> 赞同：6
> 
> 时间：2009-05-30T14:34:11.440
> 
> 标签：c#-3.0, extension-methods, dry, multiple-inheritance

[类似的问题，但不完全相同](https://stackoverflow.com/questions/8042/extension-interface-patterns)

我在想，使用与接口相同命名空间中的扩展方法，您可以获得与多重继承类似的效果，因为您不需要在 10 个不同的类中以相同的方式实现相同接口的重复代码。

这样做有什么缺点？我认为优点很明显，缺点通常会在以后回来咬你。

我看到的一个缺点是扩展方法不能是虚拟的，因此您需要确保您确实希望它们对每个实例都以相同的方式实现。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T14:56:28.540

我看到通过扩展方法构建接口功能的问题是您不再实际实现接口，因此不能将对象用作接口类型。

假设我有一个采用 IBar 类型对象的方法。如果我通过扩展方法在类 Foo 上实现 IBar 接口，那么 Foo 不会从 IBar 派生并且不能与它互换使用（Liskov Substitution 原则）。当然，我得到了我想要添加到 Foo 的行为，但是我首先失去了创建接口的最重要的方面——能够定义一个可以由各种类以各种方式实现的抽象契约，以便依赖类不需要知道具体的实现。

如果我非常需要多重继承（到目前为止我没有它），我想我会使用组合来尽量减少代码重复的数量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T01:57:46.720

考虑这一点的一种体面方法是，实例方法是*由*对象完成的，而扩展方法是对对象完成*的*。我相当肯定框架设计指南说你应该尽可能地实现一个实例方法。

一个接口声明“我关心使用这个功能，但不关心它是如何实现的”。这使实施者可以自由选择方式。它将意图（公共 API）与机制（具有具体代码的类）分离。

由于这是接口的主要好处，因此完全将它们实现为扩展方法似乎违背了它们的目的。甚至`IEnumerable<T>`有一个实例方法。

**编辑**：此外，对象旨在作用于它们包含的数据。扩展方法只能看到对象的公共 API（因为它们只是静态方法）；您必须公开对象的所有状态才能使其工作（OO 否）。

# version-control - 文件历史：在源中还是让scm处理？

> ID：929824
> 
> 赞同：7
> 
> 时间：2009-05-30T14:37:27.953
> 
> 标签：version-control, mercurial

我正在学习 mercurial 作为我的个人 scm 软件。使用其他管理软件，您可以通过标签将更改注释放入文件头。使用 hg 您可以评论更改集，但这不会进入源代码。我更习惯像VSS这样的中控。

为什么要将文件历史记录放在源文件的标题中？我应该让 mercurial 用我的变更集评论管理历史吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-30T14:39:15.767

让源代码控制系统处理它。

如果您将更改详细信息放在标题中，它很快就会变得笨拙并压倒实际代码。

此外，如果 scm 具有更改列表的概念（其中许多文件被分组为一个更改），那么您将能够编写注释，以便它适用于整个更改，而不仅仅是一个文件中的编辑（如果有道理），让您更清楚地了解为什么需要进行编辑。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T14:40:10.290

是的; 让源代码控制系统处理您的变更集注释。这样做的理由是，当您稍后查看更改日志时，它会更有意义，试图弄清楚文件的两个版本之间发生了什么 - 源代码控制系统可以显示更改注释以尝试和启发情况.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-30T14:40:32.317

当 SCM 软件更适合解决此问题时，没有理由手动维护文件历史记录。我经常在源代码中看到部分完成的文件历史记录，这实际上很痛苦，因为人们错误地认为它是准确的。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-30T19:45:35.503

区别不在于它是集中式的还是分布式的 VCS，而更多的是关于正在发生的变化。

当我迁移到 .Net 时，针对任何单个更改更新的文件数量似乎猛增。如果我必须在每个文件中记录更改，我将永远无法完成任何真正的工作。通过评论一组更改，我必须更新多少文件并不重要。

如果我需要识别特定更改的所有更改，我可以区分项目的两个版本。

我从 SourceSafe 切换时看到的最大区别（和优势）是从基于文件的提交切换到基于项目的提交。一旦我习惯了，我就停止向我的所有文件添加更改日志类型的注释。

（作为副作用，我发现我的流程描述评论变得更好了）

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-30T14:41:28.273

我不太支持在代码中乱扔更改注释。如果需要它们，可以在 SCM 中查找它们（至少对于我使用的 SCM 变体）。如果您确实希望将它们放在文件中，请考虑将它们放在末尾而不是开头。这样，您就不必在进入实际代码之前向下滚动（至少对我而言无趣）注释。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-05-30T15:16:17.190

让 SCM 系统处理签入评论的另一票，但我确实有一点要补充。

某些系统允许您在源代码中使用 RCS 标记，其中 SCM 可以将更改历史记录直接插入到自动提交的源文件中。听起来是一个很好的平衡，因为历史记录在 SCM 系统中，然后自动放入源代码本身。

问题是这个过程*改变*了源文件。我认为这是一个坏主意，因为在插入评论之前无法在磁盘上更改文件。如果您是一名优秀的工程师，您应该在提交之前构建并测试更改。如果你的源代码在提交后发生了变化，那么你基本上得到了一个可能被破坏的构建——但大多数工程师不会在提交后构建——他们为什么要这样做？

但这只是你说的评论！是的，但我确实有一个案例，我的源文件中有代码，奇怪的是有理由*看起来*像一个 RCS 标头标记，并且代码的那部分在签入时被替换，从而修改了我的代码。很容易修复，但糟糕的是一个构建被 20 多个用户破坏

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-05-30T14:49:32.190

忘记在源代码中维护历史记录要容易得多，因为总是（imo）应该评论提交到源代码控制系统的问题消失了。此外，如果在提交之前更改大量文件，则更改每个文件中的历史记录将是一件烦人的工作。这确实是拥有 scm 的要点之一。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-30T14:47:36.653

我有这方面的经验。我在评论中有文件历史记录，*太糟糕*了。无非是垃圾，有时你必须向下滚动近 1k 行代码更改才能最终得到你想要的。更不用说，**通过向源代码树添加更多 kb 会减慢构建过程的其他方面。**

# objective-c - 如何在 Objective C 中设置未初始化的值？

> ID：929837
> 
> 赞同：0
> 
> 时间：2009-05-30T14:43:18.300
> 
> 标签：objective-c, uikit

这个问题可能没有根据，但这是我遇到的问题：

我正在尝试从 iPhone SDK 运行一个示例，但遇到了访问冲突。我追踪了一些我认为可疑的行为。

下面是这个类的样子：

```
@interface TableViewCell : UITableViewCell {

@private    
    UILabel *_earthquakeLocationLabel;
    UILabel *_earthquakeDateLabel;
    UILabel *_earthquakeMagnitudeLabel;
    UIImageView *_magnitudeImageView;
} 
```

当我在

```
- (id)initWithFrame:(CGRect)frame reuseIdentifier:(NSString *)reuseIdentifier 
```

并在调试器中查看“self”，显示_earthquakeDateLabel为“0x12”，_earthquakeMagnitudeLabel为0x1000，其他两个为零。如果我尝试分配给任何一个非零值，我都会遇到访问冲突。

我猜正在发生的事情是它们中有虚假的值，当我尝试分配给它们时，它试图减少对虚假值的引用并炸毁。但正如我所说，我对 Objective C 还很陌生，所以我可能会偏离基础。

所以我的问题是，我应该做的初始化这些值有什么特别的吗？或者当它具有虚假值时分配给该值的任何方式？

* * *

一些附加信息：

因此，如果我在初始化时将 nil 分配给 _earthquakeDateLabel 和 _earthquakeMagnitudeLabel，则可以解决问题。但我不明白为什么要使用这些字段中的值创建对象；我希望它们为零。该对象正在堆上创建：

```
TableViewCell *cell = [[[TableViewCell alloc] initWithFrame:CGRectZero reuseIdentifier:MyIdentifier] autorelease]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T18:08:52.930

听起来`self`指针是假的。值 0x12 和 0x1000 是整数常量；它们绝对不是指向有效内存地址的指针。您看到这些值的事实表明存在问题，并且尝试以任何方式（读取或写入它们）操作它们将导致错误。在这种情况下，您会遇到访问冲突，因为您尝试写入无效地址的内存地址 0x12 和 0x1000。

你是如何创建`TableViewCell`对象的？你在做`TableViewCell *myCell = [[TableViewCell alloc] initWithFrame:...]`吗？这才是正确的方法。

现在我将调用我的通灵调试器：我的*猜测*是您忘记`TableViewCell`使用指针声明您的对象，即您将其声明为`TableViewCell myCell`而不是`TableViewCell *myCell`（注意星号的存在）。这将在堆栈而不是堆上创建对象，因此，它的数据成员中将有垃圾，而不是零。如果正确分配了 Objective-C 对象，在`NULL`成功调用.`nil``false``alloc`

# python - Python的运行时目录

> ID：929841
> 
> 赞同：1
> 
> 时间：2009-05-30T14:45:12.180
> 
> 标签：python, working-directory

如何从 Python 脚本中找出当前的运行时目录？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-30T14:48:33.733

使用[`os.getcwd`](http://docs.python.org/library/os.html#os.getcwd). 这将告诉您*当前的工作目录*。如果您创建一个新文件

```
fp = open('a.txt', 'w') 
```

然后`a.txt`将在当前工作目录中创建。[`os.chdir`](http://docs.python.org/library/os.html#os.chdir)如果需要，用于更改工作目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-26T07:54:12.083

`os.getcwd()`当你使用时会改变`os.chdir`

如果您需要 python 文件的固定路径，请使用：

```
module_path = os.path.dirname(__file__) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-05-19T21:08:57.313

这对我有用。

```
os.path.dirname(__file__) 
```

# svn - 有什么好方法可以从颠覆中生成提交的时间线视图？

> ID：929842
> 
> 赞同：2
> 
> 时间：2009-05-30T14:46:17.267
> 
> 标签：svn, version-control, trac

刚开始使用颠覆，已经为 3 个当前项目设置了 repos，一切似乎都很好。Subclipse 很好，不是吗！

无论如何，我想要的是一个很好的时间表，显示提交以及对这些 repos 的评论。它们都托管在与其包含的网站相同的服务器上。

我已经尝试过 trac，它可以满足我的要求，但似乎有点矫枉过正，因为我并不真正想要门票/wiki/等，只想要时间线。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T14:58:59.097

eclipse 的 subclipse 插件可以创建显示修订、分支、合并等的时间线。不过，可能还有其他的。

[http://subclipse.tigris.org/](http://subclipse.tigris.org/)

编辑：是的，TortoiseSVN 也这样做。见[http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-revgraph.html](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-revgraph.html)

编辑2：公平地说，以上都没有创建时间表本身。他们都创建修订图。通过将鼠标悬停在图表的元素上（并查看修订历史记录表），可以在 subclipse（可能还有 tortoisesvn）中获得提交的日期/时间，但严格来说它们不是时间线。我不知道有什么东西会以时间线格式产生这些信息。希望那些能满足你的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-04T19:52:31.933

使用`svn log`命令。添加一个`-v`标志以显示每次提交修改了哪些文件。输出可能很庞大，因此您可能希望使用该`-l`标志将输出限制为最后 100 行左右。把它们放在一起：

1.  启动命令提示符，例如`bash`在 Linux 或`cmd.exe`Windows 上。
2.  `cd` *你的仓库*
3.  `svn log -l 100 -v`

# django - Django选择框大小选项

> ID：929843
> 
> 赞同：2
> 
> 时间：2009-05-30T14:46:38.467
> 
> 标签：django, html-select

我有三个下拉选择框，出于网络可见性的原因，我必须使用 size='' 选项扩展它们。如果我从每个框中选择一个选项，我不会收到错误，但如果我留下一个或多个框没有选择，我会收到错误：

```
<select id="pathology_id" name="pathology_id" size="5">
    {% for pathology in pathology_list %}
    <option value="{{ pathology.id }}">{{ pathology.pathology }}</option>
    {% endfor %}
</select>

<select id="commodity_id" name="commodity_id" size="5">
    {% for commodity in commodity_list %}
    <option value="{{ commodity.id }}">{{ commodity.commodity }}</option>
    {% endfor %}
</select>

<select id="technology_id" name="technology_id" size="5">
    {% for technology in technology_list %}
    <option value="{{ technology.id }}">{{ technology.technology }}</option>
    {% endfor %}
</select>

ERROR:
MultiValueDictKeyError
Exception Value:    

"Key 'pathology_id' not found in <QueryDict: {u'q': [u''], 
```

如何对视图进行编码以接受没有选择的下拉框？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T14:51:57.597

如果您的任何列表为空，您可以用 if 语句包围 for 循环。

例如，

```
{% if technology_list %}
    {% for technology in technology_list %} {{ technology.technology }} {% endfor %}
{% endif %} 
```

最后，在视图中，您可以查看发布的项目是否在请求字典中。

```
if 'technology' in request.POST:
    tech = request.POST['technology'] 
```

-----**更新**-----

首先，您可能应该使用[django 表单](http://docs.djangoproject.com/en/dev/topics/forms/)来执行此操作。其次，您应该使用 stackoverflow 来提出具体问题。您不应该将其用作修复代码的方法。

最后，似乎为以下行引发了错误：

```
pathology_id = request.GET['pathology_id'] 
```

问题是键 'pathology_id' 不在 GET 字典中。如果您有此字段的默认值，则可以执行以下操作：

```
pathology_id = 'default_value'
if 'pathology_id' in request.GET:
    pathology_id = request.GET['pathology_id'] 
```

否则，如果您没有默认值，那么您显然无法获得没有 ID 的 Pathology 对象。然后，您将不得不处理未选择任何内容的情况。

```
if 'pathology_id' in request.GET:
    pathology_id = request.GET['pathology_id']

    #rest of your code

else:
    #code when no pathology_id is selected 
```

# c# - ASP.NET C# 或 Javascript 中的上下文化

> ID：929855
> 
> 赞同：0
> 
> 时间：2009-05-30T14:51:40.640
> 
> 标签：c#, asp.net

想知道是否有人知道任何关于通过 JS (javascript) 或 ASP.NET 进行上下文化的开源代码？也就是说，内容的情境化——确定“什么”内容是什么？

这是一个有趣的领域，我似乎找不到任何以前的项目？

真的很感激任何帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T20:38:34.447

大概您正在寻找类似搜索引擎的东西，它可以在不包含任何元数据的不包含任何元数据，仅包含其文本内容的无描述文档的海洋中找到相关文档。

众所周知，计算机不擅长这种分类，原因与它们可以识别拼写但不能识别语法错误的原因相同。这是一个模式匹配问题，依赖于人类上下文来确定正确的解决方案。

谷歌擅长这一点，因为它依靠人类行为来创建相关性（比如一个页面有多少来自其他网站的链接）。

我能想到的最接近的事情就是全文搜索（无需手动将真正的元数据附加到每个文档）。[Wikipedia](http://en.wikipedia.org/wiki/Full_text_search)文章有几个对执行此操作的软件的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T21:44:35.373

根据您要执行的操作，在呈现内容后挖掘您的页面以获取上下文可能会更容易。这样可以确保您拥有用户正在查看页面的上下文。这是一个 jQuery 插件的帖子，它[突出显示 html 页面上的目标词](http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html)。

以下是您可能想要查看的其他一些插件：

*   [快速搜索插件](http://rikrikrik.com/jquery/quicksearch/)
*   [QuickSilver 搜索插件](http://orderedlist.com/demos/quicksilverjs/jquery.html)

# linq - LINQ：表和相关表中的条件

> ID：929858
> 
> 赞同：0
> 
> 时间：2009-05-30T14:52:10.250
> 
> 标签：linq, linq-to-sql, .net-3.5

我有一些可以创建和订阅的称为*代码的项目。*创建它们时，它们的范围为 1:private 或 2:public。任何人都可以订阅公共代码，私人代码可以通过所有者邀请订阅。

我想使用 LINQ 来获取用户创建的代码（即：具有特定所有者 ID），其中 [1] 是公共的 [2] 已被当前用户订阅。

```
TickerUser       Ticker
==========       ======
TickerUserId <-- TickerId
TickerId         OwnerId
UserId           ScopeId

public IQueryable<Ticker> GetTickersByOwnerAll(int ownerId) {
    return from ticker in db.Tickers
           where ticker.OwnerId == ownerId
           select ticker;
}
/// THIS PART IS INCORRECT -- DO NOT USE
public IQueryable<Ticker> GetTickersByOwnerVisible(int ownerId) {
    int currId = CurrentUser.GetCurrentUser().ID;
    return GetTickersAll(ownerId)
           .Where(t => t.ScopeId == 2)
           .Where(t => t.TickerUsers.Where(tu => tu.UserId == currId));
} 
```

最后一行是不正确的，但你可以看到我试图用它去哪里。我对 LINQ 还很陌生，所以我还没有想到正确的方法。我哪里错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T14:59:30.640

```
db.Tickers.Where(t =>
    // The ticker is public...
    (t.ScopeId == 2)
    // ...or any of the ticker users is the current user.
    || t.TickerUsers.Any(tu => tu.UserId == currId)) 
```

# c# - ReSharper - 使用 Microsoft.Contracts 时可能的空分配

> ID：929859
> 
> 赞同：52
> 
> 时间：2009-05-30T14:52:13.073
> 
> 标签：c#, resharper, code-contracts, design-by-contract, microsoft-contracts

有没有办法向 ReSharper 表明由于按合同设计需要检查而不会发生空引用？例如，以下代码将`Possible 'null' assignment to entity marked with 'NotNull' attribute`在 ReSharper 中的第 7 行和第 8 行引发警告 ( )：

```
private Dictionary<string, string> _Lookup = new Dictionary<string, string>();

public void Foo(string s)
{
    Contract.Requires(!String.IsNullOrEmpty(s));

    if (_Lookup.ContainsKey(s))
        _Lookup.Remove(s);
} 
```

真正奇怪的是，如果您删除该`Contract.Requires(...)`行，ReSharper 消息就会消失。

**更新**

我通过下面的 Mike 也提到的 ExternalAnnotations 找到了解决方案。下面是如何为 Microsoft.Contracts 中的函数执行此操作的示例：

*   在ReSharper 目录`Microsoft.Contracts`下创建一个名为的目录。`ExternalAnnotations`
*   接下来，创建一个名为`Microsoft.Contracts.xml`并填充的文件，如下所示：

```
<assembly name="Microsoft.Contracts">
    <member name="M:System.Diagnostics.Contracts.Contract.Requires(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
</assembly> 
```

*   重新启动 Visual Studio，消息消失！

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-11-07T13:47:56.913

**注意**：从当前的 R# 8.0 EAP 开始，包含此功能。

* * *

这是当前（即 .NET 4.0）版本的代码合同的解决方案：

在里面`...\ExternalAnnotations\mscorlib\Contracts.xml`，添加以下内容：

```
<assembly name="mscorlib">
    <member name="M:System.Diagnostics.Contracts.Contract.Assert(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Assert(System.Boolean, System.String)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Assume(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Assume(System.Boolean, System.String)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Requires(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Requires``1(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Requires(System.Boolean,System.String)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Requires``1(System.Boolean,System.String)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Invariant(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Invariant(System.Boolean,System.String)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
</assembly> 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2010-06-11T20:58:38.113

我想补充一点，对于编写自己的断言方法等的人，您可以在没有外部 XML 文件的情况下包含这些属性。在 Visual Studio 中，转到`ReSharper > Options > Code Annotations`并单击该`Copy default implementation to clipboard`按钮。然后创建一个新文件（解决方案中您想要的任何位置）并从剪贴板粘贴代码。现在，您可以创建如下方法：

```
public class Require
{
    [AssertionMethod]
    public static void That(
        [AssertionCondition(AssertionConditionType.IS_TRUE)] 
        bool requiredCondition,
        string message = null)
    {
        ...
    }
...
} 
```

现在，任何调用都将向 ReSharper 表明，如果为空`Require.That(a != null)`，您将无法越过这条线。`a`与 ExternalAnnotations 技术不同，这将适用于任何使用您的方法的人，而无需他们进行任何额外的工作。

### 更新

Resharper 从第 7 版开始更改了他们的合约注释模型。以下是上述方法现在的样子：

```
public class Require
{
    [ContractAnnotation("requiredCondition:false => halt")]
    public static void That(
        bool requiredCondition,
        string message = null)
    {
        ...
    }
...
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-30T15:35:12.330

我认为你可以，但这不是微不足道的。查看[Resharper 的代码注释在线帮助](http://www.jetbrains.com/resharper/webhelp/index.jsp?Code_Analysis__External_Annotations.html)

他们对 BCL 类和 NUnit 框架（以及更多）进行了注释，以增强 Resharpers 代码检查能力。

例如，对于 NUnit 断言，它们使用 AssertionMethodAttribute 进行注释。这告诉 Resharpers 代码检查，如果您通过了 Assert.IsNotNull(foo); 那么 foo 不能为空，它不会再产生“可能的‘空’赋值......”警告。

您可以生成一个注释 Contracts.Requires 方法的 xml 文件，以表明它就像一个 Assert。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-12-17T17:24:34.957

删除断言时消息消失的原因是 R# 默认情况下以“乐观”模式工作。它假定一切都是非空的，直到你做了一些表明它实际上可以为空的事情。当您将调用添加到`String.IsNullOrEmpty`. 你说那`s`实际上可能是空的。它只是不知道在`Contract.Requires`这种情况下该方法将停止执行，但是您使用注释解决了。

在 R# 5.0 中，您可以更改为在每个角落都假设最差的悲观模式。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-08-25T16:59:11.863

我采用了 Porges 的 XML 并为 Assert 和 Assume 方法添加了注释。如果其他人想要添加更多方法，我将在此回答。

```
<assembly name="mscorlib">
    <member name="M:System.Diagnostics.Contracts.Contract.Assert(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Assert(System.Boolean, System.String)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Assume(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Assume(System.Boolean, System.String)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Requires(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Requires``1(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Requires(System.Boolean,System.String)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Requires``1(System.Boolean,System.String)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Invariant(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Invariant(System.Boolean,System.String)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <parameter name="condition">
            <attribute ctor="M:JetBrains.Annotations.AssertionConditionAttribute.#ctor(JetBrains.Annotations.AssertionConditionType)">
                <argument>0</argument>
            </attribute>
        </parameter>
    </member>
</assembly> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-17T13:23:15.847

**Resharper 从第 7 版开始更改了他们的合约注释模型。**

你需要一个不同的文件。新位置（我猜只适用于 Metro 应用程序）是：“C:\Program Files (x86)\JetBrains\ReSharper\v7.1\Bin\ExternalAnnotations\.NETCore\System.Diagnostics.Contracts\Contracts.xml”

我正在使用 Visual Studio 2012 和 .Net 4.5 和 Resharper 7.1。

内容：

```
<assembly name="System.Diagnostics.Contracts">
    <member name="M:System.Diagnostics.Contracts.Contract.Assert(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <attribute ctor="M:JetBrains.Annotations.ContractAnnotationAttribute.#ctor(System.String)">
            <argument>condition:false=&gt;halt</argument>
        </attribute>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Assert(System.Boolean, System.String)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <attribute ctor="M:JetBrains.Annotations.ContractAnnotationAttribute.#ctor(System.String)">
            <argument>condition:false=&gt;halt</argument>
        </attribute>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Assume(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <attribute ctor="M:JetBrains.Annotations.ContractAnnotationAttribute.#ctor(System.String)">
            <argument>condition:false=&gt;halt</argument>
        </attribute>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Assume(System.Boolean, System.String)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <attribute ctor="M:JetBrains.Annotations.ContractAnnotationAttribute.#ctor(System.String)">
            <argument>condition:false=&gt;halt</argument>
        </attribute>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Requires(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <attribute ctor="M:JetBrains.Annotations.ContractAnnotationAttribute.#ctor(System.String)">
            <argument>condition:false=&gt;halt</argument>
        </attribute>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Requires``1(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <attribute ctor="M:JetBrains.Annotations.ContractAnnotationAttribute.#ctor(System.String)">
            <argument>condition:false=&gt;halt</argument>
        </attribute>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Requires(System.Boolean,System.String)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <attribute ctor="M:JetBrains.Annotations.ContractAnnotationAttribute.#ctor(System.String)">
            <argument>condition:false=&gt;halt</argument>
        </attribute>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Requires``1(System.Boolean,System.String)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <attribute ctor="M:JetBrains.Annotations.ContractAnnotationAttribute.#ctor(System.String)">
            <argument>condition:false=&gt;halt</argument>
        </attribute>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Invariant(System.Boolean)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <attribute ctor="M:JetBrains.Annotations.ContractAnnotationAttribute.#ctor(System.String)">
            <argument>condition:false=&gt;halt</argument>
        </attribute>
    </member>
    <member name="M:System.Diagnostics.Contracts.Contract.Invariant(System.Boolean,System.String)">
        <attribute ctor="M:JetBrains.Annotations.AssertionMethodAttribute.#ctor"/>
        <attribute ctor="M:JetBrains.Annotations.ContractAnnotationAttribute.#ctor(System.String)">
            <argument>condition:false=&gt;halt</argument>
        </attribute>
    </member>
</assembly> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-07-26T01:43:25.180

**TL;DR - 将条件编译符号添加`CONTRACTS_FULL`到您的项目中。**

该`Contract.Requires(...)`方法为空且已禁用，除非您启用并使用代码联系人重写器。通过手动运行重写器，或者（通常）通过 Visual Studio 项目属性启用它，您可以将`Contract.Requires(...)`代码保存在编译和重写的二进制文件中。你知道代码可以工作，忽略 Resharper 警告，你可以运行它并进行测试。

那有什么问题呢？Resharper 不知道代码合约正在运行，因为它们实际上只在（后）编译时注入。在 Resharper 看来，它的禁用方式与`DEBUG`预处理器符号的工作方式以及 Visual Studio 如何将不属于已编译二进制文件的代码区域灰显的方式相同。

```
#ifdef DEBUG
    Console.WriteLine("I'm in DEBUG mode, so this is probably a Debug build.");
#else
    Console.WriteLine("Let's assume this is a Release build.");
#endif 
```

根据[Code Contracts 用户手册](https://www.microsoft.com/en-us/research/project/code-contracts/?from=http://research.microsoft.com/en-us/projects/contracts/userdoc.pdf)（第 2 章第一段）和`ContractExtensions.cs`（包含在 Code Contracts 安装文件夹中）中的源代码，`CONTRACTS_FULL`需要在编译之前进行设置。除非设置了标志，否则[Contract 方法实际上是](https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.contracts.contract.requires?redirectedfrom=MSDN&view=netframework-4.8)使用并忽略（不包括在编译时）实现的。[`[ConditionalAttribute("CONTRACTS_FULL")]`](http://msdn.microsoft.com/en-us/library/system.diagnostics.conditionalattribute.aspx)Resharper 尊重此标志，并假定除非设置该函数，否则该函数将不会运行。

```
[ConditionalAttribute("CONTRACTS_FULL")]
public static void Requires(bool condition) { ... } 
```

解决方案：将条件编译符号添加`CONTRACTS_FULL`到您的项目中。请参阅Henning Krause 的[使用代码协定 Visual Studio 和 Resharper](http://www.infinitec.de/post/2010/11/18/Using-Code-Contracts-Visual-Studio-and-with-Resharper.aspx)。

[![](https://i.stack.imgur.com/V8fSm.png)](http://www.infinitec.de/post/2010/11/18/Using-Code-Contracts-Visual-Studio-and-with-Resharper.aspx)
[（来源：[infinitec.de](http://www.infinitec.de/image.axd?picture=Windows-Live-Writer/Using-CodeContracts-with-Resharper/05970F39/ConditionalSymbol.png)）]

Resharper 团队已收到通知；[代码分析不考虑“代码合同”项目属性选项卡上的设置](https://youtrack.jetbrains.com/issue/RSRP-179286)，[支持 Microsoft 代码合同](https://youtrack.jetbrains.com/issue/RSRP-190566)。

# c# - 什么时候在 SQL 命令中使用非参数化变量是安全的？

> ID：929873
> 
> 赞同：4
> 
> 时间：2009-05-30T14:59:25.257
> 
> 标签：c#, sql, database

我正在用 C# 方法编写一个选择查询，它允许客户端代码提供行 ID 并取回从行数据构造的对象。如果行 ID 是一个整数并且我已经确认它是正数，那么仅使用 string.Format 传递它有什么害处吗？如果只允许它们传入一个 int 而不是一个字符串，我看不出会有什么损害。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-30T15:06:26.867

你是对的，以这种方式传递一个整数是安全的。然而，故事还有另一面。

虽然可以认为只格式化 int 并创建 SQL 表达式是安全的，但也有性能考虑。当 SQL 服务器第一次看到查询时，它将创建并缓存该查询的执行计划。下次发出相同的查询时，将重用执行计划。

如果您传入不同的字符串，它将被视为单独的查询，需要单独的执行计划。如果每次都传入相同的参数化查询（使用不同的参数），SQL Server 将重用第一个执行计划。

即使您不关心性能优势，我仍然会对针对数据库的所有查询使用参数化查询，即使对于您指出的那些可以被视为“安全”的查询 - 只是为了在应用程序的方式上保持一致访问数据。如果*一直*使用参数化查询，也省去了每次都判断查询是否安全以便决定以何种方式查询数据库的麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T15:01:38.343

你在这里回答你自己的问题。System.Int32 不能包含

```
';DROP DATABASE xxx;-- 
```

如果这就是你所担心的。即使传递一个负整数也不会对您的数据库产生负面影响！

# parsing - 解析器组合器和递归下降解析器之间有什么关系？

> ID：929882
> 
> 赞同：4
> 
> 时间：2009-05-30T15:02:15.237
> 
> 标签：parsing

解析器组合器和递归下降解析器之间有什么关系？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T15:48:14.653

[解析器组合](http://en.wikipedia.org/wiki/Parser_combinators)器上的维基百科链接实际上非常合理。我们从中学到的第一件事是“解析器组合器使用自上而下的解析策略”，即递归下降。

组合器本身就是解析器的构建块，但它们倾向于递归下降。

# project-management - 有哪些方法可以处理与客户的复杂性不匹配？

> ID：929886
> 
> 赞同：1
> 
> 时间：2009-05-30T15:05:14.183
> 
> 标签：project-management

“真的很简单，我只想要一个屏幕。”

“哇，那个[闪亮的东西]一定花了很多功夫。”

我发现非技术客户非常不擅长估计他们所要求的功能的简单或复杂程度。他们对事情有多难的估计似乎主要围绕他们可以看到多少 UI 展开，他们认为计算机是一个可以回答开放式问题的人。

作为程序员，我们知道情况并非如此。通常复杂的接口只是做更多接线的问题，而知道正确答案的“魔术按钮”往往需要最多的工作（或者今天实际上无法在计算机上实现，因为它需要强大的人工智能）。

我们也知道这会导致问题，特别是在估算和交付工作时，或者当“小改动”需要大量后端工作时，并且需要更多的钱或需要更多的时间来完成它们。

有哪些方法可以优雅地处理复杂性不匹配并让您的客户满意？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T15:14:25.227

“有哪些方法可以优雅地处理复杂性不匹配并让您的客户满意？”

准确、诚实地估计成本和时间，并遵守商定的功能和时间安排。

要解决您的问题的其余部分，最好的方法是以与他们思考问题相同的方式组织您对工作量的估计。当他们看到“闪亮的按钮 = 128 个工作日”或“10 个新屏幕 = 0.5 个工作日”时，他们要么会问为什么，这让你有机会解释他们感知的复杂性与你的现实之间的差异，要么他们不会问，在这种情况下，您已经披露了成本，他们可以判断相关功能对其预算优先级的重要性。

我发现，只要您有他们的信任，与非技术客户的关系就可以正常工作，而始终如一地赢得和保持他们的信任的唯一方法是在预算内按时交付质量。

HTH，祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T15:25:58.247

我强调永远不要对客户说“这很容易做到”。

对客户来说，没有任何编程是容易的，这就是他们雇用我们的原因。虽然我们知道有些东西对我们来说很容易，但这样说会让他们开始认为他们可以判断特征复杂性。

西蒙把它钉牢了，把它全部放在桌子上。挑战在于大多数极客与人的交流不如他们与计算机的交流>.<

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-30T15:31:08.143

如果客户怀疑某件事很复杂（或至少需要大量工作），一堆技术术语和首字母缩略词应该很快让他沉默。

如果客户怀疑某事很简单，请说“哦，是的，您是对的，感谢您指出这一点。这将花费两倍的时间和两倍的成本。”

# python - 关于python的两个简单问题

> ID：929887
> 
> 赞同：2
> 
> 时间：2009-05-30T15:05:14.280
> 
> 标签：python, file

我有两个关于 python 的简单问题：

1.如何在python中获取文件的行数？

2.如何轻松定位文件对象中的最后一行？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-30T15:11:00.290

行只是由换行符分隔的数据 char `'\n'`。

1）由于行是可变长度的，你必须阅读整个文件才能知道换行符在哪里，所以你可以计算有多少行：

```
count = 0
for line in open('myfile'):
    count += 1
print count, line # it will be the last line 
```

2）从文件末尾读取一个块是找到最后一个换行符的最快方法。

```
def seek_newline_backwards(file_obj, eol_char='\n', buffer_size=200):
    if not file_obj.tell(): return # already in beginning of file
    # All lines end with \n, including the last one, so assuming we are just 
    # after one end of line char
    file_obj.seek(-1, os.SEEK_CUR)
    while file_obj.tell():
        ammount = min(buffer_size, file_obj.tell())
        file_obj.seek(-ammount, os.SEEK_CUR)
        data = file_obj.read(ammount)
        eol_pos = data.rfind(eol_char)
        if eol_pos != -1:
            file_obj.seek(eol_pos - len(data) + 1, os.SEEK_CUR)
            break
        file_obj.seek(-len(data), os.SEEK_CUR) 
```

你可以像这样使用它：

```
f = open('some_file.txt')
f.seek(0, os.SEEK_END)
seek_newline_backwards(f)
print f.tell(), repr(f.readline()) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-30T15:21:11.203

我们不要忘记

```
f = open("myfile.txt")
lines = f.readlines()

numlines = len(lines)
lastline = lines[-1] 
```

注意：这会将内存中的整个文件作为列表读取。在文件非常大的情况下请记住这一点。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-30T15:42:56.463

最*简单*的方法是将文件读入内存。例如：

```
f = open('filename.txt')
lines = f.readlines()
num_lines = len(lines)
last_line = lines[-1] 
```

但是对于大文件，这可能会占用大量内存，因为整个文件都加载到 RAM 中。另一种方法是逐行遍历文件。例如：

```
f = open('filename.txt')
num_lines = sum(1 for line in f) 
```

这更有效，因为它不会将整个文件加载到内存中，而一次只查看一行。如果您还想要最后一行，则可以在迭代时跟踪这些行并通过以下方式获得两个答案：

```
f = open('filename.txt')
count=0
last_line = None
for line in f:
    num_lines += 1
    last_line = line
print "There were %d lines.  The last was: %s" % (num_lines, last_line) 
```

如果您只需要最后一行，最后一个可能的改进是从文件末尾开始，然后向后搜索，直到找到换行符。 [这是](https://stackoverflow.com/questions/136168/tail-a-file-with-python)一个有一些代码执行此操作的问题。但是，如果您同时需要行数，则除了遍历文件中的所有行之外别无选择。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T15:20:49.020

对于适合内存的小文件，如何使用[`str.count()`](http://docs.python.org/library/string.html#string.count)获取文件的行数：

```
line_count = open("myfile.txt").read().count('\n') 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-30T15:56:49.287

我也想添加到其他解决方案中，其中一些（寻找的人`\n`）不适用于具有 OS 9 样式行结尾的文件（`\r`仅），并且它们可能在末尾包含一个额外的空白行，因为很多的文本编辑器出于某些奇怪的原因附加它，因此您可能希望也可能不希望为它添加检查。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-30T15:13:26.960

[据我所知] 计算行数的唯一方法是读取所有行，如下所示：

```
count = 0
for line in open("file.txt"): count = count + 1 
```

循环后，`count`将读取行数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-30T18:04:33.293

对于第一个问题，已经有一些好的问题了，我建议@Brian 的问题是最好的（最pythonic，行尾字符证明和内存效率）：

```
f = open('filename.txt')
num_lines = sum(1 for line in f) 
```

对于第二个，我喜欢@nosklo 的，但修改为更通用的应该是：

```
import os
f = open('myfile')
to = f.seek(0, os.SEEK_END)
found = -1
while found == -1 and to > 0:
  fro = max(0, to-1024)
  f.seek(fro)
  chunk = f.read(to-fro)
  found = chunk.rfind("\n")
  to -= 1024

if found != -1:
  found += fro 
```

它从文件末尾开始搜索 1Kb 的块，直到找到换行符或文件结束。在代码的最后，found 是最后一个换行符的索引。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-30T15:14:07.380

回答第一个问题（使用此方法时要注意大文件性能不佳）：

```
f = open("myfile.txt").readlines()
print len(f) - 1 
```

回答第二个问题：

```
f = open("myfile.txt").read()
print f.rfind("\n") 
```

PS 是的，我知道这仅适用于小文件和简单程序。我想我不会删除这个答案，但它可能看起来对实际用例没有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-05-02T06:24:58.793

答案1：

```
x = open("file.txt") 
```

打开文件或者我们有 x 与 file.txt 关联

```
y = x.readlines() 
```

返回列表中的所有行

```
length = len(y) 
```

将列表的长度返回到 Length

或者在一行

```
length = len(open("file.txt").readlines()) 
```

答案2：

```
last = y[-1] 
```

返回列表的最后一个元素

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-10-22T16:04:15.090

# c# - 如何禁用 Windows 窗体上的命中测试？

> ID：929888
> 
> 赞同：0
> 
> 时间：2009-05-30T15:05:21.703
> 
> 标签：c#, winforms, winapi

是否可以在 Windows 窗体窗口上禁用 hittest，如果可以，我该怎么做？我想要一个不能点击的不透明窗口。

在此先感谢，克里斯托夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T20:08:13.960

好吧，我仍然不太了解您的用例，但无论如何我都会尝试一下，并提供一个简单的示例。

我假设您想从浮动表单控制主表单上的某些内容。为此，您需要从浮动表单中引用您的主表单。您可以通过在接受主窗体实例的浮动窗体中创建构造函数重载来做到这一点，如下所示：

```
 public FloatingForm(MainForm mainForm)
    {
        InitializeComponent();
        _mainForm = mainForm;
    } 
```

浮动窗体包含一个名为 floatingFormTextBox 的文本框和一个名为 Button1 的按钮。浮动表单的部分类如下所示：

```
public partial class FloatingForm : Form
{
    MainForm _mainForm;

    public FloatingForm()
    {
        InitializeComponent();
    }

    public FloatingForm(MainForm mainForm)
    {
        InitializeComponent();
        _mainForm = mainForm;
    }

    private void button1_Click(object sender, EventArgs e)
    {
        _mainForm.DoSomething(floatingFormTextBox.Text);
    }
} 
```

主窗体只包含一个名为 mainFormTextBox 的文本框。当主窗体加载时，它会创建一个浮动窗体的实例，并将对自身的引用传递给浮动窗体的新构造函数重载。主窗体的部分类如下所示：

```
public partial class MainForm : Form
{
    FloatingForm _floatingForm;

    public MainForm()
    {
        InitializeComponent();
    }

    public void DoSomething(string text)
    {
        mainFormTextBox.Text = text;
        this.Refresh();
    }

    private void MainForm_Load(object sender, EventArgs e)
    {
        _floatingForm = new FloatingForm(this);
        _floatingForm.Show();
    }
} 
```

现在，当我将一些文本放入浮动表单的文本框中并单击按钮时，文本会显示在主表单的文本框中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T16:27:18.583

你想要一个不能移动的窗口吗？将 FormBorderStyle 设置为无。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-30T21:46:03.547

如果您正在与不同的进程交谈，则需要发送和检索 Windows 消息。

[http://www.c-sharpcorner.com/UploadFile/thmok/SendingWindowsMessageinCSharp11262005042819AM/SendingWindowsMessageinCSharp.aspx](http://www.c-sharpcorner.com/UploadFile/thmok/SendingWindowsMessageinCSharp11262005042819AM/SendingWindowsMessageinCSharp.aspx)

看看这个链接：

在 C# 中使用窗口消息实现全局系统挂钩 [http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx](http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx)

全局系统挂钩允许应用程序截取用于其他应用程序的 Windows 消息。在 C# 中实现这一直很困难（根据 MSDN，这是不可能的）。本文尝试通过在 C++ 中创建一个 DLL 包装器来实现全局系统挂钩，该包装器将消息发布到挂钩应用程序的消息队列中。

# objective-c - 使用 NSTreeController、NSOutlineView 和拖放

> ID：929889
> 
> 赞同：1
> 
> 时间：2009-05-30T15:05:21.703
> 
> 标签：objective-c, cocoa

我在[这里](http://theocacao.com/document.page/130)找到了 关于如何在大纲视图中实现拖放的教程。我唯一的问题是我不知道将教程中的代码放在哪里。如果您能告诉我应该将代码放在 Xcode 项目中的哪个位置以使其正常工作，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-11-03T11:57:19.703

Apple 发布了一个示例代码，解释了如何做到这一点。[http://developer.apple.com/library/mac/#samplecode/DragNDropOutlineView/Introduction/Intro.html](http://developer.apple.com/library/mac/#samplecode/DragNDropOutlineView/Introduction/Intro.html)

我发现这比我在互联网上找到的所有其他样本要好得多。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-30T16:54:46.030

您可能还想查看[本教程](http://allusions.sourceforge.net/articles/treeDragPart1.php)（还有[第二部分](http://allusions.sourceforge.net/articles/treeDragPart2.php)详细介绍了无序树）。

特别是，链接教程包含一个 XCode 项目，可以帮助您入门。查看`DragController.m`您将链接引用的代码放在哪里。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-30T20:44:34.043

它们是委托/数据源方法，因此您将它们放入大纲视图的委托和数据源中。通常这是您的控制器对象，但您可以在 IB 中或以编程方式连接连接。我实际上建议在使用绑定或 Core Data 之前学习数据源和委托方法的工作原理，因为绑定并不是要取代低级代码的知识（而且你会遇到很多绑定问题，直到你对基础知识有扎实的了解）。

另外，请记住 NSTreeController 自 10.5 以来有所改进，据我所知，您应该能够在不使用私有方法的情况下获得真正的观察对象。

# xcode - 我如何在 OS X 下覆盖 malloc()、calloc()、free() 等？

> ID：929893
> 
> 赞同：10
> 
> 时间：2009-05-30T15:07:07.880
> 
> 标签：xcode, macos, malloc, overriding

假设最新的 XCode 和 GCC，覆盖内存分配函数的正确方法是什么（我猜也是 operator new/delete）。调试内存分配器对于游戏来说太慢了，我只需要一些基本的统计数据，我可以自己做，影响最小。

我知道由于钩子在 Linux 中它很容易，十年前我在编写 HeapManager 时，这在 codewarrior 中是微不足道的。

可悲的是 smartheap 不再有 mac 版本。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-31T11:17:43.967

我会为此任务使用库预加载，因为它不需要修改正在运行的程序。如果您熟悉执行此操作的常用 Unix 方法，则几乎只需将 LD_PRELOAD 替换为 DYLD_INSERT_LIBRARIES。

第一步是使用这样的代码创建一个库，然后使用常规共享库链接选项 ( `gcc -dynamiclib`) 构建它：

```
void *malloc(size_t size)
{
    void * (*real_malloc)(size_t);
    real_malloc = dlsym(RTLD_NEXT, "malloc");

    fprintf(stderr, "allocating %lu bytes\n", (unsigned long)size);
    /* Do your stuff here */

    return real_malloc(size);
} 
```

请注意，如果您还转移`calloc()`及其实现调用`malloc()`，您可能需要额外的代码来检查您是如何被调用的。C++ 程序应该非常安全，因为无论如何`new`操作符都会调用`malloc()`，但请注意，没有标准强制执行此操作。不过，我从未遇到过不使用的实现`malloc()`。

最后，为您的程序设置运行环境并启动它（可能需要根据 shell 处理环境变量的方式进行调整）：

```
export DYLD_INSERT_LIBRARIES=./yourlibrary.dylib
export DYLD_FORCE_FLAT_NAMESPACE=1
yourprogram --yourargs 
```

有关动态链接器环境变量的更多信息，请参见[dyld 手册页](http://developer.apple.com/documentation/Darwin/Reference/Manpages/man1/dyld.1.html)。

这个方法很通用。但是有一些限制：

*   您将无法转移直接系统调用
*   如果应用程序本身通过使用`dlsym()`to load`malloc`的地址来欺骗您，则呼叫不会被转移。但是，除非您还通过转移来欺骗它`dlsym`！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-30T15:50:02.423

[http://lists.apple.com/archives/darwin-dev/2005/Apr/msg00050.html](http://lists.apple.com/archives/darwin-dev/2005/Apr/msg00050.html)`malloc_default_zone`中提到的技术似乎仍然有效，请参见[http://code.google.com/p/fileview/source/ browse/trunk/fileview/fv_zone.cpp?spec=svn354&r=354](http://code.google.com/p/fileview/source/browse/trunk/fileview/fv_zone.cpp?spec=svn354&r=354)的示例用法似乎与您的意图相似。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-07-29T10:14:04.023

经过大量搜索（包括这里）和 10.7 的问题后，我决定写一篇关于这个主题的博客文章：[How to set malloc hooks in OSX Lion](http://bkdc.ubiquity.ro/2011/07/how-to-set-malloc-hooks-in-osx-lion-107.html)

您会在文章末尾找到一些很好的链接，其中包含有关此主题的更多信息。

基本解决方案：

```
malloc_zone_t *dz=malloc_default_zone();
if(dz->version>=8)
{
    vm_protect(mach_task_self(), (uintptr_t)malloc_zones, protect_size, 0, VM_PROT_READ | VM_PROT_WRITE);//remove the write protection
}
original_free=dz->free;
dz->free=&my_free; //this line is throwing a bad ptr exception without calling vm_protect first
if(dz->version==8)
{
    vm_protect(mach_task_self(), (uintptr_t)malloc_zones, protect_size, 0, VM_PROT_READ);//put the write protection back
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-30T18:51:09.833

这是一个古老的问题，但我在尝试自己做这件事时遇到了它。对于我正在从事的个人项目，我对这个主题感到好奇，主要是为了确保我认为自动解除分配的内容被正确解除分配。我最终编写了一个 C++ 实现，以允许我跟踪分配的堆的数量并在我选择时将其报告出来。

[https://gist.github.com/monitorjbl/3dc6d62cf5514892d5ab22a59ff34861](https://gist.github.com/monitorjbl/3dc6d62cf5514892d5ab22a59ff34861)

顾名思义，这是特定于 OSX 的。但是，我能够在 Linux 环境中使用`malloc_usable_size`

**例子**

```
#define MALLOC_DEBUG_OUTPUT
#include "malloc_override_osx.hpp"

int main(){
   int* ip = (int*)malloc(sizeof(int));
   double* dp = (double*)malloc(sizeof(double));

   free(ip);
   free(dp);
} 
```

**建造**

```
$ clang++ -isysroot /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.11.sdk \
          -pipe -stdlib=libc++ -std=gnu++11 -g -o test test.cpp
$ ./test
0x7fa28a403230 -> malloc(16) -> 16
0x7fa28a403240 -> malloc(16) -> 32
0x7fa28a403230 -> free(16) -> 16
0x7fa28a403240 -> free(16) -> 0 
```

希望这对将来的其他人有所帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T15:52:41.800

如果您需要的基本统计数据可以收集在一个简单的包装器中，那么一个快速（而且有点脏）的技巧就是使用一些`#define`宏替换。

```
void* _mymalloc(size_t size)
{
    void* ptr = malloc(size);

    /* do your stat work? */

    return ptr;
}
```

和

```
#define malloc(sz_) _mymalloc(sz_)
```

**注意**：如果宏是在 _mymalloc 定义*之前*定义的，它将最终替换该函数内的 malloc 调用，从而使您陷入无限递归……因此请确保不是这种情况。您可能希望`#undef`在该函数定义之前显式地定义它，然后根据最终包含它的位置简单地（重新）定义它，以希望避免这种情况。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-30T16:31:36.867

我认为如果您在项目中包含的自己的 .c 文件中定义 malloc() 和 free() ，链接器将解析该版本。

那么，你打算如何实现malloc呢？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-07-22T05:51:56.623

在[https://github.com/emeryberger/Heap-Layers/blob/master/wrappers/macwrapper.cpp](https://github.com/emeryberger/Heap-Layers/blob/master/wrappers/macwrapper.cpp)（以及一些其他文件，您可以按照包含跟踪自己）。

这是对亚历克斯的回答的补充，但我认为这个例子更重要的是替换系统提供的分配器。

# css - IE6 prototype.js/window.js 渲染问题

> ID：929898
> 
> 赞同：0
> 
> 时间：2009-05-30T15:09:31.010
> 
> 标签：css, iframe, html, internet-explorer-6

有没有其他人遇到过您使用 window.js 库创建基于原型的窗口的问题，并且它在除 IE6 之外的所有浏览器中都可以正常呈现？

我试图用来调试这个问题的测试页面可以在 rik.kmshooting.com/test.php 查看

如您所见，窗口图形（在 CSS 中分配的背景图像值）显然在 IE6 中被清除了。我已经尝试了实际开发这个的网站上给出的例子，它似乎在那里做同样的事情。

如果有人对此问题提出了答案或解决方法，我会很高兴。

谢谢各位。

～啊～

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T15:39:55.030

我不确定你的具体情况，但我有一些 CSS 背景的实例没有出现在 IE6 的模式对话框中。使用 JavaScript 在页面加载时预加载图像解决了这个问题：

```
tmpImg = new Image()
tmpimg.src ="image/bg1.gif" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-01T23:26:59.510

There is a server side fix for flickering background images in IE6.

Add an HTTP header, something like Cache-Control: post-check=3600,pre-check=43200

This page is for IIS but some people mention Apache in the comments: [http://aspnetresources.com/blog/cache_control_extensions.aspx](http://aspnetresources.com/blog/cache_control_extensions.aspx)

# javascript - JavaScript 中的取模 - 大数

> ID：929910
> 
> 赞同：19
> 
> 时间：2009-05-30T15:15:38.610
> 
> 标签：javascript, integer, modulo

我尝试用 JS 的模函数计算，但没有得到正确的结果（应该是 1）。这是一段硬编码的代码。

```
var checkSum = 210501700012345678131468;
alert(checkSum % 97);

Result: 66 
```

这里有什么问题？

问候， 本尼迪克特

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-15T15:51:16.530

对于 IBAN 计算形式的普通银行帐号，我最终会得到一个包含在字符串数据类型中的非常大的数字。从这个大数字中，当除以 97 -> 大数字 % 97 时，我必须找到其余部分。

一旦我将数据类型转换为整数，我就会得到一个溢出，导致一个负整数，并最终导致一个错误的剩余值。当我看到一些冗长的代码（也给出了错误的结果）时，我忍不住分享我自己的。学分去[寻找具有正态数的非常大数的模](http://www.devx.com/tips/Tip/39012)

```
modulo: function(divident, divisor) {
    var partLength = 10;

    while (divident.length > partLength) {
        var part = divident.substring(0, partLength);
        divident = (part % divisor) +  divident.substring(partLength);          
    }

    return divident % divisor;
} 
```

注意我在这里使用 10 个位置，因为这小于 JavaScript 中最大整数的 15 个（和一些）位置，它导致一个大于 97 的数字，这是一个很好的整数。前两个论点很重要。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-05-05T10:35:51.700

Benedikt 版本的一系列改进：“cRest += '' + cDivident;” 是一个错误修正；parseInt(divisor) 可以将两个参数作为字符串传递；最后检查空字符串使其始终返回数值；添加了 var 语句，因此它不使用全局变量；将 foreach 转换为旧式 for，因此它可以在使用旧 Javascript 的浏览器中工作；修复了 cRest == 0；错误（感谢@Dan.StackOverflow）。

```
函数模（除数，除数）{
    var cDivident = '';
    var cRest = '';

    for (var i in divident ) {
        var cChar = 分红[i];
        var cOperator = cRest + '' + cDivident + '' + cChar;

        if ( cOperator < parseInt(divisor) ) {
                cDivident += '' + cChar;
        } 别的 {
                cRest = cOperator % 除数；
                如果（cRest == 0）{
                    cRest = '';
                }
                cDivident = '';
        }

    }
    cRest += '' + cDivident;
    如果（cRest == ''）{
        休息 = 0;
    }
    返回 cRest；
}

```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-30T15:23:55.007

看起来你已经成为这个问题的受害者：[JavaScript 的最高整数值是多少，一个 Number 可以达到而不会丢失精度？](https://stackoverflow.com/questions/307179/what-is-javascripts-max-int-whats-the-highest-integer-value-a-number-can-go-to)

只是重申另一个线程中的内容：

> 它们是 64 位浮点值，最大精确整数值为 2^53。但是，从规范部分[8.5：数字类型]：
> 
> 一些 ECMAScript 运算符仅处理 -2^31 到 2^31-1 范围内的整数，包括 0 到 2^32-1 范围内的整数。这些运算符接受 Number 类型的任何值，但首先将每个此类值转换为 2^32 个整数值之一。分别参见第 0 节和第 0 节中对 ToInt32 和 ToUint32 运算符的说明

但是信用到期。吉米在那里得到了接受的答案，因为他做了跑腿工作（嗯，谷歌搜索）。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-07-19T11:42:53.620

对于那些只想在 ES6 中复制和粘贴工作（功能）解决方案以检查 IBAN 的人：

```
function isIBAN(s){
    const rearranged = s.substring(4,s.length) + s.substring(0,4);
    const numeric   = Array.from(rearranged).map(c =>(isNaN(parseInt(c)) ? (c.charCodeAt(0)-55).toString() : c)).join('');
    const remainder = Array.from(numeric).map(c => parseInt(c)).reduce((remainder, value) => (remainder * 10 + value) % 97,0);

    return  remainder === 1;} 
```

你甚至可以把它写成单行。

对存储实际数字的整数数组执行模运算（`divident`作为字符串应用于函数）：

```
function modulo(divident, divisor){
   return Array.from(divident).map(c => parseInt(c)).reduce((remainder, value) => (remainder * 10 + value) % divisor,0);
}; 
```

这是有效的，因为 Modulo 是对加法、减法和乘法的分配：

*   (a+b)%m = ((a%m)+(b%m))%m
*   (ab)%m = ((a%m)-(b%m))%m
*   (a *b)%m = ((a%m)* (b%m))%m

转译为 ES5 的 IBAN 函数如下所示：

```
function (s) {
    var rearranged = s.substring(4, s.length) + s.substring(0, 4);
    var numeric = Array.from(rearranged).map(function (c) { return (isNaN(parseInt(c)) ? (c.charCodeAt(0) - 55).toString() : c); }).join('');
    var remainder = Array.from(numeric).map(function (c) { return parseInt(c); }).reduce(function (remainder, value) { return (remainder * 10 + value) % 97; }, 0);
    return remainder === 1;
}; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-17T22:29:44.450

最后，我的解决方案：

```
function modulo (divident, divisor) {
    cDivident = '';
    cRest = '';

    for each ( var cChar in divident ) {
        cOperator = cRest + '' + cDivident + '' + cChar;

        if ( cOperator < divisor ) {
            cDivident += '' + cChar;
        } else {
            cRest = cOperator % divisor;
            if ( cRest == 0 ) cRest = '';
            cDivident = '';
        }

    }

    return cRest;
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-12-14T21:14:48.460

Silent Matt 为大整数开发了一个 Javascript[库](http://silentmatt.com/biginteger/)。它也可以解决这个问题。

# java - 将 JPanel 堆叠在其他之上

> ID：929911
> 
> 赞同：1
> 
> 时间：2009-05-30T15:15:57.283
> 
> 标签：java, swing, layout, jpanel

我创建了 5 个非常相似的面板，它们应该在同一帧的同一区域中一次可见，我的意思是当应用程序为其中一个 (JPanel0) 加注星标时，其中一个 (JPanel0) 可见，而其他四个已创建但不可见当我点击 Button1 时，JPanel1 设置为可见，而 JPanel0 变为不可见，与所有人相同。

我设法接近 BorderLayout 但我不能让所有这些都集中在中心位置。有人能帮我吗？非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-30T15:22:51.543

可能[`CardLayout`](http://java.sun.com/javase/6/docs/api/java/awt/CardLayout.html)是您正在寻找的东西？

[Java 教程](http://java.sun.com/docs/books/tutorial/index.html)有一篇关于[如何使用 CardLayout](http://java.sun.com/docs/books/tutorial/uiswing/layout/card.html)的文章，其中包括一个在几个`JPanel`s 之间切换的示例，这些 s 通过 using 交换`CardLayout`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T16:33:45.930

另一种选择是使用 OverlayLayout。

# php - 基于高流量百分比的选秀权？

> ID：929916
> 
> 赞同：0
> 
> 时间：2009-05-30T15:18:52.567
> 
> 标签：php, mysql, concurrency, memcached

设置：高流量网站和我们要显示的图像 URL 列表。我们有一个图像点，图像 URL 集中的每个项目都有当天的目标显示百分比。例子：

*   图片1 - 10%
*   图片2 - 30%
*   图片3 - 60%

因为流量每天都在变化，所以我在 1000 个块内做百分比。图像也需要随机挑选，但仍然准确地适合分布。

问题：我已经在 memcache 中实现了 POC 代码来执行此操作，但我对数据的存储方式感到不舒服（由“主记录”与元数据映射的多个哈希键）。如果 memcache 服务器出现故障，这也需要能够回退到数据库。我还担心主记录的并发问题。

有没有更简单的方法来实现这一点？也许是一个快速的 mysql 查询或将 memcache 引入其中的更好方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-09T13:58:45.037

你可以按照你说的做，预先生成一个包含 1000 个值的块，指向你将返回的图像：

```
$distribution = "011022201111202102100120 ..." # exactly evenly distributed 
```

然后将该块存储在 MySQL 和 memcache 中，并使用另一个键（在 MySQL 和 memcache 中）保存上述字符串的当前索引值。每当命中图像脚本时，都会增加 memcache 中的值。如果 memcache 出现故障，请转至 MySQL（先更新，然后再选择；可能有更好的方法来完成这部分）。

为了使 memcache 和 MySQL 保持同步，您可以让一个 cron 作业将当前索引值从 memcache 复制到 MySQL。你会失去一些准确性，但这在这种情况下可能并不重要。

您可以在 MySQL 和 memcache 中存储多个分布，并拥有另一个指向当前活动分布的键。这样您就可以预生成未来的图像块。当索引超过分布时，脚本将增加键并转到下一个。

大致：

```
function FetchImageFname( )
{
  $images = array( 0 => 'image1.jpg', 1 => 'image2.jpg', 2 => 'image3.jpg' );
  $distribution = FetchDistribution( );
  $currentindex = FetchCurrentIndex( );

  $x = 0;
  while( $distribution[$currentindex] == '' && $x < 10 );
  {
    IncrementCurrentDistribKey( );
    $distribution = FetchDistribution( );
    $currentindex = FetchCurrentIndex( );
    $x++;
  }

  if( $distribution[$currentindex] == '' )
  {
    // XXX Tried and failed. Send error to central logs.
    return( $images[0] );
  }

  return( $distribution[$currentindex] );
}

function FetchDistribution( )
{
  $current_distib_key = FetchCurrentDistribKey( );
  $distribution = FetchFromMemcache( $current_distrib_key );
  if( !$distribution )
    $distribution = FetchFromMySQL( $current_distrib_key );
  return $distribution;
}

function FetchCurrentIndex( )
{
  $current_index = MemcacheIncrement( 'foo' );
  if( $current_index === false )
    $current_index = MySQLIncrement( 'foo' );
  return $current_index;
} 
```

.. 等函数名称有点臭，但我想你会明白的。当 memcache 服务器再次备份时，您可以将数据从 MySQL 复制回 memcache，它会立即重新激活。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T03:15:36.627

对数据库的访问很可能需要更长的时间，所以我会坚持使用 memcache。与 memcache 相比，使用 MySQL 的并发性问题会更多。memcache 能够更好地处理大量请求，如果服务器出现故障，这将是您在高流量网站上最不担心的问题。

如果您给我们更多细节，也许 MySQL 专家可以在这里提供一个良好的查询结构。

# iphone - 实现防震防抖算法的基本概念是什么？

> ID：929919
> 
> 赞同：2
> 
> 时间：2009-05-30T15:19:21.317
> 
> 标签：iphone, accelerometer

我在精细加速度检测时发生了一些动画。但是当用户坐在车里或走路时，它可能会变得烦人。

基本上，一旦有太多的振动或晃动，所有这些东西都必须自动禁用。从概念上讲，我认为很难过滤掉这些振动，因为“振动阶段”会永久改变。我将“不需要的振动或冲击”定义为加速度值变化非常快，值间隔很大，或者是在指定的最短时间段内不超过指定阈值范围的永久变化的累积值。

在我开始重新发明轮子几天之前，我正在寻找“经过验证的”概念。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-30T15:32:57.547

我没有任何具体的答案给你，但你可能想谷歌带通滤波器或抗锯齿滤波器，以了解如何解决这个问题。基本上，如果您可以确定您想要考虑真实的加速度的频率范围，您可以过滤掉超出此范围的频率。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-30T20:12:54.827

在你开始做太多的预优化之前，我认为你应该实现一个低通滤波器，看看它是否能完成这项工作。大多数 iPhone 应用程序有效地使用 LPF 的变体来消除不需要的加速度计噪声。

您也可以采用另一种方式并使用高通滤波器。一旦通过 HPF 获得一定的功率水平，停止处理数据。

# jquery - 是否有插件可以让 jQuery.ajax 提交多部分/表单数据？

> ID：929920
> 
> 赞同：4
> 
> 时间：2009-05-30T15:19:40.070
> 
> 标签：jquery, ajax

我需要这个，所以我可以提交包含非 ASCII 文本的表单控件子集。

带有 iframe 元素的解决方案对我不起作用，因为它提交了整个表单；我只想提交控件的一个子集。

我知道我可以自己构建一个多部分/表单数据字符串，但似乎这必须在之前完成......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-31T07:43:27.877

我建议使用 jQuery 和表单插件： http: [//malsup.com/jquery/form/#api](http://malsup.com/jquery/form/#api)

您可以使用该`fieldSerialize()`方法仅提交表单的子集和`iframe:true`选项以使其与提交文件等一起使用。

希望对你有用！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-04-03T17:45:26.860

更新：从 3.02 版（2012 年初发布）开始， [jquery.form](http://jquery.malsup.com/form/#ajaxForm)插件现在可以更友好地处理 ajax 文件提交。核实。

# .net - visual studio.net dll参考问题

> ID：929926
> 
> 赞同：1
> 
> 时间：2009-05-30T15:22:26.723
> 
> 标签：.net, build-process, reference, dependencies

我们有几个 c# 项目、库和解决方案（一些 asp.net 应用程序、一些类库、windows 应用程序，如 windows 服务和 winform 应用程序等），其中大多数依赖于彼此的输出 dll。我们的一些项目被分组到解决方案中，它们使用项目依赖项。但有些项目不是。我们（不幸的是）使用 VSS 来管理源代码。当将程序集引用到项目时，有时我会看到存储在 vss 中的刷新文件，但是当您最初获得最新版本时，实际的 dll 永远不会出现，有时只是程序集而不是 vss 托管，有时只是程序集，它们似乎由 vss 管理。您可以猜到，管理这些文件对我们来说是一场噩梦，尤其是在发布 Web 应用程序时。我们永远无法确定库 dll 的最新版本是否正在发布。您能否就管理这种复杂性提出任何最佳实践建议？也欢迎任何文章。我们应该将所有库保存在网络文件夹中并使用刷新文件吗？所以团队中的每个开发人员都应该将他的输出文件复制到该网络共享？

谢谢，乌姆特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T15:30:52.340

我解决这个问题的方法是将引用的 DLL 的副本放在我的 Web 应用程序的 bin 目录中，并将它们作为项目的一部分包含在源代码安全中。

这样，如果 DLL 被更新，它就像签出 - 覆盖 - 签入一样简单，团队中的所有成员都可以拥有最新的文件。

此外，它使部署变得容易，因为文件在发布期间包含在内。只需将构建类型设置为内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T15:59:39.147

最简单和最手动的方法是在某处放置某种文档来描述您的 Web 应用程序并指出它的依赖项、它们的版本以及它们在源代码安全中的位置。将其添加为构建脚本的一部分。

一种更难且更少手动的方法是实现某种形式的构建自动化。我建议好好看看 MSBuild ( [http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx](http://msdn.microsoft.com/en-us/library/0k6kkbsd.aspx) )，它使用 XML 文件作为一种脚本语言。同时下载社区任务包 ( [http://msbuildtasks.tigris.org/](http://msbuildtasks.tigris.org/) )。使用这两个工具，您应该能够生成一个 MSBuild 文件，该文件从 sourcesafe 获取各种解决方案，然后构建它们（请注意，您可以从 MSBuild 文件调用 MSBuild 文件。另请注意，Visual Studio 解决方案文件是 MSBuild 文件- 您可以让您的 MSBuild 脚本只运行开发人员在 Visual Studio 中创建的构建）。完成后，您可以将结果部署到您想要的任何地方。

# svn - 什么是 svn 标记导出？您如何在构建过程中使用它？

> ID：929927
> 
> 赞同：0
> 
> 时间：2009-05-30T15:22:31.577
> 
> 标签：svn, build-process, lamp

具体来说，我对 LAMP Stack 以及将其用于各种构建的一些最佳实践感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-30T16:44:12.627

'export' 和 'tag' 是 SVN 中两个非常不同的概念。标签基本上只是项目在特定时间点的副本；据 Subversion 软件所知，它们只是文件夹。另一方面，“导出”是客户端软件支持的操作，它从存储库创建目录的副本，而不需要工作目录所需的 SVN 元数据。

我建议阅读[红皮书](http://svnbook.red-bean.com/)，尤其是关于[存储库布局](http://svnbook.red-bean.com/en/1.5/svn.tour.importing.html#svn.tour.importing.layout)和[标记](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.tags.html)的部分。

# iphone - 超过五秒 iphone 声音

> ID：929932
> 
> 赞同：3
> 
> 时间：2009-05-30T15:25:29.480
> 
> 标签：iphone, objective-c, xcode

嘿大家。以下是我用来在 iPhone 模拟器上播放随机声音的代码。大约 30 种声音中的一些无法播放，经过一番调查，我发现那些没有播放的声音超过了 5 秒。有人知道为什么是这样吗？在此先感谢您的帮助！

```
NSString *path = [[NSBundle mainBundle] pathForResource:sound ofType:@"wav"];
SystemSoundID soundID;
AudioServicesCreateSystemSoundID((CFURLRef)[NSURL fileURLWithPath:path], &soundID);
AudioServicesPlaySystemSound (soundID); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-30T15:49:50.677

我相信使用 AudioServicesPlaySystemSound 播放声音的时间限制为 5 秒（尽管某些版本的文档声称为 30 秒）。

替代方案是 openAL 和音频队列。这里有一个关于 openAL 的有用教程：http: [//benbritten.com/blog/2008/11/06/openal-sound-on-the-iphone/](http://benbritten.com/blog/2008/11/06/openal-sound-on-the-iphone/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-31T08:08:36.563

限制应该只在 iPhone 模拟器中，而不是在设备上。在设备上，AudioServicesPlaySystemSound 最多应播放 30 秒的声音。

我相信声音格式/压缩是导致“人为”5 秒限制的原因。使用终端上的 afconvert 将声音转换为 Apple 建议的格式。

# entity-framework - 实体框架继承：TPT、TPH 还是没有？

> ID：929938
> 
> 赞同：15
> 
> 时间：2009-05-30T15:27:58.320
> 
> 标签：entity-framework, inheritance

我目前正在阅读有关使用实体框架继承的可能性。有时我使用一种方法来键入数据记录，但我不确定是否会使用 TPT 或 TPH 或不使用...

例如...我有一个电子商务商店，它添加了送货、账单和送货地址

我有一个地址表：

```
RecordID
AddressTypeID
Street
ZipCode
City
Country 
```

和一张桌子`AddressType`

```
RecordID
AddressTypeDescription 
```

当人们炫耀 TPT 或 TPH 时，表格设计与一般设计不同......当有这样的方法时考虑继承是否有意义......

我希望这是有道理的...

谢谢你的帮助...

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-31T01:02:49.453

在考虑如何在数据库中表示继承时，您需要考虑一些事情。

如果您有许多不同的子类，您可以在涉及那些可能会损害性能的更复杂类型的查询中进行大量额外的连接。TPH 的一大优势是您可以在一个表中查询层次结构中的所有类型，这对性能有好处，尤其是对于较大的层次结构。出于这个原因，我倾向于在大多数情况下使用这种方法

但是，TPH 意味着您不能再拥有`NOT NULL`子类型的字段，因为所有类型的所有字段都在一个表中，从而将数据完整性的责任推给了您的应用程序。虽然这在实践中可能听起来很可怕，但我并没有发现这是太大的限制。

但是，如果每种类型都有很多字段并且层次结构中的类型数量可能很小，我会倾向于使用 TPT，这意味着连接的性能不是那么大的问题，而且你会变得更好数据的完整性。

请注意，EF 和其他 ORM 的优点之一是您可以在不影响您的应用程序的情况下改变主意，因此不需要完全刻板地做出决定。

在您的示例中，它似乎没有继承关系，从地址类型到地址看起来像一对多

这将在您的类之间表示，如下所示：

```
Address.AddressType
AddressType.Addresses 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-04-08T17:02:08.913

正如 Keith 所暗示的那样，这篇[文章](http://www.codeproject.com/Articles/66313/The-Entity-Framework-v1-and-v4-Deal-Breaker-TPT-In.aspx)建议 EF 中的 TPT 非常糟糕，但我自己还没有尝试过。

# php - 知道如何做 (1) php 身份验证 (2) 启动一个知道用户已经通过身份验证的 flex 应用程序

> ID：929939
> 
> 赞同：1
> 
> 时间：2009-05-30T15:29:13.840
> 
> 标签：php, apache-flex, authentication

几乎所有内容都在标题中：

这是我想做的事情：

1.  一个带有 php 身份验证过程的漂亮 html 页面（首先是 http，然后是 http **s**等等）
2.  启动一个 flex 应用程序，该应用程序*知道*（我不知道**如何**（这是实际问题！））用户已经通过身份验证并显示他/她当天必须做的事情（或其他任何事情......） .

当然，如果有人尝试直接调用 flex 应用程序，我会显示“身份验证错误”消息，然后重定向到身份验证页面。

我很抱歉我的英语很完美。

我在考虑会话 cookie：首先进行身份验证，然后在服务器端设置一个变量，例如：

```
$_SESSION['authenticate']=true 
```

然后，在 flex 端，只需发送 cookie 并询问用户是否经过正确身份验证，例如调用 php 网页，例如：

```
https://is_authenticated.php?php_session=xxxx 
```

谢谢

奥利维尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T15:41:38.307

你在正确的轨道上！
您可以使用会话身份验证，这些链接可能会帮助您：

*   [http://www.zend.com/zend/spotlight/sessionauth7may.php](http://www.zend.com/zend/spotlight/sessionauth7may.php)
*   [http://www.tizag.com/phpT/phpsessions.php](http://www.tizag.com/phpT/phpsessions.php)

还有可能使用http-authentication

*   [http://se2.php.net/features.http-auth](http://se2.php.net/features.http-auth)

但是 http-authentication 不如 session-authentication 灵活，并且还意味着在服务器端进行更多配置。因此，我建议您坚持使用会话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-31T00:56:31.850

这正是我会做的......从安全的角度来看需要考虑的几件事：

*   如果你的 php 服务（来自 flex）得到一个未知的会话令牌，*总是*生成一个新的。这也适用于您的 PHP 应用程序，但经常被忽视。
*   我将使用 javascript 生成 swf，并使用 javascript 手动插入会话 cookie。这样，人们就不会下载并保护（或缓存）您的 php 页面，这些页面在未来会出现无效的会话。
*   更好的是使用会话以外的单独令牌，并在服务器上根据此弹性令牌确定会话 ID 是什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T18:10:39.547

你在服务器端使用什么？请记住，除了发送 SESSION ID 和任何请求之外，您不应该在 flex 应用程序中做任何事情。每当客户端检查安全性时，您都会遇到错误。服务器必须验证会话并确定是否允许请求。

在您最后的评论中听起来您担心人们手动调用网页。每个页面都必须检查用户是否经过身份验证。我不知道您的具体应用程序，但您可以尝试查看[AMFPHP](http://www.amfphp.org)并了解他们如何进行[会话身份验证](http://www.amfphp.org/docs/helperclasses.html)。祝你好运！

# javascript - 输入类型文件大小在 Linux/Windows 中有所不同

> ID：929946
> 
> 赞同：0
> 
> 时间：2009-05-30T15:31:27.017
> 
> 标签：javascript, html, css

我有一个带有and的`input type="file"`元素。它在 Windows 上的所有浏览器中看起来和工作正常，但在 Linux 上的 Firefox 中，输入元素大于 522 像素。`size="70"``width="522px"`

我尝试过的事情：

1.  `max-width:522px`但它不起作用（Linux）。
2.  设置`size="52"`并且`min-width:522px;`在 Linux 中看起来不错，但在 Windows 上的 Firefox 中不起作用。

如何指定 522 像素宽度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-30T16:02:16.137

问题是浏览器不会将按钮视为输入的一部分。所以如果你有类似的东西：

```
<div style="width: 500px; overflow: hidden">
<input type="file" id="uploadfile_0" class="fileinput" style="border: 2px solid #a9a9a9; width: 100%; height: 22px;" name="uploadfile_0"/>
</div> 
```

输入按钮浏览在父级之外，我认为没有简单的解决方案。

您可以在 quirksmode.org 上阅读[有关样式输入 type="file"的信息](http://www.quirksmode.org/dom/inputfile.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T15:33:42.210

仅指定 CSS `width`，如下所示：

```
<input type="file" style="width: 522px;" ..... /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T01:33:45.863

我见过的文件输入字段样式化的唯一方法是通过一个技巧，该字段实际上位于图像顶部，并且该字段的不透明度为零。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-14T15:10:01.537

```
function inFil() {
    var inFil = document.getElementById("inFil");
    var iSize = inFil.files[0].size;
    alert(iSize);
   // where inFil is existing html tag <input type="button" id="inFil" >
} 
```

适用于 Firefox，但不适用于 IE8，其他未测试。

# actionscript-3 - 将帧同步到音频和 channel.position 精度

> ID：929949
> 
> 赞同：0
> 
> 时间：2009-05-30T15:32:04.083
> 
> 标签：actionscript-3, actionscript, synchronization, audio

在 ENTER_FRAME 事件上调用 channel.position，我注意到它不是每帧都更新，但它看起来更像是每帧半。

```
var sound:Sound = new Sound(new URLRequest('music.mp3')); 
var channel:SoundChannel = sound.play(); // assume the sound is completely,
                                         // totally, 100% loaded

addEventListener(Event.ENTER_FRAME, function(e:Event):void{
   trace(  "Position : " + channel.position 
         + " - Frame : " + int(channel.position / 30));
}); 
```

将导致（30 FPS）

```
 ...
   Position : 1439.6371882086166 - Frame : 47
   // 48 is missing
** Position : 1486.077097505669 -  Frame : 49
** Position : 1486.077097505669 -  Frame : 49
   Position : 1532.517006802721 -  Frame : 51
   Position : 1578.9569160997733 - Frame : 52
   // 53 is missing
** Position : 1625.3968253968253 - Frame : 54
** Position : 1625.3968253968253 - Frame : 54
   Position : 1671.8367346938776 - Frame : 55
   // 56 is missing
   Position : 1718.2766439909296 - Frame : 57
   ... 
```

以前有没有人注意到这种行为？知道这种不准确性，是否有任何技术可以确定正在播放的音频“帧”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T18:03:39.390

是的，这是正常行为，因为事件是线程化的，因此只要线程具有优先级，就会调用它们的委托。打印到控制台也是线程化的，因此它也可能并不总是在正确的时间打印消息。事实上，您看到的问题可能只是打印问题。尝试提高帧率，看看会发生什么。

不过，为了更准确，您可以尝试使用计时器类。通常，您可以使滴答声发生的速度比帧快得多，这意味着误差幅度会更低。不过，您正在使用该事件，因此可能会有一些偏差。

为了弥补这一点，您可以检查时间与帧以确定偏移量。这使您可以纠正任何漂移。

编辑：此示例直接从ActionScript 3 文档中的[此页面](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/media/SoundChannel.html#includeExamplesSummary)`positionTimer`中提取，请注意他们正在使用：

```
package {
    import flash.display.Sprite;
    import flash.events.*;
    import flash.media.Sound;
    import flash.media.SoundChannel;
    import flash.net.URLRequest;
    import flash.utils.Timer;

    public class SoundChannelExample extends Sprite {
        private var url:String = "MySound.mp3";
        private var soundFactory:Sound;
        private var channel:SoundChannel;
        private var positionTimer:Timer;

        public function SoundChannelExample() {
            var request:URLRequest = new URLRequest(url);
            soundFactory = new Sound();
            soundFactory.addEventListener(Event.COMPLETE, completeHandler);
            soundFactory.addEventListener(Event.ID3, id3Handler);
            soundFactory.addEventListener(IOErrorEvent.IO_ERROR, ioErrorHandler);
            soundFactory.addEventListener(ProgressEvent.PROGRESS, progressHandler);
            soundFactory.load(request);

            channel = soundFactory.play();
            channel.addEventListener(Event.SOUND_COMPLETE, soundCompleteHandler);

            positionTimer = new Timer(50);
            positionTimer.addEventListener(TimerEvent.TIMER, positionTimerHandler);
            positionTimer.start();
        }

        private function positionTimerHandler(event:TimerEvent):void {
            trace("positionTimerHandler: " + channel.position.toFixed(2));
        }

        private function completeHandler(event:Event):void {
            trace("completeHandler: " + event);
        }

        private function id3Handler(event:Event):void {
            trace("id3Handler: " + event);
        }

        private function ioErrorHandler(event:Event):void {
            trace("ioErrorHandler: " + event);
            positionTimer.stop();       
        }

        private function progressHandler(event:ProgressEvent):void {
            trace("progressHandler: " + event);
        }

        private function soundCompleteHandler(event:Event):void {
            trace("soundCompleteHandler: " + event);
            positionTimer.stop();
        }
    }
} 
```

# validation - 我如何告诉 libxml-ruby 外部实体文件？

> ID：929952
> 
> 赞同：4
> 
> 时间：2009-05-30T15:33:24.550
> 
> 标签：validation, dtd, libxml2, libxml-ruby

我正在尝试使用[libxml-ruby's`DTD#validate`](http://libxml.rubyforge.org/rdoc/classes/LibXML/XML/Dtd.html)进行验证，但我不断收到以下警告：

```
Warning: failed to load external entity "xhtml-lat1.ent" at :29.
Warning: failed to load external entity "xhtml-symbol.ent" at :34.
Warning: failed to load external entity "xhtml-special.ent" at :39. 
```

我不介意，除非我使用`&hellip;`了那些定义的东西，导致我的 XHTML 看起来是无效的。

我如何告诉 DTD 那些额外的文件？我尝试从包含`.dtd`文件和所有`.ent`s 的目录运行，但这没有帮助。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2009-06-23T17:17:24.243

阅读发行说明，我怀疑您需要使用

```
XML.default_substitute_entities = true 
```

或者

```
XML.default_load_external_dtd = true 
```

或两者。

# c++ - 在编辑框中启用垂直滚动时遇到问题

> ID：929955
> 
> 赞同：0
> 
> 时间：2009-05-30T15:34:36.233
> 
> 标签：c++, visual-studio-2005, mfc

我正在使用 Visual Studio 2005 并用 C++ 编写基于对话框的 MFC 应用程序。

我有一个`edit box`，我正在努力做到`auto-scroll`。
当我将 auto 设为`vscroll`true时，`auto-scroll`当我的`edit box`.

有什么想法可能是错的吗？是否有一些我必须添加到我的代码行`edit box`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-30T16:10:05.027

“自动滚动”是什么意思？

打开自动 vscroll 启用[ES_AUTOVSCROLL](http://msdn.microsoft.com/en-us/library/bb775464.aspx)编辑控件样式：

> ES_AUTOVSCROLL - 当用户在最后一行按下 ENTER 键时，自动将文本向上滚动一页。

这可能不是您认为“自动滚动”的意思。一个常见的误解是，当在编辑控件中输入更多文本时，自动 vscroll 会自动打开/关闭垂直滚动条。情况并非如此，您必须始终显示滚动条，或者您必须自己编写代码来自己打开和关闭滚动条。

# mysql - 如何绘制我的数据库设计？

> ID：929958
> 
> 赞同：8
> 
> 时间：2009-05-30T15:36:58.027
> 
> 标签：mysql, database

我有 mysql 数据库，我想要一个可以为我绘制数据库设计的软件？

有什么办法吗？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-30T15:43:43.937

我认为您可以使用 MySQL Workbench，它应该具有逆向工程（从数据库到模型）。

[http://dev.mysql.com/workbench/](http://dev.mysql.com/workbench/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-30T15:53:43.233

看看[MySQL Workbench](http://dev.mysql.com/workbench/)，它是免费的，下一个版本（目前是 alpha）将是向前迈出的一大步（它将取代 MySQL Query Browser）。

您可以使用[Visual Architect](http://www.visual-paradigm.com/product/dbva/)或[Power Designer](http://www.sybase.com/products/modelingdevelopment/powerdesigner)进行逆向工程，但您必须付费。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-30T15:47:33.827

Toad for Mysql 也做得很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-30T15:49:30.693

只是为了完成奥斯卡的答案。

这是链接：[MySQL Workbench](http://www.mysql.fr/products/workbench/features.html)

还有一些截图：

[![工作台视觉设计](https://i.stack.imgur.com/utW0g.gif)](https://i.stack.imgur.com/utW0g.gif)
[（来源：[mysql.fr](http://www.mysql.fr/common/images/products/workbench_visual_design.gif)）][（来源：][[mysql.fr](http://www.mysql.fr/common/images/products/workbench_change_management.gif)][）]
[![工作台变更管理](https://i.stack.imgur.com/oBHbC.gif)](https://i.stack.imgur.com/oBHbC.gif)

顺便说一句，我认为免费版本中不提供逆向工程功能..

你也可以看看那些：

*   [SQLyog](http://en.wikipedia.org/wiki/SQLyog)
*   [Navicat](http://en.wikipedia.org/wiki/Navicat)
*   [海蒂SQL](http://en.wikipedia.org/wiki/HeidiSQL)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-30T14:15:14.310

您可以使用[SQLyog 的](http://www.webyog.com/en/downloads.php)Schema Designer 工具。

使用起来非常简单直观。只需单击 3 次，即可从现有数据库创建可视化数据库设计；

1.  选择数据库，
2.  右键单击画布以选择表格，
3.  单击确定（因为默认情况下选择了所有表）

值得一试……希望对你有帮助……

![SQLyog 的 Schema Designer 工具截图](https://i.stack.imgur.com/So6rI.png)

# iphone - 在自定义单元格按钮单击上获取节号和行号？

> ID：929964
> 
> 赞同：8
> 
> 时间：2009-05-30T15:41:22.003
> 
> 标签：iphone, objective-c, cocoa-touch

我有自定义单元格的表格视图。表格分为许多部分和行。我在单元格上有一个自定义按钮。现在我想在单击该按钮时获取节号和行号。？关于这个的任何想法

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-31T13:07:57.987

您需要在视图控制器上实现 UIControl 事件处理方法，并将其设置为*所有*按钮的处理程序。即在你的`-tableView:cellForRowAtIndexPath:`函数中你会做类似的事情：

```
[theCell.button addTarget: self
                   action: @selector(buttonPressed:withEvent:)
         forControlEvents: UIControlEventTouchUpInside]; 
```

然后您的事件处理程序将如下所示：

```
- (void) buttonPressed: (id) sender withEvent: (UIEvent *) event
{
    UITouch * touch = [[event touches] anyObject];
    CGPoint location = [touch locationInView: self.tableView];
    NSIndexPath * indexPath = [self.tableView indexPathForRowAtPoint: location];

    /* indexPath contains the index of the row containing the button */
    /* do whatever it is you need to do with the row data now */
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-30T17:35:31.843

一些想法：

您可以遍历按钮的超级视图层次结构，直到找到 UITableViewCell，然后在 UITableView 上调用 - (NSIndexPath *)indexPathForCell:(UITableViewCell *)cell。

```
- (void)buttonClicked:(id)sender {
  UIView *button = sender;

  for (UIView *parent = [button superview]; parent != nil; parent = [parent superview]) {
    if ([parent isKindOfClass: [UITableViewCell class]]) {
      UITableViewCell *cell = (UITableViewCell *) parent;           
      NSIndexPath *path = [self.tableView indexPathForCell: cell];

      // now use the index path

      break; // for
    }
  }
} 
```

您可以交替使用按钮的标记来存储引用该行的索引。这仅包含一个整数，因此当您只有一个部分或将行作为平面列表管理时最有意义。

您可以交替继承 UITableViewCell 来封装按钮。您的 UITableViewCell 可以响应按钮事件并将事件重新广播给它自己的委托，传递 self. 然后事件委托可以在 UITableView 上调用 - (NSIndexPath *)indexPathForCell:(UITableViewCell *)cell 来获取索引路径。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-30T15:47:31.097

当您在 tableView 中选择一个单元格时，将调用以下方法：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
```

访问章节号：`int section = indexPath.section;`

访问行号（在正确的部分内）：`int row = indexPath.row;`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T15:56:48.507

UITableView[可以将 CGPoint 坐标转换为 indexPath](http://developer.apple.com/iphone/library/documentation/uikit/reference/UITableView_Class/Reference/Reference.html#//apple_ref/occ/instm/UITableView/indexPathForRowAtPoint:)：

```
-(NSIndexPath *)indexPathForRowAtPoint:(CGPoint)point 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-30T20:19:57.307

添加可以你的 UITableViewCell 子类的实例变量来存储单元格的索引路径：

```
NSIndexPath *myIndexPath; 
```

当您在以下位置创建单元格时：

```
cellForIndexPath: 
```

将 indexpath 传递给新创建/回收的单元格。

现在，当您按下按钮时，只需从单元格的 ivar 中读取索引路径。

# iphone - 有没有办法暂停核心动画并在稍后恢复它？

> ID：929974
> 
> 赞同：8
> 
> 时间：2009-05-30T15:44:00.223
> 
> 标签：iphone, cocoa-touch, uikit, core-animation

我有几个核心动画同时进行。它们都有一个上下文和一个动画 ID，其中上下文是正在动画的对象（UIImageView 对象）。我想暂停它们，让动画暂时停止，然后当一些事情完成后，恢复它以完成它。这些事情只发生在 UIScrollView 中非常快速的滚动运动上。我想通过停止所有正在进行的动画而不是使滚动视图滚动的动画来提高性能。我已经为该滚动视图实现了 contentOffset 的自定义动画。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2010-08-15T18:20:45.473

您可以通过将动画的速度设置为零来暂停图层动画，请参阅[如何暂停图层树的动画](https://developer.apple.com/library/archive/qa/qa1673/_index.html)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-03-28T10:19:42.863

对于任何来搜索的人，这是您暂停和恢复动画的方式：

[https://developer.apple.com/library/archive/qa/qa1673/_index.html](https://developer.apple.com/library/archive/qa/qa1673/_index.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-30T18:53:50.913

我解决这个问题的唯一方法是以下。

对于您希望停止动画的每个视图：

将视图的框架设置为表示层

从该视图中删除所有动画

执行您的滚动

重新计算动画

向视图添加新动画

我知道这不是你想听到的，但它并不像听起来那么糟糕。跟踪要停止的视图的一个好方法是给它们一个预定的标签。

* * *

要删除动画：

[myView.layer removeAllAnimations]

[myView.layer removeAnimationForKey:@"theAnimationKey"]

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-06T01:40:29.133

[核心动画编程指南](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html)有一节关于自定义动画的[计时，](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/AdvancedAnimationTricks/AdvancedAnimationTricks.html#//apple_ref/doc/uid/TP40004514-CH8-SW2)其中包括一节关于[暂停和恢复动画](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/CoreAnimation_guide/AdvancedAnimationTricks/AdvancedAnimationTricks.html#//apple_ref/doc/uid/TP40004514-CH8-SW15)。

# java - Levenshtein 的距离是解决此编辑步骤问题的正确方法吗？

> ID：929975
> 
> 赞同：2
> 
> 时间：2009-05-30T15:44:09.243
> 
> 标签：java, levenshtein-distance

我对 Levenshtein 的距离很熟悉，所以我决定用它来解决[UVA 的 Edit Steps Ladder 问题。](http://online-judge.uva.es/p/v100/10029.html)

我的解决方案是：

```
import java.io.*;
import java.util.*;

class LevenshteinParaElJuez implements Runnable{
    static String ReadLn(int maxLength){  // utility function to read from stdin,
                                          // Provided by Programming-challenges, edit for style only
        byte line[] = new byte [maxLength];
        int length = 0;
        int input = -1;
        try{
            while (length < maxLength){//Read untill maxlength
                input = System.in.read();
                if ((input < 0) || (input == '\n')) break; //or untill end of line ninput
                line [length++] += input;
            }

            if ((input < 0) && (length == 0)) return null;  // eof
            return new String(line, 0, length);
         }catch (IOException e){
            return null;
        }
    }

    public static void main(String args[]) // entry point from OS
    {
        LevenshteinParaElJuez myWork = new LevenshteinParaElJuez();  // Construct the bootloader
        myWork.run();            // execute
    }

    public void run() {
        new myStuff().run();
    }
}
class myStuff implements Runnable{
    public void run(){

        ArrayList<String> theWords = new ArrayList<String>();
        try
        {

        /// PLACE YOUR JAVA CODE HERE

        String leido=LevenshteinParaElJuez.ReadLn(100);

        //System.out.println("lo leido fue "+leido);

        while (leido.length() != 0){
        theWords.add(leido);
        leido=LevenshteinParaElJuez.ReadLn(100);
        }

        }catch(Exception e){
            System.out.println("El programa genero una excepcion");
        }

        int maxEdit=0;
        int actualEdit=0;

     int wordsIndex1 =0, wordsIndex2=0;

     while (wordsIndex1<= theWords.size())
     {
      while (wordsIndex2<= theWords.size()-1){
         actualEdit=Levenshtein.computeLevenshteinDistance(theWords.get(wordsIndex1),theWords.get(wordsIndex2));
         if (actualEdit>maxEdit){maxEdit=actualEdit;}
         wordsIndex2++;
      }
     wordsIndex1++;

     }

     System.out.println(maxEdit+1);

    }

}
class Levenshtein {
    private static int minimum(int a, int b, int c) {
        if(a<=b && a<=c)
            return a;
        if(b<=a && b<=c)
            return b;
        return c;
    }

    public static int computeLevenshteinDistance(String str1, String str2) {
        return computeLevenshteinDistance(str1.toCharArray(),
                                          str2.toCharArray());
    }

    private static int computeLevenshteinDistance(char [] str1, char [] str2) {
        int [][]distance = new int[str1.length+1][str2.length+1];

        for(int i=0;i<=str1.length;i++)
                distance[i][0]=i;

        for(int j=0;j<=str2.length;j++)
            distance[0][j]=j;

        for(int i=1;i<=str1.length;i++)
            for(int j=1;j<=str2.length;j++)
                distance[i][j]= minimum(distance[i-1][j]+1,
                                        distance[i][j-1]+1,
                                        distance[i-1][j-1]+
                                        ((str1[i-1]==str2[j-1])?0:1));

        return distance[str1.length][str2.length];
    }

} 
```

使用此输入：

```
cat
dig
dog
fig
fin
fine
fog
log
wine 
```

它为此示例产生正确的输出：

```
5 
```

法官拒绝了我的回答。这是我第一次尝试解决在线法官的问题，我想我可能会在这里强制一个正确的答案：

```
 System.out.println(maxEdit+1); 
```

因为 maxEdit 在简单地使用 Levenshtein 计算时的值为 4。这是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-31T06:21:25.890

Levinshtein 是相关的，但不会为您提供输出中使用的值。在这个问题中，用它来确定两个词的编辑距离是否正好为 1，表明比较的两个词在编辑阶梯中是相邻的。

遍历字典中的单词。如果下一个单词与当前单词的编辑距离为 1，则*可以*将其设为当前单词，否则必须跳过。

The trick to this problem is finding *all* possible sequences - just because the next word has an edit distance of 1 doesn't mean using it in the ladder will give you the longest possible ladder.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-30T16:21:45.383

问题是你要在字典中找到最长的*字典顺序*（即字母顺序）序列，这样序列中的每个单词都是通过添加、删除或更改一个字母来形成的。

所以样本结果中的 5 是序列（dig, fig, fin,fine, wine）。

我不认为 Levenshtein 与这个问题特别相关，尽管也许我的想象力不够。Levenshtein 没有捕捉到每个步骤都必须在字典中，然后在字典中的要求。

# c++ - C++：为向量中的非连续索引赋值？

> ID：929976
> 
> 赞同：1
> 
> 时间：2009-05-30T15:44:37.493
> 
> 标签：c++, stl, vector

如果我想声明一个未知大小的向量，则按顺序将值分配给索引 5、索引 10、索引 1、索引 100。它在向量中很容易实现吗？

似乎没有简单的方法。因为如果我初始化一个没有大小的向量，那么如果不首先通过 resize() 或五个 push_back() 为其分配内存，我就无法访问索引 5。但是调整大小会清除向量中先前存储的值。我可以通过给它一个大小来构造向量，但我不知道向量应该有多大。

那么我怎样才能不必声明固定大小，并且仍然可以访问向量中的非连续索引呢？

（我怀疑数组会更容易完成这项任务）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-30T15:47:09.117

整数键和值之间的 std::map 在这里不是更简单的解决方案吗？向量需要连续分配内存，所以如果你只使用偶尔的索引，你会“浪费”很多内存。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-30T15:48:55.480

调整大小不会清除矢量。您可以轻松地执行以下操作：

```
 if (v.size() <= n)
      v.resize(n+1);
  v[n] = 42; 
```

这将保留向量中的所有值并添加足够的默认初始化值，以便`n`可以访问索引。

也就是说，如果您不需要所有索引或连续内存，您可能会考虑使用不同的数据结构。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-30T15:49:48.913

`resize()`不会清除向量中先前存储的值。
看到[这个文档](http://www.sgi.com/tech/stl/Vector.html)

我还认为，如果这是您需要做的，那么它可能`vector`不适合您。你考虑过使用`map`可能吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-30T19:16:47.140

不包含一组连续值的数据结构称为*稀疏*或*压缩*数据结构。看来这就是你要找的东西。

如果是这种情况，您需要一个*稀疏向量*。在 boost 中实现了一个，请参阅[链接文本](http://www.boost.org/doc/libs/1_39_0/libs/numeric/ublas/doc/vector_sparse.htm)

稀疏结构通常用于节省内存。从您的问题描述中可能您实际上并不关心内存使用，而是关心尚不存在的元素（您想要一个自动调整大小的容器）。在这种情况下，一个没有外部依赖的简单解决方案如下：

创建一个包含向量并将所有向量方法转发给它的模板类。如果索引超出范围，请更改您的 operator[] 以调整向量的大小。

```
// A vector that resizes on dereference if the index is out of bounds.
template<typename T>
struct resize_vector
{
    typedef typename std::vector<T>::size_type size_type;
    // ... Repeat for iterator/value_type typedefs etc

    size_type size() const { return m_impl.size() }
    // ... Repeat for all other vector methods you want

    value_type& operator[](size_type i)
    {
        if (i >= size())
            resize(i + 1); // Resize
        return m_impl[i];
    }
    // You may want a const overload of operator[] that throws
    // instead of resizing (or make m_impl mutable, but thats ugly).

private:
    std::vector<T> m_impl;
}; 
```

如其他答案所述，调整矢量大小时不会清除元素。相反，当通过调整大小添加新元素时，会调用它们的默认构造函数。因此，您需要知道何时使用`operator[]`可能会返回默认构造对象引用的此类。因此，您的默认构造函数`<T>`应该为此目的将对象设置为合理的值。例如，如果您需要知道该元素之前是否已被分配一个值，您可以使用一个标记值。

`std::map<size_t, T>`如果您不介意额外的内存使用、非连续元素存储和 O(logN) 查找而不是向量的 O(1)，则使用 a 的建议作为解决方案也有优点。这一切都归结为您是想要稀疏表示还是自动调整大小；希望这个答案涵盖两者。

# c# - [OptionalField] 属性是怎么回事？

> ID：929985
> 
> 赞同：9
> 
> 时间：2009-05-30T15:48:51.237
> 
> 标签：c#, .net, serialization, fault-tolerance

据我了解，当我反序列化缺少这个新成员的旧版本的类时，我必须使用 [OptionalField] 属性在我的类的新版本中装饰一个新成员。

但是，在序列化类之后添加 InnerTranslator 属性时，下面的代码不会引发异常。我在 onDeserialization 方法中检查该属性是否为 null（这确认它没有被序列化），但我本以为代码会因此引发异常。[OptionalField] 属性本身是可选的吗？

```
class Program
{
    static void Main(string[] args)
    {
        var listcol = new SortedList<string,string>
        {
            {"Estados Unidos", "United States"},
            {"Canadá", "Canada"},
            {"España", "Spain"}
        };
        var translator = new CountryTranslator(listcol);
        using (var file_stream=new FileStream("translator.bin",FileMode.Open))
        {
            var formatter = new BinaryFormatter();
            translator = formatter.Deserialize(file_stream) as CountryTranslator;
            file_stream.Close();
        }
        Console.ReadLine();
    }
}

[Serializable]
internal class CountryTranslator:IDeserializationCallback
{
    public int Count { get; set; }

    public CountryTranslator(SortedList<string,string> sorted_list)
    {
        this.country_list = sorted_list;
        inner_translator = new List<string> {"one", "two"};
    }
    //[OptionalField]
    private List<string> inner_translator;
    public List<string> InnerTranslator
    {
        get { return inner_translator; }
        set { inner_translator = value; }
    }

    private SortedList<string, string> country_list;

    public void OnDeserialization(object sender)
    {
        Debug.Assert(inner_translator == null);
        Count=country_list.Count;
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-30T17:14:39.157

`BinaryFormatter`在*最好*的情况下，如果你改变一些东西，它就会变得非常脆弱。[尤其是，自动实现的属性、混淆](http://marcgravell.blogspot.com/2009/03/obfuscation-serialization-and.html)、重命名、强命名等存在巨大问题。

我记得，一些规则`[OptionalField]`在发布之前就发生了变化；我预计，版本容忍的事情并没有像计划的那样容易。

我的建议：如果你想要版本容忍的序列化（即你可以在今天序列化它并用你的应用程序的下一个版本反序列化它），那么不要使用`BinaryFormatter`; 这（IMO）仅适用于在**同一**版本（远程处理、`AppDomain`s 等）之间传递数据。

对于版本之间的工作，我推荐基于契约的序列化；`XmlSerializer`和（.NET 3.0）之类的东西`DataContractSerializer`，或二进制 - [protobuf-net](http://code.google.com/p/protobuf-net/)或类似工具。所有这些都在版本容错方面*要*好得多（实际上，您甚至不需要将其反序列化为相同的`Type`）；此外，它们可以在平台之间使用——因此您可以在 .NET 中序列化并在 java/C++/等中反序列化。

# java - 等效于 Java 中的 Python 的 lambda 函数？

> ID：929988
> 
> 赞同：22
> 
> 时间：2009-05-30T15:49:17.930
> 
> 标签：java, python, function, lambda

有人可以告诉我在 Java 中是否有 Python 的 lambda 函数的等价物？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-30T15:58:12.157

[不幸的是，在 Java 8 引入Lambda 表达式](https://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html)之前，Java 中没有 lambda 。但是，您可以使用匿名类获得*几乎*相同的效果（以一种非常丑陋的方式）：

```
interface MyLambda {
    void theFunc(); // here we define the interface for the function
}

public class Something {
    static void execute(MyLambda l) {
        l.theFunc(); // this class just wants to use the lambda for something
    }
}

public class Test {
    static void main(String[] args) {
        Something.execute(new MyLambda() { // here we create an anonymous class
            void theFunc() {               // implementing MyLambda
                System.out.println("Hello world!");
            }
        });
    }
} 
```

显然这些必须在单独的文件中:(

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-30T15:57:01.410

我不认为有一个确切的等价物，但是有一些匿名类是尽可能接近的。但还是很不一样。Joel Spolsky 写了一篇关于只教 Java 的学生如何错过函数式编程的这些美感的文章：[你的编程语言能做到这一点吗？](http://www.joelonsoftware.com/items/2006/08/01.html).

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-30T15:53:55.543

一个想法是基于一个通用的`public interface Lambda<T>`——参见[http://www.javalobby.org/java/forums/t75427.html](http://www.javalobby.org/java/forums/t75427.html)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-03-09T12:36:06.233

是的，

Lambda 表达式是从 java8 开始在 java 中引入的。

lambda 表达式的基本语法是：

```
(parameters)->
{
  statements;
} 
```

例子

```
(String s)->
{
System.out.println(s);
} 
```

检查此链接：

[http://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html](http://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-11-06T13:19:25.407

正如已经指出的，lambda 表达式是在 Java 8 中引入的。

如果您来自 python、C# 或 C++，请参阅 Adrian D. Finlay 的[优秀示例，我个人认为它比](https://medium.com/@afinlay/lambda-expressions-in-java-python-c-c-8cdbca5a5e8b)[官方文档](https://docs.oracle.com/javase/tutorial/java/javaOO/lambdaexpressions.html)更容易理解。

这是基于 Adrian 示例的快速浏览，该示例使用带有 python 内核和[IJava java 内核](https://github.com/SpencerPark/IJava)的 jupyter notebook 创建。

**Python：**

```
# lambda functions
add = lambda x, y : x + y
multiply = lambda x, y : x * y
# normal function. In python, this is also an object.
def add_and_print_inputs(x, y):
    print("add_and_print inputs : {} {}".format(x,y))
    return x + y
print(add(3,5), multiply(3,5), add_and_print_inputs(3,5)) 
```

输出：

```
add_and_print inputs : 3 5
8 15 8 
```

Java lambda 函数可以是多行的，而在 python 中它们是单个语句。但是，这里没有优势。在 python 中，常规函数也是对象。它们可以作为参数添加到任何其他函数。

```
# function that takes a normal or lambda function (myfunc) as a parameter
def double_result(x,y,myfunc):
    return myfunc(x,y) * 2
double_result(3,5,add_and_print_inputs) 
```

输出：

```
add_and_print inputs : 3 5
16 
```

**爪哇：**

```
// functional interface with one method
interface MathOp{
    int binaryMathOp(int x, int y);
}
// lambda functions
MathOp add = (int x, int y) -> x + y;
MathOp multiply = (int x, int y) -> x * y;
// multiline lambda function
MathOp add_and_print_inputs = (int x, int y) -> {
    System.out.println("inputs : " + x + " " + y);
    return x + y;};// <- don't forget the semicolon
// usage
System.out.print("" +
add.binaryMathOp(3,5) + " " +
multiply.binaryMathOp(3,5) + " " + 
add_and_print_inputs.binaryMathOp(3,5)) 
```

输出：

```
inputs : 3 5
8 15 8 
```

当用作参数时：

```
// function that takes a function as a parameter
int doubleResult(int x, int y, MathOp myfunc){
    return myfunc.binaryMathOp(x,y) * 2;
}
doubleResult(3,5,add_and_print_inputs) 
```

输出：

```
inputs : 3 5
16 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-06-16T01:52:18.143

有点类似于 Zifre 的，你可以这样创建一个界面

```
public interface myLambda<In, Out> {
    Out call(In i);
} 
```

让你写作，说

```
Function<MyObj, Boolean> func = new Function<MyObj, Boolean>() {
    public Boolean callFor(myObj obj) {
        return obj.canDoStuff();
    };

MyObj thing = getThing;

if (func.callFor(thing)) {
    doSomeStuff();
} else {
    doOtherStuff();
} 
```

它仍然有点笨拙，是的，但它至少有输入/输出。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-12-14T14:23:38.550

随着**Java 8**的发布，现在可以使用 lambda-expression。而java中的lambda函数实际上比python的“更强大”。

在 Python 中，lambda-expression 的主体可能只有一个表达式，并且`return`不允许使用任何语句。在 Java 中，您可以执行以下操作：`(int a, int b) -> { return a * b; };`以及其他可选操作。

Java 8 还引入了另一个接口，称为`Function Interface`. 您可能也想检查一下。

# php - 是否应该报告和修复 PHP 的“通知”？

> ID：929996
> 
> 赞同：11
> 
> 时间：2009-05-30T15:52:24.967
> 
> 标签：php

我最近切换到报告 PHP 通知的新设置；我的代码在没有修复这些通知的情况下运行良好，但我想知道是否有必要修复每个通知并报告它们，或者只是忽略它们并关闭通知报告。

对此有何不同看法？是否有与通知相关的最佳实践？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-30T16:03:12.923

错误就是错误。它们必须在您的代码工作之前修复。

警告就是警告。他们警告您，您正在做的事情可能是一个坏主意，即使它目前对您有效（或似乎有效）。所以它们也应该被修复。

通知是通知。他们应该被注意。由此得名。您的代码生成一些可能不是问题，但您应该根据具体情况检查和判断。

当然，如果您没有收到 400 个通知，则更容易注意到通知。因此，尝试消除它们有很大的好处。它使您尚未注意到的那些变得更加引人注目。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-30T15:56:57.663

是的，我会从我编写的任何 PHP 代码中删除通知，即使它只是在我调查完所有实例后关闭特定通知 ID。通知（即未定义的索引、已初始化的变量）通常表示您忘记预期的情况。你应该调查每一个，消除真正的问题，然后可能压制其他的（用评论说明原因）。

PHP 手册本身声明“注意消息会警告你不良风格”，所以我想官方的“最佳实践”几乎就是我所概述的。遵循良好的风格，除非你有正当的理由不这样做。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-30T15:57:56.463

这取决于哪些通知 - 大多数通知是不良代码气味的证据 - 未定义的数组索引等。如果您确实禁止通知，请在其旁边留下评论，说明您认为应该禁止通知的原因。

PHP.net 说：

> 注意：在开发过程中启用 E_NOTICE 有一些好处。出于调试目的： NOTICE 消息将警告您代码中可能存在的错误。例如，警告使用未分配的值。查找错别字并节省调试时间非常有用。NOTICE 消息会警告您不良风格。例如，$arr[item] 最好写成 $arr['item'] 因为 PHP 试图将“item”视为常量。如果它不是常量，PHP 假定它是数组的字符串索引。

我会将每个通知视为改进代码的免费机会。:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-30T15:56:44.200

它们被称为警告，因为您的程序仍然有效 - 但这意味着您做错了什么。如果您有时间，并且希望代码“干净”并且可能很好，请修复它们。如果您收到警告，您的代码就不好。

...和警告可能会导致错误：

如果您收到未定义变量警告，则表示您没有检查变量是否存在。如果在 MySQL 查询中使用这个变量会怎样？它会失败并破坏你的程序。

不要在实时网站上显示警告。他们将您的部分代码呈现给外部。

最好的方法是以避免警告的方式编写代码。;)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-14T08:41:16.620

尝试访问未定义的变量和未定义的索引之类的事情在每个认真的程序员的书中都是严重的错误，所以我真的不明白他们为什么选择它作为你可以注意到并耸耸肩走开的东西。我知道的所有其他编译器都会简单地在那个确切的位置中止程序。

我总是会修复它们，它们几乎总是导致更严重错误的原因。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-30T15:55:41.550

在生产环境中，您不应显示任何通知。

即使他们使您的应用程序崩溃。

这只是一个安全提示。

如果您从旧的 php 版本迁移到最近的版本，您至少应该看一下通知，以了解它是关于什么的。有时是关于安全性，有时只是通知您此功能已弃用。

您还应该注意这些通知，除非您真的知道自己在做什么。***`**