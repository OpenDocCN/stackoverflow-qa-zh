# StackOverflow 问答 000595000-000595999

# c# - 返回索引值 datetime.now.dayofweek 但如何？

> ID：595000
> 
> 赞同：0
> 
> 时间：2009-02-27T14:34:12.860
> 
> 标签：c#, .net, datetime

日期时间返回dayofweekindex有什么功能吗？如：
int Todaywhat_is_Index= = DateTime.Now.IndexOfDayofThisWeek；
如果今天是星期五，则必须返回 5 如果今天是
星期六，则必须返回 6如果今天
是星期日，则必须返回 0

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-27T14:51:30.510

这个小单线工作独立于语言环境，总是星期五 == 5

```
int x = (int)System.Globalization.CultureInfo
        .InvariantCulture.Calendar.GetDayOfWeek(DateTime.Now); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T14:37:10.593

是的，检查[DateTime.DayOfWeek](http://msdn.microsoft.com/en-us/library/system.datetime.dayofweek.aspx)。

请注意，这取决于区域设置（在欧洲，星期一是一周的第一天）。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-05-07T07:48:38.403

试试这个：

```
 int dayOfWeek;
 dayOfWeek = (int)System.DateTime.Now.DayOfWeek - (int)System.Globalization.CultureInfo.CurrentCulture.DateTimeFormat.FirstDayOfWeek + 1 
```

# bash - 如何在 BASH 脚本中的远程系统上执行命令？

> ID：595002
> 
> 赞同：5
> 
> 时间：2009-02-27T14:34:34.297
> 
> 标签：bash, unix, scripting, remote-execution

作为复杂 BASH 脚本的一部分，我想从脚本本身在远程系统上执行命令。

现在，我运行为远程系统定制文件并上传它们的脚本，然后通过 ssh 登录执行单个命令。

所以要满分：

*   如何从 bash 脚本登录到远程系统（即以非交互方式传递凭据）？
*   如何从脚本中执行命令（特别是“chmod 755 /go && /go”）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T14:40:25.593

按照[蒂姆·波斯特的回答](http://web.archive.org/web/20090331164913/http://sial.org/howto/openssh/publickey-auth/)：

设置公钥，然后您可以执行以下操作：

```
#!/bin/bash
ssh user@host "chmod 755 /go && /go" 
```

# ruby - ruby win32ole - 如何判断OLE类的类型，OLE类是否支持某个方法

> ID：595003
> 
> 赞同：4
> 
> 时间：2009-02-27T14:34:41.567
> 
> 标签：ruby, outlook, win32ole

我正在使用 Ruby 1.8。使用 WIN32OLE 模块 -

1) 如何确定 OLE 对象实例的类名？2) 如何判断对象实例是否支持特定方法？

在 Outlook 自动化脚本中，我试图删除“已删除项目”文件夹中超过 21 天的项目。对于邮件项目，我想使用 ReceivedTime 属性，但为了做到这一点，我需要检查该项目是否实际上是 MailItem 实例。

其次，我能想到的最好的方法是（真的很慢）：

```
def MethodExists(obj, methodName)
  obj.ole_methods.each{|method|
    if (method.name == methodName)
      return true
    end
  }
  return false
end 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T18:49:17.367

具体到 WIN32OLE 对象...

*如何确定 OLE 对象实例的类名？*

```
object.ole_obj_help.name 
```

*如何判断对象实例是否支持特定方法？*

```
object.ole_methods.collect!{ |x| x.to_s }.include?( 'MethodName' ) 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-02-27T15:59:28.757

1.  `obj.class`

2.  ：

    ```
    if obj.respond_to?(methodName)
        #do your work
    end 
    ```

# c# - 获取前 25 个字符的小方法

> ID：595004
> 
> 赞同：10
> 
> 时间：2009-02-27T14:34:47.197
> 
> 标签：c#, string

谁能想到更好的方法来执行以下操作：

```
public string ShortDescription
{
    get { return this.Description.Length <= 25 ? this.Description : this.Description.Substring(0, 25) + "..."; }
} 
```

我本来希望只做 string.Substring(0, 25) 但如果字符串小于提供的长度，它会引发异常。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-27T14:53:00.273

我经常需要这个，我为它写了一个扩展方法：

```
public static class StringExtensions
{
    public static string SafeSubstring(this string input, int startIndex, int length, string suffix)
    {
        // Todo: Check that startIndex + length does not cause an arithmetic overflow - not that this is likely, but still...
        if (input.Length >= (startIndex + length))
        {
            if (suffix == null) suffix = string.Empty;
            return input.Substring(startIndex, length) + suffix;
        }
        else
        {
            if (input.Length > startIndex)
            {
                return input.Substring(startIndex);
            }
            else
            {
                return string.Empty;
            }
        }
    }
} 
```

如果你只需要它一次，那就是大材小用了，但如果你更频繁地需要它，那么它就可以派上用场了。

*编辑：*添加了对字符串后缀的支持。传入 "..." 你会在较短的字符串上得到省略号，或者传入 string.Empty 以获得没有特殊后缀。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2009-02-27T14:38:38.263

```
return this.Description.Substring(0, Math.Min(this.Description.Length, 25)); 
```

没有那个`...`部分。实际上，您的方式可能是最好的。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-27T14:42:52.933

```
public static Take(this string s, int i)
{
    if(s.Length <= i)
        return s
    else
        return s.Substring(0, i) + "..."
}

public string ShortDescription
{
    get { return this.Description.Take(25); }
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-27T14:38:31.150

你这样做的方式对我来说似乎很好，除了我会使用幻数 25，我会把它作为一个常数。

你真的想把它存储在你的 bean 中吗？大概这是为了在某处显示，所以你的渲染器应该是做截断而不是数据对象的东西

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-27T15:30:47.373

好吧，我知道已经接受了答案，我可能会因为在这里抛出正则表达式而被钉死在十字架上，但这是我通常的做法：

```
//may return more than 25 characters depending on where in the string 25 characters is at
public string ShortDescription(string val)
{
    return Regex.Replace(val, @"(.{25})[^\s]*.*","$1...");
}
// stricter version that only returns 25 characters, plus 3 for ...
public string ShortDescriptionStrict(string val)
{
    return Regex.Replace(val, @"(.{25}).*","$1...");
} 
```

它的好处是不会将一个单词切成两半，因为它总是在第一个空格字符超过 25 个字符之后停止。（当然，如果您需要它来截断进入数据库的文本，那可能是个问题。

不利的一面，我敢肯定这不是最快的解决方案。

**编辑：**用“...”替换...，因为不确定此解决方案是否适用于网络！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-27T15:57:35.813

没有....这应该是最短的：

```
public string ShortDescription
{
    get { return Microsoft.VisualBasic.Left(this.Description;}
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-27T14:37:50.170

我认为这种方法是合理的，但我建议进行一些调整

*   将幻数移动到一个`const`或配置值
*   使用常规`if`条件而不是三元运算符
*   使用`string.Format("{0}...")`而不是`+ "..."`
*   函数只有一个返回点

所以：

```
public string ShortDescription
{
    get
    {
        const int SHORT_DESCRIPTION_LENGTH = 25;

        string _shortDescription = Description;

        if (Description.Length > SHORT_DESCRIPTION_LENGTH)
        {
            _shortDescription = string.Format("{0}...", Description.Substring(0, SHORT_DESCRIPTION_LENGTH));
        }

        return _shortDescription;
    }
} 
```

对于更通用的方法，您可能希望将逻辑移至扩展方法：

```
public static string ToTruncated(this string s, int truncateAt)
{
    string truncated = s;

    if (s.Length > truncateAt)
    {
        truncated = string.Format("{0}...", s.Substring(0, truncateAt));
    }

    return truncated;
} 
```

## 编辑

我广泛使用三元运算符，但如果代码变得足够冗长以至于开始超过 120 个字符左右，我更愿意避免使用它。在这种情况下，我想将它包装成多行，因此发现常规`if`条件更具可读性。

## 编辑2

为了印刷的正确性，您还可以考虑使用省略号字符 (...) 而不是三个点/句点/句号 (...)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-27T14:39:10.383

一种方法：

```
int length = Math.Min(Description.Length, 25);
return Description.Substring(0, length) + "..."; 
```

有两行而不是一行，但更短:)。

编辑：正如评论中所指出的，这让你一直......所以答案是错误的。纠正它意味着我们回到原来的解决方案。

在这一点上，我认为使用字符串扩展是缩短代码的唯一选择。只有当代码至少在几个地方重复时，这才有意义......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-27T14:39:41.117

对我来说看起来不错，真的很挑剔我会用实体引用替换“...”`"&hellip;"`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-27T14:47:24.657

我想不出，但你的方法可能不是最好的。您是否将表示逻辑添加到数据对象中？如果是这样，那么我建议您将该逻辑放在其他地方，例如带有 GetShortStringMethod(int maxCharsToDisplay, string stringToShorten) 的静态 StringDisplayUtils 类。

但是，这种方法也可能不是很好。不同的字体和字符集呢？您必须开始以像素为单位测量实际的字符串长度。查看 winform 的 Label 类上的 AutoEllipsis 属性（如果使用它，您可能需要将 AutoSize 设置为 false）。AutoEllipsis 属性为真时，将缩短字符串并为您添加“...”字符。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-27T15:02:37.693

我会坚持你所拥有的，但作​​为替代方案，如果你有 LINQ to objects，你可以

```
new string(this.Description.ToCharArray().Take(25).ToArray())

//And to maintain the ...
+ (this.Description.Length <= 25 ? String.Empty : "...") 
```

正如其他人所说，您可能希望将 25 存储在常量中

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-27T15:34:31.423

您应该查看是否可以将 Microsoft.VisualBasic DLL 引用到您的应用程序中，以便您可以使用“Left”功能。

# apache - 仅在找不到文件时才重定向请求？

> ID：595005
> 
> 赞同：21
> 
> 时间：2009-02-27T14:34:54.543
> 
> 标签：apache, .htaccess, mod-rewrite

我希望有一种方法可以使用 mod_rewrite 和 Apache 来做到这一点，但也许还有另一种方法可以考虑。

在我的网站上，我为客户的网站重新皮肤版本设置了目录。如果 Web 根目录是`/home/blah/www`，则客户端目录是`/home/blah/www/clients/abc`. 当您通过 Web 浏览器访问客户端目录时，我希望它使用客户端目录中的任何请求文件（如果存在）。否则，我希望它使用 Web 根目录中的文件。

例如，假设客户不需要自己的`index.html`. 因此，某些代码会确定没有`index.html`in `/home/blah/www/clients/abc`，而是使用 in 中的那个`/home/blah/www`。请记住，我不想在任何时候将客户端重定向到 Web 根目录，如果客户端目录没有指定其自己的副本，我只想使用具有该名称的 Web 根目录的文件。Web 浏览器仍应指向`/clients/abc`该文件是否存在于那里或根目录中。`news.html`同样，如果在客户端目录中有请求并且它*确实*存在，那么只需提供该文件而不是 web 根目录的`news.html`. 用户体验应该是无缝的。

我需要这个来处理任何文件名的请求。例如，如果我需要为`.htaccess`我可能想要重定向的每个文件添加一个新行，这反而会破坏目的，因为需要太多维护，并且考虑到大量文件，很有可能出错。

在您的示例中，请说明您的代码是在客户端目录中的 .htaccess 文件中，还是在 Web 根目录中。首选 Web 根目录。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-27T14:38:17.593

```
# If requested resource exists as a file or directory, skip next two rules
RewriteCond %{DOCUMENT_ROOT}/$1 -f [OR]
RewriteCond %{DOCUMENT_ROOT}/$1 -d
RewriteRule (.*) - [S=2]
#
# Requested resource does not exist, do rewrite if it exists in /archive
RewriteCond %{DOCUMENT_ROOT}/archive/$1 -f [OR]
RewriteCond %{DOCUMENT_ROOT}/archive/$1 -d
RewriteRule (.*) /archive/$1 [L]
#
# Else rewrite requests for non-existent resources to /index.php
RewriteRule (.*) /index.php?q=$1 [L] 
```

[如果文件不存在，则从](http://www.webmasterworld.com/apache/3635920.htm)重写

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-03T21:36:08.533

这个怎么样？

```
# If requested resource exists as a file or directory go to it
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule (.*) - [L]

# Else rewrite requests for non-existent resources to /index.php
RewriteRule (.*) /index.php?q=$1 [L] 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-03-03T14:29:57.177

我似乎对上面的每个例子都至少有一个问题。`%{DOCUMENT_ROOT}`似乎在某些地方做错了事，一些`/`字符似乎丢失了。这是我的解决方案，`.htaccess`位于 web 根目录中。

我不需要使用两条规则（一条用于找到 clients/ 下的文件，另一条用于未找到），我只需要检查请求的文件（或目录）是否不存在。因为如果存在，则无需更改，只需使用客户端目录中提供的文件即可。这是我确定的代码：

```
RewriteEngine on
RewriteCond %{DOCUMENT_ROOT}/clients/$1/$2 !-f
RewriteCond %{DOCUMENT_ROOT}/clients/$1/$2 !-d
RewriteRule ^clients/([^/]+)/(.*)$ $2 [L] 
```

谢谢你的帮助！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-27T14:37:57.720

```
RewriteCond %{REQUEST_FILENAME} !-f 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T14:43:25.303

试试这个：

```
RewriteEngine on
RewriteRule ^clients/abc/ - [L]
RewriteCond %{DOCUMENT_ROOT}clients/abc/$0 -f
RewriteRule .* clients/abc/$0 [L] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T14:54:49.350

我认为您想要以下方面的内容：

```
RewriteEngine on
RewriteCond %{DOCUMENT_ROOT}clients/$1/$2 -f
RewriteRule ^clients/([^/]+)/(.*)$ %{DOCUMENT_ROOT}clients/$1/$2 [L]
RewriteRule ^clients/([^/]+)/(.*)$ %{DOCUMENT_ROOT}$2 [L] 
```

# django - 是否可以使用一个 IP 地址（和不同的端口）在同一台机器上运行 Apache 和 IIS？

> ID：595007
> 
> 赞同：3
> 
> 时间：2009-02-27T14:35:01.610
> 
> 标签：django, apache, iis-6

“主要”应该是 IIS。是否有一个选项可以在不输入端口号的情况下解决 Apache 原因是：我无法让 Django 在 IIS 上工作 任何想法都将不胜感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T14:36:53.590

您可以在不同的端口上设置 Apache，然后在 IIS 上使用重定向或代理让人们无需键入即可访问 Apache 端口。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T14:44:51.167

避免输入端口号的唯一方法是设置一个代理，它可以是两个网络服务器之一。这样，代理在备用端口上建立连接，客户端不必知道它在哪里。

我不了解 IIS，但在 Apache 上，您必须加载 mod_proxy（我认为是 mod_proxy_http），然后执行以下操作：

```
ProxyRequests Off

<Proxy *>
  Order deny,allow
  Allow from all
</Proxy>

ProxyPass /foo http://foo.example.com/bar
ProxyPassReverse /foo http://foo.example.com/bar 
```

还要[在线查看 mod_proxy 的文档](http://httpd.apache.org/docs/2.0/mod/mod_proxy.html)。

如果您要运行两个，您可能还想查看诸如[lighttpd之类的轻量级网络服务器。](http://www.lighttpd.net/)使用轻型网络服务器将特定任务从主要网络服务器中移除是一种常见的设置。（用于动态内容的 Apache 和用于静态内容的 lighttpd 就是一个典型示例）。

还有其他可能性，从变得更加花哨，例如

*   让第三个网络服务器只做代理，另外两个在备用端口上
*   让它们在同一个端口上运行，但有两个 IP，并通过您的网络设置隐藏这一事实

攻击根本原因

*   找到知道如何让 Django 在 IIS 上运行的人
*   从 IIS 移动到另一个网络服务器

当然，我不知道什么可能适合您的情况。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T15:41:27.880

如果这是在已经需要 IIS 的服务器上运行 Django 的问题，您可以直接在 IIS 上运行 django，这要归功于[Django-IIS](http://code.google.com/p/django-iis/)和[PyISAPIe](http://code.djangoproject.com/wiki/DjangoOnWindowsWithIISAndSQLServer)之类的努力。我认为最好不要运行第二个 Web 服务器，因为它所做的只是将请求代理到第三个服务器，即 Django 代码。

# django - 在视图中向模型表单的多对多字段添加数据

> ID：595009
> 
> 赞同：1
> 
> 时间：2009-02-27T14:36:32.637
> 
> 标签：django, django-forms

```
class Person(models.Model):
    name = models.CharField(max_length=100)

class Entry(models.Model):
    text = models.CharField(max_length=100)
    person = models.ManyToManyField(Person, blank=True, null=True)

class MyModelForm(forms.ModelForm):
    class Meta:
        model = Entry 
```

在我看来，我需要在保存之前将 pk id 添加到提交的表单中。

```
data = request.POST.copy()
# 'person' is a ManyToManyField to a 'Person' model
# a form would normally send multiple id's as POST in this format -> u'id': [u'1', u'2']
# u'1,2' (an example) is a str variable accessible to the view
data[u'person'] = u'1,2'.split(",") 
form = MyModelForm(data)
if form.is_valid():
    form.save() 
```

这给了我：

> int() 参数必须是字符串或数字，而不是“列表”

这很公平。在以下情况下它确实有效：

```
data[u'person'] = u'1' 
```

我也试过这个没有成功：

```
new_form = form.save(commit=False)
new_form.person = u'1,2'.split(",")
new_form.save()
form.save_m2m() 
```

**如何将多个 id 保存到这个 ManyToManyField？**
一定很容易，但我没有抓住重点。

* * *

编辑：期望的结果是 MyModelForm 的一个新实例（在“entry”表中），其中所有 id 都存储为 form.person（“entry_person”表中的多个记录）。

* * *

**更新：** 我似乎已经隔离了这个问题。

如果我做：

```
data = {}  
data[u'person'] = u'1,2'.split(",") 
```

它**确实有效**，结果是：

```
{u'person': [u'1', u'2'],} 
```

如果我做：

```
data = request.POST.copy()  
data[u'person'] = u'1,2'.split(",") 
```

它**不起作用**（给出上述错误），因为结果是：

```
<QueryDict: {u'person': [[u'1', u'2']],}> 
```

所以我只需要拥有

```
<QueryDict: {u'person': [u'1', u'2'],}> 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-06T13:03:04.490

[QueryDict.setlist(key, list_)](http://docs.djangoproject.com/en/dev/ref/request-response/#django.http.QueryDict.setlist)解决了这个问题。

[在Django QueryDict 将值包装在列表](https://stackoverflow.com/questions/618699/a-workaround-for-django-querydict-wrapping-values-in-lists)中的解决方法中回答？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T15:08:35.650

您输入的拆分返回以下内容：

```
[u'1', u'2'] 
```

要在数据库中创建多个实例，您需要遍历列表：

```
for x in u'1,2'.split(","):
  data[u'person'] = x
  form = MyModelForm(data)
  if form.is_valid():
    form.save() 
```

出于好奇，为什么首先要进行字符串到列表的转换？或者这只是一个一般的例子

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T18:24:33.760

尝试：

```
new_form.person = [int(x) for x in u'1,2'.split(",")] 
```

这会将 new_form.person 设置为整数列表，而不是字符串列表。

# algorithm - 寻求算法来反转（反转？镜像？从里到外）一个 DAG

> ID：595029
> 
> 赞同：11
> 
> 时间：2009-02-27T14:39:54.110
> 
> 标签：algorithm, graph-theory, directed-acyclic-graphs

我正在寻找一种算法来“反转”（反转？从里到外？）一个 DAG：

```
 A*      # I can't ascii-art the arrows, so just
      / \      # pretend the slashes are all pointing
     B   C     # "down" (south-east or south-west)
    /   / \    # e.g. 
   G   E   D   # A -> (B -> G, C -> (E -> F, D -> F))
        \ /
         F 
```

我使用的表示是不可变的，真正的 DAG（没有“父”指针）。我想以某种方式遍历图形，同时构建具有等效节点的“镜像”图形，但节点之间的关系方向倒置。

```
 F*
        / \
   G*  E   D   # F -> (E -> C -> A, D -> C -> A), G -> B -> A
    \   \ /    # 
     B   C     # Again, arrows point "down"
      \ /      # 
       A       # 
```

所以输入是一组“根”（这里是{A}）。输出应该是结果图中的一组“根”：{G, F}。（根是指没有传入引用的节点。叶子是没有传出引用的节点。）

输入的根变成输出的叶子，反之亦然。变换应该是自身的逆。

（出于好奇，我想向我用来表示 XML 以进行结构查询的库添加一个功能，通过它我可以将第一棵树中的每个节点映射到第二棵树中的“镜像”（然后返回再次）为我的查询规则提供更多的导航灵活性。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-28T15:11:14.027

遍历图，构建一组反向边和一个叶节点列表。

使用叶子（现在是根）节点对反向边执行拓扑排序。

根据从排序列表末尾开始的反向边构造反向图。由于节点是以反向拓扑顺序构造的，因此可以保证在构造节点之前已经构造了给定节点的子节点，因此可以创建不可变的表示。

如果您使用结构作为中间表示来跟踪与节点关联的两个方向上的所有链接，则这是 O(N)，如果您使用排序来查找节点的所有链接，则为 O(NlnN)。对于小型图或不受堆栈溢出影响的语言，您可以懒惰地构造图，而不是显式地执行拓扑排序。因此，这在一定程度上取决于您要实现的所有内容，这将有多大不同。

```
A -> (B -> G, C -> (E -> F, D -> F))

original roots: [ A ]
original links: [ AB, BG, AC, CE, EF, CD, DF ] 
reversed links: [ BA, GB, CA, EC, FE, DC, FD ]
reversed roots: [ G, F ]
reversed links: [ BA, CA, DC, EC, FE, FD, GB ] (in order of source)
topologically sorted: [ G, B, F, E, D, C, A ]
construction order : A, C->A, D->C, E->C, F->(D,E), B->A, G->B 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T14:46:28.353

只需在您已经去过的地方进行深度优先搜索标记，每次遍历箭头时，将反向添加到结果 DAG 中。添加叶子作为根。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T14:47:35.403

我的直观建议是对图执行深度优先遍历，并同时构建镜像图。

在遍历每个节点时，在镜像图中创建一个新节点，并在新图中在它与其前身之间创建一条边。

如果您在任何时候到达没有子节点的节点，请将其标记为根。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-12T19:39:23.863

我通过一个简单的图遍历解决了这个问题。请记住，拓扑排序仅对有向无环图有用。

我使用了邻接列表，但您可以使用邻接矩阵做类似的事情。

在 Python 中，它看起来像这样：

```
# Basic Graph Structure
g = {}
g[vertex] = [v1, v2, v3] # Each vertex contains a lists of its edges 
```

要找到 v 的所有边，然后遍历列表 g[v]，这将为您提供所有 (v, u) 边。

要构建反转图，请创建一个新字典并构建它，如下所示：

```
 reversed = {}
    for v in g:
        for e in g[v]:
            if e not in reversed:
                reversed[e] = []
            reversed[e].append(v) 
```

这对于大型图形来说非常占用内存（使您的内存使用量翻倍），但这是一种非常简单的使用它们的方法并且非常快。可能有更聪明的解决方案，包括构建一个生成器和使用某种 dfs 算法，但我没有考虑太多。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-27T14:44:32.400

[深度优先搜索](http://en.wikipedia.org/wiki/Depth-first_search)可能能够生成您所追求的：注意您通过树的路径，并且每次遍历时将反向添加到生成的 DAG（叶子是根）。

# php - 使用 sql 连接

> ID：595045
> 
> 赞同：0
> 
> 时间：2009-02-27T14:43:29.797
> 
> 标签：php, sql, join

我是一个 sql 菜鸟，试图让这个查询使用 2 个表。

表格和列是：

人：department_id、姓名等...

部门：department_id、dept_name 等...

我有一个“选择”html 表单，用户将从中选择一个部门名称，我需要我的 php 脚本来返回每个人都具有匹配的部门 ID。到目前为止，这是我的代码和查询，我会寻求任何帮助。

```
 $search_dept = $_POST['search_dept'];

$conn = odbc_connect($odbc_name, $user_name, $pass_wd);

if ($conn) {
    $query = "SELECT person.* 
                  FROM department 
                  JOIN person 
                  ON department.department_id=person.department_id 
                  WHERE department.name=$search_dept";

    if($result = odbc_exec($conn, $query)) {

        echo '..stuff';
        while ($row = odbc_fetch_array($result)) {
            ...echo stuff
        }
        echo '...stuff';
    }

    else {
        echo 'Query was unsuccessful';
    }
}

else {
    echo 'Unable to connect to database';
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T14:54:45.543

首先，您以错误的方式进行此操作。如果可以避免，您不想对文本类型列执行 WHERE 子句。由于您的 person 表已经将 department_id 作为外键，因此您将希望使用该值来进行选择。这意味着您必须修改您的选择元素以包含部门 ID 作为选项的值。

```
<!-- Example -->
<select name="dept_id">
    <option value="1">Sales</option>
    <option value="2">Support</option>
    <option value="3">Fulfillment</option>
</select> 
```

所以现在，不仅原始选择会发生得更快，因为您将针对索引列执行（您确实将其设置为适当的 FK，因此它已被索引，对吧？），而且您还将完全删除连接！（这是查询速度的另一个提升）

```
// Here is injection-safe code for the ODBC driver
$stmt = odbc_prepare( "SELECT * FROM person WHERE department_id = ?" );
$success = odbc_execute( $stmt, array( $_POST['dept_id'] ) );

// Here is the old, non-secure version, but is db-driver agnostic
$deptId = $_POST['dept_id']; // escape this please!
$query = "SELECT * FROM person WHERE department_id = $deptId"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T14:47:23.330

试试这个查询，还要确保转义任何用户输入。如果用户提供：

```
$_POST['search_dept']= "'; DROP TABLE person;"; 
```

永远不要推用户输入！

```
$search_dept = mysql_escape_string($_POST['search_dept']); //make sure to escape this! you can use other functions for this as well. I'm not sure if PDO has some.
$query = "SELECT * 
              FROM person 
              JOIN department 
              ON department.department_id=person.department_id 
              WHERE department.name='$search_dept'"; 
```

# gcc - 为 i386 构建 crti.o

> ID：595049
> 
> 赞同：0
> 
> 时间：2009-02-27T14:45:00.603
> 
> 标签：gcc, x86-64, glibc, 32-bit

我正在尝试构建一个交叉编译器，其中 x86_64 为主机，i386 为目标。我得到了（所有常见的）crti.o：没有这样的文件错误。而不是从发行版中获取已经构建的 crti.o 和 crtn.o ......我该如何从 glibc（或可能的 gcc）源中显式构建这些文件？

仅供参考，我很清楚 x86_64 编译器的 -m32 选项。我宁愿只有一个 32 位的编译器环境。另外，我不想使用任何已经构建的 i386 编译器的原因是因为我计划根据我的测试需要混合和匹配 glibc/binutils/gcc 版本。

谢谢，陈兹

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T14:51:34.007

这是一种可能性（从[这里](http://webui.sourcelabs.com/gcc/mail/user/threads/libgcc_4.3.0_fails_to_build%253A_crti.o%253A_No_such_file.meta)）

> 您需要安装发行版的 32 位 libc-dev 软件包，或者您需要 --disable-multilib 这将导致编译器不支持 32 位模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T22:59:15.847

您确定您正在正确使用配置交叉编译吗？它应该是

```
CBUILD = CHOST = x86_64-pc-linux-gnu
CTARGET = i386-pc-linux-gnu
```

当您在 上运行构建时`x86_64`，编译器在 上运行`x86_64`，它为`i386`.

如果您使用`CHOST = i386-pc-linux-gnu`，您将尝试生成 32 位二进制文​​件，该二进制文件需要与 32 位`libc`. 这很好，如果你已经有 32-bit `libc`，但听起来你没有。

IE

```
$ tar xvjf gcc-*.tar.bz2
$ cd gcc-*/
$ mkdir 构建
$ cd 构建
$ ../configure --build=x86_64-pc-linux-gnu --host=x86_64-pc-linux-gnu --target=i386-pc-linux-gnu
```

# web-applications - Facebook 应用程序，Iframe 担心（URL 问题）

> ID：595059
> 
> 赞同：6
> 
> 时间：2009-02-27T14:48:01.783
> 
> 标签：web-applications, iframe, facebook

我正在 facebook 上制作一个应用程序，并选择了 iframe 而不是 FBML。我面临的问题是链接到应用程序的其他各个页面。假设我在这里托管了我的应用程序[http://fbapp.mysite.com](http://fbapp.mysite.com)并且我想链接[http://fbapp.mysite.com/page1](http://fbapp.mysite.com/page1)，我应该如何在 iframe 中执行此操作？直接链接到 fbapp.mysite.com/page1 只是将整个浏览器窗口从 facebook.com 重定向到 fbapp.mysite.com。我仍然希望应用程序在画布页面内非常“活跃”，但想要导航到 page1。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-28T17:02:39.890

代替

```
<a href="http://fbapp.mysite.com/page1">link</a> 
```

采用

```
<a href="http://apps.facebook.com/{canvasurl}/page1" target="_top">link</a> 
```

这将在最顶层的框架（Facebook 本身）中加载 URL，并且 Facebook 会自动将任何参数（路径和查询字符串）传递给您的回调 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-09T11:42:45.660

```
 FB_RequireFeatures(["CanvasUtil"], function() { 
    FB.Facebook.init(<api_key>, <path to xd_receiver>);
    FB.CanvasClient.startTimerToSizeToContent();
    FB.CanvasClient.syncUrl(); 
}); 
```

# svn - svn 存储库路径已更改：如何将我的本地文件夹重新绑定到它？

> ID：595060
> 
> 赞同：3
> 
> 时间：2009-02-27T14:48:13.797
> 
> 标签：svn

我有一个显示为 e:/svn/repository 的存储库，它被检出到本地文件夹 c:/work 现在存储库路径更改为 f:/general/svn/repository 要使用什么 svn 命令以用于 c :/work 绑定到新的存储库路径？我不想删除 c:/work 并重新签出，因为 c:/work 包含很多我想保留的未版本化临时文件

我已经尝试将 f:/general/svn/repository 结帐到 c:/work，svn 给出错误：c:/work 已经是不同 url 的工作副本

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T14:54:31.660

```
cd c:\work
svn switch --relocate file:///E:/svn/repository file:///F:/general/svn/repository 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T14:52:35.983

你想要命令。[`svn switch`](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.switch.html)`--relocate`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T14:51:33.490

看起来你正在使用 TortoiseSVN，在这种情况下你会选择“重新定位”并输入新地址。

# c++ - C++ 的网络框架（UDP 或 TCP）？

> ID：595062
> 
> 赞同：7
> 
> 时间：2009-02-27T14:48:38.350
> 
> 标签：c++, c, network-programming, sdl

[我正在使用SDL](http://www.libsdl.org/)和[OpenGL](http://www.opengl.org/)编写一个线程化的跨平台应用程序（Linux/Windows），并且为了进行网络，我正在考虑[使用 SDL Net2](http://gameprogrammer.com/net2/net2-1.html)，因为它位于 SDL_Net 之上。

但是，我以前从未使用 C/C++ 进行过网络，因此我对任何可用的跨平台技术都不熟悉。有没有使用 SDL_Net 或 Net2 经验的人会建议使用不同的库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T14:54:38.630

boost::asio 是你的朋友。它是跨平台异步 io 库。适合网络。在 boost 网站上有很多样本。 [http://www.boost.org/](http://www.boost.org/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T14:54:54.340

也许试试[Boost.Asio 。](http://www.boost.org/doc/libs/1_38_0/doc/html/boost_asio.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T17:04:58.600

那里有很多框架（例如[Poco](http://pocoproject.org/)、[ACE](http://www.cs.wustl.edu/~schmidt/ACE.html)）。这取决于你在寻找什么。如果您想在操作系统层创建原始套接字并通过它们发送字节流，那么我会按照其他人的建议使用[Boost.Asio 。](http://www.boost.org/doc/libs/1_38_0/doc/html/boost_asio/overview.html)如果您正在寻找通过 HTTP 或类似方式发送 XML 文档，那么请研究其他一些替代方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T17:37:38.427

正如其他人已经说过的那样，**boost::asio**肯定是不错的选择。

话虽如此，这确实是为了建立“原始”网络。

**如果您正在制作视频游戏或类似网络性能的视频游戏软件**，那么可能针对此案例库进行更高级别和优化的案例库（例如强烈推荐的**[RakNet](http://www.jenkinssoftware.com/)**库）将是更好的选择。在这种情况下的另一种选择，如果您想要较低级别的基于 UDP 的库，**[ENet](http://enet.bespin.org/)**可能会满足您的需求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-19T13:26:25.887

Boost.Asio ( [http://boost.org](http://boost.org) ) 或尝试这个基于 Asio 的[http://libunicomm.org 。](http://libunicomm.org)

# visual-studio-2005 - FxCop 不解析外部引用

> ID：595066
> 
> 赞同：2
> 
> 时间：2009-02-27T14:48:51.407
> 
> 标签：visual-studio-2005, fxcop

也许不是一个完全成熟的编程问题，但为了帮助提高质量并在我正在开发的整个应用程序中执行一些标准，我想使用 FxCop。

如果我尝试使用命令行作为外部工具集成到 Visual Studio 2005

/c /f:"$(TargetPath)" /r:"C:\Program Files\Microsoft FxCop 1.36\Rules" /consolexsl:"C:\Program Files\Microsoft FxCop 1.36\Xml\VSConsoleOutput.xsl"

运行该工具时，它无法解析我的资源层中的 Web.Servies.2.dll。

我还有一个引用我的 ResourceLayer 的业务层，它也无法解决（即在业务层上运行 FxCop 会导致错误说 ResourceLayer.dll 无法引用）

如果我独立运行 FxCop，它就没有问题。

有没有其他人设法解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-02T12:28:48.457

我设法解决了这个问题。

通过将命令行设置为

```
/c /f:"$(TargetPath)" /r:"C:\Program Files\Microsoft FxCop 1.36\Rules" /consolexsl:"C:\Program Files\Microsoft FxCop 1.36\Xml\VSConsoleOutput.xsl" /directory:"C:\svn\projectDir\ExternalDLLs" 
```

其中 C:\svn\projectDir\ExternalDLLs 是应用程序所需的所有外部 Dll 的集合。

# sql - ORA-01830: 日期格式图片在转换整个输入字符串之前结束

> ID：595072
> 
> 赞同：-4
> 
> 时间：2009-02-27T14:50:06.303
> 
> 标签：sql, oracle, ora-01830

SQL 在大多数安装中都能正常工作。但是，我在加拿大安装 Oracle 时遇到问题（可能是日期本地化问题？）。

[http://www.google.com/search?q=ORA-01830](http://www.google.com/search?q=ORA-01830)

我正在将数据提供给生成 SQL 的专有处理器。我只提供数据。我希望获得可以帮助我解决问题的信息，而无需处理器的支持。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-27T17:37:55.447

不要依赖隐式日期转换。

代码如：

```
MY_TABLE.MY_DATE_COLUMN >= '03/07/2008' 
```

是不好的做法。使用任一：

```
MY_TABLE.MY_DATE_COLUMN >= to_date('03/07/2008','mm/dd/yyyy') 
```

或者

```
MY_TABLE.MY_DATE_COLUMN >= date '2008-03-07' 
```

# svn - SVN 可以处理区分大小写的问题吗？

> ID：595081
> 
> 赞同：11
> 
> 时间：2009-02-27T14:52:26.000
> 
> 标签：svn, case-insensitive

有没有办法强制 SVN 不区分大小写？我们遇到了一个问题，用户从 linux 环境提交文件说“file.ext”和“File.ext”。工作得很好。然而，问题在于 MAC OSX 或 Windows 上的用户尝试更新/签出。这两个文件被认为是相同的，并且操作错误地失败。

有没有办法让SVN首先阻止提交“File.ext”和“file.ext”？

[这个问题](https://stackoverflow.com/questions/14582/can-i-make-subversion-tortoisesvn-case-insensitive-for-windows)是相似的，但从 Windows 方面来看同样的问题，这不是这里的问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-27T15:17:44.240

您可以尝试一个预提交挂钩，例如[这个](http://svn.apache.org/repos/asf/subversion/trunk/contrib/hook-scripts/case-insensitive.py)（但是我自己没有尝试过）。

我假设已经排除了让您的用户注意它的可能性？我一直在 Linux 上工作，但通常认为文件名不区分大小写，即对*我来说*，无论操作系统如何想，它们都是相同的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-10-18T02:59:35.173

Subversion 1.7 现在似乎可以处理Windows 上的[仅大小写重命名](http://subversion.apache.org/docs/release-notes/1.7.html#windows-case-chang)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T15:16:34.290

我会说你正在以错误的方式看待事物。这里最好的解决方案是将文件维护为区分大小写的方式。如果用户在 Linux 或 Solaris 中签出，项目将无法使用。

此外，考虑一些依赖于区分大小写的语言编译器，Java 编译器会抱怨文件名，我相信其他语言也会如此。

另一个问题是部署，如果您在 *NIX 系统上部署会怎样。那你就麻烦了！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T18:59:09.027

我认为技术问题确实出在 Mac 和 Windows 方面，即它们的文件系统不区分大小写。至少在 mac 上，您可以将文件系统重新格式化为 HFS+ 并打开区分大小写。我不是 Windows 用户，但 Windows 的本机文件系统中可能有类似的选项（它仍然是 NTFS 吗？）。

如果您没有足够控制开发人员的环境以强制他们使用区分大小写的文件系统进行格式化，那么我认为您唯一的选择是一个预提交挂钩，用于检查重复（显然是不区分大小写的比较）文件名同一目录*或*修改您的项目以不使用同一目录中具有相同名称和不同大小写的文件。

# git - 我可以在没有 git 的情况下下载 git 存储库吗？

> ID：595088
> 
> 赞同：16
> 
> 时间：2009-02-27T14:53:37.823
> 
> 标签：git

我在网上的 git 存储库中保存了很多东西。问题是我经常发现自己在没有 git 的机器上，而且我也没有 root 访问权限。我不一定需要将更改提交回 repo，只需获取 git 项目的当前 master。

有没有办法在没有 git 的情况下下载 git repo？理想的解决方案是某种可移植的 shell 脚本。

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-27T15:10:33.257

在带有 git 存储库的服务器上，创建一个用于导出和压缩代码的 shell 脚本，然后从其他机器下载该 zip。

例如：

```
cd /pub/git/project.git
git archive --format=zip --prefix=project/ HEAD > /home/project/public_html/downloads/project-dev.zip 
```

此外，要使其按需生成 HEAD，请使用服务器端脚本执行 shell 脚本并提供 zip 文件以供下载。

这是执行此操作的基本 CFML 脚本 - 但它显然可以用任何服务器端语言编写。

```
<cfset OutputFilename = "#ProjectName#-dev.zip"/>
<cfexecute name="/home/project/latest.sh"/>
<cfheader name="Content-Disposition" value="inline; filename=#OutputFilename#"/>
<cfcontent file="./#OutputFilename#" reset type="application/zip"/><cfsetting showdebugoutput="false"/><cfabort/> 
```

**编辑**： git 的**[cgit](http://hjemli.net/git/cgit/)** web 界面支持这个开箱即用。查看任何提交，您可以下载 .zip、.tar.gz 或 .tar.bz2

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-27T15:48:18.067

如果您对 git 存储库所在的计算机具有 ssh 访问权限，则可以只 scp(1) 将 git 存储库连接到本地计算机。当你想合并历史时，你可以 scp 新的 repo 回来并合并。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-27T15:00:20.630

您可以在托管这些存储库的计算机上添加基于 Web 的 Git 浏览器吗？像[Gitweb](http://git.or.cz/gitwiki/Gitweb)或类似的东西？

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-27T15:15:20.127

听起来您正在寻找的东西可以让您拥有一个带有实际 git 存储库远程的本地工作目录。

由于这有点违背始终将整个存储库历史记录在本地的 git 哲学，我怀疑你会找到任何东西。您最好的选择可能是通过典型的文件复制方法（ftp tarball 或其他）从另一个 git 工作目录复制源代码。

编辑：OOC，git 客户端是否真的*需要*管理员权限才能安装以供个人使用？我知道需要管理员来安装其中一台 git 服务器，但是客户端应该可以只使用用户访问权限。尝试仅安装（或从源代码编译）客户端。

# c# - Windows 服务的设计模式 - C#

> ID：595089
> 
> 赞同：3
> 
> 时间：2009-02-27T14:54:07.820
> 
> 标签：c#

我开始涉足编程，而我的自学让我想到了这个问题。我一直在阅读有关设计模式的内容，并想知道对此有什么好的建议。

我的测试应用程序向 MSMQ 发送一条消息。我想编写一个 Windows 服务来监听这个 MSMQ，并且对于它收到的每条消息，我希望它执行一个简单的数据库插入。

我看了这篇文章的[链接文字](https://stackoverflow.com/questions/576303/message-queue-windows-service)

这给了我一些我需要的信息。在示例中，我可以在其中完成大部分工作

```
 private static void MyReceiveCompleted(Object source, 
        ReceiveCompletedEventArgs asyncResult)
    {
        // Connect to the queue.
        MessageQueue mq = (MessageQueue)source;

        // End the asynchronous Receive operation.
        Message m = mq.EndReceive(asyncResult.AsyncResult);

        // Display message information on the screen.
        Console.WriteLine("Message: " + (string)m.Body);

        // Restart the asynchronous Receive operation.
        mq.BeginReceive();

        return; 
    } 
```

但是有没有一种更可行的特定模式？通过阅读，我认为它可能是“命令”模式，但我不确定这是否是最好的模式。任何有助于我更好地理解模式的想法或想法。

我读过的关于模式的书籍：Head First Design patterns - 我知道对此有不同的评论，由四个人订购了一份使用过的设计模式副本（sp？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-24T14:58:08.023

这与您的问题没有直接关系，但开发任何类型的服务（Web 服务、Windows 服务等）的关键设计模式是将您的功能与服务主机分开。

也就是说，有一个实际执行工作的类。并有一个调用类的服务。

通过这种方式，您可以轻松地在多个主机中重新托管服务，并且可以通过控制台应用程序、winforms 应用程序或单元测试轻松地测试功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T15:10:00.297

如果您可以在系统中使用 WCF，请查看 netMsmqBinding 或 msmqIntegrationBinding。它实际上并不难设置，那里有很多教程。

使用 WCF，您不必处理任何 System.Messaging 内容。

在我的公司，我们在 Windows 服务中托管了很多 MSMQ 服务。查看 WCF 中的 ServiceHost 类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T15:03:37.800

在处理来自队列的消息时，我喜欢使用[Message Dispatcher](http://www.eaipatterns.com/MessageDispatcher.html)。

# wcf - IIS 堆栈溢出

> ID：595098
> 
> 赞同：2
> 
> 时间：2009-02-27T14:55:14.653
> 
> 标签：wcf, iis, stack-overflow

我们一直在寻找我的 WCF Web 应用程序 (W2K3 IIS) 上的一个错误，该错误导致了 stackoverflow。

为了解决这个问题，我需要通过创建一个具有我想要分配的内存量的线程来增加我的应用程序的堆栈。

但是子线程会发生什么？我的应用程序创建了许多线程，它们会继承该值还是我必须为每个线程设置新值？

编辑：如果我将（WCF）服务作为控制台主机运行，它们就可以正常工作。此外，如果我修改 w3wp.exe 的堆栈（使用 EDITBIN），它们在 IIS 上也可以正常工作。
所以我需要增加堆栈。我知道我可以创建一个具有堆栈大小的线程（还有其他方法吗？）但我需要知道子线程会发生什么。

Edit2：我们需要定义一些导致堆栈溢出的大向量。所以这不是我们系统中的错误。我真的需要（必须）增加堆栈

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-03T02:43:39.167

亲自尝试后，我可以说是！子线程保持父线程上设置的堆栈数量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T15:31:58.463

听起来您需要更仔细地考虑*为什么*会出现堆栈溢出，而不是仅仅分配更多内存。

是否有一些带有大量局部变量的函数或堆栈中的数组？

你确定你没有在无意中递归循环的地方泄漏吗？

-亚当

# ruby-on-rails - 工厂女孩中非活动记录关联的问题

> ID：595103
> 
> 赞同：2
> 
> 时间：2009-02-27T14:57:20.060
> 
> 标签：ruby-on-rails, ruby, factory, factory-bot

我刚开始在测试时使用工厂女孩来更换夹具。我正在开发一个 twitter 客户端，我正在尝试使用 factory girl 创建用于测试的 twitter 对象。当我单独创建它们时，这很好。但是，如果我尝试将它们关联起来，我会收到以下错误。

```
Factory.define :status, :class => Twitter::Status, :default_strategy => :build do |t|
  t.text 'Test Twitter Status message'
  t.association :user, :factory => :twitter_user #this line causes the problems
end

Factory.define :twitter_user, :class => Twitter::User, :default_strategy => :stub do |u|
  u.profile_image_url "#{RAILS_ROOT}/public/images/rails.png"
end 
```

导致问题的`t.association :user, :factory => :twitter_user`原因是当它存在时会引发此异常。有没有什么办法解决这一问题？还是工厂女孩只是为 activerecord 对象设计的？谢谢

```
 NoMethodError: undefined method `save!' for #<Twitter::User:0x4af3de46>
  /usr/local/share/jruby-1.1.6/lib/ruby/gems/1.8/gems/thoughtbot-factory_girl-1.2.0/lib/factory_girl/proxy/create.rb:5:in `result'
/usr/local/share/jruby-1.1.6/lib/ruby/gems/1.8/gems/thoughtbot-factory_girl-1.2.0/lib/factory_girl/factory.rb:293:in `run'
/usr/local/share/jruby-1.1.6/lib/ruby/gems/1.8/gems/thoughtbot-factory_girl-1.2.0/lib/factory_girl/factory.rb:237:in `create'
/usr/local/share/jruby-1.1.6/lib/ruby/gems/1.8/gems/thoughtbot-factory_girl-1.2.0/lib/factory_girl/proxy/build.rb:17:in `associate'
/usr/local/share/jruby-1.1.6/lib/ruby/gems/1.8/gems/thoughtbot-factory_girl-1.2.0/lib/factory_girl/attribute/association.rb:13:in `add_to'
/usr/local/share/jruby-1.1.6/lib/ruby/gems/1.8/gems/thoughtbot-factory_girl-1.2.0/lib/factory_girl/factory.rb:290:in `run'
/usr/local/share/jruby-1.1.6/lib/ruby/gems/1.8/gems/thoughtbot-factory_girl-1.2.0/lib/factory_girl/factory.rb:288:in `each'
/usr/local/share/jruby-1.1.6/lib/ruby/gems/1.8/gems/thoughtbot-factory_girl-1.2.0/lib/factory_girl/factory.rb:288:in `run'
/usr/local/share/jruby-1.1.6/lib/ruby/gems/1.8/gems/thoughtbot-factory_girl-1.2.0/lib/factory_girl/factory.rb:217:in `build'
test/functional/tweet_feeds_controller_test.rb:12:in `test_Display_friends_timeline_for_the_'amber'_user'
/usr/local/share/jruby-1.1.6/lib/ruby/gems/1.8/gems/activesupport-2.2.2/lib/active_support/testing/setup_and_teardown.rb:94:in `run_with_callbacks_and_mocha' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-28T00:43:23.863

我很确定工厂女孩只是用于 ActiveRecord 对象，如果您使用 rSpec 可能（如果我的语法正确），您应该能够模拟和存根 Twitter::User 对象而不是使用工厂：

```
@twitter_user = mock(Twitter::User, :profile_image =>"#{RAILS_ROOT}/public/images/rails.png") 
```

然后将其附加到需要它的对象上。

这可能不太正确，但这是我要开始的道路。

# git - 在 CVS 中使用 git 的最佳实践

> ID：595106
> 
> 赞同：49
> 
> 时间：2009-02-27T14:57:44.053
> 
> 标签：git, git-cvs

使用 git 与 CVS 存储库交互的最佳实践和技巧是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-03-02T19:12:20.623

[我在这里](https://stackoverflow.com/questions/584522/how-to-export-revision-history-from-mercurial-or-git-to-cvs/586225#586225)写了一个类似问题的答案。

当您被迫继续将更改推送到中央 CVS 存储库时，此方法的效果非常好。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-27T17:12:24.103

我只使用 Git-CVS 交互来为朋友演示 Git，但它非常简单。

*   您需要安装[`cvsps`](http://www.cobite.com/cvsps/cvsps-2.2b1.tar.gz). `Git cvsimport`使用它来访问 CVS 历史记录。
*   我们发现，对于一个大型项目，通过将 CVS 存储库的完整副本放到您的计算机上并在本地执行以下操作，初始设置*要快得多：*`git cvsimport`

    ```
    $ rsync rsync://yourprojecthost.com/cvsroot/yourproject/*  
    $ mkdir myproject.git  
    $ cd myproject.git  
    $ git cvsimport -p -x -v -d :local:/path/to/cvsroot/yourproject 
    ```

请注意，-p 之后的 -x 非常重要。这会将 -x 传递给 cvsps。有关详细信息，请参阅[cvsps 手册页](http://linux.die.net/man/1/cvsps)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-07-02T13:59:10.177

[我为远程 CVS、本地 Git](http://undefinedvalue.com/2010/07/02/workflow-remote-cvs-local-git)编写了我自己的工作流程的详细信息

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T10:53:27.203

稍微元答案。如果你被迫使用 git 'guerilla style'，即你的公司被困在使用 cvs 进行版本控制，而你在工作站上使用 git 来让生活更轻松，你可以考虑做这样的事情；

```
CVS=realCvsPath
# commit to the git first
if ($ARGV[0] && $ARGV[0] eq "commit")
{
system 'git commit -a';
}

# execute the appropriate cvs program
# ===================================
exec "$CVS", @ARGV 
```

将此文件称为“cvs”并将其包含在真正的 CVS 命令之前的路径。否则你可以让 git 提交比 cvs 更早，这没什么用......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-06-02T07:16:14.877

如果上游在 CVS 中是 100%（例如，OpenBSD，或其许多子项目，如[mdocml](http://github.com/cnst/mdocml)或[ports-](http://github.com/cnst/ports-readmes) readmes ），特别是如果它像 OpenBSD CVS 树一样生锈（例如，有时甚至重写历史），我发现简单地将底层`CVS/{Entries,Repository,Root}`文件直接提交到我的存储库中非常有用`git`。

这使得不必拥有多个独立的工作区变得非常容易，可以`git`在任何机器上签出，然后`cvs up`就位，或者`cvs diff`生成正确的 CVS 补丁以邮寄给上游的无 git 维护者。

# algorithm - Stemming - 代码示例或开源项目？

> ID：595110
> 
> 赞同：6
> 
> 时间：2009-02-27T15:00:06.700
> 
> 标签：algorithm, tags, nlp, stemming

词干是标记系统中需要的东西。我用delicious，我没有时间管理和修剪我的标签。我对我的博客更加小心，但它并不完美。我为嵌入式系统编写软件，如果它们包含词干提取功能，它们将更加实用（对用户有帮助）。

例如：
Parse
Parser
解析

对于我将它们放入的任何系统，都应该具有相同的含义。

理想情况下，某处有一个 BSD 许可的词干分析器，但如果没有，我在哪里可以学习常用的算法和技术？

除了 BSD 词干分析器，还有哪些其他开源许可词干分析器？

-亚当

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T15:07:14.687

[Snowball](http://snowball.tartarus.org/) stemmer (C & Java) 我用过它的 Python 绑定，[PyStemmer](http://pypi.python.org/pypi/PyStemmer)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T15:17:00.870

查看用 python 编写的[nltk 工具包](http://www.nltk.org/Home)。它有一个非常实用的[词干分析器](http://nltk.googlecode.com/svn/trunk/doc/howto/stem.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-05T14:46:37.587

词干提取的另一种选择是 WordNet，以及它的[一个 API](http://wordnet.princeton.edu/links#local)。有关词干提取和词形还原的一些[基本信息](http://nlp.stanford.edu/IR-book/html/htmledition/stemming-and-lemmatization-1.html)，包括对 Porter 词干提取算法的描述，可以在[Introduction to Information Retrieval](http://www-csli.stanford.edu/~hinrich/information-retrieval-book.html)中在线找到。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T15:05:50.367

[我相信Lucene](http://lucene.apache.org/java/docs/)有一个词干分析器（如果你愿意，它可以让你使用自己的词干分析器）。

编辑：刚刚检查过，Lucence 指的是[Snowball](http://snowball.tartarus.org/)站点，据我所知，它是一个开源词干库。

# python - 如何从 PEM 文件加载 RSA 密钥并在 python-crypto 中使用它

> ID：595114
> 
> 赞同：12
> 
> 时间：2009-02-27T15:01:59.613
> 
> 标签：python, cryptography

我还没有找到从 PEM 文件加载 RSA 私钥以在 python-crypto（签名）中使用它的方法。

python-openssl 可以加载 PEM 文件，但 PKey 对象不能用于检索与 Crypto.PublicKey.construct() 一起使用的密钥信息（p、q、...）。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-03-03T14:57:27.250

我推荐 M2Crypto 而不是 python-crypto。无论如何，您都需要 M2Crypto 来解析 PEM，它的 EVP api 使您的代码免于依赖特定算法。

```
private = """
-----BEGIN RSA PRIVATE KEY-----
MIIBOwIBAAJBANQNY7RD9BarYRsmMazM1hd7a+u3QeMPFZQ7Ic+BmmeWHvvVP4Yj
yu1t6vAut7mKkaDeKbT3yiGVUgAEUaWMXqECAwEAAQJAIHCz8h37N4ScZHThYJgt
oIYHKpZsg/oIyRaKw54GKxZq5f7YivcWoZ8j7IQ65lHVH3gmaqKOvqdAVVt5imKZ
KQIhAPPsr9i3FxU+Mac0pvQKhFVJUzAFfKiG3ulVUdHgAaw/AiEA3ozHKzfZWKxH
gs8v8ZQ/FnfI7DwYYhJC0YsXb6NSvR8CIHymwLo73mTxsogjBQqDcVrwLL3GoAyz
V6jf+/8HvXMbAiEAj1b3FVQEboOQD6WoyJ1mQO9n/xf50HjYhqRitOnp6ZsCIQDS
AvkvYKc6LG8IANmVv93g1dyKZvU/OQkAZepqHZB2MQ==
-----END RSA PRIVATE KEY-----
"""    
message = "python-crypto sucks"

# Grab RSA parameters e, n
from M2Crypto import RSA, BIO
bio = BIO.MemoryBuffer(private)
rsa = RSA.load_key_bio(bio)
n, e = rsa.n, rsa.e

# In Python-crypto:
import Crypto.PublicKey.RSA
pycrypto_key = Crypto.PublicKey.RSA.construct((n, e))

# Use EVP api to sign message
from M2Crypto import EVP
key = EVP.load_key_string(private)
# if you need a different digest than the default 'sha1':
key.reset_context(md='sha256')
key.sign_init()
key.sign_update(message)
signature = key.sign_final()

# Use EVP api to verify signature
public = """
-----BEGIN PUBLIC KEY-----
MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBANQNY7RD9BarYRsmMazM1hd7a+u3QeMP
FZQ7Ic+BmmeWHvvVP4Yjyu1t6vAut7mKkaDeKbT3yiGVUgAEUaWMXqECAwEAAQ==
-----END PUBLIC KEY-----
""" 
from M2Crypto import BIO, RSA, EVP
bio = BIO.MemoryBuffer(public)
rsa = RSA.load_pub_key_bio(bio)
pubkey = EVP.PKey()
pubkey.assign_rsa(rsa)
pubkey.reset_context(md="sha256")
pubkey.verify_init()
pubkey.verify_update(message)
assert pubkey.verify_final(signature) == 1 
```

请参阅[http://svn.osafoundation.org/m2crypto/trunk/tests/test_rsa.py](http://svn.osafoundation.org/m2crypto/trunk/tests/test_rsa.py)，但我更喜欢使用与算法无关的 EVP API [http://svn.osafoundation.org/m2crypto/trunk/tests/test_evp.py](http://svn.osafoundation.org/m2crypto/trunk/tests/test_evp.py) .

[如何在 Python 中验证 RSA SHA1 签名？](https://stackoverflow.com/questions/544433/how-do-you-verify-an-rsa-sha1-signature-in-python/546476#546476)解决了类似的问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-27T15:12:02.647

这是（接近）您尝试做的事情吗？

```
public_key_filename = 'public_key.pem'
rsa = M2Crypto.RSA.load_pub_key(pk) 
```

那应该行得通。问题也可能与openssl有关，当您仅使用openssl（不在Python中）时它是否有效？

[链接到我也加密](http://chandlerproject.org/bin/view/Projects/MeTooCrypto)

# spring - 从属性文件自动刷新spring bean属性

> ID：595118
> 
> 赞同：5
> 
> 时间：2009-02-27T15:02:58.877
> 
> 标签：spring, configuration, properties, javabeans

我正在使用 Spring 2.5.6。我有一个 bean，其属性是通过[PropertyPlaceholderConfigurer](http://static.springframework.org/spring/docs/2.0.x/api/org/springframework/beans/factory/config/PropertyPlaceholderConfigurer.html)从属性文件分配的。我想知道是否可以在修改属性文件时更新 bean 的属性。例如，将有一些定期过程检查属性文件的最后修改日期，如果它已更改，则重新加载 bean。

我想知道是否已经有一些东西可以满足我的要求。如果不是，解决这个问题的最佳方法是什么？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T15:24:36.407

可能还会考虑使用 Spring 的 PropertyOverrideConfigurer。可以重新读取属性并将其重新应用到一些轮询/调度 bean 中。

它确实取决于实际配置的 bean 如何使用这些属性。例如，他们可能会间接地将它们缓存在自己的某个地方。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T15:14:41.517

如果您想要在运行时动态属性，也许另一种方法是 JMX。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T15:09:24.960

一种方法是在您的应用程序中嵌入一个 groovy 控制台。[这里](http://docs.codehaus.org/display/GROOVY/Embedding+a+Groovy+Console+in+a+Java+Server+Application)有一些说明。顺便说一句，它们做起来很简单——尽管我对 groovy 不太熟悉，但我只花了很少的时间。

完成此操作后，您可以简单地进入控制台并动态更改实时应用程序中的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-23T14:24:30.770

您可能会尝试为 bean 使用自定义范围，以便在更改属性文件时重新创建 bean。在这里查看我[更广泛的答案](https://stackoverflow.com/a/10282328/21499)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-08T02:57:18.980

[春天云配置](http://projects.spring.io/spring-cloud/spring-cloud.html#_spring_cloud_config)具有通过 Spring Cloud Bus 和使用 Cloud Config Server 在运行时更改配置属性的功能。配置或 .properties 或 .yml 文件是从 Spring 应用程序“外部化”的，而是从应用程序在启动时连接到的 Spring Cloud Config Server 检索。该云配置服务器从 GIT 存储库中检索适当的配置 .properties 或 .yml 文件（还有其他存储解决方案，但 GIT 是最常见的）。然后，您可以在运行时通过更改 GIT 存储库的配置文件的内容来更改配置——Cloud Config Server 通过 Spring Cloud Bus 将更改广播到任何客户端 Spring 应用程序，并且这些应用程序的配置会更新，而无需重新启动应用程序。你可以在这里找到一个简单的例子：[https://github.com/ldojo/spring-cloud-config-examples](https://github.com/ldojo/spring-cloud-config-examples)

# mysql - MYSQL LIMIT 关键字是否有 ANSI SQL 替代品？

> ID：595123
> 
> 赞同：37
> 
> 时间：2009-02-27T15:04:26.940
> 
> 标签：mysql, database, keyword, ansi-sql

MYSQL LIMIT 关键字是否有 ANSI SQL 替代品？

LIMIT 关键字限制 SELECT 返回的行数，例如：

```
SELECT * FROM People WHERE Age > 18 LIMIT 2; 
```

返回 2 行。

```
SELECT * FROM People WHERE Age > 18 LIMIT 10, 2; 
```

在前 10 行之后返回 2 行。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-02-27T15:13:27.760

[这显示了不同的方式：](http://forums.mysql.com/read.php?60,4515,4678)

```
-- DB2
select * from table fetch first 10 rows only 
-- Informix 
select first 10 * from table 
-- Microsoft SQL Server and Access 
select top 10 * from table 
-- MySQL and PostgreSQL 
select * from table limit 10 
-- Oracle 
select * from (select * from table) where rownum <= 10 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-02-27T15:19:04.003

不在 SQL:1999 中。

您可以在以后的标准中使用两种可能的方法，在当今的 DBMS 中支持水平通常较低。

在 SQL:2008 中，您可以使用 DB/2 语法：

```
SELECT * FROM things
ORDER BY smell
FETCH FIRST n ROWS ONLY 
```

这仅适用于“LIMIT n”，而不适用于扩展的“LIMIT m, n”偏移语法。在 SQL:2003 中，您可以使用窗口函数，它可以支持扩展语法，但它是一个超级 PITA：

```
SELECT * FROM (
    SELECT *, ROW_NUMBER() OVER (ORDER BY smell) AS rn,
    FROM things
)
WHERE rn<=n -- or rn BETWEEN m+1 AND m+n 
```

今天，您将更常使用特定于 DBMS 的方法。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2011-09-23T10:39:27.757

另见[http://en.wikipedia.org/wiki/Select_(SQL)#FETCH_FIRST_clause](http://en.wikipedia.org/wiki/Select_(SQL)#FETCH_FIRST_clause)

```
SELECT * FROM T LIMIT 10 OFFSET 20 -- Netezza, MySQL, PostgreSQL (also supports the standard, since version 8.4), SQLite, HSQLDB, H2

SELECT * from T WHERE ROWNUM <= 10 -- Oracle (also supports the standard, since Oracle8i)

SELECT FIRST 10 * from T -- Ingres

SELECT FIRST 10 * FROM T order by a -- Informix

SELECT SKIP 20 FIRST 10 * FROM T order by c, d -- Informix (row numbers are filtered after order by is evaluated. SKIP clause was introduced in a v10.00.xC4 fixpack)

SELECT TOP 10 * FROM T -- MS SQL Server, Sybase ASE, MS Access

SELECT TOP 10 START AT 20 * FROM T -- Sybase SQL Anywhere (also supports the standard, since version 9.0.1)

SELECT FIRST 10 SKIP 20 * FROM T -- Interbase, Firebird

SELECT * FROM T ROWS 20 TO 30 -- Firebird (since version 2.1)

SELECT * FROM T
WHERE ID_T > 10 FETCH FIRST 10 ROWS ONLY -- DB2

SELECT * FROM T
WHERE ID_T > 20 FETCH FIRST 10 ROWS ONLY -- DB2 (new rows are filtered after comparing with key column of table T) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-27T15:06:47.963

我不相信。我知道的所有数据库都使用特定于供应商的关键字来实现该功能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T18:06:37.000

添加到@jle的[答案](https://stackoverflow.com/questions/595123/is-there-an-ansi-sql-alternative-to-the-mysql-limit-keyword/595155#595155)：

*   SQLite 支持`LIMIT`(MySQL/PostgreSQL)
*   InterBase/Firebird 支持`SELECT FIRST`和`SKIP`（如 Informix）

另请参阅[Microsoft SQL Server 2000 中的 Emulate MySQL LIMIT 子句](https://stackoverflow.com/questions/216673/emulate-mysql-limit-clause-in-microsoft-sql-server-2000)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-03-10T13:01:29.683

HSQL/H2 像 MySQL 一样使用 LIMIT

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-06-17T08:20:32.063

让我在这里链接一个相关的 SO 问题，[Lukas Eder给出了](https://stackoverflow.com/a/24046664/558008)[很好的答案，bobince 给出](https://stackoverflow.com/a/1528705/558008)了另一个很好的答案：

[SQL 中的 LIMIT 语句有多普遍？](https://stackoverflow.com/questions/1528604/how-universal-is-the-limit-statement-in-sql)

*编辑：*更多好的参考链接，在类似情况下值得一看：

*   [维基百科关于限制结果`FETCH FIRST`和`SELECT`声明](http://en.wikipedia.org/wiki/Select_(SQL)#FETCH_FIRST_clause)；
*   [关于限制结果集的“不同SQL实现的比较”](http://troels.arvin.dk/db/rdbms/#select-limit)；
*   [`LIMIT`](http://www.jooq.org/doc/3.3/manual/sql-building/sql-statements/select-statement/limit-clause/)来自[Lukas Eder 的回答的](https://stackoverflow.com/a/24046664/558008)[条款](http://www.jooq.org/doc/3.3/manual/sql-building/sql-statements/select-statement/limit-clause/)[的 jOOQ 用户手册页](http://www.jooq.org/doc/3.3/manual/sql-building/sql-statements/select-statement/limit-clause/)。

# c# - C# 从静态 void 访问控制属性

> ID：595125
> 
> 赞同：0
> 
> 时间：2009-02-27T15:05:31.163
> 
> 标签：c#, static

我有带有按钮和复选框的表单。如果我点击按钮静态 void 调用它调用非静态 void 显示带有 checkbox.checked.toString() 的消息框问题是如果我更改复选框值它总是显示 false

代码是

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;

namespace WindowsApplication2
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {

        }

        public void y()
        {
            MessageBox.Show(checkBox1.Checked.ToString());
        }

        static void x()
        {
            Form1 f = new Form1();
            f.y();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            x();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T15:08:33.903

我猜你可能和我一样来自 Visual Basic 背景。

在 C# 中，表单只是 Form 类的实例，它们没有像 VB6 时代那样的特殊状态。

当您打电话时，`new Form1()`您基本上是在创建一个*不*访问相同表单的**新**表单。因为任何表单都可以有多个实例，因为它实际上只是一个 C# 类。

 *您可以通过让 x() 方法将当前形式作为参数来解决此问题

```
static void x(Form1 theForm)
{
    theForm.y();
}

private void button1_Click(object sender, EventArgs e)
{
    x(this);
} 
```

表单类中的 this 参数指向表单实例本身。

您现在应该在创建表单时获得正确的值而不是默认值。

我想你有需要`x()`，`static`不是吗？但如果不是这种情况，那么删除`static`from`x()`可能是一个更好的解决方案。

```
void x()
{
    this.y();

    // or you can just omit the this qualifier and call just y();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T15:09:00.580

方法 x 实例化一个新表单。新表单上的复选框也将是新的（使用表单创建），默认值为 false。

你到底想做什么？为什么在按下按钮时创建一个新表单？如果你真的想这样做，那么你需要在调用 Form f = new Form1(); 之后设置新表单的复选框状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T15:08:34.107

这是因为您在 x() 中实例化了一个新的 Form1，尝试将“this”作为参数传递给 x 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T15:08:51.903

您正在创建一个新的 Form1 实例。你为什么这样做？当您创建一个新表单时，也会创建一个新的复选框。表单上的复选框默认设置为 false（未选中），因此，每次创建表单的新实例时，它都会显示为 false。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T15:09:39.483

尝试

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {

    }

    public void y()
    {
        MessageBox.Show(checkBox1.Checked.ToString());
    }

    static void x(Form f)
    {
        f.y();
    }

    private void button1_Click(object sender, EventArgs e)
    {
        x(this);
    }

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T15:09:51.683

该`checkbox1`in`y()`完全不同`Form1`- 您创建的那个`x`。只需摆脱`x()`它，它应该可以工作：

```
 private void button1_Click(object sender, EventArgs e)
    {
        y(); // not x();
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-27T15:13:19.540

您的问题出在 x() 方法中，您在那里所做的实际上是制作一个全新的表单并检查该表单复选框，这显然会被实例化为假。与其调用 x()，不如调用 y()。

或者，或者，将 messagebox.show 放在 buttonclick 方法本身中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-27T15:43:18.937

如果您需要从静态方法访问某些表单实例，则需要在某处保存对该表单的引用。

```
class Program
{
  public static Form thatForm;

  public static void Main(string[] args)
  {
    MyForm form = new MyForm();
    thatForm = form;
    Application.Run(form);
  }
}

class MyForm : Form
{
  void Foo()
  {
    Program.thatForm.somethingPublic();
  }
} 
```

# java - 配置 IntelliJ IDEA 为新项目创建主类

> ID：595130
> 
> 赞同：2
> 
> 时间：2009-02-27T15:07:17.197
> 
> 标签：java, intellij-idea, projects-and-solutions

一位朋友刚开始学习 Java，使用 IntelliJ。他问他如何设置一些模板，以便创建一个新项目将包含一个默认的主类。

目前新建项目时，没有源文件，需要手动添加一个Run/Debug应用配置，然后选择主类。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-27T15:23:44.957

我不知道设置-> 文件模板是否是您的想法，但我会指出以防万一。

您可以通过键入“psvm”并填写方法主体轻松创建一个类并添加一个主要方法。您可以通过右键单击类并选择“运行”来运行它。它会自动添加到您的运行/配置列表中，您只需将其保存以使其永久化。

但我的直觉是，IntelliJ 没有这样的功能来读取某人关于“默认主类”的想法，也不应该这样做。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2015-02-07T18:25:04.413

在资源树中，右键单击要成为主要的类，上下文菜单中应该有一个项目，例如“为 xyz 创建主要”。

# opengl - 健壮灵活的 3D 数据结构

> ID：595131
> 
> 赞同：4
> 
> 时间：2009-02-27T15:07:27.167
> 
> 标签：opengl, data-structures, 3d

我正在寻找一个概念来存储（在 3 维欧几里得空间中）面、边和顶点，这样

*   信息（关于关系）不重复
*   对相邻和相邻面/边/顶点的查询很快
*   网格不限于同一绕组的连接面

*定义*

*   面的邻居：与该面共享边的面
*   顶点的邻居：位于共享该顶点的边的另一端的顶点
*   相邻边：与该边共享端点相同顶点的边

我已经考虑过半边数据结构，但是只有当所有连接的面都具有相同的绕组时，对它的查询才真正起作用。

例如，考虑这个伪代码来访问这些相关实体：

```
face.neighbors #the neighboring faces
face.edges #the edges shared by this face (in the right winding order)
face.verts #the vertex of that face (in the right winding order)
edge.v1, edge.v2 #the two vertex making up an edge
vertex.edges #the edges this vertex shares
vertex.neighbors # the neighbors of this vertex along each shared edge 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T15:57:56.327

我会看一下计算几何算法库[CGAL 。](http://www.cgal.org/)您也许可以直接使用某些东西，或者至少获得一些好主意。半边听起来是个好主意。在我看来，你应该尽可能地强制均匀缠绕。但是，听起来您对此不感兴趣。

一个想法可能是在面部的数据结构中保留一对（每个绕组一个元素）；这可能会给您足够的灵活性，以在其之上实现某种类似半边的数据结构，并且效率很高。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-09-09T15:45:29.440

我建议你也看看[OpenMesh](http://www.openmesh.org/)。它在 C++ 模板方面也很重，比如 CGAL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-09T13:33:57.340

我找到了一个关于 3d 网格数据结构的摘要。[http://wscg.zcu.cz/wscg2006/Papers_2006/Short/E17-full.pdf](http://wscg.zcu.cz/wscg2006/Papers_2006/Short/E17-full.pdf)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-07-13T01:52:03.053

如果您不想局限于多种表面，那么这些天就是翼缘。如果“关于关系的数据”真的是你的首要任务，那么我猜你不走运。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-02-28T19:50:18.630

> *与其说是推荐的结构，不如说是专业人士用于可以构建的计算任务的 3D 库。*

NVIDIA Research 的研究科学家 Michael Garland 发布了他用于 3D 模型和网格计算任务的图形库。

*   [libgfx](http://mgarland.org/files/dist/libgfx-1.1.0-doc/index.html)
*   [qslim](http://mgarland.org/software/qslim.html)一个基于 libgfx 的网格简化应用程序（我亲自使用过，并将[qvis](http://www.memention.com/qvis/)移植到 MacOSX）

# sql - 如何使用 Excel VBA 获取新插入记录的 id？

> ID：595132
> 
> 赞同：9
> 
> 时间：2009-02-27T15:07:59.300
> 
> 标签：sql, excel, ms-access, vba, jet

这似乎是一个很常见的问题，但大多数解决方案都是指连接多个 SQL 命令，我认为 ADO/VBA 无法做到这一点（不过，我很高兴在这方面被证明是错误的）。

我目前插入我的新记录，然后使用（我希望）足够的字段运行选择查询，以保证只能返回新插入的记录。我的数据库一次很少被超过一个人访问（在查询之间发生另一个插入的风险可以忽略不计），并且由于表的结构，识别新记录通常很容易。

我现在正在尝试更新一个没有太多唯一性范围的表，除了人工主键。这意味着存在新记录可能不是唯一的风险，我不愿意添加一个字段只是为了强制唯一性。

在这种情况下，将记录插入 Access 表然后从 Excel 查询新主键的最佳方法是什么？

感谢您的回复。我试图开始`@@IDENTITY`工作，但这总是使用下面的代码返回 0。

```
Private Sub getIdentityTest()
    Dim myRecordset As New ADODB.Recordset
    Dim SQL As String, SQL2 As String

    SQL = "INSERT INTO tblTasks (discipline,task,owner,unit,minutes) VALUES (""testDisc3-3"",""testTask"",""testOwner"",""testUnit"",1);"
    SQL2 = "SELECT @@identity AS NewID FROM tblTasks;"

    If databaseConnection Is Nothing Then
        createDBConnection
    End If

    With databaseConnection
        .Open dbConnectionString
        .Execute (SQL)
        .Close
    End With

    myRecordset.Open SQL2, dbConnectionString, adOpenStatic, adLockReadOnly

    Debug.Print myRecordset.Fields("NewID")

    myRecordset.Close

    Set myRecordset = Nothing
End Sub 
```

有什么突出的负责吗？

然而，鉴于 Renaud 提供的有用的警告（如下），使用的风险似乎几乎与使用`@@IDENTITY`任何其他方法一样大，所以我`SELECT MAX`现在只好使用了。以供将来参考，尽管我很想看看我上面的尝试有什么问题。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-28T03:16:22.357

关于你的问题：

> *我现在正在尝试更新一个没有太多唯一性范围的表，除了人工主键。这意味着存在新记录可能不是唯一的风险，我不愿意添加一个字段只是为了强制唯一性。*

如果您**使用**AutoIncrement 作为主键，那么您就具有唯一性，您可以使用它`SELECT @@Identity;`来获取最后一个自动生成的 ID 的值（请参阅下面的注意事项）。

如果您**没有**使用自动增量，并且您正在从 Access 中插入记录，但您想从 Excel 中检索最后一条：

*   确保您的主键是可排序的，因此您可以使用以下任一查询来获取最后一个：

    ```
    SELECT MAX(MyPrimaryField) FROM MyTable;
    SELECT TOP 1 MyPrimaryField FROM MyTable ORDER BY MyPrimaryField DESC; 
    ```

*   或者，如果对您的主字段进行排序不会给您最后一个，您将需要添加一个 DateTime 字段（例如`InsertedDate`）并在每次在该表中创建新记录时保存当前日期和时间，以便您可以获得最后一个像这样的一个：

    ```
    SELECT TOP 1 MyPrimaryField FROM MyTable ORDER BY InsertedDate DESC; 
    ```

在这两种情况下，我认为您会发现添加 AutoIncrement 主键更容易处理：

*   它不会花费你太多

*   这将保证您记录的唯一性，而无需考虑它

*   这将使您更容易选择最近的记录，无论是使用`@@Identity`主键还是通过主键排序或获取`Max()`.

**从 Excel**

要将数据导入 Excel，您有两种选择：

*   使用查询创建数据链接，因此您可以直接在单元格或范围中使用结果。

*   来自 VBA 的查询：

    ```
    Sub GetLastPrimaryKey(PrimaryField as string, Table as string) as variant
        Dim con As String
        Dim rs As ADODB.Recordset
        Dim sql As String
        con = "Provider=Microsoft.ACE.OLEDB.12.0;" & _
              "Data Source= ; C:\myDatabase.accdb"
        sql = "SELECT MAX([" & PrimaryField & "]) FROM [" & MyTable & "];"
        Set rs = New ADODB.Recordset
        rs.Open sql, con, adOpenStatic, adLockReadOnly
        GetLastPrimaryKey = rs.Fields(0).Value
        rs.Close
        Set rs = Nothing
    End Sub 
    ```

**注意事项`@@Identity`**

在标准 Access 数据库中使用时必须[小心注意事项](http://www.accessmonster.com/Uwe/Forum.aspx/access/8107/Select-Identity)`@@Identity`(*)：

*   它仅适用于 AutoIncrement Identity 字段。

*   仅当您使用 ADO 并运行时才可用`SELECT @@IDENTITY;`

*   它返回最新使用的计数器，[但这是针对**所有表**](http://msdn.microsoft.com/en-us/library/bb208866.aspx)的。您不能使用它来返回 MS Access 中特定表的计数器（据我所知，如果您使用 指定表`FROM mytable`，它只会被忽略）。
    简而言之，返回的值可能根本不是您期望的值。

*   您必须在 an 之后直接查询，`INSERT`以尽量减少得到错误答案的风险。
    这意味着如果您一次插入数据并且需要在另一个时间（或另一个地方）获取最后一个 ID，它将无法正常工作。

*   最后但同样重要的是，仅当通过编程代码插入记录时才设置变量。
    这意味着是通过用户界面添加的记录，`@@IDENTITY`不会被设置。

(*)：为了清楚`@@IDENTITY`起见，如果您对数据库使用 ANSI-92 SQL 模式，则行为会有所不同，并且以更具预测性的方式。
但问题是 ANSI 92 的语法与 Access 支持的 ANSI 89 风格略有不同，并且当 Access 用作前端时，它旨在提高与 SQL Server 的兼容性。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-27T15:42:12.620

如果人工密钥是自动编号，您可以使用@@identity。

请注意，对于这两个示例，事务与其他事件是隔离的，因此返回的身份是刚刚插入的身份。您可以通过在 Debug.Print db.RecordsAffected 或 Debug.Print lngRecs 处暂停代码并将记录手动插入 Table1 来测试这一点，继续代码并注意返回的标识不是手动插入的记录，而是前一个通过代码插入的记录。

**DAO 示例**

```
'Reference: Microsoft DAO 3.6 Object Library '
Dim db As DAO.Database
Dim rs As DAO.Recordset

Set db = CurrentDb

db.Execute ("INSERT INTO table1 (field1, Crdate ) " _
            & "VALUES ( 46, #" & Format(Date, "yyyy/mm/dd") & "#)")
Debug.Print db.RecordsAffected
Set rs = db.OpenRecordset("SELECT @@identity AS NewID FROM table1")
Debug.Print rs.Fields("NewID") 
```

**ADO 示例**

```
Dim cn As New ADODB.Connection
Dim rs As New ADODB.Recordset

Set cn = CurrentProject.Connection

cn.Execute ("INSERT INTO table1 (field1, Crdate ) " _
            & "VALUES ( 46, #" & Format(Date, "yyyy/mm/dd") & "#)"), lngRecs
Debug.Print lngRecs
rs.Open "SELECT @@identity AS NewID FROM table1", cn
Debug.Print rs.Fields("NewID") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-03-12T17:16:38.497

回复：*“我试图让@@IDENTITY 工作，但这总是使用下面的代码返回 0。”*

您的代码发送`SQL`并`SQL2`通过不同的连接对象。`@@identity`除非您从执行`INSERT`语句 的同一连接中询问，否则我认为不会返回零以外的任何内容。

尝试改变这个：

```
myRecordset.Open SQL2, dbConnectionString, adOpenStatic, adLockReadOnly 
```

到：

```
myRecordset.Open SQL2, databaseConnection, adOpenStatic, adLockReadOnly 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-27T23:27:24.730

这是我不使用@@index 或MAX 的解决方案。

```
Const connectionString = "Provider=SQLOLEDB; Data Source=SomeSource; Initial Catalog=SomeDB; User Id=YouIDHere; Password=YourPassword"
Const RecordsSQL = "SELECT * FROM ThatOneTable"

Private Sub InsertRecordAndGetID()
    Set connection = New ADODB.connection
    connection.connectionString = connectionString
    connection.Open
    Set recordset = New ADODB.recordset
    recordset.Open SQL, connection, adOpenKeyset, adLockOptimistic

    With recordset
        .AddNew
        !Field1 = Value1
        !Field2 = Value2
    End With

    recordset.MoveLast
    ID = recordset.Fields("id")

End Sub 
```

享受！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-01T06:29:36.300

试试下面的宏代码。首先从控制框中添加一个命令按钮到工作表，然后在代码窗口中粘贴以下代码

```
Private Sub CommandButton1_Click()
    MsgBox GetLastPrimaryKey
End Sub

Private Function GetLastPrimaryKey() As String
Dim con As String
Dim cn As ADODB.Connection
Dim rs As ADODB.Recordset
Dim sql As String
con = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\myaccess.mdb;Persist Security Info=False"
sql = "SELECT MAX(id) FROM  tblMyTable"

Set cn = New ADODB.Connection
Set rs = New ADODB.Recordset
cn.Open con
rs.Open sql, cn, 3, 3, 1
If rs.RecordCount <> 0 Then
   GetLastPrimaryKey = rs.Fields(0).Value
End If
rs.Close
cn.Close
Set rs = Nothing
Set cn = Nothing
End Function 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-09T21:43:56.623

派对迟到了 8 年......您遇到的问题是您正在使用 dbConnectionString 创建一个*新*连接。@@identity 特定于您正在使用的连接。

一、不要关闭原来的连接

```
'.Close 
```

代替

```
myRecordset.Open SQL2, dbConnectionString, adOpenStatic, adLockReadOnly 
```

使用您之前用于插入的连接

```
myRecordset.Open SQL2, databaseConnection, adOpenStatic, adLockReadOnly 
```

你已经准备好了。实际上，您甚至不需要指定表：

```
SQL2 = "SELECT @@identity AS NewID" 
```

# php - 谁能推荐一个好的条形图组件来显示目标进度？

> ID：595133
> 
> 赞同：0
> 
> 时间：2009-02-27T15:08:20.410
> 
> 标签：php, graphing, bar-chart

我即将开始开发一个 PHP 应用程序，该应用程序允许用户每天跟踪他们的进度。

我正在寻找一个好的图形库，最好是 PHP 和或 Javascript（JQuery 会很好），这将允许我用日期（2 月 10 日、2 月 11 日、2 月 12 日等）命名条形图上的每个条形图在它的侧面或以 45 度角，或者在每个条形图的底部有天数，月份在每个月的 1 日以下）每个图表的时间跨度范围为 1 到 3 个月，但是如果有一些东西可以处理更大的时间框架，那也很好。

我假设这是一个常见问题，并且有一个常见的最佳实践方法可以做到这一点。我更喜欢使用条形图而不是折线图（例如 stack over flow 信誉跟踪器）

有任何想法吗？我看过 JpGraph 和 Graphpite，它们看起来都不是很好。我不介意集成闪存的，只要我可以从我的 php 脚本中提供数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T15:12:55.780

看看谷歌图表。易于使用且随时可用。

[http://code.google.com/apis/chart/](http://code.google.com/apis/chart/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T15:16:56.130

我们使用[JPGraph](http://www.aditus.nu/jpgraph)，它可以处理各种图形和图表并输出 JPG 图像。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T15:47:56.570

如果您正在寻找一些花哨的东西，请查看 PHP/SWF 图表。我已经在几个“金融”网站上使用过它，而且效果很好，而且很容易实现。

[http://www.maani.us/charts/index.php](http://www.maani.us/charts/index.php)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T15:53:55.853

[http://pchart.sourceforge.net/](http://pchart.sourceforge.net/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T16:03:38.123

我已经使用了[flot](http://code.google.com/p/flot/)（用于 jquery）和[flotr](http://solutoire.com/flotr/)（用于原型）。两者都是纯 js 图形库。我个人从未将它们用于条形图，但它们都有如何使用其 API 生成条形图的示例，因此我认为您应该能够使用其中任何一个来完成所需的操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-19T12:20:26.783

我会第二次推荐[ChartDirector](http://www.advsofteng.com)，这是一款非常灵活的出色产品。有时，如何实现您想要的并不总是那么明显，但他们网站上的论坛由优秀的 Peter Kwan 管理，他总是能够为我指明正确的方向。

如前所述，它不是免费的，但很便宜。

我只使用过 .net 版本，但我的理解是所有版本在功能上都是相同的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-27T15:12:46.623

这个问题专门针对 ASP.NET，因此可能不相关，但其中可能有一些有用的东西：

[基于 Web 的应用程序中的图表](https://stackoverflow.com/questions/82345/charting-in-web-based-applications/82386)

此外，我在 PHP 中使用[ChartDirector](http://www.advsofteng.com/)并喜欢它。它不是免费的，但它的功能非常全，并且有很棒的支持。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-27T15:26:13.407

[http://code.google.com/apis/chart/](http://code.google.com/apis/chart/)

# networking - 为什么同时有 DHCP 和静态 IP 地址？

> ID：595134
> 
> 赞同：-1
> 
> 时间：2009-02-27T15:08:20.847
> 
> 标签：networking, ip-address, dhcp, static-ip-address

在我目前的工作地点，在我的 Windows 机器上，当我`ipconfig /all`从命令提示符处执行操作时，我看到我同时拥有一个静态 IP 地址和一个动态 IP 地址。为什么会这样？我正在尝试为我正在进行的一个新软件项目绘制我们的网络结构图……知道这个问题的答案可能会有很大帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T15:10:23.383

您有多个 NIC 并且是多宿主的？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T15:10:54.193

这些来自不同的接口。您可能在 VPN 上，有无线连接，或者有 2 个网卡。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T15:14:03.670

一个可能的原因是，如果您需要为具有单个 NIC 的计算机提供多个主机名/IP。有关更多信息，请参阅[此链接](http://news.softpedia.com/news/Both-DHCP-and-Static-IP-addresss-at-the-same-time-47494.shtml)。就我个人而言，我不明白为什么这是必要的，但似乎 Windows 确实提供了一种方法来做到这一点。

# c# - .Net PropertyGrid DropDownList - 返回值与显示值不同

> ID：595140
> 
> 赞同：4
> 
> 时间：2009-02-27T15:09:08.893
> 
> 标签：c#, .net, controls, propertygrid

我希望能够在属性网格中显示一个下拉列表，该下拉列表显示一些“字符串”值但返回一个“int”值。

例如，让我得到这个类：

```
public class MyObjectOptions : StringConverter
{
    public override bool GetStandardValuesSupported(ITypeDescriptorContext context)
    {
        return true;
    }

    public override StandardValuesCollection GetStandardValues(ITypeDescriptorContext context)
    {
        MyObjectCollection mm = new MyObjectCollection();

        List<String> names = new List<String>
        foreach (MyObject m in mm)
        {
            m.Id // Need to store this somewhere ...
            names.Add(m.Name);
        }

        return new StandardValuesCollection(name);
    }

    public override bool GetStandardValuesExclusive(ITypeDescriptorContext context)
    {
        return true;
    }
} 
```

这是我在 propertygrid 控件中的类使用

```
public class MyObjectProperty
{
    [TypeConverter(typeof(MyObjectOptions))]
    public int Id
    {
        get { return this.id; }
        set { this.id = value; }
    }
} 
```

如您所见，我想存储对象的 id，但我想在下拉列表中显示它的名称...我尝试使用哈希表，但它不起作用...

顺便说一句 - 我使用 .Net 3.5 版，但我只使用 WinForm（不是 WPF）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-07T19:24:47.123

您不能为此使用 GetStandardValues。如果您必须将整数值限制为 1、5 和 10，此方法将很有用。

如果要在属性值中显示字符串，只需覆盖 TypeConverter 的 ConvertTo 和 ConvertFrom 方法。PropertyGrid 将使用下拉列表中转换后的字符串。

关于您的哈希表，如果其内容是静态的，您可以将其存储在 TypeConverter 中。如果它是动态的，最好让网格的目标实例来管理它。从您的转换器中，您将能够通过 TypeDescriptorContext.Instance 属性访问它。

希望有帮助。

# reporting-services - SSRS：在报告中汇总 TimeSpan 值

> ID：595158
> 
> 赞同：8
> 
> 时间：2009-02-27T15:14:00.427
> 
> 标签：reporting-services, sum, timespan

我有一个报告和一个数据源，其中一列的类型为 TimeSpan。当我使用时，TimeSpan 值似乎在报告中正确显示`Fields!TheTime.Value`，没有问题。

*   07:02:00
*   05:41:00

但我想对这些值进行求和以获得一组的总时间。在 C# 中，我当然可以做一个 TimeSpan + 另一个 TimeSpan，所以我知道可以添加它们。我试过

```
=Sum(Fields!TheTime.Value) 
```

但它最终以某种形式打印出来。例如，对于上面的输出时间，我会得到`457800000000`总和。那甚至应该是什么？

无论如何，我怎样才能在报告中总结时间跨度值？对于上述时间跨度，我想以`12:43:00`总和结束。除非我的数学再次让我失望了......但你明白了：p

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-03-02T09:13:37.723

*叹息*解决方案简单得令人讨厌......为什么我不能一开始就尝试过呢？哦，好吧......也许是因为我没有意识到我可以`TimeSpan`上课......也许是因为我认为自己是盲人......但无论如何，这里是：

```
=TimeSpan.FromTicks(Sum(Fields!TheTime.Value)) 
```

哦！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T19:04:21.887

@Svish - 我删除了我之前的帖子，因为我对自己的答案有一定的不确定性，但我同意@pfunk。

我终于恢复了 SSRS 并玩了一下，看起来你的大数字就是滴答数，所以看起来对结果进行一些格式化对你有用。

有趣的是，我之前复杂的答案是对 DateTime 值求和（在我的查询中使用 SQL Server DATETIME 数据类型）的一种解决方法，而这在 SSRS（和 SQL）中是无法做到的，因为你不能对 DATETIME 求和。我将再次将其包含在此处以供将来参考，但我认为之前有点切线:)

下面的代码将 DateTime 字段转换为双精度值，对结果求和，然后将其转换回 DateTime 并将其格式化为 hh:mm:ss

```
=Date.FromOADate(Sum(Fields!TheTime.Value.ToOADate())).ToString("hh:mm:ss") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T18:38:29.937

可能发生的情况是，当您显示 Fields!TheTime.Value 时，SSRS 足够聪明，可以知道将其显示为 DateTime 类型的字段

当您在其中添加总和时，它认为它是一个数字类型字段并将其显示为这样（即，它对每个时间跨度字段中的“刻度”数求和）

尝试在字段属性中将总和值专门格式化为日期时间，它可能会正确显示

# c# - 我可以自动将 HierarchicalDataTemplate 项目包装在 TreeViewItem 内吗？

> ID：595163
> 
> 赞同：0
> 
> 时间：2009-02-27T15:14:52.997
> 
> 标签：c#, .net, wpf, data-binding, treeview

我有一个 4 级树结构，定义为：

```
<HierarchicalDataTemplate DataType="{x:Type src:Level1}" ItemsSource="{Binding Path=Level2Items}">
    <TextBlock Text="{Binding Path=Level1Name}"/>
</HierarchicalDataTemplate>

<HierarchicalDataTemplate DataType="{x:Type src:Level2}" ItemsSource="{Binding Path=Level3Items}">
    <TextBlock Text="{Binding Path=Level2Name}"/>
</HierarchicalDataTemplate>

<HierarchicalDataTemplate DataType="{x:Type src:Level3}" ItemsSource="{Binding Path=Level4Items}">
    <TextBlock Text="{Binding Path=Level3Name}"/>
</HierarchicalDataTemplate>
<DataTemplate DataType="{x:Type src:Level4}">
    <TextBlock Text="{Binding Path=Level4Name}"/>
</DataTemplate> 
```

而且效果很好。唯一的问题是，我无法以编程方式选择任何绑定项目，因为它们不是 TreeViewItem 类型（因此没有“IsSelected”属性）。有没有办法自动将数据绑定项包装在特定容器类型中（在本例中为：TreeViewItem）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T15:24:17.810

如果您的项目在 a 中，它们将由's自动`TreeView`包装在 a中。您可以执行以下操作来确保映射上的属性到数据类上的属性：`TreeViewItem``TreeView``ItemContainerGenerator``IsSelected``TreeViewItem`

```
<TreeView>
    <TreeView.ItemContainerStyle>
        <Style TargetType="TreeViewItem">
            <Setter Property="IsSelected" Value="{Binding MyIsSelectedProperty}"/>
        </Style>
    </TreeView.ItemContainerStyle>
</TreeView> 
```

# c# - C# CLR 程序集查询

> ID：595165
> 
> 赞同：2
> 
> 时间：2009-02-27T15:15:00.190
> 
> 标签：c#, sql-server, assemblies

我正在为 MS SQL Server 2005 创建一个用于加密/解密的 C# 程序集。

我需要在这个程序集中查询数据库，并且想知道连接到数据库的首选方法是什么？我相信我们不希望在连接字符串中有用户名/密码。

由于程序集是在 MS SQL 中注册的，它是否有某种快速访问数据库中数据的方法？

我有点新手，因为它与集成安全性或可信连接有关。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T15:21:01.783

使用 CLR 存储过程时可以使用以下连接字符串：

```
 using(SqlConnection connection = new SqlConnection("context connection=true")) 
  {
      // ..
  } 
```

# .net - 实现“忘记密码”的最佳方法是什么？页？

> ID：595168
> 
> 赞同：1
> 
> 时间：2009-02-27T15:15:57.207
> 
> 标签：.net, asp.net, web-config, membership

我正在使用 ASP .NET 2.0 中的成员资格功能。我想知道当我的应用程序配置为仅允许经过身份验证的用户时，我将如何实现忘记密码页面。现在唯一可以访问的页面是登录页面。我希望未经授权的用户也被允许访问忘记密码页面。我的网络配置如下：

```
 <authentication mode="Forms">
      <forms loginUrl="~/Authentication/Login.aspx"/>
     </authentication>
  <authorization>
      <deny users="?" />
      <allow users="*" />
  </authorization> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T15:27:59.283

为您的 ForgotPassword.aspx 页面添加规则

```
 <location path="ForgotPassword.aspx">
    <system.web>
      <authorization>
        <allow users="*"/>
      </authorization>
    </system.web>    
  </location> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T15:28:13.387

将以下内容添加到您的 web.config 以允许未经身份验证的用户访问密码恢复页面：

```
 <location path="RecoverPassword.aspx">
    <system.web>
      <authorization>
        <allow users="?" />
      </authorization>
    </system.web>
  </location> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T22:51:09.517

为什么不设置您的 ~/Authentication/Login.aspx 页面来处理基于获取请求的忘记密码，例如

[http://[主机]/Authentication/Login.aspx?recoverpw=true](http://[host]/Authentication/Login.aspx?recoverpw=true)

这将使您的 web.config 保持简单并在同一页面中组合类似的代码

# iphone - 为什么我在使用 Objective C 的深拷贝时遇到问题？

> ID：595170
> 
> 赞同：1
> 
> 时间：2009-02-27T15:16:19.000
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

我假设我对如何执行深层复制的理解还不止于此。我在下面执行的一些次优内存处理也是如此。下面的这段代码可能描述了一个浅拷贝，我相信这就是我的问题所在。我有一些千篇一律的示例代码，如下所示：

```
NSArray *user = [[xmlParser createArrayWithDictionaries:dataAsXML
                                              withXPath:kUserXPath] retain];
if([user count] > 0) {
    self.name = [[user valueForKey:@"name"] copy];
}

// Crash happens if I leave the next line un-commented.
// But then we have a memory leak.
[user release]; 

[xmlParser release]; 
```

不幸的是，当我注释掉时`[user release]`，代码可以工作，但我们有明显的内存泄漏。`createArrayWithDictionaries:withXPath:`昨晚 SO 社区帮助我了解更好的内存管理时，对该方法进行了重构。这是它的样子：

```
- (NSArray *)createArrayWithDictionaries:(NSString *)xmlDocument 
                               withXPath:(NSString *)XPathStr {
    NSError *theError = nil;
    NSMutableArray *dictionaries = [NSMutableArray array];
    CXMLDocument *theXMLDocument = [CXMLDocument alloc];
    theXMLDocument = [theXMLDocument initWithXMLString:xmlDocument
                                               options:0
                                                 error:&theError]; 
    NSArray *nodes = [theXMLDocument nodesForXPath:XPathStr error:&theError];

    for (CXMLElement *xmlElement in nodes) {
        NSArray *attributes = [xmlElement attributes];
        NSMutableDictionary *attributeDictionary;
        attributeDictionary = [NSMutableDictionary dictionary];
        for (CXMLNode *attribute in attributes) {
            [attributeDictionary setObject:[attribute stringValue]
                                    forKey:[attribute name]];
        }

        [dictionaries addObject:attributeDictionary];
    }

    [theXMLDocument release];
    return dictionaries;
} 
```

我猜这里可能会出现几个问题：

*   我的字典数组上的自动释放正在发生，因此我的应用程序崩溃了。
*   我没有执行深拷贝，只有浅拷贝。这样当用户数组被释放时，`self.name`就完成了。

使用`NSZombieEnabled`，我看到以下内容：

```
*** -[CFString 响应选择器：]：
     发送到已释放实例 0x1ae9a0 的消息

```

此外，回溯显示崩溃的最终调用在与其他两种方法不同的模块中包含以下代码：

```
User *u = self.user;
NSString *uri = [NSString stringWithFormat:@"%@/user/%@/%@",
                         [self groupName], u.userId, kLocationsUri]; 
```

在客户端代码和之间发生的所有自动释放/复制/保留之间`createArrayWithDictionaries:withXPath`，我对这里的真正问题有点困惑。再次感谢您帮助我理解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T17:30:20.520

好的，你不需要保留返回值，`createArrayWithDictionaries:`因为你没有保留它。返回值是自动释放的。我强烈建议您阅读自动发布的工作原理。你只保留你打算在你的对象中保留的东西。

此外，`user`是一个`NSArray`. 如果您调用`[user valueForKey:@"name"]`，您将获得另一个`NSArray`值，这些值表示 中`name`每个对象的键值`users`。此外，`name`您的对象的属性是如何定义的？如果您将其声明为`copy`or `retain`（如果您自己不指定，我相信`retain`这是默认值），您不需要复制或保留该值。实际上，访问者应该始终负责进行内存管理，而不是调用者。如果您编写了自己的访问器（即您没有使用`@synthesize`关键字），您需要确保在那里进行内存管理。

我猜你想写的更像是这样的：

```
 NSArray *user = [xmlParser createArrayWithDictionaries:dataAsXML withXPath:kUserXPath];
    if ([user count] > 0)
        self.name = [[user objectAtIndex:0] objectForKey:@"name"];

    [xmlParser release]; 
```

我认为您的麻烦源于对内存管理在 Objective-C 中的工作方式的误解。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T17:23:45.107

> 我的字典数组上的自动释放正在发生，因此我的应用程序崩溃了。

如果调用者打算将数组保留在某个地方，则需要保留它。否则，它会在尝试访问（现已死亡的）对象时崩溃。

如果调用者要将其存储在属性中，则必须使用`self.dictionaries = […]`语法，而不是`dictionaries = […]`. 前者是属性访问，调用setter方法；后者是直接实例变量赋值。

回到您的实际问题，即深拷贝问题：您需要获取每个元素的子元素并将它们放入每个元素的字典中。

基本上，您需要一个递归方法（或一个队列，但这更难——在过早优化下的文件，直到您证明您需要它），它接受一个元素并返回一个字典，然后您需要在每个您的元素的子元素，并将结果收集到一个数组中，并将其放入您正在创建的字典中。

我建议将此递归方法作为元素的实例方法。就像是：

```
- (NSDictionary *) dictionaryRepresentation {
    NSMutableDictionary *attributeDictionary = [NSMutableDictionary dictionary];
    for (CXMLNode *attribute in attributes) {
        [attributeDictionary setObject:[attribute stringValue] forKey:[attribute name]];
    }

    NSArray *childElements = [self childElements];

    return [NSDictionary dictionaryWithObjectsAndKeys:
        attributeDictionary, @"attributes",
        [childElements valueForKey:@"dictionaryRepresentation"], @"childElements",
        nil];
} 
```

`createArrayWithDictionaries:withXPath:`然后用类似的`valueForKey:`消息替换循环。我留给你填写。

`valueForKey:`是键值编码的主要方法。在这两个地方，我们都在使用[NSArray 的便捷实现 it](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/Reference/Reference.html#//apple_ref/occ/instm/NSArray/valueForKey:)。

（如果使用`valueForKey:`仍然对您没有意义，您应该阅读[KVC 编程指南](http://developer.apple.com/documentation/Cocoa/Conceptual/KeyValueCoding/)。KVC 在现代 Cocoa 中至关重要，因此您迟早需要阅读此内容。）

# asp.net-mvc - ASP.NET MVC、MVCContrib、Structuremap，让它作为控制器工厂工作？

> ID：595171
> 
> 赞同：4
> 
> 时间：2009-02-27T15:16:27.860
> 
> 标签：asp.net-mvc, dependency-injection, structuremap

我试图让结构图正确创建我的控制器，我正在使用 DI 将 INewsService 注入到 NewsController 中，这是我唯一的构造函数。

```
public class NewsController : Controller
{
    private readonly INewsService newsService;

    public NewsController(INewsService newsService)
    {
        this.newsService = newsService;
    }

    public ActionResult List()
    {
        var newsArticles = newsService.GetNews();
        return View(newsArticles);
    }
} 
```

我正在使用此代码启动应用程序

```
public class Application : HttpApplication
{
    protected void Application_Start()
    {
        RegisterIoC();
        RegisterViewEngine(ViewEngines.Engines);
        RegisterRoutes(RouteTable.Routes);
    }

    public static void RegisterIoC()
    {
        ObjectFactory.Initialize(config => {
            config.UseDefaultStructureMapConfigFile = false;
            config.AddRegistry<PersistenceRegistry>();
            config.AddRegistry<DomainRegistry>();
            config.AddRegistry<ControllerRegistry>();
        });
        DependencyResolver.InitializeWith(new StructureMapDependencyResolver());
        ControllerBuilder.Current.SetControllerFactory(typeof(IoCControllerFactory));            
    }
} 
```

但是 Structuremap 似乎不想注入 INewsService 并且我收到错误 No parameterless constructor defined for this object。

我错过了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-28T00:19:37.417

我使用 StructureMap 提供的“默认约定”机制来避免需要单独配置每个接口。下面是我用来完成这项工作的代码：

我的 Global.asax 在 Application_Start 中有这一行（它使用来自 MvcContrib 的 StructureMap 工厂）：

```
protected void Application_Start()
{
    RegisterRoutes(RouteTable.Routes);
    ObjectFactory.Initialize(x =>
    {
        x.AddRegistry(new RepositoryRegistry());
    });
    ControllerBuilder.Current.SetControllerFactory(typeof(StructureMapControllerFactory));
} 
```

RepositoryRegistry 类如下所示：

```
public class RepositoryRegistry : Registry
{

    public RepositoryRegistry()
    {
        Scan(x =>
        {
            x.Assembly("MyAssemblyName");
            x.With<DefaultConventionScanner>();
        });

    }

} 
```

DefaultConventionScanner 查找遵循 ISomethingOrOther 和 SomethingOrOther 命名约定的接口/类对，并自动将后者关联为前一个接口的具体类型。

如果您不想使用该默认约定机制，则可以在 Registry 类中添加代码，以使用以下语法将每个接口显式映射到具体类型：

```
ForRequestedType<ISomethingOrOther>().TheDefaultIsConcreteType<SomethingOrOther>(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T15:23:58.187

除非我遗漏了什么，否则您不会告诉 StructureMap 用于 INewsService 的具体类型。您需要添加以下内容：

```
TheConcreteTypeOf<INewsService>.Is<MyConcreteNewsService>(); 
```

我不知道我脑海中的确切语法，但这就是你所缺少的。一旦你指定了它，它就会知道要注入控制器的 INewsService 的哪个实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-06T04:18:12.633

ASP.NET MVC 当前使用默认的无参数构造函数来实例化控制器，这排除了任何基于构造函数的依赖注入。为此，您确实需要使用[MvcContrib](http://mvccontrib.codeplex.com/)项目，该项目具有对 StructureMap（和 Castle/Spring.NET/Unity）的内置支持，尽管当前文档不存在（从字面上看，您会得到一个存根 wiki 页面，不是一个好兆头）。Erv Walter 在此线程中的代码示例展示了如何设置 StructureMap 集成。

# asp.net - 在 ASP.Net 中使用自定义 RoleProvider 时如何允许多个角色查看页面

> ID：595173
> 
> 赞同：30
> 
> 时间：2009-02-27T15:16:43.900
> 
> 标签：asp.net, roles

我创建了自己的角色提供者，因为我发现 ASP.Net 提供的角色提供者在数据库中的表方面过于庞大。我发现实现自定义 RoleProvider 非常容易。

我唯一的问题是，现在我不能为一个页面拥有多个角色。我在某处看到，在您的班级顶部，您需要使用一些安全代码“注释”它。这就是我所拥有的

```
[PrincipalPermission(SecurityAction.Demand, Role="Admin")] 
```

如果我尝试通过使用逗号分隔的列表来包含多个角色，则会出现错误。如果我尝试指定多个角色键，那么我也会收到错误。我是否需要指定多个 PrinicipalPermissions？

我对 ASP.Net 的角色管理经验很少。有人可以指出我正确的方向或一些好的文学作品。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-02-27T15:24:08.450

您可以多次添加 PrinicpalPermission 属性。

```
[PrincipalPermission(SecurityAction.Demand, Role="Admin")]
[PrincipalPermission(SecurityAction.Demand, Role="AnotherRole")] 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2011-09-21T04:13:53.267

```
[PrincipalPermission(SecurityAction.Demand, Role="Admin,Another RoleName")] 
```

# windows - CreateProcessWithLogonW() 问题 - 需要使用同一用户启动子进程

> ID：595176
> 
> 赞同：1
> 
> 时间：2009-02-27T15:16:56.643
> 
> 标签：windows, windows-services, credentials, createprocess

我有一个 Windows 可执行文件，它通过使用一组指定的用户详细信息调用 CreateProcessWithLogonW() 从服务中启动。

这可以正常工作，并且该过程按预期开始。然而，当这个进程试图自己启动其他进程时，目前只使用 CreateProcess() 这些启动然后立即死亡 - 它们是需要桌面访问的可执行文件。

在阅读了微软关于 CreateProcess() 的文章后 - [http://msdn.microsoft.com/en-us/library/ms682425(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms682425(VS.85).aspx)

我认为可以看出为什么会发生这种情况，并且在一定程度上是有道理的。CreateProcess() 知道调用进程正在模拟用户，因此它使用它的父进程，在本例中是本地系统帐户。但是当然，在本地系统帐户中运行的任何东西都没有我们需要的访问权限，因此启动的进程会死掉。

奇怪的是，当我之前使用 LogonUser() 和 CreateProcessAsUser() 在服务中启动初始可执行文件时，它运行良好。但是由于没有正确权限的问题，我不得不将其更改为 CreateProcessWithLogonW()。

有人知道解决这个问题吗？我在网上其他地方看到过关于这个的讨论，但没有任何明确的解决方案。似乎我可能需要我在 CreateProcessWithLogonW() 中登录的用户的令牌，以便以后可以使用它来启动其他进程？但是我无法获得这个令牌，可以以任何方式为当前用户检索它吗？

任何帮助将不胜感激，谢谢:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-02T14:44:15.980

我们使用我很久以前找到的一些代码解决了这个问题。源模块之一的“版权”部分包含以下内容：

```
/////////////////////////////////////////////////////////////
// CreateProcessAsUser.cpp
// 
// Written by Valery Pryamikov (1999)
// 
// Command line utility that executes a command under specified user identity 
// by temporarily installing itself as a service.
//
// Based on Keith Brown's AsLocalSystem utility (http://www.develop.com/kbrown)
// Uses some code from Mike Nelson's dcomperm sample utility 
//   and from tlist sample (Microsoft Source Code Samples)
//
// Use:
//  CreateProcessAsUser.exe [-i[nteractive]]|[-s[ystem]]|
//       [-u"UserName" -d"DomainName" -p"Password"]|[-a"AppID"] command
//  Command must begin with the process (path to the exe file) to launch
//  -i        process will be launched under credentials of the 
//            "Interactive User" (retrieved from winlogon\shell process)
//  -a        process will be launched under credentials of the user 
//            specified in "RunAs" parameter of AppID.
//  -s        process will be launched as local system
//  -u -d -p  process will be launched on the result token of the 
//            LogonUser(userName,domainName,password,LOGON32_LOGON_BATCH...)
//
// either (-s) or (-i) or (-a) or (-u -d -p) parameters must supplied
// 
// Examples:
// CreateProcessAsUser -s cmd.exe
// CreateProcessAsUser -a"{731A63AF-2990-11D1-B12E-00C04FC2F56F}" winfile.exe
//
///////////////////////////////////////////////////////////// 
```

也许这些信息会在您的谷歌搜索中产生点击 - 我尝试了一些快速尝试，但空手而归。我们将内部分解为一组 API，从而产生我们需要的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T17:15:35.657

您是否拥有使用启动的代码`CreateProcessWithLogonW`（以及调用的代码`CreateProcess`）？如果你不这样做，那么你可能需要在它上面执行**[IAT（或 API）挂钩](http://sandsprite.com/CodeStuff/IAT_Hooking.html)**（即在运行时），以用也使用或`CreateProcess`的适当过程替换任何调用。请参阅[APIHijack](http://www.codeproject.com/KB/DLL/apihijack.aspx?fid=1267&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=26&select=981057)、[Detours](http://research.microsoft.com/en-us/projects/detours/)。`CreateProcessWithLogonW``CreateProcessWithTokenW`

完成此操作后，子进程可能需要访问`HKCU`. 如果您还没有这样做，您应该在调用之前加载每个模拟用户的配置文件，每个用户一次`CreateProcessWithLogonW`。

> 默认情况下，CreateProcessWithLogonW 不会将指定的用户配置文件加载到 HKEY_USERS 注册表项中。这意味着访问 HKEY_CURRENT_USER 注册表项中的信息可能不会产生与正常交互式登录一致的结果。在调用 CreateProcessWithLogonW、使用 LOGON_WITH_PROFILE 或调用 LoadUserProfile 函数之前，您有责任将用户注册表配置单元加载到 HKEY_USERS 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T15:35:24.463

服务是否没有允许它们与桌面交互的选项？如果可以为您的服务设置该选项，那可能是最简单的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-06T06:44:51.230

我假设这个过程是一项服务；问题中未指定，但鉴于它作为本地系统帐户运行，这似乎是合乎逻辑的。

你被卡住的地方不在`CreateProcess`，它在[`CreateService`](http://msdn.microsoft.com/en-us/library/ms682450(VS.85).aspx)。如果您希望您的服务能够与桌面交互，则必须将[`SERVICE_INTERACTIVE_PROCESS`](http://msdn.microsoft.com/en-us/library/ms682450(VS.85).aspx#ctl00_rs1_mainContentContainer_ctl06)参数指定为标志之一`dwServiceType`。此设置由服务的子进程继承。

您还可以使用服务工具修改现有服务的设置，选择服务的属性，单击“登录”选项卡，然后选中“允许服务与桌面交互”复选框。

# delphi - 在 Delphi 中使用指针

> ID：595177
> 
> 赞同：6
> 
> 时间：2009-02-27T15:17:00.717
> 
> 标签：delphi, pointers

我已经开发了一段时间了，到目前为止我还没有在我的开发中使用过指针。

那么指针有什么好处呢？应用程序是否运行得更快或使用的资源更少？

因为我确信指针很重要，你能不能“指出”我一些文章，基本但很好地开始在 Delphi 中使用指针？谷歌给了我太多太特别的结果。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-27T15:24:36.530

指针是指向一块内存的变量。优点是：

*   你可以给那块内存你想要的大小。
*   您只需更改指针以指向另一块内存，从而节省大量复制时间。

Delphi 使用了很多隐藏指针。例如，如果您正在使用：

```
var
  myClass : TMyClass;
begin
  myClass := TMyClass.Create; 
```

myClass 是指向对象的指针。

另一个例子是动态数组。这也是一个指针。

要更多地了解指针，您需要更多地了解内存。每条数据可以存在于不同的数据中。

例如全局变量：

```
unit X;

interface

var
  MyVar: Integer; 
```

在数据段中定义了一个全局变量。数据段是固定的。并且在程序的生命周期中，这些变量都是可用的。这意味着内存不能用于其他用途。

局部变量：

```
procedure Test;
var
  MyVar: Integer; 
```

堆栈上存在局部变量。这是一块用于管理的内存。它包含函数的参数（好的，有些放在寄存器中，但现在不重要了）。它包含返回地址，因此如果程序结束，cpu 知道返回到哪里。它包含函数中使用的局部变量。局部变量只存在于函数的生命周期中。如果函数结束，您将无法以可靠的方式访问局部变量。

堆变量：

```
procedure Test2;
var
  MyClass: TMyClass;
begin
  MyClass := TMyClass.Create; 
```

变量 MyClass 是一个指针（它是在堆栈上定义的局部变量）。通过构造一个对象，您可以在堆上分配一块内存（不用于程序和堆栈的大块“其他”内存）。变量 MyClass 包含这块内存的地址。堆变量在您释放它们之前一直存在。这意味着如果您退出函数 Test2 而不释放对象，则该对象仍然存在于堆中。但是您将无法访问它，因为地址（变量 MyClass）已经消失。

**最佳实践**

几乎总是最好在同一级别分配和释放指针变量。

例如：

```
var
  myClass: TMyClass;
begin
  myClass := TMyClass.Create;
  try
    DoSomething(myClass);
    DoSomeOtherthing(myClass);
  finally
    myClass.Free;
  end;
end; 
```

如果可以，尽量避免使用返回对象实例的函数。调用者是否需要处理对象永远无法确定。这会造成内存泄漏或崩溃。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-27T19:12:44.720

到目前为止，您已经得到了很多很好的答案，但是从您在使用长字符串、动态数组和对象引用时已经在处理指针的答案开始，您应该开始想知道为什么*要*使用指针而不是长字符串、动态数组和对象引用。鉴于 Delphi 在很多情况下都可以很好地隐藏指针，是否还有理由继续使用指针？

让我给你两个在 Delphi 中使用指针的例子。如果您主要编写业务应用程序，您会发现这可能与您完全无关。但是，如果您需要使用任何标准 Delphi 单元未导入的 Windows 或第三方 API 函数，并且在（例如）JEDI 库中找不到导入单元，则它可能变得很重要。它可能是在字符串处理代码中实现必要的最后一点速度的关键。

**指针可用于处理不同大小的数据类型（编译时未知）**

考虑 Windows 位图数据类型。每个图像可以有不同的宽度和高度，并且有不同的格式，从黑白（每像素 1 位）到 2^4、2^8、2^16、2^24 甚至 2^32 灰度值或颜色. 这意味着在编译时不知道位图将占用多少内存。

在 windows.pas 中有*TBitmapInfo*类型：

```
type
  PBitmapInfo = ^TBitmapInfo;
  tagBITMAPINFO = packed record
    bmiHeader: TBitmapInfoHeader;
    bmiColors: array[0..0] of TRGBQuad;
  end;
  TBitmapInfo = tagBITMAPINFO; 
```

TRGBQuad*元素*描述了一个像素，但位图当然包含多个像素。因此，永远不会使用*TBitmapInfo*类型的局部变量，而总是使用指向它的指针：

```
var
  BmpInfo: PBitmapInfo;
begin
  // some other code determines width and height...
  ...
  BmpInfo := AllocMem(SizeOf(TBitmapInfoHeader)
    + BmpWidth * BmpHeight * SizeOf(TRGBQuad));
  ...
end; 
```

现在使用指针可以访问所有像素，即使*TBitmapInfo*只有一个像素。请注意，对于此类代码，您必须禁用范围检查。

像这样的东西当然也可以用*TMemoryStream*类来处理，它基本上是一个友好的包装器，围绕着一个指向内存块的指针。

当然，简单地创建一个*TBitmap*并指定它的宽度、高度和像素格式要容易得多。再说一遍，Delphi VCL 确实消除了大多数需要指针的情况。

**指向字符的指针可用于加速字符串操作**

这与大多数微优化一样，仅在极端情况下使用，在您分析并发现使用字符串的代码会消耗大量时间之后。

字符串的一个很好的属性是它们是引用计数的。复制它们不会复制它们占用的内存，只会增加引用计数。只有当代码尝试修改引用计数大于 1 的字符串时，才会复制内存，以创建引用计数为 1 的字符串，然后可以安全地对其进行修改。

字符串的一个不太好的属性是它们是引用计数的。每个可能修改字符串的操作都必须确保引用计数为 1，否则对字符串的修改将是危险的。替换字符串中的字符就是这样的修改。为了确保引用计数为 1，每当写入字符串中的字符时，编译器都会添加对*UniqueString()的调用。*现在在循环中写入字符串的*n 个*字符将导致*UniqueString()*被调用*n*次，即使在第一次确保引用计数为 1 之后也是如此。这意味着基本上执行了*n - 1次**UniqueString()*调用不必要的。

使用指向字符的指针是加速涉及循环的字符串操作的常用方法。想象一下，您希望（出于显示目的）用一个小点替换字符串中的所有空格。使用调试器的 CPU 视图并比较为此代码执行的代码

```
procedure MakeSpacesVisible(const AValue: AnsiString): AnsiString;
var
  i: integer;
begin
  Result := AValue;
  for i := 1 to Length(Result) do begin
    if Result[i] = ' ' then
      Result[i] := $B7;
  end;
end; 
```

使用此代码

```
procedure MakeSpacesVisible(const AValue: AnsiString): AnsiString;
var
  P: PAnsiChar;
begin
  Result := AValue;
  P := PAnsiChar(Result);
  while P[0] <> #0 do begin
    if P[0] = ' ' then
      P[0] := $B7;
    Inc(P);
  end;
end; 
```

在第二个函数中，只有一个对*UniqueString()*的调用，当第一个字符串字符的地址分配给 char 指针时。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T15:29:09.297

您可能已经使用过指针，但您只是不知道。类变量是指针，字符串是指针，动态数组是指针，Delphi 只是为你隐藏了它。当您执行 API 调用（将字符串转换为 PChar）时，您会看到它们，但即使如此，Delphi 也可以隐藏很多。

有关指针的优势，请参阅 Gamecats 答案。

在这篇[About.com 文章中](http://delphi.about.com/od/objectpascalide/a/pointers.htm "About.com 文章")，您可以找到 Delphi 中指针的基本解释。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T15:33:20.787

某些数据结构需要指针。最简单的例子是链表。这种结构的优点是您可以重新组合元素而无需在内存中移动它们。例如，您可以拥有一个大型复杂对象的链表并非常快速地交换其中任何两个，因为您确实必须调整两个指针而不是移动这些对象。

这适用于许多语言，包括 Object Pascal (Delphi)。

# java - 受保护/公共内部类

> ID：595179
> 
> 赞同：15
> 
> 时间：2009-02-27T15:17:09.403
> 
> 标签：java, inner-classes, access-modifiers

`protected`有人可以向我解释/`public` **内部**课程有什么区别吗？

我知道`public`内部类是要尽可能避免的（就像在这篇[文章](http://www.onjava.com/pub/a/onjava/excerpt/HardcoreJava_chap06/index.html)中解释的那样）。

但据我所知，使用`protected`或`public`修饰符之间没有区别。

看看这个例子：

```
public class Foo1 {
 public Foo1() { }

 protected class InnerFoo {
  public InnerFoo() {
   super();
  }
 }
} 
```

...

```
public class Foo2 extends Foo1 {
 public Foo2() {
  Foo1.InnerFoo innerFoo = new Foo1.InnerFoo();
 }
} 
```

...

```
public class Bar {
 public Bar() {
  Foo1 foo1 = new Foo1();
  Foo1.InnerFoo innerFoo1 = foo1.new InnerFoo();

  Foo2 foo2 = new Foo2();
  Foo2.InnerFoo innerFoo2 = foo2.new InnerFoo();
 }
} 
```

所有这些都编译并且无论我声明`InnerFoo` `protected`还是`public`.

我错过了什么？请指出一个使用`protected`or有区别的情况`public`。

谢谢。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-27T15:20:01.847

`protected`访问修饰符将限制来自同一包及其子类中的类以外的类的访问。

在显示的示例中，`public`和`protected`将具有相同的效果，因为它们在同一个包中。

有关访问修饰符的更多信息，可能会对[Java 教程的](http://java.sun.com/docs/books/tutorial/index.html)[控制对类成员的访问](http://java.sun.com/docs/books/tutorial/java/javaOO/accesscontrol.html)页面感兴趣。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-22T08:39:33.563

你可以认为受保护的内部类是受保护的成员，所以它只能访问类、包、子类，而不是世界。

此外，对于外部类，它只有两个访问修饰符。只是公开和打包。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-07-16T05:05:13.877

## java中的怪事：

**纯 Java：**您不能从公共 getter返回**私有内部类。**

**在 JSP 中：**您不能从公共 getter返回**非公共内部类。**

* * *

**您可以运行的 Java 演示：**

```
public class ReturnInnerClass{
    public static void main(String []args){
        MyClass inst = new MyClass("[PROP_VAL]");
        System.out.println(

            inst.get().myProperty()

        );;    
    };;
};;

class MyClass{ 
    //:If JSP: MUST be public
    //:Pure Java: 
    //:     public,protected,no-access-modifier
    //:     Will all work.
    //:Private fails in both pure java & jsp.
    protected class Getters{
        public String 
        myProperty(){ return(my_property); }
    };;

    //:JSP EL can only access functions:
    private Getters _get;
    public  Getters  get(){ return _get; }

    private String 
    my_property;

    public MyClass(String my_property){
        super();
        this.my_property    = my_property;
        _get = new Getters();
    };;
};;

//:How to run this example:
//:  1: Put this code in file called: "ReturnInnerClass.java"
//:  2: Put ReturnInnerClass.java into it's own folder.
//:     ( Folder name does not matter.)
//:  3: Open the folder.
//:  4: Right-Click --> GitBashHere
//:  5: In command prompt within folder:
//:     5.1: javac ReturnInnerClass.java
//:     5.2: java  ReturnInnerClass
//:     ( javac: java compiler              )
//:     ( java : runs compiled java program )

//:  EXPECTED OUTPUT:
//:  [PROP_VAL] 
```

* * *

**对于 JSP**，仅将上面的类代码放入文件夹：com/myPackage/MyClass 并将“import com.myPackage.MyClass”作为源代码的第一行。然后使用以下源代码创建一个新的 .jsp 页面：

```
<%@ taglib uri   ="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ page import="com.myPackage.MyClass" %>
<%
    MyClass inst = new MyClass("[PROP_VALUE]");
    pageContext.setAttribute("my_inst", inst ); 
%><html lang="en"><body>
    ${ my_inst.get().myProperty() }
</body></html> 
```

* * *

*使用的堆栈：* **Java8 + Tomcat9**

# orm - ORM 支持处理死锁

> ID：595187
> 
> 赞同：7
> 
> 时间：2009-02-27T15:20:29.303
> 
> 标签：orm, deadlock

你知道任何提供死锁恢复的 ORM 工具吗？我知道死锁是一件坏事，但有时在适当的负载量下任何系统都会受到它的影响。在 Sql Server 中，死锁消息显示“重新运行事务”，因此我怀疑重新运行死锁语句是 ORM 的理想功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-01T19:01:21.970

我不知道有任何特殊的 ORM 工具支持自动重新运行因死锁而失败的事务。但是我不认为 ORM 使处理锁定/死锁问题有很大不同。首先，您应该分析死锁的根本原因，然后以避免或至少减少死锁的方式重新设计事务和查询。有很多改进选项，例如为事务的（部分）选择正确的隔离级别，使用锁定提示等。这更多地取决于您的数据库系统，而不是您的 ORM。当然，如果您的 ORM 允许您将存储过程用于某些微调命令等，这会有所帮助。

如果这无助于完全避免死锁，或者你现在没有时间实施和测试真正的修复，当然你可以简单地在你的保存/提交/持久或任何调用周围放置一个 try/catch，检查如果它们表明失败的事务是“死锁受害者”，则捕获异常，然后在几秒钟的睡眠后简单地调用保存/提交/持久。等待几秒钟是个好主意，因为死锁通常表明事务竞争相同资源的临时高峰，并且一次又一次地快速重新运行相同的事务可能会使事情变得更糟。

出于同样的原因，您可能不会确保只尝试一次以重新运行相同的事务。

在现实世界的场景中，我们曾经实施过这种变通方法，大约 80% 的“死锁受害者”在第二次尝试中成功了。但我强烈建议深入挖掘以解决死锁的实际原因，因为这些问题通常会随着用户数量的增加而呈指数增长。希望有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-01T19:05:12.960

死锁是意料之中的，SQL Server 在这方面似乎比其他数据库服务器更糟糕。首先，您应该尽量减少死锁。尝试使用[SQL Server Profiler](http://msdn.microsoft.com/en-us/library/ms188246.aspx)找出它发生的原因以及您可以做些什么。接下来，如果可能，将您的 ORM 配置为在同一事务中进行更新后不读取。最后，在你这样做之后，如果你碰巧同时使用了 Spring 和 Hibernate，你可以放入一个拦截器来监视这种情况。扩展 MethodInterceptor 并将其放置在您的 Spring bean 中的interceptorNames 下。当拦截器运行时，使用 invocation.proceed() 来执行事务。捕获任何异常，并定义要重试的次数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-03T15:38:54.390

我工作的一个系统是基于“命令”，然后当用户按下保存时，这些“命令”被提交到数据库，它的工作原理是这样的：

```
While(true)
   start a database transaction
   Foreach command to process
      read data the command need into objects
      update the object by calling the command.run method
   EndForeach
   Save the objects to the database
   If not deadlock
     commit the database transaction
    we are done
   Else 
     abort the database transaction
    log deadlock and try again
   EndIf
EndWhile 
```

你可以用任何 ORM 做类似的事情；我们使用了内部数据访问系统，因为当时 ORM 太新了。

当用户与系统交互时，我们在事务之外运行命令。然后像上面那样重新运行它们（当您使用“保存”时）以应对其他人所做的更改。由于我们已经对命令将更改的行有一个很好的理想，我们甚至可以使用锁定提示或“选择更新”来取出我们在事务开始时需要的所有写锁。（我们缩短了要更新的行集以进一步减少死锁的数量）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-04T11:59:41.990

o/r 映射器无法检测到这一点，因为死锁总是在 DBMS 内部发生，这可能是由其他线程或其他应用程序设置的锁引起的。

为确保一段代码不会造成死锁，请始终使用以下规则： - 在事务之外进行获取。因此，首先获取，然后执行处理，然后执行 DML 语句，如插入、删除和更新 - 包含/处理事务的方法或一系列方法中的每个操作都必须使用与数据库的相同连接。这是必需的，因为例如在同一连接上执行的语句会忽略写锁（因为同一连接设置了锁；））。

通常，死锁的发生是因为代码在事务中获取数据导致新连接打开（必须等待锁定），或者对事务中的语句使用不同的连接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-07T10:01:39.923

我快速浏览了一下（毫无疑问你也有），找不到任何暗示 hibernate 至少提供这个的东西。这可能是因为 ORM 认为这超出了他们试图解决的问题的范围。

如果您遇到死锁问题，请务必遵循此处发布的一些建议来尝试解决它们。之后，您只需要确保所有数据库访问代码都包含可以检测死锁并重试事务的东西。

# objective-c - 什么最能描述 Objective-C 和 Cocoa 绑定？

> ID：595188
> 
> 赞同：21
> 
> 时间：2009-02-27T15:20:39.677
> 
> 标签：objective-c, cocoa, cocoa-bindings

我很难理解 Cocoa Bindings。有人能以人类可感知的方式向我解释这一切是什么吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-02-27T17:04:30.770

Bindings 是一个系统，用于将您的视图连接到您的控制器，而无需编写大量胶水代码来使它们显式地相互通信。您所要做的就是在两个类* 中设置属性并在 IB 中连接绑定。

传统的方法是视图有一个或多个出口与控制器对话（最通用的例子是`delegate`and `target`），而控制器有出口与视图对话。当控制器更新模型时，它会发送（例如）`[view modelChange:newModelObject]`. 当视图想要更新模型时，它会向其委托（控制器）发送一些委托消息，例如 NSText 的`textDidChange:`.

使用绑定，您在代码中所要做的就是在视图上实现属性并在控制器上实现属性，然后将视图的一个或多个属性公开为绑定*。然后你只需要连接绑定。如果它是一个 Cocoa 类，这就是小菜一碟：只需在 IB 中设置它。如果它是您自己的自定义类，您可能会`bind:toObject:withKeyPath:options:`自己编写消息（难度不大）。

让我重申一下：使用 Bindings，您的整个胶水代码（大部分时间）都`[view bind:@"viewProperty" toObject:self withKeyPath:@"controllerProperty.modelProperty" options:options];`在控制器中。其他一切都由幕后的绑定和 KVO 系统以及您的属性的访问器处理。

缺点是您必须严格遵守 Cocoa Bindings 的要求。这些很简单，但是许多旧应用程序的设计方式不适合 Cocoa Bindings。

*   您必须创建真实的模型对象，而不仅仅是传递原始对象（例如字典数组）。如果您使用 Core Data，这很容易：您的托管对象是模型对象。
*   您必须正确编写访问器或合成正确的访问器。例如，一个 NSString 属性应该永远是`@property(copy)`, never `@property(retain)`（因为否则，你会发现自己保留了别人的可变字符串，然后他们会在你持有它时改变它）。
*   您*只能*`model.foo = bar`通过它们的属性 ( ) 或访问器消息 ( )更改模型对象的属性`[model setFoo:bar]`，绝不能通过直接实例变量访问。（访问器方法本身的明显例外，如果您已经编写了自己的，因为它们必须直接访问实例变量。）

有两个优点：

*   您可以编写一个全新的视图类，而无需撕掉大量的胶水代码。您最多需要删除的是`bind::::`旧视图属性的一些消息。如果在几年后，您认为您当前的视图无法扩展到您的应用程序即将推出的功能，那么您可以灵活地将其删除并以最小的痛苦重新开始。
*   更重要的是，你必须阅读的代码越少，阅读起来就越容易。

*并且，根据文档，在视图类中实现[KVO 观察方法](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Protocols/NSKeyValueObserving_Protocol/Reference/Reference.html#//apple_ref/occ/instm/NSObject/observeValueForKeyPath:ofObject:change:context:)，但我实际上从来没有这样做过。我提交[了一个文档错误](http://openradar.appspot.com/6588723)。

**添加于 2009-03-07：**啊，找到了引用。“NSView 子类可以通过调用类方法exposeBinding：为每个属性公开额外的键值编码/键值观察兼容属性作为绑定。” —<a href="http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Protocols/NSKeyValueBindingCreation_Protocol/Reference/Reference.html" rel="noreferrer">NSKeyValueBindingCreation 所以你不需要实现一个KVO 观察法。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-03-08T12:53:54.853

以前的答案非常全面和好，我只是想添加一个答案来解释它的核心是什么，而不具体涉及 Cocoa 或 Objective-C。这是因为这个概念本身与语言无关，尽管像 Objective-C 这样的动态语言比像 C++ 这样的静态语言*要*容易得多。

### 例子

假设您有两个对象**M**和**V**。**M**有方法：

```
setX(int x);
setY(int y);
int getX();
int getY(); 
```

虽然**V**有方法：

```
setA(int x);
setB(int y);
int getA();
int getB(); 
```

看待这一点的一种方式是**M**具有属性**x**和**y**并且**V**具有属性**a**和**b**。您希望属性**x**的更改导致属性**b**的更改和**y**的更改导致 a 的**更改**。

通过属性**x**的变化，我们的意思是例如：

```
M.setX(10) 
```

以前在哪里

```
M.getX() != 10 
```

因此，我们希望在**M上调用***setX*以在**V**上调用*setA*。

 *****绑定允许您说的是对象**V上的属性****b**绑定到对象**M**上的属性**x**。然后自动处理此更新。作为编码人员，您不必编写代码来检查**x**是否已更改，然后在**V上调用***setB*。Bindings 会自动处理这个问题。

 *******### 概括

绑定允许您将存在于两个不同对象上的两个属性绑定在一起，以便更改其中一个属性的值会导致另一个对象中的从属属性更改为相同的值。

# javascript - AJAX 评论系统的 Javascript 会是什么样子？

> ID：595193
> 
> 赞同：1
> 
> 时间：2009-02-27T15:22:18.113
> 
> 标签：javascript, ajax

我正在尝试创建一个评论系统，管理员可以通过该系统审核评论，而用户可以在一页加载中发布所有评论。我拥有有关如何删除评论的所有后端知识，但我真的必须知道如何从数据库中加载新评论并显示在当前页面上。

编辑：更具体地说，实际的 javascript 会是什么样子会呈现新的回复？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T15:23:51.103

您需要定期进行 AJAX 调用来轮询服务器以获取新评论。

您应该有浏览器知道的最新答案的日期时间和查询服务器的问题 ID，以优化您的流量。

使用 JQuery：

```
var refreshId = setInterval(function() {
     $.getJSON("http://server.com/form?question=" + questionId + "?time=" + datetimeStamp",
        function(data){
          $.each(data.items, function(i,item){
            $("#comments").append( // new div with content)
          });
        });

}, 3000); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T15:41:39.953

或者您可以避免轮询并让服务器将数据推送到客户端。这就是 GTalk 或 Meebo 通过推送新消息的工作方式。Comet（推送或流数据）支持内置在一些 JavaScript 框架中，例如 Dojo 或 jQuery 插件。

见[http://ajaxian.com/archives/comet-a-new-approach-to-ajax-applications](http://ajaxian.com/archives/comet-a-new-approach-to-ajax-applications) [http://plugins.jquery.com/project/Comet](http://plugins.jquery.com/project/Comet)

# javascript - 创建动态选择（下拉）列表的最佳方式？

> ID：595205
> 
> 赞同：2
> 
> 时间：2009-02-27T15:25:11.350
> 
> 标签：javascript, jquery, list, drop-down-menu, selectlist

我正在使用 jQuery 和 jqGrid。

我正在尝试动态填充一个选择列表，每行一个，我需要向它添加一个点击事件。当填充SELECT列表时，我获取所选项目的索引，然后在添加所有项目之后，我正在尝试设置所选项目。

我试过了

```
$("#taskList")[0].selectedIndex = taskIndex;
$("#taskList").selectOptions(taskIndex, true);
$("#taskList").val(1); //Tried to see if I could select any index and no luck.
$("#taskList option[value=" + taskIndex + "]").attr("selected", true); 
```

所以这意味着我可能错误地填充了列表......

```
var taskList = document.createElement("select");
var taskIndex = 0;
for (var i = 0; i < result.TaskTypes.length; i++) {
   $(taskList).addOption(result.TaskTypes[i].TaskId, result.TaskTypes[i].TaskName);
   if (result.TaskTypes[i].TaskName == rowData.TaskType)
    taskIndex = i;
} 
```

有没有更好的办法？

我试过这个，但我无法向它添加点击事件。虽然选择了正确的项目。

```
var taskList = "<select name='taskList' Enabled='true'>";
for (var i = 0; i < result.TaskTypes.length; i++) {
    if (result.TaskTypes[i].TaskName == rowData.TaskType)
        taskList += "<option selected> " + result.TaskTypes[i].TaskName + "</option>";
    else
    taskList += "<option>" + result.TaskTypes[i].TaskName + "</option>";
}
taskList += "</select>"; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T15:33:02.080

我会这样做的方式是在您的第一个示例中 - 而不是使用 jQuery API 进行 addOption，而是使用 DOM API，如下所示：

```
var option = document.createElement("option");
option.innerHTML = result.TaskTypes[i].TaskName;
option.value = result.TaskTypes[i].TaskId;
option.onclick = myClickHandler;
taskList.add(option, null); 
```

然后在循环之后你可以使用：

```
taskList.selectedIndex = taskIndex; 
```

将选择列表定位到所需的默认选择。

我没有广泛使用 jQuery，但我认为不要忽视 DOM API 是个好主意——它通常不如 jQuery 和其他库提供的快捷方式方便，但是这些扩展了 DOM 功能并且不应该代替 DOM .

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T15:31:57.637

属于“更好的方式”类别，JQuery 允许您使用[each 循环](http://docs.jquery.com/Each)而不是手动创建 for 循环。

```
jQuery.each(result.TaskTypes, function(i, val) {
      $("#" + i).append(document.createTextNode(" - " + val));
    }); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T15:34:07.680

您可以像这样设置选定的索引：

```
$("#taskList").selectedIndex = taskIndex; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T20:26:29.597

明白了 - 8 小时后很好。

```
var taskList = "<select name='taskList' Enabled='true' onClick='$(\"#hoursBx\").valid()' >";
for (var i = 0; i < result.TaskTypes.length; i++) {
    if (result.TaskTypes[i].TaskName == rowData.TaskType)
        taskList += "<option selected> " + result.TaskTypes[i].TaskName + "</option>";
    else
        taskList += "<option>" + result.TaskTypes[i].TaskName + "</option>";
}
taskList += "</select>"; 
```

我正在使用[jQuery 的验证器](http://bassistance.de/jquery-plugins/jquery-plugin-validation/)来验证 $("#hoursBx") （当前行中的文本框）中的值。

添加 onClick 作品。

# vb.net - {} 嵌套的 VB.NET 等效项

> ID：595207
> 
> 赞同：3
> 
> 时间：2009-02-27T15:26:00.070
> 
> 标签：vb.net, scope

VB.NET 在 C 类型语言中是否有像 {} 这样的范围嵌套运算符？

示例 C++ 类型代码：

```
 int i;
i = 0;
{
  int i;
  i++;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T15:36:34.380

您可以使用空[`With`块](http://msdn.microsoft.com/en-us/library/wc500chb.aspx)：

```
With Nothing

    Dim x = 1

    Console.WriteLine("X = " + x.ToString())

End With

' ERROR! x is out of scope at this point. '
Console.WriteLine(x) 
```

由于`With`它只是一种语法糖，它可能比使用循环语句更好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T15:29:52.963

不，VB.Net 没有这样的总括范围修饰符。您可以使用如下所示的空循环来模拟它们。

```
Loop
  ...
Until False 
```

但是，它仍然不允许您重新定义具有相同名称的变量。在 VB.Net（和 C#）中，在嵌套作用域中定义与外部作用域中的变量同名的变量是不合法的。

# .net - 如何在 nHibernate 中对祖父母应用过滤器？

> ID：595215
> 
> 赞同：0
> 
> 时间：2009-02-27T15:28:17.350
> 
> 标签：.net, nhibernate, filter

我有一个关于 nHibernate 和过滤的问题。我正在使用 nHibernate 2.2，但我认为这将适用于早在 1.2 的版本。

我创建了一个简单的例子来说明这个问题。我有三个域对象：国家、州和城市（假设数据库表与域匹配并定义了适当的关系。我想使用 nHibernate 过滤器选择属于特定国家的城市。我相信我已经设置了正确过滤并且按状态（父级）过滤效果很好。

我在下面包含了域模型和我的 nHibernate 映射。我的查询是一个简单的 HQL 语句：`select f from city f`

```
Country
 CountryId int
 Name      string
 States    list

State
  StateId   int
  Name      string
  Country   object
  Cities    list
City
  CityId    int
  Name      string
  State     object 
```

nHibernate 映射：

```
 <?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" assembly="CMDB.Model" namespace="CMDB.Model">
  <class name="Country" table="Country" lazy="false">
    <id name="CountryId" type="int" unsaved-value="0">
      <generator class="identity" />
    </id>
    <property name="Name" type="string"/>
    <bag name="States" table="State" inverse="true" lazy="false" cascade="all-delete-orphan">
      <key column="StateId"/>
      <many-to-many class="State" column="StateId"/>
      <filter name="ByCountry" condition=":CountryId = CountryId"/>
    </bag>
  </class>
  <class name="State" table="State" lazy="false">
    <id name="StateId" type="int" unsaved-value="0">
      <generator class="identity" />
    </id>
    <property name="Name" type="string"/>
    <many-to-one name="Country" column="CountryId" class="Country" lazy ="false" />
    <bag name="Cities" table="City" inverse="true" lazy="false" cascade="all-delete-orphan">
      <key column="CityId"/>
      <many-to-many class="City" column="CityId"/>
      <filter name="ByState" condition=":StateId = StateId"/>
    </bag>
    <filter name="ByCountry" condition=":CountryId = CountryId"/>
  </class>
  <class name="City" table="City" lazy="false">
    <id name="CityId" type="int" unsaved-value="0">
      <generator class="identity" />
    </id>
    <property name="Name" type="string"/>
    <many-to-one name="State" column="StateId" class="State" lazy ="false" />
    <filter name="ByState" condition=":StateId = StateId"/>
  </class>
  <filter-def name="ByCountry">
    <filter-param name="CountryId" type="int"/>
  </filter-def>
  <filter-def name="ByState">
    <filter-param name="StateId" type="int"/>
  </filter-def>
</hibernate-mapping> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-13T14:09:09.710

我花了很多时间研究这个并确定 nHibernate 不会应用嵌套过滤器。解决方案是以编程方式处理问题并从父级开始，返回一个过滤列表，然后构建一个属于过滤后的父级的所有子级的列表。

因此，在我的示例中，我将加载属于特定国家/地区的所有州，然后构建州子城市的列表。

# c++ - 用于拆分搜索短语的正则表达式

> ID：595216
> 
> 赞同：1
> 
> 时间：2009-02-27T15:29:00.390
> 
> 标签：c++, regex, boost

我希望有人可以帮助我为 c++ 编写一个匹配搜索短语中的单词的正则表达式，并为学习目的一点一点地解释它。

我需要的是一个正则表达式，它匹配 like 中的字符串`" "`，以及以like /`"Hello you all"`开头/结尾的单个单词。`*``*ack``overfl*`

对于我有的报价部分，`\"[\^\\s][\^\"]*\"`但我无法弄清楚通配符 ( `*`) 部分，以及我应该如何将它与报价正则表达式结合起来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T15:35:50.420

只要没有引用嵌套（嵌套通常是正则表达式不擅长的）：

```
"(?:(?<=\\)"|[^"])*"|\*[^\s]+|[^\s]+\* 
```

`'\"'`但是，如果您需要，此正则表达式允许转义双引号 ( )。并且匹配包括封闭的双引号。

此正则表达式匹配：

*   `"A string in quotes, possibly containing \"escaped quotes\""`
*   `*a_search_word_beginning_with_a_star`
*   `a_search_word_ending_with_a_star*`
*   `*a_search_word_enclosed_in_stars*`

**请注意**，它会在这样的字符串处中断：

*   `A broken \"string "with the quotes all \"mangled up\""`

如果您期望（阅读：*不能完全排除这种可能性*）得到这些，请不要使用正则表达式，而是编写一个小的引号感知解析器。对于一次性搜索和替换活动或*保证*格式的输入，可以使用正则表达式。

对于验证/解析用户输入，不能使用。那就是我推荐解析器的地方。了解差异是关键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T15:42:45.380

试试这个正则表达式：

```
(?:\*?\w+\*?|"(?:[^\x5C"]+|\x5C(?:\x5C\x5C)*")*")+ 
```

为了便于阅读，我将反斜杠字符替换为`\x5C`.

该表达式`"(?:[^\x5C"]+|\x5C(?:\x5C\x5C)*")*"`还将匹配`"foo \"bar\""`其他正确的转义引号序列（但只有`"`可能被转义）。

所以`foo* bar *baz *quux* "foo \"bar\""`应该拆分成：

*   `foo*`
*   `bar`
*   `*baz`
*   `*quux*`
*   `"foo \"bar\""`

如果您不想`bar`在上面的示例中匹配，请使用：

```
(?:\*\w+|\w+\*|"(?:[^\x5C"]+|\x5C(?:\x5C\x5C)*")*")+ 
```

# java - Java JDBC 驱动程序和 TYPE_FORWARD_ONLY

> ID：595222
> 
> 赞同：0
> 
> 时间：2009-02-27T15:30:51.977
> 
> 标签：java, jdbc

我如何确定 JDBC 驱动程序是否是`TYPE_FORWARD_ONLY`？在我的程序中，用户配置到数据库的连接参数，他可以在类路径中使用任何 JDBC 驱动程序。我想知道驱动程序是否`TYPE_FORWARD_ONLY`在执行任何语句之前。这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T16:03:11.057

DatabaseMetaData 有一个方法 supportsResultSetType(int type) 可以用来检查 ResultSet 是否支持`TYPE_FORWARD_ONLY`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T16:03:01.073

通过[查询](http://java.sun.com/j2se/1.4.2/docs/api/java/sql/ResultSet.html#getType())结果集的类型。例如：

```
Statement stmt = con.createStatement(
 ResultSet.TYPE_FORWARD_ONLY,
 ResultSet.CONCUR_UPDATABLE
);
ResultSet rs = stmt.executeQuery("SELECT a, b FROM TABLE2");
System.out.println(
 "Is Type Forward Only: " + 
 (rs.getType() == ResultSet.TYPE_FORWARD_ONLY)
); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T15:56:59.527

有不支持滚动的驱动程序？你能举个例子吗？当您尝试创建 SCROLL_SENSITIVE 的 Statement/ResultSet 然后询问类型时，这样的驱动程序会返回什么？像这样：

```
Connection con = ...;
Statement statement = con.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE, ...);
System.out.println(statement.getResultSetType()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T16:00:20.033

您可以从驱动程序中获取 DriverPropertyInfo，尽管我找不到描述驱动程序必须返回的内容的特定 jdbc 规范。[这个参考](http://www.springerlink.com/content/p2374356534h0783/)可能有更多。

# wpf - 你可以在 WPF 中将 VisualStateManager 换成 MultiTrigger 吗？

> ID：595223
> 
> 赞同：1
> 
> 时间：2009-02-27T15:31:06.767
> 
> 标签：wpf, silverlight, wpftoolkit, visualstatemanager, multitrigger

这实际上与创建一个可跨 WPF 和 Silverlight 工作的库有关。[WPF Toolkit](http://wpf.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=22567)包含 Silverlight 中包含的 VisualStateManager 的实现，如果 VisualStateManager 可以完成 WPF 中的 MultiTrigger 所做的事情，那么这就解决了我的问题。

我刚刚[在 MSDN 博客上找到了一篇讨论 VisualStateManager 和 Triggers 使用的文章](http://blogs.msdn.com/wpfsdk/archive/2009/02/27/the-visualstatemanager-and-triggers.aspx)，但我仍然不确定 VisualStateManager 是否可以用作 MultiTriggers 的替代品。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-03-06T21:31:48.150

VisualStateManager 不能完全替代 WPF 的 MultiTrigger。WPF 的 MultiTrigger 具有对条件的内置支持。VisualStateManager 仅支持状态。虽然状态乍一看似乎是条件，但这并不完全正确。例如，在 WPF 中，您可以使用仅在 Button 的内容显示“OK”时运行的 MultiTrigger。但是，这并不是真正的按钮状态，因此，VisualStateManager 不能在这种情况下使用。

我希望这会有所帮助，Chad Campbell - Silverlight 2 in Action 的作者

# content-management-system - 在 configuration.php 中找不到 mosConfig_absolute_path

> ID：595225
> 
> 赞同：0
> 
> 时间：2009-02-27T15:31:22.177
> 
> 标签：content-management-system, joomla, website-hosting

我正在尝试将我的 Joomla1 网站从 localhost 移动到我的 bluehost.com 域。为了测试，我在我的域上创建了一个子目录进行测试并移动了我所有的 Joomla！文件到这个。我在 public_html 文件夹下创建了这个子目录。

我在首页（自定义页面）和其余页面上使用不同的菜单。我的问题是首页上的菜单项正在查找名为**joomla**的子目录中的页面，而不是在我的子目录中查找页面（**测试**）

根据一些网站的建议，我认为更改**mosConfig_absolute_path会有所帮助，但我在****testing**子目录中的 configuration.php 文件没有名为 mosConfig_absolute_path 的属性。我在其他页面上的任何菜单项上都没有遇到这个问题。

有人可以帮我解决这个问题以及我应该如何克服它。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T17:29:17.840

您正在谈论的变量是`$mosConfig_absolute_path`而不是`$msConfig_absolute_path`. 您还需要重置`$mosConfig_live_site`.

此外，迁移到 Joomla！1.5 将完全避免这个问题；它会自动检测您的基本路径和 URL。

# javascript - 如何使用 JavaScript 删除所有 cookie？

> ID：595228
> 
> 赞同：75
> 
> 时间：2009-02-27T15:32:01.880
> 
> 标签：javascript, cookies

我编写了代码以在 JavaScript 中保存 cookie。现在我需要清除 cookie，而不管我分配的值如何。

[是否有任何脚本模块可以删除由Javascript](http://en.wikipedia.org/wiki/JavaScript)生成的所有 cookie ？

### 我的示例代码：

```
document.cookie = 'ppkcookie2=another test; expires=Fri, 3 Aug 2001 20:47:11 UTC; path=/'

function createCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function eraseCookie(name) {
    createCookie(name,"",-1);
} 
```

我还能如何清除所有的 cookie？

当我在网络服务器上测试代码时会不会有任何问题？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2010-03-11T00:41:25.660

没有 100% 的解决方案可以删除浏览器 cookie。

问题在于，cookie 不仅由它们的键“名称”唯一标识，而且由它们的“域”和“路径”唯一标识。

在不知道 cookie 的“域”和“路径”的情况下，您无法可靠地删除它。此信息无法通过 JavaScript 的`document.cookie`. 它也不能通过 HTTP Cookie 标头获得！

但是，如果您知道 cookie 的名称、路径和域，则可以通过设置一个过期日期为过去的空 cookie 来清除它，例如：

```
function clearCookie(name, domain, path){
    var domain = domain || document.domain;
    var path = path || "/";
    document.cookie = name + "=; expires=" + +new Date + "; domain=" + domain + "; path=" + path;
}; 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2009-02-27T15:37:35.440

从表面上看，它看起来不错 - 如果您调用`eraseCookie()`从 读取的每个 cookie `document.cookie`，那么您所有的 cookie 都将消失。

**试试这个：**

```
var cookies = document.cookie.split(";");
for (var i = 0; i < cookies.length; i++)
  eraseCookie(cookies[i].split("=")[0]); 
```

所有这些都带有以下警告：

*   JavaScript***无法***删除设置了**[HttpOnly](https://en.wikipedia.org/wiki/HTTP_cookie#Secure_and_HttpOnly)**标志的 cookie。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-19T06:39:34.010

这是我们在应用程序中使用的功能，它运行良好。

删除cookie：无参数方法

```
function clearListCookies()
{   
    var cookies = document.cookie.split(";");
    for (var i = 0; i < cookies.length; i++)
    {   
        var spcook =  cookies[i].split("=");
        deleteCookie(spcook[0]);
    }
    function deleteCookie(cookiename)
    {
        var d = new Date();
        d.setDate(d.getDate() - 1);
        var expires = ";expires="+d;
        var name=cookiename;
        //alert(name);
        var value="";
        document.cookie = name + "=" + value + expires + "; path=/acc/html";                    
    }
    window.location = ""; // TO REFRESH THE PAGE
} 
```

编辑：这将通过将 cookie 设置为昨天的日期来删除它。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-08-13T14:04:29.313

为什么使用新日期而不是静态 UTC 字符串？

```
 function clearListCookies(){
    var cookies = document.cookie.split(";");
        for (var i = 0; i < cookies.length; i++){   
            var spcook =  cookies[i].split("=");
            document.cookie = spcook[0] + "=;expires=Thu, 21 Sep 1979 00:00:01 UTC;";                                
        }
    } 
```

# user-interface - 状态机和用户界面工作——任何例子/经验？

> ID：595231
> 
> 赞同：32
> 
> 时间：2009-02-27T15:33:13.563
> 
> 标签：user-interface, finite-automata

我正在寻找对前端小部件代码进行去spaghttify 的方法。有人建议有限状态机是思考我在做什么的正确方法。我知道状态机范式几乎*可以*应用于任何问题。我想知道是否有一些经验丰富的 UI 程序员真正养成了这种习惯。

所以，问题是——你们中的任何一个 UI 程序员在你的工作中是否考虑到状态机？如果是这样，怎么做？

谢谢，-摩根

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-27T16:07:18.487

我目前正在使用一个（专有）框架，该框架非常适合 UI-as-state-machine 范例，它肯定可以减少（但不能消除）UI 元素之间复杂和不可预见的交互问题。

主要好处是它允许您以更高的抽象层次、更高的粒度进行思考。与其认为“如果按下按钮 A 则组合框 B 被锁定，文本字段 C 被清除并且按钮 D 被解锁”，而是认为“按下按钮 A 将应用程序置于 CHECKED 状态” - 进入该状态意味着某些事情发生。

不过，我认为将整个 UI 建模为单个状态机是没有用的（甚至是不可能的）。相反，通常有许多较小的状态机，每个状态机处理 UI 的一部分（由几个在概念上交互并属于一起的控件组成），以及一个（可能不止一个）处理更基本问题的“全局”状态机。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-27T17:14:16.487

状态机通常太低级，无法帮助您考虑用户界面。它们为 UI 工具包提供了一个不错的实现选择，但是在普通应用程序中要描述的状态和转换太多，您无法手动描述它们。

我喜欢考虑具有延续性的 UI。（谷歌一下——这个词足够具体，你会得到很多高质量的点击。）

我的应用程序不是处于由状态标志和模式表示的各种状态，而是使用延续来控制应用程序接下来要做什么。用一个例子来解释是最容易的。假设您想在发送电子邮件之前弹出一个确认对话框。第 1 步构建电子邮件。第 2 步得到确认。步骤 3 发送电子邮件。大多数 UI 工具包都要求您在每个步骤之后将控制权传递回事件循环，如果您尝试使用状态机来表示它，这会变得非常丑陋。使用 continuation，您不必考虑工具包强加给您的步骤——它只是构建和发送电子邮件的一个过程。但是，当流程需要确认时，您可以继续捕获应用程序的状态，并将该继续传递给确认对话框上的 OK 按钮。按下确定时，

延续在编程语言中相对较少，但幸运的是，您可以使用闭包获得某种穷人的版本。回到电子邮件发送示例，此时您需要确认您将流程的其余部分编写为闭包，然后将该闭包交给 OK 按钮。闭包有点像匿名嵌套子例程，在下次调用它们时记住所有局部变量的值。

希望这能给你一些新的思考方向。我稍后会尝试用真实的代码回来向您展示它是如何工作的。

*更新：这是 Ruby 中 Qt 的完整示例。有趣的部分在 ConfirmationButton 和 MailButton 中。我不是 Qt 或 Ruby 专家，所以我很感激你们能提供的任何改进。*

```
require 'Qt4'

class ConfirmationWindow < Qt::Widget
  def initialize(question, to_do_next)
    super()

    label = Qt::Label.new(question)
    ok = ConfirmationButton.new("OK")
    ok.to_do_next = to_do_next
    cancel = Qt::PushButton.new("Cancel")

    Qt::Object::connect(ok, SIGNAL('clicked()'), ok, SLOT('confirmAction()'))
    Qt::Object::connect(ok, SIGNAL('clicked()'), self, SLOT('close()'))
    Qt::Object::connect(cancel, SIGNAL('clicked()'), self, SLOT('close()'))

    box = Qt::HBoxLayout.new()
    box.addWidget(label)
    box.addWidget(ok)
    box.addWidget(cancel)

    setLayout(box)
  end
end

class ConfirmationButton < Qt::PushButton
  slots 'confirmAction()'
  attr_accessor :to_do_next
  def confirmAction()
    @to_do_next.call()
  end
end

class MailButton < Qt::PushButton
  slots 'sendMail()'
  def sendMail()
    lucky = rand().to_s()
    message = "hello world. here's your lucky number: " + lucky
    do_next = lambda {
      # Everything in this block will be delayed until the
      # the confirmation button is clicked. All the local
      # variables calculated earlier in this method will retain
      # their values.
      print "sending mail: " + message + "\n"
    }
    popup = ConfirmationWindow.new("Really send " + lucky + "?", do_next)
    popup.show()
  end
end

app = Qt::Application.new(ARGV)

window = Qt::Widget.new()
send_mail = MailButton.new("Send Mail")
quit = Qt::PushButton.new("Quit")

Qt::Object::connect(send_mail, SIGNAL('clicked()'), send_mail, SLOT('sendMail()'))
Qt::Object::connect(quit, SIGNAL('clicked()'), app, SLOT('quit()'))

box = Qt::VBoxLayout.new(window)
box.addWidget(send_mail)
box.addWidget(quit)

window.setLayout(box)
window.show()
app.exec() 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-27T16:45:18.070

不是 UI 需要被建模为状态机；显示的对象有助于建模为状态机。然后，您的 UI 变成（过度简化）一堆事件处理程序，用于更改各种对象的状态。

这是一个变化：

```
DoSomethingToTheFooObject();  
UpdateDisplay1();  // which is the main display for the Foo object  
UpdateDisplay2();  // which has a label showing the Foo's width,
                   // which may have changed  
... 
```

至：

```
Foo.DoSomething();  

void OnFooWidthChanged() { UpdateDisplay2(); }  
void OnFooPaletteChanged() { UpdateDisplay1(); } 
```

从客户端 UI 端和服务器 Foo 端考虑您正在显示的数据中的哪些更改应该会导致重新绘制可以澄清。

如果您发现，在 Foo 的状态更改时可能需要重新绘制的 100 个 UI 事物中，所有这些都必须在调色板更改时重新绘制，但当宽度更改时只有 10 个，它可能会提示有关哪些事件/状态的信息更改 Foo 应该发出信号。如果您发现您有一个大型事件处理程序 OnFooStateChanged() 来检查 Foo 的许多属性以查看发生了什么变化，以尝试最小化 UI 更新，它暗示了 Foo 事件模型的粒度。如果你发现你想编写一个小的独立 UI 小部件，你可以在 UI 中的多个位置使用，但它需要知道 Foo 何时更改，并且你不想包含 Foo 的实现带来的所有代码，它建议您的数据相对于您的 UI 的组织，**是**您的表示层，比“我的表单类中的所有代码”更严重。

-个人电脑

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-07-01T08:50:27.300

有一本关于这个主题的书。可悲的是，它绝版了，稀有的二手货*非常*昂贵。

```
Constructing the User Interface with Statecharts
by Ian Horrocks, Addison-Wesley, 1998 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-07-20T14:45:45.187

我们只是在谈论 Horrocks 的*使用状态图构建用户界面，*二手价格从 250 美元到近 700 美元不等。我们的软件开发经理将其评为他所拥有的最重要的书籍之一（遗憾的是，他住在世界的另一端）。

Samek 的状态图书籍从这项工作中汲取了很多灵感，尽管领域略有不同，据报道并不那么清晰。“[嵌入式系统的 C/C++ 事件驱动编程中的实用 UML 状态图](https://rads.stackoverflow.com/amzn/click/com/0750687061)”也可在[Safari](http://my.safaribooksonline.com/book/software-engineering-and-development/uml/9780750687065)上找到。

Horrocks 被大量引用 - ACM 门户上有[20 篇论文，所以如果您可以访问那里，您可能会发现一些有用的东西。](http://portal.acm.org/citation.cfm?id=520870)

有一本书和软件[FlashMX for Interactive Simulation](http://www.flashsim.com/flash_simulation_book.html)。他们有一个关于状态图的 PDF[示例章节。](http://www.flashsim.com/pubDown/chaps/2667-ch07.pdf)

[带有 UML 的对象、组件和框架：催化（SM）方法](https://rads.stackoverflow.com/amzn/click/com/0201310120)有一章是关于行为模型的，其中包括大约十页使用状态图的有用示例（我注意到它可以非常便宜地获得二手货）。这是相当正式和沉重的，但该部分很容易阅读。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-27T15:44:11.477

老实说，这并不是真正的 UI 问题。

我会做以下事情：

1.  定义你的状态
2.  定义您的转换 - 哪些状态可以从其他哪些状态访问？
3.  这些转换是如何触发的？有哪些事件？
4.  编写您的状态机 - 存储当前状态，接收事件，如果该事件可以导致当前状态的有效转换，则相应地更改状态。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-10-01T07:18:40.330

我得到了一个关于我称之为“状态优先”的模式的预演。

它是 MPV/IoC/FSM 的组合，我已经在 .Net/WinForms、.Net/Silverlight 和 Flex（目前）中成功使用了它。

您首先对 FSM 进行编码：

```
class FSM
    IViewFactory ViewFactory;
    IModelFactory ModelFactory;
    Container Container; // e.g. a StackPanel in SL
    ctor((viewFactory,modelFactory,container) {
        ...assignments...
        start();
    }

    start() {
        var view = ViewFactory.Start();
        var model = ModelFactory.Start();
        view.Context = model;
        view.Login += (s,e) => {
            var loginResult = model.TryLogin(); // vm contains username/password now
            if(loginResult.Error) {
                // show error?
            } else {
                loggedIn(loginResult.UserModel); // jump to loggedIn-state
            }
        };
        show(view);
    }

    loggedIn(UserModel model) {
        var view = ViewFactory.LoggedIn();
        view.Context = model;
        view.Logout += (s,e) => {
            start(); // jump to start
        };
        show(view);
    } 
```

接下来你创建你的 IViewFactory 和 IModelFactory（你的 FSM 可以很容易地看到你需要什么）

```
public interface IViewFactory {
    IStartView Start();
    ILoggedInView LoggedIn();
}

public interface IModelFactory {
    IStartModel Start();
} 
```

现在您需要做的就是实现`IViewFactory`、`IModelFactory`、`IStartView`和`ILoggedInView`模型。这里的优点是您可以看到 FSM 中的所有转换，您可以在视图/模型之间获得超低耦合、高可测试性以及（如果您的语言允许）安全的大量类型。

使用 FSM 的一个重要点是，您不应该只是在状态之间跳转 - 您还应该在跳转时携带所有有状态的数据（作为参数，见`loggedIn`上文）。这将帮助您避免通常会乱扔 gui 代码的全局状态。

[您可以在http://prezi.com/bqcr5nhcdhqu/](http://prezi.com/bqcr5nhcdhqu/)上观看演示文稿，但目前不包含代码示例。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-27T15:37:59.870

呈现给用户的每个界面项都可以从当前状态进入另一种状态。您基本上需要创建一个地图，说明哪些按钮可以导致哪些其他状态。

此映射将允许您查看未使用的状态或多个按钮或路径可以导致相同状态而没有其他状态（可以组合的状态）的状态。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-27T16:12:32.703

嘿 Morgan，我们正在 Radical 在 AS3 中构建自定义框架，并使用状态机范例来支持任何前端 UI 活动。

我们为所有按钮事件、所有显示事件等设置了状态机。

AS3 作为一种事件驱动的语言，使它成为一个非常有吸引力的选择。

当某些事件被捕获时，按钮/显示对象的状态会自动改变。

拥有一组通用的状态绝对可以帮助你的代码去spaghttify！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-27T16:17:01.117

状态机是允许代码与其他状态机一起工作的东西。状态机只是具有过去事件记忆的逻辑。

因此，人类是状态机，他们通常希望他们的软件能够记住他们过去所做的事情，以便他们能够继续。

例如，您可以将整个调查放在一个页面上，但人们更愿意使用多个较小页面的问题。与用户注册相同。

所以状态机对用户界面有*很多适用性。*

但是，在部署它们之前应该理解它们，并且在编写代码之前必须完成整个设计 - 状态机可以，现在并且将会被滥用，如果你不知道为什么要使用它一，目标是什么，你最终可能会比其他技术更糟糕。

-亚当

# c# - 您如何指定传递属于特定接口的类型？

> ID：595232
> 
> 赞同：2
> 
> 时间：2009-02-27T15:33:14.123
> 
> 标签：c#, .net, .net-2.0

我有一个方法，我希望有一个类型的参数，但具有某个接口。

例如：

```
public static ConvertFile(Type fileType) 
```

我可以在其中指定 fileType 继承 IFileConvert。

这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T15:35:53.383

一种选择是泛型：

```
public static ConvertFile<T>() where T : IFileConvert
{
     Type type = typeof(T); // if you need it
} 
```

并调用：

```
ConvertFile<SomeFileType>(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T15:35:51.420

不，这是不可能的。但是你可以这样做：

```
public static void ConvertFile<T>() where T : IFileConvert {
   Type fileType = typeof(T);
} 
```

反而。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T15:37:11.227

如果你想在编译时强制执行，泛型是唯一的方法：

```
public static ConvertFile<T>(T fileType)
    where T : IFileType 
```

要在运行时检查，您可以执行以下操作：

```
Debug.Assert(typeof(IFileType).IsAssignableFrom(fileType)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T15:35:48.377

你不能这样做：

```
public static ConvertFile(IFileConvert fileType) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T15:41:52.230

扩展马克的答案。他是对的，没有泛型就无法在编译时强制执行。如果您不能或不想使用泛型，您可以添加运行时检查，如下所示。

```
public static void ConvertFile(Type type) {
  if ( !typeof(IFileType).IsAssignableFrom(type)) {
    throw new ArgumentException("type");
  }
  ...
} 
```

# sql - 如何找到每个客户的重复订单？

> ID：595242
> 
> 赞同：1
> 
> 时间：2009-02-27T15:35:48.690
> 
> 标签：sql

如何查询我的 SQL 数据库并找到客户多次订购的所有重复订单？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T15:40:13.077

不是一个非常清楚的问题，但我明白了它的要点。我不知道您的数据库是什么样的，但您的查询看起来像这样：

```
SELECT customer_id, count(*) FROM orders
GROUP BY customer_id
HAVING count(*) > 1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T15:41:23.807

```
SELECT customerId, productId, count(productId) 
FROM CustomerOrders 
GROUP BY customerId 
HAVING count(productId) > 1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T15:54:43.090

一个平台，版本会有所帮助。样本表也是如此。所以这是一个示例订单表：

```
SQL> select * from orders;

   CUST_ID   ORDER_ID ORDER_DAT
---------- ---------- ---------
     1      1 25-FEB-09
     1      2 24-FEB-09
     1      3 23-FEB-09
     2      4 24-FEB-09
     2      5 23-FEB-09
     2      6 22-FEB-09
     3      7 23-FEB-09
     9      8 22-FEB-09
     9      9 21-FEB-09
     4     10 22-FEB-09
     4     11 21-FEB-09
     4     12 20-FEB-09
     5     13 21-FEB-09
     5     14 20-FEB-09
     5     15 19-FEB-09
     6     16 20-FEB-09
    11     17 19-FEB-09
    10     18 18-FEB-09
     7     19 19-FEB-09
     7     20 18-FEB-09
     7     21 17-FEB-09
     8     22 18-FEB-09
     8     23 17-FEB-09
     8     24 16-FEB-09

24 rows selected. 
```

以下选择适用于此表以获得简单的输出：

```
 1* select cust_id, count(*) from orders group by cust_id having count(*) > 1
SQL> /

   CUST_ID   COUNT(*)
---------- ----------
     1      3
     2      3
     4      3
     5      3
     8      3
     7      3
     9      2

7 rows selected. 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-27T15:42:07.533

您可以为它使用[Select Distinct](http://www.sql-tutorial.com/sql-distinct-sql-tutorial/)。

# erlang - 有没有更简单的方法来修改 Erlang 的 subsubsub 记录字段中的值？

> ID：595247
> 
> 赞同：3
> 
> 时间：2009-02-27T15:36:37.313
> 
> 标签：erlang, records

所以我有一个相当深的记录定义层次结构：

```
-record(cat,            {name = '_',           attitude = '_',}).
-record(mat,            {color = '_',          fabric = '_'}).
-record(packet,         {cat = '_',            mat = '_'}).
-record(stamped_packet, {packet = '_',         timestamp = '_'}).
-record(enchilada,  {stamped_packet = '_', snarky_comment = ""}). 
```

现在我有一个辣酱玉米饼馅，我想做一个和它一样的新辣酱玉米饼馅，除了其中一个子子子记录的值。这就是我一直在做的事情。

```
update_attitude(Ench0, NewState)
  when is_record(Ench0, enchilada)->

    %% Pick the old one apart.
    #enchilada{stamped_packet     = SP0} = Ench0,
    #stamped_packet{packet = PK0} = SP0,
    #packet{cat = Tag0}    = PK0,

    %% Build up the new one.
    Tude1 = Tude0#cat{attitude = NewState},
    PK1 = PK0#packet{cat = Tude1},
    SP1 = SP0#stamped_packet{packet = PK1},

    %% Thank God that's over.
    Ench0#enchilada{stamped_packet = SP1}. 
```

光是*想想*就很痛苦。有没有更好的办法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T18:33:59.323

正如 Hynek 建议的那样，您可以省略临时变量并执行以下操作：

```
update_attitude(E = #enchilada{stamped_packet = (P = #packet{cat=C})},
                NewAttitude) ->
    E#enchilada{stamped_packet = P#packet{cat = C#cat{attitude=NewAttitude}}}. 
```

[Yariv Sadan](http://yarivsblog.com)对同样的问题感到沮丧，并编写了[Recless](http://code.google.com/p/recless)，[这是一种类型推断解析转换的记录](http://yarivsblog.com/articles/2006/10/11/recless-a-type-inferring-parse-transform-for-erlang-experimental/)，它允许您编写：

```
-compile({parse_transform, recless}).

update_attitude(Enchilada = #enchilada{}, Attitude) ->
    Enchilada.stamped_packet.packet.cat.attitude = Attitude. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T17:58:15.617

试试这个：

```
update_attitude(E = #enchilada{
    stamped_packet = (SP = #stamped_packet{
      packet = (P = #packet{
        cat = C
    })})}, NewState) ->
    E#enchilada{
      stamped_packet = SP#stamped_packet{
        packet = P#packet{
          cat = C#cat{
            attitude = NewState
    }}}}. 
```

无论如何，结构并不是 Erlang 最强大的部分。

# c# - LINQ to SQL - 更新部分类中的数据上下文对象

> ID：595248
> 
> 赞同：1
> 
> 时间：2009-02-27T15:36:42.883
> 
> 标签：c#, sql, sql-server, linq, linq-to-sql

我创建了一种可扩展性方法，用于删除我的 Linq To Sql 对象之一，称为 Reservation。

好吧，在我创建的这个部分方法中，我想更新一些其他对象。我似乎无法将更新保存在数据库中。这是我删除预订的部分方法。

```
public partial class LawEnforcementDataContext
{

    partial void DeleteReservation(Reservation instance)
    {
        // Get ID's of those seated in course
        var roster = new Roster(this, instance.CourseID);
        var seated = from r in roster.All
                     where r.WaitingList == false
                     select r.ID;

        // delete the reservation
        this.ExecuteDynamicDelete(instance);

        // get seated id's not in original seated ids
        var newlySeated = from r in roster.All
                          where r.WaitingList == false && !seated.Contains(r.ID)
                          select r.ID;

        var reservations = this.Reservations.Where(r => newlySeated.Contains(r.ID));

        foreach (var r in reservations)
        {
            r.Confirmed = false;
            // Have tried doing nothing, thinking calling code's db.SubmitChanges() would do the trick
            //this.ExecuteDynamicUpdate(r); HAVE TRIED THIS
        }
        //this.SubmitChanges(); HAVE TRIED THIS
    }
} 
```

正在删除，但没有更新。最后几行评论的是我尝试过的一些事情。

有任何想法吗？谢谢！

**编辑**

这是我为解决此问题所做的工作：

```
 public override void SubmitChanges(System.Data.Linq.ConflictMode failureMode)
{
    ChangeSet delta = GetChangeSet();

    foreach (var res in delta.Deletes.OfType<Reservation>())
    {
        // Get ID's of those seated in course
        var roster = new Roster(this, res.CourseID);
        var seated = from r in roster.All
                     where r.WaitingList == false
                     select r.ID;

        base.SubmitChanges(failureMode);

        // get seated id's not in original seated ids
        var newlySeated = from r in roster.All
                          where r.WaitingList == false && !seated.Contains(r.ID)
                          select r.ID;

        var reservations = this.Reservations.Where(r => newlySeated.Contains(r.ID));

        foreach (var r in reservations)
        {
            r.Confirmed = false;
        }
    }

    base.SubmitChanges(failureMode);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T15:38:35.577

我预计这里的问题是它已经调用了`GetChangeSet()`.

我建议您在数据上下文中覆盖`SubmitChanges()`，并在此处应用此逻辑...

```
partial class LawEnforcementDataContext
{
    public override void SubmitChanges(
        System.Data.Linq.ConflictMode failureMode)
    {
        ChangeSet delta = GetChangeSet();
        foreach (var reservation in delta.Deletes.OfType<Reservation>())
        {
            // etc
        }
        base.SubmitChanges(failureMode);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T14:22:58.053

这是更新部分类中的对象的解释和好方法： [实现 linqtosql 部分 DataContext 类 - 如何检查之前/之后的值](https://stackoverflow.com/questions/1058583/implementing-linqtosql-partial-datacontext-class-how-to-inspect-before-after-v/1069928#1069928)

我希望它有所帮助。

# string-matching - 产品名称的模糊匹配

> ID：595250
> 
> 赞同：23
> 
> 时间：2009-02-27T15:37:19.230
> 
> 标签：string-matching, levenshtein-distance, fuzzy-search

我需要将来自不同来源的产品名称（相机、笔记本电脑、电视等）自动匹配到数据库中的规范名称。

例如**"Canon PowerShot a20IS"**、**"NEW powershot A20 IS from Canon"**和**"Digital Camera Canon PS A20IS"** 应该都匹配**"Canon PowerShot A20 IS"**。我已经通过一些额外的启发式（删除明显的常用词，为数字更改分配更高的成本等）来处理 levenshtein 距离，这在某种程度上有效，但不幸的是还不够好。

主要问题是，即使是相关关键字的单个字母变化也会产生巨大的差异，但要检测哪些是相关关键字并不容易。以三个产品名称为例：
**Lenovo T400**
**Lenovo R400**
**New Lenovo T-400, Core 2 Duo**
前两个在任何标准上都是非常相似的字符串（好吧，soundex 在这种情况下可能有助于区分 T 和 R，但名称可能还有400T和400R），第一和第三作为琴弦相距很远，但是是同一个产品。

显然，匹配算法不可能 100% 精确，我的目标是自动匹配大约 80% 的名称，并且置信度很高。

非常感谢任何想法或参考

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T15:47:17.367

我认为这将归结为区分诸如**Lenovo之类的关键词和诸如****New**之类的谷壳。

我将对名称数据库进行一些分析以识别关键词。您可以使用类似于用于生成词云的代码。

然后我会手动编辑列表以删除任何明显的谷壳，比如也许 New 实际上很常见但不是关键。

然后，您将获得可用于帮助识别相似性的关键词列表。您可以将“原始”名称与其关键字相关联，并在比较两个或多个原始名称的相似性（字面意思是共享关键字的百分比）时使用这些关键字。

无论如何都不是一个完美的解决方案，但我认为您不会期待一个？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T16:45:04.980

这里的关键理解是你确实有一个适当的距离度量。这实际上根本不是你的问题。您的问题在于分类。

让我给你举个例子。假设 Foo X1 有 20 个条目，Foo Y1 有 20 个条目。您可以放心地假设它们是两组。另一方面，如果 Bar X1 有 39 个条目，Bar Y1 有 1 个条目，则应将它们视为一个组。

现在，两个示例中的距离 X1 <-> Y1 是相同的，那么为什么分类会有所不同呢？这是因为 Bar Y1 是异常值，而 Foo Y1 不是。

有趣的是，您实际上不需要做很多工作来预先确定这些组。您只需进行递归分类。您从每个组的节点开始，然后为两个最近的节点添加一个超级节点。在超级节点中，存储最佳假设、其子树的大小和其中的变化。由于您的许多字符串都是相同的，您很快就会得到具有相同条目的大型子树。递归以包含在树根的超级节点结束。

现在将规范名称映射到这棵树。您会很快看到每个都将匹配整个子树。现在，使用这些树之间的距离来选择*该条目的*距离截止值。如果您在数据库中同时拥有 Foo X1 和 Foo Y1 产品，则截止距离需要更低以反映这一点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T15:51:17.217

我认为 edg 的答案是正确的 - 你需要区分关键词和绒毛。

上下文很重要。以您为例，Core 2 Duo 在查看 T400 的两个实例时是绒毛的，但在查看 CPU OEM 封装时则不然。

如果您可以在数据库中标记产品名称的规范形式的哪些部分更重要并且必须以一种或另一种形式出现以识别产品，那么您应该这样做。也许通过使用某种语义标记？您能负担得起人工标记数据库的费用吗？

您可以尝试为“T-400”、“T400”、“T 400”等内容定义等价类。也许有一组规则说“数字比附加到这些数字的字母更牢固”。

根据制造商、型号等细分案例可能是一个好方法。我建议您查看术语发现技术以尝试实现这一目标：[http ://www.worldcat.org/isbn/9780262100854](http://www.worldcat.org/isbn/9780262100854)

在一个主要由规则驱动的灵活框架中设计所有内容，其中规则可以根据您的需求和新出现的不良模式（阅读：破坏您的算法的事物）进行修改，这也是一个好主意。这样，您就可以根据真实世界的数据提高系统的性能。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T15:57:36.717

您也许可以为此使用[三元组搜索](http://en.wikipedia.org/wiki/Trigram_search)。我必须承认我从未见过实现索引的算法，但见过它在制药应用中的工作，它确实很好地应对拼写错误的药物名称。您也许可以将相同类型的逻辑应用于此问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-24T02:32:44.137

这是[记录联动](https://en.wikipedia.org/wiki/Record_linkage)的问题。[dedupe python 库](https://github.com/datamade/dedupe)提供了完整的实现，但即使您不使用 python，文档也[很好地概述了如何解决这个问题](https://dedupe.io/developers/library/en/latest/How-it-works.html)。

简而言之，在标准范式中，这项任务分为三个阶段

1.  比较字段，在这种情况下只是名称。您可以为此使用一个或多个比较器，例如编辑距离（如 Levenshtein 距离）或余弦距离（比较常用词的数量）。
2.  将距离分数的数组转换为一对记录真正是同一件事的概率
3.  将这些成对的概率分数聚集成可能都指向同一事物的记录组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T15:42:22.963

您可能想要创建忽略型号的字母/数字组合的逻辑（因为它们几乎总是非常相似）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-27T15:44:24.597

[拼写检查](http://en.wikipedia.org/wiki/Spell_checker)算法浮现在脑海中。

虽然我找不到一个好的示例实现，但我相信你可以修改一个基本的拼写检查算法来得到满意的结果。即以单词为单位而不是字符。

留在我记忆中的点点滴滴：

1.  去掉所有常用词（a、an、the、new）。什么是“共同”取决于上下文。
2.  取每个单词的第一个字母及其长度，并将其作为单词键。
3.  当出现可疑词时，查找具有相同或相似词键的词。

它可能*无法*直接解决您的问题……但您说您正在寻找想法，对吧？

:-)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-27T15:48:48.237

对此类问题没有任何经验，但我认为一个非常幼稚的实现是对搜索词进行标记，并搜索恰好包含任何标记的匹配项。

例如，“Canon PowerShot A20 IS”标记为：

*   佳能
*   强力射击
*   A20
*   是

这将匹配您希望在结果中显示的每个其他项目。当然，这种策略也可能会产生大量错误匹配。

另一种策略是存储每个项目的“关键字”，例如“相机”、“佳能”、“数码相机”，并根据具有匹配关键字的项目进行搜索。此外，如果您存储了其他属性，例如 Maker、Brand 等，您可以搜索其中的每一个。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-27T15:53:50.003

这正是我在业余时间正在解决的问题。我想出的是：基于关键字缩小搜索范围：

在这种情况下，您可能会有一些层次结构：

类型 --> 公司 --> 型号

这样您就可以匹配“数码相机”的类型

公司的“佳能”，在那里你的搜索范围要窄得多。

您可以通过引入产品线等来进一步解决这个问题。但重点是，这可能必须迭代完成。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-04-18T17:13:52.900

我们可以使用 [Datadecision 服务](http://www.datadecision.com "Datadecision的数据匹配软件")来匹配产品。

它将允许您使用统计算法自动匹配您的产品数据。此操作在定义置信度阈值分数后完成。

所有无法自动匹配的数据都必须通过专门的用户界面进行人工审核。

在线服务使用查找表来存储同义词以及您的手动匹配历史记录。这使您可以在下次导入新数据时改进数据匹配自动化。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-11-06T15:28:45.273

我过去做过同样的事情。我所做的是使用 NLP 方法；TF-IDF Vectorizer 为每个单词分配权重。例如在你的情况下：

佳能 PowerShot a20IS

*   佳能 --> 重量 = 0.05（不是一个非常有区别的词）
*   PowerShot --> weight = 0.37（可以区分）
*   a20IS --> weight = 0.96（非常有区别）

这将告诉你的模型哪些词需要关注，哪些词不需要。多亏了 TF-IDF，我有很好的比赛。但请注意：a20IS 无法识别为 a20 IS，您可以考虑使用某种正则表达式来过滤此类情况。

之后，您可以使用余弦相似度等数值计算。

# html - 在 Firefox 中不存在单元格的表格上隐藏边框和边框折叠：折叠；

> ID：595253
> 
> 赞同：2
> 
> 时间：2009-02-27T15:37:41.600
> 
> 标签：html, css, firefox

给定以下 HTML 页面，表格顶部会出现一条水平线，其中第一行将有第二个和第三个单元格（如果已定义）。

```
<html>
<head>
<Title>Test Page</Title>

<style type="text/css">
table {
    margin:10px 0 10px 0;
    padding:0;
    margin: 0 0 0 0;
    border-collapse: collapse;
    border: 0;
}

td {
    border:1px solid #CCCCCC;
    padding:5px;
}
</style>

</head>
<body>
    <table>
        <tr>
            <td>Test Title</td>
        </tr>
        <tr>
            <td>Sub Title</td>
            <td>Sub Title</td>
            <td>Sub Title</td>
        </tr>
    <table>
</body>
</html> 
```

我希望仅通过修改 CSS 来删除该行（在下面突出显示）。此行出现在 Firefox 中，但不在 IE6 中。

![示例图像](https://i.stack.imgur.com/w5Uzj.jpg)

请注意，我不能以任何方式修改 HTML，因为它是由第三方系统生成的（上面的示例只是为了突出问题）。这个第三方系统只允许我修改 CSS。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T17:23:16.370

这将使它在 Firefox 中呈现没有顶部边框：

```
table, td {
    border: 1px #CCC;
}

table {
    margin: 0;
    border-spacing: 0;
    border-style: none none solid solid;
}

* html table {
    border-collapse: collapse;
}

td {
    border-style: solid solid none none;
    padding: 5px;
} 
```

对我来说，它在 IE7 中也可以正常工作。如果它在 IE6 中中断，请使用条件注释或 css hack 将其恢复到您自己的 IE6 代码中的状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T15:46:21.660

**编辑：您的第三方工具正在生成错误/无效标记，这会给您带来非常大的浏览器兼容性/css 头痛，如果可行，请替换它或自己生成 html**

从技术上讲，第一行应标记为

```
 <tr>
        <td colspan="3">Test Title</td>
    </tr> 
```

所以我认为你不能使用表格来实现这一点。

一个 CSS 技巧

```
margin: 10px 0; 
```

在顶部和底部放置 10px，在左右放置 0

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T18:31:42.540

在这种情况下，[empty-cells](http://www.quirksmode.org/css/tables.html#emptycells)属性可能会对您有所帮助。

```
table {
  empty-cells:hide;
} 
```

再说一次，也许不是。您还可以显式关闭表格行的边框吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T18:47:30.927

使用 javascript 是一种选择吗？您可以在单元格中注入一个非中断空间，该空间应该绘制边框。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-09T22:15:18.433

这是真正有效的这个问题的解决方案。很久之后我才发现

问题在于 tbody 标签。

在此处查看解决方案： [http ://www.dashplanet.com/firefox-displaying-border-top-of-table-how-to-hide-that-1px-top-border-table](http://www.dashplanet.com/firefox-displaying-border-top-of-table-how-to-hide-that-1px-top-border-table)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-27T15:44:17.343

来自[Firefox Colspan Border-COllapse 错误](http://jimbojw.com/wiki/index.php?title=Firefox_Colspan_Border-Collapse_Bug)：

> 显而易见的解决方法是在 DOM 完成加载之前或至少在表格完成渲染之前设置 colspan。然而，这需要我们用内联标签来混乱我们原本干净的 HTML，或者在 HTML 生成阶段预先了解列数。
> 
> 我希望将来能找到一种更优雅的“非侵入式 JavaScript”解决方案，但目前我不知道有哪一种。简单地将表格的“显示”样式设置为“无”，然后将其重新设置回“块”并不能解决问题。

# cocoa - Interface Builder > Inspector > Bindings 中的“Controller Key”是什么意思？

> ID：595257
> 
> 赞同：7
> 
> 时间：2009-02-27T15:38:09.213
> 
> 标签：cocoa, interface-builder, cocoa-bindings, key-value-observing, key-value-coding

我在文档中找不到他们解释所有这些字段及其含义的地方。特别是“控制器密钥”我不清楚。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-03-14T04:04:05.387

[复制[我对另一个问题的回答](https://stackoverflow.com/questions/1774022/cocoa-key-value-bindings-what-are-the-explanations-of-the-various-options-for-co/1774327#1774327)……]

控制器键是您要绑定的（控制器对象的属性）的键。模型关键路径是绑定对象可以通过它向模型对象询问更基本的对象，例如字符串或图像，或其他模型对象（即向下钻取模型）的关键路径。

一个例子：假设你在一个数组控制器中有一个 Person 对象，每个 Person 都有一个`name`. 您将表列绑定到数组控制器、控制器键`arrangedObjects`（从而获取模型对象）、模型键路径`name`（从而获取值对象）。

一个更复杂的例子：假设你有一个 Departments 的数组控制器。每个部门都包含人员（部门中的员工）。您可以将 People 数组控制器绑定到 Departments 控制器、控制器键`arrangedObjects`（获取 Department 模型对象）、模型键路径`@distinctUnionOfObjects.employees`（获取 Person 模型对象），然后将表列绑定到 People 控制器、控制器键`arrangedObjects`、模型键路径`name`.

那张桌子是给为贵公司工作的人准备的；如果您有一个单独的*潜在*员工表，您也可以为他们创建 Person 对象，并且他们不会出现在现有员工的表中，因为他们不在部门中。当您雇用他们时，您会将他们添加到一个或多个部门；然后，它们会自动出现在 People 阵列控制器中，因为该阵列控制器正在观察`employees`所有部门的情况。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-03-04T08:10:56.377

控制器键弹出菜单是一种帮助您发现控制器（通常是 NSArrayController、NSObjectController 或 NSTreeController）提供哪些键的方法。

最好的例子是`selection`NSArrayControllers 的键，它包含一组选定的对象。令人困惑的是 NSObjectController 也提供了一个“选择”键，尽管控制器只能控制一个对象（因此选择 = 对象）。

我同意这根本不清楚。`bind:toObject:withKeyPath:options:`当我以编程方式绑定我的对象（即使用该方法）时，我个人开始理解它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T17:49:46.760

It has to do with key-value coding. You can bind a control in IB to a value in your controller. To connect that value, you have to specify the keypath to it. For example, if you have a textfield in IB and you want to bind it to say a field called 'name' in your controller, you would specify 'name' as the keypath. You then need to set up your name field in your controller to be accessible through key-value coding. This is done in 10.5 by using the @property and @synthesize specifiers.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-03-13T23:37:11.163

看看这个话题： [Cocoa Key Value Bindings: Controller Key的各种选项的解释是什么？](https://stackoverflow.com/questions/1774022/cocoa-key-value-bindings-what-are-the-explanations-of-the-various-options-for-co/2440537#2440537)

我发布了关于在哪里可以找到所有 Controller Key 的定义的说明。

# .net - 约束到接口的泛型参数与仅使用接口之间的区别

> ID：595260
> 
> 赞同：12
> 
> 时间：2009-02-27T15:39:26.653
> 
> 标签：.net, generics, interface

这有什么区别：

```
void MyMethod(IMyInterface value)
{
    //...
} 
```

还有这个：

```
void MyMethod<T>(T value) where T : IMyInterface
{
    //...
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-27T15:44:09.060

主要的功能区别是您可以知道泛型方法内部对象的实际类型。T 参数将包含在某些情况下可能有利的实际类型。

在非泛型情况下，您不能保证访问对象的基础类型。您可以获取大多数类型 value.GetType() 但用户可以传递 Null 并阻止您。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-27T15:49:44.367

Jared 提到了一些要点。*另一个有趣的：使用泛型，只要*你基本上不碰它，你就可以避免值类型的装箱......所以我可以有一个`struct Foo : IMyInterface`并将它传递进去，它不会被装箱。

集合之类的差异变得更加明显：

```
static void Foo(IEnumerable<IMyInterface> data) {} 
```

对比

```
static void Foo<T>(IEnumerable<T> data) 
    where T : IMyInterface {} 
```

现在，由于 C# 3.0 没有协方差（数组除外），我不能将 a 传递`List<Bar>`给顶部，即使`Bar : IMyInterface`- 但我可以使用第二个（隐式`T = Bar`）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T15:43:30.590

通用版本需要 .NET 2.0。

但说真的，虽然它们看起来很相似，但它们之间存在根本差异。一个区别是，在运行时，JIT 编译器将为将用于通用版本的每种值类型生成代码。非泛型版本需要将值类型装箱才能传递给函数。

在与代表打交道时，差异也很重要。非通用版本不匹配`MyMethod<int>`时匹配的签名。`void MyDelegate(int x)`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-27T16:24:52.207

另一个区别是，使用泛型方法允许您指定对象必须实现的**多个**接口：

```
class Dictionary<TKey,TVal>
    where TKey: IComparable, IEnumerable
    where TVal: IValue
{ ... } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-02T07:48:26.577

另一个细微的区别是您不能仅在约束上重载方法（约束不是方法签名的一部分）：

这是非法的：

```
void MyMethod<T>(T value) where T : IMyInterface
{
    //...
}

void MyMethod<T>(T value) where T : IMyInterface2
{
    //...
} 
```

虽然这是合法的：

```
void MyMethod(IMyInterface value)
{
    //...
}

void MyMethod(IMyInterface2 value)
{
    //...
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T16:18:05.717

在这种情况下要考虑的另一个警告是，使用“where T : <%your base interface or abstraction%>”可能会在泛型中过度使用，从而使您的泛型类型本质上是非泛型的。

IE：请记住，通过将您的通用方法隔离到 IMyInterface，您将该方法隔离到仅实现 IMyInterface 的那些类型。因此，如果您只是根据良好的 OOP 原则选择使用 IMyInterface，但在任何地方都只有一个（或在某些情况下是极少数）潜在类型来实现该接口，那么您就违背了目的使用泛型。在这种情况下，第一种选择会更好。

仅当您将拥有更广泛的实际实现 IMyInterface 的类型时，才在泛型类型上使用“where”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-02T19:17:35.013

一般泛型方法的另一个区别（尽管不是针对您的示例）是，如果一个方法具有类似`T MungeThing<T>(T it) where T:IMungeable<T>`和类`Fnord`implements `IMungeable<Fnord>`，那么代码将能够说：`Fnord thing1, thing2; ... thing1 = MungeThing(thing2);`并且编译器将知道这`MungeThing`将返回 a`Fnord`而不是一些任意实现`IMungable`.

# javascript - 使用 AJAX 将图像发布到服务器的最佳方式是什么？

> ID：595274
> 
> 赞同：2
> 
> 时间：2009-02-27T15:42:35.367
> 
> 标签：javascript, ajax, http

我希望用户将图像发布到服务器并在准备好后将其加载回页面，所有这些都无需离开页面。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T15:45:28.307

我会推荐[jQuery 表单插件](http://malsup.com/jquery/form/)。它支持文件上传，完成后，您可以将图像显示给用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T15:50:16.453

发布到 IFrame 并在 IFrame 中显示图像。

这里有更多细节：[http ://www.openjs.com/articles/ajax/ajax_file_upload/](http://www.openjs.com/articles/ajax/ajax_file_upload/)

# performance - Google 协议缓冲区与 ASN.1 相比如何

> ID：595279
> 
> 赞同：38
> 
> 时间：2009-02-27T15:43:32.680
> 
> 标签：performance, serialization, protocol-buffers, asn.1

Google Protocol Buffers 和 ASN.1（使用 PER 编码）之间最显着的区别是什么？对于我的项目，最重要的问题是序列化数据的大小。有没有人在两者之间进行过任何数据大小的比较？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2010-12-14T16:38:43.433

如果您将 ASN.1 与 Unaligned PER 一起使用，并使用适当的约束定义您的数据类型（例如，指定整数的下限/上限、列表长度的上限等），您的编码将非常紧凑。字段之间的对齐或填充之类的事情不会浪费任何位，并且每个字段将被编码为保持其允许的值范围所需的最小位数。例如，INTEGER (1..8) 类型的字段将被编码为 3 位（1='000', 2='001', ..., 8='111'）；一个有四个备选方案的 CHOICE 将占用 2 位（表示选择的备选方案）加上所选备选方案占用的位。ASN.1 有许多其他有趣的特性，已在许多已发布的标准中成功使用。一个例子是扩展标记（“...”），

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-27T15:49:04.273

我已经很久没有做过任何 ASN.1 工作了，但是大小很可能取决于您的类型和实际数据的详细信息。

我*强烈*建议您将两者都制作原型并放入一些真实数据进行比较。

如果您的协议缓冲区包含重复的原始类型，您应该查看 Subversion for Protocol Buffers 中的最新源 - 它们现在可以以“打包”格式表示，这更加节省空间。（我的 C# 端口*刚刚*赶上了这个功能，上周的某个时候。）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-10-23T10:13:32.340

当打包/编码消息的大小很重要时，您还应该注意 protobuf 无法打包`repeated`不属于 a 的字段这一事实`primitive numeric type`，[请阅读此内容](https://developers.google.com/protocol-buffers/docs/encoding?hl=de#optional)以获取更多信息。

这是一个问题，例如，如果您有该类型的消息：（注释定义实际值范围）

```
message P{
    required sint32 x = 1; // -0x1ffff  to  0x20000
    required sint32 y = 2; // -0x1ffff  to  0x20000
    required sint32 z = 3; // -0x319c  to   0x3200
}
message Array{
    repeated P ps = 1;
    optional uint32 somemoredata = 2;
} 
```

如果您有一个数组长度，例如 32，那么您将使用 protobuf 生成大约 250 到 450 个字节的打包消息大小，具体取决于数组实际包含的值。**如果您使用完整的 32 位范围，或者**如果您使用`int32`而不是`sint32`并且有负值，这甚至可以增加到超过 1000 个字节。

原始数据 blob（假设 z 可以定义为`int16`值）只会消耗 320 字节，因此**ASN.1**消息**总是**小于 320 字节，因为最大值实际上不是 32 位，而是 19 位（x，y）和 15 位（ z)。

protobuf 消息大小可以使用此消息定义进行优化：

```
message Ps{
    repeated sint32 xs = 1 [packed=true];
    repeated sint32 ys = 2 [packed=true];
    repeated sint32 zs = 3 [packed=true];
}
message Array{
    required Ps ps = 1;
    optional uint32 somemoredata = 2;
} 
```

这导致消息大小在大约 100 字节（所有值都是零）、300 字节（最大值范围内的值）和 500 字节（所有值都是高 32 位值）之间。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-11-21T15:04:39.610

Protocol Buffers 不保证二进制编码中字段顺序的保留，但 ASN.1 可以。它与大小无关，因此在您的用例中可能不是最明显的，但对于比较、数字签名、简化解析以及可能的其他应用程序来说，它是一个重要的区别。

# c# - 存在显式转换c#

> ID：595283
> 
> 赞同：-1
> 
> 时间：2009-02-27T15:44:20.883
> 
> 标签：c#

以下代码行显示标题错误：

```
ITestClass t = new TestClass(); 
```

测试类实现：

```
 public class TestClass : ITestClass {

  public static TestClass Instance
        {
            get
            {
                return TestClass.Instance;
            }
        }

 //Interface members

} 
```

我有另一组具有类似接口的类，可以在其中使用此强制转换，为什么它在这里不起作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T15:49:10.497

您尝试分配的接口很可能不是您正在新建的类的一部分。仔细检查您的接口实现是否有错误，这是一段完全有效的代码。

如果您有特定错误，请提供产生相同错误的代码，您提供的代码在编译时不会出错。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T15:50:17.623

我不确定您提出的错误，但您列出的属性是错误。getter 只是返回属性，因此是无限递归的。如果您尝试访问它，这将在运行时导致堆栈溢出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T15:51:07.247

这种错误的唯一可能性是 TestClass 或 ITestClass 在一种情况和另一种情况下并不意味着同样的事情。

最常见的原因是包含 TestClass 的程序集和您的主程序集引用了 2 个不同的 dll 文件，它们都具有名为 ITestClass 的接口。

# python - PyS60 有可靠的垃圾收集吗？

> ID：595290
> 
> 赞同：3
> 
> 时间：2009-02-27T15:46:32.017
> 
> 标签：python, symbian, nokia, s60, pys60

我多次听说 PyS60 中的垃圾收集达不到标准。这对编写更简洁的代码施加了很多限制。我至少可以依靠在函数存在后清理非循环引用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T15:49:30.327

PyS60 版本 1.9.0 使用 Python 2.5.1 核心并且在垃圾收集方面没有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-27T10:55:12.180

大多数情况下你可以，但偶尔 PyS60 需要一点“帮助”。取消绑定键，总是取消计时器，可能不得不手动删除一些类等。没什么太糟糕的。

顺便说一句，当前 1.9.x 分支使用 python 核心 2.5.4。在我看来 1.9.5 是第一个版本，它可能比 1.4.5 更好。值得一看，特别是如果你想玩 5800 XpressMusic :)

# vb.net - WinForms 应用程序数据缓存 - 在哪一层缓存？

> ID：595291
> 
> 赞同：1
> 
> 时间：2009-02-27T15:46:46.383
> 
> 标签：vb.net, winforms, caching, theory

我们在与我的应用程序数据库位于同一实例的数据库中拥有每晚更新的数据。因此，为了节省数据库调用，我想将此静态数据缓存到 List(Of MyObject) 中。从理论的角度来看，这个缓存的 List(Of ) 是否应该通过全局变量缓存在表示层代码中？它应该在 .DLL 的全局变量中吗？

我正在考虑 .DLL，因为我创建了一个服务层，它公开暴露给 GUI，并调用 .DLL 内的数据访问层：

```
Public Shared Function Search(ByVal criteria As Core.Other.Customer) As List(Of Core.Other.Customer)
    ' TODO: Check the customer cache to see if it has been populated yet. If not, populate it.
    If 1 = 1 Then
        ' TODO: Variable "list" needs to be a global object in the DLL.
        ' For SO readers: Dal class declared Friend.
        Dim list As List(Of Core.Other.Customer) = Dal.Search.Customers.GetCache()
    End If

    Dim results As New List(Of Core.Other.Customer)
    ' TODO: Find the relevant customers in the cache and add them to variable "results".
    Return results
End Function 
```

我会以最好的方式解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T16:10:20.960

我倾向于将其缓存在您的服务层中。我喜欢让我的数据访问保持简单（通常使用像 NHibernate 这样的 OR/M），所以我不想在那里做任何可能改变我对数据访问层工作方式的期望的愚蠢行为（作为开发人员，我希望所有调用 DAL 以实际命中 DB，而不是缓存，除非它是 OR'M 的缓存，这是我不关心的实现细节）。

该服务似乎是合适的地方（当我缓存数据时，这就是我在我的应用程序中执行此操作的地方，如果这有帮助的话）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T15:54:13.777

您的 List(Of x) 是否需要任何处理，还是只是从数据库中提取的原始数据？

如果它只是从数据库中提取的原始数据，那么将其缓存在数据访问层可能是个好主意。

但是如果需要处理，那么应该在业务逻辑层完成

由于您指的是演示代码和 .DLL，您是否碰巧指的是[n 层架构](http://en.wikipedia.org/wiki/Multitier_architecture)？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T15:50:05.020

您可以考虑在不缓存的情况下执行此操作，并查看是否存在性能/网络问题。这可能是过早的优化？

# python - Symbian 的堆栈限制是否也适用于 PyS60？

> ID：595296
> 
> 赞同：3
> 
> 时间：2009-02-27T15:48:37.893
> 
> 标签：python, symbian, nokia, pys60

Symbian 的堆栈限制为 8kB。这是否也适用于 PyS60 应用程序中的函数调用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T15:54:53.743

是的，PyS60 基于 CPython，因此使用 C 堆栈。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-03T12:18:20.877

增加 Symbian 堆栈大小是通过 mmp 文件中的参数完成的。这在您创建工具链将转换为 exe 文件的本机应用程序时有效。

如果您要升级手机上的 Python 运行时，使用您自己构建的版本，您可以增加运行时进程本身的堆栈大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-27T11:03:01.523

python 运行时和 python 应用程序之间存在差异。同样从 PyS60 应用程序开发人员的角度来看，更有趣的是堆大小......

默认情况下，1.9.5 版的堆大小最小为 100k，最大为 4M。当然，您可以在创建 SIS 包以发布和分发您的应用程序时自行定义这些。

抱歉，如果我用错误的答案回答了正确的问题（堆栈与堆）。

堆栈通常是“足够的”，但是如果递归足够深，您可能会用完它。已经完成了 - 并修复了一些无限循环 :) 从来没有任何真正的堆栈问题。通常是堆用完，尤其是图形操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-26T10:04:26.107

我假设 PyS60 应该为你做内存管理，因为你的程序可能会受到 PyS60 资源的限制。

# java - 静态方法或单例性能方面（Android）？

> ID：595301
> 
> 赞同：8
> 
> 时间：2009-02-27T15:49:30.450
> 
> 标签：java, android, performance, singleton, static-methods

在具有少量 POJO 和许多对其进行操作的辅助方法的应用程序中，在性能方面更好的是：使辅助类成为单例还是使方法静态？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-27T15:58:54.407

静态方法在性能和内存方面会稍微好一些：

1.  避免虚拟函数调用的（潜在）开销。
2.  消除类的实际实例所需的内存。
3.  使用时无需获取类的实例。

`singleton`但老实说，无论如何我可能仍然会这样做。不这样做所获得的收益可能很小，以至于即使在移动环境中，它们也会产生零差异。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-27T16:13:32.250

你能避免这两种情况，让他们定期上课吗？

忽略性能问题，我建议避免使用单例和静态方法来提高您的可测试性。

单例和静态方法很难测试；在这方面，单例本质上是静态方法，但名称不同。[在Google 测试团队](http://googletesting.blogspot.com/)工作的[Misko Hevery](http://misko.hevery.com/)有几篇关于这个主题的好文章：

*   [单身人士是病态的骗子](http://misko.hevery.com/2008/08/17/singletons-are-pathological-liars/)
*   [静态方法是稳定性的死神](http://misko.hevery.com/2008/12/15/static-methods-are-death-to-testability/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-27T16:14:01.717

不要担心这样荒谬的微优化。担心可维护性。

听起来该应用程序是完全以非 OO 风格编写的，并且可以从消除大多数“辅助方法”并将它们放在它们所属的位置以及它们所操作的数据中受益匪浅。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T16:13:36.540

从表面上看你的问题，静态调用可能需要最少的 CPU 功率。原因是普通方法是动态绑定的，需要在运行时进行一些查找，而静态方法绑定编译时。

话虽如此，它在您的应用程序中可能并不重要。差别真的很小。如果您的应用程序使用 gui、xml 渲染、互联网连接或其他外部操作进行任何操作，您会发现这些活动使简单的数学查找相形见绌。

即使您不这样做，在分析期间您更有可能遇到阻碍您的应用程序的单个瓶颈，并发现它不是方法查找，而是您自己执行的一些逻辑。例如，您使用 arraylist 而不是 hashset 并且 contains 方法变得昂贵。

因此，由于这些情况下的性能并不重要，我建议使用静态方法之上的单例实现，因为设计稍微灵活一些。尽管在您提供的选择之外，我会完全放弃辅助类并将方法内联到您的 pojo 中。

# python - 如何获取正在运行的 Python 脚本的路径？

> ID：595305
> 
> 赞同：443
> 
> 时间：2009-02-27T15:50:00.043
> 
> 标签：python, path

> **重复：**
> [在 Python 中，如何获取当前正在执行的文件的路径和名称？](https://stackoverflow.com/questions/50499/in-python-how-do-i-get-the-path-and-name-of-the-file-that-is-currently-executin)

如何获取正在运行的 Python 脚本的路径？我在做`dirname(sys.argv[0])`，但是在 Mac 上我只得到文件名 - 而不是我在 Windows 上做的完整路径。

无论我的应用程序是从哪里启动的，我都想打开与我的脚本文件相关的文件。

* * *

## 回答 #1

> 赞同：572
> 
> 时间：2009-02-27T15:56:18.967

使用它来获取当前文件的路径。它将解析路径中的任何符号链接。

```
import os

file_path = os.path.realpath(__file__) 
```

这在我的 Mac 上运行良好。它不适用于 Python 解释器（您需要执行 Python 文件）。

* * *

## 回答 #2

> 赞同：142
> 
> 时间：2009-02-27T15:52:01.817

```
import os
print os.path.abspath(__file__) 
```

* * *

## 回答 #3

> 赞同：133
> 
> 时间：2009-02-27T15:52:43.750

潜入 Python 的 7.2：[寻找路径](http://www.faqs.org/docs/diveintopython/regression_path.html)。

```
import sys, os

print('sys.argv[0] =', sys.argv[0])             
pathname = os.path.dirname(sys.argv[0])        
print('path =', pathname)
print('full path =', os.path.abspath(pathname)) 
```

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2010-03-26T19:39:08.120

如果您打算使用 py2exe 编译脚本，则可接受的解决方案将不起作用。如果您打算这样做，这是等效的功能：

```
os.path.dirname(sys.argv[0]) 
```

Py2exe 不提供`__file__`变量。供参考： http: [//www.py2exe.org/index.cgi/Py2exeEnvironment](http://www.py2exe.org/index.cgi/Py2exeEnvironment "Py2Exe 环境")

* * *

## 回答 #5

> 赞同：-7
> 
> 时间：2009-02-27T15:54:45.727

如果你甚至有相对路径名（在这种情况下它似乎是`./`），你可以打开相对于你的脚本文件的文件。我使用 Perl，但可以应用相同的通用解决方案：我将目录拆分为一组文件夹，然后`pop`关闭最后一个元素（脚本），然后`push`（或对你来说，`append`）我想要的任何内容，然后再次将它们连接在一起，然后砰！我有一个工作路径名，它准确地指向我期望它指向的位置，相对或绝对。

当然，如发布的那样，还有更好的解决方案。我只是有点喜欢我的。

# c++ - 解析器：解析模板文件中的公式

> ID：595314
> 
> 赞同：3
> 
> 时间：2009-02-27T15:51:44.437
> 
> 标签：c++, parsing, boost, boost-spirit

我将首先描述问题，然后根据库来描述我目前正在研究的内容。

在我的应用程序中，我们有一组始终可用的变量。例如：TOTAL_ITEMS、PRICE、CONTRACTS、ETC（我们大约有 15 个）。应用程序的客户希望使用这些变量执行和显示某些计算。到目前为止，我一直在不断地将这些计算添加到应用程序中。这很麻烦，我想通过创建模板使其更通用，用户可以在模板中指定一组应用程序将解析和计算的公式。

这是一个案例：

```
total_cost = CONTRACTS*PRICE*TOTAL_ITEMS 
```

因此，想要为用户在模板文件中定义做类似的事情：

`total_cost = CONTRACTS*PRICE*TOTAL_ITEMS` 和一些元日期，比如显示它的屏幕。因此，他们将使用屏幕指定公式。该文件将包含许多这种性质的公式。

现在，我正在查看两个库：[Spirit](http://www.boost.org/doc/libs/1_38_0/libs/spirit/classic/index.html)和[matheval](http://sourceforge.net/projects/matheval)

有人会提出对这项任务更好的建议，以及参考、示例、链接吗？

如果问题不清楚，请告诉我，我会尽力进一步澄清。

谢谢，

萨沙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T15:59:15.230

看起来使用[yacc](http://dinosaur.compilertools.net/)和[bison](http://www.gnu.org/software/bison/)生成一个简单的解析器并将其集成到您的代码中应该不会太难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T16:08:06.660

如果您有固定数量的变量，则调用解析器可能有点矫枉过正。虽然 Spirit 很酷，我一直想在项目中使用它。

我可能只是对字符串进行标记，制作以名称为键的变量的映射（假设所有变量都是整数）：

```
map<const char*,int*> vars;
vars["CONTRACTS"] = &contracts;
... 
```

然后使用一个简单的后缀计算器函数来做实际的数学运算。

编辑：

查看 MathEval，它似乎完全符合您的要求；设置变量并使用这些变量评估数学函数。我不确定您为什么要在语法解析器级别创建解决方案。您是否有任何 MathEval 无法满足的要求？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T16:13:11.640

我不知道 matheval，但是 boost::spirit 可以非常有效地为你做到这一点：见[那里](http://www.boost.org/doc/libs/1_38_0/libs/spirit/classic/doc/trees.html)。

如果你喜欢模板元编程，你可能想看看[Boost::Proto](http://www.boost.org/doc/libs/1_38_0/doc/html/proto.html)，但开始使用它需要一些时间**。**

# jstl - Jetty 6 中的 Jasper 为 JSTL 标记抛出异常

> ID：595320
> 
> 赞同：6
> 
> 时间：2009-02-27T15:53:07.430
> 
> 标签：jstl, jetty

我正在尝试在码头中运行一个在 Tomcat 5.5 中运行良好的应用程序。该应用程序使用 servlet 2.4 和 JSP 2.0。

Jetty/Jasper 抛出此异常：

```
org.apache.jasper.JasperException: /WEB-INF/tiles/layout/main.jsp(85,55) PWC6340: According to the TLD, rtexprvalue is true, and deferred-value is specified for the attribute items of the tag handler org.apache.taglibs.standard.tag.rt.core.ForTokensTag, but the argument for the setter method is not a java.lang.Object 
```

一件奇怪的事情是，我在任何地方都找不到 TLD。它似乎是通过我不明白的魔法获得的。是否可能获得错误的 TLD？

也很难分辨它从哪里加载 org.apache.taglibs.standard.tag.rt.core.ForTokensTag。Eclipse 在项目的加载路径中没有找到它。

欢迎任何提示...

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-03-12T11:52:22.563

Jetty 包含自己的 JSTL 库，无需包含 jakrta taglib 的标准和核心 jar。

如果您确实将 jakartat taglib 的 jar 放入您的 Web 应用程序，那么在 forTokens 标记中存在冲突会导致此错误，而其他标记工作正常。我建议要么从您的网络应用程序中删除 jakarta taglib 实现并依赖 Jetty，要么停止使用 forTokens。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-06-09T12:45:32.220

@Guss 是正确的，唯一的出路似乎是避免使用`c:forTokens`.

示例替代`c:forTokens`使用`c:forEach`：

```
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions"%>

<c:forTokens items="${input}" delims="," var="i">
     <!-- do stuff with ${i} -->
</c:forTokens>

<c:forEach items="${fn:split(input,',')}" var="i">
     <!-- do stuff with ${i} -->
</c:forEach> 
```

# .net - 是否有 ItemsPanelTemplate 可以使 Items 均匀地填充控件？

> ID：595321
> 
> 赞同：0
> 
> 时间：2009-02-27T15:53:18.037
> 
> 标签：.net, wpf

我有一个 ItemsControl，我希望这些项目均匀地填充控件。使用 StackPanel 作为 ItemsPanelTemplate 只会在一个方向上伸展。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T16:07:54.493

你真正想要的是一个`Panel`均匀填充的。试试`UniformGrid`面板：

```
<ItemsControl>
    <ItemsControl.ItemsPanel>
        <ItemsControl.ItemsPanelTemplate>
            <UniformGrid/>
        </ItemsControl.ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
</ItemsControl> 
```

# c - 在哪里可以找到用于直接写入框架的简单图形 C 库？

> ID：595326
> 
> 赞同：5
> 
> 时间：2009-02-27T15:54:35.103
> 
> 标签：c, graphics, embedded

我需要一个简单的图形 C 库来在我将直接写入框架的设备上使用。

框架位于常规内存中。没有图形加速硬件。

没有什么花哨。我只想能够画线、圆、OSD 的东西，比如字符串。

拥有使用良好、精简算法的函数会很好（我的 CPU 是运行在 400MHz 的 ARM9）。

对此有什么建议？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T16:02:21.153

对于非常简单的需求（线、圆、多边形、文本），我总是自己制作。查看 bresenham 的直线和圆算法，[Wu](http://en.wikipedia.org/wiki/Xiaolin_Wu%27s_line_algorithm)对圆和直线进行抗锯齿的修改。

Gimp 将为图像输出 C 代码，这是我为字体所做的，并且绘制它们非常容易。我使用了抗锯齿（gimp --> grayscale，使用灰度值作为 alpha），但没有做比例字体。它们并不难，并且可以使显示更好一些，但我还不需要它们。

多边形只是多条线，[填充的多边形实现起来非常有趣](http://www.cs.rit.edu/~icss571/filling/index.html)。

这不是很多工作，你会从经验中成长。

但是，如果您决定要渲染 SVG 或其他一些复杂的矢量语言，那么就需要一个库。但是对于简单的事情，这并不复杂。

-亚当

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T18:25:20.810

我想要第二个 OpenGL，尤其是 OpenGL|ES 变体。

这是一个基于软件的 OpenGL 渲染器的链接：http: [//sourceforge.net/projects/ogl-es](http://sourceforge.net/projects/ogl-es)

过去三年我一直在 ARM9 和类似处理器上编写商业软件光栅化代码，所以我想我可以评论一下 cairo 和其他高级 API 的使用：

它们工作得很好，而且功能强大得令人难以置信，但在像 ARM9 这样有限的目标上，你永远不会对性能感到满意。图形库是为典型的台式电脑编写的，它们以精度换取性能。这对于高质量的 SVG 渲染来说是很好的，但在一个不起眼的 ARM 上会减慢速度。

我在上面建议的**Vincent OpenGL|ES有一个****用于 ARM-CPU 的动态代码生成引擎**，因此您几乎可以获得手动优化的汇编代码的性能。

如果您可以将自己限制为仅一种位图格式、两种混合模式和一堆渲染图元，您可以通过自己编写十几个渲染例程来获得更好的性能。根据您的经验和要求，可能需要两天到一个月的时间。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T16:00:54.120

[Cairo](http://cairographics.org/)非常强大且易于使用。我认为 Mozilla 使用它作为`<canvas>`元素和 SVG 渲染器的基础。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T16:01:38.160

根据您的要求，您似乎需要一个嵌入式帧缓冲区库（或其他任何名称）之类的东西。几年前，我为嵌入式浏览器（没有进入市场）尝试了以下一些。不幸的是，我不记得太多可以给你任何分析。看一看：

*   [直接FB](http://www.directfb.org/)
*   [GTK/X](http://www.linuxjournal.com/article/4870)（或使用directFB的端口）
*   开罗（正如另一张海报所暗示的那样——这非常强大）

另外，这篇[文章](http://www.linuxjournal.com/article/9403)可能很有趣。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T15:57:58.137

OPenGL 有一组 2d 函数，不知道对你来说是不是太臃肿了，还是可以修剪一下。至少它是用 C 语言编写的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T16:02:14.383

试试[SDL](http://www.libsdl.org/)。从网页：

> Simple DirectMedia Layer 是一个跨平台多媒体库，旨在通过 OpenGL 和 2D 视频帧缓冲区提供对音频、键盘、鼠标、操纵杆、3D 硬件的低级访问。MPEG 播放软件、仿真器和许多流行游戏都使用它，包括屡获殊荣的 Linux 端口“文明：号召力”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-08-19T07:57:59.853

我找到了我喜欢的 Adafruit GFX 库。非常非常简单和基本： [https ://github.com/adafruit/Adafruit-GFX-Library](https://github.com/adafruit/Adafruit-GFX-Library)

# sql - EXEC(query) AT linkedServer 与 Oracle DB

> ID：595350
> 
> 赞同：4
> 
> 时间：2009-02-27T15:59:46.540
> 
> 标签：sql, sql-server, oracle

我正在使用 Microsoft SQL Server 2005。我需要在 SQL Server 和 Oracle 数据库之间同步数据。我需要做的第一件事是找出Oracle端的数据计数是否带有某些过滤器（这里我使用ID作为一个简单的例子）。

```
SELECT COUNT(*) FROM oracleServer..owner.table1 WHERE id = @id; 
```

我遇到的问题是内衬服务器或 Oracle 上的表非常大，有 4M 行数据。上述查询大约需要 2 分钟才能取回数据。这段代码只是一个简单的部分。实际上，我的 SP 有一些其他查询要更新，将数据从内衬服务器插入到我的 SQL 服务器。SP 需要数小时或 10 多个小时才能运行大型 Oracle 数据库。因此带有内衬服务器的 T-SQL 对我不利。

最近我发现 OPENQUERY 和 EXEC (...) AT linedServer。OPENQUERY() 非常快。获得相同结果大约需要 0 时间。但是，它不支持变量查询或表达式。查询必须是文字常量字符串。

EXEC() 与将查询传递给 Oracle 的方式相同。它也很快。例如：

```
EXEC ('SELECT COUNT(*) FROM owner.table1 WHERE id = ' + CAST(@id AS VARCHAR))
  AT oracleServer 
```

我遇到的问题是如何将结果 COUNT(*) 传回。我尝试在 web 和 msdn 中搜索示例。我只能找到 SQL 或 ExpressSQL linedServer 示例，例如：

```
EXEC ('SELECT ? = COUNT(*) FROM ...', @myCount OUTPUT) AT expressSQL 
```

此查询不适用于 Oracle。在 Oracle 中，您可以通过以下方式将值设置为输出：

```
SELECT COUNT(*) INTO myCount ... 
```

我试过这个：

```
EXEC ('SELECT COUNT(*) INTO ? FROM ...', @myCount OUTPUT) AT oracleServer
EXEC ('SELECT COUNT(*) INTO : FROM ...', @myCount OUTPUT) AT oracleServer
EXEC ('SELECT : = COUNT(*) FROM ...', @myCount OUTPUT) AT oracleServer 
```

没有一个工作。我收到错误消息说查询在 Oracle 服务器上不可执行。

我可以编写一个 .Net SQL Server 项目来完成这项工作。在此之前，我只是想知道是否有办法将值作为输出参数传递出去，以便将性能更好的 T-SQL 代码放在我的 SP 中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T17:08:32.367

只是对此的快速更新。我想我得到了解决方案。[我在Dev NewsGroup](http://www.devnewsgroups.net/group/microsoft.public.dotnet.framework.adonet/topic14841.aspx)上关于类似问题的讨论中找到了它。根据信息，我尝试了这个：

```
DECLARE @myCount int;
DECLARE @sql nvarchar(max);
set @sql =
N'BEGIN 
  select count(*) into :myCount from DATAPARC.CTC_MANUAL_DATA; 
END;'
EXEC (@sql, @myCount OUTPUT) AT oracleServer;
PRINT @myCount; -- 3393065 
```

哇！直接在 Orable DB 上比较 T-SQL 查询，我在 3 秒内得到了结果（+2 分钟）。重要的是使用“BEGIN”和“END;” 将查询包装为匿名块，不要错过“;” 结束后

您需要匿名块作为输出参数。如果您只有输入或没有参数，则不需要该块并且查询可以正常工作。

好好享受！顺便说一句，这是一个快速更新。如果你再也见不到我，我不会在这个问题上遇到任何麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-14T16:40:57.990

使用链接服务最大的问题是性能（恕我直言） `[linkedserver]...[dbo.RemoteTable] vs OPENQUERY(linkedserver, 'Select * from dbo.RemoteTable')` **总是使用第二个**

现在来回答这个问题。`OPENQUERY`而且`EXEC() AT`速度更快。 `EXEC(Select * from dbo.RemoteTable) AT linkedserver`将显示结果，但没有办法重复使用。

我的简单解决方案：

```
SELECT * INTO LocalTable FROM OPENQUERY(linkedserver, 'Select * from dbo.RemoteTable') 
```

或者

```
INSERT INTO LocalTable SELECT * FROM OPENQUERY(linkedserver, 'Select * from dbo.RemoteTable') 
```

比快得多^10

```
SELECT * INTO LocalTable FROM [linkedserver]...[dbo.RemoteTable] 
```

# c# - 将通用列表绑定到 DomainUpDown 控件的更好方法（文本旋转控件）

> ID：595352
> 
> 赞同：1
> 
> 时间：2009-02-27T16:00:13.140
> 
> 标签：c#, .net, windows, winforms

我一直在尝试找出如何将数据绑定到
`System.Windows.Forms.DomainUpDown()`控件。

目前我只提出：

```
 private void Init()
        {
            List<string> list = new List<string>();
            list = get4000Strings(); //4000 items

            foreach (string item in list)
            {
                domainUpDown1.Items.Add(item); 
            }

        }

        private List<string> get4000Strings()
        {
            List<string> l = new List<string>();
            for (int i = 0; i < 4000; i++)
            {
                l.Add(i.ToString());
            }
            return l;
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-03-06T12:30:20.323

该`DomainUpDown.Items`集合有一个`AddRange()`采用`ICollection`（由 实现`List<T>`）的方法，因此您可以这样做

```
private void Init() {
  List<string> list = new List<string>();
  list = get4000Strings(); //4000 items
  domainUpDown1.Items.Clear();
  domainUpDown1.Items.AddRange(list);
} 
```

但是，如果您要显示的项目太多，我建议您使用 have `ComboBox`set `DropDownStyle`to `DropDownList`。它将允许您直接将数据绑定到列表（例如`comboBox1.DataSource = list;`），特别是如果列表经常更改，因为您不必每次都重新填充 ComboBox，只需更改数据源...

# php - 如何在表单操作中执行 PHP 函数？

> ID：595358
> 
> 赞同：30
> 
> 时间：2009-02-27T16:01:59.703
> 
> 标签：php

我正在尝试从表单操作中的 PHP 脚本运行一个函数。

### 我的代码：

```
<?php
require_once ( 'username.php' );

echo '
<form name="form1" method="post" action="username()">
  <p>
    <label>
      <input type="text" name="textfield" id="textfield">
    </label>
  </p>
  <p>
    <label>
      <input type="submit" name="button" id="button" value="Submit">
    </label>
  </p>
</form>';
?> 
```

我回显表单，但我希望执行从 username.php 调用的函数“用户名”。我怎样才能以与上述类似的方式做到这一点？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-02-27T16:04:47.120

```
<?php
require_once ( 'username.php' );

if (isset($_POST['textfield'])) {
    echo username();
    return;
}

echo '
<form name="form1" method="post" action="">
  <p>
    <label>
      <input type="text" name="textfield" id="textfield">
    </label>
  </p>
  <p>
    <label>
      <input type="submit" name="button" id="button" value="Submit">
    </label>
  </p>
</form>';
?> 
```

您需要在表单发送到的页面中运行该功能。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-27T16:34:08.253

在 PHP 中，函数不会在字符串中求值，因为变量有不同的规则。

```
<?php
function name() {
  return 'Mark';
}

echo 'My name is: name()';   // Output: My name is name()
echo 'My name is: '. name(); // Output: My name is Mark 
```

HTML 中标记的 action 参数不应引用您要运行的 PHP 函数。Action 应该是指 Web 服务器上的一个页面，该页面将处理表单输入并将新的 HTML 返回给用户。这可以是与输出表单的 PHP 脚本相同的位置，或者有些人更喜欢制作一个单独的 PHP 文件来处理操作。

无论哪种方式，基本过程都是相同的：

1.  为用户生成 HTML 表单。
2.  用户填写表格，点击提交。
3.  表单数据被发送到由服务器上的操作定义的位置。
4.  该脚本验证数据并对其进行处理。
5.  通常会返回一个新的 HTML 页面。

一个简单的例子是：

```
<?php
// $_POST is a magic PHP variable that will always contain
// any form data that was posted to this page.
// We check here to see if the textfield called 'name' had
// some data entered into it, if so we process it, if not we
// output the form.
if (isset($_POST['name'])) {
  print_name($_POST['name']);
}
else {
  print_form();
}

// In this function we print the name the user provided.
function print_name($name) {
  // $name should be validated and checked here depending on use.
  // In this case we just HTML escape it so nothing nasty should
  // be able to get through:
  echo 'Your name is: '. htmlentities($name);
}

// This function is called when no name was sent to us over HTTP.
function print_form() {
  echo '
    <form name="form1" method="post" action="">
    <p><label><input type="text" name="name" id="textfield"></label></p>
    <p><label><input type="submit" name="button" id="button" value="Submit"></label></p>
    </form>
  ';
}
?> 
```

对于未来的信息，我建议阅读 PHP 教程： http: [//php.net/tut.php](http://php.net/tut.php)

甚至还有一个关于处理表格的部分。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-27T16:26:46.927

我不确定我是否理解您想要实现的目标，因为我们没有`username()`应该返回的东西，但您可能想尝试类似的东西。我还建议您不要回显整个页面，而是使用类似的东西，它更容易阅读和维护：

```
<?php
require_once ( 'username.php' );
if (isset($_POST)) {
  $textfield = $_POST['textfield']; // this will get you what was in the
                                    // textfield if the form was submitted
}
?>

<form name="form1" method="post" action="<?php echo($_SERVER['PHP_SELF']) ?">
  <p>Your username is: <?php echo(username()) ?></p>
  <p>
    <label>
      <input type="text" name="textfield" id="textfield">
    </label>
  </p>
  <p>
    <label>
      <input type="submit" name="button" id="button" value="Submit">
    </label>
  </p>
</form> 
```

这会将结果发布在同一页面中。所以第一次显示页面时，只显示空表单，如果按下提交，文本字段字段将在`$textfield`变量中，您可以根据需要再次显示。

我不知道该`username()`函数是否应该返回您应该发送结果的 URL，但这就是您在`action`表单属性中想要的。我已将结果放在示例段落中，以便您了解如何显示结果。请参阅“您的用户名是...”部分。

* * *

**// 编辑**：

如果你想在不离开页面的情况下发送值，你想使用 AJAX。在 StackOverflow 或 Google 上搜索 jQuery。

您可能希望您的函数返回用户名而不是回显它。但是，如果您绝对想从函数中回显它，只需像`<?php username() ?>`在 HTML 表单中那样调用它。

我认为您需要先了解页面的客户端-服务器进程的流程，然后再继续。假设上面的示例代码称为 form.php。

1.  您的 form.php 被调用。
2.  form.php 生成 HTML 并发送到客户端的浏览器。
3.  客户端只能看到生成的 HTML 表单。
4.  当用户按下按钮时，您有两个选择：a) 让浏览器执行其通常的操作，将表单字段中的值发送到操作中指定的页面（在这种情况下，URL 由 PHP_SELF 定义，即当前page.php)。或者 b) 使用 javascript 将这些数据推送到页面而不刷新页面，这通常称为 AJAX。
5.  在您的情况下，一个页面可以更改为 username.php，然后将根据数据库验证用户名是否存在，然后您想重新生成包含所需值的 HTML，返回到步骤 1。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-04-22T01:36:19.000

我觉得应该是这样的。。

```
<?php
require_once ( 'username.php' );

echo '
<form name="form1" method="post" action="<?php username() ?>">
 <p>
  <label>
   <input type="text" name="textfield" id="textfield">
  </label>
 </p>
 <p>
  <label>
   <input type="submit" name="button" id="button" value="Submit">
  </label>
 </p>
</form>';
?> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-27T16:06:44.120

最好是这样......将数据发布到自我页面，并可能检查用户输入。

```
 <?php
    require_once ( 'username.php' );

    if(isset($_POST)) {
      echo "form post"; // ex $_POST['textfield']
    }

    echo '
    <form name="form1" method="post" action="' . $_SERVER['PHP_SELF'] . '">
      <p>
        <label>
          <input type="text" name="textfield" id="textfield">
        </label>
      </p>
      <p>
        <label>
          <input type="submit" name="button" id="button" value="Submit">
        </label>
      </p>
    </form>';
    ?> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-11-29T15:35:16.207

它真的是对 action 属性的函数调用吗？或者它应该在 onSUbmit 属性上，因为按照惯例，action 属性需要一个页面/URL。

我认为你应该使用 AJAX，

有很多 PHP AJAX 框架可供选择

[http://www.phplivex.com/example/submitting-html-forms-with-ajax](http://www.phplivex.com/example/submitting-html-forms-with-ajax)

[http://www.xajax-project.org/en/docs-tutorials/learn-xajax-in-10-minutes/](http://www.xajax-project.org/en/docs-tutorials/learn-xajax-in-10-minutes/)

等等。

或者经典的方式

[http://www.w3schools.com/php/php_ajax_php.asp](http://www.w3schools.com/php/php_ajax_php.asp)

我希望这些链接有帮助

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-27T16:04:43.173

您可以将 username() 函数放在另一个页面中，并将表单发送到该页面...

# html - 如何在 Windows 的 HTML 中呈现狭窄的不间断空格？

> ID：595365
> 
> 赞同：32
> 
> 时间：2009-02-27T16:04:38.603
> 
> 标签：html, windows, internationalization, typography

在法语中，排版要求我们在不同的地方使用**狭窄** **的不间断**空格（U+202F）（“Comme ça！”）。

显然，Windows 上的每个浏览器都不支持这一点，而是都显示了一个奇怪的字符。这适用于 Mac OS X 和 Linux 上的大多数浏览器。

有谁知道如何让 Windows 浏览器正确呈现它？

（我假设它是 Windows 错误而不是浏览器错误，因为只要不在 Windows 上，Firefox 和 Safari 都支持它）。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-10-15T06:54:56.510

嗯……不。如果唯一的问题是`&thinsp;`(U+2009) 仍在中断，我会更喜欢使用：

```
<span style="white-space:nowrap"> </span>
```

纠正破坏行为。为什么？

*   因为法国*罚款*有效地使用了六分之一到四分之一之间的固定宽度（0.166 ca. 到 0.25 ca.，当标准空间是 0.5 ca.）宽度的选择取决于已经存在的方法以给定字体定义的字形。

*   字体用于调整其薄空间的宽度（U+2009）：如果这些字体是由法语版式（用于呈现法语）制作的，则*approche*（或单词中字母之间的间隙）比为英语设计的字体更窄：这是因为法文文本通常比同等英文文本包含更多的字母（例如印刷版圣经），并且为了避免增加印刷页数，法文字体中的字形变得更窄并减少了方法；为了弥补这一减少，法国*罚款*的数额增加了。（通常说U+2009是五分之一的cadratin，即0.2 ca.，但这是错误的，因为这个值只是一个合理的中值，应该根据字体设计有效地调整）。

*   在带有英文排版的英语中，字符间的间隙已经足够大，足以证明在大多数*双*标点符号附近的文本中使用了不薄的空格这一事实。但是，如果使用英文版式（字符间距较大）的字体呈现法语，则*罚款*应该更窄，应该减少到 1/6 cadratin。

*   所以是的，U+2009（`&thinsp;`在 SGML 存储库中）可以稍微调整，具体取决于字体。

*   此外，它可能是部分对齐的（当使用完全对齐时，不仅通常的单词间空格的宽度增加了，而且字符和正常或“精细”空格之间的所有间隙（但其他四边形空格必须没有调整它们的宽度：它们确实是固定的）。

当您渲染页面布局已经预先计算（使用已知字体和精确度量）的文档时，细空间 (U+2009) 已经是您想要的（因为您不必担心破坏行为。

不幸的是，Unicode*忘记*为这些四边形空间 U+2000..U+2006（以及细空间 U+2009）分配换行属性中的不间断行为。

Unicode 纠正它的唯一方法（仅适用于纯文本文档）是在 Unicode 5.1 中添加另一个字符，即 U+202F（狭窄的非破坏空间），后来被赋予 SGML 符号名称“nnbsp”字符引用（但此命名字符实体到 U+202F 的映射不是任何 HTML 或 XML 标准的一部分，因此不应也使用此命名实体，除非您的文档在其嵌入的 DTD 中明确定义它！）

但不幸的是，大多数浏览器都忘记了应用这个添加以及为什么需要它：他们假设字符应该是字体，但显然情况并非如此。

所有浏览器都应该将 U+202F 视为非中断（这已经是这种情况，即使他们不知道其 UCD 内部副本中的字符）。

但是，浏览器不应该依赖于 U+202F 是在字体中定义的事实，相反，它们应该在渲染时提供对 U+2009 (THIN SPACE) 的回退，每次 U+202F 未映射到当前字体中, 但 U+2009 映射为同一种字体（很多字体一般都是这种情况）。

所以这是 HTML 渲染器（即浏览器）中的一个问题；我还认为这不仅仅是字体的问题，它实际上是浏览器的一个错误（而不是字体的错误或限制），如果它们不为空格提供这样的后备的话。当然，所有新字体都应该将 U+202F 映射到与 U+2009 相同的字形。

鉴于窄空间（U+2009 或`&thinsp;`）在许多字体中得到了很好的支持，并且具有正确的宽度，可以使用使用法语排版指标制作的字体渲染法语文本，或者渲染使用英语排版指标制作的英文文本，这应该真的是每次狭窄的不间断空间不可用时使用的正确后备！

您可以完美地模拟 HTML 中 U+202F 的所需行为，只需使用 U+2009 并使用 CSS 的“white-space:nowrap”使其不中断。它总是比改变字体大小来显示一个伪半空间更好（因为这对于许多仍然太大的字体是不正确的，而且因为这在文本范围内不能按预期工作有彩色背景：更改字体大小会修改行高）。

因此，请在您的 HTML 或 SVG 文档中使用此代码（仅对纯文本文档保留 U+202F）：

```
<span style="white-space:nowrap"> </span>
```

您可以将此序列保存在可重复使用的模板中，`Template:nnbsp`例如，您可以在 MediaWiki 中命名该模板，以便将其嵌入到您的页面中`{{nnbsp}}`。

请注意，仍然最好以符号方式引用细空间，`&thinsp;`而不是强制使用精确的 Unicode 代码点，例如`&#x2009;`：命名实体可以由渲染器重新映射，或根据用户偏好重新映射到另一个工作空白。

请注意，MS-word 确实使用 U+2009 而不是 U+202F 来表示它自己的*fine*。这是正确的，因为 Word 文档具有预先计算的布局，并且 MS-Word 在计算页面布局时在本地强制执行非中断行为。Word 文档不是纯文本文档。

*   渲染示例（使用背景颜色来展示行高未修改，但不幸的是，该站点不允许设置背景颜色，除非在`<code>`此处使用等宽字体的部分）：

`*Exemple de « fine » insécable française correctement codée !*`

*   同样**没有**容器`<code>`不显示背景色，但确实使用了正常的比例字体，这样细化的空间就被有效地渲染为细化了：

*Example de «fine» insécable française ; 更正代码！*

*   使用示例`&#x202F;`（大多数字体通常不支持 NNBSP，但这最终可能适用于您当前的浏览器和系统上安装的字体，例如*DejaVu Sans*）：

*Example de «fine» insécable française ; 更正代码！*

*   使用示例`&#x2006;`（SIXTH OF CADRATIN，可能会起作用，但对于您的字体来说可能太窄，并且可能不会表现出不间断的属性）：

*Example de «fine» insécable française ; 更正代码！*（嗯……不是真的）

*   使用示例`&nbsp;`（几乎总是太大）：

*Example de «fine» insécable française ; 更正代码！*（嗯……不是真的）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T16:48:36.423

我做了更多的挖掘，它看起来确实是一个字体问题。[FileFormatInfo](http://www.fileformat.info/)对于处理一般的 Unicode 问题非常有用，它包括一个列出支持[此特定字符的字体的](http://www.fileformat.info/info/unicode/char/202f/index.htm)[页面](http://www.fileformat.info/info/unicode/char/202f/fontsupport.htm)。甚至还有一个 Flash 工具（单击页面上列出支持的字体的蓝色框内以访问它 - 由于某种原因我无法创建正确的 URL），它列出了您本地安装的所有字体并为每个字体显示此字符.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T16:09:34.880

为什么不只是`&#x202F;`？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T16:13:39.957

你可以这样做，但这并不理想。

```
<span style="font-size:50%;"> </span> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-25T07:30:19.837

您可以在 CKEditor 等所见即所得编辑器中按 Ctrl+shift+2，然后转到源 HTML 视图。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-25T13:34:10.263

最糟糕的黑客攻击：

```
<span style="margin:-0.08em">&nbsp;</span> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-07-20T15:07:24.357

附录 2021：如今，所有实际浏览器都可以渲染（狭窄的不间断空间）。这些“黑客”不再需要了:-)

# php - 将数组传递给存储过程

> ID：595371
> 
> 赞同：8
> 
> 时间：2009-02-27T16:05:59.647
> 
> 标签：php, mysql, stored-procedures

我正在尝试将一组值从 php 传递到 mysql 存储过程作为参数列表以及如何在存储过程中使用该数组。该过程中的查询在其中有三个 IN 语句，所以我想做`IN(@listOfids)`@listOfids 为 1,2,3,4 的位置（来自 php 的内爆数组）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T20:45:11.097

所以我有一个解决方法是将查询和参数连接起来，所以伪代码是

```
CREATE PROCEDURE `related_stories`(IN param1 VARCHAR(255), IN param2 VARCHAR(255), IN param3 VARCHAR(255), IN publishDate INT(11), IN tlimit INT(11))
BEGIN

SET  @query =CONCAT( '

select s.* from 
(

select * from 
(
 SELECT something where condition IN (',param1,')
) as table1

UNION ALL

select * from 
(
 SELECT something where condition IN (',param2,')
) as table2

UNION ALL

select * from 
(
 SELECT something where condition IN (',param3,')
) as table3

) as s

WHERE (s.publish_date < ',publishDate,') 
GROUP BY id limit ',tlimit,';');

PREPARE stmtInsert FROM @query;
EXECUTE stmtInsert;

END 
```

param1,param2,param3 是通过 php eg('1,2,3,4') 传入的内爆数组。希望这可以帮助某人

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T16:09:58.217

我认为这里的主要问题是 MySQL 不支持将数组作为数据类型。您需要与另一个表形成[一对多](http://en.wikipedia.org/wiki/One-to-many)关系，该表包含返回主数据和数组数据的外键。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T18:42:22.437

我认为您必须将其作为 csv 传递。Mysql 对循环不是很友好，所以无论如何你最好在外面做。就存储过程语言而言，我发现 Mysql 确实缺乏。

# c# - 在 C# 中处理此 TCP 连接的首选方法是什么？

> ID：595373
> 
> 赞同：0
> 
> 时间：2009-02-27T16:06:18.600
> 
> 标签：c#, .net, tcp, tcpclient, lifetime

我有一个服务器应用程序（单例、简单的 .NET 控制台应用程序），它与 GlobalCache GC-100-12 进行通信以路由 IR 命令。本地网络上的各种 .NET WinForm 客户端连接到我的服务器应用程序并向其发送 ASCII 命令。服务器应用程序将这些 ASCII 命令排队，然后通过 TCP 连接将它们发送到 GC-100-12。

我的问题是，从服务器的角度来看，处理此连接的最佳方法是什么？我可以想到两种方法：

1.  为每个单独的请求创建并打开一个新的 TcpClient。请求完成后关闭 TcpClient。

2.  在服务器启动时创建并打开一个 TcpClient 并使用 keep-alive（如有必要）在服务器对象的生命周期内保持连接打开。

我问这个问题是因为我想知道为每个请求创建一个新的 TcpClient 的开销。这是一项昂贵的手术吗？这是一个不好的做法吗？

目前我正在做#1，并将每次传输的结果打印到控制台。有时一些连接超时并且命令没有被路由，我想知道这是因为每次创建新的 TcpConnection 的开销，还是因为其他原因。

我可以看到＃2 更复杂，因为如果连接确实断开，则必须重新创建它，这将需要更多代码来处理这种情况。

我正在寻找有关此的任何一般性建议。我没有很多使用 TcpClient 类的经验。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T16:13:30.347

我们有一个类似的例子，打开一个远程登录会话到一个旧的基于 PICK 的系统。我们发现每次请求进入时打开 TCP 连接的成本相当昂贵，因此我们决定实现一个无操作例程来保持连接打开。它更复杂，但只要您的端点不尝试为许多客户提供服务，那么固定连接听起来像是一个可行的解决方案。

如果您想防止在没有流量时保持连接打开，您也可以将其设置为超时。五分钟没有活动然后关闭连接。

# python - What's the function like sum() but for multiplication? product()?

> ID：595374
> 
> 赞同：241
> 
> 时间：2009-02-27T16:06:36.133
> 
> 标签：python, product, built-in, pep

Python's [`sum()`](http://docs.python.org/library/functions.html#sum) function returns the sum of numbers in an iterable.

```
sum([3,4,5]) == 3 + 4 + 5 == 12 
```

I'm looking for the function that returns the product instead.

```
somelib.somefunc([3,4,5]) == 3 * 4 * 5 == 60 
```

I'm pretty sure such a function exists, but I can't find it.

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2009-02-27T16:13:48.363

Actually, Guido vetoed the idea: [http://bugs.python.org/issue1093](http://bugs.python.org/issue1093)

But, as noted in that issue, you can make one pretty easily:

```
from functools import reduce # Valid in Python 2.6+, required in Python 3
import operator

reduce(operator.mul, (3, 4, 5), 1) 
```

* * *

## 回答 #2

> 赞同：126
> 
> 时间：2018-02-06T17:32:11.397

# **Update:**

In Python 3.8, the *prod* function was added to the *math* module. See: [math.prod()](https://docs.python.org/3.8/library/math.html#math.prod).

## Older info: Python 3.7 and prior

The function you're looking for would be called *prod()* or *product()* but Python doesn't have that function. So, you need to write your own (which is easy).

## Pronouncement on prod()

Yes, that's right. Guido [rejected the idea](http://bugs.python.org/issue1093) for a built-in prod() function because he thought it was rarely needed.

## Alternative with reduce()

As you suggested, it is not hard to make your own using [*reduce()*](https://docs.python.org/2.7/library/functions.html#reduce) and [*operator.mul()*](https://docs.python.org/3/library/operator.html#operator.mul):

```
from functools import reduce  # Required in Python 3
import operator
def prod(iterable):
    return reduce(operator.mul, iterable, 1)

>>> prod(range(1, 5))
24 
```

Note, in Python 3, the [*reduce()*](https://docs.python.org/3/library/functools.html#functools.reduce) function was moved to the [functools module](https://docs.python.org/3/library/functools.html).

## Specific case: Factorials

As a side note, the primary motivating use case for *prod()* is to compute factorials. We already have support for that in the [math module](https://docs.python.org/2.7/library/math.html#math.factorial):

```
>>> import math

>>> math.factorial(10)
3628800 
```

## Alternative with logarithms

If your data consists of floats, you can compute a product using *sum()* with exponents and logarithms:

```
>>> from math import log, exp

>>> data = [1.2, 1.5, 2.5, 0.9, 14.2, 3.8]
>>> exp(sum(map(log, data)))
218.53799999999993

>>> 1.2 * 1.5 * 2.5 * 0.9 * 14.2 * 3.8
218.53799999999998 
```

Note, the use of *log()* requires that all the inputs are positive.

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2011-06-15T21:33:14.273

There's a [`prod()`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.prod.html) in numpy that does what you're asking for.

* * *

## 回答 #4

> 赞同：43
> 
> 时间：2009-02-27T16:11:54.843

There isn't one built in, but it's simple to roll your own, as demonstrated [here](https://stackoverflow.com/questions/493853/which-python-module-is-suitable-for-data-manipulation-in-a-list/494034#494034):

```
import operator
def prod(factors):
    return reduce(operator.mul, factors, 1) 
```

See answers to this question:

[Which Python module is suitable for data manipulation in a list?](https://stackoverflow.com/questions/493853/which-python-module-is-suitable-for-data-manipulation-in-a-list)

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2009-02-27T16:09:09.717

```
Numeric.product 
```

( or

```
reduce(lambda x,y:x*y,[3,4,5]) 
```

)

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2009-02-27T16:10:46.217

Use this

```
def prod(iterable):
    p = 1
    for n in iterable:
        p *= n
    return p 
```

Since there's no built-in `prod` function.

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2019-02-10T23:17:48.873

Perhaps not a "builtin", but I consider it builtin. anyways just use numpy

```
import numpy 
prod_sum = numpy.prod(some_list) 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-11-30T18:55:29.543

I prefer the answers [a](https://stackoverflow.com/a/595409/778533) and [b](https://stackoverflow.com/a/595396/778533) above using [functools.reduce()](https://docs.python.org/3/library/functools.html#functools.reduce) and the [answer](https://stackoverflow.com/a/6364663/778533) using [numpy.prod()](https://docs.scipy.org/doc/numpy/reference/generated/numpy.prod.html), but here is yet another solution using [itertools.accumulate()](https://docs.python.org/3/library/itertools.html#itertools.accumulate):

```
import itertools
import operator
prod = list(itertools.accumulate((3, 4, 5), operator.mul))[-1] 
```

# flash - Flash OCX 错误使 IE6/7 崩溃

> ID：595385
> 
> 赞同：1
> 
> 时间：2009-02-27T16:09:17.687
> 
> 标签：flash, internet-explorer, crash, ocx

有没有人遇到过这个错误？我正在尝试为客户调试问题，但似乎无法解决这个问题。

通过清晰的 Internet 缓存，我访问[http://www.safcoproducts.com](http://www.safcoproducts.com)并且几乎每次（首次加载时）它都会使 IE 6 和 7 崩溃。这在 FireFox 中不会发生。我们已经在不同的服务器上测试了相同的文件，并且这个错误也不能被复制。

如果没有明确的缓存，错误似乎会随心所欲地来来去去。

有一个流媒体音乐播放器和一个渐进式下载视频“剧院”。

任何人都可以有所了解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-28T06:30:00.473

该错误只会发生在 IE 导致 ocx 表示 ActiveX。我建议使用[SWFObject嵌入您的 Flash 对象](http://code.google.com/p/swfobject/)

# java - What are the pros and cons for different methods of checking a Collection for a null before adding to a Set?

> ID：595390
> 
> 赞同：1
> 
> 时间：2009-02-27T16:10:46.123
> 
> 标签：java, api, exception, collections

This is a follow up question to "[Is there a basic Java Set implementation that does not permit nulls?](https://stackoverflow.com/questions/591115/is-there-a-basic-java-set-implementation-that-does-not-permit-nulls)". (thank you to all of those who helped with the answer)

It seems that the way to do this, since Sun didn't provide something simple like this OOTB, is with a wrapper / proxy. This seems nearly straight forward. What I am wondering is what are the pros/cons of the following two approaches of adding a collection, or is there another better approach?

Approach #1

```
public boolean addAll( Collection<? extends E> c) {
    if ( null == c ) {
        throw new NullPointerException( "c cannot be null" );
    }

    /*
     * This seems like a terrible abuse of exceptions when
     * all I want to do is check the set for a null.
     * 
     * However, simply running through each element of the
     * Collection may provide much worse performance for large
     * collections. And according to the Collection API, the
     * contains method may throw NullPointerExceptions if the
     * collection implementation does not allow null elements.
     */
    boolean collectionContainsNull = false;

    try {
        collectionContainsNull = c.contains(null);
    } catch (NullPointerException safeToIgnore) {
        /* Safe to ignore since we do not want nulls */
    }

    if (collectionContainsNull) {
        throw new NullPointerException("c cannot contain null elements");
    }

    this.wrapperSet.addAll(c);
} 
```

Approach #2

```
public boolean addAll( Collection<? extends E> c) {
    if ( null == c ) {
        throw new NullPointerException( "c cannot be null" );
    }

     E[] a = ( E[] )c.toArray();

     /*
     * We have to iterate through the entire collection to check for
     * a null. This won't take advantage of any optimizations that
     * c.contains may be using.
     *
     * We don't call add(e) here because if we hit a null midway through
     * we would violate the condition that the set remains unchanged
     * on error.
     */
     for ( E e : a ) {
         if (null == e) {
              throw new NullPointerException("c cannot contain nulls");
         }
     }

     this.wrapperSet.addAll(a);
} 
```

Thanks in advance!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T16:35:02.103

The second approach is better. Never hide exceptions - you are relying on the assumption that c.contains(null) only throws a NullPointerException in the case that there is a null in the collection. However if the NullPointeException is thrown because of a problem with an equals method you will have a bug in your code - and you will have hidden it.

Edit:

From the JavaDoc for contains, NullPointerException is thrown - if the specified element is null and this collection does not permit null elements (optional).

Given that it is an optional method you may wind up with an UnsupportedOperationException being thrown instead of the NullPointerExcepion (in addition to hiding the an error in equals).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T16:17:25.983

What's the point of converting to an array first, and then iterating through the array, rather than just iterating the collection? I'd do the second one without the extraneous conversion.

Or maybe do the add to a temporary set:

```
public boolean addAll( Collection<? extends E> c) {
    if ( null == c ) {
        throw new NullPointerException( "c cannot be null" );
    }

    Set<E> tempSet = new HashSet<E>();

     /*
     * We have to iterate through the entire collection to check for
     * a null. This won't take advantage of any optimizations that
     * c.contains may be using.
     *

     */
     for ( E e : c) {
         if (null == e) {
              throw new NullPointerException("c cannot contain nulls");
         }
         tempSet.add(e);
     }

     this.wrapperSet = tempSet;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T16:37:37.387

Making a copy of the argument collection in an array is safer. The collection argument may change concurrently (perhaps it is a concurrent collection) (or may be written maliciously).

Also catching runtime exceptions isn't a nice way to do things.

You might want to use `Object[]` instead of `E[]` and move the unsafe cast to later. You will also need an `Arrays.asList(a)` or similar.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T21:45:14.293

You could also add an a short-circuit to not test for nulls if the collection being added subclasses your NonNullCollection parent class.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-04T16:06:41.257

So it seems that both methods are bad. I really am only posting this answer to consolidate the information into a single post.

TofuBeer pointed out the overlooked flaw in logic for method 1 where there are other exceptions that could be thrown that will not be caught. So in general it is always bad to try to catch exceptions for unexceptional conditions.

Paul pointed out that what I thought was a safe cast really is not. I expected the collection generic to be enforced on the output cast, however it will returned Object[]. As he points out I could use a temp set to store the data while I search for a null.

Also, as Tom confirmed it is possible the collection argument may change concurrently so a defensive copy into a new object is a good idea).

So I guess the desired method is:

```
public boolean addAll( Collection<? extends E> c ) {
    if ( null == c ) {
        throw new NullPointerException( "c cannot be null" );
    }

     // Create a defensive copy to prevent concurrent modifications of c
     Set<E> tmpSet = new HashSet<E>( c );

     /*
      * We have to iterate through the entire collection to check for
      * a null. This won't take advantage of any optimizations that
      * c.contains may be using.
      */
     for ( E e : tmpSet ) {
         if ( null == e ) {
              throw new NullPointerException( "c cannot contain nulls" );
         }
     }

     return this.wrapperSet.addAll( tmpSet );
} 
```

# asp.net - 是否可以使用 Javascript 销毁由 ASP.NET (VB.NET) 设置的会话变量？

> ID：595392
> 
> 赞同：1
> 
> 时间：2009-02-27T16:10:47.840
> 
> 标签：asp.net, javascript, jquery, vb.net, session

正如标题所述，我有一个会话变量，该变量是在使用 asp.net 和 vb.net 代码隐藏的登录脚本期间设置的。当单击会破坏该会话变量的链接时，我可以调用 javascript 函数吗？

如果可能的话，我可以使用 jQuery 来简化这个过程吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T16:14:32.730

是的，`$.post("logout.aspx");`在您的 Javascript 中使用，并创建文件 logout.aspx 来破坏会话。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T16:15:33.867

服务器端代码（在您的情况下为 VB.NET）是唯一可以访问会话及其变量的东西。最好的办法是创建一个 WebService/WebMethod 并使用 jQuery 来调用它。

本文应该可以帮助您入门：[使用 jQuery 使用 ASP.NET JSON Web 服务](http://encosia.com/2008/03/27/using-jquery-to-consume-aspnet-json-web-services/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T16:13:18.457

不明确 - 会话变量存在于服务器上，而 Javascript 在客户端运行。

您可以做的最好的事情是使用 JS 向服务器发送请求（可能通过 Ajax），这将导致服务器删除会话变量。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T16:16:02.023

删除 ASP.NET 会话 cookie

```
document.cookie = 'ASP.NET_SessionId=xxx'; 
```

# ruby-on-rails - Ruby on Rails：序列化 UTF8 问题

> ID：595393
> 
> 赞同：4
> 
> 时间：2009-02-27T16:11:39.150
> 
> 标签：ruby-on-rails, activerecord, utf-8, yaml, serialization

当我序列化包含 UTF8 字符串的哈希时，如下所示：

```
 poll.variants = {0 => 'тест',1 => '-тест-',2 => 'test # test "тест'} 
```

到 ActiveRecord 字段，结果字段包含：

```
--- 
0: !binary |
  0YLQtdGB0YI=

1: !binary |
  LdGC0LXRgdGCLQ==

2: !binary |
  dGVzdCAjIHRlc3QgItGC0LXRgdGC 
```

由于某种原因，utf8 字符串被视为二进制和 base64 编码。场上的排序是`utf8_general_ci`，我有点失望。

有没有办法让 ActiveRecord :serialize 人类可读的 yaml 到现场？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T16:18:28.837

> 有没有办法让 ActiveRecord :serialize 人类可读的 yaml 到现场？

不会。它的 Base64 编码是为了将任意文本（以任何编码）编码到最低的通用 denonimator，然后可以安全地通过线路发送和/或存储在不接受 UTF-8 数据的数据存储中。

# c# - 简单的减法和投射题

> ID：595399
> 
> 赞同：3
> 
> 时间：2009-02-27T16:12:34.950
> 
> 标签：c#, casting

为什么这个简单的减法不起作用？

```
int MyPageNumber = Convert.ToInt32(cboPageNumber.SelectedItem);
MyPageNumber += (MyPageNumber - 1); //does not work
int MyNewPageNumber = MyPageNumber - 1; /works 
```

我还希望有人能告诉我为什么这给了我一条“红线”，因为我无法进行演员表：

```
short MyPageNumber = Convert.ToInt16(cboPageNumber.SelectedItem);
MyPageNumber += MyPageNumber - ((short) 1); //does not work says can't cast 
```

我不明白什么？示例中的 + 是否将其转换为字符串？

谢谢你。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-27T16:15:08.343

看看这到底是做什么的：

```
MyPageNumber += (MyPageNumber - 1); 
```

它将MyPageNumber-1*添加*到现有值。因此，如果 MyPageNumber 为 5，您最终会得到 9 而不是您可能想要的 4。

现在对于第二个问题，您基本上遇到了与此等效的情况：

```
short x = 5;
short y = 10;
short z = x - y; 
```

看起来不错，但 C# 实际上并没有用于短裤的减法运算符 - 它只在整数上有它，所以它隐式地将`x`和转换`y`为`int`. 结果是`int`太，您不能将其分配回`z`. 你需要：

```
short z = (short) (x - y); 
```

（或与您的真实变量名称等效的名称）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T16:16:37.937

定义“不起作用” - 对我来说似乎很好......特别是：

```
int MyPageNumber = Convert.ToInt32("3");
MyPageNumber += (MyPageNumber - 1); // 5 as expected 
```

第二个；由于 CPU 效率等原因，所有`short`算术都会导致 int；尝试：

```
MyPageNumber += (short)(MyPageNumber - ((short)1)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T16:16:02.430

如果 MyPageNumber 等于 3，则第一个等式将产生 5，第二个等式将产生 2。

此外，您不需要将 1 转换为短...转换是不必要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T16:17:12.397

```
MyPageNumber += (MyPageNumber - 1); 
```

表示将 MyPageNumber 减一，然后将其结果添加到 MyPageNumber 的旧值。

例如，如果 MypageNumber 为 3：

3 += (3 - 1)
3 += 2
5

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T16:19:13.560

你可以这样做：

```
short magicNumber=1;
MyPageNumber +=MyPageNumber-magicNumber; 
```

你也可以做

```
MyPageNumber += (short)(MyPageNumber-1); 
```

请参阅此[MSDN 文章](http://msdn.microsoft.com/en-us/library/ybs77ex4(VS.80).aspx)

# asp.net - 替换用户控件中的 body.onload

> ID：595410
> 
> 赞同：1
> 
> 时间：2009-02-27T16:13:51.343
> 
> 标签：asp.net, javascript

我正在重构一个用于`<body onload="myJS();">`用户控件的页面。我知道我可以在加载时使用服务器端脚本注册来做到这一点。

如果我想在客户端（ascx）做这件事，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T16:18:51.300

取自[http://snipplr.com/view/3116/cross-browser-add-event-listener/](http://snipplr.com/view/3116/cross-browser-add-event-listener/)

```
// Cross-browser implementation of element.addEventListener()

function addEvent(evnt, elem, func) {
    if (elem.addEventListener) // W3C DOM
        elem.addEventListener(evnt,func,false);
    else if (elem.attachEvent) { // IE DOM
        var r = elem.attachEvent("on"+evnt, func);

    return r;
} 
```

像这样使用它：`addEvent(window, your_onload_handler)`. 或者你可以只使用 jquery 来做这个和很多其他的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T16:42:51.647

Romme 的客户端方法是最好的。但是以防万一有人想知道如何使用 ASCX 文件中的服务器端代码来做到这一点，请将其粘贴在模板的顶部：

```
<script runat="server">

protected override void OnInit(EventArgs e)
{
    base.OnInit(e);
    string strScript = "myJS();";
    Page.ClientScript.RegisterStartupScript(this.GetType(), "OnLoadScript_" + this.ClientID, strScript, true);
}

</script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T20:09:59.840

**OnLoad**通常是初始化 JS 的一种不好的方法，因为它仅在所有资源完成加载（包括页面中的任何图像）时才会触发。

**在页面**完成加载时调用要执行的 Javascript 的最简单、最可靠的方法是在 HTML 底部的结束标记`<script>`之前放置一个内联块：`</body>`

```
 <body>
   ... your page here ...
   <script>myJS();</script>
 </body>
</html> 
```

# java - 从哪儿开始？具有多个前端的 Java 应用程序

> ID：595416
> 
> 赞同：0
> 
> 时间：2009-02-27T16:15:16.987
> 
> 标签：java

我有一个多年前编写的应用程序，它由一个直接查询数据库服务器的重量级前端组成。该应用程序在大约 7 个专用工作站上运行。我还创建了一个基于 Web 的前端，它共享相同的功能集，还有一个基于 Web 的管理，用于管理和报告数据——它们都直接访问数据库。

该应用程序非常简单，我非常了解它解决的问题。它可以使用更新，我什至无法再访问在 GUI 上工作所需的工具。我最近开始接触 Java，似乎重写这个应用程序将是一个很好的入门项目。

所以我的问题是：

该应用程序将需要一个非 Web GUI，我想在 Swing 中。出于非常特殊的原因，这是必要的。该应用程序还需要一个基于 Web 的 GUI，该 GUI 具有与可能部署为 JSR-168 portlet 的 Swing front 完全相同的特性，以及一个基于 Web 的管理工具（也包括 portlet）。在我之前的设计中，我得到了很多重复的代码，因为每个组件都有自己的代码库，而且我愚蠢地使用存储过程来帮助确保关键计算至少是一致的。

我应该从哪里开始？我很难思考这应该如何在 Java 世界中工作。我想我遇到的最困难的事情是如何创建一个应用程序，它可以同时具有 Swing（或其他）前端和基于 Web 的前端，并且尽可能少地重复？

编辑：我从概念上知道这是如何*工作*的。我要问的是专门与 Java 技术相关的建议。要考虑哪些框架等。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T16:32:42.203

构建一个包含业务逻辑的核心。使用 JDepend 或类似工具来确保它在任何地方都不会引用任何 swing 或任何 web/jsp/servlet。

构建两个 UI：对于 Web 版本，选择您选择的 Web 框架并从那里调用您的业务逻辑。

对于 Swing 框架，您有两个选择：通过 web 服务访问业务逻辑（您可以使用 RMI 或其他什么，但我不会），即逻辑位于为 webapp 提供服务的同一 web 服务器上（我可能更喜欢那个）。另一种方法是使用 Swing GUI 发布 weblogic。使编码和调试更容易，但是现在您有多个访问数据库的点，当您想要使用缓存时会导致头痛

在任何情况下，您都应该只复制 gui 的东西，一次在 html/css/javascript 中，一次在 swing 中。

恭喜这个项目，它将教你大量关于设计和软件架构的知识

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T16:19:37.430

使用中间层服务器。

* * *

Swing 客户端 -> 带有 spring-remoting 的中间服务器 -> 数据库

Web客户端->带有spring-remoting的中间服务器->数据库

* * *

Web 客户端编写一次，任何 MVC 框架都可以工作，如果你勇敢地提醒它保持精简，那么它可以工作条带、支柱甚至 grails....

* * *

Swing 客户端使用 miglayout 和 glazelist 编写一次。

**[http://www.miglayout.com/](http://www.miglayout.com/)**

**[http://publicobject.com/glazedlists/glazedlists-1.8.0/](http://publicobject.com/glazedlists/glazedlists-1.8.0/)**

看看这个帖子......

**[Java Swing：库、工具、布局管理器](https://stackoverflow.com/questions/458817/java-swing-libraries-tools-layout-managers)**

* * *

中间服务器使用 jdbc 写入一次，因为您已经拥有 db..

**[http://www.springsource.org/](http://www.springsource.org/)**

* * *

数据库使用您喜欢的任何内容写入一次。好像已经有了这个......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T16:21:26.130

您应该有一个包含所有业务逻辑的项目。

然后，2 个单独的项目，1 个用于 Web 访问，1 个用于 Swing 应用程序。这些项目都调用业务逻辑 API。在这两个项目中，只有演示代码

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-02-27T16:29:26.330

显然从一个统一的代码库开始。您可能还想考虑是否真的需要多个接口。

你要确保你的代码没有不必要的依赖。例如，让你的 UI 尽可能浅，而不是通常的泥球。避免使用单例，因为它们会导致依赖地狱。

拥有一个中间层可能看起来很有企业精神，但它也增加了很多工作。对于一个小团体来说，这是完全没有意义的。

# unit-testing - 访问器的单元测试是必须的吗？

> ID：595421
> 
> 赞同：11
> 
> 时间：2009-02-27T16:16:23.567
> 
> 标签：unit-testing

对于除了其他方法之外还有多个 setter 和 getter 的类，考虑到在测试接口的其余部分时仍然会调用它们，是否可以节省为访问器编写单元测试的时间？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-27T16:18:40.147

如果他们做的不仅仅是设置或返回一个变量，我只会对它们进行单元测试。在某些时候，您需要相信编译器会为您生成正确的程序。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-27T17:34:01.230

绝对地。单元测试的想法是确保更改不会以未知方式影响行为。不为`getFoo()`. 如果您将类型更改为`Foo`更复杂一点，那么您很容易忘记测试访问器。如果您在质疑是否应该编写测试，最好还是编写它。

恕我直言，如果您正在考虑跳过为方法添加测试，您可能想问自己该方法是否必要。为了充分披露，我是*那些*只在证明有必要时才添加 setter 或 getter 的人之一。您会惊讶地发现，在构造之后您真的不需要访问特定成员的频率，或者当您只想访问真正依赖于成员的某些计算的结果时。但我离题了。

一个好的口头禅是总是添加测试。如果您认为不需要一个，因为该方法是微不足道的，请考虑删除该方法。我意识到常见的建议是跳过*“琐碎”*方法的测试是可以的，但你必须问问自己该方法是否必要。如果您跳过测试，您是在说该方法将**永远**是微不足道的。请记住，单元测试还可以作为*意图*和所提供*合同*的文档。因此，对平凡方法的测试表明该方法确实是平凡的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T16:20:52.310

我的测试标准是测试包含条件逻辑（while、if、for 等）的每一段代码。如果访问器是简单的获取器/设置器，我会说测试它们是在浪费你的时间。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-27T17:42:03.347

您不必为不包含逻辑的属性编写测试。

测试简单属性的唯一解释是提高测试覆盖率——但这很愚蠢。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-27T16:21:14.210

我认为节省时间而不编写您认为不会特别有用的单元测试是合理的。

虽然 100% 的测试覆盖率是一个令人钦佩的理想，但在某些时候，您会遇到收益递减的情况，即您花在编写测试上的时间不值得您从中获得收益。

如果您发现您认为它们有用的情况，您可以随时返回并添加更多单元测试。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-27T16:27:41.700

我们公司有两种人和意见。我倾向于不专门测试它们，因为它们通常是

*   自动生成
*   在另一个测试的上下文中进行测试（例如，有一些其他代码使用这些访问器
*   不包含任何可能破坏的代码

不过也有例外：

*   当它们不是简单地生成“getter”和“setter”时
*   当它们是只是为其他用户提供的重要 API 的一部分并且没有在您当前所在的上下文中真正测试时

这两种情况*都可*能使我对它们进行测试。第一个比第二个多。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-27T16:56:20.553

不费吹灰之力！浪费时间！

甚至 Bob Martin [See SO podcast 41](https://blog.stackoverflow.com/2009/02/podcast-41/)，敏捷的祖父也拒绝了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-27T16:19:27.057

如果您的 IDE 为成员访问器生成和管理修改——您不会做任何特别的事情——那么测试它们真的不重要；类型将匹配，命名将通过模板等。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-27T16:22:50.650

我想大多数人会说测试它们是在浪费你的时间。在 99% 的情况下，这是正确的。如果访问器中存在错误并且您的其余单元测试没有间接捕获它，那么我会开始质疑为什么该属性存在。

另一方面，测试访问器比问这个问题需要更少的打字:)

我个人测试它们。但这对我来说是一个灰色地带，我不会强迫我小组中的其他人来测试他们，只要他们对课程的功能有足够的覆盖。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-27T16:27:31.093

通常当我考虑编写单元测试时，我会问自己以下问题：

1.  getter/setter 是否访问 DAL（数据访问层）上的任何内容？

如果是这样，那么我将包括一个单元测试。以防万一，因为如果在将来的某个时候您决定实现延迟加载，或者比简单的 get/set 更高级的东西，那么您需要确保它正常工作。

2.  getter/setter 是否会抛出异常？

getter 的最佳实践是根本不允许它们抛出异常。塞特是另一回事。但是，无论哪种方式，如果您确定某个属性可能会引发异常，请为该属性编写一个单元测试，以实现成功访问和有目的地生成异常。

除此之外，我不会打扰，正如 Dan 指出的那样，“在某些时候，您需要相信编译器会为您生成正确的程序。”

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-27T16:19:19.973

我喜欢为他们进行单元测试。如果访问器除了简单地返回一个字段之外还做了任何类型的工作，那么该代码将被适当地测试。

即使给定的访问器除了返回一个字段之外没有做任何事情，它也可能在以后被修改以做一些额外的事情。

此外，这是一种增加正在运行的测试数量的简单方法，许多经理都喜欢这种方法。

# java - 为了得到这个 IllegalArgumentException，我在 Java 中做错了什么？

> ID：595424
> 
> 赞同：0
> 
> 时间：2009-02-27T16:17:08.293
> 
> 标签：java, swing

我偶尔会在使用 JTextArea.append() 更新的 JTextArea 中遇到异常...

```
java.lang.IllegalArgumentException: Invalid remove
    at javax.swing.JTextArea.replaceRange(Unknown Source)
    at sun.plugin.ConsoleWindow$24.run(Unknown Source)
    at java.awt.event.InvocationEvent.dispatch(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source) 
```

有什么我可能做错导致此异常吗？javadoc 建议该方法应该是线程安全的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T16:24:35.513

`Document`没有提供足够丰富的接口，无法以线程安全的方式有用地使用。`JTextArea`将在 JDK7 中删除一些线程安全声明。坚持在 AWT 事件调度线程 (EDT) 中更新 Swing 组件和 Swing 文本对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T16:31:17.387

查看这个非常有用的工具来检查 Swing 中的线程滥用：[http ://weblogs.java.net/blog/alexfromsun/archive/2006/02/debugging_swing.html](http://weblogs.java.net/blog/alexfromsun/archive/2006/02/debugging_swing.html)

# networking - 如何获取套接字的非 ACK-ed TCP 数据量？

> ID：595426
> 
> 赞同：10
> 
> 时间：2009-02-27T16:17:15.360
> 
> 标签：networking, sockets, tcp

Linux 具有手册页 tcp(7) 中描述的 ioctl SIOCOUTQ，它返回套接字缓冲区中未发送的数据量。如果我正确理解内核代码，则所有未确认的数据都被视为“未发送”。ioctl 至少从 2.4.x 开始可用。

{Free,Net,Open,*}BSD、Solaris、Windows 有什么相似之处吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-10-23T19:52:55.943

您可能需要（至少）两种不同的信息：尚未发送的数据量，以及已发送但未确认的数据量。

在 Linux 上：`SIOCOUTQ`记录了未发送数据的数量，但实际上给出了（未发送数据 + 已发送但未确认的数据）的总和。最近的一个[补丁（2016 年 2 月）](https://patchwork.ozlabs.org/patch/582097/)使得从结构中的`tcpi_notsent_bytes`字段中获取实际未发送的数据成为可能`TCP_INFO`。

在 macOS 和 iOS 上：`getsockopt(fd, SOL_SOCKET, SO_NWRITE, ...)`就像`SIOCOUTQ`：它被记录为给出未发送数据的数量，但实际上给出了（未发送数据 + 已发送但未确认数据）的总和。我不知道有什么方法可以获得更细粒度的信息。

在 Windows 上：[`GetPerTcpConnectionEStats`](https://msdn.microsoft.com/en-us/library/bb485738(VS.85).aspx)使用该`TcpConnectionEstatsSendBuff`选项可将未发送数据和已发送但未确认的数据[作为两个单独的数字提供](https://msdn.microsoft.com/en-us/library/ee720200(v=vs.85).aspx)。

我不知道如何在其他操作系统上获取此信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-26T23:44:39.630

由于 TCP/IP 是作为流设备实现的，因此可以深入内核并获取 queue->q_count（队列上的字节数）。

# sql - 如何比较两个表并删除 SQL 中的重复行？

> ID：595433
> 
> 赞同：6
> 
> 时间：2009-02-27T16:19:06.090
> 
> 标签：sql, sql-server, duplicate-data

我有两个表，如果第二个表中存在行的精确副本，我需要从第一个表中删除行。

有没有人有我将如何在 MSSQL 服务器中执行此操作的示例？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-27T16:22:34.427

好吧，在某些时候，您将不得不检查所有列 - 还不如加入...

```
DELETE a
FROM a  -- first table
INNER JOIN b -- second table
      ON b.ID = a.ID
      AND b.Name = a.Name
      AND b.Foo = a.Foo
      AND b.Bar = a.Bar 
```

应该这样做......还有`CHECKSUM(*)`，但这只会有*帮助*- 您仍然需要检查实际值以排除哈希冲突。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-27T16:23:49.477

如果您使用的是 SQL Server 2005，则可以使用[intersect](http://msdn.microsoft.com/en-us/library/ms188055.aspx)：

```
delete * from table1 intersect select * from table2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T16:23:05.690

我认为下面的伪代码会做到这一点..

```
DELETE FirstTable, SecondTable
FROM FirstTable
FULL OUTER JOIN SecondTable
ON FirstTable.Field1 = SecondTable.Field1
... continue for all fields
WHERE FirstTable.Field1 IS NOT NULL
AND SecondTable.Field1 IS NOT NULL 
```

不过，Chris 的 INTERSECT 帖子要优雅得多，以后我会使用它，而不是写出所有的外部连接标准 :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T16:23:39.197

我会尝试 DISTINCT 查询并合并两个表。

您可以使用 asp/php 之类的脚本语言将输出格式化为一系列插入语句，以重建表生成的唯一数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-09-05T13:36:49.687

试试这个：

```
DELETE t1 FROM t1 INNER JOIN t2 ON t1.name = t2.name WHERE t1.id = t2.id 
```

# openid - 如何更改 OpenID 的 ReturnUrl？

> ID：595434
> 
> 赞同：7
> 
> 时间：2009-02-27T16:19:11.067
> 
> 标签：openid, dotnetopenauth

当用户单击我的站点中需要身份验证的链接时，浏览器将被重定向到登录页面。登录页面包含一个 returnUrl 查询字符串参数。问题是，如果用户使用 OpenID 进行身份验证，提供商会将用户重定向回登录页面并且不包含 returnUrl 参数，这很无聊，因为我将用户重定向到主页而不是尝试过的页面.

我正在使用 DotNetOpenID，有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-03-04T20:47:51.970

这真的很容易，布鲁诺。打电话

```
IAuthenticationRequest.AddCallbackArguments("returnUrl", Request.QueryString["returnUrl"]); 
```

这将告诉 DotNetOpenId 保留登录页面上的 returnUrl 参数并获得您想要的行为。我不同意 Franci 关于将显示登录页面的 URL 与处理结果的 URL 分开的问题。对于*可能*合适的 ASP.NET MVC 站点，但对于 ASP.NET Web 表单，这确实不是可行的方法，因为除了向用户显示任何错误之外，您无疑还想再次显示登录表单。此外，就逻辑分离而言，DotNetOpenId 库为您完成了所有繁重的工作，因此您的代码隐藏页面中几乎没有任何逻辑。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T16:56:40.320

如果希望 OpenID 提供者返回不同的 url，则需要`OpenIdRelyingParty.CreateRequest(Identifier userSuppliedIdentifier, Realm realm, Uri returnToUrl)`在创建身份验证请求时使用该方法。

但是，通常您不希望 OpenID 提供程序重定向回在您的应用程序中启动登录序列的 url。您想回到您启动 OpenID 身份验证以正确处理响应的位置。有助于将 OpenID 层与应用程序中的其余逻辑封装在一起。

这是一个例子：

在我的 ASP.NET MVC 应用程序中，我有一个带有处理登录请求`User`的操作的控制器。`Authenticate`

动作`Authenticate`检查。`OpenIdRelyingParty.Response`如果是`null`，则动作调用`RedirectToProvider`。提供者返回到相同的操作，我在其中检查`Respons.Status`. 如果是`AuthenticationStatus.Authenticated`我用来返回用户启动登录序列的页面。[`FormsAuthentication.RedirectFromLoginPage`](http://msdn.microsoft.com/en-us/library/ka5ffkce.aspx)`(openid.Response.ClaimedIdentifier, true)`

但是，如果状态为`AuthenticationStatus.Failed`“AuthenticationStatus.Canceled”，我可以为用户提供解决此问题的步骤。如果输入错误，我可以让他们更正他们的 OpenID，或者改为使用用户名/密码登录。（我支持同一身份的 OpenID 和用户名/密码身份验证）

我的登录框在每个页面上。如果 OpenID 提供程序将我重定向回发起登录请求的页面，则该页面可能无法正确处理失败。

# asp.net - 在 ASP.NET Gridview 中批量插入/更新的推荐方法是什么？

> ID：595446
> 
> 赞同：2
> 
> 时间：2009-02-27T16:21:27.330
> 
> 标签：asp.net, gridview, bulkinsert

您将使用什么最佳实践或策略在启用分页的 asp.net gridview 控件中启用批量插入/更新？

例如，假设您有大约 10000 条记录，并且在页面加载时会填充此数据，这会以每个 Web 服务请求的 100 条记录块的形式发生。

要启用对这些行的编辑，您将采用哪种方法。

仅举一个例子，假设虚拟场景的对象模型如下所示。

列出客户；// 客户列表

客户 = ServiceFacade.GetAllCustomers(pageSize, currentPage);

假设上述服务调用根据每页显示 10 条记录的 pageSize 带回 50 条记录。

这将绑定到 gridView，如下所示。

gridCustomers.DataSource = 客户；gridCustomers.DataBind();

我会想到的一些要点概述如下，需要专家输入...

*   禁用 gridview 的视图状态（因为这会降低页面的性能）。
*   使用会话对象来持久化更改（或者你会推荐什么。两种方式绑定在这里真的有用吗，我不知道，因为我没有尝试过。）

非常感谢您的想法/建议。我知道我可能会为此感到愤怒，但我认为好的旧 DataSet 在这里可能很有用（因为它具有能够跟踪更改等的所有基本信息）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T11:57:35.500

看看[这篇关于代码项目](http://www.codeproject.com/KB/webforms/BulkEditGridView.aspx)的文章。

更新： 我在[这里](http://blogs.msdn.com/mattdotson/articles/490868.aspx)
找到了同类控件的更好实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T16:49:20.103

您是否考虑过不使用 ASP.Net GridView 来支持纯粹的客户端网格控件（即 JQuery 插件控件）？我建议您考虑的可能是使用客户端 JSON 或 XML 数据岛作为数据源，以存储用户所做的所有更改，然后一旦他们点击主提交按钮，将此有效负载发送到服务器并处理所有数据库在单个批次或往返中更新。

这样做的缺点是它可能会比 ASP.Net GridView 做更多的工作。此外，您还必须构建/合并一个乐观并发数据模型。完成后，您将拥有一个非常快速且流畅的界面，因为大多数操作将发生在客户端，而无需所有回发。几年前我建造了这样的东西，结果很好。

抱歉，我无法提供更多信息，但下面是它如何工作的一个**非常粗略的框架。**我希望这有帮助。

```
<html>
    <head>
        <SCRIPT LANGUAGE="javascript">
        var xmlDomItems;

        function initialize()
        {
            xmlDomItems = document.all("itemsXML").XMLDocument;
            docProds.async = false;
        }

        function ModifyXMLDOM()
        {
          // just work with the xmlDomItems variable just like you would with an .Net XMLDocument Object.
        }

        function SumbitChangePayload()
        {
          // submit xmlDomItems.OuterXML to some AJAX or web service endpoint in an async manner.
        }
        </SCRIPT>
    </head>
    <body onload="initialize()">

        <XML id="itemsXML">
            <Items>
            <%
            // Server side code to render XML inner contents here...

            %>
            </Items>
        </XML>
        <form>
            <!-- build your UI here -->

            <input type="button" onclick="SumbitChangePayload()" value="Submit" />
        </form>
    </body>
</html> 
```

# c - 为什么 strcmp() 在其输入相等时返回 0？

> ID：595450
> 
> 赞同：22
> 
> 时间：2009-02-27T16:22:42.850
> 
> 标签：c, strcmp

当我像这样调用 C 字符串比较函数时：

```
strcmp("time","time") 
```

它返回 0，这意味着字符串不相等。

谁能告诉我为什么 C 实现似乎会这样做？我认为如果相等，它将返回一个非零值。我很好奇我看到这种行为的原因。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-02-27T16:25:40.677

strcmp 返回您作为参数给出的两个字符串的词法差异（或者我应该称之为“短路串行字节比较器”？:-)）。0 表示两个字符串相等

正值意味着 s1 在字典中位于 s2 之后。

负值意味着 s1 在字典中将在 s2 之前。

因此，在比较明显不同的“时间”和“金钱”时，您的非零值，即使有人会说时间就是金钱！:-)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-27T17:09:29.290

像这样的实现的好处是你可以说

```
if(strcmp(<stringA>, <stringB>) > 0)   // Implies stringA > stringB
if(strcmp(<stringA>, <stringB>) == 0)  // Implies stringA == stringB
if(strcmp(<stringA>, <stringB>) < 0)   // Implies stringA < stringB
if(strcmp(<stringA>, <stringB>) >= 0)  // Implies stringA >= stringB
if(strcmp(<stringA>, <stringB>) <= 0)  // Implies stringA <= stringB
if(strcmp(<stringA>, <stringB>) != 0)  // Implies stringA != stringB 
```

请注意与 0 的比较如何与暗示中的比较完全匹配。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-27T16:55:11.040

对于常见的或独一无二的情况，函数返回零是很常见的，而对于特殊情况，函数返回非零是很常见的。以 main 函数为例，它通常在成功时返回零，而在失败时返回一些非零值。精确的非零值表明出了什么问题。例如：内存不足，没有访问权限或其他。

在您的情况下，如果字符串相等，那么除了字符串包含相同的字符外，没有其他理由相等*。*但是如果它们不相等，那么第一个可以更小，或者第二个可以更小。让它返回 1 表示相等，0 表示较小，2 表示较大，我认为这有点奇怪。

你也可以从减法的角度来考虑：

```
return = s1 - s2 
```

如果 s1 “按字典顺序”较少，那么它将给出一个负值。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-09-02T04:58:48.077

返回它所做的代码的另一个原因`strcmp()`是它可以直接在标准库函数中使用`qsort()`，允许您对字符串数组进行排序：

```
#include <string.h> // for strcmp()
#include <stdlib.h> // for qsort()
#include <stdio.h>

int sort_func(const void *a, const void *b)
{
    const char **s1 = (const char **)a;
    const char **s2 = (const char **)b;
    return strcmp(*s1, *s2);
}

int main(int argc, char **argv)
{
    int i;
    printf("Pre-sort:\n");
    for(i = 1; i < argc; i++)
        printf("Argument %i is %s\n", i, argv[i]);
    qsort((void *)(argv + 1), argc - 1, sizeof(char *), sort_func);
    printf("Post-sort:\n");
    for(i = 1; i < argc; i++)
        printf("Argument %i is %s\n", i, argv[i]);
    return 0;
} 
```

这个小示例程序按 ASCII 顺序对其参数进行排序（有些人会按词法调用）。看：

```
$ gcc -o sort sort.c
$ ./sort hi there little fella
Pre-sort:
Argument 1 is hi
Argument 2 is there
Argument 3 is little
Argument 4 is fella
Post-sort:
Argument 1 is fella
Argument 2 is hi
Argument 3 is little
Argument 4 is there 
```

如果相等的字符串`strcmp()`返回`1`(true)，不相等的返回( `0`false)，则不可能用它来获得两个字符串之间不等的*程度*或*方向*（即不同的程度，哪个更大），从而使不可能将其用作排序功能。

我不知道你对 C 有多熟悉。上面的代码使用了 C 中一些最令人困惑的概念——指针算术、指针重铸和函数指针——所以如果你不理解其中的一些代码，请不要担心，你会及时到达那里。在那之前，你会在 StackOverflow 上问很多有趣的问题。;)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-27T16:53:25.523

你似乎想像`strcmp`（假设的）一样工作

```
int isEqual(const char *, const char *) 
```

为了确保整数结果的“零是假”解释是正确的，但这会使排序逻辑复杂化，因为在确定两个字符串不相同之后，您仍然需要了解哪个“更早”出现”。

此外，我怀疑一个常见的实现看起来像

```
int strcmp(const char *s1, const char *s2){
   const unsigned char *q1=s1, *q2=s2;
   while ((*q1 == *q2) && *q1){ 
      ++q1; ++q2; 
   };
   return (*q1 - *q2);
} 
```

这是[**编辑：**有点]以 K&R 的方式优雅。这里的重点（通过正确编写代码而越来越模糊（显然我应该单独留下足够好的东西））是 return 语句的方式：

```
 return (*q1 - *q2); 
```

它根据字符值自然地给出比较结果。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-27T17:25:53.620

有三种可能的结果：字符串 1 在字符串 2 之前，字符串 1 在字符串 2 之后，字符串 1 与字符串 2 相同。将这三个结果分开很重要；strcmp() 的一种用途是对字符串进行排序。问题是您希望如何为这三个结果分配值，以及如何使事情或多或少保持一致。您还可以查看 qsort() 和 bsearch() 的参数，它们需要与 strcmp() 类似的比较函数。

如果你想要一个字符串相等函数，它会为相等的字符串返回非零值，为不相等的字符串返回零值，以符合 C 的真假规则。这意味着将无法区分字符串 1 是在字符串 2 之前还是之后。对于 int 或您想命名的任何其他 C 数据类型有多个真值，但只有一个为假。

因此，有一个有用的 strcmp() 为字符串相等返回 true 将需要对语言的其余部分进行大量更改，而这根本不会发生。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-27T16:57:22.423

我想这只是为了对称：-1 如果小于，0 如果相等，1 如果更多。

# algorithm - 在特定条件下将数字列表分配给 N 组的算法

> ID：595456
> 
> 赞同：3
> 
> 时间：2009-02-27T16:23:47.823
> 
> 标签：algorithm

假设我有一个数字列表：

```
2,2,3,4,4 
```

将数字分成 N 组（这里以 3 组为例）：

```
A:2,3 sum:5

B:4   sum:4

C:2,4 sum:6 
```

我想要的是最小化总和最高的组（此处为 6）-总和最小的组（此处为 4）。

有没有人想到一种算法来实现这一点？

* * *

另一个例子：

```
7,7,8,8,8,9,9,10 
```

结果应如下所示：

```
A:7,8,8 sum:23

B:7,8,9 sum:24

C:9,10  sum:19 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T16:30:25.033

不幸的是，这个问题是 NP 难题。请参阅有关[多处理器调度](http://en.wikipedia.org/wiki/Multiprocessor_scheduling)或[装箱](http://en.wikipedia.org/wiki/Bin_packing_problem)的参考资料。如果您对这种方法感兴趣，您也可以找到一些有用的近似算法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T16:29:37.747

考虑到即使 N 是 2，问题也是 NP 完全的，我可以给你一个非常糟糕的算法。

[http://mathworld.wolfram.com/NumberPartitioningProblem.html](http://mathworld.wolfram.com/NumberPartitioningProblem.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T16:30:54.827

Zweiterlinde 建议检查[垃圾箱包装](http://en.wikipedia.org/wiki/Bin%5Fpacking%5Fproblem)是可行的方法。

我继续发布了这个，在我全部输入之后意识到它是错误的。

您需要一种贪婪的方法，首先使用最大的数字。

1.  对列表进行排序以实现排序
2.  开始将最大的数字分组 - 尽可能多地达到第一个数字
3.  达到最大组数时停止
4.  按总和对您的组进行排序，并通过将最大的数字添加到最小的组来重复，重复直到完成。

这应该让你：从 2,2,3,4,4 ...

```
group 1 (4): 4
group 2 (6): 4, 2
group 3 (5): 3, 2 
```

从 7,7,8,8,8,9,9,10 ...

```
group 1 (18): 10, 8
group 2 (24): 9, 8, 7
group 3 (24): 9, 8, 7 
```

虽然我猜第二个例子可以做为 19, 24, 23 这使得这个错误。哼。

# winforms - Windows 窗体的 UI 设计模式（如 WPF 的 MVVM）

> ID：595469
> 
> 赞同：167
> 
> 时间：2009-02-27T16:26:09.457
> 
> 标签：winforms, design-patterns

MVVM 最常与 WPF 一起使用，因为它非常适合它。但是 Windows 窗体呢？对于 Windows 窗体，是否也有类似的既定且常用的方法/设计模式？一种与 Windows 窗体一起工作得很好的工具？有没有一本书或一篇文章很好地描述了这一点？也许基于 MVP 或 MVC？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2009-02-27T16:40:11.733

我已经尝试过 MVP，它似乎也适用于 windows 窗体。这本书有一个带有 MVP 模式的 windows 窗体示例（示例工资单应用程序）。该应用程序并不复杂，但会让您了解如何创建它。

[C# 中的敏捷原则、模式和实践](https://rads.stackoverflow.com/amzn/click/com/0131857258)...

您可以在 [Source Code处获取源代码](http://www.objectmentor.com/PPP/)

## 编辑：

MVP 模式有两种变体（a）被动视图和（b）监督控制器

对于复杂的数据绑定场景，我更喜欢使用监督控制器模式。在监督控制器模式中，数据绑定的责任在于视图。因此，对于树视图/数据网格，这应该在各自的视图中，只有与视图无关的逻辑应该移至演示者。

我会推荐看看下面的 MVP framework [MVC# - An MVP framework](http://www.mvcsharp.org/)

不要以名称命名（它是一个 MVP 框架）。

简单的 winforms MVP 视频 [Winforms - MVP](http://polymorphicpodcast.com/podcast/video/mv-patterns/winforms/)

一个处理下拉列表 [MVP的例子——DropDownList](http://blog.jpboodhoo.com/CommentView,guid,5211de5c-1a52-410f-8ce6-ac8d5d8f57d4.aspx)

## 简单的树视图绑定示例（穷人的绑定）。您可以在 BindTree() 中添加任何特定于树视图的逻辑。

下面是代码片段....未经测试，直接从思想中键入....

```
public interface IYourView
{
   void BindTree(Model model);
}

public class YourView : System.Windows.Forms, IYourView
{
   private Presenter presenter;

   public YourView()
   {
      presenter = new YourPresenter(this);
   }

   public override OnLoad()
   {
         presenter.OnLoad();
   }

   public void BindTree(Model model)
   {
       // Binding logic goes here....
   }
}

public class YourPresenter
{
   private IYourView view;

   public YourPresenter(IYourView view)
   { 
       this.view = view;
   }

   public void OnLoad()
   {
       // Get data from service.... or whatever soruce
       Model model = service.GetData(...);
       view.BindTree(model);
   }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-03-12T04:05:53.653

正如它已经说过的，我在使用 Winforms 时总是以 MVP 模式工作。但是你会使用的设计模式并不意味着你会使用正确。MVP 附带了大量的反模式。

如果您想以良好的方式启动一切，则必须使用构建智能客户端的框架。所以我会推荐使用那个设计和实践：**Smart Client Software Factory** [http://www.codeplex.com/smartclient](http://www.codeplex.com/smartclient)

您在这里讨论了当前的智能客户端框架：[http ://codebetter.com/blogs/glenn.block/archive/2008/05/10/prism-cab-and-winforms-futures.aspx](http://codebetter.com/blogs/glenn.block/archive/2008/05/10/prism-cab-and-winforms-futures.aspx)

PS：我喜欢这篇关于 MVP 反模式的帖子：http: [//blog.mattwynne.net/2007/06/13/mvp-smells/](http://blog.mattwynne.net/2007/06/13/mvp-smells/)

希望这可以帮助

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2010-09-20T18:06:24.327

模型-视图-**视图模型 (MVVM)**模式是一种设计模式。根据定义，设计模式展示了面向对象世界中的通用解决方案，并且该解决方案可以应用于各种平台（WPF、WinForms、Java Swing 等）。我同意 MVVM 最适合与 WPF 一起使用，因为它利用了强大的绑定功能。但是，Windows 窗体也支持数据绑定。

The **[WAF Windows Forms Adapter](http://waf.codeplex.com/wikipage?title=Downloads&referringTitle=Home)** shows how to apply the MVVM Pattern in a Windows Forms application.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-08-03T21:09:18.847

我已经写过一种称为 MVP-VM 的 MVP/MVVM 设计模式的变体，它是为需要完整测试覆盖率并使用数据绑定作为保持演示文稿随模型数据更新的主要机制的 winforms 应用程序量身定制的解决方案。

[.NET Winforms 的 MVVM](http://aviadezra.blogspot.com/2009/08/mvp-mvvm-winforms-data-binding.html)

> MVVM（模型视图视图模型）引入了类似的方法，用于在支持数据绑定 (WPF) 的环境中将表示与数据分离。由于 .NET 框架 2.0 已经提供了高级数据绑定基础设施，它还允许在设计时绑定应用程序对象——“视图模型”实体可以非常适合基于 MVP 的环境。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-03-14T00:36:20.867

我相信 MVP 是一种非常适合 WinForms 开发的模式——它在[CAB](https://en.wikipedia.org/wiki/Composite_UI_Application_Block)中的使用部分证明了这一点——微软的 WinForms 框架。

我在 WinForms 中使用 MVP 从视图中提取代码 - 因为我无法测试视图代码。并且还可以使需要重用（或重复）的代码远离无法共享的视图。

我可以参考我自己使用 MVP 模式[ExceptionReporter.NET](https://github.com/PandaWood/ExceptionReporter.NET)的项目。虽然我确信我没有完美地使用它。

您提到了为 WPF 工作的 MVVM - 我认为原因是因为强大的数据绑定支持。如果您没有在 WPF 中使用数据绑定（当然这不是强制性的），那么您可以选择 MVP。MVP 是任何客户端应用程序的最佳选择。如果您计划在非 WPF 项目之间共享代码，那么即使在 WPF 中，这也可能是一个“更好”的选择。

有关在 WinForms 中使用 MVP 价值的更多证据，请参阅 Boodhoo 关于使用 MVP 的视频演示： [http ://www.bestechvideos.com/2008/06/29/dnrtv-show-14-jean-paul-boodhoo-on-model -view-presenter](http://www.bestechvideos.com/2008/06/29/dnrtv-show-14-jean-paul-boodhoo-on-model-view-presenter) 和同一作者的 MSDN 文章[http://msdn.microsoft.com/en-us/magazine/cc188690.aspx](http://msdn.microsoft.com/en-us/magazine/cc188690.aspx)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-05-27T00:42:15.240

I asked this same question to two of my techies co-workers: is MVVM for WindowsForms possible? Both gave me the exact same answer: "*No way! WindowsForms is missing the rich bindings of WPF and Silverlight (OneTime, OneWay, TwoWay, OnewayToSource) and it is also missing the TypeConverters*."

*   Screen Activator Pattern for WindowsForms - you can find it [here](http://caliburnmicro.codeplex.com/SourceControl/network/Forks/jagui/WinForms), ported from Caliburn.Micro by jagui
*   Rich Bindings and TypeConverters - [Truss](http://truss.codeplex.com/) by Kent Boogaart, does it in an UI independent way
*   命令 - [WPF 应用程序框架 (WAF)](http://waf.codeplex.com/)有一个 WafWinFormsAdapter 项目，该项目负责处理一些 MVVM 内容，即命令

同样，我们可以为 WinForms 提供 MVVM 吗？我们可以。我们有所有的部分。我们只需要将它们粘合在一起。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-03-11T05:36:15.863

您可以使用[企业架构、模式和实践](http://msdn.microsoft.com/en-us/library/aa286494.aspx)作为起点，尽管它们有些过时。

在一般指导下有[.NET 的应用程序架构：设计应用程序和服务](http://msdn.microsoft.com/en-us/library/ms954595.aspx)，这是对 .NET 方式和分层 N 层应用程序的一个很好的介绍。

[替代文字 http://i.msdn.microsoft.com/ms954595.f00aa01%28en-us%2CMSDN.10%29.gif](http://i.msdn.microsoft.com/ms954595.f00aa01%28en-us%2CMSDN.10%29.gif)

对于更正式的“模式”，有[使用 Microsoft .NET 的企业解决方案模式](http://msdn.microsoft.com/en-us/library/ms998469.aspx)。 [（来源：][[microsoft.com](http://i.msdn.microsoft.com/ms998492.Chp_02OrganizingPatterns_Fig06%28en-us%2CMSDN.10%29.gif)][）][![替代文字](https://i.stack.imgur.com/gk16t.gif)](https://i.stack.imgur.com/gk16t.gif)

仅举几例，

*   [模型-视图-控制器](http://msdn.microsoft.com/en-us/library/ms978748.aspx)
*   [拦截过滤器](http://msdn.microsoft.com/en-us/library/ms978727.aspx)
*   [三层服务应用](http://msdn.microsoft.com/en-us/library/ms978689.aspx)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-03-12T13:46:43.787

> BindTree 方法对我来说似乎有点缺陷。突然，视图知道了模型。那是件好事儿吗？一定有很多人面临着这类问题。我很惊讶没有任何关于它的书。因为有关于 .NET 世界中所有内容的书籍。

这些设计不是关于隐藏模型，而是精确定义应用程序不同层之间的交互。您可以完全更改后端，只要您通过 Bindtree 传递模型，您的 UI 将继续工作。

现在，在 Rajesh 给出的示例中，类 Model 可能是一个糟糕的名称选择。它可以是 TreeData 或 RecordsData。无论您如何定义它，它都具有使用 Winforms 的绑定机制将特定控件绑定到底层数据所需的功能。

浏览此类材料的最佳站点是[这里](http://www.martinfowler.com/eaaDev/)。Martin Fowler 收集了各种有用的 UI 设计模式和企业设计模式。

同样，关键是使用接口来精确定义每一层如何相互交互。

在我自己的应用程序（用于运行金属切割机的 CAD/CAM 应用程序）中，我的结构看起来像这样。

*   实现表单接口的表单
*   UIDLL 具有实现视图接口的视图，这些视图接口通过表单接口与表单交互。特定视图向 UIViewDLL 注册自身，视图执行与模型交互的命令库中的命令对象。
*   命令库；实现 ICommand 的命令列表。与视图交互的命令是通过 UIViewDLL 中公开的接口来实现的。
*   UIViewDLL；公开命令使用的视图接口。
*   模型; 构成我的应用程序核心数据结构的类和集合。对我来说，这些是材料、切割路径、形状、板材、火炬等。
*   效用; 一个 DLL，它具有我公司使用的跨不同应用程序的常用实用程序类。例如复杂的数学函数。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-03-12T17:42:46.983

我读到的关于 UI 设计模式的第一个很好的解释是在 Jeremy Miller 的博客 -[构建你自己的 CAB](http://codebetter.com/blogs/jeremy.miller/archive/2007/07/25/the-build-your-own-cab-series-table-of-contents.aspx)中。它描述了常见模式 - 被动视图、MVP 等，并解决了您可能在 C# 中实现它们的一些方法。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-04-03T12:22:15.050

您可以尝试[MugenMvvmToolkit](https://github.com/MugenMvvmToolkit)，它允许为 WinForms 使用“纯 MVVM”。由于它支持所有平台上的绑定，所有可用于 WPF 平台的本机绑定功能在所有平台上都可用（包括 WinForms）。

# iphone - UITableView 的 reloadData 有多贵？

> ID：595471
> 
> 赞同：5
> 
> 时间：2009-02-27T16:26:30.487
> 
> 标签：iphone, objective-c, cocoa-touch

我很好奇 UITableView 的 reloadData 在资源方面有多贵？我有一个应用程序，它将发出大约 10 个后续 HTTP 请求，并且当它获取数据/准备时，它会重新加载 tableView。随着数据集越来越大，它变得非常缓慢。我试图弄清楚这是因为我重新加载 tableView 的次数还是因为我如何抓取/解析数据。

在这种情况下，最佳做法是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2010-08-14T05:13:48.547

从 UITableView.h：

```
 - (void)reloadData;                 // reloads everything from scratch. redisplays visible rows. because we only keep info about visible rows, this is cheap. will adjust offset if table shrinks 
```

“这很便宜。”

很好地实现你的表格视图方法，一直调用这个函数也没什么大不了的。

附带说明一下，如果您正在考虑使用 reloadData，您应该尝试使用适当的方法来动画添加和删除行。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-27T17:15:48.527

最佳实践是让您的实现`cellForRowAtIndexPath:`尽可能少地工作。事实上，除了`UITableViewCell`用它需要显示的数据填充实例之外，它真的不应该做任何工作。

您应该使用 cached `UITableViewCell`s，这样您就不必每次都分配一个新单元格。如果您可以在单独的线程中进行解析等操作，并使解析后的数据准备好呈现、访问`cellForRowAtIndexPath:`，那么您不应该有任何性能问题。

您没有说您是否使用了自定义`UITableViewCell`子类，但如果您使用了，深度视图层次结构也可能会出现性能问题，因为层次结构中的每个视图都被绘制。你能做`UITableViewCell`的越平坦越好。

希望这能让你朝着正确的方向前进。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-27T17:10:08.323

最好的办法是分析您的应用程序以查看它在哪里运行缓慢。

也就是说，如果您的表格单元格的高度都相同，那么我认为

> 重新加载数据

只需要打电话

> cellForRowAtIndexPath

对于屏幕上可见的单元格。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-02-21T16:39:53.620

表视图重新加载费用为：

1.  弄清楚每个部分有多少个部分和行
2.  获取行高。

每当您调用重新加载数据时，都会特别为表格的所有元素计算行高。

剩余的开销是 cellForRowAtIndexPath，它通常不会太糟糕，因为它只被调用与屏幕上一样多的行。如果您不按照应有的方式重复使用单元格，则滚动时可能会很糟糕。

您的关键可能是，问问自己是什么触发了 HTML 加载，并可能将其移至后台线程。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T17:25:08.583

Boot To The Head 是正确的。

我正在 Instapaper 中逐一更新文章列表，并在每次完成下载时调用 -reloadData。听起来与您正在做的事情相似。它不会导致任何明显的性能下降。

# vb.net - 如何计算文本框中的行数？

> ID：595474
> 
> 赞同：1
> 
> 时间：2009-02-27T16:26:58.987
> 
> 标签：vb.net, compact-framework, textbox, height, lines

我希望有人可以帮助我解决我目前使用 Compact Framework.Net 2 SP 2 遇到的问题。

目前我有一个带有一系列文本框的 UI，每个文本框都显示一个数据库字段的内容。这些显示在另一个下方，表单右侧有一个滚动条。每个文本框都有一个设置的宽度，可能

我想根据每个文本框的行数、字体大小和字体来调整每个文本框的高度，以避免在每个文本框上使用滚动条。

目前我能够在测试应用程序中做到这一点。

* * *

### 截屏：

[查看输出截图 http://morrislgn.brinkster.net/SO/screenshot.jpg](http://morrislgn.brinkster.net/SO/screenshot.jpg)

* * *

### 我的代码：

```
'Text used in this example:
'TextBox1qwertyuiop lkjhgfdsazxcvbnm1234567890 TextBo

'x1qwer tyuioplkjhgfdsazxcvb nm1234567890

'qwe
'End of exmaple text.

Me.Textbox2.Text = Me.Textbox1.Text

Dim pobjGraphic As Graphics = Me.Textbox2.Parent.CreateGraphics()
Dim pobjSize As SizeF

'Padding values:
Dim piTop As Int32 = 4 'top of text and top of textbox
Dim piBottom As Int32 = 3 'bottom of text and top of textbox

Dim piLines As Int32 = 0

'Based on the font size chosen by the user, create a font to perform the calculation with.
Dim piFontSize As Single = 10

If Me.CheckBox1.Checked.Equals(True) Then
    piFontSize = 6
ElseIf Me.CheckBox2.Checked.Equals(True) Then
    piFontSize = 8
ElseIf Me.CheckBox3.Checked.Equals(True) Then
    piFontSize = 12
Else
    piFontSize = 10
End If

Dim pobjFont As New Font("Tahoma", piFontSize, FontStyle.Regular)

'Calculate the height of one line.
pobjSize = pobjGraphic.MeasureString("HELLO WORLD", pobjFont)
'Value of pobjSize returned: {Width = 71.0 Height = 13.0}

'Calculate the number of lines          
Dim b As Bitmap
b = New Bitmap(1, 1, Imaging.PixelFormat.Format32bppRgb)

'Calculate the number of lines required to display the text properly based on the lenght of the text the width of the control.
'Length of text to show divide by the width of the textbox
piLines = Graphics.FromImage(b).MeasureString(Me.Textbox2.Text, pobjFont).Width / Me.Textbox2.Width
'Value of piLines returned: 2

If piLines = 0 Then
    piLines = 1
End If

'Calculate the size of the text to be displayed using the margins, height of one line and number of lines.
Me.Textbox2.Height = (pobjSize.Height * piLines) + piTop + piBottom
' value produced: 33 = (13 * 2) + 4 + 3
'set font of text box
Me.Textbox2.Font = pobjFont 
```

最后，我知道这可以通过使用 p/invoke 调用 COREDLL.dll 来实现，但这样做会使应用程序崩溃。

嗨伙计，

以下是要求的 pinvoke 代码：

```
 <Runtime.InteropServices.DllImport("coredll.dll")> _
Private Function SendMessage( _
    ByVal hwnd As IntPtr, ByVal msg As Integer, _
    ByVal wParam As Integer, ByVal lParam As Integer) As Integer
End Function

<Runtime.InteropServices.DllImport("coredll.dll")> _
Private Function GetCapture() As IntPtr
End Function

<Runtime.InteropServices.DllImport("coredll.dll")> _
Private Function ReleaseCapture() As Boolean
End Function

Public Function GetNumberOfLines(ByVal ptxtCountBox As TextBox) As Integer
    Try
        Dim hnd As IntPtr = New IntPtr

        ptxtCountBox.Capture = True

        ' Capture the textbox handle.
        hnd = GetCapture()
        ptxtCountBox.Capture = False

        ' Get the count of the lines in the box.
        Dim plCount As Integer = SendMessage(ptxtCountBox.Handle, EM_GETLINECOUNT, 0, 0)

        ' Count the number of return lines as we minus this from the total lines to take.
        plCount = plCount - (CharCount(ptxtCountBox.Text, vbCrLf, False))

        plCount += RemoveNonASCIIReturns(ptxtCountBox)

        ReleaseCapture()

        hnd = Nothing

        ' Return the line count.
        Return plCount
    Catch ex As Exception
        GenerateError(msCLASS_NAME, "GetNumberOfLines", ex.Message.ToString)
    End Try
End Function 
```

谢谢，

莫里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-04T12:54:07.990

想我到了这个的底部：

```
 Public Function GetNumberOfLines(ByVal pstext As String, ByVal pobjfont As Font, ByVal pobjDimensions As Size) As Decimal
    Dim pslines As String() = Nothing
    'Used to measure the string to be placed into the textbox
    Dim pobjBitMap As Bitmap = Nothing
    Dim pobjSize As SizeF = Nothing

    Try
        Dim psline As String = String.Empty
        Dim pilinecount As Decimal = 0.0
        'Spilt the text based on the number of lines breaks.
        pslines = pstext.Split(vbCrLf)
        For Each psline In pslines
            'Create a graphics image which is used to work out the width of the text.
            pobjBitMap = New Bitmap(1, 1, Imaging.PixelFormat.Format32bppRgb)
            pobjSize = Graphics.FromImage(pobjBitMap).MeasureString(psline, pobjfont)

            'If the width of the text is less than 1.0 then add one to the count. This would incidcate a line break.
            If pobjSize.Width < 1.0 Then
                pilinecount = pilinecount + 1
            Else
                'Based on the dimensions of the text, work out the number of lines. 0.5 is added to round the value to next whole number.
                pilinecount = pilinecount + (Round((pobjSize.Width / pobjDimensions.Width) + 0.5))
            End If
        Next

        'If the line count it less than 1 return one line.
        If pilinecount < 1.0 Then
            Return 1.0
        Else
            Return pilinecount
        End If
    Catch ex As Exception
        Return 1.0
    Finally
        If pslines IsNot Nothing Then
            Array.Clear(pslines, 0, pslines.Length - 1)
            pslines = Nothing
        End If
        If pobjBitMap IsNot Nothing Then
            pobjBitMap.Dispose()
        End If
    End Try
End Function 
```

诚然，它有点像黑客，但目前看来工作正常！任何关于如何改进这一点的意见或评论都非常受欢迎。

此外，关于 p/invoke 的东西，发现了问题的根源，或者更确切地说是解决方案。升级了我设备上的 .Net fx，这似乎解决了这个问题。

谢谢

莫里斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-07T01:16:14.167

好吧，我会向您建议一个合理而聪明的解决方案。这是算法：

1.  使用标签控件作为参考。
2.  分配： • 文本框的大小到标签。• 文本框到标签的字体。• 标签的Autosize-property 为**True**。• Textbox 的标签的BorderStyle 属性。• Label 的 MinimumSize 属性作为文本框的原始大小。• 标签的MaximumSize 属性与原始宽度相同，高度为原始高度的一个大倍数。

3.  将文本框的文本分配给标签的文本。

4.  现在：如果标签的 PrefferdHeight 属性 > 文本框的高度 == True 是时候增加文本框的高度并检查上述条件，直到它为 False。
5.  现在可以处理掉标签了。

我还在 MSDN 论坛上发布了一个类似的解决方案，也可以查看：[ [http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/03fc8e75-fc13-417a-ad8c-d2b26a3a4dda] [1]](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/03fc8e75-fc13-417a-ad8c-d2b26a3a4dda][1])

问候。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-20T08:55:54.093

我问了一个类似的问题，得到的答案完全满足了我对该主题的需求！请从我的问题中查看 stevo3000 的答案： [AutoSize for Label / TextBox in .NET Compact Framework](https://stackoverflow.com/questions/767335/autosize-for-label-textbox-in-net-compact-framework)

他提到了这两篇博文，一刷就完全解决了我的问题！ [http://www.mobilepractices.com/2007/12/multi-line-graphicsmeasurestring.html](http://www.mobilepractices.com/2007/12/multi-line-graphicsmeasurestring.html) [http://www.mobilepractices.com/2008/01/making-multiline-measurestring-work.html](http://www.mobilepractices.com/2008/01/making-multiline-measurestring-work.html)

# macos - 在 mac osx 上注册协议？

> ID：595481
> 
> 赞同：9
> 
> 时间：2009-02-27T16:28:43.303
> 
> 标签：macos, protocols

我已经在windows中完成了，我如何在mac osx上注册一个协议。我想单击 Firefox 中的链接（a href="somename://mylinkAndData"）并启动二进制文件？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-27T17:46:37.563

查看 Apple 的[Launch Services Programming Guide](https://developer.apple.com/library/archive/documentation/Carbon/Conceptual/LaunchServicesConcepts/LSCIntro/LSCIntro.html)。您必须将*[CFBundleURLTypes](https://developer.apple.com/documentation/bundleresources/information_property_list/cfbundleurltypes)**添加到您的应用程序 Info.plist 并使用LSRegisterURL()*注册您的应用程序。

摘自*Firefox.app/Contents/Info.plist*：

```
 <key>CFBundleURLTypes</key>
    <array>
            <dict>
                    <key>CFBundleURLIconFile</key>
                    <string>document.icns</string>
                    <key>CFBundleURLName</key>
                    <string>http URL</string>
                    <key>CFBundleURLSchemes</key>
                    <array>
                            <string>http</string>
                    </array>
            </dict>
 .... 
```

**编辑：**请参阅[在 Cocoa](https://web.archive.org/web/20091215155410/http://www.xmldatabases.org/WK/blog/1154_Handling_URL_schemes_in_Cocoa.item)中处理 URL 方案以获取*操作*指南文章

# c# - C# 中的“闭包”是什么？

> ID：595482
> 
> 赞同：77
> 
> 时间：2009-02-27T16:29:07.080
> 
> 标签：c#, closures

### 复制

> [.NET 中的闭包](https://stackoverflow.com/questions/428617/closures-in-net)

C# 中的闭包是什么？

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2009-02-27T16:29:52.787

C# 中的[闭包](http://en.wikipedia.org/wiki/Closure_(computer_science))采用内联委托/[匿名方法](http://msdn.microsoft.com/en-us/library/0yw3tz5k(VS.80).aspx)的形式。[闭包](http://en.wikipedia.org/wiki/Closure_(computer_science))附加到其父方法，这意味着可以从匿名方法中引用父方法主体中定义的变量。这里有一篇很棒的[博客文章](https://web.archive.org/web/20150707082707/http://diditwith.net/PermaLink,guid,235646ae-3476-4893-899d-105e4d48c25b.aspx)。

**例子：**

```
public Person FindById(int id)
{
    return this.Find(delegate(Person p)
    {
        return (p.Id == id);
    });
} 
```

您还可以查看[Martin Fowler](http://www.martinfowler.com/bliki/Closure.html)或[Jon Skeet](http://csharpindepth.com/Articles/Chapter5/Closures.aspx)的博客。我相信您将能够从其中至少一个中获得更“深入”的细分......

**C# 6 的示例：**

```
public Person FindById(int id)
{
    return this.Find(p => p.Id == id);
} 
```

这相当于

```
public Person FindById(int id) => this.Find(p => p.Id == id); 
```

# objective-c - 无法识别的选择器但调试可以看到它

> ID：595487
> 
> 赞同：0
> 
> 时间：2009-02-27T16:29:44.253
> 
> 标签：objective-c

我有一个包含对象集合的类。我正在尝试创建一个方法，该方法将返回与提供的谓词匹配的集合的第一个成员。

下面是采集方法：

```
...
//predicate is a boolean method that accepts an object as its single parameter
-(id<Notation>) getFirstChildMatching: (SEL) predicate declaredInInstance:(id) instance
{
    NSMethodSignature *sig = [[instance class] instanceMethodSignatureForSelector:predicate];
    NSInvocation *myInvocation = [NSInvocation invocationWithMethodSignature:sig];
    [myInvocation setTarget:instance];
    [myInvocation setSelector:predicate];

    int numItems = childNotations.count;
    for(int i=0;i< numItems;i++)
    {
        id<Notation> thisNotation = [childNotations objectAtIndex:i];
        [myInvocation setArgument:thisNotation atIndex:2];
        BOOL result =NO;
        [myInvocation retainArguments];
        [myInvocation invoke];
        [myInvocation getReturnValue:&result];

        if (result)
            return thisNotation;

    }

    return nil;
} 
```

我创建了一个测试这个方法的测试类。这是测试方法加上谓词：

```
- (void) testGetFirstChildMatching
{
    Leaf *line1 = [[Leaf alloc] initWithValue:1 step:Step_A andNumber:1];
    Leaf *line2 = [[Leaf alloc] initWithValue:2 step:Step_B andNumber:2];

    SEL mySelector = @selector(valueIs1:);

    id<CompositeNotation> compositeNotation = [[CompositeNotation alloc] init];
    [compositeNotation addNotation:line1];
    [compositeNotation addNotation:line2];

    id notation = [compositeNotation getFirstChildMatching: mySelector declaredInInstance:self];
    STAssertEquals(YES, [notation isKindOfClass:[Leaf class]], @"Should be of type Leaf: %@", notation);
    //Leaf *found = ((Leaf *)notation);
    STAssertEquals([notation value], line1.value, @"Should have found line 1 with value 1: actual %i", [notation value]);
    [line1 release];
    [line2 release];
}

-(BOOL) valueIs1: (Leaf *) leaf
{
    if (leaf.value == 1)
        return YES;

    return NO;
} 
```

我发现在“if (leaf.value == 1)”行上，我得到了一个“发送到班级的无法识别的选择器”。没有意义的是调试器可以看到 value 属性及其值，因此对象显然具有该选择。有任何想法吗？

顺便说一句，Leaf 实现了符号协议

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T16:50:22.003

函数定义中的错字？

```
-(BOOL) valueIs1: (Leaf *) Leaf // <== should be "leaf" not "Leaf" ? 
```

* * *

你得到一个“发送到**类**的无法识别的选择器”，而不是实例，这一事实意味着这`leaf`是一个`Class`. 要检查的两件事：

*   确保 Leaf 的初始化程序`initWithValue`正在返回一个对象。
*   确保`addNotation:`正确地将叶子添加到阵列中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-03-02T09:25:34.403

我最终发现了问题。就是这条线

```
[myInvocation setArgument:thisNotation atIndex:2]; 
```

应该是

```
[myInvocation setArgument:&thisNotation atIndex:2]; 
```

谢谢

# sql - SQL 何时使用哪种数据类型

> ID：595489
> 
> 赞同：6
> 
> 时间：2009-02-27T16:29:58.403
> 
> 标签：sql, types

嗨，我想知道什么时候应该使用不同的数据类型。如在我的表格中，我如何决定使用哪个：nvarchar、nchar、varchar、varbinary 等。

例子：

我将使用什么...列：

```
Phone number,
Address,
First Name, Last Name,
Email,
ID number,
etc. 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T17:05:59.953

作为一般规则，如果我不打算对其进行算术运算，即使数据本身是数字，我也不会将任何内容定义为“数字”字段。

您的“电话”字段就是一个例子。我将其定义为 varchar。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T16:36:32.803

Varchar、Integer 和 Bit 涵盖了我 99% 的日常使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T16:38:59.067

这个问题真的取决于你的要求。我知道这不是一个特别令人满意的答案，但这是真的。

n..char 数据类型用于 Unicode 数据，因此如果您需要在数据中使用 unicode 字符集，您应该使用这些类型，而不是它们的“非 n”类似物。nchar 和 char 类型是固定长度的，而 nvarchar 和 varchar 类型可以有可变长度，这将影响磁盘和内存中列的大小。一般来说，我会说使用使用最少磁盘空间但适合您的需要的类型。

[此页面](http://msdn.microsoft.com/en-us/library/ms187752(SQL.90).aspx)包含指向 Microsoft 对 SQL Server 2005 的这些数据类型的描述的链接，其中许多提供了何时使用哪种类型的指针。您可能对[本页](http://msdn.microsoft.com/en-us/library/ms176089(SQL.90).aspx)中有关 char 和 varchar 类型的内容特别感兴趣。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T16:34:21.717

以 n 开头的数据类型意味着它可以用于 unicode 字符...例如 nVarchar。

整数的选择也很有趣。

[http://www.databasejournal.com/features/mssql/article.phpr/2212141/Choosing-SQL-Server-2000-Data-Types.htm](http://www.databasejournal.com/features/mssql/article.phpr/2212141/Choosing-SQL-Server-2000-Data-Types.htm)

我使用的最常见的数据类型是 varchar....

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T16:38:37.383

N* 数据类型（NVARCHAR、NCHAR、NTEXT）用于 Unicode 字符串。它们占用的空间是其“正常”挂件（VARCHAR、CHAR、TEXT）所需空间的两倍，但它们可以存储 Unicode 而无需转换和可能的保真度损失。

TEXT 数据类型可以存储几乎无限量的数据，但它们的性能不如 CHAR 数据类型，因为它们存储在记录之外。

VARCHAR 数据类型是可变长度的。它们的末尾不会用空格填充，但它们的 CHAR 挂件会（一个 CHAR(20) 总是有 20 个字符长，即使只包含 5 个字母。剩下的 15 个将是空格）。

二进制数据类型用于二进制数据，无论您想存储什么（图像是主要示例）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-02T16:19:31.630

其他人给出了很好的一般性答案，但我要补充一点：在使用`VARCHAR()`s 时（我会推荐这些类型的字段），一定要使用足够大的长度来获得任何合理的值。例如，我通常声明`VARCHAR(100)`姓名、电子邮件地址、域名、城市名称等，以及`VARCHAR(200)`URL 或街道地址。

这比您通常需要的要多。事实上，对于几乎所有这些值，30 个字符就足够了（除了全名，但一个好的数据库应该总是分开存储名字和姓氏），但总比将来必须更改数据类型要好。为 a 指定高于必要的长度几乎没有成本`VARCHAR`，但请注意，`VARCHAR(MAX)`并且`TEXT`确实需要大量开销，因此仅在必要时使用它们。

这是一篇文章，它指出了一个比必要的更长`VARCHAR` *可能会*损害性能的情况：[MySQL 表中 varchar 长度的重要性](https://stackoverflow.com/questions/1962310/importance-of-varchar-length-in-mysql-table)。去表明*一切都是*有代价的，但总的来说我还是喜欢 long `VARCHAR`s。

# sockets - 有没有开源的跨平台 NAT 穿通？

> ID：595490
> 
> 赞同：7
> 
> 时间：2009-02-27T16:30:13.427
> 
> 标签：sockets, cross-platform, nat

有没有开源的跨平台 NAT 穿通？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T16:35:04.880

我还没有看到，但你会在这里找到比你需要的更多的信息：

[http://www.enchantedage.com/node/8](http://www.enchantedage.com/node/8)

实现起来并不难，只是一点点工作。

页面上有演示此构建在 unix 和 windows 上的代码，包括服务器部分（介绍者）和客户端部分。它没有列出许可证，但作者在自述文件中指出该技术是免费的，并且从页面上的信息和源代码示例中重新实现它似乎相对容易。

作者似乎是该网站的所有者，因此您可能可以直接与他们联系以获取更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-09T15:22:09.383

我见过的最好的是[UDT](http://udt.sourceforge.net/index.html)，它是一个可靠的 UDP 库，还包括一个“集合”连接模式，有助于处理 NAT 冲孔。您所要做的就是找出外部 IP 地址和端口，并以某种方式将其发送给另一个客户端（反之亦然）。一旦你知道了这些信息，你就可以同时连接和绑定（设置了集合模式），它会尽力找出其余的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-25T19:57:30.400

恐怕我在这里没有得到答案，但我知道几年前在该领域进行了一些研究，最终产生了一些 IETF 文件。好奇的读者可能已经熟悉这些：

*   [https://datatracker.ietf.org/doc/html/draft-ietf-behave-rfc3489bis-18](https://datatracker.ietf.org/doc/html/draft-ietf-behave-rfc3489bis-18)
*   [https://datatracker.ietf.org/doc/html/draft-ietf-behave-turn-13](https://datatracker.ietf.org/doc/html/draft-ietf-behave-turn-13)
*   可能[https://datatracker.ietf.org/doc/html/draft-ietf-mmusic-ice-19](https://datatracker.ietf.org/doc/html/draft-ietf-mmusic-ice-19)
*   （... *your-link-here*：我可能错过的一些研究）

# java - 对于具有扎实 C++ 背景的人来说，学习 Java 的最佳方式是什么？（书籍等）

> ID：595491
> 
> 赞同：4
> 
> 时间：2009-02-27T16:30:19.993
> 
> 标签：java

我已经安装了 Eclipse 和 JDK，阅读了“Hello World”教程，并阅读了 Eclipse 文档（关于 Eclipse 本身和使用 Eclipse 开发 Java）。我正在查看 JUnit 示例以更好地了解 Java 在运行时是如何工作的。

我在学习一种具有更新范式的新计算机语言时会感到困惑，我认为这部分是由于我使用 C++ 的经验。

关于好的 Java 书籍/教程/等的任何建议。对于具有 C/C++ 背景的人？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-27T16:51:03.173

*   [首先放弃 eclipse 一段时间，只使用文本编辑器和命令行 JDK 工具，对 Java 程序的工作原理、包、类路径和编译器错误](http://mindprod.com/jgloss/compileerrormessages.html)有一个基本的了解。
*   熟悉[API 文档](http://java.sun.com/javase/6/docs/api/)。从 java.lang、java.util、java.io 和 java.text 中的关键类开始
*   [Sun 的 Java 教程](http://java.sun.com/docs/books/tutorial/)是加深您对特定主题的理解的一个很好的起点
*   [Java 语言规范](http://java.sun.com/docs/books/jls/third_edition/html/j3TOC.html)和[Java 虚拟机规范](http://java.sun.com/docs/books/jvms/second_edition/html/VMSpecTOC.doc.html)对于理解“幕后”发生的事情非常有帮助，这对 C++ 人来说可能是一种安慰:-)。随着规范的发展，它们非常易读。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T16:36:46.797

Java相当大。我不知道您一直在用 C++ 解决什么样的问题，但我建议您按照以下方式对 Java 进行分区：

Java SE 是核心语言。它包括 Swing UI 类和 JDBC，因此如果您使用 C++ 来编写桌面应用程序，它会很有用。

Java EE 构建在 Java SE 之上。它有许多“企业”特性，包括 Java 服务器页面、EJB、消息传递等，用于构建分布式、事务性、多用户应用程序。

如果您想编写桌面应用程序，我建议您专注于 Swing 和 JDBC。您只需要 JDK 6 和您选择的关系数据库。

如果您想编写 Web 应用程序，我建议使用 JSTL 和 JDBC 编写的 JSP 以及像 Tomcat 这样的 servlet/JSP 引擎。

仅使用这些技术，您就可以走很长的路。当你变得更舒服时，扩大你的圈子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T17:02:56.763

[Core Java](http://www.horstmann.com/corejava.html)在整本书中都包含 C++ 注释，以解释 C++ 和 Java 之间的细微差别。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T16:41:35.363

是的，这些库很大，但与其深入研究 Swing api，为了纯粹的语言熟悉，您最好编写使用集合的小片段（java.util 包）。我发现这些东西对于日常编码非常重要，它会让你熟悉泛型和创建对象的方式，这两者都与 C++ 非常不同。

我一直发现[Thinking in Java](http://www.mindview.net/Books/TIJ/)是一本很棒的书，非常详细且写得很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T16:46:47.940

要获得 Javaisms，您应该阅读[Joshua Bloch 的 Effective Java 2nd Edition](http://books.google.com/books?id=ZZOiqZQIbRMC&printsec=frontcover&dq=effective+java+2nd+edition)

对于单元测试（以及更多），[实用程序员](http://www.pragprog.com/)的书籍很好。

如果您了解 C/C++，这也是一本学习 Java 的好书，请[参阅 Bruce Eckel 的 Thinking in Java](http://www.mindview.net/Books/TIJ/)。这本书在某些方面很好，但在其他方面却落伍了（他和我不同意一个人的异常处理），但如果你知道 C++，那么它总体上是一本好书——只要确保你用几个来抵消它不适合 C++ 程序员的 Java 书籍 :-)

对于学习 Java，核心语言与 C++ 非常相似。回到 1995 年，我花了大约一天的时间来熟悉 Java，3-5 天的时间来弄清楚它与 C++ 的不同之处，大约一个月的时间来学习这些库。

不过，自 1995 年以来 Java 发生了很大变化……所以有一天对于第一部分来说仍然可能是准确的。从语言的角度来看，这取决于你想学什么，比如一周。图书馆……这可能需要数年（至少数月），具体取决于您关注的内容。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T16:34:50.917

[Head First Java](https://rads.stackoverflow.com/amzn/click/com/0596009208)似乎在与我一起工作的具有 C++ 背景的人中很受欢迎。如果你喜欢数学，在[Project Euler](http://www.projecteuler.net)上解决问题也很有趣，现在就用 Python 来解决。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-27T16:36:53.097

我一直觉得[Sun 的 Java 教程](http://java.sun.com/docs/books/tutorial/)非常有帮助。您可以根据需要查找语言基础知识（或快速浏览简单的部分），但您可以轻松地深入研究更高级的主题（带有 Swing、并发、容器等的 GUI）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-27T16:40:26.117

学习它的最好方法就是去做。特别是如果您可以与强大的 Java 开发人员结对编程。这就是我所做的，现在我在 Java 方面做得更好，并且发现很难回到 C++

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-27T16:48:21.243

如果您想获得扎实的 Java 基础，我建议您从 Java 获得 Java 程序员认证。它将迫使您学习该语言的每个基本方面。几年前我做过，我认为这是值得的。如果我没记错的话，你现在的雇主可能有计划来支付测试费用，那是几百美元。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-27T16:41:13.850

一旦您习惯了 Java，我建议您仔细阅读 JLS。尽管它具有相似的语法，但它可能有助于指出 Java 在哪些方面做的事情不同。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-27T20:34:11.497

书很有趣，但边做边学。构建一个应用程序。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-02-27T17:04:32.110

我特别同意这些建议：

获得 Java 程序员认证。这是对该语言的一个很好的介绍，价格不贵，并且确实让您对核心 Java 语言有很好的了解。它对简历肯定有帮助，例如，Java 开发人员认证帮助我获得了第一份 Java 工作。查看 JavaRanch 以获取在线证书帮助。

阅读 Bruce Eckel 的 Java 思维。它是免费的在线！很棒的书。

Sun 的 Java 教程。非常有帮助。

作为参考，请使用在线 Sun Java Docs 和 Java Almanac（在 Web 上）。Java Almanac 是所有代码示例。

# sql - 如何使用 Form Builder 和 PL/SQL 插入记录？

> ID：595495
> 
> 赞同：2
> 
> 时间：2009-02-27T16:31:11.597
> 
> 标签：sql, oracle, formbuilder, ora-01400

我正在慢慢学习 SQL 以及如何使用表单构建器 6。情况是我在表中有一个名为“玩家”的简单表，我有三列：

*   player_no（主键）
*   位置
*   目标

在表单生成器 6 中，我使用这三个字段创建了一个非常简单的表单。该表格被命名为“团队”。在表格的底部，我有一个标有“添加”的按钮。目标是让用户输入 player_no、位置和目标，然后单击“添加”。然后将这些信息放入我的表中。

到目前为止，所有尝试都以惨败告终。我在按钮（WHEN_MOUSE_CLICK）上设置了一个触发器。然后我输入了以下代码：

```
BEGIN
  INSERT INTO players ( player_no )
  VALUES ( :TEAM.player_no )
END 
```

为了测试它，我只使用了一个（player_no）字段。然后，当我运行表单并输入 player_no 并点击按钮时，编译时没有错误，我在状态栏中收到以下错误：

frm-40735: WHEN-MOUSE-CLICK 触发器引发未处理的异常 ORA-01400

我做错了什么可怕的事情吗？我对 SQL 和 Form Builder 非常陌生，因此将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T17:22:53.987

[ORA-01400: 无法插入 Null](http://www.techonthenet.com/oracle/errors/ora01400.php)似乎您的某个字段不为空，并且您在插入时忽略了它们。或值 :TEAM.player_no 在插入期间为空。

另外，来自网络的某个地方：

> FRM-40735：未处理的 ON-INSERT 触发器引发自 11.5.9 以来我们遇到了类似的问题。我们清除 Jinitiator 缓存和临时 Internet 文件（工具>Internet 选项，然后在临时 Internet 文件下的清除文件按钮）。似乎工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-05-13T01:22:29.250

使用 Form Builder 的好处之一是您几乎总是*不需要*自己编写 DML 语句。

只需根据表创建块 - 然后用户可以添加和修改任意数量的记录，然后当他们保存（即 COMMIT）时，Forms 运行时会自动计算出保存更改所需的 INSERT 和 UPDATE。

# c# - 是否可以在不使用分析器的情况下跟踪 C# 应用程序中的内存使用情况？

> ID：595499
> 
> 赞同：7
> 
> 时间：2009-02-27T16:31:37.667
> 
> 标签：c#, .net, memory, memory-management

我想编写一个简单的应用程序来跟踪其当前的内存使用情况、创建的对象数量等。在 C++ 中，我通常会覆盖 new 运算符，但由于显而易见的原因，我不能在 C# 中执行此操作。有没有办法在不使用分析器的情况下做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T16:43:22.520

您可能想从垃圾收集器开始。[MSDN在这里](http://msdn.microsoft.com/en-us/library/system.gc_members.aspx)列出了一些成员，它们可以向您展示如何做一些事情，例如获取它认为分配的内存总量，GC 收集了多少次。任何比这更高级的东西，比如获取已加载程序集的对象计数，您可能必须使用分析器或自己编写一些东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T16:43:38.977

.NET 内存性能计数器将为您提供聚合信息，但不包括对象计数器。为此，您将需要一个分析器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-07T00:01:59.710

使用 WMI 尝试：

获取进程使用情况（W2K3/2K8）：

```
"SELECT IDProcess, PercentPrivilegedTime, PercentProcessorTime, PercentUserTime FROM Win32_PerfFormattedData_PerfProc_Process where Name='process_name.exe'" 
```

要识别您的站点，请使用以下命令：

```
"SELECT ProcessId, CommandLine, WorkingSetSize, ThreadCount, PrivatePageCount, PageFileUsage, PageFaults, HandleCount, CreationDate, Caption FROM Win32_Process where Caption='process_name.exe'" 
```

将此工具用于[WQL 测试](http://code.msdn.microsoft.com/NitoWMI)

或者使用 PerfMon 工具。

有关计数器的详细信息，请参阅文档末尾的[Windows 系统资源管理器记帐。](http://download.microsoft.com/download/d/2/5/d2524d17-b893-46f9-bebe-b1f7b927e144/Windows%20System%20Resource%20Manager%20Accounting.doc)

祝你好运。

# c# - 运行程序后，Visual Studio 将列添加到 DataGridView

> ID：595500
> 
> 赞同：4
> 
> 时间：2009-02-27T16:31:40.130
> 
> 标签：c#, winforms, visual-studio-2008, datagridview

我有一个 datagridview 链接到数据库中的三列，它只显示它们（没有编辑）。当我在调试中运行程序并退出时，当我返回 Visual Studio 中的表单时，它有我的三列，加上它链接到的表中的所有列。如果我不删除这些，下次我运行程序时，它们会出现在表单上。如果我删除它们，我每次运行程序时都必须这样做。

有想法该怎么解决这个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T16:35:26.393

`AutoGenerateColumns`设置`True`为?

`False`如果您想阻止 DGV 从数据源创建列（除了您手动创建的列），您应该将其设置为。

编辑：为了澄清，如果在设计模式本身中该属性未设置为 False，则可能会导致这种不可否认的奇怪行为。我正在考虑您`False`在运行时将其设置为的极端情况。我还将查看设计器文件（您可能必须单击“显示所有文件”选项才能查看它）并查看它包含与 DGV 相关的内容。那里可能有问题。

或者，您是否尝试过删除控件本身并创建具有相同绑定的新 DGV？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T16:39:32.187

据此，Visual Studio[中](http://74.125.77.132/search?q=cache:JQGWmnOG24YJ:social.msdn.microsoft.com/Forums/en-US/winformsdesigner/thread/39e239fa-ea7e-4e72-a12b-07948b066b5a/+visual+studio+after+running+program+datagridview&hl=en&ct=clnk&cd=3&gl=us&client=firefox-a)有一个错误，要求您在更改绑定源之前将其设置为 none/null（它似乎自 2005 年以来一直存在）。我删除了所有列，将绑定源设置为无，然后将绑定源重置为我想要的并编辑了这些列。它现在正在工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-20T10:30:11.420

经过大量的挖掘，[这个解决方案](http://social.msdn.microsoft.com/Forums/en-US/winformsdesigner/thread/d8b758b9-a916-43c4-8e41-c901112d38d5/#2b2d5f49-5e0f-4d97-84c9-51f9169bcef3)终于为我解决了：

> 看起来编译器正在破坏 .resx 文件（其中包含表单的布局信息，包括列设置），这意味着下次加载设计器时，它会从数据源重新创建所有列。
> 
> 修复似乎如下：
> 
> > 执行“显示所​​有文件”，然后查看与表单关联的 .resx 文件并更改导致异常行为的列...查找列名后跟“.UserAddedColumn”条目，并将其设置为 False . 就我而言，实际上我什至完全删除了“[columnName].UserAddedColumn”的条目。

# c# - 如何在 C# 中从内存中启动程序？

> ID：595504
> 
> 赞同：1
> 
> 时间：2009-02-27T16:33:28.753
> 
> 标签：c#, assemblies, assembly-resolution

我有一些 UI 应用程序，它位于用 C# 编写的用户任务栏中。该工具的 EXE 已在许多使用它的项目上签入我们的源代码控制系统，因此我们能够通过签入更新的 EXE 来更新它们运行的​​版本。

问题是当用户获得最新版本的 exe 时，程序经常在运行，并且在他们的机器上同步失败。我想修复它，这样程序在运行时就不会锁定 exe 和任何依赖的 DLL，这样它们就可以同步而不必关闭程序。

目前，我有一个程序将可执行文件作为参数，并通过提前将程序集内容读入内存来从内存中启动它。不幸的是，当涉及到程序所需的 DLL 时，这完全失败了。

我现在拥有的代码如下所示：

```
public class ExecuteFromMemory
{
    public static void Main(string[] args)
    {
        //Figure out the name of the EXE to launch and the arguments to forward to it
        string fileName = args[0];
        string[] realArgs = new string[args.Length - 1];
        Array.Copy(args, 1, realArgs, 0, args.Length - 1);

        //Read the assembly from the disk
        byte[] binary = File.ReadAllBytes(fileName);

        //Execute the loaded assembly using reflection
        Assembly memoryAssembly = null;
        try
        {
            memoryAssembly = Assembly.Load(binary);
        }
        catch (Exception ex)
        {
            //Print error message and exit
        }

        MethodInfo method = memoryAssembly.EntryPoint;
        if (method != null && method.IsStatic)
        {
            try
            {
                method.Invoke(null, new object[] { realArgs });
            }
            catch(Exception ex)
            {
                //Print error message and exit
            }
        }
        else
        {
            //Print error message and exit
        }
    }
} 
```

我的问题是，我在做一些完全愚蠢的事情吗？有没有更好的方法来处理这个？如果不是，我应该怎么做才能支持处理外部依赖项？

例如，如果您尝试运行使用“Bar.dll”中的函数的“Foo.exe”，上述代码无法加载任何依赖文件，“Foo.exe”将是可覆盖的，但“Bar.dll”仍然是被锁定并且不能被覆盖。

我尝试从加载的程序集上的“GetReferencedAssemblies()”方法获取引用程序集的列表，但这似乎没有给出任何指示应该从哪里加载程序集......我需要自己搜索它们吗？如果是这样，最好的方法是什么？

似乎其他人以前可能遇到过这种情况，我不想重新发明轮子。

- 更新：EXE 已签入，因为这就是我们将内部工具分发给使用它们的团队的方式。它不是这个用例的最佳选择，但我没有机会更改该策略。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T16:47:21.857

免责声明：我不使用 Windows，尽管我熟悉它奇怪的锁定方式。

为了在应用程序运行时更新它，您可能需要有两个进程：可执行文件本身，以及将完成更新过程的更新“帮助”应用程序。假设您的应用程序是 ProcessA.exe，而您的更新助手是 Updater.exe。您的主程序将下载可执行文件的新副本，并以随机名称保存。然后你运行你的更新程序，它会监视你当前进程的终止。当您的进程终止时，它会显示一个显示更新状态的快速窗口，将新的可执行文件移动到旧可执行文件的位置，然后重新启动该程序。

能够模拟 POSIX 文件系统语义并能够删除当前运行的进程磁盘映像并将其替换为新文件会更加优雅，但我不知道这在 Windows 上是否可行。在 POSIX 系统上，您可以删除一个正在使用的文件，并且在关闭任何剩余的文件句柄之前它实际上不会被删除，尽管您可以重用文件名。

您可能想查看在[CodeProject](http://www.codeproject.com/)上写的一篇[关于此](http://www.codeproject.com/KB/vb/autoupdate.aspx)的文章。它还有一篇[后续文章](http://www.codeproject.com/KB/vb/Auto_Update_Revisited.aspx)。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T16:46:47.083

程序是否**需要**在更新时保持运行？

通常，要更新正在运行的程序，您会将要替换的任何文件复制到临时文件夹中。然后关闭旧实例，删除它并将新文件移动到正确的位置，然后重新启动它。

这允许应用程序的最小停机时间，因为最长的部分通常是副本，如果临时文件夹位于同一逻辑驱动器上，则文件移动非常快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T17:53:00.777

Although Michael's answer is one way of doing this, there are tools out there that are explicitly for managing what's installed on the desktop.

What you are doing with the exe being checked into source control is not normal. If you have a windows domain controller, you can use Group Policy to push programs down to the client. Alternatively, you could use something like Altiris to handle it.

If you must continue the way you are going then you have two options. One, using a helper / loader app which does a version check on launch. This is similar to how firefox works.

The second way is to build a helper service that sits in memory and polls every so often for updates. This is how Google Chrome, Adobe, etc work.

# c# - 用于生成属性和支持字段的代码生成器工具

> ID：595507
> 
> 赞同：3
> 
> 时间：2009-02-27T16:33:59.267
> 
> 标签：c#

我在 VS2008 和 C# 中工作，我正在寻找一个（免费）代码生成器工具来生成带有 getter 和 setter 的属性，以及要使用的支持私有字段。VS 中的模板事物并没有使该领域与之相匹配。只是在寻找更好的东西。

我曾经看到一个网站，您可以在其中构建此代码，然后将其从网页中粘贴到您的代码中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T16:35:50.573

您可以创建自定义片段来执行几乎任何您想做的事情。这是我在 VS2005 中用于创建带有支持字段的属性的一个：

```
<?xml version="1.0" encoding="utf-8" ?>
<CodeSnippets  xmlns="http://schemas.microsoft.com/VisualStudio/2005/CodeSnippet">
    <CodeSnippet Format="1.0.0">
        <Header>
            <Title>prop</Title>
                    <!-- the shortcut below will show in your intellisense 
                         window - set it to whatever you wish -->
            <Shortcut>_prop</Shortcut>
            <Description>Code snippet for a property</Description>
            <Author>Andrew</Author>
            <SnippetTypes>
                <SnippetType>Expansion</SnippetType>
            </SnippetTypes>
        </Header>
        <Snippet>
            <Declarations>
                <Literal>
                    <ID>type</ID>
                    <Default>String</Default>
                    <ToolTip>property type</ToolTip>
                </Literal>
                <Literal>
                    <ID>pname</ID>
                    <Default>_name</Default>
                    <ToolTip>private field name</ToolTip>
                </Literal>
                <Literal>
                    <ID>name</ID>
                    <Default>Name</Default>
                    <ToolTip>property name</ToolTip>
                </Literal>
            </Declarations>
            <Code Language="csharp">
                    <![CDATA[$type$ $pname$;

            public $type$ $name$
            {
                get { return this.$pname$; }
                set { this.$pname$ = value; }
            }$end$]]>
            </Code>
        </Snippet>
    </CodeSnippet>
</CodeSnippets> 
```

将其保存`whatever.snippet`在此位置调​​用的文件中：

> `"C:\Documents and Settings\<YOU>\My Documents\Visual Studio 2005\Code Snippets\Visual C#\My Code Snippets"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T16:40:10.593

在发布之前，我在 StackOverlfow 上环顾四周，试图找到答案，因为我确信这已经被解决了。我讨厌发帖，但我确实先看了，我保证。

我一直在寻找更多，我在这里找到了另一个有用的线程：

[如何在 Visual Studio 中生成 getter 和 setter？](https://stackoverflow.com/questions/3017/how-to-generate-getters-and-setters-in-visual-studio)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-13T19:14:39.280

只需单击一下即可使用[CodeSmith 。](http://www.codesmithtools.com/)有时最好买工具，而不是重新发明轮子

```
<%-- 
Name: Database Table Properties
Authors: Paul Welter , Yordan Georgiev
Description: Create a list of properties from a database table with a region for each prop
--%>
<%@ CodeTemplate Language="C#" TargetLanguage="C#" Debug="False" Description="Create a list of properties from database table." %>
<%@ Property Name="SourceTable" Type="SchemaExplorer.TableSchema" Category="Context" Description="Table that the object is based on." %>
<%@ Map Name="CSharpAlias" Src="System-CSharpAlias" Description="System to C# Type Map" %>
<%@ Assembly Name="SchemaExplorer" %>
<%@ Import Namespace="SchemaExplorer" %>

<% foreach (ColumnSchema column in this.SourceTable.Columns) {  %>

#region <%= StringUtil.ToPascalCase(column.Name) %>
private <%= CSharpAlias[column.SystemType.FullName] %> _<%= StringUtil.ToPascalCase(column.Name) %>;

public <%= CSharpAlias[column.SystemType.FullName] %> <%= StringUtil.ToPascalCase(column.Name) %>
{
    get { return _<%= StringUtil.ToPascalCase(column.Name) %>; }
    set { _<%= StringUtil.ToPascalCase(column.Name) %> = value; }
}
#endregion <%= StringUtil.ToPascalCase(column.Name) %>
<% } %> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-13T19:56:36.263

我相信您已经知道，VS 2008 中的 C# 编译器会在编译时自动为属性生成 getter 和 setter。这甚至适用于 .NET 2.0 应用程序，因为它全部在编译器中完成。

这意味着你可以这样做：

```
public int Number { get; set; } 
```

代替

```
private int _number;
public int Number
{
get { return this._number; }
set { this._number = value; }
} 
```

# c - 映射两个连续的页面

> ID：595516
> 
> 赞同：3
> 
> 时间：2009-02-27T16:35:35.847
> 
> 标签：c, unit-testing, unix, memory-mapped-files

我正在为我的 UTF8 操作库编写一个单元测试，如果函数进入缓冲区溢出，我希望我的测试能够发生段错误。所以我想出了在内存中mmap两个相邻页面的想法，第一个是PROT_READ | PROT_WRITE，第二个是 PROT_NONE。这样，如果发生任何溢出，就可以保证段错误。这是一个例子：

```
 void *addr1, *addr2; /* these are the pages; mmap call left out for simplicity */
char *p = (char *) (addr1 + getpagesize() - 8);

utf8_encode(aUtf8String, p, 8); // this shouldn't segfault 
```

问题是，当我映射第二页时，我的程序出现了段错误。这是一个重现问题的示例程序（GNU/Linux）：

```
 #include <stdio.h>
#include <errno.h>
#include <string.h>
#include <stdlib.h>
#include <sys/mman.h>

void checkMap(void *p) 
{ 
    if(p == MAP_FAILED) {
        printf("error running mmap: %s\n", strerror(errno));
        exit(1);
    }   
}

int main(void)
{
    void *addr1, *addr2;
    size_t pagesize;

    pagesize = getpagesize();
    checkMap(addr1 = mmap(NULL, pagesize, PROT_READ | PROT_WRITE, MAP_ANONYMOUS | MAP_PRIVATE, -1, 0));
    checkMap(addr2 = mmap(addr1 + pagesize, pagesize, PROT_READ | PROT_WRITE, MAP_ANONYMOUS | MAP_PRIVATE | MAP_FIXED, -1, 0));  /* segfaults */
    munmap(addr1, pagesize);
    munmap(addr2, pagesize);

    return 0;
} 

```

有趣的是，第一个 mmap() 之前的 printf() 语句会导致程序成功运行。有谁知道为什么 mmap 会出现段错误？如果使用 mmap() 无法实现我的目标，是否有人对如何测试我的代码是否存在缓冲区溢出有任何其他建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T18:31:53.197

您可以调用[mprotect()](http://www.kernel.org/doc/man-pages/online/pages/man2/mprotect.2.html)来更改映射的内存上的保护标志`mmap()`。这可能比尝试`mmap()`使用不同保护的两个相邻页面更好的解决方案，因为这似乎是导致您的问题的原因。

（Linux 允许您`mprotect()`在*任何*页面上调用，但 POSIX 只允许已分配的页面`mmap()`。）

这是[Electric Fence](http://perens.com/FreeSoftware/ElectricFence/)用来捕获缓冲区溢出的技巧之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-03T12:50:03.530

这与您的问题并不完全相关（除非您的最终目标确实是让您的测试正常工作），但是，恕我直言，依赖这种故障处理可能会产生误导（最明显的是，如果您针对多个平台，其中测试应该失败只是由于某些未指定的行为而没有触发段错误）。

也许另一种方法对您来说更有意义，例如，只需分配一个比必要更大的缓冲区，在其末尾放置一个标记，并检查它是否已被覆盖？

正如其他人所提到的，如果您愿意设置更复杂的测试环境，那么电栅栏、valgrind 或其他工具的分析可能会更精细。

# asp.net - 来自 ASP.Net MVC 控制器的 MailDefinition 的 CreateMailMessage 所有者

> ID：595523
> 
> 赞同：3
> 
> 时间：2009-02-27T16:37:10.397
> 
> 标签：asp.net, asp.net-mvc, email

作为通过 ASP.Net MVC 控制器发送的 MailDefinition.CreateMailMessage() 的所有者，我应该发送什么？

```
//   owner:
//     The System.Web.UI.Control that owns this System.Web.UI.WebControls.MailDefinition.
public MailMessage CreateMailMessage(string recipients, IDictionary replacements, Control owner); 
```

编辑：发送一个新的 System.Web.UI.Control() 似乎工作正常。有不同/标准的解决方案吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-11-23T19:41:53.513

[在修改了system.web.ui.webcontrols.maildefinition](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.maildefinition.aspx)中描述的代码后，我遇到了与 Adam 相同的问题

解决方案是将“this”替换为“new System.Web.UI.Control()”

例如，在上面的 C# Microsoft 示例中，而不是：

```
fileMsg = md.CreateMailMessage(sourceTo.Text, replacements, this); 
```

在 MVC 控制器中，您将编写：

```
fileMsg = mailDefinition.CreateMailMessage("email@address.com", replacements, new System.Web.UI.Control()); 
```

# iis - IIS 问题 - 配置按钮无响应

> ID：595527
> 
> 赞同：-1
> 
> 时间：2009-02-27T16:37:54.313
> 
> 标签：iis, windows-xp

我在 Windows XP SP3 机器上的 IIS 遇到了一些问题。当您进入默认网站的属性并转到主目录选项卡时，有一个“配置...”按钮，单击该按钮应该会弹出一个窗口，您可以在其中定义应用程序映射。我遇到的问题是，当我单击按钮（未禁用）时，它什么也不做。第二个对话框只是没有出现。我尝试卸载并重新安装 IIS，甚至使用 Windows XP CD 而不是 PC 上的 I386 目录。我也尝试删除应用程序，单击确定，然后返回并尝试“配置...”按钮，但它仍然无法正常工作。有什么建议么？我已经尝试谷歌搜索几个小时了，但我没有

[![网站属性](https://i.stack.imgur.com/nFtqb.png)](https://i.stack.imgur.com/nFtqb.png)
[（来源：[obsidianspider.com](http://www.obsidianspider.com/vmf/forpost/2009/02/properties.png)）]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-01T21:47:45.727

我有同样的问题，这解决了它：

C:\windows\system32> regsvr32.exe atl.dll

C:\windows\system32> regsvr32.exe %windir%\system32\inetsrv\appconf.dll

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-24T20:08:03.907

我遇到了同样的问题，今天通过从 C:\Windows\system32\inetsrv 目录中的命令提示符运行以下命令解决了它：regsvr32 asp.dll

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T16:46:05.167

几周前我在一台新机器上安装所有东西时遇到了这个问题。

解决方案是使用 aspnet_regiis.exe 实用程序卸载并重新安装 .NET 框架。

使用 -u 卸载，然后使用 -i 重新安装。

# sql - SQL Server Compact Edition 中有哪些 SYSTEM 存储过程？

> ID：595531
> 
> 赞同：0
> 
> 时间：2009-02-27T16:38:41.533
> 
> 标签：sql, sql-server, stored-procedures, sql-server-ce

我正在尝试编写对在 windows mobile 6 上运行的 SQL Server Compact Edition 数据库的更改脚本，并且可以真正使用：

```
EXECUTE sp_rename 'MyTable.SomeColumn', 'BrandNewName', 'COLUMN' 
```

还有哪些其他**系统**存储过程可用？

与非紧凑版本有什么区别？

**编辑：** ce 中 有系统存储过程， **sp_rename**是一个示例，尽管它似乎只适用于表而不是列。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T16:45:28.273

我不相信 SqlCe 中有任何可用的存储过程。我的解决方案是创建一个包含 SqlCeEngine 的类并公开我自己的方法，如 RenameColumn，并在内部完成工作。

编辑1：现在，这很有趣（sp_rename 的存在）。考虑到那里的文档指出 SQL CE 中没有存储过程，我认为对任何人都投反对票是不公平的。

编辑 2：我[从 MSDN](http://msdn.microsoft.com/en-us/library/ms173372.aspx#)看到了这个链接，它表明至少有一个其他过程：sp_show_statistics。我假设您使用的是 SQL CE 3.5 SP1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T16:44:27.917

[SQL CE 不支持存储过程](http://blogs.msdn.com/stevelasker/archive/2008/02/11/stored-procedures-and-sql-server-compact-the-great-debate.aspx)，所以根本没有。

# asp.net - 使用 UNC 文件路径时，Asp.net FileUploader 不起作用

> ID：595547
> 
> 赞同：4
> 
> 时间：2009-02-27T16:42:50.790
> 
> 标签：asp.net, permissions, file-upload, path

首先让我说，我不是 Windows 文件权限方面的专家，所以也许我在这里缺少一些非常基本的东西。

我有一个 Asp.net FileUploader 控件。我有一个文件夹与我想上传文件的 Asp.net 应用程序在同一台机器上。

我希望能够告诉 FileUploader 将文件放入

```
\\thisMachineName\UploadFolder\ 
```

但我总是得到一个异常，指出对该路径的访问被拒绝。

如果我将目录更改为

```
c:\UploadFolder\ 
```

它工作正常。此外，我可以将上述 UNC 放入 Windows 资源管理器，它实际上映射到目录。

有什么想法或想法吗？

--更新注意：这是一个Windows 2000服务器盒子，文件夹有“Everyone”授予所有可能的允许权限。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T17:11:05.980

我经常看到人们做的一件事是他们未能设置共享权限。要设置共享文件夹，您必须执行以下操作：

1) 确定您将连接到共享的
帐户 2) 授予此帐户对文件系统的访问权限
3)**授予此帐户对网络文件共享的访问权限**

在这种情况下，第 1 项通常意味着检查您的配置或简单地使用进程资源管理器来确定 ASP.NET 在哪个帐户下运行。谷歌上有很多关于如何做到这一点的信息。

2号是显而易见的。您登录物理驱动器所在的计算机，浏览到资源管理器中的文件夹，右键单击它并点击安全选项卡。我们已经这样做了无数次。

第三是人们搞砸的地方。是的，工作人员帐户现在有权访问本地文件系统，但不能通过网络连接到本地文件系统。从“安全”选项卡跳回网络共享选项卡并查找“权限”按钮。您将使用它来授予工作人员帐户连接到共享的权限。

我看到的第二个问题是当人们试图将机器 A 上的访问权限授予只存在于机器 B 上的帐户时。这通常是行不通的。机器 A 和机器 B 都必须属于 A 和 B 都信任的公共域来验证用户。大多数情况下，运行 Windows 的企业使用 ActiveDomain 来控制网络上的访问权限。

为了让机器 B 上的 ASP.NET 工作进程访问机器 A 上的共享，工作进程必须在网络上经过身份验证的帐户下运行，而不仅仅是本地机器。大多数情况下，您必须在网络上创建一个特定帐户并将该帐户权限授予两台计算机，然后使用该帐户为您的网站运行 ASP.NET 工作进程。

如果你摸不着头脑，那么你有一些学习要做。这东西不容易。我强烈建议阅读以下内容：

[http://msdn.microsoft.com/en-us/library/ms978378.aspx](http://msdn.microsoft.com/en-us/library/ms978378.aspx)

它相对清晰，包含您需要知道的所有内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T16:45:58.350

您可以将文件放在该目录中，但是运行 ASP.NET 进程的用户呢？在 Windows Server 2003（可能是 2008，但我不确定）上，ASP.NET 在 NETWORK SERVICE 帐户下运行，该帐户几乎没有任何权限，尤其是在网络上。您必须在 ASP.NET 应用程序上使用模拟或设置具有所有人访问权限的共享。对于这种类型的场景，我通常只是设置一个具有所有人访问权限的共享，并且防火墙对其进行保护，因此只有 Web 服务器可以访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-18T15:19:28.437

除了威尔的回答。

我必须授予 :`NETWORK`帐户而不是`NETWORK SERVICE`帐户的权限。

在共享文件夹的安全选项卡中添加`NETWORK`为新用户并授予所需权限。

# java - 春天是光荣的工厂；这是可以接受的吗？

> ID：595554
> 
> 赞同：8
> 
> 时间：2009-02-27T16:43:33.160
> 
> 标签：java, spring

我刚刚继承了一个 Java 应用程序，在检查代码后，我看到恕我直言是 Spring 框架的混蛋。你看，Java 团队似乎对接口有反感，所以我们最终得到了这样的结果：

```
@Autowired
private SomeConcreteFinalClass _myField; 
```

没有 Spring 配置，没有定义 bean，我没有机会单独测试包含对象。这本质上是一个基于注解的工厂，具有 Spring 的开销。

是我越界了，还是这就像用大象枪杀苍蝇一样？我只需要进行现实检查，因为*团队中的其他人都*认为这是完全可以接受的。

**编辑** 在许多情况下，这些带注释的工厂出现在复杂的处理类中，这些类将从孤立的测试中受益匪浅。不过，该团队也对测试不满意。

我希望这里没有什么神秘之处。如果我有一个具体的类，它不在接口后面，并且没有相应的 Spring bean 来“设置”对象，那么它无疑是一个可以用 10 行代码实现的荣耀工厂。

系统中没有以任何其他方式使用 Spring；就是这个。

我现在的目标：

*   制定测试政策
*   教育团队了解组件隔离的优点
*   将这些 Autowired 字段移到接口后面

我想最后一个问题是：如果我们不测试或以任何其他方式使用框架，那么保持这些字段自动连接有什么好处。`new`如果依赖项是不可变的，我也会选择对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T16:47:14.353

我同意你的观点，这是对 Spring 可以做的事情的滥用（而不是 Spring 应该做的事情）。设计应用程序的人是这样吗？听到他们以这种方式构建应用程序的理由会很有趣。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T16:50:27.697

这当然会限制可能发生的事情，但也不是完全浪费时间。

由于有问题的类型是`final`，因此不能轻松地模拟它以进行隔离测试。

但是，该类型的实例仍然可以通过它们的属性进行高度可配置。使用 Spring 注入在运行时正确配置的实例极大地简化了包含类。该类可以专注于其职责，依靠 Spring 为其提供所需的协作者。

接口*被*过度使用；这可能是对此的回应。我认为，从许多类型的最终具体类开始，然后在确定特定需求时使用现成的重构工具提取接口，在许多情况下都是一个可辩护的立场。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T16:47:34.867

我不能说我完全明白这一点。毕竟，在一个`main`方法中连接系统可能需要几行代码，然后你就不会依赖 Spring。

是的，我同意不注入接口有点毫无意义。我倾向于不做大量的单元测试，但即便如此，我会在以后更改实现时失去任何灵活性（或者在不同的部署中拥有不同的类实现——例如集成测试）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T18:30:29.627

抱歉，根据您发布的两行代码，我无法判断这是否是对 Spring 的滥用，我怀疑其他人也可以。

如果您抱怨该对象的静态类型不是接口这一事实，您可能有道理。但即便如此，也很难从那一行代码中分辨出来。这真的是一个没有接口的服务或存储库类吗？如果是这样，我同意。如果没有，我需要知道更多。

如果您的团队不赞成测试，那就太糟糕了。我原以为 Spring 的原因之一是为了方便测试。

你可能有一点，但我不能从你原来的问题中确定。也许您可以更详细地编辑。

如果这是你与队友沟通的一个例子，如果他们说你没有很好地解释自己，也许他们是有道理的。确保你不只是在这里自我扩张。

# lisp - 将 Common Lisp 代码移植到 Clojure

> ID：595556
> 
> 赞同：35
> 
> 时间：2009-02-27T16:43:39.197
> 
> 标签：lisp, clojure, common-lisp

将 Common Lisp 应用程序移植到 Clojure 有多实用？更具体地说，Common Lisp 中存在哪些 Clojure 中不存在且必须重写的功能？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-27T20:45:57.710

[clojure.org 上有一份关于](http://clojure.org/lisps)Clojure和其他 Lisps 之间差异的列表。我在使用 Clojure 时注意到的其他一些事情：

*   惯用的 Clojure 非常倾向于不可变的数据结构。您在 CL 中看到的任何地方都`SETF`可能需要在 Clojure 中进行更改才能充分利用。（您总是可以选择在 Clojure 中使用可变 Java 数据结构，但大多数人没有。）

*   Clojure 的多方法类似于 CL（可以说更强大，因为您可以调度类型以外的东西），但 Clojure 中没有完整的 CLOS。Clojure`struct`改为使用它，这只是一个花哨的哈希图。当然，Java 的 OOP 系统也是可用的。有些人正在努力将 CLOS 移植到 Clojure，但我不确定目前这些努力进展到什么程度。

*   在符号/命名空间解析方面，Clojure 宏的工作方式与 CL 宏略有不同。我不确定我是否理解得足够清楚以阐明差异。不过，您不必在 Clojure 中过多地使用 gensyms，这很好。

*   Clojure 没有像 CL 那样的条件系统。您只有 Java 的`try`//用于异常处理`catch`。`finally`

*   Clojure 不允许用户定义阅读器宏。

*   Clojure 没有多个返回值。Clojure 中的解构非常好（支持列表、向量、哈希映射、集合等），并且默认情况下它内置在比 CL 更多的地方，所以这不是一个问题。

根据应用程序及其编写方式，从 CL 移植到 Clojure 可能是实用且直接的，或者以更实用、线程安全的方式从头开始重写以更好地适应 Clojure 风格可能更实用.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-27T16:54:00.373

我没有具体的答案，但我推荐这些资源：

*   Rich Hickey 的[两](http://clojure.blip.tv/file/1313398/) [部分](http://clojure.blip.tv/file/1313503/)演讲 Clojure for Lisp Programmers
*   Stuart Halloway将 Peter Seibel 的*[Practical Common Lisp](http://gigamonkeys.com/book/)*[中的示例翻译成 Clojure 的工作](http://blog.thinkrelevance.com/2008/9/16/pcl-clojure)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-27T17:05:54.010

有许多关于从 CL 过渡到 Clojure 的说明（[博客](http://djkthx.blogspot.com/2008/11/from-common-lisp-to-clojure-part-1.html)、[另一个博客](http://briancarper.net/2009/01/19/clojure-1-common-lisp-0/)、[HN 上的线程](http://news.ycombinator.com/item?id=440348)）。

许多 Common Lispers 在第一次检查 Clojure 时遇到的最大问题是它缺少**Tail Call Optimization**，这在 JVM 上是不可能的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2010-11-27T13:49:57.230

对于惯用的 CL 代码，它是一个重写。

*   CL 是命令式的，Clojure 更纯粹是“功能性的”。
*   CL 是面向对象 (CLOS)，Clojure 不是（使用 Java 对象并具有一些 OO 机制）
*   标识符和语法大多不同。
*   数据结构不同。
*   CL 大多是严格的（非惰性的），Clojure 使用惰性计算。

即使将必要的基础设施（CLOS、错误处理、流）移植到 Clojure 也没什么意义，因为 Clojure 确实是一种具有不同编程风格的不同语言。

如果不想重写代码，例如[ABCL](http://common-lisp.net/project/armedbear/)，它是 JVM 的 Common Lisp。

# sharepoint - 这是 MOSS 2007 中 SharePoint 列/字段内部名称的错误吗

> ID：595557
> 
> 赞同：1
> 
> 时间：2009-02-27T16:43:55.077
> 
> 标签：sharepoint, moss, field

SharePoint MOSS 2007 中的列似乎存在错误。

它允许您添加一个新列，例如“团队”。当您添加它时，它会将内部名称存储为“团队”，这是有道理的。然后，企业决定将“团队”称为“工作流”，因此您可以根据要求对其进行重命名。在根网站集中，此列的内部名称仍为“团队”。

然后，用户将新站点列添加到称为“团队”的子站点，并在各种内容类型中使用它。您现在有两个具有相同内部名称“团队”的列或字段。

我现在被要求将整个网站集导出和导入到另一台服务器。当我这样做时，stsadm.exe 告诉我它发现了一个重复的列并且出错了。

我无法删除任何一列，因为它们在各种内容类型中使用。

任何人都可以提出解决此问题的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T17:18:40.110

这听起来像一个错误，我不知道有什么办法可以绕过它。我不相信无论如何要更改列的内部名称。

以下是我的一些想法：

您可能想要研究 3rd 方模仿工具，例如[metalogix](http://www.metalogix.com)，它最终可能比花时间为一次性迁移项目编写自定义代码更容易且更具成本效益。

如果您可以将站点拆分到应该解决问题的新服务器上的不同站点集上。

也许您可以[将内容数据库备份和还原](http://www.keirgordon.com/2008/02/move-sharepoint-content-database.html)到新服务器，然后附加到它。

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T01:35:56.077

诀窍是仅使用 xml 架构而不是使用前端添加列。通常我会使用包含所有字段定义和内容类型的解决方案/功能来执行此操作。

由于您已经添加了内容类型，因此您可能需要使用[SharePoint 管理器](http://www.codeplex.com/spm)之类的工具来查看架构 xml 并引入一个新的。这可以更好地控制任何字段的确切定义。

There can never be two fields with the same internal name. We have had issue when fields have been defined on the site using the /_layouts/settings.aspx and also at the list level. As far as I can tell, when a site restores, it tries to add any fields from the list or subsite level into the base site (alert: opinionin formed only by looking at log errors and trial and error rather than actual facts) and this is where it seems to fail. Making sure that all the fields are defined in a consistent way using the Schema xml (easiest to do with a feature defining the content types) may help iron out the issues. I.e. all fields of the same "name" have the same guid name etc in all sites.

Note: We have also had issue with cross site queries after manually adding fields. The query code has some bugs (I believe it is on the MS stack to be fixed) that mean it relies on fields being defined in a certain order on the underlying tables.

# php - 您如何在 Php 中评论 html 模板（以实用的方式）？

> ID：595559
> 
> 赞同：1
> 
> 时间：2009-02-27T16:44:46.200
> 
> 标签：php, regex, templates, comments

是否有一个简单的解决方案来做相当于 Java 的评论：

```
<%-- this is a comment inside a template, it does not appear in the output HTML --%> 
```

即使你使用简短的 php 标签，你仍然必须在 php 标签之上用注释语法包装注释：

```
<? /* this is a comment of the html template */ ?> 
```

我正在考虑对输出模板进行某种过滤，以删除所有 html 注释，或者更好的是，像上面的 Java 语法这样的自定义注释，但你将如何以最有效的方式做到这一点？您必须运行正则表达式对吗？

我的问题的原因很简单，在 MVC 框架中，使用组件和可重用的 html 模板（想想 YUI），我需要以可读的方式清楚地记录这些模板。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T16:48:44.160

不是我知道的，但是短标签加上块注释非常容易 - 就像你上面提到的 JSP 注释一样容易键入：

```
<?/* This is a comment */?> 
```

甚至

```
<?// this is a comment ?> 
```

对于更复杂的 PHP 模板系统，例如 Smarty，还有其他语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T17:06:25.133

关于你的短标签的事情，我会为此加 2 美分。

在对模板进行评论之前，您需要仔细考虑这一点。短标签在任何地方都不受支持，因为它不是标准的东西。它很有用，但最有可能引起麻烦。

因此请确保使用完整的 php 标签 (

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T16:46:16.040

这些不应该工作吗？

```
<? # This is a comment ?>
<? // This is a comment too ?> 
```

这不是太冗长了吧？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T16:47:45.707

Triptych 对于 php 标签内部是正确的。在外面，`<!-- Comment here -->`仍然有效。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T17:02:15.003

如果您真的想/必须使用纯 php 进行模板

```
    <?# 这似乎是发表评论的最佳方式？>
    <?/* 但是
         屏蔽评论
         看起来很丑恕我直言*/？>

```

但我认为 PHP 和 JSP 之间存在很大的概念差异 - 不是在其现实世界的使用场景中，而是它们的创建/设计目的。

虽然 JSP 显然被构建为 Java Web 应用程序的“视图”或“表示”部分，控制逻辑尽可能少，但 PHP 开始时类似于 Perl，但更专注于 Web 开发。

因此，您的用例（可重用的 MVC 框架）似乎需要一种单独的 PHP 模板语言，如[Smarty](http://www.smarty.net/)或[PHPTAL](http://phptal.motion-twin.com/)，它们比普通的 PHP 更适合将表示与逻辑分开。这样，您将像使用 JSP 一样将 PHP 用于模型和控制器部分以及模板语言（是的，大多数模板引擎都支持对模板/模板块进行注释，比 PHP 好得多）。

亲切的问候

阿尔格尔巴格尔

# algorithm - 轨道方程，以及运行它们所需的功率

> ID：595596
> 
> 赞同：3
> 
> 时间：2009-02-27T16:51:22.097
> 
> 标签：algorithm, estimation, supercomputers, orbital-mechanics

由于今天对[SO IRC](http://irc://freenode/%23stackoverflow)的讨论，我对轨道力学很好奇，并且

*   解决轨道问题所需的方程
*   解决复杂问题所需的计算能力

尤其是计算地球何时会进入太阳的问题（反之亦然，取决于参考系）。

我怀疑我们太阳系内的所有引力可能都需要计算，这让我想知道需要什么类型的计算机集群，或者这可以在一个盒子上完成吗？

我没有在这里做餐巾纸背面测试的经验，但也许你有？

此外，非常感谢 Gortok 的原始灵感（见评论）。

-亚当

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T16:56:32.007

参见维基百科上的[三体问题](http://en.wikipedia.org/wiki/Three_body_problem)。当你在引力场中有两个以上的物体并且你不能简化问题时，这是非常困难的:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T19:52:46.730

如果有超过三个实体，则没有封闭形式的解决方案。有多种近似方法（请参阅[此处](http://en.wikipedia.org/wiki/N-body_simulation)或[此处](http://www.scholarpedia.org/article/N-body_simulations)的 N-Body 模拟文章）。根据您需要的准确度，您将需要七到数百个身体。由于相对规模（与星系模拟相比），您将无法从聚类中获得太多简化。

不过，就具体问题而言，您还必须估算太阳直径的变化。我认为红巨星阶段会比轨道衰变更早发生，这将使太阳的直径大于当前的地球轨道。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-06-10T04:08:16.960

尽管您提出的问题无疑需要非常精确的大量计算（忽略红巨星相位问题，地球轨道会/会衰变为太阳吗？），但有现成的软件工具可用于执行其他天体路径/轨道计算。这里仅仅是少数：

*   [OrbFit](http://adams.dm.unipi.it/orbfit/)
*   [ORSA - 轨道重建、模拟和分析](http://orsa.sourceforge.net/index.html)

最后，虽然 NASA 用于计算航天器等**未来轨道和轨迹的软件受**[ITAR](http://en.wikipedia.org/wiki/ITAR)限制，但它显然确实为我们太阳系中的各种物体以及过去和当前的主要任务公开了一些**过去的轨迹信息。**这是通过[导航和辅助信息设施 (NAIF)](http://naif.jpl.nasa.gov/naif/index.html)处理的。

NAIF 为上述目的提供软件和数据：

*   [SPICE 工具包](http://naif.jpl.nasa.gov/naif/toolkit.html)（不要与每个 EE 专业人士熟悉的其他[SPICE 工具](http://en.wikipedia.org/wiki/SPICE)混淆）
*   [SPICE 数据内核](http://naif.jpl.nasa.gov/naif/data.html)

如果您尝试以上所有方法，您可能会学到一些关于轨道方程和所涉及的计算能力的知识。;-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T17:14:17.250

在费曼的一次讲座中，他谈到了用 1960 年代的计算机进行轨道计算，以及那有多好。1960 年代初的任何计算机都没有我的手机或 DS 的强大功能，而我实际购买的用作计算机的东西要强大得多。

你有电脑，朋友。这些力也很容易计算，因为它都是引力，行星可以被视为点质量。分析计算行星轨道可能更容易，并将引力扰动视为离散推动。去吧。如果您需要帮助，请查找有关轨道力学的知识或与物理学家或天文学家交谈。

这不会帮助您找到地球何时撞击太阳，因为我们的轨道非常稳定。然而，在数十亿年之后，太阳会膨胀很多，并可能到达我们的轨道。不过，这可能是一个有趣的项目。

# xml - 使用 LINQ 对属性进行 VB XML 查询

> ID：595597
> 
> 赞同：3
> 
> 时间：2009-02-27T16:51:37.930
> 
> 标签：xml, vb.net, linq

我正在尝试学习 LINQ，并且有一个关于使用 VB 查询 XML 的问题。

我的 XML：

```
 <Procedure-Text>
    <A ID="marker1"></A>Do This Procedure
 </Procedure-Text>
 <Procedure-Text>
    <A ID="marker2"></A>Do That Procedure
 </Procedure-Text> 
```

如何指定我的查询以仅获取具有 ID 属性**marker2**的过程文本？换句话说，我想要一个显示*Do That Procedure*的结果字符串。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T17:06:13.200

使用 VB XML 文字：

```
Dim marker2 = From x In data...<Procedure-Text> _
              Where x.<A>.@ID = "marker2" _
              Select x 
```

三点语法产生一个 xml 元素的“所有后代”，即在里面`data...<Procedure-Test>`产生一个`<Procedure-Test>`标签列表`data`

XML 文字上的点语法意味着“第一个后代”，因此`x.<A>`将产生`<A>`内部 x 的第一次出现。其中 x 现在是`<Procedure-Test>`

现在您有了所需的元素，使用属性选择器`<A>`将其 id 与字符串进行比较是微不足道的。将评估标签的 ID 属性是否等于“marker2”`@attr``<A>.@ID = "marker2"``True``<A>`

So表示“ x 内`x.<A>.@ID`第一个标签的 ID 属性”`<A>`

你想要`<Procedure-Text>`元素，所以你指定`Select x`

完整示例：

```
Sub Main()

    Dim data = <doc>
                   <Procedure-Text>
                       <A ID="marker1"></A>Do This Procedure
                   </Procedure-Text>
                   <Procedure-Text>
                       <A ID="marker2"></A>Do That Procedure
                   </Procedure-Text>
               </doc>

    Dim marker2 = From x In data...<Procedure-Text> _
                  Where x.<A>.@ID = "marker2" _
                  Select x

    ' prints the second procedure-text element
    Console.WriteLine(marker2.FirstOrDefault().ToString())

    Console.ReadKey()

End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T17:01:07.250

linq 查询是

```
from x 
in d.Descendants("A") 
where x.Attribute("ID").Value == "marker2" 
select x.NextNode 
```

换句话说，寻找一个名为 A 的元素，它的 ID 属性是“marker2”，然后直接取下一个节点。

您可能希望对生成的枚举执行 FirstOrDefault() 以获取其中包含您的文本的 XNode（它实际上是一个 XText）。

# c# - 从 .NET 执行 Cygwin 进程？

> ID：595600
> 
> 赞同：4
> 
> 时间：2009-02-27T16:52:13.980
> 
> 标签：c#, .net, ruby, process, cygwin

我正在尝试从 .NET 应用程序启动 Cygwin 版本的 ruby​​.exe，但我被卡住了。

```
c:\>"c:\cygwin\bin\ruby.exe" c:\test\ruby.rb
/usr/bin/ruby: no such file to load -- ubygems (LoadError) 
```

如您所见，Ruby 无法找到库，因为它正在寻找一些 Linux 风格的路径。

显然，当我从 .NET 运行 ruby​​.exe 时，因为它找不到库，它会像上面一样失败。

如果我不加载任何库，它工作正常：

```
c:\>"c:\cygwin\bin\ruby.exe" -v
ruby 1.8.7 (2008-08-11 patchlevel 72) [i386-cygwin] 
```

最初 cygwin 以这个 cygwin.bat 开头

```
chdir C:\cygwin\bin
bash --login -i 
```

如何让 .NET 先进入 cygwin 环境，然后在该环境中执行 ruby​​？

*   我不能使用 Windows Ruby，我需要 cygwin ruby​​。
*   我知道交互式驱动“bash”的潜在用途，但这听起来很脏，除非有很好的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T17:08:52.397

您是否正在使用混合原生 Windows ruby​​gems 和 Cygwin ruby​​？使用 Cygwin ruby​​gems 似乎对我来说很好用。（为什么您的 Cygwin ruby​​ 解释器显然在搜索带有 Windows 反斜杠的路径？）。

或者，你试过`run.exe`吗？

```
C:\cygwin\bin\run.exe -p /starting/dir exe_to_run 
```

这是手册页条目：

> 姓名
> 
> 运行 - 使用隐藏的控制台窗口启动程序
> 
> 概要
> 
> 运行 [ -p 路径 ] 命令 [ -wait ] 参数
> 
> 运行命令 [ -p 路径 ] [ -wait ] 参数
> 
> 描述
> 
> Windows 程序要么是 GUI 程序，要么是控制台程序。启动时控制台程序将附加到现有控制台或创建一个新控制台。GUI 程序永远不能附加到现有的控制台。无法附加到现有控制台，但如果以 GUI 程序启动，则将其隐藏。
> 
> run 将为您执行此操作。它用作中间程序并启动程序，但隐藏控制台窗口。
> 
> 使用 -p path 您可以将路径添加到 PATH 环境变量。
> 
> 发出 -wait 作为第一个程序参数将使 run 等待程序完成，否则它立即返回。
> 
> 第二个变体用于创建包装器。如果可执行文件名为runco​​mmand（例如runemacs），run 将尝试启动程序（例如emacs）。
> 
> 例子
> 
> 运行 -p /usr/X11R6/bin xterm
> 
> 运行 emacs -wait 运行 emacs -wait
> 
> 运行 make -wait

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T17:02:04.567

为什么不执行一个从 .NET 应用程序运行 ruby​​ 的非交互式 bash shell？就像是：

```
bash --login -c <your-path-to-ruby> <your-library-to-load> 
```

不确定您的文件结构，但例如，

```
bash --login -c /usr/bin/ruby ~/test/ruby.rb 
```

查看[bash 手册页中的 -c 选项以](http://linux.die.net/man/1/bash)获取更多信息。

# .net - Delphi 与 .NET 的互操作性

> ID：595601
> 
> 赞同：6
> 
> 时间：2009-02-27T16:52:39.737
> 
> 标签：.net, delphi

我目前有一个 delphi (win32) 代码的代码库。我想扩展新功能，但是，我的知识是 .NET (C#)，我想保留现有的代码库并在 .NET 中添加新功能。

如果有的话，我的选择是什么（对于 delphi 和 .NET 互操作）？

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-27T18:14:31.037

我没用过，但是看看[RemObject Hydra](http://www.remobjects.com/hy/)。

> Hydra 可以在单个应用程序中轻松混合和匹配本机 Delphi 和托管 .NET 代码，允许开发人员选择最适合他们需要的技术集。

基本上，您可以在您的 Delphi 应用程序中嵌入可视和非可视 .NET 代码，并像使用 Delphi 本机一样使用它。他们有免费试用版，现在正在进行一场竞赛，您可以[通过查看免费试用版赢得免费副本](http://www.delphi.org/2009/02/21-remobjects/)。

除此之外，您还可以[在 Delphi 中通过 COM 使用 .NET](http://edn.embarcadero.com/article/32754)。.NET 程序集可以是 C#、Prism、VB.NET 或任何 .NET 语言。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-27T17:02:55.220

有几个选项：

*   可以在程序集中创建和公开 .NET 类作为 COM 控件（互操作），以便在 Delphi 中使用它。

*   Delphi 曾经是.Net 一段时间（但这不是Delphi 最辉煌的时刻），因此以Delphi 2006 为例，您可以将Delphi 用作.Net 语言。然而，就像，如果不是更多，任何其他 Delphi 版本更改，与旧源代码不兼容。

**编辑** 要执行第一种方法，您需要使用 .NET 语言创建具有所需的类/功能的程序集并对其进行编译。您最终应该得到一个 DLL。

在 Delphi 中，在 Component 菜单下，选择 Import Component（它应该在 Install Packages 下面）。你会得到一个向导，它应该有 3 个单选选项

*   导入类型库
*   导入 ActiveX 控件
*   导入 .NET 程序集

选择第三个，您将看到全局注册程序集的列表。由于您的程序集只是一个匿名 DLL，因此单击底部附近的添加，然后在打开的对话框中选择 DLL。

在下一页上，您将被要求提供调色板信息。在这里您可以选择 - 指定您的项目文件夹并取消选中“生成组件包装器”以仅将程序集添加到您的项目中。另一种选择是将它放在 lib 或其他全局文件夹中并检查 wrapper 选项，这会将其添加到所有项目的工具面板中。

最后一个屏幕将询问您是否要将其添加到当前项目中（取决于您将其添加到全局还是仅添加到一个项目中）。

完成所有操作后，您应该能够在 Delphi 中创建 .Net 类的实例，如下所示：

```
var MyCSharpClassInstance: TMyCSharpClassProvider;
begin
     MyCSharpClassInstance:=CoTMyCSharpClassProvider.Create;
     …
     MyCSharpClassInstance.Free;
End 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T17:04:05.967

[您可以使用最新的Delphi Prism](http://www.codegear.com/products/delphi/prism)（即 2009）为 .NET 编译您的 Delphi 代码。可以使用 Delphi 文件制作 .NET 程序集，然后它们使用常规 C# 扩展该类。

如果你的类是密封的，你也可以使用扩展方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T17:05:02.703

我相信 Delphi 在几个版本之前都有 .NET 编译。

[http://www.codegear.com/products/bds2006](http://www.codegear.com/products/bds2006)

“除了适用于 .NET 编程语言的 Delphi Win32 和 Delphi 之外，Developer Studio 2006 还包括对 C 和 C# 的完整 RAD 支持。”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T17:05:59.907

你可以看看[这里](http://www.remobjects.com/oxygene.aspx)，他们为 Delphi.Net 生成了一个编译器。这可能是一个前进的方向。

# sql - 如何为此 SQL 查询创建单个 where 条件？

> ID：595603
> 
> 赞同：2
> 
> 时间：2009-02-27T16:53:18.410
> 
> 标签：sql, sql-server-2005, stored-procedures

我正在使用 MSSQL 2005 Server，并且有以下 SQL 查询。

```
IF @CategoryId IN (1,2,3)
    BEGIN
        INSERT INTO @search_temp_table 
        SELECT * FROM (SELECT d.DataId, (SELECT [Name] FROM Category WHERE CategoryId = d.CategoryId) AS 'Category', d.Description, d.CompanyName, d.City, d.CategoryId,
                d.CreatedOn, d.Rank, d.voteCount, d.commentCount, d.viewCount
        FROM Data d 
                INNER JOIN Keyword k
                    ON d.DataId = k.DataId
        WHERE FREETEXT(k.Keyword, @SearchQ) AND d.CategoryId=@CategoryId AND d.IsSearch=1 AND d.IsApproved=1 ) AS Search_Data
    END
    ELSE
        BEGIN 
            INSERT INTO @search_temp_table 
            SELECT * FROM (SELECT d.DataId, (SELECT [Name] FROM Category WHERE CategoryId = d.CategoryId) AS 'Category', d.Description, d.CompanyName, d.City, d.CategoryId,
                    d.CreatedOn, d.Rank, d.voteCount, d.commentCount, d.viewCount
            FROM Data d 
                    INNER JOIN Keyword k
                        ON d.DataId = k.DataId
            WHERE FREETEXT(k.Keyword, @SearchQ) AND d.IsSearch=1 AND d.IsApproved=1 ) AS Search_Data
        END 
```

在上面的查询中，我有类别条件，

```
d.CategoryId=@CategoryId 
```

在传递任何类别时执行，如果没有传递类别，那么我不考虑 where 子句中的类别条件，仅当 (1,2,3) 中的类别我使用了 If-Clause 时才实现类别条件，但是我们不能在单个 where 查询中执行此操作吗？这意味着只需检查类别中是否存在值（或者如果很容易，那么我们只能检查 1,2,3 个值）然后将应用该条件，否则查询将不考虑类别条件。

有什么办法，使用 CASE 或 NOT NULL 语句？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T16:58:19.520

如果 @CategoryId 为 NULL 当您不想通过它进行过滤时，您可以使用以下条件...

```
ISNULL(@CategoryId, d.CategoryId) = d.CategoryId 
```

所以如果它是NULL那么它等于它自己并且不会过滤

**编辑**

我喜欢 Marc Miller 的 COALESCE 示例，您可以使用其中任何一个，我真的不应该评论一个诗句的表现，但是......

我的直觉告诉我 ISNULL 应该会胜出，但是如果您无事可做（或者如果性能在此查询中非常关键），请[查看有关此问题的一些辩论。](http://sqlblog.com/blogs/adam_machanic/archive/2006/07/12/performance-isnull-vs-coalesce.aspx)

**注意：**如果表中的 d.CategoryId 可以为 NULL，则此方法将失败，应在此问题的其他地方使用 CASE WHEN THEN 方法

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T17:05:56.617

如果唯一的区别是你的 where 子句，那么你可以这样做：

```
d.CategoryId = COALESCE(@CategoryId, d.CategoryId) 
```

不确定为什么需要 IN 子句 (IN (1,2,3))，因为您提到检查它的原因是确保它不为 NULL。所以这应该按照你描述的方式工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T17:01:10.560

执行 ((@CategoryId IN (1,2,3) AND CategoryId=@CategoryId) OR NOT @CategoryId IN (1,2,3)) 将检查类别 ID 是否为 1、2 或 3，否则不会应用该过滤器。

```
 WHERE FREETEXT(k.Keyword, @SearchQ) AND ((@CategoryId IN (1,2,3) AND d.CategoryId=@CategoryId) OR NOT @CategoryId IN (1,2,3))  AND d.IsSearch=1 AND d.IsApproved=1 ) AS Search_Data 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T17:01:18.950

如果类别在 1,2 或 3 中，则使用指定的 @CategoryId 进行过滤，否则不通过检查自身。

```
AND IsNull(d.CategoryId, 1) = case when @CategoryId in (1,2,3) then @CategoryId else IsNull(d.CategoryId, 1) end 
```

当**@Category 或 CategoryId 为 null** 并且“If”语句可以消失时，此查询也**有效。**

 **完整查询如下

```
INSERT INTO @search_temp_table 
    SELECT * FROM (SELECT d.DataId, (SELECT [Name] FROM Category WHERE CategoryId = d.CategoryId) AS 'Category', d.Description, d.CompanyName, d.City, d.CategoryId,
                    d.CreatedOn, d.Rank, d.voteCount, d.commentCount, d.viewCount
    FROM    Data d 
            INNER JOIN Keyword k ON d.DataId = k.DataId
    WHERE   FREETEXT(k.Keyword, @SearchQ) 
            AND IsNull(d.CategoryId, 1) = case when @CategoryId in (1,2,3) then @CategoryId else IsNull(d.CategoryId, 1) end
            AND d.IsSearch=1 
            AND d.IsApproved=1 ) AS Search_Data 
```

***警告**：确保检查执行计划是否比使用“if”语句慢。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T17:07:49.777

可以在那里进行 LEFT JOIN，如下所示：

```
INSERT INTO @search_temp_table
SELECT  *
FROM    (
    SELECT  d.DataId,
            c.[Name] as 'Category',
            d.Description, d.CompanyName, d.City, d.CategoryId,
            d.CreatedOn, d.Rank, d.voteCount, d.commentCount, d.viewCount
            FROM Data d 
            INNER JOIN Keyword k ON d.DataId = k.DataId
            LEFT JOIN Category c on c.CategoryId=d.CategoryId
                AND c.CategoryId=@CategoryId
            WHERE FREETEXT(k.Keyword, @SearchQ)
            AND d.IsSearch=1
            AND d.IsApproved=1
) AS Search_Data 
```

您也不再需要 if 语句。

此外，在 LEFT JOIN 中拥有 c.CategoryId=@CategoryId 非常重要，如果将其移至 WHERE 子句，它将强制 LEFT JOIN 进入 INNER JOIN。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T17:22:27.543

类似于标记答案，您可以执行以下操作：

```
WHERE FREETEXT(k.Keyword, @SearchQ) 
  AND d.IsSearch=1 
  AND d.IsApproved=1 
  AND ((@CategoryId NOT IN (1,2,3)) OR (d.CategoryId = @CategoryId))
) AS Search_Data 
```

这样你就消除了函数调用

# database - 数据导入/导出过程的 Abinitio 和推荐使用场景

> ID：595615
> 
> 赞同：3
> 
> 时间：2009-02-27T16:56:27.107
> 
> 标签：database, performance, ab-initio, data-importer

我很想知道是否有人有使用[Abinitio](http://www.abinitio.com)进行数据导入、操作、导出的实际经验，以及你是否强烈推荐它。

我希望解决这个过程的可扩展性问题，如果它解决了这些问题，我希望得到一些反馈。

我听说这是一个很好的工具。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-11T16:02:25.187

我在 Ab Initio 方面拥有丰富的实际经验。它是 ETL 工具中强大的凯迪拉克。

如果您有大量数据和大量硬件可以使用它，我强烈推荐它。TB 及以上问题类。通常，数据以 TB/小时为单位，处理 picobyte 数据集在 ab initio 设置中并不少见。

如果您不处理那么多数据，我不建议您这样做。Ab Initio 专为海量数据集而设计，如果您没有那么多数据，那就像用火箭筒射击苍蝇一样。是的，它完成了工作，但是使用火箭筒而不是苍蝇拍的成本并不能证明使用它是合理的。

让我知道你是否想知道其他任何事情！

# rss - 用于 RSS 提要的正确 MIME 类型是什么？

> ID：595616
> 
> 赞同：149
> 
> 时间：2009-02-27T16:56:31.367
> 
> 标签：rss, mime-types

为了确保与 RSS 阅读器和其他抓取工具的兼容性，一种 MIME 类型是否更可取？

选项似乎是：

*   文本/xml
*   文本/rss+xml

有趣的是 Stackoverflow 使用的是 text/html。

* * *

## 回答 #1

> 赞同：252
> 
> 时间：2009-02-27T16:58:18.710

两者都不。这是[http://www.rssboard.org/rss-mime-type-application.txt](http://www.rssboard.org/rss-mime-type-application.txt)**`application/rss+xml`**

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2011-08-09T19:13:04.750

其他评论者指出，唯一正确的 mime 类型是`application/rss+xml,`.

但是，如果您正在为客户端设置接受标头，那么

`Accept: application/rss+xml, application/rdf+xml;q=0.8, application/atom+xml;q=0.6, application/xml;q=0.4, text/xml;q=0.4`

可能是一个不错的选择，因为它声明它接受 RSS、Atom 和 XML（按降序或优先顺序）。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2016-04-19T03:44:55.590

这是一个务实的答案：无论“正确”答案可能是什么（显然对此存在争议），`text/xml`几乎*所有*流行的提要都使用这种类型。

以下是我检查的一些：

```
$ for f in \
  https://feeds.feedburner.com/TechCrunch/ \
  http://feeds.bbci.co.uk/news/video_and_audio/news_front_page/rss.xml \
  http://rss.nytimes.com/services/xml/rss/nyt/HomePage.xml \
  https://daringfireball.net/thetalkshow/rss \
  http://www.npr.org/rss/podcast.php?id=381444908 \
  http://feeds.serialpodcast.org/serialpodcast \
  http://podcasts.joerogan.net/feed \
  https://feeds.feedburner.com/thetimferrissshow \
  http://feed.thisamericanlife.org/talpodcast ; do \
  curl -s -I $f | fgrep -i Content-Type: ; done
content-type:text/xml; charset=UTF-8
Content-Type: text/xml
Content-Type: text/xml
Content-Type: text/xml;charset=UTF-8
Content-Type: text/xml;charset=UTF-8
Content-Type: text/xml; charset=UTF-8
Content-Type: text/xml; charset=UTF-8
content-type:text/xml; charset=UTF-8
Content-Type: text/xml; charset=UTF-8 
```

因此，您可以确定`text/xml`常用的 RSS 客户端会正确解释这些内容。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-04-27T11:01:36.297

最**正确**的是`application/rss+xml`

最**兼容**的是`application/xml`

According to W3C:

> RSS feeds should be served as application/rss+xml (RSS 1.0 is an RDF format, so it may be served as application/rdf+xml instead). Atom feeds should use application/atom+xml. Alternatively, for compatibility with widely-deployed web browsers, any of these feeds can use one of the more general XML types - preferably application/xml.

[https://validator.w3.org/feed/docs/warning/UnexpectedContentType.html](https://validator.w3.org/feed/docs/warning/UnexpectedContentType.html)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-12-09T23:42:00.530

如果您想确保您的提要与 RSS 阅读器和其他抓取工具兼容，请选择[MIME application/rss+xml以确保安全。](http://filetonic.com/file-extension/results.php/MIME)这就是我使用的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T17:03:49.257

您*可以*使用`text/xml`，但正确的 MIME 类型是`application/rss+xml`.

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2016-01-14T09:41:50.557

**text/xml**是唯一正确的答案。Mime 类型是基于注册的系统。[在http://www.iana.org/assignments/media-types/media-types.xhtml](http://www.iana.org/assignments/media-types/media-types.xhtml)有一个由 IANA（互联网号码分配机构）管理的官方列表

# vba - 在行之间重复插入信息的宏

> ID：595619
> 
> 赞同：1
> 
> 时间：2009-02-27T16:56:40.460
> 
> 标签：vba, excel

我想在整个电子表格中重复插入一个列表（如下：发电机、控制塔等）。它应该每隔一行插入一次（在每个涡轮机之后）并偏移一列，如下所示。我不知道如何编写一个宏来自动执行此操作。任何帮助表示赞赏。

```
TURBINE A-2
    Generator
    Control Tower
    Brakes
    Pitch System
    Hydraulic System
    Cooling System
    Oil Filtration System
    Lighting System
    Ascent System
    Scada Systems
    Nacelle Cover
    Cable System
    Fire System
    Blades
TURBINE A-3 
    Generator
    Control Tower
    Brakes
    Pitch System
    Hydraulic System
    Cooling System
    Oil Filtration System
    Lighting System
    Ascent System
    Scada Systems
    Nacelle Cover
    Cable System
    Fire System
    Blades
TURBINE A-4 
TURBINE A-5 
TURBINE A-6 
TURBINE A-7 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T17:22:41.380

这应该可以解决问题：

```
Public Sub AddEntries()
    Dim InsertionRange As Range
    Dim HeaderRow As Integer
    Dim RowIndex As Integer

    Const ListSize = 14
    Dim ListEntries(1 To ListSize) As String
    ListEntries(1) = "Generator"
    ListEntries(2) = "Control Tower"
    ListEntries(3) = "Brakes"
    ListEntries(4) = "Pitch System"
    ListEntries(5) = "Hydraulic System"
    ListEntries(6) = "Cooling System"
    ListEntries(7) = "Oil Filtration System"
    ListEntries(8) = "Lighting System"
    ListEntries(9) = "Ascent System"
    ListEntries(10) = "Scada Systems"
    ListEntries(11) = "Nacelle Cover"
    ListEntries(12) = "Cable System"
    ListEntries(13) = "Fire System"
    ListEntries(14) = "Blades"

    HeaderRow = 1
    While (Cells(HeaderRow, 1).Value <> "")
        Rows(Trim$(Str$(HeaderRow + 1)) & ":" & Trim$(Str$(HeaderRow + ListSize))).Insert shift:=xlDown

        For RowIndex = 1 To ListSize
            Cells(RowIndex + HeaderRow, 2).Value = ListEntries(RowIndex)
        Next RowIndex

        HeaderRow = HeaderRow + ListSize + 1
    Wend
End Sub 
```

我假设 TURBINE 条目都在 excel 文件的第一列中。

# iphone - 通过 nib 加载单元格并引用其中的组件

> ID：595620
> 
> 赞同：0
> 
> 时间：2009-02-27T16:57:07.743
> 
> 标签：iphone, uitableview

我正在加载一个包含两个标记标签的 UITableViewCell。用户将离开当前视图，包含以下代码并转到另一个视图。在那里设置了一个名称值，用户回到这个视图（下面的代码）。我将他们在另一个视图中设置的名称分配给名称标签。这行得通，但我得到一个新标签在我的其他标签之上未对齐。看来我保留了这个单元格的两个版本。不太确定。关于可能导致这种行为的任何建议？

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    UITableViewCell *cell = nil;
if(indexPath.section == 0)
{   
    cell = [tableView dequeueReusableCellWithIdentifier:@"CellNameIdentifier"];
    if (cell == nil) {
        [[NSBundle mainBundle] loadNibNamed:@"CellentName" owner:self options:nil];
        cell = cellName;
        //self.cellName = nil;
    }
}
return cell;
}
- (void)viewDidAppear:(BOOL)animated {
UILabel *startdate = (UILabel *)[cellName viewWithTag:1];
startdate.text = aName;
[super viewDidAppear:animated];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T17:09:18.387

从这段代码的外观来看，您不太可能得到“一个新标签在我的其他标签之上未对齐”，更像是绘图未能正确地重新绘制在事物之上。要完成这项工作，您可以尝试调用 [tableView reloadData] 或使用观察者，但我认为有更好的方法。

您应该能够将对象传递到您的其他视图，修改对象（而不是标签）并以这种方式移动数据。换句话说，在表格视图上，它加载对象，在 cellForRowAtIndexPath 内部，它加载单元格并使用对象数据设置标签名称。推入第二个视图并将对象作为属性传递。在那个屏幕上随心所欲地操纵这个属性，当你弹出视图时，没有特殊的逻辑。第一个表视图再次显示保存在您正在操作的对象中的任何内容。

# web-services - Google Checkout：处理购物车编辑和结帐确认的最佳方式

> ID：595630
> 
> 赞同：5
> 
> 时间：2009-02-27T16:59:24.727
> 
> 标签：web-services, e-commerce, logic, google-checkout

我正在电子商店中实施 Google Checkout。一旦客户单击“Google Checkout”按钮，我的项目要求他们能够导航回电子商店以可能编辑购物车。客户应该能够单击“返回”按钮、输入我的购物车页面的 URL，或单击 Google 的“编辑”链接。

同时，我需要清除购物车，并在客户点击 Google 侧的确认按钮后立即为他们提供一张白纸。我已经在收听来自谷歌的新订单通知，但这并不总是足够快地到达以防止客户返回电子商店并为他们的购物车仍然显示他们刚刚购买的商品而摸不着头脑。

是否有任何 Google Checkout 实施者提出了解决此问题的新方法？任何想法表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-02-12T17:49:30.320

我已经使用 2 种不同的方法完成了此操作，它们都不能正确满足您处理后退按钮和在完成订单时清除购物篮的要求，但它们在实践中为我工作，没有任何抱怨。

**第一种方法**：清除购物篮并通过“EditCartUrl”Google Checkout 请求参数中的查询字符串提供重构它的方法。然后，当客户单击编辑篮子按钮时，他们的篮子被重建。但是，后退按钮在这种情况下不起作用。

**第二种方法**：不清除购物篮，但（可选）在重定向到 Google Checkout 之前将其设为只读。我们这样做是为了使购物篮记录在 Google Checkout 中时无法更改。如果他们随后点击返回或编辑购物车，则每次都会在我们的网站上创建一个新的购物篮（从原始网站克隆）。这提供了对后退按钮的支持，但只有在订单已通过并且我们在客户返回站点之前我们已处理请求时才会为客户提供已清空的购物篮。

将购物篮设为只读是可选的 - 我们这样做是为了保留购物篮记录以匹配来自 Google Checkout 的结果订单。如果你不需要这个，就像不清理篮子一样简单。

在过去的几年里，第二种方法让我很好，没有任何客户抱怨。我宁愿客户能够点击后退按钮，也不愿过分担心他们在使用 Google 结账后看到购物篮不会自己清空。

# java - 即使目标文件已经存在，如何在Java中以原子方式重命名文件？

> ID：595631
> 
> 赞同：41
> 
> 时间：2009-02-27T16:59:33.667
> 
> 标签：java, file, cross-platform

我有一个机器集群，每台机器都运行一个 Java 应用程序。

这些 Java 应用程序需要同时访问一个唯一的`resource.txt`文件。

即使已经存在，我也需要以原子方式将`temp.txt`文件重命名为 Java。`resource.txt``resource.txt`

删除`resource.txt`和重命名`temp.txt`不起作用，因为它不是原子的（它会创建一个`resource.txt`不存在的小时间框架）。

它应该是跨平台的......

谢谢 ！

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-05-10T10:49:16.293

对于 Java 1.7+，`java.nio.file.Files.move(Path source, Path target, CopyOption... options)`与 CopyOptions “REPLACE_EXISTING”和“ATOMIC_MOVE”一起使用。

*[有关详细信息，请参阅 API 文档。](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#move%28java.nio.file.Path,%20java.nio.file.Path,%20java.nio.file.CopyOption...%29)*

例如：

```
Files.move(src, dst, StandardCopyOption.ATOMIC_MOVE); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-02-27T17:06:46.630

在 Linux 上（我相信 Solaris 和其他 UNIX 操作系统），Java 的 File.renameTo() 方法将覆盖目标文件（如果存在），但在 Windows 下并非如此。

要成为跨平台，我认为您必须在 resource.txt 上使用文件锁定，然后覆盖数据。

> 文件锁的行为取决于平台。在某些平台上，文件锁是建议性的，这意味着除非应用程序检查文件锁，否则不会阻止它访问文件。在其他平台上，文件锁是强制性的，这意味着文件锁会阻止任何应用程序访问文件。

```
try {
    // Get a file channel for the file
    File file = new File("filename");
    FileChannel channel = new RandomAccessFile(file, "rw").getChannel();

    // Use the file channel to create a lock on the file.
    // This method blocks until it can retrieve the lock.
    FileLock lock = channel.lock();

    // Try acquiring the lock without blocking. This method returns
    // null or throws an exception if the file is already locked.
    try {
        lock = channel.tryLock();
    } catch (OverlappingFileLockException e) {
        // File is already locked in this thread or virtual machine
    }

    // Release the lock
    lock.release();

    // Close the file
    channel.close();
} catch (Exception e) {
} 
```

默认情况下，Linux 使用自愿锁定，而 Windows 强制使用它。也许您可以检测操作系统，并在 UNIX 下使用 renameTo() 和一些用于 Windows 的锁定代码？

还有一种方法可以在 Linux 下为特定文件启用强制锁定，但它有点晦涩难懂。您必须正确设置模式位。

> Linux 遵循 System V（参见 System V 接口定义 (SVID) 版本 3），让没有组执行权限的文件的 sgid 位将文件标记为强制锁定

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-27T17:10:41.160

这是一个相关的讨论： http://bugs.sun.com/bugdatabase/view_bug.do?bug_id= [4017593](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4017593)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-27T18:11:36.677

[如此处](https://stackoverflow.com/questions/167414/is-an-atomic-file-rename-with-overwrite-possible-on-windows)所述，看起来 Windows 操作系统甚至不支持旧版本的原子文件重命名。您很可能必须使用一些手动锁定机制或某种事务。为此，您可能需要查看[apache commons 事务](https://commons.apache.org/proper/commons-transaction/)包。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T17:29:57.680

如果这应该是跨平台的，我建议 2 个选项：

1.  实现一个负责所有文件访问的中间服务。在这里，您可以使用多种机制来同步请求。每个客户端 java 应用程序仅通过此服务访问文件。
2.  每次需要执行同步操作时创建一个*控制文件。*每个访问该文件的 Java 应用程序都负责检查*控制文件并在该**控制*文件存在时等待。（几乎像一个信号量）。执行删除/重命名操作的进程负责创建/删除*控制*文件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-03-01T03:57:16.167

如果重命名的目的是动态替换 resource.txt*并且*您可以控制所有涉及的程序，*并且*替换频率不高，您可以执行以下操作。

打开/读取文件：

1.  打开“resource.txt”，如果失败
2.  打开“resource.old.txt”，如果失败
3.  再次打开“resource.txt”，如果失败
4.  你有一个错误条件。

要替换文件：

1.  将“resource.txt”重命名为“resource.old.txt”，然后
2.  将“resource.new.txt”重命名为“resource.txt”，然后
3.  删除“resource.old.txt”。

这将确保您的所有读者始终找到有效文件。

但是，更简单的方法是简单地尝试循环打开，例如：

```
InputStream inp=null;
StopWatch   tmr=new StopWatch();                     // made up class, not std Java
IOException err=null;

while(inp==null && tmr.elapsed()<5000) {             // or some approp. length of time
    try { inp=new FileInputStream("resource.txt"); }
    catch(IOException thr) { err=thr; sleep(100); }  // or some approp. length of time
    }

if(inp==null) {
     // handle error here - file did not turn up after required elapsed time
     throw new IOException("Could not obtain data from resource.txt file");
     }

... carry on 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-02-22T21:10:20.903

通过在重命名文件之前在文件上建立文件通道锁（并在获得锁后删除要覆盖的文件），您可能会获得一些牵引力。-r

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-02-20T11:32:53.990

我用一个简单的重命名函数来解决。

来电：

```
File newPath = new File("...");
newPath = checkName(newPath);
Files.copy(file.toPath(), newPath.toPath(), StandardCopyOption.REPLACE_EXISTING); 
```

checkName 函数检查是否退出。如果退出，则将两个括号 (1) 之间的数字连接到文件名的末尾。功能：

```
private static File checkName(File newPath) {
    if (Files.exists(newPath.toPath())) {

        String extractRegExSubStr = extractRegExSubStr(newPath.getName(), "\\([0-9]+\\)");
        if (extractRegExSubStr != null) {
            extractRegExSubStr = extractRegExSubStr.replaceAll("\\(|\\)", "");
            int parseInt = Integer.parseInt(extractRegExSubStr);
            int parseIntPLus = parseInt + 1;

            newPath = new File(newPath.getAbsolutePath().replace("(" + parseInt + ")", "(" + parseIntPLus + ")"));
            return checkName(newPath);
        } else {
            newPath = new File(newPath.getAbsolutePath().replace(".pdf", " (" + 1 + ").pdf"));
            return checkName(newPath);
        }

    }
    return newPath;

}

private static String extractRegExSubStr(String row, String patternStr) {
    Pattern pattern = Pattern.compile(patternStr);
    Matcher matcher = pattern.matcher(row);
    if (matcher.find()) {
        return matcher.group(0);
    }
    return null;
} 
```

**编辑：**它仅适用于 pdf。如果您想要其他，请替换 .pdf 或为其创建扩展参数。注意：如果文件在括号“（”之间包含额外的数字，那么它可能会弄乱您的文件名。

# .net - 如何在.net正则表达式中找到不在括号内的逗号？

> ID：595633
> 
> 赞同：1
> 
> 时间：2009-02-27T17:00:09.547
> 
> 标签：.net, regex

使用 .net 提供的一些扩展，可以通过使用以下内容找到括号组：

```
^(\w+)\(((?>[^()]+|\((?<D>)|\)(?<-D>))*(?(D)(?!)))\)(.*)$ 
```

这将匹配以下内容：

```
Func(innerfunction(arg)).DoSomething() 
```

与以下组：

*   第一组：功能
*   第 2 组：内部函数（arg）
*   第 3 组：.DoSomething()

我的问题是，我如何匹配逗号，考虑到它们是否在括号组内？例如，要评估的正则表达式：

```
Func(innerFunction(arg1, arg2), arg3).DoSomething() 
```

应该产生：

*   第一组：功能
*   第 2 组：内部函数（arg1，arg2）
*   第 3 组：arg3
*   第 4 组：.DoSomething()

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T17:17:43.063

我想我找到了。有没有人有反例：

```
^([^()]*?|.*\((?>[^()]+|\((?<D>)|\)(?<-D>))*(?(D)(?!))\).*?),(.*)$ 
```

这将匹配这个表达式：

```
func1(arg2, func3(arg3, arg4)), func2(arg5, arg6).property 
```

作为：

*   组 1：func1（arg2，func3（arg3，arg4））
*   Group2: func2(arg5, arg6).property

此解决方案仅查找一个逗号，但它处理任意深度的括号。

**更新：**秋葵提供了一个反例：

```
func1((arg1), arg2), func2(arg3).property 
```

Get分为：

*   组1：func1（（arg1）
*   Group2: arg2), func2(arg3).property

**但是**：通过将第一个“任何匹配”变为非贪婪，可以解决它：

```
^([^()]*?|.*?\((?>[^()]+|\((?<D>)|\)(?<-D>))*(?(D)(?!))\).*?)\s*,\s*(.+)$ 
```

还有其他反例吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T17:17:47.307

虽然这并非不可能，但我建议不要为此使用正则表达式。

问题是表达式往往要么完全贪婪，要么完全不贪婪。例如，采用以下输入：

> (a,)b,(c,(d,)e,)

贪婪的表达式会尽可能匹配。它会将*所有内容都*视为括号内的内容，因此不返回*任何内容*。

一个不贪婪的表达式会正确匹配逗号 b，但它也会匹配逗号 e，因为它会`(c,(d,)`被视为一个完整的组。

现在，听起来您已经了解了这些问题，并且 .Net 正则表达式引擎确实有一个功能可以让您在某种程度上克服这些问题。但是结果表达式会很丑陋，难以维护，移植性不强，而且容易出错。除非您真的知道自己在做什么，否则最好寻找另一种解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T17:23:56.340

如果不想限制嵌套深度，单独使用正则表达式是不可能的。

因此，我建议您构建一个分解嵌套级别的解析器。逐个字符读取输入的字符。当它是“<code>(”时增加级别，当它是“<code>)”时降低级别，当它是“<code>”时，拆分。

# c# - VS2005：如何自动生成带日期的内部版本号？

> ID：595640
> 
> 赞同：3
> 
> 时间：2009-02-27T17:02:04.643
> 
> 标签：c#, .net, msbuild, build-process, versioning

我在 Visual Studio 2005 中有一个 .net 2.0 C# 应用程序，我想为其自动生成正确的版本构建号，该版本号应该包含一个数字，让我可以猜测应用程序的构建日期。
我尝试使用 Microsoft 的[“AssemblyInfo Task”](http://code.msdn.microsoft.com/AssemblyInfoTaskvers)工具，但默认情况下该工具不起作用。对于今天，它将生成一个内部版本号“090227”，该版本号超过了最大值 65535，因此会产生错误。

我也可以使用包含年份和日期的内部版本号，例如 09001 表示 2009 年 1 月 1 日......
你知道这个问题的任何解决方案吗？
我是否必须更新此“AssemblyInfo 任务”的源代码，或者这是否可以在 VS2008 左右实现？
谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T17:08:29.247

您需要查看[msbuildtasks](http://msbuildtasks.tigris.org/)。它是一组开源的 msbuild 任务。该模块的任务是增加/修改/等构建号。它也超级容易使用和超级容易扩展。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-08T12:17:50.103

VS/C#/msbuild 生成的默认自动构建号是自 1.1.2000 以来的天数，发布号是自午夜以来的两秒增量数，因此您可以像这样向后计算构建的日期和时间：

```
new DateTime(2000, 1, 1).AddDays(assemblyName.Version.Build).AddSeconds(assemblyName.Version.Revision*2) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-03-04T09:26:46.273

[msbuildtasks](http://msbuildtasks.tigris.org/)没有解决我的问题。正如描述中所解释的，我需要一种特殊的格式。msbuildtasks 的文档也很好……去找吧。
我已经修改了[AssemblyInfo 任务](http://code.msdn.microsoft.com/AssemblyInfoTaskvers)的源代码，根据我的需要添加了一个新的增量类型“YearAndDay”：

```
case IncrementMethod.YearAndDay:
{
    DateTime dDate = DateTime.Now;
    long buildNumber = dDate.Year % 2000 * 1000;
    buildNumber += dDate.DayOfYear;
    string newVersionNumber = buildNumber.ToString();
    Log.LogMessage(MessageImportance.Low, logMessage, newVersionNumber);
    return newVersionNumber;
} 
```

似乎是最简单的解决方案。

# sql - 如何在 SQL 中首先使用 FULLTEXT 显示相关记录？

> ID：595644
> 
> 赞同：0
> 
> 时间：2009-02-27T17:03:42.113
> 
> 标签：sql, sql-server, sql-server-2005, full-text-search

我正在使用`FULLTEXT`我的 sql 查询来搜索记录。

```
 SELECT * FROM (SELECT d.DataId, (SELECT [Name] FROM Category WHERE CategoryId = d.CategoryId) AS 'Category', d.Description, d.CompanyName, d.City, d.CategoryId,
                d.CreatedOn, d.Rank, d.voteCount, d.commentCount, d.viewCount
        FROM Data d 
                INNER JOIN Keyword k
                    ON d.DataId = k.DataId
        WHERE FREETEXT(k.Keyword, @SearchQ) AND d.CategoryId=@CategoryId AND d.IsSearch=1 AND d.IsApproved=1 
```

当我搜索**rockstone hotel**时，我的表中有一条同名的记录，但它首先显示一些其他记录，然后在 3 位置显示“rockstone hotel's”记录。为什么会发生这种情况以及改善这种情况的方法是什么？？？

我正在使用 SQL Server 2005

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T17:07:40.277

您没有 Order By 子句，它可以释放数据库以任何顺序返回记录。通常它是在处理 where 子句时遇到它们的顺序，因此很容易相信数据库使用的是“自然”顺序。如果您想要一个*特定*的订单，您需要添加一个 Order By 子句，该子句将使用您创建的某些评分方法，或者您必须在接收记录的程序中对它们进行排序。

（我不得不猜测您要提取的其他记录也包含搜索条件，只是在文本字段中更远。）

有关使用 Rank 对记录进行排序的示例，请参见此处：[SQL Server 自由文本匹配 - 如何按相关性排序](https://stackoverflow.com/questions/53538/mssql-freetext-match-how-do-i-sort-by-relevance) Rank 列由文本匹配调用生成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T17:09:43.127

引用自 MSDN（SQL Server 开发人员中心）：

> 与在其中 AND 是关键字的 CONTAINS 搜索条件中不同，在 freetext_string 中使用时，单词“and”被视为干扰词，将被丢弃。

[http://msdn.microsoft.com/en-us/library/ms176078(SQL.90).aspx#](http://msdn.microsoft.com/en-us/library/ms176078(SQL.90).aspx#)

# loops - 哪个是更好的做法 - 带中断或条件循环的 for 循环？

> ID：595646
> 
> 赞同：27
> 
> 时间：2009-02-27T17:03:59.383
> 
> 标签：loops, for-loop, while-loop, language-agnostic

我只是好奇人们对这个话题的看法。假设我有一个对象数组，我想遍历它们以查看对象是否包含某些值，如果是，我想停止循环。哪个是更好的做法 - 带中断的 for 循环或条件循环？

我提供的示例中的伪代码仅用于论证（它也在 ActionScript 中，因为这是我最近的主要语言）。另外，我不是在寻找有关语法的最佳实践想法。

带中断的 for 循环：

```
var i:int;

var isBaxterInMilwaukee:Boolean;    

for (i = 0; i < arrayLen; i++)
{
    if (myArray[i]["name"] == "baxter"
         && myArray[i]["location"] == "milwaukee")
    {
        isBaxterInMilwaukee = true;

        barkTwice();

        break;
    }
} 
```

条件循环：

```
var i:int;

var isBaxterInMilwaukee:Boolean;    

while (!isBaxterInMilwaukee && i < arrayLen)
{
    if (myArray[i]["name"] == "baxter"
         && myArray[i]["location"] == "milwaukee")
    {
        isBaxterInMilwaukee = true;

        barkTwice();
    }

    i++;
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-27T17:18:45.883

**简而言之，您应该选择最容易阅读和维护的版本。**

在稍早的时候，我知道打破循环被认为是一个禁忌（与 goto 语句相提并论）。循环应该在循环条件下中断，而不是在其他任何地方。因此，while 循环将是要走的路。

（这可能是汇编的保留，其中循环基本上是一个代码块，最后有一个 go-to-the-beginning-if-true 跳转语句。块中的多个条件跳转语句使其非常难以调试; 因此，它们将被避免并在最后合二为一。）

我觉得这个想法今天似乎发生了一些变化，尤其是对于 foreach 循环和托管世界；现在真的是风格问题。Break-on-found for 循环可能已经为许多人所接受，当然除了一些纯粹主义者。请注意，我仍然会避免在 while 循环中使用 break，因为这会混淆循环条件并使其混乱。

如果您允许我使用 foreach 循环，我认为下面的代码比它的 while-loop 兄弟*更*容易阅读：

```
bool isBaxterInMilwaukee;    

foreach (var item in myArray)
{
    if (item.name == "baxter" && item.location == "milwaukee")
    {
        isBaxterInMilwaukee = true;    
        barkTwice();
        break;
    }
} 
```

但是，随着逻辑变得越来越复杂，您可能需要考虑在`break`语句附近添加一个突出的注释，以免它被埋没并且难以找到。

* * *

**可以说，这整个事情应该被重构为它自己的函数**，它没有`break`找到，但实际上`return`是结果（随意使用 for 循环版本）：

```
bool isBaxterInMilwaukee(Array myArray)
{      
    foreach (var item in myArray)
    {
        if (item.name == "baxter" && item.location == "milwaukee")
        {
            barkTwice();
            return true;
        }
    }
    return false;
} 
```

正如 Esko Luontola 指出的那样，最好将调用移到`barkTwice()`此函数之外，因为从函数名称中看不出副作用，也与在每种情况下都找不到 Baxter 相关。（或者添加一个布尔参数`BarkTwiceIfFound`并将行更改为 read`if(BarkTwiceIfFound) barkTwice();`以使副作用清晰。）

* * *

作为记录，您也可以在 for 循环中不中断地进行标志检查，但我觉得这实际上会损害可读性，因为您不希望在 for 循环定义中出现额外的条件：

```
var i:int;

var isBaxterInMilwaukee:Boolean;    

for (i = 0; !isBaxterInMilwaukee && i < arrayLen; i++)
{
    if (myArray[i]["name"] == "baxter"
         && myArray[i]["location"] == "milwaukee")
    {
        isBaxterInMilwaukee = true;    
        barkTwice();
    }
} 
```

您还可以使用 while 循环模拟自动递增机制。我不喜欢这个有几个原因 - 你必须初始化`i`为比你的实际起始值小一，并且取决于你的编译器如何短路循环条件逻辑，你`i`退出循环的值可能会有所不同。尽管如此，这是可能的，对于某些人来说，这可以提高可读性：

```
var i:int = -1;

var isBaxterInMilwaukee:Boolean;    

while (!isBaxterInMilwaukee && ++i < arrayLen)
{
    if (myArray[i]["name"] == "baxter"
         && myArray[i]["location"] == "milwaukee")
    {
        isBaxterInMilwaukee = true;
        barkTwice();
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-27T17:09:00.260

我一直不喜欢`breaks`在代码中使用...在这种情况下，它似乎无关紧要，但在更多涉及的循环中，它可能会让另一个阅读它的编码人员感到非常困惑。一般来说，它经常导致不理解循环如何终止，直到编码人员发现`break`循环深处的嵌套。通过指定检查循环的每次迭代的标志条件，它使这一点更加清晰。

这个问题类似于`return`在不容易被发现的方法主体中的语句（而不是设置`retVal`变量并在方法结束时返回）。用一个小方法，这似乎很好，但它越大，就越混乱。

这不是操作效率的事情，而是可维护性的事情。

询问你的同事在特定情况下什么是可读和可理解的……这才是真正重要的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-27T17:08:44.957

我会说这取决于。在这种情况下，带中断的循环对我来说似乎更清楚。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-27T17:16:37.963

在 for 循环中，您还可以通过将提前退出条件放入 for 循环声明中来提前退出。因此，对于您的示例，您可以这样做：

```
var i:int;

var isBaxterInMilwaukee:Boolean;    

isBaxterInMilwaukee = false;

for (i = 0; i < arrayLen && !isBaxterInMilwaukee; i++)
{
    if (myArray[i]["name"] == "baxter"
        && myArray[i]["location"] == "milwaukee")
    {
        isBaxterInMilwaukee = true;

        barkTwice();
    }
} 
```

这样你就不需要休息了，而且它仍然比 while 循环更具可读性。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-27T17:57:08.693

两者之间存在概念上的差异。`for`循环用于迭代离散集，`while`循环用于基于条件重复语句。其他语言添加`finally`子句和循环结构，如`foreach`or `until`。`for`它们的传统循环往往要少得多。

无论如何，我使用的规则是`for`循环迭代和`while`循环重复。如果你看到类似的东西：

```
while (counter <= end) {
   // do really cool stuff
   ++counter;
} 
```

那么你可能会更好地使用`for`循环，因为你正在迭代。但是，循环如下：

```
for (int tryCount=0; tryCount<2; ++tryCount) {
    if (someOperation() == SUCCESS) {
       break;
    }
} 
```

应该写成`while`循环，因为它们确实在重复某些事情，直到条件为真。

不使用的想法，`break`因为它*和邪恶一样`goto`*非常荒谬。那你怎么能证明抛出异常是合理的呢？这只是一个非本地和非确定性的 goto！顺便说一句，这不是对异常处理的咆哮，只是一个观察。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-27T17:12:22.763

最有意义的那个将是最能将这个想法传达给阅读代码的人的那个。*首先*记住代码的可读性，你通常会做出正确的选择。通常，除非你真的需要，否则你不想使用类似的东西`break`，因为如果经常这样做，甚至只是在一组深度嵌套的表达式中，它会使事情变得难以理解。 `continue`有时可以起到与中断相同的作用，然后循环将正常退出，而不是因为它被打破了。在这种情况下，我可以用几种不同的方式来写这个。

可能你想要的最好的事情是修改你的`while`循环：

```
while(!isBaxterInMilwaukee || i < arrayLen) {
  if(myArray[i]["name"] == "baxter" && myArray[i]["location"] == "milwaukee") {
    isBaxterInMilwaukee == true;
    barkTwice()
  } else {
    i++;
  }
} 
```

这很清楚并且不使用`break`or `continue`，因此您一眼就能看出您将始终由于`while`表达式中指定的条件之一而终止。

**ETA**：可能应该`i < arrayLen`在`while`循环中，否则它第一次失败，除非输入值与目标值相同......

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-27T17:14:10.480

我看到两个循环都有中断，对吗？

反正：

*   当循环开始之前有已知次数（最大次数）的迭代时，我会选择 FOR 循环。
*   否则我会选择 WHILE。
*   在 FOR 循环中，我自由地使用 BREAK。
*   在 WHILE 循环中，我更喜欢使用复杂条件而不是 BREAK（如果可能的话）。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-27T17:12:52.887

我会说break，更清楚（即使你写了为什么你跳出循环的评论）恕我直言while循环不清楚，我会去休息

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-27T17:37:18.227

我肯定会选择 for+break。'for' 是“迭代序列”的一个立即可识别的习语，并且更容易理解“迭代序列；如果找到值，则提前结束”而不是组合的循环和停止条件。

您似乎在条件循环代码中犯了两个错误的方式可能有证据表明这一点！

*   while 条件 (!isBaxterInMilwaukee || i == arrayLen) — 你的意思是“(!(isBaxterInMilwaukee || i == arrayLen))”吗？

*   如果您使用终止循环变量，则不需要 break 语句。

就我个人而言，我发现一个简单的“中断”比尝试跟踪终止循环变量更容易阅读。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-27T20:07:59.127

问题有两个方面：

*   **做什么**（例如：查找其中一项是否包含位置中的指定人员）
*   **怎么**做（例如：使用索引、迭代等）

这两个示例都将两者混合在一起，很难从*how中理解**what*。如果我们只能在代码中表达*what*部分，那将是最好的。这是一个使用[规范](http://www.dependnet.ro/Blog/post/2008/07/30/The-Specification-Pattern-and-c-35.aspx)模式执行此操作的示例（c# 3.5）

 **```
// what we are looking for?
IsPersonInLocation condition = new IsPersonInLocation("baxter", "milwaukee");

// does the array contain what we are looking for?
bool found = myArray.Find(item => condition.IsSatifiedBy(item));

// do something if the condition is satisfied
if (found) {
    barkTwice();
} 
```

为了完整起见，这里是条件的类定义：

```
class IsPersonInLocation {
    public string Person { get; set; }
    public string Location { get; set; }
    public IsPersonInLocation(string person, string location) {
        this.Person = person;
        this.Location = location;
    }
    bool IsSatifiedBy(item) {
        return item["name"] == this.Person
            && item["location"] == this.Location;
    }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-27T17:24:51.860

这在很大程度上取决于具体情况。但是在您的示例中，您想要遍历一个有界长度的数组，并且使用 for 循环可以很容易地做到这一点并防止跑到最后。在您的 while 循环示例中，您必须自己进行递增（如果您想使用`continue`语句跳到下一个循环，这可能会出现问题）并制作更复杂的条件表达式（顺便说一下，它有一个错误; 我想你的意思是`&& i != arrayLen`）。您只需要执行额外的代码来完成 for 循环帮助提供的效果。

当然，一些纯粹主义者会争辩说`break`，`continue`不应该使用，如果需要，您应该使用 if-else 和布尔变量，而不是继续或跳出循环。但我认为这会使循环看起来更难看，特别是如果它相对较短且通常像这个例子一样容易掌握。对于具有更长代码的循环，其中中断或继续很容易隐藏而不会引起注意，纯粹的方法可能更清楚，因为在这种情况下，循环已经很难掌握。但是您始终可以将其作为 for 循环的一部分执行，只需将其添加为条件的一部分。

更好的做法是测试绑定的数组`i < arrayLen`而不是完全相等，以防万一导致`i`跳过确切的值（我实际上在 Y2K 错误中看到了这种情况，更好的做法可以避免这种情况）。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-27T17:24:53.683

我有 C++ 背景，所以我仍然有尝试“像编译器一样思考”的时候。While 循环往往会导致代码更紧凑，因此只有在您知道每次都要迭代数组中的每个元素时才考虑使用 for 循环。

编辑：我现在认为这是矫枉过正，如果你正在使用 .Net 或任何你不打算用几个紧密循环来弥补 VM 开销的东西。我确实认为记住某些做法的“原因”是一件好事。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-02-27T17:34:27.407

我的理论是，有一个有用的编程抽象类似于“信噪比”，即“问题与工具的比率”——可以通过我花多少时间思考问题和它的解决方案，与我花时间思考如何使用该工具（在本例中为语言语法）相比。

通过这种方式，我尝试更频繁地使用更少的结构，因为我（以及希望跟随的人）可以更快、更准确地理解我的代码结构的本质。而且由于“for 循环”的变体很好地涵盖了可能使用其他循环的情况（没有失真），所以当它们可以互换时，我将它们作为首选。

并且很高兴在“for”循环顶部的一行中包含您需要了解（grokwise）的有关循环规则的所有内容。出于同样的原因，我也倾向于将“默认”开关放在测试的首位。

但一致性和清晰度是最重要的考虑因素。YMMV，当然。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-28T11:54:49.290

我想两者实际上都不是很有趣。如果您追求的是可读性，您应该寻找更高级别的结构。

在 JS 中：

```
if(myArray.some(function(o) { o.name == "baxter" && o.location == "milwaukee" }))
  barkTwice(); 
```

或使用您自己的一些实用程序

```
if(myArray.containsMatch({name:"baxter",location:"milwaukee"})
  barkTwice(); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-03-03T00:43:56.100

将循环封装在自己的方法中，并在匹配条件成功时使用返回到结束处理。

一些示例 C# 代码：

```
class Program
{
   static bool IsBaxterInMilwaukee(IList<WhoAndWhere> peopleAndPlaces)
   {
      foreach (WhoAndWhere personAndPlace in peopleAndPlaces)
      {
         if (personAndPlace.Name == "Baxter" 
            && personAndPlace.Location == "Milwaukee")
         {
            return true;
         }
      }
      return false;
   }

   static void Main(string[] args)
   {
      List<WhoAndWhere> somePeopleAndPlaces = new List<WhoAndWhere>();
      somePeopleAndPlaces.Add(new WhoAndWhere("Fred", "Vancouver"));
      somePeopleAndPlaces.Add(new WhoAndWhere("Baxter", "Milwaukee"));
      somePeopleAndPlaces.Add(new WhoAndWhere("George", "London"));

      if (IsBaxterInMilwaukee(somePeopleAndPlaces))
      {
         // BarkTwice()
         Console.WriteLine("Bark twice");
      }
   }

   public class WhoAndWhere
   {
      public WhoAndWhere(string name, string location)
      {
         this.Name = name;
         this.Location = location;
      }

      public string Name { get; private set; }
      public string Location { get; private set; }
   }

} 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-02-27T22:15:54.640

我的总体立场是：

如果它有一个循环计数器，请使用 for() （就像 while while 循环一样）。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-02-27T22:22:59.193

我投票`while`是因为休息会降低可理解性。

如果循环变得太长并且您插入您希望运行的代码但它没有运行，您可能没有意识到循环包含中断。

但我订阅了不要让我思考编码模型。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-04-24T12:36:02.043

在 ES6 中，它已经变得非常简单，不需要使用 break 关键字，我们可以使用 find 函数，一旦条件满足，我们就可以返回 true。

```
let barkTwice = () => {
    console.log('bark twice');
}

let arr = [{
        location: "waukee",
        name: "ter"
    }, {
        location: "milwaukee",
        name: "baxter"
    },
    {
        location: "sample",
        name: "sampename"
    }
]; 
```

在这里，我们匹配条件，一旦条件匹配，我们就根据问题调用函数，然后我们返回 true。这样它就不会超越。

```
arr.find(item => {
    if (item.location == "milwaukee" && item.name == "baxter") {
        barkTwice();
        return true
    }
}); 
```

# wpf - DataTemplate 数据触发器仅从第二次开始工作

> ID：595659
> 
> 赞同：2
> 
> 时间：2009-02-27T17:06:33.213
> 
> 标签：wpf, datatrigger

我有以下 XAML：

```
<Grid x:Name="root">
   <Grid.RowDefinitions>
    <RowDefinition Height="*"/>
    <RowDefinition Height="Auto"/>
 </Grid.RowDefinitions>
<Grid.Resources>
  <DataTemplate DataType="{x:Type ViewModels:TemplateViewModel}">
    <ContentControl Content="{Binding}" Grid.Row="0" x:Name="ct">
      <ContentControl.ContentTemplate>
        <DataTemplate>
          <TextBlock Text="Loaded" />
         </DataTemplate>
      </ContentControl.ContentTemplate>
    </ContentControl>
    <DataTemplate.Triggers>
      <DataTrigger Binding="{Binding DataContext.State, 
           RelativeSource={RelativeSource AncestorType={x:Type Window}}}" Value="2">
        <Setter Property="ContentTemplate" TargetName="ct">
          <Setter.Value>
            <DataTemplate>
              <TextBlock Text="Loading, please wait"  Foreground="Red"/>
            </DataTemplate>
          </Setter.Value>
        </Setter>
      </DataTrigger>
    </DataTemplate.Triggers>
  </DataTemplate>
</Grid.Resources>
<ContentControl Content="{Binding MainContent}" /> 
```

该 XAML 位于 Window 元素内。我将 Window 绑定到具有两个属性 State 和 MainContent 的 ViewModel 对象：

```
public class ViewModel : INotifyPropertyChanged {
   public int State {...} // this can be only 1 or 2, for simplicity
   public TemplateViewModel MainContent { ... } 
} 
```

我相应地从属性设置器中引发 PropertyChanged 事件。

现在，我使用一个按钮从磁盘加载文件，对其进行解析并创建一个对象以分配给 MainContent 属性。在解析之前，我将 State 属性设置为 2（正在加载），在分配之后我将属性重置为 1（已加载）。

第一次解析文件，数据模板中的触发器不起作用（注意触发器绑定到父Window的Data Context的State属性，即ViewModel对象）。但第二次，确实如此！

有人可以指出错误在哪里吗？

恐怕我无法在此处发布代码，但如果您有答案并给我发电子邮件，可以分享它..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T17:16:11.210

您`DataTemplate`应用于 type`TemplateViewModel`而不是`ViewModel`. `MainContent`因此，在设置属性之前它不会适用于任何东西。

# model-view-controller - MVC 通常每个视图都有一个单独的控制器吗？

> ID：595661
> 
> 赞同：0
> 
> 时间：2009-02-27T17:07:06.877
> 
> 标签：model-view-controller

到目前为止，我只是在浏览 MVC 示例，我想我已经掌握了它。对于我的项目——ARM9 上的嵌入式系统，根本没有 Windows/ASP——我们正在考虑将所有 UI 作为 MVC。MVC 是否还需要所有 UI 视图的严格树（一个根？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T17:09:43.393

不，一个控制器可能对不同的操作有不同的视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T17:15:16.797

您可以将控制器拆分为一个前端控制器和多个操作。作为参考，请参阅在Symfony 框架中实现[的 MVC 模式。](http://www.symfony-project.org/book/1_0/02-Exploring-Symfony-s-Code)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T17:16:09.120

如果您的视图是整个页面的一部分，您还可以使用来自不同控制器的相同视图。即页眉和页脚。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-30T23:26:31.267

一个控制器可以有许多视图和部分视图。如果你看看一些简单的 ASP .NET MVC 教程：[http ://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/intro-to-aspnet-mvc- 4](http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/intro-to-aspnet-mvc-4)您将了解如何轻松做到这一点。

# perl - 如何根据导入类的名称轻松生成 Perl 函数？

> ID：595662
> 
> 赞同：0
> 
> 时间：2009-02-27T17:07:22.977
> 
> 标签：perl, export, generator

我想导出一个函数，该函数取决于导出到的类的名称。我认为这应该很容易，[`Sub::Exporter`](http://search.cpan.org/perldoc?Sub::Exporter)但不幸的是，`into`密钥没有传递给生成器。我最终得到了那些丑陋的示例代码：

```
use strict;
use warnings;

package MyLog;

use Log::Log4perl qw(:easy get_logger);

use Sub::Exporter -setup => {
    exports => [
        log       => \&gen_log,
        audit_log => \&gen_log,
    ],
    groups     => [ default => [qw(log audit_log)] ],
    collectors => ['category'],
    installer  => \&installer, # tunnel `into` value into generators
};

if ( not Log::Log4perl->initialized() ) {

    #easy init if not initialised
    Log::Log4perl->easy_init($ERROR);
}

sub gen_log {
    my ( $class, $name, $arg, $global ) = @_;

    my $category = $arg->{category};
    $category = $global->{category}{$name} unless defined $category;

    return sub {    # return generator
        my $into = shift;    # class name passed by `installer`

    $category = $name eq 'audit_log' ? "audit_log.$into" : $into
        if !defined $category;    # set default category

        # lazy logger
        my $logger;
        return sub {
            $logger or $logger = get_logger($category);
        };
    };
}

sub installer {
    my ( $args, $todo ) = @_;

    # each even value is still generator thus generate final function
    my $i;
    1 & $i++ and $_ = $_->( $args->{into} ) for @$todo;

    Sub::Exporter::default_installer(@_);
}

1; 
```

有没有更好的方法可以在不牺牲所有这些丰富`Sub::Exporter`能力的情况下做到这一点？

例如，我想使用其中之一：

```
use MyLog category => { log => 'foo', audit_log => 'bar' };

use MyLog -default => { -prefix => 'my_' };

use MyLog
    audit_log => { -as => 'audit' },
    log       => { -as => 'my_log', category => 'my.log' }; 
```

**编辑**：增加`Sub::Exporter`了对问题的能力要求。

**Edit2**：添加了使用示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T18:48:53.887

您不清楚要如何确定名称。如果我理解正确，这就是你想要的。

```
my %sub_for = (
    foo => \&foo,
    #...
);

sub install_as {
    my ($package, $exported_name, $sub) = @_;
    no strict 'refs';
    *{"$package\::$exported_name"} = $sub;
    return;
}

sub get_name_for {
    my ($package, $name) = @_;
    #... your code here
}

sub import {
    my $class = shift;
    my $package = caller;
    for my $internal_name (@_) {
        install_as($package, get_name_for($package, $internal_name), $get_sub_for{$name});
    }
    return;
} 
```

# c# - Ajax 水印扩展器

> ID：595679
> 
> 赞同：0
> 
> 时间：2009-02-27T17:10:12.457
> 
> 标签：c#, ajax

每当我尝试在 WaterMark Extender（位于控件上）上动态设置文本时，我都会收到一条错误消息，指出**TextBoxWatermarkExtendor 缺少 textboxWatermarkExtender1 所需的 watermarktext 属性值**。问题是我有时只会在某些计算机上收到此错误。这似乎是一个加载问题，而不是特定于浏览器的问题。有谁知道我在哪里可以获得更多关于此的信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-06-04T02:39:47.477

您可能实际上并未为扩展器设置 watermarktext 的属性。

看看@这个

```
<asp:TextBox ID="txtWatermark" runat="server" Width="200px"></asp:TextBox>

 <cc1:TextBoxWatermarkExtender ID="txtWatermark_TextBoxWatermarkExtender" runat="server"

  Enabled="True" TargetControlID="txtWatermark" WatermarkText="Type Your Search Here">

 </cc1:TextBoxWatermarkExtender> 
```

但奇怪的是它只适用于某些计算机。确保在浏览器中打开了 Javascript。

[这个网站](http://www.dotnetspark.com/kb/1717-ajax-extenders-for-textbox-tutorial.aspx)有一个关于水印文本框的很棒的教程 + 更多:)

# java - 使用 iText 在 PDF 中不显示条码

> ID：595684
> 
> 赞同：2
> 
> 时间：2009-02-27T17:12:19.707
> 
> 标签：java, pdf, itext, barcode

我正在使用 iText 动态生成 PDF 文档。现在我正在尝试在此 PDF 中动态创建条形码。Adobe Live Cycle 内置了条码功能。您只需拖动页面上的条形码文本框即可创建。

**问题：**
我在 PDF 中放置了条形码字段。然后从 JSP 页面向条形码字段传递一个数字。但只有数字出现。条码线从不显示

数字 20099002 在 PDF 文档中可见，但条码线未显示。我在 LiveCycle 中尝试了其他几个条形码选项，但都给出了相同的结果。

```
 OurJavaPage.java 
    public class ExampleForm extends BaseOutput { 
    private static final Log LOG = LogFactory.getLog(ExampleForm.class); 
    public OutputStream generate() throws IOException, DocumentException { 
        ByteArrayOutputStream baos = new ByteArrayOutputStream(); 
        PdfReader reader; 
        reader = new PdfReader(BASEDIR + "MailingExample.pdf"); 

        PdfStamper stamper = new PdfStamper(reader, baos); 
        Participant participantHome = home.getParticipant(); 
        Set<Location> homeLocs = participantHome.getLocations(); 

        final AcroFields form = stamper.getAcroFields(); 

        setFormField(form, "addrNumber[0]", addrMaster.getStreetNum()); 
        setFormField(form, "dateMiddle[0]", formatDate("MM-dd-yyyy", new Date())); 

// *********** Here's the problem *****************************
        setFormField(form, "Code128ABarcode1[0]", "20099002");
// ************************************************************

        debugAcrobatForm("ExampleForm", form); 
        stamper.setFormFlattening(true); 
        stamper.close(); 

        return baos; 
    } 
} 
```

**操作系统：** Linux
**编程：** Java、.jsp、iText
**软件：** Adobe Live Cycle Designer ES 8.1

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-04T21:00:33.750

问题解决了！！！

我联系了 iText，他们建议我更改此行。

**来自：** stamper.setFormFlatening(true);
**到：** stamper.setFormFlatening(false);

有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T17:25:42.810

您的软件是将条形码嵌入为图形还是字符的字体表示？

如果是后者，是否将字体嵌入到 PDF 中？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-15T17:05:32.647

它对我来说很好用..可能与您在生命周期设计器中制作模板的方式（静态或动态）有关...

在此处查看示例 [http://1t3xt.info/examples/browse/?page=example&id=433](http://1t3xt.info/examples/browse/?page=example&id=433)

问候 Raghavendra Samant

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-28T09:18:46.230

你问过非常活跃的 IText 邮件列表吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-04T14:11:52.877

如果这是使用 LiveCycle 创建的动态 XFA 表单，那么使用表单展平将导致您丢失表单字段。静态 XFA 表单应该可以工作。

参考： http: [//itext.ugent.be/library/question.php ?id=30](http://itext.ugent.be/library/question.php?id=30)

iText 中的 XFA 支持正在改进，但充其量只是参差不齐。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-08-13T12:16:14.037

您必须在您的系统（字体库）中添加条形码字体，然后它将在您的字体下拉列表中可见。使用 acro-field（文本）并在此 acro-field 中设置该字体。你的问题将得到解决。另外，使用 setformflattening=true 因为它会使 pdf 不可编辑

# asp.net-mvc - 元素“标题”出现次数太少，ASP.NET.MVC 母版页中的 XHTML 验证警告

> ID：595692
> 
> 赞同：6
> 
> 时间：2009-02-27T17:13:43.617
> 
> 标签：asp.net-mvc

我在 ASP.NET MVC 母版页中收到以下 XHTML 验证警告：

*验证（XHTML 1.0 过渡）：元素“标题”出现的次数太少。*

母版页的标题标记包含在 head 标记的 ContentPlaceHolder 中，如下面的代码所示。执行验证时不考虑 ContentPlaceHolder 中的标题标签，我不想在 head 标签中添加另一个标签，因为那样我将留下两个标题标签。

```
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <asp:ContentPlaceHolder ID="head" runat="server">
        <title></title>
    </asp:ContentPlaceHolder>
</head> 
```

我发现的一种解决方法是在 head 标签中使用以下技术：

```
<% if (false) { %>
    <title></title>
<% } %> 
```

这是解决此警告的最佳做法吗？我不喜欢添加多余的代码来传递验证警告，但如果没有更好的选择，我会接受它。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-27T17:15:54.313

改为这样做：

```
<head>
    <title><asp:ContentPlaceHolder ID="title" runat="server">Default Page Title Here</asp:ContentPlaceHolder></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <asp:ContentPlaceHolder ID="head" runat="server"></asp:ContentPlaceHolder>
</head> 
```

或者作为替代方案，从每一页以编程方式设置标题。

在您的情况下发生的情况是，当创建新视图时，它会创建空内容项，这些内容项会覆盖占位符中的默认内容。如果您从视图中删除空内容块，将使用默认占位符内容，但您无法从视图中设置内容。使用上面的代码，您可以覆盖每个视图的默认标题，并在头部相互独立地包含脚本等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-06T15:16:29.557

这里可能的解决方案是第一个解决方案是

```
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<asp:ContentPlaceHolder ID="head" runat="server">
    //<title></title> - this line should be removed.
</asp:ContentPlaceHolder> 
```

第二种解决方案是，检查**head**标签是否具有属性**runat="server"**，如果没有设置runat prperty，则表示没有问题，否则需要**删除runat标签**。

# dts - DTS 为另一个步骤中的一个步骤设置 SQL 语句

> ID：595699
> 
> 赞同：2
> 
> 时间：2009-02-27T17:15:49.867
> 
> 标签：dts

因为我似乎无法使用？在我们正在执行的更复杂的 SQL 语句中，我们在某处读到，您可以设置上一步来为您设置 SQL。这是一个 ActiveX 步骤，它设置步骤 SQL 语句并替换为全局变量。

所以 SQL 步骤中有 SELECT 0 ，它之前的步骤本质上是一个 VB 脚本，如下所示

' 205（更改 SourceSQLStatement）选项显式

函数 Main() Dim oPkg、oDataPump、sSQLStatement

```
' Build new SQL Statement
sSQLStatement = "IF (SELECT 1 FROM TABLE fm WHERE NOT EXISTS ("&_
            "SELECT HighestVersionReceived "&_
            "FROM FILE_CURRENT fc "&_
            "WHERE fc.COL = fm.COL "&_
            "AND fc.HighestVersionReceived < fm.FileVersion) "&_
            "AND [FileName] = '" & DTSGlobalVariables("GLBFileName").Value & "') = 1 "&_
            "SELECT 1 AS VALID "&_
            "ELSE "&_
            "SELECT 0 AS VALID"

' Get reference to the DataPump Task
Set oPkg = DTSGlobalVariables.Parent
Set oDataPump = oPkg.Tasks("DTSStep_DTSExecuteSQLTask_34").CustomTask

' Assign SQL Statement to Source of DataPump
oDataPump.SourceSQLStatement = sSQLStatement

' Clean Up
Set oDataPump = Nothing
Set oPkg = Nothing

Main = DTSTaskExecResult_Success 
```

结束功能

但是它声明它找不到具有此名称的任务，它确实存在。如果我们将其更改为 Steps 而不是 Tasks，则可以找到它，但 Step 没有 SourceSQLStatement 属性。

所以我超出了我的深度。有任何想法吗？

可能更改运行 SQL 的步骤类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-10T13:10:40.707

您是否尝试过将复杂的 TSQL 语句更改为存储过程？

然后，您可以在 FileName 的存储过程中有一个输入参数。此存储过程可用作数据泵任务的源，参数在运行时由“？”分配 DTS 全局变量的值。你提到的语法。

# wpf - 我可以让两个 ContentPresenter 指向 ContentTemplate 中的单个 Content 或 ContentSource 吗？

> ID：595701
> 
> 赞同：2
> 
> 时间：2009-02-27T17:16:03.707
> 
> 标签：wpf, contentpresenter

我像 Outlook 2007 一样创建了 NavigationPane。在 Outlook 中，当窗格折叠并单击侧栏时，它会弹出 Selected NavigationItem 内容。我在 ControlTemplete 中使用 contentpresenter 模仿了相同的行为（一个用于 TabControl 的 SelectItemHost，另一个用于 Popup）。但问题是当弹出窗口打开时，NavigationPane 在离开时选择了内容，当我们从另一个导航项切换回同一个导航项时它会出现。我使用 TabControl 和 TabItem 作为 NavigationPane 和 NavigationPaneItem。

我将“SelectedContent”指向两个 ContentPresenter 的 ContentSource

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2011-05-13T13:12:38.523

您可以在控件模板中定义两个`ContentPresenter`对象，并将它们都指向同一内容源（如果您愿意）：

```
<ControlTemplate x:Key="WeirdButton" TargetType="Button">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <Border Grid.RowSpan="2" Background="{TemplateBinding Background}" />
        <ContentPresenter ContentSource="Content"/>
        <ContentPresenter ContentSource="Content" Grid.Row="1"/>
    </Grid>
</ControlTemplate> 
```

然而，这有一些相当不寻常的副作用。因为您不能将相同的视觉对象放在视觉对象树中的两个位置，所以该模板仅在按钮的子内容不是视觉对象（或从视觉对象派生）时才能按预期工作。如果内容是其他类型的数据，并且视觉效果是由数据模板生成的，那么一切都会按预期工作。将按钮的内容设置为字符串 ( `<Button Content="OK"/>`) 也可以。

请注意，可以使用视觉画笔来实现相同的效果：

```
<ControlTemplate x:Key="WeirdButton" TargetType="Button">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        <Border Grid.RowSpan="2" Background="{TemplateBinding Background}" />
        <ContentPresenter x:Name="presenter" ContentSource="Content"/>
        <Rectangle Grid.Row="1" 
                   Width="{Binding ActualWidth, ElementName=presenter}" Height="{Binding ActualHeight, ElementName=presenter}">
            <Rectangle.Fill>
                <VisualBrush Visual="{Binding ElementName=presenter}" Stretch="None" AlignmentX="Left"/>
            </Rectangle.Fill>
        </Rectangle>
    </Grid>
</ControlTemplate> 
```

这种方法的缺点是您无法与视觉画笔中的控件进行交互。因此，如果您希望副本上的按钮、文本框和其他控件也具有交互性，则必须采用更接近第一个模板的方法。

# algorithm - 对数组值求和，总和等于 X

> ID：595707
> 
> 赞同：-1
> 
> 时间：2009-02-27T17:17:18.103
> 
> 标签：algorithm, language-agnostic, sum

我有一个整数集合。我需要得到值总和等于 X 的所有可能性。

我需要这样的[东西](http://gofrom.us/FQ4)。

可以写成：delphi、c#、php、RoR、python、cobol、vb、vb.net

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T17:25:17.427

这是一个[子集和问题](http://en.wikipedia.org/wiki/Subset_sum_problem)。它是[NP-Complete](http://en.wikipedia.org/wiki/NP-complete)。

实现这一点的唯一方法是生成所有可能的组合并比较总和值。虽然存在优化技术。

这是 C# 中的一个：

```
static class Program
{
    static int TargetSum = 10;
    static int[] InputData = new[] { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };

    static void Main()
    {
        // find all permutations
        var permutations = Permute(InputData);

        // check each permutation for the sum
        foreach (var item in permutations) {

            if (item.Sum() == TargetSum) {

                Console.Write(string.Join(" + ", item.Select(n => n.ToString()).ToArray()));
                Console.Write(" = " + TargetSum.ToString());
                Console.WriteLine();

            }
        }

        Console.ReadKey();
    }

    static IEnumerable<int[]> Permute(int[] data) { return Permute(data, 0); }

    static IEnumerable<int[]> Permute(int[] data, int level)
    {
        // reached the edge yet? backtrack one step if so.
        if (level >= data.Length) yield break;

        // yield the first #level elements
        yield return data.Take(level + 1).ToArray();

        // permute the remaining elements
        for (int i = level + 1; i < data.Length; i++) {
            var temp = data[level];
            data[level] = data[i];
            data[i] = temp;

            foreach (var item in Permute(data, level + 1))
                yield return item;

            temp = data[i];
            data[i] = data[level];
            data[level] = temp;
        }

    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T18:06:18.077

[动态编程](http://en.wikipedia.org/wiki/Dynamic_programming)将为精确解决方案产生最佳运行时间。[Wikipedia 上的 Subset Sum Problem 页面](http://en.wikipedia.org/wiki/Subset_sum_problem#Pseudo-polynomial_time_dynamic_programming_solution)有一些算法的伪代码。本质上，您订购所有数字并将所有可能的序列相加，以便最大限度地减少加法的数量。运行时是伪多项式。

对于多项式算法，您可以使用[Approximation Algorithm](http://en.wikipedia.org/wiki/Approximation_algorithm)。伪代码也可在[子集求和问题页面上找到](http://en.wikipedia.org/wiki/Subset_sum_problem#Polynomial_time_approximate_algorithm)。

在这两种算法中，我会选择动态编程一种，因为它很简单，并且对大多数数据集都有很好的运行时间。

但是，如果整数都是非负数并且符合维基百科页面上的描述，那么您实际上可以使用近似算法在多项式时间内完成此操作。

# web-applications - 在 Web 应用程序中填写/保存表单时的可用性问题

> ID：595708
> 
> 赞同：2
> 
> 时间：2009-02-27T17:17:25.417
> 
> 标签：web-applications, usability

我开发了一个在抵押贷款公司内部使用的 Web 应用程序。我们一直遇到人们在与客户交谈时填写表格然后在点击保存之前点击离开屏幕的问题，从而丢失他们的数据（他们可以只点击返回，当然，但他们从未想过这一点）。

我们用户的第一个“解决方案”是要求我们在每次更改字段后自动保存数据。即使忽略明显的可扩展性问题，在我看来，这与地球上几乎所有其他 Web 应用程序的惯例完全背道而驰，其中您在提交表单时保存（总 Ajax 应用程序，如 GMail 不算，因为他们是一个完整的“另一种野兽”。我错了吗？或者（再次，忽略可扩展性）您认为这是一种合理的方法吗？

继续前进，我们的实际解决方案是弹出旧的“您确定要离开此页面浏览吗？” 当用户离开脏表单时的对话框。现在我们收到了有关对话结构方式的投诉。大多数应用程序都会说“您要保存更改吗”，因此点击“是”或“确定”是一个很好、安全的选择。但是对于导航离开对话框，点击 OK 是不安全的、不保存的选项。我们的用户当然不会阅读对话框，他们只是点击 OK，然后砰的一声，他们丢失了他们的更改。

我对更改此对话框犹豫不决，因为 (a) 该对话框是标准的，由浏览器生成，(b) 我什至不知道如何更改该对话框，以及 (c) 它已经存在数月了，人们（包括已经弄清楚的非白痴）将不得不重新学习他们的行为。

你认为这里最好的路线是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T17:23:08.417

如何保存该客户端，例如在 cookie 中并提供一个按钮，该按钮将使用最后保存的值填充表单？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T17:22:21.053

我会说使用 AJAX 自动保存表单 - 无论是在计时器上，还是在更改字段时。

您提到了该解决方案的可扩展性，但您还说它是一个内部应用程序，这让我认为在这种情况下可扩展性可能不会是那么大的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T17:25:12.780

为什么不看看 StackOverflow 在您开始回答问题但不提交然后尝试走开时所做的事情。我认为 UI 在这里完成的方式很好。

```
Are you sure you want to navigate away from this page?
You have started writing an answer.
Press OK to continue, or Cancel to stay on the current page. 
```

如果您的用户不阅读对话框弹出窗口并且他们说好的，我可能会考虑再次询问。

```
Your valuable edits will be LOST. 
Are you sure you want to navigate away from this page without saving?
Press OK to continue, or Cancel to stay on the current page. 
```

对于无法学习稍微新的工作方式的用户，恐怕我没有解决办法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T17:26:05.430

我会去保存任何元素的 onblur 或者如果整个表单被散焦（onblur）。您可以在卸载时弹出对话框以自动保存表单（甚至在显示对话框之前）。只需附加 onunload 事件即可保存它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T18:31:57.987

> 我对更改此对话框犹豫不决，因为 (a) 该对话框是标准的，由浏览器生成，(b) 我什至不知道如何更改对话框

(b) 事实上，你不能。

关于我能想到的缺少总 AJAX * 的唯一解决方法是使用 window.confirm() 进行 on[before]upload 提出自己的问题，如果按下 OK，则使用同步 XMLHttpRequest 推送数据以保存在从事件处理程序返回之前。

*：并不是说完全的 AJAX 是一个糟糕的方法，但要让整个应用程序以这种方式工作可能需要做很多工作。

# svn - 从 SVN 存储库中导出单个项目

> ID：595718
> 
> 赞同：1
> 
> 时间：2009-02-27T17:21:19.387
> 
> 标签：svn, migration, merge

我将多个项目存储在同一个 SVN 存储库下。我按照手册做了这个：我`svnadmin dump c:\repository | svndumpfilter include <my project> > myproject.dump`。

我的问题是，svndumpfilter 因错误“复制源路径无效”而窒息，因为我们不久前将该特定项目从分支移回了另一个文件夹。

有没有人成功处理过这个特殊问题？

我目前正在考虑分块转储主存储库，跳过可能导致错误的修订。然后，我会将每个块加载到新的存储库中，每个块都在一个文件夹下，并使用 Eclipse 将它们合并。你觉得这听起来合理吗？你觉得它有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T17:51:07.740

How was this project moved? There is an [`svn move`](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.move.html) command that can be used to move files/directories and, more important, let Subversion know that said files/directories have been moved.

```
svn move -m "Moved old/dir to new/dir" file:///url/to/old/dir file:///url/to/new/dir 
```

Since you've already moved it, I suggest you try using [`svn delete`](http://svnbook.red-bean.com/en/1.5/svn.ref.svn.c.delete.html) on the project's old location. This *should* force Subversion to remove references to the old location:

```
svn delete -m "Project was moved some time ago, reflecting in repository" file:///url/to/old/dir 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-28T00:29:54.753

语法是：

```
svnadmin dump c:\repository | svndumpfilter include project > myproject.dump 
```

这将包括项目下的所有内容。

有关更多详细信息，我添加了 svndumpfilter 帮助。

```
$ svndumpfilter help include
include: Filter out nodes without given prefixes from dumpstream.
usage: svndumpfilter include PATH_PREFIX...

Valid options:
  --drop-empty-revs        : Remove revisions emptied by filtering.
  --renumber-revs          : Renumber revisions left after filtering.
  --skip-missing-merge-sources : Skip missing merge sources.
  --targets ARG            : Pass contents of file ARG as additional args
  --preserve-revprops      : Don't filter revision properties.
  --quiet                  : Do not display filtering statistics. 
```

# winforms - 自定义控件和 Visual Studio 2008 SP1

> ID：595722
> 
> 赞同：2
> 
> 时间：2009-02-27T17:22:33.830
> 
> 标签：winforms, visual-studio-2008, ide, custom-controls

我创建了一个自定义控件（从 Control 继承的类）。当我把它放在表单上时，我可以在 Visual Studio IDE 上使用它。它向我显示了一个错误，我没有看到表单。

错误消息是这样的： La variable 'ctrlImagen' no está declarada o no se asignó nunca。

这是一个紧凑框架应用程序的 winform。

我该如何解决这个问题？（它的类继承自 UserControl 它工作得很好）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T17:34:10.277

听起来很疯狂，但 Visual Studio 会在设计器中为您的控件选择性地执行代码。首先要检查的是您的构造函数。确保你有一个空的、默认的构造函数，它是公共的，即使你从不打算使用它。之后确保您与布局事件（例如调整大小）相关的任何代码都可以使用，这些可能是罪魁祸首，因为当我的自定义控件在设计器中不起作用时，我总是会发现问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T17:29:34.343

听起来您的控件代码中有错误。这听起来像是阻止控件呈现的运行时错误。

重新阅读您的代码并寻找潜在的空指针异常、未分配的变量、堆栈溢出等。错误就在它们的某个地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T17:35:20.353

您的用户控件是否有可能没有公共默认构造函数？如果构造函数不是公共的，我会得到一个类似的错误“变量'userControlX'要么未声明或从未分配'。

不过，需要更多信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-11-29T20:12:26.117

在执行表单初始化逻辑之前执行的初始化逻辑中似乎发生了设计时异常。一个很好的例子是由表单包含的用户控件的默认构造函数（或它调用的一个或多个方法）触发的 NullPointerException。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T18:28:31.207

我把它放在构造函数上来解决问题： this.ClientSize = new Size(21, 21);

我班的开场白是这样的：

```
 `public class ControlMapa : Control
    {
        public ControlMapa()
        {
            this.ClientSize = new Size(21, 21);
            ...` 
```

 `谢谢！

# c# - Asp.net cookieless sessionId url 位置

> ID：595728
> 
> 赞同：3
> 
> 时间：2009-02-27T17:23:31.097
> 
> 标签：c#, asp.net, session

我正在一个移动网站上工作，我们不能依靠手机点击该网站来获得 cookie 支持。我正在为会话使用 cookieless 选项，并且想知道是否有办法指定在 URL 中放置 sessionId 的位置？

这是它现在的样子：

```
http://www.somesite.com/(S(qnxbzt45h2yxpr45tj3hpr45))/Default.aspx 
```

有没有办法在 URL 的末尾添加 sessionId？

```
http://www.somesite.com/Default.aspx?S=qnxbzt45h2yxpr45tj3hpr45 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T17:29:36.933

您不能使用 Sql 数据库来存储用户会话吗？我认为您无法更改 sessionId 位置，您可以尝试重写 url，但我不确定这将如何影响 .Net 对其的处理

**编辑：我只记得 Sql 选项仍然需要客户端机器上的 cookie 所以忽略我**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T23:01:34.343

会话选项在 web.conf sessionState 部分中设置。这里有详细说明：

[http://msdn.microsoft.com/en-us/library/h6bb9cz9(vs.71).aspx](http://msdn.microsoft.com/en-us/library/h6bb9cz9(vs.71).aspx)

没有办法使用 asp.net 的内置会话功能来设置这样的会话。你最好的办法是定义你自己的会话机制

# c# - C#接口问题

> ID：595739
> 
> 赞同：8
> 
> 时间：2009-02-27T17:25:58.113
> 
> 标签：c#, .net, performance, interface, ienumerable

将对象传递给实现特定接口的函数是否有成本，而该函数只接受该接口？像：

```
Change (IEnumerable<T> collection) 
```

我通过了：

```
List<T>
LinkedList<T>
CustomCollection<T> 
```

它们都实现了 IEnumerable。但是，当您将其中任何一个传递给 Change 方法时，它们是否会转换为 IEnumerable，因此存在转换成本以及丢失其独特方法等问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-27T17:27:57.123

不，自从`List<T>` `IS-A` `IEnumerable<T>`. 这是使用不需要强制转换的多态性。

编辑：这是一个例子：

```
using System;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        foo(new List<int>());
    }

    static void foo(IEnumerable<int> list) { }
} 
```

IL 为`Main`：

```
.method private hidebysig static void Main() cil managed
{
    .entrypoint
    .maxstack 8
    L_0000: nop 
    L_0001: newobj instance void [mscorlib]System.Collections.Generic.List`1<int32>::.ctor()
    L_0006: call void Program::foo(class [mscorlib]System.Collections.Generic.IEnumerable`1<int32>)
    L_000b: nop 
    L_000c: ret 
} 
```

正如你所看到的，没有涉及铸造。的实例`List<T>`被压入堆栈，然后`foo`立即调用它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T17:30:05.403

我不相信有代价。由于这些类型已经实现了 IEnumerable，因此应该可以立即使用该对象（请注意，这主要是猜测；我不知道 CLR 的 vtables 是如何在幕后真正工作的）。

如果有成本，它会非常小，如果它有所作为，你可能不应该从一开始就使用 CLR。

# sql-server - SQL Server 中存储过程的上次运行日期

> ID：595742
> 
> 赞同：80
> 
> 时间：2009-02-27T17:26:46.643
> 
> 标签：sql-server

我们开始在我们的应用程序中获得大量存储过程。其中许多用于自定义报告，其中许多已不再使用。有谁知道我们可以在 SQL Server 2005 中的系统视图上运行的查询，它会告诉我们执行存储过程的最后日期？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2011-03-29T13:39:12.883

下面的代码应该可以解决问题（> = 2008）

```
SELECT o.name, 
       ps.last_execution_time 
FROM   sys.dm_exec_procedure_stats ps 
INNER JOIN 
       sys.objects o 
       ON ps.object_id = o.object_id 
WHERE  DB_NAME(ps.database_id) = '' 
ORDER  BY 
       ps.last_execution_time DESC 
```

编辑 1：请注意下面的 Jeff Modens 建议。如果你在这里找到一个程序，你可以确定它是准确的。如果你不这样做，那么你就是不知道——你不能断定它没有运行。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-02-27T17:59:37.500

简而言之，没有。

但是，您可以做一些“好”的事情。

1.  使用存储的过程名称运行探查器跟踪
2.  每个过程添加一行（当然创建一个表）
    *   " `INSERT dbo.SPCall (What, When) VALUES (OBJECT_NAME(@@PROCID), GETDATE()`"
3.  延长 2 的持续时间

您可以做一些“有趣”的事情：

1.  删除它，看看谁来电
2.  移除权限，看看谁来电
3.  加`RAISERROR ('Warning: pwn3d: call admin', 16, 1)`，看谁来电
4.  加`WAITFOR DELAY '00:01:00'`，看谁来电

你明白了。久经考验的“看谁打电话”的 IT 支持方法。

如果报表是 Reporting Services，那么如果可以将代码与报表 DataSet 匹配，则可以[挖掘 RS 数据库以运行报表。](http://www.databasejournal.com/features/mssql/article.php/3483751/MSSQL-Server-Reporting-Services--Black-Belt-Administration--Execution-Log-Performance-and-Audit-Reports.htm)

无论如何，您都不能依赖 DMV，因为它们会在 SQL Server 重新启动后重置。查询缓存/锁是暂时的，不会持续任何时间。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2012-11-22T05:03:20.550

哦，现在小心点！所有闪光的不都是金子！所有的“stats” dm 视图和函数都存在这种类型的问题。它们仅针对缓存中的内容起作用，并且可以在几分钟内测量缓存中内容的生命周期。如果您要使用这样的东西来确定哪些 SP 可以被删除，那么当您删除几分钟前使用的 SP 时，您可能会受到伤害。

以下摘录来自给定 dm 视图的联机丛书……</p>

sys.dm_exec_procedure_stats 返回缓存存储过程的聚合性能统计信息。视图中每个存储过程包含一行，并且该行的生命周期与存储过程保持高速缓存一样长。当从缓存中删除存储过程时，相应的行将从该视图中删除。

sys.dm_exec_query_stats 视图包含缓存计划中的每个查询语句一行，并且行的生命周期与计划本身相关联。当从缓存中删除计划时，相应的行将从该视图中删除。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-04-04T08:43:26.090

**sys.dm_exec_procedure_stats**包含有关执行函数、约束和过程等信息。但是行的生命周期是有限制的，执行计划从缓存中删除的那一刻，条目就会消失。

```
Use [yourDatabaseName]
GO
SELECT  
        SCHEMA_NAME(sysobject.schema_id),
        OBJECT_NAME(stats.object_id), 
        stats.last_execution_time
    FROM   
        sys.dm_exec_procedure_stats stats
        INNER JOIN sys.objects sysobject ON sysobject.object_id = stats.object_id 
    WHERE  
        sysobject.type = 'P'
    ORDER BY
           stats.last_execution_time DESC 
```

这将为您提供最近执行的程序列表。

如果要检查最近是否执行了特定的存储过程

```
SELECT  
    SCHEMA_NAME(sysobject.schema_id),
    OBJECT_NAME(stats.object_id), 
    stats.last_execution_time
FROM   
    sys.dm_exec_procedure_stats stats
    INNER JOIN sys.objects sysobject ON sysobject.object_id = stats.object_id 
WHERE  
    sysobject.type = 'P'
    and (sysobject.object_id = object_id('schemaname.procedurename') 
    OR sysobject.name = 'procedurename')
ORDER BY
       stats.last_execution_time DESC 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2019-03-29T19:56:55.220

如果您在 SQL Server 2016 或更高版本上启用查询存储，您可以使用以下查询来获取最后一个 SP 执行。历史记录取决于查询存储配置。

```
SELECT 
      ObjectName = '[' + s.name + '].[' + o.Name  + ']'
    , LastModificationDate  = MAX(o.modify_date)
    , LastExecutionTime     = MAX(q.last_execution_time)
FROM sys.query_store_query q 
    INNER JOIN sys.objects o
        ON q.object_id = o.object_id
    INNER JOIN sys.schemas s
        ON o.schema_id = s.schema_id
WHERE o.type IN ('P')
GROUP BY o.name , + s.name 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-03-30T15:05:21.290

这在 2005 年运行良好（如果计划在缓存中）

```
USE YourDb;

SELECT qt.[text]          AS [SP Name],
       qs.last_execution_time,
       qs.execution_count AS [Execution Count]
FROM   sys.dm_exec_query_stats AS qs
       CROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) AS qt
WHERE  qt.dbid = DB_ID()
       AND objectid = OBJECT_ID('YourProc') 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-07-30T23:59:31.503

我用这个：

```
use YourDB;

SELECT 
    object_name(object_id), 
    last_execution_time, 
    last_elapsed_time, 
    execution_count
FROM   
     sys.dm_exec_procedure_stats ps 
where 
      lower(object_name(object_id)) like 'Appl-Name%'
order by 1 
```

# java - 解析多部分表单数据时出现异常

> ID：595744
> 
> 赞同：0
> 
> 时间：2009-02-27T17:27:23.677
> 
> 标签：java, multipartform-data

我正在尝试处理文件上传，并且正在使用 com.oreilly.servlet.multipart.MultipartParser 类来解析发布的数据（在 cos.jar 中）。但是，当我调用 MultipartParser 的构造函数时，我得到了这个异常：

```
java.io.IOException: Corrupt form data: premature ending
    at com.oreilly.servlet.multipart.MultipartParser.<init>(MultipartParser.java:166)
    at com.oreilly.servlet.multipart.MultipartParser.<init>(MultipartParser.java:94) 
```

有没有人见过这个？根据我的阅读，这意味着数据在找到它正在寻找的边界之前就结束了。我怎样才能解决这个问题？

我正在使用 cos.jar 1.0 版。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T18:36:20.533

[http://www.servlets.com/cos/faq.html](http://www.servlets.com/cos/faq.html)

> 这表明解析客户端提交的 POST 请求时出现问题。导致问题的原因可能有很多：
> 
> *   客户端点击了停止按钮（不是真正的问题，但确实会导致过早结束）
> *   Web 表单中的错误
> *   servlet 中的错误
> *   Web 服务器中的错误
> *   浏览器中的一个错误
> *   com.oreilly.servlet 库本身的一个错误
> 
> 历史表明，Web 服务器是最常见的问题原因，这可能是因为有很多不同的服务器，而且似乎很少有供应商测试他们的二进制上传能力。
> 
> 首先，确保您的客户没有按下停止按钮。然后，检查您的问题是否已发布在此站点上的“您需要了解的 Servlet 错误”资源上。如果它不为人所知，那么您将成为第一个了解它的人！您可以在这里与我们分享您的发现！
> 
> 其次，使用提供的 upload.html 表单和 DemoRequestUploadServlet.java 类查看上传是否有效。有些人在他们的表单中发现了导致问题的错误。测试这种组合将看看是否是这种情况。一位用户 Duke Takle 发现此异常是由重定向引起的：*I was experiencing the same "premature ending" as Albert Smith. What I've found is that the problem was isolated to I.E. 5.0\. The application that troubled me was doing a redirect after the construction of a MultipartRequest. It looks like this construction went well except on I.E. 5.0 the browser attempted to make the request again and by that time the ServletInputStream was empty. I've modified the application to simply write the needed response instead of redirecting. This problem was observed and fixed as described in Tomcat 4.0 and Weblogic 6.1.* Other users have found bugs in their handling servlet where they call request.getParameter() instead of multipartRequest.getParameter(), and some servers falsely read the input stream when their getParameter() is called causing an "unexpected end of part".

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T18:49:24.260

So, the problem was caused by me calling the MultipartParser constructor twice, by accident. It failed the second time, since the request had already been processed.

# mysql - 有没有办法直接从 SELECT 查询中将 IP 与 IP+CIDR 匹配？

> ID：595748
> 
> 赞同：23
> 
> 时间：2009-02-27T17:28:44.080
> 
> 标签：mysql, ip, mask, bitmask, cidr

就像是

> `SELECT COUNT(*) AS c FROM BANS WHERE typeid=6 AND (SELECT ipaddr,cidr FROM BANS) MATCH AGAINST 'this_ip';`

因此，您不必先从数据库中获取所有记录，然后将它们逐个匹配。

如果 c > 0 则匹配。

禁令表：

```
id int auto incr PK
typeid TINYINT (1=hostname, 4=ipv4, 6=ipv6)
ipaddr BINARY(128)
cidr INT
host VARCHAR(255) 
```

数据库：MySQL 5

查询时已知 IP 和 IPv 类型（4 或 6）。

IP 例如 ::1 二进制格式

禁止 IP 例如 ::1/64

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-02-27T20:45:34.827

请记住，IP 不是文本地址，而是数字 ID。我有类似的情况（我们正在做geo-ip查找），如果您将所有IP地址存储为整数（例如，我的IP地址是192.115.22.33所以它存储为3228767777），那么您可以查找IP使用右移运算符很容易。

所有这些类型的查找的缺点是您无法从索引中受益，并且每次查找时都必须进行全表扫描。上述方案可以通过存储CIDR网络的网络IP地址（范围的开始）和广播地址（范围的结束）来改进，例如存储192.168.1.0/24可以存储两个列：

```
network     broadcast
3232235776, 3232236031 
```

然后你可以匹配它你只需做

```
SELECT count(*) FROM bans WHERE 3232235876 >= network AND 3232235876 <= broadcast 
```

这将允许您将 CIDR 网络存储在数据库中，并通过利用快速数字索引将它们与 IP 地址快速有效地匹配。

*以下讨论的注意事项*：

MySQL 5.0 包含一个称为“[索引合并相交](http://dev.mysql.com/doc/refman/5.0/en/index-merge-optimization.html#index-merge-intersection)”的范围查询优化，它允许加速此类查询（并避免全表扫描），只要：

*   有一个多列索引按顺序与查询中的列完全匹配。所以 - 对于上面的查询示例，索引需要是`(network, broadcast)`.
*   可以从索引中检索所有数据。这对 是正确的`COUNT(*)`，但对 是不正确的`SELECT * ... LIMIT 1`。

MySQL 5.6 包括一个称为 MRR 的优化，它也可以加快全行检索，但这超出了这个答案的范围。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T18:06:26.923

对于`IPv4`，您可以使用：

```
SET @length = 4;

SELECT  INET_NTOA(ipaddr), INET_NTOA(searchaddr), INET_NTOA(mask)
FROM  (
  SELECT
        (1 << (@length * 8)) - 1 & ~((1 << (@length * 8 - cidr)) - 1) AS mask,
        CAST(CONV(SUBSTR(HEX(ipaddr), 1, @length * 2), 16, 10) AS DECIMAL(20)) AS ipaddr,
        CAST(CONV(SUBSTR(HEX(@myaddr), 1, @length * 2), 16, 10) AS DECIMAL(20)) AS searchaddr
  FROM  ip
) ipo
WHERE ipaddr & mask = searchaddr & mask 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-03-29T21:23:21.967

IPv4 地址、网络地址和网络掩码都是 UINT32 数字，并以人类可读的形式表示为“点四边形”。当检查地址是否在给定的网络空间（网络/网络掩码）中时，内核中的路由表代码执行非常快速的逐位与比较。这里的技巧是将点分四组 IP 地址、网络地址和网络掩码存储为 UINT32 表中，然后执行相同的 32 位逐位与匹配。例如

```
SET @test_addr = inet_aton('1.2.3.4');
SET @network_one = inet_aton('1.2.3.0');
SET @network_two = inet_aton('4.5.6.0');
SET @network_netmask = inet_aton('255.255.255.0');

SELECT (@test_addr & @network_netmask) = @network_one AS IS_MATCHED;
+------------+
| IS_MATCHED |
+------------+
|          1 |
+------------+

SELECT (@test_addr & @network_netmask) = @network_two AS IS_NOT_MATCHED;
+----------------+
| IS_NOT_MATCHED |
+----------------+
|              0 |
+----------------+ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-13T23:59:41.860

# 将 IP 地址范围生成为整数

> 如果您的数据库不支持花哨的按位运算，您可以使用基于整数的简化方法。

以下示例使用 PostgreSQL：

```
select (cast(split_part(split_part('4.0.0.0/8', '/', 1), '.', 1) as bigint) * (256 * 256 * 256) +
        cast(split_part(split_part('4.0.0.0/8', '/', 1), '.', 2) as bigint) * (256 * 256      ) +
        cast(split_part(split_part('4.0.0.0/8', '/', 1), '.', 3) as bigint) * (256            ) +
        cast(split_part(split_part('4.0.0.0/8', '/', 1), '.', 4) as bigint)) 
        as network,

       (cast(split_part(split_part('4.0.0.0/8', '/', 1), '.', 1) as bigint) * (256 * 256 * 256) +
        cast(split_part(split_part('4.0.0.0/8', '/', 1), '.', 2) as bigint) * (256 * 256      ) +
        cast(split_part(split_part('4.0.0.0/8', '/', 1), '.', 3) as bigint) * (256            ) +
        cast(split_part(split_part('4.0.0.0/8', '/', 1), '.', 4) as bigint)) + cast(
          pow(256, (32 - cast(split_part('4.0.0.0/8', '/', 2) as bigint)) / 8) - 1 as bigint
        ) as broadcast; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T17:43:22.830

嗯。您可以构建一个 cidr 掩码表，将其连接起来，然后将 ip anded（`&`在 MySQL 中）与带有禁止块 ipaddress 的掩码进行比较。那会做你想要的吗？

如果您不想构建掩码表，则可以`-1 << (x-cidr)`使用`x = 64`或`32`依赖计算掩码。

# iphone - UIScrollView 触摸似乎不起作用

> ID：595756
> 
> 赞同：2
> 
> 时间：2009-02-27T17:29:53.517
> 
> 标签：iphone, objective-c, uiscrollview

我在 Xcode 中为一个 iPhone 项目使用了“基于视图的应用程序”模板，并进入了视图控制器的 XIB。

我将视图从 basic 更改`UIView`为 a `UIScrollView`，现在是方法

`(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event;`

永远不会被调用。我`NSLog`在里面有一个声明。当控制器的视图是 a 时，它会被很好地调用`UIView`，那么 s 有什么不同/特别之处`UIScrollView`在于您没有收到触摸事件？如何响应触摸事件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-28T21:38:05.783

UIScrollView 不会传递所有触摸事件。它这样做是因为它试图自己解释滑动和滚动手势。

看看这个线程：[http](http://discussions.apple.com/thread.jspa?messageID=7519817) ://discussions.apple.com/thread.jspa?messageID= 7519817 了解 UIScrollView 和事件。底线是您可以处理视图中的事件，`-(void)touchesEnded:(NSSet *)aTouches withEvent:(UIEvent *)anEvent`但这不是直截了当的。

我个人在 UIScollView 对命中测试子视图的影响中看到了一些时髦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-28T00:25:26.950

我在这里没有任何直接经验，但我昨天正在查看可能解释这一点的文档。我想你会发现`UIScrollView`为了处理它的滚动而捕获触摸。`delaysContentTouches`在文档窗口中查看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T13:53:13.070

只需使用自定义内容子视图，然后在该视图中实现 touchesEnded:withEvent:。你会得到所有你想要的水龙头！

# c# - 连接两个属性以在 DropDownList 中显示

> ID：595761
> 
> 赞同：3
> 
> 时间：2009-02-27T17:31:23.637
> 
> 标签：c#, asp.net, dictionary

### 背景

在我们上一次[冒险](https://stackoverflow.com/questions/583689/dictionaryt-of-listt-and-listviews-in-asp-net)中，我试图正确地展示一个`Dictionary<Foo, Bar<T>>`. 感谢那篇文章中的有用答案，我意识到我一直在以错误的方式处理它。

### 问题

在今天的冒险中，我一直试图从`List<T>`最后一个问题中获得两个特定的属性来显示。每个列表都有特定的属性，如下所示：

```
---------------------
| 酒吧类 |
---------------------
| 整数 |
| Foo.Id 整数 |
| 名称字符串 |
| 输入字符串 |
---------------------

```

为了显示，我想显示`Bar.Name + Bar.Type`, 连接在一起。显然我必须保留完整的对象，因为 Id 将被传回以发送到数据库。

起初，我试过`<%#Eval("Value.Type" + "Value.Name")%>`了，显然没有用。我现在的猜测是我需要编写一个 foreach 循环来遍历字典对象，并`Dictionary.Value`完整地检索对象，并从中构建一个下拉列表。但是随后，问题就变成了将其绑定回关联的配置文件，并将其发送回数据库批发。

以下是当前页面的外观：

```
<tr><td align="center"> <%#Eval("Key.Name") %></td>
    <td align="center"><asp:DropDownList ID="ddlListOfBars" runat="server" 
DataSource='<%#Eval("Value")%>' DataValueField="Id" DataTextField="Type" />
</td> 
```

我一直在用不同的方法来改变它，`DataTextField`但还没有找到一种有效的组合。

### 问题

1.  这是我想太多了吗？
2.  我错过了什么？
3.  是否有关于如何从 中提取特定属性`List<T>`以将这些值用作 的显示值的`DropDownList`资源，如果有，是否有关于该主题的好的资源？
4.  这个帖子是不是一清二楚？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T20:15:20.437

事实证明，如果将表中的两列连接成一列，则问题很容易解决，如下所示：

`SELECT Column1Name + ' - ' + Column2Name AS Column3Name FROM Table1 WHERE`...

这变成了这样：

```
列 1 名称 列 2 名称
------------ ------------
东西 1 东西 5
东西2 东西6
东西 3 东西 7
东西4 东西8

```

进入这个：

```
列 3 名称
---------------
东西 1 - 东西 5
东西 2 - 东西 6
东西 3 - 东西 7
东西 4 - 东西 8

```

当所有其他方法都失败时，请考虑低一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T17:37:21.533

也许我遗漏了一些东西（没有看前面的问题），但你为什么不这样做呢？

```
<%# Eval("Name") + Eval("Type") %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-03-11T21:39:36.710

在连接字符串之前，我必须将对象转换为字符串。这对我有用。

`Text='<%# Eval("LastName").ToString() + ', ' + Eval("FirstName").ToString() %>'`

# sql - 计算 SQL 查询的执行时间？

> ID：595762
> 
> 赞同：47
> 
> 时间：2009-02-27T17:31:24.213
> 
> 标签：sql, sql-server-2005

我在我的网站中提供搜索功能，当用户搜索记录时，我想显示查询获得与谷歌相同的结果所花费的时间。当我们搜索任何内容时，谷歌会显示获得结果需要多长时间？

为此，我在我的 SP 中声明了一个 @start 变量，并在最后找到了不同之处，如下所示；

```
DECLARE @start_time DATETIME

SET @start_time = GETDATE()

-- my query
SELECT * FROM @search_temp_table

SELECT RTRIM(CAST(DATEDIFF(MS, @start_time, GETDATE()) AS CHAR(10))) AS 'TimeTaken' 
```

有没有其他简单快捷的方法，或者单行查询，我们可以找出执行查询所花费的时间？

我正在使用 SQL Server 2005。

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-07-28T09:47:28.497

好吧，如果您真的想在数据库中执行此操作，则[MSDN](http://msdn.microsoft.com/en-us/library/ms190287.aspx)中给出了一种更准确的方法：

```
SET STATISTICS TIME ON 
```

您也可以从您的应用程序中读取此信息。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-06-24T11:36:49.020

我发现这个更有帮助和简单

```
DECLARE @StartTime datetime,@EndTime datetime   
SELECT @StartTime=GETDATE() 
--Your Query to be run goes here--  
SELECT @EndTime=GETDATE()   
SELECT DATEDIFF(ms,@StartTime,@EndTime) AS [Duration in milliseconds] 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2009-02-27T17:40:38.280

我们从应用程序代码中监控这一点，仅包括建立/关闭连接和通过网络传输数据所需的时间。这很直接...

```
将持续时间变暗作为 TimeSpan
将 StartTime 调暗为 DateTime = DateTime.Now

'在这里调用数据库并执行你的SQL语句

持续时间 = DateTime.Now.Subtract(StartTime)
Console.WriteLine(String.Format("查询花费了 {0} 秒", Duration.TotalSeconds.ToString()))
Console.ReadLine()
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2012-08-31T11:04:42.040

请用

```
-- turn on statistics IO for IO related 
SET STATISTICS IO ON 
GO 
```

并用于时间计算

```
SET STATISTICS TIME ON
GO 
```

然后它将为每个查询提供结果。在查询输入窗口附近的消息窗口中。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2011-04-05T15:47:29.880

```
declare @sttime  datetime
set @sttime=getdate()
print @sttime
Select * from ProductMaster   
SELECT RTRIM(CAST(DATEDIFF(MS, @sttime, GETDATE()) AS CHAR(10))) AS 'TimeTaken' 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-02-27T17:34:58.760

你为什么在 SQL 中这样做？诚然，这确实显示了“真实”的查询时间，而不是查询时间+通过网络对数据进行洗牌的时间，但它会污染您的数据库代码。我怀疑您的用户会关心 - 事实上，他们可能*更愿意*包括网络时间，因为这都会影响他们查看页面所花费的时间。

为什么不在您的 Web 应用程序代码中进行计时？除此之外，这意味着对于您*不想*做任何计时但想要执行相同的过程的情况，您不需要弄乱您不需要的东西。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-06-06T06:51:44.897

您可以使用

```
SET STATISTICS TIME { ON | OFF } 
```

显示解析、编译和执行每条语句所需的毫秒数

当 SET STATISTICS TIME 为 ON 时，将显示语句的时间统计信息。关闭时，不显示时间统计

```
USE AdventureWorks2012;  
GO         
SET STATISTICS TIME ON;  
GO  
SELECT ProductID, StartDate, EndDate, StandardCost   
FROM Production.ProductCostHistory  
WHERE StandardCost < 500.00;  
GO  
SET STATISTICS TIME OFF;  
GO 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-14T10:44:38.637

试试这个

```
DECLARE @StartTime DATETIME
SET @StartTime = GETDATE()

  SET @EndTime = GETDATE()
  PRINT 'StartTime = ' + CONVERT(VARCHAR(30),@StartTime,121)
  PRINT '  EndTime = ' + CONVERT(VARCHAR(30),@EndTime,121)
  PRINT ' Duration = ' + CONVERT(VARCHAR(30),@EndTime -@starttime,114) 
```

如果还不行，那就试试 SET STATISTICS TIME ON

# c# - 什么是从 C# 中的子类聚合属性的优雅方法？

> ID：595764
> 
> 赞同：1
> 
> 时间：2009-02-27T17:32:22.027
> 
> 标签：c#

我有一种情况，我正在映射具有继承层次结构的类。我有一个每个班级都知道它需要的项目列表。例如：

```
public class PersonMapper
{
    private string[] attributes = new[] {"firstName", "lastName"};
}

public class UserMapper : PersonMapper
{
    private string[] attributes = new[] {"username"};
}

public class EmployeeMapper : PersonMapper
{
    private string[] attributes = new[] {"employeeId"};
} 
```

我想做一个方法调用，返回所有超类的聚合，如下所示：

```
EmployeeMapper mapper = new EmployeeMapper();
string[] attributes = mapper.GetAttributes();
Assert.That(attributes, Has.Member("firstname")); 
```

我可以想到一些解决方案，但它们似乎过于复杂。我觉得我缺少一个优雅的解决方案。任何人都可以帮忙吗？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T17:38:29.267

您可以在名为 GetAttributes 的超类上拥有一个虚拟方法/属性，该方法/属性返回私有数组。然后，在每个子类中，像这样覆盖它。首先调用基类 GetAttribute 方法获取基类数组，并将其与子类数组结合，返回新数组。

代码示例：

```
public class PersonMapper
    {
        private string[] attributes = new[] { "firstName", "lastName" };
        public virtual string[] GetAttributes()
        {
            return attributes;
        }
    }

 public class EmployeeMapper : PersonMapper
    {
        private string[] attributes = new[] { "employeeId" };
        public override string[] GetAttributes()
        {
            return base.GetAttributes().Union(this.attributes).ToArray();
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T17:42:48.930

我很想开发一个自定义属性，将其应用于我关心跟踪的每个属性，然后使用反射来枚举应用了该属性的属性。您可以使用延迟加载，以便属性列表只填充一次。我也可能使 GetAttributes() 成为静态（类）方法。

```
public class MappedAttribute : Attribute
{
}

public class Person
{
    [Mapped]
    public string FirstName { get; set; }

    [Mapped]
    public string LastName { get; set; }

    public string DisplayName
    {
        get { return FirstName + " " + LastName; }
    }
}

public static class Mapper
{
    public static IList<string> Attributes( Type t )
    {
          List<string> attributes = new List<string>();

          foreach (PropertyInfo pInfo in t.GetProperties())
          {
              MappedAttribute attr = pInfo.GetCustomAttributes(typeof(MappedAttribute),false)
                                          .Cast<MappedAttribute>()
                                          .FirstOrDefault();
              if (attr != null)
              {
                  attributes.Add(pInfo.Name);
              }
          }

          return attributes;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T17:41:01.103

没有反射，在当前状态下是没有办法做到的。你可以做的是创建一个受保护的虚拟方法，它允许每个类将它们的属性添加到列表中并以这种方式聚合。

```
public class PersonMapper {
  protected virtual void AggregateAttributes(List<string> list) {
    list.AddRange(attributes);
  }
  public List<string> GetAttributes() {
    List<string> list = new List<string>();
    AggregateAttributes(list);
    return list;
  }
}

public class UserMapper {
  protected override void AggergateAttributes(List<string> list) {
    base.AggregateAttributes(list);
    list.AddRange(attributes);
  }
}

public class EmployeeMapper {
  protected override void AggergateAttributes(List<string> list) {
    base.AggregateAttributes(list);
    list.AddRange(attributes);
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T17:42:57.043

我会采用更简单的方法：

```
class Entity {
    public virtual IEnumerable<string> Attributes { get { yield return "Name"; } }
}

class Person : Entity {
    public override IEnumerable<string> Attributes {
        get {
            return new string[] { "FirstName", "LastName" }
                .Concat(base.Attributes);
        }
    }
}

class User : Person {
    public override IEnumerable<string> Attributes {
        get {
            return new string[] { "UserName" }
                .Concat(base.Attributes);
        }
    }
} 
```

（PS 这些类型的层次结构很少在单继承语言中起作用。）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T17:45:02.403

```
public class PersonMapper
{
    protected List<string> attributes =
        new List<string>() {"firstName", "lastName"};
    public string[] GetAttributes()
    {
        //defensive copy
        return attributes.ToArray();
    }
}

public class EmployeeMapper : PersonMapper
{
    public EmployeeMapper()
    {
        attributes.Add("employeeId");
    }
} 
```

# linux - 在 Linux/Unix 文件系统上挂载可执行文件

> ID：595765
> 
> 赞同：2
> 
> 时间：2009-02-27T17:32:31.683
> 
> 标签：linux, file, executable

是否可以使可执行文件看起来像 Linux 上的只读文件，这样打开“文件”进行读取实际上会执行文件并使其标准输出可用于读取，就好像它是“文件”中的数据一样？任何知道如何打开文件进行读取的程序都应该可以打开它，例如“cat”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T17:35:44.343

看`popen`。基本上你所描述的是一个管道。

PS如果您需要特定语言的帮助，请编辑问题并添加您正在使用的语言/环境，我会尝试提供更多细节。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T17:36:57.510

使用[保险丝](http://en.wikipedia.org/wiki/Filesystem_in_Userspace)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T17:39:00.717

在类 unix 操作系统上，您可以将程序的输出发送到由另一个程序打开的命名管道。查看 mkfifo 命令来创建命名管道。命名管道很像文件，但有一些限制。例如，它是不可搜索的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T17:39:43.803

似乎您可以将程序的输出通过管道传输到您用来“读取”的任何内容中。问题是如果你想用 emacs 或 vim 或其他方式打开可执行文件，这与可执行文件无关，因为编辑器不知道任何其他解释它的方式。

# javascript - 如何确定原生 JavaScript 对象是否具有属性/方法？

> ID：595766
> 
> 赞同：24
> 
> 时间：2009-02-27T17:33:24.850
> 
> 标签：javascript, methods, properties, native, typeof

我认为这很容易：

```
if(typeof(Array.push) == 'undefined'){
  //not defined, prototype a version of the push method
  // Firefox never gets here, but IE/Safari/Chrome/etc. do, even though
  // the Array object has a push method!
} 
```

它在 Firefox 中运行良好，***但在 IE、Chrome、Safari、Opera 中却不行***，它们使用此测试将本机 Array 对象的所有属性/方法返回为“未定义”。

.hasOwnProperty(prop) 方法仅适用于实例......所以它不起作用，但通过反复试验，我注意到它有效。

```
//this works in Firefox/IE(6,7,8)/Chrome/Safari/Opera
if(typeof(Array().push) == 'undefined'){
  //not defined, prototype a version of the push method
} 
```

*使用此语法来确定Native Object / ~"JavaScript Class"~*上是否存在属性/方法有什么问题，或者有更好的方法吗？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2010-03-21T20:00:41.573

检查属性是否存在的正确方法：

```
if ('property' in objectVar) 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-02-27T17:41:08.247

首先， typeof 是一个运算符，而不是一个函数，所以你不需要括号。其次，访问对象的原型。

```
alert( typeof Array.prototype.push );
alert( typeof Array.prototype.foo ); 
```

当您执行时，`typeof Array.push`您正在测试 Array 对象本身是否具有 push 方法，而不是 Array 的实例是否具有 push 方法。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2010-04-19T22:14:26.253

`.hasOwnProperty`可以在数组的原型上访问，如果不够`typeof`惯用的话。

```
 if (Array.prototype.hasOwnProperty('push')) {
    // Native array has push property
} 

```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-27T17:54:26.017

> 它在 Firefox 中运行良好

这只是巧合！您通常不能期望原型的方法也存在于构造函数中。

> ```
> if(typeof(Array().push) == 'undefined') 
> ```

这几乎是正确的，除非你忘记了`new`，这是一个长期存在的 JavaScript 陷阱。`new Array().push`，或者`[].push`简而言之，将正确检查实例是否具有您想要的方法。

# css - CSS 在 IE 中不起作用？

> ID：595768
> 
> 赞同：2
> 
> 时间：2009-02-27T17:34:03.320
> 
> 标签：css, internet-explorer, firefox, safari

已经在这个网站上工作了一段时间，在 Mac 和 PC Firefox 以及 Safari 上都能完美运行。然而，IE 使该网站几乎一片空白——关于发生了什么的任何想法？任何解决方法？

预先感谢您的帮助！

[http://www.alliedprintingsolutions.com](http://www.alliedprintingsolutions.com)

[http://www.alliedprintingsolutions.com/style.css](http://www.alliedprintingsolutions.com/style.css)（样式表）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-27T17:44:30.033

Your html is [invalid](http://validator.w3.org/check?uri=http%3A%2F%2Fwww.alliedprintingsolutions.com%2F&charset=(detect+automatically)&doctype=Inline&ss=1&outline=1&group=0&verbose=1&st=1&user-agent=W3C_Validator%2F1.606) in many ways. Please fix that first.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-27T17:50:51.140

Add a DOCTYPE!

Either HTML5 or HTML4 **Strict** (*not* Transitional) are recommended for best cross-browser support.

```
<!DOCTYPE html> 
```

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"> 
```

(As you can see, HTML5 is much simpler, and still usable even if you're not yet using HTML5 tags.)

Note: The DOCTYPE must be very first thing in the file, before all other tags, and with no blank lines, tabs, nor spaces before it.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T17:45:27.363

You may want to try adding a doctype.

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd"> 
```

Edit: The doctype declaration should be the *first* thing in the html file. It goes even *before* the <html> tag.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-27T18:06:13.850

快速解决方案：删除“溢出：自动；” 来自#wrapperbig 和#wrapper。

这将获得要显示的内容。

但是，请务必查看其他答案。他们有很好的观点。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-31T15:19:56.660

我也遇到了同样的问题，经过一番研究找到了解决方案。

1.  不要在 HTML 文件上编码 CSS
2.  制作一个单独的 CSfile 并使用链接到它`<link rel="stylesheet" href="css/style.css">`
3.  并且总是`<!DOCTYPE>`在每个 HTML 页面上添加标签 //*这是主要的解决方案

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T17:40:58.980

I don't have FireBug on me right now (if you don't have this extension - get it!) But using images in the way you are right now is the problem.

Use CSS to apply a "background-image" attribute for your site's main content. For example:

```
<style>
.Page
{
    background-image : url(../images/site_bg.png) no-repeat;
    width : 600px; /* Image width here */
    heigth : 500px; /* Image height here */
    padding-top : 15px; /* top text offset here */
    padding-left : 15px; /* left text offset here */
    padding-right : 15px; /* right text offset here */
    padding-bottom : 15px; /* bottom text offset here */
}
</style>

...

<div class = "Page">
 <!-- Content -->
</div> 
```

That will work much better, and will work in all browsers just fine :)

**In response to comment**

I don't want to say your wrong, but when I can click and drag the background images with my mouse cursor that means that you are using an IMG tag to show the background instead of (or in conjunction with) the background-image attribute. I can almost gurentee that that is your problem. Remove all of your img tags and replace them with divs and the background-image style and your problem will be resolved.

If I had firebug on me I could go into more detail.

**Second edit with example code**

Here is some rough code that may help you remove your unneccecary image use.

```
<style>
    .Container { margin : auto; width : 600px; /* BG and Header Width here */ }

    .Header
    {
        background-image : url(../images/site_header.png) no-repeat;
        width : 600px; /* Image width here */
        heigth : 500px; /* Image height here */
        padding-top : 15px; /* top text offset here */
        padding-left : 15px; /* left text offset here */
        padding-right : 15px; /* right text offset here */
        padding-bottom : 15px; /* bottom text offset here */
    }

    .Header .Link1:link, .Header .Link1:visited, .Header .Link2:link, .Header .Link2:visited
    {
        width : 60px;
        heigth : 60px;
        display : block;
        float : left;
        margin : 10 20px;
    }

    .Header .Link1:link, .Header .Link1:visited
    {
        background-image : url(../images/link1.jpg);
    }

    .Header .Link2:link, .Header .Link2:visited
    {
        background-image : url(../images/link2.jpg);
    }

    .Page
    {
        background-image : url(../images/site_bg.png) no-repeat;
        width : 600px; /* Image width here */
        heigth : 500px; /* Image height here */
        padding-top : 15px; /* top text offset here */
        padding-left : 15px; /* left text offset here */
        padding-right : 15px; /* right text offset here */
        padding-bottom : 15px; /* bottom text offset here */
    }
</style>

...

<div class = "Container">
  <div class = "Header">
    <a href = "link1" id = "Link1"></a>
    <a href = "link2" id = "Link2"></a>
  </div>
  <div class = "Page">
    Content
  </div>
</div> 
```

:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-27T17:56:07.867

Had a quick look at the code in firebug. You seem to have a z-index of -1 on the content div (#wrapperbig), which browsers should ignore for non-absolute/relative content - this may be an odd implementation in IE.

Also, as mentioned before, add a doctype - IE will render the site in 'quirks mode' if there is no doctype.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-27T19:38:52.537

谢谢大家的建议，大家。大部分内容现在都显示在 IE 上（相对应如此），除了页脚以粗俗的方式切割我的页面（哈哈）。我明白你在说什么，Nelson LaQuet，关于标题图像，我将不得不尝试使用它们，我对 CSS 还是很陌生，并且弄清楚将它们全部正确放置在图像映射中是很头疼的. 至于 Doctype，我按照您告诉我的方式添加了它，即使在 Firefox 上它似乎也弄乱了一些内容，所以我知道我必须经历更多错误。当我删除它时，一切看起来又正常了。具有绝对定位的“woowoo's”非常必要，因为使用的定位方法是我能找到的唯一方法来处理背景图像和标题图像，列 div 在正确的位置。至少我取得了一些积极的进展，但我想我还有更多的工作要做：/只是希望它更容易纠正，因为它在 Firefox 中看起来还不错。哦，好吧，再次感谢您的所有帮助，伙计们！

香农

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-10-14T18:44:01.930

有时甚至在添加之后

```
<!DOCTYPE html> 
```

未加载 CSS。

这是因为之前的空白

```
 <!DOCTYPE html> 
```

确保它不存在。

否则在 IE 中，页面会显示得很糟糕

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-27T18:09:32.407

content_left 和 content_right 的绝对定位发生了太多的 woo-doo 事情。您可以通过删除“位置：绝对”并将其替换为两个内容中的“浮动：左”（将包装宽度设置为 100%）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-03-13T17:05:36.250

不仅仅是之前的空白：

```
 <!DOCTYPE html> 
```

还要删除样式表（CSS 文件）中花括号前的空格。简单样式表的示例（想象它在文本编辑器的左边距）：

```
 h1{
     font-family:Arial;
     color:purple;
    } 
```

# c++ - 有什么好的脚本语言可以集成到高性能应用程序中？

> ID：595787
> 
> 赞同：8
> 
> 时间：2009-02-27T17:38:45.150
> 
> 标签：c++, performance, scripting, cross-platform

我是一名游戏开发人员，目前正在为我们公司编写一个跨平台、多线程的引擎。可以说，游戏引擎中最强大的工具之一是它的脚本系统，因此我正在寻找一种新的脚本语言来集成到我们的引擎中（目前使用的是相对基本的内部引擎）。

所需脚本系统的主要功能（按重要性排序）是：

*   性能 - 必须快速调用和更新脚本
*   跨平台 - 需要相对容易地移植到多个平台（不介意一些工作，但移植到每个平台应该只需要几天时间）
*   离线编译——能够离线预解析脚本代码几乎是必不可少的（有助于文件大小和加载时间）
*   与 c++ 良好集成的能力 - 应该能够支持语言内的 OO 代码，并将此功能与 c++ 集成
*   多线程 - 不是必需的，但需要。最好能够在不相互干扰的多个线程上运行它的单独实例（即底层代码中没有需要在运行时更改的全局变量）。不需要应用基于临界区和互斥锁的解决方案。

到目前为止，我有集成/使用 Lua、Squirrel（OO 语言，基于 Lua）的经验，并编写了一个 ActionScript 2 虚拟机。

那么，您推荐哪种脚本系统符合上述标准？（如果可能的话，您能否发布或链接到与您可能拥有的其他脚本语言的任何比较）

谢谢，格兰特

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-27T17:44:38.317

由于暴雪动视将 Lua 作为开发《魔兽世界》插件的主要平台，Lua 的优势在于经过了许多知名视频游戏开发人员的时间考验，并拥有一批知识渊博的开发人员。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-27T17:42:32.817

**[Lua](http://www.lua.org/)**多年来一直用于视频游戏行业。轻巧高效。

话虽如此，[ChaiScript](http://chaiscript.org)和[Falcon](http://falconpl.org)是很好的候选者，可以满足您的需求，并且使用比 Lua 更高级别的语言，但历史和社区支持较少。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-27T17:46:12.993

Lua 非常适合您的需求。我会按照相同的顺序来处理它们。

Lua 是最快的脚本语言之一。它编译速度快，运行速度快。

Lua 可以使用 ANSI C 编译器在任何平台上编译，afaik 包括所有游戏平台。

Lua 可以预编译，但作为一种非常动态的语言，大多数错误只能在运行时检测到。此外，预编译代码（作为字节码）的大小通常比源代码大。

有许多 Lua/C++ 绑定工具。

它不支持多线程（您不能从多个线程访问解释器的单个实例），但您可以拥有多个解释器实例，每个线程一个，甚至每个游戏对象一个。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-27T17:46:39.327

*   [卢阿](http://www.lua.org/)
*   [提升 Python](http://www.boost.org/doc/libs/1_38_0/libs/python/doc/index.html)
*   [痛饮](http://www.swig.org/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-27T23:21:59.160

到目前为止，我们和[松鼠相处得很好。](http://squirrel-lang.org/)Lua 是如此受欢迎，它正在成为一种标准。

我建议您更多地担心内存而不是速度。大多数脚本语言“足够快”，如果它们变慢，您总是可以将其中的一些功能推回到 C++ 中。但是，其中许多会消耗大量内存，而在控制台上，内存是比 CPU 时间更稀缺的资源。无限的内存消耗最终会让你崩溃，如果你必须为解释器分配 4MB，那就像必须将 30 个纹理扔出窗口以腾出空间。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-27T18:36:16.477

[Lua](http://lua.org)，然后[是 LuaJIT](http://luajit.org)以获得额外的热情！

只是不要对自动 C++ 绑定库抱有太多期望，大多数都是缓慢且限制性的。最好为自己的对象做自己的绑定。

至于并发，可以是[LuaLanes](http://luaforge.net/projects/lanes/)，也可以是你自己的。如果您的 C++ 程序已经是多线程的，只需从每个线程调用单独的 LuaStates，并在需要时使用您自己的 C++ 共享结构作为通信通道。

您可能已经知道，Lua 中最常重复的答案是“自己动手”，这通常是最好的建议！除非它与通用 C/C++ 库的绑定有关，否则很可能已经有一个。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-27T22:38:57.283

如果您还没有看过它，我建议您查看[Angelscript](http://www.angelcode.com/angelscript)。

我已经在跨平台环境（Windows 和 Linux 只需重新编译）中成功使用了它，它旨在与 C++（对象和代码）很好地集成。

它是轻量级的并且支持多线程（从提出问题的意义上说），性能良好并且可以编译成可以提前完成的字节码。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-27T17:58:04.430

[从Python](http://www.python.org)开始。

如果你能证明你需要更快的速度，那么看看[Stackless Python](http://www.stackless.com/)。这就是[EVE Online](http://www.eveonline.com/faq/faq_07.asp)用于他们的游戏的内容。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-27T18:46:19.183

JavaScript 可能是一个合理的选择，因为在优化 Web 浏览器中使用的各种实现方面付出了大量努力。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-27T20:11:32.147

想到这些：

*   卢阿
*   带有 boost::python 的 Python
*   MzScheme 或 Guile
*   红宝石与 SWIG

# opengl - 在 OpenSceneGraph 中禁用纹理

> ID：595790
> 
> 赞同：0
> 
> 时间：2009-02-27T17:39:02.403
> 
> 标签：opengl, openscenegraph

我需要在 OSG 中完全禁用纹理。我尝试`glDisable(GL_TEXTURE_2D)`并使用了 osg::stateSet，但是一些具有纹理的节点仍然呈现它们的纹理。有没有办法全局关闭纹理？

一点背景知识：我需要为一个场景生成一个对象覆盖图，也就是说，知道是什么对象产生了每个可见像素。我用平面颜色渲染每个对象并读回颜色缓冲区 - 这就是为什么纹理会破坏我正在尝试做的事情。关于如何实现这一点的任何其他想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-30T21:49:21.237

你确定在设置 Texture2D 属性时设置了 osg::StateAttribute::OVERRIDE 位吗？即类似的东西

```
osg::Texture2D*const tex2D = new osg::Texture2D;
ss->setAttributeAndModes( tex2D, osg::StateAttribute::OFF | osg::StateAttribute::OVERRIDE ); 
```

哪里`ss`是场景图中足够高的节点上的状态集，以包含所有可能具有纹理的事物。

当然，如果 GL_TEXTURE_2D 模式或任何较低的 Texture2D 属性设置了 osg::StateAttribute::PROTECTED 位，那么 OVERRIDE 将被忽略，但您可能处于知道不会发生这种情况的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-11-11T22:51:51.180

The reason you are having problems is probably that certain nodes use osg::StateAttribute::OVERRIDE, like Troubadour (rightly) suggested you should. Assuming that's the case, you can create a a node visitor that actually traverses the entire tree and shuts off texture rendering - very crude, but will work.

As for the second part of your question: One option is to use the already built in functions in OSG for intersections - cast a ray from the eye to each pixel on the screen, and see where it intersects - VERY slow, but will work for sure :) There's also the openGL select mode (though I have to say I've never used it myself so I don't know how complicated it is to use) - you can read about it here: [http://www.opengl.org/resources/faq/technical/selection.htm](http://www.opengl.org/resources/faq/technical/selection.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-14T12:17:08.150

您是否考虑过将您的问题发布到 OSG 邮件列表？这似乎是一个更合适的地方问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-06-14T16:08:29.690

您使用的是 osgViewer::Viewer（单一/默认查看器）还是 osgViewer::View？如果 osgGA::StateSetManipulator 已使用 addEventHandler() 添加，则“t”键切换纹理。

最终，被调用的是**void StateSetManipulator::setTextureEnabled(bool newtexture)**。它的作用是：

```
unsigned int mode = osg::StateAttribute::OVERRIDE|osg::StateAttribute::OFF;
for( unsigned int ii=0; ii < 4; ii++ )
{
    _stateset->setTextureMode( ii, GL_TEXTURE_1D, mode );
    _stateset->setTextureMode( ii, GL_TEXTURE_2D, mode );
    _stateset->setTextureMode( ii, GL_TEXTURE_3D, mode );
    _stateset->setTextureMode( ii, GL_TEXTURE_RECTANGLE, mode );
    _stateset->setTextureMode( ii, GL_TEXTURE_CUBE_MAP, mode);
} 
```

其中 *_stateset* 是一个高节点（例如在**Viewer/View->setSceneData()**设置的根节点）

# version - 托管 C++：如何让我的非托管版本号与我的程序集版本号匹配

> ID：595791
> 
> 赞同：0
> 
> 时间：2009-02-27T17:39:35.100
> 
> 标签：version, managed-c++

我有一个托管的 c++ 项目。

如何使 DLL 的版本信息（在资源管理器中看到并由安装程序使用）与 Assembly Version 属性中生成的版本信息匹配？

装配信息.cpp：

```
[assembly:AssemblyVersion("5.1.*")]; 
```

这个问题在[这里](http://www.empowertec.de/blog/2008/02/03/version-information-in-managed-c-assemblies-in-visual-studio/)讨论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T17:46:47.703

Also set the [AssemblyFileVersionAttribute](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyfileversionattribute.aspx) and [AssemblyInformationalVersionAttribute](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyinformationalversionattribute.aspx).

# c# - 更新来自表单的 LINQ 模型的最佳方法

> ID：595793
> 
> 赞同：2
> 
> 时间：2009-02-27T17:40:00.217
> 
> 标签：c#, asp.net-mvc, linq

我正在我的 ASP.NET MVC 应用程序中设计将接收对象的表单。典型的编辑操作如下所示：

```
 [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult Edit(int id, Person person)
    {
        peopleService.SavePerson(person);
        return Redirect("~/People/Index");
    } 
```

服务中的`SavePerson`调用执行以下操作：

```
 public void SavePerson(Person person)
    {
        _peopleRepository.SavePerson(person);
    } 
```

存储库中的`SavePerson`调用执行此操作：

```
 public void SavePerson(Person person)
    {
        using (var dc = new SIGAPDataContext())
        {
            if (person.IsNew)
            {
                dc.People.InsertOnSubmit(person);
            }
            else
            {
                dc.People.Attach(person, true);
            }

            dc.SubmitChanges();
        }
    } 
```

现在，当我创建新记录时，这很有效。但是，当我在没有所有表单元素的情况下更新它时，它会使其他字段为空。例如，我的 Person 模型有一个 NationalityID 属性，如果它没有显示在编辑表单上，则该属性为空。

仅使用来自表单的字段来更新模型的最佳实践是什么？我是否必须先从数据库中获取记录并手动更新它的属性，例如：

```
Person persistedPerson = peopleService.GetPerson(person.ID);
persistedPerson.Name = person.Name;
persistedPerson.DateOfBirth = person.DateOfBirth
// etc... 
```

或者有没有其他更清洁的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T17:51:55.927

Stephen Walther 刚刚发布了一篇文章，在 ASP.NET MVC 中[描述了这件事。](http://stephenwalther.com/blog/archive/2009/02/27/chapter-5-understanding-models.aspx)我建议您实际上在 LINQ to SQL 之上创建自己的一组 DTO 和业务对象，并将 LINQ to SQL 视为[语言集成的对象数据库](http://wizardsofsmart.net/patterns/linq-to-sql-and-entity-framework-as-internal-object-databases)，因为[管理 DataContext 引入了总体复杂性](http://www.west-wind.net/Weblog/posts/246222.aspx)，根据[Pro LINQ](https://rads.stackoverflow.com/amzn/click/com/1590597893)，应该通过设计尽可能少地保持活力。

如果您打算使用您的 LINQ to SQL 实体作为您的 DTO，您应该首先获取实体，分离它，更新它，重新附加它，然后提交它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T17:55:52.580

在您的控制器中，从存储库中检索现有人员，然后使用 UpdateModel/TryUpdateModel 并传入您要更新的属性的白名单。这将使用控制器上的 ValueProvider，因此无需在操作参数列表中获取 Person 对象。

```
public ActionResult Edit( int id )
{
      Person person = peopleService.GetPerson(id);
      UpdateModel(person,new string[] { list of properties to update } );
      peopleService.SavePerson(person);

      ...
} 
```

# php - 如何构建 PHP 网络邮件脚本？

> ID：595798
> 
> 赞同：1
> 
> 时间：2009-02-27T17:41:01.307
> 
> 标签：php, email, smtp

1）如何配置 linux 服务器，使其可以接收发送到的任何电子邮件`account@domain.com`。

2) PHP 脚本如何访问和显示这些电子邮件？

我正在构建一个简单的网络邮件脚本，所以我只想接收注册电子邮件帐户的电子邮件，并对他们的电子邮件进行分类并显示它们。

还需要有显示附件的能力。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T17:48:22.660

老实说，您最好查看已经存在的网络邮件系统之一并对其进行修改以满足您的需求，而不是从头开始编写一些东西。

电子邮件 RFC 读起来很有趣（不，不，它们不是），附件处理导致许多开发人员喝得酩酊大醉。不要误会我的意思，这是可以做到的。它只是大量的工作，而不是您想要承担的事情，除非您有大量时间深入研究它。

但是，如果您想快速简单地编写一些东西，我建议设置一个带有 Imap 或 pop 服务器的 linux 盒子，然后使用适当的 PHP / Pear 库访问该邮箱。这将是最快的开始方式。

但我仍然建议使用其中一种现成的解决方案并将其修改以满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T17:47:48.870

邮件服务器本身可以设置为接收带有任意数量的 MTA（sendmail、postfix、exim 等）的电子邮件。您还需要垃圾邮件保护和病毒扫描（同样在任何发行版中都有免费的软件包）。请注意，如今运行自己的邮件服务器已不再适合胆小的人。

一旦到位，我可能会设置 IMAP 并使用[PHP 的 IMAP 函数](http://us2.php.net/imap)来检索和解析消息。如果您希望它们在浏览器中可读，那么查看附件会困难得多，但很容易标记它们在那里并使其可下载。

可能已经编写了一个类，可以为您完成大部分工作（当然设置除外）。

更新：事实上[，evolt](http://www.evolt.org/article/Incoming_Mail_and_PHP/18/27914/index.html)上有一篇旧文章似乎涵盖了这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T17:46:25.800

你有很多工作摆在你面前——不要指望有人在这里发布一些代码。

首先阅读 POP3、SMTP 和 IMAP RFC。然后去找一个商业/开源解决方案。

# sftp - Ctrl-M chars when transfer files SFTP

> ID：595803
> 
> 赞同：4
> 
> 时间：2009-02-27T17:42:21.333
> 
> 标签：sftp

I am sending files from a windows system to a Unix SFTP server using JSCAPE ftp client. However, I am experiencing the following issue: When uploading a text file from windows to UNiX, each line of text files transferred contains Control-M characters. I did some search and found out that If I use the "ASCII" transfer mode it should solve the issue. But the Ctrl-M is still appearing on the files.

Can anyone throw some light in this issue?

thanks in advance

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-01-24T08:52:27.127

**FTP**支持在二进制和 ASCII 传输模式之间切换并即时转换数据，但**SFTP**不支持该功能，并且它始终传输文件不变（至少对于最流行的协议版本 3）。

实用程序[dos2unix](http://linuxcommand.org/man_pages/dos2unix1.html)可用于将文件从 DOS 转换为 Unix。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T17:49:57.087

That's the newline character from windows files showing up on UNIX system.

Convert the line endings prior to uploading or find a different FTP server package that can do it for you.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T20:31:02.473

一些文本编辑器内置了此功能。例如，Notepad++

你有cygwin吗？您可以使用 dos2unix 实用程序。

# javascript - 是否可以在不破坏后代事件侦听器的情况下附加到 innerHTML？

> ID：595808
> 
> 赞同：141
> 
> 时间：2009-02-27T17:43:14.157
> 
> 标签：javascript, html, innerhtml, dom-events

在下面的示例代码中，我将一个`onclick`事件处理程序附加到包含文本“foo”的 span。处理程序是一个匿名函数，它会弹出一个`alert()`.

但是，如果我分配给父节点的`innerHTML`，则此`onclick`事件处理程序将被破坏 - 单击“foo”无法弹出警报框。

这是可以修复的吗？

```
<html>
 <head>
 <script type="text/javascript">

  function start () {
    myspan = document.getElementById("myspan");
    myspan.onclick = function() { alert ("hi"); };

    mydiv = document.getElementById("mydiv");
    mydiv.innerHTML += "bar";
  }

 </script>
 </head>

 <body onload="start()">
   <div id="mydiv" style="border: solid red 2px">
     <span id="myspan">foo</span>
   </div>
 </body>

</html> 
```

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2009-02-27T17:47:07.483

不幸的是`innerHTML`，即使您尝试追加，赋值也会导致所有子元素的破坏。如果要保留子节点（及其事件处理程序），则需要使用[DOM 函数](https://developer.mozilla.org/en/Gecko_DOM_Reference)：

```
function start() {
    var myspan = document.getElementById("myspan");
    myspan.onclick = function() { alert ("hi"); };

    var mydiv = document.getElementById("mydiv");
    mydiv.appendChild(document.createTextNode("bar"));
} 
```

**编辑：**鲍勃的解决方案，来自评论。发布你的答案，鲍勃！获得荣誉。:-)

```
function start() {
    var myspan = document.getElementById("myspan");
    myspan.onclick = function() { alert ("hi"); };

    var mydiv = document.getElementById("mydiv");
    var newcontent = document.createElement('div');
    newcontent.innerHTML = "bar";

    while (newcontent.firstChild) {
        mydiv.appendChild(newcontent.firstChild);
    }
} 
```

* * *

## 回答 #2

> 赞同：132
> 
> 时间：2016-12-07T16:35:10.960

使用`.insertAdjacentHTML()`保留事件侦听器，[并被所有主要浏览器支持](http://caniuse.com/#feat=insertadjacenthtml)。这是一个简单的单行替换`.innerHTML`.

```
var html_to_insert = "<p>New paragraph</p>";

// with .innerHTML, destroys event listeners
document.getElementById('mydiv').innerHTML += html_to_insert;

// with .insertAdjacentHTML, preserves event listeners
document.getElementById('mydiv').insertAdjacentHTML('beforeend', html_to_insert); 
```

该`'beforeend'`参数指定在元素中插入 HTML 内容的位置。选项有`'beforebegin'`、`'afterbegin'`、`'beforeend'`和`'afterend'`。它们对应的位置是：

```
<!-- beforebegin -->
<div id="mydiv">
  <!-- afterbegin -->
  <p>Existing content in #mydiv</p>
  <!-- beforeend -->
</div>
<!-- afterend --> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-01-20T18:06:15.423

现在是 2012 年，jQuery 有 append 和 prepend 函数可以做到这一点，在不影响当前内容的情况下添加内容。很有用。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-07-04T08:08:16.507

我创建了要作为字符串插入的标记，因为它的代码更少，并且比使用花哨的 dom 东西更容易阅读。

然后我把它做成了一个临时元素的innerHTML，这样我就可以获取该元素的唯一子元素并附加到主体上。

```
var html = '<div>';
html += 'Hello div!';
html += '</div>';

var tempElement = document.createElement('div');
tempElement.innerHTML = html;
document.getElementsByTagName('body')[0].appendChild(tempElement.firstChild); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-05-02T20:41:13.547

是的，如果您`onclick="sayHi()"`直接在类似于您的模板中使用标签属性绑定事件是可能的`<body onload="start()">`- 这种方法类似于框架 angular/vue/react/etc。您还可以像[这里](https://stackoverflow.com/a/55937083/860099)[`<template>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/template)一样使用“动态”html 进行操作。它不是严格不显眼的 js，但对于小型项目来说是[可以接受的](https://stackoverflow.com/a/54769527/860099)

```
function start() {
  mydiv.innerHTML += "bar";
}

function sayHi() {
  alert("hi");
}
```

```
<body onload="start()">
  <div id="mydiv" style="border: solid red 2px">
    <span id="myspan" onclick="sayHi()">foo</span>
  </div>
</body>
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-28T13:05:32.067

顺便说一句（但相关），如果您使用诸如 jquery (v1.3) 之类的 javascript 库来进行 dom 操作，您可以利用实时事件来设置如下处理程序：

```
 $("#myspan").live("click", function(){
  alert('hi');
}); 
```

并且它将在任何类型的 jquery 操作期间始终应用于该选择器。对于实时事件，请参阅：[docs.jquery.com/events/live](http://docs.jquery.com/Events/live)对于 jquery 操作，请参阅：[docs.jquery.com/manipulation](http://docs.jquery.com/Manipulation)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-06-27T03:48:35.957

还有另一种选择：使用`setAttribute`而不是添加事件侦听器。像这样：

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Demo innerHTML and event listeners</title>
<style>
    div {
        border: 1px solid black;
        padding: 10px;
    }
</style>
</head>
<body>
    <div>
        <span>Click here.</span>
    </div>
    <script>
        document.querySelector('span').setAttribute("onclick","alert('Hi.')");
        document.querySelector('div').innerHTML += ' Added text.';
    </script>
</body>
</html>
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-27T17:48:44.593

IMO 丢失事件处理程序是 Javascript 处理 DOM 方式中的一个错误。为避免此行为，您可以添加以下内容：

```
function start () {
  myspan = document.getElementById("myspan");
  myspan.onclick = function() { alert ("hi"); };

  mydiv = document.getElementById("mydiv");
  clickHandler = mydiv.onclick;  // add
  mydiv.innerHTML += "bar";
  mydiv.onclick = clickHandler;  // add
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-03-27T19:14:25.963

你可以这样做：

```
var anchors = document.getElementsByTagName('a'); 
var index_a = 0;
var uls = document.getElementsByTagName('UL'); 
window.onload=function()          {alert(anchors.length);};
for(var i=0 ; i<uls.length;  i++)
{
    lis = uls[i].getElementsByTagName('LI');
    for(var j=0 ;j<lis.length;j++)
    {
        var first = lis[j].innerHTML; 
        string = "<img src=\"http://g.etfv.co/" +  anchors[index_a++] + 
            "\"  width=\"32\" 
        height=\"32\" />   " + first;
        lis[j].innerHTML = string;
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-07-12T18:45:54.777

something.innerHTML += '添加任何你想要的东西';

它对我有用。我使用此解决方案向输入文本添加了一个按钮

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-10-24T08:07:30.970

最简单的方法是使用数组并将元素推入其中，然后将数组后续值动态插入到数组中。这是我的代码：

```
var namesArray = [];

function myclick(){
    var readhere = prompt ("Insert value");
    namesArray.push(readhere);
    document.getElementById('demo').innerHTML= namesArray;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-07-21T09:08:08.160

对于任何带有标题和数据的对象数组。`jsfiddle`

[https://jsfiddle.net/AmrendraKumar/9ac75Lg0/2/](https://jsfiddle.net/AmrendraKumar/9ac75Lg0/2/)

```
<table id="myTable" border='1|1'></table>

<script>
  const userObjectArray = [{
    name: "Ajay",
    age: 27,
    height: 5.10,
    address: "Bangalore"
  }, {
    name: "Vijay",
    age: 24,
    height: 5.10,
    address: "Bangalore"
  }, {
    name: "Dinesh",
    age: 27,
    height: 5.10,
    address: "Bangalore"
  }];
  const headers = Object.keys(userObjectArray[0]);
  var tr1 = document.createElement('tr');
  var htmlHeaderStr = '';
  for (let i = 0; i < headers.length; i++) {
    htmlHeaderStr += "<th>" + headers[i] + "</th>"
  }
  tr1.innerHTML = htmlHeaderStr;
  document.getElementById('myTable').appendChild(tr1);

  for (var j = 0; j < userObjectArray.length; j++) {
    var tr = document.createElement('tr');
    var htmlDataString = '';
    for (var k = 0; k < headers.length; k++) {
      htmlDataString += "<td>" + userObjectArray[j][headers[k]] + "</td>"
    }
    tr.innerHTML = htmlDataString;
    document.getElementById('myTable').appendChild(tr);
  }

</script> 
```

* * *

## 回答 #13

> 赞同：-7
> 
> 时间：2010-07-09T14:46:13.687

我是一个懒惰的程序员。我不使用 DOM，因为它看起来像是额外的输入。对我来说，代码越少越好。这是我如何在不替换“foo”的情况下添加“bar”：

```
function start(){
var innermyspan = document.getElementById("myspan").innerHTML;
document.getElementById("myspan").innerHTML=innermyspan+"bar";
} 
```

# c# - 我需要在 asp.net 中关闭 MySqlConnection 吗？

> ID：595810
> 
> 赞同：0
> 
> 时间：2009-02-27T17:43:52.547
> 
> 标签：c#, asp.net

我读过 PHP 中的非持久打开链接会在脚本执行结束时自动关闭。那么asp.net怎么了？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T17:46:40.997

很简单：PHP 和 ASP.NET 不是一回事。他们有不同的“规则”。不要试图在一种环境中编写代码，就像在另一种环境中一样。

在 .NET 中，几乎总是应该尽可能晚地打开连接并尽可能早地关闭它，让内置连接池处理与数据库的“真实”连接。*不要*把它留给 GC/finalizer 来为你整理连接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-27T17:47:20.370

是的，您需要关闭与数据库的打开连接。ADO.NET 有一个连接池，打开的连接会在它保持打开状态时保留给您。当您关闭它时，它将可供其他连接请求使用。

但是，如果您使用的是**DataAdapter**，并且您没有手动打开连接，则不需要关闭它。*DataAdapter 管理它并关闭它自己的连接*：

```
SqlConnection nwindConn = new SqlConnection("Data Source=localhost;Integrated Security=SSPI;Initial Catalog=northwind");

SqlCommand selectCMD = new SqlCommand("SELECT CustomerID, CompanyName FROM Customers", nwindConn);
selectCMD.CommandTimeout = 30;

SqlDataAdapter custDA = new SqlDataAdapter();
custDA.SelectCommand = selectCMD;

DataSet custDS = new DataSet();
custDA.Fill(custDS, "Customers"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T17:52:22.650

最简单的方法是使用 using 块：

```
var cmd = new MySqlCommand("command text here");
using (var con = new MySqlConnection("connection string")) {
    cmd.Connection = con;
    cmd.Connection.Open();
    //execute command here
} 
```

当您离开作用域时，连接对象将被自动释放。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T17:47:33.210

好吧，手动释放非托管数据是一个好习惯，尽管终结器最终会处理它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T17:47:50.370

ASP.Net 据说是“托管的”，但实际上只指内存。

当您的页面实例超出范围时，您可以保证包装连接的内存对象最终将被收集并导致它关闭，但您无法保证*何时*会发生这种情况。由于大批量释放内存效率更高，因此您的连接可能会停留一段时间，如果您获得大量这些可能会导致大问题。

因此，您应该确保您的连接已关闭。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T17:48:21.523

由于大多数连接对象都实现`IDisposable`并具有终结器，因此您在技术上可以依靠垃圾收集器为您关闭连接，因为终结器将调用`Close()`连接。显然这是一个坏主意 - 将您的连接对象包装在`using`语句中，或者在您完成它们时显式关闭它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-06T19:57:48.553

由于我需要 50 声望才能对某人的帖子发表评论，因此我将我的评论发布给 Adam Lassek 作为答案。他的方法是正确的方法。Using 语句将清理非托管代码。

# user-interface - What are some great web based interfaces that you use on a day to day basis?

> ID：595821
> 
> 赞同：2
> 
> 时间：2009-02-27T17:46:39.077
> 
> 标签：user-interface

I definitely appreciate a good interface and as a developer, I try to create them for my users. But appreciating a good interface and designing one are a different thing. I'm looking for good interfaces (such as IMHO StackOverflow, Gmail) as examples of good UI from which I can model my own UI's.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-27T17:49:01.740

I personally think that [Netflix](http://www.netflix.com/) has an excellent web UI. Responsive, easy to navigate. Not mutch [CRUD](http://en.wikipedia.org/wiki/Create,_read,_update_and_delete) going on, but I find it very comfortable.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T17:48:30.197

Pretty much anything by google, really. They're all very simple and to the point, focusing on usability.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T17:50:23.513

You should get yourself a copy of both [Don't Make Me Think](https://rads.stackoverflow.com/amzn/click/com/0321344758) and [The Non-Designer's Design Book](https://rads.stackoverflow.com/amzn/click/com/0321534042) for your base knowledge/insight.

From there, it's much easier for you to dissect and analyze the layouts you already know and like, and recreate them for your own amusement.

*edit:* To mitigate misunderstanding, the point I'm trying to make is that you probably don't need as many good examples of nice layouts, if you know what to look for. For example, I can be shown a thousand *haute couture* dresses, and I still couldn't make one myself, because I don't know what to look for.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-27T17:50:49.130

My favorites

*   Stack Overflow: This is a WIKI so it's not a rep point grab. I just really love the interface on this site. Been to too many crappy Q/A sites
*   Google Reader
*   MSDN: It's gotten a ton better in recent years and is a great way to grab little esoteric details about various APIs

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T17:52:11.917

[iStockPhoto.com](http://www.istockphoto.com) it's simple, effective and handles a large amount of information and data without getting bogged down. It also doesn't get in the way of the info you are looking for.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-27T17:57:25.400

一个好的用户界面可以有效地满足用户的特定需求。

例如，这是我创建的[一个网站](http://www.varjocafe.net/?ids=33,37,38,47)（[翻译），用于查找赫尔辛基大学自助餐厅有哪些食物。](http://translate.google.com/translate?prev=hp&hl=en&u=http%3A%2F%2Fwww.varjocafe.net%2F%3Fids%3D33%2C37%2C38%2C47&sl=fi&tl=en)典型的用例是当一个学生饿了，他需要知道附近的学生食堂有什么食物（对学生来说很便宜），这样他就可以选择在哪里吃什么和吃什么。他知道每个自助餐厅在哪里，但不知道他们今天有什么食物。

该站点一次显示所有需要的信息。因为学生通常有几个他们去的自助餐厅，所以他们可以为选择了这些自助餐厅的页面添加书签，或者将选择保存为 cookie。之后，他们无需在网站上进行任何导航即可实现目标。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-27T18:57:44.303

我不是每天都使用它，但是[Perseus Project](http://www.perseus.tufts.edu/hopper/)数字图书馆给我留下了深刻的印象。

[*以下是来自拉丁语卡图卢斯的Carmina*](http://www.perseus.tufts.edu/hopper/text.jsp?doc=Perseus:text:1999.02.0003)[的一首诗的链接，](http://www.perseus.tufts.edu/hopper/text.jsp?doc=Perseus:text:1999.02.0003)作为界面示例。我非常喜欢的一些功能：

*   单击顶部附近的栏以跳转到作品中的任何一首诗。较大的块代表作品的较大部分（诗歌，章节，但是该特定作品在逻辑上被作者分解）。
*   点击诗歌中的一个拉丁词会弹出一个窗口（请耐心等待；这似乎需要一段时间），其中包含词典条目、用户投票和单词形式的统计信息（即在句子上下文中屈折变化的含义；它在拉丁语中可能有歧义）等等。
*   右栏中有许多资源，包括各种英文翻译、注释、参考资料等。其中任何一个都可以显示在右栏中，或者与中心主要内容区域中的任何内容交换。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-27T17:52:20.983

One of my personal favs: [newspond.com](http://newspond.com)

# jquery - jquery：ajaxError 总是最后触发

> ID：595840
> 
> 赞同：0
> 
> 时间：2009-02-27T17:50:42.577
> 
> 标签：jquery, ajax, error-handling

我正在构建一个页面，该页面可能会从 ajax 调用接收**大量**html，然后将其插入页面。有时，我会收到 http 401 错误，而不是我期望的 html。理想情况下，我希望首先触发错误处理程序，这样我就可以设置错误标志，显示消息，而**不是**插入进来的 html。

我遇到的问题是错误处理程序触发了**LAST**，所以我已经插入了包含未执行脚本标签的 html，它使一切都崩溃了。

另外，我注意到 ajaxError 在“完成”处理程序之后触发，这会发生。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T18:00:45.563

您应该使用`success`处理程序而不是`complete`更新 html，因为只有在服务器发送 200 时才会触发它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T18:01:45.360

如果您在 ajax 调用中使用 GET 方法 instace POST，则问题是您可以接收的字符数限制。

一种解决方案是，将先前的内容保存在类似的时间 xml 中，并在调用后获取内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T18:02:06.373

几个想法：

*   设置您的 ajax 回调函数，以便它检查返回字符串的内容以确保它有效。如果它不是您所期望的，请不要插入它。

*   您的 ajax 错误处理程序不应执行回调（即插入 HTML）并执行错误处理代码。如果发生这种情况，您可能会在其他地方遇到错误。

*   如果需要，您可能需要查看设置超时选项。

# sql-server - MDX equivalent to SQL subqueries with aggregation

> ID：595846
> 
> 赞同：0
> 
> 时间：2009-02-27T17:52:14.477
> 
> 标签：sql-server, ssas, mdx

I'm new to MDX and trying to solve the following problem. Investigated calculated members, subselects, scope statements, etc but can't quite get it to do what I want.

Let's say I'm trying to come up with the MDX equivalent to the following SQL query:

```
SELECT SUM(netMarketValue) net, 
  SUM(CASE WHEN netMarketValue > 0 THEN netMarketValue ELSE 0 END) assets,
  SUM(CASE WHEN netMarketValue < 0 THEN netMarketValue ELSE 0 END) liabilities,
  SUM(ABS(netMarketValue)) gross
  someEntity1
FROM (
SELECT SUM(marketValue) netMarketValue, someEntity1, someEntity2
FROM <some set of tables>
GROUP BY someEntity1, someEntity2) t
GROUP BY someEntity1 
```

In other words, I have an account ledger where I hide internal offsetting transactions (within someEntity2), then calculate assets & liabilities after aggregating them by someEntity2\. Then I want to see the grand total of those assets & liabilities aggregated by the bigger entity, someEntity1.

In my MDX schema I'd presumably have a cube with dimensions for someEntity1 & someEntity2, and marketValue would be my fact table/measure. I suppose i could create another DSV that did what my subquery does (calculating net), and simply create a cube with that as my measure dimension, but I wonder if there is a better way. I'd rather not have 2 cubes (one for these net calculations and another to go to a lower level of granularity for other use cases), since it will be a lot of duplicate info in my database. These will be very large cubes.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T19:07:46.353

我认为您应该将聚合逻辑留给多维数据集——这是它最擅长的。

在您的情况下，我将创建一个帐户维度，然后[添加 Account Intelligence](http://msdn.microsoft.com/en-us/library/ms174759.aspx)。但是，这仅适用于 SQL Server 企业版（2005 及更高版本）。

如果您碰巧拥有标准版，那么执行此操作的规范方法是[使用一元运算符](http://technet.microsoft.com/en-us/library/ms175417.aspx)。

这就是我们过去使用 Sql Server 2000 的方式，[这里](http://msdn.microsoft.com/en-us/library/aa902636(SQL.80).aspx)有一个很好的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-13T15:03:23.243

我认为您想要的不是两个多维数据集，而是一个带有两个事实表的多维数据集（有时称为星座模式）。这个问题是几个月前写的，所以除非有人要求更多信息，否则我不会在这里详细说明。

# algorithm - Pairwise priority queue

> ID：595859
> 
> 赞同：1
> 
> 时间：2009-02-27T17:56:59.753
> 
> 标签：algorithm, data-structures, theorem-proving

I have a set of `A`'s and a set of `B`'s, each with an associated numerical priority, where each `A` may match some or all `B`'s and vice versa, and my main loop basically consists of:

Take the best `A` and `B` in priority order, and do stuff with `A` and `B`.

The most obvious way to do this is with a single priority queue of `(A,B)` pairs, but if there are 100,000 `A`'s and 100,000 `B`'s then the set of `O(N^2)` pairs won't fit in memory (and disk is too slow).

Another possibility is for each `A`, loop through every `B`. However this means that global priority ordering is by `A` only, and I really need to take priority of both components into account.

(The application is theorem proving, where the above options are called the pair algorithm and the given clause algorithm respectively; the shortcomings of each are known, but I haven't found any reference to a good solution.)

Some kind of two layer priority queue would seem indicated, but it's not clear how to do this without using either `O(N^2)` memory or `O(N^2)` time in the worst case.

Is there a known method of doing this?

Clarification: each `A` must be processed with all corresponding `B`'s, not just one.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T20:34:02.717

你可以先处理最好的对，如果没有什么好的结果，为了完整起见，用给定的子句算法擦掉其余的。这可能会导致一些双重工作，但我敢打赌这无关紧要。

您是否考虑过有序的副调制或叠加？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T18:04:01.873

也许有什么我不明白，但是，

为什么不将 A 和 B 放在单独的堆中，在每个堆上获取_Max，做你的工作，从关联的堆中删除每个最大值并继续？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-02T19:43:05.243

似乎 A 中的项目具有单独的优先级，B 中的项目具有单独的优先级，并且 (A,B) 对具有组合优先级。只有组合的优先级很重要，但希望我们可以一路使用各个属性。但是，A 中的项目与 B 中的项目之间也存在独立优先级的匹配关系。

我假设，对于 A 中的所有 a、B 中的 b1 和 b2，使得 Match(a,b1) 和 Match(a,b2)，然后 Priority(b1) >= Priority(b2) 意味着 CombinedPriority(a,b1) >= 组合优先级（a，b2）。

现在，首先按优先级降序对 B 进行排序。令 B(j) 表示此排序顺序中的第 j 个元素。此外，让 A(i) 表示 A 的第 i 个元素（可能按或不按排序顺序）。

让 nextb(i,j) 是一个找到最小 j' >= j 的函数，使得 Match(A(i),B(j'))。如果不存在这样的 j'，则函数返回 null（或其他一些合适的错误值）。搜索 j' 可能只涉及从 j 向上循环，或者如果我们更多地了解 Match 关系的结构，我们可能能够更快地做一些事情。

为 A 中的所有索引 i 创建一个包含 (i,nextb(i,0)) 的优先级队列 Q，使得 nextb(i,0) != null。Q 中的对 (i,j) 由 CombinedPriority(A(i),B(j)) 排序。

现在只需循环直到 Q 为空。拉出最高优先级对 (i,j) 并适当处理 (A(i),B(j))。然后将 (i,nextb(i,j+1)) 重新插入到 Q 中（除非 nextb(i,j+1) 为空）。

总之，在所有配对都匹配的最坏情况下，这需要 O(N^2 log N) 时间。一般来说，它需要 O(N^2 + M log N)，其中 M 是匹配的数量。如果有一种更快的计算 nextb(i,j) 的方法只是向上循环，则可以减少 N^2 分量，但这取决于对匹配关系的了解。

（在上面的分析中，我假设 A 和 B 的大小都是 N。如果它们的大小不同，公式可以很容易地修改。）

在最坏的情况下，您似乎想要比 O(N^2) 时间更好的东西，但是如果您需要处理每场比赛，那么您就有一个 M 的下限，它可以是 N^2 本身。我认为你不会比 O(N^2 log N) 时间做得更好，除非组合优先级有一些特殊的结构可以让你使用比 log-N 更好的优先级队列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T21:26:57.673

我认为您最初的想法会奏效，您只需将 As 和 B 保存在单独的集合中，并将对它们的引用粘贴到您的优先级队列中即可。如果每个引用占用 16 个字节（只是为了选择一个数字），那么 10,000,000 个 A/B 引用将只占用 ~300M。假设你的 As 和 Bs 本身不是太大，它应该是可行的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T18:21:00.337

所以你有一组 A 和一组 B，你需要从这个组中选择一个 (A, B) 对，使得一些 f(a, b) 是任何其他 (A, B) 对中最高的.

这意味着您可以存储所有可能的 (A, B) 对并对其进行排序，然后每次通过循环选择最高的对（每次迭代 O(1)，但 O(N*M) 内存）。

或者您可以遍历所有可能的对并跟踪当前最大值并使用该最大值（每次迭代 O(N*M)，但只有 O(N+M) 内存）。

如果我对您的理解正确，这就是您要问的。

*我认为这在很大程度上取决于 f() 来确定是否有更好的方法来做到这一点。*

如果f(a, b) = a + b，那么显然很简单，最高的A，最高的B就是你想要的。

# c# - 从 RTF 文本中获取纯文本

> ID：595865
> 
> 赞同：18
> 
> 时间：2009-02-27T17:58:10.173
> 
> 标签：c#, .net, rtf

我的数据库中有一个包含 RTF 格式文本的列。

如何使用 C# 仅获取它的纯文本？

感谢：D

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-02-27T18:00:38.823

微软提供了[一个示例](http://msdn.microsoft.com/en-us/library/cc488002.aspx)，他们基本上将 rtf 文本粘贴在 a 中`RichTextBox`，然后读取`.Text`属性……感觉有点笨拙，但它确实有效。

```
static public string ConvertToText(string rtf)
{
   using(RichTextBox rtb = new RichTextBox())
   {
       rtb.Rtf = rtf;
       return rtb.Text;
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-05-06T09:59:35.670

对于 WPF，您可以使用（使用 Xceed WPF Toolkit）此扩展方法：

```
public static string RTFToPlainText(this string s)
    {
       // for information : default Xceed.Wpf.Toolkit.RichTextBox formatter is RtfFormatter 
        Xceed.Wpf.Toolkit.RichTextBox rtBox = new Xceed.Wpf.Toolkit.RichTextBox(new System.Windows.Documents.FlowDocument());
        rtBox.Text = s;
        rtBox.TextFormatter = new Xceed.Wpf.Toolkit.PlainTextFormatter();
        return rtBox.Text;

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T18:03:57.523

如果你想要一个纯代码版本，你可以自己解析 rtf 并只保留文本位。这是一些工作，但不是很困难的工作 - RTF 文件的语法非常简单。[在 RTF 规范中阅读它](http://msdn.microsoft.com/en-us/library/aa140284(office.10).aspx)。

# html - 将 Rails 配置为输出 HTML 输出而不是 XHTML

> ID：595867
> 
> 赞同：8
> 
> 时间：2009-02-27T17:58:32.370
> 
> 标签：html, ruby-on-rails, xhtml

如何在使用帮助程序（表单、javascript、css 等）时将 Ruby on Rails 配置为输出标准 HTML 代码而不是 XHTML？

我**不想**在最后有斜线：

```
<input name="email" type="text" /> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-03-06T19:37:16.647

This answer is contained in the link provided by MarkusQ, but I figured I could spell it out exactly.

You have to modify the code than renders all tags, you can do that by including the following code into something like lib/dont_use_xhtml.rb

```
module ActionView::Helpers::TagHelper
  alias :tag_without_backslash :tag
     def tag(name, options = nil, open = true, escape = true)
        tag_without_backslash(name, options, open, escape)
     end 
  end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-12-28T03:04:06.273

该解决方案不适用于最新版本的 Rails。一些助手会将“open”的打开方法参数覆盖为“false”。

以下在 Rails 2.3.5 中对我有用：

```
module ActionView::Helpers::TagHelper
  def tag_with_html_patch(name, options = nil, open = true, escape = true)
    tag_without_html_patch(name, options, true, escape)
  end
  alias_method_chain :tag, :html_patch
end 
```

将其放入初始化程序中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T18:03:43.873

见[http://railsforum.com/viewtopic.php?id=21941](http://railsforum.com/viewtopic.php?id=21941)

——马库斯

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-10T18:40:47.903

对于铁轨`2.3`：

安装 gem`haml`然后添加以下初始化程序`config/initializers/force_html4.rb`：

```
Haml::Template::options[:format] = :html4

module StandardistaHelper
  def tag(name, options = nil, open = false, escape = true)
    "<#{name}#{tag_options(options, escape) if options}>"
  end
end

ActionView::Base.send :include, StandardistaHelper

ActionView::Helpers::InstanceTag.class_eval do
  def tag_without_error_wrapping(name, options = nil, open = false, escape = true)
    "<#{name}#{tag_options(options, escape) if options}>"
  end
end 
```

# flash - 是否可以在 Actionscript 中将类型作为变量传递？

> ID：595868
> 
> 赞同：2
> 
> 时间：2009-02-27T17:58:59.953
> 
> 标签：flash, actionscript-3, unit-testing, actionscript, prototype

我*要*编写的动作脚本如下所示：

```
public function API(requestClass:Type=URLLoader) {
  var req:URLLoader = new requestClass(new URLRequest("some url"));
  req.load(url);
  //etc
} 
```

这样我就可以通过传入 URLLoader 的模拟子类来测试 API 类。这在 Actionscript 的类型系统中似乎是不可能的。

或者，在运行时更改 URLLoader 的 load() 方法就足够了。我对测试方法中的这段代码寄予厚望：

```
var b:Array = [];
URLLoader.prototype.load = function(u:URLRequest):void {
  b.push(u);
}
(new URLLoader()).load(new URLRequest("http://localhost"));
assertEquals(b.length, 1); 
```

但 URLLoader 实际上确实调用了它给出的 url，并且 b.length == 0。

所以！有什么方法可以让我的 API 类可以测试，而无需将测试逻辑放在我的 API 类中？我错过了什么明显的东西吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T19:03:19.797

您提供的代码中有几个错误，但该概念在 AS3 中完美运行。例如，以下代码可以完美地编译和运行：

```
package {
    import flash.display.Sprite;

    public class Main extends Sprite {
        public function Main():void {
            trace(getDynObj());
            trace(getDynObj(Number));
            trace(getDynObj(String));
        }

        public function getDynObj(requestClass:Class = null):* {
            var req:* = new (requestClass || int)("16.51");
            return req;
        }
    }

} 
```

和输出：

```
16
16.51
16.51 
```

因此，您的函数需要进行以下修改：

```
public function API(requestClass:Class = null):void {
    var req:* = new (requestClass || URLLoader)(new URLRequest("some url"));
    //etc
} 
```

*注意：* URLLoader 不接受纯字符串作为其构造函数参数，您必须将字符串包装在 URLRequest 对象中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T18:40:09.433

看看[flash.utils](http://livedocs.adobe.com/flex/3/langref/flash/utils/package.html#describeType())包。特别是函数： [getDefinitionByName()](http://livedocs.adobe.com/flex/3/langref/flash/utils/package.html#getDefinitionByName())。这个链接有一个很好的反射示例，您可能会喜欢。您可以尝试一下（当然，经过适当的修改后）：

```
public function API(mock:Object, type:String) {
    var ClassReference:Class = getDefinitionByName(type) as Class;
    var instance:Object = new ClassReference();
//instance.load(url); -- play around with your new class!

} 
```

# java - 在什么条件下创建 JSESSIONID？

> ID：595872
> 
> 赞同：300
> 
> 时间：2009-02-27T18:00:12.350
> 
> 标签：java, jsessionid

创建a 的时间/条件`JSESSIONID`是什么？

它是每个域吗？例如，如果我有一个 Tomcat 应用程序服务器，并且我部署了多个 Web 应用程序，`JSESSIONID`每个上下文（Web 应用程序）是否会创建不同的应用程序，或者只要它们是同一个域，它是否会在 Web 应用程序之间共享？

* * *

## 回答 #1

> 赞同：357
> 
> 时间：2009-02-28T23:56:07.183

JSESSIONID cookie 在创建会话时创建/发送。会话是在您的代码调用`request.getSession()`或`request.getSession(true)`第一次创建时创建的。如果您只想获取会话，但如果它不存在则不创建它，请使用`request.getSession(false)`-- 这将返回一个会话或`null`. 在这种情况下，不会创建新会话，也不会发送 JSESSIONID cookie。（这也意味着**会话不一定是在第一次请求时创建的**……您和您的代码在创建会话*时*处于控制之中）

会话是每个上下文的：

> SRV.7.3 会话范围
> 
> HttpSession 对象的范围必须在应用程序（或 servlet 上下文）级别。底层机制，例如用于建立会话的 cookie，对于不同的上下文可以是相同的，但引用的对象，包括该对象中的属性，决不能由容器在上下文之间共享。

（[Servlet 2.4 规范](http://jcp.org/aboutJava/communityprocess/final/jsr154/index.html)）

更新：如果还没有会话，则每次调用 JSP 页面都会隐式创建一个新会话。这可以使用 page 指令关闭`session='false'`，在这种情况下会话变量在 JSP 页面上根本不可用。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2009-09-29T17:33:14.750

`JSESSIONID`以下是有关另一种cookie来源的一些信息：

我只是在调试一些在 tomcat 服务器上运行的 Java 代码。我没有`request.getSession()`在代码中的任何地方显式调用，但我注意到`JSESSIONID`仍在设置 cookie。

终于在Tomcat下的work目录下看了一下生成的Java代码对应一个JSP。

看来，无论您喜欢与否，如果您从 servlet 调用 JSP，`JSESSIONID`就会被创建！

补充：我刚刚发现通过添加以下 JSP 指令：

```
<%@ page session="false" %> 
```

`JSESSIONID`您可以通过 JSP禁用设置。

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2009-02-28T23:47:40.963

更正：请为 Peter Štibraný 的答案投票 - 它更正确、更完整！

“JSESSIONID”是 http 会话的唯一 ID -[请参阅此处的 javadoc](https://docs.oracle.com/cd/E17802_01/products/products/servlet/2.5/docs/servlet-2_5-mr2/javax/servlet/http/HttpSession.html)。在那里，您会找到以下句子

> 会话信息的范围仅限于当前的 Web 应用程序 (ServletContext)，因此存储在一个上下文中的信息在另一个上下文中不会直接可见。

因此，当您第一次访问站点时，会创建一个新会话并将其绑定到 SevletContext。如果您部署多个应用程序，则不会共享会话。

您还可以使当前会话无效，从而创建一个新会话。例如，当从 http 切换到 https（登录后）时，创建一个新会话是一个非常好的主意。

希望，这回答了你的问题。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-06-19T16:47:15.623

请注意您的页面是否包含其他 .jsp 或 .jspf（片段）！如果你不设置

```
<%@ page session="false" %> 
```

同样，在它们上，父页面最终将启动一个新会话并设置 JSESSIONID cookie。

特别是对于 .jspf 页面，如果您使用以下代码段配置 web.xml，则会发生这种情况：

```
<jsp-config>
    <jsp-property-group>
        <url-pattern>*.jspf</url-pattern>
    </jsp-property-group>
</jsp-config> 
```

为了在其中启用scriptlet。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-09T21:08:04.530

对于在带有自定义标签的 JSP 中生成的链接，我不得不使用

```
<%@ page session="false" %> 
```

在 JSP 中

和

```
request.getSession().invalidate(); 
```

在 Struts 动作中

# c# - 用于加密/解密的 CLR 程序集

> ID：595873
> 
> 赞同：0
> 
> 时间：2009-02-27T18:00:38.560
> 
> 标签：c#, sql-server, encryption, assemblies, clr

我们最近在 MS SQL 2005 中实现了一些对称密钥，用于加密和解密信用卡、检查路由/帐号。

理想情况下，我们希望用户定义的函数能够执行加密和解密，但是这是不可能的，因为 encryptbykey 和 decryptbykey 函数不能在用户定义的函数中使用。

最初我认为我们可以创建一个带有函数的 CLR 程序集（在 C# 中）来执行此操作，但是，因为我了解到适用相同的规则。

我想知道其他人一直在做什么来轻松执行此功能。创建许多存储过程，例如：

OPEN SYMMETRIC KEY...
选择用户名，decryptByKey(...) 作为密码 CLOSE SYMMETRIC KEY...

...对于我们将加密/解密的许多领域来说，这将是非常乏味的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-03-01T14:26:37.683

不管它是不是一个好主意，一个带有输出参数的存储过程来实现与 udf 相同的效果呢？

# api - 有没有人觉得简单项目的解决方案经常被过度设计？

> ID：595877
> 
> 赞同：4
> 
> 时间：2009-02-27T18:00:48.763
> 
> 标签：api, architecture

不知何故，我有一种感觉，许多项目变得严重过度设计，因此每个可能的变更请求都可以得到解决，结果发生的变更请求很难实施。

不知何故，我几乎在我目前正在进行的每个项目中都有这种感觉。就像每个人都在思考“我们可以在项目中添加哪些很酷的 api、框架等来解决这个和那个方面”，而没有评估它是否实用或需要。

有没有其他人有同样的感觉，或者这里的社区有什么看法？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-27T18:04:35.400

是的。

——马库斯

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-27T18:06:41.667

我发现，虽然一些拥有“高级”高级管理人员的老公司往往对其业务代码的创建方式非常严格，但新公司完全缺乏他们使用什么软件来完成工作的骨干。

您所描述的问题听起来像是人们对问题的看法太高了，并希望找到一种一次性解决问题的方法。从长远来看，创建一个工作工具箱（想想标准库）会帮助他们。

我特别喜欢 UNIX 的处理方式：几个小型实用程序，它们只做一件事，而且做得非常好。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-27T18:06:50.433

绝对 - 我认为人们经常将“健壮和模块化”和“过度设计”混为一谈。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-27T18:15:18.900

我认为[Dave Winer 很好地捕捉到了这种现象的周期性](http://www.scripting.com/stories/2008/12/04/soonItWillBeTimeToStartOve.html)：

> 每个周期的诀窍是与复杂性作斗争，这样增长才能继续下去。但是你不能把它排除在外，工程师喜欢复杂性，不仅仅是因为它为他们提供了工作保障，还因为他们真的很喜欢它。但是一旦堆栈变得太神秘，下一代就会举手并说“我们不会处理那个烂摊子”。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-27T18:10:39.783

被指控有罪。三级抽象和六个配置文件的实现比简单的流控制分支更有趣。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-27T18:12:14.663

过度工程在任何项目中都是危险的，无论大小。在编写代码可扩展性时，总是需要在编写足够通用和可扩展以允许未来开发的代码与足够具体的代码以使手头的任务变得容易之间进行权衡。

每个“未来的钩子”都有一个成本，应该根据该成本、它被使用的概率以及游戏后期重构的成本来评估。“更通用”并不总是更好。

至于使用热门的新框架或 API，我认为项目经理应该谨慎处理。随着发展是一个如此快速发展的领域，实践性的自我培训是经商代价的一部分（但显然应该保持合理。）

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-27T18:13:45.313

我只在 Java 人员中遇到过这种情况：“让我们使用 spring！” 并冬眠！我也发现了这个很酷的验证包！而这个将创建 XSLT 来创建 XML 表单来创建 javascript！”

当我找到所有的罐子并让它们玩得很好时，我必须熟悉几十个类。然后他们想抽象出所有这些片段！“我们可能会切换 spring。或者不使用休眠，所以我们应该将它们抽象出来”。添加另外十几个 hacky 包装类。

到它全部完成时，50 行伪代码已经变成了数千行让“酷东西”工作的代码，大约 100 行业务逻辑被困在它毛茸茸的、骇人听闻的、漏洞百出的地狱中。

我自己也为此感到内疚，但这只是因为我很无聊并且有时间消磨时间。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-27T18:16:53.637

这里要记住的关键是时间。一个“简单”的项目在第一天就被 Excel 电子表格或网页淘汰出局，它的受众和范围都会迅速扩大，成为一个不可持续的怪物。

工程不足也是一种危险。世界上到处都是“务实”的人，他们会嘲笑任何与他们意见相悖的努力。没有人记得一年后当“简单”解决方案无法持续时不同意的人。

诀窍是平衡正确的工程程度，并能够在事情发生变化时进行调整。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-27T18:23:42.560

我已经被我快速拼凑起来的应用程序咬了很多次，这些应用程序后来变成了“关键”应用程序。然后我几乎不得不重写该死的东西。我现在只是假设它会变得很关键，所以我第一次“写对了”。从长远来看，可以节省我的时间和精力。奇怪的是，这是关于懒惰的。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-03-11T16:47:52.690

今天的 xkcd 是绝对的真理： ![表明您的编码员没有足够的工作要做](https://imgs.xkcd.com/comics/not_enough_work.png)

我发现过度设计是无聊的副产品。我相信 Jeff 和 Joel 在播客中对此进行了介绍，但其想法是，经常过度工程的编码人员可能只是墨守成规，需要改变节奏（Jeff 和 Joel 建议允许他们从事不同的工作，例如 QA）。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-03-11T16:50:28.020

是的。我认为现在的人们更多地考虑应该如何完成某件事，以及“它是否是正确的方式……”等等，而不是仅仅选择能够同样完成工作的简单解决方案。如果您没有被要求扩展它，那么就不要考虑扩展它。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-27T18:47:17.793

我认为这是一个问题，但并不像看起来那么大，而且有充分的理由。

问题是，大多数设计不足的项目会很快死亡，而过度设计的项目可以生存。因此，当您查看仍在运行的项目时，存在幸存者偏差。

而且，即使您是一个以“足够好”为目标的优秀架构师，如果有疑问，您将使用更灵活、可扩展、……（即过度设计）的解决方案。因为如果您不满足要求（无论它们可能是什么），则故障模式通常比超出要求时发生的情况要糟糕得多。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-27T18:07:17.857

我还没有解决任何现实世界的问题，但我已经阅读了足够多的人写博客来假设存在问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-27T18:40:57.793

绝对地。但不仅仅是开发人员，用户也是如此。“我想要这个、那个和另一个，以改善沟通并提高生产力！”。

我很惊讶我们仅通过将共享文件夹放在文件服务器上就解决了多少此类项目。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-27T19:02:55.103

正如其他人所说，我有太多的“小”项目变成了大项目，走的捷径变成了油漆。

有一个快速而肮脏的解决方案的地方，在尝试遵循 YAGNI 的口头禅时，我创建了没有工程的简单应用程序。

尽管如此，如果没有在较小系统上的实践，您将无法跳入一百万行系统并开发“精心设计”的系统。

我在所有项目中始终遵循我们公司开发的架构，因为它可以帮助我根据我们试图遵循的工程原则制定解决方案。

你练习什么，你做什么，所以总是尽力而为。

# javascript - 弹出窗口中的链接不会关闭窗口？

> ID：595878
> 
> 赞同：0
> 
> 时间：2009-02-27T18:01:04.813
> 
> 标签：javascript, html

我有这段 html 代码，但是当我单击链接时，它并没有关闭：

```
<html>
   <head>
   <title></title>
   </head>
<body>
    <h2>Members Only</h2>
    <p>You must be a member.</p>
    <p>Please Sign In or Create an Account.</p>
    <a href="javascript: self.close ()">Close this Window</a>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-27T18:08:31.223

我刚刚删除了空格，效果很好：

```
<a href="javascript:self.close()">Close this Window</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T18:07:01.710

弹出窗口很糟糕，请改用[模态对话框](http://jqueryui.com/demos/dialog/modal.html)，特别是对于像通知这样简单的东西。

话虽如此，试试这个：

```
 <a href="javascript:window.close()">Close this Window</a> 
```

# c - 可以存储时间戳的最小字节数是多少？

> ID：595884
> 
> 赞同：17
> 
> 时间：2009-02-27T18:02:57.447
> 
> 标签：c, timestamp

我想在 C 中创建自己的时间戳数据结构。

天 (0 - 30), 小时 (0 - 23), 分钟 (0 - 59)

可能的最小数据结构是什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-27T18:13:51.647

好吧，您*可以*将它们全部打包`unsigned short`（即**2 个字节**，5 位代表日，5 位代表小时，6 位代表分钟）......并使用一些移位和掩码来获取值。

```
unsigned short timestamp = <some value>; // Bits: DDDDDHHHHHMMMMMM

int day = (timestamp >> 11) & 0x1F;
int hour = (timestamp >> 6) & 0x1F;
int min = (timestamp) & 0x3F;

unsigned short dup_timestamp = (short)((day << 11) | (hour << 6) | min); 
```

或使用宏

```
#define DAY(x)    (((x) >> 11) & 0x1F)
#define HOUR(x)   (((x) >> 6)  & 0x1F)
#define MINUTE(x) ((x)         & 0x3F)
#define TIMESTAMP(d, h, m) ((((d) & 0x1F) << 11) | (((h) & 0x1F) << 6) | ((m) & 0x3F) 
```

（您在当前版本的问题中没有提到月/年，所以我省略了它们）。

[*编辑*：使用`unsigned short`-未签名`short`。]

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-27T18:16:49.567

您是指 HOUR 0-23 和 MINUTE 0-59 吗？我听说过闰秒，但不是闰分钟或闰小时。

```
(log (* 31 60 24) 2)
=> 15.446 
```

因此，您可以将这些值设置为 16 位或 2 个字节。这是否是一个好主意是一个完全不同的问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-27T18:14:21.133

*   月份：范围 1 - 12 => 4 位
*   日期：范围 1 - 31 => 5 位
*   小时：范围 0 - 24 => 5 位
*   分钟：范围 0 - 60 => 6 位

* * *

*   总计：20 位

您可以使用位域并使用编译器/平台特定的编译指示来保持它的紧密：

```
typedef struct packed_time_t {
    unsigned int month  : 4;
    unsigned int date   : 5;
    unsigned int hour   : 5;
    unsigned int minute : 6;
} packed_time_t; 
```

但是你真的需要这个吗？标准时间函数还不够吗？位域因架构、填充等而异……不是可移植的构造。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-27T18:55:53.997

`time()`为什么不直接使用 C函数的（4 字节？）输出with`NULL`作为参数。这只是 Unix 纪元时间（即自 1970 年 1 月 1 日以来的秒数）。就像乔的答案一样，它比任何试图将数月、数天和数年打包成小块的答案为您提供了更大的成长空间*。*这是标准的。将`time_t`变量转换为实际时间在标准 C 中是微不足道的（至少在 Unix 上），并且大多数情况下，如果您有一个旨在保存 3 字节变量的数据结构，它可能会被四舍五入到 4 字节。

我知道您正在尝试对大小进行大量优化，但是 4 字节非常小。即使您截断最高字节，您仍然可以从中获得 194 天的不同时间。

`time(NULL)`通过在存储之前将时间从 60 除以 60，将其截断为一分钟并存储它，您可以从中获得更多收益。如上所示，其中 3 个字节为您提供 388 个月，而 2 个字节您可以存储 45 天。

我会选择 4 字节版本，只是因为我认为 2、3 和 4 字节之间的区别对于任何程序运行与否都不重要或至关重要（除非它是引导加载程序）。它更容易获得，也更容易处理，最终可能会为你省去很多麻烦。

编辑：我发布的代码不起作用。我已经睡了 3 个小时，我最终会弄清楚如何正确地旋转比特。在那之前，您可以自己实现它。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-27T18:23:07.867

注意：原始问题已被编辑，不再需要月份。原始计算如下：

这只是您想要进行多少计算的问题。最紧凑的打包方法是，如果您可以创建自己的类型，并使用以下数学从和转换为相应的整数：

有效范围是：

```
月份：1-12 -> (0-11)+1
日：1-31 -> (0-30)+1
小时：0-24
分钟：0-60

```

您可以选择存储值的顺序（我将按上述顺序保存）。

```
月-1 天-1 小时分钟
(0-11) (0-30) (0-23) (0-59)
```

使用以下公式作为指导，进行一些乘法/除法以转换值：

```
值 = (((月 - 1) * 31 + (日 - 1)) * 24 + 小时) * 60 + 分钟

```

因此，您有最小值 0 和最大值`((11*31+30)*24+23)*60+59`535,679。因此，您至少需要 20 位才能将此值存储为无符号整数 ( `2^20-1 = 1,048,575; 2^19-1 = 524,287`)。

如果你想让事情变得复杂但节省一个字节，你可以使用 3 个字节并自己操作它们。或者您可以使用 int（32 位）并使用简单的数学运算符正常使用它。

但是那里有一些空间可以玩，所以让我们看看我们是否可以让这更容易：

有效范围再次是：

```
月份：1-12 -> (0-11)+1 --- 4 位（你甚至不需要 -1）
日：1-31 -> (0-30)+1 --- 5 位（您再次不需要 -1）
小时：0-24 --- 5 位
分钟：0-60 --- 6 位

```

总共有 20 位，而且非常容易操作。因此，除了使用简单的位移之外，进一步压缩不会获得任何收益，并且可以像这样存储值：

```
19 18 17 16 15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0
---月--- ----日------- ---小时--- --分钟---

```

* * *

如果你不关心月份，你能得到的最紧的是：

```
值 = ((Day - 1) * 24 + Hour) * 60 + Minute

```

为您留下 0 到 44,639 的范围，可以整齐地放入 16 位`short`.

不过那里有一些空间可以玩，所以让我们看看我们是否可以让这更容易：

有效范围再次是：

```
Day: 1-31 -> (0-30)+1 --- 5 位（你甚至不需要 -1）
小时：0-24 --- 5 位
分钟：0-60 --- 6 位

```

总共有 16 位，而且非常容易操作。所以....存储这样的值：

```
15 14 13 12 11 10 9 8 7 6 5 4 3 2 1 0
----天------- ---小时--- --分钟---

```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-27T18:15:29.413

对于您描述的用例（31 天范围内的时间分钟分辨率），我只使用 16 位分钟计数器。如果您正在序列化这些数据（到磁盘、网络），那么您可以使用一些可变长度整数编码来保存小值的字节。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-27T18:21:53.547

一般来说，您可以按如下方式计算此答案（其中 log2 是以 2 为底的对数，即位数）：

*   如果要使用移位和掩码来输入和输出数据，请取每个字段的可能值数量的 log2()，向上取整（以获取位），将结果相加（以获取总位），除以八（总字节，w.小数字节），然后再次四舍五入（总字节）。

    log2(60) + log2(60) + log2(24) + log2(31) + log2(12) = 6+6+5+5+4 = 26 位 = 4 字节

*   如果您想通过乘法和加法/除法和取模来输入和输出字段，请将每个字段的可能值的数量相乘，然后取 log2()，除以 8，然后四舍五入。

    log2(60*60*24*31*12) = 24.9379 位 = 4 字节

*   您可以通过组合非异构字段（例如，存储一年中的某天而不是月份和月份的某天）节省一点额外的空间，但这并不值得。

    log2(60*60*24*366) = 24.91444 位 = 4 字节

——MarkusQ《教人钓鱼》

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-27T18:33:33.347

只是提供一个替代方案：

*   如果你只需要分钟级别的分辨率，
*   而且您不会跨越日期边界（月/年）
*   并且您的消息是连续的，并且有保证的交付

然后您可以将时间戳存储为与最后一条消息的时间戳的偏移量。

在这种情况下，您只需要足够的位来保存消息之间的最大分钟数。例如，如果您最多间隔 255 分钟发出消息，那么一个字节就足够了。

但是请注意，第一条消息可能需要在其有效负载中包含绝对时间戳，以进行同步。

[我并不是说这是一个很好的解决方案——它相当脆弱并且做出了很多假设——只是一个替代方案]

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-27T18:38:27.190

60 分钟/小时意味着您至少需要 6 位来存储分钟（因为第 59 分钟 == 111011b），而 24 小时/天意味着另外 5 位（第 23 小时 == 10111b）。如果要考虑（可能）366 天/年中的任何一个，则需要多 9 位（第 366 天（第 1 天 == 0 时为 365）== 101101101b）。因此，如果您想以完全可访问的格式存储所有内容，则需要 20 位 == 3 字节。或者，添加一个 Month 字段将使总可能的 Days 值从 366 变为 31 - 减少到 5 位，该月再增加 4 位。这*也*将为您提供 20 位或 3 个字节，其中 4 位备用。

相反，如果您从某个开始日期开始按分钟跟踪日期，则 3 个字节将为您提供 16,777,215 分钟的分辨率，然后您再次翻转到 0 - 大约 279,620 小时、11,650 天和大约 388 个月，并且那是使用所有 24 位。如果您不关心秒数并且不介意花一点执行时间来解释小时、日和月，那么这可能是一个更好的方法。 *这*将更容易增加！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-27T18:19:30.213

一天的 5 位加上小时的 5 位加上分钟的 6 位等于无符号短整数。任何进一步的打包都不会减少所需的存储空间，并且会增加代码复杂性和 CPU 使用率。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-27T18:33:35.047

好吧，忽略多余的 HOUR 24 和 MINUTE 60，我们有 31 x 24 x 60 = 44,640 个可能的唯一时间值。2^15 = 32,768 < 44,640 < 65,536 = 2^16 所以我们需要至少 16 位（2 个字节）来表示这些值。

如果我们不想每次都进行模运算来访问值，我们需要确保将每个值存储在自己的位字段中。我们需要 5 位来存储 DAY，5 位来存储 HOUR，6 位来存储 MINUTE，它仍然适合 2 个字节：

```
struct day_hour_minute {
  unsigned char DAY:5; 
  unsigned char HOUR:5;
  unsigned char MINUTE:6;
}; 
```

包括 MONTH 将使我们的唯一时间值增加 12 倍，给出 535,680 个唯一值，这将需要至少 20 位来存储 (2^19 = 524,288 < 535,680 < 1,048,576 = 2^20)，这需要至少 3字节。

同样，为了避免模运算，我们需要一个单独的 MONTH 位字段，它应该只需要 4 位：

```
struct month_day_hour_minute {
  unsigned char MONTH:4;
  unsigned char DAY:5;
  unsigned char HOUR:5;
  unsigned char MINUTE:6;
  unsigned char unused: 4;
}; 
```

但是，在这两个示例中，请注意 C 更喜欢将其数据结构切入 - 也就是说，它们是 4 或 8 字节的倍数（通常），因此它可能会填充您的数据结构超出最低限度的必要条件。

例如，在我的机器上，

```
#include <stdio.h>

struct day_hour_minute {
  unsigned int DAY:5;
  unsigned int HOUR:5;
  unsigned int MINUTE:6;
};
struct month_day_hour_minute {
  unsigned int MONTH:4;
  unsigned int DAY:5;
  unsigned int HOUR:5;
  unsigned int MINUTE:6;
  unsigned int unused: 4;
};

#define DI( i ) printf( #i " = %d\n", i )
int main(void) {
  DI( sizeof(struct day_hour_minute) );
  DI( sizeof(struct month_day_hour_minute) );
  return 0;
} 
```

印刷：

```
sizeof(struct day_hour_minute) = 4
sizeof(struct month_day_hour_minute) = 4 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-27T19:33:22.423

为了在不失一般性的情况下简化这一点，

日 (0 - 30)、小时 (0 - 23)、分钟 (0 - 59)

```
encoding = Day + (Hour + (Minute)*24)*31

Day = encoding %31
Hour = (encoding / 31) % 24
Minute = (encoding / 31) / 24 
```

编码的最大值为 44639，略小于 16 位。

编辑：rampion 说的基本相同。这为您提供了最小表示，它小于按位交错表示。

# bazaar - 将 WinMerge 与 Bazaar 一起使用

> ID：595885
> 
> 赞同：1
> 
> 时间：2009-02-27T18:03:19.893
> 
> 标签：bazaar, winmerge

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T20:28:00.827

```
bzr diff --using "C:/Program Files/WinMerge/WinMergeU.exe" 
```

您可以将其添加到 bazaar.conf 中的别名

或者，如果您的 PATH 环境变量中有 C:\Program Files\WinMerge，您可以将其用作：

```
bzr diff --using WinMergeU.exe 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-28T00:15:19.657

您是否阅读了`README`difftools 插件附带的文件？它解释了这个`--using`选项。

另外，通过安装在我的 windows 机器上的 bazaar，它有一段时间没有更新，你会在 C:\Documents and Settings\ *username* \Application Data\bazaar\2.0\bazaar.conf找到你的配置文件

在该部分下添加以下`[ALIASES]`内容（如果该部分不存在，则添加该部分）：

```
[ALIASES]
gdiff = diff --using C:\Progra~1\WinMerge\WinMergeU.exe 
```

更改路径以适合您的安装。然后你就可以走了

```
bazaar gdiff 
```

代替

```
bazaar diff 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-03-10T00:11:40.130

这似乎对我有用：

```
bzr diff --using "C:\\program files\\winmerge\\winmergeu.exe" 
```

顺便说一句，如果你不能让它工作，我建议使用 q* UI 工具，比如：

```
bzr qdiff
bzr qlog
bzr qcommit 
```

..ETC

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T14:15:31.780

Tortoise Bazaar->Settings->General Bazaar Options->Diff->Add 对我不起作用。我尝试使用上面的答案，但不幸的是它们也不起作用。但是我将答案用作基础，然后找到了解决方案。我编辑了

```
C:\Documents and Settings\*username*\Application Data\bazaar\2.0\qbazaar.conf (not bazaar.conf) 
```

并添加了行

```
[EXTDIFF]
WinMerge = "C:/Program Files/TC UP/PLUGINS/Media/WinMerge/WinMergeU.exe" 
```

它工作正常，我可以在内置差异和 WinMerge 之间进行选择。

# web-architecture - 您如何构建您的网站内容？

> ID：595886
> 
> 赞同：2
> 
> 时间：2009-02-27T18:03:39.097
> 
> 标签：web-architecture

您是否尝试保持简单并有一个根文件夹，然后有一个用于图像、javascript、flash 等的文件夹？您通常如何称呼您的文件夹？你给你的文件命名约定吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T18:22:06.043

不是标准方式..但根据我的经验，我想出了这个结构：

```
root/
 -> images/
      -> <subfolder>
      -> upload
 -> js/
 -> css/
 -> data/
 -> docs/
 -> download/
 -> mme/
 -> subpages/
 -> temp/
 -> siteadmin/

root: all 1st level file located there
images: all images. if images for subfolder, then another level there with the same name.  upload is for uploaded images.
js: javascript
css: css
data: some raw data if needed
docs: word doc or pdf for download
download: something that for ppl to downlaod...
mme: other multimedia files. e.g. flash, movie.. soudn clips.etc.
subpages: 2 or subsequent level pages. organized in different folders
temp: any testing page store there.  private, not public.
siteadmin: if you have an admin site. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-27T18:09:38.257

我保持简单，但是我的网站不需要导致复杂性的东西。通常，每个网页都有一个与磁盘上的文件夹相对应的名称，并且该文件夹包含显示该页面所需的所有内容。网站的层次结构与磁盘上的层次结构相匹配。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-27T18:09:05.700

这取决于项目，但我通常使用 js/、img/ 和 fl/。有时我将 root 分为 code/ 和 content/，但我认为这可能是矫枉过正。就命名约定而言，我通常将我的图像与它们通常嵌入的页面的名称相关联。如果它们在每一页上，我会选择 global_ 或 all_ 之类的东西。我希望这会有所帮助...

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-27T18:09:14.297

如果有很多图像，那么它们的文件夹很有用，但是我倾向于有 1 个 JS 文件、1 个或 2 个 CSS。

我认为最有用的事情是 mod_rewrite 所有页面，就像 stackoverflow 一样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-27T18:18:48.640

这实际上取决于您的网站有多少页面。在早期，将所有页面都放在根目录中似乎是个好主意。稍后，当您有 120 个不相关的文件放在那里时，您可能会开始自责。

我倾向于组合一个简单的 1 深层次结构，按站点区域细分。/forums、/photos、/account 等。我从经验中了解到，您的页数往往会比您预期的要高得多。而且我从经验中了解到，一旦页面具有外部链接，将页面从根目录移出并进入合理的结构是很糟糕的。最好从一开始就做好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-28T22:14:53.853

```
root
+-+ include
  +-- cache
  +-- script
  +-- css
  +-- images 
```

这个目录当然不能从外部访问。

为什么都在包括下？因为这些媒体文件都不是直接提供的。他们都通过一个脚本：

*   将所有 CSS 文件压缩成一个文件；
*   将所有 Javascript 压缩到一个压缩文件中；
*   将这些版本写入缓存目录；
*   时间戳 css、js 和图像文件，并将 expires 标头设置为远在未来；
*   将压缩后的 js 和 css 文件的缓存副本保存在缓存目录中；和
*   所有对这些文件的引用都通过一个自动版本功能，该功能使用最后修改时间来更改 URL 以控制客户端何时获取新副本（例如 /css/screen.1234567890.css），类似于 SO 对其查询所做的操作此类文件上的字符串。

以上可以显着加快网站速度。

目录结构的其余部分将反映站点的菜单结构。如果有一个带有子菜单的“订单”顶级菜单项，那么您可以打赌您会在根目录下找到一个帐户目录。

如果其他人需要来维护它，所有这些都使得该站点非常非常可预测。其他人能够找到自己的方式非常重要。

# c# - 如何防止控件更改 Z 顺序？

> ID：595888
> 
> 赞同：3
> 
> 时间：2009-02-27T18:03:57.333
> 
> 标签：c#, windows, winapi, messaging

我在 .Net 中有用户控制，我在 WndProc 中使用命中测试来允许在运行时用鼠标调整它的大小。

问题是在命中测试成功后（鼠标按下、拖动以调整大小、鼠标释放），控件按 Z 顺序向上跳跃并破坏它在表单中的位置。

我需要命中测试，因为它是一个非常定制的控件。

WndProc 中有没有办法阻止控件更改它的 Z 顺序？

谢谢。

命中测试代码：

```
protected override void WndProc(ref Message m) {
  if (!DesignMode && Sizeable && (m.Msg == Win32Wrapper.WM_NCHITTEST)) {
    Point Hit = new Point((int)m.LParam & 0xFFFF, (int)m.LParam >> 16);
    Hit = this.PointToClient(Hit);
    int DistToBorder = 5;
    if (Hit.X < DistToBorder) {
      if (Hit.Y < DistToBorder) {
        m.Result = (IntPtr)Win32Wrapper.HTTOPLEFT;
        return;
      }
      if (Hit.Y > this.ClientRectangle.Bottom - DistToBorder) {
        m.Result = (IntPtr)Win32Wrapper.HTBOTTOMLEFT;
        return;
      }
      m.Result = (IntPtr)Win32Wrapper.HTLEFT;
      return;
    }
    else if (Hit.X > ClientRectangle.Right - DistToBorder) {
      if (Hit.Y < DistToBorder) {
        m.Result = (IntPtr)Win32Wrapper.HTTOPRIGHT;
        return;
      }
      else if (Hit.Y > this.ClientRectangle.Bottom - DistToBorder) {
        m.Result = (IntPtr)Win32Wrapper.HTBOTTOMRIGHT;
        return;
      }
      m.Result = (IntPtr)Win32Wrapper.HTRIGHT;
      return;
    }
    else if (Hit.Y < DistToBorder) {
      m.Result = (IntPtr)Win32Wrapper.HTTOP;
      return;
    }
    else if (Hit.Y > this.ClientRectangle.Bottom - DistToBorder) {
      m.Result = (IntPtr)Win32Wrapper.HTBOTTOM;
      return;
    }
  } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-15T18:43:28.927

为防止 Z 顺序更改，您应该捕获`WM_WINDOWPOSCHANGING`消息并设置`SWP_NOZORDER`标志。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-28T14:03:55.047

没有答案，但是您是否尝试过使用他的[ControlDesigner](http://msdn.microsoft.com/en-us/library/system.web.ui.design.controldesigner(VS.71).aspx)而不是滚动您自己的 deigner 模式交互？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-17T11:28:03.437

窗口对话框通过控件窗口的 z 顺序管理选项卡顺序和焦点，获得焦点的控件被提升到顶部。

如果您希望您的自定义控件保留其相对 z 定位，请确保其属性不指示其 TABSTOP 或以其他方式能够接收焦点。即如果禁用它会工作吗？

不利的一面是，即使您成功阻止控件的 z 顺序更改，它也会在用户与其他控件交互时隐式地重新定位。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-10-29T06:52:40.903

你确定是命中测试导致了问题吗？你如何调整控件的大小？一种选择是使用传递 SWP_NOZORDER 标志的 p-invoke 调用 SetWindowPos。

# asp.net - ASP.NET MVC 和跟踪输出错误

> ID：595902
> 
> 赞同：0
> 
> 时间：2009-02-27T18:06:45.720
> 
> 标签：asp.net, asp.net-mvc

我找不到太多关于此的信息，但我是唯一一个注意到如果您在 ASP.NET MVC 项目中启用跟踪输出的人，它会为每个 MVC 用户控件输出一次整个跟踪输出吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-10T13:43:08.763

看起来答案是改用 http:// ... /trace.axd 。

# ado.net - ADO.NET 实体框架我在模型中看不到外键属性

> ID：595920
> 
> 赞同：0
> 
> 时间：2009-02-27T18:11:00.423
> 
> 标签：ado.net

我有 2 张桌子。在第一个表中，我有一个指向第二个表主键的外键链接。

(second)Personel 和 (first)Istbl 是我的表。

在个人表中，我有 PersonelID、PersonelName、PersonelSurname。

在 Istbl 表中，我有 IsID、PersonelID、xx、xx、xx，就像这样。

我在 EF 模型查看器中看不到 PersonelID。我也无法在代码屏幕中看到它。

有什么适合我的例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T18:33:49.993

EF v1 隐藏了外键，因为它将它们视为对域模型不重要的持久性工件。请参阅[此处](http://www.thedatafarm.com/blog/2007/09/11/EntityDataModelAssociationsWheresMyForeignKey.aspx)进行讨论。

.NET 4 附带的 EF v2 将包括对模型中外键的​​更好支持。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-11-16T22:19:51.970

你可以用这样的东西获得外键值

```
object foreignKey = istblObject.PersonelReference.EntityKey.EntityKeyValues[0].Value; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T18:14:13.440

你在刷新你的数据模型吗？您是否从数据库创建了模型，如果是，请尝试重新创建它，如果您已更新数据库模型。

# iphone - 如何防止 Core Animation 阻塞我的主线程？

> ID：595922
> 
> 赞同：3
> 
> 时间：2009-02-27T18:11:06.380
> 
> 标签：iphone, performance, core-animation

我知道 Core Animation 在单独的线程中调度其动画，如文档中所述。尽管如此，我的动画似乎阻塞了我的主线程。所有动画开始和结束。（无论是否将 kCATransactionDisableActions 设置为 true。）但会变得跳跃并且主运行循环停止。

我究竟做错了什么？

*概念示例：*

```
[NSTimer scheduledTimerWithTimeInterval:0.0333  target:self selector:@selector(gameEngine) userInfo:nil repeats:YES];

- (void)gameEngine 
{    
   [CATransaction begin];
   [CATransaction setValue:(id)kCFBooleanTrue forKey:kCATransactionDisableActions];
   myLayer.position = CGPointMake( newX, newY);
   [CATransaction commit];    
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-27T19:29:19.783

每秒创建 30 个新动画是一个非常糟糕的主意，而不是打算如何使用 Core Animation。Core Animation 的设计理念是，您告诉系统您希望您的图层（或图层支持的视图）在哪里结束，然后它会计算出其余部分，包括在您的时间范围内运行动画需要丢弃多少帧提供。动画本身将在后台线程上运行，但我相信首先需要在调用线程（通常是主线程）上执行一些设置。此设置可能需要超过 1/30 秒的时间，这会使您的主线程过载。

你的目标应该是尽量减少与核心动画的交互量。如果您有一个复杂但脚本化的运动路径（或其他属性更改），请使用 CAKeyframeAnimation 提前设置它并调用该动画一次。如果您的对象的运动需要根据用户输入进行更改，那么只有在您获得实际输入时才这样做。更改 CALayer 中间动画的属性将导致它从当前运动路径的中间平滑地移动到新的目的地。

如果您以这种方式使用 Core Animation，您可以在 iPhone 上以 60 FPS 的速度同时为多达 50 个移动的半透明图层设置动画。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T18:34:06.233

鉴于您每秒启动 30 次动画，我想您会压倒系统。在您发布新动画之前，以前的动画是否有时间开始？

# tdd - 为单元测试创 建模拟数据

> ID：595926
> 
> 赞同：13
> 
> 时间：2009-02-27T18:12:57.703
> 
> 标签：tdd, mocking

我认为自己对 TDD 场景还是很陌生。但是发现无论我使用哪种方法（模拟框架或存根我自己的对象）我发现我必须编写大量代码来创建模拟数据。我喜欢加载对象以创建内存数据库的想法。但是我不喜欢为了创建模拟数据的唯一目的而用大量代码使我的测试变得混乱。当数据需要考虑所有不同的情况时尤其如此。

我喜欢一些建议，以更好地做到这一点。

在我看来，我应该能够将数据从某个数据存储加载到一个已知状态，然后我可以使用在每个测试方法执行之前在测试设置/初始化中加载的该状态的快照。这将满足适当的测试实践，同时提供便利，让我专注于编写测试而不是编写代码来“手动”创建测试数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-11-23T03:31:17.217

也许你可以试试 NBuilder 库。它提供了一个非常流畅的界面并且易于使用。您可以使用它来生成具有默认值的类的单个实例，或者生成具有默认值或覆盖值的列表。你可以看看[这个](http://nileshgule.blogspot.com/2010/04/use-nbuilder-to-generate-test-data.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T18:21:39.587

您可以拥有 Builder 类来帮助您构建所需的实例/在这种情况下，您将使用与存储库相关的实例。让 Builder 使用适当的默认值，并且在您的测试中，您可以覆盖您需要的内容。这可以帮助您避免需要为所有不同的测试混合每个“数据”案例（这会引入问题，因为通常有些案例与不同的测试不兼容）。

**更新 1：**查看[www.markhneedham.com/blog/2009/01/21/c-builder-pattern-still-useful-for-test-data](http://www.markhneedham.com/blog/2009/01/21/c-builder-pattern-still-useful-for-test-data)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T18:23:53.667

如果您使用的是 .Net，请尝试[NDBUnit](http://unhandled-exceptions.com/blog/index.php/2009/02/22/ndbunit-project-officially-updated-to-handle-fk-relations/)

您填充您的商店，然后在每次测试时将您的数据库恢复到测试时的已知状态。敏捷屏幕演员系列的[秋天](http://www.autumnofagile.net)非常详细地展示了这一点。

或者您可以手动执行此操作...构建一个存储过程或任何截断表并在您的拆卸方法中复制数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-27T18:16:29.597

我确切地知道你的意思。我认为解决这个问题的一个好方法是在测试项目之外有一个单独的 MockFramework 项目来容纳你所有的模拟数据。通过这种方式，您可以单独生成模拟数据，如果需要，将其存储在内存中，然后从测试项目中引用模拟框架。如果您使用第三方框架来执行此操作，那就更好了，但您仍然可以将该第三方框架包装在您自己的模拟框架中，这样您就可以获得所有“胶水”，以您需要的方式创建模拟数据你的测试，所以测试真的只能是他们需要的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T19:38:13.583

感谢所有的建议，我认为解决方案需要一点点的一切。我不希望这些测试最终成为回归测试，但是在没有某种现有数据存储的情况下，一切仍然归结为通过“手动”构建对象来创建数据。

真正好的是一个框架，它允许我使用我现有的 DAL 来编写数据脚本为我编写代码，或者获取内存中的数据并像内存数据库一样访问它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T21:54:35.423

[untils.org](http://unitils.org/guidelines.html#a3 "直到指南")比我以往任何时候都更好地涵盖了这种方式。

他们的整个指南实际上非常好。

但基本上，如果您的单元需要“大量数据”，它们可能不再是单元测试。我建议尝试单独测试较小的部分。

# visual-studio - Visual Studio 任务面板

> ID：595928
> 
> 赞同：3
> 
> 时间：2009-02-27T18:13:39.307
> 
> 标签：visual-studio

有谁知道如何防止任务窗格扩展，除非您单击它们？有时我将鼠标悬停在一个上面，这需要一些时间来分散我的注意力。

谢谢！

编辑：现在我有几天时间来思考我的问题，我意识到答案是关闭它。让我举个例子。当您在 Word 中并且想要查找某个单词的同义词时，您可以打开同义词库以查找替代单词。您按 ALT+F7 并调出它。同义词库在任务窗格中打开，完成后，单击 X 将其关闭。当您将鼠标悬停在它上面时，您不会取消固定它并将其放在一边并感到恼火，它会突然出现，覆盖您的内容并妨碍您。话虽如此，同样的心理模型也适用于视觉工作室。不要打开您不需要的窗口或窗格。当您要执行任务时打开它们，“关闭”任务窗格，不要隐藏它。

干杯!

PS 这并不意味着我觉得当你将鼠标悬停在打开的窗口上时弹出打开的窗口是不错的设计（我相信有人会就此与我争论）。我仍然想要一个选项来选择何时打开折叠的窗口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T23:39:21.413

我保持关闭。我只在需要时打开它。我对工具和服务器也这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-28T08:37:07.830

试着记住他们的快捷方式，并保持关闭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T18:36:46.680

使用小“Pin”图标（位于窗格的三角形和“X”图标之间）修复它，然后调整大小或关闭它。

# sql - SQL触发器简介？

> ID：595935
> 
> 赞同：-1
> 
> 时间：2009-02-27T18:14:32.363
> 
> 标签：sql, database, triggers

我是一名学生，对 SQL 有很好的了解，但过去与触发器几乎没有关系。我查看了一些网站以获取指导，但对所有常用语句的全面解释似乎相当稀疏​​。

有这种事情的“权威”网站吗？也许像高级 SQL 的 w3chools？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-27T18:27:39.417

一旦您了解一点 SQL，请尝试查看 Joe Celko 的书籍。高级 SQL 编程有一个关于触发器的简短部分。由于您是学生，因此您可能可以在图书馆获得一份副本。如果您认为您将从事更深入的 SQL 开发工作，您会很高兴为您自己的本书评分。您可以让关系数据库引擎在少量代码中完成大量工作 - 认为这样会使您成为更高效的程序员。大多数书店（我当地的 Borders 总是有几本）书架上都有一本，所以在购买之前先浏览一下。

此外，按照itsmatt 的建议，查看您正在使用的数据库的在线手册。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T18:30:48.533

我一直认为 SQL Server 联机丛书（随 SQL Server 一起安装）是一个很好的信息来源。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-27T18:37:22.077

这听起来有点像“[旧鞋或玻璃瓶](http://weblogs.asp.net/alex_papadimoulis/archive/2005/05/25/408925.aspx)”的问题。

触发器是你应该远离的事情之一，除非你真的很清楚自己在做什么，并且有充分的理由去做你正在做的事情。很自然，使用触发器的先决条件之一是您应该彻底了解它们的工作原理及其含义。因此，您可以看到“触发器简介”文本的想法对某些人来说可能听起来是一件非常危险的事情。

所以我的建议，虽然听起来很残酷，但是是这样的：如果你是那种需要关于这个特定主题的介绍性文字的人，那么从长远来看，你最好暂时避免使用触发器。

# security - SSL 会话持久性和安全 cookie

> ID：595936
> 
> 赞同：8
> 
> 时间：2009-02-27T18:15:02.737
> 
> 标签：security, session, ssl, cookies, https

我目前有一个自己的应用程序安全服务，它在我的企业中运行，并且在很大程度上满足了业务需求。

我目前面临的问题是，该服务传统上（天真地）依赖用户的源 IP 保持不变作为对冲会话劫持的对冲 - 企业中的 Web 应用程序不能直接向公众提供，过去是完美的我可以接受要求用户的地址在整个给定会话期间保持不变。

不幸的是，情况不再如此，因此我被迫切换到不依赖源 IP 的解决方案。我更愿意实现一个真正实现原始设计者意图的解决方案（即防止会话劫持）。

到目前为止，我的研究已经证明了[这一点](http://www.cse.msu.edu/~alexliu/publications/Cookie/cookie.pdf)，它实质上是“用 SSL 会话密钥为你的身份验证令牌哈希添加盐”。

从表面上看，这似乎是一个完美的解决方案，但是我怀疑在现实世界中实施该方案是不切实际的，因为客户端和服务器可能随时 - 有效地任意 - 选择重新协商 SSL 会话并因此更改密钥。

这是我设想的场景：

1.  已建立 SSL 会话并商定密钥。
2.  客户端在应用程序级别向服务器进行身份验证（即通过用户名和密码）。
3.  服务器写入包含 SSL 会话密钥的安全 cookie。
4.  *发生了导致会话重新协商的*事情。*例如，我认为 IE 在有或没有原因的情况下在计时器上执行此操作。*
**   客户端向服务器提交一个包含*旧*会话密钥的请求（因为没有重新协商的应用程序级知识，所以没有机会将新的、更新的哈希写入客户端）。*   由于哈希匹配失败等原因，服务器拒绝客户端的凭据。*

 *这是一个真正的问题，还是我的误解，因为（至少可以说）对 SSL 工作原理的理解不够完美？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T20:20:29.923

查看与[SSL 持久性](http://mozammel.wordpress.com/2007/03/14/general-ssl-session-persistence-behavior-among-browsers/)相关的所有主题。这是负载均衡器领域中一个经过充分研究的问题。

简短的回答是：**你不能依赖 SSLID——**大多数浏览器会重新协商，你仍然必须使用源 IP。如果 IP 地址可能会在会话中更改，那么您可以强制进行软重新身份验证，或使用 SSLID 作为两个 IP 更改之间的桥梁（反之亦然，即仅在 IP 地址和 SSLID 都更改时假设*劫持*）同时，如服务器所见。）

**2014 更新**

只需强制使用`https`并确保您不会受到[会话固定](http://en.wikipedia.org/wiki/Session_fixation)或[CRIME](http://arstechnica.com/security/2012/09/crime-hijacks-https-sessions/)的攻击。不要费心用任何客户端信息来加盐您的身份验证令牌，因为如果攻击者能够获得令牌（假设所述令牌不仅仅是容易猜测），那么使用任何手段来获取它（例如[跨站点脚本](http://en.wikipedia.org/wiki/Cross-site_scripting)，或完全破坏客户端系统）也将允许攻击者轻松获取可能已进入令牌的任何客户端信息（并在需要时将这些信息复制到辅助系统上）。

如果客户端可能只从几个系统连接，那么您可以[在浏览器中为客户端连接的每个新客户端系统生成一个 RSA 密钥对](https://stackoverflow.com/questions/9605126/generate-rsa-keypair-client-side-on-the-browser)（公共部分提交到您的服务器，而私有部分保留在什么是希望*安全*的客户端存储）并重定向到使用[双向（对等/客户端证书）验证](https://security.stackexchange.com/questions/20803/how-does-ssl-work)代替基于密码的身份验证的虚拟主机。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-20T20:32:45.523

我想知道为什么仅仅简单

1.  在您的传输中需要 ssl
2.  编码输入（html/url/attribute）以防止跨站点脚本
3.  所有更改信息的请求只需要 POST 和
4.  尽可能防止 CSRF（取决于您的平台支持的内容）。
5.  将您的 cookie 设置为 HTTPOnly

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T18:40:32.613

是的，但是你可以做几件事。最简单的方法是简单地缓存您用作盐（每个用户）的会话密钥，并接受其中任何一个。即使重新协商会话，您仍会将其保存在缓存中。有一些细节——过期政策等——但没有什么是不可克服的，除非你正在运行一些需要加强军事规范的东西，在这种情况下，你首先不应该这样做。

——马库斯

# c# - 如何编写 C# 类来针对 0 和 null 进行测试

> ID：595943
> 
> 赞同：2
> 
> 时间：2009-02-27T18:16:48.410
> 
> 标签：c#, operator-overloading, class-design

**背景：**我有一个用 C# (2005) 编写的自定义类，代码类似于以下内容：

```
public class Savepoint
{
  public int iOffset;                 /* Starting offset in main journal */
  public u32 nOrig;                   /* Original number of pages in file */
  public u32 iSubRec;                 /* Index of first record in sub-journal */
}; 
```

**使用Savepoint sp**声明变量后；我可以测试看看是否已经用类似于以下的代码实例化：

```
if (sp != null) {...} 
```

**问题：**是否可以以某种方式重载类运算符，以便我也可以使用以下语法：**if (sp) {...}**或**if (sp != 0) {...}**

PS：除了习惯的力量之外，我没有真正的理由想要写 if (sp)。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-27T18:20:35.907

您可能可以在 C# 中使用默认属性装饰器执行此操作，但您不应该这样做。试图将 C# 写成鸭式语言会导致各种认知失调。

根据经验，最好采用你正在使用的语言的方言，而不是试图将它塞进一个更熟悉的形式，而它从来没有打算持有。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-27T18:51:32.180

我认为您可以向 bool 添加隐式强制转换......这样的东西应该可以工作。

```
public static implicit operator bool(Savepoint sp)
{
    return sp != null;
} 
```

例子：

```
Savepoint sp1 = new Savepoint();
sp1.iOffset = 4;
Savepoint sp2 = new Savepoint();
Savepoint sp3 = null;

Console.WriteLine("sp1: " + (sp1 ? "true" : "false")); // prints true
Console.WriteLine("sp2: " + (sp2 ? "true" : "false")); // prints true
Console.WriteLine("sp3: " + (sp3 ? "true" : "false")); // prints false 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-27T18:25:40.840

C# 中的 if 语句采用布尔表达式，如果表达式为非布尔值，则不会将类型转换为布尔值，这与 C（或 Javascript）中不同。我的建议是只处理轻微的烦恼并使用标准的 C# 习惯用法。

# php - 使用 SimpleXML 使用命名空间解析 XML

> ID：595946
> 
> 赞同：56
> 
> 时间：2009-02-27T18:17:27.037
> 
> 标签：php, xml, namespaces, simplexml

我有这个作为xml：

```
<root xmlns:event="http://www.webex.com/schemas/2002/06/service/event">
    <event:event>
        <event:sessionKey></event:sessionKey>
        <event:sessionName>Learn QB in Minutes</event:sessionName>
        <event:sessionType>9</event:sessionType>
        <event:hostWebExID></event:hostWebExID>
        <event:startDate>02/12/2009</event:startDate>
        <event:endDate>02/12/2009</event:endDate>
        <event:timeZoneID>11</event:timeZoneID>
        <event:duration>30</event:duration>
        <event:description></event:description>
        <event:status>NOT_INPROGRESS</event:status>
        <event:panelists></event:panelists>
        <event:listStatus>PUBLIC</event:listStatus>
    </event:event>
    ...
</root> 
```

如何遍历所有 event:event 节点并显示，例如，所有 event:SessionKey 的？

这不起作用：

```
$xml = new SimpleXMLElement($r);
$xml->registerXPathNamespace('e', 'http://www.webex.com/schemas/2002/06/service/event');

foreach($xml->xpath('//e:event') as $event) {
 var_export($event->xpath('//e:sessionKey'));
} 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-03-07T19:45:36.417

它确实可以`registerXPathNamespace`在 xpath 查询中没有完整的命名空间前缀的情况下工作：

```
$xml = new SimpleXMLElement($r);

foreach($xml->xpath('//event:event') as $event) {
 var_export($event->xpath('event:sessionKey'));
} 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2009-03-11T19:05:27.273

您必须为您使用的每个 simpleXMLElement 对象注册名称空间。

```
$xml = new SimpleXMLElement($r);
$xml->registerXPathNamespace('e', 'http://www.webex.com/schemas/2002/06/service/event');

foreach($xml->xpath('//e:event') as $event) {
    $event->registerXPathNamespace('e', 'http://www.webex.com/schemas/2002/06/service/event');
    var_export($event->xpath('//e:sessionKey'));
} 
```

命名空间也应该在 xml 文件的某处声明。

```
<event:event xmlns:event="http://www.webex.com/schemas/2002/06/service/event">
... 
```

描述的方法 ax 也有效。如果您知道 xml 文件将始终使用相同的前缀，则可以跳过 registerXPathNamespace。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-02-05T03:26:31.967

这里的替代方案对我有用。

```
$xml = simplexml_load_string($r);
$ns = $xml->getNamespaces(true);

foreach ($xml->children($ns['event'])->event as $skey) {
    $sessionKey = $skey->children($ns['event'])->sessionKey;
    echo $sessionKey;
} 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2017-02-26T11:43:09.710

使用 simplexml 做了很多工作，这就是我的做法。

如果您已经有一个元素并且只想获取它的不同命名空间的子元素，那么魔术技巧就是这样的结构：

```
<entry>
<title type="text">My test entry</title>
<gd:when startTime="2017-02-26T02:00:00Z" endTime="2017-02-26T03:00:00Z"/>
<gc:notes type="string">A type</gc:notes>
</entry> 
```

是将 TRUE 作为第二个参数发送给[children](https://www.php.net/manual/en/simplexmlelement.children.php)函数：

```
 $title = (string) $entry->title;
  $gd = $entry->children('gd', TRUE);
  $attrs = $gd->when->attributes();
  $startTime = (string) $attrs->startTime;
  $gc = $entry->children('gc', TRUE);
  $notes = (string) $gc->notes(); 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2012-11-30T19:11:44.877

另一种方法是`SimpleXML`用于解析和`DOMDocument`操作/访问，这完全绕过了命名空间问题：

```
$xml = new SimpleXMLElement($r);
$xml = dom_import_simplexml($xml);
$nodelist= $xml->getElementsByTagName('event');  
for($i = 0; $i < $nodelist->length; $i++) {
    $sessions = $nodelist->item($i)->getElementsByTagName('sessionKey');
    echo $sessions->item(0)->nodeValue;
} 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-03-21T10:13:51.383

使用`registerXPathNamespace`然后调用`xpath`实际上对我不起作用。我不得不使用这篇很棒的帖子中提供的解决方案：[http ://blog.preinheimer.com/index.php?/archives/172-SimpleXML,-Namespaces-Hair-loss.html](http://blog.preinheimer.com/index.php?/archives/172-SimpleXML,-Namespaces-Hair-loss.html)

所以在你的情况下，这个：

```
echo $xml->children('http://www.webex.com/schemas/2002/06/service/event')->sessionName; 
```

将输出：

> 分分钟学QB

# css - 在 CSS 中创建可变宽度渐变填充

> ID：595948
> 
> 赞同：1
> 
> 时间：2009-02-27T18:17:52.997
> 
> 标签：css

我目前正在构建一个 WordPress 主题，我希望在页面顶部有一个适合从一个角落到另一个角落的标题（在 WordPress 中，而不是 HTML 意义上）。最左边的锚定将是一个在其右侧填充纯色的图像。最右边的锚定将是在其左侧填充纯色的图像。

我想做的是填充中间空间，无论浏览器宽度如何，渐变色从左侧颜色无缝渐变到右侧颜色。有没有办法通过 CSS 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T18:34:43.470

[在GIMP](http://www.gimp.org/)中将渐变作为图像（一个像素高）并查看[http://www.cssplay.co.uk/layouts/background.html](http://www.cssplay.co.uk/layouts/background.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T18:36:08.257

没有纯 CSS 方法可以做到这一点，但使用 CSS 的一种解决方案是为您可能拥有的最大屏幕宽度制作足够宽度的背景图像，并将其拉伸到当前浏览器宽度。

如果颜色都相同，另一种方法是在 GIF 中制作一个越来越透明的背景图像，并设置您选择的背景颜色。

见[这个](http://www.designdetector.com/2005/09/css-gradients-demo.php)或[这个](http://www.tankedup-imaging.com/css_dev/css-gradient.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T19:15:11.377

这是一种没有图像的方法。你可以认为这是一个 hack，但它在某种程度上完成了工作。根据需要调整渐变的步数。如果您希望它自动缩放以填充窗口，请使用更多`<b>`元素并且不要将边框用作渐变步骤之一。然后`<b>`使用百分比宽度调整元素大小。如果您想保持较小的下载大小，您甚至可以使用 Javascript 生成渐变。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <title></title>
    <style type="text/css">
    .grad b {
       display: block;
       float: left;
       width: 16px;
       height: 100%;
       border-left-width: 16px;
       border-right-width: 16px;
       border-left-style: solid;
       border-right-style: solid;
       border-left-color: #FF0000;
       background-color: #EE0011;
       border-right-color: #DD0022;
    }
    .grad b+b {
       border-left-color: #CC0033;
       background-color: #BB0044;
       border-right-color: #AA0055;
    }
    .grad b+b+b {
       border-left-color: #990066;
       background-color: #880077;
       border-right-color: #770088;
    }
    .grad b+b+b+b {
       border-left-color: #660099;
       background-color: #5500AA;
       border-right-color: #4400BB;
    }
    .grad b+b+b+b+b {
       border-left-color: #3300CC;
       background-color: #2200DD;
       border-right-color: #1100EE;
    }
    .grad b+b+b+b+b+b {
      border: none;
      background-color: #0000FF;
    }
    .grad {
      float: left;
      font-size: 100%;
      height: 30px;
    }
    </style>
  </head>
  <body>
    <div class="grad">
      <b></b>
      <b></b>
      <b></b>
      <b></b>
      <b></b>
      <b></b>
    </div>
  </body>
</html> 
```

# actionscript-3 - Flash 站点架构 - 一个 swf 与多个？

> ID：595950
> 
> 赞同：4
> 
> 时间：2009-02-27T18:18:18.703
> 
> 标签：actionscript-3, architecture, web, flash

我即将开始使用 AS3 完全在闪存中构建一个站点（根据客户的要求），并且想知道在应用程序架构方面这样做的最佳实践。该网站并不太大——想想主页、持久导航、8 个左右的小节，每个小节都有自己的内容，但小节之间的设计相似。过去，我会使用多个 swf（例如，一个用于导航，一个用于子部分）并动态加载它们；不过，现在我正在考虑采用不同的路线并使用更面向对象的设计，其中包含许多类和一个 swf（加上一个预加载器来加载它）。

是否有任何最佳实践来确定动态加载较小的 swf 与构建单个大型 swf 是否更好？在 AS2 中，我认为加载许多较小的 swf 更有意义，但随着 AS3 更强大的面向对象功能，我想知道是否仍然如此。

我知道反对单一 swf 设计的一个论点是在初始站点加载时加载所有内容会增加重量，但我认为这里没有足够重的内容值得真正关注。

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-27T18:26:28.623

这取决于您所说的“更小”是什么意思。

不要把它分成太小的块，否则你会因为连接开销而自杀。不要将整个网站打包成一个需要数周才能下载的庞大文件。

一个好的经验法则：如果您发现自己试图在用户等待下载时想出吸引人或有趣的东西来展示，请改用重组。

——马库斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-27T18:31:03.167

我认为这很重要取决于页面的内容以及您已经包含在您的 swf 中的资产数量。

我们通常只制作 2 个 swf：一个预加载器和一个真正的应用程序。

应用程序不包含任何文本或图像。一切（字体除外）都是从服务器动态加载的，因为在我们大多数情况下内容都是动态的。swf 的大小不会增加太多，您再添加 10 个类。

很难对您的问题给出 100% 的直接答案，因为这取决于内容的权重（以及它是动态的还是非常静态的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T19:26:00.553

根据我的经验，如今（大多数）中小型 Flash 网站/应用程序的常见做法是两个 SWF 架构，一个加载核心的外壳。有时您可以只使用一个跟踪其自身加载进度的 SWF。也就是说，您希望按需加载内容和资产；图像、视频、动画和大型文本内容。这些通常不应嵌入到核心 SWF 中，而是应用户请求加载。在这两种情况下（一个与两个 SWF）的主要优势是代码维护。您只需在更新应用程序时重新编译核心 SWF。在此模型中，您仍然可以加载包含基于时间轴的动画的其他 SWF，只要您将应用程序代码保留在核心中即可。

希望有帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-04T00:38:50.847

从来没有一种“说所有”的方式来做任何事情。一个项目可能很小并且可以以程序方式编写代码，至于另一个项目可能错综复杂，涉及很多人并且肯定能够接受更改，那么 OOP 和设计模式可能是要走的路。对于肯定会被分成多个部分的基于生产的站点，将每个部分抽象为自己的 FLA/SWF/DOCUMENT CLASS 可以使您的代码可维护。如果 about 部分中的某些内容需要更改，我们只需打开 AboutDocumentClass.as，例如，然后进行更改。说实话，你现在应该使用 SWFAddress 来提供深度链接；为 Flash 站点启用收藏夹、后退和前进按钮。通过正确实施 SWFAddress 和一个不错的预加载器，可以实现一个非常流畅、占用空间小的站点，

话虽如此，我相信任何生产级闪存开发人员都应该了解 GAIA 框架。在短短几分钟内，您就拥有了 FLA、文档类、swf 等的完整骨骼结构。GAIA 不仅将输出的文件排列在智能层次结构中，而且还设置了 SWFObject、SWFAddress 以及预加载器。

这一切都是通过首先编辑一个 XML 文件来完成的，该文件位于您让 GAIA 输出新项目文件的 bin 文件夹中。一旦您完成了对 XML 和任何其他项目的编辑，您告诉 GAIA 搭建支架，对于您在 XML 中说明的每个部分，创建一个 FLA，一个带有挂钩到基于时间线的转换或 TweenLite/Max 实现的文档类搭脚手架前看你的选择。同样，这需要大约 5 分钟，并且您的站点具有预加载、SWFAddress 深度链接和过渡挂钩。

结果是使用一组标准名称和约定的文件的整洁输出，这些名称和约定应该易于阅读并减少十倍的冗余。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-27T18:24:47.503

> 反对单一 swf 设计的一个论据是在初始 [...]

您将希望保留经常更改的部分和不分离的部分（如果有的话）。有一种叫做[Ordered Creation](http://livedocs.adobe.com/flex/3/html/help.html?content=layoutperformance%5F07.html#172599)的东西[`creationPolicy`](http://livedocs.adobe.com/flex/3/html/help.html?content=layoutperformance%5F05.html)来处理加载时间。但除此之外，它实际上归结为您可以轻松维护的东西。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-27T18:31:55.770

不，我知道
（“确定动态加载较小的 swf 是否更好的最佳实践”），但我可以想到一个很好的理由在一开始就加载所有内容，
**我通常在做什么**

*   我将所有**代码写在一个地方**

*   动态加载带有图形的 swf

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-27T19:52:26.247

您的加载时间可能是一个重要因素，但另一个需要考虑的因素是您的 SWF 的“外观”是否易于改变，而底层代码保持不变。对于我参与的几款“可换肤”游戏，游戏玩法相同，但我们希望能够更改图像以匹配赞助商客户，我们将标题分成两个 SWF，一个包含所有可执行代码 (Application.swf)，另一个包含所有艺术资产（Library.swf）。这很成功，因为我们的艺术团队可以使用 Library.swf，只要他们保持相同的电影剪辑导出命名方案（和适用的帧标签），他们就可以构建新的艺术作品并简单地更换他们的“皮肤” " swf 无需重新编译或对源代码一无所知。

我认为我们使用 LoadMovieClip() 来处理库资源，当然所有库剪辑都需要在第 1 帧上用适当的标签标记为导出。此外，我们所有的代码都在单独的 AS 文件中，并且当我们使用 AS2.0 时，我们将影片剪辑作为类的成员包含在内，而不是将逻辑放在影片剪辑本身中。这几乎完全将艺术与代码隔离开来，除了 Application.SWF 中用于初始化和处理 OnEnterFrame() 函数的一些基本影片剪辑，然后将任何输入或基于刻度的功能传递到子链中对象。

我从事这些工作已经有一年了，所以我的术语可能有点不对劲。不过，我希望这会有所帮助。

# asp.net - ASP.NET 成员资格创建用户无需 requiresQuestionAndAnswer

> ID：595957
> 
> 赞同：14
> 
> 时间：2009-02-27T18:18:52.040
> 
> 标签：asp.net, web-config, asp.net-membership

如何在 Membership 类中使用 CreateUser 方法而无需分配问题和答案？

我在 web.config 中使用以下设置禁用了它。

```
requiresQuestionAndAnswer="false" 
```

我需要 CreateUser 方法的状态输出，但重载需要问答。谁能建议我怎么做？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-27T18:25:45.800

我还没有尝试过，但是您是否尝试过为这两个参数传递 null ？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-02-22T12:27:39.520

您需要在 web.config 中设置参数

```
<system.web>
<membership>
<providers>

<add name="YOURMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="con"  minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" requiresQuestionAndAnswer="false" requiresUniqueEmail="false" passwordFormat="Clear" applicationName="YourAppName" maxInvalidPasswordAttempts="2147483647"/> 
```

我试过这个。它的工作正常。谢谢

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-11-10T00:33:41.160

正如另一位回答者提到的那样，您只需传入`null`而不是`""`, 或`string.Empty`。

当我第一次发现这一点时，我以为开发人员还没有听说过`string.IsNullOrEmpty`，我们正在冒险进入 WTF 领域。

但是当然，在他们的智慧中，他们意识到这`null`在概念上与空字符串不同，在这种情况下，当处理来自用户的输入时，我们想告诉他们如果没有指定他们的问题是无效的。

# visual-studio - clickonce 发布哪个目录？

> ID：595962
> 
> 赞同：0
> 
> 时间：2009-02-27T18:20:55.983
> 
> 标签：visual-studio, clickonce

当我使用 clickonce 时，会发布哪些文件？

来自 bin 或 obj 目录的那些？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-27T18:25:27.813

obj 目录中的任何内容都是中间构建工件，可以随时安全地丢弃。

bin 文件夹中的任何内容都是整个构建过程的最终结果。

ClickOnce 默认发布所有最终构建工件，符号文件除外。您可以从项目属性的“发布”选项卡中更改发布的内容。

# jquery - 使用 jquery validate 插件成功验证后发送 ajax 请求

> ID：595982
> 
> 赞同：0
> 
> 时间：2009-02-27T18:25:47.877
> 
> 标签：jquery, validation

我正在使用 jquery 插件验证进行表单验证我有一个简单的问题，我无法弄清楚。

```
$(document).ready(function () {
    $("#contactForm").validate({
        rules: {
            contactName: "Please Enter Full Name",
            contactBody: "Please Enter full message here",
            contactEmail: {
                required: true,
                email: true
            }
        }
    });
}); 
```

这验证完美，我需要的是它是否成功，而不是向用户发送 ajax 请求或邮件，否则不发送。

我知道如何使用 jquery 发送邮件，但我需要发送成功，如何？即使我无法使用警报，它也会给我括号}缺少错误

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T18:44:45.787

**您可以使用submitHandler**选项拦截提交。可以将此选项设置为一个回调函数，该函数可以触发发送电子邮件的 ajax 请求。

要完成这项工作，您需要在处理邮件发送的服务器上设置一个脚本。发送 ajax 请求中所需的所有数据，服务器脚本可以发送邮件并返回成功响应。

# c# - 生成的乳胶源中的无效字符

> ID：595988
> 
> 赞同：0
> 
> 时间：2009-02-27T18:27:53.377
> 
> 标签：c#, latex, doxygen

我在运行 XP 的 Windows 机器上的 Visual Studio 2008 的 C# 项目上运行 doxygen (1.5.8)。在生成乳胶代码时，会包含一些非法序列。它总是涉及以下序列：“ï»¿”（带有分词的拉丁-I，类似于二元移位运算符和西班牙语开放问号）。我已经看到它发生在“ï»¿using {\bf System}”的上下文中，但也许还有其他的。

生成的乳胶文件读取

```
 \begin{CompactItemize}
    \item 
    ï»¿using {\bf System}
    \end{CompactItemize} 
```

虽然来源很简单：

```
using System;
using System.Collections.Generic;
using System.Linq; 
```

一些奇怪的 Windows BOF 字符？似乎只是在使用系统之前；指令（每个文件的第一个）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T18:41:01.363

> 一世”

这是 UTF-8 编码字符 U+FEFF（字节顺序标记）的 ISO-8859-1 表示。BOM 旨在用作 UTF-16 文件中的第一个代码点，不应在 UTF-8 文件中使用，但不幸的是，默认情况下有一些非常愚蠢的工具会生成它。如果您通过连接来自其他文件的文本位来创建文件，您甚至可以在文档中间使用 BOM。

找到将文件保存为“UTF-8 with BOM”的编辑器并刻录。

ETA重新更新问题：

> ï»¿使用 {\bf 系统}
> 
> 虽然来源很简单：
> 
> 使用系统；

在“使用”之前，在十六进制编辑器中检查该源是否有隐藏的人造 BOM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-27T18:37:36.520

对我来说，这看起来像是一个字符编码问题。

这三个字符序列是以 UTF-8 编码的 Unicode 字节顺序标记`0xfeff`，尽管我不确定为什么字节顺序标记会出现在您的文档中间......这可能很重要，也可能只是巧合。

# unit-testing - NUnit - 指定每次测试后调用的方法

> ID：595990
> 
> 赞同：1
> 
> 时间：2009-02-27T18:29:23.077
> 
> 标签：unit-testing, nunit

NUnit 是否让我在每个测试方法之后调用一个方法？

例如

```
class SomeClass
{
   [SomeNUnitAttribute]
   public void CalledAfterEveryTest()
   {
   }
} 
```

我知道 [SetUp] 和 [TearDown]，但这仅适用于当前课程中的测试。我想要 [TearDown] 之类的东西，除了它在*每个*单元测试之后运行，无论它是否在当前类中。可能的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-27T18:33:09.853

[TearDown] 属性标记清理方法。

如果您希望它用于多个类，我相信您可以将 teardown 方法添加到基类中，并在每个需要拆卸行为的测试类中继承该方法。*`*****************